         TITLE '************* ICBVSL00: VOLUME SELECTION ROUTINE********00001000
               *****    '                                               00002000
ICBVSL00 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'ICBVSL00  77.354'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  LA    @11,4095(,@12)                                      0001 00012000
         LA    @10,4095(,@11)                                      0001 00013000
         LA    @09,4095(,@10)                                      0001 00014000
         USING @PSTART,@12                                         0001 00015000
         USING @PSTART+4095,@11                                    0001 00016000
         USING @PSTART+8190,@10                                    0001 00017000
         USING @PSTART+12285,@09                                   0001 00018000
         ST    @13,@SA00001+4                                      0001 00019000
         LA    @14,@SA00001                                        0001 00020000
         ST    @14,8(,@13)                                         0001 00021000
         LR    @13,@14                                             0001 00022000
*   RPLVPTR=REG1;                   /* ADDRESS OF RPLV       @G24LB26*/ 00023000
         LR    RPLVPTR,REG1                                        0228 00024000
*   RESPECIFY                                                      0229 00025000
*     REG1 UNRSTD;                  /*                       @G24LB26*/ 00026000
*   SELTMPTR=ADDR(RPLVUTIL);        /* ADDRESS OF SELECTOR   @G24LB26   00027000
*                                      PARM LIST             @G24LB26*/ 00028000
         LA    SELTMPTR,RPLVUTIL(,RPLVPTR)                         0230 00029000
*   VVIPTR=RPLVVICB;                /* ADDRESS OF MSVC       @G24LB26   00030000
*                                      CONTROL BLOCK         @G24LB26*/ 00031000
         L     @08,RPLVVICB(,RPLVPTR)                              0231 00032000
         ST    @08,VVIPTR                                          0231 00033000
*   IF VVIFLG0=ON THEN              /* MSVC INVENTORY        @G24LB26   00034000
*                                      DISABLED?             @G24LB26*/ 00035000
         TM    VVIFLG0(@08),B'10000000'                            0232 00036000
         BNO   @RF00232                                            0232 00037000
*     DO;                           /*                       @G24LB26*/ 00038000
*       RPLVRETC=RCFOUR;            /* SET BAD RETURN        @G24LB26*/ 00039000
         MVC   RPLVRETC(2,RPLVPTR),@CB02113                        0234 00040000
*       RPLRCODE=MSVCDISA;          /* INDICATE DISABLED     @G24LB26*/ 00041000
         MVC   RPLRCODE(2,RPLVPTR),@CB02077                        0235 00042000
*     END;                          /*                       @G24LB26*/ 00043000
*                                                                  0237 00044000
*   /*****************************************************************/ 00045000
*   /*                                                               */ 00046000
*   /* DETERMINE IF PROCESSING TO CONTINUE                   @G24LB26*/ 00047000
*   /*                                                               */ 00048000
*   /*****************************************************************/ 00049000
*                                                                  0237 00050000
*   IF RPLVRETC=RCZERO THEN         /*                       @G24LB26*/ 00051000
@RF00232 CLC   RPLVRETC(2,RPLVPTR),@CB02111                        0237 00052000
         BNE   @RF00237                                            0237 00053000
*     DO;                           /*                       @G24LB26*/ 00054000
*                                                                  0238 00055000
*       /*************************************************************/ 00056000
*       /*                                                           */ 00057000
*       /* INITIALIZE KEYS IN CASE PREVIOUS EXECUTION OF     @G24LB26*/ 00058000
*       /* PROGRAM ALTERED THEM                              @G24LB26*/ 00059000
*       /*                                                           */ 00060000
*       /*************************************************************/ 00061000
*                                                                  0239 00062000
*       GBLKKY=BLANK;               /* FILL AREA             @G24LB26*/ 00063000
         MVI   GBLKKY,C' '                                         0239 00064000
*       GIDKY=ZERO;                 /* INDEX AREA            @G24LB26*/ 00065000
*                                                                  0240 00066000
         MVI   GIDKY,X'00'                                         0240 00067000
*       /*************************************************************/ 00068000
*       /*                                                           */ 00069000
*       /* SETUP ADDRESSING TO RECORD RETURN AREAS           @G24LB26*/ 00070000
*       /*                                                           */ 00071000
*       /*************************************************************/ 00072000
*                                                                  0241 00073000
*       BASEVPTR=ADDR(STORBASE);    /* ADDRESS BASE REC AREA @G24LB26*/ 00074000
         LA    @08,STORBASE                                        0241 00075000
         ST    @08,BASEVPTR                                        0241 00076000
*       GROUPPTR=ADDR(STORGRP);     /* ADDRESS GROUP REC AREA      0242 00077000
*                                                            @G24LB26*/ 00078000
         LA    @08,STORGRP                                         0242 00079000
         ST    @08,GROUPPTR                                        0242 00080000
*       GVSNEPTR=ADDR(STORGPEX);    /* ADDRESS EXTEND REC    @G24LB26   00081000
*                                      AREA                  @G24LB26*/ 00082000
*                                                                  0243 00083000
         LA    @08,STORGPEX                                        0243 00084000
         ST    @08,GVSNEPTR                                        0243 00085000
*       /*************************************************************/ 00086000
*       /*                                                           */ 00087000
*       /* ZERO INTERNAL WORK AREA AND FLAGS                 @G24LB26*/ 00088000
*       /*                                                           */ 00089000
*       /*************************************************************/ 00090000
*                                                                  0244 00091000
*       INTWORK=INTWORK&&INTWORK;   /*                       @G24LB26*/ 00092000
         XC    INTWORK(22),INTWORK                                 0244 00093000
*       DYNMFLGS=DYNMFLGS&&DYNMFLGS;/*                       @G24LB26*/ 00094000
         XC    DYNMFLGS(2),DYNMFLGS                                0245 00095000
*       DSPDDADR=ZEROPTR;           /* CLEAR STEP TABLE DD   @G24LB26   00096000
*                                      ENTRY ADDRESS         @G24LB26*/ 00097000
*                                                                  0246 00098000
         SLR   @08,@08                                             0246 00099000
         ST    @08,DSPDDADR                                        0246 00100000
*       /*************************************************************/ 00101000
*       /*                                                           */ 00102000
*       /* RESERVE THE INVENTORY DATA SET                    @G24LB26*/ 00103000
*       /*                                                           */ 00104000
*       /*************************************************************/ 00105000
*                                                                  0247 00106000
*       RESPECIFY                                                  0247 00107000
*        (REG0,                                                    0247 00108000
*         REG1) RSTD;               /*                       @G24LB26*/ 00109000
*       REG1=RPLVPTR;               /* ADDR OF RPLV          @G24LB26*/ 00110000
         LR    REG1,RPLVPTR                                        0248 00111000
*       REG0=RESEXINV;              /* INDICATE RESERVE      @G24LB26   00112000
*                                      EXCLUSIVE             @G24LB26*/ 00113000
         LA    REG0,1                                              0249 00114000
*       CALL ICBVRR00;              /* CALL RESERVE/RELEASE  @G24LB26*/ 00115000
         L     @15,@CV01909                                        0250 00116000
         BALR  @14,@15                                             0250 00117000
*       RESPECIFY                                                  0251 00118000
*        (REG0,                                                    0251 00119000
*         REG1) UNRSTD;             /*                       @G24LB26*/ 00120000
*                                                                  0252 00121000
*       /*************************************************************/ 00122000
*       /*                                                           */ 00123000
*       /* IF VOL=REF REQUEST CALL APPROPRIATE ROUTINE       @G24LB26*/ 00124000
*       /*                                                           */ 00125000
*       /*************************************************************/ 00126000
*                                                                  0252 00127000
*       IF SELVOLRF=ON THEN         /*                       @G24LB26*/ 00128000
         TM    SELVOLRF(SELTMPTR),B'00001000'                      0252 00129000
         BNO   @RF00252                                            0252 00130000
*         CALL VOLREF;              /*                       @G24LB26*/ 00131000
         BAL   @14,VOLREF                                          0253 00132000
*     END;                          /*                       @G24LB26*/ 00133000
*                                                                  0254 00134000
@RF00252 DS    0H                                                  0255 00135000
*   /*****************************************************************/ 00136000
*   /*                                                               */ 00137000
*   /* IF VOLREF WAS NOT CALLED AND THERE ARE NO BAD         @G24LB26*/ 00138000
*   /* RETURN CODES, CONTINUE                                @G24LB26*/ 00139000
*   /*                                                               */ 00140000
*   /*****************************************************************/ 00141000
*                                                                  0255 00142000
*   IF RPLVRETC=RCZERO&SELVOLRF=OFF THEN/*                   @G24LB26*/ 00143000
@RF00237 CLC   RPLVRETC(2,RPLVPTR),@CB02111                        0255 00144000
         BNE   @RF00255                                            0255 00145000
         TM    SELVOLRF(SELTMPTR),B'00001000'                      0255 00146000
         BNZ   @RF00255                                            0255 00147000
*     DO;                           /*                       @G24LB26*/ 00148000
*                                                                  0256 00149000
*       /*************************************************************/ 00150000
*       /*                                                           */ 00151000
*       /* READ GROUP RECORD, FOR READ ONLY                  @G24LB26*/ 00152000
*       /*                                                           */ 00153000
*       /*************************************************************/ 00154000
*                                                                  0257 00155000
*       GROUPKY=JFCMSVGP;           /* GROUP NAME IN KEY     @G24LB26*/ 00156000
         L     @08,JFCBPTR(,SELTMPTR)                              0257 00157000
         MVC   GROUPKY(8),JFCMSVGP(@08)                            0257 00158000
*       RPLVKEY=ADDR(GKEY);         /* ADDR OF KEY           @G24LB26*/ 00159000
         LA    @08,GKEY                                            0258 00160000
         ST    @08,RPLVKEY(,RPLVPTR)                               0258 00161000
*       RPLVBUF=ADDR(STORGRP);      /* ADDR GROUP BUFFER     @G24LB26*/ 00162000
         LA    @08,STORGRP                                         0259 00163000
         ST    @08,RPLVBUF(,RPLVPTR)                               0259 00164000
*       RPLVBLN=LENGTH(STORGRP);    /* BUFFER LENGTH         @G24LB26*/ 00165000
         MVC   RPLVBLN(4,RPLVPTR),@CF02237                         0260 00166000
*       RPLVDIR=ON;                 /* READ DIRECT           @G24LB26*/ 00167000
         OI    RPLVDIR(RPLVPTR),B'01000000'                        0261 00168000
*       RPLVTYP=RPLVREAD;           /* READ                  @G24LB26*/ 00169000
         MVI   RPLVTYP(RPLVPTR),X'00'                              0262 00170000
*       RESPECIFY                                                  0263 00171000
*         REG1 RSTD;                /*                       @G24LB26*/ 00172000
*       REG1=RPLVPTR;               /* ADD OF RPLV           @G24LB26*/ 00173000
         LR    REG1,RPLVPTR                                        0264 00174000
*       CALL ICBVIO00;              /* I/O PROCESSOR         @G24LB26*/ 00175000
         L     @15,@CV01910                                        0265 00176000
         BALR  @14,@15                                             0265 00177000
*       RESPECIFY                                                  0266 00178000
*         REG1 UNRSTD;              /*                       @G24LB26*/ 00179000
*                                                                  0266 00180000
*       /*************************************************************/ 00181000
*       /*                                                           */ 00182000
*       /* CHECK RETURN                                      @G24LB26*/ 00183000
*       /*                                                           */ 00184000
*       /*************************************************************/ 00185000
*                                                                  0267 00186000
*       IF RPLVRETC^=RCZERO THEN    /*                       @G24LB26*/ 00187000
         CLC   RPLVRETC(2,RPLVPTR),@CB02111                        0267 00188000
         BE    @RF00267                                            0267 00189000
*         DO;                       /*                       @G24LB26*/ 00190000
*                                                                  0268 00191000
*           /*********************************************************/ 00192000
*           /*                                                       */ 00193000
*           /* IF UNABLE TO READ GROUP RECORD,               @G24LB26*/ 00194000
*           /* ISSUE MESSAGE ICB415I                         @G24LB26*/ 00195000
*           /*                                                       */ 00196000
*           /*********************************************************/ 00197000
*                                                                  0269 00198000
*           MSGRQ=MSGRQ&&MSGRQ;     /* CLEAR MSG PARM LIST   @G24LB26*/ 00199000
         XC    MSGRQ(32),MSGRQ                                     0269 00200000
*           MSGRPLV=RPLVPTR;        /* RPLV ADDR             @G24LB26*/ 00201000
         ST    RPLVPTR,MSGRPLV                                     0270 00202000
*           MSGID=MSG415;           /* MESSAGE ID FOR ICB415I      0271 00203000
*                                                            @G24LB26*/ 00204000
         MVC   MSGID(4),@CF02065                                   0271 00205000
*           MSGLEN1=EIGHT;          /* LENGTH OF INSERT      @G24LB26*/ 00206000
         MVI   MSGLEN1,X'08'                                       0272 00207000
*           MSGTEXT1=ADDR(GROUPKY); /* GROUP NAME IM MESSAGE @G24LB26*/ 00208000
         LA    @08,GROUPKY                                         0273 00209000
         STCM  @08,7,MSGTEXT1                                      0273 00210000
*           RESPECIFY                                              0274 00211000
*             REG1 RSTD;            /*                       @G24LB26*/ 00212000
*           REG1=ADDR(MSGRQ);       /* ADDR OF MSG PARM LIST @G24LB26*/ 00213000
         LA    REG1,MSGRQ                                          0275 00214000
*           CALL ICBVOP00;          /* ISSUE MESSAGE         @G24LB26*/ 00215000
         L     @15,@CV01912                                        0276 00216000
         BALR  @14,@15                                             0276 00217000
*           RESPECIFY                                              0277 00218000
*             REG1 UNRSTD;          /*                       @G24LB26*/ 00219000
*           RPLRCODE=NOGRPFND;      /* REASON CODE HEX 231   @G24LB26*/ 00220000
         MVC   RPLRCODE(2,RPLVPTR),@CB02089                        0278 00221000
*           RPLVRETC=RCFOUR;        /* RETURN CODE 4         @G24LB26*/ 00222000
         MVC   RPLVRETC(2,RPLVPTR),@CB02113                        0279 00223000
*         END;                      /*                       @G24LB26*/ 00224000
*     END;                          /*                       @G24LB26*/ 00225000
*                                                                  0281 00226000
@RF00267 DS    0H                                                  0282 00227000
*   /*****************************************************************/ 00228000
*   /*                                                               */ 00229000
*   /* ENSURE STILL NEED TO CONTINUE                         @G24LB26*/ 00230000
*   /*                                                               */ 00231000
*   /*****************************************************************/ 00232000
*                                                                  0282 00233000
*   IF RPLVRETC=RCZERO&SELVOLRF=OFF THEN/*                   @G24LB26*/ 00234000
@RF00255 CLC   RPLVRETC(2,RPLVPTR),@CB02111                        0282 00235000
         BNE   @RF00282                                            0282 00236000
         TM    SELVOLRF(SELTMPTR),B'00001000'                      0282 00237000
         BNZ   @RF00282                                            0282 00238000
*     DO;                           /*                       @G24LB26*/ 00239000
*                                                                  0283 00240000
*       /*************************************************************/ 00241000
*       /*                                                           */ 00242000
*       /* DETERMINE IF GROUP SUPPORTS THIS TYPE OF REQUEST  @G24LB26*/ 00243000
*       /*                                                           */ 00244000
*       /*************************************************************/ 00245000
*                                                                  0284 00246000
*       IF GROCONUS=ZERO THEN       /*                       @G24LB26*/ 00247000
         L     @08,GROUPPTR                                        0284 00248000
         CLI   GROCONUS(@08),0                                     0284 00249000
         BNE   @RF00284                                            0284 00250000
*         DO;                       /*                       @G24LB26*/ 00251000
*                                                                  0285 00252000
*           /*********************************************************/ 00253000
*           /*                                                       */ 00254000
*           /* ZERO CONCURRENT USERS, THEREFORE GROUP        @G24LB26*/ 00255000
*           /* DOES NOT SUPPORT THIS FUNCTION. RETURN.       @G24LB26*/ 00256000
*           /*                                                       */ 00257000
*           /*********************************************************/ 00258000
*                                                                  0286 00259000
*           RPLRCODE=RCZERO;        /* SET ZERO REASON CODE  @G24LB26*/ 00260000
         MVC   RPLRCODE(2,RPLVPTR),@CB02111                        0286 00261000
*           RPLVRETC=RCZERO;        /* SET ZERO RETURN CODE  @G24LB26*/ 00262000
         MVC   RPLVRETC(2,RPLVPTR),@CB02111                        0287 00263000
*           EXITVSL=ON;             /* INDICATE DONE         @G24LB26*/ 00264000
         OI    EXITVSL,B'00100000'                                 0288 00265000
*         END;                      /*                       @G24LB26*/ 00266000
*                                                                  0289 00267000
*       /*************************************************************/ 00268000
*       /*                                                           */ 00269000
*       /* DETERMINE IF ANY GENERAL USE VOLUMES IN GROUP     @G24LB26*/ 00270000
*       /*                                                           */ 00271000
*       /*************************************************************/ 00272000
*                                                                  0290 00273000
*       ELSE                        /*                       @G24LB26*/ 00274000
*         IF GRONGEN=ZERO THEN      /*                       @G24LB26*/ 00275000
         B     @RC00284                                            0290 00276000
@RF00284 L     @08,GROUPPTR                                        0290 00277000
         LH    @08,GRONGEN(,@08)                                   0290 00278000
         LTR   @08,@08                                             0290 00279000
         BNZ   @RF00290                                            0290 00280000
*           DO;                     /*                       @G24LB26*/ 00281000
*                                                                  0291 00282000
*             /*******************************************************/ 00283000
*             /*                                                     */ 00284000
*             /* IF THERE ARE NO GENERAL USE VOLUMES IN      @G24LB26*/ 00285000
*             /* GROUP, ISSUE MESSAGE ICB407I AND RETURN     @G24LB26*/ 00286000
*             /*                                                     */ 00287000
*             /*******************************************************/ 00288000
*                                                                  0292 00289000
*             MSGRQ=MSGRQ&&MSGRQ;   /* CLEAR PARM LIST       @G24LB26*/ 00290000
         XC    MSGRQ(32),MSGRQ                                     0292 00291000
*             MSGRPLV=RPLVPTR;      /* RPLV ADDR             @G24LB26*/ 00292000
         ST    RPLVPTR,MSGRPLV                                     0293 00293000
*             MSGID=MSG407;         /* MESSAGE ID FOR ICB407I      0294 00294000
*                                                            @G24LB26*/ 00295000
         MVC   MSGID(4),@CF02061                                   0294 00296000
*             MSGLEN1=EIGHT;        /* LENGTH INSERT         @G24LB26*/ 00297000
         MVI   MSGLEN1,X'08'                                       0295 00298000
*             MSGTEXT1=ADDR(GROUPKY);/* INSERT GROUP NAME    @G24LB26*/ 00299000
         LA    @08,GROUPKY                                         0296 00300000
         STCM  @08,7,MSGTEXT1                                      0296 00301000
*             RESPECIFY                                            0297 00302000
*               REG1 RSTD;          /*                       @G24LB26*/ 00303000
*             REG1=ADDR(MSGRQ);     /* ADDR PARM LIST        @G24LB26*/ 00304000
         LA    REG1,MSGRQ                                          0298 00305000
*             CALL ICBVOP00;        /* ISSUE MESSAGE         @G24LB26*/ 00306000
         L     @15,@CV01912                                        0299 00307000
         BALR  @14,@15                                             0299 00308000
*             RESPECIFY                                            0300 00309000
*               REG1 UNRSTD;        /*                       @G24LB26*/ 00310000
*             RPLRCODE=SELFAIL;     /* REASON CODE OF HEX 232      0301 00311000
*                                                            @G24LB26*/ 00312000
         MVC   RPLRCODE(2,RPLVPTR),@CB02091                        0301 00313000
*             RPLVRETC=RCFOUR;      /* SET RETURN CODE       @G24LB26*/ 00314000
         MVC   RPLVRETC(2,RPLVPTR),@CB02113                        0302 00315000
*           END;                    /*                       @G24LB26*/ 00316000
*     END;                          /*                       @G24LB26*/ 00317000
*                                                                  0304 00318000
@RF00290 DS    0H                                                  0304 00319000
@RC00284 DS    0H                                                  0305 00320000
*   /*****************************************************************/ 00321000
*   /*                                                               */ 00322000
*   /* DETERMINE IF REQUEST IS FINISHED OR IF PROCESSING     @G24LB26*/ 00323000
*   /* SHOULD CONTINUE                                       @G24LB26*/ 00324000
*   /*                                                               */ 00325000
*   /*****************************************************************/ 00326000
*                                                                  0305 00327000
*   IF RPLVRETC=RCZERO&SELVOLRF=OFF&EXITVSL=OFF THEN/*       @G24LB26*/ 00328000
*                                                                  0305 00329000
@RF00282 CLC   RPLVRETC(2,RPLVPTR),@CB02111                        0305 00330000
         BNE   @RF00305                                            0305 00331000
         TM    SELVOLRF(SELTMPTR),B'00001000'                      0305 00332000
         BNZ   @RF00305                                            0305 00333000
         TM    EXITVSL,B'00100000'                                 0305 00334000
         BNZ   @RF00305                                            0305 00335000
*     /***************************************************************/ 00336000
*     /*                                                             */ 00337000
*     /* CALL ROUTINE TO DETERMINE IF VALID REQUEST          @G24LB26*/ 00338000
*     /*                                                             */ 00339000
*     /***************************************************************/ 00340000
*                                                                  0306 00341000
*     CALL SELSCREN;                /*                       @G24LB26*/ 00342000
         BAL   @14,SELSCREN                                        0306 00343000
*   IF RPLVRETC=RCZERO&SELVOLRF=OFF&EXITVSL=OFF THEN/*       @G24LB26*/ 00344000
@RF00305 CLC   RPLVRETC(2,RPLVPTR),@CB02111                        0307 00345000
         BNE   @RF00307                                            0307 00346000
         TM    SELVOLRF(SELTMPTR),B'00001000'                      0307 00347000
         BNZ   @RF00307                                            0307 00348000
         TM    EXITVSL,B'00100000'                                 0307 00349000
         BNZ   @RF00307                                            0307 00350000
*     DO;                           /*                       @G24LB26*/ 00351000
*                                                                  0308 00352000
*       /*************************************************************/ 00353000
*       /*                                                           */ 00354000
*       /* DETERMINE THE NUMBER OF VOLUMES TO BE SELECTED    @G24LB26*/ 00355000
*       /* FOR THIS REQUEST                                  @G24LB26*/ 00356000
*       /*                                                           */ 00357000
*       /*************************************************************/ 00358000
*                                                                  0309 00359000
*       IF SELPARMT=ON THEN         /*                       @G24LB26*/ 00360000
         TM    SELPARMT(SELTMPTR),B'10000000'                      0309 00361000
         BNO   @RF00309                                            0309 00362000
*         NUMBVOL=JFCBVLCT;         /*                       @G24LB26*/ 00363000
*                                                                  0310 00364000
         L     @08,JFCBPTR(,SELTMPTR)                              0310 00365000
         IC    @06,JFCBVLCT(,@08)                                  0310 00366000
         STC   @06,NUMBVOL                                         0310 00367000
*       /*************************************************************/ 00368000
*       /*                                                           */ 00369000
*       /* IF NOT PARALLEL MOUNT, UNIT COUNT IS DESIRED      @G24LB26*/ 00370000
*       /* NUMBER                                            @G24LB26*/ 00371000
*       /*                                                           */ 00372000
*       /*************************************************************/ 00373000
*                                                                  0311 00374000
*       ELSE                        /*                       @G24LB26*/ 00375000
*         NUMBVOL=SELUNCNT;         /*                       @G24LB26*/ 00376000
*                                                                  0311 00377000
         B     @RC00309                                            0311 00378000
@RF00309 IC    @08,SELUNCNT(,SELTMPTR)                             0311 00379000
         STC   @08,NUMBVOL                                         0311 00380000
*       /*************************************************************/ 00381000
*       /*                                                           */ 00382000
*       /* IF MORE VOLUMES THAN UNITS AND NOT PARALLEL       @G24LB26*/ 00383000
*       /* MOUNT, THEN REQUEST IS FOR NON-SHARE              @G24LB26*/ 00384000
*       /*                                                           */ 00385000
*       /*************************************************************/ 00386000
*                                                                  0312 00387000
*       IF JFCBVLCT>SELUNCNT&SELPARMT=OFF THEN/*             @G24LB26*/ 00388000
@RC00309 L     @08,JFCBPTR(,SELTMPTR)                              0312 00389000
         CLC   JFCBVLCT(1,@08),SELUNCNT(SELTMPTR)                  0312 00390000
         BNH   @RF00312                                            0312 00391000
         TM    SELPARMT(SELTMPTR),B'10000000'                      0312 00392000
         BNZ   @RF00312                                            0312 00393000
*         NSHRREQF=ON;              /* INDICATE NON-SHARE    @G24LB26   00394000
*                                      REQUEST               @G24LB26*/ 00395000
*                                                                  0313 00396000
         OI    NSHRREQF,B'10000000'                                0313 00397000
*       /*************************************************************/ 00398000
*       /*                                                           */ 00399000
*       /* DETERMINE IF THERE IS ENOUGH GENERAL USE VOLUMES  @G24LB26*/ 00400000
*       /* IN GROUP TO SATISFY THE REQUEST. EXIT IF NOT      @G24LB26*/ 00401000
*       /* ENOUGH.                                           @G24LB26*/ 00402000
*       /*                                                           */ 00403000
*       /*************************************************************/ 00404000
*                                                                  0314 00405000
*       IF NUMBVOL>GRONGEN THEN     /*                       @G24LB26*/ 00406000
@RF00312 SLR   @08,@08                                             0314 00407000
         IC    @08,NUMBVOL                                         0314 00408000
         L     @06,GROUPPTR                                        0314 00409000
         CH    @08,GRONGEN(,@06)                                   0314 00410000
         BNH   @RF00314                                            0314 00411000
*         DO;                       /*                       @G24LB26*/ 00412000
*                                                                  0315 00413000
*           /*********************************************************/ 00414000
*           /*                                                       */ 00415000
*           /* ISSUE ERROR MESSAGE ICB407I AND REASON CODE   @G24LB26*/ 00416000
*           /* HEX 232                                       @G24LB26*/ 00417000
*           /*                                                       */ 00418000
*           /*********************************************************/ 00419000
*                                                                  0316 00420000
*           MSGRQ=MSGRQ&&MSGRQ;     /* CLEAR PARM LIST       @G24LB26*/ 00421000
         XC    MSGRQ(32),MSGRQ                                     0316 00422000
*           MSGRPLV=RPLVPTR;        /* RPLV ADDR             @G24LB26*/ 00423000
         ST    RPLVPTR,MSGRPLV                                     0317 00424000
*           MSGID=MSG407;           /* MESSAGE ID FOR ICB407I      0318 00425000
*                                                            @G24LB26*/ 00426000
         MVC   MSGID(4),@CF02061                                   0318 00427000
*           MSGLEN1=EIGHT;          /* LENGTH INSERT         @G24LB26*/ 00428000
         MVI   MSGLEN1,X'08'                                       0319 00429000
*           MSGTEXT1=ADDR(GROUPKY); /* INSERT GROUP NAME     @G24LB26*/ 00430000
         LA    @08,GROUPKY                                         0320 00431000
         STCM  @08,7,MSGTEXT1                                      0320 00432000
*           RESPECIFY                                              0321 00433000
*             REG1 RSTD;            /*                       @G24LB26*/ 00434000
*           REG1=ADDR(MSGRQ);       /* ADDR PRINT PARM       @G24LB26*/ 00435000
         LA    REG1,MSGRQ                                          0322 00436000
*           CALL ICBVOP00;          /* ISSUE MESSAGE         @G24LB26*/ 00437000
         L     @15,@CV01912                                        0323 00438000
         BALR  @14,@15                                             0323 00439000
*           RESPECIFY                                              0324 00440000
*             REG1 UNRSTD;          /*                       @G24LB26*/ 00441000
*           RPLRCODE=SELFAIL;       /* REASON CODE OF HEX 232      0325 00442000
*                                                            @G24LB26*/ 00443000
         MVC   RPLRCODE(2,RPLVPTR),@CB02091                        0325 00444000
*           RPLVRETC=RCFOUR;        /* RETURN CODE 4         @G24LB26*/ 00445000
         MVC   RPLVRETC(2,RPLVPTR),@CB02113                        0326 00446000
*         END;                      /*                       @G24LB26*/ 00447000
*     END;                          /*                       @G24LB26*/ 00448000
*                                                                  0328 00449000
@RF00314 DS    0H                                                  0329 00450000
*   /*****************************************************************/ 00451000
*   /*                                                               */ 00452000
*   /* CHECK AGAIN                                           @G24LB26*/ 00453000
*   /*                                                               */ 00454000
*   /*****************************************************************/ 00455000
*                                                                  0329 00456000
*   IF RPLVRETC=RCZERO&SELVOLRF=OFF&EXITVSL=OFF THEN/*       @G24LB26*/ 00457000
@RF00307 CLC   RPLVRETC(2,RPLVPTR),@CB02111                        0329 00458000
         BNE   @RF00329                                            0329 00459000
         TM    SELVOLRF(SELTMPTR),B'00001000'                      0329 00460000
         BNZ   @RF00329                                            0329 00461000
         TM    EXITVSL,B'00100000'                                 0329 00462000
         BNZ   @RF00329                                            0329 00463000
*     DO;                           /*                       @G24LB26*/ 00464000
*                                                                  0330 00465000
*       /*************************************************************/ 00466000
*       /*                                                           */ 00467000
*       /* DETERMINE IF A GETMAIN REQUIRED FOR BEST FIT      @G24LB26*/ 00468000
*       /* TABLE                                             @G24LB26*/ 00469000
*       /*                                                           */ 00470000
*       /*************************************************************/ 00471000
*                                                                  0331 00472000
*       IF GRONGEN>GVSNSLOT THEN    /* IF GREATER THAN 48,   @G24LB26   00473000
*                                      MUST DO GETMAIN       @G24LB26*/ 00474000
         L     @08,GROUPPTR                                        0331 00475000
         LH    @08,GRONGEN(,@08)                                   0331 00476000
         C     @08,@CF00346                                        0331 00477000
         BNH   @RF00331                                            0331 00478000
*         DO;                       /*                       @G24LB26*/ 00479000
*                                                                  0332 00480000
*           /*********************************************************/ 00481000
*           /*                                                       */ 00482000
*           /* ISSUE GETMAIN AFTER CALCULATE SPACE REQUIRED  @G24LB26*/ 00483000
*           /*                                                       */ 00484000
*           /*********************************************************/ 00485000
*                                                                  0333 00486000
*           GETMNLEN=BFHEADLN+(GRONGEN*BFSLOTLN);/* LENGTH   @G24LB26*/ 00487000
         LR    @01,@08                                             0333 00488000
         SLR   @08,@08                                             0333 00489000
         IC    @08,BFSLOTLN                                        0333 00490000
         MR    @00,@08                                             0333 00491000
         SLR   @08,@08                                             0333 00492000
         IC    @08,BFHEADLN                                        0333 00493000
         ALR   @01,@08                                             0333 00494000
         STH   @01,GETMNLEN                                        0333 00495000
*           RESPECIFY                                              0334 00496000
*            (REG2,                                                0334 00497000
*             REG15) RSTD;          /*                       @G24LB26*/ 00498000
*           REG2=ADDR(BFTBLPTR);    /* ADDR OF LOCATION TO   @G24LB26   00499000
*                                      PLACE CORE ADDRESS    @G24LB26*/ 00500000
         LA    REG2,BFTBLPTR                                       0335 00501000
*           REG15=GETMNLEN;         /* LENGTH OF AREA NEEDED @G24LB26*/ 00502000
         LR    REG15,@01                                           0336 00503000
*LGETM1:                                                           0337 00504000
*           GEN REFS(REG2,REG15) SETS(REG15);                      0337 00505000
*                                                                  0337 00506000
LGETM1   DS    0H                                                  0337 00507000
*                                                         /*@G24LB26*/  00508000
       GETMAIN EC,LV=(REG15),A=(REG2),SP=241                  @G24LB26  00509000
*           /*********************************************************/ 00510000
*           /*                                                       */ 00511000
*           /* CHECK RETURN CODE                             @G24LB26*/ 00512000
*           /*                                                       */ 00513000
*           /*********************************************************/ 00514000
*                                                                  0338 00515000
*           IF REG15=RCZERO THEN    /*                       @G24LB26*/ 00516000
         LTR   REG15,REG15                                         0338 00517000
         BNZ   @RF00338                                            0338 00518000
*             DO;                   /*                       @G24LB26*/ 00519000
*                                                                  0339 00520000
*               /*****************************************************/ 00521000
*               /*                                                   */ 00522000
*               /* CLEAR HEADER SECTION OF BEST FIT TABLE    @G24LB26*/ 00523000
*               /*                                                   */ 00524000
*               /*****************************************************/ 00525000
*                                                                  0340 00526000
*               BFHEADER=BFHEADER&&BFHEADER;/*               @G24LB26*/ 00527000
*                                                                  0340 00528000
         L     @14,BFTBLPTR                                        0340 00529000
         XC    BFHEADER(21,@14),BFHEADER(@14)                      0340 00530000
*               /*****************************************************/ 00531000
*               /*                                                   */ 00532000
*               /* PUT LENGTH OF GETMAINED AREA IN FIRST     @G24LB26*/ 00533000
*               /* TWO BYTES OF AREA                         @G24LB26*/ 00534000
*               /*                                                   */ 00535000
*               /*****************************************************/ 00536000
*                                                                  0341 00537000
*               BFLEN=GETMNLEN;     /* PUT IN LENGTH         @G24LB26*/ 00538000
*                                                                  0341 00539000
         LH    @08,GETMNLEN                                        0341 00540000
         STH   @08,BFLEN(,@14)                                     0341 00541000
*               /*****************************************************/ 00542000
*               /*                                                   */ 00543000
*               /* PUT ADDRESS OF GETMAINED AREA IN VVICB    @G24LB26*/ 00544000
*               /*                                                   */ 00545000
*               /*****************************************************/ 00546000
*                                                                  0342 00547000
*               VVIVBSTF=BFTBLPTR;  /* ADDRESS IN VVICB      @G24LB26*/ 00548000
*                                                                  0342 00549000
         L     @08,VVIPTR                                          0342 00550000
         ST    @14,VVIVBSTF(,@08)                                  0342 00551000
*               /*****************************************************/ 00552000
*               /*                                                   */ 00553000
*               /* SET NON-SHARE FLAG FROM THE INTERNAL      @G24LB26*/ 00554000
*               /* WORK AREA                                 @G24LB26*/ 00555000
*               /*                                                   */ 00556000
*               /*****************************************************/ 00557000
*                                                                  0343 00558000
*               IF NSHRREQF=ON THEN /*                       @G24LB26*/ 00559000
         TM    NSHRREQF,B'10000000'                                0343 00560000
         BNO   @RF00343                                            0343 00561000
*                 BFNSHRFL=ON;      /*                       @G24LB26*/ 00562000
         OI    BFNSHRFL(@14),B'10000000'                           0344 00563000
*             END;                  /*                       @G24LB26*/ 00564000
*                                                                  0345 00565000
*           /*********************************************************/ 00566000
*           /*                                                       */ 00567000
*           /* GETMAIN UNSUCCESSFUL                          @G24LB26*/ 00568000
*           /*                                                       */ 00569000
*           /*********************************************************/ 00570000
*                                                                  0346 00571000
*           ELSE                    /*                       @G24LB26*/ 00572000
*             DO;                   /*                       @G24LB26*/ 00573000
*                                                                  0346 00574000
         B     @RC00338                                            0346 00575000
@RF00338 DS    0H                                                  0347 00576000
*               /*****************************************************/ 00577000
*               /*                                                   */ 00578000
*               /* IF GETMAIN FAILURE, ISSUE MESSAGE ICB409I @G24LB26*/ 00579000
*               /* AND REASON CODE 22A. EXIT PROGRAM         @G24LB26*/ 00580000
*               /*                                                   */ 00581000
*               /*****************************************************/ 00582000
*                                                                  0347 00583000
*               MSGRQ=MSGRQ&&MSGRQ; /* CLEAR PARM LIST       @G24LB26*/ 00584000
         XC    MSGRQ(32),MSGRQ                                     0347 00585000
*               MSGRPLV=RPLVPTR;    /* RPLV ADDR             @G24LB26*/ 00586000
         ST    RPLVPTR,MSGRPLV                                     0348 00587000
*               MSGID=MSG409;       /* MESSAGE ID FOR ICB409I      0349 00588000
*                                                            @G24LB26*/ 00589000
         MVC   MSGID(4),@CF02063                                   0349 00590000
*               RESPECIFY                                          0350 00591000
*                 REG1 RSTD;        /*                       @G24LB26*/ 00592000
*               REG1=ADDR(MSGRQ);   /* ADDR OF REQUEST BLOCK @G24LB26*/ 00593000
         LA    REG1,MSGRQ                                          0351 00594000
*               CALL ICBVOP00;      /* ISSUE MESSAGE         @G24LB26*/ 00595000
         L     @15,@CV01912                                        0352 00596000
         BALR  @14,@15                                             0352 00597000
*               RESPECIFY                                          0353 00598000
*                 REG1 UNRSTD;      /*                       @G24LB26*/ 00599000
*               RPLRCODE=NOSTORAG;  /* SET 22A REASON CODE   @G24LB26*/ 00600000
         MVC   RPLRCODE(2,RPLVPTR),@CB02079                        0354 00601000
*               RPLVRETC=RCFOUR;    /* SET RETURN CODE TO 4  @G24LB26*/ 00602000
         MVC   RPLVRETC(2,RPLVPTR),@CB02113                        0355 00603000
*             END;                  /*                       @G24LB26*/ 00604000
*           RESPECIFY                                              0357 00605000
*            (REG2,                                                0357 00606000
*             REG15) UNRSTD;        /*                       @G24LB26*/ 00607000
@RC00338 DS    0H                                                  0358 00608000
*         END;                      /*                       @G24LB26*/ 00609000
*                                                                  0358 00610000
*       /*************************************************************/ 00611000
*       /*                                                           */ 00612000
*       /* IF THERE ARE LESS THAN 48 VOLUMES IN GROUP,       @G24LB26*/ 00613000
*       /* USE BEST FIT TABLES IN PROGRAM                    @G24LB26*/ 00614000
*       /*                                                           */ 00615000
*       /*************************************************************/ 00616000
*                                                                  0359 00617000
*       ELSE                        /*                       @G24LB26*/ 00618000
*         DO;                       /*                       @G24LB26*/ 00619000
         B     @RC00331                                            0359 00620000
@RF00331 DS    0H                                                  0360 00621000
*           BFTBLPTR=ADDR(STRBFTBL);/* SET UP ADDRESSABILITY @G24LB26   00622000
*                                      TO BEST FIT TABLE     @G24LB26*/ 00623000
*                                                                  0360 00624000
         LA    @08,STRBFTBL                                        0360 00625000
         ST    @08,BFTBLPTR                                        0360 00626000
*           /*********************************************************/ 00627000
*           /*                                                       */ 00628000
*           /* CLEAR HEADER SECTION OF BEST FIT TABLE        @G24LB26*/ 00629000
*           /*                                                       */ 00630000
*           /*********************************************************/ 00631000
*                                                                  0361 00632000
*           BFHEADER=BFHEADER&&BFHEADER;/*                   @G24LB26*/ 00633000
         XC    BFHEADER(21,@08),BFHEADER(@08)                      0361 00634000
*           BFLEN=LENGTH(STRBFTBL); /* PUT IN LENGTH OF TABLE      0362 00635000
*                                                            @G24LB26*/ 00636000
*                                                                  0362 00637000
         MVC   BFLEN(2,@08),@CH02238                               0362 00638000
*           /*********************************************************/ 00639000
*           /*                                                       */ 00640000
*           /* NOW THAT ADDRESSING SET UP TO BEST FIT TABLE  @G24LB26*/ 00641000
*           /* SET NON-SHARE FLAG FROM INTERNAL WORK AREA.   @G24LB26*/ 00642000
*           /*                                                       */ 00643000
*           /*********************************************************/ 00644000
*                                                                  0363 00645000
*           IF NSHRREQF=ON THEN     /*                       @G24LB26*/ 00646000
         TM    NSHRREQF,B'10000000'                                0363 00647000
         BNO   @RF00363                                            0363 00648000
*             BFNSHRFL=ON;          /*                       @G24LB26*/ 00649000
         OI    BFNSHRFL(@08),B'10000000'                           0364 00650000
*         END;                      /*                       @G24LB26*/ 00651000
@RF00363 DS    0H                                                  0366 00652000
*     END;                          /*                       @G24LB26*/ 00653000
*                                                                  0366 00654000
@RC00331 DS    0H                                                  0367 00655000
*   /*****************************************************************/ 00656000
*   /*                                                               */ 00657000
*   /* CHECK IF PROGRAM HAS ENCOUNTERED ERROR YET.           @G24LB26*/ 00658000
*   /* IF NOT, CONTINUE                                      @G24LB26*/ 00659000
*   /*                                                               */ 00660000
*   /*****************************************************************/ 00661000
*                                                                  0367 00662000
*   IF RPLVRETC=RCZERO&SELVOLRF=OFF&EXITVSL=OFF THEN/*       @G24LB26*/ 00663000
@RF00329 CLC   RPLVRETC(2,RPLVPTR),@CB02111                        0367 00664000
         BNE   @RF00367                                            0367 00665000
         TM    SELVOLRF(SELTMPTR),B'00001000'                      0367 00666000
         BNZ   @RF00367                                            0367 00667000
         TM    EXITVSL,B'00100000'                                 0367 00668000
         BNZ   @RF00367                                            0367 00669000
*     DO;                           /*                       @G24LB26*/ 00670000
*                                                                  0368 00671000
*       /*************************************************************/ 00672000
*       /*                                                           */ 00673000
*       /* CALL SELECTVOL ROUTINE TO SELECT VOLUMES          @G24LB26*/ 00674000
*       /*                                                           */ 00675000
*       /*************************************************************/ 00676000
*                                                                  0369 00677000
*       CALL SELCTVOL;              /*                       @G24LB26*/ 00678000
*                                                                  0369 00679000
         BAL   @14,SELCTVOL                                        0369 00680000
*       /*************************************************************/ 00681000
*       /*                                                           */ 00682000
*       /* IF GETMAIN ISSUED, FREE STORAGE OBTAINED          @G24LB26*/ 00683000
*       /*                                                           */ 00684000
*       /*************************************************************/ 00685000
*                                                                  0370 00686000
*       IF VVIVBSTF^=ZERO THEN      /*                       @G24LB26*/ 00687000
         SLR   @08,@08                                             0370 00688000
         L     @15,VVIPTR                                          0370 00689000
         C     @08,VVIVBSTF(,@15)                                  0370 00690000
         BE    @RF00370                                            0370 00691000
*         DO;                       /*                       @G24LB26*/ 00692000
*                                                                  0371 00693000
*           /*********************************************************/ 00694000
*           /*                                                       */ 00695000
*           /* ZERO OUT GETMAINED ADDRESS IN VVICB SO        @G24LB26*/ 00696000
*           /* THAT NO ATTEMPT WILL BE MADE TO FREE IT AGAIN @G24LB26*/ 00697000
*           /*                                                       */ 00698000
*           /*********************************************************/ 00699000
*                                                                  0372 00700000
*           VVIVBSTF=ZERO;          /*                       @G24LB26*/ 00701000
*                                                                  0372 00702000
         ST    @08,VVIVBSTF(,@15)                                  0372 00703000
*           /*********************************************************/ 00704000
*           /*                                                       */ 00705000
*           /* ISSUE FREEMAIN FOR BEST FIT TABLE             @G24LB26*/ 00706000
*           /*                                                       */ 00707000
*           /*********************************************************/ 00708000
*                                                                  0373 00709000
*           RESPECIFY                                              0373 00710000
*            (REG2,                                                0373 00711000
*             REG15) RSTD;          /*                       @G24LB26*/ 00712000
*           REG2=ADDR(BFTBLPTR);    /* LOCATION              @G24LB26   00713000
*                                      TO BE FREED           @G24LB26*/ 00714000
         LA    REG2,BFTBLPTR                                       0374 00715000
*           REG15=GETMNLEN;         /* LENGTH OF GETMAINED   @G24LB26   00716000
*                                      AREA.                 @G24LB26*/ 00717000
         LH    REG15,GETMNLEN                                      0375 00718000
*LFREEM1:                                                          0376 00719000
*           GEN REFS(REG2,REG15) SETS(REG15);                      0376 00720000
LFREEM1  DS    0H                                                  0376 00721000
*                                                         /*@G24LB26*/  00722000
         FREEMAIN E,LV=(REG15),A=(REG2),SP=241                @G24LB26  00723000
*           RESPECIFY                                              0377 00724000
*            (REG2,                                                0377 00725000
*             REG15) UNRSTD;        /*                       @G24LB26*/ 00726000
*         END;                      /*                       @G24LB26*/ 00727000
*     END;                          /*                       @G24LB26*/ 00728000
*   RETURN;                         /* RETURN TO CONTROLLER  @G24LB26*/ 00729000
@EL00001 L     @13,4(,@13)                                         0380 00730000
@EF00001 DS    0H                                                  0380 00731000
@ER00001 LM    @14,@12,12(@13)                                     0380 00732000
         BR    @14                                                 0380 00733000
*                                                                  0381 00734000
*/*********************************************************  @G24LB26*/ 00735000
*/*                                                          @G24LB26*/ 00736000
*/* PROCEDURE NAME - SELSCREN                                @G24LB26*/ 00737000
*/*                                                          @G24LB26*/ 00738000
*/* FUNCTION - DETERMINES IF REQUEST CAN BE PROCESSED ON THE @G24LB26*/ 00739000
*/*            BASIS OF DATA SET ORGANIZAITON AND SPACE      @G24LB26*/ 00740000
*/*            REQUIREMENTS. SPACE MUST BE SPECIFIED ON      @G24LB26*/ 00741000
*/*            PARTITIONED OR INDEXED ORGANIZATION. SPACE    @G24LB26*/ 00742000
*/*            MAY NOT BE ALLOCATED IN MIXG, ALX, OR ABSTR   @G24LB26*/ 00743000
*/*            UNITS.                                        @G24LB26*/ 00744000
*/*                                                          @G24LB26*/ 00745000
*/* INPUT - JFCB (JOB FILE CONTROL BLOCK)                    @G24LB26*/ 00746000
*/*                                                          @G24LB26*/ 00747000
*/* OUTPUT - REASON CODES AND RETURN CODE RETURNED IN RPLV   @G24LB26*/ 00748000
*/*          '022F'X PARTITIONED OR INDEXED ORGANIZATION     @G24LB26*/ 00749000
*/*          AND NO SPACE SPECIFIED                          @G24LB26*/ 00750000
*/*          '022C'X SPACE ALLOCATED IN MIXG, ALX, OR ABSTR  @G24LB26*/ 00751000
*/*          RETURN CODES                                    @G24LB26*/ 00752000
*/*               0 = REQUEST OK                             @G24LB26*/ 00753000
*/*               4 = REQUEST FAILED                         @G24LB26*/ 00754000
*/*                                                          @G24LB26*/ 00755000
*/*********************************************************  @G24LB26*/ 00756000
*                                                                  0381 00757000
*SELSCREN:                                                         0381 00758000
*   PROC OPTIONS(SAVE(REG14));      /*                       @G24LB26*/ 00759000
*                                                                  0381 00760000
         B     @EL00001                                            0381 00761000
SELSCREN ST    @14,12(,@13)                                        0381 00762000
*   /*****************************************************************/ 00763000
*   /*                                                               */ 00764000
*   /* DETERMINE IF PARTITIONED OR INDEXED ORGANIZATION.     @G24LB26*/ 00765000
*   /*                                                               */ 00766000
*   /*****************************************************************/ 00767000
*                                                                  0382 00768000
*   IF JFCORGIS=ON|JFCORGPO=ON THEN /*                       @G24LB26*/ 00769000
         L     @08,JFCBPTR(,SELTMPTR)                              0382 00770000
         TM    JFCORGIS(@08),B'10000010'                           0382 00771000
         BZ    @RF00382                                            0382 00772000
*     DO;                           /*                       @G24LB26*/ 00773000
*                                                                  0383 00774000
*       /*************************************************************/ 00775000
*       /*                                                           */ 00776000
*       /* CHECK TO DETERMINE IF SPACE WAS SPECIFIED. IF     @G24LB26*/ 00777000
*       /* NO SPACE, SET FAILING REASON AND RETURN CODE.     @G24LB26*/ 00778000
*       /*                                                           */ 00779000
*       /*************************************************************/ 00780000
*                                                                  0384 00781000
*       IF PQTY=ZERO&SQTY=ZERO&JFCBSPAC=NOSPACE&/*           @G24LB26*/ 00782000
*           JFCBABST=ZERO THEN      /*                       @G24LB26*/ 00783000
*                                                                  0384 00784000
         ICM   @06,7,PQTY(@08)                                     0384 00785000
         BNZ   @RF00384                                            0384 00786000
         ICM   @06,7,SQTY(@08)                                     0384 00787000
         BNZ   @RF00384                                            0384 00788000
         TM    JFCBSPAC(@08),B'11000000'                           0384 00789000
         BNZ   @RF00384                                            0384 00790000
         LH    @08,JFCBABST(,@08)                                  0384 00791000
         LTR   @08,@08                                             0384 00792000
         BNZ   @RF00384                                            0384 00793000
*         /***********************************************************/ 00794000
*         /*                                                         */ 00795000
*         /* SET REASON CODE TO HEX 22F, RETURN CODE TO 4.   @G24LB26*/ 00796000
*         /*                                                         */ 00797000
*         /***********************************************************/ 00798000
*                                                                  0385 00799000
*         DO;                       /*                       @G24LB26*/ 00800000
*           RPLRCODE=NOSPACRC;      /*                       @G24LB26*/ 00801000
         MVC   RPLRCODE(2,RPLVPTR),@CB02087                        0386 00802000
*           RPLVRETC=RCFOUR;        /*                       @G24LB26*/ 00803000
         MVC   RPLVRETC(2,RPLVPTR),@CB02113                        0387 00804000
*         END;                      /*                       @G24LB26*/ 00805000
*     END;                          /*                       @G24LB26*/ 00806000
*                                                                  0389 00807000
@RF00384 DS    0H                                                  0390 00808000
*   /*****************************************************************/ 00809000
*   /*                                                               */ 00810000
*   /* DETERMINE IF NECESSARY TO CHECK ON THE CORRECT UNITS  @G24LB26*/ 00811000
*   /* FOR SPACE ALLOCATION.                                 @G24LB26*/ 00812000
*   /*                                                               */ 00813000
*   /*****************************************************************/ 00814000
*                                                                  0390 00815000
*   IF RPLVRETC=RCZERO THEN         /*                       @G24LB26*/ 00816000
@RF00382 CLC   RPLVRETC(2,RPLVPTR),@CB02111                        0390 00817000
         BNE   @RF00390                                            0390 00818000
*     DO;                           /*                       @G24LB26*/ 00819000
*                                                                  0391 00820000
*       /*************************************************************/ 00821000
*       /*                                                           */ 00822000
*       /* CHECK ON UNITS SPACE ALLOCATED IN ABSOLUTE,       @G24LB26*/ 00823000
*       /* MIXG OR ALX.                                      @G24LB26*/ 00824000
*       /*                                                           */ 00825000
*       /*************************************************************/ 00826000
*                                                                  0392 00827000
*       IF(JFCBSPAC=ABSTRSPA&JFCBABST^=ZERO)|/*              @G24LB26*/ 00828000
*           JFCMIXG=ON|JFCALX=ON THEN/*                      @G24LB26*/ 00829000
         L     @08,JFCBPTR(,SELTMPTR)                              0392 00830000
         TM    JFCBSPAC(@08),B'11000000'                           0392 00831000
         BNZ   @GL00015                                            0392 00832000
         LH    @08,JFCBABST(,@08)                                  0392 00833000
         LTR   @08,@08                                             0392 00834000
         BNZ   @RT00392                                            0392 00835000
@GL00015 L     @08,JFCBPTR(,SELTMPTR)                              0392 00836000
         TM    JFCMIXG(@08),B'00000110'                            0392 00837000
         BZ    @RF00392                                            0392 00838000
@RT00392 DS    0H                                                  0393 00839000
*         DO;                       /*                       @G24LB26*/ 00840000
*                                                                  0393 00841000
*           /*********************************************************/ 00842000
*           /*                                                       */ 00843000
*           /* SET REASON CODE TO 22C AND RETURN CODE TO 4.  @G24LB26*/ 00844000
*           /*                                                       */ 00845000
*           /*********************************************************/ 00846000
*                                                                  0394 00847000
*           RPLRCODE=BADTYPSP;      /*                       @G24LB26*/ 00848000
         MVC   RPLRCODE(2,RPLVPTR),@CB02085                        0394 00849000
*           RPLVRETC=RCFOUR;        /*                       @G24LB26*/ 00850000
         MVC   RPLVRETC(2,RPLVPTR),@CB02113                        0395 00851000
*         END;                      /*                       @G24LB26*/ 00852000
*     END;                          /*                       @G24LB26*/ 00853000
*   RETURN;                         /*                       @G24LB26*/ 00854000
@EL00002 DS    0H                                                  0398 00855000
@EF00002 DS    0H                                                  0398 00856000
@ER00002 L     @14,12(,@13)                                        0398 00857000
         BR    @14                                                 0398 00858000
*   END SELSCREN;                   /*                       @G24LB26*/ 00859000
         B     @EL00002                                            0399 00860000
*                                                                  0400 00861000
*/*********************************************************  @G24LB26*/ 00862000
*/*                                                          @G24LB26*/ 00863000
*/* PROCEDURE NAME - SELCTVOL                                @G24LB26*/ 00864000
*/*                                                          @G24LB26*/ 00865000
*/* FUNCTION - MAIN DRIVER ROUTINE FOR THE SELECTION         @G24LB26*/ 00866000
*/*            PROCESS. HANDLES THE GROUP EXTENSION READING  @G24LB26*/ 00867000
*/*            AND PASSES VOLUMES TO ROUTINES TO BUILD A     @G24LB26*/ 00868000
*/*            BEST FIT TABLE, SORT THE BEST FIT TABLE       @G24LB26*/ 00869000
*/*            AFTER IT IS BUILT AND FINALLY CALLS A ROUTINE @G24LB26*/ 00870000
*/*            TO SELECT A SATISFACTORY VOLUME OR VOLUMES    @G24LB26*/ 00871000
*/*            FOR THE REQUEST.                              @G24LB26*/ 00872000
*/*                                                          @G24LB26*/ 00873000
*/* INPUT - THE SELECT REQUEST BLOCK, THE GROUP RECORD,      @G24LB26*/ 00874000
*/*         AND THE GROUP EXTENSION RECORDS FROM THE MSVI.   @G24LB26*/ 00875000
*/*         ALSO THE STATUS OF THE VOLUME AS TO ITS MOUNT    @G24LB26*/ 00876000
*/*         STATUS FOR THE ELGIBLCK ROUTINE.                 @G24LB26*/ 00877000
*/*                                                          @G24LB26*/ 00878000
*/* OUTPUT - A ZERO RETURN CODE IN THE RPLV WITH SELECTED    @G24LB26*/ 00879000
*/*          VOLUMES IN THE VOLUME RETURN AREA OR A NON-     @G24LB26*/ 00880000
*/*          ZERO RETURN CODE IN THE RPLV WHICH WILL FAIL    @G24LB26*/ 00881000
*/*          THE REQUEST. REASON CODES RETURNED FOR FAILURES @G24LB26*/ 00882000
*/*          ARE AS FOLLOWS:                                 @G24LB26*/ 00883000
*/*          '0231'X - UNABLE TO READ THE EXTENSION RECORD.  @G24LB26*/ 00884000
*/*          '0232'X - REQUIRED NUMBER OF VOLUMES COULD NOT  @G24LB26*/ 00885000
*/*                    BE SELECTED FOR THE REQUEST.          @G24LB26*/ 00886000
*/*          ISSUE MESSAGE ICB407I.                          @G24LB26*/ 00887000
*/*                                                          @G24LB26*/ 00888000
*/*********************************************************  @G24LB26*/ 00889000
*                                                                  0400 00890000
*SELCTVOL:                                                         0400 00891000
*   PROC OPTIONS(SAVE(REG14));      /*                       @G24LB26*/ 00892000
*                                                                  0400 00893000
SELCTVOL ST    @14,@SA00003                                        0400 00894000
*   /*****************************************************************/ 00895000
*   /*                                                               */ 00896000
*   /* CLEAR GROUP PARAMETER RETURN AREA FOR TABLE PROCESSOR @G24LB26*/ 00897000
*   /* ALSO ZERO NUMBER OF VOLUMES SELECTED COUNT IN         @G24LB26*/ 00898000
*   /* VOLUME RETURN AREA                                    @G24LB26*/ 00899000
*   /*                                                               */ 00900000
*   /*****************************************************************/ 00901000
*                                                                  0401 00902000
*   GRPPR=GRPPR&&GRPPR;             /*                       @G24LB26*/ 00903000
         L     @08,SELGRPPR(,SELTMPTR)                             0401 00904000
         XC    GRPPR(12,@08),GRPPR(@08)                            0401 00905000
*   VOLNUM=ZERO;                    /*                       @G24LB26*/ 00906000
*                                                                  0402 00907000
         SLR   @08,@08                                             0402 00908000
         L     @04,SELVLRET(,SELTMPTR)                             0402 00909000
         STH   @08,VOLNUM(,@04)                                    0402 00910000
*   /*****************************************************************/ 00911000
*   /*                                                               */ 00912000
*   /* INITIALIZE BEST FIT TABLE INDEX TO ONE                @G24LB26*/ 00913000
*   /*                                                               */ 00914000
*   /*****************************************************************/ 00915000
*                                                                  0403 00916000
*   INDXBFTB=ONE;                   /*                       @G24LB26*/ 00917000
*                                                                  0403 00918000
         LA    INDXBFTB,1                                          0403 00919000
*   /*****************************************************************/ 00920000
*   /*                                                               */ 00921000
*   /* INITIALIZE LOOP SWITCH                                @G24LB26*/ 00922000
*   /*                                                               */ 00923000
*   /*****************************************************************/ 00924000
*                                                                  0404 00925000
*   EXITSW=OFF;                     /*                       @G24LB26*/ 00926000
*                                                                  0404 00927000
         NI    EXITSW,B'11101111'                                  0404 00928000
*   /*****************************************************************/ 00929000
*   /*                                                               */ 00930000
*   /* INITIALIZE SELECTABLE SPACE FOR THIS REQUEST TO       @ZA28479*/ 00931000
*   /* ZERO BEFORE STARTING TO PROCESS VOLUMES IN GROUP      @ZA28479*/ 00932000
*   /*                                                               */ 00933000
*   /*****************************************************************/ 00934000
*                                                                  0405 00935000
*   SLGRPSPA=ZERO;                  /*                       @ZA28479*/ 00936000
*                                                                  0405 00937000
         ST    @08,SLGRPSPA                                        0405 00938000
*   /*****************************************************************/ 00939000
*   /*                                                               */ 00940000
*   /* INITIALIZE HEADER FIELDS IN THE BEST FIT TABLE        @G24LB26*/ 00941000
*   /*                                                               */ 00942000
*   /*****************************************************************/ 00943000
*                                                                  0406 00944000
*   BFGROUP=GROVVGRP;               /* SET GROUP NAME        @G24LB26*/ 00945000
*                                                                  0406 00946000
         L     @04,BFTBLPTR                                        0406 00947000
         L     @01,GROUPPTR                                        0406 00948000
         MVC   BFGROUP(8,@04),GROVVGRP(@01)                        0406 00949000
*   /*****************************************************************/ 00950000
*   /*                                                               */ 00951000
*   /* IF SPECIFIC UNIT REQUEST, PUT UCB ADDR IN BEST FIT    @G24LB26*/ 00952000
*   /* TABLE. IF NOT, PUT DEVICE TYPE IN BEST FIT TABLE.     @G24LB26*/ 00953000
*   /*                                                               */ 00954000
*   /*****************************************************************/ 00955000
*                                                                  0407 00956000
*   IF SELUCBAD=ZERO THEN           /*                       @G24LB26*/ 00957000
         C     @08,SELUCBAD(,SELTMPTR)                             0407 00958000
         BNE   @RF00407                                            0407 00959000
*     BFDEVTP=SELDEVTP;             /*                       @G24LB26*/ 00960000
         L     @08,SELDEVTP(,SELTMPTR)                             0408 00961000
         ST    @08,BFDEVTP(,@04)                                   0408 00962000
*   ELSE                            /*                       @G24LB26*/ 00963000
*     BFDEVTP=SELUCBAD;             /*                       @G24LB26*/ 00964000
         B     @RC00407                                            0409 00965000
@RF00407 L     @08,SELUCBAD(,SELTMPTR)                             0409 00966000
         L     @04,BFTBLPTR                                        0409 00967000
         ST    @08,BFDEVTP(,@04)                                   0409 00968000
*   BFJOBID=SELJOBID;               /* INITIALIZE JOB        @G24LB26   00969000
*                                      IDENTIFIER            @G24LB26*/ 00970000
*                                                                  0410 00971000
@RC00407 L     @08,SELJOBID(,SELTMPTR)                             0410 00972000
         L     @04,BFTBLPTR                                        0410 00973000
         ST    @08,BFJOBID(,@04)                                   0410 00974000
*   /*****************************************************************/ 00975000
*   /*                                                               */ 00976000
*   /* INITIALIZE GROUP EXTENSION KEY VALUES                 @G24LB26*/ 00977000
*   /*                                                               */ 00978000
*   /*****************************************************************/ 00979000
*                                                                  0411 00980000
*   GBLKKY=BLANK;                   /*                       @G24LB26*/ 00981000
         MVI   GBLKKY,C' '                                         0411 00982000
*   GVSNO=ZERO;                     /*                       @G24LB26*/ 00983000
         L     @08,GVSNEPTR                                        0412 00984000
         MVI   GVSNO(@08),X'00'                                    0412 00985000
*   GROUPKY=GROVVGRP;               /*                       @G24LB26*/ 00986000
*                                                                  0413 00987000
         L     @08,GROUPPTR                                        0413 00988000
         MVC   GROUPKY(8),GROVVGRP(@08)                            0413 00989000
*   /*****************************************************************/ 00990000
*   /*                                                               */ 00991000
*   /* SET UP RPLV TO READ GROUP EXTENSION RECORD            @G24LB26*/ 00992000
*   /*                                                               */ 00993000
*   /*****************************************************************/ 00994000
*                                                                  0414 00995000
*   RPLVKEY=ADDR(GKEY);             /* ADDR OF KEY           @G24LB26*/ 00996000
         LA    @08,GKEY                                            0414 00997000
         ST    @08,RPLVKEY(,RPLVPTR)                               0414 00998000
*   RPLVBUF=ADDR(STORGPEX);         /* ADDR RETURN BUFFER    @G24LB26*/ 00999000
         LA    @08,STORGPEX                                        0415 01000000
         ST    @08,RPLVBUF(,RPLVPTR)                               0415 01001000
*   RPLVBLN=LENGTH(STORGPEX);       /* LENGTH OF RECORD BUF  @G24LB26*/ 01002000
         MVC   RPLVBLN(4,RPLVPTR),@CF02239                         0416 01003000
*   RPLVDIR=ON;                     /* READ DIRECT           @G24LB26*/ 01004000
         OI    RPLVDIR(RPLVPTR),B'01000000'                        0417 01005000
*   RPLVTYP=RPLVREAD;               /* READ RECORD           @G24LB26*/ 01006000
         MVI   RPLVTYP(RPLVPTR),X'00'                              0418 01007000
*   RPLVKGE=ON;                     /* KEY GREATER THAN OR = @G24LB26*/ 01008000
         OI    RPLVKGE(RPLVPTR),B'00000100'                        0419 01009000
*   RPLVUPD=ON;                     /* FOR UPDATE            @ZA28479*/ 01010000
*                                                                  0420 01011000
         OI    RPLVUPD(RPLVPTR),B'00000010'                        0420 01012000
*   /*****************************************************************/ 01013000
*   /*                                                               */ 01014000
*   /* SET UP OUTSIDE DO LOOP TO READ EACH EXTENSION RECORD  @G24LB26*/ 01015000
*   /*                                                               */ 01016000
*   /*****************************************************************/ 01017000
*                                                                  0421 01018000
*   DO WHILE EXITSW=OFF;            /* LOOP THROUGH EXTENSION      0421 01019000
*                                                            @G24LB26*/ 01020000
*                                                                  0421 01021000
         B     @DE00421                                            0421 01022000
@DL00421 DS    0H                                                  0422 01023000
*     /***************************************************************/ 01024000
*     /*                                                             */ 01025000
*     /* SET UP INDEX TO READ NEXT RECORD                    @G24LB26*/ 01026000
*     /*                                                             */ 01027000
*     /***************************************************************/ 01028000
*                                                                  0422 01029000
*     GIDKY=GVSNO;                  /*                       @G24LB26*/ 01030000
         L     @08,GVSNEPTR                                        0422 01031000
         SLR   @04,@04                                             0422 01032000
         IC    @04,GVSNO(,@08)                                     0422 01033000
         STC   @04,GIDKY                                           0422 01034000
*     GIDKY=GIDKY+ONE;              /*                       @G24LB26*/ 01035000
*                                                                  0423 01036000
         LA    @04,1(,@04)                                         0423 01037000
         STC   @04,GIDKY                                           0423 01038000
*     /***************************************************************/ 01039000
*     /*                                                             */ 01040000
*     /* CALL THE I/O PROCESSOR TO READ THE GROUP            @G24LB26*/ 01041000
*     /* EXTENSION RECORD                                    @G24LB26*/ 01042000
*     /*                                                             */ 01043000
*     /***************************************************************/ 01044000
*                                                                  0424 01045000
*     RESPECIFY                                                    0424 01046000
*       REG1 RSTD;                  /*                       @G24LB26*/ 01047000
*     REG1=RPLVPTR;                 /*                       @G24LB26*/ 01048000
         LR    REG1,RPLVPTR                                        0425 01049000
*     CALL ICBVIO00;                /*                       @G24LB26*/ 01050000
         L     @15,@CV01910                                        0426 01051000
         BALR  @14,@15                                             0426 01052000
*     RESPECIFY                                                    0427 01053000
*       REG1 UNRSTD;                /*                       @G24LB26*/ 01054000
*                                                                  0427 01055000
*     /***************************************************************/ 01056000
*     /*                                                             */ 01057000
*     /* DETERMINE IF PROPER GROUP EXTENSION RECORD RETURNED @G24LB26*/ 01058000
*     /*                                                             */ 01059000
*     /***************************************************************/ 01060000
*                                                                  0428 01061000
*     IF RPLVRETC^=RCZERO|GVSVVGRP^=GROVVGRP THEN/*          @G24LB26*/ 01062000
*                                                                  0428 01063000
         CLC   RPLVRETC(2,RPLVPTR),@CB02111                        0428 01064000
         BNE   @RT00428                                            0428 01065000
         L     @08,GVSNEPTR                                        0428 01066000
         L     @04,GROUPPTR                                        0428 01067000
         CLC   GVSVVGRP(8,@08),GROVVGRP(@04)                       0428 01068000
         BE    @RF00428                                            0428 01069000
@RT00428 DS    0H                                                  0429 01070000
*       /*************************************************************/ 01071000
*       /*                                                           */ 01072000
*       /* IF THE EXTENSION RECORD COULD NOT BE LOCATED,     @G24LB26*/ 01073000
*       /* ISSUE ERROR MESSAGE AND FAIL REQUEST              @G24LB26*/ 01074000
*       /*                                                           */ 01075000
*       /*************************************************************/ 01076000
*                                                                  0429 01077000
*       DO;                         /*                       @G24LB26*/ 01078000
*                                                                  0429 01079000
*         /***********************************************************/ 01080000
*         /*                                                         */ 01081000
*         /* ISSUE ERROR MESSAGE ICB415I AND EXIT ROUTINE    @G24LB26*/ 01082000
*         /* WITH NON-ZERO REASON AND RETURN CODES           @G24LB26*/ 01083000
*         /*                                                         */ 01084000
*         /***********************************************************/ 01085000
*                                                                  0430 01086000
*         MSGRQ=MSGRQ&&MSGRQ;       /* ZERO MSG REQUEST BLK  @G24LB26*/ 01087000
         XC    MSGRQ(32),MSGRQ                                     0430 01088000
*         MSGRPLV=RPLVPTR;          /* RPLV ADDR             @G24LB26*/ 01089000
         ST    RPLVPTR,MSGRPLV                                     0431 01090000
*         MSGID=MSG415;             /* MESSAGE ICB415I ID    @G24LB26*/ 01091000
         MVC   MSGID(4),@CF02065                                   0432 01092000
*         MSGLEN1=EIGHT;            /* LENGTH OF GROUP NAME  @G24LB26*/ 01093000
         MVI   MSGLEN1,X'08'                                       0433 01094000
*         MSGTEXT1=ADDR(GROVVGRP);  /* GROUP NAME            @G24LB26*/ 01095000
         L     @08,GROUPPTR                                        0434 01096000
         LA    @08,GROVVGRP(,@08)                                  0434 01097000
         STCM  @08,7,MSGTEXT1                                      0434 01098000
*         RESPECIFY                                                0435 01099000
*           REG1 RSTD;              /*                       @G24LB26*/ 01100000
*         REG1=ADDR(MSGRQ);         /* ADDR MESSAGE PARM     @G24LB26*/ 01101000
         LA    REG1,MSGRQ                                          0436 01102000
*         CALL ICBVOP00;            /* ISSUE MESSAGE         @G24LB26*/ 01103000
         L     @15,@CV01912                                        0437 01104000
         BALR  @14,@15                                             0437 01105000
*         RESPECIFY                                                0438 01106000
*           REG1 UNRSTD;            /*                       @G24LB26*/ 01107000
*         RPLVRETC=RCFOUR;          /*                       @G24LB26*/ 01108000
         MVC   RPLVRETC(2,RPLVPTR),@CB02113                        0439 01109000
*         RPLRCODE=NOGRPFND;        /* SET REASON CODE TO    @G24LB26   01110000
*                                      HEX 231               @G24LB26*/ 01111000
         MVC   RPLRCODE(2,RPLVPTR),@CB02089                        0440 01112000
*         EXITSW=ON;                /* INDICATE NO MORE      @G24LB26   01113000
*                                      PROCESSING TO BE DONE @G24LB26*/ 01114000
         OI    EXITSW,B'00010000'                                  0441 01115000
*       END;                        /*                       @G24LB26*/ 01116000
*                                                                  0442 01117000
*     /***************************************************************/ 01118000
*     /*                                                             */ 01119000
*     /* IF NO PROBLEM READING EXTENSION RECORD, CONTINUE    @G24LB26*/ 01120000
*     /*                                                             */ 01121000
*     /***************************************************************/ 01122000
*                                                                  0443 01123000
*     ELSE                          /*                       @G24LB26*/ 01124000
*                                                                  0443 01125000
*       /*************************************************************/ 01126000
*       /*                                                           */ 01127000
*       /* LOOP THRU SLOTS IN EXTENSION RECORD               @G24LB26*/ 01128000
*       /*                                                           */ 01129000
*       /*************************************************************/ 01130000
*                                                                  0443 01131000
*       DO INDXEXTS=ONE TO GVSESIND-ONE;/*                   @G24LB26*/ 01132000
*                                                                  0443 01133000
         B     @RC00428                                            0443 01134000
@RF00428 LA    INDXEXTS,1                                          0443 01135000
         B     @DE00443                                            0443 01136000
@DL00443 DS    0H                                                  0444 01137000
*         /***********************************************************/ 01138000
*         /*                                                         */ 01139000
*         /* CALL ROUTINE TO DETERMINE IF VOLUME IS          @G24LB26*/ 01140000
*         /* ELIGIBLE FOR SELECTION FOR THIS REQUEST         @G24LB26*/ 01141000
*         /*                                                         */ 01142000
*         /***********************************************************/ 01143000
*                                                                  0444 01144000
*         CALL ELGIBLCK;            /*                       @G24LB26*/ 01145000
*                                                                  0444 01146000
         BAL   @14,ELGIBLCK                                        0444 01147000
*         /***********************************************************/ 01148000
*         /*                                                         */ 01149000
*         /* IF VOLUME IS ELIGIBLE, MAKE REMAINING CHECKS,   @G24LB26*/ 01150000
*         /* IF VOLUME WAS NOT ELIGIBLE, GET NEXT VOLUME     @G24LB26*/ 01151000
*         /* IN EXTENSION IF ANY, OR FALL THRU TO END        @G24LB26*/ 01152000
*         /* OF INSIDE LOOP AND GET NEXT VOLUME IN NEW       @G24LB26*/ 01153000
*         /* EXTENSION RECORD UNLESS CURRENT EXTENSION       @G24LB26*/ 01154000
*         /* WAS THE LAST EXTENSION RECORD                   @G24LB26*/ 01155000
*         /*                                                         */ 01156000
*         /***********************************************************/ 01157000
*                                                                  0445 01158000
*         IF INTERCC=RCZERO THEN    /*                       @G24LB26*/ 01159000
         CLC   INTERCC(2),@CB02111                                 0445 01160000
         BNE   @RF00445                                            0445 01161000
*           DO;                     /*                       @G24LB26*/ 01162000
*                                                                  0446 01163000
*             /*******************************************************/ 01164000
*             /*                                                     */ 01165000
*             /* CHECK MOUNT FLAGS SET BY ELGIBLCK AND       @G24LB26*/ 01166000
*             /* IF VOLUME IS MOUNTED TO ANOTHER HOST        @G24LB26*/ 01167000
*             /* AND THE DEVICE TYPE IS OTHER THAN 3330V,    @G24LB26*/ 01168000
*             /* THE VOLUME IS A HIGH RISK VOLUME.           @G24LB26*/ 01169000
*             /*                                                     */ 01170000
*             /*******************************************************/ 01171000
*                                                                  0447 01172000
*             IF BFMTDOHF(INDXBFTB)=ON&/*                    @G24LB26*/ 01173000
*                 SELDEVTP^=DEV3330V THEN/*                  @G24LB26*/ 01174000
         L     @04,BFTBLPTR                                        0447 01175000
         LR    @15,INDXBFTB                                        0447 01176000
         MH    @15,@CH02240                                        0447 01177000
         ST    @15,@TF00001                                        0447 01178000
         ALR   @15,@04                                             0447 01179000
         TM    BFMTDOHF-18(@15),B'00100000'                        0447 01180000
         BNO   @RF00447                                            0447 01181000
         CLC   SELDEVTP(4,SELTMPTR),DEV3330V                       0447 01182000
         BE    @RF00447                                            0447 01183000
*               BFHRSKFL(INDXBFTB)=ON;/*                     @G24LB26*/ 01184000
*                                                                  0448 01185000
         AL    @04,@TF00001                                        0448 01186000
         OI    BFHRSKFL-18(@04),B'10000000'                        0448 01187000
*             /*******************************************************/ 01188000
*             /*                                                     */ 01189000
*             /* CALL ROUTINE TO DETERMINE IF VOLUME         @G24LB26*/ 01190000
*             /* WOULD CAUSE THE STEP TO WAIT IF IT WERE     @G24LB26*/ 01191000
*             /* SELECTED FOR THE REQUEST ONLY IF IT IS      @G24LB26*/ 01192000
*             /* CURRENTLY MOUNTED TO THIS HOST.             @G24LB26*/ 01193000
*             /* CALL ROUTINE TO GET THE NUMBER OF           @G24LB26*/ 01194000
*             /* CONCURRENT USERS THIS VOLUME HAS            @G24LB26*/ 01195000
*             /* AT PRESENT TIME ONLY IF VOLUME IS           @G24LB26*/ 01196000
*             /* MOUNTED TO THIS HOST                        @G24LB26*/ 01197000
*             /*                                                     */ 01198000
*             /*******************************************************/ 01199000
*                                                                  0449 01200000
*             IF BFNOTMTD(INDXBFTB)=OFF&/*                   @G24LB26*/ 01201000
*                 BFMTDOHF(INDXBFTB)=OFF THEN/*              @G24LB26*/ 01202000
@RF00447 L     @04,BFTBLPTR                                        0449 01203000
         LR    @15,INDXBFTB                                        0449 01204000
         MH    @15,@CH02240                                        0449 01205000
         ST    @15,@TF00001                                        0449 01206000
         ALR   @15,@04                                             0449 01207000
         TM    BFNOTMTD-18(@15),B'10000000'                        0449 01208000
         BNZ   @RF00449                                            0449 01209000
         AL    @04,@TF00001                                        0449 01210000
         TM    BFMTDOHF-18(@04),B'00100000'                        0449 01211000
         BNZ   @RF00449                                            0449 01212000
*               DO;                 /*                       @G24LB26*/ 01213000
*                 CALL WAITCK;      /*                       @G24LB26*/ 01214000
         BAL   @14,WAITCK                                          0451 01215000
*                 CALL CONUSER;     /*                       @G24LB26*/ 01216000
         BAL   @14,CONUSER                                         0452 01217000
*               END;                /*                       @G24LB26*/ 01218000
*                                                                  0453 01219000
*             /*******************************************************/ 01220000
*             /*                                                     */ 01221000
*             /* SET BEST FIT TABLE POINTER TO NEXT SLOT     @G24LB26*/ 01222000
*             /* SINCE AN ENTRY WAS MADE IN BEST FIT TABLE.  @G24LB26*/ 01223000
*             /*                                                     */ 01224000
*             /*******************************************************/ 01225000
*                                                                  0454 01226000
*             INDXBFTB=INDXBFTB+ONE;/*                       @G24LB26*/ 01227000
@RF00449 LA    INDXBFTB,1(,INDXBFTB)                               0454 01228000
*           END;                    /*                       @G24LB26*/ 01229000
*       END;                        /* END OF SLOT LOOP      @G24LB26*/ 01230000
*                                                                  0456 01231000
@RF00445 LA    INDXEXTS,1(,INDXEXTS)                               0456 01232000
@DE00443 L     @04,GVSNEPTR                                        0456 01233000
         LH    @04,GVSESIND(,@04)                                  0456 01234000
         BCTR  @04,0                                               0456 01235000
         CR    INDXEXTS,@04                                        0456 01236000
         BNH   @DL00443                                            0456 01237000
*     /***************************************************************/ 01238000
*     /*                                                             */ 01239000
*     /* DETERMINE IF ANOTHER EXTENSION RECORD IS TO BE      @G24LB26*/ 01240000
*     /* READ IF AN ERROR HAS NOT ALREADY OCCURRED.          @G24LB26*/ 01241000
*     /*                                                             */ 01242000
*     /***************************************************************/ 01243000
*                                                                  0457 01244000
*     IF EXITSW=OFF&GVSEX=OFF THEN  /*                       @G24LB26*/ 01245000
@RC00428 TM    EXITSW,B'00010000'                                  0457 01246000
         BNZ   @RF00457                                            0457 01247000
         L     @08,GVSNEPTR                                        0457 01248000
         TM    GVSEX(@08),B'10000000'                              0457 01249000
         BNZ   @RF00457                                            0457 01250000
*       EXITSW=ON;                  /*                       @G24LB26*/ 01251000
*                                                                  0458 01252000
         OI    EXITSW,B'00010000'                                  0458 01253000
*     /***************************************************************/ 01254000
*     /*                                                             */ 01255000
*     /* WRITE THE EXTENSION RECORD IF IT HAD ITS            @ZA28479*/ 01256000
*     /* SPACE FIELDS UPDATED                                @ZA28479*/ 01257000
*     /*                                                             */ 01258000
*     /***************************************************************/ 01259000
*                                                                  0459 01260000
*     IF UPDTGVSN=ON THEN           /*                       @ZA28479*/ 01261000
@RF00457 TM    UPDTGVSN,B'10000000'                                0459 01262000
         BNO   @RF00459                                            0459 01263000
*       DO;                         /*                       @ZA28479*/ 01264000
*         RPLVTYP=RPLVPUT;          /* WRITE EXT RECORD      @ZA28479*/ 01265000
         MVI   RPLVTYP(RPLVPTR),X'01'                              0461 01266000
*         RESPECIFY                                                0462 01267000
*           REG1 RSTD;              /*                       @ZA28479*/ 01268000
*         REG1=RPLVPTR;             /* ADDR OF RPLV          @ZA28479*/ 01269000
         LR    REG1,RPLVPTR                                        0463 01270000
*         CALL ICBVIO00;            /* WRITE EXT RECORD      @ZA28479*/ 01271000
         L     @15,@CV01910                                        0464 01272000
         BALR  @14,@15                                             0464 01273000
*         RESPECIFY                                                0465 01274000
*           REG1 UNRSTD;            /*                       @ZA28479*/ 01275000
*         RPLVRETC=RCZERO;          /* CLEAR SO PROCESS CONT @ZA28479*/ 01276000
         MVC   RPLVRETC(2,RPLVPTR),@CB02111                        0466 01277000
*         RPLRCODE=RCZERO;          /* CLEAR                 @ZA28479*/ 01278000
*                                                                  0467 01279000
         MVC   RPLRCODE(2,RPLVPTR),@CB02111                        0467 01280000
*         /***********************************************************/ 01281000
*         /*                                                         */ 01282000
*         /* SET FLAG INDICATING THAT EXTENSION RECORD       @ZA28479*/ 01283000
*         /* WAS WRITTEN TO THE INVENTORY DATA SET           @ZA28479*/ 01284000
*         /*                                                         */ 01285000
*         /***********************************************************/ 01286000
*                                                                  0468 01287000
*         UPDTGVSN=OFF;             /*                       @ZA28479*/ 01288000
*                                                                  0468 01289000
         NI    UPDTGVSN,B'01111111'                                0468 01290000
*         /***********************************************************/ 01291000
*         /*                                                         */ 01292000
*         /* RESET VSAM SECTION OF RPLV SO THAT THE          @ZA28479*/ 01293000
*         /* READ LOOP WILL CONTINUE TO FUNCTION             @ZA28479*/ 01294000
*         /*                                                         */ 01295000
*         /***********************************************************/ 01296000
*                                                                  0469 01297000
*         RPLVTYP=RPLVREAD;         /*                       @ZA28479*/ 01298000
         MVI   RPLVTYP(RPLVPTR),X'00'                              0469 01299000
*       END;                        /*                       @ZA28479*/ 01300000
*   END;                            /* END OUTSIDE LOOP      @G24LB26*/ 01301000
*                                                                  0471 01302000
@RF00459 DS    0H                                                  0471 01303000
@DE00421 TM    EXITSW,B'00010000'                                  0471 01304000
         BZ    @DL00421                                            0471 01305000
*   /*****************************************************************/ 01306000
*   /*                                                               */ 01307000
*   /* DETERMINE IF REQUEST FAILED YET                       @G24LB26*/ 01308000
*   /*                                                               */ 01309000
*   /*****************************************************************/ 01310000
*                                                                  0472 01311000
*   IF RPLVRETC=RCZERO THEN         /*                       @G24LB26*/ 01312000
         CLC   RPLVRETC(2,RPLVPTR),@CB02111                        0472 01313000
         BNE   @RF00472                                            0472 01314000
*     DO;                           /*                       @G24LB26*/ 01315000
*                                                                  0473 01316000
*       /*************************************************************/ 01317000
*       /*                                                           */ 01318000
*       /* SET INDEX COUNTER IN BEST FIT TABLE TO NUMBER     @G24LB26*/ 01319000
*       /* OF ELEMENTS IN BEST FIT TABLE.                    @G24LB26*/ 01320000
*       /*                                                           */ 01321000
*       /*************************************************************/ 01322000
*                                                                  0474 01323000
*       IF INDXBFTB>ONE THEN        /*                       @G24LB26*/ 01324000
         C     INDXBFTB,@CF00043                                   0474 01325000
         BNH   @RF00474                                            0474 01326000
*         BFTOTIDX=INDXBFTB-ONE;    /*                       @G24LB26*/ 01327000
         LR    @08,INDXBFTB                                        0475 01328000
         BCTR  @08,0                                               0475 01329000
         L     @04,BFTBLPTR                                        0475 01330000
         STH   @08,BFTOTIDX(,@04)                                  0475 01331000
*       ELSE                        /*                       @G24LB26*/ 01332000
*         BFTOTIDX=ZERO;            /*                       @G24LB26*/ 01333000
*                                                                  0476 01334000
         B     @RC00474                                            0476 01335000
@RF00474 L     @08,BFTBLPTR                                        0476 01336000
         SLR   @06,@06                                             0476 01337000
         STH   @06,BFTOTIDX(,@08)                                  0476 01338000
*       /*************************************************************/ 01339000
*       /*                                                           */ 01340000
*       /* DETERMINE IF THERE IS ENOUGH USABLE SPACE FOR     @ZA28479*/ 01341000
*       /* THIS REQUEST TO MEET THE THRESHOLD PERCENTAGE     @ZA28479*/ 01342000
*       /* IF THERE IS NOT, ISSUE MESSAGE ICB441I            @ZA28479*/ 01343000
*       /*                                                           */ 01344000
*       /*************************************************************/ 01345000
*                                                                  0477 01346000
*       IF GROPCENT^=ZERO&SLGRPSPA<GROSTRSH THEN/*           @ZA28479*/ 01347000
@RC00474 L     @08,GROUPPTR                                        0477 01348000
         CLI   GROPCENT(@08),0                                     0477 01349000
         BE    @RF00477                                            0477 01350000
         L     @06,SLGRPSPA                                        0477 01351000
         C     @06,GROSTRSH(,@08)                                  0477 01352000
         BNL   @RF00477                                            0477 01353000
*         DO;                       /*                       @ZA28479*/ 01354000
*           IF GROERRDT^=CVTDATE&GROMSG1=OFF THEN/*          @ZA28479*/ 01355000
         L     @06,CVTPTR                                          0479 01356000
         CLC   GROERRDT(4,@08),CVTDATE(@06)                        0479 01357000
         BE    @RF00479                                            0479 01358000
         TM    GROMSG1(@08),B'00000010'                            0479 01359000
         BNZ   @RF00479                                            0479 01360000
*             DO;                   /*                       @ZA28479*/ 01361000
*               GROMSG1=ON;         /* INDICATE MESSAGE SENT @ZA28479*/ 01362000
         OI    GROMSG1(@08),B'00000010'                            0481 01363000
*               GROERRDT=CVTDATE;   /* ENTER TODAYS DATA     @ZA28479*/ 01364000
         MVC   GROERRDT(4,@08),CVTDATE(@06)                        0482 01365000
*               MSGRQ=MSGRQ&&MSGRQ; /* CLEAR MSG REQ PARMS   @ZA28479*/ 01366000
         XC    MSGRQ(32),MSGRQ                                     0483 01367000
*               MSGRPLV=RPLVPTR;    /* ADDR OF REQUEST PARM  @ZA28479*/ 01368000
         ST    RPLVPTR,MSGRPLV                                     0484 01369000
*               MSGID=MSG441;       /* MESSAGE NUMBER        @ZA28479*/ 01370000
         MVC   MSGID(4),@CF02067                                   0485 01371000
*               MSGLEN1=EIGHT;      /* LENGTH INSERT         @ZA28479*/ 01372000
         MVI   MSGLEN1,X'08'                                       0486 01373000
*               MSGTEXT1=ADDR(GROVVGRP);/* ADDR GRP NAME     @ZA28479*/ 01374000
         LA    @08,GROVVGRP(,@08)                                  0487 01375000
         STCM  @08,7,MSGTEXT1                                      0487 01376000
*               RESPECIFY                                          0488 01377000
*                 REG1 RSTD;        /*                       @ZA28479*/ 01378000
*               REG1=ADDR(MSGRQ);   /* ADDR MESSAGE PARM     @ZA28479*/ 01379000
         LA    REG1,MSGRQ                                          0489 01380000
*               CALL ICBVOP00;      /* CALL MESSAGE MODULE   @ZA28479*/ 01381000
*                                                                  0490 01382000
         L     @15,@CV01912                                        0490 01383000
         BALR  @14,@15                                             0490 01384000
*               /*****************************************************/ 01385000
*               /*                                                   */ 01386000
*               /* READ GROUP RECORD FOR UPDATE TO PRIME     @ZA28479*/ 01387000
*               /* THE VSAM INTERNAL FIELDS IN PREPARATION   @ZA28479*/ 01388000
*               /* FOR A WRITE.                              @ZA28479*/ 01389000
*               /*                                                   */ 01390000
*               /*****************************************************/ 01391000
*                                                                  0491 01392000
*               GKEY=GRONAME;       /* ENSURE KEY SET OK     @ZA28479*/ 01393000
         L     @08,GROUPPTR                                        0491 01394000
         MVC   GKEY(13),GRONAME(@08)                               0491 01395000
*               RPLVKEY=ADDR(GKEY); /* ADDR OF KEY           @ZA28479*/ 01396000
         LA    @08,GKEY                                            0492 01397000
         ST    @08,RPLVKEY(,RPLVPTR)                               0492 01398000
*               RPLVBUF=ADDR(DUMMYBUF);/* ADDR DUMMY BUF     @ZA28479*/ 01399000
         LA    @08,DUMMYBUF                                        0493 01400000
         ST    @08,RPLVBUF(,RPLVPTR)                               0493 01401000
*               RPLVBLN=LENGTH(STORGRP);/* LEN GROUP REC     @ZA28479*/ 01402000
         MVC   RPLVBLN(4,RPLVPTR),@CF02237                         0494 01403000
*               RPLVDIR=ON;         /* READ DIRECT           @ZA28479*/ 01404000
         OI    RPLVDIR(RPLVPTR),B'01000000'                        0495 01405000
*               RPLVTYP=RPLVREAD;   /* READ RECORD           @ZA28479*/ 01406000
         MVI   RPLVTYP(RPLVPTR),X'00'                              0496 01407000
*               RPLVUPD=ON;         /* READ FOR UPDATE       @ZA28479*/ 01408000
         OI    RPLVUPD(RPLVPTR),B'00000010'                        0497 01409000
*               REG1=RPLVPTR;       /* ADDR RPLV IN REG1     @ZA28479*/ 01410000
         LR    REG1,RPLVPTR                                        0498 01411000
*               CALL ICBVIO00;      /* READ GROUP RECORD     @ZA28479*/ 01412000
*                                                                  0499 01413000
         L     @15,@CV01910                                        0499 01414000
         BALR  @14,@15                                             0499 01415000
*               /*****************************************************/ 01416000
*               /*                                                   */ 01417000
*               /* WRITE OUT GROUP RECORD NOW IN GROUP       @ZA28479*/ 01418000
*               /* RECORD BUFFER                             @ZA28479*/ 01419000
*               /*                                                   */ 01420000
*               /*****************************************************/ 01421000
*                                                                  0500 01422000
*               RPLVBUF=ADDR(STORGRP);/* ADDR UPDTD GRP REC  @ZA28479*/ 01423000
         LA    @08,STORGRP                                         0500 01424000
         ST    @08,RPLVBUF(,RPLVPTR)                               0500 01425000
*               RPLVTYP=RPLVPUT;    /* PUT RECORD            @ZA28479*/ 01426000
         MVI   RPLVTYP(RPLVPTR),X'01'                              0501 01427000
*               REG1=RPLVPTR;       /* ADDR RPLV             @ZA28479*/ 01428000
         LR    REG1,RPLVPTR                                        0502 01429000
*               CALL ICBVIO00;      /* WRITE UPDTED GRP REC  @ZA28479*/ 01430000
         L     @15,@CV01910                                        0503 01431000
         BALR  @14,@15                                             0503 01432000
*               RESPECIFY                                          0504 01433000
*                 REG1 UNRSTD;      /*                       @ZA28479*/ 01434000
*                                                                  0504 01435000
*               /*****************************************************/ 01436000
*               /*                                                   */ 01437000
*               /* SINCE NO LOGICAL ACTION WILL BE TAKEN     @ZA28479*/ 01438000
*               /* IF A BAD REASON CODE RESULTS, CLEAR       @ZA28479*/ 01439000
*               /* REASON AND RETURN CODES IN RPLV           @ZA28479*/ 01440000
*               /*                                                   */ 01441000
*               /*****************************************************/ 01442000
*                                                                  0505 01443000
*               RPLVRETC=RCZERO;    /*                       @ZA28479*/ 01444000
         MVC   RPLVRETC(2,RPLVPTR),@CB02111                        0505 01445000
*               RPLRCODE=RCZERO;    /*                       @ZA28479*/ 01446000
         MVC   RPLRCODE(2,RPLVPTR),@CB02111                        0506 01447000
*             END;                  /*                       @ZA28479*/ 01448000
*         END;                      /*                       @ZA28479*/ 01449000
*                                                                  0508 01450000
@RF00479 DS    0H                                                  0509 01451000
*       /*************************************************************/ 01452000
*       /*                                                           */ 01453000
*       /* DETERMINE IF THERE ARE ENOUGH VOLUMES IN THE BEST @G24LB26*/ 01454000
*       /* FIT TABLE TO POSSIBLY SATISFY THIS REQUEST. IF    @G24LB26*/ 01455000
*       /* NOT, ISSUE MESSAGE AND FAIL THE REQUEST NOW.      @G24LB26*/ 01456000
*       /*                                                           */ 01457000
*       /*************************************************************/ 01458000
*                                                                  0509 01459000
*       IF NUMBVOL>BFTOTIDX THEN    /*                       @G24LB26*/ 01460000
@RF00477 SLR   @08,@08                                             0509 01461000
         IC    @08,NUMBVOL                                         0509 01462000
         L     @06,BFTBLPTR                                        0509 01463000
         CH    @08,BFTOTIDX(,@06)                                  0509 01464000
         BNH   @RF00509                                            0509 01465000
*         DO;                       /*                       @G24LB26*/ 01466000
*                                                                  0510 01467000
*           /*********************************************************/ 01468000
*           /*                                                       */ 01469000
*           /* ISSUE MESSAGE ICB407I AND FAIL REQUEST WITH   @G24LB26*/ 01470000
*           /* HEX 232 REASON CODE.                          @G24LB26*/ 01471000
*           /*                                                       */ 01472000
*           /*********************************************************/ 01473000
*                                                                  0511 01474000
*           MSGRQ=MSGRQ&&MSGRQ;     /* ZERO MSG REQUEST BLK  @G24LB26*/ 01475000
         XC    MSGRQ(32),MSGRQ                                     0511 01476000
*           MSGRPLV=RPLVPTR;        /* RPLV ADDR             @G24LB26*/ 01477000
         ST    RPLVPTR,MSGRPLV                                     0512 01478000
*           MSGID=MSG407;           /* MESSAGE ID FOR ICB407I      0513 01479000
*                                                            @G24LB26*/ 01480000
         MVC   MSGID(4),@CF02061                                   0513 01481000
*           MSGLEN1=EIGHT;          /* LENGTH OF INSERT      @G24LB26*/ 01482000
         MVI   MSGLEN1,X'08'                                       0514 01483000
*           MSGTEXT1=ADDR(GROVVGRP);/* GROUP NAME            @G24LB26*/ 01484000
         L     @08,GROUPPTR                                        0515 01485000
         LA    @08,GROVVGRP(,@08)                                  0515 01486000
         STCM  @08,7,MSGTEXT1                                      0515 01487000
*           RESPECIFY                                              0516 01488000
*             REG1 RSTD;            /*                       @G24LB26*/ 01489000
*           REG1=ADDR(MSGRQ);       /* ADDR PRINT PARM       @G24LB26*/ 01490000
         LA    REG1,MSGRQ                                          0517 01491000
*           CALL ICBVOP00;          /* ISSUE MESSAGE         @G24LB26*/ 01492000
         L     @15,@CV01912                                        0518 01493000
         BALR  @14,@15                                             0518 01494000
*           RESPECIFY                                              0519 01495000
*             REG1 UNRSTD;          /*                       @G24LB26*/ 01496000
*           RPLRCODE=SELFAIL;       /* REASON CODE HEX 232   @G24LB26*/ 01497000
         MVC   RPLRCODE(2,RPLVPTR),@CB02091                        0520 01498000
*           RPLVRETC=RCFOUR;        /* RETURN CODE           @G24LB26*/ 01499000
         MVC   RPLVRETC(2,RPLVPTR),@CB02113                        0521 01500000
*         END;                      /*                       @G24LB26*/ 01501000
*     END;                          /*                       @G24LB26*/ 01502000
*                                                                  0523 01503000
@RF00509 DS    0H                                                  0524 01504000
*   /*****************************************************************/ 01505000
*   /*                                                               */ 01506000
*   /* IF REQUEST HAS NOT ALREADY FAILED, THEN SET UP        @G24LB26*/ 01507000
*   /* PARAMETER LIST TO CALL TABLE PROCESSOR TO UPDATE      @G24LB26*/ 01508000
*   /* CONCURRENT USERS, WAIT STATUS, SHAREABILITY AND       @G24LB26*/ 01509000
*   /* MOUNT STATUS OF VOLUMES IN BEST FIT TABLE.            @G24LB26*/ 01510000
*   /*                                                               */ 01511000
*   /*****************************************************************/ 01512000
*                                                                  0524 01513000
*   IF RPLVRETC=RCZERO THEN         /*                       @G24LB26*/ 01514000
@RF00472 CLC   RPLVRETC(2,RPLVPTR),@CB02111                        0524 01515000
         BNE   @RF00524                                            0524 01516000
*     DO;                           /*                       @G24LB26*/ 01517000
*       TABP=TABP&&TABP;            /* CLEAR TABLE PROCESSOR @G24LB26   01518000
*                                      PARM                  @G24LB26*/ 01519000
         LA    @08,STRTABP                                         0526 01520000
         XC    TABP(12,@08),TABP(@08)                              0526 01521000
*       TABFBFIT=ON;                /* INDICATE UPDATE       @G24LB26   01522000
*                                      BEST FIT TABLE        @G24LB26*/ 01523000
         OI    TABFBFIT(@08),B'00100000'                           0527 01524000
*       TABSELRB=ADDR(RPLVUTIL);    /* ADDR OF REQUEST BLOCK @G24LB26*/ 01525000
         LA    @06,RPLVUTIL(,RPLVPTR)                              0528 01526000
         ST    @06,TABSELRB(,@08)                                  0528 01527000
*       TABBFTBL=BFTBLPTR;          /* ADDR OF BEST FIT TABLE      0529 01528000
*                                                            @G24LB26*/ 01529000
         L     @06,BFTBLPTR                                        0529 01530000
         ST    @06,TABBFTBL(,@08)                                  0529 01531000
*       CALL ICBVTP00(TABP);        /* CALL TABLE PROCESSOR  @G24LB26*/ 01532000
*                                                                  0530 01533000
         ST    @08,@AL00001                                        0530 01534000
         L     @15,@CV01914                                        0530 01535000
         LA    @01,@AL00001                                        0530 01536000
         BALR  @14,@15                                             0530 01537000
*       /*************************************************************/ 01538000
*       /*                                                           */ 01539000
*       /* LOOP THRU BEST FIT TABLE AND UPDATE THE           @G24LB26*/ 01540000
*       /* CONCURRENT USER FIELD FOR VOLUMES THAT ARE OVER   @G24LB26*/ 01541000
*       /* THE MAXIMUM CONCURRENT USERS.                     @G24LB26*/ 01542000
*       /*                                                           */ 01543000
*       /*************************************************************/ 01544000
*                                                                  0531 01545000
*       DO INDXBFTB=ONE TO BFTOTIDX;/* LOOP THRU TABLE       @G24LB26*/ 01546000
*                                                                  0531 01547000
         LA    INDXBFTB,1                                          0531 01548000
         B     @DE00531                                            0531 01549000
@DL00531 DS    0H                                                  0532 01550000
*         /***********************************************************/ 01551000
*         /*                                                         */ 01552000
*         /* DETERMINE IF CONCURRENT USERS IS OVER MAXIMUM   @G24LB26*/ 01553000
*         /*                                                         */ 01554000
*         /***********************************************************/ 01555000
*                                                                  0532 01556000
*         IF BFCONUSE(INDXBFTB)>=GROCONUS THEN/*             @G24LB26*/ 01557000
*                                                                  0532 01558000
         L     @08,BFTBLPTR                                        0532 01559000
         LR    @04,INDXBFTB                                        0532 01560000
         MH    @04,@CH02240                                        0532 01561000
         SLR   @15,@15                                             0532 01562000
         IC    @15,BFCONUSE-18(@04,@08)                            0532 01563000
         L     @14,GROUPPTR                                        0532 01564000
         SLR   @03,@03                                             0532 01565000
         IC    @03,GROCONUS(,@14)                                  0532 01566000
         CR    @15,@03                                             0532 01567000
         BL    @RF00532                                            0532 01568000
*           /*********************************************************/ 01569000
*           /*                                                       */ 01570000
*           /* SET OVER MAXIMUM FIELD TO NUMBER OF           @G24LB26*/ 01571000
*           /* CONCURRENT USERS                              @G24LB26*/ 01572000
*           /*                                                       */ 01573000
*           /*********************************************************/ 01574000
*                                                                  0533 01575000
*           BFOVERUS(INDXBFTB)=BFCONUSE(INDXBFTB);/*         @G24LB26*/ 01576000
         STC   @15,BFOVERUS-18(@04,@08)                            0533 01577000
*       END;                        /*                       @G24LB26*/ 01578000
*                                                                  0534 01579000
@RF00532 AL    INDXBFTB,@CF00043                                   0534 01580000
@DE00531 L     @08,BFTBLPTR                                        0534 01581000
         CH    INDXBFTB,BFTOTIDX(,@08)                             0534 01582000
         BNH   @DL00531                                            0534 01583000
*       /*************************************************************/ 01584000
*       /*                                                           */ 01585000
*       /* CALL ROUTINE TO USE BEST FIT TABLE TO MAKE        @G24LB26*/ 01586000
*       /* FINAL VOLUME SELECTIONS FOR THIS REQUEST.         @G24LB26*/ 01587000
*       /*                                                           */ 01588000
*       /*************************************************************/ 01589000
*                                                                  0535 01590000
*       CALL FINSELCT;              /*                       @G24LB26*/ 01591000
         BAL   @14,FINSELCT                                        0535 01592000
*     END;                          /*                       @G24LB26*/ 01593000
*                                                                  0536 01594000
*   /*****************************************************************/ 01595000
*   /*                                                               */ 01596000
*   /* CHECK TO SEE IF FINSELCT ROUTINE HAD A PROBLEM        @G24LB26*/ 01597000
*   /* OR ANY PREVIOUS PROBLEMS EXIST, AND IF THERE          @G24LB26*/ 01598000
*   /* ARE NOT ANY, CALL ROUTINE TO UPDATE THE MSVI RECORDS. @G24LB26*/ 01599000
*   /*                                                               */ 01600000
*   /*****************************************************************/ 01601000
*                                                                  0537 01602000
*   IF RPLVRETC=RCZERO THEN         /*                       @G24LB26*/ 01603000
@RF00524 CLC   RPLVRETC(2,RPLVPTR),@CB02111                        0537 01604000
         BNE   @RF00537                                            0537 01605000
*     DO;                           /*                       @G24LB26*/ 01606000
*       CALL UPDTMSVI;              /*                       @G24LB26*/ 01607000
*                                                                  0539 01608000
         BAL   @14,UPDTMSVI                                        0539 01609000
*       /*************************************************************/ 01610000
*       /*                                                           */ 01611000
*       /* SET UP PARAMETER LIST TO CALL THE TABLE PROCESSOR @G24LB26*/ 01612000
*       /* TO TABLE THE VOLUME SELECTIONS MADE FOR THIS      @G24LB26*/ 01613000
*       /* REQUEST.                                          @G24LB26*/ 01614000
*       /*                                                           */ 01615000
*       /*************************************************************/ 01616000
*                                                                  0540 01617000
*       GRPNAME=BFGROUP;            /* GROUP SELECTING FROM  @G24LB26*/ 01618000
         L     @08,SELGRPPR(,SELTMPTR)                             0540 01619000
         L     @06,BFTBLPTR                                        0540 01620000
         MVC   GRPNAME(8,@08),BFGROUP(@06)                         0540 01621000
*       GRPEXTIN=BFGRPIDX(PRIBFIDX);/* EXTENSION RECORD      @G24LB26   01622000
*                                      INDEX                 @G24LB26*/ 01623000
         SLR   @04,@04                                             0541 01624000
         IC    @04,PRIBFIDX                                        0541 01625000
         MH    @04,@CH02240                                        0541 01626000
         SLR   @15,@15                                             0541 01627000
         IC    @15,BFGRPIDX-18(@04,@06)                            0541 01628000
         STC   @15,GRPEXTIN(,@08)                                  0541 01629000
*       GRPSLOTN=BFGRPSLT(PRIBFIDX);/* SLOT INDEX            @G24LB26*/ 01630000
         SLR   @15,@15                                             0542 01631000
         IC    @15,BFGRPSLT-18(@04,@06)                            0542 01632000
         STC   @15,GRPSLOTN(,@08)                                  0542 01633000
*       GRPPRMSP=PRICYL;            /* PRIMARY SPACE IN CYL  @G24LB26*/ 01634000
         LH    @06,PRICYL                                          0543 01635000
         STH   @06,GRPPRMSP(,@08)                                  0543 01636000
*       TABP=TABP&&TABP;            /* CLEAR TABLE PARM      @G24LB26*/ 01637000
         LA    @08,STRTABP                                         0544 01638000
         XC    TABP(12,@08),TABP(@08)                              0544 01639000
*       TABFBLDE=ON;                /* INDICATE BUILDING     @G24LB26   01640000
*                                      DD ENTRY              @G24LB26*/ 01641000
         OI    TABFBLDE(@08),B'10000000'                           0545 01642000
*       TABSELRB=ADDR(RPLVUTIL);    /* ADDR SELECT RPL       @G24LB26*/ 01643000
         LA    @04,RPLVUTIL(,RPLVPTR)                              0546 01644000
         ST    @04,TABSELRB(,@08)                                  0546 01645000
*       CALL ICBVTP00(TABP);        /* CALL TABLE PROCESSOR  @G24LB26*/ 01646000
         ST    @08,@AL00001                                        0547 01647000
         L     @15,@CV01914                                        0547 01648000
         LA    @01,@AL00001                                        0547 01649000
         BALR  @14,@15                                             0547 01650000
*     END;                          /*                       @G24LB26*/ 01651000
*   RETURN;                         /*                       @G24LB26*/ 01652000
@EL00003 DS    0H                                                  0549 01653000
@EF00003 DS    0H                                                  0549 01654000
@ER00003 L     @14,@SA00003                                        0549 01655000
         BR    @14                                                 0549 01656000
*   END SELCTVOL;                   /*                       @G24LB26*/ 01657000
         B     @EL00003                                            0550 01658000
*                                                                  0551 01659000
*/*********************************************************  @G24LB26*/ 01660000
*/*                                                          @G24LB26*/ 01661000
*/* PROCEDURE NAME - VOLREF                                  @G24LB26*/ 01662000
*/*                                                          @G24LB26*/ 01663000
*/* FUNCTION - HANDLES VOL=REF REQUESTS BY UPDATING SPACE IN @G24LB26*/ 01664000
*/*            THE EXTENSION RECORD FOR THE PRIMARY VOLUME.  @G24LB26*/ 01665000
*/*            IF THE SPACE WAS SUCCESSFULLY UPDATED IN THE  @G24LB26*/ 01666000
*/*            EXTENSION RECORD, THEN THAT SPACE IS TABLED   @G24LB26*/ 01667000
*/*            BY THE TABLE PROCESSOR, OTHERWISE ZERO        @G24LB26*/ 01668000
*/*            CYLINDERS ARE TABLED ON THE CALL TO THE STEP  @G24LB26*/ 01669000
*/*            TABLE PROCESSOR.                              @G24LB26*/ 01670000
*/*                                                          @G24LB26*/ 01671000
*/* INPUT - ADDRESSABILITY SET UP TO JFCB, BASE              @G24LB26*/ 01672000
*/*         VOLUME RECORD, GROUP EXTENSION RECORD.           @G24LB26*/ 01673000
*/*                                                          @G24LB26*/ 01674000
*/* OUTPUT - UPDATED FREE SPACE FOR VOLUME IN THE GROUP      @G24LB26*/ 01675000
*/*          EXTENSION RECORD, TABLED DD ENTRY IN STEP       @G24LB26*/ 01676000
*/*          TABLE RESULTING FROM CALL TO TABLE PROCESSOR.   @G24LB26*/ 01677000
*/*          ZERO REASON AND RETURN CODES IN THE RPLV.       @G24LB26*/ 01678000
*/*          ISSUES MESSAGES ICB402I AND ICB445I.            @G24LB26*/ 01679000
*/*                                                          @G24LB26*/ 01680000
*/*********************************************************  @G24LB26*/ 01681000
*                                                                  0551 01682000
*VOLREF:                                                           0551 01683000
*   PROC OPTIONS(SAVE(REG14));      /*                       @G24LB26*/ 01684000
*                                                                  0551 01685000
VOLREF   ST    @14,@SA00004                                        0551 01686000
*   /*****************************************************************/ 01687000
*   /*                                                               */ 01688000
*   /* CLEAR GROUP RETURN AREA FOR TABLE PROCESSOR           @G24LB26*/ 01689000
*   /*                                                               */ 01690000
*   /*****************************************************************/ 01691000
*                                                                  0552 01692000
*   GRPPR=GRPPR&&GRPPR;             /*                       @G24LB26*/ 01693000
*                                                                  0552 01694000
         L     @08,SELGRPPR(,SELTMPTR)                             0552 01695000
         XC    GRPPR(12,@08),GRPPR(@08)                            0552 01696000
*   /*****************************************************************/ 01697000
*   /*                                                               */ 01698000
*   /* GET THE VOLID OF THE PRIMARY VOLUME FROM THE JFCB     @G24LB26*/ 01699000
*   /* AND READ THE BASE VOLUME RECORD.                      @G24LB26*/ 01700000
*   /*                                                               */ 01701000
*   /*****************************************************************/ 01702000
*                                                                  0553 01703000
*   VOLKY=JFCAVOLS(ONE);            /* VOLUME SERIAL         @G24LB26*/ 01704000
         L     @08,JFCBPTR(,SELTMPTR)                              0553 01705000
         MVC   VOLKY(6),JFCAVOLS(@08)                              0553 01706000
*   RPLVKEY=ADDR(VKEY);             /* ADDR OF KEY           @G24LB26*/ 01707000
         LA    @08,VKEY                                            0554 01708000
         ST    @08,RPLVKEY(,RPLVPTR)                               0554 01709000
*   RPLVBUF=ADDR(STORBASE);         /* ADDR OF BUFFER        @G24LB26*/ 01710000
         LA    @08,STORBASE                                        0555 01711000
         ST    @08,RPLVBUF(,RPLVPTR)                               0555 01712000
*   RPLVBLN=LENGTH(STORBASE);       /* LENGTH OF BUFFER      @G24LB26*/ 01713000
         MVC   RPLVBLN(4,RPLVPTR),@CF02241                         0556 01714000
*   RPLVDIR=ON;                     /* READ DIRECT           @G24LB26*/ 01715000
         OI    RPLVDIR(RPLVPTR),B'01000000'                        0557 01716000
*   RPLVTYP=RPLVREAD;               /* READ REQUEST          @G24LB26*/ 01717000
         MVI   RPLVTYP(RPLVPTR),X'00'                              0558 01718000
*   RESPECIFY                                                      0559 01719000
*     REG1 RSTD;                    /*                       @G24LB26*/ 01720000
*   REG1=RPLVPTR;                   /* ADDR RPLV             @G24LB26*/ 01721000
         LR    REG1,RPLVPTR                                        0560 01722000
*   CALL ICBVIO00;                  /* READ BASE RECORD      @G24LB26*/ 01723000
         L     @15,@CV01910                                        0561 01724000
         BALR  @14,@15                                             0561 01725000
*   RESPECIFY                                                      0562 01726000
*     REG1 UNRSTD;                  /*                       @G24LB26*/ 01727000
*                                                                  0562 01728000
*   /*****************************************************************/ 01729000
*   /*                                                               */ 01730000
*   /* CHECK RETURN CODE                                     @G24LB26*/ 01731000
*   /*                                                               */ 01732000
*   /*****************************************************************/ 01733000
*                                                                  0563 01734000
*   IF RPLVRETC^=RCZERO THEN        /*                       @G24LB26*/ 01735000
*                                                                  0563 01736000
         CLC   RPLVRETC(2,RPLVPTR),@CB02111                        0563 01737000
         BE    @RF00563                                            0563 01738000
*     /***************************************************************/ 01739000
*     /*                                                             */ 01740000
*     /* ISSUE ERROR MESSAGE AND SET REASON AND RETURN CODE. @G24LB26*/ 01741000
*     /*                                                             */ 01742000
*     /***************************************************************/ 01743000
*                                                                  0564 01744000
*     DO;                           /*                       @G24LB26*/ 01745000
*       MSGRQ=MSGRQ&&MSGRQ;         /* CLEAR MSG PARM LIST   @G24LB26*/ 01746000
         XC    MSGRQ(32),MSGRQ                                     0565 01747000
*       MSGRPLV=RPLVPTR;            /* RPLV ADDR             @G24LB26*/ 01748000
         ST    RPLVPTR,MSGRPLV                                     0566 01749000
*       MSGID=MSG402;               /* MSG ID FOR ICB402I    @G24LB26*/ 01750000
         MVC   MSGID(4),@CF02059                                   0567 01751000
*       MSGLEN1=SIX;                /* LENGTH OF INSERT      @G24LB26*/ 01752000
         MVI   MSGLEN1,X'06'                                       0568 01753000
*       MSGTEXT1=ADDR(VOLKY);       /* VOLUME NAME IN MSG    @G24LB26*/ 01754000
         LA    @08,VOLKY                                           0569 01755000
         STCM  @08,7,MSGTEXT1                                      0569 01756000
*       RESPECIFY                                                  0570 01757000
*         REG1 RSTD;                /*                       @G24LB26*/ 01758000
*       REG1=ADDR(MSGRQ);           /* ADDR OF MSG PARM LIST @G24LB26*/ 01759000
         LA    REG1,MSGRQ                                          0571 01760000
*       CALL ICBVOP00;              /*                       @G24LB26*/ 01761000
         L     @15,@CV01912                                        0572 01762000
         BALR  @14,@15                                             0572 01763000
*       RESPECIFY                                                  0573 01764000
*         REG1 UNRSTD;              /*                       @G24LB26*/ 01765000
*       RPLRCODE=RCZERO;            /* SET ZERO REASON CODE  @G24LB26*/ 01766000
         MVC   RPLRCODE(2,RPLVPTR),@CB02111                        0574 01767000
*       RPLVRETC=RCZERO;            /* SET ZERO RETURN CODE  @G24LB26*/ 01768000
         MVC   RPLVRETC(2,RPLVPTR),@CB02111                        0575 01769000
*     END;                          /*                       @G24LB26*/ 01770000
*                                                                  0576 01771000
*   /*****************************************************************/ 01772000
*   /*                                                               */ 01773000
*   /* IF THE BASE VOLUME RECORD WAS READ, CHECK THAT IT IS  @G24LB26*/ 01774000
*   /* GROUPED OTHER THAN SYSGROUP AND IS GENERAL-USE,       @G24LB26*/ 01775000
*   /* THEN READ FOR CORRECT SLOT IN EXTENSION RECORD.       @G24LB26*/ 01776000
*   /*                                                               */ 01777000
*   /*****************************************************************/ 01778000
*                                                                  0577 01779000
*   ELSE                            /*                       @G24LB26*/ 01780000
*     IF BASGRPV=ON&BASGENUS=ON&BASGROUP^=SYSGROUP THEN/*    @G24LB26*/ 01781000
         B     @RC00563                                            0577 01782000
@RF00563 L     @08,BASEVPTR                                        0577 01783000
         TM    BASGRPV(@08),B'00110000'                            0577 01784000
         BNO   @RF00577                                            0577 01785000
         CLC   BASGROUP(8,@08),SYSGROUP                            0577 01786000
         BE    @RF00577                                            0577 01787000
*       DO;                         /*                       @G24LB26*/ 01788000
*         ERRORSW=OFF;              /*                       @G24LB26*/ 01789000
*         EXITSW=OFF;               /*                       @G24LB26*/ 01790000
         NI    ERRORSW,B'11100111'                                 0580 01791000
*         GBLKKY=BLANK;             /* BLANK OUT FILL        @G24LB26   01792000
*                                      PORTION OF KEY        @G24LB26*/ 01793000
         MVI   GBLKKY,C' '                                         0581 01794000
*         GIDKY=ONE;                /* SET ID TO GET FIRST   @G24LB26   01795000
*                                      EXTENSION             @G24LB26*/ 01796000
         MVI   GIDKY,X'01'                                         0582 01797000
*         GROUPKY=BASGROUP;         /* GRP FROM BASE RECORD  @G24LB26*/ 01798000
         MVC   GROUPKY(8),BASGROUP(@08)                            0583 01799000
*         RPLVKEY=ADDR(GKEY);       /* ADDR OF KEY           @G24LB26*/ 01800000
         LA    @08,GKEY                                            0584 01801000
         ST    @08,RPLVKEY(,RPLVPTR)                               0584 01802000
*         RPLVBUF=ADDR(STORGPEX);   /* ADDR OF BUFFER        @G24LB26*/ 01803000
         LA    @08,STORGPEX                                        0585 01804000
         ST    @08,RPLVBUF(,RPLVPTR)                               0585 01805000
*         RPLVBLN=LENGTH(STORGPEX); /* LENGTH OF BUFFER      @G24LB26*/ 01806000
         MVC   RPLVBLN(4,RPLVPTR),@CF02239                         0586 01807000
*         RPLVDIR=ON;               /* READ DIRECT           @G24LB26*/ 01808000
         OI    RPLVDIR(RPLVPTR),B'01000000'                        0587 01809000
*         RPLVTYP=RPLVREAD;         /* READ RECORD           @G24LB26*/ 01810000
         MVI   RPLVTYP(RPLVPTR),X'00'                              0588 01811000
*         RPLVKGE=ON;               /* READ > OR =           @G24LB26*/ 01812000
         OI    RPLVKGE(RPLVPTR),B'00000100'                        0589 01813000
*         RPLVUPD=ON;               /* READ FOR UPDATE       @G24LB26*/ 01814000
*                                                                  0590 01815000
         OI    RPLVUPD(RPLVPTR),B'00000010'                        0590 01816000
*         /***********************************************************/ 01817000
*         /*                                                         */ 01818000
*         /* LOOP THRU EXTENSION RECORDS UNTIL ONE WITH      @G24LB26*/ 01819000
*         /* REQUIRED SLOT IS FOUND.                         @G24LB26*/ 01820000
*         /*                                                         */ 01821000
*         /***********************************************************/ 01822000
*                                                                  0591 01823000
*         DO WHILE EXITSW=OFF;      /*                       @G24LB26*/ 01824000
*                                                                  0591 01825000
         B     @DE00591                                            0591 01826000
@DL00591 DS    0H                                                  0592 01827000
*           /*********************************************************/ 01828000
*           /*                                                       */ 01829000
*           /* READ GROUP EXTENSION RECORD.                  @G24LB26*/ 01830000
*           /*                                                       */ 01831000
*           /*********************************************************/ 01832000
*                                                                  0592 01833000
*           RESPECIFY                                              0592 01834000
*             REG1 RSTD;            /*                       @G24LB26*/ 01835000
*           REG1=RPLVPTR;           /* ADDR OF RPLV          @G24LB26*/ 01836000
         LR    REG1,RPLVPTR                                        0593 01837000
*           CALL ICBVIO00;          /* READ                  @G24LB26*/ 01838000
         L     @15,@CV01910                                        0594 01839000
         BALR  @14,@15                                             0594 01840000
*           RESPECIFY                                              0595 01841000
*             REG1 UNRSTD;          /*                       @G24LB26*/ 01842000
*                                                                  0595 01843000
*           /*********************************************************/ 01844000
*           /*                                                       */ 01845000
*           /* CHECK RETURN CODE FROM I/O PROCESSOR AND      @G24LB26*/ 01846000
*           /* ALSO CHECK IF PROPER GROUP.                   @G24LB26*/ 01847000
*           /*                                                       */ 01848000
*           /*********************************************************/ 01849000
*                                                                  0596 01850000
*           IF RPLVRETC^=RCZERO|GVSVVGRP^=GROUPKY THEN/*     @G24LB26*/ 01851000
         CLC   RPLVRETC(2,RPLVPTR),@CB02111                        0596 01852000
         BNE   @RT00596                                            0596 01853000
         L     @08,GVSNEPTR                                        0596 01854000
         CLC   GVSVVGRP(8,@08),GROUPKY                             0596 01855000
         BE    @RF00596                                            0596 01856000
@RT00596 DS    0H                                                  0597 01857000
*             DO;                   /*                       @G24LB26*/ 01858000
*               ERRORSW=ON;         /* INDICATE ERROR        @G24LB26*/ 01859000
*               EXITSW=ON;          /* EXIT LOOP             @G24LB26*/ 01860000
         OI    ERRORSW,B'00011000'                                 0599 01861000
*               RPLVRETC=RCZERO;    /* CLEAR RETURN AND      @G24LB26*/ 01862000
         MVC   RPLVRETC(2,RPLVPTR),@CB02111                        0600 01863000
*               RPLRCODE=RCZERO;    /* REASON CODES          @G24LB26*/ 01864000
         MVC   RPLRCODE(2,RPLVPTR),@CB02111                        0601 01865000
*             END;                  /*                       @G24LB26*/ 01866000
*                                                                  0602 01867000
*           /*********************************************************/ 01868000
*           /*                                                       */ 01869000
*           /* IF NO ERROR READING RECORDS, LOOP THRU        @G24LB26*/ 01870000
*           /* LOOKING FOR DESIRED SLOT.                     @G24LB26*/ 01871000
*           /*                                                       */ 01872000
*           /*********************************************************/ 01873000
*                                                                  0603 01874000
*           ELSE                    /*                       @G24LB26*/ 01875000
*             DO INDXEXTS=ONE TO GVSESIND-ONE/*              @G24LB26*/ 01876000
*                   WHILE EXITSW=OFF;/*                      @G24LB26*/ 01877000
*                                                                  0603 01878000
         B     @RC00596                                            0603 01879000
@RF00596 LA    INDXEXTS,1                                          0603 01880000
         B     @DE00603                                            0603 01881000
@DL00603 TM    EXITSW,B'00010000'                                  0603 01882000
         BNZ   @DC00603                                            0603 01883000
*               /*****************************************************/ 01884000
*               /*                                                   */ 01885000
*               /* LOOK FOR SLOT WITH VOLID CURRENTLY        @G24LB26*/ 01886000
*               /* BEING PROCESSED.                          @G24LB26*/ 01887000
*               /*                                                   */ 01888000
*               /*****************************************************/ 01889000
*                                                                  0604 01890000
*               IF GVSVOLID(INDXEXTS)=BASSERNO THEN/*        @G24LB26*/ 01891000
         L     @06,GVSNEPTR                                        0604 01892000
         LR    @04,INDXEXTS                                        0604 01893000
         MH    @04,@CH01851                                        0604 01894000
         ST    @04,@TF00001                                        0604 01895000
         ALR   @04,@06                                             0604 01896000
         L     @01,BASEVPTR                                        0604 01897000
         CLC   GVSVOLID-20(6,@04),BASSERNO(@01)                    0604 01898000
         BNE   @RF00604                                            0604 01899000
*                 DO;               /*                       @G24LB26*/ 01900000
*                                                                  0605 01901000
*                   /*************************************************/ 01902000
*                   /*                                               */ 01903000
*                   /* UPDATE FIELDS FOR TABLE PROCESSOR     @G24LB26*/ 01904000
*                   /* AND CALL ROUTINE TO CONVERT SPACE TO  @G24LB26*/ 01905000
*                   /* CYLINDERS TO UPDATE MSVI RECORDS      @G24LB26*/ 01906000
*                   /* IF SPACE IS NOT ALREADY DOWN LEVEL.   @G24LB26*/ 01907000
*                   /*                                               */ 01908000
*                   /*************************************************/ 01909000
*                                                                  0606 01910000
*                   GRPNAME=GVSVVGRP;/* GROUP NAME           @G24LB26*/ 01911000
         L     @04,SELGRPPR(,SELTMPTR)                             0606 01912000
         MVC   GRPNAME(8,@04),GVSVVGRP(@06)                        0606 01913000
*                   GRPEXTIN=GVSNO; /* EXTENSION ID          @G24LB26*/ 01914000
         IC    @15,GVSNO(,@06)                                     0607 01915000
         STC   @15,GRPEXTIN(,@04)                                  0607 01916000
*                   GRPSLOTN=INDXEXTS;/* SLOT INDEX NO.      @G24LB26*/ 01917000
*                                                                  0608 01918000
         STC   INDXEXTS,GRPSLOTN(,@04)                             0608 01919000
*                   /*************************************************/ 01920000
*                   /*                                               */ 01921000
*                   /* CALL SPACE CONVERSION IF SPACE        @G24LB26*/ 01922000
*                   /* IS VALID.                             @G24LB26*/ 01923000
*                   /*                                               */ 01924000
*                   /*************************************************/ 01925000
*                                                                  0609 01926000
*                   IF GVSRCFSI(INDXEXTS)=OFF THEN/*         @G24LB26*/ 01927000
         AL    @06,@TF00001                                        0609 01928000
         TM    GVSRCFSI-20(@06),B'10000000'                        0609 01929000
         BNZ   @RF00609                                            0609 01930000
*                     DO;           /*                       @G24LB26*/ 01931000
*                       NUMBVOL=ONE;/* INDICATE CALCULATE    @G24LB26   01932000
*                                      ONLY PRIMARY          @G24LB26*/ 01933000
*                                                                  0611 01934000
         MVI   NUMBVOL,X'01'                                       0611 01935000
*                       /*********************************************/ 01936000
*                       /*                                           */ 01937000
*                       /* CALL SPACE CONVERSION ROUTINE     @G24LB26*/ 01938000
*                       /* TO GET SPACE IN CYLINDERS.        @G24LB26*/ 01939000
*                       /*                                           */ 01940000
*                       /*********************************************/ 01941000
*                                                                  0612 01942000
*                       CALL SPACONV;/*                      @G24LB26*/ 01943000
*                                                                  0612 01944000
         BAL   @14,SPACONV                                         0612 01945000
*                       /*********************************************/ 01946000
*                       /*                                           */ 01947000
*                       /* UPDATE SPACE IN EXTENSION SLOT    @G24LB26*/ 01948000
*                       /*                                           */ 01949000
*                       /*********************************************/ 01950000
*                                                                  0613 01951000
*                       GVSMTDSP(INDXEXTS)=/*                @G24LB26*/ 01952000
*                           GVSMTDSP(INDXEXTS)-PRICYL;/*     @G24LB26*/ 01953000
*                                                                  0613 01954000
         L     @06,GVSNEPTR                                        0613 01955000
         LR    @04,INDXEXTS                                        0613 01956000
         MH    @04,@CH01851                                        0613 01957000
         LH    @15,GVSMTDSP-20(@04,@06)                            0613 01958000
         SH    @15,PRICYL                                          0613 01959000
         STH   @15,GVSMTDSP-20(@04,@06)                            0613 01960000
*                       /*********************************************/ 01961000
*                       /*                                           */ 01962000
*                       /* CHECK TO SEE IF VALUE WENT        @G24LB26*/ 01963000
*                       /* NEGATIVE. IF LESS THAN ZERO,      @G24LB26*/ 01964000
*                       /* SET TO ZERO.                      @G24LB26*/ 01965000
*                       /*                                           */ 01966000
*                       /*********************************************/ 01967000
*                                                                  0614 01968000
*                       IF GVSMTDSP(INDXEXTS)<ZERO THEN/*    @G24LB26*/ 01969000
         SLR   @14,@14                                             0614 01970000
         CR    @15,@14                                             0614 01971000
         BNL   @RF00614                                            0614 01972000
*                         GVSMTDSP(INDXEXTS)=ZERO;/*         @G24LB26*/ 01973000
*                                                                  0615 01974000
         STH   @14,GVSMTDSP-20(@04,@06)                            0615 01975000
*                       /*********************************************/ 01976000
*                       /*                                           */ 01977000
*                       /* WRITE UPDATED EXTENSION RECORD    @G24LB26*/ 01978000
*                       /*                                           */ 01979000
*                       /*********************************************/ 01980000
*                                                                  0616 01981000
*                       RPLVTYP=RPLVPUT;/* PUT EXT RECORD    @G24LB26*/ 01982000
@RF00614 MVI   RPLVTYP(RPLVPTR),X'01'                              0616 01983000
*                       RESPECIFY                                  0617 01984000
*                         REG1 RSTD;/*                       @G24LB26*/ 01985000
*                       REG1=RPLVPTR;/*                      @G24LB26*/ 01986000
         LR    REG1,RPLVPTR                                        0618 01987000
*                       CALL ICBVIO00;/* WRITE EXTENSION     @G24LB26*/ 01988000
         L     @15,@CV01910                                        0619 01989000
         BALR  @14,@15                                             0619 01990000
*                       RESPECIFY                                  0620 01991000
*                         REG1 UNRSTD;/*                     @G24LB26*/ 01992000
*                                                                  0620 01993000
*                       /*********************************************/ 01994000
*                       /*                                           */ 01995000
*                       /* IF SPACE UPDATE IN EXTENSION      @G24LB26*/ 01996000
*                       /* RECORD WAS SUCCESSFULLY WRITTEN   @G24LB26*/ 01997000
*                       /* TO THE MSVI, THEN INDICATE TO     @G24LB26*/ 01998000
*                       /* TABLE PROCESSOR THE AMOUNT OF     @G24LB26*/ 01999000
*                       /* PRIMARY SPACE.                    @G24LB26*/ 02000000
*                       /*                                           */ 02001000
*                       /*********************************************/ 02002000
*                                                                  0621 02003000
*                       IF RPLVRETC=RCZERO THEN/*            @G24LB26*/ 02004000
         CLC   RPLVRETC(2,RPLVPTR),@CB02111                        0621 02005000
         BNE   @RF00621                                            0621 02006000
*                         GRPPRMSP=PRICYL;/* UPDATE SPACE    @G24LB26   02007000
*                                      FOR TABLE PROC        @G24LB26*/ 02008000
         L     @06,SELGRPPR(,SELTMPTR)                             0622 02009000
         LH    @04,PRICYL                                          0622 02010000
         STH   @04,GRPPRMSP(,@06)                                  0622 02011000
*                       ELSE        /*                       @G24LB26*/ 02012000
*                         DO;       /*                       @G24LB26*/ 02013000
         B     @RC00621                                            0623 02014000
@RF00621 DS    0H                                                  0624 02015000
*                           RPLVRETC=RCZERO;/*               @G24LB26   02016000
*                                      CLEAR RETURN AND      @G24LB26*/ 02017000
         MVC   RPLVRETC(2,RPLVPTR),@CB02111                        0624 02018000
*                           RPLRCODE=RCZERO;/* REASON CODES  @G24LB26*/ 02019000
         MVC   RPLRCODE(2,RPLVPTR),@CB02111                        0625 02020000
*                         END;      /*                       @G24LB26*/ 02021000
*                     END;          /*                       @G24LB26*/ 02022000
*                                                                  0627 02023000
@RC00621 DS    0H                                                  0628 02024000
*                   /*************************************************/ 02025000
*                   /*                                               */ 02026000
*                   /* SET SWITCH UP TO GET OUT OF LOOP AND  @G24LB26*/ 02027000
*                   /* INDICATE THAT MATCH WAS FOUND.        @G24LB26*/ 02028000
*                   /*                                               */ 02029000
*                   /*************************************************/ 02030000
*                                                                  0628 02031000
*                   EXITSW=ON;      /*                       @G24LB26*/ 02032000
@RF00609 OI    EXITSW,B'00010000'                                  0628 02033000
*                 END;              /*                       @G24LB26*/ 02034000
*             END;                  /*                       @G24LB26*/ 02035000
*                                                                  0630 02036000
@RF00604 AL    INDXEXTS,@CF00043                                   0630 02037000
@DE00603 L     @06,GVSNEPTR                                        0630 02038000
         LH    @06,GVSESIND(,@06)                                  0630 02039000
         BCTR  @06,0                                               0630 02040000
         CR    INDXEXTS,@06                                        0630 02041000
         BNH   @DL00603                                            0630 02042000
@DC00603 DS    0H                                                  0631 02043000
*           /*********************************************************/ 02044000
*           /*                                                       */ 02045000
*           /* IF A MATCH DID NOT OCCUR AND NO I/O ERROR     @G24LB26*/ 02046000
*           /* HAS BEEN ENCOUNTERED, SEE IF THERE ARE ANY    @G24LB26*/ 02047000
*           /* MORE EXTENSION RECORDS TO READ.               @G24LB26*/ 02048000
*           /*                                                       */ 02049000
*           /*********************************************************/ 02050000
*                                                                  0631 02051000
*           IF EXITSW=OFF&GVSEX=OFF THEN/*                   @G24LB26*/ 02052000
*                                                                  0631 02053000
@RC00596 TM    EXITSW,B'00010000'                                  0631 02054000
         BNZ   @RF00631                                            0631 02055000
         L     @08,GVSNEPTR                                        0631 02056000
         TM    GVSEX(@08),B'10000000'                              0631 02057000
         BNZ   @RF00631                                            0631 02058000
*             /*******************************************************/ 02059000
*             /*                                                     */ 02060000
*             /* GET OUT OF LOOP AND INDICATE AN ERROR       @G24LB26*/ 02061000
*             /* OCCURRED.                                   @G24LB26*/ 02062000
*             /*                                                     */ 02063000
*             /*******************************************************/ 02064000
*                                                                  0632 02065000
*             DO;                   /*                       @G24LB26*/ 02066000
*               ERRORSW=ON;         /*                       @G24LB26*/ 02067000
*               EXITSW=ON;          /*                       @G24LB26*/ 02068000
         OI    ERRORSW,B'00011000'                                 0634 02069000
*             END;                  /*                       @G24LB26*/ 02070000
*                                                                  0635 02071000
*           /*********************************************************/ 02072000
*           /*                                                       */ 02073000
*           /* IF MORE RECORDS TO READ AND NO MATCH YET      @G24LB26*/ 02074000
*           /* FOUND, SET UP KEY TO READ NEXT EXTENSION      @G24LB26*/ 02075000
*           /* RECORD.                                       @G24LB26*/ 02076000
*           /*                                                       */ 02077000
*           /*********************************************************/ 02078000
*                                                                  0636 02079000
*           ELSE                    /*                       @G24LB26*/ 02080000
*             DO;                   /*                       @G24LB26*/ 02081000
         B     @RC00631                                            0636 02082000
@RF00631 DS    0H                                                  0637 02083000
*               GKEY=GVSNAME;       /* SET KEY TO RECORD     @G24LB26   02084000
*                                      KEY JUST READ         @G24LB26*/ 02085000
         L     @08,GVSNEPTR                                        0637 02086000
         MVC   GKEY(13),GVSNAME(@08)                               0637 02087000
*               GIDKY=GIDKY+ONE;    /* AND SET TO READ NEXT  @G24LB26   02088000
*                                      RECORD                @G24LB26*/ 02089000
         IC    @08,GIDKY                                           0638 02090000
         LA    @08,1(,@08)                                         0638 02091000
         STC   @08,GIDKY                                           0638 02092000
*             END;                  /*                       @G24LB26*/ 02093000
*         END;                      /*                       @G24LB26*/ 02094000
*                                                                  0640 02095000
@RC00631 DS    0H                                                  0640 02096000
@DE00591 TM    EXITSW,B'00010000'                                  0640 02097000
         BZ    @DL00591                                            0640 02098000
*         /***********************************************************/ 02099000
*         /*                                                         */ 02100000
*         /* IF AN I/O ERROR OCCURRED OR THE SLOT FOR THE    @G24LB26*/ 02101000
*         /* VOLUME COULD NOT BE FOUND, ISSUE ERROR MESSAGE  @G24LB26*/ 02102000
*         /* ICB445I WITH ZERO REASON AND RETURN CODES.      @G24LB26*/ 02103000
*         /*                                                         */ 02104000
*         /***********************************************************/ 02105000
*                                                                  0641 02106000
*         IF ERRORSW=ON THEN        /*                       @G24LB26*/ 02107000
         TM    ERRORSW,B'00001000'                                 0641 02108000
         BNO   @RF00641                                            0641 02109000
*           DO;                     /*                       @G24LB26*/ 02110000
*             MSGRQ=MSGRQ&&MSGRQ;   /* CLEAR MSG PARM LIST   @G24LB26*/ 02111000
         XC    MSGRQ(32),MSGRQ                                     0643 02112000
*             MSGRPLV=RPLVPTR;      /* RPLV ADDR             @G24LB26*/ 02113000
         ST    RPLVPTR,MSGRPLV                                     0644 02114000
*             MSGID=MSG445;         /* MSG ID FOR ICB445I    @G24LB26*/ 02115000
         MVC   MSGID(4),@CF02069                                   0645 02116000
*             MSGLEN1=SIX;          /* VOLSER LENGTH         @G24LB26*/ 02117000
         MVI   MSGLEN1,X'06'                                       0646 02118000
*             MSGTEXT1=ADDR(BASSERNO);/* VOLID OF BASE VOL   @G24LB26   02119000
*                                      READ                  @G24LB26*/ 02120000
         L     @08,BASEVPTR                                        0647 02121000
         LA    @06,BASSERNO(,@08)                                  0647 02122000
         STCM  @06,7,MSGTEXT1                                      0647 02123000
*             MSGLEN2=EIGHT;        /* LENGTH GROUP NAME     @G24LB26*/ 02124000
         MVI   MSGLEN2,X'08'                                       0648 02125000
*             MSGTEXT2=ADDR(BASGROUP);/* GRP NAME FROM BASE  @G24LB26   02126000
*                                      RECORD                @G24LB26*/ 02127000
         LA    @08,BASGROUP(,@08)                                  0649 02128000
         STCM  @08,7,MSGTEXT2                                      0649 02129000
*             RESPECIFY                                            0650 02130000
*               REG1 RSTD;          /*                       @G24LB26*/ 02131000
*             REG1=ADDR(MSGRQ);     /* ADDR PARM LIST        @G24LB26*/ 02132000
         LA    REG1,MSGRQ                                          0651 02133000
*             CALL ICBVOP00;        /* ISSUE MESSAGE         @G24LB26*/ 02134000
         L     @15,@CV01912                                        0652 02135000
         BALR  @14,@15                                             0652 02136000
*             RESPECIFY                                            0653 02137000
*               REG1 UNRSTD;        /*                       @G24LB26*/ 02138000
*           END;                    /*                       @G24LB26*/ 02139000
*       END;                        /*                       @G24LB26*/ 02140000
*                                                                  0655 02141000
@RF00641 DS    0H                                                  0656 02142000
*   /*****************************************************************/ 02143000
*   /*                                                               */ 02144000
*   /* REGARDLESS OF WHETHER EXTENSION RECORD WAS UPDATED OR @G24LB26*/ 02145000
*   /* NOT, THE TABLE PROCESSOR WILL BE CALLED TO TABLE THE  @G24LB26*/ 02146000
*   /* VOL=REF REQUEST. IF THE EXTENSION RECORD WAS NOT      @G24LB26*/ 02147000
*   /* UPDATED, THE TABLE PROCESSOR WILL TABLE ZERO          @G24LB26*/ 02148000
*   /* CYLINDERS PRIMARY SPACE. GROUP PARAMETER LIST IS      @G24LB26*/ 02149000
*   /* ALREADY SET UP.                                       @G24LB26*/ 02150000
*   /*                                                               */ 02151000
*   /*****************************************************************/ 02152000
*                                                                  0656 02153000
*   TABP=TABP&&TABP;                /* CLEAR TABLE PROC      @G24LB26   02154000
*                                      PARM FIELDS           @G24LB26*/ 02155000
@RF00577 DS    0H                                                  0656 02156000
@RC00563 LA    @08,STRTABP                                         0656 02157000
         XC    TABP(12,@08),TABP(@08)                              0656 02158000
*   TABFBLDE=ON;                    /* BUILD DD ENTRY FUNC   @G24LB26*/ 02159000
         OI    TABFBLDE(@08),B'10000000'                           0657 02160000
*   TABSELRB=ADDR(RPLVUTIL);        /* ADDR SELECT REQ BLK   @G24LB26*/ 02161000
         LA    @06,RPLVUTIL(,RPLVPTR)                              0658 02162000
         ST    @06,TABSELRB(,@08)                                  0658 02163000
*   CALL ICBVTP00(TABP);            /* CALL TO TABLE PROC    @G24LB26*/ 02164000
*                                                                  0659 02165000
         ST    @08,@AL00001                                        0659 02166000
         L     @15,@CV01914                                        0659 02167000
         LA    @01,@AL00001                                        0659 02168000
         BALR  @14,@15                                             0659 02169000
*   /*****************************************************************/ 02170000
*   /*                                                               */ 02171000
*   /* IGNORE REG15 AND RETURN                               @G24LB26*/ 02172000
*   /*                                                               */ 02173000
*   /*****************************************************************/ 02174000
*                                                                  0660 02175000
*   RETURN;                         /*                       @G24LB26*/ 02176000
@EL00004 DS    0H                                                  0660 02177000
@EF00004 DS    0H                                                  0660 02178000
@ER00004 L     @14,@SA00004                                        0660 02179000
         BR    @14                                                 0660 02180000
*   END VOLREF;                     /*                       @G24LB26*/ 02181000
*                                                                  0662 02182000
*/*********************************************************  @G24LB26*/ 02183000
*/*                                                          @G24LB26*/ 02184000
*/* PROCEDURE NAME - ELGIBLCK                                @G24LB26*/ 02185000
*/*                                                          @G24LB26*/ 02186000
*/* FUNCTION - DETERMINES IF A VOLUME IS ELIGIBLE TO BE      @G24LB26*/ 02187000
*/*            SELECTED FOR THIS PARTICULAR REQUEST. CHECKS  @G24LB26*/ 02188000
*/*            AVAILABLE FREE SPACE, CHECKS MOUNT STATUS AND @G24LB26*/ 02189000
*/*            IF MOUNTED TO ANOTHER HOST, CHECKS TO SEE IF  @G24LB26*/ 02190000
*/*            GROUP MUST HAVE EXCLUSIVE CONTROL OR IF       @G24LB26*/ 02191000
*/*            VOLUME IS MOUNTED EXCLUSIVE TO ANOTHER HOST.  @G24LB26*/ 02192000
*/*            ALSO CHECKS FOR USER SPECIFIED UNIT OR DATA   @G24LB26*/ 02193000
*/*            SEPARATION REQUESTS. CHECKS MOUNT ATTRIBUTES  @G24LB26*/ 02194000
*/*            IF VOLUME HAS AN ASSOCIATED UCB.              @G24LB26*/ 02195000
*/*                                                          @G24LB26*/ 02196000
*/* INPUT - INDEX INTO BEST FIT TABLE, INDEX INTO GROUP      @G24LB26*/ 02197000
*/*         EXTENSION RECORD, GROUP RECORD, SELECT REQUEST   @G24LB26*/ 02198000
*/*         BLOCK, GROUP EXTENSION RECORD, MSVC CONTROL      @G24LB26*/ 02199000
*/*         BLOCK.                                           @G24LB26*/ 02200000
*/*                                                          @G24LB26*/ 02201000
*/* OUTPUT - AN ENTRY FOR THE VOLUME UNDER CONSIDERATION IN  @G24LB26*/ 02202000
*/*          THE BEST FIT TABLE OR A FOUR RETURN CODE IN     @G24LB26*/ 02203000
*/*          THE INTERNAL RETURN AREA.                       @G24LB26*/ 02204000
*/*          ISSUES MESSAGE ICB483I.                         @G24LB26*/ 02205000
*/*                                                          @G24LB26*/ 02206000
*/*********************************************************  @G24LB26*/ 02207000
*                                                                  0662 02208000
*ELGIBLCK:                                                         0662 02209000
*   PROC OPTIONS(SAVE(REG14));      /*                       @G24LB26*/ 02210000
*                                                                  0662 02211000
ELGIBLCK ST    @14,@SA00005                                        0662 02212000
*   /*****************************************************************/ 02213000
*   /*                                                               */ 02214000
*   /* ZERO INTERNAL WORK AREA, IE., INTERNAL RETURN         @G24LB26*/ 02215000
*   /* CODE AND UCB ADDRESS.                                 @G24LB26*/ 02216000
*   /*                                                               */ 02217000
*   /*****************************************************************/ 02218000
*                                                                  0663 02219000
*   DYNMAREA=DYNMAREA&&DYNMAREA;    /*                       @G24LB26*/ 02220000
*                                                                  0663 02221000
         XC    DYNMAREA(6),DYNMAREA                                0663 02222000
*   /*****************************************************************/ 02223000
*   /*                                                               */ 02224000
*   /* ZERO SLOT IN BEST FIT TABLE THAT WILL BE USED         @G24LB26*/ 02225000
*   /* FOR THIS CALL.                                        @G24LB26*/ 02226000
*   /*                                                               */ 02227000
*   /*****************************************************************/ 02228000
*                                                                  0664 02229000
*   BFENTRY(INDXBFTB)=              /*                       @G24LB26*/ 02230000
*       BFENTRY(INDXBFTB)&&BFENTRY(INDXBFTB);/*              @G24LB26*/ 02231000
*                                                                  0664 02232000
         L     @04,BFTBLPTR                                        0664 02233000
         LR    @15,INDXBFTB                                        0664 02234000
         MH    @15,@CH02240                                        0664 02235000
         ST    @15,@TF00001                                        0664 02236000
         ALR   @15,@04                                             0664 02237000
         XC    BFENTRY-18(18,@15),BFENTRY-18(@15)                  0664 02238000
*   /*****************************************************************/ 02239000
*   /*                                                               */ 02240000
*   /* DETERMINE MOUNT STATUS OF VOLUME AND                  @G24LB26*/ 02241000
*   /* SET INDICATORS IN BEST FIT TABLE.                     @G24LB26*/ 02242000
*   /*                                                               */ 02243000
*   /*****************************************************************/ 02244000
*                                                                  0665 02245000
*   IF GVSCPUBM(INDXEXTS)=ZEROMTMA THEN/*                    @G24LB26*/ 02246000
         LR    @15,INDXEXTS                                        0665 02247000
         MH    @15,@CH01851                                        0665 02248000
         L     @01,GVSNEPTR                                        0665 02249000
         ALR   @01,@15                                             0665 02250000
         CLC   GVSCPUBM-20(2,@01),@CB02111                         0665 02251000
         BNE   @RF00665                                            0665 02252000
*     DO;                           /*                       @G24LB26*/ 02253000
*                                                                  0666 02254000
*       /*************************************************************/ 02255000
*       /*                                                           */ 02256000
*       /* SET INDICATOR SHOWING VOLUME NOT MOUNTED.         @G24LB26*/ 02257000
*       /*                                                           */ 02258000
*       /*************************************************************/ 02259000
*                                                                  0667 02260000
*       BFNMTDFL(INDXBFTB)=ON;      /*                       @G24LB26*/ 02261000
         LR    @01,@04                                             0667 02262000
         AL    @01,@TF00001                                        0667 02263000
         OI    BFNMTDFL-18(@01),B'01000000'                        0667 02264000
*       BFNOTMTD(INDXBFTB)=ON;      /*                       @G24LB26*/ 02265000
         AL    @04,@TF00001                                        0668 02266000
         OI    BFNOTMTD-18(@04),B'10000000'                        0668 02267000
*     END;                          /*                       @G24LB26*/ 02268000
*                                                                  0669 02269000
*   /*****************************************************************/ 02270000
*   /*                                                               */ 02271000
*   /* IF VOLUME IS MOUNTED, DETERMINE IF MOUNTED            @G24LB26*/ 02272000
*   /* ONLY TO ANOTHER HOST.                                 @G24LB26*/ 02273000
*   /*                                                               */ 02274000
*   /*****************************************************************/ 02275000
*                                                                  0670 02276000
*   ELSE                            /*                       @G24LB26*/ 02277000
*     DO;                           /*                       @G24LB26*/ 02278000
*                                                                  0670 02279000
         B     @RC00665                                            0670 02280000
@RF00665 DS    0H                                                  0671 02281000
*       /*************************************************************/ 02282000
*       /*                                                           */ 02283000
*       /* CHECK TO IF MOUNTED TO THIS HOST.                 @G24LB26*/ 02284000
*       /*                                                           */ 02285000
*       /*************************************************************/ 02286000
*                                                                  0671 02287000
*       TESTMASK=VVICPUID&GVSCPUBM(INDXEXTS);/*              @G24LB26*/ 02288000
         LR    @04,INDXEXTS                                        0671 02289000
         MH    @04,@CH01851                                        0671 02290000
         L     @01,VVIPTR                                          0671 02291000
         MVC   TESTMASK(2),VVICPUID(@01)                           0671 02292000
         L     @01,GVSNEPTR                                        0671 02293000
         ALR   @01,@04                                             0671 02294000
         NC    TESTMASK(2),GVSCPUBM-20(@01)                        0671 02295000
*       IF TESTMASK=ZEROMTMA THEN   /*                       @G24LB26*/ 02296000
*                                                                  0672 02297000
         CLC   TESTMASK(2),@CB02111                                0672 02298000
         BNE   @RF00672                                            0672 02299000
*         /***********************************************************/ 02300000
*         /*                                                         */ 02301000
*         /* INDICATE VOLUME MOUNTED TO ANOTHER HOST.        @G24LB26*/ 02302000
*         /*                                                         */ 02303000
*         /***********************************************************/ 02304000
*                                                                  0673 02305000
*         DO;                       /*                       @G24LB26*/ 02306000
*           BFMTDOHF(INDXBFTB)=ON;  /*                       @G24LB26*/ 02307000
         L     @04,BFTBLPTR                                        0674 02308000
         LR    @15,INDXBFTB                                        0674 02309000
         MH    @15,@CH02240                                        0674 02310000
         ST    @15,@TF00001                                        0674 02311000
         ALR   @15,@04                                             0674 02312000
         OI    BFMTDOHF-18(@15),B'00100000'                        0674 02313000
*           BFMTDOTH(INDXBFTB)=ON;  /*                       @G24LB26*/ 02314000
*           BFMTDOHT(INDXBFTB)=ON;  /*                       @ZA28479*/ 02315000
         AL    @04,@TF00001                                        0676 02316000
         OI    BFMTDOTH-18(@04),B'01100000'                        0676 02317000
*         END;                      /*                       @G24LB26*/ 02318000
*       ELSE                        /*                       @ZA28479*/ 02319000
*                                                                  0678 02320000
*         /***********************************************************/ 02321000
*         /*                                                         */ 02322000
*         /* CHECK TO DETERMINE IF VOLUME MAY BE MOUNTED     @ZA28479*/ 02323000
*         /* TO OTHER HOST PLUS REQUESTING HOST.             @ZA28479*/ 02324000
*         /* IF SO, SET INDICATOR MOUNTED TO OTHER HOST      @ZA28479*/ 02325000
*         /*                                                         */ 02326000
*         /***********************************************************/ 02327000
*                                                                  0678 02328000
*         DO;                       /*                       @ZA28479*/ 02329000
         B     @RC00672                                            0678 02330000
@RF00672 DS    0H                                                  0679 02331000
*           TESTMASK=VVICPUID&&GVSCPUBM(INDXEXTS);/*         @ZA28479*/ 02332000
         LR    @04,INDXEXTS                                        0679 02333000
         MH    @04,@CH01851                                        0679 02334000
         L     @01,VVIPTR                                          0679 02335000
         MVC   TESTMASK(2),VVICPUID(@01)                           0679 02336000
         L     @01,GVSNEPTR                                        0679 02337000
         ALR   @01,@04                                             0679 02338000
         XC    TESTMASK(2),GVSCPUBM-20(@01)                        0679 02339000
*           IF TESTMASK^=ZEROMTMA THEN/*                     @ZA28479*/ 02340000
         CLC   TESTMASK(2),@CB02111                                0680 02341000
         BE    @RF00680                                            0680 02342000
*             BFMTDOHT(INDXBFTB)=ON;/*                       @ZA28479*/ 02343000
         LR    @04,INDXBFTB                                        0681 02344000
         MH    @04,@CH02240                                        0681 02345000
         L     @01,BFTBLPTR                                        0681 02346000
         ALR   @01,@04                                             0681 02347000
         OI    BFMTDOHT-18(@01),B'00100000'                        0681 02348000
*         END;                      /*                       @ZA28479*/ 02349000
@RF00680 DS    0H                                                  0683 02350000
*     END;                          /*                       @G24LB26*/ 02351000
*                                                                  0683 02352000
@RC00672 DS    0H                                                  0684 02353000
*   /*****************************************************************/ 02354000
*   /*                                                               */ 02355000
*   /* DETERMINE IF VOLUME IS MOUNTED                        @ZA28479*/ 02356000
*   /* TO THIS HOST. IF IT IS, CALL UNIT PROCESSOR           @ZA28479*/ 02357000
*   /* TO GET A UCB ADDRESS.                                 @G24LB26*/ 02358000
*   /*                                                               */ 02359000
*   /*****************************************************************/ 02360000
*                                                                  0684 02361000
*   IF BFNOTMTD(INDXBFTB)=OFF&BFMTDOTH(INDXBFTB)=OFF/*       @ZA28479*/ 02362000
*     THEN                          /*                       @ZA28479*/ 02363000
*                                                                  0684 02364000
@RC00665 LR    @04,INDXBFTB                                        0684 02365000
         MH    @04,@CH02240                                        0684 02366000
         L     @01,BFTBLPTR                                        0684 02367000
         ALR   @01,@04                                             0684 02368000
         TM    BFNOTMTD-18(@01),B'11000000'                        0684 02369000
         BNZ   @RF00684                                            0684 02370000
*     /***************************************************************/ 02371000
*     /*                                                             */ 02372000
*     /* CALL UNIT PROCESSOR                                 @ZA28479*/ 02373000
*     /*                                                             */ 02374000
*     /***************************************************************/ 02375000
*                                                                  0685 02376000
*     DO;                           /*                       @ZA28479*/ 02377000
*       UNITP=UNITP&&UNITP;         /* ZERO UNIT PROC PARM   @G24LB26*/ 02378000
         LA    @04,STRUNITP                                        0686 02379000
         XC    UNITP(17,@04),UNITP(@04)                            0686 02380000
*       UNIVOL=GVSVOLID(INDXEXTS);  /* VOLID FOR SEARCH      @G24LB26*/ 02381000
         LR    @15,INDXEXTS                                        0687 02382000
         MH    @15,@CH01851                                        0687 02383000
         L     @01,GVSNEPTR                                        0687 02384000
         ALR   @01,@15                                             0687 02385000
         MVC   UNIVOL(6,@04),GVSVOLID-20(@01)                      0687 02386000
*       UNIFMTD=ON;                 /* INDICATE MOUNT CHECK  @G24LB26*/ 02387000
         OI    UNIFMTD(@04),B'10000000'                            0688 02388000
*       RESPECIFY                                                  0689 02389000
*         REG15 RSTD;               /*                       @G24LB26*/ 02390000
*       CALL ICBVUP00(UNITP,VVICB); /*                       @G24LB26*/ 02391000
         ST    @04,@AL00001                                        0690 02392000
         L     @14,VVIPTR                                          0690 02393000
         ST    @14,@AL00001+4                                      0690 02394000
         L     @15,@CV01913                                        0690 02395000
         LA    @01,@AL00001                                        0690 02396000
         BALR  @14,@15                                             0690 02397000
*       IF REG15=RCZERO THEN        /*                       @G24LB26*/ 02398000
*                                                                  0691 02399000
         LTR   REG15,REG15                                         0691 02400000
         BNZ   @RF00691                                            0691 02401000
*         /***********************************************************/ 02402000
*         /*                                                         */ 02403000
*         /* SET UCB ADDRESS IN WORK AREA AND CHECK UCB.     @G24LB26*/ 02404000
*         /*                                                         */ 02405000
*         /***********************************************************/ 02406000
*                                                                  0692 02407000
*         DO;                       /*                       @G24LB26*/ 02408000
*           UCBADDR=UNIUCBP;        /* UCB ADDR TO WORK AREA @G24LB26*/ 02409000
         LA    @14,STRUNITP                                        0693 02410000
         L     @14,UNIUCBP(,@14)                                   0693 02411000
         ST    @14,UCBADDR                                         0693 02412000
*           UCBPTR=UNIUCBP;         /* SET UP ADDRESSABILITY @G24LB26   02413000
*                                      TO UCB                @G24LB26*/ 02414000
*                                                                  0694 02415000
         ST    @14,UCBPTR                                          0694 02416000
*           /*********************************************************/ 02417000
*           /*                                                       */ 02418000
*           /* CHECK MOUNTING ATTRIBUTES OF VOLUME IN UCB.   @G24LB26*/ 02419000
*           /* CHECK IF ONLINE, PRIVATE RESERVED, PRIVATE    @G24LB26*/ 02420000
*           /* REMOVEABLE, OR NO MOUNTING ATTRIBUTES.        @G24LB26*/ 02421000
*           /*                                                       */ 02422000
*           /*********************************************************/ 02423000
*                                                                  0695 02424000
*           IF UCBONLI=ON&UCBPRES=OFF&/*                     @G24LB26*/ 02425000
*               (UCBBPRV=ON|(UCBBPRV=OFF&UCBBPUB=OFF&/*      @G24LB26*/ 02426000
*               UCBBSTR=OFF&UCBRESV=OFF)) THEN                     0695 02427000
         TM    UCBONLI(@14),B'10000000'                            0695 02428000
         BNO   @RF00695                                            0695 02429000
         TM    UCBPRES(@14),B'00000100'                            0695 02430000
         BNZ   @RF00695                                            0695 02431000
         TM    UCBBPRV(@14),B'00010000'                            0695 02432000
         BO    @RT00695                                            0695 02433000
         TM    UCBBPRV(@14),B'00011100'                            0695 02434000
         BNZ   @RF00695                                            0695 02435000
         TM    UCBRESV(@14),B'00100000'                            0695 02436000
         BZ    @RT00695                                            0695 02437000
*             ;                     /*                       @G24LB26*/ 02438000
*                                                                  0696 02439000
*           /*********************************************************/ 02440000
*           /*                                                       */ 02441000
*           /* IF ABOVE CONDITIONS ARE NOT MET, VOLUME       @G24LB26*/ 02442000
*           /* IS INELIGIBLE.                                @G24LB26*/ 02443000
*           /*                                                       */ 02444000
*           /*********************************************************/ 02445000
*                                                                  0697 02446000
*           ELSE                    /*                       @G24LB26*/ 02447000
*             INTERCC=RCFOUR;       /*                       @G24LB26*/ 02448000
@RF00695 MVC   INTERCC(2),@CB02113                                 0697 02449000
*         END;                      /*                       @G24LB26*/ 02450000
@RT00695 DS    0H                                                  0699 02451000
*       RESPECIFY                                                  0699 02452000
*         REG15 UNRSTD;             /*                       @G24LB26*/ 02453000
@RF00691 DS    0H                                                  0700 02454000
*     END;                          /*                       @G24LB26*/ 02455000
*                                                                  0700 02456000
*   /*****************************************************************/ 02457000
*   /*                                                               */ 02458000
*   /* CHECK RUNNING FREE SPACE INDICATOR, AND IF IT         @G24LB26*/ 02459000
*   /* SHOWS RUNNING SPACE IS INVALID, CORRECT IT BY         @ZA28479*/ 02460000
*   /* ISSUING LSPACE IF THE VOLUME IS MOUNTED TO THE        @ZA28479*/ 02461000
*   /* REQUESTING HOST ONLY                                  @ZA28479*/ 02462000
*   /*                                                               */ 02463000
*   /*****************************************************************/ 02464000
*                                                                  0701 02465000
*   IF INTERCC=RCZERO&GVSRCFSI(INDXEXTS)=ON THEN/*           @ZA28479*/ 02466000
@RF00684 CLC   INTERCC(2),@CB02111                                 0701 02467000
         BNE   @RF00701                                            0701 02468000
         LR    @04,INDXEXTS                                        0701 02469000
         MH    @04,@CH01851                                        0701 02470000
         L     @01,GVSNEPTR                                        0701 02471000
         ALR   @01,@04                                             0701 02472000
         TM    GVSRCFSI-20(@01),B'10000000'                        0701 02473000
         BNO   @RF00701                                            0701 02474000
*     DO;                           /*                       @ZA28479*/ 02475000
*                                                                  0702 02476000
*       /*************************************************************/ 02477000
*       /*                                                           */ 02478000
*       /* CHECK TO DETERMINE IF THE VOLUME IS MOUNTED TO    @ZA28479*/ 02479000
*       /* THE REQUESTING HOST AND NOT OTHER HOST.           @ZA28479*/ 02480000
*       /* ALSO CHECK IF UCB ADDRESS WAS SUCCESSFULLY        @ZA28479*/ 02481000
*       /* OBTAINED                                          @ZA28479*/ 02482000
*       /*                                                           */ 02483000
*       /*************************************************************/ 02484000
*                                                                  0703 02485000
*       IF BFNOTMTD(INDXBFTB)=OFF&BFMTDOHT(INDXBFTB)=OFF&UCBADDR^= 0703 02486000
*           ZEROPTR THEN            /*                       @ZA28479*/ 02487000
         LR    @04,INDXBFTB                                        0703 02488000
         MH    @04,@CH02240                                        0703 02489000
         L     @01,BFTBLPTR                                        0703 02490000
         ALR   @01,@04                                             0703 02491000
         TM    BFNOTMTD-18(@01),B'10100000'                        0703 02492000
         BNZ   @RF00703                                            0703 02493000
         L     @04,UCBADDR                                         0703 02494000
         LTR   @04,@04                                             0703 02495000
         BZ    @RF00703                                            0703 02496000
*         DO;                       /*                       @ZA28479*/ 02497000
*                                                                  0704 02498000
*           /*********************************************************/ 02499000
*           /*                                                       */ 02500000
*           /* ISSUE LSPACE TO GET SPACE UP LEVEL            @ZA28479*/ 02501000
*           /*                                                       */ 02502000
*           /*********************************************************/ 02503000
*                                                                  0705 02504000
*           RESPECIFY                                              0705 02505000
*            (REG0,                                                0705 02506000
*             REG1,                                                0705 02507000
*             REG15) RSTD;          /*                       @ZA28479*/ 02508000
*           REG0=ADDR(UCBOB);       /* SET UP UCB ADDR       @ZA28479*/ 02509000
         L     REG0,UCBPTR                                         0706 02510000
*           REG1=ADDR(LSPAREA);     /* ADDR OF RETURN AREA   @ZA28479*/ 02511000
         LA    REG1,LSPAREA                                        0707 02512000
*           SVC(LSPACE);            /* ISSUE LSPACE MACRO    @ZA28479*/ 02513000
*                                                                  0708 02514000
         SVC   78                                                  0708 02515000
*           /*********************************************************/ 02516000
*           /*                                                       */ 02517000
*           /* IF LSPACE SUCCESSFUL, UPDATE FREE SPACE IN    @ZA28479*/ 02518000
*           /* EXTENSION RECORD. ALSO LARGEST FREE EXTENT    @ZA28479*/ 02519000
*           /*                                                       */ 02520000
*           /*********************************************************/ 02521000
*                                                                  0709 02522000
*           RESPECIFY                                              0709 02523000
*             REG1 UNRSTD;          /*                       @ZA28479*/ 02524000
*           IF REG15=RCZERO THEN    /*                       @ZA28479*/ 02525000
         LTR   REG15,REG15                                         0710 02526000
         BNZ   @RF00710                                            0710 02527000
*             DO;                   /*                       @ZA28479*/ 02528000
*               PACK(TEMPPACK,LSPFRESP);/*                   @ZA28479*/ 02529000
         PACK  TEMPPACK(4),LSPFRESP(4)                             0712 02530000
*               CVB(TEMPBIN,TEMPPACK);/*                     @ZA28479*/ 02531000
         XC    @TS00001(8),@TS00001                                0713 02532000
         MVC   @TS00001+4(4),TEMPPACK                              0713 02533000
         CVB   TEMPBIN,@TS00001                                    0713 02534000
*               GVSFRESP(INDXEXTS)=TEMPBIN;/* UPDT FREE SP   @ZA28479*/ 02535000
         L     @14,GVSNEPTR                                        0714 02536000
         LR    @04,INDXEXTS                                        0714 02537000
         MH    @04,@CH01851                                        0714 02538000
         STH   TEMPBIN,GVSFRESP-20(@04,@14)                        0714 02539000
*               PACK(TEMPPACK,LSPLEXT);/*                    @ZA28479*/ 02540000
         PACK  TEMPPACK(4),LSPLEXT(4)                              0715 02541000
*               CVB(TEMPBIN,TEMPPACK);/*                     @ZA28479*/ 02542000
         XC    @TS00001(8),@TS00001                                0716 02543000
         MVC   @TS00001+4(4),TEMPPACK                              0716 02544000
         CVB   TEMPBIN,@TS00001                                    0716 02545000
*               GVSLEXT(INDXEXTS)=TEMPBIN;/* UPDT LRGST EXT  @ZA28479*/ 02546000
*                                                                  0717 02547000
         STH   TEMPBIN,GVSLEXT-20(@04,@14)                         0717 02548000
*               /*****************************************************/ 02549000
*               /*                                                   */ 02550000
*               /* CALL TABLE PROCESSOR TO GET SCHEDULED     @ZA28479*/ 02551000
*               /* SPACE                                     @ZA28479*/ 02552000
*               /*                                                   */ 02553000
*               /*****************************************************/ 02554000
*                                                                  0718 02555000
*               TABP=TABP&&TABP;    /* CLEAR TABLE PARM      @ZA28479*/ 02556000
         LA    @01,STRTABP                                         0718 02557000
         XC    TABP(12,@01),TABP(@01)                              0718 02558000
*               TABFTSPC=ON;        /* SEARCH FOR VOL        @ZA28479*/ 02559000
         OI    TABFTSPC(@01),B'00010000'                           0719 02560000
*               TABVOLID=GVSVOLID(INDXEXTS);/* VOLID         @ZA28479*/ 02561000
         ALR   @14,@04                                             0720 02562000
         MVC   TABVOLID(6,@01),GVSVOLID-20(@14)                    0720 02563000
*               CALL ICBVTP00(TABP);/* CALL TABLE PROCESSOR  @ZA28479*/ 02564000
         ST    @01,@AL00001                                        0721 02565000
         L     @15,@CV01914                                        0721 02566000
         LA    @01,@AL00001                                        0721 02567000
         BALR  @14,@15                                             0721 02568000
*               GVSMTDSP(INDXEXTS)=GVSFRESP(INDXEXTS)-TABSPRET;    0722 02569000
         L     @14,GVSNEPTR                                        0722 02570000
         LR    @04,INDXEXTS                                        0722 02571000
         MH    @04,@CH01851                                        0722 02572000
         LA    @01,STRTABP                                         0722 02573000
         LH    @03,GVSFRESP-20(@04,@14)                            0722 02574000
         SH    @03,TABSPRET(,@01)                                  0722 02575000
         STH   @03,GVSMTDSP-20(@04,@14)                            0722 02576000
*               GVSRCFSI(INDXEXTS)=OFF;/* AVAIL SPACE OK     @ZA28479*/ 02577000
*                                                                  0723 02578000
         ST    @04,@TF00001                                        0723 02579000
         ALR   @04,@14                                             0723 02580000
         NI    GVSRCFSI-20(@04),B'01111111'                        0723 02581000
*               /*****************************************************/ 02582000
*               /*                                                   */ 02583000
*               /* CHECK FOR NEGATIVE NUMBER                 @ZA28479*/ 02584000
*               /*                                                   */ 02585000
*               /*****************************************************/ 02586000
*                                                                  0724 02587000
*               IF GVSMTDSP(INDXEXTS)<ZERO THEN/*            @ZA28479*/ 02588000
         SLR   @04,@04                                             0724 02589000
         L     @01,@TF00001                                        0724 02590000
         CH    @04,GVSMTDSP-20(@01,@14)                            0724 02591000
         BNH   @RF00724                                            0724 02592000
*                 GVSMTDSP(INDXEXTS)=ZERO;/*                 @ZA28479*/ 02593000
         L     @01,@TF00001                                        0725 02594000
         STH   @04,GVSMTDSP-20(@01,@14)                            0725 02595000
*               RESPECIFY                                          0726 02596000
*                 REG0 UNRSTD;      /*                       @ZA28479*/ 02597000
*                                                                  0726 02598000
@RF00724 DS    0H                                                  0727 02599000
*               /*****************************************************/ 02600000
*               /*                                                   */ 02601000
*               /* INDICATE EXTENSION RECORD UPDATED         @ZA28479*/ 02602000
*               /*                                                   */ 02603000
*               /*****************************************************/ 02604000
*                                                                  0727 02605000
*               UPDTGVSN=ON;        /*                       @ZA28479*/ 02606000
         OI    UPDTGVSN,B'10000000'                                0727 02607000
*             END;                  /*                       @ZA28479*/ 02608000
*           ELSE                    /*                       @ZA28479*/ 02609000
*                                                                  0729 02610000
*             /*******************************************************/ 02611000
*             /*                                                     */ 02612000
*             /* ISSUE ERROR MESSAGE, LSPACE FAILED          @ZA28479*/ 02613000
*             /*                                                     */ 02614000
*             /*******************************************************/ 02615000
*                                                                  0729 02616000
*             DO;                   /*                       @ZA28479*/ 02617000
         B     @RC00710                                            0729 02618000
@RF00710 DS    0H                                                  0730 02619000
*               RESPECIFY                                          0730 02620000
*                 REG1 RSTD;        /*                       @ZA28479*/ 02621000
*               MSGRQ=MSGRQ&&MSGRQ; /* CLEAR PARM FIELD      @ZA28479*/ 02622000
         XC    MSGRQ(32),MSGRQ                                     0731 02623000
*               MSGRPLV=RPLVPTR;    /* ADDR OF REQUEST PARM  @ZA28479*/ 02624000
         ST    RPLVPTR,MSGRPLV                                     0732 02625000
*               MSGID=MSG401;       /* MSG NUMBER            @ZA28479*/ 02626000
         MVC   MSGID(4),@CF02057                                   0733 02627000
*               MSGLEN1=SIX;        /* MSG LENGTH OF INSERT  @ZA28479*/ 02628000
         MVI   MSGLEN1,X'06'                                       0734 02629000
*               MSGTEXT1=ADDR(GVSVOLID(INDXEXTS));/* INSERT  @ZA28479*/ 02630000
         LR    @14,INDXEXTS                                        0735 02631000
         MH    @14,@CH01851                                        0735 02632000
         L     @04,GVSNEPTR                                        0735 02633000
         LA    @14,GVSVOLID-20(@14,@04)                            0735 02634000
         STCM  @14,7,MSGTEXT1                                      0735 02635000
*               MSGLEN2=TWO;        /* MSG LENGTH OF INSERT  @ZA28479*/ 02636000
         MVI   MSGLEN2,X'02'                                       0736 02637000
*               MSGTEXT2=ADDR(TEMPCHAR);/* INSERT TWO        @ZA28479*/ 02638000
         LA    @14,TEMPCHAR                                        0737 02639000
         STCM  @14,7,MSGTEXT2                                      0737 02640000
*               TEMPBIN=REG15;      /* RETURN CODE           @ZA28479*/ 02641000
         LR    TEMPBIN,REG15                                       0738 02642000
*               CVD(TEMPBIN,TEMPPACK);/*                     @ZA28479*/ 02643000
         CVD   TEMPBIN,@TS00001                                    0739 02644000
         MVC   TEMPPACK(4),@TS00001+4                              0739 02645000
*               UNPK(TEMPCHAR,TEMPPACK);/*                   @ZA28479*/ 02646000
         UNPK  TEMPCHAR(2),TEMPPACK(4)                             0740 02647000
*               TEMPCHAR(2:2)=TEMPCHAR(2:2)|ORSIGN;/* PRTBLE @ZA28479*/ 02648000
         OC    TEMPCHAR+1(1),ORSIGN                                0741 02649000
*               REG1=ADDR(MSGRQ);   /*                       @ZA28479*/ 02650000
         LA    REG1,MSGRQ                                          0742 02651000
*               CALL ICBVOP00;      /* CALL MSG MODULE       @ZA28479*/ 02652000
         L     @15,@CV01912                                        0743 02653000
         BALR  @14,@15                                             0743 02654000
*             END;                  /*                       @ZA28479*/ 02655000
*         END;                      /*                       @ZA28479*/ 02656000
@RC00710 DS    0H                                                  0746 02657000
*     END;                          /*                       @ZA28479*/ 02658000
@RF00703 DS    0H                                                  0747 02659000
*   RESPECIFY                                                      0747 02660000
*     REG15 UNRSTD;                 /*                       @ZA28479*/ 02661000
*                                                                  0747 02662000
@RF00701 DS    0H                                                  0748 02663000
*   /*****************************************************************/ 02664000
*   /*                                                               */ 02665000
*   /* ISSUE MESSAGE FOR DOWN LEVEL RUNNING SPACE            @ZA28479*/ 02666000
*   /* ICB483I WITH INTERNAL RETURN CODE OF FOUR.            @ZA28479*/ 02667000
*   /*                                                               */ 02668000
*   /*****************************************************************/ 02669000
*                                                                  0748 02670000
*   IF INTERCC=RCZERO&GVSRCFSI(INDXEXTS)=ON THEN/*           @ZA28479*/ 02671000
         CLC   INTERCC(2),@CB02111                                 0748 02672000
         BNE   @RF00748                                            0748 02673000
         L     @04,GVSNEPTR                                        0748 02674000
         LR    @15,INDXEXTS                                        0748 02675000
         MH    @15,@CH01851                                        0748 02676000
         ST    @15,@TF00001                                        0748 02677000
         ALR   @15,@04                                             0748 02678000
         TM    GVSRCFSI-20(@15),B'10000000'                        0748 02679000
         BNO   @RF00748                                            0748 02680000
*     DO;                           /*                       @ZA28479*/ 02681000
*       MSGRQ=MSGRQ&&MSGRQ;         /* CLEAR MESSAGE PARM    @G24LB26*/ 02682000
         XC    MSGRQ(32),MSGRQ                                     0750 02683000
*       MSGRPLV=RPLVPTR;            /* RPLV PTR              @G24LB26*/ 02684000
         ST    RPLVPTR,MSGRPLV                                     0751 02685000
*       MSGID=MSG483;               /* SET MSG ID FOR ICB483I      0752 02686000
*                                                            @G24LB26*/ 02687000
         MVC   MSGID(4),@CF02075                                   0752 02688000
*       MSGLEN1=SIX;                /* LENGTH FIRST INSERT   @G24LB26*/ 02689000
         MVI   MSGLEN1,X'06'                                       0753 02690000
*       MSGTEXT1=ADDR(GVSVOLID(INDXEXTS));/* VOL INSERT      @G24LB26*/ 02691000
         L     @15,@TF00001                                        0754 02692000
         LA    @00,GVSVOLID-20(@15,@04)                            0754 02693000
         STCM  @00,7,MSGTEXT1                                      0754 02694000
*       MSGLEN2=EIGHT;              /* LENGTH REC INSERT     @G24LB26*/ 02695000
         MVI   MSGLEN2,X'08'                                       0755 02696000
*       MSGTEXT2=ADDR(GVSVVGRP);    /* GROUP NAME            @G24LB26*/ 02697000
         LA    @04,GVSVVGRP(,@04)                                  0756 02698000
         STCM  @04,7,MSGTEXT2                                      0756 02699000
*       REG1=ADDR(MSGRQ);           /* ADDR OF MESSAGE PARM  @G24LB26*/ 02700000
         LA    REG1,MSGRQ                                          0757 02701000
*       CALL ICBVOP00;              /* ISSUE MESSAGE         @G24LB26*/ 02702000
         L     @15,@CV01912                                        0758 02703000
         BALR  @14,@15                                             0758 02704000
*       INTERCC=RCFOUR;             /* ERROR RETURN CODE     @G24LB26*/ 02705000
         MVC   INTERCC(2),@CB02113                                 0759 02706000
*     END;                          /*                       @ZA28479*/ 02707000
*   RESPECIFY                                                      0761 02708000
*     REG1 UNRSTD;                  /*                       @ZA28479*/ 02709000
*                                                                  0761 02710000
@RF00748 DS    0H                                                  0762 02711000
*   /*****************************************************************/ 02712000
*   /*                                                               */ 02713000
*   /* CHECK OVERALL STATUS OF VOLUME                        @ZA28479*/ 02714000
*   /*                                                               */ 02715000
*   /*****************************************************************/ 02716000
*                                                                  0762 02717000
*   IF INTERCC=RCZERO THEN          /*                       @ZA28479*/ 02718000
         CLC   INTERCC(2),@CB02111                                 0762 02719000
         BNE   @RF00762                                            0762 02720000
*     DO;                           /*                       @ZA28479*/ 02721000
*                                                                  0763 02722000
*       /*************************************************************/ 02723000
*       /*                                                           */ 02724000
*       /* USING MOUNT FLAGS SET PREVIOUSLY, DETERMINE IF    @ZA28479*/ 02725000
*       /* VOLUME IS MOUNTED EXCLUSIVE TO ANOTHER HOST OR IF @G24LB26*/ 02726000
*       /* MOUNTED ANOTHER HOST, CANNOT BE USED BY THIS      @G24LB26*/ 02727000
*       /* HOST.                                             @G24LB26*/ 02728000
*       /*                                                           */ 02729000
*       /*************************************************************/ 02730000
*                                                                  0764 02731000
*       IF BFMTDOTH(INDXBFTB)=ON THEN/*                      @G24LB26*/ 02732000
*                                                                  0764 02733000
         LR    @04,INDXBFTB                                        0764 02734000
         MH    @04,@CH02240                                        0764 02735000
         L     @01,BFTBLPTR                                        0764 02736000
         ALR   @01,@04                                             0764 02737000
         TM    BFMTDOTH-18(@01),B'01000000'                        0764 02738000
         BNO   @RF00764                                            0764 02739000
*         /***********************************************************/ 02740000
*         /*                                                         */ 02741000
*         /* CHECK IF VOLUME SHOULD BE EXCLUSIVE TO THIS     @G24LB26*/ 02742000
*         /* HOST OR IF ALREADY EXCLUSIVE TO ANOTHER HOST,   @G24LB26*/ 02743000
*         /* SET BAD RETURN CODE IF IT IS.                   @G24LB26*/ 02744000
*         /*                                                         */ 02745000
*         /***********************************************************/ 02746000
*                                                                  0765 02747000
*         IF GROEXCL=ON|GVSMTNSH(INDXEXTS)=ON THEN/*         @G24LB26*/ 02748000
         L     @04,GROUPPTR                                        0765 02749000
         TM    GROEXCL(@04),B'01000000'                            0765 02750000
         BO    @RT00765                                            0765 02751000
         LR    @04,INDXEXTS                                        0765 02752000
         MH    @04,@CH01851                                        0765 02753000
         L     @01,GVSNEPTR                                        0765 02754000
         ALR   @01,@04                                             0765 02755000
         TM    GVSMTNSH-20(@01),B'01000000'                        0765 02756000
         BNO   @RF00765                                            0765 02757000
@RT00765 DS    0H                                                  0766 02758000
*           INTERCC=RCFOUR;         /*                       @G24LB26*/ 02759000
         MVC   INTERCC(2),@CB02113                                 0766 02760000
*     END;                          /*                       @ZA28479*/ 02761000
*                                                                  0767 02762000
@RF00765 DS    0H                                                  0767 02763000
@RF00764 DS    0H                                                  0768 02764000
*   /*****************************************************************/ 02765000
*   /*                                                               */ 02766000
*   /* DETERMINE IF VOLUME IS STILL ELIGIBLE, AND IF IT IS,  @G24LB26*/ 02767000
*   /* CALL ROUTINE TO CHECK EXPIRATION DATES.               @G24LB26*/ 02768000
*   /*                                                               */ 02769000
*   /*****************************************************************/ 02770000
*                                                                  0768 02771000
*   IF INTERCC=RCZERO THEN          /*                       @G24LB26*/ 02772000
@RF00762 CLC   INTERCC(2),@CB02111                                 0768 02773000
         BNE   @RF00768                                            0768 02774000
*     CALL EXPIRCK;                 /*                       @G24LB26*/ 02775000
*                                                                  0769 02776000
         BAL   @14,EXPIRCK                                         0769 02777000
*   /*****************************************************************/ 02778000
*   /*                                                               */ 02779000
*   /* IF GOOD RETURN CODE FROM PREVIOUS PROCESSING,         @G24LB26*/ 02780000
*   /* CONTINUE.                                             @G24LB26*/ 02781000
*   /*                                                               */ 02782000
*   /*****************************************************************/ 02783000
*                                                                  0770 02784000
*   IF INTERCC=RCZERO THEN          /*                       @G24LB26*/ 02785000
@RF00768 CLC   INTERCC(2),@CB02111                                 0770 02786000
         BNE   @RF00770                                            0770 02787000
*     DO;                           /*                       @G24LB26*/ 02788000
*                                                                  0771 02789000
*       /*************************************************************/ 02790000
*       /*                                                           */ 02791000
*       /* IF SPACE FOR THIS REQUEST HAS NOT YET BEEN        @G24LB26*/ 02792000
*       /* CALCULATED, CALL ROUTINE TO CALCULATE SPACE       @G24LB26*/ 02793000
*       /* IN CYLINDERS.                                     @G24LB26*/ 02794000
*       /*                                                           */ 02795000
*       /*************************************************************/ 02796000
*                                                                  0772 02797000
*       IF PRICYL=ZERO&SECCYL=ZERO THEN/*                    @G24LB26*/ 02798000
         SLR   @04,@04                                             0772 02799000
         CH    @04,PRICYL                                          0772 02800000
         BNE   @RF00772                                            0772 02801000
         CH    @04,SECCYL                                          0772 02802000
         BNE   @RF00772                                            0772 02803000
*         CALL SPACONV;             /*                       @G24LB26*/ 02804000
*                                                                  0773 02805000
         BAL   @14,SPACONV                                         0773 02806000
*       /*************************************************************/ 02807000
*       /*                                                           */ 02808000
*       /* CALL ROUTINE TO DETERMINE IF ENOUGH SPACE ON      @G24LB26*/ 02809000
*       /* VOLUME FOR EITHER A PRIMARY OR SECONDARY REQUEST. @G24LB26*/ 02810000
*       /*                                                           */ 02811000
*       /*************************************************************/ 02812000
*                                                                  0774 02813000
*       CALL SPACECK;               /*                       @G24LB26*/ 02814000
@RF00772 BAL   @14,SPACECK                                         0774 02815000
*     END;                          /*                       @G24LB26*/ 02816000
*                                                                  0775 02817000
*   /*****************************************************************/ 02818000
*   /*                                                               */ 02819000
*   /* IF VOLUME IS STILL ELIGIBLE, DETERMINE IF REQUEST HAS @G24LB26*/ 02820000
*   /* ANY DATA SEPARATION RESTRICTIONS.                     @G24LB26*/ 02821000
*   /*                                                               */ 02822000
*   /*****************************************************************/ 02823000
*                                                                  0776 02824000
*   IF INTERCC=RCZERO&SELSEPVL=ON THEN/*                     @G24LB26*/ 02825000
@RF00770 CLC   INTERCC(2),@CB02111                                 0776 02826000
         BNE   @RF00776                                            0776 02827000
         TM    SELSEPVL(SELTMPTR),B'00100000'                      0776 02828000
         BNO   @RF00776                                            0776 02829000
*     CALL VOLSEPCK;                /*                       @G24LB26*/ 02830000
*                                                                  0777 02831000
         BAL   @14,VOLSEPCK                                        0777 02832000
*   /*****************************************************************/ 02833000
*   /*                                                               */ 02834000
*   /* IF VOLUME IS STILL ELIGIBLE, IT WILL BE AN ENTRY IN   @G24LB26*/ 02835000
*   /* THE BEST FIT TABLE, SO FILL IN THE REMAINING FIELDS   @G24LB26*/ 02836000
*   /* IN THE TABLE THAT ARE KNOWN AT THIS TIME.             @G24LB26*/ 02837000
*   /*                                                               */ 02838000
*   /*****************************************************************/ 02839000
*                                                                  0778 02840000
*   IF INTERCC=RCZERO THEN          /*                       @G24LB26*/ 02841000
@RF00776 CLC   INTERCC(2),@CB02111                                 0778 02842000
         BNE   @RF00778                                            0778 02843000
*     DO;                           /*                       @G24LB26*/ 02844000
*       BFVOLID(INDXBFTB)=GVSVOLID(INDXEXTS);/* VOLID IN     @G24LB26   02845000
*                                      BFTBL                 @G24LB26*/ 02846000
         L     @04,BFTBLPTR                                        0780 02847000
         LR    @15,INDXBFTB                                        0780 02848000
         MH    @15,@CH02240                                        0780 02849000
         ST    @15,@TF00001                                        0780 02850000
         ALR   @15,@04                                             0780 02851000
         L     @14,GVSNEPTR                                        0780 02852000
         LR    @03,INDXEXTS                                        0780 02853000
         MH    @03,@CH01851                                        0780 02854000
         ALR   @03,@14                                             0780 02855000
         MVC   BFVOLID-18(6,@15),GVSVOLID-20(@03)                  0780 02856000
*       BFGRPIDX(INDXBFTB)=GVSNO;   /* INDEX TO EXTEN REC    @G24LB26*/ 02857000
         SLR   @15,@15                                             0781 02858000
         IC    @15,GVSNO(,@14)                                     0781 02859000
         L     @14,@TF00001                                        0781 02860000
         STC   @15,BFGRPIDX-18(@14,@04)                            0781 02861000
*       BFGRPSLT(INDXBFTB)=INDXEXTS;/* INDEX TO SLOT IN      @G24LB26   02862000
*                                      EXTENSION REC         @G24LB26*/ 02863000
         L     @01,@TF00001                                        0782 02864000
         STC   INDXEXTS,BFGRPSLT-18(@01,@04)                       0782 02865000
*       SLGRPSPA=SLGRPSPA+TPVOLSPA; /* UPDATE USABLE SPACE   @ZA28479   02866000
*                                      TOTAL FOR THE GROUP   @ZA28479*/ 02867000
         LH    @04,TPVOLSPA                                        0783 02868000
         AL    @04,SLGRPSPA                                        0783 02869000
         ST    @04,SLGRPSPA                                        0783 02870000
*     END;                          /*                       @G24LB26*/ 02871000
*   RETURN;                         /*                       @G24LB26*/ 02872000
@EL00005 DS    0H                                                  0785 02873000
@EF00005 DS    0H                                                  0785 02874000
@ER00005 L     @14,@SA00005                                        0785 02875000
         BR    @14                                                 0785 02876000
*   END ELGIBLCK;                   /*                       @G24LB26*/ 02877000
         B     @EL00005                                            0786 02878000
*                                                                  0787 02879000
*/*********************************************************  @G24LB26*/ 02880000
*/*                                                          @G24LB26*/ 02881000
*/* PROCEDURE NAME - EXPIRCK                                 @G24LB26*/ 02882000
*/*                                                          @G24LB26*/ 02883000
*/* FUNCTION - ROUTINE DETERMINES IF VOLUME IS IN A          @G24LB26*/ 02884000
*/*            RETENTION GROUP AND IF IT IS, DETERMINES IF   @G24LB26*/ 02885000
*/*            THE VOLUME EXPIRES BEFORE THE DATA SET TO BE  @G24LB26*/ 02886000
*/*            ALLOCATED DOES. IF THE VOLUME IN A RETENTION  @G24LB26*/ 02887000
*/*            GROUP HAS A NULL EXPIRATION DATE, A ROUTINE   @G24LB26*/ 02888000
*/*            IS CALLED TO CALCULATE A DEFAULT, WHICH IS    @G24LB26*/ 02889000
*/*            THEN USED TO MAKE THE COMPARISON. IF NO       @G24LB26*/ 02890000
*/*            EXPIRATION DATE WAS SPECIFIED ON THE DD, A    @G24LB26*/ 02891000
*/*            DEFAULT OF TODAYS DATE IS USED FOR THE DATA   @G24LB26*/ 02892000
*/*            SET EXPIRATION. IF THE DATA SET EXPIRED AFTER @G24LB26*/ 02893000
*/*            THE VOLUME, THE VOLUME IS INELIGIBLE FOR THIS @G24LB26*/ 02894000
*/*            REQUEST.                                      @G24LB26*/ 02895000
*/*                                                          @G24LB26*/ 02896000
*/* INPUT - THE VOLUME EXPIRATION DATE IN THE EXTENSION      @G24LB26*/ 02897000
*/*         RECORD, THE GROUP RECORD, THE INDEX VALUES INTO  @G24LB26*/ 02898000
*/*         THE EXTENSION SLOT AND THE BEST FIT TABLE, THE   @G24LB26*/ 02899000
*/*         VOLUME DEFAULT EXPIRATION DATE FOR THE GROUP IF  @G24LB26*/ 02900000
*/*         CALCULATED BEFORE IN THE INTERNAL WORK AREA,     @G24LB26*/ 02901000
*/*         TODAYS DATE IN THE CVT, AND THE DATA SET         @G24LB26*/ 02902000
*/*         EXPIRATION DATE IN THE JFCB.                     @G24LB26*/ 02903000
*/*                                                          @G24LB26*/ 02904000
*/* OUTPUT - THE VOLUME EXPIRATION DATE IN THE BEST FIT      @G24LB26*/ 02905000
*/*          TABLE IF THE VOLUME IS ELIGIBLE, PLUS A ZERO    @G24LB26*/ 02906000
*/*          INTERNAL RETURN CODE. A FOUR INTERNAL RETURN    @G24LB26*/ 02907000
*/*          CODE IF THE VOLUME IS NOT ELIGIBLE.             @G24LB26*/ 02908000
*/*                                                          @G24LB26*/ 02909000
*/*********************************************************  @G24LB26*/ 02910000
*                                                                  0787 02911000
*EXPIRCK:                                                          0787 02912000
*   PROC OPTIONS(SAVE(REG14));      /*                       @G24LB26*/ 02913000
*                                                                  0787 02914000
EXPIRCK  ST    @14,@SA00006                                        0787 02915000
*   /*****************************************************************/ 02916000
*   /*                                                               */ 02917000
*   /* DETERMINE IF VOLUME IS IN A RETENTION GROUP. IF NOT,  @G24LB26*/ 02918000
*   /* SET NULL EXPIRATION DATE IN THE BEST FIT TABLE AND    @G24LB26*/ 02919000
*   /* EXIT PROGRAM.                                         @G24LB26*/ 02920000
*   /*                                                               */ 02921000
*   /*****************************************************************/ 02922000
*                                                                  0788 02923000
*   IF GRORETN=OFF THEN             /*                       @G24LB26*/ 02924000
         L     @04,GROUPPTR                                        0788 02925000
         TM    GRORETN(@04),B'00000100'                            0788 02926000
         BNZ   @RF00788                                            0788 02927000
*     BFVOLEXP(INDXBFTB)=NULEXPDT;  /*                       @G24LB26*/ 02928000
         LR    @04,INDXBFTB                                        0789 02929000
         MH    @04,@CH02240                                        0789 02930000
         L     @01,BFTBLPTR                                        0789 02931000
         ALR   @01,@04                                             0789 02932000
         MVC   BFVOLEXP-18(4,@01),NULEXPDT                         0789 02933000
*   ELSE                            /*                       @G24LB26*/ 02934000
*     DO;                           /*                       @G24LB26*/ 02935000
*                                                                  0790 02936000
         B     @RC00788                                            0790 02937000
@RF00788 DS    0H                                                  0791 02938000
*       /*************************************************************/ 02939000
*       /*                                                           */ 02940000
*       /* CALCULATE ANY EXPIRATION DATES NECESSARY AND MAKE @G24LB26*/ 02941000
*       /* THEIR FORMAT COMPATABLE.                          @G24LB26*/ 02942000
*       /*                                                           */ 02943000
*       /*************************************************************/ 02944000
*                                                                  0791 02945000
*       IF EXPIRDT=ZEROEXP&         /*                       @G24LB26*/ 02946000
*           GVSEXPDT(INDXEXTS)=NULEXPDT THEN/*               @G24LB26*/ 02947000
*                                                                  0791 02948000
         CLC   EXPIRDT(4),ZEROEXP                                  0791 02949000
         BNE   @RF00791                                            0791 02950000
         LR    @04,INDXEXTS                                        0791 02951000
         MH    @04,@CH01851                                        0791 02952000
         L     @01,GVSNEPTR                                        0791 02953000
         ALR   @01,@04                                             0791 02954000
         CLC   GVSEXPDT-20(4,@01),NULEXPDT                         0791 02955000
         BNE   @RF00791                                            0791 02956000
*         /***********************************************************/ 02957000
*         /*                                                         */ 02958000
*         /* SINCE THE VOLUME EXPIRATION DATE FOR THE        @G24LB26*/ 02959000
*         /* GROUP HAS NOT YET BEEN CALCULATED AND THE       @G24LB26*/ 02960000
*         /* EXTENSION CONTAINS A NULL DATE FOR THIS VOLUME, @G24LB26*/ 02961000
*         /* CALL ROUTINE TO CALCULATE THE DEFAULT DATE.     @G24LB26*/ 02962000
*         /*                                                         */ 02963000
*         /***********************************************************/ 02964000
*                                                                  0792 02965000
*         CALL DATES;               /*                       @G24LB26*/ 02966000
*                                                                  0792 02967000
         BAL   @14,DATES                                           0792 02968000
*       /*************************************************************/ 02969000
*       /*                                                           */ 02970000
*       /* PUT EXPIRATION DATE FROM JFCB IN COMPATABLE       @G24LB26*/ 02971000
*       /* FORMAT IF IT IS NOT ZERO. OTHERWISE SET DEFAULT   @G24LB26*/ 02972000
*       /* FROM CVT.                                         @G24LB26*/ 02973000
*       /*                                                           */ 02974000
*       /*************************************************************/ 02975000
*                                                                  0793 02976000
*       IF JFCBDATE=ZERO THEN       /*                       @G24LB26*/ 02977000
@RF00791 L     @04,JFCBPTR(,SELTMPTR)                              0793 02978000
         ICM   @15,7,JFCBDATE(@04)                                 0793 02979000
         BNZ   @RF00793                                            0793 02980000
*         DO;                       /*                       @G24LB26*/ 02981000
*                                                                  0794 02982000
*           /*********************************************************/ 02983000
*           /*                                                       */ 02984000
*           /* MAKE CVT DATE COMPATABLE WITH MSVI EXPIRATION @G24LB26*/ 02985000
*           /* DATES                                         @G24LB26*/ 02986000
*           /*                                                       */ 02987000
*           /*********************************************************/ 02988000
*                                                                  0795 02989000
*           EXPCVT=CVTDATE;         /* TODAYS DATE IN PACKED @G24LB26   02990000
*                                      DECIMAL               @G24LB26*/ 02991000
         L     @04,CVTPTR                                          0795 02992000
         MVC   EXPCVT(4),CVTDATE(@04)                              0795 02993000
*           EXPCVT=EXPCVT&ANCVTEXP; /* CHANGE SIGN FROM F    @G24LB26   02994000
*                                      TO C                  @G24LB26*/ 02995000
         NC    EXPCVT(4),ANCVTEXP                                  0796 02996000
*         END;                      /*                       @G24LB26*/ 02997000
*       ELSE                        /*                       @G24LB26*/ 02998000
*                                                                  0798 02999000
*         /***********************************************************/ 03000000
*         /*                                                         */ 03001000
*         /* IF JFCB DATE IS NOT ZERO, MAKE IT COMPATABLE    @G24LB26*/ 03002000
*         /* WITH MSVI DATES.                                @G24LB26*/ 03003000
*         /*                                                         */ 03004000
*         /***********************************************************/ 03005000
*                                                                  0798 03006000
*         DO;                       /*                       @G24LB26*/ 03007000
         B     @RC00793                                            0798 03008000
@RF00793 DS    0H                                                  0799 03009000
*           RESPECIFY                                              0799 03010000
*             REG15 RSTD;           /*                       @G24LB26*/ 03011000
*           CVD(JFCBYFX,EXPYR);     /* CONVERT YEAR TO DEC   @G24LB26*/ 03012000
         L     @14,JFCBPTR(,SELTMPTR)                              0800 03013000
         SLR   @04,@04                                             0800 03014000
         IC    @04,JFCBYFX(,@14)                                   0800 03015000
         CVD   @04,@TS00001                                        0800 03016000
         MVC   EXPYR(2),@TS00001+6                                 0800 03017000
*           GENERATE REFS(EXPYR,REG15) SETS(EXPYR,REG15);          0801 03018000
*                                                         /*@G24LB26*/  03019000
           LH REG15,EXPYR          LOAD YEAR                  @G24LB26  03020000
           SRL REG15,4(0)          SHIFT SIGN OUT             @G24LB26  03021000
           STH REG15,EXPYR         STORE BACK                 @G24LB26  03022000
*           CVD(JFCBDFX,EXPDAY);    /* CONVERT DAYS TO DEC   @G24LB26*/ 03023000
         L     @14,JFCBPTR(,SELTMPTR)                              0802 03024000
         LH    @14,JFCBDFX(,@14)                                   0802 03025000
         CVD   @14,@TS00001                                        0802 03026000
         MVC   EXPDAY(2),@TS00001+6                                0802 03027000
*           RESPECIFY                                              0803 03028000
*             REG15 UNRSTD;         /*                       @G24LB26*/ 03029000
*         END;                      /*                       @G24LB26*/ 03030000
*                                                                  0804 03031000
*       /*************************************************************/ 03032000
*       /*                                                           */ 03033000
*       /* DETERMINE IF VOLUME EXPIRES TO SOON FOR THIS      @G24LB26*/ 03034000
*       /* REQUEST.                                          @G24LB26*/ 03035000
*       /*                                                           */ 03036000
*       /*************************************************************/ 03037000
*                                                                  0805 03038000
*       IF GVSEXPDT(INDXEXTS)=NULEXPDT THEN/*                @G24LB26*/ 03039000
@RC00793 LR    @04,INDXEXTS                                        0805 03040000
         MH    @04,@CH01851                                        0805 03041000
         L     @01,GVSNEPTR                                        0805 03042000
         ALR   @01,@04                                             0805 03043000
         CLC   GVSEXPDT-20(4,@01),NULEXPDT                         0805 03044000
         BNE   @RF00805                                            0805 03045000
*         DO;                       /*                       @G24LB26*/ 03046000
*                                                                  0806 03047000
*           /*********************************************************/ 03048000
*           /*                                                       */ 03049000
*           /* NULL DATE IN EXTENSION RECORD, BOTH DEFAULTS  @G24LB26*/ 03050000
*           /* ARE TAKEN AND THE VOLUME MUST BE OK.          @G24LB26*/ 03051000
*           /*                                                       */ 03052000
*           /*********************************************************/ 03053000
*                                                                  0807 03054000
*           IF JFCBDATE=ZERO THEN   /*                       @G24LB26*/ 03055000
         L     @04,JFCBPTR(,SELTMPTR)                              0807 03056000
         ICM   @15,7,JFCBDATE(@04)                                 0807 03057000
         BNZ   @RF00807                                            0807 03058000
*             BFVOLEXP(INDXBFTB)=EXPIRDT;/* DEFAULT DATE IN  @G24LB26   03059000
*                                      BEST FIT              @G24LB26*/ 03060000
         LR    @04,INDXBFTB                                        0808 03061000
         MH    @04,@CH02240                                        0808 03062000
         L     @01,BFTBLPTR                                        0808 03063000
         ALR   @01,@04                                             0808 03064000
         MVC   BFVOLEXP-18(4,@01),EXPIRDT                          0808 03065000
*           ELSE                    /*                       @G24LB26*/ 03066000
*                                                                  0809 03067000
*             /*******************************************************/ 03068000
*             /*                                                     */ 03069000
*             /* DATE IN JFCB                                @G24LB26*/ 03070000
*             /*                                                     */ 03071000
*             /*******************************************************/ 03072000
*                                                                  0809 03073000
*             IF EXPIRDT<EXPJFCB THEN/* DEFAULT VOL EXPIRES  @G24LB26   03074000
*                                      BEFORE REQUESTED DATE @G24LB26*/ 03075000
         B     @RC00807                                            0809 03076000
@RF00807 CLC   EXPIRDT(4),EXPJFCB                                  0809 03077000
         BNL   @RF00809                                            0809 03078000
*               INTERCC=RCFOUR;     /*                       @G24LB26*/ 03079000
         MVC   INTERCC(2),@CB02113                                 0810 03080000
*             ELSE                  /*                       @G24LB26*/ 03081000
*               BFVOLEXP(INDXBFTB)=EXPIRDT;/* DEFAULT TO     @G24LB26   03082000
*                                      BEST FIT              @G24LB26*/ 03083000
         B     @RC00809                                            0811 03084000
@RF00809 LR    @04,INDXBFTB                                        0811 03085000
         MH    @04,@CH02240                                        0811 03086000
         L     @01,BFTBLPTR                                        0811 03087000
         ALR   @01,@04                                             0811 03088000
         MVC   BFVOLEXP-18(4,@01),EXPIRDT                          0811 03089000
*         END;                      /*                       @G24LB26*/ 03090000
*                                                                  0812 03091000
*       /*************************************************************/ 03092000
*       /*                                                           */ 03093000
*       /* EXPIRATION DATE IS NOT NULL IN EXTENSION RECORD   @G24LB26*/ 03094000
*       /*                                                           */ 03095000
*       /*************************************************************/ 03096000
*                                                                  0813 03097000
*       ELSE                        /*                       @G24LB26*/ 03098000
*         DO;                       /*                       @G24LB26*/ 03099000
*                                                                  0813 03100000
         B     @RC00805                                            0813 03101000
@RF00805 DS    0H                                                  0814 03102000
*           /*********************************************************/ 03103000
*           /*                                                       */ 03104000
*           /* IF NO DATE IN JFCB, USE DEFAULT.              @G24LB26*/ 03105000
*           /*                                                       */ 03106000
*           /*********************************************************/ 03107000
*                                                                  0814 03108000
*           IF JFCBDATE=ZERO THEN   /*                       @G24LB26*/ 03109000
         L     @04,JFCBPTR(,SELTMPTR)                              0814 03110000
         ICM   @15,7,JFCBDATE(@04)                                 0814 03111000
         BNZ   @RF00814                                            0814 03112000
*             IF GVSEXPDT(INDXEXTS)<EXPCVT THEN/* VOLUME     @G24LB26   03113000
*                                      ALREADY EXPIRED       @G24LB26*/ 03114000
         LR    @04,INDXEXTS                                        0815 03115000
         MH    @04,@CH01851                                        0815 03116000
         L     @01,GVSNEPTR                                        0815 03117000
         ALR   @01,@04                                             0815 03118000
         CLC   GVSEXPDT-20(4,@01),EXPCVT                           0815 03119000
         BNL   @RF00815                                            0815 03120000
*               INTERCC=RCFOUR;     /*                       @G24LB26*/ 03121000
         MVC   INTERCC(2),@CB02113                                 0816 03122000
*             ELSE                  /*                       @G24LB26*/ 03123000
*               BFVOLEXP(INDXBFTB)=GVSEXPDT(INDXEXTS);/*     @G24LB26   03124000
*                                      EXPIR DATE IN BEST FIT      0817 03125000
*                                                            @G24LB26*/ 03126000
         B     @RC00815                                            0817 03127000
@RF00815 LR    @04,INDXBFTB                                        0817 03128000
         MH    @04,@CH02240                                        0817 03129000
         L     @01,BFTBLPTR                                        0817 03130000
         ALR   @01,@04                                             0817 03131000
         LR    @04,INDXEXTS                                        0817 03132000
         MH    @04,@CH01851                                        0817 03133000
         L     @15,GVSNEPTR                                        0817 03134000
         ALR   @15,@04                                             0817 03135000
         MVC   BFVOLEXP-18(4,@01),GVSEXPDT-20(@15)                 0817 03136000
*           ELSE                    /*                       @G24LB26*/ 03137000
*                                                                  0818 03138000
*             /*******************************************************/ 03139000
*             /*                                                     */ 03140000
*             /* COMPARE EXTENSION AND JFCB DATES            @G24LB26*/ 03141000
*             /*                                                     */ 03142000
*             /*******************************************************/ 03143000
*                                                                  0818 03144000
*             IF GVSEXPDT(INDXEXTS)<EXPJFCB THEN/*           @G24LB26*/ 03145000
         B     @RC00814                                            0818 03146000
@RF00814 LR    @04,INDXEXTS                                        0818 03147000
         MH    @04,@CH01851                                        0818 03148000
         L     @01,GVSNEPTR                                        0818 03149000
         ALR   @01,@04                                             0818 03150000
         CLC   GVSEXPDT-20(4,@01),EXPJFCB                          0818 03151000
         BNL   @RF00818                                            0818 03152000
*               INTERCC=RCFOUR;     /*                       @G24LB26*/ 03153000
         MVC   INTERCC(2),@CB02113                                 0819 03154000
*             ELSE                  /*                       @G24LB26*/ 03155000
*               BFVOLEXP(INDXBFTB)=GVSEXPDT(INDXEXTS);/*     @G24LB26   03156000
*                                      EXPIR DATE IN BEST FIT      0820 03157000
*                                                            @G24LB26*/ 03158000
         B     @RC00818                                            0820 03159000
@RF00818 LR    @04,INDXBFTB                                        0820 03160000
         MH    @04,@CH02240                                        0820 03161000
         L     @01,BFTBLPTR                                        0820 03162000
         ALR   @01,@04                                             0820 03163000
         LR    @04,INDXEXTS                                        0820 03164000
         MH    @04,@CH01851                                        0820 03165000
         L     @15,GVSNEPTR                                        0820 03166000
         ALR   @15,@04                                             0820 03167000
         MVC   BFVOLEXP-18(4,@01),GVSEXPDT-20(@15)                 0820 03168000
*         END;                      /*                       @G24LB26*/ 03169000
*     END;                          /*                       @G24LB26*/ 03170000
*   RETURN;                         /*                       @G24LB26*/ 03171000
@EL00006 DS    0H                                                  0823 03172000
@EF00006 DS    0H                                                  0823 03173000
@ER00006 L     @14,@SA00006                                        0823 03174000
         BR    @14                                                 0823 03175000
*   END EXPIRCK;                    /*                       @G24LB26*/ 03176000
         B     @EL00006                                            0824 03177000
*                                                                  0825 03178000
*/*********************************************************  @G24LB26*/ 03179000
*/*                                                          @G24LB26*/ 03180000
*/* PROCEDURE NAME - DATES                                   @G24LB26*/ 03181000
*/*                                                          @G24LB26*/ 03182000
*/* FUNCTION - CALCULATES A JULIAN EXPIRATION DATE GIVEN THE @G24LB26*/ 03183000
*/*            RETENTION PERIOD FOR A GROUP.                 @G24LB26*/ 03184000
*/*                                                          @G24LB26*/ 03185000
*/* INPUT - CURRENT DATE FROM CVT, RETENTION PERIOD FROM     @G24LB26*/ 03186000
*/*         GROUP RECORD.                                    @G24LB26*/ 03187000
*/*                                                          @G24LB26*/ 03188000
*/* OUTPUT - JULIAN EXPIRATION DATE IN INTERNAL WORK AREA.   @G24LB26*/ 03189000
*/*                                                          @G24LB26*/ 03190000
*/*********************************************************  @G24LB26*/ 03191000
*                                                                  0825 03192000
*DATES:                                                            0825 03193000
*   PROC OPTIONS(SAVE(REG14));      /*                       @G24LB26*/ 03194000
DATES    ST    @14,12(,@13)                                        0825 03195000
*   RESPECIFY                                                      0826 03196000
*     REG1 RSTD;                    /*                       @G24LB26*/ 03197000
*                                                                  0826 03198000
*   /*****************************************************************/ 03199000
*   /*                                                               */ 03200000
*   /* CONVERT THE DATE FROM THE CVT TO BINARY.              @G24LB26*/ 03201000
*   /*                                                               */ 03202000
*   /*****************************************************************/ 03203000
*                                                                  0827 03204000
*   DBLWORD=DBLWORD&&DBLWORD;       /* CLEAR DOUBLE WORD     @G24LB26   03205000
*                                      WORK AREA             @G24LB26*/ 03206000
         XC    DBLWORD(8),DBLWORD                                  0827 03207000
*   DBLWORD(5:8)=CVTDATE;           /* PLACE PACKED DECIMAL  @G24LB26   03208000
*                                      DATE IN WORK AREA     @G24LB26*/ 03209000
         L     @04,CVTPTR                                          0828 03210000
         MVC   DBLWORD+4(4),CVTDATE(@04)                           0828 03211000
*   CVB(REG1,DBLWORD);              /* CONVERT DATE BINARY   @G24LB26*/ 03212000
         CVB   REG1,DBLWORD                                        0829 03213000
*   YEAR=REG1/DATSEP;               /* EXTRACT YEARS         @G24LB26*/ 03214000
         LA    @04,1000                                            0830 03215000
         LR    @14,REG1                                            0830 03216000
         SRDA  @14,32                                              0830 03217000
         DR    @14,@04                                             0830 03218000
         LR    YEAR,@15                                            0830 03219000
*   DAY=REG1//DATSEP;               /* EXTRACT DAYS          @G24LB26*/ 03220000
*                                                                  0831 03221000
         LR    @14,REG1                                            0831 03222000
         SRDA  @14,32                                              0831 03223000
         DR    @14,@04                                             0831 03224000
         LR    DAY,@14                                             0831 03225000
*   /*****************************************************************/ 03226000
*   /*                                                               */ 03227000
*   /* ADD THE RETENTION PERIOD FOR THE GROUP TO THE DAYS.   @G24LB26*/ 03228000
*   /*                                                               */ 03229000
*   /*****************************************************************/ 03230000
*                                                                  0832 03231000
*   DAY=DAY+GRORETPD;               /*                       @G24LB26*/ 03232000
         L     @04,GROUPPTR                                        0832 03233000
         AL    DAY,GRORETPD(,@04)                                  0832 03234000
*   DATEEXIT=OFF;                   /* SET OUTSIDE LOOP      @G24LB26   03235000
*                                      SWITCH                @G24LB26*/ 03236000
*                                                                  0833 03237000
         NI    DATEEXIT,B'11111011'                                0833 03238000
*   /*****************************************************************/ 03239000
*   /*                                                               */ 03240000
*   /* LOOP THRU CHANGING DAYS TO YEARS UNTIL DATE IN        @G24LB26*/ 03241000
*   /* PROPER FORMAT.                                        @G24LB26*/ 03242000
*   /*                                                               */ 03243000
*   /*****************************************************************/ 03244000
*                                                                  0834 03245000
*   DO WHILE DATEEXIT=OFF;          /*                       @G24LB26*/ 03246000
*                                                                  0834 03247000
         B     @DE00834                                            0834 03248000
@DL00834 DS    0H                                                  0835 03249000
*     /***************************************************************/ 03250000
*     /*                                                             */ 03251000
*     /* DETERMINE IF LEAP YEAR BY DIVIDING BY FOUR AND      @G24LB26*/ 03252000
*     /* CHECKING REMAINDER.                                 @G24LB26*/ 03253000
*     /*                                                             */ 03254000
*     /***************************************************************/ 03255000
*                                                                  0835 03256000
*     IF YEAR//FOUR=ZERO THEN       /*                       @G24LB26*/ 03257000
         LR    @14,YEAR                                            0835 03258000
         SRDA  @14,32                                              0835 03259000
         D     @14,@CF00064                                        0835 03260000
         LTR   @14,@14                                             0835 03261000
         BNZ   @RF00835                                            0835 03262000
*       DO;                         /*                       @G24LB26*/ 03263000
*                                                                  0836 03264000
*         /***********************************************************/ 03265000
*         /*                                                         */ 03266000
*         /* CHECK TO DETERMINE IF MORE THAN 366 DAYS AND    @G24LB26*/ 03267000
*         /* IF SO, ADD ONE YEAR AND SUBTRACT DAYS SINCE     @G24LB26*/ 03268000
*         /* A LEAP YEAR WAS ENCOUNTERED.                    @G24LB26*/ 03269000
*         /*                                                         */ 03270000
*         /***********************************************************/ 03271000
*                                                                  0837 03272000
*         IF DAY>DAYLEPYR THEN      /*                       @G24LB26*/ 03273000
*                                                                  0837 03274000
         LA    @04,366                                             0837 03275000
         CR    DAY,@04                                             0837 03276000
         BNH   @RF00837                                            0837 03277000
*           /*********************************************************/ 03278000
*           /*                                                       */ 03279000
*           /* SUBTRACT NUMBER OF DAYS IN A LEAP YEAR AND    @G24LB26*/ 03280000
*           /* ADD ONE TO YEAR. THEN LOOP BACK TO SEE IF     @G24LB26*/ 03281000
*           /* ANOTHER YEAR CAN BE ADDED.                    @G24LB26*/ 03282000
*           /*                                                       */ 03283000
*           /*********************************************************/ 03284000
*                                                                  0838 03285000
*           DO;                     /*                       @G24LB26*/ 03286000
*             DAY=DAY-DAYLEPYR;     /* SUBTRACT 366 DAYS     @G24LB26*/ 03287000
         SLR   DAY,@04                                             0839 03288000
*             YEAR=YEAR+ONE;        /* INCREMENT YEAR        @G24LB26*/ 03289000
         AL    YEAR,@CF00043                                       0840 03290000
*           END;                    /*                       @G24LB26*/ 03291000
*                                                                  0841 03292000
*         /***********************************************************/ 03293000
*         /*                                                         */ 03294000
*         /* IF DAYS LESS THAN DAYS IN YEAR THAN JOB         @G24LB26*/ 03295000
*         /* IS FINISHED.                                    @G24LB26*/ 03296000
*         /*                                                         */ 03297000
*         /***********************************************************/ 03298000
*                                                                  0842 03299000
*         ELSE                      /*                       @G24LB26*/ 03300000
*           DATEEXIT=ON;            /* GET OUT OF LOOP       @G24LB26*/ 03301000
         B     @RC00837                                            0842 03302000
@RF00837 OI    DATEEXIT,B'00000100'                                0842 03303000
*       END;                        /*                       @G24LB26*/ 03304000
*                                                                  0843 03305000
*     /***************************************************************/ 03306000
*     /*                                                             */ 03307000
*     /* SINCE FOUR DID NOT DIVIDE YEAR EVENLY, IT IS        @G24LB26*/ 03308000
*     /* NO A LEAP YEAR, SO PROCESS FOR NORMAL YEAR.         @G24LB26*/ 03309000
*     /*                                                             */ 03310000
*     /***************************************************************/ 03311000
*                                                                  0844 03312000
*     ELSE                          /*                       @G24LB26*/ 03313000
*       IF DAY>DAYNRMYR THEN        /*                       @G24LB26*/ 03314000
*                                                                  0844 03315000
         B     @RC00835                                            0844 03316000
@RF00835 LA    @04,365                                             0844 03317000
         CR    DAY,@04                                             0844 03318000
         BNH   @RF00844                                            0844 03319000
*         /***********************************************************/ 03320000
*         /*                                                         */ 03321000
*         /* IF THERE ARE MORE THAN 365 DAYS, SUBTRACT       @G24LB26*/ 03322000
*         /* 365 FROM DAYS AND ADD ONE TO YEAR. THEN GO      @G24LB26*/ 03323000
*         /* BACK AND SEE IF ANY MORE DAYS CAN BE            @G24LB26*/ 03324000
*         /* SUBTRACTED.                                     @G24LB26*/ 03325000
*         /*                                                         */ 03326000
*         /***********************************************************/ 03327000
*                                                                  0845 03328000
*         DO;                       /*                       @G24LB26*/ 03329000
*           DAY=DAY-DAYNRMYR;       /*                       @G24LB26*/ 03330000
         SLR   DAY,@04                                             0846 03331000
*           YEAR=YEAR+ONE;          /*                       @G24LB26*/ 03332000
         AL    YEAR,@CF00043                                       0847 03333000
*         END;                      /*                       @G24LB26*/ 03334000
*                                                                  0848 03335000
*     /***************************************************************/ 03336000
*     /*                                                             */ 03337000
*     /* IF LESS THAN 365 DAYS, THEN JOB IS FINISH           @G24LB26*/ 03338000
*     /* TO DROP OUT OF LOOP.                                @G24LB26*/ 03339000
*     /*                                                             */ 03340000
*     /***************************************************************/ 03341000
*                                                                  0849 03342000
*       ELSE                        /*                       @G24LB26*/ 03343000
*         DATEEXIT=ON;              /* GET OUT OF LOOP       @G24LB26*/ 03344000
         B     @RC00844                                            0849 03345000
@RF00844 OI    DATEEXIT,B'00000100'                                0849 03346000
*   END;                            /*                       @G24LB26*/ 03347000
*                                                                  0850 03348000
@RC00844 DS    0H                                                  0850 03349000
@RC00835 DS    0H                                                  0850 03350000
@DE00834 TM    DATEEXIT,B'00000100'                                0850 03351000
         BZ    @DL00834                                            0850 03352000
*   /*****************************************************************/ 03353000
*   /*                                                               */ 03354000
*   /* MULTIPLY YEARS BY 1000 SO THAT DAYS AND YEARS CAN     @G24LB26*/ 03355000
*   /* BE COMBINED TO BE CONVERTED TO PACKED DECIMAL         @G24LB26*/ 03356000
*   /* IN JULIAN FORMAT.                                     @G24LB26*/ 03357000
*   /*                                                               */ 03358000
*   /*****************************************************************/ 03359000
*                                                                  0851 03360000
*   REG1=YEAR*DATSEP;               /* MOVE YEAR TO PROPER   @G24LB26   03361000
*                                      LOCATION              @G24LB26*/ 03362000
         LR    REG1,YEAR                                           0851 03363000
         MH    REG1,@CH02014                                       0851 03364000
*   REG1=REG1+DAY;                  /* PUT DAYS INTO DATE    @G24LB26*/ 03365000
         ALR   REG1,DAY                                            0852 03366000
*   CVD(REG1,DBLWORD);              /* CONVERT TO DECIMAL    @G24LB26*/ 03367000
*                                                                  0853 03368000
         CVD   REG1,DBLWORD                                        0853 03369000
*   /*****************************************************************/ 03370000
*   /*                                                               */ 03371000
*   /* MOVE NEW DATE INTO INTERNAL WORK AREA.                @G24LB26*/ 03372000
*   /*                                                               */ 03373000
*   /*****************************************************************/ 03374000
*                                                                  0854 03375000
*   EXPIRDT=DBLWORD(5:8);           /*                       @G24LB26*/ 03376000
         MVC   EXPIRDT(4),DBLWORD+4                                0854 03377000
*   RESPECIFY                                                      0855 03378000
*     REG1 UNRSTD;                  /*                       @G24LB26*/ 03379000
*                                                                  0855 03380000
*   /*****************************************************************/ 03381000
*   /*                                                               */ 03382000
*   /* IF THE CALCULATED DATE IS GREATER THAN THE MAXIMUM    @G24LB26*/ 03383000
*   /* ALLOWED DATE, THEN SET IT TO THE MAXIMUM ALLOWED DATE @G24LB26*/ 03384000
*   /*                                                               */ 03385000
*   /*****************************************************************/ 03386000
*                                                                  0856 03387000
*   IF EXPIRDT>MAXDATE THEN         /*                       @G24LB26*/ 03388000
         CLC   EXPIRDT(4),MAXDATE                                  0856 03389000
         BNH   @RF00856                                            0856 03390000
*     EXPIRDT=MAXDATE;              /*                       @G24LB26*/ 03391000
         MVC   EXPIRDT(4),MAXDATE                                  0857 03392000
*   RETURN;                         /*                       @G24LB26*/ 03393000
@EL00007 DS    0H                                                  0858 03394000
@EF00007 DS    0H                                                  0858 03395000
@ER00007 L     @14,12(,@13)                                        0858 03396000
         BR    @14                                                 0858 03397000
*   END DATES;                      /*                       @G24LB26*/ 03398000
         B     @EL00007                                            0859 03399000
*                                                                  0860 03400000
*/*********************************************************  @G24LB26*/ 03401000
*/*                                                          @G24LB26*/ 03402000
*/* PROCEDURE NAME - SPACONV                                 @G24LB26*/ 03403000
*/*                                                          @G24LB26*/ 03404000
*/* FUNCTION - IF SPACE IS NOT SPECIFIED IN THE JFCB, THE    @G24LB26*/ 03405000
*/*            ROUTINE TAKES THE DEFAULT GROUP SPACE OUT     @G24LB26*/ 03406000
*/*            OF THE GROUP RECORD AND PUTS THIS INTO THE    @G24LB26*/ 03407000
*/*            INTERNAL WORK AREA AND INTO THE JFCB. IF      @G24LB26*/ 03408000
*/*            SPACE IS SPECIFIED IN THE JFCB, THE ROUTINE   @G24LB26*/ 03409000
*/*            CONVERTS IT TO CYLINDERS IF IT IS NOT         @G24LB26*/ 03410000
*/*            SPECIFIED IN CYLINDERS. IF MORE THAN ONE      @G24LB26*/ 03411000
*/*            VOLUME IS BEING SELECTED, IT ALSO CONVERTS    @G24LB26*/ 03412000
*/*            SECONDARY SPACE TO CYLINDERS IF IT IS NOT     @G24LB26*/ 03413000
*/*            ALREADY SPECIFIED IN CYLINDERS. THIS SPACE    @G24LB26*/ 03414000
*/*            IN CYLINDERS IS PLACED IN THE INTERNAL WORK   @G24LB26*/ 03415000
*/*            AREA TO BE USED IN LATER PROCESSING.          @G24LB26*/ 03416000
*/*                                                          @G24LB26*/ 03417000
*/* INPUT - THE NUMBER OF VOLUMES BEING SELECTED FOR THE     @G24LB26*/ 03418000
*/*         REQUEST. THIS VALUE WILL ALWAYS BE ONE IF        @G24LB26*/ 03419000
*/*         CONVERTING SPACE FOR A VOLREF REQUEST, THE       @G24LB26*/ 03420000
*/*         JFCB AND GROUP RECORD.                           @G24LB26*/ 03421000
*/*                                                          @G24LB26*/ 03422000
*/* OUTPUT - THE PRIMARY AND SECONDARY SPACE DEFAULT IN      @G24LB26*/ 03423000
*/*          THE JFCB AND INTERNAL WORK AREA IF NONE WAS     @G24LB26*/ 03424000
*/*          GIVEN IN THE JFCB. IF SPACE IS IN THE JFCB,     @G24LB26*/ 03425000
*/*          CONVERTED PRIMARY IS PLACED IN THE INTERNAL     @G24LB26*/ 03426000
*/*          WORK AREA. IF MORE THAN ONE VOLUME IS TO BE     @G24LB26*/ 03427000
*/*          SELECTED THE SECONDARY SPACE ALLOCATION IS      @G24LB26*/ 03428000
*/*          ALSO CONVERTED TO CYLINDERS AND PLACED IN THE   @G24LB26*/ 03429000
*/*          INTERNAL WORK AREA.                             @G24LB26*/ 03430000
*/*                                                          @G24LB26*/ 03431000
*/*********************************************************  @G24LB26*/ 03432000
*                                                                  0860 03433000
*SPACONV:                                                          0860 03434000
*   PROC OPTIONS(SAVE(REG14));      /*                       @G24LB26*/ 03435000
*                                                                  0860 03436000
SPACONV  ST    @14,12(,@13)                                        0860 03437000
*   /*****************************************************************/ 03438000
*   /*                                                               */ 03439000
*   /* DETERMINE IF SPACE WAS SPECIFIED IN THE JFCB AND      @G24LB26*/ 03440000
*   /* IF IT WAS NOT, PLACE THE DEFAULT SPACE FOR THE GROUP  @G24LB26*/ 03441000
*   /* IN THE JFCB AND INTERNAL WORK AREAS.                  @G24LB26*/ 03442000
*   /*                                                               */ 03443000
*   /*****************************************************************/ 03444000
*                                                                  0861 03445000
*   IF PQTY=ZERO&SQTY=ZERO&JFCBSPAC=NOSPACE&/*               @G24LB26*/ 03446000
*       JFCBABST=ZERO THEN          /*                       @G24LB26*/ 03447000
         L     @04,JFCBPTR(,SELTMPTR)                              0861 03448000
         ICM   @15,7,PQTY(@04)                                     0861 03449000
         BNZ   @RF00861                                            0861 03450000
         ICM   @15,7,SQTY(@04)                                     0861 03451000
         BNZ   @RF00861                                            0861 03452000
         TM    JFCBSPAC(@04),B'11000000'                           0861 03453000
         BNZ   @RF00861                                            0861 03454000
         LH    @15,JFCBABST(,@04)                                  0861 03455000
         LTR   @15,@15                                             0861 03456000
         BNZ   @RF00861                                            0861 03457000
*     DO;                           /*                       @G24LB26*/ 03458000
*       PQTY=GROPSPD;               /* PRIMARY SPACE IN CYL  @G24LB26*/ 03459000
         L     @15,GROUPPTR                                        0863 03460000
         LH    @14,GROPSPD(,@15)                                   0863 03461000
         STCM  @14,7,PQTY(@04)                                     0863 03462000
*       SQTY=GROSSPD;               /* SECONDARY SPACE IN CYL      0864 03463000
*                                                            @G24LB26*/ 03464000
         LH    @14,GROSSPD(,@15)                                   0864 03465000
         STCM  @14,7,SQTY(@04)                                     0864 03466000
*       JFCBSPAC=DBLON;             /* INDICATE SPACE IN CYL @G24LB26*/ 03467000
*                                                                  0865 03468000
         OI    JFCBSPAC(@04),B'11000000'                           0865 03469000
*       /*************************************************************/ 03470000
*       /*                                                           */ 03471000
*       /* CHECK IF GROUP DEFAULT IS FOR RELEASE OF UNUSED   @G24LB26*/ 03472000
*       /* SPACE. IF IT IS, SET INDICATOR IN JFCB.           @G24LB26*/ 03473000
*       /*                                                           */ 03474000
*       /*************************************************************/ 03475000
*                                                                  0866 03476000
*       IF GRORLSE=ON THEN          /*                       @G24LB26*/ 03477000
         TM    GRORLSE(@15),B'00001000'                            0866 03478000
         BNO   @RF00866                                            0866 03479000
*         JFCRLSE=DBLON;            /* RELEASE UNUSED SPACE  @G24LB26*/ 03480000
         OI    JFCRLSE(@04),B'11000000'                            0867 03481000
*       PRICYL=GROPSPD;             /* SET INTERNAL PRIMARY  @G24LB26*/ 03482000
@RF00866 L     @04,GROUPPTR                                        0868 03483000
         LH    @15,GROPSPD(,@04)                                   0868 03484000
         STH   @15,PRICYL                                          0868 03485000
*       SECCYL=GROSSPD;             /* SET INTERNAL SECONDARY      0869 03486000
*                                                            @G24LB26*/ 03487000
         LH    @04,GROSSPD(,@04)                                   0869 03488000
         STH   @04,SECCYL                                          0869 03489000
*     END;                          /*                       @G24LB26*/ 03490000
*                                                                  0870 03491000
*   /*****************************************************************/ 03492000
*   /*                                                               */ 03493000
*   /* SINCE SPACE WAS SPECIFIED IN THE JFCB, CONVERT IT     @G24LB26*/ 03494000
*   /* TO CYLINDERS IF NECESSARY.                            @G24LB26*/ 03495000
*   /*                                                               */ 03496000
*   /*****************************************************************/ 03497000
*                                                                  0871 03498000
*   ELSE                            /*                       @G24LB26*/ 03499000
*     DO;                           /*                       @G24LB26*/ 03500000
*                                                                  0871 03501000
         B     @RC00861                                            0871 03502000
@RF00861 DS    0H                                                  0872 03503000
*       /*************************************************************/ 03504000
*       /*                                                           */ 03505000
*       /* IF SPACE ALLOCATED IN CYLINDERS, THEN JUST COPY   @G24LB26*/ 03506000
*       /* IT TO INTERNAL PARAMETER AREA, NO CONVERSION      @G24LB26*/ 03507000
*       /* NECESSARY.                                        @G24LB26*/ 03508000
*       /*                                                           */ 03509000
*       /*************************************************************/ 03510000
*                                                                  0872 03511000
*       IF JFCBSPAC=DBLON THEN      /*                       @G24LB26*/ 03512000
         L     @04,JFCBPTR(,SELTMPTR)                              0872 03513000
         TM    JFCBSPAC(@04),B'11000000'                           0872 03514000
         BNO   @RF00872                                            0872 03515000
*         DO;                       /*                       @G24LB26*/ 03516000
*           PRICYL=PQTY;            /* PRIMARY IN CYL        @G24LB26*/ 03517000
*                                                                  0874 03518000
         MVC   PRICYL(2),PQTY+1(@04)                               0874 03519000
*           /*********************************************************/ 03520000
*           /*                                                       */ 03521000
*           /* IF MULTI-VOLUME REQUEST, SET SECONDARY SPACE  @G24LB26*/ 03522000
*           /* IN CYLINDERS.                                 @G24LB26*/ 03523000
*           /*                                                       */ 03524000
*           /*********************************************************/ 03525000
*                                                                  0875 03526000
*           IF NUMBVOL>ONE THEN     /*                       @G24LB26*/ 03527000
         CLI   NUMBVOL,1                                           0875 03528000
         BNH   @RF00875                                            0875 03529000
*             SECCYL=SQTY;          /*                       @G24LB26*/ 03530000
         MVC   SECCYL(2),SQTY+1(@04)                               0876 03531000
*         END;                      /*                       @G24LB26*/ 03532000
*       ELSE                        /*                       @G24LB26*/ 03533000
*                                                                  0878 03534000
*         /***********************************************************/ 03535000
*         /*                                                         */ 03536000
*         /* DETERMINE IF SPACE WAS ALLOCATED IN TRACKS AND  @G24LB26*/ 03537000
*         /* IF IT WAS, CONVERT IT TO CYLINDERS.             @G24LB26*/ 03538000
*         /*                                                         */ 03539000
*         /***********************************************************/ 03540000
*                                                                  0878 03541000
*         IF JFCBSPAC=TRKALLOC THEN /*                       @G24LB26*/ 03542000
         B     @RC00872                                            0878 03543000
@RF00872 L     @04,JFCBPTR(,SELTMPTR)                              0878 03544000
         TM    JFCBSPAC(@04),B'10000000'                           0878 03545000
         BNO   @RF00878                                            0878 03546000
         TM    JFCBSPAC(@04),B'01000000'                           0878 03547000
         BNZ   @RF00878                                            0878 03548000
*           DO;                     /*                       @G24LB26*/ 03549000
*                                                                  0879 03550000
*             /*******************************************************/ 03551000
*             /*                                                     */ 03552000
*             /* IF TRACKS ARE NOT AN EVEN MULTIPLE OF       @G24LB26*/ 03553000
*             /* CYLINDERS, ROUND CYLINDERS UP ONE.          @G24LB26*/ 03554000
*             /*                                                     */ 03555000
*             /*******************************************************/ 03556000
*                                                                  0880 03557000
*             IF PQTY//TRKCYL>ZERO THEN/*                    @G24LB26*/ 03558000
         SLR   @00,@00                                             0880 03559000
         ICM   @00,7,PQTY(@04)                                     0880 03560000
         SRDA  @00,32                                              0880 03561000
         D     @00,@CF02038                                        0880 03562000
         LTR   @00,@00                                             0880 03563000
         BNP   @RF00880                                            0880 03564000
*               ROUND=ONE;          /* ROUND UP ONE CYL      @G24LB26*/ 03565000
         LA    ROUND,1                                             0881 03566000
*             ELSE                  /*                       @G24LB26*/ 03567000
*               ROUND=ZERO;         /* NO ROUND UP REQUIRED  @G24LB26*/ 03568000
*                                                                  0882 03569000
         B     @RC00880                                            0882 03570000
@RF00880 SLR   ROUND,ROUND                                         0882 03571000
*             /*******************************************************/ 03572000
*             /*                                                     */ 03573000
*             /* CALCULATE PRIMARY SPACE IN CYLINDERS        @G24LB26*/ 03574000
*             /*                                                     */ 03575000
*             /*******************************************************/ 03576000
*                                                                  0883 03577000
*             PRICYL=(PQTY/TRKCYL)+ROUND;/*                  @G24LB26*/ 03578000
*                                                                  0883 03579000
@RC00880 LA    @04,19                                              0883 03580000
         L     @03,JFCBPTR(,SELTMPTR)                              0883 03581000
         SLR   @01,@01                                             0883 03582000
         ICM   @01,7,PQTY(@03)                                     0883 03583000
         SLR   @00,@00                                             0883 03584000
         DR    @00,@04                                             0883 03585000
         ALR   @01,ROUND                                           0883 03586000
         STH   @01,PRICYL                                          0883 03587000
*             /*******************************************************/ 03588000
*             /*                                                     */ 03589000
*             /* CALCULATE SECONDARY SPACE ONLY IF THIS IS   @G24LB26*/ 03590000
*             /* A MULTI-VOLUME DATA SET REQUEST.            @G24LB26*/ 03591000
*             /*                                                     */ 03592000
*             /*******************************************************/ 03593000
*                                                                  0884 03594000
*             IF NUMBVOL>ONE THEN   /*                       @G24LB26*/ 03595000
         CLI   NUMBVOL,1                                           0884 03596000
         BNH   @RF00884                                            0884 03597000
*               DO;                 /*                       @G24LB26*/ 03598000
*                                                                  0885 03599000
*                 /***************************************************/ 03600000
*                 /*                                                 */ 03601000
*                 /* CALCULATE SECONDARY SPACE IN CYLINDERS. @G24LB26*/ 03602000
*                 /* FIRST DETERMINE ROUND OFF FACTOR.       @G24LB26*/ 03603000
*                 /*                                                 */ 03604000
*                 /***************************************************/ 03605000
*                                                                  0886 03606000
*                 IF SQTY//TRKCYL>ZERO THEN/*                @G24LB26*/ 03607000
         SLR   @00,@00                                             0886 03608000
         ICM   @00,7,SQTY(@03)                                     0886 03609000
         SRDA  @00,32                                              0886 03610000
         DR    @00,@04                                             0886 03611000
         LTR   @00,@00                                             0886 03612000
         BNP   @RF00886                                            0886 03613000
*                   ROUND=ONE;      /* ROUND UP ONE CYL      @G24LB26*/ 03614000
         LA    ROUND,1                                             0887 03615000
*                 ELSE              /*                       @G24LB26*/ 03616000
*                   ROUND=ZERO;     /* NO ROUND UP REQUIRED  @G24LB26*/ 03617000
*                                                                  0888 03618000
         B     @RC00886                                            0888 03619000
@RF00886 SLR   ROUND,ROUND                                         0888 03620000
*                 /***************************************************/ 03621000
*                 /*                                                 */ 03622000
*                 /* CALCULATE SECONDARY SPACE               @G24LB26*/ 03623000
*                 /*                                                 */ 03624000
*                 /***************************************************/ 03625000
*                                                                  0889 03626000
*                 SECCYL=(SQTY/TRKCYL)+ROUND;/*              @G24LB26*/ 03627000
@RC00886 L     @04,JFCBPTR(,SELTMPTR)                              0889 03628000
         SLR   @01,@01                                             0889 03629000
         ICM   @01,7,SQTY(@04)                                     0889 03630000
         SLR   @00,@00                                             0889 03631000
         D     @00,@CF02038                                        0889 03632000
         ALR   @01,ROUND                                           0889 03633000
         STH   @01,SECCYL                                          0889 03634000
*               END;                /*                       @G24LB26*/ 03635000
*           END;                    /*                       @G24LB26*/ 03636000
*                                                                  0891 03637000
*       /*************************************************************/ 03638000
*       /*                                                           */ 03639000
*       /* IF SPACE NOT IN CYLINDERS OR TRACKS, IT MUST      @G24LB26*/ 03640000
*       /* BE IN BLOCKS.                                     @G24LB26*/ 03641000
*       /*                                                           */ 03642000
*       /*************************************************************/ 03643000
*                                                                  0892 03644000
*         ELSE                      /*                       @G24LB26*/ 03645000
*                                                                  0892 03646000
*           /*********************************************************/ 03647000
*           /*                                                       */ 03648000
*           /* CALCULATE SPACE IN CYLINDERS FROM BLOCKS      @G24LB26*/ 03649000
*           /*                                                       */ 03650000
*           /*********************************************************/ 03651000
*                                                                  0892 03652000
*           DO;                     /*                       @G24LB26*/ 03653000
*                                                                  0892 03654000
         B     @RC00878                                            0892 03655000
@RF00878 DS    0H                                                  0893 03656000
*             /*******************************************************/ 03657000
*             /*                                                     */ 03658000
*             /* CALCULATE RECORD LENGTH FOR CONVERTING      @G24LB26*/ 03659000
*             /* TO CYLINDERS.                               @G24LB26*/ 03660000
*             /*                                                     */ 03661000
*             /*******************************************************/ 03662000
*                                                                  0893 03663000
*             IF KEYLEN>ZERO THEN   /* DOES REC HAVE A KEY?  @G24LB26*/ 03664000
         L     @04,JFCBPTR(,SELTMPTR)                              0893 03665000
         CLI   KEYLEN(@04),0                                       0893 03666000
         BNH   @RF00893                                            0893 03667000
*               RECLEN=CON191+KEYLEN+DRLH;/* AVERAGE REC     @G24LB26   03668000
*                                      LENGTH WITH KEY       @G24LB26*/ 03669000
         L     @15,JFCBPTR(,SELTMPTR)                              0894 03670000
         LA    RECLEN,191                                          0894 03671000
         SLR   @14,@14                                             0894 03672000
         IC    @14,KEYLEN(,@15)                                    0894 03673000
         ALR   RECLEN,@14                                          0894 03674000
         SLR   @14,@14                                             0894 03675000
         ICM   @14,7,DRLH(@15)                                     0894 03676000
         ALR   RECLEN,@14                                          0894 03677000
*             ELSE                  /*                       @G24LB26*/ 03678000
*               RECLEN=CON135+DRLH; /* AVERAGE REC LENGTH    @G24LB26   03679000
*                                      WITHOUT KEY           @G24LB26*/ 03680000
*                                                                  0895 03681000
         B     @RC00893                                            0895 03682000
@RF00893 L     @01,JFCBPTR(,SELTMPTR)                              0895 03683000
         LA    RECLEN,135                                          0895 03684000
         SLR   @00,@00                                             0895 03685000
         ICM   @00,7,DRLH(@01)                                     0895 03686000
         ALR   RECLEN,@00                                          0895 03687000
*             /*******************************************************/ 03688000
*             /*                                                     */ 03689000
*             /* DETERMINE IF TRACK OVERFLOW EXISTS BY       @G24LB26*/ 03690000
*             /* FLAG AND NUMBER OF RECORDS THAT CAN FIT     @G24LB26*/ 03691000
*             /* ON ONE TRACK.                               @G24LB26*/ 03692000
*             /* THE ASSUMPTION IS BEING MADE IN THIS        @G24LB26*/ 03693000
*             /* ALGORYTHM, THAT WHEN A TRACK OVERFLOW       @G24LB26*/ 03694000
*             /* SITUATION EXISTS, AN OVERFLOW WILL OCCUR    @G24LB26*/ 03695000
*             /* FOR EACH TRACK EXCEPT WHERE THE RECORD      @G24LB26*/ 03696000
*             /* LENGTH IS EXACTLY 13030 BYTES, NOT          @G24LB26*/ 03697000
*             /* INCLUDING RECORD OVERHEAD.                  @G24LB26*/ 03698000
*             /*                                                     */ 03699000
*             /*******************************************************/ 03700000
*                                                                  0896 03701000
*             RECORDS=TRKCAPTY/RECLEN;/*                     @G24LB26*/ 03702000
@RC00893 L     @00,@CF02042                                        0896 03703000
         SRDA  @00,32                                              0896 03704000
         DR    @00,RECLEN                                          0896 03705000
         LR    RECORDS,@01                                         0896 03706000
*             IF JFCRFO=ON|RECORDS=ZERO THEN/* TRACK         @G24LB26   03707000
*                                      OVERFLOW?             @G24LB26*/ 03708000
         L     @02,JFCBPTR(,SELTMPTR)                              0897 03709000
         TM    JFCRFO(@02),B'00100000'                             0897 03710000
         BO    @RT00897                                            0897 03711000
         LTR   RECORDS,RECORDS                                     0897 03712000
         BNZ   @RF00897                                            0897 03713000
@RT00897 DS    0H                                                  0898 03714000
*               DO;                 /*                       @G24LB26*/ 03715000
*                                                                  0898 03716000
*                 /***************************************************/ 03717000
*                 /*                                                 */ 03718000
*                 /* CALCULATE THE NUMBER OF PRIMARY BYTES   @G24LB26*/ 03719000
*                 /* TO BE ALLOCATED WITH TRACK OVERFLOW     @G24LB26*/ 03720000
*                 /*                                                 */ 03721000
*                 /***************************************************/ 03722000
*                                                                  0899 03723000
*                 PRIBYTES=RECLEN*PQTY;/*                    @G24LB26*/ 03724000
*                                                                  0899 03725000
         L     @01,JFCBPTR(,SELTMPTR)                              0899 03726000
         SLR   PRIBYTES,PRIBYTES                                   0899 03727000
         ICM   PRIBYTES,7,PQTY(@01)                                0899 03728000
         MR    @02,RECLEN                                          0899 03729000
*                 /***************************************************/ 03730000
*                 /*                                                 */ 03731000
*                 /* DETERMINE ROUND OFF FOR SPACE TO TRACKS @G24LB26*/ 03732000
*                 /*                                                 */ 03733000
*                 /***************************************************/ 03734000
*                                                                  0900 03735000
*                 IF RECLEN=TRKCAPTY THEN/*                  @G24LB26*/ 03736000
         C     RECLEN,@CF02042                                     0900 03737000
         BNE   @RF00900                                            0900 03738000
*                   ROUND=ZERO;     /*                       @G24LB26*/ 03739000
         SLR   ROUND,ROUND                                         0901 03740000
*                 ELSE              /*                       @G24LB26*/ 03741000
*                                                                  0902 03742000
*                   /*************************************************/ 03743000
*                   /*                                               */ 03744000
*                   /* TRACK OVERFLOW EXISTS, SO USE THE     @G24LB26*/ 03745000
*                   /* OVERFLOW TRACK CAPACITY TO DETERMINE  @G24LB26*/ 03746000
*                   /* ROUNDING FACTOR                       @G24LB26*/ 03747000
*                   /*                                               */ 03748000
*                   /*************************************************/ 03749000
*                                                                  0902 03750000
*                   IF PRIBYTES//TRKOFCAP>ZERO THEN/*        @G24LB26*/ 03751000
         B     @RC00900                                            0902 03752000
@RF00900 LR    @00,PRIBYTES                                        0902 03753000
         SRDA  @00,32                                              0902 03754000
         D     @00,@CF02040                                        0902 03755000
         LTR   @00,@00                                             0902 03756000
         BNP   @RF00902                                            0902 03757000
*                     ROUND=ONE;    /*                       @G24LB26*/ 03758000
         LA    ROUND,1                                             0903 03759000
*                   ELSE            /*                       @G24LB26*/ 03760000
*                     ROUND=ZERO;   /*                       @G24LB26*/ 03761000
*                                                                  0904 03762000
         B     @RC00902                                            0904 03763000
@RF00902 SLR   ROUND,ROUND                                         0904 03764000
*                 /***************************************************/ 03765000
*                 /*                                                 */ 03766000
*                 /* CALCULATE THE NUMBER OF PRIMARY TRACKS  @G24LB26*/ 03767000
*                 /* NO OVERFLOW WILL REALLY OCCURE          @G24LB26*/ 03768000
*                 /*                                                 */ 03769000
*                 /***************************************************/ 03770000
*                                                                  0905 03771000
*                 IF RECLEN=TRKCAPTY THEN/*                  @G24LB26*/ 03772000
@RC00902 DS    0H                                                  0905 03773000
@RC00900 L     @15,@CF02042                                        0905 03774000
         CR    RECLEN,@15                                          0905 03775000
         BNE   @RF00905                                            0905 03776000
*                   PRICYL=(PRIBYTES/TRKCAPTY)+ROUND;/*      @G24LB26*/ 03777000
*                                                                  0906 03778000
         LR    @00,PRIBYTES                                        0906 03779000
         SRDA  @00,32                                              0906 03780000
         DR    @00,@15                                             0906 03781000
         ALR   @01,ROUND                                           0906 03782000
         STH   @01,PRICYL                                          0906 03783000
*                 /***************************************************/ 03784000
*                 /*                                                 */ 03785000
*                 /* OVERFLOW WILL REALLY TAKE PLACE         @G24LB26*/ 03786000
*                 /*                                                 */ 03787000
*                 /***************************************************/ 03788000
*                                                                  0907 03789000
*                 ELSE              /*                       @G24LB26*/ 03790000
*                   PRICYL=(PRIBYTES/TRKOFCAP)+ROUND;/*      @G24LB26*/ 03791000
*                                                                  0907 03792000
         B     @RC00905                                            0907 03793000
@RF00905 LR    @00,PRIBYTES                                        0907 03794000
         SRDA  @00,32                                              0907 03795000
         D     @00,@CF02040                                        0907 03796000
         ALR   @01,ROUND                                           0907 03797000
         STH   @01,PRICYL                                          0907 03798000
*                 /***************************************************/ 03799000
*                 /*                                                 */ 03800000
*                 /* DETERMINE ROUND OFF FACTOR FROM TRACKS  @G24LB26*/ 03801000
*                 /* TO CYLINDERS                            @G24LB26*/ 03802000
*                 /*                                                 */ 03803000
*                 /***************************************************/ 03804000
*                                                                  0908 03805000
*                 IF PRICYL//TRKCYL>ZERO THEN/*              @G24LB26*/ 03806000
@RC00905 LH    @00,PRICYL                                          0908 03807000
         SRDA  @00,32                                              0908 03808000
         D     @00,@CF02038                                        0908 03809000
         LTR   @00,@00                                             0908 03810000
         BNP   @RF00908                                            0908 03811000
*                   ROUND=ONE;      /* ROUND UP NECESSARY    @G24LB26*/ 03812000
         LA    ROUND,1                                             0909 03813000
*                 ELSE              /*                       @G24LB26*/ 03814000
*                   ROUND=ZERO;     /* NO ROUND UP NECESSARY @G24LB26*/ 03815000
*                                                                  0910 03816000
         B     @RC00908                                            0910 03817000
@RF00908 SLR   ROUND,ROUND                                         0910 03818000
*                 /***************************************************/ 03819000
*                 /*                                                 */ 03820000
*                 /* CALCULATE PRIMARY SPACE IN CYLINDERS    @G24LB26*/ 03821000
*                 /*                                                 */ 03822000
*                 /***************************************************/ 03823000
*                                                                  0911 03824000
*                 PRICYL=(PRICYL/TRKCYL)+ROUND;/*            @G24LB26*/ 03825000
*                                                                  0911 03826000
@RC00908 LH    @00,PRICYL                                          0911 03827000
         SRDA  @00,32                                              0911 03828000
         D     @00,@CF02038                                        0911 03829000
         ALR   @01,ROUND                                           0911 03830000
         STH   @01,PRICYL                                          0911 03831000
*                 /***************************************************/ 03832000
*                 /*                                                 */ 03833000
*                 /* CHECK TO DETERMINE IF SECONDARY SPACE   @G24LB26*/ 03834000
*                 /* NEEDS CALCULATING FOR REQUEST WITH      @G24LB26*/ 03835000
*                 /* TRACK OVERFLOW.                         @G24LB26*/ 03836000
*                 /*                                                 */ 03837000
*                 /***************************************************/ 03838000
*                                                                  0912 03839000
*                 IF NUMBVOL>ONE THEN/*                      @G24LB26*/ 03840000
         CLI   NUMBVOL,1                                           0912 03841000
         BNH   @RF00912                                            0912 03842000
*                   DO;             /*                       @G24LB26*/ 03843000
*                                                                  0913 03844000
*                     /***********************************************/ 03845000
*                     /*                                             */ 03846000
*                     /* CALCULATE THE NUMBER OF SECONDARY   @G24LB26*/ 03847000
*                     /* BYTES TO BE ALLOCATED.              @G24LB26*/ 03848000
*                     /*                                             */ 03849000
*                     /***********************************************/ 03850000
*                                                                  0914 03851000
*                     SECBYTES=RECLEN*SQTY;/*                @G24LB26*/ 03852000
*                                                                  0914 03853000
         L     @01,JFCBPTR(,SELTMPTR)                              0914 03854000
         SLR   SECBYTES,SECBYTES                                   0914 03855000
         ICM   SECBYTES,7,SQTY(@01)                                0914 03856000
         MR    @02,RECLEN                                          0914 03857000
*                     /***********************************************/ 03858000
*                     /*                                             */ 03859000
*                     /* DETERMINE SECONDARY ROUND OFF FOR   @G24LB26*/ 03860000
*                     /* SPACE TO TRACKS.                    @G24LB26*/ 03861000
*                     /* THE ASSUMPTION IS BEING MADE IN     @G24LB26*/ 03862000
*                     /* THIS ALGORYTHM, THAT WHEN A TRACK   @G24LB26*/ 03863000
*                     /* OVERFLOW SITUATION EXISTS, AN       @G24LB26*/ 03864000
*                     /* OVERFLOW WILL OCCUR FOR EACH TRACK  @G24LB26*/ 03865000
*                     /* EXCEPT WHERE THE RECORD LENGTH IS   @G24LB26*/ 03866000
*                     /* EXACTLY 13030 BYTES, NOT INCLUDING  @G24LB26*/ 03867000
*                     /* RECORD OVERHEAD.                    @G24LB26*/ 03868000
*                     /* DETERMINE IF REALLY OVERFLOW        @G24LB26*/ 03869000
*                     /*                                             */ 03870000
*                     /***********************************************/ 03871000
*                                                                  0915 03872000
*                     IF RECLEN=TRKCAPTY THEN/*              @G24LB26*/ 03873000
         C     RECLEN,@CF02042                                     0915 03874000
         BNE   @RF00915                                            0915 03875000
*                       ROUND=ZERO; /* NO ROUND UP NECESSARY @G24LB26*/ 03876000
*                                                                  0916 03877000
         SLR   ROUND,ROUND                                         0916 03878000
*                     /***********************************************/ 03879000
*                     /*                                             */ 03880000
*                     /* TRACK OVERFLOW REALLY OCCURES       @G24LB26*/ 03881000
*                     /*                                             */ 03882000
*                     /***********************************************/ 03883000
*                                                                  0917 03884000
*                     ELSE          /*                       @G24LB26*/ 03885000
*                       IF SECBYTES//TRKOFCAP>ZERO THEN/*    @G24LB26*/ 03886000
         B     @RC00915                                            0917 03887000
@RF00915 LR    @00,SECBYTES                                        0917 03888000
         SRDA  @00,32                                              0917 03889000
         D     @00,@CF02040                                        0917 03890000
         LTR   @00,@00                                             0917 03891000
         BNP   @RF00917                                            0917 03892000
*                         ROUND=ONE;/* ROUND UP ONE TRACK    @G24LB26*/ 03893000
         LA    ROUND,1                                             0918 03894000
*                       ELSE        /*                       @G24LB26*/ 03895000
*                         ROUND=ZERO;/* NO ROUND UP          @G24LB26*/ 03896000
*                                                                  0919 03897000
         B     @RC00917                                            0919 03898000
@RF00917 SLR   ROUND,ROUND                                         0919 03899000
*                     /***********************************************/ 03900000
*                     /*                                             */ 03901000
*                     /* CALCULATE NUMBER OF SECONDARY       @G24LB26*/ 03902000
*                     /* TRACKS WHEN                         @G24LB26*/ 03903000
*                     /* OVERFLOW DOES NOT REALLY OCCURE     @G24LB26*/ 03904000
*                     /*                                             */ 03905000
*                     /***********************************************/ 03906000
*                                                                  0920 03907000
*                     IF RECLEN=TRKCAPTY THEN/*              @G24LB26*/ 03908000
@RC00917 DS    0H                                                  0920 03909000
@RC00915 L     @15,@CF02042                                        0920 03910000
         CR    RECLEN,@15                                          0920 03911000
         BNE   @RF00920                                            0920 03912000
*                       SECCYL=(SECBYTES/TRKCAPTY)+ROUND;/*  @G24LB26*/ 03913000
*                                                                  0921 03914000
         LR    @00,SECBYTES                                        0921 03915000
         SRDA  @00,32                                              0921 03916000
         DR    @00,@15                                             0921 03917000
         ALR   @01,ROUND                                           0921 03918000
         STH   @01,SECCYL                                          0921 03919000
*                     /***********************************************/ 03920000
*                     /*                                             */ 03921000
*                     /* WHEN OVERFLOW SITUATION OCCURES     @G24LB26*/ 03922000
*                     /*                                             */ 03923000
*                     /***********************************************/ 03924000
*                                                                  0922 03925000
*                     ELSE          /*                       @G24LB26*/ 03926000
*                       SECCYL=(SECBYTES/TRKOFCAP)+ROUND;/*  @G24LB26*/ 03927000
*                                                                  0922 03928000
         B     @RC00920                                            0922 03929000
@RF00920 LR    @00,SECBYTES                                        0922 03930000
         SRDA  @00,32                                              0922 03931000
         D     @00,@CF02040                                        0922 03932000
         ALR   @01,ROUND                                           0922 03933000
         STH   @01,SECCYL                                          0922 03934000
*                     /***********************************************/ 03935000
*                     /*                                             */ 03936000
*                     /* DETERMINE ROUND OFF FACTOR FOR      @G24LB26*/ 03937000
*                     /* TRACKS TO CYLINDERS FOR SECONDARY   @G24LB26*/ 03938000
*                     /* SPACE                               @G24LB26*/ 03939000
*                     /*                                             */ 03940000
*                     /***********************************************/ 03941000
*                                                                  0923 03942000
*                     IF SECCYL//TRKCYL>ZERO THEN/*          @G24LB26*/ 03943000
@RC00920 LH    @00,SECCYL                                          0923 03944000
         SRDA  @00,32                                              0923 03945000
         D     @00,@CF02038                                        0923 03946000
         LTR   @00,@00                                             0923 03947000
         BNP   @RF00923                                            0923 03948000
*                       ROUND=ONE;  /* ROUND UP REQUIRED     @G24LB26*/ 03949000
         LA    ROUND,1                                             0924 03950000
*                     ELSE          /*                       @G24LB26*/ 03951000
*                       ROUND=ZERO; /* NO ROUND UP REQUIRED  @G24LB26*/ 03952000
*                                                                  0925 03953000
         B     @RC00923                                            0925 03954000
@RF00923 SLR   ROUND,ROUND                                         0925 03955000
*                     /***********************************************/ 03956000
*                     /*                                             */ 03957000
*                     /* CALCULATE SECONDARY SPACE IN        @G24LB26*/ 03958000
*                     /* CYLINDERS                           @G24LB26*/ 03959000
*                     /*                                             */ 03960000
*                     /***********************************************/ 03961000
*                                                                  0926 03962000
*                     SECCYL=(SECCYL/TRKCYL)+ROUND;/*        @G24LB26*/ 03963000
@RC00923 LH    @00,SECCYL                                          0926 03964000
         SRDA  @00,32                                              0926 03965000
         D     @00,@CF02038                                        0926 03966000
         ALR   @01,ROUND                                           0926 03967000
         STH   @01,SECCYL                                          0926 03968000
*                   END;            /*                       @G24LB26*/ 03969000
*               END;                /*                       @G24LB26*/ 03970000
*                                                                  0928 03971000
*             /*******************************************************/ 03972000
*             /*                                                     */ 03973000
*             /* NO TRACK OVERFLOW CALCULATIONS              @G24LB26*/ 03974000
*             /*                                                     */ 03975000
*             /*******************************************************/ 03976000
*                                                                  0929 03977000
*             ELSE                  /*                       @G24LB26*/ 03978000
*                                                                  0929 03979000
*               /*****************************************************/ 03980000
*               /*                                                   */ 03981000
*               /* SINCE THE NUMBER OF RECORDS THAT WILL FIT @G24LB26*/ 03982000
*               /* ON A TRACK HAS ALREADY BEEN CALCULATED    @G24LB26*/ 03983000
*               /* AND FOUND TO BE ONE OR GREATER, WE CAN    @G24LB26*/ 03984000
*               /* PROCEED WITH THE NO TRACK OVERFLOW        @G24LB26*/ 03985000
*               /* SITUATION.                                @G24LB26*/ 03986000
*               /*                                                   */ 03987000
*               /*****************************************************/ 03988000
*                                                                  0929 03989000
*               DO;                 /*                       @G24LB26*/ 03990000
*                                                                  0929 03991000
         B     @RC00897                                            0929 03992000
@RF00897 DS    0H                                                  0930 03993000
*                 /***************************************************/ 03994000
*                 /*                                                 */ 03995000
*                 /* DETERMINE ROUND OFF FACTOR WHEN         @G24LB26*/ 03996000
*                 /* CONVERTING TO TRACKS                    @G24LB26*/ 03997000
*                 /*                                                 */ 03998000
*                 /***************************************************/ 03999000
*                                                                  0930 04000000
*                 IF PQTY//RECORDS>ZERO THEN/*               @G24LB26*/ 04001000
         L     @04,JFCBPTR(,SELTMPTR)                              0930 04002000
         SLR   @00,@00                                             0930 04003000
         ICM   @00,7,PQTY(@04)                                     0930 04004000
         SRDA  @00,32                                              0930 04005000
         DR    @00,RECORDS                                         0930 04006000
         LTR   @00,@00                                             0930 04007000
         BNP   @RF00930                                            0930 04008000
*                   ROUND=ONE;      /* ROUND UP ONE TRACK    @G24LB26*/ 04009000
         LA    ROUND,1                                             0931 04010000
*                 ELSE              /*                       @G24LB26*/ 04011000
*                   ROUND=ZERO;     /* NO ROUNDING UP        @G24LB26   04012000
*                                      REQUIRED              @G24LB26*/ 04013000
*                                                                  0932 04014000
         B     @RC00930                                            0932 04015000
@RF00930 SLR   ROUND,ROUND                                         0932 04016000
*                 /***************************************************/ 04017000
*                 /*                                                 */ 04018000
*                 /* CALCULATE NUMBER OFF PRIMARY TRACKS FOR @G24LB26*/ 04019000
*                 /* NO OVERFLOW CONDITION.                  @G24LB26*/ 04020000
*                 /*                                                 */ 04021000
*                 /***************************************************/ 04022000
*                                                                  0933 04023000
*                 PRICYL=(PQTY/RECORDS)+ROUND;/*             @G24LB26*/ 04024000
*                                                                  0933 04025000
@RC00930 L     @04,JFCBPTR(,SELTMPTR)                              0933 04026000
         SLR   @01,@01                                             0933 04027000
         ICM   @01,7,PQTY(@04)                                     0933 04028000
         SLR   @00,@00                                             0933 04029000
         DR    @00,RECORDS                                         0933 04030000
         ALR   @01,ROUND                                           0933 04031000
         STH   @01,PRICYL                                          0933 04032000
*                 /***************************************************/ 04033000
*                 /*                                                 */ 04034000
*                 /* DETERMINE ROUND OFF FOR TRACKS TO       @G24LB26*/ 04035000
*                 /* CYLINDERS                               @G24LB26*/ 04036000
*                 /*                                                 */ 04037000
*                 /***************************************************/ 04038000
*                                                                  0934 04039000
*                 IF PRICYL//TRKCYL>ZERO THEN/*              @G24LB26*/ 04040000
         LR    @14,@01                                             0934 04041000
         SRDA  @14,32                                              0934 04042000
         D     @14,@CF02038                                        0934 04043000
         LTR   @14,@14                                             0934 04044000
         BNP   @RF00934                                            0934 04045000
*                   ROUND=ONE;      /* ROUND UP ONE CYL      @G24LB26*/ 04046000
         LA    ROUND,1                                             0935 04047000
*                 ELSE              /*                       @G24LB26*/ 04048000
*                   ROUND=ZERO;     /* NO ROUND UP REQUIRED  @G24LB26*/ 04049000
*                                                                  0936 04050000
         B     @RC00934                                            0936 04051000
@RF00934 SLR   ROUND,ROUND                                         0936 04052000
*                 /***************************************************/ 04053000
*                 /*                                                 */ 04054000
*                 /* CALCULATE PRIMARY SPACE IN CYLINDERS    @G24LB26*/ 04055000
*                 /* FOR NO TRACK OVERFLOW.                  @G24LB26*/ 04056000
*                 /*                                                 */ 04057000
*                 /***************************************************/ 04058000
*                                                                  0937 04059000
*                 PRICYL=(PRICYL/TRKCYL)+ROUND;/*            @G24LB26*/ 04060000
*                                                                  0937 04061000
@RC00934 LH    @00,PRICYL                                          0937 04062000
         SRDA  @00,32                                              0937 04063000
         D     @00,@CF02038                                        0937 04064000
         ALR   @01,ROUND                                           0937 04065000
         STH   @01,PRICYL                                          0937 04066000
*                 /***************************************************/ 04067000
*                 /*                                                 */ 04068000
*                 /* IF THE REQUEST IN MULTI-VOLUME, CONVERT @G24LB26*/ 04069000
*                 /* SECONDARY SPACE TO CYLINDERS.           @G24LB26*/ 04070000
*                 /*                                                 */ 04071000
*                 /***************************************************/ 04072000
*                                                                  0938 04073000
*                 IF NUMBVOL>ONE THEN/*                      @G24LB26*/ 04074000
         CLI   NUMBVOL,1                                           0938 04075000
         BNH   @RF00938                                            0938 04076000
*                   DO;             /*                       @G24LB26*/ 04077000
*                                                                  0939 04078000
*                     /***********************************************/ 04079000
*                     /*                                             */ 04080000
*                     /* DETERMINE ROUND OFF FACTOR FOR      @G24LB26*/ 04081000
*                     /* CONVERSION TO TRACKS                @G24LB26*/ 04082000
*                     /*                                             */ 04083000
*                     /***********************************************/ 04084000
*                                                                  0940 04085000
*                     IF SQTY//RECORDS>ZERO THEN/*           @G24LB26*/ 04086000
         L     @04,JFCBPTR(,SELTMPTR)                              0940 04087000
         SLR   @00,@00                                             0940 04088000
         ICM   @00,7,SQTY(@04)                                     0940 04089000
         SRDA  @00,32                                              0940 04090000
         DR    @00,RECORDS                                         0940 04091000
         LTR   @00,@00                                             0940 04092000
         BNP   @RF00940                                            0940 04093000
*                       ROUND=ONE;  /*                       @G24LB26*/ 04094000
         LA    ROUND,1                                             0941 04095000
*                     ELSE          /*                       @G24LB26*/ 04096000
*                       ROUND=ZERO; /*                       @G24LB26*/ 04097000
*                                                                  0942 04098000
         B     @RC00940                                            0942 04099000
@RF00940 SLR   ROUND,ROUND                                         0942 04100000
*                     /***********************************************/ 04101000
*                     /*                                             */ 04102000
*                     /* CALCULATE NUMBER OF SECONDARY       @G24LB26*/ 04103000
*                     /* TRACKS FOR NO OVERFLOW CONDITION    @G24LB26*/ 04104000
*                     /*                                             */ 04105000
*                     /***********************************************/ 04106000
*                                                                  0943 04107000
*                     SECCYL=(SQTY/RECORDS)+ROUND;/*         @G24LB26*/ 04108000
*                                                                  0943 04109000
@RC00940 L     @04,JFCBPTR(,SELTMPTR)                              0943 04110000
         SLR   @01,@01                                             0943 04111000
         ICM   @01,7,SQTY(@04)                                     0943 04112000
         SLR   @00,@00                                             0943 04113000
         DR    @00,RECORDS                                         0943 04114000
         ALR   @01,ROUND                                           0943 04115000
         STH   @01,SECCYL                                          0943 04116000
*                     /***********************************************/ 04117000
*                     /*                                             */ 04118000
*                     /* DETERMINE ROUND OFF FACTOR FOR      @G24LB26*/ 04119000
*                     /* TRACKS TO CYLINDERS                 @G24LB26*/ 04120000
*                     /*                                             */ 04121000
*                     /***********************************************/ 04122000
*                                                                  0944 04123000
*                     IF SECCYL//TRKCYL>ZERO THEN/*          @G24LB26*/ 04124000
         LR    @02,@01                                             0944 04125000
         SRDA  @02,32                                              0944 04126000
         D     @02,@CF02038                                        0944 04127000
         LTR   @02,@02                                             0944 04128000
         BNP   @RF00944                                            0944 04129000
*                       ROUND=ONE;  /* ROUND UP ONE CYL      @G24LB26*/ 04130000
         LA    ROUND,1                                             0945 04131000
*                     ELSE          /*                       @G24LB26*/ 04132000
*                       ROUND=ZERO; /* NO ROUND OFF REQUIRED @G24LB26*/ 04133000
*                                                                  0946 04134000
         B     @RC00944                                            0946 04135000
@RF00944 SLR   ROUND,ROUND                                         0946 04136000
*                     /***********************************************/ 04137000
*                     /*                                             */ 04138000
*                     /* CALCULATE SECONDARY SPACE IN        @G24LB26*/ 04139000
*                     /* CYLINDERS FOR NO TRACK OVERFLOW     @G24LB26*/ 04140000
*                     /* CONDITION.                          @G24LB26*/ 04141000
*                     /*                                             */ 04142000
*                     /***********************************************/ 04143000
*                                                                  0947 04144000
*                     SECCYL=(SECCYL/TRKCYL)+ROUND;/*        @G24LB26*/ 04145000
@RC00944 LH    @00,SECCYL                                          0947 04146000
         SRDA  @00,32                                              0947 04147000
         D     @00,@CF02038                                        0947 04148000
         ALR   @01,ROUND                                           0947 04149000
         STH   @01,SECCYL                                          0947 04150000
*                   END;            /*                       @G24LB26*/ 04151000
*               END;                /*                       @G24LB26*/ 04152000
*           END;                    /*                       @G24LB26*/ 04153000
*     END;                          /*                       @G24LB26*/ 04154000
*   RETURN;                         /*                       @G24LB26*/ 04155000
@EL00008 DS    0H                                                  0952 04156000
@EF00008 DS    0H                                                  0952 04157000
@ER00008 L     @14,12(,@13)                                        0952 04158000
         BR    @14                                                 0952 04159000
*   END SPACONV;                    /*                       @G24LB26*/ 04160000
         B     @EL00008                                            0953 04161000
*                                                                  0954 04162000
*/*********************************************************  @G24LB26*/ 04163000
*/*                                                          @G24LB26*/ 04164000
*/* PROCEDURE NAME - SPACECK                                 @G24LB26*/ 04165000
*/*                                                          @G24LB26*/ 04166000
*/* FUNCITON - DETERMINES IF THERE IS ENOUGH SPACE ON A      @G24LB26*/ 04167000
*/*            VOLUME FOR THE PRIMARY SPACE REQUIRED         @G24LB26*/ 04168000
*/*            WITHOUT USING ANY RESERVED SPACE. IF THE      @G24LB26*/ 04169000
*/*            REQUEST IS MULTI-VOLUME, THE ROUTINE          @G24LB26*/ 04170000
*/*            DETERMINES IF THERE IS ENOUGH SPACE FOR ONE   @G24LB26*/ 04171000
*/*            SECONDARY EXTENT NOT TAKING INTO ACCOUNT      @G24LB26*/ 04172000
*/*            ANY RESERVED SPACE.                           @G24LB26*/ 04173000
*/*                                                          @G24LB26*/ 04174000
*/* INPUT - PRIMARY AND SECONDARY SPACE REQUIRED BY THE      @G24LB26*/ 04175000
*/*         REQUEST AND A COUNT FIELD TO DETERMINE IF IT     @G24LB26*/ 04176000
*/*         IS A MULTI-VOLUME REQUEST OR NOT. AVAILABLE      @G24LB26*/ 04177000
*/*         RUNNING SPACE FROM EXTENSION RECORD. PERCENT     @G24LB26*/ 04178000
*/*         RESERVED SPACE FROM THE GROUP RECORD.  ALSO      @G24LB26*/ 04179000
*/*         INDEXES INTO THE EXTENSION RECORD AND THE        @G24LB26*/ 04180000
*/*         BEST FIT TABLE.                                  @G24LB26*/ 04181000
*/*                                                          @G24LB26*/ 04182000
*/* OUTPUT - A 4 RETURN CODE IN INTERNAL WORK AREA IF        @G24LB26*/ 04183000
*/*          VOLUME IS NOT ELIGIBLE FOR PRIMARY VOLUME       @G24LB26*/ 04184000
*/*          AND IF MULTI-VOLUME IS NOT ELIGIBLE FOR         @G24LB26*/ 04185000
*/*          SECONDARY. TURNS ON INDICATORS IN BEST FIT      @G24LB26*/ 04186000
*/*          TABLE IF VOLUME IS ELIGIBLE, BUT NOT FOR        @G24LB26*/ 04187000
*/*          BOTH PRIMARY AND SECONDARY.                     @G24LB26*/ 04188000
*/*                                                          @G24LB26*/ 04189000
*/*********************************************************  @G24LB26*/ 04190000
*                                                                  0954 04191000
*SPACECK:                                                          0954 04192000
*   PROC OPTIONS(SAVE(REG14));      /*                       @G24LB26*/ 04193000
SPACECK  ST    @14,@SA00009                                        0954 04194000
*   INTERCC=RCZERO;                 /* CLEAR RETURN CODE     @G24LB26*/ 04195000
         MVC   INTERCC(2),@CB02111                                 0955 04196000
*   LSPASW=OFF;                     /* INIT LOOP CONTROL     @ZA28479*/ 04197000
*   SPAEXIT=OFF;                    /* INIT OTHER LOOP CNTR  @ZA28479*/ 04198000
*                                                                  0957 04199000
         NI    LSPASW,B'10011111'                                  0957 04200000
*   /*****************************************************************/ 04201000
*   /*                                                               */ 04202000
*   /* DETERMINE ROUNDING FACTOR FOR RESERVED SPACE          @G24LB26*/ 04203000
*   /*                                                               */ 04204000
*   /*****************************************************************/ 04205000
*                                                                  0958 04206000
*   IF(GRORESSP*CYL3330V)//CONVPERC>ZERO THEN/*              @G24LB26*/ 04207000
         L     @04,GROUPPTR                                        0958 04208000
         SLR   @01,@01                                             0958 04209000
         IC    @01,GRORESSP(,@04)                                  0958 04210000
         M     @00,@CF02021                                        0958 04211000
         D     @00,@CF02023                                        0958 04212000
         LTR   @00,@00                                             0958 04213000
         BNP   @RF00958                                            0958 04214000
*     ROUND=ONE;                    /*                       @G24LB26*/ 04215000
         LA    ROUND,1                                             0959 04216000
*   ELSE                            /*                       @G24LB26*/ 04217000
*     ROUND=ZERO;                   /*                       @G24LB26*/ 04218000
*                                                                  0960 04219000
         B     @RC00958                                            0960 04220000
@RF00958 SLR   ROUND,ROUND                                         0960 04221000
*   /*****************************************************************/ 04222000
*   /*                                                               */ 04223000
*   /* CALCULATE RESERVED SPACE.                             @G24LB26*/ 04224000
*   /*                                                               */ 04225000
*   /*****************************************************************/ 04226000
*                                                                  0961 04227000
*   RESERSPA=((GRORESSP*CYL3330V)/CONVPERC)+ROUND;/*         @G24LB26*/ 04228000
*                                                                  0961 04229000
@RC00958 L     @04,GROUPPTR                                        0961 04230000
         SLR   @01,@01                                             0961 04231000
         IC    @01,GRORESSP(,@04)                                  0961 04232000
         M     @00,@CF02021                                        0961 04233000
         D     @00,@CF02023                                        0961 04234000
         ALR   @01,ROUND                                           0961 04235000
         STH   @01,RESERSPA                                        0961 04236000
*   /*****************************************************************/ 04237000
*   /*                                                               */ 04238000
*   /* DETERMINE IF THIS, PLUS THE PRIMARY SPACE REQUEST     @G24LB26*/ 04239000
*   /* IS MORE THAN THE AVAILABLE FREE SPACE.                @G24LB26*/ 04240000
*   /*                                                               */ 04241000
*   /*****************************************************************/ 04242000
*                                                                  0962 04243000
*   TOTSPA=RESERSPA+PRICYL;         /*                       @ZA28479*/ 04244000
*                                                                  0962 04245000
         AH    @01,PRICYL                                          0962 04246000
         STH   @01,TOTSPA                                          0962 04247000
*   /*****************************************************************/ 04248000
*   /*                                                               */ 04249000
*   /* DETERMINE IF RESERVE SPACE WOULD BE USED IF VOLUME    @G24LB26*/ 04250000
*   /* WAS USED.                                             @G24LB26*/ 04251000
*   /*                                                               */ 04252000
*   /*****************************************************************/ 04253000
*                                                                  0963 04254000
*   DO WHILE SPAEXIT=OFF;           /*                       @ZA28479*/ 04255000
         B     @DE00963                                            0963 04256000
@DL00963 DS    0H                                                  0964 04257000
*     IF(TOTSPA>GVSMTDSP(INDXEXTS))|(JFCONTIG=ON&GVSLEXT(INDXEXTS)<     04258000
*         PRICYL)|(JFCONTIG=OFF&FIVE*GVSLEXT(INDXEXTS)<PRICYL) THEN     04259000
*                                                                  0964 04260000
         L     @04,GVSNEPTR                                        0964 04261000
         LR    @15,INDXEXTS                                        0964 04262000
         MH    @15,@CH01851                                        0964 04263000
         LH    @14,TOTSPA                                          0964 04264000
         CH    @14,GVSMTDSP-20(@15,@04)                            0964 04265000
         BH    @RT00964                                            0964 04266000
         L     @01,JFCBPTR(,SELTMPTR)                              0964 04267000
         TM    JFCONTIG(@01),B'00001000'                           0964 04268000
         BNO   @GL00040                                            0964 04269000
         LH    @04,GVSLEXT-20(@15,@04)                             0964 04270000
         CH    @04,PRICYL                                          0964 04271000
         BL    @RT00964                                            0964 04272000
@GL00040 L     @04,JFCBPTR(,SELTMPTR)                              0964 04273000
         TM    JFCONTIG(@04),B'00001000'                           0964 04274000
         BNZ   @RF00964                                            0964 04275000
         LR    @04,INDXEXTS                                        0964 04276000
         MH    @04,@CH01851                                        0964 04277000
         L     @01,GVSNEPTR                                        0964 04278000
         LH    @04,GVSLEXT-20(@04,@01)                             0964 04279000
         MH    @04,@CH00087                                        0964 04280000
         CH    @04,PRICYL                                          0964 04281000
         BNL   @RF00964                                            0964 04282000
@RT00964 DS    0H                                                  0965 04283000
*       /*************************************************************/ 04284000
*       /*                                                           */ 04285000
*       /* TRY TO SAVE VOLUME FOR PRIMARY BY LSPACING        @ZA28479*/ 04286000
*       /* IF FREE SPACE AND RUNNING SPACE ARE TWO TIMES     @ZA28479*/ 04287000
*       /* THE PRIMARY REQUEST APART                         @ZA28479*/ 04288000
*       /*                                                           */ 04289000
*       /*************************************************************/ 04290000
*                                                                  0965 04291000
*       DO;                         /*                       @ZA28479*/ 04292000
*         IF(GVSFRESP(INDXEXTS)-GVSMTDSP(INDXEXTS)>TWO*PRICYL)&BFNOTMTD 04293000
*             (INDXBFTB)=OFF&BFMTDOHT(INDXBFTB)=OFF&UCBADDR^=ZEROPTR&   04294000
*             LSPASW=OFF THEN       /*                       @ZA28479*/ 04295000
         L     @04,GVSNEPTR                                        0966 04296000
         LR    @15,INDXEXTS                                        0966 04297000
         MH    @15,@CH01851                                        0966 04298000
         LH    @14,GVSFRESP-20(@15,@04)                            0966 04299000
         SH    @14,GVSMTDSP-20(@15,@04)                            0966 04300000
         LH    @04,PRICYL                                          0966 04301000
         ALR   @04,@04                                             0966 04302000
         CR    @14,@04                                             0966 04303000
         BNH   @RF00966                                            0966 04304000
         LR    @04,INDXBFTB                                        0966 04305000
         MH    @04,@CH02240                                        0966 04306000
         L     @01,BFTBLPTR                                        0966 04307000
         ALR   @01,@04                                             0966 04308000
         TM    BFNOTMTD-18(@01),B'10100000'                        0966 04309000
         BNZ   @RF00966                                            0966 04310000
         L     @04,UCBADDR                                         0966 04311000
         LTR   @04,@04                                             0966 04312000
         BZ    @RF00966                                            0966 04313000
         TM    LSPASW,B'00100000'                                  0966 04314000
         BNZ   @RF00966                                            0966 04315000
*           DO;                     /*                       @ZA28479*/ 04316000
*             RESPECIFY                                            0968 04317000
*              (REG0,                                              0968 04318000
*               REG1,                                              0968 04319000
*               REG15) RSTD;        /*                       @ZA28479*/ 04320000
*                                                                  0968 04321000
*             /*******************************************************/ 04322000
*             /*                                                     */ 04323000
*             /* ISSUE LSPACE TO GET SPACE UP LEVEL          @ZA28479*/ 04324000
*             /*                                                     */ 04325000
*             /*******************************************************/ 04326000
*                                                                  0969 04327000
*             REG0=ADDR(UCBOB);     /* SET UP UCB ADDR       @ZA28479*/ 04328000
         L     REG0,UCBPTR                                         0969 04329000
*             REG1=ADDR(LSPAREA);   /* ADDR OF RETURN AREA   @ZA28479*/ 04330000
         LA    REG1,LSPAREA                                        0970 04331000
*             SVC(LSPACE);          /* ISSUE LSPACE MACRO    @ZA28479*/ 04332000
         SVC   78                                                  0971 04333000
*             RESPECIFY                                            0972 04334000
*              (REG0,                                              0972 04335000
*               REG1) UNRSTD;       /*                       @ZA28479*/ 04336000
*             LSPASW=ON;            /* INDICATE LSPACE DONE  @ZA28479*/ 04337000
*                                                                  0973 04338000
         OI    LSPASW,B'00100000'                                  0973 04339000
*             /*******************************************************/ 04340000
*             /*                                                     */ 04341000
*             /* IF LSPACE SUCCESSFUL, UPDATE FREE SPACE IN  @ZA28479*/ 04342000
*             /* EXTENSION RECORD. ALSO LARGEST FREE EXTENT  @ZA28479*/ 04343000
*             /*                                                     */ 04344000
*             /*******************************************************/ 04345000
*                                                                  0974 04346000
*             IF REG15=RCZERO THEN  /*                       @ZA28479*/ 04347000
         LTR   REG15,REG15                                         0974 04348000
         BNZ   @RF00974                                            0974 04349000
*               DO;                 /*                       @ZA28479*/ 04350000
*                 PACK(TEMPPACK,LSPFRESP);/*                 @ZA28479*/ 04351000
         PACK  TEMPPACK(4),LSPFRESP(4)                             0976 04352000
*                 CVB(TEMPBIN,TEMPPACK);/*                   @ZA28479*/ 04353000
         XC    @TS00001(8),@TS00001                                0977 04354000
         MVC   @TS00001+4(4),TEMPPACK                              0977 04355000
         CVB   TEMPBIN,@TS00001                                    0977 04356000
*                 GVSFRESP(INDXEXTS)=TEMPBIN;/* UPDT FREE SP @ZA28479*/ 04357000
         L     @14,GVSNEPTR                                        0978 04358000
         LR    @04,INDXEXTS                                        0978 04359000
         MH    @04,@CH01851                                        0978 04360000
         STH   TEMPBIN,GVSFRESP-20(@04,@14)                        0978 04361000
*                 PACK(TEMPPACK,LSPLEXT);/*                  @ZA28479*/ 04362000
         PACK  TEMPPACK(4),LSPLEXT(4)                              0979 04363000
*                 CVB(TEMPBIN,TEMPPACK);/*                   @ZA28479*/ 04364000
         XC    @TS00001(8),@TS00001                                0980 04365000
         MVC   @TS00001+4(4),TEMPPACK                              0980 04366000
         CVB   TEMPBIN,@TS00001                                    0980 04367000
*                 GVSLEXT(INDXEXTS)=TEMPBIN;/* UPDT FREE SP  @ZA28479*/ 04368000
*                                                                  0981 04369000
         STH   TEMPBIN,GVSLEXT-20(@04,@14)                         0981 04370000
*                 /***************************************************/ 04371000
*                 /*                                                 */ 04372000
*                 /* CALL TABLE PROCESSOR TO GET SCHEDULED   @ZA28479*/ 04373000
*                 /* SPACE                                   @ZA28479*/ 04374000
*                 /*                                                 */ 04375000
*                 /***************************************************/ 04376000
*                                                                  0982 04377000
*                 TABP=TABP&&TABP;  /* CLEAR TABLE PARM      @ZA28479*/ 04378000
         LA    @03,STRTABP                                         0982 04379000
         XC    TABP(12,@03),TABP(@03)                              0982 04380000
*                 TABFTSPC=ON;      /* SEARCH FOR VOL        @ZA28479*/ 04381000
         OI    TABFTSPC(@03),B'00010000'                           0983 04382000
*                 TABVOLID=GVSVOLID(INDXEXTS);/* VOLID       @ZA28479*/ 04383000
         ALR   @14,@04                                             0984 04384000
         MVC   TABVOLID(6,@03),GVSVOLID-20(@14)                    0984 04385000
*                 CALL ICBVTP00(TABP);/* CALL TABLE PROCESSOR      0985 04386000
*                                                            @ZA28479*/ 04387000
         ST    @03,@AL00001                                        0985 04388000
         L     @15,@CV01914                                        0985 04389000
         LA    @01,@AL00001                                        0985 04390000
         BALR  @14,@15                                             0985 04391000
*                 GVSMTDSP(INDXEXTS)=GVSFRESP(INDXEXTS)-TABSPRET;  0986 04392000
         L     @14,GVSNEPTR                                        0986 04393000
         LR    @04,INDXEXTS                                        0986 04394000
         MH    @04,@CH01851                                        0986 04395000
         LA    @03,STRTABP                                         0986 04396000
         LH    @02,GVSFRESP-20(@04,@14)                            0986 04397000
         SH    @02,TABSPRET(,@03)                                  0986 04398000
         STH   @02,GVSMTDSP-20(@04,@14)                            0986 04399000
*                 GVSRCFSI(INDXEXTS)=OFF;/* AVAIL SPACE OK   @ZA28479*/ 04400000
*                                                                  0987 04401000
         ST    @04,@TF00001                                        0987 04402000
         ALR   @04,@14                                             0987 04403000
         NI    GVSRCFSI-20(@04),B'01111111'                        0987 04404000
*                 /***************************************************/ 04405000
*                 /*                                                 */ 04406000
*                 /* CHECK FOR NEGATIVE NUMBER               @ZA28479*/ 04407000
*                 /*                                                 */ 04408000
*                 /***************************************************/ 04409000
*                                                                  0988 04410000
*                 IF GVSMTDSP(INDXEXTS)<ZERO THEN/*          @ZA28479*/ 04411000
         SLR   @04,@04                                             0988 04412000
         L     @01,@TF00001                                        0988 04413000
         CH    @04,GVSMTDSP-20(@01,@14)                            0988 04414000
         BNH   @RF00988                                            0988 04415000
*                   GVSMTDSP(INDXEXTS)=ZERO;/*               @ZA28479*/ 04416000
*                                                                  0989 04417000
         L     @01,@TF00001                                        0989 04418000
         STH   @04,GVSMTDSP-20(@01,@14)                            0989 04419000
*                 /***************************************************/ 04420000
*                 /*                                                 */ 04421000
*                 /* INDICATE THAT EXTENSION RECORD          @ZA28479*/ 04422000
*                 /* WAS UPDATED                             @ZA28479*/ 04423000
*                 /*                                                 */ 04424000
*                 /***************************************************/ 04425000
*                                                                  0990 04426000
*                 UPDTGVSN=ON;      /*                       @ZA28479*/ 04427000
@RF00988 OI    UPDTGVSN,B'10000000'                                0990 04428000
*               END;                /*                       @ZA28479*/ 04429000
*             ELSE                  /*                       @ZA28479*/ 04430000
*                                                                  0992 04431000
*               /*****************************************************/ 04432000
*               /*                                                   */ 04433000
*               /* ISSUE ERROR MESSAGE, LSPACE FAILED        @ZA28479*/ 04434000
*               /*                                                   */ 04435000
*               /*****************************************************/ 04436000
*                                                                  0992 04437000
*               DO;                 /*                       @ZA28479*/ 04438000
         B     @RC00974                                            0992 04439000
@RF00974 DS    0H                                                  0993 04440000
*                 MSGRQ=MSGRQ&&MSGRQ;/* CLEAR PARM FIELD     @ZA28479*/ 04441000
         XC    MSGRQ(32),MSGRQ                                     0993 04442000
*                 MSGRPLV=RPLVPTR;  /* ADDR OF REQUEST PARM  @ZA28479*/ 04443000
         ST    RPLVPTR,MSGRPLV                                     0994 04444000
*                 MSGID=MSG401;     /* MSG NUMBER            @ZA28479*/ 04445000
         MVC   MSGID(4),@CF02057                                   0995 04446000
*                 MSGLEN1=SIX;      /* MSG LENGTH OF INSERT  @ZA28479*/ 04447000
         MVI   MSGLEN1,X'06'                                       0996 04448000
*                 MSGTEXT1=ADDR(GVSVOLID(INDXEXTS));/* INSERT      0997 04449000
*                                                            @ZA28479*/ 04450000
         LR    @14,INDXEXTS                                        0997 04451000
         MH    @14,@CH01851                                        0997 04452000
         L     @04,GVSNEPTR                                        0997 04453000
         LA    @14,GVSVOLID-20(@14,@04)                            0997 04454000
         STCM  @14,7,MSGTEXT1                                      0997 04455000
*                 MSGLEN2=TWO;      /* MSG LENGTH OF INSERT  @ZA28479*/ 04456000
         MVI   MSGLEN2,X'02'                                       0998 04457000
*                 MSGTEXT2=ADDR(TEMPCHAR);/* INSERT TWO      @ZA28479*/ 04458000
         LA    @14,TEMPCHAR                                        0999 04459000
         STCM  @14,7,MSGTEXT2                                      0999 04460000
*                 TEMPBIN=REG15;    /* RETURN CODE           @ZA28479*/ 04461000
         LR    TEMPBIN,REG15                                       1000 04462000
*                 CVD(TEMPBIN,TEMPPACK);/*                   @ZA28479*/ 04463000
         CVD   TEMPBIN,@TS00001                                    1001 04464000
         MVC   TEMPPACK(4),@TS00001+4                              1001 04465000
*                 UNPK(TEMPCHAR,TEMPPACK);/*                 @ZA28479*/ 04466000
         UNPK  TEMPCHAR(2),TEMPPACK(4)                             1002 04467000
*                 TEMPCHAR(2:2)=TEMPCHAR(2:2)|ORSIGN;/*      @ZA28479*/ 04468000
         OC    TEMPCHAR+1(1),ORSIGN                                1003 04469000
*                 RESPECIFY                                        1004 04470000
*                   REG1 RSTD;      /*                       @ZA28479*/ 04471000
*                 REG1=ADDR(MSGRQ); /*                       @ZA28479*/ 04472000
         LA    REG1,MSGRQ                                          1005 04473000
*                 CALL ICBVOP00;    /* CALL MSG MODULE       @ZA28479*/ 04474000
         L     @15,@CV01912                                        1006 04475000
         BALR  @14,@15                                             1006 04476000
*                 RESPECIFY                                        1007 04477000
*                  (REG1,                                          1007 04478000
*                   REG15) UNRSTD;  /*                       @ZA28479*/ 04479000
*                 SPAEXIT=ON;       /* EXIT FROM LOOP        @ZA28479*/ 04480000
         OI    SPAEXIT,B'01000000'                                 1008 04481000
*                 INTERCC=RCFOUR;   /* MAKE TOTALLY INELGBLE @ZA28479*/ 04482000
         MVC   INTERCC(2),@CB02113                                 1009 04483000
*               END;                /*                       @ZA28479*/ 04484000
*           END;                    /*                       @ZA28479*/ 04485000
*         ELSE                      /*                       @ZA28479*/ 04486000
*           DO;                     /*                       @G24LB26*/ 04487000
*                                                                  1012 04488000
         B     @RC00966                                            1012 04489000
@RF00966 DS    0H                                                  1013 04490000
*             /*******************************************************/ 04491000
*             /*                                                     */ 04492000
*             /* DETERMINE IF VOLUME NEEDS CHECK FOR         @G24LB26*/ 04493000
*             /* SECONDARY SPACE.                            @G24LB26*/ 04494000
*             /*                                                     */ 04495000
*             /*******************************************************/ 04496000
*                                                                  1013 04497000
*             IF NUMBVOL=ONE THEN   /*                       @G24LB26*/ 04498000
         CLI   NUMBVOL,1                                           1013 04499000
         BNE   @RF01013                                            1013 04500000
*               DO;                 /*                       @ZA28479*/ 04501000
*                 INTERCC=RCFOUR;   /* FAIL REQUEST          @ZA28479*/ 04502000
         MVC   INTERCC(2),@CB02113                                 1015 04503000
*                 SPAEXIT=ON;       /* EXIT LOOP             @ZA28479*/ 04504000
         OI    SPAEXIT,B'01000000'                                 1016 04505000
*               END;                /*                       @ZA28479*/ 04506000
*             ELSE                  /*                       @ZA28479*/ 04507000
*               DO;                 /*                       @ZA28479*/ 04508000
         B     @RC01013                                            1018 04509000
@RF01013 DS    0H                                                  1019 04510000
*                 BFBADPRI(INDXBFTB)=ON;/*                   @G24LB26*/ 04511000
         LR    @04,INDXBFTB                                        1019 04512000
         MH    @04,@CH02240                                        1019 04513000
         L     @01,BFTBLPTR                                        1019 04514000
         ALR   @01,@04                                             1019 04515000
         OI    BFBADPRI-18(@01),B'10000000'                        1019 04516000
*                 SPAEXIT=ON;       /* EXIT LOOP             @ZA28479*/ 04517000
         OI    SPAEXIT,B'01000000'                                 1020 04518000
*               END;                /*                       @ZA28479*/ 04519000
*           END;                    /*                       @ZA28479*/ 04520000
*       END;                        /*                       @ZA28479*/ 04521000
*     ELSE                          /*                       @ZA28479*/ 04522000
*       SPAEXIT=ON;                 /* VOL OK, EXIT LOOP     @ZA28479*/ 04523000
         B     @RC00964                                            1024 04524000
@RF00964 OI    SPAEXIT,B'01000000'                                 1024 04525000
*   END;                            /*                       @ZA28479*/ 04526000
*                                                                  1025 04527000
@RC00964 DS    0H                                                  1025 04528000
@DE00963 TM    SPAEXIT,B'01000000'                                 1025 04529000
         BZ    @DL00963                                            1025 04530000
*   /*****************************************************************/ 04531000
*   /*                                                               */ 04532000
*   /* IF VOLUME IS ELIGIBLE FOR PRIMARY SELECTION           @ZA28479*/ 04533000
*   /* AT THIS POINT IN THE SELECTION PROCESS,               @ZA28479*/ 04534000
*   /* THEN PLACE THE AMOUNT OF SELECTABLE SPACE ON          @ZA28479*/ 04535000
*   /* THIS VOLUME IN A TEMPORARY HOLDING AREA UNTIL         @ZA28479*/ 04536000
*   /* IT IS DETERMINED FOR CERTAIN THAT THIS VOLUME         @ZA28479*/ 04537000
*   /* IS ELIGIBLE FOR THE REQUEST.                          @ZA28479*/ 04538000
*   /*                                                               */ 04539000
*   /*****************************************************************/ 04540000
*                                                                  1026 04541000
*   IF INTERCC=RCZERO&BFBADPRI(INDXBFTB)=OFF THEN/*          @ZA28479*/ 04542000
         CLC   INTERCC(2),@CB02111                                 1026 04543000
         BNE   @RF01026                                            1026 04544000
         LR    @04,INDXBFTB                                        1026 04545000
         MH    @04,@CH02240                                        1026 04546000
         L     @01,BFTBLPTR                                        1026 04547000
         ALR   @01,@04                                             1026 04548000
         TM    BFBADPRI-18(@01),B'10000000'                        1026 04549000
         BNZ   @RF01026                                            1026 04550000
*     TPVOLSPA=GVSMTDSP(INDXEXTS)-RESERSPA;/*                @ZA28479*/ 04551000
*                                                                  1027 04552000
         LR    @04,INDXEXTS                                        1027 04553000
         MH    @04,@CH01851                                        1027 04554000
         L     @01,GVSNEPTR                                        1027 04555000
         LH    @04,GVSMTDSP-20(@04,@01)                            1027 04556000
         SH    @04,RESERSPA                                        1027 04557000
         STH   @04,TPVOLSPA                                        1027 04558000
*   /*****************************************************************/ 04559000
*   /*                                                               */ 04560000
*   /* IF ONLY SELECTING FOR PRIMARY ONLY, DO NOT            @G24LB26*/ 04561000
*   /* PROCESS FOR SECONDARY SELECTION.                      @G24LB26*/ 04562000
*   /*                                                               */ 04563000
*   /*****************************************************************/ 04564000
*                                                                  1028 04565000
*   IF NUMBVOL>ONE THEN             /* SEE IF MULTI-VOLUME   @G24LB26   04566000
*                                      REQUEST               @G24LB26*/ 04567000
@RF01026 CLI   NUMBVOL,1                                           1028 04568000
         BNH   @RF01028                                            1028 04569000
*     DO;                           /*                       @G24LB26*/ 04570000
*                                                                  1029 04571000
*       /*************************************************************/ 04572000
*       /*                                                           */ 04573000
*       /* IF NOT ENOUGH SPACE FOR SECONDARY EXTENT,         @G24LB26*/ 04574000
*       /* TURN ON INDICATOR.                                @G24LB26*/ 04575000
*       /*                                                           */ 04576000
*       /*************************************************************/ 04577000
*                                                                  1030 04578000
*       IF SECCYL>GVSMTDSP(INDXEXTS) THEN/*                  @G24LB26*/ 04579000
         LR    @04,INDXEXTS                                        1030 04580000
         MH    @04,@CH01851                                        1030 04581000
         LH    @15,SECCYL                                          1030 04582000
         L     @14,GVSNEPTR                                        1030 04583000
         CH    @15,GVSMTDSP-20(@04,@14)                            1030 04584000
         BNH   @RF01030                                            1030 04585000
*         BFBADSEC(INDXBFTB)=ON;    /*                       @G24LB26*/ 04586000
*                                                                  1031 04587000
         LR    @04,INDXBFTB                                        1031 04588000
         MH    @04,@CH02240                                        1031 04589000
         L     @01,BFTBLPTR                                        1031 04590000
         ALR   @01,@04                                             1031 04591000
         OI    BFBADSEC-18(@01),B'01000000'                        1031 04592000
*       /*************************************************************/ 04593000
*       /*                                                           */ 04594000
*       /* IF VOLUME IS NOT ELIGIBLE FOR EITHER PRIMARY      @G24LB26*/ 04595000
*       /* OR SECONDARY, SET BAD RETURN CODE.                @G24LB26*/ 04596000
*       /*                                                           */ 04597000
*       /*************************************************************/ 04598000
*                                                                  1032 04599000
*       IF BFBADPRI(INDXBFTB)=ON&   /*                       @G24LB26*/ 04600000
*           BFBADSEC(INDXBFTB)=ON THEN/*                     @G24LB26*/ 04601000
@RF01030 LR    @04,INDXBFTB                                        1032 04602000
         MH    @04,@CH02240                                        1032 04603000
         L     @01,BFTBLPTR                                        1032 04604000
         ALR   @01,@04                                             1032 04605000
         TM    BFBADPRI-18(@01),B'11000000'                        1032 04606000
         BNO   @RF01032                                            1032 04607000
*         INTERCC=RCFOUR;           /*                       @G24LB26*/ 04608000
         MVC   INTERCC(2),@CB02113                                 1033 04609000
*     END;                          /*                       @G24LB26*/ 04610000
*   RETURN;                         /*                       @G24LB26*/ 04611000
@EL00009 DS    0H                                                  1035 04612000
@EF00009 DS    0H                                                  1035 04613000
@ER00009 L     @14,@SA00009                                        1035 04614000
         BR    @14                                                 1035 04615000
*   END SPACECK;                    /*                       @G24LB26*/ 04616000
         B     @EL00009                                            1036 04617000
*                                                                  1037 04618000
*/*********************************************************  @G24LB26*/ 04619000
*/*                                                          @G24LB26*/ 04620000
*/* PROCEDURE NAME - VOLSEPCK                                @G24LB26*/ 04621000
*/*                                                          @G24LB26*/ 04622000
*/* FUNCTION - PROCEDURE IS CALLED TO DETERMINE IF VOLUME    @G24LB26*/ 04623000
*/*            SHOULD BE EXCLUDED FROM SELECTION BECAUSE     @G24LB26*/ 04624000
*/*            REQUEST REQUIRES DATA SEPARATION.             @G24LB26*/ 04625000
*/*                                                          @G24LB26*/ 04626000
*/* INPUT - SELECT REQUEST BLOCK, INDEX INTO EXTENSION       @G24LB26*/ 04627000
*/*         RECORD TO GET VOLID PRESENTLY WORKING ON.        @G24LB26*/ 04628000
*/*                                                          @G24LB26*/ 04629000
*/* OUTPUT - ZERO INTERNAL RETURN CODE IF VOLUME IS STILL    @G24LB26*/ 04630000
*/*          ELIGIBLE FOR SELECTION, FOUR RETURN CODE IF     @G24LB26*/ 04631000
*/*          SEPARATION REQUIREMENTS HAVE ELIMINATED THIS    @G24LB26*/ 04632000
*/*          VOLUME.                                         @G24LB26*/ 04633000
*/*                                                          @G24LB26*/ 04634000
*/*********************************************************  @G24LB26*/ 04635000
*                                                                  1037 04636000
*VOLSEPCK:                                                         1037 04637000
*   PROC OPTIONS(SAVE(REG14));      /*                       @G24LB26*/ 04638000
*                                                                  1037 04639000
VOLSEPCK ST    @14,@SA00010                                        1037 04640000
*   /*****************************************************************/ 04641000
*   /*                                                               */ 04642000
*   /* INITILIZE LOOP CONTROL SWITCH                         @G24LB26*/ 04643000
*   /*                                                               */ 04644000
*   /*****************************************************************/ 04645000
*                                                                  1038 04646000
*   SEPEXIT=OFF;                    /*                       @G24LB26*/ 04647000
*                                                                  1038 04648000
         NI    SEPEXIT,B'11111110'                                 1038 04649000
*   /*****************************************************************/ 04650000
*   /*                                                               */ 04651000
*   /* SET UP PARAMETER LIST TO CALL STEP TABLE PROCESSOR.   @G24LB26*/ 04652000
*   /*                                                               */ 04653000
*   /*****************************************************************/ 04654000
*                                                                  1039 04655000
*   RESPECIFY                                                      1039 04656000
*     STPDDENT BASED(DSPDDADR);     /*                       @G24LB26*/ 04657000
*                                                                  1039 04658000
*   /*****************************************************************/ 04659000
*   /*                                                               */ 04660000
*   /* SINCE VOL SEP SPECIFIED, CALL TABLE PROCESSOR TO SEE  @G24LB26*/ 04661000
*   /* IF VOLUME IS EXCLUDED FROM SELECTION, UNLESS THE      @G24LB26*/ 04662000
*   /* TABLE PROCESSOR HAS ALREADY BEEN CALLED FOR A         @G24LB26*/ 04663000
*   /* PREVIOUS VOLUME IN THIS REQUEST                       @G24LB26*/ 04664000
*   /*                                                               */ 04665000
*   /*****************************************************************/ 04666000
*                                                                  1040 04667000
*   IF DSPDDADR=ZEROPTR THEN        /*                       @G24LB26*/ 04668000
         L     @04,DSPDDADR                                        1040 04669000
         LTR   @04,@04                                             1040 04670000
         BNZ   @RF01040                                            1040 04671000
*     DO;                           /*                       @G24LB26*/ 04672000
*                                                                  1041 04673000
*       /*************************************************************/ 04674000
*       /*                                                           */ 04675000
*       /* INITIALIZE PROCESSOR PARAMETER LIST.              @G24LB26*/ 04676000
*       /* CALL TABLE PROCESSOR FOR ADDRESS OF DD ENTRY      @G24LB26*/ 04677000
*       /*                                                           */ 04678000
*       /*************************************************************/ 04679000
*                                                                  1042 04680000
*       TABP=TABP&&TABP;            /* CLEAR TABLE PROCESSOR @G24LB26   04681000
*                                      PARM LIST             @G24LB26*/ 04682000
         LA    @04,STRTABP                                         1042 04683000
         XC    TABP(12,@04),TABP(@04)                              1042 04684000
*       TABFSRCD=ON;                /* INDIC SEARCH TABLES   @G24LB26*/ 04685000
         OI    TABFSRCD(@04),B'01000000'                           1043 04686000
*       TABJOBID=SELJOBID;          /* JOB ID                @G24LB26*/ 04687000
         L     @15,SELJOBID(,SELTMPTR)                             1044 04688000
         ST    @15,TABJOBID(,@04)                                  1044 04689000
*       TABDDNUM=SELRFDDN;          /* DD # FOR TABLE SEARCH @G24LB26*/ 04690000
         LH    @15,SELRFDDN(,SELTMPTR)                             1045 04691000
         STH   @15,TABDDNUM(,@04)                                  1045 04692000
*       RESPECIFY                                                  1046 04693000
*         REG15 RSTD;               /*                       @G24LB26*/ 04694000
*       CALL ICBVTP00(TABP);        /* CALL TABLE PROCESSOR  @G24LB26*/ 04695000
*                                                                  1047 04696000
         ST    @04,@AL00001                                        1047 04697000
         L     @15,@CV01914                                        1047 04698000
         LA    @01,@AL00001                                        1047 04699000
         BALR  @14,@15                                             1047 04700000
*       /*************************************************************/ 04701000
*       /*                                                           */ 04702000
*       /* CHECK RETURN CODE FROM TABLE PROCESSOR.           @G24LB26*/ 04703000
*       /*                                                           */ 04704000
*       /*************************************************************/ 04705000
*                                                                  1048 04706000
*       IF REG15=RCZERO THEN        /*                       @G24LB26*/ 04707000
         LTR   REG15,REG15                                         1048 04708000
         BNZ   @RF01048                                            1048 04709000
*         DSPDDADR=TABDDRET;        /* ADDR OF DD ENTRY      @G24LB26*/ 04710000
         LA    @14,STRTABP                                         1049 04711000
         L     @14,TABDDRET(,@14)                                  1049 04712000
         ST    @14,DSPDDADR                                        1049 04713000
*       ELSE                        /*                       @G24LB26*/ 04714000
*         DSPDDADR=ONEPTR;          /* DO NOT SEARCH TABLE   @G24LB26*/ 04715000
         B     @RC01048                                            1050 04716000
@RF01048 MVC   DSPDDADR(4),@CF00043                                1050 04717000
*       RESPECIFY                                                  1051 04718000
*         REG15 UNRSTD;             /*                       @G24LB26*/ 04719000
@RC01048 DS    0H                                                  1052 04720000
*     END;                          /*                       @G24LB26*/ 04721000
*                                                                  1052 04722000
*   /*****************************************************************/ 04723000
*   /*                                                               */ 04724000
*   /* LOOP THRU VOLUMES IN STEP TABLE ENTRY IF THE          @G24LB26*/ 04725000
*   /* THE TABLE PROCESSOR HAS NOT ENCOUNTERED AN ERROR      @G24LB26*/ 04726000
*   /*                                                               */ 04727000
*   /*****************************************************************/ 04728000
*                                                                  1053 04729000
*   IF DSPDDADR^=ONEPTR THEN        /*                       @G24LB26*/ 04730000
@RF01040 LA    @04,1                                               1053 04731000
         C     @04,DSPDDADR                                        1053 04732000
         BE    @RF01053                                            1053 04733000
*     DO INDXDDVL=ONE TO STPDDNVL WHILE SEPEXIT=OFF;/*       @G24LB26*/ 04734000
*                                                                  1054 04735000
         LR    INDXDDVL,@04                                        1054 04736000
         B     @DE01054                                            1054 04737000
@DL01054 TM    SEPEXIT,B'00000001'                                 1054 04738000
         BNZ   @DC01054                                            1054 04739000
*       /*************************************************************/ 04740000
*       /*                                                           */ 04741000
*       /* IF MATCH FOUND, GET OUT OF LOOP AND SET           @G24LB26*/ 04742000
*       /* RETURN CODE INDICATING VOLUME IS NOT ELIGIBLE     @G24LB26*/ 04743000
*       /* FOR SELECTION.                                    @G24LB26*/ 04744000
*       /*                                                           */ 04745000
*       /*************************************************************/ 04746000
*                                                                  1055 04747000
*       IF GVSVOLID(INDXEXTS)=STPDDVOL(INDXDDVL) THEN/*      @G24LB26*/ 04748000
         LR    @04,INDXEXTS                                        1055 04749000
         MH    @04,@CH01851                                        1055 04750000
         LR    @03,INDXDDVL                                        1055 04751000
         MH    @03,@CH00215                                        1055 04752000
         L     @01,GVSNEPTR                                        1055 04753000
         ALR   @01,@04                                             1055 04754000
         L     @04,DSPDDADR                                        1055 04755000
         ALR   @04,@03                                             1055 04756000
         CLC   GVSVOLID-20(6,@01),STPDDVOL-6(@04)                  1055 04757000
         BNE   @RF01055                                            1055 04758000
*         DO;                       /*                       @G24LB26*/ 04759000
*           INTERCC=RCFOUR;         /* SET RETURN TO         @G24LB26   04760000
*                                      NON-ZERO              @G24LB26*/ 04761000
         MVC   INTERCC(2),@CB02113                                 1057 04762000
*           SEPEXIT=ON;             /* GET OUT OF LOOP       @G24LB26*/ 04763000
         OI    SEPEXIT,B'00000001'                                 1058 04764000
*         END;                      /*                       @G24LB26*/ 04765000
*     END;                          /*                       @G24LB26*/ 04766000
@RF01055 AL    INDXDDVL,@CF00043                                   1060 04767000
@DE01054 L     @04,DSPDDADR                                        1060 04768000
         SLR   @03,@03                                             1060 04769000
         IC    @03,STPDDNVL(,@04)                                  1060 04770000
         CR    INDXDDVL,@03                                        1060 04771000
         BNH   @DL01054                                            1060 04772000
@DC01054 DS    0H                                                  1061 04773000
*   RETURN;                         /*                       @G24LB26*/ 04774000
@EL00010 DS    0H                                                  1061 04775000
@EF00010 DS    0H                                                  1061 04776000
@ER00010 L     @14,@SA00010                                        1061 04777000
         BR    @14                                                 1061 04778000
*   END VOLSEPCK;                   /*                       @G24LB26*/ 04779000
         B     @EL00010                                            1062 04780000
*                                                                  1063 04781000
*/*********************************************************  @G24LB26*/ 04782000
*/*                                                          @G24LB26*/ 04783000
*/* PROCEDURE NAME - WAITCK                                  @G24LB26*/ 04784000
*/*                                                          @G24LB26*/ 04785000
*/* FUNCTION - DETERMINES IF A VOLUME WOULD CAUSE THE STEP   @G24LB26*/ 04786000
*/*            TO WAIT IF IT WERE SELECTED FOR THE REQUEST.  @G24LB26*/ 04787000
*/*            THE TABLE PROCESSOR MUST ALSO BE CONSULTED TO @G24LB26*/ 04788000
*/*            DETERMINE THIS, BUT THAT IS DONE LATER.       @G24LB26*/ 04789000
*/*            ROUTINE GETS CALLED ONLY IF MSVI RECORDS      @G24LB26*/ 04790000
*/*            INDICATE VOLUME IS MOUNTED TO THIS HOST.      @G24LB26*/ 04791000
*/*                                                          @G24LB26*/ 04792000
*/* INPUT - UCB ADDRESS IF AVAILABLE, UCB IF ACCESSABLE,     @G24LB26*/ 04793000
*/*         UCB ADDRESS OF REQUEST IF SPECIFIC UNIT          @G24LB26*/ 04794000
*/*         SPECIFIED ON THE REQUEST, BFNSHRFL FLAG IN       @G24LB26*/ 04795000
*/*         BEST FIT TABLE TO INDICATE IF REQUEST IS FOR     @G24LB26*/ 04796000
*/*         SHARED OR EXCLUSIVE USE AND ALSO THE DEVICE      @G24LB26*/ 04797000
*/*         TYPE FOR THIS REQUEST IF A SPECIFIC UNIT WAS     @G24LB26*/ 04798000
*/*         NOT SPECIFIED.                                   @G24LB26*/ 04799000
*/*                                                          @G24LB26*/ 04800000
*/* OUTPUT - RETURNS WITH WAIT FLAG SET ON OR LEFT OFF.      @G24LB26*/ 04801000
*/*          ZERO RETURN CODE IN INTERCC.                    @G24LB26*/ 04802000
*/*                                                          @G24LB26*/ 04803000
*/*********************************************************  @G24LB26*/ 04804000
*                                                                  1063 04805000
*WAITCK:                                                           1063 04806000
*   PROC OPTIONS(SAVE(REG14));      /*                       @G24LB26*/ 04807000
WAITCK   ST    @14,@SA00011                                        1063 04808000
*   WAITEXIT=OFF;                   /* ZERO EXIT SWITCH      @G24LB26*/ 04809000
*                                                                  1064 04810000
         NI    WAITEXIT,B'11111101'                                1064 04811000
*   /*****************************************************************/ 04812000
*   /*                                                               */ 04813000
*   /* DETERMINE IF UCB LOCATED FOR VOLUME UNDER             @G24LB26*/ 04814000
*   /* CONSIDERATION, AND IF THERE IS NO UCB ADDRESS,        @G24LB26*/ 04815000
*   /* MARK AS A WAIT VOLUME SINCE IT IS ASSUMED THAT THE    @G24LB26*/ 04816000
*   /* VOLUME IS IN THE PROCESS OF BEING MOUNTED             @G24LB26*/ 04817000
*   /* AND THERE IS NO WAY TO DETERMINE IF THE VOLUME        @G24LB26*/ 04818000
*   /* IS GOING TO BE MOUNTED EXCLUSIVELY OR FOR SHARED      @G24LB26*/ 04819000
*   /* USE. THERE FOR, THE WORST CASE IS ASSUMED.            @G24LB26*/ 04820000
*   /*                                                               */ 04821000
*   /*****************************************************************/ 04822000
*                                                                  1065 04823000
*   IF UCBADDR=ZEROPTR THEN         /*                       @G24LB26*/ 04824000
         L     @04,UCBADDR                                         1065 04825000
         LTR   @04,@04                                             1065 04826000
         BNZ   @RF01065                                            1065 04827000
*     BFWAITFL(INDXBFTB)=ON;        /*                       @G24LB26*/ 04828000
*                                                                  1066 04829000
         LR    @04,INDXBFTB                                        1066 04830000
         MH    @04,@CH02240                                        1066 04831000
         L     @01,BFTBLPTR                                        1066 04832000
         ALR   @01,@04                                             1066 04833000
         OI    BFWAITFL-18(@01),B'01000000'                        1066 04834000
*   /*****************************************************************/ 04835000
*   /*                                                               */ 04836000
*   /* IF VOLUME IS NOT ALREADY MARKED AS A WAIT VOLUME,     @G24LB26*/ 04837000
*   /* CHECK UCB SHAREABILITY AND EXCLUSIVE REQUEST STATUS   @G24LB26*/ 04838000
*   /* IF THERE ARE ANY USERS. IF UCB IS NON-SHARABLE OR     @G24LB26*/ 04839000
*   /* REQUEST IS FOR EXCLUSIVE USE, TURN ON WAIT FLAG.      @G24LB26*/ 04840000
*   /*                                                               */ 04841000
*   /*****************************************************************/ 04842000
*                                                                  1067 04843000
*   IF BFWAITFL(INDXBFTB)=OFF THEN  /*                       @G24LB26*/ 04844000
@RF01065 L     @04,BFTBLPTR                                        1067 04845000
         LR    @15,INDXBFTB                                        1067 04846000
         MH    @15,@CH02240                                        1067 04847000
         ALR   @15,@04                                             1067 04848000
         TM    BFWAITFL-18(@15),B'01000000'                        1067 04849000
         BNZ   @RF01067                                            1067 04850000
*     IF UCBUSER^=ZERO&(UCBBSVL=ON|BFNSHRFL=ON) THEN/*       @G24LB26*/ 04851000
         L     @15,UCBPTR                                          1068 04852000
         CLI   UCBUSER(@15),0                                      1068 04853000
         BE    @RF01068                                            1068 04854000
         TM    UCBBSVL(@15),B'10000000'                            1068 04855000
         BO    @RT01068                                            1068 04856000
         TM    BFNSHRFL(@04),B'10000000'                           1068 04857000
         BNO   @RF01068                                            1068 04858000
@RT01068 DS    0H                                                  1069 04859000
*       BFWAITFL(INDXBFTB)=ON;      /*                       @G24LB26*/ 04860000
*                                                                  1069 04861000
         LR    @04,INDXBFTB                                        1069 04862000
         MH    @04,@CH02240                                        1069 04863000
         L     @01,BFTBLPTR                                        1069 04864000
         ALR   @01,@04                                             1069 04865000
         OI    BFWAITFL-18(@01),B'01000000'                        1069 04866000
*   /*****************************************************************/ 04867000
*   /*                                                               */ 04868000
*   /* IF VOLUME IS NOT YET MARKED AS A WAIT VOLUME AND      @G24LB26*/ 04869000
*   /* THE REQUEST SPECIFIED A SPECIFIC UNIT ADDRESS,        @G24LB26*/ 04870000
*   /* THEN CHECK ITS CURRENT UNIT LOCATION.                 @G24LB26*/ 04871000
*   /*                                                               */ 04872000
*   /*****************************************************************/ 04873000
*                                                                  1070 04874000
*   IF BFWAITFL(INDXBFTB)=OFF&SELUCBAD^=ZEROPTR THEN/*       @G24LB26*/ 04875000
*                                                                  1070 04876000
@RF01068 DS    0H                                                  1070 04877000
@RF01067 L     @04,BFTBLPTR                                        1070 04878000
         LR    @15,INDXBFTB                                        1070 04879000
         MH    @15,@CH02240                                        1070 04880000
         ST    @15,@TF00001                                        1070 04881000
         ALR   @15,@04                                             1070 04882000
         TM    BFWAITFL-18(@15),B'01000000'                        1070 04883000
         BNZ   @RF01070                                            1070 04884000
         L     @15,SELUCBAD(,SELTMPTR)                             1070 04885000
         LTR   @15,@15                                             1070 04886000
         BZ    @RF01070                                            1070 04887000
*     /***************************************************************/ 04888000
*     /*                                                             */ 04889000
*     /* IF VOLUME IS NOT CURRENTLY MOUNTED ON THE UNIT      @G24LB26*/ 04890000
*     /* REQUESTED, IT IS A WAIT VOLUME.                     @G24LB26*/ 04891000
*     /*                                                             */ 04892000
*     /***************************************************************/ 04893000
*                                                                  1071 04894000
*     IF UCBADDR^=SELUCBAD THEN     /*                       @G24LB26*/ 04895000
         C     @15,UCBADDR                                         1071 04896000
         BE    @RF01071                                            1071 04897000
*       BFWAITFL(INDXBFTB)=ON;      /* INDICATES WAIT VOL    @G24LB26*/ 04898000
*                                                                  1072 04899000
         AL    @04,@TF00001                                        1072 04900000
         OI    BFWAITFL-18(@04),B'01000000'                        1072 04901000
*   /*****************************************************************/ 04902000
*   /*                                                               */ 04903000
*   /* IF IT IS ON THE REQUESTED UNIT, INDICATE THAT         @G24LB26*/ 04904000
*   /* NO MORE CHECKS ARE NECESSARY.                         @G24LB26*/ 04905000
*   /*                                                               */ 04906000
*   /*****************************************************************/ 04907000
*                                                                  1073 04908000
*     ELSE                          /*                       @G24LB26*/ 04909000
*       WAITEXIT=ON;                /* GET TO END OF PROC    @G24LB26*/ 04910000
*                                                                  1073 04911000
         B     @RC01071                                            1073 04912000
@RF01071 OI    WAITEXIT,B'00000010'                                1073 04913000
*   /*****************************************************************/ 04914000
*   /*                                                               */ 04915000
*   /* IF VOLUME IS NOT MARKED WAIT YET AND REMAINING        @G24LB26*/ 04916000
*   /* CHECKS ARE REQUIRED, THEN CHECK TO DETERMINE IF AN    @G24LB26*/ 04917000
*   /* ESOTERIC OF OTHER THAN '3330V' WAS SPECIFIED.         @G24LB26*/ 04918000
*   /*                                                               */ 04919000
*   /*****************************************************************/ 04920000
*                                                                  1074 04921000
*   IF BFWAITFL(INDXBFTB)=OFF&WAITEXIT=OFF THEN/*            @G24LB26*/ 04922000
*                                                                  1074 04923000
@RC01071 DS    0H                                                  1074 04924000
@RF01070 LR    @04,INDXBFTB                                        1074 04925000
         MH    @04,@CH02240                                        1074 04926000
         L     @01,BFTBLPTR                                        1074 04927000
         ALR   @01,@04                                             1074 04928000
         TM    BFWAITFL-18(@01),B'01000000'                        1074 04929000
         BNZ   @RF01074                                            1074 04930000
         TM    WAITEXIT,B'00000010'                                1074 04931000
         BNZ   @RF01074                                            1074 04932000
*     /***************************************************************/ 04933000
*     /*                                                             */ 04934000
*     /* CHECK DEVICE TYPE OF REQUEST.                       @G24LB26*/ 04935000
*     /*                                                             */ 04936000
*     /***************************************************************/ 04937000
*                                                                  1075 04938000
*     IF SELDEVTP^=DEV3330V THEN    /*                       @G24LB26*/ 04939000
         CLC   SELDEVTP(4,SELTMPTR),DEV3330V                       1075 04940000
         BE    @RF01075                                            1075 04941000
*       DO;                         /*                       @G24LB26*/ 04942000
*                                                                  1076 04943000
*         /***********************************************************/ 04944000
*         /*                                                         */ 04945000
*         /* IF '3330V' DEVICE TYPE WAS NOT SPECIFED,        @G24LB26*/ 04946000
*         /* SET UP PARAMETER LIST TO CALL UNIT PROCESSOR    @G24LB26*/ 04947000
*         /* TO DETERMINE IF THE UNIT VOLUME IS MOUNTED      @G24LB26*/ 04948000
*         /* ON FALLS WITHIN ESOTERIC SPECIFIED.             @G24LB26*/ 04949000
*         /*                                                         */ 04950000
*         /***********************************************************/ 04951000
*                                                                  1077 04952000
*         UNITP=UNITP&&UNITP;       /* CLEAR PARM LIST AREA  @G24LB26*/ 04953000
         LA    @04,STRUNITP                                        1077 04954000
         XC    UNITP(17,@04),UNITP(@04)                            1077 04955000
*         UNIDEVTP=SELDEVTP;        /* DEVICE TYPE OF REQUEST      1078 04956000
*                                                            @G24LB26*/ 04957000
         MVC   UNIDEVTP(4,@04),SELDEVTP(SELTMPTR)                  1078 04958000
*         UNIUCBP=UCBADDR;          /* UCB ADDR WHERE VOLUME @G24LB26   04959000
*                                      IS MOUNTED            @G24LB26*/ 04960000
         L     @15,UCBADDR                                         1079 04961000
         ST    @15,UNIUCBP(,@04)                                   1079 04962000
*         UNIFINCL=ON;              /* INDICATE INCLUDED     @G24LB26   04963000
*                                      TYPE CHECK            @G24LB26*/ 04964000
         OI    UNIFINCL(@04),B'01000000'                           1080 04965000
*         RESPECIFY                                                1081 04966000
*           REG15 RSTD;             /*                       @G24LB26*/ 04967000
*         CALL ICBVUP00(UNITP,VVICB);/*                      @G24LB26*/ 04968000
*                                                                  1082 04969000
         ST    @04,@AL00001                                        1082 04970000
         L     @14,VVIPTR                                          1082 04971000
         ST    @14,@AL00001+4                                      1082 04972000
         L     @15,@CV01913                                        1082 04973000
         LA    @01,@AL00001                                        1082 04974000
         BALR  @14,@15                                             1082 04975000
*         /***********************************************************/ 04976000
*         /*                                                         */ 04977000
*         /* CHECK RETURN CODE FROM UNIT PROCESSOR AND IF    @G24LB26*/ 04978000
*         /* NOT ZERO, VOLUME IS A WAIT BECAUSE UNIT DID NOT @G24LB26*/ 04979000
*         /* FALL WITHIN ESOTERIC.                           @G24LB26*/ 04980000
*         /*                                                         */ 04981000
*         /***********************************************************/ 04982000
*                                                                  1083 04983000
*         IF REG15^=RCZERO THEN     /*                       @G24LB26*/ 04984000
         LTR   REG15,REG15                                         1083 04985000
         BZ    @RF01083                                            1083 04986000
*           BFWAITFL(INDXBFTB)=ON;  /*                       @G24LB26*/ 04987000
         LR    @14,INDXBFTB                                        1084 04988000
         MH    @14,@CH02240                                        1084 04989000
         L     @04,BFTBLPTR                                        1084 04990000
         ALR   @04,@14                                             1084 04991000
         OI    BFWAITFL-18(@04),B'01000000'                        1084 04992000
*         RESPECIFY                                                1085 04993000
*           REG15 UNRSTD;           /*                       @G24LB26*/ 04994000
@RF01083 DS    0H                                                  1086 04995000
*       END;                        /*                       @G24LB26*/ 04996000
*                                                                  1086 04997000
*   /*****************************************************************/ 04998000
*   /*                                                               */ 04999000
*   /* SET ZERO RETURN CODE                                  @G24LB26*/ 05000000
*   /*                                                               */ 05001000
*   /*****************************************************************/ 05002000
*                                                                  1087 05003000
*   INTERCC=RCZERO;                 /*                       @G24LB26*/ 05004000
@RF01075 DS    0H                                                  1087 05005000
@RF01074 MVC   INTERCC(2),@CB02111                                 1087 05006000
*   RETURN;                         /*                       @G24LB26*/ 05007000
@EL00011 DS    0H                                                  1088 05008000
@EF00011 DS    0H                                                  1088 05009000
@ER00011 L     @14,@SA00011                                        1088 05010000
         BR    @14                                                 1088 05011000
*   END WAITCK;                     /*                       @G24LB26*/ 05012000
*                                                                  1090 05013000
*/*********************************************************  @G24LB26*/ 05014000
*/*                                                          @G24LB26*/ 05015000
*/* PROCEDURE NAME - CONUSER                                 @G24LB26*/ 05016000
*/*                                                          @G24LB26*/ 05017000
*/* FUNCTION - ROUTINE GETS THE CONCURRENT USERS FROM THE    @G24LB26*/ 05018000
*/*            UCB IF THE UNIT PROCESSOR LOCATED A UCB FOR   @G24LB26*/ 05019000
*/*            THE VOLUME. IF A UCB WAS NOT LOCATED, SINCE   @G24LB26*/ 05020000
*/*            VOLUME IS INDICATED AS BEING MOUNTED BY THE   @G24LB26*/ 05021000
*/*            MSVI RECORDS, ONE CONCURRENT USER IS ASSUMED. @G24LB26*/ 05022000
*/*                                                          @G24LB26*/ 05023000
*/* INPUT - THE ROUTINE ONLY GETS CALLED IF MSVI RECORDS     @G24LB26*/ 05024000
*/*         INDICATE VOLUME IS MOUNTED TO THIS HOST. IT      @G24LB26*/ 05025000
*/*         USES THE UCB ADDRESS IN THE INTERNAL WORK AREA   @G24LB26*/ 05026000
*/*         IF UCB EXISTS.  IT THEN USES THE UCBUSER FIELD   @G24LB26*/ 05027000
*/*         IN THE UCB TO RETRIEVE CONCURRENT USERS. ALSO    @G24LB26*/ 05028000
*/*         NEEDS THE CURRENT INDEX INTO THE BEST FIT TABLE. @G24LB26*/ 05029000
*/*                                                          @G24LB26*/ 05030000
*/* OUTPUT - PUTS CONCURRENT USERS INTO THE BEST FIT TABLE   @G24LB26*/ 05031000
*/*          FOR VOLUME CURRENTLY BEING PROCESSED.           @G24LB26*/ 05032000
*/*                                                          @G24LB26*/ 05033000
*/*********************************************************  @G24LB26*/ 05034000
*                                                                  1090 05035000
*CONUSER:                                                          1090 05036000
*   PROC OPTIONS(SAVE(REG14));      /*                       @G24LB26*/ 05037000
*                                                                  1090 05038000
CONUSER  ST    @14,12(,@13)                                        1090 05039000
*   /*****************************************************************/ 05040000
*   /*                                                               */ 05041000
*   /* IF THE UCB FOR THIS VOLUME COULD NOT BE LOCATED,      @G24LB26*/ 05042000
*   /* ASSUME ONE USER AND EXIT THIS PROCEDURE.              @G24LB26*/ 05043000
*   /*                                                               */ 05044000
*   /*****************************************************************/ 05045000
*                                                                  1091 05046000
*   IF UCBADDR=ZEROPTR THEN         /*                       @G24LB26*/ 05047000
         L     @04,UCBADDR                                         1091 05048000
         LTR   @04,@04                                             1091 05049000
         BNZ   @RF01091                                            1091 05050000
*     BFCONUSE(INDXBFTB)=ONE;       /*                       @G24LB26*/ 05051000
*                                                                  1092 05052000
         LR    @04,INDXBFTB                                        1092 05053000
         MH    @04,@CH02240                                        1092 05054000
         LA    @15,1                                               1092 05055000
         L     @14,BFTBLPTR                                        1092 05056000
         STC   @15,BFCONUSE-18(@04,@14)                            1092 05057000
*   /*****************************************************************/ 05058000
*   /*                                                               */ 05059000
*   /* OTHERWISE TAKE USER COUNT FROM UCB FOR THE NUMBER     @G24LB26*/ 05060000
*   /* OF USERS.                                             @G24LB26*/ 05061000
*   /*                                                               */ 05062000
*   /*****************************************************************/ 05063000
*                                                                  1093 05064000
*   ELSE                            /*                       @G24LB26*/ 05065000
*     BFCONUSE(INDXBFTB)=UCBUSER;   /*                       @G24LB26*/ 05066000
         B     @RC01091                                            1093 05067000
@RF01091 LR    @04,INDXBFTB                                        1093 05068000
         MH    @04,@CH02240                                        1093 05069000
         L     @01,UCBPTR                                          1093 05070000
         SLR   @00,@00                                             1093 05071000
         IC    @00,UCBUSER(,@01)                                   1093 05072000
         L     @01,BFTBLPTR                                        1093 05073000
         STC   @00,BFCONUSE-18(@04,@01)                            1093 05074000
*   RETURN;                         /*                       @G24LB26*/ 05075000
@EL00012 DS    0H                                                  1094 05076000
@EF00012 DS    0H                                                  1094 05077000
@ER00012 L     @14,12(,@13)                                        1094 05078000
         BR    @14                                                 1094 05079000
*   END CONUSER;                    /*                       @G24LB26*/ 05080000
         B     @EL00012                                            1095 05081000
*                                                                  1096 05082000
*/*********************************************************  @G24LB26*/ 05083000
*/*                                                          @G24LB26*/ 05084000
*/* PROCEDURE NAME - FINSELCT                                @G24LB26*/ 05085000
*/*                                                          @G24LB26*/ 05086000
*/* FUNCTION - USES THE BEST FIT TABLE ENTRIES AND CALLS     @G24LB26*/ 05087000
*/*            THE SORT ROUTINE TO SORT THE VOLUMES IN       @G24LB26*/ 05088000
*/*            ORDER FROM BEST FIT TO WORST FIT. THIS IS     @G24LB26*/ 05089000
*/*            ACCOMPLISHED BY SORTING ON FIELDS AND FLAGS   @G24LB26*/ 05090000
*/*            REPRESENTING THE CURRENT STATUS OF THE        @G24LB26*/ 05091000
*/*            VOLUME. THE FIRST FIELD SORTED ON IS A        @G24LB26*/ 05092000
*/*            BIT REPRESENTING WHETHER VOLUME IS HIGH       @G24LB26*/ 05093000
*/*            RISK OR NOT. IF FLAG IS ON, VOLUME IS         @G24LB26*/ 05094000
*/*            HIGH RISK AND WILL GO TO THE BOTTOM OF THE    @G24LB26*/ 05095000
*/*            LIST. THE NEXT FIELD THE WAIT FLAG. IF ON,    @G24LB26*/ 05096000
*/*            VOLUME IS WAIT AND WILL GO TO THE BOTTOM      @G24LB26*/ 05097000
*/*            OF THE NON-HIGH RISK OR BOTTOM OF THE HIGH    @G24LB26*/ 05098000
*/*            RISK DEPENDING ON THE RISK STATUS. THIS       @G24LB26*/ 05099000
*/*            TYPE OF STRATIFICATION WILL CONTINUE AS THE   @G24LB26*/ 05100000
*/*            LOWER PRIORITY FIELDS ARE TAKEN INTO          @G24LB26*/ 05101000
*/*            ACCOUNT. THE REMAINING FIELDS SORTED ON IN    @G24LB26*/ 05102000
*/*            ORDER OF PRIORITY ARE NUMBER OF CONCURRENT    @G24LB26*/ 05103000
*/*            USERS IF OVER MAXIMUM, VOLUME EXPIRATION DATE @G24LB26*/ 05104000
*/*            IN PACKED DECIMAL, SHAREABILITY CONFLICTS     @G24LB26*/ 05105000
*/*            FLAG, NOT MOUNTED FLAG, MOUNTED ONLY TO       @G24LB26*/ 05106000
*/*            ANOTHER HOST FLAG AND NUMBER OF CONCURRENT    @G24LB26*/ 05107000
*/*            USERS FIELD. WHEN THE SORTING IS COMPLETE,    @G24LB26*/ 05108000
*/*            THE ROUTINE CHOOSES THE BEST VOLUME FOR THIS  @G24LB26*/ 05109000
*/*            REQUEST AS A PRIMARY, AND IF MORE THAN ONE    @G24LB26*/ 05110000
*/*            VOLUME IS REQUESTED, IT CHOOSES THE NEXT BEST @G24LB26*/ 05111000
*/*            VOLUME FOR THE FIRST SECONDARY, ETC. IN       @G24LB26*/ 05112000
*/*            ADDITION TO THE ABOVE DESCRIBED PROCEDURE, IN @G24LB26*/ 05113000
*/*            VS/2 THE ROUTINE ALSO CALLS A PROCEDURE TO    @G24LB26*/ 05114000
*/*            CHECK ON THE ENQUEUE STATUS OF THE VOLUME.    @G24LB26*/ 05115000
*/*            IF THE VOLUME IS ENQUEUED, THEN THE WAIT      @G24LB26*/ 05116000
*/*            INDICATION FLAG IS TURNED ON AND THE BEST     @G24LB26*/ 05117000
*/*            FIT TABLE IS RE-SORTED. IF THE TEST ENQ       @G24LB26*/ 05118000
*/*            DETERMINES THAT THE VOLUME IS NOT AVAILABLE   @G24LB26*/ 05119000
*/*            FOR USE, IT IS MARKED INELIGIBLE AND THE NEXT @G24LB26*/ 05120000
*/*            VOLUME IN THE TABLE IS PROCESSED. ONCE A      @G24LB26*/ 05121000
*/*            VOLUME IS FOUND THAT IS EITHER ALREADY A      @G24LB26*/ 05122000
*/*            WAIT VOLUME, OR IS NOT ENQUEUED, A ROUTINE    @G24LB26*/ 05123000
*/*            IS CALLED TO DETERMINE IF THE VOLUME IS       @G24LB26*/ 05124000
*/*            APPROVED FOR SELECTION BY JES3. IF THE VOLUME @G24LB26*/ 05125000
*/*            IS NOT APPROVED BY JES3, THE VOLUME IS NOT A  @G24LB26*/ 05126000
*/*            CANDIDATE AND THE NEXT VOLUME IN THE BEST     @G24LB26*/ 05127000
*/*            FIT TABLE IS PROCESSED. IF THE VOLUME IS      @G24LB26*/ 05128000
*/*            APPROVED FOR SELECTION BY JES3, THE VOLUME    @G24LB26*/ 05129000
*/*            IS SELECTED. THIS PROCESS CONTINUES UNTIL     @G24LB26*/ 05130000
*/*            ALL REQUESTED VOLUMES ARE SELECTED, OR UNTIL  @G24LB26*/ 05131000
*/*            END OF THE BEST FIT TABLE IS REACHED. IF THE  @G24LB26*/ 05132000
*/*            END OF THE TABLE IS ENCOUNTERED BEFORE ALL    @G24LB26*/ 05133000
*/*            REQUESTED VOLUMES HAVE BEEN SELECTED, THE     @G24LB26*/ 05134000
*/*            REQUEST FAILS. ALSO A FLAG IS CHECKED IN      @G24LB26*/ 05135000
*/*            VS/2 TO DETERMINE IF THE REQUEST CAN WAIT     @G24LB26*/ 05136000
*/*            OR NOT FOR THE VOLUME SELECTED. IF IT CANNOT, @G24LB26*/ 05137000
*/*            ANY VOLUME WITH THE WAIT FLAG ON IS NOT A     @G24LB26*/ 05138000
*/*            CANDIDATE, INCLUDING VOLUMES ENQUEUED.        @G24LB26*/ 05139000
*/*                                                          @G24LB26*/ 05140000
*/* INPUT - BEST FIT TABLE WITH ALL ELIGIBLE VOLUMES IN IT   @G24LB26*/ 05141000
*/*         AND EACH ENTRY COMPLETED. SELECT REQUEST BLOCK.  @G24LB26*/ 05142000
*/*         NUMBER OF VOLUMES TO BE SELECTED FOR THIS        @G24LB26*/ 05143000
*/*         REQUEST.                                         @G24LB26*/ 05144000
*/*                                                          @G24LB26*/ 05145000
*/* OUTPUT - SELECTED VOLUMES IN THE VOLUME RETURN AREA OF   @G24LB26*/ 05146000
*/*          THE RPLV OR IF THE REQUESTED NUMBER OF VOLUMES  @G24LB26*/ 05147000
*/*          COULD NOT BE SELECTED, A MESSAGE, ICB407I WILL  @G24LB26*/ 05148000
*/*          BE ISSUED ALONG WITH A REASON CODE OF HEX 232   @G24LB26*/ 05149000
*/*          AND A RETURN CODE OF 4. IF REQUEST WAS          @G24LB26*/ 05150000
*/*          SUCCESSFUL, A ZERO REASON AND RETURN CODE WILL  @G24LB26*/ 05151000
*/*          BE RETURNED IN THE RPLV.                        @G24LB26*/ 05152000
*/*                                                          @G24LB26*/ 05153000
*/*********************************************************  @G24LB26*/ 05154000
*                                                                  1096 05155000
*FINSELCT:                                                         1096 05156000
*   PROC OPTIONS(SAVE(REG14));      /*                       @G24LB26*/ 05157000
FINSELCT ST    @14,@SA00013                                        1096 05158000
*   NUMCHOS=ZERO;                   /* ZERO VOLUMES CHOSEN   @G24LB26*/ 05159000
         MVI   NUMCHOS,X'00'                                       1097 05160000
*   VOLNUM=ZERO;                    /* INDICATE NO VOLUMES   @G24LB26   05161000
*                                      IN VOLUME RETURN AREA @G24LB26*/ 05162000
*                                                                  1098 05163000
         L     @08,SELVLRET(,SELTMPTR)                             1098 05164000
         SLR   @06,@06                                             1098 05165000
         STH   @06,VOLNUM(,@08)                                    1098 05166000
*   /*****************************************************************/ 05167000
*   /*                                                               */ 05168000
*   /* IF REQUEST CANNOT WAIT FOR THE SELECTED VOLUME,       @G24LB26*/ 05169000
*   /* ELIMINATE ALL VOLUMES IN THE BEST FIT TABLE THAT      @G24LB26*/ 05170000
*   /* ARE ALREADY WAIT VOLUMES.                             @G24LB26*/ 05171000
*   /*                                                               */ 05172000
*   /*****************************************************************/ 05173000
*                                                                  1099 05174000
*   IF SELCNTWT=ON THEN             /*                       @G24LB26*/ 05175000
         TM    SELCNTWT(SELTMPTR),B'00001000'                      1099 05176000
         BNO   @RF01099                                            1099 05177000
*     DO INDXBFTB=ONE TO BFTOTIDX;  /*                       @G24LB26*/ 05178000
         LA    INDXBFTB,1                                          1100 05179000
         B     @DE01100                                            1100 05180000
@DL01100 DS    0H                                                  1101 05181000
*       IF BFWAITFL(INDXBFTB)=ON THEN/*                      @G24LB26*/ 05182000
         L     @08,BFTBLPTR                                        1101 05183000
         LR    @04,INDXBFTB                                        1101 05184000
         MH    @04,@CH02240                                        1101 05185000
         ST    @04,@TF00001                                        1101 05186000
         ALR   @04,@08                                             1101 05187000
         TM    BFWAITFL-18(@04),B'01000000'                        1101 05188000
         BNO   @RF01101                                            1101 05189000
*         BFVOLREJ(INDXBFTB)=ON;    /* VOL NOT ELIGIBLE      @G24LB26*/ 05190000
         AL    @08,@TF00001                                        1102 05191000
         OI    BFVOLREJ-18(@08),B'00000100'                        1102 05192000
*     END;                          /*                       @G24LB26*/ 05193000
*                                                                  1103 05194000
@RF01101 AL    INDXBFTB,@CF00043                                   1103 05195000
@DE01100 L     @08,BFTBLPTR                                        1103 05196000
         CH    INDXBFTB,BFTOTIDX(,@08)                             1103 05197000
         BNH   @DL01100                                            1103 05198000
*   /*****************************************************************/ 05199000
*   /*                                                               */ 05200000
*   /* SET UP PARAMETER LIST TO CALL SORT ROUTINE            @G24LB26*/ 05201000
*   /* TO SORT VOLUMES IN BEST FIT TABLE.                    @G24LB26*/ 05202000
*   /*                                                               */ 05203000
*   /*****************************************************************/ 05204000
*                                                                  1104 05205000
*   SRTADDR=ADDR(BFSLOT(ONE));      /* ADDR OF FIRST ENTRY   @G24LB26*/ 05206000
@RF01099 L     @08,BFTBLPTR                                        1104 05207000
         LA    @06,BFSLOT(,@08)                                    1104 05208000
         ST    @06,SRTADDR                                         1104 05209000
*   SRTNUM=BFTOTIDX;                /* NO OF ELEMENTS IN     @G24LB26   05210000
*                                      ARRAY                 @G24LB26*/ 05211000
         LH    @04,BFTOTIDX(,@08)                                  1105 05212000
         STH   @04,SRTNUM                                          1105 05213000
*   SRTLEN=LENGTH(BFSLOT);          /* LENGTH OF ONE         @G24LB26   05214000
*                                      ELEMENT               @G24LB26*/ 05215000
         MVC   SRTLEN(2),@CH02240                                  1106 05216000
*   SRTBEG=ADDR(BFHPFLGS(ONE))-ADDR(BFSLOT(ONE));/* START    @G24LB26   05217000
*                                      OF SORT FIELD         @G24LB26*/ 05218000
*                                                                  1107 05219000
         LA    @04,BFHPFLGS(,@08)                                  1107 05220000
         LCR   @06,@06                                             1107 05221000
         ALR   @06,@04                                             1107 05222000
         STH   @06,SRTBEG                                          1107 05223000
*   /*****************************************************************/ 05224000
*   /*                                                               */ 05225000
*   /* CHANGE SRTBEG FROM OFFSET TO COLUMN NUMBER            @G24LB26*/ 05226000
*   /*                                                               */ 05227000
*   /*****************************************************************/ 05228000
*                                                                  1108 05229000
*   SRTBEG=SRTBEG+ONE;              /* ADD ONE TO START COL  @G24LB26*/ 05230000
         LA    @15,1                                               1108 05231000
         ALR   @06,@15                                             1108 05232000
         STH   @06,SRTBEG                                          1108 05233000
*   SRTFLDLN=ADDR(BFMISCFL(ONE))-ADDR(BFHPFLGS(ONE));/*      @G24LB26   05234000
*                                      LENGTH OF SORT FIELD  @G24LB26*/ 05235000
         LA    @08,BFMISCFL(,@08)                                  1109 05236000
         SLR   @08,@04                                             1109 05237000
         STH   @08,SRTFLDLN                                        1109 05238000
*   RESORTSW=ON;                    /* SORT FIRST TIME THRU  @G24LB26*/ 05239000
*   FINEXIT=OFF;                    /* INITIALIZE LOOP       @G24LB26   05240000
*                                      CONTROL SWITCH        @G24LB26*/ 05241000
*                                                                  1111 05242000
         OI    RESORTSW,B'00010000'                                1111 05243000
         NI    FINEXIT,B'01111111'                                 1111 05244000
*   /*****************************************************************/ 05245000
*   /*                                                               */ 05246000
*   /* LOOP THRU BEST FIT TABLE UNTIL THE DESIRED            @G24LB26*/ 05247000
*   /* NUMBER OF VOLUMES HAVE BEEN SELECTED.                 @G24LB26*/ 05248000
*   /*                                                               */ 05249000
*   /*****************************************************************/ 05250000
*                                                                  1112 05251000
*   DO INDXBFTB=ONE TO BFTOTIDX WHILE FINEXIT=OFF;/*         @G24LB26*/ 05252000
*                                                                  1112 05253000
         LR    INDXBFTB,@15                                        1112 05254000
         B     @DE01112                                            1112 05255000
@DL01112 TM    FINEXIT,B'10000000'                                 1112 05256000
         BNZ   @DC01112                                            1112 05257000
*     /***************************************************************/ 05258000
*     /*                                                             */ 05259000
*     /* DETERMINE IF BEST FIT TABLE MUST BE SORTED          @G24LB26*/ 05260000
*     /*                                                             */ 05261000
*     /***************************************************************/ 05262000
*                                                                  1113 05263000
*     IF RESORTSW=ON THEN           /*                       @G24LB26*/ 05264000
         TM    RESORTSW,B'00010000'                                1113 05265000
         BNO   @RF01113                                            1113 05266000
*       DO;                         /*                       @G24LB26*/ 05267000
*         CALL SORT;                /* SORT BEST FIT TABLE   @G24LB26*/ 05268000
         BAL   @14,SORT                                            1115 05269000
*         RESORTSW=OFF;             /* INDICATE SORT DONE    @G24LB26*/ 05270000
         NI    RESORTSW,B'11101111'                                1116 05271000
*       END;                        /*                       @G24LB26*/ 05272000
*                                                                  1117 05273000
*     /***************************************************************/ 05274000
*     /*                                                             */ 05275000
*     /* DETERMINE IF VOLUME IS ELIGIBLE FOR EITHER PRIMARY  @G24LB26*/ 05276000
*     /* OR SECONDARY SELECTION                              @G24LB26*/ 05277000
*     /*                                                             */ 05278000
*     /***************************************************************/ 05279000
*                                                                  1118 05280000
*     IF BFVOLREJ(INDXBFTB)=OFF&    /*                       @G24LB26*/ 05281000
*         ((NUMCHOS=ZERO&BFBADPRI(INDXBFTB)=OFF)|/*          @G24LB26*/ 05282000
*         (NUMCHOS>ZERO&BFBADSEC(INDXBFTB)=OFF&/*            @G24LB26*/ 05283000
*         BFSELSEC(INDXBFTB)=OFF)) THEN/*                    @G24LB26*/ 05284000
@RF01113 L     @08,BFTBLPTR                                        1118 05285000
         LR    @04,INDXBFTB                                        1118 05286000
         MH    @04,@CH02240                                        1118 05287000
         ST    @04,@TF00001                                        1118 05288000
         ALR   @04,@08                                             1118 05289000
         TM    BFVOLREJ-18(@04),B'00000100'                        1118 05290000
         BNZ   @RF01118                                            1118 05291000
         CLI   NUMCHOS,0                                           1118 05292000
         BNE   @GL00053                                            1118 05293000
         AL    @08,@TF00001                                        1118 05294000
         TM    BFBADPRI-18(@08),B'10000000'                        1118 05295000
         BZ    @RT01118                                            1118 05296000
@GL00053 CLI   NUMCHOS,0                                           1118 05297000
         BNH   @RF01118                                            1118 05298000
         LR    @08,INDXBFTB                                        1118 05299000
         MH    @08,@CH02240                                        1118 05300000
         L     @04,BFTBLPTR                                        1118 05301000
         ALR   @04,@08                                             1118 05302000
         TM    BFBADSEC-18(@04),B'01010000'                        1118 05303000
         BNZ   @RF01118                                            1118 05304000
@RT01118 DS    0H                                                  1119 05305000
*       DO;                         /*                       @G24LB26*/ 05306000
*                                                                  1119 05307000
*         /***********************************************************/ 05308000
*         /*                                                         */ 05309000
*         /* CALL ROUTINE TO DETERMINE IF VOLUME IS ENQUEUED @G24LB26*/ 05310000
*         /* UNLESS TEST ENQ HAS ALREADY BEEN DONE ON THIS   @G24LB26*/ 05311000
*         /* VOLUME.                                         @G24LB26*/ 05312000
*         /*                                                         */ 05313000
*         /***********************************************************/ 05314000
*                                                                  1120 05315000
*         IF BFNOENQ(INDXBFTB)=OFF& /*                       @G24LB26*/ 05316000
*             BFENQUED(INDXBFTB)=OFF THEN/*                  @G24LB26*/ 05317000
         LR    @08,INDXBFTB                                        1120 05318000
         MH    @08,@CH02240                                        1120 05319000
         L     @04,BFTBLPTR                                        1120 05320000
         ALR   @04,@08                                             1120 05321000
         TM    BFNOENQ-18(@04),B'00000011'                         1120 05322000
         BNZ   @RF01120                                            1120 05323000
*           DO;                     /*                       @G24LB26*/ 05324000
*             CALL TESTENQ;         /*                       @G24LB26*/ 05325000
*                                                                  1122 05326000
         BAL   @14,TESTENQ                                         1122 05327000
*             /*******************************************************/ 05328000
*             /*                                                     */ 05329000
*             /* CHECK RETURN CODE FROM ENQUEUE ROUTINE      @G24LB26*/ 05330000
*             /*                                                     */ 05331000
*             /*******************************************************/ 05332000
*                                                                  1123 05333000
*             IF INTERCC=RCZERO THEN/*                       @G24LB26*/ 05334000
         CLC   INTERCC(2),@CB02111                                 1123 05335000
         BNE   @RF01123                                            1123 05336000
*               BFNOENQ(INDXBFTB)=ON;/* VOL IS NOT ENQUEUED  @G24LB26*/ 05337000
*                                                                  1124 05338000
         LR    @08,INDXBFTB                                        1124 05339000
         MH    @08,@CH02240                                        1124 05340000
         L     @04,BFTBLPTR                                        1124 05341000
         ALR   @04,@08                                             1124 05342000
         OI    BFNOENQ-18(@04),B'00000010'                         1124 05343000
*             /*******************************************************/ 05344000
*             /*                                                     */ 05345000
*             /* VOLUME IS ENQUEUED OR NOT ELIGIBLE          @G24LB26*/ 05346000
*             /*                                                     */ 05347000
*             /*******************************************************/ 05348000
*                                                                  1125 05349000
*             ELSE                  /*                       @G24LB26*/ 05350000
*                                                                  1125 05351000
*               /*****************************************************/ 05352000
*               /*                                                   */ 05353000
*               /* CHECK IF VOLUME IS ENQUEUED               @G24LB26*/ 05354000
*               /*                                                   */ 05355000
*               /*****************************************************/ 05356000
*                                                                  1125 05357000
*               IF INTERCC=RCFOUR THEN/*                     @G24LB26*/ 05358000
         B     @RC01123                                            1125 05359000
@RF01123 CLC   INTERCC(2),@CB02113                                 1125 05360000
         BNE   @RF01125                                            1125 05361000
*                 DO;               /*                       @G24LB26*/ 05362000
*                                                                  1126 05363000
*                   /*************************************************/ 05364000
*                   /*                                               */ 05365000
*                   /* INDICATE VOLUME IS ENQUEUED           @G24LB26*/ 05366000
*                   /*                                               */ 05367000
*                   /*************************************************/ 05368000
*                                                                  1127 05369000
*                   BFENQUED(INDXBFTB)=ON;/*                 @G24LB26*/ 05370000
*                                                                  1127 05371000
         L     @08,BFTBLPTR                                        1127 05372000
         LR    @04,INDXBFTB                                        1127 05373000
         MH    @04,@CH02240                                        1127 05374000
         ST    @04,@TF00001                                        1127 05375000
         ALR   @04,@08                                             1127 05376000
         OI    BFENQUED-18(@04),B'00000001'                        1127 05377000
*                   /*************************************************/ 05378000
*                   /*                                               */ 05379000
*                   /* CHECK TO SEE IF VOLUME IS STILL       @G24LB26*/ 05380000
*                   /* ELIGIBLE                              @G24LB26*/ 05381000
*                   /*                                               */ 05382000
*                   /*************************************************/ 05383000
*                                                                  1128 05384000
*                   IF SELCNTWT=ON THEN/*                    @G24LB26*/ 05385000
         TM    SELCNTWT(SELTMPTR),B'00001000'                      1128 05386000
         BNO   @RF01128                                            1128 05387000
*                     BFVOLREJ(INDXBFTB)=ON;/*               @G24LB26*/ 05388000
*                                                                  1129 05389000
         AL    @08,@TF00001                                        1129 05390000
         OI    BFVOLREJ-18(@08),B'00000100'                        1129 05391000
*                   /*************************************************/ 05392000
*                   /*                                               */ 05393000
*                   /* VOLUME IS A WAIT VOLUME AND IS STILL  @G24LB26*/ 05394000
*                   /* ELIGIBLE, BUT STATUS MAY HAVE CHANGED @G24LB26*/ 05395000
*                   /*                                               */ 05396000
*                   /*************************************************/ 05397000
*                                                                  1130 05398000
*                   ELSE            /*                       @G24LB26*/ 05399000
*                     IF BFWAITFL(INDXBFTB)=OFF THEN/*       @G24LB26*/ 05400000
*                                                                  1130 05401000
         B     @RC01128                                            1130 05402000
@RF01128 LR    @08,INDXBFTB                                        1130 05403000
         MH    @08,@CH02240                                        1130 05404000
         L     @04,BFTBLPTR                                        1130 05405000
         ALR   @04,@08                                             1130 05406000
         TM    BFWAITFL-18(@04),B'01000000'                        1130 05407000
         BNZ   @RF01130                                            1130 05408000
*                       /*********************************************/ 05409000
*                       /*                                           */ 05410000
*                       /* INDICATE BEST FIT TABLE WILL BE   @G24LB26*/ 05411000
*                       /* RE-SORTED, STATUS CHANGED         @G24LB26*/ 05412000
*                       /*                                           */ 05413000
*                       /*********************************************/ 05414000
*                                                                  1131 05415000
*                       RESORTSW=ON;/* RE-SORT TABLE         @G24LB26*/ 05416000
         OI    RESORTSW,B'00010000'                                1131 05417000
*                   BFWAITFL(INDXBFTB)=ON;/* TURN ON WAIT FLAG     1132 05418000
*                                                            @G24LB26*/ 05419000
*                                                                  1132 05420000
@RF01130 DS    0H                                                  1132 05421000
@RC01128 LR    @08,INDXBFTB                                        1132 05422000
         MH    @08,@CH02240                                        1132 05423000
         L     @04,BFTBLPTR                                        1132 05424000
         ALR   @04,@08                                             1132 05425000
         OI    BFWAITFL-18(@04),B'01000000'                        1132 05426000
*                   /*************************************************/ 05427000
*                   /*                                               */ 05428000
*                   /* DETERMINE IF RESORTING AND THEREFORE  @G24LB26*/ 05429000
*                   /* NEED TO START AT TOP OF TABLE         @G24LB26*/ 05430000
*                   /*                                               */ 05431000
*                   /*************************************************/ 05432000
*                                                                  1133 05433000
*                   IF RESORTSW=ON THEN/*                    @G24LB26*/ 05434000
         TM    RESORTSW,B'00010000'                                1133 05435000
         BNO   @RF01133                                            1133 05436000
*                     INDXBFTB=ZERO;/* LOOP BACK TO TOP      @G24LB26   05437000
*                                      OF BEST FIT TABLE     @G24LB26*/ 05438000
         SLR   INDXBFTB,INDXBFTB                                   1134 05439000
*                 END;              /*                       @G24LB26*/ 05440000
*                                                                  1135 05441000
*             /*******************************************************/ 05442000
*             /*                                                     */ 05443000
*             /* VOLUME IS NOT AVAILABLE FOR USE AT          @G24LB26*/ 05444000
*             /* THIS TIME                                   @G24LB26*/ 05445000
*             /*                                                     */ 05446000
*             /*******************************************************/ 05447000
*                                                                  1136 05448000
*               ELSE                /*                       @G24LB26*/ 05449000
*                 IF INTERCC=RCEIGHT THEN/*                  @G24LB26*/ 05450000
         B     @RC01125                                            1136 05451000
@RF01125 CLC   INTERCC(2),@CB02115                                 1136 05452000
         BNE   @RF01136                                            1136 05453000
*                   BFVOLREJ(INDXBFTB)=ON;/*                 @G24LB26*/ 05454000
         LR    @08,INDXBFTB                                        1137 05455000
         MH    @08,@CH02240                                        1137 05456000
         L     @04,BFTBLPTR                                        1137 05457000
         ALR   @04,@08                                             1137 05458000
         OI    BFVOLREJ-18(@04),B'00000100'                        1137 05459000
*           END;                    /*                       @G24LB26*/ 05460000
*                                                                  1138 05461000
@RF01136 DS    0H                                                  1138 05462000
@RC01125 DS    0H                                                  1138 05463000
@RC01123 DS    0H                                                  1139 05464000
*         /***********************************************************/ 05465000
*         /*                                                         */ 05466000
*         /* CHECK IF STATUS OF VOLUME HAS CHANGED OR IF     @G24LB26*/ 05467000
*         /* VOLUME IS STILL ELIGIBLE.                       @G24LB26*/ 05468000
*         /*                                                         */ 05469000
*         /***********************************************************/ 05470000
*                                                                  1139 05471000
*         IF INDXBFTB>ZERO THEN     /*                       @G24LB26*/ 05472000
@RF01120 C     INDXBFTB,@CF00084                                   1139 05473000
         BNH   @RF01139                                            1139 05474000
*           IF BFVOLREJ(INDXBFTB)=OFF&RESORTSW=OFF THEN/*    @G24LB26*/ 05475000
         LR    @08,INDXBFTB                                        1140 05476000
         MH    @08,@CH02240                                        1140 05477000
         L     @04,BFTBLPTR                                        1140 05478000
         ALR   @04,@08                                             1140 05479000
         TM    BFVOLREJ-18(@04),B'00000100'                        1140 05480000
         BNZ   @RF01140                                            1140 05481000
         TM    RESORTSW,B'00010000'                                1140 05482000
         BNZ   @RF01140                                            1140 05483000
*             DO;                   /*                       @G24LB26*/ 05484000
*                                                                  1141 05485000
*               /*****************************************************/ 05486000
*               /*                                                   */ 05487000
*               /* SINCE VOLUME IS STILL ELIGIBLE FOR        @G24LB26*/ 05488000
*               /* SELECTION AND ITS STATUS HAS NOT CHANGED  @G24LB26*/ 05489000
*               /* CALL THE JES3 INTERFACE ROUTINE TO        @G24LB26*/ 05490000
*               /* DETERMINE IF VOLUME IS OK FOR SELECTION.  @G24LB26*/ 05491000
*               /*                                                   */ 05492000
*               /*****************************************************/ 05493000
*                                                                  1142 05494000
*               CALL JESINTF;       /*                       @G24LB26*/ 05495000
*                                                                  1142 05496000
         BAL   @14,JESINTF                                         1142 05497000
*               /*****************************************************/ 05498000
*               /*                                                   */ 05499000
*               /* CHECK CODE IN RPLV AND IF IS IS ZERO,     @G24LB26*/ 05500000
*               /* CHECK INTERNAL RETURN CODE.               @G24LB26*/ 05501000
*               /*                                                   */ 05502000
*               /*****************************************************/ 05503000
*                                                                  1143 05504000
*               IF RPLVRETC=RCZERO THEN/*                    @G24LB26*/ 05505000
         CLC   RPLVRETC(2,RPLVPTR),@CB02111                        1143 05506000
         BNE   @RF01143                                            1143 05507000
*                 DO;               /*                       @G24LB26*/ 05508000
*                                                                  1144 05509000
*                   /*************************************************/ 05510000
*                   /*                                               */ 05511000
*                   /* CHECK IF VOLUME HAS APPROVAL OF JES3  @G24LB26*/ 05512000
*                   /*                                               */ 05513000
*                   /*************************************************/ 05514000
*                                                                  1145 05515000
*                   IF INTERCC=RCZERO THEN/*                 @G24LB26*/ 05516000
*                                                                  1145 05517000
         CLC   INTERCC(2),@CB02111                                 1145 05518000
         BNE   @RF01145                                            1145 05519000
*                     /***********************************************/ 05520000
*                     /*                                             */ 05521000
*                     /* VOLUME IS APPROVED BY JES3,         @G24LB26*/ 05522000
*                     /* SELECT IT.                          @G24LB26*/ 05523000
*                     /*                                             */ 05524000
*                     /***********************************************/ 05525000
*                                                                  1146 05526000
*                     DO;           /*                       @G24LB26*/ 05527000
*                                                                  1146 05528000
*                       /*********************************************/ 05529000
*                       /*                                           */ 05530000
*                       /* IF VOLUME IS A PRIMARY SELECTION, @G24LB26*/ 05531000
*                       /* INDICATE IT                       @G24LB26*/ 05532000
*                       /*                                           */ 05533000
*                       /*********************************************/ 05534000
*                                                                  1147 05535000
*                       IF NUMCHOS=ZERO THEN/*               @G24LB26*/ 05536000
         CLI   NUMCHOS,0                                           1147 05537000
         BNE   @RF01147                                            1147 05538000
*                         DO;       /*                       @G24LB26*/ 05539000
*                           BFSELPRI(INDXBFTB)=ON;/*         @G24LB26*/ 05540000
*                           BFBADSEC(INDXBFTB)=ON;/*         @G24LB26*/ 05541000
         LR    @08,INDXBFTB                                        1150 05542000
         MH    @08,@CH02240                                        1150 05543000
         L     @04,BFTBLPTR                                        1150 05544000
         ALR   @04,@08                                             1150 05545000
         OI    BFSELPRI-18(@04),B'01100000'                        1150 05546000
*                           NUMCHOS=ONE;/*                   @G24LB26*/ 05547000
         MVI   NUMCHOS,X'01'                                       1151 05548000
*                         END;      /*                       @G24LB26*/ 05549000
*                                                                  1152 05550000
*                       /*********************************************/ 05551000
*                       /*                                           */ 05552000
*                       /* VOLUME IS A SECONDARY SELECTION   @G24LB26*/ 05553000
*                       /*                                           */ 05554000
*                       /*********************************************/ 05555000
*                                                                  1153 05556000
*                       ELSE        /*                       @G24LB26*/ 05557000
*                         DO;       /*                       @G24LB26*/ 05558000
         B     @RC01147                                            1153 05559000
@RF01147 DS    0H                                                  1154 05560000
*                           BFSELSEC(INDXBFTB)=ON;/*         @G24LB26*/ 05561000
         LR    @08,INDXBFTB                                        1154 05562000
         MH    @08,@CH02240                                        1154 05563000
         L     @04,BFTBLPTR                                        1154 05564000
         ALR   @04,@08                                             1154 05565000
         OI    BFSELSEC-18(@04),B'00010000'                        1154 05566000
*                           NUMCHOS=NUMCHOS+ONE;/*           @G24LB26*/ 05567000
         IC    @08,NUMCHOS                                         1155 05568000
         LA    @08,1(,@08)                                         1155 05569000
         STC   @08,NUMCHOS                                         1155 05570000
*                         END;      /*                       @G24LB26*/ 05571000
*                                                                  1156 05572000
*                       /*********************************************/ 05573000
*                       /*                                           */ 05574000
*                       /* * NOTE: VOLUME HAS ALREADY BEEN * @G24LB26*/ 05575000
*                       /* * PLACED IN THE VOLUME RETURN *   @G24LB26*/ 05576000
*                       /* * AREA BY THE JESINTF ROUTINE. *  @G24LB26*/ 05577000
*                       /*                                           */ 05578000
*                       /*********************************************/ 05579000
*                                                                  1157 05580000
*                                                                  1157 05581000
*                       /*********************************************/ 05582000
*                       /*                                           */ 05583000
*                       /* IF ALL VOLUMES SELECTED, EXIT     @G24LB26*/ 05584000
*                       /* LOOP. IF NOT, CHECK IF PRIMARY    @G24LB26*/ 05585000
*                       /* SELECTION. IF PRIMARY SET INDEX   @G24LB26*/ 05586000
*                       /* SO THAT SEARCH FOR SECONDARY      @G24LB26*/ 05587000
*                       /* WILL START AT TOP OF TABLE.       @G24LB26*/ 05588000
*                       /*                                           */ 05589000
*                       /*********************************************/ 05590000
*                                                                  1157 05591000
*                       IF NUMCHOS=NUMBVOL THEN/*            @G24LB26*/ 05592000
@RC01147 CLC   NUMCHOS(1),NUMBVOL                                  1157 05593000
         BNE   @RF01157                                            1157 05594000
*                         DO;       /*                       @G24LB26*/ 05595000
*                           VOLNUM=NUMCHOS;/* VOL RET INDEX  @G24LB26*/ 05596000
         L     @08,SELVLRET(,SELTMPTR)                             1159 05597000
         SLR   @04,@04                                             1159 05598000
         IC    @04,NUMCHOS                                         1159 05599000
         STH   @04,VOLNUM(,@08)                                    1159 05600000
*                           FINEXIT=ON;/*                    @G24LB26*/ 05601000
         OI    FINEXIT,B'10000000'                                 1160 05602000
*                         END;      /*                       @G24LB26*/ 05603000
*                       ELSE        /*                       @G24LB26*/ 05604000
*                         IF BFSELPRI(INDXBFTB)=ON THEN/*    @G24LB26*/ 05605000
         B     @RC01157                                            1162 05606000
@RF01157 LR    @08,INDXBFTB                                        1162 05607000
         MH    @08,@CH02240                                        1162 05608000
         L     @04,BFTBLPTR                                        1162 05609000
         ALR   @04,@08                                             1162 05610000
         TM    BFSELPRI-18(@04),B'00100000'                        1162 05611000
         BNO   @RF01162                                            1162 05612000
*                           INDXBFTB=ZERO;/*                 @G24LB26*/ 05613000
         SLR   INDXBFTB,INDXBFTB                                   1163 05614000
*                     END;          /*                       @G24LB26*/ 05615000
*                                                                  1164 05616000
*                   /*************************************************/ 05617000
*                   /*                                               */ 05618000
*                   /* VOLUME WAS NOT APPROVED BY JES3       @G24LB26*/ 05619000
*                   /*                                               */ 05620000
*                   /*************************************************/ 05621000
*                                                                  1165 05622000
*                   ELSE            /*                       @G24LB26*/ 05623000
*                                                                  1165 05624000
*                     /***********************************************/ 05625000
*                     /*                                             */ 05626000
*                     /* INDICATE VOLUME REJECTED            @G24LB26*/ 05627000
*                     /*                                             */ 05628000
*                     /***********************************************/ 05629000
*                                                                  1165 05630000
*                     BFVOLREJ(INDXBFTB)=ON;/*               @G24LB26*/ 05631000
         B     @RC01145                                            1165 05632000
@RF01145 LR    @08,INDXBFTB                                        1165 05633000
         MH    @08,@CH02240                                        1165 05634000
         L     @04,BFTBLPTR                                        1165 05635000
         ALR   @04,@08                                             1165 05636000
         OI    BFVOLREJ-18(@04),B'00000100'                        1165 05637000
*                 END;              /*                       @G24LB26*/ 05638000
*               ELSE                /*                       @G24LB26*/ 05639000
*                                                                  1167 05640000
*                 /***************************************************/ 05641000
*                 /*                                                 */ 05642000
*                 /* JES3 HAD A SEVERE PROBLEM, SO TERMINATE @G24LB26*/ 05643000
*                 /* THE REQUEST.                            @G24LB26*/ 05644000
*                 /*                                                 */ 05645000
*                 /***************************************************/ 05646000
*                                                                  1167 05647000
*                 FINEXIT=ON;       /*                       @G24LB26*/ 05648000
         B     @RC01143                                            1167 05649000
@RF01143 OI    FINEXIT,B'10000000'                                 1167 05650000
*             END;                  /*                       @G24LB26*/ 05651000
@RC01143 DS    0H                                                  1169 05652000
*       END;                        /*                       @G24LB26*/ 05653000
@RF01140 DS    0H                                                  1169 05654000
@RF01139 DS    0H                                                  1170 05655000
*   END;                            /* END OUTSIDE LOOP      @G24LB26*/ 05656000
*                                                                  1170 05657000
@RF01118 AL    INDXBFTB,@CF00043                                   1170 05658000
@DE01112 L     @08,BFTBLPTR                                        1170 05659000
         CH    INDXBFTB,BFTOTIDX(,@08)                             1170 05660000
         BNH   @DL01112                                            1170 05661000
@DC01112 DS    0H                                                  1171 05662000
*   /*****************************************************************/ 05663000
*   /*                                                               */ 05664000
*   /* DETERMINE IF ALL REQUESTE VOLUMES WERE SELECTED,      @G24LB26*/ 05665000
*   /* AND IF THEY WERE NOT, AND JES3 DID NOT ENCOUNTER A    @G24LB26*/ 05666000
*   /* TERMINATING ERROR, ISSUE ERROR MESSAGE                @G24LB26*/ 05667000
*   /*                                                               */ 05668000
*   /*****************************************************************/ 05669000
*                                                                  1171 05670000
*   IF RPLVRETC=RCZERO&NUMCHOS<NUMBVOL THEN/*                @G24LB26*/ 05671000
         CLC   RPLVRETC(2,RPLVPTR),@CB02111                        1171 05672000
         BNE   @RF01171                                            1171 05673000
         CLC   NUMCHOS(1),NUMBVOL                                  1171 05674000
         BNL   @RF01171                                            1171 05675000
*     DO;                           /*                       @G24LB26*/ 05676000
*                                                                  1172 05677000
*       /*************************************************************/ 05678000
*       /*                                                           */ 05679000
*       /* ISSUE MESSAGE ICB407I AND SET REASON CODE TO      @G24LB26*/ 05680000
*       /* 232 HEX, RETURN CODE 4.                           @G24LB26*/ 05681000
*       /*                                                           */ 05682000
*       /*************************************************************/ 05683000
*                                                                  1173 05684000
*       MSGRQ=MSGRQ&&MSGRQ;         /* CLEAR MSG PARM FIELD  @G24LB26*/ 05685000
         XC    MSGRQ(32),MSGRQ                                     1173 05686000
*       MSGRPLV=RPLVPTR;            /* RPLV ADDR             @G24LB26*/ 05687000
         ST    RPLVPTR,MSGRPLV                                     1174 05688000
*       MSGID=MSG407;               /* MSG ID FOR ICB407I    @G24LB26*/ 05689000
         MVC   MSGID(4),@CF02061                                   1175 05690000
*       MSGLEN1=EIGHT;              /* LENGTH OF INSERT      @G24LB26*/ 05691000
         MVI   MSGLEN1,X'08'                                       1176 05692000
*       MSGTEXT1=ADDR(GROVVGRP);    /* GROUP NAME            @G24LB26*/ 05693000
         L     @08,GROUPPTR                                        1177 05694000
         LA    @08,GROVVGRP(,@08)                                  1177 05695000
         STCM  @08,7,MSGTEXT1                                      1177 05696000
*       RESPECIFY                                                  1178 05697000
*         REG1 RSTD;                /*                       @G24LB26*/ 05698000
*       REG1=ADDR(MSGRQ);           /* ADDR OF MSG PARM LIST @G24LB26*/ 05699000
         LA    REG1,MSGRQ                                          1179 05700000
*       CALL ICBVOP00;              /* ISSUE MESSAGE         @G24LB26*/ 05701000
         L     @15,@CV01912                                        1180 05702000
         BALR  @14,@15                                             1180 05703000
*       RESPECIFY                                                  1181 05704000
*         REG1 UNRSTD;              /*                       @G24LB26*/ 05705000
*       RPLRCODE=SELFAIL;           /* SET REASON CODE TO    @G24LB26   05706000
*                                      232 HEX               @G24LB26*/ 05707000
         MVC   RPLRCODE(2,RPLVPTR),@CB02091                        1182 05708000
*       RPLVRETC=RCFOUR;            /* RETURN CODE TO 4,     @G24LB26   05709000
*                                      FAIL REQUEST          @G24LB26*/ 05710000
         MVC   RPLVRETC(2,RPLVPTR),@CB02113                        1183 05711000
*     END;                          /*                       @G24LB26*/ 05712000
*   RETURN;                         /*                       @G24LB26*/ 05713000
@EL00013 DS    0H                                                  1185 05714000
@EF00013 DS    0H                                                  1185 05715000
@ER00013 L     @14,@SA00013                                        1185 05716000
         BR    @14                                                 1185 05717000
*   END FINSELCT;                   /*                       @G24LB26*/ 05718000
         B     @EL00013                                            1186 05719000
*                                                                  1187 05720000
*/********************************************************************/ 05721000
*/*                                                          @G24LB26*/ 05722000
*/* PROCEDURE NAME - SORT                                    @G24LB26*/ 05723000
*/*                                                          @Z40LB37*/ 05724000
*/* FUNCTION - THIS PROCEDURE PROVIDES THE                   @G24LB26*/ 05725000
*/*            CALLER WITH THE BASIC FUNCTION OF SORTING     @Z40LB37*/ 05726000
*/*            A CONTIGUOUS AREA OF STORAGE OF ANY LENGTH,   @Z40LB37*/ 05727000
*/*            OR ELEMENT (RECORD) SIZE.   IT ALLOWS         @Z40LB37*/ 05728000
*/*            FIELDS TO BE SORTED PER USER CALL,            @G24LB26*/ 05729000
*/*            ANYWHERE WITHIN AN ELEMENT (RECORD) FOR ANY   @Z40LB37*/ 05730000
*/*            LENGTH EQUAL TO OR SMALLER THAN AN ELEMENTS   @Z40LB37*/ 05731000
*/*            SIZE.                                         @G24LB26*/ 05732000
*/*                                                          @Z40LB37*/ 05733000
*/* INPUT  - ADDRESS OF ARGUMENT LIST (SRTAGL), AND THE BEST @Z40LB26*/ 05734000
*/*          FIT TABLE. ALSO SORT WORK AREA IS PROVIDED.     @G24LB26*/ 05735000
*/*                                                          @Z40LB37*/ 05736000
*/* OUTPUT - A SORTED BEST FIT TABLE. NO RETURN CODE IS SET. @G24LB26*/ 05737000
*/*                                                          @Z40LB37*/ 05738000
*/********************************************************************/ 05739000
*                                                                  1187 05740000
*SORT:                                                             1187 05741000
*   PROC OPTIONS(SAVE(REG14));      /*                       @G24LB26*/ 05742000
*                                                                  1187 05743000
SORT     ST    @14,12(,@13)                                        1187 05744000
*   /*****************************************************************/ 05745000
*   /*                                                               */ 05746000
*   /* CALCULATE ENDING POSITION AND INITILIZE LOOP          @G24LB26*/ 05747000
*   /* CONTROL AND END INDICATOR SWITCHES                    @G24LB26*/ 05748000
*   /*                                                               */ 05749000
*   /*****************************************************************/ 05750000
*                                                                  1188 05751000
*   SRTEND=SRTBEG+(SRTFLDLN-ONE);   /*                       @G24LB26*/ 05752000
         LH    SRTEND,SRTFLDLN                                     1188 05753000
         BCTR  SRTEND,0                                            1188 05754000
         AH    SRTEND,SRTBEG                                       1188 05755000
*   SRTSTOP=OFF;                    /*                       @Z40LB37*/ 05756000
*   SRTMOVE=OFF;                    /*                       @Z40LB37*/ 05757000
         NI    SRTSTOP,B'00111111'                                 1190 05758000
*                                                                  1191 05759000
*   /*****************************************************************/ 05760000
*   /*                                                               */ 05761000
*   /* EXECUTE THE SORT LOOP USING THE MAXIMUM ELEMENTS      @Z40LB37*/ 05762000
*   /* MINUS ONE FOR THE SRTI COUNTER AND DECREMENTING THE   @Z40LB37*/ 05763000
*   /* THE SRTI COUNTER BY ONE EACH PASS. THE SRTJ COUNTER   @Z40LB37*/ 05764000
*   /* IS USED TO COUNT THE ELEMENTS THRU EACH PASS AND IN-  @Z40LB37*/ 05765000
*   /* CREMENT THE SRTJ COUNTER BY ONE AFTER EACH ELEMENT    @Z40LB37*/ 05766000
*   /* IS COMPARED. THE SRTSTOP SWITCH IS USED TO TERM-      @Z40LB37*/ 05767000
*   /* INATE THE SORT IF NO INTERCHANGE OF ELEMENTS TAKES    @Z40LB37*/ 05768000
*   /* PLACE.                                                @Z40LB37*/ 05769000
*   /*                                                               */ 05770000
*   /*****************************************************************/ 05771000
*                                                                  1191 05772000
*   DO SRTI=SRTNUM-ONE TO ONE BY-ONE/*                       @G24LB26*/ 05773000
*         WHILE SRTSTOP=OFF;        /*                       @G24LB26*/ 05774000
         LH    SRTI,SRTNUM                                         1191 05775000
         BCTR  SRTI,0                                              1191 05776000
         B     @DE01191                                            1191 05777000
@DL01191 TM    SRTSTOP,B'10000000'                                 1191 05778000
         BNZ   @DC01191                                            1191 05779000
*     DO SRTJ=ONE TO SRTI;          /*                       @Z40LB37*/ 05780000
*                                                                  1192 05781000
         LA    SRTJ,1                                              1192 05782000
         B     @DE01192                                            1192 05783000
@DL01192 DS    0H                                                  1193 05784000
*       /*************************************************************/ 05785000
*       /*                                                           */ 05786000
*       /* COMPARE THE TWO ELEMENTS TO SEE IF AN INTER-      @Z40LB37*/ 05787000
*       /* CHANGE SHOULD TAKE PLACE, USING THE PASSED SORT   @Z40LB37*/ 05788000
*       /* FIELDS AS A SUBSTRING, IF SO INTERCHANGE THEM.    @Z40LB37*/ 05789000
*       /*                                                           */ 05790000
*       /*************************************************************/ 05791000
*                                                                  1193 05792000
*       IF SRTELEM(SRTJ,SRTBEG:SRTEND)>/*                    @G24LB26*/ 05793000
*           SRTELEM(SRTJ+ONE,SRTBEG:SRTEND) THEN/*           @G24LB26*/ 05794000
         L     @08,SRTADDR                                         1193 05795000
         LH    @15,SRTBEG                                          1193 05796000
         LR    @14,SRTJ                                            1193 05797000
         MH    @14,@CH02240                                        1193 05798000
         LR    @01,@14                                             1193 05799000
         ALR   @01,@15                                             1193 05800000
         LCR   @15,@15                                             1193 05801000
         ALR   @15,SRTEND                                          1193 05802000
         ST    @01,@TF00001                                        1193 05803000
         ALR   @01,@08                                             1193 05804000
         AL    @01,@CF02280                                        1193 05805000
         ST    @14,@TF00002                                        1193 05806000
         LR    @14,@08                                             1193 05807000
         AL    @14,@TF00001                                        1193 05808000
         BCTR  @14,0                                               1193 05809000
         EX    @15,@SC02281                                        1193 05810000
         BNH   @RF01193                                            1193 05811000
*         DO;                       /*                       @Z40LB37*/ 05812000
*           SRTMOVE=ON;             /*                       @Z40LB37*/ 05813000
         OI    SRTMOVE,B'01000000'                                 1195 05814000
*           SORTWORK=SRTELEM(SRTJ); /*                       @G24LB26*/ 05815000
         LR    @01,@08                                             1196 05816000
         AL    @01,@TF00002                                        1196 05817000
         AL    @01,@CF02283                                        1196 05818000
         MVC   SORTWORK(18),SRTELEM(@01)                           1196 05819000
*           SRTELEM(SRTJ)=SRTELEM(SRTJ+ONE);/*               @Z40LB37*/ 05820000
         LR    @01,@08                                             1197 05821000
         AL    @01,@TF00002                                        1197 05822000
         AL    @01,@CF02283                                        1197 05823000
         LR    @15,@08                                             1197 05824000
         AL    @15,@TF00002                                        1197 05825000
         MVC   SRTELEM(18,@01),SRTELEM(@15)                        1197 05826000
*           SRTELEM(SRTJ+ONE)=SORTWORK;/*                    @G24LB26*/ 05827000
         AL    @08,@TF00002                                        1198 05828000
         MVC   SRTELEM(18,@08),SORTWORK                            1198 05829000
*         END;                      /*                       @Z40LB37*/ 05830000
*     END;                          /*                       @Z40LB37*/ 05831000
*                                                                  1200 05832000
@RF01193 AL    SRTJ,@CF00043                                       1200 05833000
@DE01192 CR    SRTJ,SRTI                                           1200 05834000
         BNH   @DL01192                                            1200 05835000
*     /***************************************************************/ 05836000
*     /*                                                             */ 05837000
*     /* IF AN ELEMENT WAS INTERCHANGED THEN TURN SRTMOVE    @Z40LB37*/ 05838000
*     /* SWITCH OFF. IF NO INTERCHANGE WAS MADE TURN SORT    @Z40LB37*/ 05839000
*     /* STOP SWITCH TO ON.                                  @Z40LB37*/ 05840000
*     /*                                                             */ 05841000
*     /***************************************************************/ 05842000
*                                                                  1201 05843000
*     IF SRTMOVE=ON                 /*                       @G24LB26*/ 05844000
*       THEN                        /*                       @G24LB26*/ 05845000
         TM    SRTMOVE,B'01000000'                                 1201 05846000
         BNO   @RF01201                                            1201 05847000
*       SRTMOVE=OFF;                /*                       @Z40LB37*/ 05848000
         NI    SRTMOVE,B'10111111'                                 1202 05849000
*     ELSE                          /*                       @G24LB26*/ 05850000
*       SRTSTOP=ON;                 /*                       @Z40LB37*/ 05851000
         B     @RC01201                                            1203 05852000
@RF01201 OI    SRTSTOP,B'10000000'                                 1203 05853000
*   END;                            /*                       @G24LB26*/ 05854000
@RC01201 BCTR  SRTI,0                                              1204 05855000
@DE01191 LTR   SRTI,SRTI                                           1204 05856000
         BP    @DL01191                                            1204 05857000
@DC01191 DS    0H                                                  1205 05858000
*   RETURN;                         /*                       @G24LB26*/ 05859000
@EL00014 DS    0H                                                  1205 05860000
@EF00014 DS    0H                                                  1205 05861000
@ER00014 L     @14,12(,@13)                                        1205 05862000
         BR    @14                                                 1205 05863000
*   END SORT;                       /*                       @G24LB26*/ 05864000
*                                                                  1207 05865000
*/*********************************************************  @G24LB26*/ 05866000
*/*                                                          @G24LB26*/ 05867000
*/* PROCEDURE NAME - TESTENQ                                 @G24LB26*/ 05868000
*/*                                                          @G24LB26*/ 05869000
*/* FUNCTION - THE ROUTINE DETERMINES IF THE VOLUME IS       @G24LB26*/ 05870000
*/*            ENQUEUED OR NOT FOR THE TYPE OF USE THE       @G24LB26*/ 05871000
*/*            VOLUME IS NEEDED FOR. THIS CAN BE EITHER      @G24LB26*/ 05872000
*/*            SHARED OR EXCLUSIVE USE. IF THE REQUEST IS    @G24LB26*/ 05873000
*/*            FOR SHARE, A TEST ENQ FOR SHARED USE IS       @G24LB26*/ 05874000
*/*            ISSUED. IF THE REQUEST IS FOR EXCLUSIVE       @G24LB26*/ 05875000
*/*            CONTROL, TEST ENQ FOR EXCLUSIVE USE IS        @G24LB26*/ 05876000
*/*            ISSUED.                                       @G24LB26*/ 05877000
*/*                                                          @G24LB26*/ 05878000
*/* INPUT - THE BEST FIT TABLE AND THE INDEX INTO THE BEST   @G24LB26*/ 05879000
*/*         FIT TABLE FOR THE VOLUME BEING PROCESSED.        @G24LB26*/ 05880000
*/*                                                          @G24LB26*/ 05881000
*/* OUTPUT - A RETURN CODE IN THE INTERNAL RETURN CODE AREA  @G24LB26*/ 05882000
*/*             0 - VOLUME WILL NOT CAUSE A WAIT IF SELECTED @G24LB26*/ 05883000
*/*             4 - VOLUME WOULD CAUSE REQUST TO WAIT IF     @G24LB26*/ 05884000
*/*                 SELECTED                                 @G24LB26*/ 05885000
*/*             8 - VOLUME UNUSABLE AT THIS TIME             @G24LB26*/ 05886000
*/*                                                          @G24LB26*/ 05887000
*/*********************************************************  @G24LB26*/ 05888000
*                                                                  1207 05889000
*TESTENQ:                                                          1207 05890000
*   PROC OPTIONS(SAVE(REG14));      /*                       @G24LB26*/ 05891000
*                                                                  1207 05892000
TESTENQ  ST    @14,@SA00015                                        1207 05893000
*   /*****************************************************************/ 05894000
*   /*                                                               */ 05895000
*   /* SETUP REQUIRED PARAMETERS FOR THE TEST ENQ MACRO      @G24LB26*/ 05896000
*   /*                                                               */ 05897000
*   /*****************************************************************/ 05898000
*                                                                  1208 05899000
*   TENQVOL=BFVOLID(INDXBFTB);      /* VOLID OF VOLUME       @G24LB26   05900000
*                                      BEING TESTED          @G24LB26*/ 05901000
*                                                                  1208 05902000
         L     @08,BFTBLPTR                                        1208 05903000
         LR    @04,INDXBFTB                                        1208 05904000
         MH    @04,@CH02240                                        1208 05905000
         ALR   @04,@08                                             1208 05906000
         MVC   TENQVOL(6),BFVOLID-18(@04)                          1208 05907000
*   /*****************************************************************/ 05908000
*   /*                                                               */ 05909000
*   /* IF REQUEST IS FOR EXCLUSIVE USE, A TEST ENQ FOR       @G24LB26*/ 05910000
*   /* EXCLUSIVE USE MUST BE DONE.                           @G24LB26*/ 05911000
*   /*                                                               */ 05912000
*   /*****************************************************************/ 05913000
*                                                                  1209 05914000
*   IF BFNSHRFL=ON THEN             /*                       @G24LB26*/ 05915000
         TM    BFNSHRFL(@08),B'10000000'                           1209 05916000
         BNO   @RF01209                                            1209 05917000
*     DO;                           /*                       @G24LB26*/ 05918000
*       RESPECIFY                                                  1211 05919000
*         REG15 RSTD;               /*                       @G24LB26*/ 05920000
*LENQ1:                                                            1212 05921000
*       GEN REFS(MAJRNAM,TENQVOL);                                 1212 05922000
*                                                                  1212 05923000
LENQ1    DS    0H                                                  1212 05924000
*                                                         /*@G24LB26*/  05925000
         ENQ (MAJRNAM,TENQVOL,E,6,SYSTEM),RET=TEST            @G24LB26  05926000
*       /*************************************************************/ 05927000
*       /*                                                           */ 05928000
*       /* CHECK RETURN CODE FROM ENQ                        @G24LB26*/ 05929000
*       /*                                                           */ 05930000
*       /*************************************************************/ 05931000
*                                                                  1213 05932000
*       IF REG15=ZERO THEN          /*                       @G24LB26*/ 05933000
         LTR   REG15,REG15                                         1213 05934000
         BNZ   @RF01213                                            1213 05935000
*         INTERCC=RCZERO;           /* VOL IS NOT ENQUEUED   @G24LB26*/ 05936000
         MVC   INTERCC(2),@CB02111                                 1214 05937000
*       ELSE                        /*                       @G24LB26*/ 05938000
*                                                                  1215 05939000
*         /***********************************************************/ 05940000
*         /*                                                         */ 05941000
*         /* CHECK NON ZERO RETURN CODE FROM ENQ             @G24LB26*/ 05942000
*         /*                                                         */ 05943000
*         /***********************************************************/ 05944000
*                                                                  1215 05945000
*         IF ENQRETC=FOUR THEN      /*                       @G24LB26*/ 05946000
         B     @RC01213                                            1215 05947000
@RF01213 CLI   ENQRETC(REG15),4                                    1215 05948000
         BNE   @RF01215                                            1215 05949000
*           INTERCC=RCFOUR;         /* VOL IS ENQUEUED       @G24LB26*/ 05950000
*                                                                  1216 05951000
         MVC   INTERCC(2),@CB02113                                 1216 05952000
*       /*************************************************************/ 05953000
*       /*                                                           */ 05954000
*       /* IF RETURN CODE IS NOT ZERO OR FOUR,               @G24LB26*/ 05955000
*       /* VOLUME IS NOT ELIGIBLE                            @G24LB26*/ 05956000
*       /*                                                           */ 05957000
*       /*************************************************************/ 05958000
*                                                                  1217 05959000
*         ELSE                      /*                       @G24LB26*/ 05960000
*           INTERCC=RCEIGHT;        /*                       @G24LB26*/ 05961000
         B     @RC01215                                            1217 05962000
@RF01215 MVC   INTERCC(2),@CB02115                                 1217 05963000
*       RESPECIFY                                                  1218 05964000
*         REG15 UNRSTD;             /*                       @G24LB26*/ 05965000
@RC01215 DS    0H                                                  1218 05966000
@RC01213 DS    0H                                                  1219 05967000
*     END;                          /*                       @G24LB26*/ 05968000
*                                                                  1219 05969000
*   /*****************************************************************/ 05970000
*   /*                                                               */ 05971000
*   /* REQUEST IS FOR SHARED USE, SO PROCESS ON THAT BASIS   @G24LB26*/ 05972000
*   /*                                                               */ 05973000
*   /*****************************************************************/ 05974000
*                                                                  1220 05975000
*   ELSE                            /*                       @G24LB26*/ 05976000
*     DO;                           /*                       @G24LB26*/ 05977000
*                                                                  1220 05978000
         B     @RC01209                                            1220 05979000
@RF01209 DS    0H                                                  1221 05980000
*       /*************************************************************/ 05981000
*       /*                                                           */ 05982000
*       /* DETERMINE IF ISSUING A TEST ENQ IS NECESSARY      @G24LB26*/ 05983000
*       /*                                                           */ 05984000
*       /*************************************************************/ 05985000
*                                                                  1221 05986000
*       IF BFNOTMTD(INDXBFTB)=OFF&BFMTDOTH(INDXBFTB)=OFF/*   @G24LB26*/ 05987000
*           &BFCONUSE(INDXBFTB)>ZERO&BFWAITFL(INDXBFTB)/*    @G24LB26*/ 05988000
*           =OFF THEN               /*                       @G24LB26*/ 05989000
         L     @08,BFTBLPTR                                        1221 05990000
         LR    @04,INDXBFTB                                        1221 05991000
         MH    @04,@CH02240                                        1221 05992000
         ST    @04,@TF00001                                        1221 05993000
         ALR   @04,@08                                             1221 05994000
         TM    BFNOTMTD-18(@04),B'11000000'                        1221 05995000
         BNZ   @RF01221                                            1221 05996000
         L     @04,@TF00001                                        1221 05997000
         SLR   @15,@15                                             1221 05998000
         IC    @15,BFCONUSE-18(@04,@08)                            1221 05999000
         C     @15,@CF00084                                        1221 06000000
         BNH   @RF01221                                            1221 06001000
         AL    @08,@TF00001                                        1221 06002000
         TM    BFWAITFL-18(@08),B'01000000'                        1221 06003000
         BNZ   @RF01221                                            1221 06004000
*         INTERCC=RCZERO;           /*                       @G24LB26*/ 06005000
*                                                                  1222 06006000
         MVC   INTERCC(2),@CB02111                                 1222 06007000
*       /*************************************************************/ 06008000
*       /*                                                           */ 06009000
*       /* IF ABOVE TEST WAS NOT MET, A TEST ENQ FOR SHARED  @G24LB26*/ 06010000
*       /* USE MUST BE ISSUED                                @G24LB26*/ 06011000
*       /*                                                           */ 06012000
*       /*************************************************************/ 06013000
*                                                                  1223 06014000
*       ELSE                        /*                       @G24LB26*/ 06015000
*         DO;                       /*                       @G24LB26*/ 06016000
         B     @RC01221                                            1223 06017000
@RF01221 DS    0H                                                  1224 06018000
*           RESPECIFY                                              1224 06019000
*             REG15 RSTD;           /*                       @G24LB26*/ 06020000
*LENQ2:                                                            1225 06021000
*           GEN REFS(MAJRNAM,TENQVOL);                             1225 06022000
*                                                                  1225 06023000
LENQ2    DS    0H                                                  1225 06024000
*                                                         /*@G24LB26*/  06025000
         ENQ (MAJRNAM,TENQVOL,S,6,SYSTEM),RET=TEST            @G24LB26  06026000
*           /*********************************************************/ 06027000
*           /*                                                       */ 06028000
*           /* CHECK RETURN CODE FROM ENQ                    @G24LB26*/ 06029000
*           /*                                                       */ 06030000
*           /*********************************************************/ 06031000
*                                                                  1226 06032000
*           IF REG15=ZERO THEN      /*                       @G24LB26*/ 06033000
         LTR   REG15,REG15                                         1226 06034000
         BNZ   @RF01226                                            1226 06035000
*             INTERCC=RCZERO;       /* VOL IS NOT ENQ EXCL   @G24LB26*/ 06036000
         MVC   INTERCC(2),@CB02111                                 1227 06037000
*           ELSE                    /*                       @G24LB26*/ 06038000
*             IF ENQRETC=FOUR THEN  /*                       @G24LB26*/ 06039000
         B     @RC01226                                            1228 06040000
@RF01226 CLI   ENQRETC(REG15),4                                    1228 06041000
         BNE   @RF01228                                            1228 06042000
*               INTERCC=RCFOUR;     /* VOL IS ENQ EXCLUSIVE  @G24LB26*/ 06043000
*                                                                  1229 06044000
         MVC   INTERCC(2),@CB02113                                 1229 06045000
*           /*********************************************************/ 06046000
*           /*                                                       */ 06047000
*           /* RETURN CODE IS NEITHER ZERO OR FOUR, SO       @G24LB26*/ 06048000
*           /* VOLUME IS NOT USABLE                          @G24LB26*/ 06049000
*           /*                                                       */ 06050000
*           /*********************************************************/ 06051000
*                                                                  1230 06052000
*             ELSE                  /*                       @G24LB26*/ 06053000
*               INTERCC=RCEIGHT;    /*                       @G24LB26*/ 06054000
         B     @RC01228                                            1230 06055000
@RF01228 MVC   INTERCC(2),@CB02115                                 1230 06056000
*           RESPECIFY                                              1231 06057000
*             REG15 UNRSTD;         /*                       @G24LB26*/ 06058000
@RC01228 DS    0H                                                  1231 06059000
@RC01226 DS    0H                                                  1232 06060000
*         END;                      /*                       @G24LB26*/ 06061000
*     END;                          /*                       @G24LB26*/ 06062000
*   RETURN;                         /*                       @G24LB26*/ 06063000
@EL00015 DS    0H                                                  1234 06064000
@EF00015 DS    0H                                                  1234 06065000
@ER00015 L     @14,@SA00015                                        1234 06066000
         BR    @14                                                 1234 06067000
*   END TESTENQ;                    /*                       @G24LB26*/ 06068000
         B     @EL00015                                            1235 06069000
*                                                                  1236 06070000
*/*********************************************************  @G24LB26*/ 06071000
*/*                                                          @G24LB26*/ 06072000
*/* PROCEDURE NAME - JESINTF                                 @G24LB26*/ 06073000
*/*                                                          @G24LB26*/ 06074000
*/* FUNCTION - THE ROUTINE SETS UP THE REQUIRED INTERFACE    @G24LB26*/ 06075000
*/*            THRU THE SUBSYSTEM INTERFACE TO CONTACT JES3. @G24LB26*/ 06076000
*/*            IT THEN INTERPRETS THE RETURN FROM JES3 AND   @G24LB26*/ 06077000
*/*            THE SUBSYSTEM INTERFACE TO DETERMINE IF THE   @G24LB26*/ 06078000
*/*            VOLUME IS ELIGIBLE FOR THIS REQUEST OR NOT.   @G24LB26*/ 06079000
*/*                                                          @G24LB26*/ 06080000
*/* INPUT - THE ADDRESS OF THE SUBSYSTEM CONTROL BLOCK       @G24LB26*/ 06081000
*/*         SSOB. THE BEST FIT TABLE ALONG WITH THE INDEX    @G24LB26*/ 06082000
*/*         INTO THE BEST FIT TABLE OF THE VOLUME CURRENTLY  @G24LB26*/ 06083000
*/*         BEING PROCESSED. THE SELECT REQUEST BLOCK.       @G24LB26*/ 06084000
*/*         THE ADDRESS OF THE SSOB IS IN VVICB. THE SSOB    @G24LB26*/ 06085000
*/*         CONTAINS THE ADDRESS OF THE SSOBMO.              @G24LB26*/ 06086000
*/*                                                          @G24LB26*/ 06087000
*/* OUTPUT - A ZERO REASON AND RETURN CODE IN THE RPLV IF    @G24LB26*/ 06088000
*/*          JES3 PROCESSED THE REQUEST SUCCESSFULLY. A      @G24LB26*/ 06089000
*/*          NON-ZERO REASON AND RETURN IN RPLV IF SUB-      @G24LB26*/ 06090000
*/*          SYSTEM OR JES3 ERRORS.                          @G24LB26*/ 06091000
*/*          IF THE REQUEST WAS SUCCESSFULLY PROCESSED, THE  @G24LB26*/ 06092000
*/*          INTERNAL RETURN CODE WILL CONTAIN EITHER ZERO   @G24LB26*/ 06093000
*/*          IF THE VOLUME IS ELIGIBLE TO BE SELECTED FOR    @G24LB26*/ 06094000
*/*          THIS REQUEST, OR A FOUR IF THE VOLUME IS NOT A  @G24LB26*/ 06095000
*/*          CANDIDATE FOR SELECTION.                        @G24LB26*/ 06096000
*/*          ISSUES MESSAGE ICB479I.                         @G24LB26*/ 06097000
*/*                                                          @G24LB26*/ 06098000
*/*********************************************************  @G24LB26*/ 06099000
*                                                                  1236 06100000
*JESINTF:                                                          1236 06101000
*   PROC OPTIONS(SAVEAREA);         /*                       @G24LB26*/ 06102000
*                                                                  1236 06103000
JESINTF  STM   @14,@12,12(@13)                                     1236 06104000
         ST    @13,@SA00016+4                                      1236 06105000
         LA    @14,@SA00016                                        1236 06106000
         ST    @14,8(,@13)                                         1236 06107000
         LR    @13,@14                                             1236 06108000
*   /*****************************************************************/ 06109000
*   /*                                                               */ 06110000
*   /* SET UP THE PARAMETER LIST FOR THE SUBSYSTEM           @G24LB26*/ 06111000
*   /* INTERFACE. START BY SETTING AN INDICATOR TELLING IF   @G24LB26*/ 06112000
*   /* VOLUME IS MOUNTED OR NOT.                             @G24LB26*/ 06113000
*   /*                                                               */ 06114000
*   /*****************************************************************/ 06115000
*                                                                  1237 06116000
*   IF BFNOTMTD(INDXBFTB)=OFF THEN  /*                       @G24LB26*/ 06117000
         LR    @08,INDXBFTB                                        1237 06118000
         MH    @08,@CH02240                                        1237 06119000
         L     @04,BFTBLPTR                                        1237 06120000
         ALR   @04,@08                                             1237 06121000
         TM    BFNOTMTD-18(@04),B'10000000'                        1237 06122000
         BNZ   @RF01237                                            1237 06123000
*     SSMOMNTD=ON;                  /* VOLUME MOUNTED        @G24LB26*/ 06124000
         L     @08,VVIPTR                                          1238 06125000
         L     @08,VVISSOBA(,@08)                                  1238 06126000
         L     @08,SSOBINDV(,@08)                                  1238 06127000
         OI    SSMOMNTD(@08),B'00001000'                           1238 06128000
*   ELSE                            /*                       @G24LB26*/ 06129000
*     SSMOMNTD=OFF;                 /* VOLUME NOT MOUNTED    @G24LB26*/ 06130000
         B     @RC01237                                            1239 06131000
@RF01237 L     @08,VVIPTR                                          1239 06132000
         L     @08,VVISSOBA(,@08)                                  1239 06133000
         L     @08,SSOBINDV(,@08)                                  1239 06134000
         NI    SSMOMNTD(@08),B'11110111'                           1239 06135000
*   SSMOPNAM=ADDR(SELJOBNM);        /* JOB NAME ADDR         @G24LB26*/ 06136000
@RC01237 L     @08,VVIPTR                                          1240 06137000
         L     @08,VVISSOBA(,@08)                                  1240 06138000
         L     @04,SSOBINDV(,@08)                                  1240 06139000
         LA    @15,SELJOBNM(,SELTMPTR)                             1240 06140000
         ST    @15,SSMOPNAM(,@04)                                  1240 06141000
*   SSMOPSTN=ADDR(SELSTNUM);        /* STEP NUMBER ADDR      @G24LB26*/ 06142000
*                                                                  1241 06143000
         LA    @15,SELSTNUM(,SELTMPTR)                             1241 06144000
         ST    @15,SSMOPSTN(,@04)                                  1241 06145000
*   /*****************************************************************/ 06146000
*   /*                                                               */ 06147000
*   /* MOVE VOLID CURRENTLY INTO THE SELECT REQUEST BLOCK    @G24LB26*/ 06148000
*   /* SO SUBSYSTEM INTERFACE HAS ACCESS TO IT.              @G24LB26*/ 06149000
*   /*                                                               */ 06150000
*   /*****************************************************************/ 06151000
*                                                                  1242 06152000
*   VOLSER(NUMCHOS+ONE)=BFVOLID(INDXBFTB);/*                 @G24LB26*/ 06153000
         SLR   @15,@15                                             1242 06154000
         IC    @15,NUMCHOS                                         1242 06155000
         MH    @15,@CH00215                                        1242 06156000
         L     @14,SELVLRET(,SELTMPTR)                             1242 06157000
         ST    @15,@TF00001                                        1242 06158000
         ALR   @15,@14                                             1242 06159000
         LR    @03,INDXBFTB                                        1242 06160000
         MH    @03,@CH02240                                        1242 06161000
         L     @01,BFTBLPTR                                        1242 06162000
         ALR   @01,@03                                             1242 06163000
         MVC   VOLSER(6,@15),BFVOLID-18(@01)                       1242 06164000
*   SSMOPVOL=ADDR(VOLSER(NUMCHOS+ONE));/* ADDR OF VOLID      @G24LB26*/ 06165000
         L     @15,@TF00001                                        1243 06166000
         LA    @15,VOLSER(@15,@14)                                 1243 06167000
         ST    @15,SSMOPVOL(,@04)                                  1243 06168000
*   SSMOPDDN=ADDR(SELDDNAM);        /* ADDR OF DDNAME        @G24LB26*/ 06169000
         LA    @15,SELDDNAM(,SELTMPTR)                             1244 06170000
         ST    @15,SSMOPDDN(,@04)                                  1244 06171000
*   SSMOPRPN=ADDR(SELDDCAT);        /* ADDR OF CONCAT NUMBER @G24LB26*/ 06172000
*                                                                  1245 06173000
         LA    @15,SELDDCAT(,SELTMPTR)                             1245 06174000
         ST    @15,SSMOPRPN(,@04)                                  1245 06175000
*   /*****************************************************************/ 06176000
*   /*                                                               */ 06177000
*   /* CLEAR RETURN CODE AREA USED BY SUBSYSTEM FOR          @G24LB26*/ 06178000
*   /* RETURN CODE.                                          @G24LB26*/ 06179000
*   /*                                                               */ 06180000
*   /*****************************************************************/ 06181000
*                                                                  1246 06182000
*   SSOBRETN=ZEROPTR;               /* CLEAR RETURN CODE     @G24LB26*/ 06183000
         SLR   @04,@04                                             1246 06184000
         ST    @04,SSOBRETN(,@08)                                  1246 06185000
*   RESPECIFY                                                      1247 06186000
*     REG15 RSTD;                   /*                       @G24LB26*/ 06187000
*                                                                  1247 06188000
*   /*****************************************************************/ 06189000
*   /*                                                               */ 06190000
*   /* ISSUE MACRO TO INVOKE SUBSYSTEM INTERFACE             @G24LB26*/ 06191000
*   /*                                                               */ 06192000
*   /*****************************************************************/ 06193000
*                                                                  1248 06194000
*/*   ? IEFSSREQ  (SSOB);                                            */ 06195000
*/*                                                                  */ 06196000
*/*  PASS CONTROL TO JOB ENTRY SUBSYSTEM TO                          */ 06197000
*/*  PROCESS REQUEST -                                               */ 06198000
*/*                                                                  */ 06199000
*/*    INPUT - REGISTER 1 POINTS TO A ONE-                           */ 06200000
*/*            WORD PARAMETER LIST WHICH                             */ 06201000
*/*            POINTS TO THE SSOB                                    */ 06202000
*/*                                                                  */ 06203000
*                                                                  1248 06204000
*   CALL SSREQ(SSOB);               /*                       @G24LB26*/ 06205000
*                                                                  1248 06206000
         ST    @08,@AL00001                                        1248 06207000
         MVI   @AL00001,X'80'                                      1248 06208000
         L     @08,CVTPTR                                          1248 06209000
         L     @08,CVTJESCT(,@08)                                  1248 06210000
         L     @15,JESSSREQ(,@08)                                  1248 06211000
         LA    @01,@AL00001                                        1248 06212000
         BALR  @14,@15                                             1248 06213000
*   /*****************************************************************/ 06214000
*   /*                                                               */ 06215000
*   /* CHECK ON RETURN CODE FROM SUBSYSTEM INTERFACE AND     @G24LB26*/ 06216000
*   /* JES3                                                  @G24LB26*/ 06217000
*   /*                                                               */ 06218000
*   /*****************************************************************/ 06219000
*                                                                  1249 06220000
*   IF REG15=SSRTOK THEN            /*                       @G24LB26*/ 06221000
         SLR   @14,@14                                             1249 06222000
         CR    REG15,@14                                           1249 06223000
         BNE   @RF01249                                            1249 06224000
*     DO;                           /*                       @G24LB26*/ 06225000
*                                                                  1250 06226000
*       /*************************************************************/ 06227000
*       /*                                                           */ 06228000
*       /* CHECK RETURN CODE IN SSOB. IF ZERO, VOLUME        @G24LB26*/ 06229000
*       /* OK TO SELECT                                      @G24LB26*/ 06230000
*       /*                                                           */ 06231000
*       /*************************************************************/ 06232000
*                                                                  1251 06233000
*       IF SSOBRETN=SSMOVOLA THEN   /*                       @G24LB26*/ 06234000
         L     @08,VVIPTR                                          1251 06235000
         L     @08,VVISSOBA(,@08)                                  1251 06236000
         C     @14,SSOBRETN(,@08)                                  1251 06237000
         BNE   @RF01251                                            1251 06238000
*         INTERCC=RCZERO;           /*                       @G24LB26*/ 06239000
         MVC   INTERCC(2),@CB02111                                 1252 06240000
*       ELSE                        /*                       @G24LB26*/ 06241000
*                                                                  1253 06242000
*         /***********************************************************/ 06243000
*         /*                                                         */ 06244000
*         /* IF FOUR RETURN, VOLUME IS BUSY AND THEREFORE    @G24LB26*/ 06245000
*         /* NOT ELIGIBLE.                                   @G24LB26*/ 06246000
*         /*                                                         */ 06247000
*         /***********************************************************/ 06248000
*                                                                  1253 06249000
*         IF SSOBRETN=SSMOVOLB THEN /*                       @G24LB26*/ 06250000
*                                                                  1253 06251000
         B     @RC01251                                            1253 06252000
@RF01251 L     @14,VVIPTR                                          1253 06253000
         L     @14,VVISSOBA(,@14)                                  1253 06254000
         CLC   SSOBRETN(4,@14),@CF00064                            1253 06255000
         BNE   @RF01253                                            1253 06256000
*           /*********************************************************/ 06257000
*           /*                                                       */ 06258000
*           /* ISSUE MESSAGE ICB479I AND SET INTERNAL        @G24LB26*/ 06259000
*           /* RETURN CODE TO 4.                             @G24LB26*/ 06260000
*           /*                                                       */ 06261000
*           /*********************************************************/ 06262000
*                                                                  1254 06263000
*           DO;                     /*                       @G24LB26*/ 06264000
*             MSGRQ=MSGRQ&&MSGRQ;   /* CLEAR MSG PARM FIELD  @G24LB26*/ 06265000
         XC    MSGRQ(32),MSGRQ                                     1255 06266000
*             MSGRPLV=RPLVPTR;      /* RPLV ADDR             @G24LB26*/ 06267000
         ST    RPLVPTR,MSGRPLV                                     1256 06268000
*             MSGID=MSG479;         /* MSG ID FOR ICB479I    @G24LB26*/ 06269000
         MVC   MSGID(4),@CF02071                                   1257 06270000
*             MSGLEN1=SIX;          /* LENGTH OF VOLID       @G24LB26*/ 06271000
         MVI   MSGLEN1,X'06'                                       1258 06272000
*             MSGTEXT1=ADDR(BFVOLID(INDXBFTB));/* VOLID      @G24LB26*/ 06273000
         LR    @14,INDXBFTB                                        1259 06274000
         MH    @14,@CH02240                                        1259 06275000
         L     @08,BFTBLPTR                                        1259 06276000
         LA    @14,BFVOLID-18(@14,@08)                             1259 06277000
         STCM  @14,7,MSGTEXT1                                      1259 06278000
*             RESPECIFY                                            1260 06279000
*               REG1 RSTD;          /*                       @G24LB26*/ 06280000
*             REG1=ADDR(MSGRQ);     /* ADDR MSG PARM LIST    @G24LB26*/ 06281000
         LA    REG1,MSGRQ                                          1261 06282000
*             CALL ICBVOP00;        /* ISSUE MESSAGE         @G24LB26*/ 06283000
         L     @15,@CV01912                                        1262 06284000
         BALR  @14,@15                                             1262 06285000
*             RESPECIFY                                            1263 06286000
*               REG1 UNRSTD;        /*                       @G24LB26*/ 06287000
*             INTERCC=RCFOUR;       /* INDICATE VOLUME NOT   @G24LB26   06288000
*                                      ELIGIBLE              @G24LB26*/ 06289000
         MVC   INTERCC(2),@CB02113                                 1264 06290000
*           END;                    /*                       @G24LB26*/ 06291000
*         ELSE                      /*                       @G24LB26*/ 06292000
*                                                                  1266 06293000
*           /*********************************************************/ 06294000
*           /*                                                       */ 06295000
*           /* RETURN CODE NOT VALID FROM SUBSYSTEM          @G24LB26*/ 06296000
*           /* INTERFACE.                                    @G24LB26*/ 06297000
*           /*                                                       */ 06298000
*           /*********************************************************/ 06299000
*                                                                  1266 06300000
*           DO;                     /*                       @G24LB26*/ 06301000
*                                                                  1266 06302000
         B     @RC01253                                            1266 06303000
@RF01253 DS    0H                                                  1267 06304000
*             /*******************************************************/ 06305000
*             /*                                                     */ 06306000
*             /* SET REASON AND RETURN CODES IN RPLV         @G24LB26*/ 06307000
*             /* BECAUSE OF BAD RETURN CODE FROM SUBSYSTEM   @G24LB26*/ 06308000
*             /* INTERFACE.                                  @G24LB26*/ 06309000
*             /*                                                     */ 06310000
*             /*******************************************************/ 06311000
*                                                                  1267 06312000
*             RPLVRETC=RCFOUR;      /* RETURN CODE 4         @G24LB26*/ 06313000
         MVC   RPLVRETC(2,RPLVPTR),@CB02113                        1267 06314000
*             RPLRCODE=INVALRET;    /* REASON CODE OF 265 HEX      1268 06315000
*                                                            @G24LB26*/ 06316000
         MVC   RPLRCODE(2,RPLVPTR),@CB02099                        1268 06317000
*           END;                    /*                       @G24LB26*/ 06318000
*     END;                          /*                       @G24LB26*/ 06319000
*                                                                  1270 06320000
*   /*****************************************************************/ 06321000
*   /*                                                               */ 06322000
*   /* SINCE REG15 DOES NOT HAVE A ZERO RETURN CODE,         @G24LB26*/ 06323000
*   /* CHECK ON WHAT IT IS.                                  @G24LB26*/ 06324000
*   /*                                                               */ 06325000
*   /*****************************************************************/ 06326000
*                                                                  1271 06327000
*   ELSE                            /*                       @G24LB26*/ 06328000
*     DO;                           /*                       @G24LB26*/ 06329000
         B     @RC01249                                            1271 06330000
@RF01249 DS    0H                                                  1272 06331000
*       IF REG15=SSRTNSUP|REG15=SSRTNTUP|REG15=SSRTNOSS/*    @G24LB26*/ 06332000
*         THEN                      /*                       @G24LB26*/ 06333000
*                                                                  1272 06334000
         C     REG15,@CF00064                                      1272 06335000
         BE    @RT01272                                            1272 06336000
         C     REG15,@CF00040                                      1272 06337000
         BE    @RT01272                                            1272 06338000
         C     REG15,@CF00032                                      1272 06339000
         BNE   @RF01272                                            1272 06340000
@RT01272 DS    0H                                                  1273 06341000
*         /***********************************************************/ 06342000
*         /*                                                         */ 06343000
*         /* SUBSYSTEM IS NOT UP, NOT SUPPORTED OR DOES      @G24LB26*/ 06344000
*         /* NOT EXIST                                       @G24LB26*/ 06345000
*         /*                                                         */ 06346000
*         /***********************************************************/ 06347000
*                                                                  1273 06348000
*         INTERCC=RCZERO;           /* GO AHEAD & SELECT VOL @G24LB26*/ 06349000
         MVC   INTERCC(2),@CB02111                                 1273 06350000
*       ELSE                        /*                       @G24LB26*/ 06351000
*         IF REG15=SSRTDIST THEN    /*                       @G24LB26*/ 06352000
         B     @RC01272                                            1274 06353000
@RF01272 C     REG15,@CF00112                                      1274 06354000
         BNE   @RF01274                                            1274 06355000
*           DO;                     /*                       @G24LB26*/ 06356000
*                                                                  1275 06357000
*             /*******************************************************/ 06358000
*             /*                                                     */ 06359000
*             /* SUBSYSTEM ENCOUNTERED DISASTEROUS ERROR     @G24LB26*/ 06360000
*             /*                                                     */ 06361000
*             /*******************************************************/ 06362000
*                                                                  1276 06363000
*             RPLRCODE=DISAEROR;    /* REASON CODE 262 HEX   @G24LB26*/ 06364000
         MVC   RPLRCODE(2,RPLVPTR),@CB02093                        1276 06365000
*             RPLVRETC=RCFOUR;      /* RETURN CODE 4         @G24LB26*/ 06366000
         MVC   RPLVRETC(2,RPLVPTR),@CB02113                        1277 06367000
*           END;                    /*                       @G24LB26*/ 06368000
*         ELSE                      /*                       @G24LB26*/ 06369000
*           IF REG15=SSRTLERR THEN  /*                       @G24LB26*/ 06370000
         B     @RC01274                                            1279 06371000
@RF01274 C     REG15,@CF01851                                      1279 06372000
         BNE   @RF01279                                            1279 06373000
*             DO;                   /*                       @G24LB26*/ 06374000
*                                                                  1280 06375000
*               /*****************************************************/ 06376000
*               /*                                                   */ 06377000
*               /* SUBSYSTEM ENCOUNTERED LOGICAL ERROR       @G24LB26*/ 06378000
*               /*                                                   */ 06379000
*               /*****************************************************/ 06380000
*                                                                  1281 06381000
*               RPLVRETC=RCFOUR;    /* RETURN CODE 4         @G24LB26*/ 06382000
         MVC   RPLVRETC(2,RPLVPTR),@CB02113                        1281 06383000
*               RPLRCODE=LOGICERR;  /* HEX CODE 263          @G24LB26*/ 06384000
         MVC   RPLRCODE(2,RPLVPTR),@CB02095                        1282 06385000
*             END;                  /*                       @G24LB26*/ 06386000
*                                                                  1283 06387000
*       /*************************************************************/ 06388000
*       /*                                                           */ 06389000
*       /* REG 15 DOES NOT CONTAIN A VALID RETURN CODE       @G24LB26*/ 06390000
*       /* OF 0, 4, 8, 12, 16, OR 20.                        @G24LB26*/ 06391000
*       /*                                                           */ 06392000
*       /*************************************************************/ 06393000
*                                                                  1284 06394000
*           ELSE                    /*                       @G24LB26*/ 06395000
*             DO;                   /*                       @G24LB26*/ 06396000
         B     @RC01279                                            1284 06397000
@RF01279 DS    0H                                                  1285 06398000
*               RPLVRETC=RCFOUR;    /* RETURN CODE OF 4      @G24LB26*/ 06399000
         MVC   RPLVRETC(2,RPLVPTR),@CB02113                        1285 06400000
*               RPLRCODE=INVALERR;  /* REASON CODE 264 HEX   @G24LB26*/ 06401000
         MVC   RPLRCODE(2,RPLVPTR),@CB02097                        1286 06402000
*             END;                  /*                       @G24LB26*/ 06403000
*     END;                          /*                       @G24LB26*/ 06404000
*   RESPECIFY                                                      1289 06405000
*     REG15 UNRSTD;                 /*                       @G24LB26*/ 06406000
*   RETURN;                         /*                       @G24LB26*/ 06407000
@EL00016 L     @13,4(,@13)                                         1290 06408000
@EF00016 DS    0H                                                  1290 06409000
@ER00016 LM    @14,@12,12(@13)                                     1290 06410000
         BR    @14                                                 1290 06411000
*   END JESINTF;                    /*                       @G24LB26*/ 06412000
         B     @EL00016                                            1291 06413000
*                                                                  1292 06414000
*/*********************************************************  @G24LB26*/ 06415000
*/*                                                          @G24LB26*/ 06416000
*/* PROCEDURE NAME - UPDTMSVI                                @G24LB26*/ 06417000
*/*                                                          @G24LB26*/ 06418000
*/* FUNCTION - READS THE EXTENSION RECORDS AND UPDATES THE   @G24LB26*/ 06419000
*/*            AVAILABLE RUNNING SPACE. ALSO UPDATES THE     @G24LB26*/ 06420000
*/*            EXPIRATION DATE IN BOTH THE BASE VOLUME AND   @G24LB26*/ 06421000
*/*            EXTENSION RECORDS IF IT WAS MODIFIED AND      @G24LB26*/ 06422000
*/*            JOURNALS THE EXPIRATION DATE CHANGE.          @G24LB26*/ 06423000
*/*                                                          @G24LB26*/ 06424000
*/* INPUT - THE BEST FIT TABLE, THE GROUP RECORD, THE GROUP  @G24LB26*/ 06425000
*/*         EXTENSION RECORDS, THE NUMBER OF VOLUMES         @G24LB26*/ 06426000
*/*         SELECTED FOR THIS REQUEST AND THE AMOUNT OF      @G24LB26*/ 06427000
*/*         PRIMARY SPACE ALLOCATED FOR THIS REQUEST IN      @G24LB26*/ 06428000
*/*         CYLINDERS.                                       @G24LB26*/ 06429000
*/*                                                          @G24LB26*/ 06430000
*/* OUTPUT - GROUP EXTENSION RECORD UPDATED WITH NEW RUNNING @G24LB26*/ 06431000
*/*          SPACE FOR PRIMARY VOLUME, PLUS EXPIRATION DATE  @G24LB26*/ 06432000
*/*          UPDATED FOR ANY VOLUME CHOSEN WITH A NULL       @G24LB26*/ 06433000
*/*          EXPIRATION DATE IF VOLUME IS IN A RETENTION     @G24LB26*/ 06434000
*/*          GROUP. BASE VOLUME RECORDS EXPIRATION DATE IS   @G24LB26*/ 06435000
*/*          UPDATED IF IT CHANGED. ANY EXPIRATION DATE      @G24LB26*/ 06436000
*/*          CHANGES ARE JOURNALED. ALSO, IT INITIALIZES A   @G24LB26*/ 06437000
*/*          FIELD IN AN INTERNAL PARAMETER LIST WITH        @G24LB26*/ 06438000
*/*          THE INDEX INTO THE BEST FIT TABLE, OF THE       @G24LB26*/ 06439000
*/*          VOLUME SELECTED FOR PRIMARY.                    @G24LB26*/ 06440000
*/*                                                          @G24LB26*/ 06441000
*/*********************************************************  @G24LB26*/ 06442000
*                                                                  1292 06443000
*UPDTMSVI:                                                         1292 06444000
*   PROC OPTIONS(SAVE(REG14));      /*                       @G24LB26*/ 06445000
*                                                                  1292 06446000
UPDTMSVI ST    @14,@SA00017                                        1292 06447000
*   /*****************************************************************/ 06448000
*   /*                                                               */ 06449000
*   /* SET SWITCHES CONTROLLING INITIAL I/O FOR EXTENSION    @G24LB26*/ 06450000
*   /* RECORD.                                               @G24LB26*/ 06451000
*   /*                                                               */ 06452000
*   /*****************************************************************/ 06453000
*                                                                  1293 06454000
*   UPDTGVSN=OFF;                   /* GVSNE NOT UPDATED YET @G24LB26*/ 06455000
*   BASEREAD=ON;                    /* GVSNE WILL BE READ    @G24LB26   06456000
*                                      FOR UPDATE ON FIRST   @G24LB26   06457000
*                                      PASS                  @G24LB26*/ 06458000
*   EXITSW=OFF;                     /* EXIT LOOP SWITCH      @G24LB26*/ 06459000
*   ERRORSW=OFF;                    /* NO ERRORS YET         @G24LB26*/ 06460000
*                                                                  1296 06461000
         OI    BASEREAD,B'01000000'                                1296 06462000
         NI    UPDTGVSN,B'01100111'                                1296 06463000
*   /*****************************************************************/ 06464000
*   /*                                                               */ 06465000
*   /* DETERMINE IF BEST FIT TABLE NEEDS TO BE SORTED        @G24LB26*/ 06466000
*   /* BY EXTENSION INDEX FOR EFFICIENCY OF I/O OPERATION.   @G24LB26*/ 06467000
*   /*                                                               */ 06468000
*   /*****************************************************************/ 06469000
*                                                                  1297 06470000
*   IF NUMBVOL>TWO&GRORETN=ON THEN  /*                       @G24LB26*/ 06471000
         CLI   NUMBVOL,2                                           1297 06472000
         BNH   @RF01297                                            1297 06473000
         L     @08,GROUPPTR                                        1297 06474000
         TM    GRORETN(@08),B'00000100'                            1297 06475000
         BNO   @RF01297                                            1297 06476000
*     DO;                           /*                       @G24LB26*/ 06477000
*                                                                  1298 06478000
*       /*************************************************************/ 06479000
*       /*                                                           */ 06480000
*       /* SET UP PARAMETER LIST TO CALL SORT ROUTINE        @G24LB26*/ 06481000
*       /*                                                           */ 06482000
*       /*************************************************************/ 06483000
*                                                                  1299 06484000
*       SRTADDR=ADDR(BFSLOT(ONE));  /* ADDR OF FIRST ENTRY   @G24LB26*/ 06485000
         L     @08,BFTBLPTR                                        1299 06486000
         LA    @06,BFSLOT(,@08)                                    1299 06487000
         ST    @06,SRTADDR                                         1299 06488000
*       SRTNUM=BFTOTIDX;            /* NO OF ELE IN ARRAY    @G24LB26*/ 06489000
         LH    @04,BFTOTIDX(,@08)                                  1300 06490000
         STH   @04,SRTNUM                                          1300 06491000
*       SRTLEN=LENGTH(BFSLOT);      /* LENGTH OF ONE ELE     @G24LB26*/ 06492000
         MVC   SRTLEN(2),@CH02240                                  1301 06493000
*       SRTBEG=ADDR(BFGRPIDX(ONE))-ADDR(BFSLOT(ONE));/*      @G24LB26   06494000
*                                      START OF SORT FIELD   @G24LB26*/ 06495000
*                                                                  1302 06496000
         LA    @08,BFGRPIDX(,@08)                                  1302 06497000
         SLR   @08,@06                                             1302 06498000
         STH   @08,SRTBEG                                          1302 06499000
*       /*************************************************************/ 06500000
*       /*                                                           */ 06501000
*       /* CHANGE FROM STARTING OFFSET TO STARTING COLUMN    @G24LB26*/ 06502000
*       /*                                                           */ 06503000
*       /*************************************************************/ 06504000
*                                                                  1303 06505000
*       SRTBEG=SRTBEG+ONE;          /* CHANGE TO START COL   @G24LB26*/ 06506000
         LA    @06,1                                               1303 06507000
         ALR   @08,@06                                             1303 06508000
         STH   @08,SRTBEG                                          1303 06509000
*       SRTFLDLN=LENGTH(BFGRPIDX(ONE));/* LENGTH OF SORT     @G24LB26   06510000
*                                      FIELD                 @G24LB26*/ 06511000
*                                                                  1304 06512000
         STH   @06,SRTFLDLN                                        1304 06513000
*       /*************************************************************/ 06514000
*       /*                                                           */ 06515000
*       /* CALL SORT PROCEDURE                               @G24LB26*/ 06516000
*       /*                                                           */ 06517000
*       /*************************************************************/ 06518000
*                                                                  1305 06519000
*       CALL SORT;                  /*                       @G24LB26*/ 06520000
         BAL   @14,SORT                                            1305 06521000
*     END;                          /*                       @G24LB26*/ 06522000
*                                                                  1306 06523000
*   /*****************************************************************/ 06524000
*   /*                                                               */ 06525000
*   /* LOOP THRU BEST FIT TABEL UPDATING NECESSARY RECORDS.  @G24LB26*/ 06526000
*   /* START AT BOTTOM SINCE THAT GVSNE IS THE MOST LIKELY   @G24LB26*/ 06527000
*   /* TO BE IN CORE CURRENTLY.                              @G24LB26*/ 06528000
*   /*                                                               */ 06529000
*   /*****************************************************************/ 06530000
*                                                                  1307 06531000
*   DO INDXBFTB=BFTOTIDX TO ONE BY-ONE WHILE EXITSW=OFF;/*   @G24LB26*/ 06532000
*                                                                  1307 06533000
@RF01297 L     @08,BFTBLPTR                                        1307 06534000
         LH    INDXBFTB,BFTOTIDX(,@08)                             1307 06535000
         B     @DE01307                                            1307 06536000
@DL01307 TM    EXITSW,B'00010000'                                  1307 06537000
         BNZ   @DC01307                                            1307 06538000
*     /***************************************************************/ 06539000
*     /*                                                             */ 06540000
*     /* LOOK FOR VOLUME SELECTED FOR EITHER PRIMARY OR      @G24LB26*/ 06541000
*     /* SECONDARY ALLOCATION AND DETERMINE IF ANY UPDATES   @G24LB26*/ 06542000
*     /* COULD BE NECESSARY.                                 @G24LB26*/ 06543000
*     /*                                                             */ 06544000
*     /***************************************************************/ 06545000
*                                                                  1308 06546000
*     IF BFSELPRI(INDXBFTB)=ON|(BFSELSEC(INDXBFTB)=ON/*      @G24LB26*/ 06547000
*         &GRORETN=ON) THEN         /*                       @G24LB26*/ 06548000
         L     @08,BFTBLPTR                                        1308 06549000
         LR    @04,INDXBFTB                                        1308 06550000
         MH    @04,@CH02240                                        1308 06551000
         ST    @04,@TF00001                                        1308 06552000
         ALR   @04,@08                                             1308 06553000
         TM    BFSELPRI-18(@04),B'00100000'                        1308 06554000
         BO    @RT01308                                            1308 06555000
         AL    @08,@TF00001                                        1308 06556000
         TM    BFSELSEC-18(@08),B'00010000'                        1308 06557000
         BNO   @RF01308                                            1308 06558000
         L     @08,GROUPPTR                                        1308 06559000
         TM    GRORETN(@08),B'00000100'                            1308 06560000
         BNO   @RF01308                                            1308 06561000
@RT01308 DS    0H                                                  1309 06562000
*       DO;                         /*                       @G24LB26*/ 06563000
*                                                                  1309 06564000
*         /***********************************************************/ 06565000
*         /*                                                         */ 06566000
*         /* CHECK TO SEE IF GVSNE ALREADY IN BUFFER AREA.   @G24LB26*/ 06567000
*         /* IF NOT, WRITE OLD RECORD IF NECESSARY AND       @G24LB26*/ 06568000
*         /* READ GROUP EXTENSION RECORD.                    @G24LB26*/ 06569000
*         /*                                                         */ 06570000
*         /***********************************************************/ 06571000
*                                                                  1310 06572000
*         IF GVSNO^=BFGRPIDX(INDXBFTB) THEN/*                @G24LB26*/ 06573000
         L     @08,GVSNEPTR                                        1310 06574000
         LR    @04,INDXBFTB                                        1310 06575000
         MH    @04,@CH02240                                        1310 06576000
         SLR   @15,@15                                             1310 06577000
         IC    @15,GVSNO(,@08)                                     1310 06578000
         L     @14,BFTBLPTR                                        1310 06579000
         SLR   @03,@03                                             1310 06580000
         IC    @03,BFGRPIDX-18(@04,@14)                            1310 06581000
         CR    @15,@03                                             1310 06582000
         BE    @RF01310                                            1310 06583000
*           DO;                     /*                       @G24LB26*/ 06584000
*                                                                  1311 06585000
*             /*******************************************************/ 06586000
*             /*                                                     */ 06587000
*             /* DETERMINE IF OLD GVSNE MUST BE WRITTEN      @G24LB26*/ 06588000
*             /* TO THE MSVI                                 @G24LB26*/ 06589000
*             /*                                                     */ 06590000
*             /*******************************************************/ 06591000
*                                                                  1312 06592000
*             IF UPDTGVSN=ON THEN   /* REC MUST BE WRITTEN   @G24LB26*/ 06593000
         TM    UPDTGVSN,B'10000000'                                1312 06594000
         BNO   @RF01312                                            1312 06595000
*               DO;                 /*                       @G24LB26*/ 06596000
*                                                                  1313 06597000
*                 /***************************************************/ 06598000
*                 /*                                                 */ 06599000
*                 /* CHECK IF THE RECORD MUST BE RE-READ     @G24LB26*/ 06600000
*                 /* FOR UPDATE BEFORE IT CAN BE WRITTEN.    @G24LB26*/ 06601000
*                 /*                                                 */ 06602000
*                 /***************************************************/ 06603000
*                                                                  1314 06604000
*                 IF BASEREAD=ON THEN/*                      @G24LB26*/ 06605000
         TM    BASEREAD,B'01000000'                                1314 06606000
         BNO   @RF01314                                            1314 06607000
*                   DO;             /*                       @G24LB26*/ 06608000
*                                                                  1315 06609000
*                     /***********************************************/ 06610000
*                     /*                                             */ 06611000
*                     /* READ EXTENSION RECORD CURRENTLY     @G24LB26*/ 06612000
*                     /* IN STORAGE FOR UPDATE               @G24LB26*/ 06613000
*                     /*                                             */ 06614000
*                     /***********************************************/ 06615000
*                                                                  1316 06616000
*                     GKEY=GVSNAME; /* SET UP KEY FOR THIS   @G24LB26   06617000
*                                      READ                  @G24LB26*/ 06618000
         MVC   GKEY(13),GVSNAME(@08)                               1316 06619000
*                     RPLVKEY=ADDR(GKEY);/* KEY TO READ FOR  @G24LB26*/ 06620000
         LA    @08,GKEY                                            1317 06621000
         ST    @08,RPLVKEY(,RPLVPTR)                               1317 06622000
*                     RPLVBUF=ADDR(DUMMYBUF);/* ADDR OF      @G24LB26   06623000
*                                      BUFFER                @G24LB26*/ 06624000
         LA    @08,DUMMYBUF                                        1318 06625000
         ST    @08,RPLVBUF(,RPLVPTR)                               1318 06626000
*                     RPLVBLN=LENGTH(DUMMYBUF);/* LENGTH     @G24LB26   06627000
*                                      OF BUFFER             @G24LB26*/ 06628000
         MVC   RPLVBLN(4,RPLVPTR),@CF02239                         1319 06629000
*                     RPLVDIR=ON;   /* READ DIRECT           @G24LB26*/ 06630000
         OI    RPLVDIR(RPLVPTR),B'01000000'                        1320 06631000
*                     RPLVTYP=RPLVREAD;/* READ REQUEST       @G24LB26*/ 06632000
         MVI   RPLVTYP(RPLVPTR),X'00'                              1321 06633000
*                     RPLVUPD=ON;   /* FOR UPDATE            @G24LB26*/ 06634000
         OI    RPLVUPD(RPLVPTR),B'00000010'                        1322 06635000
*                     RESPECIFY                                    1323 06636000
*                       REG1 RSTD;  /*                       @G24LB26*/ 06637000
*                     REG1=RPLVPTR; /* ADDR PRLV             @G24LB26*/ 06638000
         LR    REG1,RPLVPTR                                        1324 06639000
*                     CALL ICBVIO00;/* READ EXT REC          @G24LB26*/ 06640000
         L     @15,@CV01910                                        1325 06641000
         BALR  @14,@15                                             1325 06642000
*                     RESPECIFY                                    1326 06643000
*                       REG1 UNRSTD;/*                       @G24LB26*/ 06644000
*                   END;            /*                       @G24LB26*/ 06645000
*                                                                  1327 06646000
*                 /***************************************************/ 06647000
*                 /*                                                 */ 06648000
*                 /* WRITE EXTENSION RECORD NOW IN BUFFER    @G24LB26*/ 06649000
*                 /*                                                 */ 06650000
*                 /***************************************************/ 06651000
*                                                                  1328 06652000
*                 RPLVBUF=ADDR(STORGPEX);/* ADDR OF RECORD   @G24LB26   06653000
*                                      IN BUFFER             @G24LB26*/ 06654000
@RF01314 LA    @08,STORGPEX                                        1328 06655000
         ST    @08,RPLVBUF(,RPLVPTR)                               1328 06656000
*                 RPLVTYP=RPLVPUT;  /* PUT RECORD            @G24LB26*/ 06657000
         MVI   RPLVTYP(RPLVPTR),X'01'                              1329 06658000
*                 RESPECIFY                                        1330 06659000
*                   REG1 RSTD;      /*                       @G24LB26*/ 06660000
*                 REG1=RPLVPTR;     /* ADDR OF RPLV          @G24LB26*/ 06661000
         LR    REG1,RPLVPTR                                        1331 06662000
*                 CALL ICBVIO00;    /* WRITE EXTENSION       @G24LB26*/ 06663000
         L     @15,@CV01910                                        1332 06664000
         BALR  @14,@15                                             1332 06665000
*                 RESPECIFY                                        1333 06666000
*                   REG1 UNRSTD;    /*                       @G24LB26*/ 06667000
*                 RPLVRETC=RCZERO;  /* CLEAR RETURN CODE     @G24LB26*/ 06668000
         MVC   RPLVRETC(2,RPLVPTR),@CB02111                        1334 06669000
*                 RPLRCODE=RCZERO;  /* CLEAR REASON CODE     @G24LB26*/ 06670000
         MVC   RPLRCODE(2,RPLVPTR),@CB02111                        1335 06671000
*                 UPDTGVSN=OFF;     /* INDICATE NO LONGER    @G24LB26   06672000
*                                      NEEDS TO BE WRITTEN   @G24LB26*/ 06673000
         NI    UPDTGVSN,B'01111111'                                1336 06674000
*               END;                /*                       @G24LB26*/ 06675000
*                                                                  1337 06676000
*             /*******************************************************/ 06677000
*             /*                                                     */ 06678000
*             /* READ THE NEW EXTENSION RECORD FOR UPDATE    @G24LB26*/ 06679000
*             /* SINCE IT IS NOT IN THE BUFFER.              @G24LB26*/ 06680000
*             /*                                                     */ 06681000
*             /*******************************************************/ 06682000
*                                                                  1338 06683000
*             GIDKY=BFGRPIDX(INDXBFTB);/* INDEX OF EXT       @G24LB26   06684000
*                                      TO READ               @G24LB26*/ 06685000
@RF01312 LR    @08,INDXBFTB                                        1338 06686000
         MH    @08,@CH02240                                        1338 06687000
         L     @04,BFTBLPTR                                        1338 06688000
         SLR   @15,@15                                             1338 06689000
         IC    @15,BFGRPIDX-18(@08,@04)                            1338 06690000
         STC   @15,GIDKY                                           1338 06691000
*             RPLVKEY=ADDR(GKEY);   /* ADDR OF KEY           @G24LB26*/ 06692000
         LA    @08,GKEY                                            1339 06693000
         ST    @08,RPLVKEY(,RPLVPTR)                               1339 06694000
*             RPLVBUF=ADDR(STORGPEX);/* ADDR OF BUFFER       @G24LB26*/ 06695000
         LA    @08,STORGPEX                                        1340 06696000
         ST    @08,RPLVBUF(,RPLVPTR)                               1340 06697000
*             RPLVBLN=LENGTH(STORGPEX);/* LENGTH OF BUFFER   @G24LB26*/ 06698000
         MVC   RPLVBLN(4,RPLVPTR),@CF02239                         1341 06699000
*             RPLVDIR=ON;           /* READ DIRECT           @G24LB26*/ 06700000
         OI    RPLVDIR(RPLVPTR),B'01000000'                        1342 06701000
*             RPLVTYP=RPLVREAD;     /* READ RECORD           @G24LB26*/ 06702000
         MVI   RPLVTYP(RPLVPTR),X'00'                              1343 06703000
*             RPLVUPD=ON;           /* FOR UPDATE            @G24LB26*/ 06704000
         OI    RPLVUPD(RPLVPTR),B'00000010'                        1344 06705000
*             RESPECIFY                                            1345 06706000
*               REG1 RSTD;          /*                       @G24LB26*/ 06707000
*             REG1=RPLVPTR;         /* ADDR OF RPLV          @G24LB26*/ 06708000
         LR    REG1,RPLVPTR                                        1346 06709000
*             CALL ICBVIO00;        /* READ EXT RECORD       @G24LB26*/ 06710000
         L     @15,@CV01910                                        1347 06711000
         BALR  @14,@15                                             1347 06712000
*             RESPECIFY                                            1348 06713000
*               REG1 UNRSTD;        /*                       @G24LB26*/ 06714000
*             RPLVRETC=RCZERO;      /* CLEAR RETURN CODE     @G24LB26*/ 06715000
         MVC   RPLVRETC(2,RPLVPTR),@CB02111                        1349 06716000
*             RPLRCODE=RCZERO;      /* CLEAR REASON CODE     @G24LB26*/ 06717000
         MVC   RPLRCODE(2,RPLVPTR),@CB02111                        1350 06718000
*             BASEREAD=OFF;         /* INDICATE NO LONGER    @G24LB26   06719000
*                                      NECESSARY READ EXT    @G24LB26   06720000
*                                      FOR UPDATE            @G24LB26*/ 06721000
         NI    BASEREAD,B'10111111'                                1351 06722000
*           END;                    /*                       @G24LB26*/ 06723000
*                                                                  1352 06724000
*         /***********************************************************/ 06725000
*         /*                                                         */ 06726000
*         /* PROPER EXTENSION RECORD IS NOW IN THE BUFFER    @G24LB26*/ 06727000
*         /* AND CAN THEREFORE BE UPDATED AS NECESSARY.      @G24LB26*/ 06728000
*         /* IF THE VOLUME IS A PRIMARY, UPDATE THE SPACE.   @G24LB26*/ 06729000
*         /*                                                         */ 06730000
*         /***********************************************************/ 06731000
*                                                                  1353 06732000
*         IF BFSELPRI(INDXBFTB)=ON THEN/*                    @G24LB26*/ 06733000
@RF01310 L     @08,BFTBLPTR                                        1353 06734000
         LR    @04,INDXBFTB                                        1353 06735000
         MH    @04,@CH02240                                        1353 06736000
         ST    @04,@TF00001                                        1353 06737000
         ALR   @04,@08                                             1353 06738000
         TM    BFSELPRI-18(@04),B'00100000'                        1353 06739000
         BNO   @RF01353                                            1353 06740000
*           DO;                     /*                       @G24LB26*/ 06741000
*             GVSMTDSP(BFGRPSLT(INDXBFTB))=/*                @G24LB26*/ 06742000
*                 GVSMTDSP(BFGRPSLT(INDXBFTB))-PRICYL;/*     @G24LB26*/ 06743000
*                                                                  1355 06744000
         L     @04,GVSNEPTR                                        1355 06745000
         L     @01,@TF00001                                        1355 06746000
         SLR   @15,@15                                             1355 06747000
         IC    @15,BFGRPSLT-18(@01,@08)                            1355 06748000
         MH    @15,@CH01851                                        1355 06749000
         LH    @08,GVSMTDSP-20(@15,@04)                            1355 06750000
         SH    @08,PRICYL                                          1355 06751000
         STH   @08,GVSMTDSP-20(@15,@04)                            1355 06752000
*             /*******************************************************/ 06753000
*             /*                                                     */ 06754000
*             /* IF VALUE WENT NEGATIVE, SET IT TO ZERO      @G24LB26*/ 06755000
*             /*                                                     */ 06756000
*             /*******************************************************/ 06757000
*                                                                  1356 06758000
*             IF GVSMTDSP(BFGRPSLT(INDXBFTB))<ZERO THEN/*    @G24LB26*/ 06759000
         SLR   @14,@14                                             1356 06760000
         CR    @08,@14                                             1356 06761000
         BNL   @RF01356                                            1356 06762000
*               GVSMTDSP(BFGRPSLT(INDXBFTB))=ZERO;/*         @G24LB26*/ 06763000
*                                                                  1357 06764000
         STH   @14,GVSMTDSP-20(@15,@04)                            1357 06765000
*             /*******************************************************/ 06766000
*             /*                                                     */ 06767000
*             /* SET INDEX INTO BEST FIT TABLE FOR PRIMARY   @G24LB26*/ 06768000
*             /* VOLUME                                      @G24LB26*/ 06769000
*             /*                                                     */ 06770000
*             /*******************************************************/ 06771000
*                                                                  1358 06772000
*             PRIBFIDX=INDXBFTB;    /*                       @G24LB26*/ 06773000
*                                                                  1358 06774000
@RF01356 STC   INDXBFTB,PRIBFIDX                                   1358 06775000
*             /*******************************************************/ 06776000
*             /*                                                     */ 06777000
*             /* INDICATE EXTENSION RECORD UPDATED           @G24LB26*/ 06778000
*             /*                                                     */ 06779000
*             /*******************************************************/ 06780000
*                                                                  1359 06781000
*             UPDTGVSN=ON;          /*                       @G24LB26*/ 06782000
         OI    UPDTGVSN,B'10000000'                                1359 06783000
*           END;                    /*                       @G24LB26*/ 06784000
*                                                                  1360 06785000
*         /***********************************************************/ 06786000
*         /*                                                         */ 06787000
*         /* CHECK TO SEE IF GROUP RETENTION APPLIES, AND    @G24LB26*/ 06788000
*         /* UPDATE THE EXPIRATION DATE IF VOLUME HAD A      @G24LB26*/ 06789000
*         /* NULL EXPIRATON DATE BEFORE                      @G24LB26*/ 06790000
*         /*                                                         */ 06791000
*         /***********************************************************/ 06792000
*                                                                  1361 06793000
*         IF GRORETN=ON&            /*                       @G24LB26*/ 06794000
*             GVSEXPDT(BFGRPSLT(INDXBFTB))=NULEXPDT THEN/*   @G24LB26*/ 06795000
@RF01353 L     @08,GROUPPTR                                        1361 06796000
         TM    GRORETN(@08),B'00000100'                            1361 06797000
         BNO   @RF01361                                            1361 06798000
         L     @08,GVSNEPTR                                        1361 06799000
         L     @04,BFTBLPTR                                        1361 06800000
         LR    @15,INDXBFTB                                        1361 06801000
         MH    @15,@CH02240                                        1361 06802000
         SLR   @14,@14                                             1361 06803000
         IC    @14,BFGRPSLT-18(@15,@04)                            1361 06804000
         MH    @14,@CH01851                                        1361 06805000
         ST    @14,@TF00001                                        1361 06806000
         ALR   @14,@08                                             1361 06807000
         CLC   GVSEXPDT-20(4,@14),NULEXPDT                         1361 06808000
         BNE   @RF01361                                            1361 06809000
*           DO;                     /*                       @G24LB26*/ 06810000
*                                                                  1362 06811000
*             /*******************************************************/ 06812000
*             /*                                                     */ 06813000
*             /* UPDATE EXPIRATION DATE AND INDICATE         @G24LB26*/ 06814000
*             /* EXTENSION UPDATED                           @G24LB26*/ 06815000
*             /*                                                     */ 06816000
*             /*******************************************************/ 06817000
*                                                                  1363 06818000
*             GVSEXPDT(BFGRPSLT(INDXBFTB))=/*                @G24LB26*/ 06819000
*                 BFVOLEXP(INDXBFTB);/*                      @G24LB26*/ 06820000
         AL    @08,@TF00001                                        1363 06821000
         ST    @15,@TF00001                                        1363 06822000
         ALR   @15,@04                                             1363 06823000
         MVC   GVSEXPDT-20(4,@08),BFVOLEXP-18(@15)                 1363 06824000
*             UPDTGVSN=ON;          /*                       @G24LB26*/ 06825000
*                                                                  1364 06826000
         OI    UPDTGVSN,B'10000000'                                1364 06827000
*             /*******************************************************/ 06828000
*             /*                                                     */ 06829000
*             /* ISSUE MESSAGE ICB481I TELLING THAT VOLUME   @G24LB26*/ 06830000
*             /* HAS A NEW EXPIRATION DATE.                  @G24LB26*/ 06831000
*             /* CONVERT DATE TO PRINTABLE FORMAT.           @G24LB26*/ 06832000
*             /*                                                     */ 06833000
*             /*******************************************************/ 06834000
*                                                                  1365 06835000
*             DBLWORD=DBLWORD&&DBLWORD;/*                    @G24LB26*/ 06836000
         XC    DBLWORD(8),DBLWORD                                  1365 06837000
*             UNPK(DBLWORD,BFVOLEXP(INDXBFTB));/*            @G24LB26   06838000
*                                      CONVERT TO PRINTABLE  @G24LB26*/ 06839000
         LR    @08,@04                                             1366 06840000
         AL    @08,@TF00001                                        1366 06841000
         UNPK  DBLWORD(8),BFVOLEXP-18(4,@08)                       1366 06842000
*             DBLWORD(8:8)=DBLWORD(8:8)|ORSIGN;/* FIX SIGN   @G24LB26*/ 06843000
         OC    DBLWORD+7(1),ORSIGN                                 1367 06844000
*             MSGRQ=MSGRQ&&MSGRQ;   /* CLEAR MSG PARM LIST   @G24LB26*/ 06845000
         XC    MSGRQ(32),MSGRQ                                     1368 06846000
*             MSGRPLV=RPLVPTR;      /* RPLV ADDR             @G24LB26*/ 06847000
         ST    RPLVPTR,MSGRPLV                                     1369 06848000
*             MSGID=MSG481;         /* MSG ID FOR ICB481I    @G24LB26*/ 06849000
         MVC   MSGID(4),@CF02073                                   1370 06850000
*             MSGLEN1=SIX;          /* VOLID LENGTH          @G24LB26*/ 06851000
         MVI   MSGLEN1,X'06'                                       1371 06852000
*             MSGTEXT1=ADDR(BFVOLID(INDXBFTB));/* VOLID      @G24LB26*/ 06853000
         L     @08,@TF00001                                        1372 06854000
         LA    @08,BFVOLID-18(@08,@04)                             1372 06855000
         STCM  @08,7,MSGTEXT1                                      1372 06856000
*             MSGLEN2=EIGHT;        /* LENGTH OF GROUP NAME  @G24LB26*/ 06857000
         MVI   MSGLEN2,X'08'                                       1373 06858000
*             MSGTEXT2=ADDR(BFGROUP);/* GROUP NAME           @G24LB26*/ 06859000
         LA    @08,BFGROUP(,@04)                                   1374 06860000
         STCM  @08,7,MSGTEXT2                                      1374 06861000
*             MSGLEN3=FIVE;         /* LENGTH OF JULIAN DATE @G24LB26*/ 06862000
         MVI   MSGLEN3,X'05'                                       1375 06863000
*             MSGTEXT3=ADDR(DBLWORD)+THREE;/* JULIAN EXPIR   @G24LB26   06864000
*                                      DATE                  @G24LB26*/ 06865000
         LA    @08,DBLWORD                                         1376 06866000
         LA    @08,3(,@08)                                         1376 06867000
         STCM  @08,7,MSGTEXT3                                      1376 06868000
*             RESPECIFY                                            1377 06869000
*               REG1 RSTD;          /*                       @G24LB26*/ 06870000
*             REG1=ADDR(MSGRQ);     /* ADDR MSG PARM LIST    @G24LB26*/ 06871000
         LA    REG1,MSGRQ                                          1378 06872000
*             CALL ICBVOP00;        /* ISSUE MESSAGE         @G24LB26*/ 06873000
         L     @15,@CV01912                                        1379 06874000
         BALR  @14,@15                                             1379 06875000
*             RESPECIFY                                            1380 06876000
*               REG1 UNRSTD;        /*                       @G24LB26*/ 06877000
*                                                                  1380 06878000
*             /*******************************************************/ 06879000
*             /*                                                     */ 06880000
*             /* CALL JOURNAL TO BUILD A MODIFY VOLUME RPL   @G24LB26*/ 06881000
*             /* AND JOURNAL IT FOR THE UPDATED EXPIRATION   @G24LB26*/ 06882000
*             /* DATE.                                       @G24LB26*/ 06883000
*             /*                                                     */ 06884000
*             /*******************************************************/ 06885000
*                                                                  1381 06886000
*             CALL JOURNAL;         /*                       @G24LB26*/ 06887000
*                                                                  1381 06888000
         BAL   @14,JOURNAL                                         1381 06889000
*             /*******************************************************/ 06890000
*             /*                                                     */ 06891000
*             /* READ THE BASE VOLUME RECORD AND UPDATE      @G24LB26*/ 06892000
*             /* ITS EXPIRATION DATE.                        @G24LB26*/ 06893000
*             /*                                                     */ 06894000
*             /*******************************************************/ 06895000
*                                                                  1382 06896000
*             BASEREAD=ON;          /* INDICATE BASE VOLUME  @G24LB26   06897000
*                                      BEING READ            @G24LB26*/ 06898000
         OI    BASEREAD,B'01000000'                                1382 06899000
*             VOLKY=BFVOLID(INDXBFTB);/* VOLID OF BASE REC   @G24LB26*/ 06900000
         LR    @08,INDXBFTB                                        1383 06901000
         MH    @08,@CH02240                                        1383 06902000
         L     @04,BFTBLPTR                                        1383 06903000
         ALR   @04,@08                                             1383 06904000
         MVC   VOLKY(6),BFVOLID-18(@04)                            1383 06905000
*             RPLVKEY=ADDR(VKEY);   /* ADDR OF KEY           @G24LB26*/ 06906000
         LA    @08,VKEY                                            1384 06907000
         ST    @08,RPLVKEY(,RPLVPTR)                               1384 06908000
*             RPLVBUF=ADDR(STORBASE);/* ADDR BASE BUFFER     @G24LB26*/ 06909000
         LA    @08,STORBASE                                        1385 06910000
         ST    @08,RPLVBUF(,RPLVPTR)                               1385 06911000
*             RPLVBLN=LENGTH(STORBASE);/* LENGTH OF BUFFER   @G24LB26*/ 06912000
         MVC   RPLVBLN(4,RPLVPTR),@CF02241                         1386 06913000
*             RPLVDIR=ON;           /* READ DIRECT           @G24LB26*/ 06914000
         OI    RPLVDIR(RPLVPTR),B'01000000'                        1387 06915000
*             RPLVTYP=RPLVREAD;     /* READ RECORD           @G24LB26*/ 06916000
         MVI   RPLVTYP(RPLVPTR),X'00'                              1388 06917000
*             RPLVUPD=ON;           /* READ FOR UPDATE       @G24LB26*/ 06918000
         OI    RPLVUPD(RPLVPTR),B'00000010'                        1389 06919000
*             RESPECIFY                                            1390 06920000
*               REG1 RSTD;          /*                       @G24LB26*/ 06921000
*             REG1=RPLVPTR;         /* ADDR RPLV             @G24LB26*/ 06922000
         LR    REG1,RPLVPTR                                        1391 06923000
*             CALL ICBVIO00;        /* READ BASE RECORD      @G24LB26*/ 06924000
         L     @15,@CV01910                                        1392 06925000
         BALR  @14,@15                                             1392 06926000
*             RESPECIFY                                            1393 06927000
*               REG1 UNRSTD;        /*                       @G24LB26*/ 06928000
*                                                                  1393 06929000
*             /*******************************************************/ 06930000
*             /*                                                     */ 06931000
*             /* CHECK IF BASE VOLUME READ SUCCESSFULLY.     @G24LB26*/ 06932000
*             /* IF SUCCESSFUL, UPDATE AND WRITE IT. IF      @G24LB26*/ 06933000
*             /* NOT, ZERO RETURN AND REASON CODE AND        @G24LB26*/ 06934000
*             /* CONTINUE WITH NEXT VOLUME.                  @G24LB26*/ 06935000
*             /*                                                     */ 06936000
*             /*******************************************************/ 06937000
*                                                                  1394 06938000
*             IF RPLVRETC=RCZERO THEN/*                      @G24LB26*/ 06939000
         CLC   RPLVRETC(2,RPLVPTR),@CB02111                        1394 06940000
         BNE   @RF01394                                            1394 06941000
*               DO;                 /*                       @G24LB26*/ 06942000
*                                                                  1395 06943000
*                 /***************************************************/ 06944000
*                 /*                                                 */ 06945000
*                 /* UPDATE EXPIRATION DATE IN BASE VOLUME   @G24LB26*/ 06946000
*                 /* RECORD.                                 @G24LB26*/ 06947000
*                 /*                                                 */ 06948000
*                 /***************************************************/ 06949000
*                                                                  1396 06950000
*                 BASEXPDT=BFVOLEXP(INDXBFTB);/*             @G24LB26*/ 06951000
*                                                                  1396 06952000
         L     @08,BASEVPTR                                        1396 06953000
         LR    @04,INDXBFTB                                        1396 06954000
         MH    @04,@CH02240                                        1396 06955000
         L     @01,BFTBLPTR                                        1396 06956000
         ALR   @01,@04                                             1396 06957000
         MVC   BASEXPDT(4,@08),BFVOLEXP-18(@01)                    1396 06958000
*                 /***************************************************/ 06959000
*                 /*                                                 */ 06960000
*                 /* WRITE BASE VOLUME RECORD                @G24LB26*/ 06961000
*                 /*                                                 */ 06962000
*                 /***************************************************/ 06963000
*                                                                  1397 06964000
*                 RPLVTYP=RPLVPUT;  /* PUT OUT BASE          @G24LB26*/ 06965000
         MVI   RPLVTYP(RPLVPTR),X'01'                              1397 06966000
*                 RESPECIFY                                        1398 06967000
*                   REG1 RSTD;      /*                       @G24LB26*/ 06968000
*                 REG1=RPLVPTR;     /*                       @G24LB26*/ 06969000
         LR    REG1,RPLVPTR                                        1399 06970000
*                 CALL ICBVIO00;    /* WRITE BASE RECORD     @G24LB26*/ 06971000
         L     @15,@CV01910                                        1400 06972000
         BALR  @14,@15                                             1400 06973000
*                 RESPECIFY                                        1401 06974000
*                   REG1 UNRSTD;    /*                       @G24LB26*/ 06975000
*                 RPLVRETC=RCZERO;  /* CLEAR RETURN CODE     @G24LB26*/ 06976000
         MVC   RPLVRETC(2,RPLVPTR),@CB02111                        1402 06977000
*                 RPLRCODE=RCZERO;  /* CLEAR REASON CODE     @G24LB26*/ 06978000
         MVC   RPLRCODE(2,RPLVPTR),@CB02111                        1403 06979000
*               END;                /*                       @G24LB26*/ 06980000
*                                                                  1404 06981000
*             /*******************************************************/ 06982000
*             /*                                                     */ 06983000
*             /* I/O ERROR ON BASE VOLUME RECORD READ        @G24LB26*/ 06984000
*             /*                                                     */ 06985000
*             /*******************************************************/ 06986000
*                                                                  1405 06987000
*             ELSE                  /*                       @G24LB26*/ 06988000
*               DO;                 /*                       @G24LB26*/ 06989000
*                                                                  1405 06990000
         B     @RC01394                                            1405 06991000
@RF01394 DS    0H                                                  1406 06992000
*                 /***************************************************/ 06993000
*                 /*                                                 */ 06994000
*                 /* ISSUE MESSAGE ICB402I                   @G24LB26*/ 06995000
*                 /*                                                 */ 06996000
*                 /***************************************************/ 06997000
*                                                                  1406 06998000
*                 MSGRQ=MSGRQ&&MSGRQ;/* CLEAR MSG PARM       @G24LB26*/ 06999000
         XC    MSGRQ(32),MSGRQ                                     1406 07000000
*                 MSGRPLV=RPLVPTR;  /* RPLV PTR              @G24LB26*/ 07001000
         ST    RPLVPTR,MSGRPLV                                     1407 07002000
*                 MSGID=MSG402;     /* MSG ID FOR ICB402I    @G24LB26*/ 07003000
         MVC   MSGID(4),@CF02059                                   1408 07004000
*                 MSGLEN1=SIX;      /* VOLID LENGTH          @G24LB26*/ 07005000
         MVI   MSGLEN1,X'06'                                       1409 07006000
*                 MSGTEXT1=ADDR(BFVOLID(INDXBFTB));/* VOLID  @G24LB26*/ 07007000
         LR    @08,INDXBFTB                                        1410 07008000
         MH    @08,@CH02240                                        1410 07009000
         L     @04,BFTBLPTR                                        1410 07010000
         LA    @08,BFVOLID-18(@08,@04)                             1410 07011000
         STCM  @08,7,MSGTEXT1                                      1410 07012000
*                 RESPECIFY                                        1411 07013000
*                   REG1 RSTD;      /*                       @G24LB26*/ 07014000
*                 REG1=ADDR(MSGRQ); /* ADDR MSG PARM LIST    @G24LB26*/ 07015000
         LA    REG1,MSGRQ                                          1412 07016000
*                 CALL ICBVOP00;    /* ISSUE MESSAGE         @G24LB26*/ 07017000
         L     @15,@CV01912                                        1413 07018000
         BALR  @14,@15                                             1413 07019000
*                 RESPECIFY                                        1414 07020000
*                   REG1 UNRSTD;    /*                       @G24LB26*/ 07021000
*                                                                  1414 07022000
*                 /***************************************************/ 07023000
*                 /*                                                 */ 07024000
*                 /* CLEAR REASON AND RETURN CODES SO        @G24LB26*/ 07025000
*                 /* REQUEST WILL NOT FAIL                   @G24LB26*/ 07026000
*                 /*                                                 */ 07027000
*                 /***************************************************/ 07028000
*                                                                  1415 07029000
*                 RPLVRETC=RCZERO;  /*                       @G24LB26*/ 07030000
         MVC   RPLVRETC(2,RPLVPTR),@CB02111                        1415 07031000
*                 RPLRCODE=RCZERO;  /*                       @G24LB26*/ 07032000
         MVC   RPLRCODE(2,RPLVPTR),@CB02111                        1416 07033000
*               END;                /*                       @G24LB26*/ 07034000
*           END;                    /*                       @G24LB26*/ 07035000
*                                                                  1418 07036000
@RC01394 DS    0H                                                  1419 07037000
*         /***********************************************************/ 07038000
*         /*                                                         */ 07039000
*         /* CHECK ON STATUS OF VOLUMES PROCESSED TO         @G24LB26*/ 07040000
*         /* DETERMINE IF POSSIBLE TO HAULT SCANNING OF      @G24LB26*/ 07041000
*         /* BEST FIT TABLE. IF PRIMARY VOLUME PROCESSED     @G24LB26*/ 07042000
*         /* AND NO GROUP RETENTION OR ONLY ONE VOLUME       @G24LB26*/ 07043000
*         /* SELECTED, EXIT LOOP.                            @G24LB26*/ 07044000
*         /*                                                         */ 07045000
*         /***********************************************************/ 07046000
*                                                                  1419 07047000
*         IF PRIBFIDX^=ZERO&(NUMBVOL=ONE|GRORETN=OFF)/*      @G24LB26*/ 07048000
*           THEN                    /*                       @G24LB26*/ 07049000
@RF01361 CLI   PRIBFIDX,0                                          1419 07050000
         BE    @RF01419                                            1419 07051000
         CLI   NUMBVOL,1                                           1419 07052000
         BE    @RT01419                                            1419 07053000
         L     @08,GROUPPTR                                        1419 07054000
         TM    GRORETN(@08),B'00000100'                            1419 07055000
         BNZ   @RF01419                                            1419 07056000
@RT01419 DS    0H                                                  1420 07057000
*           EXITSW=ON;              /*                       @G24LB26*/ 07058000
         OI    EXITSW,B'00010000'                                  1420 07059000
*       END;                        /*                       @G24LB26*/ 07060000
@RF01419 DS    0H                                                  1422 07061000
*   END;                            /*                       @G24LB26*/ 07062000
*                                                                  1422 07063000
@RF01308 BCTR  INDXBFTB,0                                          1422 07064000
@DE01307 C     INDXBFTB,@CF00043                                   1422 07065000
         BNL   @DL01307                                            1422 07066000
@DC01307 DS    0H                                                  1423 07067000
*   /*****************************************************************/ 07068000
*   /*                                                               */ 07069000
*   /* CHECK TO SEE IF AN EXTENSION RECORD MUST BE WRITTEN   @G24LB26*/ 07070000
*   /* OUT OF THE BUFFER BEFORE EXITING ROUTINE.             @G24LB26*/ 07071000
*   /*                                                               */ 07072000
*   /*****************************************************************/ 07073000
*                                                                  1423 07074000
*   IF UPDTGVSN=ON THEN             /*                       @G24LB26*/ 07075000
         TM    UPDTGVSN,B'10000000'                                1423 07076000
         BNO   @RF01423                                            1423 07077000
*     DO;                           /*                       @G24LB26*/ 07078000
*                                                                  1424 07079000
*       /*************************************************************/ 07080000
*       /*                                                           */ 07081000
*       /* CHECK IF RECORD MUST FIRST BE READ FOR UPDATE     @G24LB26*/ 07082000
*       /* BEFORE IT CAN BE WRITTEN.                         @G24LB26*/ 07083000
*       /*                                                           */ 07084000
*       /*************************************************************/ 07085000
*                                                                  1425 07086000
*       IF BASEREAD=ON THEN         /*                       @G24LB26*/ 07087000
         TM    BASEREAD,B'01000000'                                1425 07088000
         BNO   @RF01425                                            1425 07089000
*         DO;                       /*                       @G24LB26*/ 07090000
*                                                                  1426 07091000
*           /*********************************************************/ 07092000
*           /*                                                       */ 07093000
*           /* READ EXTENSION RECORD CURRENTLY IN STORAGE    @G24LB26*/ 07094000
*           /* FOR UPDATE                                    @G24LB26*/ 07095000
*           /*                                                       */ 07096000
*           /*********************************************************/ 07097000
*                                                                  1427 07098000
*           GKEY=GVSNAME;           /* ENSURE KEY SET        @G24LB26   07099000
*                                      PROPERLY              @G24LB26*/ 07100000
         L     @08,GVSNEPTR                                        1427 07101000
         MVC   GKEY(13),GVSNAME(@08)                               1427 07102000
*           RPLVKEY=ADDR(GKEY);     /* ADDR OF KEY           @G24LB26*/ 07103000
         LA    @08,GKEY                                            1428 07104000
         ST    @08,RPLVKEY(,RPLVPTR)                               1428 07105000
*           RPLVBUF=ADDR(DUMMYBUF); /* ADDR OF DUMMY BUFFER  @G24LB26*/ 07106000
         LA    @08,DUMMYBUF                                        1429 07107000
         ST    @08,RPLVBUF(,RPLVPTR)                               1429 07108000
*           RPLVBLN=LENGTH(DUMMYBUF);/* LEN OF DUMMY BUFFER  @G24LB26*/ 07109000
         MVC   RPLVBLN(4,RPLVPTR),@CF02239                         1430 07110000
*           RPLVDIR=ON;             /* READ DIRECT           @G24LB26*/ 07111000
         OI    RPLVDIR(RPLVPTR),B'01000000'                        1431 07112000
*           RPLVTYP=RPLVREAD;       /* READ FUNCTION         @G24LB26*/ 07113000
         MVI   RPLVTYP(RPLVPTR),X'00'                              1432 07114000
*           RPLVUPD=ON;             /* READ FOR UPDATE       @G24LB26*/ 07115000
         OI    RPLVUPD(RPLVPTR),B'00000010'                        1433 07116000
*           RESPECIFY                                              1434 07117000
*             REG1 RSTD;            /*                       @G24LB26*/ 07118000
*           REG1=RPLVPTR;           /* ADDR RPLV             @G24LB26*/ 07119000
         LR    REG1,RPLVPTR                                        1435 07120000
*           CALL ICBVIO00;          /* READ EXTENSION RECORD @G24LB26*/ 07121000
         L     @15,@CV01910                                        1436 07122000
         BALR  @14,@15                                             1436 07123000
*           RESPECIFY                                              1437 07124000
*             REG1 UNRSTD;          /*                       @G24LB26*/ 07125000
*           BASEREAD=OFF;           /* INDICATE RECORD READ  @G24LB26   07126000
*                                      FOR DEBUG PURPOSES    @G24LB26*/ 07127000
         NI    BASEREAD,B'10111111'                                1438 07128000
*         END;                      /*                       @G24LB26*/ 07129000
*                                                                  1439 07130000
*       /*************************************************************/ 07131000
*       /*                                                           */ 07132000
*       /* WRITE THE EXTENSION RECORD NOW IN THE BUFFER      @G24LB26*/ 07133000
*       /*                                                           */ 07134000
*       /*************************************************************/ 07135000
*                                                                  1440 07136000
*       RPLVBUF=ADDR(STORGPEX);     /* ADDR OF NON-DUMMY EXT @G24LB26*/ 07137000
@RF01425 LA    @08,STORGPEX                                        1440 07138000
         ST    @08,RPLVBUF(,RPLVPTR)                               1440 07139000
*       RPLVTYP=RPLVPUT;            /* PUT RECORD            @G24LB26*/ 07140000
         MVI   RPLVTYP(RPLVPTR),X'01'                              1441 07141000
*       RESPECIFY                                                  1442 07142000
*         REG1 RSTD;                /*                       @G24LB26*/ 07143000
*       REG1=RPLVPTR;               /* ADDR RPLV             @G24LB26*/ 07144000
         LR    REG1,RPLVPTR                                        1443 07145000
*       CALL ICBVIO00;              /* WRITE EXTENSION REC   @G24LB26*/ 07146000
         L     @15,@CV01910                                        1444 07147000
         BALR  @14,@15                                             1444 07148000
*       RESPECIFY                                                  1445 07149000
*         REG1 UNRSTD;              /*                       @G24LB26*/ 07150000
*       RPLVRETC=RCZERO;            /* CLEAR RETURN CODE     @G24LB26*/ 07151000
         MVC   RPLVRETC(2,RPLVPTR),@CB02111                        1446 07152000
*       RPLRCODE=RCZERO;            /* CLEAR REASON CODE     @G24LB26*/ 07153000
         MVC   RPLRCODE(2,RPLVPTR),@CB02111                        1447 07154000
*       UPDTGVSN=OFF;               /* INDICATE EXTENSION    @G24LB26   07155000
*                                      WRITTEN FOR DEBUG     @G24LB26   07156000
*                                      PURPOSES              @G24LB26*/ 07157000
         NI    UPDTGVSN,B'01111111'                                1448 07158000
*     END;                          /*                       @G24LB26*/ 07159000
*   RETURN;                         /*                       @G24LB26*/ 07160000
@EL00017 DS    0H                                                  1450 07161000
@EF00017 DS    0H                                                  1450 07162000
@ER00017 L     @14,@SA00017                                        1450 07163000
         BR    @14                                                 1450 07164000
*   END UPDTMSVI;                   /*                       @G24LB26*/ 07165000
         B     @EL00017                                            1451 07166000
*                                                                  1452 07167000
*/*********************************************************  @G24LB26*/ 07168000
*/*                                                          @G24LB26*/ 07169000
*/* PROCEDURE NAME - JOURNAL                                 @G24LB26*/ 07170000
*/*                                                          @G24LB26*/ 07171000
*/* FUNCTION - BUILDS A REQUEST LIST FOR A MODIFY VOLUME     @G24LB26*/ 07172000
*/*            RECORD WHENEVER THE EXPIRATION DATE IS        @G24LB26*/ 07173000
*/*            UPDATED BY THE SELECTOR MODULE. IT THEN CALLS @G24LB26*/ 07174000
*/*            THE JOURNAL PROGRAM (ICBVJL00) TO JOURNAL THE @G24LB26*/ 07175000
*/*            MODIFY VOLUME RECORD COMMAND.                 @G24LB26*/ 07176000
*/*                                                          @G24LB26*/ 07177000
*/* INPUT - INDEX INTO BEST FIT TABLE OF VOLUME WHOSE        @G24LB26*/ 07178000
*/*         EXPIRATION DATE IS BEING UPDATED BY THE SELECTOR @G24LB26*/ 07179000
*/*         MODULE.                                          @G24LB26*/ 07180000
*/*                                                          @G24LB26*/ 07181000
*/* OUTPUT - RETURN WITH ZERO REASON AND RETURN CODES        @G24LB26*/ 07182000
*/*          IN THE RPLV. JOURNAL ENTRY WILL BE MADE FOR     @G24LB26*/ 07183000
*/*          EXPIRATION DATE CHANGE.                         @G24LB26*/ 07184000
*/*                                                          @G24LB26*/ 07185000
*/*********************************************************  @G24LB26*/ 07186000
*                                                                  1452 07187000
*JOURNAL:                                                          1452 07188000
*   PROC OPTIONS(SAVE(REG14));      /*                       @G24LB26*/ 07189000
*                                                                  1452 07190000
JOURNAL  ST    @14,@SA00018                                        1452 07191000
*   /*****************************************************************/ 07192000
*   /*                                                               */ 07193000
*   /* CLEAR THE RPLVJ AND SET UP TOTAL LENGTH OF REQUEST    @G24LB26*/ 07194000
*   /* BLOCK.                                                @G24LB26*/ 07195000
*   /*                                                               */ 07196000
*   /*****************************************************************/ 07197000
*                                                                  1453 07198000
*   RPLVJ=RPLVJ&&RPLVJ;             /*                       @G24LB26*/ 07199000
         XC    RPLVJ(220),RPLVJ                                    1453 07200000
*   SAVEPTR=RPLVPTR;                /* SAVE ADDR OF RPLV     @G24LB26*/ 07201000
         LR    SAVEPTR,RPLVPTR                                     1454 07202000
*   RPLVPTR=ADDR(RPLVJ);            /* SET UP ADDRESSING TO  @G24LB26   07203000
*                                      JOURNALED RPLV        @G24LB26*/ 07204000
         LA    RPLVPTR,RPLVJ                                       1455 07205000
*   RPLVTLEN=LENGTH(RPLV)+LENGTH(MVR);/* TOTAL LEN OF RPLV   @G24LB26*/ 07206000
         MVC   RPLVTLEN(2,RPLVPTR),@CH02245                        1456 07207000
*   RPLVVICB=VVIPTR;                /* ADDR OF VVICB         @G24LB26*/ 07208000
*                                                                  1457 07209000
         L     @08,VVIPTR                                          1457 07210000
         ST    @08,RPLVVICB(,RPLVPTR)                              1457 07211000
*   /*****************************************************************/ 07212000
*   /*                                                               */ 07213000
*   /* SET UP ADDRESSABILITY OF COMMAND SECTION OF RPLV      @G24LB26*/ 07214000
*   /*                                                               */ 07215000
*   /*****************************************************************/ 07216000
*                                                                  1458 07217000
*   MVRPTR=ADDR(RPLVUTIL);          /*                       @G24LB26*/ 07218000
*                                                                  1458 07219000
         LA    MVRPTR,RPLVUTIL(,RPLVPTR)                           1458 07220000
*   /*****************************************************************/ 07221000
*   /*                                                               */ 07222000
*   /* INITIALIZE MODIFY VOLUME REQUEST BLOCK TO JOURNAL     @G24LB26*/ 07223000
*   /* AN EXPIRATION CHANGE.                                 @G24LB26*/ 07224000
*   /*                                                               */ 07225000
*   /*****************************************************************/ 07226000
*                                                                  1459 07227000
*   MVRLNGTH=LENGTH(MVR);           /* LENGTH OF UTILITY RPL @G24LB26*/ 07228000
         MVC   MVRLNGTH(4,MVRPTR),@CF02244                         1459 07229000
*   MVROPCD=MVROP;                  /* MODIFY VOL OP CODE    @G24LB26*/ 07230000
         MVI   MVROPCD(MVRPTR),X'85'                               1460 07231000
*   MVRFLBAS=ON;                    /* VOLID SPECIFIED       @G24LB26*/ 07232000
*   MVRFLTO=ON;                     /* EXPIR DATE SPECIFIED  @G24LB26*/ 07233000
         OI    MVRFLBAS(MVRPTR),B'00101000'                        1462 07234000
*   MVRBVOL=BFVOLID(INDXBFTB);      /* VOLID                 @G24LB26*/ 07235000
         L     @08,BFTBLPTR                                        1463 07236000
         LR    @04,INDXBFTB                                        1463 07237000
         MH    @04,@CH02240                                        1463 07238000
         ST    @04,@TF00001                                        1463 07239000
         ALR   @04,@08                                             1463 07240000
         MVC   MVRBVOL(6,MVRPTR),BFVOLID-18(@04)                   1463 07241000
*   MVRTO=BFVOLEXP(INDXBFTB);       /* EXPIRATION DATE       @G24LB26*/ 07242000
*                                                                  1464 07243000
         AL    @08,@TF00001                                        1464 07244000
         MVC   MVRTO(4,MVRPTR),BFVOLEXP-18(@08)                    1464 07245000
*   /*****************************************************************/ 07246000
*   /*                                                               */ 07247000
*   /* RESERVE JOURNAL DATA SET                              @G24LB26*/ 07248000
*   /*                                                               */ 07249000
*   /*****************************************************************/ 07250000
*                                                                  1465 07251000
*   RESPECIFY                                                      1465 07252000
*    (REG0,                                                        1465 07253000
*     REG1) RSTD;                   /*                       @G24LB26*/ 07254000
*   REG0=RESEXVJL;                  /* RESERVE JOURNAL       @G24LB26   07255000
*                                      EXCLUSIVE             @G24LB26*/ 07256000
         LA    REG0,17                                             1466 07257000
*   REG1=SAVEPTR;                   /* ADDR OF RPLV          @G24LB26*/ 07258000
         LR    REG1,SAVEPTR                                        1467 07259000
*   CALL ICBVRR00;                  /* RESERVE JOURNAL       @G24LB26*/ 07260000
         L     @15,@CV01909                                        1468 07261000
         BALR  @14,@15                                             1468 07262000
*   REG1=RPLVPTR;                   /* RESET TO RPLVJ        @G24LB26*/ 07263000
         LR    REG1,RPLVPTR                                        1469 07264000
*   CALL ICBVJL00;                  /*                       @G24LB26*/ 07265000
         L     @15,@CV01911                                        1470 07266000
         BALR  @14,@15                                             1470 07267000
*   REG1=SAVEPTR;                   /* RESET ADDR OF RPLV    @G24LB26   07268000
*                                      AGAIN                 @G24LB26*/ 07269000
         LR    REG1,SAVEPTR                                        1471 07270000
*   REG0=DEQJRNL;                   /* INDICATE FREE JOURNAL @G24LB26*/ 07271000
         LA    REG0,16                                             1472 07272000
*   CALL ICBVRR00;                  /* FREE JOURNAL          @G24LB26*/ 07273000
         L     @15,@CV01909                                        1473 07274000
         BALR  @14,@15                                             1473 07275000
*   RESPECIFY                                                      1474 07276000
*    (REG0,                                                        1474 07277000
*     REG1) UNRSTD;                 /*                       @G24LB26*/ 07278000
*   RPLVPTR=SAVEPTR;                /* RESTORE ADDRESSING    @G24LB26   07279000
*                                      TO ORIGINAL RPLV      @G24LB26*/ 07280000
*                                                                  1475 07281000
         LR    RPLVPTR,SAVEPTR                                     1475 07282000
*   /*****************************************************************/ 07283000
*   /*                                                               */ 07284000
*   /* SET ZERO REASON AND RETURN CODES IN THE RPLV.         @G24LB26*/ 07285000
*   /*                                                               */ 07286000
*   /*****************************************************************/ 07287000
*                                                                  1476 07288000
*   RPLVRETC=RCZERO;                /*                       @G24LB26*/ 07289000
         MVC   RPLVRETC(2,RPLVPTR),@CB02111                        1476 07290000
*   RPLRCODE=RCZERO;                /*                       @G24LB26*/ 07291000
         MVC   RPLRCODE(2,RPLVPTR),@CB02111                        1477 07292000
*   RETURN;                         /*                       @G24LB26*/ 07293000
@EL00018 DS    0H                                                  1478 07294000
@EF00018 DS    0H                                                  1478 07295000
@ER00018 L     @14,@SA00018                                        1478 07296000
         BR    @14                                                 1478 07297000
*   END JOURNAL;                    /*                       @G24LB26*/ 07298000
*   END ICBVSL00                    /*                       @G24LB26*/ 07299000
*                                                                  1480 07300000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 07301000
*/*%INCLUDE SYSLIB  (IEZRPLV )                                       */ 07302000
*/*%INCLUDE SYSLIB  (IEZVVICB)                                       */ 07303000
*/*%INCLUDE SYSLIB  (IEZMVR  )                                       */ 07304000
*/*%INCLUDE SYSLIB  (IEZBASEV)                                       */ 07305000
*/*%INCLUDE SYSLIB  (IEZGROUP)                                       */ 07306000
*/*%INCLUDE SYSLIB  (IEZGVSNE)                                       */ 07307000
*/*%INCLUDE SYSLIB  (IEZUNITP)                                       */ 07308000
*/*%INCLUDE SYSLIB  (IEZTABP )                                       */ 07309000
*/*%INCLUDE SYSLIB  (IEZSTPTB)                                       */ 07310000
*/*%INCLUDE SYSLIB  (IEZGRPPR)                                       */ 07311000
*/*%INCLUDE SYSLIB  (IEZVOLRT)                                       */ 07312000
*/*%INCLUDE SYSLIB  (IEZBFTBL)                                       */ 07313000
*/*%INCLUDE SYSLIB  (IEFUCBOB)                                       */ 07314000
*/*%INCLUDE SYSLIB  (IEFJFCBN)                                       */ 07315000
*/*%INCLUDE SYSLIB  (CVT     )                                       */ 07316000
*/*%INCLUDE SYSLIB  (IEZMSGRQ)                                       */ 07317000
*/*%INCLUDE SYSLIB  (IEFJSSOB)                                       */ 07318000
*/*%INCLUDE SYSLIB  (IEFJESCT)                                       */ 07319000
*                                                                  1480 07320000
*       ;                                                          1480 07321000
@DATA    DS    0H                                                       07322000
@CH00087 DC    H'5'                                                     07323000
@CH00215 DC    H'6'                                                     07324000
@CH02240 DC    H'18'                                                    07325000
@CH02245 DC    H'220'                                                   07326000
@CH02238 DC    H'885'                                                   07327000
@CH02014 DC    H'1000'                                                  07328000
@SC02281 CLC   SRTELEM(0,@01),SRTELEM(@14)                              07329000
         DS    0F                                                       07330000
@SA00001 DS    18F                                                      07331000
@SA00004 DS    1F                                                       07332000
@SA00003 DS    1F                                                       07333000
@SA00005 DS    1F                                                       07334000
@SA00013 DS    1F                                                       07335000
@SA00017 DS    1F                                                       07336000
@SA00006 DS    1F                                                       07337000
@SA00015 DS    1F                                                       07338000
@SA00016 DS    18F                                                      07339000
@SA00018 DS    0F                                                       07340000
@SA00010 DS    0F                                                       07341000
@SA00009 DS    0F                                                       07342000
@SA00011 DS    0F                                                       07343000
         DS    1F                                                       07344000
@AL00001 DS    2A                                                       07345000
@TF00001 DS    F                                                        07346000
@TF00002 DS    F                                                        07347000
         DS    0F                                                       07348000
@CF00084 DC    F'0'                                                     07349000
@CF00043 DC    F'1'                                                     07350000
@CF00064 DC    F'4'                                                     07351000
@CF00040 DC    F'8'                                                     07352000
@CF00032 DC    F'12'                                                    07353000
@CF00112 DC    F'16'                                                    07354000
@CF02038 DC    F'19'                                                    07355000
@CF01851 DC    F'20'                                                    07356000
@CH01851 EQU   @CF01851+2                                               07357000
@CF00346 DC    F'48'                                                    07358000
@CF02244 DC    F'88'                                                    07359000
@CF02023 DC    F'100'                                                   07360000
@CF02237 DC    F'164'                                                   07361000
@CF02241 DC    F'224'                                                   07362000
@CF02057 DC    F'401'                                                   07363000
@CF02059 DC    F'402'                                                   07364000
@CF02021 DC    F'404'                                                   07365000
@CF02061 DC    F'407'                                                   07366000
@CF02063 DC    F'409'                                                   07367000
@CF02065 DC    F'415'                                                   07368000
@CF02067 DC    F'441'                                                   07369000
@CF02069 DC    F'445'                                                   07370000
@CF02071 DC    F'479'                                                   07371000
@CF02073 DC    F'481'                                                   07372000
@CF02075 DC    F'483'                                                   07373000
@CF02239 DC    F'988'                                                   07374000
@CF02040 DC    F'13030'                                                 07375000
@CF02042 DC    F'13165'                                                 07376000
@CF02280 DC    F'-19'                                                   07377000
@CF02283 DC    F'-18'                                                   07378000
@CV01909 DC    V(ICBVRR00)                                              07379000
@CV01910 DC    V(ICBVIO00)                                              07380000
@CV01911 DC    V(ICBVJL00)                                              07381000
@CV01912 DC    V(ICBVOP00)                                              07382000
@CV01913 DC    V(ICBVUP00)                                              07383000
@CV01914 DC    V(ICBVTP00)                                              07384000
         DS    0D                                                       07385000
VVIPTR   DS    A                                                        07386000
BASEVPTR DS    A                                                        07387000
GROUPPTR DS    A                                                        07388000
GVSNEPTR DS    A                                                        07389000
UCBPTR   DS    A                                                        07390000
BFTBLPTR DS    A                                                        07391000
DSPDDADR DS    A                                                        07392000
SLGRPSPA DS    F                                                        07393000
MVRLEN   DC    AL2(88)                                                  07394000
TPVOLSPA DS    H                                                        07395000
RESERSPA DS    H                                                        07396000
TOTSPA   DS    H                                                        07397000
BFSLOTLN DC    AL1(18)                                                  07398000
BFHEADLN DC    AL1(21)                                                  07399000
         DS    0D                                                       07400000
@TS00001 DS    CL8                                                      07401000
@CB02077 DC    X'0213'                                                  07402000
@CB02079 DC    X'022A'                                                  07403000
@CB02085 DC    X'022C'                                                  07404000
@CB02087 DC    X'022F'                                                  07405000
@CB02089 DC    X'0231'                                                  07406000
@CB02091 DC    X'0232'                                                  07407000
@CB02093 DC    X'0262'                                                  07408000
@CB02095 DC    X'0263'                                                  07409000
@CB02097 DC    X'0264'                                                  07410000
@CB02099 DC    X'0265'                                                  07411000
@CB02111 DC    X'0000'                                                  07412000
@CB02113 DC    X'0004'                                                  07413000
@CB02115 DC    X'0008'                                                  07414000
         DS    CL2                                                      07415000
MSGRQ    DS    CL32                                                     07416000
         ORG   MSGRQ                                                    07417000
MSGID    DS    FL4                                                      07418000
MSGRPLV  DS    AL4                                                      07419000
MSGRLEN  DS    BL1                                                      07420000
MSGREPLY DS    AL3                                                      07421000
MSGLEN1  DS    BL1                                                      07422000
MSGTEXT1 DS    AL3                                                      07423000
MSGLEN2  DS    BL1                                                      07424000
MSGTEXT2 DS    AL3                                                      07425000
MSGLEN3  DS    BL1                                                      07426000
MSGTEXT3 DS    AL3                                                      07427000
MSGLEN4  DS    BL1                                                      07428000
MSGTEXT4 DS    AL3                                                      07429000
MSGLEN5  DS    BL1                                                      07430000
MSGTEXT5 DS    AL3                                                      07431000
         ORG   MSGRQ+32                                                 07432000
STRUNITP DS    CL17                                                     07433000
STRTABP  DS    CL12                                                     07434000
STRBFTBL DS    CL885                                                    07435000
STORBASE DS    CL224                                                    07436000
STORGRP  DS    CL164                                                    07437000
STORGPEX DS    CL988                                                    07438000
DUMMYBUF DS    CL988                                                    07439000
         DS    CL2                                                      07440000
SRTAGL   DS    CL12                                                     07441000
         ORG   SRTAGL                                                   07442000
SRTADDR  DS    AL4                                                      07443000
SRTNUM   DS    FL2                                                      07444000
SRTLEN   DS    FL2                                                      07445000
SRTBEG   DS    FL2                                                      07446000
SRTFLDLN DS    FL2                                                      07447000
         ORG   SRTAGL+12                                                07448000
SORTWORK DS    CL18                                                     07449000
SRTFLGS  DS    BL1                                                      07450000
         ORG   SRTFLGS                                                  07451000
SRTSTOP  DS    BL1                                                      07452000
SRTMOVE  EQU   SRTFLGS+0                                                07453000
         ORG   SRTFLGS+1                                                07454000
RPLVJ    DS    CL220                                                    07455000
EXPCVT   DS    CL4                                                      07456000
TESTMASK DS    BL2                                                      07457000
         DS    CL3                                                      07458000
EXPJFCB  DS    CL4                                                      07459000
         ORG   EXPJFCB                                                  07460000
EXPYR    DS    CL2                                                      07461000
EXPDAY   DS    CL2                                                      07462000
         ORG   EXPJFCB+4                                                07463000
GKEY     DS    CL13                                                     07464000
         ORG   GKEY                                                     07465000
GKY      DC    CL3'G  '                                                 07466000
GROUPKY  DS    CL8                                                      07467000
GBLKKY   DS    CL1                                                      07468000
GIDKY    DS    FL1                                                      07469000
         ORG   GKEY+13                                                  07470000
VKEY     DS    CL13                                                     07471000
         ORG   VKEY                                                     07472000
VKY      DC    CL5'V    '                                               07473000
VOLKY    DS    CL6                                                      07474000
VBLKKY   DC    CL1' '                                                   07475000
VIDKY    DC    XL1'00'                                                  07476000
         ORG   VKEY+13                                                  07477000
         DS    CL2                                                      07478000
INTWORK  DS    CL22                                                     07479000
         ORG   INTWORK                                                  07480000
GETMNLEN DS    FL2                                                      07481000
NUMBVOL  DS    FL1                                                      07482000
NUMCHOS  DS    FL1                                                      07483000
PRICYL   DS    FL2                                                      07484000
SECCYL   DS    FL2                                                      07485000
PRIBFIDX DS    FL1                                                      07486000
EXPIRDT  DS    CL4                                                      07487000
STATFLGS DS    BL1                                                      07488000
         ORG   STATFLGS                                                 07489000
NSHRREQF DS    BL1                                                      07490000
         ORG   INTWORK+14                                               07491000
@NM00045 DS    CL2                                                      07492000
DYNMAREA DS    CL6                                                      07493000
         ORG   DYNMAREA                                                 07494000
UCBADDR  DS    AL4                                                      07495000
INTERCC  DS    BL2                                                      07496000
         ORG   INTWORK+22                                               07497000
DYNMFLGS DS    BL2                                                      07498000
         ORG   DYNMFLGS                                                 07499000
UPDTGVSN DS    BL1                                                      07500000
BASEREAD EQU   DYNMFLGS+0                                               07501000
EXITVSL  EQU   DYNMFLGS+0                                               07502000
EXITSW   EQU   DYNMFLGS+0                                               07503000
ERRORSW  EQU   DYNMFLGS+0                                               07504000
DATEEXIT EQU   DYNMFLGS+0                                               07505000
WAITEXIT EQU   DYNMFLGS+0                                               07506000
SEPEXIT  EQU   DYNMFLGS+0                                               07507000
FINEXIT  DS    BL1                                                      07508000
SPAEXIT  EQU   DYNMFLGS+1                                               07509000
LSPASW   EQU   DYNMFLGS+1                                               07510000
RESORTSW EQU   DYNMFLGS+1                                               07511000
         ORG   DYNMFLGS+2                                               07512000
LSPAREA  DS    CL30                                                     07513000
         ORG   LSPAREA                                                  07514000
@NM00046 DS    CL6                                                      07515000
LSPFRESP DS    CL4                                                      07516000
@NM00047 DS    CL1                                                      07517000
LSPFRETR DS    CL4                                                      07518000
@NM00048 DS    CL1                                                      07519000
LSPFREXT DS    CL4                                                      07520000
@NM00049 DS    CL1                                                      07521000
LSPLEXT  DS    CL4                                                      07522000
@NM00050 DS    CL1                                                      07523000
LSPLGTRK DS    CL4                                                      07524000
         ORG   LSPAREA+30                                               07525000
TEMPPACK DS    CL4                                                      07526000
TEMPCHAR DS    CL2                                                      07527000
MAJRNAM  DC    CL8'SYSZVOLS'                                            07528000
TENQVOL  DS    CL6                                                      07529000
MAXDATE  DC    X'0099365C'                                              07530000
         DS    CL2                                                      07531000
DBLWORD  DS    CL8                                                      07532000
DEV3330V DC    X'30582009'                                              07533000
NULEXPDT DC    X'FFFFFFFF'                                              07534000
ZEROEXP  DC    X'00000000'                                              07535000
ANCVTEXP DC    X'FFFFFFFC'                                              07536000
ORSIGN   DC    X'F0'                                                    07537000
SYSGROUP DC    CL8'SYSGROUP'                                            07538000
SL1PATCH DS    CL400                                                    07539000
         ORG   SL1PATCH                                                 07540000
@NM00052 DC    400X'00'                                                 07541000
         ORG   SL1PATCH+400                                             07542000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       07543000
@01      EQU   01                                                       07544000
@02      EQU   02                                                       07545000
@03      EQU   03                                                       07546000
@04      EQU   04                                                       07547000
@05      EQU   05                                                       07548000
@06      EQU   06                                                       07549000
@07      EQU   07                                                       07550000
@08      EQU   08                                                       07551000
@09      EQU   09                                                       07552000
@10      EQU   10                                                       07553000
@11      EQU   11                                                       07554000
@12      EQU   12                                                       07555000
@13      EQU   13                                                       07556000
@14      EQU   14                                                       07557000
@15      EQU   15                                                       07558000
INDXDDVL EQU   @02                                                      07559000
INDXEXTS EQU   @08                                                      07560000
INDXBFTB EQU   @06                                                      07561000
SECBYTES EQU   @03                                                      07562000
PRIBYTES EQU   @03                                                      07563000
ROUND    EQU   @02                                                      07564000
RECORDS  EQU   @03                                                      07565000
RECLEN   EQU   @04                                                      07566000
YEAR     EQU   @03                                                      07567000
DAY      EQU   @02                                                      07568000
TEMPBIN  EQU   @02                                                      07569000
SRTJ     EQU   @02                                                      07570000
SRTI     EQU   @03                                                      07571000
SRTEND   EQU   @04                                                      07572000
SAVEPTR  EQU   @03                                                      07573000
SELTMPTR EQU   @07                                                      07574000
MVRPTR   EQU   @02                                                      07575000
RPLVPTR  EQU   @05                                                      07576000
REG0     EQU   @00                                                      07577000
REG1     EQU   @01                                                      07578000
REG2     EQU   @02                                                      07579000
REG14    EQU   @14                                                      07580000
REG15    EQU   @15                                                      07581000
REG10    EQU   @10                                                      07582000
REG11    EQU   @11                                                      07583000
REG3     EQU   @03                                                      07584000
REG4     EQU   @04                                                      07585000
REG5     EQU   @05                                                      07586000
REG6     EQU   @06                                                      07587000
REG7     EQU   @07                                                      07588000
REG8     EQU   @08                                                      07589000
REG9     EQU   @09                                                      07590000
CVTPTR   EQU   16                                                       07591000
SELRB    EQU   0                                                        07592000
SELFLGS1 EQU   SELRB+5                                                  07593000
SELPARMT EQU   SELFLGS1                                                 07594000
SELSEPVL EQU   SELFLGS1                                                 07595000
SELVOLRF EQU   SELFLGS1                                                 07596000
SELFLGS2 EQU   SELRB+6                                                  07597000
SELCNTWT EQU   SELFLGS2                                                 07598000
SELUNCNT EQU   SELRB+7                                                  07599000
SELJOBID EQU   SELRB+8                                                  07600000
SELJFCBA EQU   SELRB+12                                                 07601000
SELDEVTP EQU   SELRB+16                                                 07602000
SELUCBAD EQU   SELRB+20                                                 07603000
SELJOBNM EQU   SELRB+24                                                 07604000
SELDDNAM EQU   SELRB+32                                                 07605000
SELSTNUM EQU   SELRB+40                                                 07606000
SELDDCAT EQU   SELRB+42                                                 07607000
SELRFDDN EQU   SELRB+46                                                 07608000
SELVLRET EQU   SELRB+56                                                 07609000
SELGRPPR EQU   SELRB+60                                                 07610000
RPLV     EQU   0                                                        07611000
RPLTCBPR EQU   RPLV+8                                                   07612000
RPLVVICB EQU   RPLV+12                                                  07613000
RPLFLAGA EQU   RPLV+28                                                  07614000
RPLVTLEN EQU   RPLV+30                                                  07615000
RPLRCODE EQU   RPLV+32                                                  07616000
RPLVRETC EQU   RPLV+34                                                  07617000
RPLVSAM  EQU   RPLV+56                                                  07618000
RPLVTYP  EQU   RPLVSAM+2                                                07619000
RPLVBUF  EQU   RPLVSAM+32                                               07620000
RPLVKEY  EQU   RPLVSAM+36                                               07621000
RPLVOPT  EQU   RPLVSAM+40                                               07622000
RPLVDIR  EQU   RPLVOPT                                                  07623000
RPLVKGE  EQU   RPLVOPT                                                  07624000
RPLVUPD  EQU   RPLVOPT+1                                                07625000
RPLVBLN  EQU   RPLVSAM+52                                               07626000
RPLVUTIL EQU   RPLV+132                                                 07627000
VVICB    EQU   0                                                        07628000
VVICPUID EQU   VVICB+12                                                 07629000
VVIFLGA  EQU   VVICB+15                                                 07630000
VVIFLG0  EQU   VVIFLGA                                                  07631000
VVISSOBA EQU   VVICB+96                                                 07632000
VVIVBSTF EQU   VVICB+100                                                07633000
MVR      EQU   0                                                        07634000
MVRLNGTH EQU   MVR                                                      07635000
MVRCODE  EQU   MVR+4                                                    07636000
MVROPCD  EQU   MVRCODE                                                  07637000
MVRFLAGA EQU   MVR+8                                                    07638000
MVRFLBAS EQU   MVRFLAGA                                                 07639000
MVRFLTO  EQU   MVRFLAGA                                                 07640000
MVRBVOL  EQU   MVR+12                                                   07641000
MVRTO    EQU   MVR+58                                                   07642000
BASEV    EQU   0                                                        07643000
BASNAME  EQU   BASEV                                                    07644000
BASSERNO EQU   BASNAME+5                                                07645000
BASID    EQU   BASNAME+11                                               07646000
BASFLAGA EQU   BASEV+14                                                 07647000
BASTYPE  EQU   BASFLAGA                                                 07648000
BASGRPV  EQU   BASFLAGA+2                                               07649000
BASGENUS EQU   BASFLAGA+2                                               07650000
BASRCVYF EQU   BASEV+20                                                 07651000
BASSATIA EQU   BASRCVYF                                                 07652000
BASMISCF EQU   BASRCVYF+2                                               07653000
BASLIB1  EQU   BASEV+36                                                 07654000
BASLID1  EQU   BASLIB1                                                  07655000
BASLIB2  EQU   BASEV+49                                                 07656000
BASLID2  EQU   BASLIB2                                                  07657000
BASKLCPY EQU   BASEV+76                                                 07658000
BASCOPID EQU   BASKLCPY+11                                              07659000
BASEXPDT EQU   BASEV+96                                                 07660000
BASGROUP EQU   BASEV+180                                                07661000
GROUP    EQU   0                                                        07662000
GRONAME  EQU   GROUP                                                    07663000
GROVVGRP EQU   GRONAME+3                                                07664000
GROID    EQU   GRONAME+11                                               07665000
GROFLAGA EQU   GROUP+13                                                 07666000
GROTYPE  EQU   GROFLAGA                                                 07667000
GROEXCL  EQU   GROFLAGA+2                                               07668000
GRORLSE  EQU   GROFLAGA+2                                               07669000
GRORETN  EQU   GROFLAGA+2                                               07670000
GROMSG1  EQU   GROFLAGA+2                                               07671000
GROPCENT EQU   GROUP+29                                                 07672000
GRONGEN  EQU   GROUP+30                                                 07673000
GROPSPD  EQU   GROUP+36                                                 07674000
GROSSPD  EQU   GROUP+38                                                 07675000
GROSTRSH EQU   GROUP+40                                                 07676000
GRORETPD EQU   GROUP+52                                                 07677000
GROERRTS EQU   GROUP+56                                                 07678000
GROERRDT EQU   GROERRTS                                                 07679000
GROCONUS EQU   GROUP+94                                                 07680000
GRORESSP EQU   GROUP+95                                                 07681000
GVSNE    EQU   0                                                        07682000
GVSHDR   EQU   GVSNE                                                    07683000
GVSNAME  EQU   GVSHDR                                                   07684000
GVSVVGRP EQU   GVSNAME+3                                                07685000
GVSID    EQU   GVSNAME+11                                               07686000
GVSNO    EQU   GVSID+1                                                  07687000
GVSFLAGA EQU   GVSHDR+13                                                07688000
GVSTYPE  EQU   GVSFLAGA                                                 07689000
GVSEX    EQU   GVSFLAGA+2                                               07690000
GVSESIND EQU   GVSHDR+18                                                07691000
GVSSLOTS EQU   GVSNE+28                                                 07692000
GVSVOLID EQU   GVSSLOTS                                                 07693000
GVSVOLFL EQU   GVSSLOTS+6                                               07694000
GVSCPUBM EQU   GVSVOLFL                                                 07695000
GVSRCFSI EQU   GVSVOLFL+2                                               07696000
GVSMTNSH EQU   GVSVOLFL+2                                               07697000
GVSFRESP EQU   GVSSLOTS+10                                              07698000
GVSLEXT  EQU   GVSSLOTS+12                                              07699000
GVSEXPDT EQU   GVSSLOTS+14                                              07700000
GVSMTDSP EQU   GVSSLOTS+18                                              07701000
UNITP    EQU   0                                                        07702000
UNIDEVTP EQU   UNITP                                                    07703000
UNIVOL   EQU   UNITP+4                                                  07704000
UNIUCBP  EQU   UNITP+12                                                 07705000
UNIFLAGS EQU   UNITP+16                                                 07706000
UNIFMTD  EQU   UNIFLAGS                                                 07707000
UNIFINCL EQU   UNIFLAGS                                                 07708000
TABP     EQU   0                                                        07709000
TABFLAGS EQU   TABP                                                     07710000
TABFBLDE EQU   TABFLAGS                                                 07711000
TABFSRCD EQU   TABFLAGS                                                 07712000
TABFBFIT EQU   TABFLAGS                                                 07713000
TABFTSPC EQU   TABFLAGS                                                 07714000
TABVOLID EQU   TABP+2                                                   07715000
TABDDNUM EQU   TABVOLID                                                 07716000
TABSELRB EQU   TABVOLID+2                                               07717000
TABJOBID EQU   TABSELRB                                                 07718000
TABBFTBL EQU   TABJOBID                                                 07719000
TABDDRET EQU   TABP+8                                                   07720000
TABHDRET EQU   TABDDRET                                                 07721000
TABSPRET EQU   TABHDRET                                                 07722000
STPTB    EQU   0                                                        07723000
STPFLAGS EQU   STPTB+14                                                 07724000
STPDDENT EQU   0                                                        07725000
STPDDFLG EQU   STPDDENT+24                                              07726000
STPDDNVL EQU   STPDDENT+25                                              07727000
STPDDVOL EQU   STPDDENT+26                                              07728000
GRPPR    EQU   0                                                        07729000
GRPNAME  EQU   GRPPR                                                    07730000
GRPEXTIN EQU   GRPPR+8                                                  07731000
GRPSLOTN EQU   GRPPR+9                                                  07732000
GRPPRMSP EQU   GRPPR+10                                                 07733000
VOLRT    EQU   0                                                        07734000
VOLNUM   EQU   VOLRT+2                                                  07735000
VOLSER   EQU   VOLRT+4                                                  07736000
BFTBL    EQU   0                                                        07737000
BFHEADER EQU   BFTBL                                                    07738000
BFLEN    EQU   BFHEADER                                                 07739000
BFGROUP  EQU   BFHEADER+2                                               07740000
BFTOTIDX EQU   BFHEADER+10                                              07741000
BFDEVTP  EQU   BFHEADER+12                                              07742000
BFJOBID  EQU   BFHEADER+16                                              07743000
BFREQFLS EQU   BFHEADER+20                                              07744000
BFNSHRFL EQU   BFREQFLS                                                 07745000
BFENTRY  EQU   BFTBL+21                                                 07746000
BFSLOT   EQU   BFENTRY                                                  07747000
BFVOLID  EQU   BFSLOT                                                   07748000
BFGRPIDX EQU   BFSLOT+6                                                 07749000
BFGRPSLT EQU   BFSLOT+7                                                 07750000
BFHPFLGS EQU   BFSLOT+8                                                 07751000
BFHRSKFL EQU   BFHPFLGS                                                 07752000
BFWAITFL EQU   BFHPFLGS                                                 07753000
BFOVERUS EQU   BFSLOT+9                                                 07754000
BFVOLEXP EQU   BFSLOT+10                                                07755000
BFLPFLGS EQU   BFSLOT+14                                                07756000
BFNMTDFL EQU   BFLPFLGS                                                 07757000
BFMTDOHF EQU   BFLPFLGS                                                 07758000
BFCONUSE EQU   BFSLOT+15                                                07759000
BFMISCFL EQU   BFSLOT+16                                                07760000
BFBADPRI EQU   BFMISCFL                                                 07761000
BFBADSEC EQU   BFMISCFL                                                 07762000
BFSELPRI EQU   BFMISCFL                                                 07763000
BFSELSEC EQU   BFMISCFL                                                 07764000
BFVOLREJ EQU   BFMISCFL                                                 07765000
BFNOENQ  EQU   BFMISCFL                                                 07766000
BFENQUED EQU   BFMISCFL                                                 07767000
BFNOTMTD EQU   BFMISCFL+1                                               07768000
BFMTDOTH EQU   BFMISCFL+1                                               07769000
BFMTDOHT EQU   BFMISCFL+1                                               07770000
UCB      EQU   0                                                        07771000
UCBOB    EQU   0                                                        07772000
UCBJBNR  EQU   UCBOB                                                    07773000
UCBFL5   EQU   UCBOB+1                                                  07774000
UCBAF    EQU   UCBFL5                                                   07775000
UCBSTAT  EQU   UCBOB+3                                                  07776000
UCBONLI  EQU   UCBSTAT                                                  07777000
UCBRESV  EQU   UCBSTAT                                                  07778000
UCBPRES  EQU   UCBSTAT                                                  07779000
UCBCHAN  EQU   UCBOB+4                                                  07780000
UCBSFLS  EQU   UCBOB+6                                                  07781000
UCBFLA   EQU   UCBSFLS                                                  07782000
UCBFL1   EQU   UCBFLA                                                   07783000
UCBBSY   EQU   UCBFL1                                                   07784000
UCBNRY   EQU   UCBFL1                                                   07785000
UCBPST   EQU   UCBFL1                                                   07786000
UCBCUB   EQU   UCBFL1                                                   07787000
UCBFLB   EQU   UCBSFLS+1                                                07788000
UCBCHM   EQU   UCBOB+8                                                  07789000
UCBCHM1  EQU   UCBCHM                                                   07790000
UCBPTH0  EQU   UCBCHM1                                                  07791000
UCBPTH1  EQU   UCBCHM1                                                  07792000
UCBWGT   EQU   UCBOB+12                                                 07793000
UCBTYP   EQU   UCBOB+16                                                 07794000
UCBTBYT1 EQU   UCBTYP                                                   07795000
UCB1FEA5 EQU   UCBTBYT1                                                 07796000
UCB1FEA6 EQU   UCBTBYT1                                                 07797000
UCBTBYT2 EQU   UCBTYP+1                                                 07798000
UCB2OPT2 EQU   UCBTBYT2                                                 07799000
UCBDUDN1 EQU   UCB2OPT2                                                 07800000
UCB2OPT3 EQU   UCBTBYT2                                                 07801000
UCBDUDN2 EQU   UCB2OPT3                                                 07802000
UCB2OPT4 EQU   UCBTBYT2                                                 07803000
UCBRWTAU EQU   UCB2OPT4                                                 07804000
UCB2OPT6 EQU   UCBTBYT2                                                 07805000
UCB2OPT7 EQU   UCBTBYT2                                                 07806000
UCBTBYT3 EQU   UCBTYP+2                                                 07807000
UCBDVCLS EQU   UCBTBYT3                                                 07808000
UCBTBYT4 EQU   UCBTYP+3                                                 07809000
UCBEXTPT EQU   UCBOB+20                                                 07810000
UCBFLC   EQU   UCBEXTPT                                                 07811000
UCBDEV   EQU   UCBOB+24                                                 07812000
UCBCMEXT EQU   0                                                        07813000
UCBATI   EQU   UCBCMEXT+3                                               07814000
@NM00036 EQU   UCBATI                                                   07815000
UCBFLP1  EQU   UCBCMEXT+5                                               07816000
UCBMT    EQU   0                                                        07817000
UCBOCR   EQU   0                                                        07818000
UCB3540X EQU   0                                                        07819000
UCBDKBYT EQU   UCB3540X+6                                               07820000
UCB3800X EQU   0                                                        07821000
UCBOPTNS EQU   UCB3800X                                                 07822000
UCBACTIV EQU   UCB3800X+3                                               07823000
UCBMDRBF EQU   UCB3800X+36                                              07824000
UCBUCS   EQU   0                                                        07825000
UCBUCSOP EQU   UCBUCS+4                                                 07826000
UCBFCBOP EQU   UCBUCS+5                                                 07827000
INFMJFCB EQU   0                                                        07828000
JFCBDSNM EQU   INFMJFCB                                                 07829000
JFCBELNM EQU   INFMJFCB+44                                              07830000
JFCBTSDM EQU   INFMJFCB+52                                              07831000
JFCFCBID EQU   INFMJFCB+56                                              07832000
JFCBFRID EQU   JFCFCBID                                                 07833000
JFCBLTYP EQU   INFMJFCB+66                                              07834000
JFCBOTTR EQU   INFMJFCB+67                                              07835000
JFCBUFOF EQU   JFCBOTTR                                                 07836000
JFCBFLSQ EQU   JFCBOTTR+1                                               07837000
JFCFUNC  EQU   JFCBFLSQ                                                 07838000
JFCBMASK EQU   INFMJFCB+72                                              07839000
JFCBFLG1 EQU   JFCBMASK+5                                               07840000
JFCOPEN  EQU   JFCBFLG1                                                 07841000
JFCBFLG2 EQU   JFCBMASK+6                                               07842000
JFCDEFER EQU   JFCBFLG2                                                 07843000
JFCBXPDT EQU   INFMJFCB+83                                              07844000
JFCBIND1 EQU   INFMJFCB+86                                              07845000
JFCRLSE  EQU   JFCBIND1                                                 07846000
JFCBIND2 EQU   INFMJFCB+87                                              07847000
JFCAMPTR EQU   INFMJFCB+88                                              07848000
JFCBUFRQ EQU   JFCAMPTR                                                 07849000
JFCBUFNO EQU   JFCBUFRQ                                                 07850000
JFCBGNCP EQU   JFCAMPTR+1                                               07851000
JFCBHIAR EQU   JFCBGNCP                                                 07852000
JFCBFALN EQU   JFCBHIAR                                                 07853000
JFCBFTEK EQU   JFCBFALN                                                 07854000
JFCBBFTA EQU   JFCBFTEK                                                 07855000
JFCEROPT EQU   INFMJFCB+92                                              07856000
JFCTRTCH EQU   INFMJFCB+93                                              07857000
CVTMAP   EQU   0                                                        07858000
CVTDATE  EQU   CVTMAP+56                                                07859000
CVTDAR   EQU   CVTMAP+72                                                07860000
CVTFLGS1 EQU   CVTDAR                                                   07861000
CVTDCB   EQU   CVTMAP+116                                               07862000
CVTIOQET EQU   CVTMAP+120                                               07863000
CVTIERLC EQU   CVTMAP+144                                               07864000
CVTHEAD  EQU   CVTMAP+160                                               07865000
CVTSV76C EQU   CVTHEAD                                                  07866000
CVTOPTA  EQU   CVTMAP+182                                               07867000
CVTOPTB  EQU   CVTMAP+183                                               07868000
CVTGTF   EQU   CVTMAP+236                                               07869000
CVTGTFST EQU   CVTGTF                                                   07870000
CVTGTFS  EQU   CVTGTFST                                                 07871000
CVTSTATE EQU   CVTGTFST                                                 07872000
CVTTMODE EQU   CVTGTFST                                                 07873000
CVTFORM  EQU   CVTGTFST                                                 07874000
CVTAQAVT EQU   CVTMAP+240                                               07875000
CVTTCMFG EQU   CVTAQAVT                                                 07876000
CVTVOLM2 EQU   CVTMAP+244                                               07877000
CVTTATA  EQU   CVTVOLM2                                                 07878000
CVTTSKS  EQU   CVTTATA                                                  07879000
CVTVOLF2 EQU   CVTTSKS                                                  07880000
CVTTAT   EQU   CVTTATA+1                                                07881000
CVTATER  EQU   CVTMAP+248                                               07882000
CVTEXT1  EQU   CVTMAP+252                                               07883000
CVTPURG  EQU   CVTMAP+260                                               07884000
CVTQMSG  EQU   CVTMAP+268                                               07885000
CVTDMSR  EQU   CVTMAP+272                                               07886000
CVTRSV37 EQU   CVTDMSR                                                  07887000
CVTDMSRF EQU   CVTRSV37                                                 07888000
CVTJESCT EQU   CVTMAP+296                                               07889000
CVTERPV  EQU   CVTMAP+316                                               07890000
CVTINTLA EQU   CVTMAP+320                                               07891000
CVTAPF   EQU   CVTMAP+324                                               07892000
CVTEXT2  EQU   CVTMAP+328                                               07893000
CVTHJES  EQU   CVTMAP+332                                               07894000
CVTPGSIA EQU   CVTMAP+348                                               07895000
CVTA1F1  EQU   CVTMAP+356                                               07896000
CVTSYSK  EQU   CVTMAP+357                                               07897000
CVTVOLM1 EQU   CVTMAP+380                                               07898000
CVTVOLF1 EQU   CVTVOLM1                                                 07899000
CVTATMCT EQU   CVTMAP+388                                               07900000
CVTXTNT1 EQU   0                                                        07901000
CVTXTNT2 EQU   0                                                        07902000
CVTDSSV  EQU   CVTXTNT2                                                 07903000
CVTFLGBT EQU   CVTXTNT2+5                                               07904000
CVTQID   EQU   CVTXTNT2+24                                              07905000
CVTRV400 EQU   CVTXTNT2+52                                              07906000
CVTRV409 EQU   CVTXTNT2+53                                              07907000
CVTATCVT EQU   CVTXTNT2+64                                              07908000
CVTRV429 EQU   CVTXTNT2+84                                              07909000
CVTRV438 EQU   CVTXTNT2+85                                              07910000
CVTRV457 EQU   CVTXTNT2+112                                             07911000
CVTRV466 EQU   CVTXTNT2+113                                             07912000
CVTFIX   EQU   0                                                        07913000
CVTRELNO EQU   CVTFIX+252                                               07914000
SSOB     EQU   0                                                        07915000
SSOBRETN EQU   SSOB+12                                                  07916000
SSOBINDV EQU   SSOB+16                                                  07917000
SSMO     EQU   0                                                        07918000
SSMOFLG1 EQU   SSMO+2                                                   07919000
SSMOMNTD EQU   SSMOFLG1                                                 07920000
SSMOPNAM EQU   SSMO+4                                                   07921000
SSMOPSTN EQU   SSMO+8                                                   07922000
SSMOPVOL EQU   SSMO+16                                                  07923000
SSMOPDDN EQU   SSMO+20                                                  07924000
SSMOPRPN EQU   SSMO+24                                                  07925000
JESCT    EQU   0                                                        07926000
JESWAA   EQU   JESCT+8                                                  07927000
JESSSREQ EQU   JESCT+20                                                 07928000
JESALLOC EQU   JESCT+32                                                 07929000
JESUNALC EQU   JESCT+36                                                 07930000
JESCATL  EQU   JESCT+40                                                 07931000
SSREQ    EQU   0                                                        07932000
SRTSTOR  EQU   0                                                        07933000
SRTELEM  EQU   SRTSTOR                                                  07934000
ENQRETRN EQU   0                                                        07935000
ENQRETC  EQU   ENQRETRN+3                                               07936000
IEFAB4F5 EQU   0                                                        07937000
IEFBB410 EQU   0                                                        07938000
IEFW21SD EQU   0                                                        07939000
SWAMGR   EQU   0                                                        07940000
UCBBGN   EQU   0                                                        07941000
UCBDCPTR EQU   0                                                        07942000
UCBOBS01 EQU   UCBDEV                                                   07943000
UCBSTAB  EQU   UCBOBS01+10                                              07944000
UCBBSVL  EQU   UCBSTAB                                                  07945000
UCBPRSRS EQU   UCBSTAB                                                  07946000
UCBBPRV  EQU   UCBSTAB                                                  07947000
UCBBPUB  EQU   UCBSTAB                                                  07948000
UCBBSTR  EQU   UCBSTAB                                                  07949000
UCBDMCT  EQU   UCBOBS01+11                                              07950000
UCBFL4   EQU   UCBOBS01+13                                              07951000
UCBUSER  EQU   UCBOBS01+14                                              07952000
UCBOBS02 EQU   UCBDEV                                                   07953000
UCBTFL1  EQU   UCBOBS02+19                                              07954000
UCBXTN   EQU   UCBOBS02+20                                              07955000
UCBVOPT  EQU   UCBXTN                                                   07956000
UCBOBS03 EQU   UCBDEV                                                   07957000
UCBXTADR EQU   UCBOBS03                                                 07958000
UCBOBS04 EQU   UCBDEV                                                   07959000
UCBBTA   EQU   UCBOBS04+12                                              07960000
UCBOBS06 EQU   UCBDEV                                                   07961000
UCBAOF   EQU   UCBOBS06                                                 07962000
UCBAOF1  EQU   UCBAOF                                                   07963000
UCBAOF2  EQU   UCBAOF+1                                                 07964000
@NM00035 EQU   UCBOBS06+3                                               07965000
UCBIRB   EQU   UCBOBS06+4                                               07966000
UCBGRAF  EQU   UCBIRB                                                   07967000
UCBLDNCA EQU   UCBOBS06+8                                               07968000
UCBRDYQ  EQU   UCBLDNCA                                                 07969000
UCBIRLN  EQU   UCBRDYQ                                                  07970000
UCBLDNCB EQU   UCBRDYQ+1                                                07971000
UCBCTLNK EQU   UCBOBS06+12                                              07972000
UCBOBS07 EQU   UCBDEV                                                   07973000
UCBOBS08 EQU   UCBDEV                                                   07974000
UCBCTCAD EQU   UCBOBS08                                                 07975000
UCBCTCF1 EQU   UCBOBS08+4                                               07976000
UCBOBS09 EQU   UCBDEV                                                   07977000
JFCBPTR  EQU   SELJFCBA                                                 07978000
JFCKEYLE EQU   JFCTRTCH                                                 07979000
JFCCODE  EQU   JFCKEYLE                                                 07980000
JFCSTACK EQU   JFCTRTCH                                                 07981000
JFCMODE  EQU   JFCSTACK                                                 07982000
JFCSPPRT EQU   JFCTRTCH                                                 07983000
JFCBABFS EQU   JFCSPPRT+2                                               07984000
JFCLIMCT EQU   JFCBABFS                                                 07985000
JFCDSORG EQU   JFCSPPRT+5                                               07986000
JFCDSRG1 EQU   JFCDSORG                                                 07987000
JFCORGIS EQU   JFCDSRG1                                                 07988000
JFCORGPO EQU   JFCDSRG1                                                 07989000
JFCDSRG2 EQU   JFCDSORG+1                                               07990000
JFCRECFM EQU   JFCSPPRT+7                                               07991000
JFCRCFM  EQU   JFCRECFM                                                 07992000
JFCRFO   EQU   JFCRCFM                                                  07993000
JFCOPTCD EQU   JFCSPPRT+8                                               07994000
JFCWVCSP EQU   JFCOPTCD                                                 07995000
JFCWVCIS EQU   JFCWVCSP                                                 07996000
JFCWVCBD EQU   JFCWVCIS                                                 07997000
JFCALLOW EQU   JFCOPTCD                                                 07998000
JFCRSV17 EQU   JFCALLOW                                                 07999000
JFCOVER  EQU   JFCRSV17                                                 08000000
JFCPCIBT EQU   JFCOPTCD                                                 08001000
JFCMAST  EQU   JFCPCIBT                                                 08002000
JFCEXT   EQU   JFCMAST                                                  08003000
JFCBCKPT EQU   JFCOPTCD                                                 08004000
JFCIND   EQU   JFCBCKPT                                                 08005000
JFCRSV18 EQU   JFCOPTCD                                                 08006000
JFCCYL   EQU   JFCRSV18                                                 08007000
JFCACT   EQU   JFCCYL                                                   08008000
JFCREDUC EQU   JFCOPTCD                                                 08009000
JFCRSV19 EQU   JFCREDUC                                                 08010000
JFCRSV20 EQU   JFCRSV19                                                 08011000
JFCRSV21 EQU   JFCOPTCD                                                 08012000
JFCDEL   EQU   JFCRSV21                                                 08013000
JFCOPTJ  EQU   JFCOPTCD                                                 08014000
JFCREORG EQU   JFCOPTJ                                                  08015000
JFCBLKSI EQU   JFCSPPRT+9                                               08016000
JFCBUFSI EQU   JFCBLKSI                                                 08017000
JFCAMSYN EQU   JFCSPPRT+11                                              08018000
JFCNCP   EQU   JFCAMSYN+2                                               08019000
JFCNTM   EQU   JFCAMSYN+3                                               08020000
JFCBFSEQ EQU   JFCNTM                                                   08021000
JFCPCI   EQU   JFCBFSEQ                                                 08022000
JFCRESRV EQU   JFCAMSYN+4                                               08023000
JFCUCSEG EQU   JFCRESRV                                                 08024000
JFCUCSOP EQU   JFCUCSEG+4                                               08025000
JFCOUTLI EQU   JFCUCSEG+5                                               08026000
JFCTHRSH EQU   JFCOUTLI                                                 08027000
JFCCPRI  EQU   JFCTHRSH                                                 08028000
JFCBVOLS EQU   JFCUCSEG+10                                              08029000
JFCAVOLS EQU   JFCBVOLS                                                 08030000
JFCBS001 EQU   JFCBVOLS                                                 08031000
JFCMSVGP EQU   JFCBS001+22                                              08032000
JFCBPQTY EQU   JFCBS001+34                                              08033000
JFCBCTRI EQU   JFCBS001+37                                              08034000
JFCBSPAC EQU   JFCBCTRI                                                 08035000
JFCONTIG EQU   JFCBCTRI                                                 08036000
JFCMIXG  EQU   JFCBCTRI                                                 08037000
JFCALX   EQU   JFCBCTRI                                                 08038000
JFCBSQTY EQU   JFCBS001+38                                              08039000
JFCFLGS1 EQU   JFCBS001+41                                              08040000
JFCBSPNM EQU   JFCBS001+45                                              08041000
JFCBFLG3 EQU   JFCBSPNM                                                 08042000
JFCBABST EQU   JFCBS001+48                                              08043000
JFCBDRLH EQU   JFCBS001+53                                              08044000
JFCBVLCT EQU   JFCBS001+56                                              08045000
CVTS01   EQU   CVTPGSIA                                                 08046000
CVTLPDIA EQU   CVTS01+12                                                08047000
CVTDIRST EQU   CVTLPDIA                                                 08048000
CVTSLIDA EQU   CVTS01+24                                                08049000
CVTCTLFG EQU   CVTS01+50                                                08050000
CVTRV210 EQU   CVTS01+424                                               08051000
CVTRV219 EQU   CVTS01+425                                               08052000
CVTRV228 EQU   CVTS01+426                                               08053000
CVTRV237 EQU   CVTS01+427                                               08054000
CVTMFRTR EQU   CVTS01+452                                               08055000
CVTRV262 EQU   CVTS01+468                                               08056000
CVTRV271 EQU   CVTS01+469                                               08057000
CVTRV280 EQU   CVTS01+470                                               08058000
CVTRV289 EQU   CVTS01+471                                               08059000
CVTGSDA  EQU   CVTS01+600                                               08060000
JFCBDATE EQU   JFCBXPDT                                                 08061000
JFCBYFX  EQU   JFCBDATE                                                 08062000
JFCBDFX  EQU   JFCBDATE+1                                               08063000
PQTY     EQU   JFCBPQTY                                                 08064000
SQTY     EQU   JFCBSQTY                                                 08065000
DRLH     EQU   JFCBDRLH                                                 08066000
KEYLEN   EQU   JFCKEYLE                                                 08067000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    08068000
CVTRV628 EQU   CVTS01+728                                               08069000
CVTRV627 EQU   CVTS01+724                                               08070000
CVTRV626 EQU   CVTS01+720                                               08071000
CVTRV625 EQU   CVTS01+716                                               08072000
CVTRV624 EQU   CVTS01+712                                               08073000
CVTRV623 EQU   CVTS01+708                                               08074000
CVTRV622 EQU   CVTS01+704                                               08075000
CVTRV621 EQU   CVTS01+700                                               08076000
CVTIHASU EQU   CVTS01+696                                               08077000
CVTRV619 EQU   CVTS01+692                                               08078000
CVTRV618 EQU   CVTS01+688                                               08079000
CVTRV617 EQU   CVTS01+684                                               08080000
CVTRV616 EQU   CVTS01+680                                               08081000
CVTRV615 EQU   CVTS01+676                                               08082000
CVTRV614 EQU   CVTS01+672                                               08083000
CVTRV613 EQU   CVTS01+668                                               08084000
CVTTCASP EQU   CVTS01+664                                               08085000
CVT0PT03 EQU   CVTS01+660                                               08086000
CVT0PT0E EQU   CVTS01+656                                               08087000
CVTRV609 EQU   CVTS01+652                                               08088000
CVTCGK   EQU   CVTS01+648                                               08089000
CVTRAC   EQU   CVTS01+644                                               08090000
CVTRV606 EQU   CVTS01+640                                               08091000
CVTRV605 EQU   CVTS01+636                                               08092000
CVTRV604 EQU   CVTS01+632                                               08093000
CVTEFF02 EQU   CVTS01+628                                               08094000
CVTCBBR  EQU   CVTS01+624                                               08095000
CVTSSCR  EQU   CVTS01+620                                               08096000
CVTEVENT EQU   CVTS01+616                                               08097000
CVTCRCA  EQU   CVTS01+612                                               08098000
CVTTPIO  EQU   CVTS01+608                                               08099000
CVTADV   EQU   CVTS01+604                                               08100000
CVTGSDAB EQU   CVTGSDA                                                  08101000
CVTQV3   EQU   CVTS01+596                                               08102000
CVTQV2   EQU   CVTS01+592                                               08103000
CVTQV1   EQU   CVTS01+588                                               08104000
CVTRPT   EQU   CVTS01+584                                               08105000
CVTSSRB  EQU   CVTS01+580                                               08106000
CVTCSDRL EQU   CVTS01+576                                               08107000
CVTEXP1  EQU   CVTS01+572                                               08108000
CVTRMPMT EQU   CVTS01+568                                               08109000
CVTRMPTT EQU   CVTS01+564                                               08110000
CVTVPSA  EQU   CVTS01+560                                               08111000
CVTVSTOP EQU   CVTS01+556                                               08112000
CVTGTFR8 EQU   CVTS01+552                                               08113000
CVTQUIT  EQU   CVTS01+548                                               08114000
CVTVACR  EQU   CVTS01+544                                               08115000
CVTWTCB  EQU   CVTS01+540                                               08116000
CVTSTPRS EQU   CVTS01+536                                               08117000
CVT0PT02 EQU   CVTS01+532                                               08118000
CVTDARCM EQU   CVTS01+528                                               08119000
CVTIRECM EQU   CVTS01+524                                               08120000
CVTJRECM EQU   CVTS01+520                                               08121000
CVTVEMS0 EQU   CVTS01+516                                               08122000
CVTSPFRR EQU   CVTS01+512                                               08123000
CVTRLSTG EQU   CVTS01+508                                               08124000
CVT0TC0A EQU   CVTS01+504                                               08125000
CVTGMBR  EQU   CVTS01+500                                               08126000
CVTLFRM  EQU   CVTS01+496                                               08127000
CVTRMBR  EQU   CVTS01+492                                               08128000
CVTVIOP  EQU   CVTS01+488                                               08129000
CVTRV307 EQU   CVTS01+486                                               08130000
CVTRV306 EQU   CVTS01+484                                               08131000
CVTRV305 EQU   CVTS01+482                                               08132000
CVTRV304 EQU   CVTS01+480                                               08133000
CVTRV303 EQU   CVTS01+478                                               08134000
CVTRV302 EQU   CVTS01+476                                               08135000
CVTTRCA  EQU   CVTS01+472                                               08136000
CVTRV297 EQU   CVTRV289                                                 08137000
CVTRV296 EQU   CVTRV289                                                 08138000
CVTRV295 EQU   CVTRV289                                                 08139000
CVTRV294 EQU   CVTRV289                                                 08140000
CVTRV293 EQU   CVTRV289                                                 08141000
CVTRV292 EQU   CVTRV289                                                 08142000
CVTRV291 EQU   CVTRV289                                                 08143000
CVTRV290 EQU   CVTRV289                                                 08144000
CVTRV288 EQU   CVTRV280                                                 08145000
CVTRV287 EQU   CVTRV280                                                 08146000
CVTRV286 EQU   CVTRV280                                                 08147000
CVTRV285 EQU   CVTRV280                                                 08148000
CVTRV284 EQU   CVTRV280                                                 08149000
CVTRV283 EQU   CVTRV280                                                 08150000
CVTRV282 EQU   CVTRV280                                                 08151000
CVTRV281 EQU   CVTRV280                                                 08152000
CVTRV279 EQU   CVTRV271                                                 08153000
CVTRV278 EQU   CVTRV271                                                 08154000
CVTRV277 EQU   CVTRV271                                                 08155000
CVTRV276 EQU   CVTRV271                                                 08156000
CVTRV275 EQU   CVTRV271                                                 08157000
CVTRV274 EQU   CVTRV271                                                 08158000
CVTRV273 EQU   CVTRV271                                                 08159000
CVTRV272 EQU   CVTRV271                                                 08160000
CVTRV270 EQU   CVTRV262                                                 08161000
CVTRV269 EQU   CVTRV262                                                 08162000
CVTRV268 EQU   CVTRV262                                                 08163000
CVTRV267 EQU   CVTRV262                                                 08164000
CVTRV266 EQU   CVTRV262                                                 08165000
CVTRV265 EQU   CVTRV262                                                 08166000
CVTRV264 EQU   CVTRV262                                                 08167000
CVTRV263 EQU   CVTRV262                                                 08168000
CVTVFP   EQU   CVTS01+464                                               08169000
CVTVSI   EQU   CVTS01+460                                               08170000
CVTVPSIB EQU   CVTS01+456                                               08171000
CVTMFACT EQU   CVTMFRTR                                                 08172000
CVTMFCTL EQU   CVTS01+448                                               08173000
CVTPVBP  EQU   CVTS01+444                                               08174000
CVTPWI   EQU   CVTS01+440                                               08175000
CVTRV254 EQU   CVTS01+438                                               08176000
CVTRV253 EQU   CVTS01+436                                               08177000
CVTRV252 EQU   CVTS01+434                                               08178000
CVTRV251 EQU   CVTS01+433                                               08179000
CVTRV250 EQU   CVTS01+432                                               08180000
CVTRV249 EQU   CVTS01+431                                               08181000
CVTRV248 EQU   CVTS01+430                                               08182000
CVTRV247 EQU   CVTS01+429                                               08183000
CVTRV246 EQU   CVTS01+428                                               08184000
CVTRV245 EQU   CVTRV237                                                 08185000
CVTRV244 EQU   CVTRV237                                                 08186000
CVTRV243 EQU   CVTRV237                                                 08187000
CVTRV242 EQU   CVTRV237                                                 08188000
CVTRV241 EQU   CVTRV237                                                 08189000
CVTRV240 EQU   CVTRV237                                                 08190000
CVTRV239 EQU   CVTRV237                                                 08191000
CVTRV238 EQU   CVTRV237                                                 08192000
CVTRV236 EQU   CVTRV228                                                 08193000
CVTRV235 EQU   CVTRV228                                                 08194000
CVTRV234 EQU   CVTRV228                                                 08195000
CVTRV233 EQU   CVTRV228                                                 08196000
CVTRV232 EQU   CVTRV228                                                 08197000
CVTRV231 EQU   CVTRV228                                                 08198000
CVTRV230 EQU   CVTRV228                                                 08199000
CVTRV229 EQU   CVTRV228                                                 08200000
CVTRV227 EQU   CVTRV219                                                 08201000
CVTRV226 EQU   CVTRV219                                                 08202000
CVTRV225 EQU   CVTRV219                                                 08203000
CVTRV224 EQU   CVTRV219                                                 08204000
CVTRV223 EQU   CVTRV219                                                 08205000
CVTRV222 EQU   CVTRV219                                                 08206000
CVTRV221 EQU   CVTRV219                                                 08207000
CVTRV220 EQU   CVTRV219                                                 08208000
CVTRV218 EQU   CVTRV210                                                 08209000
CVTRV217 EQU   CVTRV210                                                 08210000
CVTRV216 EQU   CVTRV210                                                 08211000
CVTRV215 EQU   CVTRV210                                                 08212000
CVTRV214 EQU   CVTRV210                                                 08213000
CVTRV213 EQU   CVTRV210                                                 08214000
CVTRV212 EQU   CVTRV210                                                 08215000
CVTRV211 EQU   CVTRV210                                                 08216000
CVTLCCAT EQU   CVTS01+420                                               08217000
CVTPCCAT EQU   CVTS01+416                                               08218000
CVTIPCRP EQU   CVTS01+412                                               08219000
CVTIPCRI EQU   CVTS01+408                                               08220000
CVTIPCDS EQU   CVTS01+404                                               08221000
CVTAIDVT EQU   CVTS01+400                                               08222000
CVTSSAP  EQU   CVTS01+396                                               08223000
CVTEHCIR EQU   CVTS01+392                                               08224000
CVTEHDEF EQU   CVTS01+388                                               08225000
CVTDAIR  EQU   CVTS01+384                                               08226000
CVTPERFM EQU   CVTS01+380                                               08227000
CVT044R2 EQU   CVTS01+376                                               08228000
CVTFETCH EQU   CVTS01+372                                               08229000
CVTRSTWD EQU   CVTS01+368                                               08230000
CVTSPOST EQU   CVTS01+364                                               08231000
CVTIOBP  EQU   CVTS01+360                                               08232000
CVTASMVT EQU   CVTS01+356                                               08233000
CVTRECRQ EQU   CVTS01+352                                               08234000
CVTWSAC  EQU   CVTS01+348                                               08235000
CVTRV149 EQU   CVTS01+344                                               08236000
CVTWSAL  EQU   CVTS01+340                                               08237000
CVTSPSA  EQU   CVTS01+336                                               08238000
CVTGLMN  EQU   CVTS01+332                                               08239000
CVTVEAC0 EQU   CVTS01+328                                               08240000
CVT062R1 EQU   CVTS01+324                                               08241000
CVTRPOST EQU   CVTS01+320                                               08242000
CVTDQIQE EQU   CVTS01+316                                               08243000
CVTCSD   EQU   CVTS01+312                                               08244000
CVTLKRMA EQU   CVTS01+308                                               08245000
CVTRSPIE EQU   CVTS01+304                                               08246000
CVTRENQ  EQU   CVTS01+300                                               08247000
CVTLQCB  EQU   CVTS01+296                                               08248000
CVTFQCB  EQU   CVTS01+292                                               08249000
CVTQCS01 EQU   CVTS01+288                                               08250000
CVTAPFT  EQU   CVTS01+284                                               08251000
CVTPARRL EQU   CVTS01+280                                               08252000
CVTVWAIT EQU   CVTS01+276                                               08253000
CVTGSPL  EQU   CVTS01+272                                               08254000
CVTLSMQ  EQU   CVTS01+268                                               08255000
CVTGSMQ  EQU   CVTS01+264                                               08256000
CVTEXPRO EQU   CVTS01+260                                               08257000
CVTOPCTP EQU   CVTS01+256                                               08258000
CVTSIC   EQU   CVTS01+252                                               08259000
CVTTPIOS EQU   CVTS01+248                                               08260000
CVTRTMS  EQU   CVTS01+244                                               08261000
CVTSDBF  EQU   CVTS01+240                                               08262000
CVTSCBP  EQU   CVTS01+236                                               08263000
CVTSDMP  EQU   CVTS01+232                                               08264000
CVTSV60  EQU   CVTS01+228                                               08265000
CVTRTMCT EQU   CVTS01+224                                               08266000
CVTASCBL EQU   CVTS01+220                                               08267000
CVTASCBH EQU   CVTS01+216                                               08268000
CVTGDA   EQU   CVTS01+212                                               08269000
CVTASVT  EQU   CVTS01+208                                               08270000
CVTVVMDI EQU   CVTS01+204                                               08271000
CVTAQTOP EQU   CVTS01+200                                               08272000
CVTIOSCS EQU   CVTS01+196                                               08273000
CVTSDRM  EQU   CVTS01+192                                               08274000
CVTOPTE  EQU   CVTS01+188                                               08275000
CVTSTXU  EQU   CVTS01+184                                               08276000
CVTQUIS  EQU   CVTS01+180                                               08277000
CVTPARS  EQU   CVTS01+176                                               08278000
CVTS1EE  EQU   CVTS01+172                                               08279000
CVTFRAS  EQU   CVTS01+168                                               08280000
CVTQSAS  EQU   CVTS01+164                                               08281000
CVTCRAS  EQU   CVTS01+160                                               08282000
CVTCRMN  EQU   CVTS01+156                                               08283000
CVTDELCP EQU   CVTS01+152                                               08284000
CVTFRECL EQU   CVTS01+148                                               08285000
CVTGETCL EQU   CVTS01+144                                               08286000
CVTBLDCP EQU   CVTS01+140                                               08287000
CVTAUTHL EQU   CVTS01+136                                               08288000
CVTSCAN  EQU   CVTS01+132                                               08289000
CVTRV144 EQU   CVTS01+130                                               08290000
CVTMAXMP EQU   CVTS01+128                                               08291000
CVTSTCK  EQU   CVTS01+124                                               08292000
CVTRV139 EQU   CVTS01+123                                               08293000
CVTDSSAC EQU   CVTS01+122                                               08294000
CVTRV513 EQU   CVTS01+121                                               08295000
CVTIOSPL EQU   CVTS01+120                                               08296000
CVTPTGT  EQU   CVTS01+116                                               08297000
CVTCSPIE EQU   CVTS01+112                                               08298000
CVTSMFEX EQU   CVTS01+108                                               08299000
CVTOLT0A EQU   CVTS01+104                                               08300000
CVTSRBRT EQU   CVTS01+100                                               08301000
CVTPUTL  EQU   CVTS01+96                                                08302000
CVTASCRL EQU   CVTS01+92                                                08303000
CVTASCRF EQU   CVTS01+88                                                08304000
CVTRV326 EQU   CVTS01+84                                                08305000
CVTRV325 EQU   CVTS01+80                                                08306000
CVTRV324 EQU   CVTS01+76                                                08307000
CVT0VL01 EQU   CVTS01+72                                                08308000
CVTSHRVM EQU   CVTS01+68                                                08309000
CVTRV332 EQU   CVTS01+64                                                08310000
CVTTAS   EQU   CVTS01+60                                                08311000
CVTRSCN  EQU   CVTS01+56                                                08312000
CVTTRAC2 EQU   CVTS01+54                                                08313000
CVTTRACE EQU   CVTS01+52                                                08314000
CVTAPG   EQU   CVTS01+51                                                08315000
CVTSDTRC EQU   CVTCTLFG                                                 08316000
CVTGTRCE EQU   CVTCTLFG                                                 08317000
CVTNOMP  EQU   CVTCTLFG                                                 08318000
CVTRSV79 EQU   CVTCTLFG                                                 08319000
CVTDSTAT EQU   CVTCTLFG                                                 08320000
CVTRSV78 EQU   CVTCTLFG                                                 08321000
CVTRV333 EQU   CVTCTLFG                                                 08322000
CVTRV323 EQU   CVTCTLFG                                                 08323000
CVTSPVLK EQU   CVTS01+49                                                08324000
CVTRSV77 EQU   CVTS01+48                                                08325000
CVTRV331 EQU   CVTS01+44                                                08326000
CVTRV330 EQU   CVTS01+40                                                08327000
CVTRV329 EQU   CVTS01+36                                                08328000
CVTRV328 EQU   CVTS01+32                                                08329000
CVTRV322 EQU   CVTS01+28                                                08330000
CVTSLID  EQU   CVTSLIDA+1                                               08331000
CVTSYLK  EQU   CVTSLIDA                                                 08332000
CVTRV321 EQU   CVTS01+20                                                08333000
CVTRV320 EQU   CVTS01+16                                                08334000
CVTLPDIR EQU   CVTLPDIA+1                                               08335000
CVTRSV69 EQU   CVTDIRST                                                 08336000
CVTRSV68 EQU   CVTDIRST                                                 08337000
CVTRSV67 EQU   CVTDIRST                                                 08338000
CVTRSV66 EQU   CVTDIRST                                                 08339000
CVTRSV65 EQU   CVTDIRST                                                 08340000
CVTRSV64 EQU   CVTDIRST                                                 08341000
CVTRSV63 EQU   CVTDIRST                                                 08342000
CVTDICOM EQU   CVTDIRST                                                 08343000
CVTPVTP  EQU   CVTS01+8                                                 08344000
CVTLPDSR EQU   CVTS01+4                                                 08345000
CVTGETL  EQU   CVTS01                                                   08346000
JFCBEND  EQU   JFCBS001+58                                              08347000
JFCBSPTN EQU   JFCBS001+57                                              08348000
JFCBSBNM EQU   JFCBS001+50                                              08349000
JFCBRV08 EQU   JFCBSPNM+1                                               08350000
JFCBRV07 EQU   JFCBFLG3                                                 08351000
JFCBRV06 EQU   JFCBFLG3                                                 08352000
JFCBRV05 EQU   JFCBFLG3                                                 08353000
JFCBRV04 EQU   JFCBFLG3                                                 08354000
JFCBRV03 EQU   JFCBFLG3                                                 08355000
JFCBRV02 EQU   JFCBFLG3                                                 08356000
JFCBRV01 EQU   JFCBFLG3                                                 08357000
JFCDQDSP EQU   JFCBFLG3                                                 08358000
JFCBDQTY EQU   JFCBS001+42                                              08359000
JFCBUAFF EQU   JFCFLGS1                                                 08360000
JFCRSV45 EQU   JFCFLGS1                                                 08361000
JFCVRDS  EQU   JFCFLGS1                                                 08362000
JFCBCEOV EQU   JFCFLGS1                                                 08363000
JFCRSV42 EQU   JFCFLGS1                                                 08364000
JFCBADSP EQU   JFCFLGS1                                                 08365000
JFCTOPEN EQU   JFCFLGS1                                                 08366000
JFCBDLET EQU   JFCFLGS1                                                 08367000
JFCRQID  EQU   JFCBSQTY                                                 08368000
JFCROUND EQU   JFCBCTRI                                                 08369000
JFCRSV29 EQU   JFCBCTRI                                                 08370000
JFCBMSGP EQU   JFCBCTRI                                                 08371000
JFCRUNIT EQU   JFCBPQTY                                                 08372000
JFCBEXAD EQU   JFCBS001+31                                              08373000
JFCBEXTL EQU   JFCBS001+30                                              08374000
@NM00040 EQU   JFCBS001                                                 08375000
JFCBNVOL EQU   JFCUCSEG+9                                               08376000
JFCBNTCS EQU   JFCUCSEG+8                                               08377000
JFCSOWA  EQU   JFCOUTLI+1                                               08378000
JFCSEND  EQU   JFCCPRI                                                  08379000
JFCEQUAL EQU   JFCCPRI                                                  08380000
JFCRECV  EQU   JFCCPRI                                                  08381000
JFCRSV34 EQU   JFCCPRI                                                  08382000
JFCRSV33 EQU   JFCCPRI                                                  08383000
JFCRSV55 EQU   JFCCPRI                                                  08384000
JFCRSV54 EQU   JFCCPRI                                                  08385000
JFCRSV53 EQU   JFCCPRI                                                  08386000
JFCRSV27 EQU   JFCUCSOP                                                 08387000
JFCRSV26 EQU   JFCUCSOP                                                 08388000
JFCFCBVR EQU   JFCUCSOP                                                 08389000
JFCFCBAL EQU   JFCUCSOP                                                 08390000
JFCVER   EQU   JFCUCSOP                                                 08391000
JFCRSV25 EQU   JFCUCSOP                                                 08392000
JFCFOLD  EQU   JFCUCSOP                                                 08393000
JFCBEXTP EQU   JFCUCSOP                                                 08394000
JFCUCSID EQU   JFCUCSEG                                                 08395000
JFCINTVL EQU   JFCSPPRT+19                                              08396000
JFCDBUFN EQU   JFCRESRV+3                                               08397000
JFCCYLOF EQU   JFCRESRV+2                                               08398000
JFCRKP   EQU   JFCRESRV                                                 08399000
JFCPCIR2 EQU   JFCPCI                                                   08400000
JFCPCIR1 EQU   JFCPCI                                                   08401000
JFCPCIN2 EQU   JFCPCI                                                   08402000
JFCPCIN1 EQU   JFCPCI                                                   08403000
JFCPCIA2 EQU   JFCPCI                                                   08404000
JFCPCIA1 EQU   JFCPCI                                                   08405000
JFCPCIX2 EQU   JFCPCI                                                   08406000
JFCPCIX1 EQU   JFCPCI                                                   08407000
JFCBUFMX EQU   JFCNCP                                                   08408000
JFCLRECL EQU   JFCAMSYN                                                 08409000
JFCBAXBF EQU   JFCBUFSI                                                 08410000
JFCREL   EQU   JFCREORG                                                 08411000
JFCRSV22 EQU   JFCDEL                                                   08412000
JFCSRCHD EQU   JFCRSV20                                                 08413000
JFCOPTQ  EQU   JFCACT                                                   08414000
JFCFEED  EQU   JFCIND                                                   08415000
JFCCBWU  EQU   JFCEXT                                                   08416000
JFCWUMSG EQU   JFCOVER                                                  08417000
JFCSDNAM EQU   JFCWVCBD                                                 08418000
@NM00039 EQU   JFCRECFM                                                 08419000
JFCCHAR  EQU   JFCRECFM                                                 08420000
JFCRFS   EQU   JFCRECFM                                                 08421000
JFCRFB   EQU   JFCRECFM                                                 08422000
JFCFMREC EQU   JFCRCFM                                                  08423000
JFCRSV16 EQU   JFCDSRG2                                                 08424000
JFCRSV15 EQU   JFCDSRG2                                                 08425000
JFCORGTR EQU   JFCDSRG2                                                 08426000
JFCORGAM EQU   JFCDSRG2                                                 08427000
JFCRSV13 EQU   JFCDSRG2                                                 08428000
JFCORGTQ EQU   JFCDSRG2                                                 08429000
JFCORGTX EQU   JFCDSRG2                                                 08430000
JFCORGGS EQU   JFCDSRG2                                                 08431000
JFCORGU  EQU   JFCDSRG1                                                 08432000
JFCORGMQ EQU   JFCDSRG1                                                 08433000
JFCORGCQ EQU   JFCDSRG1                                                 08434000
JFCORGCX EQU   JFCDSRG1                                                 08435000
JFCORGDA EQU   JFCDSRG1                                                 08436000
JFCORGPS EQU   JFCDSRG1                                                 08437000
JFCTRKBL EQU   JFCLIMCT+1                                               08438000
@NM00038 EQU   JFCLIMCT                                                 08439000
JFCDEN   EQU   JFCSPPRT+1                                               08440000
JFCPRTSP EQU   JFCSPPRT                                                 08441000
JFCONE   EQU   JFCMODE                                                  08442000
JFCTWO   EQU   JFCMODE                                                  08443000
JFCRSV07 EQU   JFCMODE                                                  08444000
JFCRSV06 EQU   JFCMODE                                                  08445000
JFCMODER EQU   JFCMODE                                                  08446000
JFCMODEO EQU   JFCMODE                                                  08447000
JFCEBCD  EQU   JFCMODE                                                  08448000
JFCBIN   EQU   JFCMODE                                                  08449000
JFCRSV32 EQU   JFCCODE                                                  08450000
JFCTTY   EQU   JFCCODE                                                  08451000
JFCASCII EQU   JFCCODE                                                  08452000
JFCNCR   EQU   JFCCODE                                                  08453000
JFCBUR   EQU   JFCCODE                                                  08454000
JFCFRI   EQU   JFCCODE                                                  08455000
JFCBCD   EQU   JFCCODE                                                  08456000
JFCNOCON EQU   JFCCODE                                                  08457000
UCBRV066 EQU   UCBOBS09+4                                               08458000
UCBIOSBA EQU   UCBOBS09                                                 08459000
UCBRV042 EQU   UCBOBS08+5                                               08460000
UCBRV082 EQU   UCBCTCF1                                                 08461000
UCBRV081 EQU   UCBCTCF1                                                 08462000
UCBRV080 EQU   UCBCTCF1                                                 08463000
UCBRV079 EQU   UCBCTCF1                                                 08464000
UCBRV078 EQU   UCBCTCF1                                                 08465000
UCBRV077 EQU   UCBCTCF1                                                 08466000
UCBRV076 EQU   UCBCTCF1                                                 08467000
UCBCTC80 EQU   UCBCTCF1                                                 08468000
UCBCTCAL EQU   UCBCTCAD                                                 08469000
UCBICNCB EQU   UCBOBS07+4                                               08470000
UCBRV040 EQU   UCBOBS07                                                 08471000
UCBCTLNA EQU   UCBCTLNK+1                                               08472000
UCBRLN   EQU   UCBCTLNK                                                 08473000
UCBRDYQA EQU   UCBLDNCB                                                 08474000
UCBINRLN EQU   UCBIRLN                                                  08475000
UCBIRBA  EQU   UCBIRB+1                                                 08476000
UCBRV039 EQU   UCBGRAF                                                  08477000
UCBDWNR  EQU   UCBGRAF                                                  08478000
UCBRPND  EQU   UCBGRAF                                                  08479000
UCBUPM   EQU   UCBGRAF                                                  08480000
UCBBTAM  EQU   UCBGRAF                                                  08481000
UCBDRNO  EQU   UCBGRAF                                                  08482000
UCBDRO   EQU   UCBGRAF                                                  08483000
UCBOIP   EQU   UCBGRAF                                                  08484000
UCBATRCD EQU   @NM00035                                                 08485000
UCBSKPFG EQU   @NM00035                                                 08486000
UCBRIPND EQU   @NM00035                                                 08487000
UCBRTIAC EQU   @NM00035                                                 08488000
UCBRSV79 EQU   @NM00035                                                 08489000
UCBRSV78 EQU   @NM00035                                                 08490000
UCBRSV77 EQU   @NM00035                                                 08491000
UCBOLTEP EQU   @NM00035                                                 08492000
UCBATNCT EQU   UCBOBS06+2                                               08493000
UCBRSV76 EQU   UCBAOF2                                                  08494000
UCBRSV75 EQU   UCBAOF2                                                  08495000
UCBRSV74 EQU   UCBAOF2                                                  08496000
UCBRSV73 EQU   UCBAOF2                                                  08497000
UCBRSV72 EQU   UCBAOF2                                                  08498000
UCBRSV71 EQU   UCBAOF2                                                  08499000
UCBRSV70 EQU   UCBAOF2                                                  08500000
UCBRSV69 EQU   UCBAOF2                                                  08501000
UCBRSV68 EQU   UCBAOF1                                                  08502000
UCBRSV67 EQU   UCBAOF1                                                  08503000
UCBRSV66 EQU   UCBAOF1                                                  08504000
UCBRSV65 EQU   UCBAOF1                                                  08505000
UCBRSV64 EQU   UCBAOF1                                                  08506000
UCBOFNL  EQU   UCBAOF1                                                  08507000
UCBOFSP  EQU   UCBAOF1                                                  08508000
UCBOFMCR EQU   UCBAOF1                                                  08509000
UCBBTB   EQU   UCBBTA+1                                                 08510000
UCBDI    EQU   UCBBTA                                                   08511000
UCBSNS   EQU   UCBOBS04+8                                               08512000
UCBTEB   EQU   UCBOBS04+4                                               08513000
UCBGCB   EQU   UCBOBS04+3                                               08514000
UCBOPEN  EQU   UCBOBS04+2                                               08515000
UCBSTART EQU   UCBOBS04                                                 08516000
UCBXTNB  EQU   UCBXTN+1                                                 08517000
UCBRSV22 EQU   UCBVOPT                                                  08518000
UCBRSV21 EQU   UCBVOPT                                                  08519000
UCBRSV20 EQU   UCBVOPT                                                  08520000
UCBESVE  EQU   UCBVOPT                                                  08521000
UCBERPC  EQU   UCBVOPT                                                  08522000
UCBESVC  EQU   UCBVOPT                                                  08523000
UCBEVA   EQU   UCBVOPT                                                  08524000
UCBESV   EQU   UCBVOPT                                                  08525000
UCBRV009 EQU   UCBTFL1                                                  08526000
UCBRV008 EQU   UCBTFL1                                                  08527000
UCBRV007 EQU   UCBTFL1                                                  08528000
UCBRV006 EQU   UCBTFL1                                                  08529000
UCBRV005 EQU   UCBTFL1                                                  08530000
UCBDQDSP EQU   UCBTFL1                                                  08531000
UCBNSLTP EQU   UCBTFL1                                                  08532000
UCBNLTP  EQU   UCBTFL1                                                  08533000
UCBRES1B EQU   UCBOBS02+18                                              08534000
UCBFSER  EQU   UCBOBS02+12                                              08535000
@NM00034 EQU   UCBOBS02+4                                               08536000
UCBFSEQ  EQU   UCBOBS02+2                                               08537000
UCBFSCT  EQU   UCBOBS02                                                 08538000
UCBNEXP  EQU   UCBOBS01+20                                              08539000
UCBBASE  EQU   UCBOBS01+16                                              08540000
UCBRES1A EQU   UCBOBS01+15                                              08541000
UCBFL47  EQU   UCBFL4                                                   08542000
UCBFL46  EQU   UCBFL4                                                   08543000
UCBFL45  EQU   UCBFL4                                                   08544000
UCBRV065 EQU   UCBFL4                                                   08545000
UCBDSS   EQU   UCBFL4                                                   08546000
UCBRESVP EQU   UCBFL4                                                   08547000
UCBWDAV  EQU   UCBFL4                                                   08548000
UCBDAVV  EQU   UCBFL4                                                   08549000
UCBSQC   EQU   UCBOBS01+12                                              08550000
UCBDATP  EQU   UCBOBS01+12                                              08551000
UCBDMC   EQU   UCBDMCT                                                  08552000
UCBMOUNT EQU   UCBDMCT                                                  08553000
UCBBNUL  EQU   UCBSTAB                                                  08554000
UCBSHAR  EQU   UCBSTAB                                                  08555000
UCBBALB  EQU   UCBPRSRS                                                 08556000
UCBPGFL  EQU   UCBSTAB                                                  08557000
UCBDVSHR EQU   UCBBSVL                                                  08558000
UCBVOLI  EQU   UCBOBS01+4                                               08559000
UCBVTOC  EQU   UCBOBS01                                                 08560000
@NM00051 EQU   ENQRETRN                                                 08561000
JESPJESN EQU   JESCT+28                                                 08562000
JESSSCT  EQU   JESCT+24                                                 08563000
JESRESQM EQU   JESCT+16                                                 08564000
JESQMGR  EQU   JESCT+12                                                 08565000
JESUNITS EQU   JESCT+4                                                  08566000
@NM00044 EQU   JESCT                                                    08567000
SSMOPUAD EQU   SSMO+12                                                  08568000
SSMORSV0 EQU   SSMO+3                                                   08569000
@NM00043 EQU   SSMOFLG1                                                 08570000
SSMORUSE EQU   SSMOFLG1                                                 08571000
SSMOSCR  EQU   SSMOFLG1                                                 08572000
SSMOFINL EQU   SSMOFLG1                                                 08573000
SSMOOPEN EQU   SSMOFLG1                                                 08574000
SSMOLEN  EQU   SSMO                                                     08575000
SSOBSSIB EQU   SSOB+8                                                   08576000
SSOBFUNC EQU   SSOB+6                                                   08577000
SSOBLEN  EQU   SSOB+4                                                   08578000
SSOBID   EQU   SSOB                                                     08579000
CVTLEVL  EQU   CVTRELNO+2                                               08580000
CVTNUMB  EQU   CVTRELNO                                                 08581000
CVTMDL   EQU   CVTFIX+250                                               08582000
@NM00042 EQU   CVTFIX+248                                               08583000
@NM00041 EQU   CVTFIX                                                   08584000
CVTRV482 EQU   CVTXTNT2+128                                             08585000
CVTRV481 EQU   CVTXTNT2+124                                             08586000
CVTRV480 EQU   CVTXTNT2+120                                             08587000
CVTRV479 EQU   CVTXTNT2+118                                             08588000
CVTRV478 EQU   CVTXTNT2+117                                             08589000
CVTRV477 EQU   CVTXTNT2+116                                             08590000
CVTRV476 EQU   CVTXTNT2+115                                             08591000
CVTRV475 EQU   CVTXTNT2+114                                             08592000
CVTRV474 EQU   CVTRV466                                                 08593000
CVTRV473 EQU   CVTRV466                                                 08594000
CVTRV472 EQU   CVTRV466                                                 08595000
CVTRV471 EQU   CVTRV466                                                 08596000
CVTRV470 EQU   CVTRV466                                                 08597000
CVTRV469 EQU   CVTRV466                                                 08598000
CVTRV468 EQU   CVTRV466                                                 08599000
CVTRV467 EQU   CVTRV466                                                 08600000
CVTRV465 EQU   CVTRV457                                                 08601000
CVTRV464 EQU   CVTRV457                                                 08602000
CVTRV463 EQU   CVTRV457                                                 08603000
CVTRV462 EQU   CVTRV457                                                 08604000
CVTRV461 EQU   CVTRV457                                                 08605000
CVTRV460 EQU   CVTRV457                                                 08606000
CVTRV459 EQU   CVTRV457                                                 08607000
CVTRV458 EQU   CVTRV457                                                 08608000
CVTRV456 EQU   CVTXTNT2+108                                             08609000
CVTRV455 EQU   CVTXTNT2+104                                             08610000
CVTRV454 EQU   CVTXTNT2+100                                             08611000
CVTRV453 EQU   CVTXTNT2+96                                              08612000
CVTRV452 EQU   CVTXTNT2+94                                              08613000
CVTRV451 EQU   CVTXTNT2+92                                              08614000
CVTRV450 EQU   CVTXTNT2+90                                              08615000
CVTRV449 EQU   CVTXTNT2+88                                              08616000
CVTRV448 EQU   CVTXTNT2+87                                              08617000
CVTRV447 EQU   CVTXTNT2+86                                              08618000
CVTRV446 EQU   CVTRV438                                                 08619000
CVTRV445 EQU   CVTRV438                                                 08620000
CVTRV444 EQU   CVTRV438                                                 08621000
CVTRV443 EQU   CVTRV438                                                 08622000
CVTRV442 EQU   CVTRV438                                                 08623000
CVTRV441 EQU   CVTRV438                                                 08624000
CVTRV440 EQU   CVTRV438                                                 08625000
CVTRV439 EQU   CVTRV438                                                 08626000
CVTRV437 EQU   CVTRV429                                                 08627000
CVTRV436 EQU   CVTRV429                                                 08628000
CVTRV435 EQU   CVTRV429                                                 08629000
CVTRV434 EQU   CVTRV429                                                 08630000
CVTRV433 EQU   CVTRV429                                                 08631000
CVTRV432 EQU   CVTRV429                                                 08632000
CVTRV431 EQU   CVTRV429                                                 08633000
CVTRV430 EQU   CVTRV429                                                 08634000
CVTRV428 EQU   CVTXTNT2+80                                              08635000
CVTRV427 EQU   CVTXTNT2+76                                              08636000
CVTRV426 EQU   CVTXTNT2+72                                              08637000
CVTRV425 EQU   CVTXTNT2+68                                              08638000
CVTATACT EQU   CVTATCVT                                                 08639000
CVTRV423 EQU   CVTXTNT2+62                                              08640000
CVTRV422 EQU   CVTXTNT2+60                                              08641000
CVTRV421 EQU   CVTXTNT2+58                                              08642000
CVTRV420 EQU   CVTXTNT2+56                                              08643000
CVTRV419 EQU   CVTXTNT2+55                                              08644000
CVTRV418 EQU   CVTXTNT2+54                                              08645000
CVTRV417 EQU   CVTRV409                                                 08646000
CVTRV416 EQU   CVTRV409                                                 08647000
CVTRV415 EQU   CVTRV409                                                 08648000
CVTRV414 EQU   CVTRV409                                                 08649000
CVTRV413 EQU   CVTRV409                                                 08650000
CVTRV412 EQU   CVTRV409                                                 08651000
CVTRV411 EQU   CVTRV409                                                 08652000
CVTRV410 EQU   CVTRV409                                                 08653000
CVTRV408 EQU   CVTRV400                                                 08654000
CVTRV407 EQU   CVTRV400                                                 08655000
CVTRV406 EQU   CVTRV400                                                 08656000
CVTRV405 EQU   CVTRV400                                                 08657000
CVTRV404 EQU   CVTRV400                                                 08658000
CVTRV403 EQU   CVTRV400                                                 08659000
CVTRV402 EQU   CVTRV400                                                 08660000
CVTRV401 EQU   CVTRV400                                                 08661000
CVTICB   EQU   CVTXTNT2+48                                              08662000
CVTSKTA  EQU   CVTXTNT2+44                                              08663000
CVTRSV99 EQU   CVTXTNT2+40                                              08664000
CVTRSV98 EQU   CVTXTNT2+36                                              08665000
CVTRSV97 EQU   CVTXTNT2+34                                              08666000
CVTRSV96 EQU   CVTXTNT2+32                                              08667000
CVTOLTEP EQU   CVTXTNT2+28                                              08668000
CVTQIDA  EQU   CVTQID+1                                                 08669000
CVTRSV95 EQU   CVTQID                                                   08670000
CVTRSV94 EQU   CVTXTNT2+20                                              08671000
CVTRSV93 EQU   CVTXTNT2+16                                              08672000
CVTRSV92 EQU   CVTXTNT2+12                                              08673000
CVTDEBVR EQU   CVTXTNT2+8                                               08674000
CVTRSV91 EQU   CVTXTNT2+6                                               08675000
CVTRSV9H EQU   CVTFLGBT                                                 08676000
CVTRSV9G EQU   CVTFLGBT                                                 08677000
CVTRSV9F EQU   CVTFLGBT                                                 08678000
CVTRSV9E EQU   CVTFLGBT                                                 08679000
CVTRSV9D EQU   CVTFLGBT                                                 08680000
CVTRSV9C EQU   CVTFLGBT                                                 08681000
CVTVME   EQU   CVTFLGBT                                                 08682000
CVTNPE   EQU   CVTFLGBT                                                 08683000
CVTNUCLS EQU   CVTXTNT2+4                                               08684000
CVTDSSVA EQU   CVTDSSV+1                                                08685000
CVTRSV89 EQU   CVTDSSV                                                  08686000
CVTRSV88 EQU   CVTXTNT1+8                                               08687000
CVTRSV87 EQU   CVTXTNT1+4                                               08688000
CVTFACHN EQU   CVTXTNT1                                                 08689000
CVTRV488 EQU   CVTMAP+412                                               08690000
CVTRV487 EQU   CVTMAP+408                                               08691000
CVTRV486 EQU   CVTMAP+404                                               08692000
CVTRV485 EQU   CVTMAP+400                                               08693000
CVTACTAP EQU   CVTMAP+396                                               08694000
CVTAUTH  EQU   CVTMAP+392                                               08695000
CVTATMCA EQU   CVTATMCT+1                                               08696000
CVTATMST EQU   CVTATMCT                                                 08697000
CVTRSV61 EQU   CVTMAP+384                                               08698000
CVTVOLT1 EQU   CVTVOLM1+1                                               08699000
CVTVOLI1 EQU   CVTVOLF1                                                 08700000
CVTSTOA  EQU   CVTMAP+376                                               08701000
CVTRSV58 EQU   CVTMAP+374                                               08702000
CVTRSV57 EQU   CVTMAP+372                                               08703000
CVTDDCE  EQU   CVTMAP+368                                               08704000
CVTPNWFR EQU   CVTMAP+364                                               08705000
CVTSMF   EQU   CVTMAP+360                                               08706000
CVTSULK  EQU   CVTMAP+358                                               08707000
CVTSLKO  EQU   CVTSYSK                                                  08708000
CVTSLKP  EQU   CVTSYSK                                                  08709000
CVTSLKQ  EQU   CVTSYSK                                                  08710000
CVTSLKR  EQU   CVTSYSK                                                  08711000
CVTRSV56 EQU   CVTSYSK                                                  08712000
CVTRSV55 EQU   CVTSYSK                                                  08713000
CVTRSV54 EQU   CVTSYSK                                                  08714000
CVTRSV53 EQU   CVTSYSK                                                  08715000
CVTRSV52 EQU   CVTA1F1                                                  08716000
CVTRSV51 EQU   CVTA1F1                                                  08717000
CVTRSV50 EQU   CVTA1F1                                                  08718000
CVTRSV49 EQU   CVTA1F1                                                  08719000
CVTRSV48 EQU   CVTA1F1                                                  08720000
CVTRSV47 EQU   CVTA1F1                                                  08721000
CVTSRSW  EQU   CVTA1F1                                                  08722000
CVTPFSW  EQU   CVTA1F1                                                  08723000
CVTPCVT  EQU   CVTMAP+352                                               08724000
CVTRSV46 EQU   CVTMAP+344                                               08725000
CVTRSV45 EQU   CVTMAP+340                                               08726000
CVTRSV44 EQU   CVTMAP+338                                               08727000
CVTRSV43 EQU   CVTMAP+336                                               08728000
CVTHJESA EQU   CVTHJES+1                                                08729000
CVTRSV42 EQU   CVTHJES                                                  08730000
CVTEXT2A EQU   CVTEXT2+1                                                08731000
CVTRSV41 EQU   CVTEXT2                                                  08732000
CVTAPFA  EQU   CVTAPF+1                                                 08733000
CVTRSV40 EQU   CVTAPF                                                   08734000
CVTRV518 EQU   CVTINTLA                                                 08735000
CVTRV517 EQU   CVTERPV                                                  08736000
CVTEORM  EQU   CVTMAP+312                                               08737000
CVTMCHPR EQU   CVTMAP+308                                               08738000
CVTTZ    EQU   CVTMAP+304                                               08739000
CVTJEPS  EQU   CVTMAP+300                                               08740000
CVTMODE  EQU   CVTMAP+292                                               08741000
CVTPTRV  EQU   CVTMAP+288                                               08742000
CVTREAL  EQU   CVTMAP+284                                               08743000
CVTRSV39 EQU   CVTMAP+280                                               08744000
CVTRSV38 EQU   CVTMAP+276                                               08745000
CVTDMSRA EQU   CVTDMSR+1                                                08746000
CVTRV634 EQU   CVTDMSRF                                                 08747000
CVTRV633 EQU   CVTDMSRF                                                 08748000
CVTRV632 EQU   CVTDMSRF                                                 08749000
CVTRV631 EQU   CVTDMSRF                                                 08750000
CVTRV630 EQU   CVTDMSRF                                                 08751000
CVTRV629 EQU   CVTDMSRF                                                 08752000
CVTUDUMP EQU   CVTDMSRF                                                 08753000
CVTSDUMP EQU   CVTDMSRF                                                 08754000
CVTQMSGA EQU   CVTQMSG+1                                                08755000
CVTRSV36 EQU   CVTQMSG                                                  08756000
CVTAMFF  EQU   CVTMAP+264                                               08757000
CVTPURGA EQU   CVTPURG+1                                                08758000
CVTRSV35 EQU   CVTPURG                                                  08759000
CVTCBSP  EQU   CVTMAP+256                                               08760000
CVTATERA EQU   CVTATER+1                                                08761000
CVTSYST  EQU   CVTATER                                                  08762000
CVTVOLT2 EQU   CVTTAT                                                   08763000
CVTVOLI2 EQU   CVTVOLF2                                                 08764000
CVTAQAVB EQU   CVTAQAVT+1                                               08765000
CVTRSV34 EQU   CVTTCMFG                                                 08766000
CVTRSV33 EQU   CVTTCMFG                                                 08767000
CVTRSV32 EQU   CVTTCMFG                                                 08768000
CVTRSV31 EQU   CVTTCMFG                                                 08769000
CVTRSV30 EQU   CVTTCMFG                                                 08770000
CVTRSV29 EQU   CVTTCMFG                                                 08771000
CVTRSV28 EQU   CVTTCMFG                                                 08772000
CVTTCRDY EQU   CVTTCMFG                                                 08773000
CVTGTFA  EQU   CVTGTF+1                                                 08774000
CVTRSV27 EQU   CVTGTFST                                                 08775000
CVTRNIO  EQU   CVTGTFST                                                 08776000
CVTUSR   EQU   CVTGTFST                                                 08777000
CVTRV318 EQU   CVTFORM                                                  08778000
CVTRV317 EQU   CVTTMODE                                                 08779000
CVTRV316 EQU   CVTSTATE                                                 08780000
CVTRV315 EQU   CVTGTFS                                                  08781000
CVTGTFAV EQU   CVTGTFS                                                  08782000
CVT0SCR1 EQU   CVTMAP+232                                               08783000
CVTRV515 EQU   CVTMAP+228                                               08784000
CVTRMS   EQU   CVTMAP+224                                               08785000
CVTPATCH EQU   CVTMAP+220                                               08786000
CVTTSCE  EQU   CVTMAP+216                                               08787000
CVTLNKSC EQU   CVTMAP+214                                               08788000
CVTQABST EQU   CVTMAP+212                                               08789000
CVTMDLDS EQU   CVTMAP+208                                               08790000
CVTUSER  EQU   CVTMAP+204                                               08791000
CVTABEND EQU   CVTMAP+200                                               08792000
CVTSMCA  EQU   CVTMAP+196                                               08793000
CVTRSV18 EQU   CVTMAP+192                                               08794000
CVTQLPAQ EQU   CVTMAP+188                                               08795000
CVTQCDSR EQU   CVTMAP+184                                               08796000
CVTRSV17 EQU   CVTOPTB                                                  08797000
CVTRSV16 EQU   CVTOPTB                                                  08798000
CVTFP    EQU   CVTOPTB                                                  08799000
CVTAPTHR EQU   CVTOPTB                                                  08800000
CVTNLOG  EQU   CVTOPTB                                                  08801000
CVTTOD   EQU   CVTOPTB                                                  08802000
CVTCTIMS EQU   CVTOPTB                                                  08803000
CVTPROT  EQU   CVTOPTB                                                  08804000
CVTXPFP  EQU   CVTOPTA                                                  08805000
CVTASCII EQU   CVTOPTA                                                  08806000
CVTRSV13 EQU   CVTOPTA                                                  08807000
CVTRSV12 EQU   CVTOPTA                                                  08808000
CVTNIP   EQU   CVTOPTA                                                  08809000
CVTDDR   EQU   CVTOPTA                                                  08810000
CVTAPR   EQU   CVTOPTA                                                  08811000
CVTCCH   EQU   CVTOPTA                                                  08812000
CVTSNCTR EQU   CVTMAP+180                                               08813000
CVTQMWR  EQU   CVTMAP+176                                               08814000
CVTQOCR  EQU   CVTMAP+172                                               08815000
CVT1EF00 EQU   CVTMAP+168                                               08816000
CVTMZ00  EQU   CVTMAP+164                                               08817000
CVTSV76Q EQU   CVTSV76C                                                 08818000
CVTRSV11 EQU   CVTMAP+156                                               08819000
CVT0PT01 EQU   CVTMAP+152                                               08820000
CVTMSER  EQU   CVTMAP+148                                               08821000
CVTRV516 EQU   CVTIERLC                                                 08822000
CVTILCH  EQU   CVTMAP+140                                               08823000
CVT0DS   EQU   CVTMAP+136                                               08824000
CVTFBOSV EQU   CVTMAP+132                                               08825000
CVTNUCB  EQU   CVTMAP+128                                               08826000
CVTIXAVL EQU   CVTMAP+124                                               08827000
CVTSV76M EQU   CVTIOQET                                                 08828000
CVTDCBA  EQU   CVTMAP+117                                               08829000
CVTMVS2  EQU   CVTDCB                                                   08830000
CVT6DAT  EQU   CVTDCB                                                   08831000
CVT4MPS  EQU   CVTDCB                                                   08832000
CVTRSV09 EQU   CVTDCB                                                   08833000
CVT4MS1  EQU   CVTDCB                                                   08834000
CVT2SPS  EQU   CVTDCB                                                   08835000
CVT1SSS  EQU   CVTDCB                                                   08836000
CVTRSV08 EQU   CVTDCB                                                   08837000
CVTSTB   EQU   CVTMAP+112                                               08838000
CVTQTD00 EQU   CVTMAP+108                                               08839000
CVTQTE00 EQU   CVTMAP+104                                               08840000
CVTCUCB  EQU   CVTMAP+100                                               08841000
CVTSJQ   EQU   CVTMAP+96                                                08842000
CVTPBLDL EQU   CVTMAP+92                                                08843000
CVTTPC   EQU   CVTMAP+88                                                08844000
CVTSVDCB EQU   CVTMAP+84                                                08845000
CVTBRET  EQU   CVTMAP+82                                                08846000
CVTEXIT  EQU   CVTMAP+80                                                08847000
CVT0FN00 EQU   CVTMAP+76                                                08848000
CVTDARA  EQU   CVTDAR+1                                                 08849000
CVTRSV07 EQU   CVTFLGS1                                                 08850000
CVTRSV06 EQU   CVTFLGS1                                                 08851000
CVTRSV05 EQU   CVTFLGS1                                                 08852000
CVTRSV04 EQU   CVTFLGS1                                                 08853000
CVTRSV03 EQU   CVTFLGS1                                                 08854000
CVTRSV02 EQU   CVTFLGS1                                                 08855000
CVTRSV01 EQU   CVTFLGS1                                                 08856000
CVTDMPLK EQU   CVTFLGS1                                                 08857000
CVTXITP  EQU   CVTMAP+68                                                08858000
CVTZDTAB EQU   CVTMAP+64                                                08859000
CVTMSLT  EQU   CVTMAP+60                                                08860000
CVTBTERM EQU   CVTMAP+52                                                08861000
CVTSYSAD EQU   CVTMAP+48                                                08862000
CVTXTLER EQU   CVTMAP+44                                                08863000
CVTILK2  EQU   CVTMAP+40                                                08864000
CVTILK1  EQU   CVTMAP+36                                                08865000
CVTPRLTV EQU   CVTMAP+32                                                08866000
CVTPCNVT EQU   CVTMAP+28                                                08867000
CVT0VL00 EQU   CVTMAP+24                                                08868000
CVTXAPG  EQU   CVTMAP+20                                                08869000
CVTBUF   EQU   CVTMAP+16                                                08870000
CVTJOB   EQU   CVTMAP+12                                                08871000
CVTLINK  EQU   CVTMAP+8                                                 08872000
CVT0EF00 EQU   CVTMAP+4                                                 08873000
CVTTCBP  EQU   CVTMAP                                                   08874000
CVT      EQU   CVTMAP                                                   08875000
JFCRSV05 EQU   JFCEROPT                                                 08876000
JFCRSV04 EQU   JFCEROPT                                                 08877000
JFCRSV03 EQU   JFCEROPT                                                 08878000
JFCRSV02 EQU   JFCEROPT                                                 08879000
JFCTOPT  EQU   JFCEROPT                                                 08880000
JFCABN   EQU   JFCEROPT                                                 08881000
JFCSKP   EQU   JFCEROPT                                                 08882000
JFCACC   EQU   JFCEROPT                                                 08883000
JFCBUFL  EQU   JFCAMPTR+2                                               08884000
JFCFWORD EQU   JFCBFTEK                                                 08885000
JFCDWORD EQU   JFCBFTEK                                                 08886000
JFCHIER1 EQU   JFCBFTEK                                                 08887000
JFCDYN   EQU   JFCBFTEK                                                 08888000
JFCEXC   EQU   JFCBFTEK                                                 08889000
JFCBBFTR EQU   JFCBBFTA                                                 08890000
JFCSIM   EQU   JFCBBFTA                                                 08891000
JFCHIER  EQU   JFCBFTEK                                                 08892000
JFCBFOUT EQU   JFCBUFNO                                                 08893000
JFCBUFIN EQU   JFCBUFNO                                                 08894000
JFCTEMP  EQU   JFCBIND2                                                 08895000
JFCREQ   EQU   JFCBIND2                                                 08896000
JFCENT   EQU   JFCBIND2                                                 08897000
JFCSHARE EQU   JFCBIND2                                                 08898000
JFCSECUR EQU   JFCBIND2                                                 08899000
JFCDISP  EQU   JFCBIND2                                                 08900000
JFCPDS   EQU   JFCBIND1                                                 08901000
JFCGDG   EQU   JFCBIND1                                                 08902000
JFCADDED EQU   JFCBIND1                                                 08903000
JFCLOC   EQU   JFCBIND1                                                 08904000
JFCBCRDT EQU   INFMJFCB+80                                              08905000
JFCBOPS2 EQU   JFCBMASK+7                                               08906000
JFCRCTLG EQU   JFCBFLG2                                                 08907000
JFCBBUFF EQU   JFCBFLG2                                                 08908000
JFCTRACE EQU   JFCBFLG2                                                 08909000
JFCSDRPS EQU   JFCBFLG2                                                 08910000
JFCMODNW EQU   JFCBFLG2                                                 08911000
JFCNRPS  EQU   JFCDEFER                                                 08912000
JFCOUTOP EQU   JFCBFLG2                                                 08913000
JFCINOP  EQU   JFCBFLG2                                                 08914000
JFCBPWBP EQU   JFCOPEN                                                  08915000
@NM00037 EQU   JFCOPEN                                                  08916000
JFCDUAL  EQU   JFCBFLG1                                                 08917000
JFCSLDES EQU   JFCBFLG1                                                 08918000
JFCSLCRE EQU   JFCBFLG1                                                 08919000
JFCSTAND EQU   JFCBFLG1                                                 08920000
JFCBOPS1 EQU   JFCBMASK                                                 08921000
JFCBVLSQ EQU   INFMJFCB+70                                              08922000
JFCRSV31 EQU   JFCFUNC                                                  08923000
JFCFNCBT EQU   JFCFUNC                                                  08924000
JFCFNCBX EQU   JFCFUNC                                                  08925000
JFCFNCBD EQU   JFCFUNC                                                  08926000
JFCFNCBW EQU   JFCFUNC                                                  08927000
JFCFNCBP EQU   JFCFUNC                                                  08928000
JFCFNCBR EQU   JFCFUNC                                                  08929000
JFCFNCBI EQU   JFCFUNC                                                  08930000
JFCBFOFL EQU   JFCBUFOF                                                 08931000
JFCNL    EQU   JFCBLTYP                                                 08932000
JFCSL    EQU   JFCBLTYP                                                 08933000
JFCNSL   EQU   JFCBLTYP                                                 08934000
JFCSUL   EQU   JFCBLTYP                                                 08935000
JFCBLP   EQU   JFCBLTYP                                                 08936000
JFCBLTM  EQU   JFCBLTYP                                                 08937000
JFCBAL   EQU   JFCBLTYP                                                 08938000
JFCRSV38 EQU   JFCBLTYP                                                 08939000
JFCVINDX EQU   INFMJFCB+64                                              08940000
JFCNLREC EQU   INFMJFCB+62                                              08941000
JFCBADBF EQU   INFMJFCB+60                                              08942000
JFCAMSTR EQU   JFCBFRID+2                                               08943000
JFCAMCRO EQU   JFCBFRID                                                 08944000
JFCBDSCB EQU   INFMJFCB+53                                              08945000
JFCPAT   EQU   JFCBTSDM                                                 08946000
JFCNDCB  EQU   JFCBTSDM                                                 08947000
JFCNDSCB EQU   JFCBTSDM                                                 08948000
JFCNWRIT EQU   JFCBTSDM                                                 08949000
JFCTTR   EQU   JFCBTSDM                                                 08950000
JFCSDS   EQU   JFCBTSDM                                                 08951000
JFCVSL   EQU   JFCBTSDM                                                 08952000
JFCCAT   EQU   JFCBTSDM                                                 08953000
JFCIPLTX EQU   JFCBELNM                                                 08954000
JFCBQNAM EQU   JFCBDSNM                                                 08955000
UCBERADR EQU   UCBUCS+12                                                08956000
UCBFCBID EQU   UCBUCS+8                                                 08957000
UCBERCNT EQU   UCBUCS+7                                                 08958000
UCBRSV51 EQU   UCBUCS+6                                                 08959000
UCBFCBPE EQU   UCBFCBOP                                                 08960000
UCBRSV49 EQU   UCBFCBOP                                                 08961000
UCBRSV48 EQU   UCBFCBOP                                                 08962000
UCBRSV47 EQU   UCBFCBOP                                                 08963000
UCBRSV46 EQU   UCBFCBOP                                                 08964000
UCBRSV45 EQU   UCBFCBOP                                                 08965000
UCBRSV44 EQU   UCBFCBOP                                                 08966000
UCBFCBO1 EQU   UCBFCBOP                                                 08967000
UCBUCSPE EQU   UCBUCSOP                                                 08968000
UCBRSV43 EQU   UCBUCSOP                                                 08969000
UCBRSV42 EQU   UCBUCSOP                                                 08970000
UCBRSV41 EQU   UCBUCSOP                                                 08971000
UCBRSV40 EQU   UCBUCSOP                                                 08972000
UCBRSV39 EQU   UCBUCSOP                                                 08973000
UCBUCSO2 EQU   UCBUCSOP                                                 08974000
UCBUCSO1 EQU   UCBUCSOP                                                 08975000
UCBUCSID EQU   UCBUCS                                                   08976000
UCBMDRBA EQU   UCBMDRBF+1                                               08977000
UCBRV075 EQU   UCBMDRBF                                                 08978000
UCBRV074 EQU   UCB3800X+32                                              08979000
UCBIMAGE EQU   UCB3800X+28                                              08980000
UCBFCBNM EQU   UCB3800X+24                                              08981000
UCBCHAR4 EQU   UCB3800X+20                                              08982000
UCBCHAR3 EQU   UCB3800X+16                                              08983000
UCBCHAR2 EQU   UCB3800X+12                                              08984000
UCBCHAR1 EQU   UCB3800X+8                                               08985000
UCBCGMID EQU   UCB3800X+4                                               08986000
UCBBRSTA EQU   UCBACTIV                                                 08987000
UCBRV063 EQU   UCBACTIV                                                 08988000
UCBRV062 EQU   UCBACTIV                                                 08989000
UCBRV061 EQU   UCBACTIV                                                 08990000
UCBRV060 EQU   UCBACTIV                                                 08991000
UCBRV059 EQU   UCBACTIV                                                 08992000
UCBRV058 EQU   UCBACTIV                                                 08993000
UCBRV057 EQU   UCBACTIV                                                 08994000
UCBRV050 EQU   UCB3800X+2                                               08995000
UCBCGMNO EQU   UCB3800X+1                                               08996000
UCBRV083 EQU   UCBOPTNS                                                 08997000
UCBBRSTR EQU   UCBOPTNS                                                 08998000
UCBRV056 EQU   UCBOPTNS                                                 08999000
UCBRV055 EQU   UCBOPTNS                                                 09000000
UCBRV054 EQU   UCBOPTNS                                                 09001000
UCBRV053 EQU   UCBOPTNS                                                 09002000
UCBRV052 EQU   UCBOPTNS                                                 09003000
UCBRV051 EQU   UCBOPTNS                                                 09004000
UCBRV073 EQU   UCB3540X+7                                               09005000
UCBRV072 EQU   UCBDKBYT                                                 09006000
UCBRV071 EQU   UCBDKBYT                                                 09007000
UCBRV070 EQU   UCBDKBYT                                                 09008000
UCBRV069 EQU   UCBDKBYT                                                 09009000
UCBRV068 EQU   UCBDKBYT                                                 09010000
UCBRV067 EQU   UCBDKBYT                                                 09011000
UCBVLVER EQU   UCBDKBYT                                                 09012000
UCBDKAMX EQU   UCBDKBYT                                                 09013000
UCBVLSER EQU   UCB3540X                                                 09014000
UCBRDATA EQU   UCBOCR+4                                                 09015000
UCBFRID  EQU   UCBOCR                                                   09016000
UCBCLN   EQU   UCBMT+14                                                 09017000
UCBERG   EQU   UCBMT+12                                                 09018000
UCBMS    EQU   UCBMT+11                                                 09019000
UCBNB    EQU   UCBMT+10                                                 09020000
UCBPW    EQU   UCBMT+9                                                  09021000
UCBPR    EQU   UCBMT+8                                                  09022000
UCBSIO   EQU   UCBMT+6                                                  09023000
UCBTW    EQU   UCBMT+5                                                  09024000
UCBTR    EQU   UCBMT+4                                                  09025000
UCBTWT   EQU   UCBMT+3                                                  09026000
UCBTRT   EQU   UCBMT+2                                                  09027000
UCBCTD   EQU   UCBMT                                                    09028000
UCBWTOID EQU   UCBCMEXT+17                                              09029000
UCBRV043 EQU   UCBCMEXT+16                                              09030000
UCBASID  EQU   UCBCMEXT+14                                              09031000
UCBMFCNT EQU   UCBCMEXT+12                                              09032000
UCBPMSK  EQU   UCBCMEXT+10                                              09033000
UCBCCWOF EQU   UCBCMEXT+8                                               09034000
UCBRV041 EQU   UCBCMEXT+6                                               09035000
UCBRV036 EQU   UCBFLP1                                                  09036000
UCBRV035 EQU   UCBFLP1                                                  09037000
UCBERLOG EQU   UCBFLP1                                                  09038000
UCBRV033 EQU   UCBFLP1                                                  09039000
UCBINHIO EQU   UCBFLP1                                                  09040000
UCBNSWAP EQU   UCBFLP1                                                  09041000
UCBSHRUP EQU   UCBFLP1                                                  09042000
UCBNSRCH EQU   UCBFLP1                                                  09043000
UCBSNSCT EQU   UCBCMEXT+4                                               09044000
UCBHPDV  EQU   @NM00036                                                 09045000
UCBHALI  EQU   @NM00036                                                 09046000
UCBRSV09 EQU   @NM00036                                                 09047000
UCBRSV08 EQU   @NM00036                                                 09048000
UCBRSV07 EQU   @NM00036                                                 09049000
UCBRSV06 EQU   @NM00036                                                 09050000
UCBRSV05 EQU   @NM00036                                                 09051000
UCBRSV04 EQU   @NM00036                                                 09052000
UCBDTI   EQU   UCBCMEXT+2                                               09053000
UCBSTI   EQU   UCBCMEXT+1                                               09054000
UCBETI   EQU   UCBCMEXT                                                 09055000
UCBEXTP  EQU   UCBEXTPT+1                                               09056000
UCBDDRSW EQU   UCBFLC                                                   09057000
UCBTICBT EQU   UCBFLC                                                   09058000
UCBIVRR  EQU   UCBFLC                                                   09059000
UCBIVRS  EQU   UCBFLC                                                   09060000
UCBITF   EQU   UCBFLC                                                   09061000
UCBUDE   EQU   UCBFLC                                                   09062000
UCBWAA   EQU   UCBFLC                                                   09063000
UCBATTP  EQU   UCBFLC                                                   09064000
UCBUNTYP EQU   UCBTBYT4                                                 09065000
UCBRSV11 EQU   UCBDVCLS                                                 09066000
UCBRSV10 EQU   UCBDVCLS                                                 09067000
UCB3CHAR EQU   UCBDVCLS                                                 09068000
UCB3UREC EQU   UCBDVCLS                                                 09069000
UCB3DISP EQU   UCBDVCLS                                                 09070000
UCB3DACC EQU   UCBDVCLS                                                 09071000
UCB3COMM EQU   UCBDVCLS                                                 09072000
UCB3TAPE EQU   UCBDVCLS                                                 09073000
UCBDVPWR EQU   UCB2OPT7                                                 09074000
UCBVLPWR EQU   UCB2OPT6                                                 09075000
UCB2OPT5 EQU   UCBTBYT2                                                 09076000
UCBRVDEV EQU   UCBRWTAU                                                 09077000
UCBRPS   EQU   UCBDUDN2                                                 09078000
UCBRR    EQU   UCBDUDN1                                                 09079000
UCB2OPT1 EQU   UCBTBYT2                                                 09080000
UCB2OPT0 EQU   UCBTBYT2                                                 09081000
UCB1FEA7 EQU   UCBTBYT1                                                 09082000
UCBD6250 EQU   UCB1FEA6                                                 09083000
UCBD1600 EQU   UCB1FEA5                                                 09084000
UCB1FEA4 EQU   UCBTBYT1                                                 09085000
UCB1FEA3 EQU   UCBTBYT1                                                 09086000
UCB1FEA2 EQU   UCBTBYT1                                                 09087000
UCB1FEA1 EQU   UCBTBYT1                                                 09088000
UCB1FEA0 EQU   UCBTBYT1                                                 09089000
UCBNAME  EQU   UCBOB+13                                                 09090000
UCBRV029 EQU   UCBWGT                                                   09091000
UCBVHRSN EQU   UCBWGT                                                   09092000
UCBVORSN EQU   UCBWGT                                                   09093000
UCBMTPXP EQU   UCBWGT                                                   09094000
UCBREW   EQU   UCBWGT                                                   09095000
UCBPUB   EQU   UCBWGT                                                   09096000
UCBOUT   EQU   UCBWGT                                                   09097000
UCBIN    EQU   UCBWGT                                                   09098000
UCBCPU   EQU   UCBOB+11                                                 09099000
UCBLCI   EQU   UCBOB+10                                                 09100000
UCBCNT   EQU   UCBOB+9                                                  09101000
UCBRV017 EQU   UCBCHM1                                                  09102000
UCBRV016 EQU   UCBCHM1                                                  09103000
UCBRV015 EQU   UCBCHM1                                                  09104000
UCBRV014 EQU   UCBCHM1                                                  09105000
UCBSPB   EQU   UCBPTH1                                                  09106000
UCBPPB   EQU   UCBPTH1                                                  09107000
UCBSPA   EQU   UCBPTH0                                                  09108000
UCBPPA   EQU   UCBPTH0                                                  09109000
UCBSIGP  EQU   UCBFLB                                                   09110000
UCBVALPH EQU   UCBFLB                                                   09111000
UCBCRHSN EQU   UCBFLB                                                   09112000
UCBCRHRV EQU   UCBFLB                                                   09113000
UCBRESVH EQU   UCBFLB                                                   09114000
UCBSPST  EQU   UCBFLB                                                   09115000
UCBASNS  EQU   UCBFLB                                                   09116000
UCBIORST EQU   UCBFLB                                                   09117000
UCBQISCE EQU   UCBFL1                                                   09118000
UCBACTV  EQU   UCBFL1                                                   09119000
UCBSAP   EQU   UCBFL1                                                   09120000
UCBNOTRC EQU   UCBCUB                                                   09121000
UCBPSNS  EQU   UCBFL1                                                   09122000
UCBUSING EQU   UCBPST                                                   09123000
UCBNOTRD EQU   UCBNRY                                                   09124000
UCBBUSYD EQU   UCBBSY                                                   09125000
UCBUA    EQU   UCBCHAN+1                                                09126000
UCBCHA   EQU   UCBCHAN                                                  09127000
UCBDADI  EQU   UCBSTAT                                                  09128000
UCBSYSR  EQU   UCBSTAT                                                  09129000
UCBALOC  EQU   UCBSTAT                                                  09130000
UCBUNLD  EQU   UCBSTAT                                                  09131000
UCBCHGS  EQU   UCBSTAT                                                  09132000
UCBID    EQU   UCBOB+2                                                  09133000
UCBALTPH EQU   UCBFL5                                                   09134000
UCBALTCU EQU   UCBFL5                                                   09135000
UCBNALOC EQU   UCBFL5                                                   09136000
UCBENVRD EQU   UCBFL5                                                   09137000
UCBVSDR  EQU   UCBFL5                                                   09138000
UCBSASK  EQU   UCBFL5                                                   09139000
UCBAMV   EQU   UCBAF                                                    09140000
UCBDCC   EQU   UCBFL5                                                   09141000
UCBMONT  EQU   UCBJBNR                                                  09142000
UCBRV011 EQU   UCBJBNR                                                  09143000
UCBMMSGP EQU   UCBJBNR                                                  09144000
UCBOLDSM EQU   UCBJBNR                                                  09145000
UCBRV003 EQU   UCBJBNR                                                  09146000
UCBDUC   EQU   UCBJBNR                                                  09147000
UCBJES3  EQU   UCBJBNR                                                  09148000
UCBVRDEV EQU   UCBJBNR                                                  09149000
UCBCMSEG EQU   UCBOB                                                    09150000
UCBPFXND EQU   UCB+512                                                  09151000
UCBIOQ   EQU   UCB+508                                                  09152000
UCBLOCK  EQU   UCB+504                                                  09153000
UCBPXST  EQU   UCB+504                                                  09154000
@NM00033 EQU   UCB                                                      09155000
@NM00032 EQU   BFMISCFL+1                                               09156000
BFJESOK  EQU   BFMISCFL                                                 09157000
@NM00031 EQU   BFLPFLGS                                                 09158000
BFSHCNFL EQU   BFLPFLGS                                                 09159000
@NM00030 EQU   BFHPFLGS                                                 09160000
@NM00029 EQU   BFREQFLS                                                 09161000
VOLLEN   EQU   VOLRT                                                    09162000
@NM00028 EQU   STPDDFLG                                                 09163000
STPDDSPL EQU   STPDDFLG                                                 09164000
STPDDEXC EQU   STPDDFLG                                                 09165000
STPDDPRM EQU   STPDDENT+22                                              09166000
STPDDGPS EQU   STPDDENT+21                                              09167000
STPDDGPI EQU   STPDDENT+20                                              09168000
STPDDGPN EQU   STPDDENT+12                                              09169000
STPDDDVT EQU   STPDDENT+8                                               09170000
STPDDNUM EQU   STPDDENT+6                                               09171000
STPDDLEN EQU   STPDDENT+4                                               09172000
STPDDNXT EQU   STPDDENT                                                 09173000
STPDDPTR EQU   STPTB+16                                                 09174000
STPICCTR EQU   STPTB+15                                                 09175000
@NM00027 EQU   STPFLAGS                                                 09176000
STPNOFRE EQU   STPFLAGS                                                 09177000
STPINVAL EQU   STPFLAGS                                                 09178000
STPHDRLN EQU   STPTB+12                                                 09179000
STPJOBID EQU   STPTB+8                                                  09180000
STPPRVTB EQU   STPTB+4                                                  09181000
STPNXTTB EQU   STPTB                                                    09182000
@NM00026 EQU   TABHDRET+2                                               09183000
@NM00025 EQU   TABP+1                                                   09184000
@NM00024 EQU   TABFLAGS                                                 09185000
TABFFREE EQU   TABFLAGS                                                 09186000
TABFUTRM EQU   TABFLAGS                                                 09187000
@NM00023 EQU   UNIFLAGS                                                 09188000
UNIFALLV EQU   UNIFLAGS                                                 09189000
@NM00022 EQU   UNITP+10                                                 09190000
@NM00021 EQU   GVSVOLFL+2                                               09191000
@NM00020 EQU   GVSHDR+20                                                09192000
@NM00019 EQU   GVSHDR+17                                                09193000
@NM00018 EQU   GVSFLAGA+2                                               09194000
@NM00017 EQU   GVSTYPE                                                  09195000
GVSGVSEX EQU   GVSTYPE                                                  09196000
@NM00016 EQU   GVSTYPE                                                  09197000
GVSRES1  EQU   GVSID                                                    09198000
GVSG     EQU   GVSNAME                                                  09199000
@NM00015 EQU   GROUP+136                                                09200000
GROADDR  EQU   GROUP+106                                                09201000
GROOWNER EQU   GROUP+96                                                 09202000
GRODESCR EQU   GROUP+64                                                 09203000
GROERRTM EQU   GROERRTS+4                                               09204000
GROFREXT EQU   GROUP+48                                                 09205000
GROFRESP EQU   GROUP+44                                                 09206000
GRONINAC EQU   GROUP+34                                                 09207000
GRONRSTD EQU   GROUP+32                                                 09208000
GROLSN   EQU   GROUP+23                                                 09209000
GROFSN   EQU   GROUP+17                                                 09210000
@NM00014 EQU   GROFLAGA+2                                               09211000
GRORONLY EQU   GROFLAGA+2                                               09212000
GRODAERA EQU   GROFLAGA+2                                               09213000
GROBIND  EQU   GROFLAGA+2                                               09214000
GRORES1  EQU   GROTYPE                                                  09215000
GROGVR   EQU   GROTYPE                                                  09216000
GROZERO  EQU   GROID+1                                                  09217000
GROBLANK EQU   GROID                                                    09218000
GROG     EQU   GRONAME                                                  09219000
@NM00013 EQU   BASEV+192                                                09220000
BASXPDT2 EQU   BASEV+188                                                09221000
BASRECOV EQU   BASEV+174                                                09222000
BASDEST  EQU   BASEV+144                                                09223000
BASOWNER EQU   BASEV+134                                                09224000
BASDESCR EQU   BASEV+104                                                09225000
BASDTREM EQU   BASEV+100                                                09226000
BASDLMTD EQU   BASEV+92                                                 09227000
BASRES6  EQU   BASEV+89                                                 09228000
BASCOPNO EQU   BASCOPID+1                                               09229000
BASCOPBK EQU   BASCOPID                                                 09230000
BASCOPSN EQU   BASKLCPY+5                                               09231000
BASCOPV  EQU   BASKLCPY                                                 09232000
BASFREXT EQU   BASEV+72                                                 09233000
BASLEXT  EQU   BASEV+70                                                 09234000
BASFRESP EQU   BASEV+68                                                 09235000
@NM00012 EQU   BASEV+65                                                 09236000
BASBKLMT EQU   BASEV+64                                                 09237000
BASNBKUP EQU   BASEV+63                                                 09238000
BASNCOPY EQU   BASEV+62                                                 09239000
BASNEXTV EQU   BASEV+56                                                 09240000
BASPREV  EQU   BASEV+50                                                 09241000
BAS2BIT2 EQU   BASLID2                                                  09242000
BAS2BIT1 EQU   BASLID2                                                  09243000
BASRES5  EQU   BASLIB2                                                  09244000
BASCSN2  EQU   BASEV+37                                                 09245000
BAS1BIT2 EQU   BASLID1                                                  09246000
BAS1BIT1 EQU   BASLID1                                                  09247000
BASRES4  EQU   BASLIB1                                                  09248000
BASCSN1  EQU   BASEV+24                                                 09249000
BASRES3  EQU   BASMISCF                                                 09250000
BASHOLD  EQU   BASMISCF                                                 09251000
BASRES8  EQU   BASSATIA                                                 09252000
BASVSMIS EQU   BASSATIA                                                 09253000
BASIVCPY EQU   BASSATIA                                                 09254000
BASIVCRE EQU   BASSATIA                                                 09255000
BASCPUID EQU   BASEV+18                                                 09256000
@NM00011 EQU   BASFLAGA+3                                               09257000
BASLAST  EQU   BASFLAGA+3                                               09258000
BASFIRST EQU   BASFLAGA+3                                               09259000
BASREASS EQU   BASFLAGA+3                                               09260000
BASRONLY EQU   BASFLAGA+3                                               09261000
BASDAERA EQU   BASFLAGA+3                                               09262000
BASEXCL  EQU   BASFLAGA+2                                               09263000
BASBIND  EQU   BASFLAGA+2                                               09264000
BASINAC  EQU   BASFLAGA+2                                               09265000
BASRSTD  EQU   BASFLAGA+2                                               09266000
BASNOCPY EQU   BASFLAGA+2                                               09267000
BASDLSF  EQU   BASFLAGA+2                                               09268000
BASRES2  EQU   BASTYPE                                                  09269000
BASBASVR EQU   BASTYPE                                                  09270000
BASRES1  EQU   BASTYPE                                                  09271000
BASRES7  EQU   BASEV+13                                                 09272000
BASZERO  EQU   BASID+1                                                  09273000
BASBLANK EQU   BASID                                                    09274000
BASEVKEY EQU   BASNAME                                                  09275000
@NM00010 EQU   MVR+82                                                   09276000
MVRLABEL EQU   MVR+76                                                   09277000
MVRBLNK1 EQU   MVR+75                                                   09278000
MVRBKUPN EQU   MVR+74                                                   09279000
MVRCSN   EQU   MVR+62                                                   09280000
MVRDES   EQU   MVR+28                                                   09281000
MVRGROUP EQU   MVR+20                                                   09282000
MVRFOR   EQU   MVR+18                                                   09283000
@NM00009 EQU   MVRFLAGA+2                                               09284000
MVRCICPY EQU   MVRFLAGA+2                                               09285000
MVRCIVCF EQU   MVRFLAGA+2                                               09286000
MVRCLMIS EQU   MVRFLAGA+1                                               09287000
MVRSLMIS EQU   MVRFLAGA+1                                               09288000
MVRNEXPD EQU   MVRFLAGA+1                                               09289000
MVRNDESC EQU   MVRFLAGA+1                                               09290000
MVRBKUP  EQU   MVRFLAGA+1                                               09291000
MVRNGRP  EQU   MVRFLAGA+1                                               09292000
MVRRSTD  EQU   MVRFLAGA+1                                               09293000
MVRGEN   EQU   MVRFLAGA+1                                               09294000
MVRFLLAB EQU   MVRFLAGA                                                 09295000
MVRFLBK  EQU   MVRFLAGA                                                 09296000
MVRFLCSN EQU   MVRFLAGA                                                 09297000
MVRFLDES EQU   MVRFLAGA                                                 09298000
MVRFLGRO EQU   MVRFLAGA                                                 09299000
MVRFLFOR EQU   MVRFLAGA                                                 09300000
@NM00008 EQU   MVRCODE+1                                                09301000
VVIUNUSD EQU   VVICB+116                                                09302000
VVINUSDC EQU   VVICB+112                                                09303000
VVITPFCH EQU   VVICB+108                                                09304000
VVIDVMEL EQU   VVICB+104                                                09305000
VVIVSCRA EQU   VVICB+92                                                 09306000
VVISTPTB EQU   VVICB+88                                                 09307000
VVIDVMTA EQU   VVICB+84                                                 09308000
VVIJUCB  EQU   VVICB+80                                                 09309000
VVIIUCB  EQU   VVICB+76                                                 09310000
VVIRES6  EQU   VVICB+72                                                 09311000
VVIRES5  EQU   VVICB+68                                                 09312000
VVIRES4  EQU   VVICB+64                                                 09313000
VVIUCB   EQU   VVICB+60                                                 09314000
VVIVJL   EQU   VVICB+56                                                 09315000
VVIVRR   EQU   VVICB+52                                                 09316000
VVIQLSPL EQU   VVICB+48                                                 09317000
VVIQRPL2 EQU   VVICB+44                                                 09318000
VVIQRPL1 EQU   VVICB+40                                                 09319000
VVIVTRK  EQU   VVICB+37                                                 09320000
VVIOPCD  EQU   VVICB+36                                                 09321000
VVIVQMP  EQU   VVICB+32                                                 09322000
VVIECB1  EQU   VVICB+28                                                 09323000
VVICATAD EQU   VVICB+24                                                 09324000
VVIDCBAD EQU   VVICB+20                                                 09325000
VVIACBAD EQU   VVICB+16                                                 09326000
VVIFLG7  EQU   VVIFLGA                                                  09327000
VVIFLG6  EQU   VVIFLGA                                                  09328000
VVIFLG5  EQU   VVIFLGA                                                  09329000
VVIFLG4  EQU   VVIFLGA                                                  09330000
VVIFLG3  EQU   VVIFLGA                                                  09331000
VVIFLG2  EQU   VVIFLGA                                                  09332000
VVIFLG1  EQU   VVIFLGA                                                  09333000
VVIALCON EQU   VVICB+14                                                 09334000
VVIUCAT  EQU   VVICB+4                                                  09335000
VVICID   EQU   VVICB                                                    09336000
RPLVRLN  EQU   RPLVSAM+48                                               09337000
@NM00007 EQU   RPLVSAM+44                                               09338000
@NM00006 EQU   RPLVOPT                                                  09339000
@NM00005 EQU   RPLVOPT                                                  09340000
RPLVNEXT EQU   RPLVOPT                                                  09341000
RPLVLOC  EQU   RPLVOPT                                                  09342000
@NM00004 EQU   RPLVSAM+28                                               09343000
RPLVACB  EQU   RPLVSAM+24                                               09344000
@NM00003 EQU   RPLVSAM+3                                                09345000
@NM00002 EQU   RPLVSAM                                                  09346000
@NM00001 EQU   RPLV+42                                                  09347000
RPLVDATE EQU   RPLV+38                                                  09348000
RPLRMSCC EQU   RPLV+36                                                  09349000
RPLVRES1 EQU   RPLFLAGA+1                                               09350000
RPLVJRNL EQU   RPLFLAGA                                                 09351000
RPLJRCVY EQU   RPLFLAGA                                                 09352000
RPLVVOP  EQU   RPLFLAGA                                                 09353000
RPLVVIN  EQU   RPLFLAGA                                                 09354000
RPLVCOMP EQU   RPLFLAGA                                                 09355000
RPLVPROG EQU   RPLFLAGA                                                 09356000
RPLVPOST EQU   RPLFLAGA                                                 09357000
RPLFTIME EQU   RPLFLAGA                                                 09358000
RPLVRSV3 EQU   RPLV+24                                                  09359000
RPLVRSV2 EQU   RPLV+20                                                  09360000
RPLVRSV1 EQU   RPLV+16                                                  09361000
RPLASCBP EQU   RPLTCBPR                                                 09362000
RPLVECB  EQU   RPLV+4                                                   09363000
RPLVQPTR EQU   RPLV                                                     09364000
SELUNUSE EQU   SELRB+64                                                 09365000
SELJFCBX EQU   SELRB+52                                                 09366000
SELUNUS2 EQU   SELRB+48                                                 09367000
SELDDNUM EQU   SELRB+44                                                 09368000
SELUNUS1 EQU   SELRB+41                                                 09369000
SELNOVSL EQU   SELFLGS2                                                 09370000
SELRPRIV EQU   SELFLGS2                                                 09371000
SELINITC EQU   SELFLGS2                                                 09372000
SELUNSEP EQU   SELFLGS2                                                 09373000
SELSUBAL EQU   SELFLGS2                                                 09374000
SELSCSPL EQU   SELFLGS2                                                 09375000
SELPRSPL EQU   SELFLGS2                                                 09376000
SELMXESO EQU   SELFLGS1                                                 09377000
SELVRGRP EQU   SELFLGS1                                                 09378000
SELVRNEW EQU   SELFLGS1                                                 09379000
SELVENQV EQU   SELFLGS1                                                 09380000
SELDEFER EQU   SELFLGS1                                                 09381000
SELRBOPC EQU   SELRB+4                                                  09382000
SELRBLEN EQU   SELRB                                                    09383000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      09384000
@RF00343 EQU   @RC00338                                                 09385000
@RF00367 EQU   @EL00001                                                 09386000
@RF00370 EQU   @EL00001                                                 09387000
@RF00390 EQU   @EL00002                                                 09388000
@RF00392 EQU   @EL00002                                                 09389000
@RF00537 EQU   @EL00003                                                 09390000
@RF00778 EQU   @EL00005                                                 09391000
@RC00788 EQU   @EL00006                                                 09392000
@RC00805 EQU   @EL00006                                                 09393000
@RC00818 EQU   @EL00006                                                 09394000
@RC00814 EQU   @EL00006                                                 09395000
@RC00837 EQU   @RC00835                                                 09396000
@RF00856 EQU   @EL00007                                                 09397000
@RC00861 EQU   @EL00008                                                 09398000
@RC00878 EQU   @EL00008                                                 09399000
@RC00872 EQU   @EL00008                                                 09400000
@RC00897 EQU   @EL00008                                                 09401000
@RF00938 EQU   @EL00008                                                 09402000
@RC00966 EQU   @RC00964                                                 09403000
@RC01013 EQU   @RC00964                                                 09404000
@RF01028 EQU   @EL00009                                                 09405000
@RF01032 EQU   @EL00009                                                 09406000
@RF01053 EQU   @EL00010                                                 09407000
@RC01091 EQU   @EL00012                                                 09408000
@RF01133 EQU   @RC01125                                                 09409000
@RC01145 EQU   @RC01143                                                 09410000
@RF01171 EQU   @EL00013                                                 09411000
@RC01209 EQU   @EL00015                                                 09412000
@RC01221 EQU   @EL00015                                                 09413000
@RC01249 EQU   @EL00016                                                 09414000
@RC01279 EQU   @EL00016                                                 09415000
@RC01274 EQU   @EL00016                                                 09416000
@RC01272 EQU   @EL00016                                                 09417000
@RF01423 EQU   @EL00017                                                 09418000
@RC00809 EQU   @RC00805                                                 09419000
@RC00807 EQU   @RC00805                                                 09420000
@RC00815 EQU   @RC00814                                                 09421000
@RF00875 EQU   @RC00872                                                 09422000
@RF00884 EQU   @RC00878                                                 09423000
@RF00912 EQU   @RC00897                                                 09424000
@RC00974 EQU   @RC00966                                                 09425000
@RF01162 EQU   @RC01145                                                 09426000
@RC01157 EQU   @RC01145                                                 09427000
@RC01253 EQU   @RC01249                                                 09428000
@RC01251 EQU   @RC01249                                                 09429000
@ENDDATA EQU   *                                                        09430000
         END   ICBVSL00,(C'PLS1955',0701,77354)                         09431000
