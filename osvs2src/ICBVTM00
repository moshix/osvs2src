TM00     TITLE '********  ICBVTM00:  MSVC TERMINATION PROCESSOR MODULE *00001000
                 *******'                                               00002000
ICBVTM00 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'ICBVTM00  76.275'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@12                                         0001 00013000
         ST    @13,@SA00001+4                                      0001 00014000
         LA    @14,@SA00001                                        0001 00015000
         ST    @14,8(,@13)                                         0001 00016000
         LR    @13,@14                                             0001 00017000
*   RPLVPTR=REG1;                   /*                       @G24LB37*/ 00018000
         LR    RPLVPTR,REG1                                        0044 00019000
*   RFY                                                            0045 00020000
*     REG1 UNRESTRICTED;            /*                       @G24LB37*/ 00021000
*   VVIPTR=RPLVVICB;                /*                       @G24LB37*/ 00022000
         L     VVIPTR,RPLVVICB(,RPLVPTR)                           0046 00023000
*   TRMRBPTR=ADDR(RPLVUTIL);        /*                       @G24LB37*/ 00024000
         LA    TRMRBPTR,RPLVUTIL(,RPLVPTR)                         0047 00025000
*   VTMTBPTR=TRMSTHDR;              /*                       @G24LB37*/ 00026000
         L     VTMTBPTR,TRMSTHDR(,TRMRBPTR)                        0048 00027000
*   RETCODE=ZERO;                   /*                       @G24LB37*/ 00028000
*                                                                  0049 00029000
         SLR   RETCODE,RETCODE                                     0049 00030000
*   /*****************************************************************/ 00031000
*   /*                                                               */ 00032000
*   /* IF THE MSVI INVENTORY DATA SET IS NOT DISABLED THEN   @G24LB37*/ 00033000
*   /* THE PROCEXT PROCEDURE IS CALLED TO PROCESS THE STEP   @G24LB37*/ 00034000
*   /* TABLE DD ENTRIES BY ADDING BACK THE SUBTRACTED SPACE  @G24LB37*/ 00035000
*   /* WITHIN THE GROUP EXTENSION RECORD.                    @G24LB37*/ 00036000
*   /*                                                               */ 00037000
*   /*****************************************************************/ 00038000
*                                                                  0050 00039000
*   IF VVIFLG0=OFF THEN                                            0050 00040000
         TM    VVIFLG0(VVIPTR),B'10000000'                         0050 00041000
         BNZ   @RF00050                                            0050 00042000
*     CALL PROCEXT;                 /*                       @G24LB37*/ 00043000
*                                                                  0051 00044000
         BAL   @14,PROCEXT                                         0051 00045000
*   /*****************************************************************/ 00046000
*   /*                                                               */ 00047000
*   /* SET THE FLAG BIT IN THE STEP TABLE HEADER ENTRY       @G24LB37*/ 00048000
*   /* STPNOFRE TO OFF, INDICATING THE STEP TABLE ENTRY      @G24LB37*/ 00049000
*   /* CAN BE DELETED.                                       @G24LB37*/ 00050000
*   /*                                                               */ 00051000
*   /*****************************************************************/ 00052000
*                                                                  0052 00053000
*   STPNOFRE=OFF;                   /*                       @G24LB37*/ 00054000
*                                                                  0052 00055000
@RF00050 NI    STPNOFRE(VTMTBPTR),B'10111111'                      0052 00056000
*   /*****************************************************************/ 00057000
*   /*                                                               */ 00058000
*   /* RETURN TO CALLER. RETURN CODE IS IGNORED BY THE       @G24LB37*/ 00059000
*   /* CALLER (ICBVCR00).                                    @G24LB37*/ 00060000
*   /*                                                               */ 00061000
*   /*****************************************************************/ 00062000
*                                                                  0053 00063000
*   RETURN;                         /* RETURN TO CALLER      @G24LB37*/ 00064000
@EL00001 L     @13,4(,@13)                                         0053 00065000
@EF00001 DS    0H                                                  0053 00066000
@ER00001 LM    @14,@12,12(@13)                                     0053 00067000
         BR    @14                                                 0053 00068000
*                                                                  0054 00069000
*/********************************************************************/ 00070000
*/*                                                                  */ 00071000
*/*     PROCEDURE NAME - PROCEXT                             @G24LB37*/ 00072000
*/*                                                          @G24LB37*/ 00073000
*/*     FUNCTION - THIS PROCEDURE CALLS READEXT, SPACEUPT,   @G24LB37*/ 00074000
*/*                AND WRITEXT TO UPDATE THE GROUP EXTENSION @G24LB37*/ 00075000
*/*                RECORD, AND RETURNS TO ICBVTM00.  BECAUSE @G24LB37*/ 00076000
*/*                THE VOLUMES APPROXIMATE RUNNING SPACE     @G24LB37*/ 00077000
*/*                VALUES TO UPDATE CAN BE IN SEVERAL DIF-   @G24LB37*/ 00078000
*/*                FERENT GVSNE RECORDS AND BECAUSE THE LAST @G24LB37*/ 00079000
*/*                RECORD READ FOR UPDATE HAS TO BE WRITTEN  @G24LB37*/ 00080000
*/*                BEFORE THE NEXT RECORD CAN BE READ, THE   @G24LB37*/ 00081000
*/*                GVSNE TO BE PROCESSED HAS TO BE CONTROL-  @G24LB37*/ 00082000
*/*                LED.  PROCEXT MUST KEEP TRACK OF WHICH    @G24LB37*/ 00083000
*/*                RECORD WAS READ AND IF SO, HAS IT BEEN    @G24LB37*/ 00084000
*/*                WRITTEN.  PROCEXT TO ACCOMPLISH THIS WILL @G24LB37*/ 00085000
*/*                KEEP TRACK OF THE LAST GVSNE READ AND UP- @G24LB37*/ 00086000
*/*                DATED IN THE STEP TABLE, BY SAVE AREAS IN @G24LB37*/ 00087000
*/*                THIS MODULE.  WHEN THE GVSNE IN THE STEP  @G24LB37*/ 00088000
*/*                TABLE CHANGES THEN PROCEXT WILL WRITE THE @G24LB37*/ 00089000
*/*                OLD GVSNE RECORD AND READ, FOR THE STEP   @G24LB37*/ 00090000
*/*                TABLE, THE NEW GVSNE RECORD.              @G24LB37*/ 00091000
*/*                                                          @G24LB37*/ 00092000
*/*     INPUT - THE POINTER TO THE STEP TABLE HEADER ENTRY   @G24LB37*/ 00093000
*/*             TO PROCESS.                                  @G24LB37*/ 00094000
*/*                                                          @G24LB37*/ 00095000
*/*     OUTPUT -  THE GVSMTDSP FIELD IN THE GVSNE IS UPDATED @G24LB37*/ 00096000
*/*               FOR EACH DD ENTRY FOUND IN THE STEP TABLE  @G24LB37*/ 00097000
*/*               REQUIRING AN UPDATE.                       @G24LB37*/ 00098000
*/*                                                                  */ 00099000
*/********************************************************************/ 00100000
*                                                                  0054 00101000
*PROCEXT:                                                          0054 00102000
*   PROCEDURE OPTIONS(SAVE(REG14)); /*                       @G24LB37*/ 00103000
PROCEXT  ST    @14,@SA00002                                        0054 00104000
*                                                                  0055 00105000
*   /*****************************************************************/ 00106000
*   /*                                                               */ 00107000
*   /* INITIALIZE TO THE BEGINNING OF THE STEP TABLE DD      @G24LB37*/ 00108000
*   /* ENTRIES (STPDDENT). SET THE INTERNAL RESERVE FLAG     @G24LB37*/ 00109000
*   /* TO ON INDICATING TO READEXT TO CALL ICBVRR00 TO       @G24LB37*/ 00110000
*   /* RESERVE THE MSVI DATA SET, IF READEXT IS CALLED.      @G24LB37*/ 00111000
*   /* INITIALIZE THE SAVE AREAS FOR THE GROUP NAME AND      @G24LB37*/ 00112000
*   /* GROUP INDEX TO NULL VALUES, INDICATING FIRST TIME     @G24LB37*/ 00113000
*   /* THROUGH. THE RECORD UPDATE FLAG IS TURNED OFF.        @G24LB37*/ 00114000
*   /*                                                               */ 00115000
*   /*****************************************************************/ 00116000
*                                                                  0055 00117000
*   RFY                                                            0055 00118000
*     STPDDENT BASED(VTMDDPTR);     /*                       @G24LB37*/ 00119000
*   VTMDDPTR=STPDDPTR;              /*                       @G24LB37*/ 00120000
         L     VTMDDPTR,STPDDPTR(,VTMTBPTR)                        0056 00121000
*   GVSNEPTR=ADDR(GVSNEBUF);        /*                       @G24LB37*/ 00122000
         LA    GVSNEPTR,GVSNEBUF                                   0057 00123000
*   SAVEAGRP=''B;                   /*                       @G24LB37*/ 00124000
         XC    SAVEAGRP(12),SAVEAGRP                               0058 00125000
*   RESERVEF=ON;                    /*                       @G24LB37*/ 00126000
*   RECUPDTF=OFF;                   /*                       @G24LB37*/ 00127000
*                                                                  0060 00128000
         OI    RESERVEF,B'10000000'                                0060 00129000
         NI    RECUPDTF,B'10111111'                                0060 00130000
*   /*****************************************************************/ 00131000
*   /*                                                               */ 00132000
*   /* SCAN THE STEP TABLE DD ENTRIES TO LOCATE ANY ENTRIES  @G24LB37*/ 00133000
*   /* THAT REQUIRE ADDING BACK SPACE IN THE GROUP EXTENSION @G24LB37*/ 00134000
*   /* RECORDS (GVSNE).                                      @G24LB37*/ 00135000
*   /*                                                               */ 00136000
*   /*****************************************************************/ 00137000
*                                                                  0061 00138000
*   DO WHILE VTMDDPTR^=ZERO;        /*                       @G24LB37*/ 00139000
*                                                                  0061 00140000
         B     @DE00061                                            0061 00141000
@DL00061 DS    0H                                                  0062 00142000
*     /***************************************************************/ 00143000
*     /*                                                             */ 00144000
*     /* IF THE STEP TABLE DD ENTRY FIELD IS NOT ZERO,       @G24LB37*/ 00145000
*     /* INDICATING SPACE HAS BEEN SUBTRACTED DURING THE     @G24LB37*/ 00146000
*     /* SELECTION PROCESS AND REQUIRES THE GVSNE FIELD      @G24LB37*/ 00147000
*     /* GVSMTDSP FIELD TO BE UPDATED, THEN PROCESS THE      @G24LB37*/ 00148000
*     /* STEP TABLE DD ENTRY.                                @G24LB37*/ 00149000
*     /*                                                             */ 00150000
*     /***************************************************************/ 00151000
*                                                                  0062 00152000
*     IF STPDDPRM^=ZERO THEN                                       0062 00153000
         LH    @03,STPDDPRM(,VTMDDPTR)                             0062 00154000
         LTR   @03,@03                                             0062 00155000
         BZ    @RF00062                                            0062 00156000
*       DO;                         /*                       @G24LB37*/ 00157000
*                                                                  0064 00158000
*         /***********************************************************/ 00159000
*         /*                                                         */ 00160000
*         /* IF THE SAVED GROUP NAME AND INDEX ARE NOT EQUAL @G24LB37*/ 00161000
*         /* TO THE CURRENT GROUP NAME AND INDEX, AND THE    @G24LB37*/ 00162000
*         /* RECORD UPDATED FLAG IS ON FOR THE CURRENT GROUP @G24LB37*/ 00163000
*         /* NAME AND INDEX, THEN WRITEXT IS CALLED TO WRITE @G24LB37*/ 00164000
*         /* THE GROUP EXTENSION RECORD BACK OUT TO THE MSVI @G24LB37*/ 00165000
*         /* DATA SET.                                       @G24LB37*/ 00166000
*         /*                                                         */ 00167000
*         /***********************************************************/ 00168000
*                                                                  0064 00169000
*         IF(SAVEGRPN^=STPDDGPN|SAVEINDX^=STPDDGPI)&RECUPDTF=ON THEN    00170000
         CLC   SAVEGRPN(8),STPDDGPN(VTMDDPTR)                      0064 00171000
         BNE   @GL00001                                            0064 00172000
         CLC   SAVEINDX(1),STPDDGPI(VTMDDPTR)                      0064 00173000
         BE    @RF00064                                            0064 00174000
@GL00001 TM    RECUPDTF,B'01000000'                                0064 00175000
         BNO   @RF00064                                            0064 00176000
*           DO;                     /*                       @G24LB37*/ 00177000
*             CALL WRITEXT;         /*                       @G24LB37*/ 00178000
*                                                                  0066 00179000
         BAL   @14,WRITEXT                                         0066 00180000
*             /*******************************************************/ 00181000
*             /*                                                     */ 00182000
*             /* UPON RETURN, INITIALIZE THE SAVE AREAS FOR  @G24LB37*/ 00183000
*             /* THE GROUP NAME AND INDEX TO NULL VALUES.    @G24LB37*/ 00184000
*             /* SET THE RECORD UPDATED FLAG TO OFF.         @G24LB37*/ 00185000
*             /*                                                     */ 00186000
*             /*******************************************************/ 00187000
*                                                                  0067 00188000
*             SAVEAGRP=''B;         /*                       @G24LB37*/ 00189000
         XC    SAVEAGRP(12),SAVEAGRP                               0067 00190000
*             RECUPDTF=OFF;         /*                       @G24LB37*/ 00191000
         NI    RECUPDTF,B'10111111'                                0068 00192000
*           END;                    /*                       @G24LB37*/ 00193000
*                                                                  0070 00194000
*         /***********************************************************/ 00195000
*         /*                                                         */ 00196000
*         /* IF THE SAVED GROUP NAME AND GROUP INDEX ARE     @G24LB37*/ 00197000
*         /* NULL VALUES, THEN THE READEXT PROCEDURE IS      @G24LB37*/ 00198000
*         /* CALLED TO READ THE GROUP EXTENSION RECORD.      @G24LB37*/ 00199000
*         /*                                                         */ 00200000
*         /***********************************************************/ 00201000
*                                                                  0070 00202000
*         IF(SAVEGRPN=NULLAREA&SAVEINDX=NULLAREA(ONE:ONE)) THEN    0070 00203000
@RF00064 CLC   SAVEGRPN(8),NULLAREA                                0070 00204000
         BNE   @RF00070                                            0070 00205000
         CLC   SAVEINDX(1),NULLAREA                                0070 00206000
         BNE   @RF00070                                            0070 00207000
*           DO;                     /*                       @G24LB37*/ 00208000
*             CALL READEXT;         /*                       @G24LB37*/ 00209000
*                                                                  0072 00210000
         BAL   @14,READEXT                                         0072 00211000
*             /*******************************************************/ 00212000
*             /*                                                     */ 00213000
*             /* IF THE RETURN CODE IS ZERO UPON RETURN,     @G24LB37*/ 00214000
*             /* THEN SET THE NEW VALUES GROUP NAME, INDEX,  @G24LB37*/ 00215000
*             /* AND SLOT INTO THE APPROPRIATE SAVE AREAS.   @G24LB37*/ 00216000
*             /*                                                     */ 00217000
*             /*******************************************************/ 00218000
*                                                                  0073 00219000
*             IF RETCODE=ZERO THEN                                 0073 00220000
         LTR   RETCODE,RETCODE                                     0073 00221000
         BNZ   @RF00073                                            0073 00222000
*               DO;                 /*                       @G24LB37*/ 00223000
*                 SAVEGRPN=STPDDGPN;/*                       @G24LB37*/ 00224000
         MVC   SAVEGRPN(8),STPDDGPN(VTMDDPTR)                      0075 00225000
*                 SAVEINDX=STPDDGPI;/*                       @G24LB37*/ 00226000
         MVC   SAVEINDX(1),STPDDGPI(VTMDDPTR)                      0076 00227000
*               END;                /*                       @G24LB37*/ 00228000
*           END;                    /*                       @G24LB37*/ 00229000
@RF00073 DS    0H                                                  0079 00230000
*                                                                  0079 00231000
*         /***********************************************************/ 00232000
*         /*                                                         */ 00233000
*         /* IF THE RETURN CODE IS ZERO, SPACEUPT IS CALLED  @G24LB37*/ 00234000
*         /* TO CALCULATE THE AMOUNT OF CYLINDERS THAT       @G24LB37*/ 00235000
*         /* SHOULD BE IN THE GVSNE FIELD GVSMTDSP AND       @G24LB37*/ 00236000
*         /* UPDATES THAT SPACE IN THE GVSNE.                @G24LB37*/ 00237000
*         /*                                                         */ 00238000
*         /***********************************************************/ 00239000
*                                                                  0079 00240000
*         IF RETCODE=ZERO THEN                                     0079 00241000
@RF00070 LTR   RETCODE,RETCODE                                     0079 00242000
         BNZ   @RF00079                                            0079 00243000
*           DO;                     /*                       @G24LB37*/ 00244000
*             CALL SPACEUPT;        /*                       @G24LB37*/ 00245000
*                                                                  0081 00246000
         BAL   @14,SPACEUPT                                        0081 00247000
*             /*******************************************************/ 00248000
*             /*                                                     */ 00249000
*             /* IF SPACEUPT RETURNS A RETURN CODE OF ZERO,  @G24LB37*/ 00250000
*             /* THEN THE RECORD UPDATE FLAG IS TURNED ON.   @G24LB37*/ 00251000
*             /* IF THE RETURN CODE IS FOUR, THEN SET THE    @G24LB37*/ 00252000
*             /* RETURN CODE TO ZERO.                        @G24LB37*/ 00253000
*             /*                                                     */ 00254000
*             /*******************************************************/ 00255000
*                                                                  0082 00256000
*             IF RETCODE=ZERO THEN                                 0082 00257000
         LTR   RETCODE,RETCODE                                     0082 00258000
         BNZ   @RF00082                                            0082 00259000
*               RECUPDTF=ON;        /*                       @G24LB37*/ 00260000
         OI    RECUPDTF,B'01000000'                                0083 00261000
*             ELSE                                                 0084 00262000
*               RETCODE=ZERO;       /*                       @G24LB37*/ 00263000
         B     @RC00082                                            0084 00264000
@RF00082 SLR   RETCODE,RETCODE                                     0084 00265000
*           END;                    /*                       @G24LB37*/ 00266000
*                                                                  0085 00267000
*         /***********************************************************/ 00268000
*         /*                                                         */ 00269000
*         /* IF THE RETURN CODE IS NOT ZERO UPON RETURN,     @G24LB37*/ 00270000
*         /* THEN PROCESS THE NEXT ENTRY, AFTER SETTING THE  @G24LB37*/ 00271000
*         /* RETURN CODE TO ZERO.                            @G24LB37*/ 00272000
*         /*                                                         */ 00273000
*         /***********************************************************/ 00274000
*                                                                  0086 00275000
*         ELSE                                                     0086 00276000
*           RETCODE=ZERO;           /*                       @G24LB37*/ 00277000
         B     @RC00079                                            0086 00278000
@RF00079 SLR   RETCODE,RETCODE                                     0086 00279000
*       END;                        /*                       @G24LB37*/ 00280000
@RC00079 DS    0H                                                  0088 00281000
*                                                                  0088 00282000
*     /***************************************************************/ 00283000
*     /*                                                             */ 00284000
*     /* IF THE STPDDPRM FIELD IS ZERO OR THE FIELD          @G24LB37*/ 00285000
*     /* GVSMTDSP WAS UPDATED, IN THE GVSNE, THEN GO BACK    @G24LB37*/ 00286000
*     /* TO PROCESS THE NEXT STEP TABLE DD ENTRY.            @G24LB37*/ 00287000
*     /*                                                             */ 00288000
*     /***************************************************************/ 00289000
*                                                                  0088 00290000
*     VTMDDPTR=STPDDNXT;            /*                       @G24LB37*/ 00291000
@RF00062 L     VTMDDPTR,STPDDNXT(,VTMDDPTR)                        0088 00292000
*   END;                            /*                       @G24LB37*/ 00293000
*                                                                  0089 00294000
@DE00061 LTR   VTMDDPTR,VTMDDPTR                                   0089 00295000
         BNZ   @DL00061                                            0089 00296000
*   /*****************************************************************/ 00297000
*   /*                                                               */ 00298000
*   /* IF THE RECORD UPDATED FLAG IS ON, AND THE SAVE AREA   @G24LB37*/ 00299000
*   /* FOR THE GROUP NAME IS NOT A NULL VALUE, THEN WRITEXT  @G24LB37*/ 00300000
*   /* IS CALLED TO WRITE THE LAST EXTENSION RECORD BACK     @G24LB37*/ 00301000
*   /* OUT TO THE MSVI DATA SET.                             @G24LB37*/ 00302000
*   /*                                                               */ 00303000
*   /*****************************************************************/ 00304000
*                                                                  0090 00305000
*   IF RECUPDTF=ON&SAVEGRPN^=NULLAREA THEN                         0090 00306000
         TM    RECUPDTF,B'01000000'                                0090 00307000
         BNO   @RF00090                                            0090 00308000
         CLC   SAVEGRPN(8),NULLAREA                                0090 00309000
         BE    @RF00090                                            0090 00310000
*     CALL WRITEXT;                 /*                       @G24LB37*/ 00311000
*                                                                  0091 00312000
         BAL   @14,WRITEXT                                         0091 00313000
*   /*****************************************************************/ 00314000
*   /*                                                               */ 00315000
*   /* RETURN TO CALLER, RETURN CODE IS IGNORED BY THE MAIN  @G24LB37*/ 00316000
*   /* ROUTINE ICBVTM00.                                     @G24LB37*/ 00317000
*   /*                                                               */ 00318000
*   /*****************************************************************/ 00319000
*                                                                  0092 00320000
*   RETURN;                         /* RET TO MAIN ROUTINE   @G24LB37*/ 00321000
@EL00002 DS    0H                                                  0092 00322000
@EF00002 DS    0H                                                  0092 00323000
@ER00002 L     @14,@SA00002                                        0092 00324000
         BR    @14                                                 0092 00325000
*   END PROCEXT;                    /* END OF PROCEXT PROC   @G24LB37*/ 00326000
         B     @EL00002                                            0093 00327000
*                                                                  0094 00328000
*/********************************************************************/ 00329000
*/*                                                                  */ 00330000
*/*     PROCEDURE NAME - READEXT                             @G24LB37*/ 00331000
*/*                                                          @G24LB37*/ 00332000
*/*     FUNCTION - THIS PROCEDURE CALLS ICBVRR00 TO RESERVE  @G24LB37*/ 00333000
*/*                THE MSVI DATA SET IF THIS IS THE FIRST    @G24LB37*/ 00334000
*/*                TIME CALLED, THEN CALLS ICBVIO00 TO READ  @G24LB37*/ 00335000
*/*                THE GROUP EXTENSION RECORD, AND RETURNS   @G24LB37*/ 00336000
*/*                TO THE PROCEXT PROCEDURE.                 @G24LB37*/ 00337000
*/*                                                          @G24LB37*/ 00338000
*/*     INPUT - THE POINTER TO THE STEP TABLE DD ENTRY TO    @G24LB37*/ 00339000
*/*             PROCESS, CONTAINING THE GROUP NAME AND       @G24LB37*/ 00340000
*/*             GROUP INDEX FIELDS.                          @G24LB37*/ 00341000
*/*                                                          @G24LB37*/ 00342000
*/*     OUTPUT -  THE GVSNEPTR FIELD POINTING TO THE GVSNE   @G24LB37*/ 00343000
*/*               FOR THE DD ENTRY FOUND IN THE STEP TABLE   @G24LB37*/ 00344000
*/*               REQUIRING AN UPDATE.  RETURN CODE IN       @G24LB37*/ 00345000
*/*               RETCODE AREA AS FOLLOWS:                   @G24LB37*/ 00346000
*/*               0 = SUCCESSFUL READ OF GROUP EXT RECORD.   @G24LB37*/ 00347000
*/*               4 = UNSUCCESSFUL READ OF GROUP EXT RECORD. @G24LB37*/ 00348000
*/*                                                                  */ 00349000
*/********************************************************************/ 00350000
*                                                                  0094 00351000
*READEXT:                                                          0094 00352000
*   PROCEDURE OPTIONS(SAVE(REG14)); /*                       @G24LB37*/ 00353000
READEXT  ST    @14,@SA00003                                        0094 00354000
*                                                                  0095 00355000
*   /*****************************************************************/ 00356000
*   /*                                                               */ 00357000
*   /* BEFORE MSVI PROCESSING CAN START, IF THE RESERVE      @G24LB37*/ 00358000
*   /* FLAG IS ON INDICATING THE FIRST TIME READEXT CALLED,  @G24LB37*/ 00359000
*   /* THE MSVI DATA SET IS RESERVED FOR EXCLUSIVE USE BOTH  @G24LB37*/ 00360000
*   /* FROM OTHER JOBS IN THE CPU PLUS JOBS IN OTHER CPU'S,  @G24LB37*/ 00361000
*   /* BY CALLING ICBVRR00. TURN RESERVE FLAG OFF.           @G24LB37*/ 00362000
*   /*                                                               */ 00363000
*   /*****************************************************************/ 00364000
*                                                                  0095 00365000
*   IF RESERVEF=ON THEN                                            0095 00366000
         TM    RESERVEF,B'10000000'                                0095 00367000
         BNO   @RF00095                                            0095 00368000
*     DO;                           /*                       @G24LB37*/ 00369000
*       RFY                                                        0097 00370000
*        (REG0,                                                    0097 00371000
*         REG1) RESTRICTED;         /*                       @G24LB37*/ 00372000
*       REG0=RESCODE;               /*                       @G24LB37*/ 00373000
         LA    REG0,1                                              0098 00374000
*       REG1=RPLVPTR;               /*                       @G24LB37*/ 00375000
         LR    REG1,RPLVPTR                                        0099 00376000
*       CALL ICBVRR00;              /*                       @G24LB37*/ 00377000
         L     @15,@CV00220                                        0100 00378000
         BALR  @14,@15                                             0100 00379000
*       RFY                                                        0101 00380000
*        (REG0,                                                    0101 00381000
*         REG1) UNRESTRICTED;       /*                       @G24LB37*/ 00382000
*       RESERVEF=OFF;               /*                       @G24LB37*/ 00383000
         NI    RESERVEF,B'01111111'                                0102 00384000
*     END;                          /*                       @G24LB37*/ 00385000
*                                                                  0103 00386000
*   /*****************************************************************/ 00387000
*   /*                                                               */ 00388000
*   /* BUILD THE MSVI KEY TO READ THE GROUP EXTENSION        @G24LB37*/ 00389000
*   /* RECORD DIRECT.                                        @G24LB37*/ 00390000
*   /*                                                               */ 00391000
*   /*****************************************************************/ 00392000
*                                                                  0104 00393000
*   GROUPNAM=STPDDGPN;              /*                       @G24LB37*/ 00394000
@RF00095 MVC   GROUPNAM(8),STPDDGPN(VTMDDPTR)                      0104 00395000
*   GROUPIND=STPDDGPI;              /*                       @G24LB37*/ 00396000
*                                                                  0105 00397000
         MVC   GROUPIND(1),STPDDGPI(VTMDDPTR)                      0105 00398000
*   /*****************************************************************/ 00399000
*   /*                                                               */ 00400000
*   /* BUILD THE RPLV TO READ THE GROUP EXTENSION RECORDS    @G24LB37*/ 00401000
*   /* BY READING DIRECT FOR UPDATE, SINCE ALL INFORMATION   @G24LB37*/ 00402000
*   /* IS LOCATED IN THE STEP TABLE DD ENTRY.                @G24LB37*/ 00403000
*   /*                                                               */ 00404000
*   /*****************************************************************/ 00405000
*                                                                  0106 00406000
*   RPLVKEY=ADDR(GROUPKEY);         /* ADDRESS OF GROUP KEY  @G24LB37*/ 00407000
         LA    @15,GROUPKEY                                        0106 00408000
         ST    @15,RPLVKEY(,RPLVPTR)                               0106 00409000
*   RPLVDIR=ON;                     /* READ DIRECT FLAG ON   @G24LB37*/ 00410000
         OI    RPLVDIR(RPLVPTR),B'01000000'                        0107 00411000
*   RPLVUPD=ON;                     /* READ FOR UPDATE ON    @G24LB37*/ 00412000
         OI    RPLVUPD(RPLVPTR),B'00000010'                        0108 00413000
*   RPLVTYP=RPLVREAD;               /* READ GROUP RECORD     @G24LB37*/ 00414000
         MVI   RPLVTYP(RPLVPTR),X'00'                              0109 00415000
*   RPLVBUF=GVSNEPTR;               /* ADDRESS OF GVSNE      @G24LB37*/ 00416000
         ST    GVSNEPTR,RPLVBUF(,RPLVPTR)                          0110 00417000
*   RPLVBLN=LENGTH(GVSNE);          /* LENGTH OF BUFFER      @G24LB37*/ 00418000
         MVC   RPLVBLN(4,RPLVPTR),@CF00279                         0111 00419000
*   RFY                                                            0112 00420000
*     REG1 RESTRICTED;              /*                       @G24LB37*/ 00421000
*   REG1=RPLVPTR;                   /*                       @G24LB37*/ 00422000
         LR    REG1,RPLVPTR                                        0113 00423000
*   CALL ICBVIO00;                  /* READ GROUP EXT REC    @G24LB37*/ 00424000
         L     @15,@CV00219                                        0114 00425000
         BALR  @14,@15                                             0114 00426000
*   RFY                                                            0115 00427000
*     REG1 UNRESTRICTED;            /*                       @G24LB37*/ 00428000
*                                                                  0116 00429000
*   /*****************************************************************/ 00430000
*   /*                                                               */ 00431000
*   /* ICBVIO00 WILL ISSUE MESSAGES TO THE SPACE MANAGER     @G24LB37*/ 00432000
*   /* SHOULD AN I/O ERROR OCCUR. IF THE RETURN CODE IS      @G24LB37*/ 00433000
*   /* NOT A ZERO THEN SET RETURN CODE TO FOUR. IF THE       @G24LB37*/ 00434000
*   /* RETURN CODE IS ZERO SET THE RETURN CODE TO ZERO.      @G24LB37*/ 00435000
*   /*                                                               */ 00436000
*   /*****************************************************************/ 00437000
*                                                                  0116 00438000
*   IF RPLVRETC^=ZERO THEN                                         0116 00439000
         LH    @15,RPLVRETC(,RPLVPTR)                              0116 00440000
         N     @15,@CF00286                                        0116 00441000
         LTR   @15,@15                                             0116 00442000
         BZ    @RF00116                                            0116 00443000
*     RETCODE=FOUR;                 /*                       @G24LB37*/ 00444000
         LA    RETCODE,4                                           0117 00445000
*   ELSE                                                           0118 00446000
*     RETCODE=ZERO;                 /*                       @G24LB37*/ 00447000
*                                                                  0118 00448000
         B     @RC00116                                            0118 00449000
@RF00116 SLR   RETCODE,RETCODE                                     0118 00450000
*   /*****************************************************************/ 00451000
*   /*                                                               */ 00452000
*   /* RETURN TO CALLER, RETURN CODE IS SET IN RETCODE AREA. @G24LB37*/ 00453000
*   /*                                                               */ 00454000
*   /*****************************************************************/ 00455000
*                                                                  0119 00456000
*   RETURN;                         /* RET TO PROCEXT PROC   @G24LB37*/ 00457000
@EL00003 DS    0H                                                  0119 00458000
@EF00003 DS    0H                                                  0119 00459000
@ER00003 L     @14,@SA00003                                        0119 00460000
         BR    @14                                                 0119 00461000
*   END READEXT;                    /* END OF READEXT PROC   @G24LB37*/ 00462000
         B     @EL00003                                            0120 00463000
*                                                                  0121 00464000
*/********************************************************************/ 00465000
*/*                                                                  */ 00466000
*/*     PROCEDURE NAME - SPACEUPT                            @G24LB37*/ 00467000
*/*                                                          @G24LB37*/ 00468000
*/*     FUNCTION - THIS PROCEDURE CALCULATES THE NUMBER OF   @G24LB37*/ 00469000
*/*                CYLINDERS TO BE ADDED BACK IN THE RUNNING @G24LB37*/ 00470000
*/*                FREE SPACE FIELD (WHICH IS APPROXIMATE    @G24LB37*/ 00471000
*/*                FREE SPACE ON THE VOLUME) IN THE GROUP    @G24LB37*/ 00472000
*/*                EXTENSION RECORD, AND RETURNS TO THE      @G24LB37*/ 00473000
*/*                PROCEXT PROCEDURE.                        @G24LB37*/ 00474000
*/*                                                          @G24LB37*/ 00475000
*/*     INPUT - THE POINTER TO THE STEP TABLE DD ENTRY TO    @G24LB37*/ 00476000
*/*             PROCESS, CONTAINING THE GROUP NAME, INDEX,   @G24LB37*/ 00477000
*/*             SLOT, AND VOLSER FIELDS.                     @G24LB37*/ 00478000
*/*                                                          @G24LB37*/ 00479000
*/*     OUTPUT -  THE GVSMTDSP FIELD UPDATED FOR THE GVSNE   @G24LB37*/ 00480000
*/*               SLOT INDEX FOUND IN THE STEP TABLE         @G24LB37*/ 00481000
*/*               REQUIRING AN UPDATE.  RETURN CODE IN       @G24LB37*/ 00482000
*/*               RETCODE AREA AS FOLLOWS:                   @G24LB37*/ 00483000
*/*               0 = SUCCESSFUL UPDATE OF GROUP EXT RECORD. @G24LB37*/ 00484000
*/*               4 = UNSUCCESSFUL UPDATE OF GROUP EXTENSION @G24LB37*/ 00485000
*/*                   RECORD.                                @G24LB37*/ 00486000
*/*                                                                  */ 00487000
*/********************************************************************/ 00488000
*                                                                  0121 00489000
*SPACEUPT:                                                         0121 00490000
*   PROCEDURE OPTIONS(SAVE(REG14)); /*                       @G24LB37*/ 00491000
SPACEUPT ST    @14,12(,@13)                                        0121 00492000
*                                                                  0122 00493000
*   /*****************************************************************/ 00494000
*   /*                                                               */ 00495000
*   /* INITIALIZE RETCODE AREA TO ZERO. IF THE VOLSER IN     @G24LB37*/ 00496000
*   /* THE GVSNE SLOT MATCHES THE ONE IN THE THE STEP TABLE, @G24LB37*/ 00497000
*   /* THEN PROCESS THE SLOT IN THE GVSNE.                   @G24LB37*/ 00498000
*   /*                                                               */ 00499000
*   /*****************************************************************/ 00500000
*                                                                  0122 00501000
*   RETCODE=ZERO;                   /*                       @G24LB37*/ 00502000
         SLR   RETCODE,RETCODE                                     0122 00503000
*   IF GVSVOLID(STPDDGPS)=STPDDVOL(ONE) THEN                       0123 00504000
         SLR   @03,@03                                             0123 00505000
         IC    @03,STPDDGPS(,VTMDDPTR)                             0123 00506000
         MH    @03,@CH00280                                        0123 00507000
         ST    @03,@TF00001                                        0123 00508000
         ALR   @03,GVSNEPTR                                        0123 00509000
         CLC   GVSVOLID-20(6,@03),STPDDVOL(VTMDDPTR)               0123 00510000
         BNE   @RF00123                                            0123 00511000
*     DO;                           /*                       @G24LB37*/ 00512000
*                                                                  0124 00513000
*       /*************************************************************/ 00514000
*       /*                                                           */ 00515000
*       /* THE FIELD STPDDPRM IN THE STEP TABLE DD ENTRY IS  @G24LB37*/ 00516000
*       /* ADDED TO THE GVSNE FIELD GVSMTDSP POINTED TO BY   @G24LB37*/ 00517000
*       /* THE SLOT INDEX PASSED BY THE PROCEXT PROCEDURE,   @G24LB37*/ 00518000
*       /* AND THAT VALUE IS INSERTED BACK INTO THE GVSMTDSP @G24LB37*/ 00519000
*       /* FIELD OF THE SAME SLOT.                           @G24LB37*/ 00520000
*       /*                                                           */ 00521000
*       /*************************************************************/ 00522000
*                                                                  0125 00523000
*       GVSMTDSP(STPDDGPS)=GVSMTDSP(STPDDGPS)+STPDDPRM;/*    @G24LB37*/ 00524000
*                                                                  0125 00525000
         L     @03,@TF00001                                        0125 00526000
         LH    @03,GVSMTDSP-20(@03,GVSNEPTR)                       0125 00527000
         AH    @03,STPDDPRM(,VTMDDPTR)                             0125 00528000
         L     @01,@TF00001                                        0125 00529000
         STH   @03,GVSMTDSP-20(@01,GVSNEPTR)                       0125 00530000
*       /*************************************************************/ 00531000
*       /*                                                           */ 00532000
*       /* BECAUSE OF THE APPROXIMATE AVAILABLE FREE SPACE   @G24LB37*/ 00533000
*       /* VALUE BEING AN APPROXIMATE VALUE, IT IS POSSIBLE  @G24LB37*/ 00534000
*       /* THAT THIS UPDATE MAY YIELD A VALUE GREATER THAN   @G24LB37*/ 00535000
*       /* 403 (MAXIMUM CYLINDERS), WHICH IS A PHYSICAL      @G24LB37*/ 00536000
*       /* IMPOSSIBILITY. IF THIS SITUATION EXISTS THE       @G24LB37*/ 00537000
*       /* VALUE IS SET TO 403, WHICH WILL INDICATE THE      @G24LB37*/ 00538000
*       /* ENTIRE VOLUME CAN BE USED.                        @G24LB37*/ 00539000
*       /*                                                           */ 00540000
*       /*************************************************************/ 00541000
*                                                                  0126 00542000
*       IF GVSMTDSP(STPDDGPS)>MAXCYLIN THEN                        0126 00543000
         LA    @15,403                                             0126 00544000
         CR    @03,@15                                             0126 00545000
         BNH   @RF00126                                            0126 00546000
*         GVSMTDSP(STPDDGPS)=MAXCYLIN;/*                     @G24LB37*/ 00547000
*                                                                  0127 00548000
         L     @03,@TF00001                                        0127 00549000
         STH   @15,GVSMTDSP-20(@03,GVSNEPTR)                       0127 00550000
*       /*************************************************************/ 00551000
*       /*                                                           */ 00552000
*       /* THE LSPACE VALUE IN THE GVSNE IS CHECKED TO MAKE  @G24LB37*/ 00553000
*       /* SURE THE SPACE ADDED BACK IS NOT GREATER THAN THE @G24LB37*/ 00554000
*       /* VALUE IN THE FIELD GVSFRESP.                      @G24LB37*/ 00555000
*       /*                                                           */ 00556000
*       /*************************************************************/ 00557000
*                                                                  0128 00558000
*       IF GVSMTDSP(STPDDGPS)>GVSFRESP(STPDDGPS) THEN              0128 00559000
@RF00126 SLR   @03,@03                                             0128 00560000
         IC    @03,STPDDGPS(,VTMDDPTR)                             0128 00561000
         MH    @03,@CH00280                                        0128 00562000
         LH    @15,GVSFRESP-20(@03,GVSNEPTR)                       0128 00563000
         CH    @15,GVSMTDSP-20(@03,GVSNEPTR)                       0128 00564000
         BNL   @RF00128                                            0128 00565000
*         GVSMTDSP(STPDDGPS)=GVSFRESP(STPDDGPS);/*           @G24LB37*/ 00566000
         STH   @15,GVSMTDSP-20(@03,GVSNEPTR)                       0129 00567000
*     END;                          /*                       @G24LB37*/ 00568000
*                                                                  0131 00569000
*   /*****************************************************************/ 00570000
*   /*                                                               */ 00571000
*   /* IF THE VOLSER DOES NOT MATCH THEN SET RETURN CODE TO  @G24LB37*/ 00572000
*   /* FOUR AND DO NOT UPDATE THE SPACE FIELD.               @G24LB37*/ 00573000
*   /*                                                               */ 00574000
*   /*****************************************************************/ 00575000
*                                                                  0131 00576000
*   ELSE                                                           0131 00577000
*     RETCODE=FOUR;                 /*                       @G24LB37*/ 00578000
*                                                                  0131 00579000
         B     @RC00123                                            0131 00580000
@RF00123 LA    RETCODE,4                                           0131 00581000
*   /*****************************************************************/ 00582000
*   /*                                                               */ 00583000
*   /* RETURN TO CALLER, RETURN CODE IS SET IN RETCODE AREA. @G24LB37*/ 00584000
*   /*                                                               */ 00585000
*   /*****************************************************************/ 00586000
*                                                                  0132 00587000
*   RETURN;                         /* RET TO PROCEXT PROC   @G24LB37*/ 00588000
@EL00004 DS    0H                                                  0132 00589000
@EF00004 DS    0H                                                  0132 00590000
@ER00004 L     @14,12(,@13)                                        0132 00591000
         BR    @14                                                 0132 00592000
*   END SPACEUPT;                   /* END OF SPACEUPT PROC  @G24LB37*/ 00593000
         B     @EL00004                                            0133 00594000
*                                                                  0134 00595000
*/********************************************************************/ 00596000
*/*                                                                  */ 00597000
*/*     PROCEDURE NAME - WRITEXT                             @G24LB37*/ 00598000
*/*                                                          @G24LB37*/ 00599000
*/*     FUNCTION - THIS PROCEDURE CALLS ICBVIO00 TO WRITE    @G24LB37*/ 00600000
*/*                THE UPDATED GROUP EXTENSION RECORD, AND   @G24LB37*/ 00601000
*/*                RETURNS TO THE PROCEXT PROCEDURE.         @G24LB37*/ 00602000
*/*                                                          @G24LB37*/ 00603000
*/*     INPUT - THE POINTER TO THE RPLV CONTAINING THE       @G24LB37*/ 00604000
*/*             GROUP NAME AND GROUP INDEX FIELDS.           @G24LB37*/ 00605000
*/*                                                          @G24LB37*/ 00606000
*/*     OUTPUT -  THE GVSNE REQUIRING AN UPDATE IS WRITTEN   @G24LB37*/ 00607000
*/*               TO THE MSVI DATA SET.  RETURN CODE IN      @G24LB37*/ 00608000
*/*               RETCODE AREA AS FOLLOWS:                   @G24LB37*/ 00609000
*/*               0 = SUCCESSFUL WRITE OF GROUP EXT RECORD.  @G24LB37*/ 00610000
*/*                                                                  */ 00611000
*/********************************************************************/ 00612000
*                                                                  0134 00613000
*WRITEXT:                                                          0134 00614000
*   PROCEDURE OPTIONS(SAVE(REG14)); /*                       @G24LB37*/ 00615000
WRITEXT  ST    @14,@SA00005                                        0134 00616000
*                                                                  0135 00617000
*   /*****************************************************************/ 00618000
*   /*                                                               */ 00619000
*   /* BUILD THE RPLV TO WRITE THE GROUP EXTENSION RECORD    @G24LB37*/ 00620000
*   /* BY WRITING DIRECT FOR UPDATE, USING THE RPLV THAT WAS @G24LB37*/ 00621000
*   /* USED FOR THE READ GROUP EXTENSION RECORD.             @G24LB37*/ 00622000
*   /*                                                               */ 00623000
*   /*****************************************************************/ 00624000
*                                                                  0135 00625000
*   RPLVTYP=RPLVPUT;                /* WRITE GROUP RECORD    @G24LB37*/ 00626000
         MVI   RPLVTYP(RPLVPTR),X'01'                              0135 00627000
*   RFY                                                            0136 00628000
*     REG1 RESTRICTED;              /*                       @G24LB37*/ 00629000
*   REG1=RPLVPTR;                   /*                       @G24LB37*/ 00630000
         LR    REG1,RPLVPTR                                        0137 00631000
*   CALL ICBVIO00;                  /* WRITE GROUP EXT REC   @G24LB37*/ 00632000
         L     @15,@CV00219                                        0138 00633000
         BALR  @14,@15                                             0138 00634000
*   RFY                                                            0139 00635000
*     REG1 UNRESTRICTED;            /*                       @G24LB37*/ 00636000
*                                                                  0139 00637000
*   /*****************************************************************/ 00638000
*   /*                                                               */ 00639000
*   /* ICBVIO00 WILL ISSUE MESSAGES TO THE SPACE MANAGER     @G24LB37*/ 00640000
*   /* SHOULD AN I/O ERROR OCCUR. SET THE RETURN CODE TO     @G24LB37*/ 00641000
*   /* ZERO.                                                 @G24LB37*/ 00642000
*   /*                                                               */ 00643000
*   /*****************************************************************/ 00644000
*                                                                  0140 00645000
*   RETCODE=ZERO;                   /*                       @G24LB37*/ 00646000
*                                                                  0140 00647000
         SLR   RETCODE,RETCODE                                     0140 00648000
*   /*****************************************************************/ 00649000
*   /*                                                               */ 00650000
*   /* RETURN TO CALLER, RETURN CODE IS SET IN RETCODE AREA. @G24LB37*/ 00651000
*   /*                                                               */ 00652000
*   /*****************************************************************/ 00653000
*                                                                  0141 00654000
*   RETURN;                         /* RET TO PROCEXT PROC   @G24LB37*/ 00655000
@EL00005 DS    0H                                                  0141 00656000
@EF00005 DS    0H                                                  0141 00657000
@ER00005 L     @14,@SA00005                                        0141 00658000
         BR    @14                                                 0141 00659000
*   END WRITEXT;                    /* END OF WRITEXT PROC   @G24LB37*/ 00660000
*   END ICBVTM00                    /* END OF ICBVTM00       @G24LB37*/ 00661000
*                                                                  0143 00662000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 00663000
*/*%INCLUDE SYSLIB  (IEZRPLV )                                       */ 00664000
*/*%INCLUDE SYSLIB  (IEZVVICB)                                       */ 00665000
*/*%INCLUDE SYSLIB  (IEZGVSNE)                                       */ 00666000
*/*%INCLUDE SYSLIB  (IEZSTPTB)                                       */ 00667000
*                                                                  0143 00668000
*       ;                                                          0143 00669000
@DATA    DS    0H                                                       00670000
@CH00280 DC    H'20'                                                    00671000
         DS    0F                                                       00672000
@SA00001 DS    18F                                                      00673000
@SA00002 DS    1F                                                       00674000
@SA00003 DS    0F                                                       00675000
@SA00005 DS    0F                                                       00676000
         DS    1F                                                       00677000
@TF00001 DS    F                                                        00678000
         DS    0F                                                       00679000
@CF00279 DC    F'988'                                                   00680000
@CF00286 DC    XL4'0000FFFF'                                            00681000
@CV00219 DC    V(ICBVIO00)                                              00682000
@CV00220 DC    V(ICBVRR00)                                              00683000
         DS    0D                                                       00684000
NULLAREA DC    X'0000000000000000'                                      00685000
VTM00SWS DS    CL2                                                      00686000
         ORG   VTM00SWS                                                 00687000
FOUNDSW  DS    BL1                                                      00688000
@NM00016 EQU   VTM00SWS+0                                               00689000
         ORG   VTM00SWS+2                                               00690000
VTM00FGS DS    CL2                                                      00691000
         ORG   VTM00FGS                                                 00692000
RESERVEF DS    BL1                                                      00693000
RECUPDTF EQU   VTM00FGS+0                                               00694000
@NM00017 EQU   VTM00FGS+0                                               00695000
         ORG   VTM00FGS+2                                               00696000
SAVEAGRP DS    CL12                                                     00697000
         ORG   SAVEAGRP                                                 00698000
SAVEGRPN DS    CL8                                                      00699000
SAVEINDX DS    FL1                                                      00700000
@NM00018 DS    CL3                                                      00701000
         ORG   SAVEAGRP+12                                              00702000
GROUPKEY DS    CL13                                                     00703000
         ORG   GROUPKEY                                                 00704000
GROUPG   DC    CL3'G  '                                                 00705000
GROUPNAM DS    CL8                                                      00706000
GROUPBLK DC    CL1' '                                                   00707000
GROUPIND DS    FL1                                                      00708000
         ORG   GROUPKEY+13                                              00709000
         DS    CL3                                                      00710000
GVSNEBUF DS    CL988                                                    00711000
FIXAREA  DS    CL100                                                    00712000
         ORG   FIXAREA                                                  00713000
@NM00021 DC    100X'00'                                                 00714000
         ORG   FIXAREA+100                                              00715000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00716000
@01      EQU   01                                                       00717000
@02      EQU   02                                                       00718000
@03      EQU   03                                                       00719000
@04      EQU   04                                                       00720000
@05      EQU   05                                                       00721000
@06      EQU   06                                                       00722000
@07      EQU   07                                                       00723000
@08      EQU   08                                                       00724000
@09      EQU   09                                                       00725000
@10      EQU   10                                                       00726000
@11      EQU   11                                                       00727000
@12      EQU   12                                                       00728000
@13      EQU   13                                                       00729000
@14      EQU   14                                                       00730000
@15      EQU   15                                                       00731000
RETCODE  EQU   @02                                                      00732000
VTMDDPTR EQU   @04                                                      00733000
VTMTBPTR EQU   @07                                                      00734000
TRMRBPTR EQU   @02                                                      00735000
GVSNEPTR EQU   @06                                                      00736000
VVIPTR   EQU   @04                                                      00737000
RPLVPTR  EQU   @05                                                      00738000
REG0     EQU   @00                                                      00739000
REG1     EQU   @01                                                      00740000
REG14    EQU   @14                                                      00741000
RPLV     EQU   0                                                        00742000
RPLTCBPR EQU   RPLV+8                                                   00743000
RPLVVICB EQU   RPLV+12                                                  00744000
RPLFLAGA EQU   RPLV+28                                                  00745000
RPLVRETC EQU   RPLV+34                                                  00746000
RPLVSAM  EQU   RPLV+56                                                  00747000
RPLVTYP  EQU   RPLVSAM+2                                                00748000
RPLVBUF  EQU   RPLVSAM+32                                               00749000
RPLVKEY  EQU   RPLVSAM+36                                               00750000
RPLVOPT  EQU   RPLVSAM+40                                               00751000
RPLVDIR  EQU   RPLVOPT                                                  00752000
RPLVUPD  EQU   RPLVOPT+1                                                00753000
RPLVBLN  EQU   RPLVSAM+52                                               00754000
RPLVUTIL EQU   RPLV+132                                                 00755000
VVICB    EQU   0                                                        00756000
VVIFLGA  EQU   VVICB+15                                                 00757000
VVIFLG0  EQU   VVIFLGA                                                  00758000
GVSNE    EQU   0                                                        00759000
GVSHDR   EQU   GVSNE                                                    00760000
GVSNAME  EQU   GVSHDR                                                   00761000
GVSID    EQU   GVSNAME+11                                               00762000
GVSFLAGA EQU   GVSHDR+13                                                00763000
GVSTYPE  EQU   GVSFLAGA                                                 00764000
GVSSLOTS EQU   GVSNE+28                                                 00765000
GVSVOLID EQU   GVSSLOTS                                                 00766000
GVSVOLFL EQU   GVSSLOTS+6                                               00767000
GVSFRESP EQU   GVSSLOTS+10                                              00768000
GVSMTDSP EQU   GVSSLOTS+18                                              00769000
STPTB    EQU   0                                                        00770000
STPFLAGS EQU   STPTB+14                                                 00771000
STPNOFRE EQU   STPFLAGS                                                 00772000
STPDDPTR EQU   STPTB+16                                                 00773000
STPDDENT EQU   0                                                        00774000
STPDDNXT EQU   STPDDENT                                                 00775000
STPDDGPN EQU   STPDDENT+12                                              00776000
STPDDGPI EQU   STPDDENT+20                                              00777000
STPDDGPS EQU   STPDDENT+21                                              00778000
STPDDPRM EQU   STPDDENT+22                                              00779000
STPDDFLG EQU   STPDDENT+24                                              00780000
STPDDVOL EQU   STPDDENT+26                                              00781000
TRMRB    EQU   0                                                        00782000
TRMFLAGS EQU   TRMRB+5                                                  00783000
TRMSTHDR EQU   TRMRB+12                                                 00784000
*                                      START UNREFERENCED COMPONENTS    00785000
TRMJOBID EQU   TRMRB+8                                                  00786000
@NM00020 EQU   TRMRB+6                                                  00787000
@NM00019 EQU   TRMFLAGS                                                 00788000
TRMSCHAB EQU   TRMFLAGS                                                 00789000
TRMALLOK EQU   TRMFLAGS                                                 00790000
TRMRBOPC EQU   TRMRB+4                                                  00791000
TRMRBLEN EQU   TRMRB                                                    00792000
STPDDNVL EQU   STPDDENT+25                                              00793000
@NM00015 EQU   STPDDFLG                                                 00794000
STPDDSPL EQU   STPDDFLG                                                 00795000
STPDDEXC EQU   STPDDFLG                                                 00796000
STPDDDVT EQU   STPDDENT+8                                               00797000
STPDDNUM EQU   STPDDENT+6                                               00798000
STPDDLEN EQU   STPDDENT+4                                               00799000
STPICCTR EQU   STPTB+15                                                 00800000
@NM00014 EQU   STPFLAGS                                                 00801000
STPINVAL EQU   STPFLAGS                                                 00802000
STPHDRLN EQU   STPTB+12                                                 00803000
STPJOBID EQU   STPTB+8                                                  00804000
STPPRVTB EQU   STPTB+4                                                  00805000
STPNXTTB EQU   STPTB                                                    00806000
GVSEXPDT EQU   GVSSLOTS+14                                              00807000
GVSLEXT  EQU   GVSSLOTS+12                                              00808000
@NM00013 EQU   GVSVOLFL+2                                               00809000
GVSMTNSH EQU   GVSVOLFL+2                                               00810000
GVSRCFSI EQU   GVSVOLFL+2                                               00811000
GVSCPUBM EQU   GVSVOLFL                                                 00812000
@NM00012 EQU   GVSHDR+20                                                00813000
GVSESIND EQU   GVSHDR+18                                                00814000
@NM00011 EQU   GVSHDR+17                                                00815000
@NM00010 EQU   GVSFLAGA+2                                               00816000
GVSEX    EQU   GVSFLAGA+2                                               00817000
@NM00009 EQU   GVSTYPE                                                  00818000
GVSGVSEX EQU   GVSTYPE                                                  00819000
@NM00008 EQU   GVSTYPE                                                  00820000
GVSNO    EQU   GVSID+1                                                  00821000
GVSRES1  EQU   GVSID                                                    00822000
GVSVVGRP EQU   GVSNAME+3                                                00823000
GVSG     EQU   GVSNAME                                                  00824000
VVIUNUSD EQU   VVICB+116                                                00825000
VVINUSDC EQU   VVICB+112                                                00826000
VVITPFCH EQU   VVICB+108                                                00827000
VVIDVMEL EQU   VVICB+104                                                00828000
VVIVBSTF EQU   VVICB+100                                                00829000
VVISSOBA EQU   VVICB+96                                                 00830000
VVIVSCRA EQU   VVICB+92                                                 00831000
VVISTPTB EQU   VVICB+88                                                 00832000
VVIDVMTA EQU   VVICB+84                                                 00833000
VVIJUCB  EQU   VVICB+80                                                 00834000
VVIIUCB  EQU   VVICB+76                                                 00835000
VVIRES6  EQU   VVICB+72                                                 00836000
VVIRES5  EQU   VVICB+68                                                 00837000
VVIRES4  EQU   VVICB+64                                                 00838000
VVIUCB   EQU   VVICB+60                                                 00839000
VVIVJL   EQU   VVICB+56                                                 00840000
VVIVRR   EQU   VVICB+52                                                 00841000
VVIQLSPL EQU   VVICB+48                                                 00842000
VVIQRPL2 EQU   VVICB+44                                                 00843000
VVIQRPL1 EQU   VVICB+40                                                 00844000
VVIRES3  EQU   VVICB+36                                                 00845000
VVIVQMP  EQU   VVICB+32                                                 00846000
VVIECB1  EQU   VVICB+28                                                 00847000
VVICATAD EQU   VVICB+24                                                 00848000
VVIDCBAD EQU   VVICB+20                                                 00849000
VVIACBAD EQU   VVICB+16                                                 00850000
VVIFLG7  EQU   VVIFLGA                                                  00851000
VVIFLG6  EQU   VVIFLGA                                                  00852000
VVIFLG5  EQU   VVIFLGA                                                  00853000
VVIFLG4  EQU   VVIFLGA                                                  00854000
VVIFLG3  EQU   VVIFLGA                                                  00855000
VVIFLG2  EQU   VVIFLGA                                                  00856000
VVIFLG1  EQU   VVIFLGA                                                  00857000
VVIALCON EQU   VVICB+14                                                 00858000
VVICPUID EQU   VVICB+12                                                 00859000
VVIUCAT  EQU   VVICB+4                                                  00860000
VVICID   EQU   VVICB                                                    00861000
RPLVRLN  EQU   RPLVSAM+48                                               00862000
@NM00007 EQU   RPLVSAM+44                                               00863000
@NM00006 EQU   RPLVOPT                                                  00864000
RPLVKGE  EQU   RPLVOPT                                                  00865000
@NM00005 EQU   RPLVOPT                                                  00866000
RPLVNEXT EQU   RPLVOPT                                                  00867000
RPLVLOC  EQU   RPLVOPT                                                  00868000
@NM00004 EQU   RPLVSAM+28                                               00869000
RPLVACB  EQU   RPLVSAM+24                                               00870000
@NM00003 EQU   RPLVSAM+3                                                00871000
@NM00002 EQU   RPLVSAM                                                  00872000
@NM00001 EQU   RPLV+38                                                  00873000
RPLRMSCC EQU   RPLV+36                                                  00874000
RPLRCODE EQU   RPLV+32                                                  00875000
RPLVTLEN EQU   RPLV+30                                                  00876000
RPLVRES1 EQU   RPLFLAGA+1                                               00877000
RPLVJRNL EQU   RPLFLAGA                                                 00878000
RPLJRCVY EQU   RPLFLAGA                                                 00879000
RPLVVOP  EQU   RPLFLAGA                                                 00880000
RPLVVIN  EQU   RPLFLAGA                                                 00881000
RPLVCOMP EQU   RPLFLAGA                                                 00882000
RPLVPROG EQU   RPLFLAGA                                                 00883000
RPLVPOST EQU   RPLFLAGA                                                 00884000
RPLFTIME EQU   RPLFLAGA                                                 00885000
RPLVRSV3 EQU   RPLV+24                                                  00886000
RPLVRSV2 EQU   RPLV+20                                                  00887000
RPLVRSV1 EQU   RPLV+16                                                  00888000
RPLASCBP EQU   RPLTCBPR                                                 00889000
RPLVECB  EQU   RPLV+4                                                   00890000
RPLVQPTR EQU   RPLV                                                     00891000
*                                      END UNREFERENCED COMPONENTS      00892000
@RC00082 EQU   @RC00079                                                 00893000
@RF00090 EQU   @EL00002                                                 00894000
@RC00116 EQU   @EL00003                                                 00895000
@RC00123 EQU   @EL00004                                                 00896000
@RF00128 EQU   @RC00123                                                 00897000
@ENDDATA EQU   *                                                        00898000
         END   ICBVTM00,(C'PLS0545',0603,76275)                         00899000
