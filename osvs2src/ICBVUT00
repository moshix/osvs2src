         TITLE 'ICBVUT00 - DEFV, MCRT, COVC PROCESSOR (OCT 9, 1974) MVS*00001000
               S        '                                               00002000
ICBVUT00 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL2(@EP00001-@MAINENT)                                   00007000
         DC    AL1(16)                                             0001 00008000
         DC    C'ICBVUT00  78.157'                                 0001 00009000
ICBVUCHI DS    0H                                                  0001 00010000
         USING *,@15                                               0001 00011000
         B     @PROLOG                                             0001 00012000
         DC    AL2(@EP02562-ICBVUCHI)                                   00013000
         ENTRY ICBVUCHI                                                 00014000
ICBVUCHO DS    0H                                                  0001 00015000
         USING *,@15                                               0001 00016000
         B     @PROLOG                                             0001 00017000
         DC    AL2(@EP02779-ICBVUCHO)                                   00018000
         ENTRY ICBVUCHO                                                 00019000
ICBVUPGH DS    0H                                                  0001 00020000
         USING *,@15                                               0001 00021000
         B     @PROLOG                                             0001 00022000
         DC    AL2(@EP02929-ICBVUPGH)                                   00023000
         ENTRY ICBVUPGH                                                 00024000
         DROP  @15                                                      00025000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00026000
         BALR  @12,0                                               0001 00027000
@PSTART  LA    @11,4095(,@12)                                      0001 00028000
         LA    @10,4095(,@11)                                      0001 00029000
         LA    @09,4095(,@10)                                      0001 00030000
         LA    @08,4095(,@09)                                      0001 00031000
         LA    @07,4095(,@08)                                      0001 00032000
         USING @PSTART,@12                                         0001 00033000
         USING @PSTART+4095,@11                                    0001 00034000
         USING @PSTART+8190,@10                                    0001 00035000
         USING @PSTART+12285,@09                                   0001 00036000
         USING @PSTART+16380,@08                                   0001 00037000
         USING @PSTART+20475,@07                                   0001 00038000
         ST    @13,@SA00001+4                                      0001 00039000
         LA    @14,@SA00001                                        0001 00040000
         ST    @14,8(,@13)                                         0001 00041000
         LR    @13,@14                                             0001 00042000
         AH    @15,4(,@15)                                         0001 00043000
         BR    @15                                                 0001 00044000
@EP00001 DS    0H                                                  0002 00045000
*   RPLVPTR=RG1;                    /* ADDR TO REQUEST BLK   @Y30LB25*/ 00046000
         ST    RG1,RPLVPTR                                         0141 00047000
*   RESPECIFY                                                      0142 00048000
*     RG1 UNRSTD;                   /* FREE REG1             @Y30LB25*/ 00049000
*   VVIPTR=RPLVVICB;                /* ADDR TO MSVCB         @Y30LB25*/ 00050000
         L     @03,RPLVPTR                                         0143 00051000
         L     @15,RPLVVICB(,@03)                                  0143 00052000
         ST    @15,VVIPTR                                          0143 00053000
*   MCRTPTR=ADDR(RPLVUTIL);         /* ADDR TO ICBMCRT       @Y30LB25*/ 00054000
         LA    @14,RPLVUTIL(,@03)                                  0144 00055000
         LR    MCRTPTR,@14                                         0144 00056000
*   DEFVPTR=ADDR(RPLVUTIL);         /* ADDR TO ICBDEFV       @Y30LB25*/ 00057000
         LR    DEFVPTR,@14                                         0145 00058000
*   CVOLPTR=ADDR(RPLVUTIL);         /* ADDR TO ICBCOVC       @Y30LB25*/ 00059000
         ST    @14,CVOLPTR                                         0146 00060000
*   MCRTEPTR=MCRTPTR+MCRTLEN;       /* ADDR TO ICBMCRTE      @Y30LB25*/ 00061000
         LR    @01,MCRTPTR                                         0147 00062000
         AL    @01,MCRTLEN(,MCRTPTR)                               0147 00063000
         ST    @01,MCRTEPTR                                        0147 00064000
*   DEFVEPTR=DEFVPTR+DEFVLEN;       /* ADDR TO ICBDEFVE      @Y30LB25*/ 00065000
         LR    DEFVEPTR,DEFVPTR                                    0148 00066000
         AL    DEFVEPTR,DEFVLEN(,DEFVPTR)                          0148 00067000
*   COVCEPTR=CVOLPTR+CVOLLEN;       /* ADDR TO ICBCOVCE      @Y30LB25*/ 00068000
         LR    @01,@14                                             0149 00069000
         AL    @01,CVOLLEN(,@14)                                   0149 00070000
         ST    @01,COVCEPTR                                        0149 00071000
*   GROUPPTR=ADDR(GROUPBUF);        /* ADDR GRP BUF          @Y30LB25*/ 00072000
         LA    @14,GROUPBUF                                        0150 00073000
         ST    @14,GROUPPTR                                        0150 00074000
*   NGVRPTR=ADDR(NGVRBUF);          /* ADDR NON-GRP BUF      @Y30LB25*/ 00075000
         LA    NGVRPTR,NGVRBUF                                     0151 00076000
*   COPYVPTR=ADDR(COPYBUF);         /* ADDR CVR BUF          @Y30LB25*/ 00077000
         LA    @14,COPYBUF                                         0152 00078000
         ST    @14,COPYVPTR                                        0152 00079000
*   BASEVPTR=ADDR(BASEBUF);         /* ADDR BVR BUF          @Y30LB25*/ 00080000
         LA    @14,BASEBUF                                         0153 00081000
         ST    @14,BASEVPTR                                        0153 00082000
*   INDEXPTR=ADDR(INDEXBUF);        /* ADDR CIR BUF          @Y30LB25*/ 00083000
         LA    @14,INDEXBUF                                        0154 00084000
         ST    @14,INDEXPTR                                        0154 00085000
*   DUPVPTR=ADDR(DUPVBUF);          /* ADDR DUP BUF          @Y30LB25*/ 00086000
         LA    @14,DUPVBUF                                         0155 00087000
         ST    @14,DUPVPTR                                         0155 00088000
*   WORKAREA=WORKAREA&&WORKAREA;    /* ZERO WORK AREA        @Y30LB25*/ 00089000
         XC    WORKAREA(23),WORKAREA                               0156 00090000
*   CIDKY=FIXONE;                   /* CVR ID TO 1           @Y30LB25*/ 00091000
         MVI   CIDKY,X'01'                                         0157 00092000
*   DIDKY=FIXONE;                   /* DVR ID TO 1           @Y30LB25*/ 00093000
         MVI   DIDKY,X'01'                                         0158 00094000
*                                                                  0159 00095000
*   /*****************************************************************/ 00096000
*   /*                                                               */ 00097000
*   /* CHECK FOR MSVC DISABLED                               @Y30LB25*/ 00098000
*   /*                                                               */ 00099000
*   /*****************************************************************/ 00100000
*                                                                  0159 00101000
*   IF VVIFLG0=ON                   /* DISABLED?             @Y30LB25*/ 00102000
*     THEN                          /* YES                   @Y30LB25*/ 00103000
         TM    VVIFLG0(@15),B'10000000'                            0159 00104000
         BNO   @RF00159                                            0159 00105000
*     DO;                           /*                       @Y30LB25*/ 00106000
*       RPLVRETC=FIXFOUR;           /* ERROR RETURN CODE     @Y30LB25*/ 00107000
         MVC   RPLVRETC(2,@03),@CH00041                            0161 00108000
*       RPLRCODE=DISABLED;          /* REASON CODE           @Y30LB25*/ 00109000
         MVC   RPLRCODE(2,@03),@CB00723                            0162 00110000
*       RETURN;                     /*                       @Y30LB25*/ 00111000
@EL00001 L     @13,4(,@13)                                         0163 00112000
@EF00001 DS    0H                                                  0163 00113000
@ER00001 LM    @14,@12,12(@13)                                     0163 00114000
         BR    @14                                                 0163 00115000
*     END;                          /*                       @Y30LB25*/ 00116000
*                                                                  0165 00117000
*   /*****************************************************************/ 00118000
*   /*                                                               */ 00119000
*   /* CHECK FOR BEFORE OR AFTER MSC CALL AND DETERMINE      @Y30LB25*/ 00120000
*   /* THE CORRECT MSVC FUNCTION TO PERFORM.                 @Y30LB25*/ 00121000
*   /*                                                               */ 00122000
*   /*****************************************************************/ 00123000
*                                                                  0165 00124000
*   IF RPLFTIME=OFF                 /* BEFORE MSC CALL?      @Y30LB25*/ 00125000
*     THEN                          /* YES                   @Y30LB25*/ 00126000
@RF00159 L     @01,RPLVPTR                                         0165 00127000
         TM    RPLFTIME(@01),B'10000000'                           0165 00128000
         BNZ   @RF00165                                            0165 00129000
*     DO;                           /*                       @Y30LB25*/ 00130000
*       CALL BEFRMSC;               /* PROCESS BEFORE MSC    @Y30LB25*/ 00131000
         BAL   @14,BEFRMSC                                         0167 00132000
*       RETURN;                     /*                       @Y30LB25*/ 00133000
         B     @EL00001                                            0168 00134000
*     END;                          /*                       @Y30LB25*/ 00135000
*   ELSE                            /* PROCESS AFTER MSC     @Y30LB25*/ 00136000
*     DO;                           /*                       @Y30LB25*/ 00137000
@RF00165 DS    0H                                                  0171 00138000
*       CALL AFTRMSC;               /*                       @Y30LB25*/ 00139000
         BAL   @14,AFTRMSC                                         0171 00140000
*       RETURN;                     /*                       @Y30LB25*/ 00141000
         B     @EL00001                                            0172 00142000
*     END;                          /*                       @Y30LB25*/ 00143000
*                                                                  0174 00144000
*   /*****************************************************************/ 00145000
*   /*                                                               */ 00146000
*   /* PROCEDURE NAME - BEFRMSC                              @Y30LB25*/ 00147000
*   /*                                                       @Y30LB25*/ 00148000
*   /* FUNCTION - PROCESS MSVC BEFORE THE CALL TO THE MSC.   @Y30LB25*/ 00149000
*   /*                                                       @Y30LB25*/ 00150000
*   /* INPUT -                                               @Y30LB25*/ 00151000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 00152000
*   /*                                                       @Y30LB25*/ 00153000
*   /* OUTPUT -                                              @Y30LB25*/ 00154000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 00155000
*   /* AN ERROR                                              @Y30LB25*/ 00156000
*   /*                                                               */ 00157000
*   /*****************************************************************/ 00158000
*                                                                  0174 00159000
*BEFRMSC:                           /*                       @Y30LB25*/ 00160000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 00161000
*                                                                  0174 00162000
BEFRMSC  ST    @14,@SA00002                                        0174 00163000
*   /*****************************************************************/ 00164000
*   /*                                                               */ 00165000
*   /* CHECK FOR .MSVIJRNL DISABLED AND RECOVERY PROCESSING  @Y30LB25*/ 00166000
*   /*                                                               */ 00167000
*   /*****************************************************************/ 00168000
*                                                                  0175 00169000
*   IF VVIFLG2=ON&RPLJRCVY=OFF      /* JRNL DISABLED & NO    @Y30LB25   00170000
*                                      RECOVERY PROC?        @Y30LB25*/ 00171000
*     THEN                          /* YES                   @Y30LB25*/ 00172000
         L     @01,VVIPTR                                          0175 00173000
         TM    VVIFLG2(@01),B'00100000'                            0175 00174000
         BNO   @RF00175                                            0175 00175000
         L     @15,RPLVPTR                                         0175 00176000
         TM    RPLJRCVY(@15),B'00000010'                           0175 00177000
         BNZ   @RF00175                                            0175 00178000
*     DO;                           /*                       @Y30LB25*/ 00179000
*       RPLVRETC=FIXFOUR;           /* ERROR RETN CODE       @Y30LB25*/ 00180000
         MVC   RPLVRETC(2,@15),@CH00041                            0177 00181000
*       RPLRCODE=JRNLDISB;          /* JRNL DISABLED         @Y30LB25*/ 00182000
         MVC   RPLRCODE(2,@15),@CB00725                            0178 00183000
*       RETURN;                     /*                       @Y30LB25*/ 00184000
@EL00002 DS    0H                                                  0179 00185000
@EF00002 DS    0H                                                  0179 00186000
@ER00002 L     @14,@SA00002                                        0179 00187000
         BR    @14                                                 0179 00188000
*     END;                          /*                       @Y30LB25*/ 00189000
*                                                                  0180 00190000
*   /*****************************************************************/ 00191000
*   /*                                                               */ 00192000
*   /* CHECK FOR DEFINE VOLUME.                              @Y30LB25*/ 00193000
*   /*                                                               */ 00194000
*   /*****************************************************************/ 00195000
*                                                                  0181 00196000
*   IF DEFVOPCD=DEFVOL              /* DEFINE VOL            @Y30LB25*/ 00197000
*     THEN                          /* YES                   @Y30LB25*/ 00198000
@RF00175 CLI   DEFVOPCD(DEFVPTR),24                                0181 00199000
         BNE   @RF00181                                            0181 00200000
*     DO;                           /*                       @Y30LB25*/ 00201000
*                                                                  0182 00202000
*       /*************************************************************/ 00203000
*       /*                                                           */ 00204000
*       /* CHECK FOR ACTIVATE AN INACTIVE VOLUME.            @Y30LB25*/ 00205000
*       /*                                                           */ 00206000
*       /*************************************************************/ 00207000
*                                                                  0183 00208000
*       IF DEFVACT=ON               /* ACT INACT VOL?        @Y30LB25*/ 00209000
*         THEN                      /* YES                   @Y30LB25*/ 00210000
         TM    DEFVACT(DEFVPTR),B'00000010'                        0183 00211000
         BNO   @RF00183                                            0183 00212000
*         DO;                       /*                       @Y30LB25*/ 00213000
*           CALL ACTVOL1;           /*                       @Y30LB25   00214000
*                                      ACTIVATE AN INACT     @Y30LB25   00215000
*                                      BEFORE MCS CALL       @Y30LB25*/ 00216000
         BAL   @14,ACTVOL1                                         0185 00217000
*           RETURN;                 /*                       @Y30LB25*/ 00218000
         B     @EL00002                                            0186 00219000
*         END;                      /*                       @Y30LB25*/ 00220000
*                                                                  0187 00221000
*       /*************************************************************/ 00222000
*       /*                                                           */ 00223000
*       /* CHECK FOR CREATE AN INACTIVE VOLUME.              @Y30LB25*/ 00224000
*       /*                                                           */ 00225000
*       /*************************************************************/ 00226000
*                                                                  0188 00227000
*       IF DEFVCR=ON                /* CRT INACT VOL?        @Y30LB25*/ 00228000
*         THEN                      /* YES                   @Y30LB25*/ 00229000
@RF00183 TM    DEFVCR(DEFVPTR),B'10000000'                         0188 00230000
         BNO   @RF00188                                            0188 00231000
*         DO;                       /*                       @Y30LB25*/ 00232000
*           CALL CRTINCV1;          /*                       @Y30LB25   00233000
*                                      CREATE AN INACT       @Y30LB25   00234000
*                                      BEFORE MCS CALL       @Y30LB25*/ 00235000
         BAL   @14,CRTINCV1                                        0190 00236000
*           IF RPLVRETC=FIXZERO     /*                       @VS32198   00237000
*                                      ERROR?                @VS32198*/ 00238000
*             THEN                  /* YES                   @VS32198*/ 00239000
         L     @06,RPLVPTR                                         0191 00240000
         LH    @06,RPLVRETC(,@06)                                  0191 00241000
         N     @06,@CF01129                                        0191 00242000
         LTR   @06,@06                                             0191 00243000
         BNZ   @RF00191                                            0191 00244000
*             CALL JRNLRPLV;        /*                       @VS32198   00245000
*                                      JOURNAL RPLV          @VS32198*/ 00246000
         BAL   @14,JRNLRPLV                                        0192 00247000
*           RETURN;                 /*                       #Y30LB25*/ 00248000
         B     @EL00002                                            0193 00249000
*         END;                      /*                       #Y30LB25*/ 00250000
*                                                                  0194 00251000
*       /*************************************************************/ 00252000
*       /*                                                           */ 00253000
*       /* CHECK FOR REPLACE VOLUME FLAGS.                   #Y30LB25*/ 00254000
*       /*                                                           */ 00255000
*       /*************************************************************/ 00256000
*                                                                  0195 00257000
*       IF DEFVREP=ON               /* REPLACE VOL FLGS?     #Y30LB25*/ 00258000
*         THEN                      /* YES                   @Y30LB25*/ 00259000
@RF00188 TM    DEFVREP(DEFVPTR),B'00010000'                        0195 00260000
         BNO   @RF00195                                            0195 00261000
*         DO;                       /*                       @Y30LB25*/ 00262000
*           CALL REPVFLG1;          /*                       @Y30LB25   00263000
*                                      REPLACE VOL FLAGS     @Y30LB25   00264000
*                                      BEFORE MCS CALL       @Y30LB25*/ 00265000
         BAL   @14,REPVFLG1                                        0197 00266000
*           RETURN;                 /*                       @Y30LB25*/ 00267000
         B     @EL00002                                            0198 00268000
*         END;                      /*                       @Y30LB25*/ 00269000
*                                                                  0199 00270000
*       /*************************************************************/ 00271000
*       /*                                                           */ 00272000
*       /* CHECK FOR RENAME AN ACTIVE OR INACTIVE VOLUME.    @Y30LB25*/ 00273000
*       /*                                                           */ 00274000
*       /*************************************************************/ 00275000
*                                                                  0200 00276000
*       IF DEFVRNM=ON|DEFVRNTR=ON   /*                       @Y30LB25   00277000
*                                      RENAME ACT VOL OR     @Y30LB25   00278000
*                                      RENAME INAC VOL?      @Y30LB25*/ 00279000
*         THEN                      /* YES                   @Y30LB25*/ 00280000
@RF00195 TM    DEFVRNM(DEFVPTR),B'00100100'                        0200 00281000
         BZ    @RF00200                                            0200 00282000
*         DO;                       /*                       @Y30LB25*/ 00283000
*           CALL RENAME1;           /*                       @Y30LB25   00284000
*                                      RENAME ACT VOL OR     @Y30LB25   00285000
*                                      RENAME INAC VOL       @Y30LB25   00286000
*                                      BEFORE MCS CALL       @Y30LB25*/ 00287000
         BAL   @14,RENAME1                                         0202 00288000
*           IF RPLVRETC=FIXZERO     /*                       @VS32198   00289000
*                                      ERROR?                @VS32198*/ 00290000
*             THEN                  /* YES                   @VS32198*/ 00291000
         L     @06,RPLVPTR                                         0203 00292000
         LH    @06,RPLVRETC(,@06)                                  0203 00293000
         N     @06,@CF01129                                        0203 00294000
         LTR   @06,@06                                             0203 00295000
         BNZ   @RF00203                                            0203 00296000
*             CALL JRNLRPLV;        /*                       @VS32198   00297000
*                                      JOURNAL RPLV          @VS32198*/ 00298000
         BAL   @14,JRNLRPLV                                        0204 00299000
*           RETURN;                 /*                       @Y30LB25*/ 00300000
         B     @EL00002                                            0205 00301000
*         END;                      /*                       @Y30LB25*/ 00302000
*                                                                  0206 00303000
*       /*************************************************************/ 00304000
*       /*                                                           */ 00305000
*       /* CHECK FOR ELIMINATE AN ACTIVE VOLUME.             @Y30LB25*/ 00306000
*       /*                                                           */ 00307000
*       /*************************************************************/ 00308000
*                                                                  0207 00309000
*       IF DEFVELM=ON               /* ELIMINAT ACT VOL?     @Y30LB25*/ 00310000
*         THEN                      /* YES                   @Y30LB25*/ 00311000
@RF00200 TM    DEFVELM(DEFVPTR),B'01000000'                        0207 00312000
         BNO   @RF00207                                            0207 00313000
*         DO;                       /*                       @Y30LB25*/ 00314000
*           CALL RMSVI;             /*                       @Y30LB25   00315000
*                                      RESERVE .MSVI         @Y30LB25*/ 00316000
         BAL   @14,RMSVI                                           0209 00317000
*           CALL ELACREN1;          /*                       @Y30LB25   00318000
*                                      ELIMINATE ACT VOL     @Y30LB25   00319000
*                                      BEFORE MCS CALL       @Y30LB25*/ 00320000
         BAL   @14,ELACREN1                                        0210 00321000
*           IF RPLVRETC=FIXZERO     /*                       @VS32198   00322000
*                                      ERROR?                @VS32198*/ 00323000
*             THEN                  /* YES                   @VS32198*/ 00324000
         L     @06,RPLVPTR                                         0211 00325000
         LH    @06,RPLVRETC(,@06)                                  0211 00326000
         N     @06,@CF01129                                        0211 00327000
         LTR   @06,@06                                             0211 00328000
         BNZ   @RF00211                                            0211 00329000
*             CALL JRNLRPLV;        /*                       @VS32198   00330000
*                                      JOURNAL RPLV          @VS32198*/ 00331000
         BAL   @14,JRNLRPLV                                        0212 00332000
*           RETURN;                 /*                       @Y30LB25*/ 00333000
         B     @EL00002                                            0213 00334000
*         END;                      /*                       @Y30LB25*/ 00335000
*                                                                  0214 00336000
*       /*************************************************************/ 00337000
*       /*                                                           */ 00338000
*       /* CHECK FOR ELIMINATE AN INACTIVE VOLUME.           @Y30LB25*/ 00339000
*       /*                                                           */ 00340000
*       /*************************************************************/ 00341000
*                                                                  0215 00342000
*       IF DEFVELTR=ON              /* ELIMIN INACT VOL?     @Y30LB25*/ 00343000
*         THEN                      /* YES                   @Y30LB25*/ 00344000
@RF00207 TM    DEFVELTR(DEFVPTR),B'00001000'                       0215 00345000
         BNO   @RF00215                                            0215 00346000
*         DO;                       /*                       @Y30LB25*/ 00347000
*           CALL RMSVIS;            /*                       @Y30LB25   00348000
*                                      RESERVE .MSVI         @Y30LB25*/ 00349000
         BAL   @14,RMSVIS                                          0217 00350000
*           IVOLKY=DEFVCSN1;        /*                       @Y30LB25   00351000
*                                      CSN TO CIR KEY        @Y30LB25*/ 00352000
         MVC   IVOLKY(12),DEFVCSN1(DEFVPTR)                        0218 00353000
*           CALL GETRECLC;          /*                       @Y30LB25   00354000
*                                      ELIMINATE INAC VOL    @Y30LB25   00355000
*                                      BEFORE MCS CALL       @Y30LB25*/ 00356000
         BAL   @14,GETRECLC                                        0219 00357000
*           RETURN;                 /*                       @Y30LB25*/ 00358000
         B     @EL00002                                            0220 00359000
*         END;                      /*                       @Y30LB25*/ 00360000
*                                                                  0221 00361000
*       /*************************************************************/ 00362000
*       /*                                                           */ 00363000
*       /* CHECK FOR DEACTIVATE AN ACTIVE VOLUME.            @Y30LB25*/ 00364000
*       /*                                                           */ 00365000
*       /*************************************************************/ 00366000
*                                                                  0222 00367000
*       IF DEFVDACT=ON              /* DEACTIV ACT VOL?      @Y30LB25*/ 00368000
*         THEN                      /* YES                   @Y30LB25*/ 00369000
@RF00215 TM    DEFVDACT(DEFVPTR),B'00000001'                       0222 00370000
         BNO   @RF00222                                            0222 00371000
*         DO;                       /*                       @Y30LB25*/ 00372000
*           CALL RMSVIS;            /*                       @Y30LB25   00373000
*                                      RESERVE .MSVI         @Y30LB25*/ 00374000
         BAL   @14,RMSVIS                                          0224 00375000
*           BVOLKY=DEFVOLD;         /*                       @Y30LB25   00376000
*                                      VOLID TO BVR KEY      @Y30LB25*/ 00377000
         MVC   BVOLKY(6),DEFVOLD(DEFVPTR)                          0225 00378000
*           RPLVKEY=ADDR(BKEY);     /*                       @Y30LB25   00379000
*                                      KEY ADDR              @Y30LB25*/ 00380000
         LA    @06,BKEY                                            0226 00381000
         L     @01,RPLVPTR                                         0226 00382000
         ST    @06,RPLVKEY(,@01)                                   0226 00383000
*           CALL READLOC;           /*                       @Y30LB25   00384000
*                                      DEACTIVATE ACT VOL    @Y30LB25   00385000
*                                      BEFORE MCS CALL       @Y30LB25*/ 00386000
         BAL   @14,READLOC                                         0227 00387000
*           RETURN;                 /*                       @Y30LB25*/ 00388000
         B     @EL00002                                            0228 00389000
*         END;                      /*                       @Y30LB25*/ 00390000
*                                                                  0229 00391000
*       /*************************************************************/ 00392000
*       /*                                                           */ 00393000
*       /* INVALID DEFINE REQUEST.                           @Y30LB25*/ 00394000
*       /*                                                           */ 00395000
*       /*************************************************************/ 00396000
*                                                                  0230 00397000
*       RPLVRETC=FIXFOUR;           /* ERROR RETN CODE       @Y30LB25*/ 00398000
@RF00222 L     @06,RPLVPTR                                         0230 00399000
         MVC   RPLVRETC(2,@06),@CH00041                            0230 00400000
*       RPLRCODE=INVALOP;           /* INVALID REQUEST       @Y30LB25*/ 00401000
         MVC   RPLRCODE(2,@06),@CB00727                            0231 00402000
*       RETURN;                     /*                       @Y30LB25*/ 00403000
         B     @EL00002                                            0232 00404000
*     END;                          /*                       @Y30LB25*/ 00405000
*                                                                  0233 00406000
*   /*****************************************************************/ 00407000
*   /*                                                               */ 00408000
*   /* CHECK FOR MOVE CARTRIDGE.                             @Y30LB25*/ 00409000
*   /*                                                               */ 00410000
*   /*****************************************************************/ 00411000
*                                                                  0234 00412000
*   IF MCRTOPCD=MVCRT               /* MOVE CART?            @Y30LB25*/ 00413000
*     THEN                          /* YES                   @Y30LB25*/ 00414000
*                                                                  0234 00415000
@RF00181 CLI   MCRTOPCD(MCRTPTR),14                                0234 00416000
         BNE   @RF00234                                            0234 00417000
*     /***************************************************************/ 00418000
*     /*                                                             */ 00419000
*     /* CHECK FOR MOVE AN INACTIVE VOLUME.                  @Y30LB25*/ 00420000
*     /*                                                             */ 00421000
*     /***************************************************************/ 00422000
*                                                                  0235 00423000
*     IF MCRTTRAN=ON                /* MOVE INACT CART?      @Y30LB25*/ 00424000
*       THEN                        /* YES                   @Y30LB25*/ 00425000
         TM    MCRTTRAN(MCRTPTR),B'00100000'                       0235 00426000
         BNO   @RF00235                                            0235 00427000
*       DO;                         /*                       @Y30LB25*/ 00428000
*         CALL INACVOL1;            /* MOVE INACT VOL        @Y30LB25   00429000
*                                      BEFORE MSC CALL       @Y30LB25*/ 00430000
         BAL   @14,INACVOL1                                        0237 00431000
*         RETURN;                   /*                       @Y30LB25*/ 00432000
         B     @EL00002                                            0238 00433000
*       END;                        /*                       @Y30LB25*/ 00434000
*                                                                  0239 00435000
*   /*****************************************************************/ 00436000
*   /*                                                               */ 00437000
*   /* INVALID MOVE REQUEST.                                 @Y30LB25*/ 00438000
*   /*                                                               */ 00439000
*   /*****************************************************************/ 00440000
*                                                                  0240 00441000
*     ELSE                          /* ERROR                 @Y30LB25*/ 00442000
*       DO;                         /*                       @Y30LB25*/ 00443000
@RF00235 DS    0H                                                  0241 00444000
*         RPLVRETC=FIXFOUR;         /* ERROR RETN CODE       @Y30LB25*/ 00445000
         L     @06,RPLVPTR                                         0241 00446000
         MVC   RPLVRETC(2,@06),@CH00041                            0241 00447000
*         RPLRCODE=INVALOP;         /* INVALID REQUEST       @Y30LB25*/ 00448000
         MVC   RPLRCODE(2,@06),@CB00727                            0242 00449000
*         RETURN;                   /*                       @Y30LB25*/ 00450000
         B     @EL00002                                            0243 00451000
*       END;                        /*                       @Y30LB25*/ 00452000
*                                                                  0244 00453000
*   /*****************************************************************/ 00454000
*   /*                                                               */ 00455000
*   /* CHECK FOR COPY VOLUME.                                @Y30LB25*/ 00456000
*   /*                                                               */ 00457000
*   /*****************************************************************/ 00458000
*                                                                  0245 00459000
*   IF CVOLOPCD=CPYVOL              /* COPY VOL?             @Y30LB25*/ 00460000
*     THEN                          /* YES                   @Y30LB25*/ 00461000
@RF00234 L     @06,CVOLPTR                                         0245 00462000
         CLI   CVOLOPCD(@06),X'2A'                                 0245 00463000
         BNE   @RF00245                                            0245 00464000
*     DO;                           /*                       @Y30LB25*/ 00465000
*                                                                  0246 00466000
*       /*************************************************************/ 00467000
*       /*                                                           */ 00468000
*       /* CHECK FOR TRANSFER DATA FROM                      @Y30LB25*/ 00469000
*       /* DASD TO CARTRIDGE.                                @Y30LB25*/ 00470000
*       /*                                                           */ 00471000
*       /*************************************************************/ 00472000
*                                                                  0247 00473000
*       IF CVODASCR=ON              /* TRANSFER DATA         @Y30LB25   00474000
*                                      DASD TO CART?         @Y30LB25*/ 00475000
*         THEN                      /* YES?                  @Y30LB25*/ 00476000
         TM    CVODASCR(@06),B'10000000'                           0247 00477000
         BNO   @RF00247                                            0247 00478000
*         DO;                       /*                       @Y30LB25*/ 00479000
*           CALL RMSVIS;            /*                       @Y30LB25   00480000
*                                      RESERVE .MSVI         @Y30LB25*/ 00481000
         BAL   @14,RMSVIS                                          0249 00482000
*           BVOLKY=CVOLID;          /*                       @Y30LB25   00483000
*                                      VOLID TO BVR          @Y30LB25*/ 00484000
         L     @06,CVOLPTR                                         0250 00485000
         MVC   BVOLKY(6),CVOLID(@06)                               0250 00486000
*           RPLVKEY=ADDR(BKEY);     /*                       @Y30LB25   00487000
*                                      KEY ADDR              @Y30LB25*/ 00488000
         LA    @06,BKEY                                            0251 00489000
         L     @01,RPLVPTR                                         0251 00490000
         ST    @06,RPLVKEY(,@01)                                   0251 00491000
*           CALL READLOC;           /*                       @Y30LB25   00492000
*                                      TRANSFER DATA         @Y30LB25   00493000
*                                      DASD TO CART          @Y30LB25*/ 00494000
         BAL   @14,READLOC                                         0252 00495000
*           RETURN;                 /*                       @Y30LB25*/ 00496000
         B     @EL00002                                            0253 00497000
*         END;                      /*                       @Y30LB25*/ 00498000
*                                                                  0254 00499000
*       /*************************************************************/ 00500000
*       /*                                                           */ 00501000
*       /* TRANSFER DATA FROM AN ACTIVE TO AN                @Y30LB25*/ 00502000
*       /* INACTIVE VOLUME, OR TRANSFER                      @Y30LB25*/ 00503000
*       /* DATA FROM AN INACTIVE TO AN                       @Y30LB25*/ 00504000
*       /* ACTIVE VOLUME.                                    @Y30LB25*/ 00505000
*       /*                                                           */ 00506000
*       /*************************************************************/ 00507000
*                                                                  0255 00508000
*       IF CVOCRCR=ON|CVOCRCRV=ON   /* TRANSFER DATA         @Y30LB25   00509000
*                                      ACT VOL TO INACT      @Y30LB25   00510000
*                                      VOL? OR TRANSFER      @Y30LB25   00511000
*                                      DATA INACT TO         @Y30LB25   00512000
*                                      ACT VOL?              @Y30LB25*/ 00513000
*         THEN                      /* YES?                  @Y30LB25*/ 00514000
@RF00247 L     @06,CVOLPTR                                         0255 00515000
         TM    CVOCRCR(@06),B'00110000'                            0255 00516000
         BNZ   @RT00255                                            0255 00517000
*         RETURN;                   /*                       @Y30LB25*/ 00518000
*                                                                  0256 00519000
*       /*************************************************************/ 00520000
*       /*                                                           */ 00521000
*       /* INVALID COPY REQUEST.                             @Y30LB25*/ 00522000
*       /*                                                           */ 00523000
*       /*************************************************************/ 00524000
*                                                                  0257 00525000
*       RPLVRETC=FIXFOUR;           /* ERROR                 @Y30LB25*/ 00526000
         L     @06,RPLVPTR                                         0257 00527000
         MVC   RPLVRETC(2,@06),@CH00041                            0257 00528000
*       RPLRCODE=INVALOP;           /* INVALID REQUEST       @Y30LB25*/ 00529000
         MVC   RPLRCODE(2,@06),@CB00727                            0258 00530000
*       RETURN;                     /*                       @Y30LB25*/ 00531000
         B     @EL00002                                            0259 00532000
*     END;                          /*                       @Y30LB25*/ 00533000
*                                                                  0260 00534000
*   /*****************************************************************/ 00535000
*   /*                                                               */ 00536000
*   /* CHECK FOR COPY CARTRIDGE WHICH IS TO BE               @Y30LB25*/ 00537000
*   /* PROCESSED BY ICBVMS00.                                @Y30LB25*/ 00538000
*   /*                                                               */ 00539000
*   /*****************************************************************/ 00540000
*                                                                  0261 00541000
*   IF CVOLOPCD=CPYCART             /* COPY CART?            @Y30LB25*/ 00542000
*     THEN                          /* YES                   @Y30LB25*/ 00543000
@RF00245 L     @06,CVOLPTR                                         0261 00544000
         CLI   CVOLOPCD(@06),X'28'                                 0261 00545000
         BE    @RT00261                                            0261 00546000
*     RETURN;                       /*                       @Y30LB25*/ 00547000
*                                                                  0262 00548000
*   /*****************************************************************/ 00549000
*   /*                                                               */ 00550000
*   /* INVALID FUNCTION.                                     @Y30LB25*/ 00551000
*   /*                                                               */ 00552000
*   /*****************************************************************/ 00553000
*                                                                  0263 00554000
*   RPLRCODE=FIXFOUR;               /* ERROR RETN CODE       @Y30LB25*/ 00555000
         L     @06,RPLVPTR                                         0263 00556000
         MVC   RPLRCODE(2,@06),@CH00041                            0263 00557000
*   RPLRCODE=INVALOP;               /* INVALID REQUEST       @Y30LB25*/ 00558000
         MVC   RPLRCODE(2,@06),@CB00727                            0264 00559000
*   END BEFRMSC;                    /*                       @Y30LB25*/ 00560000
         B     @EL00002                                            0265 00561000
*                                                                  0266 00562000
*   /*****************************************************************/ 00563000
*   /*                                                               */ 00564000
*   /* PROCEDURE NAME - AFTRMSC                              @Y30LB25*/ 00565000
*   /*                                                       @Y30LB25*/ 00566000
*   /* FUNCTION - PROCESS MSVC AFTER THE CALL TO THE MSC.    @Y30LB25*/ 00567000
*   /*                                                       @Y30LB25*/ 00568000
*   /* INPUT -                                               @Y30LB25*/ 00569000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 00570000
*   /*                                                       @Y30LB25*/ 00571000
*   /* OUTPUT -                                              @Y30LB25*/ 00572000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 00573000
*   /* AN ERROR                                              @Y30LB25*/ 00574000
*   /*                                                               */ 00575000
*   /*****************************************************************/ 00576000
*                                                                  0266 00577000
*AFTRMSC:                           /*                       @Y30LB25*/ 00578000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 00579000
*                                                                  0266 00580000
AFTRMSC  ST    @14,@SA00003                                        0266 00581000
*   /*****************************************************************/ 00582000
*   /*                                                               */ 00583000
*   /* CHECK FOR DEFINE VOLUME.                              @Y30LB25*/ 00584000
*   /*                                                               */ 00585000
*   /*****************************************************************/ 00586000
*                                                                  0267 00587000
*   IF DEFVOPCD=DEFVOL              /* DEFINE VOL            @Y30LB25*/ 00588000
*     THEN                          /* YES                   @Y30LB25*/ 00589000
         CLI   DEFVOPCD(DEFVPTR),24                                0267 00590000
         BNE   @RF00267                                            0267 00591000
*     DO;                           /*                       @Y30LB25*/ 00592000
*                                                                  0268 00593000
*       /*************************************************************/ 00594000
*       /*                                                           */ 00595000
*       /* CHECK FOR ACTIVATE AN INACTIVE VOLUME.            @Y30LB25*/ 00596000
*       /*                                                           */ 00597000
*       /*************************************************************/ 00598000
*                                                                  0269 00599000
*       IF DEFVACT=ON               /* ACT INACT VOL?        @Y30LB25*/ 00600000
*         THEN                      /* YES                   @Y30LB25*/ 00601000
         TM    DEFVACT(DEFVPTR),B'00000010'                        0269 00602000
         BNO   @RF00269                                            0269 00603000
*         DO;                       /*                       @Y30LB25*/ 00604000
*           CALL ACTVOL2;           /*                       @Y30LB25   00605000
*                                      ACTIVATE AN INACT     @Y30LB25   00606000
*                                      AFTER MCS CALL        @Y30LB25*/ 00607000
         BAL   @14,ACTVOL2                                         0271 00608000
*           RETURN;                 /*                       @Y30LB25*/ 00609000
@EL00003 DS    0H                                                  0272 00610000
@EF00003 DS    0H                                                  0272 00611000
@ER00003 L     @14,@SA00003                                        0272 00612000
         BR    @14                                                 0272 00613000
*         END;                      /*                       @Y30LB25*/ 00614000
*                                                                  0273 00615000
*       /*************************************************************/ 00616000
*       /*                                                           */ 00617000
*       /* CHECK FOR CREATE AN INACTIVE VOLUME.              @Y30LB25*/ 00618000
*       /*                                                           */ 00619000
*       /*************************************************************/ 00620000
*                                                                  0274 00621000
*       IF DEFVCR=ON                /* CRT INACT VOL?        @Y30LB25*/ 00622000
*         THEN                      /* YES                   @Y30LB25*/ 00623000
@RF00269 TM    DEFVCR(DEFVPTR),B'10000000'                         0274 00624000
         BNO   @RF00274                                            0274 00625000
*         DO;                       /*                       @Y30LB25*/ 00626000
*           CALL CRTINCV2;          /*                       @Y30LB25   00627000
*                                      CREATE AN INACT       @Y30LB25   00628000
*                                      AFTER MCS CALL        @Y30LB25*/ 00629000
         BAL   @14,CRTINCV2                                        0276 00630000
*           RETURN;                 /*                       @Y30LB25*/ 00631000
         B     @EL00003                                            0277 00632000
*         END;                      /*                       @Y30LB25*/ 00633000
*                                                                  0278 00634000
*       /*************************************************************/ 00635000
*       /*                                                           */ 00636000
*       /* CHECK FOR REPLACE VOLUME FLAGS.                   @Y30LB25*/ 00637000
*       /*                                                           */ 00638000
*       /*************************************************************/ 00639000
*                                                                  0279 00640000
*       IF DEFVREP=ON               /* REPLACE VOL FLGS?     @Y30LB25*/ 00641000
*         THEN                      /* YES                   @Y30LB25*/ 00642000
@RF00274 TM    DEFVREP(DEFVPTR),B'00010000'                        0279 00643000
         BNO   @RF00279                                            0279 00644000
*         DO;                       /*                       @Y30LB25*/ 00645000
*           CALL REPVFLG2;          /*                       @Y30LB25   00646000
*                                      REPLACE VOL FLAGS     @Y30LB25   00647000
*                                      A FTER MCS CALL       @Y30LB25*/ 00648000
         BAL   @14,REPVFLG2                                        0281 00649000
*           RETURN;                 /*                       @Y30LB25*/ 00650000
         B     @EL00003                                            0282 00651000
*         END;                      /*                       @Y30LB25*/ 00652000
*                                                                  0283 00653000
*       /*************************************************************/ 00654000
*       /*                                                           */ 00655000
*       /* CHECK FOR RENAME AN ACTIVE OR INACTIVE VOLUME.    @Y30LB25*/ 00656000
*       /*                                                           */ 00657000
*       /*************************************************************/ 00658000
*                                                                  0284 00659000
*       IF DEFVRNM=ON|DEFVRNTR=ON   /* RENAME ACT VOL OR     @Y30LB25   00660000
*                                      INACT VOL?            @Y30LB25*/ 00661000
*         THEN                      /* YES                   @Y30LB25*/ 00662000
@RF00279 TM    DEFVRNM(DEFVPTR),B'00100100'                        0284 00663000
         BZ    @RF00284                                            0284 00664000
*         DO;                       /*                       @Y30LB25*/ 00665000
*           CALL RENAME2;           /*                       @Y30LB25   00666000
*                                      RENAME ACT VOL OR     @Y30LB25   00667000
*                                      INACT VOL             @Y30LB25   00668000
*                                      AFTER MCS CALL        @Y30LB25*/ 00669000
         BAL   @14,RENAME2                                         0286 00670000
*           RETURN;                 /*                       @Y30LB25*/ 00671000
         B     @EL00003                                            0287 00672000
*         END;                      /*                       @Y30LB25*/ 00673000
*                                                                  0288 00674000
*       /*************************************************************/ 00675000
*       /*                                                           */ 00676000
*       /* CHECK FOR ELIMINATE AN ACTIVE VOLUME.             @Y30LB25*/ 00677000
*       /*                                                           */ 00678000
*       /*************************************************************/ 00679000
*                                                                  0289 00680000
*       IF DEFVELM=ON               /* ELIMINAT ACT VOL?     @Y30LB25*/ 00681000
*         THEN                      /* YES                   @Y30LB25*/ 00682000
@RF00284 TM    DEFVELM(DEFVPTR),B'01000000'                        0289 00683000
         BNO   @RF00289                                            0289 00684000
*         DO;                       /*                       @Y30LB25*/ 00685000
*           CALL ELMACTV2;          /*                       @Y30LB25   00686000
*                                      ELIMINATE ACT VOL     @Y30LB25   00687000
*                                      AFTER MCS CALL        @Y30LB25*/ 00688000
         BAL   @14,ELMACTV2                                        0291 00689000
*           RETURN;                 /*                       @Y30LB25*/ 00690000
         B     @EL00003                                            0292 00691000
*         END;                      /*                       @Y30LB25*/ 00692000
*                                                                  0293 00693000
*       /*************************************************************/ 00694000
*       /*                                                           */ 00695000
*       /* CHECK FOR ELIMINATE AN INACTIVE VOLUME.           @Y30LB25*/ 00696000
*       /*                                                           */ 00697000
*       /*************************************************************/ 00698000
*                                                                  0294 00699000
*       IF DEFVELTR=ON              /* ELIMIN INACT VOL?     @Y30LB25*/ 00700000
*         THEN                      /* YES                   @Y30LB25*/ 00701000
@RF00289 TM    DEFVELTR(DEFVPTR),B'00001000'                       0294 00702000
         BNO   @RF00294                                            0294 00703000
*         DO;                       /*                       @Y30LB25*/ 00704000
*           CALL ELINACV2;          /*                       @Y30LB25   00705000
*                                      ELIMINATE INAC VOL    @Y30LB25   00706000
*                                      AFTER MCS CALL        @Y30LB25*/ 00707000
         BAL   @14,ELINACV2                                        0296 00708000
*           RETURN;                 /*                       @Y30LB25*/ 00709000
         B     @EL00003                                            0297 00710000
*         END;                      /*                       @Y30LB25*/ 00711000
*                                                                  0298 00712000
*       /*************************************************************/ 00713000
*       /*                                                           */ 00714000
*       /* CHECK FOR DEACTIVE AN ACTIVE VOLUME.              @Y30LB25*/ 00715000
*       /*                                                           */ 00716000
*       /*************************************************************/ 00717000
*                                                                  0299 00718000
*       IF DEFVDACT=ON              /* DEACTIV ACT VOL?      @Y30LB25*/ 00719000
*         THEN                      /* YES                   @Y30LB25*/ 00720000
@RF00294 TM    DEFVDACT(DEFVPTR),B'00000001'                       0299 00721000
         BNO   @RF00299                                            0299 00722000
*         DO;                       /*                       @Y30LB25*/ 00723000
*           CALL DEACTV2;           /*                       @Y30LB25   00724000
*                                      DEACTIVATE ACT VOL    @Y30LB25   00725000
*                                      AFTER MCS CALL        @Y30LB25*/ 00726000
         BAL   @14,DEACTV2                                         0301 00727000
*           RETURN;                 /*                       @Y30LB25*/ 00728000
         B     @EL00003                                            0302 00729000
*         END;                      /*                       @Y30LB25*/ 00730000
*                                                                  0303 00731000
*       /*************************************************************/ 00732000
*       /*                                                           */ 00733000
*       /* INVALID DEFINE REQUEST.                           @Y30LB25*/ 00734000
*       /*                                                           */ 00735000
*       /*************************************************************/ 00736000
*                                                                  0304 00737000
*       RPLVRETC=FIXFOUR;           /* ERROR RETN CODE       @Y30LB25*/ 00738000
@RF00299 L     @06,RPLVPTR                                         0304 00739000
         MVC   RPLVRETC(2,@06),@CH00041                            0304 00740000
*       RPLRCODE=INVALOP;           /* INVALID REQUEST       @Y30LB25*/ 00741000
         MVC   RPLRCODE(2,@06),@CB00727                            0305 00742000
*       RETURN;                     /*                       @Y30LB25*/ 00743000
         B     @EL00003                                            0306 00744000
*     END;                          /*                       @Y30LB25*/ 00745000
*                                                                  0307 00746000
*   /*****************************************************************/ 00747000
*   /*                                                               */ 00748000
*   /* CHECK FOR MOVE CARTRIDGE.                             @Y30LB25*/ 00749000
*   /*                                                               */ 00750000
*   /*****************************************************************/ 00751000
*                                                                  0308 00752000
*   IF MCRTOPCD=MVCRT               /* MOVE CART?            @Y30LB25*/ 00753000
*     THEN                          /* YES                   @Y30LB25*/ 00754000
*                                                                  0308 00755000
@RF00267 CLI   MCRTOPCD(MCRTPTR),14                                0308 00756000
         BNE   @RF00308                                            0308 00757000
*     /***************************************************************/ 00758000
*     /*                                                             */ 00759000
*     /* CHECK FOR MOVE AN INACTIVE VOLUME.                  @Y30LB25*/ 00760000
*     /*                                                             */ 00761000
*     /***************************************************************/ 00762000
*                                                                  0309 00763000
*     IF MCRTTRAN=ON                /* MOVE INAC VOL?        @Y30LB25*/ 00764000
*       THEN                        /* YES                   @Y30LB25*/ 00765000
         TM    MCRTTRAN(MCRTPTR),B'00100000'                       0309 00766000
         BNO   @RF00309                                            0309 00767000
*       DO;                         /*                       @Y30LB25*/ 00768000
*         CALL INACVOL2;            /* MOVE INACT VOL        @Y30LB25   00769000
*                                      AFTER MSC CALL        @Y30LB25*/ 00770000
         BAL   @14,INACVOL2                                        0311 00771000
*         RETURN;                   /*                       @Y30LB25*/ 00772000
         B     @EL00003                                            0312 00773000
*       END;                        /*                       @Y30LB25*/ 00774000
*                                                                  0313 00775000
*   /*****************************************************************/ 00776000
*   /*                                                               */ 00777000
*   /* INVALID MOVE REQUEST.                                 @Y30LB25*/ 00778000
*   /*                                                               */ 00779000
*   /*****************************************************************/ 00780000
*                                                                  0314 00781000
*     ELSE                          /* ERROR                 @Y30LB25*/ 00782000
*       DO;                         /*                       @Y30LB25*/ 00783000
@RF00309 DS    0H                                                  0315 00784000
*         RPLVRETC=FIXFOUR;         /* ERROR RETN CODE       @Y30LB25*/ 00785000
         L     @06,RPLVPTR                                         0315 00786000
         MVC   RPLVRETC(2,@06),@CH00041                            0315 00787000
*         RPLRCODE=INVALOP;         /* INVALID REQUEST       @Y30LB25*/ 00788000
         MVC   RPLRCODE(2,@06),@CB00727                            0316 00789000
*         RETURN;                   /*                       @Y30LB25*/ 00790000
         B     @EL00003                                            0317 00791000
*       END;                        /*                       @Y30LB25*/ 00792000
*                                                                  0318 00793000
*   /*****************************************************************/ 00794000
*   /*                                                               */ 00795000
*   /* CHECK FOR COPY VOLUME.                                @Y30LB25*/ 00796000
*   /*                                                               */ 00797000
*   /*****************************************************************/ 00798000
*                                                                  0319 00799000
*   IF CVOLOPCD=CPYVOL              /* COPY VOL?             @Y30LB25*/ 00800000
*     THEN                          /* YES                   @Y30LB25*/ 00801000
@RF00308 L     @06,CVOLPTR                                         0319 00802000
         CLI   CVOLOPCD(@06),X'2A'                                 0319 00803000
         BNE   @RF00319                                            0319 00804000
*     DO;                           /*                       @Y30LB25*/ 00805000
*                                                                  0320 00806000
*       /*************************************************************/ 00807000
*       /*                                                           */ 00808000
*       /* CHECK FOR TRANSFER DATA FROM                      @Y30LB25*/ 00809000
*       /* DASD TO CARTRIDGE, OR                             @Y30LB25*/ 00810000
*       /* CHECK FOR TRANSFER DATA FROM                      @Y30LB25*/ 00811000
*       /* AN INACTIVE TO AN ACTIVE VOLUME.                  @Y30LB25*/ 00812000
*       /*                                                           */ 00813000
*       /*************************************************************/ 00814000
*                                                                  0321 00815000
*       IF CVODASCR=ON|CVOCRCRV=ON  /* TRANSFER DATA         @Y30LB25   00816000
*                                      DASD TO CART OR       @Y30LB25   00817000
*                                      TRANSFER DATA         @Y30LB25   00818000
*                                      INACT TO ACT?         @Y30LB25*/ 00819000
*         THEN                      /* YES?                  @Y30LB25*/ 00820000
         TM    CVODASCR(@06),B'10010000'                           0321 00821000
         BZ    @RF00321                                            0321 00822000
*         DO;                       /*                       @Y30LB25*/ 00823000
*           CALL TRANDAT2;          /*                       @Y30LB25   00824000
*                                      TRANSFER DATA         @Y30LB25   00825000
*                                      DASD TO CART OR       @Y30LB25   00826000
*                                      TRANSFER DATA         @Y30LB25   00827000
*                                      INACT TO ACT          @Y30LB25   00828000
*                                      AFTER MSC             @Y30LB25*/ 00829000
         BAL   @14,TRANDAT2                                        0323 00830000
*           RETURN;                 /*                       @Y30LB25*/ 00831000
         B     @EL00003                                            0324 00832000
*         END;                      /*                       @Y30LB25*/ 00833000
*                                                                  0325 00834000
*       /*************************************************************/ 00835000
*       /*                                                           */ 00836000
*       /* CHECK FOR TRANSFER DATA FROM                      @Y30LB25*/ 00837000
*       /* AN ACTIVE TO AN INACTIVE VOLUME.                  @Y30LB25*/ 00838000
*       /*                                                           */ 00839000
*       /*************************************************************/ 00840000
*                                                                  0326 00841000
*       IF CVOCRCR=ON               /* TRANSFER DATA         @Y30LB25   00842000
*                                      ACT TO INACT?         @Y30LB25*/ 00843000
*         THEN                      /* YES?                  @Y30LB25*/ 00844000
@RF00321 L     @06,CVOLPTR                                         0326 00845000
         TM    CVOCRCR(@06),B'00100000'                            0326 00846000
         BNO   @RF00326                                            0326 00847000
*         DO;                       /*                       @Y30LB25*/ 00848000
*           CALL ACINACV2;          /*                       @Y30LB25   00849000
*                                      TRANSFER DATA         @Y30LB25   00850000
*                                      ACT TO INAC VOL       @Y30LB25   00851000
*                                      AFTER MSC             @Y30LB25*/ 00852000
         BAL   @14,ACINACV2                                        0328 00853000
*           RETURN;                 /*                       @Y30LB25*/ 00854000
         B     @EL00003                                            0329 00855000
*         END;                      /*                       @Y30LB25*/ 00856000
*                                                                  0330 00857000
*       /*************************************************************/ 00858000
*       /*                                                           */ 00859000
*       /* INVALID COPY REQUEST.                             @Y30LB25*/ 00860000
*       /*                                                           */ 00861000
*       /*************************************************************/ 00862000
*                                                                  0331 00863000
*       RPLVRETC=FIXFOUR;           /* ERROR RETN CODE       @Y30LB25*/ 00864000
@RF00326 L     @06,RPLVPTR                                         0331 00865000
         MVC   RPLVRETC(2,@06),@CH00041                            0331 00866000
*       RPLRCODE=INVALOP;           /* INVALID REQUEST       @Y30LB25*/ 00867000
         MVC   RPLRCODE(2,@06),@CB00727                            0332 00868000
*       RETURN;                     /*                       @Y30LB25*/ 00869000
         B     @EL00003                                            0333 00870000
*     END;                          /*                       @Y30LB25*/ 00871000
*                                                                  0334 00872000
*   /*****************************************************************/ 00873000
*   /*                                                               */ 00874000
*   /* CHECK FOR COPY CARTRIDGE WHICH IS TO BE               @Y30LB25*/ 00875000
*   /* PROCESSED BY ICBVMS00.                                @Y30LB25*/ 00876000
*   /*                                                               */ 00877000
*   /*****************************************************************/ 00878000
*                                                                  0335 00879000
*   IF CVOLOPCD=CPYCART             /* COPY CART?            @Y30LB25*/ 00880000
*     THEN                          /* YES                   @Y30LB25*/ 00881000
@RF00319 L     @06,CVOLPTR                                         0335 00882000
         CLI   CVOLOPCD(@06),X'28'                                 0335 00883000
         BE    @RT00335                                            0335 00884000
*     RETURN;                       /*                       @Y30LB25*/ 00885000
*                                                                  0336 00886000
*   /*****************************************************************/ 00887000
*   /*                                                               */ 00888000
*   /* INVALID FUNCTION.                                     @Y30LB25*/ 00889000
*   /*                                                               */ 00890000
*   /*****************************************************************/ 00891000
*                                                                  0337 00892000
*   RPLRCODE=FIXFOUR;               /* ERROR RETN CODE       @Y30LB25*/ 00893000
         L     @06,RPLVPTR                                         0337 00894000
         MVC   RPLRCODE(2,@06),@CH00041                            0337 00895000
*   RPLRCODE=INVALOP;               /* INVALID REQUEST       @Y30LB25*/ 00896000
         MVC   RPLRCODE(2,@06),@CB00727                            0338 00897000
*   RETURN;                         /*                       @Y30LB25*/ 00898000
         B     @EL00003                                            0339 00899000
*   END AFTRMSC;                    /*                       @Y30LB25*/ 00900000
         B     @EL00003                                            0340 00901000
*                                                                  0341 00902000
*   /*****************************************************************/ 00903000
*   /*                                                               */ 00904000
*   /* PROCEDURE NAME - JRNLRPLV                             @Y30LB25*/ 00905000
*   /*                                                       @Y30LB25*/ 00906000
*   /* FUNCTION - WRITE THE RPLV TO .MSVIJRNL BEFORE AND/OR  @VS32198*/ 00907000
*   /* AFTER THE MSC WAS CALLED.                             @Y30LB25*/ 00908000
*   /*                                                       @Y30LB25*/ 00909000
*   /* INPUT -                                               @Y30LB25*/ 00910000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 00911000
*   /*                                                       @Y30LB25*/ 00912000
*   /* OUTPUT -                                              @Y30LB25*/ 00913000
*   /* RPLV WAS JOURNALLED FLAG IN PASSBYTE                  @Y30LB25*/ 00914000
*   /*                                                               */ 00915000
*   /*****************************************************************/ 00916000
*                                                                  0341 00917000
*                                                                  0341 00918000
*   /*****************************************************************/ 00919000
*   /*                                                               */ 00920000
*   /* RESERVE/RELEASE RETURNS ZERO REASON/RETURN CODES.     @Y30LB25*/ 00921000
*   /* RPLV WILL BE JOURNALLED, BECAUSE CHECK FOR DISABLED   @Y30LB25*/ 00922000
*   /* WAS MADE BEFORE CALL TO THE MSC. THEREFORE,           @Y30LB25*/ 00923000
*   /* THIS INCOMPLETELY PROCESSED FUNCTION WILL BE ALLOWED  @Y30LB25*/ 00924000
*   /* TO COMPLETE EVEN IF THE JOURNAL HAS BEEN DISABLED     @Y30LB25*/ 00925000
*   /* SINCE THE LAST CHECK. THE JOURNAL ALWAYS HAS          @Y30LB25*/ 00926000
*   /* SPACE RESERVED FOR SUCH A SITUATION.                  @Y30LB25*/ 00927000
*   /*                                                               */ 00928000
*   /*****************************************************************/ 00929000
*                                                                  0341 00930000
*JRNLRPLV:                          /*                       @Y30LB25*/ 00931000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 00932000
JRNLRPLV ST    @14,@SA00004                                        0341 00933000
*   RESPECIFY                       /*                       @Y30LB25*/ 00934000
*     RG0 RSTD;                     /* RESTRICT REG 0        @Y30LB25*/ 00935000
*   RESPECIFY                       /*                       @Y30LB25*/ 00936000
*     RG1 RSTD;                     /* RESTRICT REG 1        @Y30LB25*/ 00937000
*   RG0=RESEXVJL;                   /* RESERVE JRNL FLAG     @Y30LB25*/ 00938000
         LA    RG0,17                                              0344 00939000
*   RG1=RPLVPTR;                    /* RPLV PTR              @Y30LB25*/ 00940000
         L     RG1,RPLVPTR                                         0345 00941000
*   CALL ICBVRR00;                  /* RESERVE JOURNNAL      @Y30LB25*/ 00942000
         L     @15,@CV00763                                        0346 00943000
         BALR  @14,@15                                             0346 00944000
*   CALL ICBVJL00;                  /* JRNL THE RPLV         @Y30LB25*/ 00945000
         L     @15,@CV00764                                        0347 00946000
         BALR  @14,@15                                             0347 00947000
*   RG0=DEQJRNL;                    /* RELEASE JRNL FLAG     @Y30LB25*/ 00948000
         LA    RG0,16                                              0348 00949000
*   CALL ICBVRR00;                  /* RELEASE JOURNAL       @Y30LB25*/ 00950000
         L     @15,@CV00763                                        0349 00951000
         BALR  @14,@15                                             0349 00952000
*   RESPECIFY                       /*                       @Y30LB25*/ 00953000
*     RG0 UNRSTD;                   /* UNRESTRICT REG 0      @Y30LB25*/ 00954000
*   RESPECIFY                       /*                       @Y30LB25*/ 00955000
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @Y30LB25*/ 00956000
*   RPLVFLG=ON;                     /* RPLV IS JRNLED        @Y30LB25*/ 00957000
         OI    RPLVFLG,B'00000001'                                 0352 00958000
*   RETURN;                         /*                       @Y30LB25*/ 00959000
@EL00004 DS    0H                                                  0353 00960000
@EF00004 DS    0H                                                  0353 00961000
@ER00004 L     @14,@SA00004                                        0353 00962000
         BR    @14                                                 0353 00963000
*   END JRNLRPLV;                   /*                       @Y30LB25*/ 00964000
*                                                                  0355 00965000
*   /*****************************************************************/ 00966000
*   /*                                                               */ 00967000
*   /* PROCEDURE NAME - RMSVI                                @Y30LB25*/ 00968000
*   /*                                                       @Y30LB25*/ 00969000
*   /* FUNCTION - RESERVE .MSVI EXCLUSIVE.                   @Y30LB25*/ 00970000
*   /*                                                       @Y30LB25*/ 00971000
*   /* INPUT -                                               @Y30LB25*/ 00972000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 00973000
*   /*                                                       @Y30LB25*/ 00974000
*   /* OUTPUT -                                              @Y30LB25*/ 00975000
*   /* NONE                                                  @Y30LB25*/ 00976000
*   /*                                                               */ 00977000
*   /*****************************************************************/ 00978000
*                                                                  0355 00979000
*RMSVI:                             /*                       @Y30LB25*/ 00980000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 00981000
RMSVI    ST    @14,@SA00005                                        0355 00982000
*   RESPECIFY                       /*                       @Y30LB25*/ 00983000
*     RG0 RSTD;                     /* RESTRICT REG 0        @Y30LB25*/ 00984000
*   RESPECIFY                       /*                       @Y30LB25*/ 00985000
*     RG1 RSTD;                     /* RESTRICT REG 1        @Y30LB25*/ 00986000
*   RG0=RESEXINV;                   /* RESERVE .MSVI FLAG    @Y30LB25*/ 00987000
         LA    RG0,1                                               0358 00988000
*   RG1=RPLVPTR;                    /* RPLV PTR              @Y30LB25*/ 00989000
         L     RG1,RPLVPTR                                         0359 00990000
*   CALL ICBVRR00;                  /* RESERVE .MSVI         @Y30LB25*/ 00991000
         L     @15,@CV00763                                        0360 00992000
         BALR  @14,@15                                             0360 00993000
*   RESPECIFY                       /*                       @Y30LB25*/ 00994000
*     RG0 UNRSTD;                   /* UNRESTRICT REG 0      @Y30LB25*/ 00995000
*   RESPECIFY                       /*                       @Y30LB25*/ 00996000
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @Y30LB25*/ 00997000
*   END RMSVI;                      /*                       @Y30LB25*/ 00998000
@EL00005 DS    0H                                                  0363 00999000
@EF00005 DS    0H                                                  0363 01000000
@ER00005 L     @14,@SA00005                                        0363 01001000
         BR    @14                                                 0363 01002000
*                                                                  0364 01003000
*   /*****************************************************************/ 01004000
*   /*                                                               */ 01005000
*   /* PROCEDURE NAME - RMSVIS                               @Y30LB25*/ 01006000
*   /*                                                       @Y30LB25*/ 01007000
*   /* FUNCTION - RESERVE .MSVI SHARED.                      @Y30LB25*/ 01008000
*   /*                                                       @Y30LB25*/ 01009000
*   /* INPUT -                                               @Y30LB25*/ 01010000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 01011000
*   /*                                                       @Y30LB25*/ 01012000
*   /* OUTPUT -                                              @Y30LB25*/ 01013000
*   /* NONE                                                  @Y30LB25*/ 01014000
*   /*                                                               */ 01015000
*   /*****************************************************************/ 01016000
*                                                                  0364 01017000
*RMSVIS:                            /*                       @Y30LB25*/ 01018000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 01019000
RMSVIS   ST    @14,@SA00006                                        0364 01020000
*   RESPECIFY                       /*                       @Y30LB25*/ 01021000
*     RG0 RSTD;                     /* RESTRICT REG 0        @Y30LB25*/ 01022000
*   RESPECIFY                       /*                       @Y30LB25*/ 01023000
*     RG1 RSTD;                     /* RESTRICT REG 1        @Y30LB25*/ 01024000
*   RG0=RESSHINV;                   /* RESERVE .MSVI FLAG    @Y30LB25*/ 01025000
         LA    RG0,2                                               0367 01026000
*   RG1=RPLVPTR;                    /* RPLV PTR              @Y30LB25*/ 01027000
         L     RG1,RPLVPTR                                         0368 01028000
*   CALL ICBVRR00;                  /* RESERVE .MSVI         @Y30LB25*/ 01029000
         L     @15,@CV00763                                        0369 01030000
         BALR  @14,@15                                             0369 01031000
*   RESPECIFY                       /*                       @Y30LB25*/ 01032000
*     RG0 UNRSTD;                   /* UNRESTRICT REG 0      @Y30LB25*/ 01033000
*   RESPECIFY                       /*                       @Y30LB25*/ 01034000
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @Y30LB25*/ 01035000
*   END RMSVIS;                     /*                       @Y30LB25*/ 01036000
@EL00006 DS    0H                                                  0372 01037000
@EF00006 DS    0H                                                  0372 01038000
@ER00006 L     @14,@SA00006                                        0372 01039000
         BR    @14                                                 0372 01040000
*                                                                  0373 01041000
*   /*****************************************************************/ 01042000
*   /*                                                               */ 01043000
*   /* PROCEDURE NAME - INACVOL1                             @Y30LB25*/ 01044000
*   /*                                                       @Y30LB25*/ 01045000
*   /* FUNCTION - PROCESS MOVE AN INACTIVE VOLUME BEFORE     @Y30LB25*/ 01046000
*   /* THE CALL TO THE MSC.                                  @Y30LB25*/ 01047000
*   /* AN ICBMCRT EXTENSION IS REQUIRED.                     @Y30LB25*/ 01048000
*   /* ONE IS NOT SUPPLIED THOUGH DURING USER TASK RECOVERY. @Y30LB25*/ 01049000
*   /*                                                       @Y30LB25*/ 01050000
*   /* INPUT -                                               @Y30LB25*/ 01051000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 01052000
*   /*                                                       @Y30LB25*/ 01053000
*   /* OUTPUT -                                              @Y30LB25*/ 01054000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 01055000
*   /* AN ERROR                                              @Y30LB25*/ 01056000
*   /*                                                               */ 01057000
*   /*****************************************************************/ 01058000
*                                                                  0373 01059000
*INACVOL1:                          /*                       @Y30LB25*/ 01060000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 01061000
*                                                                  0373 01062000
INACVOL1 ST    @14,@SA00007                                        0373 01063000
*   /*****************************************************************/ 01064000
*   /*                                                               */ 01065000
*   /* RESERVE .MSVI.                                        @Y30LB25*/ 01066000
*   /*                                                               */ 01067000
*   /*****************************************************************/ 01068000
*                                                                  0374 01069000
*   CALL RMSVIS;                    /* RESERVE .MSVI         @Y30LB25*/ 01070000
*                                                                  0374 01071000
         BAL   @14,RMSVIS                                          0374 01072000
*   /*****************************************************************/ 01073000
*   /*                                                               */ 01074000
*   /* READ FOR CIR TO GET TO THE CVR, DVR, OR BVR KEY.      @Y30LB25*/ 01075000
*   /* THEN GET THE MSVC RECORD FROM ITS KEY IN THE CIR -    @Y30LB25*/ 01076000
*   /* NOT FOR UPDATE.                                       @Y30LB25*/ 01077000
*   /*                                                               */ 01078000
*   /*****************************************************************/ 01079000
*                                                                  0375 01080000
*   IVOLKY=MCRTCSN;                 /* SET CIR KEY           @Y30LB25*/ 01081000
         MVC   IVOLKY(12),MCRTCSN(MCRTPTR)                         0375 01082000
*   CALL GETRECLC;                  /* GET RECORD            @Y30LB25*/ 01083000
         BAL   @14,GETRECLC                                        0376 01084000
*   IF RPLRCODE=IOERROR             /* I/O ERROR?            @Y30LB25*/ 01085000
*     THEN                          /* YES                   @Y30LB25*/ 01086000
         L     @15,RPLVPTR                                         0377 01087000
         CLC   RPLRCODE(2,@15),@CB00713                            0377 01088000
         BE    @RT00377                                            0377 01089000
*     RETURN;                       /*                       @Y30LB25*/ 01090000
*   IF RPLRCODE=NORECFND&           /* NO RECD FND WITH      @Y30LB25*/ 01091000
*       (MCRTVEXT^=FIXZERO&MCRREC=ON)/* RECORD OPTION ON?    @Y30LB25*/ 01092000
*     THEN                          /* YES                   @Y30LB25*/ 01093000
         CLC   RPLRCODE(2,@15),@CB00711                            0379 01094000
         BNE   @RF00379                                            0379 01095000
         L     @14,MCRTVEXT(,MCRTPTR)                              0379 01096000
         LTR   @14,@14                                             0379 01097000
         BZ    @RF00379                                            0379 01098000
         L     @01,MCRTEPTR                                        0379 01099000
         TM    MCRREC(@01),B'10000000'                             0379 01100000
         BNO   @RF00379                                            0379 01101000
*     DO;                           /*                       @Y30LB25*/ 01102000
*       RPLRCODE=RECDOPTN;          /* ERROR                 @Y30LB25*/ 01103000
         MVC   RPLRCODE(2,@15),@CB00733                            0381 01104000
*       RETURN;                     /*                       @Y30LB25*/ 01105000
@EL00007 DS    0H                                                  0382 01106000
@EF00007 DS    0H                                                  0382 01107000
@ER00007 L     @14,@SA00007                                        0382 01108000
         BR    @14                                                 0382 01109000
*     END;                          /*                       @Y30LB25*/ 01110000
*   IF RPLRCODE=NORECFND            /* NO RECD FND?          @Y30LB25*/ 01111000
*     THEN                          /* YES                   @Y30LB25*/ 01112000
@RF00379 L     @15,RPLVPTR                                         0384 01113000
         CLC   RPLRCODE(2,@15),@CB00711                            0384 01114000
         BNE   @RF00384                                            0384 01115000
*     DO;                           /*                       @Y30LB25*/ 01116000
*       RPLRCODE=RPLRCODE&&RPLRCODE;/* OK -                  @Y30LB25*/ 01117000
         XC    RPLRCODE(2,@15),RPLRCODE(@15)                       0386 01118000
*       RPLVRETC=RPLVRETC&&RPLVRETC;/* NO ERROR              @Y30LB25*/ 01119000
         XC    RPLVRETC(2,@15),RPLVRETC(@15)                       0387 01120000
*       RETURN;                     /*                       @Y30LB25*/ 01121000
         B     @EL00007                                            0388 01122000
*     END;                          /*                       @Y30LB25*/ 01123000
*   BCDVPTR=RPLVBUF;                /* ADDR OF MSVC RECD     @Y30LB25*/ 01124000
@RF00384 L     @01,RPLVPTR                                         0390 01125000
         L     @15,RPLVBUF(,@01)                                   0390 01126000
         ST    @15,BCDVPTR                                         0390 01127000
*   IF BCDCOPY=ON                   /* CVR?                  @Y30LB25*/ 01128000
*     THEN                          /* YES                   @Y30LB25*/ 01129000
         TM    BCDCOPY(@15),B'00010000'                            0391 01130000
         BO    @RT00391                                            0391 01131000
*     RETURN;                       /*                       @Y30LB25*/ 01132000
*                                                                  0392 01133000
*   /*****************************************************************/ 01134000
*   /*                                                               */ 01135000
*   /* PROCESS THE MOVE CARTRIDGE EXTENSION.                 @Y30LB25*/ 01136000
*   /*                                                               */ 01137000
*   /*****************************************************************/ 01138000
*                                                                  0393 01139000
*   CALL PROMCRTE;                  /* PROCESS IEZMCRTE      @Y30LB25*/ 01140000
         BAL   @14,PROMCRTE                                        0393 01141000
*   RETURN;                         /*                       @Y30LB25*/ 01142000
         B     @EL00007                                            0394 01143000
*   END INACVOL1;                   /*                       @Y30LB25*/ 01144000
         B     @EL00007                                            0395 01145000
*                                                                  0396 01146000
*   /*****************************************************************/ 01147000
*   /*                                                               */ 01148000
*   /* PROCEDURE NAME - GETRECLC                             @Y30LB25*/ 01149000
*   /*                                                       @Y30LB25*/ 01150000
*   /* FUNCTION - READ FOR A CIR USING THE INPUT CSN, THEN   @Y30LB25*/ 01151000
*   /* GET THE MSVC RECORD FROM ITS KEY IN THE CIR           @Y30LB25*/ 01152000
*   /* ALL IN THE LOCATE MODE.                               @Y30LB25*/ 01153000
*   /*                                                       @Y30LB25*/ 01154000
*   /* INPUT -                                               @Y30LB25*/ 01155000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 01156000
*   /*                                                       @Y30LB25*/ 01157000
*   /* OUTPUT -                                              @Y30LB25*/ 01158000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 01159000
*   /* AN ERROR                                              @Y30LB25*/ 01160000
*   /* BASE, COPY, OR DUPLICATE VOLUME RECORD                @Y30LB25*/ 01161000
*   /*                                                               */ 01162000
*   /*****************************************************************/ 01163000
*                                                                  0396 01164000
*GETRECLC:                          /*                       @Y30LB25*/ 01165000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 01166000
GETRECLC ST    @14,@SA00008                                        0396 01167000
*   RPLVKEY=ADDR(IKEY);             /* ADDR OF KEY           @Y30LB25*/ 01168000
         L     @15,RPLVPTR                                         0397 01169000
         LA    @14,IKEY                                            0397 01170000
         ST    @14,RPLVKEY(,@15)                                   0397 01171000
*   RPLVTYP=RPLVREAD;               /* READ                  @Y30LB25*/ 01172000
         MVI   RPLVTYP(@15),X'00'                                  0398 01173000
*   RPLVDIR=ON;                     /* DIRECT                @Y30LB25*/ 01174000
*   RPLVLOC=ON;                     /* LOCATE                @Y30LB25*/ 01175000
         OI    RPLVDIR(@15),B'11000000'                            0400 01176000
*   RPLVUPD=OFF;                    /* NO UPDATE             @Y30LB25*/ 01177000
         NI    RPLVUPD(@15),B'11111101'                            0401 01178000
*   RESPECIFY                       /*                       @Y30LB25*/ 01179000
*     RG1 RSTD;                     /* RESTRICT REG 1        @Y30LB25*/ 01180000
*   RG1=RPLVPTR;                    /* SET RPLV PTR          @Y30LB25*/ 01181000
         LR    RG1,@15                                             0403 01182000
*   CALL ICBVIO00;                  /* READ CIR              @Y30LB25*/ 01183000
         L     @15,@CV00762                                        0404 01184000
         BALR  @14,@15                                             0404 01185000
*   IF RPLVRETC^=FIXZERO            /* ERROR                 @Y30LB25*/ 01186000
*     THEN                          /* YES                   @Y30LB25*/ 01187000
         L     @15,RPLVPTR                                         0405 01188000
         LH    @00,RPLVRETC(,@15)                                  0405 01189000
         N     @00,@CF01129                                        0405 01190000
         LTR   @00,@00                                             0405 01191000
         BNZ   @RT00405                                            0405 01192000
*     RETURN;                       /*                       @Y30LB25*/ 01193000
*   INDEXPTR=RPLVBUF;               /* SET MAPPING           @Y30LB25*/ 01194000
         L     @00,RPLVBUF(,@15)                                   0407 01195000
         ST    @00,INDEXPTR                                        0407 01196000
*   BCDKEY=INDRECKY;                /* SET KEY               @Y30LB25*/ 01197000
         LR    @14,@00                                             0408 01198000
         MVC   BCDKEY(13),INDRECKY(@14)                            0408 01199000
*   RPLVKEY=ADDR(BCDKEY);           /* SET KEY ADDR          @Y30LB25*/ 01200000
         LA    @00,BCDKEY                                          0409 01201000
         ST    @00,RPLVKEY(,@15)                                   0409 01202000
*   CALL ICBVIO00;                  /* READ RECORD           @Y30LB25*/ 01203000
         L     @15,@CV00762                                        0410 01204000
         BALR  @14,@15                                             0410 01205000
*   RESPECIFY                       /*                       @Y30LB25*/ 01206000
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @Y30LB25*/ 01207000
*   RETURN;                         /*                       @Y30LB25*/ 01208000
@EL00008 DS    0H                                                  0412 01209000
@EF00008 DS    0H                                                  0412 01210000
@ER00008 L     @14,@SA00008                                        0412 01211000
         BR    @14                                                 0412 01212000
*   END GETRECLC;                   /*                       @Y30LB25*/ 01213000
         B     @EL00008                                            0413 01214000
*                                                                  0414 01215000
*   /*****************************************************************/ 01216000
*   /*                                                               */ 01217000
*   /* PROCEDURE NAME - INACVOL2                             @Y30LB25*/ 01218000
*   /*                                                       @Y30LB25*/ 01219000
*   /* FUNCTION - PROCESS MOVE AN INACTIVE VOLUME AFTER      @Y30LB25*/ 01220000
*   /* THE CALL TO THE MSC.                                  @Y30LB25*/ 01221000
*   /* AN ICBMCRT EXTENSION IS REQUIRED.                     @Y30LB25*/ 01222000
*   /* ONE IS NOT SUPPLIED THOUGH DURING USER TASK RECOVERY  @Y30LB25*/ 01223000
*   /*                                                       @Y30LB25*/ 01224000
*   /* INPUT -                                               @Y30LB25*/ 01225000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 01226000
*   /*                                                       @Y30LB25*/ 01227000
*   /* OUTPUT -                                              @Y30LB25*/ 01228000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 01229000
*   /* AN ERROR                                              @Y30LB25*/ 01230000
*   /* BASE, COPY, OR DUPLICATE VOLUME RECORD                @Y30LB25*/ 01231000
*   /*                                                               */ 01232000
*   /*****************************************************************/ 01233000
*                                                                  0414 01234000
*INACVOL2:                          /*                       @Y30LB25*/ 01235000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 01236000
*                                                                  0414 01237000
INACVOL2 ST    @14,@SA00009                                        0414 01238000
*   /*****************************************************************/ 01239000
*   /*                                                               */ 01240000
*   /* CHECK FOR AN MSC ERRROR OTHER THAT ONE                @VS32198*/ 01241000
*   /* CARTRIDGE EJECTED.                                    @VS32198*/ 01242000
*   /*                                                               */ 01243000
*   /*****************************************************************/ 01244000
*                                                                  0415 01245000
*   IF RPLRCODE^=EJEC1CRT&RPLVRETC^=FIXZERO/* MSC ERROR?     @ZA13487*/ 01246000
*     THEN                          /* YES                   @Y30LB25*/ 01247000
         L     @15,RPLVPTR                                         0415 01248000
         CLC   RPLRCODE(2,@15),@CB00701                            0415 01249000
         BE    @RF00415                                            0415 01250000
         LH    @14,RPLVRETC(,@15)                                  0415 01251000
         N     @14,@CF01129                                        0415 01252000
         LTR   @14,@14                                             0415 01253000
         BZ    @RF00415                                            0415 01254000
*     DO;                           /*                       @VS32198*/ 01255000
*       RPLVRETC=RPLVRETC&&RPLVRETC;/* ZERO RETN CODE        @VS32198*/ 01256000
         XC    RPLVRETC(2,@15),RPLVRETC(@15)                       0417 01257000
*       RPLRCODE=RPLRCODE&&RPLRCODE;/* ZERO RESN CODE        @VS32198*/ 01258000
         XC    RPLRCODE(2,@15),RPLRCODE(@15)                       0418 01259000
*       RETURN;                     /*                       @VS32198*/ 01260000
@EL00009 DS    0H                                                  0419 01261000
@EF00009 DS    0H                                                  0419 01262000
@ER00009 L     @14,@SA00009                                        0419 01263000
         BR    @14                                                 0419 01264000
*     END;                          /*                       @VS32198*/ 01265000
*   CALL HOUSKEEP;                  /* JRNL RPLV &           @VS32198   01266000
*                                      RESERVE .MSVI         @VS32198*/ 01267000
*                                                                  0421 01268000
@RF00415 BAL   @14,HOUSKEEP                                        0421 01269000
*   /*****************************************************************/ 01270000
*   /*                                                               */ 01271000
*   /* ONE CARTRIDGE EJECTED IS OK.                          @VS32198*/ 01272000
*   /*                                                               */ 01273000
*   /*****************************************************************/ 01274000
*                                                                  0422 01275000
*   IF RPLRCODE=EJEC1CRT            /* 1 CART EJECTED?       @VS32198*/ 01276000
*     THEN                          /* YES                   @VS32198*/ 01277000
         L     @15,RPLVPTR                                         0422 01278000
         CLC   RPLRCODE(2,@15),@CB00701                            0422 01279000
         BNE   @RF00422                                            0422 01280000
*     DO;                           /* OK                    @VS32198*/ 01281000
*       REACODE=RPLRCODE;           /* SAVE REASON CODE      @VS32198*/ 01282000
         MVC   REACODE(2),RPLRCODE(@15)                            0424 01283000
*       RPLVRETC=RPLVRETC&&RPLVRETC;/* ZERO RETN CODE        @Y30LB25*/ 01284000
         XC    RPLVRETC(2,@15),RPLVRETC(@15)                       0425 01285000
*       RPLRCODE=RPLRCODE&&RPLRCODE;/* ZERO RESN CODE        @Y30LB25*/ 01286000
         XC    RPLRCODE(2,@15),RPLRCODE(@15)                       0426 01287000
*     END;                          /*                       @VS32198*/ 01288000
*                                                                  0427 01289000
*   /*****************************************************************/ 01290000
*   /*                                                               */ 01291000
*   /* READ FOR CIR TO GET THE CVR, BVR, OR DVR KEY.         @Y30LB25*/ 01292000
*   /* THEN GET THE MSVC RECORD FROM ITS KEY IN THE CIR -    @Y30LB25*/ 01293000
*   /* FOR UPDATE                                            @Y30LB25*/ 01294000
*   /*                                                               */ 01295000
*   /*****************************************************************/ 01296000
*                                                                  0428 01297000
*   IVOLKY=MCRTCSN;                 /* SET CIR KEY           @Y30LB25*/ 01298000
@RF00422 MVC   IVOLKY(12),MCRTCSN(MCRTPTR)                         0428 01299000
*   CALL GETRECUD;                  /* GET RECORD            @Y30LB25*/ 01300000
         BAL   @14,GETRECUD                                        0429 01301000
*   IF RPLRCODE=IOERROR             /* I/O ERROR?            @Y30LB25*/ 01302000
*     THEN                          /* YES                   @Y30LB25*/ 01303000
         L     @15,RPLVPTR                                         0430 01304000
         CLC   RPLRCODE(2,@15),@CB00713                            0430 01305000
         BE    @RT00430                                            0430 01306000
*     RETURN;                       /*                       @Y30LB25*/ 01307000
*   IF RPLRCODE=NORECFND            /* NO RECD FND?          @Y30LB25*/ 01308000
*     THEN                          /* YES                   @Y30LB25*/ 01309000
         CLC   RPLRCODE(2,@15),@CB00711                            0432 01310000
         BNE   @RF00432                                            0432 01311000
*     DO;                           /*                       @Y30LB25*/ 01312000
*       RPLRCODE=RPLRCODE&&RPLRCODE;/* OK -                  @Y30LB25*/ 01313000
         XC    RPLRCODE(2,@15),RPLRCODE(@15)                       0434 01314000
*       RPLVRETC=RPLVRETC&&RPLVRETC;/* NO ERROR              @Y30LB25*/ 01315000
         XC    RPLVRETC(2,@15),RPLVRETC(@15)                       0435 01316000
*       RETURN;                     /*                       @Y30LB25*/ 01317000
         B     @EL00009                                            0436 01318000
*     END;                          /*                       @Y30LB25*/ 01319000
*                                                                  0437 01320000
*   /*****************************************************************/ 01321000
*   /*                                                               */ 01322000
*   /* PROCESS MCRTE                                         @Y30LB25*/ 01323000
*   /*                                                               */ 01324000
*   /*****************************************************************/ 01325000
*                                                                  0438 01326000
*   BCDVPTR=BASEVPTR;               /* ADDR OF MSVC RECD     @Y30LB25*/ 01327000
@RF00432 L     @15,BASEVPTR                                        0438 01328000
         ST    @15,BCDVPTR                                         0438 01329000
*   INDEXPTR=ADDR(INDEXBUF);        /* RESET BUF PTR         @Y30LB25*/ 01330000
         LA    @15,INDEXBUF                                        0439 01331000
         ST    @15,INDEXPTR                                        0439 01332000
*   CALL PROMCRTE;                  /* PROCESS IEZMCRTE      @Y30LB25*/ 01333000
         BAL   @14,PROMCRTE                                        0440 01334000
*   RETURN;                         /*                       @Y30LB25*/ 01335000
         B     @EL00009                                            0441 01336000
*   END INACVOL2;                   /*                       @Y30LB25*/ 01337000
         B     @EL00009                                            0442 01338000
*                                                                  0443 01339000
*   /*****************************************************************/ 01340000
*   /*                                                               */ 01341000
*   /* PROCEDURE NAME - HOUSKEEP                             @Y30LB25*/ 01342000
*   /*                                                       @Y30LB25*/ 01343000
*   /* FUNCTION-                                             @Y30LB25*/ 01344000
*   /* JOURNALS THE RPLV AND RESERVES .MSVI FOR PROCESSING   @Y30LB25*/ 01345000
*   /* AFTER THE MSC IS DONE.                                @Y30LB25*/ 01346000
*   /*                                                       @Y30LB25*/ 01347000
*   /* INPUT -                                               @Y30LB25*/ 01348000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 01349000
*   /*                                                       @Y30LB25*/ 01350000
*   /* OUTPUT -                                              @Y30LB25*/ 01351000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 01352000
*   /* AN ERROR                                              @Y30LB25*/ 01353000
*   /*                                                               */ 01354000
*   /*****************************************************************/ 01355000
*                                                                  0443 01356000
*HOUSKEEP:                          /*                       @Y30LB25*/ 01357000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 01358000
*                                                                  0443 01359000
HOUSKEEP ST    @14,@SA00010                                        0443 01360000
*   /*****************************************************************/ 01361000
*   /*                                                               */ 01362000
*   /* JOURNAL THE RPLV                                      @Y30LB25*/ 01363000
*   /*                                                               */ 01364000
*   /*****************************************************************/ 01365000
*                                                                  0444 01366000
*   RETCODE=RPLVRETC;               /* SAVE RETN CODE        @VS32192*/ 01367000
         L     @15,RPLVPTR                                         0444 01368000
         MVC   RETCODE(2),RPLVRETC(@15)                            0444 01369000
*   REACODE=RPLRCODE;               /* SAVE RESN CODE        @VS32192*/ 01370000
         MVC   REACODE(2),RPLRCODE(@15)                            0445 01371000
*   CALL JRNLRPLV;                  /* JOURNAL RPLV          @Y30LB25*/ 01372000
*                                                                  0446 01373000
         BAL   @14,JRNLRPLV                                        0446 01374000
*   /*****************************************************************/ 01375000
*   /*                                                               */ 01376000
*   /* RESERVE .MSVI.                                        @Y30LB25*/ 01377000
*   /*                                                               */ 01378000
*   /*****************************************************************/ 01379000
*                                                                  0447 01380000
*   CALL RMSVI;                     /* RESERVE MSVI          @Y30LB25*/ 01381000
         BAL   @14,RMSVI                                           0447 01382000
*   RPLVRETC=RETCODE;               /* REST RETN CODE        @VS32192*/ 01383000
         L     @15,RPLVPTR                                         0448 01384000
         MVC   RPLVRETC(2,@15),RETCODE                             0448 01385000
*   RPLRCODE=REACODE;               /* REST RESN CODE        @VS32192*/ 01386000
         MVC   RPLRCODE(2,@15),REACODE                             0449 01387000
*   RETURN;                         /*                       #Y30LB25*/ 01388000
@EL00010 DS    0H                                                  0450 01389000
@EF00010 DS    0H                                                  0450 01390000
@ER00010 L     @14,@SA00010                                        0450 01391000
         BR    @14                                                 0450 01392000
*   END HOUSKEEP;                   /*                       #Y30LB25*/ 01393000
*                                                                  0452 01394000
*   /*****************************************************************/ 01395000
*   /*                                                               */ 01396000
*   /* PROCEDURE NAME - GETRECUD                             @Y30LB25*/ 01397000
*   /*                                                       @Y30LB25*/ 01398000
*   /* FUNCTION - READ A CIR IN THE LOCATE MODE USING        @Y30LB25*/ 01399000
*   /* THE INPUT CSN, GET THE MSVC RECORD FOR UPDATE         @Y30LB25*/ 01400000
*   /* FROM ITS KEY IN THE CIR.                              @Y30LB25*/ 01401000
*   /*                                                       @Y30LB25*/ 01402000
*   /* INPUT -                                               @Y30LB25*/ 01403000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 01404000
*   /*                                                       @Y30LB25*/ 01405000
*   /* OUTPUT -                                              @Y30LB25*/ 01406000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 01407000
*   /* AN ERROR                                              @Y30LB25*/ 01408000
*   /* BASE, COPY, OR DUPLICATE VOLUME RECORD                @Y30LB25*/ 01409000
*   /*                                                               */ 01410000
*   /*****************************************************************/ 01411000
*                                                                  0452 01412000
*GETRECUD:                          /*                       @Y30LB25*/ 01413000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 01414000
GETRECUD ST    @14,@SA00011                                        0452 01415000
*   RPLVKEY=ADDR(IKEY);             /* ADDR OF KEY           @Y30LB25*/ 01416000
         L     @15,RPLVPTR                                         0453 01417000
         LA    @14,IKEY                                            0453 01418000
         ST    @14,RPLVKEY(,@15)                                   0453 01419000
*   RPLVTYP=RPLVREAD;               /* READ                  @Y30LB25*/ 01420000
         MVI   RPLVTYP(@15),X'00'                                  0454 01421000
*   RPLVDIR=ON;                     /* DIRECT                @Y30LB25*/ 01422000
*   RPLVLOC=ON;                     /* LOCATE                @Y30LB25*/ 01423000
         OI    RPLVDIR(@15),B'11000000'                            0456 01424000
*   RPLVUPD=OFF;                    /* NO UPDATE             @Y30LB25*/ 01425000
         NI    RPLVUPD(@15),B'11111101'                            0457 01426000
*   RESPECIFY                       /*                       @Y30LB25*/ 01427000
*     RG1 RSTD;                     /* RESTRICT REG 1        @Y30LB25*/ 01428000
*   RG1=RPLVPTR;                    /* SET RPLV PTR          @Y30LB25*/ 01429000
         LR    RG1,@15                                             0459 01430000
*   CALL ICBVIO00;                  /* READ CIR              @Y30LB25*/ 01431000
         L     @15,@CV00762                                        0460 01432000
         BALR  @14,@15                                             0460 01433000
*   IF RPLVRETC^=FIXZERO            /* ERROR                 @Y30LB25*/ 01434000
*     THEN                          /* YES                   @Y30LB25*/ 01435000
         L     @15,RPLVPTR                                         0461 01436000
         LH    @00,RPLVRETC(,@15)                                  0461 01437000
         N     @00,@CF01129                                        0461 01438000
         LTR   @00,@00                                             0461 01439000
         BNZ   @RT00461                                            0461 01440000
*     RETURN;                       /*                       @Y30LB25*/ 01441000
*   INDEXPTR=RPLVBUF;               /* SET MAPPING           @Y30LB25*/ 01442000
         L     @00,RPLVBUF(,@15)                                   0463 01443000
         ST    @00,INDEXPTR                                        0463 01444000
*   BCDKEY=INDRECKY;                /* SET KEY               @Y30LB25*/ 01445000
         LR    @14,@00                                             0464 01446000
         MVC   BCDKEY(13),INDRECKY(@14)                            0464 01447000
*   RPLVKEY=ADDR(BCDKEY);           /* SET KEY ADDR          @Y30LB25*/ 01448000
         LA    @00,BCDKEY                                          0465 01449000
         ST    @00,RPLVKEY(,@15)                                   0465 01450000
*   RPLVLOC=OFF;                    /* NO LOCATE             @Y30LB25*/ 01451000
         NI    RPLVLOC(@15),B'01111111'                            0466 01452000
*   RPLVUPD=ON;                     /* UPDATE                @Y30LB25*/ 01453000
         OI    RPLVUPD(@15),B'00000010'                            0467 01454000
*   RPLVBUF=ADDR(BASEBUF);          /* BUF ADDR              @Y30LB25*/ 01455000
         LA    @00,BASEBUF                                         0468 01456000
         ST    @00,RPLVBUF(,@15)                                   0468 01457000
*   RPLVBLN=LENGTH(BASEBUF);        /* BUFF LENGTH           @Y30LB25*/ 01458000
         MVC   RPLVBLN(4,@15),@CF01103                             0469 01459000
*   CALL ICBVIO00;                  /* READ RECORD           @Y30LB25*/ 01460000
         L     @15,@CV00762                                        0470 01461000
         BALR  @14,@15                                             0470 01462000
*   RESPECIFY                       /*                       @Y30LB25*/ 01463000
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @Y30LB25*/ 01464000
*   RETURN;                         /*                       @Y30LB25*/ 01465000
@EL00011 DS    0H                                                  0472 01466000
@EF00011 DS    0H                                                  0472 01467000
@ER00011 L     @14,@SA00011                                        0472 01468000
         BR    @14                                                 0472 01469000
*   END GETRECUD;                   /*                       @Y30LB25*/ 01470000
         B     @EL00011                                            0473 01471000
*                                                                  0474 01472000
*   /*****************************************************************/ 01473000
*   /*                                                               */ 01474000
*   /* PROCEDURE NAME - PROMCRTE                             @Y30LB25*/ 01475000
*   /*                                                       @Y30LB25*/ 01476000
*   /* FUNCTION - PROCESS IEZMCRTE.                          @Y30LB25*/ 01477000
*   /*                                                       @Y30LB25*/ 01478000
*   /* INPUT -                                               @Y30LB25*/ 01479000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 01480000
*   /*                                                       @Y30LB25*/ 01481000
*   /* OUTPUT -                                              @Y30LB25*/ 01482000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 01483000
*   /* AN ERROR                                              @Y30LB25*/ 01484000
*   /* BASE, COPY, OR DUPLICATE VOLUME RECORD                @Y30LB25*/ 01485000
*   /*                                                               */ 01486000
*   /*****************************************************************/ 01487000
*                                                                  0474 01488000
*PROMCRTE:                          /*                       @Y30LB25*/ 01489000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 01490000
*                                                                  0474 01491000
PROMCRTE ST    @14,@SA00012                                        0474 01492000
*   /*****************************************************************/ 01493000
*   /*                                                               */ 01494000
*   /* CHECK FOR BEFORE THE CALL TO THE MSC.                 @Y30LB25*/ 01495000
*   /*                                                               */ 01496000
*   /*****************************************************************/ 01497000
*                                                                  0475 01498000
*   IF RPLFTIME=OFF                 /* BEFORE MSC CALL?      @Y30LB25*/ 01499000
*     THEN                          /* YES                   @Y30LB25*/ 01500000
         L     @15,RPLVPTR                                         0475 01501000
         TM    RPLFTIME(@15),B'10000000'                           0475 01502000
         BNZ   @RF00475                                            0475 01503000
*     DO;                           /*                       @Y30LB25*/ 01504000
*                                                                  0476 01505000
*       /*************************************************************/ 01506000
*       /*                                                           */ 01507000
*       /* CHECK FOR DVR WITH KEEP RECORD OPTION ON.         @Y30LB25*/ 01508000
*       /*                                                           */ 01509000
*       /*************************************************************/ 01510000
*                                                                  0477 01511000
*       IF BCDDUP=ON&               /* DVR WITH RECORD       @Y30LB25*/ 01512000
*           (MCRTVEXT^=FIXZERO&MCRREC=ON)/* OPTION ON?       @Y30LB25*/ 01513000
*         THEN                      /* YES                   @Y30LB25*/ 01514000
         L     @01,BCDVPTR                                         0477 01515000
         TM    BCDDUP(@01),B'00000100'                             0477 01516000
         BNO   @RF00477                                            0477 01517000
         L     @14,MCRTVEXT(,MCRTPTR)                              0477 01518000
         LTR   @14,@14                                             0477 01519000
         BZ    @RF00477                                            0477 01520000
         L     @01,MCRTEPTR                                        0477 01521000
         TM    MCRREC(@01),B'10000000'                             0477 01522000
         BNO   @RF00477                                            0477 01523000
*         DO;                       /*                       @Y30LB25*/ 01524000
*           RPLVRETC=FIXFOUR;       /* ERROR RETURN CODE     @Y30LB25*/ 01525000
         MVC   RPLVRETC(2,@15),@CH00041                            0479 01526000
*           RPLRCODE=RECOPDVR;      /* ERROR REASON CODE     @Y30LB25*/ 01527000
         MVC   RPLRCODE(2,@15),@CB00717                            0480 01528000
*           RETURN;                 /*                       @Y30LB25*/ 01529000
@EL00012 DS    0H                                                  0481 01530000
@EF00012 DS    0H                                                  0481 01531000
@ER00012 L     @14,@SA00012                                        0481 01532000
         BR    @14                                                 0481 01533000
*         END;                      /*                       @Y30LB25*/ 01534000
*                                                                  0482 01535000
*       /*************************************************************/ 01536000
*       /*                                                           */ 01537000
*       /* CHECK FOR BVR WITH COPIES, BUT KEEP RECORD        @Y30LB25*/ 01538000
*       /* OPTION OFF.                                       @Y30LB25*/ 01539000
*       /*                                                           */ 01540000
*       /*************************************************************/ 01541000
*                                                                  0483 01542000
*       BASEVPTR=RPLVBUF;           /* MAP BVR               @Y30LB25*/ 01543000
@RF00477 L     @15,RPLVPTR                                         0483 01544000
         L     @14,RPLVBUF(,@15)                                   0483 01545000
         ST    @14,BASEVPTR                                        0483 01546000
*       IF BCDBASE=ON&(MCRTVEXT^=FIXZERO&MCRREC=OFF)&BASNCOPY^=FIXZERO  01547000
*                                   /* BVR, RECORD OPTN      @Y30LB25   01548000
*                                      OFF, - WITH CPYS?     @Y30LB25*/ 01549000
*         THEN                      /* YES                   @Y30LB25*/ 01550000
         L     @01,BCDVPTR                                         0484 01551000
         TM    BCDBASE(@01),B'00100000'                            0484 01552000
         BNO   @RF00484                                            0484 01553000
         L     @05,MCRTVEXT(,MCRTPTR)                              0484 01554000
         LTR   @05,@05                                             0484 01555000
         BZ    @RF00484                                            0484 01556000
         L     @01,MCRTEPTR                                        0484 01557000
         TM    MCRREC(@01),B'10000000'                             0484 01558000
         BNZ   @RF00484                                            0484 01559000
         CLI   BASNCOPY(@14),0                                     0484 01560000
         BE    @RF00484                                            0484 01561000
*         DO;                       /*                       @Y30LB25*/ 01562000
*           RPLVRETC=FIXFOUR;       /* ERROR RETURN CODE     @Y30LB25*/ 01563000
         MVC   RPLVRETC(2,@15),@CH00041                            0486 01564000
*           RPLRCODE=RECOPBVR;      /* ERROR REASON CODE     @Y30LB25*/ 01565000
         MVC   RPLRCODE(2,@15),@CB00719                            0487 01566000
*           RETURN;                 /*                       @Y30LB25*/ 01567000
         B     @EL00012                                            0488 01568000
*         END;                      /*                       @Y30LB25*/ 01569000
*                                                                  0489 01570000
*       /*************************************************************/ 01571000
*       /*                                                           */ 01572000
*       /* CHECK FOR REASSIGNED BVR.                         @Y30LB25*/ 01573000
*       /*                                                           */ 01574000
*       /*************************************************************/ 01575000
*                                                                  0490 01576000
*       IF BCDBASE=ON&BASREASS=ON   /* REASS BVR?            @Y30LB25*/ 01577000
*         THEN                      /* YES                   @Y30LB25*/ 01578000
@RF00484 L     @06,BCDVPTR                                         0490 01579000
         TM    BCDBASE(@06),B'00100000'                            0490 01580000
         BNO   @RF00490                                            0490 01581000
         L     @06,BASEVPTR                                        0490 01582000
         TM    BASREASS(@06),B'00100000'                           0490 01583000
         BNO   @RF00490                                            0490 01584000
*         DO;                       /*                       @Y30LB25*/ 01585000
*           RPLVRETC=FIXFOUR;       /* ERROR RETN CODE       @Y30LB25*/ 01586000
         L     @06,RPLVPTR                                         0492 01587000
         MVC   RPLVRETC(2,@06),@CH00041                            0492 01588000
*           RPLRCODE=REASSIGN;      /* REASSIGNED            @Y30LB25*/ 01589000
         MVC   RPLRCODE(2,@06),@CB00737                            0493 01590000
*         END;                      /*                       @Y30LB25*/ 01591000
*       RETURN;                     /*                       @Y30LB25*/ 01592000
         B     @EL00012                                            0495 01593000
*     END;                          /*                       @Y30LB25*/ 01594000
*                                                                  0496 01595000
*   /*****************************************************************/ 01596000
*   /*                                                               */ 01597000
*   /* PROCESSING AFTER THE MSC WAS CALLED.                  @Y30LB25*/ 01598000
*   /*                                                               */ 01599000
*   /*****************************************************************/ 01600000
*                                                                  0497 01601000
*   ELSE                            /* AFTER MSC CALL        @Y30LB25*/ 01602000
*     DO;                           /*                       @Y30LB25*/ 01603000
*                                                                  0497 01604000
@RF00475 DS    0H                                                  0498 01605000
*       /*************************************************************/ 01606000
*       /*                                                           */ 01607000
*       /* CHECK KEEP RECORD OPTION                          @Y30LB25*/ 01608000
*       /*                                                           */ 01609000
*       /*************************************************************/ 01610000
*                                                                  0498 01611000
*       IF(MCRTVEXT^=FIXZERO&MCRREC=ON)|MCRTVEXT=FIXZERO/* KEEP RECD    01612000
*                                      OPT ON?               @Y30LB25*/ 01613000
*         THEN                      /* YES                   @Y30LB25*/ 01614000
         L     @15,MCRTVEXT(,MCRTPTR)                              0498 01615000
         LTR   @15,@15                                             0498 01616000
         BZ    @GL00011                                            0498 01617000
         L     @01,MCRTEPTR                                        0498 01618000
         TM    MCRREC(@01),B'10000000'                             0498 01619000
         BO    @RT00498                                            0498 01620000
@GL00011 L     @15,MCRTVEXT(,MCRTPTR)                              0498 01621000
         LTR   @15,@15                                             0498 01622000
         BNZ   @RF00498                                            0498 01623000
@RT00498 DS    0H                                                  0499 01624000
*         DO;                       /*                       @Y30LB25*/ 01625000
*                                                                  0499 01626000
*           /*********************************************************/ 01627000
*           /*                                                       */ 01628000
*           /* NULL LIB ID FIELD(S).                         @Y30LB25*/ 01629000
*           /*                                                       */ 01630000
*           /*********************************************************/ 01631000
*                                                                  0500 01632000
*           IF REACODE=EJEC1CRT     /* 1 CART EJECTED?       @Y30LB25*/ 01633000
*             THEN                  /* YES                   @Y30LB25*/ 01634000
         CLC   REACODE(2),@CB00701                                 0500 01635000
         BNE   @RF00500                                            0500 01636000
*             BCDLIB1=FIX1F;        /* NULL LIBID1           @Y30LB25*/ 01637000
         L     @01,BCDVPTR                                         0501 01638000
         MVI   BCDLIB1(@01),X'FF'                                  0501 01639000
*           ELSE                    /*                       @Y30LB25*/ 01640000
*             DO;                   /* 2 CARTS EJSCTED       @Y30LB25*/ 01641000
         B     @RC00500                                            0502 01642000
@RF00500 DS    0H                                                  0503 01643000
*               BCDLIB1=FIX1F;      /*                       @Y30LB25   01644000
*                                      NULL LIBID1           @Y30LB25*/ 01645000
         L     @15,BCDVPTR                                         0503 01646000
         MVI   BCDLIB1(@15),X'FF'                                  0503 01647000
*               BCDLIB2=FIX1F;      /*                       @Y30LB25   01648000
*                                      NULL LIBID2           @Y30LB25*/ 01649000
         MVI   BCDLIB2(@15),X'FF'                                  0504 01650000
*             END;                  /*                       @Y30LB25*/ 01651000
*                                                                  0505 01652000
*           /*********************************************************/ 01653000
*           /*                                                       */ 01654000
*           /* CHECK FOR RECOVERY RPLV AND IF SO USE THE     @ZA13484*/ 01655000
*           /* DATE THE RPLV WAS CREATED.                    @ZA13484*/ 01656000
*           /*                                                       */ 01657000
*           /*********************************************************/ 01658000
*                                                                  0506 01659000
*           IF RPLJRCVY=ON&RPLVDATE^=NULLDATE THEN/* RECOVERY?     0506 01660000
*                                                            @ZA13484*/ 01661000
@RC00500 L     @15,RPLVPTR                                         0506 01662000
         TM    RPLJRCVY(@15),B'00000010'                           0506 01663000
         BNO   @RF00506                                            0506 01664000
         CLC   RPLVDATE(4,@15),NULLDATE                            0506 01665000
         BE    @RF00506                                            0506 01666000
*             DO;                   /* YES                   @ZA13484*/ 01667000
*               IF BCDCOPY=ON THEN  /* CVR?                  @ZA13484*/ 01668000
         L     @06,BCDVPTR                                         0508 01669000
         TM    BCDCOPY(@06),B'00010000'                            0508 01670000
         BNO   @RF00508                                            0508 01671000
*                 DO;               /* YES                   @ZA13484*/ 01672000
*                   COPYVPTR=BCDVPTR;/* SET CVR PTR          @ZA13484*/ 01673000
         ST    @06,COPYVPTR                                        0510 01674000
*                   COPDTREM=RPLVDATE;/* SET DATE            @ZA13484*/ 01675000
         MVC   COPDTREM(4,@06),RPLVDATE(@15)                       0511 01676000
*                 END;              /*                       @ZA13484*/ 01677000
*               IF BCDBASE=ON THEN  /* BVR?                  @ZA13484*/ 01678000
@RF00508 L     @06,BCDVPTR                                         0513 01679000
         TM    BCDBASE(@06),B'00100000'                            0513 01680000
         BNO   @RF00513                                            0513 01681000
*                 BASDTREM=RPLVDATE;/* SET DATE              @ZA13484*/ 01682000
         L     @06,BASEVPTR                                        0514 01683000
         L     @01,RPLVPTR                                         0514 01684000
         MVC   BASDTREM(4,@06),RPLVDATE(@01)                       0514 01685000
*             END;                  /*                       @ZA13484*/ 01686000
*           ELSE                                                   0516 01687000
*             DO;                   /*                       @ZA13484*/ 01688000
*                                                                  0516 01689000
         B     @RC00506                                            0516 01690000
@RF00506 DS    0H                                                  0517 01691000
*               /*****************************************************/ 01692000
*               /*                                                   */ 01693000
*               /* UPDATE THE LOCATION AND EJECT DATE.       @Y30LB25*/ 01694000
*               /* GET AND SET THE CURRENT DATE              @Y30LB25*/ 01695000
*               /*                                                   */ 01696000
*               /*****************************************************/ 01697000
*                                                                  0517 01698000
*               CALL ICBVUEXP(FIXZERO,RPLVPTR,EXPRDT);/*     @ZA30662   01699000
*                                      GET CURRENT DATE      @Y30LB25*/ 01700000
         L     @15,@CV00768                                        0517 01701000
         LA    @01,@AL00517                                        0517 01702000
         BALR  @14,@15                                             0517 01703000
*               IF BCDCOPY=ON       /* CVR LOCATION?         @Y30LB25*/ 01704000
*                 THEN              /* YES                   @Y30LB25*/ 01705000
         L     @15,BCDVPTR                                         0518 01706000
         TM    BCDCOPY(@15),B'00010000'                            0518 01707000
         BNO   @RF00518                                            0518 01708000
*                 DO;               /*                       @Y30LB25*/ 01709000
*                   COPYVPTR=BCDVPTR;/*                      @Y30LB25   01710000
*                                      ADDR CVR              @Y30LB25*/ 01711000
         ST    @15,COPYVPTR                                        0520 01712000
*                   IF MCRTVEXT^=FIXZERO&MCRSPLOC=ON THEN          0521 01713000
         L     @14,MCRTVEXT(,MCRTPTR)                              0521 01714000
         LTR   @14,@14                                             0521 01715000
         BZ    @RF00521                                            0521 01716000
         L     @14,MCRTEPTR                                        0521 01717000
         TM    MCRSPLOC(@14),B'10000000'                           0521 01718000
         BNO   @RF00521                                            0521 01719000
*                     COPDEST=MCRLOC;/* UPDATE DESTIN        @Y30LB25*/ 01720000
         MVC   COPDEST(30,@15),MCRLOC(@14)                         0522 01721000
*                   COPDTREM=EXPRDT;/*                       @Y30LB25   01722000
*                                      SET EJECT DATE        @Y30LB25*/ 01723000
@RF00521 L     @01,COPYVPTR                                        0523 01724000
         MVC   COPDTREM(4,@01),EXPRDT                              0523 01725000
*                 END;              /*                       @Y30LB25*/ 01726000
*               IF BCDBASE=ON       /* BVR LOCATION?         @Y30LB25*/ 01727000
*                 THEN              /* YES                   @Y30LB25*/ 01728000
@RF00518 L     @01,BCDVPTR                                         0525 01729000
         TM    BCDBASE(@01),B'00100000'                            0525 01730000
         BNO   @RF00525                                            0525 01731000
*                 DO;               /*                       @Y30LB25*/ 01732000
*                   IF MCRTVEXT^=FIXZERO&MCRSPLOC=ON THEN          0527 01733000
         L     @15,MCRTVEXT(,MCRTPTR)                              0527 01734000
         LTR   @15,@15                                             0527 01735000
         BZ    @RF00527                                            0527 01736000
         L     @15,MCRTEPTR                                        0527 01737000
         TM    MCRSPLOC(@15),B'10000000'                           0527 01738000
         BNO   @RF00527                                            0527 01739000
*                     BASDEST=MCRLOC;/* UPDATE DESTIN        @Y30LB25*/ 01740000
         L     @06,BASEVPTR                                        0528 01741000
         MVC   BASDEST(30,@06),MCRLOC(@15)                         0528 01742000
*                   BASDTREM=EXPRDT;/*                       @Y30LB25   01743000
*                                      SET EJECT DATE        @Y30LB25*/ 01744000
@RF00527 L     @06,BASEVPTR                                        0529 01745000
         MVC   BASDTREM(4,@06),EXPRDT                              0529 01746000
*                 END;              /*                       @Y30LB25*/ 01747000
*             END;                  /*                       @ZA13484*/ 01748000
*                                                                  0531 01749000
@RF00525 DS    0H                                                  0532 01750000
*           /*********************************************************/ 01751000
*           /*                                                       */ 01752000
*           /* WRITE THE BVR OR CVR.                         @Y30LB25*/ 01753000
*           /*                                                       */ 01754000
*           /*********************************************************/ 01755000
*                                                                  0532 01756000
*           CALL WRITRECD;          /* WRITE BVR OR CVR      @Y30LB25*/ 01757000
@RC00506 BAL   @14,WRITRECD                                        0532 01758000
*           RETURN;                 /*                       @Y30LB25*/ 01759000
         B     @EL00012                                            0533 01760000
*         END;                      /*                       @Y30LB25*/ 01761000
*                                                                  0534 01762000
*       /*************************************************************/ 01763000
*       /*                                                           */ 01764000
*       /* KEEP RECORD OPTION IS OFF.                        @Y30LB25*/ 01765000
*       /*                                                           */ 01766000
*       /*************************************************************/ 01767000
*                                                                  0535 01768000
*       ELSE                        /* KEEP RECORD           @Y30LB25   01769000
*                                      OPTION IS OFF         @Y30LB25*/ 01770000
*         DO;                       /*                       @Y30LB25*/ 01771000
*                                                                  0535 01772000
@RF00498 DS    0H                                                  0536 01773000
*           /*********************************************************/ 01774000
*           /*                                                       */ 01775000
*           /* NULL LIB ID FIELD(S).                         @Y30LB25*/ 01776000
*           /*                                                       */ 01777000
*           /*********************************************************/ 01778000
*                                                                  0536 01779000
*           IF REACODE=EJEC1CRT     /* 1 CART EJECTED?       @Y30LB25*/ 01780000
*             THEN                  /* YES                   @Y30LB25*/ 01781000
         CLC   REACODE(2),@CB00701                                 0536 01782000
         BNE   @RF00536                                            0536 01783000
*             BCDLIB1=FIX1F;        /* NULL LIBID1           @Y30LB25*/ 01784000
         L     @06,BCDVPTR                                         0537 01785000
         MVI   BCDLIB1(@06),X'FF'                                  0537 01786000
*           ELSE                    /*                       @Y30LB25*/ 01787000
*             DO;                   /* 2 CARTS EJSCTED       @Y30LB25*/ 01788000
         B     @RC00536                                            0538 01789000
@RF00536 DS    0H                                                  0539 01790000
*               BCDLIB1=FIX1F;      /*                       @Y30LB25   01791000
*                                      NULL LIBID1           @Y30LB25*/ 01792000
         L     @06,BCDVPTR                                         0539 01793000
         MVI   BCDLIB1(@06),X'FF'                                  0539 01794000
*               BCDLIB2=FIX1F;      /*                       @Y30LB25   01795000
*                                      NULL LIBID2           @Y30LB25*/ 01796000
         MVI   BCDLIB2(@06),X'FF'                                  0540 01797000
*             END;                  /*                       @Y30LB25*/ 01798000
*                                                                  0541 01799000
*           /*********************************************************/ 01800000
*           /*                                                       */ 01801000
*           /* BOTH LIBID FIELDS NULL, THEN DELETE           @Y30LB25*/ 01802000
*           /* THE RECORD. OTHERWISE, WRITE THE RECORD.      @Y30LB25*/ 01803000
*           /*                                                       */ 01804000
*           /*********************************************************/ 01805000
*                                                                  0542 01806000
*           IF BCDLIB1=FIX1F&BCDLIB2=FIX1F/*                 @Y30LB25   01807000
*                                      DELETE OR WRITE?      @Y30LB25*/ 01808000
*             THEN                  /* DELETE                @Y30LB25*/ 01809000
@RC00536 L     @06,BCDVPTR                                         0542 01810000
         CLI   BCDLIB1(@06),255                                    0542 01811000
         BNE   @RF00542                                            0542 01812000
         CLI   BCDLIB2(@06),255                                    0542 01813000
         BNE   @RF00542                                            0542 01814000
*             RPLVTYP=RPLVDEL;      /*                       @Y30LB25*/ 01815000
         L     @06,RPLVPTR                                         0543 01816000
         MVI   RPLVTYP(@06),X'05'                                  0543 01817000
*           ELSE                    /*                       @Y30LB25*/ 01818000
*             RPLVTYP=RPLVPUT;      /* WRITE                 @Y30LB25*/ 01819000
         B     @RC00542                                            0544 01820000
@RF00542 L     @06,RPLVPTR                                         0544 01821000
         MVI   RPLVTYP(@06),X'01'                                  0544 01822000
*           RESPECIFY               /*                       @Y30LB25*/ 01823000
*             RG1 RSTD;             /* RESTRICT REG 1        @Y30LB25*/ 01824000
@RC00542 DS    0H                                                  0546 01825000
*           RG1=RPLVPTR;            /* SET RPLVPTR           @Y30LB25*/ 01826000
         L     RG1,RPLVPTR                                         0546 01827000
*           CALL ICBVIO00;          /* WRITE/DELETE BVR,     @Y30LB25   01828000
*                                      CVR, OR DVR           @Y30LB25*/ 01829000
         L     @15,@CV00762                                        0547 01830000
         BALR  @14,@15                                             0547 01831000
*           RESPECIFY               /*                       @Y30LB25*/ 01832000
*             RG1 UNRSTD;           /* UNRESTRICT REG 1      @Y30LB25*/ 01833000
*           IF RPLVRETC^=FIXZERO    /* ERROR?                @Y30LB25*/ 01834000
*             THEN                  /* YES                   @Y30LB25*/ 01835000
         L     @06,RPLVPTR                                         0549 01836000
         LH    @15,RPLVRETC(,@06)                                  0549 01837000
         N     @15,@CF01129                                        0549 01838000
         LTR   @15,@15                                             0549 01839000
         BNZ   @RT00549                                            0549 01840000
*             RETURN;               /*                       @Y30LB25*/ 01841000
*                                                                  0550 01842000
*           /*********************************************************/ 01843000
*           /*                                                       */ 01844000
*           /* RETURN IF BOTH LIBID FIELDS ARE NOT FF        @ZA17163*/ 01845000
*           /*                                                       */ 01846000
*           /*********************************************************/ 01847000
*                                                                  0551 01848000
*           IF BCDLIB1^=FIX1F|BCDLIB2^=FIX1F/*               @ZA17163*/ 01849000
*             THEN                  /* NO                    @ZA17163*/ 01850000
         L     @15,BCDVPTR                                         0551 01851000
         CLI   BCDLIB1(@15),255                                    0551 01852000
         BNE   @RT00551                                            0551 01853000
         CLI   BCDLIB2(@15),255                                    0551 01854000
         BNE   @RT00551                                            0551 01855000
*             RETURN;               /*                       @ZA17163*/ 01856000
*                                                                  0552 01857000
*           /*********************************************************/ 01858000
*           /*                                                       */ 01859000
*           /* DELETE THE CIR.                               @Y30LB25*/ 01860000
*           /*                                                       */ 01861000
*           /*********************************************************/ 01862000
*                                                                  0553 01863000
*           IVOLKY=BCDCSN1;         /* SET CIR KEY           @Y30LB25*/ 01864000
         MVC   IVOLKY(12),BCDCSN1(@15)                             0553 01865000
*           RPLVKEY=ADDR(IKEY);     /* ADDR OF KEY           @Y30LB25*/ 01866000
         LA    @15,IKEY                                            0554 01867000
         ST    @15,RPLVKEY(,@06)                                   0554 01868000
*           RPLVBUF=INDEXPTR;       /* BUF PTR               @Y30LB25*/ 01869000
         L     @15,INDEXPTR                                        0555 01870000
         ST    @15,RPLVBUF(,@06)                                   0555 01871000
*           RPLVBLN=LENGTH(INDEXBUF);/*                      @Y30LB25   01872000
*                                      SET BUFFER LENGTH     @Y30LB25*/ 01873000
         MVC   RPLVBLN(4,@06),@CF00339                             0556 01874000
*           CALL DELTRECD;          /* DELETE CIR            @Y30LB25*/ 01875000
*                                                                  0557 01876000
         BAL   @14,DELTRECD                                        0557 01877000
*           /*********************************************************/ 01878000
*           /*                                                       */ 01879000
*           /* DISREGARD ANY ERROR AND CONTINUE              @Y30LB25*/ 01880000
*           /*                                                       */ 01881000
*           /*********************************************************/ 01882000
*                                                                  0558 01883000
*           RPLVRETC=RPLVRETC&&RPLVRETC;/*                   @Y30LB25*/ 01884000
         L     @06,RPLVPTR                                         0558 01885000
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       0558 01886000
*           RPLRCODE=RPLRCODE&&RPLRCODE;/*                   @Y30LB25*/ 01887000
*                                                                  0559 01888000
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       0559 01889000
*           /*********************************************************/ 01890000
*           /*                                                       */ 01891000
*           /* CHECK IF OK TO DELETE OTHER                   @Y30LB25*/ 01892000
*           /* CIR, BECAUSE ONLY ONE                         @Y30LB25*/ 01893000
*           /* CARTRIDGE MAY HAVE BEEN                       @Y30LB25*/ 01894000
*           /* EJECTED BY THE MSC.                           @Y30LB25*/ 01895000
*           /*                                                       */ 01896000
*           /*********************************************************/ 01897000
*                                                                  0560 01898000
*           IF BCDLIB2=FIX1F        /* 2ND CART EJECTED?     @Y30LB25*/ 01899000
*             THEN                  /* YES                   @Y30LB25*/ 01900000
         L     @06,BCDVPTR                                         0560 01901000
         CLI   BCDLIB2(@06),255                                    0560 01902000
         BNE   @RF00560                                            0560 01903000
*             DO;                   /*                       @Y30LB25*/ 01904000
*               IVOLKY=BCDCSN2;     /* SET CIR KEY           @Y30LB25*/ 01905000
         MVC   IVOLKY(12),BCDCSN2(@06)                             0562 01906000
*               CALL DELTRECD;      /* DELETE CIR            @Y30LB25*/ 01907000
*                                                                  0563 01908000
         BAL   @14,DELTRECD                                        0563 01909000
*               /*****************************************************/ 01910000
*               /*                                                   */ 01911000
*               /* DISREGARD ANY ERROR AND CONTINUE          @Y30LB25*/ 01912000
*               /*                                                   */ 01913000
*               /*****************************************************/ 01914000
*                                                                  0564 01915000
*               RPLVRETC=RPLVRETC&&RPLVRETC;/*               @Y30LB25*/ 01916000
         L     @06,RPLVPTR                                         0564 01917000
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       0564 01918000
*               RPLRCODE=RPLRCODE&&RPLRCODE;/*               @Y30LB25*/ 01919000
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       0565 01920000
*             END;                  /*                       @Y30LB25*/ 01921000
*                                                                  0566 01922000
*           /*********************************************************/ 01923000
*           /*                                                       */ 01924000
*           /* RETURN IF RECORD IS A DUPLICATE               @Y30LB25*/ 01925000
*           /*                                                       */ 01926000
*           /*********************************************************/ 01927000
*                                                                  0567 01928000
*           IF BCDDUP=ON            /*                       @ZA17163*/ 01929000
*             THEN                  /*                       @Y30LB25*/ 01930000
@RF00560 L     @06,BCDVPTR                                         0567 01931000
         TM    BCDDUP(@06),B'00000100'                             0567 01932000
         BO    @RT00567                                            0567 01933000
*             RETURN;               /*                       @Y30LB25*/ 01934000
*                                                                  0568 01935000
*           /*********************************************************/ 01936000
*           /*                                                       */ 01937000
*           /* FOR A CVR, UPDATE ITS BVR.                    @Y30LB25*/ 01938000
*           /*                                                       */ 01939000
*           /*********************************************************/ 01940000
*                                                                  0569 01941000
*           IF BCDCOPY=ON           /* CVR?                  @Y30LB25*/ 01942000
*             THEN                  /* YES                   @Y30LB25*/ 01943000
         TM    BCDCOPY(@06),B'00010000'                            0569 01944000
         BNO   @RF00569                                            0569 01945000
*             DO;                   /*                       @Y30LB25*/ 01946000
*               ADDSUB=OFF;         /*                       @Y30LB25   01947000
*                                      DELETE CVR            @Y30LB25*/ 01948000
         NI    ADDSUB,B'10111111'                                  0571 01949000
*               CALL ICBVUBVR(BCDVPTR,RPLVPTR,PASSBYTE);/*   @Y30LB25   01950000
*                                      UPDT CVR'S BVR        @Y30LB25*/ 01951000
         L     @15,@CV00769                                        0572 01952000
         LA    @01,@AL00572                                        0572 01953000
         BALR  @14,@15                                             0572 01954000
*             END;                  /*                       @Y30LB25*/ 01955000
*           ELSE                    /* BVR                   @Y30LB25*/ 01956000
*             DO;                   /*                       @Y30LB25*/ 01957000
*                                                                  0574 01958000
         B     @RC00569                                            0574 01959000
@RF00569 DS    0H                                                  0575 01960000
*               /*****************************************************/ 01961000
*               /*                                                   */ 01962000
*               /* CHECK FOR GROUPED                         @Y30LB25*/ 01963000
*               /*                                                   */ 01964000
*               /*****************************************************/ 01965000
*                                                                  0575 01966000
*               IF BASGRPV=ON       /* GROUPED?              @Y30LB25*/ 01967000
*                 THEN              /* YES                   @Y30LB25*/ 01968000
         L     @06,BASEVPTR                                        0575 01969000
         TM    BASGRPV(@06),B'00100000'                            0575 01970000
         BNO   @RF00575                                            0575 01971000
*                 DO;               /*                       @Y30LB25*/ 01972000
*                   CALL INACGVR;   /*                       @Y30LB25   01973000
*                                      DECREM # INAC VOLS    @Y30LB25*/ 01974000
         BAL   @14,INACGVR                                         0577 01975000
*                   IF RPLVRETC^=FIXZERO/* ERROR?            @Y30LB25*/ 01976000
*                     THEN          /* YES                   @Y30LB25*/ 01977000
         L     @06,RPLVPTR                                         0578 01978000
         LH    @06,RPLVRETC(,@06)                                  0578 01979000
         N     @06,@CF01129                                        0578 01980000
         LTR   @06,@06                                             0578 01981000
         BNZ   @RT00578                                            0578 01982000
*                     RETURN;       /*                       @Y30LB25*/ 01983000
*                 END;              /*                       @Y30LB25*/ 01984000
*                                                                  0580 01985000
*               /*****************************************************/ 01986000
*               /*                                                   */ 01987000
*               /* FOR A BVR, UPDATE ITS GVR OR NGVR.        @Y30LB25*/ 01988000
*               /*                                                   */ 01989000
*               /*****************************************************/ 01990000
*                                                                  0581 01991000
*               CALL PROCBVR;       /* PROCESS BVR           @Y30LB25*/ 01992000
@RF00575 BAL   @14,PROCBVR                                         0581 01993000
*             END;                  /*                       @Y30LB25*/ 01994000
*           RETURN;                 /*                       @Y30LB25*/ 01995000
         B     @EL00012                                            0583 01996000
*         END;                      /*                       @Y30LB25*/ 01997000
*     END;                          /*                       @Y30LB25*/ 01998000
*   END PROMCRTE;                   /*                       @Y30LB25*/ 01999000
         B     @EL00012                                            0586 02000000
*                                                                  0587 02001000
*   /*****************************************************************/ 02002000
*   /*                                                               */ 02003000
*   /* PROCEDURE NAME - INACGVR                              @Y30LB25*/ 02004000
*   /*                                                       @Y30LB25*/ 02005000
*   /* FUNCTION -                                            @Y30LB25*/ 02006000
*   /* DECREMENTS THE COUNT OF INACTIVE VOLUMES IN THE       @Y30LB25*/ 02007000
*   /* GROUP VOLUME RECORD.                                  @Y30LB25*/ 02008000
*   /*                                                       @Y30LB25*/ 02009000
*   /* INPUT -                                               @Y30LB25*/ 02010000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 02011000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 02012000
*   /*                                                       @Y30LB25*/ 02013000
*   /* OUTPUT -                                              @Y30LB25*/ 02014000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 02015000
*   /* AN ERROR                                              @Y30LB25*/ 02016000
*   /* GROUP VOLUME RECORD                                   @Y30LB25*/ 02017000
*   /*                                                               */ 02018000
*   /*****************************************************************/ 02019000
*                                                                  0587 02020000
*INACGVR:                           /*                       @Y30LB25*/ 02021000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 02022000
INACGVR  ST    @14,@SA00013                                        0587 02023000
*   GROUPKY=BASGROUP;               /* SET GROUP NAME        @Y30LB25*/ 02024000
         L     @06,BASEVPTR                                        0588 02025000
         MVC   GROUPKY(8),BASGROUP(@06)                            0588 02026000
*   RPLVKEY=ADDR(GKEY);             /* SET KEY ADDR          @Y30LB25*/ 02027000
         LA    @06,GKEY                                            0589 02028000
         L     @01,RPLVPTR                                         0589 02029000
         ST    @06,RPLVKEY(,@01)                                   0589 02030000
*   CALL READUPD1;                  /* READ GVR              @Y30LB25*/ 02031000
         BAL   @14,READUPD1                                        0590 02032000
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/ 02033000
*     THEN                          /* YES                   @Y30LB25*/ 02034000
         L     @06,RPLVPTR                                         0591 02035000
         LH    @15,RPLVRETC(,@06)                                  0591 02036000
         N     @15,@CF01129                                        0591 02037000
         LTR   @15,@15                                             0591 02038000
         BNZ   @RT00591                                            0591 02039000
*     RETURN;                       /*                       @Y30LB25*/ 02040000
*   GROUPBUF=BASEBUF1;              /* USE CORRECT BUF       @Y30LB25*/ 02041000
         MVC   GROUPBUF(224),BASEBUF1                              0593 02042000
*   GRONINAC=GRONINAC-FIXONE;       /* DECREM INAC VOLS      @Y30LB25*/ 02043000
         L     @15,GROUPPTR                                        0594 02044000
         LH    @14,GRONINAC(,@15)                                  0594 02045000
         BCTR  @14,0                                               0594 02046000
         STH   @14,GRONINAC(,@15)                                  0594 02047000
*   RPLVBUF=ADDR(GROUPBUF);         /* BUFFER ADDR           @Y30LB25*/ 02048000
         LA    @15,GROUPBUF                                        0595 02049000
         ST    @15,RPLVBUF(,@06)                                   0595 02050000
*   CALL WRITRECD;                  /* WRITE GVR             @Y30LB25*/ 02051000
         BAL   @14,WRITRECD                                        0596 02052000
*   RETURN;                         /*                       @Y30LB25*/ 02053000
@EL00013 DS    0H                                                  0597 02054000
@EF00013 DS    0H                                                  0597 02055000
@ER00013 L     @14,@SA00013                                        0597 02056000
         BR    @14                                                 0597 02057000
*   END INACGVR;                    /*                       @Y30LB25*/ 02058000
         B     @EL00013                                            0598 02059000
*                                                                  0599 02060000
*   /*****************************************************************/ 02061000
*   /*                                                               */ 02062000
*   /* PROCEDURE NAME - DELTRECD                             @Y30LB25*/ 02063000
*   /*                                                       @Y30LB25*/ 02064000
*   /* FUNCTION - READ AND DELETE AN MSVC RECORD.            @Y30LB25*/ 02065000
*   /*                                                       @Y30LB25*/ 02066000
*   /* INPUT -                                               @Y30LB25*/ 02067000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 02068000
*   /* KEY OF RECORD IN RPLVKEY                              @Y30LB25*/ 02069000
*   /* ADDRESS OF RECORD BUFFER IN RPLVBUF                   @Y30LB25*/ 02070000
*   /* LENGTH OF BUFFER IN RPLVBLN                           @Y30LB25*/ 02071000
*   /*                                                       @Y30LB25*/ 02072000
*   /* OUTPUT -                                              @Y30LB25*/ 02073000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 02074000
*   /* AN ERROR                                              @Y30LB25*/ 02075000
*   /*                                                               */ 02076000
*   /*****************************************************************/ 02077000
*                                                                  0599 02078000
*DELTRECD:                          /*                       @Y30LB25*/ 02079000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 02080000
DELTRECD ST    @14,@SA00014                                        0599 02081000
*   RPLVTYP=RPLVREAD;               /* READ                  @Y30LB25*/ 02082000
         L     @06,RPLVPTR                                         0600 02083000
         MVI   RPLVTYP(@06),X'00'                                  0600 02084000
*   RPLVLOC=OFF;                    /* NO LOCATE             @Y30LB25*/ 02085000
         NI    RPLVLOC(@06),B'01111111'                            0601 02086000
*   RPLVUPD=ON;                     /* UPDATE                @Y30LB25*/ 02087000
         OI    RPLVUPD(@06),B'00000010'                            0602 02088000
*   RPLVDIR=ON;                     /* DIRECT                @Y30LB25*/ 02089000
         OI    RPLVDIR(@06),B'01000000'                            0603 02090000
*   RESPECIFY                       /*                       @Y30LB25*/ 02091000
*     RG1 RSTD;                     /* RESTRICT REG 1        @Y30LB25*/ 02092000
*   RG1=RPLVPTR;                    /* RPLV PTR              @Y30LB25*/ 02093000
         LR    RG1,@06                                             0605 02094000
*   CALL ICBVIO00;                  /* READ MSVC RECORD      @Y30LB25*/ 02095000
         L     @15,@CV00762                                        0606 02096000
         BALR  @14,@15                                             0606 02097000
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/ 02098000
*     THEN                          /* YES                   @Y30LB25*/ 02099000
         L     @06,RPLVPTR                                         0607 02100000
         LH    @00,RPLVRETC(,@06)                                  0607 02101000
         N     @00,@CF01129                                        0607 02102000
         LTR   @00,@00                                             0607 02103000
         BNZ   @RT00607                                            0607 02104000
*     RETURN;                       /*                       @Y30LB25*/ 02105000
*   RPLVTYP=RPLVDEL;                /* DELETE                @Y30LB25*/ 02106000
         MVI   RPLVTYP(@06),X'05'                                  0609 02107000
*   CALL ICBVIO00;                  /* DELETE MSVC RECORD    @Y30LB25*/ 02108000
         L     @15,@CV00762                                        0610 02109000
         BALR  @14,@15                                             0610 02110000
*   RESPECIFY                       /*                       @Y30LB25*/ 02111000
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @Y30LB25*/ 02112000
*   RETURN;                         /*                       @Y30LB25*/ 02113000
@EL00014 DS    0H                                                  0612 02114000
@EF00014 DS    0H                                                  0612 02115000
@ER00014 L     @14,@SA00014                                        0612 02116000
         BR    @14                                                 0612 02117000
*   END DELTRECD;                   /*                       @Y30LB25*/ 02118000
         B     @EL00014                                            0613 02119000
*                                                                  0614 02120000
*   /*****************************************************************/ 02121000
*   /*                                                               */ 02122000
*   /* PROCEDURE NAME - PROCBVR                              @Y30LB25*/ 02123000
*   /*                                                       @Y30LB25*/ 02124000
*   /* FUNCTION - THE INPUT BVR HAS ALREADY BEEN DELETED.    @Y30LB25*/ 02125000
*   /* IF THE BVR IS GROUPED, GET THE GVR, UPDATE IT, CHAIN  @Y30LB25*/ 02126000
*   /* THE BVR OUT OF THE GVR, AND WRITE THE GVR.            @Y30LB25*/ 02127000
*   /* IF THE BVR WAS GROUPED, ACTIVE AND GENERAL-USE        @Y30LB25*/ 02128000
*   /* DELETE ITS GROUP VOLUME SERIAL NUMBER EXTENSION       @Y30LB25*/ 02129000
*   /* SLOT. LOCATE A DVR FOR THE BVR, IF ANY, AND MAKE      @Y30LB25*/ 02130000
*   /* IT THE BVR. IF NO DVR IS FOUND, THEN DELETE THE       @Y30LB25*/ 02131000
*   /* BVR FROM THE NGVR CHAIN OF BVRS, IF THE BVR           @Y30LB25*/ 02132000
*   /* IS NON-GROUPED.                                       @Y30LB25*/ 02133000
*   /*                                                       @Y30LB25*/ 02134000
*   /* INPUT -                                               @Y30LB25*/ 02135000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 02136000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 02137000
*   /*                                                       @Y30LB25*/ 02138000
*   /* OUTPUT -                                              @Y30LB25*/ 02139000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 02140000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 02141000
*   /* GROUP VOLUME RECORD                                   @Y30LB25*/ 02142000
*   /* NON-GROUP VOLUME RECORD                               @Y30LB25*/ 02143000
*   /*                                                               */ 02144000
*   /*****************************************************************/ 02145000
*                                                                  0614 02146000
*PROCBVR:                           /*                       @Y30LB25*/ 02147000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 02148000
PROCBVR  ST    @14,@SA00015                                        0614 02149000
*   IF BASGRPV=ON                   /* GROUPED?              @Y30LB25*/ 02150000
*     THEN                          /* YES                   @Y30LB25*/ 02151000
         L     @06,BASEVPTR                                        0615 02152000
         TM    BASGRPV(@06),B'00100000'                            0615 02153000
         BNO   @RF00615                                            0615 02154000
*     DO;                           /*                       @Y30LB25*/ 02155000
*                                                                  0616 02156000
*       /*************************************************************/ 02157000
*       /*                                                           */ 02158000
*       /* GET AND UPDATE THE GROUP VOLUME RECORD            @Y30LB25*/ 02159000
*       /*                                                           */ 02160000
*       /*************************************************************/ 02161000
*                                                                  0617 02162000
*       GROUPKY=BASGROUP;           /* SET GROUP NAME        @Y30LB25*/ 02163000
         MVC   GROUPKY(8),BASGROUP(@06)                            0617 02164000
*       RPLVKEY=ADDR(GKEY);         /* SET KEY ADDR          @Y30LB25*/ 02165000
         LA    @06,GKEY                                            0618 02166000
         L     @01,RPLVPTR                                         0618 02167000
         ST    @06,RPLVKEY(,@01)                                   0618 02168000
*       CALL READUPD1;              /* GET GVR               @Y30LB25*/ 02169000
         BAL   @14,READUPD1                                        0619 02170000
*       IF RPLVRETC^=FIXZERO        /* CHECK RETURN CODE     @Y30LB25*/ 02171000
*         THEN                      /* ERROR                 @Y30LB25*/ 02172000
         L     @06,RPLVPTR                                         0620 02173000
         LH    @06,RPLVRETC(,@06)                                  0620 02174000
         N     @06,@CF01129                                        0620 02175000
         LTR   @06,@06                                             0620 02176000
         BNZ   @RT00620                                            0620 02177000
*         RETURN;                   /*                       @Y30LB25*/ 02178000
*       GROUPBUF=BASEBUF1;          /* USE CORRECT BUFF      @Y30LB25*/ 02179000
         MVC   GROUPBUF(224),BASEBUF1                              0622 02180000
*       GRPFLG=ON;                  /* SET GROUP FLAG        @Y30LB25*/ 02181000
         OI    GRPFLG,B'00010000'                                  0623 02182000
*       CALL VUCHO;                 /* CHAIN BVR OUT GVR     @Y30LB25*/ 02183000
         BAL   @14,VUCHO                                           0624 02184000
*       IF RPLVRETC^=FIXZERO        /* CHECK RETURN CODE     @Y30LB25*/ 02185000
*         THEN                      /* ERROR                 @Y30LB25*/ 02186000
         L     @06,RPLVPTR                                         0625 02187000
         LH    @15,RPLVRETC(,@06)                                  0625 02188000
         N     @15,@CF01129                                        0625 02189000
         LTR   @15,@15                                             0625 02190000
         BNZ   @RT00625                                            0625 02191000
*         RETURN;                   /*                       @Y30LB25*/ 02192000
*                                                                  0626 02193000
*       /*************************************************************/ 02194000
*       /*                                                           */ 02195000
*       /* REESTABLISH RPLV FOR WRITING THE GVR              @Y30LB25*/ 02196000
*       /*                                                           */ 02197000
*       /*************************************************************/ 02198000
*                                                                  0627 02199000
*       GROUPKY=BASGROUP;           /* SET THE KEY           @Y30LB25*/ 02200000
         L     @01,BASEVPTR                                        0627 02201000
         MVC   GROUPKY(8),BASGROUP(@01)                            0627 02202000
*       RPLVKEY=ADDR(GKEY);         /* PTR TO KEY            @Y30LB25*/ 02203000
         LA    @15,GKEY                                            0628 02204000
         ST    @15,RPLVKEY(,@06)                                   0628 02205000
*       CALL READUPD1;              /* GET GVR               @Y30LB25*/ 02206000
         BAL   @14,READUPD1                                        0629 02207000
*       IF RPLVRETC^=FIXZERO        /* CHECK RETURN CODE     @Y30LB25*/ 02208000
*         THEN                      /* ERROR                 @Y30LB25*/ 02209000
         L     @06,RPLVPTR                                         0630 02210000
         LH    @15,RPLVRETC(,@06)                                  0630 02211000
         N     @15,@CF01129                                        0630 02212000
         LTR   @15,@15                                             0630 02213000
         BNZ   @RT00630                                            0630 02214000
*         RETURN;                   /*                       @Y30LB25*/ 02215000
*       RPLVBUF=ADDR(GROUPBUF);     /* PTR TO GVR            @Y30LB25*/ 02216000
         LA    @15,GROUPBUF                                        0632 02217000
         ST    @15,RPLVBUF(,@06)                                   0632 02218000
*       CALL WRITRECD;              /* WRITE GVR             @Y30LB25*/ 02219000
         BAL   @14,WRITRECD                                        0633 02220000
*       IF RPLVRETC^=FIXZERO        /* CHECK RETURN CODE     @Y30LB25*/ 02221000
*         THEN                      /* ERROR                 @Y30LB25*/ 02222000
         L     @06,RPLVPTR                                         0634 02223000
         LH    @06,RPLVRETC(,@06)                                  0634 02224000
         N     @06,@CF01129                                        0634 02225000
         LTR   @06,@06                                             0634 02226000
         BNZ   @RT00634                                            0634 02227000
*         RETURN;                   /*                       @Y30LB25*/ 02228000
*                                                                  0635 02229000
*       /*************************************************************/ 02230000
*       /*                                                           */ 02231000
*       /* CHECK FOR ACTIVE GENERAL-USE TO DELETE            @Y30LB25*/ 02232000
*       /* ITS GVSNER SLOT.                                  @Y30LB25*/ 02233000
*       /*                                                           */ 02234000
*       /*************************************************************/ 02235000
*                                                                  0636 02236000
*       IF BASINAC=OFF&BASGENUS=ON  /* ACT & GEN-USE?        @Y30LB25*/ 02237000
*         THEN                      /* YES                   @Y30LB25*/ 02238000
         L     @06,BASEVPTR                                        0636 02239000
         TM    BASGENUS(@06),B'00010000'                           0636 02240000
         BNO   @RF00636                                            0636 02241000
         TM    BASINAC(@06),B'00000100'                            0636 02242000
         BNZ   @RF00636                                            0636 02243000
*         DO;                       /*                       @Y30LB25*/ 02244000
*           ADDSUBSL=OFF;           /* DELETE SLOT           @Y30LB25*/ 02245000
         NI    ADDSUBSL,B'11111101'                                0638 02246000
*           EXPSLOT=OFF;            /* NO UPDT EXPIR DATE    @Y30LB25*/ 02247000
         NI    EXPSLOT,B'01111111'                                 0639 02248000
*           CALL ICBVUEXT(GROUPPTR,BASEVPTR,RPLVPTR,PASSBYTE);/*   0640 02249000
*                                      DELETE GVSNER SLOT    @Y30LB25*/ 02250000
         L     @15,@CV00767                                        0640 02251000
         LA    @01,@AL00640                                        0640 02252000
         BALR  @14,@15                                             0640 02253000
*           IF RPLVRETC^=FIXZERO    /* ERROR?                @Y30LB25*/ 02254000
*             THEN                  /* YES                   @Y30LB25*/ 02255000
         L     @06,RPLVPTR                                         0641 02256000
         LH    @06,RPLVRETC(,@06)                                  0641 02257000
         N     @06,@CF01129                                        0641 02258000
         LTR   @06,@06                                             0641 02259000
         BNZ   @RT00641                                            0641 02260000
*             RETURN;               /*                       @Y30LB25*/ 02261000
*         END;                      /*                       @Y30LB25*/ 02262000
*     END;                          /*                       @Y30LB25*/ 02263000
*                                                                  0644 02264000
@RF00636 DS    0H                                                  0645 02265000
*   /*****************************************************************/ 02266000
*   /*                                                               */ 02267000
*   /* CHECK FOR A DUP VOLUME RECORD FOR THE DELETED         @Y30LB25*/ 02268000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 02269000
*   /*                                                               */ 02270000
*   /*****************************************************************/ 02271000
*                                                                  0645 02272000
*   DVOLKY=BASSERNO;                /* SET VOLID IN KEY      @Y30LB25*/ 02273000
@RF00615 L     @06,BASEVPTR                                        0645 02274000
         MVC   DVOLKY(6),BASSERNO(@06)                             0645 02275000
*   DIDKY=FIXONE;                   /* SET KEY               @Y30LB25*/ 02276000
         MVI   DIDKY,X'01'                                         0646 02277000
*   RPLVKEY=ADDR(DKEY);             /* ADDR OF KEY           @Y30LB25*/ 02278000
         L     @06,RPLVPTR                                         0647 02279000
         LA    @15,DKEY                                            0647 02280000
         ST    @15,RPLVKEY(,@06)                                   0647 02281000
*   RPLVTYP=RPLVREAD;               /* READ OPTION ON        @Y30LB25*/ 02282000
         MVI   RPLVTYP(@06),X'00'                                  0648 02283000
*   RPLVDIR=ON;                     /* DIRECT                @Y30LB25*/ 02284000
*   RPLVLOC=OFF;                    /* NO LOCATE             @Y30LB25*/ 02285000
         OI    RPLVDIR(@06),B'01000000'                            0650 02286000
         NI    RPLVLOC(@06),B'01111111'                            0650 02287000
*   RPLVUPD=ON;                     /* SET UPDATE            @Y30LB25*/ 02288000
         OI    RPLVUPD(@06),B'00000010'                            0651 02289000
*   RPLVKGE=ON;                     /* READ KEY = OR >       @Y30LB25*/ 02290000
         OI    RPLVKGE(@06),B'00000100'                            0652 02291000
*   RPLVBUF=DUPVPTR;                /* BUFFER PTR            @Y30LB25*/ 02292000
         L     @15,DUPVPTR                                         0653 02293000
         ST    @15,RPLVBUF(,@06)                                   0653 02294000
*   RPLVBLN=LENGTH(DUPVBUF);        /* BUFFER LENGTH         @Y30LB25*/ 02295000
         MVC   RPLVBLN(4,@06),@CF01103                             0654 02296000
*   RESPECIFY                                                      0655 02297000
*     RG1 RSTD;                     /* RESTRICT REG 1        @Y30LB25*/ 02298000
*   RG1=RPLVPTR;                    /* SET RPLV PTR          @Y30LB25*/ 02299000
         LR    RG1,@06                                             0656 02300000
*   CALL ICBVIO00;                  /* READ FOR DVR          @Y30LB25*/ 02301000
         L     @15,@CV00762                                        0657 02302000
         BALR  @14,@15                                             0657 02303000
*   RESPECIFY                                                      0658 02304000
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @Y30LB25*/ 02305000
*   RPLVKGE=OFF;                    /* NO > OR =             @Y30LB25*/ 02306000
         L     @06,RPLVPTR                                         0659 02307000
         NI    RPLVKGE(@06),B'11111011'                            0659 02308000
*   IF RPLRCODE=IOERROR             /* CHECK REASON CODE     @Y30LB25*/ 02309000
*     THEN                          /* YES                   @Y30LB25*/ 02310000
         CLC   RPLRCODE(2,@06),@CB00713                            0660 02311000
         BE    @RT00660                                            0660 02312000
*     RETURN;                       /*                       @Y30LB25*/ 02313000
*   IF DKY^=DUPD|DVOLKY^=DUPSERNO   /* DVR FOUND?            @Y30LB25*/ 02314000
*     THEN                          /* NO                    @Y30LB25*/ 02315000
         L     @06,DUPVPTR                                         0662 02316000
         CLC   DKY(5),DUPD(@06)                                    0662 02317000
         BNE   @RT00662                                            0662 02318000
         CLC   DVOLKY(6),DUPSERNO(@06)                             0662 02319000
         BE    @RF00662                                            0662 02320000
@RT00662 DS    0H                                                  0663 02321000
*     DO;                           /*                       @Y30LB25*/ 02322000
*       RPLVRETC=RPLVRETC&&RPLVRETC;/* ZERO RETURN CODE      @Y30LB25*/ 02323000
         L     @06,RPLVPTR                                         0664 02324000
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       0664 02325000
*       RPLRCODE=RPLRCODE&&RPLRCODE;/* ZERO REASON CODE      @Y30LB25*/ 02326000
*                                                                  0665 02327000
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       0665 02328000
*       /*************************************************************/ 02329000
*       /*                                                           */ 02330000
*       /* NO DVR WAS FOUND                                  #Y30LB25*/ 02331000
*       /*                                                           */ 02332000
*       /*************************************************************/ 02333000
*                                                                  0666 02334000
*       IF BASGRPV=OFF              /* BVR NOT GRPD?         @Y30LB25*/ 02335000
*         THEN                      /* YES                   @Y30LB25*/ 02336000
         L     @06,BASEVPTR                                        0666 02337000
         TM    BASGRPV(@06),B'00100000'                            0666 02338000
         BNZ   @RF00666                                            0666 02339000
*         DO;                       /*                       @Y30LB25*/ 02340000
*           GRPFLG=OFF;             /* NON-GROUPED           @Y30LB25*/ 02341000
         NI    GRPFLG,B'11101111'                                  0668 02342000
*           CALL VUCHO;             /* CHAIN BVR OUT NGVR    @Y30LB25*/ 02343000
         BAL   @14,VUCHO                                           0669 02344000
*         END;                      /*                       @Y30LB25*/ 02345000
*       RETURN;                     /*                       @Y30LB25*/ 02346000
@EL00015 DS    0H                                                  0671 02347000
@EF00015 DS    0H                                                  0671 02348000
@ER00015 L     @14,@SA00015                                        0671 02349000
         BR    @14                                                 0671 02350000
*     END;                          /*                       @Y30LB25*/ 02351000
*                                                                  0672 02352000
*   /*****************************************************************/ 02353000
*   /*                                                               */ 02354000
*   /* DVR WAS FOUND                                         @Y30LB25*/ 02355000
*   /*                                                               */ 02356000
*   /*****************************************************************/ 02357000
*                                                                  0673 02358000
*   ELSE                            /* DVR WAS FOUND         @Y30LB25*/ 02359000
*     DO;                           /*                       @Y30LB25*/ 02360000
@RF00662 DS    0H                                                  0674 02361000
*       IF BASGRPV=ON               /* BVR GROUPED?          @Y30LB25*/ 02362000
*         THEN                      /* YES                   @Y30LB25*/ 02363000
         L     @06,BASEVPTR                                        0674 02364000
         TM    BASGRPV(@06),B'00100000'                            0674 02365000
         BNO   @RF00674                                            0674 02366000
*         DO;                       /*                       @Y30LB25*/ 02367000
*                                                                  0675 02368000
*           /*********************************************************/ 02369000
*           /*                                                       */ 02370000
*           /* MAKE DVR INTO A BASE AND CHAIN INTO NGVR      @Y30LB25*/ 02371000
*           /* ICBVUDBR RETURNS THE POINTER TO THE           @Y30LB25*/ 02372000
*           /* BVR IT CREATED IN BASEVPTR                    @Y30LB25*/ 02373000
*           /*                                                       */ 02374000
*           /*********************************************************/ 02375000
*                                                                  0676 02376000
*           GRPDV=ON;               /* GROUPED FLAG ON       @Y30LB25*/ 02377000
         OI    GRPDV,B'10000000'                                   0676 02378000
*           CALL ICBVUDBR(DUPVPTR,BASEVPTR,RPLVPTR,PASSBYTE,/*     0677 02379000
*                                                            @Y30LB25*/ 02380000
*               FIXZERO,FIXZERO);   /*                       @Y30LB25   02381000
*                                      MAKE DVR A BVR        @Y30LB25*/ 02382000
         L     @15,@CV00766                                        0677 02383000
         LA    @01,@AL00677                                        0677 02384000
         BALR  @14,@15                                             0677 02385000
*           IF RPLVRETC^=FIXZERO    /* CHECK RETURN CODE     @Y30LB25*/ 02386000
*             THEN                  /* ERROR                 @Y30LB25*/ 02387000
         L     @06,RPLVPTR                                         0678 02388000
         LH    @06,RPLVRETC(,@06)                                  0678 02389000
         N     @06,@CF01129                                        0678 02390000
         LTR   @06,@06                                             0678 02391000
         BNZ   @RT00678                                            0678 02392000
*             RETURN;               /*                       @Y30LB25*/ 02393000
*           GRPFLG=OFF;             /* NON-GROUPED           @Y30LB25*/ 02394000
         NI    GRPFLG,B'11101111'                                  0680 02395000
*           CALL VUCHI;             /* CHAIN BVR IN NGVR     @Y30LB25*/ 02396000
         BAL   @14,VUCHI                                           0681 02397000
*           IF RPLVRETC^=FIXZERO    /* CHECK RETURN CODE     @Y30LB25*/ 02398000
*             THEN                  /* ERROR                 @Y30LB25*/ 02399000
         L     @06,RPLVPTR                                         0682 02400000
         LH    @06,RPLVRETC(,@06)                                  0682 02401000
         N     @06,@CF01129                                        0682 02402000
         LTR   @06,@06                                             0682 02403000
         BNZ   @RT00682                                            0682 02404000
*             RETURN;               /*                       @Y30LB25*/ 02405000
*         END;                      /*                       @Y30LB25*/ 02406000
*       ELSE                        /* NOT GROUPED           @Y30LB25*/ 02407000
*                                                                  0685 02408000
*         /***********************************************************/ 02409000
*         /*                                                         */ 02410000
*         /* MAKE THE DVR INTO A BVR                         @Y30LB25*/ 02411000
*         /*                                                         */ 02412000
*         /***********************************************************/ 02413000
*                                                                  0685 02414000
*         DO;                       /*                       @Y30LB25*/ 02415000
         B     @RC00674                                            0685 02416000
@RF00674 DS    0H                                                  0686 02417000
*           GRPDV=OFF;              /* GROUPED FLAG OFF      @Y30LB25*/ 02418000
         NI    GRPDV,B'01111111'                                   0686 02419000
*           IF BASFIRST=ON          /* 1ST BVR IN CHAIN?     @Y30LB25*/ 02420000
*             THEN                  /* YES                   @Y30LB25*/ 02421000
         L     @06,BASEVPTR                                        0687 02422000
         TM    BASFIRST(@06),B'00010000'                           0687 02423000
         BNO   @RF00687                                            0687 02424000
*             FRSTDV=ON;            /* SET 1ST FLG ON        @Y30LB25*/ 02425000
         OI    FRSTDV,B'01000000'                                  0688 02426000
*           IF BASLAST=ON           /* LAST BVR IN CHAIN?    @Y30LB25*/ 02427000
*             THEN                  /* YES                   @Y30LB25*/ 02428000
@RF00687 L     @06,BASEVPTR                                        0689 02429000
         TM    BASLAST(@06),B'00001000'                            0689 02430000
         BNO   @RF00689                                            0689 02431000
*             LASTDV=ON;            /* SET LAST FLG ON       @Y30LB25*/ 02432000
         OI    LASTDV,B'00100000'                                  0690 02433000
*           CALL ICBVUDBR(DUPVPTR,BASEVPTR,RPLVPTR,PASSBYTE,/*     0691 02434000
*                                                            @Y30LB25*/ 02435000
*               BASPREV,BASNEXTV);  /*                       @Y30LB25   02436000
*                                      MAKE DVR A BVR        @Y30LB25*/ 02437000
@RF00689 MVC   @AL00001(16),@AL00691                               0691 02438000
         L     @06,BASEVPTR                                        0691 02439000
         LA    @15,BASPREV(,@06)                                   0691 02440000
         ST    @15,@AL00001+16                                     0691 02441000
         LA    @06,BASNEXTV(,@06)                                  0691 02442000
         ST    @06,@AL00001+20                                     0691 02443000
         L     @15,@CV00766                                        0691 02444000
         LA    @01,@AL00001                                        0691 02445000
         BALR  @14,@15                                             0691 02446000
*           IF RPLVRETC^=FIXZERO    /* CHECK RETURN CODE     @Y30LB25*/ 02447000
*             THEN                  /* ERROR                 @Y30LB25*/ 02448000
         L     @06,RPLVPTR                                         0692 02449000
         LH    @06,RPLVRETC(,@06)                                  0692 02450000
         N     @06,@CF01129                                        0692 02451000
         LTR   @06,@06                                             0692 02452000
         BNZ   @RT00692                                            0692 02453000
*             RETURN;               /*                       @Y30LB25*/ 02454000
*         END;                      /*                       @Y30LB25*/ 02455000
*     END;                          /*                       @Y30LB25*/ 02456000
*                                                                  0695 02457000
@RC00674 DS    0H                                                  0696 02458000
*   /*****************************************************************/ 02459000
*   /*                                                               */ 02460000
*   /* WRITE THE NEW BVR                                     @Y30LB25*/ 02461000
*   /*                                                               */ 02462000
*   /*****************************************************************/ 02463000
*                                                                  0696 02464000
*   RPLVTYP=RPLVPUT;                /* WRITE BVR             @Y30LB25*/ 02465000
         L     @06,RPLVPTR                                         0696 02466000
         MVI   RPLVTYP(@06),X'01'                                  0696 02467000
*   RPLVBUF=BASEVPTR;               /* PTR TO BVR            @Y30LB25*/ 02468000
         L     @15,BASEVPTR                                        0697 02469000
         ST    @15,RPLVBUF(,@06)                                   0697 02470000
*   RPLVUPD=OFF;                    /* NEW RECORD            @Y30LB25*/ 02471000
         NI    RPLVUPD(@06),B'11111101'                            0698 02472000
*   RPLVLOC=OFF;                    /* NO LOCATE             @Y30LB25*/ 02473000
         NI    RPLVLOC(@06),B'01111111'                            0699 02474000
*   RPLVBLN=LENGTH(BASEBUF);        /* SET BUF LENGTH        @Y30LB25*/ 02475000
         LA    @15,224                                             0700 02476000
         ST    @15,RPLVBLN(,@06)                                   0700 02477000
*   RPLVRLN=LENGTH(BASEBUF);        /* SET BVR LENGTH        @Y30LB25*/ 02478000
         ST    @15,RPLVRLN(,@06)                                   0701 02479000
*   CALL WRITRECD;                  /* WRITE BVR             @Y30LB25*/ 02480000
         BAL   @14,WRITRECD                                        0702 02481000
*   RETURN;                         /*                       @Y30LB25*/ 02482000
         B     @EL00015                                            0703 02483000
*   END PROCBVR;                    /*                       @Y30LB25*/ 02484000
         B     @EL00015                                            0704 02485000
*                                                                  0705 02486000
*   /*****************************************************************/ 02487000
*   /*                                                               */ 02488000
*   /* PROCEDURE NAME - ACTVOL1                              @Y30LB25*/ 02489000
*   /*                                                       @Y30LB25*/ 02490000
*   /* FUNCTION - PROCESS A VOLUME BEFORE THE CALL TO THE    @Y30LB25*/ 02491000
*   /* MSC WHICH IS TO BECOME ACTIVE.                        @Y30LB25*/ 02492000
*   /*                                                       @Y30LB25*/ 02493000
*   /* INPUT -                                               @Y30LB25*/ 02494000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 02495000
*   /*                                                       @Y30LB25*/ 02496000
*   /* OUTPUT -                                              @Y30LB25*/ 02497000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 02498000
*   /* AN ERROR                                              @Y30LB25*/ 02499000
*   /*                                                               */ 02500000
*   /*****************************************************************/ 02501000
*                                                                  0705 02502000
*ACTVOL1:                           /*                       @Y30LB25*/ 02503000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 02504000
*                                                                  0705 02505000
ACTVOL1  ST    @14,@SA00016                                        0705 02506000
*   /*****************************************************************/ 02507000
*   /*                                                               */ 02508000
*   /* RESERVE .MSVI.                                        @Y30LB25*/ 02509000
*   /*                                                               */ 02510000
*   /*****************************************************************/ 02511000
*                                                                  0706 02512000
*   CALL RMSVIS;                    /* RESERVE .MSVI         @Y30LB25*/ 02513000
*                                                                  0706 02514000
         BAL   @14,RMSVIS                                          0706 02515000
*   /*****************************************************************/ 02516000
*   /*                                                               */ 02517000
*   /* READ FOR CIR TO GET TO THE BVR OR CVR KEY.            @ZDR2054*/ 02518000
*   /* THEN GET THE BASE OR COPY RECORD FROM ITS KEY         @ZDR2054*/ 02519000
*   /* IN THE CIR - NOT FOR UPDATE.                          @ZDR2054*/ 02520000
*   /*                                                               */ 02521000
*   /*****************************************************************/ 02522000
*                                                                  0707 02523000
*   IVOLKY=DEFVCSN1;                /* SET UP KEY            @Y30LB25*/ 02524000
         MVC   IVOLKY(12),DEFVCSN1(DEFVPTR)                        0707 02525000
*   CALL GETRECLC;                  /* GET RECORD            @Y30LB25*/ 02526000
         BAL   @14,GETRECLC                                        0708 02527000
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/ 02528000
*     THEN                          /* YES                   @Y30LB25*/ 02529000
         L     @06,RPLVPTR                                         0709 02530000
         LH    @15,RPLVRETC(,@06)                                  0709 02531000
         N     @15,@CF01129                                        0709 02532000
         LTR   @15,@15                                             0709 02533000
         BNZ   @RT00709                                            0709 02534000
*     RETURN;                       /*                       @Y30LB25*/ 02535000
*   BASEBUF=BUFFER;                 /* SAVE BVR IN CASE      @Y30LB25   02536000
*                                      GVR IS READ           @Y30LB25*/ 02537000
         L     @06,RPLVBUF(,@06)                                   0711 02538000
         MVC   BASEBUF(224),BUFFER(@06)                            0711 02539000
*   BCDVPTR=ADDR(BASEBUF);          /* COMMON MAP BVR BUF    @ZDR2054*/ 02540000
*                                                                  0712 02541000
         LA    @06,BASEBUF                                         0712 02542000
         ST    @06,BCDVPTR                                         0712 02543000
*   /*****************************************************************/ 02544000
*   /*                                                               */ 02545000
*   /* CHECK FOR VALID 'TO' OR 'FOR' EXPIRATION DATE.        @Y30LB25*/ 02546000
*   /*                                                               */ 02547000
*   /*****************************************************************/ 02548000
*                                                                  0713 02549000
*   CALL EXPCK;                     /* CK EXPIR DATE         @Y30LB25*/ 02550000
         BAL   @14,EXPCK                                           0713 02551000
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/ 02552000
*     THEN                          /* YES                   @Y30LB25*/ 02553000
         L     @06,RPLVPTR                                         0714 02554000
         LH    @15,RPLVRETC(,@06)                                  0714 02555000
         N     @15,@CF01129                                        0714 02556000
         LTR   @15,@15                                             0714 02557000
         BNZ   @RT00714                                            0714 02558000
*     RETURN;                       /*                       @Y30LB25*/ 02559000
*                                                                  0715 02560000
*   /*****************************************************************/ 02561000
*   /*                                                               */ 02562000
*   /* CHECK FOR A BVR                                       @ZDR2054*/ 02563000
*   /*                                                               */ 02564000
*   /*****************************************************************/ 02565000
*                                                                  0716 02566000
*   IF BCDBASE=ON THEN              /* BVR?                  @ZDR2054*/ 02567000
         L     @01,BCDVPTR                                         0716 02568000
         TM    BCDBASE(@01),B'00100000'                            0716 02569000
         BNO   @RF00716                                            0716 02570000
*     DO;                           /* YES                   @ZDR2054*/ 02571000
*                                                                  0717 02572000
*       /*************************************************************/ 02573000
*       /*                                                           */ 02574000
*       /* CHECK IF ENTERED FROM THE CAS WHILE MSVC WAS DISABLED     */ 02575000
*       /*                                                   @Y30LB25*/ 02576000
*       /*                                                           */ 02577000
*       /*************************************************************/ 02578000
*                                                                  0718 02579000
*       IF BASLIB1=FIX1F&BASLIB2=FIX1F/* ENTERED AT CAS?     @Y30LB25*/ 02580000
*         THEN                      /* YES                   @Y30LB25*/ 02581000
         L     @15,BASEVPTR                                        0718 02582000
         CLI   BASLIB1(@15),255                                    0718 02583000
         BNE   @RF00718                                            0718 02584000
         CLI   BASLIB2(@15),255                                    0718 02585000
         BNE   @RF00718                                            0718 02586000
*         DO;                       /* ERROR                 @Y30LB25*/ 02587000
*           RPLVRETC=FIXFOUR;       /* SET RETURN CODE       @Y30LB25*/ 02588000
         MVC   RPLVRETC(2,@06),@CH00041                            0720 02589000
*           RPLRCODE=NULLIBID;      /* SET REASON CODE       @Y30LB25*/ 02590000
         MVC   RPLRCODE(2,@06),@CB00735                            0721 02591000
*           RETURN;                 /*                       @Y30LB25*/ 02592000
@EL00016 DS    0H                                                  0722 02593000
@EF00016 DS    0H                                                  0722 02594000
@ER00016 L     @14,@SA00016                                        0722 02595000
         BR    @14                                                 0722 02596000
*         END;                      /*                       @Y30LB25*/ 02597000
*                                                                  0723 02598000
*       /*************************************************************/ 02599000
*       /*                                                           */ 02600000
*       /* CHECK FOR REASSIGNED                              @Y30LB25*/ 02601000
*       /*                                                           */ 02602000
*       /*************************************************************/ 02603000
*                                                                  0724 02604000
*       IF BASREASS=ON              /* REASSIGNED?           @Y30LB25*/ 02605000
*         THEN                      /* YES                   @Y30LB25*/ 02606000
@RF00718 L     @06,BASEVPTR                                        0724 02607000
         TM    BASREASS(@06),B'00100000'                           0724 02608000
         BNO   @RF00724                                            0724 02609000
*         DO;                       /* ERROR                 @Y30LB25*/ 02610000
*           RPLVRETC=FIXFOUR;       /* SET RETURN CODE       @Y30LB25*/ 02611000
         L     @06,RPLVPTR                                         0726 02612000
         MVC   RPLVRETC(2,@06),@CH00041                            0726 02613000
*           RPLRCODE=REASSIGN;      /* SET REASON CODE       @Y30LB25*/ 02614000
         MVC   RPLRCODE(2,@06),@CB00737                            0727 02615000
*           RETURN;                 /*                       @Y30LB25*/ 02616000
         B     @EL00016                                            0728 02617000
*         END;                      /*                       @Y30LB25*/ 02618000
*     END;                          /*                       @ZDR2054*/ 02619000
*                                                                  0730 02620000
@RF00724 DS    0H                                                  0731 02621000
*   /*****************************************************************/ 02622000
*   /*                                                               */ 02623000
*   /* FOR ACTIVATING A CVR, GET ITS BVR FOR CHECKING        @ZDR2054*/ 02624000
*   /* THE ATTRIBUTES                                        @ZDR2054*/ 02625000
*   /*                                                               */ 02626000
*   /*****************************************************************/ 02627000
*                                                                  0731 02628000
*   IF BCDCOPY=ON THEN              /* CVR?                  @ZDR2054*/ 02629000
@RF00716 L     @06,BCDVPTR                                         0731 02630000
         TM    BCDCOPY(@06),B'00010000'                            0731 02631000
         BNO   @RF00731                                            0731 02632000
*     DO;                           /* YES                   @ZDR2054*/ 02633000
*       BVOLKY=BCDSERNO;            /* SERIAL NUMBER         @ZDR2054*/ 02634000
         MVC   BVOLKY(6),BCDSERNO(@06)                             0733 02635000
*       RPLVKEY=ADDR(BKEY);         /* KEY ADDR              @ZDR2054*/ 02636000
         LA    @06,BKEY                                            0734 02637000
         L     @01,RPLVPTR                                         0734 02638000
         ST    @06,RPLVKEY(,@01)                                   0734 02639000
*       CALL READLOC;               /* READ BVR              @ZDR2054*/ 02640000
         BAL   @14,READLOC                                         0735 02641000
*       IF RPLVRETC^=FIXZERO THEN   /* ERROR?                @ZDR2054*/ 02642000
         L     @06,RPLVPTR                                         0736 02643000
         LH    @15,RPLVRETC(,@06)                                  0736 02644000
         N     @15,@CF01129                                        0736 02645000
         LTR   @15,@15                                             0736 02646000
         BNZ   @RT00736                                            0736 02647000
*         RETURN;                   /*                       @ZDR2054*/ 02648000
*       BASEVPTR=RPLVPTR;           /* SET BVR PTR           @ZDR2054*/ 02649000
         ST    @06,BASEVPTR                                        0738 02650000
*     END;                          /*                       @ZDR2054*/ 02651000
*                                                                  0739 02652000
*   /*****************************************************************/ 02653000
*   /*                                                               */ 02654000
*   /* CHECK ATTRIBUTES IF GENERAL-USE, GROUPED.             @Y30LB25*/ 02655000
*   /*                                                               */ 02656000
*   /*****************************************************************/ 02657000
*                                                                  0740 02658000
*   CALL CKATTRIB;                  /* CHECK ATTRIB'S        @Y30LB25*/ 02659000
@RF00731 BAL   @14,CKATTRIB                                        0740 02660000
*   RETURN;                         /*                       @Y30LB25*/ 02661000
         B     @EL00016                                            0741 02662000
*   END ACTVOL1;                    /*                       @Y30LB25*/ 02663000
         B     @EL00016                                            0742 02664000
*                                                                  0743 02665000
*   /*****************************************************************/ 02666000
*   /*                                                               */ 02667000
*   /* PROCEDURE NAME - EXPCK                                @Y30LB25*/ 02668000
*   /*                                                       @Y30LB25*/ 02669000
*   /* FUNCTION -                                            @Y30LB25*/ 02670000
*   /* THIS ROUTINE IS USED BY DEFINEV FUNCTIONS,            @Y30LB25*/ 02671000
*   /* BEFORE THE CALL TO THE MSC.                           @Y30LB25*/ 02672000
*   /* IT READS THE GROUP VOLUME RECORD IF EITHER            @Y30LB25*/ 02673000
*   /* TO OR FOR EXPIRATION DATES WERE SPECIFIED.            @Y30LB25*/ 02674000
*   /* IF THERE IS NO RETENTION FOR THE GROUP                @Y30LB25*/ 02675000
*   /* IT RETURNS WITH AN ERROR REASON CODE.                 @Y30LB25*/ 02676000
*   /*                                                       @Y30LB25*/ 02677000
*   /* INPUT -                                               @Y30LB25*/ 02678000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 02679000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 02680000
*   /*                                                       @Y30LB25*/ 02681000
*   /* OUTPUT -                                              @Y30LB25*/ 02682000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 02683000
*   /* AN ERROR                                              @Y30LB25*/ 02684000
*   /*                                                               */ 02685000
*   /*****************************************************************/ 02686000
*                                                                  0743 02687000
*EXPCK:                                                            0743 02688000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 02689000
*                                                                  0743 02690000
EXPCK    ST    @14,@SA00017                                        0743 02691000
*   /*****************************************************************/ 02692000
*   /*                                                               */ 02693000
*   /* BE SURE THAT 'TO' OR 'FOR' WERE SPECIFIED AND         @Y30LB25*/ 02694000
*   /* THAT THERE IS A DEFINE EXTENSION.                     @Y30LB25*/ 02695000
*   /*                                                               */ 02696000
*   /*****************************************************************/ 02697000
*                                                                  0744 02698000
*   IF DEFVVEXT^=FIXZERO&(DEFPFOR=ON|DEFPTO=ON) THEN               0744 02699000
         L     @06,DEFVVEXT(,DEFVPTR)                              0744 02700000
         LTR   @06,@06                                             0744 02701000
         BZ    @RF00744                                            0744 02702000
         TM    DEFPFOR(DEFVEPTR),B'10001000'                       0744 02703000
         BZ    @RF00744                                            0744 02704000
*     DO;                           /*                       @Y30LB25*/ 02705000
*                                                                  0745 02706000
*       /*************************************************************/ 02707000
*       /*                                                           */ 02708000
*       /* SEE IF BASE RECORD IS GOING GROUPED OR IS         @Y30LB25*/ 02709000
*       /* GROUPED GENERAL-USE OR STAYING                    @Y30LB25*/ 02710000
*       /* GROUPED GENERAL-USE.                              @Y30LB25*/ 02711000
*       /*                                                           */ 02712000
*       /*************************************************************/ 02713000
*                                                                  0746 02714000
*       IF((DEFPGRO=ON|BASGRPV=ON)&DEFGENUS=ON)|/*           @Y30LB25*/ 02715000
*           (BASGENUS=ON&DEFNGRP=OFF&DEFRSTD=OFF)/*          @Y30LB25*/ 02716000
*         THEN                                                     0746 02717000
*                                                                  0746 02718000
         TM    DEFPGRO(DEFVEPTR),B'00100000'                       0746 02719000
         BO    @GL00022                                            0746 02720000
         L     @06,BASEVPTR                                        0746 02721000
         TM    BASGRPV(@06),B'00100000'                            0746 02722000
         BNO   @GL00021                                            0746 02723000
@GL00022 TM    DEFGENUS(DEFVEPTR),B'10000000'                      0746 02724000
         BO    @RT00746                                            0746 02725000
@GL00021 L     @06,BASEVPTR                                        0746 02726000
         TM    BASGENUS(@06),B'00010000'                           0746 02727000
         BNO   @RF00746                                            0746 02728000
         TM    DEFNGRP(DEFVEPTR),B'10000000'                       0746 02729000
         BNZ   @RF00746                                            0746 02730000
         TM    DEFRSTD(DEFVEPTR),B'01000000'                       0746 02731000
         BNZ   @RF00746                                            0746 02732000
@RT00746 DS    0H                                                  0747 02733000
*         /***********************************************************/ 02734000
*         /*                                                         */ 02735000
*         /* GET GROUP NAME FROM CORRECT SOURCE              @Y30LB25*/ 02736000
*         /*                                                         */ 02737000
*         /***********************************************************/ 02738000
*                                                                  0747 02739000
*         DO;                       /*                       @Y30LB25*/ 02740000
*           IF DEFPGRO=ON THEN      /* GROUP SPECIFIED ?     @Y30LB25*/ 02741000
         TM    DEFPGRO(DEFVEPTR),B'00100000'                       0748 02742000
         BNO   @RF00748                                            0748 02743000
*             GROUPKY=DEFGROUP;     /* GROUP FROM REQ BLK    @Y30LB25*/ 02744000
         MVC   GROUPKY(8),DEFGROUP(DEFVEPTR)                       0749 02745000
*           ELSE                    /*                       @Y30LB25*/ 02746000
*             GROUPKY=BASGROUP;     /* GROUP FROM BASE REC   @Y30LB25*/ 02747000
*                                                                  0750 02748000
         B     @RC00748                                            0750 02749000
@RF00748 L     @06,BASEVPTR                                        0750 02750000
         MVC   GROUPKY(8),BASGROUP(@06)                            0750 02751000
*           /*********************************************************/ 02752000
*           /*                                                       */ 02753000
*           /* SET UP REMAINING PARAMETERS                   @Y30LB25*/ 02754000
*           /* AND READ THE GROUP RECORD                     @Y30LB25*/ 02755000
*           /* TO SEE IF IT HAS RETENTION                    @Y30LB25*/ 02756000
*           /* SPECIFIED FOR THE GROUP.                      @Y30LB25*/ 02757000
*           /*                                                       */ 02758000
*           /*********************************************************/ 02759000
*                                                                  0751 02760000
*           RPLVKEY=ADDR(GKEY);     /* ADDR OF KEY           @Y30LB25*/ 02761000
@RC00748 LA    @06,GKEY                                            0751 02762000
         L     @01,RPLVPTR                                         0751 02763000
         ST    @06,RPLVKEY(,@01)                                   0751 02764000
*           CALL READLOC;           /* READ GROUP RECORD     @Y30LB25*/ 02765000
         BAL   @14,READLOC                                         0752 02766000
*           IF RPLVRETC^=FIXZERO THEN/* CHECK RETURN?        @Y30LB25*/ 02767000
         L     @06,RPLVPTR                                         0753 02768000
         LH    @15,RPLVRETC(,@06)                                  0753 02769000
         N     @15,@CF01129                                        0753 02770000
         LTR   @15,@15                                             0753 02771000
         BNZ   @RT00753                                            0753 02772000
*             RETURN;               /*                       @Y30LB25*/ 02773000
*                                                                  0754 02774000
*           /*********************************************************/ 02775000
*           /*                                                       */ 02776000
*           /* GET ADDRESS OF GROUP RECORD AND CHECK         @Y30LB25*/ 02777000
*           /* IF RETENTION CHECKING IN EFFECT.              @Y30LB25*/ 02778000
*           /*                                                       */ 02779000
*           /*********************************************************/ 02780000
*                                                                  0755 02781000
*           GROUPPTR=RPLVBUF;       /* ADDRESSING TO BUFFER  @Y30LB25*/ 02782000
         L     @15,RPLVBUF(,@06)                                   0755 02783000
         ST    @15,GROUPPTR                                        0755 02784000
*           IF GRORETN=OFF THEN     /* NO RET DATE?          @Y30LB25*/ 02785000
*                                                                  0756 02786000
         TM    GRORETN(@15),B'00000100'                            0756 02787000
         BNZ   @RF00756                                            0756 02788000
*             /*******************************************************/ 02789000
*             /*                                                     */ 02790000
*             /* IF RETENTION CHECKING NOT IN                @Y30LB25*/ 02791000
*             /* EFFECT, ERROR.                              @Y30LB25*/ 02792000
*             /*                                                     */ 02793000
*             /*******************************************************/ 02794000
*                                                                  0757 02795000
*             DO;                   /*                       @Y30LB25*/ 02796000
*               RPLVRETC=FIXFOUR;   /* SET BAD RETURN        @Y30LB25*/ 02797000
         MVC   RPLVRETC(2,@06),@CH00041                            0758 02798000
*               RPLRCODE=NOEXPICK;  /* NO GROUP EXPIRATION   @Y30LB25*/ 02799000
         MVC   RPLRCODE(2,@06),@CB00729                            0759 02800000
*               RETURN;             /*                       @Y30LB25*/ 02801000
@EL00017 DS    0H                                                  0760 02802000
@EF00017 DS    0H                                                  0760 02803000
@ER00017 L     @14,@SA00017                                        0760 02804000
         BR    @14                                                 0760 02805000
*             END;                  /*                       @Y30LB25*/ 02806000
*         END;                      /*                       @Y30LB25*/ 02807000
*                                                                  0762 02808000
*       /*************************************************************/ 02809000
*       /*                                                           */ 02810000
*       /* IF BASE VOLUME IS NOT BECOMMING A GROUPED GENERAL @Y30LB25*/ 02811000
*       /* USE, OR NOT STAYING A GROUPED GENERAL USE, THEN   @Y30LB25*/ 02812000
*       /* 'TO' OR 'FOR' SHOULD NOT HAVE BEEN SPECIFIED.     @Y30LB25*/ 02813000
*       /*                                                           */ 02814000
*       /*************************************************************/ 02815000
*                                                                  0763 02816000
*       ELSE                        /*                       @Y30LB25*/ 02817000
*         DO;                       /*                       @Y30LB25*/ 02818000
         B     @RC00746                                            0763 02819000
@RF00746 DS    0H                                                  0764 02820000
*           RPLVRETC=FIXFOUR;       /* SET BAD RET CODE      @Y30LB25*/ 02821000
         L     @06,RPLVPTR                                         0764 02822000
         MVC   RPLVRETC(2,@06),@CH00041                            0764 02823000
*           RPLRCODE=NOEXPICK;      /* NO EXPIRATION CK      @Y30LB25*/ 02824000
         MVC   RPLRCODE(2,@06),@CB00729                            0765 02825000
*           RETURN;                 /*                       @Y30LB25*/ 02826000
         B     @EL00017                                            0766 02827000
*         END;                      /*                       @Y30LB25*/ 02828000
*     END;                          /*                       @Y30LB25*/ 02829000
*   RETURN;                         /*                       @Y30LB25*/ 02830000
         B     @EL00017                                            0769 02831000
*   END EXPCK;                      /*                       @Y30LB25*/ 02832000
         B     @EL00017                                            0770 02833000
*                                                                  0771 02834000
*   /*****************************************************************/ 02835000
*   /*                                                               */ 02836000
*   /* PROCEDURE NAME - CKATTRIB                             @Y30LB25*/ 02837000
*   /*                                                       @Y30LB25*/ 02838000
*   /* FUNCTION -                                            @Y30LB25*/ 02839000
*   /* CHECK THE ATTRIBUTES IF THE BVR INDICATES THE VOLUME  @Y30LB25*/ 02840000
*   /* IS GROUPED GENERAL-USE OR THE DEFVE EXTENSION         @Y30LB25*/ 02841000
*   /* INDICATES THAT THE VOLUME WILL BE GROUPED             @Y30LB25*/ 02842000
*   /* GENERAL-USE.                                          @Y30LB25*/ 02843000
*   /*                                                       @Y30LB25*/ 02844000
*   /* INPUT -                                               @Y30LB25*/ 02845000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 02846000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 02847000
*   /*                                                       @Y30LB25*/ 02848000
*   /* OUTPUT -                                              @Y30LB25*/ 02849000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 02850000
*   /* AN ERROR                                              @Y30LB25*/ 02851000
*   /*                                                               */ 02852000
*   /*****************************************************************/ 02853000
*                                                                  0771 02854000
*CKATTRIB:                                                         0771 02855000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 02856000
*                                                                  0771 02857000
CKATTRIB ST    @14,@SA00018                                        0771 02858000
*   /*****************************************************************/ 02859000
*   /*                                                               */ 02860000
*   /* CHECK FOR A DEFVE AND IF THE BVR IS GOING TO BE       @Y30LB25*/ 02861000
*   /* GROUPED, OR IS NOW GROUPED.                           @Y30LB25*/ 02862000
*   /*                                                               */ 02863000
*   /*****************************************************************/ 02864000
*                                                                  0772 02865000
*   IF(DEFVVEXT^=FIXZERO&DEFPGRO=ON)|(DEFVVEXT=FIXZERO&BASGRPV=ON)|(    02866000
*       DEFVVEXT^=FIXZERO&BASGRPV=ON&DEFNGRP=OFF) THEN             0772 02867000
*                                                                  0772 02868000
         L     @06,DEFVVEXT(,DEFVPTR)                              0772 02869000
         LTR   @06,@06                                             0772 02870000
         BZ    @GL00027                                            0772 02871000
         TM    DEFPGRO(DEFVEPTR),B'00100000'                       0772 02872000
         BO    @RT00772                                            0772 02873000
@GL00027 L     @06,DEFVVEXT(,DEFVPTR)                              0772 02874000
         LTR   @06,@06                                             0772 02875000
         BNZ   @GL00026                                            0772 02876000
         L     @06,BASEVPTR                                        0772 02877000
         TM    BASGRPV(@06),B'00100000'                            0772 02878000
         BO    @RT00772                                            0772 02879000
@GL00026 L     @06,DEFVVEXT(,DEFVPTR)                              0772 02880000
         LTR   @06,@06                                             0772 02881000
         BZ    @RF00772                                            0772 02882000
         L     @06,BASEVPTR                                        0772 02883000
         TM    BASGRPV(@06),B'00100000'                            0772 02884000
         BNO   @RF00772                                            0772 02885000
         TM    DEFNGRP(DEFVEPTR),B'10000000'                       0772 02886000
         BNZ   @RF00772                                            0772 02887000
@RT00772 DS    0H                                                  0773 02888000
*     /***************************************************************/ 02889000
*     /*                                                             */ 02890000
*     /* CHECK IF IT IS BECOMING OR NOW IS GENERAL-USE.      @Y30LB25*/ 02891000
*     /*                                                             */ 02892000
*     /***************************************************************/ 02893000
*                                                                  0773 02894000
*     IF(DEFVVEXT^=FIXZERO&DEFGENUS=ON)|(DEFVVEXT=FIXZERO&BASGENUS=ON)| 02895000
*         (DEFVVEXT^=FIXZERO&BASGENUS=ON&DEFRSTD=OFF) THEN/* @Y30LB25*/ 02896000
         L     @06,DEFVVEXT(,DEFVPTR)                              0773 02897000
         LTR   @06,@06                                             0773 02898000
         BZ    @GL00033                                            0773 02899000
         TM    DEFGENUS(DEFVEPTR),B'10000000'                      0773 02900000
         BO    @RT00773                                            0773 02901000
@GL00033 L     @06,DEFVVEXT(,DEFVPTR)                              0773 02902000
         LTR   @06,@06                                             0773 02903000
         BNZ   @GL00032                                            0773 02904000
         L     @06,BASEVPTR                                        0773 02905000
         TM    BASGENUS(@06),B'00010000'                           0773 02906000
         BO    @RT00773                                            0773 02907000
@GL00032 L     @06,DEFVVEXT(,DEFVPTR)                              0773 02908000
         LTR   @06,@06                                             0773 02909000
         BZ    @RF00773                                            0773 02910000
         L     @06,BASEVPTR                                        0773 02911000
         TM    BASGENUS(@06),B'00010000'                           0773 02912000
         BNO   @RF00773                                            0773 02913000
         TM    DEFRSTD(DEFVEPTR),B'01000000'                       0773 02914000
         BNZ   @RF00773                                            0773 02915000
@RT00773 DS    0H                                                  0774 02916000
*       DO;                         /*                       @Y30LB25*/ 02917000
*                                                                  0774 02918000
*         /***********************************************************/ 02919000
*         /*                                                         */ 02920000
*         /* OBTAIN THE CORRECT GROUP NAME                   @Y30LB25*/ 02921000
*         /*                                                         */ 02922000
*         /***********************************************************/ 02923000
*                                                                  0775 02924000
*         IF DEFVVEXT^=FIXZERO&DEFPGRO=ON THEN/*             @Y30LB25*/ 02925000
         L     @06,DEFVVEXT(,DEFVPTR)                              0775 02926000
         LTR   @06,@06                                             0775 02927000
         BZ    @RF00775                                            0775 02928000
         TM    DEFPGRO(DEFVEPTR),B'00100000'                       0775 02929000
         BNO   @RF00775                                            0775 02930000
*           GROUPKY=DEFGROUP;       /*                       @Y30LB25*/ 02931000
         MVC   GROUPKY(8),DEFGROUP(DEFVEPTR)                       0776 02932000
*         ELSE                      /*                       @Y30LB25*/ 02933000
*           GROUPKY=BASGROUP;       /*                       @Y30LB25*/ 02934000
*                                                                  0777 02935000
         B     @RC00775                                            0777 02936000
@RF00775 L     @06,BASEVPTR                                        0777 02937000
         MVC   GROUPKY(8),BASGROUP(@06)                            0777 02938000
*         /***********************************************************/ 02939000
*         /*                                                         */ 02940000
*         /* READ GVR.                                       @Y30LB25*/ 02941000
*         /*                                                         */ 02942000
*         /***********************************************************/ 02943000
*                                                                  0778 02944000
*         RPLVKEY=ADDR(GKEY);       /* SET KEY ADDR          @Y30LB25*/ 02945000
@RC00775 LA    @06,GKEY                                            0778 02946000
         L     @01,RPLVPTR                                         0778 02947000
         ST    @06,RPLVKEY(,@01)                                   0778 02948000
*         CALL READLOC;             /* READ GVR              @Y30LB25*/ 02949000
         BAL   @14,READLOC                                         0779 02950000
*         IF RPLVRETC^=FIXZERO      /* ERROR?                @Y30LB25*/ 02951000
*           THEN                    /* YES                   @Y30LB25*/ 02952000
         L     @06,RPLVPTR                                         0780 02953000
         LH    @15,RPLVRETC(,@06)                                  0780 02954000
         N     @15,@CF01129                                        0780 02955000
         LTR   @15,@15                                             0780 02956000
         BNZ   @RT00780                                            0780 02957000
*           RETURN;                 /*                       @Y30LB25*/ 02958000
*         GROUPPTR=RPLVBUF;         /* MAPPING ADDR          @Y30LB25*/ 02959000
*                                                                  0782 02960000
         L     @06,RPLVBUF(,@06)                                   0782 02961000
         ST    @06,GROUPPTR                                        0782 02962000
*         /***********************************************************/ 02963000
*         /*                                                         */ 02964000
*         /* CHECK ATTRIBUTES                                @Y30LB25*/ 02965000
*         /*                                                         */ 02966000
*         /***********************************************************/ 02967000
*                                                                  0783 02968000
*         IF DEFVACT=ON|(DEFVRNM=ON&DEFVVFLG=FIX1F) THEN           0783 02969000
*                                                                  0783 02970000
         TM    DEFVACT(DEFVPTR),B'00000010'                        0783 02971000
         BO    @RT00783                                            0783 02972000
         TM    DEFVRNM(DEFVPTR),B'00100000'                        0783 02973000
         BNO   @RF00783                                            0783 02974000
         CLI   DEFVVFLG(DEFVPTR),X'FF'                             0783 02975000
         BNE   @RF00783                                            0783 02976000
@RT00783 DS    0H                                                  0784 02977000
*           /*********************************************************/ 02978000
*           /*                                                       */ 02979000
*           /* CHECK THE ATTRIBUTES BETWEEN THE BVR          @Y30LB25*/ 02980000
*           /* AND THE GVR                                   @Y30LB25*/ 02981000
*           /*                                                       */ 02982000
*           /*********************************************************/ 02983000
*                                                                  0784 02984000
*           DO;                     /*                       @Y30LB25*/ 02985000
*             IF(BASEXCL=OFF&GROEXCL=OFF)|(BASEXCL=ON&GROEXCL=ON)/*     02986000
*                                      EXCLUS MATCH?         @Y30LB25*/ 02987000
*               THEN                /* YES                   @Y30LB25*/ 02988000
         L     @06,BASEVPTR                                        0785 02989000
         TM    BASEXCL(@06),B'00000001'                            0785 02990000
         BNZ   @GL00041                                            0785 02991000
         L     @06,GROUPPTR                                        0785 02992000
         TM    GROEXCL(@06),B'01000000'                            0785 02993000
         BZ    @RT00785                                            0785 02994000
@GL00041 L     @06,BASEVPTR                                        0785 02995000
         TM    BASEXCL(@06),B'00000001'                            0785 02996000
         BNO   @RF00785                                            0785 02997000
         L     @06,GROUPPTR                                        0785 02998000
         TM    GROEXCL(@06),B'01000000'                            0785 02999000
         BNO   @RF00785                                            0785 03000000
@RT00785 DS    0H                                                  0786 03001000
*               DO;                 /*                       @Y30LB25*/ 03002000
*                 IF(BASBIND=OFF&GROBIND=OFF)|(BASBIND=ON&GROBIND=ON)   03003000
*                                   /* BIND MATCH?           @Y30LB25*/ 03004000
*                   THEN            /* YES                   @Y30LB25*/ 03005000
         L     @06,BASEVPTR                                        0787 03006000
         TM    BASBIND(@06),B'00000010'                            0787 03007000
         BNZ   @GL00044                                            0787 03008000
         L     @06,GROUPPTR                                        0787 03009000
         TM    GROBIND(@06),B'10000000'                            0787 03010000
         BZ    @RT00787                                            0787 03011000
@GL00044 L     @06,BASEVPTR                                        0787 03012000
         TM    BASBIND(@06),B'00000010'                            0787 03013000
         BNO   @RF00787                                            0787 03014000
         L     @06,GROUPPTR                                        0787 03015000
         TM    GROBIND(@06),B'10000000'                            0787 03016000
         BNO   @RF00787                                            0787 03017000
@RT00787 DS    0H                                                  0788 03018000
*                   DO;             /*                       @Y30LB25*/ 03019000
*                     IF(BASDAERA=OFF&GRODAERA=OFF)|(BASDAERA=ON&  0789 03020000
*                         GRODAERA=ON)/* DASD ERASE MATCH?   @Y30LB25*/ 03021000
*                       THEN        /* YES                   @Y30LB25*/ 03022000
         L     @06,BASEVPTR                                        0789 03023000
         TM    BASDAERA(@06),B'10000000'                           0789 03024000
         BNZ   @GL00047                                            0789 03025000
         L     @06,GROUPPTR                                        0789 03026000
         TM    GRODAERA(@06),B'00100000'                           0789 03027000
         BZ    @RT00789                                            0789 03028000
@GL00047 L     @06,BASEVPTR                                        0789 03029000
         TM    BASDAERA(@06),B'10000000'                           0789 03030000
         BNO   @RF00789                                            0789 03031000
         L     @06,GROUPPTR                                        0789 03032000
         TM    GRODAERA(@06),B'00100000'                           0789 03033000
         BNO   @RF00789                                            0789 03034000
@RT00789 DS    0H                                                  0790 03035000
*                       A=A;        /* DUMMY INSTRUC         @Y30LB25*/ 03036000
         L     @06,A                                               0790 03037000
         ST    @06,A                                               0790 03038000
*                     ELSE          /* ERROR                 @Y30LB25*/ 03039000
*                       DO;         /*                       @Y30LB25*/ 03040000
         B     @RC00789                                            0791 03041000
@RF00789 DS    0H                                                  0792 03042000
*                         RPLVRETC=FIXFOUR;/*                @Y30LB25*/ 03043000
         L     @06,RPLVPTR                                         0792 03044000
         MVC   RPLVRETC(2,@06),@CH00041                            0792 03045000
*                         RPLRCODE=MISATTB;/*                @Y30LB25*/ 03046000
         MVC   RPLRCODE(2,@06),@CB00731                            0793 03047000
*                         RETURN;   /*                       @Y30LB25*/ 03048000
@EL00018 DS    0H                                                  0794 03049000
@EF00018 DS    0H                                                  0794 03050000
@ER00018 L     @14,@SA00018                                        0794 03051000
         BR    @14                                                 0794 03052000
*                       END;        /*                       @Y30LB25*/ 03053000
*                   END;            /*                       @Y30LB25*/ 03054000
*                 ELSE              /* ERROR                 @Y30LB25*/ 03055000
*                   DO;             /*                       @Y30LB25*/ 03056000
         B     @RC00787                                            0797 03057000
@RF00787 DS    0H                                                  0798 03058000
*                     RPLVRETC=FIXFOUR;/*                    @Y30LB25*/ 03059000
         L     @06,RPLVPTR                                         0798 03060000
         MVC   RPLVRETC(2,@06),@CH00041                            0798 03061000
*                     RPLRCODE=MISATTB;/*                    @Y30LB25*/ 03062000
         MVC   RPLRCODE(2,@06),@CB00731                            0799 03063000
*                     RETURN;       /*                       @Y30LB25*/ 03064000
         B     @EL00018                                            0800 03065000
*                   END;            /*                       @Y30LB25*/ 03066000
*               END;                /*                       @Y30LB25*/ 03067000
*             ELSE                  /* ERROR                 @Y30LB25*/ 03068000
*               DO;                 /*                       @Y30LB25*/ 03069000
         B     @RC00785                                            0803 03070000
@RF00785 DS    0H                                                  0804 03071000
*                 RPLVRETC=FIXFOUR; /*                       @Y30LB25*/ 03072000
         L     @06,RPLVPTR                                         0804 03073000
         MVC   RPLVRETC(2,@06),@CH00041                            0804 03074000
*                 RPLRCODE=MISATTB; /*                       @Y30LB25*/ 03075000
         MVC   RPLRCODE(2,@06),@CB00731                            0805 03076000
*                 RETURN;           /*                       @Y30LB25*/ 03077000
         B     @EL00018                                            0806 03078000
*               END;                /*                       @Y30LB25*/ 03079000
*           END;                    /*                       @Y30LB25*/ 03080000
*                                                                  0808 03081000
*         /***********************************************************/ 03082000
*         /*                                                         */ 03083000
*         /* CHECK ATTRIBUTES BETWEEN THE GVR AND            @Y30LB25*/ 03084000
*         /* THE ICBDEFV REQUEST BLOCK                       @Y30LB25*/ 03085000
*         /*                                                         */ 03086000
*         /***********************************************************/ 03087000
*                                                                  0809 03088000
*         ELSE                                                     0809 03089000
*           DO;                     /*                       @Y30LB25*/ 03090000
         B     @RC00783                                            0809 03091000
@RF00783 DS    0H                                                  0810 03092000
*             IF(DEFVEXCL=OFF&GROEXCL=OFF)|(DEFVEXCL=ON&GROEXCL=ON)/*   03093000
*                                      EXCLUS MATCH?         @Y30LB25*/ 03094000
*               THEN                /* YES                   @Y30LB25*/ 03095000
         TM    DEFVEXCL(DEFVPTR),B'00010000'                       0810 03096000
         BNZ   @GL00050                                            0810 03097000
         L     @06,GROUPPTR                                        0810 03098000
         TM    GROEXCL(@06),B'01000000'                            0810 03099000
         BZ    @RT00810                                            0810 03100000
@GL00050 TM    DEFVEXCL(DEFVPTR),B'00010000'                       0810 03101000
         BNO   @RF00810                                            0810 03102000
         L     @06,GROUPPTR                                        0810 03103000
         TM    GROEXCL(@06),B'01000000'                            0810 03104000
         BNO   @RF00810                                            0810 03105000
@RT00810 DS    0H                                                  0811 03106000
*               DO;                 /*                       @Y30LB25*/ 03107000
*                 IF(DEFVBIND=OFF&GROBIND=OFF)|(DEFVBIND=ON&GROBIND=ON) 03108000
*                                   /* BIND MATCH?           @Y30LB25*/ 03109000
*                   THEN            /* YES                   @Y30LB25*/ 03110000
         TM    DEFVBIND(DEFVPTR),B'00000100'                       0812 03111000
         BNZ   @GL00053                                            0812 03112000
         L     @06,GROUPPTR                                        0812 03113000
         TM    GROBIND(@06),B'10000000'                            0812 03114000
         BZ    @RT00812                                            0812 03115000
@GL00053 TM    DEFVBIND(DEFVPTR),B'00000100'                       0812 03116000
         BNO   @RF00812                                            0812 03117000
         L     @06,GROUPPTR                                        0812 03118000
         TM    GROBIND(@06),B'10000000'                            0812 03119000
         BNO   @RF00812                                            0812 03120000
@RT00812 DS    0H                                                  0813 03121000
*                   DO;             /*                       @Y30LB25*/ 03122000
*                     IF(DEFVSEC=OFF&GRODAERA=OFF)|(DEFVSEC=ON&GRODAERA 03123000
*                         =ON)      /* DASD ERASE MATCH?     @Y30LB25*/ 03124000
*                       THEN        /* YES                   @Y30LB25*/ 03125000
         TM    DEFVSEC(DEFVPTR),B'00100000'                        0814 03126000
         BNZ   @GL00056                                            0814 03127000
         L     @06,GROUPPTR                                        0814 03128000
         TM    GRODAERA(@06),B'00100000'                           0814 03129000
         BZ    @RT00814                                            0814 03130000
@GL00056 TM    DEFVSEC(DEFVPTR),B'00100000'                        0814 03131000
         BNO   @RF00814                                            0814 03132000
         L     @06,GROUPPTR                                        0814 03133000
         TM    GRODAERA(@06),B'00100000'                           0814 03134000
         BNO   @RF00814                                            0814 03135000
@RT00814 DS    0H                                                  0815 03136000
*                       A=A;        /* DUMMY INSTRUC         @Y30LB25*/ 03137000
         L     @06,A                                               0815 03138000
         ST    @06,A                                               0815 03139000
*                     ELSE          /* ERROR                 @Y30LB25*/ 03140000
*                       DO;         /*                       @Y30LB25*/ 03141000
         B     @RC00814                                            0816 03142000
@RF00814 DS    0H                                                  0817 03143000
*                         RPLVRETC=FIXFOUR;/*                @Y30LB25*/ 03144000
         L     @06,RPLVPTR                                         0817 03145000
         MVC   RPLVRETC(2,@06),@CH00041                            0817 03146000
*                         RPLRCODE=MISATTB;/*                @Y30LB25*/ 03147000
         MVC   RPLRCODE(2,@06),@CB00731                            0818 03148000
*                         RETURN;   /*                       @Y30LB25*/ 03149000
         B     @EL00018                                            0819 03150000
*                       END;        /*                       @Y30LB25*/ 03151000
*                   END;            /*                       @Y30LB25*/ 03152000
*                 ELSE              /* ERROR                 @Y30LB25*/ 03153000
*                   DO;             /*                       @Y30LB25*/ 03154000
         B     @RC00812                                            0822 03155000
@RF00812 DS    0H                                                  0823 03156000
*                     RPLVRETC=FIXFOUR;/*                    @Y30LB25*/ 03157000
         L     @06,RPLVPTR                                         0823 03158000
         MVC   RPLVRETC(2,@06),@CH00041                            0823 03159000
*                     RPLRCODE=MISATTB;/*                    @Y30LB25*/ 03160000
         MVC   RPLRCODE(2,@06),@CB00731                            0824 03161000
*                     RETURN;       /*                       @Y30LB25*/ 03162000
         B     @EL00018                                            0825 03163000
*                   END;            /*                       @Y30LB25*/ 03164000
*               END;                /*                       @Y30LB25*/ 03165000
*             ELSE                  /* ERROR                 @Y30LB25*/ 03166000
*               DO;                 /*                       @Y30LB25*/ 03167000
         B     @RC00810                                            0828 03168000
@RF00810 DS    0H                                                  0829 03169000
*                 RPLVRETC=FIXFOUR; /*                       @Y30LB25*/ 03170000
         L     @06,RPLVPTR                                         0829 03171000
         MVC   RPLVRETC(2,@06),@CH00041                            0829 03172000
*                 RPLRCODE=MISATTB; /*                       @Y30LB25*/ 03173000
         MVC   RPLRCODE(2,@06),@CB00731                            0830 03174000
*                 RETURN;           /*                       @Y30LB25*/ 03175000
         B     @EL00018                                            0831 03176000
*               END;                /*                       @Y30LB25*/ 03177000
*           END;                    /*                       @Y30LB25*/ 03178000
*                                                                  0833 03179000
@RC00810 DS    0H                                                  0834 03180000
*         /***********************************************************/ 03181000
*         /*                                                         */ 03182000
*         /* CHECK READ ONLY FOR - REPLACE VOLUME FLAGS.     @Y30LB25*/ 03183000
*         /*                                                         */ 03184000
*         /***********************************************************/ 03185000
*                                                                  0834 03186000
*         IF DEFVREP=ON             /* REPLACE VOL FLAGS     @Y30LB25*/ 03187000
*           THEN                    /* YES                   @Y30LB25*/ 03188000
@RC00783 TM    DEFVREP(DEFVPTR),B'00010000'                        0834 03189000
         BNO   @RF00834                                            0834 03190000
*           IF(DEFVWINH=OFF&GRORONLY=OFF)|(DEFVWINH=ON&GRORONLY=ON)/*   03191000
*                                      READ ONLY MATCH?      @Y30LB25*/ 03192000
*             THEN                  /* YES                   @Y30LB25*/ 03193000
         TM    DEFVWINH(DEFVPTR),B'00000010'                       0835 03194000
         BNZ   @GL00059                                            0835 03195000
         L     @06,GROUPPTR                                        0835 03196000
         TM    GRORONLY(@06),B'00010000'                           0835 03197000
         BZ    @RT00835                                            0835 03198000
@GL00059 TM    DEFVWINH(DEFVPTR),B'00000010'                       0835 03199000
         BNO   @RF00835                                            0835 03200000
         L     @06,GROUPPTR                                        0835 03201000
         TM    GRORONLY(@06),B'00010000'                           0835 03202000
         BO    @RT00835                                            0835 03203000
*             RETURN;               /*                       @Y30LB25*/ 03204000
*           ELSE                    /* NO                    @Y30LB25*/ 03205000
*             DO;                   /*                       @Y30LB25*/ 03206000
@RF00835 DS    0H                                                  0838 03207000
*               RPLVRETC=FIXFOUR;   /*                       @Y30LB25*/ 03208000
         L     @06,RPLVPTR                                         0838 03209000
         MVC   RPLVRETC(2,@06),@CH00041                            0838 03210000
*               RPLRCODE=MISATTB;   /*                       @Y30LB25*/ 03211000
         MVC   RPLRCODE(2,@06),@CB00731                            0839 03212000
*             END;                  /*                       @Y30LB25*/ 03213000
*       END;                        /*                       @Y30LB25*/ 03214000
*   RETURN;                         /*                       @Y30LB25*/ 03215000
         B     @EL00018                                            0842 03216000
*   END CKATTRIB;                   /*                       @Y30LB25*/ 03217000
         B     @EL00018                                            0843 03218000
*                                                                  0844 03219000
*   /*****************************************************************/ 03220000
*   /*                                                               */ 03221000
*   /* PROCEDURE NAME - ACTVOL2                              @Y30LB25*/ 03222000
*   /*                                                       @Y30LB25*/ 03223000
*   /* FUNCTION - PROCESS A VOLUME AFTER THE CALL TO THE     @Y30LB25*/ 03224000
*   /* MSC WHICH HAS JUST MADE IT ACTIVE.                    @Y30LB25*/ 03225000
*   /*                                                       @Y30LB25*/ 03226000
*   /* RESTRICTIONS - CAN NOT CHANGE THE VOLUME FROM         @Y30LB25*/ 03227000
*   /* GENERAL TO RESTRICTED OR RESTRICTED TO GENERAL,       @Y30LB25*/ 03228000
*   /* REMOVE OR ADD A VOLUME TO A GROUP, AND MOVE           @Y30LB25*/ 03229000
*   /* A VOLUME FROM ONE GROUP TO ANOTHER GROUP.             @Y30LB25*/ 03230000
*   /* THIS WILL RESULT IN MSVI PROBLEMS.                    @Y30LB25*/ 03231000
*   /*                                                       @Y30LB25*/ 03232000
*   /* INPUT -                                               @Y30LB25*/ 03233000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 03234000
*   /*                                                       @Y30LB25*/ 03235000
*   /* OUTPUT -                                              @Y30LB25*/ 03236000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 03237000
*   /* AN ERROR                                              @Y30LB25*/ 03238000
*   /*                                                               */ 03239000
*   /*****************************************************************/ 03240000
*                                                                  0844 03241000
*ACTVOL2:                           /*                       @Y30LB25*/ 03242000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 03243000
ACTVOL2  ST    @14,@SA00019                                        0844 03244000
*   IF RPLRCODE^=FIXZERO            /* MSC ERROR?            @Y30LB25*/ 03245000
*     THEN                          /* YES                   @Y30LB25*/ 03246000
         L     @06,RPLVPTR                                         0845 03247000
         LH    @15,RPLRCODE(,@06)                                  0845 03248000
         N     @15,@CF01129                                        0845 03249000
         LTR   @15,@15                                             0845 03250000
         BZ    @RF00845                                            0845 03251000
*     DO;                           /*                       @Y30LB25*/ 03252000
*       RPLVRETC=RPLVRETC&&RPLVRETC;/* ZERO RETN CODE        @Y30LB25*/ 03253000
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       0847 03254000
*       RPLRCODE=RPLRCODE&&RPLRCODE;/* ZERO RESN CODE        @Y30LB25*/ 03255000
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       0848 03256000
*       RETURN;                     /*                       @Y30LB25*/ 03257000
@EL00019 DS    0H                                                  0849 03258000
@EF00019 DS    0H                                                  0849 03259000
@ER00019 L     @14,@SA00019                                        0849 03260000
         BR    @14                                                 0849 03261000
*     END;                          /*                       @Y30LB25*/ 03262000
*   CALL HOUSKEEP;                  /* JRNL RPLV &           @Y30LB25   03263000
*                                      RESERVE .MSVI         @Y30LB25*/ 03264000
*                                                                  0851 03265000
@RF00845 BAL   @14,HOUSKEEP                                        0851 03266000
*   /*****************************************************************/ 03267000
*   /*                                                               */ 03268000
*   /* READ FOR CIR TO GET THE BVR OR CVR KEY.               @ZDR2054*/ 03269000
*   /* THEN GET THE BASE OR COPY RECORD FROM ITS KEY         @ZDR2054*/ 03270000
*   /* IN THE CIR - FOR UPDATE                               @ZDR2054*/ 03271000
*   /*                                                               */ 03272000
*   /*****************************************************************/ 03273000
*                                                                  0852 03274000
*   IVOLKY=DEFVCSN1;                /* SET UP KEY            @Y30LB25*/ 03275000
         MVC   IVOLKY(12),DEFVCSN1(DEFVPTR)                        0852 03276000
*   CALL GETRECUD;                  /* GET RECORD            @Y30LB25*/ 03277000
         BAL   @14,GETRECUD                                        0853 03278000
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/ 03279000
*     THEN                          /* YES                   @Y30LB25*/ 03280000
         L     @06,RPLVPTR                                         0854 03281000
         LH    @06,RPLVRETC(,@06)                                  0854 03282000
         N     @06,@CF01129                                        0854 03283000
         LTR   @06,@06                                             0854 03284000
         BNZ   @RT00854                                            0854 03285000
*     RETURN;                       /*                       @Y30LB25*/ 03286000
*                                                                  0855 03287000
*   /*****************************************************************/ 03288000
*   /*                                                               */ 03289000
*   /* CHECK FOR ACTIVATE OF A CVR                           @ZDR2054*/ 03290000
*   /*                                                               */ 03291000
*   /*****************************************************************/ 03292000
*                                                                  0856 03293000
*   BCDVPTR=ADDR(BASEBUF);          /* COMMON MAP BVR BUF    @ZDR2054*/ 03294000
         LA    @06,BASEBUF                                         0856 03295000
         ST    @06,BCDVPTR                                         0856 03296000
*   IF BCDCOPY=ON THEN              /* CVR?                  @ZDR2054*/ 03297000
         TM    BCDCOPY(@06),B'00010000'                            0857 03298000
         BNO   @RF00857                                            0857 03299000
*     DO;                           /* YES                   @ZDR2054*/ 03300000
*       COPYBUF=BASEBUF;            /* CVR TO CVR BUF        @ZDR2054*/ 03301000
*                                                                  0859 03302000
         MVC   COPYBUF(224),BASEBUF                                0859 03303000
*       /*************************************************************/ 03304000
*       /*                                                           */ 03305000
*       /* MAKE THE CVR INTO A BVR                           @ZDR2054*/ 03306000
*       /*                                                           */ 03307000
*       /*************************************************************/ 03308000
*                                                                  0860 03309000
*       CALL CVRTOBVR;              /* CVR TO A BVR          @ZDR2054*/ 03310000
         BAL   @14,CVRTOBVR                                        0860 03311000
*       IF RPLVRETC^=FIXZERO THEN   /* ERROR?                @ZDR2054*/ 03312000
         L     @06,RPLVPTR                                         0861 03313000
         LH    @06,RPLVRETC(,@06)                                  0861 03314000
         N     @06,@CF01129                                        0861 03315000
         LTR   @06,@06                                             0861 03316000
         BNZ   @RT00861                                            0861 03317000
*         RETURN;                   /* YES                   @ZDR2054*/ 03318000
*     END;                          /*                       @ZDR2054*/ 03319000
*                                                                  0863 03320000
*   /*****************************************************************/ 03321000
*   /*                                                               */ 03322000
*   /* UPDATE THE BVR                                        @Y30LB25*/ 03323000
*   /*                                                               */ 03324000
*   /*****************************************************************/ 03325000
*                                                                  0864 03326000
*   BASINAC=OFF;                    /* MAKE ACTIVE           @Y30LB25*/ 03327000
@RF00857 L     @06,BASEVPTR                                        0864 03328000
         NI    BASINAC(@06),B'11111011'                            0864 03329000
*   BASHOLD=OFF;                    /* MAKE NOT A PHOLD      @ZA17163*/ 03330000
         NI    BASHOLD(@06),B'01111111'                            0865 03331000
*   IF BASLIB1=FIX1F&BASLIB2^=FIX1F /* NULL LIBID 1?         @Y30LB25*/ 03332000
*     THEN                          /* YES                   @Y30LB25*/ 03333000
         CLI   BASLIB1(@06),255                                    0866 03334000
         BNE   @RF00866                                            0866 03335000
         CLI   BASLIB2(@06),255                                    0866 03336000
         BE    @RF00866                                            0866 03337000
*     BASLIB1=BASLIB2;              /* SET LIBID 1           @Y30LB25*/ 03338000
         IC    @15,BASLIB2(,@06)                                   0867 03339000
         STC   @15,BASLIB1(,@06)                                   0867 03340000
*   IF BASLIB2=FIX1F&BASLIB1^=FIX1F /* NULL LIBID 2?         @Y30LB25*/ 03341000
*     THEN                          /* YES                   @Y30LB25*/ 03342000
@RF00866 L     @06,BASEVPTR                                        0868 03343000
         CLI   BASLIB2(@06),255                                    0868 03344000
         BNE   @RF00868                                            0868 03345000
         CLI   BASLIB1(@06),255                                    0868 03346000
         BE    @RF00868                                            0868 03347000
*     BASLIB2=BASLIB1;              /* SET LIBID 2           @Y30LB25*/ 03348000
*                                                                  0869 03349000
         IC    @15,BASLIB1(,@06)                                   0869 03350000
         STC   @15,BASLIB2(,@06)                                   0869 03351000
*   /*****************************************************************/ 03352000
*   /*                                                               */ 03353000
*   /* CHECK FOR AN EXTENSION (IEZDEFVE)                     @Y30LB25*/ 03354000
*   /*                                                               */ 03355000
*   /*****************************************************************/ 03356000
*                                                                  0870 03357000
*   IF DEFVVEXT^=FIXZERO            /* A DEFVE?              @Y30LB25*/ 03358000
*     THEN                          /* YES                   @Y30LB25*/ 03359000
@RF00868 L     @06,DEFVVEXT(,DEFVPTR)                              0870 03360000
         LTR   @06,@06                                             0870 03361000
         BZ    @RF00870                                            0870 03362000
*     DO;                           /*                       @Y30LB25*/ 03363000
*       BCDVPTR=BASEVPTR;           /* SET COM MAP PTR       @Y30LB25*/ 03364000
         L     @06,BASEVPTR                                        0872 03365000
         ST    @06,BCDVPTR                                         0872 03366000
*       CALL PRODEFVE;              /* PROCESS DEFVE         @Y30LB25*/ 03367000
         BAL   @14,PRODEFVE                                        0873 03368000
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/ 03369000
*         THEN                      /* YES                   @Y30LB25*/ 03370000
         L     @06,RPLVPTR                                         0874 03371000
         LH    @06,RPLVRETC(,@06)                                  0874 03372000
         N     @06,@CF01129                                        0874 03373000
         LTR   @06,@06                                             0874 03374000
         BNZ   @RT00874                                            0874 03375000
*         RETURN;                   /*                       @Y30LB25*/ 03376000
*     END;                          /*                       @Y30LB25*/ 03377000
*                                                                  0876 03378000
*   /*****************************************************************/ 03379000
*   /*                                                               */ 03380000
*   /* CHECK IF VOLUME IS GROUPED                            @Y30LB25*/ 03381000
*   /* GROUP CHANGES WILL NOT OCCUR ON AN ACTIVE VOLUME.     @Y30LB25*/ 03382000
*   /*                                                               */ 03383000
*   /*****************************************************************/ 03384000
*                                                                  0877 03385000
*   IF BASGRPV=ON                   /* GROUPED?              @Y30LB25*/ 03386000
*     THEN                          /* YES                   @Y30LB25*/ 03387000
@RF00870 L     @06,BASEVPTR                                        0877 03388000
         TM    BASGRPV(@06),B'00100000'                            0877 03389000
         BNO   @RF00877                                            0877 03390000
*     DO;                           /*                       @Y30LB25*/ 03391000
*                                                                  0878 03392000
*       /*************************************************************/ 03393000
*       /*                                                           */ 03394000
*       /* GET AND UPDATE THE GROUP VOLUME RECORD            @Y30LB25*/ 03395000
*       /*                                                           */ 03396000
*       /*************************************************************/ 03397000
*                                                                  0879 03398000
*       GROUPKY=BASGROUP;           /* SET GROUP NAME        @Y30LB25*/ 03399000
         MVC   GROUPKY(8),BASGROUP(@06)                            0879 03400000
*       RPLVKEY=ADDR(GKEY);         /* ADDR OF KEY           @Y30LB25*/ 03401000
         LA    @06,GKEY                                            0880 03402000
         L     @01,RPLVPTR                                         0880 03403000
         ST    @06,RPLVKEY(,@01)                                   0880 03404000
*       CALL READUPD1;              /* READ GVR              @Y30LB25*/ 03405000
         BAL   @14,READUPD1                                        0881 03406000
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/ 03407000
*         THEN                      /* YES                   @Y30LB25*/ 03408000
         L     @06,RPLVPTR                                         0882 03409000
         LH    @06,RPLVRETC(,@06)                                  0882 03410000
         N     @06,@CF01129                                        0882 03411000
         LTR   @06,@06                                             0882 03412000
         BNZ   @RT00882                                            0882 03413000
*         RETURN;                   /*                       @Y30LB25*/ 03414000
*       GROUPBUF=BASEBUF1;          /* USE CORRECT BUFF      @Y30LB25*/ 03415000
         MVC   GROUPBUF(224),BASEBUF1                              0884 03416000
*       GRONINAC=GRONINAC-FIXONE;   /* DECR # INACT VOLS     @Y30LB25*/ 03417000
         L     @06,GROUPPTR                                        0885 03418000
         LH    @15,GRONINAC(,@06)                                  0885 03419000
         BCTR  @15,0                                               0885 03420000
         STH   @15,GRONINAC(,@06)                                  0885 03421000
*       IF BASRSTD=ON               /* RESTRICTED?           @Y30LB25*/ 03422000
*         THEN                      /* YES                   @Y30LB25*/ 03423000
         L     @01,BASEVPTR                                        0886 03424000
         TM    BASRSTD(@01),B'00001000'                            0886 03425000
         BNO   @RF00886                                            0886 03426000
*         GRONRSTD=GRONRSTD+FIXONE; /*                       @Y30LB25   03427000
*                                      INCR # RSTD VOLS      @Y30LB25*/ 03428000
         LA    @15,1                                               0887 03429000
         AH    @15,GRONRSTD(,@06)                                  0887 03430000
         STH   @15,GRONRSTD(,@06)                                  0887 03431000
*       ELSE                        /* CK GEN-USE            @Y30LB25*/ 03432000
*         IF BASGENUS=ON            /* GENERAL-USE?          @Y30LB25*/ 03433000
*           THEN                    /* YES                   @Y30LB25*/ 03434000
         B     @RC00886                                            0888 03435000
@RF00886 L     @06,BASEVPTR                                        0888 03436000
         TM    BASGENUS(@06),B'00010000'                           0888 03437000
         BNO   @RF00888                                            0888 03438000
*           DO;                     /*                       @Y30LB25*/ 03439000
*             GRONGEN=GRONGEN+FIXONE;/*                      @Y30LB25   03440000
*                                      INCR # G-USE VOLS     @Y30LB25*/ 03441000
*                                                                  0890 03442000
         L     @06,GROUPPTR                                        0890 03443000
         LA    @15,1                                               0890 03444000
         AH    @15,GRONGEN(,@06)                                   0890 03445000
         STH   @15,GRONGEN(,@06)                                   0890 03446000
*             /*******************************************************/ 03447000
*             /*                                                     */ 03448000
*             /* PROCESS GROUP VOLUME RECORD                 @Y30LB25*/ 03449000
*             /*                                                     */ 03450000
*             /*******************************************************/ 03451000
*                                                                  0891 03452000
*             ADDSUBGR=ON;          /* ADD                   @Y30LB25*/ 03453000
         OI    ADDSUBGR,B'00001000'                                0891 03454000
*             CALL VUPGH;           /* UPDATE GVR            @Y30LB25*/ 03455000
         BAL   @14,VUPGH                                           0892 03456000
*           END;                    /*                       @Y30LB25*/ 03457000
*       RPLVBUF=ADDR(GROUPBUF);     /* GVR BUF ADDR          @Y30LB25*/ 03458000
@RF00888 DS    0H                                                  0894 03459000
@RC00886 LA    @06,GROUPBUF                                        0894 03460000
         L     @01,RPLVPTR                                         0894 03461000
         ST    @06,RPLVBUF(,@01)                                   0894 03462000
*       CALL WRITRECD;              /* WRITE GVR             @Y30LB25*/ 03463000
         BAL   @14,WRITRECD                                        0895 03464000
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/ 03465000
*         THEN                      /* YES                   @Y30LB25*/ 03466000
         L     @06,RPLVPTR                                         0896 03467000
         LH    @06,RPLVRETC(,@06)                                  0896 03468000
         N     @06,@CF01129                                        0896 03469000
         LTR   @06,@06                                             0896 03470000
         BNZ   @RT00896                                            0896 03471000
*         RETURN;                   /*                       @Y30LB25*/ 03472000
*                                                                  0897 03473000
*       /*************************************************************/ 03474000
*       /*                                                           */ 03475000
*       /* CHECK FOR GENERAL-USE                             @Y30LB25*/ 03476000
*       /*                                                           */ 03477000
*       /*************************************************************/ 03478000
*                                                                  0898 03479000
*       IF BASGENUS=ON              /* GENERAL-USE?          @Y30LB25*/ 03480000
*         THEN                      /* YES                   @Y30LB25*/ 03481000
*                                                                  0898 03482000
         L     @06,BASEVPTR                                        0898 03483000
         TM    BASGENUS(@06),B'00010000'                           0898 03484000
         BNO   @RF00898                                            0898 03485000
*         /***********************************************************/ 03486000
*         /*                                                         */ 03487000
*         /* ADD A GROUP VOLUME SERIAL NUMBER EXTENSION SLOT @Y30LB25*/ 03488000
*         /*                                                         */ 03489000
*         /***********************************************************/ 03490000
*                                                                  0899 03491000
*         DO;                       /*                       @Y30LB25*/ 03492000
*           EXPSLOT=OFF;            /* NO EXPIR DATE         @Y30LB25*/ 03493000
         NI    EXPSLOT,B'01111111'                                 0900 03494000
*           ADDSUBSL=ON;            /* ADD                   @Y30LB25*/ 03495000
         OI    ADDSUBSL,B'00000010'                                0901 03496000
*           CALL ICBVUEXT(GROUPPTR,BASEVPTR,RPLVPTR,PASSBYTE);/*   0902 03497000
*                                                            @Y30LB25   03498000
*                                      CREATE A SLOT         @Y30LB25*/ 03499000
         L     @15,@CV00767                                        0902 03500000
         LA    @01,@AL00902                                        0902 03501000
         BALR  @14,@15                                             0902 03502000
*           IF RPLVRETC^=FIXZERO    /* ERROR?                @Y30LB25*/ 03503000
*             THEN                  /* YES                   @Y30LB25*/ 03504000
         L     @06,RPLVPTR                                         0903 03505000
         LH    @06,RPLVRETC(,@06)                                  0903 03506000
         N     @06,@CF01129                                        0903 03507000
         LTR   @06,@06                                             0903 03508000
         BNZ   @RT00903                                            0903 03509000
*             RETURN;               /*                       @Y30LB25*/ 03510000
*         END;                      /*                       @Y30LB25*/ 03511000
*     END;                          /*                       @Y30LB25*/ 03512000
*                                                                  0906 03513000
@RF00898 DS    0H                                                  0907 03514000
*   /*****************************************************************/ 03515000
*   /*                                                               */ 03516000
*   /* REESABLISH BVR RPL                                    @Y30LB25*/ 03517000
*   /*                                                               */ 03518000
*   /*****************************************************************/ 03519000
*                                                                  0907 03520000
*   BVOLKY=BASSERNO;                /* RESET VOLID           @Y30LB25*/ 03521000
@RF00877 L     @06,BASEVPTR                                        0907 03522000
         MVC   BVOLKY(6),BASSERNO(@06)                             0907 03523000
*   RPLVKEY=ADDR(BKEY);             /* SET KEY ADDR          @Y30LB25*/ 03524000
         LA    @06,BKEY                                            0908 03525000
         L     @01,RPLVPTR                                         0908 03526000
         ST    @06,RPLVKEY(,@01)                                   0908 03527000
*   CALL READUPD1;                  /* READ BVR              @Y30LB25*/ 03528000
         BAL   @14,READUPD1                                        0909 03529000
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/ 03530000
*     THEN                          /* YES                   @Y30LB25*/ 03531000
         L     @06,RPLVPTR                                         0910 03532000
         LH    @15,RPLVRETC(,@06)                                  0910 03533000
         N     @15,@CF01129                                        0910 03534000
         LTR   @15,@15                                             0910 03535000
         BNZ   @RT00910                                            0910 03536000
*     RETURN;                       /*                       @Y30LB25*/ 03537000
*   RPLVBUF=ADDR(BASEBUF);          /* BUFF ADDR             @Y30LB25*/ 03538000
         LA    @15,BASEBUF                                         0912 03539000
         ST    @15,RPLVBUF(,@06)                                   0912 03540000
*   CALL WRITRECD;                  /* WRITE BVR             @Y30LB25*/ 03541000
         BAL   @14,WRITRECD                                        0913 03542000
*   RETURN;                         /*                       @Y30LB25*/ 03543000
         B     @EL00019                                            0914 03544000
*   END ACTVOL2;                    /*                       @Y30LB25*/ 03545000
         B     @EL00019                                            0915 03546000
*                                                                  0916 03547000
*   /*****************************************************************/ 03548000
*   /*                                                               */ 03549000
*   /* PROCEDURE NAME - CVRTOBVR                             @ZDR2054*/ 03550000
*   /*                                                       @ZDR2054*/ 03551000
*   /* FUNCTION - MAKE A COPY VOLUME WHOSE BASE VOLUME       @ZDR2054*/ 03552000
*   /* HAS HAD ITS CARTRIDGES REASSIGNED OR EJECTED          @ZDR2054*/ 03553000
*   /* INTO A BASE VOLUME WITH THE SAME VOLID. THE           @ZDR2054*/ 03554000
*   /* CHECK FOR THE CARTRIDGES BEING REASSIGNED OR          @ZDR2054*/ 03555000
*   /* EJECTED HAS BEEN MADE BY THE ADDV UTILITY.            @ZDR2054*/ 03556000
*   /*                                                       @ZDR2054*/ 03557000
*   /* INPUT -                                               @ZDR2054*/ 03558000
*   /* MSVC REQUEST PARAMETER LIST                           @ZDR2054*/ 03559000
*   /* BASE VOLUME RECORD                                    @ZDR2054*/ 03560000
*   /* COPY VOLUME RECORD                                    @ZDR2054*/ 03561000
*   /*                                                       @ZDR2054*/ 03562000
*   /* OUTPUT -                                              @ZDR2054*/ 03563000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @ZDR2054*/ 03564000
*   /* AN ERROR                                              @ZDR2054*/ 03565000
*   /* BASE VOLUME RECORD                                    @ZDR2054*/ 03566000
*   /*                                                               */ 03567000
*   /*****************************************************************/ 03568000
*                                                                  0916 03569000
*CVRTOBVR:                          /*                       @ZDR2054*/ 03570000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 03571000
*                                                                  0916 03572000
CVRTOBVR ST    @14,@SA00020                                        0916 03573000
*   /*****************************************************************/ 03574000
*   /*                                                               */ 03575000
*   /* DELETE THE CVR                                        @ZDR2054*/ 03576000
*   /*                                                               */ 03577000
*   /*****************************************************************/ 03578000
*                                                                  0917 03579000
*   RPLVBUF=ADDR(COPYBUF);          /* CVR BUF ADDR          @ZDR2054*/ 03580000
         L     @06,RPLVPTR                                         0917 03581000
         LA    @15,COPYBUF                                         0917 03582000
         ST    @15,RPLVBUF(,@06)                                   0917 03583000
*   RPLVTYP=RPLVDEL;                /* DELETE                @ZDR2054*/ 03584000
         MVI   RPLVTYP(@06),X'05'                                  0918 03585000
*   RESPECIFY                                                      0919 03586000
*     RG1 RSTD;                     /* RESTRICT REG 1        @ZDR2054*/ 03587000
*   RG1=RPLVPTR;                    /* PT TO RPLV            @ZDR2054*/ 03588000
         LR    RG1,@06                                             0920 03589000
*   CALL ICBVIO00;                  /* DELET BVR PLC HOLD    @ZDR2054*/ 03590000
         L     @15,@CV00762                                        0921 03591000
         BALR  @14,@15                                             0921 03592000
*   RESPECIFY                                                      0922 03593000
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @ZDR2054*/ 03594000
*                                                                  0922 03595000
*   /*****************************************************************/ 03596000
*   /*                                                               */ 03597000
*   /* READ THE BVR FOR UPDATE                               @ZDR2054*/ 03598000
*   /*                                                               */ 03599000
*   /*****************************************************************/ 03600000
*                                                                  0923 03601000
*   BVOLKY=COPSERNO;                /* SERIAL NUMBER         @ZDR2054*/ 03602000
         L     @06,COPYVPTR                                        0923 03603000
         MVC   BVOLKY(6),COPSERNO(@06)                             0923 03604000
*   RPLVKEY=ADDR(BKEY);             /* KEY ADDR              @ZDR2054*/ 03605000
         LA    @06,BKEY                                            0924 03606000
         L     @01,RPLVPTR                                         0924 03607000
         ST    @06,RPLVKEY(,@01)                                   0924 03608000
*   CALL READUPD1;                  /* READ BVR              @ZDR2054*/ 03609000
         BAL   @14,READUPD1                                        0925 03610000
*   IF RPLVRETC^=FIXZERO THEN       /* ERROR?                @ZDR2054*/ 03611000
         L     @06,RPLVPTR                                         0926 03612000
         LH    @15,RPLVRETC(,@06)                                  0926 03613000
         N     @15,@CF01129                                        0926 03614000
         LTR   @15,@15                                             0926 03615000
         BNZ   @RT00926                                            0926 03616000
*     RETURN;                       /* YES                   @ZDR2054*/ 03617000
*   BASEBUF=BASEBUF1;               /* BVR TO BVR BUF        @ZDR2054*/ 03618000
*                                                                  0928 03619000
         MVC   BASEBUF(224),BASEBUF1                               0928 03620000
*   /*****************************************************************/ 03621000
*   /*                                                               */ 03622000
*   /* GET AND DELETE THE BVR'S CIRS.                        @ZDR2054*/ 03623000
*   /* DO NOT CHECK RETURN CODE FROM DELTRECD BECAUSE        @ZDR2054*/ 03624000
*   /* MSVC WILL CLEAN UP CIR UPON CARTRIDGE ENTRY.          @ZDR2054*/ 03625000
*   /*                                                               */ 03626000
*   /*****************************************************************/ 03627000
*                                                                  0929 03628000
*   IVOLKY=BASCSN1;                 /* CIR KEY FOR CSN1      @ZDR2054*/ 03629000
         L     @01,BASEVPTR                                        0929 03630000
         MVC   IVOLKY(12),BASCSN1(@01)                             0929 03631000
*   RPLVKEY=ADDR(IKEY);             /* KEY ADDR              @ZDR2054*/ 03632000
         LA    @15,IKEY                                            0930 03633000
         ST    @15,RPLVKEY(,@06)                                   0930 03634000
*   RPLVBUF=ADDR(INDEXBUF);         /* CIR BUF ADDR          @ZDR2054*/ 03635000
         LA    @15,INDEXBUF                                        0931 03636000
         ST    @15,RPLVBUF(,@06)                                   0931 03637000
*   RPLVBLN=LENGTH(INDEXBUF);       /* CIR BUF LENGTH        @ZDR2054*/ 03638000
         MVC   RPLVBLN(4,@06),@CF00339                             0932 03639000
*   CALL DELTRECD;                  /* DELT CIR FOR CSN1     @ZDR2054*/ 03640000
         BAL   @14,DELTRECD                                        0933 03641000
*   IVOLKY=BASCSN2;                 /* CIR KEY FOR CSN2      @ZDR2054*/ 03642000
         L     @06,BASEVPTR                                        0934 03643000
         MVC   IVOLKY(12),BASCSN2(@06)                             0934 03644000
*   CALL DELTRECD;                  /* DELT CIR FOR CSN2     @ZDR2054*/ 03645000
*                                                                  0935 03646000
         BAL   @14,DELTRECD                                        0935 03647000
*   /*****************************************************************/ 03648000
*   /*                                                               */ 03649000
*   /* INITIALIZE AND RESET BVR FIELDS FROM THE CVR          @ZDR2054*/ 03650000
*   /*                                                               */ 03651000
*   /*****************************************************************/ 03652000
*                                                                  0936 03653000
*   BASREASS=OFF;                   /* CART NOT REASSIGN     @ZDR2054*/ 03654000
         L     @06,BASEVPTR                                        0936 03655000
         NI    BASREASS(@06),B'11011111'                           0936 03656000
*   BASCSN1=COPCSN1;                /* SET CSN 1             @ZDR2054*/ 03657000
         L     @15,COPYVPTR                                        0937 03658000
         MVC   BASCSN1(12,@06),COPCSN1(@15)                        0937 03659000
*   BASLIB1=COPLIB1;                /* MSF 1                 @ZDR2054*/ 03660000
         IC    @14,COPLIB1(,@15)                                   0938 03661000
         STC   @14,BASLIB1(,@06)                                   0938 03662000
*   BASCSN2=COPCSN2;                /* SET CSN 2             @ZDR2054*/ 03663000
         MVC   BASCSN2(12,@06),COPCSN2(@15)                        0939 03664000
*   BASLIB2=COPLIB2;                /* MSF 2                 @ZDR2054*/ 03665000
         IC    @14,COPLIB2(,@15)                                   0940 03666000
         STC   @14,BASLIB2(,@06)                                   0940 03667000
*   BASFRESP=COPFRESP;              /* # FREE CYLANDERS      @ZDR2054*/ 03668000
         LH    @14,COPFRESP(,@15)                                  0941 03669000
         STH   @14,BASFRESP(,@06)                                  0941 03670000
*   BASLEXT=COPLEXT;                /* # CYL IN LARGEST      @ZDR2054   03671000
*                                      FREE EXTENT           @ZDR2054*/ 03672000
         LH    @14,COPLEXT(,@15)                                   0942 03673000
         STH   @14,BASLEXT(,@06)                                   0942 03674000
*   BASFREXT=COPFREXT;              /* # FREE EXTENTS        @ZDR2054*/ 03675000
         L     @14,COPFREXT(,@15)                                  0943 03676000
         ST    @14,BASFREXT(,@06)                                  0943 03677000
*   BASOWNER=COPOWNER;              /* OWNER                 @ZDR2054*/ 03678000
         MVC   BASOWNER(10,@06),COPOWNER(@15)                      0944 03679000
*   BASDESCR=COPDESCR;              /* DESCRIPTION           @ZDR2054*/ 03680000
         MVC   BASDESCR(30,@06),COPDESCR(@15)                      0945 03681000
*   IF COPDLSPF=ON THEN             /* DOWN LEVEL SPACE?     @ZDR2054*/ 03682000
         TM    COPDLSPF(@15),B'01000000'                           0946 03683000
         BNO   @RF00946                                            0946 03684000
*     BASDLSF=ON;                   /* YES                   @ZDR2054*/ 03685000
         OI    BASDLSF(@06),B'10000000'                            0947 03686000
*   ELSE                                                           0948 03687000
*     BASDLSF=OFF;                  /* NO                    @ZDR2054*/ 03688000
         B     @RC00946                                            0948 03689000
@RF00946 L     @06,BASEVPTR                                        0948 03690000
         NI    BASDLSF(@06),B'01111111'                            0948 03691000
*   BASDLMTD=BLANK4;                /* DATE LAST MOUNT       @ZDR2054*/ 03692000
@RC00946 L     @06,BASEVPTR                                        0949 03693000
         MVI   BASDLMTD+1(@06),C' '                                0949 03694000
         MVC   BASDLMTD+2(2,@06),BASDLMTD+1(@06)                   0949 03695000
         MVI   BASDLMTD(@06),C' '                                  0949 03696000
*   BASDTREM=BLANK4;                /* EJECT DATE            @ZDR2054*/ 03697000
         MVI   BASDTREM+1(@06),C' '                                0950 03698000
         MVC   BASDTREM+2(2,@06),BASDTREM+1(@06)                   0950 03699000
         MVI   BASDTREM(@06),C' '                                  0950 03700000
*   BASDEST=BLANK30;                /* EJECT DESTINATION     @ZDR2054*/ 03701000
         MVI   BASDEST+1(@06),C' '                                 0951 03702000
         MVC   BASDEST+2(28,@06),BASDEST+1(@06)                    0951 03703000
         MVI   BASDEST(@06),C' '                                   0951 03704000
*   BASEXPDT=FIX4FS;                /* EXPIRATION DATE       @ZDR2054*/ 03705000
         MVC   BASEXPDT(4,@06),@CB00677                            0952 03706000
*   BASRECOV=BLANK6;                /* RECOVERY VOLID        @ZDR2054*/ 03707000
*                                                                  0953 03708000
         MVI   BASRECOV+1(@06),C' '                                0953 03709000
         MVC   BASRECOV+2(4,@06),BASRECOV+1(@06)                   0953 03710000
         MVI   BASRECOV(@06),C' '                                  0953 03711000
*   /*****************************************************************/ 03712000
*   /*                                                               */ 03713000
*   /* REESTABLISH THE RPLV                                  @ZDR2054*/ 03714000
*   /*                                                               */ 03715000
*   /*****************************************************************/ 03716000
*                                                                  0954 03717000
*   BVOLKY=BASSERNO;                /* RESET VOLID           @ZDR2054*/ 03718000
         MVC   BVOLKY(6),BASSERNO(@06)                             0954 03719000
*   RPLVKEY=ADDR(BKEY);             /* SET KEY ADDR          @ZDR2054*/ 03720000
         LA    @06,BKEY                                            0955 03721000
         L     @01,RPLVPTR                                         0955 03722000
         ST    @06,RPLVKEY(,@01)                                   0955 03723000
*   CALL READUPD1;                  /* READ BVR              @ZDR2054*/ 03724000
         BAL   @14,READUPD1                                        0956 03725000
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @ZDR2054*/ 03726000
*     THEN                          /* YES                   @ZDR2054*/ 03727000
         L     @06,RPLVPTR                                         0957 03728000
         LH    @15,RPLVRETC(,@06)                                  0957 03729000
         N     @15,@CF01129                                        0957 03730000
         LTR   @15,@15                                             0957 03731000
         BNZ   @RT00957                                            0957 03732000
*     RETURN;                       /*                       @ZDR2054*/ 03733000
*                                                                  0958 03734000
*   /*****************************************************************/ 03735000
*   /*                                                               */ 03736000
*   /* WRITE THE BVR                                         @ZDR2054*/ 03737000
*   /*                                                               */ 03738000
*   /*****************************************************************/ 03739000
*                                                                  0959 03740000
*   RPLVBUF=ADDR(BASEBUF);          /* BUFF ADDR             @ZDR2054*/ 03741000
         LA    @15,BASEBUF                                         0959 03742000
         ST    @15,RPLVBUF(,@06)                                   0959 03743000
*   CALL WRITRECD;                  /* WRITE BVR             @ZDR2054*/ 03744000
         BAL   @14,WRITRECD                                        0960 03745000
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @ZDR2054*/ 03746000
*     THEN                          /* YES                   @ZDR2054*/ 03747000
         L     @06,RPLVPTR                                         0961 03748000
         LH    @06,RPLVRETC(,@06)                                  0961 03749000
         N     @06,@CF01129                                        0961 03750000
         LTR   @06,@06                                             0961 03751000
         BNZ   @RT00961                                            0961 03752000
*     RETURN;                       /*                       @ZDR2054*/ 03753000
*                                                                  0962 03754000
*   /*****************************************************************/ 03755000
*   /*                                                               */ 03756000
*   /* UPDATE THE CIRS OF THE NEW BVR.                       @ZDR2054*/ 03757000
*   /* BCDVPTR IS SET IN ACTVOL2.                            @ZDR2054*/ 03758000
*   /*                                                               */ 03759000
*   /*****************************************************************/ 03760000
*                                                                  0963 03761000
*   CALL UPDCIR;                    /* SET NEW VOLID         @ZDR2054*/ 03762000
         BAL   @14,UPDCIR                                          0963 03763000
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @ZDR2054*/ 03764000
*     THEN                          /* YES                   @ZDR2054*/ 03765000
         L     @06,RPLVPTR                                         0964 03766000
         LH    @06,RPLVRETC(,@06)                                  0964 03767000
         N     @06,@CF01129                                        0964 03768000
         LTR   @06,@06                                             0964 03769000
         BNZ   @RT00964                                            0964 03770000
*     RETURN;                       /*                       @ZDR2054*/ 03771000
*                                                                  0965 03772000
*   /*****************************************************************/ 03773000
*   /*                                                               */ 03774000
*   /* UPDATE THE NEW BVR TO REFLECT THE DELETION OF         @ZDR2054*/ 03775000
*   /* THE CVR                                               @ZDR2054*/ 03776000
*   /*                                                               */ 03777000
*   /*****************************************************************/ 03778000
*                                                                  0966 03779000
*   ADDSUB=OFF;                     /* CVR DELTED            @ZDR2054*/ 03780000
         NI    ADDSUB,B'10111111'                                  0966 03781000
*   CALL ICBVUBVR(COPYVPTR,RPLVPTR,PASSBYTE);/*              @ZDR2054*/ 03782000
         L     @15,@CV00769                                        0967 03783000
         LA    @01,@AL00967                                        0967 03784000
         BALR  @14,@15                                             0967 03785000
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @ZDR2054*/ 03786000
*     THEN                          /* YES                   @ZDR2054*/ 03787000
         L     @06,RPLVPTR                                         0968 03788000
         LH    @15,RPLVRETC(,@06)                                  0968 03789000
         N     @15,@CF01129                                        0968 03790000
         LTR   @15,@15                                             0968 03791000
         BNZ   @RT00968                                            0968 03792000
*     RETURN;                       /*                       @ZDR2054*/ 03793000
*                                                                  0969 03794000
*   /*****************************************************************/ 03795000
*   /*                                                               */ 03796000
*   /* READ THE BVR FOR UPDATE SO PROCESSING CAN             @ZDR2054*/ 03797000
*   /* CONTINUE IN ACTVOL2. BVOLKY IS STILL OK.              @ZDR2054*/ 03798000
*   /*                                                               */ 03799000
*   /*****************************************************************/ 03800000
*                                                                  0970 03801000
*   RPLVKEY=ADDR(BKEY);             /* BVR KEY ADDR          @ZDR2054*/ 03802000
         LA    @15,BKEY                                            0970 03803000
         ST    @15,RPLVKEY(,@06)                                   0970 03804000
*   CALL READUPD1;                  /* READ BVR              @ZDR2054*/ 03805000
         BAL   @14,READUPD1                                        0971 03806000
*   BASEBUF=BASEBUF1;               /* CORRECT BVR BUF       @ZDR2054*/ 03807000
         MVC   BASEBUF(224),BASEBUF1                               0972 03808000
*   RETURN;                         /*                       @ZDR2054*/ 03809000
@EL00020 DS    0H                                                  0973 03810000
@EF00020 DS    0H                                                  0973 03811000
@ER00020 L     @14,@SA00020                                        0973 03812000
         BR    @14                                                 0973 03813000
*   END CVRTOBVR;                   /*                       @ZDR2054*/ 03814000
         B     @EL00020                                            0974 03815000
*                                                                  0975 03816000
*   /*****************************************************************/ 03817000
*   /*                                                               */ 03818000
*   /* PROCEDURE NAME - PRODEFVE                             #Y30LB25*/ 03819000
*   /*                                                       @Y30LB25*/ 03820000
*   /* FUNCTION - PROCESS IEZDEFVE.                          @Y30LB25*/ 03821000
*   /*                                                       @Y30LB25*/ 03822000
*   /* INPUT -                                               @Y30LB25*/ 03823000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 03824000
*   /* BASE OR COPY VOLUME RECORD                            @Y30LB25*/ 03825000
*   /* POINTER TO COPY OR BASE VOLUME RECORD IN              @Y30LB25*/ 03826000
*   /* BCDVPTR                                               @Y30LB25*/ 03827000
*   /* POINTER TO BASE VOLUME RECORD IN BASEVPTR             @Y30LB25*/ 03828000
*   /*                                                       @Y30LB25*/ 03829000
*   /* OUTPUT -                                              @Y30LB25*/ 03830000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 03831000
*   /* AN ERROR                                              @Y30LB25*/ 03832000
*   /*                                                               */ 03833000
*   /*****************************************************************/ 03834000
*                                                                  0975 03835000
*PRODEFVE:                          /*                       @Y30LB25*/ 03836000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 03837000
*                                                                  0975 03838000
PRODEFVE ST    @14,@SA00021                                        0975 03839000
*   /*****************************************************************/ 03840000
*   /*                                                               */ 03841000
*   /* CHECK FOR COPY OR BASE VOLUME RECORD                  @Y30LB25*/ 03842000
*   /*                                                               */ 03843000
*   /*****************************************************************/ 03844000
*                                                                  0976 03845000
*   IF BCDCOPY=ON                   /* CVR?                  @Y30LB25*/ 03846000
*     THEN                          /* YES                   @Y30LB25*/ 03847000
         L     @06,BCDVPTR                                         0976 03848000
         TM    BCDCOPY(@06),B'00010000'                            0976 03849000
         BNO   @RF00976                                            0976 03850000
*     DO;                           /*                       @Y30LB25*/ 03851000
*       COPYVPTR=BCDVPTR;           /* SET CVR PTR           @Y30LB25*/ 03852000
         ST    @06,COPYVPTR                                        0978 03853000
*       CALL PCVRE;                 /* PROCESS DEFVE         @Y30LB25*/ 03854000
         BAL   @14,PCVRE                                           0979 03855000
*       RETURN;                     /*                       @Y30LB25*/ 03856000
@EL00021 DS    0H                                                  0980 03857000
@EF00021 DS    0H                                                  0980 03858000
@ER00021 L     @14,@SA00021                                        0980 03859000
         BR    @14                                                 0980 03860000
*     END;                          /*                       @Y30LB25*/ 03861000
*                                                                  0981 03862000
*   /*****************************************************************/ 03863000
*   /*                                                               */ 03864000
*   /* CHECK TO SEE IF GROUP WAS SPECIFIED                   @Y30LB25*/ 03865000
*   /*                                                               */ 03866000
*   /*****************************************************************/ 03867000
*                                                                  0982 03868000
*   IF DEFPGRO=ON THEN              /* GOING GROUPED         @Y30LB25*/ 03869000
@RF00976 TM    DEFPGRO(DEFVEPTR),B'00100000'                       0982 03870000
         BNO   @RF00982                                            0982 03871000
*     DO;                           /*                       @Y30LB25*/ 03872000
*                                                                  0983 03873000
*       /*************************************************************/ 03874000
*       /*                                                           */ 03875000
*       /* SEE IF RECORD WAS IN GROUP BEFORE                 @Y30LB25*/ 03876000
*       /*                                                           */ 03877000
*       /*************************************************************/ 03878000
*                                                                  0984 03879000
*       IF BASGRPV=ON THEN          /* VOLUME GROUPED        @Y30LB25*/ 03880000
*                                                                  0984 03881000
         L     @06,BASEVPTR                                        0984 03882000
         TM    BASGRPV(@06),B'00100000'                            0984 03883000
         BNO   @RF00984                                            0984 03884000
*         /***********************************************************/ 03885000
*         /*                                                         */ 03886000
*         /* GO REMOVE RECORD FROM GROUP CHAIN               @Y30LB25*/ 03887000
*         /*                                                         */ 03888000
*         /***********************************************************/ 03889000
*                                                                  0985 03890000
*         DO;                       /*                       @Y30LB25*/ 03891000
*           CALL GROUPOUT;          /* GET REC OUT OF GROUP  @Y30LB25*/ 03892000
         BAL   @14,GROUPOUT                                        0986 03893000
*           IF RPLVRETC^=FIXZERO THEN/* CK RETURN CODE       @Y30LB25*/ 03894000
         L     @06,RPLVPTR                                         0987 03895000
         LH    @06,RPLVRETC(,@06)                                  0987 03896000
         N     @06,@CF01129                                        0987 03897000
         LTR   @06,@06                                             0987 03898000
         BNZ   @RT00987                                            0987 03899000
*             RETURN;               /*                       @Y30LB25*/ 03900000
*         END;                      /*                       @Y30LB25*/ 03901000
*       ELSE                        /*                       @Y30LB25*/ 03902000
*                                                                  0990 03903000
*         /***********************************************************/ 03904000
*         /*                                                         */ 03905000
*         /* GO TAKE RECORD OUT OF NON-GROUP                 @Y30LB25*/ 03906000
*         /*                                                         */ 03907000
*         /***********************************************************/ 03908000
*                                                                  0990 03909000
*         DO;                       /*                       @Y30LB25*/ 03910000
         B     @RC00984                                            0990 03911000
@RF00984 DS    0H                                                  0991 03912000
*           GRPFLG=OFF;             /* NON-GRP               @Y30LB25*/ 03913000
         NI    GRPFLG,B'11101111'                                  0991 03914000
*           CALL VUCHO;             /* GET REC OUT NON-GRP   @Y30LB25*/ 03915000
         BAL   @14,VUCHO                                           0992 03916000
*           IF RPLVRETC^=FIXZERO THEN/* CK RETURN            @Y30LB25*/ 03917000
         L     @06,RPLVPTR                                         0993 03918000
         LH    @06,RPLVRETC(,@06)                                  0993 03919000
         N     @06,@CF01129                                        0993 03920000
         LTR   @06,@06                                             0993 03921000
         BNZ   @RT00993                                            0993 03922000
*             RETURN;               /*                       @Y30LB25*/ 03923000
*         END;                      /*                       @Y30LB25*/ 03924000
*                                                                  0995 03925000
*       /*************************************************************/ 03926000
*       /*                                                           */ 03927000
*       /* GO PUT RECORD INTO GROUP                          @Y30LB25*/ 03928000
*       /*                                                           */ 03929000
*       /*************************************************************/ 03930000
*                                                                  0996 03931000
*       CALL GROUPIN;               /* PUT RECORD INTO GRP   @Y30LB25*/ 03932000
@RC00984 BAL   @14,GROUPIN                                         0996 03933000
*       IF RPLVRETC^=FIXZERO THEN   /* WAS IT SUCCESSFUL     @Y30LB25*/ 03934000
         L     @06,RPLVPTR                                         0997 03935000
         LH    @06,RPLVRETC(,@06)                                  0997 03936000
         N     @06,@CF01129                                        0997 03937000
         LTR   @06,@06                                             0997 03938000
         BNZ   @RT00997                                            0997 03939000
*         RETURN;                   /*                       @Y30LB25*/ 03940000
*                                                                  0998 03941000
*       /*************************************************************/ 03942000
*       /*                                                           */ 03943000
*       /* GO UPDATE THE COMMON FIELDS IN THE BASE REC       @Y30LB25*/ 03944000
*       /*                                                           */ 03945000
*       /*************************************************************/ 03946000
*                                                                  0999 03947000
*       CALL COMMON;                /* UPD COM FIELD IN BASE @Y30LB25*/ 03948000
         BAL   @14,COMMON                                          0999 03949000
*       RETURN;                     /*                       @Y30LB25*/ 03950000
         B     @EL00021                                            1000 03951000
*     END;                          /*                       @Y30LB25*/ 03952000
*                                                                  1001 03953000
*   /*****************************************************************/ 03954000
*   /*                                                               */ 03955000
*   /* CHECK FOR CHANGE TO NON-GROUPED                       @Y30LB25*/ 03956000
*   /*                                                               */ 03957000
*   /*****************************************************************/ 03958000
*                                                                  1002 03959000
*   IF DEFNGRP=ON&BASGRPV=ON THEN   /* GOING NON-GRP?        @Y30LB25*/ 03960000
@RF00982 TM    DEFNGRP(DEFVEPTR),B'10000000'                       1002 03961000
         BNO   @RF01002                                            1002 03962000
         L     @06,BASEVPTR                                        1002 03963000
         TM    BASGRPV(@06),B'00100000'                            1002 03964000
         BNO   @RF01002                                            1002 03965000
*     DO;                           /*                       @Y30LB25*/ 03966000
*                                                                  1003 03967000
*       /*************************************************************/ 03968000
*       /*                                                           */ 03969000
*       /* GO TAKE RECORD OUT OF GROUP THAT IT IS NOW IN     @Y30LB25*/ 03970000
*       /*                                                           */ 03971000
*       /*************************************************************/ 03972000
*                                                                  1004 03973000
*       CALL GROUPOUT;              /* GET IT OUT OF GRP     @Y30LB25*/ 03974000
         BAL   @14,GROUPOUT                                        1004 03975000
*       IF RPLVRETC^=FIXZERO THEN   /* CK RETURN             @Y30LB25*/ 03976000
         L     @06,RPLVPTR                                         1005 03977000
         LH    @06,RPLVRETC(,@06)                                  1005 03978000
         N     @06,@CF01129                                        1005 03979000
         LTR   @06,@06                                             1005 03980000
         BNZ   @RT01005                                            1005 03981000
*         RETURN;                   /*                       @Y30LB25*/ 03982000
*                                                                  1006 03983000
*       /*************************************************************/ 03984000
*       /*                                                           */ 03985000
*       /* GO PUT RECORD IN NON-GROUP CATAGORY               @Y30LB25*/ 03986000
*       /*                                                           */ 03987000
*       /*************************************************************/ 03988000
*                                                                  1007 03989000
*       CALL NGROUPIN;              /* PUT IN NON-GRPED      @Y30LB25*/ 03990000
         BAL   @14,NGROUPIN                                        1007 03991000
*       IF RPLVRETC^=FIXZERO THEN   /* CK RETURN CODE        @Y30LB25*/ 03992000
         L     @06,RPLVPTR                                         1008 03993000
         LH    @06,RPLVRETC(,@06)                                  1008 03994000
         N     @06,@CF01129                                        1008 03995000
         LTR   @06,@06                                             1008 03996000
         BNZ   @RT01008                                            1008 03997000
*         RETURN;                   /*                       @Y30LB25*/ 03998000
*                                                                  1009 03999000
*       /*************************************************************/ 04000000
*       /*                                                           */ 04001000
*       /* GO UPDATE COMMON FIELDS IN BASE REC               @Y30LB25*/ 04002000
*       /*                                                           */ 04003000
*       /*************************************************************/ 04004000
*                                                                  1010 04005000
*       CALL COMMON;                /* UPDATE COMMON FIELDS  @Y30LB25*/ 04006000
         BAL   @14,COMMON                                          1010 04007000
*       RETURN;                     /*                       @Y30LB25*/ 04008000
         B     @EL00021                                            1011 04009000
*     END;                          /*                       @Y30LB25*/ 04010000
*                                                                  1012 04011000
*   /*****************************************************************/ 04012000
*   /*                                                               */ 04013000
*   /* THIS A GROUPED VOLUME ?                               @Y30LB25*/ 04014000
*   /*                                                               */ 04015000
*   /*****************************************************************/ 04016000
*                                                                  1013 04017000
*   IF BASGRPV=ON THEN              /* THIS A GRPED VOL?     @Y30LB25*/ 04018000
@RF01002 L     @06,BASEVPTR                                        1013 04019000
         TM    BASGRPV(@06),B'00100000'                            1013 04020000
         BNO   @RF01013                                            1013 04021000
*     DO;                           /*                       @Y30LB25*/ 04022000
*                                                                  1014 04023000
*       /*************************************************************/ 04024000
*       /*                                                           */ 04025000
*       /* WANT TO CHANGE TO GENERAL USE ?                   @Y30LB25*/ 04026000
*       /*                                                           */ 04027000
*       /*************************************************************/ 04028000
*                                                                  1015 04029000
*       IF DEFGENUS=ON THEN         /* WANT GENERAL USE?     @Y30LB25*/ 04030000
         TM    DEFGENUS(DEFVEPTR),B'10000000'                      1015 04031000
         BNO   @RF01015                                            1015 04032000
*         DO;                       /*                       @Y30LB25*/ 04033000
*                                                                  1016 04034000
*           /*********************************************************/ 04035000
*           /*                                                       */ 04036000
*           /* WAS IT RESTRICTED BEFORE ?                    @Y30LB25*/ 04037000
*           /*                                                       */ 04038000
*           /*********************************************************/ 04039000
*                                                                  1017 04040000
*           IF BASRSTD=ON THEN      /* WAS RESTRICTED?       @Y30LB25*/ 04041000
*                                                                  1017 04042000
         TM    BASRSTD(@06),B'00001000'                            1017 04043000
         BNO   @RF01017                                            1017 04044000
*             /*******************************************************/ 04045000
*             /*                                                     */ 04046000
*             /* SINCE RESTRICTED BEFORE AND GOING GENERAL   @Y30LB25*/ 04047000
*             /* GO MAKE INTO A GENERAL VOLUME IN THE        @Y30LB25*/ 04048000
*             /* SAME GROUP                                  @Y30LB25*/ 04049000
*             /*                                                     */ 04050000
*             /*******************************************************/ 04051000
*                                                                  1018 04052000
*             DO;                   /*                       @Y30LB25*/ 04053000
*               CALL GENERAL;       /* GO FROM RESTRCTED-GEN @Y30LB25*/ 04054000
         BAL   @14,GENERAL                                         1019 04055000
*               IF RPLRCODE^=FIXZERO THEN/* RETURN CODE      @Y30LB25*/ 04056000
         L     @06,RPLVPTR                                         1020 04057000
         LH    @06,RPLRCODE(,@06)                                  1020 04058000
         N     @06,@CF01129                                        1020 04059000
         LTR   @06,@06                                             1020 04060000
         BNZ   @RT01020                                            1020 04061000
*                 RETURN;           /*                       @Y30LB25*/ 04062000
*                                                                  1021 04063000
*               /*****************************************************/ 04064000
*               /*                                                   */ 04065000
*               /* GO FILL IN ANY COMMON FIELDS IN BASE VOL  @Y30LB25*/ 04066000
*               /*                                                   */ 04067000
*               /*****************************************************/ 04068000
*                                                                  1022 04069000
*               CALL COMMON;        /* UPDATE COMMON FIELDS  @Y30LB25*/ 04070000
         BAL   @14,COMMON                                          1022 04071000
*               RETURN;             /*                       @Y30LB25*/ 04072000
         B     @EL00021                                            1023 04073000
*             END;                  /*                       @Y30LB25*/ 04074000
*         END;                      /*                       @Y30LB25*/ 04075000
*                                                                  1025 04076000
@RF01017 DS    0H                                                  1026 04077000
*       /*************************************************************/ 04078000
*       /*                                                           */ 04079000
*       /* IS A CHANGE TO RESTRICTED USE BEING CALLED FOR ?  @Y30LB25*/ 04080000
*       /*                                                           */ 04081000
*       /*************************************************************/ 04082000
*                                                                  1026 04083000
*       IF DEFRSTD=ON THEN          /* WANT RESTRICTED USE?  @Y30LB25*/ 04084000
@RF01015 TM    DEFRSTD(DEFVEPTR),B'01000000'                       1026 04085000
         BNO   @RF01026                                            1026 04086000
*         DO;                       /*                       @Y30LB25*/ 04087000
*                                                                  1027 04088000
*           /*********************************************************/ 04089000
*           /*                                                       */ 04090000
*           /* WAS IT A GENERAL USE VOL BEFORE ?             @Y30LB25*/ 04091000
*           /*                                                       */ 04092000
*           /*********************************************************/ 04093000
*                                                                  1028 04094000
*           IF BASGENUS=ON THEN     /* WAS GENERAL BEFORE?   @Y30LB25*/ 04095000
*                                                                  1028 04096000
         L     @06,BASEVPTR                                        1028 04097000
         TM    BASGENUS(@06),B'00010000'                           1028 04098000
         BNO   @RF01028                                            1028 04099000
*             /*******************************************************/ 04100000
*             /*                                                     */ 04101000
*             /* SINCE WAS GENERAL USE BEFORE AND IS GOING   @Y30LB25*/ 04102000
*             /* RESTRICTED, GO MAKE RESTRICTED IN THE SAME  @Y30LB25*/ 04103000
*             /* GROUP THAT IT WAS IN                        @Y30LB25*/ 04104000
*             /*                                                     */ 04105000
*             /*******************************************************/ 04106000
*                                                                  1029 04107000
*             DO;                   /*                       @Y30LB25*/ 04108000
*               CALL RESTRICT;      /* PROCESS AS RESTRCTED  @Y30LB25*/ 04109000
         BAL   @14,RESTRICT                                        1030 04110000
*               IF RPLVRETC^=FIXZERO THEN/* CK RETURN CODE   @Y30LB25*/ 04111000
         L     @06,RPLVPTR                                         1031 04112000
         LH    @06,RPLVRETC(,@06)                                  1031 04113000
         N     @06,@CF01129                                        1031 04114000
         LTR   @06,@06                                             1031 04115000
         BNZ   @RT01031                                            1031 04116000
*                 RETURN;           /*                       @Y30LB25*/ 04117000
*                                                                  1032 04118000
*               /*****************************************************/ 04119000
*               /*                                                   */ 04120000
*               /* FILL IN COMMON FIELDS IN BASE REC         @Y30LB25*/ 04121000
*               /*                                                   */ 04122000
*               /*****************************************************/ 04123000
*                                                                  1033 04124000
*               CALL COMMON;        /* FIELD IN COM FIELDS   @Y30LB25*/ 04125000
         BAL   @14,COMMON                                          1033 04126000
*               RETURN;             /*                       @Y30LB25*/ 04127000
         B     @EL00021                                            1034 04128000
*             END;                  /*                       @Y30LB25*/ 04129000
*         END;                      /*                       @Y30LB25*/ 04130000
@RF01028 DS    0H                                                  1037 04131000
*     END;                          /*                       @Y30LB25*/ 04132000
*                                                                  1037 04133000
@RF01026 DS    0H                                                  1038 04134000
*   /*****************************************************************/ 04135000
*   /*                                                               */ 04136000
*   /* IF VOLUME DID NOT CHANGE GROUPS OR CLASIFICATION,     @Y30LB25*/ 04137000
*   /* CALL COMMON TO CHANGE ANY OTHER FIELDS SPECIFIED      @Y30LB25*/ 04138000
*   /*                                                               */ 04139000
*   /*****************************************************************/ 04140000
*                                                                  1038 04141000
*   CALL COMMON;                    /* UPDATE REMAINING      @Y30LB25*/ 04142000
@RF01013 BAL   @14,COMMON                                          1038 04143000
*   RETURN;                         /*                       @Y30LB25*/ 04144000
         B     @EL00021                                            1039 04145000
*   END PRODEFVE;                   /*                       @Y30LB25*/ 04146000
         B     @EL00021                                            1040 04147000
*                                                                  1041 04148000
*   /*****************************************************************/ 04149000
*   /*                                                               */ 04150000
*   /* PROCEDURE NAME - GROUPOUT                             @Y30LB25*/ 04151000
*   /*                                                       @Y30LB25*/ 04152000
*   /* FUNCTION -                                            @Y30LB25*/ 04153000
*   /* THIS ROUTINE TAKES A BASE VOLUME RECORD OUT OF        @Y30LB25*/ 04154000
*   /* THE GROUP IT IS IN AND GETS IT READY TO GO            @Y30LB25*/ 04155000
*   /* EITHER INTO ANOTHER GROUP OR BECOME NON-GROUPED.      @Y30LB25*/ 04156000
*   /*                                                       @Y30LB25*/ 04157000
*   /* INPUT -                                               @Y30LB25*/ 04158000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 04159000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 04160000
*   /*                                                       @Y30LB25*/ 04161000
*   /* OUTPUT -                                              @Y30LB25*/ 04162000
*   /* GROUP VOLUME RECORD                                   @Y30LB25*/ 04163000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 04164000
*   /* AN ERROR                                              @Y30LB25*/ 04165000
*   /*                                                               */ 04166000
*   /*****************************************************************/ 04167000
*                                                                  1041 04168000
*GROUPOUT:                                                         1041 04169000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 04170000
*                                                                  1041 04171000
GROUPOUT ST    @14,@SA00022                                        1041 04172000
*   /*****************************************************************/ 04173000
*   /*                                                               */ 04174000
*   /* READ THE OLD GROUP RECORD SO CAN GET VOL OUT OF IT    @Y30LB25*/ 04175000
*   /*                                                               */ 04176000
*   /*****************************************************************/ 04177000
*                                                                  1042 04178000
*   GROUPKY=BASGROUP;               /* GROUP NAME            @Y30LB25*/ 04179000
         L     @06,BASEVPTR                                        1042 04180000
         MVC   GROUPKY(8),BASGROUP(@06)                            1042 04181000
*   RPLVKEY=ADDR(GKEY);             /* ADDR OF KEY           @Y30LB25*/ 04182000
         LA    @06,GKEY                                            1043 04183000
         L     @01,RPLVPTR                                         1043 04184000
         ST    @06,RPLVKEY(,@01)                                   1043 04185000
*   CALL READUPD1;                  /* READ GROUP REC        @Y30LB25*/ 04186000
*                                                                  1044 04187000
         BAL   @14,READUPD1                                        1044 04188000
*   /*****************************************************************/ 04189000
*   /*                                                               */ 04190000
*   /* RETURN CODE FROM I/O PROCESSOR                        @Y30LB25*/ 04191000
*   /*                                                               */ 04192000
*   /*****************************************************************/ 04193000
*                                                                  1045 04194000
*   IF RPLVRETC^=FIXZERO THEN       /* CK RETURN             @Y30LB25*/ 04195000
         L     @06,RPLVPTR                                         1045 04196000
         LH    @06,RPLVRETC(,@06)                                  1045 04197000
         N     @06,@CF01129                                        1045 04198000
         LTR   @06,@06                                             1045 04199000
         BNZ   @RT01045                                            1045 04200000
*     RETURN;                       /*                       @Y30LB25*/ 04201000
*                                                                  1046 04202000
*   /*****************************************************************/ 04203000
*   /*                                                               */ 04204000
*   /* GET ADDRESS OF RECORD JUST READ                       @Y30LB25*/ 04205000
*   /*                                                               */ 04206000
*   /*****************************************************************/ 04207000
*                                                                  1047 04208000
*   GRPBUF1=BASEBUF1;               /* USE CORRECT BUFF      @Y30LB25*/ 04209000
         MVC   GRPBUF1(224),BASEBUF1                               1047 04210000
*   GROUPPTR=ADDR(GRPBUF1);         /* ADDRESSING TO BUFFER  @Y30LB25*/ 04211000
*                                                                  1048 04212000
         LA    @06,GRPBUF1                                         1048 04213000
         ST    @06,GROUPPTR                                        1048 04214000
*   /*****************************************************************/ 04215000
*   /*                                                               */ 04216000
*   /* IF GENERAL USE BEFORE, DECREASE COUNT BY ONE          @Y30LB25*/ 04217000
*   /*                                                               */ 04218000
*   /*****************************************************************/ 04219000
*                                                                  1049 04220000
*   IF BASGENUS=ON&BASINAC=OFF      /* GEN USE & ACT?        @Y30LB25*/ 04221000
*     THEN                          /* YES                   @Y30LB25*/ 04222000
         L     @01,BASEVPTR                                        1049 04223000
         TM    BASGENUS(@01),B'00010000'                           1049 04224000
         BNO   @RF01049                                            1049 04225000
         TM    BASINAC(@01),B'00000100'                            1049 04226000
         BNZ   @RF01049                                            1049 04227000
*     GRONGEN=GRONGEN-FIXONE;       /* DECREASE COUNT        @Y30LB25*/ 04228000
*                                                                  1050 04229000
         LH    @15,GRONGEN(,@06)                                   1050 04230000
         BCTR  @15,0                                               1050 04231000
         STH   @15,GRONGEN(,@06)                                   1050 04232000
*   /*****************************************************************/ 04233000
*   /*                                                               */ 04234000
*   /* RESTRICTED, DECREASE RESTRICTED COUNT                 @Y30LB25*/ 04235000
*   /*                                                               */ 04236000
*   /*****************************************************************/ 04237000
*                                                                  1051 04238000
*   IF BASRSTD=ON&BASINAC=OFF       /* RESTD & ACT?          @Y30LB25*/ 04239000
*     THEN                          /* YES                   @Y30LB25*/ 04240000
@RF01049 L     @06,BASEVPTR                                        1051 04241000
         TM    BASRSTD(@06),B'00001000'                            1051 04242000
         BNO   @RF01051                                            1051 04243000
         TM    BASINAC(@06),B'00000100'                            1051 04244000
         BNZ   @RF01051                                            1051 04245000
*     GRONRSTD=GRONRSTD-FIXONE;     /* DECR COUNT            @Y30LB25*/ 04246000
*                                                                  1052 04247000
         L     @06,GROUPPTR                                        1052 04248000
         LH    @15,GRONRSTD(,@06)                                  1052 04249000
         BCTR  @15,0                                               1052 04250000
         STH   @15,GRONRSTD(,@06)                                  1052 04251000
*   /*****************************************************************/ 04252000
*   /*                                                               */ 04253000
*   /* CHECK FOR INACTIVE                                    @Y30LB25*/ 04254000
*   /*                                                               */ 04255000
*   /*****************************************************************/ 04256000
*                                                                  1053 04257000
*   IF BASINAC=ON                   /* INACTIVE              @Y30LB25*/ 04258000
*     THEN                          /* YES                   @Y30LB25*/ 04259000
@RF01051 L     @06,BASEVPTR                                        1053 04260000
         TM    BASINAC(@06),B'00000100'                            1053 04261000
         BNO   @RF01053                                            1053 04262000
*     GRONINAC=GRONINAC-FIXONE;     /* DECREM COUNT          @Y30LB25*/ 04263000
*                                                                  1054 04264000
         L     @06,GROUPPTR                                        1054 04265000
         LH    @15,GRONINAC(,@06)                                  1054 04266000
         BCTR  @15,0                                               1054 04267000
         STH   @15,GRONINAC(,@06)                                  1054 04268000
*   /*****************************************************************/ 04269000
*   /*                                                               */ 04270000
*   /* IF BASE VOL IS A GENERAL USE TYPE, GO REMOVE ITS      @Y30LB25*/ 04271000
*   /* SLOT IN THE EXTENSION RECORD                          @Y30LB25*/ 04272000
*   /*                                                               */ 04273000
*   /*****************************************************************/ 04274000
*                                                                  1055 04275000
*   IF BASGENUS=ON&BASINAC=OFF THEN /* GEN USE & ACT?        @Y30LB25*/ 04276000
@RF01053 L     @06,BASEVPTR                                        1055 04277000
         TM    BASGENUS(@06),B'00010000'                           1055 04278000
         BNO   @RF01055                                            1055 04279000
         TM    BASINAC(@06),B'00000100'                            1055 04280000
         BNZ   @RF01055                                            1055 04281000
*     DO;                           /*                       @Y30LB25*/ 04282000
*                                                                  1056 04283000
*       /*************************************************************/ 04284000
*       /*                                                           */ 04285000
*       /* REMOVE THE SLOT                                   @Y30LB25*/ 04286000
*       /*                                                           */ 04287000
*       /*************************************************************/ 04288000
*                                                                  1057 04289000
*       ADDSUBSL=OFF;               /* DELETE SLOT           @Y30LB25*/ 04290000
         NI    ADDSUBSL,B'11111101'                                1057 04291000
*       EXPSLOT=OFF;                /* NO EXPIR DATE         @Y30LB25*/ 04292000
         NI    EXPSLOT,B'01111111'                                 1058 04293000
*       CALL ICBVUEXT(GROUPPTR,BASEVPTR,RPLVPTR,PASSBYTE);/* @Y30LB25*/ 04294000
         L     @15,@CV00767                                        1059 04295000
         LA    @01,@AL01059                                        1059 04296000
         BALR  @14,@15                                             1059 04297000
*       IF RPLVRETC^=FIXZERO THEN   /* ERROR?                @Y30LB25*/ 04298000
         L     @06,RPLVPTR                                         1060 04299000
         LH    @06,RPLVRETC(,@06)                                  1060 04300000
         N     @06,@CF01129                                        1060 04301000
         LTR   @06,@06                                             1060 04302000
         BNZ   @RT01060                                            1060 04303000
*         RETURN;                   /*                       @Y30LB25*/ 04304000
*                                                                  1061 04305000
*       /*************************************************************/ 04306000
*       /*                                                           */ 04307000
*       /* UPDATE THE GVR                                    @Y30LB25*/ 04308000
*       /*                                                           */ 04309000
*       /*************************************************************/ 04310000
*                                                                  1062 04311000
*       ADDSUBGR=OFF;               /* SUBTRACT              @Y30LB25*/ 04312000
         NI    ADDSUBGR,B'11110111'                                1062 04313000
*       CALL VUPGH;                 /* UPDATE GVR            @Y30LB25*/ 04314000
         BAL   @14,VUPGH                                           1063 04315000
*     END;                          /*                       @Y30LB25*/ 04316000
*                                                                  1064 04317000
*   /*****************************************************************/ 04318000
*   /*                                                               */ 04319000
*   /* GO GET BASE RECORD OUT OF GROUP CHAIN                 @Y30LB25*/ 04320000
*   /*                                                               */ 04321000
*   /*****************************************************************/ 04322000
*                                                                  1065 04323000
*   GRPFLG=ON;                      /* INDICATE GROUPED      @Y30LB25*/ 04324000
@RF01055 OI    GRPFLG,B'00010000'                                  1065 04325000
*   CALL VUCHO;                     /*                       @Y30LB25*/ 04326000
         BAL   @14,VUCHO                                           1066 04327000
*   IF RPLVRETC^=FIXZERO THEN       /*                       @Y30LB25*/ 04328000
         L     @06,RPLVPTR                                         1067 04329000
         LH    @06,RPLVRETC(,@06)                                  1067 04330000
         N     @06,@CF01129                                        1067 04331000
         LTR   @06,@06                                             1067 04332000
         BNZ   @RT01067                                            1067 04333000
*     RETURN;                       /*                       @Y30LB25*/ 04334000
*                                                                  1068 04335000
*   /*****************************************************************/ 04336000
*   /*                                                               */ 04337000
*   /* SET REQUIRED DEFAULTS FOR GROUPIN                     @ZA00687*/ 04338000
*   /* IF VOLUME IS NEITHER RESTRICTED OR GENERAL USE        @ZA00687*/ 04339000
*   /* DEFAULT IS GENERAL USE                                @ZA00687*/ 04340000
*   /* OTHERWISE SET REQUIRED DEFAULT TO VOLUME ATTRIBUTE    @ZA00687*/ 04341000
*   /*                                                               */ 04342000
*   /*****************************************************************/ 04343000
*                                                                  1069 04344000
*   IF DEFRSTD=OFF&DEFGENUS=OFF THEN                               1069 04345000
         TM    DEFRSTD(DEFVEPTR),B'11000000'                       1069 04346000
         BNZ   @RF01069                                            1069 04347000
*     DO;                           /*                       @ZA00687*/ 04348000
*       IF BASRSTD=OFF&BASGENUS=OFF THEN                           1071 04349000
         L     @06,BASEVPTR                                        1071 04350000
         TM    BASRSTD(@06),B'00011000'                            1071 04351000
         BNZ   @RF01071                                            1071 04352000
*         DEFGENUS=ON;              /*                       @ZA00687*/ 04353000
         OI    DEFGENUS(DEFVEPTR),B'10000000'                      1072 04354000
*       IF BASRSTD=OFF&BASGENUS=ON THEN                            1073 04355000
@RF01071 L     @06,BASEVPTR                                        1073 04356000
         TM    BASGENUS(@06),B'00010000'                           1073 04357000
         BNO   @RF01073                                            1073 04358000
         TM    BASRSTD(@06),B'00001000'                            1073 04359000
         BNZ   @RF01073                                            1073 04360000
*         DEFGENUS=ON;              /*                       @XA07821*/ 04361000
         OI    DEFGENUS(DEFVEPTR),B'10000000'                      1074 04362000
*       IF BASRSTD=ON&BASGENUS=OFF THEN                            1075 04363000
@RF01073 L     @06,BASEVPTR                                        1075 04364000
         TM    BASRSTD(@06),B'00001000'                            1075 04365000
         BNO   @RF01075                                            1075 04366000
         TM    BASGENUS(@06),B'00010000'                           1075 04367000
         BNZ   @RF01075                                            1075 04368000
*         DEFRSTD=ON;               /*                       @ZA00687*/ 04369000
         OI    DEFRSTD(DEFVEPTR),B'01000000'                       1076 04370000
*     END;                          /*                       @ZA00687*/ 04371000
*                                                                  1077 04372000
@RF01075 DS    0H                                                  1078 04373000
*   /*****************************************************************/ 04374000
*   /*                                                               */ 04375000
*   /* CLEAR OUT FIELDS IN THE BASE VOL RECORD THAT          #Y30LB25*/ 04376000
*   /* HAVE BAD INFORMATION IN THEM FROM PREV GROUP          @Y30LB25*/ 04377000
*   /*                                                               */ 04378000
*   /*****************************************************************/ 04379000
*                                                                  1078 04380000
*   BASGROUP=BLANK8;                /* NULL GRP NAME         @Y30LB25*/ 04381000
@RF01069 L     @06,BASEVPTR                                        1078 04382000
         MVI   BASGROUP+1(@06),C' '                                1078 04383000
         MVC   BASGROUP+2(6,@06),BASGROUP+1(@06)                   1078 04384000
         MVI   BASGROUP(@06),C' '                                  1078 04385000
*   BASGRPV=OFF;                    /* NON-GRPED             @Y30LB25*/ 04386000
*   BASGENUS=OFF;                   /* NOT GENERAL           @Y30LB25*/ 04387000
*   BASRSTD=OFF;                    /* NOT RESTRICTED        @Y30LB25*/ 04388000
         NI    BASGRPV(@06),B'11000111'                            1081 04389000
*   BASEXPDT=FIX4FS;                /* CLEAR EXPIRATION      @Y30LB25*/ 04390000
*                                                                  1082 04391000
         MVC   BASEXPDT(4,@06),@CB00677                            1082 04392000
*   /*****************************************************************/ 04393000
*   /*                                                               */ 04394000
*   /* READ GROUP RECORD FOR UPDATE SO IT CAN BE WRITTEN     @Y30LB25*/ 04395000
*   /*                                                               */ 04396000
*   /*****************************************************************/ 04397000
*                                                                  1083 04398000
*   RPLVKEY=ADDR(GKEY);             /* ADDR OF KEY           @Y30LB25*/ 04399000
         LA    @06,GKEY                                            1083 04400000
         L     @01,RPLVPTR                                         1083 04401000
         ST    @06,RPLVKEY(,@01)                                   1083 04402000
*   CALL READUPD1;                  /* RD GRP REC FOR UPDATE @Y30LB25*/ 04403000
         BAL   @14,READUPD1                                        1084 04404000
*   IF RPLVRETC^=FIXZERO THEN       /* CHECK RETURN CODE     @Y30LB25*/ 04405000
         L     @06,RPLVPTR                                         1085 04406000
         LH    @15,RPLVRETC(,@06)                                  1085 04407000
         N     @15,@CF01129                                        1085 04408000
         LTR   @15,@15                                             1085 04409000
         BNZ   @RT01085                                            1085 04410000
*     RETURN;                       /*                       @Y30LB25*/ 04411000
*                                                                  1086 04412000
*   /*****************************************************************/ 04413000
*   /*                                                               */ 04414000
*   /* WRITE GROUP RECORD                                    @Y30LB25*/ 04415000
*   /*                                                               */ 04416000
*   /*****************************************************************/ 04417000
*                                                                  1087 04418000
*   RPLVBUF=ADDR(GRPBUF1);          /* ADDR RECORD TO PUT    @Y30LB25*/ 04419000
         LA    @15,GRPBUF1                                         1087 04420000
         ST    @15,RPLVBUF(,@06)                                   1087 04421000
*   CALL WRITRECD;                  /* WRITE GVR             @Y30LB25*/ 04422000
         BAL   @14,WRITRECD                                        1088 04423000
*   RETURN;                         /*                       @Y30LB25*/ 04424000
@EL00022 DS    0H                                                  1089 04425000
@EF00022 DS    0H                                                  1089 04426000
@ER00022 L     @14,@SA00022                                        1089 04427000
         BR    @14                                                 1089 04428000
*   END GROUPOUT;                   /*                       @Y30LB25*/ 04429000
         B     @EL00022                                            1090 04430000
*                                                                  1091 04431000
*   /*****************************************************************/ 04432000
*   /*                                                               */ 04433000
*   /* PROCEDURE NAME - GROUPIN                              @Y30LB25*/ 04434000
*   /*                                                       @Y30LB25*/ 04435000
*   /* FUNCTION -                                            @Y30LB25*/ 04436000
*   /* THIS ROUTINE PUTS A BASE VOL REC INTO A GROUP.        @Y30LB25*/ 04437000
*   /*                                                       @Y30LB25*/ 04438000
*   /* INPUT -                                               @Y30LB25*/ 04439000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 04440000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 04441000
*   /*                                                       @Y30LB25*/ 04442000
*   /* OUTPUT -                                              @Y30LB25*/ 04443000
*   /* GROUP VOLUME RECORD                                   @Y30LB25*/ 04444000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 04445000
*   /* AN ERROR                                              @Y30LB25*/ 04446000
*   /*                                                               */ 04447000
*   /*****************************************************************/ 04448000
*                                                                  1091 04449000
*GROUPIN:                                                          1091 04450000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 04451000
*                                                                  1091 04452000
GROUPIN  ST    @14,@SA00023                                        1091 04453000
*   /*****************************************************************/ 04454000
*   /*                                                               */ 04455000
*   /* READ THE NEW GROUP RECORD                             @Y30LB25*/ 04456000
*   /*                                                               */ 04457000
*   /*****************************************************************/ 04458000
*                                                                  1092 04459000
*   GROUPKY=DEFGROUP;               /* GROUP NAME TO KEY     @Y30LB25*/ 04460000
         MVC   GROUPKY(8),DEFGROUP(DEFVEPTR)                       1092 04461000
*   RPLVKEY=ADDR(GKEY);             /* ADDR IF KEY           @Y30LB25*/ 04462000
         LA    @06,GKEY                                            1093 04463000
         L     @01,RPLVPTR                                         1093 04464000
         ST    @06,RPLVKEY(,@01)                                   1093 04465000
*   CALL READUPD1;                  /* FREE                  @Y30LB25*/ 04466000
         BAL   @14,READUPD1                                        1094 04467000
*   IF RPLVRETC^=FIXZERO THEN       /* CK RETURN CODE        @Y30LB25*/ 04468000
         L     @06,RPLVPTR                                         1095 04469000
         LH    @06,RPLVRETC(,@06)                                  1095 04470000
         N     @06,@CF01129                                        1095 04471000
         LTR   @06,@06                                             1095 04472000
         BNZ   @RT01095                                            1095 04473000
*     RETURN;                       /*                       @Y30LB25*/ 04474000
*   GRPBUF1=BASEBUF1;               /* USE CORRECT BUFF      @Y30LB25*/ 04475000
         MVC   GRPBUF1(224),BASEBUF1                               1097 04476000
*   GROUPPTR=ADDR(GRPBUF1);         /* ADDR TO RECORD        @Y30LB25*/ 04477000
*                                                                  1098 04478000
         LA    @06,GRPBUF1                                         1098 04479000
         ST    @06,GROUPPTR                                        1098 04480000
*   /*****************************************************************/ 04481000
*   /*                                                               */ 04482000
*   /* IF GENERAL USE THEN ADD ONE TO GENERAL USE            @Y30LB25*/ 04483000
*   /* IN GROUP RECORD AND INDICATE GENERAL IN               @Y30LB25*/ 04484000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 04485000
*   /*                                                               */ 04486000
*   /*****************************************************************/ 04487000
*                                                                  1099 04488000
*   IF DEFGENUS=ON&BASINAC=OFF      /* GEN-USE & ACT?        @Y30LB25*/ 04489000
*     THEN                          /* YES                   @Y30LB25*/ 04490000
         TM    DEFGENUS(DEFVEPTR),B'10000000'                      1099 04491000
         BNO   @RF01099                                            1099 04492000
         L     @15,BASEVPTR                                        1099 04493000
         TM    BASINAC(@15),B'00000100'                            1099 04494000
         BNZ   @RF01099                                            1099 04495000
*     DO;                           /*                       @Y30LB25*/ 04496000
*       GRONGEN=GRONGEN+FIXONE;     /* ADD ON TO GENERAL     @Y30LB25*/ 04497000
         LA    @14,1                                               1101 04498000
         AH    @14,GRONGEN(,@06)                                   1101 04499000
         STH   @14,GRONGEN(,@06)                                   1101 04500000
*       BASGENUS=ON;                /* INDICATE GENERAL      @Y30LB25*/ 04501000
         OI    BASGENUS(@15),B'00010000'                           1102 04502000
*     END;                          /*                       @Y30LB25*/ 04503000
*                                                                  1103 04504000
*   /*****************************************************************/ 04505000
*   /*                                                               */ 04506000
*   /* IF RESTRICTED USE, ADD ONE TO COUNT IN GROUP          @Y30LB25*/ 04507000
*   /* RECORD AND INDICATE RESTRICTED IN BASE RECORD         @Y30LB25*/ 04508000
*   /*                                                               */ 04509000
*   /*****************************************************************/ 04510000
*                                                                  1104 04511000
*   IF DEFRSTD=ON&BASINAC=OFF       /* RESTD & ACT?          @Y30LB25*/ 04512000
*     THEN                          /* YES                   @Y30LB25*/ 04513000
@RF01099 TM    DEFRSTD(DEFVEPTR),B'01000000'                       1104 04514000
         BNO   @RF01104                                            1104 04515000
         L     @06,BASEVPTR                                        1104 04516000
         TM    BASINAC(@06),B'00000100'                            1104 04517000
         BNZ   @RF01104                                            1104 04518000
*     DO;                           /*                       @Y30LB25*/ 04519000
*       GRONRSTD=GRONRSTD+FIXONE;   /* ADD ONE RESTRICTED    @Y30LB25*/ 04520000
         L     @15,GROUPPTR                                        1106 04521000
         LA    @14,1                                               1106 04522000
         AH    @14,GRONRSTD(,@15)                                  1106 04523000
         STH   @14,GRONRSTD(,@15)                                  1106 04524000
*       BASRSTD=ON;                 /* INDICATE RESTRICTED   @Y30LB25*/ 04525000
         OI    BASRSTD(@06),B'00001000'                            1107 04526000
*     END;                          /*                       @Y30LB25*/ 04527000
*                                                                  1108 04528000
*   /*****************************************************************/ 04529000
*   /*                                                               */ 04530000
*   /* CHECK FOR INACTIVE VOLUME AND SET VOLUME TYPE         @Y30LB25*/ 04531000
*   /*                                                               */ 04532000
*   /*****************************************************************/ 04533000
*                                                                  1109 04534000
*   IF BASINAC=ON                   /* INACTIVE?             @Y30LB25*/ 04535000
*     THEN                          /* YES                   @Y30LB25*/ 04536000
@RF01104 L     @06,BASEVPTR                                        1109 04537000
         TM    BASINAC(@06),B'00000100'                            1109 04538000
         BNO   @RF01109                                            1109 04539000
*     DO;                           /*                       @Y30LB25*/ 04540000
*       GRONINAC=GRONINAC+FIXONE;   /* INCR # INACT VOLS     @Y30LB25*/ 04541000
*                                                                  1111 04542000
         L     @15,GROUPPTR                                        1111 04543000
         LA    @14,1                                               1111 04544000
         AH    @14,GRONINAC(,@15)                                  1111 04545000
         STH   @14,GRONINAC(,@15)                                  1111 04546000
*       /*************************************************************/ 04547000
*       /*                                                           */ 04548000
*       /* CHECK FOR GENERAL-USE                             @Y30LB25*/ 04549000
*       /*                                                           */ 04550000
*       /*************************************************************/ 04551000
*                                                                  1112 04552000
*       IF DEFGENUS=ON              /* GENERAL-USE?          @Y30LB25*/ 04553000
*         THEN                      /* YES                   @Y30LB25*/ 04554000
         TM    DEFGENUS(DEFVEPTR),B'10000000'                      1112 04555000
         BNO   @RF01112                                            1112 04556000
*         DO;                       /*                       @Y30LB25*/ 04557000
*           BASGENUS=ON;            /* SET GEN-USE ON        @Y30LB25*/ 04558000
*           BASRSTD=OFF;            /* SET RESTRICT OFF      @Y30LB25*/ 04559000
         OI    BASGENUS(@06),B'00010000'                           1115 04560000
         NI    BASRSTD(@06),B'11110111'                            1115 04561000
*         END;                      /*                       @Y30LB25*/ 04562000
*                                                                  1116 04563000
*       /*************************************************************/ 04564000
*       /*                                                           */ 04565000
*       /* CHECK FOR RESTRICTED                              @Y30LB25*/ 04566000
*       /*                                                           */ 04567000
*       /*************************************************************/ 04568000
*                                                                  1117 04569000
*       IF DEFRSTD=ON               /* RESTRICTED?           @Y30LB25*/ 04570000
*         THEN                      /* YES                   @Y30LB25*/ 04571000
@RF01112 TM    DEFRSTD(DEFVEPTR),B'01000000'                       1117 04572000
         BNO   @RF01117                                            1117 04573000
*         DO;                       /*                       @Y30LB25*/ 04574000
*           BASGENUS=OFF;           /* SET GEN-USE OFF       @Y30LB25*/ 04575000
*           BASRSTD=ON;             /* SET RESTRICT ON       @Y30LB25*/ 04576000
         L     @06,BASEVPTR                                        1120 04577000
         OI    BASRSTD(@06),B'00001000'                            1120 04578000
         NI    BASGENUS(@06),B'11101111'                           1120 04579000
*         END;                      /*                       @Y30LB25*/ 04580000
*     END;                          /*                       @Y30LB25*/ 04581000
*                                                                  1122 04582000
@RF01117 DS    0H                                                  1123 04583000
*   /*****************************************************************/ 04584000
*   /*                                                               */ 04585000
*   /* CHECK IF VOLUME IS GOING TO BE GENERAL USE            @Y30LB25*/ 04586000
*   /*                                                               */ 04587000
*   /*****************************************************************/ 04588000
*                                                                  1123 04589000
*   IF DEFGENUS=ON&BASINAC=OFF THEN /* GEN-USE & ACT?        @Y30LB25*/ 04590000
@RF01109 TM    DEFGENUS(DEFVEPTR),B'10000000'                      1123 04591000
         BNO   @RF01123                                            1123 04592000
         L     @06,BASEVPTR                                        1123 04593000
         TM    BASINAC(@06),B'00000100'                            1123 04594000
         BNZ   @RF01123                                            1123 04595000
*     DO;                           /*                       @Y30LB25*/ 04596000
*                                                                  1124 04597000
*       /*************************************************************/ 04598000
*       /*                                                           */ 04599000
*       /* SET FLAG INDICATING ADDING TO GROUP AND GO        @ZM31004*/ 04600000
*       /* PUT NEW SPACE VALUES IN GROUP RECORD              @ZM31004*/ 04601000
*       /*                                                           */ 04602000
*       /*************************************************************/ 04603000
*                                                                  1125 04604000
*       ADDSUBGR=ON;                /* INDIC ADDING TO GRP   @ZM31004*/ 04605000
         OI    ADDSUBGR,B'00001000'                                1125 04606000
*       CALL VUPGH;                 /*                       @ZM31004*/ 04607000
*                                                                  1126 04608000
         BAL   @14,VUPGH                                           1126 04609000
*       /*************************************************************/ 04610000
*       /*                                                           */ 04611000
*       /* CHECK RETURN FROM PROCESS GROUP HEADER            @ZM31004*/ 04612000
*       /*                                                           */ 04613000
*       /*************************************************************/ 04614000
*                                                                  1127 04615000
*       IF RPLVRETC^=FIXZERO THEN   /* CK RETURN             @ZM31004*/ 04616000
         L     @06,RPLVPTR                                         1127 04617000
         LH    @06,RPLVRETC(,@06)                                  1127 04618000
         N     @06,@CF01129                                        1127 04619000
         LTR   @06,@06                                             1127 04620000
         BNZ   @RT01127                                            1127 04621000
*         RETURN;                   /*                       @ZM31004*/ 04622000
*                                                                  1128 04623000
*       /*************************************************************/ 04624000
*       /*                                                           */ 04625000
*       /* GO PUT A SLOT IN EXTENSION RECORD FOR THIS        @Y30LB25*/ 04626000
*       /* GROUPED GENERAL USE BASE VOLUME                   @Y30LB25*/ 04627000
*       /*                                                           */ 04628000
*       /*************************************************************/ 04629000
*                                                                  1129 04630000
*       ADDSUBSL=ON;                /* INDICATE ADDING SLOT  @Y30LB25*/ 04631000
         OI    ADDSUBSL,B'00000010'                                1129 04632000
*       EXPSLOT=OFF;                /* NO EXPIR DATE         @Y30LB25*/ 04633000
         NI    EXPSLOT,B'01111111'                                 1130 04634000
*       CALL ICBVUEXT(GROUPPTR,BASEVPTR,RPLVPTR,PASSBYTE);/* @ZM31004   04635000
*                                      ADD SLOT              @ZM31004*/ 04636000
         L     @15,@CV00767                                        1131 04637000
         LA    @01,@AL01131                                        1131 04638000
         BALR  @14,@15                                             1131 04639000
*       IF RPLVRETC^=FIXZERO THEN   /*                       @Y30LB25*/ 04640000
         L     @06,RPLVPTR                                         1132 04641000
         LH    @06,RPLVRETC(,@06)                                  1132 04642000
         N     @06,@CF01129                                        1132 04643000
         LTR   @06,@06                                             1132 04644000
         BNZ   @RT01132                                            1132 04645000
*         RETURN;                   /*                       @Y30LB25*/ 04646000
*     END;                          /*                       @Y30LB25*/ 04647000
*                                                                  1134 04648000
*   /*****************************************************************/ 04649000
*   /*                                                               */ 04650000
*   /* INDICATE GROUPED AND PUT GROUP NAME IN VOLUME         @Y30LB25*/ 04651000
*   /*                                                               */ 04652000
*   /*****************************************************************/ 04653000
*                                                                  1135 04654000
*   BASGRPV=ON;                     /* INDICATE GROUPED      @Y30LB25*/ 04655000
@RF01123 L     @06,BASEVPTR                                        1135 04656000
         OI    BASGRPV(@06),B'00100000'                            1135 04657000
*   BASGROUP=DEFGROUP;              /* GROUP NAME IN BASE    @Y30LB25*/ 04658000
*                                                                  1136 04659000
         MVC   BASGROUP(8,@06),DEFGROUP(DEFVEPTR)                  1136 04660000
*   /*****************************************************************/ 04661000
*   /*                                                               */ 04662000
*   /* CALL CHAIN IN ROUTINE TO CHAIN BASE RECORD INTO GROUP @Y30LB25*/ 04663000
*   /*                                                               */ 04664000
*   /*****************************************************************/ 04665000
*                                                                  1137 04666000
*   GRPFLG=ON;                      /* INDICATE GROUPED      @Y30LB25*/ 04667000
         OI    GRPFLG,B'00010000'                                  1137 04668000
*   CALL VUCHI;                     /*                       @Y30LB25*/ 04669000
         BAL   @14,VUCHI                                           1138 04670000
*   IF RPLVRETC^=FIXZERO THEN       /* ERROR?                @Y30LB25*/ 04671000
         L     @06,RPLVPTR                                         1139 04672000
         LH    @15,RPLVRETC(,@06)                                  1139 04673000
         N     @15,@CF01129                                        1139 04674000
         LTR   @15,@15                                             1139 04675000
         BNZ   @RT01139                                            1139 04676000
*     RETURN;                       /*                       @Y30LB25*/ 04677000
*                                                                  1140 04678000
*   /*****************************************************************/ 04679000
*   /*                                                               */ 04680000
*   /* READ GROUP RECORD FOR UPDATE SO IT CAN BE WRITTEN     @Y30LB25*/ 04681000
*   /*                                                               */ 04682000
*   /*****************************************************************/ 04683000
*                                                                  1141 04684000
*   RPLVKEY=ADDR(GKEY);             /* ADDR KEY              @Y30LB25*/ 04685000
         LA    @15,GKEY                                            1141 04686000
         ST    @15,RPLVKEY(,@06)                                   1141 04687000
*   CALL READUPD1;                  /* READ GROUP UPDATE     @Y30LB25*/ 04688000
*                                                                  1142 04689000
         BAL   @14,READUPD1                                        1142 04690000
*   /*****************************************************************/ 04691000
*   /*                                                               */ 04692000
*   /* CHECK RETURN FROM DUMMY READ                          @Y30LB25*/ 04693000
*   /*                                                               */ 04694000
*   /*****************************************************************/ 04695000
*                                                                  1143 04696000
*   IF RPLVRETC^=FIXZERO THEN       /* CK RETURN CODE        @Y30LB25*/ 04697000
         L     @06,RPLVPTR                                         1143 04698000
         LH    @15,RPLVRETC(,@06)                                  1143 04699000
         N     @15,@CF01129                                        1143 04700000
         LTR   @15,@15                                             1143 04701000
         BNZ   @RT01143                                            1143 04702000
*     RETURN;                       /*                       @Y30LB25*/ 04703000
*                                                                  1144 04704000
*   /*****************************************************************/ 04705000
*   /*                                                               */ 04706000
*   /* WRITE GROUP RECORD THAT IS ALL FIXED UP NOW           @Y30LB25*/ 04707000
*   /*                                                               */ 04708000
*   /*****************************************************************/ 04709000
*                                                                  1145 04710000
*   RPLVBUF=ADDR(GRPBUF1);          /* ADDR READ GROUP REC   @Y30LB25*/ 04711000
         LA    @15,GRPBUF1                                         1145 04712000
         ST    @15,RPLVBUF(,@06)                                   1145 04713000
*   CALL WRITRECD;                  /* WRITE GVR             @Y30LB25*/ 04714000
         BAL   @14,WRITRECD                                        1146 04715000
*   RETURN;                         /*                       @Y30LB25*/ 04716000
@EL00023 DS    0H                                                  1147 04717000
@EF00023 DS    0H                                                  1147 04718000
@ER00023 L     @14,@SA00023                                        1147 04719000
         BR    @14                                                 1147 04720000
*   END GROUPIN;                    /*                       @Y30LB25*/ 04721000
         B     @EL00023                                            1148 04722000
*                                                                  1149 04723000
*   /*****************************************************************/ 04724000
*   /*                                                               */ 04725000
*   /* PROCEDURE NAME - NGROUPIN                             @Y30LB25*/ 04726000
*   /*                                                       @Y30LB25*/ 04727000
*   /* FUNCTION -                                            @Y30LB25*/ 04728000
*   /* THIS ROUTINE PUTS A BASE VOLUME RECORD INTO           @Y30LB25*/ 04729000
*   /* THE NON-GROUPED CHAIN.                                @Y30LB25*/ 04730000
*   /*                                                       @Y30LB25*/ 04731000
*   /* INPUT -                                               @Y30LB25*/ 04732000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 04733000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 04734000
*   /*                                                       @Y30LB25*/ 04735000
*   /* OUTPUT -                                              @Y30LB25*/ 04736000
*   /* NON-GROUP VOLUME RECORD                               @Y30LB25*/ 04737000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 04738000
*   /* AN ERROR                                              @Y30LB25*/ 04739000
*   /*                                                               */ 04740000
*   /*****************************************************************/ 04741000
*                                                                  1149 04742000
*NGROUPIN:                                                         1149 04743000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 04744000
NGROUPIN ST    @14,@SA00024                                        1149 04745000
*   GRPFLG=OFF;                     /* INDICATE NON-GRPED    @Y30LB25*/ 04746000
*                                                                  1150 04747000
         NI    GRPFLG,B'11101111'                                  1150 04748000
*   /*****************************************************************/ 04749000
*   /*                                                               */ 04750000
*   /* GO CHAIN VOLUME INTO NON-GROUPED                      @Y30LB25*/ 04751000
*   /* AND CHECK RETURN CODE                                 @Y30LB25*/ 04752000
*   /*                                                               */ 04753000
*   /*****************************************************************/ 04754000
*                                                                  1151 04755000
*   CALL VUCHI;                     /*                       @Y30LB25*/ 04756000
         BAL   @14,VUCHI                                           1151 04757000
*   IF RPLVRETC^=FIXZERO THEN       /*                       @Y30LB25*/ 04758000
         L     @06,RPLVPTR                                         1152 04759000
         LH    @06,RPLVRETC(,@06)                                  1152 04760000
         N     @06,@CF01129                                        1152 04761000
         LTR   @06,@06                                             1152 04762000
         BNZ   @RT01152                                            1152 04763000
*     RETURN;                       /*                       @Y30LB25*/ 04764000
*                                                                  1153 04765000
*   /*****************************************************************/ 04766000
*   /*                                                               */ 04767000
*   /* UPDATE FIELDS IN THE BASE VOLUME RECORD THAT          @Y30LB25*/ 04768000
*   /* NEED TO BE UPDATED WHEN GOING NON-GROUPED CATAGORY    @Y30LB25*/ 04769000
*   /*                                                               */ 04770000
*   /*****************************************************************/ 04771000
*                                                                  1154 04772000
*   BASGRPV=OFF;                    /* CLEAR GROUP FLAG      @Y30LB25*/ 04773000
*   BASGENUS=OFF;                   /* CLEAR GENERAL USED    @Y30LB25*/ 04774000
*   BASRSTD=OFF;                    /* CLEAR RESTRICTED      @Y30LB25*/ 04775000
         L     @06,BASEVPTR                                        1156 04776000
         NI    BASGRPV(@06),B'11000111'                            1156 04777000
*   BASEXPDT=FIX4FS;                /* CLEAR EXPIRATION      @Y30LB25*/ 04778000
         MVC   BASEXPDT(4,@06),@CB00677                            1157 04779000
*   BASGROUP=BLANK8;                /* BLANK GROUP NAME      @Y30LB25*/ 04780000
         MVI   BASGROUP+1(@06),C' '                                1158 04781000
         MVC   BASGROUP+2(6,@06),BASGROUP+1(@06)                   1158 04782000
         MVI   BASGROUP(@06),C' '                                  1158 04783000
*   RETURN;                         /*                       @Y30LB25*/ 04784000
@EL00024 DS    0H                                                  1159 04785000
@EF00024 DS    0H                                                  1159 04786000
@ER00024 L     @14,@SA00024                                        1159 04787000
         BR    @14                                                 1159 04788000
*   END NGROUPIN;                   /*                       @Y30LB25*/ 04789000
         B     @EL00024                                            1160 04790000
*                                                                  1161 04791000
*   /*****************************************************************/ 04792000
*   /*                                                               */ 04793000
*   /* PROCEDURE NAME - RESTRICT                             @Y30LB25*/ 04794000
*   /*                                                       @Y30LB25*/ 04795000
*   /* FUNCTION -                                            @Y30LB25*/ 04796000
*   /* THIS ROUTINE IS CALLED WHEN A GROUPED VOLUME IS       @Y30LB25*/ 04797000
*   /* CURRENTLY GENERAL USE, BUT IS GOING RESTRICTED        @Y30LB25*/ 04798000
*   /* IN THE SAME GROUP.                                    @Y30LB25*/ 04799000
*   /*                                                       @Y30LB25*/ 04800000
*   /* INPUT -                                               @Y30LB25*/ 04801000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 04802000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 04803000
*   /*                                                       @Y30LB25*/ 04804000
*   /* OUTPUT -                                              @Y30LB25*/ 04805000
*   /* GROUP VOLUME RECORD                                   @Y30LB25*/ 04806000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 04807000
*   /* AN ERROR                                              @Y30LB25*/ 04808000
*   /*                                                               */ 04809000
*   /*****************************************************************/ 04810000
*                                                                  1161 04811000
*RESTRICT:                                                         1161 04812000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 04813000
*                                                                  1161 04814000
RESTRICT ST    @14,@SA00025                                        1161 04815000
*   /*****************************************************************/ 04816000
*   /*                                                               */ 04817000
*   /* GET GROUP NAME AND SET UP TO READ GROUP RECORD        @Y30LB25*/ 04818000
*   /*                                                               */ 04819000
*   /*****************************************************************/ 04820000
*                                                                  1162 04821000
*   GROUPKY=BASGROUP;               /* GROUP NAME            @Y30LB25*/ 04822000
         L     @06,BASEVPTR                                        1162 04823000
         MVC   GROUPKY(8),BASGROUP(@06)                            1162 04824000
*   RPLVKEY=ADDR(GKEY);             /* ADDR KEY              @Y30LB25*/ 04825000
         LA    @06,GKEY                                            1163 04826000
         L     @01,RPLVPTR                                         1163 04827000
         ST    @06,RPLVKEY(,@01)                                   1163 04828000
*   CALL READUPD1;                  /* READ GROUP RECORD     @Y30LB25*/ 04829000
         BAL   @14,READUPD1                                        1164 04830000
*   IF RPLVRETC^=FIXZERO THEN       /* CHECK RETURN?         @Y30LB25*/ 04831000
         L     @06,RPLVPTR                                         1165 04832000
         LH    @06,RPLVRETC(,@06)                                  1165 04833000
         N     @06,@CF01129                                        1165 04834000
         LTR   @06,@06                                             1165 04835000
         BNZ   @RT01165                                            1165 04836000
*     RETURN;                       /*                       @Y30LB25*/ 04837000
*                                                                  1166 04838000
*   /*****************************************************************/ 04839000
*   /*                                                               */ 04840000
*   /* UPDATE FIELDS IN THE GROUP RECORD THAT CHANGE         @Y30LB25*/ 04841000
*   /* WHEN ONE OF ITS VOLUMES GOES FROM GENERAL TO          @Y30LB25*/ 04842000
*   /* RESTRICTED                                            @Y30LB25*/ 04843000
*   /*                                                               */ 04844000
*   /*****************************************************************/ 04845000
*                                                                  1167 04846000
*   GRPBUF1=BASEBUF1;               /* USE CORRECT BUFF      @Y30LB25*/ 04847000
         MVC   GRPBUF1(224),BASEBUF1                               1167 04848000
*   GROUPPTR=ADDR(GRPBUF1);         /* ADDR TO GROUP REC     @Y30LB25*/ 04849000
*                                                                  1168 04850000
         LA    @06,GRPBUF1                                         1168 04851000
         ST    @06,GROUPPTR                                        1168 04852000
*   /*****************************************************************/ 04853000
*   /*                                                               */ 04854000
*   /* CHECK FOR ACTIVE VOLUME                               @Y30LB25*/ 04855000
*   /*                                                               */ 04856000
*   /*****************************************************************/ 04857000
*                                                                  1169 04858000
*   IF BASINAC=OFF                  /* ACTIVE?               @Y30LB25*/ 04859000
*     THEN                          /* YES                   @Y30LB25*/ 04860000
         L     @01,BASEVPTR                                        1169 04861000
         TM    BASINAC(@01),B'00000100'                            1169 04862000
         BNZ   @RF01169                                            1169 04863000
*     DO;                           /*                       @Y30LB25*/ 04864000
*       GRONGEN=GRONGEN-FIXONE;     /* 1 LESS GENERAL USE    @Y30LB25*/ 04865000
         LH    @15,GRONGEN(,@06)                                   1171 04866000
         BCTR  @15,0                                               1171 04867000
         STH   @15,GRONGEN(,@06)                                   1171 04868000
*       GRONRSTD=GRONRSTD+FIXONE;   /* ONE MORE RESTRICTED   @Y30LB25*/ 04869000
         LA    @15,1                                               1172 04870000
         AH    @15,GRONRSTD(,@06)                                  1172 04871000
         STH   @15,GRONRSTD(,@06)                                  1172 04872000
*       ADDSUBGR=OFF;               /* INDICATE TAKING OUT   @Y30LB25*/ 04873000
*                                                                  1173 04874000
         NI    ADDSUBGR,B'11110111'                                1173 04875000
*       /*************************************************************/ 04876000
*       /*                                                           */ 04877000
*       /* GO TAKE SOME SPACE OUT OF GROUPS GENERAL VOLUME   @Y30LB25*/ 04878000
*       /* TOTALS SINCE IT IS GOING RESTRICTED               @Y30LB25*/ 04879000
*       /*                                                           */ 04880000
*       /*************************************************************/ 04881000
*                                                                  1174 04882000
*       CALL VUPGH;                 /*                       @Y30LB25*/ 04883000
         BAL   @14,VUPGH                                           1174 04884000
*       IF RPLVRETC^=FIXZERO THEN   /* CHECK RETURN          @Y30LB25*/ 04885000
         L     @06,RPLVPTR                                         1175 04886000
         LH    @06,RPLVRETC(,@06)                                  1175 04887000
         N     @06,@CF01129                                        1175 04888000
         LTR   @06,@06                                             1175 04889000
         BNZ   @RT01175                                            1175 04890000
*         RETURN;                   /*                       @Y30LB25*/ 04891000
*     END;                          /*                       @Y30LB25*/ 04892000
*                                                                  1177 04893000
*   /*****************************************************************/ 04894000
*   /*                                                               */ 04895000
*   /* UPDATE FIELDS IN THE BASE VOLUME RECORD THAT          @Y30LB25*/ 04896000
*   /* CHANGE WHEN GOING FRON GENERAL TO RESTRICTED          @Y30LB25*/ 04897000
*   /*                                                               */ 04898000
*   /*****************************************************************/ 04899000
*                                                                  1178 04900000
*   BASGENUS=OFF;                   /* NOT GENERAL USE       @Y30LB25*/ 04901000
@RF01169 DS    0H                                                  1179 04902000
*   BASRSTD=ON;                     /* RESTRICTED USE        @Y30LB25*/ 04903000
         L     @06,BASEVPTR                                        1179 04904000
         OI    BASRSTD(@06),B'00001000'                            1179 04905000
         NI    BASGENUS(@06),B'11101111'                           1179 04906000
*   BASEXPDT=FIX4FS;                /* CLEAR EXPIRATION      @Y30LB25*/ 04907000
*                                                                  1180 04908000
         MVC   BASEXPDT(4,@06),@CB00677                            1180 04909000
*   /*****************************************************************/ 04910000
*   /*                                                               */ 04911000
*   /* WRITE THE GROUP RECORD JUST PREVIOUSLY READ           @Y30LB25*/ 04912000
*   /*                                                               */ 04913000
*   /*****************************************************************/ 04914000
*                                                                  1181 04915000
*   RPLVBUF=ADDR(GRPBUF1);          /* BUFFER ADDR           @Y30LB25*/ 04916000
         LA    @06,GRPBUF1                                         1181 04917000
         L     @01,RPLVPTR                                         1181 04918000
         ST    @06,RPLVBUF(,@01)                                   1181 04919000
*   CALL WRITRECD;                  /* WRITE GVR             @Y30LB25*/ 04920000
         BAL   @14,WRITRECD                                        1182 04921000
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/ 04922000
*     THEN                          /* YES                   @Y30LB25*/ 04923000
         L     @06,RPLVPTR                                         1183 04924000
         LH    @06,RPLVRETC(,@06)                                  1183 04925000
         N     @06,@CF01129                                        1183 04926000
         LTR   @06,@06                                             1183 04927000
         BNZ   @RT01183                                            1183 04928000
*     RETURN;                       /*                       @Y30LB25*/ 04929000
*                                                                  1184 04930000
*   /*****************************************************************/ 04931000
*   /*                                                               */ 04932000
*   /* REMOVE THE SLOT, IF ACTIVE VOLUME                     @Y30LB25*/ 04933000
*   /*                                                               */ 04934000
*   /*****************************************************************/ 04935000
*                                                                  1185 04936000
*   IF BASINAC=OFF                  /* ACTIVE?               @Y30LB25*/ 04937000
*     THEN                          /* YES                   @Y30LB25*/ 04938000
         L     @06,BASEVPTR                                        1185 04939000
         TM    BASINAC(@06),B'00000100'                            1185 04940000
         BNZ   @RF01185                                            1185 04941000
*     DO;                           /*                       @Y30LB25*/ 04942000
*       ADDSUBSL=OFF;               /* DELETE                @Y30LB25*/ 04943000
         NI    ADDSUBSL,B'11111101'                                1187 04944000
*       EXPSLOT=OFF;                /* NO EXPIR DATE         @Y30LB25*/ 04945000
         NI    EXPSLOT,B'01111111'                                 1188 04946000
*       CALL ICBVUEXT(GROUPPTR,BASEVPTR,RPLVPTR,PASSBYTE);/* @Y30LB25*/ 04947000
         L     @15,@CV00767                                        1189 04948000
         LA    @01,@AL01189                                        1189 04949000
         BALR  @14,@15                                             1189 04950000
*     END;                          /*                       @Y30LB25*/ 04951000
*   RETURN;                         /*                       @Y30LB25*/ 04952000
@EL00025 DS    0H                                                  1191 04953000
@EF00025 DS    0H                                                  1191 04954000
@ER00025 L     @14,@SA00025                                        1191 04955000
         BR    @14                                                 1191 04956000
*   END RESTRICT;                   /*                       @Y30LB25*/ 04957000
         B     @EL00025                                            1192 04958000
*                                                                  1193 04959000
*   /*****************************************************************/ 04960000
*   /*                                                               */ 04961000
*   /* PROCEDURE NAME - GENERAL                              @Y30LB25*/ 04962000
*   /*                                                       @Y30LB25*/ 04963000
*   /* FUNCTION -                                            @Y30LB25*/ 04964000
*   /* THIS ROUTINE IS CALLED WHEN A BASE VOLUME RECORD      @Y30LB25*/ 04965000
*   /* IS GOING FROM RESTRICTED TO GENERAL USE IN THE        @Y30LB25*/ 04966000
*   /* SAME GROUP.                                           @Y30LB25*/ 04967000
*   /*                                                       @Y30LB25*/ 04968000
*   /* INPUT -                                               @Y30LB25*/ 04969000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 04970000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 04971000
*   /*                                                       @Y30LB25*/ 04972000
*   /* OUTPUT -                                              @Y30LB25*/ 04973000
*   /* GROUP VOLUME RECORD                                   @Y30LB25*/ 04974000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 04975000
*   /* AN ERROR                                              @Y30LB25*/ 04976000
*   /*                                                               */ 04977000
*   /*****************************************************************/ 04978000
*                                                                  1193 04979000
*GENERAL:                                                          1193 04980000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 04981000
*                                                                  1193 04982000
GENERAL  ST    @14,@SA00026                                        1193 04983000
*   /*****************************************************************/ 04984000
*   /*                                                               */ 04985000
*   /* GET GROUP NAME FROM BASE RECORD AND SET UP TO         @Y30LB25*/ 04986000
*   /* READ THE GROUP RECORD                                 @Y30LB25*/ 04987000
*   /*                                                               */ 04988000
*   /*****************************************************************/ 04989000
*                                                                  1194 04990000
*   GROUPKY=BASGROUP;               /* GET NEW GROUP NAME    @Y30LB25*/ 04991000
         L     @06,BASEVPTR                                        1194 04992000
         MVC   GROUPKY(8),BASGROUP(@06)                            1194 04993000
*   RPLVKEY=ADDR(GKEY);             /* ADDR GROUP KEY        @Y30LB25*/ 04994000
         LA    @06,GKEY                                            1195 04995000
         L     @01,RPLVPTR                                         1195 04996000
         ST    @06,RPLVKEY(,@01)                                   1195 04997000
*   CALL READUPD1;                  /* READ GROUP RECORD     @Y30LB25*/ 04998000
         BAL   @14,READUPD1                                        1196 04999000
*   IF RPLVRETC^=FIXZERO THEN       /* CHECK RETURN?         @Y30LB25*/ 05000000
         L     @06,RPLVPTR                                         1197 05001000
         LH    @06,RPLVRETC(,@06)                                  1197 05002000
         N     @06,@CF01129                                        1197 05003000
         LTR   @06,@06                                             1197 05004000
         BNZ   @RT01197                                            1197 05005000
*     RETURN;                       /*                       @Y30LB25*/ 05006000
*                                                                  1198 05007000
*   /*****************************************************************/ 05008000
*   /*                                                               */ 05009000
*   /* GET ADDRESS OF GROUP RECORD, UPDATE REQUIRED FIELDS   @Y30LB25*/ 05010000
*   /*                                                               */ 05011000
*   /*****************************************************************/ 05012000
*                                                                  1199 05013000
*   GRPBUF1=BASEBUF1;               /* USE CORRECT BUFF      @Y30LB25*/ 05014000
         MVC   GRPBUF1(224),BASEBUF1                               1199 05015000
*   GROUPPTR=ADDR(GRPBUF1);         /* ADDRESSING TO GRP REC @Y30LB25*/ 05016000
*                                                                  1200 05017000
         LA    @06,GRPBUF1                                         1200 05018000
         ST    @06,GROUPPTR                                        1200 05019000
*   /*****************************************************************/ 05020000
*   /*                                                               */ 05021000
*   /* CHECK FOR ACTIVE VOLUME                               @Y30LB25*/ 05022000
*   /*                                                               */ 05023000
*   /*****************************************************************/ 05024000
*                                                                  1201 05025000
*   IF BASINAC=OFF                  /* ACTIVE?               @Y30LB25*/ 05026000
*     THEN                          /* YES                   @Y30LB25*/ 05027000
         L     @01,BASEVPTR                                        1201 05028000
         TM    BASINAC(@01),B'00000100'                            1201 05029000
         BNZ   @RF01201                                            1201 05030000
*     DO;                           /*                       @Y30LB25*/ 05031000
*       GRONGEN=GRONGEN+FIXONE;     /* ONE MORE GENERAL USE  @Y30LB25*/ 05032000
         LA    @15,1                                               1203 05033000
         AH    @15,GRONGEN(,@06)                                   1203 05034000
         STH   @15,GRONGEN(,@06)                                   1203 05035000
*       GRONRSTD=GRONRSTD-FIXONE;   /* ONE LESS RESTRICTED   @Y30LB25*/ 05036000
*                                                                  1204 05037000
         LH    @15,GRONRSTD(,@06)                                  1204 05038000
         BCTR  @15,0                                               1204 05039000
         STH   @15,GRONRSTD(,@06)                                  1204 05040000
*       /*************************************************************/ 05041000
*       /*                                                           */ 05042000
*       /* GO ADD SOME SPACE TO THE GROUP FIELDS SINCE IT IS @Y30LB25*/ 05043000
*       /* GETTING A GENERAL TYPE VOLUME                     @Y30LB25*/ 05044000
*       /*                                                           */ 05045000
*       /*************************************************************/ 05046000
*                                                                  1205 05047000
*       ADDSUBGR=ON;                /* INDICATE ADDING GEN   @Y30LB25*/ 05048000
         OI    ADDSUBGR,B'00001000'                                1205 05049000
*       CALL VUPGH;                 /*                       @Y30LB25*/ 05050000
         BAL   @14,VUPGH                                           1206 05051000
*       IF RPLVRETC^=FIXZERO THEN   /* CHECK RETURN          @Y30LB25*/ 05052000
         L     @06,RPLVPTR                                         1207 05053000
         LH    @06,RPLVRETC(,@06)                                  1207 05054000
         N     @06,@CF01129                                        1207 05055000
         LTR   @06,@06                                             1207 05056000
         BNZ   @RT01207                                            1207 05057000
*         RETURN;                   /*                       @Y30LB25*/ 05058000
*     END;                          /*                       @Y30LB25*/ 05059000
*                                                                  1209 05060000
*   /*****************************************************************/ 05061000
*   /*                                                               */ 05062000
*   /* CHANGE INDICATORS IN BASE VOLUME TO GENERAL-USE       @Y30LB25*/ 05063000
*   /*                                                               */ 05064000
*   /*****************************************************************/ 05065000
*                                                                  1210 05066000
*   BASGENUS=ON;                    /* GENERAL USE           @Y30LB25*/ 05067000
@RF01201 DS    0H                                                  1211 05068000
*   BASRSTD=OFF;                    /* NOT RESTRICTED USE    @Y30LB25*/ 05069000
*                                                                  1211 05070000
         L     @06,BASEVPTR                                        1211 05071000
         OI    BASGENUS(@06),B'00010000'                           1211 05072000
         NI    BASRSTD(@06),B'11110111'                            1211 05073000
*   /*****************************************************************/ 05074000
*   /*                                                               */ 05075000
*   /* WRITE GROUP RECORD                                    @Y30LB25*/ 05076000
*   /*                                                               */ 05077000
*   /*****************************************************************/ 05078000
*                                                                  1212 05079000
*   RPLVBUF=ADDR(GRPBUF1);          /* BUFFER ADDR           @Y30LB25*/ 05080000
         LA    @06,GRPBUF1                                         1212 05081000
         L     @01,RPLVPTR                                         1212 05082000
         ST    @06,RPLVBUF(,@01)                                   1212 05083000
*   CALL WRITRECD;                  /* WRITE GVR             @Y30LB25*/ 05084000
         BAL   @14,WRITRECD                                        1213 05085000
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/ 05086000
*     THEN                          /* YES                   @Y30LB25*/ 05087000
         L     @06,RPLVPTR                                         1214 05088000
         LH    @06,RPLVRETC(,@06)                                  1214 05089000
         N     @06,@CF01129                                        1214 05090000
         LTR   @06,@06                                             1214 05091000
         BNZ   @RT01214                                            1214 05092000
*     RETURN;                       /*                       @Y30LB25*/ 05093000
*                                                                  1215 05094000
*   /*****************************************************************/ 05095000
*   /*                                                               */ 05096000
*   /* ADD A SLOT, IF VOLUME IS ACTIVE                       @Y30LB25*/ 05097000
*   /*                                                               */ 05098000
*   /*****************************************************************/ 05099000
*                                                                  1216 05100000
*   IF BASINAC=OFF                  /* ACTIVE?               @Y30LB25*/ 05101000
*     THEN                          /* YES                   @Y30LB25*/ 05102000
         L     @06,BASEVPTR                                        1216 05103000
         TM    BASINAC(@06),B'00000100'                            1216 05104000
         BNZ   @RF01216                                            1216 05105000
*     DO;                           /*                       @Y30LB25*/ 05106000
*       ADDSUBSL=ON;                /* ADD                   @Y30LB25*/ 05107000
         OI    ADDSUBSL,B'00000010'                                1218 05108000
*       EXPSLOT=OFF;                /* NO EXPIR DATE         @Y30LB25*/ 05109000
         NI    EXPSLOT,B'01111111'                                 1219 05110000
*       CALL ICBVUEXT(GROUPPTR,BASEVPTR,RPLVPTR,PASSBYTE);/* @Y30LB25*/ 05111000
         L     @15,@CV00767                                        1220 05112000
         LA    @01,@AL01220                                        1220 05113000
         BALR  @14,@15                                             1220 05114000
*     END;                          /*                       @Y30LB25*/ 05115000
*   RETURN;                         /*                       @Y30LB25*/ 05116000
@EL00026 DS    0H                                                  1222 05117000
@EF00026 DS    0H                                                  1222 05118000
@ER00026 L     @14,@SA00026                                        1222 05119000
         BR    @14                                                 1222 05120000
*   END GENERAL;                    /*                       @Y30LB25*/ 05121000
         B     @EL00026                                            1223 05122000
*                                                                  1224 05123000
*   /*****************************************************************/ 05124000
*   /*                                                               */ 05125000
*   /* PROCEDURE NAME - COMMON                               @Y30LB25*/ 05126000
*   /*                                                       @Y30LB25*/ 05127000
*   /* FUNCTION -                                            @Y30LB25*/ 05128000
*   /* ROUTINE UPDATES THE REMAINING FIELDS IN THE BASE      @Y30LB25*/ 05129000
*   /* VOLUME RECORD THAT HAVE NOTHING TO DO WITH THE GROUP. @Y30LB25*/ 05130000
*   /*                                                       @Y30LB25*/ 05131000
*   /* INPUT -                                               @Y30LB25*/ 05132000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 05133000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 05134000
*   /*                                                       @Y30LB25*/ 05135000
*   /* OUTPUT -                                              @Y30LB25*/ 05136000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 05137000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 05138000
*   /* AN ERROR                                              @Y30LB25*/ 05139000
*   /*                                                               */ 05140000
*   /*****************************************************************/ 05141000
*                                                                  1224 05142000
*COMMON:                                                           1224 05143000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 05144000
*                                                                  1224 05145000
COMMON   ST    @14,@SA00027                                        1224 05146000
*   /*****************************************************************/ 05147000
*   /*                                                               */ 05148000
*   /* IF GENERAL USE VOLUME THEN HANDLE EXPIRATION          @Y30LB25*/ 05149000
*   /* CHANGES IF CALLED FOR                                 @Y30LB25*/ 05150000
*   /*                                                               */ 05151000
*   /*****************************************************************/ 05152000
*                                                                  1225 05153000
*   IF BASGRPV=ON&BASGENUS=ON&      /* GENERAL USE VOL?      @Y30LB25*/ 05154000
*       (DEFNEXPD=ON|DEFPFOR=ON|DEFPTO=ON) THEN/* CHNGN EXP  @Y30LB25*/ 05155000
         L     @06,BASEVPTR                                        1225 05156000
         TM    BASGRPV(@06),B'00110000'                            1225 05157000
         BNO   @RF01225                                            1225 05158000
         TM    DEFNEXPD(DEFVEPTR),B'00100000'                      1225 05159000
         BO    @RT01225                                            1225 05160000
         TM    DEFPFOR(DEFVEPTR),B'10001000'                       1225 05161000
         BZ    @RF01225                                            1225 05162000
@RT01225 DS    0H                                                  1226 05163000
*     DO;                           /*                       @Y30LB25*/ 05164000
*       GROUPKY=BASGROUP;           /* GET GROUP NAME        @Y30LB25*/ 05165000
         L     @06,BASEVPTR                                        1227 05166000
         MVC   GROUPKY(8),BASGROUP(@06)                            1227 05167000
*       RPLVKEY=ADDR(GKEY);         /* ADDR GROUP KEY        @Y30LB25*/ 05168000
         LA    @06,GKEY                                            1228 05169000
         L     @01,RPLVPTR                                         1228 05170000
         ST    @06,RPLVKEY(,@01)                                   1228 05171000
*       CALL READUPD1;              /* READ GROUP RECORD     @ZA13484*/ 05172000
         BAL   @14,READUPD1                                        1229 05173000
*       IF RPLVRETC^=FIXZERO THEN   /* CK RETURN             @Y30LB25*/ 05174000
         L     @06,RPLVPTR                                         1230 05175000
         LH    @06,RPLVRETC(,@06)                                  1230 05176000
         N     @06,@CF01129                                        1230 05177000
         LTR   @06,@06                                             1230 05178000
         BNZ   @RT01230                                            1230 05179000
*         RETURN;                   /*                       @Y30LB25*/ 05180000
*                                                                  1231 05181000
*       /*************************************************************/ 05182000
*       /*                                                           */ 05183000
*       /* SET ADDR TO GROUP RECORD JUST READ                @Y30LB25*/ 05184000
*       /*                                                           */ 05185000
*       /*************************************************************/ 05186000
*                                                                  1232 05187000
*       GRPBUF1=BASEBUF1;           /* USE CORRECT BUFF      @ZA13484*/ 05188000
         MVC   GRPBUF1(224),BASEBUF1                               1232 05189000
*       GROUPPTR=ADDR(GRPBUF1);     /* ADDRESSING TO GRP REC @ZA13484*/ 05190000
*                                                                  1233 05191000
         LA    @06,GRPBUF1                                         1233 05192000
         ST    @06,GROUPPTR                                        1233 05193000
*       /*************************************************************/ 05194000
*       /*                                                           */ 05195000
*       /* NULLIFY EXPIRATION DATE BASE RECORD               @Y30LB25*/ 05196000
*       /* CALL ROUTINE TO UPDATE SLOT IN EXTENSION RECORD   @ZA00687*/ 05197000
*       /* TO MATCH RETENTION DATE IN BASE VOLUME RECORD     @ZA00687*/ 05198000
*       /* FOR RETENTION DATE. REMOVE FROM CURRENT SLOT AND  @ZA00687*/ 05199000
*       /* ADD IN LAST EXTENSION SLOT                        @ZA00687*/ 05200000
*       /*                                                           */ 05201000
*       /*************************************************************/ 05202000
*                                                                  1234 05203000
*       IF DEFNEXPD=ON THEN         /* NULL EXPIRATION DATE? @ZA00687*/ 05204000
         TM    DEFNEXPD(DEFVEPTR),B'00100000'                      1234 05205000
         BNO   @RF01234                                            1234 05206000
*         DO;                       /*                       @ZA00687*/ 05207000
*           BASEXPDT=FIX4FS;        /* NULLIFY EXPIRATION    @ZA00687*/ 05208000
         L     @06,BASEVPTR                                        1236 05209000
         MVC   BASEXPDT(4,@06),@CB00677                            1236 05210000
*           IF BASINAC=OFF THEN     /* IS VOL INACTIVE       @ZA17177*/ 05211000
         TM    BASINAC(@06),B'00000100'                            1237 05212000
         BNZ   @RF01237                                            1237 05213000
*             DO;                   /*                       @ZA17177*/ 05214000
*               EXPSLOT=OFF;        /* INDICATE DELETE       @ZA00687*/ 05215000
         NI    EXPSLOT,B'01111111'                                 1239 05216000
*               ADDSUBSL=OFF;       /* INDICATE DELETE       @ZA00687*/ 05217000
         NI    ADDSUBSL,B'11111101'                                1240 05218000
*               CALL ICBVUEXT(GROUPPTR,BASEVPTR,RPLVPTR,PASSBYTE); 1241 05219000
         L     @15,@CV00767                                        1241 05220000
         LA    @01,@AL01241                                        1241 05221000
         BALR  @14,@15                                             1241 05222000
*               IF RPLVRETC^=FIXZERO THEN/* CK RETURN        @ZA00687*/ 05223000
         L     @06,RPLVPTR                                         1242 05224000
         LH    @06,RPLVRETC(,@06)                                  1242 05225000
         N     @06,@CF01129                                        1242 05226000
         LTR   @06,@06                                             1242 05227000
         BNZ   @RT01242                                            1242 05228000
*                 RETURN;           /*                       @ZA00687*/ 05229000
*               ADDSUBSL=ON;        /* INDICATE ADD          @ZA00687*/ 05230000
         OI    ADDSUBSL,B'00000010'                                1244 05231000
*               CALL ICBVUEXT(GROUPPTR,BASEVPTR,RPLVPTR,PASSBYTE); 1245 05232000
         L     @15,@CV00767                                        1245 05233000
         LA    @01,@AL01245                                        1245 05234000
         BALR  @14,@15                                             1245 05235000
*               IF RPLVRETC^=FIXZERO THEN/* CK RETURN        @ZA00687*/ 05236000
         L     @06,RPLVPTR                                         1246 05237000
         LH    @06,RPLVRETC(,@06)                                  1246 05238000
         N     @06,@CF01129                                        1246 05239000
         LTR   @06,@06                                             1246 05240000
         BNZ   @RT01246                                            1246 05241000
*                 RETURN;           /*                       @ZA00687*/ 05242000
*             END;                  /*                       @ZA17177*/ 05243000
*         END;                      /*                       @ZA00687*/ 05244000
*       ELSE                        /*                       #Y30LB25*/ 05245000
*                                                                  1250 05246000
*         /***********************************************************/ 05247000
*         /*                                                         */ 05248000
*         /* OTHERWISE CHECK IF TO OR FOR SPECIFIED          #Y30LB25*/ 05249000
*         /*                                                         */ 05250000
*         /***********************************************************/ 05251000
*                                                                  1250 05252000
*         DO;                       /*                       @Y30LB25*/ 05253000
*                                                                  1250 05254000
         B     @RC01234                                            1250 05255000
@RF01234 DS    0H                                                  1251 05256000
*           /*********************************************************/ 05257000
*           /*                                                       */ 05258000
*           /* IF FOR SPECIFIED, GO CALCULATE EXPIRATION     @Y30LB25*/ 05259000
*           /* DATE AND PUT IT IN BASE RECORD                @Y30LB25*/ 05260000
*           /*                                                       */ 05261000
*           /*********************************************************/ 05262000
*                                                                  1251 05263000
*           IF DEFPFOR=ON THEN      /* FOR SPECIFIED?        @Y30LB25*/ 05264000
         TM    DEFPFOR(DEFVEPTR),B'10000000'                       1251 05265000
         BNO   @RF01251                                            1251 05266000
*             DO;                   /*                       @Y30LB25*/ 05267000
*               CALL ICBVUEXP(DEFFOR,EXPRDT);/*              @Y30LB25*/ 05268000
         LA    @06,DEFFOR(,DEFVEPTR)                               1253 05269000
         ST    @06,@AL00001                                        1253 05270000
         LA    @06,EXPRDT                                          1253 05271000
         ST    @06,@AL00001+4                                      1253 05272000
         L     @15,@CV00768                                        1253 05273000
         LA    @01,@AL00001                                        1253 05274000
         BALR  @14,@15                                             1253 05275000
*               BASEXPDT=EXPRDT;    /* RET IN BASE REC       @Y30LB25*/ 05276000
         L     @06,BASEVPTR                                        1254 05277000
         MVC   BASEXPDT(4,@06),EXPRDT                              1254 05278000
*             END;                  /*                       @Y30LB25*/ 05279000
*                                                                  1255 05280000
*           /*********************************************************/ 05281000
*           /*                                                       */ 05282000
*           /* IF TO WAS SPECIFIED, IF IT EXCEEDS MAXIMUM,   @Y30LB25*/ 05283000
*           /* PUT IN MAXIMUM DATE, OTHERWISE PUT IN TO DATE @Y30LB25*/ 05284000
*           /*                                                       */ 05285000
*           /*********************************************************/ 05286000
*                                                                  1256 05287000
*           IF DEFPTO=ON THEN       /* TO SPECIFIED?         @Y30LB25*/ 05288000
@RF01251 TM    DEFPTO(DEFVEPTR),B'00001000'                        1256 05289000
         BNO   @RF01256                                            1256 05290000
*             DO;                   /*                       @Y30LB25*/ 05291000
*               IF DEFTO>MAXDATE THEN/* CHECK DATE?          @Y30LB25*/ 05292000
         CLC   DEFTO(4,DEFVEPTR),MAXDATE                           1258 05293000
         BNH   @RF01258                                            1258 05294000
*                 BASEXPDT=MAXDATE; /* SET TO MAX DATE       @Y30LB25*/ 05295000
         L     @06,BASEVPTR                                        1259 05296000
         MVC   BASEXPDT(4,@06),MAXDATE                             1259 05297000
*               ELSE                /*                       @Y30LB25*/ 05298000
*                 BASEXPDT=DEFTO;   /* SET TO GIVEN DATE     @Y30LB25*/ 05299000
         B     @RC01258                                            1260 05300000
@RF01258 L     @06,BASEVPTR                                        1260 05301000
         MVC   BASEXPDT(4,@06),DEFTO(DEFVEPTR)                     1260 05302000
*             END;                  /*                       @Y30LB25*/ 05303000
@RC01258 DS    0H                                                  1262 05304000
*         END;                      /*                       @Y30LB25*/ 05305000
*                                                                  1262 05306000
@RF01256 DS    0H                                                  1263 05307000
*       /*************************************************************/ 05308000
*       /*                                                           */ 05309000
*       /* CALL ROUTINE TO UPDATE SLOT IN EXTENSION RECORD   @Y30LB25*/ 05310000
*       /* TO MATCH EXPIRATION DATE IN BASE VOLUME RECORD    @Y30LB25*/ 05311000
*       /* IF THE VOLUME IS ACTIVE.                          @Y30LB25*/ 05312000
*       /*                                                           */ 05313000
*       /*************************************************************/ 05314000
*                                                                  1263 05315000
*       IF BASINAC=OFF              /* ACTIVE?               @Y30LB25*/ 05316000
*         THEN                      /* YES                   @Y30LB25*/ 05317000
@RC01234 L     @06,BASEVPTR                                        1263 05318000
         TM    BASINAC(@06),B'00000100'                            1263 05319000
         BNZ   @RF01263                                            1263 05320000
*         DO;                       /*                       @Y30LB25*/ 05321000
*           EXPSLOT=ON;             /* ADD EXPIR DATE        @Y30LB25*/ 05322000
         OI    EXPSLOT,B'10000000'                                 1265 05323000
*           CALL ICBVUEXT(GROUPPTR,BASEVPTR,RPLVPTR,PASSBYTE);/*   1266 05324000
*                                                            @Y30LB25*/ 05325000
         L     @15,@CV00767                                        1266 05326000
         LA    @01,@AL01266                                        1266 05327000
         BALR  @14,@15                                             1266 05328000
*           IF RPLVRETC^=FIXZERO THEN/* CK RETURN            @Y30LB25*/ 05329000
         L     @06,RPLVPTR                                         1267 05330000
         LH    @06,RPLVRETC(,@06)                                  1267 05331000
         N     @06,@CF01129                                        1267 05332000
         LTR   @06,@06                                             1267 05333000
         BNZ   @RT01267                                            1267 05334000
*             RETURN;               /*                       @Y30LB25*/ 05335000
*         END;                      /*                       @Y30LB25*/ 05336000
*       GROUPPTR=ADDR(GROUPBUF);    /* RESET GROUP PTR       @ZA13058*/ 05337000
@RF01263 LA    @06,GROUPBUF                                        1270 05338000
         ST    @06,GROUPPTR                                        1270 05339000
*     END;                          /*                       @Y30LB25*/ 05340000
*                                                                  1271 05341000
*   /*****************************************************************/ 05342000
*   /*                                                               */ 05343000
*   /* IF NULLIFY DESCRIPTION CALLED FOR, NULLIFY IT         @Y30LB25*/ 05344000
*   /*                                                               */ 05345000
*   /*****************************************************************/ 05346000
*                                                                  1272 05347000
*   IF DEFNDESC=ON THEN             /* NULLIFY DEXCRIPTION?  @Y30LB25*/ 05348000
@RF01225 TM    DEFNDESC(DEFVEPTR),B'01000000'                      1272 05349000
         BNO   @RF01272                                            1272 05350000
*     BASDESCR=BLANK30;             /* NULLIFT DESCRIP       @Y30LB25*/ 05351000
         L     @06,BASEVPTR                                        1273 05352000
         MVI   BASDESCR+1(@06),C' '                                1273 05353000
         MVC   BASDESCR+2(28,@06),BASDESCR+1(@06)                  1273 05354000
         MVI   BASDESCR(@06),C' '                                  1273 05355000
*   ELSE                            /*                       @Y30LB25*/ 05356000
*                                                                  1274 05357000
*     /***************************************************************/ 05358000
*     /*                                                             */ 05359000
*     /* OTHERWISE SEE IF NEW DESCRIPTION CALLED FOR         @Y30LB25*/ 05360000
*     /*                                                             */ 05361000
*     /***************************************************************/ 05362000
*                                                                  1274 05363000
*     IF DEFPDESC=ON THEN           /* DESCR SPEC?           @Y30LB25*/ 05364000
         B     @RC01272                                            1274 05365000
@RF01272 TM    DEFPDESC(DEFVEPTR),B'00010000'                      1274 05366000
         BNO   @RF01274                                            1274 05367000
*       BASDESCR=DEFDESCR;          /* MODIFY DESCRIPTION    @Y30LB25*/ 05368000
*                                                                  1275 05369000
         L     @06,BASEVPTR                                        1275 05370000
         MVC   BASDESCR(30,@06),DEFDESCR(DEFVEPTR)                 1275 05371000
*   /*****************************************************************/ 05372000
*   /*                                                               */ 05373000
*   /* IF NEW BACKUP NUMBER SPECIFIED, PUT IT IN             @Y30LB25*/ 05374000
*   /*                                                               */ 05375000
*   /*****************************************************************/ 05376000
*                                                                  1276 05377000
*   IF DEFPBKUP=ON THEN             /* BACKUP SPEC?          @Y30LB25*/ 05378000
@RF01274 DS    0H                                                  1276 05379000
@RC01272 TM    DEFPBKUP(DEFVEPTR),B'00000100'                      1276 05380000
         BNO   @RF01276                                            1276 05381000
*     BASBKLMT=DEFBKUPN;            /* SET MAX BACKUPS       @Y30LB25*/ 05382000
*                                                                  1277 05383000
         IC    @06,DEFBKUPN(,DEFVEPTR)                             1277 05384000
         L     @01,BASEVPTR                                        1277 05385000
         STC   @06,BASBKLMT(,@01)                                  1277 05386000
*   /*****************************************************************/ 05387000
*   /*                                                               */ 05388000
*   /* CLEAR AND/OR SET ERROR RECOVERY FLAGS                 @Y30LB25*/ 05389000
*   /*                                                               */ 05390000
*   /*****************************************************************/ 05391000
*                                                                  1278 05392000
*   BCDVPTR=BASEVPTR;               /* PT TO BVR             @Y30LB25*/ 05393000
@RF01276 L     @06,BASEVPTR                                        1278 05394000
         ST    @06,BCDVPTR                                         1278 05395000
*   CALL SETCLRDF;                  /* CLEAR - SET RECOVERY  @Y30LB25*/ 05396000
         BAL   @14,SETCLRDF                                        1279 05397000
*   RETURN;                         /*                       @Y30LB25*/ 05398000
@EL00027 DS    0H                                                  1280 05399000
@EF00027 DS    0H                                                  1280 05400000
@ER00027 L     @14,@SA00027                                        1280 05401000
         BR    @14                                                 1280 05402000
*   END COMMON;                     /*                       @Y30LB25*/ 05403000
         B     @EL00027                                            1281 05404000
*                                                                  1282 05405000
*   /*****************************************************************/ 05406000
*   /*                                                               */ 05407000
*   /* PROCEDURE NAME - PCVRE                                @Y30LB25*/ 05408000
*   /*                                                       @Y30LB25*/ 05409000
*   /* FUNCTION -                                            @Y30LB25*/ 05410000
*   /* PROCESS THE IEZDEFVE FOR A CVR.                       @Y30LB25*/ 05411000
*   /*                                                       @Y30LB25*/ 05412000
*   /* INPUT -                                               @Y30LB25*/ 05413000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 05414000
*   /* COPY VOLUME RECORD                                    @Y30LB25*/ 05415000
*   /*                                                       @Y30LB25*/ 05416000
*   /* OUTPUT -                                              @Y30LB25*/ 05417000
*   /* COPY VOLUME RECORD                                    @Y30LB25*/ 05418000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 05419000
*   /* AN ERROR                                              @Y30LB25*/ 05420000
*   /*                                                               */ 05421000
*   /*****************************************************************/ 05422000
*                                                                  1282 05423000
*PCVRE:                                                            1282 05424000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 05425000
*                                                                  1282 05426000
PCVRE    ST    @14,@SA00028                                        1282 05427000
*   /*****************************************************************/ 05428000
*   /*                                                               */ 05429000
*   /* CHECK FOR DESCRIPTION                                 @Y30LB25*/ 05430000
*   /*                                                               */ 05431000
*   /*****************************************************************/ 05432000
*                                                                  1283 05433000
*   IF DEFPDESC=ON                  /* ADD DESCRPT?          @Y30LB25*/ 05434000
*     THEN                          /* YES                   @Y30LB25*/ 05435000
         TM    DEFPDESC(DEFVEPTR),B'00010000'                      1283 05436000
         BNO   @RF01283                                            1283 05437000
*     COPDESCR=DEFDESCR;            /* SET NEW DESCRPT       @Y30LB25*/ 05438000
         L     @06,COPYVPTR                                        1284 05439000
         MVC   COPDESCR(30,@06),DEFDESCR(DEFVEPTR)                 1284 05440000
*   IF DEFNDESC=ON                  /* NULLIFY?              @Y30LB25*/ 05441000
*     THEN                          /* YES                   @Y30LB25*/ 05442000
@RF01283 TM    DEFNDESC(DEFVEPTR),B'01000000'                      1285 05443000
         BNO   @RF01285                                            1285 05444000
*     COPDESCR=BLANK30;             /* BLANK DESCRPT         @Y30LB25*/ 05445000
*                                                                  1286 05446000
         L     @06,COPYVPTR                                        1286 05447000
         MVI   COPDESCR+1(@06),C' '                                1286 05448000
         MVC   COPDESCR+2(28,@06),COPDESCR+1(@06)                  1286 05449000
         MVI   COPDESCR(@06),C' '                                  1286 05450000
*   /*****************************************************************/ 05451000
*   /*                                                               */ 05452000
*   /* CHECK IF THE MAXIMUM NUMBER OF BACKUPS IS TO CHANGE   @Y30LB25*/ 05453000
*   /*                                                               */ 05454000
*   /*****************************************************************/ 05455000
*                                                                  1287 05456000
*   IF DEFPBKUP=ON                  /* BACKUP?               @Y30LB25*/ 05457000
*     THEN                          /* YES                   @Y30LB25*/ 05458000
@RF01285 TM    DEFPBKUP(DEFVEPTR),B'00000100'                      1287 05459000
         BNO   @RF01287                                            1287 05460000
*     DO;                           /*                       @Y30LB25*/ 05461000
*       BVOLKY=COPSERNO;            /* SET VOLID             @Y30LB25*/ 05462000
         L     @06,COPYVPTR                                        1289 05463000
         MVC   BVOLKY(6),COPSERNO(@06)                             1289 05464000
*       RPLVKEY=ADDR(BKEY);         /* SET KEY ADDR          @Y30LB25*/ 05465000
         LA    @06,BKEY                                            1290 05466000
         L     @01,RPLVPTR                                         1290 05467000
         ST    @06,RPLVKEY(,@01)                                   1290 05468000
*       CALL READUPD1;              /* READ CVR'S BVR        @Y30LB25*/ 05469000
         BAL   @14,READUPD1                                        1291 05470000
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/ 05471000
*         THEN                      /* YES                   @Y30LB25*/ 05472000
         L     @06,RPLVPTR                                         1292 05473000
         LH    @06,RPLVRETC(,@06)                                  1292 05474000
         N     @06,@CF01129                                        1292 05475000
         LTR   @06,@06                                             1292 05476000
         BNZ   @RT01292                                            1292 05477000
*         RETURN;                   /*                       @Y30LB25*/ 05478000
*       BASEVPTR=ADDR(BASEBUF1);    /* MAP OF BVR            @Y30LB25*/ 05479000
         LA    @06,BASEBUF1                                        1294 05480000
         ST    @06,BASEVPTR                                        1294 05481000
*       BASBKLMT=DEFBKUPN;          /* SET MAX # BKUP        @Y30LB25*/ 05482000
         IC    @15,DEFBKUPN(,DEFVEPTR)                             1295 05483000
         STC   @15,BASBKLMT(,@06)                                  1295 05484000
*       CALL WRITRECD;              /* WRITE BVR             @Y30LB25*/ 05485000
         BAL   @14,WRITRECD                                        1296 05486000
*       BASEVPTR=ADDR(BASEBUF);     /* RESTORE MAP           @Y30LB25*/ 05487000
         LA    @06,BASEBUF                                         1297 05488000
         ST    @06,BASEVPTR                                        1297 05489000
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/ 05490000
*         THEN                      /* YES                   @Y30LB25*/ 05491000
         L     @06,RPLVPTR                                         1298 05492000
         LH    @06,RPLVRETC(,@06)                                  1298 05493000
         N     @06,@CF01129                                        1298 05494000
         LTR   @06,@06                                             1298 05495000
         BNZ   @RT01298                                            1298 05496000
*         RETURN;                   /*                       @Y30LB25*/ 05497000
*     END;                          /*                       @Y30LB25*/ 05498000
*                                                                  1300 05499000
*   /*****************************************************************/ 05500000
*   /*                                                               */ 05501000
*   /* CLEAR AND/OR SET ERROR RECOVERY FLAGS                 @Y30LB25*/ 05502000
*   /*                                                               */ 05503000
*   /*****************************************************************/ 05504000
*                                                                  1301 05505000
*   CALL SETCLRDF;                  /* SET - CLEAR           @Y30LB25   05506000
*                                      RECOVERY FLGS         @Y30LB25*/ 05507000
@RF01287 BAL   @14,SETCLRDF                                        1301 05508000
*   RETURN;                         /*                       @Y30LB25*/ 05509000
@EL00028 DS    0H                                                  1302 05510000
@EF00028 DS    0H                                                  1302 05511000
@ER00028 L     @14,@SA00028                                        1302 05512000
         BR    @14                                                 1302 05513000
*   END PCVRE;                      /*                       @Y30LB25*/ 05514000
         B     @EL00028                                            1303 05515000
*                                                                  1304 05516000
*   /*****************************************************************/ 05517000
*   /*                                                               */ 05518000
*   /* PROCEDURE NAME - SETCLRDF                             @Y30LB25*/ 05519000
*   /*                                                       @Y30LB25*/ 05520000
*   /* FUNCTION -                                            @Y30LB25*/ 05521000
*   /* SET AND THE CLEAR ERROR RECOVERY FLAGS                @Y30LB25*/ 05522000
*   /* FOR THE DEFINEV.                                      @Y30LB25*/ 05523000
*   /*                                                       @Y30LB25*/ 05524000
*   /* INPUT -                                               @Y30LB25*/ 05525000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 05526000
*   /* COPY OR BASE VOLUME RECORD                            @Y30LB25*/ 05527000
*   /*                                                       @Y30LB25*/ 05528000
*   /* OUTPUT -                                              @Y30LB25*/ 05529000
*   /* COPY OR BASE VOLUME RECORD                            @Y30LB25*/ 05530000
*   /*                                                               */ 05531000
*   /*****************************************************************/ 05532000
*                                                                  1304 05533000
*SETCLRDF:                                                         1304 05534000
*   PROC OPTIONS(NOSAVEAREA);       /*                       @ZDR2054*/ 05535000
*                                                                  1304 05536000
SETCLRDF STM   @14,@12,12(@13)                                     1304 05537000
*   /*****************************************************************/ 05538000
*   /*                                                               */ 05539000
*   /* SET ERROR RECOVERY FLAGS ON.                          @Y30LB25*/ 05540000
*   /*                                                               */ 05541000
*   /*****************************************************************/ 05542000
*                                                                  1305 05543000
*   IF DEFSRCVY=ON                  /* SET RECOVERY FLAGS    @Y30LB25*/ 05544000
*     THEN                          /* YES                   @Y30LB25*/ 05545000
         TM    DEFSRCVY(DEFVEPTR),B'10000000'                      1305 05546000
         BNO   @RF01305                                            1305 05547000
*     DO;                           /*                       @Y30LB25*/ 05548000
*       IF DEFICOPY=ON              /* INCOMP COPY?          @Y30LB25*/ 05549000
*         THEN                      /* YES                   @Y30LB25*/ 05550000
         TM    DEFICOPY(DEFVEPTR),B'10000000'                      1307 05551000
         BNO   @RF01307                                            1307 05552000
*         BCDIVCPY=ON;              /* SET FLAG              @Y30LB25*/ 05553000
         L     @06,BCDVPTR                                         1308 05554000
         OI    BCDIVCPY(@06),B'01000000'                           1308 05555000
*       IF DEFCREAT=ON              /* INCOMP CREATE?        @Y30LB25*/ 05556000
*         THEN                      /* YES                   @Y30LB25*/ 05557000
@RF01307 TM    DEFCREAT(DEFVEPTR),B'01000000'                      1309 05558000
         BNO   @RF01309                                            1309 05559000
*         BCDIVCRE=ON;              /* SET FLAG              @Y30LB25*/ 05560000
         L     @06,BCDVPTR                                         1310 05561000
         OI    BCDIVCRE(@06),B'10000000'                           1310 05562000
*       IF DEFLAMIS=ON              /* LABEL MISMATCH?       @Y30LB25*/ 05563000
*         THEN                      /* YES                   @Y30LB25*/ 05564000
@RF01309 TM    DEFLAMIS(DEFVEPTR),B'00100000'                      1311 05565000
         BNO   @RF01311                                            1311 05566000
*         DO;                       /*                       @Y30LB25*/ 05567000
*           BCDVSMIS=ON;            /* SET FLAG              @Y30LB25*/ 05568000
         L     @06,BCDVPTR                                         1313 05569000
         OI    BCDVSMIS(@06),B'00100000'                           1313 05570000
*           IF BCDBASE=ON           /* BVR?                  @Y30LB25*/ 05571000
*             THEN                  /* YES                   @Y30LB25*/ 05572000
         TM    BCDBASE(@06),B'00100000'                            1314 05573000
         BNO   @RF01314                                            1314 05574000
*             BASRECOV=DEFLABEL;    /*                       @Y30LB25   05575000
*                                      SET LABEL             @Y30LB25*/ 05576000
         L     @06,BASEVPTR                                        1315 05577000
         MVC   BASRECOV(6,@06),DEFLABEL(DEFVEPTR)                  1315 05578000
*         END;                      /*                       @Y30LB25*/ 05579000
@RF01314 DS    0H                                                  1317 05580000
*     END;                          /*                       @Y30LB25*/ 05581000
*                                                                  1317 05582000
@RF01311 DS    0H                                                  1318 05583000
*   /*****************************************************************/ 05584000
*   /*                                                               */ 05585000
*   /* SET ERROR RECOVERY FLAGS OFF (CLEAR).                 @Y30LB25*/ 05586000
*   /*                                                               */ 05587000
*   /*****************************************************************/ 05588000
*                                                                  1318 05589000
*   IF DEFCRCVY=ON                  /* CLEAR RECOVERY FLAGS          */ 05590000
*     THEN                          /* YES                   @Y30LB25*/ 05591000
@RF01305 TM    DEFCRCVY(DEFVEPTR),B'01000000'                      1318 05592000
         BNO   @RF01318                                            1318 05593000
*     DO;                           /*                       @Y30LB25*/ 05594000
*       IF DEFICOPY=ON              /* INCOMP COPY?          @Y30LB25*/ 05595000
*         THEN                      /* YES                   @Y30LB25*/ 05596000
         TM    DEFICOPY(DEFVEPTR),B'10000000'                      1320 05597000
         BNO   @RF01320                                            1320 05598000
*         BCDIVCPY=OFF;             /* CLR FLAG              @Y30LB25*/ 05599000
         L     @06,BCDVPTR                                         1321 05600000
         NI    BCDIVCPY(@06),B'10111111'                           1321 05601000
*       IF DEFCREAT=ON              /* INCOMP CREATE?        @Y30LB25*/ 05602000
*         THEN                      /* YES                   @Y30LB25*/ 05603000
@RF01320 TM    DEFCREAT(DEFVEPTR),B'01000000'                      1322 05604000
         BNO   @RF01322                                            1322 05605000
*         BCDIVCRE=OFF;             /* CLR FLAG              @Y30LB25*/ 05606000
         L     @06,BCDVPTR                                         1323 05607000
         NI    BCDIVCRE(@06),B'01111111'                           1323 05608000
*       IF DEFLAMIS=ON              /* LABEL MISMATCH?       @Y30LB25*/ 05609000
*         THEN                      /* YES                   @Y30LB25*/ 05610000
@RF01322 TM    DEFLAMIS(DEFVEPTR),B'00100000'                      1324 05611000
         BNO   @RF01324                                            1324 05612000
*         DO;                       /*                       @Y30LB25*/ 05613000
*           BCDVSMIS=OFF;           /* CLR FLAG              @Y30LB25*/ 05614000
         L     @06,BCDVPTR                                         1326 05615000
         NI    BCDVSMIS(@06),B'11011111'                           1326 05616000
*           IF BCDBASE=ON           /* BVR?                  @Y30LB25*/ 05617000
*             THEN                  /* YES                   @Y30LB25*/ 05618000
         TM    BCDBASE(@06),B'00100000'                            1327 05619000
         BNO   @RF01327                                            1327 05620000
*             BASRECOV=DEFLABEL;    /*                       @Y30LB25   05621000
*                                      CLR LABEL             @Y30LB25*/ 05622000
         L     @06,BASEVPTR                                        1328 05623000
         MVC   BASRECOV(6,@06),DEFLABEL(DEFVEPTR)                  1328 05624000
*         END;                      /*                       @Y30LB25*/ 05625000
*     END;                          /*                       @Y30LB25*/ 05626000
*   RETURN;                         /*                       @Y30LB25*/ 05627000
@EL00029 DS    0H                                                  1331 05628000
@EF00029 DS    0H                                                  1331 05629000
@ER00029 LM    @14,@12,12(@13)                                     1331 05630000
         BR    @14                                                 1331 05631000
*   END SETCLRDF;                   /*                       @Y30LB25*/ 05632000
         B     @EL00029                                            1332 05633000
*                                                                  1333 05634000
*   /*****************************************************************/ 05635000
*   /*                                                               */ 05636000
*   /* PROCEDURE NAME - SETCLRCV                             @Y30LB25*/ 05637000
*   /*                                                       @Y30LB25*/ 05638000
*   /* FUNCTION -                                            @Y30LB25*/ 05639000
*   /* SET AND THE CLEAR ERROR RECOVERY FLAGS                @Y30LB25*/ 05640000
*   /* FOR THE CVOL.                                         @Y30LB25*/ 05641000
*   /*                                                       @Y30LB25*/ 05642000
*   /* INPUT -                                               @Y30LB25*/ 05643000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 05644000
*   /* COPY OR BASE VOLUME RECORD                            @Y30LB25*/ 05645000
*   /*                                                       @Y30LB25*/ 05646000
*   /* OUTPUT -                                              @Y30LB25*/ 05647000
*   /* COPY OR BASE VOLUME RECORD                            @Y30LB25*/ 05648000
*   /*                                                               */ 05649000
*   /*****************************************************************/ 05650000
*                                                                  1333 05651000
*SETCLRCV:                                                         1333 05652000
*   PROC OPTIONS(NOSAVEAREA);       /*                       @ZDR2054*/ 05653000
*                                                                  1333 05654000
SETCLRCV STM   @14,@12,12(@13)                                     1333 05655000
*   /*****************************************************************/ 05656000
*   /*                                                               */ 05657000
*   /* SET ERROR RECOVERY FLAGS ON.                          @Y30LB25*/ 05658000
*   /*                                                               */ 05659000
*   /*****************************************************************/ 05660000
*                                                                  1334 05661000
*   IF COVSRCVY=ON                  /* SET RECOVERY FLAGS    @Y30LB25*/ 05662000
*     THEN                          /* YES                   @Y30LB25*/ 05663000
         L     @06,COVCEPTR                                        1334 05664000
         TM    COVSRCVY(@06),B'10000000'                           1334 05665000
         BNO   @RF01334                                            1334 05666000
*     DO;                           /*                       @Y30LB25*/ 05667000
*       IF COVICOPY=ON              /* INCOMP COPY?          @Y30LB25*/ 05668000
*         THEN                      /* YES                   @Y30LB25*/ 05669000
         TM    COVICOPY(@06),B'10000000'                           1336 05670000
         BNO   @RF01336                                            1336 05671000
*         BCDIVCPY=ON;              /* SET FLAG              @Y30LB25*/ 05672000
         L     @06,BCDVPTR                                         1337 05673000
         OI    BCDIVCPY(@06),B'01000000'                           1337 05674000
*       IF COVCREAT=ON              /* INCOMP CREATE?        @Y30LB25*/ 05675000
*         THEN                      /* YES                   @Y30LB25*/ 05676000
@RF01336 L     @06,COVCEPTR                                        1338 05677000
         TM    COVCREAT(@06),B'01000000'                           1338 05678000
         BNO   @RF01338                                            1338 05679000
*         BCDIVCRE=ON;              /* SET FLAG              @Y30LB25*/ 05680000
         L     @06,BCDVPTR                                         1339 05681000
         OI    BCDIVCRE(@06),B'10000000'                           1339 05682000
*       IF COVLAMIS=ON              /* LABEL MISMATCH?       @Y30LB25*/ 05683000
*         THEN                      /* YES                   @Y30LB25*/ 05684000
@RF01338 L     @06,COVCEPTR                                        1340 05685000
         TM    COVLAMIS(@06),B'00100000'                           1340 05686000
         BNO   @RF01340                                            1340 05687000
*         BCDVSMIS=ON;              /* SET FLAG              @Y30LB25*/ 05688000
         L     @06,BCDVPTR                                         1341 05689000
         OI    BCDVSMIS(@06),B'00100000'                           1341 05690000
*     END;                          /*                       @Y30LB25*/ 05691000
*                                                                  1342 05692000
@RF01340 DS    0H                                                  1343 05693000
*   /*****************************************************************/ 05694000
*   /*                                                               */ 05695000
*   /* SET ERROR RECOVERY FLAGS OFF (CLEAR).                 @Y30LB25*/ 05696000
*   /*                                                               */ 05697000
*   /*****************************************************************/ 05698000
*                                                                  1343 05699000
*   IF COVCRCVY=ON                  /* CLEAR RECOVERY FLAGS          */ 05700000
*     THEN                          /* YES                   @Y30LB25*/ 05701000
@RF01334 L     @06,COVCEPTR                                        1343 05702000
         TM    COVCRCVY(@06),B'01000000'                           1343 05703000
         BNO   @RF01343                                            1343 05704000
*     DO;                           /*                       @Y30LB25*/ 05705000
*       IF COVICOPY=ON              /* INCOMP COPY?          @Y30LB25*/ 05706000
*         THEN                      /* YES                   @Y30LB25*/ 05707000
         TM    COVICOPY(@06),B'10000000'                           1345 05708000
         BNO   @RF01345                                            1345 05709000
*         BCDIVCPY=OFF;             /* CLR FLAG              @Y30LB25*/ 05710000
         L     @06,BCDVPTR                                         1346 05711000
         NI    BCDIVCPY(@06),B'10111111'                           1346 05712000
*       IF COVCREAT=ON              /* INCOMP CREATE?        @Y30LB25*/ 05713000
*         THEN                      /* YES                   @Y30LB25*/ 05714000
@RF01345 L     @06,COVCEPTR                                        1347 05715000
         TM    COVCREAT(@06),B'01000000'                           1347 05716000
         BNO   @RF01347                                            1347 05717000
*         BCDIVCRE=OFF;             /* CLR FLAG              @Y30LB25*/ 05718000
         L     @06,BCDVPTR                                         1348 05719000
         NI    BCDIVCRE(@06),B'01111111'                           1348 05720000
*       IF COVLAMIS=ON              /* LABEL MISMATCH?       @Y30LB25*/ 05721000
*         THEN                      /* YES                   @Y30LB25*/ 05722000
@RF01347 L     @06,COVCEPTR                                        1349 05723000
         TM    COVLAMIS(@06),B'00100000'                           1349 05724000
         BNO   @RF01349                                            1349 05725000
*         BCDVSMIS=OFF;             /* CLR FLAG              @Y30LB25*/ 05726000
         L     @06,BCDVPTR                                         1350 05727000
         NI    BCDVSMIS(@06),B'11011111'                           1350 05728000
*     END;                          /*                       @Y30LB25*/ 05729000
*   RETURN;                         /*                       @Y30LB25*/ 05730000
@EL00030 DS    0H                                                  1352 05731000
@EF00030 DS    0H                                                  1352 05732000
@ER00030 LM    @14,@12,12(@13)                                     1352 05733000
         BR    @14                                                 1352 05734000
*   END SETCLRCV;                   /*                       @Y30LB25*/ 05735000
         B     @EL00030                                            1353 05736000
*                                                                  1354 05737000
*   /*****************************************************************/ 05738000
*   /*                                                               */ 05739000
*   /* PROCEDURE NAME - REPVFLG1                             @Y30LB25*/ 05740000
*   /*                                                       @Y30LB25*/ 05741000
*   /* FUNCTION -                                            @Y30LB25*/ 05742000
*   /* REPLACE VOLUME FLAGS PROCESSING BEFORE THE MSC        @Y30LB25*/ 05743000
*   /* IS CALLED.                                            @Y30LB25*/ 05744000
*   /*                                                       @Y30LB25*/ 05745000
*   /* INPUT -                                               @Y30LB25*/ 05746000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 05747000
*   /*                                                       @Y30LB25*/ 05748000
*   /* OUTPUT -                                              @Y30LB25*/ 05749000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 05750000
*   /* AN ERROR                                              @Y30LB25*/ 05751000
*   /*                                                               */ 05752000
*   /*****************************************************************/ 05753000
*                                                                  1354 05754000
*REPVFLG1:                                                         1354 05755000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 05756000
*                                                                  1354 05757000
REPVFLG1 ST    @14,@SA00031                                        1354 05758000
*   /*****************************************************************/ 05759000
*   /*                                                               */ 05760000
*   /* RESERVE .MSVI.                                        @Y30LB25*/ 05761000
*   /*                                                               */ 05762000
*   /*****************************************************************/ 05763000
*                                                                  1355 05764000
*   CALL RMSVIS;                    /* RESERVE .MSVI         @Y30LB25*/ 05765000
*                                                                  1355 05766000
         BAL   @14,RMSVIS                                          1355 05767000
*   /*****************************************************************/ 05768000
*   /*                                                               */ 05769000
*   /* IF NECESSARY, INSURE A GROUP EXISTS                   @VS32198*/ 05770000
*   /*                                                               */ 05771000
*   /*****************************************************************/ 05772000
*                                                                  1356 05773000
*   IF DEFVVEXT^=FIXZERO&DEFPGRO=ON /* GROUP SPECIFIED?      @ZA28871*/ 05774000
*     THEN                          /* YES                   @VS32198*/ 05775000
         L     @06,DEFVVEXT(,DEFVPTR)                              1356 05776000
         LTR   @06,@06                                             1356 05777000
         BZ    @RF01356                                            1356 05778000
         TM    DEFPGRO(DEFVEPTR),B'00100000'                       1356 05779000
         BNO   @RF01356                                            1356 05780000
*     DO;                           /*                       @VS32198*/ 05781000
*       GROUPKY=DEFGROUP;           /* SET GROUP NAME        @VS32198*/ 05782000
         MVC   GROUPKY(8),DEFGROUP(DEFVEPTR)                       1358 05783000
*       RPLVKEY=ADDR(GKEY);         /* SET KEY               @VS32198*/ 05784000
         LA    @06,GKEY                                            1359 05785000
         L     @01,RPLVPTR                                         1359 05786000
         ST    @06,RPLVKEY(,@01)                                   1359 05787000
*       CALL READLOC;               /* GET GVR               @VS32198*/ 05788000
         BAL   @14,READLOC                                         1360 05789000
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @VS32198*/ 05790000
*         THEN                      /* YES                   @VS32198*/ 05791000
         L     @06,RPLVPTR                                         1361 05792000
         LH    @15,RPLVRETC(,@06)                                  1361 05793000
         N     @15,@CF01129                                        1361 05794000
         LTR   @15,@15                                             1361 05795000
         BZ    @RF01361                                            1361 05796000
*         DO;                       /*                       @VS32198*/ 05797000
*           IF RPLRCODE=NORECFND    /* NONE FOUND?           @VS32198*/ 05798000
*             THEN                  /* RIGHT                 @VS32198*/ 05799000
         CLC   RPLRCODE(2,@06),@CB00711                            1363 05800000
         BNE   @RF01363                                            1363 05801000
*             RPLRCODE=NOGRPFND;    /*                       @VS32198   05802000
*                                      NO GROUP FND          @VS32198*/ 05803000
         MVC   RPLRCODE(2,@06),@CB00707                            1364 05804000
*           RETURN;                 /*                       @VS32198*/ 05805000
@EL00031 DS    0H                                                  1365 05806000
@EF00031 DS    0H                                                  1365 05807000
@ER00031 L     @14,@SA00031                                        1365 05808000
         BR    @14                                                 1365 05809000
*         END;                      /*                       @VS32198*/ 05810000
*     END;                          /*                       @VS32198*/ 05811000
*                                                                  1367 05812000
@RF01361 DS    0H                                                  1368 05813000
*   /*****************************************************************/ 05814000
*   /*                                                               */ 05815000
*   /* GET THE VOLUME                                        #Y30LB25*/ 05816000
*   /*                                                               */ 05817000
*   /*****************************************************************/ 05818000
*                                                                  1368 05819000
*   BVOLKY=DEFVOLD;                 /* SET VOLID             #Y30LB25*/ 05820000
@RF01356 MVC   BVOLKY(6),DEFVOLD(DEFVPTR)                          1368 05821000
*   RPLVKEY=ADDR(BKEY);             /* SET KEY ADDR          #Y30LB25*/ 05822000
         LA    @06,BKEY                                            1369 05823000
         L     @01,RPLVPTR                                         1369 05824000
         ST    @06,RPLVKEY(,@01)                                   1369 05825000
*   CALL READLOC;                   /* READ BVR              #Y30LB25*/ 05826000
         BAL   @14,READLOC                                         1370 05827000
*   IF RPLVRETC^=FIXZERO            /* ERROR?                #Y30LB25*/ 05828000
*     THEN                          /* YES                   @Y30LB25*/ 05829000
         L     @06,RPLVPTR                                         1371 05830000
         LH    @15,RPLVRETC(,@06)                                  1371 05831000
         N     @15,@CF01129                                        1371 05832000
         LTR   @15,@15                                             1371 05833000
         BNZ   @RT01371                                            1371 05834000
*     RETURN;                       /*                       @Y30LB25*/ 05835000
*   BASEBUF=BUFFER;                 /* SAVE BVR IN CASE      @Y30LB25   05836000
*                                      GVR IS READ           @Y30LB25*/ 05837000
*                                                                  1373 05838000
         L     @06,RPLVBUF(,@06)                                   1373 05839000
         MVC   BASEBUF(224),BUFFER(@06)                            1373 05840000
*   /*****************************************************************/ 05841000
*   /*                                                               */ 05842000
*   /* CHECK FOR VALID 'TO' OR 'FOR' EXPIRATION DATE.        @Y30LB25*/ 05843000
*   /*                                                               */ 05844000
*   /*****************************************************************/ 05845000
*                                                                  1374 05846000
*   CALL EXPCK;                     /* CK EXPIR DATE         @Y30LB25*/ 05847000
         BAL   @14,EXPCK                                           1374 05848000
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/ 05849000
*     THEN                          /* YES                   @Y30LB25*/ 05850000
         L     @06,RPLVPTR                                         1375 05851000
         LH    @06,RPLVRETC(,@06)                                  1375 05852000
         N     @06,@CF01129                                        1375 05853000
         LTR   @06,@06                                             1375 05854000
         BNZ   @RT01375                                            1375 05855000
*     RETURN;                       /*                       @Y30LB25*/ 05856000
*                                                                  1376 05857000
*   /*****************************************************************/ 05858000
*   /*                                                               */ 05859000
*   /* CHECK ATTRIBUTES IF NECESSARY.                        @Y30LB25*/ 05860000
*   /*                                                               */ 05861000
*   /*****************************************************************/ 05862000
*                                                                  1377 05863000
*   CALL CKATTRIB;                  /* CK ATTRIBUTES         @Y30LB25*/ 05864000
         BAL   @14,CKATTRIB                                        1377 05865000
*   RETURN;                         /*                       @Y30LB25*/ 05866000
         B     @EL00031                                            1378 05867000
*   END REPVFLG1;                   /*                       @Y30LB25*/ 05868000
         B     @EL00031                                            1379 05869000
*                                                                  1380 05870000
*   /*****************************************************************/ 05871000
*   /*                                                               */ 05872000
*   /* PROCEDURE NAME - REPVFLG2                             @Y30LB25*/ 05873000
*   /*                                                       @Y30LB25*/ 05874000
*   /* FUNCTION -                                            @Y30LB25*/ 05875000
*   /* REPLACE VOLUME FLAGS PROCESSING AFTER THE MSC         @Y30LB25*/ 05876000
*   /* WAS CALLED.                                           @Y30LB25*/ 05877000
*   /*                                                       @Y30LB25*/ 05878000
*   /* INPUT -                                               @Y30LB25*/ 05879000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 05880000
*   /*                                                       @Y30LB25*/ 05881000
*   /* OUTPUT -                                              @Y30LB25*/ 05882000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 05883000
*   /* AN ERROR                                              @Y30LB25*/ 05884000
*   /*                                                               */ 05885000
*   /*****************************************************************/ 05886000
*                                                                  1380 05887000
*REPVFLG2:                          /*                       @Y30LB25*/ 05888000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 05889000
REPVFLG2 ST    @14,@SA00032                                        1380 05890000
*   IF RPLRCODE^=FIXZERO            /* MSC ERROR?            @Y30LB25*/ 05891000
*     THEN                          /* YES                   @Y30LB25*/ 05892000
         L     @06,RPLVPTR                                         1381 05893000
         LH    @15,RPLRCODE(,@06)                                  1381 05894000
         N     @15,@CF01129                                        1381 05895000
         LTR   @15,@15                                             1381 05896000
         BZ    @RF01381                                            1381 05897000
*     DO;                           /*                       @Y30LB25*/ 05898000
*       RPLVRETC=RPLVRETC&&RPLVRETC;/* ZERO RETN CODE        @Y30LB25*/ 05899000
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       1383 05900000
*       RPLRCODE=RPLRCODE&&RPLRCODE;/* ZERO RESN CODE        @Y30LB25*/ 05901000
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       1384 05902000
*       RETURN;                     /*                       @Y30LB25*/ 05903000
@EL00032 DS    0H                                                  1385 05904000
@EF00032 DS    0H                                                  1385 05905000
@ER00032 L     @14,@SA00032                                        1385 05906000
         BR    @14                                                 1385 05907000
*     END;                          /*                       @Y30LB25*/ 05908000
*   CALL HOUSKEEP;                  /* JRNL RPLV &           #Y30LB25   05909000
*                                      RESERVE .MSVI         #Y30LB25*/ 05910000
*                                                                  1387 05911000
@RF01381 BAL   @14,HOUSKEEP                                        1387 05912000
*   /*****************************************************************/ 05913000
*   /*                                                               */ 05914000
*   /* GET THE VOLUME RECORD                                 @Y30LB25*/ 05915000
*   /*                                                               */ 05916000
*   /*****************************************************************/ 05917000
*                                                                  1388 05918000
*   BVOLKY=DEFVOLD;                 /* SET VOLID             @Y30LB25*/ 05919000
         MVC   BVOLKY(6),DEFVOLD(DEFVPTR)                          1388 05920000
*   RPLVKEY=ADDR(BKEY);             /* SET KEY ADDR          @Y30LB25*/ 05921000
         LA    @06,BKEY                                            1389 05922000
         L     @01,RPLVPTR                                         1389 05923000
         ST    @06,RPLVKEY(,@01)                                   1389 05924000
*   CALL READUPD1;                  /* GET RECORD            @Y30LB25*/ 05925000
         BAL   @14,READUPD1                                        1390 05926000
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/ 05927000
*     THEN                          /* YES                   @Y30LB25*/ 05928000
         L     @06,RPLVPTR                                         1391 05929000
         LH    @06,RPLVRETC(,@06)                                  1391 05930000
         N     @06,@CF01129                                        1391 05931000
         LTR   @06,@06                                             1391 05932000
         BNZ   @RT01391                                            1391 05933000
*     RETURN;                       /*                       @Y30LB25*/ 05934000
*   BASEBUF=BASEBUF1;               /* USE CORRECT BUF       @Y30LB25*/ 05935000
*                                                                  1393 05936000
         MVC   BASEBUF(224),BASEBUF1                               1393 05937000
*   /*****************************************************************/ 05938000
*   /*                                                               */ 05939000
*   /* UPDATE BVR EXCLUSIVE ATTRIBUTE                        @Y30LB25*/ 05940000
*   /*                                                               */ 05941000
*   /*****************************************************************/ 05942000
*                                                                  1394 05943000
*   IF DEFVEXCL=ON                  /* EXCL ON?              @Y30LB25*/ 05944000
*     THEN                          /* YES                   @Y30LB25*/ 05945000
         TM    DEFVEXCL(DEFVPTR),B'00010000'                       1394 05946000
         BNO   @RF01394                                            1394 05947000
*     BASEXCL=ON;                   /* SET ON                @Y30LB25*/ 05948000
         L     @06,BASEVPTR                                        1395 05949000
         OI    BASEXCL(@06),B'00000001'                            1395 05950000
*   ELSE                            /* EXCL IS OFF           @Y30LB25*/ 05951000
*     BASEXCL=OFF;                  /* SET OFF               @Y30LB25*/ 05952000
*                                                                  1396 05953000
         B     @RC01394                                            1396 05954000
@RF01394 L     @06,BASEVPTR                                        1396 05955000
         NI    BASEXCL(@06),B'11111110'                            1396 05956000
*   /*****************************************************************/ 05957000
*   /*                                                               */ 05958000
*   /* UPDATE BVR BIND ATTRIBUTE                             @Y30LB25*/ 05959000
*   /*                                                               */ 05960000
*   /*****************************************************************/ 05961000
*                                                                  1397 05962000
*   IF DEFVBIND=ON                  /* BIND ON?              @Y30LB25*/ 05963000
*     THEN                          /* YES                   @Y30LB25*/ 05964000
@RC01394 TM    DEFVBIND(DEFVPTR),B'00000100'                       1397 05965000
         BNO   @RF01397                                            1397 05966000
*     BASBIND=ON;                   /* SET ON                @Y30LB25*/ 05967000
         L     @06,BASEVPTR                                        1398 05968000
         OI    BASBIND(@06),B'00000010'                            1398 05969000
*   ELSE                            /* BIND IS OFF           @Y30LB25*/ 05970000
*     BASBIND=OFF;                  /* SET OFF               @Y30LB25*/ 05971000
*                                                                  1399 05972000
         B     @RC01397                                            1399 05973000
@RF01397 L     @06,BASEVPTR                                        1399 05974000
         NI    BASBIND(@06),B'11111101'                            1399 05975000
*   /*****************************************************************/ 05976000
*   /*                                                               */ 05977000
*   /* UPDATE DASD ERASE ATTRIBUTE                           @Y30LB25*/ 05978000
*   /*                                                               */ 05979000
*   /*****************************************************************/ 05980000
*                                                                  1400 05981000
*   IF DEFVSEC=ON                   /* SECURE ON?            @Y30LB25*/ 05982000
*     THEN                          /* YES                   @Y30LB25*/ 05983000
@RC01397 TM    DEFVSEC(DEFVPTR),B'00100000'                        1400 05984000
         BNO   @RF01400                                            1400 05985000
*     BASDAERA=ON;                  /* SET ON                @Y30LB25*/ 05986000
         L     @06,BASEVPTR                                        1401 05987000
         OI    BASDAERA(@06),B'10000000'                           1401 05988000
*   ELSE                            /* SECURE IS OFF         @Y30LB25*/ 05989000
*     BASDAERA=OFF;                 /* SET OFF               @Y30LB25*/ 05990000
*                                                                  1402 05991000
         B     @RC01400                                            1402 05992000
@RF01400 L     @06,BASEVPTR                                        1402 05993000
         NI    BASDAERA(@06),B'01111111'                           1402 05994000
*   /*****************************************************************/ 05995000
*   /*                                                               */ 05996000
*   /* UPDATE BVR READ ONLY ATTRIBUTE                        @Y30LB25*/ 05997000
*   /*                                                               */ 05998000
*   /*****************************************************************/ 05999000
*                                                                  1403 06000000
*   IF DEFVWINH=ON                  /* READ ONLY?            @Y30LB25*/ 06001000
*     THEN                          /* YES                   @Y30LB25*/ 06002000
@RC01400 TM    DEFVWINH(DEFVPTR),B'00000010'                       1403 06003000
         BNO   @RF01403                                            1403 06004000
*     BASRONLY=ON;                  /* SET ON                @Y30LB25*/ 06005000
         L     @06,BASEVPTR                                        1404 06006000
         OI    BASRONLY(@06),B'01000000'                           1404 06007000
*   ELSE                            /* READ ONLY IS OFF      @Y30LB25*/ 06008000
*     BASRONLY=OFF;                 /* SET OFF               @Y30LB25*/ 06009000
*                                                                  1405 06010000
         B     @RC01403                                            1405 06011000
@RF01403 L     @06,BASEVPTR                                        1405 06012000
         NI    BASRONLY(@06),B'10111111'                           1405 06013000
*   /*****************************************************************/ 06014000
*   /*                                                               */ 06015000
*   /* CHECK FOR DEVFE TO BE PROCESSED                       @Y30LB25*/ 06016000
*   /*                                                               */ 06017000
*   /*****************************************************************/ 06018000
*                                                                  1406 06019000
*   IF DEFVVEXT^=FIXZERO            /* DEFVE?                @Y30LB25*/ 06020000
*     THEN                          /* YES                   @Y30LB25*/ 06021000
@RC01403 L     @06,DEFVVEXT(,DEFVPTR)                              1406 06022000
         LTR   @06,@06                                             1406 06023000
         BZ    @RF01406                                            1406 06024000
*     DO;                           /*                       @Y30LB25*/ 06025000
*       BCDVPTR=BASEVPTR;           /* SET BVR PTR           @Y30LB25*/ 06026000
         L     @06,BASEVPTR                                        1408 06027000
         ST    @06,BCDVPTR                                         1408 06028000
*       CALL PRODEFVE;              /* PROCESS DEFVE         @Y30LB25*/ 06029000
         BAL   @14,PRODEFVE                                        1409 06030000
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/ 06031000
*         THEN                      /* YES                   @Y30LB25*/ 06032000
         L     @06,RPLVPTR                                         1410 06033000
         LH    @15,RPLVRETC(,@06)                                  1410 06034000
         N     @15,@CF01129                                        1410 06035000
         LTR   @15,@15                                             1410 06036000
         BNZ   @RT01410                                            1410 06037000
*         RETURN;                   /*                       @Y30LB25*/ 06038000
*                                                                  1411 06039000
*       /*************************************************************/ 06040000
*       /*                                                           */ 06041000
*       /* REESTABLISH BVR'S RPLV                            @Y30LB25*/ 06042000
*       /*                                                           */ 06043000
*       /*************************************************************/ 06044000
*                                                                  1412 06045000
*       BVOLKY=BASSERNO;            /* RESET VOLID           @Y30LB25*/ 06046000
         L     @01,BASEVPTR                                        1412 06047000
         MVC   BVOLKY(6),BASSERNO(@01)                             1412 06048000
*       RPLVKEY=ADDR(BKEY);         /* SET KEY ADDR          @Y30LB25*/ 06049000
         LA    @15,BKEY                                            1413 06050000
         ST    @15,RPLVKEY(,@06)                                   1413 06051000
*       CALL READUPD1;              /* READ BVR              @Y30LB25*/ 06052000
         BAL   @14,READUPD1                                        1414 06053000
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/ 06054000
*         THEN                      /* YES                   @Y30LB25*/ 06055000
         L     @06,RPLVPTR                                         1415 06056000
         LH    @06,RPLVRETC(,@06)                                  1415 06057000
         N     @06,@CF01129                                        1415 06058000
         LTR   @06,@06                                             1415 06059000
         BNZ   @RT01415                                            1415 06060000
*         RETURN;                   /*                       @Y30LB25*/ 06061000
*     END;                          /*                       @Y30LB25*/ 06062000
*   RPLVBUF=ADDR(BASEBUF);          /* ADDR OF BVR BUF       @Y30LB25*/ 06063000
@RF01406 LA    @06,BASEBUF                                         1418 06064000
         L     @01,RPLVPTR                                         1418 06065000
         ST    @06,RPLVBUF(,@01)                                   1418 06066000
*   CALL WRITRECD;                  /* WRITE BVR             @Y30LB25*/ 06067000
         BAL   @14,WRITRECD                                        1419 06068000
*   RETURN;                         /*                       @Y30LB25*/ 06069000
         B     @EL00032                                            1420 06070000
*   END REPVFLG2;                   /*                       @Y30LB25*/ 06071000
         B     @EL00032                                            1421 06072000
*                                                                  1422 06073000
*   /*****************************************************************/ 06074000
*   /*                                                               */ 06075000
*   /* PROCEDURE NAME - CRTINCV1                             @Y30LB25*/ 06076000
*   /*                                                       @Y30LB25*/ 06077000
*   /* FUNCTION -                                            @Y30LB25*/ 06078000
*   /* PROCESS THE CREATION OF AN INACTIVE VOLUME BEFORE     @Y30LB25*/ 06079000
*   /* THE MSC IS CALLED.                                    @Y30LB25*/ 06080000
*   /* AN ICBDEFV EXTENSION IS REQUIRED.                     @Y30LB25*/ 06081000
*   /* ONE IS NOT SUPPLIED THOUGH DURING USER TASK RECOVERY  @Y30LB25*/ 06082000
*   /*                                                       @Y30LB25*/ 06083000
*   /* INPUT -                                               @Y30LB25*/ 06084000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 06085000
*   /*                                                       @Y30LB25*/ 06086000
*   /* OUTPUT -                                              @Y30LB25*/ 06087000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 06088000
*   /* AN ERROR                                              @Y30LB25*/ 06089000
*   /*                                                               */ 06090000
*   /*****************************************************************/ 06091000
*                                                                  1422 06092000
*CRTINCV1:                          /*                       @Y30LB25*/ 06093000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 06094000
*                                                                  1422 06095000
CRTINCV1 ST    @14,@SA00033                                        1422 06096000
*   /*****************************************************************/ 06097000
*   /*                                                               */ 06098000
*   /* RESERVE .MSVI.                                        @Y30LB25*/ 06099000
*   /*                                                               */ 06100000
*   /*****************************************************************/ 06101000
*                                                                  1423 06102000
*   CALL RMSVI;                     /* RESERVE .MSVI         @Y30LB25*/ 06103000
*                                                                  1423 06104000
         BAL   @14,RMSVI                                           1423 06105000
*   /*****************************************************************/ 06106000
*   /*                                                               */ 06107000
*   /* IF NECESSARY, INSURE A GROUP EXISTS                   @VS32198*/ 06108000
*   /*                                                               */ 06109000
*   /*****************************************************************/ 06110000
*                                                                  1424 06111000
*   IF DEFPGRO=ON&DEFVVEXT^=FIXZERO /* GROUP SPECIFIED?      @VS34305*/ 06112000
*     THEN                          /* YES                   @VS32198*/ 06113000
         TM    DEFPGRO(DEFVEPTR),B'00100000'                       1424 06114000
         BNO   @RF01424                                            1424 06115000
         L     @06,DEFVVEXT(,DEFVPTR)                              1424 06116000
         LTR   @06,@06                                             1424 06117000
         BZ    @RF01424                                            1424 06118000
*     DO;                           /*                       @VS32198*/ 06119000
*       GROUPKY=DEFGROUP;           /* SET GROUP NAME        @VS32198*/ 06120000
         MVC   GROUPKY(8),DEFGROUP(DEFVEPTR)                       1426 06121000
*       RPLVKEY=ADDR(GKEY);         /* SET KEY               @VS32198*/ 06122000
         LA    @06,GKEY                                            1427 06123000
         L     @01,RPLVPTR                                         1427 06124000
         ST    @06,RPLVKEY(,@01)                                   1427 06125000
*       CALL READLOC;               /* GET GVR               @VS32198*/ 06126000
         BAL   @14,READLOC                                         1428 06127000
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @VS32198*/ 06128000
*         THEN                      /* YES                   @VS32198*/ 06129000
         L     @06,RPLVPTR                                         1429 06130000
         LH    @15,RPLVRETC(,@06)                                  1429 06131000
         N     @15,@CF01129                                        1429 06132000
         LTR   @15,@15                                             1429 06133000
         BZ    @RF01429                                            1429 06134000
*         DO;                       /*                       @VS32198*/ 06135000
*           IF RPLRCODE=NORECFND    /* NONE FOUND?           @VS32198*/ 06136000
*             THEN                  /* RIGHT                 @VS32198*/ 06137000
         CLC   RPLRCODE(2,@06),@CB00711                            1431 06138000
         BNE   @RF01431                                            1431 06139000
*             RPLRCODE=NOGRPFND;    /*                       @VS32198   06140000
*                                      NO GROUP FND          @VS32198*/ 06141000
         MVC   RPLRCODE(2,@06),@CB00707                            1432 06142000
*           RETURN;                 /*                       @VS32198*/ 06143000
@EL00033 DS    0H                                                  1433 06144000
@EF00033 DS    0H                                                  1433 06145000
@ER00033 L     @14,@SA00033                                        1433 06146000
         BR    @14                                                 1433 06147000
*         END;                      /*                       @VS32198*/ 06148000
*     END;                          /*                       @VS32198*/ 06149000
*                                                                  1435 06150000
@RF01429 DS    0H                                                  1436 06151000
*   /*****************************************************************/ 06152000
*   /*                                                               */ 06153000
*   /* CHECK FOR CREATE A COPY VOLUME RECORD                 #Y30LB25*/ 06154000
*   /*                                                               */ 06155000
*   /*****************************************************************/ 06156000
*                                                                  1436 06157000
*   IF DEFVVEXT^=FIXZERO&DEFCOPY=ON /* CREATE A CVR?         #Y30LB25*/ 06158000
*     THEN                          /* YES                   #Y30LB25*/ 06159000
@RF01424 L     @06,DEFVVEXT(,DEFVPTR)                              1436 06160000
         LTR   @06,@06                                             1436 06161000
         BZ    @RF01436                                            1436 06162000
         TM    DEFCOPY(DEFVEPTR),B'00010000'                       1436 06163000
         BNO   @RF01436                                            1436 06164000
*     DO;                           /*                       @Y30LB25*/ 06165000
*                                                                  1437 06166000
*       /*************************************************************/ 06167000
*       /*                                                           */ 06168000
*       /* GET CVR'S BVR                                     @Y30LB25*/ 06169000
*       /*                                                           */ 06170000
*       /*************************************************************/ 06171000
*                                                                  1438 06172000
*       BVOLKY=DEFVOLD;             /* SET VOLID             @Y30LB25*/ 06173000
         MVC   BVOLKY(6),DEFVOLD(DEFVPTR)                          1438 06174000
*       RPLVKEY=ADDR(BKEY);         /* SET KEY ADDR          @Y30LB25*/ 06175000
         LA    @06,BKEY                                            1439 06176000
         L     @05,RPLVPTR                                         1439 06177000
         ST    @06,RPLVKEY(,@05)                                   1439 06178000
*       CALL READLOC;               /* READ BVR              @Y30LB25*/ 06179000
         BAL   @14,READLOC                                         1440 06180000
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/ 06181000
*         THEN                      /* YES                   @Y30LB25*/ 06182000
         L     @06,RPLVPTR                                         1441 06183000
         LH    @05,RPLVRETC(,@06)                                  1441 06184000
         N     @05,@CF01129                                        1441 06185000
         LTR   @05,@05                                             1441 06186000
         BNZ   @RT01441                                            1441 06187000
*         RETURN;                   /*                       @Y30LB25*/ 06188000
*       BASEBUF=BUFFER;             /* SAVE BVR IN CASE      @Y30LB25   06189000
*                                      CVR IS READ           @Y30LB25*/ 06190000
*                                                                  1443 06191000
         L     @05,RPLVBUF(,@06)                                   1443 06192000
         MVC   BASEBUF(224),BUFFER(@05)                            1443 06193000
*       /*************************************************************/ 06194000
*       /*                                                           */ 06195000
*       /* CHECK IF COPIES ARE ALLOWED                       @Y30LB25*/ 06196000
*       /*                                                           */ 06197000
*       /*************************************************************/ 06198000
*                                                                  1444 06199000
*       IF BASNOCPY=ON              /* COPIES ALLOWED?       @Y30LB25*/ 06200000
*         THEN                      /* NO                    @Y30LB25*/ 06201000
         L     @05,BASEVPTR                                        1444 06202000
         TM    BASNOCPY(@05),B'01000000'                           1444 06203000
         BNO   @RF01444                                            1444 06204000
*         DO;                       /*                       @Y30LB25*/ 06205000
*           RPLVRETC=FIXFOUR;       /* ERROR RETURN CODE     @Y30LB25*/ 06206000
         MVC   RPLVRETC(2,@06),@CH00041                            1446 06207000
*           RPLRCODE=NOCPYBVR;      /* ERROR REASON CODE     @Y30LB25*/ 06208000
         MVC   RPLRCODE(2,@06),@CB00721                            1447 06209000
*         END;                      /*                       @Y30LB25*/ 06210000
*                                                                  1448 06211000
*       /*************************************************************/ 06212000
*       /*                                                           */ 06213000
*       /* CREATE A PLACE HOLDER CVR                         @Y30LB25*/ 06214000
*       /*                                                           */ 06215000
*       /*************************************************************/ 06216000
*                                                                  1449 06217000
*       CALL CRTCVR1;               /* CREATE PLACE HOLD     @Y30LB25*/ 06218000
@RF01444 BAL   @14,CRTCVR1                                         1449 06219000
*       RETURN;                     /*                       @Y30LB25*/ 06220000
         B     @EL00033                                            1450 06221000
*     END;                          /*                       @Y30LB25*/ 06222000
*                                                                  1451 06223000
*   /*****************************************************************/ 06224000
*   /*                                                               */ 06225000
*   /* CHECK ATTRIBUTES, IF NECESSARY.                       @Y30LB25*/ 06226000
*   /* CKATTRIB WILL ONLY CHECK IF THE VOLUME IS TO          @Y30LB25*/ 06227000
*   /* BE GROUPED.                                           @Y30LB25*/ 06228000
*   /*                                                               */ 06229000
*   /*****************************************************************/ 06230000
*                                                                  1452 06231000
*   BASGENUS=OFF;                   /* NO GEN-USE            @Y30LB25*/ 06232000
@RF01436 DS    0H                                                  1453 06233000
*   BASGRPV=OFF;                    /* NOT GROUPED           @Y30LB25*/ 06234000
         L     @06,BASEVPTR                                        1453 06235000
         NI    BASGENUS(@06),B'11001111'                           1453 06236000
*   CALL CKATTRIB;                  /* CK ATTRIBUTES         @Y30LB25*/ 06237000
         BAL   @14,CKATTRIB                                        1454 06238000
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/ 06239000
*     THEN                          /* YES                   @Y30LB25*/ 06240000
         L     @06,RPLVPTR                                         1455 06241000
         LH    @06,RPLVRETC(,@06)                                  1455 06242000
         N     @06,@CF01129                                        1455 06243000
         LTR   @06,@06                                             1455 06244000
         BNZ   @RT01455                                            1455 06245000
*     RETURN;                       /*                       @Y30LB25*/ 06246000
*                                                                  1456 06247000
*   /*****************************************************************/ 06248000
*   /*                                                               */ 06249000
*   /* CREATE AND WRITE A PLACE HOLDER BASE VOLUME RECORD    @Y30LB25*/ 06250000
*   /*                                                               */ 06251000
*   /*****************************************************************/ 06252000
*                                                                  1457 06253000
*   BVOLKY=DEFVOLD;                 /* SET KEY               @Y30LB25*/ 06254000
         MVC   BVOLKY(6),DEFVOLD(DEFVPTR)                          1457 06255000
*   CALL CRTPHOLD;                  /* CREATE BVR PLACE      @Y30LB25   06256000
*                                      HOLDER                @Y30LB25*/ 06257000
         BAL   @14,CRTPHOLD                                        1458 06258000
*   RETURN;                         /*                       @Y30LB25*/ 06259000
         B     @EL00033                                            1459 06260000
*   END CRTINCV1;                   /*                       @Y30LB25*/ 06261000
         B     @EL00033                                            1460 06262000
*                                                                  1461 06263000
*   /*****************************************************************/ 06264000
*   /*                                                               */ 06265000
*   /* PROCEDURE NAME - READLOC                              @Y30LB25*/ 06266000
*   /*                                                       @Y30LB25*/ 06267000
*   /* FUNCTION -                                            @Y30LB25*/ 06268000
*   /* READ AN MSVC RECORD IN THE LOCATE MODE.               @Y30LB25*/ 06269000
*   /*                                                       @Y30LB25*/ 06270000
*   /* INPUT -                                               @Y30LB25*/ 06271000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 06272000
*   /* ADDRESS OF THE KEY TO READ IN RPLVKEY                 @Y30LB25*/ 06273000
*   /*                                                       @Y30LB25*/ 06274000
*   /* OUTPUT -                                              @Y30LB25*/ 06275000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 06276000
*   /* AN ERROR                                              @Y30LB25*/ 06277000
*   /*                                                               */ 06278000
*   /*****************************************************************/ 06279000
*                                                                  1461 06280000
*READLOC:                           /*                       @Y30LB25*/ 06281000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 06282000
READLOC  ST    @14,@SA00034                                        1461 06283000
*   RPLVTYP=RPLVREAD;               /* READ                  @Y30LB25*/ 06284000
         L     @06,RPLVPTR                                         1462 06285000
         MVI   RPLVTYP(@06),X'00'                                  1462 06286000
*   RPLVLOC=ON;                     /* LOCATE                @Y30LB25*/ 06287000
*   RPLVDIR=ON;                     /* DIRECT                @Y30LB25*/ 06288000
         OI    RPLVLOC(@06),B'11000000'                            1464 06289000
*   RPLVUPD=OFF;                    /* NO UPDATE             @Y30LB25*/ 06290000
         NI    RPLVUPD(@06),B'11111101'                            1465 06291000
*   RESPECIFY                                                      1466 06292000
*     RG1 RSTD;                     /* RESTRICT REG 1        @Y30LB25*/ 06293000
*   RG1=RPLVPTR;                    /* SET RPLV PTR          @Y30LB25*/ 06294000
         LR    RG1,@06                                             1467 06295000
*   CALL ICBVIO00;                  /* READ RECORD           @Y30LB25*/ 06296000
         L     @15,@CV00762                                        1468 06297000
         BALR  @14,@15                                             1468 06298000
*   RESPECIFY                                                      1469 06299000
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @Y30LB25*/ 06300000
*   RETURN;                         /*                       @Y30LB25*/ 06301000
@EL00034 DS    0H                                                  1470 06302000
@EF00034 DS    0H                                                  1470 06303000
@ER00034 L     @14,@SA00034                                        1470 06304000
         BR    @14                                                 1470 06305000
*   END READLOC;                    /*                       @Y30LB25*/ 06306000
*                                                                  1472 06307000
*   /*****************************************************************/ 06308000
*   /*                                                               */ 06309000
*   /* PROCEDURE NAME - CRTPHOLD                             @Y30LB25*/ 06310000
*   /*                                                       @Y30LB25*/ 06311000
*   /* FUNCTION -                                            @Y30LB25*/ 06312000
*   /* CREATE AND WRITE A PLACE HOLDER BVR.                  @Y30LB25*/ 06313000
*   /*                                                       @Y30LB25*/ 06314000
*   /* INPUT -                                               @Y30LB25*/ 06315000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 06316000
*   /* BKEY                                                  @Y30LB25*/ 06317000
*   /*                                                       @Y30LB25*/ 06318000
*   /* OUTPUT -                                              @Y30LB25*/ 06319000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 06320000
*   /* AN ERROR                                              @Y30LB25*/ 06321000
*   /*                                                               */ 06322000
*   /*****************************************************************/ 06323000
*                                                                  1472 06324000
*CRTPHOLD:                          /*                       @Y30LB25*/ 06325000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 06326000
CRTPHOLD ST    @14,@SA00035                                        1472 06327000
*   BASEBUF=BASEBUF&&BASEBUF;       /* CLEAR BVR BUF         @Y30LB25*/ 06328000
         XC    BASEBUF(224),BASEBUF                                1473 06329000
*   BASNAME=BKEY;                   /* SET KEY               @Y30LB25*/ 06330000
         L     @06,BASEVPTR                                        1474 06331000
         MVC   BASNAME(13,@06),BKEY                                1474 06332000
*   BASBASVR=ON;                    /* BVR FLAG              @Y30LB25*/ 06333000
         OI    BASBASVR(@06),B'00100000'                           1475 06334000
*   BASHOLD=ON;                     /* PLACE HOLDER          @Y30LB25*/ 06335000
         OI    BASHOLD(@06),B'10000000'                            1476 06336000
*   BASINAC=ON;                     /* INACTIVE              @Y30LB25*/ 06337000
         OI    BASINAC(@06),B'00000100'                            1477 06338000
*   BASCSN1=BLANK12;                /* CSN1                  @Y30LB25*/ 06339000
         MVC   BASCSN1(12,@06),@CC00689                            1478 06340000
*   BASCSN2=BLANK12;                /* CSN2                  @Y30LB25*/ 06341000
         MVC   BASCSN2(12,@06),@CC00689                            1479 06342000
*   RPLVBLN=LENGTH(BASEBUF);        /* LENGTH BVR BUF        @Y30LB25*/ 06343000
         LA    @06,224                                             1480 06344000
         L     @15,RPLVPTR                                         1480 06345000
         ST    @06,RPLVBLN(,@15)                                   1480 06346000
*   RPLVRLN=LENGTH(BASEBUF);        /* BVR LENGTH            @Y30LB25*/ 06347000
         ST    @06,RPLVRLN(,@15)                                   1481 06348000
*   RPLVBUF=ADDR(BASEBUF);          /* SET BUF ADDR          @Y30LB25*/ 06349000
         LA    @06,BASEBUF                                         1482 06350000
         ST    @06,RPLVBUF(,@15)                                   1482 06351000
*   RPLVLOC=OFF;                    /* NO LOCATE             @Y30LB25*/ 06352000
         NI    RPLVLOC(@15),B'01111111'                            1483 06353000
*   RPLVUPD=OFF;                    /* NEW RECORD            @Y30LB25*/ 06354000
         NI    RPLVUPD(@15),B'11111101'                            1484 06355000
*   CALL WRITRECD;                  /* WRITE BVR             @Y30LB25*/ 06356000
         BAL   @14,WRITRECD                                        1485 06357000
*   RETURN;                         /*                       @Y30LB25*/ 06358000
@EL00035 DS    0H                                                  1486 06359000
@EF00035 DS    0H                                                  1486 06360000
@ER00035 L     @14,@SA00035                                        1486 06361000
         BR    @14                                                 1486 06362000
*   END CRTPHOLD;                   /*                       @Y30LB25*/ 06363000
*                                                                  1488 06364000
*   /*****************************************************************/ 06365000
*   /*                                                               */ 06366000
*   /* PROCEDURE NAME - CRTINCV2                             @Y30LB25*/ 06367000
*   /*                                                       @Y30LB25*/ 06368000
*   /* FUNCTION -                                            @Y30LB25*/ 06369000
*   /* PROCESS THE CREATION OF AN INACTIVE VOLUME AFTER      @Y30LB25*/ 06370000
*   /* THE MSC WAS CALLED.                                   @Y30LB25*/ 06371000
*   /* AN ICBDEFV EXTENSION IS REQUIRED.                     @Y30LB25*/ 06372000
*   /* ONE IS NOT SUPPLIED DURING USER TASK RECOVERY THOUGH. @Y30LB25*/ 06373000
*   /* CIRS ARE CREATED BY ICBVMS00 WHEN IT RECEIVES         @Y30LB25*/ 06374000
*   /* THE 04 MESSAGE.                                       @Y30LB25*/ 06375000
*   /*                                                       @Y30LB25*/ 06376000
*   /* INPUT -                                               @Y30LB25*/ 06377000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 06378000
*   /*                                                       @Y30LB25*/ 06379000
*   /* OUTPUT -                                              @Y30LB25*/ 06380000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 06381000
*   /* AN ERROR                                              @Y30LB25*/ 06382000
*   /*                                                               */ 06383000
*   /*****************************************************************/ 06384000
*                                                                  1488 06385000
*CRTINCV2:                          /*                       @Y30LB25*/ 06386000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 06387000
CRTINCV2 ST    @14,@SA00036                                        1488 06388000
*   CALL HOUSKEEP;                  /* JRNL RPLV &           @Y30LB25   06389000
*                                      RESERVE .MSVI         @Y30LB25*/ 06390000
         BAL   @14,HOUSKEEP                                        1489 06391000
*   IF RPLRCODE^=FIXZERO            /* MSC ERROR?            @Y30LB25*/ 06392000
*     THEN                          /* YES                   @Y30LB25*/ 06393000
         L     @06,RPLVPTR                                         1490 06394000
         LH    @15,RPLRCODE(,@06)                                  1490 06395000
         N     @15,@CF01129                                        1490 06396000
         LTR   @15,@15                                             1490 06397000
         BZ    @RF01490                                            1490 06398000
*     DO;                           /*                       @Y30LB25*/ 06399000
*                                                                  1491 06400000
*       /*************************************************************/ 06401000
*       /*                                                           */ 06402000
*       /* ZERO MSC'S RETURN AND REASON CODE                 @Y30LB25*/ 06403000
*       /*                                                           */ 06404000
*       /*************************************************************/ 06405000
*                                                                  1492 06406000
*       RPLVRETC=RPLVRETC&&RPLVRETC;/*                       @Y30LB25   06407000
*                                      0 RPLV RETN CODE      @Y30LB25*/ 06408000
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       1492 06409000
*       RPLRCODE=RPLRCODE&&RPLRCODE;/*                       @Y30LB25   06410000
*                                      0 RPLV RETN CODE      @Y30LB25*/ 06411000
*                                                                  1493 06412000
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       1493 06413000
*       /*************************************************************/ 06414000
*       /*                                                           */ 06415000
*       /* READ FOR THE BVR                                  @Y30LB25*/ 06416000
*       /*                                                           */ 06417000
*       /*************************************************************/ 06418000
*                                                                  1494 06419000
*       BVOLKY=DEFVOLD;             /*                       @Y30LB25*/ 06420000
         MVC   BVOLKY(6),DEFVOLD(DEFVPTR)                          1494 06421000
*       RPLVKEY=ADDR(BKEY);         /*                       @Y30LB25*/ 06422000
         LA    @05,BKEY                                            1495 06423000
         ST    @05,RPLVKEY(,@06)                                   1495 06424000
*       CALL READUPD1;              /*                       @Y30LB25*/ 06425000
         BAL   @14,READUPD1                                        1496 06426000
*       BASEBUF=BASEBUF1;           /*                       @Y30LB25*/ 06427000
         MVC   BASEBUF(224),BASEBUF1                               1497 06428000
*       IF RPLVRETC^=FIXZERO THEN                                  1498 06429000
         L     @06,RPLVPTR                                         1498 06430000
         LH    @05,RPLVRETC(,@06)                                  1498 06431000
         N     @05,@CF01129                                        1498 06432000
         LTR   @05,@05                                             1498 06433000
         BNZ   @RT01498                                            1498 06434000
*         RETURN;                   /*                       @Y30LB25*/ 06435000
*                                                                  1499 06436000
*       /*************************************************************/ 06437000
*       /*                                                           */ 06438000
*       /* DELETE THE PLACE HOLDER BASE OR COPY              @Y30LB25*/ 06439000
*       /* VOLUME RECORD WHICH WAS CREATED BEFORE THE        @Y30LB25*/ 06440000
*       /* CALL TO THE MSC.                                  @Y30LB25*/ 06441000
*       /*                                                           */ 06442000
*       /*************************************************************/ 06443000
*                                                                  1500 06444000
*       IF BASHOLD=ON               /* BVR CREATED?          @Y30LB25*/ 06445000
*         THEN                      /* YES                   @Y30LB25*/ 06446000
         L     @05,BASEVPTR                                        1500 06447000
         TM    BASHOLD(@05),B'10000000'                            1500 06448000
         BNO   @RF01500                                            1500 06449000
*         DO;                       /*                       @Y30LB25*/ 06450000
*                                                                  1501 06451000
*           /*********************************************************/ 06452000
*           /*                                                       */ 06453000
*           /* DELETE THE BVR PLACE HOLDER                   @Y30LB25*/ 06454000
*           /*                                                       */ 06455000
*           /*********************************************************/ 06456000
*                                                                  1502 06457000
*           RPLVTYP=RPLVDEL;        /* DELETE                @Y30LB25*/ 06458000
         MVI   RPLVTYP(@06),X'05'                                  1502 06459000
*           RESPECIFY                                              1503 06460000
*             RG1 RSTD;             /* RESTRICT REG 1        @Y30LB25*/ 06461000
*           RG1=RPLVPTR;            /* PT TO RPLV            @Y30LB25*/ 06462000
         LR    RG1,@06                                             1504 06463000
*           CALL ICBVIO00;          /* DELET BVR PLC HOLD    @Y30LB25*/ 06464000
         L     @15,@CV00762                                        1505 06465000
         BALR  @14,@15                                             1505 06466000
*           RESPECIFY                                              1506 06467000
*             RG1 UNRSTD;           /* UNRESTRICT REG 1      @Y30LB25*/ 06468000
*         END;                      /*                       @Y30LB25*/ 06469000
*                                                                  1507 06470000
*       /*************************************************************/ 06471000
*       /*                                                           */ 06472000
*       /* FIND THE PLACE HOLDER CVR                         @Y30LB25*/ 06473000
*       /*                                                           */ 06474000
*       /*************************************************************/ 06475000
*                                                                  1508 06476000
*       ELSE                                                       1508 06477000
*         DO;                       /*                       @Y30LB25*/ 06478000
         B     @RC01500                                            1508 06479000
@RF01500 DS    0H                                                  1509 06480000
*           CALL FNDCVRUP;          /* FIND PLACE HOLD       @Y30LB25*/ 06481000
         BAL   @14,FNDCVRUP                                        1509 06482000
*           IF RPLVRETC^=FIXZERO    /* ERROR?                @Y30LB25*/ 06483000
*             THEN                  /* YES                   @Y30LB25*/ 06484000
         L     @06,RPLVPTR                                         1510 06485000
         LH    @15,RPLVRETC(,@06)                                  1510 06486000
         N     @15,@CF01129                                        1510 06487000
         LTR   @15,@15                                             1510 06488000
         BNZ   @RT01510                                            1510 06489000
*             RETURN;               /*                       @Y30LB25*/ 06490000
*                                                                  1511 06491000
*           /*********************************************************/ 06492000
*           /*                                                       */ 06493000
*           /* DELETE THE CVR PLACE HOLDER                   @Y30LB25*/ 06494000
*           /*                                                       */ 06495000
*           /*********************************************************/ 06496000
*                                                                  1512 06497000
*           RPLVTYP=RPLVDEL;        /* DELETE                @Y30LB25*/ 06498000
         MVI   RPLVTYP(@06),X'05'                                  1512 06499000
*           RESPECIFY                                              1513 06500000
*             RG1 RSTD;             /* RESTRICT REG 1        @Y30LB25*/ 06501000
*           RG1=RPLVPTR;            /* PT TO RPLV            @Y30LB25*/ 06502000
         LR    RG1,@06                                             1514 06503000
*           CALL ICBVIO00;          /* DELET CVR PLC HOLD    @Y30LB25*/ 06504000
         L     @15,@CV00762                                        1515 06505000
         BALR  @14,@15                                             1515 06506000
*           RESPECIFY                                              1516 06507000
*             RG1 UNRSTD;           /* UNRESTRICT REG 1      @Y30LB25*/ 06508000
*         END;                      /*                       @Y30LB25*/ 06509000
*       RPLVRETC=RPLVRETC&&RPLVRETC;/* ZERO RETN CODE        @Y30LB25*/ 06510000
@RC01500 L     @06,RPLVPTR                                         1518 06511000
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       1518 06512000
*       RPLRCODE=RPLRCODE&&RPLRCODE;/* ZERO RESN CODE        @Y30LB25*/ 06513000
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       1519 06514000
*       RETURN;                     /*                       @Y30LB25*/ 06515000
@EL00036 DS    0H                                                  1520 06516000
@EF00036 DS    0H                                                  1520 06517000
@ER00036 L     @14,@SA00036                                        1520 06518000
         BR    @14                                                 1520 06519000
*     END;                          /*                       @Y30LB25*/ 06520000
*                                                                  1521 06521000
*   /*****************************************************************/ 06522000
*   /*                                                               */ 06523000
*   /* READ FOR THE BVR                                      @Y30LB25*/ 06524000
*   /*                                                               */ 06525000
*   /*****************************************************************/ 06526000
*                                                                  1522 06527000
*   BVOLKY=DEFVOLD;                 /* SET VOLID             @Y30LB25*/ 06528000
@RF01490 MVC   BVOLKY(6),DEFVOLD(DEFVPTR)                          1522 06529000
*   RPLVKEY=ADDR(BKEY);             /* KEY ADDR              @Y30LB25*/ 06530000
         LA    @06,BKEY                                            1523 06531000
         L     @01,RPLVPTR                                         1523 06532000
         ST    @06,RPLVKEY(,@01)                                   1523 06533000
*   CALL READUPD1;                  /* READ BVR              @Y30LB25*/ 06534000
         BAL   @14,READUPD1                                        1524 06535000
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/ 06536000
*     THEN                          /* YES                   @Y30LB25*/ 06537000
         L     @06,RPLVPTR                                         1525 06538000
         LH    @06,RPLVRETC(,@06)                                  1525 06539000
         N     @06,@CF01129                                        1525 06540000
         LTR   @06,@06                                             1525 06541000
         BNZ   @RT01525                                            1525 06542000
*     RETURN;                       /*                       @Y30LB25*/ 06543000
*   BASEBUF=BASEBUF1;               /*                       @Y30LB25*/ 06544000
*                                                                  1527 06545000
         MVC   BASEBUF(224),BASEBUF1                               1527 06546000
*   /*****************************************************************/ 06547000
*   /*                                                               */ 06548000
*   /* CREATE A COPY VOLUME RECORD FROM A PLACE HOLDER       @Y30LB25*/ 06549000
*   /*                                                               */ 06550000
*   /*****************************************************************/ 06551000
*                                                                  1528 06552000
*   IF BASHOLD=OFF                  /* CREATE CVR?           @Y30LB25*/ 06553000
*     THEN                          /* YES                   @Y30LB25*/ 06554000
         L     @06,BASEVPTR                                        1528 06555000
         TM    BASHOLD(@06),B'10000000'                            1528 06556000
         BNZ   @RF01528                                            1528 06557000
*     DO;                           /*                       @Y30LB25*/ 06558000
*       CALL FNDCVRUP;              /* FIND PLACE HOLD       @Y30LB25*/ 06559000
         BAL   @14,FNDCVRUP                                        1530 06560000
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/ 06561000
*         THEN                      /* YES                   @Y30LB25*/ 06562000
         L     @06,RPLVPTR                                         1531 06563000
         LH    @06,RPLVRETC(,@06)                                  1531 06564000
         N     @06,@CF01129                                        1531 06565000
         LTR   @06,@06                                             1531 06566000
         BNZ   @RT01531                                            1531 06567000
*         RETURN;                   /*                       @Y30LB25*/ 06568000
*       CALL CRTCVR2;               /* MAKE A CVR            @Y30LB25*/ 06569000
         BAL   @14,CRTCVR2                                         1533 06570000
*     END;                          /*                       @Y30LB25*/ 06571000
*                                                                  1534 06572000
*   /*****************************************************************/ 06573000
*   /*                                                               */ 06574000
*   /* CREATE A BASE VOLUME RECORD                           @Y30LB25*/ 06575000
*   /*                                                               */ 06576000
*   /*****************************************************************/ 06577000
*                                                                  1535 06578000
*   ELSE                            /* CREATE BVR            @Y30LB25*/ 06579000
*     CALL CRTBVR;                  /* PROCESS BVR           @Y30LB25*/ 06580000
         B     @RC01528                                            1535 06581000
@RF01528 BAL   @14,CRTBVR                                          1535 06582000
*   RETURN;                         /*                       @Y30LB25*/ 06583000
         B     @EL00036                                            1536 06584000
*   END CRTINCV2;                   /*                       @Y30LB25*/ 06585000
         B     @EL00036                                            1537 06586000
*                                                                  1538 06587000
*   /*****************************************************************/ 06588000
*   /*                                                               */ 06589000
*   /* PROCEDURE NAME - CRTCVR1                              @Y30LB25*/ 06590000
*   /*                                                       @Y30LB25*/ 06591000
*   /* FUNCTION -                                            @Y30LB25*/ 06592000
*   /* CREATE A PLACE HOLDER COPY VOLUME RECORD.             @Y30LB25*/ 06593000
*   /* THE PLACE HOLDER CVR IS NEEDED TO INSURE 04           @Y30LB25*/ 06594000
*   /* SOLICITED MESSAGE CAN BE PROCESSED.                   @Y30LB25*/ 06595000
*   /* CALLED BEFORE THE MSC.                                @Y30LB25*/ 06596000
*   /*                                                       @Y30LB25*/ 06597000
*   /* INPUT -                                               @Y30LB25*/ 06598000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 06599000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 06600000
*   /*                                                       @Y30LB25*/ 06601000
*   /* OUTPUT -                                              @Y30LB25*/ 06602000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 06603000
*   /* AN ERROR                                              @Y30LB25*/ 06604000
*   /* COPY VOLUME RECORD (PLACE HOLDER)                     @Y30LB25*/ 06605000
*   /*                                                               */ 06606000
*   /*****************************************************************/ 06607000
*                                                                  1538 06608000
*CRTCVR1:                                                          1538 06609000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 06610000
*                                                                  1538 06611000
CRTCVR1  ST    @14,@SA00037                                        1538 06612000
*   /*****************************************************************/ 06613000
*   /*                                                               */ 06614000
*   /* GET KEY OF NEXT AVAILABLE CVR.                        @Y30LB25*/ 06615000
*   /*                                                               */ 06616000
*   /*****************************************************************/ 06617000
*                                                                  1539 06618000
*   CALL CALCVRID;                  /* LOC KEY ID            @Y30LB25*/ 06619000
         BAL   @14,CALCVRID                                        1539 06620000
*   IF RPLVRETC^=FIXZERO&RPLVRETC^=NORECFND/* ERROR?         @Y30LB25*/ 06621000
*     THEN                          /* YES                   @Y30LB25*/ 06622000
         L     @06,RPLVPTR                                         1540 06623000
         LH    @05,RPLVRETC(,@06)                                  1540 06624000
         N     @05,@CF01129                                        1540 06625000
         LTR   @05,@05                                             1540 06626000
         BZ    @RF01540                                            1540 06627000
         CLC   RPLVRETC(2,@06),@CB00711                            1540 06628000
         BNE   @RT01540                                            1540 06629000
*     RETURN;                       /*                       @Y30LB25*/ 06630000
*   COPYVPTR=ADDR(COPYBUF);         /* RESET CVR BUF PTR     @Y30LB25*/ 06631000
*                                                                  1542 06632000
@RF01540 LA    @06,COPYBUF                                         1542 06633000
         ST    @06,COPYVPTR                                        1542 06634000
*   /*****************************************************************/ 06635000
*   /*                                                               */ 06636000
*   /* INITIALIZE THE PLACE HOLDER CVR.                      @Y30LB25*/ 06637000
*   /* CSNS WILL BE SET BY ICBVMS00.                         @Y30LB25*/ 06638000
*   /*                                                               */ 06639000
*   /*****************************************************************/ 06640000
*                                                                  1543 06641000
*   COPYBUF=COPYBUF&&COPYBUF;       /* ZERO CVR BUF          @Y30LB25*/ 06642000
         XC    COPYBUF(224),COPYBUF                                1543 06643000
*   COPNAME=CKEY;                   /* SET THE KEY           @Y30LB25*/ 06644000
         MVC   COPNAME(13,@06),CKEY                                1544 06645000
*   COPSERNO=DEFVOLD;               /* RESET VOLID           @Y30LB25*/ 06646000
         MVC   COPSERNO(6,@06),DEFVOLD(DEFVPTR)                    1545 06647000
*   COPCOPYV=ON;                    /* CVR FLAG              @Y30LB25*/ 06648000
         OI    COPCOPYV(@06),B'00010000'                           1546 06649000
*   COPHOLD=ON;                     /* PLACE HOLDER          @Y30LB25*/ 06650000
         OI    COPHOLD(@06),B'10000000'                            1547 06651000
*   COPLIB1=DEFVLIB;                /* SET LIB1 ID           @Y30LB25*/ 06652000
         IC    @05,DEFVLIB(,DEFVPTR)                               1548 06653000
         STC   @05,COPLIB1(,@06)                                   1548 06654000
*   COPLIB2=DEFVLIB;                /* SET LIB2 ID           @Y30LB25*/ 06655000
         IC    @05,DEFVLIB(,DEFVPTR)                               1549 06656000
         STC   @05,COPLIB2(,@06)                                   1549 06657000
*   IF DEFOWNID(1:10)^=FIX10ZRO     /* OWNER ID SPECIFD?     @Y30LB25*/ 06658000
*     THEN                          /* YES                   @Y30LB25*/ 06659000
         CLC   DEFOWNID(10,DEFVPTR),@CB00681                       1550 06660000
         BE    @RF01550                                            1550 06661000
*     COPOWNER=DEFOWNID;            /* SET OWNER             @Y30LB25*/ 06662000
         MVC   COPOWNER(10,@06),DEFOWNID(DEFVPTR)                  1551 06663000
*   ELSE                            /* NO                    @Y30LB25*/ 06664000
*     COPOWNER=BLANK10;             /* NULL OWNER            @Y30LB25*/ 06665000
         B     @RC01550                                            1552 06666000
@RF01550 L     @06,COPYVPTR                                        1552 06667000
         MVI   COPOWNER+1(@06),C' '                                1552 06668000
         MVC   COPOWNER+2(8,@06),COPOWNER+1(@06)                   1552 06669000
         MVI   COPOWNER(@06),C' '                                  1552 06670000
*   IF BASGRPV=ON                   /* GROUPED?              @Y30LB25*/ 06671000
*     THEN                          /* YES                   @Y30LB25*/ 06672000
@RC01550 L     @06,BASEVPTR                                        1553 06673000
         TM    BASGRPV(@06),B'00100000'                            1553 06674000
         BNO   @RF01553                                            1553 06675000
*     COPGROUP=ON;                  /* GROUP                 @Y30LB25*/ 06676000
         L     @06,COPYVPTR                                        1554 06677000
         OI    COPGROUP(@06),B'10000000'                           1554 06678000
*   IF BASGENUS=ON                  /* GENERAL-USE?          @Y30LB25*/ 06679000
*     THEN                          /* YES                   @Y30LB25*/ 06680000
@RF01553 L     @06,BASEVPTR                                        1555 06681000
         TM    BASGENUS(@06),B'00010000'                           1555 06682000
         BNO   @RF01555                                            1555 06683000
*     COPGENUS=ON;                  /* GENERAL-USE           @Y30LB25*/ 06684000
         L     @06,COPYVPTR                                        1556 06685000
         OI    COPGENUS(@06),B'00100000'                           1556 06686000
*   ELSE                                                           1557 06687000
*     IF BASRSTD=ON                 /* RESTRICTED?           @Y30LB25*/ 06688000
*       THEN                        /* YES                   @Y30LB25*/ 06689000
         B     @RC01555                                            1557 06690000
@RF01555 L     @06,BASEVPTR                                        1557 06691000
         TM    BASRSTD(@06),B'00001000'                            1557 06692000
         BNO   @RF01557                                            1557 06693000
*       COPRSTD=ON;                 /* RESTRICTED            @Y30LB25*/ 06694000
*                                                                  1558 06695000
         L     @06,COPYVPTR                                        1558 06696000
         OI    COPRSTD(@06),B'00010000'                            1558 06697000
*   /*****************************************************************/ 06698000
*   /*                                                               */ 06699000
*   /* SET UP THE ATTRIBUTES                                 @Y30LB25*/ 06700000
*   /*                                                               */ 06701000
*   /*****************************************************************/ 06702000
*                                                                  1559 06703000
*   IF DEFVEXCL=ON                  /* EXCLUSIVE?            @Y30LB25*/ 06704000
*     THEN                          /* YES                   @Y30LB25*/ 06705000
@RF01557 DS    0H                                                  1559 06706000
@RC01555 TM    DEFVEXCL(DEFVPTR),B'00010000'                       1559 06707000
         BNO   @RF01559                                            1559 06708000
*     COPEXCL=ON;                   /* EXCLUSIVE             @Y30LB25*/ 06709000
         L     @06,COPYVPTR                                        1560 06710000
         OI    COPEXCL(@06),B'00000010'                            1560 06711000
*   IF DEFVBIND=ON                  /* BIND?                 @Y30LB25*/ 06712000
*     THEN                          /* YES                   @Y30LB25*/ 06713000
@RF01559 TM    DEFVBIND(DEFVPTR),B'00000100'                       1561 06714000
         BNO   @RF01561                                            1561 06715000
*     COPBIND=ON;                   /* BIND                  @Y30LB25*/ 06716000
         L     @06,COPYVPTR                                        1562 06717000
         OI    COPBIND(@06),B'00000100'                            1562 06718000
*   IF DEFVWINH=ON                  /* READ ONLY?            @Y30LB25*/ 06719000
*     THEN                          /* YES                   @Y30LB25*/ 06720000
@RF01561 TM    DEFVWINH(DEFVPTR),B'00000010'                       1563 06721000
         BNO   @RF01563                                            1563 06722000
*     COPRONLY=ON;                  /* READ ONLY             @Y30LB25*/ 06723000
         L     @06,COPYVPTR                                        1564 06724000
         OI    COPRONLY(@06),B'10000000'                           1564 06725000
*   IF DEFVSEC=ON                   /* DASD ERASE?           @Y30LB25*/ 06726000
*     THEN                          /* YES                   @Y30LB25*/ 06727000
@RF01563 TM    DEFVSEC(DEFVPTR),B'00100000'                        1565 06728000
         BNO   @RF01565                                            1565 06729000
*     COPDAERA=ON;                  /* DASD ERASE            @Y30LB25*/ 06730000
*                                                                  1566 06731000
         L     @06,COPYVPTR                                        1566 06732000
         OI    COPDAERA(@06),B'00000001'                           1566 06733000
*   /*****************************************************************/ 06734000
*   /*                                                               */ 06735000
*   /* CHECK FOR RECOVERY AND IF SO USE THE DATE             @ZA13484*/ 06736000
*   /* THE RPLV WAS CREATED.                                 @ZA13484*/ 06737000
*   /*                                                               */ 06738000
*   /*****************************************************************/ 06739000
*                                                                  1567 06740000
*   IF RPLJRCVY=ON&RPLVDATE^=NULLDATE THEN/* RECOVERY?       @ZA13484*/ 06741000
@RF01565 L     @06,RPLVPTR                                         1567 06742000
         TM    RPLJRCVY(@06),B'00000010'                           1567 06743000
         BNO   @RF01567                                            1567 06744000
         CLC   RPLVDATE(4,@06),NULLDATE                            1567 06745000
         BE    @RF01567                                            1567 06746000
*     COPDATE=RPLVDATE;             /* DATE                  @ZA13484*/ 06747000
         L     @01,COPYVPTR                                        1568 06748000
         MVC   COPDATE(4,@01),RPLVDATE(@06)                        1568 06749000
*   ELSE                                                           1569 06750000
*     DO;                           /*                       @ZA13484*/ 06751000
*                                                                  1569 06752000
         B     @RC01567                                            1569 06753000
@RF01567 DS    0H                                                  1570 06754000
*       /*************************************************************/ 06755000
*       /*                                                           */ 06756000
*       /* GET AND SET THE CURRENT DATE                      @Y30LB25*/ 06757000
*       /*                                                           */ 06758000
*       /*************************************************************/ 06759000
*                                                                  1570 06760000
*       CALL ICBVUEXP(FIXZERO,RPLVPTR,EXPRDT);/* GET DATE    @ZA30662*/ 06761000
         L     @15,@CV00768                                        1570 06762000
         LA    @01,@AL01570                                        1570 06763000
         BALR  @14,@15                                             1570 06764000
*       COPDATE=EXPRDT;             /* DATE COPY MADE        @Y30LB25*/ 06765000
         L     @06,COPYVPTR                                        1571 06766000
         MVC   COPDATE(4,@06),EXPRDT                               1571 06767000
*     END;                          /*                       @ZA13484*/ 06768000
*                                                                  1572 06769000
*   /*****************************************************************/ 06770000
*   /*                                                               */ 06771000
*   /* BLANK REMAINING FIELDS                                @Y30LB25*/ 06772000
*   /*                                                               */ 06773000
*   /*****************************************************************/ 06774000
*                                                                  1573 06775000
*   COPDESCR=BLANK30;               /* BLANK DESCR           @Y30LB25*/ 06776000
@RC01567 L     @06,COPYVPTR                                        1573 06777000
         MVI   COPDESCR+1(@06),C' '                                1573 06778000
         MVC   COPDESCR+2(28,@06),COPDESCR+1(@06)                  1573 06779000
         MVI   COPDESCR(@06),C' '                                  1573 06780000
*   COPDTREM=BLANK4;                /* EJECT DATE            @Y30LB25*/ 06781000
         MVI   COPDTREM+1(@06),C' '                                1574 06782000
         MVC   COPDTREM+2(2,@06),COPDTREM+1(@06)                   1574 06783000
         MVI   COPDTREM(@06),C' '                                  1574 06784000
*   COPDEST=BLANK30;                /* DESTINATION           @Y30LB25*/ 06785000
         MVI   COPDEST+1(@06),C' '                                 1575 06786000
         MVC   COPDEST+2(28,@06),COPDEST+1(@06)                    1575 06787000
         MVI   COPDEST(@06),C' '                                   1575 06788000
*   COPCSN1=BLANK12;                /* CSN1                  @Y30LB25*/ 06789000
         MVC   COPCSN1(12,@06),@CC00689                            1576 06790000
*   COPCSN2=BLANK12;                /* CSN2                  @Y30LB25*/ 06791000
*                                                                  1577 06792000
         MVC   COPCSN2(12,@06),@CC00689                            1577 06793000
*   /*****************************************************************/ 06794000
*   /*                                                               */ 06795000
*   /* WRITE THE CVR                                         @Y30LB25*/ 06796000
*   /*                                                               */ 06797000
*   /*****************************************************************/ 06798000
*                                                                  1578 06799000
*   RPLVUPD=OFF;                    /* NEW RECORD            @Y30LB25*/ 06800000
         L     @06,RPLVPTR                                         1578 06801000
         NI    RPLVUPD(@06),B'11111101'                            1578 06802000
*   RPLVBLN=LENGTH(COPYBUF);        /* CVR BUF LENGTH        @Y30LB25*/ 06803000
         MVC   RPLVBLN(4,@06),@CF01103                             1579 06804000
*   RPLVBUF=ADDR(COPYBUF);          /* SET BUF ADDR          @Y30LB25*/ 06805000
         LA    @15,COPYBUF                                         1580 06806000
         ST    @15,RPLVBUF(,@06)                                   1580 06807000
*   RPLVRLN=LENGTH(COPYV);          /* CVR LENGTH            @Y30LB25*/ 06808000
         MVC   RPLVRLN(4,@06),@CF01104                             1581 06809000
*   CALL WRITRECD;                  /* WRITE CVR             @Y30LB25*/ 06810000
         BAL   @14,WRITRECD                                        1582 06811000
*   RETURN;                         /*                       @Y30LB25*/ 06812000
@EL00037 DS    0H                                                  1583 06813000
@EF00037 DS    0H                                                  1583 06814000
@ER00037 L     @14,@SA00037                                        1583 06815000
         BR    @14                                                 1583 06816000
*   END CRTCVR1;                    /*                       @Y30LB25*/ 06817000
         B     @EL00037                                            1584 06818000
*                                                                  1585 06819000
*   /*****************************************************************/ 06820000
*   /*                                                               */ 06821000
*   /* PROCEDURE NAME - CALCVRID                             @Y30LB25*/ 06822000
*   /*                                                       @Y30LB25*/ 06823000
*   /* FUNCTION -                                            @Y30LB25*/ 06824000
*   /* CALCULATE A NEW COPY VOLUME RECORD ID.                @Y30LB25*/ 06825000
*   /*                                                       @Y30LB25*/ 06826000
*   /* INPUT -                                               @Y30LB25*/ 06827000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 06828000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 06829000
*   /*                                                       @Y30LB25*/ 06830000
*   /* OUTPUT -                                              @Y30LB25*/ 06831000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 06832000
*   /* AN ERROR                                              @Y30LB25*/ 06833000
*   /* COPY VOLUME RECORD ID                                 @Y30LB25*/ 06834000
*   /*                                                               */ 06835000
*   /*****************************************************************/ 06836000
*                                                                  1585 06837000
*CALCVRID:                                                         1585 06838000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 06839000
*                                                                  1585 06840000
CALCVRID ST    @14,@SA00038                                        1585 06841000
*   /*****************************************************************/ 06842000
*   /*                                                               */ 06843000
*   /* GET KEY OF NEXT AVAILABLE CVR.                        @Y30LB25*/ 06844000
*   /*                                                               */ 06845000
*   /*****************************************************************/ 06846000
*                                                                  1586 06847000
*   CVOLKY=BASSERNO;                /* SET VOLID             @Y30LB25*/ 06848000
         L     @06,BASEVPTR                                        1586 06849000
         MVC   CVOLKY(6),BASSERNO(@06)                             1586 06850000
*   CIDKY=FIXONE;                   /* SET CVR ID            @Y30LB25*/ 06851000
         MVI   CIDKY,X'01'                                         1587 06852000
*   IF BASCOPNO=FIX255&BASNCOPY>FIXZERO/* ANY AVAIL CVR KEY? @Y30LB25*/ 06853000
*     THEN                          /* NO                    @Y30LB25*/ 06854000
         CLI   BASCOPNO(@06),255                                   1588 06855000
         BNE   @RF01588                                            1588 06856000
         CLI   BASNCOPY(@06),0                                     1588 06857000
         BNH   @RF01588                                            1588 06858000
*     DO;                           /*                       @Y30LB25*/ 06859000
*                                                                  1589 06860000
*       /*************************************************************/ 06861000
*       /*                                                           */ 06862000
*       /* REORDER AND COMPRESS CVRS.                        @Y30LB25*/ 06863000
*       /*                                                           */ 06864000
*       /*************************************************************/ 06865000
*                                                                  1590 06866000
*       CALL REORDCVR;              /* PROCESS CVRS          @Y30LB25*/ 06867000
         BAL   @14,REORDCVR                                        1590 06868000
*     END;                          /*                       @Y30LB25*/ 06869000
*                                                                  1591 06870000
*   /*****************************************************************/ 06871000
*   /*                                                               */ 06872000
*   /* CALCULATE THE NEXT AVAILABLE CVR KEY FROM ITS BVR.    @Y30LB25*/ 06873000
*   /*                                                               */ 06874000
*   /*****************************************************************/ 06875000
*                                                                  1592 06876000
*   ELSE                                                           1592 06877000
*     DO;                           /*                       @Y30LB25*/ 06878000
         B     @RC01588                                            1592 06879000
@RF01588 DS    0H                                                  1593 06880000
*       IF BASNCOPY>FIXZERO         /* CVR EXIST?            @Y30LB25*/ 06881000
*         THEN                      /* YES                   @Y30LB25*/ 06882000
         L     @06,BASEVPTR                                        1593 06883000
         CLI   BASNCOPY(@06),0                                     1593 06884000
         BNH   @RF01593                                            1593 06885000
*         BASCOPNO=BASCOPNO+FIXONE; /* INCREM KEY ID         @Y30LB25*/ 06886000
         LA    @05,1                                               1594 06887000
         SLR   @15,@15                                             1594 06888000
         IC    @15,BASCOPNO(,@06)                                  1594 06889000
         ALR   @05,@15                                             1594 06890000
         STC   @05,BASCOPNO(,@06)                                  1594 06891000
*       ELSE                        /* NO                    @Y30LB25*/ 06892000
*         BASCOPNO=FIXONE;          /* SET TO 1              @Y30LB25*/ 06893000
         B     @RC01593                                            1595 06894000
@RF01593 L     @06,BASEVPTR                                        1595 06895000
         MVI   BASCOPNO(@06),X'01'                                 1595 06896000
*       CIDKY=BASCOPNO;             /* SET KEY ID            @Y30LB25*/ 06897000
@RC01593 L     @06,BASEVPTR                                        1596 06898000
         IC    @05,BASCOPNO(,@06)                                  1596 06899000
         STC   @05,CIDKY                                           1596 06900000
*     END;                          /*                       @Y30LB25*/ 06901000
*   RETURN;                         /*                       @Y30LB25*/ 06902000
@EL00038 DS    0H                                                  1598 06903000
@EF00038 DS    0H                                                  1598 06904000
@ER00038 L     @14,@SA00038                                        1598 06905000
         BR    @14                                                 1598 06906000
*   END CALCVRID;                   /*                       @Y30LB25*/ 06907000
         B     @EL00038                                            1599 06908000
*                                                                  1600 06909000
*   /*****************************************************************/ 06910000
*   /*                                                               */ 06911000
*   /* PROCEDURE NAME - REORDCVR                             @Y30LB25*/ 06912000
*   /*                                                       @Y30LB25*/ 06913000
*   /* FUNCTION -                                            @Y30LB25*/ 06914000
*   /* REORDER AND COMPRESS THE CHAIN OF CVRS.               @Y30LB25*/ 06915000
*   /*                                                       @Y30LB25*/ 06916000
*   /* INPUT -                                               @Y30LB25*/ 06917000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 06918000
*   /*                                                       @Y30LB25*/ 06919000
*   /* OUTPUT -                                              @Y30LB25*/ 06920000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 06921000
*   /* AN ERROR                                              @Y30LB25*/ 06922000
*   /* ID NUMBER OF NEXT AVAILABLE COPY VOLUME               @Y30LB25*/ 06923000
*   /* RECORD IN CIDKY                                       @Y30LB25*/ 06924000
*   /*                                                               */ 06925000
*   /*****************************************************************/ 06926000
*                                                                  1600 06927000
*REORDCVR:                                                         1600 06928000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 06929000
*                                                                  1600 06930000
REORDCVR ST    @14,@SA00039                                        1600 06931000
*   /*****************************************************************/ 06932000
*   /*                                                               */ 06933000
*   /* SETUP FOR READ OF CVR CHAIN                           @Y30LB25*/ 06934000
*   /*                                                               */ 06935000
*   /*****************************************************************/ 06936000
*                                                                  1601 06937000
*   COPYVPTR=ADDR(BASEBUF1);        /* SET BUFF PTR          @Y30LB25*/ 06938000
         LA    @06,BASEBUF1                                        1601 06939000
         ST    @06,COPYVPTR                                        1601 06940000
*   RPLVDIR=ON;                     /* DIRECT                @Y30LB25*/ 06941000
         L     @05,RPLVPTR                                         1602 06942000
         OI    RPLVDIR(@05),B'01000000'                            1602 06943000
*   RPLVUPD=ON;                     /* UPDATE                @Y30LB25*/ 06944000
         OI    RPLVUPD(@05),B'00000010'                            1603 06945000
*   RPLVLOC=OFF;                    /* NO LOCATE             @Y30LB25*/ 06946000
*   RPLVKGE=ON;                     /* > OR =                @Y30LB25*/ 06947000
         OI    RPLVKGE(@05),B'00000100'                            1605 06948000
         NI    RPLVLOC(@05),B'01111111'                            1605 06949000
*   RPLVKEY=ADDR(CKEY);             /* KEY ADDR              @Y30LB25*/ 06950000
         LA    @15,CKEY                                            1606 06951000
         ST    @15,RPLVKEY(,@05)                                   1606 06952000
*   RPLVTYP=RPLVREAD;               /* READ                  @Y30LB25*/ 06953000
         MVI   RPLVTYP(@05),X'00'                                  1607 06954000
*   RPLVBLN=LENGTH(BASEBUF1);       /* CVR BUF LENGTH        @Y30LB25*/ 06955000
         MVC   RPLVBLN(4,@05),@CF01103                             1608 06956000
*   RPLVBUF=ADDR(BASEBUF1);         /* CVR BUF ADDR          @Y30LB25*/ 06957000
         ST    @06,RPLVBUF(,@05)                                   1609 06958000
*   A=FIXONE;                       /* FIRST READ            @Y30LB25*/ 06959000
         MVC   A(4),@CF00046                                       1610 06960000
*   RESPECIFY                                                      1611 06961000
*     RG1 RSTD;                     /* RESTRICT REG 1        @Y30LB25*/ 06962000
*   RG1=RPLVPTR;                    /* SET RPLV PTR          @Y30LB25*/ 06963000
         LR    RG1,@05                                             1612 06964000
*   DO WHILE CKY=COPV&COPSERNO=BASSERNO&RPLVRETC=FIXZERO;/*  @Y30LB25   06965000
*                                      READ CVR CHAIN        @Y30LB25*/ 06966000
         B     @DE01613                                            1613 06967000
@DL01613 DS    0H                                                  1614 06968000
*     CALL ICBVIO00;                /* READ A CVR            @Y30LB25*/ 06969000
*                                                                  1614 06970000
         L     @15,@CV00762                                        1614 06971000
         BALR  @14,@15                                             1614 06972000
*     /***************************************************************/ 06973000
*     /*                                                             */ 06974000
*     /* IF NOT THE SAME CVR, THEN DELETE THE ONE READ       @Y30LB25*/ 06975000
*     /* AND WRITE THE NEW KEYED CVR                         @Y30LB25*/ 06976000
*     /*                                                             */ 06977000
*     /***************************************************************/ 06978000
*                                                                  1615 06979000
*     IF COPNO^=A                   /* SAME CVR?             @Y30LB25*/ 06980000
*       THEN                        /* NO                    @Y30LB25*/ 06981000
         L     @06,COPYVPTR                                        1615 06982000
         SLR   @05,@05                                             1615 06983000
         IC    @05,COPNO(,@06)                                     1615 06984000
         C     @05,A                                               1615 06985000
         BE    @RF01615                                            1615 06986000
*       DO;                         /*                       @Y30LB25*/ 06987000
*         RPLVTYP=RPLVDEL;          /* DELETE                @Y30LB25*/ 06988000
         L     @06,RPLVPTR                                         1617 06989000
         MVI   RPLVTYP(@06),X'05'                                  1617 06990000
*         CALL ICBVIO00;            /* DELETE THE CVR        @Y30LB25*/ 06991000
         L     @15,@CV00762                                        1618 06992000
         BALR  @14,@15                                             1618 06993000
*         IF RPLVRETC^=FIXZERO      /* ERROR?                @Y30LB25*/ 06994000
*           THEN                    /* YES                   @Y30LB25*/ 06995000
         L     @06,RPLVPTR                                         1619 06996000
         LH    @05,RPLVRETC(,@06)                                  1619 06997000
         N     @05,@CF01129                                        1619 06998000
         LTR   @05,@05                                             1619 06999000
         BNZ   @RT01619                                            1619 07000000
*           RETURN;                 /*                       @Y30LB25*/ 07001000
*         COPNO=A;                  /* SET NEW ID            @Y30LB25*/ 07002000
         L     @05,A                                               1621 07003000
         L     @15,COPYVPTR                                        1621 07004000
         STC   @05,COPNO(,@15)                                     1621 07005000
*         RPLVUPD=OFF;              /* NEW RECORD            @Y30LB25*/ 07006000
         NI    RPLVUPD(@06),B'11111101'                            1622 07007000
*         CALL ICBVIO00;            /* WRITE CVR             @Y30LB25*/ 07008000
         L     @15,@CV00762                                        1623 07009000
         BALR  @14,@15                                             1623 07010000
*         RPLVDIR=ON;               /* RESET DIRECT          @Y30LB25*/ 07011000
         L     @06,RPLVPTR                                         1624 07012000
         OI    RPLVDIR(@06),B'01000000'                            1624 07013000
*         RPLVTYP=RPLVREAD;         /* RESET RESD            @Y30LB25*/ 07014000
         MVI   RPLVTYP(@06),X'00'                                  1625 07015000
*       END;                        /*                       @Y30LB25*/ 07016000
*     A=A+FIXONE;                   /* NEXT CVR ID           @Y30LB25*/ 07017000
@RF01615 LA    @06,1                                               1627 07018000
         AL    @06,A                                               1627 07019000
         ST    @06,A                                               1627 07020000
*     CIDKY=A;                      /* SET CVR ID            @Y30LB25*/ 07021000
         STC   @06,CIDKY                                           1628 07022000
*     IF A=FIX256                   /* END?                  @Y30LB25*/ 07023000
*       THEN                        /* YES                   @Y30LB25*/ 07024000
         C     @06,@CF00666                                        1629 07025000
         BNE   @RF01629                                            1629 07026000
*       DO;                         /*                       @Y30LB25*/ 07027000
*         RPLVRETC=FIXFOUR;         /* ERROR RETURN CODE     @Y30LB25*/ 07028000
         L     @06,RPLVPTR                                         1631 07029000
         MVC   RPLVRETC(2,@06),@CH00041                            1631 07030000
*         RPLRCODE=NOCVR;           /* ERROR REASON CODE     @Y30LB25*/ 07031000
         MVC   RPLRCODE(2,@06),@CB00703                            1632 07032000
*         RETURN;                   /*                       @Y30LB25*/ 07033000
@EL00039 DS    0H                                                  1633 07034000
@EF00039 DS    0H                                                  1633 07035000
@ER00039 L     @14,@SA00039                                        1633 07036000
         BR    @14                                                 1633 07037000
*       END;                        /*                       @Y30LB25*/ 07038000
*   END;                            /*                       @Y30LB25*/ 07039000
@RF01629 DS    0H                                                  1635 07040000
@DE01613 L     @06,COPYVPTR                                        1635 07041000
         CLC   CKY(5),COPV(@06)                                    1635 07042000
         BNE   @DC01613                                            1635 07043000
         L     @05,BASEVPTR                                        1635 07044000
         CLC   COPSERNO(6,@06),BASSERNO(@05)                       1635 07045000
         BNE   @DC01613                                            1635 07046000
         L     @06,RPLVPTR                                         1635 07047000
         LH    @06,RPLVRETC(,@06)                                  1635 07048000
         N     @06,@CF01129                                        1635 07049000
         LTR   @06,@06                                             1635 07050000
         BZ    @DL01613                                            1635 07051000
@DC01613 DS    0H                                                  1636 07052000
*   RESPECIFY                                                      1636 07053000
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @Y30LB25*/ 07054000
*   RPLVKGE=OFF;                    /* NO > OR =             @Y30LB25*/ 07055000
         L     @06,RPLVPTR                                         1637 07056000
         NI    RPLVKGE(@06),B'11111011'                            1637 07057000
*   RETURN;                         /*                       @Y30LB25*/ 07058000
         B     @EL00039                                            1638 07059000
*   END REORDCVR;                   /*                       @Y30LB25*/ 07060000
         B     @EL00039                                            1639 07061000
*                                                                  1640 07062000
*   /*****************************************************************/ 07063000
*   /*                                                               */ 07064000
*   /* PROCEDURE NAME - CRTBVR                               @Y30LB25*/ 07065000
*   /*                                                       @Y30LB25*/ 07066000
*   /* FUNCTION -                                            @Y30LB25*/ 07067000
*   /* CREATE AND WRITE A BASE VOLUME RECORD FROM A PLACE    @Y30LB25*/ 07068000
*   /* HOLDER BVR CREATED BEFORE THE MSC WAS CALLED.         @Y30LB25*/ 07069000
*   /*                                                       @Y30LB25*/ 07070000
*   /* INPUT -                                               @Y30LB25*/ 07071000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 07072000
*   /* PLACE HOLDER BASE VOLUME RECORD IN BASEBUF            @Y30LB25*/ 07073000
*   /* CSNS SETUP IN BASEBUF FOR RENAME                      @Y30LB25*/ 07074000
*   /*                                                       @Y30LB25*/ 07075000
*   /* OUTPUT -                                              @Y30LB25*/ 07076000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 07077000
*   /* AN ERROR                                              @Y30LB25*/ 07078000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 07079000
*   /*                                                               */ 07080000
*   /*****************************************************************/ 07081000
*                                                                  1640 07082000
*CRTBVR:                                                           1640 07083000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 07084000
*                                                                  1640 07085000
CRTBVR   ST    @14,@SA00040                                        1640 07086000
*   /*****************************************************************/ 07087000
*   /*                                                               */ 07088000
*   /* INITIALIZE THE BVR.                                   @Y30LB25*/ 07089000
*   /* CSNS WILL BE SET BY ICBVMS00.                         @Y30LB25*/ 07090000
*   /* USED BY CREATE AN INACTIVE VOLUME                     @Y30LB25*/ 07091000
*   /* AFTER THE MAS WAS CALLED.                             @Y30LB25*/ 07092000
*   /*                                                               */ 07093000
*   /*****************************************************************/ 07094000
*                                                                  1641 07095000
*   BASHOLD=OFF;                    /* NO PLACE HOLD         @Y30LB25*/ 07096000
         L     @06,BASEVPTR                                        1641 07097000
         NI    BASHOLD(@06),B'01111111'                            1641 07098000
*   BASDLSF=ON;                     /* SET DOWN LEV SPC      @Y30LB25*/ 07099000
         OI    BASDLSF(@06),B'10000000'                            1642 07100000
*   BASLIB1=DEFVLIB;                /* LIB1 ID               @Y30LB25*/ 07101000
         IC    @15,DEFVLIB(,DEFVPTR)                               1643 07102000
         STC   @15,BASLIB1(,@06)                                   1643 07103000
*   BASLIB2=DEFVLIB;                /* LIB2 ID               @Y30LB25*/ 07104000
         IC    @15,DEFVLIB(,DEFVPTR)                               1644 07105000
         STC   @15,BASLIB2(,@06)                                   1644 07106000
*   BASINAC=ON;                     /* INACTIVE              @Y30LB25*/ 07107000
         OI    BASINAC(@06),B'00000100'                            1645 07108000
*   BASPREV=BLANK6;                 /* PREV PTR              @Y30LB25*/ 07109000
         MVI   BASPREV+1(@06),C' '                                 1646 07110000
         MVC   BASPREV+2(4,@06),BASPREV+1(@06)                     1646 07111000
         MVI   BASPREV(@06),C' '                                   1646 07112000
*   BASNEXTV=BLANK6;                /* NEXT PTR              @Y30LB25*/ 07113000
         MVI   BASNEXTV+1(@06),C' '                                1647 07114000
         MVC   BASNEXTV+2(4,@06),BASNEXTV+1(@06)                   1647 07115000
         MVI   BASNEXTV(@06),C' '                                  1647 07116000
*   BASKLCPY=BLANK13;               /* LASTEST COPY          @Y30LB25*/ 07117000
         MVC   BASKLCPY(13,@06),@CC00692                           1648 07118000
*   BASDLMTD=BLANK4;                /* LAST MNT DATE         @Y30LB25*/ 07119000
         MVI   BASDLMTD+1(@06),C' '                                1649 07120000
         MVC   BASDLMTD+2(2,@06),BASDLMTD+1(@06)                   1649 07121000
         MVI   BASDLMTD(@06),C' '                                  1649 07122000
*   BASEXPDT=FIX4FS;                /* EXPIR DATE            @Y30LB25*/ 07123000
         MVC   BASEXPDT(4,@06),@CB00677                            1650 07124000
*   BASDTREM=BLANK4;                /* EJECT DATE            @Y30LB25*/ 07125000
         MVI   BASDTREM+1(@06),C' '                                1651 07126000
         MVC   BASDTREM+2(2,@06),BASDTREM+1(@06)                   1651 07127000
         MVI   BASDTREM(@06),C' '                                  1651 07128000
*   BASDESCR=BLANK30;               /* DESCRIPTION           @Y30LB25*/ 07129000
         MVI   BASDESCR+1(@06),C' '                                1652 07130000
         MVC   BASDESCR+2(28,@06),BASDESCR+1(@06)                  1652 07131000
         MVI   BASDESCR(@06),C' '                                  1652 07132000
*   BASDEST=BLANK30;                /* DESTINATION           @Y30LB25*/ 07133000
         MVI   BASDEST+1(@06),C' '                                 1653 07134000
         MVC   BASDEST+2(28,@06),BASDEST+1(@06)                    1653 07135000
         MVI   BASDEST(@06),C' '                                   1653 07136000
*   BASRECOV=BLANK6;                /* SER #                 @Y30LB25*/ 07137000
         MVI   BASRECOV+1(@06),C' '                                1654 07138000
         MVC   BASRECOV+2(4,@06),BASRECOV+1(@06)                   1654 07139000
         MVI   BASRECOV(@06),C' '                                  1654 07140000
*   BASGROUP=BLANK8;                /* GROUP                 @Y30LB25*/ 07141000
         MVI   BASGROUP+1(@06),C' '                                1655 07142000
         MVC   BASGROUP+2(6,@06),BASGROUP+1(@06)                   1655 07143000
         MVI   BASGROUP(@06),C' '                                  1655 07144000
*   BASLEXT=FIX2FS;                 /* LARGE EXTENT          @Y30LB25*/ 07145000
         L     @15,@CF00672                                        1656 07146000
         STH   @15,BASLEXT(,@06)                                   1656 07147000
*   BASFRESP=FIX2FS;                /* FREE SPACE            @Y30LB25*/ 07148000
         STH   @15,BASFRESP(,@06)                                  1657 07149000
*   BASFREXT=FIX4FS;                /* FREE EXTENTS          @Y30LB25*/ 07150000
         MVC   BASFREXT(4,@06),@CF00677                            1658 07151000
*   BASBKLMT=FIXONE;                /* BACKUP LMT            @Y30LB25*/ 07152000
         MVI   BASBKLMT(@06),X'01'                                 1659 07153000
*   IF DEFOWNID(1:10)^=FIX10ZRO     /* OWNER ID SPECIFD?     @Y30LB25*/ 07154000
*     THEN                          /* YES                   @Y30LB25*/ 07155000
         CLC   DEFOWNID(10,DEFVPTR),@CB00681                       1660 07156000
         BE    @RF01660                                            1660 07157000
*     BASOWNER=DEFOWNID;            /* SET OWNER             @Y30LB25*/ 07158000
         MVC   BASOWNER(10,@06),DEFOWNID(DEFVPTR)                  1661 07159000
*   ELSE                            /* NO                    @Y30LB25*/ 07160000
*     BASOWNER=BLANK10;             /* NULL OWNER            @Y30LB25*/ 07161000
*                                                                  1662 07162000
         B     @RC01660                                            1662 07163000
@RF01660 L     @06,BASEVPTR                                        1662 07164000
         MVI   BASOWNER+1(@06),C' '                                1662 07165000
         MVC   BASOWNER+2(8,@06),BASOWNER+1(@06)                   1662 07166000
         MVI   BASOWNER(@06),C' '                                  1662 07167000
*   /*****************************************************************/ 07168000
*   /*                                                               */ 07169000
*   /* SET THE ATTRIBUTES                                    @Y30LB25*/ 07170000
*   /*                                                               */ 07171000
*   /*****************************************************************/ 07172000
*                                                                  1663 07173000
*   IF DEFVEXCL=ON                  /* EXCLUSIVE?            @Y30LB25*/ 07174000
*     THEN                          /* YES                   @Y30LB25*/ 07175000
@RC01660 TM    DEFVEXCL(DEFVPTR),B'00010000'                       1663 07176000
         BNO   @RF01663                                            1663 07177000
*     BASEXCL=ON;                   /* EXCLUSIVE             @Y30LB25*/ 07178000
         L     @06,BASEVPTR                                        1664 07179000
         OI    BASEXCL(@06),B'00000001'                            1664 07180000
*   IF DEFVBIND=ON                  /* BIND?                 @Y30LB25*/ 07181000
*     THEN                          /* YES                   @Y30LB25*/ 07182000
@RF01663 TM    DEFVBIND(DEFVPTR),B'00000100'                       1665 07183000
         BNO   @RF01665                                            1665 07184000
*     BASBIND=ON;                   /* BIND                  @Y30LB25*/ 07185000
         L     @06,BASEVPTR                                        1666 07186000
         OI    BASBIND(@06),B'00000010'                            1666 07187000
*   IF DEFVWINH=ON                  /* READ ONLY?            @Y30LB25*/ 07188000
*     THEN                          /* YES                   @Y30LB25*/ 07189000
@RF01665 TM    DEFVWINH(DEFVPTR),B'00000010'                       1667 07190000
         BNO   @RF01667                                            1667 07191000
*     BASRONLY=ON;                  /* READ ONLY             @Y30LB25*/ 07192000
         L     @06,BASEVPTR                                        1668 07193000
         OI    BASRONLY(@06),B'01000000'                           1668 07194000
*   IF DEFVSEC=ON                   /* DASD ERASE?           @Y30LB25*/ 07195000
*     THEN                          /* YES                   @Y30LB25*/ 07196000
@RF01667 TM    DEFVSEC(DEFVPTR),B'00100000'                        1669 07197000
         BNO   @RF01669                                            1669 07198000
*     BASDAERA=ON;                  /* DASD ERASE            @Y30LB25*/ 07199000
*                                                                  1670 07200000
         L     @06,BASEVPTR                                        1670 07201000
         OI    BASDAERA(@06),B'10000000'                           1670 07202000
*   /*****************************************************************/ 07203000
*   /*                                                               */ 07204000
*   /* CHAIN BVR INTO NON-GROUP VOLUME RECORD                @Y30LB25*/ 07205000
*   /*                                                               */ 07206000
*   /*****************************************************************/ 07207000
*                                                                  1671 07208000
*   GRPFLG=OFF;                     /* NGVR                  @Y30LB25*/ 07209000
@RF01669 NI    GRPFLG,B'11101111'                                  1671 07210000
*   CALL VUCHI;                     /* CHAIN IN BVR          @Y30LB25*/ 07211000
         BAL   @14,VUCHI                                           1672 07212000
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/ 07213000
*     THEN                          /* YES                   @Y30LB25*/ 07214000
         L     @06,RPLVPTR                                         1673 07215000
         LH    @06,RPLVRETC(,@06)                                  1673 07216000
         N     @06,@CF01129                                        1673 07217000
         LTR   @06,@06                                             1673 07218000
         BNZ   @RT01673                                            1673 07219000
*     RETURN;                       /*                       @Y30LB25*/ 07220000
*                                                                  1674 07221000
*   /*****************************************************************/ 07222000
*   /*                                                               */ 07223000
*   /* PROCESS THE DEFINEV EXTENSION.                        @Y30LB25*/ 07224000
*   /*                                                               */ 07225000
*   /*****************************************************************/ 07226000
*                                                                  1675 07227000
*   BCDVPTR=BASEVPTR;               /* SET COMM PTR          @Y30LB25*/ 07228000
         L     @06,BASEVPTR                                        1675 07229000
         ST    @06,BCDVPTR                                         1675 07230000
*   IF DEFVVEXT^=FIXZERO            /* EXTENSION?            @Y30LB25*/ 07231000
*     THEN                                                         1676 07232000
         L     @06,DEFVVEXT(,DEFVPTR)                              1676 07233000
         LTR   @06,@06                                             1676 07234000
         BZ    @RF01676                                            1676 07235000
*     DO;                           /* YES                   @Y30LB25*/ 07236000
*       CALL PRODEFVE;              /* PROCESS DEFVE         @Y30LB25*/ 07237000
         BAL   @14,PRODEFVE                                        1678 07238000
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/ 07239000
*         THEN                      /* YES                   @Y30LB25*/ 07240000
         L     @06,RPLVPTR                                         1679 07241000
         LH    @06,RPLVRETC(,@06)                                  1679 07242000
         N     @06,@CF01129                                        1679 07243000
         LTR   @06,@06                                             1679 07244000
         BNZ   @RT01679                                            1679 07245000
*         RETURN;                   /*                       @Y30LB25*/ 07246000
*     END;                          /*                       @Y30LB25*/ 07247000
*   ELSE                                                           1682 07248000
*     BCDIVCRE=ON;                  /*                       @Y30LB25*/ 07249000
*                                                                  1682 07250000
         B     @RC01676                                            1682 07251000
@RF01676 L     @06,BCDVPTR                                         1682 07252000
         OI    BCDIVCRE(@06),B'10000000'                           1682 07253000
*   /*****************************************************************/ 07254000
*   /*                                                               */ 07255000
*   /* REESTABLISH THE BVR'S RPLV                            @Y30LB25*/ 07256000
*   /*                                                               */ 07257000
*   /*****************************************************************/ 07258000
*                                                                  1683 07259000
*   BVOLKY=DEFVOLD;                 /* SET VOLID             @Y30LB25*/ 07260000
@RC01676 MVC   BVOLKY(6),DEFVOLD(DEFVPTR)                          1683 07261000
*   RPLVKEY=ADDR(BKEY);             /* SET KEY ADDR          @Y30LB25*/ 07262000
         LA    @06,BKEY                                            1684 07263000
         L     @01,RPLVPTR                                         1684 07264000
         ST    @06,RPLVKEY(,@01)                                   1684 07265000
*   CALL READUPD1;                  /* READ BVR              @Y30LB25*/ 07266000
         BAL   @14,READUPD1                                        1685 07267000
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/ 07268000
*     THEN                          /* YES                   @Y30LB25*/ 07269000
         L     @06,RPLVPTR                                         1686 07270000
         LH    @15,RPLVRETC(,@06)                                  1686 07271000
         N     @15,@CF01129                                        1686 07272000
         LTR   @15,@15                                             1686 07273000
         BNZ   @RT01686                                            1686 07274000
*     RETURN;                       /*                       @Y30LB25*/ 07275000
*                                                                  1687 07276000
*   /*****************************************************************/ 07277000
*   /*                                                               */ 07278000
*   /* WRITE THE BVR                                         @Y30LB25*/ 07279000
*   /*                                                               */ 07280000
*   /*****************************************************************/ 07281000
*                                                                  1688 07282000
*   RPLVBUF=ADDR(BASEBUF);          /* PT TO BVR TO WRITE    @Y30LB25*/ 07283000
         LA    @15,BASEBUF                                         1688 07284000
         ST    @15,RPLVBUF(,@06)                                   1688 07285000
*   CALL WRITRECD;                  /* WRITE BVR             @Y30LB25*/ 07286000
         BAL   @14,WRITRECD                                        1689 07287000
*   RETURN;                         /*                       @Y30LB25*/ 07288000
@EL00040 DS    0H                                                  1690 07289000
@EF00040 DS    0H                                                  1690 07290000
@ER00040 L     @14,@SA00040                                        1690 07291000
         BR    @14                                                 1690 07292000
*   END CRTBVR;                     /*                       @Y30LB25*/ 07293000
         B     @EL00040                                            1691 07294000
*                                                                  1692 07295000
*   /*****************************************************************/ 07296000
*   /*                                                               */ 07297000
*   /* PROCEDURE NAME - CRTCVR2                              @Y30LB25*/ 07298000
*   /*                                                       @Y30LB25*/ 07299000
*   /* FUNCTION -                                            @Y30LB25*/ 07300000
*   /* MAKE A PLACE HOLDER CVR INTO A CVR AFTER THE MSC.     @Y30LB25*/ 07301000
*   /*                                                       @Y30LB25*/ 07302000
*   /* INPUT -                                               @Y30LB25*/ 07303000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 07304000
*   /* PLACE HOLDER COPY VOLUME RECORD                       @Y30LB25*/ 07305000
*   /*                                                       @Y30LB25*/ 07306000
*   /* OUTPUT -                                              @Y30LB25*/ 07307000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 07308000
*   /* AN ERROR                                              @Y30LB25*/ 07309000
*   /* COPY VOLUME RECORD                                    @Y30LB25*/ 07310000
*   /*                                                               */ 07311000
*   /*****************************************************************/ 07312000
*                                                                  1692 07313000
*CRTCVR2:                           /*                       @Y30LB25*/ 07314000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 07315000
*                                                                  1692 07316000
CRTCVR2  ST    @14,@SA00041                                        1692 07317000
*   /*****************************************************************/ 07318000
*   /*                                                               */ 07319000
*   /* PROCESS THE DEFINE EXTENSION                          @Y30LB25*/ 07320000
*   /*                                                               */ 07321000
*   /*****************************************************************/ 07322000
*                                                                  1693 07323000
*   BCDVPTR=COPYVPTR;               /* SET COMM PTR          @Y30LB25*/ 07324000
         L     @06,COPYVPTR                                        1693 07325000
         ST    @06,BCDVPTR                                         1693 07326000
*   COPHOLD=OFF;                    /*                       @Y30LB25*/ 07327000
         NI    COPHOLD(@06),B'01111111'                            1694 07328000
*   IF DEFVVEXT^=FIXZERO            /* DEFINE EXTENSION?     @Y30LB25*/ 07329000
*     THEN                          /* YES                   @Y30LB25*/ 07330000
         L     @06,DEFVVEXT(,DEFVPTR)                              1695 07331000
         LTR   @06,@06                                             1695 07332000
         BZ    @RF01695                                            1695 07333000
*     DO;                           /*                       @Y30LB25*/ 07334000
*       CALL PRODEFVE;              /* PROC DEFVE            @Y30LB25*/ 07335000
         BAL   @14,PRODEFVE                                        1697 07336000
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/ 07337000
*         THEN                      /* YES                   @Y30LB25*/ 07338000
         L     @06,RPLVPTR                                         1698 07339000
         LH    @06,RPLVRETC(,@06)                                  1698 07340000
         N     @06,@CF01129                                        1698 07341000
         LTR   @06,@06                                             1698 07342000
         BNZ   @RT01698                                            1698 07343000
*         RETURN;                   /*                       @Y30LB25*/ 07344000
*     END;                          /*                       @Y30LB25*/ 07345000
*   ELSE                                                           1701 07346000
*     BCDIVCPY=ON;                  /*                       @Y30LB25*/ 07347000
*                                                                  1701 07348000
         B     @RC01695                                            1701 07349000
@RF01695 L     @06,BCDVPTR                                         1701 07350000
         OI    BCDIVCPY(@06),B'01000000'                           1701 07351000
*   /*****************************************************************/ 07352000
*   /*                                                               */ 07353000
*   /* REESTABLISH THE CVR'S RPLV                            @Y30LB25*/ 07354000
*   /*                                                               */ 07355000
*   /*****************************************************************/ 07356000
*                                                                  1702 07357000
*   CKEY=COPNAME;                   /* SET KEY               @Y30LB25*/ 07358000
@RC01695 L     @06,COPYVPTR                                        1702 07359000
         MVC   CKEY(13),COPNAME(@06)                               1702 07360000
*   RPLVKEY=ADDR(CKEY);             /* KEY ADDR              @Y30LB25*/ 07361000
         LA    @06,CKEY                                            1703 07362000
         L     @01,RPLVPTR                                         1703 07363000
         ST    @06,RPLVKEY(,@01)                                   1703 07364000
*   CALL READUPD1;                  /* READ CVR              @Y30LB25*/ 07365000
         BAL   @14,READUPD1                                        1704 07366000
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/ 07367000
*     THEN                          /* YES                   @Y30LB25*/ 07368000
         L     @06,RPLVPTR                                         1705 07369000
         LH    @15,RPLVRETC(,@06)                                  1705 07370000
         N     @15,@CF01129                                        1705 07371000
         LTR   @15,@15                                             1705 07372000
         BNZ   @RT01705                                            1705 07373000
*     RETURN;                       /*                       @Y30LB25*/ 07374000
*                                                                  1706 07375000
*   /*****************************************************************/ 07376000
*   /*                                                               */ 07377000
*   /* WRITE THE CVR                                         @Y30LB25*/ 07378000
*   /*                                                               */ 07379000
*   /*****************************************************************/ 07380000
*                                                                  1707 07381000
*   RPLVBUF=COPYVPTR;               /*                       @Y30LB25*/ 07382000
         L     @15,COPYVPTR                                        1707 07383000
         ST    @15,RPLVBUF(,@06)                                   1707 07384000
*   CALL WRITRECD;                  /* WRITE CVR             @Y30LB25*/ 07385000
         BAL   @14,WRITRECD                                        1708 07386000
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/ 07387000
*     THEN                          /* YES                   @Y30LB25*/ 07388000
         L     @06,RPLVPTR                                         1709 07389000
         LH    @06,RPLVRETC(,@06)                                  1709 07390000
         N     @06,@CF01129                                        1709 07391000
         LTR   @06,@06                                             1709 07392000
         BNZ   @RT01709                                            1709 07393000
*     RETURN;                       /*                       @Y30LB25*/ 07394000
*                                                                  1710 07395000
*   /*****************************************************************/ 07396000
*   /*                                                               */ 07397000
*   /* PROCESS THE CVR'S BVR.                                @Y30LB25*/ 07398000
*   /*                                                               */ 07399000
*   /*****************************************************************/ 07400000
*                                                                  1711 07401000
*   ADDSUB=ON;                      /* ADD A CVR             @Y30LB25*/ 07402000
         OI    ADDSUB,B'01000000'                                  1711 07403000
*   CALL ICBVUBVR(COPYVPTR,RPLVPTR,PASSBYTE);/*              @Y30LB25   07404000
*                                      UPDT CVR'S BVR        @Y30LB25*/ 07405000
         L     @15,@CV00769                                        1712 07406000
         LA    @01,@AL01712                                        1712 07407000
         BALR  @14,@15                                             1712 07408000
*   RETURN;                         /*                       @Y30LB25*/ 07409000
@EL00041 DS    0H                                                  1713 07410000
@EF00041 DS    0H                                                  1713 07411000
@ER00041 L     @14,@SA00041                                        1713 07412000
         BR    @14                                                 1713 07413000
*   END CRTCVR2;                    /*                       @Y30LB25*/ 07414000
         B     @EL00041                                            1714 07415000
*                                                                  1715 07416000
*   /*****************************************************************/ 07417000
*   /*                                                               */ 07418000
*   /* PROCEDURE NAME - FNDCVRUP                             @Y30LB25*/ 07419000
*   /*                                                       @Y30LB25*/ 07420000
*   /* FUNCTION -                                            @Y30LB25*/ 07421000
*   /* FIND THE PLACE HOLDER CVR CREATED BEFORE THE          @Y30LB25*/ 07422000
*   /* MSC WAS CALLED.                                       @Y30LB25*/ 07423000
*   /*                                                       @Y30LB25*/ 07424000
*   /* INPUT -                                               @Y30LB25*/ 07425000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 07426000
*   /*                                                       @Y30LB25*/ 07427000
*   /* OUTPUT -                                              @Y30LB25*/ 07428000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 07429000
*   /* AN ERROR                                              @Y30LB25*/ 07430000
*   /* COPY VOLUME RECORD (PLACE HOLDER)                     @Y30LB25*/ 07431000
*   /*                                                               */ 07432000
*   /*****************************************************************/ 07433000
*                                                                  1715 07434000
*FNDCVRUP:                          /*                       @Y30LB25*/ 07435000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 07436000
*                                                                  1715 07437000
FNDCVRUP ST    @14,@SA00042                                        1715 07438000
*   /*****************************************************************/ 07439000
*   /*                                                               */ 07440000
*   /* FIND THE PLACE HOLDER CVR                             @Y30LB25*/ 07441000
*   /*                                                               */ 07442000
*   /*****************************************************************/ 07443000
*                                                                  1716 07444000
*   CVOLKY=DEFVOLD;                 /* SET VOLID             @Y30LB25*/ 07445000
         MVC   CVOLKY(6),DEFVOLD(DEFVPTR)                          1716 07446000
*   CIDKY=FIXONE;                   /* ID = 1                @Y30LB25*/ 07447000
         LA    @06,1                                               1717 07448000
         STC   @06,CIDKY                                           1717 07449000
*   RPLVKEY=ADDR(CKEY);             /* KEY ADDR              @Y30LB25*/ 07450000
         L     @15,RPLVPTR                                         1718 07451000
         LA    @14,CKEY                                            1718 07452000
         ST    @14,RPLVKEY(,@15)                                   1718 07453000
*   RPLVBUF=ADDR(COPYBUF);          /* CVR BUFFER            @Y30LB25*/ 07454000
         LA    @14,COPYBUF                                         1719 07455000
         ST    @14,RPLVBUF(,@15)                                   1719 07456000
*   RPLVBLN=LENGTH(COPYBUF);        /* CVR BUF LENGTH        @Y30LB25*/ 07457000
         MVC   RPLVBLN(4,@15),@CF01103                             1720 07458000
*   RPLVTYP=RPLVREAD;               /* READ                  @Y30LB25*/ 07459000
         MVI   RPLVTYP(@15),X'00'                                  1721 07460000
*   RPLVDIR=ON;                     /* DIRECT                @Y30LB25*/ 07461000
         OI    RPLVDIR(@15),B'01000000'                            1722 07462000
*   RPLVUPD=ON;                     /* UPDATE                @Y30LB25*/ 07463000
         OI    RPLVUPD(@15),B'00000010'                            1723 07464000
*   A=CIDKY;                        /* LOOP CONTROL          @Y30LB25*/ 07465000
         ST    @06,A                                               1724 07466000
*   DO CIDKY=A BY 1 TO 255;         /* FIND CVR              @Y30LB25*/ 07467000
         STC   @06,CIDKY                                           1725 07468000
         B     @DE01725                                            1725 07469000
@DL01725 DS    0H                                                  1726 07470000
*     RESPECIFY                                                    1726 07471000
*       RG1 RSTD;                   /* RESTRICT REG 1        @Y30LB25*/ 07472000
*     RG1=RPLVPTR;                  /* PT TO RPLV            @Y30LB25*/ 07473000
         L     RG1,RPLVPTR                                         1727 07474000
*     CALL ICBVIO00;                /* READ CVR              @Y30LB25*/ 07475000
         L     @15,@CV00762                                        1728 07476000
         BALR  @14,@15                                             1728 07477000
*     RESPECIFY                                                    1729 07478000
*       RG1 UNRSTD;                 /* UNRESTRICT REG 1      @Y30LB25*/ 07479000
*                                                                  1729 07480000
*     /***************************************************************/ 07481000
*     /*                                                             */ 07482000
*     /* CHECK FOR PLACE HOLDER CVR OR AN I/0 ERROR          @Y30LB25*/ 07483000
*     /* OR END OF DATA.                                     @Y30LB25*/ 07484000
*     /*                                                             */ 07485000
*     /***************************************************************/ 07486000
*                                                                  1730 07487000
*     IF(RPLVRETC^=FIXZERO&RPLRCODE^=NORECFND)|(RPLVRETC=FIXZERO&  1730 07488000
*         COPHOLD=ON)               /* CHECK VALID RETURN    @Y30LB25*/ 07489000
*       THEN                                                       1730 07490000
         L     @06,RPLVPTR                                         1730 07491000
         LH    @15,RPLVRETC(,@06)                                  1730 07492000
         N     @15,@CF01129                                        1730 07493000
         LTR   @15,@15                                             1730 07494000
         BZ    @GL00078                                            1730 07495000
         CLC   RPLRCODE(2,@06),@CB00711                            1730 07496000
         BNE   @RT01730                                            1730 07497000
@GL00078 L     @06,RPLVPTR                                         1730 07498000
         LH    @06,RPLVRETC(,@06)                                  1730 07499000
         N     @06,@CF01129                                        1730 07500000
         LTR   @06,@06                                             1730 07501000
         BNZ   @RF01730                                            1730 07502000
         L     @06,COPYVPTR                                        1730 07503000
         TM    COPHOLD(@06),B'10000000'                            1730 07504000
         BO    @RT01730                                            1730 07505000
*       RETURN;                     /*                       @Y30LB25*/ 07506000
*   END;                            /*                       @Y30LB25*/ 07507000
*                                                                  1732 07508000
@RF01730 LA    @06,1                                               1732 07509000
         SLR   @15,@15                                             1732 07510000
         IC    @15,CIDKY                                           1732 07511000
         ALR   @06,@15                                             1732 07512000
         STC   @06,CIDKY                                           1732 07513000
@DE01725 C     @06,@CF00668                                        1732 07514000
         BNH   @DL01725                                            1732 07515000
*   /*****************************************************************/ 07516000
*   /*                                                               */ 07517000
*   /* NO CVR PLACE HOLDER WAS FOUND                         @Y30LB25*/ 07518000
*   /* OCCURRED                                              @Y30LB25*/ 07519000
*   /*                                                               */ 07520000
*   /*****************************************************************/ 07521000
*                                                                  1733 07522000
*   RPLVRETC=FIXFOUR;               /* ERROR RETURN CODE     @Y30LB25*/ 07523000
         L     @06,RPLVPTR                                         1733 07524000
         MVC   RPLVRETC(2,@06),@CH00041                            1733 07525000
*   RPLRCODE=NORECFND;              /* ERROR REASON CODE     @Y30LB25*/ 07526000
         MVC   RPLRCODE(2,@06),@CB00711                            1734 07527000
*   RETURN;                         /*                       @Y30LB25*/ 07528000
@EL00042 DS    0H                                                  1735 07529000
@EF00042 DS    0H                                                  1735 07530000
@ER00042 L     @14,@SA00042                                        1735 07531000
         BR    @14                                                 1735 07532000
*   END FNDCVRUP;                   /*                       @Y30LB25*/ 07533000
         B     @EL00042                                            1736 07534000
*                                                                  1737 07535000
*   /*****************************************************************/ 07536000
*   /*                                                               */ 07537000
*   /* PROCEDURE NAME - ACINACV2                             #Y30LB25*/ 07538000
*   /*                                                       @Y30LB25*/ 07539000
*   /* FUNCTION -                                            @Y30LB25*/ 07540000
*   /* TRANSFER DATA FROM AN ACTIVE TO AN INACTIVE VOLUME    @Y30LB25*/ 07541000
*   /* AFTER THE MSC WAS CALLED.                             @Y30LB25*/ 07542000
*   /* AN ICBCOVC EXTENSION IS REQUIRED.                     @Y30LB25*/ 07543000
*   /* ONE IS NOT SUPPLIED THOUGH DURING USER TASK RECOVERY  @Y30LB25*/ 07544000
*   /*                                                       @Y30LB25*/ 07545000
*   /* INPUT -                                               @Y30LB25*/ 07546000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 07547000
*   /*                                                       @Y30LB25*/ 07548000
*   /* OUTPUT -                                              @Y30LB25*/ 07549000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 07550000
*   /* AN ERROR                                              @Y30LB25*/ 07551000
*   /*                                                               */ 07552000
*   /*****************************************************************/ 07553000
*                                                                  1737 07554000
*ACINACV2:                          /*                       @Y30LB25*/ 07555000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 07556000
ACINACV2 ST    @14,@SA00043                                        1737 07557000
*   IF RPLRCODE^=FIXZERO            /* MSC ERROR?            @Y30LB25*/ 07558000
*     THEN                          /* YES                   @Y30LB25*/ 07559000
         L     @06,RPLVPTR                                         1738 07560000
         LH    @15,RPLRCODE(,@06)                                  1738 07561000
         N     @15,@CF01129                                        1738 07562000
         LTR   @15,@15                                             1738 07563000
         BZ    @RF01738                                            1738 07564000
*     DO;                           /*                       @Y30LB25*/ 07565000
*       RPLVRETC=RPLVRETC&&RPLVRETC;/* ZERO RETN CODE        @Y30LB25*/ 07566000
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       1740 07567000
*       RPLRCODE=RPLRCODE&&RPLRCODE;/* ZERO RESN CODE        @Y30LB25*/ 07568000
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       1741 07569000
*       RETURN;                     /*                       @Y30LB25*/ 07570000
@EL00043 DS    0H                                                  1742 07571000
@EF00043 DS    0H                                                  1742 07572000
@ER00043 L     @14,@SA00043                                        1742 07573000
         BR    @14                                                 1742 07574000
*     END;                          /*                       @Y30LB25*/ 07575000
*   CALL HOUSKEEP;                  /* JRNL RPLV &           @Y30LB25   07576000
*                                      RESERVE .MSVI         @Y30LB25*/ 07577000
*                                                                  1744 07578000
@RF01738 BAL   @14,HOUSKEEP                                        1744 07579000
*   /*****************************************************************/ 07580000
*   /*                                                               */ 07581000
*   /* READ FOR CIR TO GET THE MSVC RECORD.                  @Y30LB25*/ 07582000
*   /* THEN GET THE MSVC RECORD FROM ITS KEY IN THE CIR -    @Y30LB25*/ 07583000
*   /* FOR UPDATE                                            @Y30LB25*/ 07584000
*   /*                                                               */ 07585000
*   /*****************************************************************/ 07586000
*                                                                  1745 07587000
*   IVOLKY=CVOLCSN;                 /* SET UP KEY            @Y30LB25*/ 07588000
         L     @06,CVOLPTR                                         1745 07589000
         MVC   IVOLKY(12),CVOLCSN(@06)                             1745 07590000
*   CALL GETRECUD;                  /* GET RECORD            @Y30LB25*/ 07591000
         BAL   @14,GETRECUD                                        1746 07592000
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/ 07593000
*     THEN                          /* YES                   @Y30LB25*/ 07594000
         L     @06,RPLVPTR                                         1747 07595000
         LH    @06,RPLVRETC(,@06)                                  1747 07596000
         N     @06,@CF01129                                        1747 07597000
         LTR   @06,@06                                             1747 07598000
         BNZ   @RT01747                                            1747 07599000
*     RETURN;                       /*                       @Y30LB25*/ 07600000
*                                                                  1748 07601000
*   /*****************************************************************/ 07602000
*   /*                                                               */ 07603000
*   /* CHECK IF A COPY VOLUME RECORD WAS CREATED BY A        @Y30LB25*/ 07604000
*   /* PREVIOUS CREATE AN INACTIVE VOLUME REQUEST.           @Y30LB25*/ 07605000
*   /*                                                               */ 07606000
*   /*****************************************************************/ 07607000
*                                                                  1749 07608000
*   IF CVOLVEXT^=FIXZERO&COVREUSE=OFF/* DON'T REUSE OLD      @Y30LB25   07609000
*                                      CVR?                  @Y30LB25*/ 07610000
*     THEN                          /* YES                   @Y30LB25*/ 07611000
         L     @06,CVOLPTR                                         1749 07612000
         L     @06,CVOLVEXT(,@06)                                  1749 07613000
         LTR   @06,@06                                             1749 07614000
         BZ    @RF01749                                            1749 07615000
         L     @06,COVCEPTR                                        1749 07616000
         TM    COVREUSE(@06),B'01000000'                           1749 07617000
         BNZ   @RF01749                                            1749 07618000
*     DO;                           /*                       @Y30LB25*/ 07619000
*       COPYBUF=BASEBUF;            /* PLACE CVR IN BUF      @Y30LB25*/ 07620000
         MVC   COPYBUF(224),BASEBUF                                1751 07621000
*       BCDVPTR=COPYVPTR;           /* COMMON MAP            @Y30LB25*/ 07622000
         L     @06,COPYVPTR                                        1752 07623000
         ST    @06,BCDVPTR                                         1752 07624000
*       CALL PROCOVCE;              /* PROCESS COVC EXTEN    @Y30LB25*/ 07625000
         BAL   @14,PROCOVCE                                        1753 07626000
*       BVOLKY=COPSERNO;            /* SERIAL NUMBER         @ZDR2054*/ 07627000
         L     @06,COPYVPTR                                        1754 07628000
         MVC   BVOLKY(6),COPSERNO(@06)                             1754 07629000
*       RPLVKEY=ADDR(BKEY);         /* KEY ADDR              @ZDR2054*/ 07630000
         LA    @06,BKEY                                            1755 07631000
         L     @01,RPLVPTR                                         1755 07632000
         ST    @06,RPLVKEY(,@01)                                   1755 07633000
*       CALL READLOC;               /* READ BVR              @ZDR2054*/ 07634000
         BAL   @14,READLOC                                         1756 07635000
*       IF RPLVRETC^=FIXZERO THEN   /* ERROR?                @ZDR2054*/ 07636000
         L     @06,RPLVPTR                                         1757 07637000
         LH    @15,RPLVRETC(,@06)                                  1757 07638000
         N     @15,@CF01129                                        1757 07639000
         LTR   @15,@15                                             1757 07640000
         BNZ   @RT01757                                            1757 07641000
*         RETURN;                   /* YES                   @ZDR2054*/ 07642000
*       BASEVPTR=RPLVBUF;           /* SET BUF PTR           @ZDR2054*/ 07643000
         L     @06,RPLVBUF(,@06)                                   1759 07644000
         ST    @06,BASEVPTR                                        1759 07645000
*       COPFRESP=BASFRESP;          /* # FREE CYLANDERS      @ZDR2054*/ 07646000
         L     @15,COPYVPTR                                        1760 07647000
         LH    @14,BASFRESP(,@06)                                  1760 07648000
         N     @14,@CF01129                                        1760 07649000
         STH   @14,COPFRESP(,@15)                                  1760 07650000
*       COPLEXT=BASLEXT;            /* # CYL IN LARGEST      @ZDR2054   07651000
*                                      FREE EXTENT           @ZDR2054*/ 07652000
         LH    @14,BASLEXT(,@06)                                   1761 07653000
         N     @14,@CF01129                                        1761 07654000
         STH   @14,COPLEXT(,@15)                                   1761 07655000
*       COPFREXT=BASFREXT;          /* # FREE EXTENTS        @ZDR2054*/ 07656000
         L     @14,BASFREXT(,@06)                                  1762 07657000
         ST    @14,COPFREXT(,@15)                                  1762 07658000
*       IF BASDLSF=ON THEN          /* DOWN LEVEL SPACE?     @ZDR2054*/ 07659000
         TM    BASDLSF(@06),B'10000000'                            1763 07660000
         BNO   @RF01763                                            1763 07661000
*         COPDLSPF=ON;              /* YES                   @ZDR2054*/ 07662000
         OI    COPDLSPF(@15),B'01000000'                           1764 07663000
*       IVOLKY=CVOLCSN;             /* GET CVR               @ZDR2054*/ 07664000
@RF01763 L     @06,CVOLPTR                                         1765 07665000
         MVC   IVOLKY(12),CVOLCSN(@06)                             1765 07666000
*       CALL GETRECUD;              /* READ UPDATE           @ZDR2054*/ 07667000
         BAL   @14,GETRECUD                                        1766 07668000
*       IF RPLVRETC^=FIXZERO THEN   /* ERROR?                @ZDR2054*/ 07669000
         L     @06,RPLVPTR                                         1767 07670000
         LH    @15,RPLVRETC(,@06)                                  1767 07671000
         N     @15,@CF01129                                        1767 07672000
         LTR   @15,@15                                             1767 07673000
         BNZ   @RT01767                                            1767 07674000
*         RETURN;                   /* YES                   @ZDR2054*/ 07675000
*       RPLVBUF=ADDR(COPYBUF);      /* SET CVR BUF PTR       @Y30LB25*/ 07676000
         LA    @15,COPYBUF                                         1769 07677000
         ST    @15,RPLVBUF(,@06)                                   1769 07678000
*       CALL WRITRECD;              /* WRITE CVR             @Y30LB25*/ 07679000
         BAL   @14,WRITRECD                                        1770 07680000
*       RETURN;                     /*                       @Y30LB25*/ 07681000
         B     @EL00043                                            1771 07682000
*     END;                          /*                       @Y30LB25*/ 07683000
*                                                                  1772 07684000
*   /*****************************************************************/ 07685000
*   /*                                                               */ 07686000
*   /* NO COPY VOLUME RECORD WAS PREVIOUSLY CREATED.         @Y30LB25*/ 07687000
*   /*                                                               */ 07688000
*   /*****************************************************************/ 07689000
*                                                                  1773 07690000
*   ELSE                            /* REUSE OLD CVR         @Y30LB25*/ 07691000
*     DO;                           /*                       @Y30LB25*/ 07692000
@RF01749 DS    0H                                                  1774 07693000
*       RPLVTYP=RPLVDEL;            /* DELETE OLD CVR        @Y30LB25*/ 07694000
         L     @06,RPLVPTR                                         1774 07695000
         MVI   RPLVTYP(@06),X'05'                                  1774 07696000
*       RESPECIFY                                                  1775 07697000
*         RG1 RSTD;                 /*                       @Y30LB25*/ 07698000
*       RG1=RPLVPTR;                /* SET RPLV PTR          @Y30LB25*/ 07699000
         LR    RG1,@06                                             1776 07700000
*       CALL ICBVIO00;              /* DELETE CVR            @Y30LB25*/ 07701000
         L     @15,@CV00762                                        1777 07702000
         BALR  @14,@15                                             1777 07703000
*       RESPECIFY                                                  1778 07704000
*         RG1 UNRSTD;               /*                       @Y30LB25*/ 07705000
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/ 07706000
*         THEN                      /* YES                   @Y30LB25*/ 07707000
         L     @06,RPLVPTR                                         1779 07708000
         LH    @06,RPLVRETC(,@06)                                  1779 07709000
         N     @06,@CF01129                                        1779 07710000
         LTR   @06,@06                                             1779 07711000
         BNZ   @RT01779                                            1779 07712000
*         RETURN;                   /*                       @Y30LB25*/ 07713000
*                                                                  1780 07714000
*       /*************************************************************/ 07715000
*       /*                                                           */ 07716000
*       /* UPDATE CVR'S BVR TO REFLECT ITS DELETION.         @Y30LB25*/ 07717000
*       /*                                                           */ 07718000
*       /*************************************************************/ 07719000
*                                                                  1781 07720000
*       ADDSUB=OFF;                 /* CVR DELETED           @Y30LB25*/ 07721000
         NI    ADDSUB,B'10111111'                                  1781 07722000
*       COPYBUF=BASEBUF;            /* CVR IN CVR BUF        @Y30LB25*/ 07723000
         MVC   COPYBUF(224),BASEBUF                                1782 07724000
*       CALL ICBVUBVR(COPYVPTR,RPLVPTR,PASSBYTE);/*          @Y30LB25   07725000
*                                      UPDATE BVR            @Y30LB25*/ 07726000
         L     @15,@CV00769                                        1783 07727000
         LA    @01,@AL01783                                        1783 07728000
         BALR  @14,@15                                             1783 07729000
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/ 07730000
*         THEN                      /* YES                   @Y30LB25*/ 07731000
         L     @06,RPLVPTR                                         1784 07732000
         LH    @15,RPLVRETC(,@06)                                  1784 07733000
         N     @15,@CF01129                                        1784 07734000
         LTR   @15,@15                                             1784 07735000
         BNZ   @RT01784                                            1784 07736000
*         RETURN;                   /*                       @Y30LB25*/ 07737000
*                                                                  1785 07738000
*       /*************************************************************/ 07739000
*       /*                                                           */ 07740000
*       /* GET CVR'S BVR FOR KEY OF NEXT AVAILABLE CVR       @Y30LB25*/ 07741000
*       /*                                                           */ 07742000
*       /*************************************************************/ 07743000
*                                                                  1786 07744000
*       BVOLKY=COPSERNO;            /* BVR VOLID KEY         @Y30LB25*/ 07745000
         L     @01,COPYVPTR                                        1786 07746000
         MVC   BVOLKY(6),COPSERNO(@01)                             1786 07747000
*       RPLVKEY=ADDR(BKEY);         /* KEY ADDR              @Y30LB25*/ 07748000
         LA    @15,BKEY                                            1787 07749000
         ST    @15,RPLVKEY(,@06)                                   1787 07750000
*       CALL READLOC;               /* GET BVR               @Y30LB25*/ 07751000
         BAL   @14,READLOC                                         1788 07752000
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/ 07753000
*         THEN                      /* YES                   @Y30LB25*/ 07754000
         L     @06,RPLVPTR                                         1789 07755000
         LH    @15,RPLVRETC(,@06)                                  1789 07756000
         N     @15,@CF01129                                        1789 07757000
         LTR   @15,@15                                             1789 07758000
         BNZ   @RT01789                                            1789 07759000
*         RETURN;                   /*                       @Y30LB25*/ 07760000
*       BASEVPTR=RPLVBUF;           /* MAP BVR               @Y30LB25*/ 07761000
*                                                                  1791 07762000
         L     @06,RPLVBUF(,@06)                                   1791 07763000
         ST    @06,BASEVPTR                                        1791 07764000
*       /*************************************************************/ 07765000
*       /*                                                           */ 07766000
*       /* CALCULATE THE KEY FOR THE NEXT CVR.               @Y30LB25*/ 07767000
*       /*                                                           */ 07768000
*       /*************************************************************/ 07769000
*                                                                  1792 07770000
*       CALL CALCVRID;              /* GET ID                @Y30LB25*/ 07771000
         BAL   @14,CALCVRID                                        1792 07772000
*       IF RPLVRETC^=FIXZERO&RPLRCODE^=NORECFND/*            @Y30LB25   07773000
*                                      ERROR?                @Y30LB25*/ 07774000
*         THEN                      /* YES                   @Y30LB25*/ 07775000
         L     @06,RPLVPTR                                         1793 07776000
         LH    @15,RPLVRETC(,@06)                                  1793 07777000
         N     @15,@CF01129                                        1793 07778000
         LTR   @15,@15                                             1793 07779000
         BZ    @RF01793                                            1793 07780000
         CLC   RPLRCODE(2,@06),@CB00711                            1793 07781000
         BNE   @RT01793                                            1793 07782000
*         RETURN;                   /*                       @Y30LB25*/ 07783000
*       COPYVPTR=ADDR(COPYBUF);     /* RESET BUF PTR         @Y30LB25*/ 07784000
*                                                                  1795 07785000
@RF01793 LA    @06,COPYBUF                                         1795 07786000
         ST    @06,COPYVPTR                                        1795 07787000
*       /*************************************************************/ 07788000
*       /*                                                           */ 07789000
*       /* USE CVR IN THE CVR BUFFER TO CREATE               @Y30LB25*/ 07790000
*       /* THE NEW CVR.                                      @Y30LB25*/ 07791000
*       /*                                                           */ 07792000
*       /*************************************************************/ 07793000
*                                                                  1796 07794000
*       COPNO=CIDKY;                /* SET NEW ID            @Y30LB25*/ 07795000
         IC    @15,CIDKY                                           1796 07796000
         STC   @15,COPNO(,@06)                                     1796 07797000
*       COPBKUP=OFF;                /* NO BACKUP             @Y30LB25*/ 07798000
         NI    COPBKUP(@06),B'11110111'                            1797 07799000
*       COPDESCR=BLANK30;           /* NULL DESCR            @Y30LB25*/ 07800000
*                                                                  1798 07801000
         MVI   COPDESCR+1(@06),C' '                                1798 07802000
         MVC   COPDESCR+2(28,@06),COPDESCR+1(@06)                  1798 07803000
         MVI   COPDESCR(@06),C' '                                  1798 07804000
*       /*************************************************************/ 07805000
*       /*                                                           */ 07806000
*       /* CHECK FOR RECOVERY AND IF SO USE THE DATE         @ZA13484*/ 07807000
*       /* THE RPLV WAS CREATED.                             @ZA13484*/ 07808000
*       /*                                                           */ 07809000
*       /*************************************************************/ 07810000
*                                                                  1799 07811000
*       IF RPLJRCVY=ON&RPLVDATE^=NULLDATE THEN/* RECOVERY?   @ZA13484*/ 07812000
         L     @15,RPLVPTR                                         1799 07813000
         TM    RPLJRCVY(@15),B'00000010'                           1799 07814000
         BNO   @RF01799                                            1799 07815000
         CLC   RPLVDATE(4,@15),NULLDATE                            1799 07816000
         BE    @RF01799                                            1799 07817000
*         COPDATE=RPLVDATE;         /* DATE                  @ZA13484*/ 07818000
         MVC   COPDATE(4,@06),RPLVDATE(@15)                        1800 07819000
*       ELSE                                                       1801 07820000
*         DO;                       /*                       @ZA13484*/ 07821000
*                                                                  1801 07822000
         B     @RC01799                                            1801 07823000
@RF01799 DS    0H                                                  1802 07824000
*           /*********************************************************/ 07825000
*           /*                                                       */ 07826000
*           /* GET AN SET CURRENT DATE                       @Y30LB25*/ 07827000
*           /*                                                       */ 07828000
*           /*********************************************************/ 07829000
*                                                                  1802 07830000
*           CALL ICBVUEXP(FIXZERO,RPLVPRT,EXPRDT);/*         @ZA30662*/ 07831000
         L     @15,@CV00768                                        1802 07832000
         LA    @01,@AL01802                                        1802 07833000
         BALR  @14,@15                                             1802 07834000
*           COPDATE=EXPRDT;         /* SET CURRENT DATE      @Y30LB25*/ 07835000
         L     @06,COPYVPTR                                        1803 07836000
         MVC   COPDATE(4,@06),EXPRDT                               1803 07837000
*         END;                      /*                       @ZA13484*/ 07838000
*                                                                  1804 07839000
*       /*************************************************************/ 07840000
*       /*                                                           */ 07841000
*       /* SET GROUPED OR NON-GROUPED                        @Y30LB25*/ 07842000
*       /*                                                           */ 07843000
*       /*************************************************************/ 07844000
*                                                                  1805 07845000
*       IF BASGRPV=ON               /* GROUPED?              @Y30LB25*/ 07846000
*         THEN                      /* YES                   @Y30LB25*/ 07847000
@RC01799 L     @06,BASEVPTR                                        1805 07848000
         TM    BASGRPV(@06),B'00100000'                            1805 07849000
         BNO   @RF01805                                            1805 07850000
*         COPGROUP=ON;              /* GROUPED               @Y30LB25*/ 07851000
         L     @06,COPYVPTR                                        1806 07852000
         OI    COPGROUP(@06),B'10000000'                           1806 07853000
*       ELSE                        /* NON-GRPD              @Y30LB25*/ 07854000
*         COPGROUP=OFF;             /*                       @Y30LB25*/ 07855000
*                                                                  1807 07856000
         B     @RC01805                                            1807 07857000
@RF01805 L     @06,COPYVPTR                                        1807 07858000
         NI    COPGROUP(@06),B'01111111'                           1807 07859000
*       /*************************************************************/ 07860000
*       /*                                                           */ 07861000
*       /* CHECK FOR GENERAL-USE                             @Y30LB25*/ 07862000
*       /*                                                           */ 07863000
*       /*************************************************************/ 07864000
*                                                                  1808 07865000
*       IF BASGENUS=ON              /* GEN-USE               @Y30LB25*/ 07866000
*         THEN                      /* YES                   @Y30LB25*/ 07867000
@RC01805 L     @06,BASEVPTR                                        1808 07868000
         TM    BASGENUS(@06),B'00010000'                           1808 07869000
         BNO   @RF01808                                            1808 07870000
*         COPGENUS=ON;              /*                       @Y30LB25*/ 07871000
         L     @06,COPYVPTR                                        1809 07872000
         OI    COPGENUS(@06),B'00100000'                           1809 07873000
*       ELSE                        /* NO GEN-USE            @Y30LB25*/ 07874000
*         COPGENUS=OFF;             /*                       @Y30LB25*/ 07875000
*                                                                  1810 07876000
         B     @RC01808                                            1810 07877000
@RF01808 L     @06,COPYVPTR                                        1810 07878000
         NI    COPGENUS(@06),B'11011111'                           1810 07879000
*       /*************************************************************/ 07880000
*       /*                                                           */ 07881000
*       /* CHECK FOR RESTRICTED                              @Y30LB25*/ 07882000
*       /*                                                           */ 07883000
*       /*************************************************************/ 07884000
*                                                                  1811 07885000
*       IF BASRSTD=ON               /* RESTRICTED?           @Y30LB25*/ 07886000
*         THEN                      /* YES                   @Y30LB25*/ 07887000
@RC01808 L     @06,BASEVPTR                                        1811 07888000
         TM    BASRSTD(@06),B'00001000'                            1811 07889000
         BNO   @RF01811                                            1811 07890000
*         COPRSTD=ON;               /* RESTRICTED            @Y30LB25*/ 07891000
         L     @06,COPYVPTR                                        1812 07892000
         OI    COPRSTD(@06),B'00010000'                            1812 07893000
*       ELSE                        /* NOT RESTRICTED        @Y30LB25*/ 07894000
*         COPRSTD=OFF;              /*                       @Y30LB25*/ 07895000
*                                                                  1813 07896000
         B     @RC01811                                            1813 07897000
@RF01811 L     @06,COPYVPTR                                        1813 07898000
         NI    COPRSTD(@06),B'11101111'                            1813 07899000
*       /*************************************************************/ 07900000
*       /*                                                           */ 07901000
*       /* CHECK FOR DOWN LEVEL SPACE                        @Y30LB25*/ 07902000
*       /*                                                           */ 07903000
*       /*************************************************************/ 07904000
*                                                                  1814 07905000
*       IF BASDLSF=ON               /* DOWN LEVEL SPACE?     @Y30LB25*/ 07906000
*         THEN                      /* YES                   @Y30LB25*/ 07907000
@RC01811 L     @06,BASEVPTR                                        1814 07908000
         TM    BASDLSF(@06),B'10000000'                            1814 07909000
         BNO   @RF01814                                            1814 07910000
*         COPDLSPF=ON;              /* DOWN LEVEL SPACE      @Y30LB25*/ 07911000
         L     @06,COPYVPTR                                        1815 07912000
         OI    COPDLSPF(@06),B'01000000'                           1815 07913000
*       ELSE                        /* NO DOWN SPACE         @Y30LB25*/ 07914000
*         COPDLSPF=OFF;             /*                       @Y30LB25*/ 07915000
*                                                                  1816 07916000
         B     @RC01814                                            1816 07917000
@RF01814 L     @06,COPYVPTR                                        1816 07918000
         NI    COPDLSPF(@06),B'10111111'                           1816 07919000
*       /*************************************************************/ 07920000
*       /*                                                           */ 07921000
*       /* SET SPACE REQUIRMENTS                             @Y30LB25*/ 07922000
*       /*                                                           */ 07923000
*       /*************************************************************/ 07924000
*                                                                  1817 07925000
*       COPFRESP=BASFRESP;          /* FREE SPACE            @Y30LB25*/ 07926000
@RC01814 L     @06,COPYVPTR                                        1817 07927000
         L     @15,BASEVPTR                                        1817 07928000
         LH    @14,BASFRESP(,@15)                                  1817 07929000
         N     @14,@CF01129                                        1817 07930000
         STH   @14,COPFRESP(,@06)                                  1817 07931000
*       COPLEXT=BASLEXT;            /* LARGEST FREE EXTNT    @Y30LB25*/ 07932000
         LH    @14,BASLEXT(,@15)                                   1818 07933000
         N     @14,@CF01129                                        1818 07934000
         STH   @14,COPLEXT(,@06)                                   1818 07935000
*       COPFREXT=BASFREXT;          /* FREE EXTENTS          @Y30LB25*/ 07936000
*                                                                  1819 07937000
         L     @15,BASFREXT(,@15)                                  1819 07938000
         ST    @15,COPFREXT(,@06)                                  1819 07939000
*       /*************************************************************/ 07940000
*       /*                                                           */ 07941000
*       /* PROCESS THE EXTENSION.                            @Y30LB25*/ 07942000
*       /* NOT REQUIRED FOR RECOVERY.                        @Y30LB25*/ 07943000
*       /*                                                           */ 07944000
*       /*************************************************************/ 07945000
*                                                                  1820 07946000
*       BCDVPTR=COPYVPTR;           /* COMMON MAP            #Y30LB25*/ 07947000
         ST    @06,BCDVPTR                                         1820 07948000
*       IF CVOLVEXT^=FIXZERO        /* EXTENSION?            @Y30LB25*/ 07949000
*         THEN                      /* YES                   @Y30LB25*/ 07950000
         L     @06,CVOLPTR                                         1821 07951000
         L     @06,CVOLVEXT(,@06)                                  1821 07952000
         LTR   @06,@06                                             1821 07953000
         BZ    @RF01821                                            1821 07954000
*         CALL PROCOVCE;            /* PROCESS COVC EXTEN    @Y30LB25*/ 07955000
*                                                                  1822 07956000
         BAL   @14,PROCOVCE                                        1822 07957000
*       /*************************************************************/ 07958000
*       /*                                                           */ 07959000
*       /* WRITE THE NEW CVR                                 @Y30LB25*/ 07960000
*       /*                                                           */ 07961000
*       /*************************************************************/ 07962000
*                                                                  1823 07963000
*       RPLVBUF=ADDR(COPYBUF);      /* CVR BUF               @Y30LB25*/ 07964000
@RF01821 L     @06,RPLVPTR                                         1823 07965000
         LA    @15,COPYBUF                                         1823 07966000
         ST    @15,RPLVBUF(,@06)                                   1823 07967000
*       RPLVBLN=LENGTH(COPYBUF);    /* CVR BUF LENGTH        @Y30LB25*/ 07968000
         MVC   RPLVBLN(4,@06),@CF01103                             1824 07969000
*       RPLVRLN=LENGTH(COPYV);      /* CVR LENGTH            @Y30LB25*/ 07970000
         MVC   RPLVRLN(4,@06),@CF01104                             1825 07971000
*       RPLVUPD=OFF;                /* NEW RECORD            @Y30LB25*/ 07972000
         NI    RPLVUPD(@06),B'11111101'                            1826 07973000
*       CALL WRITRECD;              /* WRITE CVR             @Y30LB25*/ 07974000
         BAL   @14,WRITRECD                                        1827 07975000
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/ 07976000
*         THEN                      /* YES                   @Y30LB25*/ 07977000
         L     @06,RPLVPTR                                         1828 07978000
         LH    @06,RPLVRETC(,@06)                                  1828 07979000
         N     @06,@CF01129                                        1828 07980000
         LTR   @06,@06                                             1828 07981000
         BNZ   @RT01828                                            1828 07982000
*         RETURN;                   /*                       @Y30LB25*/ 07983000
*                                                                  1829 07984000
*       /*************************************************************/ 07985000
*       /*                                                           */ 07986000
*       /* UPDATE THE CVR'S BVR TO REFLECT THE NEW CVR       @Y30LB25*/ 07987000
*       /*                                                           */ 07988000
*       /*************************************************************/ 07989000
*                                                                  1830 07990000
*       ADDSUB=ON;                  /* ADD CVR               @Y30LB25*/ 07991000
         OI    ADDSUB,B'01000000'                                  1830 07992000
*       CALL ICBVUBVR(COPYVPTR,RPLVPTR,PASSBYTE);/*          @Y30LB25*/ 07993000
         L     @15,@CV00769                                        1831 07994000
         LA    @01,@AL01831                                        1831 07995000
         BALR  @14,@15                                             1831 07996000
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/ 07997000
*         THEN                      /* YES                   @Y30LB25*/ 07998000
         L     @06,RPLVPTR                                         1832 07999000
         LH    @06,RPLVRETC(,@06)                                  1832 08000000
         N     @06,@CF01129                                        1832 08001000
         LTR   @06,@06                                             1832 08002000
         BNZ   @RT01832                                            1832 08003000
*         RETURN;                   /*                       @Y30LB25*/ 08004000
*                                                                  1833 08005000
*       /*************************************************************/ 08006000
*       /*                                                           */ 08007000
*       /* UPDATE THE CIRS TO POINT TO THE NEW CVR           @Y30LB25*/ 08008000
*       /*                                                           */ 08009000
*       /*************************************************************/ 08010000
*                                                                  1834 08011000
*       CALL UPDCIR;                /* CORRECT CIRS          @Y30LB25*/ 08012000
         BAL   @14,UPDCIR                                          1834 08013000
*       RETURN;                     /*                       @Y30LB25*/ 08014000
         B     @EL00043                                            1835 08015000
*     END;                          /*                       @Y30LB25*/ 08016000
*   END ACINACV2;                   /*                       @Y30LB25*/ 08017000
         B     @EL00043                                            1837 08018000
*                                                                  1838 08019000
*   /*****************************************************************/ 08020000
*   /*                                                               */ 08021000
*   /* PROCEDURE NAME - PROCOVCE                             @Y30LB25*/ 08022000
*   /*                                                       @Y30LB25*/ 08023000
*   /* FUNCTION -                                            @Y30LB25*/ 08024000
*   /* PROCESS IEZCOVCE.                                     @Y30LB25*/ 08025000
*   /*                                                       @Y30LB25*/ 08026000
*   /* INPUT -                                               @Y30LB25*/ 08027000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 08028000
*   /* BASE OR COPY VOLUME RECORD                            @Y30LB25*/ 08029000
*   /*                                                       @Y30LB25*/ 08030000
*   /* OUTPUT -                                              @Y30LB25*/ 08031000
*   /* BASE OR COPY VOLUME RECORD                            @Y30LB25*/ 08032000
*   /*                                                               */ 08033000
*   /*****************************************************************/ 08034000
*                                                                  1838 08035000
*PROCOVCE:                          /*                       @Y30LB25*/ 08036000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 08037000
PROCOVCE ST    @14,@SA00044                                        1838 08038000
*   IF BCDBASE=ON                   /* BVR?                  @Y30LB25*/ 08039000
*     THEN                          /* YES                   @Y30LB25*/ 08040000
         L     @06,BCDVPTR                                         1839 08041000
         TM    BCDBASE(@06),B'00100000'                            1839 08042000
         BNO   @RF01839                                            1839 08043000
*     IF COVSPDES=ON                /* DESCRIP GIVEN?        @Y30LB25*/ 08044000
*       THEN                        /* YES                   @Y30LB25*/ 08045000
         L     @06,COVCEPTR                                        1840 08046000
         TM    COVSPDES(@06),B'10000000'                           1840 08047000
         BNO   @RF01840                                            1840 08048000
*       BASDESCR=COVDESCR;          /* UPDATE DESCR          @Y30LB25*/ 08049000
         L     @01,BASEVPTR                                        1841 08050000
         MVC   BASDESCR(30,@01),COVDESCR(@06)                      1841 08051000
*     ELSE                                                         1842 08052000
*       ;                           /*                       @Y30LB25*/ 08053000
@RF01840 DS    0H                                                  1843 08054000
*   ELSE                            /* CVR                   @Y30LB25*/ 08055000
*     DO;                           /*                       @Y30LB25*/ 08056000
         B     @RC01839                                            1843 08057000
@RF01839 DS    0H                                                  1844 08058000
*       IF COVSPDES=ON              /* DESCRIP GIVEN?        @Y30LB25*/ 08059000
*         THEN                      /* YES                   @Y30LB25*/ 08060000
         L     @06,COVCEPTR                                        1844 08061000
         TM    COVSPDES(@06),B'10000000'                           1844 08062000
         BNO   @RF01844                                            1844 08063000
*         COPDESCR=COVDESCR;        /* UPDATE DESCR          @Y30LB25*/ 08064000
         L     @01,COPYVPTR                                        1845 08065000
         MVC   COPDESCR(30,@01),COVDESCR(@06)                      1845 08066000
*       IF COVSAM=ON                /* VSAM VOL?             @Y30LB25*/ 08067000
*         THEN                      /* YES                   @Y30LB25*/ 08068000
@RF01844 L     @06,COVCEPTR                                        1846 08069000
         TM    COVSAM(@06),B'10000000'                             1846 08070000
         BNO   @RF01846                                            1846 08071000
*         COPVSAM=ON;               /* VSAM VOL              @Y30LB25*/ 08072000
         L     @06,COPYVPTR                                        1847 08073000
         OI    COPVSAM(@06),B'01000000'                            1847 08074000
*     END;                          /*                       @Y30LB25*/ 08075000
*                                                                  1848 08076000
@RF01846 DS    0H                                                  1849 08077000
*   /*****************************************************************/ 08078000
*   /*                                                               */ 08079000
*   /* SET AND/OR CLEAR ERROR RECOVERY FLAGS.                @Y30LB25*/ 08080000
*   /*                                                               */ 08081000
*   /*****************************************************************/ 08082000
*                                                                  1849 08083000
*   CALL SETCLRCV;                  /* PROC FLAGS            @Y30LB25*/ 08084000
@RC01839 BAL   @14,SETCLRCV                                        1849 08085000
*   RETURN;                         /*                       @Y30LB25*/ 08086000
@EL00044 DS    0H                                                  1850 08087000
@EF00044 DS    0H                                                  1850 08088000
@ER00044 L     @14,@SA00044                                        1850 08089000
         BR    @14                                                 1850 08090000
*   END PROCOVCE;                   /*                       @Y30LB25*/ 08091000
*                                                                  1852 08092000
*   /*****************************************************************/ 08093000
*   /*                                                               */ 08094000
*   /* PROCEDURE NAME - TRANDAT2                             @Y30LB25*/ 08095000
*   /*                                                       @Y30LB25*/ 08096000
*   /* FUNCTION -                                            @Y30LB25*/ 08097000
*   /* TRANSFER DATA FROM AN INACTIVE TO AN ACTIVE VOLUME    @Y30LB25*/ 08098000
*   /* AFTER THE MSC WAS CALLED.                             @Y30LB25*/ 08099000
*   /* TRANSFER DATA FROM DASD TO CARTRIDGE AFTER THE        @Y30LB25*/ 08100000
*   /* MSC WAS CALLED.                                       @Y30LB25*/ 08101000
*   /*                                                       @Y30LB25*/ 08102000
*   /* INPUT -                                               @Y30LB25*/ 08103000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 08104000
*   /*                                                       @Y30LB25*/ 08105000
*   /* OUTPUT -                                              @Y30LB25*/ 08106000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 08107000
*   /* AN ERROR                                              @Y30LB25*/ 08108000
*   /*                                                               */ 08109000
*   /*****************************************************************/ 08110000
*                                                                  1852 08111000
*TRANDAT2:                          /*                       @Y30LB25*/ 08112000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 08113000
*                                                                  1852 08114000
TRANDAT2 ST    @14,@SA00045                                        1852 08115000
*   /*****************************************************************/ 08116000
*   /*                                                               */ 08117000
*   /* CHECK MSC RETURN CONDITION.                           @Y30LB25*/ 08118000
*   /*                                                               */ 08119000
*   /*****************************************************************/ 08120000
*                                                                  1853 08121000
*   IF RPLRCODE^=FIXZERO            /* MSC ERROR?            @Y30LB25*/ 08122000
*     THEN                          /* YES                   @Y30LB25*/ 08123000
         L     @06,RPLVPTR                                         1853 08124000
         LH    @15,RPLRCODE(,@06)                                  1853 08125000
         N     @15,@CF01129                                        1853 08126000
         LTR   @15,@15                                             1853 08127000
         BZ    @RF01853                                            1853 08128000
*     DO;                           /*                       @Y30LB25*/ 08129000
*       RPLVRETC=RPLVRETC&&RPLVRETC;/* ZERO RETN CODE        @Y30LB25*/ 08130000
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       1855 08131000
*       RPLRCODE=RPLRCODE&&RPLRCODE;/* ZERO RESN CODE        @Y30LB25*/ 08132000
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       1856 08133000
*       RETURN;                     /*                       @Y30LB25*/ 08134000
@EL00045 DS    0H                                                  1857 08135000
@EF00045 DS    0H                                                  1857 08136000
@ER00045 L     @14,@SA00045                                        1857 08137000
         BR    @14                                                 1857 08138000
*     END;                          /*                       @Y30LB25*/ 08139000
*   CALL HOUSKEEP;                  /* JRNL RPLV &           @Y30LB25   08140000
*                                      RESERVE .MSVI         @Y30LB25*/ 08141000
*                                                                  1859 08142000
@RF01853 BAL   @14,HOUSKEEP                                        1859 08143000
*   /*****************************************************************/ 08144000
*   /*                                                               */ 08145000
*   /* GET BVR.                                              @Y30LB25*/ 08146000
*   /*                                                               */ 08147000
*   /*****************************************************************/ 08148000
*                                                                  1860 08149000
*   BVOLKY=CVOLID;                  /* SET VOLID             @Y30LB25*/ 08150000
         L     @06,CVOLPTR                                         1860 08151000
         MVC   BVOLKY(6),CVOLID(@06)                               1860 08152000
*   RPLVKEY=ADDR(BKEY);             /* KEY ADDR              @Y30LB25*/ 08153000
         LA    @06,BKEY                                            1861 08154000
         L     @01,RPLVPTR                                         1861 08155000
         ST    @06,RPLVKEY(,@01)                                   1861 08156000
*   CALL READUPD1;                  /* READ BVR              @Y30LB25*/ 08157000
         BAL   @14,READUPD1                                        1862 08158000
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/ 08159000
*     THEN                          /* YES                   @Y30LB25*/ 08160000
         L     @06,RPLVPTR                                         1863 08161000
         LH    @06,RPLVRETC(,@06)                                  1863 08162000
         N     @06,@CF01129                                        1863 08163000
         LTR   @06,@06                                             1863 08164000
         BNZ   @RT01863                                            1863 08165000
*     RETURN;                       /*                       @Y30LB25*/ 08166000
*   BASEBUF=BASEBUF1;               /* USE CORRECT BUFF      @Y30LB25*/ 08167000
*                                                                  1865 08168000
         MVC   BASEBUF(224),BASEBUF1                               1865 08169000
*   /*****************************************************************/ 08170000
*   /*                                                               */ 08171000
*   /* CHECK FOR CARTRIDGE TO DASD.                          @Y30LB25*/ 08172000
*   /*                                                               */ 08173000
*   /*****************************************************************/ 08174000
*                                                                  1866 08175000
*   IF CVODASCR=ON                  /* CART TO DASD          @Y30LB25*/ 08176000
*     THEN                          /* YES                   @Y30LB25*/ 08177000
         L     @06,CVOLPTR                                         1866 08178000
         TM    CVODASCR(@06),B'10000000'                           1866 08179000
         BNO   @RF01866                                            1866 08180000
*     BASDLSF=ON;                   /* DOWN LEVEL SPACE      @Y30LB25*/ 08181000
         L     @06,BASEVPTR                                        1867 08182000
         OI    BASDLSF(@06),B'10000000'                            1867 08183000
*   ELSE                                                           1868 08184000
*                                                                  1868 08185000
*     /***************************************************************/ 08186000
*     /*                                                             */ 08187000
*     /* GET CVR FROM THE CIR                                @Y30LB25*/ 08188000
*     /*                                                             */ 08189000
*     /***************************************************************/ 08190000
*                                                                  1868 08191000
*     DO;                           /*                       @Y30LB25*/ 08192000
         B     @RC01866                                            1868 08193000
@RF01866 DS    0H                                                  1869 08194000
*       IVOLKY=CVOLCSN;             /* SET CSN               @Y30LB25*/ 08195000
         L     @06,CVOLPTR                                         1869 08196000
         MVC   IVOLKY(12),CVOLCSN(@06)                             1869 08197000
*       CALL GETRECLC;              /* GET CVR               @Y30LB25*/ 08198000
         BAL   @14,GETRECLC                                        1870 08199000
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/ 08200000
*         THEN                      /* YES                   @Y30LB25*/ 08201000
         L     @06,RPLVPTR                                         1871 08202000
         LH    @15,RPLVRETC(,@06)                                  1871 08203000
         N     @15,@CF01129                                        1871 08204000
         LTR   @15,@15                                             1871 08205000
         BNZ   @RT01871                                            1871 08206000
*         RETURN;                   /*                       @Y30LB25*/ 08207000
*       COPYVPTR=RPLVBUF;           /* MAP BUFFER            @Y30LB25*/ 08208000
*                                                                  1873 08209000
         L     @06,RPLVBUF(,@06)                                   1873 08210000
         ST    @06,COPYVPTR                                        1873 08211000
*       /*************************************************************/ 08212000
*       /*                                                           */ 08213000
*       /* CHECK DOWN LEVEL SPACE FLAG                       @Y30LB25*/ 08214000
*       /*                                                           */ 08215000
*       /*************************************************************/ 08216000
*                                                                  1874 08217000
*       IF COPDLSPF=ON              /* DOWN LEVEL SPACE?     @Y30LB25*/ 08218000
*         THEN                      /* YES                   @Y30LB25*/ 08219000
         TM    COPDLSPF(@06),B'01000000'                           1874 08220000
         BNO   @RF01874                                            1874 08221000
*         BASDLSF=ON;               /* DOWN LEVEL SPACE      @Y30LB25*/ 08222000
         L     @06,BASEVPTR                                        1875 08223000
         OI    BASDLSF(@06),B'10000000'                            1875 08224000
*       ELSE                        /* NO DOWN LEVEL SPC     @Y30LB25*/ 08225000
*         BASDLSF=OFF;              /*                       @Y30LB25*/ 08226000
*                                                                  1876 08227000
         B     @RC01874                                            1876 08228000
@RF01874 L     @06,BASEVPTR                                        1876 08229000
         NI    BASDLSF(@06),B'01111111'                            1876 08230000
*       /*************************************************************/ 08231000
*       /*                                                           */ 08232000
*       /* SET SPACE REQUIRMENTS                             @Y30LB25*/ 08233000
*       /*                                                           */ 08234000
*       /*************************************************************/ 08235000
*                                                                  1877 08236000
*       BASFRESP=COPFRESP;          /* FREE SPACE            @Y30LB25*/ 08237000
@RC01874 L     @06,BASEVPTR                                        1877 08238000
         L     @15,COPYVPTR                                        1877 08239000
         LH    @14,COPFRESP(,@15)                                  1877 08240000
         STH   @14,BASFRESP(,@06)                                  1877 08241000
*       BASLEXT=COPLEXT;            /* LARGE FREE EXTENT     @Y30LB25*/ 08242000
         LH    @14,COPLEXT(,@15)                                   1878 08243000
         STH   @14,BASLEXT(,@06)                                   1878 08244000
*       BASFREXT=COPFREXT;          /* FREE EXTENT           @Y30LB25*/ 08245000
*                                                                  1879 08246000
         L     @15,COPFREXT(,@15)                                  1879 08247000
         ST    @15,BASFREXT(,@06)                                  1879 08248000
*       /*************************************************************/ 08249000
*       /*                                                           */ 08250000
*       /* REESTABLISH THE RPL FOR A WRITE                   @Y30LB25*/ 08251000
*       /*                                                           */ 08252000
*       /*************************************************************/ 08253000
*                                                                  1880 08254000
*       BVOLKY=CVOLID;              /* SET VOLID             @Y30LB25*/ 08255000
         L     @06,CVOLPTR                                         1880 08256000
         MVC   BVOLKY(6),CVOLID(@06)                               1880 08257000
*       RPLVKEY=ADDR(BKEY);         /* SET KEY ADDR          @Y30LB25*/ 08258000
         LA    @06,BKEY                                            1881 08259000
         L     @01,RPLVPTR                                         1881 08260000
         ST    @06,RPLVKEY(,@01)                                   1881 08261000
*       CALL READUPD1;              /* READ BVR              @Y30LB25*/ 08262000
         BAL   @14,READUPD1                                        1882 08263000
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/ 08264000
*         THEN                      /* YES                   @Y30LB25*/ 08265000
         L     @06,RPLVPTR                                         1883 08266000
         LH    @06,RPLVRETC(,@06)                                  1883 08267000
         N     @06,@CF01129                                        1883 08268000
         LTR   @06,@06                                             1883 08269000
         BNZ   @RT01883                                            1883 08270000
*         RETURN;                   /*                       @Y30LB25*/ 08271000
*     END;                          /*                       @Y30LB25*/ 08272000
*                                                                  1885 08273000
*   /*****************************************************************/ 08274000
*   /*                                                               */ 08275000
*   /* CHECK FOR AN ICBCOVC EXTENSION                        @Y30LB25*/ 08276000
*   /*                                                               */ 08277000
*   /*****************************************************************/ 08278000
*                                                                  1886 08279000
*   IF CVOLVEXT^=FIXZERO            /* EXTENSION?            @Y30LB25*/ 08280000
*     THEN                          /* YES                   @Y30LB25*/ 08281000
@RC01866 L     @06,CVOLPTR                                         1886 08282000
         L     @06,CVOLVEXT(,@06)                                  1886 08283000
         LTR   @06,@06                                             1886 08284000
         BZ    @RF01886                                            1886 08285000
*     DO;                           /*                       @Y30LB25*/ 08286000
*       BCDVPTR=BASEVPTR;           /* COMMON MAP            @Y30LB25*/ 08287000
         L     @06,BASEVPTR                                        1888 08288000
         ST    @06,BCDVPTR                                         1888 08289000
*       CALL PROCOVCE;              /*                       @Y30LB25*/ 08290000
         BAL   @14,PROCOVCE                                        1889 08291000
*     END;                          /*                       @Y30LB25*/ 08292000
*                                                                  1890 08293000
*   /*****************************************************************/ 08294000
*   /*                                                               */ 08295000
*   /* WRITE THE BVR                                         @Y30LB25*/ 08296000
*   /*                                                               */ 08297000
*   /*****************************************************************/ 08298000
*                                                                  1891 08299000
*   RPLVBUF=ADDR(BASEBUF);          /* BUFFER ADDR           @Y30LB25*/ 08300000
@RF01886 LA    @06,BASEBUF                                         1891 08301000
         L     @01,RPLVPTR                                         1891 08302000
         ST    @06,RPLVBUF(,@01)                                   1891 08303000
*   CALL WRITRECD;                  /* WRITE BVR             @Y30LB25*/ 08304000
         BAL   @14,WRITRECD                                        1892 08305000
*   RETURN;                         /*                       @Y30LB25*/ 08306000
         B     @EL00045                                            1893 08307000
*   END TRANDAT2;                   /*                       @Y30LB25*/ 08308000
         B     @EL00045                                            1894 08309000
*                                                                  1895 08310000
*   /*****************************************************************/ 08311000
*   /*                                                               */ 08312000
*   /* PROCEDURE NAME - ELINACV2                             @Y30LB25*/ 08313000
*   /*                                                       @Y30LB25*/ 08314000
*   /* FUNCTION -                                            @Y30LB25*/ 08315000
*   /* PROCESS THE ELIMINATION OF AN INACTIVE VOLUME         @Y30LB25*/ 08316000
*   /* AFTER THE MSC WAS CALLED.                             @Y30LB25*/ 08317000
*   /*                                                       @Y30LB25*/ 08318000
*   /* INPUT -                                               @Y30LB25*/ 08319000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 08320000
*   /*                                                       @Y30LB25*/ 08321000
*   /* OUTPUT -                                              @Y30LB25*/ 08322000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 08323000
*   /* AN ERROR                                              @Y30LB25*/ 08324000
*   /*                                                               */ 08325000
*   /*****************************************************************/ 08326000
*                                                                  1895 08327000
*ELINACV2:                          /*                       @Y30LB25*/ 08328000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 08329000
ELINACV2 ST    @14,@SA00046                                        1895 08330000
*   IF RPLRCODE^=FIXZERO            /* MSC ERROR?            @Y30LB25*/ 08331000
*     THEN                          /* YES                   @Y30LB25*/ 08332000
         L     @06,RPLVPTR                                         1896 08333000
         LH    @05,RPLRCODE(,@06)                                  1896 08334000
         N     @05,@CF01129                                        1896 08335000
         LTR   @05,@05                                             1896 08336000
         BZ    @RF01896                                            1896 08337000
*     DO;                           /*                       @Y30LB25*/ 08338000
*       RPLVRETC=RPLVRETC&&RPLVRETC;/* ZERO RETN CODE        @Y30LB25*/ 08339000
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       1898 08340000
*       RPLRCODE=RPLRCODE&&RPLRCODE;/* ZERO RESN CODE        @Y30LB25*/ 08341000
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       1899 08342000
*       RETURN;                     /*                       @Y30LB25*/ 08343000
@EL00046 DS    0H                                                  1900 08344000
@EF00046 DS    0H                                                  1900 08345000
@ER00046 L     @14,@SA00046                                        1900 08346000
         BR    @14                                                 1900 08347000
*     END;                          /*                       @Y30LB25*/ 08348000
*   CALL HOUSKEEP;                  /* JRNL RPLV &           #Y30LB25   08349000
*                                      RESERVE .MSVI         #Y30LB25*/ 08350000
*                                                                  1902 08351000
@RF01896 BAL   @14,HOUSKEEP                                        1902 08352000
*   /*****************************************************************/ 08353000
*   /*                                                               */ 08354000
*   /* READ FOR CIR TO GET THE BVR OR CVR KEY.               #Y30LB25*/ 08355000
*   /* THEN GET THE MSVC RECORD FROM ITS KEY IN THE CIR -    #Y30LB25*/ 08356000
*   /* FOR UPDATE                                            #Y30LB25*/ 08357000
*   /*                                                               */ 08358000
*   /*****************************************************************/ 08359000
*                                                                  1903 08360000
*   IVOLKY=DEFVCSN1;                /* SET UP KEY            #Y30LB25*/ 08361000
         MVC   IVOLKY(12),DEFVCSN1(DEFVPTR)                        1903 08362000
*   CALL GETRECUD;                  /* GET RECORD            #Y30LB25*/ 08363000
         BAL   @14,GETRECUD                                        1904 08364000
*   IF RPLVRETC^=FIXZERO            /* ERROR?                #Y30LB25*/ 08365000
*     THEN                          /* YES                   #Y30LB25*/ 08366000
         L     @06,RPLVPTR                                         1905 08367000
         LH    @15,RPLVRETC(,@06)                                  1905 08368000
         N     @15,@CF01129                                        1905 08369000
         LTR   @15,@15                                             1905 08370000
         BNZ   @RT01905                                            1905 08371000
*     RETURN;                       /*                       #Y30LB25*/ 08372000
*                                                                  1906 08373000
*   /*****************************************************************/ 08374000
*   /*                                                               */ 08375000
*   /* DELETE THE CVR OR BVR.                                @Y30LB25*/ 08376000
*   /*                                                               */ 08377000
*   /*****************************************************************/ 08378000
*                                                                  1907 08379000
*   RPLVTYP=RPLVDEL;                /* DELETE                @Y30LB25*/ 08380000
         MVI   RPLVTYP(@06),X'05'                                  1907 08381000
*   RESPECIFY                                                      1908 08382000
*     RG1 RSTD;                     /* RESTRICT REG 1        @Y30LB25*/ 08383000
*   RG1=RPLVPTR;                    /* RPLV PTR              @Y30LB25*/ 08384000
         LR    RG1,@06                                             1909 08385000
*   CALL ICBVIO00;                  /* DELETE BVR OR CVR     @Y30LB25*/ 08386000
         L     @15,@CV00762                                        1910 08387000
         BALR  @14,@15                                             1910 08388000
*   RESPECIFY                                                      1911 08389000
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @Y30LB25*/ 08390000
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/ 08391000
*     THEN                          /* YES                   @Y30LB25*/ 08392000
         L     @06,RPLVPTR                                         1912 08393000
         LH    @15,RPLVRETC(,@06)                                  1912 08394000
         N     @15,@CF01129                                        1912 08395000
         LTR   @15,@15                                             1912 08396000
         BNZ   @RT01912                                            1912 08397000
*     RETURN;                       /*                       @Y30LB25*/ 08398000
*                                                                  1913 08399000
*   /*****************************************************************/ 08400000
*   /*                                                               */ 08401000
*   /* DELETE THEIR CIRS.                                    @Y30LB25*/ 08402000
*   /*                                                               */ 08403000
*   /*****************************************************************/ 08404000
*                                                                  1914 08405000
*   BCDVPTR=BASEVPTR;               /* COMM MAP              @Y30LB25*/ 08406000
         L     @15,BASEVPTR                                        1914 08407000
         ST    @15,BCDVPTR                                         1914 08408000
*   RPLVBUF=ADDR(INDEXBUF);         /* CIR BUF               @Y30LB25*/ 08409000
         LA    @14,INDEXBUF                                        1915 08410000
         ST    @14,RPLVBUF(,@06)                                   1915 08411000
*   RPLVBLN=LENGTH(INDEXBUF);       /* CIR BUF LENGTH        @Y30LB25*/ 08412000
         MVC   RPLVBLN(4,@06),@CF00339                             1916 08413000
*   RPLVKEY=ADDR(IKEY);             /* KEY ADDR              @Y30LB25*/ 08414000
         LA    @14,IKEY                                            1917 08415000
         ST    @14,RPLVKEY(,@06)                                   1917 08416000
*   IVOLKY=BCDCSN1;                 /* CSN1 TO KEY           @Y30LB25*/ 08417000
         MVC   IVOLKY(12),BCDCSN1(@15)                             1918 08418000
*   CALL DELTRECD;                  /* DELETE CSN1 CIR       @Y30LB25*/ 08419000
         BAL   @14,DELTRECD                                        1919 08420000
*   RPLVRETC=RPLVRETC&&RPLVRETC;    /* IGNORE ERROR          @Y30LB25*/ 08421000
         L     @06,RPLVPTR                                         1920 08422000
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       1920 08423000
*   RPLRCODE=RPLRCODE&&RPLRCODE;    /* IGNORE ERROR          @Y30LB25*/ 08424000
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       1921 08425000
*   IVOLKY=BCDCSN2;                 /* CSN2 TO KEY           @Y30LB25*/ 08426000
         L     @06,BCDVPTR                                         1922 08427000
         MVC   IVOLKY(12),BCDCSN2(@06)                             1922 08428000
*   CALL DELTRECD;                  /* DELETE CSN2 CIR       @Y30LB25*/ 08429000
         BAL   @14,DELTRECD                                        1923 08430000
*   RPLVRETC=RPLVRETC&&RPLVRETC;    /* IGNORE ERROR          @Y30LB25*/ 08431000
         L     @06,RPLVPTR                                         1924 08432000
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       1924 08433000
*   RPLRCODE=RPLRCODE&&RPLRCODE;    /* IGNORE ERROR          @Y30LB25*/ 08434000
*                                                                  1925 08435000
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       1925 08436000
*   /*****************************************************************/ 08437000
*   /*                                                               */ 08438000
*   /* CKECK FOR A BASE VOLUME RECORD.                       @Y30LB25*/ 08439000
*   /* UPDATE ITS GVR OR NGVR.                               @Y30LB25*/ 08440000
*   /*                                                               */ 08441000
*   /*****************************************************************/ 08442000
*                                                                  1926 08443000
*   IF BCDBASE=ON                   /* BVR?                  @Y30LB25*/ 08444000
*     THEN                          /* YES                   @Y30LB25*/ 08445000
         L     @06,BCDVPTR                                         1926 08446000
         TM    BCDBASE(@06),B'00100000'                            1926 08447000
         BNO   @RF01926                                            1926 08448000
*     DO;                           /*                       @Y30LB25*/ 08449000
*       IF BASGRPV=ON               /* GROUPED BVR?          @Y30LB25*/ 08450000
*         THEN                      /* YES                   @Y30LB25*/ 08451000
         L     @06,BASEVPTR                                        1928 08452000
         TM    BASGRPV(@06),B'00100000'                            1928 08453000
         BNO   @RF01928                                            1928 08454000
*         DO;                       /*                       @Y30LB25*/ 08455000
*           CALL INACGVR;           /* DECREM # INAC VOLS    @Y30LB25*/ 08456000
         BAL   @14,INACGVR                                         1930 08457000
*           IF RPLVRETC^=FIXZERO    /* ERROR?                @Y30LB25*/ 08458000
*             THEN                  /* YES                   @Y30LB25*/ 08459000
         L     @06,RPLVPTR                                         1931 08460000
         LH    @06,RPLVRETC(,@06)                                  1931 08461000
         N     @06,@CF01129                                        1931 08462000
         LTR   @06,@06                                             1931 08463000
         BNZ   @RT01931                                            1931 08464000
*             RETURN;               /*                       @Y30LB25*/ 08465000
*         END;                      /*                       @Y30LB25*/ 08466000
*       CALL PROCBVR;               /* PROCESS THE BVR       @Y30LB25*/ 08467000
@RF01928 BAL   @14,PROCBVR                                         1934 08468000
*     END;                          /*                       @Y30LB25*/ 08469000
*                                                                  1935 08470000
*   /*****************************************************************/ 08471000
*   /*                                                               */ 08472000
*   /* CHECK FOR A DELETED COPY VOLUME RECORD                @Y30LB25*/ 08473000
*   /* IF PRESENT, THEN UPDATE THE CVR'S BVR TO REFLECT      @Y30LB25*/ 08474000
*   /* THE DELETION OF THE CVR.                              @Y30LB25*/ 08475000
*   /*                                                               */ 08476000
*   /*****************************************************************/ 08477000
*                                                                  1936 08478000
*   IF BCDCOPY=ON                   /* CVR?                  @Y30LB25*/ 08479000
*     THEN                          /* YES                   @Y30LB25*/ 08480000
@RF01926 L     @06,BCDVPTR                                         1936 08481000
         TM    BCDCOPY(@06),B'00010000'                            1936 08482000
         BNO   @RF01936                                            1936 08483000
*     DO;                           /*                       @Y30LB25*/ 08484000
*       COPYBUF=BASEBUF;            /* CVR TO CVR BUF        @Y30LB25*/ 08485000
         MVC   COPYBUF(224),BASEBUF                                1938 08486000
*       ADDSUB=OFF;                 /* DELETED CVR           @Y30LB25*/ 08487000
         NI    ADDSUB,B'10111111'                                  1939 08488000
*       CALL ICBVUBVR(COPYVPTR,RPLVPTR,PASSBYTE);/*          @Y30LB25   08489000
*                                      UPDATE CVR'S BVR      @Y30LB25*/ 08490000
         L     @15,@CV00769                                        1940 08491000
         LA    @01,@AL01940                                        1940 08492000
         BALR  @14,@15                                             1940 08493000
*     END;                          /*                       @Y30LB25*/ 08494000
*   RETURN;                         /*                       @Y30LB25*/ 08495000
         B     @EL00046                                            1942 08496000
*   END ELINACV2;                   /*                       @Y30LB25*/ 08497000
         B     @EL00046                                            1943 08498000
*                                                                  1944 08499000
*   /*****************************************************************/ 08500000
*   /*                                                               */ 08501000
*   /* PROCEDURE NAME - RENAME1                              @Y30LB25*/ 08502000
*   /*                                                       @Y30LB25*/ 08503000
*   /* FUNCTION -                                            @Y30LB25*/ 08504000
*   /* PROCESS THE RENAME OF AN ACTIVE OR INACTIVE           @Y30LB25*/ 08505000
*   /* VOLUME BEFORE THE MSC IS CALLED.                      @Y30LB25*/ 08506000
*   /*                                                       @Y30LB25*/ 08507000
*   /* INPUT -                                               @Y30LB25*/ 08508000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 08509000
*   /*                                                       @Y30LB25*/ 08510000
*   /* OUTPUT -                                              @Y30LB25*/ 08511000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 08512000
*   /* AN ERROR                                              @Y30LB25*/ 08513000
*   /*                                                               */ 08514000
*   /*****************************************************************/ 08515000
*                                                                  1944 08516000
*RENAME1:                           /*                       @Y30LB25*/ 08517000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 08518000
RENAME1  ST    @14,@SA00047                                        1944 08519000
*   CALL RMSVI;                     /* RESERVE .MSVI         @Y30LB25*/ 08520000
*                                                                  1945 08521000
         BAL   @14,RMSVI                                           1945 08522000
*   /*****************************************************************/ 08523000
*   /*                                                               */ 08524000
*   /* IF NECESSARY, INSURE A GROUP EXISTS                   @VS32198*/ 08525000
*   /*                                                               */ 08526000
*   /*****************************************************************/ 08527000
*                                                                  1946 08528000
*   IF DEFPGRO=ON&DEFVVEXT^=FIXZERO /* GROUP SPECIFIED?      @VS34305*/ 08529000
*     THEN                          /* YES                   @VS32198*/ 08530000
         TM    DEFPGRO(DEFVEPTR),B'00100000'                       1946 08531000
         BNO   @RF01946                                            1946 08532000
         L     @06,DEFVVEXT(,DEFVPTR)                              1946 08533000
         LTR   @06,@06                                             1946 08534000
         BZ    @RF01946                                            1946 08535000
*     DO;                           /*                       @VS32198*/ 08536000
*       GROUPKY=DEFGROUP;           /* SET GROUP NAME        @VS32198*/ 08537000
         MVC   GROUPKY(8),DEFGROUP(DEFVEPTR)                       1948 08538000
*       RPLVKEY=ADDR(GKEY);         /* SET KEY               @VS32198*/ 08539000
         LA    @06,GKEY                                            1949 08540000
         L     @01,RPLVPTR                                         1949 08541000
         ST    @06,RPLVKEY(,@01)                                   1949 08542000
*       CALL READLOC;               /* GET GVR               @VS32198*/ 08543000
         BAL   @14,READLOC                                         1950 08544000
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @VS32198*/ 08545000
*         THEN                      /* YES                   @VS32198*/ 08546000
         L     @06,RPLVPTR                                         1951 08547000
         LH    @15,RPLVRETC(,@06)                                  1951 08548000
         N     @15,@CF01129                                        1951 08549000
         LTR   @15,@15                                             1951 08550000
         BZ    @RF01951                                            1951 08551000
*         DO;                       /*                       @VS32198*/ 08552000
*           IF RPLRCODE=NORECFND    /* NONE FOUND?           @VS32198*/ 08553000
*             THEN                  /* RIGHT                 @VS32198*/ 08554000
         CLC   RPLRCODE(2,@06),@CB00711                            1953 08555000
         BNE   @RF01953                                            1953 08556000
*             RPLRCODE=NOGRPFND;    /*                       @VS32198   08557000
*                                      NO GROUP FND          @VS32198*/ 08558000
         MVC   RPLRCODE(2,@06),@CB00707                            1954 08559000
*           RETURN;                 /*                       @VS32198*/ 08560000
@EL00047 DS    0H                                                  1955 08561000
@EF00047 DS    0H                                                  1955 08562000
@ER00047 L     @14,@SA00047                                        1955 08563000
         BR    @14                                                 1955 08564000
*         END;                      /*                       @VS32198*/ 08565000
*     END;                          /*                       @VS32198*/ 08566000
*                                                                  1957 08567000
@RF01951 DS    0H                                                  1958 08568000
*   /*****************************************************************/ 08569000
*   /*                                                               */ 08570000
*   /* CHECK FOR CREATE A BASE VOLUME RECORD                 #Y30LB25*/ 08571000
*   /* CHECK IF A BVR ALREADY EXISTS FOR DEFVNVOL.           @Y30LB25*/ 08572000
*   /*                                                               */ 08573000
*   /*****************************************************************/ 08574000
*                                                                  1958 08575000
*   BVOLKY=DEFVNVOL;                /* SET VOLID IN KEY      @Y30LB25*/ 08576000
@RF01946 MVC   BVOLKY(6),DEFVNVOL(DEFVPTR)                         1958 08577000
*   RPLVKEY=ADDR(BKEY);             /* SET KEY ADDR          @Y30LB25*/ 08578000
         LA    @06,BKEY                                            1959 08579000
         L     @01,RPLVPTR                                         1959 08580000
         ST    @06,RPLVKEY(,@01)                                   1959 08581000
*   CALL READLOC;                   /* READ FOR BVR          @Y30LB25*/ 08582000
         BAL   @14,READLOC                                         1960 08583000
*   IF RPLRCODE=IOERROR             /* I/O ERROR?            @Y30LB25*/ 08584000
*     THEN                          /* YES                   @Y30LB25*/ 08585000
         L     @06,RPLVPTR                                         1961 08586000
         CLC   RPLRCODE(2,@06),@CB00713                            1961 08587000
         BE    @RT01961                                            1961 08588000
*     RETURN;                       /*                       @Y30LB25*/ 08589000
*                                                                  1962 08590000
*   /*****************************************************************/ 08591000
*   /*                                                               */ 08592000
*   /* CHECK IF BVR ALREADY EXISTS FOR DEFVNVOL              @Y30LB25*/ 08593000
*   /*                                                               */ 08594000
*   /*****************************************************************/ 08595000
*                                                                  1963 08596000
*   IF RPLRCODE=NORECFND            /* NO RECORD FND?        @Y30LB25*/ 08597000
*     THEN                          /* RIGHT                 @Y30LB25*/ 08598000
         CLC   RPLRCODE(2,@06),@CB00711                            1963 08599000
         BNE   @RF01963                                            1963 08600000
*     DO;                           /*                       @Y30LB25*/ 08601000
*       RPLVRETC=RPLVRETC&&RPLVRETC;/* ZERO RETURN CODE      @Y30LB25*/ 08602000
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       1965 08603000
*       RPLRCODE=RPLRCODE&&RPLRCODE;/* ZERO REASON CODE      @Y30LB25*/ 08604000
*                                                                  1966 08605000
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       1966 08606000
*       /*************************************************************/ 08607000
*       /*                                                           */ 08608000
*       /* RENAME AN INACTIVE VOLUME                         @Y30LB25*/ 08609000
*       /*                                                           */ 08610000
*       /*************************************************************/ 08611000
*                                                                  1967 08612000
*       IF DEFVRNTR=ON              /* RENAME INAC VOL?      @Y30LB25*/ 08613000
*         THEN                      /* YES                   @Y30LB25*/ 08614000
         TM    DEFVRNTR(DEFVPTR),B'00000100'                       1967 08615000
         BNO   @RF01967                                            1967 08616000
*         DO;                       /*                       @Y30LB25*/ 08617000
*                                                                  1968 08618000
*           /*********************************************************/ 08619000
*           /*                                                       */ 08620000
*           /* GET MSC RECORD FOR THE INACTIVE VOLUME        @Y30LB25*/ 08621000
*           /*                                                       */ 08622000
*           /*********************************************************/ 08623000
*                                                                  1969 08624000
*           IVOLKY=DEFVCSN1;        /* CSN TO CIR            @Y30LB25*/ 08625000
         MVC   IVOLKY(12),DEFVCSN1(DEFVPTR)                        1969 08626000
*           CALL GETRECLC;          /* GET MSC RECD          @Y30LB25*/ 08627000
         BAL   @14,GETRECLC                                        1970 08628000
*         END;                      /*                       @Y30LB25*/ 08629000
*                                                                  1971 08630000
*       /*************************************************************/ 08631000
*       /*                                                           */ 08632000
*       /* RENAME AN ACTIVE VOLUME                           @Y30LB25*/ 08633000
*       /*                                                           */ 08634000
*       /*************************************************************/ 08635000
*                                                                  1972 08636000
*       ELSE                                                       1972 08637000
*                                                                  1972 08638000
*         /***********************************************************/ 08639000
*         /*                                                         */ 08640000
*         /* GET BVR FOR THE ACTIVE VOLUME                   @Y30LB25*/ 08641000
*         /*                                                         */ 08642000
*         /***********************************************************/ 08643000
*                                                                  1972 08644000
*         DO;                       /*                       @Y30LB25*/ 08645000
         B     @RC01967                                            1972 08646000
@RF01967 DS    0H                                                  1973 08647000
*           BVOLKY=DEFVOLD;         /* VOLID TO BVR          @Y30LB25*/ 08648000
         MVC   BVOLKY(6),DEFVOLD(DEFVPTR)                          1973 08649000
*           RPLVKEY=ADDR(BKEY);     /* SET KEY ADDR          @Y30LB25*/ 08650000
         LA    @06,BKEY                                            1974 08651000
         L     @01,RPLVPTR                                         1974 08652000
         ST    @06,RPLVKEY(,@01)                                   1974 08653000
*           CALL READLOC;           /* GET BVR               @Y30LB25*/ 08654000
         BAL   @14,READLOC                                         1975 08655000
*         END;                      /*                       @Y30LB25*/ 08656000
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/ 08657000
*         THEN                      /* YES                   @Y30LB25*/ 08658000
@RC01967 L     @06,RPLVPTR                                         1977 08659000
         LH    @15,RPLVRETC(,@06)                                  1977 08660000
         N     @15,@CF01129                                        1977 08661000
         LTR   @15,@15                                             1977 08662000
         BNZ   @RT01977                                            1977 08663000
*         RETURN;                   /*                       @Y30LB25*/ 08664000
*                                                                  1978 08665000
*       /*************************************************************/ 08666000
*       /*                                                           */ 08667000
*       /* MSVC RECORD FOR VOLUME TO BE RENAMED EXISTS.      @Y30LB25*/ 08668000
*       /* RENAMED VOLUME IS TO BECOME A BVR.                @Y30LB25*/ 08669000
*       /*                                                           */ 08670000
*       /*************************************************************/ 08671000
*                                                                  1979 08672000
*       BASEBUF=BUFFER;             /* SAVE BVR IN CASE      @Y30LB25   08673000
*                                      GVR IS READ           @Y30LB25*/ 08674000
         L     @06,RPLVBUF(,@06)                                   1979 08675000
         MVC   BASEBUF(224),BUFFER(@06)                            1979 08676000
*       BCDVPTR=BASEVPTR;           /* COMMON MAP            @Y30LB25*/ 08677000
         L     @06,BASEVPTR                                        1980 08678000
         ST    @06,BCDVPTR                                         1980 08679000
*       CALL RENBVR1;               /* PROCESS BVR           @Y30LB25*/ 08680000
         BAL   @14,RENBVR1                                         1981 08681000
*       RETURN;                     /*                       @Y30LB25*/ 08682000
         B     @EL00047                                            1982 08683000
*     END;                          /*                       @Y30LB25*/ 08684000
*                                                                  1983 08685000
*   /*****************************************************************/ 08686000
*   /*                                                               */ 08687000
*   /* CHECK IF THE OLD VOLID EQUALS THE NEW VOLID           @Y30LB25*/ 08688000
*   /* FOR RENAME AN ACTIVE VOLUME                           @Y30LB25*/ 08689000
*   /*                                                               */ 08690000
*   /*****************************************************************/ 08691000
*                                                                  1984 08692000
*   IF DEFVRNM=ON                   /* RENAME ACT VOL?       @Y30LB25*/ 08693000
*     THEN                          /* YES                   @Y30LB25*/ 08694000
@RF01963 TM    DEFVRNM(DEFVPTR),B'00100000'                        1984 08695000
         BNO   @RF01984                                            1984 08696000
*     DO;                           /*                       @Y30LB25*/ 08697000
*       IF DEFVOLD=DEFVNVOL         /* NVOLID = VOLID?       @Y30LB25*/ 08698000
*         THEN                      /* YES                   @Y30LB25*/ 08699000
         CLC   DEFVOLD(6,DEFVPTR),DEFVNVOL(DEFVPTR)                1986 08700000
         BNE   @RF01986                                            1986 08701000
*         DO;                       /*                       @Y30LB25*/ 08702000
*           BASEBUF=BUFFER;         /* SAVE BVR IN CASE      @Y30LB25   08703000
*                                      GVR IS READ           @Y30LB25*/ 08704000
         L     @06,RPLVPTR                                         1988 08705000
         L     @06,RPLVBUF(,@06)                                   1988 08706000
         MVC   BASEBUF(224),BUFFER(@06)                            1988 08707000
*           CALL CKATTRIB;          /*                       @Y30LB25*/ 08708000
         BAL   @14,CKATTRIB                                        1989 08709000
*           RETURN;                 /*                       @Y30LB25*/ 08710000
         B     @EL00047                                            1990 08711000
*         END;                      /*                       @Y30LB25*/ 08712000
*     END;                          /*                       @Y30LB25*/ 08713000
*                                                                  1992 08714000
@RF01986 DS    0H                                                  1993 08715000
*   /*****************************************************************/ 08716000
*   /*                                                               */ 08717000
*   /* CHECK IF THE OLD VOLID EQUALS THE NEW VOLID           @Y30LB25*/ 08718000
*   /* RENAME AN INACTIVE VOLUME.                            @Y30LB25*/ 08719000
*   /*                                                               */ 08720000
*   /*****************************************************************/ 08721000
*                                                                  1993 08722000
*   IF DEFVRNTR=ON                  /* RENAME INACT VOL?     @Y30LB25*/ 08723000
*     THEN                          /* YES                   @Y30LB25*/ 08724000
@RF01984 TM    DEFVRNTR(DEFVPTR),B'00000100'                       1993 08725000
         BNO   @RF01993                                            1993 08726000
*     DO;                           /*                       @Y30LB25*/ 08727000
*       IVOLKY=DEFVCSN1;            /* SET CSN               @Y30LB25*/ 08728000
         MVC   IVOLKY(12),DEFVCSN1(DEFVPTR)                        1995 08729000
*       CALL GETRECLC;              /* GET MSVC RECORD       @Y30LB25*/ 08730000
         BAL   @14,GETRECLC                                        1996 08731000
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/ 08732000
*         THEN                      /* YES                   @Y30LB25*/ 08733000
         L     @06,RPLVPTR                                         1997 08734000
         LH    @15,RPLVRETC(,@06)                                  1997 08735000
         N     @15,@CF01129                                        1997 08736000
         LTR   @15,@15                                             1997 08737000
         BNZ   @RT01997                                            1997 08738000
*         RETURN;                   /*                       @Y30LB25*/ 08739000
*       BCDVPTR=RPLVBUF;            /* PT TO RECORD          @Y30LB25*/ 08740000
         L     @06,RPLVBUF(,@06)                                   1999 08741000
         ST    @06,BCDVPTR                                         1999 08742000
*       IF BCDSERNO=DEFVNVOL        /* SAME VOLIDS?          @Y30LB25*/ 08743000
*         THEN                      /* YES                   @Y30LB25*/ 08744000
         CLC   BCDSERNO(6,@06),DEFVNVOL(DEFVPTR)                   2000 08745000
         BE    @RT02000                                            2000 08746000
*         RETURN;                   /*                       @Y30LB25*/ 08747000
*     END;                          /*                       @Y30LB25*/ 08748000
*                                                                  2002 08749000
*   /*****************************************************************/ 08750000
*   /*                                                               */ 08751000
*   /* BVR EXISTS FOR DEFVNVOL. CHECK IF A DVR CAN           @Y30LB25*/ 08752000
*   /* BE CREATED. AN ICBDEFV EXTENSION MUST EXIST.          @Y30LB25*/ 08753000
*   /*                                                               */ 08754000
*   /*****************************************************************/ 08755000
*                                                                  2003 08756000
*   IF DEFVVEXT^=FIXZERO&DEFDUP=ON  /* CREATE A DVR?         @Y30LB25*/ 08757000
*     THEN                          /* YES                   @Y30LB25*/ 08758000
@RF01993 L     @06,DEFVVEXT(,DEFVPTR)                              2003 08759000
         LTR   @06,@06                                             2003 08760000
         BZ    @RF02003                                            2003 08761000
         TM    DEFDUP(DEFVEPTR),B'00100000'                        2003 08762000
         BNO   @RF02003                                            2003 08763000
*     DO;                           /*                       @Y30LB25*/ 08764000
*       CALL ELACREN1;              /* PROCESS BVR           @Y30LB25*/ 08765000
         BAL   @14,ELACREN1                                        2005 08766000
*       RETURN;                     /*                       @Y30LB25*/ 08767000
         B     @EL00047                                            2006 08768000
*     END;                          /*                       @Y30LB25*/ 08769000
*                                                                  2007 08770000
*   /*****************************************************************/ 08771000
*   /*                                                               */ 08772000
*   /* ERROR - BVR EXISTS FOR DEFVNVOL AND CAN'T             @Y30LB25*/ 08773000
*   /* CREATE A DVR.                                         @Y30LB25*/ 08774000
*   /*                                                               */ 08775000
*   /*****************************************************************/ 08776000
*                                                                  2008 08777000
*   RPLVRETC=FIXFOUR;               /* ERROR RETN CODE       @Y30LB25*/ 08778000
@RF02003 L     @06,RPLVPTR                                         2008 08779000
         MVC   RPLVRETC(2,@06),@CH00041                            2008 08780000
*   RPLRCODE=NODVRSPC;              /* DVR NO SPECIFIED      @Y30LB25*/ 08781000
         MVC   RPLRCODE(2,@06),@CB00705                            2009 08782000
*   RETURN;                         /*                       @Y30LB25*/ 08783000
         B     @EL00047                                            2010 08784000
*   END RENAME1;                    /*                       @Y30LB25*/ 08785000
         B     @EL00047                                            2011 08786000
*                                                                  2012 08787000
*   /*****************************************************************/ 08788000
*   /*                                                               */ 08789000
*   /* PROCEDURE NAME - RENBVR1                              @Y30LB25*/ 08790000
*   /*                                                       @Y30LB25*/ 08791000
*   /* FUNCTION -                                            @Y30LB25*/ 08792000
*   /* MAKE CHECKS FOR RENAME A VOLUME WHICH WILL            @Y30LB25*/ 08793000
*   /* RESULT IN A BVR BEING CREATED. CALLED BEFORE THE      @Y30LB25*/ 08794000
*   /* MSC IS CALLED.                                        @Y30LB25*/ 08795000
*   /*                                                       @Y30LB25*/ 08796000
*   /* INPUT -                                               @Y30LB25*/ 08797000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 08798000
*   /* RPLVBUF - MSC RECORD MAPPED BY BCDVPTR                @Y30LB25*/ 08799000
*   /*                                                       @Y30LB25*/ 08800000
*   /* OUTPUT -                                              @Y30LB25*/ 08801000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 08802000
*   /* AN ERROR                                              @Y30LB25*/ 08803000
*   /* PLACE HOLDER BASE VOLUME RECORD                       @Y30LB25*/ 08804000
*   /*                                                               */ 08805000
*   /*****************************************************************/ 08806000
*                                                                  2012 08807000
*RENBVR1:                           /*                       @Y30LB25*/ 08808000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 08809000
*                                                                  2012 08810000
RENBVR1  ST    @14,@SA00048                                        2012 08811000
*   /*****************************************************************/ 08812000
*   /*                                                               */ 08813000
*   /* CHECK FOR A BVR                                       @Y30LB25*/ 08814000
*   /*                                                               */ 08815000
*   /*****************************************************************/ 08816000
*                                                                  2013 08817000
*   IF BCDBASE=ON                   /* BVR?                  @Y30LB25*/ 08818000
*     THEN                          /* YES                   @Y30LB25*/ 08819000
         L     @06,BCDVPTR                                         2013 08820000
         TM    BCDBASE(@06),B'00100000'                            2013 08821000
         BNO   @RF02013                                            2013 08822000
*     DO;                           /*                       @Y30LB25*/ 08823000
*       BASEVPTR=BCDVPTR;           /* BVR MAP               @Y30LB25*/ 08824000
*                                                                  2015 08825000
         ST    @06,BASEVPTR                                        2015 08826000
*       /*************************************************************/ 08827000
*       /*                                                           */ 08828000
*       /* CHECK FOR RENAME AN ACTIVE VOLUME                 @Y30LB25*/ 08829000
*       /*                                                           */ 08830000
*       /*************************************************************/ 08831000
*                                                                  2016 08832000
*       IF DEFVRNM=ON               /* RENAME ACT VOL?       @Y30LB25*/ 08833000
*         THEN                      /* YES                   @Y30LB25*/ 08834000
         TM    DEFVRNM(DEFVPTR),B'00100000'                        2016 08835000
         BNO   @RF02016                                            2016 08836000
*         DO;                       /*                       @Y30LB25*/ 08837000
*                                                                  2017 08838000
*           /*********************************************************/ 08839000
*           /*                                                       */ 08840000
*           /* CHECK THE ATTRIBUTES                          @Y30LB25*/ 08841000
*           /*                                                       */ 08842000
*           /*********************************************************/ 08843000
*                                                                  2018 08844000
*           CALL CKATTRIB;          /* CK ATTRIBUTES         @Y30LB25*/ 08845000
         BAL   @14,CKATTRIB                                        2018 08846000
*           IF RPLVRETC^=FIXZERO    /* ERROR?                @Y30LB25*/ 08847000
*             THEN                  /* YES                   @Y30LB25*/ 08848000
         L     @06,RPLVPTR                                         2019 08849000
         LH    @06,RPLVRETC(,@06)                                  2019 08850000
         N     @06,@CF01129                                        2019 08851000
         LTR   @06,@06                                             2019 08852000
         BNZ   @RT02019                                            2019 08853000
*             RETURN;               /*                       @Y30LB25*/ 08854000
*         END;                      /*                       @Y30LB25*/ 08855000
*                                                                  2021 08856000
*       /*************************************************************/ 08857000
*       /*                                                           */ 08858000
*       /* CHECK FOR VALID 'TO' OR 'FOR' EXPIRATION DATE     @Y30LB25*/ 08859000
*       /*                                                           */ 08860000
*       /*************************************************************/ 08861000
*                                                                  2022 08862000
*       CALL EXPCK;                 /* CK TO OR FOR          @Y30LB25*/ 08863000
@RF02016 BAL   @14,EXPCK                                           2022 08864000
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/ 08865000
*         THEN                      /* YES                   @Y30LB25*/ 08866000
         L     @06,RPLVPTR                                         2023 08867000
         LH    @06,RPLVRETC(,@06)                                  2023 08868000
         N     @06,@CF01129                                        2023 08869000
         LTR   @06,@06                                             2023 08870000
         BNZ   @RT02023                                            2023 08871000
*         RETURN;                   /*                       @Y30LB25*/ 08872000
*                                                                  2024 08873000
*       /*************************************************************/ 08874000
*       /*                                                           */ 08875000
*       /* CHECK IF COPIES EXIST AND STOP COPIES             @Y30LB25*/ 08876000
*       /* FROM BEING MADE                                   @Y30LB25*/ 08877000
*       /*                                                           */ 08878000
*       /*************************************************************/ 08879000
*                                                                  2025 08880000
*       CALL ELACREN1;              /* CK COPIES             @Y30LB25*/ 08881000
         BAL   @14,ELACREN1                                        2025 08882000
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/ 08883000
*         THEN                      /* YES                   @Y30LB25*/ 08884000
         L     @06,RPLVPTR                                         2026 08885000
         LH    @06,RPLVRETC(,@06)                                  2026 08886000
         N     @06,@CF01129                                        2026 08887000
         LTR   @06,@06                                             2026 08888000
         BNZ   @RT02026                                            2026 08889000
*         RETURN;                   /*                       @Y30LB25*/ 08890000
*     END;                          /*                       @Y30LB25*/ 08891000
*                                                                  2028 08892000
*   /*****************************************************************/ 08893000
*   /*                                                               */ 08894000
*   /* CREATE A PLACE HOLDER BVR FOR DEFVNVOL                @Y30LB25*/ 08895000
*   /*                                                               */ 08896000
*   /*****************************************************************/ 08897000
*                                                                  2029 08898000
*   BVOLKY=DEFVNVOL;                /* SET VOLID IN KEY      @Y30LB25*/ 08899000
@RF02013 MVC   BVOLKY(6),DEFVNVOL(DEFVPTR)                         2029 08900000
*   CALL CRTPHOLD;                  /* CRT PLACE HOLD BVR    @Y30LB25*/ 08901000
         BAL   @14,CRTPHOLD                                        2030 08902000
*   RETURN;                         /*                       @Y30LB25*/ 08903000
@EL00048 DS    0H                                                  2031 08904000
@EF00048 DS    0H                                                  2031 08905000
@ER00048 L     @14,@SA00048                                        2031 08906000
         BR    @14                                                 2031 08907000
*   END RENBVR1;                    /*                       @Y30LB25*/ 08908000
         B     @EL00048                                            2032 08909000
*                                                                  2033 08910000
*   /*****************************************************************/ 08911000
*   /*                                                               */ 08912000
*   /* PROCEDURE NAME - ELACREN1                             @Y30LB25*/ 08913000
*   /*                                                       @Y30LB25*/ 08914000
*   /* FUNCTION -                                            @Y30LB25*/ 08915000
*   /* MAKE CHECKS FOR RENAME AN ACTIVE OR INACTIVE          @Y30LB25*/ 08916000
*   /* VOLUME WHICH WILL RESULT IN A BVR OR DVR              @Y30LB25*/ 08917000
*   /* BEING CREATED. ALSO, MAKES CHECKS FOR ELIMINATE       @Y30LB25*/ 08918000
*   /* AN ACTIVE VOLUME. IN EITHER CASE, THE RESULT          @Y30LB25*/ 08919000
*   /* IS NO COPIES WILL BE ALLOWED. IT IT CALLED            @Y30LB25*/ 08920000
*   /* BEFORE THE MSC IS CALLED.                             @Y30LB25*/ 08921000
*   /*                                                       @Y30LB25*/ 08922000
*   /* INPUT -                                               @Y30LB25*/ 08923000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 08924000
*   /* RPLVBUF - BVR RECORD MAPPED BY BCDVPTR                @Y30LB25*/ 08925000
*   /*                                                       @Y30LB25*/ 08926000
*   /* OUTPUT -                                              @Y30LB25*/ 08927000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 08928000
*   /* AN ERROR                                              @Y30LB25*/ 08929000
*   /*                                                               */ 08930000
*   /*****************************************************************/ 08931000
*                                                                  2033 08932000
*ELACREN1:                          /*                       @Y30LB25*/ 08933000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 08934000
*                                                                  2033 08935000
ELACREN1 ST    @14,@SA00049                                        2033 08936000
*   /*****************************************************************/ 08937000
*   /*                                                               */ 08938000
*   /* CHECK FOR RENAME AN INACTIVE VOLUME                   @Y30LB25*/ 08939000
*   /*                                                               */ 08940000
*   /*****************************************************************/ 08941000
*                                                                  2034 08942000
*   IF DEFVRNTR=ON                  /* RENAME INACT VOL?     @Y30LB25*/ 08943000
*     THEN                          /* YES                   @Y30LB25*/ 08944000
         TM    DEFVRNTR(DEFVPTR),B'00000100'                       2034 08945000
         BNO   @RF02034                                            2034 08946000
*     DO;                           /*                       @Y30LB25*/ 08947000
*                                                                  2035 08948000
*       /*************************************************************/ 08949000
*       /*                                                           */ 08950000
*       /* GET MSC RECORD TO BE RENAMED                      @Y30LB25*/ 08951000
*       /*                                                           */ 08952000
*       /*************************************************************/ 08953000
*                                                                  2036 08954000
*       IVOLKY=DEFVCSN1;            /* SET CSN IN CIR        @Y30LB25*/ 08955000
         MVC   IVOLKY(12),DEFVCSN1(DEFVPTR)                        2036 08956000
*       CALL GETRECUD;              /* GET RECORD            @Y30LB25*/ 08957000
         BAL   @14,GETRECUD                                        2037 08958000
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/ 08959000
*         THEN                      /* YES                   @Y30LB25*/ 08960000
         L     @06,RPLVPTR                                         2038 08961000
         LH    @06,RPLVRETC(,@06)                                  2038 08962000
         N     @06,@CF01129                                        2038 08963000
         LTR   @06,@06                                             2038 08964000
         BNZ   @RT02038                                            2038 08965000
*         RETURN;                   /*                       @Y30LB25*/ 08966000
*                                                                  2039 08967000
*       /*************************************************************/ 08968000
*       /*                                                           */ 08969000
*       /* NEED ONLY A BVR                                   @Y30LB25*/ 08970000
*       /*                                                           */ 08971000
*       /*************************************************************/ 08972000
*                                                                  2040 08973000
*       BCDVPTR=ADDR(BASEBUF);      /* COMMON MAP            @Y30LB25*/ 08974000
         LA    @06,BASEBUF                                         2040 08975000
         ST    @06,BCDVPTR                                         2040 08976000
*       IF BCDCOPY=ON|BCDDUP=ON     /* DVR OR CVR?           @Y30LB25*/ 08977000
*         THEN                      /* YES                   @Y30LB25*/ 08978000
         TM    BCDCOPY(@06),B'00010100'                            2041 08979000
         BNZ   @RT02041                                            2041 08980000
*         RETURN;                   /*                       @Y30LB25*/ 08981000
*     END;                          /*                       @Y30LB25*/ 08982000
*                                                                  2043 08983000
*   /*****************************************************************/ 08984000
*   /*                                                               */ 08985000
*   /* RENAME AN ACTIVE VOLUME OR ELIMINATE AN ACTIVE        @Y30LB25*/ 08986000
*   /* VOLUME                                                @Y30LB25*/ 08987000
*   /*                                                               */ 08988000
*   /*****************************************************************/ 08989000
*                                                                  2044 08990000
*   ELSE                                                           2044 08991000
*     DO;                           /*                       @Y30LB25*/ 08992000
         B     @RC02034                                            2044 08993000
@RF02034 DS    0H                                                  2045 08994000
*       BVOLKY=DEFVOLD;             /* VOLID TO KEY          @Y30LB25*/ 08995000
         MVC   BVOLKY(6),DEFVOLD(DEFVPTR)                          2045 08996000
*       RPLVKEY=ADDR(BKEY);         /* SET KEY ADDR          @Y30LB25*/ 08997000
         LA    @06,BKEY                                            2046 08998000
         L     @05,RPLVPTR                                         2046 08999000
         ST    @06,RPLVKEY(,@05)                                   2046 09000000
*       CALL READUPD1;              /* READ BVR              @Y30LB25*/ 09001000
         BAL   @14,READUPD1                                        2047 09002000
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/ 09003000
*         THEN                      /* YES                   @Y30LB25*/ 09004000
         L     @06,RPLVPTR                                         2048 09005000
         LH    @06,RPLVRETC(,@06)                                  2048 09006000
         N     @06,@CF01129                                        2048 09007000
         LTR   @06,@06                                             2048 09008000
         BNZ   @RT02048                                            2048 09009000
*         RETURN;                   /*                       @Y30LB25*/ 09010000
*       BASEBUF=BASEBUF1;           /* SWAP BUFFERS          @Y30LB25*/ 09011000
         MVC   BASEBUF(224),BASEBUF1                               2050 09012000
*     END;                          /*                       @Y30LB25*/ 09013000
*                                                                  2051 09014000
*   /*****************************************************************/ 09015000
*   /*                                                               */ 09016000
*   /* CHECK FOR COPIES                                      @Y30LB25*/ 09017000
*   /*                                                               */ 09018000
*   /*****************************************************************/ 09019000
*                                                                  2052 09020000
*   BASEVPTR=ADDR(BASEBUF);         /* MAP BVR               @Y30LB25*/ 09021000
@RC02034 LA    @06,BASEBUF                                         2052 09022000
         ST    @06,BASEVPTR                                        2052 09023000
*   IF BASNCOPY^=FIXZERO            /* ANY COPIES?           @Y30LB25*/ 09024000
*     THEN                          /* YES                   @Y30LB25*/ 09025000
         CLI   BASNCOPY(@06),0                                     2053 09026000
         BE    @RF02053                                            2053 09027000
*     DO;                           /*                       @Y30LB25*/ 09028000
*       RPLVRETC=FIXFOUR;           /* ERROR RETURN CODE     @Y30LB25*/ 09029000
         L     @06,RPLVPTR                                         2055 09030000
         MVC   RPLVRETC(2,@06),@CH00041                            2055 09031000
*       RPLRCODE=BVRWCOPS;          /* BVR HAS COPIES        @Y30LB25*/ 09032000
         MVC   RPLRCODE(2,@06),@CB00739                            2056 09033000
*       RETURN;                     /*                       @Y30LB25*/ 09034000
@EL00049 DS    0H                                                  2057 09035000
@EF00049 DS    0H                                                  2057 09036000
@ER00049 L     @14,@SA00049                                        2057 09037000
         BR    @14                                                 2057 09038000
*     END;                          /*                       @Y30LB25*/ 09039000
*                                                                  2058 09040000
*   /*****************************************************************/ 09041000
*   /*                                                               */ 09042000
*   /* ALLOW NO MORE COPIES                                  @Y30LB25*/ 09043000
*   /*                                                               */ 09044000
*   /*****************************************************************/ 09045000
*                                                                  2059 09046000
*   BASNOCPY=ON;                    /* CAN'T COPY            @Y30LB25*/ 09047000
*                                                                  2059 09048000
@RF02053 L     @06,BASEVPTR                                        2059 09049000
         OI    BASNOCPY(@06),B'01000000'                           2059 09050000
*   /*****************************************************************/ 09051000
*   /*                                                               */ 09052000
*   /* WRITE THE BVR                                         @Y30LB25*/ 09053000
*   /*                                                               */ 09054000
*   /*****************************************************************/ 09055000
*                                                                  2060 09056000
*   RPLVBUF=ADDR(BASEBUF);          /* RESET BUF ADDR        @Y30LB25*/ 09057000
         LA    @06,BASEBUF                                         2060 09058000
         L     @05,RPLVPTR                                         2060 09059000
         ST    @06,RPLVBUF(,@05)                                   2060 09060000
*   CALL WRITRECD;                  /* WRITE BVR             @Y30LB25*/ 09061000
         BAL   @14,WRITRECD                                        2061 09062000
*   RETURN;                         /*                       @Y30LB25*/ 09063000
         B     @EL00049                                            2062 09064000
*   END ELACREN1;                   /*                       @Y30LB25*/ 09065000
         B     @EL00049                                            2063 09066000
*                                                                  2064 09067000
*   /*****************************************************************/ 09068000
*   /*                                                               */ 09069000
*   /* PROCEDURE NAME - RENAME2                              @Y30LB25*/ 09070000
*   /*                                                       @Y30LB25*/ 09071000
*   /* FUNCTION -                                            @Y30LB25*/ 09072000
*   /* PROCESS THE RENAME OF AN ACTIVE OR INACTIVE           @Y30LB25*/ 09073000
*   /* VOLUME AFTER THE MSC WAS CALLED.                      @Y30LB25*/ 09074000
*   /*                                                       @Y30LB25*/ 09075000
*   /* INPUT -                                               @Y30LB25*/ 09076000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 09077000
*   /*                                                       @Y30LB25*/ 09078000
*   /* OUTPUT -                                              @Y30LB25*/ 09079000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 09080000
*   /* AN ERROR                                              @Y30LB25*/ 09081000
*   /*                                                               */ 09082000
*   /*****************************************************************/ 09083000
*                                                                  2064 09084000
*RENAME2:                           /*                       @Y30LB25*/ 09085000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 09086000
RENAME2  ST    @14,@SA00050                                        2064 09087000
*   CALL HOUSKEEP;                  /* JRNL RPLV &           @VS32198   09088000
*                                      RESERVE .MSVI         @VS32198*/ 09089000
*                                                                  2065 09090000
         BAL   @14,HOUSKEEP                                        2065 09091000
*   /*****************************************************************/ 09092000
*   /*                                                               */ 09093000
*   /* CHECK FOR AN MSC ERROR.                               @Y30LB25*/ 09094000
*   /*                                                               */ 09095000
*   /*****************************************************************/ 09096000
*                                                                  2066 09097000
*   IF RPLRCODE^=FIXZERO            /* MSC ERROR?            @Y30LB25*/ 09098000
*     THEN                          /* YES                   @Y30LB25*/ 09099000
         L     @06,RPLVPTR                                         2066 09100000
         LH    @15,RPLRCODE(,@06)                                  2066 09101000
         N     @15,@CF01129                                        2066 09102000
         LTR   @15,@15                                             2066 09103000
         BZ    @RF02066                                            2066 09104000
*     DO;                           /*                       @Y30LB25*/ 09105000
*       RPLVRETC=RPLVRETC&&RPLVRETC;/* ZERO RETN CODE        @Y30LB25*/ 09106000
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       2068 09107000
*       RPLRCODE=RPLRCODE&&RPLRCODE;/* ZERO REASN CODE       @Y30LB25*/ 09108000
*                                                                  2069 09109000
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       2069 09110000
*       /*************************************************************/ 09111000
*       /*                                                           */ 09112000
*       /* DELETE PLACE HOLDER BVR AND ALLOW COPIES,         @Y30LB25*/ 09113000
*       /* IF RENAME AN ACTIVE VOLUME AND THE NVOLID EQUALS  @Y30LB25*/ 09114000
*       /* THE OLD VOLID.                                    @Y30LB25*/ 09115000
*       /*                                                           */ 09116000
*       /*************************************************************/ 09117000
*                                                                  2070 09118000
*       IF DEFVRNM=ON&DEFVOLD^=DEFVNVOL/* RENAME ACT VOL &   @Y30LB25*/ 09119000
*         THEN                      /* OVOLID ^= NVOLID      @Y30LB25*/ 09120000
         TM    DEFVRNM(DEFVPTR),B'00100000'                        2070 09121000
         BNO   @RF02070                                            2070 09122000
         CLC   DEFVOLD(6,DEFVPTR),DEFVNVOL(DEFVPTR)                2070 09123000
         BE    @RF02070                                            2070 09124000
*         CALL RMSCERR2;            /* DELETE BEFORE MSC     @Y30LB25   09125000
*                                      PROCESSING            @Y30LB25*/ 09126000
*                                                                  2071 09127000
         BAL   @14,RMSCERR2                                        2071 09128000
*       /*************************************************************/ 09129000
*       /*                                                           */ 09130000
*       /* CHECK FOR RENAME AN INACTIVE VOLUME.              @Y30LB25*/ 09131000
*       /* DELETE PLACE HOLDER BVR AND ALLOW COPIES          @Y30LB25*/ 09132000
*       /* IF VOLIDS ARE NOT EQUAL.                          @Y30LB25*/ 09133000
*       /*                                                           */ 09134000
*       /*************************************************************/ 09135000
*                                                                  2072 09136000
*       IF DEFVRNTR=ON              /* RENAME INACT VOL?     @Y30LB25*/ 09137000
*         THEN                      /* YES                   @Y30LB25*/ 09138000
@RF02070 TM    DEFVRNTR(DEFVPTR),B'00000100'                       2072 09139000
         BNO   @RF02072                                            2072 09140000
*         DO;                       /*                       @Y30LB25*/ 09141000
*           IVOLKY=DEFVCSN1;        /* SET CSN IN KEY        @Y30LB25*/ 09142000
         MVC   IVOLKY(12),DEFVCSN1(DEFVPTR)                        2074 09143000
*           CALL GETRECLC;          /* GET BVR               @Y30LB25*/ 09144000
         BAL   @14,GETRECLC                                        2075 09145000
*           IF RPLVRETC^=FIXZERO    /* ERROR?                @Y30LB25*/ 09146000
*             THEN                  /* YES                   @Y30LB25*/ 09147000
         L     @06,RPLVPTR                                         2076 09148000
         LH    @06,RPLVRETC(,@06)                                  2076 09149000
         N     @06,@CF01129                                        2076 09150000
         LTR   @06,@06                                             2076 09151000
         BNZ   @RT02076                                            2076 09152000
*             RETURN;               /*                       @Y30LB25*/ 09153000
*           IF BCDSERNO^=DEFVNVOL   /* VOLS NOT =?           @Y30LB25*/ 09154000
*             THEN                  /* YES                   @Y30LB25*/ 09155000
         L     @06,BCDVPTR                                         2078 09156000
         CLC   BCDSERNO(6,@06),DEFVNVOL(DEFVPTR)                   2078 09157000
         BE    @RF02078                                            2078 09158000
*             CALL RMSCERR2;        /* DELETE BEFORE MSC     @Y30LB25   09159000
*                                      PROCESSING            @Y30LB25*/ 09160000
         BAL   @14,RMSCERR2                                        2079 09161000
*         END;                      /*                       @Y30LB25*/ 09162000
*                                                                  2080 09163000
@RF02078 DS    0H                                                  2081 09164000
*       /*************************************************************/ 09165000
*       /*                                                           */ 09166000
*       /* RETURN ZERO RETURN AND REASON CODE                @Y30LB25*/ 09167000
*       /*                                                           */ 09168000
*       /*************************************************************/ 09169000
*                                                                  2081 09170000
*       RPLVRETC=RPLVRETC&&RPLVRETC;/* ZERO RETN CODE        @Y30LB25*/ 09171000
@RF02072 L     @06,RPLVPTR                                         2081 09172000
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       2081 09173000
*       RPLRCODE=RPLRCODE&&RPLRCODE;/* ZERO RESN CODE        @Y30LB25*/ 09174000
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       2082 09175000
*       RETURN;                     /*                       @Y30LB25*/ 09176000
@EL00050 DS    0H                                                  2083 09177000
@EF00050 DS    0H                                                  2083 09178000
@ER00050 L     @14,@SA00050                                        2083 09179000
         BR    @14                                                 2083 09180000
*     END;                          /*                       @Y30LB25*/ 09181000
*                                                                  2084 09182000
*   /*****************************************************************/ 09183000
*   /*                                                               */ 09184000
*   /* GET THE MSVC RECORD FOR THE VOLUME TO BE RENAMED      @Y30LB25*/ 09185000
*   /*                                                               */ 09186000
*   /*****************************************************************/ 09187000
*                                                                  2085 09188000
*   CALL RDRENUPD;                  /* GET MSVC RECORD       @Y30LB25*/ 09189000
@RF02066 BAL   @14,RDRENUPD                                        2085 09190000
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/ 09191000
*     THEN                          /* YES                   @Y30LB25*/ 09192000
         L     @06,RPLVPTR                                         2086 09193000
         LH    @06,RPLVRETC(,@06)                                  2086 09194000
         N     @06,@CF01129                                        2086 09195000
         LTR   @06,@06                                             2086 09196000
         BNZ   @RT02086                                            2086 09197000
*     RETURN;                       /*                       @Y30LB25*/ 09198000
*   BCDVPTR=ADDR(BASEBUF);          /* COMMON MAP            @Y30LB25*/ 09199000
*                                                                  2088 09200000
         LA    @06,BASEBUF                                         2088 09201000
         ST    @06,BCDVPTR                                         2088 09202000
*   /*****************************************************************/ 09203000
*   /*                                                               */ 09204000
*   /* CHECK FOR RENAME AN ACTIVE VOLUME AND                 @Y30LB25*/ 09205000
*   /* OLD VOLID IS EQUAL TO NEW VOLID                       @Y30LB25*/ 09206000
*   /*                                                               */ 09207000
*   /*****************************************************************/ 09208000
*                                                                  2089 09209000
*   IF DEFVRNM=ON&DEFVOLD=DEFVNVOL  /* VOLIDS = &            @Y30LB25*/ 09210000
*     THEN                          /* RENAME ACT VOL?       @Y30LB25*/ 09211000
         TM    DEFVRNM(DEFVPTR),B'00100000'                        2089 09212000
         BNO   @RF02089                                            2089 09213000
         CLC   DEFVOLD(6,DEFVPTR),DEFVNVOL(DEFVPTR)                2089 09214000
         BNE   @RF02089                                            2089 09215000
*     DO;                           /* YES                   @Y30LB25*/ 09216000
*                                                                  2090 09217000
*       /*************************************************************/ 09218000
*       /*                                                           */ 09219000
*       /* CHECK FOR ICBDEFV EXTENSION                       @Y30LB25*/ 09220000
*       /*                                                           */ 09221000
*       /*************************************************************/ 09222000
*                                                                  2091 09223000
*       IF DEFVVEXT^=FIXZERO        /* EXTENSION?            @Y30LB25*/ 09224000
*         THEN                      /* YES                   @Y30LB25*/ 09225000
         L     @06,DEFVVEXT(,DEFVPTR)                              2091 09226000
         LTR   @06,@06                                             2091 09227000
         BZ    @RF02091                                            2091 09228000
*         DO;                       /*                       @Y30LB25*/ 09229000
*           CALL PRODEFVE;          /* PROCESS EXTENS        @Y30LB25*/ 09230000
         BAL   @14,PRODEFVE                                        2093 09231000
*           IF RPLVRETC^=FIXZERO    /* ERROR?                @Y30LB25*/ 09232000
*             THEN                  /* YES                   @Y30LB25*/ 09233000
         L     @06,RPLVPTR                                         2094 09234000
         LH    @06,RPLVRETC(,@06)                                  2094 09235000
         N     @06,@CF01129                                        2094 09236000
         LTR   @06,@06                                             2094 09237000
         BNZ   @RT02094                                            2094 09238000
*             RETURN;               /*                       @Y30LB25*/ 09239000
*         END;                      /*                       @Y30LB25*/ 09240000
*                                                                  2096 09241000
*       /*************************************************************/ 09242000
*       /*                                                           */ 09243000
*       /* MAKE BASE VOLUME INACTIVE                         @Y30LB25*/ 09244000
*       /*                                                           */ 09245000
*       /*************************************************************/ 09246000
*                                                                  2097 09247000
*       BASINAC=ON;                 /* INACT VOL             @Y30LB25*/ 09248000
*                                                                  2097 09249000
@RF02091 L     @06,BASEVPTR                                        2097 09250000
         OI    BASINAC(@06),B'00000100'                            2097 09251000
*       /*************************************************************/ 09252000
*       /*                                                           */ 09253000
*       /* CHECK OWNER ID                                    @Y30LB25*/ 09254000
*       /*                                                           */ 09255000
*       /*************************************************************/ 09256000
*                                                                  2098 09257000
*       IF DEFOWNID(1:10)^=FIX10ZRO /* OWNER ID?             @Y30LB25*/ 09258000
*         THEN                      /* YES                   @Y30LB25*/ 09259000
         CLC   DEFOWNID(10,DEFVPTR),@CB00681                       2098 09260000
         BE    @RF02098                                            2098 09261000
*         BASOWNER=DEFOWNID;        /* SET NEW OWNER         @Y30LB25*/ 09262000
*                                                                  2099 09263000
         MVC   BASOWNER(10,@06),DEFOWNID(DEFVPTR)                  2099 09264000
*       /*************************************************************/ 09265000
*       /*                                                           */ 09266000
*       /* CHECK IF ATTRIBUTES SPECIFIED                     @Y30LB25*/ 09267000
*       /*                                                           */ 09268000
*       /*************************************************************/ 09269000
*                                                                  2100 09270000
*       IF DEFVVFLG^=FIX1F          /* NEW ATTRB?            @Y30LB25*/ 09271000
*         THEN                      /* YES                   @Y30LB25*/ 09272000
@RF02098 CLI   DEFVVFLG(DEFVPTR),X'FF'                             2100 09273000
         BE    @RF02100                                            2100 09274000
*         CALL SETATTRB;            /* SET ATTRIBUTES        @Y30LB25*/ 09275000
*                                                                  2101 09276000
         BAL   @14,SETATTRB                                        2101 09277000
*       /*************************************************************/ 09278000
*       /*                                                           */ 09279000
*       /* VOLUME IS NOW INACTIVE, UPDATE ITS GVR AND        @Y30LB25*/ 09280000
*       /* GVSNER SLOT AS NECESSARY.                         @Y30LB25*/ 09281000
*       /*                                                           */ 09282000
*       /*************************************************************/ 09283000
*                                                                  2102 09284000
*       CALL ACTINAC;               /* BVR INACT NOW         @Y30LB25*/ 09285000
@RF02100 BAL   @14,ACTINAC                                         2102 09286000
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/ 09287000
*         THEN                      /* YES                   @Y30LB25*/ 09288000
         L     @06,RPLVPTR                                         2103 09289000
         LH    @06,RPLVRETC(,@06)                                  2103 09290000
         N     @06,@CF01129                                        2103 09291000
         LTR   @06,@06                                             2103 09292000
         BNZ   @RT02103                                            2103 09293000
*         RETURN;                   /*                       @Y30LB25*/ 09294000
*                                                                  2104 09295000
*       /*************************************************************/ 09296000
*       /*                                                           */ 09297000
*       /* REESTABLISH THE RPL FOR THE BVR                   @Y30LB25*/ 09298000
*       /*                                                           */ 09299000
*       /*************************************************************/ 09300000
*                                                                  2105 09301000
*       COPYBUF=BASEBUF;            /* SAVE BVR              @Y30LB25*/ 09302000
         MVC   COPYBUF(224),BASEBUF                                2105 09303000
*       CALL RDRENUPD;              /* GET MSVC RECORD       @Y30LB25*/ 09304000
         BAL   @14,RDRENUPD                                        2106 09305000
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/ 09306000
*         THEN                      /* YES                   @Y30LB25*/ 09307000
         L     @06,RPLVPTR                                         2107 09308000
         LH    @15,RPLVRETC(,@06)                                  2107 09309000
         N     @15,@CF01129                                        2107 09310000
         LTR   @15,@15                                             2107 09311000
         BNZ   @RT02107                                            2107 09312000
*         RETURN;                   /*                       @Y30LB25*/ 09313000
*                                                                  2108 09314000
*       /*************************************************************/ 09315000
*       /*                                                           */ 09316000
*       /* WRITE THE BVR                                     @Y30LB25*/ 09317000
*       /*                                                           */ 09318000
*       /*************************************************************/ 09319000
*                                                                  2109 09320000
*       RPLVBUF=ADDR(COPYBUF);      /* ADDR OF BVR BUF       @Y30LB25*/ 09321000
         LA    @15,COPYBUF                                         2109 09322000
         ST    @15,RPLVBUF(,@06)                                   2109 09323000
*       CALL WRITRECD;              /* WRITE THE BVR         @Y30LB25*/ 09324000
         BAL   @14,WRITRECD                                        2110 09325000
*       RETURN;                     /*                       @Y30LB25*/ 09326000
         B     @EL00050                                            2111 09327000
*     END;                          /*                       @Y30LB25*/ 09328000
*                                                                  2112 09329000
*   /*****************************************************************/ 09330000
*   /*                                                               */ 09331000
*   /* CHECK FOR RENAME AN INACTIVE VOLUME AND               @Y30LB25*/ 09332000
*   /* OLD VOLID IS EQUAL TO NEW VOLID                       @Y30LB25*/ 09333000
*   /*                                                               */ 09334000
*   /*****************************************************************/ 09335000
*                                                                  2113 09336000
*   IF DEFVRNTR=ON&BCDSERNO=DEFVNVOL/* RENAME INACT VOL&     @Y30LB25*/ 09337000
*     THEN                          /* VOLIDS = ?            @Y30LB25*/ 09338000
@RF02089 TM    DEFVRNTR(DEFVPTR),B'00000100'                       2113 09339000
         BNO   @RF02113                                            2113 09340000
         L     @06,BCDVPTR                                         2113 09341000
         CLC   BCDSERNO(6,@06),DEFVNVOL(DEFVPTR)                   2113 09342000
         BNE   @RF02113                                            2113 09343000
*     DO;                           /* YES                   @Y30LB25*/ 09344000
*                                                                  2114 09345000
*       /*************************************************************/ 09346000
*       /*                                                           */ 09347000
*       /* CHECK FOR AN ICBDEFV EXTENSION AND A CVR OR BVR   @Y30LB25*/ 09348000
*       /*                                                           */ 09349000
*       /*************************************************************/ 09350000
*                                                                  2115 09351000
*       IF DEFVVEXT^=FIXZERO&BCDDUP=OFF THEN                       2115 09352000
         L     @15,DEFVVEXT(,DEFVPTR)                              2115 09353000
         LTR   @15,@15                                             2115 09354000
         BZ    @RF02115                                            2115 09355000
         TM    BCDDUP(@06),B'00000100'                             2115 09356000
         BNZ   @RF02115                                            2115 09357000
*         DO;                       /*                       @Y30LB25*/ 09358000
*           CALL PRODEFVE;          /* PROCESS EXTENS        @Y30LB25*/ 09359000
         BAL   @14,PRODEFVE                                        2117 09360000
*           IF RPLVRETC^=FIXZERO    /* ERROR?                @Y30LB25*/ 09361000
*             THEN                  /* YES                   @Y30LB25*/ 09362000
         L     @06,RPLVPTR                                         2118 09363000
         LH    @06,RPLVRETC(,@06)                                  2118 09364000
         N     @06,@CF01129                                        2118 09365000
         LTR   @06,@06                                             2118 09366000
         BNZ   @RT02118                                            2118 09367000
*             RETURN;               /*                       @Y30LB25*/ 09368000
*         END;                      /*                       @Y30LB25*/ 09369000
*                                                                  2120 09370000
*       /*************************************************************/ 09371000
*       /*                                                           */ 09372000
*       /* RENAME AN INACTIVE VOLUME TO ITSELF ONLY          @Y30LB25*/ 09373000
*       /* SUPPORTS OWNER ID AND ATTRIBITES IF THE VOLUME    @Y30LB25*/ 09374000
*       /* BEING RENAMED IS A BVR                            @Y30LB25*/ 09375000
*       /* CHECK OWNER ID                                    @Y30LB25*/ 09376000
*       /*                                                           */ 09377000
*       /*************************************************************/ 09378000
*                                                                  2121 09379000
*       IF DEFOWNID(1:10)^=FIX10ZRO&BCDBASE=ON/*             @Y30LB25*/ 09380000
*         THEN                      /*                       @Y30LB25*/ 09381000
@RF02115 CLC   DEFOWNID(10,DEFVPTR),@CB00681                       2121 09382000
         BE    @RF02121                                            2121 09383000
         L     @06,BCDVPTR                                         2121 09384000
         TM    BCDBASE(@06),B'00100000'                            2121 09385000
         BNO   @RF02121                                            2121 09386000
*         BASOWNER=DEFOWNID;        /* SET NEW OWNER         @Y30LB25*/ 09387000
*                                                                  2122 09388000
         L     @06,BASEVPTR                                        2122 09389000
         MVC   BASOWNER(10,@06),DEFOWNID(DEFVPTR)                  2122 09390000
*       /*************************************************************/ 09391000
*       /*                                                           */ 09392000
*       /* CHECK IF ATTRIBUTES SPECIFIED                     @Y30LB25*/ 09393000
*       /*                                                           */ 09394000
*       /*************************************************************/ 09395000
*                                                                  2123 09396000
*       IF DEFVVFLG^=FIX1F&BCDBASE=ON/* NEW ATTRB?           @Y30LB25*/ 09397000
*         THEN                      /* YES                   @Y30LB25*/ 09398000
@RF02121 CLI   DEFVVFLG(DEFVPTR),X'FF'                             2123 09399000
         BE    @RF02123                                            2123 09400000
         L     @06,BCDVPTR                                         2123 09401000
         TM    BCDBASE(@06),B'00100000'                            2123 09402000
         BNO   @RF02123                                            2123 09403000
*         CALL SETATTRB;            /* SET ATTRIBUTES        @Y30LB25*/ 09404000
*                                                                  2124 09405000
         BAL   @14,SETATTRB                                        2124 09406000
*       /*************************************************************/ 09407000
*       /*                                                           */ 09408000
*       /* REESTABLISH THE RPL FOR THE BVR                   @Y30LB25*/ 09409000
*       /*                                                           */ 09410000
*       /*************************************************************/ 09411000
*                                                                  2125 09412000
*       COPYBUF=BASEBUF;            /* SAVE BVR              @Y30LB25*/ 09413000
@RF02123 MVC   COPYBUF(224),BASEBUF                                2125 09414000
*       CALL RDRENUPD;              /* GET MSVC RECORD       @Y30LB25*/ 09415000
         BAL   @14,RDRENUPD                                        2126 09416000
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/ 09417000
*         THEN                      /* YES                   @Y30LB25*/ 09418000
         L     @06,RPLVPTR                                         2127 09419000
         LH    @15,RPLVRETC(,@06)                                  2127 09420000
         N     @15,@CF01129                                        2127 09421000
         LTR   @15,@15                                             2127 09422000
         BNZ   @RT02127                                            2127 09423000
*         RETURN;                   /*                       @Y30LB25*/ 09424000
*                                                                  2128 09425000
*       /*************************************************************/ 09426000
*       /*                                                           */ 09427000
*       /* WRITE THE BVR                                     @Y30LB25*/ 09428000
*       /*                                                           */ 09429000
*       /*************************************************************/ 09430000
*                                                                  2129 09431000
*       RPLVBUF=ADDR(COPYBUF);      /* ADDR OF BVR BUF       @Y30LB25*/ 09432000
         LA    @15,COPYBUF                                         2129 09433000
         ST    @15,RPLVBUF(,@06)                                   2129 09434000
*       CALL WRITRECD;              /* WRITE THE BVR         @Y30LB25*/ 09435000
         BAL   @14,WRITRECD                                        2130 09436000
*       RETURN;                     /*                       @Y30LB25*/ 09437000
         B     @EL00050                                            2131 09438000
*     END;                          /*                       @Y30LB25*/ 09439000
*                                                                  2132 09440000
*   /*****************************************************************/ 09441000
*   /*                                                               */ 09442000
*   /* OLD VOLID IS NOT EQUAL TO THE NEW VOLID.              @Y30LB25*/ 09443000
*   /* GET AND DELETE THE RECORD TO BE RENAMED.              @Y30LB25*/ 09444000
*   /* RECORD WILL BE RETURNED IN BASEBUF.                   @Y30LB25*/ 09445000
*   /* RECORD IS A CVR OR BVR OR DVR.                        @Y30LB25*/ 09446000
*   /*                                                               */ 09447000
*   /*****************************************************************/ 09448000
*                                                                  2133 09449000
*   CALL PROCDREC;                  /* DELT REN'D RECD       @Y30LB25*/ 09450000
@RF02113 BAL   @14,PROCDREC                                        2133 09451000
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/ 09452000
*     THEN                          /* YES                   @Y30LB25*/ 09453000
         L     @06,RPLVPTR                                         2134 09454000
         LH    @15,RPLVRETC(,@06)                                  2134 09455000
         N     @15,@CF01129                                        2134 09456000
         LTR   @15,@15                                             2134 09457000
         BNZ   @RT02134                                            2134 09458000
*     RETURN;                       /*                       @Y30LB25*/ 09459000
*   BCDVPTR=ADDR(BASEBUF);          /* COMMON MAP            @Y30LB25*/ 09460000
*                                                                  2136 09461000
         LA    @15,BASEBUF                                         2136 09462000
         ST    @15,BCDVPTR                                         2136 09463000
*   /*****************************************************************/ 09464000
*   /*                                                               */ 09465000
*   /* CHECK IF A PLACE HOLDER BVR EXISTS.                   @Y30LB25*/ 09466000
*   /*                                                               */ 09467000
*   /*****************************************************************/ 09468000
*                                                                  2137 09469000
*   BVOLKY=DEFVNVOL;                /* SET VOLID             @Y30LB25*/ 09470000
         MVC   BVOLKY(6),DEFVNVOL(DEFVPTR)                         2137 09471000
*   RPLVKEY=ADDR(BKEY);             /* SET KEY ADDR          @Y30LB25*/ 09472000
         LA    @15,BKEY                                            2138 09473000
         ST    @15,RPLVKEY(,@06)                                   2138 09474000
*   CALL READUPD1;                  /* GET PLACE HOLD        @Y30LB25   09475000
*                                      BVR                   @Y30LB25*/ 09476000
         BAL   @14,READUPD1                                        2139 09477000
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/ 09478000
*     THEN                          /* YES                   @Y30LB25*/ 09479000
         L     @06,RPLVPTR                                         2140 09480000
         LH    @06,RPLVRETC(,@06)                                  2140 09481000
         N     @06,@CF01129                                        2140 09482000
         LTR   @06,@06                                             2140 09483000
         BNZ   @RT02140                                            2140 09484000
*     RETURN;                       /*                       @Y30LB25*/ 09485000
*   BASEVPTR=ADDR(BASEBUF1);        /* MAP PLACE HOLD BVR    @Y30LB25*/ 09486000
*                                                                  2142 09487000
         LA    @06,BASEBUF1                                        2142 09488000
         ST    @06,BASEVPTR                                        2142 09489000
*   /*****************************************************************/ 09490000
*   /*                                                               */ 09491000
*   /* CHECK IF A DVR SHOULD BE CREATED.                     @Y30LB25*/ 09492000
*   /*                                                               */ 09493000
*   /*****************************************************************/ 09494000
*                                                                  2143 09495000
*   IF BASHOLD=OFF                  /* PLACE HOLD BVR?       @Y30LB25*/ 09496000
*     THEN                          /* NO                    @Y30LB25*/ 09497000
         TM    BASHOLD(@06),B'10000000'                            2143 09498000
         BNZ   @RF02143                                            2143 09499000
*     DO;                           /*                       @Y30LB25*/ 09500000
*                                                                  2144 09501000
*       /*************************************************************/ 09502000
*       /*                                                           */ 09503000
*       /* CREATE A DVR                                      @Y30LB25*/ 09504000
*       /*                                                           */ 09505000
*       /*************************************************************/ 09506000
*                                                                  2145 09507000
*       CALL CRTDVR;                /* CRT A DVR             @Y30LB25*/ 09508000
         BAL   @14,CRTDVR                                          2145 09509000
*       RETURN;                     /*                       @Y30LB25*/ 09510000
         B     @EL00050                                            2146 09511000
*     END;                          /*                       @Y30LB25*/ 09512000
*                                                                  2147 09513000
*   /*****************************************************************/ 09514000
*   /*                                                               */ 09515000
*   /* UPDATE PLACE HOLDER BVR                               @Y30LB25*/ 09516000
*   /*                                                               */ 09517000
*   /*****************************************************************/ 09518000
*                                                                  2148 09519000
*   BASCSN1=BCDCSN1;                /* SET CSN1              @Y30LB25*/ 09520000
@RF02143 L     @06,BASEVPTR                                        2148 09521000
         L     @15,BCDVPTR                                         2148 09522000
         MVC   BASCSN1(12,@06),BCDCSN1(@15)                        2148 09523000
*   BASCSN2=BCDCSN2;                /* SET CSN2              @Y30LB25*/ 09524000
         MVC   BASCSN2(12,@06),BCDCSN2(@15)                        2149 09525000
*   BASLIB1=BCDLIB1;                /* SET LIB ID 1          @Y30LB25*/ 09526000
         IC    @14,BCDLIB1(,@15)                                   2150 09527000
         STC   @14,BASLIB1(,@06)                                   2150 09528000
*   BASLIB2=BCDLIB2;                /* SET LIB ID 2          @Y30LB25*/ 09529000
         IC    @14,BCDLIB2(,@15)                                   2151 09530000
         STC   @14,BASLIB2(,@06)                                   2151 09531000
*   BASHOLD=OFF;                    /* NO PLAC HOLD          @Y30LB25*/ 09532000
         NI    BASHOLD(@06),B'01111111'                            2152 09533000
*   BASPREV=BLANK6;                 /* NO PREV BVR           @Y30LB25*/ 09534000
         MVI   BASPREV+1(@06),C' '                                 2153 09535000
         MVC   BASPREV+2(4,@06),BASPREV+1(@06)                     2153 09536000
         MVI   BASPREV(@06),C' '                                   2153 09537000
*   BASNEXTV=BLANK6;                /* NO NEXT BVR           @Y30LB25*/ 09538000
         MVI   BASNEXTV+1(@06),C' '                                2154 09539000
         MVC   BASNEXTV+2(4,@06),BASNEXTV+1(@06)                   2154 09540000
         MVI   BASNEXTV(@06),C' '                                  2154 09541000
*   BASGROUP=BLANK8;                /* NO GROUP              @Y30LB25*/ 09542000
         MVI   BASGROUP+1(@06),C' '                                2155 09543000
         MVC   BASGROUP+2(6,@06),BASGROUP+1(@06)                   2155 09544000
         MVI   BASGROUP(@06),C' '                                  2155 09545000
*   BASBKLMT=FIXONE;                /* BACKUP LMT            @Y30LB25*/ 09546000
         MVI   BASBKLMT(@06),X'01'                                 2156 09547000
*   BASDLMTD=BLANK4;                /* NO MOUNT DATE         @Y30LB25*/ 09548000
         MVI   BASDLMTD+1(@06),C' '                                2157 09549000
         MVC   BASDLMTD+2(2,@06),BASDLMTD+1(@06)                   2157 09550000
         MVI   BASDLMTD(@06),C' '                                  2157 09551000
*   BASDTREM=BLANK4;                /* NO EJECT DATE         @Y30LB25*/ 09552000
         MVI   BASDTREM+1(@06),C' '                                2158 09553000
         MVC   BASDTREM+2(2,@06),BASDTREM+1(@06)                   2158 09554000
         MVI   BASDTREM(@06),C' '                                  2158 09555000
*   BASEXPDT=FIX4FS;                /* NO EXPIR DATE         @Y30LB25*/ 09556000
         MVC   BASEXPDT(4,@06),@CB00677                            2159 09557000
*   BASDESCR=BLANK30;               /* NO DESCRIPT           @Y30LB25*/ 09558000
         MVI   BASDESCR+1(@06),C' '                                2160 09559000
         MVC   BASDESCR+2(28,@06),BASDESCR+1(@06)                  2160 09560000
         MVI   BASDESCR(@06),C' '                                  2160 09561000
*   BASOWNER=BLANK10;               /* NO OWNER              @Y30LB25*/ 09562000
         MVI   BASOWNER+1(@06),C' '                                2161 09563000
         MVC   BASOWNER+2(8,@06),BASOWNER+1(@06)                   2161 09564000
         MVI   BASOWNER(@06),C' '                                  2161 09565000
*   BASRECOV=BLANK6;                /* RECOVERY SER #        @Y30LB25*/ 09566000
         MVI   BASRECOV+1(@06),C' '                                2162 09567000
         MVC   BASRECOV+2(4,@06),BASRECOV+1(@06)                   2162 09568000
         MVI   BASRECOV(@06),C' '                                  2162 09569000
*   BASDEST=BLANK30;                /* NO DESTINATION        @Y30LB25*/ 09570000
         MVI   BASDEST+1(@06),C' '                                 2163 09571000
         MVC   BASDEST+2(28,@06),BASDEST+1(@06)                    2163 09572000
         MVI   BASDEST(@06),C' '                                   2163 09573000
*   BASKLCPY=BLANK13;               /* NO LATEST COPY        @Y30LB25*/ 09574000
*                                                                  2164 09575000
         MVC   BASKLCPY(13,@06),@CC00692                           2164 09576000
*   /*****************************************************************/ 09577000
*   /*                                                               */ 09578000
*   /* CHECK IF UPDATING FROM A CVR                          @Y30LB25*/ 09579000
*   /*                                                               */ 09580000
*   /*****************************************************************/ 09581000
*                                                                  2165 09582000
*   IF BCDCOPY=ON                   /* CVR?                  @Y30LB25*/ 09583000
*     THEN                          /* YES                   @Y30LB25*/ 09584000
         TM    BCDCOPY(@15),B'00010000'                            2165 09585000
         BNO   @RF02165                                            2165 09586000
*     DO;                           /*                       @Y30LB25*/ 09587000
*       COPYVPTR=BCDVPTR;           /* MAP CVR TO BE         @Y30LB25   09588000
*                                      RENAMED               @Y30LB25*/ 09589000
         ST    @15,COPYVPTR                                        2167 09590000
*       BASOWNER=COPOWNER;          /* SET OWNER             #Y30LB25*/ 09591000
         MVC   BASOWNER(10,@06),COPOWNER(@15)                      2168 09592000
*       BASDESCR=COPDESCR;          /* SET DESCRIPTION       #Y30LB25*/ 09593000
         MVC   BASDESCR(30,@06),COPDESCR(@15)                      2169 09594000
*       BASFREXT=COPFREXT;          /* SET FREE EXTENT       #Y30LB25*/ 09595000
         L     @14,COPFREXT(,@15)                                  2170 09596000
         ST    @14,BASFREXT(,@06)                                  2170 09597000
*       BASLEXT=COPLEXT;            /* SET LARGE FREE EXT    #Y30LB25*/ 09598000
         LH    @14,COPLEXT(,@15)                                   2171 09599000
         STH   @14,BASLEXT(,@06)                                   2171 09600000
*       BASFRESP=COPFRESP;          /* SET FREE SPACE        #Y30LB25*/ 09601000
*                                                                  2172 09602000
         LH    @14,COPFRESP(,@15)                                  2172 09603000
         STH   @14,BASFRESP(,@06)                                  2172 09604000
*       /*************************************************************/ 09605000
*       /*                                                           */ 09606000
*       /* SET BIND                                          #Y30LB25*/ 09607000
*       /*                                                           */ 09608000
*       /*************************************************************/ 09609000
*                                                                  2173 09610000
*       IF COPBIND=ON               /* BIND?                 #Y30LB25*/ 09611000
*         THEN                      /* YES                   #Y30LB25*/ 09612000
         TM    COPBIND(@15),B'00000100'                            2173 09613000
         BNO   @RF02173                                            2173 09614000
*         BASBIND=ON;               /* BIND                  #Y30LB25*/ 09615000
         OI    BASBIND(@06),B'00000010'                            2174 09616000
*       ELSE                                                       2175 09617000
*         BASBIND=OFF;              /* NO BIND               #Y30LB25*/ 09618000
*                                                                  2175 09619000
         B     @RC02173                                            2175 09620000
@RF02173 L     @06,BASEVPTR                                        2175 09621000
         NI    BASBIND(@06),B'11111101'                            2175 09622000
*       /*************************************************************/ 09623000
*       /*                                                           */ 09624000
*       /* SET EXCLUSIVE                                     #Y30LB25*/ 09625000
*       /*                                                           */ 09626000
*       /*************************************************************/ 09627000
*                                                                  2176 09628000
*       IF COPEXCL=ON               /* EXCLUSIVE?            #Y30LB25*/ 09629000
*         THEN                      /* YES                   #Y30LB25*/ 09630000
@RC02173 L     @06,COPYVPTR                                        2176 09631000
         TM    COPEXCL(@06),B'00000010'                            2176 09632000
         BNO   @RF02176                                            2176 09633000
*         BASEXCL=ON;               /* EXCLUSIVE             #Y30LB25*/ 09634000
         L     @06,BASEVPTR                                        2177 09635000
         OI    BASEXCL(@06),B'00000001'                            2177 09636000
*       ELSE                                                       2178 09637000
*         BASEXCL=OFF;              /* NO EXCL               #Y30LB25*/ 09638000
*                                                                  2178 09639000
         B     @RC02176                                            2178 09640000
@RF02176 L     @06,BASEVPTR                                        2178 09641000
         NI    BASEXCL(@06),B'11111110'                            2178 09642000
*       /*************************************************************/ 09643000
*       /*                                                           */ 09644000
*       /* SET DASD ERASE (SECURE)                           #Y30LB25*/ 09645000
*       /*                                                           */ 09646000
*       /*************************************************************/ 09647000
*                                                                  2179 09648000
*       IF COPDAERA=ON              /* SECURE?               #Y30LB25*/ 09649000
*         THEN                      /* YES                   #Y30LB25*/ 09650000
@RC02176 L     @06,COPYVPTR                                        2179 09651000
         TM    COPDAERA(@06),B'00000001'                           2179 09652000
         BNO   @RF02179                                            2179 09653000
*         BASDAERA=ON;              /* SECURE                #Y30LB25*/ 09654000
         L     @06,BASEVPTR                                        2180 09655000
         OI    BASDAERA(@06),B'10000000'                           2180 09656000
*       ELSE                                                       2181 09657000
*         BASDAERA=OFF;             /* NO SECURE             #Y30LB25*/ 09658000
*                                                                  2181 09659000
         B     @RC02179                                            2181 09660000
@RF02179 L     @06,BASEVPTR                                        2181 09661000
         NI    BASDAERA(@06),B'01111111'                           2181 09662000
*       /*************************************************************/ 09663000
*       /*                                                           */ 09664000
*       /* SET READ ONLY                                     #Y30LB25*/ 09665000
*       /*                                                           */ 09666000
*       /*************************************************************/ 09667000
*                                                                  2182 09668000
*       IF COPRONLY=ON              /* READ ONLY?            #Y30LB25*/ 09669000
*         THEN                      /* YES                   #Y30LB25*/ 09670000
@RC02179 L     @06,COPYVPTR                                        2182 09671000
         TM    COPRONLY(@06),B'10000000'                           2182 09672000
         BNO   @RF02182                                            2182 09673000
*         BASRONLY=ON;              /* READ ONLY             #Y30LB25*/ 09674000
         L     @06,BASEVPTR                                        2183 09675000
         OI    BASRONLY(@06),B'01000000'                           2183 09676000
*       ELSE                                                       2184 09677000
*         BASRONLY=OFF;             /* NO READ ONLY          #Y30LB25*/ 09678000
*                                                                  2184 09679000
         B     @RC02182                                            2184 09680000
@RF02182 L     @06,BASEVPTR                                        2184 09681000
         NI    BASRONLY(@06),B'10111111'                           2184 09682000
*       /*************************************************************/ 09683000
*       /*                                                           */ 09684000
*       /* SET DOWN LEVEL SPACE                              #Y30LB25*/ 09685000
*       /*                                                           */ 09686000
*       /*************************************************************/ 09687000
*                                                                  2185 09688000
*       IF COPDLSPF=ON              /* DOWN LEVEL SPC?       #Y30LB25*/ 09689000
*         THEN                      /* YES                   #Y30LB25*/ 09690000
@RC02182 L     @06,COPYVPTR                                        2185 09691000
         TM    COPDLSPF(@06),B'01000000'                           2185 09692000
         BNO   @RF02185                                            2185 09693000
*         BASDLSF=ON;               /* DOWN LEVEL SPC        #Y30LB25*/ 09694000
         L     @06,BASEVPTR                                        2186 09695000
         OI    BASDLSF(@06),B'10000000'                            2186 09696000
*       ELSE                                                       2187 09697000
*         BASDLSF=OFF;              /* NO DWN LEV SPC        #Y30LB25*/ 09698000
         B     @RC02185                                            2187 09699000
@RF02185 L     @06,BASEVPTR                                        2187 09700000
         NI    BASDLSF(@06),B'01111111'                            2187 09701000
*     END;                          /*                       #Y30LB25*/ 09702000
*                                                                  2188 09703000
@RC02185 DS    0H                                                  2189 09704000
*   /*****************************************************************/ 09705000
*   /*                                                               */ 09706000
*   /* CHECK IF UPDATING FROM A BVR                          #Y30LB25*/ 09707000
*   /*                                                               */ 09708000
*   /*****************************************************************/ 09709000
*                                                                  2189 09710000
*   IF BCDBASE=ON                   /* BVR?                  #Y30LB25*/ 09711000
*     THEN                          /* YES                   #Y30LB25*/ 09712000
@RF02165 L     @06,BCDVPTR                                         2189 09713000
         TM    BCDBASE(@06),B'00100000'                            2189 09714000
         BNO   @RF02189                                            2189 09715000
*     DO;                           /*                       #Y30LB25*/ 09716000
*                                                                  2190 09717000
*       /*************************************************************/ 09718000
*       /*                                                           */ 09719000
*       /* SET BIND                                          #Y30LB25*/ 09720000
*       /*                                                           */ 09721000
*       /*************************************************************/ 09722000
*                                                                  2191 09723000
*       IF BCDVPTR->BASBIND=ON      /* BIND?                 @ZA17177*/ 09724000
*         THEN                      /* YES                   #Y30LB25*/ 09725000
         TM    BASBIND(@06),B'00000010'                            2191 09726000
         BNO   @RF02191                                            2191 09727000
*         BASBIND=ON;               /* BIND                  #Y30LB25*/ 09728000
         L     @06,BASEVPTR                                        2192 09729000
         OI    BASBIND(@06),B'00000010'                            2192 09730000
*       ELSE                                                       2193 09731000
*         BASBIND=OFF;              /* NO BIND               #Y30LB25*/ 09732000
*                                                                  2193 09733000
         B     @RC02191                                            2193 09734000
@RF02191 L     @06,BASEVPTR                                        2193 09735000
         NI    BASBIND(@06),B'11111101'                            2193 09736000
*       /*************************************************************/ 09737000
*       /*                                                           */ 09738000
*       /* SET EXCLUSIVE                                     #Y30LB25*/ 09739000
*       /*                                                           */ 09740000
*       /*************************************************************/ 09741000
*                                                                  2194 09742000
*       IF BCDVPTR->BASEXCL=ON      /* EXCLUSIVE?            @ZA17177*/ 09743000
*         THEN                      /* YES                   #Y30LB25*/ 09744000
@RC02191 L     @06,BCDVPTR                                         2194 09745000
         TM    BASEXCL(@06),B'00000001'                            2194 09746000
         BNO   @RF02194                                            2194 09747000
*         BASEXCL=ON;               /* EXCLUSIVE             #Y30LB25*/ 09748000
         L     @06,BASEVPTR                                        2195 09749000
         OI    BASEXCL(@06),B'00000001'                            2195 09750000
*       ELSE                                                       2196 09751000
*         BASEXCL=OFF;              /* NO EXCL               #Y30LB25*/ 09752000
*                                                                  2196 09753000
         B     @RC02194                                            2196 09754000
@RF02194 L     @06,BASEVPTR                                        2196 09755000
         NI    BASEXCL(@06),B'11111110'                            2196 09756000
*       /*************************************************************/ 09757000
*       /*                                                           */ 09758000
*       /* SET DASD ERASE (SECURE)                           #Y30LB25*/ 09759000
*       /*                                                           */ 09760000
*       /*************************************************************/ 09761000
*                                                                  2197 09762000
*       IF BCDVPTR->BASDAERA=ON     /* SECURE?               @ZA17177*/ 09763000
*         THEN                      /* YES                   #Y30LB25*/ 09764000
@RC02194 L     @06,BCDVPTR                                         2197 09765000
         TM    BASDAERA(@06),B'10000000'                           2197 09766000
         BNO   @RF02197                                            2197 09767000
*         BASDAERA=ON;              /* SECURE                #Y30LB25*/ 09768000
         L     @06,BASEVPTR                                        2198 09769000
         OI    BASDAERA(@06),B'10000000'                           2198 09770000
*       ELSE                                                       2199 09771000
*         BASDAERA=OFF;             /* NO SECURE             #Y30LB25*/ 09772000
*                                                                  2199 09773000
         B     @RC02197                                            2199 09774000
@RF02197 L     @06,BASEVPTR                                        2199 09775000
         NI    BASDAERA(@06),B'01111111'                           2199 09776000
*       /*************************************************************/ 09777000
*       /*                                                           */ 09778000
*       /* SET READ ONLY                                     #Y30LB25*/ 09779000
*       /*                                                           */ 09780000
*       /*************************************************************/ 09781000
*                                                                  2200 09782000
*       IF BCDVPTR->BASRONLY=ON     /* READ ONLY?            @ZA17177*/ 09783000
*         THEN                      /* YES                   #Y30LB25*/ 09784000
@RC02197 L     @06,BCDVPTR                                         2200 09785000
         TM    BASRONLY(@06),B'01000000'                           2200 09786000
         BNO   @RF02200                                            2200 09787000
*         BASRONLY=ON;              /* READ ONLY             #Y30LB25*/ 09788000
         L     @06,BASEVPTR                                        2201 09789000
         OI    BASRONLY(@06),B'01000000'                           2201 09790000
*       ELSE                                                       2202 09791000
*         BASRONLY=OFF;             /* NO READ ONLY          #Y30LB25*/ 09792000
*                                                                  2202 09793000
         B     @RC02200                                            2202 09794000
@RF02200 L     @06,BASEVPTR                                        2202 09795000
         NI    BASRONLY(@06),B'10111111'                           2202 09796000
*       /*************************************************************/ 09797000
*       /*                                                           */ 09798000
*       /* SET DOWN LEVEL SPACE                              #Y30LB25*/ 09799000
*       /*                                                           */ 09800000
*       /*************************************************************/ 09801000
*                                                                  2203 09802000
*       IF BCDVPTR->BASDLSF=ON      /* DOWN LEVEL SPC?       @ZA17177*/ 09803000
*         THEN                      /* YES                   #Y30LB25*/ 09804000
@RC02200 L     @06,BCDVPTR                                         2203 09805000
         TM    BASDLSF(@06),B'10000000'                            2203 09806000
         BNO   @RF02203                                            2203 09807000
*         BASDLSF=ON;               /* DOWN LEVEL SPC        #Y30LB25*/ 09808000
         L     @06,BASEVPTR                                        2204 09809000
         OI    BASDLSF(@06),B'10000000'                            2204 09810000
*       ELSE                                                       2205 09811000
*         BASDLSF=OFF;              /* NO DWN LEV SPC        #Y30LB25*/ 09812000
*                                                                  2205 09813000
         B     @RC02203                                            2205 09814000
@RF02203 L     @06,BASEVPTR                                        2205 09815000
         NI    BASDLSF(@06),B'01111111'                            2205 09816000
*       /*************************************************************/ 09817000
*       /*                                                           */ 09818000
*       /* SET OTHER BVR FIELDS                              #Y30LB25*/ 09819000
*       /*                                                           */ 09820000
*       /*************************************************************/ 09821000
*                                                                  2206 09822000
*       BASBKLMT=BCDVPTR->BASBKLMT; /* BACKUP LMT            @ZA17177*/ 09823000
@RC02203 L     @06,BASEVPTR                                        2206 09824000
         L     @15,BCDVPTR                                         2206 09825000
         IC    @14,BASBKLMT(,@15)                                  2206 09826000
         STC   @14,BASBKLMT(,@06)                                  2206 09827000
*       BASFRESP=BCDVPTR->BASFRESP; /* FREE SPACE            @ZA17177*/ 09828000
         LH    @14,BASFRESP(,@15)                                  2207 09829000
         N     @14,@CF01129                                        2207 09830000
         STH   @14,BASFRESP(,@06)                                  2207 09831000
*       BASLEXT=BCDVPTR->BASLEXT;   /* LARGEST FREE EXTNT    @ZA17177*/ 09832000
         LH    @14,BASLEXT(,@15)                                   2208 09833000
         N     @14,@CF01129                                        2208 09834000
         STH   @14,BASLEXT(,@06)                                   2208 09835000
*       BASFREXT=BCDVPTR->BASFREXT; /* FREE EXTENTS          @ZA17177*/ 09836000
         L     @14,BASFREXT(,@15)                                  2209 09837000
         ST    @14,BASFREXT(,@06)                                  2209 09838000
*       BASDLMTD=BCDVPTR->BASDLMTD; /* DATE LAST MNTD        @ZA17177*/ 09839000
         MVC   BASDLMTD(4,@06),BASDLMTD(@15)                       2210 09840000
*       BASEXPDT=BCDVPTR->BASEXPDT; /* EXPIRDATE             @ZA17177*/ 09841000
         MVC   BASEXPDT(4,@06),BASEXPDT(@15)                       2211 09842000
*       BASDESCR=BCDVPTR->BASDESCR; /* DESCRIPTION           @ZA17177*/ 09843000
         MVC   BASDESCR(30,@06),BASDESCR(@15)                      2212 09844000
*       BASOWNER=BCDVPTR->BASOWNER; /* OWNER                 @ZA17177*/ 09845000
*                                                                  2213 09846000
         MVC   BASOWNER(10,@06),BASOWNER(@15)                      2213 09847000
*       /*************************************************************/ 09848000
*       /*                                                           */ 09849000
*       /* PUT GROUP NAME IN EXTENSION IF NOT THERE          @ZA17177*/ 09850000
*       /*                                                           */ 09851000
*       /*************************************************************/ 09852000
*                                                                  2214 09853000
*       IF DEFVVEXT^=FIXZERO&DEFPGRO=OFF&/* IS THERE EXT     @ZA17177*/ 09854000
*           BCDVPTR->BASGRPV=ON THEN/* IS THERE GRP          @ZA17177*/ 09855000
         L     @06,DEFVVEXT(,DEFVPTR)                              2214 09856000
         LTR   @06,@06                                             2214 09857000
         BZ    @RF02214                                            2214 09858000
         TM    DEFPGRO(DEFVEPTR),B'00100000'                       2214 09859000
         BNZ   @RF02214                                            2214 09860000
         TM    BASGRPV(@15),B'00100000'                            2214 09861000
         BNO   @RF02214                                            2214 09862000
*         DO;                       /* YES                   @ZA17177*/ 09863000
*           DEFGROUP=BCDVPTR->BASGROUP;/* PUT GRP NAME IN EXT      2216 09864000
*                                                            @ZA17177*/ 09865000
         MVC   DEFGROUP(8,DEFVEPTR),BASGROUP(@15)                  2216 09866000
*           DEFPGRO=ON;             /* TURN GRP FLG ON       @ZA17177*/ 09867000
         OI    DEFPGRO(DEFVEPTR),B'00100000'                       2217 09868000
*           IF BCDVPTR->BASGENUS=ON THEN/* IS THIS VOL GEN USE     2218 09869000
*                                                            @ZA17177*/ 09870000
         TM    BASGENUS(@15),B'00010000'                           2218 09871000
         BNO   @RF02218                                            2218 09872000
*             DEFGENUS=ON;          /* GEN USE BIT IN EXT    @ZA17177*/ 09873000
         OI    DEFGENUS(DEFVEPTR),B'10000000'                      2219 09874000
*           ELSE                                                   2220 09875000
*             DEFRSTD=ON;           /* RSTD BIT ON IN EXT    @ZA17177*/ 09876000
         B     @RC02218                                            2220 09877000
@RF02218 OI    DEFRSTD(DEFVEPTR),B'01000000'                       2220 09878000
*         END;                      /*                       @ZA17177*/ 09879000
@RC02218 DS    0H                                                  2222 09880000
*     END;                          /*                       @ZA28475*/ 09881000
*                                                                  2222 09882000
@RF02214 DS    0H                                                  2223 09883000
*   /*****************************************************************/ 09884000
*   /*                                                               */ 09885000
*   /* CHECK IF ATTRIBUTES CHANGED                           #Y30LB25*/ 09886000
*   /*                                                               */ 09887000
*   /*****************************************************************/ 09888000
*                                                                  2223 09889000
*   IF DEFVVFLG^=FIX1F              /* ATTRIBUTES?           #Y30LB25*/ 09890000
*     THEN                          /* YES                   #Y30LB25*/ 09891000
@RF02189 CLI   DEFVVFLG(DEFVPTR),X'FF'                             2223 09892000
         BE    @RF02223                                            2223 09893000
*     CALL SETATTRB;                /* SET ATTRIBUTES        #Y30LB25*/ 09894000
*                                                                  2224 09895000
         BAL   @14,SETATTRB                                        2224 09896000
*   /*****************************************************************/ 09897000
*   /*                                                               */ 09898000
*   /* CHECK OWNER                                           #Y30LB25*/ 09899000
*   /*                                                               */ 09900000
*   /*****************************************************************/ 09901000
*                                                                  2225 09902000
*   IF DEFOWNID(1:10)^=FIX10ZRO     /* OWNER SPECIFIED?      #Y30LB25*/ 09903000
*     THEN                          /* YES                   #Y30LB25*/ 09904000
@RF02223 CLC   DEFOWNID(10,DEFVPTR),@CB00681                       2225 09905000
         BE    @RF02225                                            2225 09906000
*     BASOWNER=DEFOWNID;            /* SET NEW OWNER         #Y30LB25*/ 09907000
*                                                                  2226 09908000
         L     @06,BASEVPTR                                        2226 09909000
         MVC   BASOWNER(10,@06),DEFOWNID(DEFVPTR)                  2226 09910000
*   /*****************************************************************/ 09911000
*   /*                                                               */ 09912000
*   /* UPDATE THE EXISTING CIRS                              #Y30LB25*/ 09913000
*   /*                                                               */ 09914000
*   /*****************************************************************/ 09915000
*                                                                  2227 09916000
*   BASEBUF=BASEBUF1;               /* USE CORRECT BUFFER    #Y30LB25*/ 09917000
@RF02225 MVC   BASEBUF(224),BASEBUF1                               2227 09918000
*   BASEVPTR=ADDR(BASEBUF);         /* RESET MAPPING         #Y30LB25*/ 09919000
         LA    @06,BASEBUF                                         2228 09920000
         ST    @06,BASEVPTR                                        2228 09921000
*   BCDVPTR=BASEVPTR;               /* COMMON MAP            #Y30LB25*/ 09922000
         ST    @06,BCDVPTR                                         2229 09923000
*   CALL UPDCIR;                    /* UPDT CIRS             @Y30LB25*/ 09924000
         BAL   @14,UPDCIR                                          2230 09925000
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/ 09926000
*     THEN                          /* YES                   @Y30LB25*/ 09927000
         L     @06,RPLVPTR                                         2231 09928000
         LH    @06,RPLVRETC(,@06)                                  2231 09929000
         N     @06,@CF01129                                        2231 09930000
         LTR   @06,@06                                             2231 09931000
         BNZ   @RT02231                                            2231 09932000
*     RETURN;                       /*                       @Y30LB25*/ 09933000
*                                                                  2232 09934000
*   /*****************************************************************/ 09935000
*   /*                                                               */ 09936000
*   /* CHAIN BVR INTO NGVR                                   @Y30LB25*/ 09937000
*   /*                                                               */ 09938000
*   /*****************************************************************/ 09939000
*                                                                  2233 09940000
*   GRPFLG=OFF;                     /* CHAIN INTO NGVR       @Y30LB25*/ 09941000
         NI    GRPFLG,B'11101111'                                  2233 09942000
*   CALL VUCHI;                     /* CHAIN IN              @Y30LB25*/ 09943000
         BAL   @14,VUCHI                                           2234 09944000
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/ 09945000
*     THEN                          /* YES                   @Y30LB25*/ 09946000
         L     @06,RPLVPTR                                         2235 09947000
         LH    @06,RPLVRETC(,@06)                                  2235 09948000
         N     @06,@CF01129                                        2235 09949000
         LTR   @06,@06                                             2235 09950000
         BNZ   @RT02235                                            2235 09951000
*     RETURN;                       /*                       @Y30LB25*/ 09952000
*                                                                  2236 09953000
*   /*****************************************************************/ 09954000
*   /*                                                               */ 09955000
*   /* CHECK FOR AN ICBDEFV EXTENSION                        @Y30LB25*/ 09956000
*   /*                                                               */ 09957000
*   /*****************************************************************/ 09958000
*                                                                  2237 09959000
*   IF DEFVVEXT^=FIXZERO            /* EXTENSION?            @Y30LB25*/ 09960000
*     THEN                          /* YES                   @Y30LB25*/ 09961000
         L     @06,DEFVVEXT(,DEFVPTR)                              2237 09962000
         LTR   @06,@06                                             2237 09963000
         BZ    @RF02237                                            2237 09964000
*     DO;                           /*                       @Y30LB25*/ 09965000
*       CALL PRODEFVE;              /* PROCESS EXTEN         @Y30LB25*/ 09966000
         BAL   @14,PRODEFVE                                        2239 09967000
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/ 09968000
*         THEN                      /* YES                   @Y30LB25*/ 09969000
         L     @06,RPLVPTR                                         2240 09970000
         LH    @06,RPLVRETC(,@06)                                  2240 09971000
         N     @06,@CF01129                                        2240 09972000
         LTR   @06,@06                                             2240 09973000
         BNZ   @RT02240                                            2240 09974000
*         RETURN;                   /*                       @Y30LB25*/ 09975000
*     END;                          /*                       @Y30LB25*/ 09976000
*                                                                  2242 09977000
*   /*****************************************************************/ 09978000
*   /*                                                               */ 09979000
*   /* REESTABLISH THE BVR'S RPLV                            @Y30LB25*/ 09980000
*   /*                                                               */ 09981000
*   /*****************************************************************/ 09982000
*                                                                  2243 09983000
*   BVOLKY=DEFVNVOL;                /* SET VOLID             @Y30LB25*/ 09984000
@RF02237 MVC   BVOLKY(6),DEFVNVOL(DEFVPTR)                         2243 09985000
*   RPLVKEY=ADDR(BKEY);             /* SET KEY ADDR          @Y30LB25*/ 09986000
         LA    @06,BKEY                                            2244 09987000
         L     @01,RPLVPTR                                         2244 09988000
         ST    @06,RPLVKEY(,@01)                                   2244 09989000
*   CALL READUPD1;                  /* READ BVR              @Y30LB25*/ 09990000
         BAL   @14,READUPD1                                        2245 09991000
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/ 09992000
*     THEN                          /* YES                   @Y30LB25*/ 09993000
         L     @06,RPLVPTR                                         2246 09994000
         LH    @15,RPLVRETC(,@06)                                  2246 09995000
         N     @15,@CF01129                                        2246 09996000
         LTR   @15,@15                                             2246 09997000
         BNZ   @RT02246                                            2246 09998000
*     RETURN;                       /*                       @Y30LB25*/ 09999000
*                                                                  2247 10000000
*   /*****************************************************************/ 10001000
*   /*                                                               */ 10002000
*   /* WRITE THE BVR                                         @Y30LB25*/ 10003000
*   /*                                                               */ 10004000
*   /*****************************************************************/ 10005000
*                                                                  2248 10006000
*   RPLVBUF=ADDR(BASEBUF);          /* SET BVR BUFF ADDR     @Y30LB25*/ 10007000
         LA    @15,BASEBUF                                         2248 10008000
         ST    @15,RPLVBUF(,@06)                                   2248 10009000
*   CALL WRITRECD;                  /* WRITE THE BVR         @Y30LB25*/ 10010000
         BAL   @14,WRITRECD                                        2249 10011000
*   RETURN;                         /*                       @Y30LB25*/ 10012000
         B     @EL00050                                            2250 10013000
*   END RENAME2;                    /*                       @Y30LB25*/ 10014000
         B     @EL00050                                            2251 10015000
*                                                                  2252 10016000
*   /*****************************************************************/ 10017000
*   /*                                                               */ 10018000
*   /* PROCEDURE NAME - SETATTRB                             @Y30LB25*/ 10019000
*   /*                                                       @Y30LB25*/ 10020000
*   /* FUNCTION -                                            @Y30LB25*/ 10021000
*   /* SET THE VOLUME ATTRIBUTES IN THE BVR FROM             @Y30LB25*/ 10022000
*   /* THOSE SPECIFIED IN THE ICBDEFV EXTENSION.             @Y30LB25*/ 10023000
*   /*                                                       @Y30LB25*/ 10024000
*   /* INPUT -                                               @Y30LB25*/ 10025000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 10026000
*   /* ICBDEFV EXTENSION                                     @Y30LB25*/ 10027000
*   /*                                                       @Y30LB25*/ 10028000
*   /* OUTPUT -                                              @Y30LB25*/ 10029000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 10030000
*   /*                                                               */ 10031000
*   /*****************************************************************/ 10032000
*                                                                  2252 10033000
*SETATTRB:                          /*                       @Y30LB25*/ 10034000
*   PROC OPTIONS(NOSAVEAREA);       /*                       @ZDR2054*/ 10035000
*                                                                  2252 10036000
SETATTRB STM   @14,@12,12(@13)                                     2252 10037000
*   /*****************************************************************/ 10038000
*   /*                                                               */ 10039000
*   /* CHECK EXCLUSIVE                                       @Y30LB25*/ 10040000
*   /*                                                               */ 10041000
*   /*****************************************************************/ 10042000
*                                                                  2253 10043000
*   IF DEFVEXCL=ON                  /* EXCLUSIVE?            @Y30LB25*/ 10044000
*     THEN                          /* YES                   @Y30LB25*/ 10045000
         TM    DEFVEXCL(DEFVPTR),B'00010000'                       2253 10046000
         BNO   @RF02253                                            2253 10047000
*     BASEXCL=ON;                   /* EXCLUSIVE             @Y30LB25*/ 10048000
         L     @06,BASEVPTR                                        2254 10049000
         OI    BASEXCL(@06),B'00000001'                            2254 10050000
*   ELSE                                                           2255 10051000
*     BASEXCL=OFF;                  /* NO EXCLUSIVE          @Y30LB25*/ 10052000
*                                                                  2255 10053000
         B     @RC02253                                            2255 10054000
@RF02253 L     @06,BASEVPTR                                        2255 10055000
         NI    BASEXCL(@06),B'11111110'                            2255 10056000
*   /*****************************************************************/ 10057000
*   /*                                                               */ 10058000
*   /* CHECK BIND                                            @Y30LB25*/ 10059000
*   /*                                                               */ 10060000
*   /*****************************************************************/ 10061000
*                                                                  2256 10062000
*   IF DEFVBIND=ON                  /* BIND?                 @Y30LB25*/ 10063000
*     THEN                          /* YES                   @Y30LB25*/ 10064000
@RC02253 TM    DEFVBIND(DEFVPTR),B'00000100'                       2256 10065000
         BNO   @RF02256                                            2256 10066000
*     BASBIND=ON;                   /* BIND                  @Y30LB25*/ 10067000
         L     @06,BASEVPTR                                        2257 10068000
         OI    BASBIND(@06),B'00000010'                            2257 10069000
*   ELSE                                                           2258 10070000
*     BASBIND=OFF;                  /* NO BIND               @Y30LB25*/ 10071000
*                                                                  2258 10072000
         B     @RC02256                                            2258 10073000
@RF02256 L     @06,BASEVPTR                                        2258 10074000
         NI    BASBIND(@06),B'11111101'                            2258 10075000
*   /*****************************************************************/ 10076000
*   /*                                                               */ 10077000
*   /* CHECK READ ONLY                                       @Y30LB25*/ 10078000
*   /*                                                               */ 10079000
*   /*****************************************************************/ 10080000
*                                                                  2259 10081000
*   IF DEFVWINH=ON                  /* READ ONLY?            @Y30LB25*/ 10082000
*     THEN                          /* YES                   @Y30LB25*/ 10083000
@RC02256 TM    DEFVWINH(DEFVPTR),B'00000010'                       2259 10084000
         BNO   @RF02259                                            2259 10085000
*     BASRONLY=ON;                  /* READ ONLY             @Y30LB25*/ 10086000
         L     @06,BASEVPTR                                        2260 10087000
         OI    BASRONLY(@06),B'01000000'                           2260 10088000
*   ELSE                                                           2261 10089000
*     BASRONLY=OFF;                 /* NO READ ONLY          @Y30LB25*/ 10090000
*                                                                  2261 10091000
         B     @RC02259                                            2261 10092000
@RF02259 L     @06,BASEVPTR                                        2261 10093000
         NI    BASRONLY(@06),B'10111111'                           2261 10094000
*   /*****************************************************************/ 10095000
*   /*                                                               */ 10096000
*   /* CHECK DASD ERASE                                      @Y30LB25*/ 10097000
*   /*                                                               */ 10098000
*   /*****************************************************************/ 10099000
*                                                                  2262 10100000
*   IF DEFVSEC=ON                   /* SECURE?               @Y30LB25*/ 10101000
*     THEN                          /* YES                   @Y30LB25*/ 10102000
@RC02259 TM    DEFVSEC(DEFVPTR),B'00100000'                        2262 10103000
         BNO   @RF02262                                            2262 10104000
*     BASDAERA=ON;                  /* DASD ERASE            @Y30LB25*/ 10105000
         L     @06,BASEVPTR                                        2263 10106000
         OI    BASDAERA(@06),B'10000000'                           2263 10107000
*   ELSE                                                           2264 10108000
*     BASDAERA=OFF;                 /* NO SECURE             @Y30LB25*/ 10109000
         B     @RC02262                                            2264 10110000
@RF02262 L     @06,BASEVPTR                                        2264 10111000
         NI    BASDAERA(@06),B'01111111'                           2264 10112000
*   RETURN;                         /*                       @Y30LB25*/ 10113000
@EL00051 DS    0H                                                  2265 10114000
@EF00051 DS    0H                                                  2265 10115000
@ER00051 LM    @14,@12,12(@13)                                     2265 10116000
         BR    @14                                                 2265 10117000
*   END SETATTRB;                   /*                       @Y30LB25*/ 10118000
         B     @EL00051                                            2266 10119000
*                                                                  2267 10120000
*   /*****************************************************************/ 10121000
*   /*                                                               */ 10122000
*   /* PROCEDURE NAME - RMSCERR2                             @Y30LB25*/ 10123000
*   /*                                                       @Y30LB25*/ 10124000
*   /* FUNCTION -                                            @Y30LB25*/ 10125000
*   /* IF A PLACE HOLDER BVR EXISTS FOR DEFVNVOL, DELETE     @Y30LB25*/ 10126000
*   /* IT. ALLOW THE BASE VOLUME RECORD WHICH WAS            @Y30LB25*/ 10127000
*   /* TO BE RENAMED TO BE COPIED.                           @Y30LB25*/ 10128000
*   /*                                                       @Y30LB25*/ 10129000
*   /* INPUT -                                               @Y30LB25*/ 10130000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 10131000
*   /*                                                       @Y30LB25*/ 10132000
*   /* OUTPUT -                                              @Y30LB25*/ 10133000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 10134000
*   /* AN ERROR                                              @Y30LB25*/ 10135000
*   /*                                                               */ 10136000
*   /*****************************************************************/ 10137000
*                                                                  2267 10138000
*RMSCERR2:                          /*                       @Y30LB25*/ 10139000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 10140000
*                                                                  2267 10141000
RMSCERR2 ST    @14,@SA00052                                        2267 10142000
*   /*****************************************************************/ 10143000
*   /*                                                               */ 10144000
*   /* CHECK FOR PLACE HOLDER BVR AND IF FOUND DELETE IT.    @Y30LB25*/ 10145000
*   /*                                                               */ 10146000
*   /*****************************************************************/ 10147000
*                                                                  2268 10148000
*   BVOLKY=DEFVNVOL;                /* SET VOLID             @Y30LB25*/ 10149000
         MVC   BVOLKY(6),DEFVNVOL(DEFVPTR)                         2268 10150000
*   RPLVKEY=ADDR(BKEY);             /* SET KEY ADDR          @Y30LB25*/ 10151000
         L     @06,RPLVPTR                                         2269 10152000
         LA    @05,BKEY                                            2269 10153000
         ST    @05,RPLVKEY(,@06)                                   2269 10154000
*   RPLVBUF=ADDR(BASEBUF);          /* BUFFER ADDR           @Y30LB25*/ 10155000
         LA    @05,BASEBUF                                         2270 10156000
         ST    @05,RPLVBUF(,@06)                                   2270 10157000
*   RPLVBLN=LENGTH(BASEBUF);        /* SET BUFF LENGTH       @Y30LB25*/ 10158000
         MVC   RPLVBLN(4,@06),@CF01103                             2271 10159000
*   CALL DELTRECD;                  /* DELETE BVR            @Y30LB25*/ 10160000
*                                                                  2272 10161000
         BAL   @14,DELTRECD                                        2272 10162000
*   /*****************************************************************/ 10163000
*   /*                                                               */ 10164000
*   /* CLEAR RETURN/REASON CODES, ONLY MSC CODES             @Y30LB25*/ 10165000
*   /* WILL BE RETURNED.                                     @Y30LB25*/ 10166000
*   /*                                                               */ 10167000
*   /*****************************************************************/ 10168000
*                                                                  2273 10169000
*   RPLVRETC=RPLVRETC&&RPLVRETC;    /* CLEAR RETN CODE       @Y30LB25*/ 10170000
         L     @06,RPLVPTR                                         2273 10171000
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       2273 10172000
*   RPLRCODE=RPLRCODE&&RPLRCODE;    /* CLEAR REAS CODE       @Y30LB25*/ 10173000
*                                                                  2274 10174000
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       2274 10175000
*   /*****************************************************************/ 10176000
*   /*                                                               */ 10177000
*   /* GET BVR WHICH WAS TO BE RENAMED.                      @Y30LB25*/ 10178000
*   /* CHECK FOR RENAME AN INACTIVE VOLUME                   @Y30LB25*/ 10179000
*   /*                                                               */ 10180000
*   /*****************************************************************/ 10181000
*                                                                  2275 10182000
*   CALL RDRENUPD;                  /* GET MSVC RECORD       @Y30LB25*/ 10183000
         BAL   @14,RDRENUPD                                        2275 10184000
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/ 10185000
*     THEN                          /* YES                   @Y30LB25*/ 10186000
         L     @06,RPLVPTR                                         2276 10187000
         LH    @05,RPLVRETC(,@06)                                  2276 10188000
         N     @05,@CF01129                                        2276 10189000
         LTR   @05,@05                                             2276 10190000
         BNZ   @RT02276                                            2276 10191000
*     RETURN;                       /*                       @Y30LB25*/ 10192000
*                                                                  2277 10193000
*   /*****************************************************************/ 10194000
*   /*                                                               */ 10195000
*   /* RECORD RETURNED IN BASEBUF                            @Y30LB25*/ 10196000
*   /*                                                               */ 10197000
*   /*****************************************************************/ 10198000
*                                                                  2278 10199000
*   BCDVPTR=ADDR(BASEBUF);          /* COMMON MAP            @Y30LB25*/ 10200000
         LA    @05,BASEBUF                                         2278 10201000
         ST    @05,BCDVPTR                                         2278 10202000
*   IF BCDCOPY=ON|BCDDUP=ON         /* CVR OR DVR?           @Y30LB25*/ 10203000
*     THEN                          /* YES                   @Y30LB25*/ 10204000
         TM    BCDCOPY(@05),B'00010100'                            2279 10205000
         BNZ   @RT02279                                            2279 10206000
*     RETURN;                       /*                       @Y30LB25*/ 10207000
*                                                                  2280 10208000
*   /*****************************************************************/ 10209000
*   /*                                                               */ 10210000
*   /* ALLOW COPIES AND WRITE THE BVR.                       @Y30LB25*/ 10211000
*   /*                                                               */ 10212000
*   /*****************************************************************/ 10213000
*                                                                  2281 10214000
*   BASNOCPY=OFF;                   /* ALLOW COPIES          @Y30LB25*/ 10215000
         L     @01,BASEVPTR                                        2281 10216000
         NI    BASNOCPY(@01),B'10111111'                           2281 10217000
*   RPLVBUF=ADDR(BASEBUF);          /* INSURE CORRECT BUF    @Y30LB25*/ 10218000
         ST    @05,RPLVBUF(,@06)                                   2282 10219000
*   CALL WRITRECD;                  /* WRITE BVR             @Y30LB25*/ 10220000
         BAL   @14,WRITRECD                                        2283 10221000
*   RETURN;                         /*                       @Y30LB25*/ 10222000
@EL00052 DS    0H                                                  2284 10223000
@EF00052 DS    0H                                                  2284 10224000
@ER00052 L     @14,@SA00052                                        2284 10225000
         BR    @14                                                 2284 10226000
*   END RMSCERR2;                   /*                       @Y30LB25*/ 10227000
         B     @EL00052                                            2285 10228000
*                                                                  2286 10229000
*   /*****************************************************************/ 10230000
*   /*                                                               */ 10231000
*   /* PROCEDURE NAME - PROCDREC                             @Y30LB25*/ 10232000
*   /*                                                       @Y30LB25*/ 10233000
*   /* FUNCTION -                                            @Y30LB25*/ 10234000
*   /* DELETE A BVR OR CVR OR DVR WHICH IS TO BE RENAMED.    @Y30LB25*/ 10235000
*   /* IF A BVR, UPDATE ITS GVR OR NGVR AND IF ACTIVE ITS    @Y30LB25*/ 10236000
*   /* GVSNER SLOT. IF A CVR, UPDATE ITS BVR.                @Y30LB25*/ 10237000
*   /*                                                       @Y30LB25*/ 10238000
*   /* INPUT -                                               @Y30LB25*/ 10239000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 10240000
*   /*                                                       @Y30LB25*/ 10241000
*   /* OUTPUT -                                              @Y30LB25*/ 10242000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 10243000
*   /* AN ERROR                                              @Y30LB25*/ 10244000
*   /*                                                               */ 10245000
*   /*****************************************************************/ 10246000
*                                                                  2286 10247000
*PROCDREC:                          /*                       @Y30LB25*/ 10248000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 10249000
*                                                                  2286 10250000
PROCDREC ST    @14,@SA00053                                        2286 10251000
*   /*****************************************************************/ 10252000
*   /*                                                               */ 10253000
*   /* GET AND DELETE THE CVR OR BVR OR DVR TO BE RENAMED.   @Y30LB25*/ 10254000
*   /* THE DELETED RECORD WILL BE IN BASEBUF UPON            @Y30LB25*/ 10255000
*   /* RETURN.                                               @Y30LB25*/ 10256000
*   /*                                                               */ 10257000
*   /*****************************************************************/ 10258000
*                                                                  2287 10259000
*   CALL RDRENUPD;                  /* GET MSVC RECD TO      @Y30LB25   10260000
*                                      BE RENAMED            @Y30LB25*/ 10261000
         BAL   @14,RDRENUPD                                        2287 10262000
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/ 10263000
*     THEN                          /* YES                   @Y30LB25*/ 10264000
         L     @06,RPLVPTR                                         2288 10265000
         LH    @15,RPLVRETC(,@06)                                  2288 10266000
         N     @15,@CF01129                                        2288 10267000
         LTR   @15,@15                                             2288 10268000
         BNZ   @RT02288                                            2288 10269000
*     RETURN;                       /*                       @Y30LB25*/ 10270000
*   RPLVTYP=RPLVDEL;                /* DELETE                @Y30LB25*/ 10271000
         MVI   RPLVTYP(@06),X'05'                                  2290 10272000
*   RPLVBUF=ADDR(BASEBUF);          /* BUFF ADDR             @Y30LB25*/ 10273000
         LA    @15,BASEBUF                                         2291 10274000
         ST    @15,RPLVBUF(,@06)                                   2291 10275000
*   RESPECIFY                                                      2292 10276000
*     RG1 RSTD;                     /* RESTRICT REG 1        @Y30LB25*/ 10277000
*   RG1=RPLVPTR;                    /* SET RPLV PTR          @Y30LB25*/ 10278000
         LR    RG1,@06                                             2293 10279000
*   CALL ICBVIO00;                  /* DELETE MSVC RECD              */ 10280000
         L     @15,@CV00762                                        2294 10281000
         BALR  @14,@15                                             2294 10282000
*   RESPECIFY                                                      2295 10283000
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @Y30LB25*/ 10284000
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/ 10285000
*     THEN                          /* YES                   @Y30LB25*/ 10286000
         L     @06,RPLVPTR                                         2296 10287000
         LH    @06,RPLVRETC(,@06)                                  2296 10288000
         N     @06,@CF01129                                        2296 10289000
         LTR   @06,@06                                             2296 10290000
         BNZ   @RT02296                                            2296 10291000
*     RETURN;                       /*                       @Y30LB25*/ 10292000
*                                                                  2297 10293000
*   /*****************************************************************/ 10294000
*   /*                                                               */ 10295000
*   /* CHECK FOR DELETION OF A BVR OR A CVR                  @Y30LB25*/ 10296000
*   /*                                                               */ 10297000
*   /*****************************************************************/ 10298000
*                                                                  2298 10299000
*   BCDVPTR=ADDR(BASEBUF);          /* COMMON MAP            @Y30LB25*/ 10300000
*                                                                  2298 10301000
         LA    @06,BASEBUF                                         2298 10302000
         ST    @06,BCDVPTR                                         2298 10303000
*   /*****************************************************************/ 10304000
*   /*                                                               */ 10305000
*   /* CHECK FOR RENAME A BVR.                               @Y30LB25*/ 10306000
*   /* UPDATE ITS GVR OR NGVR.                               @Y30LB25*/ 10307000
*   /*                                                               */ 10308000
*   /*****************************************************************/ 10309000
*                                                                  2299 10310000
*   IF BCDBASE=ON                   /* BVR?                  @Y30LB25*/ 10311000
*     THEN                          /* YES                   @Y30LB25*/ 10312000
         TM    BCDBASE(@06),B'00100000'                            2299 10313000
         BNO   @RF02299                                            2299 10314000
*     DO;                           /*                       @Y30LB25*/ 10315000
*                                                                  2300 10316000
*       /*************************************************************/ 10317000
*       /*                                                           */ 10318000
*       /* CHECK IF GROUPED                                  @Y30LB25*/ 10319000
*       /*                                                           */ 10320000
*       /*************************************************************/ 10321000
*                                                                  2301 10322000
*       IF BASGRPV=ON               /* GROUPED?              @Y30LB25*/ 10323000
*         THEN                      /* YES                   @Y30LB25*/ 10324000
         L     @06,BASEVPTR                                        2301 10325000
         TM    BASGRPV(@06),B'00100000'                            2301 10326000
         BNO   @RF02301                                            2301 10327000
*         DO;                       /*                       @Y30LB25*/ 10328000
*                                                                  2302 10329000
*           /*********************************************************/ 10330000
*           /*                                                       */ 10331000
*           /* CHECK FOR INACTIVE                            @Y30LB25*/ 10332000
*           /*                                                       */ 10333000
*           /*********************************************************/ 10334000
*                                                                  2303 10335000
*           IF BASINAC=ON           /* INACTIVE?             @Y30LB25*/ 10336000
*             THEN                  /* YES                   @Y30LB25*/ 10337000
         TM    BASINAC(@06),B'00000100'                            2303 10338000
         BNO   @RF02303                                            2303 10339000
*             DO;                   /*                       @Y30LB25*/ 10340000
*               CALL INACGVR;       /* DEC # INAC VOLS       @Y30LB25*/ 10341000
         BAL   @14,INACGVR                                         2305 10342000
*               IF RPLVRETC^=FIXZERO/* ERROR?                @Y30LB25*/ 10343000
*                 THEN              /* YES                   @Y30LB25*/ 10344000
         L     @06,RPLVPTR                                         2306 10345000
         LH    @06,RPLVRETC(,@06)                                  2306 10346000
         N     @06,@CF01129                                        2306 10347000
         LTR   @06,@06                                             2306 10348000
         BNZ   @RT02306                                            2306 10349000
*                 RETURN;           /*                       @Y30LB25*/ 10350000
*             END;                  /*                       @Y30LB25*/ 10351000
*                                                                  2308 10352000
*           /*********************************************************/ 10353000
*           /*                                                       */ 10354000
*           /* IT IS ACTIVE                                  @Y30LB25*/ 10355000
*           /*                                                       */ 10356000
*           /*********************************************************/ 10357000
*                                                                  2309 10358000
*           ELSE                    /* ACTIVE                @Y30LB25*/ 10359000
*             DO;                   /*                       @Y30LB25*/ 10360000
*                                                                  2309 10361000
         B     @RC02303                                            2309 10362000
@RF02303 DS    0H                                                  2310 10363000
*               /*****************************************************/ 10364000
*               /*                                                   */ 10365000
*               /* UPDATE GVR                                @Y30LB25*/ 10366000
*               /*                                                   */ 10367000
*               /*****************************************************/ 10368000
*                                                                  2310 10369000
*               CALL ACTGVR;        /* READ GVR              @Y30LB25*/ 10370000
         BAL   @14,ACTGVR                                          2310 10371000
*               IF RPLVRETC^=FIXZERO/* ERROR?                @Y30LB25*/ 10372000
*                 THEN              /* YES                   @Y30LB25*/ 10373000
         L     @06,RPLVPTR                                         2311 10374000
         LH    @06,RPLVRETC(,@06)                                  2311 10375000
         N     @06,@CF01129                                        2311 10376000
         LTR   @06,@06                                             2311 10377000
         BNZ   @RT02311                                            2311 10378000
*                 RETURN;           /*                       @Y30LB25*/ 10379000
*             END;                  /*                       @Y30LB25*/ 10380000
*         END;                      /*                       @Y30LB25*/ 10381000
*                                                                  2314 10382000
@RC02303 DS    0H                                                  2315 10383000
*       /*************************************************************/ 10384000
*       /*                                                           */ 10385000
*       /* PROCESS BVR                                       @Y30LB25*/ 10386000
*       /*                                                           */ 10387000
*       /*************************************************************/ 10388000
*                                                                  2315 10389000
*       CALL PROCBVR;               /* PROCESS BVR           @Y30LB25*/ 10390000
@RF02301 BAL   @14,PROCBVR                                         2315 10391000
*     END;                          /*                       @Y30LB25*/ 10392000
*                                                                  2316 10393000
*   /*****************************************************************/ 10394000
*   /*                                                               */ 10395000
*   /* CHECK FOR RENAME A CVR.                               @Y30LB25*/ 10396000
*   /*                                                               */ 10397000
*   /*****************************************************************/ 10398000
*                                                                  2317 10399000
*   IF BCDCOPY=ON                   /* CVR?                  @Y30LB25*/ 10400000
*     THEN                          /* YES                   @Y30LB25*/ 10401000
@RF02299 L     @06,BCDVPTR                                         2317 10402000
         TM    BCDCOPY(@06),B'00010000'                            2317 10403000
         BNO   @RF02317                                            2317 10404000
*     DO;                           /*                       @Y30LB25*/ 10405000
*       ADDSUB=OFF;                 /* DELETE CVR            @Y30LB25*/ 10406000
         NI    ADDSUB,B'10111111'                                  2319 10407000
*       CALL ICBVUBVR(BCDVPTR,RPLVPTR,PASSBYTE);/*           @Y30LB25   10408000
*                                      UPDATE CVR'S BVR      @Y30LB25*/ 10409000
         L     @15,@CV00769                                        2320 10410000
         LA    @01,@AL02320                                        2320 10411000
         BALR  @14,@15                                             2320 10412000
*     END;                          /*                       @Y30LB25*/ 10413000
*   RETURN;                         /*                       @Y30LB25*/ 10414000
@EL00053 DS    0H                                                  2322 10415000
@EF00053 DS    0H                                                  2322 10416000
@ER00053 L     @14,@SA00053                                        2322 10417000
         BR    @14                                                 2322 10418000
*   END PROCDREC;                   /*                       @Y30LB25*/ 10419000
         B     @EL00053                                            2323 10420000
*                                                                  2324 10421000
*   /*****************************************************************/ 10422000
*   /*                                                               */ 10423000
*   /* PROCEDURE NAME - ACTGVR                               @Y30LB25*/ 10424000
*   /*                                                       @Y30LB25*/ 10425000
*   /* FUNCTION -                                            @Y30LB25*/ 10426000
*   /* DECREMENT EITHER THE NUMBER OF GENERAL-USE            @Y30LB25*/ 10427000
*   /* OR THE NUMBER OF RESTRICTED VOLUMES KEPT IN           @Y30LB25*/ 10428000
*   /* THE GROUP VOLUME RECORD. DECREMENT SPACE              @Y30LB25*/ 10429000
*   /* COUNT IN THE GROUP RECORD. DONE FOR AN ACTIVE         @Y30LB25*/ 10430000
*   /* VOLUME BEING DELETED.                                 @Y30LB25*/ 10431000
*   /*                                                       @Y30LB25*/ 10432000
*   /* INPUT -                                               @Y30LB25*/ 10433000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 10434000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 10435000
*   /*                                                       @Y30LB25*/ 10436000
*   /* OUTPUT -                                              @Y30LB25*/ 10437000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 10438000
*   /* AN ERROR                                              @Y30LB25*/ 10439000
*   /* GROUP VOLUME RECORD                                   @Y30LB25*/ 10440000
*   /*                                                               */ 10441000
*   /*****************************************************************/ 10442000
*                                                                  2324 10443000
*ACTGVR:                            /*                       @Y30LB25*/ 10444000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 10445000
ACTGVR   ST    @14,@SA00054                                        2324 10446000
*   GROUPKY=BASGROUP;               /* SET GROUP NAME        @Y30LB25*/ 10447000
         L     @06,BASEVPTR                                        2325 10448000
         MVC   GROUPKY(8),BASGROUP(@06)                            2325 10449000
*   RPLVKEY=ADDR(GKEY);             /* SET KEY ADDR          @Y30LB25*/ 10450000
         LA    @06,GKEY                                            2326 10451000
         L     @01,RPLVPTR                                         2326 10452000
         ST    @06,RPLVKEY(,@01)                                   2326 10453000
*   CALL READUPD1;                  /* READ GVR              @Y30LB25*/ 10454000
         BAL   @14,READUPD1                                        2327 10455000
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/ 10456000
*     THEN                          /* YES                   @Y30LB25*/ 10457000
         L     @06,RPLVPTR                                         2328 10458000
         LH    @06,RPLVRETC(,@06)                                  2328 10459000
         N     @06,@CF01129                                        2328 10460000
         LTR   @06,@06                                             2328 10461000
         BNZ   @RT02328                                            2328 10462000
*     RETURN;                       /*                       @Y30LB25*/ 10463000
*                                                                  2329 10464000
*   /*****************************************************************/ 10465000
*   /*                                                               */ 10466000
*   /* DECREMENT TYPE OF VOLUME COUNT                        @Y30LB25*/ 10467000
*   /*                                                               */ 10468000
*   /*****************************************************************/ 10469000
*                                                                  2330 10470000
*   GROUPBUF=BASEBUF1;              /* USE CORRECT BUF       @Y30LB25*/ 10471000
         MVC   GROUPBUF(224),BASEBUF1                              2330 10472000
*   IF BASGENUS=ON                  /* GENERAL-USE?          @Y30LB25*/ 10473000
*     THEN                          /* YES                   @Y30LB25*/ 10474000
         L     @06,BASEVPTR                                        2331 10475000
         TM    BASGENUS(@06),B'00010000'                           2331 10476000
         BNO   @RF02331                                            2331 10477000
*     DO;                           /*                       @Y30LB25*/ 10478000
*       GRONGEN=GRONGEN-FIXONE;     /* DEC # GEN-USE         @Y30LB25*/ 10479000
*                                                                  2333 10480000
         L     @06,GROUPPTR                                        2333 10481000
         LH    @15,GRONGEN(,@06)                                   2333 10482000
         BCTR  @15,0                                               2333 10483000
         STH   @15,GRONGEN(,@06)                                   2333 10484000
*       /*************************************************************/ 10485000
*       /*                                                           */ 10486000
*       /* UPDATE THE GVR                                    @Y30LB25*/ 10487000
*       /*                                                           */ 10488000
*       /*************************************************************/ 10489000
*                                                                  2334 10490000
*       ADDSUBGR=OFF;               /* SUBTRACT              @Y30LB25*/ 10491000
         NI    ADDSUBGR,B'11110111'                                2334 10492000
*       CALL VUPGH;                 /* UPDATE GVR            @Y30LB25*/ 10493000
         BAL   @14,VUPGH                                           2335 10494000
*     END;                          /*                       @Y30LB25*/ 10495000
*   ELSE                            /* RESTRICTED            @Y30LB25*/ 10496000
*     IF BASRSTD=ON                 /* RESTRICTED?           @Y30LB25*/ 10497000
*       THEN                        /* YES                   @Y30LB25*/ 10498000
         B     @RC02331                                            2337 10499000
@RF02331 L     @06,BASEVPTR                                        2337 10500000
         TM    BASRSTD(@06),B'00001000'                            2337 10501000
         BNO   @RF02337                                            2337 10502000
*       GRONRSTD=GRONRSTD-FIXONE;   /* DEC # RESTD VOLS      @Y30LB25*/ 10503000
*                                                                  2338 10504000
         L     @06,GROUPPTR                                        2338 10505000
         LH    @15,GRONRSTD(,@06)                                  2338 10506000
         BCTR  @15,0                                               2338 10507000
         STH   @15,GRONRSTD(,@06)                                  2338 10508000
*   /*****************************************************************/ 10509000
*   /*                                                               */ 10510000
*   /* WRITE GVR                                             @Y30LB25*/ 10511000
*   /*                                                               */ 10512000
*   /*****************************************************************/ 10513000
*                                                                  2339 10514000
*   RPLVBUF=ADDR(GROUPBUF);         /* SET BUFF ADDR         @Y30LB25*/ 10515000
@RF02337 DS    0H                                                  2339 10516000
@RC02331 LA    @06,GROUPBUF                                        2339 10517000
         L     @01,RPLVPTR                                         2339 10518000
         ST    @06,RPLVBUF(,@01)                                   2339 10519000
*   CALL WRITRECD;                  /* WRITE GVR             @Y30LB25*/ 10520000
         BAL   @14,WRITRECD                                        2340 10521000
*   RETURN;                         /*                       @Y30LB25*/ 10522000
@EL00054 DS    0H                                                  2341 10523000
@EF00054 DS    0H                                                  2341 10524000
@ER00054 L     @14,@SA00054                                        2341 10525000
         BR    @14                                                 2341 10526000
*   END ACTGVR;                     /*                       @Y30LB25*/ 10527000
         B     @EL00054                                            2342 10528000
*                                                                  2343 10529000
*   /*****************************************************************/ 10530000
*   /*                                                               */ 10531000
*   /* PROCEDURE NAME - RERENUPD                             @Y30LB25*/ 10532000
*   /*                                                       @Y30LB25*/ 10533000
*   /* FUNCTION -                                            @Y30LB25*/ 10534000
*   /* GET THE MSVC RECORD FOR UPDATE WHICH IS               @Y30LB25*/ 10535000
*   /* TO BE RENAMED.                                        @Y30LB25*/ 10536000
*   /*                                                       @Y30LB25*/ 10537000
*   /* INPUT -                                               @Y30LB25*/ 10538000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 10539000
*   /*                                                       @Y30LB25*/ 10540000
*   /* OUTPUT -                                              @Y30LB25*/ 10541000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 10542000
*   /* AN ERROR                                              @Y30LB25*/ 10543000
*   /* MSC RECORD TO BE RENAMED IN BASEBUF                   @Y30LB25*/ 10544000
*   /*                                                               */ 10545000
*   /*****************************************************************/ 10546000
*                                                                  2343 10547000
*RDRENUPD:                          /*                       @Y30LB25*/ 10548000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 10549000
*                                                                  2343 10550000
RDRENUPD ST    @14,@SA00055                                        2343 10551000
*   /*****************************************************************/ 10552000
*   /*                                                               */ 10553000
*   /* CHECK FOR RENAME AN INACTIVE VOLUME                   @Y30LB25*/ 10554000
*   /*                                                               */ 10555000
*   /*****************************************************************/ 10556000
*                                                                  2344 10557000
*   IF DEFVRNTR=ON                  /* RENAME INACT VOL?     @Y30LB25*/ 10558000
*     THEN                          /* YES                   @Y30LB25*/ 10559000
         TM    DEFVRNTR(DEFVPTR),B'00000100'                       2344 10560000
         BNO   @RF02344                                            2344 10561000
*     DO;                           /*                       @Y30LB25*/ 10562000
*       IVOLKY=DEFVCSN1;            /* SET CSN IN KEY        @Y30LB25*/ 10563000
         MVC   IVOLKY(12),DEFVCSN1(DEFVPTR)                        2346 10564000
*       CALL GETRECUD;              /* GET MSC RECORD        @Y30LB25*/ 10565000
         BAL   @14,GETRECUD                                        2347 10566000
*     END;                          /*                       @Y30LB25*/ 10567000
*                                                                  2348 10568000
*   /*****************************************************************/ 10569000
*   /*                                                               */ 10570000
*   /* IT IS RENAME AN ACTIVE VOLUME                         @Y30LB25*/ 10571000
*   /*                                                               */ 10572000
*   /*****************************************************************/ 10573000
*                                                                  2349 10574000
*   ELSE                                                           2349 10575000
*     DO;                           /*                       @Y30LB25*/ 10576000
         B     @RC02344                                            2349 10577000
@RF02344 DS    0H                                                  2350 10578000
*       BVOLKY=DEFVOLD;             /* SET VOLID             @Y30LB25*/ 10579000
         MVC   BVOLKY(6),DEFVOLD(DEFVPTR)                          2350 10580000
*       RPLVKEY=ADDR(BKEY);         /* SET KEY ADDR          @Y30LB25*/ 10581000
         LA    @06,BKEY                                            2351 10582000
         L     @01,RPLVPTR                                         2351 10583000
         ST    @06,RPLVKEY(,@01)                                   2351 10584000
*       CALL READUPD1;              /* GET BVR               @Y30LB25*/ 10585000
         BAL   @14,READUPD1                                        2352 10586000
*       BASEBUF=BASEBUF1;           /* USE CORRECT BUFF      @Y30LB25*/ 10587000
         MVC   BASEBUF(224),BASEBUF1                               2353 10588000
*     END;                          /*                       @Y30LB25*/ 10589000
*   RETURN;                         /*                       @Y30LB25*/ 10590000
@EL00055 DS    0H                                                  2355 10591000
@EF00055 DS    0H                                                  2355 10592000
@ER00055 L     @14,@SA00055                                        2355 10593000
         BR    @14                                                 2355 10594000
*   END RDRENUPD;                   /*                       @Y30LB25*/ 10595000
         B     @EL00055                                            2356 10596000
*                                                                  2357 10597000
*   /*****************************************************************/ 10598000
*   /*                                                               */ 10599000
*   /* PROCEDURE NAME - ACTINAC                              @Y30LB25*/ 10600000
*   /*                                                       @Y30LB25*/ 10601000
*   /* FUNCTION -                                            @Y30LB25*/ 10602000
*   /* THIS PROCEDURE HANDLES A GROUP RECORD FOR             @Y30LB25*/ 10603000
*   /* RENAMING AN ACTIVE VOLUME BACK TO ITSELF IF IT IS     @Y30LB25*/ 10604000
*   /* GROUPED AND GENERAL-USE.                              @Y30LB25*/ 10605000
*   /*                                                       @Y30LB25*/ 10606000
*   /* INPUT -                                               @Y30LB25*/ 10607000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 10608000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 10609000
*   /*                                                       @Y30LB25*/ 10610000
*   /* OUTPUT -                                              @Y30LB25*/ 10611000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 10612000
*   /* AN ERROR                                              @Y30LB25*/ 10613000
*   /* GROUP VOLUME RECORD                                   @Y30LB25*/ 10614000
*   /* GROUP VOLUME EXTENSION RECORD                         @Y30LB25*/ 10615000
*   /*                                                               */ 10616000
*   /*****************************************************************/ 10617000
*                                                                  2357 10618000
*ACTINAC:                           /*                       @Y30LB25*/ 10619000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 10620000
*                                                                  2357 10621000
ACTINAC  ST    @14,@SA00056                                        2357 10622000
*   /*****************************************************************/ 10623000
*   /*                                                               */ 10624000
*   /* CHECK FOR GROUPED BVR                                 @Y30LB25*/ 10625000
*   /*                                                               */ 10626000
*   /*****************************************************************/ 10627000
*                                                                  2358 10628000
*   IF BASGRPV=ON                   /* GROUPED?              @Y30LB25*/ 10629000
*     THEN                          /* YES                   @Y30LB25*/ 10630000
         L     @06,BASEVPTR                                        2358 10631000
         TM    BASGRPV(@06),B'00100000'                            2358 10632000
         BNO   @RF02358                                            2358 10633000
*     DO;                           /*                       @Y30LB25*/ 10634000
*       GROUPKY=BASGROUP;           /* SET GROUP NAME        @Y30LB25*/ 10635000
         MVC   GROUPKY(8),BASGROUP(@06)                            2360 10636000
*       RPLVKEY=ADDR(GKEY);         /* KEY ADDR              @Y30LB25*/ 10637000
         LA    @06,GKEY                                            2361 10638000
         L     @05,RPLVPTR                                         2361 10639000
         ST    @06,RPLVKEY(,@05)                                   2361 10640000
*       CALL READUPD1;              /* GET GVR               @Y30LB25*/ 10641000
         BAL   @14,READUPD1                                        2362 10642000
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/ 10643000
*         THEN                      /* YES                   @Y30LB25*/ 10644000
         L     @06,RPLVPTR                                         2363 10645000
         LH    @06,RPLVRETC(,@06)                                  2363 10646000
         N     @06,@CF01129                                        2363 10647000
         LTR   @06,@06                                             2363 10648000
         BNZ   @RT02363                                            2363 10649000
*         RETURN;                   /*                       @Y30LB25*/ 10650000
*       GROUPBUF=BASEBUF1;          /* USE CORRECT BUF       @Y30LB25*/ 10651000
         MVC   GROUPBUF(224),BASEBUF1                              2365 10652000
*       GROUPPTR=ADDR(GROUPBUF);    /* SET MAPPING           @VS34305*/ 10653000
*                                                                  2366 10654000
         LA    @06,GROUPBUF                                        2366 10655000
         ST    @06,GROUPPTR                                        2366 10656000
*       /*************************************************************/ 10657000
*       /*                                                           */ 10658000
*       /* UPDATE THE GVR                                    @Y30LB25*/ 10659000
*       /*                                                           */ 10660000
*       /*************************************************************/ 10661000
*                                                                  2367 10662000
*       GRONINAC=GRONINAC+FIXONE;   /* INCR # INACT VOLS     @Y30LB25*/ 10663000
*                                                                  2367 10664000
         LA    @05,1                                               2367 10665000
         AH    @05,GRONINAC(,@06)                                  2367 10666000
         STH   @05,GRONINAC(,@06)                                  2367 10667000
*       /*************************************************************/ 10668000
*       /*                                                           */ 10669000
*       /* UPDATE THE NUMBER OF RESTRICTED OR                @Y30LB25*/ 10670000
*       /* GENERAL-USE VOLUMES                               @Y30LB25*/ 10671000
*       /*                                                           */ 10672000
*       /*************************************************************/ 10673000
*                                                                  2368 10674000
*       IF BASRSTD=ON               /* RESTRICTED?           @Y30LB25*/ 10675000
*         THEN                      /* YES                   @Y30LB25*/ 10676000
         L     @05,BASEVPTR                                        2368 10677000
         TM    BASRSTD(@05),B'00001000'                            2368 10678000
         BNO   @RF02368                                            2368 10679000
*         GRONRSTD=GRONRSTD-FIXONE; /*                       @Y30LB25   10680000
*                                      DECR # RESTD VOLS     @Y30LB25*/ 10681000
         LH    @05,GRONRSTD(,@06)                                  2369 10682000
         BCTR  @05,0                                               2369 10683000
         STH   @05,GRONRSTD(,@06)                                  2369 10684000
*       ELSE                                                       2370 10685000
*         IF BASGENUS=ON            /* GENEAL-USE?           @Y30LB25*/ 10686000
*           THEN                    /* YES                   @Y30LB25*/ 10687000
         B     @RC02368                                            2370 10688000
@RF02368 L     @06,BASEVPTR                                        2370 10689000
         TM    BASGENUS(@06),B'00010000'                           2370 10690000
         BNO   @RF02370                                            2370 10691000
*           DO;                     /*                       @Y30LB25*/ 10692000
*             GRONGEN=GRONGEN-FIXONE;/*                      @Y30LB25   10693000
*                                      DECR # GEN-USE        @Y30LB25*/ 10694000
*                                                                  2372 10695000
         L     @06,GROUPPTR                                        2372 10696000
         LH    @05,GRONGEN(,@06)                                   2372 10697000
         BCTR  @05,0                                               2372 10698000
         STH   @05,GRONGEN(,@06)                                   2372 10699000
*             /*******************************************************/ 10700000
*             /*                                                     */ 10701000
*             /* UPDATE THE GVR                              @Y30LB25*/ 10702000
*             /*                                                     */ 10703000
*             /*******************************************************/ 10704000
*                                                                  2373 10705000
*             ADDSUBGR=OFF;         /* DELETE                @Y30LB25*/ 10706000
         NI    ADDSUBGR,B'11110111'                                2373 10707000
*             CALL VUPGH;           /* PROCESS GVR           @Y30LB25*/ 10708000
         BAL   @14,VUPGH                                           2374 10709000
*           END;                    /*                       @Y30LB25*/ 10710000
*                                                                  2375 10711000
*       /*************************************************************/ 10712000
*       /*                                                           */ 10713000
*       /* WRITE THE GVR                                     @Y30LB25*/ 10714000
*       /*                                                           */ 10715000
*       /*************************************************************/ 10716000
*                                                                  2376 10717000
*       RPLVBUF=ADDR(GROUPBUF);     /* GVR BUF PTR           @Y30LB25*/ 10718000
@RF02370 DS    0H                                                  2376 10719000
@RC02368 LA    @06,GROUPBUF                                        2376 10720000
         L     @05,RPLVPTR                                         2376 10721000
         ST    @06,RPLVBUF(,@05)                                   2376 10722000
*       CALL WRITRECD;              /* WRITE GVR             @Y30LB25*/ 10723000
         BAL   @14,WRITRECD                                        2377 10724000
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/ 10725000
*         THEN                      /* YES                   @Y30LB25*/ 10726000
         L     @06,RPLVPTR                                         2378 10727000
         LH    @06,RPLVRETC(,@06)                                  2378 10728000
         N     @06,@CF01129                                        2378 10729000
         LTR   @06,@06                                             2378 10730000
         BNZ   @RT02378                                            2378 10731000
*         RETURN;                   /*                       @Y30LB25*/ 10732000
*                                                                  2379 10733000
*       /*************************************************************/ 10734000
*       /*                                                           */ 10735000
*       /* CHECK FOR GENERAL-USE TO DELETE ITS SLOT          @Y30LB25*/ 10736000
*       /*                                                           */ 10737000
*       /*************************************************************/ 10738000
*                                                                  2380 10739000
*       IF BASGENUS=ON              /* GENERAL-USE?          @Y30LB25*/ 10740000
*         THEN                      /* YES                   @Y30LB25*/ 10741000
         L     @06,BASEVPTR                                        2380 10742000
         TM    BASGENUS(@06),B'00010000'                           2380 10743000
         BNO   @RF02380                                            2380 10744000
*         DO;                       /*                       @Y30LB25*/ 10745000
*           EXPSLOT=OFF;            /* NO UPDATE DATE        @Y30LB25*/ 10746000
         NI    EXPSLOT,B'01111111'                                 2382 10747000
*           ADDSUBSL=OFF;           /* DELETE                @Y30LB25*/ 10748000
         NI    ADDSUBSL,B'11111101'                                2383 10749000
*           CALL ICBVUEXT(GROUPPTR,BASEVPTR,RPLVPTR,PASSBYTE);/*   2384 10750000
*                                                            @Y30LB25*/ 10751000
         L     @15,@CV00767                                        2384 10752000
         LA    @01,@AL02384                                        2384 10753000
         BALR  @14,@15                                             2384 10754000
*         END;                      /*                       @Y30LB25*/ 10755000
*     END;                          /*                       @Y30LB25*/ 10756000
*   RETURN;                         /*                       @Y30LB25*/ 10757000
@EL00056 DS    0H                                                  2387 10758000
@EF00056 DS    0H                                                  2387 10759000
@ER00056 L     @14,@SA00056                                        2387 10760000
         BR    @14                                                 2387 10761000
*   END ACTINAC;                    /*                       @Y30LB25*/ 10762000
         B     @EL00056                                            2388 10763000
*                                                                  2389 10764000
*   /*****************************************************************/ 10765000
*   /*                                                               */ 10766000
*   /* PROCEDURE NAME - CRTDVR                               @Y30LB25*/ 10767000
*   /*                                                       @Y30LB25*/ 10768000
*   /* FUNCTION -                                            @Y30LB25*/ 10769000
*   /* CREATE A DUPLICATE VOLUME RECORD FROM A BASE          @Y30LB25*/ 10770000
*   /* VOLUME RECORD (ACTIVE OR INACTIVE) OR FROM A          @Y30LB25*/ 10771000
*   /* COPY VOLUME RECORD, EITHER OF WHICH HAS ALREADY       @Y30LB25*/ 10772000
*   /* BEEN DELETED.                                         @Y30LB25*/ 10773000
*   /*                                                       @Y30LB25*/ 10774000
*   /* INPUT -                                               @Y30LB25*/ 10775000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 10776000
*   /* BCDVPTR POINTS TO BASEBUF WHICH CONTAINS              @Y30LB25*/ 10777000
*   /* THE DELETED BASE OR COPY VOLUME RECORD                @Y30LB25*/ 10778000
*   /* FOR THE OLD VOLID. BASEVPTR POINTS TO                 @Y30LB25*/ 10779000
*   /* THE BASE VOLUME RECORD FOR THE NEW VOLID              @Y30LB25*/ 10780000
*   /* IN BASEBUF1. THE DUPLICATE VOLUME WILL BE             @Y30LB25*/ 10781000
*   /* CREATE FOR THE NEW VOLID.                             @Y30LB25*/ 10782000
*   /*                                                       @Y30LB25*/ 10783000
*   /* OUTPUT -                                              @Y30LB25*/ 10784000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 10785000
*   /* AN ERROR                                              @Y30LB25*/ 10786000
*   /* DUPLICATE VOLUME RECORD                               @Y30LB25*/ 10787000
*   /*                                                               */ 10788000
*   /*****************************************************************/ 10789000
*                                                                  2389 10790000
*CRTDVR:                            /*                       @Y30LB25*/ 10791000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 10792000
*                                                                  2389 10793000
CRTDVR   ST    @14,@SA00057                                        2389 10794000
*   /*****************************************************************/ 10795000
*   /*                                                               */ 10796000
*   /* FIND THE ID OF THE NEXT AVAILABLE DVR FOR NVOLID      @Y30LB25*/ 10797000
*   /*                                                               */ 10798000
*   /*****************************************************************/ 10799000
*                                                                  2390 10800000
*   DVOLKY=BASSERNO;                /* SET VOLID             @Y30LB25*/ 10801000
         L     @06,BASEVPTR                                        2390 10802000
         MVC   DVOLKY(6),BASSERNO(@06)                             2390 10803000
*   RPLVTYP=RPLVREAD;               /* READ                  @Y30LB25*/ 10804000
         L     @06,RPLVPTR                                         2391 10805000
         MVI   RPLVTYP(@06),X'00'                                  2391 10806000
*   RPLVLOC=ON;                     /* LOCATE                @Y30LB25*/ 10807000
*   RPLVDIR=ON;                     /* DIRECT                @Y30LB25*/ 10808000
         OI    RPLVLOC(@06),B'11000000'                            2393 10809000
*   RPLVUPD=OFF;                    /* NO UPDATE             @Y30LB25*/ 10810000
         NI    RPLVUPD(@06),B'11111101'                            2394 10811000
*   RPLVKEY=ADDR(DKEY);             /* ADDR OF KEY           @Y30LB25*/ 10812000
         LA    @15,DKEY                                            2395 10813000
         ST    @15,RPLVKEY(,@06)                                   2395 10814000
*   DIDKY=FIXZERO;                  /* START DVR 0           @Y30LB25*/ 10815000
         MVI   DIDKY,X'00'                                         2396 10816000
*   RESPECIFY                       /*                       @Y30LB25*/ 10817000
*     RG1 RSTD;                     /* RESTRICT REG 1        @Y30LB25*/ 10818000
*   RG1=RPLVPTR;                    /* PTR TO RPLV           @Y30LB25*/ 10819000
         LR    RG1,@06                                             2398 10820000
*   A=FIXONE;                       /* LOOP CONTROL          @Y30LB25*/ 10821000
         MVC   A(4),@CF00046                                       2399 10822000
*   DO WHILE A=1;                   /* FIND AVAIL DVR        @Y30LB25*/ 10823000
         B     @DE02400                                            2400 10824000
@DL02400 DS    0H                                                  2401 10825000
*     DIDKY=DIDKY+FIXONE;           /* NEXT KEY              @Y30LB25*/ 10826000
         IC    @06,DIDKY                                           2401 10827000
         LA    @06,1(,@06)                                         2401 10828000
         STC   @06,DIDKY                                           2401 10829000
*     CALL ICBVIO00;                /* READ FOR DVR          @Y30LB25*/ 10830000
         L     @15,@CV00762                                        2402 10831000
         BALR  @14,@15                                             2402 10832000
*     IF RPLVRETC^=FIXZERO|DIDKY=FIX255/* ERROR?             @Y30LB25*/ 10833000
*       THEN                        /* YES                   @Y30LB25*/ 10834000
         L     @06,RPLVPTR                                         2403 10835000
         LH    @06,RPLVRETC(,@06)                                  2403 10836000
         N     @06,@CF01129                                        2403 10837000
         LTR   @06,@06                                             2403 10838000
         BNZ   @RT02403                                            2403 10839000
         CLI   DIDKY,255                                           2403 10840000
         BNE   @RF02403                                            2403 10841000
@RT02403 DS    0H                                                  2404 10842000
*       A=FIXZERO;                  /* END LOOP              @Y30LB25*/ 10843000
         SLR   @06,@06                                             2404 10844000
         ST    @06,A                                               2404 10845000
*   END;                            /*                       @Y30LB25*/ 10846000
@RF02403 DS    0H                                                  2405 10847000
@DE02400 CLC   A(4),@CF00046                                       2405 10848000
         BE    @DL02400                                            2405 10849000
*   RESPECIFY                       /*                       @Y30LB25*/ 10850000
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @Y30LB25*/ 10851000
*   IF RPLVRETC=FIXZERO             /* ERROR?                @Y30LB25*/ 10852000
*     THEN                          /* YES                   @Y30LB25*/ 10853000
         L     @06,RPLVPTR                                         2407 10854000
         LH    @15,RPLVRETC(,@06)                                  2407 10855000
         N     @15,@CF01129                                        2407 10856000
         LTR   @15,@15                                             2407 10857000
         BNZ   @RF02407                                            2407 10858000
*     DO;                           /*                       @Y30LB25*/ 10859000
*       RPLVRETC=FIXFOUR;           /* ERROR RETN CODE       @Y30LB25*/ 10860000
         MVC   RPLVRETC(2,@06),@CH00041                            2409 10861000
*       RPLRCODE=NODVR;             /* 255 DVRS              @Y30LB25*/ 10862000
         MVC   RPLRCODE(2,@06),@CB00709                            2410 10863000
*       RETURN;                     /*                       @Y30LB25*/ 10864000
@EL00057 DS    0H                                                  2411 10865000
@EF00057 DS    0H                                                  2411 10866000
@ER00057 L     @14,@SA00057                                        2411 10867000
         BR    @14                                                 2411 10868000
*     END;                          /*                       @Y30LB25*/ 10869000
*   IF RPLRCODE=IOERROR             /* I?O ERROR?            @Y30LB25*/ 10870000
*     THEN                          /* YES                   @Y30LB25*/ 10871000
@RF02407 L     @06,RPLVPTR                                         2413 10872000
         CLC   RPLRCODE(2,@06),@CB00713                            2413 10873000
         BE    @RT02413                                            2413 10874000
*     RETURN;                       /*                       @Y30LB25*/ 10875000
*                                                                  2414 10876000
*   /*****************************************************************/ 10877000
*   /*                                                               */ 10878000
*   /* BUILD THE DVR FOR NVOLID                              @Y30LB25*/ 10879000
*   /*                                                               */ 10880000
*   /*****************************************************************/ 10881000
*                                                                  2415 10882000
*   RPLRCODE=RPLRCODE&&RPLRCODE;    /* ZERO REASON CODE      @Y30LB25*/ 10883000
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       2415 10884000
*   RPLVRETC=RPLVRETC&&RPLVRETC;    /* ZERO RETURN CODE      @Y30LB25*/ 10885000
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       2416 10886000
*   DUPVBUF=DUPVBUF&&DUPVBUF;       /* ZERO DVR BUFFER       @Y30LB25*/ 10887000
         XC    DUPVBUF(224),DUPVBUF                                2417 10888000
*   DUPNAME=DKEY;                   /* SET KEY               @Y30LB25*/ 10889000
         L     @06,DUPVPTR                                         2418 10890000
         MVC   DUPNAME(13,@06),DKEY                                2418 10891000
*   DUPCSN1=BCDCSN1;                /* SET CSN1              @Y30LB25*/ 10892000
         L     @15,BCDVPTR                                         2419 10893000
         MVC   DUPCSN1(12,@06),BCDCSN1(@15)                        2419 10894000
*   DUPLIB1=BCDLIB1;                /* SET LIB ID 1          @Y30LB25*/ 10895000
         IC    @14,BCDLIB1(,@15)                                   2420 10896000
         STC   @14,DUPLIB1(,@06)                                   2420 10897000
*   DUPCSN2=BCDCSN2;                /* SET CSN2              @Y30LB25*/ 10898000
         MVC   DUPCSN2(12,@06),BCDCSN2(@15)                        2421 10899000
*   DUPLIB2=BCDLIB2;                /* SET LIB ID 2          @Y30LB25*/ 10900000
         IC    @14,BCDLIB2(,@15)                                   2422 10901000
         STC   @14,DUPLIB2(,@06)                                   2422 10902000
*   DUPDUPLR=ON;                    /* DVR                   @Y30LB25*/ 10903000
*                                                                  2423 10904000
         OI    DUPDUPLR(@06),B'00000100'                           2423 10905000
*   /*****************************************************************/ 10906000
*   /*                                                               */ 10907000
*   /* WRITE THE DVR                                         @Y30LB25*/ 10908000
*   /*                                                               */ 10909000
*   /*****************************************************************/ 10910000
*                                                                  2424 10911000
*   RPLVUPD=OFF;                    /* NEW RECORD            @Y30LB25*/ 10912000
         L     @06,RPLVPTR                                         2424 10913000
         NI    RPLVUPD(@06),B'11111101'                            2424 10914000
*   RPLVLOC=OFF;                    /* NO LOCATE             @Y30LB25*/ 10915000
         NI    RPLVLOC(@06),B'01111111'                            2425 10916000
*   RPLVRLN=LENGTH(DUPV);           /* RECORD LENGTH         @Y30LB25*/ 10917000
         MVC   RPLVRLN(4,@06),@CF01105                             2426 10918000
*   RPLVBLN=LENGTH(DUPVBUF);        /* BUFFER LENGTH         @Y30LB25*/ 10919000
         MVC   RPLVBLN(4,@06),@CF01103                             2427 10920000
*   RPLVBUF=ADDR(DUPVBUF);          /* DVR BUF ADDR          @Y30LB25*/ 10921000
         LA    @15,DUPVBUF                                         2428 10922000
         ST    @15,RPLVBUF(,@06)                                   2428 10923000
*   CALL WRITRECD;                  /* WRITE DVR             @Y30LB25*/ 10924000
         BAL   @14,WRITRECD                                        2429 10925000
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/ 10926000
*     THEN                          /* YES                   @Y30LB25*/ 10927000
         L     @06,RPLVPTR                                         2430 10928000
         LH    @06,RPLVRETC(,@06)                                  2430 10929000
         N     @06,@CF01129                                        2430 10930000
         LTR   @06,@06                                             2430 10931000
         BNZ   @RT02430                                            2430 10932000
*     RETURN;                       /*                       @Y30LB25*/ 10933000
*                                                                  2431 10934000
*   /*****************************************************************/ 10935000
*   /*                                                               */ 10936000
*   /* UPDATE THE CIRS                                       @Y30LB25*/ 10937000
*   /*                                                               */ 10938000
*   /*****************************************************************/ 10939000
*                                                                  2432 10940000
*   BCDVPTR=ADDR(DUPVBUF);          /* DVR PTR               @Y30LB25*/ 10941000
         LA    @06,DUPVBUF                                         2432 10942000
         ST    @06,BCDVPTR                                         2432 10943000
*   CALL UPDCIR;                    /* UPDATE CIRS           @Y30LB25*/ 10944000
         BAL   @14,UPDCIR                                          2433 10945000
*   RETURN;                         /*                       @Y30LB25*/ 10946000
         B     @EL00057                                            2434 10947000
*   END CRTDVR;                     /*                       @Y30LB25*/ 10948000
         B     @EL00057                                            2435 10949000
*                                                                  2436 10950000
*   /*****************************************************************/ 10951000
*   /*                                                               */ 10952000
*   /* PROCEDURE NAME - UPDCIR                               @Y30LB25*/ 10953000
*   /*                                                       @Y30LB25*/ 10954000
*   /* FUNCTION -                                            @Y30LB25*/ 10955000
*   /* GET THE CARTRIDGE INDEX RECORDS FOR THE               @Y30LB25*/ 10956000
*   /* BASE VOLUME RECORD (ACTIVE OR INACTIVE)               @Y30LB25*/ 10957000
*   /* OR THE COPY OR DUPLICATE VOLUME RECORD, AND UPDATE    @Y30LB25*/ 10958000
*   /* THEM TO REFLECT THE VOLID OF THE NEW DUPLICATE OR     @Y30LB25*/ 10959000
*   /* BASE OR COPY VOLUME RECORD.                           @Y30LB25*/ 10960000
*   /*                                                       @Y30LB25*/ 10961000
*   /* INPUT -                                               @Y30LB25*/ 10962000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 10963000
*   /* BCDVPTR POINTING TO CONTAINS                          @Y30LB25*/ 10964000
*   /* THE BASE OR DUPLICATE VOLUME RECORD                   @Y30LB25*/ 10965000
*   /*                                                       @Y30LB25*/ 10966000
*   /* OUTPUT -                                              @Y30LB25*/ 10967000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 10968000
*   /* AN ERROR                                              @Y30LB25*/ 10969000
*   /* CARTRIDGE INDEX RECORDS                               @Y30LB25*/ 10970000
*   /*                                                               */ 10971000
*   /*****************************************************************/ 10972000
*                                                                  2436 10973000
*UPDCIR:                            /*                       @Y30LB25*/ 10974000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 10975000
*                                                                  2436 10976000
UPDCIR   ST    @14,@SA00058                                        2436 10977000
*   /*****************************************************************/ 10978000
*   /*                                                               */ 10979000
*   /* GET AND UPDATE CIR FOR CSN1                           @Y30LB25*/ 10980000
*   /*                                                               */ 10981000
*   /*****************************************************************/ 10982000
*                                                                  2437 10983000
*   IVOLKY=BCDCSN1;                 /* SET CSN1 TO KEY       @Y30LB25*/ 10984000
         L     @06,BCDVPTR                                         2437 10985000
         MVC   IVOLKY(12),BCDCSN1(@06)                             2437 10986000
*   RPLVKEY=ADDR(IKEY);             /* SET KEY ADDR          @Y30LB25*/ 10987000
         LA    @06,IKEY                                            2438 10988000
         L     @01,RPLVPTR                                         2438 10989000
         ST    @06,RPLVKEY(,@01)                                   2438 10990000
*   CALL READUPD1;                  /* GET CIR FOR CSN1      @Y30LB25*/ 10991000
         BAL   @14,READUPD1                                        2439 10992000
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/ 10993000
*     THEN                          /* YES                   @Y30LB25*/ 10994000
         L     @06,RPLVPTR                                         2440 10995000
         LH    @06,RPLVRETC(,@06)                                  2440 10996000
         N     @06,@CF01129                                        2440 10997000
         LTR   @06,@06                                             2440 10998000
         BNZ   @RT02440                                            2440 10999000
*     RETURN;                       /*                       @Y30LB25*/ 11000000
*   INDEXPTR=ADDR(BASEBUF1);        /* MAP CIR               @Y30LB25*/ 11001000
         LA    @06,BASEBUF1                                        2442 11002000
         ST    @06,INDEXPTR                                        2442 11003000
*   INDRECKY=BCDNAME;               /* SET KEY TO CIR        @Y30LB25*/ 11004000
         L     @01,BCDVPTR                                         2443 11005000
         MVC   INDRECKY(13,@06),BCDNAME(@01)                       2443 11006000
*   CALL WRITRECD;                  /* WRITE CIR FOR CSN1    @Y30LB25*/ 11007000
         BAL   @14,WRITRECD                                        2444 11008000
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/ 11009000
*     THEN                          /* YES                   @Y30LB25*/ 11010000
         L     @06,RPLVPTR                                         2445 11011000
         LH    @06,RPLVRETC(,@06)                                  2445 11012000
         N     @06,@CF01129                                        2445 11013000
         LTR   @06,@06                                             2445 11014000
         BNZ   @RT02445                                            2445 11015000
*     RETURN;                       /*                       @Y30LB25*/ 11016000
*                                                                  2446 11017000
*   /*****************************************************************/ 11018000
*   /*                                                               */ 11019000
*   /* GET AND UPDATE CIR FOR CSN2                           @Y30LB25*/ 11020000
*   /*                                                               */ 11021000
*   /*****************************************************************/ 11022000
*                                                                  2447 11023000
*   IVOLKY=BCDCSN2;                 /* SET CSN2 TO KEY       @Y30LB25*/ 11024000
         L     @06,BCDVPTR                                         2447 11025000
         MVC   IVOLKY(12),BCDCSN2(@06)                             2447 11026000
*   CALL READUPD1;                  /* GET CIR FOR CSN1      @Y30LB25*/ 11027000
         BAL   @14,READUPD1                                        2448 11028000
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/ 11029000
*     THEN                          /* YES                   @Y30LB25*/ 11030000
         L     @06,RPLVPTR                                         2449 11031000
         LH    @06,RPLVRETC(,@06)                                  2449 11032000
         N     @06,@CF01129                                        2449 11033000
         LTR   @06,@06                                             2449 11034000
         BNZ   @RT02449                                            2449 11035000
*     RETURN;                       /*                       @Y30LB25*/ 11036000
*   INDRECKY=BCDNAME;               /* SET KEY TO CIR        @Y30LB25*/ 11037000
         L     @06,INDEXPTR                                        2451 11038000
         L     @01,BCDVPTR                                         2451 11039000
         MVC   INDRECKY(13,@06),BCDNAME(@01)                       2451 11040000
*   CALL WRITRECD;                  /* WRITE CIR FOR CSN2    @Y30LB25*/ 11041000
         BAL   @14,WRITRECD                                        2452 11042000
*   RETURN;                         /*                       @Y30LB25*/ 11043000
@EL00058 DS    0H                                                  2453 11044000
@EF00058 DS    0H                                                  2453 11045000
@ER00058 L     @14,@SA00058                                        2453 11046000
         BR    @14                                                 2453 11047000
*   END UPDCIR;                     /*                       @Y30LB25*/ 11048000
         B     @EL00058                                            2454 11049000
*                                                                  2455 11050000
*   /*****************************************************************/ 11051000
*   /*                                                               */ 11052000
*   /* PROCEDURE NAME - ELMACTV2                             @Y30LB25*/ 11053000
*   /*                                                       @Y30LB25*/ 11054000
*   /* FUNCTION -                                            @Y30LB25*/ 11055000
*   /* PROCESS THE ELIMINATION OF AN ACTIVE                  @Y30LB25*/ 11056000
*   /* VOLUME AFTER THE MSC WAS CALLED.                      @Y30LB25*/ 11057000
*   /*                                                       @Y30LB25*/ 11058000
*   /* INPUT -                                               @Y30LB25*/ 11059000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 11060000
*   /*                                                       @Y30LB25*/ 11061000
*   /* OUTPUT -                                              @Y30LB25*/ 11062000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 11063000
*   /* AN ERROR                                              @Y30LB25*/ 11064000
*   /*                                                               */ 11065000
*   /*****************************************************************/ 11066000
*                                                                  2455 11067000
*ELMACTV2:                          /*                       @Y30LB25*/ 11068000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 11069000
ELMACTV2 ST    @14,@SA00059                                        2455 11070000
*   CALL HOUSKEEP;                  /* JRNL RPLV &           @Y30LB25   11071000
*                                      RESERVE .MSVI         @Y30LB25*/ 11072000
*                                                                  2456 11073000
         BAL   @14,HOUSKEEP                                        2456 11074000
*   /*****************************************************************/ 11075000
*   /*                                                               */ 11076000
*   /* CHECK FOR AN MSC ERROR.                               @Y30LB25*/ 11077000
*   /*                                                               */ 11078000
*   /*****************************************************************/ 11079000
*                                                                  2457 11080000
*   IF RPLRCODE^=FIXZERO            /* MSC ERROR?            @Y30LB25*/ 11081000
*     THEN                          /* YES                   @Y30LB25*/ 11082000
         L     @06,RPLVPTR                                         2457 11083000
         LH    @05,RPLRCODE(,@06)                                  2457 11084000
         N     @05,@CF01129                                        2457 11085000
         LTR   @05,@05                                             2457 11086000
         BZ    @RF02457                                            2457 11087000
*     DO;                           /*                       @Y30LB25*/ 11088000
*       RPLVRETC=RPLVRETC&&RPLVRETC;/* ZERO RETN CODE        @Y30LB25*/ 11089000
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       2459 11090000
*       RPLRCODE=RPLRCODE&&RPLRCODE;/* ZERO REASN CODE       @Y30LB25*/ 11091000
*                                                                  2460 11092000
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       2460 11093000
*       /*************************************************************/ 11094000
*       /*                                                           */ 11095000
*       /* ALLOW COPIES                                      @Y30LB25*/ 11096000
*       /*                                                           */ 11097000
*       /*************************************************************/ 11098000
*                                                                  2461 11099000
*       BVOLKY=DEFVOLD;             /* SET VOLID             @Y30LB25*/ 11100000
         MVC   BVOLKY(6),DEFVOLD(DEFVPTR)                          2461 11101000
*       RPLVKEY=ADDR(BKEY);         /* SET KEY ADDR          @Y30LB25*/ 11102000
         LA    @15,BKEY                                            2462 11103000
         ST    @15,RPLVKEY(,@06)                                   2462 11104000
*       CALL READUPD1;              /* GET BVR               @Y30LB25*/ 11105000
         BAL   @14,READUPD1                                        2463 11106000
*       IF RPLVRETC=FIXZERO         /* ERROR?                @Y30LB25*/ 11107000
*         THEN                      /* YES                   @Y30LB25*/ 11108000
         L     @06,RPLVPTR                                         2464 11109000
         LH    @06,RPLVRETC(,@06)                                  2464 11110000
         N     @06,@CF01129                                        2464 11111000
         LTR   @06,@06                                             2464 11112000
         BNZ   @RF02464                                            2464 11113000
*         DO;                       /*                       @Y30LB25*/ 11114000
*           BASEVPTR=ADDR(BASEBUF1);/*                       @Y30LB25   11115000
*                                      SET UP MAP            @Y30LB25*/ 11116000
         LA    @06,BASEBUF1                                        2466 11117000
         ST    @06,BASEVPTR                                        2466 11118000
*           BASNOCPY=OFF;           /* ALLOW COPIES          @Y30LB25*/ 11119000
         NI    BASNOCPY(@06),B'10111111'                           2467 11120000
*           CALL WRITRECD;          /* WRITE BVR             @Y30LB25*/ 11121000
         BAL   @14,WRITRECD                                        2468 11122000
*         END;                      /*                       @Y30LB25*/ 11123000
*                                                                  2469 11124000
*       /*************************************************************/ 11125000
*       /*                                                           */ 11126000
*       /* RETURN ZERO RETURN AND REASON CODE                @Y30LB25*/ 11127000
*       /*                                                           */ 11128000
*       /*************************************************************/ 11129000
*                                                                  2470 11130000
*       RPLVRETC=RPLVRETC&&RPLVRETC;/* ZERO RETN CODE        @Y30LB25*/ 11131000
@RF02464 L     @06,RPLVPTR                                         2470 11132000
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       2470 11133000
*       RPLRCODE=RPLRCODE&&RPLRCODE;/* ZERO RESN CODE        @Y30LB25*/ 11134000
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       2471 11135000
*       RETURN;                     /*                       @Y30LB25*/ 11136000
@EL00059 DS    0H                                                  2472 11137000
@EF00059 DS    0H                                                  2472 11138000
@ER00059 L     @14,@SA00059                                        2472 11139000
         BR    @14                                                 2472 11140000
*     END;                          /*                       @Y30LB25*/ 11141000
*                                                                  2473 11142000
*   /*****************************************************************/ 11143000
*   /*                                                               */ 11144000
*   /* DELETE THE BVR                                        @Y30LB25*/ 11145000
*   /*                                                               */ 11146000
*   /*****************************************************************/ 11147000
*                                                                  2474 11148000
*   BVOLKY=DEFVOLD;                 /* SET VOLID             @Y30LB25*/ 11149000
@RF02457 MVC   BVOLKY(6),DEFVOLD(DEFVPTR)                          2474 11150000
*   RPLVKEY=ADDR(BKEY);             /* SET KEY ADDR          @Y30LB25*/ 11151000
         L     @06,RPLVPTR                                         2475 11152000
         LA    @15,BKEY                                            2475 11153000
         ST    @15,RPLVKEY(,@06)                                   2475 11154000
*   RPLVBUF=ADDR(BASEBUF);          /* BVR BUFF ADDR         @Y30LB25*/ 11155000
         LA    @15,BASEBUF                                         2476 11156000
         ST    @15,RPLVBUF(,@06)                                   2476 11157000
*   RPLVBLN=LENGTH(BASEBUF);        /* BVR BUFF LENGTH       @Y30LB25*/ 11158000
         MVC   RPLVBLN(4,@06),@CF01103                             2477 11159000
*   CALL DELTRECD;                  /* GET & DELETE BVR      @Y30LB25*/ 11160000
         BAL   @14,DELTRECD                                        2478 11161000
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/ 11162000
*     THEN                          /* YES                   @Y30LB25*/ 11163000
         L     @06,RPLVPTR                                         2479 11164000
         LH    @15,RPLVRETC(,@06)                                  2479 11165000
         N     @15,@CF01129                                        2479 11166000
         LTR   @15,@15                                             2479 11167000
         BNZ   @RT02479                                            2479 11168000
*     RETURN;                       /*                       @Y30LB25*/ 11169000
*                                                                  2480 11170000
*   /*****************************************************************/ 11171000
*   /*                                                               */ 11172000
*   /* DELETE THE CIR FOR CSN1                               @Y30LB25*/ 11173000
*   /*                                                               */ 11174000
*   /*****************************************************************/ 11175000
*                                                                  2481 11176000
*   IVOLKY=BASCSN1;                 /* SET CSN1 IN CIR       @Y30LB25*/ 11177000
         L     @01,BASEVPTR                                        2481 11178000
         MVC   IVOLKY(12),BASCSN1(@01)                             2481 11179000
*   RPLVKEY=ADDR(IKEY);             /* SET CIR KEY ADDR      @Y30LB25*/ 11180000
         LA    @15,IKEY                                            2482 11181000
         ST    @15,RPLVKEY(,@06)                                   2482 11182000
*   RPLVBUF=ADDR(INDEXBUF);         /* SET BUF ADDR          @Y30LB25*/ 11183000
         LA    @15,INDEXBUF                                        2483 11184000
         ST    @15,RPLVBUF(,@06)                                   2483 11185000
*   RPLVBLN=LENGTH(INDEXBUF);       /* SET BUFF LENGTH       @Y30LB25*/ 11186000
         MVC   RPLVBLN(4,@06),@CF00339                             2484 11187000
*   CALL DELTRECD;                  /* GET & DELETE CIR      @Y30LB25*/ 11188000
         BAL   @14,DELTRECD                                        2485 11189000
*   RPLVRETC=RPLVRETC&&RPLVRETC;    /* ALL OK -              @Y30LB25*/ 11190000
         L     @06,RPLVPTR                                         2486 11191000
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       2486 11192000
*   RPLRCODE=RPLRCODE&&RPLRCODE;    /* CONTINUE              @Y30LB25*/ 11193000
*                                                                  2487 11194000
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       2487 11195000
*   /*****************************************************************/ 11196000
*   /*                                                               */ 11197000
*   /* DELETE THE CIR FOR CSN2                               @Y30LB25*/ 11198000
*   /*                                                               */ 11199000
*   /*****************************************************************/ 11200000
*                                                                  2488 11201000
*   IVOLKY=BASCSN2;                 /* SET CSN2 IN CIR       @Y30LB25*/ 11202000
         L     @06,BASEVPTR                                        2488 11203000
         MVC   IVOLKY(12),BASCSN2(@06)                             2488 11204000
*   CALL DELTRECD;                  /* GET & DELETE CIR      @Y30LB25*/ 11205000
         BAL   @14,DELTRECD                                        2489 11206000
*   RPLVRETC=RPLVRETC&&RPLVRETC;    /* ALL OK -              @Y30LB25*/ 11207000
         L     @06,RPLVPTR                                         2490 11208000
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       2490 11209000
*   RPLRCODE=RPLRCODE&&RPLRCODE;    /* CONTINUE              @Y30LB25*/ 11210000
*                                                                  2491 11211000
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       2491 11212000
*   /*****************************************************************/ 11213000
*   /*                                                               */ 11214000
*   /* CHECK IF GVR NEEDS PROCESSING                         @Y30LB25*/ 11215000
*   /*                                                               */ 11216000
*   /*****************************************************************/ 11217000
*                                                                  2492 11218000
*   IF BASGRPV=ON                   /* BVR GROUPED?          @Y30LB25*/ 11219000
*     THEN                          /* YES                   @Y30LB25*/ 11220000
         L     @06,BASEVPTR                                        2492 11221000
         TM    BASGRPV(@06),B'00100000'                            2492 11222000
         BNO   @RF02492                                            2492 11223000
*     DO;                           /*                       @Y30LB25*/ 11224000
*                                                                  2493 11225000
*       /*************************************************************/ 11226000
*       /*                                                           */ 11227000
*       /* DECREMENT TYPE OF VOLUME COUNT AND                @Y30LB25*/ 11228000
*       /* PROCESS GVR                                       @Y30LB25*/ 11229000
*       /*                                                           */ 11230000
*       /*************************************************************/ 11231000
*                                                                  2494 11232000
*       CALL ACTGVR;                /* PROCESS GVR           @Y30LB25*/ 11233000
         BAL   @14,ACTGVR                                          2494 11234000
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/ 11235000
*         THEN                      /* YES                   @Y30LB25*/ 11236000
         L     @06,RPLVPTR                                         2495 11237000
         LH    @06,RPLVRETC(,@06)                                  2495 11238000
         N     @06,@CF01129                                        2495 11239000
         LTR   @06,@06                                             2495 11240000
         BNZ   @RT02495                                            2495 11241000
*         RETURN;                   /*                       @Y30LB25*/ 11242000
*     END;                          /*                       @Y30LB25*/ 11243000
*                                                                  2497 11244000
*   /*****************************************************************/ 11245000
*   /*                                                               */ 11246000
*   /* PROCESS THE DELETED BVR                               @Y30LB25*/ 11247000
*   /*                                                               */ 11248000
*   /*****************************************************************/ 11249000
*                                                                  2498 11250000
*   CALL PROCBVR;                   /* PROCESS BVR           @Y30LB25*/ 11251000
@RF02492 BAL   @14,PROCBVR                                         2498 11252000
*   RETURN;                         /*                       @Y30LB25*/ 11253000
         B     @EL00059                                            2499 11254000
*   END ELMACTV2;                   /*                       @Y30LB25*/ 11255000
         B     @EL00059                                            2500 11256000
*                                                                  2501 11257000
*   /*****************************************************************/ 11258000
*   /*                                                               */ 11259000
*   /* PROCEDURE NAME - DEACTV2                              @Y30LB25*/ 11260000
*   /*                                                       @Y30LB25*/ 11261000
*   /* FUNCTION -                                            @Y30LB25*/ 11262000
*   /* PROCESS THE DEACTIVATION OF AN ACTIVE                 @Y30LB25*/ 11263000
*   /* VOLUME AFTER THE MSC WAS CALLED.                      @Y30LB25*/ 11264000
*   /*                                                       @Y30LB25*/ 11265000
*   /* RESTRICTIONS -                                        @Y30LB25*/ 11266000
*   /* GROUP CHANGES DURING ACTIVATE OF A VOLUME SUCH AS -   @Y30LB25*/ 11267000
*   /* CHANGING A VOLUME FROM GENERAL-USE TO RESTICTED OR    @Y30LB25*/ 11268000
*   /* RESTRICTED TO GENERAL-USE, REMOVING OR ADDING A       @Y30LB25*/ 11269000
*   /* VOLUME TO A GROUP, OR CHANGING A VOLUME FROM ONE      @Y30LB25*/ 11270000
*   /* GROUP TO ANOTHER GROUP, WILL CAUSE INVENTORY          @Y30LB25*/ 11271000
*   /* PROBLEMS.                                             @Y30LB25*/ 11272000
*   /*                                                       @Y30LB25*/ 11273000
*   /* INPUT -                                               @Y30LB25*/ 11274000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 11275000
*   /*                                                       @Y30LB25*/ 11276000
*   /* OUTPUT -                                              @Y30LB25*/ 11277000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 11278000
*   /* AN ERROR                                              @Y30LB25*/ 11279000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 11280000
*   /*                                                               */ 11281000
*   /*****************************************************************/ 11282000
*                                                                  2501 11283000
*DEACTV2:                           /*                       @Y30LB25*/ 11284000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 11285000
*                                                                  2501 11286000
DEACTV2  ST    @14,@SA00060                                        2501 11287000
*   /*****************************************************************/ 11288000
*   /*                                                               */ 11289000
*   /* CHECK FOR AN MSC ERROR.                               @Y30LB25*/ 11290000
*   /*                                                               */ 11291000
*   /*****************************************************************/ 11292000
*                                                                  2502 11293000
*   IF RPLRCODE^=FIXZERO            /* MSC ERROR?            @Y30LB25*/ 11294000
*     THEN                          /* YES                   @Y30LB25*/ 11295000
         L     @06,RPLVPTR                                         2502 11296000
         LH    @15,RPLRCODE(,@06)                                  2502 11297000
         N     @15,@CF01129                                        2502 11298000
         LTR   @15,@15                                             2502 11299000
         BZ    @RF02502                                            2502 11300000
*     DO;                           /*                       @Y30LB25*/ 11301000
*       RPLVRETC=RPLVRETC&&RPLVRETC;/* ZERO RETN CODE        @Y30LB25*/ 11302000
         XC    RPLVRETC(2,@06),RPLVRETC(@06)                       2504 11303000
*       RPLRCODE=RPLRCODE&&RPLRCODE;/* ZERO RESN CODE        @Y30LB25*/ 11304000
         XC    RPLRCODE(2,@06),RPLRCODE(@06)                       2505 11305000
*       RETURN;                     /*                       @Y30LB25*/ 11306000
@EL00060 DS    0H                                                  2506 11307000
@EF00060 DS    0H                                                  2506 11308000
@ER00060 L     @14,@SA00060                                        2506 11309000
         BR    @14                                                 2506 11310000
*     END;                          /*                       @Y30LB25*/ 11311000
*   CALL HOUSKEEP;                  /* JRNL RPLV &           @Y30LB25   11312000
*                                      RESERVE .MSVI         @Y30LB25*/ 11313000
*                                                                  2508 11314000
@RF02502 BAL   @14,HOUSKEEP                                        2508 11315000
*   /*****************************************************************/ 11316000
*   /*                                                               */ 11317000
*   /* GET THE BVR                                           @Y30LB25*/ 11318000
*   /*                                                               */ 11319000
*   /*****************************************************************/ 11320000
*                                                                  2509 11321000
*   BVOLKY=DEFVOLD;                 /* SET VOLID             @Y30LB25*/ 11322000
         MVC   BVOLKY(6),DEFVOLD(DEFVPTR)                          2509 11323000
*   RPLVKEY=ADDR(BKEY);             /* SET KEY ADDR          @Y30LB25*/ 11324000
         LA    @06,BKEY                                            2510 11325000
         L     @01,RPLVPTR                                         2510 11326000
         ST    @06,RPLVKEY(,@01)                                   2510 11327000
*   CALL READUPD1;                  /* READ BVR              @Y30LB25*/ 11328000
         BAL   @14,READUPD1                                        2511 11329000
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/ 11330000
*     THEN                          /* YES                   @Y30LB25*/ 11331000
         L     @06,RPLVPTR                                         2512 11332000
         LH    @06,RPLVRETC(,@06)                                  2512 11333000
         N     @06,@CF01129                                        2512 11334000
         LTR   @06,@06                                             2512 11335000
         BNZ   @RT02512                                            2512 11336000
*     RETURN;                       /*                       @Y30LB25*/ 11337000
*                                                                  2513 11338000
*   /*****************************************************************/ 11339000
*   /*                                                               */ 11340000
*   /* MAKE BVR REFLECT INACTIVE VOLUME                      @Y30LB25*/ 11341000
*   /*                                                               */ 11342000
*   /*****************************************************************/ 11343000
*                                                                  2514 11344000
*   BASEBUF=BASEBUF1;               /* USE CORRECT BUF       @Y30LB25*/ 11345000
         MVC   BASEBUF(224),BASEBUF1                               2514 11346000
*   BASINAC=ON;                     /* MAKE INACTIVE         @Y30LB25*/ 11347000
*                                                                  2515 11348000
         L     @06,BASEVPTR                                        2515 11349000
         OI    BASINAC(@06),B'00000100'                            2515 11350000
*   /*****************************************************************/ 11351000
*   /*                                                               */ 11352000
*   /* CHECK FOR AN EXTENSION (IEZDEFVE)                     @Y30LB25*/ 11353000
*   /*                                                               */ 11354000
*   /*****************************************************************/ 11355000
*                                                                  2516 11356000
*   IF DEFVVEXT^=FIXZERO            /* A DEFVE?              @Y30LB25*/ 11357000
*     THEN                          /* YES                   @Y30LB25*/ 11358000
         L     @15,DEFVVEXT(,DEFVPTR)                              2516 11359000
         LTR   @15,@15                                             2516 11360000
         BZ    @RF02516                                            2516 11361000
*     DO;                           /*                       @Y30LB25*/ 11362000
*       BCDVPTR=BASEVPTR;           /* SET COM MAP PTR       @Y30LB25*/ 11363000
         ST    @06,BCDVPTR                                         2518 11364000
*       CALL PRODEFVE;              /* PROCESS DEFVE         @Y30LB25*/ 11365000
         BAL   @14,PRODEFVE                                        2519 11366000
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/ 11367000
*         THEN                      /* YES                   @Y30LB25*/ 11368000
         L     @06,RPLVPTR                                         2520 11369000
         LH    @06,RPLVRETC(,@06)                                  2520 11370000
         N     @06,@CF01129                                        2520 11371000
         LTR   @06,@06                                             2520 11372000
         BNZ   @RT02520                                            2520 11373000
*         RETURN;                   /*                       @Y30LB25*/ 11374000
*     END;                          /*                       @Y30LB25*/ 11375000
*                                                                  2522 11376000
*   /*****************************************************************/ 11377000
*   /*                                                               */ 11378000
*   /* CHECK IF VOLUME IS GROUPED                            @Y30LB25*/ 11379000
*   /*                                                               */ 11380000
*   /*****************************************************************/ 11381000
*                                                                  2523 11382000
*   IF BASGRPV=ON                   /* GROUPED?              @Y30LB25*/ 11383000
*     THEN                          /* YES                   @Y30LB25*/ 11384000
@RF02516 L     @06,BASEVPTR                                        2523 11385000
         TM    BASGRPV(@06),B'00100000'                            2523 11386000
         BNO   @RF02523                                            2523 11387000
*     DO;                           /*                       @Y30LB25*/ 11388000
*                                                                  2524 11389000
*       /*************************************************************/ 11390000
*       /*                                                           */ 11391000
*       /* GET AND UPDATE THE GROUP VOLUME RECORD            @Y30LB25*/ 11392000
*       /*                                                           */ 11393000
*       /*************************************************************/ 11394000
*                                                                  2525 11395000
*       GROUPKY=BASGROUP;           /* SET GROUP NAME        @Y30LB25*/ 11396000
         MVC   GROUPKY(8),BASGROUP(@06)                            2525 11397000
*       RPLVKEY=ADDR(GKEY);         /* ADDR OF KEY           @Y30LB25*/ 11398000
         LA    @06,GKEY                                            2526 11399000
         L     @01,RPLVPTR                                         2526 11400000
         ST    @06,RPLVKEY(,@01)                                   2526 11401000
*       CALL READUPD1;              /* READ GVR              @Y30LB25*/ 11402000
         BAL   @14,READUPD1                                        2527 11403000
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/ 11404000
*         THEN                      /* YES                   @Y30LB25*/ 11405000
         L     @06,RPLVPTR                                         2528 11406000
         LH    @06,RPLVRETC(,@06)                                  2528 11407000
         N     @06,@CF01129                                        2528 11408000
         LTR   @06,@06                                             2528 11409000
         BNZ   @RT02528                                            2528 11410000
*         RETURN;                   /*                       @Y30LB25*/ 11411000
*       GROUPBUF=BASEBUF1;          /* USE CORRECT BUFF      @Y30LB25*/ 11412000
         MVC   GROUPBUF(224),BASEBUF1                              2530 11413000
*       GRONINAC=GRONINAC+FIXONE;   /* INCR # INACT VOLS     @Y30LB25*/ 11414000
         L     @06,GROUPPTR                                        2531 11415000
         LA    @15,1                                               2531 11416000
         AH    @15,GRONINAC(,@06)                                  2531 11417000
         STH   @15,GRONINAC(,@06)                                  2531 11418000
*       IF BASRSTD=ON               /* RESTRICTED?           @Y30LB25*/ 11419000
*         THEN                      /* YES                   @Y30LB25*/ 11420000
         L     @01,BASEVPTR                                        2532 11421000
         TM    BASRSTD(@01),B'00001000'                            2532 11422000
         BNO   @RF02532                                            2532 11423000
*         GRONRSTD=GRONRSTD-FIXONE; /*                       @Y30LB25   11424000
*                                      DECR # RSTD VOLS      @Y30LB25*/ 11425000
         LH    @15,GRONRSTD(,@06)                                  2533 11426000
         BCTR  @15,0                                               2533 11427000
         STH   @15,GRONRSTD(,@06)                                  2533 11428000
*       ELSE                        /* CK GEN-USE            @Y30LB25*/ 11429000
*         IF BASGENUS=ON            /* GENERAL-USE?          @Y30LB25*/ 11430000
*           THEN                    /* YES                   @Y30LB25*/ 11431000
         B     @RC02532                                            2534 11432000
@RF02532 L     @06,BASEVPTR                                        2534 11433000
         TM    BASGENUS(@06),B'00010000'                           2534 11434000
         BNO   @RF02534                                            2534 11435000
*           DO;                     /*                       @Y30LB25*/ 11436000
*             GRONGEN=GRONGEN-FIXONE;/*                      @Y30LB25   11437000
*                                      DECR # G-USE VOLS     @Y30LB25*/ 11438000
*                                                                  2536 11439000
         L     @06,GROUPPTR                                        2536 11440000
         LH    @15,GRONGEN(,@06)                                   2536 11441000
         BCTR  @15,0                                               2536 11442000
         STH   @15,GRONGEN(,@06)                                   2536 11443000
*             /*******************************************************/ 11444000
*             /*                                                     */ 11445000
*             /* PROCESS GROUP VOLUME RECORD                 @Y30LB25*/ 11446000
*             /*                                                     */ 11447000
*             /*******************************************************/ 11448000
*                                                                  2537 11449000
*             ADDSUBGR=OFF;         /* SUBTRACT              @Y30LB25*/ 11450000
         NI    ADDSUBGR,B'11110111'                                2537 11451000
*             CALL VUPGH;           /* UPDATE GVR            @Y30LB25*/ 11452000
         BAL   @14,VUPGH                                           2538 11453000
*           END;                    /*                       @Y30LB25*/ 11454000
*       RPLVBUF=ADDR(GROUPBUF);     /* GVR BUF ADDR          @Y30LB25*/ 11455000
@RF02534 DS    0H                                                  2540 11456000
@RC02532 LA    @06,GROUPBUF                                        2540 11457000
         L     @01,RPLVPTR                                         2540 11458000
         ST    @06,RPLVBUF(,@01)                                   2540 11459000
*       CALL WRITRECD;              /* WRITE GVR             @Y30LB25*/ 11460000
         BAL   @14,WRITRECD                                        2541 11461000
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/ 11462000
*         THEN                      /* YES                   @Y30LB25*/ 11463000
         L     @06,RPLVPTR                                         2542 11464000
         LH    @06,RPLVRETC(,@06)                                  2542 11465000
         N     @06,@CF01129                                        2542 11466000
         LTR   @06,@06                                             2542 11467000
         BNZ   @RT02542                                            2542 11468000
*         RETURN;                   /*                       @Y30LB25*/ 11469000
*                                                                  2543 11470000
*       /*************************************************************/ 11471000
*       /*                                                           */ 11472000
*       /* CHECK FOR GENERAL-USE                             @Y30LB25*/ 11473000
*       /*                                                           */ 11474000
*       /*************************************************************/ 11475000
*                                                                  2544 11476000
*       IF BASGENUS=ON              /* GENERAL-USE?          @Y30LB25*/ 11477000
*         THEN                      /* YES                   @Y30LB25*/ 11478000
*                                                                  2544 11479000
         L     @06,BASEVPTR                                        2544 11480000
         TM    BASGENUS(@06),B'00010000'                           2544 11481000
         BNO   @RF02544                                            2544 11482000
*         /***********************************************************/ 11483000
*         /*                                                         */ 11484000
*         /* DELETE A GROUP VOLUME SERIAL NUMBER EXTENSION SLOT      */ 11485000
*         /*                                                 @Y30LB25*/ 11486000
*         /*                                                         */ 11487000
*         /***********************************************************/ 11488000
*                                                                  2545 11489000
*         DO;                       /*                       @Y30LB25*/ 11490000
*           EXPSLOT=OFF;            /* NO EXPIR DATE         @Y30LB25*/ 11491000
         NI    EXPSLOT,B'01111111'                                 2546 11492000
*           ADDSUBSL=OFF;           /* SUBTRACT              @Y30LB25*/ 11493000
         NI    ADDSUBSL,B'11111101'                                2547 11494000
*           CALL ICBVUEXT(GROUPPTR,BASEVPTR,RPLVPTR,PASSBYTE);/*   2548 11495000
*                                                            @Y30LB25   11496000
*                                      CREATE A SLOT         @Y30LB25*/ 11497000
         L     @15,@CV00767                                        2548 11498000
         LA    @01,@AL02548                                        2548 11499000
         BALR  @14,@15                                             2548 11500000
*           IF RPLVRETC^=FIXZERO    /*                       @Y30LB25   11501000
*                                      ERROR?                @Y30LB25*/ 11502000
*             THEN                  /* YES                   @Y30LB25*/ 11503000
         L     @06,RPLVPTR                                         2549 11504000
         LH    @06,RPLVRETC(,@06)                                  2549 11505000
         N     @06,@CF01129                                        2549 11506000
         LTR   @06,@06                                             2549 11507000
         BNZ   @RT02549                                            2549 11508000
*             RETURN;               /*                       @Y30LB25*/ 11509000
*         END;                      /*                       @Y30LB25*/ 11510000
*     END;                          /*                       @Y30LB25*/ 11511000
*                                                                  2552 11512000
@RF02544 DS    0H                                                  2553 11513000
*   /*****************************************************************/ 11514000
*   /*                                                               */ 11515000
*   /* REESABLISH BVR RPL                                    @Y30LB25*/ 11516000
*   /*                                                               */ 11517000
*   /*****************************************************************/ 11518000
*                                                                  2553 11519000
*   BVOLKY=BASSERNO;                /* RESET VOLID           @Y30LB25*/ 11520000
@RF02523 L     @06,BASEVPTR                                        2553 11521000
         MVC   BVOLKY(6),BASSERNO(@06)                             2553 11522000
*   RPLVKEY=ADDR(BKEY);             /* SET KEY ADDR          @Y30LB25*/ 11523000
         LA    @06,BKEY                                            2554 11524000
         L     @01,RPLVPTR                                         2554 11525000
         ST    @06,RPLVKEY(,@01)                                   2554 11526000
*   CALL READUPD1;                  /* READ BVR              @Y30LB25*/ 11527000
         BAL   @14,READUPD1                                        2555 11528000
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/ 11529000
*     THEN                          /* YES                   @Y30LB25*/ 11530000
         L     @06,RPLVPTR                                         2556 11531000
         LH    @15,RPLVRETC(,@06)                                  2556 11532000
         N     @15,@CF01129                                        2556 11533000
         LTR   @15,@15                                             2556 11534000
         BNZ   @RT02556                                            2556 11535000
*     RETURN;                       /*                       @Y30LB25*/ 11536000
*   RPLVBUF=ADDR(BASEBUF);          /* BUFF ADDR             @Y30LB25*/ 11537000
         LA    @15,BASEBUF                                         2558 11538000
         ST    @15,RPLVBUF(,@06)                                   2558 11539000
*   CALL WRITRECD;                  /* WRITE BVR             @Y30LB25*/ 11540000
         BAL   @14,WRITRECD                                        2559 11541000
*   RETURN;                         /*                       @Y30LB25*/ 11542000
         B     @EL00060                                            2560 11543000
*   END DEACTV2;                    /*                       @Y30LB25*/ 11544000
         B     @EL00060                                            2561 11545000
*                                                                  2562 11546000
*   /*****************************************************************/ 11547000
*   /*                                                               */ 11548000
*   /* ENTRY NAME - ICBVUCHI                                 @Y30LB25*/ 11549000
*   /*                                                       @Y30LB25*/ 11550000
*   /* FUNCTION - CHAIN A BVR INTO EITHER A GROUP VOLUME     @Y30LB25*/ 11551000
*   /* RECORD (GVR) OR A NON-GROUP VOLUME RECORD (NGVR).     @Y30LB25*/ 11552000
*   /* FOR A NGVR THIS ROUTINE WILL GET, UPDATE, AND WRITE   @Y30LB25*/ 11553000
*   /* IT. THE CALLER MUST WRITE THE BASE VOLUME RECORD      @Y30LB25*/ 11554000
*   /* (BVR) WHICH WAS CHAINED IN TO EITHER THE GVR OR       @Y30LB25*/ 11555000
*   /* NGVR. ALSO, IF THE BVR WAS CHAINED IN THE GVR,        @Y30LB25*/ 11556000
*   /* THEN THE CALLER MUST SUPPLY AND THEN WRITE THE        @Y30LB25*/ 11557000
*   /* GVR. FINALLY, THE CALLER MUST FIRST UPDATE THE        @Y30LB25*/ 11558000
*   /* NUMBER OF GENERAL-USE, RESTRICTED, OR INACTIVE        @Y30LB25*/ 11559000
*   /* VOLUMES IN THE GVR.                                   @Y30LB25*/ 11560000
*   /*                                                       @Y30LB25*/ 11561000
*   /* INPUT -                                               @Y30LB25*/ 11562000
*   /* MSVC REQUEST PARAMETER LIST PTR IN RPLVPTR            @Y30LB25*/ 11563000
*   /* GROUP VOLUME RECORD PTR IN GROUPPTR (OPTIONAL)        @Y30LB25*/ 11564000
*   /* BASE VOLUME RECORD PTR IN BASEVPTR                    @Y30LB25*/ 11565000
*   /* FLAG IN PASSBYTE                                      @Y30LB25*/ 11566000
*   /* INDICATES GROUPED OR NON-GROUPED                      @Y30LB25*/ 11567000
*   /*                                                       @Y30LB25*/ 11568000
*   /* OUTPUT -                                              @Y30LB25*/ 11569000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 11570000
*   /* NON-GROUP VOLUME RECORD                               @Y30LB25*/ 11571000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 11572000
*   /* AN ERROR                                              @Y30LB25*/ 11573000
*   /*                                                               */ 11574000
*   /*****************************************************************/ 11575000
*                                                                  2562 11576000
*ICBVUCHI:                          /*                       @Y30LB25*/ 11577000
*   ENTRY(PTRGROUP,PTRBASEV,PTRRPLV,BYTEPASS);/*             @Y30LB25*/ 11578000
*                                                                  2562 11579000
@EP02562 MVC   @PC00001(16),0(@01)                                 2562 11580000
*   /*****************************************************************/ 11581000
*   /*                                                               */ 11582000
*   /* DECLARES FOR PASSED PARAMETERS                        @Y30LB25*/ 11583000
*   /* PTRGROUP, PTRBASEV, PTRRPLV, BYTEPASS                 @Y30LB25*/ 11584000
*   /*                                                               */ 11585000
*   /*****************************************************************/ 11586000
*                                                                  2563 11587000
*   DCL                                                            2563 11588000
*     PTRGROUP PTR(31);             /* PTR TO GVR            @Y30LB25*/ 11589000
*   DCL                                                            2564 11590000
*     PTRBASEV PTR(31);             /* PTR TO BVR            @Y30LB25*/ 11591000
*   DCL                                                            2565 11592000
*     PTRRPLV PTR(31);              /* RPLV PTR              @Y30LB25*/ 11593000
*   DCL                                                            2566 11594000
*     BYTEPASS CHAR(2);             /* GVR OR NGVR           @Y30LB25   11595000
*                                      ADD OR SUBTRACT       @Y30LB25*/ 11596000
*                                                                  2566 11597000
*   /*****************************************************************/ 11598000
*   /*                                                               */ 11599000
*   /* DECLARES                                              @Y30LB25*/ 11600000
*   /*                                                               */ 11601000
*   /*****************************************************************/ 11602000
*                                                                  2567 11603000
*   DCL                                                            2567 11604000
*     BASEBUF1 CHAR(LENGTH(BASEV)); /* BVR BUFFER            @Y30LB25*/ 11605000
*   DCL                                                            2568 11606000
*     SAVSERNO CHAR(6);             /* SAVE SERNO            @Y30LB25*/ 11607000
*   DCL                                                            2569 11608000
*     SAVSERN1 CHAR(6);             /* SAVE NEXT SERNO       @Y30LB25*/ 11609000
*   DCL                                                            2570 11610000
*     SAVBASPT PTR(31);             /* SAVE BVR PTR          @Y30LB25*/ 11611000
*   GROUPPTR=PTRGROUP;              /* SET GROUP PTR         @Y30LB25*/ 11612000
         L     @06,@PC00001                                        2571 11613000
         L     @06,PTRGROUP(,@06)                                  2571 11614000
         ST    @06,GROUPPTR                                        2571 11615000
*   BASEVPTR=PTRBASEV;              /* SET BASE PTR          @Y30LB25*/ 11616000
         L     @06,@PC00001+4                                      2572 11617000
         L     @06,PTRBASEV(,@06)                                  2572 11618000
         ST    @06,BASEVPTR                                        2572 11619000
*   RPLVPTR=PTRRPLV;                /* SET RPLV PTR          @Y30LB25*/ 11620000
         L     @06,@PC00001+8                                      2573 11621000
         L     @06,PTRRPLV(,@06)                                   2573 11622000
         ST    @06,RPLVPTR                                         2573 11623000
*   PASSBYTE=BYTEPASS;              /* GVR OR NGVR FLAG      @Y30LB25*/ 11624000
         L     @06,@PC00001+12                                     2574 11625000
         MVC   PASSBYTE(2),BYTEPASS(@06)                           2574 11626000
*   DIDKY=FIXONE;                   /* DVR ID OF 1           @Y30LB25*/ 11627000
         MVI   DIDKY,X'01'                                         2575 11628000
*   CIDKY=FIXONE;                   /* CVR ID OF 1           @Y30LB25*/ 11629000
         MVI   CIDKY,X'01'                                         2576 11630000
*   CALL VUCHI;                     /* CHAIN IN BVR          @Y30LB25*/ 11631000
         BAL   @14,VUCHI                                           2577 11632000
*   RETURN;                         /*                       @Y30LB25*/ 11633000
         B     @EL00001                                            2578 11634000
*                                                                  2579 11635000
*   /*****************************************************************/ 11636000
*   /*                                                               */ 11637000
*   /* PROCEDURE VUCHI IS CODED SO THAT COMMON ENTRY         @Y30LB25*/ 11638000
*   /* CODE IN ICBVUCHI CAN BE USED BY THIS MODULE           @Y30LB25*/ 11639000
*   /* AND BY OTHER MODULES. OTHER MODULES CALL              @Y30LB25*/ 11640000
*   /* ENTRY ICBVUCHI. THIS MODULE CALLS PROCEDURE           @Y30LB25*/ 11641000
*   /* VUCHI.                                                @Y30LB25*/ 11642000
*   /*                                                               */ 11643000
*   /*****************************************************************/ 11644000
*                                                                  2579 11645000
*VUCHI:                             /*                       @Y30LB25*/ 11646000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 11647000
VUCHI    ST    @14,@SA00061                                        2579 11648000
*   SAVBASPT=BASEVPTR;              /* SAVE BVR PTR          @Y30LB25*/ 11649000
         L     SAVBASPT,BASEVPTR                                   2580 11650000
*   NGVRPTR=ADDR(NGVRBUF);          /* MAP NGVR BUF          @ZDR2054*/ 11651000
         LA    NGVRPTR,NGVRBUF                                     2581 11652000
*   IF GRPFLG=ON                    /* GVR?                  @Y30LB25*/ 11653000
*     THEN                          /* YES                   @Y30LB25*/ 11654000
         TM    GRPFLG,B'00010000'                                  2582 11655000
         BNO   @RF02582                                            2582 11656000
*     DO;                           /*                       @Y30LB25*/ 11657000
*       CALL PROCGVRI;              /* PROCESS GVR           @Y30LB25*/ 11658000
         BAL   @14,PROCGVRI                                        2584 11659000
*       RETURN;                     /*                       @Y30LB25*/ 11660000
@EL00061 DS    0H                                                  2585 11661000
@EF00061 DS    0H                                                  2585 11662000
@ER00061 L     @14,@SA00061                                        2585 11663000
         BR    @14                                                 2585 11664000
*     END;                          /*                       @Y30LB25*/ 11665000
*                                                                  2586 11666000
*   /*****************************************************************/ 11667000
*   /*                                                               */ 11668000
*   /* READ FOR NON-GROUP VOLUME RECORD                      @Y30LB25*/ 11669000
*   /*                                                               */ 11670000
*   /*****************************************************************/ 11671000
*                                                                  2587 11672000
*   RPLVKEY=ADDR(NGKEY);            /* SET NGVR KEY          @Y30LB25*/ 11673000
@RF02582 LA    @03,NGKEY                                           2587 11674000
         L     @01,RPLVPTR                                         2587 11675000
         ST    @03,RPLVKEY(,@01)                                   2587 11676000
*   CALL READUPD1;                  /* READ NGVR             @Y30LB25*/ 11677000
         BAL   @14,READUPD1                                        2588 11678000
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/ 11679000
*     THEN                          /* YES                   @Y30LB25*/ 11680000
         L     @03,RPLVPTR                                         2589 11681000
         LH    @15,RPLVRETC(,@03)                                  2589 11682000
         N     @15,@CF01129                                        2589 11683000
         LTR   @15,@15                                             2589 11684000
         BNZ   @RT02589                                            2589 11685000
*     RETURN;                       /*                       @Y30LB25*/ 11686000
*   NGVRBUF=BASEBUF1;               /* USE CORRECT BUFF      @Y30LB25*/ 11687000
         MVC   NGVRBUF(224),BASEBUF1                               2591 11688000
*   RPLVBUF=ADDR(NGVRBUF);          /* BUF ADDR FOR WRITE    @Y30LB25*/ 11689000
*                                                                  2592 11690000
         LA    @15,NGVRBUF                                         2592 11691000
         ST    @15,RPLVBUF(,@03)                                   2592 11692000
*   /*****************************************************************/ 11693000
*   /*                                                               */ 11694000
*   /* BVR IS TO BE THE VERY FIRST VOLUME IN THE NGVR CHAIN. @Y30LB25*/ 11695000
*   /*                                                               */ 11696000
*   /*****************************************************************/ 11697000
*                                                                  2593 11698000
*   IF NGVNOVOL=FIXZERO             /* ANY VOLS IN CHAIN?    @Y30LB25*/ 11699000
*     THEN                          /* NO                    @Y30LB25*/ 11700000
         LH    @03,NGVNOVOL(,NGVRPTR)                              2593 11701000
         LTR   @03,@03                                             2593 11702000
         BNZ   @RF02593                                            2593 11703000
*     DO;                           /*                       @Y30LB25*/ 11704000
*       BASFIRST=ON;                /* FIRST IN CHAIN        @Y30LB25*/ 11705000
*       BASLAST=ON;                 /* ALSO LAST IN CHAIN    @Y30LB25*/ 11706000
         L     @06,BASEVPTR                                        2596 11707000
         OI    BASFIRST(@06),B'00011000'                           2596 11708000
*       BASPREV=BLANK6;             /* NO PREVIOUS BVR       @Y30LB25*/ 11709000
         MVI   BASPREV+1(@06),C' '                                 2597 11710000
         MVC   BASPREV+2(4,@06),BASPREV+1(@06)                     2597 11711000
         MVI   BASPREV(@06),C' '                                   2597 11712000
*       BASNEXTV=BLANK6;            /* NO NEXT BVR           @Y30LB25*/ 11713000
         MVI   BASNEXTV+1(@06),C' '                                2598 11714000
         MVC   BASNEXTV+2(4,@06),BASNEXTV+1(@06)                   2598 11715000
         MVI   BASNEXTV(@06),C' '                                  2598 11716000
*       NGVFVOL=BASSERNO;           /* 1ST SERIAL #          @Y30LB25*/ 11717000
         MVC   NGVFVOL(6,NGVRPTR),BASSERNO(@06)                    2599 11718000
*       NGVLVOL=BASSERNO;           /* LAST SERIAL #         @Y30LB25*/ 11719000
         MVC   NGVLVOL(6,NGVRPTR),BASSERNO(@06)                    2600 11720000
*       NGVNOVOL=FIXONE;            /* 1 VOL IN CHAIN        @Y30LB25*/ 11721000
         MVC   NGVNOVOL(2,NGVRPTR),@CH00046                        2601 11722000
*       CALL WRITRECD;              /* WRITE NGVR            @Y30LB25*/ 11723000
         BAL   @14,WRITRECD                                        2602 11724000
*       RETURN;                     /*                       @Y30LB25*/ 11725000
         B     @EL00061                                            2603 11726000
*     END;                          /*                       @Y30LB25*/ 11727000
*                                                                  2604 11728000
*   /*****************************************************************/ 11729000
*   /*                                                               */ 11730000
*   /* BVR TO BE FIRST IN THE EXISTING CHAIN                 @Y30LB25*/ 11731000
*   /*                                                               */ 11732000
*   /*****************************************************************/ 11733000
*                                                                  2605 11734000
*   IF BASSERNO<NGVFVOL             /* FIRST IN CHAIN?       @Y30LB25*/ 11735000
*     THEN                          /* YES                   @Y30LB25*/ 11736000
@RF02593 L     @03,BASEVPTR                                        2605 11737000
         CLC   BASSERNO(6,@03),NGVFVOL(NGVRPTR)                    2605 11738000
         BNL   @RF02605                                            2605 11739000
*     DO;                           /*                       @Y30LB25*/ 11740000
*       BASNEXTV=NGVFVOL;           /* PT TO OLD 1ST BVR     @Y30LB25*/ 11741000
         MVC   BASNEXTV(6,@03),NGVFVOL(NGVRPTR)                    2607 11742000
*       BASPREV=BLANK6;             /* NO PREVIOUS BVR       @Y30LB25*/ 11743000
         MVI   BASPREV+1(@03),C' '                                 2608 11744000
         MVC   BASPREV+2(4,@03),BASPREV+1(@03)                     2608 11745000
         MVI   BASPREV(@03),C' '                                   2608 11746000
*       NGVFVOL=BASSERNO;           /* NEW 1ST BVR           @Y30LB25*/ 11747000
         MVC   NGVFVOL(6,NGVRPTR),BASSERNO(@03)                    2609 11748000
*       BASFIRST=ON;                /* 1ST FLAG ON           @Y30LB25*/ 11749000
*       BASLAST=OFF;                /* NOT LAST IN CHAIN     @Y30LB25*/ 11750000
         OI    BASFIRST(@03),B'00010000'                           2611 11751000
         NI    BASLAST(@03),B'11110111'                            2611 11752000
*       NGVNOVOL=NGVNOVOL+FIXONE;   /* INCREM # VOLS         @Y30LB25*/ 11753000
         LA    @03,1                                               2612 11754000
         AH    @03,NGVNOVOL(,NGVRPTR)                              2612 11755000
         STH   @03,NGVNOVOL(,NGVRPTR)                              2612 11756000
*       CALL WRITRECD;              /* WRITE NGVR            @Y30LB25*/ 11757000
         BAL   @14,WRITRECD                                        2613 11758000
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/ 11759000
*         THEN                      /* YES                   @Y30LB25*/ 11760000
         L     @03,RPLVPTR                                         2614 11761000
         LH    @15,RPLVRETC(,@03)                                  2614 11762000
         N     @15,@CF01129                                        2614 11763000
         LTR   @15,@15                                             2614 11764000
         BNZ   @RT02614                                            2614 11765000
*         RETURN;                   /*                       @Y30LB25*/ 11766000
*       BVOLKY=BASNEXTV;            /* KEY - OLD 1ST BVR     @Y30LB25*/ 11767000
         L     @01,BASEVPTR                                        2616 11768000
         MVC   BVOLKY(6),BASNEXTV(@01)                             2616 11769000
*       RPLVKEY=ADDR(BKEY);         /* SET KEY ADDR          @Y30LB25*/ 11770000
         LA    @15,BKEY                                            2617 11771000
         ST    @15,RPLVKEY(,@03)                                   2617 11772000
*       CALL READUPD1;              /* GET OLD 1ST BVR       @Y30LB25*/ 11773000
         BAL   @14,READUPD1                                        2618 11774000
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/ 11775000
*         THEN                      /* YES                   @Y30LB25*/ 11776000
         L     @03,RPLVPTR                                         2619 11777000
         LH    @03,RPLVRETC(,@03)                                  2619 11778000
         N     @03,@CF01129                                        2619 11779000
         LTR   @03,@03                                             2619 11780000
         BNZ   @RT02619                                            2619 11781000
*         RETURN;                   /*                       @Y30LB25*/ 11782000
*       BASEVPTR=ADDR(BASEBUF1);    /* OLD 1ST BVR BUF       @Y30LB25*/ 11783000
         LA    @03,BASEBUF1                                        2621 11784000
         ST    @03,BASEVPTR                                        2621 11785000
*       BASFIRST=OFF;               /* 1ST IN CHAIN OFF      @Y30LB25*/ 11786000
         NI    BASFIRST(@03),B'11101111'                           2622 11787000
*       BASPREV=NGVFVOL;            /* PT BACK CHAIN         @Y30LB25*/ 11788000
         MVC   BASPREV(6,@03),NGVFVOL(NGVRPTR)                     2623 11789000
*       BASEVPTR=SAVBASPT;          /* RESET BUF PTR         @Y30LB25*/ 11790000
         ST    SAVBASPT,BASEVPTR                                   2624 11791000
*       CALL WRITRECD;              /* WRITE BVR             @Y30LB25*/ 11792000
         BAL   @14,WRITRECD                                        2625 11793000
*       RETURN;                     /*                       @Y30LB25*/ 11794000
         B     @EL00061                                            2626 11795000
*     END;                          /*                       @Y30LB25*/ 11796000
*                                                                  2627 11797000
*   /*****************************************************************/ 11798000
*   /*                                                               */ 11799000
*   /* BVR TO BE LAST IN THE EXISTING CHAIN                  @Y30LB25*/ 11800000
*   /*                                                               */ 11801000
*   /*****************************************************************/ 11802000
*                                                                  2628 11803000
*   IF BASSERNO>NGVLVOL             /* LAST IN CHAIN?        @Y30LB25*/ 11804000
*     THEN                          /* YES                   @Y30LB25*/ 11805000
@RF02605 L     @03,BASEVPTR                                        2628 11806000
         CLC   BASSERNO(6,@03),NGVLVOL(NGVRPTR)                    2628 11807000
         BNH   @RF02628                                            2628 11808000
*     DO;                           /*                       @Y30LB25*/ 11809000
*       BASNEXTV=BLANK6;            /* NO NEXT BVR           @Y30LB25*/ 11810000
         MVI   BASNEXTV+1(@03),C' '                                2630 11811000
         MVC   BASNEXTV+2(4,@03),BASNEXTV+1(@03)                   2630 11812000
         MVI   BASNEXTV(@03),C' '                                  2630 11813000
*       BASPREV=NGVLVOL;            /* PT TO OLD LAST        @Y30LB25   11814000
*                                      IN CHAIN              @Y30LB25*/ 11815000
         MVC   BASPREV(6,@03),NGVLVOL(NGVRPTR)                     2631 11816000
*       NGVLVOL=BASSERNO;           /* NEW LAST BVR          @Y30LB25*/ 11817000
         MVC   NGVLVOL(6,NGVRPTR),BASSERNO(@03)                    2632 11818000
*       BASFIRST=OFF;               /* NOT 1ST IN CHAIN      @Y30LB25*/ 11819000
*       BASLAST=ON;                 /* SET LAST FLAG         @Y30LB25*/ 11820000
         OI    BASLAST(@03),B'00001000'                            2634 11821000
         NI    BASFIRST(@03),B'11101111'                           2634 11822000
*       NGVNOVOL=NGVNOVOL+FIXONE;   /* INCREM # VOLS         @Y30LB25*/ 11823000
         LA    @03,1                                               2635 11824000
         AH    @03,NGVNOVOL(,NGVRPTR)                              2635 11825000
         STH   @03,NGVNOVOL(,NGVRPTR)                              2635 11826000
*       CALL WRITRECD;              /* WRITE NGVR            @Y30LB25*/ 11827000
         BAL   @14,WRITRECD                                        2636 11828000
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/ 11829000
*         THEN                      /* YES                   @Y30LB25*/ 11830000
         L     @03,RPLVPTR                                         2637 11831000
         LH    @15,RPLVRETC(,@03)                                  2637 11832000
         N     @15,@CF01129                                        2637 11833000
         LTR   @15,@15                                             2637 11834000
         BNZ   @RT02637                                            2637 11835000
*         RETURN;                   /*                       @Y30LB25*/ 11836000
*       BVOLKY=BASPREV;             /* GET OLD LAST BVR      @Y30LB25*/ 11837000
         L     @01,BASEVPTR                                        2639 11838000
         MVC   BVOLKY(6),BASPREV(@01)                              2639 11839000
*       RPLVKEY=ADDR(BKEY);         /* SET KEY ADDR          @Y30LB25*/ 11840000
         LA    @15,BKEY                                            2640 11841000
         ST    @15,RPLVKEY(,@03)                                   2640 11842000
*       CALL READUPD1;              /* GET OLD LAST BVR      @Y30LB25*/ 11843000
         BAL   @14,READUPD1                                        2641 11844000
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/ 11845000
*         THEN                      /* YES                   @Y30LB25*/ 11846000
         L     @03,RPLVPTR                                         2642 11847000
         LH    @03,RPLVRETC(,@03)                                  2642 11848000
         N     @03,@CF01129                                        2642 11849000
         LTR   @03,@03                                             2642 11850000
         BNZ   @RT02642                                            2642 11851000
*         RETURN;                   /*                       @Y30LB25*/ 11852000
*       BASEVPTR=ADDR(BASEBUF1);    /* OLD 1ST BVR BUF       @Y30LB25*/ 11853000
         LA    @03,BASEBUF1                                        2644 11854000
         ST    @03,BASEVPTR                                        2644 11855000
*       BASLAST=OFF;                /* LAST IN CHAIN OFF     @Y30LB25*/ 11856000
         NI    BASLAST(@03),B'11110111'                            2645 11857000
*       BASNEXTV=NGVLVOL;           /* PT AHEAD CHAIN        @Y30LB25*/ 11858000
         MVC   BASNEXTV(6,@03),NGVLVOL(NGVRPTR)                    2646 11859000
*       BASEVPTR=SAVBASPT;          /* RESET BUF PTR         @Y30LB25*/ 11860000
         ST    SAVBASPT,BASEVPTR                                   2647 11861000
*       CALL WRITRECD;              /* WRITE BVR             @Y30LB25*/ 11862000
         BAL   @14,WRITRECD                                        2648 11863000
*       RETURN;                     /*                       @Y30LB25*/ 11864000
         B     @EL00061                                            2649 11865000
*     END;                          /*                       @Y30LB25*/ 11866000
*                                                                  2650 11867000
*   /*****************************************************************/ 11868000
*   /*                                                               */ 11869000
*   /* BVR IS BETWEEN FIRST AND LAST BVR IN THE CHAIN        @Y30LB25*/ 11870000
*   /*                                                               */ 11871000
*   /*****************************************************************/ 11872000
*                                                                  2651 11873000
*   NGVNOVOL=NGVNOVOL+FIXONE;       /* INCR # CHAIN VOLS     @Y30LB25*/ 11874000
@RF02628 LA    @03,1                                               2651 11875000
         AH    @03,NGVNOVOL(,NGVRPTR)                              2651 11876000
         STH   @03,NGVNOVOL(,NGVRPTR)                              2651 11877000
*   CALL WRITRECD;                  /* WRITE NGVR            @Y30LB25*/ 11878000
         BAL   @14,WRITRECD                                        2652 11879000
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/ 11880000
*     THEN                          /* YES                   @Y30LB25*/ 11881000
         L     @03,RPLVPTR                                         2653 11882000
         LH    @03,RPLVRETC(,@03)                                  2653 11883000
         N     @03,@CF01129                                        2653 11884000
         LTR   @03,@03                                             2653 11885000
         BNZ   @RT02653                                            2653 11886000
*     RETURN;                       /*                       @Y30LB25*/ 11887000
*   BVOLKY=NGVFVOL;                 /* BEGIN OF CHAIN        @Y30LB25*/ 11888000
         MVC   BVOLKY(6),NGVFVOL(NGVRPTR)                          2655 11889000
*   CALL PROCBVRI;                  /* CHAIN INTO CHAIN      @Y30LB25*/ 11890000
         BAL   @14,PROCBVRI                                        2656 11891000
*   RETURN;                         /*                       @Y30LB25*/ 11892000
         B     @EL00061                                            2657 11893000
*   END VUCHI;                      /*                       @Y30LB25*/ 11894000
         B     @EL00061                                            2658 11895000
*                                                                  2659 11896000
*   /*****************************************************************/ 11897000
*   /*                                                               */ 11898000
*   /* PROCEDURE NAME - PROCGVRI                             @Y30LB25*/ 11899000
*   /*                                                       @Y30LB25*/ 11900000
*   /* FUNCTION - CHAIN A BVR INTO A GROUP VOLUME            @Y30LB25*/ 11901000
*   /* RECORD (GVR).                                         @Y30LB25*/ 11902000
*   /*                                                       @Y30LB25*/ 11903000
*   /* INPUT -                                               @Y30LB25*/ 11904000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 11905000
*   /* GROUP VOLUME RECORD                                   @Y30LB25*/ 11906000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 11907000
*   /*                                                       @Y30LB25*/ 11908000
*   /* OUTPUT -                                              @Y30LB25*/ 11909000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 11910000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 11911000
*   /* AN ERROR                                              @Y30LB25*/ 11912000
*   /*                                                               */ 11913000
*   /*****************************************************************/ 11914000
*                                                                  2659 11915000
*PROCGVRI:                          /*                       @Y30LB25*/ 11916000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 11917000
*                                                                  2659 11918000
PROCGVRI ST    @14,@SA00062                                        2659 11919000
*   /*****************************************************************/ 11920000
*   /*                                                               */ 11921000
*   /* BVR IS TO BE THE VERY FIRST VOLUME IN THE GVR CHAIN.  @Y30LB25*/ 11922000
*   /*                                                               */ 11923000
*   /*****************************************************************/ 11924000
*                                                                  2660 11925000
*   IF GRONGEN+GRONRSTD+GRONINAC<FIXTWO/* SET BY CALLER      @Y30LB25*/ 11926000
*     THEN                          /* YES                   @Y30LB25*/ 11927000
         L     @15,GROUPPTR                                        2660 11928000
         LH    @14,GRONGEN(,@15)                                   2660 11929000
         AH    @14,GRONRSTD(,@15)                                  2660 11930000
         AH    @14,GRONINAC(,@15)                                  2660 11931000
         C     @14,@CF00044                                        2660 11932000
         BNL   @RF02660                                            2660 11933000
*     DO;                           /*                       @Y30LB25*/ 11934000
*       BASFIRST=ON;                /* 1ST IN CHAIN          @Y30LB25*/ 11935000
*       BASLAST=ON;                 /* LAST IN CHAIN         @Y30LB25*/ 11936000
         L     @06,BASEVPTR                                        2663 11937000
         OI    BASFIRST(@06),B'00011000'                           2663 11938000
*       BASPREV=BLANK6;             /* NO PREVIOUS BVR       @Y30LB25*/ 11939000
         MVI   BASPREV+1(@06),C' '                                 2664 11940000
         MVC   BASPREV+2(4,@06),BASPREV+1(@06)                     2664 11941000
         MVI   BASPREV(@06),C' '                                   2664 11942000
*       BASNEXTV=BLANK6;            /* NO NEXT BVR           @Y30LB25*/ 11943000
         MVI   BASNEXTV+1(@06),C' '                                2665 11944000
         MVC   BASNEXTV+2(4,@06),BASNEXTV+1(@06)                   2665 11945000
         MVI   BASNEXTV(@06),C' '                                  2665 11946000
*       GROFSN=BASSERNO;            /* 1ST SERIAL NUMBER     @Y30LB25*/ 11947000
         MVC   GROFSN(6,@15),BASSERNO(@06)                         2666 11948000
*       GROLSN=BASSERNO;            /* LAST SERIAL #         @Y30LB25*/ 11949000
         MVC   GROLSN(6,@15),BASSERNO(@06)                         2667 11950000
*       RETURN;                     /*                       @Y30LB25*/ 11951000
@EL00062 DS    0H                                                  2668 11952000
@EF00062 DS    0H                                                  2668 11953000
@ER00062 L     @14,@SA00062                                        2668 11954000
         BR    @14                                                 2668 11955000
*     END;                          /*                       @Y30LB25*/ 11956000
*                                                                  2669 11957000
*   /*****************************************************************/ 11958000
*   /*                                                               */ 11959000
*   /* BVR TO BE FIRST IN THE EXISTING CHAIN                 @Y30LB25*/ 11960000
*   /*                                                               */ 11961000
*   /*****************************************************************/ 11962000
*                                                                  2670 11963000
*   IF BASSERNO<GROFSN              /* 1ST IN CHAIN?         @Y30LB25*/ 11964000
*     THEN                          /* YES                   @Y30LB25*/ 11965000
@RF02660 L     @15,BASEVPTR                                        2670 11966000
         L     @14,GROUPPTR                                        2670 11967000
         CLC   BASSERNO(6,@15),GROFSN(@14)                         2670 11968000
         BNL   @RF02670                                            2670 11969000
*     DO;                           /*                       @Y30LB25*/ 11970000
*       BASPREV=BLANK6;             /* NO PREVIOUS BVR       @Y30LB25*/ 11971000
         MVI   BASPREV+1(@15),C' '                                 2672 11972000
         MVC   BASPREV+2(4,@15),BASPREV+1(@15)                     2672 11973000
         MVI   BASPREV(@15),C' '                                   2672 11974000
*       BASNEXTV=GROFSN;            /* PT TO OLD 1ST BVR     @Y30LB25*/ 11975000
         MVC   BASNEXTV(6,@15),GROFSN(@14)                         2673 11976000
*       GROFSN=BASSERNO;            /* NEW 1ST BVR           @Y30LB25*/ 11977000
         MVC   GROFSN(6,@14),BASSERNO(@15)                         2674 11978000
*       BASFIRST=ON;                /* 1ST FLAG ON           @Y30LB25*/ 11979000
*       BASLAST=OFF;                /* NOT LAST              @Y30LB25*/ 11980000
         OI    BASFIRST(@15),B'00010000'                           2676 11981000
         NI    BASLAST(@15),B'11110111'                            2676 11982000
*       BVOLKY=BASNEXTV;            /* KEY OF OLD 1ST BVR    @Y30LB25*/ 11983000
         MVC   BVOLKY(6),BASNEXTV(@15)                             2677 11984000
*       RPLVKEY=ADDR(BKEY);         /* SET KEY ADDR          @Y30LB25*/ 11985000
         LA    @15,BKEY                                            2678 11986000
         L     @14,RPLVPTR                                         2678 11987000
         ST    @15,RPLVKEY(,@14)                                   2678 11988000
*       CALL READUPD1;              /* GET OLD 1ST BVR       @Y30LB25*/ 11989000
         BAL   @14,READUPD1                                        2679 11990000
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/ 11991000
*         THEN                      /* YES                   @Y30LB25*/ 11992000
         L     @01,RPLVPTR                                         2680 11993000
         LH    @15,RPLVRETC(,@01)                                  2680 11994000
         N     @15,@CF01129                                        2680 11995000
         LTR   @15,@15                                             2680 11996000
         BNZ   @RT02680                                            2680 11997000
*         RETURN;                   /*                       @Y30LB25*/ 11998000
*       BASEVPTR=ADDR(BASEBUF1);    /* OLD 1ST BVR BUF       @Y30LB25*/ 11999000
         LA    @15,BASEBUF1                                        2682 12000000
         ST    @15,BASEVPTR                                        2682 12001000
*       BASFIRST=OFF;               /* 1ST FLAG OFF          @Y30LB25*/ 12002000
         NI    BASFIRST(@15),B'11101111'                           2683 12003000
*       BASPREV=GROFSN;             /* PT TO NEW 1ST BVR     @Y30LB25*/ 12004000
         L     @14,GROUPPTR                                        2684 12005000
         MVC   BASPREV(6,@15),GROFSN(@14)                          2684 12006000
*       BASEVPTR=SAVBASPT;          /* RESET BUF PTR         @Y30LB25*/ 12007000
         ST    SAVBASPT,BASEVPTR                                   2685 12008000
*       CALL WRITRECD;              /* WRITE BVR             @Y30LB25*/ 12009000
         BAL   @14,WRITRECD                                        2686 12010000
*       RETURN;                     /*                       @Y30LB25*/ 12011000
         B     @EL00062                                            2687 12012000
*     END;                          /*                       @Y30LB25*/ 12013000
*                                                                  2688 12014000
*   /*****************************************************************/ 12015000
*   /*                                                               */ 12016000
*   /* BVR TO BE LAST IN THE EXISTING CHAIN                  @Y30LB25*/ 12017000
*   /*                                                               */ 12018000
*   /*****************************************************************/ 12019000
*                                                                  2689 12020000
*   IF BASSERNO>GROLSN              /* LAST IN CHAIN?        @Y30LB25*/ 12021000
*     THEN                          /* YES                   @Y30LB25*/ 12022000
@RF02670 L     @15,BASEVPTR                                        2689 12023000
         L     @14,GROUPPTR                                        2689 12024000
         CLC   BASSERNO(6,@15),GROLSN(@14)                         2689 12025000
         BNH   @RF02689                                            2689 12026000
*     DO;                           /*                       @Y30LB25*/ 12027000
*       BASPREV=GROLSN;             /* PT TO OLD LAST        @Y30LB25   12028000
*                                      IN CHAIN              @Y30LB25*/ 12029000
         MVC   BASPREV(6,@15),GROLSN(@14)                          2691 12030000
*       BASNEXTV=BLANK6;            /* NO NEXT BVR           @Y30LB25*/ 12031000
         MVI   BASNEXTV+1(@15),C' '                                2692 12032000
         MVC   BASNEXTV+2(4,@15),BASNEXTV+1(@15)                   2692 12033000
         MVI   BASNEXTV(@15),C' '                                  2692 12034000
*       GROLSN=BASSERNO;            /* NEW LAST BVR          @Y30LB25*/ 12035000
         MVC   GROLSN(6,@14),BASSERNO(@15)                         2693 12036000
*       BASLAST=ON;                 /* LAST FLAG ON          @Y30LB25*/ 12037000
*       BASFIRST=OFF;               /* NOT 1ST IN CHAIN      @Y30LB25*/ 12038000
         OI    BASLAST(@15),B'00001000'                            2695 12039000
         NI    BASFIRST(@15),B'11101111'                           2695 12040000
*       BVOLKY=BASPREV;             /* OLD LAST BVR          @Y30LB25*/ 12041000
         MVC   BVOLKY(6),BASPREV(@15)                              2696 12042000
*       RPLVKEY=ADDR(BKEY);         /* SET KEY ADDR          @Y30LB25*/ 12043000
         LA    @15,BKEY                                            2697 12044000
         L     @14,RPLVPTR                                         2697 12045000
         ST    @15,RPLVKEY(,@14)                                   2697 12046000
*       CALL READUPD1;              /* GET OLD LAST BVR      @Y30LB25*/ 12047000
         BAL   @14,READUPD1                                        2698 12048000
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/ 12049000
*         THEN                      /* YES                   @Y30LB25*/ 12050000
         L     @01,RPLVPTR                                         2699 12051000
         LH    @15,RPLVRETC(,@01)                                  2699 12052000
         N     @15,@CF01129                                        2699 12053000
         LTR   @15,@15                                             2699 12054000
         BNZ   @RT02699                                            2699 12055000
*         RETURN;                   /*                       @Y30LB25*/ 12056000
*       BASEVPTR=ADDR(BASEBUF1);    /* OLD LAST BVR BUF      @Y30LB25*/ 12057000
         LA    @15,BASEBUF1                                        2701 12058000
         ST    @15,BASEVPTR                                        2701 12059000
*       BASLAST=OFF;                /* LAST FLAG OFF         @Y30LB25*/ 12060000
         NI    BASLAST(@15),B'11110111'                            2702 12061000
*       BASNEXTV=GROLSN;            /* PT TO NEW LAST BVR    @Y30LB25*/ 12062000
         L     @14,GROUPPTR                                        2703 12063000
         MVC   BASNEXTV(6,@15),GROLSN(@14)                         2703 12064000
*       BASEVPTR=SAVBASPT;          /* RESET BUF PTR         @Y30LB25*/ 12065000
         ST    SAVBASPT,BASEVPTR                                   2704 12066000
*       CALL WRITRECD;              /* WRITE BVR             @Y30LB25*/ 12067000
         BAL   @14,WRITRECD                                        2705 12068000
*       RETURN;                     /*                       @Y30LB25*/ 12069000
         B     @EL00062                                            2706 12070000
*     END;                          /*                       @Y30LB25*/ 12071000
*                                                                  2707 12072000
*   /*****************************************************************/ 12073000
*   /*                                                               */ 12074000
*   /* BVR IS BETWEEN FIRST AND LAST BVR IN THE CHAIN        @Y30LB25*/ 12075000
*   /*                                                               */ 12076000
*   /*****************************************************************/ 12077000
*                                                                  2708 12078000
*   BVOLKY=GROFSN;                  /* 1ST IN CHAIN          @Y30LB25*/ 12079000
@RF02689 L     @01,GROUPPTR                                        2708 12080000
         MVC   BVOLKY(6),GROFSN(@01)                               2708 12081000
*   CALL PROCBVRI;                  /* CHAIN INTO CHAIN      @Y30LB25*/ 12082000
         BAL   @14,PROCBVRI                                        2709 12083000
*   RETURN;                         /*                       @Y30LB25*/ 12084000
         B     @EL00062                                            2710 12085000
*   END PROCGVRI;                   /*                       @Y30LB25*/ 12086000
         B     @EL00062                                            2711 12087000
*                                                                  2712 12088000
*   /*****************************************************************/ 12089000
*   /*                                                               */ 12090000
*   /* PROCEDURE NAME - PROCBVRI                             @Y30LB25*/ 12091000
*   /*                                                       @Y30LB25*/ 12092000
*   /* FUNCTION - CHAIN A BVR INTO A GROUP VOLUME            @Y30LB25*/ 12093000
*   /* RECORD (GVR) OR NON-GROUP VOLUME RECORD (NGVR).       @Y30LB25*/ 12094000
*   /*                                                       @Y30LB25*/ 12095000
*   /* INPUT -                                               @Y30LB25*/ 12096000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 12097000
*   /* GROUP VOLUME RECORD                                   @Y30LB25*/ 12098000
*   /* NON-GROUP VOLUME RECORD                               @Y30LB25*/ 12099000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 12100000
*   /*                                                       @Y30LB25*/ 12101000
*   /* OUTPUT -                                              @Y30LB25*/ 12102000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 12103000
*   /* AN ERROR                                              @Y30LB25*/ 12104000
*   /*                                                               */ 12105000
*   /*****************************************************************/ 12106000
*                                                                  2712 12107000
*PROCBVRI:                          /*                       @Y30LB25*/ 12108000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 12109000
*                                                                  2712 12110000
PROCBVRI ST    @14,@SA00063                                        2712 12111000
*   /*****************************************************************/ 12112000
*   /*                                                               */ 12113000
*   /* CHECK FOR CHAIN IN AS SECOND IN THE CHAIN             @Y30LB25*/ 12114000
*   /*                                                               */ 12115000
*   /*****************************************************************/ 12116000
*                                                                  2713 12117000
*   SAVSERNO=BASSERNO;              /* SAVE - 1ST BVR        @Y30LB25*/ 12118000
         L     @01,BASEVPTR                                        2713 12119000
         MVC   SAVSERNO(6),BASSERNO(@01)                           2713 12120000
*   BASEVPTR=ADDR(BASEBUF1);        /* MAP FOR BUF           @Y30LB25*/ 12121000
         LA    @15,BASEBUF1                                        2714 12122000
         ST    @15,BASEVPTR                                        2714 12123000
*   RPLVKEY=ADDR(BKEY);             /* SET KEY ADDR          @Y30LB25*/ 12124000
         LA    @15,BKEY                                            2715 12125000
         L     @14,RPLVPTR                                         2715 12126000
         ST    @15,RPLVKEY(,@14)                                   2715 12127000
*   CALL READUPD1;                  /* READ 1ST BVR          @Y30LB25   12128000
*                                      IN CHAIN              @Y30LB25*/ 12129000
         BAL   @14,READUPD1                                        2716 12130000
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/ 12131000
*     THEN                          /* YES                   @Y30LB25*/ 12132000
         L     @01,RPLVPTR                                         2717 12133000
         LH    @15,RPLVRETC(,@01)                                  2717 12134000
         N     @15,@CF01129                                        2717 12135000
         LTR   @15,@15                                             2717 12136000
         BNZ   @RT02717                                            2717 12137000
*     RETURN;                       /*                       @Y30LB25*/ 12138000
*   IF BASNEXTV>SAVSERNO            /* 2ND IN CHAIN?         @Y30LB25*/ 12139000
*     THEN                          /* YES                   @Y30LB25*/ 12140000
         L     @15,BASEVPTR                                        2719 12141000
         CLC   BASNEXTV(6,@15),SAVSERNO                            2719 12142000
         BNH   @RF02719                                            2719 12143000
*     DO;                           /*                       @Y30LB25*/ 12144000
*       SAVSERN1=BASSERNO;          /* SAVE SERNO OF         @Y30LB25   12145000
*                                      BVR READ              @Y30LB25*/ 12146000
         MVC   SAVSERN1(6),BASSERNO(@15)                           2721 12147000
*       CALL CHAININ;               /* CHAIN IN NEW BVR      @Y30LB25*/ 12148000
         BAL   @14,CHAININ                                         2722 12149000
*       RETURN;                     /*                       @Y30LB25*/ 12150000
@EL00063 DS    0H                                                  2723 12151000
@EF00063 DS    0H                                                  2723 12152000
@ER00063 L     @14,@SA00063                                        2723 12153000
         BR    @14                                                 2723 12154000
*     END;                          /*                       @Y30LB25*/ 12155000
*                                                                  2724 12156000
*   /*****************************************************************/ 12157000
*   /*                                                               */ 12158000
*   /* BVR TO BE CHAINED IN AFTER SECOND BVR IN THE CHAIN    @Y30LB25*/ 12159000
*   /*                                                               */ 12160000
*   /*****************************************************************/ 12161000
*                                                                  2725 12162000
*   DO WHILE BASNEXTV<SAVSERNO;     /* LOOP THRU CHAIN       @Y30LB25*/ 12163000
@RF02719 B     @DE02725                                            2725 12164000
@DL02725 DS    0H                                                  2726 12165000
*     BVOLKY=BASNEXTV;              /* SAVE KEY FOR          @Y30LB25   12166000
*                                      NEXT READ             @Y30LB25*/ 12167000
         L     @01,BASEVPTR                                        2726 12168000
         MVC   BVOLKY(6),BASNEXTV(@01)                             2726 12169000
*     RPLVKEY=ADDR(BKEY);           /* SET KEY ADDR          @Y30LB25*/ 12170000
         LA    @15,BKEY                                            2727 12171000
         L     @14,RPLVPTR                                         2727 12172000
         ST    @15,RPLVKEY(,@14)                                   2727 12173000
*     CALL READUPD1;                /* READ A BVR            @Y30LB25*/ 12174000
         BAL   @14,READUPD1                                        2728 12175000
*     IF RPLVRETC^=FIXZERO          /* LOOP CONTROL          @Y30LB25*/ 12176000
*       THEN                        /* ERROR                 @Y30LB25*/ 12177000
         L     @01,RPLVPTR                                         2729 12178000
         LH    @15,RPLVRETC(,@01)                                  2729 12179000
         N     @15,@CF01129                                        2729 12180000
         LTR   @15,@15                                             2729 12181000
         BNZ   @RT02729                                            2729 12182000
*       RETURN;                     /*                       @Y30LB25*/ 12183000
*     SAVSERN1=BASSERNO;            /* SAVE SERNO OF BVR     @Y30LB25*/ 12184000
         L     @01,BASEVPTR                                        2731 12185000
         MVC   SAVSERN1(6),BASSERNO(@01)                           2731 12186000
*   END;                            /*                       @Y30LB25*/ 12187000
@DE02725 L     @01,BASEVPTR                                        2732 12188000
         CLC   BASNEXTV(6,@01),SAVSERNO                            2732 12189000
         BL    @DL02725                                            2732 12190000
*   CALL CHAININ;                   /* CHAIN IN NEW BVR      @Y30LB25*/ 12191000
         BAL   @14,CHAININ                                         2733 12192000
*   RETURN;                         /*                       @Y30LB25*/ 12193000
         B     @EL00063                                            2734 12194000
*   END PROCBVRI;                   /*                       @Y30LB25*/ 12195000
         B     @EL00063                                            2735 12196000
*                                                                  2736 12197000
*   /*****************************************************************/ 12198000
*   /*                                                               */ 12199000
*   /* PROCEDURE NAME - READUPD1                             @Y30LB25*/ 12200000
*   /*                                                       @Y30LB25*/ 12201000
*   /* FUNCTION -                                            @Y30LB25*/ 12202000
*   /* READ AN MSVC RECORD FOR UPDATE INTO BASEBUF1          @Y30LB25*/ 12203000
*   /*                                                       @Y30LB25*/ 12204000
*   /* INPUT -                                               @Y30LB25*/ 12205000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 12206000
*   /* ADDRESS OF KEY TO READ IN RPLVKEY                     @Y30LB25*/ 12207000
*   /*                                                       @Y30LB25*/ 12208000
*   /* OUTPUT -                                              @Y30LB25*/ 12209000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 12210000
*   /* AN ERROR                                              @Y30LB25*/ 12211000
*   /* MSVC RECORD                                           @Y30LB25*/ 12212000
*   /*                                                               */ 12213000
*   /*****************************************************************/ 12214000
*                                                                  2736 12215000
*READUPD1:                          /*                       @Y30LB25*/ 12216000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 12217000
READUPD1 ST    @14,@SA00064                                        2736 12218000
*   RPLVBUF=ADDR(BASEBUF1);         /* ADDR OF BUF           @Y30LB25*/ 12219000
         L     @03,RPLVPTR                                         2737 12220000
         LA    @15,BASEBUF1                                        2737 12221000
         ST    @15,RPLVBUF(,@03)                                   2737 12222000
*   RPLVBLN=LENGTH(BASEBUF1);       /* BVR BUF LENGTH        @Y30LB25*/ 12223000
         MVC   RPLVBLN(4,@03),@CF01103                             2738 12224000
*   RPLVTYP=RPLVREAD;               /* READ                  @Y30LB25*/ 12225000
         MVI   RPLVTYP(@03),X'00'                                  2739 12226000
*   RPLVDIR=ON;                     /* DIRECT                @Y30LB25*/ 12227000
         OI    RPLVDIR(@03),B'01000000'                            2740 12228000
*   RPLVUPD=ON;                     /* UPDATE                @Y30LB25*/ 12229000
         OI    RPLVUPD(@03),B'00000010'                            2741 12230000
*   RPLVLOC=OFF;                    /* NO LOCATE             @Y30LB25*/ 12231000
         NI    RPLVLOC(@03),B'01111111'                            2742 12232000
*   RESPECIFY                       /*                       @Y30LB25*/ 12233000
*     RG1 RSTD;                     /* RESTRICT REG 1        @Y30LB25*/ 12234000
*   RG1=RPLVPTR;                    /* SET RPLV PTR          @Y30LB25*/ 12235000
         LR    RG1,@03                                             2744 12236000
*   CALL ICBVIO00;                  /* READ BVR              @Y30LB25*/ 12237000
         L     @15,@CV00762                                        2745 12238000
         BALR  @14,@15                                             2745 12239000
*   RESPECIFY                       /*                       @Y30LB25*/ 12240000
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @Y30LB25*/ 12241000
*   RETURN;                         /*                       @Y30LB25*/ 12242000
@EL00064 DS    0H                                                  2747 12243000
@EF00064 DS    0H                                                  2747 12244000
@ER00064 L     @14,@SA00064                                        2747 12245000
         BR    @14                                                 2747 12246000
*   END READUPD1;                   /*                       @Y30LB25*/ 12247000
*                                                                  2749 12248000
*   /*****************************************************************/ 12249000
*   /*                                                               */ 12250000
*   /* PROCEDURE NAME - WRITRECD                             @Y30LB25*/ 12251000
*   /*                                                       @Y30LB25*/ 12252000
*   /* FUNCTION - WRITE AN MSVC RECORD.                      @Y30LB25*/ 12253000
*   /*                                                       @Y30LB25*/ 12254000
*   /* INPUT -                                               @Y30LB25*/ 12255000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 12256000
*   /* MSVC RECORD                                           @Y30LB25*/ 12257000
*   /*                                                       @Y30LB25*/ 12258000
*   /* OUTPUT -                                              @Y30LB25*/ 12259000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 12260000
*   /* AN ERROR                                              @Y30LB25*/ 12261000
*   /*                                                               */ 12262000
*   /*****************************************************************/ 12263000
*                                                                  2749 12264000
*WRITRECD:                          /*                       @Y30LB25*/ 12265000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 12266000
WRITRECD ST    @14,@SA00065                                        2749 12267000
*   RPLVTYP=RPLVPUT;                /* WRITE                 @Y30LB25*/ 12268000
         L     @03,RPLVPTR                                         2750 12269000
         MVI   RPLVTYP(@03),X'01'                                  2750 12270000
*   RPLVLOC=OFF;                    /* NO LOC                @Y30LB25*/ 12271000
         NI    RPLVLOC(@03),B'01111111'                            2751 12272000
*   RESPECIFY                       /*                       @Y30LB25*/ 12273000
*     RG1 RSTD;                     /* RESTRICT REG 1        @Y30LB25*/ 12274000
*   RG1=RPLVPTR;                    /* SET RPLV PTR          @Y30LB25*/ 12275000
         LR    RG1,@03                                             2753 12276000
*   CALL ICBVIO00;                  /* WRITE BVR             @Y30LB25*/ 12277000
         L     @15,@CV00762                                        2754 12278000
         BALR  @14,@15                                             2754 12279000
*   RESPECIFY                       /*                       @Y30LB25*/ 12280000
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @Y30LB25*/ 12281000
*   RETURN;                         /*                       @Y30LB25*/ 12282000
@EL00065 DS    0H                                                  2756 12283000
@EF00065 DS    0H                                                  2756 12284000
@ER00065 L     @14,@SA00065                                        2756 12285000
         BR    @14                                                 2756 12286000
*   END WRITRECD;                   /*                       @Y30LB25*/ 12287000
*                                                                  2758 12288000
*   /*****************************************************************/ 12289000
*   /*                                                               */ 12290000
*   /* PROCEDURE NAME - CHAININ                              @Y30LB25*/ 12291000
*   /*                                                       @Y30LB25*/ 12292000
*   /* FUNCTION - CHAIN A BVR INTO TNE CHAIN OF BVRS OFF     @Y30LB25*/ 12293000
*   /* OF EITHER THE GROUP VOLUME RECORD (GVR) OR NON-GROUP  @Y30LB25*/ 12294000
*   /* VOLUME RECORD (NGVR).                                 @Y30LB25*/ 12295000
*   /*                                                       @Y30LB25*/ 12296000
*   /* INPUT -                                               @Y30LB25*/ 12297000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 12298000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 12299000
*   /*                                                       @Y30LB25*/ 12300000
*   /* OUTPUT -                                              @Y30LB25*/ 12301000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 12302000
*   /* AN ERROR                                              @Y30LB25*/ 12303000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 12304000
*   /*                                                               */ 12305000
*   /*****************************************************************/ 12306000
*                                                                  2758 12307000
*CHAININ:                           /*                       @Y30LB25*/ 12308000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 12309000
CHAININ  ST    @14,@SA00066                                        2758 12310000
*   BVOLKY=BASNEXTV;                /* SET KEY FOR           @Y30LB25   12311000
*                                      NEXT READ             @Y30LB25*/ 12312000
         L     @15,BASEVPTR                                        2759 12313000
         MVC   BVOLKY(6),BASNEXTV(@15)                             2759 12314000
*   BASNEXTV=SAVSERNO;              /* PT TO NEW BVR         @Y30LB25*/ 12315000
         MVC   BASNEXTV(6,@15),SAVSERNO                            2760 12316000
*   CALL WRITRECD;                  /* WRITE BVR             @Y30LB25*/ 12317000
         BAL   @14,WRITRECD                                        2761 12318000
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/ 12319000
*     THEN                          /* YES?                  @Y30LB25*/ 12320000
         L     @15,RPLVPTR                                         2762 12321000
         LH    @14,RPLVRETC(,@15)                                  2762 12322000
         N     @14,@CF01129                                        2762 12323000
         LTR   @14,@14                                             2762 12324000
         BNZ   @RT02762                                            2762 12325000
*     RETURN;                       /*                       @Y30LB25*/ 12326000
*   RPLVKEY=ADDR(BKEY);             /* SET KEY ADDR          @Y30LB25*/ 12327000
         LA    @14,BKEY                                            2764 12328000
         ST    @14,RPLVKEY(,@15)                                   2764 12329000
*   CALL READUPD1;                  /* READ NEXT BVR IN      @Y30LB25   12330000
*                                      CHAIN                 @Y30LB25*/ 12331000
         BAL   @14,READUPD1                                        2765 12332000
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/ 12333000
*     THEN                          /* YES?                  @Y30LB25*/ 12334000
         L     @01,RPLVPTR                                         2766 12335000
         LH    @15,RPLVRETC(,@01)                                  2766 12336000
         N     @15,@CF01129                                        2766 12337000
         LTR   @15,@15                                             2766 12338000
         BNZ   @RT02766                                            2766 12339000
*     RETURN;                       /*                       @Y30LB25*/ 12340000
*   BASPREV=SAVSERNO;               /* PT BACK TO NEW BVR    @Y30LB25*/ 12341000
         L     @01,BASEVPTR                                        2768 12342000
         MVC   BASPREV(6,@01),SAVSERNO                             2768 12343000
*   CALL WRITRECD;                  /* WTITE BVR             @Y30LB25*/ 12344000
         BAL   @14,WRITRECD                                        2769 12345000
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/ 12346000
*     THEN                          /* YES?                  @Y30LB25*/ 12347000
         L     @01,RPLVPTR                                         2770 12348000
         LH    @15,RPLVRETC(,@01)                                  2770 12349000
         N     @15,@CF01129                                        2770 12350000
         LTR   @15,@15                                             2770 12351000
         BNZ   @RT02770                                            2770 12352000
*     RETURN;                       /*                       @Y30LB25*/ 12353000
*   BASEVPTR=SAVBASPT;              /* PT TO NEW BVR         @Y30LB25*/ 12354000
*                                                                  2772 12355000
         ST    SAVBASPT,BASEVPTR                                   2772 12356000
*   /*****************************************************************/ 12357000
*   /*                                                               */ 12358000
*   /* CHAIN IN NEW BVR                                      @Y30LB25*/ 12359000
*   /*                                                               */ 12360000
*   /*****************************************************************/ 12361000
*                                                                  2773 12362000
*   BASFIRST=OFF;                   /* NOT 1ST IN CHAIN      @Y30LB25*/ 12363000
*   BASLAST=OFF;                    /* NOT LAST IN CHAIN     @Y30LB25*/ 12364000
         L     @06,BASEVPTR                                        2774 12365000
         NI    BASFIRST(@06),B'11100111'                           2774 12366000
*   BASPREV=SAVSERN1;               /* CHAIN BACK            @Y30LB25*/ 12367000
         MVC   BASPREV(6,@06),SAVSERN1                             2775 12368000
*   BASNEXTV=BVOLKY;                /* CHAIN AHEAD           @Y30LB25*/ 12369000
         MVC   BASNEXTV(6,@06),BVOLKY                              2776 12370000
*   RETURN;                         /*                       @Y30LB25*/ 12371000
@EL00066 DS    0H                                                  2777 12372000
@EF00066 DS    0H                                                  2777 12373000
@ER00066 L     @14,@SA00066                                        2777 12374000
         BR    @14                                                 2777 12375000
*   END CHAININ;                    /*                       @Y30LB25*/ 12376000
         B     @EL00066                                            2778 12377000
*                                                                  2779 12378000
*   /*****************************************************************/ 12379000
*   /*                                                               */ 12380000
*   /* ENTRY NAME - ICBVUCHO                                 @Y30LB25*/ 12381000
*   /*                                                       @Y30LB25*/ 12382000
*   /* FUNCTION - CHAIN A BVR OUT OF EITHER A GROUP VOLUME   @Y30LB25*/ 12383000
*   /* RECORD (GVR) OR A NON-GROUP VOLUME RECORD (NGVR).     @Y30LB25*/ 12384000
*   /* FOR A NGVR THIS ROUTINE WILL GET, UPDATE, AND WRITE   @Y30LB25*/ 12385000
*   /* IT. THE CALLER MUST WRITE THE BASE VOLUME RECORD      @Y30LB25*/ 12386000
*   /* (BVR) WHICH WAS CHAINED OUT OF EITHER THE GVR OR      @Y30LB25*/ 12387000
*   /* NGVR. ALSO, IF THE BVR IS CHAINED IN THE GVR,         @Y30LB25*/ 12388000
*   /* THEN THE CALLER MUST SUPPLY AND THEN WRITE THE        @Y30LB25*/ 12389000
*   /* GVR. FINALLY, THE CALLER MUST FIRST UPDATE THE        @Y30LB25*/ 12390000
*   /* NUMBER OF GENERAL-USE, RESTRICTED, OR INACTIVE        @Y30LB25*/ 12391000
*   /* VOLUMES IN THE GVR.                                   @Y30LB25*/ 12392000
*   /*                                                       @Y30LB25*/ 12393000
*   /* INPUT -                                               @Y30LB25*/ 12394000
*   /* MSVC REQUEST PARAMETER LIST PTR IN RPLVPTR            @Y30LB25*/ 12395000
*   /* GROUP VOLUME RECORD PTR IN GROUPPTR (OPTIONAL)        @Y30LB25*/ 12396000
*   /* BASE VOLUME RECORD PTR IN BASEVPTR                    @Y30LB25*/ 12397000
*   /* FLAG IN PASSBYTE                                      @Y30LB25*/ 12398000
*   /* INDICATES GROUPED OR NON-GROUPED                      @Y30LB25*/ 12399000
*   /*                                                       @Y30LB25*/ 12400000
*   /* OUTPUT -                                              @Y30LB25*/ 12401000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 12402000
*   /* NON-GROUP VOLUME RECORD                               @Y30LB25*/ 12403000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 12404000
*   /* AN ERROR                                              @Y30LB25*/ 12405000
*   /*                                                               */ 12406000
*   /*****************************************************************/ 12407000
*                                                                  2779 12408000
*ICBVUCHO:                          /*                       @Y30LB25*/ 12409000
*   ENTRY(PTRGROUP,PTRBASEV,PTRRPLV,BYTEPASS);/*             @Y30LB25*/ 12410000
*                                                                  2779 12411000
@EP02779 MVC   @PC00001(16),0(@01)                                 2779 12412000
*   /*****************************************************************/ 12413000
*   /*                                                               */ 12414000
*   /* DECLARES FOR PASSED PARAMETERS                        @Y30LB25*/ 12415000
*   /* PTRGROUP, PTRBASEV, PTRRPLV, BYTEPASS                 @Y30LB25*/ 12416000
*   /* ARE DECLARED IN ICBVUCHI.                             @Y30LB25*/ 12417000
*   /*                                                               */ 12418000
*   /*****************************************************************/ 12419000
*                                                                  2780 12420000
*   DCL                                                            2780 12421000
*     SAVPREV CHAR(6);              /* SAVE PREV SERNO       @Y30LB25*/ 12422000
*   DCL                                                            2781 12423000
*     SAVNEXT CHAR(6);              /* SAVE NEXT SERNO       @Y30LB25*/ 12424000
*   GROUPPTR=PTRGROUP;              /* SET GROUP PTR         @Y30LB25*/ 12425000
         L     @06,@PC00001                                        2782 12426000
         L     @06,PTRGROUP(,@06)                                  2782 12427000
         ST    @06,GROUPPTR                                        2782 12428000
*   BASEVPTR=PTRBASEV;              /* SET BASE PTR          @Y30LB25*/ 12429000
         L     @06,@PC00001+4                                      2783 12430000
         L     @06,PTRBASEV(,@06)                                  2783 12431000
         ST    @06,BASEVPTR                                        2783 12432000
*   RPLVPTR=PTRRPLV;                /* SET RPLV PTR          @Y30LB25*/ 12433000
         L     @06,@PC00001+8                                      2784 12434000
         L     @06,PTRRPLV(,@06)                                   2784 12435000
         ST    @06,RPLVPTR                                         2784 12436000
*   PASSBYTE=BYTEPASS;              /* GVR OR NGVR FLAG      @Y30LB25*/ 12437000
         L     @06,@PC00001+12                                     2785 12438000
         MVC   PASSBYTE(2),BYTEPASS(@06)                           2785 12439000
*   DIDKY=FIXONE;                   /* DVR ID OF 1           @Y30LB25*/ 12440000
         MVI   DIDKY,X'01'                                         2786 12441000
*   CIDKY=FIXONE;                   /* CVR ID OF 1           @Y30LB25*/ 12442000
         MVI   CIDKY,X'01'                                         2787 12443000
*   CALL VUCHO;                     /* CHAIN OUT BVR         @Y30LB25*/ 12444000
         BAL   @14,VUCHO                                           2788 12445000
*   RETURN;                         /*                       @Y30LB25*/ 12446000
         B     @EL00001                                            2789 12447000
*                                                                  2790 12448000
*   /*****************************************************************/ 12449000
*   /*                                                               */ 12450000
*   /* PROCEDURE VUCHO IS CODED SO THAT COMMON ENTRY         @Y30LB25*/ 12451000
*   /* CODE IN ICBVUCHO CAN BE USED BY THIS MODULE           @Y30LB25*/ 12452000
*   /* AND BY OTHER MODULES. OTHER MODULES CALL              @Y30LB25*/ 12453000
*   /* ENTRY ICBVUCHO. THIS MODULE CALLS PROCEDURE           @Y30LB25*/ 12454000
*   /* VUCHO.                                                @Y30LB25*/ 12455000
*   /*                                                               */ 12456000
*   /*****************************************************************/ 12457000
*                                                                  2790 12458000
*VUCHO:                             /*                       @Y30LB25*/ 12459000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 12460000
VUCHO    ST    @14,@SA00067                                        2790 12461000
*   SAVBASPT=BASEVPTR;              /* SAVE BUF PTR          @Y30LB25*/ 12462000
         L     SAVBASPT,BASEVPTR                                   2791 12463000
*   NGVRPTR=ADDR(NGVRBUF);          /* MAP NGVR BUF          @ZDR2054*/ 12464000
         LA    NGVRPTR,NGVRBUF                                     2792 12465000
*   IF GRPFLG=ON                    /* GVR?                  @Y30LB25*/ 12466000
*     THEN                          /* YES                   @Y30LB25*/ 12467000
         TM    GRPFLG,B'00010000'                                  2793 12468000
         BNO   @RF02793                                            2793 12469000
*     DO;                           /*                       @Y30LB25*/ 12470000
*       CALL PROCGVRO;              /* PROCESS GVR           @Y30LB25*/ 12471000
         BAL   @14,PROCGVRO                                        2795 12472000
*       BASEVPTR=SAVBASPT;          /* RESTORE BVR PTR       @Y30LB25*/ 12473000
         ST    SAVBASPT,BASEVPTR                                   2796 12474000
*       RETURN;                     /*                       @Y30LB25*/ 12475000
@EL00067 DS    0H                                                  2797 12476000
@EF00067 DS    0H                                                  2797 12477000
@ER00067 L     @14,@SA00067                                        2797 12478000
         BR    @14                                                 2797 12479000
*     END;                          /*                       @Y30LB25*/ 12480000
*                                                                  2798 12481000
*   /*****************************************************************/ 12482000
*   /*                                                               */ 12483000
*   /* READ FOR NON-GROUP VOLUME RECORD                      @Y30LB25*/ 12484000
*   /*                                                               */ 12485000
*   /*****************************************************************/ 12486000
*                                                                  2799 12487000
*   RPLVKEY=ADDR(NGKEY);            /* SET NGVR KEY          @Y30LB25*/ 12488000
@RF02793 LA    @03,NGKEY                                           2799 12489000
         L     @01,RPLVPTR                                         2799 12490000
         ST    @03,RPLVKEY(,@01)                                   2799 12491000
*   CALL READUPD1;                  /* READ NGVR             @Y30LB25*/ 12492000
         BAL   @14,READUPD1                                        2800 12493000
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/ 12494000
*     THEN                          /* YES                   @Y30LB25*/ 12495000
         L     @03,RPLVPTR                                         2801 12496000
         LH    @15,RPLVRETC(,@03)                                  2801 12497000
         N     @15,@CF01129                                        2801 12498000
         LTR   @15,@15                                             2801 12499000
         BNZ   @RT02801                                            2801 12500000
*     RETURN;                       /*                       @Y30LB25*/ 12501000
*   RPLVBUF=ADDR(NGVRBUF);          /* BUF ADDR              @Y30LB25*/ 12502000
         LA    @15,NGVRBUF                                         2803 12503000
         ST    @15,RPLVBUF(,@03)                                   2803 12504000
*   NGVRBUF=BASEBUF1;               /* USE CORRECT BUFF      @Y30LB25*/ 12505000
*                                                                  2804 12506000
         MVC   NGVRBUF(224),BASEBUF1                               2804 12507000
*   /*****************************************************************/ 12508000
*   /*                                                               */ 12509000
*   /* BVR FIRST IN THE CHAIN                                @Y30LB25*/ 12510000
*   /*                                                               */ 12511000
*   /*****************************************************************/ 12512000
*                                                                  2805 12513000
*   IF BASSERNO=NGVFVOL             /* FIRST IN CHAIN?       @Y30LB25*/ 12514000
*     THEN                          /* YES                   @Y30LB25*/ 12515000
         L     @03,BASEVPTR                                        2805 12516000
         CLC   BASSERNO(6,@03),NGVFVOL(NGVRPTR)                    2805 12517000
         BNE   @RF02805                                            2805 12518000
*     DO;                           /*                       @Y30LB25*/ 12519000
*       NGVFVOL=BASNEXTV;           /* PT TO NEW 1ST BVR     @Y30LB25*/ 12520000
         MVC   NGVFVOL(6,NGVRPTR),BASNEXTV(@03)                    2807 12521000
*       NGVNOVOL=NGVNOVOL-FIXONE;   /* DECREM # VOLS         @Y30LB25*/ 12522000
*                                                                  2808 12523000
         LH    @03,NGVNOVOL(,NGVRPTR)                              2808 12524000
         BCTR  @03,0                                               2808 12525000
         STH   @03,NGVNOVOL(,NGVRPTR)                              2808 12526000
*       /*************************************************************/ 12527000
*       /*                                                           */ 12528000
*       /* CHECK IF BVRS ARE IN THE CHAIN.                   @Y30LB25*/ 12529000
*       /*                                                           */ 12530000
*       /*************************************************************/ 12531000
*                                                                  2809 12532000
*       IF NGVNOVOL=FIXZERO         /* NONE IN CHAIN?        @Y30LB25*/ 12533000
*         THEN                      /* NO BVRS IN CHAIN      @Y30LB25*/ 12534000
         LTR   @03,@03                                             2809 12535000
         BNZ   @RF02809                                            2809 12536000
*         DO;                       /*                       @Y30LB25*/ 12537000
*           NGVLVOL=BLANK6;         /* NO LAST VOL           @Y30LB25*/ 12538000
         MVI   NGVLVOL+1(NGVRPTR),C' '                             2811 12539000
         MVC   NGVLVOL+2(4,NGVRPTR),NGVLVOL+1(NGVRPTR)             2811 12540000
         MVI   NGVLVOL(NGVRPTR),C' '                               2811 12541000
*           CALL WRITRECD;          /* WRITE NGVR            @Y30LB25*/ 12542000
         BAL   @14,WRITRECD                                        2812 12543000
*           RETURN;                 /*                       @Y30LB25*/ 12544000
         B     @EL00067                                            2813 12545000
*         END;                      /*                       @Y30LB25*/ 12546000
*                                                                  2814 12547000
*       /*************************************************************/ 12548000
*       /*                                                           */ 12549000
*       /* STILL BVRS LEFT IN THE CHAIN.                     @Y30LB25*/ 12550000
*       /*                                                           */ 12551000
*       /*************************************************************/ 12552000
*                                                                  2815 12553000
*       CALL WRITRECD;              /* WRITE NGVR            @Y30LB25*/ 12554000
@RF02809 BAL   @14,WRITRECD                                        2815 12555000
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/ 12556000
*         THEN                      /* YES                   @Y30LB25*/ 12557000
         L     @15,RPLVPTR                                         2816 12558000
         LH    @14,RPLVRETC(,@15)                                  2816 12559000
         N     @14,@CF01129                                        2816 12560000
         LTR   @14,@14                                             2816 12561000
         BNZ   @RT02816                                            2816 12562000
*         RETURN;                   /*                       @Y30LB25*/ 12563000
*       BVOLKY=BASNEXTV;            /* KEY - NEW 1ST BVR     @Y30LB25*/ 12564000
         L     @01,BASEVPTR                                        2818 12565000
         MVC   BVOLKY(6),BASNEXTV(@01)                             2818 12566000
*       RPLVKEY=ADDR(BKEY);         /* SET KEY ADDR          @Y30LB25*/ 12567000
         LA    @14,BKEY                                            2819 12568000
         ST    @14,RPLVKEY(,@15)                                   2819 12569000
*       CALL READUPD1;              /* GET NEW 1ST BVR       @Y30LB25*/ 12570000
         BAL   @14,READUPD1                                        2820 12571000
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/ 12572000
*         THEN                      /* YES                   @Y30LB25*/ 12573000
         L     @01,RPLVPTR                                         2821 12574000
         LH    @15,RPLVRETC(,@01)                                  2821 12575000
         N     @15,@CF01129                                        2821 12576000
         LTR   @15,@15                                             2821 12577000
         BNZ   @RT02821                                            2821 12578000
*         RETURN;                   /*                       @Y30LB25*/ 12579000
*       BASEVPTR=ADDR(BASEBUF1);    /* NEW 1ST BVR BUF       @Y30LB25*/ 12580000
         LA    @15,BASEBUF1                                        2823 12581000
         ST    @15,BASEVPTR                                        2823 12582000
*       BASFIRST=ON;                /* 1ST IN CHAIN ON       @Y30LB25*/ 12583000
         OI    BASFIRST(@15),B'00010000'                           2824 12584000
*       BASPREV=BLANK6;             /* NULL PT BACK          @Y30LB25*/ 12585000
         MVI   BASPREV+1(@15),C' '                                 2825 12586000
         MVC   BASPREV+2(4,@15),BASPREV+1(@15)                     2825 12587000
         MVI   BASPREV(@15),C' '                                   2825 12588000
*       BASEVPTR=SAVBASPT;          /* RESET BUF PTR         @Y30LB25*/ 12589000
         ST    SAVBASPT,BASEVPTR                                   2826 12590000
*       CALL WRITRECD;              /* WRITE BVR             @Y30LB25*/ 12591000
         BAL   @14,WRITRECD                                        2827 12592000
*       RETURN;                     /*                       @Y30LB25*/ 12593000
         B     @EL00067                                            2828 12594000
*     END;                          /*                       @Y30LB25*/ 12595000
*                                                                  2829 12596000
*   /*****************************************************************/ 12597000
*   /*                                                               */ 12598000
*   /* BVR LAST IN THE CHAIN                                 @Y30LB25*/ 12599000
*   /*                                                               */ 12600000
*   /*****************************************************************/ 12601000
*                                                                  2830 12602000
*   IF BASSERNO=NGVLVOL             /* LAST IN CHAIN?        @Y30LB25*/ 12603000
*     THEN                          /* YES                   @Y30LB25*/ 12604000
@RF02805 L     @03,BASEVPTR                                        2830 12605000
         CLC   BASSERNO(6,@03),NGVLVOL(NGVRPTR)                    2830 12606000
         BNE   @RF02830                                            2830 12607000
*     DO;                           /*                       @Y30LB25*/ 12608000
*       NGVLVOL=BASPREV;            /* PT TO NEW LAST        @Y30LB25   12609000
*                                      IN CHAIN              @Y30LB25*/ 12610000
         MVC   NGVLVOL(6,NGVRPTR),BASPREV(@03)                     2832 12611000
*       NGVNOVOL=NGVNOVOL-FIXONE;   /* DECREM # VOLS         @Y30LB25*/ 12612000
*                                                                  2833 12613000
         LH    @03,NGVNOVOL(,NGVRPTR)                              2833 12614000
         BCTR  @03,0                                               2833 12615000
         STH   @03,NGVNOVOL(,NGVRPTR)                              2833 12616000
*       /*************************************************************/ 12617000
*       /*                                                           */ 12618000
*       /* CHECK IF BVRS ARE IN THE CHAIN.                   @Y30LB25*/ 12619000
*       /*                                                           */ 12620000
*       /*************************************************************/ 12621000
*                                                                  2834 12622000
*       IF NGVNOVOL=FIXZERO         /* NONE IN CHAIN?        @Y30LB25*/ 12623000
*         THEN                      /* NO BVRS IN CHAIN      @Y30LB25*/ 12624000
         LTR   @03,@03                                             2834 12625000
         BNZ   @RF02834                                            2834 12626000
*         DO;                       /*                       @Y30LB25*/ 12627000
*           NGVFVOL=BLANK6;         /* NO FIRST VOL          @Y30LB25*/ 12628000
         MVI   NGVFVOL+1(NGVRPTR),C' '                             2836 12629000
         MVC   NGVFVOL+2(4,NGVRPTR),NGVFVOL+1(NGVRPTR)             2836 12630000
         MVI   NGVFVOL(NGVRPTR),C' '                               2836 12631000
*           CALL WRITRECD;          /* WRITE NGVR            @Y30LB25*/ 12632000
         BAL   @14,WRITRECD                                        2837 12633000
*           RETURN;                 /*                       @Y30LB25*/ 12634000
         B     @EL00067                                            2838 12635000
*         END;                      /*                       @Y30LB25*/ 12636000
*                                                                  2839 12637000
*       /*************************************************************/ 12638000
*       /*                                                           */ 12639000
*       /* STILL BVRS LEFT IN THE CHAIN.                     @Y30LB25*/ 12640000
*       /*                                                           */ 12641000
*       /*************************************************************/ 12642000
*                                                                  2840 12643000
*       CALL WRITRECD;              /* WRITE NGVR            @Y30LB25*/ 12644000
@RF02834 BAL   @14,WRITRECD                                        2840 12645000
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/ 12646000
*         THEN                      /* YES                   @Y30LB25*/ 12647000
         L     @15,RPLVPTR                                         2841 12648000
         LH    @14,RPLVRETC(,@15)                                  2841 12649000
         N     @14,@CF01129                                        2841 12650000
         LTR   @14,@14                                             2841 12651000
         BNZ   @RT02841                                            2841 12652000
*         RETURN;                   /*                       @Y30LB25*/ 12653000
*       BVOLKY=BASPREV;             /* GET NEW LAST BVR      @Y30LB25*/ 12654000
         L     @01,BASEVPTR                                        2843 12655000
         MVC   BVOLKY(6),BASPREV(@01)                              2843 12656000
*       RPLVKEY=ADDR(BKEY);         /* SET KEY ADDR          @Y30LB25*/ 12657000
         LA    @14,BKEY                                            2844 12658000
         ST    @14,RPLVKEY(,@15)                                   2844 12659000
*       CALL READUPD1;              /* READ NEW LAST BVR     @Y30LB25*/ 12660000
         BAL   @14,READUPD1                                        2845 12661000
*       IF RPLVRETC^=FIXZERO        /* ERROR?                @Y30LB25*/ 12662000
*         THEN                      /* YES                   @Y30LB25*/ 12663000
         L     @01,RPLVPTR                                         2846 12664000
         LH    @15,RPLVRETC(,@01)                                  2846 12665000
         N     @15,@CF01129                                        2846 12666000
         LTR   @15,@15                                             2846 12667000
         BNZ   @RT02846                                            2846 12668000
*         RETURN;                   /*                       @Y30LB25*/ 12669000
*       BASEVPTR=ADDR(BASEBUF1);    /* NEW 1ST BVR BUF       @Y30LB25*/ 12670000
         LA    @15,BASEBUF1                                        2848 12671000
         ST    @15,BASEVPTR                                        2848 12672000
*       BASLAST=ON;                 /* LAST IN CHAIN ON      @Y30LB25*/ 12673000
         OI    BASLAST(@15),B'00001000'                            2849 12674000
*       BASNEXTV=BLANK6;            /* NULL PT AHEAD         @Y30LB25*/ 12675000
         MVI   BASNEXTV+1(@15),C' '                                2850 12676000
         MVC   BASNEXTV+2(4,@15),BASNEXTV+1(@15)                   2850 12677000
         MVI   BASNEXTV(@15),C' '                                  2850 12678000
*       BASEVPTR=SAVBASPT;          /* RESET BUF PTR         @Y30LB25*/ 12679000
         ST    SAVBASPT,BASEVPTR                                   2851 12680000
*       CALL WRITRECD;              /* WRITE BVR             @Y30LB25*/ 12681000
         BAL   @14,WRITRECD                                        2852 12682000
*       RETURN;                     /*                       @Y30LB25*/ 12683000
         B     @EL00067                                            2853 12684000
*     END;                          /*                       @Y30LB25*/ 12685000
*                                                                  2854 12686000
*   /*****************************************************************/ 12687000
*   /*                                                               */ 12688000
*   /* BVR IS BETWEEN FIRST AND LAST BVR IN THE CHAIN        @Y30LB25*/ 12689000
*   /*                                                               */ 12690000
*   /*****************************************************************/ 12691000
*                                                                  2855 12692000
*   NGVNOVOL=NGVNOVOL-FIXONE;       /* DECR # CHAIN VOLS     @Y30LB25*/ 12693000
@RF02830 LH    @03,NGVNOVOL(,NGVRPTR)                              2855 12694000
         BCTR  @03,0                                               2855 12695000
         STH   @03,NGVNOVOL(,NGVRPTR)                              2855 12696000
*   CALL WRITRECD;                  /* WRITE NGVR            @Y30LB25*/ 12697000
         BAL   @14,WRITRECD                                        2856 12698000
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/ 12699000
*     THEN                          /* YES                   @Y30LB25*/ 12700000
         L     @01,RPLVPTR                                         2857 12701000
         LH    @15,RPLVRETC(,@01)                                  2857 12702000
         N     @15,@CF01129                                        2857 12703000
         LTR   @15,@15                                             2857 12704000
         BNZ   @RT02857                                            2857 12705000
*     RETURN;                       /*                       @Y30LB25*/ 12706000
*   CALL PROCBVRO;                  /* CHAIN OUT OF CHAIN    @Y30LB25*/ 12707000
         BAL   @14,PROCBVRO                                        2859 12708000
*   BASEVPTR=SAVBASPT;              /* RESTORE BVR PTR       @Y30LB25*/ 12709000
         ST    SAVBASPT,BASEVPTR                                   2860 12710000
*   RETURN;                         /*                       @Y30LB25*/ 12711000
         B     @EL00067                                            2861 12712000
*   END VUCHO;                      /*                       @Y30LB25*/ 12713000
         B     @EL00067                                            2862 12714000
*                                                                  2863 12715000
*   /*****************************************************************/ 12716000
*   /*                                                               */ 12717000
*   /* PROCEDURE NAME - PROCGVRO                             @Y30LB25*/ 12718000
*   /*                                                       @Y30LB25*/ 12719000
*   /* FUNCTION - CHAIN A BVR OUT OF A GROUP VOLUME          @Y30LB25*/ 12720000
*   /* RECORD (GVR).                                         @Y30LB25*/ 12721000
*   /*                                                       @Y30LB25*/ 12722000
*   /* INPUT -                                               @Y30LB25*/ 12723000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 12724000
*   /* GROUP VOLUME RECORD                                   @Y30LB25*/ 12725000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 12726000
*   /*                                                       @Y30LB25*/ 12727000
*   /* OUTPUT -                                              @Y30LB25*/ 12728000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 12729000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 12730000
*   /* AN ERROR                                              @Y30LB25*/ 12731000
*   /*                                                               */ 12732000
*   /*****************************************************************/ 12733000
*                                                                  2863 12734000
*PROCGVRO:                          /*                       @Y30LB25*/ 12735000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 12736000
*                                                                  2863 12737000
PROCGVRO ST    @14,@SA00068                                        2863 12738000
*   /*****************************************************************/ 12739000
*   /*                                                               */ 12740000
*   /* BVR FIRST IN THE CHAIN                                @Y30LB25*/ 12741000
*   /*                                                               */ 12742000
*   /*****************************************************************/ 12743000
*                                                                  2864 12744000
*   IF BASSERNO=GROFSN              /* 1ST IN CHAIN?         @Y30LB25*/ 12745000
*     THEN                          /* YES                   @Y30LB25*/ 12746000
*                                                                  2864 12747000
         L     @15,BASEVPTR                                        2864 12748000
         L     @14,GROUPPTR                                        2864 12749000
         CLC   BASSERNO(6,@15),GROFSN(@14)                         2864 12750000
         BNE   @RF02864                                            2864 12751000
*     /***************************************************************/ 12752000
*     /*                                                             */ 12753000
*     /* CHECK FOR NO BVRS IN THE CHAIN.                     @Y30LB25*/ 12754000
*     /*                                                             */ 12755000
*     /***************************************************************/ 12756000
*                                                                  2865 12757000
*     IF GRONGEN+GRONRSTD+GRONINAC>FIXZERO/* SET BY CALLER   @Y30LB25*/ 12758000
*       THEN                        /* BVR STILL IN CHAIN    @Y30LB25*/ 12759000
         LH    @03,GRONGEN(,@14)                                   2865 12760000
         AH    @03,GRONRSTD(,@14)                                  2865 12761000
         AH    @03,GRONINAC(,@14)                                  2865 12762000
         LTR   @03,@03                                             2865 12763000
         BNP   @RF02865                                            2865 12764000
*       DO;                         /*                       @Y30LB25*/ 12765000
*         GROFSN=BASNEXTV;          /* PT TO NEW 1ST BVR     @Y30LB25*/ 12766000
         MVC   GROFSN(6,@14),BASNEXTV(@15)                         2867 12767000
*         BVOLKY=BASNEXTV;          /* KEY OF NEW 1ST BVR    @Y30LB25*/ 12768000
         MVC   BVOLKY(6),BASNEXTV(@15)                             2868 12769000
*         RPLVKEY=ADDR(BKEY);       /* SET KEY ADDR          @Y30LB25*/ 12770000
         LA    @15,BKEY                                            2869 12771000
         L     @14,RPLVPTR                                         2869 12772000
         ST    @15,RPLVKEY(,@14)                                   2869 12773000
*         CALL READUPD1;            /* GET NEW 1ST BVR       @Y30LB25*/ 12774000
         BAL   @14,READUPD1                                        2870 12775000
*         IF RPLVRETC^=FIXZERO      /* ERROR?                @Y30LB25*/ 12776000
*           THEN                    /* YES                   @Y30LB25*/ 12777000
         L     @01,RPLVPTR                                         2871 12778000
         LH    @15,RPLVRETC(,@01)                                  2871 12779000
         N     @15,@CF01129                                        2871 12780000
         LTR   @15,@15                                             2871 12781000
         BNZ   @RT02871                                            2871 12782000
*           RETURN;                 /*                       @Y30LB25*/ 12783000
*         BASEVPTR=ADDR(BASEBUF1);  /* NEW 1ST BVR BUF       @Y30LB25*/ 12784000
         LA    @15,BASEBUF1                                        2873 12785000
         ST    @15,BASEVPTR                                        2873 12786000
*         BASFIRST=ON;              /* 1ST FLAG ON           @Y30LB25*/ 12787000
         OI    BASFIRST(@15),B'00010000'                           2874 12788000
*         BASPREV=BLANK6;           /* NULL PREV PTR         @Y30LB25*/ 12789000
         MVI   BASPREV+1(@15),C' '                                 2875 12790000
         MVC   BASPREV+2(4,@15),BASPREV+1(@15)                     2875 12791000
         MVI   BASPREV(@15),C' '                                   2875 12792000
*         CALL WRITRECD;            /* WRITE BVR             @Y30LB25*/ 12793000
         BAL   @14,WRITRECD                                        2876 12794000
*         RETURN;                   /*                       @Y30LB25*/ 12795000
@EL00068 DS    0H                                                  2877 12796000
@EF00068 DS    0H                                                  2877 12797000
@ER00068 L     @14,@SA00068                                        2877 12798000
         BR    @14                                                 2877 12799000
*       END;                        /*                       @Y30LB25*/ 12800000
*     ELSE                          /* NO BVRS IN CHAIN      @Y30LB25*/ 12801000
*       DO;                         /*                       @Y30LB25*/ 12802000
@RF02865 DS    0H                                                  2880 12803000
*         GROFSN=BLANK6;            /* NO FIRST VOL          @Y30LB25*/ 12804000
         L     @15,GROUPPTR                                        2880 12805000
         MVI   GROFSN+1(@15),C' '                                  2880 12806000
         MVC   GROFSN+2(4,@15),GROFSN+1(@15)                       2880 12807000
         MVI   GROFSN(@15),C' '                                    2880 12808000
*         GROLSN=BLANK6;            /* NO LAST VOL           @Y30LB25*/ 12809000
         MVI   GROLSN+1(@15),C' '                                  2881 12810000
         MVC   GROLSN+2(4,@15),GROLSN+1(@15)                       2881 12811000
         MVI   GROLSN(@15),C' '                                    2881 12812000
*         RETURN;                   /*                       @Y30LB25*/ 12813000
         B     @EL00068                                            2882 12814000
*       END;                        /*                       @Y30LB25*/ 12815000
*                                                                  2883 12816000
*   /*****************************************************************/ 12817000
*   /*                                                               */ 12818000
*   /* BVR LAST IN THE CHAIN                                 @Y30LB25*/ 12819000
*   /*                                                               */ 12820000
*   /*****************************************************************/ 12821000
*                                                                  2884 12822000
*   IF BASSERNO=GROLSN              /* LAST IN CHAIN?        @Y30LB25*/ 12823000
*     THEN                          /* YES                   @Y30LB25*/ 12824000
@RF02864 L     @15,BASEVPTR                                        2884 12825000
         L     @14,GROUPPTR                                        2884 12826000
         CLC   BASSERNO(6,@15),GROLSN(@14)                         2884 12827000
         BNE   @RF02884                                            2884 12828000
*     IF GRONGEN+GRONRSTD+GRONINAC>FIXZERO/* SET BY CALLER   @Y30LB25*/ 12829000
*       THEN                        /* BVR STILL IN CHAIN    @Y30LB25*/ 12830000
         LH    @03,GRONGEN(,@14)                                   2885 12831000
         AH    @03,GRONRSTD(,@14)                                  2885 12832000
         AH    @03,GRONINAC(,@14)                                  2885 12833000
         LTR   @03,@03                                             2885 12834000
         BNP   @RF02885                                            2885 12835000
*       DO;                         /*                       @Y30LB25*/ 12836000
*         GROLSN=BASPREV;           /* PT TO NEW LAST        @Y30LB25   12837000
*                                      IN CHAIN              @Y30LB25*/ 12838000
         MVC   GROLSN(6,@14),BASPREV(@15)                          2887 12839000
*         BVOLKY=BASPREV;           /* NEW LAST BVR          @Y30LB25*/ 12840000
         MVC   BVOLKY(6),BASPREV(@15)                              2888 12841000
*         RPLVKEY=ADDR(BKEY);       /* SET KEY ADDR          @Y30LB25*/ 12842000
         LA    @15,BKEY                                            2889 12843000
         L     @14,RPLVPTR                                         2889 12844000
         ST    @15,RPLVKEY(,@14)                                   2889 12845000
*         CALL READUPD1;            /* GET NEW LAST BVR      @Y30LB25*/ 12846000
         BAL   @14,READUPD1                                        2890 12847000
*         IF RPLVRETC^=FIXZERO      /* ERROR?                @Y30LB25*/ 12848000
*           THEN                    /* YES                   @Y30LB25*/ 12849000
         L     @01,RPLVPTR                                         2891 12850000
         LH    @15,RPLVRETC(,@01)                                  2891 12851000
         N     @15,@CF01129                                        2891 12852000
         LTR   @15,@15                                             2891 12853000
         BNZ   @RT02891                                            2891 12854000
*           RETURN;                 /*                       @Y30LB25*/ 12855000
*         BASEVPTR=ADDR(BASEBUF1);  /* NEW LAST BVR BUF      @Y30LB25*/ 12856000
         LA    @15,BASEBUF1                                        2893 12857000
         ST    @15,BASEVPTR                                        2893 12858000
*         BASLAST=ON;               /* LAST FLAG ON          @Y30LB25*/ 12859000
         OI    BASLAST(@15),B'00001000'                            2894 12860000
*         BASNEXTV=BLANK6;          /* NULL NEXT PTR         @Y30LB25*/ 12861000
         MVI   BASNEXTV+1(@15),C' '                                2895 12862000
         MVC   BASNEXTV+2(4,@15),BASNEXTV+1(@15)                   2895 12863000
         MVI   BASNEXTV(@15),C' '                                  2895 12864000
*         CALL WRITRECD;            /* WRITE BVR             @Y30LB25*/ 12865000
         BAL   @14,WRITRECD                                        2896 12866000
*         RETURN;                   /*                       @Y30LB25*/ 12867000
         B     @EL00068                                            2897 12868000
*       END;                        /*                       @Y30LB25*/ 12869000
*     ELSE                          /* NO BVRS IN CHAIN      @Y30LB25*/ 12870000
*       DO;                         /*                       @Y30LB25*/ 12871000
@RF02885 DS    0H                                                  2900 12872000
*         GROFSN=BLANK6;            /* NO FIRST VOL          @Y30LB25*/ 12873000
         L     @15,GROUPPTR                                        2900 12874000
         MVI   GROFSN+1(@15),C' '                                  2900 12875000
         MVC   GROFSN+2(4,@15),GROFSN+1(@15)                       2900 12876000
         MVI   GROFSN(@15),C' '                                    2900 12877000
*         GROLSN=BLANK6;            /* NO LAST VOL           @Y30LB25*/ 12878000
         MVI   GROLSN+1(@15),C' '                                  2901 12879000
         MVC   GROLSN+2(4,@15),GROLSN+1(@15)                       2901 12880000
         MVI   GROLSN(@15),C' '                                    2901 12881000
*         RETURN;                   /*                       @Y30LB25*/ 12882000
         B     @EL00068                                            2902 12883000
*       END;                        /*                       @Y30LB25*/ 12884000
*                                                                  2903 12885000
*   /*****************************************************************/ 12886000
*   /*                                                               */ 12887000
*   /* BVR IS BETWEEN FIRST AND LAST BVR IN THE CHAIN        @Y30LB25*/ 12888000
*   /*                                                               */ 12889000
*   /*****************************************************************/ 12890000
*                                                                  2904 12891000
*   CALL PROCBVRO;                  /* CHAIN OUT OF CHAIN    @Y30LB25*/ 12892000
@RF02884 BAL   @14,PROCBVRO                                        2904 12893000
*   RETURN;                         /*                       @Y30LB25*/ 12894000
         B     @EL00068                                            2905 12895000
*   END PROCGVRO;                   /*                       @Y30LB25*/ 12896000
         B     @EL00068                                            2906 12897000
*                                                                  2907 12898000
*   /*****************************************************************/ 12899000
*   /*                                                               */ 12900000
*   /* PROCEDURE NAME - PROCBVRO                             @Y30LB25*/ 12901000
*   /*                                                       @Y30LB25*/ 12902000
*   /* FUNCTION - CHAIN A BVR OUT OF A GROUP VOLUME          @Y30LB25*/ 12903000
*   /* RECORD (GVR) OR NON-GROUP VOLUME RECORD (NGVR).       @Y30LB25*/ 12904000
*   /*                                                       @Y30LB25*/ 12905000
*   /* INPUT -                                               @Y30LB25*/ 12906000
*   /* MSVC REQUEST PARAMETER LIST                           @Y30LB25*/ 12907000
*   /* GROUP VOLUME RECORD                                   @Y30LB25*/ 12908000
*   /* NON-GROUP VOLUME RECORD                               @Y30LB25*/ 12909000
*   /* BASE VOLUME RECORD                                    @Y30LB25*/ 12910000
*   /*                                                       @Y30LB25*/ 12911000
*   /* OUTPUT -                                              @Y30LB25*/ 12912000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Y30LB25*/ 12913000
*   /* AN ERROR                                              @Y30LB25*/ 12914000
*   /*                                                               */ 12915000
*   /*****************************************************************/ 12916000
*                                                                  2907 12917000
*PROCBVRO:                          /*                       @Y30LB25*/ 12918000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 12919000
PROCBVRO ST    @14,@SA00069                                        2907 12920000
*   SAVPREV=BASPREV;                /* SAVE PREV SERNO       @Y30LB25*/ 12921000
         L     @15,BASEVPTR                                        2908 12922000
         MVC   SAVPREV(6),BASPREV(@15)                             2908 12923000
*   SAVNEXT=BASNEXTV;               /* SAVE NEXT SERNO       @Y30LB25*/ 12924000
         MVC   SAVNEXT(6),BASNEXTV(@15)                            2909 12925000
*   BASEVPTR=ADDR(BASEBUF1);        /* NEW READ BUF          @Y30LB25*/ 12926000
*                                                                  2910 12927000
         LA    @15,BASEBUF1                                        2910 12928000
         ST    @15,BASEVPTR                                        2910 12929000
*   /*****************************************************************/ 12930000
*   /*                                                               */ 12931000
*   /* RECHAIN PREVIOUS BVR TO THE NEXT BVR                  @Y30LB25*/ 12932000
*   /*                                                               */ 12933000
*   /*****************************************************************/ 12934000
*                                                                  2911 12935000
*   BVOLKY=SAVPREV;                 /* SERNO OF PREV BVR     @Y30LB25*/ 12936000
         MVC   BVOLKY(6),SAVPREV                                   2911 12937000
*   RPLVKEY=ADDR(BKEY);             /* SET KEY ADDR          @Y30LB25*/ 12938000
         LA    @15,BKEY                                            2912 12939000
         L     @14,RPLVPTR                                         2912 12940000
         ST    @15,RPLVKEY(,@14)                                   2912 12941000
*   CALL READUPD1;                  /* READ PREV BVR         @Y30LB25*/ 12942000
         BAL   @14,READUPD1                                        2913 12943000
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/ 12944000
*     THEN                          /* YES                   @Y30LB25*/ 12945000
         L     @01,RPLVPTR                                         2914 12946000
         LH    @15,RPLVRETC(,@01)                                  2914 12947000
         N     @15,@CF01129                                        2914 12948000
         LTR   @15,@15                                             2914 12949000
         BNZ   @RT02914                                            2914 12950000
*     RETURN;                       /*                       @Y30LB25*/ 12951000
*   BASNEXTV=SAVNEXT;               /* PT TO NEW NEXT BVR    @Y30LB25*/ 12952000
         L     @01,BASEVPTR                                        2916 12953000
         MVC   BASNEXTV(6,@01),SAVNEXT                             2916 12954000
*   CALL WRITRECD;                  /* WRITE BVR             @Y30LB25*/ 12955000
         BAL   @14,WRITRECD                                        2917 12956000
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/ 12957000
*     THEN                          /* YES                   @Y30LB25*/ 12958000
         L     @15,RPLVPTR                                         2918 12959000
         LH    @14,RPLVRETC(,@15)                                  2918 12960000
         N     @14,@CF01129                                        2918 12961000
         LTR   @14,@14                                             2918 12962000
         BNZ   @RT02918                                            2918 12963000
*     RETURN;                       /*                       @Y30LB25*/ 12964000
*   BVOLKY=SAVNEXT;                 /* SERNO NEXT BVR        @Y30LB25*/ 12965000
         MVC   BVOLKY(6),SAVNEXT                                   2920 12966000
*   RPLVKEY=ADDR(BKEY);             /* SET KEY ADDR          @Y30LB25*/ 12967000
         LA    @14,BKEY                                            2921 12968000
         ST    @14,RPLVKEY(,@15)                                   2921 12969000
*   CALL READUPD1;                  /* READ PREV BVR         @Y30LB25*/ 12970000
         BAL   @14,READUPD1                                        2922 12971000
*   IF RPLVRETC^=FIXZERO            /* ERROR?                @Y30LB25*/ 12972000
*     THEN                          /* YES                   @Y30LB25*/ 12973000
         L     @01,RPLVPTR                                         2923 12974000
         LH    @15,RPLVRETC(,@01)                                  2923 12975000
         N     @15,@CF01129                                        2923 12976000
         LTR   @15,@15                                             2923 12977000
         BNZ   @RT02923                                            2923 12978000
*     RETURN;                       /*                       @Y30LB25*/ 12979000
*   BASPREV=SAVPREV;                /* PT TO NEW PREV BVR    @Y30LB25*/ 12980000
         L     @01,BASEVPTR                                        2925 12981000
         MVC   BASPREV(6,@01),SAVPREV                              2925 12982000
*   CALL WRITRECD;                  /* WRITE BVR             @Y30LB25*/ 12983000
         BAL   @14,WRITRECD                                        2926 12984000
*   RETURN;                         /*                       @Y30LB25*/ 12985000
@EL00069 DS    0H                                                  2927 12986000
@EF00069 DS    0H                                                  2927 12987000
@ER00069 L     @14,@SA00069                                        2927 12988000
         BR    @14                                                 2927 12989000
*   END PROCBVRO;                   /*                       @Y30LB25*/ 12990000
         B     @EL00069                                            2928 12991000
*                                                                  2929 12992000
*   /*****************************************************************/ 12993000
*   /*                                                               */ 12994000
*   /* ENTRY NAME - ICBVUPGH                                 @Y30LB25*/ 12995000
*   /*                                                       @Y30LB25*/ 12996000
*   /* FUNCTION - UPDATE THE GROUP THRESHOLD, GROUP FREE     @Y30LB25*/ 12997000
*   /* SPACE, AND/OR GROUP FREE EXTENTS FOR ACTIVE, GROUPED, @Y30LB25*/ 12998000
*   /* GENERAL-USE VOLUMES. THE CALLER                       @Y30LB25*/ 12999000
*   /* MUST FIRST UPDATE THE COUNT OF GENERAL-USE VOLUMES    @Y30LB25*/ 13000000
*   /* IN THE GROUP                                          @Y30LB25*/ 13001000
*   /* VOLUME RECORD (GVR) BEFORE CALLING THIS ROUTINE.      @Y30LB25*/ 13002000
*   /* GROUP FREE SPACE AND GROUP FREE EXTENTS ARE           @Y30LB25*/ 13003000
*   /* INCREMENTED OR DECREMENTED DEPENDING ON HOW           @Y30LB25*/ 13004000
*   /* ADDSUBGR FLAG IN PASSBYTE IS SET.                     @Y30LB25*/ 13005000
*   /*                                                       @Y30LB25*/ 13006000
*   /* INPUT -                                               @Y30LB25*/ 13007000
*   /* MSVC REQUEST PARAMETER LIST PTR IN RPLVPTR            @Y30LB25*/ 13008000
*   /* GROUP VOLUME RECORD PTR IN GROUPPTR                   @Y30LB25*/ 13009000
*   /* BASE VOLUME RECORD PTR IN BASEVPTR                    @Y30LB25*/ 13010000
*   /* FLAG IN PASSBYTE                                      @Y30LB25*/ 13011000
*   /* INDICATES ADD OR SUBTRACT                             @Y30LB25*/ 13012000
*   /*                                                       @Y30LB25*/ 13013000
*   /* OUTPUT -                                              @Y30LB25*/ 13014000
*   /* GROUP VOLUME RECORD                                   @Y30LB25*/ 13015000
*   /*                                                               */ 13016000
*   /*****************************************************************/ 13017000
*                                                                  2929 13018000
*ICBVUPGH:                          /*                       @Y30LB25*/ 13019000
*   ENTRY(PTRGROUP,PTRBASEV,BYTEPASS);/*                     @Y30LB25*/ 13020000
*                                                                  2929 13021000
@EP02929 MVC   @PC00001(8),0(@01)                                  2929 13022000
         MVC   @PC00001+12(4),8(@01)                               2929 13023000
*   /*****************************************************************/ 13024000
*   /*                                                               */ 13025000
*   /* DECLARES FOR PASSED PARAMETERS                        @Y30LB25*/ 13026000
*   /* PTRGROUP, PTRBASEV, PTRRPLV, PASSBYTE                 @Y30LB25*/ 13027000
*   /* ARE DECLARED IN ICBVUCHI.                             @Y30LB25*/ 13028000
*   /*                                                               */ 13029000
*   /*****************************************************************/ 13030000
*                                                                  2930 13031000
*   DCL                                                            2930 13032000
*     FIX404 CONSTANT(404);         /* 404                   @Y30LB25*/ 13033000
*   DCL                                                            2931 13034000
*     FIX403 CONSTANT(403);         /* 403                   @Y30LB25*/ 13035000
*   DCL                                                            2932 13036000
*     FIX100 CONSTANT(100);         /* 100                   @Y30LB25*/ 13037000
*   GROUPPTR=PTRGROUP;              /* SET GROUP PTR         @Y30LB25*/ 13038000
         L     @06,@PC00001                                        2933 13039000
         L     @06,PTRGROUP(,@06)                                  2933 13040000
         ST    @06,GROUPPTR                                        2933 13041000
*   BASEVPTR=PTRBASEV;              /* SET BASE PTR          @Y30LB25*/ 13042000
         L     @06,@PC00001+4                                      2934 13043000
         L     @06,PTRBASEV(,@06)                                  2934 13044000
         ST    @06,BASEVPTR                                        2934 13045000
*   PASSBYTE=BYTEPASS;              /* ADD OR SUBT FLAG      @Y30LB25*/ 13046000
         L     @06,@PC00001+12                                     2935 13047000
         MVC   PASSBYTE(2),BYTEPASS(@06)                           2935 13048000
*   CALL VUPGH;                     /* PROCESS GVR           @Y30LB25*/ 13049000
         BAL   @14,VUPGH                                           2936 13050000
*   RETURN;                         /*                       @Y30LB25*/ 13051000
         B     @EL00001                                            2937 13052000
*                                                                  2938 13053000
*   /*****************************************************************/ 13054000
*   /*                                                               */ 13055000
*   /* PROCEDURE VUPGH IS CODED SO THAT COMMON ENTRY         @Y30LB25*/ 13056000
*   /* CODE IN ICBVUPGH CAN BE USED BY THIS MODULE           @Y30LB25*/ 13057000
*   /* AND BY OTHER MODULES. OTHER MODULES CALL              @Y30LB25*/ 13058000
*   /* ENTRY ICBVUPGH. THIS MODULE CALLS PROCEDURE           @Y30LB25*/ 13059000
*   /* VUPGH.                                                @Y30LB25*/ 13060000
*   /*                                                               */ 13061000
*   /*****************************************************************/ 13062000
*                                                                  2938 13063000
*VUPGH:                             /*                       @Y30LB25*/ 13064000
*   PROC OPTIONS(SAVE(RG14));       /*                       @ZDR2054*/ 13065000
*                                                                  2938 13066000
VUPGH    ST    @14,12(,@13)                                        2938 13067000
*   /*****************************************************************/ 13068000
*   /*                                                               */ 13069000
*   /* UPDATE THE GROUP THRESHOLD                            @Y30LB25*/ 13070000
*   /*                                                               */ 13071000
*   /*****************************************************************/ 13072000
*                                                                  2939 13073000
*   GROSTRSH=(GRONGEN*FIX404*GROPCENT)/FIX100;/*             @Y30LB25   13074000
*                                      SPACE THRESHOLD       @Y30LB25*/ 13075000
*                                                                  2939 13076000
         L     @06,GROUPPTR                                        2939 13077000
         LH    @01,GRONGEN(,@06)                                   2939 13078000
         MH    @01,@CH01095                                        2939 13079000
         SLR   @15,@15                                             2939 13080000
         IC    @15,GROPCENT(,@06)                                  2939 13081000
         MR    @00,@15                                             2939 13082000
         D     @00,@CF01099                                        2939 13083000
         ST    @01,GROSTRSH(,@06)                                  2939 13084000
*   /*****************************************************************/ 13085000
*   /*                                                               */ 13086000
*   /* UPDATE GROUP FREE SPACE AND FREE EXTENTS              @Y30LB25*/ 13087000
*   /*                                                               */ 13088000
*   /*****************************************************************/ 13089000
*                                                                  2940 13090000
*   IF ADDSUBGR=ON                  /* INCREMENT?            @Y30LB25*/ 13091000
*     THEN                          /* YES                   @Y30LB25*/ 13092000
         TM    ADDSUBGR,B'00001000'                                2940 13093000
         BNO   @RF02940                                            2940 13094000
*     DO;                           /*                       @Y30LB25*/ 13095000
*                                                                  2941 13096000
*       /*************************************************************/ 13097000
*       /*                                                           */ 13098000
*       /* CHECK IF BVR STILL CONTAINS NULL SPACE VALUES.    @Y30LB25*/ 13099000
*       /* IF SO, CHANGE THE VALUES TO REFLECT AN EMPTY      @Y30LB25*/ 13100000
*       /* VOLUME AND INDICATE IT IS DOWN LEVEL SPACE.       @Y30LB25*/ 13101000
*       /*                                                           */ 13102000
*       /*************************************************************/ 13103000
*                                                                  2942 13104000
*       IF BASFRESP=FIX2FS          /* NULL FREE SPACE?      @Y30LB25*/ 13105000
*         THEN                      /* YES                   @Y30LB25*/ 13106000
         L     @06,BASEVPTR                                        2942 13107000
         CLC   BASFRESP(2,@06),@CH00672                            2942 13108000
         BNE   @RF02942                                            2942 13109000
*         DO;                       /*                       @Y30LB25*/ 13110000
*           BASFRESP=FIX403;        /* SET FREE SPACE        @Y30LB25*/ 13111000
         LA    @15,403                                             2944 13112000
         STH   @15,BASFRESP(,@06)                                  2944 13113000
*           BASLEXT=FIX403;         /* LARGE FREE EXTENT     @Y30LB25*/ 13114000
         STH   @15,BASLEXT(,@06)                                   2945 13115000
*           BASFREXT=FIXONE;        /* # FREE EXTENTS        @Y30LB25*/ 13116000
         MVC   BASFREXT(4,@06),@CF00046                            2946 13117000
*           BASDLSF=ON;             /* DOWN LEVEL SPACE      @Y30LB25*/ 13118000
         OI    BASDLSF(@06),B'10000000'                            2947 13119000
*         END;                      /*                       @Y30LB25*/ 13120000
*       GROFRESP=GROFRESP+BASFRESP; /* NEW FREE SPACE        @Y30LB25*/ 13121000
@RF02942 L     @06,GROUPPTR                                        2949 13122000
         L     @15,BASEVPTR                                        2949 13123000
         LH    @14,BASFRESP(,@15)                                  2949 13124000
         N     @14,@CF01129                                        2949 13125000
         AL    @14,GROFRESP(,@06)                                  2949 13126000
         ST    @14,GROFRESP(,@06)                                  2949 13127000
*       GROFREXT=GROFREXT+BASFREXT; /* NEW FREE EXTENTS      @Y30LB25*/ 13128000
         L     @14,GROFREXT(,@06)                                  2950 13129000
         AL    @14,BASFREXT(,@15)                                  2950 13130000
         ST    @14,GROFREXT(,@06)                                  2950 13131000
*       GROMSG1=OFF;                /* MOUNT MSG             @Y30LB25*/ 13132000
         NI    GROMSG1(@06),B'11111101'                            2951 13133000
*       RETURN;                     /*                       @Y30LB25*/ 13134000
@EL00070 DS    0H                                                  2952 13135000
@EF00070 DS    0H                                                  2952 13136000
@ER00070 L     @14,12(,@13)                                        2952 13137000
         BR    @14                                                 2952 13138000
*     END;                          /*                       @Y30LB25*/ 13139000
*   ELSE                            /* DECREMENT             @Y30LB25*/ 13140000
*     DO;                           /*                       @Y30LB25*/ 13141000
@RF02940 DS    0H                                                  2955 13142000
*       GROFRESP=GROFRESP-BASFRESP; /* NEW FREE SPACE        @Y30LB25*/ 13143000
         L     @06,GROUPPTR                                        2955 13144000
         L     @15,BASEVPTR                                        2955 13145000
         L     @14,GROFRESP(,@06)                                  2955 13146000
         LH    @03,BASFRESP(,@15)                                  2955 13147000
         N     @03,@CF01129                                        2955 13148000
         SLR   @14,@03                                             2955 13149000
         ST    @14,GROFRESP(,@06)                                  2955 13150000
*       GROFREXT=GROFREXT-BASFREXT; /* NEW FREE EXTENTS      @Y30LB25*/ 13151000
         L     @14,GROFREXT(,@06)                                  2956 13152000
         SL    @14,BASFREXT(,@15)                                  2956 13153000
         ST    @14,GROFREXT(,@06)                                  2956 13154000
*       RETURN;                     /*                       @Y30LB25*/ 13155000
         B     @EL00070                                            2957 13156000
*     END;                          /*                       @Y30LB25*/ 13157000
*   END VUPGH;                      /*                       @Y30LB25*/ 13158000
*   END ICBVUT00                    /* THE END -- AT LAST    @Y30LB25*/ 13159000
*                                                                  2960 13160000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 13161000
*/*%INCLUDE SYSLIB  (IEZVVICB)                                       */ 13162000
*/*%INCLUDE SYSLIB  (IEZRPLV )                                       */ 13163000
*/*%INCLUDE SYSLIB  (IEZINDEX)                                       */ 13164000
*/*%INCLUDE SYSLIB  (IEZGROUP)                                       */ 13165000
*/*%INCLUDE SYSLIB  (IEZNGVR )                                       */ 13166000
*/*%INCLUDE SYSLIB  (IEZBCDV )                                       */ 13167000
*/*%INCLUDE SYSLIB  (IEZBASEV)                                       */ 13168000
*/*%INCLUDE SYSLIB  (IEZCOPYV)                                       */ 13169000
*/*%INCLUDE SYSLIB  (IEZDUPV )                                       */ 13170000
*/*%INCLUDE SYSLIB  (IEZMCRTE)                                       */ 13171000
*/*%INCLUDE SYSLIB  (IEZDEFVE)                                       */ 13172000
*/*%INCLUDE SYSLIB  (IEZCOVCE)                                       */ 13173000
*                                                                  2960 13174000
*       ;                                                          2960 13175000
@DATA    DS    0H                                                       13176000
@CH00041 DC    H'4'                                                     13177000
@CH01095 DC    H'404'                                                   13178000
         DS    0F                                                       13179000
@AL00517 EQU   *                       LIST WITH   3 ARGUMENT(S)        13180000
@AL01570 DC    A(@CF00086)             LIST WITH   3 ARGUMENT(S)        13181000
         DC    A(RPLVPTR)                                               13182000
         DC    A(EXPRDT)                                                13183000
@AL00572 EQU   *                       LIST WITH   3 ARGUMENT(S)        13184000
@AL02320 DC    A(BCDVPTR)              LIST WITH   3 ARGUMENT(S)        13185000
         DC    A(RPLVPTR)                                               13186000
         DC    A(PASSBYTE)                                              13187000
@AL00640 EQU   *                       LIST WITH   4 ARGUMENT(S)        13188000
@AL00902 EQU   *                       LIST WITH   4 ARGUMENT(S)        13189000
@AL01059 EQU   *                       LIST WITH   4 ARGUMENT(S)        13190000
@AL01131 EQU   *                       LIST WITH   4 ARGUMENT(S)        13191000
@AL01189 EQU   *                       LIST WITH   4 ARGUMENT(S)        13192000
@AL01220 EQU   *                       LIST WITH   4 ARGUMENT(S)        13193000
@AL01241 EQU   *                       LIST WITH   4 ARGUMENT(S)        13194000
@AL01245 EQU   *                       LIST WITH   4 ARGUMENT(S)        13195000
@AL01266 EQU   *                       LIST WITH   4 ARGUMENT(S)        13196000
@AL02384 EQU   *                       LIST WITH   4 ARGUMENT(S)        13197000
@AL02548 DC    A(GROUPPTR)             LIST WITH   4 ARGUMENT(S)        13198000
         DC    A(BASEVPTR)                                              13199000
         DC    A(RPLVPTR)                                               13200000
         DC    A(PASSBYTE)                                              13201000
@AL00677 EQU   *                       LIST WITH   6 ARGUMENT(S)        13202000
@AL00691 DC    A(DUPVPTR)              LIST WITH   4 ARGUMENT(S)        13203000
         DC    A(BASEVPTR)                                              13204000
         DC    A(RPLVPTR)                                               13205000
         DC    A(PASSBYTE)                                              13206000
         DC    A(@CF00086)                                              13207000
         DC    A(@CF00086)                                              13208000
@AL00967 EQU   *                       LIST WITH   3 ARGUMENT(S)        13209000
@AL01712 EQU   *                       LIST WITH   3 ARGUMENT(S)        13210000
@AL01783 EQU   *                       LIST WITH   3 ARGUMENT(S)        13211000
@AL01831 EQU   *                       LIST WITH   3 ARGUMENT(S)        13212000
@AL01940 DC    A(COPYVPTR)             LIST WITH   3 ARGUMENT(S)        13213000
         DC    A(RPLVPTR)                                               13214000
         DC    A(PASSBYTE)                                              13215000
@AL01802 DC    A(@CF00086)             LIST WITH   3 ARGUMENT(S)        13216000
         DC    A(RPLVPRT)                                               13217000
         DC    A(EXPRDT)                                                13218000
         DS    0F                                                       13219000
@SA00001 DS    18F                                                      13220000
@PC00001 DS    4F                                                       13221000
@SA00002 DS    1F                                                       13222000
@SA00003 DS    1F                                                       13223000
@SA00016 DS    1F                                                       13224000
@SA00033 DS    1F                                                       13225000
@SA00031 DS    1F                                                       13226000
@SA00047 DS    1F                                                       13227000
@SA00049 DS    1F                                                       13228000
@SA00007 DS    1F                                                       13229000
@SA00019 DS    1F                                                       13230000
@SA00036 DS    1F                                                       13231000
@SA00032 DS    1F                                                       13232000
@SA00050 DS    1F                                                       13233000
@SA00059 DS    1F                                                       13234000
@SA00046 DS    1F                                                       13235000
@SA00060 DS    1F                                                       13236000
@SA00009 DS    1F                                                       13237000
@SA00045 DS    1F                                                       13238000
@SA00043 DS    1F                                                       13239000
@SA00012 DS    1F                                                       13240000
@SA00010 DS    1F                                                       13241000
@SA00013 DS    1F                                                       13242000
@SA00015 DS    1F                                                       13243000
@SA00067 DS    1F                                                       13244000
@SA00061 DS    1F                                                       13245000
@SA00017 DS    1F                                                       13246000
@SA00018 DS    1F                                                       13247000
@SA00020 DS    1F                                                       13248000
@SA00021 DS    1F                                                       13249000
@SA00058 DS    1F                                                       13250000
@SA00028 DS    1F                                                       13251000
@SA00022 DS    1F                                                       13252000
@SA00023 DS    1F                                                       13253000
@SA00027 DS    1F                                                       13254000
@SA00024 DS    1F                                                       13255000
@SA00026 DS    1F                                                       13256000
@SA00025 DS    1F                                                       13257000
@SA00037 DS    1F                                                       13258000
@SA00035 DS    1F                                                       13259000
@SA00041 DS    1F                                                       13260000
@SA00040 DS    1F                                                       13261000
@SA00038 DS    1F                                                       13262000
@SA00044 DS    1F                                                       13263000
@SA00048 DS    1F                                                       13264000
@SA00052 DS    1F                                                       13265000
@SA00055 DS    1F                                                       13266000
@SA00056 DS    1F                                                       13267000
@SA00053 DS    1F                                                       13268000
@SA00057 DS    1F                                                       13269000
@SA00054 DS    1F                                                       13270000
@SA00062 DS    1F                                                       13271000
@SA00063 DS    1F                                                       13272000
@SA00066 DS    1F                                                       13273000
@SA00068 DS    1F                                                       13274000
@SA00069 DS    1F                                                       13275000
@SA00039 DS    0F                                                       13276000
@SA00042 DS    0F                                                       13277000
@SA00064 DS    0F                                                       13278000
@SA00014 DS    0F                                                       13279000
@SA00065 DS    0F                                                       13280000
@SA00011 DS    0F                                                       13281000
@SA00034 DS    0F                                                       13282000
@SA00008 DS    0F                                                       13283000
@SA00006 DS    0F                                                       13284000
@SA00005 DS    0F                                                       13285000
@SA00004 DS    0F                                                       13286000
         DS    1F                                                       13287000
@AL00001 DS    6A                                                       13288000
         DS    0F                                                       13289000
@CF00086 DC    F'0'                                                     13290000
@CF00046 DC    F'1'                                                     13291000
@CH00046 EQU   @CF00046+2                                               13292000
@CF00044 DC    F'2'                                                     13293000
@CF00339 DC    F'36'                                                    13294000
@CF01105 DC    F'65'                                                    13295000
@CF01099 DC    F'100'                                                   13296000
@CF01104 DC    F'164'                                                   13297000
@CF01103 DC    F'224'                                                   13298000
@CF00668 DC    F'255'                                                   13299000
@CF00666 DC    F'256'                                                   13300000
@CF00677 DC    XL4'FFFFFFFF'                                            13301000
@CF01129 DC    XL4'0000FFFF'                                            13302000
@CF00672 DC    XL4'FFFF'                                                13303000
@CH00672 EQU   @CF00672+2                                               13304000
@CV00762 DC    V(ICBVIO00)                                              13305000
@CV00763 DC    V(ICBVRR00)                                              13306000
@CV00764 DC    V(ICBVJL00)                                              13307000
@CV00766 DC    V(ICBVUDBR)                                              13308000
@CV00767 DC    V(ICBVUEXT)                                              13309000
@CV00768 DC    V(ICBVUEXP)                                              13310000
@CV00769 DC    V(ICBVUBVR)                                              13311000
@CV00765 DC    V(ICBVOP00)                                              13312000
         DS    0D                                                       13313000
VVIPTR   DS    A                                                        13314000
RPLVPTR  DS    A                                                        13315000
INDEXPTR DS    A                                                        13316000
GROUPPTR DS    A                                                        13317000
BCDVPTR  DS    A                                                        13318000
BASEVPTR DS    A                                                        13319000
COPYVPTR DS    A                                                        13320000
DUPVPTR  DS    A                                                        13321000
MCRTEPTR DS    A                                                        13322000
COVCEPTR DS    A                                                        13323000
CVOLPTR  DS    A                                                        13324000
A        DS    F                                                        13325000
RPLVPRT  DS    F                                                        13326000
MCRLEN   DC    AL2(44)                                                  13327000
DEFLEN   DC    AL2(64)                                                  13328000
COVLEN   DC    AL2(43)                                                  13329000
@CC00692 DC    C'             '                                         13330000
@CC00689 EQU   @CC00692                                                 13331000
@CB00681 DC    X'00000000000000000000'                                  13332000
@CB00677 DC    X'FFFFFFFF'                                              13333000
@CB00701 DC    X'004C'                                                  13334000
@CB00703 DC    X'0203'                                                  13335000
@CB00705 DC    X'0204'                                                  13336000
@CB00707 DC    X'0205'                                                  13337000
@CB00709 DC    X'0206'                                                  13338000
@CB00711 DC    X'0208'                                                  13339000
@CB00713 DC    X'0209'                                                  13340000
@CB00717 DC    X'020E'                                                  13341000
@CB00719 DC    X'020F'                                                  13342000
@CB00721 DC    X'0210'                                                  13343000
@CB00723 DC    X'0213'                                                  13344000
@CB00725 DC    X'0214'                                                  13345000
@CB00727 DC    X'0217'                                                  13346000
@CB00729 DC    X'0227'                                                  13347000
@CB00731 DC    X'0228'                                                  13348000
@CB00733 DC    X'0235'                                                  13349000
@CB00735 DC    X'0236'                                                  13350000
@CB00737 DC    X'0237'                                                  13351000
@CB00739 DC    X'0238'                                                  13352000
GROUPBUF DS    CL224                                                    13353000
GRPBUF1  DS    CL224                                                    13354000
NGVRBUF  DS    CL224                                                    13355000
BASEBUF  DS    CL224                                                    13356000
COPYBUF  DS    CL224                                                    13357000
INDEXBUF DS    CL36                                                     13358000
DUPVBUF  DS    CL224                                                    13359000
         DS    CL1                                                      13360000
GKEY     DS    CL13                                                     13361000
         ORG   GKEY                                                     13362000
GKY      DC    CL3'G  '                                                 13363000
GROUPKY  DS    CL8                                                      13364000
GBLKKY   DC    CL1' '                                                   13365000
GIDKY    DC    XL1'00'                                                  13366000
         ORG   GKEY+13                                                  13367000
         DS    CL3                                                      13368000
BKEY     DS    CL13                                                     13369000
         ORG   BKEY                                                     13370000
BKY      DC    CL5'V    '                                               13371000
BVOLKY   DS    CL6                                                      13372000
BBLKKY   DC    CL1' '                                                   13373000
BIDKY    DC    XL1'00'                                                  13374000
         ORG   BKEY+13                                                  13375000
         DS    CL3                                                      13376000
DKEY     DS    CL13                                                     13377000
         ORG   DKEY                                                     13378000
DKY      DC    CL5'D    '                                               13379000
DVOLKY   DS    CL6                                                      13380000
DBLKKY   DC    CL1' '                                                   13381000
DIDKY    DS    FL1                                                      13382000
         ORG   DKEY+13                                                  13383000
         DS    CL3                                                      13384000
CKEY     DS    CL13                                                     13385000
         ORG   CKEY                                                     13386000
CKY      DC    CL5'V    '                                               13387000
CVOLKY   DS    CL6                                                      13388000
CBLKKY   DC    CL1' '                                                   13389000
CIDKY    DS    FL1                                                      13390000
         ORG   CKEY+13                                                  13391000
         DS    CL3                                                      13392000
IKEY     DS    CL13                                                     13393000
         ORG   IKEY                                                     13394000
IKY      DC    CL1'I'                                                   13395000
IVOLKY   DS    CL12                                                     13396000
         ORG   IKEY+13                                                  13397000
         DS    CL3                                                      13398000
NGKEY    DC    CL13'N   HEADER   '                                      13399000
         DS    CL3                                                      13400000
WORKAREA DS    CL23                                                     13401000
         ORG   WORKAREA                                                 13402000
REACODE  DS    CL2                                                      13403000
RETCODE  DS    CL2                                                      13404000
BCDKEY   DS    CL13                                                     13405000
EXPRDT   DS    CL4                                                      13406000
PASSBYTE DS    CL2                                                      13407000
         ORG   PASSBYTE                                                 13408000
GRPDV    DS    BL1                                                      13409000
FRSTDV   EQU   PASSBYTE+0                                               13410000
LASTDV   EQU   PASSBYTE+0                                               13411000
GRPFLG   EQU   PASSBYTE+0                                               13412000
ADDSUBGR EQU   PASSBYTE+0                                               13413000
CSNUMBER EQU   PASSBYTE+0                                               13414000
ADDSUBSL EQU   PASSBYTE+0                                               13415000
RPLVFLG  EQU   PASSBYTE+0                                               13416000
EXPSLOT  DS    BL1                                                      13417000
ADDSUB   EQU   PASSBYTE+1                                               13418000
@NM00054 EQU   PASSBYTE+1                                               13419000
         ORG   WORKAREA+23                                              13420000
MAXDATE  DC    X'0099365C'                                              13421000
NULLDATE DC    X'00000000'                                              13422000
         DS    CL1                                                      13423000
VU0PATCH DS    CL400                                                    13424000
         ORG   VU0PATCH                                                 13425000
@NM00055 DC    400X'00'                                                 13426000
         ORG   VU0PATCH+400                                             13427000
BASEBUF1 DS    CL224                                                    13428000
SAVSERNO DS    CL6                                                      13429000
SAVSERN1 DS    CL6                                                      13430000
SAVPREV  DS    CL6                                                      13431000
SAVNEXT  DS    CL6                                                      13432000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       13433000
@01      EQU   01                                                       13434000
@02      EQU   02                                                       13435000
@03      EQU   03                                                       13436000
@04      EQU   04                                                       13437000
@05      EQU   05                                                       13438000
@06      EQU   06                                                       13439000
@07      EQU   07                                                       13440000
@08      EQU   08                                                       13441000
@09      EQU   09                                                       13442000
@10      EQU   10                                                       13443000
@11      EQU   11                                                       13444000
@12      EQU   12                                                       13445000
@13      EQU   13                                                       13446000
@14      EQU   14                                                       13447000
@15      EQU   15                                                       13448000
SAVBASPT EQU   @06                                                      13449000
DEFVPTR  EQU   @04                                                      13450000
MCRTPTR  EQU   @06                                                      13451000
DEFVEPTR EQU   @05                                                      13452000
NGVRPTR  EQU   @02                                                      13453000
RG0      EQU   @00                                                      13454000
RG1      EQU   @01                                                      13455000
RG14     EQU   @14                                                      13456000
CVOLR1   EQU   @01                                                      13457000
DEFVR1   EQU   @01                                                      13458000
MCR1     EQU   @01                                                      13459000
RG10     EQU   @10                                                      13460000
RG11     EQU   @11                                                      13461000
RG12     EQU   @12                                                      13462000
RG13     EQU   @13                                                      13463000
RG15     EQU   @15                                                      13464000
RG2      EQU   @02                                                      13465000
RG3      EQU   @03                                                      13466000
RG4      EQU   @04                                                      13467000
RG5      EQU   @05                                                      13468000
RG6      EQU   @06                                                      13469000
RG7      EQU   @07                                                      13470000
RG8      EQU   @08                                                      13471000
RG9      EQU   @09                                                      13472000
VVICB    EQU   0                                                        13473000
VVIFLGA  EQU   VVICB+15                                                 13474000
VVIFLG0  EQU   VVIFLGA                                                  13475000
VVIFLG2  EQU   VVIFLGA                                                  13476000
RPLV     EQU   0                                                        13477000
RPLTCBPR EQU   RPLV+8                                                   13478000
RPLVVICB EQU   RPLV+12                                                  13479000
RPLFLAGA EQU   RPLV+28                                                  13480000
RPLFTIME EQU   RPLFLAGA                                                 13481000
RPLJRCVY EQU   RPLFLAGA                                                 13482000
RPLRCODE EQU   RPLV+32                                                  13483000
RPLVRETC EQU   RPLV+34                                                  13484000
RPLVDATE EQU   RPLV+38                                                  13485000
RPLVSAM  EQU   RPLV+56                                                  13486000
RPLVTYP  EQU   RPLVSAM+2                                                13487000
RPLVBUF  EQU   RPLVSAM+32                                               13488000
RPLVKEY  EQU   RPLVSAM+36                                               13489000
RPLVOPT  EQU   RPLVSAM+40                                               13490000
RPLVLOC  EQU   RPLVOPT                                                  13491000
RPLVDIR  EQU   RPLVOPT                                                  13492000
RPLVKGE  EQU   RPLVOPT                                                  13493000
RPLVUPD  EQU   RPLVOPT+1                                                13494000
RPLVRLN  EQU   RPLVSAM+48                                               13495000
RPLVBLN  EQU   RPLVSAM+52                                               13496000
RPLVUTIL EQU   RPLV+132                                                 13497000
INDEX    EQU   0                                                        13498000
INDNAME  EQU   INDEX                                                    13499000
INDTYPE  EQU   INDEX+13                                                 13500000
INDRECKY EQU   INDEX+15                                                 13501000
INDPREFX EQU   INDRECKY                                                 13502000
INDRECID EQU   INDRECKY+11                                              13503000
GROUP    EQU   0                                                        13504000
GRONAME  EQU   GROUP                                                    13505000
GROID    EQU   GRONAME+11                                               13506000
GROFLAGA EQU   GROUP+13                                                 13507000
GROTYPE  EQU   GROFLAGA                                                 13508000
GROBIND  EQU   GROFLAGA+2                                               13509000
GROEXCL  EQU   GROFLAGA+2                                               13510000
GRODAERA EQU   GROFLAGA+2                                               13511000
GRORONLY EQU   GROFLAGA+2                                               13512000
GRORETN  EQU   GROFLAGA+2                                               13513000
GROMSG1  EQU   GROFLAGA+2                                               13514000
GROFSN   EQU   GROUP+17                                                 13515000
GROLSN   EQU   GROUP+23                                                 13516000
GROPCENT EQU   GROUP+29                                                 13517000
GRONGEN  EQU   GROUP+30                                                 13518000
GRONRSTD EQU   GROUP+32                                                 13519000
GRONINAC EQU   GROUP+34                                                 13520000
GROSTRSH EQU   GROUP+40                                                 13521000
GROFRESP EQU   GROUP+44                                                 13522000
GROFREXT EQU   GROUP+48                                                 13523000
GROERRTS EQU   GROUP+56                                                 13524000
NGVR     EQU   0                                                        13525000
NGVRTYPE EQU   NGVR+13                                                  13526000
NGVFVOL  EQU   NGVR+17                                                  13527000
NGVLVOL  EQU   NGVR+23                                                  13528000
NGVNOVOL EQU   NGVR+30                                                  13529000
BCDV     EQU   0                                                        13530000
BCDNAME  EQU   BCDV                                                     13531000
BCDPREFX EQU   BCDNAME                                                  13532000
BCDSERNO EQU   BCDNAME+5                                                13533000
BCDID    EQU   BCDNAME+11                                               13534000
BCDFLAGA EQU   BCDV+14                                                  13535000
BCDTYPE  EQU   BCDFLAGA                                                 13536000
BCDBASE  EQU   BCDTYPE                                                  13537000
BCDCOPY  EQU   BCDTYPE                                                  13538000
BCDDUP   EQU   BCDTYPE                                                  13539000
BCDFLAGB EQU   BCDFLAGA+2                                               13540000
BCDRCVYF EQU   BCDV+20                                                  13541000
BCDSATIA EQU   BCDRCVYF                                                 13542000
BCDIVCRE EQU   BCDSATIA                                                 13543000
BCDIVCPY EQU   BCDSATIA                                                 13544000
BCDVSMIS EQU   BCDSATIA                                                 13545000
BCDMISCF EQU   BCDRCVYF+2                                               13546000
BCDCSN1  EQU   BCDV+24                                                  13547000
BCDLIB1  EQU   BCDV+36                                                  13548000
BCDLID1  EQU   BCDLIB1                                                  13549000
BCDCSN2  EQU   BCDV+37                                                  13550000
BCDLIB2  EQU   BCDV+49                                                  13551000
BCDLID2  EQU   BCDLIB2                                                  13552000
BASEV    EQU   0                                                        13553000
BASNAME  EQU   BASEV                                                    13554000
BASSERNO EQU   BASNAME+5                                                13555000
BASID    EQU   BASNAME+11                                               13556000
BASFLAGA EQU   BASEV+14                                                 13557000
BASTYPE  EQU   BASFLAGA                                                 13558000
BASBASVR EQU   BASTYPE                                                  13559000
BASDLSF  EQU   BASFLAGA+2                                               13560000
BASNOCPY EQU   BASFLAGA+2                                               13561000
BASGRPV  EQU   BASFLAGA+2                                               13562000
BASGENUS EQU   BASFLAGA+2                                               13563000
BASRSTD  EQU   BASFLAGA+2                                               13564000
BASINAC  EQU   BASFLAGA+2                                               13565000
BASBIND  EQU   BASFLAGA+2                                               13566000
BASEXCL  EQU   BASFLAGA+2                                               13567000
BASDAERA EQU   BASFLAGA+3                                               13568000
BASRONLY EQU   BASFLAGA+3                                               13569000
BASREASS EQU   BASFLAGA+3                                               13570000
BASFIRST EQU   BASFLAGA+3                                               13571000
BASLAST  EQU   BASFLAGA+3                                               13572000
BASRCVYF EQU   BASEV+20                                                 13573000
BASSATIA EQU   BASRCVYF                                                 13574000
BASMISCF EQU   BASRCVYF+2                                               13575000
BASHOLD  EQU   BASMISCF                                                 13576000
BASCSN1  EQU   BASEV+24                                                 13577000
BASLIB1  EQU   BASEV+36                                                 13578000
BASLID1  EQU   BASLIB1                                                  13579000
BASCSN2  EQU   BASEV+37                                                 13580000
BASLIB2  EQU   BASEV+49                                                 13581000
BASLID2  EQU   BASLIB2                                                  13582000
BASPREV  EQU   BASEV+50                                                 13583000
BASNEXTV EQU   BASEV+56                                                 13584000
BASNCOPY EQU   BASEV+62                                                 13585000
BASBKLMT EQU   BASEV+64                                                 13586000
BASFRESP EQU   BASEV+68                                                 13587000
BASLEXT  EQU   BASEV+70                                                 13588000
BASFREXT EQU   BASEV+72                                                 13589000
BASKLCPY EQU   BASEV+76                                                 13590000
BASCOPID EQU   BASKLCPY+11                                              13591000
BASCOPNO EQU   BASCOPID+1                                               13592000
BASDLMTD EQU   BASEV+92                                                 13593000
BASEXPDT EQU   BASEV+96                                                 13594000
BASDTREM EQU   BASEV+100                                                13595000
BASDESCR EQU   BASEV+104                                                13596000
BASOWNER EQU   BASEV+134                                                13597000
BASDEST  EQU   BASEV+144                                                13598000
BASRECOV EQU   BASEV+174                                                13599000
BASGROUP EQU   BASEV+180                                                13600000
COPYV    EQU   0                                                        13601000
COPNAME  EQU   COPYV                                                    13602000
COPV     EQU   COPNAME                                                  13603000
COPSERNO EQU   COPNAME+5                                                13604000
COPID    EQU   COPNAME+11                                               13605000
COPNO    EQU   COPID+1                                                  13606000
COPFLAGA EQU   COPYV+14                                                 13607000
COPTYPE  EQU   COPFLAGA                                                 13608000
COPCOPYV EQU   COPTYPE                                                  13609000
COPGROUP EQU   COPFLAGA+2                                               13610000
COPVSAM  EQU   COPFLAGA+2                                               13611000
COPGENUS EQU   COPFLAGA+2                                               13612000
COPRSTD  EQU   COPFLAGA+2                                               13613000
COPBKUP  EQU   COPFLAGA+2                                               13614000
COPBIND  EQU   COPFLAGA+2                                               13615000
COPEXCL  EQU   COPFLAGA+2                                               13616000
COPDAERA EQU   COPFLAGA+2                                               13617000
COPRONLY EQU   COPFLAGA+3                                               13618000
COPDLSPF EQU   COPFLAGA+3                                               13619000
COPRCVYF EQU   COPYV+20                                                 13620000
COPSATIA EQU   COPRCVYF                                                 13621000
COPMISCF EQU   COPRCVYF+2                                               13622000
COPHOLD  EQU   COPMISCF                                                 13623000
COPCSN1  EQU   COPYV+24                                                 13624000
COPLIB1  EQU   COPYV+36                                                 13625000
COPLID1  EQU   COPLIB1                                                  13626000
COPCSN2  EQU   COPYV+37                                                 13627000
COPLIB2  EQU   COPYV+49                                                 13628000
COPLID2  EQU   COPLIB2                                                  13629000
COPDATE  EQU   COPYV+50                                                 13630000
COPDTREM EQU   COPYV+54                                                 13631000
COPDESCR EQU   COPYV+58                                                 13632000
COPDEST  EQU   COPYV+88                                                 13633000
COPOWNER EQU   COPYV+118                                                13634000
COPFRESP EQU   COPYV+128                                                13635000
COPLEXT  EQU   COPYV+130                                                13636000
COPFREXT EQU   COPYV+132                                                13637000
DUPV     EQU   0                                                        13638000
DUPNAME  EQU   DUPV                                                     13639000
DUPD     EQU   DUPNAME                                                  13640000
DUPSERNO EQU   DUPNAME+5                                                13641000
DUPID    EQU   DUPNAME+11                                               13642000
DUPFLAGA EQU   DUPV+14                                                  13643000
DUPTYPE  EQU   DUPFLAGA                                                 13644000
DUPDUPLR EQU   DUPTYPE                                                  13645000
DUPRCVYF EQU   DUPV+20                                                  13646000
DUPCSN1  EQU   DUPV+24                                                  13647000
DUPLIB1  EQU   DUPV+36                                                  13648000
DUPLID1  EQU   DUPLIB1                                                  13649000
DUPCSN2  EQU   DUPV+37                                                  13650000
DUPLIB2  EQU   DUPV+49                                                  13651000
DUPLID2  EQU   DUPLIB2                                                  13652000
MCRTE    EQU   0                                                        13653000
MCRLOC   EQU   MCRTE+4                                                  13654000
MCRFLAGA EQU   MCRTE+34                                                 13655000
MCRSPLOC EQU   MCRFLAGA                                                 13656000
MCRFLAGB EQU   MCRTE+36                                                 13657000
MCRTYPE  EQU   MCRFLAGB+2                                               13658000
MCRREC   EQU   MCRTYPE                                                  13659000
DEFVE    EQU   0                                                        13660000
DEFGROUP EQU   DEFVE+4                                                  13661000
DEFDESCR EQU   DEFVE+12                                                 13662000
DEFTO    EQU   DEFVE+42                                                 13663000
DEFFOR   EQU   DEFVE+46                                                 13664000
DEFBKUPN EQU   DEFVE+48                                                 13665000
DEFLABEL EQU   DEFVE+49                                                 13666000
DEFFLAGA EQU   DEFVE+55                                                 13667000
DEFPFOR  EQU   DEFFLAGA                                                 13668000
DEFPGRO  EQU   DEFFLAGA                                                 13669000
DEFPDESC EQU   DEFFLAGA                                                 13670000
DEFPTO   EQU   DEFFLAGA                                                 13671000
DEFPBKUP EQU   DEFFLAGA                                                 13672000
DEFFLAGB EQU   DEFVE+56                                                 13673000
DEFSETFL EQU   DEFFLAGB                                                 13674000
DEFSRCVY EQU   DEFSETFL                                                 13675000
DEFCRCVY EQU   DEFSETFL                                                 13676000
DEFRECFL EQU   DEFFLAGB+1                                               13677000
DEFICOPY EQU   DEFRECFL                                                 13678000
DEFCREAT EQU   DEFRECFL                                                 13679000
DEFLAMIS EQU   DEFRECFL                                                 13680000
DEFTYPFL EQU   DEFFLAGB+2                                               13681000
DEFGENUS EQU   DEFTYPFL                                                 13682000
DEFRSTD  EQU   DEFTYPFL                                                 13683000
DEFDUP   EQU   DEFTYPFL                                                 13684000
DEFCOPY  EQU   DEFTYPFL                                                 13685000
DEFNULFL EQU   DEFFLAGB+3                                               13686000
DEFNGRP  EQU   DEFNULFL                                                 13687000
DEFNDESC EQU   DEFNULFL                                                 13688000
DEFNEXPD EQU   DEFNULFL                                                 13689000
COVCE    EQU   0                                                        13690000
COVDESCR EQU   COVCE+4                                                  13691000
COVFLAGA EQU   COVCE+34                                                 13692000
COVSPDES EQU   COVFLAGA                                                 13693000
COVFLAGB EQU   COVCE+35                                                 13694000
COVSETFL EQU   COVFLAGB                                                 13695000
COVSRCVY EQU   COVSETFL                                                 13696000
COVCRCVY EQU   COVSETFL                                                 13697000
COVRECFL EQU   COVFLAGB+1                                               13698000
COVICOPY EQU   COVRECFL                                                 13699000
COVCREAT EQU   COVRECFL                                                 13700000
COVLAMIS EQU   COVRECFL                                                 13701000
COVTYPE  EQU   COVFLAGB+2                                               13702000
COVSAM   EQU   COVTYPE                                                  13703000
COVREUSE EQU   COVTYPE                                                  13704000
LSTMCRT  EQU   0                                                        13705000
MCRTLEN  EQU   LSTMCRT                                                  13706000
MCRTOPCD EQU   LSTMCRT+4                                                13707000
MCRTFLG  EQU   LSTMCRT+6                                                13708000
MCRTTRAN EQU   MCRTFLG                                                  13709000
MCRTLIB  EQU   LSTMCRT+7                                                13710000
MCRTCSN  EQU   LSTMCRT+24                                               13711000
MCRTVEXT EQU   LSTMCRT+44                                               13712000
LSTDEFV  EQU   0                                                        13713000
DEFVLEN  EQU   LSTDEFV                                                  13714000
DEFVOPCD EQU   LSTDEFV+4                                                13715000
DEFVFLG  EQU   LSTDEFV+6                                                13716000
DEFVCR   EQU   DEFVFLG                                                  13717000
DEFVELM  EQU   DEFVFLG                                                  13718000
DEFVRNM  EQU   DEFVFLG                                                  13719000
DEFVREP  EQU   DEFVFLG                                                  13720000
DEFVELTR EQU   DEFVFLG                                                  13721000
DEFVRNTR EQU   DEFVFLG                                                  13722000
DEFVACT  EQU   DEFVFLG                                                  13723000
DEFVDACT EQU   DEFVFLG                                                  13724000
DEFVLIB  EQU   LSTDEFV+7                                                13725000
DEFVOLD  EQU   LSTDEFV+8                                                13726000
DEFVVFLG EQU   LSTDEFV+14                                               13727000
DEFVSEC  EQU   DEFVVFLG                                                 13728000
DEFVEXCL EQU   DEFVVFLG                                                 13729000
DEFVBIND EQU   DEFVVFLG                                                 13730000
DEFVWINH EQU   DEFVVFLG                                                 13731000
DEFVNVOL EQU   LSTDEFV+16                                               13732000
DEFVCSN1 EQU   LSTDEFV+24                                               13733000
DEFVDATA EQU   LSTDEFV+56                                               13734000
DEFOWNID EQU   DEFVDATA+29                                              13735000
DEFVVEXT EQU   LSTDEFV+128                                              13736000
LSTCVOL  EQU   0                                                        13737000
CVOLLEN  EQU   LSTCVOL                                                  13738000
CVOLOPCD EQU   LSTCVOL+4                                                13739000
CVOLFLG  EQU   LSTCVOL+6                                                13740000
CVODASCR EQU   CVOLFLG                                                  13741000
CVOCRCR  EQU   CVOLFLG                                                  13742000
CVOCRCRV EQU   CVOLFLG                                                  13743000
CVOLID   EQU   LSTCVOL+8                                                13744000
CVOLCSN  EQU   LSTCVOL+20                                               13745000
CVOLVEXT EQU   LSTCVOL+36                                               13746000
BUFFER   EQU   0                                                        13747000
PTRGROUP EQU   0                                                        13748000
PTRBASEV EQU   0                                                        13749000
PTRRPLV  EQU   0                                                        13750000
BYTEPASS EQU   0                                                        13751000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    13752000
CVOLRES2 EQU   LSTCVOL+34                                               13753000
CVOLRUA  EQU   LSTCVOL+32                                               13754000
CVOLECB  EQU   LSTCVOL+16                                               13755000
CVOLASID EQU   LSTCVOL+14                                               13756000
@NM00053 EQU   CVOLFLG                                                  13757000
CVOCRDAS EQU   CVOLFLG                                                  13758000
CVOLRES1 EQU   LSTCVOL+5                                                13759000
DEFTLAB  EQU   DEFVDATA+71                                              13760000
DEFR60   EQU   DEFVDATA+43                                              13761000
DEFR55   EQU   DEFVDATA+3                                               13762000
DEFACSEC EQU   DEFVDATA+2                                               13763000
DEFR50   EQU   DEFVDATA                                                 13764000
DEFVECB  EQU   LSTDEFV+52                                               13765000
DEFVASID EQU   LSTDEFV+50                                               13766000
@NM00052 EQU   LSTDEFV+48                                               13767000
DEFVCSN2 EQU   LSTDEFV+36                                               13768000
@NM00051 EQU   LSTDEFV+22                                               13769000
@NM00050 EQU   LSTDEFV+15                                               13770000
@NM00049 EQU   DEFVVFLG                                                 13771000
@NM00048 EQU   DEFVVFLG                                                 13772000
@NM00047 EQU   DEFVVFLG                                                 13773000
DEFVCECT EQU   DEFVVFLG                                                 13774000
DEFVLID  EQU   DEFVLIB                                                  13775000
@NM00046 EQU   DEFVLIB                                                  13776000
@NM00045 EQU   LSTDEFV+5                                                13777000
MCRTECB  EQU   LSTMCRT+40                                               13778000
MCRTASID EQU   LSTMCRT+38                                               13779000
MCRTRES4 EQU   LSTMCRT+36                                               13780000
MCRTRES3 EQU   LSTMCRT+16                                               13781000
MCRTRES2 EQU   LSTMCRT+8                                                13782000
MCRTLD   EQU   MCRTLIB                                                  13783000
@NM00044 EQU   MCRTLIB                                                  13784000
@NM00043 EQU   MCRTFLG                                                  13785000
MCRTSCT  EQU   MCRTFLG                                                  13786000
@NM00042 EQU   MCRTFLG                                                  13787000
MCRTRES1 EQU   LSTMCRT+5                                                13788000
@NM00041 EQU   COVCE+39                                                 13789000
@NM00040 EQU   COVFLAGB+3                                               13790000
@NM00039 EQU   COVTYPE                                                  13791000
@NM00038 EQU   COVRECFL                                                 13792000
@NM00037 EQU   COVSETFL                                                 13793000
@NM00036 EQU   COVFLAGA                                                 13794000
COVLNGTH EQU   COVCE                                                    13795000
@NM00035 EQU   DEFVE+60                                                 13796000
@NM00034 EQU   DEFNULFL                                                 13797000
@NM00033 EQU   DEFTYPFL                                                 13798000
@NM00032 EQU   DEFRECFL                                                 13799000
@NM00031 EQU   DEFSETFL                                                 13800000
@NM00030 EQU   DEFFLAGA                                                 13801000
DEFPVLAB EQU   DEFFLAGA                                                 13802000
DEFLNGTH EQU   DEFVE                                                    13803000
@NM00029 EQU   MCRTE+40                                                 13804000
@NM00028 EQU   MCRFLAGB+3                                               13805000
@NM00027 EQU   MCRTYPE                                                  13806000
@NM00026 EQU   MCRFLAGB+1                                               13807000
@NM00025 EQU   MCRFLAGB                                                 13808000
MCRBLNK1 EQU   MCRTE+35                                                 13809000
@NM00024 EQU   MCRFLAGA                                                 13810000
MCRLNGTH EQU   MCRTE                                                    13811000
@NM00023 EQU   DUPV+50                                                  13812000
DUP2BIT2 EQU   DUPLID2                                                  13813000
DUP2BIT1 EQU   DUPLID2                                                  13814000
DUPRES4  EQU   DUPLIB2                                                  13815000
DUP1BIT2 EQU   DUPLID1                                                  13816000
DUP1BIT1 EQU   DUPLID1                                                  13817000
DUPRES3  EQU   DUPLIB1                                                  13818000
DUPMISCF EQU   DUPRCVYF+2                                               13819000
DUPSATIA EQU   DUPRCVYF                                                 13820000
@NM00022 EQU   DUPV+18                                                  13821000
@NM00021 EQU   DUPFLAGA+2                                               13822000
DUPRES2  EQU   DUPTYPE                                                  13823000
DUPRES1  EQU   DUPTYPE                                                  13824000
DUPRES5  EQU   DUPV+13                                                  13825000
DUPNO    EQU   DUPID+1                                                  13826000
DUPBLANK EQU   DUPID                                                    13827000
@NM00020 EQU   COPYV+136                                                13828000
COP2BIT2 EQU   COPLID2                                                  13829000
COP2BIT1 EQU   COPLID2                                                  13830000
COPRES5  EQU   COPLIB2                                                  13831000
COP1BIT2 EQU   COPLID1                                                  13832000
COP1BIT1 EQU   COPLID1                                                  13833000
COPRES4  EQU   COPLIB1                                                  13834000
@NM00019 EQU   COPMISCF                                                 13835000
COPRES3  EQU   COPSATIA                                                 13836000
COPVSMIS EQU   COPSATIA                                                 13837000
COPIVCPY EQU   COPSATIA                                                 13838000
COPIVCRE EQU   COPSATIA                                                 13839000
@NM00018 EQU   COPYV+18                                                 13840000
@NM00017 EQU   COPFLAGA+3                                               13841000
COPRES2  EQU   COPTYPE                                                  13842000
COPRES1  EQU   COPTYPE                                                  13843000
COPRES6  EQU   COPYV+13                                                 13844000
COPBLANK EQU   COPID                                                    13845000
@NM00016 EQU   BASEV+188                                                13846000
BASRES6  EQU   BASEV+89                                                 13847000
BASCOPBK EQU   BASCOPID                                                 13848000
BASCOPSN EQU   BASKLCPY+5                                               13849000
BASCOPV  EQU   BASKLCPY                                                 13850000
@NM00015 EQU   BASEV+65                                                 13851000
BASNBKUP EQU   BASEV+63                                                 13852000
BAS2BIT2 EQU   BASLID2                                                  13853000
BAS2BIT1 EQU   BASLID2                                                  13854000
BASRES5  EQU   BASLIB2                                                  13855000
BAS1BIT2 EQU   BASLID1                                                  13856000
BAS1BIT1 EQU   BASLID1                                                  13857000
BASRES4  EQU   BASLIB1                                                  13858000
BASRES3  EQU   BASMISCF                                                 13859000
BASRES8  EQU   BASSATIA                                                 13860000
BASVSMIS EQU   BASSATIA                                                 13861000
BASIVCPY EQU   BASSATIA                                                 13862000
BASIVCRE EQU   BASSATIA                                                 13863000
BASCPUID EQU   BASEV+18                                                 13864000
@NM00014 EQU   BASFLAGA+3                                               13865000
BASRES2  EQU   BASTYPE                                                  13866000
BASRES1  EQU   BASTYPE                                                  13867000
BASRES7  EQU   BASEV+13                                                 13868000
BASZERO  EQU   BASID+1                                                  13869000
BASBLANK EQU   BASID                                                    13870000
BASEVKEY EQU   BASNAME                                                  13871000
BCD2BIT2 EQU   BCDLID2                                                  13872000
BCD2BIT1 EQU   BCDLID2                                                  13873000
BCDRES8  EQU   BCDLIB2                                                  13874000
BCD1BIT2 EQU   BCDLID1                                                  13875000
BCD1BIT1 EQU   BCDLID1                                                  13876000
BCDRE10  EQU   BCDLIB1                                                  13877000
BCDRES7A EQU   BCDMISCF                                                 13878000
BCDHOLD  EQU   BCDMISCF                                                 13879000
BCDRES7  EQU   BCDSATIA                                                 13880000
BCDCPUID EQU   BCDV+18                                                  13881000
BCDRES5  EQU   BCDFLAGB+1                                               13882000
BCDREASS EQU   BCDFLAGB+1                                               13883000
BCDRES4  EQU   BCDFLAGB                                                 13884000
BCDRES3  EQU   BCDTYPE                                                  13885000
BCDRES2  EQU   BCDTYPE                                                  13886000
BCDRES1  EQU   BCDTYPE                                                  13887000
BCDRES9  EQU   BCDV+13                                                  13888000
BCDINDEX EQU   BCDID+1                                                  13889000
BCDBLNK2 EQU   BCDID                                                    13890000
BCDBLNK1 EQU   BCDPREFX+1                                               13891000
BCDALPHA EQU   BCDPREFX                                                 13892000
@NM00013 EQU   NGVR+32                                                  13893000
@NM00012 EQU   NGVR+29                                                  13894000
@NM00011 EQU   NGVR+15                                                  13895000
NGVRES2  EQU   NGVRTYPE+1                                               13896000
NGVHDR   EQU   NGVRTYPE                                                 13897000
NGVRES1  EQU   NGVRTYPE                                                 13898000
NGVNAME  EQU   NGVR                                                     13899000
@NM00010 EQU   GROUP+136                                                13900000
GROADDR  EQU   GROUP+106                                                13901000
GROOWNER EQU   GROUP+96                                                 13902000
GRORESSP EQU   GROUP+95                                                 13903000
GROCONUS EQU   GROUP+94                                                 13904000
GRODESCR EQU   GROUP+64                                                 13905000
GROERRTM EQU   GROERRTS+4                                               13906000
GROERRDT EQU   GROERRTS                                                 13907000
GRORETPD EQU   GROUP+52                                                 13908000
GROSSPD  EQU   GROUP+38                                                 13909000
GROPSPD  EQU   GROUP+36                                                 13910000
@NM00009 EQU   GROFLAGA+2                                               13911000
GRORLSE  EQU   GROFLAGA+2                                               13912000
GRORES1  EQU   GROTYPE                                                  13913000
GROGVR   EQU   GROTYPE                                                  13914000
GROZERO  EQU   GROID+1                                                  13915000
GROBLANK EQU   GROID                                                    13916000
GROVVGRP EQU   GRONAME+3                                                13917000
GROG     EQU   GRONAME                                                  13918000
@NM00008 EQU   INDEX+28                                                 13919000
INDEXREC EQU   INDRECID+1                                               13920000
INDBLNK2 EQU   INDRECID                                                 13921000
INDVSRNO EQU   INDRECKY+5                                               13922000
INDBLNK1 EQU   INDPREFX+1                                               13923000
INDALPHA EQU   INDPREFX                                                 13924000
INDRES2  EQU   INDTYPE                                                  13925000
INDINDEX EQU   INDTYPE                                                  13926000
INDRES1  EQU   INDTYPE                                                  13927000
INDSERNO EQU   INDNAME+1                                                13928000
INDI     EQU   INDNAME                                                  13929000
@NM00007 EQU   RPLVSAM+44                                               13930000
@NM00006 EQU   RPLVOPT                                                  13931000
@NM00005 EQU   RPLVOPT                                                  13932000
RPLVNEXT EQU   RPLVOPT                                                  13933000
@NM00004 EQU   RPLVSAM+28                                               13934000
RPLVACB  EQU   RPLVSAM+24                                               13935000
@NM00003 EQU   RPLVSAM+3                                                13936000
@NM00002 EQU   RPLVSAM                                                  13937000
@NM00001 EQU   RPLV+42                                                  13938000
RPLRMSCC EQU   RPLV+36                                                  13939000
RPLVTLEN EQU   RPLV+30                                                  13940000
RPLVRES1 EQU   RPLFLAGA+1                                               13941000
RPLVJRNL EQU   RPLFLAGA                                                 13942000
RPLVVOP  EQU   RPLFLAGA                                                 13943000
RPLVVIN  EQU   RPLFLAGA                                                 13944000
RPLVCOMP EQU   RPLFLAGA                                                 13945000
RPLVPROG EQU   RPLFLAGA                                                 13946000
RPLVPOST EQU   RPLFLAGA                                                 13947000
RPLVRSV3 EQU   RPLV+24                                                  13948000
RPLVRSV2 EQU   RPLV+20                                                  13949000
RPLVRSV1 EQU   RPLV+16                                                  13950000
RPLASCBP EQU   RPLTCBPR                                                 13951000
RPLVECB  EQU   RPLV+4                                                   13952000
RPLVQPTR EQU   RPLV                                                     13953000
VVIUNUSD EQU   VVICB+116                                                13954000
VVINUSDC EQU   VVICB+112                                                13955000
VVITPFCH EQU   VVICB+108                                                13956000
VVIDVMEL EQU   VVICB+104                                                13957000
VVIVBSTF EQU   VVICB+100                                                13958000
VVISSOBA EQU   VVICB+96                                                 13959000
VVIVSCRA EQU   VVICB+92                                                 13960000
VVISTPTB EQU   VVICB+88                                                 13961000
VVIDVMTA EQU   VVICB+84                                                 13962000
VVIJUCB  EQU   VVICB+80                                                 13963000
VVIIUCB  EQU   VVICB+76                                                 13964000
VVIRES6  EQU   VVICB+72                                                 13965000
VVIRES5  EQU   VVICB+68                                                 13966000
VVIRES4  EQU   VVICB+64                                                 13967000
VVIUCB   EQU   VVICB+60                                                 13968000
VVIVJL   EQU   VVICB+56                                                 13969000
VVIVRR   EQU   VVICB+52                                                 13970000
VVIQLSPL EQU   VVICB+48                                                 13971000
VVIQRPL2 EQU   VVICB+44                                                 13972000
VVIQRPL1 EQU   VVICB+40                                                 13973000
VVIVTRK  EQU   VVICB+37                                                 13974000
VVIOPCD  EQU   VVICB+36                                                 13975000
VVIVQMP  EQU   VVICB+32                                                 13976000
VVIECB1  EQU   VVICB+28                                                 13977000
VVICATAD EQU   VVICB+24                                                 13978000
VVIDCBAD EQU   VVICB+20                                                 13979000
VVIACBAD EQU   VVICB+16                                                 13980000
VVIFLG7  EQU   VVIFLGA                                                  13981000
VVIFLG6  EQU   VVIFLGA                                                  13982000
VVIFLG5  EQU   VVIFLGA                                                  13983000
VVIFLG4  EQU   VVIFLGA                                                  13984000
VVIFLG3  EQU   VVIFLGA                                                  13985000
VVIFLG1  EQU   VVIFLGA                                                  13986000
VVIALCON EQU   VVICB+14                                                 13987000
VVICPUID EQU   VVICB+12                                                 13988000
VVIUCAT  EQU   VVICB+4                                                  13989000
VVICID   EQU   VVICB                                                    13990000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      13991000
@RF00191 EQU   @EL00002                                                 13992000
@RF00203 EQU   @EL00002                                                 13993000
@RF00211 EQU   @EL00002                                                 13994000
@RT00255 EQU   @EL00002                                                 13995000
@RT00261 EQU   @EL00002                                                 13996000
@RT00335 EQU   @EL00003                                                 13997000
@RT00377 EQU   @EL00007                                                 13998000
@RT00391 EQU   @EL00007                                                 13999000
@RT00405 EQU   @EL00008                                                 14000000
@RT00430 EQU   @EL00009                                                 14001000
@RT00461 EQU   @EL00011                                                 14002000
@RF00490 EQU   @EL00012                                                 14003000
@RF00513 EQU   @RC00506                                                 14004000
@RT00549 EQU   @EL00012                                                 14005000
@RT00551 EQU   @EL00012                                                 14006000
@RT00567 EQU   @EL00012                                                 14007000
@RT00578 EQU   @EL00012                                                 14008000
@RC00569 EQU   @EL00012                                                 14009000
@RT00591 EQU   @EL00013                                                 14010000
@RT00607 EQU   @EL00014                                                 14011000
@RT00620 EQU   @EL00015                                                 14012000
@RT00625 EQU   @EL00015                                                 14013000
@RT00630 EQU   @EL00015                                                 14014000
@RT00634 EQU   @EL00015                                                 14015000
@RT00641 EQU   @EL00015                                                 14016000
@RT00660 EQU   @EL00015                                                 14017000
@RF00666 EQU   @EL00015                                                 14018000
@RT00678 EQU   @EL00015                                                 14019000
@RT00682 EQU   @EL00015                                                 14020000
@RT00692 EQU   @EL00015                                                 14021000
@RT00709 EQU   @EL00016                                                 14022000
@RT00714 EQU   @EL00016                                                 14023000
@RT00736 EQU   @EL00016                                                 14024000
@RT00753 EQU   @EL00017                                                 14025000
@RF00744 EQU   @EL00017                                                 14026000
@RC00746 EQU   @EL00017                                                 14027000
@RT00780 EQU   @EL00018                                                 14028000
@RC00785 EQU   @RC00783                                                 14029000
@RC00812 EQU   @RC00810                                                 14030000
@RT00835 EQU   @EL00018                                                 14031000
@RF00773 EQU   @EL00018                                                 14032000
@RF00772 EQU   @EL00018                                                 14033000
@RF00834 EQU   @EL00018                                                 14034000
@RT00854 EQU   @EL00019                                                 14035000
@RT00861 EQU   @EL00019                                                 14036000
@RT00874 EQU   @EL00019                                                 14037000
@RT00882 EQU   @EL00019                                                 14038000
@RT00896 EQU   @EL00019                                                 14039000
@RT00903 EQU   @EL00019                                                 14040000
@RT00910 EQU   @EL00019                                                 14041000
@RT00926 EQU   @EL00020                                                 14042000
@RT00957 EQU   @EL00020                                                 14043000
@RT00961 EQU   @EL00020                                                 14044000
@RT00964 EQU   @EL00020                                                 14045000
@RT00968 EQU   @EL00020                                                 14046000
@RT00987 EQU   @EL00021                                                 14047000
@RT00993 EQU   @EL00021                                                 14048000
@RT00997 EQU   @EL00021                                                 14049000
@RT01005 EQU   @EL00021                                                 14050000
@RT01008 EQU   @EL00021                                                 14051000
@RT01020 EQU   @EL00021                                                 14052000
@RT01031 EQU   @EL00021                                                 14053000
@RT01045 EQU   @EL00022                                                 14054000
@RT01060 EQU   @EL00022                                                 14055000
@RT01067 EQU   @EL00022                                                 14056000
@RT01085 EQU   @EL00022                                                 14057000
@RT01095 EQU   @EL00023                                                 14058000
@RT01127 EQU   @EL00023                                                 14059000
@RT01132 EQU   @EL00023                                                 14060000
@RT01139 EQU   @EL00023                                                 14061000
@RT01143 EQU   @EL00023                                                 14062000
@RT01152 EQU   @EL00024                                                 14063000
@RT01165 EQU   @EL00025                                                 14064000
@RT01175 EQU   @EL00025                                                 14065000
@RT01183 EQU   @EL00025                                                 14066000
@RF01185 EQU   @EL00025                                                 14067000
@RT01197 EQU   @EL00026                                                 14068000
@RT01207 EQU   @EL00026                                                 14069000
@RT01214 EQU   @EL00026                                                 14070000
@RF01216 EQU   @EL00026                                                 14071000
@RT01230 EQU   @EL00027                                                 14072000
@RT01242 EQU   @EL00027                                                 14073000
@RT01246 EQU   @EL00027                                                 14074000
@RF01237 EQU   @RC01234                                                 14075000
@RT01267 EQU   @EL00027                                                 14076000
@RT01292 EQU   @EL00028                                                 14077000
@RT01298 EQU   @EL00028                                                 14078000
@RF01318 EQU   @EL00029                                                 14079000
@RF01324 EQU   @EL00029                                                 14080000
@RF01327 EQU   @EL00029                                                 14081000
@RF01343 EQU   @EL00030                                                 14082000
@RF01349 EQU   @EL00030                                                 14083000
@RF01363 EQU   @EL00031                                                 14084000
@RT01371 EQU   @EL00031                                                 14085000
@RT01375 EQU   @EL00031                                                 14086000
@RT01391 EQU   @EL00032                                                 14087000
@RT01410 EQU   @EL00032                                                 14088000
@RT01415 EQU   @EL00032                                                 14089000
@RF01431 EQU   @EL00033                                                 14090000
@RT01441 EQU   @EL00033                                                 14091000
@RT01455 EQU   @EL00033                                                 14092000
@RT01498 EQU   @EL00036                                                 14093000
@RT01510 EQU   @EL00036                                                 14094000
@RT01525 EQU   @EL00036                                                 14095000
@RT01531 EQU   @EL00036                                                 14096000
@RC01528 EQU   @EL00036                                                 14097000
@RT01540 EQU   @EL00037                                                 14098000
@RC01588 EQU   @EL00038                                                 14099000
@RT01619 EQU   @EL00039                                                 14100000
@RT01673 EQU   @EL00040                                                 14101000
@RT01679 EQU   @EL00040                                                 14102000
@RT01686 EQU   @EL00040                                                 14103000
@RT01698 EQU   @EL00041                                                 14104000
@RT01705 EQU   @EL00041                                                 14105000
@RT01709 EQU   @EL00041                                                 14106000
@RT01730 EQU   @EL00042                                                 14107000
@RT01747 EQU   @EL00043                                                 14108000
@RT01757 EQU   @EL00043                                                 14109000
@RT01767 EQU   @EL00043                                                 14110000
@RT01779 EQU   @EL00043                                                 14111000
@RT01784 EQU   @EL00043                                                 14112000
@RT01789 EQU   @EL00043                                                 14113000
@RT01793 EQU   @EL00043                                                 14114000
@RT01828 EQU   @EL00043                                                 14115000
@RT01832 EQU   @EL00043                                                 14116000
@RT01863 EQU   @EL00045                                                 14117000
@RT01871 EQU   @EL00045                                                 14118000
@RT01883 EQU   @EL00045                                                 14119000
@RT01905 EQU   @EL00046                                                 14120000
@RT01912 EQU   @EL00046                                                 14121000
@RT01931 EQU   @EL00046                                                 14122000
@RF01936 EQU   @EL00046                                                 14123000
@RF01953 EQU   @EL00047                                                 14124000
@RT01961 EQU   @EL00047                                                 14125000
@RT01977 EQU   @EL00047                                                 14126000
@RT01997 EQU   @EL00047                                                 14127000
@RT02000 EQU   @EL00047                                                 14128000
@RT02019 EQU   @EL00048                                                 14129000
@RT02023 EQU   @EL00048                                                 14130000
@RT02026 EQU   @EL00048                                                 14131000
@RT02038 EQU   @EL00049                                                 14132000
@RT02041 EQU   @EL00049                                                 14133000
@RT02048 EQU   @EL00049                                                 14134000
@RT02076 EQU   @EL00050                                                 14135000
@RT02086 EQU   @EL00050                                                 14136000
@RT02094 EQU   @EL00050                                                 14137000
@RT02103 EQU   @EL00050                                                 14138000
@RT02107 EQU   @EL00050                                                 14139000
@RT02118 EQU   @EL00050                                                 14140000
@RT02127 EQU   @EL00050                                                 14141000
@RT02134 EQU   @EL00050                                                 14142000
@RT02140 EQU   @EL00050                                                 14143000
@RT02231 EQU   @EL00050                                                 14144000
@RT02235 EQU   @EL00050                                                 14145000
@RT02240 EQU   @EL00050                                                 14146000
@RT02246 EQU   @EL00050                                                 14147000
@RC02262 EQU   @EL00051                                                 14148000
@RT02276 EQU   @EL00052                                                 14149000
@RT02279 EQU   @EL00052                                                 14150000
@RT02288 EQU   @EL00053                                                 14151000
@RT02296 EQU   @EL00053                                                 14152000
@RT02306 EQU   @EL00053                                                 14153000
@RT02311 EQU   @EL00053                                                 14154000
@RF02317 EQU   @EL00053                                                 14155000
@RT02328 EQU   @EL00054                                                 14156000
@RC02344 EQU   @EL00055                                                 14157000
@RT02363 EQU   @EL00056                                                 14158000
@RT02378 EQU   @EL00056                                                 14159000
@RF02358 EQU   @EL00056                                                 14160000
@RF02380 EQU   @EL00056                                                 14161000
@RT02413 EQU   @EL00057                                                 14162000
@RT02430 EQU   @EL00057                                                 14163000
@RT02440 EQU   @EL00058                                                 14164000
@RT02445 EQU   @EL00058                                                 14165000
@RT02449 EQU   @EL00058                                                 14166000
@RT02479 EQU   @EL00059                                                 14167000
@RT02495 EQU   @EL00059                                                 14168000
@RT02512 EQU   @EL00060                                                 14169000
@RT02520 EQU   @EL00060                                                 14170000
@RT02528 EQU   @EL00060                                                 14171000
@RT02542 EQU   @EL00060                                                 14172000
@RT02549 EQU   @EL00060                                                 14173000
@RT02556 EQU   @EL00060                                                 14174000
@RT02589 EQU   @EL00061                                                 14175000
@RT02614 EQU   @EL00061                                                 14176000
@RT02619 EQU   @EL00061                                                 14177000
@RT02637 EQU   @EL00061                                                 14178000
@RT02642 EQU   @EL00061                                                 14179000
@RT02653 EQU   @EL00061                                                 14180000
@RT02680 EQU   @EL00062                                                 14181000
@RT02699 EQU   @EL00062                                                 14182000
@RT02717 EQU   @EL00063                                                 14183000
@RT02729 EQU   @EL00063                                                 14184000
@RT02762 EQU   @EL00066                                                 14185000
@RT02766 EQU   @EL00066                                                 14186000
@RT02770 EQU   @EL00066                                                 14187000
@RT02801 EQU   @EL00067                                                 14188000
@RT02816 EQU   @EL00067                                                 14189000
@RT02821 EQU   @EL00067                                                 14190000
@RT02841 EQU   @EL00067                                                 14191000
@RT02846 EQU   @EL00067                                                 14192000
@RT02857 EQU   @EL00067                                                 14193000
@RT02871 EQU   @EL00068                                                 14194000
@RT02891 EQU   @EL00068                                                 14195000
@RT02914 EQU   @EL00069                                                 14196000
@RT02918 EQU   @EL00069                                                 14197000
@RT02923 EQU   @EL00069                                                 14198000
@RF00756 EQU   @RC00746                                                 14199000
@RC00787 EQU   @RC00785                                                 14200000
@RC00814 EQU   @RC00812                                                 14201000
@RC00789 EQU   @RC00787                                                 14202000
@ENDDATA EQU   *                                                        14203000
         END   ICBVUT00,(C'PLS1248',0701,78157)                         14204000
