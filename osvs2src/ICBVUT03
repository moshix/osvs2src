         TITLE 'ICBVUT03 - NULLIFYC SERVICE AID (JULY 1, 1975) MVS     *00001000
                        '                                               00002000
ICBVUT03 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'ICBVUT03  76.280'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@12                                         0001 00013000
         ST    @13,@SA00001+4                                      0001 00014000
         LA    @14,@SA00001                                        0001 00015000
         ST    @14,8(,@13)                                         0001 00016000
         LR    @13,@14                                             0001 00017000
*   RPLVPTR=RG1;                    /* SET RPLV ADDR         @Z40LB25*/ 00018000
         LR    RPLVPTR,RG1                                         0091 00019000
*   RESPECIFY                                                      0092 00020000
*     RG1 UNRSTD;                   /* FREE REG1             @Z40LB25*/ 00021000
*   VVIPTR=RPLVVICB;                /* ADDR TO MSVCB         @Z40LB25*/ 00022000
         L     VVIPTR,RPLVVICB(,RPLVPTR)                           0093 00023000
*   GROUPPTR=ADDR(GROUPBUF);        /* ADDR GRP BUF          @Z40LB25*/ 00024000
         LA    GROUPPTR,GROUPBUF                                   0094 00025000
*   NGVRPTR=ADDR(NGVRBUF);          /* ADDR NON-GRP BUF      @Z40LB25*/ 00026000
         LA    NGVRPTR,NGVRBUF                                     0095 00027000
*   COPYVPTR=ADDR(COPYBUF);         /* ADDR CVR BUF          @Z40LB25*/ 00028000
         LA    COPYVPTR,COPYBUF                                    0096 00029000
*   BASEVPTR=ADDR(BASEBUF);         /* ADDR BVR BUF          @Z40LB25*/ 00030000
         LA    BASEVPTR,BASEBUF                                    0097 00031000
*   INDEXPTR=ADDR(INDEXBUF);        /* ADDR CIR BUF          @Z40LB25*/ 00032000
         LA    INDEXPTR,INDEXBUF                                   0098 00033000
*   DUPVPTR=ADDR(DUPVBUF);          /* ADDR DUP BUF          @Z40LB25*/ 00034000
         LA    DUPVPTR,DUPVBUF                                     0099 00035000
*   PTRRPLV=RPLVPTR;                /* RPLV PTR PARM         @Z40LB25*/ 00036000
         ST    RPLVPTR,PTRRPLV                                     0100 00037000
*   PTRGROUP=GROUPPTR;              /* GHR PTR PARM          @Z40LB25*/ 00038000
         ST    GROUPPTR,PTRGROUP                                   0101 00039000
*   PTRNGVR=NGVRPTR;                /* NGHR PTR PARM         @Z40LB25*/ 00040000
         LR    PTRNGVR,NGVRPTR                                     0102 00041000
*   PTRCOPYV=COPYVPTR;              /* CVR PTR PARM          @Z40LB25*/ 00042000
         ST    COPYVPTR,PTRCOPYV                                   0103 00043000
*   PTRBASEV=BASEVPTR;              /* BVR PTR PARM          @Z40LB25*/ 00044000
         ST    BASEVPTR,PTRBASEV                                   0104 00045000
*   PTRDUPV=DUPVPTR;                /* DVR PTR PARM          @Z40LB25*/ 00046000
         ST    DUPVPTR,PTRDUPV                                     0105 00047000
*   NULCPTR=ADDR(RPLVUTIL);         /* ADDR TO ICBNULLC      @Z40LB25*/ 00048000
         LA    NULCPTR,RPLVUTIL(,RPLVPTR)                          0106 00049000
*   WORKAREA=WORKAREA&&WORKAREA;    /* ZERO WORK AREA        @Z40LB25*/ 00050000
         XC    WORKAREA(19),WORKAREA                               0107 00051000
*   CIDKY=IDONE;                    /* CVR ID TO 1           @Z40LB25*/ 00052000
         MVI   CIDKY,X'01'                                         0108 00053000
*   DIDKY=IDONE;                    /* DVR ID TO 1           @Z40LB25*/ 00054000
*                                                                  0109 00055000
         MVI   DIDKY,X'01'                                         0109 00056000
*   /*****************************************************************/ 00057000
*   /*                                                               */ 00058000
*   /* CHECK FOR AN MSC ERROR.                               @Z40LB25*/ 00059000
*   /*                                                               */ 00060000
*   /*****************************************************************/ 00061000
*                                                                  0110 00062000
*   IF RPLRCODE^=OKZERO             /* CONTINUE?             @Z40LB25*/ 00063000
*     THEN                          /* NO                    @Z40LB25*/ 00064000
         LH    @15,RPLRCODE(,RPLVPTR)                              0110 00065000
         N     @15,@CF00613                                        0110 00066000
         LTR   @15,@15                                             0110 00067000
         BZ    @RF00110                                            0110 00068000
*     DO;                           /*                       @Z40LB25*/ 00069000
*       RPLVRETC=RPLVRETC&&RPLVRETC;/* ZERO RETN CODE        @Z40LB25*/ 00070000
         XC    RPLVRETC(2,RPLVPTR),RPLVRETC(RPLVPTR)               0112 00071000
*       RPLRCODE=RPLRCODE&&RPLRCODE;/* ZERO RESN CODE        @Z40LB25*/ 00072000
         XC    RPLRCODE(2,RPLVPTR),RPLRCODE(RPLVPTR)               0113 00073000
*       RETURN;                     /*                       @Z40LB25*/ 00074000
@EL00001 L     @13,4(,@13)                                         0114 00075000
@EF00001 DS    0H                                                  0114 00076000
@ER00001 LM    @14,@12,12(@13)                                     0114 00077000
         BR    @14                                                 0114 00078000
*     END;                          /*                       @Z40LB25*/ 00079000
*                                                                  0115 00080000
*   /*****************************************************************/ 00081000
*   /*                                                               */ 00082000
*   /* CHECK FOR THE MSVC BEING DISABLED.                    @Z40LB25*/ 00083000
*   /*                                                               */ 00084000
*   /*****************************************************************/ 00085000
*                                                                  0116 00086000
*   IF VVIFLG0=ON                   /* MSVC DISABLED?        @Z40LB25*/ 00087000
*     THEN                          /* YES                   @Z40LB25*/ 00088000
@RF00110 TM    VVIFLG0(VVIPTR),B'10000000'                         0116 00089000
         BNO   @RF00116                                            0116 00090000
*     DO;                           /*                       @Z40LB25*/ 00091000
*       RPLVRETC=RETNCD4;           /* 4 ERROR RETN CODE     @Z40LB25*/ 00092000
         MVC   RPLVRETC(2,RPLVPTR),@CH00036                        0118 00093000
*       RPLRCODE=DISABLED;          /* 213 REASON CODE       @Z40LB25*/ 00094000
         MVC   RPLRCODE(2,RPLVPTR),@CB00527                        0119 00095000
*       RETURN;                     /*                       @Z40LB25*/ 00096000
         B     @EL00001                                            0120 00097000
*     END;                          /*                       @Z40LB25*/ 00098000
*                                                                  0121 00099000
*   /*****************************************************************/ 00100000
*   /*                                                               */ 00101000
*   /* JOURNAL THE RPLV AND RESERVE THE INVENTORY.           @Z40LB25*/ 00102000
*   /*                                                               */ 00103000
*   /*****************************************************************/ 00104000
*                                                                  0122 00105000
*   CALL HOUSKEEP;                  /* JRNL RPLV &           @Z40LB25   00106000
*                                      RESERVE .MSVI         @Z40LB25*/ 00107000
*                                                                  0122 00108000
@RF00116 BAL   @14,HOUSKEEP                                        0122 00109000
*   /*****************************************************************/ 00110000
*   /*                                                               */ 00111000
*   /* GET THE MSVI RECORD - NONE IS OK.                     @Z40LB25*/ 00112000
*   /*                                                               */ 00113000
*   /*****************************************************************/ 00114000
*                                                                  0123 00115000
*   IF NULVOL=ON                    /* ACTIVE?               @Z40LB25*/ 00116000
*     THEN                          /* YES                   @Z40LB25*/ 00117000
*                                                                  0123 00118000
         TM    NULVOL(NULCPTR),B'10000000'                         0123 00119000
         BNO   @RF00123                                            0123 00120000
*     /***************************************************************/ 00121000
*     /*                                                             */ 00122000
*     /* GET THE BVR - ACTIVE.                               @Z40LB25*/ 00123000
*     /*                                                             */ 00124000
*     /***************************************************************/ 00125000
*                                                                  0124 00126000
*     DO;                           /*                       @Z40LB25*/ 00127000
*       BVOLKY=NULVOLID;            /* SET VOLID             @Z40LB25*/ 00128000
         MVC   BVOLKY(6),NULVOLID(NULCPTR)                         0125 00129000
*       RPLVKEY=ADDR(BKEY);         /* SET KEY ADDR          @Z40LB25*/ 00130000
         LA    @09,BKEY                                            0126 00131000
         ST    @09,RPLVKEY(,RPLVPTR)                               0126 00132000
*       CALL READUPD1;              /* READ BVR              @Z40LB25*/ 00133000
         BAL   @14,READUPD1                                        0127 00134000
*       IF RPLVRETC^=OKZERO         /* ERROR?                @Z40LB25*/ 00135000
*         THEN                      /* YES                   @Z40LB25*/ 00136000
         LH    @09,RPLVRETC(,RPLVPTR)                              0128 00137000
         N     @09,@CF00613                                        0128 00138000
         LTR   @09,@09                                             0128 00139000
         BZ    @RF00128                                            0128 00140000
*         DO;                       /* CK ERROR              @Z40LB25*/ 00141000
*                                                                  0129 00142000
*           /*********************************************************/ 00143000
*           /*                                                       */ 00144000
*           /* NO RECORD FOUND IS OK.                        @Z40LB25*/ 00145000
*           /*                                                       */ 00146000
*           /*********************************************************/ 00147000
*                                                                  0130 00148000
*           IF RPLRCODE=NORECFND    /* NO RECD FND?          @Z40LB25*/ 00149000
*             THEN                  /* YES                   @Z40LB25*/ 00150000
         CLC   RPLRCODE(2,RPLVPTR),@CB00523                        0130 00151000
         BNE   @RF00130                                            0130 00152000
*             DO;                   /* OK                    @Z40LB25*/ 00153000
*               RPLRCODE=RPLRCODE&&RPLRCODE;/*               @Z40LB25   00154000
*                                      ZERO RESN CODE        @Z40LB25*/ 00155000
         XC    RPLRCODE(2,RPLVPTR),RPLRCODE(RPLVPTR)               0132 00156000
*               RPLVRETC=RPLVRETC&&RPLVRETC;/*               @Z40LB25   00157000
*                                      ZERO RETN CODE        @Z40LB25*/ 00158000
         XC    RPLVRETC(2,RPLVPTR),RPLVRETC(RPLVPTR)               0133 00159000
*             END;                  /*                       @Z40LB25*/ 00160000
*           RETURN;                 /*                       @Z40LB25*/ 00161000
         B     @EL00001                                            0135 00162000
*         END;                      /*                       @Z40LB25*/ 00163000
*       BASEBUF=TEMPBUF;            /* USE CORRECT BUF       @Z40LB25*/ 00164000
@RF00128 MVC   BASEBUF(224),TEMPBUF                                0137 00165000
*     END;                          /*                       @Z40LB25*/ 00166000
*   ELSE                            /* INACTIVE              @Z40LB25*/ 00167000
*                                                                  0139 00168000
*     /***************************************************************/ 00169000
*     /*                                                             */ 00170000
*     /* GET THE BVR OR CVR OR DVR - INACTIVE.               @Z40LB25*/ 00171000
*     /*                                                             */ 00172000
*     /***************************************************************/ 00173000
*                                                                  0139 00174000
*     DO;                           /*                       @Z40LB25*/ 00175000
         B     @RC00123                                            0139 00176000
@RF00123 DS    0H                                                  0140 00177000
*       IVOLKY=NULCSN;              /* SET CSN               @Z40LB25*/ 00178000
         MVC   IVOLKY(12),NULCSN(NULCPTR)                          0140 00179000
*       CALL GETRECUD;              /* GET RECORD            @Z40LB25*/ 00180000
         BAL   @14,GETRECUD                                        0141 00181000
*       IF RPLVRETC^=OKZERO         /* ERROR?                @Z40LB25*/ 00182000
*         THEN                      /* YES                   @Z40LB25*/ 00183000
         LH    @09,RPLVRETC(,RPLVPTR)                              0142 00184000
         N     @09,@CF00613                                        0142 00185000
         LTR   @09,@09                                             0142 00186000
         BZ    @RF00142                                            0142 00187000
*         DO;                       /* CK ERROR              @Z40LB25*/ 00188000
*                                                                  0143 00189000
*           /*********************************************************/ 00190000
*           /*                                                       */ 00191000
*           /* NO RECORD FOUND IS OK.                        @Z40LB25*/ 00192000
*           /*                                                       */ 00193000
*           /*********************************************************/ 00194000
*                                                                  0144 00195000
*           IF RPLRCODE=NORECFND    /* NO RECD FND?          @Z40LB25*/ 00196000
*             THEN                  /* YES                   @Z40LB25*/ 00197000
         CLC   RPLRCODE(2,RPLVPTR),@CB00523                        0144 00198000
         BNE   @RF00144                                            0144 00199000
*             DO;                   /* OK                    @Z40LB25*/ 00200000
*               RPLRCODE=RPLRCODE&&RPLRCODE;/*               @Z40LB25   00201000
*                                      ZERO RESN CODE        @Z40LB25*/ 00202000
         XC    RPLRCODE(2,RPLVPTR),RPLRCODE(RPLVPTR)               0146 00203000
*               RPLVRETC=RPLVRETC&&RPLVRETC;/*               @Z40LB25   00204000
*                                      ZERO RETN CODE        @Z40LB25*/ 00205000
         XC    RPLVRETC(2,RPLVPTR),RPLVRETC(RPLVPTR)               0147 00206000
*             END;                  /*                       @Z40LB25*/ 00207000
*           RETURN;                 /*                       @Z40LB25*/ 00208000
         B     @EL00001                                            0149 00209000
*         END;                      /*                       @Z40LB25*/ 00210000
*     END;                          /*                       @Z40LB25*/ 00211000
@RF00142 DS    0H                                                  0152 00212000
*   BCDVPTR=BASEVPTR;               /* SET COMMON MAP        @Z40LB25   00213000
*                                      NEED FOR DELTCIRS     @Z40LB25*/ 00214000
*                                                                  0152 00215000
@RC00123 LR    BCDVPTR,BASEVPTR                                    0152 00216000
*   /*****************************************************************/ 00217000
*   /*                                                               */ 00218000
*   /* CHECK FOR AN ACTIVE BVR WITH NO COPIES.               @Z40LB25*/ 00219000
*   /*                                                               */ 00220000
*   /*****************************************************************/ 00221000
*                                                                  0153 00222000
*   IF BASINAC=OFF&BCDBASE=ON&BASNCOPY=ZEROCOPY/*            @Z40LB25*/ 00223000
*     THEN                          /*                       @Z40LB25*/ 00224000
         TM    BASINAC(BASEVPTR),B'00000100'                       0153 00225000
         BNZ   @RF00153                                            0153 00226000
         TM    BCDBASE(BCDVPTR),B'00100000'                        0153 00227000
         BNO   @RF00153                                            0153 00228000
         CLI   BASNCOPY(BASEVPTR),0                                0153 00229000
         BNE   @RF00153                                            0153 00230000
*     DO;                           /*                       @Z40LB25*/ 00231000
*       CALL ELMACTV;               /* ELIM ACT VOL          @Z40LB25*/ 00232000
         BAL   @14,ELMACTV                                         0155 00233000
*       RETURN;                     /*                       @Z40LB25*/ 00234000
         B     @EL00001                                            0156 00235000
*     END;                          /*                       @Z40LB25*/ 00236000
*                                                                  0157 00237000
*   /*****************************************************************/ 00238000
*   /*                                                               */ 00239000
*   /* CHECK FOR AN INACTIVE BVR WITH NO COPIES OR           @Z40LB25*/ 00240000
*   /* A CVR OR A DVR.                                       @Z40LB25*/ 00241000
*   /*                                                               */ 00242000
*   /*****************************************************************/ 00243000
*                                                                  0158 00244000
*   IF(BASINAC=ON&BCDBASE=ON&BASNCOPY=ZEROCOPY)|BCDDUP=ON|BCDCOPY=ON    00245000
*     THEN                          /*                       @Z40LB25*/ 00246000
@RF00153 TM    BASINAC(BASEVPTR),B'00000100'                       0158 00247000
         BNO   @GL00003                                            0158 00248000
         TM    BCDBASE(BCDVPTR),B'00100000'                        0158 00249000
         BNO   @GL00003                                            0158 00250000
         CLI   BASNCOPY(BASEVPTR),0                                0158 00251000
         BE    @RT00158                                            0158 00252000
@GL00003 TM    BCDDUP(BCDVPTR),B'00010100'                         0158 00253000
         BZ    @RF00158                                            0158 00254000
@RT00158 DS    0H                                                  0159 00255000
*     DO;                           /*                       @Z40LB25*/ 00256000
*       CALL ELINACV;               /* ELIM INACT VOL        @Z40LB25*/ 00257000
         BAL   @14,ELINACV                                         0160 00258000
*       RETURN;                     /*                       @Z40LB25*/ 00259000
         B     @EL00001                                            0161 00260000
*     END;                          /*                       @Z40LB25*/ 00261000
*                                                                  0162 00262000
*   /*****************************************************************/ 00263000
*   /*                                                               */ 00264000
*   /* THE BVR HAS CVR(S). IF THE BVR                        @Z40LB25*/ 00265000
*   /* WERE TO BE DELETED, THEN CVR(S) WILL                  @Z40LB25*/ 00266000
*   /* EXIST WHICH HAS NO BVR - A DESIGN VIOLATION.          @Z40LB25*/ 00267000
*   /* IF THE BVR IS ACTIVE, IT MUST BE MADE                 @Z40LB25*/ 00268000
*   /* INACTIVE. SET THE REASSIGNED FLAG IN                  @Z40LB25*/ 00269000
*   /* BVR ON AND WRITE THE BVR. ALSO, DELETE                @Z40LB25*/ 00270000
*   /* BVR'S CIRS.                                           @Z40LB25*/ 00271000
*   /*                                                               */ 00272000
*   /*****************************************************************/ 00273000
*                                                                  0163 00274000
*   CALL REASNBVR;                  /* CSNS REASSIGNED       @Z40LB25*/ 00275000
@RF00158 BAL   @14,REASNBVR                                        0163 00276000
*   RETURN;                         /*                       @Z40LB25*/ 00277000
         B     @EL00001                                            0164 00278000
*                                                                  0165 00279000
*   /*****************************************************************/ 00280000
*   /*                                                               */ 00281000
*   /* PROCEDURE NAME - ELMACTV                              @Z40LB25*/ 00282000
*   /*                                                       @Z40LB25*/ 00283000
*   /* FUNCTION -                                            @Z40LB25*/ 00284000
*   /* PROCESS THE ELIMINATION OF AN ACTIVE VOLUME.          @Z40LB25*/ 00285000
*   /* DELETE THE BVR AND ITS CIRS. IF THE BVR               @Z40LB25*/ 00286000
*   /* WAS GROUPED, ITS GROUP HEADER IS UPDATED.             @Z40LB25*/ 00287000
*   /* IF IT WAS GROUPED GENERAL-USE, ITS GROUP              @Z40LB25*/ 00288000
*   /* VOLUME SERIAL EXTENSION RECORD IS UPDATED.            @Z40LB25*/ 00289000
*   /* IF THE DELETED BVR HAS A DVR, THIS DVR IS             @Z40LB25*/ 00290000
*   /* MADE INTO A BVR TO REPLACE THE DELETED BVR.           @Z40LB25*/ 00291000
*   /*                                                       @Z40LB25*/ 00292000
*   /* INPUT -                                               @Z40LB25*/ 00293000
*   /* MSVC REQUEST PARAMETER LIST                           @Z40LB25*/ 00294000
*   /* BASE VOLUME RECORD                                    @Z40LB25*/ 00295000
*   /*                                                       @Z40LB25*/ 00296000
*   /* OUTPUT -                                              @Z40LB25*/ 00297000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Z40LB25*/ 00298000
*   /* AN ERROR                                              @Z40LB25*/ 00299000
*   /*                                                               */ 00300000
*   /*****************************************************************/ 00301000
*                                                                  0165 00302000
*ELMACTV:                           /*                       @Z40LB25*/ 00303000
*   PROC OPTIONS(SAVE(RG14));       /*                       @Z40LB25*/ 00304000
*                                                                  0165 00305000
ELMACTV  ST    @14,@SA00002                                        0165 00306000
*   /*****************************************************************/ 00307000
*   /*                                                               */ 00308000
*   /* DELETE THE BVR IN TEMPBUF                             @Z40LB25*/ 00309000
*   /*                                                               */ 00310000
*   /*****************************************************************/ 00311000
*                                                                  0166 00312000
*   RPLVTYP=RPLVDEL;                /* DELETE                @Z40LB25*/ 00313000
         MVI   RPLVTYP(RPLVPTR),X'05'                              0166 00314000
*   RESPECIFY                                                      0167 00315000
*     RG1 RSTD;                     /* RESTRICT REG 1        @Z40LB25*/ 00316000
*   RG1=RPLVPTR;                    /* RPLV PTR              @Z40LB25*/ 00317000
         LR    RG1,RPLVPTR                                         0168 00318000
*   CALL ICBVIO00;                  /* DELETE BVR OR CVR     @Z40LB25*/ 00319000
         L     @15,@CV00537                                        0169 00320000
         BALR  @14,@15                                             0169 00321000
*   RESPECIFY                                                      0170 00322000
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @Z40LB25*/ 00323000
*   IF RPLVRETC^=OKZERO             /* ERROR?                @Z40LB25*/ 00324000
*     THEN                          /* YES                   @Z40LB25*/ 00325000
         LH    @09,RPLVRETC(,RPLVPTR)                              0171 00326000
         N     @09,@CF00613                                        0171 00327000
         LTR   @09,@09                                             0171 00328000
         BNZ   @RT00171                                            0171 00329000
*     RETURN;                       /*                       @Z40LB25*/ 00330000
*                                                                  0172 00331000
*   /*****************************************************************/ 00332000
*   /*                                                               */ 00333000
*   /* DELETE THE CIRS.                                      @Z40LB25*/ 00334000
*   /*                                                               */ 00335000
*   /*****************************************************************/ 00336000
*                                                                  0173 00337000
*   CALL DELTCIRS;                  /* DELT CIRS             @Z40LB25*/ 00338000
*                                                                  0173 00339000
         BAL   @14,DELTCIRS                                        0173 00340000
*   /*****************************************************************/ 00341000
*   /*                                                               */ 00342000
*   /* CHECK IF GHR NEEDS PROCESSING.                        @Z40LB25*/ 00343000
*   /*                                                               */ 00344000
*   /*****************************************************************/ 00345000
*                                                                  0174 00346000
*   IF BASGRPV=ON                   /* BVR GROUPED?          @Z40LB25*/ 00347000
*     THEN                          /* YES                   @Z40LB25*/ 00348000
         TM    BASGRPV(BASEVPTR),B'00100000'                       0174 00349000
         BNO   @RF00174                                            0174 00350000
*     DO;                           /*                       @Z40LB25*/ 00351000
*                                                                  0175 00352000
*       /*************************************************************/ 00353000
*       /*                                                           */ 00354000
*       /* DECREMENT EITHER THE NUMBER OF GENERAL-USE        @Z40LB25*/ 00355000
*       /* OR THE NUMBER OF RESTRICTED VOLUMES KEPT IN       @Z40LB25*/ 00356000
*       /* THE GROUP HEADER RECORD. DECREMENT SPACE          @Z40LB25*/ 00357000
*       /* COUNT IN THE GROUP RECORD.                        @Z40LB25*/ 00358000
*       /*                                                           */ 00359000
*       /*************************************************************/ 00360000
*                                                                  0176 00361000
*       GROUPKY=BASGROUP;           /* SET GROUP NAME        @Z40LB25*/ 00362000
         MVC   GROUPKY(8),BASGROUP(BASEVPTR)                       0176 00363000
*       RPLVKEY=ADDR(GKEY);         /* SET KEY ADDR          @Z40LB25*/ 00364000
         LA    @09,GKEY                                            0177 00365000
         ST    @09,RPLVKEY(,RPLVPTR)                               0177 00366000
*       CALL READUPD1;              /* READ GHR              @Z40LB25*/ 00367000
         BAL   @14,READUPD1                                        0178 00368000
*       IF RPLVRETC^=OKZERO         /* ERROR?                @Z40LB25*/ 00369000
*         THEN                      /* YES                   @Z40LB25*/ 00370000
         LH    @09,RPLVRETC(,RPLVPTR)                              0179 00371000
         N     @09,@CF00613                                        0179 00372000
         LTR   @09,@09                                             0179 00373000
         BNZ   @RT00179                                            0179 00374000
*         RETURN;                   /*                       @Z40LB25*/ 00375000
*                                                                  0180 00376000
*       /*************************************************************/ 00377000
*       /*                                                           */ 00378000
*       /* DECREMENT TYPE OF VOLUME COUNT.                   @Z40LB25*/ 00379000
*       /*                                                           */ 00380000
*       /*************************************************************/ 00381000
*                                                                  0181 00382000
*       GROUPBUF=TEMPBUF;           /* USE CORRECT BUF       @Z40LB25*/ 00383000
         MVC   GROUPBUF(164),TEMPBUF                               0181 00384000
*       IF BASGENUS=ON              /* GENERAL-USE?          @Z40LB25*/ 00385000
*         THEN                      /* YES                   @Z40LB25*/ 00386000
         TM    BASGENUS(BASEVPTR),B'00010000'                      0182 00387000
         BNO   @RF00182                                            0182 00388000
*         DO;                       /*                       @Z40LB25*/ 00389000
*           GRONGEN=GRONGEN-DECONE; /* DEC # GEN-USE         @Z40LB25*/ 00390000
*                                                                  0184 00391000
         LH    @09,GRONGEN(,GROUPPTR)                              0184 00392000
         BCTR  @09,0                                               0184 00393000
         STH   @09,GRONGEN(,GROUPPTR)                              0184 00394000
*           /*********************************************************/ 00395000
*           /*                                                       */ 00396000
*           /* UPDATE THE GHR.                               @Z40LB25*/ 00397000
*           /*                                                       */ 00398000
*           /*********************************************************/ 00399000
*                                                                  0185 00400000
*           ADDSUBGR=OFF;           /* BVR DELETED           @Z40LB25*/ 00401000
         NI    ADDSUBGR,B'11110111'                                0185 00402000
*           CALL ICBVUPGH(PTRGROUP,PTRBASEV,PASSBYTE);/*     @Z40LB25   00403000
*                                      UPDATE GHR            @Z40LB25*/ 00404000
         L     @15,@CV00545                                        0186 00405000
         LA    @01,@AL00186                                        0186 00406000
         BALR  @14,@15                                             0186 00407000
*         END;                      /*                       @Z40LB25*/ 00408000
*       ELSE                        /* RESTRICTED            @Z40LB25*/ 00409000
*         IF BASRSTD=ON             /* RESTRICTED?           @Z40LB25*/ 00410000
*           THEN                    /* YES                   @Z40LB25*/ 00411000
         B     @RC00182                                            0188 00412000
@RF00182 TM    BASRSTD(BASEVPTR),B'00001000'                       0188 00413000
         BNO   @RF00188                                            0188 00414000
*           GRONRSTD=GRONRSTD-DECONE;/*                      @Z40LB25   00415000
*                                      DEC # RESTD VOLS      @Z40LB25*/ 00416000
         LH    @09,GRONRSTD(,GROUPPTR)                             0189 00417000
         BCTR  @09,0                                               0189 00418000
         STH   @09,GRONRSTD(,GROUPPTR)                             0189 00419000
*     END;                          /*                       @Z40LB25*/ 00420000
*                                                                  0190 00421000
@RF00188 DS    0H                                                  0190 00422000
@RC00182 DS    0H                                                  0191 00423000
*   /*****************************************************************/ 00424000
*   /*                                                               */ 00425000
*   /* PROCESS THE OTHER MSVI RECORDS ASSOCIATED             @Z40LB25*/ 00426000
*   /* WITH THIS BVR.                                        @Z40LB25*/ 00427000
*   /*                                                               */ 00428000
*   /*****************************************************************/ 00429000
*                                                                  0191 00430000
*   CALL PROCBVR;                   /* PROCESS BVR           @Z40LB25*/ 00431000
@RF00174 BAL   @14,PROCBVR                                         0191 00432000
*   RETURN;                         /*                       @Z40LB25*/ 00433000
@EL00002 DS    0H                                                  0192 00434000
@EF00002 DS    0H                                                  0192 00435000
@ER00002 L     @14,@SA00002                                        0192 00436000
         BR    @14                                                 0192 00437000
*   END ELMACTV;                    /*                       @Z40LB25*/ 00438000
         B     @EL00002                                            0193 00439000
*                                                                  0194 00440000
*   /*****************************************************************/ 00441000
*   /*                                                               */ 00442000
*   /* PROCEDURE NAME - ELINACV                              @Z40LB25*/ 00443000
*   /*                                                       @Z40LB25*/ 00444000
*   /* FUNCTION -                                            @Z40LB25*/ 00445000
*   /* PROCESS THE ELIMINATION OF AN INACTIVE VOLUME.        @Z40LB25*/ 00446000
*   /* DELETE THE BVR OR CVR OR DVR AND ITS CIRS.            @Z40LB25*/ 00447000
*   /* FOR A DELETED GROUPED BVR, UPDATE ITS GROUPED         @Z40LB25*/ 00448000
*   /* HEADER RECORD. FOR A DELETE NON-GROUPED BVR,          @Z40LB25*/ 00449000
*   /* UPDATE ITS NON-GROUPED HEADER RECORD. IF THE          @Z40LB25*/ 00450000
*   /* DELETED BVR HAS A DVR, MAKE THE DVR INTO A BVR        @Z40LB25*/ 00451000
*   /* FOR THE DELETED BVR. FOR A DELETED CVR, ITS           @Z40LB25*/ 00452000
*   /* BVR MUST BE UPDATED.                                  @Z40LB25*/ 00453000
*   /*                                                       @Z40LB25*/ 00454000
*   /* INPUT -                                               @Z40LB25*/ 00455000
*   /* MSVC REQUEST PARAMETER LIST                           @Z40LB25*/ 00456000
*   /* BASE OR COPY OR DUPLICATE VOLUME RECORD               @Z40LB25*/ 00457000
*   /*                                                       @Z40LB25*/ 00458000
*   /* OUTPUT -                                              @Z40LB25*/ 00459000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Z40LB25*/ 00460000
*   /* AN ERROR                                              @Z40LB25*/ 00461000
*   /*                                                               */ 00462000
*   /*****************************************************************/ 00463000
*                                                                  0194 00464000
*ELINACV:                           /*                       @Z40LB25*/ 00465000
*   PROC OPTIONS(SAVE(RG14));       /*                       @Z40LB25*/ 00466000
*                                                                  0194 00467000
ELINACV  ST    @14,@SA00003                                        0194 00468000
*   /*****************************************************************/ 00469000
*   /*                                                               */ 00470000
*   /* DELETE THE CVR OR BVR OR DVR IN TEMPBUF.              @Z40LB25*/ 00471000
*   /*                                                               */ 00472000
*   /*****************************************************************/ 00473000
*                                                                  0195 00474000
*   RPLVTYP=RPLVDEL;                /* DELETE                @Z40LB25*/ 00475000
         MVI   RPLVTYP(RPLVPTR),X'05'                              0195 00476000
*   RESPECIFY                                                      0196 00477000
*     RG1 RSTD;                     /* RESTRICT REG 1        @Z40LB25*/ 00478000
*   RG1=RPLVPTR;                    /* RPLV PTR              @Z40LB25*/ 00479000
         LR    RG1,RPLVPTR                                         0197 00480000
*   CALL ICBVIO00;                  /* DELETE BVR OR CVR     @Z40LB25*/ 00481000
         L     @15,@CV00537                                        0198 00482000
         BALR  @14,@15                                             0198 00483000
*   RESPECIFY                                                      0199 00484000
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @Z40LB25*/ 00485000
*   IF RPLVRETC^=OKZERO             /* ERROR?                @Z40LB25*/ 00486000
*     THEN                          /* YES                   @Z40LB25*/ 00487000
         LH    @09,RPLVRETC(,RPLVPTR)                              0200 00488000
         N     @09,@CF00613                                        0200 00489000
         LTR   @09,@09                                             0200 00490000
         BNZ   @RT00200                                            0200 00491000
*     RETURN;                       /*                       @Z40LB25*/ 00492000
*                                                                  0201 00493000
*   /*****************************************************************/ 00494000
*   /*                                                               */ 00495000
*   /* DELETE THEIR CIRS.                                    @Z40LB25*/ 00496000
*   /*                                                               */ 00497000
*   /*****************************************************************/ 00498000
*                                                                  0202 00499000
*   CALL DELTCIRS;                  /* DELT CIRS             @Z40LB25*/ 00500000
*                                                                  0202 00501000
         BAL   @14,DELTCIRS                                        0202 00502000
*   /*****************************************************************/ 00503000
*   /*                                                               */ 00504000
*   /* CHECK FOR A DVR.                                      @Z40LB25*/ 00505000
*   /*                                                               */ 00506000
*   /*****************************************************************/ 00507000
*                                                                  0203 00508000
*   IF BCDDUP=ON                    /* DVR?                  @Z40LB25*/ 00509000
*     THEN                          /* YES                   @Z40LB25*/ 00510000
         TM    BCDDUP(BCDVPTR),B'00000100'                         0203 00511000
         BO    @RT00203                                            0203 00512000
*     RETURN;                       /*                       @Z40LB25*/ 00513000
*                                                                  0204 00514000
*   /*****************************************************************/ 00515000
*   /*                                                               */ 00516000
*   /* CKECK FOR A BASE VOLUME RECORD.                       @Z40LB25*/ 00517000
*   /* UPDATE ITS GHR OR NGHR.                               @Z40LB25*/ 00518000
*   /*                                                               */ 00519000
*   /*****************************************************************/ 00520000
*                                                                  0205 00521000
*   IF BCDBASE=ON                   /* BVR?                  @Z40LB25*/ 00522000
*     THEN                          /* YES                   @Z40LB25*/ 00523000
         TM    BCDBASE(BCDVPTR),B'00100000'                        0205 00524000
         BNO   @RF00205                                            0205 00525000
*     DO;                           /*                       @Z40LB25*/ 00526000
*       IF BASGRPV=ON               /* GROUPED BVR?          @Z40LB25*/ 00527000
*         THEN                      /* YES                   @Z40LB25*/ 00528000
         TM    BASGRPV(BASEVPTR),B'00100000'                       0207 00529000
         BNO   @RF00207                                            0207 00530000
*         DO;                       /*                       @Z40LB25*/ 00531000
*           GROUPKY=BASGROUP;       /* SET GROUP NAME        @Z40LB25*/ 00532000
         MVC   GROUPKY(8),BASGROUP(BASEVPTR)                       0209 00533000
*           RPLVKEY=ADDR(GKEY);     /* SET KEY ADDR          @Z40LB25*/ 00534000
         LA    @09,GKEY                                            0210 00535000
         ST    @09,RPLVKEY(,RPLVPTR)                               0210 00536000
*           CALL READUPD1;          /* READ GHR              @Z40LB25*/ 00537000
         BAL   @14,READUPD1                                        0211 00538000
*           IF RPLVRETC^=OKZERO     /* ERROR?                @Z40LB25*/ 00539000
*             THEN                  /* YES                   @Z40LB25*/ 00540000
         LH    @09,RPLVRETC(,RPLVPTR)                              0212 00541000
         N     @09,@CF00613                                        0212 00542000
         LTR   @09,@09                                             0212 00543000
         BNZ   @RT00212                                            0212 00544000
*             RETURN;               /*                       @Z40LB25*/ 00545000
*           GROUPBUF=TEMPBUF;       /* USE CORRECT BUF       @Z40LB25*/ 00546000
         MVC   GROUPBUF(164),TEMPBUF                               0214 00547000
*           GRONINAC=GRONINAC-DECONE;/* DECREM INAC VOLS     @Z40LB25*/ 00548000
         LH    @09,GRONINAC(,GROUPPTR)                             0215 00549000
         BCTR  @09,0                                               0215 00550000
         STH   @09,GRONINAC(,GROUPPTR)                             0215 00551000
*         END;                      /*                       @Z40LB25*/ 00552000
*                                                                  0216 00553000
*       /*************************************************************/ 00554000
*       /*                                                           */ 00555000
*       /* PROCESS THE OTHER MSVI RECORDS ASSOCIATED         @Z40LB25*/ 00556000
*       /* WITH THIS BVR.                                    @Z40LB25*/ 00557000
*       /*                                                           */ 00558000
*       /*************************************************************/ 00559000
*                                                                  0217 00560000
*       CALL PROCBVR;               /* PROCESS THE BVR       @Z40LB25*/ 00561000
@RF00207 BAL   @14,PROCBVR                                         0217 00562000
*     END;                          /*                       @Z40LB25*/ 00563000
*                                                                  0218 00564000
*   /*****************************************************************/ 00565000
*   /*                                                               */ 00566000
*   /* CHECK FOR A DELETED COPY VOLUME RECORD                @Z40LB25*/ 00567000
*   /* IF PRESENT, THEN UPDATE THE CVR'S BVR TO REFLECT      @Z40LB25*/ 00568000
*   /* THE DELETION OF THE CVR.                              @Z40LB25*/ 00569000
*   /*                                                               */ 00570000
*   /*****************************************************************/ 00571000
*                                                                  0219 00572000
*   IF BCDCOPY=ON                   /* CVR?                  @Z40LB25*/ 00573000
*     THEN                          /* YES                   @Z40LB25*/ 00574000
@RF00205 TM    BCDCOPY(BCDVPTR),B'00010000'                        0219 00575000
         BNO   @RF00219                                            0219 00576000
*     DO;                           /*                       @Z40LB25*/ 00577000
*       COPYBUF=BASEBUF;            /* CVR TO CVR BUF        @Z40LB25*/ 00578000
         MVC   COPYBUF(164),BASEBUF                                0221 00579000
*       ADDSUB=OFF;                 /* DELETED CVR           @Z40LB25*/ 00580000
         NI    ADDSUB,B'10111111'                                  0222 00581000
*       CALL ICBVUBVR(PTRCOPYV,PTRRPLV,PASSBYTE);/*          @Z40LB25   00582000
*                                      UPDATE CVR'S BVR      @Z40LB25*/ 00583000
         L     @15,@CV00542                                        0223 00584000
         LA    @01,@AL00223                                        0223 00585000
         BALR  @14,@15                                             0223 00586000
*     END;                          /*                       @Z40LB25*/ 00587000
*   RETURN;                         /*                       @Z40LB25*/ 00588000
@EL00003 DS    0H                                                  0225 00589000
@EF00003 DS    0H                                                  0225 00590000
@ER00003 L     @14,@SA00003                                        0225 00591000
         BR    @14                                                 0225 00592000
*   END ELINACV;                    /*                       @Z40LB25*/ 00593000
         B     @EL00003                                            0226 00594000
*                                                                  0227 00595000
*   /*****************************************************************/ 00596000
*   /*                                                               */ 00597000
*   /* PROCEDURE NAME - REASNBVR                             @Z40LB25*/ 00598000
*   /*                                                       @Z40LB25*/ 00599000
*   /* FUNCTION -                                            @Z40LB25*/ 00600000
*   /* A BVR HAS CVR(S), THEREFORE IT CAN NOT BE DELETED.    @Z40LB25*/ 00601000
*   /* ITS CARTRIDGES WILL BE REASSIGNED, THEREFORE ITS      @Z40LB25*/ 00602000
*   /* CIRS MUST BE DELETED. THE BVR WILL BE KEPT, BUT       @Z40LB25*/ 00603000
*   /* IT WILL INDICATE CARTRIDGES ARE REASSIGNED AND        @Z40LB25*/ 00604000
*   /* BE INACTIVE.                                          @Z40LB25*/ 00605000
*   /*                                                       @Z40LB25*/ 00606000
*   /* INPUT -                                               @Z40LB25*/ 00607000
*   /* MSVC REQUEST PARAMETER LIST                           @Z40LB25*/ 00608000
*   /* BASE VOLUME RECORD                                    @Z40LB25*/ 00609000
*   /*                                                       @Z40LB25*/ 00610000
*   /* OUTPUT -                                              @Z40LB25*/ 00611000
*   /* BASE VOLUME RECORD                                    @Z40LB25*/ 00612000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Z40LB25*/ 00613000
*   /* AN ERROR                                              @Z40LB25*/ 00614000
*   /*                                                               */ 00615000
*   /*****************************************************************/ 00616000
*                                                                  0227 00617000
*REASNBVR:                          /*                       @Z40LB25*/ 00618000
*   PROC OPTIONS(SAVE(RG14));       /*                       @Z40LB25*/ 00619000
*                                                                  0227 00620000
REASNBVR ST    @14,@SA00004                                        0227 00621000
*   /*****************************************************************/ 00622000
*   /*                                                               */ 00623000
*   /* THE BVR MUST BE INACTIVE TO HAVE ITS CARTRIDGES       @Z40LB25*/ 00624000
*   /* REASSIGNED.                                           @Z40LB25*/ 00625000
*   /*                                                               */ 00626000
*   /*****************************************************************/ 00627000
*                                                                  0228 00628000
*   IF BASINAC=OFF                  /* ACTIVE?               @Z40LB25*/ 00629000
*     THEN                          /* YES                   @Z40LB25*/ 00630000
         TM    BASINAC(BASEVPTR),B'00000100'                       0228 00631000
         BNZ   @RF00228                                            0228 00632000
*     DO;                           /*                       @Z40LB25*/ 00633000
*       CALL DEACTV;                /* DACT VOL              @Z40LB25*/ 00634000
         BAL   @14,DEACTV                                          0230 00635000
*       IF RPLRCODE=IOERROR         /* I/O ERROR?            @Z40LB25*/ 00636000
*         THEN                      /* YES                   @Z40LB25*/ 00637000
         CLC   RPLRCODE(2,RPLVPTR),@CB00525                        0231 00638000
         BE    @RT00231                                            0231 00639000
*         RETURN;                   /*                       @Z40LB25*/ 00640000
*                                                                  0232 00641000
*       /*************************************************************/ 00642000
*       /*                                                           */ 00643000
*       /* SAVE THE RETURN/REASON IN CASE THE                @Z40LB25*/ 00644000
*       /* GHR OR GHSNER COULD NOT BE FOUND.                 @Z40LB25*/ 00645000
*       /*                                                           */ 00646000
*       /*************************************************************/ 00647000
*                                                                  0233 00648000
*       RETCODE=RPLVRETC;           /* SAVE RETN CODE        @Z40LB25*/ 00649000
         MVC   RETCODE(2),RPLVRETC(RPLVPTR)                        0233 00650000
*       REACODE=RPLRCODE;           /* SAVE RESN CODE        @Z40LB25*/ 00651000
*                                                                  0234 00652000
         MVC   REACODE(2),RPLRCODE(RPLVPTR)                        0234 00653000
*       /*************************************************************/ 00654000
*       /*                                                           */ 00655000
*       /* REESTABLISH BVR RPL.                              @Z40LB25*/ 00656000
*       /*                                                           */ 00657000
*       /*************************************************************/ 00658000
*                                                                  0235 00659000
*       BVOLKY=BASSERNO;            /* RESET VOLID           @Z40LB25*/ 00660000
         MVC   BVOLKY(6),BASSERNO(BASEVPTR)                        0235 00661000
*       RPLVKEY=ADDR(BKEY);         /* SET KEY ADDR          @Z40LB25*/ 00662000
         LA    @03,BKEY                                            0236 00663000
         ST    @03,RPLVKEY(,RPLVPTR)                               0236 00664000
*       CALL READUPD1;              /* READ BVR              @Z40LB25*/ 00665000
         BAL   @14,READUPD1                                        0237 00666000
*       IF RPLVRETC^=OKZERO         /* ERROR?                @Z40LB25*/ 00667000
*         THEN                      /* YES                   @Z40LB25*/ 00668000
         LH    @03,RPLVRETC(,RPLVPTR)                              0238 00669000
         N     @03,@CF00613                                        0238 00670000
         LTR   @03,@03                                             0238 00671000
         BNZ   @RT00238                                            0238 00672000
*         RETURN;                   /*                       @Z40LB25*/ 00673000
*     END;                          /*                       @Z40LB25*/ 00674000
*                                                                  0240 00675000
*   /*****************************************************************/ 00676000
*   /*                                                               */ 00677000
*   /* INDICATE THE CARTRIDGES ARE REASSIGNED AND            @Z40LB25*/ 00678000
*   /* NOT IN THE LIBRARY.                                   @Z40LB25*/ 00679000
*   /*                                                               */ 00680000
*   /*****************************************************************/ 00681000
*                                                                  0241 00682000
*   BASREASS=ON;                    /* REASSIGNED            @Z40LB25*/ 00683000
@RF00228 OI    BASREASS(BASEVPTR),B'00100000'                      0241 00684000
*   BASLIB1=NULLIB1F;               /* NULL LIB ID 1         @Z40LB25*/ 00685000
         MVI   BASLIB1(BASEVPTR),X'FF'                             0242 00686000
*   BASLIB2=NULLIB1F;               /* NULL LIB ID 2         @Z40LB25*/ 00687000
*                                                                  0243 00688000
         MVI   BASLIB2(BASEVPTR),X'FF'                             0243 00689000
*   /*****************************************************************/ 00690000
*   /*                                                               */ 00691000
*   /* WRITE THE BVR.                                        @Z40LB25*/ 00692000
*   /*                                                               */ 00693000
*   /*****************************************************************/ 00694000
*                                                                  0244 00695000
*   RPLVBUF=ADDR(BASEBUF);          /* BUFF ADDR             @Z40LB25*/ 00696000
         LA    @05,BASEBUF                                         0244 00697000
         ST    @05,RPLVBUF(,RPLVPTR)                               0244 00698000
*   CALL WRITRECD;                  /* WRITE BVR             @Z40LB25*/ 00699000
         BAL   @14,WRITRECD                                        0245 00700000
*   IF RPLVRETC^=OKZERO             /* ERROR?                @Z40LB25*/ 00701000
*     THEN                          /* YES                   @Z40LB25*/ 00702000
         LH    @05,RPLVRETC(,RPLVPTR)                              0246 00703000
         N     @05,@CF00613                                        0246 00704000
         LTR   @05,@05                                             0246 00705000
         BNZ   @RT00246                                            0246 00706000
*     RETURN;                       /*                       @Z40LB25*/ 00707000
*                                                                  0247 00708000
*   /*****************************************************************/ 00709000
*   /*                                                               */ 00710000
*   /* DELETE THE CIRS FOR THE BVR.                          @Z40LB25*/ 00711000
*   /* ZERO RETURN/REASON CODES ARE RETURNED.                @Z40LB25*/ 00712000
*   /*                                                               */ 00713000
*   /*****************************************************************/ 00714000
*                                                                  0248 00715000
*   CALL DELTCIRS;                  /* DELETE CIRS           @Z40LB25*/ 00716000
*                                                                  0248 00717000
         BAL   @14,DELTCIRS                                        0248 00718000
*   /*****************************************************************/ 00719000
*   /*                                                               */ 00720000
*   /* RESTORE RETURN/REASON CODES IN CASE DEACTV            @Z40LB25*/ 00721000
*   /* WAS CALLED. DEACTV NOT CALLED - RETCODE AND           @Z40LB25*/ 00722000
*   /* REACODE ARE ZEROED IN WORKAREA.                       @Z40LB25*/ 00723000
*   /*                                                               */ 00724000
*   /*****************************************************************/ 00725000
*                                                                  0249 00726000
*   RPLVRETC=RETCODE;               /* RESET RETN CODE       @Z40LB25*/ 00727000
         MVC   RPLVRETC(2,RPLVPTR),RETCODE                         0249 00728000
*   RPLRCODE=REACODE;               /* RESET RESN CODE       @Z40LB25*/ 00729000
         MVC   RPLRCODE(2,RPLVPTR),REACODE                         0250 00730000
*   RETURN;                         /*                       @Z40LB25*/ 00731000
@EL00004 DS    0H                                                  0251 00732000
@EF00004 DS    0H                                                  0251 00733000
@ER00004 L     @14,@SA00004                                        0251 00734000
         BR    @14                                                 0251 00735000
*   END REASNBVR;                   /*                       @Z40LB25*/ 00736000
         B     @EL00004                                            0252 00737000
*                                                                  0253 00738000
*   /*****************************************************************/ 00739000
*   /*                                                               */ 00740000
*   /* PROCEDURE NAME - DEACTV                               @Z40LB25*/ 00741000
*   /*                                                       @Z40LB25*/ 00742000
*   /* FUNCTION -                                            @Z40LB25*/ 00743000
*   /* PROCESS THE DEACTIVATION OF AN ACTIVE VOLUME.         @Z40LB25*/ 00744000
*   /* IF THE BVR IS GROUPED, UPDATE ITS GROUP HEADER        @Z40LB25*/ 00745000
*   /* RECORD. IF THE BVR IS GROUPED GENERAL-USE, UPDATE     @Z40LB25*/ 00746000
*   /* ITS GROUP VOLUME SERIAL EXTENSION RECORD.             @Z40LB25*/ 00747000
*   /*                                                       @Z40LB25*/ 00748000
*   /* INPUT -                                               @Z40LB25*/ 00749000
*   /* MSVC REQUEST PARAMETER LIST                           @Z40LB25*/ 00750000
*   /* BASE VOLUME RECORD                                    @Z40LB25*/ 00751000
*   /*                                                       @Z40LB25*/ 00752000
*   /* OUTPUT -                                              @Z40LB25*/ 00753000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Z40LB25*/ 00754000
*   /* AN ERROR                                              @Z40LB25*/ 00755000
*   /* BASE VOLUME RECORD                                    @Z40LB25*/ 00756000
*   /*                                                               */ 00757000
*   /*****************************************************************/ 00758000
*                                                                  0253 00759000
*DEACTV:                            /*                       @Z40LB25*/ 00760000
*   PROC OPTIONS(SAVE(RG14));       /*                       @Z40LB25*/ 00761000
*                                                                  0253 00762000
DEACTV   ST    @14,@SA00005                                        0253 00763000
*   /*****************************************************************/ 00764000
*   /*                                                               */ 00765000
*   /* MAKE BVR REFLECT INACTIVE VOLUME.                     @Z40LB25*/ 00766000
*   /*                                                               */ 00767000
*   /*****************************************************************/ 00768000
*                                                                  0254 00769000
*   BASINAC=ON;                     /* MAKE INACTIVE         @Z40LB25*/ 00770000
         OI    BASINAC(BASEVPTR),B'00000100'                       0254 00771000
*   BASEXPDT=NULEXP4F;              /* NULL EXPIR DATE       @Z40LB25*/ 00772000
*                                                                  0255 00773000
         MVC   BASEXPDT(4,BASEVPTR),@CB00521                       0255 00774000
*   /*****************************************************************/ 00775000
*   /*                                                               */ 00776000
*   /* CHECK IF VOLUME IS GROUPED.                           @Z40LB25*/ 00777000
*   /*                                                               */ 00778000
*   /*****************************************************************/ 00779000
*                                                                  0256 00780000
*   IF BASGRPV=ON                   /* GROUPED?              @Z40LB25*/ 00781000
*     THEN                          /* YES                   @Z40LB25*/ 00782000
         TM    BASGRPV(BASEVPTR),B'00100000'                       0256 00783000
         BNO   @RF00256                                            0256 00784000
*     DO;                           /*                       @Z40LB25*/ 00785000
*                                                                  0257 00786000
*       /*************************************************************/ 00787000
*       /*                                                           */ 00788000
*       /* GET AND UPDATE THE GROUP HEADER RECORD.           @Z40LB25*/ 00789000
*       /*                                                           */ 00790000
*       /*************************************************************/ 00791000
*                                                                  0258 00792000
*       GROUPKY=BASGROUP;           /* SET GROUP NAME        @Z40LB25*/ 00793000
         MVC   GROUPKY(8),BASGROUP(BASEVPTR)                       0258 00794000
*       RPLVKEY=ADDR(GKEY);         /* ADDR OF KEY           @Z40LB25*/ 00795000
         LA    @07,GKEY                                            0259 00796000
         ST    @07,RPLVKEY(,RPLVPTR)                               0259 00797000
*       CALL READUPD1;              /* READ GHR              @Z40LB25*/ 00798000
         BAL   @14,READUPD1                                        0260 00799000
*       IF RPLVRETC^=OKZERO         /* ERROR?                @Z40LB25*/ 00800000
*         THEN                      /* YES                   @Z40LB25*/ 00801000
         LH    @07,RPLVRETC(,RPLVPTR)                              0261 00802000
         N     @07,@CF00613                                        0261 00803000
         LTR   @07,@07                                             0261 00804000
         BNZ   @RT00261                                            0261 00805000
*         RETURN;                   /*                       @Z40LB25*/ 00806000
*       GROUPBUF=TEMPBUF;           /* USE CORRECT BUFF      @Z40LB25*/ 00807000
         MVC   GROUPBUF(164),TEMPBUF                               0263 00808000
*       GRONINAC=GRONINAC+INCONE;   /* INCR # INACT VOLS     @Z40LB25*/ 00809000
         LA    @07,1                                               0264 00810000
         AH    @07,GRONINAC(,GROUPPTR)                             0264 00811000
         STH   @07,GRONINAC(,GROUPPTR)                             0264 00812000
*       IF BASRSTD=ON               /* RESTRICTED?           @Z40LB25*/ 00813000
*         THEN                      /* YES                   @Z40LB25*/ 00814000
         TM    BASRSTD(BASEVPTR),B'00001000'                       0265 00815000
         BNO   @RF00265                                            0265 00816000
*         GRONRSTD=GRONRSTD-DECONE; /*                       @Z40LB25   00817000
*                                      DECR # RSTD VOLS      @Z40LB25*/ 00818000
         LH    @07,GRONRSTD(,GROUPPTR)                             0266 00819000
         BCTR  @07,0                                               0266 00820000
         STH   @07,GRONRSTD(,GROUPPTR)                             0266 00821000
*       ELSE                        /* CK GEN-USE            @Z40LB25*/ 00822000
*         IF BASGENUS=ON            /* GENERAL-USE?          @Z40LB25*/ 00823000
*           THEN                    /* YES                   @Z40LB25*/ 00824000
         B     @RC00265                                            0267 00825000
@RF00265 TM    BASGENUS(BASEVPTR),B'00010000'                      0267 00826000
         BNO   @RF00267                                            0267 00827000
*           DO;                     /*                       @Z40LB25*/ 00828000
*             GRONGEN=GRONGEN-DECONE;/*                      @Z40LB25   00829000
*                                      DECR # G-USE VOLS     @Z40LB25*/ 00830000
*                                                                  0269 00831000
         LH    @07,GRONGEN(,GROUPPTR)                              0269 00832000
         BCTR  @07,0                                               0269 00833000
         STH   @07,GRONGEN(,GROUPPTR)                              0269 00834000
*             /*******************************************************/ 00835000
*             /*                                                     */ 00836000
*             /* PROCESS GROUP HEADER RECORD.                @Z40LB25*/ 00837000
*             /*                                                     */ 00838000
*             /*******************************************************/ 00839000
*                                                                  0270 00840000
*             ADDSUBGR=OFF;         /* SUBTRACT              @Z40LB25*/ 00841000
         NI    ADDSUBGR,B'11110111'                                0270 00842000
*             CALL ICBVUPGH(PTRGROUP,PTRBASEV,PASSBYTE);/*   @Z40LB25   00843000
*                                      UPDATE THE GHR        @Z40LB25*/ 00844000
         L     @15,@CV00545                                        0271 00845000
         LA    @01,@AL00271                                        0271 00846000
         BALR  @14,@15                                             0271 00847000
*           END;                    /*                       @Z40LB25*/ 00848000
*                                                                  0272 00849000
*       /*************************************************************/ 00850000
*       /*                                                           */ 00851000
*       /* WRITE THE GHR.                                    @Z40LB25*/ 00852000
*       /*                                                           */ 00853000
*       /*************************************************************/ 00854000
*                                                                  0273 00855000
*       RPLVBUF=ADDR(GROUPBUF);     /* GHR BUF ADDR          @Z40LB25*/ 00856000
@RF00267 DS    0H                                                  0273 00857000
@RC00265 LA    @03,GROUPBUF                                        0273 00858000
         ST    @03,RPLVBUF(,RPLVPTR)                               0273 00859000
*       CALL WRITRECD;              /* WRITE GHR             @Z40LB25*/ 00860000
         BAL   @14,WRITRECD                                        0274 00861000
*       IF RPLVRETC^=OKZERO         /* ERROR?                @Z40LB25*/ 00862000
*         THEN                      /* YES                   @Z40LB25*/ 00863000
         LH    @03,RPLVRETC(,RPLVPTR)                              0275 00864000
         N     @03,@CF00613                                        0275 00865000
         LTR   @03,@03                                             0275 00866000
         BNZ   @RT00275                                            0275 00867000
*         RETURN;                   /*                       @Z40LB25*/ 00868000
*                                                                  0276 00869000
*       /*************************************************************/ 00870000
*       /*                                                           */ 00871000
*       /* CHECK FOR GENERAL-USE.                            @Z40LB25*/ 00872000
*       /*                                                           */ 00873000
*       /*************************************************************/ 00874000
*                                                                  0277 00875000
*       IF BASGENUS=ON              /* GENERAL-USE?          @Z40LB25*/ 00876000
*         THEN                      /* YES                   @Z40LB25*/ 00877000
*                                                                  0277 00878000
         TM    BASGENUS(BASEVPTR),B'00010000'                      0277 00879000
         BNO   @RF00277                                            0277 00880000
*         /***********************************************************/ 00881000
*         /*                                                         */ 00882000
*         /* DELETE A GROUP VOLUME SERIAL NUMBER             @Z40LB25*/ 00883000
*         /* EXTENSION SLOT.                                 @Z40LB25*/ 00884000
*         /*                                                         */ 00885000
*         /***********************************************************/ 00886000
*                                                                  0278 00887000
*         DO;                       /*                       @Z40LB25*/ 00888000
*           EXPSLOT=OFF;            /* NO EXPIR DATE         @Z40LB25*/ 00889000
         NI    EXPSLOT,B'01111111'                                 0279 00890000
*           ADDSUBSL=OFF;           /* DELETE                @Z40LB25*/ 00891000
         NI    ADDSUBSL,B'11111101'                                0280 00892000
*           CALL ICBVUEXT(PTRGROUP,PTRBASEV,PTRRPLV,PASSBYTE);/*   0281 00893000
*                                                            @Z40LB25   00894000
*                                      DELETE A SLOT         @Z40LB25*/ 00895000
         L     @15,@CV00541                                        0281 00896000
         LA    @01,@AL00281                                        0281 00897000
         BALR  @14,@15                                             0281 00898000
*         END;                      /*                       @Z40LB25*/ 00899000
*     END;                          /*                       @Z40LB25*/ 00900000
*   RETURN;                         /*                       @Z40LB25*/ 00901000
@EL00005 DS    0H                                                  0284 00902000
@EF00005 DS    0H                                                  0284 00903000
@ER00005 L     @14,@SA00005                                        0284 00904000
         BR    @14                                                 0284 00905000
*   END DEACTV;                     /*                       @Z40LB25*/ 00906000
         B     @EL00005                                            0285 00907000
*                                                                  0286 00908000
*   /*****************************************************************/ 00909000
*   /*                                                               */ 00910000
*   /* PROCEDURE NAME - DELTCIRS                             @Z40LB25*/ 00911000
*   /*                                                       @Z40LB25*/ 00912000
*   /* FUNCTION -                                            @Z40LB25*/ 00913000
*   /* ELIMINATE TWO CARTRIDGE INDEX RECORDS (CIR).          @Z40LB25*/ 00914000
*   /*                                                       @Z40LB25*/ 00915000
*   /* INPUT -                                               @Z40LB25*/ 00916000
*   /* BASE OR COPY OR DUPLICATE VOLUME RECORD               @Z40LB25*/ 00917000
*   /* POINTED TO BY BCDVPTR                                 @Z40LB25*/ 00918000
*   /*                                                       @Z40LB25*/ 00919000
*   /* OUTPUT -                                              @Z40LB25*/ 00920000
*   /* NONE                                                  @Z40LB25*/ 00921000
*   /*                                                               */ 00922000
*   /*****************************************************************/ 00923000
*                                                                  0286 00924000
*DELTCIRS:                          /*                       @Z40LB25*/ 00925000
*   PROC OPTIONS(SAVE(RG14));       /*                       @Z40LB25*/ 00926000
*                                                                  0286 00927000
DELTCIRS ST    @14,@SA00006                                        0286 00928000
*   /*****************************************************************/ 00929000
*   /*                                                               */ 00930000
*   /* DELETE THE CIR FOR CSN1.                              @Z40LB25*/ 00931000
*   /*                                                               */ 00932000
*   /*****************************************************************/ 00933000
*                                                                  0287 00934000
*   IVOLKY=BCDCSN1;                 /* SET CSN1 IN CIR       @Z40LB25*/ 00935000
         MVC   IVOLKY(12),BCDCSN1(BCDVPTR)                         0287 00936000
*   RPLVKEY=ADDR(IKEY);             /* SET CIR KEY ADDR      @Z40LB25*/ 00937000
         LA    @09,IKEY                                            0288 00938000
         ST    @09,RPLVKEY(,RPLVPTR)                               0288 00939000
*   RPLVBUF=ADDR(INDEXBUF);         /* SET BUF ADDR          @Z40LB25*/ 00940000
         LA    @09,INDEXBUF                                        0289 00941000
         ST    @09,RPLVBUF(,RPLVPTR)                               0289 00942000
*   RPLVBLN=LENGTH(INDEXBUF);       /* SET BUFF LENGTH       @Z40LB25*/ 00943000
         MVC   RPLVBLN(4,RPLVPTR),@CF00607                         0290 00944000
*   CALL DELTRECD;                  /* GET & DELETE CIR      @Z40LB25*/ 00945000
         BAL   @14,DELTRECD                                        0291 00946000
*   RPLVRETC=RPLVRETC&&RPLVRETC;    /* ALL OK -              @Z40LB25*/ 00947000
         XC    RPLVRETC(2,RPLVPTR),RPLVRETC(RPLVPTR)               0292 00948000
*   RPLRCODE=RPLRCODE&&RPLRCODE;    /* CONTINUE              @Z40LB25*/ 00949000
*                                                                  0293 00950000
         XC    RPLRCODE(2,RPLVPTR),RPLRCODE(RPLVPTR)               0293 00951000
*   /*****************************************************************/ 00952000
*   /*                                                               */ 00953000
*   /* DELETE THE CIR FOR CSN2.                              @Z40LB25*/ 00954000
*   /*                                                               */ 00955000
*   /*****************************************************************/ 00956000
*                                                                  0294 00957000
*   IVOLKY=BCDCSN2;                 /* SET CSN2 IN CIR       @Z40LB25*/ 00958000
         MVC   IVOLKY(12),BCDCSN2(BCDVPTR)                         0294 00959000
*   CALL DELTRECD;                  /* GET & DELETE CIR      @Z40LB25*/ 00960000
         BAL   @14,DELTRECD                                        0295 00961000
*   RPLVRETC=RPLVRETC&&RPLVRETC;    /* ALL OK -              @Z40LB25*/ 00962000
         XC    RPLVRETC(2,RPLVPTR),RPLVRETC(RPLVPTR)               0296 00963000
*   RPLRCODE=RPLRCODE&&RPLRCODE;    /* CONTINUE              @Z40LB25*/ 00964000
         XC    RPLRCODE(2,RPLVPTR),RPLRCODE(RPLVPTR)               0297 00965000
*   END DELTCIRS;                   /*                       @Z40LB25*/ 00966000
@EL00006 DS    0H                                                  0298 00967000
@EF00006 DS    0H                                                  0298 00968000
@ER00006 L     @14,@SA00006                                        0298 00969000
         BR    @14                                                 0298 00970000
*                                                                  0299 00971000
*   /*****************************************************************/ 00972000
*   /*                                                               */ 00973000
*   /* PROCEDURE NAME - HOUSKEEP                             @Z40LB25*/ 00974000
*   /*                                                       @Z40LB25*/ 00975000
*   /* FUNCTION-                                             @Z40LB25*/ 00976000
*   /* JOURNALS THE RPLV AND RESERVES .MSVI FOR PROCESSING   @Z40LB25*/ 00977000
*   /* AFTER THE MSC IS DONE.                                @Z40LB25*/ 00978000
*   /*                                                       @Z40LB25*/ 00979000
*   /* RESERVE/RELEASE RETURNS ZERO REASON/RETURN CODES.     @Z40LB25*/ 00980000
*   /* RPLV WILL BE JOURNALLED, BECAUSE CHECK FOR DISABLED   @Z40LB25*/ 00981000
*   /* WAS MADE BEFORE CALL TO THE MSC. THEREFORE,           @Z40LB25*/ 00982000
*   /* THIS INCOMPLETELY PROCESSED FUNCTION WILL BE ALLOWED  @Z40LB25*/ 00983000
*   /* TO COMPLETE EVEN IF THE JOURNAL HAS BEEN DISABLED     @Z40LB25*/ 00984000
*   /* SINCE THE LAST CHECK. THE JOURNAL ALWAYS HAS          @Z40LB25*/ 00985000
*   /* SPACE RESERVED FOR SUCH A SITUATION.                  @Z40LB25*/ 00986000
*   /* INPUT -                                               @Z40LB25*/ 00987000
*   /*                                                       @Z40LB25*/ 00988000
*   /* MSVC REQUEST PARAMETER LIST                           @Z40LB25*/ 00989000
*   /*                                                       @Z40LB25*/ 00990000
*   /* OUTPUT -                                              @Z40LB25*/ 00991000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Z40LB25*/ 00992000
*   /* AN ERROR                                              @Z40LB25*/ 00993000
*   /*                                                               */ 00994000
*   /*****************************************************************/ 00995000
*                                                                  0299 00996000
*HOUSKEEP:                          /*                       @Z40LB25*/ 00997000
*   PROC OPTIONS(SAVE(RG14));       /*                       @Z40LB25*/ 00998000
HOUSKEEP ST    @14,@SA00007                                        0299 00999000
*   RESPECIFY                       /*                       @Z40LB25*/ 01000000
*     RG0 RSTD;                     /* RESTRICT REG 0        @Z40LB25*/ 01001000
*   RESPECIFY                       /*                       @Z40LB25*/ 01002000
*     RG1 RSTD;                     /* RESTRICT REG 1        @Z40LB25*/ 01003000
*                                                                  0301 01004000
*   /*****************************************************************/ 01005000
*   /*                                                               */ 01006000
*   /* RESERVE THE JOURNAL.                                  @Z40LB25*/ 01007000
*   /*                                                               */ 01008000
*   /*****************************************************************/ 01009000
*                                                                  0302 01010000
*   RG0=RESEXVJL;                   /* RESERVE JRNL FLAG     @Z40LB25*/ 01011000
         LA    RG0,17                                              0302 01012000
*   RG1=RPLVPTR;                    /* RPLV PTR              @Z40LB25*/ 01013000
         LR    RG1,RPLVPTR                                         0303 01014000
*   CALL ICBVRR00;                  /* RESERVE JOURNNAL      @Z40LB25*/ 01015000
*                                                                  0304 01016000
         L     @15,@CV00538                                        0304 01017000
         BALR  @14,@15                                             0304 01018000
*   /*****************************************************************/ 01019000
*   /*                                                               */ 01020000
*   /* JOURNAL THE RPLV.                                     @Z40LB25*/ 01021000
*   /*                                                               */ 01022000
*   /*****************************************************************/ 01023000
*                                                                  0305 01024000
*   RG1=RPLVPTR;                    /* RPLV PTR              @Z40LB25*/ 01025000
         LR    RG1,RPLVPTR                                         0305 01026000
*   CALL ICBVJL00;                  /* JRNL THE RPLV         @Z40LB25*/ 01027000
*                                                                  0306 01028000
         L     @15,@CV00539                                        0306 01029000
         BALR  @14,@15                                             0306 01030000
*   /*****************************************************************/ 01031000
*   /*                                                               */ 01032000
*   /* RELEASE THE JOURNAL.                                  @Z40LB25*/ 01033000
*   /*                                                               */ 01034000
*   /*****************************************************************/ 01035000
*                                                                  0307 01036000
*   RG0=DEQJRNL;                    /* RELEASE JRNL FLAG     @Z40LB25*/ 01037000
         LA    RG0,16                                              0307 01038000
*   RG1=RPLVPTR;                    /* RPLV PTR              @Z40LB25*/ 01039000
         LR    RG1,RPLVPTR                                         0308 01040000
*   CALL ICBVRR00;                  /* RELEASE JOURNAL       @Z40LB25*/ 01041000
         L     @15,@CV00538                                        0309 01042000
         BALR  @14,@15                                             0309 01043000
*   RPLVFLG=ON;                     /* RPLV IS JRNLED        @Z40LB25*/ 01044000
*                                                                  0310 01045000
         OI    RPLVFLG,B'00000001'                                 0310 01046000
*   /*****************************************************************/ 01047000
*   /*                                                               */ 01048000
*   /* RESERVE .MSVI.                                        @Z40LB25*/ 01049000
*   /*                                                               */ 01050000
*   /*****************************************************************/ 01051000
*                                                                  0311 01052000
*   RG0=RESEXINV;                   /* RESERVE .MSVI FLAG    @Z40LB25*/ 01053000
         LA    RG0,1                                               0311 01054000
*   RG1=RPLVPTR;                    /* RPLV PTR              @Z40LB25*/ 01055000
         LR    RG1,RPLVPTR                                         0312 01056000
*   CALL ICBVRR00;                  /* RESERVE .MSVI         @Z40LB25*/ 01057000
         L     @15,@CV00538                                        0313 01058000
         BALR  @14,@15                                             0313 01059000
*   RESPECIFY                       /*                       @Z40LB25*/ 01060000
*     RG0 UNRSTD;                   /* UNRESTRICT REG 0      @Z40LB25*/ 01061000
*   RESPECIFY                       /*                       @Z40LB25*/ 01062000
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @Z40LB25*/ 01063000
*   RETURN;                         /*                       @Z40LB25*/ 01064000
@EL00007 DS    0H                                                  0316 01065000
@EF00007 DS    0H                                                  0316 01066000
@ER00007 L     @14,@SA00007                                        0316 01067000
         BR    @14                                                 0316 01068000
*   END HOUSKEEP;                   /*                       @Z40LB25*/ 01069000
*                                                                  0318 01070000
*   /*****************************************************************/ 01071000
*   /*                                                               */ 01072000
*   /* PROCEDURE NAME - GETRECUD                             @Z40LB25*/ 01073000
*   /*                                                       @Z40LB25*/ 01074000
*   /* FUNCTION - READ A CIR IN THE LOCATE MODE USING        @Z40LB25*/ 01075000
*   /* THE INPUT CSN, GET THE MSVI RECORD FOR UPDATE         @Z40LB25*/ 01076000
*   /* FROM ITS KEY IN THE CIR.                              @Z40LB25*/ 01077000
*   /*                                                       @Z40LB25*/ 01078000
*   /* INPUT -                                               @Z40LB25*/ 01079000
*   /* MSVC REQUEST PARAMETER LIST                           @Z40LB25*/ 01080000
*   /* IKEY - CIR KEY                                        @Z40LB25*/ 01081000
*   /*                                                       @Z40LB25*/ 01082000
*   /* OUTPUT -                                              @Z40LB25*/ 01083000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Z40LB25*/ 01084000
*   /* AN ERROR                                              @Z40LB25*/ 01085000
*   /* BASE, COPY, OR DUPLICATE VOLUME RECORD                @Z40LB25*/ 01086000
*   /*                                                               */ 01087000
*   /*****************************************************************/ 01088000
*                                                                  0318 01089000
*GETRECUD:                          /*                       @Z40LB25*/ 01090000
*   PROC OPTIONS(SAVE(RG14));       /*                       @Z40LB25*/ 01091000
GETRECUD ST    @14,@SA00008                                        0318 01092000
*   RPLVKEY=ADDR(IKEY);             /* ADDR OF KEY           @Z40LB25*/ 01093000
         LA    @09,IKEY                                            0319 01094000
         ST    @09,RPLVKEY(,RPLVPTR)                               0319 01095000
*   RPLVTYP=RPLVREAD;               /* READ                  @Z40LB25*/ 01096000
         MVI   RPLVTYP(RPLVPTR),X'00'                              0320 01097000
*   RPLVDIR=ON;                     /* DIRECT                @Z40LB25*/ 01098000
*   RPLVLOC=ON;                     /* LOCATE                @Z40LB25*/ 01099000
         OI    RPLVDIR(RPLVPTR),B'11000000'                        0322 01100000
*   RPLVUPD=OFF;                    /* NO UPDATE             @Z40LB25*/ 01101000
         NI    RPLVUPD(RPLVPTR),B'11111101'                        0323 01102000
*   RESPECIFY                       /*                       @Z40LB25*/ 01103000
*     RG1 RSTD;                     /* RESTRICT REG 1        @Z40LB25*/ 01104000
*   RG1=RPLVPTR;                    /* SET RPLV PTR          @Z40LB25*/ 01105000
         LR    RG1,RPLVPTR                                         0325 01106000
*   CALL ICBVIO00;                  /* READ CIR              @Z40LB25*/ 01107000
         L     @15,@CV00537                                        0326 01108000
         BALR  @14,@15                                             0326 01109000
*   IF RPLVRETC^=OKZERO             /* ERROR                 @Z40LB25*/ 01110000
*     THEN                          /* YES                   @Z40LB25*/ 01111000
         LH    @09,RPLVRETC(,RPLVPTR)                              0327 01112000
         N     @09,@CF00613                                        0327 01113000
         LTR   @09,@09                                             0327 01114000
         BNZ   @RT00327                                            0327 01115000
*     RETURN;                       /*                       @Z40LB25*/ 01116000
*   INDEXPTR=RPLVBUF;               /* SET MAPPING           @Z40LB25*/ 01117000
         L     INDEXPTR,RPLVBUF(,RPLVPTR)                          0329 01118000
*   BCDKEY=INDRECKY;                /* SET KEY               @Z40LB25*/ 01119000
         MVC   BCDKEY(13),INDRECKY(INDEXPTR)                       0330 01120000
*   RPLVKEY=ADDR(BCDKEY);           /* SET KEY ADDR          @Z40LB25*/ 01121000
         LA    @09,BCDKEY                                          0331 01122000
         ST    @09,RPLVKEY(,RPLVPTR)                               0331 01123000
*   RPLVLOC=OFF;                    /* NO LOCATE             @Z40LB25*/ 01124000
         NI    RPLVLOC(RPLVPTR),B'01111111'                        0332 01125000
*   RPLVUPD=ON;                     /* UPDATE                @Z40LB25*/ 01126000
         OI    RPLVUPD(RPLVPTR),B'00000010'                        0333 01127000
*   RPLVBUF=ADDR(BASEBUF);          /* BUF ADDR              @Z40LB25*/ 01128000
         LA    @09,BASEBUF                                         0334 01129000
         ST    @09,RPLVBUF(,RPLVPTR)                               0334 01130000
*   RPLVBLN=LENGTH(BASEBUF);        /* BUFF LENGTH           @Z40LB25*/ 01131000
         MVC   RPLVBLN(4,RPLVPTR),@CF00608                         0335 01132000
*   RG1=RPLVPTR;                    /* SET RPLV PTR          @Z40LB25*/ 01133000
         LR    RG1,RPLVPTR                                         0336 01134000
*   CALL ICBVIO00;                  /* READ RECORD           @Z40LB25*/ 01135000
         L     @15,@CV00537                                        0337 01136000
         BALR  @14,@15                                             0337 01137000
*   RESPECIFY                       /*                       @Z40LB25*/ 01138000
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @Z40LB25*/ 01139000
*   RETURN;                         /*                       @Z40LB25*/ 01140000
@EL00008 DS    0H                                                  0339 01141000
@EF00008 DS    0H                                                  0339 01142000
@ER00008 L     @14,@SA00008                                        0339 01143000
         BR    @14                                                 0339 01144000
*   END GETRECUD;                   /*                       @Z40LB25*/ 01145000
         B     @EL00008                                            0340 01146000
*                                                                  0341 01147000
*   /*****************************************************************/ 01148000
*   /*                                                               */ 01149000
*   /* PROCEDURE NAME - DELTRECD                             @Z40LB25*/ 01150000
*   /*                                                       @Z40LB25*/ 01151000
*   /* FUNCTION - READ AND DELETE AN MSVI RECORD.            @Z40LB25*/ 01152000
*   /*                                                       @Z40LB25*/ 01153000
*   /* INPUT -                                               @Z40LB25*/ 01154000
*   /* MSVC REQUEST PARAMETER LIST                           @Z40LB25*/ 01155000
*   /* KEY OF RECORD IN RPLVKEY                              @Z40LB25*/ 01156000
*   /* ADDRESS OF RECORD BUFFER IN RPLVBUF                   @Z40LB25*/ 01157000
*   /* LENGTH OF BUFFER IN RPLVBLN                           @Z40LB25*/ 01158000
*   /*                                                       @Z40LB25*/ 01159000
*   /* OUTPUT -                                              @Z40LB25*/ 01160000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Z40LB25*/ 01161000
*   /* AN ERROR                                              @Z40LB25*/ 01162000
*   /*                                                               */ 01163000
*   /*****************************************************************/ 01164000
*                                                                  0341 01165000
*DELTRECD:                          /*                       @Z40LB25*/ 01166000
*   PROC OPTIONS(SAVE(RG14));       /*                       @Z40LB25*/ 01167000
DELTRECD ST    @14,@SA00009                                        0341 01168000
*   RPLVTYP=RPLVREAD;               /* READ                  @Z40LB25*/ 01169000
         MVI   RPLVTYP(RPLVPTR),X'00'                              0342 01170000
*   RPLVLOC=OFF;                    /* NO LOCATE             @Z40LB25*/ 01171000
         NI    RPLVLOC(RPLVPTR),B'01111111'                        0343 01172000
*   RPLVUPD=ON;                     /* UPDATE                @Z40LB25*/ 01173000
         OI    RPLVUPD(RPLVPTR),B'00000010'                        0344 01174000
*   RPLVDIR=ON;                     /* DIRECT                @Z40LB25*/ 01175000
         OI    RPLVDIR(RPLVPTR),B'01000000'                        0345 01176000
*   RESPECIFY                       /*                       @Z40LB25*/ 01177000
*     RG1 RSTD;                     /* RESTRICT REG 1        @Z40LB25*/ 01178000
*   RG1=RPLVPTR;                    /* RPLV PTR              @Z40LB25*/ 01179000
         LR    RG1,RPLVPTR                                         0347 01180000
*   CALL ICBVIO00;                  /* READ MSVI RECORD      @Z40LB25*/ 01181000
         L     @15,@CV00537                                        0348 01182000
         BALR  @14,@15                                             0348 01183000
*   IF RPLVRETC^=OKZERO             /* ERROR?                @Z40LB25*/ 01184000
*     THEN                          /* YES                   @Z40LB25*/ 01185000
         LH    @09,RPLVRETC(,RPLVPTR)                              0349 01186000
         N     @09,@CF00613                                        0349 01187000
         LTR   @09,@09                                             0349 01188000
         BNZ   @RT00349                                            0349 01189000
*     RETURN;                       /*                       @Z40LB25*/ 01190000
*   RPLVTYP=RPLVDEL;                /* DELETE                @Z40LB25*/ 01191000
         MVI   RPLVTYP(RPLVPTR),X'05'                              0351 01192000
*   RG1=RPLVPTR;                    /* RPLV PTR              @Z40LB25*/ 01193000
         LR    RG1,RPLVPTR                                         0352 01194000
*   CALL ICBVIO00;                  /* DELETE MSVI RECORD    @Z40LB25*/ 01195000
         L     @15,@CV00537                                        0353 01196000
         BALR  @14,@15                                             0353 01197000
*   RESPECIFY                       /*                       @Z40LB25*/ 01198000
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @Z40LB25*/ 01199000
*   RETURN;                         /*                       @Z40LB25*/ 01200000
@EL00009 DS    0H                                                  0355 01201000
@EF00009 DS    0H                                                  0355 01202000
@ER00009 L     @14,@SA00009                                        0355 01203000
         BR    @14                                                 0355 01204000
*   END DELTRECD;                   /*                       @Z40LB25*/ 01205000
         B     @EL00009                                            0356 01206000
*                                                                  0357 01207000
*   /*****************************************************************/ 01208000
*   /*                                                               */ 01209000
*   /* PROCEDURE NAME - READUPD1                             @Z40LB25*/ 01210000
*   /*                                                       @Z40LB25*/ 01211000
*   /* FUNCTION -                                            @Z40LB25*/ 01212000
*   /* READ AN MSVI RECORD FOR UPDATE INTO BASEBUF1          @Z40LB25*/ 01213000
*   /*                                                       @Z40LB25*/ 01214000
*   /* INPUT -                                               @Z40LB25*/ 01215000
*   /* MSVC REQUEST PARAMETER LIST                           @Z40LB25*/ 01216000
*   /* ADDRESS OF KEY TO READ IN RPLVKEY                     @Z40LB25*/ 01217000
*   /*                                                       @Z40LB25*/ 01218000
*   /* OUTPUT -                                              @Z40LB25*/ 01219000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Z40LB25*/ 01220000
*   /* AN ERROR                                              @Z40LB25*/ 01221000
*   /* MSVI RECORD                                           @Z40LB25*/ 01222000
*   /*                                                               */ 01223000
*   /*****************************************************************/ 01224000
*                                                                  0357 01225000
*READUPD1:                          /*                       @Z40LB25*/ 01226000
*   PROC OPTIONS(SAVE(RG14));       /*                       @Z40LB25*/ 01227000
READUPD1 ST    @14,@SA00010                                        0357 01228000
*   RPLVBUF=ADDR(TEMPBUF);          /* ADDR OF BUF           @Z40LB25*/ 01229000
         LA    @09,TEMPBUF                                         0358 01230000
         ST    @09,RPLVBUF(,RPLVPTR)                               0358 01231000
*   RPLVBLN=LENGTH(TEMPBUF);        /* BVR BUF LENGTH        @Z40LB25*/ 01232000
         MVC   RPLVBLN(4,RPLVPTR),@CF00608                         0359 01233000
*   RPLVTYP=RPLVREAD;               /* READ                  @Z40LB25*/ 01234000
         MVI   RPLVTYP(RPLVPTR),X'00'                              0360 01235000
*   RPLVDIR=ON;                     /* DIRECT                @Z40LB25*/ 01236000
         OI    RPLVDIR(RPLVPTR),B'01000000'                        0361 01237000
*   RPLVUPD=ON;                     /* UPDATE                @Z40LB25*/ 01238000
         OI    RPLVUPD(RPLVPTR),B'00000010'                        0362 01239000
*   RPLVLOC=OFF;                    /* NO LOCATE             @Z40LB25*/ 01240000
         NI    RPLVLOC(RPLVPTR),B'01111111'                        0363 01241000
*   RESPECIFY                       /*                       @Z40LB25*/ 01242000
*     RG1 RSTD;                     /* RESTRICT REG 1        @Z40LB25*/ 01243000
*   RG1=RPLVPTR;                    /* SET RPLV PTR          @Z40LB25*/ 01244000
         LR    RG1,RPLVPTR                                         0365 01245000
*   CALL ICBVIO00;                  /* READ BVR              @Z40LB25*/ 01246000
         L     @15,@CV00537                                        0366 01247000
         BALR  @14,@15                                             0366 01248000
*   RESPECIFY                       /*                       @Z40LB25*/ 01249000
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @Z40LB25*/ 01250000
*   RETURN;                         /*                       @Z40LB25*/ 01251000
@EL00010 DS    0H                                                  0368 01252000
@EF00010 DS    0H                                                  0368 01253000
@ER00010 L     @14,@SA00010                                        0368 01254000
         BR    @14                                                 0368 01255000
*   END READUPD1;                   /*                       @Z40LB25*/ 01256000
*                                                                  0370 01257000
*   /*****************************************************************/ 01258000
*   /*                                                               */ 01259000
*   /* PROCEDURE NAME - WRITRECD                             @Z40LB25*/ 01260000
*   /*                                                       @Z40LB25*/ 01261000
*   /* FUNCTION - WRITE AN MSVI RECORD.                      @Z40LB25*/ 01262000
*   /*                                                       @Z40LB25*/ 01263000
*   /* INPUT -                                               @Z40LB25*/ 01264000
*   /* MSVC REQUEST PARAMETER LIST                           @Z40LB25*/ 01265000
*   /* MSVI RECORD                                           @Z40LB25*/ 01266000
*   /*                                                       @Z40LB25*/ 01267000
*   /* OUTPUT -                                              @Z40LB25*/ 01268000
*   /* MSVC REQUEST PARAMETER - RETURN CODE IF               @Z40LB25*/ 01269000
*   /* AN ERROR                                              @Z40LB25*/ 01270000
*   /*                                                               */ 01271000
*   /*****************************************************************/ 01272000
*                                                                  0370 01273000
*WRITRECD:                          /*                       @Z40LB25*/ 01274000
*   PROC OPTIONS(SAVE(RG14));       /*                       @Z40LB25*/ 01275000
WRITRECD ST    @14,@SA00011                                        0370 01276000
*   RPLVTYP=RPLVPUT;                /* WRITE                 @Z40LB25*/ 01277000
         MVI   RPLVTYP(RPLVPTR),X'01'                              0371 01278000
*   RPLVLOC=OFF;                    /* NO LOC                @Z40LB25*/ 01279000
         NI    RPLVLOC(RPLVPTR),B'01111111'                        0372 01280000
*   RESPECIFY                       /*                       @Z40LB25*/ 01281000
*     RG1 RSTD;                     /* RESTRICT REG 1        @Z40LB25*/ 01282000
*   RG1=RPLVPTR;                    /* SET RPLV PTR          @Z40LB25*/ 01283000
         LR    RG1,RPLVPTR                                         0374 01284000
*   CALL ICBVIO00;                  /* WRITE BVR             @Z40LB25*/ 01285000
         L     @15,@CV00537                                        0375 01286000
         BALR  @14,@15                                             0375 01287000
*   RESPECIFY                       /*                       @Z40LB25*/ 01288000
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @Z40LB25*/ 01289000
*   RETURN;                         /*                       @Z40LB25*/ 01290000
@EL00011 DS    0H                                                  0377 01291000
@EF00011 DS    0H                                                  0377 01292000
@ER00011 L     @14,@SA00011                                        0377 01293000
         BR    @14                                                 0377 01294000
*   END WRITRECD;                   /*                       @Z40LB25*/ 01295000
*                                                                  0379 01296000
*   /*****************************************************************/ 01297000
*   /*                                                               */ 01298000
*   /* PROCEDURE NAME - PROCBVR                              @Z40LB25*/ 01299000
*   /*                                                       @Z40LB25*/ 01300000
*   /* FUNCTION - THE INPUT BVR HAS ALREADY BEEN DELETED.    @Z40LB25*/ 01301000
*   /* IF THE BVR IS GROUPED, GET THE GHR, UPDATE IT, CHAIN  @Z40LB25*/ 01302000
*   /* THE BVR OUT OF THE GHR, AND WRITE THE GHR.            @Z40LB25*/ 01303000
*   /* IF THE BVR WAS GROUPED, ACTIVE AND GENERAL-USE        @Z40LB25*/ 01304000
*   /* DELETE ITS GROUP VOLUME SERIAL NUMBER EXTENSION       @Z40LB25*/ 01305000
*   /* SLOT. LOCATE A DVR FOR THE BVR, IF ANY, AND MAKE      @Z40LB25*/ 01306000
*   /* IT THE BVR. IF NO DVR IS FOUND, THEN DELETE THE       @Z40LB25*/ 01307000
*   /* BVR FROM THE NGHR CHAIN OF BVRS, IF THE BVR           @Z40LB25*/ 01308000
*   /* IS NON-GROUPED.                                       @Z40LB25*/ 01309000
*   /*                                                       @Z40LB25*/ 01310000
*   /* INPUT -                                               @Z40LB25*/ 01311000
*   /* MSVC REQUEST PARAMETER LIST                           @Z40LB25*/ 01312000
*   /* BASE VOLUME RECORD                                    @Z40LB25*/ 01313000
*   /*                                                       @Z40LB25*/ 01314000
*   /* OUTPUT -                                              @Z40LB25*/ 01315000
*   /* MSVC REQUEST PARAMETER LIST                           @Z40LB25*/ 01316000
*   /* BASE VOLUME RECORD                                    @Z40LB25*/ 01317000
*   /* GROUP HEADER RECORD                                   @Z40LB25*/ 01318000
*   /* NON-GROUP HEADER RECORD                               @Z40LB25*/ 01319000
*   /*                                                               */ 01320000
*   /*****************************************************************/ 01321000
*                                                                  0379 01322000
*PROCBVR:                           /*                       @Z40LB25*/ 01323000
*   PROC OPTIONS(SAVE(RG14));       /*                       @Z40LB25*/ 01324000
*                                                                  0379 01325000
PROCBVR  ST    @14,@SA00012                                        0379 01326000
*   /*****************************************************************/ 01327000
*   /*                                                               */ 01328000
*   /* CHECK FOR A GROUPED BVR.                              @Z40LB25*/ 01329000
*   /*                                                               */ 01330000
*   /*****************************************************************/ 01331000
*                                                                  0380 01332000
*   IF BASGRPV=ON                   /* GROUPED?              @Z40LB25*/ 01333000
*     THEN                          /* YES                   @Z40LB25*/ 01334000
         TM    BASGRPV(BASEVPTR),B'00100000'                       0380 01335000
         BNO   @RF00380                                            0380 01336000
*     DO;                           /*                       @Z40LB25*/ 01337000
*                                                                  0381 01338000
*       /*************************************************************/ 01339000
*       /*                                                           */ 01340000
*       /* UPDATE THE GROUP HEADER RECORD.                   @Z40LB25*/ 01341000
*       /* THE CALLING ROUTINE HAS READ THE GHR FOR UPDATE.  @Z40LB25*/ 01342000
*       /* CHAIN THE BVR OUT OF THE GHR.                     @Z40LB25*/ 01343000
*       /*                                                           */ 01344000
*       /*************************************************************/ 01345000
*                                                                  0382 01346000
*       GRPFLG=ON;                  /* SET GROUP FLAG        @Z40LB25*/ 01347000
         OI    GRPFLG,B'00010000'                                  0382 01348000
*       CALL ICBVUCHO(PTRGROUP,PTRBASEV,PTRRPLV,PASSBYTE);/* @Z40LB25   01349000
*                                      CHAIN BVR OUT GHR     @Z40LB25*/ 01350000
         L     @15,@CV00543                                        0383 01351000
         LA    @01,@AL00383                                        0383 01352000
         BALR  @14,@15                                             0383 01353000
*       IF RPLVRETC^=OKZERO         /* CHECK RETURN CODE     @Z40LB25*/ 01354000
*         THEN                      /* ERROR                 @Z40LB25*/ 01355000
         LH    @09,RPLVRETC(,RPLVPTR)                              0384 01356000
         N     @09,@CF00613                                        0384 01357000
         LTR   @09,@09                                             0384 01358000
         BNZ   @RT00384                                            0384 01359000
*         RETURN;                   /*                       @Z40LB25*/ 01360000
*                                                                  0385 01361000
*       /*************************************************************/ 01362000
*       /*                                                           */ 01363000
*       /* REESTABLISH RPLV FOR WRITING THE GHR              @Z40LB25*/ 01364000
*       /*                                                           */ 01365000
*       /*************************************************************/ 01366000
*                                                                  0386 01367000
*       GROUPKY=BASGROUP;           /* SET THE KEY           @Z40LB25*/ 01368000
         MVC   GROUPKY(8),BASGROUP(BASEVPTR)                       0386 01369000
*       RPLVKEY=ADDR(GKEY);         /* PTR TO KEY            @Z40LB25*/ 01370000
         LA    @09,GKEY                                            0387 01371000
         ST    @09,RPLVKEY(,RPLVPTR)                               0387 01372000
*       CALL READUPD1;              /* GET GHR               @Z40LB25*/ 01373000
         BAL   @14,READUPD1                                        0388 01374000
*       IF RPLVRETC^=OKZERO         /* CHECK RETURN CODE     @Z40LB25*/ 01375000
*         THEN                      /* ERROR                 @Z40LB25*/ 01376000
         LH    @09,RPLVRETC(,RPLVPTR)                              0389 01377000
         N     @09,@CF00613                                        0389 01378000
         LTR   @09,@09                                             0389 01379000
         BNZ   @RT00389                                            0389 01380000
*         RETURN;                   /*                       @Z40LB25*/ 01381000
*                                                                  0390 01382000
*       /*************************************************************/ 01383000
*       /*                                                           */ 01384000
*       /* WRITE THE GHR.                                    @Z40LB25*/ 01385000
*       /*                                                           */ 01386000
*       /*************************************************************/ 01387000
*                                                                  0391 01388000
*       RPLVBUF=ADDR(GROUPBUF);     /* PTR TO GHR            @Z40LB25*/ 01389000
         LA    @09,GROUPBUF                                        0391 01390000
         ST    @09,RPLVBUF(,RPLVPTR)                               0391 01391000
*       CALL WRITRECD;              /* WRITE GHR             @Z40LB25*/ 01392000
         BAL   @14,WRITRECD                                        0392 01393000
*       IF RPLVRETC^=OKZERO         /* CHECK RETURN CODE     @Z40LB25*/ 01394000
*         THEN                      /* ERROR                 @Z40LB25*/ 01395000
         LH    @09,RPLVRETC(,RPLVPTR)                              0393 01396000
         N     @09,@CF00613                                        0393 01397000
         LTR   @09,@09                                             0393 01398000
         BNZ   @RT00393                                            0393 01399000
*         RETURN;                   /*                       @Z40LB25*/ 01400000
*                                                                  0394 01401000
*       /*************************************************************/ 01402000
*       /*                                                           */ 01403000
*       /* CHECK FOR ACTIVE GENERAL-USE TO DELETE            @Z40LB25*/ 01404000
*       /* ITS GHSNER SLOT.                                  @Z40LB25*/ 01405000
*       /*                                                           */ 01406000
*       /*************************************************************/ 01407000
*                                                                  0395 01408000
*       IF BASINAC=OFF&BASGENUS=ON  /* ACT & GEN-USE?        @Z40LB25*/ 01409000
*         THEN                      /* YES                   @Z40LB25*/ 01410000
         TM    BASGENUS(BASEVPTR),B'00010000'                      0395 01411000
         BNO   @RF00395                                            0395 01412000
         TM    BASINAC(BASEVPTR),B'00000100'                       0395 01413000
         BNZ   @RF00395                                            0395 01414000
*         DO;                       /*                       @Z40LB25*/ 01415000
*           ADDSUBSL=OFF;           /* DELETE SLOT           @Z40LB25*/ 01416000
         NI    ADDSUBSL,B'11111101'                                0397 01417000
*           EXPSLOT=OFF;            /* NO UPDT EXPIR DATE    @Z40LB25*/ 01418000
         NI    EXPSLOT,B'01111111'                                 0398 01419000
*           CALL ICBVUEXT(PTRGROUP,PTRBASEV,PTRRPLV,PASSBYTE);/*   0399 01420000
*                                      DELETE GHSNER SLOT    @Z40LB25*/ 01421000
         L     @15,@CV00541                                        0399 01422000
         LA    @01,@AL00399                                        0399 01423000
         BALR  @14,@15                                             0399 01424000
*           IF RPLVRETC^=OKZERO     /* ERROR?                @Z40LB25*/ 01425000
*             THEN                  /* YES                   @Z40LB25*/ 01426000
         LH    @09,RPLVRETC(,RPLVPTR)                              0400 01427000
         N     @09,@CF00613                                        0400 01428000
         LTR   @09,@09                                             0400 01429000
         BNZ   @RT00400                                            0400 01430000
*             RETURN;               /*                       @Z40LB25*/ 01431000
*         END;                      /*                       @Z40LB25*/ 01432000
*     END;                          /*                       @Z40LB25*/ 01433000
*                                                                  0403 01434000
@RF00395 DS    0H                                                  0404 01435000
*   /*****************************************************************/ 01436000
*   /*                                                               */ 01437000
*   /* CHECK FOR A DUP VOLUME RECORD FOR THE DELETED         @Z40LB25*/ 01438000
*   /* BASE VOLUME RECORD                                    @Z40LB25*/ 01439000
*   /*                                                               */ 01440000
*   /*****************************************************************/ 01441000
*                                                                  0404 01442000
*   DVOLKY=BASSERNO;                /* SET VOLID IN KEY      @Z40LB25*/ 01443000
@RF00380 MVC   DVOLKY(6),BASSERNO(BASEVPTR)                        0404 01444000
*   DIDKY=IDONE;                    /* SET KEY               @Z40LB25*/ 01445000
         MVI   DIDKY,X'01'                                         0405 01446000
*   RPLVKEY=ADDR(DKEY);             /* ADDR OF KEY           @Z40LB25*/ 01447000
         LA    @09,DKEY                                            0406 01448000
         ST    @09,RPLVKEY(,RPLVPTR)                               0406 01449000
*   RPLVTYP=RPLVREAD;               /* READ OPTION ON        @Z40LB25*/ 01450000
         MVI   RPLVTYP(RPLVPTR),X'00'                              0407 01451000
*   RPLVDIR=ON;                     /* DIRECT                @Z40LB25*/ 01452000
*   RPLVLOC=OFF;                    /* NO LOCATE             @Z40LB25*/ 01453000
         OI    RPLVDIR(RPLVPTR),B'01000000'                        0409 01454000
         NI    RPLVLOC(RPLVPTR),B'01111111'                        0409 01455000
*   RPLVUPD=ON;                     /* SET UPDATE            @Z40LB25*/ 01456000
         OI    RPLVUPD(RPLVPTR),B'00000010'                        0410 01457000
*   RPLVKGE=ON;                     /* READ KEY = OR >       @Z40LB25*/ 01458000
         OI    RPLVKGE(RPLVPTR),B'00000100'                        0411 01459000
*   RPLVBUF=DUPVPTR;                /* BUFFER PTR            @Z40LB25*/ 01460000
         ST    DUPVPTR,RPLVBUF(,RPLVPTR)                           0412 01461000
*   RPLVBLN=LENGTH(DUPVBUF);        /* BUFFER LENGTH         @Z40LB25*/ 01462000
         MVC   RPLVBLN(4,RPLVPTR),@CF00608                         0413 01463000
*   RESPECIFY                                                      0414 01464000
*     RG1 RSTD;                     /* RESTRICT REG 1        @Z40LB25*/ 01465000
*   RG1=RPLVPTR;                    /* SET RPLV PTR          @Z40LB25*/ 01466000
         LR    RG1,RPLVPTR                                         0415 01467000
*   CALL ICBVIO00;                  /* READ FOR DVR          @Z40LB25*/ 01468000
         L     @15,@CV00537                                        0416 01469000
         BALR  @14,@15                                             0416 01470000
*   RESPECIFY                                                      0417 01471000
*     RG1 UNRSTD;                   /* UNRESTRICT REG 1      @Z40LB25*/ 01472000
*   RPLVKGE=OFF;                    /* NO > OR =             @Z40LB25*/ 01473000
         NI    RPLVKGE(RPLVPTR),B'11111011'                        0418 01474000
*   IF RPLRCODE=IOERROR             /* CHECK REASON CODE     @Z40LB25*/ 01475000
*     THEN                          /* YES                   @Z40LB25*/ 01476000
         CLC   RPLRCODE(2,RPLVPTR),@CB00525                        0419 01477000
         BE    @RT00419                                            0419 01478000
*     RETURN;                       /*                       @Z40LB25*/ 01479000
*   IF DKY^=DUPD|DVOLKY^=DUPSERNO   /* DVR FOUND?            @Z40LB25*/ 01480000
*     THEN                          /* NO                    @Z40LB25*/ 01481000
         CLC   DKY(5),DUPD(DUPVPTR)                                0421 01482000
         BNE   @RT00421                                            0421 01483000
         CLC   DVOLKY(6),DUPSERNO(DUPVPTR)                         0421 01484000
         BE    @RF00421                                            0421 01485000
@RT00421 DS    0H                                                  0422 01486000
*     DO;                           /*                       @Z40LB25*/ 01487000
*       RPLVRETC=RPLVRETC&&RPLVRETC;/* ZERO RETURN CODE      @Z40LB25*/ 01488000
         XC    RPLVRETC(2,RPLVPTR),RPLVRETC(RPLVPTR)               0423 01489000
*       RPLRCODE=RPLRCODE&&RPLRCODE;/* ZERO REASON CODE      @Z40LB25*/ 01490000
*                                                                  0424 01491000
         XC    RPLRCODE(2,RPLVPTR),RPLRCODE(RPLVPTR)               0424 01492000
*       /*************************************************************/ 01493000
*       /*                                                           */ 01494000
*       /* NO DVR WAS FOUND.                                 @Z40LB25*/ 01495000
*       /*                                                           */ 01496000
*       /*************************************************************/ 01497000
*                                                                  0425 01498000
*       IF BASGRPV=OFF              /* BVR NOT GRPD?         @Z40LB25*/ 01499000
*         THEN                      /* YES                   @Z40LB25*/ 01500000
         TM    BASGRPV(BASEVPTR),B'00100000'                       0425 01501000
         BNZ   @RF00425                                            0425 01502000
*         DO;                       /*                       @Z40LB25*/ 01503000
*                                                                  0426 01504000
*           /*********************************************************/ 01505000
*           /*                                                       */ 01506000
*           /* CHAIN THE BVR OUT OF THE NGHR.                @Z40LB25*/ 01507000
*           /* CHECK FOR NON-GROUPED.                        @Z40LB25*/ 01508000
*           /*                                                       */ 01509000
*           /*********************************************************/ 01510000
*                                                                  0427 01511000
*           GRPFLG=OFF;             /* NON-GROUPED           @Z40LB25*/ 01512000
         NI    GRPFLG,B'11101111'                                  0427 01513000
*           CALL ICBVUCHO(ZEROCORE,PTRBASEV,PTRRPLV,PASSBYTE);/*   0428 01514000
*                                                            @Z40LB25   01515000
*                                      CHAIN BVR OUT NGHR    @Z40LB25*/ 01516000
         L     @15,@CV00543                                        0428 01517000
         LA    @01,@AL00428                                        0428 01518000
         BALR  @14,@15                                             0428 01519000
*         END;                      /*                       @Z40LB25*/ 01520000
*       RETURN;                     /*                       @Z40LB25*/ 01521000
@EL00012 DS    0H                                                  0430 01522000
@EF00012 DS    0H                                                  0430 01523000
@ER00012 L     @14,@SA00012                                        0430 01524000
         BR    @14                                                 0430 01525000
*     END;                          /*                       @Z40LB25*/ 01526000
*                                                                  0431 01527000
*   /*****************************************************************/ 01528000
*   /*                                                               */ 01529000
*   /* DVR WAS FOUND.                                        @Z40LB25*/ 01530000
*   /*                                                               */ 01531000
*   /*****************************************************************/ 01532000
*                                                                  0432 01533000
*   ELSE                            /* DVR WAS FOUND         @Z40LB25*/ 01534000
*     DO;                           /*                       @Z40LB25*/ 01535000
*                                                                  0432 01536000
@RF00421 DS    0H                                                  0433 01537000
*       /*************************************************************/ 01538000
*       /*                                                           */ 01539000
*       /* CHECK FOR A GROUPED BVR.                          @Z40LB25*/ 01540000
*       /*                                                           */ 01541000
*       /*************************************************************/ 01542000
*                                                                  0433 01543000
*       IF BASGRPV=ON               /* BVR GROUPED?          @Z40LB25*/ 01544000
*         THEN                      /* YES                   @Z40LB25*/ 01545000
         TM    BASGRPV(BASEVPTR),B'00100000'                       0433 01546000
         BNO   @RF00433                                            0433 01547000
*         DO;                       /*                       @Z40LB25*/ 01548000
*                                                                  0434 01549000
*           /*********************************************************/ 01550000
*           /*                                                       */ 01551000
*           /* MAKE A DVR INTO A BASE.                       @Z40LB25*/ 01552000
*           /* ICBVUDBR RETURNS THE POINTER TO THE           @Z40LB25*/ 01553000
*           /* BVR IT CREATED IN PTRBASEV.                   @Z40LB25*/ 01554000
*           /*                                                       */ 01555000
*           /*********************************************************/ 01556000
*                                                                  0435 01557000
*           GRPDV=ON;               /* GROUPED FLAG ON       @Z40LB25*/ 01558000
         OI    GRPDV,B'10000000'                                   0435 01559000
*           CALL ICBVUDBR(PTRDUPV,PTRBASEV,PTRRPLV,PASSBYTE,/*     0436 01560000
*                                                            @Z40LB25*/ 01561000
*               ZEROCORE,ZEROCORE); /*                       @Z40LB25   01562000
*                                      MAKE DVR A BVR        @Z40LB25*/ 01563000
         L     @15,@CV00540                                        0436 01564000
         LA    @01,@AL00436                                        0436 01565000
         BALR  @14,@15                                             0436 01566000
*           IF RPLVRETC^=OKZERO     /* CHECK RETURN CODE     @Z40LB25*/ 01567000
*             THEN                  /* ERROR                 @Z40LB25*/ 01568000
         LH    @05,RPLVRETC(,RPLVPTR)                              0437 01569000
         N     @05,@CF00613                                        0437 01570000
         LTR   @05,@05                                             0437 01571000
         BNZ   @RT00437                                            0437 01572000
*             RETURN;               /*                       @Z40LB25*/ 01573000
*                                                                  0438 01574000
*           /*********************************************************/ 01575000
*           /*                                                       */ 01576000
*           /* CHAIN THE BVR INTO THE NGHR.                  @Z40LB25*/ 01577000
*           /*                                                       */ 01578000
*           /*********************************************************/ 01579000
*                                                                  0439 01580000
*           GRPFLG=OFF;             /* NON-GROUPED           @Z40LB25*/ 01581000
         NI    GRPFLG,B'11101111'                                  0439 01582000
*           CALL ICBVUCHI(ZEROCORE,PTRBASEV,PTRRPLV,PASSBYTE);/*   0440 01583000
*                                                            @Z40LB25   01584000
*                                      CHAIN BVR IN NGHR     @Z40LB25*/ 01585000
         L     @15,@CV00544                                        0440 01586000
         LA    @01,@AL00440                                        0440 01587000
         BALR  @14,@15                                             0440 01588000
*           IF RPLVRETC^=OKZERO     /* CHECK RETURN CODE     @Z40LB25*/ 01589000
*             THEN                  /* ERROR                 @Z40LB25*/ 01590000
         LH    @05,RPLVRETC(,RPLVPTR)                              0441 01591000
         N     @05,@CF00613                                        0441 01592000
         LTR   @05,@05                                             0441 01593000
         BNZ   @RT00441                                            0441 01594000
*             RETURN;               /*                       @Z40LB25*/ 01595000
*         END;                      /*                       @Z40LB25*/ 01596000
*       ELSE                        /* NOT GROUPED           @Z40LB25*/ 01597000
*                                                                  0444 01598000
*         /***********************************************************/ 01599000
*         /*                                                         */ 01600000
*         /* MAKE THE DVR INTO A BVR.                        @Z40LB25*/ 01601000
*         /*                                                         */ 01602000
*         /***********************************************************/ 01603000
*                                                                  0444 01604000
*         DO;                       /*                       @Z40LB25*/ 01605000
         B     @RC00433                                            0444 01606000
@RF00433 DS    0H                                                  0445 01607000
*           GRPDV=OFF;              /* GROUPED FLAG OFF      @Z40LB25*/ 01608000
         NI    GRPDV,B'01111111'                                   0445 01609000
*           IF BASFIRST=ON          /* 1ST BVR IN CHAIN?     @Z40LB25*/ 01610000
*             THEN                  /* YES                   @Z40LB25*/ 01611000
         TM    BASFIRST(BASEVPTR),B'00010000'                      0446 01612000
         BNO   @RF00446                                            0446 01613000
*             FRSTDV=ON;            /* SET 1ST FLG ON        @Z40LB25*/ 01614000
         OI    FRSTDV,B'01000000'                                  0447 01615000
*           IF BASLAST=ON           /* LAST BVR IN CHAIN?    @Z40LB25*/ 01616000
*             THEN                  /* YES                   @Z40LB25*/ 01617000
@RF00446 TM    BASLAST(BASEVPTR),B'00001000'                       0448 01618000
         BNO   @RF00448                                            0448 01619000
*             LASTDV=ON;            /* SET LAST FLG ON       @Z40LB25*/ 01620000
         OI    LASTDV,B'00100000'                                  0449 01621000
*           CALL ICBVUDBR(PTRDUPV,PTRBASEV,PTRRPLV,PASSBYTE,/*     0450 01622000
*                                                            @Z40LB25*/ 01623000
*               BASPREV,BASNEXTV);  /*                       @Z40LB25   01624000
*                                      MAKE DVR A BVR        @Z40LB25*/ 01625000
@RF00448 MVC   @AL00001(16),@AL00450                               0450 01626000
         LA    @03,BASPREV(,BASEVPTR)                              0450 01627000
         ST    @03,@AL00001+16                                     0450 01628000
         LA    @03,BASNEXTV(,BASEVPTR)                             0450 01629000
         ST    @03,@AL00001+20                                     0450 01630000
         L     @15,@CV00540                                        0450 01631000
         LA    @01,@AL00001                                        0450 01632000
         BALR  @14,@15                                             0450 01633000
*           IF RPLVRETC^=OKZERO     /* CHECK RETURN CODE     @Z40LB25*/ 01634000
*             THEN                  /* ERROR                 @Z40LB25*/ 01635000
         LH    @05,RPLVRETC(,RPLVPTR)                              0451 01636000
         N     @05,@CF00613                                        0451 01637000
         LTR   @05,@05                                             0451 01638000
         BNZ   @RT00451                                            0451 01639000
*             RETURN;               /*                       @Z40LB25*/ 01640000
*         END;                      /*                       @Z40LB25*/ 01641000
*     END;                          /*                       @Z40LB25*/ 01642000
*                                                                  0454 01643000
@RC00433 DS    0H                                                  0455 01644000
*   /*****************************************************************/ 01645000
*   /*                                                               */ 01646000
*   /* WRITE THE NEW BVR.                                    @Z40LB25*/ 01647000
*   /*                                                               */ 01648000
*   /*****************************************************************/ 01649000
*                                                                  0455 01650000
*   RPLVTYP=RPLVPUT;                /* WRITE BVR             @Z40LB25*/ 01651000
         MVI   RPLVTYP(RPLVPTR),X'01'                              0455 01652000
*   RPLVBUF=PTRBASEV;               /* PTR TO NEW BVR        @Z40LB25*/ 01653000
         L     @05,PTRBASEV                                        0456 01654000
         ST    @05,RPLVBUF(,RPLVPTR)                               0456 01655000
*   RPLVUPD=OFF;                    /* NEW RECORD            @Z40LB25*/ 01656000
         NI    RPLVUPD(RPLVPTR),B'11111101'                        0457 01657000
*   RPLVLOC=OFF;                    /* NO LOCATE             @Z40LB25*/ 01658000
         NI    RPLVLOC(RPLVPTR),B'01111111'                        0458 01659000
*   RPLVBLN=LENGTH(BASEBUF);        /* SET BUF LENGTH        @Z40LB25*/ 01660000
         LA    @05,224                                             0459 01661000
         ST    @05,RPLVBLN(,RPLVPTR)                               0459 01662000
*   RPLVRLN=LENGTH(BASEBUF);        /* SET BVR LENGTH        @Z40LB25*/ 01663000
         ST    @05,RPLVRLN(,RPLVPTR)                               0460 01664000
*   CALL WRITRECD;                  /* WRITE BVR             @Z40LB25*/ 01665000
         BAL   @14,WRITRECD                                        0461 01666000
*   RETURN;                         /*                       @Z40LB25*/ 01667000
         B     @EL00012                                            0462 01668000
*   END PROCBVR;                    /*                       @Z40LB25*/ 01669000
         B     @EL00012                                            0463 01670000
*   END ICBVUT03                    /* THE END               @Z40LB25*/ 01671000
*                                                                  0464 01672000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 01673000
*/*%INCLUDE SYSLIB  (IEZVVICB)                                       */ 01674000
*/*%INCLUDE SYSLIB  (IEZRPLV )                                       */ 01675000
*/*%INCLUDE SYSLIB  (IEZINDEX)                                       */ 01676000
*/*%INCLUDE SYSLIB  (IEZGROUP)                                       */ 01677000
*/*%INCLUDE SYSLIB  (IEZNGVR )                                       */ 01678000
*/*%INCLUDE SYSLIB  (IEZBCDV )                                       */ 01679000
*/*%INCLUDE SYSLIB  (IEZBASEV)                                       */ 01680000
*/*%INCLUDE SYSLIB  (IEZCOPYV)                                       */ 01681000
*/*%INCLUDE SYSLIB  (IEZDUPV )                                       */ 01682000
*                                                                  0464 01683000
*       ;                                                          0464 01684000
@DATA    DS    0H                                                       01685000
@CH00036 DC    H'4'                                                     01686000
         DS    0F                                                       01687000
@AL00186 EQU   *                       LIST WITH   3 ARGUMENT(S)        01688000
@AL00271 DC    A(PTRGROUP)             LIST WITH   3 ARGUMENT(S)        01689000
         DC    A(PTRBASEV)                                              01690000
         DC    A(PASSBYTE)                                              01691000
@AL00223 DC    A(PTRCOPYV)             LIST WITH   3 ARGUMENT(S)        01692000
         DC    A(PTRRPLV)                                               01693000
         DC    A(PASSBYTE)                                              01694000
@AL00281 EQU   *                       LIST WITH   4 ARGUMENT(S)        01695000
@AL00383 EQU   *                       LIST WITH   4 ARGUMENT(S)        01696000
@AL00399 DC    A(PTRGROUP)             LIST WITH   4 ARGUMENT(S)        01697000
         DC    A(PTRBASEV)                                              01698000
         DC    A(PTRRPLV)                                               01699000
         DC    A(PASSBYTE)                                              01700000
@AL00428 EQU   *                       LIST WITH   4 ARGUMENT(S)        01701000
@AL00440 DC    A(@CF00080)             LIST WITH   4 ARGUMENT(S)        01702000
         DC    A(PTRBASEV)                                              01703000
         DC    A(PTRRPLV)                                               01704000
         DC    A(PASSBYTE)                                              01705000
@AL00436 EQU   *                       LIST WITH   6 ARGUMENT(S)        01706000
@AL00450 DC    A(PTRDUPV)              LIST WITH   4 ARGUMENT(S)        01707000
         DC    A(PTRBASEV)                                              01708000
         DC    A(PTRRPLV)                                               01709000
         DC    A(PASSBYTE)                                              01710000
         DC    A(@CF00080)                                              01711000
         DC    A(@CF00080)                                              01712000
         DS    0F                                                       01713000
@SA00001 DS    18F                                                      01714000
@SA00002 DS    1F                                                       01715000
@SA00003 DS    1F                                                       01716000
@SA00004 DS    1F                                                       01717000
@SA00006 DS    1F                                                       01718000
@SA00012 DS    1F                                                       01719000
@SA00005 DS    1F                                                       01720000
@SA00009 DS    0F                                                       01721000
@SA00011 DS    0F                                                       01722000
@SA00008 DS    0F                                                       01723000
@SA00010 DS    0F                                                       01724000
@SA00007 DS    0F                                                       01725000
         DS    1F                                                       01726000
@AL00001 DS    6A                                                       01727000
         DS    0F                                                       01728000
@CF00080 DC    F'0'                                                     01729000
@CF00607 DC    F'36'                                                    01730000
@CF00608 DC    F'224'                                                   01731000
@CF00613 DC    XL4'0000FFFF'                                            01732000
@CV00537 DC    V(ICBVIO00)                                              01733000
@CV00538 DC    V(ICBVRR00)                                              01734000
@CV00539 DC    V(ICBVJL00)                                              01735000
@CV00540 DC    V(ICBVUDBR)                                              01736000
@CV00541 DC    V(ICBVUEXT)                                              01737000
@CV00542 DC    V(ICBVUBVR)                                              01738000
@CV00543 DC    V(ICBVUCHO)                                              01739000
@CV00544 DC    V(ICBVUCHI)                                              01740000
@CV00545 DC    V(ICBVUPGH)                                              01741000
         DS    0D                                                       01742000
PTRRPLV  DS    A                                                        01743000
PTRGROUP DS    A                                                        01744000
PTRBASEV DS    A                                                        01745000
PTRCOPYV DS    A                                                        01746000
PTRDUPV  DS    A                                                        01747000
@CB00521 DC    X'FFFFFFFF'                                              01748000
@CB00523 DC    X'0208'                                                  01749000
@CB00525 DC    X'0209'                                                  01750000
@CB00527 DC    X'0213'                                                  01751000
GROUPBUF DS    CL164                                                    01752000
TEMPBUF  DS    CL224                                                    01753000
NGVRBUF  DS    CL40                                                     01754000
BASEBUF  DS    CL224                                                    01755000
COPYBUF  DS    CL164                                                    01756000
INDEXBUF DS    CL36                                                     01757000
DUPVBUF  DS    CL224                                                    01758000
         DS    CL2                                                      01759000
GKEY     DS    CL13                                                     01760000
         ORG   GKEY                                                     01761000
GKY      DC    CL3'G  '                                                 01762000
GROUPKY  DS    CL8                                                      01763000
GBLKKY   DC    CL1' '                                                   01764000
GIDKY    DC    XL1'00'                                                  01765000
         ORG   GKEY+13                                                  01766000
         DS    CL3                                                      01767000
BKEY     DS    CL13                                                     01768000
         ORG   BKEY                                                     01769000
BKY      DC    CL5'V    '                                               01770000
BVOLKY   DS    CL6                                                      01771000
BBLKKY   DC    CL1' '                                                   01772000
BIDKY    DC    XL1'00'                                                  01773000
         ORG   BKEY+13                                                  01774000
         DS    CL3                                                      01775000
DKEY     DS    CL13                                                     01776000
         ORG   DKEY                                                     01777000
DKY      DC    CL5'D    '                                               01778000
DVOLKY   DS    CL6                                                      01779000
DBLKKY   DC    CL1' '                                                   01780000
DIDKY    DS    FL1                                                      01781000
         ORG   DKEY+13                                                  01782000
         DS    CL3                                                      01783000
CKEY     DS    CL13                                                     01784000
         ORG   CKEY                                                     01785000
CKY      DC    CL5'V    '                                               01786000
CVOLKY   DS    CL6                                                      01787000
CBLKKY   DC    CL1' '                                                   01788000
CIDKY    DS    FL1                                                      01789000
         ORG   CKEY+13                                                  01790000
         DS    CL3                                                      01791000
IKEY     DS    CL13                                                     01792000
         ORG   IKEY                                                     01793000
IKY      DC    CL1'I'                                                   01794000
IVOLKY   DS    CL12                                                     01795000
         ORG   IKEY+13                                                  01796000
         DS    CL3                                                      01797000
NGKEY    DC    CL13'N   HEADER   '                                      01798000
         DS    CL3                                                      01799000
WORKAREA DS    CL19                                                     01800000
         ORG   WORKAREA                                                 01801000
REACODE  DS    CL2                                                      01802000
RETCODE  DS    CL2                                                      01803000
BCDKEY   DS    CL13                                                     01804000
PASSBYTE DS    CL2                                                      01805000
         ORG   PASSBYTE                                                 01806000
GRPDV    DS    BL1                                                      01807000
FRSTDV   EQU   PASSBYTE+0                                               01808000
LASTDV   EQU   PASSBYTE+0                                               01809000
GRPFLG   EQU   PASSBYTE+0                                               01810000
ADDSUBGR EQU   PASSBYTE+0                                               01811000
CSNUMBER EQU   PASSBYTE+0                                               01812000
ADDSUBSL EQU   PASSBYTE+0                                               01813000
RPLVFLG  EQU   PASSBYTE+0                                               01814000
EXPSLOT  DS    BL1                                                      01815000
ADDSUB   EQU   PASSBYTE+1                                               01816000
@NM00026 EQU   PASSBYTE+1                                               01817000
         ORG   WORKAREA+19                                              01818000
         DS    CL1                                                      01819000
VU3PATCH DS    CL200                                                    01820000
         ORG   VU3PATCH                                                 01821000
@NM00027 DC    200X'00'                                                 01822000
         ORG   VU3PATCH+200                                             01823000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       01824000
@01      EQU   01                                                       01825000
@02      EQU   02                                                       01826000
@03      EQU   03                                                       01827000
@04      EQU   04                                                       01828000
@05      EQU   05                                                       01829000
@06      EQU   06                                                       01830000
@07      EQU   07                                                       01831000
@08      EQU   08                                                       01832000
@09      EQU   09                                                       01833000
@10      EQU   10                                                       01834000
@11      EQU   11                                                       01835000
@12      EQU   12                                                       01836000
@13      EQU   13                                                       01837000
@14      EQU   14                                                       01838000
@15      EQU   15                                                       01839000
PTRNGVR  EQU   @02                                                      01840000
NULCPTR  EQU   @07                                                      01841000
DUPVPTR  EQU   @08                                                      01842000
COPYVPTR EQU   @07                                                      01843000
BASEVPTR EQU   @05                                                      01844000
BCDVPTR  EQU   @02                                                      01845000
NGVRPTR  EQU   @10                                                      01846000
GROUPPTR EQU   @06                                                      01847000
INDEXPTR EQU   @02                                                      01848000
RPLVPTR  EQU   @04                                                      01849000
VVIPTR   EQU   @09                                                      01850000
RG0      EQU   @00                                                      01851000
RG1      EQU   @01                                                      01852000
RG14     EQU   @14                                                      01853000
NULBR1   EQU   @01                                                      01854000
RG10     EQU   @10                                                      01855000
RG11     EQU   @11                                                      01856000
RG12     EQU   @12                                                      01857000
RG13     EQU   @13                                                      01858000
RG15     EQU   @15                                                      01859000
RG2      EQU   @02                                                      01860000
RG3      EQU   @03                                                      01861000
RG4      EQU   @04                                                      01862000
RG5      EQU   @05                                                      01863000
RG6      EQU   @06                                                      01864000
RG7      EQU   @07                                                      01865000
RG8      EQU   @08                                                      01866000
RG9      EQU   @09                                                      01867000
VVICB    EQU   0                                                        01868000
VVIFLGA  EQU   VVICB+15                                                 01869000
VVIFLG0  EQU   VVIFLGA                                                  01870000
RPLV     EQU   0                                                        01871000
RPLTCBPR EQU   RPLV+8                                                   01872000
RPLVVICB EQU   RPLV+12                                                  01873000
RPLFLAGA EQU   RPLV+28                                                  01874000
RPLRCODE EQU   RPLV+32                                                  01875000
RPLVRETC EQU   RPLV+34                                                  01876000
RPLVSAM  EQU   RPLV+56                                                  01877000
RPLVTYP  EQU   RPLVSAM+2                                                01878000
RPLVBUF  EQU   RPLVSAM+32                                               01879000
RPLVKEY  EQU   RPLVSAM+36                                               01880000
RPLVOPT  EQU   RPLVSAM+40                                               01881000
RPLVLOC  EQU   RPLVOPT                                                  01882000
RPLVDIR  EQU   RPLVOPT                                                  01883000
RPLVKGE  EQU   RPLVOPT                                                  01884000
RPLVUPD  EQU   RPLVOPT+1                                                01885000
RPLVRLN  EQU   RPLVSAM+48                                               01886000
RPLVBLN  EQU   RPLVSAM+52                                               01887000
RPLVUTIL EQU   RPLV+132                                                 01888000
INDEX    EQU   0                                                        01889000
INDNAME  EQU   INDEX                                                    01890000
INDTYPE  EQU   INDEX+13                                                 01891000
INDRECKY EQU   INDEX+15                                                 01892000
INDPREFX EQU   INDRECKY                                                 01893000
INDRECID EQU   INDRECKY+11                                              01894000
GROUP    EQU   0                                                        01895000
GRONAME  EQU   GROUP                                                    01896000
GROID    EQU   GRONAME+11                                               01897000
GROFLAGA EQU   GROUP+13                                                 01898000
GROTYPE  EQU   GROFLAGA                                                 01899000
GRONGEN  EQU   GROUP+30                                                 01900000
GRONRSTD EQU   GROUP+32                                                 01901000
GRONINAC EQU   GROUP+34                                                 01902000
GROERRTS EQU   GROUP+56                                                 01903000
NGVR     EQU   0                                                        01904000
NGVNAME  EQU   NGVR                                                     01905000
NGVRTYPE EQU   NGVR+13                                                  01906000
BCDV     EQU   0                                                        01907000
BCDNAME  EQU   BCDV                                                     01908000
BCDPREFX EQU   BCDNAME                                                  01909000
BCDID    EQU   BCDNAME+11                                               01910000
BCDFLAGA EQU   BCDV+14                                                  01911000
BCDTYPE  EQU   BCDFLAGA                                                 01912000
BCDBASE  EQU   BCDTYPE                                                  01913000
BCDCOPY  EQU   BCDTYPE                                                  01914000
BCDDUP   EQU   BCDTYPE                                                  01915000
BCDFLAGB EQU   BCDFLAGA+2                                               01916000
BCDRCVYF EQU   BCDV+20                                                  01917000
BCDSATIA EQU   BCDRCVYF                                                 01918000
BCDMISCF EQU   BCDRCVYF+2                                               01919000
BCDCSN1  EQU   BCDV+24                                                  01920000
BCDLIB1  EQU   BCDV+36                                                  01921000
BCDLID1  EQU   BCDLIB1                                                  01922000
BCDCSN2  EQU   BCDV+37                                                  01923000
BCDLIB2  EQU   BCDV+49                                                  01924000
BCDLID2  EQU   BCDLIB2                                                  01925000
BASEV    EQU   0                                                        01926000
BASNAME  EQU   BASEV                                                    01927000
BASSERNO EQU   BASNAME+5                                                01928000
BASID    EQU   BASNAME+11                                               01929000
BASFLAGA EQU   BASEV+14                                                 01930000
BASTYPE  EQU   BASFLAGA                                                 01931000
BASGRPV  EQU   BASFLAGA+2                                               01932000
BASGENUS EQU   BASFLAGA+2                                               01933000
BASRSTD  EQU   BASFLAGA+2                                               01934000
BASINAC  EQU   BASFLAGA+2                                               01935000
BASREASS EQU   BASFLAGA+3                                               01936000
BASFIRST EQU   BASFLAGA+3                                               01937000
BASLAST  EQU   BASFLAGA+3                                               01938000
BASRCVYF EQU   BASEV+20                                                 01939000
BASSATIA EQU   BASRCVYF                                                 01940000
BASMISCF EQU   BASRCVYF+2                                               01941000
BASLIB1  EQU   BASEV+36                                                 01942000
BASLID1  EQU   BASLIB1                                                  01943000
BASLIB2  EQU   BASEV+49                                                 01944000
BASLID2  EQU   BASLIB2                                                  01945000
BASPREV  EQU   BASEV+50                                                 01946000
BASNEXTV EQU   BASEV+56                                                 01947000
BASNCOPY EQU   BASEV+62                                                 01948000
BASKLCPY EQU   BASEV+76                                                 01949000
BASCOPID EQU   BASKLCPY+11                                              01950000
BASEXPDT EQU   BASEV+96                                                 01951000
BASGROUP EQU   BASEV+180                                                01952000
COPYV    EQU   0                                                        01953000
COPNAME  EQU   COPYV                                                    01954000
COPID    EQU   COPNAME+11                                               01955000
COPFLAGA EQU   COPYV+14                                                 01956000
COPTYPE  EQU   COPFLAGA                                                 01957000
COPRCVYF EQU   COPYV+20                                                 01958000
COPSATIA EQU   COPRCVYF                                                 01959000
COPMISCF EQU   COPRCVYF+2                                               01960000
COPLIB1  EQU   COPYV+36                                                 01961000
COPLID1  EQU   COPLIB1                                                  01962000
COPLIB2  EQU   COPYV+49                                                 01963000
COPLID2  EQU   COPLIB2                                                  01964000
DUPV     EQU   0                                                        01965000
DUPNAME  EQU   DUPV                                                     01966000
DUPD     EQU   DUPNAME                                                  01967000
DUPSERNO EQU   DUPNAME+5                                                01968000
DUPID    EQU   DUPNAME+11                                               01969000
DUPFLAGA EQU   DUPV+14                                                  01970000
DUPTYPE  EQU   DUPFLAGA                                                 01971000
DUPRCVYF EQU   DUPV+20                                                  01972000
DUPLIB1  EQU   DUPV+36                                                  01973000
DUPLID1  EQU   DUPLIB1                                                  01974000
DUPLIB2  EQU   DUPV+49                                                  01975000
DUPLID2  EQU   DUPLIB2                                                  01976000
LSTNULLC EQU   0                                                        01977000
NULFLAGA EQU   LSTNULLC+6                                               01978000
NULVOL   EQU   NULFLAGA                                                 01979000
NULVOLID EQU   LSTNULLC+8                                               01980000
NULCSN   EQU   LSTNULLC+20                                              01981000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    01982000
NULRES2  EQU   LSTNULLC+32                                              01983000
NULECB   EQU   LSTNULLC+16                                              01984000
NULASID  EQU   LSTNULLC+14                                              01985000
@NM00025 EQU   NULFLAGA                                                 01986000
NULCART2 EQU   NULFLAGA                                                 01987000
NULCART1 EQU   NULFLAGA                                                 01988000
@NM00024 EQU   NULFLAGA                                                 01989000
NULSCRC  EQU   NULFLAGA                                                 01990000
NULTRAN  EQU   NULFLAGA                                                 01991000
NULRES1  EQU   LSTNULLC+5                                               01992000
NULORDER EQU   LSTNULLC+4                                               01993000
NULENGTH EQU   LSTNULLC                                                 01994000
@NM00023 EQU   DUPV+50                                                  01995000
DUP2BIT2 EQU   DUPLID2                                                  01996000
DUP2BIT1 EQU   DUPLID2                                                  01997000
DUPRES4  EQU   DUPLIB2                                                  01998000
DUPCSN2  EQU   DUPV+37                                                  01999000
DUP1BIT2 EQU   DUPLID1                                                  02000000
DUP1BIT1 EQU   DUPLID1                                                  02001000
DUPRES3  EQU   DUPLIB1                                                  02002000
DUPCSN1  EQU   DUPV+24                                                  02003000
DUPMISCF EQU   DUPRCVYF+2                                               02004000
DUPSATIA EQU   DUPRCVYF                                                 02005000
@NM00022 EQU   DUPV+18                                                  02006000
@NM00021 EQU   DUPFLAGA+2                                               02007000
DUPRES2  EQU   DUPTYPE                                                  02008000
DUPDUPLR EQU   DUPTYPE                                                  02009000
DUPRES1  EQU   DUPTYPE                                                  02010000
DUPRES5  EQU   DUPV+13                                                  02011000
DUPNO    EQU   DUPID+1                                                  02012000
DUPBLANK EQU   DUPID                                                    02013000
@NM00020 EQU   COPYV+136                                                02014000
COPFREXT EQU   COPYV+132                                                02015000
COPLEXT  EQU   COPYV+130                                                02016000
COPFRESP EQU   COPYV+128                                                02017000
COPOWNER EQU   COPYV+118                                                02018000
COPDEST  EQU   COPYV+88                                                 02019000
COPDESCR EQU   COPYV+58                                                 02020000
COPDTREM EQU   COPYV+54                                                 02021000
COPDATE  EQU   COPYV+50                                                 02022000
COP2BIT2 EQU   COPLID2                                                  02023000
COP2BIT1 EQU   COPLID2                                                  02024000
COPRES5  EQU   COPLIB2                                                  02025000
COPCSN2  EQU   COPYV+37                                                 02026000
COP1BIT2 EQU   COPLID1                                                  02027000
COP1BIT1 EQU   COPLID1                                                  02028000
COPRES4  EQU   COPLIB1                                                  02029000
COPCSN1  EQU   COPYV+24                                                 02030000
@NM00019 EQU   COPMISCF                                                 02031000
COPHOLD  EQU   COPMISCF                                                 02032000
COPRES3  EQU   COPSATIA                                                 02033000
COPVSMIS EQU   COPSATIA                                                 02034000
COPIVCPY EQU   COPSATIA                                                 02035000
COPIVCRE EQU   COPSATIA                                                 02036000
@NM00018 EQU   COPYV+18                                                 02037000
@NM00017 EQU   COPFLAGA+3                                               02038000
COPDLSPF EQU   COPFLAGA+3                                               02039000
COPRONLY EQU   COPFLAGA+3                                               02040000
COPDAERA EQU   COPFLAGA+2                                               02041000
COPEXCL  EQU   COPFLAGA+2                                               02042000
COPBIND  EQU   COPFLAGA+2                                               02043000
COPBKUP  EQU   COPFLAGA+2                                               02044000
COPRSTD  EQU   COPFLAGA+2                                               02045000
COPGENUS EQU   COPFLAGA+2                                               02046000
COPVSAM  EQU   COPFLAGA+2                                               02047000
COPGROUP EQU   COPFLAGA+2                                               02048000
COPRES2  EQU   COPTYPE                                                  02049000
COPCOPYV EQU   COPTYPE                                                  02050000
COPRES1  EQU   COPTYPE                                                  02051000
COPRES6  EQU   COPYV+13                                                 02052000
COPNO    EQU   COPID+1                                                  02053000
COPBLANK EQU   COPID                                                    02054000
COPSERNO EQU   COPNAME+5                                                02055000
COPV     EQU   COPNAME                                                  02056000
@NM00016 EQU   BASEV+192                                                02057000
BASXPDT2 EQU   BASEV+188                                                02058000
BASRECOV EQU   BASEV+174                                                02059000
BASDEST  EQU   BASEV+144                                                02060000
BASOWNER EQU   BASEV+134                                                02061000
BASDESCR EQU   BASEV+104                                                02062000
BASDTREM EQU   BASEV+100                                                02063000
BASDLMTD EQU   BASEV+92                                                 02064000
BASRES6  EQU   BASEV+89                                                 02065000
BASCOPNO EQU   BASCOPID+1                                               02066000
BASCOPBK EQU   BASCOPID                                                 02067000
BASCOPSN EQU   BASKLCPY+5                                               02068000
BASCOPV  EQU   BASKLCPY                                                 02069000
BASFREXT EQU   BASEV+72                                                 02070000
BASLEXT  EQU   BASEV+70                                                 02071000
BASFRESP EQU   BASEV+68                                                 02072000
@NM00015 EQU   BASEV+65                                                 02073000
BASBKLMT EQU   BASEV+64                                                 02074000
BASNBKUP EQU   BASEV+63                                                 02075000
BAS2BIT2 EQU   BASLID2                                                  02076000
BAS2BIT1 EQU   BASLID2                                                  02077000
BASRES5  EQU   BASLIB2                                                  02078000
BASCSN2  EQU   BASEV+37                                                 02079000
BAS1BIT2 EQU   BASLID1                                                  02080000
BAS1BIT1 EQU   BASLID1                                                  02081000
BASRES4  EQU   BASLIB1                                                  02082000
BASCSN1  EQU   BASEV+24                                                 02083000
BASRES3  EQU   BASMISCF                                                 02084000
BASHOLD  EQU   BASMISCF                                                 02085000
BASRES8  EQU   BASSATIA                                                 02086000
BASVSMIS EQU   BASSATIA                                                 02087000
BASIVCPY EQU   BASSATIA                                                 02088000
BASIVCRE EQU   BASSATIA                                                 02089000
BASCPUID EQU   BASEV+18                                                 02090000
@NM00014 EQU   BASFLAGA+3                                               02091000
BASRONLY EQU   BASFLAGA+3                                               02092000
BASDAERA EQU   BASFLAGA+3                                               02093000
BASEXCL  EQU   BASFLAGA+2                                               02094000
BASBIND  EQU   BASFLAGA+2                                               02095000
BASNOCPY EQU   BASFLAGA+2                                               02096000
BASDLSF  EQU   BASFLAGA+2                                               02097000
BASRES2  EQU   BASTYPE                                                  02098000
BASBASVR EQU   BASTYPE                                                  02099000
BASRES1  EQU   BASTYPE                                                  02100000
BASRES7  EQU   BASEV+13                                                 02101000
BASZERO  EQU   BASID+1                                                  02102000
BASBLANK EQU   BASID                                                    02103000
BASEVKEY EQU   BASNAME                                                  02104000
BCD2BIT2 EQU   BCDLID2                                                  02105000
BCD2BIT1 EQU   BCDLID2                                                  02106000
BCDRES8  EQU   BCDLIB2                                                  02107000
BCD1BIT2 EQU   BCDLID1                                                  02108000
BCD1BIT1 EQU   BCDLID1                                                  02109000
BCDRE10  EQU   BCDLIB1                                                  02110000
BCDRES7A EQU   BCDMISCF                                                 02111000
BCDHOLD  EQU   BCDMISCF                                                 02112000
BCDRES7  EQU   BCDSATIA                                                 02113000
BCDVSMIS EQU   BCDSATIA                                                 02114000
BCDIVCPY EQU   BCDSATIA                                                 02115000
BCDIVCRE EQU   BCDSATIA                                                 02116000
BCDCPUID EQU   BCDV+18                                                  02117000
BCDRES5  EQU   BCDFLAGB+1                                               02118000
BCDREASS EQU   BCDFLAGB+1                                               02119000
BCDRES4  EQU   BCDFLAGB                                                 02120000
BCDRES3  EQU   BCDTYPE                                                  02121000
BCDRES2  EQU   BCDTYPE                                                  02122000
BCDRES1  EQU   BCDTYPE                                                  02123000
BCDRES9  EQU   BCDV+13                                                  02124000
BCDINDEX EQU   BCDID+1                                                  02125000
BCDBLNK2 EQU   BCDID                                                    02126000
BCDSERNO EQU   BCDNAME+5                                                02127000
BCDBLNK1 EQU   BCDPREFX+1                                               02128000
BCDALPHA EQU   BCDPREFX                                                 02129000
@NM00013 EQU   NGVR+32                                                  02130000
NGVNOVOL EQU   NGVR+30                                                  02131000
@NM00012 EQU   NGVR+29                                                  02132000
NGVLVOL  EQU   NGVR+23                                                  02133000
NGVFVOL  EQU   NGVR+17                                                  02134000
@NM00011 EQU   NGVR+15                                                  02135000
NGVRES2  EQU   NGVRTYPE+1                                               02136000
NGVHDR   EQU   NGVRTYPE                                                 02137000
NGVRES1  EQU   NGVRTYPE                                                 02138000
@NM00010 EQU   GROUP+136                                                02139000
GROADDR  EQU   GROUP+106                                                02140000
GROOWNER EQU   GROUP+96                                                 02141000
GRORESSP EQU   GROUP+95                                                 02142000
GROCONUS EQU   GROUP+94                                                 02143000
GRODESCR EQU   GROUP+64                                                 02144000
GROERRTM EQU   GROERRTS+4                                               02145000
GROERRDT EQU   GROERRTS                                                 02146000
GRORETPD EQU   GROUP+52                                                 02147000
GROFREXT EQU   GROUP+48                                                 02148000
GROFRESP EQU   GROUP+44                                                 02149000
GROSTRSH EQU   GROUP+40                                                 02150000
GROSSPD  EQU   GROUP+38                                                 02151000
GROPSPD  EQU   GROUP+36                                                 02152000
GROPCENT EQU   GROUP+29                                                 02153000
GROLSN   EQU   GROUP+23                                                 02154000
GROFSN   EQU   GROUP+17                                                 02155000
@NM00009 EQU   GROFLAGA+2                                               02156000
GROMSG1  EQU   GROFLAGA+2                                               02157000
GRORETN  EQU   GROFLAGA+2                                               02158000
GRORLSE  EQU   GROFLAGA+2                                               02159000
GRORONLY EQU   GROFLAGA+2                                               02160000
GRODAERA EQU   GROFLAGA+2                                               02161000
GROEXCL  EQU   GROFLAGA+2                                               02162000
GROBIND  EQU   GROFLAGA+2                                               02163000
GRORES1  EQU   GROTYPE                                                  02164000
GROGVR   EQU   GROTYPE                                                  02165000
GROZERO  EQU   GROID+1                                                  02166000
GROBLANK EQU   GROID                                                    02167000
GROVVGRP EQU   GRONAME+3                                                02168000
GROG     EQU   GRONAME                                                  02169000
@NM00008 EQU   INDEX+28                                                 02170000
INDEXREC EQU   INDRECID+1                                               02171000
INDBLNK2 EQU   INDRECID                                                 02172000
INDVSRNO EQU   INDRECKY+5                                               02173000
INDBLNK1 EQU   INDPREFX+1                                               02174000
INDALPHA EQU   INDPREFX                                                 02175000
INDRES2  EQU   INDTYPE                                                  02176000
INDINDEX EQU   INDTYPE                                                  02177000
INDRES1  EQU   INDTYPE                                                  02178000
INDSERNO EQU   INDNAME+1                                                02179000
INDI     EQU   INDNAME                                                  02180000
@NM00007 EQU   RPLVSAM+44                                               02181000
@NM00006 EQU   RPLVOPT                                                  02182000
@NM00005 EQU   RPLVOPT                                                  02183000
RPLVNEXT EQU   RPLVOPT                                                  02184000
@NM00004 EQU   RPLVSAM+28                                               02185000
RPLVACB  EQU   RPLVSAM+24                                               02186000
@NM00003 EQU   RPLVSAM+3                                                02187000
@NM00002 EQU   RPLVSAM                                                  02188000
@NM00001 EQU   RPLV+38                                                  02189000
RPLRMSCC EQU   RPLV+36                                                  02190000
RPLVTLEN EQU   RPLV+30                                                  02191000
RPLVRES1 EQU   RPLFLAGA+1                                               02192000
RPLVJRNL EQU   RPLFLAGA                                                 02193000
RPLJRCVY EQU   RPLFLAGA                                                 02194000
RPLVVOP  EQU   RPLFLAGA                                                 02195000
RPLVVIN  EQU   RPLFLAGA                                                 02196000
RPLVCOMP EQU   RPLFLAGA                                                 02197000
RPLVPROG EQU   RPLFLAGA                                                 02198000
RPLVPOST EQU   RPLFLAGA                                                 02199000
RPLFTIME EQU   RPLFLAGA                                                 02200000
RPLVRSV3 EQU   RPLV+24                                                  02201000
RPLVRSV2 EQU   RPLV+20                                                  02202000
RPLVRSV1 EQU   RPLV+16                                                  02203000
RPLASCBP EQU   RPLTCBPR                                                 02204000
RPLVECB  EQU   RPLV+4                                                   02205000
RPLVQPTR EQU   RPLV                                                     02206000
VVIUNUSD EQU   VVICB+116                                                02207000
VVINUSDC EQU   VVICB+112                                                02208000
VVITPFCH EQU   VVICB+108                                                02209000
VVIDVMEL EQU   VVICB+104                                                02210000
VVIVBSTF EQU   VVICB+100                                                02211000
VVISSOBA EQU   VVICB+96                                                 02212000
VVIVSCRA EQU   VVICB+92                                                 02213000
VVISTPTB EQU   VVICB+88                                                 02214000
VVIDVMTA EQU   VVICB+84                                                 02215000
VVIJUCB  EQU   VVICB+80                                                 02216000
VVIIUCB  EQU   VVICB+76                                                 02217000
VVIRES6  EQU   VVICB+72                                                 02218000
VVIRES5  EQU   VVICB+68                                                 02219000
VVIRES4  EQU   VVICB+64                                                 02220000
VVIUCB   EQU   VVICB+60                                                 02221000
VVIVJL   EQU   VVICB+56                                                 02222000
VVIVRR   EQU   VVICB+52                                                 02223000
VVIQLSPL EQU   VVICB+48                                                 02224000
VVIQRPL2 EQU   VVICB+44                                                 02225000
VVIQRPL1 EQU   VVICB+40                                                 02226000
VVIRES3  EQU   VVICB+36                                                 02227000
VVIVQMP  EQU   VVICB+32                                                 02228000
VVIECB1  EQU   VVICB+28                                                 02229000
VVICATAD EQU   VVICB+24                                                 02230000
VVIDCBAD EQU   VVICB+20                                                 02231000
VVIACBAD EQU   VVICB+16                                                 02232000
VVIFLG7  EQU   VVIFLGA                                                  02233000
VVIFLG6  EQU   VVIFLGA                                                  02234000
VVIFLG5  EQU   VVIFLGA                                                  02235000
VVIFLG4  EQU   VVIFLGA                                                  02236000
VVIFLG3  EQU   VVIFLGA                                                  02237000
VVIFLG2  EQU   VVIFLGA                                                  02238000
VVIFLG1  EQU   VVIFLGA                                                  02239000
VVIALCON EQU   VVICB+14                                                 02240000
VVICPUID EQU   VVICB+12                                                 02241000
VVIUCAT  EQU   VVICB+4                                                  02242000
VVICID   EQU   VVICB                                                    02243000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      02244000
@RF00130 EQU   @EL00001                                                 02245000
@RF00144 EQU   @EL00001                                                 02246000
@RT00171 EQU   @EL00002                                                 02247000
@RT00179 EQU   @EL00002                                                 02248000
@RT00200 EQU   @EL00003                                                 02249000
@RT00203 EQU   @EL00003                                                 02250000
@RT00212 EQU   @EL00003                                                 02251000
@RF00219 EQU   @EL00003                                                 02252000
@RT00231 EQU   @EL00004                                                 02253000
@RT00238 EQU   @EL00004                                                 02254000
@RT00246 EQU   @EL00004                                                 02255000
@RT00261 EQU   @EL00005                                                 02256000
@RT00275 EQU   @EL00005                                                 02257000
@RF00256 EQU   @EL00005                                                 02258000
@RF00277 EQU   @EL00005                                                 02259000
@RT00327 EQU   @EL00008                                                 02260000
@RT00349 EQU   @EL00009                                                 02261000
@RT00384 EQU   @EL00012                                                 02262000
@RT00389 EQU   @EL00012                                                 02263000
@RT00393 EQU   @EL00012                                                 02264000
@RT00400 EQU   @EL00012                                                 02265000
@RT00419 EQU   @EL00012                                                 02266000
@RF00425 EQU   @EL00012                                                 02267000
@RT00437 EQU   @EL00012                                                 02268000
@RT00441 EQU   @EL00012                                                 02269000
@RT00451 EQU   @EL00012                                                 02270000
@ENDDATA EQU   *                                                        02271000
         END   ICBVUT03,(C'PLS2137',0603,76280)                         02272000
