         TITLE 'ICGDSA05 MSC TABLE CREATE, ANALYZE ALTERNATE PATHS     *00001000
                        '                                               00002000
ICGDSA05 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'ICGDSA05  76.335'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@12                                         0001 00013000
         L     @00,@SIZDATD                                        0001 00014000
         GETMAIN  R,LV=(0)                                              00015000
         LR    @11,@01                                             0001 00016000
         USING @DATD,@11                                           0001 00017000
         ST    @13,@SA00001+4                                      0001 00018000
         LM    @00,@01,20(@13)                                     0001 00019000
         ST    @11,8(,@13)                                         0001 00020000
         LR    @13,@11                                             0001 00021000
         XC    @ZTEMPS(@ZLEN),@ZTEMPS                                   00022000
*                                                                  0015 00023000
*/********************************************************** @Y30LB12*/ 00024000
*/*                                                          @Y30LB12*/ 00025000
*/*            ICGDSA05 (MAINLINE)                           @YD00113*/ 00026000
*/*                                                          @Y30LB12*/ 00027000
*/*            EXAMINE THE AREA IN WHICH ALTERNATE PATH      @YD00113*/ 00028000
*/*            INFORMATION IS STORED TO DETERMINE WHETHER    @Y30LB12*/ 00029000
*/*            AN ALTERNATE PATH IS SPECIFIED.  THE INDEX    @Y30LB12*/ 00030000
*/*            DSINDEX IS THE INDEX TO DATA STAGER/CHANNEL   @Y30LB12*/ 00031000
*/*            INTERFACE.  THE INNER INDEX DEVINDEX IS       @Y30LB12*/ 00032000
*/*            THE INDEX TO DEVICE WITHIN DATA STAGER/       @Y30LB12*/ 00033000
*/*            CHANNEL INTERFACE.                            @Y30LB12*/ 00034000
*/*                                                          @Y30LB12*/ 00035000
*/********************************************************** @Y30LB12*/ 00036000
*                                                                  0015 00037000
*   DO DSINDEX=1 TO 48;             /*                       @Y30LB12*/ 00038000
*                                                                  0015 00039000
         LA    @10,1                                               0015 00040000
         ST    @10,DSINDEX                                         0015 00041000
@DL00015 DS    0H                                                  0016 00042000
*     /***************************************************************/ 00043000
*     /*                                                             */ 00044000
*     /* ***********************************************     @ZD02028*/ 00045000
*     /* IF THE STRUCTURE CPUASSOC INDICATES THAT THE        @ZD02028*/ 00046000
*     /* OPERATING SYSTEM IS VS2, SET THE FLAG               @ZD02028*/ 00047000
*     /* VS2LOCAL. NOTE THAT THE SETTING OF CPUREFNO         @ZD02028*/ 00048000
*     /* IS DEPENDENT ON THE PREVIOUS EXECUTION OF THE       @ZD02028*/ 00049000
*     /* MODULE ICGDSA01.                                    @ZD02028*/ 00050000
*     /* ***********************************************     @ZD02028*/ 00051000
*     /*                                                             */ 00052000
*     /***************************************************************/ 00053000
*                                                                  0016 00054000
*     VS2LOCAL='0'B;                /* INITIALIZE FLAG       @ZD02028*/ 00055000
         NI    VS2LOCAL,B'11011111'                                0016 00056000
*     IF OPVS2(CPUREFNO(DSINDEX)+1)='1'B/*                   @ZD02028*/ 00057000
*       THEN                        /*                       @ZD02028*/ 00058000
         MH    @10,@CH00112                                        0017 00059000
         L     @05,COMPTR2(,R4)                                    0017 00060000
         SLR   @15,@15                                             0017 00061000
         IC    @15,CPUREFNO-9(@10,@05)                             0017 00062000
         SLA   @15,3                                               0017 00063000
         ALR   @15,R4                                              0017 00064000
         TM    OPVS2(@15),B'00001000'                              0017 00065000
         BNO   @RF00017                                            0017 00066000
*       VS2LOCAL='1'B;              /*                       @ZD02028*/ 00067000
         OI    VS2LOCAL,B'00100000'                                0018 00068000
*     ELSE                                                         0019 00069000
*       ;                           /*                       @ZD02028*/ 00070000
@RF00017 DS    0H                                                  0020 00071000
*     DO DEVINDEX=1 TO 64;          /*                       @Y30LB12*/ 00072000
         LA    @10,1                                               0020 00073000
         ST    @10,DEVINDEX                                        0020 00074000
@DL00020 DS    0H                                                  0021 00075000
*       IF ALTPATH1(DSINDEX,DEVINDEX)^='000000'X/*           @Y30LB12*/ 00076000
*         THEN                      /*                       @Y30LB12*/ 00077000
         L     @05,DSINDEX                                         0021 00078000
         SLA   @05,6                                               0021 00079000
         ALR   @05,@10                                             0021 00080000
         MH    @05,@CH00246                                        0021 00081000
         L     @10,COMPTR2(,R4)                                    0021 00082000
         ST    @05,@TF00001                                        0021 00083000
         ALR   @05,@10                                             0021 00084000
         AL    @05,@CF00507                                        0021 00085000
         CLC   ALTPATH1-466(3,@05),@CB00436                        0021 00086000
         BE    @RF00021                                            0021 00087000
*         DO;                       /*                       @Y30LB12*/ 00088000
*           WORKPATH=ALTPATH1(DSINDEX,DEVINDEX);/*           @Y30LB12*/ 00089000
         AL    @10,@TF00001                                        0023 00090000
         AL    @10,@CF00507                                        0023 00091000
         MVC   WORKPATH(3),ALTPATH1-466(@10)                       0023 00092000
*           CALL CHKPATH;           /*                       @Y30LB12*/ 00093000
         BAL   @14,CHKPATH                                         0024 00094000
*         END;                      /*                       @Y30LB12*/ 00095000
*       ELSE                                                       0026 00096000
*         ;                         /*                       @Y30LB12*/ 00097000
@RF00021 DS    0H                                                  0027 00098000
*       IF ALTPATH2(DSINDEX,DEVINDEX)^='000000'X/*           @Y30LB12*/ 00099000
*           &VS2LOCAL='0'B          /* NOT 3 PATHS VS2       @ZD02028*/ 00100000
*         THEN                      /*                       @Y30LB12*/ 00101000
         L     @10,DSINDEX                                         0027 00102000
         SLA   @10,6                                               0027 00103000
         AL    @10,DEVINDEX                                        0027 00104000
         MH    @10,@CH00246                                        0027 00105000
         L     @05,COMPTR2(,R4)                                    0027 00106000
         ST    @10,@TF00001                                        0027 00107000
         ALR   @10,@05                                             0027 00108000
         AL    @10,@CF00508                                        0027 00109000
         CLC   ALTPATH2-469(3,@10),@CB00436                        0027 00110000
         BE    @RF00027                                            0027 00111000
         TM    VS2LOCAL,B'00100000'                                0027 00112000
         BNZ   @RF00027                                            0027 00113000
*         DO;                       /*                       @Y30LB12*/ 00114000
*           WORKPATH=ALTPATH2(DSINDEX,DEVINDEX);/*           @Y30LB12*/ 00115000
         AL    @05,@TF00001                                        0029 00116000
         AL    @05,@CF00508                                        0029 00117000
         MVC   WORKPATH(3),ALTPATH2-469(@05)                       0029 00118000
*           CALL CHKPATH;           /*                       @Y30LB12*/ 00119000
         BAL   @14,CHKPATH                                         0030 00120000
*         END;                      /*                       @Y30LB12*/ 00121000
*       ELSE                                                       0032 00122000
*         ;                         /*                       @Y30LB12*/ 00123000
@RF00027 DS    0H                                                  0033 00124000
*       IF ALTPATH3(DSINDEX,DEVINDEX)^='000000'X/*           @Y30LB12*/ 00125000
*           &VS2LOCAL='0'B          /* NOT 4 PATHS VS2       @ZD02028*/ 00126000
*         THEN                      /*                       @Y30LB12*/ 00127000
         L     @10,DSINDEX                                         0033 00128000
         SLA   @10,6                                               0033 00129000
         AL    @10,DEVINDEX                                        0033 00130000
         MH    @10,@CH00246                                        0033 00131000
         L     @05,COMPTR2(,R4)                                    0033 00132000
         ST    @10,@TF00001                                        0033 00133000
         ALR   @10,@05                                             0033 00134000
         AL    @10,@CF00509                                        0033 00135000
         CLC   ALTPATH3-472(3,@10),@CB00436                        0033 00136000
         BE    @RF00033                                            0033 00137000
         TM    VS2LOCAL,B'00100000'                                0033 00138000
         BNZ   @RF00033                                            0033 00139000
*         DO;                       /*                       @Y30LB12*/ 00140000
*           WORKPATH=ALTPATH3(DSINDEX,DEVINDEX);/*           @Y30LB12*/ 00141000
         AL    @05,@TF00001                                        0035 00142000
         AL    @05,@CF00509                                        0035 00143000
         MVC   WORKPATH(3),ALTPATH3-472(@05)                       0035 00144000
*           CALL CHKPATH;           /*                       @Y30LB12*/ 00145000
         BAL   @14,CHKPATH                                         0036 00146000
*         END;                      /*                       @Y30LB12*/ 00147000
*       ELSE                                                       0038 00148000
*         ;                         /*                       @Y30LB12*/ 00149000
@RF00033 DS    0H                                                  0039 00150000
*       IF ALTPATH2(DSINDEX,DEVINDEX)^='000000'X/*           @ZD02028*/ 00151000
*           &VS2LOCAL='1'B          /* 3 PATHS FOR VS2       @ZD02028*/ 00152000
*         THEN                      /*                       @ZD02028*/ 00153000
         L     @10,DSINDEX                                         0039 00154000
         SLA   @10,6                                               0039 00155000
         AL    @10,DEVINDEX                                        0039 00156000
         MH    @10,@CH00246                                        0039 00157000
         L     @05,COMPTR2(,R4)                                    0039 00158000
         ALR   @05,@10                                             0039 00159000
         AL    @05,@CF00508                                        0039 00160000
         CLC   ALTPATH2-469(3,@05),@CB00436                        0039 00161000
         BE    @RF00039                                            0039 00162000
         TM    VS2LOCAL,B'00100000'                                0039 00163000
         BNO   @RF00039                                            0039 00164000
*         DO;                       /*                       @ZD02028*/ 00165000
*                                                                  0040 00166000
*           /*********************************************************/ 00167000
*           /*                                                       */ 00168000
*           /* *****************************************     @ZD02028*/ 00169000
*           /* ICG340I FOR SA X INT X DEV XX, TOO MANY       @ZD02028*/ 00170000
*           /* ALTERNATE PATHS                               @ZD02028*/ 00171000
*           /* *****************************************     @ZD02028*/ 00172000
*           /*                                                       */ 00173000
*           /*********************************************************/ 00174000
*                                                                  0041 00175000
*           OUTBUF2(1:85)=ICGDS340; /*                       @ZD02028*/ 00176000
         MVI   OUTBUF2+56(R4),C' '                                 0041 00177000
         MVC   OUTBUF2+57(28,R4),OUTBUF2+56(R4)                    0041 00178000
         MVC   OUTBUF2(56,R4),ICGDS340                             0041 00179000
*           CALL GETPRIID;          /*                       @ZD02028*/ 00180000
         BAL   @14,GETPRIID                                        0042 00181000
*           OUTBUF2(17)=PRIDS;      /*                       @ZD02028*/ 00182000
         MVC   OUTBUF2+16(1,R4),PRIDS                              0043 00183000
*           OUTBUF2(23)=PRICI;      /*                       @ZD02028*/ 00184000
         MVC   OUTBUF2+22(1,R4),PRICI                              0044 00185000
*           OUTBUF2(29:30)=TWOCHAR(DEVINDEX);/*              @ZD02028*/ 00186000
         L     @10,DEVINDEX                                        0045 00187000
         ALR   @10,@10                                             0045 00188000
         LA    @05,TWOCHAR-2(@10)                                  0045 00189000
         MVC   OUTBUF2+28(2,R4),0(@05)                             0045 00190000
*           CALL PUTIT1;            /*                       @ZD02028*/ 00191000
         BAL   @14,PUTIT1                                          0046 00192000
*         END;                      /*                       @ZD02028*/ 00193000
*       ELSE                                                       0048 00194000
*         ;                         /*                       @ZD02028*/ 00195000
@RF00039 DS    0H                                                  0049 00196000
*     END;                          /* OF DO DEVINDEX        @Y30LB12*/ 00197000
         LA    @10,1                                               0049 00198000
         AL    @10,DEVINDEX                                        0049 00199000
         ST    @10,DEVINDEX                                        0049 00200000
         CH    @10,@CH00245                                        0049 00201000
         BNH   @DL00020                                            0049 00202000
*   END;                            /* OF DO DSINDEX         @Y30LB12*/ 00203000
         LA    @10,1                                               0050 00204000
         AL    @10,DSINDEX                                         0050 00205000
         ST    @10,DSINDEX                                         0050 00206000
         CH    @10,@CH00235                                        0050 00207000
         BNH   @DL00015                                            0050 00208000
*   RETURN;                         /* RET. TO ICGDSANL      @Y30LB12*/ 00209000
@EL00001 L     @13,4(,@13)                                         0051 00210000
@EF00001 L     @00,@SIZDATD                                        0051 00211000
         LR    @01,@11                                             0051 00212000
         FREEMAIN R,LV=(0),A=(1)                                        00213000
@ER00001 LM    @14,@12,12(@13)                                     0051 00214000
         BR    @14                                                 0051 00215000
*                                                                  0052 00216000
*/********************************************************** @Y30LB12*/ 00217000
*/*                                                          @Y30LB12*/ 00218000
*/* PROCEDURE NAME - CHKPATH                                 @Y30LB12*/ 00219000
*/*                                                          @Y30LB12*/ 00220000
*/* FUNCTION - THIS PROCEDURE DEVELOPS THE INDEX TO          @Y30LB12*/ 00221000
*/*            LOCATE THE DATA STAGER/CHANNEL INTERFACE      @Y30LB12*/ 00222000
*/*            SPECIFIED AS THE ALTERNATE PATH.  EACH        @Y30LB12*/ 00223000
*/*            DATA STAGER HAS THREE POSSIBLE CHANNEL        @Y30LB12*/ 00224000
*/*            INTERFACES AND VEIFIES THAT THE CPUID         @Y30LB12*/ 00225000
*/*            FOR THE ALTERNATE PATH IS THE SAME AS         @Y30LB12*/ 00226000
*/*            THAT OF THE PRINARY PATH, THAT THE CONTRAL    @Y30LB12*/ 00227000
*/*            UNIT IDENTIFICATION OF THE ALTERNATE          @Y30LB12*/ 00228000
*/*            PATH IS THE SAME AS THAT OF THE PRIMARY,      @Y30LB12*/ 00229000
*/*            AND THAT THE CHANNEL NUMBER OF THE            @Y30LB12*/ 00230000
*/*            ALTERNATE PATH IS HIGHER THAN THAT OF         @Y30LB12*/ 00231000
*/*            THE PRIMARY.  (THE ALTERNATES THEMSELVES      @Y30LB12*/ 00232000
*/*            WILL BE PLACED IN ASCENDING SEQUENCE          @Y30LB12*/ 00233000
*/*            WHEN THE IODEVICE STATEMENTS ARE PUNCHED.)    @Y30LB12*/ 00234000
*/*            IF THE ABOVE TESTS ARE SUCCESSFUL, THE        @Y30LB12*/ 00235000
*/*            DEVICE ADDRESS ON THE ALTERNATE PATH          @Y30LB12*/ 00236000
*/*            DATA STAGER/CHANNEL INTERFACE ARE CHECKED     @Y30LB12*/ 00237000
*/*            FOR PREVIOUS USAGE.  IF PREVIOUSLY USED,      @Y30LB12*/ 00238000
*/*            AN ERROR MESSAGE IS WRITTEN INDICATING        @Y30LB12*/ 00239000
*/*            USAGE.  IF THE PATH HAS NOT BEEN USED,        @Y30LB12*/ 00240000
*/*            THE FLAGS USESPEC AND INISALTP ARE SET        @Y30LB12*/ 00241000
*/*            FOR THE DEVICE ADDRESS ON THE ALTERNATE       @Y30LB12*/ 00242000
*/*            DATA STAGER/CHANNEL INTERFACE.                @Y30LB12*/ 00243000
*/*                                                          @Y30LB12*/ 00244000
*/********************************************************** @Y30LB12*/ 00245000
*                                                                  0052 00246000
*CHKPATH:                                                          0052 00247000
*   PROCEDURE;                      /*                       @Y30LB12*/ 00248000
CHKPATH  STM   @14,@12,@SA00002                                    0052 00249000
*   ALTINDEX=WORKADS;               /*                       @Y30LB12*/ 00250000
         SLR   @10,@10                                             0053 00251000
         IC    @10,WORKADS                                         0053 00252000
         ST    @10,ALTINDEX                                        0053 00253000
*   ALTINDEX=ALTINDEX*3;            /*                       @Y30LB12*/ 00254000
         MH    @10,@CH00048                                        0054 00255000
         ST    @10,ALTINDEX                                        0054 00256000
*   ALTINDEX=ALTINDEX+WORKACI;      /*                       @Y30LB12*/ 00257000
         MVC   @ZT00003+3(1),WORKACI                               0055 00258000
         AL    @10,@ZT00003                                        0055 00259000
         ST    @10,ALTINDEX                                        0055 00260000
*   ERROR1='0'B;                    /*                       @Y30LB12*/ 00261000
         NI    ERROR1,B'10111111'                                  0056 00262000
*   IF RSGCPUID(ALTINDEX)^=RSGCPUID(DSINDEX)/*               @Y30LB12*/ 00263000
*     THEN                          /*                       @Y30LB12*/ 00264000
         LA    @05,9                                               0057 00265000
         LR    @01,@10                                             0057 00266000
         MR    @00,@05                                             0057 00267000
         L     @10,COMPTR2(,R4)                                    0057 00268000
         LR    @03,@05                                             0057 00269000
         M     @02,DSINDEX                                         0057 00270000
         ALR   @01,@10                                             0057 00271000
         ALR   @10,@03                                             0057 00272000
         CLC   RSGCPUID-9(5,@01),RSGCPUID-9(@10)                   0057 00273000
         BE    @RF00057                                            0057 00274000
*     CALL BADCPUID;                /*                       @Y30LB12*/ 00275000
         BAL   @14,BADCPUID                                        0058 00276000
*   ELSE                                                           0059 00277000
*     ;                             /*                       @Y30LB12*/ 00278000
@RF00057 DS    0H                                                  0060 00279000
*   IF RSGCUA(ALTINDEX)^=RSGCUA(DSINDEX)/*                   @Y30LB12*/ 00280000
*     THEN                          /*                       @Y30LB12*/ 00281000
         LA    @10,9                                               0060 00282000
         L     @01,ALTINDEX                                        0060 00283000
         MR    @00,@10                                             0060 00284000
         L     @05,COMPTR2(,R4)                                    0060 00285000
         LR    @03,@10                                             0060 00286000
         M     @02,DSINDEX                                         0060 00287000
         ALR   @01,@05                                             0060 00288000
         ALR   @05,@03                                             0060 00289000
         CLC   RSGCUA-9(1,@01),RSGCUA-9(@05)                       0060 00290000
         BE    @RF00060                                            0060 00291000
*     CALL BADCUID;                 /*                       @Y30LB12*/ 00292000
         BAL   @14,BADCUID                                         0061 00293000
*   ELSE                                                           0062 00294000
*     ;                             /*                       @Y30LB12*/ 00295000
@RF00060 DS    0H                                                  0063 00296000
*   IF RSGCHAN(ALTINDEX)<=RSGCHAN(DSINDEX)/*                 @Y30LB12*/ 00297000
*       |RSGCHAN(ALTINDEX)^=WORKACH /*                       @Y30LB12*/ 00298000
*     THEN                          /*                       @Y30LB12*/ 00299000
         LA    @10,9                                               0063 00300000
         L     @01,ALTINDEX                                        0063 00301000
         MR    @00,@10                                             0063 00302000
         L     @05,COMPTR2(,R4)                                    0063 00303000
         LR    @03,@10                                             0063 00304000
         M     @02,DSINDEX                                         0063 00305000
         ST    @01,@TF00001                                        0063 00306000
         ALR   @01,@05                                             0063 00307000
         ALR   @03,@05                                             0063 00308000
         CLC   RSGCHAN-9(1,@01),RSGCHAN-9(@03)                     0063 00309000
         BNH   @RT00063                                            0063 00310000
         L     @10,@TF00001                                        0063 00311000
         SLR   @15,@15                                             0063 00312000
         IC    @15,RSGCHAN-9(@10,@05)                              0063 00313000
         MVC   @ZT00003+3(1),WORKACH                               0063 00314000
         C     @15,@ZT00003                                        0063 00315000
         BE    @RF00063                                            0063 00316000
@RT00063 DS    0H                                                  0064 00317000
*     CALL BADCHAN;                 /*                       @Y30LB12*/ 00318000
         BAL   @14,BADCHAN                                         0064 00319000
*   ELSE                                                           0065 00320000
*     ;                             /*                       @Y30LB12*/ 00321000
@RF00063 DS    0H                                                  0066 00322000
*   IF ERROR1='0'B                  /*                       @Y30LB12*/ 00323000
*     THEN                          /*                       @Y30LB12*/ 00324000
         TM    ERROR1,B'01000000'                                  0066 00325000
         BNZ   @RF00066                                            0066 00326000
*     CALL CHECKDEV;                /*                       @Y30LB12*/ 00327000
         BAL   @14,CHECKDEV                                        0067 00328000
*   ELSE                                                           0068 00329000
*     ;                             /*                       @Y30LB12*/ 00330000
@RF00066 DS    0H                                                  0069 00331000
*   END CHKPATH;                    /*                       @Y30LB12*/ 00332000
@EL00002 DS    0H                                                  0069 00333000
@EF00002 DS    0H                                                  0069 00334000
@ER00002 LM    @14,@12,@SA00002                                    0069 00335000
         BR    @14                                                 0069 00336000
*                                                                  0070 00337000
*/********************************************************** @Y30LB12*/ 00338000
*/*                                                          @Y30LB12*/ 00339000
*/* PROCEDURE NAME - BADCPUID                                @Y30LB12*/ 00340000
*/*                                                          @Y30LB12*/ 00341000
*/* FUNCTION - ENTER MISSING DATA INTO ERROR MESSAGE ICG312I @YD00113*/ 00342000
*/*            AND CALL 'PUTIT1' TO WRITE MESSAGE            @YD00113*/ 00343000
*/*                                                          @YD00113*/ 00344000
*/*            TEXT OF MESSAGE ICG312I:                      @YD00113*/ 00345000
*/*            ICG312I CPUID NONMATCH, PRIMARY PATHS SA X    @YD00113*/ 00346000
*/*                    INT X, ALTERNATE PATH SA X INT X      @YD00113*/ 00347000
*/*                                                          @Y30LB12*/ 00348000
*/********************************************************** @Y30LB12*/ 00349000
*                                                                  0070 00350000
*BADCPUID:                                                         0070 00351000
*   PROCEDURE;                      /*                       @Y30LB12*/ 00352000
BADCPUID STM   @14,@12,@SA00003                                    0070 00353000
*   ERROR1='1'B;                    /* SET LOCAL ERR FLG     @Y30LB12*/ 00354000
         OI    ERROR1,B'01000000'                                  0071 00355000
*   CALL GETPRIID;                  /*                       @Y30LB12*/ 00356000
         BAL   @14,GETPRIID                                        0072 00357000
*   OUTBUF2(1:82)=ICGDS312;         /*                       @Y30LB12*/ 00358000
         MVC   OUTBUF2(82,R4),ICGDS312                             0073 00359000
*   OUTBUF2(42)=PRIDS;              /*                       @Y30LB12*/ 00360000
         MVC   OUTBUF2+41(1,R4),PRIDS                              0074 00361000
*   OUTBUF2(48)=PRICI;              /*                       @Y30LB12*/ 00362000
         MVC   OUTBUF2+47(1,R4),PRICI                              0075 00363000
*   OUTBUF2(69)=ALTDS;              /*                       @Y30LB12*/ 00364000
         MVC   OUTBUF2+68(1,R4),ALTDS                              0076 00365000
*   OUTBUF2(75)=ALTCI;              /*                       @Y30LB12*/ 00366000
         MVC   OUTBUF2+74(1,R4),ALTCI                              0077 00367000
*   OUTBUF2(81:82)=TWOCHAR(DEVINDEX);/*                      @Y30LB12*/ 00368000
         L     @10,DEVINDEX                                        0078 00369000
         ALR   @10,@10                                             0078 00370000
         LA    @05,TWOCHAR-2(@10)                                  0078 00371000
         MVC   OUTBUF2+80(2,R4),0(@05)                             0078 00372000
*   CALL PUTIT1;                    /*                       @Y30LB12*/ 00373000
         BAL   @14,PUTIT1                                          0079 00374000
*   END BADCPUID;                   /*                       @Y30LB12*/ 00375000
@EL00003 DS    0H                                                  0080 00376000
@EF00003 DS    0H                                                  0080 00377000
@ER00003 LM    @14,@12,@SA00003                                    0080 00378000
         BR    @14                                                 0080 00379000
*                                                                  0081 00380000
*/********************************************************** @Y30LB12*/ 00381000
*/*                                                          @Y30LB12*/ 00382000
*/* PROCEDURE NAME - BADCUID                                 @Y30LB12*/ 00383000
*/*                                                          @Y30LB12*/ 00384000
*/* FUNCTION - ENTER MISSING DATA INTO ERROR MESSAGE ICG313I @YD00113*/ 00385000
*/*            AND CALL 'PUTIT1' TO WRITE MESSAGE            @YD00113*/ 00386000
*/*                                                          @YD00113*/ 00387000
*/*            TEXT OF MESSAGE ICG313I:                      @YD00113*/ 00388000
*/*            ICG313I CUID NONMATCH, PRIMARY PATH SA X      @YD00113*/ 00389000
*/*                    INT X, ALTERNATE PATH SA X INT X      @YD00113*/ 00390000
*/*                                                          @Y30LB12*/ 00391000
*/********************************************************** @Y30LB12*/ 00392000
*                                                                  0081 00393000
*BADCUID:                                                          0081 00394000
*   PROCEDURE;                      /*                       @Y30LB12*/ 00395000
BADCUID  STM   @14,@12,@SA00004                                    0081 00396000
*   ERROR1='1'B;                    /* SET LOCAL ERR FLG     @Y30LB12*/ 00397000
         OI    ERROR1,B'01000000'                                  0082 00398000
*   CALL GETPRIID;                  /*                       @Y30LB12*/ 00399000
         BAL   @14,GETPRIID                                        0083 00400000
*   OUTBUF2(1:81)=ICGDS313;         /*                       @Y30LB12*/ 00401000
         MVC   OUTBUF2(81,R4),ICGDS313                             0084 00402000
*   OUTBUF2(41)=PRIDS;              /*                       @Y30LB12*/ 00403000
         MVC   OUTBUF2+40(1,R4),PRIDS                              0085 00404000
*   OUTBUF2(47)=PRICI;              /*                       @Y30LB12*/ 00405000
         MVC   OUTBUF2+46(1,R4),PRICI                              0086 00406000
*   OUTBUF2(68)=ALTDS;              /*                       @Y30LB12*/ 00407000
         MVC   OUTBUF2+67(1,R4),ALTDS                              0087 00408000
*   OUTBUF2(74)=ALTCI;              /*                       @Y30LB12*/ 00409000
         MVC   OUTBUF2+73(1,R4),ALTCI                              0088 00410000
*   OUTBUF2(80:81)=TWOCHAR(DEVINDEX);/*                      @Y30LB12*/ 00411000
         L     @10,DEVINDEX                                        0089 00412000
         ALR   @10,@10                                             0089 00413000
         LA    @05,TWOCHAR-2(@10)                                  0089 00414000
         MVC   OUTBUF2+79(2,R4),0(@05)                             0089 00415000
*   CALL PUTIT1;                    /*                       @Y30LB12*/ 00416000
         BAL   @14,PUTIT1                                          0090 00417000
*   END BADCUID;                    /*                       @Y30LB12*/ 00418000
@EL00004 DS    0H                                                  0091 00419000
@EF00004 DS    0H                                                  0091 00420000
@ER00004 LM    @14,@12,@SA00004                                    0091 00421000
         BR    @14                                                 0091 00422000
*                                                                  0092 00423000
*/********************************************************** @Y30LB12*/ 00424000
*/*                                                          @Y30LB12*/ 00425000
*/* PROCEDURE NAME - BADCHAN                                 @Y30LB12*/ 00426000
*/*                                                          @Y30LB12*/ 00427000
*/* FUNCTION - ENTER MISSING DATA INTO ERROR MESSAGE ICG314I @YD00113*/ 00428000
*/*            AND CALL 'PUTIT1' TO WRITE MESSAGE            @YD00113*/ 00429000
*/*                                                          @YD00113*/ 00430000
*/*            TEXT OF MESSAGE ICG314I:                      @YD00113*/ 00431000
*/*            ICG314I CHANNEL ERROR, PRIMARY PATH SA X      @YD00113*/ 00432000
*/*                    INT X, ALTERNATE PATH SA X INT X      @YD00113*/ 00433000
*/*                                                          @Y30LB12*/ 00434000
*/********************************************************** @Y30LB12*/ 00435000
*                                                                  0092 00436000
*BADCHAN:                                                          0092 00437000
*   PROCEDURE;                      /*                       @Y30LB12*/ 00438000
BADCHAN  STM   @14,@12,@SA00005                                    0092 00439000
*   ERROR1='1'B;                    /* SET LOCAL ERR FLG     @Y30LB12*/ 00440000
         OI    ERROR1,B'01000000'                                  0093 00441000
*   CALL GETPRIID;                  /*                       @Y30LB12*/ 00442000
         BAL   @14,GETPRIID                                        0094 00443000
*   OUTBUF2(1:81)=ICGDS314;         /*                       @Y30LB12*/ 00444000
         MVC   OUTBUF2(81,R4),ICGDS314                             0095 00445000
*   OUTBUF2(41)=PRIDS;              /*                       @Y30LB12*/ 00446000
         MVC   OUTBUF2+40(1,R4),PRIDS                              0096 00447000
*   OUTBUF2(47)=PRICI;              /*                       @Y30LB12*/ 00448000
         MVC   OUTBUF2+46(1,R4),PRICI                              0097 00449000
*   OUTBUF2(68)=ALTDS;              /*                       @Y30LB12*/ 00450000
         MVC   OUTBUF2+67(1,R4),ALTDS                              0098 00451000
*   OUTBUF2(74)=ALTCI;              /*                       @Y30LB12*/ 00452000
         MVC   OUTBUF2+73(1,R4),ALTCI                              0099 00453000
*   OUTBUF2(80:81)=TWOCHAR(DEVINDEX);/*                      @Y30LB12*/ 00454000
         L     @10,DEVINDEX                                        0100 00455000
         ALR   @10,@10                                             0100 00456000
         LA    @05,TWOCHAR-2(@10)                                  0100 00457000
         MVC   OUTBUF2+79(2,R4),0(@05)                             0100 00458000
*   CALL PUTIT1;                    /*                       @Y30LB12*/ 00459000
         BAL   @14,PUTIT1                                          0101 00460000
*   END BADCHAN;                    /*                       @Y30LB12*/ 00461000
@EL00005 DS    0H                                                  0102 00462000
@EF00005 DS    0H                                                  0102 00463000
@ER00005 LM    @14,@12,@SA00005                                    0102 00464000
         BR    @14                                                 0102 00465000
*                                                                  0103 00466000
*/********************************************************** @Y30LB12*/ 00467000
*/*                                                          @Y30LB12*/ 00468000
*/* PROCEDURE NAME - CHECKDEV                                @Y30LB12*/ 00469000
*/*                                                          @Y30LB12*/ 00470000
*/* FUNCTION - VERIFY THAT THE DEVICE ON THE ALTERNATE       @Y30LB12*/ 00471000
*/*            PATH WAS NOT DESCRIBED IN AN UUPERCON         @Y30LB12*/ 00472000
*/*            CONTROL STATEMENT FOR THE PRIMARY PATH        @Y30LB12*/ 00473000
*/*            AS HAVING SOME OTHER USE, AND THAT THE        @Y30LB12*/ 00474000
*/*            DEVICE WAS NOT PREVIOUSLY SPECIFIED AS        @Y30LB12*/ 00475000
*/*            AN ALTERNATE PATH.                            @Y30LB12*/ 00476000
*/*                                                          @Y30LB12*/ 00477000
*/********************************************************** @Y30LB12*/ 00478000
*                                                                  0103 00479000
*CHECKDEV:                                                         0103 00480000
*   PROCEDURE;                      /*                       @Y30LB12*/ 00481000
CHECKDEV STM   @14,@12,@SA00006                                    0103 00482000
*   IF USESPEC(ALTINDEX,DEVINDEX)^='1'B/* NOT USED           @Y30LB12*/ 00483000
*     THEN                          /*                       @Y30LB12*/ 00484000
         L     @10,ALTINDEX                                        0104 00485000
         SLA   @10,6                                               0104 00486000
         AL    @10,DEVINDEX                                        0104 00487000
         MH    @10,@CH00246                                        0104 00488000
         L     @05,COMPTR2(,R4)                                    0104 00489000
         ST    @10,@TF00001                                        0104 00490000
         ALR   @10,@05                                             0104 00491000
         AL    @10,@CF00512                                        0104 00492000
         TM    USESPEC-464(@10),B'10000000'                        0104 00493000
         BO    @RF00104                                            0104 00494000
*     DO;                           /*                       @Y30LB12*/ 00495000
*                                                                  0105 00496000
*       /*************************************************************/ 00497000
*       /*                                                           */ 00498000
*       /* *****************************************         @Y30LB12*/ 00499000
*       /* SET ADDRESS USED AND ADDRESS USED AS              @Y30LB12*/ 00500000
*       /* ALTERNATE PATH.                                   @Y30LB12*/ 00501000
*       /* SAVE THE CHANNEL OF THE PRIMARY PATH IN           @OZ11685*/ 00502000
*       /* THE FIELD 'ALTCH3' OF THE ALTERNATE.              @OZ11685*/ 00503000
*       /* *****************************************         @Y30LB12*/ 00504000
*       /*                                                           */ 00505000
*       /*************************************************************/ 00506000
*                                                                  0106 00507000
*       USESPEC(ALTINDEX,DEVINDEX)='1'B;/*                   @Y30LB12*/ 00508000
*       ITISALTP(ALTINDEX,DEVINDEX)='1'B;/*                  @Y30LB12*/ 00509000
         LR    @10,@05                                             0107 00510000
         AL    @10,@TF00001                                        0107 00511000
         AL    @10,@CF00512                                        0107 00512000
         OI    USESPEC-464(@10),B'10000010'                        0107 00513000
*       IF VS2LOCAL='1'B            /*                       @ZA14742*/ 00514000
*         THEN                      /*                       @ZA14742*/ 00515000
         TM    VS2LOCAL,B'00100000'                                0108 00516000
         BNO   @RF00108                                            0108 00517000
*         ALTCH3(ALTINDEX,DEVINDEX)=RSGCHAN(DSINDEX);/*      @OZ11685*/ 00518000
         LR    @10,@05                                             0109 00519000
         AL    @10,@TF00001                                        0109 00520000
         AL    @10,@CF00513                                        0109 00521000
         L     @15,DSINDEX                                         0109 00522000
         MH    @15,@CH00112                                        0109 00523000
         ALR   @05,@15                                             0109 00524000
         MVC   ALTCH3-474(1,@10),RSGCHAN-9(@05)                    0109 00525000
*       ELSE                                                       0110 00526000
*         ;                         /*                       @ZA14742*/ 00527000
@RF00108 DS    0H                                                  0111 00528000
*     END;                          /*                       @Y30LB12*/ 00529000
*   ELSE                            /*                       @Y30LB12*/ 00530000
*     DO;                           /*                       @Y30LB12*/ 00531000
*                                                                  0112 00532000
         B     @RC00104                                            0112 00533000
@RF00104 DS    0H                                                  0113 00534000
*       /*************************************************************/ 00535000
*       /*                                                           */ 00536000
*       /* *****************************************         @Y30LB12*/ 00537000
*       /* ICG315I ALTERNATE PATH SA X INT X DEV             @Y30LB12*/ 00538000
*       /* XX OF PRIMARY SA X INT X ALREADY USED             @Y30LB12*/ 00539000
*       /* AS (VIRTUAL PRIMARY/REAL/                         @Y30LB12*/ 00540000
*       /* CONVERTIBLE/ALTERNATE PATH)                       @Y30LB12*/ 00541000
*       /* *****************************************         @Y30LB12*/ 00542000
*       /*                                                           */ 00543000
*       /*************************************************************/ 00544000
*                                                                  0113 00545000
*       CALL GETPRIID;              /*                       @Y30LB12*/ 00546000
         BAL   @14,GETPRIID                                        0113 00547000
*       OUTBUF2(1:85)=ICGDS315;     /*                       @Y30LB12*/ 00548000
         MVC   OUTBUF2(85,R4),ICGDS315                             0114 00549000
*       OUTBUF2(28)=ALTDS;          /*                       @Y30LB12*/ 00550000
         MVC   OUTBUF2+27(1,R4),ALTDS                              0115 00551000
*       OUTBUF2(34)=ALTCI;          /*                       @Y30LB12*/ 00552000
         MVC   OUTBUF2+33(1,R4),ALTCI                              0116 00553000
*       OUTBUF2(40:41)=TWOCHAR(DEVINDEX);/*                  @Y30LB12*/ 00554000
         L     @10,DEVINDEX                                        0117 00555000
         LR    @05,@10                                             0117 00556000
         ALR   @05,@05                                             0117 00557000
         LA    @01,TWOCHAR-2(@05)                                  0117 00558000
         MVC   OUTBUF2+39(2,R4),0(@01)                             0117 00559000
*       OUTBUF2(57)=PRIDS;          /*                       @Y30LB12*/ 00560000
         MVC   OUTBUF2+56(1,R4),PRIDS                              0118 00561000
*       OUTBUF2(63)=PRICI;          /*                       @Y30LB12*/ 00562000
         MVC   OUTBUF2+62(1,R4),PRICI                              0119 00563000
*       IF USEV(ALTINDEX,DEVINDEX)='1'B/*                    @Y30LB12*/ 00564000
*           |USEVS(ALTINDEX,DEVINDEX)='1'B/*                 @Y30LB12*/ 00565000
*         THEN                      /*                       @Y30LB12*/ 00566000
         L     @05,ALTINDEX                                        0120 00567000
         SLA   @05,6                                               0120 00568000
         ALR   @05,@10                                             0120 00569000
         MH    @05,@CH00246                                        0120 00570000
         L     @10,COMPTR2(,R4)                                    0120 00571000
         ALR   @10,@05                                             0120 00572000
         AL    @10,@CF00512                                        0120 00573000
         TM    USEV-464(@10),B'01100000'                           0120 00574000
         BZ    @RF00120                                            0120 00575000
*         OUTBUF2(86:100)='VIRTUAL PRIMARY';/*               @Y30LB12*/ 00576000
         MVC   OUTBUF2+85(15,R4),@CC00476                          0121 00577000
*       ELSE                                                       0122 00578000
*         ;                         /*                       @Y30LB12*/ 00579000
@RF00120 DS    0H                                                  0123 00580000
*       IF USEREAL(ALTINDEX,DEVINDEX)='1'B/*                 @Y30LB12*/ 00581000
*         THEN                      /*                       @Y30LB12*/ 00582000
         L     @10,ALTINDEX                                        0123 00583000
         SLA   @10,6                                               0123 00584000
         AL    @10,DEVINDEX                                        0123 00585000
         MH    @10,@CH00246                                        0123 00586000
         L     @05,COMPTR2(,R4)                                    0123 00587000
         ALR   @05,@10                                             0123 00588000
         AL    @05,@CF00512                                        0123 00589000
         TM    USEREAL-464(@05),B'00010000'                        0123 00590000
         BNO   @RF00123                                            0123 00591000
*         OUTBUF2(86:89)='REAL';    /*                       @Y30LB12*/ 00592000
         MVC   OUTBUF2+85(4,R4),@CC00479                           0124 00593000
*       ELSE                                                       0125 00594000
*         ;                         /*                       @Y30LB12*/ 00595000
@RF00123 DS    0H                                                  0126 00596000
*       IF USECONVR(ALTINDEX,DEVINDEX)='1'B/*                @Y30LB12*/ 00597000
*         THEN                      /*                       @Y30LB12*/ 00598000
         L     @10,ALTINDEX                                        0126 00599000
         SLA   @10,6                                               0126 00600000
         AL    @10,DEVINDEX                                        0126 00601000
         MH    @10,@CH00246                                        0126 00602000
         L     @05,COMPTR2(,R4)                                    0126 00603000
         ALR   @05,@10                                             0126 00604000
         AL    @05,@CF00512                                        0126 00605000
         TM    USECONVR-464(@05),B'00000100'                       0126 00606000
         BNO   @RF00126                                            0126 00607000
*         OUTBUF2(86:96)='CONVERTIBLE';/*                    @Y30LB12*/ 00608000
         MVC   OUTBUF2+85(11,R4),@CC00480                          0127 00609000
*       ELSE                                                       0128 00610000
*         ;                         /*                       @Y30LB12*/ 00611000
@RF00126 DS    0H                                                  0129 00612000
*       IF ITISALTP(ALTINDEX,DEVINDEX)='1'B/*                @Y30LB12*/ 00613000
*         THEN                      /*                       @Y30LB12*/ 00614000
         L     @10,ALTINDEX                                        0129 00615000
         SLA   @10,6                                               0129 00616000
         AL    @10,DEVINDEX                                        0129 00617000
         MH    @10,@CH00246                                        0129 00618000
         L     @05,COMPTR2(,R4)                                    0129 00619000
         ALR   @05,@10                                             0129 00620000
         AL    @05,@CF00512                                        0129 00621000
         TM    ITISALTP-464(@05),B'00000010'                       0129 00622000
         BNO   @RF00129                                            0129 00623000
*         OUTBUF2(86:99)='ALTERNATE PATH';/*                 @Y30LB12*/ 00624000
         MVC   OUTBUF2+85(14,R4),@CC00483                          0130 00625000
*       ELSE                                                       0131 00626000
*         ;                         /*                       @Y30LB12*/ 00627000
@RF00129 DS    0H                                                  0132 00628000
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/ 00629000
         BAL   @14,PUTIT1                                          0132 00630000
*     END;                          /*                       @Y30LB12*/ 00631000
*   END CHECKDEV;                   /* RETURN TO CHKPATH     @Y30LB12*/ 00632000
@EL00006 DS    0H                                                  0134 00633000
@EF00006 DS    0H                                                  0134 00634000
@ER00006 LM    @14,@12,@SA00006                                    0134 00635000
         BR    @14                                                 0134 00636000
*                                                                  0135 00637000
*/********************************************************** @Y30LB12*/ 00638000
*/*                                                          @Y30LB12*/ 00639000
*/* PROCEDURE NAME - GETPRIID                                @Y30LB12*/ 00640000
*/*                                                          @Y30LB12*/ 00641000
*/* FUNCTION - CONVERT DSINDEX INTO TWO CONPONENTS -         @Y30LB12*/ 00642000
*/*            DATA STAGER AND CHANNEL INTERFACE -           @Y30LB12*/ 00643000
*/*            SO THAT THE PRIMARY PATH IN QUESTION          @Y30LB12*/ 00644000
*/*            CAN BE IDENTIFIED IN MESSAGE TEXT.            @Y30LB12*/ 00645000
*/*                                                          @Y30LB12*/ 00646000
*/********************************************************** @Y30LB12*/ 00647000
*                                                                  0135 00648000
*GETPRIID:                                                         0135 00649000
*   PROCEDURE;                      /*                       @Y30LB12*/ 00650000
GETPRIID STM   @14,@12,12(@13)                                     0135 00651000
*   PRIPAT=PATTERN(DSINDEX);        /* PRINTABLE DS/CI       @Y30LB12*/ 00652000
         L     @10,DSINDEX                                         0136 00653000
         ALR   @10,@10                                             0136 00654000
         LA    @05,PATTERN-2(@10)                                  0136 00655000
         MVC   PRIPAT(2),0(@05)                                    0136 00656000
*   PRIDS=PRIPAT(1);                /* PRIMARY DS            @Y30LB12*/ 00657000
         MVC   PRIDS(1),PRIPAT                                     0137 00658000
*   PRICI=PRIPAT(2);                /* PRIMARY CI            @Y30LB12*/ 00659000
         MVC   PRICI(1),PRIPAT+1                                   0138 00660000
*   ALTPAT=PATTERN(ALTINDEX);       /* PRINTABLE DS/CI       @Y30LB12*/ 00661000
         L     @10,ALTINDEX                                        0139 00662000
         ALR   @10,@10                                             0139 00663000
         LA    @05,PATTERN-2(@10)                                  0139 00664000
         MVC   ALTPAT(2),0(@05)                                    0139 00665000
*   ALTDS=ALTPAT(1);                /* ALTERNATE DS          @Y30LB12*/ 00666000
         MVC   ALTDS(1),ALTPAT                                     0140 00667000
*   ALTCI=ALTPAT(2);                /* ALTERNATE CI          @Y30LB12*/ 00668000
         MVC   ALTCI(1),ALTPAT+1                                   0141 00669000
*   END GETPRIID;                   /* RETURN TO CALLER      @Y30LB12*/ 00670000
@EL00007 DS    0H                                                  0142 00671000
@EF00007 DS    0H                                                  0142 00672000
@ER00007 LM    @14,@12,12(@13)                                     0142 00673000
         BR    @14                                                 0142 00674000
*                                                                  0143 00675000
*/***********************************************************@Y30LB12*/ 00676000
*/*                                                          @Y30LB12*/ 00677000
*/* PROCEDURE NAME - PUTIT1                                  @Y30LB12*/ 00678000
*/*                                                          @Y30LB12*/ 00679000
*/* FUNCTION - CALL ICGDSMSG, MESSAGE PRINT SUBROUTINE, TO   @Y30LB12*/ 00680000
*/*            PUT TERMINATING MESSAGE FOR WHICH TEXT IS NOT @Y30LB12*/ 00681000
*/*            IN ICGDSMSG BUT ALREADY BUILT IN 'OUTBUF2'    @Y30LB12*/ 00682000
*/*                                                          @Y30LB12*/ 00683000
*/***********************************************************@Y30LB12*/ 00684000
*                                                                  0143 00685000
*PUTIT1:                                                           0143 00686000
*   PROCEDURE;                      /*                       @Y30LB12*/ 00687000
PUTIT1   STM   @14,@12,@SA00008                                    0143 00688000
*   STOPSCAN='1'B;                  /*                       @Y30LB12*/ 00689000
         OI    STOPSCAN,B'10000000'                                0144 00690000
*   PRNTBUF2='1'B;                  /*                       @Y30LB12*/ 00691000
         OI    PRNTBUF2(R4),B'00000001'                            0145 00692000
*   TERMINAT=TERMINAT+1;            /*                       @Y30LB12*/ 00693000
         LA    @10,1                                               0146 00694000
         AH    @10,TERMINAT(,R4)                                   0146 00695000
         STH   @10,TERMINAT(,R4)                                   0146 00696000
*   GEN(LINK  EP=ICGDSMSG);         /*                       @Y30LB12*/ 00697000
         LINK  EP=ICGDSMSG                                              00698000
*   PRNTBUF2='0'B;                  /*                       @Y30LB12*/ 00699000
         NI    PRNTBUF2(R4),B'11111110'                            0148 00700000
*   END PUTIT1;                     /*                       @Y30LB12*/ 00701000
@EL00008 DS    0H                                                  0149 00702000
@EF00008 DS    0H                                                  0149 00703000
@ER00008 LM    @14,@12,@SA00008                                    0149 00704000
         BR    @14                                                 0149 00705000
*                                                                  0150 00706000
*/********************************************************** @Y30LB12*/ 00707000
*/*                  P A T C H   A R E A                     @Y30LB12*/ 00708000
*/********************************************************** @Y30LB12*/ 00709000
*                                                                  0150 00710000
*   GENERATE;                                                      0150 00711000
*                                                         /*@Y30LB12*/  00712000
PATCHA05 DC    32C'PATCHA05'                              /*@Y30LB12*/  00713000
*   END ICGDSA05                    /*                       @Y30LB12*/ 00714000
*                                                                  0151 00715000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 00716000
*/*%INCLUDE SYSLIB  (ICGDSMAC)                                       */ 00717000
*/*%INCLUDE SYSLIB  (ICGDSMA2)                                       */ 00718000
*                                                                  0151 00719000
*       ;                                                          0151 00720000
         B     @EL00001                                            0151 00721000
@DATA    DS    0H                                                       00722000
@CH00048 DC    H'3'                                                     00723000
@CH00112 DC    H'9'                                                     00724000
@CH00246 DC    H'11'                                                    00725000
@CH00235 DC    H'48'                                                    00726000
@CH00245 DC    H'64'                                                    00727000
@DATD    DSECT                                                          00728000
         DS    0F                                                       00729000
@SA00001 DS    18F                                                      00730000
@SA00002 DS    15F                                                      00731000
@SA00008 DS    15F                                                      00732000
@SA00003 DS    15F                                                      00733000
@SA00004 DS    15F                                                      00734000
@SA00005 DS    15F                                                      00735000
@SA00006 DS    15F                                                      00736000
@TF00001 DS    F                                                        00737000
@ZTEMPS  DS    0F                                                       00738000
@ZT00003 DC    F'0'                                                     00739000
@ZTEMPND EQU   *                                                        00740000
@ZLEN    EQU   @ZTEMPND-@ZTEMPS                                         00741000
ICGDSA05 CSECT                                                          00742000
         DS    0F                                                       00743000
@CF00512 DC    F'-251'                                                  00744000
@CF00507 DC    F'-249'                                                  00745000
@CF00508 DC    F'-246'                                                  00746000
@CF00509 DC    F'-243'                                                  00747000
@CF00513 DC    F'-241'                                                  00748000
@DATD    DSECT                                                          00749000
         DS    0D                                                       00750000
A05WORKA DS    CL26                                                     00751000
         ORG   A05WORKA                                                 00752000
DSINDEX  DS    FL4                                                      00753000
DEVINDEX DS    FL4                                                      00754000
ALTINDEX DS    FL4                                                      00755000
WORKPATH DS    CL3                                                      00756000
         ORG   WORKPATH                                                 00757000
WORKADS  DS    FL1                                                      00758000
WORKACI  DS    FL1                                                      00759000
WORKACH  DS    FL1                                                      00760000
         ORG   A05WORKA+15                                              00761000
A05FLAGS DS    CL1                                                      00762000
         ORG   A05FLAGS                                                 00763000
STOPSCAN DS    BL1                                                      00764000
ERROR1   EQU   A05FLAGS+0                                               00765000
VS2LOCAL EQU   A05FLAGS+0                                               00766000
@NM00020 EQU   A05FLAGS+0                                               00767000
         ORG   A05WORKA+16                                              00768000
WORKRSG  DS    CL1                                                      00769000
PRIPAT   DS    CL2                                                      00770000
PRIDS    DS    CL1                                                      00771000
PRICI    DS    CL1                                                      00772000
ALTPAT   DS    CL2                                                      00773000
ALTDS    DS    CL1                                                      00774000
ALTCI    DS    CL1                                                      00775000
PRNTPATH DS    CL1                                                      00776000
         ORG   A05WORKA+26                                              00777000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                00778000
@ENDDATD EQU   *                                                        00779000
ICGDSA05 CSECT                                                          00780000
         DS    0F                                                       00781000
@SIZDATD DC    AL1(0)                                                   00782000
         DC    AL3(@ENDDATD-@DATD)                                      00783000
         DS    0D                                                       00784000
@CC00476 DC    C'VIRTUAL PRIMARY'                                       00785000
@CC00483 DC    C'ALTERNATE PATH'                                        00786000
@CC00480 DC    C'CONVERTIBLE'                                           00787000
@CC00479 DC    C'REAL'                                                  00788000
@CB00436 DC    X'000000'                                                00789000
ICGDS312 DC    CL82' ICG312I CPUID NONMATCH, PRIMARY PATH SA X INT X, AC00790000
               LTERNATE PATH SA X INT X DEV XX'                         00791000
ICGDS313 DC    CL81' ICG313I CUID NONMATCH, PRIMARY PATH SA X INT X, ALC00792000
               TERNATE PATH SA X INT X DEV XX'                          00793000
ICGDS314 DC    CL81' ICG314I CHANNEL ERROR, PRIMARY PATH SA X INT X, ALC00794000
               TERNATE PATH SA X INT X DEV XX'                          00795000
ICGDS315 DC    CL85' ICG315I ALTERNATE PATH SA X INT X DEV XX OF PRIMARC00796000
               Y SA X INT X ALREADY SPECIFIED AS '                      00797000
ICGDS340 DC    CL56' ICG340I FOR SA X INT X DEV XX, TOO MANY ALTERNATE C00798000
               PATHS'                                                   00799000
TWOCHAR  DC    CL2'00'                                                  00800000
         DC    CL2'01'                                                  00801000
         DC    CL2'02'                                                  00802000
         DC    CL2'03'                                                  00803000
         DC    CL2'04'                                                  00804000
         DC    CL2'05'                                                  00805000
         DC    CL2'06'                                                  00806000
         DC    CL2'07'                                                  00807000
         DC    CL2'08'                                                  00808000
         DC    CL2'09'                                                  00809000
         DC    CL2'0A'                                                  00810000
         DC    CL2'0B'                                                  00811000
         DC    CL2'0C'                                                  00812000
         DC    CL2'0D'                                                  00813000
         DC    CL2'0E'                                                  00814000
         DC    CL2'0F'                                                  00815000
         DC    CL2'10'                                                  00816000
         DC    CL2'11'                                                  00817000
         DC    CL2'12'                                                  00818000
         DC    CL2'13'                                                  00819000
         DC    CL2'14'                                                  00820000
         DC    CL2'15'                                                  00821000
         DC    CL2'16'                                                  00822000
         DC    CL2'17'                                                  00823000
         DC    CL2'18'                                                  00824000
         DC    CL2'19'                                                  00825000
         DC    CL2'1A'                                                  00826000
         DC    CL2'1B'                                                  00827000
         DC    CL2'1C'                                                  00828000
         DC    CL2'1D'                                                  00829000
         DC    CL2'1E'                                                  00830000
         DC    CL2'1F'                                                  00831000
         DC    CL2'20'                                                  00832000
         DC    CL2'21'                                                  00833000
         DC    CL2'22'                                                  00834000
         DC    CL2'23'                                                  00835000
         DC    CL2'24'                                                  00836000
         DC    CL2'25'                                                  00837000
         DC    CL2'26'                                                  00838000
         DC    CL2'27'                                                  00839000
         DC    CL2'28'                                                  00840000
         DC    CL2'29'                                                  00841000
         DC    CL2'2A'                                                  00842000
         DC    CL2'2B'                                                  00843000
         DC    CL2'2C'                                                  00844000
         DC    CL2'2D'                                                  00845000
         DC    CL2'2E'                                                  00846000
         DC    CL2'2F'                                                  00847000
         DC    CL2'30'                                                  00848000
         DC    CL2'31'                                                  00849000
         DC    CL2'32'                                                  00850000
         DC    CL2'33'                                                  00851000
         DC    CL2'34'                                                  00852000
         DC    CL2'35'                                                  00853000
         DC    CL2'36'                                                  00854000
         DC    CL2'37'                                                  00855000
         DC    CL2'38'                                                  00856000
         DC    CL2'39'                                                  00857000
         DC    CL2'3A'                                                  00858000
         DC    CL2'3B'                                                  00859000
         DC    CL2'3C'                                                  00860000
         DC    CL2'3D'                                                  00861000
         DC    CL2'3E'                                                  00862000
         DC    CL2'3F'                                                  00863000
PATTERN  DC    CL2'0B'                                                  00864000
         DC    CL2'0C'                                                  00865000
         DC    CL2'0D'                                                  00866000
         DC    CL2'1B'                                                  00867000
         DC    CL2'1C'                                                  00868000
         DC    CL2'1D'                                                  00869000
         DC    CL2'2B'                                                  00870000
         DC    CL2'2C'                                                  00871000
         DC    CL2'2D'                                                  00872000
         DC    CL2'3B'                                                  00873000
         DC    CL2'3C'                                                  00874000
         DC    CL2'3D'                                                  00875000
         DC    CL2'4B'                                                  00876000
         DC    CL2'4C'                                                  00877000
         DC    CL2'4D'                                                  00878000
         DC    CL2'5B'                                                  00879000
         DC    CL2'5C'                                                  00880000
         DC    CL2'5D'                                                  00881000
         DC    CL2'6B'                                                  00882000
         DC    CL2'6C'                                                  00883000
         DC    CL2'6D'                                                  00884000
         DC    CL2'7B'                                                  00885000
         DC    CL2'7C'                                                  00886000
         DC    CL2'7D'                                                  00887000
         DC    CL2'8B'                                                  00888000
         DC    CL2'8C'                                                  00889000
         DC    CL2'8D'                                                  00890000
         DC    CL2'9B'                                                  00891000
         DC    CL2'9C'                                                  00892000
         DC    CL2'9D'                                                  00893000
         DC    CL2'AB'                                                  00894000
         DC    CL2'AC'                                                  00895000
         DC    CL2'AD'                                                  00896000
         DC    CL2'BB'                                                  00897000
         DC    CL2'BC'                                                  00898000
         DC    CL2'BD'                                                  00899000
         DC    CL2'CB'                                                  00900000
         DC    CL2'CC'                                                  00901000
         DC    CL2'CD'                                                  00902000
         DC    CL2'DB'                                                  00903000
         DC    CL2'DC'                                                  00904000
         DC    CL2'DD'                                                  00905000
         DC    CL2'EB'                                                  00906000
         DC    CL2'EC'                                                  00907000
         DC    CL2'ED'                                                  00908000
         DC    CL2'FB'                                                  00909000
         DC    CL2'FC'                                                  00910000
         DC    CL2'FD'                                                  00911000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00912000
@01      EQU   01                                                       00913000
@02      EQU   02                                                       00914000
@03      EQU   03                                                       00915000
@04      EQU   04                                                       00916000
@05      EQU   05                                                       00917000
@06      EQU   06                                                       00918000
@07      EQU   07                                                       00919000
@08      EQU   08                                                       00920000
@09      EQU   09                                                       00921000
@10      EQU   10                                                       00922000
@11      EQU   11                                                       00923000
@12      EQU   12                                                       00924000
@13      EQU   13                                                       00925000
@14      EQU   14                                                       00926000
@15      EQU   15                                                       00927000
R4       EQU   @04                                                      00928000
COMTAB   EQU   0                                                        00929000
READER   EQU   COMTAB+256                                               00930000
READFLAG EQU   READER+96                                                00931000
PCHBF    EQU   READER+99                                                00932000
STARTCOL EQU   READER+180                                               00933000
NEXTCOL  EQU   READER+184                                               00934000
PRINTER  EQU   COMTAB+464                                               00935000
OUTBUF2  EQU   PRINTER+225                                              00936000
MESSAGES EQU   COMTAB+810                                               00937000
TERMINAT EQU   MESSAGES+6                                               00938000
SPECLMSG EQU   MESSAGES+18                                              00939000
PRNTBUF2 EQU   SPECLMSG                                                 00940000
GENIO    EQU   COMTAB+832                                               00941000
DCBPTR   EQU   GENIO+4                                                  00942000
COMPTR2  EQU   GENIO+16                                                 00943000
INVOKED  EQU   COMTAB+856                                               00944000
SAVEDDS  EQU   INVOKED+4                                                00945000
BUILDRSG EQU   COMTAB+900                                               00946000
RSGS     EQU   BUILDRSG                                                 00947000
RSG      EQU   RSGS                                                     00948000
RSGABOX  EQU   RSG                                                      00949000
RSGTODS  EQU   RSG+7                                                    00950000
LIBRARY  EQU   COMTAB+1170                                              00951000
LIBS     EQU   LIBRARY                                                  00952000
LIB      EQU   LIBS                                                     00953000
LIBBITS  EQU   LIB                                                      00954000
PABTABLE EQU   COMTAB+1218                                              00955000
PABDEV   EQU   PABTABLE                                                 00956000
PABFLAGS EQU   PABDEV                                                   00957000
PABREAL  EQU   PABDEV+1                                                 00958000
PABAADDD EQU   PABDEV+2                                                 00959000
DSPAIRS  EQU   COMTAB+1938                                              00960000
PHYSTYPE EQU   COMTAB+2002                                              00961000
PHYSFLGS EQU   PHYSTYPE                                                 00962000
MERLICEB EQU   PHYSFLGS                                                 00963000
CPUASSOC EQU   COMTAB+3026                                              00964000
CPUS     EQU   CPUASSOC+2                                               00965000
CPU      EQU   CPUS                                                     00966000
CPUFLAG1 EQU   CPU+6                                                    00967000
OPSYSTYP EQU   CPUFLAG1                                                 00968000
OPVS2    EQU   OPSYSTYP                                                 00969000
CPUFLAG2 EQU   CPU+7                                                    00970000
LOWERCON EQU   COMTAB+3156                                              00971000
LOWDSS   EQU   LOWERCON                                                 00972000
LOWFLGS  EQU   LOWDSS                                                   00973000
LIBCTL   EQU   COMTAB+3284                                              00974000
LIBCTLS  EQU   LIBCTL                                                   00975000
CREATE   EQU   COMTAB+3288                                              00976000
@NM00017 EQU   CREATE                                                   00977000
COMTAB2  EQU   0                                                        00978000
DSTORSG  EQU   COMTAB2                                                  00979000
DSENTRY  EQU   DSTORSG                                                  00980000
CONFGCON EQU   COMTAB2+32                                               00981000
RSGUCB   EQU   CONFGCON                                                 00982000
RSGFLAGS EQU   RSGUCB                                                   00983000
RSGCPUID EQU   RSGUCB+1                                                 00984000
CPUREFNO EQU   RSGUCB+6                                                 00985000
RSGCHAN  EQU   RSGUCB+7                                                 00986000
RSGCUA   EQU   RSGUCB+8                                                 00987000
CONFGUCB EQU   COMTAB2+464                                              00988000
CONFGDEV EQU   CONFGUCB                                                 00989000
USEFLAGS EQU   CONFGDEV                                                 00990000
USESPEC  EQU   USEFLAGS                                                 00991000
USEV     EQU   USEFLAGS                                                 00992000
USEVS    EQU   USEFLAGS                                                 00993000
USEREAL  EQU   USEFLAGS                                                 00994000
USECONVR EQU   USEFLAGS                                                 00995000
ITISALTP EQU   USEFLAGS                                                 00996000
ALTPATH1 EQU   CONFGDEV+2                                               00997000
ALTPATH2 EQU   CONFGDEV+5                                               00998000
ALTPATH3 EQU   CONFGDEV+8                                               00999000
ALTCH3   EQU   ALTPATH3+2                                               01000000
SCANBUF  EQU   0                                                        01001000
SCANDATA EQU   0                                                        01002000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    01003000
ALTCI3   EQU   ALTPATH3+1                                               01004000
ALTDS3   EQU   ALTPATH3                                                 01005000
ALTCH2   EQU   ALTPATH2+2                                               01006000
ALTCI2   EQU   ALTPATH2+1                                               01007000
ALTDS2   EQU   ALTPATH2                                                 01008000
ALTCH1   EQU   ALTPATH1+2                                               01009000
ALTCI1   EQU   ALTPATH1+1                                               01010000
ALTDS1   EQU   ALTPATH1                                                 01011000
INDEXRSG EQU   CONFGDEV+1                                               01012000
ICEBERG  EQU   USEFLAGS                                                 01013000
SUPPUNCH EQU   USEFLAGS                                                 01014000
@NM00019 EQU   RSGFLAGS                                                 01015000
CISPEC   EQU   RSGFLAGS                                                 01016000
TORSG2   EQU   DSENTRY+1                                                01017000
TORSG1   EQU   DSENTRY                                                  01018000
COM2BASE EQU   COMTAB+3304                                              01019000
LRUCLOCK EQU   CREATE+11                                                01020000
VOLSER   EQU   CREATE+5                                                 01021000
VPAGES   EQU   CREATE+1                                                 01022000
@NM00018 EQU   @NM00017                                                 01023000
PRNTONLY EQU   @NM00017                                                 01024000
UPDCREAT EQU   @NM00017                                                 01025000
NEWCREAT EQU   @NM00017                                                 01026000
CMDCREAT EQU   @NM00017                                                 01027000
RW67RGHT EQU   LIBCTLS                                                  01028000
RW67LEFT EQU   LIBCTLS                                                  01029000
RW45RGHT EQU   LIBCTLS                                                  01030000
RW45LEFT EQU   LIBCTLS                                                  01031000
RW23RGHT EQU   LIBCTLS                                                  01032000
RW23LEFT EQU   LIBCTLS                                                  01033000
RW01RGHT EQU   LIBCTLS                                                  01034000
RW01LEFT EQU   LIBCTLS                                                  01035000
LOWLIB   EQU   LOWDSS+1                                                 01036000
@NM00016 EQU   LOWFLGS                                                  01037000
LOWRGHT  EQU   LOWFLGS                                                  01038000
LOWLEFT  EQU   LOWFLGS                                                  01039000
LOWRW67  EQU   LOWFLGS                                                  01040000
LOWRW45  EQU   LOWFLGS                                                  01041000
LOWRW23  EQU   LOWFLGS                                                  01042000
LOWRW01  EQU   LOWFLGS                                                  01043000
LOWSPEC  EQU   LOWFLGS                                                  01044000
ALTMSCIN EQU   CPUFLAG2                                                 01045000
@NM00015 EQU   CPUFLAG2                                                 01046000
ALTMSGBF EQU   CPUFLAG2                                                 01047000
@NM00014 EQU   CPUFLAG2                                                 01048000
CPUSPEC  EQU   CPUFLAG2                                                 01049000
CPUMSCIN EQU   CPUFLAG1                                                 01050000
OPJES3   EQU   OPSYSTYP                                                 01051000
OPVS1    EQU   OPSYSTYP                                                 01052000
CPUALTFL EQU   CPUFLAG1                                                 01053000
CPUTIGHT EQU   CPUFLAG1                                                 01054000
@NM00013 EQU   CPUFLAG1                                                 01055000
TOMPCPU  EQU   CPU+5                                                    01056000
CPUID    EQU   CPU                                                      01057000
CPUNUM   EQU   CPUASSOC                                                 01058000
SPNRSGNO EQU   PHYSTYPE+1                                               01059000
LGDEVICE EQU   PHYSFLGS                                                 01060000
LOGABOX1 EQU   PHYSFLGS                                                 01061000
PHYSSSID EQU   PHYSFLGS                                                 01062000
PHYSREAL EQU   PHYSFLGS                                                 01063000
PHYSICEB EQU   MERLICEB                                                 01064000
PHYSMERL EQU   MERLICEB                                                 01065000
PHYSDS2  EQU   DSPAIRS                                                  01066000
PABDDD   EQU   PABAADDD                                                 01067000
PABAA    EQU   PABAADDD                                                 01068000
PABZEROS EQU   PABAADDD                                                 01069000
PAB2D    EQU   PABREAL                                                  01070000
PAB2C    EQU   PABREAL                                                  01071000
PAB2B    EQU   PABREAL                                                  01072000
@NM00012 EQU   PABREAL                                                  01073000
PAB1D    EQU   PABREAL                                                  01074000
PAB1C    EQU   PABREAL                                                  01075000
PAB1B    EQU   PABREAL                                                  01076000
PABIMPLR EQU   PABREAL                                                  01077000
PABBERG2 EQU   PABFLAGS                                                 01078000
@NM00011 EQU   PABFLAGS                                                 01079000
PABDSMTL EQU   PABFLAGS                                                 01080000
PABIBERG EQU   PABFLAGS                                                 01081000
@NM00010 EQU   PABFLAGS                                                 01082000
PABVOVIR EQU   PABFLAGS                                                 01083000
PABEXIST EQU   PABFLAGS                                                 01084000
MAPEXIT  EQU   LIB+4                                                    01085000
LIBMAP   EQU   LIB+3                                                    01086000
LIBDSMID EQU   LIB+2                                                    01087000
LIBSIZE  EQU   LIB+1                                                    01088000
@NM00009 EQU   LIBBITS                                                  01089000
LIBSPEC  EQU   LIBBITS                                                  01090000
TODS2    EQU   RSGTODS+1                                                01091000
TODS1    EQU   RSGTODS                                                  01092000
RSGSLICE EQU   RSG+3                                                    01093000
RSGUDEL  EQU   RSG+2                                                    01094000
RSGLDEL  EQU   RSG+1                                                    01095000
@NM00008 EQU   RSG                                                      01096000
RSGABOX1 EQU   RSGABOX                                                  01097000
RSGABOX0 EQU   RSGABOX                                                  01098000
RSGSPEC  EQU   RSG                                                      01099000
SVSYSUT3 EQU   SAVEDDS+32                                               01100000
SVSYSUT2 EQU   SAVEDDS+24                                               01101000
SVSYSUT1 EQU   SAVEDDS+16                                               01102000
SVSYSPCH EQU   SAVEDDS+8                                                01103000
SVSYSIN  EQU   SAVEDDS                                                  01104000
PARMPTR  EQU   INVOKED                                                  01105000
BUILDPTR EQU   GENIO+20                                                 01106000
SAVE14   EQU   GENIO+12                                                 01107000
EXLST    EQU   GENIO+8                                                  01108000
@NM00007 EQU   DCBPTR+1                                                 01109000
DCBFLAG  EQU   DCBPTR                                                   01110000
OPENLIST EQU   GENIO                                                    01111000
@NM00006 EQU   MESSAGES+19                                              01112000
NEEDEOJ  EQU   SPECLMSG                                                 01113000
ENDPHASE EQU   SPECLMSG                                                 01114000
@NM00005 EQU   SPECLMSG                                                 01115000
PRNTCARD EQU   SPECLMSG                                                 01116000
@NM00004 EQU   SPECLMSG                                                 01117000
NEED102  EQU   SPECLMSG                                                 01118000
NEED101  EQU   SPECLMSG                                                 01119000
PRINTRC  EQU   MESSAGES+16                                              01120000
TERM     EQU   MESSAGES+12                                              01121000
WARN     EQU   MESSAGES+8                                               01122000
WARNING  EQU   MESSAGES+4                                               01123000
MSGNO    EQU   MESSAGES+2                                               01124000
RETCODE  EQU   MESSAGES                                                 01125000
OUTBUF   EQU   PRINTER+104                                              01126000
LINECT   EQU   PRINTER+102                                              01127000
LINECTR  EQU   PRINTER+100                                              01128000
PAGENO   EQU   PRINTER+96                                               01129000
DCBPRINT EQU   PRINTER                                                  01130000
@NM00003 EQU   READER+206                                               01131000
SCANLEN  EQU   READER+204                                               01132000
SVEODAD  EQU   READER+200                                               01133000
SVSYNAD2 EQU   READER+196                                               01134000
SAVENCOL EQU   READER+192                                               01135000
SAVESCOL EQU   READER+188                                               01136000
INBUF    EQU   READER+100                                               01137000
SSELECT  EQU   PCHBF                                                    01138000
@NM00002 EQU   READER+97                                                01139000
@NM00001 EQU   READFLAG                                                 01140000
LASTPARM EQU   READFLAG                                                 01141000
ENDSCAN  EQU   READFLAG                                                 01142000
PARMBIT  EQU   READFLAG                                                 01143000
KEYBIT   EQU   READFLAG                                                 01144000
READTERM EQU   READFLAG                                                 01145000
READDCB  EQU   READER                                                   01146000
PATCH    EQU   COMTAB                                                   01147000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      01148000
@RC00104 EQU   @EL00006                                                 01149000
@ENDDATA EQU   *                                                        01150000
         END   ICGDSA05,(C'PLS2004',0603,76335)                         01151000
