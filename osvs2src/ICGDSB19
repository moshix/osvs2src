         TITLE 'ICGDSB19 MSC TABLE CREATE, PUNCH SYSGEN                *00001000
                        '                                               00002000
ICGDSB19 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'ICGDSB19  77.362'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  LA    @10,4095(,@12)                                      0001 00012000
         USING @PSTART,@12                                         0001 00013000
         USING @PSTART+4095,@10                                    0001 00014000
         L     @00,@SIZDATD                                        0001 00015000
         GETMAIN  R,LV=(0)                                              00016000
         LR    @11,@01                                             0001 00017000
         USING @DATD,@11                                           0001 00018000
         ST    @13,@SA00001+4                                      0001 00019000
         LM    @00,@01,20(@13)                                     0001 00020000
         ST    @11,8(,@13)                                         0001 00021000
         LR    @13,@11                                             0001 00022000
         XC    @ZTEMPS(@ZLEN),@ZTEMPS                                   00023000
*                                      PROCESSING FOR JES3   @G18MB73*/ 00024000
*                                                                  0063 00025000
*   /*****************************************************************/ 00026000
*   /*                                                               */ 00027000
*   /* ***********************************************       @Y30LB14*/ 00028000
*   /* INITIALIZATION                                        @Y30LB14*/ 00029000
*   /* ***********************************************       @Y30LB14*/ 00030000
*   /*                                                               */ 00031000
*   /*****************************************************************/ 00032000
*                                                                  0063 00033000
*   OLDJ=0;                         /*                       @Y30LB14*/ 00034000
         SLR   @15,@15                                             0063 00035000
         ST    @15,OLDJ                                            0063 00036000
*   OLDI=0;                         /*                       @OZ05131*/ 00037000
         STH   @15,OLDI                                            0064 00038000
*   CNT=0;                          /*                       @Y30LB14*/ 00039000
         ST    @15,CNT                                             0065 00040000
*   N=0;                            /*                       @Y30LB14*/ 00041000
         SLR   N,N                                                 0066 00042000
*   SWIOD=0;                        /*                       @OZ09548*/ 00043000
         MVI   SWIOD,X'00'                                         0067 00044000
*   UNITIOD=0;                      /*                       @OZ09534*/ 00045000
         MVI   UNITIOD,X'00'                                       0068 00046000
*   BYT=0;                          /*                       @Y30LB14*/ 00047000
         SLR   BYT,BYT                                             0069 00048000
*   SEQNUM=0;                       /*                       @Y30LB14*/ 00049000
         STH   @15,SEQNUM                                          0070 00050000
*   FLAG=0;                         /*                       @Y30LB14*/ 00051000
         MVI   FLAG,X'00'                                          0071 00052000
*   INBUF='';                       /*                       @Y30LB14*/ 00053000
         MVI   INBUF(R4),C' '                                      0072 00054000
         MVC   INBUF+1(79,R4),INBUF(R4)                            0072 00055000
*   CALL SCANOPEN;                  /* OPEN SYSPUNCH         @Y30LB14*/ 00056000
         BAL   @14,SCANOPEN                                        0073 00057000
*                                                                  0074 00058000
*   /*****************************************************************/ 00059000
*   /*                                                               */ 00060000
*   /* ***********************************************       @Y30LB14*/ 00061000
*   /* THIS SECTION OF CODE IS THE MAINLINE FOR PUT-         @Y30LB14*/ 00062000
*   /* TING OUT THE IODEVICE CARD. THE CARD IS PRO-          @Y30LB14*/ 00063000
*   /* DUCED ONLY IF THE DEVICE HAS BEEN SPECIFIED.          @Y30LB14*/ 00064000
*   /* THE SEQUENCE NUMBER IS INCREMENTED FOR EVERY          @Y30LB14*/ 00065000
*   /* CARD THAT IS PRODUCED. 'N' POINTS TO THE NEXT         @Y30LB14*/ 00066000
*   /* CARD COLUMN TO BE FILLED. ENTRIES FOR THE             @Z40LB65*/ 00067000
*   /* MSC TABLES DRIVES MUST BE MODIFIED SO AS TO           @Z40LB65*/ 00068000
*   /* GENERATE REAL IODEVICE CARDS. THIS IS DONE FOR        @Z40LB65*/ 00069000
*   /* SA0 AND SA1 (IF THAT INTERFACE EXISTS).               @Z40LB65*/ 00070000
*   /* IF THE TABPTH KEYWORD WAS SPECIFIED, CARDS ARE        @OZ28368*/ 00071000
*   /* PRODUCED ONLY IF THE DEVICE HAS BEEN SPECIFIED.@OZ28368       */ 00072000
*   /* ***********************************************       @Y30LB14*/ 00073000
*   /*                                                               */ 00074000
*   /*****************************************************************/ 00075000
*                                                                  0074 00076000
*   IF BINTIND='0'B THEN                                           0074 00077000
         TM    BINTIND(R4),B'00000100'                             0074 00078000
         BNZ   @RF00074                                            0074 00079000
*     DO;                           /* TABPTH SPEC           @OZ28368*/ 00080000
*       DO I=1 BY 3 TO 4;           /*                       @Z40LB65*/ 00081000
         LA    I,1                                                 0076 00082000
@DL00076 DS    0H                                                  0077 00083000
*         K=1;                      /*                       @Z40LB65*/ 00084000
         LA    @15,1                                               0077 00085000
         ST    @15,K                                               0077 00086000
*         IF CISPEC(I)='1'B         /*                       @OZ05144*/ 00087000
*           THEN                    /*                       @OZ05144*/ 00088000
         LR    @03,I                                               0078 00089000
         MH    @03,@CH00115                                        0078 00090000
         L     @01,COMPTR2(,R4)                                    0078 00091000
         ALR   @01,@03                                             0078 00092000
         TM    CISPEC-9(@01),B'10000000'                           0078 00093000
         BNO   @RF00078                                            0078 00094000
*           DO J=1 BY 8 TO 9;       /*                       @Z40LB65*/ 00095000
         LR    J,@15                                               0079 00096000
@DL00079 DS    0H                                                  0080 00097000
*             USESPEC(I,J)='1'B;    /*                       @Z40LB65*/ 00098000
*             USEREAL(I,J)='1'B;    /*                       @Z40LB65*/ 00099000
         LR    @15,I                                               0081 00100000
         SLA   @15,6                                               0081 00101000
         ALR   @15,J                                               0081 00102000
         MH    @15,@CH00034                                        0081 00103000
         L     @01,COMPTR2(,R4)                                    0081 00104000
         ST    @15,@TF00001                                        0081 00105000
         ALR   @15,@01                                             0081 00106000
         AL    @15,@CF00829                                        0081 00107000
         OI    USESPEC-464(@15),B'10010000'                        0081 00108000
*             IF PABIBERG(1,K)='1'B THEN                           0082 00109000
         L     @15,K                                               0082 00110000
         MH    @15,@CH00051                                        0082 00111000
         ALR   @15,R4                                              0082 00112000
         TM    PABIBERG-3(@15),B'00010000'                         0082 00113000
         BNO   @RF00082                                            0082 00114000
*               ICEBERG(I,J)='1'B;  /*                       @Z40LB65*/ 00115000
         AL    @01,@TF00001                                        0083 00116000
         AL    @01,@CF00829                                        0083 00117000
         OI    ICEBERG-464(@01),B'00000001'                        0083 00118000
*             USESPEC(I,J+1)='1'B;  /*                       @Z40LB65*/ 00119000
@RF00082 DS    0H                                                  0085 00120000
*             USEREAL(I,J+1)='1'B;  /*                       @Z40LB65*/ 00121000
         LR    @15,I                                               0085 00122000
         SLA   @15,6                                               0085 00123000
         ALR   @15,J                                               0085 00124000
         MH    @15,@CH00034                                        0085 00125000
         L     @01,COMPTR2(,R4)                                    0085 00126000
         ST    @15,@TF00001                                        0085 00127000
         ALR   @15,@01                                             0085 00128000
         AL    @15,@CF00831                                        0085 00129000
         OI    USESPEC-464(@15),B'10010000'                        0085 00130000
*             IF PABIBERG(1,K+2)='1'B THEN                         0086 00131000
         L     @15,K                                               0086 00132000
         MH    @15,@CH00051                                        0086 00133000
         ALR   @15,R4                                              0086 00134000
         TM    PABIBERG+3(@15),B'00010000'                         0086 00135000
         BNO   @RF00086                                            0086 00136000
*               ICEBERG(I,J+1)='1'B;/*                       @Z40LB65*/ 00137000
         AL    @01,@TF00001                                        0087 00138000
         AL    @01,@CF00831                                        0087 00139000
         OI    ICEBERG-464(@01),B'00000001'                        0087 00140000
*             K=5;                  /*                       @Z40LB65*/ 00141000
@RF00086 MVC   K(4),@CF00122                                       0088 00142000
*           END;                    /*                       @Z40LB65*/ 00143000
*                                                                  0089 00144000
         AH    J,@CH00043                                          0089 00145000
         CH    J,@CH00115                                          0089 00146000
         BNH   @DL00079                                            0089 00147000
*         /***********************************************************/ 00148000
*         /*                                                         */ 00149000
*         /* ********************************************    @Z40LB65*/ 00150000
*         /* TEST FOR SA1 INTB AND BYPASS MODIFICATIONS      @Z40LB65*/ 00151000
*         /* IF THE INTERFACE DOES NOT EXIST                 @Z40LB65*/ 00152000
*         /* ********************************************    @Z40LB65*/ 00153000
*         /*                                                         */ 00154000
*         /***********************************************************/ 00155000
*                                                                  0090 00156000
*         IF TODS1(1)^='01'X&TODS2(1)^='01'X/*               @OZ05094*/ 00157000
*             |CISPEC(4)='0'B       /*                       @OZ05094*/ 00158000
*           THEN                    /*                       @OZ05094*/ 00159000
@RF00078 CLI   TODS1(R4),X'01'                                     0090 00160000
         BE    @GL00001                                            0090 00161000
         CLI   TODS2(R4),X'01'                                     0090 00162000
         BNE   @RT00090                                            0090 00163000
@GL00001 L     @01,COMPTR2(,R4)                                    0090 00164000
         TM    CISPEC+27(@01),B'10000000'                          0090 00165000
         BNZ   @RF00090                                            0090 00166000
@RT00090 DS    0H                                                  0091 00167000
*           I=5;                    /*                       @Z40LB65*/ 00168000
         LA    I,5                                                 0091 00169000
*       END;                        /*                       @Z40LB65*/ 00170000
@RF00090 AH    I,@CH00051                                          0092 00171000
         CH    I,@CH00071                                          0092 00172000
         BNH   @DL00076                                            0092 00173000
*     END;                          /*                       @OZ28368*/ 00174000
*   IODSW='0'B;                     /* FORCE CARD WHEN SA/CI CHANGES    00175000
*                                                            @OZ09548*/ 00176000
@RF00074 NI    IODSW,B'01111111'                                   0094 00177000
*   DO I=1 TO MAXSACI;              /*                       @YD00113*/ 00178000
         LA    I,1                                                 0095 00179000
@DL00095 DS    0H                                                  0096 00180000
*     DO J=1 TO MAXDEV;             /*                       @YD00113*/ 00181000
*                                                                  0096 00182000
         LA    J,1                                                 0096 00183000
@DL00096 DS    0H                                                  0097 00184000
*       /*************************************************************/ 00185000
*       /*                                                           */ 00186000
*       /* *******************************************       @YD00113*/ 00187000
*       /* IODEVICE STATEMENTS ARE PRODUCED FOR              @YD00113*/ 00188000
*       /* ADDRESSES SPECIFIED AS VIRTUAL, SHARED            @YD00113*/ 00189000
*       /* VIRTUAL, REAL, OR CONVERTIBLE UNLESS              @YD00113*/ 00190000
*       /* THE 'SUPPUNCH' FLAG IS SET BECAUSE THE            @YD00113*/ 00191000
*       /* THE ADDRESS IS SYMMETRIC IN A MULTI-              @YD00113*/ 00192000
*       /* HOST ENVIRONMENT.                                 @OZ09548*/ 00193000
*       /* *******************************************       @YD00113*/ 00194000
*       /*                                                           */ 00195000
*       /*************************************************************/ 00196000
*                                                                  0097 00197000
*       IF USESPEC(I,J)='1'B&ITISALTP(I,J)='0'B&SUPPUNCH(I,J)='0'B THEN 00198000
         LR    @15,I                                               0097 00199000
         SLA   @15,6                                               0097 00200000
         ALR   @15,J                                               0097 00201000
         MH    @15,@CH00034                                        0097 00202000
         L     @01,COMPTR2(,R4)                                    0097 00203000
         ALR   @01,@15                                             0097 00204000
         AL    @01,@CF00829                                        0097 00205000
         TM    USESPEC-464(@01),B'10000000'                        0097 00206000
         BNO   @RF00097                                            0097 00207000
         TM    ITISALTP-464(@01),B'00001010'                       0097 00208000
         BNZ   @RF00097                                            0097 00209000
*         IF IODSW='0'B THEN        /* FIRST TIME IMAGE BUILD      0098 00210000
*                                                            @OZ09548*/ 00211000
         TM    IODSW,B'10000000'                                   0098 00212000
         BNZ   @RF00098                                            0098 00213000
*           DO;                     /*                       @OZ09548*/ 00214000
*             CALL IODSTRT;         /* IMAGE BUILD ROUTINE   @OZ09548*/ 00215000
         BAL   @14,IODSTRT                                         0100 00216000
*           END;                    /*                       @OZ09548*/ 00217000
*         ELSE                      /*                       @OZ09548*/ 00218000
*           IF OLDJ+1^=J|OLDI^=I    /* CHK ADDR SKIP         @OZ09548*/ 00219000
*             THEN                  /*                       @OZ09548*/ 00220000
         B     @RC00098                                            0102 00221000
@RF00098 LA    @15,1                                               0102 00222000
         AL    @15,OLDJ                                            0102 00223000
         CR    @15,J                                               0102 00224000
         BNE   @RT00102                                            0102 00225000
         CH    I,OLDI                                              0102 00226000
         BE    @RF00102                                            0102 00227000
@RT00102 DS    0H                                                  0103 00228000
*             DO;                   /*                       @OZ09548*/ 00229000
*               CALL PUTOUTCD;      /* OUTPUT ROUTINE        @OZ09548*/ 00230000
         BAL   @14,PUTOUTCD                                        0104 00231000
*               CALL IODSTRT;       /* SETUP NEW CARD        @OZ09548*/ 00232000
         BAL   @14,IODSTRT                                         0105 00233000
*             END;                  /*                       @OZ09548*/ 00234000
*           ELSE                    /*                       @OZ09548*/ 00235000
*             IF USEV(I,J)='1'B THEN/* IS NEW CARD USEV      @OZ09548*/ 00236000
         B     @RC00102                                            0107 00237000
@RF00102 LA    @15,11                                              0107 00238000
         LR    @01,I                                               0107 00239000
         SLA   @01,6                                               0107 00240000
         LR    @07,J                                               0107 00241000
         ALR   @07,@01                                             0107 00242000
         MR    @06,@15                                             0107 00243000
         L     @06,COMPTR2(,R4)                                    0107 00244000
         ALR   @07,@06                                             0107 00245000
         AL    @07,@CF00829                                        0107 00246000
         TM    USEV-464(@07),B'01000000'                           0107 00247000
         BNO   @RF00107                                            0107 00248000
*               IF USEV(I,OLDJ)='1'B/* IS OLD USEV           @OZ09548*/ 00249000
*                 THEN              /*                       @OZ09548*/ 00250000
         LR    @09,@01                                             0108 00251000
         AL    @09,OLDJ                                            0108 00252000
         MR    @08,@15                                             0108 00253000
         ALR   @06,@09                                             0108 00254000
         AL    @06,@CF00829                                        0108 00255000
         TM    USEV-464(@06),B'01000000'                           0108 00256000
         BNO   @RF00108                                            0108 00257000
*                 CALL COMCHAN;     /* COMPARE ALT. PATHS    @OZ09548*/ 00258000
         BAL   @14,COMCHAN                                         0109 00259000
*               ELSE                /*                       @OZ09548*/ 00260000
*                 DO;               /*                       @OZ09548*/ 00261000
         B     @RC00108                                            0110 00262000
@RF00108 DS    0H                                                  0111 00263000
*                   CALL PUTOUTCD;  /* OUTPUT ROUTINE        @OZ09548*/ 00264000
         BAL   @14,PUTOUTCD                                        0111 00265000
*                   CALL IODSTRT;   /* SETUP NEW CARD        @OZ09548*/ 00266000
         BAL   @14,IODSTRT                                         0112 00267000
*                 END;              /*                       @OZ09548*/ 00268000
*             ELSE                  /*                       @OZ09548*/ 00269000
*               IF USEVS(I,J)='1'B THEN/* IS NEW CARD USEVS  @OZ09548*/ 00270000
         B     @RC00107                                            0114 00271000
@RF00107 LR    @15,I                                               0114 00272000
         SLA   @15,6                                               0114 00273000
         ALR   @15,J                                               0114 00274000
         MH    @15,@CH00034                                        0114 00275000
         L     @01,COMPTR2(,R4)                                    0114 00276000
         ALR   @01,@15                                             0114 00277000
         AL    @01,@CF00829                                        0114 00278000
         TM    USEVS-464(@01),B'00100000'                          0114 00279000
         BNO   @RF00114                                            0114 00280000
*                 IF FS='1'B        /* IS OLD USEVS          @OZ09548*/ 00281000
*                   THEN            /*                       @OZ09548*/ 00282000
         TM    FS,B'01000000'                                      0115 00283000
         BNO   @RF00115                                            0115 00284000
*                   CALL COMCHAN;   /* COMPARE ALT. PATHS    @OZ09548*/ 00285000
         BAL   @14,COMCHAN                                         0116 00286000
*                 ELSE              /*                       @OZ09548*/ 00287000
*                   DO;             /*                       @OZ09548*/ 00288000
         B     @RC00115                                            0117 00289000
@RF00115 DS    0H                                                  0118 00290000
*                     CALL PUTOUTCD;/* OUTPUT ROUTINE        @OZ09548*/ 00291000
         BAL   @14,PUTOUTCD                                        0118 00292000
*                     CALL IODSTRT; /* SETUP NEW CARD        @OZ09548*/ 00293000
         BAL   @14,IODSTRT                                         0119 00294000
*                   END;            /*                       @OZ09548*/ 00295000
*               ELSE                /*                       @OZ09548*/ 00296000
*                 IF USEREAL(I,J)='1'B|USECONVR(I,J)='1'B/*  @OZ09548*/ 00297000
*                   THEN            /* IS NEW CARD REAL OR         0121 00298000
*                                      CONVERTIBLE           @OZ09548*/ 00299000
         B     @RC00114                                            0121 00300000
@RF00114 LA    @15,11                                              0121 00301000
         LR    @01,I                                               0121 00302000
         SLA   @01,6                                               0121 00303000
         LR    @07,J                                               0121 00304000
         ALR   @07,@01                                             0121 00305000
         MR    @06,@15                                             0121 00306000
         L     @06,COMPTR2(,R4)                                    0121 00307000
         ST    @07,@TF00001                                        0121 00308000
         ALR   @07,@06                                             0121 00309000
         AL    @07,@CF00829                                        0121 00310000
         TM    USEREAL-464(@07),B'00010100'                        0121 00311000
         BZ    @RF00121                                            0121 00312000
*                   IF USEREAL(I,OLDJ)='1'B/*                @OZ09548*/ 00313000
*                       |USECONVR(I,OLDJ)='1'B/*             @OZ09548*/ 00314000
*                     THEN          /*                       @OZ09548*/ 00315000
         LR    @09,@01                                             0122 00316000
         AL    @09,OLDJ                                            0122 00317000
         MR    @08,@15                                             0122 00318000
         ST    @09,@TF00002                                        0122 00319000
         ALR   @09,@06                                             0122 00320000
         AL    @09,@CF00829                                        0122 00321000
         TM    USEREAL-464(@09),B'00010100'                        0122 00322000
         BZ    @RF00122                                            0122 00323000
*                     IF ICEBERG(I,J)='1'B&ICEBERG(I,OLDJ)='1'B/*  0123 00324000
*                                                            @OZ09548*/ 00325000
*                       THEN        /*                       @S60RS73*/ 00326000
         LR    @15,@06                                             0123 00327000
         AL    @15,@TF00001                                        0123 00328000
         AL    @15,@CF00829                                        0123 00329000
         TM    ICEBERG-464(@15),B'00000001'                        0123 00330000
         BNO   @RF00123                                            0123 00331000
         AL    @06,@TF00002                                        0123 00332000
         AL    @06,@CF00829                                        0123 00333000
         TM    ICEBERG-464(@06),B'00000001'                        0123 00334000
         BNO   @RF00123                                            0123 00335000
*                       CALL COMCHAN;/*                      @OZ09548*/ 00336000
*                                                                  0124 00337000
         BAL   @14,COMCHAN                                         0124 00338000
*       /*************************************************************/ 00339000
*       /*                                                           */ 00340000
*       /* *****************************************         @X60RS12*/ 00341000
*       /* THE DEVICE TYPE IS NOT 3330 MODEL 11.             @X60RS12*/ 00342000
*       /* THE DEVICE TYPE MAY BE 3330 MODEL 1               @X60RS12*/ 00343000
*       /* (EITHER REAL OR CONVERTIBLE) OR IT                @X60RS12*/ 00344000
*       /* MAY BE 3350 (REAL ONLY). IF IT IS THE             @X60RS12*/ 00345000
*       /* SAME AS THE PREVIOUS TYPE, CALL THE               @X60RS12*/ 00346000
*       /* PROCEDURE COMCHAN TO CHECK ALTERNATE              @X60RS12*/ 00347000
*       /* PATH INFORMATION. OTHERWISE PRINT AND             @X60RS12*/ 00348000
*       /* PUNCH THIS RECORD, AND START ANOTHER.             @X60RS12*/ 00349000
*       /* *****************************************         @X60RS12*/ 00350000
*       /*                                                           */ 00351000
*       /*************************************************************/ 00352000
*                                                                  0125 00353000
*                     ELSE          /*                       @S60RS73*/ 00354000
*                                                                  0125 00355000
*                       /*********************************************/ 00356000
*                       /*                                           */ 00357000
*                       /* ********************************* @S60RS73*/ 00358000
*                       /* MAY BE 3350                       @S60RS73*/ 00359000
*                       /* ********************************* @S60RS73*/ 00360000
*                       /*                                           */ 00361000
*                       /*********************************************/ 00362000
*                                                                  0125 00363000
*                       DO;         /*                       @S60RS73*/ 00364000
         B     @RC00123                                            0125 00365000
@RF00123 DS    0H                                                  0126 00366000
*                         I1=(I+2)/3;/* INDEX BY 16          @S60RS73*/ 00367000
         LA    @08,2                                               0126 00368000
         ALR   @08,I                                               0126 00369000
         SRDA  @08,32                                              0126 00370000
         D     @08,@CF00051                                        0126 00371000
         ST    @09,I1                                              0126 00372000
*                         I2=(J+7)/8;/* DASD CTL 1 TO 4      @S60RS73*/ 00373000
         LA    @15,7                                               0127 00374000
         ALR   @15,J                                               0127 00375000
         LR    I2,@15                                              0127 00376000
         SRDA  I2,32                                               0127 00377000
         D     I2,@CF00043                                         0127 00378000
         LR    I2,@07                                              0127 00379000
*                         I3=(J+7)//8+1;/* DEVICE 1 TO 8     @S60RS73*/ 00380000
*                                                                  0128 00381000
         LR    @08,@15                                             0128 00382000
         SRDA  @08,32                                              0128 00383000
         D     @08,@CF00043                                        0128 00384000
         AH    @08,@CH00045                                        0128 00385000
         ST    @08,I3                                              0128 00386000
*                         /*******************************************/ 00387000
*                         /*                                         */ 00388000
*                         /* IF CURRENT DEVICE TYPE IS 3350  @X60RS12*/ 00389000
*                         /*                                         */ 00390000
*                         /*******************************************/ 00391000
*                                                                  0129 00392000
*                         IF MERLICEB(I1,I2,I3)=PHYSFMAD/*   @X60RS12*/ 00393000
*                           THEN    /* IF LAST WAS 3350      @X60RS12*/ 00394000
         L     @15,I1                                              0129 00395000
         SLA   @15,2                                               0129 00396000
         ALR   @15,I2                                              0129 00397000
         SLA   @15,3                                               0129 00398000
         ALR   @15,@08                                             0129 00399000
         ALR   @15,@15                                             0129 00400000
         ALR   @15,R4                                              0129 00401000
         TM    MERLICEB-82(@15),B'11000000'                        0129 00402000
         BNO   @RF00129                                            0129 00403000
*                           IF INBUF(43)='5'/*               @X60RS12*/ 00404000
*                             THEN  /* YES, LAST 3350        @X60RS12*/ 00405000
         CLI   INBUF+42(R4),C'5'                                   0130 00406000
         BNE   @RF00130                                            0130 00407000
*                             CALL COMCHAN;/*                @X60RS12*/ 00408000
         BAL   @14,COMCHAN                                         0131 00409000
*                           ELSE    /* LAST NOT 3350         @X60RS12*/ 00410000
*                             DO;   /*                       @X60RS12*/ 00411000
         B     @RC00130                                            0132 00412000
@RF00130 DS    0H                                                  0133 00413000
*                               CALL PUTOUTCD;/* OUTPUT OLD  @X60RS12*/ 00414000
         BAL   @14,PUTOUTCD                                        0133 00415000
*                               CALL IODSTRT;/* SETUP NEW    @X60RS12*/ 00416000
         BAL   @14,IODSTRT                                         0134 00417000
*                             END;  /*                       @X60RS12*/ 00418000
*                         ELSE      /* THIS IS 3330          @X60RS12*/ 00419000
*                           IF INBUF(43)='3'/*               @X60RS12*/ 00420000
*                               &ICEBERG(I,OLDJ)='0'B/*      @X60RS12*/ 00421000
*                               &ICEBERG(I,J)='0'B/*         @ZZZZZZZ*/ 00422000
*                             THEN  /* YES, LAST 3330        @X60RS12*/ 00423000
         B     @RC00129                                            0136 00424000
@RF00129 CLI   INBUF+42(R4),C'3'                                   0136 00425000
         BNE   @RF00136                                            0136 00426000
         LA    @15,11                                              0136 00427000
         LR    @01,I                                               0136 00428000
         SLA   @01,6                                               0136 00429000
         LR    @07,@01                                             0136 00430000
         AL    @07,OLDJ                                            0136 00431000
         MR    @06,@15                                             0136 00432000
         L     @06,COMPTR2(,R4)                                    0136 00433000
         ALR   @07,@06                                             0136 00434000
         AL    @07,@CF00829                                        0136 00435000
         TM    ICEBERG-464(@07),B'00000001'                        0136 00436000
         BNZ   @RF00136                                            0136 00437000
         LR    @09,@01                                             0136 00438000
         ALR   @09,J                                               0136 00439000
         MR    @08,@15                                             0136 00440000
         ALR   @06,@09                                             0136 00441000
         AL    @06,@CF00829                                        0136 00442000
         TM    ICEBERG-464(@06),B'00000001'                        0136 00443000
         BNZ   @RF00136                                            0136 00444000
*                             CALL COMCHAN;/*                @X60RS12*/ 00445000
         BAL   @14,COMCHAN                                         0137 00446000
*                           ELSE    /* LAST NOT 3330         @X60RS12*/ 00447000
*                             DO;   /*                       @X60RS12*/ 00448000
         B     @RC00136                                            0138 00449000
@RF00136 DS    0H                                                  0139 00450000
*                               CALL PUTOUTCD;/* OUTPUT OLD  @X60RS12*/ 00451000
         BAL   @14,PUTOUTCD                                        0139 00452000
*                               CALL IODSTRT;/* SETUP NEW    @X60RS12*/ 00453000
         BAL   @14,IODSTRT                                         0140 00454000
*                             END;  /*                       @X60RS12*/ 00455000
*                       END;        /* END MADRID            @S60RS73*/ 00456000
*                   ELSE            /* NEW CARD              @S60RS73*/ 00457000
*                     DO;           /*                       @S60RS73*/ 00458000
         B     @RC00122                                            0143 00459000
@RF00122 DS    0H                                                  0144 00460000
*                       CALL PUTOUTCD;/* OUTPUT ROUTINE      @S60RS73*/ 00461000
         BAL   @14,PUTOUTCD                                        0144 00462000
*                       CALL IODSTRT;/* SETUP NEW CARD       @S60RS73*/ 00463000
         BAL   @14,IODSTRT                                         0145 00464000
*                     END;          /* END ICEBERG           @OZ09548*/ 00465000
*                 ELSE                                             0147 00466000
*                   ;               /* NO MATCH ON ANY USEAGE TYPE 0147 00467000
*                                                            @OZ09548*/ 00468000
@RF00121 DS    0H                                                  0148 00469000
*/* *********************************************************@OZ09548*/ 00470000
*/*  FALSE SITUATION ARISES IF NON-MATCH ON ANY OF THE ABOVE @OZ09548*/ 00471000
*/*  DASD USEAGE TYPES. SINCE THIS SHOULD NEVER HAPPEN       @OZ09548*/ 00472000
*/*  THIS PASS THROUGH THE CODE IS IGNORED                   @OZ09548*/ 00473000
*/* *********************************************************@OZ09548*/ 00474000
*                                                                  0148 00475000
*     END;                          /* END DO J LOOP         @Y30LB14*/ 00476000
@RC00121 DS    0H                                                  0148 00477000
@RC00114 DS    0H                                                  0148 00478000
@RC00107 DS    0H                                                  0148 00479000
@RC00102 DS    0H                                                  0148 00480000
@RC00098 DS    0H                                                  0148 00481000
@RF00097 AH    J,@CH00045                                          0148 00482000
         CH    J,@CH00256                                          0148 00483000
         BNH   @DL00096                                            0148 00484000
*   END;                            /* END DO I LOOP         @Y30LB14*/ 00485000
         AH    I,@CH00045                                          0149 00486000
         CH    I,@CH00246                                          0149 00487000
         BNH   @DL00095                                            0149 00488000
*   CALL PUTOUTCD;                  /* PUNCH LAST CARD       @OZ09548*/ 00489000
         BAL   @14,PUTOUTCD                                        0150 00490000
*                                                                  0151 00491000
*   /*****************************************************************/ 00492000
*   /*                                                               */ 00493000
*   /* ***********************************************       @Y30LB14*/ 00494000
*   /* THIS SECTION OF CODE IS THE MAINLINE FOR PUT-         @Y30LB14*/ 00495000
*   /* TING OUT THE UNITNAME CARD. AS MUCH DATA AS           @Y30LB14*/ 00496000
*   /* POSSIBLE IS PUT ON ONE CARD IF THE DATA BE-           @Y30LB14*/ 00497000
*   /* LONGS TO THE SAME RSG. ENTRIES FOR THE MSC            @Z40LB65*/ 00498000
*   /* TABLES DRIVES MUST AGAIN BE MODIFIED SO AS TO         @Z40LB65*/ 00499000
*   /* AVOID GENERATING UNITNAME CARDS UNLESS THE            @OZ28368*/ 00500000
*   /* TABPTH KEYWORD IN CREATE WAS CORRECTLY                @OZ28368*/ 00501000
*   /* SPECIFIED. THIS IS DONE FOR THE SAME ENTIRES          @OZ28368*/ 00502000
*   /* AS MODIFIED FOR IODEVICE CARDS.                       @OZ28368*/ 00503000
*   /* ***********************************************       @Z40LB65*/ 00504000
*   /*                                                               */ 00505000
*   /*****************************************************************/ 00506000
*                                                                  0151 00507000
*   IF BINTIND='0'B THEN            /* IF TABPTH KEYWORD NOT @OZ28368*/ 00508000
*                                                                  0151 00509000
         TM    BINTIND(R4),B'00000100'                             0151 00510000
         BNZ   @RF00151                                            0151 00511000
*     /***************************************************************/ 00512000
*     /*                                                             */ 00513000
*     /* SPECIFIED THEN DEFLT PRC                            @OZ28368*/ 00514000
*     /*                                                             */ 00515000
*     /***************************************************************/ 00516000
*                                                                  0152 00517000
*     DO;                           /*                       @OZ28368*/ 00518000
*       DO I=1 BY 3 TO 4;           /*                       @Z40LB65*/ 00519000
         LA    I,1                                                 0153 00520000
@DL00153 DS    0H                                                  0154 00521000
*         DO J=1 BY 8 TO 9;         /*                       @Z40LB65*/ 00522000
         LA    J,1                                                 0154 00523000
@DL00154 DS    0H                                                  0155 00524000
*           USESPEC(I,J)='0'B;      /*                       @Z40LB65*/ 00525000
*           USEREAL(I,J)='0'B;      /*                       @Z40LB65*/ 00526000
         LR    @15,I                                               0156 00527000
         SLA   @15,6                                               0156 00528000
         ALR   @15,J                                               0156 00529000
         MH    @15,@CH00034                                        0156 00530000
         L     @01,COMPTR2(,R4)                                    0156 00531000
         ST    @15,@TF00001                                        0156 00532000
         ALR   @15,@01                                             0156 00533000
         AL    @15,@CF00829                                        0156 00534000
         NI    USESPEC-464(@15),B'01101111'                        0156 00535000
*           USESPEC(I,J+1)='0'B;    /*                       @Z40LB65*/ 00536000
*           USEREAL(I,J+1)='0'B;    /*                       @Z40LB65*/ 00537000
         AL    @01,@TF00001                                        0158 00538000
         AL    @01,@CF00831                                        0158 00539000
         NI    USESPEC-464(@01),B'01101111'                        0158 00540000
*         END;                      /*                       @Z40LB65*/ 00541000
*                                                                  0159 00542000
         AL    J,@CF00043                                          0159 00543000
         CH    J,@CH00115                                          0159 00544000
         BNH   @DL00154                                            0159 00545000
*         /***********************************************************/ 00546000
*         /*                                                         */ 00547000
*         /* ********************************************    @Z40LB65*/ 00548000
*         /* TEST FOR SA1 INTB AND BYPASS MODIFICATIONS      @Z40LB65*/ 00549000
*         /* IF THE INTERFACE DOES NOT EXIST                 @Z40LB65*/ 00550000
*         /* ********************************************    @Z40LB65*/ 00551000
*         /*                                                         */ 00552000
*         /***********************************************************/ 00553000
*                                                                  0160 00554000
*         IF TODS1(1)^='01'X&TODS2(1)^='01'X THEN                  0160 00555000
         CLI   TODS1(R4),X'01'                                     0160 00556000
         BE    @RF00160                                            0160 00557000
         CLI   TODS2(R4),X'01'                                     0160 00558000
         BE    @RF00160                                            0160 00559000
*           I=5;                    /*                       @Z40LB65*/ 00560000
         LA    I,5                                                 0161 00561000
*       END;                        /*                       @Z40LB65*/ 00562000
@RF00160 AL    I,@CF00051                                          0162 00563000
         CH    I,@CH00071                                          0162 00564000
         BNH   @DL00153                                            0162 00565000
*     END;                          /*                       @OZ28368*/ 00566000
*   ELSE                                                           0164 00567000
*     ;                             /*                       @OZ28368*/ 00568000
@RF00151 DS    0H                                                  0165 00569000
*   SW=1;                           /* FIRST TIME SWITCH     @YD00113*/ 00570000
         MVI   SW,X'01'                                            0165 00571000
*   SORTSEQ='1'B;                   /* ALLOWS PATH THRU SEQUENCE CODE   00572000
*                                                            @OZ09534*/ 00573000
*   RESET='1'B;                     /* RESET SEQUENCE NUMBER @OZ09534*/ 00574000
*                                                                  0167 00575000
         OI    SORTSEQ,B'11000000'                                 0167 00576000
*   /*****************************************************************/ 00577000
*   /*                                                               */ 00578000
*   /* FOR SORT COLMN INFORMATION.                           @OZ09534*/ 00579000
*   /*                                                               */ 00580000
*   /*****************************************************************/ 00581000
*                                                                  0168 00582000
*   SWJ='0'B;                       /* INIT J PROCESSING     @G18MB73*/ 00583000
         NI    SWJ,B'00001111'                                     0168 00584000
*   DO I=1 TO MAXSACI;              /*                       @YD00113*/ 00585000
         LA    I,1                                                 0169 00586000
@DL00169 DS    0H                                                  0170 00587000
*     IF OPJES3(CPUREFNO(I)+1)='1'B THEN/*                   @G18MB73*/ 00588000
         LR    @15,I                                               0170 00589000
         MH    @15,@CH00115                                        0170 00590000
         L     @01,COMPTR2(,R4)                                    0170 00591000
         SLR   @03,@03                                             0170 00592000
         IC    @03,CPUREFNO-9(@15,@01)                             0170 00593000
         SLA   @03,3                                               0170 00594000
         ALR   @03,R4                                              0170 00595000
         TM    OPJES3(@03),B'00000100'                             0170 00596000
         BNO   @RF00170                                            0170 00597000
*       LOCALJES='1'B;              /* FOR J PROCESSING      @G18MB73*/ 00598000
         OI    LOCALJES,B'00100000'                                0171 00599000
*     DO J=1 TO MAXDEV;             /*                       @YD00113*/ 00600000
*                                                                  0172 00601000
@RF00170 LA    J,1                                                 0172 00602000
@DL00172 DS    0H                                                  0173 00603000
*       /*************************************************************/ 00604000
*       /*                                                           */ 00605000
*       /* *******************************************       @YD00113*/ 00606000
*       /* PRODUCE A 'UNITNAME' STATEMENT ONLY IF            @YD00113*/ 00607000
*       /* THE ADDRESS WAS SPECIFIED AS VIRTUAL OR           @YD00113*/ 00608000
*       /* SHARED VIRTUAL AND THE DEVICE ADDRESS WAS         @YD00113*/ 00609000
*       /* NOT DUPLICATED ON ANOTHER INTERFACE IN A          @YD00113*/ 00610000
*       /* MULTIPROCESSING CONFIGURATION.                    @YD00113*/ 00611000
*       /* *******************************************       @YD00113*/ 00612000
*       /*                                                           */ 00613000
*       /*************************************************************/ 00614000
*                                                                  0173 00615000
*       IF USEV(I,J)='1'B&SUPPUNCH(I,J)='0'B/*               @YM31086*/ 00616000
*           |USEVS(I,J)='1'B&SUPPUNCH(I,J)='0'B THEN               0173 00617000
*                                                                  0173 00618000
         LR    @15,I                                               0173 00619000
         SLA   @15,6                                               0173 00620000
         ALR   @15,J                                               0173 00621000
         MH    @15,@CH00034                                        0173 00622000
         L     @01,COMPTR2(,R4)                                    0173 00623000
         ALR   @01,@15                                             0173 00624000
         AL    @01,@CF00829                                        0173 00625000
         TM    USEV-464(@01),B'01000000'                           0173 00626000
         BNO   @GL00008                                            0173 00627000
         TM    SUPPUNCH-464(@01),B'00001000'                       0173 00628000
         BZ    @RT00173                                            0173 00629000
@GL00008 LR    @15,I                                               0173 00630000
         SLA   @15,6                                               0173 00631000
         ALR   @15,J                                               0173 00632000
         MH    @15,@CH00034                                        0173 00633000
         L     @01,COMPTR2(,R4)                                    0173 00634000
         ALR   @01,@15                                             0173 00635000
         AL    @01,@CF00829                                        0173 00636000
         TM    USEVS-464(@01),B'00100000'                          0173 00637000
         BNO   @RF00173                                            0173 00638000
         TM    SUPPUNCH-464(@01),B'00001000'                       0173 00639000
         BNZ   @RF00173                                            0173 00640000
@RT00173 DS    0H                                                  0174 00641000
*         /***********************************************************/ 00642000
*         /*                                                         */ 00643000
*         /* *********************************************** @G18MB73*/ 00644000
*         /* BUILD INBUF AND PERFORM CHECKS                  @G18MB73*/ 00645000
*         /* *********************************************** @G18MB73*/ 00646000
*         /*                                                         */ 00647000
*         /***********************************************************/ 00648000
*                                                                  0174 00649000
*         CALL BUILDIT;             /* BUILD INBUF           @G18MB73*/ 00650000
         BAL   @14,BUILDIT                                         0174 00651000
*     END;                          /* J LOOP                @G18MB73*/ 00652000
@RF00173 AH    J,@CH00045                                          0175 00653000
         CH    J,@CH00256                                          0175 00654000
         BNH   @DL00172                                            0175 00655000
*   END;                            /* I LOOP                @G18MB73*/ 00656000
*                                                                  0176 00657000
         AH    I,@CH00045                                          0176 00658000
         CH    I,@CH00246                                          0176 00659000
         BNH   @DL00169                                            0176 00660000
*   /*****************************************************************/ 00661000
*   /*                                                               */ 00662000
*   /* ***********************************************       @G18MB73*/ 00663000
*   /* END THE FINAL GROUP, PRINT AND PUNCH IT, AND          @G18MB73*/ 00664000
*   /* PROCESS J-UNITNAME STATEMENTS IF REQUIRED.            @G18MB73*/ 00665000
*   /* ***********************************************       @G18MB73*/ 00666000
*   /*                                                               */ 00667000
*   /*****************************************************************/ 00668000
*                                                                  0177 00669000
*   CALL ENDGRP;                    /* END A GROUP ON CARD IMAGE   0177 00670000
*                                                            @G18MB73*/ 00671000
         BAL   @14,ENDGRP                                          0177 00672000
*   CALL PUTOUTCD;                  /* PRINT AND PUNCH A CARD      0178 00673000
*                                                            @G18MB73*/ 00674000
         BAL   @14,PUTOUTCD                                        0178 00675000
*   IF LOCALJES^='1'B THEN          /* REQUIRES NO J CARDS   @G18MB73*/ 00676000
         TM    LOCALJES,B'00100000'                                0179 00677000
         BO    @RF00179                                            0179 00678000
*     DO;                           /*                       @G18MB73*/ 00679000
*       CALL ENDDATA;               /* CLOSE SYSPUNCH        @G18MB73*/ 00680000
         BAL   @14,ENDDATA                                         0181 00681000
*       RETURN;                     /* RETURN TO ICGDSBLD    @G18MB73*/ 00682000
@EL00001 L     @13,4(,@13)                                         0182 00683000
@EF00001 L     @00,@SIZDATD                                        0182 00684000
         LR    @01,@11                                             0182 00685000
         FREEMAIN R,LV=(0),A=(1)                                        00686000
@ER00001 LM    @14,@12,12(@13)                                     0182 00687000
         BR    @14                                                 0182 00688000
*     END;                          /*                       @G18MB73*/ 00689000
*   ELSE                            /*                       @G18MB73*/ 00690000
*     DO;                           /*                       @G18MB73*/ 00691000
@RF00179 DS    0H                                                  0185 00692000
*       UCOMP='1'B;                 /* UNITNAME PROCESSING IS      0185 00693000
*                                      COMPLETE              @G18MB73*/ 00694000
         OI    UCOMP,B'01000000'                                   0185 00695000
*       RESET='1'B;                 /* RESET SEQUENCE NUMBER @G18MB73*/ 00696000
*                                                                  0186 00697000
         OI    RESET,B'01000000'                                   0186 00698000
*       /*************************************************************/ 00699000
*       /*                                                           */ 00700000
*       /* **********************************************    @G18MB73*/ 00701000
*       /* THIS SECTION OF CODE IS THE MAINLINE FOR PUT-     @G18MB73*/ 00702000
*       /* TING OUT THE J-UNITNAME CARD. AS MUCH DATA AS     @G18MB73*/ 00703000
*       /* POSSIBLE IS PUT ON ONE CARD IF THE DATA BE-       @G18MB73*/ 00704000
*       /* LONGS TO THE SAME RSG.                            @G18MB73*/ 00705000
*       /* ***********************************************   @G18MB73*/ 00706000
*       /*                                                           */ 00707000
*       /*************************************************************/ 00708000
*                                                                  0187 00709000
*       SW1='1'B;                   /* FIRST TIME SWITCH     @G18MB73*/ 00710000
         OI    SW1,B'00010000'                                     0187 00711000
*     END;                          /*                       @G18MB73*/ 00712000
*   DO I=1 TO MAXSACI;              /*                       @G18MB73*/ 00713000
         LA    I,1                                                 0189 00714000
@DL00189 DS    0H                                                  0190 00715000
*     IF OPJES3(CPUREFNO(I)+1)='1'B THEN/* OPSYS=JES3        @G18MB73*/ 00716000
         LR    @15,I                                               0190 00717000
         MH    @15,@CH00115                                        0190 00718000
         L     @01,COMPTR2(,R4)                                    0190 00719000
         SLR   @03,@03                                             0190 00720000
         IC    @03,CPUREFNO-9(@15,@01)                             0190 00721000
         SLA   @03,3                                               0190 00722000
         ALR   @03,R4                                              0190 00723000
         TM    OPJES3(@03),B'00000100'                             0190 00724000
         BNO   @RF00190                                            0190 00725000
*       DO J=1 TO MAXDEV;           /*                       @G18MB73*/ 00726000
         LA    J,1                                                 0191 00727000
@DL00191 DS    0H                                                  0192 00728000
*         MATCH='0'B;               /* INITIALIZE MATCH      @G18MB73*/ 00729000
*                                                                  0192 00730000
         NI    MATCH,B'01111111'                                   0192 00731000
*         /***********************************************************/ 00732000
*         /*                                                         */ 00733000
*         /* *******************************************     @G18MB73*/ 00734000
*         /* PRODUCE A 'J-UNITNAME' STATEMENT ONLY IF        @G18MB73*/ 00735000
*         /* THE ADDRESS WAS SPECIFIED AS SHARED             @G18MB73*/ 00736000
*         /* VIRTUAL OR VIRTUAL.                             @G18MB73*/ 00737000
*         /* *******************************************     @G18MB73*/ 00738000
*         /*                                                         */ 00739000
*         /***********************************************************/ 00740000
*                                                                  0193 00741000
*         IF USEV(I,J)='1'B&SUPPUNCH(I,J)='0'B THEN/*        @G18MB73*/ 00742000
         LR    @15,I                                               0193 00743000
         SLA   @15,6                                               0193 00744000
         ALR   @15,J                                               0193 00745000
         MH    @15,@CH00034                                        0193 00746000
         L     @01,COMPTR2(,R4)                                    0193 00747000
         ST    @15,@TF00001                                        0193 00748000
         ALR   @15,@01                                             0193 00749000
         AL    @15,@CF00829                                        0193 00750000
         TM    USEV-464(@15),B'01000000'                           0193 00751000
         BNO   @RF00193                                            0193 00752000
         TM    SUPPUNCH-464(@15),B'00001000'                       0193 00753000
         BNZ   @RF00193                                            0193 00754000
*/***********************************************************@G18MB73*/ 00755000
*/* IF USEV THEN CHECK THE INTERFACE OF THE CURRENT ENTRY    @G18MB73*/ 00756000
*/* AGAINST ALL OTHER (FIVE) ENTRIES THAT MIGHT SHARE        @G18MB73*/ 00757000
*/* THE STAGING DRIVE GROUP. IF A DIFFERENT CPU USES ONE     @G18MB73*/ 00758000
*/* OF THE INTERFACES, CHECK TO INSURE THAT THE OTHER        @G18MB73*/ 00759000
*/* CPU DOES NOT USE THE SAME SDG.                           @G18MB73*/ 00760000
*/***********************************************************@G18MB73*/ 00761000
*                                                                  0194 00762000
*           DO;                     /*                       @G18MB73*/ 00763000
*             SAVE1=TODS1(INDEXRSG(I,J)+1);/* 1ST SA VALUE   @G18MB73*/ 00764000
         L     @15,@TF00001                                        0195 00765000
         AL    @01,@CF00837                                        0195 00766000
         SLR   @09,@09                                             0195 00767000
         IC    @09,INDEXRSG-465(@15,@01)                           0195 00768000
         MH    @09,@CH00115                                        0195 00769000
         ALR   @09,R4                                              0195 00770000
         MVC   SAVE1(1),TODS1(@09)                                 0195 00771000
*/***********************************************************@G18MB73*/ 00772000
*/**********************************************             @G18MB73*/ 00773000
*/* RANGE OF VALUES RETURNED TO SAVE1 OR SAVE2               @G18MB73*/ 00774000
*/* IS EITHER 0-F OR FF IF UNUSED                            @G18MB73*/ 00775000
*/**********************************************             @G18MB73*/ 00776000
*/***********************************************************@G18MB73*/ 00777000
*                                                                  0196 00778000
*             DO K=1 TO 3;          /* B,C & D INT.          @G18MB73*/ 00779000
         LA    @15,1                                               0196 00780000
         ST    @15,K                                               0196 00781000
@DL00196 DS    0H                                                  0197 00782000
*               IF CPUREFNO((SAVE1*3)+K)^=CPUREFNO(I)/*      @G18MB73*/ 00783000
*                   &CISPEC((SAVE1*3)+K)='1'B/*              @G18MB73*/ 00784000
*                 THEN              /* SDGCPU ^= CURRENT CPU &     0197 00785000
*                                                            @G18MB73*/ 00786000
*                                                                  0197 00787000
         LA    @01,9                                               0197 00788000
         SLR   @07,@07                                             0197 00789000
         IC    @07,SAVE1                                           0197 00790000
         MH    @07,@CH00051                                        0197 00791000
         ALR   @07,@15                                             0197 00792000
         MR    @06,@01                                             0197 00793000
         L     @15,COMPTR2(,R4)                                    0197 00794000
         LR    @09,@01                                             0197 00795000
         MR    @08,I                                               0197 00796000
         ST    @07,@TF00001                                        0197 00797000
         ALR   @07,@15                                             0197 00798000
         ALR   @09,@15                                             0197 00799000
         CLC   CPUREFNO-9(1,@07),CPUREFNO-9(@09)                   0197 00800000
         BE    @RF00197                                            0197 00801000
         AL    @15,@TF00001                                        0197 00802000
         TM    CISPEC-9(@15),B'10000000'                           0197 00803000
         BNO   @RF00197                                            0197 00804000
*                 /***************************************************/ 00805000
*                 /*                                                 */ 00806000
*                 /* INTERFACE IN USE                        @G18MB73*/ 00807000
*                 /*                                                 */ 00808000
*                 /***************************************************/ 00809000
*                                                                  0198 00810000
*                 DO L=1 TO MAXDEV; /* CHECK DEVICES AGAINST RSG   0198 00811000
*                                                            @G18MB73*/ 00812000
         LA    L,1                                                 0198 00813000
@DL00198 DS    0H                                                  0199 00814000
*                   IF USEV((SAVE1*3)+K,L)='1'B|/*           @G18MB73*/ 00815000
*                       USEVS((SAVE1*3)+K,L)='1'B/*          @G18MB73*/ 00816000
*                     THEN          /*                       @G18MB73*/ 00817000
         LA    @15,11                                              0199 00818000
         SLR   @09,@09                                             0199 00819000
         IC    @09,SAVE1                                           0199 00820000
         MH    @09,@CH00051                                        0199 00821000
         AL    @09,K                                               0199 00822000
         SLA   @09,6                                               0199 00823000
         ALR   @09,L                                               0199 00824000
         MR    @08,@15                                             0199 00825000
         L     @07,COMPTR2(,R4)                                    0199 00826000
         ST    @09,@TF00001                                        0199 00827000
         ALR   @09,@07                                             0199 00828000
         AL    @09,@CF00829                                        0199 00829000
         TM    USEV-464(@09),B'01100000'                           0199 00830000
         BZ    @RF00199                                            0199 00831000
*/***********************************************************@G18MB73*/ 00832000
*/* CHECK THE SDG OF THE CURRENT ADDRESS BEING EXAMINED      @G18MB73*/ 00833000
*/* AGAINST THE SDGS SPECIFIED ON THE OTHER INTS.            @G18MB73*/ 00834000
*/* THAT HAVE A PATH TO THIS SDG. IF THE ADDRESS             @G18MB73*/ 00835000
*/* ON THE OTHER INTERFACE IS USEV OR USEVS, IF              @G18MB73*/ 00836000
*/* A DIFFERENT CPU IS ON THAT INTERFACE, AND IF             @G18MB73*/ 00837000
*/* THAT OTHER CPU USES THE SAME SDG, A J-STATEMENT          @G18MB73*/ 00838000
*/* FOR THE CURRENT DEVICE WILL NOT BE PUNCHED               @G18MB73*/ 00839000
*/***********************************************************@G18MB73*/ 00840000
*                                                                  0200 00841000
*                     IF INDEXRSG(I,J)=INDEXRSG((SAVE1*3)+K,L)/*   0200 00842000
*                                                            @G18MB73*/ 00843000
*                       THEN        /*                       @G18MB73*/ 00844000
         LR    @09,I                                               0200 00845000
         SLA   @09,6                                               0200 00846000
         ALR   @09,J                                               0200 00847000
         MR    @08,@15                                             0200 00848000
         ALR   @09,@07                                             0200 00849000
         AL    @09,@CF00837                                        0200 00850000
         AL    @07,@TF00001                                        0200 00851000
         AL    @07,@CF00837                                        0200 00852000
         CLC   INDEXRSG-465(1,@09),INDEXRSG-465(@07)               0200 00853000
         BNE   @RF00200                                            0200 00854000
*/***********************************************************@G18MB73*/ 00855000
*/*IS CURRENT SDG (DEVICE) ADDRESS  ACCESSIBLE   THROUGH     @G18MB73*/ 00856000
*/*OTHER INTERFACES WHICH MAY HAVE ANOTHER CPU ATTACHED      @G18MB73*/ 00857000
*/***********************************************************@G18MB73*/ 00858000
*                                                                  0201 00859000
*                       DO;         /*                       @G18MB73*/ 00860000
*                         MATCH='1'B;/* MULTI- HOST PATH TO SDG    0202 00861000
*                                                            @G18MB73*/ 00862000
         OI    MATCH,B'10000000'                                   0202 00863000
*                         L=MAXDEV; /* DROP FROM LOOP        @G18MB73*/ 00864000
         LA    L,64                                                0203 00865000
*                       END;        /*                       @G18MB73*/ 00866000
*                 END;              /* END DO L LOOP         @G18MB73*/ 00867000
@RF00200 DS    0H                                                  0205 00868000
@RF00199 AH    L,@CH00045                                          0205 00869000
         CH    L,@CH00256                                          0205 00870000
         BNH   @DL00198                                            0205 00871000
*             END;                  /* END DO K LOOP         @G18MB73*/ 00872000
@RF00197 LA    @15,1                                               0206 00873000
         AL    @15,K                                               0206 00874000
         ST    @15,K                                               0206 00875000
         CH    @15,@CH00051                                        0206 00876000
         BNH   @DL00196                                            0206 00877000
*             IF TODS2(INDEXRSG(I,J)+1)^='FF'X&/*            @G18MB73*/ 00878000
*                 MATCH='0'B        /*                       @G18MB73*/ 00879000
*               THEN                /* 2ND SA IS USED AND    @G18MB73*/ 00880000
*                                                                  0207 00881000
         LR    @15,I                                               0207 00882000
         SLA   @15,6                                               0207 00883000
         ALR   @15,J                                               0207 00884000
         MH    @15,@CH00034                                        0207 00885000
         L     @01,COMPTR2(,R4)                                    0207 00886000
         AL    @01,@CF00837                                        0207 00887000
         SLR   @09,@09                                             0207 00888000
         IC    @09,INDEXRSG-465(@15,@01)                           0207 00889000
         MH    @09,@CH00115                                        0207 00890000
         ST    @09,@TF00001                                        0207 00891000
         ALR   @09,R4                                              0207 00892000
         CLI   TODS2(@09),X'FF'                                    0207 00893000
         BE    @RF00207                                            0207 00894000
         TM    MATCH,B'10000000'                                   0207 00895000
         BNZ   @RF00207                                            0207 00896000
*               /*****************************************************/ 00897000
*               /*                                                   */ 00898000
*               /* SINGLE HOST PATH TO SDG ON FIRST SA       @G18MB73*/ 00899000
*               /*                                                   */ 00900000
*               /*****************************************************/ 00901000
*                                                                  0208 00902000
*               SAVE2=TODS2(INDEXRSG(I,J)+1);/* OPT. 2ND SA VALUE  0208 00903000
*                                                            @G18MB73*/ 00904000
         LR    @15,R4                                              0208 00905000
         AL    @15,@TF00001                                        0208 00906000
         MVC   SAVE2(1),TODS2(@15)                                 0208 00907000
*             DO K=1 TO 3;          /*                       @G18MB73*/ 00908000
@RF00207 LA    @15,1                                               0209 00909000
         ST    @15,K                                               0209 00910000
@DL00209 DS    0H                                                  0210 00911000
*               IF CISPEC((SAVE2*3)+K)='1'B/*                @G18MB73*/ 00912000
*                   &CPUREFNO((SAVE2*3)+K)^=CPUREFNO(I)/*    @G18MB73*/ 00913000
*                 THEN              /* SDGCPU ^= CURRENT CPU &     0210 00914000
*                                                            @G18MB73*/ 00915000
*                                                                  0210 00916000
         LA    @01,9                                               0210 00917000
         SLR   @07,@07                                             0210 00918000
         IC    @07,SAVE2                                           0210 00919000
         MH    @07,@CH00051                                        0210 00920000
         ALR   @07,@15                                             0210 00921000
         MR    @06,@01                                             0210 00922000
         L     @15,COMPTR2(,R4)                                    0210 00923000
         ST    @07,@TF00001                                        0210 00924000
         ALR   @07,@15                                             0210 00925000
         TM    CISPEC-9(@07),B'10000000'                           0210 00926000
         BNO   @RF00210                                            0210 00927000
         LR    @07,@01                                             0210 00928000
         MR    @06,I                                               0210 00929000
         LR    @01,@15                                             0210 00930000
         AL    @01,@TF00001                                        0210 00931000
         ALR   @15,@07                                             0210 00932000
         CLC   CPUREFNO-9(1,@01),CPUREFNO-9(@15)                   0210 00933000
         BE    @RF00210                                            0210 00934000
*                 /***************************************************/ 00935000
*                 /*                                                 */ 00936000
*                 /* INTERFACE IN USE                        @G18MB73*/ 00937000
*                 /*                                                 */ 00938000
*                 /***************************************************/ 00939000
*                                                                  0211 00940000
*                 DO L=1 TO MAXDEV; /*                       @G18MB73*/ 00941000
         LA    L,1                                                 0211 00942000
@DL00211 DS    0H                                                  0212 00943000
*                   IF USEV((SAVE2*3)+K,L)='1'B|/*           @G18MB73*/ 00944000
*                       USEVS((SAVE2*3)+K,L)='1'B/*          @G18MB73*/ 00945000
*                     THEN          /*                       @G18MB73*/ 00946000
         LA    @15,11                                              0212 00947000
         SLR   @09,@09                                             0212 00948000
         IC    @09,SAVE2                                           0212 00949000
         MH    @09,@CH00051                                        0212 00950000
         AL    @09,K                                               0212 00951000
         SLA   @09,6                                               0212 00952000
         ALR   @09,L                                               0212 00953000
         MR    @08,@15                                             0212 00954000
         L     @07,COMPTR2(,R4)                                    0212 00955000
         ST    @09,@TF00001                                        0212 00956000
         ALR   @09,@07                                             0212 00957000
         AL    @09,@CF00829                                        0212 00958000
         TM    USEV-464(@09),B'01100000'                           0212 00959000
         BZ    @RF00212                                            0212 00960000
*                     IF INDEXRSG(I,J)=INDEXRSG((SAVE2*3)+K,L)/*   0213 00961000
*                                                            @G18MB73*/ 00962000
*                       THEN        /*                       @G18MB73*/ 00963000
         LR    @09,I                                               0213 00964000
         SLA   @09,6                                               0213 00965000
         ALR   @09,J                                               0213 00966000
         MR    @08,@15                                             0213 00967000
         ALR   @09,@07                                             0213 00968000
         AL    @09,@CF00837                                        0213 00969000
         AL    @07,@TF00001                                        0213 00970000
         AL    @07,@CF00837                                        0213 00971000
         CLC   INDEXRSG-465(1,@09),INDEXRSG-465(@07)               0213 00972000
         BNE   @RF00213                                            0213 00973000
*                       DO;         /*                       @G18MB73*/ 00974000
*                         MATCH='1'B;/* MULTI- HOST PATH TO SDG    0215 00975000
*                                                            @G18MB73*/ 00976000
         OI    MATCH,B'10000000'                                   0215 00977000
*                         L=MAXDEV; /* DROP FROM LOOP        @G18MB73*/ 00978000
         LA    L,64                                                0216 00979000
*                       END;        /*                       @G18MB73*/ 00980000
*                 END;              /* END DO L LOOP         @G18MB73*/ 00981000
@RF00213 DS    0H                                                  0218 00982000
@RF00212 AH    L,@CH00045                                          0218 00983000
         CH    L,@CH00256                                          0218 00984000
         BNH   @DL00211                                            0218 00985000
*             END;                  /* END DO K LOOP         @G18MB73*/ 00986000
@RF00210 LA    @15,1                                               0219 00987000
         AL    @15,K                                               0219 00988000
         ST    @15,K                                               0219 00989000
         CH    @15,@CH00051                                        0219 00990000
         BNH   @DL00209                                            0219 00991000
*           END;                    /* NOT USEV              @G18MB73*/ 00992000
*         IF USEV(I,J)='1'B&SUPPUNCH(I,J)='0'B&MATCH='0'B/*  @G18MB73*/ 00993000
*             |USEVS(I,J)='1'B&SUPPUNCH(I,J)='0'B/* SINGLE CPU PATH     00994000
*                                      TO SDG AND PROPER USE O.K.THEN   00995000
*                                      SETUP FOR J-CARD OUTPUT     0221 00996000
*                                                            @G18MB73*/ 00997000
*           THEN                    /*                       @G18MB73*/ 00998000
@RF00193 LR    @15,I                                               0221 00999000
         SLA   @15,6                                               0221 01000000
         ALR   @15,J                                               0221 01001000
         MH    @15,@CH00034                                        0221 01002000
         L     @01,COMPTR2(,R4)                                    0221 01003000
         ALR   @01,@15                                             0221 01004000
         AL    @01,@CF00829                                        0221 01005000
         TM    USEV-464(@01),B'01000000'                           0221 01006000
         BNO   @GL00012                                            0221 01007000
         TM    SUPPUNCH-464(@01),B'00001000'                       0221 01008000
         BNZ   @GL00012                                            0221 01009000
         TM    MATCH,B'10000000'                                   0221 01010000
         BZ    @RT00221                                            0221 01011000
@GL00012 LR    @15,I                                               0221 01012000
         SLA   @15,6                                               0221 01013000
         ALR   @15,J                                               0221 01014000
         MH    @15,@CH00034                                        0221 01015000
         L     @01,COMPTR2(,R4)                                    0221 01016000
         ALR   @01,@15                                             0221 01017000
         AL    @01,@CF00829                                        0221 01018000
         TM    USEVS-464(@01),B'00100000'                          0221 01019000
         BNO   @RF00221                                            0221 01020000
         TM    SUPPUNCH-464(@01),B'00001000'                       0221 01021000
         BNZ   @RF00221                                            0221 01022000
@RT00221 DS    0H                                                  0222 01023000
*           CALL BUILDIT;           /* BUILD INBUF IMAGE     @G18MB73*/ 01024000
         BAL   @14,BUILDIT                                         0222 01025000
*       END;                        /* J LOOP                @G18MB73*/ 01026000
@RF00221 AH    J,@CH00045                                          0223 01027000
         CH    J,@CH00256                                          0223 01028000
         BNH   @DL00191                                            0223 01029000
*   END;                            /* I LOOP                @G18MB73*/ 01030000
*                                                                  0224 01031000
@RF00190 AH    I,@CH00045                                          0224 01032000
         CH    I,@CH00246                                          0224 01033000
         BNH   @DL00189                                            0224 01034000
*   /*****************************************************************/ 01035000
*   /*                                                               */ 01036000
*   /* ***********************************************       @G18MB73*/ 01037000
*   /* END THE FINAL GROUP, PRINT AND PUNCH IT, AND          @G18MB73*/ 01038000
*   /* CLOSE SYSPUNCH. RETURN TO ICGDSBLD.                   @G18MB73*/ 01039000
*   /* ***********************************************       @G18MB73*/ 01040000
*   /*                                                               */ 01041000
*   /*****************************************************************/ 01042000
*                                                                  0225 01043000
*   CALL ENDGRP;                    /* END A GROUP ON CARD IMAGE   0225 01044000
*                                                            @G18MB73*/ 01045000
         BAL   @14,ENDGRP                                          0225 01046000
*   CALL PUTOUTCD;                  /* PUNCH A CARD          @G18MB73*/ 01047000
         BAL   @14,PUTOUTCD                                        0226 01048000
*   CALL ENDDATA;                   /* CLOSE SYSPUNCH        @G18MB73*/ 01049000
         BAL   @14,ENDDATA                                         0227 01050000
*   RETURN;                         /* RETURN TO CALLER - MAINLINE -    01051000
*                                                            @G18MB73*/ 01052000
         B     @EL00001                                            0228 01053000
*                                                                  0229 01054000
*/********************************************************** @YD00113*/ 01055000
*/*                                                          @YD00113*/ 01056000
*/* PROCEDURE NAME - CPUIDP                                  @YD00113*/ 01057000
*/*                                                          @YD00113*/ 01058000
*/* FUNCTION - UNPACK THE FIELD CONTAINING MANUFCATURER'S    @YD00113*/ 01059000
*/*            INDETIFICATION (6 DIGITS OF MACHINE SERIAL    @YD00113*/ 01060000
*/*            NUMBER AND 4 DIGITS OF MACHINE MODEL NUMBER)  @YD00113*/ 01061000
*/*            SO THAT DIGITS 2-6 OF SERIAL NUMBER CAN BE    @YD00113*/ 01062000
*/*            PLACED IN THE LABEL FIELD.                    @YD00113*/ 01063000
*/*                                                          @YD00113*/ 01064000
*/********************************************************** @YD00113*/ 01065000
*                                                                  0229 01066000
*CPUIDP:                                                           0229 01067000
*   PROCEDURE;                      /*                       @Y30LB14*/ 01068000
CPUIDP   STM   @14,@12,@SA00002                                    0229 01069000
*   PACKED(1:5)=RSGCPUID(I);        /*                       @Y30LB14*/ 01070000
         LR    @15,I                                               0230 01071000
         MH    @15,@CH00115                                        0230 01072000
         L     @01,COMPTR2(,R4)                                    0230 01073000
         ALR   @01,@15                                             0230 01074000
         MVC   PACKED(5),RSGCPUID-9(@01)                           0230 01075000
*   PACKED(6)='0F'X;                /*                       @Y30LB14*/ 01076000
         MVI   PACKED+5,X'0F'                                      0231 01077000
*   GEN(UNPK UNPACKED(11),PACKED(6));/*                      @Y30LB14*/ 01078000
         UNPK UNPACKED(11),PACKED(6)                                    01079000
*   RETURN;                         /*                       @Y30LB14*/ 01080000
@EL00002 DS    0H                                                  0233 01081000
@EF00002 DS    0H                                                  0233 01082000
@ER00002 LM    @14,@12,@SA00002                                    0233 01083000
         BR    @14                                                 0233 01084000
*   END CPUIDP;                     /*                       @Y30LB14*/ 01085000
*                                                                  0235 01086000
*/********************************************************** @YD00113*/ 01087000
*/*                                                          @YD00113*/ 01088000
*/* PROCEDURE NAME - SEQUENCE                                @YD00113*/ 01089000
*/*                                                          @YD00113*/ 01090000
*/* FUNCTION - CONVERT THE INTERNALLY DEVELOPED BINARY       @YD00113*/ 01091000
*/*            SEQUENCE NUMBER TO TWO PRINATBLE DECIMAL      @YD00113*/ 01092000
*/*            DIGITS AND PLACE IN POSITIONS 7 AND 8 OF      @YD00113*/ 01093000
*/*            LABEL FIELD ON IODEVICE RECORDS ONLY.         @YD00113*/ 01094000
*/*            DETERMINATION IS MADE TO PROPERLY FORMAT      @OZ09534*/ 01095000
*/*            OUTPUT BUFFER ACCORDING TO CURRENT ACTIVE     @OZ09534*/ 01096000
*/*            ROUTINE AND OVERFLOW CONDITIONS.              @OZ09534*/ 01097000
*/*                                                          @OZ09534*/ 01098000
*/********************************************************** @YD00113*/ 01099000
*                                                                  0235 01100000
*SEQUENCE:                                                         0235 01101000
*   PROCEDURE;                      /*                       @Y30LB14*/ 01102000
SEQUENCE STM   @14,@12,12(@13)                                     0235 01103000
*   IF SETSEQ='0'B&SORTSEQ='0'B THEN/*                       @OZ09534*/ 01104000
         TM    SETSEQ,B'00001000'                                  0236 01105000
         BNZ   @RF00236                                            0236 01106000
         TM    SORTSEQ,B'10000000'                                 0236 01107000
         BNZ   @RF00236                                            0236 01108000
*     DO;                           /*                       @OZ09534*/ 01109000
*                                                                  0237 01110000
*       /*************************************************************/ 01111000
*       /*                                                           */ 01112000
*       /* REQUIRE SEQUENCE IN ID FIELD DESPITE              @OZ09534*/ 01113000
*       /* POSS. OVERFLOW CONDITIONS                         @OZ09534*/ 01114000
*       /*                                                           */ 01115000
*       /*************************************************************/ 01116000
*                                                                  0238 01117000
*       UD=SEQNUM//10;              /*                       @Y30LB14*/ 01118000
         MVC   @ZT00002+2(2),SEQNUM                                0238 01119000
         L     @15,@ZT00002                                        0238 01120000
         LA    @01,10                                              0238 01121000
         LR    @02,@15                                             0238 01122000
         SRDA  @02,32                                              0238 01123000
         DR    @02,@01                                             0238 01124000
         LR    UD,@02                                              0238 01125000
*       INBUF(8)=TABLE(UD+1);       /*                       @Y30LB14*/ 01126000
         LA    @09,TABLE(UD)                                       0239 01127000
         MVC   INBUF+7(1,R4),0(@09)                                0239 01128000
*       UD=(SEQNUM/10)//10;         /*                       @Y30LB14*/ 01129000
         LR    @03,@15                                             0240 01130000
         SLR   @02,@02                                             0240 01131000
         DR    @02,@01                                             0240 01132000
         LR    @06,@03                                             0240 01133000
         SRDA  @06,32                                              0240 01134000
         DR    @06,@01                                             0240 01135000
         LR    UD,@06                                              0240 01136000
*       INBUF(7)=TABLE(UD+1);       /*                       @Y30LB14*/ 01137000
         LA    @01,TABLE(UD)                                       0241 01138000
         MVC   INBUF+6(1,R4),0(@01)                                0241 01139000
*       INBUF(73:77)=INBUF(2:6);    /*                       @OZ09534*/ 01140000
         MVC   INBUF+72(5,R4),INBUF+1(R4)                          0242 01141000
*       UD=(SEQNUM/100)//100;       /* HIGH-ORDER DIGIT      @OZ09534*/ 01142000
         LA    @01,100                                             0243 01143000
         LR    @03,@15                                             0243 01144000
         SLR   @02,@02                                             0243 01145000
         DR    @02,@01                                             0243 01146000
         LR    @06,@03                                             0243 01147000
         SRDA  @06,32                                              0243 01148000
         DR    @06,@01                                             0243 01149000
         LR    UD,@06                                              0243 01150000
*       INBUF(78)=TABLE(UD+1);      /* HIGH-ORDER DIGIT      @OZ09534*/ 01151000
         LA    @15,TABLE(UD)                                       0244 01152000
         MVC   INBUF+77(1,R4),0(@15)                               0244 01153000
*       INBUF(79)=INBUF(7);         /*                       @OZ09534*/ 01154000
         MVC   INBUF+78(1,R4),INBUF+6(R4)                          0245 01155000
*       INBUF(80)=INBUF(8);         /*                       @OZ09534*/ 01156000
         MVC   INBUF+79(1,R4),INBUF+7(R4)                          0246 01157000
*       RETURN;                     /*                       @Y30LB14*/ 01158000
@EL00003 DS    0H                                                  0247 01159000
@EF00003 DS    0H                                                  0247 01160000
@ER00003 LM    @14,@12,12(@13)                                     0247 01161000
         BR    @14                                                 0247 01162000
*     END;                          /*                       @OZ09534*/ 01163000
*                                                                  0248 01164000
*   /*****************************************************************/ 01165000
*   /*                                                               */ 01166000
*   /* CONTINUATION SORT SEQUENCE NUMBER                     @OZ09534*/ 01167000
*   /*                                                               */ 01168000
*   /*****************************************************************/ 01169000
*                                                                  0249 01170000
*   ELSE                                                           0249 01171000
*     DO;                           /* UNITNAME SORT INFO OR OVRFLW     01172000
*                                      COND.                 @OZ09534*/ 01173000
@RF00236 DS    0H                                                  0250 01174000
*       IF SETSEQ='0'B THEN         /* IN UNITNAME           @OZ09534*/ 01175000
         TM    SETSEQ,B'00001000'                                  0250 01176000
         BNZ   @RF00250                                            0250 01177000
*         INBUF(73:77)=INBUF(2:6);  /*                       @OZ09534*/ 01178000
         MVC   INBUF+72(5,R4),INBUF+1(R4)                          0251 01179000
*       UD=(SEQNUM/100)//100;       /* HIGH-ORDER DIGIT      @OZ09534*/ 01180000
@RF00250 LA    @15,100                                             0252 01181000
         MVC   @ZT00002+2(2),SEQNUM                                0252 01182000
         L     @01,@ZT00002                                        0252 01183000
         LR    @03,@01                                             0252 01184000
         SLR   @02,@02                                             0252 01185000
         DR    @02,@15                                             0252 01186000
         LR    @06,@03                                             0252 01187000
         SRDA  @06,32                                              0252 01188000
         DR    @06,@15                                             0252 01189000
         LR    UD,@06                                              0252 01190000
*       INBUF(78)=TABLE(UD+1);      /* HIGH-ORDER DIGIT      @OZ09534*/ 01191000
         LA    @15,TABLE(UD)                                       0253 01192000
         MVC   INBUF+77(1,R4),0(@15)                               0253 01193000
*       UD=SEQNUM//10;              /*                       @OZ09534*/ 01194000
         LA    @15,10                                              0254 01195000
         LR    @02,@01                                             0254 01196000
         SRDA  @02,32                                              0254 01197000
         DR    @02,@15                                             0254 01198000
         LR    UD,@02                                              0254 01199000
*       INBUF(80)=TABLE(UD+1);      /*                       @OZ09534*/ 01200000
         LA    @09,TABLE(UD)                                       0255 01201000
         MVC   INBUF+79(1,R4),0(@09)                               0255 01202000
*       UD=(SEQNUM/10)//10;         /*                       @OZ09534*/ 01203000
         LR    @03,@01                                             0256 01204000
         SLR   @02,@02                                             0256 01205000
         DR    @02,@15                                             0256 01206000
         LR    @06,@03                                             0256 01207000
         SRDA  @06,32                                              0256 01208000
         DR    @06,@15                                             0256 01209000
         LR    UD,@06                                              0256 01210000
*       INBUF(79)=TABLE(UD+1);      /*                       @OZ09534*/ 01211000
         LA    @15,TABLE(UD)                                       0257 01212000
         MVC   INBUF+78(1,R4),0(@15)                               0257 01213000
*       RETURN;                     /*                       @OZ09534*/ 01214000
         B     @EL00003                                            0258 01215000
*     END;                          /*                       @OZ09534*/ 01216000
*   END SEQUENCE;                   /*                       @Y30LB14*/ 01217000
*                                                                  0261 01218000
*/********************************************************** @YD00113*/ 01219000
*/*                                                          @YD00113*/ 01220000
*/* PROCEDURE NAME - CUDADDR                                 @YD00113*/ 01221000
*/*                                                          @YD00113*/ 01222000
*/* FUNCTION - DEVELOP THE PRINTABLE CHANNEL/CONTROL UNIT/   @YD00113*/ 01223000
*/*            DEVICE ADDRESS OF THE UCB AND PLACE IT IN     @YD00113*/ 01224000
*/*            STRUCTURE 'CUD'.                              @YD00113*/ 01225000
*/*                                                          @YD00113*/ 01226000
*/********************************************************** @YD00113*/ 01227000
*                                                                  0261 01228000
*CUDADDR:                                                          0261 01229000
*   PROCEDURE;                      /*                       @Y30LB14*/ 01230000
*                                                                  0261 01231000
CUDADDR  STM   @14,@12,12(@13)                                     0261 01232000
*   /*****************************************************************/ 01233000
*   /*                                                               */ 01234000
*   /* ***********************************************       @YD00113*/ 01235000
*   /* CHANNEL IS CONVERTED DIRECTLY FORM THE BINARY         @YD00113*/ 01236000
*   /* NUMBER STORED IN RSGCHAN BY ICGDSS04. 1 IS            @YD00113*/ 01237000
*   /* ADDED BECAUSE THE FIRST ENTRY IN THE 'TABLE'          @YD00113*/ 01238000
*   /* STRUCTURE IS THE CHARACTER 0.                         @YD00113*/ 01239000
*   /* ***********************************************       @YD00113*/ 01240000
*   /*                                                               */ 01241000
*   /*****************************************************************/ 01242000
*                                                                  0262 01243000
*   CHANNEL=TABLE(RSGCHAN(I)+1);    /*                       @Y30LB14*/ 01244000
*                                                                  0262 01245000
         LR    @15,I                                               0262 01246000
         MH    @15,@CH00115                                        0262 01247000
         L     @07,COMPTR2(,R4)                                    0262 01248000
         SLR   @01,@01                                             0262 01249000
         IC    @01,RSGCHAN-9(@15,@07)                              0262 01250000
         LA    @09,TABLE(@01)                                      0262 01251000
         MVC   CHANNEL(1),0(@09)                                   0262 01252000
*   /*****************************************************************/ 01253000
*   /*                                                               */ 01254000
*   /* ***********************************************       @YD00113*/ 01255000
*   /* CONTROL UNIT ADDRESS CONSISTS OF TWO BITS OF          @YD00113*/ 01256000
*   /* CONTROL UNIT (SPECIFIED IN 'CUID' PARAMETER           @YD00113*/ 01257000
*   /* IN THE UPPERCON STATEMENT) PLUS THE HIGH-ORDER        @YD00113*/ 01258000
*   /* TWO BITS OF DEVICE (SPECIFIED IN 'ADDR' OR            @YD00113*/ 01259000
*   /* 'REAL' OR 'CONVREAL' IN THE UPPERCON                  @YD00113*/ 01260000
*   /* STATEMENT).                                           @YD00113*/ 01261000
*   /* ***********************************************       @YD00113*/ 01262000
*   /*                                                               */ 01263000
*   /*****************************************************************/ 01264000
*                                                                  0263 01265000
*   UD=RSGCUA(I)*64+J-1;            /*                       @Y30LB14*/ 01266000
         SLR   UD,UD                                               0263 01267000
         IC    UD,RSGCUA-9(@15,@07)                                0263 01268000
         SLA   UD,6                                                0263 01269000
         ALR   UD,J                                                0263 01270000
         BCTR  UD,0                                                0263 01271000
*   BYT=UD/16;                      /*                       @Y30LB14*/ 01272000
         LR    BYT,UD                                              0264 01273000
         SRL   BYT,4                                               0264 01274000
*   UNIT=TABLE(BYT+1);              /*                       @Y30LB14*/ 01275000
         LA    @15,TABLE(BYT)                                      0265 01276000
         MVC   UNIT(1),0(@15)                                      0265 01277000
*   BYT=UD//16;                     /*                       @Y30LB14*/ 01278000
*                                                                  0266 01279000
         LR    BYT,UD                                              0266 01280000
         N     BYT,@CF00066                                        0266 01281000
*   /*****************************************************************/ 01282000
*   /*                                                               */ 01283000
*   /* ***********************************************       @YD00113*/ 01284000
*   /* 'DEVICE' IS THE CHARACTER REPRESENTATION OF           @YD00113*/ 01285000
*   /* THE FOUR LOW-ORDER BITS SPECIFIED IN 'ADDR'           @YD00113*/ 01286000
*   /* OR 'REAL' OR 'CONVREAL' IN THE UPPERCON               @YD00113*/ 01287000
*   /* STATEMENT.                                            @YD00113*/ 01288000
*   /* ***********************************************       @YD00113*/ 01289000
*   /*                                                               */ 01290000
*   /*****************************************************************/ 01291000
*                                                                  0267 01292000
*   DEVICE=TABLE(BYT+1);            /*                       @Y30LB14*/ 01293000
         LA    @15,TABLE(BYT)                                      0267 01294000
         MVC   DEVICE(1),0(@15)                                    0267 01295000
*   RETURN;                         /* RETURN TO CALLER      @Y30LB14*/ 01296000
@EL00004 DS    0H                                                  0268 01297000
@EF00004 DS    0H                                                  0268 01298000
@ER00004 LM    @14,@12,12(@13)                                     0268 01299000
         BR    @14                                                 0268 01300000
*   END CUDADDR;                    /*                       @Y30LB14*/ 01301000
*                                                                  0270 01302000
*/********************************************************** @YD00113*/ 01303000
*/*                                                          @YD00113*/ 01304000
*/* PROCEDURE NAME - OPTCHAN                                 @YD00113*/ 01305000
*/*                                                          @YD00113*/ 01306000
*/* FUNCTION - THIS ROUTINE DETERMINES IF ANY INFORMATION IS @YD00113*/ 01307000
*/*            PRESENT IN THE ALTERNATE PATHS.  IF THERE IS, @YD00113*/ 01308000
*/*            THEN THE BINARY FORM OF THE NUMBER FOUND      @YD00113*/ 01309000
*/*            IS SORTED AND PLACED IN THE OPTCHAN PORTION   @YD00113*/ 01310000
*/*            OF THE IODEVICE CARD.  IF ONLY TWO ENTRIES    @YD00113*/ 01311000
*/*            ARE FOUND THEN SORT2 IS CALLED.  IF THREE     @YD00113*/ 01312000
*/*            ENRTIES  ARE FOUND, THE SORT3 IS CALLED.      @YD00113*/ 01313000
*/*                                                          @YD00113*/ 01314000
*/********************************************************** @YD00113*/ 01315000
*                                                                  0270 01316000
*OPTCHAN:                                                          0270 01317000
*   PROCEDURE;                      /*                       @Y30LB14*/ 01318000
*                                                                  0270 01319000
OPTCHAN  STM   @14,@04,@SA00005                                    0270 01320000
         STM   @06,@12,@SA00005+28                                 0270 01321000
*   /*****************************************************************/ 01322000
*   /*                                                               */ 01323000
*   /* ***********************************************       @OZ09548*/ 01324000
*   /*                                                       @OZ09548*/ 01325000
*   /* ZERO OUT WORK AREA FOR NEW BUILD                      @OZ09548*/ 01326000
*   /*                                                       @OZ09548*/ 01327000
*   /* ***********************************************       @OZ09548*/ 01328000
*   /*                                                               */ 01329000
*   /*****************************************************************/ 01330000
*                                                                  0271 01331000
*   WRKCH(1)=0;                     /*                       @OZ09548*/ 01332000
         SLR   @15,@15                                             0271 01333000
         ST    @15,WRKCH                                           0271 01334000
*   WRKCH(2)=0;                     /*                       @OZ09548*/ 01335000
         ST    @15,WRKCH+4                                         0272 01336000
*   WRKCH(3)=0;                     /*                       @OZ09548*/ 01337000
*                                                                  0273 01338000
         ST    @15,WRKCH+8                                         0273 01339000
*   /*****************************************************************/ 01340000
*   /*                                                               */ 01341000
*   /* ***********************************************       @YD00113*/ 01342000
*   /* ALTERNATE PATH FIELDS ARE CREATED IN SEQUENCE.        @YD00113*/ 01343000
*   /* THEREFORE, IF ALTPATH1 CONTAINS ZEROS, BOTH           @YD00113*/ 01344000
*   /* ALTPATH2 AND ALTPATH3 ALSO CONTAIN ZEROS. IF          @YD00113*/ 01345000
*   /* ALTPATH2 CONTAINS ZEROS, ALTPATH3 ALSO                @YD00113*/ 01346000
*   /* CONTAINS ZEROS.                                       @YD00113*/ 01347000
*   /* ***********************************************       @YD00113*/ 01348000
*   /*                                                               */ 01349000
*   /*****************************************************************/ 01350000
*                                                                  0274 01351000
*   IF ALTPATH1(I,J)^=0 THEN                                       0274 01352000
         LR    @15,I                                               0274 01353000
         SLA   @15,6                                               0274 01354000
         ALR   @15,J                                               0274 01355000
         MH    @15,@CH00034                                        0274 01356000
         L     @01,COMPTR2(,R4)                                    0274 01357000
         ALR   @01,@15                                             0274 01358000
         AL    @01,@CF00839                                        0274 01359000
         MVC   @ZT00001+1(3),ALTPATH1-466(@01)                     0274 01360000
         L     @15,@ZT00001                                        0274 01361000
         LTR   @15,@15                                             0274 01362000
         BZ    @RF00274                                            0274 01363000
*     DO;                           /*                       @Y30LB14*/ 01364000
*       IF FS='1'B THEN             /*                       @OZ09534*/ 01365000
         TM    FS,B'01000000'                                      0276 01366000
         BNO   @RF00276                                            0276 01367000
*/* FEATURE SHARED & OPTCHAN WILL CREATE OVERFLOW CONDITION  @OZ09534*/ 01368000
*                                                                  0277 01369000
*         OVRFLW='1'B;              /*                       @OZ09534*/ 01370000
         OI    OVRFLW,B'00010000'                                  0277 01371000
*       ELSE                                                       0278 01372000
*         ;                         /*                       @OZ09534*/ 01373000
*                                                                  0278 01374000
@RF00276 DS    0H                                                  0279 01375000
*       /*************************************************************/ 01376000
*       /*                                                           */ 01377000
*       /* *******************************************       @YD00113*/ 01378000
*       /* SET UP FOR THE BASIC OPTCHAN FIELD AND            @YD00113*/ 01379000
*       /* ASSUME THAT ONLY ONE ALTERNATE PATH IS            @YD00113*/ 01380000
*       /* SPECIFIED.                                        @YD00113*/ 01381000
*       /* *******************************************       @YD00113*/ 01382000
*       /*                                                           */ 01383000
*       /*************************************************************/ 01384000
*                                                                  0279 01385000
*       INBUF(N:N+9)=',OPTCHAN=(';  /*                       @Y30LB14*/ 01386000
         LR    @15,R4                                              0279 01387000
         ALR   @15,N                                               0279 01388000
         MVC   INBUF-1(10,@15),@CC00729                            0279 01389000
*       N=N+10;                     /*                       @Y30LB14*/ 01390000
         AH    N,@CH00033                                          0280 01391000
*       CH(1)=ALTCH1(I,J);          /*                       @Y30LB14*/ 01392000
*                                                                  0281 01393000
         LR    @15,I                                               0281 01394000
         SLA   @15,6                                               0281 01395000
         ALR   @15,J                                               0281 01396000
         MH    @15,@CH00034                                        0281 01397000
         L     @01,COMPTR2(,R4)                                    0281 01398000
         LA    @09,0(@15,@01)                                      0281 01399000
         AL    @09,@CF00840                                        0281 01400000
         SLR   @08,@08                                             0281 01401000
         IC    @08,ALTCH1-468(,@09)                                0281 01402000
         ST    @08,CH                                              0281 01403000
*       /*************************************************************/ 01404000
*       /*                                                           */ 01405000
*       /* *******************************************       @YD00113*/ 01406000
*       /* IF SECOND ALTERNATE PATH IS SPECIFIED,            @YD00113*/ 01407000
*       /* SAVE SECOND ALTERNATE CHANNEL AND CHECK           @YD00113*/ 01408000
*       /* TO SEE IF THIRD ALTERNATE PATH IS PRESENT         @YD00113*/ 01409000
*       /* *******************************************       @YD00113*/ 01410000
*       /*                                                           */ 01411000
*       /*************************************************************/ 01412000
*                                                                  0282 01413000
*       IF ALTPATH2(I,J)^=0         /*                       @OZ09548*/ 01414000
*         THEN                                                     0282 01415000
         ST    @15,@TF00001                                        0282 01416000
         ALR   @15,@01                                             0282 01417000
         AL    @15,@CF00841                                        0282 01418000
         MVC   @ZT00001+1(3),ALTPATH2-469(@15)                     0282 01419000
         L     @15,@ZT00001                                        0282 01420000
         LTR   @15,@15                                             0282 01421000
         BZ    @RF00282                                            0282 01422000
*         DO;                       /*                       @Y30LB14*/ 01423000
*           CH(2)=ALTCH2(I,J);      /*                       @Y30LB14*/ 01424000
*                                                                  0284 01425000
         L     @15,@TF00001                                        0284 01426000
         AL    @15,@CF00842                                        0284 01427000
         SLR   @09,@09                                             0284 01428000
         IC    @09,ALTCH2-471(@15,@01)                             0284 01429000
         ST    @09,CH+4                                            0284 01430000
*           /*********************************************************/ 01431000
*           /*                                                       */ 01432000
*           /* ***************************************       @YD00113*/ 01433000
*           /* IF THIRD ALTERNATE PATH IS PRESENT,           @YD00113*/ 01434000
*           /* SORT THE THREE ALTERNATE CHANNELS TO          @YD00113*/ 01435000
*           /* ASCENDING SEQUENCE, PLACE THE                 @YD00113*/ 01436000
*           /* CHARACTER REPRESENTATIONS IN THE              @YD00113*/ 01437000
*           /* OPTCHAN FIELDS, BUMP THE NEXT COLUMN          @YD00113*/ 01438000
*           /* POINTER BY 6, AND RETURN TO THE               @YD00113*/ 01439000
*           /* IODSTRT ROUTINE FOR IODEVICE.                 @OZ09548*/ 01440000
*           /* ***************************************       @YD00113*/ 01441000
*           /*                                                       */ 01442000
*           /*********************************************************/ 01443000
*                                                                  0285 01444000
*           IF ALTPATH3(I,J)^=0     /*                       @OZ09548*/ 01445000
*             THEN                                                 0285 01446000
         LR    @15,@01                                             0285 01447000
         AL    @15,@TF00001                                        0285 01448000
         AL    @15,@CF00843                                        0285 01449000
         MVC   @ZT00001+1(3),ALTPATH3-472(@15)                     0285 01450000
         L     @15,@ZT00001                                        0285 01451000
         LTR   @15,@15                                             0285 01452000
         BZ    @RF00285                                            0285 01453000
*             DO;                   /*                       @Y30LB14*/ 01454000
*               CH(3)=ALTCH3(I,J);  /*                       @Y30LB14*/ 01455000
         L     @15,@TF00001                                        0287 01456000
         AL    @01,@CF00844                                        0287 01457000
         SLR   @09,@09                                             0287 01458000
         IC    @09,ALTCH3-474(@15,@01)                             0287 01459000
         ST    @09,CH+8                                            0287 01460000
*               CALL SORT3;         /* SORT THREE NUMBERS    @Y30LB14*/ 01461000
         BAL   @14,SORT3                                           0288 01462000
*               DO K=1 TO 3;        /* MOVE CHANNEL FIELDS TO SAVE 0289 01463000
*                                                            @OZ09548*/ 01464000
         LA    @15,1                                               0289 01465000
         ST    @15,K                                               0289 01466000
@DL00289 DS    0H                                                  0290 01467000
*                 WRKCH(K)=CH(K);   /*                       @OZ09548*/ 01468000
         LR    @01,@15                                             0290 01469000
         SLA   @01,2                                               0290 01470000
         L     @09,CH-4(@01)                                       0290 01471000
         ST    @09,WRKCH-4(@01)                                    0290 01472000
*               END;                /*                       @OZ09548*/ 01473000
         AH    @15,@CH00045                                        0291 01474000
         ST    @15,K                                               0291 01475000
         CH    @15,@CH00051                                        0291 01476000
         BNH   @DL00289                                            0291 01477000
*               INBUF(N+1:N+5)=', , )';/*                    @Y30LB14*/ 01478000
         LR    @15,R4                                              0292 01479000
         ALR   @15,N                                               0292 01480000
         MVC   INBUF(5,@15),@CC00732                               0292 01481000
*               INBUF(N)=TABLE(CH(1)+1);/*                   @Y30LB14*/ 01482000
         LR    @15,R4                                              0293 01483000
         ALR   @15,N                                               0293 01484000
         L     @01,CH                                              0293 01485000
         LA    @09,TABLE(@01)                                      0293 01486000
         MVC   INBUF-1(1,@15),0(@09)                               0293 01487000
*               INBUF(N+2)=TABLE(CH(2)+1);/*                 @Y30LB14*/ 01488000
         LR    @15,R4                                              0294 01489000
         ALR   @15,N                                               0294 01490000
         L     @01,CH+4                                            0294 01491000
         LA    @09,TABLE(@01)                                      0294 01492000
         MVC   INBUF+1(1,@15),0(@09)                               0294 01493000
*               INBUF(N+4)=TABLE(CH(3)+1);/*                 @Y30LB14*/ 01494000
         LR    @15,R4                                              0295 01495000
         ALR   @15,N                                               0295 01496000
         L     @01,CH+8                                            0295 01497000
         LA    @09,TABLE(@01)                                      0295 01498000
         MVC   INBUF+3(1,@15),0(@09)                               0295 01499000
*               N=N+6;              /*                       @Y30LB14*/ 01500000
         AH    N,@CH00229                                          0296 01501000
*               RETURN;             /*                       @Y30LB14*/ 01502000
@EL00005 DS    0H                                                  0297 01503000
@EF00005 DS    0H                                                  0297 01504000
@ER00005 LM    @14,@04,@SA00005                                    0297 01505000
         LM    @06,@12,@SA00005+28                                 0297 01506000
         BR    @14                                                 0297 01507000
*             END;                  /*                       @Y30LB14*/ 01508000
*                                                                  0298 01509000
*           /*********************************************************/ 01510000
*           /*                                                       */ 01511000
*           /* ***************************************       @YD00113*/ 01512000
*           /* IF ONLY TWO ALTERNATE PATHS ARE               @YD00113*/ 01513000
*           /* PRESENT, SORT THE TWO TO ASCENDING            @YD00113*/ 01514000
*           /* SEQUENCE, PLACE THE CHARACTER                 @YD00113*/ 01515000
*           /* REPRESENTATIONS IN THE OPTCHAN FIELDS,        @YD00113*/ 01516000
*           /* BUMP THE NEXT COLUMN POINTER BY 4,            @YD00113*/ 01517000
*           /* AND RETURN TO THE IODSTRT ROUTINE FOR         @OZ09548*/ 01518000
*           /* IODEVICE.                                     @YD00113*/ 01519000
*           /* ***************************************       @YD00113*/ 01520000
*           /*                                                       */ 01521000
*           /*********************************************************/ 01522000
*                                                                  0299 01523000
*           K=1;                    /*                       @Y30LB14*/ 01524000
@RF00285 MVC   K(4),@CF00045                                       0299 01525000
*           CALL SORT2;             /* SORT TWO NUMBERS      @Y30LB14*/ 01526000
         BAL   @14,SORT2                                           0300 01527000
*           DO K=1 TO 3;            /* MOVE CHANNEL FIELDS TO SAVE 0301 01528000
*                                                            @OZ09548*/ 01529000
         LA    @15,1                                               0301 01530000
         ST    @15,K                                               0301 01531000
@DL00301 DS    0H                                                  0302 01532000
*             WRKCH(K)=CH(K);       /*                       @OZ09548*/ 01533000
         LR    @01,@15                                             0302 01534000
         SLA   @01,2                                               0302 01535000
         L     @09,CH-4(@01)                                       0302 01536000
         ST    @09,WRKCH-4(@01)                                    0302 01537000
*           END;                    /*                       @OZ09548*/ 01538000
         AL    @15,@CF00045                                        0303 01539000
         ST    @15,K                                               0303 01540000
         CH    @15,@CH00051                                        0303 01541000
         BNH   @DL00301                                            0303 01542000
*           INBUF(N+1:N+3)=', )';   /*                       @Y30LB14*/ 01543000
         LR    @15,R4                                              0304 01544000
         ALR   @15,N                                               0304 01545000
         MVC   INBUF(3,@15),@CC00734                               0304 01546000
*           INBUF(N)=TABLE(CH(1)+1);/*                       @Y30LB14*/ 01547000
         LR    @15,R4                                              0305 01548000
         ALR   @15,N                                               0305 01549000
         L     @01,CH                                              0305 01550000
         LA    @09,TABLE(@01)                                      0305 01551000
         MVC   INBUF-1(1,@15),0(@09)                               0305 01552000
*           INBUF(N+2)=TABLE(CH(2)+1);/*                     @Y30LB14*/ 01553000
         LR    @15,R4                                              0306 01554000
         ALR   @15,N                                               0306 01555000
         L     @01,CH+4                                            0306 01556000
         LA    @09,TABLE(@01)                                      0306 01557000
         MVC   INBUF+1(1,@15),0(@09)                               0306 01558000
*           N=N+4;                  /*                       @Y30LB14*/ 01559000
         AH    N,@CH00071                                          0307 01560000
*           RETURN;                 /*                       @Y30LB14*/ 01561000
         B     @EL00005                                            0308 01562000
*         END;                      /*                       @Y30LB14*/ 01563000
*                                                                  0309 01564000
*       /*************************************************************/ 01565000
*       /*                                                           */ 01566000
*       /* *******************************************       @YD00113*/ 01567000
*       /* IF ONLY ONE ALTERNATE PATH IS PRESENT,            @YD00113*/ 01568000
*       /* PLACE THE CHARACTER REPRESENTATION OF THE         @YD00113*/ 01569000
*       /* CHANNEL IN THE OPTCHAN FIELD AND RETURN           @YD00113*/ 01570000
*       /* TO THE IODSTRT ROUTINE FOR IODEVICE               @OZ09548*/ 01571000
*       /* *******************************************       @YD00113*/ 01572000
*       /*                                                           */ 01573000
*       /*************************************************************/ 01574000
*                                                                  0310 01575000
*       INBUF(N-1)=TABLE(CH(1)+1);  /*                       @Y30LB14*/ 01576000
@RF00282 LR    @15,R4                                              0310 01577000
         ALR   @15,N                                               0310 01578000
         L     @01,CH                                              0310 01579000
         LA    @09,TABLE(@01)                                      0310 01580000
         MVC   INBUF-2(1,@15),0(@09)                               0310 01581000
*       WRKCH(1)=CH(1);             /*                       @OZ09548*/ 01582000
         ST    @01,WRKCH                                           0311 01583000
*       RETURN;                     /*                       @OZ09548*/ 01584000
         B     @EL00005                                            0312 01585000
*     END;                          /*                       @Y30LB14*/ 01586000
*                                                                  0313 01587000
*   /*****************************************************************/ 01588000
*   /*                                                               */ 01589000
*   /* *******************************************           @OZ09548*/ 01590000
*   /* IF NO OPTIONAL CHANNELS WERE SPECIFIED THEN           @OZ09548*/ 01591000
*   /* RETURN TO IODSTRT AFTER SETTING VARIABLE              @OZ09548*/ 01592000
*   /* 'NOPTCHAN'.                                           @OZ09548*/ 01593000
*   /* *******************************************           @OZ09548*/ 01594000
*   /* ***********************************************       @OZ09548*/ 01595000
*   /*                                                               */ 01596000
*   /*****************************************************************/ 01597000
*                                                                  0314 01598000
*   ELSE                                                           0314 01599000
*     DO;                           /*                       @OZ09548*/ 01600000
@RF00274 DS    0H                                                  0315 01601000
*       NOPTCHAN='1'B;              /*                       @OZ09548*/ 01602000
         OI    NOPTCHAN,B'00100000'                                0315 01603000
*       RETURN;                     /*                       @OZ09548*/ 01604000
         B     @EL00005                                            0316 01605000
*     END;                          /*                       @OZ09548*/ 01606000
*   END OPTCHAN;                    /*                       @OZ09548*/ 01607000
*                                                                  0319 01608000
*/********************************************************** @OZ09548*/ 01609000
*/*                                                          @OZ09548*/ 01610000
*/* PROCEDURE NAME - COMCHAN                                 @OZ09548*/ 01611000
*/*                                                          @OZ09548*/ 01612000
*/* FUNCTION - THIS ROUTINE COMPARES ANY INFORMATION IN      @OZ09548*/ 01613000
*/*            THE INBUF OPTCHAN FIELDS AGAINST ALTERNATE    @OZ09548*/ 01614000
*/*            PATHS PRESENT IN THE CURRENT CARD. THE        @OZ09548*/ 01615000
*/*            BINARY FORM OF THE NUMBER FOUND IS PLACED     @OZ09548*/ 01616000
*/*            IN THE VARIABLE 'WRKCHAN' IN THE OPTCHAN      @OZ09548*/ 01617000
*/*            PROCEDURE PRIOR TO BEING SORTED FOR FIRST     @OZ09548*/ 01618000
*/*            BUILD. SUBSEQUENT COMPARISONS ARE MADE HERE.  @OZ09548*/ 01619000
*/*                                                          @OZ09548*/ 01620000
*/********************************************************** @OZ09548*/ 01621000
*                                                                  0319 01622000
*COMCHAN:                                                          0319 01623000
*   PROCEDURE;                      /*                       @OZ09548*/ 01624000
COMCHAN  STM   @14,@04,@SA00006                                    0319 01625000
         STM   @06,@12,@SA00006+28                                 0319 01626000
*   CH(1)=0;                        /*                       @OZ09548*/ 01627000
         SLR   @15,@15                                             0320 01628000
         ST    @15,CH                                              0320 01629000
*   CH(2)=0;                        /*                       @OZ09548*/ 01630000
         ST    @15,CH+4                                            0321 01631000
*   CH(3)=0;                        /*                       @OZ09548*/ 01632000
         ST    @15,CH+8                                            0322 01633000
*   IF ALTPATH1(I,J)^=0             /*                       @OZ09548*/ 01634000
*     THEN                          /*                       @OZ09548*/ 01635000
         LR    @15,I                                               0323 01636000
         SLA   @15,6                                               0323 01637000
         ALR   @15,J                                               0323 01638000
         MH    @15,@CH00034                                        0323 01639000
         L     @01,COMPTR2(,R4)                                    0323 01640000
         ST    @15,@TF00001                                        0323 01641000
         ALR   @15,@01                                             0323 01642000
         AL    @15,@CF00839                                        0323 01643000
         MVC   @ZT00001+1(3),ALTPATH1-466(@15)                     0323 01644000
         L     @15,@ZT00001                                        0323 01645000
         LTR   @15,@15                                             0323 01646000
         BZ    @RF00323                                            0323 01647000
*     DO;                           /*                       @OZ09548*/ 01648000
*       CH(1)=ALTCH1(I,J);          /*                       @OZ09548*/ 01649000
         L     @15,@TF00001                                        0325 01650000
         AL    @15,@CF00840                                        0325 01651000
         SLR   @09,@09                                             0325 01652000
         IC    @09,ALTCH1-468(@15,@01)                             0325 01653000
         ST    @09,CH                                              0325 01654000
*       IF ALTPATH2(I,J)^=0         /*                       @OZ09548*/ 01655000
*         THEN                      /*                       @OZ09548*/ 01656000
         LR    @15,@01                                             0326 01657000
         AL    @15,@TF00001                                        0326 01658000
         AL    @15,@CF00841                                        0326 01659000
         MVC   @ZT00001+1(3),ALTPATH2-469(@15)                     0326 01660000
         L     @15,@ZT00001                                        0326 01661000
         LTR   @15,@15                                             0326 01662000
         BZ    @RF00326                                            0326 01663000
*         DO;                       /*                       @OZ09548*/ 01664000
*           CH(2)=ALTCH2(I,J);      /*                       @OZ09548*/ 01665000
         L     @15,@TF00001                                        0328 01666000
         AL    @15,@CF00842                                        0328 01667000
         SLR   @09,@09                                             0328 01668000
         IC    @09,ALTCH2-471(@15,@01)                             0328 01669000
         ST    @09,CH+4                                            0328 01670000
*           IF ALTPATH3(I,J)^=0     /*                       @OZ09548*/ 01671000
*             THEN                  /*                       @OZ09548*/ 01672000
         LR    @15,@01                                             0329 01673000
         AL    @15,@TF00001                                        0329 01674000
         AL    @15,@CF00843                                        0329 01675000
         MVC   @ZT00001+1(3),ALTPATH3-472(@15)                     0329 01676000
         L     @15,@ZT00001                                        0329 01677000
         LTR   @15,@15                                             0329 01678000
         BZ    @RF00329                                            0329 01679000
*             DO;                   /*                       @OZ09548*/ 01680000
*               CH(3)=ALTCH3(I,J);  /*                       @OZ09548*/ 01681000
         L     @15,@TF00001                                        0331 01682000
         AL    @01,@CF00844                                        0331 01683000
         SLR   @09,@09                                             0331 01684000
         IC    @09,ALTCH3-474(@15,@01)                             0331 01685000
         ST    @09,CH+8                                            0331 01686000
*               CALL SORT3;         /*                       @OZ09548*/ 01687000
         BAL   @14,SORT3                                           0332 01688000
*             END;                  /*                       @OZ09548*/ 01689000
*           CALL SORT2;             /*                       @OZ09548*/ 01690000
@RF00329 BAL   @14,SORT2                                           0334 01691000
*         END;                      /*                       @OZ09548*/ 01692000
*     END;                          /*                       @OZ09548*/ 01693000
@RF00326 DS    0H                                                  0337 01694000
*   IF CH(1)^=WRKCH(1)              /*                       @OZ09548*/ 01695000
*       |CH(2)^=WRKCH(2)            /*                       @OZ09548*/ 01696000
*       |CH(3)^=WRKCH(3)            /*                       @OZ09548*/ 01697000
*     THEN                          /*                       @OZ09548*/ 01698000
@RF00323 CLC   CH(4),WRKCH                                         0337 01699000
         BNE   @RT00337                                            0337 01700000
         CLC   CH+4(4),WRKCH+4                                     0337 01701000
         BNE   @RT00337                                            0337 01702000
         CLC   CH+8(4),WRKCH+8                                     0337 01703000
         BE    @RF00337                                            0337 01704000
@RT00337 DS    0H                                                  0338 01705000
*     DO;                           /*                       @OZ09548*/ 01706000
*       CALL PUTOUTCD;              /*                       @OZ09548*/ 01707000
         BAL   @14,PUTOUTCD                                        0339 01708000
*       CALL IODSTRT;               /* SETUP NEW CARD        @OZ09548*/ 01709000
         BAL   @14,IODSTRT                                         0340 01710000
*     END;                          /*                       @OZ09548*/ 01711000
*   ELSE                            /*                       @OZ09548*/ 01712000
*     DO;                           /*                       @OZ09548*/ 01713000
         B     @RC00337                                            0342 01714000
@RF00337 DS    0H                                                  0343 01715000
*       CNT=CNT+1;                  /*                       @OZ09548*/ 01716000
         LA    @15,1                                               0343 01717000
         AL    @15,CNT                                             0343 01718000
         ST    @15,CNT                                             0343 01719000
*       OLDJ=J;                     /*                       @OZ09548*/ 01720000
         ST    J,OLDJ                                              0344 01721000
*     END;                          /*                       @OZ09548*/ 01722000
*   END COMCHAN;                    /*                       @OZ09548*/ 01723000
@EL00006 DS    0H                                                  0346 01724000
@EF00006 DS    0H                                                  0346 01725000
@ER00006 LM    @14,@04,@SA00006                                    0346 01726000
         LM    @06,@12,@SA00006+28                                 0346 01727000
         BR    @14                                                 0346 01728000
*                                                                  0347 01729000
*/********************************************************** @YD00113*/ 01730000
*/*                                                          @YD00113*/ 01731000
*/* PROCEDURE NAME - SORT3                                   @YD00113*/ 01732000
*/*                                                          @YD00113*/ 01733000
*/* FUNCTION - SORT THREE CHANNEL NUMBERIS INTO ASCENDING    @YD00113*/ 01734000
*/*            SEQUENCE BY CALLING THE SORT2 ROUTINE 4 TIMES @YD00113*/ 01735000
*/*                                                          @YD00113*/ 01736000
*/********************************************************** @YD00113*/ 01737000
*                                                                  0347 01738000
*SORT3:                                                            0347 01739000
*   PROCEDURE;                      /*                       @Y30LB14*/ 01740000
SORT3    STM   @14,@12,@SA00007                                    0347 01741000
*   DO L=1 TO 2;                    /*                       @Y30LB14*/ 01742000
         LA    L,1                                                 0348 01743000
@DL00348 DS    0H                                                  0349 01744000
*     DO K=1 TO 2;                  /*                       @Y30LB14*/ 01745000
         LA    @15,1                                               0349 01746000
         ST    @15,K                                               0349 01747000
@DL00349 DS    0H                                                  0350 01748000
*       CALL SORT2;                 /* SORT TWO NUMBERS      @Y30LB14*/ 01749000
         BAL   @14,SORT2                                           0350 01750000
*     END;                          /* END DO K LOOP         @Y30LB14*/ 01751000
         LA    @15,1                                               0351 01752000
         AL    @15,K                                               0351 01753000
         ST    @15,K                                               0351 01754000
         CH    @15,@CH00053                                        0351 01755000
         BNH   @DL00349                                            0351 01756000
*   END;                            /* END DO L LOOP         @Y30LB14*/ 01757000
         AL    L,@CF00045                                          0352 01758000
         CH    L,@CH00053                                          0352 01759000
         BNH   @DL00348                                            0352 01760000
*   RETURN;                         /*                       @Y30LB14*/ 01761000
@EL00007 DS    0H                                                  0353 01762000
@EF00007 DS    0H                                                  0353 01763000
@ER00007 LM    @14,@12,@SA00007                                    0353 01764000
         BR    @14                                                 0353 01765000
*   END SORT3;                      /*                       @Y30LB14*/ 01766000
*                                                                  0355 01767000
*/********************************************************** @YD00113*/ 01768000
*/*                                                          @YD00113*/ 01769000
*/* PROCEDURE NAME - SORT2                                   @YD00113*/ 01770000
*/*                                                          @YD00113*/ 01771000
*/* FUNCTION - SORT TWO NUMBERS INTO ASCENDING SEQUENCE BY   @YD00113*/ 01772000
*/*            USING THE TECHNIQUE OF EXCHANGE.              @YD00113*/ 01773000
*/*                                                          @YD00113*/ 01774000
*/********************************************************** @YD00113*/ 01775000
*                                                                  0355 01776000
*SORT2:                                                            0355 01777000
*   PROCEDURE;                      /*                       @Y30LB14*/ 01778000
SORT2    STM   @14,@12,12(@13)                                     0355 01779000
*   IF CH(K)>CH(K+1) THEN                                          0356 01780000
         L     @15,K                                               0356 01781000
         SLA   @15,2                                               0356 01782000
         L     @05,CH-4(@15)                                       0356 01783000
         L     @01,CH(@15)                                         0356 01784000
         CR    @05,@01                                             0356 01785000
         BNH   @RF00356                                            0356 01786000
*     DO;                           /*                       @Y30LB14*/ 01787000
*       SAV=CH(K+1);                /*                       @Y30LB14*/ 01788000
         LR    SAV,@01                                             0358 01789000
*       CH(K+1)=CH(K);              /*                       @Y30LB14*/ 01790000
         ST    @05,CH(@15)                                         0359 01791000
*       CH(K)=SAV;                  /*                       @Y30LB14*/ 01792000
         ST    SAV,CH-4(@15)                                       0360 01793000
*     END;                          /*                       @Y30LB14*/ 01794000
*   RETURN;                         /*                       @Y30LB14*/ 01795000
@EL00008 DS    0H                                                  0362 01796000
@EF00008 DS    0H                                                  0362 01797000
@ER00008 LM    @14,@12,12(@13)                                     0362 01798000
         BR    @14                                                 0362 01799000
*   END SORT2;                      /*                       @Y30LB14*/ 01800000
         B     @EL00008                                            0363 01801000
*                                                                  0364 01802000
*/********************************************************** @YD00113*/ 01803000
*/*                                                          @YD00113*/ 01804000
*/* PROCEDURE NAME - ENDGRP                                  @YD00113*/ 01805000
*/*                                                          @YD00113*/ 01806000
*/* FUNCTION - THIS ROUTINE CONVERTS THE COUNT OF THE NUMBER @YD00113*/ 01807000
*/*            OF ENTRIES IN ONE GROUP TO CHARACTER FORM AND @YD00113*/ 01808000
*/*            INSERTS IT IN THE CARD IMAGE.  THE POINTER    @YD00113*/ 01809000
*/*            'N' POINTS TO THE SECOND ')' WHICH IS WRITTEN @YD00113*/ 01810000
*/*            OVER IF THE CARD CAN BE CONTINUED.  IF NOT,   @YD00113*/ 01811000
*/*            THE END OF THE CARD IS CORRECT.               @YD00113*/ 01812000
*/*                                                          @YD00113*/ 01813000
*/********************************************************** @YD00113*/ 01814000
*                                                                  0364 01815000
*ENDGRP:                                                           0364 01816000
*   PROCEDURE;                      /*                       @Y30LB14*/ 01817000
ENDGRP   STM   @14,@04,12(@13)                                     0364 01818000
         STM   @06,@12,44(@13)                                     0364 01819000
*   OLDI=I;                         /* REFLECT ANY CHANGE IN CHAN. OR   01820000
*                                      CUA                   @OZ05131*/ 01821000
*                                                                  0365 01822000
         STH   I,OLDI                                              0365 01823000
*   /*****************************************************************/ 01824000
*   /*                                                               */ 01825000
*   /* ***********************************************       @YD00113*/ 01826000
*   /* IN THE UNIT FIELD OF THE UNITNAME CONTROL             @YD00113*/ 01827000
*   /* STATEMENT, FROM 1 TO 64 DEVICES CAN BE                @YD00113*/ 01828000
*   /* INDICATED BY A SUB-GROUP. THE NUMBER IN THE           @YD00113*/ 01829000
*   /* SUB-GROUP IS ALWAYS EXPLICITLY EXPRESSED, EVEN        @YD00113*/ 01830000
*   /* IF THE NUMBER IS ONE.                                 @YD00113*/ 01831000
*   /* ***********************************************       @YD00113*/ 01832000
*   /*                                                               */ 01833000
*   /*****************************************************************/ 01834000
*                                                                  0366 01835000
*   INBUF(N)=',';                   /*                       @Y30LB14*/ 01836000
         LR    @15,R4                                              0366 01837000
         ALR   @15,N                                               0366 01838000
         MVI   INBUF-1(@15),C','                                   0366 01839000
*   N=N+1;                          /*                       @Y30LB14*/ 01840000
*                                                                  0367 01841000
         LA    @15,1                                               0367 01842000
         ALR   N,@15                                               0367 01843000
*   /*****************************************************************/ 01844000
*   /*                                                               */ 01845000
*   /* ***********************************************       @YM31086*/ 01846000
*   /* IF THE COUNT OF SEQUENTIAL ADDRESSES IS EQUAL         @YM31086*/ 01847000
*   /* TO OR GREATER THAT 10, COMPUTE THE CHARACTER          @YM31086*/ 01848000
*   /* REPRESENTATION OF THE HIGH-ORDER DIGIT AND            @YM31086*/ 01849000
*   /* PUT THAT CHARACTER IN THE RECORD. BUMP THE            @YM31086*/ 01850000
*   /* NEXT COLUMN POINTER BY ONE.                           @YM31086*/ 01851000
*   /* ***********************************************       @YM31086*/ 01852000
*   /*                                                               */ 01853000
*   /*****************************************************************/ 01854000
*                                                                  0368 01855000
*   IF CNT>=10                      /*                       @YM31086*/ 01856000
*     THEN                                                         0368 01857000
         L     @03,CNT                                             0368 01858000
         LA    @01,10                                              0368 01859000
         CR    @03,@01                                             0368 01860000
         BL    @RF00368                                            0368 01861000
*     DO;                           /*                       @Y30LB14*/ 01862000
*       INBUF(N)=TABLE(CNT/10+1);   /*                       @Y30LB14*/ 01863000
         LR    @09,R4                                              0370 01864000
         ALR   @09,N                                               0370 01865000
         LR    @06,@03                                             0370 01866000
         SRDA  @06,32                                              0370 01867000
         DR    @06,@01                                             0370 01868000
         LA    @03,TABLE(@07)                                      0370 01869000
         MVC   INBUF-1(1,@09),0(@03)                               0370 01870000
*       N=N+1;                      /*                       @Y30LB14*/ 01871000
         ALR   N,@15                                               0371 01872000
*     END;                          /*                       @Y30LB14*/ 01873000
*                                                                  0372 01874000
*   /*****************************************************************/ 01875000
*   /*                                                               */ 01876000
*   /* ***********************************************       @YD00113*/ 01877000
*   /* COMPUTE THE LOW-ORDER OR ONLY DIGIT OF THE            @YD00113*/ 01878000
*   /* NUMBER OF RECORDS IN THE GROUP.                       @YD00113*/ 01879000
*   /* ***********************************************       @YD00113*/ 01880000
*   /*                                                               */ 01881000
*   /*****************************************************************/ 01882000
*                                                                  0373 01883000
*   INBUF(N)=TABLE(CNT//10+1);      /*                       @Y30LB14*/ 01884000
@RF00368 LR    @15,R4                                              0373 01885000
         ALR   @15,N                                               0373 01886000
         L     @06,CNT                                             0373 01887000
         SRDA  @06,32                                              0373 01888000
         D     @06,@CF00033                                        0373 01889000
         LA    @03,TABLE(@06)                                      0373 01890000
         MVC   INBUF-1(1,@15),0(@03)                               0373 01891000
*   N=N+1;                          /*                       @Y30LB14*/ 01892000
*                                                                  0374 01893000
         LA    @15,1                                               0374 01894000
         ALR   N,@15                                               0374 01895000
*   /*****************************************************************/ 01896000
*   /*                                                               */ 01897000
*   /* ***********************************************       @YD00113*/ 01898000
*   /* COMPLETE THE SUBGROUP WITH TWO RIGHT                  @YD00113*/ 01899000
*   /* PARENTHESES. IF ANOTHER SUBGROUP CAN BE               @YD00113*/ 01900000
*   /* IN THE SAME RECORD, THE LAST PARENTHESIS WILL         @YD00113*/ 01901000
*   /* BE OVERWRITTEN BY A COMMA.                            @YD00113*/ 01902000
*   /* ***********************************************       @YD00113*/ 01903000
*   /*                                                               */ 01904000
*   /*****************************************************************/ 01905000
*                                                                  0375 01906000
*   INBUF(N:N+1)='))';              /*                       @Y30LB14*/ 01907000
         LR    @03,R4                                              0375 01908000
         ALR   @03,N                                               0375 01909000
         MVC   INBUF-1(2,@03),@CC00748                             0375 01910000
*   N=N+1;                          /* N NOW POINTS TO LAST )      0376 01911000
*                                                            @Y30LB14*/ 01912000
         ALR   N,@15                                               0376 01913000
*   RETURN;                         /*                       @Y30LB14*/ 01914000
@EL00009 DS    0H                                                  0377 01915000
@EF00009 DS    0H                                                  0377 01916000
@ER00009 LM    @14,@04,12(@13)                                     0377 01917000
         LM    @06,@12,44(@13)                                     0377 01918000
         BR    @14                                                 0377 01919000
*   END ENDGRP;                     /*                       @Y30LB14*/ 01920000
*                                                                  0379 01921000
*/********************************************************** @YD00113*/ 01922000
*/*                                                          @YD00113*/ 01923000
*/* PROCEDURE NAME - STARTCRD                                @YD00113*/ 01924000
*/*                                                          @YD00113*/ 01925000
*/* FUNCTION - THIS ROUTINE IS ENTERED EACH TIME A UNITNAME  @YD00113*/ 01926000
*/*            CARD IMAGE IS STARTED.  THE CUD AND SDG       @YD00113*/ 01927000
*/*            NUMBER ARE INSERTED IN THEIR APPROPRIATE      @YD00113*/ 01928000
*/*            PLACES IN THE CARD IMAGE                      @YD00113*/ 01929000
*/*                                                          @YD00113*/ 01930000
*/********************************************************** @YD00113*/ 01931000
*                                                                  0379 01932000
*STARTCRD:                                                         0379 01933000
*   PROCEDURE;                      /*                       @Y30LB14*/ 01934000
STARTCRD STM   @14,@04,12(@13)                                     0379 01935000
         STM   @06,@12,44(@13)                                     0379 01936000
*   INBUF='';                       /* CLEAR INBUF PRIOR TO BUILD  0380 01937000
*                                                            @OZ09534*/ 01938000
         MVI   INBUF(R4),C' '                                      0380 01939000
         MVC   INBUF+1(79,R4),INBUF(R4)                            0380 01940000
*   IF RESET='1'B THEN              /* RESET SEQUENCE NUMBER @OZ09534*/ 01941000
         TM    RESET,B'01000000'                                   0381 01942000
         BNO   @RF00381                                            0381 01943000
*     DO;                           /*                       @OZ09534*/ 01944000
*       SEQNUM=0;                   /*                       @OZ09534*/ 01945000
         SLR   @15,@15                                             0383 01946000
         STH   @15,SEQNUM                                          0383 01947000
*       RESET='0'B;                 /*                       @OZ09534*/ 01948000
*                                                                  0384 01949000
         NI    RESET,B'10111111'                                   0384 01950000
*       /*************************************************************/ 01951000
*       /*                                                           */ 01952000
*       /* SEQUENCE NUMBERS STARTING AT 1                    @OZ09534*/ 01953000
*       /*                                                           */ 01954000
*       /*************************************************************/ 01955000
*                                                                  0385 01956000
*     END;                          /*                       @OZ09534*/ 01957000
*                                                                  0385 01958000
*   /*****************************************************************/ 01959000
*   /*                                                               */ 01960000
*   /* ***********************************************       @YD00113*/ 01961000
*   /* PLACE CONSTANT INFORMATION IN CARD IMAGE              @YD00113*/ 01962000
*   /* BUFFER AND SET 'SW' OR 'SW1' TO INDICATE NOT          @G18MB73*/ 01963000
*   /* FIRST TIME.                                           @G18MB73*/ 01964000
*   /* ***********************************************       @G18MB73*/ 01965000
*   /*                                                               */ 01966000
*   /*****************************************************************/ 01967000
*                                                                  0386 01968000
*   IF LOCALJES='1'B&UCOMP='1'B     /* TEST LOCALJES SW ON   @G18MB73*/ 01969000
*     THEN                          /*                       @G18MB73*/ 01970000
@RF00381 TM    LOCALJES,B'01100000'                                0386 01971000
         BNO   @RF00386                                            0386 01972000
*     DO;                           /*                       @G18MB73*/ 01973000
*       INBUF(1:26)='J        UNITNAME NAME=SDG';/*          @G18MB73*/ 01974000
         MVC   INBUF(26,R4),@CC00754                               0388 01975000
*       SW1='0'B;                   /*                       @G18MB73*/ 01976000
         NI    SW1,B'11101111'                                     0389 01977000
*     END;                          /*                       @G18MB73*/ 01978000
*   ELSE                            /*                       @G18MB73*/ 01979000
*     DO;                           /*                       @G18MB73*/ 01980000
         B     @RC00386                                            0391 01981000
@RF00386 DS    0H                                                  0392 01982000
*       INBUF(1:26)='U        UNITNAME NAME=SDG';/*          @G18MB73*/ 01983000
         MVC   INBUF(26,R4),@CC00757                               0392 01984000
*       SW=0;                       /*                       @G18MB73*/ 01985000
         MVI   SW,X'00'                                            0393 01986000
*     END;                          /*                       @G18MB73*/ 01987000
*                                                                  0394 01988000
*   /*****************************************************************/ 01989000
*   /*                                                               */ 01990000
*   /* ***********************************************       @YD00113*/ 01991000
*   /* MOVE CHARACTER REPRESENTATION OF SDG TO BOTH          @YD00113*/ 01992000
*   /* LABEL FIELD AND THE NAME FIELD AND THE MACHINE        @YD00113*/ 01993000
*   /* SERIAL NUMBER TO THE LABEL FIELD.                     @YD00113*/ 01994000
*   /* ***********************************************       @YD00113*/ 01995000
*   /*                                                               */ 01996000
*   /*****************************************************************/ 01997000
*                                                                  0395 01998000
*   INBUF(7:8)=CURRSG;              /*                       @Y30LB14*/ 01999000
@RC00386 MVC   INBUF+6(2,R4),CURRSG                                0395 02000000
*   INBUF(2:6)=UNPACKED(2:6);       /*                       @Y30LB14*/ 02001000
         MVC   INBUF+1(5,R4),UNPACKED+1                            0396 02002000
*   INBUF(27:28)=INBUF(7:8);        /*                       @Y30LB14*/ 02003000
*                                                                  0397 02004000
         MVC   INBUF+26(2,R4),INBUF+6(R4)                          0397 02005000
*   /*****************************************************************/ 02006000
*   /*                                                               */ 02007000
*   /* ***********************************************       @YD00113*/ 02008000
*   /* MOVE UNIT FIELD CONSTANT INFORMATION TO CARD          @YD00113*/ 02009000
*   /* IMAGE BUFFER                                          @YD00113*/ 02010000
*   /* ***********************************************       @YD00113*/ 02011000
*   /*                                                               */ 02012000
*   /*****************************************************************/ 02013000
*                                                                  0398 02014000
*   N=29;                           /*                       @Y30LB14*/ 02015000
         LA    N,29                                                0398 02016000
*   INBUF(N:N+7)=',UNIT=((';        /*                       @Y30LB14*/ 02017000
         LR    @15,R4                                              0399 02018000
         ALR   @15,N                                               0399 02019000
         MVC   INBUF-1(8,@15),@CC00763                             0399 02020000
*   N=N+8;                          /*                       @Y30LB14*/ 02021000
*                                                                  0400 02022000
         AL    N,@CF00043                                          0400 02023000
*   /*****************************************************************/ 02024000
*   /*                                                               */ 02025000
*   /* ***********************************************       @YD00113*/ 02026000
*   /* MOVE UCB ADDRESS TO CARD IMAGE BUFFER                 @YD00113*/ 02027000
*   /* ***********************************************       @YD00113*/ 02028000
*   /*                                                               */ 02029000
*   /*****************************************************************/ 02030000
*                                                                  0401 02031000
*   INBUF(N:N+2)=CUD;               /*                       @Y30LB14*/ 02032000
         LR    @15,R4                                              0401 02033000
         ALR   @15,N                                               0401 02034000
         MVC   INBUF-1(3,@15),CUD                                  0401 02035000
*   N=N+3;                          /*                       @Y30LB14*/ 02036000
*                                                                  0402 02037000
         AL    N,@CF00051                                          0402 02038000
*   /*****************************************************************/ 02039000
*   /*                                                               */ 02040000
*   /* ***********************************************       @YD00113*/ 02041000
*   /* SAVE INDEX INDICATING SEQUENTIAL ADDRESS AND          @YD00113*/ 02042000
*   /* SET SEQUENTIAL ADDRESS COUNT TO 1                     @YD00113*/ 02043000
*   /* ***********************************************       @YD00113*/ 02044000
*   /*                                                               */ 02045000
*   /*****************************************************************/ 02046000
*                                                                  0403 02047000
*   OLDJ=J;                         /* CONSECUTIVE DEVICE ADDRESSING    02048000
*                                                            @Y30LB14*/ 02049000
         ST    J,OLDJ                                              0403 02050000
*   OLDI=I;                         /* SET FOR CHAN / CUA CHK      0404 02051000
*                                                            @OZ05131*/ 02052000
         STH   I,OLDI                                              0404 02053000
*   CNT=1;                          /*                       @Y30LB14*/ 02054000
         MVC   CNT(4),@CF00045                                     0405 02055000
*   RETURN;                         /*                       @Y30LB14*/ 02056000
@EL00010 DS    0H                                                  0406 02057000
@EF00010 DS    0H                                                  0406 02058000
@ER00010 LM    @14,@04,12(@13)                                     0406 02059000
         LM    @06,@12,44(@13)                                     0406 02060000
         BR    @14                                                 0406 02061000
*   END STARTCRD;                   /*                       @Y30LB14*/ 02062000
*/********************************************************** @G18MB73*/ 02063000
*/*                                                          @G18MB73*/ 02064000
*/* PROCEDURE NAME - BUILDIT                                 @G18MB73*/ 02065000
*/*                                                          @G18MB73*/ 02066000
*/* FUNCTION - THIS ROUTINE IS ENTERED EACH TIME A UNITNAME  @G18MB73*/ 02067000
*/*            OR J-NAME CARD IMAGE IS STARTED. THE CUD AND  @G18MB73*/ 02068000
*/*            SDG NUMBER ARE INSERTED IN THEIR APPROPRIATE  @G18MB73*/ 02069000
*/*            PLACES IN THE CARD IMAGE.                     @G18MB73*/ 02070000
*/*                                                          @G18MB73*/ 02071000
*/********************************************************** @G18MB73*/ 02072000
*                                                                  0408 02073000
*BUILDIT:                                                          0408 02074000
*   PROCEDURE;                      /*                       @G18MB73*/ 02075000
*                                                                  0408 02076000
BUILDIT  STM   @14,@04,@SA00011                                    0408 02077000
         STM   @06,@12,@SA00011+28                                 0408 02078000
*   /*****************************************************************/ 02079000
*   /*                                                               */ 02080000
*   /* ***********************************************       @G18MB73*/ 02081000
*   /* PLACE CONSTANT INFORMATION IN CARD IMAGE              @G18MB73*/ 02082000
*   /* ***********************************************       @G18MB73*/ 02083000
*   /* ***************************************               @G18MB73*/ 02084000
*   /* UNPACK CPUID SO THAT CHARACTERS 2-6                   @G18MB73*/ 02085000
*   /* WILL BE AVAILABLE TO PLACE IN THE                     @G18MB73*/ 02086000
*   /* LABEL FIELD OF THE UNITNAME STATEMENT                 @G18MB73*/ 02087000
*   /* ***************************************               @G18MB73*/ 02088000
*   /*                                                               */ 02089000
*   /*****************************************************************/ 02090000
*                                                                  0409 02091000
*   CALL CPUIDP;                    /* UNPACK CPU ID         @G18MB73*/ 02092000
*                                                                  0409 02093000
         BAL   @14,CPUIDP                                          0409 02094000
*   /*****************************************************************/ 02095000
*   /*                                                               */ 02096000
*   /* ***************************************               @G18MB73*/ 02097000
*   /* DEVELOP THE CHANNEL/CONTROL UNIT/                     @G18MB73*/ 02098000
*   /* DEVICE ADDRESS OF THE FIRST ENTRY IN                  @G18MB73*/ 02099000
*   /* THIS GROUP.                                           @G18MB73*/ 02100000
*   /* ***************************************               @G18MB73*/ 02101000
*   /*                                                               */ 02102000
*   /*****************************************************************/ 02103000
*                                                                  0410 02104000
*   CALL CUDADDR;                   /* CHANNEL, UNIT DEVICE  @G18MB73*/ 02105000
*                                                                  0410 02106000
         BAL   @14,CUDADDR                                         0410 02107000
*   /*****************************************************************/ 02108000
*   /*                                                               */ 02109000
*   /* ***************************************               @G18MB73*/ 02110000
*   /* DEVELOP THE SDG NUMBER FOR THIS                       @G18MB73*/ 02111000
*   /* ENTRY AS TWO PRINTABLE CHARACTERS                     @G18MB73*/ 02112000
*   /* ***************************************               @G18MB73*/ 02113000
*   /*                                                               */ 02114000
*   /*****************************************************************/ 02115000
*                                                                  0411 02116000
*   CALL CURNTRSG;                  /* CURRENT RSG           @G18MB73*/ 02117000
*                                                                  0411 02118000
         BAL   @14,CURNTRSG                                        0411 02119000
*   /*****************************************************************/ 02120000
*   /*                                                               */ 02121000
*   /* ***************************************               @G18MB73*/ 02122000
*   /* 'SW&SW1' ARE FIRST TIME SWITCHES AND                  @G18MB73*/ 02123000
*   /* FORCE THE FIRST BUILD OF THE BASE                     @G18MB73*/ 02124000
*   /* UNITNAME RECORD TYPE IN THE BUFFER.                   @G18MB73*/ 02125000
*   /* BASE RECORD WILL BE REBUILT AFTER                     @G18MB73*/ 02126000
*   /* EACH RECORD IS PUNCHED AND PRINTED.                   @G18MB73*/ 02127000
*   /* ***************************************               @G18MB73*/ 02128000
*   /*                                                               */ 02129000
*   /*****************************************************************/ 02130000
*                                                                  0412 02131000
*   IF SW1='1'B|SW=1                /*                       @G18MB73*/ 02132000
*     THEN                          /*                       @G18MB73*/ 02133000
         TM    SW1,B'00010000'                                     0412 02134000
         BO    @RT00412                                            0412 02135000
         CLI   SW,1                                                0412 02136000
         BNE   @RF00412                                            0412 02137000
@RT00412 DS    0H                                                  0413 02138000
*     CALL STARTCRD;                /* START A CARD          @G18MB73*/ 02139000
         BAL   @14,STARTCRD                                        0413 02140000
*   ELSE                            /*                       @G18MB73*/ 02141000
*                                                                  0414 02142000
*     /***************************************************************/ 02143000
*     /*                                                             */ 02144000
*     /* **************************************              @G18MB73*/ 02145000
*     /* IF THIS IS NOT THE VERY FIRST TIME                  @G18MB73*/ 02146000
*     /* THROUGH THIS CODE (SW1=0), COMPARE                  @G18MB73*/ 02147000
*     /* CHARACTERS 2-6 OF THE CURRENT CPU                   @G18MB73*/ 02148000
*     /* AGAINST CHACATERS 2-6 OF THE RECORD                 @G18MB73*/ 02149000
*     /* CURRENTLY BEING BUILT, AND COMPARE                  @G18MB73*/ 02150000
*     /* THE SDG OF THE CURRENT ENTRY AGAINST                @G18MB73*/ 02151000
*     /* CHARACTERS 7-8 (SDG) OF THE RECORD                  @G18MB73*/ 02152000
*     /* CURRENTLY BEING BUILT. IF THERE IS                  @G18MB73*/ 02153000
*     /* A NON-MATCH ON EITHER OF THESE ITEMS,               @G18MB73*/ 02154000
*     /* PERFORM THE STEPS TO END THIS RECORD,               @G18MB73*/ 02155000
*     /* PUNCH AND PRINT THE RECORD, AND BUILD               @G18MB73*/ 02156000
*     /* THE BASE INFORMATION FOR THE NEXT                   @G18MB73*/ 02157000
*     /* RECORD IN THE OUTPUT BUFFER.                        @G18MB73*/ 02158000
*     /* **************************************              @G18MB73*/ 02159000
*     /*                                                             */ 02160000
*     /***************************************************************/ 02161000
*                                                                  0414 02162000
*     DO;                           /*                       @G18MB73*/ 02163000
         B     @RC00412                                            0414 02164000
@RF00412 DS    0H                                                  0415 02165000
*       IF CURRSG^=INBUF(7:8)|      /*                       @G18MB73*/ 02166000
*           UNPACKED(2:6)^=INBUF(2:6)/*                      @G18MB73*/ 02167000
*         THEN                      /*                       @G18MB73*/ 02168000
         CLC   CURRSG(2),INBUF+6(R4)                               0415 02169000
         BNE   @RT00415                                            0415 02170000
         CLC   UNPACKED+1(5),INBUF+1(R4)                           0415 02171000
         BE    @RF00415                                            0415 02172000
@RT00415 DS    0H                                                  0416 02173000
*         DO;                       /*                       @G18MB73*/ 02174000
*           CALL ENDGRP;            /* END GROUP ON CD       @G18MB73*/ 02175000
         BAL   @14,ENDGRP                                          0417 02176000
*           CALL PUTOUTCD;          /* PUNCH A CARD          @G18MB73*/ 02177000
         BAL   @14,PUTOUTCD                                        0418 02178000
*           CALL STARTCRD;          /* START A CARD          @G18MB73*/ 02179000
         BAL   @14,STARTCRD                                        0419 02180000
*         END;                      /*                       @G18MB73*/ 02181000
*                                                                  0420 02182000
*       /*************************************************************/ 02183000
*       /*                                                           */ 02184000
*       /* **********************************                @G18MB73*/ 02185000
*       /* PERFORM THIS LOGIC IF THE SAME                    @G18MB73*/ 02186000
*       /* CPU AND SDG IN CURRENT ENTRY AS                   @G18MB73*/ 02187000
*       /* IN RECORD BEING BUILT.                            @G18MB73*/ 02188000
*       /* **********************************                @G18MB73*/ 02189000
*       /*                                                           */ 02190000
*       /*************************************************************/ 02191000
*                                                                  0421 02192000
*       ELSE                        /*                       @G18MB73*/ 02193000
*         DO;                       /*                       @G18MB73*/ 02194000
*                                                                  0421 02195000
         B     @RC00415                                            0421 02196000
@RF00415 DS    0H                                                  0422 02197000
*           /*********************************************************/ 02198000
*           /*                                                       */ 02199000
*           /* *******************************               @G18MB73*/ 02200000
*           /* IF THERE WAS A SKIP (UNUSED                   @G18MB73*/ 02201000
*           /* ADDRESS OR ADDRESS USED FOR                   @G18MB73*/ 02202000
*           /* SOMETHING OTHER THAN VIRTUAL                  @G18MB73*/ 02203000
*           /* OR VIRTUAL SHARED), START A                   @G18MB73*/ 02204000
*           /* NEW ADDRESSING GROUP ON THE                   @G18MB73*/ 02205000
*           /* SAME RECORD.                                  @G18MB73*/ 02206000
*           /* *******************************               @G18MB73*/ 02207000
*           /*                                                       */ 02208000
*           /*********************************************************/ 02209000
*                                                                  0422 02210000
*           IF OLDJ+1^=J|OLDI^=I    /*                       @G18MB73*/ 02211000
*             THEN                  /*                       @G18MB73*/ 02212000
         LA    @15,1                                               0422 02213000
         AL    @15,OLDJ                                            0422 02214000
         CR    @15,J                                               0422 02215000
         BNE   @RT00422                                            0422 02216000
         CH    I,OLDI                                              0422 02217000
         BE    @RF00422                                            0422 02218000
@RT00422 DS    0H                                                  0423 02219000
*             DO;                   /*                       @G18MB73*/ 02220000
*               CALL ENDGRP;        /* END GROUP             @G18MB73*/ 02221000
*                                                                  0424 02222000
         BAL   @14,ENDGRP                                          0424 02223000
*               /*****************************************************/ 02224000
*               /*                                                   */ 02225000
*               /* ***************************               @G18MB73*/ 02226000
*               /* IF THERE IS ENOUGH SPACE                  @G18MB73*/ 02227000
*               /* LEFT, SET UP CONSTANTS                    @G18MB73*/ 02228000
*               /* AND STARTING DEVICE ADDR                  @G18MB73*/ 02229000
*               /* FOR THE NEXT GROUP ON THE                 @G18MB73*/ 02230000
*               /* SAME STATEMENT.                           @G18MB73*/ 02231000
*               /* ***************************               @G18MB73*/ 02232000
*               /*                                                   */ 02233000
*               /*****************************************************/ 02234000
*                                                                  0425 02235000
*               IF N<=62            /*                       @G18MB73*/ 02236000
*                 THEN              /*                       @G18MB73*/ 02237000
         CH    N,@CH00768                                          0425 02238000
         BH    @RF00425                                            0425 02239000
*                 DO;               /*                       @G18MB73*/ 02240000
*                   INBUF(N:N+1)=',(';/*                     @G18MB73*/ 02241000
         LR    @15,R4                                              0427 02242000
         ALR   @15,N                                               0427 02243000
         MVC   INBUF-1(2,@15),@CC00769                             0427 02244000
*                   N=N+2;          /*                       @G18MB73*/ 02245000
         AH    N,@CH00053                                          0428 02246000
*                   INBUF(N:N+2)=CUD;/*                      @G18MB73*/ 02247000
         LR    @15,R4                                              0429 02248000
         ALR   @15,N                                               0429 02249000
         MVC   INBUF-1(3,@15),CUD                                  0429 02250000
*                   N=N+3;          /*                       @G18MB73*/ 02251000
         AL    N,@CF00051                                          0430 02252000
*                   CNT=1;          /*                       @G18MB73*/ 02253000
         MVC   CNT(4),@CF00045                                     0431 02254000
*                   OLDJ=J;         /*                       @G18MB73*/ 02255000
         ST    J,OLDJ                                              0432 02256000
*                 END;              /*                       @G18MB73*/ 02257000
*                                                                  0433 02258000
*               /*****************************************************/ 02259000
*               /*                                                   */ 02260000
*               /* *************************                 @G18MB73*/ 02261000
*               /* OTHERWISE PRINT AND                       @G18MB73*/ 02262000
*               /* THIS STATEMENT AND SET                    @G18MB73*/ 02263000
*               /* BASE INFORMATION FOR                      @G18MB73*/ 02264000
*               /* THE NEXT STATEMENT.                       @G18MB73*/ 02265000
*               /* *************************                 @G18MB73*/ 02266000
*               /*                                                   */ 02267000
*               /*****************************************************/ 02268000
*                                                                  0434 02269000
*               ELSE                /*                       @G18MB73*/ 02270000
*                 DO;               /*                       @G18MB73*/ 02271000
         B     @RC00425                                            0434 02272000
@RF00425 DS    0H                                                  0435 02273000
*                   CALL PUTOUTCD;  /*                       @G18MB73   02274000
*                                      PUNCH A CARD          @G18MB73*/ 02275000
         BAL   @14,PUTOUTCD                                        0435 02276000
*                   CALL STARTCRD;  /*                       @G18MB73   02277000
*                                      START A CARD          @G18MB73*/ 02278000
         BAL   @14,STARTCRD                                        0436 02279000
*                 END;              /*                       @G18MB73*/ 02280000
*             END;                  /*                       @G18MB73*/ 02281000
*                                                                  0438 02282000
*           /*********************************************************/ 02283000
*           /*                                                       */ 02284000
*           /* *****************************                 @G18MB73*/ 02285000
*           /* IF NO SKIP IN THE ADDRESS                     @G18MB73*/ 02286000
*           /* SEQUENCE, ADD ONE TO THE                      @G18MB73*/ 02287000
*           /* COUNT OF SEQUENTIAL ADDRS                     @G18MB73*/ 02288000
*           /* THAT MAKE UP THIS GROUP.                      @G18MB73*/ 02289000
*           /* *****************************                 @G18MB73*/ 02290000
*           /*                                                       */ 02291000
*           /*********************************************************/ 02292000
*                                                                  0439 02293000
*           ELSE                    /*                       @G18MB73*/ 02294000
*             DO;                   /*                       @G18MB73*/ 02295000
         B     @RC00422                                            0439 02296000
@RF00422 DS    0H                                                  0440 02297000
*               CNT=CNT+1;          /*                       @G18MB73*/ 02298000
         LA    @15,1                                               0440 02299000
         AL    @15,CNT                                             0440 02300000
         ST    @15,CNT                                             0440 02301000
*               OLDJ=J;             /*                       @G18MB73*/ 02302000
         ST    J,OLDJ                                              0441 02303000
*             END;                  /*                       @G18MB73*/ 02304000
*         END;                      /*                       @G18MB73*/ 02305000
*     END;                          /*                       @G18MB73*/ 02306000
*   RETURN;                         /* TO MAINLINE           @G18MB73*/ 02307000
@EL00011 DS    0H                                                  0445 02308000
@EF00011 DS    0H                                                  0445 02309000
@ER00011 LM    @14,@04,@SA00011                                    0445 02310000
         LM    @06,@12,@SA00011+28                                 0445 02311000
         BR    @14                                                 0445 02312000
*   END BUILDIT;                    /*                       @G18MB73*/ 02313000
         B     @EL00011                                            0446 02314000
*                                                                  0447 02315000
*/********************************************************** @YD00113*/ 02316000
*/*                                                          @YD00113*/ 02317000
*/* PROCEDURE NAME - CURNTRSG                                @YD00113*/ 02318000
*/*                                                          @YD00113*/ 02319000
*/* FUNCTION - THIS ROUTINE SETS UP THE SDG NUMBER IN        @YD00113*/ 02320000
*/*            CHARACTER FORM IN THE CURRSG STRUCTURE.       @YD00113*/ 02321000
*/*                                                          @YD00113*/ 02322000
*/********************************************************** @YD00113*/ 02323000
*                                                                  0447 02324000
*CURNTRSG:                                                         0447 02325000
*   PROCEDURE;                      /*                       @Y30LB14*/ 02326000
CURNTRSG STM   @14,@12,12(@13)                                     0447 02327000
*   UD=INDEXRSG(I,J)//10;           /*                       @Y30LB14*/ 02328000
         LA    @15,10                                              0448 02329000
         LR    @01,I                                               0448 02330000
         SLA   @01,6                                               0448 02331000
         ALR   @01,J                                               0448 02332000
         MH    @01,@CH00034                                        0448 02333000
         L     @09,COMPTR2(,R4)                                    0448 02334000
         AL    @09,@CF00837                                        0448 02335000
         SLR   @08,@08                                             0448 02336000
         IC    @08,INDEXRSG-465(@01,@09)                           0448 02337000
         LR    @06,@08                                             0448 02338000
         SRDA  @06,32                                              0448 02339000
         DR    @06,@15                                             0448 02340000
         LR    UD,@06                                              0448 02341000
*   LCURRSG=TABLE(UD+1);            /*                       @Y30LB14*/ 02342000
         LA    @01,TABLE(UD)                                       0449 02343000
         MVC   LCURRSG(1),0(@01)                                   0449 02344000
*   UD=(INDEXRSG(I,J)/10)//10;      /*                       @Y30LB14*/ 02345000
         LR    @07,@08                                             0450 02346000
         SLR   @06,@06                                             0450 02347000
         DR    @06,@15                                             0450 02348000
         LR    @08,@07                                             0450 02349000
         SRDA  @08,32                                              0450 02350000
         DR    @08,@15                                             0450 02351000
         LR    UD,@08                                              0450 02352000
*   HCURRSG=TABLE(UD+1);            /*                       @Y30LB14*/ 02353000
         LA    @15,TABLE(UD)                                       0451 02354000
         MVC   HCURRSG(1),0(@15)                                   0451 02355000
*   RETURN;                         /*                       @Y30LB14*/ 02356000
@EL00012 DS    0H                                                  0452 02357000
@EF00012 DS    0H                                                  0452 02358000
@ER00012 LM    @14,@12,12(@13)                                     0452 02359000
         BR    @14                                                 0452 02360000
*   END CURNTRSG;                   /*                       @Y30LB14*/ 02361000
*                                                                  0454 02362000
*/********************************************************** @YD00113*/ 02363000
*/*                                                          @YD00113*/ 02364000
*/* PROCEDURE NAME - SCANOPEN                                @YD00113*/ 02365000
*/*                                                          @YD00113*/ 02366000
*/* FUNCTION - THIS ROUTINE COPIES THE MODEL DCB FOR         @YD00113*/ 02367000
*/*            SYSPUNCH INTO THE AREA PREVIOUSLY USED FOR    @YD00113*/ 02368000
*/*            SYSIN DCB IN COMTAB, ESTABLISHES AND          @YD00113*/ 02369000
*/*            ACTIVATES THE DCB OPEN EXIT (USED TO CHECK    @YD00113*/ 02370000
*/*            BLOCKSIZE), CHECKS FOR A SUBSTITUTE SYSPUNCH  @YD00113*/ 02371000
*/*            DDNAME AND USES IT IF PRESENT, AND OPENS      @YD00113*/ 02372000
*/*            SYSPUNCH.  IF OPEN IS NOT SUCCESSFUL,         @YD00113*/ 02373000
*/*            MESSAGE ICG402I (WARNING ONLY) IS WRITTEN.    @YD00113*/ 02374000
*/*                                                          @YD00113*/ 02375000
*/********************************************************** @YD00113*/ 02376000
*                                                                  0454 02377000
*SCANOPEN:                                                         0454 02378000
*   PROCEDURE;                      /*                       @Y30LB14*/ 02379000
*                                                                  0454 02380000
SCANOPEN STM   @14,@12,@SA00013                                    0454 02381000
*   /*****************************************************************/ 02382000
*   /*                                                               */ 02383000
*   /* ***********************************************       @YD00113*/ 02384000
*   /* COPY MODEL DCB TO GETMAIN'ED STORAGE AND              @YD00113*/ 02385000
*   /* ESTABLISH ADDRESSABITILY OF FIELDS BY NAMES           @YD00113*/ 02386000
*   /* IN DCBD MAPPING MACRO.                                @YD00113*/ 02387000
*   /* ***********************************************       @YD00113*/ 02388000
*   /*                                                               */ 02389000
*   /*****************************************************************/ 02390000
*                                                                  0455 02391000
*   READDCB=MYDCB2A;                /* COPY SYSPUNCH DCB     @Y30LB14*/ 02392000
         LA    @15,MYDCB2                                          0455 02393000
         MVC   READDCB(96,R4),MYDCB2A(@15)                         0455 02394000
*   DCBPTR=ADDR(READDCB);           /* SET DCB OVERLAY       @Y30LB14*/ 02395000
*                                                                  0456 02396000
         LA    @15,READDCB(,R4)                                    0456 02397000
         ST    @15,DCBPTR(,R4)                                     0456 02398000
*   /*****************************************************************/ 02399000
*   /*                                                               */ 02400000
*   /* ***********************************************       @YD00113*/ 02401000
*   /* SET UP FOR DCB OPEN EXIT                              @YD00113*/ 02402000
*   /* ***********************************************       @YD00113*/ 02403000
*   /*                                                               */ 02404000
*   /*****************************************************************/ 02405000
*                                                                  0457 02406000
*   DCBEXLST=ADDR(EXLST);           /* PTR TO EXIT LIST      @Y30LB14*/ 02407000
         LA    @05,EXLST(,R4)                                      0457 02408000
         ST    @05,DCBEXLST+28(,@15)                               0457 02409000
*   EXLST=ADDR(DCBROUT2);           /* PTR TO EXIT ROUT      @Y30LB14*/ 02410000
         LA    @15,DCBROUT2                                        0458 02411000
         ST    @15,EXLST(,R4)                                      0458 02412000
*   EXLST(1)='85'X;                 /* ACTIVATE EXIT         @Y30LB14*/ 02413000
*                                                                  0459 02414000
         MVI   EXLST(R4),X'85'                                     0459 02415000
*   /*****************************************************************/ 02416000
*   /*                                                               */ 02417000
*   /* ***********************************************       @YD00113*/ 02418000
*   /* CHECK FOR SUBSTITUTE SYSPUNCH DDNAME PASSED           @YD00113*/ 02419000
*   /* INVOCATION FROM A PROBLE PROGRAM                      @YD00113*/ 02420000
*   /* ***********************************************       @YD00113*/ 02421000
*   /*                                                               */ 02422000
*   /*****************************************************************/ 02423000
*                                                                  0460 02424000
*   IF SVSYSPCH^='0000000000000000'X/* IF ALTERNATE          @Y30LB14*/ 02425000
*     THEN                          /*                       @YD00113*/ 02426000
         CLC   SVSYSPCH(8,R4),@CB00778                             0460 02427000
         BE    @RF00460                                            0460 02428000
*     READDCB(41:48)=SVSYSPCH;      /* USE ALTERNATE         @YD00113*/ 02429000
         MVC   READDCB+40(8,R4),SVSYSPCH(R4)                       0461 02430000
*   ELSE                                                           0462 02431000
*     ;                             /*                       @YD00113*/ 02432000
*                                                                  0462 02433000
@RF00460 DS    0H                                                  0463 02434000
*   /*****************************************************************/ 02435000
*   /*                                                               */ 02436000
*   /* ***********************************************       @YD00113*/ 02437000
*   /* SET UP FOR THE EXECUTE FORM OF OPEN                   @YD00113*/ 02438000
*   /* ***********************************************       @YD00113*/ 02439000
*   /*                                                               */ 02440000
*   /*****************************************************************/ 02441000
*                                                                  0463 02442000
*   OPENLIST=ADDR(READDCB);         /* ADDR OF SYSPCH DCB@Y30LB14    */ 02443000
         LA    @15,READDCB(,R4)                                    0463 02444000
         ST    @15,OPENLIST(,R4)                                   0463 02445000
*   OPENLIST(1)='8F'X;              /* SET END-OF-LIST       @Y30LB12*/ 02446000
         MVI   OPENLIST(R4),X'8F'                                  0464 02447000
*   R1=ADDR(OPENLIST);              /* ADDR OF DCB TO R1     @Y30LB14*/ 02448000
         LA    R1,OPENLIST(,R4)                                    0465 02449000
*   GEN(OPEN  MF=(E,(1)));          /* OPEN SYSPUNCH         @Y30LB14*/ 02450000
*                                                                  0466 02451000
         OPEN  MF=(E,(1))                                               02452000
*   /*****************************************************************/ 02453000
*   /*                                                               */ 02454000
*   /* ***********************************************       @Y30LB14*/ 02455000
*   /* CHK TO SEE IF OPEN OF SYSPUNCH WAS SUCCESSFUL         @Y30LB14*/ 02456000
*   /* ***********************************************       @Y30LB14*/ 02457000
*   /*                                                               */ 02458000
*   /*****************************************************************/ 02459000
*                                                                  0467 02460000
*   DCBPTR=ADDR(READDCB);           /* SET DCB OVERLAY       @Y30LB14*/ 02461000
         LA    @15,READDCB(,R4)                                    0467 02462000
         ST    @15,DCBPTR(,R4)                                     0467 02463000
*   IF DCBOFOPN^='1'B               /* SYSPUNCH NOT OPEN     @Y30LB14*/ 02464000
*     THEN                          /*                       @Y30LB14*/ 02465000
         TM    DCBOFOPN+40(@15),B'00010000'                        0468 02466000
         BO    @RF00468                                            0468 02467000
*     DO;                           /*                       @Y30LB14*/ 02468000
*                                                                  0469 02469000
*       /*************************************************************/ 02470000
*       /*                                                           */ 02471000
*       /* *****************************************         @YD00113*/ 02472000
*       /* SET 'FLAG' TO INDICATE SYSPUNCH NOT OPEN          @YD00113*/ 02473000
*       /* AND WRITE WARNING MESSAGE 'ICG402I                @YD00113*/ 02474000
*       /* UNABLE TO OPEN SYSPUNCH. OUTPUT LISTED            @YD00113*/ 02475000
*       /* IN MESSAGE DATA SET.'                             @YD00113*/ 02476000
*       /* *****************************************         @YD00113*/ 02477000
*       /*                                                           */ 02478000
*       /*************************************************************/ 02479000
*                                                                  0470 02480000
*       FLAG=1;                     /*                       @Y30LB14*/ 02481000
         MVI   FLAG,X'01'                                          0470 02482000
*       MSGNO=ICG402I;              /* ID FOR ICG402I        @YM31086*/ 02483000
         MVC   MSGNO(2,R4),ICG402I                                 0471 02484000
*       WARNING=WARNING+1;          /* BUMP WARNING CNT      @YM31086*/ 02485000
         LA    @15,1                                               0472 02486000
         AH    @15,WARNING(,R4)                                    0472 02487000
         STH   @15,WARNING(,R4)                                    0472 02488000
*       GEN(LINK  EP=ICGDSMSG);     /* TO MSG WRITER         @YM31086*/ 02489000
         LINK  EP=ICGDSMSG                                              02490000
*     END;                          /*                       @Y30LB14*/ 02491000
*   ELSE                                                           0475 02492000
*     ;                             /* SYSPUNCH OPEN OK      @Y30LB14*/ 02493000
@RF00468 DS    0H                                                  0476 02494000
*   RETURN;                         /*                       @Y30LB14*/ 02495000
@EL00013 DS    0H                                                  0476 02496000
@EF00013 DS    0H                                                  0476 02497000
@ER00013 LM    @14,@12,@SA00013                                    0476 02498000
         BR    @14                                                 0476 02499000
*   END SCANOPEN;                   /*                       @Y30LB14*/ 02500000
*                                                                  0478 02501000
*/********************************************************** @YD00113*/ 02502000
*/*                                                          @YD00113*/ 02503000
*/* PROCEDURE NAME - PUTOUTCD                                @YD00113*/ 02504000
*/*                                                          @YD00113*/ 02505000
*/* FUNCTION - THIS ROUTINE PUNCHES (IF SYSPUNCH IS OPEN)    @YD00113*/ 02506000
*/*            AND PRINTS THE RECORD BUILT IN INBUF AND      @YD00113*/ 02507000
*/*            CLEARS INBUF.                                 @YD00113*/ 02508000
*/*                                                          @YD00113*/ 02509000
*/********************************************************** @YD00113*/ 02510000
*                                                                  0478 02511000
*PUTOUTCD:                                                         0478 02512000
*   PROCEDURE;                      /*                       @Y30LB14*/ 02513000
PUTOUTCD STM   @14,@04,@SA00014                                    0478 02514000
         STM   @06,@12,@SA00014+28                                 0478 02515000
*   IF IODSW='1'B THEN              /* IN IODEVICE ROUTINE   @OZ09548*/ 02516000
         TM    IODSW,B'10000000'                                   0479 02517000
         BNO   @RF00479                                            0479 02518000
*     DO;                           /*                       @OZ09548*/ 02519000
*                                                                  0480 02520000
*       /*************************************************************/ 02521000
*       /*                                                           */ 02522000
*       /* ***************************************           @OZ09548*/ 02523000
*       /* CALL ROUTINE TO CONVERT BINARY                    @OZ09548*/ 02524000
*       /* SEQUENCE NUMBER INTO TWO PRINTABLE                @OZ09548*/ 02525000
*       /* CHARACTERS WHICH ARE PLACED IN BYTES              @OZ09548*/ 02526000
*       /* 7 AND 8 OF THE LABEL FIELD.                       @OZ09548*/ 02527000
*       /* ***************************************           @OZ09548*/ 02528000
*       /*                                                           */ 02529000
*       /*************************************************************/ 02530000
*                                                                  0481 02531000
*       SEQNUM=SEQNUM+1;            /* INCREMENT CARD COUNT  @OZ09548*/ 02532000
         MVC   @ZT00002+2(2),SEQNUM                                0481 02533000
         L     @01,@ZT00002                                        0481 02534000
         LA    @01,1(,@01)                                         0481 02535000
         STH   @01,SEQNUM                                          0481 02536000
*       CALL SEQUENCE;              /*                       @OZ09548*/ 02537000
         BAL   @14,SEQUENCE                                        0482 02538000
*       IF CNT>=10 THEN             /*                       @OZ09548*/ 02539000
         L     @15,CNT                                             0483 02540000
         LA    @01,10                                              0483 02541000
         CR    @15,@01                                             0483 02542000
         BL    @RF00483                                            0483 02543000
*         DO;                       /*                       @OZ09548*/ 02544000
*           INBUF(32)=TABLE(CNT/10+1);/*                     @OZ09548*/ 02545000
         LR    @02,@15                                             0485 02546000
         SRDA  @02,32                                              0485 02547000
         DR    @02,@01                                             0485 02548000
         LA    @02,TABLE(@03)                                      0485 02549000
         MVC   INBUF+31(1,R4),0(@02)                               0485 02550000
*           INBUF(33)=TABLE(CNT//10+1);/*                    @OZ09548*/ 02551000
         LR    @02,@15                                             0486 02552000
         SRDA  @02,32                                              0486 02553000
         DR    @02,@01                                             0486 02554000
         LA    @15,TABLE(@02)                                      0486 02555000
         MVC   INBUF+32(1,R4),0(@15)                               0486 02556000
*         END;                      /*                       @OZ09548*/ 02557000
*                                                                  0487 02558000
*       /*************************************************************/ 02559000
*       /*                                                           */ 02560000
*       /* ***********************************************   @OZ09548*/ 02561000
*       /* COMPUTE THE LOW-ORDER OR ONLY DIGIT OF THE        @OZ09548*/ 02562000
*       /* NUMBER OF RECORDS IN THE GROUP.                   @OZ09548*/ 02563000
*       /* ***********************************************   @OZ09548*/ 02564000
*       /*                                                           */ 02565000
*       /*************************************************************/ 02566000
*                                                                  0488 02567000
*       ELSE                        /*                       @OZ09548*/ 02568000
*         DO;                       /*                       @OZ09548*/ 02569000
         B     @RC00483                                            0488 02570000
@RF00483 DS    0H                                                  0489 02571000
*           INBUF(32)=TABLE(CNT//10+1);/*                    @OZ09548*/ 02572000
         L     @02,CNT                                             0489 02573000
         SRDA  @02,32                                              0489 02574000
         D     @02,@CF00033                                        0489 02575000
         LA    @15,TABLE(@02)                                      0489 02576000
         MVC   INBUF+31(1,R4),0(@15)                               0489 02577000
*           INBUF(33:71)=INBUF(34:72);/* SHIFT CNT FLD       @OZ09534*/ 02578000
         MVC   @TS00001(39),INBUF+33(R4)                           0490 02579000
         MVC   INBUF+32(39,R4),@TS00001                            0490 02580000
*           N=N-1;                  /* RESET NEXT COLUMN PTR @OZ09534*/ 02581000
         BCTR  N,0                                                 0491 02582000
*         END;                      /*                       @OZ09548*/ 02583000
*                                                                  0492 02584000
*       /*************************************************************/ 02585000
*       /*                                                           */ 02586000
*       /* ***********************************************   @YD00113*/ 02587000
*       /* VERIFY OVERFLOW OR UNITNAME CONDITIONS AND,       @OZ09534*/ 02588000
*       /* IF SYSPUNCH HAS BEEN OPENED, PUNCH CARD.          @OZ09534*/ 02589000
*       /* ***********************************************   @YD00113*/ 02590000
*       /*                                                           */ 02591000
*       /*************************************************************/ 02592000
*                                                                  0493 02593000
*       IF OVRFLW='1'B THEN         /*                       @OZ09534*/ 02594000
@RC00483 TM    OVRFLW,B'00010000'                                  0493 02595000
         BNO   @RF00493                                            0493 02596000
*         DO;                       /*                       @OZ09534*/ 02597000
*           INBUF(N)=',';           /* PREPARE SYSGEN FORMAT @OZ09534*/ 02598000
         LR    @15,R4                                              0495 02599000
         ALR   @15,N                                               0495 02600000
         MVI   INBUF-1(@15),C','                                   0495 02601000
*           INBUF(72)='*';          /*                       @OZ09534*/ 02602000
         MVI   INBUF+71(R4),C'*'                                   0496 02603000
*           IF FLAG=0 THEN          /*                       @OZ09534*/ 02604000
         CLI   FLAG,0                                              0497 02605000
         BNE   @RF00497                                            0497 02606000
*             DO;                   /*                       @OZ09534*/ 02607000
*               R1=ADDR(READDCB);   /* ADDR OF DCB           @OZ09534*/ 02608000
         LA    R1,READDCB(,R4)                                     0499 02609000
*               R0=ADDR(INBUF);     /* ADDR OF I/O AREA      @OZ09534*/ 02610000
         LA    R0,INBUF(,R4)                                       0500 02611000
*               GEN(PUT   (1),(0)); /* GET REG NOTATION      @OZ09534*/ 02612000
         PUT   (1),(0)                                                  02613000
*             END;                  /*                       @OZ09534*/ 02614000
*           PRNTCARD='1'B;          /* PRINT CARD ON         @OZ09534*/ 02615000
@RF00497 OI    PRNTCARD(R4),B'00010000'                            0503 02616000
*           GEN(LINK  EP=ICGDSMSG); /* CALL MSG WRITER       @OZ09534*/ 02617000
         LINK  EP=ICGDSMSG                                              02618000
*           LASTPARM='0'B;          /* RESET END-OF-CARD     @OZ09534*/ 02619000
         NI    LASTPARM(R4),B'11110111'                            0505 02620000
*           INBUF(1:72)='';         /*                       @OZ09534*/ 02621000
         MVI   INBUF(R4),C' '                                      0506 02622000
         MVC   INBUF+1(71,R4),INBUF(R4)                            0506 02623000
*           INBUF(16:31)='FEATURE=(SHARED)';/* CONTINUATION  @OZ09534   02624000
*                                      CARD                  @OZ09534*/ 02625000
         MVC   INBUF+15(16,R4),@CC00790                            0507 02626000
*           SEQNUM=SEQNUM+1;        /*                       @OZ09534*/ 02627000
         MVC   @ZT00002+2(2),SEQNUM                                0508 02628000
         L     @01,@ZT00002                                        0508 02629000
         LA    @01,1(,@01)                                         0508 02630000
         STH   @01,SEQNUM                                          0508 02631000
*           SETSEQ='1'B;            /*                       @OZ09534*/ 02632000
         OI    SETSEQ,B'00001000'                                  0509 02633000
*           CALL SEQUENCE;          /*                       @OZ09534*/ 02634000
         BAL   @14,SEQUENCE                                        0510 02635000
*           IF FLAG=0 THEN          /*                       @OZ09534*/ 02636000
         CLI   FLAG,0                                              0511 02637000
         BNE   @RF00511                                            0511 02638000
*             DO;                   /*                       @OZ09534*/ 02639000
*               R1=ADDR(READDCB);   /* ADDR OF DCB           @OZ09534*/ 02640000
         LA    R1,READDCB(,R4)                                     0513 02641000
*               R0=ADDR(INBUF);     /* ADDR OF I/O AREA      @OZ09534*/ 02642000
         LA    R0,INBUF(,R4)                                       0514 02643000
*               GEN(PUT   (1),(0)); /* GET REG NOTATION      @OZ09534*/ 02644000
         PUT   (1),(0)                                                  02645000
*             END;                  /* FLAG = OFF            @OZ09534*/ 02646000
*           PRNTCARD='1'B;          /* PRINT CARD ON         @OZ09534*/ 02647000
@RF00511 OI    PRNTCARD(R4),B'00010000'                            0517 02648000
*           GEN(LINK  EP=ICGDSMSG); /* CALL MSG WRITER       @OZ09534*/ 02649000
         LINK  EP=ICGDSMSG                                              02650000
*           LASTPARM='0'B;          /* RESET END-OF-CARD     @OZ09534*/ 02651000
         NI    LASTPARM(R4),B'11110111'                            0519 02652000
*           SWIOD=0;                /* RESET SWITCHES FOR NEW CARD 0520 02653000
*                                                            @OZ09534*/ 02654000
         MVI   SWIOD,X'00'                                         0520 02655000
*           INBUF='';               /* CLEAR INBUF           @OZ09534*/ 02656000
         MVI   INBUF(R4),C' '                                      0521 02657000
         MVC   INBUF+1(79,R4),INBUF(R4)                            0521 02658000
*           RETURN;                 /*                       @OZ09534*/ 02659000
@EL00014 DS    0H                                                  0522 02660000
@EF00014 DS    0H                                                  0522 02661000
@ER00014 LM    @14,@04,@SA00014                                    0522 02662000
         LM    @06,@12,@SA00014+28                                 0522 02663000
         BR    @14                                                 0522 02664000
*         END;                      /* NO OVERFLOW           @OZ09534*/ 02665000
*       IF FLAG=0 THEN              /*                       @OZ09534*/ 02666000
@RF00493 CLI   FLAG,0                                              0524 02667000
         BNE   @RF00524                                            0524 02668000
*         DO;                       /*                       @OZ09534*/ 02669000
*           R1=ADDR(READDCB);       /* ADDR OF DCB           @OZ09534*/ 02670000
         LA    R1,READDCB(,R4)                                     0526 02671000
*           R0=ADDR(INBUF);         /* ADDR OF I/O AREA      @OZ09534*/ 02672000
         LA    R0,INBUF(,R4)                                       0527 02673000
*           GEN(PUT   (1),(0));     /* GET REG NOTATION      @OZ09534*/ 02674000
         PUT   (1),(0)                                                  02675000
*         END;                      /*                       @OZ09534*/ 02676000
*       PRNTCARD='1'B;              /* PRINT CARD ON         @OZ09534*/ 02677000
@RF00524 OI    PRNTCARD(R4),B'00010000'                            0530 02678000
*       GEN(LINK  EP=ICGDSMSG);     /* CALL MSG WRITER       @OZ09534*/ 02679000
         LINK  EP=ICGDSMSG                                              02680000
*       LASTPARM='0'B;              /* RESET END-OF-CARD     @OZ09534*/ 02681000
         NI    LASTPARM(R4),B'11110111'                            0532 02682000
*       SWIOD=0;                    /* RESET SWITCHES FOR NEW CARD 0533 02683000
*                                                            @OZ09534*/ 02684000
         MVI   SWIOD,X'00'                                         0533 02685000
*       INBUF='';                   /* CLEAR INBUF           @OZ09534*/ 02686000
         MVI   INBUF(R4),C' '                                      0534 02687000
         MVC   INBUF+1(79,R4),INBUF(R4)                            0534 02688000
*       RETURN;                     /*                       @OZ09534*/ 02689000
         B     @EL00014                                            0535 02690000
*     END;                          /* IODSW = OFF           @Z40LB73*/ 02691000
*                                                                  0536 02692000
*   /*****************************************************************/ 02693000
*   /*                                                               */ 02694000
*   /* IN UNITNAME ROUTINE                                   @OZ09534*/ 02695000
*   /* TRANSPOSED CPU TO SORT COLUMN                         @OZ09534*/ 02696000
*   /*                                                               */ 02697000
*   /*****************************************************************/ 02698000
*                                                                  0537 02699000
*   SEQNUM=SEQNUM+1;                /*                       @OZ09534*/ 02700000
@RF00479 MVC   @ZT00002+2(2),SEQNUM                                0537 02701000
         L     @01,@ZT00002                                        0537 02702000
         LA    @01,1(,@01)                                         0537 02703000
         STH   @01,SEQNUM                                          0537 02704000
*   CALL SEQUENCE;                  /*                       @OZ09534*/ 02705000
         BAL   @14,SEQUENCE                                        0538 02706000
*   IF FLAG=0                       /*                       @OZ09548*/ 02707000
*     THEN                                                         0539 02708000
         CLI   FLAG,0                                              0539 02709000
         BNE   @RF00539                                            0539 02710000
*     DO;                           /*                       @Y30LB14*/ 02711000
*       R1=ADDR(READDCB);           /* ADDR OF DCB           @Y30LB14*/ 02712000
         LA    R1,READDCB(,R4)                                     0541 02713000
*       R0=ADDR(INBUF);             /* ADDR OF I/O AREA      @Y30LB14*/ 02714000
         LA    R0,INBUF(,R4)                                       0542 02715000
*       GEN(PUT   (1),(0));         /* GET REG NOTATION      @Y30LB14*/ 02716000
         PUT   (1),(0)                                                  02717000
*     END;                          /*                       @Y30LB14*/ 02718000
*   PRNTCARD='1'B;                  /* PRINT CARD ON         @Y30LB14*/ 02719000
@RF00539 OI    PRNTCARD(R4),B'00010000'                            0545 02720000
*   GEN(LINK  EP=ICGDSMSG);         /* CALL MSG WRITER       @Y30LB14*/ 02721000
         LINK  EP=ICGDSMSG                                              02722000
*   LASTPARM='0'B;                  /* RESET END-OF-CARD     @Y30LB14*/ 02723000
         NI    LASTPARM(R4),B'11110111'                            0547 02724000
*   INBUF='';                       /*                       @Y30LB14*/ 02725000
         MVI   INBUF(R4),C' '                                      0548 02726000
         MVC   INBUF+1(79,R4),INBUF(R4)                            0548 02727000
*   RETURN;                         /*                       @Y30LB14*/ 02728000
*                                                                  0549 02729000
         B     @EL00014                                            0549 02730000
*   /*****************************************************************/ 02731000
*   /*                                                               */ 02732000
*   /* UNITNAME END PROCESSING                               @OZ09534*/ 02733000
*   /*                                                               */ 02734000
*   /*****************************************************************/ 02735000
*                                                                  0550 02736000
*   END PUTOUTCD;                   /*                       @Y30LB14*/ 02737000
*                                                                  0551 02738000
*/********************************************************************/ 02739000
*/*                                                          @OZ09548*/ 02740000
*/*  PROCEDURE NAME - IODSTRT                                @OZ09548*/ 02741000
*/*                                                          @OZ09548*/ 02742000
*/*  FUNCTION - THIS ROUTINE IS ENTERED EACH TIME A          @OZ09548*/ 02743000
*/*             IODEVICE IMAGE IS STARTED. THE CUD AND       @OZ09548*/ 02744000
*/*             CPU ID IS INSERTED IN THEIR APPROPRIATE      @OZ09548*/ 02745000
*/*             PLACES IN THE CARD IMAGE.                    @OZ09548*/ 02746000
*/********************************************************** @OZ09548*/ 02747000
*                                                                  0551 02748000
*IODSTRT:                                                          0551 02749000
*   PROCEDURE;                      /*                       @OZ09548*/ 02750000
IODSTRT  STM   @14,@04,@SA00015                                    0551 02751000
         STM   @06,@12,@SA00015+28                                 0551 02752000
*   IODSW='1'B;                     /* FIRST TIME IMAGE BUILD      0552 02753000
*                                                            @OZ09548*/ 02754000
         OI    IODSW,B'10000000'                                   0552 02755000
*   INBUF(1:44)=                    /*                       @OZ09548*/ 02756000
*       'I        IODEVICE ADDRESS=(   ,  ),UNIT=3330';            0553 02757000
*                                                                  0553 02758000
         MVC   INBUF(44,R4),@CC00796                               0553 02759000
*   /*****************************************************************/ 02760000
*   /*                                                               */ 02761000
*   /* ***************************************               @S60RSPC*/ 02762000
*   /* MAY BE 3350                                           @S60RSPC*/ 02763000
*   /* ***************************************               @S60RSPC*/ 02764000
*   /*                                                               */ 02765000
*   /*****************************************************************/ 02766000
*                                                                  0554 02767000
*   I1=(I+2)/3;                     /* INDEX BY 16           @S60RSPC*/ 02768000
         LA    @08,2                                               0554 02769000
         ALR   @08,I                                               0554 02770000
         SRDA  @08,32                                              0554 02771000
         D     @08,@CF00051                                        0554 02772000
         ST    @09,I1                                              0554 02773000
*   I2=(J+7)/8;                     /* DASD CTL 1 TO 4       @S60RSPC*/ 02774000
         LA    @15,7                                               0555 02775000
         ALR   @15,J                                               0555 02776000
         LR    I2,@15                                              0555 02777000
         SRDA  I2,32                                               0555 02778000
         D     I2,@CF00043                                         0555 02779000
         LR    I2,@07                                              0555 02780000
*   I3=(J+7)//8+1;                  /* DEVICE 1 TO 8         @S60RSPC*/ 02781000
*                                                                  0556 02782000
         LR    @08,@15                                             0556 02783000
         SRDA  @08,32                                              0556 02784000
         D     @08,@CF00043                                        0556 02785000
         AL    @08,@CF00045                                        0556 02786000
         ST    @08,I3                                              0556 02787000
*   /*****************************************************************/ 02788000
*   /*                                                               */ 02789000
*   /* IF 3350                                               @S60RS73*/ 02790000
*   /*                                                               */ 02791000
*   /*****************************************************************/ 02792000
*                                                                  0557 02793000
*   IF MERLICEB(I1,I2,I3)=PHYSFMAD  /*                       @S60RSPC*/ 02794000
*     THEN                          /*                       @S60RSPC*/ 02795000
         L     @15,I1                                              0557 02796000
         SLA   @15,2                                               0557 02797000
         ALR   @15,I2                                              0557 02798000
         SLA   @15,3                                               0557 02799000
         ALR   @15,@08                                             0557 02800000
         ALR   @15,@15                                             0557 02801000
         ALR   @15,R4                                              0557 02802000
         TM    MERLICEB-82(@15),B'11000000'                        0557 02803000
         BNO   @RF00557                                            0557 02804000
*     INBUF(43)='5';                /* 3350                  @S60RS73*/ 02805000
         MVI   INBUF+42(R4),C'5'                                   0558 02806000
*   ELSE                                                           0559 02807000
*     ;                             /*                       @S60RSPC*/ 02808000
*                                                                  0559 02809000
@RF00557 DS    0H                                                  0560 02810000
*   /*****************************************************************/ 02811000
*   /*                                                               */ 02812000
*   /* ***************************************               @OZ09548*/ 02813000
*   /* CALL CPUIDP TO UNPACK CPUID. UPON                     @OZ09548*/ 02814000
*   /* RETURN, PLACE CHARACTERS 2-6 OF CPUID                 @OZ09548*/ 02815000
*   /* (MACHINE SERIAL 5 LOW ORDER DIGITS)                   @OZ09548*/ 02816000
*   /* INTO BYTES 2-6 OF LABEL FIELD.                        @OZ09548*/ 02817000
*   /* ***************************************               @OZ09548*/ 02818000
*   /*                                                               */ 02819000
*   /*****************************************************************/ 02820000
*                                                                  0560 02821000
*   CALL CPUIDP;                    /* UNPACK CPU ID         @OZ09548*/ 02822000
         BAL   @14,CPUIDP                                          0560 02823000
*   INBUF(2:6)=UNPACKED(2:6);       /*                       @OZ09548*/ 02824000
*                                                                  0561 02825000
         MVC   INBUF+1(5,R4),UNPACKED+1                            0561 02826000
*   /*****************************************************************/ 02827000
*   /*                                                               */ 02828000
*   /* ***************************************               @OZ09548*/ 02829000
*   /* CALL CUDADDR TO DEVELOP THE UCB                       @OZ09548*/ 02830000
*   /* ADDRESS (CHANNEL/CONTROL UNIT/DEVICE)                 @OZ09548*/ 02831000
*   /* AS PRINTABLE CHARACTERS AND PLACE IN                  @OZ09548*/ 02832000
*   /* SPACE RESERVED FOR UCB ADDRESS                        @OZ09548*/ 02833000
*   /* ***************************************               @OZ09548*/ 02834000
*   /*                                                               */ 02835000
*   /*****************************************************************/ 02836000
*                                                                  0562 02837000
*   CALL CUDADDR;                   /* CHANNEL, UNIT, DEVICE @OZ09548*/ 02838000
         BAL   @14,CUDADDR                                         0562 02839000
*   INBUF(28:30)=CUD;               /*                       @OZ09548*/ 02840000
*                                                                  0563 02841000
         MVC   INBUF+27(3,R4),CUD                                  0563 02842000
*   /*****************************************************************/ 02843000
*   /*                                                               */ 02844000
*   /* ***************************************               @OZ09548*/ 02845000
*   /* INITIALIZE POINTER TO START OF                        @OZ09548*/ 02846000
*   /* OPTIONAL FIELDS                                       @OZ09548*/ 02847000
*   /* ***************************************               @OZ09548*/ 02848000
*   /*                                                               */ 02849000
*   /*****************************************************************/ 02850000
*                                                                  0564 02851000
*   N=45;                           /*                       @OZ09548*/ 02852000
*                                                                  0564 02853000
         LA    N,45                                                0564 02854000
*   /*****************************************************************/ 02855000
*   /*                                                               */ 02856000
*   /* ***************************************               @OZ09548*/ 02857000
*   /* COMPLETE TYPE & VARIABLE                              @OZ09548*/ 02858000
*   /* FIELDS IN IODEVICE IMAGE. IF DEVICE                   @OZ09548*/ 02859000
*   /* USAGE IS VIRTUAL OR VIRTUAL SHARED,                   @OZ09548*/ 02860000
*   /* MODIFY UNIT FIELD FROM 3330 TO                        @OZ09548*/ 02861000
*   /* 3330V, CHECK FOR POSSIBLE ALT. PATH                   @OZ09548*/ 02862000
*   /* INFORMATION. IF THE DEVICE IS SHARED                  @OZ09548*/ 02863000
*   /* VIRTUAL, ADD 'FEATURE=(SHARED)' TO                    @OZ09548*/ 02864000
*   /* RECORD.                                               @OZ09548*/ 02865000
*   /* ***************************************               @OZ09548*/ 02866000
*   /*                                                               */ 02867000
*   /*****************************************************************/ 02868000
*                                                                  0565 02869000
*   IF USEV(I,J)='1'B THEN                                         0565 02870000
         LR    @15,I                                               0565 02871000
         SLA   @15,6                                               0565 02872000
         ALR   @15,J                                               0565 02873000
         MH    @15,@CH00034                                        0565 02874000
         L     @01,COMPTR2(,R4)                                    0565 02875000
         ALR   @01,@15                                             0565 02876000
         AL    @01,@CF00829                                        0565 02877000
         TM    USEV-464(@01),B'01000000'                           0565 02878000
         BNO   @RF00565                                            0565 02879000
*     DO;                           /*                       @Y30LB14*/ 02880000
*       INBUF(N)='V';               /*                       @Y30LB14*/ 02881000
         LR    @15,R4                                              0567 02882000
         ALR   @15,N                                               0567 02883000
         MVI   INBUF-1(@15),C'V'                                   0567 02884000
*       N=N+1;                      /*                       @Y30LB14*/ 02885000
         LA    @15,1                                               0568 02886000
         ALR   N,@15                                               0568 02887000
*       OLDJ=J;                     /* SET UP ADDRESS CHECK  @OZ09548*/ 02888000
         ST    J,OLDJ                                              0569 02889000
*       OLDI=I;                     /* SET UP CHAN/CUA CHK   @OZ09548*/ 02890000
         STH   I,OLDI                                              0570 02891000
*       CNT=1;                      /* SET UP CNT            @OZ09548*/ 02892000
         ST    @15,CNT                                             0571 02893000
*       CALL OPTCHAN;               /* ANALYZE ALT. PATHS    @OZ09548*/ 02894000
         BAL   @14,OPTCHAN                                         0572 02895000
*       RETURN;                                                    0573 02896000
@EL00015 DS    0H                                                  0573 02897000
@EF00015 DS    0H                                                  0573 02898000
@ER00015 LM    @14,@04,@SA00015                                    0573 02899000
         LM    @06,@12,@SA00015+28                                 0573 02900000
         BR    @14                                                 0573 02901000
*     END;                                                         0574 02902000
*   ELSE                                                           0575 02903000
*     IF USEVS(I,J)='1'B            /* USED FEAT. SHARED     @OZ09548*/ 02904000
*       THEN                                                       0575 02905000
@RF00565 LR    @15,I                                               0575 02906000
         SLA   @15,6                                               0575 02907000
         ALR   @15,J                                               0575 02908000
         MH    @15,@CH00034                                        0575 02909000
         L     @01,COMPTR2(,R4)                                    0575 02910000
         ALR   @01,@15                                             0575 02911000
         AL    @01,@CF00829                                        0575 02912000
         TM    USEVS-464(@01),B'00100000'                          0575 02913000
         BNO   @RF00575                                            0575 02914000
*       DO;                         /*                       @OZ09548*/ 02915000
*         INBUF(N)='V';             /*                       @Y30LB14*/ 02916000
         LR    @15,R4                                              0577 02917000
         ALR   @15,N                                               0577 02918000
         MVI   INBUF-1(@15),C'V'                                   0577 02919000
*         N=N+1;                    /*                       @Y30LB14*/ 02920000
         LA    @15,1                                               0578 02921000
         ALR   N,@15                                               0578 02922000
*         OLDJ=J;                   /* SET UP ADDRESS CHECK  @OZ09548*/ 02923000
         ST    J,OLDJ                                              0579 02924000
*         OLDI=I;                   /* SET UP CHAN/CUA CHK   @OZ09548*/ 02925000
         STH   I,OLDI                                              0580 02926000
*         CNT=1;                    /* SET UP CNT            @OZ09548*/ 02927000
         ST    @15,CNT                                             0581 02928000
*         FS='1'B;                  /* SET FEAT. SHARED SW   @OZ09548*/ 02929000
         OI    FS,B'01000000'                                      0582 02930000
*         CALL OPTCHAN;             /* ANALYZE ALT. PATHS    @OZ09534*/ 02931000
*                                                                  0583 02932000
         BAL   @14,OPTCHAN                                         0583 02933000
*         /***********************************************************/ 02934000
*         /*                                                         */ 02935000
*         /* OVERFLOW CONDITION PRINTS CONTINUATION CHAR. IN CC72    */ 02936000
*         /*                                                 @OZ09534*/ 02937000
*         /*                                                         */ 02938000
*         /***********************************************************/ 02939000
*                                                                  0584 02940000
*         IF OVRFLW^='1'B THEN      /*                       @OZ09534*/ 02941000
         TM    OVRFLW,B'00010000'                                  0584 02942000
         BO    @RF00584                                            0584 02943000
*           INBUF(N:N+16)=',FEATURE=(SHARED)';/*             @OZ09534*/ 02944000
         LR    @15,R4                                              0585 02945000
         ALR   @15,N                                               0585 02946000
         MVC   INBUF-1(17,@15),@CC00802                            0585 02947000
*         RETURN;                   /*                       @OZ09534*/ 02948000
         B     @EL00015                                            0586 02949000
*       END;                                                       0587 02950000
*                                                                  0587 02951000
*   /*****************************************************************/ 02952000
*   /*                                                               */ 02953000
*   /* ***************************************               @YD00113*/ 02954000
*   /* IF THE DEVICE USAGE IS REAL OR                        @YD00113*/ 02955000
*   /* CONVERTIBLE AND THE DEVICE WAS                        @YD00113*/ 02956000
*   /* SPECIFIED AS '3330-11' IN THE DASD                    @YD00113*/ 02957000
*   /* STATEMENT, ADD 'MODEL=11' TO THE                      @YD00113*/ 02958000
*   /* STATEMENT. (INFORMATION FOR 3330-11                   @YD00113*/ 02959000
*   /* MOVED INTO CONFGUCB STRUCTURE BY                      @YD00113*/ 02960000
*   /* MODULE ICGDSA07.)                                     @YD00113*/ 02961000
*   /* ***************************************               @YD00113*/ 02962000
*   /*                                                               */ 02963000
*   /*****************************************************************/ 02964000
*                                                                  0588 02965000
*     ELSE                          /* NOT USEV OR VIRT. SHRD      0588 02966000
*                                                            @OZ09548*/ 02967000
*       IF USEREAL(I,J)='1'B|       /*                       @OZ09548*/ 02968000
*           USECONVR(I,J)='1'B THEN /*                       @OZ09548*/ 02969000
@RF00575 LR    @15,I                                               0588 02970000
         SLA   @15,6                                               0588 02971000
         ALR   @15,J                                               0588 02972000
         MH    @15,@CH00034                                        0588 02973000
         L     @01,COMPTR2(,R4)                                    0588 02974000
         ALR   @01,@15                                             0588 02975000
         AL    @01,@CF00829                                        0588 02976000
         TM    USEREAL-464(@01),B'00010100'                        0588 02977000
         BZ    @RF00588                                            0588 02978000
*         DO;                       /*                       @Y30LB14*/ 02979000
*           OLDJ=J;                 /* SETUP ADDRESS CHK     @OZ09548*/ 02980000
         ST    J,OLDJ                                              0590 02981000
*           OLDI=I;                 /* CHK FOR CHANGE IN CHAN/CUA  0591 02982000
*                                                            @OZ09548*/ 02983000
         STH   I,OLDI                                              0591 02984000
*           CNT=1;                  /* SET UP CNT            @OZ09548*/ 02985000
         MVC   CNT(4),@CF00045                                     0592 02986000
*           CALL OPTCHAN;           /*                       @OZ09548*/ 02987000
         BAL   @14,OPTCHAN                                         0593 02988000
*           IF ICEBERG(I,J)='1'B    /*                       @OZ09548*/ 02989000
*             THEN                  /*                       @OZ09548*/ 02990000
         LR    @15,I                                               0594 02991000
         SLA   @15,6                                               0594 02992000
         ALR   @15,J                                               0594 02993000
         MH    @15,@CH00034                                        0594 02994000
         L     @01,COMPTR2(,R4)                                    0594 02995000
         ALR   @01,@15                                             0594 02996000
         AL    @01,@CF00829                                        0594 02997000
         TM    ICEBERG-464(@01),B'00000001'                        0594 02998000
         BNO   @RF00594                                            0594 02999000
*             INBUF(N:N+8)=',MODEL=11';/*                    @OZ09548*/ 03000000
         LR    @15,R4                                              0595 03001000
         ALR   @15,N                                               0595 03002000
         MVC   INBUF-1(9,@15),@CC00804                             0595 03003000
*         END;                      /*                       @OZ09548*/ 03004000
*   END IODSTRT;                                                   0597 03005000
         B     @EL00015                                            0597 03006000
*                                                                  0598 03007000
*/********************************************************** @Y30LB14*/ 03008000
*/*                                                          @Y30LB14*/ 03009000
*/* PROCEDURE NAME - ICGDSB19, MAINLINE (ENDDATA)            @Y30LB14*/ 03010000
*/*                                                          @Y30LB14*/ 03011000
*/* FUNCTION - CLOSE SYSPUNCH                                @Y30LB14*/ 03012000
*/*                                                          @Y30LB14*/ 03013000
*/********************************************************** @Y30LB14*/ 03014000
*                                                                  0598 03015000
*ENDDATA:                                                          0598 03016000
*   PROCEDURE;                      /*                       @Y30LB14*/ 03017000
ENDDATA  STM   @14,@12,@SA00016                                    0598 03018000
*   DCBPTR=ADDR(READDCB);           /* SET DCB OVERLAY       @Y30LB14*/ 03019000
         LA    @15,READDCB(,R4)                                    0599 03020000
         ST    @15,DCBPTR(,R4)                                     0599 03021000
*   IF DCBOFOPN='1'B                /* IF SYSPCH IS OPEN     @YD00113*/ 03022000
*     THEN                          /*                       @Y30LB14*/ 03023000
         TM    DCBOFOPN+40(@15),B'00010000'                        0600 03024000
         BNO   @RF00600                                            0600 03025000
*     DO;                           /*                       @Y30LB14*/ 03026000
*       OPENLIST=ADDR(READDCB);     /* POINTER TO DCB        @Y30LB14*/ 03027000
         ST    @15,OPENLIST(,R4)                                   0602 03028000
*       OPENLIST(1)='8F'X;          /* END-OF LIST IND.      @Y30LB12*/ 03029000
         MVI   OPENLIST(R4),X'8F'                                  0603 03030000
*       R1=ADDR(OPENLIST);          /* POINT AT LIST         @Y30LB14*/ 03031000
         LA    R1,OPENLIST(,R4)                                    0604 03032000
*       GEN(CLOSE MF=(E,(1)));      /* EXECUTE CLOSE         @Y30LB14*/ 03033000
         CLOSE MF=(E,(1))                                               03034000
*     END;                          /*                       @Y30LB14*/ 03035000
*   ELSE                                                           0607 03036000
*     ;                             /* IF NEVER OPENED,      @Y30LB14*/ 03037000
@RF00600 DS    0H                                                  0608 03038000
*   RETURN;                         /* TO CALLER             @Y30LB14*/ 03039000
@EL00016 DS    0H                                                  0608 03040000
@EF00016 DS    0H                                                  0608 03041000
@ER00016 LM    @14,@12,@SA00016                                    0608 03042000
         BR    @14                                                 0608 03043000
*   END ENDDATA;                    /*                       @Y30LB14*/ 03044000
*                                                                  0610 03045000
*/********************************************************** @Y30LB14*/ 03046000
*/*                                                          @Y30LB14*/ 03047000
*/* PROCEDURE NAME - DCBROUT2 (MAINLINE - OPEN EXIT          @Y30LB14*/ 03048000
*/*                                                          @Y30LB14*/ 03049000
*/* FUNCTION - DCB OPEN EXIT FOR SYSPUNCH.  THIS EXIT        @Y30LB14*/ 03050000
*/*            ESTABLISHES THE BLKSIZE/LRECL OF SYSPUNCH     @OZ05099*/ 03051000
*/*            AS 81 IF NOT SUPPLIED ON DD STATEMENT. ALSO   @OZ05099*/ 03052000
*/*            SETS RECFM TO FIXED-BLOCKED.  IF BLOCKSIZE    @Y30LB14*/ 03053000
*/*            NOT A MULTIPLE OF LRECL, BLOCKSIZE IS SET TO  @OZ05099*/ 03054000
*/*            LRECL.                                        @OZ05099*/ 03055000
*/*                                                          @Y30LB14*/ 03056000
*/********************************************************** @Y30LB14*/ 03057000
*                                                                  0610 03058000
*DCBROUT2:                                                         0610 03059000
*   SAVE14=R14;                     /* SAVE OPEN'S REG14     @Y30LB14*/ 03060000
DCBROUT2 ST    R14,SAVE14(,R4)                                     0610 03061000
*   DCBPTR=ADDR(READDCB);           /* SET DCB OVERLAY       @Y30LB14*/ 03062000
         LA    @15,READDCB(,R4)                                    0611 03063000
         ST    @15,DCBPTR(,R4)                                     0611 03064000
*   IF DCBLRECL^=81                 /* IF LRECL NOT SPECIFIED OR   0612 03065000
*                                                            @OZ05099*/ 03066000
*                                                                  0612 03067000
*   /*****************************************************************/ 03068000
*   /*                                                               */ 03069000
*   /* NOT 81 SET TO 80                                      @OZ05099*/ 03070000
*   /*                                                               */ 03071000
*   /*****************************************************************/ 03072000
*                                                                  0612 03073000
*     THEN                                                         0612 03074000
         AH    @15,@CH00282                                        0612 03075000
         CLC   DCBLRECL(2,@15),@CH00810                            0612 03076000
         BE    @RF00612                                            0612 03077000
*     DCBLRECL=80;                  /*                       @OZ05099*/ 03078000
         MVC   DCBLRECL(2,@15),@CH00057                            0613 03079000
*   IF DCBBLKSI=0                   /* IF NO BLOCKSIZE,      @OZ05099*/ 03080000
*     THEN                          /*                       @Y30LB14*/ 03081000
@RF00612 L     @15,DCBPTR(,R4)                                     0614 03082000
         LA    @05,52                                              0614 03083000
         ALR   @05,@15                                             0614 03084000
         LH    @01,DCBBLKSI(,@05)                                  0614 03085000
         LTR   @01,@01                                             0614 03086000
         BNZ   @RF00614                                            0614 03087000
*     DCBBLKSI=DCBLRECL;            /* DEFAULT TO LRECL      @OZ05099*/ 03088000
         MVC   DCBBLKSI(2,@05),DCBLRECL+72(@15)                    0615 03089000
*   ELSE                                                           0616 03090000
*     ;                             /*                       @Y30LB14*/ 03091000
@RF00614 DS    0H                                                  0617 03092000
*   LEFTOVER=DCBBLKSI//DCBLRECL;    /* IF BLKSIZE NOT        @Y30LB14*/ 03093000
         L     @15,DCBPTR(,R4)                                     0617 03094000
         LA    @05,52                                              0617 03095000
         ALR   @05,@15                                             0617 03096000
         LH    @15,DCBLRECL+72(,@15)                               0617 03097000
         LH    LEFTOVER,DCBBLKSI(,@05)                             0617 03098000
         SRDA  LEFTOVER,32                                         0617 03099000
         DR    LEFTOVER,@15                                        0617 03100000
*   IF LEFTOVER^=0                  /* MULTIPLE OF LRECL     @Y30LB14*/ 03101000
*     THEN                          /*                       @Y30LB14*/ 03102000
         LTR   LEFTOVER,LEFTOVER                                   0618 03103000
         BZ    @RF00618                                            0618 03104000
*     DCBBLKSI=DCBLRECL;            /* SET BLKSIZE TO LRECL  @OZ05099*/ 03105000
         STH   @15,DCBBLKSI(,@05)                                  0619 03106000
*   ELSE                                                           0620 03107000
*     ;                             /*                       @Y30LB14*/ 03108000
@RF00618 DS    0H                                                  0621 03109000
*   DCBRECFM='90'X;                 /* SET RECFM TO FB       @Y30LB14*/ 03110000
         L     @01,DCBPTR(,R4)                                     0621 03111000
         MVI   DCBRECFM+28(@01),X'90'                              0621 03112000
*   R14=SAVE14;                     /* RESTORE REG 14        @Y30LB14*/ 03113000
         L     R14,SAVE14(,R4)                                     0622 03114000
*   GEN(BR    14);                  /* RETURN TO OPEN        @Y30LB14*/ 03115000
         BR    14                                                       03116000
*                                                                  0624 03117000
*/********************************************************** @Y30LB14*/ 03118000
*/*                                                          @YD00113*/ 03119000
*/* PROCEDURE NAME - MAINLINE (PUNCHERR)                     @YD00113*/ 03120000
*/*                                                          @YD00113*/ 03121000
*/* FUNCTION - THIS ROUTINE IS CALLED BY IOS IF A PERMANENT  @YD00113*/ 03122000
*/*            ERROR IS DETECTED WHILE PUNCHING THE SYSGEN   @YD00113*/ 03123000
*/*            STATEMENTS.  A STANDARD SYNAD MESSAGE IS      @YD00113*/ 03124000
*/*            PRINTED AND RETURN IS MADE TO IOS.            @YD00113*/ 03125000
*/*                                                          @YD00113*/ 03126000
*/********************************************************** @Y30LB14*/ 03127000
*                                                                  0624 03128000
*PUNCHERR:                                                         0624 03129000
*   ;                               /*                       @Y30LB14*/ 03130000
PUNCHERR DS    0H                                                  0625 03131000
*   GEN(SYNADAF ACSMETH=QSAM);      /*                       @Y30LB14*/ 03132000
         SYNADAF ACSMETH=QSAM                                           03133000
*   GEN(MVC   OUTBUF2+30(79,R4),49(1));/*                    @YM32166*/ 03134000
         MVC   OUTBUF2+30(79,R4),49(1)                                  03135000
*   OUTBUF2(1:30)=ICGDS403;         /*                       @YM32166*/ 03136000
         MVC   OUTBUF2(30,R4),ICGDS403                             0627 03137000
*   PRNTBUF2='1'B;                  /*                       @Y30LB14*/ 03138000
         OI    PRNTBUF2(R4),B'00000001'                            0628 03139000
*   GEN(LINK  EP=ICGDSMSG);         /* PRINT SYNAD MSG       @Y30LB14*/ 03140000
         LINK  EP=ICGDSMSG                                              03141000
*   GEN(SYNADRLS);                  /*                       @Y30LB14*/ 03142000
         SYNADRLS                                                       03143000
*   RETCODE=16;                     /* RETURN CODE TO 16     @Y30LB14*/ 03144000
         MVC   RETCODE(2,R4),@CH00164                              0631 03145000
*   TERMINAT=TERMINAT+1;            /* BUMP TERM COUNT       @Y30LB14*/ 03146000
         LA    @15,1                                               0632 03147000
         AH    @15,TERMINAT(,R4)                                   0632 03148000
         STH   @15,TERMINAT(,R4)                                   0632 03149000
*   GEN(BR    R14);                 /* RETURN TO IOS         @Y30LB14*/ 03150000
         BR    R14                                                      03151000
*                                                                  0634 03152000
*/********************************************************** @YD00113*/ 03153000
*/* GENERATED STATEMENTS DESCRIBING THE ASSEMBLER PATCH AREA @YD00113*/ 03154000
*/* AND THE MODEL DCB FOR SYSPUNCH.                          @YD00113*/ 03155000
*/********************************************************** @YD00113*/ 03156000
*                                                                  0634 03157000
*   GENERATE;                                                      0634 03158000
*                                                         /*@Y30LB14*/  03159000
PATCHB19 DC    32C'PATCHB19'                              /*@Y30LB14*/  03160000
MYDCB2   DCB   DDNAME=SYSPUNCH,DSORG=PS,MACRF=PM,                     **03161000
               EXLST=DCBROUT2,EROPT=ACC,SYNAD=PUNCHERR                  03162000
*   END ICGDSB19                    /*                       @Y30LB14*/ 03163000
*                                                                  0635 03164000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 03165000
*/*%INCLUDE SYSLIB  (ICGDSMAC)                                       */ 03166000
*/*%INCLUDE SYSLIB  (IHADCBDF)                                       */ 03167000
*/*%INCLUDE SYSLIB  (IHADCB  )                                       */ 03168000
*                                                                  0635 03169000
*       ;                                                          0635 03170000
         B     @EL00001                                            0635 03171000
@DATA    DS    0H                                                       03172000
@CH00053 DC    H'2'                                                     03173000
@CH00071 DC    H'4'                                                     03174000
@CH00229 DC    H'6'                                                     03175000
@CH00115 DC    H'9'                                                     03176000
@CH00034 DC    H'11'                                                    03177000
@CH00164 DC    H'16'                                                    03178000
@CH00246 DC    H'48'                                                    03179000
@CH00768 DC    H'62'                                                    03180000
@CH00256 DC    H'64'                                                    03181000
@CH00282 DC    H'72'                                                    03182000
@CH00057 DC    H'80'                                                    03183000
@CH00810 DC    H'81'                                                    03184000
@DATD    DSECT                                                          03185000
         DS    0F                                                       03186000
@SA00001 DS    18F                                                      03187000
@SA00013 DS    15F                                                      03188000
@SA00015 DS    14F                                                      03189000
@SA00014 DS    14F                                                      03190000
@SA00006 DS    14F                                                      03191000
@SA00011 DS    14F                                                      03192000
@SA00016 DS    15F                                                      03193000
@SA00002 DS    15F                                                      03194000
@SA00005 DS    14F                                                      03195000
@SA00007 DS    15F                                                      03196000
@TF00001 DS    F                                                        03197000
@TF00002 DS    F                                                        03198000
@ZTEMPS  DS    0F                                                       03199000
@ZT00001 DC    F'0'                                                     03200000
@ZT00002 DC    F'0'                                                     03201000
@ZTEMPND EQU   *                                                        03202000
@ZLEN    EQU   @ZTEMPND-@ZTEMPS                                         03203000
ICGDSB19 CSECT                                                          03204000
         DS    0F                                                       03205000
@CF00045 DC    F'1'                                                     03206000
@CH00045 EQU   @CF00045+2                                               03207000
@CF00051 DC    F'3'                                                     03208000
@CH00051 EQU   @CF00051+2                                               03209000
@CF00122 DC    F'5'                                                     03210000
@CF00043 DC    F'8'                                                     03211000
@CH00043 EQU   @CF00043+2                                               03212000
@CF00033 DC    F'10'                                                    03213000
@CH00033 EQU   @CF00033+2                                               03214000
@CF00066 DC    F'15'                                                    03215000
@CF00829 DC    F'-251'                                                  03216000
@CF00837 DC    F'-250'                                                  03217000
@CF00839 DC    F'-249'                                                  03218000
@CF00840 DC    F'-247'                                                  03219000
@CF00841 DC    F'-246'                                                  03220000
@CF00842 DC    F'-244'                                                  03221000
@CF00843 DC    F'-243'                                                  03222000
@CF00844 DC    F'-241'                                                  03223000
@CF00831 DC    F'-240'                                                  03224000
@DATD    DSECT                                                          03225000
         DS    0D                                                       03226000
I1       DS    F                                                        03227000
I3       DS    F                                                        03228000
K        DS    F                                                        03229000
CNT      DS    F                                                        03230000
OLDJ     DS    F                                                        03231000
OLDI     DS    H                                                        03232000
SEQNUM   DS    H                                                        03233000
SWIOD    DS    FL1                                                      03234000
         ORG   SWIOD                                                    03235000
IODSW    DS    BL1                                                      03236000
FS       EQU   SWIOD+0                                                  03237000
NOPTCHAN EQU   SWIOD+0                                                  03238000
OVRFLW   EQU   SWIOD+0                                                  03239000
SETSEQ   EQU   SWIOD+0                                                  03240000
@NM00050 EQU   SWIOD+0                                                  03241000
         ORG   SWIOD+1                                                  03242000
FLAG     DS    FL1                                                      03243000
@TS00001 DS    CL39                                                     03244000
UNPACKED DS    CL11                                                     03245000
PACKED   DS    CL6                                                      03246000
UNITIOD  DS    BL1                                                      03247000
         ORG   UNITIOD                                                  03248000
SORTSEQ  DS    BL1                                                      03249000
RESET    EQU   UNITIOD+0                                                03250000
@NM00049 EQU   UNITIOD+0                                                03251000
         ORG   UNITIOD+1                                                03252000
SW       DS    BL1                                                      03253000
SWJ      DS    BL1                                                      03254000
         ORG   SWJ                                                      03255000
MATCH    DS    BL1                                                      03256000
UCOMP    EQU   SWJ+0                                                    03257000
LOCALJES EQU   SWJ+0                                                    03258000
SW1      EQU   SWJ+0                                                    03259000
         ORG   SWJ+1                                                    03260000
CURRSG   DS    CL2                                                      03261000
         ORG   CURRSG                                                   03262000
HCURRSG  DS    CL1                                                      03263000
LCURRSG  DS    CL1                                                      03264000
         ORG   CURRSG+2                                                 03265000
CUD      DS    CL3                                                      03266000
         ORG   CUD                                                      03267000
CHANNEL  DS    CL1                                                      03268000
UNIT     DS    CL1                                                      03269000
DEVICE   DS    CL1                                                      03270000
         ORG   CUD+3                                                    03271000
SAVE1    DS    BL1                                                      03272000
SAVE2    DS    BL1                                                      03273000
CH       DS    3F                                                       03274000
WRKCH    DS    3F                                                       03275000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                03276000
@ENDDATD EQU   *                                                        03277000
ICGDSB19 CSECT                                                          03278000
         DS    0F                                                       03279000
@SIZDATD DC    AL1(0)                                                   03280000
         DC    AL3(@ENDDATD-@DATD)                                      03281000
         DS    0D                                                       03282000
ICG402I  DC    H'402'                                                   03283000
@CC00796 DC    C'I        IODEVICE ADDRESS=(   ,  ),UNIT=3330'          03284000
@CC00754 DC    C'J        UNITNAME NAME=SDG'                            03285000
@CC00757 DC    C'U        UNITNAME NAME=SDG'                            03286000
@CC00802 DC    C',FEATURE=(SHARED)'                                     03287000
@CC00790 DC    C'FEATURE=(SHARED)'                                      03288000
@CC00729 DC    C',OPTCHAN=('                                            03289000
@CC00804 DC    C',MODEL=11'                                             03290000
@CC00763 DC    C',UNIT=(('                                              03291000
@CC00732 DC    C', , )'                                                 03292000
@CC00734 DC    C', )'                                                   03293000
@CC00748 DC    C'))'                                                    03294000
@CC00769 DC    C',('                                                    03295000
@CB00778 DC    X'0000000000000000'                                      03296000
ICGDS403 DC    CL30' ICG403I I/O ERROR ON SYSPUNCH'                     03297000
TABLE    DC    X'F0'                                                    03298000
         DC    X'F1'                                                    03299000
         DC    X'F2'                                                    03300000
         DC    X'F3'                                                    03301000
         DC    X'F4'                                                    03302000
         DC    X'F5'                                                    03303000
         DC    X'F6'                                                    03304000
         DC    X'F7'                                                    03305000
         DC    X'F8'                                                    03306000
         DC    X'F9'                                                    03307000
         DC    X'C1'                                                    03308000
         DC    X'C2'                                                    03309000
         DC    X'C3'                                                    03310000
         DC    X'C4'                                                    03311000
         DC    X'C5'                                                    03312000
         DC    X'C6'                                                    03313000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       03314000
@01      EQU   01                                                       03315000
@02      EQU   02                                                       03316000
@03      EQU   03                                                       03317000
@04      EQU   04                                                       03318000
@05      EQU   05                                                       03319000
@06      EQU   06                                                       03320000
@07      EQU   07                                                       03321000
@08      EQU   08                                                       03322000
@09      EQU   09                                                       03323000
@10      EQU   10                                                       03324000
@11      EQU   11                                                       03325000
@12      EQU   12                                                       03326000
@13      EQU   13                                                       03327000
@14      EQU   14                                                       03328000
@15      EQU   15                                                       03329000
UD       EQU   @05                                                      03330000
BYT      EQU   @06                                                      03331000
LEFTOVER EQU   @02                                                      03332000
N        EQU   @05                                                      03333000
SAV      EQU   @02                                                      03334000
L        EQU   @06                                                      03335000
J        EQU   @03                                                      03336000
I        EQU   @02                                                      03337000
I2       EQU   @06                                                      03338000
R4       EQU   @04                                                      03339000
R0       EQU   @00                                                      03340000
R14      EQU   @14                                                      03341000
R1       EQU   @01                                                      03342000
COMTAB   EQU   0                                                        03343000
READER   EQU   COMTAB+256                                               03344000
READDCB  EQU   READER                                                   03345000
READFLAG EQU   READER+96                                                03346000
LASTPARM EQU   READFLAG                                                 03347000
PCHBF    EQU   READER+99                                                03348000
INBUF    EQU   READER+100                                               03349000
STARTCOL EQU   READER+180                                               03350000
NEXTCOL  EQU   READER+184                                               03351000
PRINTER  EQU   COMTAB+464                                               03352000
OUTBUF2  EQU   PRINTER+225                                              03353000
MESSAGES EQU   COMTAB+810                                               03354000
RETCODE  EQU   MESSAGES                                                 03355000
MSGNO    EQU   MESSAGES+2                                               03356000
WARNING  EQU   MESSAGES+4                                               03357000
TERMINAT EQU   MESSAGES+6                                               03358000
SPECLMSG EQU   MESSAGES+18                                              03359000
PRNTCARD EQU   SPECLMSG                                                 03360000
PRNTBUF2 EQU   SPECLMSG                                                 03361000
GENIO    EQU   COMTAB+832                                               03362000
OPENLIST EQU   GENIO                                                    03363000
DCBPTR   EQU   GENIO+4                                                  03364000
EXLST    EQU   GENIO+8                                                  03365000
SAVE14   EQU   GENIO+12                                                 03366000
COMPTR2  EQU   GENIO+16                                                 03367000
INVOKED  EQU   COMTAB+856                                               03368000
SAVEDDS  EQU   INVOKED+4                                                03369000
SVSYSPCH EQU   SAVEDDS+8                                                03370000
BUILDRSG EQU   COMTAB+900                                               03371000
RSGS     EQU   BUILDRSG                                                 03372000
RSG      EQU   RSGS                                                     03373000
RSGABOX  EQU   RSG                                                      03374000
RSGTODS  EQU   RSG+7                                                    03375000
TODS1    EQU   RSGTODS                                                  03376000
TODS2    EQU   RSGTODS+1                                                03377000
LIBRARY  EQU   COMTAB+1170                                              03378000
LIBS     EQU   LIBRARY                                                  03379000
LIB      EQU   LIBS                                                     03380000
LIBBITS  EQU   LIB                                                      03381000
PABTABLE EQU   COMTAB+1218                                              03382000
PABDEV   EQU   PABTABLE                                                 03383000
PABFLAGS EQU   PABDEV                                                   03384000
PABIBERG EQU   PABFLAGS                                                 03385000
PABREAL  EQU   PABDEV+1                                                 03386000
PABAADDD EQU   PABDEV+2                                                 03387000
DSPAIRS  EQU   COMTAB+1938                                              03388000
PHYSTYPE EQU   COMTAB+2002                                              03389000
PHYSFLGS EQU   PHYSTYPE                                                 03390000
MERLICEB EQU   PHYSFLGS                                                 03391000
CPUASSOC EQU   COMTAB+3026                                              03392000
CPUS     EQU   CPUASSOC+2                                               03393000
CPU      EQU   CPUS                                                     03394000
CPUFLAG1 EQU   CPU+6                                                    03395000
OPSYSTYP EQU   CPUFLAG1                                                 03396000
OPJES3   EQU   OPSYSTYP                                                 03397000
CPUFLAG2 EQU   CPU+7                                                    03398000
LOWERCON EQU   COMTAB+3156                                              03399000
LOWDSS   EQU   LOWERCON                                                 03400000
LOWFLGS  EQU   LOWDSS                                                   03401000
LIBCTL   EQU   COMTAB+3284                                              03402000
LIBCTLS  EQU   LIBCTL                                                   03403000
CREATE   EQU   COMTAB+3288                                              03404000
@NM00017 EQU   CREATE                                                   03405000
BINTIND  EQU   @NM00017                                                 03406000
COMTAB2  EQU   0                                                        03407000
DSTORSG  EQU   COMTAB2                                                  03408000
DSENTRY  EQU   DSTORSG                                                  03409000
CONFGCON EQU   COMTAB2+32                                               03410000
RSGUCB   EQU   CONFGCON                                                 03411000
RSGFLAGS EQU   RSGUCB                                                   03412000
CISPEC   EQU   RSGFLAGS                                                 03413000
RSGCPUID EQU   RSGUCB+1                                                 03414000
CPUREFNO EQU   RSGUCB+6                                                 03415000
RSGCHAN  EQU   RSGUCB+7                                                 03416000
RSGCUA   EQU   RSGUCB+8                                                 03417000
CONFGUCB EQU   COMTAB2+464                                              03418000
CONFGDEV EQU   CONFGUCB                                                 03419000
USEFLAGS EQU   CONFGDEV                                                 03420000
USESPEC  EQU   USEFLAGS                                                 03421000
USEV     EQU   USEFLAGS                                                 03422000
USEVS    EQU   USEFLAGS                                                 03423000
USEREAL  EQU   USEFLAGS                                                 03424000
SUPPUNCH EQU   USEFLAGS                                                 03425000
USECONVR EQU   USEFLAGS                                                 03426000
ITISALTP EQU   USEFLAGS                                                 03427000
ICEBERG  EQU   USEFLAGS                                                 03428000
INDEXRSG EQU   CONFGDEV+1                                               03429000
ALTPATH1 EQU   CONFGDEV+2                                               03430000
ALTCH1   EQU   ALTPATH1+2                                               03431000
ALTPATH2 EQU   CONFGDEV+5                                               03432000
ALTCH2   EQU   ALTPATH2+2                                               03433000
ALTPATH3 EQU   CONFGDEV+8                                               03434000
ALTCH3   EQU   ALTPATH3+2                                               03435000
IHADCB   EQU   0                                                        03436000
IHADCS05 EQU   0                                                        03437000
DCBMODE  EQU   IHADCS05                                                 03438000
DCBSTACK EQU   DCBMODE                                                  03439000
DCBFUNC  EQU   IHADCS05+3                                               03440000
IHADCS11 EQU   0                                                        03441000
DCBRELB  EQU   IHADCS11                                                 03442000
DCBREL   EQU   DCBRELB+1                                                03443000
DCBBUFCB EQU   IHADCS11+4                                               03444000
DCBDSORG EQU   IHADCS11+10                                              03445000
DCBDSRG1 EQU   DCBDSORG                                                 03446000
DCBDSRG2 EQU   DCBDSORG+1                                               03447000
DCBIOBAD EQU   IHADCS11+12                                              03448000
DCBODEB  EQU   DCBIOBAD                                                 03449000
DCBLNP   EQU   DCBODEB                                                  03450000
DCBQSLM  EQU   DCBLNP                                                   03451000
DCBIOBAA EQU   DCBODEB+1                                                03452000
IHADCS50 EQU   0                                                        03453000
DCBSVCXL EQU   IHADCS50                                                 03454000
DCBEODAD EQU   IHADCS50+4                                               03455000
DCBBFALN EQU   DCBEODAD                                                 03456000
DCBHIARC EQU   DCBBFALN                                                 03457000
DCBBFTEK EQU   DCBHIARC                                                 03458000
DCBBFT   EQU   DCBBFTEK                                                 03459000
DCBEXLST EQU   IHADCS50+8                                               03460000
DCBRECFM EQU   DCBEXLST                                                 03461000
DCBRECLA EQU   DCBRECFM                                                 03462000
IHADCS24 EQU   0                                                        03463000
DCBOFLGS EQU   IHADCS24+8                                               03464000
DCBOFLWR EQU   DCBOFLGS                                                 03465000
DCBOFOPN EQU   DCBOFLGS                                                 03466000
DCBIFLG  EQU   IHADCS24+9                                               03467000
DCBIBPCT EQU   DCBIFLG                                                  03468000
DCBMACR  EQU   IHADCS24+10                                              03469000
DCBMACR1 EQU   DCBMACR                                                  03470000
DCBMRFE  EQU   DCBMACR1                                                 03471000
DCBMRGET EQU   DCBMRFE                                                  03472000
DCBMRAPG EQU   DCBMACR1                                                 03473000
DCBMRRD  EQU   DCBMRAPG                                                 03474000
DCBMRCI  EQU   DCBMACR1                                                 03475000
DCBMRMVG EQU   DCBMRCI                                                  03476000
DCBMRLCG EQU   DCBMACR1                                                 03477000
DCBMRABC EQU   DCBMACR1                                                 03478000
DCBMRPT1 EQU   DCBMRABC                                                 03479000
DCBMRSBG EQU   DCBMRPT1                                                 03480000
DCBMRCRL EQU   DCBMACR1                                                 03481000
DCBMRCHK EQU   DCBMRCRL                                                 03482000
DCBMRRDX EQU   DCBMRCHK                                                 03483000
DCBMRDMG EQU   DCBMACR1                                                 03484000
DCBMACR2 EQU   DCBMACR+1                                                03485000
DCBMRPUT EQU   DCBMACR2                                                 03486000
DCBMRWRT EQU   DCBMACR2                                                 03487000
DCBMRMVP EQU   DCBMACR2                                                 03488000
DCBMR5WD EQU   DCBMACR2                                                 03489000
DCBMRLDM EQU   DCBMR5WD                                                 03490000
DCBMRLCP EQU   DCBMRLDM                                                 03491000
DCBMR4WD EQU   DCBMACR2                                                 03492000
DCBMRPT2 EQU   DCBMR4WD                                                 03493000
DCBMRTMD EQU   DCBMRPT2                                                 03494000
DCBMR3WD EQU   DCBMACR2                                                 03495000
DCBMRCTL EQU   DCBMR3WD                                                 03496000
DCBMRSTK EQU   DCBMRCTL                                                 03497000
DCBMR1WD EQU   DCBMACR2                                                 03498000
DCBMRSWA EQU   DCBMR1WD                                                 03499000
DCBMRDMD EQU   DCBMRSWA                                                 03500000
IHADCS25 EQU   0                                                        03501000
DCBMACRF EQU   IHADCS25+2                                               03502000
DCBMACF1 EQU   DCBMACRF                                                 03503000
DCBMFFE  EQU   DCBMACF1                                                 03504000
DCBMFGET EQU   DCBMFFE                                                  03505000
DCBMFAPG EQU   DCBMACF1                                                 03506000
DCBMFRD  EQU   DCBMFAPG                                                 03507000
DCBMFCI  EQU   DCBMACF1                                                 03508000
DCBMFMVG EQU   DCBMFCI                                                  03509000
DCBMFLCG EQU   DCBMACF1                                                 03510000
DCBMFABC EQU   DCBMACF1                                                 03511000
DCBMFPT1 EQU   DCBMFABC                                                 03512000
DCBMFSBG EQU   DCBMFPT1                                                 03513000
DCBMFCRL EQU   DCBMACF1                                                 03514000
DCBMFCHK EQU   DCBMFCRL                                                 03515000
DCBMFDMG EQU   DCBMACF1                                                 03516000
DCBMACF2 EQU   DCBMACRF+1                                               03517000
DCBMFPUT EQU   DCBMACF2                                                 03518000
DCBMFWRT EQU   DCBMACF2                                                 03519000
DCBMFMVP EQU   DCBMACF2                                                 03520000
DCBMF5WD EQU   DCBMACF2                                                 03521000
DCBMFLDM EQU   DCBMF5WD                                                 03522000
DCBMFLCP EQU   DCBMFLDM                                                 03523000
DCBMF4WD EQU   DCBMACF2                                                 03524000
DCBMFPT2 EQU   DCBMF4WD                                                 03525000
DCBMFTMD EQU   DCBMFPT2                                                 03526000
DCBMF3WD EQU   DCBMACF2                                                 03527000
DCBMFCTL EQU   DCBMF3WD                                                 03528000
DCBMFSTK EQU   DCBMFCTL                                                 03529000
DCBMF1WD EQU   DCBMACF2                                                 03530000
DCBMFSWA EQU   DCBMF1WD                                                 03531000
DCBMFDMD EQU   DCBMFSWA                                                 03532000
DCBDEBAD EQU   IHADCS25+4                                               03533000
DCBIFLGS EQU   DCBDEBAD                                                 03534000
DCBIFPCT EQU   DCBIFLGS                                                 03535000
IHADCS26 EQU   0                                                        03536000
DCBWRITE EQU   IHADCS26                                                 03537000
DCBREAD  EQU   DCBWRITE                                                 03538000
DCBWRITA EQU   DCBREAD+1                                                03539000
IHADCS27 EQU   0                                                        03540000
DCBGET   EQU   IHADCS27                                                 03541000
DCBPUT   EQU   DCBGET                                                   03542000
DCBGETA  EQU   DCBPUT+1                                                 03543000
IHADCS36 EQU   0                                                        03544000
DCBGERR  EQU   IHADCS36                                                 03545000
DCBPERR  EQU   DCBGERR                                                  03546000
DCBCHECK EQU   DCBPERR                                                  03547000
DCBOPTCD EQU   DCBCHECK                                                 03548000
DCBOPTH  EQU   DCBOPTCD                                                 03549000
DCBOPTO  EQU   DCBOPTH                                                  03550000
DCBOPTZ  EQU   DCBOPTCD                                                 03551000
DCBGERRA EQU   DCBCHECK+1                                               03552000
DCBPERRA EQU   DCBGERRA                                                 03553000
DCBSYNAD EQU   IHADCS36+4                                               03554000
DCBCIND1 EQU   IHADCS36+8                                               03555000
DCBCIND2 EQU   IHADCS36+9                                               03556000
DCBBLKSI EQU   IHADCS36+10                                              03557000
DCBIOBA  EQU   IHADCS36+16                                              03558000
DCBCICB  EQU   DCBIOBA                                                  03559000
IHADCS52 EQU   0                                                        03560000
DCBDIRCT EQU   IHADCS52                                                 03561000
DCBQSWS  EQU   DCBDIRCT                                                 03562000
DCBUSASI EQU   DCBQSWS                                                  03563000
DCBQADFS EQU   DCBUSASI                                                 03564000
DCBBUFOF EQU   DCBDIRCT+1                                               03565000
IHADCS37 EQU   0                                                        03566000
DCBFLAG1 EQU   IHADCS37                                                 03567000
IHADCS38 EQU   0                                                        03568000
DCBEOBR  EQU   IHADCS38                                                 03569000
DCBLRECL EQU   IHADCS38+10                                              03570000
DCBPOINT EQU   IHADCS38+12                                              03571000
DCBCNTRL EQU   DCBPOINT                                                 03572000
IHADCS40 EQU   0                                                        03573000
DCBEOBAD EQU   IHADCS40                                                 03574000
DCBCCCW  EQU   IHADCS40+4                                               03575000
DCBRECAD EQU   DCBCCCW                                                  03576000
DCBRECBT EQU   DCBRECAD                                                 03577000
DCBRCREL EQU   DCBRECBT                                                 03578000
@NM00045 EQU   IHADCS40+12                                              03579000
DCBEROPT EQU   @NM00045                                                 03580000
MYDCB2A  EQU   0                                                        03581000
SCANBUF  EQU   0                                                        03582000
SCANDATA EQU   0                                                        03583000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    03584000
DCBEOB   EQU   IHADCS40+20                                              03585000
DCBPRECL EQU   IHADCS40+18                                              03586000
@NM00048 EQU   IHADCS40+16                                              03587000
@NM00047 EQU   @NM00045+1                                               03588000
@NM00046 EQU   DCBEROPT                                                 03589000
DCBERABE EQU   DCBEROPT                                                 03590000
DCBERSKP EQU   DCBEROPT                                                 03591000
DCBERACC EQU   DCBEROPT                                                 03592000
@NM00044 EQU   IHADCS40+10                                              03593000
@NM00043 EQU   IHADCS40+9                                               03594000
@NM00042 EQU   IHADCS40+8                                               03595000
DCBRECA  EQU   DCBRECAD+1                                               03596000
@NM00041 EQU   DCBRECBT                                                 03597000
DCBRCFGT EQU   DCBRCREL                                                 03598000
DCBRCTRU EQU   DCBRCREL                                                 03599000
DCBLCCW  EQU   DCBEOBAD                                                 03600000
DCBNOTE  EQU   DCBCNTRL                                                 03601000
@NM00040 EQU   IHADCS38+8                                               03602000
DCBEOBW  EQU   IHADCS38+4                                               03603000
DCBEOBRA EQU   DCBEOBR+1                                                03604000
DCBNCP   EQU   DCBEOBR                                                  03605000
@NM00039 EQU   DCBFLAG1                                                 03606000
DCBSTFLS EQU   DCBFLAG1                                                 03607000
DCBSTQCK EQU   DCBFLAG1                                                 03608000
DCBDIRCQ EQU   DCBBUFOF                                                 03609000
DCBQSTRU EQU   DCBUSASI                                                 03610000
@NM00038 EQU   DCBUSASI                                                 03611000
DCBQADF3 EQU   DCBQADFS                                                 03612000
DCBQADF2 EQU   DCBQADFS                                                 03613000
DCBQADF1 EQU   DCBQADFS                                                 03614000
DCBBLBP  EQU   DCBUSASI                                                 03615000
@NM00037 EQU   DCBUSASI                                                 03616000
DCBCICBA EQU   DCBCICB+1                                                03617000
@NM00036 EQU   DCBCICB                                                  03618000
DCBOFFSW EQU   IHADCS36+15                                              03619000
DCBOFFSR EQU   IHADCS36+14                                              03620000
DCBWCPL  EQU   IHADCS36+13                                              03621000
DCBWCPO  EQU   IHADCS36+12                                              03622000
DCBCNQSM EQU   DCBCIND2                                                 03623000
DCBCNFEO EQU   DCBCIND2                                                 03624000
DCBCNCHS EQU   DCBCIND2                                                 03625000
DCBCNBFP EQU   DCBCIND2                                                 03626000
DCBCNIOE EQU   DCBCIND2                                                 03627000
DCBCNCLO EQU   DCBCIND2                                                 03628000
DCBCNWRO EQU   DCBCIND2                                                 03629000
DCBCNSTO EQU   DCBCIND2                                                 03630000
DCBCNEXB EQU   DCBCIND1                                                 03631000
@NM00035 EQU   DCBCIND1                                                 03632000
DCBCNBRM EQU   DCBCIND1                                                 03633000
@NM00034 EQU   DCBCIND1                                                 03634000
DCBCNEVA EQU   DCBCIND1                                                 03635000
DCBCNEVB EQU   DCBCIND1                                                 03636000
DCBCNSRD EQU   DCBCIND1                                                 03637000
DCBCNTOV EQU   DCBCIND1                                                 03638000
DCBSYNA  EQU   DCBSYNAD+1                                               03639000
DCBIOBL  EQU   DCBSYNAD                                                 03640000
DCBCHCKA EQU   DCBPERRA                                                 03641000
DCBOPTJ  EQU   DCBOPTCD                                                 03642000
DCBOPTT  EQU   DCBOPTCD                                                 03643000
DCBSRCHD EQU   DCBOPTZ                                                  03644000
DCBOPTQ  EQU   DCBOPTCD                                                 03645000
DCBBCKPT EQU   DCBOPTO                                                  03646000
DCBOPTC  EQU   DCBOPTCD                                                 03647000
DCBOPTU  EQU   DCBOPTCD                                                 03648000
DCBOPTW  EQU   DCBOPTCD                                                 03649000
DCBPUTA  EQU   DCBGETA                                                  03650000
@NM00033 EQU   DCBPUT                                                   03651000
DCBREADA EQU   DCBWRITA                                                 03652000
@NM00032 EQU   DCBREAD                                                  03653000
DCBDEBA  EQU   DCBDEBAD+1                                               03654000
@NM00031 EQU   DCBIFLGS                                                 03655000
DCBIFIOE EQU   DCBIFLGS                                                 03656000
DCBCH12  EQU   DCBIFPCT                                                 03657000
DCBCH9   EQU   DCBIFPCT                                                 03658000
DCBIFEC  EQU   DCBIFLGS                                                 03659000
DCBMFSTI EQU   DCBMFDMD                                                 03660000
DCBMFAWR EQU   DCBMFSTK                                                 03661000
DCBMFUIP EQU   DCBMFTMD                                                 03662000
DCBMFIDW EQU   DCBMFLCP                                                 03663000
DCBMFWRK EQU   DCBMFMVP                                                 03664000
DCBMFRDQ EQU   DCBMFWRT                                                 03665000
DCBMFGTQ EQU   DCBMFPUT                                                 03666000
DCBMFSTL EQU   DCBMACF2                                                 03667000
DCBMFCK  EQU   DCBMFDMG                                                 03668000
DCBMFRDX EQU   DCBMFCHK                                                 03669000
DCBMFDBF EQU   DCBMFSBG                                                 03670000
DCBMFRDI EQU   DCBMFLCG                                                 03671000
DCBMFRDK EQU   DCBMFMVG                                                 03672000
DCBMFWRQ EQU   DCBMFRD                                                  03673000
DCBMFPTQ EQU   DCBMFGET                                                 03674000
DCBMFECP EQU   DCBMACF1                                                 03675000
DCBTIOT  EQU   IHADCS25                                                 03676000
DCBMRSTI EQU   DCBMRDMD                                                 03677000
DCBMRAWR EQU   DCBMRSTK                                                 03678000
DCBMRUIP EQU   DCBMRTMD                                                 03679000
DCBMRIDW EQU   DCBMRLCP                                                 03680000
DCBMRWRK EQU   DCBMRMVP                                                 03681000
DCBMRRDQ EQU   DCBMRWRT                                                 03682000
DCBMRGTQ EQU   DCBMRPUT                                                 03683000
DCBMRSTL EQU   DCBMACR2                                                 03684000
DCBMRCK  EQU   DCBMRDMG                                                 03685000
DCBPGFXA EQU   DCBMRRDX                                                 03686000
DCBMRDBF EQU   DCBMRSBG                                                 03687000
DCBMRRDI EQU   DCBMRLCG                                                 03688000
DCBMRRDK EQU   DCBMRMVG                                                 03689000
DCBMRWRQ EQU   DCBMRRD                                                  03690000
DCBMRPTQ EQU   DCBMRGET                                                 03691000
DCBMRECP EQU   DCBMACR1                                                 03692000
@NM00030 EQU   DCBIFLG                                                  03693000
DCBIBIOE EQU   DCBIFLG                                                  03694000
DCBICH12 EQU   DCBIBPCT                                                 03695000
DCBICH9  EQU   DCBIBPCT                                                 03696000
DCBIBEC  EQU   DCBIFLG                                                  03697000
DCBOFIOF EQU   DCBOFLGS                                                 03698000
DCBOFUEX EQU   DCBOFLGS                                                 03699000
DCBOFTM  EQU   DCBOFLGS                                                 03700000
DCBOFPPC EQU   DCBOFLGS                                                 03701000
DCBOFEOV EQU   DCBOFLGS                                                 03702000
DCBOFLRB EQU   DCBOFLGS                                                 03703000
DCBOFIOD EQU   DCBOFLWR                                                 03704000
DCBDDNAM EQU   IHADCS24                                                 03705000
DCBEXLSA EQU   DCBEXLST+1                                               03706000
DCBRECKL EQU   DCBRECFM                                                 03707000
DCBRECCC EQU   DCBRECFM                                                 03708000
DCBRECSB EQU   DCBRECFM                                                 03709000
DCBRECBR EQU   DCBRECFM                                                 03710000
DCBRECTO EQU   DCBRECLA                                                 03711000
DCBRECL  EQU   DCBRECLA                                                 03712000
DCBEODA  EQU   DCBEODAD+1                                               03713000
DCBBFA   EQU   DCBBFTEK                                                 03714000
DCBH0    EQU   DCBBFTEK                                                 03715000
DCBBFTKD EQU   DCBBFTEK                                                 03716000
DCBBFTE  EQU   DCBBFT                                                   03717000
DCBBFTKR EQU   DCBBFT                                                   03718000
DCBBFTS  EQU   DCBBFT                                                   03719000
DCBH1    EQU   DCBBFTEK                                                 03720000
DCBSVCXA EQU   DCBSVCXL+1                                               03721000
@NM00029 EQU   DCBSVCXL                                                 03722000
DCBODEBA EQU   DCBIOBAA                                                 03723000
@NM00028 EQU   DCBQSLM                                                  03724000
DCBUPDBT EQU   DCBQSLM                                                  03725000
DCBUPDCM EQU   DCBQSLM                                                  03726000
DCB1DVDS EQU   DCBQSLM                                                  03727000
@NM00027 EQU   DCBDSRG2                                                 03728000
DCBDSGTR EQU   DCBDSRG2                                                 03729000
DCBACBM  EQU   DCBDSRG2                                                 03730000
@NM00026 EQU   DCBDSRG2                                                 03731000
DCBDSGTQ EQU   DCBDSRG2                                                 03732000
DCBDSGTX EQU   DCBDSRG2                                                 03733000
DCBDSGGS EQU   DCBDSRG2                                                 03734000
DCBDSGU  EQU   DCBDSRG1                                                 03735000
DCBDSGPO EQU   DCBDSRG1                                                 03736000
@NM00025 EQU   DCBDSRG1                                                 03737000
@NM00024 EQU   DCBDSRG1                                                 03738000
DCBDSGCX EQU   DCBDSRG1                                                 03739000
DCBDSGDA EQU   DCBDSRG1                                                 03740000
DCBDSGPS EQU   DCBDSRG1                                                 03741000
DCBDSGIS EQU   DCBDSRG1                                                 03742000
DCBBUFL  EQU   IHADCS11+8                                               03743000
DCBBUFCA EQU   DCBBUFCB+1                                               03744000
DCBBUFNO EQU   DCBBUFCB                                                 03745000
DCBDEVT  EQU   DCBREL                                                   03746000
DCBKEYLE EQU   DCBRELB                                                  03747000
@NM00023 EQU   DCBFUNC                                                  03748000
DCBFNCBT EQU   DCBFUNC                                                  03749000
DCBFNCBX EQU   DCBFUNC                                                  03750000
DCBFNCBD EQU   DCBFUNC                                                  03751000
DCBFNCBW EQU   DCBFUNC                                                  03752000
DCBFNCBP EQU   DCBFUNC                                                  03753000
DCBFNCBR EQU   DCBFUNC                                                  03754000
DCBFNCBI EQU   DCBFUNC                                                  03755000
@NM00022 EQU   IHADCS05+2                                               03756000
@NM00021 EQU   IHADCS05+1                                               03757000
DCBSTCK1 EQU   DCBSTACK                                                 03758000
DCBSTCK2 EQU   DCBSTACK                                                 03759000
@NM00020 EQU   DCBSTACK                                                 03760000
DCBMODER EQU   DCBSTACK                                                 03761000
DCBMODEO EQU   DCBSTACK                                                 03762000
DCBMODEE EQU   DCBSTACK                                                 03763000
DCBMODEC EQU   DCBSTACK                                                 03764000
@NM00019 EQU   IHADCB                                                   03765000
ALTCI3   EQU   ALTPATH3+1                                               03766000
ALTDS3   EQU   ALTPATH3                                                 03767000
ALTCI2   EQU   ALTPATH2+1                                               03768000
ALTDS2   EQU   ALTPATH2                                                 03769000
ALTCI1   EQU   ALTPATH1+1                                               03770000
ALTDS1   EQU   ALTPATH1                                                 03771000
@NM00018 EQU   RSGFLAGS                                                 03772000
TORSG2   EQU   DSENTRY+1                                                03773000
TORSG1   EQU   DSENTRY                                                  03774000
COM2BASE EQU   COMTAB+3304                                              03775000
LRUCLOCK EQU   CREATE+11                                                03776000
VOLSER   EQU   CREATE+5                                                 03777000
VPAGES   EQU   CREATE+1                                                 03778000
DINTIND  EQU   @NM00017                                                 03779000
CINTIND  EQU   @NM00017                                                 03780000
CYLFAULT EQU   @NM00017                                                 03781000
PRNTONLY EQU   @NM00017                                                 03782000
UPDCREAT EQU   @NM00017                                                 03783000
NEWCREAT EQU   @NM00017                                                 03784000
CMDCREAT EQU   @NM00017                                                 03785000
RW67RGHT EQU   LIBCTLS                                                  03786000
RW67LEFT EQU   LIBCTLS                                                  03787000
RW45RGHT EQU   LIBCTLS                                                  03788000
RW45LEFT EQU   LIBCTLS                                                  03789000
RW23RGHT EQU   LIBCTLS                                                  03790000
RW23LEFT EQU   LIBCTLS                                                  03791000
RW01RGHT EQU   LIBCTLS                                                  03792000
RW01LEFT EQU   LIBCTLS                                                  03793000
LOWLIB   EQU   LOWDSS+1                                                 03794000
@NM00016 EQU   LOWFLGS                                                  03795000
LOWRGHT  EQU   LOWFLGS                                                  03796000
LOWLEFT  EQU   LOWFLGS                                                  03797000
LOWRW67  EQU   LOWFLGS                                                  03798000
LOWRW45  EQU   LOWFLGS                                                  03799000
LOWRW23  EQU   LOWFLGS                                                  03800000
LOWRW01  EQU   LOWFLGS                                                  03801000
LOWSPEC  EQU   LOWFLGS                                                  03802000
ALTMSCIN EQU   CPUFLAG2                                                 03803000
@NM00015 EQU   CPUFLAG2                                                 03804000
ALTMSGBF EQU   CPUFLAG2                                                 03805000
@NM00014 EQU   CPUFLAG2                                                 03806000
CPUSPEC  EQU   CPUFLAG2                                                 03807000
CPUMSCIN EQU   CPUFLAG1                                                 03808000
OPVS2    EQU   OPSYSTYP                                                 03809000
OPVS1    EQU   OPSYSTYP                                                 03810000
CPUALTFL EQU   CPUFLAG1                                                 03811000
CPUTIGHT EQU   CPUFLAG1                                                 03812000
@NM00013 EQU   CPUFLAG1                                                 03813000
TOMPCPU  EQU   CPU+5                                                    03814000
CPUID    EQU   CPU                                                      03815000
CPUNUM   EQU   CPUASSOC                                                 03816000
SPNRSGNO EQU   PHYSTYPE+1                                               03817000
LGDEVICE EQU   PHYSFLGS                                                 03818000
LOGABOX1 EQU   PHYSFLGS                                                 03819000
PHYSSSID EQU   PHYSFLGS                                                 03820000
PHYSREAL EQU   PHYSFLGS                                                 03821000
PHYSDS2  EQU   DSPAIRS                                                  03822000
PABDDD   EQU   PABAADDD                                                 03823000
PABAA    EQU   PABAADDD                                                 03824000
PABZEROS EQU   PABAADDD                                                 03825000
PAB2D    EQU   PABREAL                                                  03826000
PAB2C    EQU   PABREAL                                                  03827000
PAB2B    EQU   PABREAL                                                  03828000
@NM00012 EQU   PABREAL                                                  03829000
PAB1D    EQU   PABREAL                                                  03830000
PAB1C    EQU   PABREAL                                                  03831000
PAB1B    EQU   PABREAL                                                  03832000
PABIMPLR EQU   PABREAL                                                  03833000
PABBERG2 EQU   PABFLAGS                                                 03834000
@NM00011 EQU   PABFLAGS                                                 03835000
PABDSMTL EQU   PABFLAGS                                                 03836000
@NM00010 EQU   PABFLAGS                                                 03837000
PABVOVIR EQU   PABFLAGS                                                 03838000
PABEXIST EQU   PABFLAGS                                                 03839000
MAPEXIT  EQU   LIB+4                                                    03840000
LIBMAP   EQU   LIB+3                                                    03841000
LIBDSMID EQU   LIB+2                                                    03842000
LIBSIZE  EQU   LIB+1                                                    03843000
@NM00009 EQU   LIBBITS                                                  03844000
LIBSPEC  EQU   LIBBITS                                                  03845000
RSGSLICE EQU   RSG+3                                                    03846000
RSGUDEL  EQU   RSG+2                                                    03847000
RSGLDEL  EQU   RSG+1                                                    03848000
@NM00008 EQU   RSG                                                      03849000
RSGABOX1 EQU   RSGABOX                                                  03850000
RSGABOX0 EQU   RSGABOX                                                  03851000
RSGSPEC  EQU   RSG                                                      03852000
SVSYSUT3 EQU   SAVEDDS+32                                               03853000
SVSYSUT2 EQU   SAVEDDS+24                                               03854000
SVSYSUT1 EQU   SAVEDDS+16                                               03855000
SVSYSIN  EQU   SAVEDDS                                                  03856000
PARMPTR  EQU   INVOKED                                                  03857000
BUILDPTR EQU   GENIO+20                                                 03858000
@NM00007 EQU   DCBPTR+1                                                 03859000
DCBFLAG  EQU   DCBPTR                                                   03860000
@NM00006 EQU   MESSAGES+19                                              03861000
NEEDEOJ  EQU   SPECLMSG                                                 03862000
ENDPHASE EQU   SPECLMSG                                                 03863000
@NM00005 EQU   SPECLMSG                                                 03864000
@NM00004 EQU   SPECLMSG                                                 03865000
NEED102  EQU   SPECLMSG                                                 03866000
NEED101  EQU   SPECLMSG                                                 03867000
PRINTRC  EQU   MESSAGES+16                                              03868000
TERM     EQU   MESSAGES+12                                              03869000
WARN     EQU   MESSAGES+8                                               03870000
OUTBUF   EQU   PRINTER+104                                              03871000
LINECT   EQU   PRINTER+102                                              03872000
LINECTR  EQU   PRINTER+100                                              03873000
PAGENO   EQU   PRINTER+96                                               03874000
DCBPRINT EQU   PRINTER                                                  03875000
@NM00003 EQU   READER+206                                               03876000
SCANLEN  EQU   READER+204                                               03877000
SVEODAD  EQU   READER+200                                               03878000
SVSYNAD2 EQU   READER+196                                               03879000
SAVENCOL EQU   READER+192                                               03880000
SAVESCOL EQU   READER+188                                               03881000
SSELECT  EQU   PCHBF                                                    03882000
@NM00002 EQU   READER+97                                                03883000
@NM00001 EQU   READFLAG                                                 03884000
ENDSCAN  EQU   READFLAG                                                 03885000
PARMBIT  EQU   READFLAG                                                 03886000
KEYBIT   EQU   READFLAG                                                 03887000
READTERM EQU   READFLAG                                                 03888000
PATCH    EQU   COMTAB                                                   03889000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      03890000
@RC00108 EQU   @RC00107                                                 03891000
@RC00115 EQU   @RC00114                                                 03892000
@RC00122 EQU   @RC00121                                                 03893000
@RC00337 EQU   @EL00006                                                 03894000
@RF00356 EQU   @EL00008                                                 03895000
@RC00412 EQU   @EL00011                                                 03896000
@RC00415 EQU   @EL00011                                                 03897000
@RC00422 EQU   @EL00011                                                 03898000
@RF00584 EQU   @EL00015                                                 03899000
@RF00588 EQU   @EL00015                                                 03900000
@RF00594 EQU   @EL00015                                                 03901000
@RC00123 EQU   @RC00122                                                 03902000
@RC00136 EQU   @RC00122                                                 03903000
@RC00129 EQU   @RC00122                                                 03904000
@RC00425 EQU   @RC00422                                                 03905000
@RC00130 EQU   @RC00129                                                 03906000
@ENDDATA EQU   *                                                        03907000
         END   ICGDSB19,(C'PLS1608',0701,77362)                         03908000
