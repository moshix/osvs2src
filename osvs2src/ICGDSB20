         TITLE 'ICGDSB20 MSC TABLE CREATE REPORTS                      *00001000
                        '                                               00002000
ICGDSB20 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'ICGDSB20  77.362'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @10,0                                               0001 00011000
@PSTART  LA    @11,4095(,@10)                                      0001 00012000
         USING @PSTART,@10                                         0001 00013000
         USING @PSTART+4095,@11                                    0001 00014000
         L     @00,@SIZDATD                                        0001 00015000
         GETMAIN  R,LV=(0)                                              00016000
         LR    @12,@01                                             0001 00017000
         USING @DATD,@12                                           0001 00018000
         ST    @13,@SA00001+4                                      0001 00019000
         LM    @00,@01,20(@13)                                     0001 00020000
         ST    @12,8(,@13)                                         0001 00021000
         LR    @13,@12                                             0001 00022000
         XC    @ZTEMPS(@ZLEN),@ZTEMPS                                   00023000
*                                                                  0056 00024000
*/***********************************************************#Y30LB14*/ 00025000
*/*                                                          @XD00153*/ 00026000
*/*      ICGDSB20 (MAINLINE)                                 @XD00153*/ 00027000
*/*                                                          @XD00153*/ 00028000
*/* INITIALIZE SWITCHES, AND WORK AREA TO ZERO.  ALSO INIT-  @Y30LB14*/ 00029000
*/* IALIZE CONSTANT AREAS OF THE MESSAGES.                   @Y30LB14*/ 00030000
*/* NOTE: IN THIS MODULE I, J, K ARE USED AS INDEXES INTO    @Y30LB14*/ 00031000
*/* THE STAGING ADAPTER, CONTROLLER AND DEVICE RESPECTIVELY. @Y30LB14*/ 00032000
*/***********************************************************@Y30LB14*/ 00033000
*                                                                  0056 00034000
*   WORK=0;                         /*                       @Y30LB14*/ 00035000
         MVI   WORK,X'00'                                          0056 00036000
*   SWITCH=0;                       /*                       @Y30LB14*/ 00037000
         SLR   SWITCH,SWITCH                                       0057 00038000
*   SWITCH1=0;                      /*                       @Y30LB14*/ 00039000
         SLR   SWITCH1,SWITCH1                                     0058 00040000
*   MSG1='0HOST CONNECTIONS REPORT';/*                       @Y30LB14*/ 00041000
         MVC   MSG1(24),@CC00391                                   0059 00042000
*   MSG2(1:17)='0DASD CONTROLLER '; /*                       @Y30LB14*/ 00043000
         MVC   MSG2(17),@CC00393                                   0060 00044000
*   MSG3='                            ******* STAGING ADAPTER    ****** 00045000
*     ******* STAGING ADAPTER    *******';/*                 @Y30LB14*/ 00046000
         MVC   MSG3(101),@CC00395                                  0061 00047000
*   MSG4='0    DEVICE  DEVICE   SSID     CPUID       CPUID       CPUID  00048000
*        CPUID       CPUID       CPUID';/*                   @Y30LB14*/ 00049000
         MVC   MSG4(99),@CC00402                                   0062 00050000
*   MSG5='';                        /*                       @Y30LB14*/ 00051000
         MVI   MSG5,C' '                                           0063 00052000
         MVC   MSG5+1(100),MSG5                                    0063 00053000
*   MSG5(1:18)='      PLUG    TYPE';/*                       @Y30LB14*/ 00054000
         MVC   MSG5(18),@CC00411                                   0064 00055000
*   MSG6='';                        /*                       @Y30LB14*/ 00056000
         MVI   MSG6,C' '                                           0065 00057000
         MVC   MSG6+1(98),MSG6                                     0065 00058000
*   MSG7=                                                          0066 00059000
*       '                            ******* STAGING ADAPTER    ******* 00060000
*       ;                                                          0066 00061000
         MVC   MSG7(62),@CC00413                                   0066 00062000
*   MSG8='0    DEVICE  DEVICE   SSID     CPUID       CPUID       CPUID' 00063000
*       ;                                                          0067 00064000
         MVC   MSG8(60),@CC00418                                   0067 00065000
*   MSG9(1:30)='0CONNECTIONS FOR SA   SSID 8 0';/*           @YD00152*/ 00066000
         MVC   MSG9(30),@CC00423                                   0068 00067000
*   MSG10='0CONNECTIONS REPORT';    /*                       @YD00152*/ 00068000
         MVC   MSG10(19),@CC00426                                  0069 00069000
*   MSG11=                                                         0070 00070000
*'   INTERFACE   TO CPU           , CHANNEL  , CONTROL UNIT ADDRESS   ' 00071000
*       ;                           /*                       @Y30LB14*/ 00072000
         MVC   MSG11(68),@CC00428                                  0070 00073000
*   MSG12='0     DASD  (CTL-I)';    /*                       @Y30LB14*/ 00074000
         MVC   MSG12(19),@CC00433                                  0071 00075000
*   MSG14='            CONTROLLER 00           CONTROLLER 01       0072 00076000
*ONTROLLER 10           CONTROLLER 11';/*                    @Y30LB14*/ 00077000
         MVC   MSG14(97),@CC00435                                  0072 00078000
*   MSG15='0           PLUG   TYPE    SSID     PLUG   TYPE    SSID 0073 00079000
*LUG   TYPE    SSID     PLUG   TYPE    SSID';/*              @Y30LB14*/ 00080000
         MVC   MSG15(103),@CC00442                                 0073 00081000
*   MSG17='0     DRC/DRD (CTL-I/ADT)';/*                     @Y30LB14*/ 00082000
         MVC   MSG17(25),@CC00449                                  0074 00083000
*   MSG18='           DRD CONTROLLER ADDRESS ';/*            @ZM01131*/ 00084000
         MVI   MSG18+34,C' '                                       0075 00085000
         MVC   MSG18+35(19),MSG18+34                               0075 00086000
         MVC   MSG18(34),@CC00452                                  0075 00087000
*   MSG19='                 DRC      SSID 4';/*              @Y30LB14*/ 00088000
         MVI   MSG19+32,C' '                                       0076 00089000
         MVI   MSG19+33,C' '                                       0076 00090000
         MVC   MSG19(32),@CC00455                                  0076 00091000
*   MSG20='                 DRD      SSID 2';/*              @Y30LB14*/ 00092000
         MVI   MSG20+32,C' '                                       0077 00093000
         MVI   MSG20+33,C' '                                       0077 00094000
         MVC   MSG20(32),@CC00458                                  0077 00095000
*   MSG21='   INTERFACE   IS NOT USED';/*                    @Y30LB14*/ 00096000
         MVC   MSG21(26),@CC00461                                  0078 00097000
*   MSG22='0   INTERFACE A TO MSC, PORT  , CONTROL UNIT ADDRESS    ';   00098000
         MVI   MSG22+56,C' '                                       0079 00099000
         MVI   MSG22+57,C' '                                       0079 00100000
         MVC   MSG22(56),@CC00464                                  0079 00101000
*                                   /*                       @OZ09549*/ 00102000
*   MSG23='0CONNECTION FOR CARTRIDGE STORE  MSF , SSID 1 0, MSFID =  '; 00103000
         MVI   MSG23+58,C' '                                       0080 00104000
         MVC   MSG23(58),@CC00468                                  0080 00105000
*                                   /*                       @OZ09549*/ 00106000
*   MSG24='0MSC TABLE ACCESS VALID ON INTERFACE(S)      ';/* @OZ28368*/ 00107000
         MVC   MSG24(45),@CC00473                                  0081 00108000
*                                                                  0082 00109000
*/***********************************************************#Y30LB14*/ 00110000
*/* START OF FIRST PART OF REPORT                            #Y30LB14*/ 00111000
*/* A NEW PAGE IS FORCED FOR THE START OF THE HOST CONNEC-   #Y30LB14*/ 00112000
*/* TIONS REPORT.  AFTER THE REPORT IS STARTED, IF MORE THAN #Y30LB14*/ 00113000
*/* 43 LINES ARE ON A PAGE, THEN A NEW PAGES IS FORCED BE-   #Y30LB14*/ 00114000
*/* FORE THE SECTION FOR THE NEXT DASD CONTROLLER IS PRINTED.#Y30LB14*/ 00115000
*/* A CHECK IS MADE TO SEE IF THERE IS A MERLIN OR ICEBERG   #Y30LB14*/ 00116000
*/* FOR THE CONTROLLER.  IF NONE IS FOUND, THEN THE BLOCK    #Y30LB14*/ 00117000
*/* FOR THAT CONTROLLER IS NOT PRINTED.  CALLS ARE MADE TO   #Y30LB14*/ 00118000
*/* CHECKDS2 AND MAINBODY TO GENERATE THE DATA THAT GOES IN  #Y30LB14*/ 00119000
*/* THE DASD CONTROLLER PORTION OF THE REPORT.               #Y30LB14*/ 00120000
*/***********************************************************#Y30LB14*/ 00121000
*                                                                  0082 00122000
*   LINECTR=LINECT;                 /*                       #Y30LB14*/ 00123000
         MVC   LINECTR(2,R4),LINECT(R4)                            0082 00124000
*   OUTBUF2(1:24)=MSG1;             /*                       #Y30LB14*/ 00125000
         MVC   OUTBUF2(24,R4),MSG1                                 0083 00126000
*   CALL PRINT1;                    /* PRINT A LINE          @Y30LB14*/ 00127000
         BAL   @14,PRINT1                                          0084 00128000
*   LINECTR=LINECTR+1;              /*                       @Y30LB14*/ 00129000
         LA    @06,1                                               0085 00130000
         LH    @05,LINECTR(,R4)                                    0085 00131000
         ALR   @05,@06                                             0085 00132000
         STH   @05,LINECTR(,R4)                                    0085 00133000
*   DO I=1 TO 16;                   /*                       @Y30LB14*/ 00134000
         LR    I,@06                                               0086 00135000
@DL00086 DS    0H                                                  0087 00136000
*     DO J=1 TO 4;                  /*                       @Y30LB14*/ 00137000
         LA    J,1                                                 0087 00138000
@DL00087 DS    0H                                                  0088 00139000
*       BIGBLOCK='0'B;              /*                       @Y30LB14*/ 00140000
         NI    BIGBLOCK,B'01111111'                                0088 00141000
*       DO K=1 TO 8;                /*                       @Y30LB14*/ 00142000
         LA    K,1                                                 0089 00143000
@DL00089 DS    0H                                                  0090 00144000
*         IF MERLICEB(I,J,K)^=PHYSFNUL/*                     @X50RSPC*/ 00145000
*           THEN                                                   0090 00146000
         LR    @15,I                                               0090 00147000
         SLA   @15,2                                               0090 00148000
         ALR   @15,J                                               0090 00149000
         SLA   @15,3                                               0090 00150000
         ALR   @15,K                                               0090 00151000
         ALR   @15,@15                                             0090 00152000
         ALR   @15,R4                                              0090 00153000
         TM    MERLICEB-82(@15),B'11000000'                        0090 00154000
         BZ    @RF00090                                            0090 00155000
*           BIGBLOCK='1'B;          /*                       @Y30LB14*/ 00156000
         OI    BIGBLOCK,B'10000000'                                0091 00157000
*       END;                        /*                       @Y30LB14*/ 00158000
@RF00090 AH    K,@CH00044                                          0092 00159000
         CH    K,@CH00042                                          0092 00160000
         BNH   @DL00089                                            0092 00161000
*       IF BIGBLOCK='1'B THEN                                      0093 00162000
         TM    BIGBLOCK,B'10000000'                                0093 00163000
         BNO   @RF00093                                            0093 00164000
*         DO;                       /*                       @Y30LB14*/ 00165000
*           IF LINECTR>43           /*                       @YD00152*/ 00166000
*             THEN                  /*                       @YD00152*/ 00167000
         LH    @06,LINECTR(,R4)                                    0095 00168000
         CH    @06,@CH00480                                        0095 00169000
         BNH   @RF00095                                            0095 00170000
*             DO;                   /*                       @YD00152*/ 00171000
*                                                                  0096 00172000
*               /*****************************************************/ 00173000
*               /*                                                   */ 00174000
*               /* *********************************         @YD00152*/ 00175000
*               /* PRINT THE SECONDARY HEADING               @YD00152*/ 00176000
*               /* ('HOST CONNECTIONS REPORT') ON            @YD00152*/ 00177000
*               /* EACH NEW PAGE.                            @YD00152*/ 00178000
*               /* *********************************         @YD00152*/ 00179000
*               /*                                                   */ 00180000
*               /*****************************************************/ 00181000
*                                                                  0097 00182000
*               LINECTR=LINECT;     /*                       @YD00152*/ 00183000
         MVC   LINECTR(2,R4),LINECT(R4)                            0097 00184000
*               OUTBUF2(1:24)=MSG1; /*                       @YD00152*/ 00185000
         MVC   OUTBUF2(24,R4),MSG1                                 0098 00186000
*               CALL PRINT1;        /*                       @YD00152*/ 00187000
         BAL   @14,PRINT1                                          0099 00188000
*               LINECTR=LINECTR+1;  /*                       @YD00152*/ 00189000
         LA    @06,1                                               0100 00190000
         AH    @06,LINECTR(,R4)                                    0100 00191000
         STH   @06,LINECTR(,R4)                                    0100 00192000
*             END;                  /*                       @YD00152*/ 00193000
*           CALL CHECKDS2;          /* CHECK FOR SECOND DS   @Y30LB14*/ 00194000
@RF00095 BAL   @14,CHECKDS2                                        0102 00195000
*           CALL PRINT1;            /* BLANK LINE            @Y30LB14*/ 00196000
         BAL   @14,PRINT1                                          0103 00197000
*           CALL MAINBODY;          /* MAIN BODY OF 1ST REPORT     0104 00198000
*                                                            @Y30LB14*/ 00199000
         BAL   @14,MAINBODY                                        0104 00200000
*         END;                      /*                       @Y30LB14*/ 00201000
*     END;                          /*                       @Y30LB14*/ 00202000
@RF00093 AH    J,@CH00044                                          0106 00203000
         CH    J,@CH00070                                          0106 00204000
         BNH   @DL00087                                            0106 00205000
*   END;                            /*                       @Y30LB14*/ 00206000
         AH    I,@CH00044                                          0107 00207000
         CH    I,@CH00164                                          0107 00208000
         BNH   @DL00086                                            0107 00209000
*                                                                  0108 00210000
*/***********************************************************@Y30LB14*/ 00211000
*/* THIS STARTS THE SECOND PART OF THE REPORT.               @Y30LB14*/ 00212000
*/* A CHECK IS MADE TO SEE OF THE STAGING ADAPTER IS DEFINED @Y30LB14*/ 00213000
*/* AND IF IT IS, THEN A NEW PAGE IS FORCED.  THEN THE CON-  @Y30LB14*/ 00214000
*/* NECTIONS FOR SA AND INTERFACE A TO MSC SSID LINES ARE    @Y30LB14*/ 00215000
*/* PRINTED.  A CALL IS THEN MADE TO CPUIDCUA TO DETERMINE   @Y30LB14*/ 00216000
*/* THE CPU ID AND CHANNEL UNIT ADDRESS FOR THE INTERFACE B, @Y30LB14*/ 00217000
*/* C,D LINES.  MSG12 IS PRINTED NEXT AND THEN A CALL IS     @Y30LB14*/ 00218000
*/* MADE TO SHAREDSA TO DETERMINE THE SHARED STAGING ADAPT-  @Y30LB14*/ 00219000
*/* ERS FOR THIS SA.  MSG14 AND MSG15 ARE THEN PRINTED AND   @Y30LB14*/ 00220000
*/* A CALL IS MADE TO ZEROMSG TO ZERO OUT THE CONTENTS OF    @Y30LB14*/ 00221000
*/* MSG16.  A CALL IS MADE TO MAINBOD2 TO PRODUCE THE DATA   @Y30LB14*/ 00222000
*/* THAT IS IN THE MAIN BODY OF THIS SECTION AND THEN A CALL @Y30LB14*/ 00223000
*/* IS MADE TO PRNTBOD2 TO PRINT OUT THE CONTENTS OF MSG16.  @Y30LB14*/ 00224000
*/* MSG16 CONTAINS ALL THE DATA IN THE 8 LINES OF THE MAIN   @Y30LB14*/ 00225000
*/* PART OF THIS SECTION OF THE REPORT.  THE DRC/DRD LINE IS @Y30LB14*/ 00226000
*/* PRINTED AS WILL AS A BLANK LINE AND THEN A CHECK IS MADE @Y30LB14*/ 00227000
*/* TO DETERMINE IF THE CONTROL UNIT ADDRESS IS USED.  IF IT @Y30LB14*/ 00228000
*/* IS NOT, THEN A MESSAGE STATING THIS FACT IS PRINTED,     @Y30LB14*/ 00229000
*/* OTHERWISE, CALLS ARE MADE TO SETMSG18, LIBSIZE1,         @Y30LB14*/ 00230000
*/* LIBSIZE2 AND LIBSIZE3 TO BUILD THE DRD LINES.  THE       @Y30LB14*/ 00231000
*/* PROGRAM NOW RETURN TO THE BUILD MODULE.                  @Y30LB14*/ 00232000
*/***********************************************************@Y30LB14*/ 00233000
*                                                                  0108 00234000
*   DO I=1 TO 16;                   /*                       @Y30LB14*/ 00235000
*                                                                  0108 00236000
         LA    I,1                                                 0108 00237000
@DL00108 DS    0H                                                  0109 00238000
*     /***************************************************************/ 00239000
*     /*                                                             */ 00240000
*     /* *********************************************       @YD00143*/ 00241000
*     /* WRITE THE CONNECTIONS REPORT WHETHER BOTH           @YD00143*/ 00242000
*     /* THE CPUS AND THE MSF CONNECT TO THE STAGING         @YD00143*/ 00243000
*     /* CONNECT TO THE STAGING ADAPTER OR ONLY              @YD00143*/ 00244000
*     /* ONLY ONE CONNECTS. IN ANY CASE THERE WILL           @YD00143*/ 00245000
*     /* BE DASD CONNECTIONS.                                @YD00143*/ 00246000
*     /* *********************************************       @YD00143*/ 00247000
*     /*                                                             */ 00248000
*     /***************************************************************/ 00249000
*                                                                  0109 00250000
*     IF CISPEC(I*3-2)='1'B         /*                       @YD00143*/ 00251000
*         |CISPEC(I*3-1)='1'B       /*                       @YD00143*/ 00252000
*         |CISPEC(I*3)='1'B         /*                       @YD00143*/ 00253000
*         |LOWSPEC(I,1)='1'B        /*                       @YD00143*/ 00254000
*         |LOWSPEC(I,2)='1'B        /*                       @YD00143*/ 00255000
*         |LOWSPEC(I,3)='1'B        /*                       @YD00143*/ 00256000
*         |LOWSPEC(I,4)='1'B        /*                       @YD00143*/ 00257000
*       THEN                                                       0109 00258000
         LR    @06,I                                               0109 00259000
         MH    @06,@CH00312                                        0109 00260000
         L     @02,COMPTR2(,R4)                                    0109 00261000
         ST    @06,@TF00001                                        0109 00262000
         ALR   @06,@02                                             0109 00263000
         TM    CISPEC-27(@06),B'10000000'                          0109 00264000
         BO    @RT00109                                            0109 00265000
         LR    @06,@02                                             0109 00266000
         AL    @06,@TF00001                                        0109 00267000
         TM    CISPEC-18(@06),B'10000000'                          0109 00268000
         BO    @RT00109                                            0109 00269000
         AL    @02,@TF00001                                        0109 00270000
         TM    CISPEC-9(@02),B'10000000'                           0109 00271000
         BO    @RT00109                                            0109 00272000
         LR    @06,I                                               0109 00273000
         SLA   @06,3                                               0109 00274000
         ST    @06,@TF00001                                        0109 00275000
         ALR   @06,R4                                              0109 00276000
         TM    LOWSPEC-8(@06),B'10000000'                          0109 00277000
         BO    @RT00109                                            0109 00278000
         LR    @06,R4                                              0109 00279000
         AL    @06,@TF00001                                        0109 00280000
         TM    LOWSPEC-6(@06),B'10000000'                          0109 00281000
         BO    @RT00109                                            0109 00282000
         LR    @06,R4                                              0109 00283000
         AL    @06,@TF00001                                        0109 00284000
         TM    LOWSPEC-4(@06),B'10000000'                          0109 00285000
         BO    @RT00109                                            0109 00286000
         LR    @06,R4                                              0109 00287000
         AL    @06,@TF00001                                        0109 00288000
         TM    LOWSPEC-2(@06),B'10000000'                          0109 00289000
         BNO   @RF00109                                            0109 00290000
@RT00109 DS    0H                                                  0110 00291000
*       DO;                         /*                       @Y30LB14*/ 00292000
*                                                                  0110 00293000
*         /***********************************************************/ 00294000
*         /*                                                         */ 00295000
*         /* *****************************************       @YD00152*/ 00296000
*         /* PRINT THE SECONDARY HEADING (CONNECTIONS        @YD00152*/ 00297000
*         /* REPORT) ON EACH NEW PAGE. START A NEW           @YD00152*/ 00298000
*         /* PAGE WHEN A NEW STAGING ADAPTER IS FOUND        @YD00152*/ 00299000
*         /* *****************************************       @YD00152*/ 00300000
*         /*                                                         */ 00301000
*         /***********************************************************/ 00302000
*                                                                  0111 00303000
*         LINECTR=LINECT;           /* FORCE NEW PAGE        @Y30LB14*/ 00304000
         MVC   LINECTR(2,R4),LINECT(R4)                            0111 00305000
*         OUTBUF2(1:19)=MSG10;      /*                       @YD00152*/ 00306000
         MVC   OUTBUF2(19,R4),MSG10                                0112 00307000
*         CALL PRINT1;              /*                       @YD00152*/ 00308000
         BAL   @14,PRINT1                                          0113 00309000
*         OUTBUF2(1)='0';           /* SPACE TWO LINES       @OZ09549*/ 00310000
         MVI   OUTBUF2(R4),C'0'                                    0114 00311000
*         DO K=1 TO 4;              /* POSS. SUPPORT OF MORE THAN TWO   00312000
*                                      MSFS                  @OZ09549*/ 00313000
         LA    K,1                                                 0115 00314000
@DL00115 DS    0H                                                  0116 00315000
*           IF LIBSPEC(K)='0'B      /* CHECK FOR NONSPECIFIED MSF  0116 00316000
*                                                            @OZ09549*/ 00317000
*             THEN                                                 0116 00318000
         LR    @02,K                                               0116 00319000
         MH    @02,@CH00130                                        0116 00320000
         ALR   @02,R4                                              0116 00321000
         TM    LIBSPEC-12(@02),B'10000000'                         0116 00322000
         BNZ   @RF00116                                            0116 00323000
*             K=4;                  /* LEAVE THE LOOP        @OZ09549*/ 00324000
         LA    K,4                                                 0117 00325000
*           ELSE                                                   0118 00326000
*             DO;                                                  0118 00327000
         B     @RC00116                                            0118 00328000
@RF00116 DS    0H                                                  0119 00329000
*               MSG23(37)=TABLE(K); /* MSF NUMBER            @OZ09549*/ 00330000
         LA    @02,TABLE-1(K)                                      0119 00331000
         MVC   MSG23+36(1),0(@02)                                  0119 00332000
*               MSG23(46)=TABLE(K); /* MSF SSID              @OZ09549*/ 00333000
         LA    @02,TABLE-1(K)                                      0120 00334000
         MVC   MSG23+45(1),0(@02)                                  0120 00335000
*               DO J=1 TO 15;       /* CONVERT MSFID FROM BINARY   0121 00336000
*                                                            @OZ09549*/ 00337000
*                                                                  0121 00338000
         LA    J,1                                                 0121 00339000
@DL00121 DS    0H                                                  0122 00340000
*                 /***************************************************/ 00341000
*                 /*                                                 */ 00342000
*                 /* TO CHARACTER FIELD FOR PRINT            @OZ09549*/ 00343000
*                 /*                                                 */ 00344000
*                 /***************************************************/ 00345000
*                                                                  0122 00346000
*                 IF LIBDSMID(K)=J  /* POSS. 1 - F           @OZ09549*/ 00347000
*                   THEN                                           0122 00348000
         LR    @15,K                                               0122 00349000
         MH    @15,@CH00130                                        0122 00350000
         ALR   @15,R4                                              0122 00351000
         MVC   @ZT00003+3(1),LIBDSMID-12(@15)                      0122 00352000
         C     J,@ZT00003                                          0122 00353000
         BNE   @RF00122                                            0122 00354000
*                   DO;                                            0123 00355000
*                     MSG23(58)=TABLE(J+1);/* CHARACTER MSFID      0124 00356000
*                                                            @OZ09549*/ 00357000
         LA    @01,TABLE(J)                                        0124 00358000
         MVC   MSG23+57(1),0(@01)                                  0124 00359000
*                     J=16;         /* LEAVE LOOP TO PRINT   @OZ09549*/ 00360000
         LA    J,16                                                0125 00361000
*                   END;                                           0126 00362000
*               END;                /* END J LOOP            @OZ09549*/ 00363000
@RF00122 AH    J,@CH00044                                          0127 00364000
         CH    J,@CH00065                                          0127 00365000
         BNH   @DL00121                                            0127 00366000
*               OUTBUF2(1:60)=MSG23;/*                       @OZ09549*/ 00367000
         MVI   OUTBUF2+59(R4),C' '                                 0128 00368000
         MVC   OUTBUF2(59,R4),MSG23                                0128 00369000
*               CALL PRINT1;        /*                       @OZ09549*/ 00370000
         BAL   @14,PRINT1                                          0129 00371000
*             END;                                                 0130 00372000
*         END;                      /* END K LOOP            @OZ09549*/ 00373000
*                                                                  0131 00374000
@RC00116 AH    K,@CH00044                                          0131 00375000
         CH    K,@CH00070                                          0131 00376000
         BNH   @DL00115                                            0131 00377000
*         /***********************************************************/ 00378000
*         /*                                                         */ 00379000
*         /* TABLE ACCESS VALID ON INTERFACE (X) PRINT.      @OZ28368*/ 00380000
*         /*                                                         */ 00381000
*         /***********************************************************/ 00382000
*                                                                  0132 00383000
*         OUTBUF2(1:LENGTH(MSG24))=MSG24;/* WRT PTH INT. IND.      0132 00384000
*                                                            @OZ28368*/ 00385000
         MVC   OUTBUF2(45,R4),MSG24                                0132 00386000
*         IF DINTIND='1'B THEN                                     0133 00387000
         TM    DINTIND(R4),B'00000001'                             0133 00388000
         BNO   @RF00133                                            0133 00389000
*           OUTBUF2(41:45)=TABLE5(3);/*                      @OZ28368*/ 00390000
         MVC   OUTBUF2+40(5,R4),TABLE5+10                          0134 00391000
*         ELSE                                                     0135 00392000
*           IF CINTIND='1'B THEN                                   0135 00393000
         B     @RC00133                                            0135 00394000
@RF00133 TM    CINTIND(R4),B'00000010'                             0135 00395000
         BNO   @RF00135                                            0135 00396000
*             OUTBUF2(41:45)=TABLE5(2);/*                    @OZ28368*/ 00397000
         MVC   OUTBUF2+40(5,R4),TABLE5+5                           0136 00398000
*           ELSE                                                   0137 00399000
*             OUTBUF2(41:45)=TABLE5(1);/*                    @OZ28368*/ 00400000
         B     @RC00135                                            0137 00401000
@RF00135 MVC   OUTBUF2+40(5,R4),TABLE5                             0137 00402000
*         CALL PRINT1;              /*                       @OZ28368*/ 00403000
@RC00135 DS    0H                                                  0138 00404000
@RC00133 BAL   @14,PRINT1                                          0138 00405000
*         MSG9(21)=TABLE(I);        /*                       #Y30LB14*/ 00406000
         LA    @06,TABLE-1(I)                                      0139 00407000
         MVC   MSG9+20(1),0(@06)                                   0139 00408000
*         MSG9(29)=TABLE(I);        /*                       @YD00152*/ 00409000
         LA    @06,TABLE-1(I)                                      0140 00410000
         MVC   MSG9+28(1),0(@06)                                   0140 00411000
*         OUTBUF2(1:30)=MSG9;       /*                       @YD00152*/ 00412000
         MVC   OUTBUF2(30,R4),MSG9                                 0141 00413000
*         CALL PRINT1;              /* PRINT A LINE          #Y30LB14*/ 00414000
         BAL   @14,PRINT1                                          0142 00415000
*         CALL CPUIDCUA;            /* CPU ID & CHAN/UNIT ADDR     0143 00416000
*                                                            #Y30LB14*/ 00417000
         BAL   @14,CPUIDCUA                                        0143 00418000
*         OUTBUF2(1:19)=MSG12;      /*                       #Y30LB14*/ 00419000
         MVC   OUTBUF2(19,R4),MSG12                                0144 00420000
*         CALL PRINT1;              /* PRINT A LINE          #Y30LB14*/ 00421000
         BAL   @14,PRINT1                                          0145 00422000
*         MSG13='';                 /*                       #Y30LB14*/ 00423000
         MVI   MSG13,C' '                                          0146 00424000
         MVC   MSG13+1(96),MSG13                                   0146 00425000
*         CALL SHAREDSA;            /* SHARED STAGING ADAPTERS     0147 00426000
*                                                            @YD00113*/ 00427000
         BAL   @14,SHAREDSA                                        0147 00428000
*         OUTBUF2(1:97)=MSG13;      /*                       #Y30LB14*/ 00429000
         MVC   OUTBUF2(97,R4),MSG13                                0148 00430000
*         CALL PRINT1;              /* PRINT A LINE          #Y30LB14*/ 00431000
         BAL   @14,PRINT1                                          0149 00432000
*         OUTBUF2(1:97)=MSG14;      /*                       #Y30LB14*/ 00433000
         MVC   OUTBUF2(97,R4),MSG14                                0150 00434000
*         CALL PRINT1;              /* PRINT A LINE          #Y30LB14*/ 00435000
         BAL   @14,PRINT1                                          0151 00436000
*         OUTBUF2(1:103)=MSG15;     /*                       #Y30LB14*/ 00437000
         MVC   OUTBUF2(103,R4),MSG15                               0152 00438000
*         CALL PRINT1;              /* PRINT A LINE          #Y30LB14*/ 00439000
         BAL   @14,PRINT1                                          0153 00440000
*         CALL ZEROMSG;             /* ZERO OUT MESSAGE      #Y30LB14*/ 00441000
         BAL   @14,ZEROMSG                                         0154 00442000
*         CALL MAINBOD2;            /* MAIN BODY OF 2ND REPORT     0155 00443000
*                                                            #Y30LB14*/ 00444000
         BAL   @14,MAINBOD2                                        0155 00445000
*         CALL PRNTBOD2;            /* PRINT 2ND PART OF REPORT    0156 00446000
*                                                            #Y30LB14*/ 00447000
         BAL   @14,PRNTBOD2                                        0156 00448000
*         OUTBUF2(1:25)=MSG17;      /*                       #Y30LB14*/ 00449000
         MVC   OUTBUF2(25,R4),MSG17                                0157 00450000
*         CALL PRINT1;              /* PRINT A LINE          #Y30LB14*/ 00451000
         BAL   @14,PRINT1                                          0158 00452000
*         CALL PRINT1;              /* PUT OUT BLANK LINE    #Y30LB14*/ 00453000
         BAL   @14,PRINT1                                          0159 00454000
*         DO J=1 TO 4;              /*                       #Y30LB14*/ 00455000
         LA    J,1                                                 0160 00456000
@DL00160 DS    0H                                                  0161 00457000
*           MSG18(34:54)='';        /*                       #Y30LB14*/ 00458000
         MVI   MSG18+33,C' '                                       0161 00459000
         MVC   MSG18+34(20),MSG18+33                               0161 00460000
*           IF LOWSPEC(I,J)='0'B THEN                              0162 00461000
         LR    @06,I                                               0162 00462000
         SLA   @06,2                                               0162 00463000
         ALR   @06,J                                               0162 00464000
         ALR   @06,@06                                             0162 00465000
         ALR   @06,R4                                              0162 00466000
         TM    LOWSPEC-10(@06),B'10000000'                         0162 00467000
         BNZ   @RF00162                                            0162 00468000
*             DO;                   /*                       #Y30LB14*/ 00469000
*               MSG18(35:36)=CNTRTABL(J);/*                  #Y30LB14*/ 00470000
         LR    @06,J                                               0164 00471000
         ALR   @06,@06                                             0164 00472000
         LA    @01,CNTRTABL-2(@06)                                 0164 00473000
         MVC   MSG18+34(2),0(@01)                                  0164 00474000
*               MSG18(38:46)='IS UNUSED';/*                  #Y30LB14*/ 00475000
         MVC   MSG18+37(9),@CC00498                                0165 00476000
*               OUTBUF2(1:46)=MSG18;/*                       #Y30LB14*/ 00477000
         MVC   OUTBUF2(46,R4),MSG18                                0166 00478000
*               CALL PRINT1;        /* PRINT A LINE          #Y30LB14*/ 00479000
         BAL   @14,PRINT1                                          0167 00480000
*             END;                  /*                       #Y30LB14*/ 00481000
*           ELSE                                                   0169 00482000
*             DO;                   /*                       #Y30LB14*/ 00483000
         B     @RC00162                                            0169 00484000
@RF00162 DS    0H                                                  0170 00485000
*               CALL SETMSG18;      /* SET UP MESSAGE 18     #Y30LB14*/ 00486000
         BAL   @14,SETMSG18                                        0170 00487000
*               CALL LIBSIZE1;      /* USED IF LIB SIZE=1    #Y30LB14*/ 00488000
         BAL   @14,LIBSIZE1                                        0171 00489000
*               CALL LIBSIZE2;      /* USED IF LIB SIZE=2    #Y30LB14*/ 00490000
         BAL   @14,LIBSIZE2                                        0172 00491000
*               CALL LIBSIZE3;      /* USED IF LIB SIZE=3    #Y30LB14*/ 00492000
         BAL   @14,LIBSIZE3                                        0173 00493000
*             END;                  /*                       #Y30LB14*/ 00494000
*         END;                      /*                       #Y30LB14*/ 00495000
@RC00162 AH    J,@CH00044                                          0175 00496000
         CH    J,@CH00070                                          0175 00497000
         BNH   @DL00160                                            0175 00498000
*       END;                        /*                       #Y30LB14*/ 00499000
*   END;                            /*                       #Y30LB14*/ 00500000
*                                                                  0177 00501000
@RF00109 AH    I,@CH00044                                          0177 00502000
         CH    I,@CH00164                                          0177 00503000
         BNH   @DL00108                                            0177 00504000
*   /*****************************************************************/ 00505000
*   /*                                                               */ 00506000
*   /* ***********************************************       @YD00152*/ 00507000
*   /* SET TO SKIP TO NEW PAGE WHEN REPORTS ARE              @YD00152*/ 00508000
*   /* COMPLETE                                              @YD00152*/ 00509000
*   /* ***********************************************       @YD00152*/ 00510000
*   /*                                                               */ 00511000
*   /*****************************************************************/ 00512000
*                                                                  0178 00513000
*   LINECTR=LINECT;                 /*                       @YD00152*/ 00514000
         MVC   LINECTR(2,R4),LINECT(R4)                            0178 00515000
*   RETURN;                         /* RETURN TO BUILD       #Y30LB14*/ 00516000
@EL00001 L     @13,4(,@13)                                         0179 00517000
@EF00001 L     @00,@SIZDATD                                        0179 00518000
         LR    @01,@12                                             0179 00519000
         FREEMAIN R,LV=(0),A=(1)                                        00520000
@ER00001 LM    @14,@12,12(@13)                                     0179 00521000
         BR    @14                                                 0179 00522000
*                                                                  0180 00523000
*/***********************************************************#Y30LB14*/ 00524000
*/*                                                          @XD00153*/ 00525000
*/* PROCEDURE NAME - ZEROMSG                                 @XD00153*/ 00526000
*/*                                                          @XD00153*/ 00527000
*/* FUNCTION - THIS ROUTINE SETS MSG16 TO BLANKS ('40'X)     @XD00153*/ 00528000
*/*                                                          @XD00153*/ 00529000
*/***********************************************************#Y30LB14*/ 00530000
*                                                                  0180 00531000
*ZEROMSG:                                                          0180 00532000
*   PROCEDURE;                      /*                       #Y30LB14*/ 00533000
ZEROMSG  STM   @14,@12,12(@13)                                     0180 00534000
*   DO L=0 TO 7;                    /*                       #Y30LB14*/ 00535000
         SLR   L,L                                                 0181 00536000
@DL00181 DS    0H                                                  0182 00537000
*     MSG16(103*L+1:103*L+103)='';  /*                       #Y30LB14*/ 00538000
         LR    @05,L                                               0182 00539000
         MH    @05,@CH00329                                        0182 00540000
         LA    @02,MSG16(@05)                                      0182 00541000
         MVI   0(@02),C' '                                         0182 00542000
         MVC   1(102,@02),0(@02)                                   0182 00543000
*   END;                            /*                       #Y30LB14*/ 00544000
         AH    L,@CH00044                                          0183 00545000
         CH    L,@CH00135                                          0183 00546000
         BNH   @DL00181                                            0183 00547000
*   END ZEROMSG;                    /*                       #Y30LB14*/ 00548000
@EL00002 DS    0H                                                  0184 00549000
@EF00002 DS    0H                                                  0184 00550000
@ER00002 LM    @14,@12,12(@13)                                     0184 00551000
         BR    @14                                                 0184 00552000
*                                                                  0185 00553000
*/***********************************************************#Y30LB14*/ 00554000
*/*                                                          @XD00153*/ 00555000
*/* PROCEDURE NAME - CPUIDCUA                                @XD00153*/ 00556000
*/*                                                          @XD00153*/ 00557000
*/* FUNCTION - THIS ROUTINE DETERMINES THE CPU ID AND        @XD00153*/ 00558000
*/*            CHANNEL UNIT ADDRESS FOR THE SECOND PART OF   @XD00153*/ 00559000
*/*            THE REPORT.  IF THE INTERFACE IS NOT USED,    @XD00153*/ 00560000
*/*            A MESSAGE TO THAT EFFECT IS PRINTED.          @XD00153*/ 00561000
*/*                                                          @XD00153*/ 00562000
*/***********************************************************#Y30LB14*/ 00563000
*                                                                  0185 00564000
*CPUIDCUA:                                                         0185 00565000
*   PROCEDURE;                      /*                       #Y30LB14*/ 00566000
*                                                                  0185 00567000
CPUIDCUA STM   @14,@12,@SA00003                                    0185 00568000
*   /*****************************************************************/ 00569000
*   /*                                                               */ 00570000
*   /* ***********************************************       @YD00152*/ 00571000
*   /* SPACE TWO BEFORE PRINTING 'A' INTERFACE.              @OZ09549*/ 00572000
*   /* ***********************************************       @YD00152*/ 00573000
*   /*                                                               */ 00574000
*   /*****************************************************************/ 00575000
*                                                                  0186 00576000
*   OUTBUF2(1)='0';                 /*                       @YD00152*/ 00577000
*                                                                  0186 00578000
         MVI   OUTBUF2(R4),C'0'                                    0186 00579000
*   /*****************************************************************/ 00580000
*   /*                                                               */ 00581000
*   /* ***********************************************       @YD00152*/ 00582000
*   /* PRINT 'A','B','C' AND 'D' CHANNEL INTERFACES.         @OZ09549*/ 00583000
*   /* ***********************************************       @YD00152*/ 00584000
*   /*                                                               */ 00585000
*   /*****************************************************************/ 00586000
*                                                                  0187 00587000
*   IF I<8                          /* PLUG ADDR. = 2ND CHAR. OF SSID   00588000
*                                                            @OZ09549*/ 00589000
*     THEN                                                         0187 00590000
         CH    I,@CH00042                                          0187 00591000
         BNL   @RF00187                                            0187 00592000
*     DO;                                                          0188 00593000
*       MSG22(30)=TABLE(1);         /* PORT 0                @OZ09549*/ 00594000
         MVC   MSG22+29(1),TABLE                                   0189 00595000
*       MSG22(54:56)=TABLE4(I);     /*                       @OZ09549*/ 00596000
         LR    @15,I                                               0190 00597000
         MH    @15,@CH00050                                        0190 00598000
         LA    @14,TABLE4-3(@15)                                   0190 00599000
         MVC   MSG22+53(3),0(@14)                                  0190 00600000
*       OUTBUF2(1:56)=MSG22;        /*                       @OZ09549*/ 00601000
         MVC   OUTBUF2(56,R4),MSG22                                0191 00602000
*       CALL PRINT1;                /*                       @OZ09549*/ 00603000
         BAL   @14,PRINT1                                          0192 00604000
*     END;                                                         0193 00605000
*   ELSE                                                           0194 00606000
*     DO;                                                          0194 00607000
         B     @RC00187                                            0194 00608000
@RF00187 DS    0H                                                  0195 00609000
*       MSG22(30)=TABLE(2);         /* PORT 1                @OZ09549*/ 00610000
         MVC   MSG22+29(1),TABLE+1                                 0195 00611000
*       MSG22(54:56)=TABLE4(I);     /*                       @OZ09549*/ 00612000
         LR    @15,I                                               0196 00613000
         MH    @15,@CH00050                                        0196 00614000
         LA    @14,TABLE4-3(@15)                                   0196 00615000
         MVC   MSG22+53(3),0(@14)                                  0196 00616000
*       OUTBUF2(1:56)=MSG22;        /*                       @OZ09549*/ 00617000
         MVC   OUTBUF2(56,R4),MSG22                                0197 00618000
*       CALL PRINT1;                /* PRINT INT. A LINE     @OZ09549*/ 00619000
         BAL   @14,PRINT1                                          0198 00620000
*     END;                                                         0199 00621000
*   DO L=1 TO 3;                    /*                       #Y30LB14*/ 00622000
@RC00187 LA    L,1                                                 0200 00623000
@DL00200 DS    0H                                                  0201 00624000
*     IF CISPEC((I-1)*3+L)='1'B THEN                               0201 00625000
         LR    @02,I                                               0201 00626000
         BCTR  @02,0                                               0201 00627000
         MH    @02,@CH00050                                        0201 00628000
         ALR   @02,L                                               0201 00629000
         MH    @02,@CH00114                                        0201 00630000
         L     @15,COMPTR2(,R4)                                    0201 00631000
         ST    @02,@TF00001                                        0201 00632000
         ALR   @02,@15                                             0201 00633000
         TM    CISPEC-9(@02),B'10000000'                           0201 00634000
         BNO   @RF00201                                            0201 00635000
*       DO;                         /*                       #Y30LB14*/ 00636000
*         MSG11(14)=TABLE(11+L);    /*                       #Y30LB14*/ 00637000
         LA    @02,TABLE+10(L)                                     0203 00638000
         MVC   MSG11+13(1),0(@02)                                  0203 00639000
*         PACKED(1:6)=RSGCPUID((I-1)*3+L);/*                 #Y30LB14*/ 00640000
         MVI   PACKED+5,C' '                                       0204 00641000
         AL    @15,@TF00001                                        0204 00642000
         MVC   PACKED(5),RSGCPUID-9(@15)                           0204 00643000
*         PACKED(6)='0F'X;          /*                       #Y30LB14*/ 00644000
         MVI   PACKED+5,X'0F'                                      0205 00645000
*         GEN(UNPK UNPACKED(11),PACKED(6));/*                #Y30LB14*/ 00646000
         UNPK UNPACKED(11),PACKED(6)                                    00647000
*         MSG11(23:32)=UNPACKED(1:10);/*                     #Y30LB14*/ 00648000
         MVC   MSG11+22(10),UNPACKED                               0207 00649000
*         MSG11(43)=TABLE(RSGCHAN((I-1)*3+L)+1);                   0208 00650000
         LR    @02,I                                               0208 00651000
         BCTR  @02,0                                               0208 00652000
         MH    @02,@CH00050                                        0208 00653000
         ALR   @02,L                                               0208 00654000
         MH    @02,@CH00114                                        0208 00655000
         L     @15,COMPTR2(,R4)                                    0208 00656000
         SLR   @14,@14                                             0208 00657000
         IC    @14,RSGCHAN-9(@02,@15)                              0208 00658000
         LA    @01,TABLE(@14)                                      0208 00659000
         MVC   MSG11+42(1),0(@01)                                  0208 00660000
*         MSG11(67)=TABLE((RSGCUA((I-1)*3+L)/2)//2+1);             0209 00661000
         SLR   @14,@14                                             0209 00662000
         IC    @14,RSGCUA-9(@02,@15)                               0209 00663000
         LR    @02,@14                                             0209 00664000
         SRL   @02,1                                               0209 00665000
         LR    @00,@02                                             0209 00666000
         SRDA  @00,32                                              0209 00667000
         D     @00,@CF00052                                        0209 00668000
         LR    @02,@00                                             0209 00669000
         LA    @01,TABLE(@02)                                      0209 00670000
         MVC   MSG11+66(1),0(@01)                                  0209 00671000
*         MSG11(68)=TABLE(RSGCUA((I-1)*3+L)//2+1);                 0210 00672000
         SRDA  @14,32                                              0210 00673000
         D     @14,@CF00052                                        0210 00674000
         LA    @02,TABLE(@14)                                      0210 00675000
         MVC   MSG11+67(1),0(@02)                                  0210 00676000
*         OUTBUF2(2:69)=MSG11;      /*                       #XM01739*/ 00677000
         MVC   OUTBUF2+1(68,R4),MSG11                              0211 00678000
*       END;                        /*                       #Y30LB14*/ 00679000
*     ELSE                                                         0213 00680000
*       DO;                         /*                       #Y30LB14*/ 00681000
         B     @RC00201                                            0213 00682000
@RF00201 DS    0H                                                  0214 00683000
*         MSG21(14)=TABLE(11+L);    /*                       #Y30LB14*/ 00684000
         LA    @02,TABLE+10(L)                                     0214 00685000
         MVC   MSG21+13(1),0(@02)                                  0214 00686000
*         OUTBUF2(2:27)=MSG21;      /*                       #XM01739*/ 00687000
         MVC   OUTBUF2+1(26,R4),MSG21                              0215 00688000
*       END;                        /*                       #Y30LB14*/ 00689000
*     CALL PRINT1;                  /* PRINT A LINE          #Y30LB14*/ 00690000
@RC00201 BAL   @14,PRINT1                                          0217 00691000
*   END;                            /*                       #Y30LB14*/ 00692000
         AH    L,@CH00044                                          0218 00693000
         CH    L,@CH00050                                          0218 00694000
         BNH   @DL00200                                            0218 00695000
*   END CPUIDCUA;                   /*                       #Y30LB14*/ 00696000
@EL00003 DS    0H                                                  0219 00697000
@EF00003 DS    0H                                                  0219 00698000
@ER00003 LM    @14,@12,@SA00003                                    0219 00699000
         BR    @14                                                 0219 00700000
*                                                                  0220 00701000
*/***********************************************************#Y30LB14*/ 00702000
*/* THIS ROUTINE DETERMINES THE SHARED SA'S                  #Y30LB14*/ 00703000
*/* IF THE SHARED STAGING ADAPTER IS DEFINED, THEN 'SHARED   #Y30LB14*/ 00704000
*/* SA @' IS PUT IN THE PROPER COLUMN OF MSG13.              #Y30LB14*/ 00705000
*/***********************************************************#Y30LB14*/ 00706000
*                                                                  0220 00707000
*SHAREDSA:                                                         0220 00708000
*   PROCEDURE;                      /*                       #Y30LB14*/ 00709000
SHAREDSA STM   @14,@12,12(@13)                                     0220 00710000
*   DO J=1 TO 4;                    /*                       #Y30LB14*/ 00711000
         LA    J,1                                                 0221 00712000
@DL00221 DS    0H                                                  0222 00713000
*     IF PHYSDS2(I,J)^='FF'X THEN                                  0222 00714000
         LR    @03,I                                               0222 00715000
         SLA   @03,2                                               0222 00716000
         ALR   @03,J                                               0222 00717000
         ST    @03,@TF00001                                        0222 00718000
         ALR   @03,R4                                              0222 00719000
         CLI   PHYSDS2-5(@03),X'FF'                                0222 00720000
         BE    @RF00222                                            0222 00721000
*       DO;                         /*                       #Y30LB14*/ 00722000
*         MSG13(J*24-11:J*24+1)='(SHARED SA  )';                   0224 00723000
         LR    @03,J                                               0224 00724000
         MH    @03,@CH00269                                        0224 00725000
         LA    @01,MSG13-12(@03)                                   0224 00726000
         MVC   0(13,@01),@CC00521                                  0224 00727000
*         MSG13(J*24)=TABLE(PHYSDS2(I,J)+1);/*               #Y30LB14*/ 00728000
         LA    @01,MSG13-1(@03)                                    0225 00729000
         L     @03,@TF00001                                        0225 00730000
         SLR   @15,@15                                             0225 00731000
         IC    @15,PHYSDS2-5(@03,R4)                               0225 00732000
         LA    @03,TABLE(@15)                                      0225 00733000
         MVC   0(1,@01),0(@03)                                     0225 00734000
*       END;                        /*                       #Y30LB14*/ 00735000
*   END;                            /*                       #Y30LB14*/ 00736000
@RF00222 AH    J,@CH00044                                          0227 00737000
         CH    J,@CH00070                                          0227 00738000
         BNH   @DL00221                                            0227 00739000
*   END SHAREDSA;                   /*                       #Y30LB14*/ 00740000
@EL00004 DS    0H                                                  0228 00741000
@EF00004 DS    0H                                                  0228 00742000
@ER00004 LM    @14,@12,12(@13)                                     0228 00743000
         BR    @14                                                 0228 00744000
*                                                                  0229 00745000
*/***********************************************************#Y30LB14*/ 00746000
*/*                                                          @XD00153*/ 00747000
*/* PROCEDURE NAME - MAINBOD2                                @XD00153*/ 00748000
*/*                                                          @XD00153*/ 00749000
*/* FUNCTION - THIS IS THE ROUTINE FOR THE MAIN BODY OF THE  @XD00153*/ 00750000
*/*            REPORT.  ZEROMSG IS CALLED TO ZERO OUT MSG16. @XD00153*/ 00751000
*/*            THE PLUG NUMBER IS INSERTED AND THEN A CHECK  @XD00153*/ 00752000
*/*            IS MADE TO SEE IF THE UNIT IS A MERLIN.  IF   @XD00153*/ 00753000
*/*            IT IS, 3330-1 IS PLACED IN THE TYPE COLUMN.   @XD00153*/ 00754000
*/*            IF THE UNIT IS AN ICEBERG, 3330-11 IS PLACED  @XD00153*/ 00755000
*/*            IN THE TYPE COLUMN. IF IT IS NEITHER OF THOSE @XD00153*/ 00756000
*/*            2 DEVICES, THEN ***** IS PLACED IN THE TYPE   @XD00153*/ 00757000
*/*            COLUMN.  IF ALL 8 LINES CONTAIN *****, THEN   @XD00153*/ 00758000
*/*            THESE ARE REPLACED WITH BLANKS.  THE SSID IS  @XD00153*/ 00759000
*/*            THEN DETERMINED AND PLACED IN THE SSID        @XD00153*/ 00760000
*/*            POSITIONS.  IF THERE IS NO SSID, THEN *** IS  @XD00153*/ 00761000
*/*            INSERTED.  IF ALL 8 LINES ARE ***, THEY ARE   @XD00153*/ 00762000
*/*            REPLACED WITH BLANKS.                         @XD00153*/ 00763000
*/*            NOTE:  MSG16 CONTAINS THE INFORMATION FOR ALL @XD00153*/ 00764000
*/*            8 LINES WHEN THIS ROUTINE RETURNS.            @XD00153*/ 00765000
*/*                                                          @XD00153*/ 00766000
*/***********************************************************@XD00153*/ 00767000
*                                                                  0229 00768000
*MAINBOD2:                                                         0229 00769000
*   PROCEDURE;                      /*                       @XD00153*/ 00770000
MAINBOD2 STM   @14,@02,@SA00005                                    0229 00771000
         STM   @04,@06,@SA00005+20                                 0229 00772000
         STM   @08,@12,@SA00005+32                                 0229 00773000
*   CALL ZEROMSG;                   /* ZERO OUT MESSAGE      @XD00153*/ 00774000
         BAL   @14,ZEROMSG                                         0230 00775000
*   DO J=1 TO 4;                    /*                       @XD00153*/ 00776000
         LA    J,1                                                 0231 00777000
@DL00231 DS    0H                                                  0232 00778000
*     DO K=1 TO 8;                  /*                       @XD00153*/ 00779000
         LA    K,1                                                 0232 00780000
@DL00232 DS    0H                                                  0233 00781000
*       MSG16(103*K+24*J-112)=TABLE(K);/*                    @XD00153*/ 00782000
         LR    @15,K                                               0233 00783000
         MH    @15,@CH00329                                        0233 00784000
         LR    @14,J                                               0233 00785000
         MH    @14,@CH00269                                        0233 00786000
         ALR   @15,@14                                             0233 00787000
         LA    @14,MSG16-113(@15)                                  0233 00788000
         LA    @01,TABLE-1(K)                                      0233 00789000
         MVC   0(1,@14),0(@01)                                     0233 00790000
*       IF MERLICEB(I,J,K)=PHYSFMER /*                       #X50RSPC*/ 00791000
*         THEN                                                     0234 00792000
         LR    @14,I                                               0234 00793000
         SLA   @14,2                                               0234 00794000
         ALR   @14,J                                               0234 00795000
         SLA   @14,3                                               0234 00796000
         ALR   @14,K                                               0234 00797000
         ALR   @14,@14                                             0234 00798000
         ALR   @14,R4                                              0234 00799000
         TM    MERLICEB-82(@14),B'10000000'                        0234 00800000
         BNO   @RF00234                                            0234 00801000
         TM    MERLICEB-82(@14),B'01000000'                        0234 00802000
         BNZ   @RF00234                                            0234 00803000
*         DO;                       /*                       @XD00153*/ 00804000
*           MSG16(103*K+24*J-108:103*K+24*J-103)='3330-1';/* @XD00153*/ 00805000
         LA    @14,MSG16-109(@15)                                  0236 00806000
         MVC   0(6,@14),@CC00528                                   0236 00807000
*         END;                      /*                       @XD00153*/ 00808000
*       IF MERLICEB(I,J,K)=PHYSFICE /*                       #X50RSPC*/ 00809000
*         THEN                                                     0238 00810000
@RF00234 LR    @15,I                                               0238 00811000
         SLA   @15,2                                               0238 00812000
         ALR   @15,J                                               0238 00813000
         SLA   @15,3                                               0238 00814000
         ALR   @15,K                                               0238 00815000
         ALR   @15,@15                                             0238 00816000
         ALR   @15,R4                                              0238 00817000
         TM    MERLICEB-82(@15),B'01000000'                        0238 00818000
         BNO   @RF00238                                            0238 00819000
         TM    MERLICEB-82(@15),B'10000000'                        0238 00820000
         BNZ   @RF00238                                            0238 00821000
*         DO;                       /*                       @XD00153*/ 00822000
*           MSG16(103*K+24*J-108:103*K+24*J-102)='3330-11';/*      0240 00823000
*                                                            @XD00153*/ 00824000
         LR    @15,K                                               0240 00825000
         MH    @15,@CH00329                                        0240 00826000
         LR    @14,J                                               0240 00827000
         MH    @14,@CH00269                                        0240 00828000
         ALR   @15,@14                                             0240 00829000
         LA    @14,MSG16-109(@15)                                  0240 00830000
         MVC   0(7,@14),@CC00530                                   0240 00831000
*         END;                      /*                       @XD00153*/ 00832000
*       IF MERLICEB(I,J,K)=PHYSFMAD /*                       #X50RSPC*/ 00833000
*         THEN                      /*                       #X50RSPC*/ 00834000
@RF00238 LR    @15,I                                               0242 00835000
         SLA   @15,2                                               0242 00836000
         ALR   @15,J                                               0242 00837000
         SLA   @15,3                                               0242 00838000
         ALR   @15,K                                               0242 00839000
         ALR   @15,@15                                             0242 00840000
         ALR   @15,R4                                              0242 00841000
         TM    MERLICEB-82(@15),B'11000000'                        0242 00842000
         BNO   @RF00242                                            0242 00843000
*         DO;                       /*                       #X50RSPC*/ 00844000
*           MSG16(103*K+24*J-108:103*K+24*J-105)='3350';/*   #X50RSPC*/ 00845000
         LR    @15,K                                               0244 00846000
         MH    @15,@CH00329                                        0244 00847000
         LR    @14,J                                               0244 00848000
         MH    @14,@CH00269                                        0244 00849000
         ALR   @15,@14                                             0244 00850000
         LA    @14,MSG16-109(@15)                                  0244 00851000
         MVC   0(4,@14),@CC00532                                   0244 00852000
*         END;                      /*                       #X50RSPC*/ 00853000
*       IF MSG16(103*K+24*J-108)=' '/*                       @XD00153*/ 00854000
*         THEN                                                     0246 00855000
@RF00242 LR    @15,K                                               0246 00856000
         MH    @15,@CH00329                                        0246 00857000
         LR    @14,J                                               0246 00858000
         MH    @14,@CH00269                                        0246 00859000
         ALR   @15,@14                                             0246 00860000
         LA    @14,MSG16-109(@15)                                  0246 00861000
         CLI   0(@14),C' '                                         0246 00862000
         BNE   @RF00246                                            0246 00863000
*         DO;                       /*                       @XD00153*/ 00864000
*           MSG16(103*K+24*J-108:103*K+24*J-103)='*****';/*  @XD00153*/ 00865000
         LA    @14,MSG16-109(@15)                                  0248 00866000
         MVI   5(@14),C' '                                         0248 00867000
         MVC   0(5,@14),@CC00534                                   0248 00868000
*           SWITCH1=SWITCH1+1;      /*                       @XD00153*/ 00869000
         LA    SWITCH1,1(,SWITCH1)                                 0249 00870000
*         END;                      /*                       @XD00153*/ 00871000
*       IF PHYSSSID(I,J,K)='1'B THEN                               0251 00872000
@RF00246 LR    @15,I                                               0251 00873000
         SLA   @15,2                                               0251 00874000
         ALR   @15,J                                               0251 00875000
         SLA   @15,3                                               0251 00876000
         ALR   @15,K                                               0251 00877000
         ALR   @15,@15                                             0251 00878000
         ST    @15,@TF00001                                        0251 00879000
         ALR   @15,R4                                              0251 00880000
         TM    PHYSSSID-82(@15),B'00010000'                        0251 00881000
         BNO   @RF00251                                            0251 00882000
*         DO;                       /*                       @XD00153*/ 00883000
*           MSG16(103*K+24*J-98)='0';/*                      @XD00153*/ 00884000
         LR    @15,K                                               0253 00885000
         MH    @15,@CH00329                                        0253 00886000
         LR    @14,J                                               0253 00887000
         MH    @14,@CH00269                                        0253 00888000
         ALR   @15,@14                                             0253 00889000
         LA    @14,MSG16-99(@15)                                   0253 00890000
         MVI   0(@14),C'0'                                         0253 00891000
*           MSG16(103*K+24*J-97)=TABLE((SPNRSGNO(I,J,K)/2)//16+1);/*    00892000
*                                                            @XD00153*/ 00893000
         LA    @14,MSG16-98(@15)                                   0254 00894000
         L     @01,@TF00001                                        0254 00895000
         SLR   @09,@09                                             0254 00896000
         IC    @09,SPNRSGNO-82(@01,R4)                             0254 00897000
         LR    @08,@09                                             0254 00898000
         SRL   @08,1                                               0254 00899000
         ST    @09,@TF00002                                        0254 00900000
         SRDA  @08,32                                              0254 00901000
         D     @08,@CF00164                                        0254 00902000
         LA    @09,TABLE(@08)                                      0254 00903000
         MVC   0(1,@14),0(@09)                                     0254 00904000
*           MSG16(103*K+24*J-96)=TABLE((SPNRSGNO(I,J,K)//2)*8+PHYSFLGS( 00905000
*               I,J,K)//8+1);       /*                       @XD00153*/ 00906000
         LA    @14,MSG16-97(@15)                                   0255 00907000
         L     @00,@TF00002                                        0255 00908000
         SRDA  @00,32                                              0255 00909000
         D     @00,@CF00052                                        0255 00910000
         SLA   @00,3                                               0255 00911000
         L     @01,@TF00001                                        0255 00912000
         SLR   @08,@08                                             0255 00913000
         IC    @08,PHYSFLGS-82(@01,R4)                             0255 00914000
         SRDA  @08,32                                              0255 00915000
         D     @08,@CF00042                                        0255 00916000
         ALR   @00,@08                                             0255 00917000
         LR    @15,@00                                             0255 00918000
         LA    @01,TABLE(@15)                                      0255 00919000
         MVC   0(1,@14),0(@01)                                     0255 00920000
*         END;                      /*                       @XD00153*/ 00921000
*       ELSE                                                       0257 00922000
*         DO;                       /*                       @XD00153*/ 00923000
         B     @RC00251                                            0257 00924000
@RF00251 DS    0H                                                  0258 00925000
*           MSG16(103*K+24*J-98:103*K+24*J-96)='***';              0258 00926000
         LR    @15,K                                               0258 00927000
         MH    @15,@CH00329                                        0258 00928000
         LR    @14,J                                               0258 00929000
         MH    @14,@CH00269                                        0258 00930000
         ALR   @15,@14                                             0258 00931000
         LA    @14,MSG16-99(@15)                                   0258 00932000
         MVC   0(3,@14),@CC00536                                   0258 00933000
*           SWITCH=SWITCH+1;        /*                       @XD00153*/ 00934000
         LA    SWITCH,1(,SWITCH)                                   0259 00935000
*         END;                      /*                       @XD00153*/ 00936000
*     END;                          /*                       @XD00153*/ 00937000
@RC00251 AH    K,@CH00044                                          0261 00938000
         CH    K,@CH00042                                          0261 00939000
         BNH   @DL00232                                            0261 00940000
*     IF SWITCH=8 THEN                                             0262 00941000
         CH    SWITCH,@CH00042                                     0262 00942000
         BNE   @RF00262                                            0262 00943000
*       DO K=1 TO 8;                /*                       @XD00153*/ 00944000
         LA    K,1                                                 0263 00945000
@DL00263 DS    0H                                                  0264 00946000
*         MSG16(103*K+24*J-98:103*K+24*J-96)='';                   0264 00947000
         LR    @03,K                                               0264 00948000
         MH    @03,@CH00329                                        0264 00949000
         LR    @15,J                                               0264 00950000
         MH    @15,@CH00269                                        0264 00951000
         ALR   @03,@15                                             0264 00952000
         LA    @01,MSG16-99(@03)                                   0264 00953000
         MVI   0(@01),C' '                                         0264 00954000
         MVC   1(2,@01),0(@01)                                     0264 00955000
*       END;                        /*                       @XD00153*/ 00956000
         AH    K,@CH00044                                          0265 00957000
         CH    K,@CH00042                                          0265 00958000
         BNH   @DL00263                                            0265 00959000
*     IF SWITCH1=8 THEN                                            0266 00960000
@RF00262 CH    SWITCH1,@CH00042                                    0266 00961000
         BNE   @RF00266                                            0266 00962000
*       DO K=1 TO 8;                /*                       @XD00153*/ 00963000
         LA    K,1                                                 0267 00964000
@DL00267 DS    0H                                                  0268 00965000
*         MSG16(103*K+24*J-108:103*K+24*J-103)='';                 0268 00966000
         LR    @07,K                                               0268 00967000
         MH    @07,@CH00329                                        0268 00968000
         LR    @03,J                                               0268 00969000
         MH    @03,@CH00269                                        0268 00970000
         ALR   @07,@03                                             0268 00971000
         LA    @03,MSG16-109(@07)                                  0268 00972000
         MVI   0(@03),C' '                                         0268 00973000
         MVC   1(5,@03),0(@03)                                     0268 00974000
*       END;                        /*                       @XD00153*/ 00975000
         AH    K,@CH00044                                          0269 00976000
         CH    K,@CH00042                                          0269 00977000
         BNH   @DL00267                                            0269 00978000
*     SWITCH=0;                     /*                       @XD00153*/ 00979000
@RF00266 SLR   SWITCH,SWITCH                                       0270 00980000
*     SWITCH1=0;                    /*                       @XD00153*/ 00981000
         SLR   SWITCH1,SWITCH1                                     0271 00982000
*   END;                            /*                       @XD00153*/ 00983000
         AH    J,@CH00044                                          0272 00984000
         CH    J,@CH00070                                          0272 00985000
         BNH   @DL00231                                            0272 00986000
*   END MAINBOD2;                   /*                       @XD00153*/ 00987000
@EL00005 DS    0H                                                  0273 00988000
@EF00005 DS    0H                                                  0273 00989000
@ER00005 LM    @14,@02,@SA00005                                    0273 00990000
         LM    @04,@06,@SA00005+20                                 0273 00991000
         LM    @08,@12,@SA00005+32                                 0273 00992000
         BR    @14                                                 0273 00993000
*                                                                  0274 00994000
*/***********************************************************@XD00153*/ 00995000
*/*                                                          @XD00153*/ 00996000
*/* PROCEDURE NAME - PRNTBOD2                                @XD00153*/ 00997000
*/*                                                          @XD00153*/ 00998000
*/* FUNCTION - THIS ROUTINE PRINTS THE MAIN BODY OF THE      @XD00153*/ 00999000
*/*            SECOND PART OF THE REPORT.  MSG16 IS BROKEN   @XD00153*/ 01000000
*/*            INTO 8 SEGMENTS AND PRINTED BY A CALL TO      @XD00153*/ 01001000
*/*            PRINT1.                                       @XD00153*/ 01002000
*/*                                                          @XD00153*/ 01003000
*/***********************************************************@XD00153*/ 01004000
*                                                                  0274 01005000
*PRNTBOD2:                                                         0274 01006000
*   PROCEDURE;                      /*                       @XD00153*/ 01007000
PRNTBOD2 STM   @14,@12,@SA00006                                    0274 01008000
*   DO L=0 TO 7;                    /*                       @XD00153*/ 01009000
         SLR   L,L                                                 0275 01010000
@DL00275 DS    0H                                                  0276 01011000
*     OUTBUF2(1:103)=MSG16(103*L+1:103*L+103);/*             @XD00153*/ 01012000
         LR    @05,L                                               0276 01013000
         MH    @05,@CH00329                                        0276 01014000
         LA    @02,MSG16(@05)                                      0276 01015000
         MVC   OUTBUF2(103,R4),0(@02)                              0276 01016000
*     CALL PRINT1;                  /* PRINT A LINE          @XD00153*/ 01017000
         BAL   @14,PRINT1                                          0277 01018000
*   END;                            /*                       @XD00153*/ 01019000
         AH    L,@CH00044                                          0278 01020000
         CH    L,@CH00135                                          0278 01021000
         BNH   @DL00275                                            0278 01022000
*   END PRNTBOD2;                   /*                       @XD00153*/ 01023000
@EL00006 DS    0H                                                  0279 01024000
@EF00006 DS    0H                                                  0279 01025000
@ER00006 LM    @14,@12,@SA00006                                    0279 01026000
         BR    @14                                                 0279 01027000
*                                                                  0280 01028000
*/***********************************************************@XD00153*/ 01029000
*/*                                                          @XD00153*/ 01030000
*/* PROCEDURE NAME - CHECKDS2                                @XD00153*/ 01031000
*/*                                                          @XD00153*/ 01032000
*/* FUNCTION - THIS ROUTINE CHECKS TO SEE IF THE SECOND DATA @XD00153*/ 01033000
*/*            STAGER IS THERE. IF IT IS NOT, THEN THE SHORT @XD00153*/ 01034000
*/*            FORM OF THE HEADERS ARE USED FOR THE REPORT.  @XD00153*/ 01035000
*/*            MSG3 & MSG4 ARE USED FOR THE LONG FORM, OR    @XD00153*/ 01036000
*/*            MSG7 & MSG8 ARE USED FOR THE SHORT FORM.      @XD00153*/ 01037000
*/*            CALLS ARE MADE TO 'GETCPUID' TO UNPACK THE    @XD00153*/ 01038000
*/*            CPU ID AND PLACE IT IN THE APPROPRIATE        @XD00153*/ 01039000
*/*            MESSAGE AND IN THE APPROPRIATE PLACE.         @XD00153*/ 01040000
*/*                                                          @XD00153*/ 01041000
*/***********************************************************@XD00153*/ 01042000
*                                                                  0280 01043000
*CHECKDS2:                                                         0280 01044000
*   PROCEDURE;                      /*                       @XD00153*/ 01045000
CHECKDS2 STM   @14,@12,@SA00007                                    0280 01046000
*   CONTRLR=CNTRTABL(J);            /* SET CONTROLLER VALUE  @XD00153*/ 01047000
         LR    @03,J                                               0281 01048000
         ALR   @03,@03                                             0281 01049000
         LA    @01,CNTRTABL-2(@03)                                 0281 01050000
         MVC   CONTRLR(2),0(@01)                                   0281 01051000
*   OUTBUF2(1:19)=MSG2;             /*                       @Y30LB14*/ 01052000
         MVC   OUTBUF2(19,R4),MSG2                                 0282 01053000
*   CALL PRINT1;                    /* PRINT A LINE          @Y30LB14*/ 01054000
         BAL   @14,PRINT1                                          0283 01055000
*   LINECTR=LINECTR+1;              /* ACCOUNT FOR BLANK LINE      0284 01056000
*                                                            @Y30LB14*/ 01057000
         LA    @03,1                                               0284 01058000
         AH    @03,LINECTR(,R4)                                    0284 01059000
         STH   @03,LINECTR(,R4)                                    0284 01060000
*   MSG3(53)=TABLE(I);              /* SET 1ST DATA STAGER NUMBER  0285 01061000
*                                                            @Y30LB14*/ 01062000
         LA    @03,TABLE-1(I)                                      0285 01063000
         MVC   MSG3+52(1),0(@03)                                   0285 01064000
*   MSG7(53)=TABLE(I);              /*                       @Y30LB14*/ 01065000
         LA    @03,TABLE-1(I)                                      0286 01066000
         MVC   MSG7+52(1),0(@03)                                   0286 01067000
*   IF PHYSDS2(I,J)='FF'X THEN                                     0287 01068000
         LR    @03,I                                               0287 01069000
         SLA   @03,2                                               0287 01070000
         ALR   @03,J                                               0287 01071000
         ALR   @03,R4                                              0287 01072000
         CLI   PHYSDS2-5(@03),X'FF'                                0287 01073000
         BNE   @RF00287                                            0287 01074000
*     DO;                           /*                       @Y30LB14*/ 01075000
*       OUTBUF2(1:62)=MSG7;         /*                       @Y30LB14*/ 01076000
         MVC   OUTBUF2(62,R4),MSG7                                 0289 01077000
*       CALL PRINT1;                /* PRINT A LINE          @Y30LB14*/ 01078000
         BAL   @14,PRINT1                                          0290 01079000
*       OUTBUF2(1:60)=MSG8;         /*                       @Y30LB14*/ 01080000
         MVC   OUTBUF2(60,R4),MSG8                                 0291 01081000
*       CALL PRINT1;                /* PRINT A LINE          @Y30LB14*/ 01082000
         BAL   @14,PRINT1                                          0292 01083000
*       N=17;                       /* OFFSET IN OUTPUT LINE @Y30LB14*/ 01084000
         LA    N,17                                                0293 01085000
*       M=I;                        /* INDEX FOR RSGCPUID    @Y30LB14*/ 01086000
         LR    M,I                                                 0294 01087000
*     END;                          /*                       @Y30LB14*/ 01088000
*   ELSE                            /* 2ND DS AVAIL, LONG FORMAT USED   01089000
*                                                            @Y30LB14*/ 01090000
*     DO;                           /*                       @Y30LB14*/ 01091000
         B     @RC00287                                            0296 01092000
@RF00287 DS    0H                                                  0297 01093000
*       MSG3(92)=TABLE(PHYSDS2(I,J)+1);/*                    @Y30LB14*/ 01094000
         LR    @03,I                                               0297 01095000
         SLA   @03,2                                               0297 01096000
         ALR   @03,J                                               0297 01097000
         SLR   @01,@01                                             0297 01098000
         IC    @01,PHYSDS2-5(@03,R4)                               0297 01099000
         LA    @03,TABLE(@01)                                      0297 01100000
         MVC   MSG3+91(1),0(@03)                                   0297 01101000
*       OUTBUF2(1:101)=MSG3;        /*                       @Y30LB14*/ 01102000
         MVC   OUTBUF2(101,R4),MSG3                                0298 01103000
*       CALL PRINT1;                /* PRINT A LINE          @Y30LB14*/ 01104000
         BAL   @14,PRINT1                                          0299 01105000
*       OUTBUF2(1:99)=MSG4;         /*                       @Y30LB14*/ 01106000
         MVC   OUTBUF2(99,R4),MSG4                                 0300 01107000
*       CALL PRINT1;                /* PRINT A LINE          @Y30LB14*/ 01108000
         BAL   @14,PRINT1                                          0301 01109000
*       LINECTR=LINECTR+1;          /* ACCNT FOR BLNK LN     @Y30LB14*/ 01110000
         LA    @09,1                                               0302 01111000
         AH    @09,LINECTR(,R4)                                    0302 01112000
         STH   @09,LINECTR(,R4)                                    0302 01113000
*       N=17;                       /* OFFSET IN OUTPUT LINE @Y30LB14*/ 01114000
         LA    N,17                                                0303 01115000
*       M=I;                        /* INDEX FOR RSGCPUID    @Y30LB14*/ 01116000
         LR    M,I                                                 0304 01117000
*       CALL GETCPUID;              /* GET CPU ID            @Y30LB14*/ 01118000
         BAL   @14,GETCPUID                                        0305 01119000
*       N=56;                       /* OFFSET FOR 2ND SET CPUIDS   0306 01120000
*                                                            @Y30LB14*/ 01121000
         LA    N,56                                                0306 01122000
*       M=PHYSDS2(I,J)+1;           /*                       @Y30LB14*/ 01123000
         LR    @09,I                                               0307 01124000
         SLA   @09,2                                               0307 01125000
         ALR   @09,J                                               0307 01126000
         LA    M,1                                                 0307 01127000
         ALR   @09,R4                                              0307 01128000
         MVC   @ZT00003+3(1),PHYSDS2-5(@09)                        0307 01129000
         AL    M,@ZT00003                                          0307 01130000
*     END;                          /*                       @Y30LB14*/ 01131000
*   CALL GETCPUID;                  /* GET CPU ID            @Y30LB14*/ 01132000
@RC00287 BAL   @14,GETCPUID                                        0309 01133000
*   OUTBUF2(1:101)=MSG5;            /* CPUID LINE            @Y30LB14*/ 01134000
         MVC   OUTBUF2(101,R4),MSG5                                0310 01135000
*   CALL PRINT1;                    /* PRINT A LINE          @Y30LB14*/ 01136000
         BAL   @14,PRINT1                                          0311 01137000
*   CPUIDS='';                      /* BLANK OUT CPUIDS IN MSG5    0312 01138000
*                                                            @Y30LB14*/ 01139000
*                                                                  0312 01140000
         MVI   CPUIDS,C' '                                         0312 01141000
         MVC   CPUIDS+1(73),CPUIDS                                 0312 01142000
*   /*****************************************************************/ 01143000
*   /*                                                               */ 01144000
*   /* ***********************************************       @ZD02028*/ 01145000
*   /* CALL PROCEDURE PRTOPSYS TO DETERMINE WHICH            @ZD02028*/ 01146000
*   /* OPERATING SYSTEM IS TO USE THIS CPU.                  @ZD02028*/ 01147000
*   /* ***********************************************       @ZD02028*/ 01148000
*   /*                                                               */ 01149000
*   /*****************************************************************/ 01150000
*                                                                  0313 01151000
*   CALL PRTOPSYS;                  /*                       @ZD02028*/ 01152000
         BAL   @14,PRTOPSYS                                        0313 01153000
*   END CHECKDS2;                   /*                       @Y30LB14*/ 01154000
@EL00007 DS    0H                                                  0314 01155000
@EF00007 DS    0H                                                  0314 01156000
@ER00007 LM    @14,@12,@SA00007                                    0314 01157000
         BR    @14                                                 0314 01158000
*                                                                  0315 01159000
*/********************************************************** @ZD02028*/ 01160000
*/*                                                          @ZD02028*/ 01161000
*/* PROCEDURE NAME - PRTOPSYS                                @ZD02028*/ 01162000
*/*                                                          @ZD02028*/ 01163000
*/* FUNCTION - DETERMINE WHICH OPERATING SYSTEM WAS          @ZD02028*/ 01164000
*/*            SPECIFIED FOR THIS CPU, AND PRINT THE         @ZD02028*/ 01165000
*/*            DESIGNATION UNDER THE CPUID.                  @ZD02028*/ 01166000
*/*                                                          @ZD02028*/ 01167000
*/********************************************************** @ZD02028*/ 01168000
*                                                                  0315 01169000
*PRTOPSYS:                                                         0315 01170000
*   PROCEDURE;                      /*                       @ZD02028*/ 01171000
PRTOPSYS STM   @14,@12,@SA00008                                    0315 01172000
*   M=(I-1)*3;                      /*                       @ZD02028*/ 01173000
*                                                                  0316 01174000
         LR    M,I                                                 0316 01175000
         BCTR  M,0                                                 0316 01176000
         MH    M,@CH00050                                          0316 01177000
*   /*****************************************************************/ 01178000
*   /*                                                               */ 01179000
*   /* ***********************************************       @ZD02028*/ 01180000
*   /* CHANNEL INTERFACE 'B' FOR FIRST STAGING               @ZD02028*/ 01181000
*   /* ADAPTER.                                              @ZD02028*/ 01182000
*   /* ***********************************************       @ZD02028*/ 01183000
*   /*                                                               */ 01184000
*   /*****************************************************************/ 01185000
*                                                                  0317 01186000
*   IF CISPEC(M+1)='1'B             /*                       @ZD02028*/ 01187000
*     THEN                          /*                       @ZD02028*/ 01188000
         LR    @06,M                                               0317 01189000
         MH    @06,@CH00114                                        0317 01190000
         L     @03,COMPTR2(,R4)                                    0317 01191000
         ST    @06,@TF00001                                        0317 01192000
         ALR   @06,@03                                             0317 01193000
         TM    CISPEC(@06),B'10000000'                             0317 01194000
         BNO   @RF00317                                            0317 01195000
*     DO;                           /*                       @ZD02028*/ 01196000
*       IF OPVS1(CPUREFNO(M+1)+1)='1'B/*                     @ZD02028*/ 01197000
*         THEN                      /*                       @ZD02028*/ 01198000
         L     @06,@TF00001                                        0319 01199000
         SLR   @15,@15                                             0319 01200000
         IC    @15,CPUREFNO(@06,@03)                               0319 01201000
         SLA   @15,3                                               0319 01202000
         ALR   @15,R4                                              0319 01203000
         TM    OPVS1(@15),B'00010000'                              0319 01204000
         BNO   @RF00319                                            0319 01205000
*         OUTBUF2(31:36)='OS/VS1';  /*                       @ZD02028*/ 01206000
         MVC   OUTBUF2+30(6,R4),@CC00550                           0320 01207000
*       IF OPVS2(CPUREFNO(M+1)+1)='1'B/*                     @ZD02028*/ 01208000
*         THEN                      /*                       @ZD02028*/ 01209000
@RF00319 LR    @06,M                                               0321 01210000
         MH    @06,@CH00114                                        0321 01211000
         L     @03,COMPTR2(,R4)                                    0321 01212000
         SLR   @15,@15                                             0321 01213000
         IC    @15,CPUREFNO(@06,@03)                               0321 01214000
         SLA   @15,3                                               0321 01215000
         ALR   @15,R4                                              0321 01216000
         TM    OPVS2(@15),B'00001000'                              0321 01217000
         BNO   @RF00321                                            0321 01218000
*         OUTBUF2(31:36)='OS/VS2';  /*                       @ZD02028*/ 01219000
         MVC   OUTBUF2+30(6,R4),@CC00551                           0322 01220000
*     END;                          /*                       @ZD02028*/ 01221000
*   ELSE                                                           0324 01222000
*     ;                             /*                       @ZD02028*/ 01223000
*                                                                  0324 01224000
@RF00317 DS    0H                                                  0325 01225000
*   /*****************************************************************/ 01226000
*   /*                                                               */ 01227000
*   /* ***********************************************       @ZD02028*/ 01228000
*   /* CHANNEL INTERFACE 'C' FOR FIRST STAGING               @ZD02028*/ 01229000
*   /* ADAPTER.                                              @ZD02028*/ 01230000
*   /* ***********************************************       @ZD02028*/ 01231000
*   /*                                                               */ 01232000
*   /*****************************************************************/ 01233000
*                                                                  0325 01234000
*   IF CISPEC(M+2)='1'B             /*                       @ZD02028*/ 01235000
*     THEN                          /*                       @ZD02028*/ 01236000
@RC00317 LR    @06,M                                               0325 01237000
         MH    @06,@CH00114                                        0325 01238000
         L     @03,COMPTR2(,R4)                                    0325 01239000
         ST    @06,@TF00001                                        0325 01240000
         ALR   @06,@03                                             0325 01241000
         TM    CISPEC+9(@06),B'10000000'                           0325 01242000
         BNO   @RF00325                                            0325 01243000
*     DO;                           /*                       @ZD02028*/ 01244000
*       IF OPVS1(CPUREFNO(M+2)+1)='1'B/*                     @ZD02028*/ 01245000
*         THEN                      /*                       @ZD02028*/ 01246000
         L     @06,@TF00001                                        0327 01247000
         SLR   @15,@15                                             0327 01248000
         IC    @15,CPUREFNO+9(@06,@03)                             0327 01249000
         SLA   @15,3                                               0327 01250000
         ALR   @15,R4                                              0327 01251000
         TM    OPVS1(@15),B'00010000'                              0327 01252000
         BNO   @RF00327                                            0327 01253000
*         OUTBUF2(43:48)='OS/VS1';  /*                       @ZD02028*/ 01254000
         MVC   OUTBUF2+42(6,R4),@CC00550                           0328 01255000
*       IF OPVS2(CPUREFNO(M+2)+1)='1'B/*                     @ZD02028*/ 01256000
*         THEN                      /*                       @ZD02028*/ 01257000
@RF00327 LR    @06,M                                               0329 01258000
         MH    @06,@CH00114                                        0329 01259000
         L     @03,COMPTR2(,R4)                                    0329 01260000
         SLR   @15,@15                                             0329 01261000
         IC    @15,CPUREFNO+9(@06,@03)                             0329 01262000
         SLA   @15,3                                               0329 01263000
         ALR   @15,R4                                              0329 01264000
         TM    OPVS2(@15),B'00001000'                              0329 01265000
         BNO   @RF00329                                            0329 01266000
*         OUTBUF2(43:48)='OS/VS2';  /*                       @ZD02028*/ 01267000
         MVC   OUTBUF2+42(6,R4),@CC00551                           0330 01268000
*     END;                          /*                       @ZD02028*/ 01269000
*   ELSE                                                           0332 01270000
*     ;                             /*                       @ZD02028*/ 01271000
*                                                                  0332 01272000
@RF00325 DS    0H                                                  0333 01273000
*   /*****************************************************************/ 01274000
*   /*                                                               */ 01275000
*   /* ***********************************************       @ZD02028*/ 01276000
*   /* CHANNEL INTERFACE 'D' FOR FIRST STAGING               @ZD02028*/ 01277000
*   /* ADAPTER.                                              @ZD02028*/ 01278000
*   /* ***********************************************       @ZD02028*/ 01279000
*   /*                                                               */ 01280000
*   /*****************************************************************/ 01281000
*                                                                  0333 01282000
*   IF CISPEC(M+3)='1'B             /*                       @ZD02028*/ 01283000
*     THEN                          /*                       @ZD02028*/ 01284000
@RC00325 LR    @06,M                                               0333 01285000
         MH    @06,@CH00114                                        0333 01286000
         L     @03,COMPTR2(,R4)                                    0333 01287000
         ST    @06,@TF00001                                        0333 01288000
         ALR   @06,@03                                             0333 01289000
         TM    CISPEC+18(@06),B'10000000'                          0333 01290000
         BNO   @RF00333                                            0333 01291000
*     DO;                           /*                       @ZD02028*/ 01292000
*       IF OPVS1(CPUREFNO(M+3)+1)='1'B/*                     @ZD02028*/ 01293000
*         THEN                      /*                       @ZD02028*/ 01294000
         L     @06,@TF00001                                        0335 01295000
         SLR   @15,@15                                             0335 01296000
         IC    @15,CPUREFNO+18(@06,@03)                            0335 01297000
         SLA   @15,3                                               0335 01298000
         ALR   @15,R4                                              0335 01299000
         TM    OPVS1(@15),B'00010000'                              0335 01300000
         BNO   @RF00335                                            0335 01301000
*         OUTBUF2(55:60)='OS/VS1';  /*                       @ZD02028*/ 01302000
         MVC   OUTBUF2+54(6,R4),@CC00550                           0336 01303000
*       IF OPVS2(CPUREFNO(M+3)+1)='1'B/*                     @ZD02028*/ 01304000
*         THEN                      /*                       @ZD02028*/ 01305000
@RF00335 LR    @06,M                                               0337 01306000
         MH    @06,@CH00114                                        0337 01307000
         L     @03,COMPTR2(,R4)                                    0337 01308000
         SLR   @15,@15                                             0337 01309000
         IC    @15,CPUREFNO+18(@06,@03)                            0337 01310000
         SLA   @15,3                                               0337 01311000
         ALR   @15,R4                                              0337 01312000
         TM    OPVS2(@15),B'00001000'                              0337 01313000
         BNO   @RF00337                                            0337 01314000
*         OUTBUF2(55:60)='OS/VS2';  /*                       @ZD02028*/ 01315000
         MVC   OUTBUF2+54(6,R4),@CC00551                           0338 01316000
*     END;                          /*                       @ZD02028*/ 01317000
*   ELSE                                                           0340 01318000
*     ;                             /*                       @ZD02028*/ 01319000
*                                                                  0340 01320000
@RF00333 DS    0H                                                  0341 01321000
*   /*****************************************************************/ 01322000
*   /*                                                               */ 01323000
*   /* ***********************************************       @ZD02028*/ 01324000
*   /* CHECK FOR SECOND STAGING ADAPTER. IF NO               @ZD02028*/ 01325000
*   /* SECOND STAGING ADAPTER, PRINT LINE AND RETURN.        @ZD02028*/ 01326000
*   /* OTHERWISE, PICK UP OPERATING SYSTEM FOR CPUS          @ZD02028*/ 01327000
*   /* ON SECOND STAGING ADAPTER.                            @ZD02028*/ 01328000
*   /* ***********************************************       @ZD02028*/ 01329000
*   /*                                                               */ 01330000
*   /*****************************************************************/ 01331000
*                                                                  0341 01332000
*   IF PHYSDS2(I,J)='FF'X           /*                       @ZD02028*/ 01333000
*     THEN                          /*                       @ZD02028*/ 01334000
@RC00333 LR    @03,I                                               0341 01335000
         SLA   @03,2                                               0341 01336000
         ALR   @03,J                                               0341 01337000
         ALR   @03,R4                                              0341 01338000
         CLI   PHYSDS2-5(@03),X'FF'                                0341 01339000
         BNE   @RF00341                                            0341 01340000
*     DO;                           /*                       @ZD02028*/ 01341000
*       CALL PRINT1;                /*                       @ZD02028*/ 01342000
         BAL   @14,PRINT1                                          0343 01343000
*       RETURN;                     /*                       @ZD02028*/ 01344000
@EL00008 DS    0H                                                  0344 01345000
@EF00008 DS    0H                                                  0344 01346000
@ER00008 LM    @14,@12,@SA00008                                    0344 01347000
         BR    @14                                                 0344 01348000
*     END;                          /*                       @ZD02028*/ 01349000
*   ELSE                            /*                       @ZD02028*/ 01350000
*     DO;                           /*                       @ZD02028*/ 01351000
@RF00341 DS    0H                                                  0347 01352000
*       M=PHYSDS2(I,J)+1;           /*                       @ZD02028*/ 01353000
         LR    @03,I                                               0347 01354000
         SLA   @03,2                                               0347 01355000
         ALR   @03,J                                               0347 01356000
         LA    M,1                                                 0347 01357000
         ALR   @03,R4                                              0347 01358000
         MVC   @ZT00003+3(1),PHYSDS2-5(@03)                        0347 01359000
         AL    M,@ZT00003                                          0347 01360000
*       M=(M-1)*3;                  /*                       @ZD02028*/ 01361000
         LR    @06,M                                               0348 01362000
         BCTR  @06,0                                               0348 01363000
         MH    @06,@CH00050                                        0348 01364000
         LR    M,@06                                               0348 01365000
*     END;                          /*                       @ZD02028*/ 01366000
*                                                                  0349 01367000
*   /*****************************************************************/ 01368000
*   /*                                                               */ 01369000
*   /* ***********************************************       @ZD02028*/ 01370000
*   /* CHANNEL INTERFACE 'B' FOR SECOND STAGING              @ZD02028*/ 01371000
*   /* ADAPTER.                                              @ZD02028*/ 01372000
*   /* ***********************************************       @ZD02028*/ 01373000
*   /*                                                               */ 01374000
*   /*****************************************************************/ 01375000
*                                                                  0350 01376000
*   IF CISPEC(M+1)='1'B             /*                       @ZD02028*/ 01377000
*     THEN                          /*                       @ZD02028*/ 01378000
         LR    @06,M                                               0350 01379000
         MH    @06,@CH00114                                        0350 01380000
         L     @03,COMPTR2(,R4)                                    0350 01381000
         ST    @06,@TF00001                                        0350 01382000
         ALR   @06,@03                                             0350 01383000
         TM    CISPEC(@06),B'10000000'                             0350 01384000
         BNO   @RF00350                                            0350 01385000
*     DO;                           /*                       @ZD02028*/ 01386000
*       IF OPVS1(CPUREFNO(M+1)+1)='1'B/*                     @ZD02028*/ 01387000
*         THEN                      /*                       @ZD02028*/ 01388000
         L     @06,@TF00001                                        0352 01389000
         SLR   @15,@15                                             0352 01390000
         IC    @15,CPUREFNO(@06,@03)                               0352 01391000
         SLA   @15,3                                               0352 01392000
         ALR   @15,R4                                              0352 01393000
         TM    OPVS1(@15),B'00010000'                              0352 01394000
         BNO   @RF00352                                            0352 01395000
*         OUTBUF2(70:75)='OS/VS1';  /*                       @ZD02028*/ 01396000
         MVC   OUTBUF2+69(6,R4),@CC00550                           0353 01397000
*       IF OPVS2(CPUREFNO(M+1)+1)='1'B/*                     @ZD02028*/ 01398000
*         THEN                      /*                       @ZD02028*/ 01399000
@RF00352 LR    @06,M                                               0354 01400000
         MH    @06,@CH00114                                        0354 01401000
         L     @03,COMPTR2(,R4)                                    0354 01402000
         SLR   @15,@15                                             0354 01403000
         IC    @15,CPUREFNO(@06,@03)                               0354 01404000
         SLA   @15,3                                               0354 01405000
         ALR   @15,R4                                              0354 01406000
         TM    OPVS2(@15),B'00001000'                              0354 01407000
         BNO   @RF00354                                            0354 01408000
*         OUTBUF2(70:75)='OS/VS2';  /*                       @ZD02028*/ 01409000
         MVC   OUTBUF2+69(6,R4),@CC00551                           0355 01410000
*     END;                          /*                       @ZD02028*/ 01411000
*   ELSE                                                           0357 01412000
*     ;                             /*                       @ZD02028*/ 01413000
*                                                                  0357 01414000
@RF00350 DS    0H                                                  0358 01415000
*   /*****************************************************************/ 01416000
*   /*                                                               */ 01417000
*   /* ***********************************************       @ZD02028*/ 01418000
*   /* CHANNEL INTERFACE 'C' FOR SECOND STAGING              @ZD02028*/ 01419000
*   /* ADAPTER.                                              @ZD02028*/ 01420000
*   /* ***********************************************       @ZD02028*/ 01421000
*   /*                                                               */ 01422000
*   /*****************************************************************/ 01423000
*                                                                  0358 01424000
*   IF CISPEC(M+2)='1'B             /*                       @ZD02028*/ 01425000
*     THEN                          /*                       @ZD02028*/ 01426000
@RC00350 LR    @06,M                                               0358 01427000
         MH    @06,@CH00114                                        0358 01428000
         L     @03,COMPTR2(,R4)                                    0358 01429000
         ST    @06,@TF00001                                        0358 01430000
         ALR   @06,@03                                             0358 01431000
         TM    CISPEC+9(@06),B'10000000'                           0358 01432000
         BNO   @RF00358                                            0358 01433000
*     DO;                           /*                       @ZD02028*/ 01434000
*       IF OPVS1(CPUREFNO(M+2)+1)='1'B/*                     @ZD02028*/ 01435000
*         THEN                      /*                       @ZD02028*/ 01436000
         L     @06,@TF00001                                        0360 01437000
         SLR   @15,@15                                             0360 01438000
         IC    @15,CPUREFNO+9(@06,@03)                             0360 01439000
         SLA   @15,3                                               0360 01440000
         ALR   @15,R4                                              0360 01441000
         TM    OPVS1(@15),B'00010000'                              0360 01442000
         BNO   @RF00360                                            0360 01443000
*         OUTBUF2(82:87)='OS/VS1';  /*                       @ZD02028*/ 01444000
         MVC   OUTBUF2+81(6,R4),@CC00550                           0361 01445000
*       IF OPVS2(CPUREFNO(M+2)+1)='1'B/*                     @ZD02028*/ 01446000
*         THEN                      /*                       @ZD02028*/ 01447000
@RF00360 LR    @06,M                                               0362 01448000
         MH    @06,@CH00114                                        0362 01449000
         L     @03,COMPTR2(,R4)                                    0362 01450000
         SLR   @15,@15                                             0362 01451000
         IC    @15,CPUREFNO+9(@06,@03)                             0362 01452000
         SLA   @15,3                                               0362 01453000
         ALR   @15,R4                                              0362 01454000
         TM    OPVS2(@15),B'00001000'                              0362 01455000
         BNO   @RF00362                                            0362 01456000
*         OUTBUF2(82:87)='OS/VS2';  /*                       @ZD02028*/ 01457000
         MVC   OUTBUF2+81(6,R4),@CC00551                           0363 01458000
*     END;                          /*                       @ZD02028*/ 01459000
*   ELSE                                                           0365 01460000
*     ;                             /*                       @ZD02028*/ 01461000
*                                                                  0365 01462000
@RF00358 DS    0H                                                  0366 01463000
*   /*****************************************************************/ 01464000
*   /*                                                               */ 01465000
*   /* ***********************************************       @ZD02028*/ 01466000
*   /* CHANNEL INTERFACE 'D' FOR SECOND STAGING              @ZD02028*/ 01467000
*   /* ADAPTER.                                              @ZD02028*/ 01468000
*   /* ***********************************************       @ZD02028*/ 01469000
*   /*                                                               */ 01470000
*   /*****************************************************************/ 01471000
*                                                                  0366 01472000
*   IF CISPEC(M+3)='1'B             /*                       @ZD02028*/ 01473000
*     THEN                          /*                       @ZD02028*/ 01474000
@RC00358 LR    @06,M                                               0366 01475000
         MH    @06,@CH00114                                        0366 01476000
         L     @03,COMPTR2(,R4)                                    0366 01477000
         ST    @06,@TF00001                                        0366 01478000
         ALR   @06,@03                                             0366 01479000
         TM    CISPEC+18(@06),B'10000000'                          0366 01480000
         BNO   @RF00366                                            0366 01481000
*     DO;                           /*                       @ZD02028*/ 01482000
*       IF OPVS1(CPUREFNO(M+3)+1)='1'B/*                     @ZD02028*/ 01483000
*         THEN                      /*                       @ZD02028*/ 01484000
         L     @06,@TF00001                                        0368 01485000
         SLR   @15,@15                                             0368 01486000
         IC    @15,CPUREFNO+18(@06,@03)                            0368 01487000
         SLA   @15,3                                               0368 01488000
         ALR   @15,R4                                              0368 01489000
         TM    OPVS1(@15),B'00010000'                              0368 01490000
         BNO   @RF00368                                            0368 01491000
*         OUTBUF2(94:99)='OS/VS1';  /*                       @ZD02028*/ 01492000
         MVC   OUTBUF2+93(6,R4),@CC00550                           0369 01493000
*       IF OPVS2(CPUREFNO(M+3)+1)='1'B/*                     @ZD02028*/ 01494000
*         THEN                      /*                       @ZD02028*/ 01495000
@RF00368 LR    @06,M                                               0370 01496000
         MH    @06,@CH00114                                        0370 01497000
         L     @03,COMPTR2(,R4)                                    0370 01498000
         SLR   @15,@15                                             0370 01499000
         IC    @15,CPUREFNO+18(@06,@03)                            0370 01500000
         SLA   @15,3                                               0370 01501000
         ALR   @15,R4                                              0370 01502000
         TM    OPVS2(@15),B'00001000'                              0370 01503000
         BNO   @RF00370                                            0370 01504000
*         OUTBUF2(94:99)='OS/VS2';  /*                       @ZD02028*/ 01505000
         MVC   OUTBUF2+93(6,R4),@CC00551                           0371 01506000
*     END;                          /*                       @ZD02028*/ 01507000
*   ELSE                                                           0373 01508000
*     ;                             /*                       @ZD02028*/ 01509000
@RF00366 DS    0H                                                  0374 01510000
*   CALL PRINT1;                    /*                       @ZD02028*/ 01511000
@RC00366 BAL   @14,PRINT1                                          0374 01512000
*   END PRTOPSYS;                   /*                       @ZD02028*/ 01513000
         B     @EL00008                                            0375 01514000
*                                                                  0376 01515000
*/***********************************************************@XD00153*/ 01516000
*/*                                                          @XD00153*/ 01517000
*/* PROCEDURE NAME - MAINBODY                                @XD00153*/ 01518000
*/*                                                          @XD00153*/ 01519000
*/* FUNCTION - THIS ROUTINE PRODUCES THE MAIN BODY OF THE    @XD00153*/ 01520000
*/*            FIRST SECTION OF THE REPORT.  IF THE DEVICE   @XD00153*/ 01521000
*/*            IS A MERLIN OR ICEBERG, THEN A LINE IS PRO-   @XD00153*/ 01522000
*/*            DUCED.  THE DEVICE PLUG NUMBER IS INSERTED    @XD00153*/ 01523000
*/*            AND '3330-1' IS INSERTED IF THE DEVICE IS A   @XD00153*/ 01524000
*/*            MERLIN OR '3330-11' IF THE DEVICE IS IN ICE-  @XD00153*/ 01525000
*/*            BERG.  THE SSID IS THEN DETERMINED IF IT      @XD00153*/ 01526000
*/*            EXISTS AND INSERTED IN THE SSID COLUMN.  IF   @XD00153*/ 01527000
*/*            IT DOESN'T EXIST, THEN '***' IS PUT IN THE    @XD00153*/ 01528000
*/*            COLUMN.  A CALL IS MADE TO 'CUDADDR' TO PRO-  @XD00153*/ 01529000
*/*            DUCE CHANNEL UNIT ADDRESS FOR THE STAGING     @XD00153*/ 01530000
*/*            ADAPTER LISTED IN THE LEFT COLUMN.  A CHECK   @XD00153*/ 01531000
*/*            IS MADE TO DETERMINE IF THE SECOND STAGING    @XD00153*/ 01532000
*/*            ADAPTER EXISTS, AND IF IT DOES, THEN A CALL   @XD00153*/ 01533000
*/*            IS MADE TO 'CUDADDR' AGAIN TO DETERMINE THE   @XD00153*/ 01534000
*/*            CHANNEL UNIT ADDRESS FOR THIS ADAPTER.  THE   @XD00153*/ 01535000
*/*            LINE IS THEN PRINTED AND MSG6 IS BLANKED OUT  @XD00153*/ 01536000
*/*            BEFORE INFORMATION FOR THE NEXT DEVICE PLUG   @XD00153*/ 01537000
*/*            IS INSERTED.                                  @XD00153*/ 01538000
*/*                                                          @XD00153*/ 01539000
*/***********************************************************@XD00153*/ 01540000
*                                                                  0376 01541000
*MAINBODY:                                                         0376 01542000
*   PROCEDURE;                      /*                       @XD00153*/ 01543000
MAINBODY STM   @14,@12,@SA00009                                    0376 01544000
*   DO K=1 TO 8;                    /*                       @XD00153*/ 01545000
         LA    K,1                                                 0377 01546000
@DL00377 DS    0H                                                  0378 01547000
*     IF MERLICEB(I,J,K)^=PHYSFNUL  /*                       @X50RSPC*/ 01548000
*       THEN                                                       0378 01549000
         LR    @07,I                                               0378 01550000
         SLA   @07,2                                               0378 01551000
         ALR   @07,J                                               0378 01552000
         SLA   @07,3                                               0378 01553000
         ALR   @07,K                                               0378 01554000
         ALR   @07,@07                                             0378 01555000
         ST    @07,@TF00001                                        0378 01556000
         ALR   @07,R4                                              0378 01557000
         TM    MERLICEB-82(@07),B'11000000'                        0378 01558000
         BZ    @RF00378                                            0378 01559000
*       DO;                         /*                       @XD00153*/ 01560000
*         MSG6(8)=TABLE(K);         /* DEVICE PLUG NUMBER    @XD00153*/ 01561000
         LA    @07,TABLE-1(K)                                      0380 01562000
         MVC   MSG6+7(1),0(@07)                                    0380 01563000
*         IF MERLICEB(I,J,K)=PHYSFMER/*                      @X50RSPC*/ 01564000
*           THEN                                                   0381 01565000
         LR    @07,R4                                              0381 01566000
         AL    @07,@TF00001                                        0381 01567000
         TM    MERLICEB-82(@07),B'10000000'                        0381 01568000
         BNO   @RF00381                                            0381 01569000
         TM    MERLICEB-82(@07),B'01000000'                        0381 01570000
         BNZ   @RF00381                                            0381 01571000
*           MSG6(14:19)='3330-1';   /*                       @XD00153*/ 01572000
         MVC   MSG6+13(6),@CC00528                                 0382 01573000
*         ELSE                                                     0383 01574000
*           IF MERLICEB(I,J,K)=PHYSFICE/*                    @X50RSPC*/ 01575000
*             THEN                  /*                       @X50RSPC*/ 01576000
         B     @RC00381                                            0383 01577000
@RF00381 LR    @07,I                                               0383 01578000
         SLA   @07,2                                               0383 01579000
         ALR   @07,J                                               0383 01580000
         SLA   @07,3                                               0383 01581000
         ALR   @07,K                                               0383 01582000
         ALR   @07,@07                                             0383 01583000
         ALR   @07,R4                                              0383 01584000
         TM    MERLICEB-82(@07),B'01000000'                        0383 01585000
         BNO   @RF00383                                            0383 01586000
         TM    MERLICEB-82(@07),B'10000000'                        0383 01587000
         BNZ   @RF00383                                            0383 01588000
*             MSG6(14:20)='3330-11';/*                       @X50RSPC*/ 01589000
         MVC   MSG6+13(7),@CC00530                                 0384 01590000
*           ELSE                    /*                       @X50RSPC*/ 01591000
*             MSG6(14:17)='3350';   /*                       @X50RSPC*/ 01592000
         B     @RC00383                                            0385 01593000
@RF00383 MVC   MSG6+13(4),@CC00532                                 0385 01594000
*         IF PHYSSSID(I,J,K)='1'B THEN                             0386 01595000
@RC00383 DS    0H                                                  0386 01596000
@RC00381 LR    @07,I                                               0386 01597000
         SLA   @07,2                                               0386 01598000
         ALR   @07,J                                               0386 01599000
         SLA   @07,3                                               0386 01600000
         ALR   @07,K                                               0386 01601000
         ALR   @07,@07                                             0386 01602000
         ST    @07,@TF00001                                        0386 01603000
         ALR   @07,R4                                              0386 01604000
         TM    PHYSSSID-82(@07),B'00010000'                        0386 01605000
         BNO   @RF00386                                            0386 01606000
*           DO;                     /*                       @XD00153*/ 01607000
*             MSG6(24)='0';         /*                       @XD00153*/ 01608000
         MVI   MSG6+23,C'0'                                        0388 01609000
*             MSG6(25)=TABLE((SPNRSGNO(I,J,K)/2)//16+1);           0389 01610000
         L     @07,@TF00001                                        0389 01611000
         SLR   @03,@03                                             0389 01612000
         IC    @03,SPNRSGNO-82(@07,R4)                             0389 01613000
         LR    @07,@03                                             0389 01614000
         SRL   @07,1                                               0389 01615000
         LR    @00,@07                                             0389 01616000
         SRDA  @00,32                                              0389 01617000
         D     @00,@CF00164                                        0389 01618000
         LR    @07,@00                                             0389 01619000
         LA    @01,TABLE(@07)                                      0389 01620000
         MVC   MSG6+24(1),0(@01)                                   0389 01621000
*             MSG6(26)=TABLE((SPNRSGNO(I,J,K)//2)*8+PHYSFLGS(I,J,K)//8+ 01622000
*                 1);               /*                       @XD00153*/ 01623000
         LR    @00,@03                                             0390 01624000
         SRDA  @00,32                                              0390 01625000
         D     @00,@CF00052                                        0390 01626000
         SLA   @00,3                                               0390 01627000
         L     @07,@TF00001                                        0390 01628000
         SLR   @08,@08                                             0390 01629000
         IC    @08,PHYSFLGS-82(@07,R4)                             0390 01630000
         SRDA  @08,32                                              0390 01631000
         D     @08,@CF00042                                        0390 01632000
         ALR   @00,@08                                             0390 01633000
         LR    @07,@00                                             0390 01634000
         LA    @03,TABLE(@07)                                      0390 01635000
         MVC   MSG6+25(1),0(@03)                                   0390 01636000
*           END;                    /*                       @XD00153*/ 01637000
*         ELSE                                                     0392 01638000
*           MSG6(24:26)='***';      /*                       @XD00153*/ 01639000
         B     @RC00386                                            0392 01640000
@RF00386 MVC   MSG6+23(3),@CC00536                                 0392 01641000
*         N=20;                     /*                       @XD00153*/ 01642000
@RC00386 LA    N,20                                                0393 01643000
*         M=I-1;                    /*                       @XD00153*/ 01644000
         LR    M,I                                                 0394 01645000
         BCTR  M,0                                                 0394 01646000
*         CALL CUDADDR;             /* CHANNEL UNIT DEVICE ADDR    0395 01647000
*                                                            @XD00153*/ 01648000
         BAL   @14,CUDADDR                                         0395 01649000
*         IF PHYSDS2(I,J)^='FF'X THEN                              0396 01650000
         LR    @07,I                                               0396 01651000
         SLA   @07,2                                               0396 01652000
         ALR   @07,J                                               0396 01653000
         ST    @07,@TF00001                                        0396 01654000
         ALR   @07,R4                                              0396 01655000
         CLI   PHYSDS2-5(@07),X'FF'                                0396 01656000
         BE    @RF00396                                            0396 01657000
*           DO;                     /*                       @XD00153*/ 01658000
*             N=59;                 /*                       @XD00153*/ 01659000
         LA    N,59                                                0398 01660000
*             M=PHYSDS2(I,J);       /*                       @XD00153*/ 01661000
         L     @09,@TF00001                                        0399 01662000
         SLR   M,M                                                 0399 01663000
         IC    M,PHYSDS2-5(@09,R4)                                 0399 01664000
*             CALL CUDADDR;         /* CHAN UNIT DEV ADDR    @XD00153*/ 01665000
         BAL   @14,CUDADDR                                         0400 01666000
*           END;                    /*                       @XD00153*/ 01667000
*         OUTBUF2(1:99)=MSG6;       /*                       @XD00153*/ 01668000
@RF00396 MVC   OUTBUF2(99,R4),MSG6                                 0402 01669000
*         CALL PRINT1;              /* PRINT A LINE          @XD00153*/ 01670000
         BAL   @14,PRINT1                                          0403 01671000
*         MSG6='';                  /*                       @XD00153*/ 01672000
         MVI   MSG6,C' '                                           0404 01673000
         MVC   MSG6+1(98),MSG6                                     0404 01674000
*       END;                        /*                       @XD00153*/ 01675000
*   END;                            /*                       @XD00153*/ 01676000
@RF00378 AH    K,@CH00044                                          0406 01677000
         CH    K,@CH00042                                          0406 01678000
         BNH   @DL00377                                            0406 01679000
*   END MAINBODY;                   /*                       @XD00153*/ 01680000
@EL00009 DS    0H                                                  0407 01681000
@EF00009 DS    0H                                                  0407 01682000
@ER00009 LM    @14,@12,@SA00009                                    0407 01683000
         BR    @14                                                 0407 01684000
*                                                                  0408 01685000
*/***********************************************************@XD00153*/ 01686000
*/*                                                          @XD00153*/ 01687000
*/* PROCEDURE NAME CUDADDR                                   @XD00153*/ 01688000
*/*                                                          @XD00153*/ 01689000
*/* FUNCTION - THIS ROUTINE DETERMINES THE CHANNEL-UNIT      @XD00153*/ 01690000
*/*            ADDRESS FOR THE B,C,D INTERFACES FOR THE      @XD00153*/ 01691000
*/*            STAGING ADAPTERS.                             @XD00153*/ 01692000
*/*                                                          @XD00153*/ 01693000
*/***********************************************************@XD00153*/ 01694000
*                                                                  0408 01695000
*CUDADDR:                                                          0408 01696000
*   PROCEDURE;                      /*                       @XD00153*/ 01697000
CUDADDR  STM   @14,@12,12(@13)                                     0408 01698000
*   DO L=1 TO 3;                    /*                       @XD00153*/ 01699000
         LA    L,1                                                 0409 01700000
@DL00409 DS    0H                                                  0410 01701000
*     MSG6(N+12*L)=TABLE(RSGCHAN(M*3+L)+1);/*                @XD00153*/ 01702000
         LR    @09,L                                               0410 01703000
         MH    @09,@CH00130                                        0410 01704000
         LR    @05,N                                               0410 01705000
         ALR   @05,@09                                             0410 01706000
         LA    @01,MSG6-1(@05)                                     0410 01707000
         LR    @15,M                                               0410 01708000
         MH    @15,@CH00050                                        0410 01709000
         ALR   @15,L                                               0410 01710000
         LR    @14,@15                                             0410 01711000
         MH    @14,@CH00114                                        0410 01712000
         L     @00,COMPTR2(,R4)                                    0410 01713000
         ST    @09,@TF00001                                        0410 01714000
         LR    @09,@00                                             0410 01715000
         SLR   @00,@00                                             0410 01716000
         IC    @00,RSGCHAN-9(@14,@09)                              0410 01717000
         LR    @09,@00                                             0410 01718000
         ST    @05,@TF00002                                        0410 01719000
         LA    @05,TABLE(@09)                                      0410 01720000
         MVC   0(1,@01),0(@05)                                     0410 01721000
*     WORK=RSGCUA(M*3+L)*64;        /*                       @XD00153*/ 01722000
         L     @09,COMPTR2(,R4)                                    0411 01723000
         SLR   @05,@05                                             0411 01724000
         IC    @05,RSGCUA-9(@14,@09)                               0411 01725000
         SLA   @05,6                                               0411 01726000
         STC   @05,WORK                                            0411 01727000
*     WORK=WORK+(J-1)*8;            /* ADD IN CONTROLER      @XD00153*/ 01728000
         LR    @14,J                                               0412 01729000
         BCTR  @14,0                                               0412 01730000
         SLA   @14,3                                               0412 01731000
         ALR   @05,@14                                             0412 01732000
         STC   @05,WORK                                            0412 01733000
*     WORK=WORK+K-1;                /* ADD IN DEVICE         @XD00153*/ 01734000
         ALR   @05,K                                               0413 01735000
         BCTR  @05,0                                               0413 01736000
         STC   @05,WORK                                            0413 01737000
*     MSG6(N+1+12*L)=TABLE((WORK/16)//16+1);/*               @XD00153*/ 01738000
         LA    @01,1                                               0414 01739000
         ALR   @01,N                                               0414 01740000
         AL    @01,@TF00001                                        0414 01741000
         LA    @09,MSG6-1(@01)                                     0414 01742000
         LR    @01,@05                                             0414 01743000
         SRL   @01,4                                               0414 01744000
         ST    @14,@TF00003                                        0414 01745000
         LR    @14,@01                                             0414 01746000
         ST    @15,@TF00004                                        0414 01747000
         SRDA  @14,32                                              0414 01748000
         D     @14,@CF00164                                        0414 01749000
         LA    @15,TABLE(@14)                                      0414 01750000
         MVC   0(1,@09),0(@15)                                     0414 01751000
*     MSG6(N+2+12*L)=TABLE(WORK//16+1);/*                    @XD00153*/ 01752000
         LA    @09,2                                               0415 01753000
         ALR   @09,N                                               0415 01754000
         AL    @09,@TF00001                                        0415 01755000
         LA    @01,MSG6-1(@09)                                     0415 01756000
         LR    @14,@05                                             0415 01757000
         SRDA  @14,32                                              0415 01758000
         D     @14,@CF00164                                        0415 01759000
         LA    @09,TABLE(@14)                                      0415 01760000
         MVC   0(1,@01),0(@09)                                     0415 01761000
*     IF USEV(M*3+L,(J-1)*8+K)='1'B|USEVS(M*3+L,(J-1)*8+K)='1'B THEN    01762000
         L     @09,@TF00004                                        0416 01763000
         SLA   @09,6                                               0416 01764000
         LR    @05,K                                               0416 01765000
         AL    @05,@TF00003                                        0416 01766000
         ALR   @09,@05                                             0416 01767000
         MH    @09,@CH00033                                        0416 01768000
         L     @05,COMPTR2(,R4)                                    0416 01769000
         ALR   @05,@09                                             0416 01770000
         AL    @05,@CF00626                                        0416 01771000
         TM    USEV-464(@05),B'01100000'                           0416 01772000
         BZ    @RF00416                                            0416 01773000
*       MSG6(N+12*L+3:N+12*L+4)='-V';/*                      @XD00153*/ 01774000
         L     @09,@TF00002                                        0417 01775000
         LA    @05,MSG6+2(@09)                                     0417 01776000
         MVC   0(2,@05),@CC00566                                   0417 01777000
*     IF USEREAL(M*3+L,(J-1)*8+K)='1'B THEN                        0418 01778000
@RF00416 LR    @09,M                                               0418 01779000
         MH    @09,@CH00050                                        0418 01780000
         ALR   @09,L                                               0418 01781000
         SLA   @09,6                                               0418 01782000
         LR    @05,J                                               0418 01783000
         BCTR  @05,0                                               0418 01784000
         SLA   @05,3                                               0418 01785000
         ALR   @05,K                                               0418 01786000
         ALR   @09,@05                                             0418 01787000
         MH    @09,@CH00033                                        0418 01788000
         L     @05,COMPTR2(,R4)                                    0418 01789000
         ALR   @05,@09                                             0418 01790000
         AL    @05,@CF00626                                        0418 01791000
         TM    USEREAL-464(@05),B'00010000'                        0418 01792000
         BNO   @RF00418                                            0418 01793000
*       MSG6(N+12*L+3:N+12*L+4)='-R';/*                      @XD00153*/ 01794000
         LR    @09,L                                               0419 01795000
         MH    @09,@CH00130                                        0419 01796000
         ALR   @09,N                                               0419 01797000
         LA    @05,MSG6+2(@09)                                     0419 01798000
         MVC   0(2,@05),@CC00567                                   0419 01799000
*     IF USECONVR(M*3+L,(J-1)*8+K)='1'B THEN                       0420 01800000
@RF00418 LR    @09,M                                               0420 01801000
         MH    @09,@CH00050                                        0420 01802000
         ALR   @09,L                                               0420 01803000
         SLA   @09,6                                               0420 01804000
         LR    @05,J                                               0420 01805000
         BCTR  @05,0                                               0420 01806000
         SLA   @05,3                                               0420 01807000
         ALR   @05,K                                               0420 01808000
         ALR   @09,@05                                             0420 01809000
         MH    @09,@CH00033                                        0420 01810000
         L     @05,COMPTR2(,R4)                                    0420 01811000
         ALR   @05,@09                                             0420 01812000
         AL    @05,@CF00626                                        0420 01813000
         TM    USECONVR-464(@05),B'00000100'                       0420 01814000
         BNO   @RF00420                                            0420 01815000
*       MSG6(N+12*L+3:N+12*L+4)='-C';/*                      @XD00153*/ 01816000
         LR    @09,L                                               0421 01817000
         MH    @09,@CH00130                                        0421 01818000
         ALR   @09,N                                               0421 01819000
         LA    @05,MSG6+2(@09)                                     0421 01820000
         MVC   0(2,@05),@CC00568                                   0421 01821000
*     IF ITISALTP(M*3+L,(J-1)*8+K)='1'B THEN                       0422 01822000
@RF00420 LR    @09,M                                               0422 01823000
         MH    @09,@CH00050                                        0422 01824000
         ALR   @09,L                                               0422 01825000
         SLA   @09,6                                               0422 01826000
         LR    @05,J                                               0422 01827000
         BCTR  @05,0                                               0422 01828000
         SLA   @05,3                                               0422 01829000
         ALR   @05,K                                               0422 01830000
         ALR   @09,@05                                             0422 01831000
         MH    @09,@CH00033                                        0422 01832000
         L     @05,COMPTR2(,R4)                                    0422 01833000
         ALR   @05,@09                                             0422 01834000
         AL    @05,@CF00626                                        0422 01835000
         TM    ITISALTP-464(@05),B'00000010'                       0422 01836000
         BNO   @RF00422                                            0422 01837000
*       MSG6(N+12*L+3:N+12*L+4)='-A';/*                      @XD00153*/ 01838000
         LR    @09,L                                               0423 01839000
         MH    @09,@CH00130                                        0423 01840000
         ALR   @09,N                                               0423 01841000
         LA    @05,MSG6+2(@09)                                     0423 01842000
         MVC   0(2,@05),@CC00569                                   0423 01843000
*     IF MSG6(N+12*L+3:N+12*L+4)='  ' THEN                         0424 01844000
@RF00422 LR    @09,L                                               0424 01845000
         MH    @09,@CH00130                                        0424 01846000
         ALR   @09,N                                               0424 01847000
         LA    @05,MSG6+2(@09)                                     0424 01848000
         CLC   0(2,@05),@CC00570                                   0424 01849000
         BNE   @RF00424                                            0424 01850000
*       MSG6(N+12*L:N+12*L+4)='*****';/*                     @XD00153*/ 01851000
         LA    @05,MSG6-1(@09)                                     0425 01852000
         MVC   0(5,@05),@CC00534                                   0425 01853000
*   END;                            /*                       @XD00153*/ 01854000
@RF00424 AH    L,@CH00044                                          0426 01855000
         CH    L,@CH00050                                          0426 01856000
         BNH   @DL00409                                            0426 01857000
*   END CUDADDR;                    /*                       @XD00153*/ 01858000
@EL00010 DS    0H                                                  0427 01859000
@EF00010 DS    0H                                                  0427 01860000
@ER00010 LM    @14,@12,12(@13)                                     0427 01861000
         BR    @14                                                 0427 01862000
*                                                                  0428 01863000
*/***********************************************************@XD00153*/ 01864000
*/*                                                          @XD00153*/ 01865000
*/* PROCEDURE NAME - GETCPUID                                @XD00153*/ 01866000
*/*                                                          @XD00153*/ 01867000
*/* FUNCTION - THIS ROUTINE EXTRACTS THE PROPER CPUID FROM   @XD00153*/ 01868000
*/*            RSGCPUID IN CONFGCON, UNPACKS THE ID, AND     @XD00153*/ 01869000
*/*            PLACES IT IN ITS PROPER LOCATION IN THE CPUID @XD00153*/ 01870000
*/*            LINE IN MSG5.                                 @XD00153*/ 01871000
*/*                                                          @XD00153*/ 01872000
*/***********************************************************@XD00153*/ 01873000
*                                                                  0428 01874000
*GETCPUID:                                                         0428 01875000
*   PROCEDURE;                      /*                       @XD00153*/ 01876000
GETCPUID STM   @14,@12,@SA00011                                    0428 01877000
*   DO L=1 TO 3;                    /*                       @XD00153*/ 01878000
         LA    L,1                                                 0429 01879000
@DL00429 DS    0H                                                  0430 01880000
*     PACKED(1:5)=RSGCPUID((M-1)*3+L);/*                     @XD00153*/ 01881000
         LR    @09,M                                               0430 01882000
         BCTR  @09,0                                               0430 01883000
         MH    @09,@CH00050                                        0430 01884000
         ALR   @09,L                                               0430 01885000
         MH    @09,@CH00114                                        0430 01886000
         L     @06,COMPTR2(,R4)                                    0430 01887000
         ALR   @06,@09                                             0430 01888000
         MVC   PACKED(5),RSGCPUID-9(@06)                           0430 01889000
*     PACKED(6)='0F'X;              /*                       @XD00153*/ 01890000
         MVI   PACKED+5,X'0F'                                      0431 01891000
*     GEN(UNPK UNPACKED(11),PACKED(6));/*                    @XD00153*/ 01892000
         UNPK UNPACKED(11),PACKED(6)                                    01893000
*     MSG5(N+12*L:N+9+12*L)=UNPACKED(1:10);/*                @XD00153*/ 01894000
         LR    @09,L                                               0433 01895000
         MH    @09,@CH00130                                        0433 01896000
         LR    @06,N                                               0433 01897000
         ALR   @06,@09                                             0433 01898000
         LA    @05,MSG5-1(@06)                                     0433 01899000
         LA    @02,9                                               0433 01900000
         ALR   @02,N                                               0433 01901000
         ALR   @02,@09                                             0433 01902000
         SLR   @02,@06                                             0433 01903000
         EX    @02,@SM00627                                        0433 01904000
*     IF MSG5(N+12*L:N+9+12*L)='0000000000' THEN                   0434 01905000
         LA    @09,MSG5-1(@06)                                     0434 01906000
         EX    @02,@SC00629                                        0434 01907000
         BNE   @RF00434                                            0434 01908000
*       MSG5(N+12*L:N+9+12*L)='   *****  ';/*                @XD00153*/ 01909000
         LA    @09,MSG5-1(@06)                                     0435 01910000
         EX    @02,@SM00631                                        0435 01911000
*   END;                            /*                       @XD00153*/ 01912000
@RF00434 AH    L,@CH00044                                          0436 01913000
         CH    L,@CH00050                                          0436 01914000
         BNH   @DL00429                                            0436 01915000
*   END GETCPUID;                   /*                       @XD00153*/ 01916000
@EL00011 DS    0H                                                  0437 01917000
@EF00011 DS    0H                                                  0437 01918000
@ER00011 LM    @14,@12,@SA00011                                    0437 01919000
         BR    @14                                                 0437 01920000
*                                                                  0438 01921000
*/***********************************************************@XD00153*/ 01922000
*/*                                                          @XD00153*/ 01923000
*/* PROCEDURE NAME - SETMSG18                                @XD00153*/ 01924000
*/*                                                          @XD00153*/ 01925000
*/* FUNCTION - THIS ROUTINE SETS UP THE CONTENTS OF MSG18.   @XD00153*/ 01926000
*/***********************************************************@XD00153*/ 01927000
*                                                                  0438 01928000
*SETMSG18:                                                         0438 01929000
*   PROCEDURE;                      /*                       @XD00153*/ 01930000
SETMSG18 STM   @14,@12,@SA00012                                    0438 01931000
*   MSG18(35:36)=CNTRTABL(J);       /*                       @XD00153*/ 01932000
         LR    @03,J                                               0439 01933000
         ALR   @03,@03                                             0439 01934000
         LA    @01,CNTRTABL-2(@03)                                 0439 01935000
         MVC   MSG18+34(2),0(@01)                                  0439 01936000
*   MSG18(38:53)='TO MSF  , DRC  ,';/*                       @XD00153*/ 01937000
         MVC   MSG18+37(16),@CC00581                               0440 01938000
*   MSG18(45)=LOWLIB(I,J);          /*                       @XD00153*/ 01939000
         LR    @03,I                                               0441 01940000
         SLA   @03,2                                               0441 01941000
         ALR   @03,J                                               0441 01942000
         ALR   @03,@03                                             0441 01943000
         ST    @03,@TF00001                                        0441 01944000
         ALR   @03,R4                                              0441 01945000
         MVC   MSG18+44(1),LOWLIB-10(@03)                          0441 01946000
*   IF LOWRW01(I,J)='1'B THEN                                      0442 01947000
         LR    @03,R4                                              0442 01948000
         AL    @03,@TF00001                                        0442 01949000
         TM    LOWRW01-10(@03),B'01000000'                         0442 01950000
         BNO   @RF00442                                            0442 01951000
*     MSG18(52)='0';                /*                       @XD00153*/ 01952000
         MVI   MSG18+51,C'0'                                       0443 01953000
*   IF LOWRW23(I,J)='1'B THEN                                      0444 01954000
@RF00442 LR    @03,I                                               0444 01955000
         SLA   @03,2                                               0444 01956000
         ALR   @03,J                                               0444 01957000
         ALR   @03,@03                                             0444 01958000
         ALR   @03,R4                                              0444 01959000
         TM    LOWRW23-10(@03),B'00100000'                         0444 01960000
         BNO   @RF00444                                            0444 01961000
*     MSG18(52)='1';                /*                       @XD00153*/ 01962000
         MVI   MSG18+51,C'1'                                       0445 01963000
*   IF LOWRW45(I,J)='1'B THEN                                      0446 01964000
@RF00444 LR    @03,I                                               0446 01965000
         SLA   @03,2                                               0446 01966000
         ALR   @03,J                                               0446 01967000
         ALR   @03,@03                                             0446 01968000
         ALR   @03,R4                                              0446 01969000
         TM    LOWRW45-10(@03),B'00010000'                         0446 01970000
         BNO   @RF00446                                            0446 01971000
*     MSG18(52)='2';                /*                       @XD00153*/ 01972000
         MVI   MSG18+51,C'2'                                       0447 01973000
*   IF LOWRW67(I,J)='1'B THEN                                      0448 01974000
@RF00446 LR    @03,I                                               0448 01975000
         SLA   @03,2                                               0448 01976000
         ALR   @03,J                                               0448 01977000
         ALR   @03,@03                                             0448 01978000
         ALR   @03,R4                                              0448 01979000
         TM    LOWRW67-10(@03),B'00001000'                         0448 01980000
         BNO   @RF00448                                            0448 01981000
*     MSG18(52)='3';                /*                       @XD00153*/ 01982000
         MVI   MSG18+51,C'3'                                       0449 01983000
*   IF LOWLEFT(I,J)='1'B THEN                                      0450 01984000
@RF00448 LR    @03,I                                               0450 01985000
         SLA   @03,2                                               0450 01986000
         ALR   @03,J                                               0450 01987000
         ALR   @03,@03                                             0450 01988000
         ALR   @03,R4                                              0450 01989000
         TM    LOWLEFT-10(@03),B'00000100'                         0450 01990000
         BNO   @RF00450                                            0450 01991000
*     MSG18(54)='A';                /*                       @XD00153*/ 01992000
         MVI   MSG18+53,C'A'                                       0451 01993000
*   IF LOWRGHT(I,J)='1'B THEN                                      0452 01994000
@RF00450 LR    @03,I                                               0452 01995000
         SLA   @03,2                                               0452 01996000
         ALR   @03,J                                               0452 01997000
         ALR   @03,@03                                             0452 01998000
         ALR   @03,R4                                              0452 01999000
         TM    LOWRGHT-10(@03),B'00000010'                         0452 02000000
         BNO   @RF00452                                            0452 02001000
*     MSG18(54)='B';                /*                       @XD00153*/ 02002000
         MVI   MSG18+53,C'B'                                       0453 02003000
*   OUTBUF2(1:54)=MSG18;            /*                       @XD00153*/ 02004000
@RF00452 MVC   OUTBUF2(54,R4),MSG18                                0454 02005000
*   CALL PRINT1;                    /* PRINT A LINE          @XD00153*/ 02006000
         BAL   @14,PRINT1                                          0455 02007000
*   MSG19(22)=MSG18(52);            /*                       @XD00153*/ 02008000
         MVC   MSG19+21(1),MSG18+51                                0456 02009000
*   MSG19(33)=MSG18(45);            /*                       @XD00153*/ 02010000
         MVC   MSG19+32(1),MSG18+44                                0457 02011000
*   MSG19(34)=MSG18(52);            /*                       @XD00153*/ 02012000
         MVC   MSG19+33(1),MSG18+51                                0458 02013000
*   OUTBUF2(1:34)=MSG19;            /*                       @XD00153*/ 02014000
         MVC   OUTBUF2(34,R4),MSG19                                0459 02015000
*   CALL PRINT1;                    /* PRINT A LINE          @XD00153*/ 02016000
         BAL   @14,PRINT1                                          0460 02017000
*   END SETMSG18;                   /*                       @XD00153*/ 02018000
@EL00012 DS    0H                                                  0461 02019000
@EF00012 DS    0H                                                  0461 02020000
@ER00012 LM    @14,@12,@SA00012                                    0461 02021000
         BR    @14                                                 0461 02022000
*                                                                  0462 02023000
*/***********************************************************@XD00153*/ 02024000
*/*                                                          @XD00153*/ 02025000
*/* PROCEDURE NAME LIBSIZE1                                  @XD00153*/ 02026000
*/*                                                          @XD00153*/ 02027000
*/* FUNCTION - THIS ROUTINE IS USED IF THE LIBRARY SIZE IS 1 @XD00153*/ 02028000
*/*            THE MSF NUMBER IN MSG18 IS PLACED IN THE      @XD00153*/ 02029000
*/*            SECOND DIGIT IN THE SSID NUMBER.  THE NUMBER  @XD00153*/ 02030000
*/*            1 IS THE ENDING DIGIT FOR THE FIRST LINE, AND @XD00153*/ 02031000
*/*            THE NUMBER 2 IS THE ENDING DIGIT FOR THE      @XD00153*/ 02032000
*/*            SECOND DRD LINE.  THERE ARE ONLY 2 DRD LINES  @XD00153*/ 02033000
*/*            A CALL IS MADE TO PRINTDRD TO TRANSFER THE    @XD00153*/ 02034000
*/*            MESSAGE TO THE PRINT BUFFER AND PRINT THE     @XD00153*/ 02035000
*/*            LINE.                                         @XD00153*/ 02036000
*/*                                                          @XD00153*/ 02037000
*/***********************************************************@XD00153*/ 02038000
*                                                                  0462 02039000
*LIBSIZE1:                                                         0462 02040000
*   PROCEDURE;                      /*                       @XD00153*/ 02041000
LIBSIZE1 STM   @14,@12,@SA00013                                    0462 02042000
*   IF LIBSIZE(LOWLIB(I,J)//16+1)='1' THEN                         0463 02043000
         LR    @03,I                                               0463 02044000
         SLA   @03,2                                               0463 02045000
         ALR   @03,J                                               0463 02046000
         ALR   @03,@03                                             0463 02047000
         SLR   @00,@00                                             0463 02048000
         IC    @00,LOWLIB-10(@03,R4)                               0463 02049000
         SRDA  @00,32                                              0463 02050000
         D     @00,@CF00164                                        0463 02051000
         MH    @00,@CH00130                                        0463 02052000
         LR    @03,@00                                             0463 02053000
         ALR   @03,R4                                              0463 02054000
         CLI   LIBSIZE(@03),C'1'                                   0463 02055000
         BNE   @RF00463                                            0463 02056000
*     DO;                           /*                       @XD00153*/ 02057000
*       MSG20(33)=MSG18(45);        /*                       @XD00153*/ 02058000
         MVC   MSG20+32(1),MSG18+44                                0465 02059000
*       DO L=1 TO 2;                /*                       @XD00153*/ 02060000
         LA    L,1                                                 0466 02061000
@DL00466 DS    0H                                                  0467 02062000
*         MSG20(22:23)=CNTRTABL(L); /*                       @XD00153*/ 02063000
         LR    @15,L                                               0467 02064000
         ALR   @15,@15                                             0467 02065000
         LA    @14,CNTRTABL-2(@15)                                 0467 02066000
         MVC   MSG20+21(2),0(@14)                                  0467 02067000
*         MSG20(34)=TABLE(L);       /*                       @XD00153*/ 02068000
         LA    @01,TABLE-1(L)                                      0468 02069000
         MVC   MSG20+33(1),0(@01)                                  0468 02070000
*         CALL PRINTDRD;            /* PRINT DRD LINE        @XD00153*/ 02071000
         BAL   @14,PRINTDRD                                        0469 02072000
*       END;                        /*                       @XD00153*/ 02073000
         AH    L,@CH00044                                          0470 02074000
         CH    L,@CH00052                                          0470 02075000
         BNH   @DL00466                                            0470 02076000
*     END;                          /*                       @XD00153*/ 02077000
*   END LIBSIZE1;                   /*                       @XD00153*/ 02078000
@EL00013 DS    0H                                                  0472 02079000
@EF00013 DS    0H                                                  0472 02080000
@ER00013 LM    @14,@12,@SA00013                                    0472 02081000
         BR    @14                                                 0472 02082000
*                                                                  0473 02083000
*/***********************************************************@XD00153*/ 02084000
*/*                                                          @XD00153*/ 02085000
*/* PROCEDURE NAME - LIBSIZE2                                @XD00153*/ 02086000
*/*                                                          @XD00153*/ 02087000
*/* FUNCTION - THIS ROUTINE IS USED IF THE LIBRARY SIZE IS   @XD00153*/ 02088000
*/*            2 OR 4.  THE MSF NUMBER IN MSG18 IS USED AS   @XD00153*/ 02089000
*/*            THE SECOND DIGIT OF THE SSID AND THE LAST     @XD00153*/ 02090000
*/*            DIGIT OF THE SSID IS GENERATED.  THIS LAST    @XD00153*/ 02091000
*/*            DIGIT IS A FUNCTION OF THE DRC WHICH IS       @XD00153*/ 02092000
*/*            PICKED UP FROM THE 52ND POSITION MF MSG18     @XD00153*/ 02093000
*/*            AND CONVERTED TO BINARY.                      @XD00153*/ 02094000
*/*            THE LAST DIGIT IS AS FOLLOWS:                 @XD00153*/ 02095000
*/*                                 DRC = 0  1  2  3         @XD00153*/ 02096000
*/*                DRD = 00, LAST DIGIT = 0  2  4  6         @XD00153*/ 02097000
*/*                DRD = 01, LAST DIGIT = 1  3  5  7         @XD00153*/ 02098000
*/*                DRD = 10, LAST DIGIT = 2  0  6  4         @XD00153*/ 02099000
*/*                DRD = 11, LAST DIGIT = 3  1  7  5         @XD00153*/ 02100000
*/*            CAUTION: IF ANY OF THESE ENDING DIGITS SHOULD @XD00153*/ 02101000
*/*            CHANGE, THEN THIS ROUTINE WILL NOT WORK AND   @XD00153*/ 02102000
*/*            IT MUST BE RE-WRITTEN.                        @XD00153*/ 02103000
*/*                                                          @XD00153*/ 02104000
*/***********************************************************@XD00153*/ 02105000
*                                                                  0473 02106000
*LIBSIZE2:                                                         0473 02107000
*   PROCEDURE;                      /*                       @XD00153*/ 02108000
LIBSIZE2 STM   @14,@12,@SA00014                                    0473 02109000
*   IF LIBSIZE(LOWLIB(I,J)//16+1)='2'|LIBSIZE(LOWLIB(I,J)//16+1)='4'    02110000
*     THEN                                                         0474 02111000
         LR    @03,I                                               0474 02112000
         SLA   @03,2                                               0474 02113000
         ALR   @03,J                                               0474 02114000
         ALR   @03,@03                                             0474 02115000
         SLR   @00,@00                                             0474 02116000
         IC    @00,LOWLIB-10(@03,R4)                               0474 02117000
         SRDA  @00,32                                              0474 02118000
         D     @00,@CF00164                                        0474 02119000
         MH    @00,@CH00130                                        0474 02120000
         LR    @03,@00                                             0474 02121000
         ALR   @03,R4                                              0474 02122000
         CLI   LIBSIZE(@03),C'2'                                   0474 02123000
         BE    @RT00474                                            0474 02124000
         LR    @03,@00                                             0474 02125000
         ALR   @03,R4                                              0474 02126000
         CLI   LIBSIZE(@03),C'4'                                   0474 02127000
         BNE   @RF00474                                            0474 02128000
@RT00474 DS    0H                                                  0475 02129000
*     DO;                           /*                       @XD00153*/ 02130000
*       WORK=MSG18(52)//16;         /*                       @XD00153*/ 02131000
         SLR   @03,@03                                             0476 02132000
         IC    @03,MSG18+51                                        0476 02133000
         N     @03,@CF00065                                        0476 02134000
         STC   @03,WORK                                            0476 02135000
*       MSG20(33)=MSG18(45);        /*                       @XD00153*/ 02136000
         MVC   MSG20+32(1),MSG18+44                                0477 02137000
*       DO L=0 TO 3;                /*                       @XD00153*/ 02138000
         SLR   L,L                                                 0478 02139000
@DL00478 DS    0H                                                  0479 02140000
*         MSG20(34)=TABLE(L+(WORK//2)*(2*(1+(-2)*(L/2)))+4*(WORK/2)+1); 02141000
         SLR   @15,@15                                             0479 02142000
         IC    @15,WORK                                            0479 02143000
         LR    @00,@15                                             0479 02144000
         SRDA  @00,32                                              0479 02145000
         D     @00,@CF00052                                        0479 02146000
         LR    @06,L                                               0479 02147000
         SRDA  @06,32                                              0479 02148000
         D     @06,@CF00052                                        0479 02149000
         MH    @07,@CH00599                                        0479 02150000
         AH    @07,@CH00044                                        0479 02151000
         ALR   @07,@07                                             0479 02152000
         LR    @09,@00                                             0479 02153000
         MR    @08,@07                                             0479 02154000
         ALR   @09,L                                               0479 02155000
         SRL   @15,1                                               0479 02156000
         SLA   @15,2                                               0479 02157000
         ALR   @09,@15                                             0479 02158000
         LA    @08,TABLE(@09)                                      0479 02159000
         MVC   MSG20+33(1),0(@08)                                  0479 02160000
*                                   /*                       @XD00153*/ 02161000
*         MSG20(22:23)=CNTRTABL(L+1);/*                      @XD00153*/ 02162000
         LR    @15,L                                               0480 02163000
         ALR   @15,@15                                             0480 02164000
         LA    @14,CNTRTABL(@15)                                   0480 02165000
         MVC   MSG20+21(2),0(@14)                                  0480 02166000
*         CALL PRINTDRD;            /* PRINT DRD LINE        @XD00153*/ 02167000
         BAL   @14,PRINTDRD                                        0481 02168000
*       END;                        /*                       @XD00153*/ 02169000
         AH    L,@CH00044                                          0482 02170000
         CH    L,@CH00050                                          0482 02171000
         BNH   @DL00478                                            0482 02172000
*     END;                          /*                       @XD00153*/ 02173000
*   END LIBSIZE2;                   /*                       @XD00153*/ 02174000
@EL00014 DS    0H                                                  0484 02175000
@EF00014 DS    0H                                                  0484 02176000
@ER00014 LM    @14,@12,@SA00014                                    0484 02177000
         BR    @14                                                 0484 02178000
*                                                                  0485 02179000
*/***********************************************************@XD00153*/ 02180000
*/*                                                          @XD00153*/ 02181000
*/* PROCEDURE NAME - LIBSIZE3                                @XD00153*/ 02182000
*/*                                                          @XD00153*/ 02183000
*/* FUNCTION - THIS ROUTINE IS USED IF THE LIBRARY SIZE IS 3 @XD00153*/ 02184000
*/*            IT IS THE SAME AS IF LIBSIZE WERE 2 OR 4,     @XD00153*/ 02185000
*/*            EXCEPT THE ENDING DIGIT IS GENERATED WITH THE @XD00153*/ 02186000
*/*            FOLLOWING RELATIONSHIP TO THE DRC:            @XD00153*/ 02187000
*/*                                 DRC = 0  1  2            @XD00153*/ 02188000
*/*                DRD = 00, LAST DIGIT = 0  2  4            @XD00153*/ 02189000
*/*                DRD = 01, LAST DIGIT = 1  3  5            @XD00153*/ 02190000
*/*                DRD = 10, LAST DIGIT = 4  0  2            @XD00153*/ 02191000
*/*                DRD = 11, LAST DIGIT = 5  1  3            @XD00153*/ 02192000
*/*            CAUTION: IF ANY OF THESE ENDING DIGITS SHOULD @XD00153*/ 02193000
*/*            CHANGE, THEN THIS ROUTINE WILL NOT WORK AND   @XD00153*/ 02194000
*/*            MUST BE RE-WRITTEN.                           @XD00153*/ 02195000
*/*                                                          @XD00153*/ 02196000
*/***********************************************************@XD00153*/ 02197000
*                                                                  0485 02198000
*LIBSIZE3:                                                         0485 02199000
*   PROCEDURE;                      /*                       @XD00153*/ 02200000
LIBSIZE3 STM   @14,@12,@SA00015                                    0485 02201000
*   IF LIBSIZE(LOWLIB(I,J)//16+1)='3' THEN                         0486 02202000
         LR    @03,I                                               0486 02203000
         SLA   @03,2                                               0486 02204000
         ALR   @03,J                                               0486 02205000
         ALR   @03,@03                                             0486 02206000
         SLR   @00,@00                                             0486 02207000
         IC    @00,LOWLIB-10(@03,R4)                               0486 02208000
         SRDA  @00,32                                              0486 02209000
         D     @00,@CF00164                                        0486 02210000
         MH    @00,@CH00130                                        0486 02211000
         LR    @03,@00                                             0486 02212000
         ALR   @03,R4                                              0486 02213000
         CLI   LIBSIZE(@03),C'3'                                   0486 02214000
         BNE   @RF00486                                            0486 02215000
*     DO;                           /*                       @XD00153*/ 02216000
*       MSG20(33)=MSG18(45);        /*                       @XD00153*/ 02217000
         MVC   MSG20+32(1),MSG18+44                                0488 02218000
*       IF MSG18(52)='F0'X THEN                                    0489 02219000
         CLI   MSG18+51,X'F0'                                      0489 02220000
         BNE   @RF00489                                            0489 02221000
*         DO L=1 TO 4;              /*                       @YM01097*/ 02222000
         LA    L,1                                                 0490 02223000
@DL00490 DS    0H                                                  0491 02224000
*           MSG20(34)=TABLE1(L);    /*                       @YM01097*/ 02225000
         LA    @01,TABLE1-1(L)                                     0491 02226000
         MVC   MSG20+33(1),0(@01)                                  0491 02227000
*           MSG20(22:23)=CNTRTABL(L);/*                      @YM01097*/ 02228000
         LR    @15,L                                               0492 02229000
         ALR   @15,@15                                             0492 02230000
         LA    @14,CNTRTABL-2(@15)                                 0492 02231000
         MVC   MSG20+21(2),0(@14)                                  0492 02232000
*           CALL PRINTDRD;          /* PRINT DRD LINE        @XD00153*/ 02233000
         BAL   @14,PRINTDRD                                        0493 02234000
*         END;                      /*                       @XD00153*/ 02235000
         AH    L,@CH00044                                          0494 02236000
         CH    L,@CH00070                                          0494 02237000
         BNH   @DL00490                                            0494 02238000
*       ELSE                        /*                       @YM01097*/ 02239000
*         IF MSG18(52)='F1'X THEN                                  0495 02240000
         B     @RC00489                                            0495 02241000
@RF00489 CLI   MSG18+51,X'F1'                                      0495 02242000
         BNE   @RF00495                                            0495 02243000
*           DO L=1 TO 4;            /*                       @YM01097*/ 02244000
         LA    L,1                                                 0496 02245000
@DL00496 DS    0H                                                  0497 02246000
*             MSG20(34)=TABLE2(L);  /*                       @YM01097*/ 02247000
         LA    @01,TABLE2-1(L)                                     0497 02248000
         MVC   MSG20+33(1),0(@01)                                  0497 02249000
*             MSG20(22:23)=CNTRTABL(L);/*                    @YM01097*/ 02250000
         LR    @15,L                                               0498 02251000
         ALR   @15,@15                                             0498 02252000
         LA    @14,CNTRTABL-2(@15)                                 0498 02253000
         MVC   MSG20+21(2),0(@14)                                  0498 02254000
*             CALL PRINTDRD;        /* PRINT DRD LINE        @XD00153*/ 02255000
         BAL   @14,PRINTDRD                                        0499 02256000
*           END;                    /*                       @XD00153*/ 02257000
         AH    L,@CH00044                                          0500 02258000
         CH    L,@CH00070                                          0500 02259000
         BNH   @DL00496                                            0500 02260000
*         ELSE                                                     0501 02261000
*           DO L=1 TO 4;            /*                       @YM01097*/ 02262000
         B     @RC00495                                            0501 02263000
@RF00495 LA    L,1                                                 0501 02264000
@DL00501 DS    0H                                                  0502 02265000
*             MSG20(34)=TABLE3(L);  /*                       @YM01097*/ 02266000
         LA    @01,TABLE3-1(L)                                     0502 02267000
         MVC   MSG20+33(1),0(@01)                                  0502 02268000
*             MSG20(22:23)=CNTRTABL(L);/*                    @YM01097*/ 02269000
         LR    @15,L                                               0503 02270000
         ALR   @15,@15                                             0503 02271000
         LA    @14,CNTRTABL-2(@15)                                 0503 02272000
         MVC   MSG20+21(2),0(@14)                                  0503 02273000
*             CALL PRINTDRD;        /* PRINT DRD LINE        @XD00153*/ 02274000
         BAL   @14,PRINTDRD                                        0504 02275000
*           END;                    /*                       @XD00153*/ 02276000
         AH    L,@CH00044                                          0505 02277000
         CH    L,@CH00070                                          0505 02278000
         BNH   @DL00501                                            0505 02279000
*     END;                          /*                       @XD00153*/ 02280000
*   END LIBSIZE3;                   /*                       @XD00153*/ 02281000
@EL00015 DS    0H                                                  0507 02282000
@EF00015 DS    0H                                                  0507 02283000
@ER00015 LM    @14,@12,@SA00015                                    0507 02284000
         BR    @14                                                 0507 02285000
*                                                                  0508 02286000
*/***********************************************************@XD00153*/ 02287000
*/*                                                          @XD00153*/ 02288000
*/* PROCEDURE NAME - PRINT1                                  @XD00153*/ 02289000
*/*                                                          @XD00153*/ 02290000
*/* FUNCTION - THIS ROUTINE LINKS TO ICGDSMSG TO PRINT A     @XD00153*/ 02291000
*/*            LINE.                                         @XD00153*/ 02292000
*/*                                                          @XD00153*/ 02293000
*/***********************************************************@XD00153*/ 02294000
*                                                                  0508 02295000
*PRINT1:                                                           0508 02296000
*   PROCEDURE;                      /*                       @XD00153*/ 02297000
PRINT1   STM   @14,@12,@SA00016                                    0508 02298000
*   PRNTBUF2='1'B;                  /*                       @XD00153*/ 02299000
         OI    PRNTBUF2(R4),B'00000001'                            0509 02300000
*   GEN(LINK EP=ICGDSMSG);          /*                       @XD00153*/ 02301000
         LINK EP=ICGDSMSG                                               02302000
*   PRNTBUF2='0'B;                  /*                       @XD00153*/ 02303000
         NI    PRNTBUF2(R4),B'11111110'                            0511 02304000
*   END PRINT1;                     /*                       @XD00153*/ 02305000
@EL00016 DS    0H                                                  0512 02306000
@EF00016 DS    0H                                                  0512 02307000
@ER00016 LM    @14,@12,@SA00016                                    0512 02308000
         BR    @14                                                 0512 02309000
*                                                                  0513 02310000
*/***********************************************************@XD00153*/ 02311000
*/*                                                          @XD00153*/ 02312000
*/* PROCEDURE NAME - PRINTDRD                                @XD00153*/ 02313000
*/*                                                          @XD00153*/ 02314000
*/* FUNCTION - THIS ROUTINE IS USED TO PRINT MSG20 (DRD      @XD00153*/ 02315000
*/*            LINES).                                       @XD00153*/ 02316000
*/*                                                          @XD00153*/ 02317000
*/***********************************************************@XD00153*/ 02318000
*                                                                  0513 02319000
*PRINTDRD:                                                         0513 02320000
*   PROCEDURE;                      /*                       @XD00153*/ 02321000
PRINTDRD STM   @14,@12,@SA00017                                    0513 02322000
*   OUTBUF2(1:34)=MSG20;            /*                       @XD00153*/ 02323000
         MVC   OUTBUF2(34,R4),MSG20                                0514 02324000
*   CALL PRINT1;                    /* PRINT A LINE          @XD00153*/ 02325000
         BAL   @14,PRINT1                                          0515 02326000
*   END PRINTDRD;                   /*                       @XD00153*/ 02327000
@EL00017 DS    0H                                                  0516 02328000
@EF00017 DS    0H                                                  0516 02329000
@ER00017 LM    @14,@12,@SA00017                                    0516 02330000
         BR    @14                                                 0516 02331000
*                                                                  0517 02332000
*/********************************************************** @YD00113*/ 02333000
*/*                  P A T C H   A R E A                     @YD00113*/ 02334000
*/********************************************************** @YD00113*/ 02335000
*                                                                  0517 02336000
*   GENERATE;                                                      0517 02337000
*                                                         /*@YD00113*/  02338000
PATCHB20 DC    32C'PATCHB20'                              /*@YD00113*/  02339000
*   END ICGDSB20                    /*                       @Y30LB14*/ 02340000
*                                                                  0518 02341000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 02342000
*/*%INCLUDE SYSLIB  (ICGDSMAC)                                       */ 02343000
*                                                                  0518 02344000
*       ;                                                          0518 02345000
         B     @EL00001                                            0518 02346000
@DATA    DS    0H                                                       02347000
@CH00044 DC    H'1'                                                     02348000
@CH00050 DC    H'3'                                                     02349000
@CH00070 DC    H'4'                                                     02350000
@CH00135 DC    H'7'                                                     02351000
@CH00114 DC    H'9'                                                     02352000
@CH00033 DC    H'11'                                                    02353000
@CH00130 DC    H'12'                                                    02354000
@CH00269 DC    H'24'                                                    02355000
@CH00312 DC    H'27'                                                    02356000
@CH00480 DC    H'43'                                                    02357000
@CH00329 DC    H'103'                                                   02358000
@CH00599 DC    H'-2'                                                    02359000
@SM00627 MVC   0(0,@05),UNPACKED                                        02360000
@SC00629 CLC   0(0,@09),@CC00574                                        02361000
@SM00631 MVC   0(0,@09),@CC00576                                        02362000
@DATD    DSECT                                                          02363000
         DS    0F                                                       02364000
@SA00001 DS    18F                                                      02365000
@SA00016 DS    15F                                                      02366000
@SA00007 DS    15F                                                      02367000
@SA00009 DS    15F                                                      02368000
@SA00003 DS    15F                                                      02369000
@SA00005 DS    13F                                                      02370000
@SA00006 DS    15F                                                      02371000
@SA00012 DS    15F                                                      02372000
@SA00013 DS    15F                                                      02373000
@SA00014 DS    15F                                                      02374000
@SA00015 DS    15F                                                      02375000
@SA00011 DS    15F                                                      02376000
@SA00008 DS    15F                                                      02377000
@SA00017 DS    15F                                                      02378000
@TF00001 DS    F                                                        02379000
@TF00002 DS    F                                                        02380000
@TF00003 DS    F                                                        02381000
@TF00004 DS    F                                                        02382000
@ZTEMPS  DS    0F                                                       02383000
@ZT00003 DC    F'0'                                                     02384000
@ZTEMPND EQU   *                                                        02385000
@ZLEN    EQU   @ZTEMPND-@ZTEMPS                                         02386000
ICGDSB20 CSECT                                                          02387000
         DS    0F                                                       02388000
@CF00052 DC    F'2'                                                     02389000
@CH00052 EQU   @CF00052+2                                               02390000
@CF00042 DC    F'8'                                                     02391000
@CH00042 EQU   @CF00042+2                                               02392000
@CF00065 DC    F'15'                                                    02393000
@CH00065 EQU   @CF00065+2                                               02394000
@CF00164 DC    F'16'                                                    02395000
@CH00164 EQU   @CF00164+2                                               02396000
@CF00626 DC    F'-251'                                                  02397000
@DATD    DSECT                                                          02398000
         DS    0D                                                       02399000
WORK     DS    FL1                                                      02400000
         ORG   WORK                                                     02401000
@NM00019 DS    BL1                                                      02402000
TEMP     EQU   WORK+0                                                   02403000
         ORG   WORK+1                                                   02404000
FLAGS    DS    FL1                                                      02405000
         ORG   FLAGS                                                    02406000
BIGBLOCK DS    BL1                                                      02407000
@NM00020 EQU   FLAGS+0                                                  02408000
         ORG   FLAGS+1                                                  02409000
UNPACKED DS    CL11                                                     02410000
PACKED   DS    CL6                                                      02411000
MSG1     DS    CL24                                                     02412000
MSG2     DS    CL19                                                     02413000
         ORG   MSG2                                                     02414000
@NM00021 DS    CL17                                                     02415000
CONTRLR  DS    CL2                                                      02416000
         ORG   MSG2+19                                                  02417000
MSG3     DS    CL101                                                    02418000
MSG4     DS    CL99                                                     02419000
MSG5     DS    CL101                                                    02420000
         ORG   MSG5                                                     02421000
@NM00022 DS    CL27                                                     02422000
CPUIDS   DS    CL74                                                     02423000
         ORG   MSG5+101                                                 02424000
MSG6     DS    CL99                                                     02425000
MSG7     DS    CL62                                                     02426000
MSG8     DS    CL60                                                     02427000
MSG9     DS    CL30                                                     02428000
MSG10    DS    CL19                                                     02429000
MSG11    DS    CL68                                                     02430000
MSG12    DS    CL19                                                     02431000
MSG13    DS    CL97                                                     02432000
MSG14    DS    CL97                                                     02433000
MSG15    DS    CL103                                                    02434000
MSG16    DS    CL824                                                    02435000
MSG17    DS    CL25                                                     02436000
MSG18    DS    CL54                                                     02437000
MSG19    DS    CL34                                                     02438000
MSG20    DS    CL34                                                     02439000
MSG21    DS    CL26                                                     02440000
MSG22    DS    CL58                                                     02441000
MSG23    DS    CL59                                                     02442000
MSG24    DS    CL45                                                     02443000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                02444000
@ENDDATD EQU   *                                                        02445000
ICGDSB20 CSECT                                                          02446000
         DS    0F                                                       02447000
@SIZDATD DC    AL1(0)                                                   02448000
         DC    AL3(@ENDDATD-@DATD)                                      02449000
         DS    0D                                                       02450000
@CC00442 DC    C'0           PLUG   TYPE    SSID     PLUG   TYPE    SSIC02451000
               D     PLUG   TYPE    SSID     PLUG   TYPE    SSID'       02452000
@CC00395 DC    C'                            ******* STAGING ADAPTER   C02453000
                *******     ******* STAGING ADAPTER    *******'         02454000
@CC00402 DC    C'0    DEVICE  DEVICE   SSID     CPUID       CPUID      C02455000
                CPUID          CPUID       CPUID       CPUID'           02456000
@CC00435 DC    C'            CONTROLLER 00           CONTROLLER 01     C02457000
                     CONTROLLER 10           CONTROLLER 11'             02458000
@CC00428 DC    C'   INTERFACE   TO CPU           , CHANNEL  , CONTROL UC02459000
               NIT ADDRESS   '                                          02460000
@CC00413 EQU   @CC00395                                                 02461000
@CC00418 EQU   @CC00402                                                 02462000
@CC00468 DC    C'0CONNECTION FOR CARTRIDGE STORE  MSF , SSID 1 0, MSFIDC02463000
                =  '                                                    02464000
@CC00464 DC    C'0   INTERFACE A TO MSC, PORT  , CONTROL UNIT ADDRESS  C02465000
                 '                                                      02466000
@CC00473 DC    C'0MSC TABLE ACCESS VALID ON INTERFACE(S)      '         02467000
@CC00452 DC    C'           DRD CONTROLLER ADDRESS '                    02468000
@CC00455 DC    C'                 DRC      SSID 4'                      02469000
@CC00458 DC    C'                 DRD      SSID 2'                      02470000
@CC00423 DC    C'0CONNECTIONS FOR SA   SSID 8 0'                        02471000
@CC00461 DC    C'   INTERFACE   IS NOT USED'                            02472000
@CC00449 DC    C'0     DRC/DRD (CTL-I/ADT)'                             02473000
@CC00391 DC    C'0HOST CONNECTIONS REPORT'                              02474000
@CC00426 DC    C'0CONNECTIONS REPORT'                                   02475000
@CC00433 DC    C'0     DASD  (CTL-I)'                                   02476000
@CC00411 DC    C'      PLUG    TYPE'                                    02477000
@CC00393 DC    C'0DASD CONTROLLER '                                     02478000
@CC00581 DC    C'TO MSF  , DRC  ,'                                      02479000
@CC00521 DC    C'(SHARED SA  )'                                         02480000
@CC00574 DC    C'0000000000'                                            02481000
@CC00576 DC    C'   *****  '                                            02482000
@CC00498 DC    C'IS UNUSED'                                             02483000
@CC00530 DC    C'3330-11'                                               02484000
@CC00528 EQU   @CC00530                                                 02485000
@CC00550 DC    C'OS/VS1'                                                02486000
@CC00551 DC    C'OS/VS2'                                                02487000
@CC00534 DC    C'*****'                                                 02488000
@CC00532 DC    C'3350'                                                  02489000
@CC00536 EQU   @CC00534                                                 02490000
@CC00566 DC    C'-V'                                                    02491000
@CC00567 DC    C'-R'                                                    02492000
@CC00568 DC    C'-C'                                                    02493000
@CC00569 DC    C'-A'                                                    02494000
@CC00570 EQU   @CC00395                                                 02495000
CNTRTABL DC    X'F0F0'                                                  02496000
         DC    X'F0F1'                                                  02497000
         DC    X'F1F0'                                                  02498000
         DC    X'F1F1'                                                  02499000
TABLE    DC    X'F0'                                                    02500000
         DC    X'F1'                                                    02501000
         DC    X'F2'                                                    02502000
         DC    X'F3'                                                    02503000
         DC    X'F4'                                                    02504000
         DC    X'F5'                                                    02505000
         DC    X'F6'                                                    02506000
         DC    X'F7'                                                    02507000
         DC    X'F8'                                                    02508000
         DC    X'F9'                                                    02509000
         DC    X'C1'                                                    02510000
         DC    X'C2'                                                    02511000
         DC    X'C3'                                                    02512000
         DC    X'C4'                                                    02513000
         DC    X'C5'                                                    02514000
         DC    X'C6'                                                    02515000
TABLE1   DC    X'F0'                                                    02516000
         DC    X'F1'                                                    02517000
         DC    X'F4'                                                    02518000
         DC    X'F5'                                                    02519000
TABLE2   DC    X'F2'                                                    02520000
         DC    X'F3'                                                    02521000
         DC    X'F0'                                                    02522000
         DC    X'F1'                                                    02523000
TABLE3   DC    X'F4'                                                    02524000
         DC    X'F5'                                                    02525000
         DC    X'F2'                                                    02526000
         DC    X'F3'                                                    02527000
TABLE4   DC    X'F0F0F0'                                                02528000
         DC    X'F0F0F1'                                                02529000
         DC    X'F0F1F0'                                                02530000
         DC    X'F0F1F1'                                                02531000
         DC    X'F1F0F0'                                                02532000
         DC    X'F1F0F1'                                                02533000
         DC    X'F1F1F0'                                                02534000
         DC    X'F1F1F1'                                                02535000
         DC    X'F0F0F0'                                                02536000
         DC    X'F0F0F1'                                                02537000
         DC    X'F0F1F0'                                                02538000
         DC    X'F0F1F1'                                                02539000
         DC    X'F1F0F0'                                                02540000
         DC    X'F1F0F1'                                                02541000
         DC    X'F1F1F0'                                                02542000
         DC    X'F1F1F1'                                                02543000
TABLE5   DC    X'C240404040'                                            02544000
         DC    X'C26BC34040'                                            02545000
         DC    X'C26BC36BC4'                                            02546000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       02547000
@01      EQU   01                                                       02548000
@02      EQU   02                                                       02549000
@03      EQU   03                                                       02550000
@04      EQU   04                                                       02551000
@05      EQU   05                                                       02552000
@06      EQU   06                                                       02553000
@07      EQU   07                                                       02554000
@08      EQU   08                                                       02555000
@09      EQU   09                                                       02556000
@10      EQU   10                                                       02557000
@11      EQU   11                                                       02558000
@12      EQU   12                                                       02559000
@13      EQU   13                                                       02560000
@14      EQU   14                                                       02561000
@15      EQU   15                                                       02562000
SWITCH1  EQU   @07                                                      02563000
SWITCH   EQU   @03                                                      02564000
N        EQU   @08                                                      02565000
M        EQU   @07                                                      02566000
L        EQU   @03                                                      02567000
K        EQU   @06                                                      02568000
J        EQU   @02                                                      02569000
I        EQU   @05                                                      02570000
R4       EQU   @04                                                      02571000
R10      EQU   @10                                                      02572000
R11      EQU   @11                                                      02573000
COMTAB   EQU   0                                                        02574000
READER   EQU   COMTAB+256                                               02575000
READFLAG EQU   READER+96                                                02576000
PCHBF    EQU   READER+99                                                02577000
STARTCOL EQU   READER+180                                               02578000
NEXTCOL  EQU   READER+184                                               02579000
PRINTER  EQU   COMTAB+464                                               02580000
LINECTR  EQU   PRINTER+100                                              02581000
LINECT   EQU   PRINTER+102                                              02582000
OUTBUF2  EQU   PRINTER+225                                              02583000
MESSAGES EQU   COMTAB+810                                               02584000
SPECLMSG EQU   MESSAGES+18                                              02585000
PRNTBUF2 EQU   SPECLMSG                                                 02586000
GENIO    EQU   COMTAB+832                                               02587000
DCBPTR   EQU   GENIO+4                                                  02588000
COMPTR2  EQU   GENIO+16                                                 02589000
INVOKED  EQU   COMTAB+856                                               02590000
SAVEDDS  EQU   INVOKED+4                                                02591000
BUILDRSG EQU   COMTAB+900                                               02592000
RSGS     EQU   BUILDRSG                                                 02593000
RSG      EQU   RSGS                                                     02594000
RSGABOX  EQU   RSG                                                      02595000
RSGTODS  EQU   RSG+7                                                    02596000
LIBRARY  EQU   COMTAB+1170                                              02597000
LIBS     EQU   LIBRARY                                                  02598000
LIB      EQU   LIBS                                                     02599000
LIBBITS  EQU   LIB                                                      02600000
LIBSPEC  EQU   LIBBITS                                                  02601000
LIBSIZE  EQU   LIB+1                                                    02602000
LIBDSMID EQU   LIB+2                                                    02603000
PABTABLE EQU   COMTAB+1218                                              02604000
PABDEV   EQU   PABTABLE                                                 02605000
PABFLAGS EQU   PABDEV                                                   02606000
PABREAL  EQU   PABDEV+1                                                 02607000
PABAADDD EQU   PABDEV+2                                                 02608000
DSPAIRS  EQU   COMTAB+1938                                              02609000
PHYSDS2  EQU   DSPAIRS                                                  02610000
PHYSTYPE EQU   COMTAB+2002                                              02611000
PHYSFLGS EQU   PHYSTYPE                                                 02612000
MERLICEB EQU   PHYSFLGS                                                 02613000
PHYSSSID EQU   PHYSFLGS                                                 02614000
SPNRSGNO EQU   PHYSTYPE+1                                               02615000
CPUASSOC EQU   COMTAB+3026                                              02616000
CPUS     EQU   CPUASSOC+2                                               02617000
CPU      EQU   CPUS                                                     02618000
CPUFLAG1 EQU   CPU+6                                                    02619000
OPSYSTYP EQU   CPUFLAG1                                                 02620000
OPVS1    EQU   OPSYSTYP                                                 02621000
OPVS2    EQU   OPSYSTYP                                                 02622000
CPUFLAG2 EQU   CPU+7                                                    02623000
LOWERCON EQU   COMTAB+3156                                              02624000
LOWDSS   EQU   LOWERCON                                                 02625000
LOWFLGS  EQU   LOWDSS                                                   02626000
LOWSPEC  EQU   LOWFLGS                                                  02627000
LOWRW01  EQU   LOWFLGS                                                  02628000
LOWRW23  EQU   LOWFLGS                                                  02629000
LOWRW45  EQU   LOWFLGS                                                  02630000
LOWRW67  EQU   LOWFLGS                                                  02631000
LOWLEFT  EQU   LOWFLGS                                                  02632000
LOWRGHT  EQU   LOWFLGS                                                  02633000
LOWLIB   EQU   LOWDSS+1                                                 02634000
LIBCTL   EQU   COMTAB+3284                                              02635000
LIBCTLS  EQU   LIBCTL                                                   02636000
CREATE   EQU   COMTAB+3288                                              02637000
@NM00017 EQU   CREATE                                                   02638000
CINTIND  EQU   @NM00017                                                 02639000
DINTIND  EQU   @NM00017                                                 02640000
COMTAB2  EQU   0                                                        02641000
DSTORSG  EQU   COMTAB2                                                  02642000
DSENTRY  EQU   DSTORSG                                                  02643000
CONFGCON EQU   COMTAB2+32                                               02644000
RSGUCB   EQU   CONFGCON                                                 02645000
RSGFLAGS EQU   RSGUCB                                                   02646000
CISPEC   EQU   RSGFLAGS                                                 02647000
RSGCPUID EQU   RSGUCB+1                                                 02648000
CPUREFNO EQU   RSGUCB+6                                                 02649000
RSGCHAN  EQU   RSGUCB+7                                                 02650000
RSGCUA   EQU   RSGUCB+8                                                 02651000
CONFGUCB EQU   COMTAB2+464                                              02652000
CONFGDEV EQU   CONFGUCB                                                 02653000
USEFLAGS EQU   CONFGDEV                                                 02654000
USEV     EQU   USEFLAGS                                                 02655000
USEVS    EQU   USEFLAGS                                                 02656000
USEREAL  EQU   USEFLAGS                                                 02657000
USECONVR EQU   USEFLAGS                                                 02658000
ITISALTP EQU   USEFLAGS                                                 02659000
ALTPATH1 EQU   CONFGDEV+2                                               02660000
ALTPATH2 EQU   CONFGDEV+5                                               02661000
ALTPATH3 EQU   CONFGDEV+8                                               02662000
SCANBUF  EQU   0                                                        02663000
SCANDATA EQU   0                                                        02664000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    02665000
ALTCH3   EQU   ALTPATH3+2                                               02666000
ALTCI3   EQU   ALTPATH3+1                                               02667000
ALTDS3   EQU   ALTPATH3                                                 02668000
ALTCH2   EQU   ALTPATH2+2                                               02669000
ALTCI2   EQU   ALTPATH2+1                                               02670000
ALTDS2   EQU   ALTPATH2                                                 02671000
ALTCH1   EQU   ALTPATH1+2                                               02672000
ALTCI1   EQU   ALTPATH1+1                                               02673000
ALTDS1   EQU   ALTPATH1                                                 02674000
INDEXRSG EQU   CONFGDEV+1                                               02675000
ICEBERG  EQU   USEFLAGS                                                 02676000
SUPPUNCH EQU   USEFLAGS                                                 02677000
USESPEC  EQU   USEFLAGS                                                 02678000
@NM00018 EQU   RSGFLAGS                                                 02679000
TORSG2   EQU   DSENTRY+1                                                02680000
TORSG1   EQU   DSENTRY                                                  02681000
COM2BASE EQU   COMTAB+3304                                              02682000
LRUCLOCK EQU   CREATE+11                                                02683000
VOLSER   EQU   CREATE+5                                                 02684000
VPAGES   EQU   CREATE+1                                                 02685000
BINTIND  EQU   @NM00017                                                 02686000
CYLFAULT EQU   @NM00017                                                 02687000
PRNTONLY EQU   @NM00017                                                 02688000
UPDCREAT EQU   @NM00017                                                 02689000
NEWCREAT EQU   @NM00017                                                 02690000
CMDCREAT EQU   @NM00017                                                 02691000
RW67RGHT EQU   LIBCTLS                                                  02692000
RW67LEFT EQU   LIBCTLS                                                  02693000
RW45RGHT EQU   LIBCTLS                                                  02694000
RW45LEFT EQU   LIBCTLS                                                  02695000
RW23RGHT EQU   LIBCTLS                                                  02696000
RW23LEFT EQU   LIBCTLS                                                  02697000
RW01RGHT EQU   LIBCTLS                                                  02698000
RW01LEFT EQU   LIBCTLS                                                  02699000
@NM00016 EQU   LOWFLGS                                                  02700000
ALTMSCIN EQU   CPUFLAG2                                                 02701000
@NM00015 EQU   CPUFLAG2                                                 02702000
ALTMSGBF EQU   CPUFLAG2                                                 02703000
@NM00014 EQU   CPUFLAG2                                                 02704000
CPUSPEC  EQU   CPUFLAG2                                                 02705000
CPUMSCIN EQU   CPUFLAG1                                                 02706000
OPJES3   EQU   OPSYSTYP                                                 02707000
CPUALTFL EQU   CPUFLAG1                                                 02708000
CPUTIGHT EQU   CPUFLAG1                                                 02709000
@NM00013 EQU   CPUFLAG1                                                 02710000
TOMPCPU  EQU   CPU+5                                                    02711000
CPUID    EQU   CPU                                                      02712000
CPUNUM   EQU   CPUASSOC                                                 02713000
LGDEVICE EQU   PHYSFLGS                                                 02714000
LOGABOX1 EQU   PHYSFLGS                                                 02715000
PHYSREAL EQU   PHYSFLGS                                                 02716000
PABDDD   EQU   PABAADDD                                                 02717000
PABAA    EQU   PABAADDD                                                 02718000
PABZEROS EQU   PABAADDD                                                 02719000
PAB2D    EQU   PABREAL                                                  02720000
PAB2C    EQU   PABREAL                                                  02721000
PAB2B    EQU   PABREAL                                                  02722000
@NM00012 EQU   PABREAL                                                  02723000
PAB1D    EQU   PABREAL                                                  02724000
PAB1C    EQU   PABREAL                                                  02725000
PAB1B    EQU   PABREAL                                                  02726000
PABIMPLR EQU   PABREAL                                                  02727000
PABBERG2 EQU   PABFLAGS                                                 02728000
@NM00011 EQU   PABFLAGS                                                 02729000
PABDSMTL EQU   PABFLAGS                                                 02730000
PABIBERG EQU   PABFLAGS                                                 02731000
@NM00010 EQU   PABFLAGS                                                 02732000
PABVOVIR EQU   PABFLAGS                                                 02733000
PABEXIST EQU   PABFLAGS                                                 02734000
MAPEXIT  EQU   LIB+4                                                    02735000
LIBMAP   EQU   LIB+3                                                    02736000
@NM00009 EQU   LIBBITS                                                  02737000
TODS2    EQU   RSGTODS+1                                                02738000
TODS1    EQU   RSGTODS                                                  02739000
RSGSLICE EQU   RSG+3                                                    02740000
RSGUDEL  EQU   RSG+2                                                    02741000
RSGLDEL  EQU   RSG+1                                                    02742000
@NM00008 EQU   RSG                                                      02743000
RSGABOX1 EQU   RSGABOX                                                  02744000
RSGABOX0 EQU   RSGABOX                                                  02745000
RSGSPEC  EQU   RSG                                                      02746000
SVSYSUT3 EQU   SAVEDDS+32                                               02747000
SVSYSUT2 EQU   SAVEDDS+24                                               02748000
SVSYSUT1 EQU   SAVEDDS+16                                               02749000
SVSYSPCH EQU   SAVEDDS+8                                                02750000
SVSYSIN  EQU   SAVEDDS                                                  02751000
PARMPTR  EQU   INVOKED                                                  02752000
BUILDPTR EQU   GENIO+20                                                 02753000
SAVE14   EQU   GENIO+12                                                 02754000
EXLST    EQU   GENIO+8                                                  02755000
@NM00007 EQU   DCBPTR+1                                                 02756000
DCBFLAG  EQU   DCBPTR                                                   02757000
OPENLIST EQU   GENIO                                                    02758000
@NM00006 EQU   MESSAGES+19                                              02759000
NEEDEOJ  EQU   SPECLMSG                                                 02760000
ENDPHASE EQU   SPECLMSG                                                 02761000
@NM00005 EQU   SPECLMSG                                                 02762000
PRNTCARD EQU   SPECLMSG                                                 02763000
@NM00004 EQU   SPECLMSG                                                 02764000
NEED102  EQU   SPECLMSG                                                 02765000
NEED101  EQU   SPECLMSG                                                 02766000
PRINTRC  EQU   MESSAGES+16                                              02767000
TERM     EQU   MESSAGES+12                                              02768000
WARN     EQU   MESSAGES+8                                               02769000
TERMINAT EQU   MESSAGES+6                                               02770000
WARNING  EQU   MESSAGES+4                                               02771000
MSGNO    EQU   MESSAGES+2                                               02772000
RETCODE  EQU   MESSAGES                                                 02773000
OUTBUF   EQU   PRINTER+104                                              02774000
PAGENO   EQU   PRINTER+96                                               02775000
DCBPRINT EQU   PRINTER                                                  02776000
@NM00003 EQU   READER+206                                               02777000
SCANLEN  EQU   READER+204                                               02778000
SVEODAD  EQU   READER+200                                               02779000
SVSYNAD2 EQU   READER+196                                               02780000
SAVENCOL EQU   READER+192                                               02781000
SAVESCOL EQU   READER+188                                               02782000
INBUF    EQU   READER+100                                               02783000
SSELECT  EQU   PCHBF                                                    02784000
@NM00002 EQU   READER+97                                                02785000
@NM00001 EQU   READFLAG                                                 02786000
LASTPARM EQU   READFLAG                                                 02787000
ENDSCAN  EQU   READFLAG                                                 02788000
PARMBIT  EQU   READFLAG                                                 02789000
KEYBIT   EQU   READFLAG                                                 02790000
READTERM EQU   READFLAG                                                 02791000
READDCB  EQU   READER                                                   02792000
PATCH    EQU   COMTAB                                                   02793000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      02794000
@RF00321 EQU   @RC00317                                                 02795000
@RF00329 EQU   @RC00325                                                 02796000
@RF00337 EQU   @RC00333                                                 02797000
@RF00354 EQU   @RC00350                                                 02798000
@RF00362 EQU   @RC00358                                                 02799000
@RF00370 EQU   @RC00366                                                 02800000
@RF00463 EQU   @EL00013                                                 02801000
@RF00474 EQU   @EL00014                                                 02802000
@RF00486 EQU   @EL00015                                                 02803000
@RC00495 EQU   @EL00015                                                 02804000
@RC00489 EQU   @EL00015                                                 02805000
@ENDDATA EQU   *                                                        02806000
         END   ICGDSB20,(C'PLS1609',0701,77362)                         02807000
