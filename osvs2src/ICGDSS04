         TITLE 'ICGDSS04 MSC TABLE CREATE, SCAN UPPERCON STATEMENT     *00001000
                        '                                               00002000
ICGDSS04 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'ICGDSS04  78.023'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @11,0                                               0001 00011000
@PSTART  LA    @10,4095(,@11)                                      0001 00012000
         USING @PSTART,@11                                         0001 00013000
         USING @PSTART+4095,@10                                    0001 00014000
         L     @00,@SIZDATD                                        0001 00015000
         GETMAIN  R,LV=(0)                                              00016000
         LR    @12,@01                                             0001 00017000
         USING @DATD,@12                                           0001 00018000
         ST    @13,@SA00001+4                                      0001 00019000
         LM    @00,@01,20(@13)                                     0001 00020000
         ST    @12,8(,@13)                                         0001 00021000
         LR    @13,@12                                             0001 00022000
         XC    @ZTEMPS(@ZLEN),@ZTEMPS                                   00023000
*                                                                  0044 00024000
*/********************************************************** @Y30LB12*/ 00025000
*/*                                                          @Y30LB12*/ 00026000
*/* PROCEDURE NAME - ICGDSS04 (MAINLINE)                     @Y30LB12*/ 00027000
*/*                                                          @Y30LB12*/ 00028000
*/* FUNCTION - CALL FOUR MAJOR PROCEDURED OF ICGDSS04.       @Y30LB12*/ 00029000
*/*            DO NOT CALL S04BUILD IF TERMINATING ERRORS    @Y30LB12*/ 00030000
*/*            ARE ENCOUNTERED.  RETURN TO CALLER (ICGDSSCN) @Y30LB12*/ 00031000
*/*                                                          @Y30LB12*/ 00032000
*/********************************************************** @Y30LB12*/ 00033000
*                                                                  0044 00034000
*   CALL S04INIT;                   /* INITIALIZE WORKA      @Y30LB12*/ 00035000
         BAL   @14,S04INIT                                         0044 00036000
*   CALL S04SCAN;                   /* GET KEYS, PARMS       @Y30LB12*/ 00037000
         BAL   @14,S04SCAN                                         0045 00038000
*   CALL S04ANAL;                   /* CROSS-CHECK           @Y30LB12*/ 00039000
         BAL   @14,S04ANAL                                         0046 00040000
*   IF STOPSCAN^='1'B               /* IF NO TERM. ERROR     @Y30LB12*/ 00041000
*     THEN                          /*                       @Y30LB12*/ 00042000
         TM    STOPSCAN,B'00001000'                                0047 00043000
         BO    @RF00047                                            0047 00044000
*     CALL S04BUILD;                /* UPDATE TABLES         @Y30LB12*/ 00045000
         BAL   @14,S04BUILD                                        0048 00046000
*   ELSE                                                           0049 00047000
*     ;                             /*                       @Y30LB12*/ 00048000
@RF00047 DS    0H                                                  0050 00049000
*   RETURN;                         /* TO ICGDSSCN           @Y30LB12*/ 00050000
@EL00001 L     @13,4(,@13)                                         0050 00051000
@EF00001 L     @00,@SIZDATD                                        0050 00052000
         LR    @01,@12                                             0050 00053000
         FREEMAIN R,LV=(0),A=(1)                                        00054000
@ER00001 LM    @14,@12,12(@13)                                     0050 00055000
         BR    @14                                                 0050 00056000
*                                                                  0051 00057000
*/********************************************************** @Y30LB12*/ 00058000
*/*                                                          @Y30LB12*/ 00059000
*/* PROCEDURE NAME - S04INIT                                 @Y30LB12*/ 00060000
*/*                                                          @Y30LB12*/ 00061000
*/* FUNCTION - INITIALIZE FLAG BYTES FOR PREVIOUSLY          @Y30LB12*/ 00062000
*/*            USED KEYWORDS (HAVES) TO ZEROS SINCE EACH     @Y30LB12*/ 00063000
*/*            UPPERCON STATEMENT IS INDEPENDENT OF ALL      @Y30LB12*/ 00064000
*/*            OTHERS.  INITIALIZE FLAG BYTE FOR RECOGNIZED  @Y30LB12*/ 00065000
*/*            KEYWORD SINCE NO KEYWORDS ARE YET RECOGNIZED. @Y30LB12*/ 00066000
*/*            INITIALIZE TWO SAVE AREAS FOR ADDRESSES       @Y30LB12*/ 00067000
*/*            DEFINED IN THIS UPPERCON CONTROL STATEMENT    @Y30LB12*/ 00068000
*/*                                                          @Y30LB12*/ 00069000
*/********************************************************** @Y30LB12*/ 00070000
*                                                                  0051 00071000
*S04INIT:                                                          0051 00072000
*   PROCEDURE;                      /*                       @Y30LB12*/ 00073000
S04INIT  STM   @14,@12,12(@13)                                     0051 00074000
*   UPCMSGID='00'X;                 /*                       @Y30LB12*/ 00075000
         MVI   UPCMSGID,X'00'                                      0052 00076000
*   HAVES='00'X;                    /*                       @Y30LB12*/ 00077000
         MVI   HAVES,X'00'                                         0053 00078000
*   DO I=1 TO MAXDEV;               /* 64 POSSIBLE ADDRS     @Y30LB12*/ 00079000
         LA    I,1                                                 0054 00080000
         B     @DE00054                                            0054 00081000
@DL00054 DS    0H                                                  0055 00082000
*     WK1ADDR(I)=INITDEV;           /* INIT TO BINARY 0      @Y30LB12*/ 00083000
         LR    @07,I                                               0055 00084000
         MH    @07,@CH00257                                        0055 00085000
         LA    @05,WK1ADDR-11(@07)                                 0055 00086000
         MVC   0(11,@05),INITDEV                                   0055 00087000
*     WK2ADDR(I)=INITDEV;           /* INIT TO BINARY 0      @Y30LB12*/ 00088000
         LA    @05,WK2ADDR-11(@07)                                 0056 00089000
         MVC   0(11,@05),INITDEV                                   0056 00090000
*   END;                            /* END OF DO I           @Y30LB12*/ 00091000
         AH    I,@CH00044                                          0057 00092000
@DE00054 CH    I,MAXDEV                                            0057 00093000
         BNH   @DL00054                                            0057 00094000
*   END S04INIT;                    /* TO S04 MAINLINE       @Y30LB12*/ 00095000
@EL00002 DS    0H                                                  0058 00096000
@EF00002 DS    0H                                                  0058 00097000
@ER00002 LM    @14,@12,12(@13)                                     0058 00098000
         BR    @14                                                 0058 00099000
*                                                                  0059 00100000
*/********************************************************** @Y30LB12*/ 00101000
*/*                                                          @Y30LB12*/ 00102000
*/* PROCEDURE NAME - S04SCAN                                 @Y30LB12*/ 00103000
*/*                                                          @Y30LB12*/ 00104000
*/* FUNCTION - SCAN MAJOR KEYWORDS AND CALL PROPER ROUTINE   @Y30LB12*/ 00105000
*/*            TO HANDLE PARAMETER.  IF KEYWORD HAS RELATED  @Y30LB12*/ 00106000
*/*            SUB-KEYWORDS AND/OR SUB-PARAMETERS, THEY WILL @Y30LB12*/ 00107000
*/*            IN TURN BE HANDLED BY THE CALLED PROCEDURE.   @Y30LB12*/ 00108000
*/*                                                          @Y30LB12*/ 00109000
*/********************************************************** @Y30LB12*/ 00110000
*                                                                  0059 00111000
*S04SCAN:                                                          0059 00112000
*   PROCEDURE;                      /*                       @Y30LB12*/ 00113000
S04SCAN  STM   @14,@12,@SA00003                                    0059 00114000
*   DO WHILE(LASTPARM^='1'B);       /* TILL NO MORE DATA     @Y30LB12*/ 00115000
         B     @DE00060                                            0060 00116000
@DL00060 DS    0H                                                  0061 00117000
*     HAVEADDR='0'B;                /* RESET ADDR FLAG       @Y30LB12*/ 00118000
         NI    HAVEADDR,B'11111110'                                0061 00119000
*     KNOWN='0'B;                   /*                       @Y30LB12*/ 00120000
         NI    KNOWN,B'01111111'                                   0062 00121000
*     CALL READS99;                 /* EXTRACT KEYWORD       @Y30LB12*/ 00122000
         BAL   @14,READS99                                         0063 00123000
*     IF LASTPARM='1'B              /* IF NO DATA LEFT       @Y30LB12*/ 00124000
*       THEN                        /* TO PROCESS, RET.      @Y30LB12*/ 00125000
         TM    LASTPARM(R4),B'00001000'                            0064 00126000
         BO    @RT00064                                            0064 00127000
*       RETURN;                     /* TO S04 MAINLINE       @Y30LB12*/ 00128000
*     ELSE                                                         0066 00129000
*       ;                           /* WAS SOMETHING         @Y30LB12*/ 00130000
*                                                                  0066 00131000
*     /***************************************************************/ 00132000
*     /*                                                             */ 00133000
*     /* ***********************************************     @Y30LB12*/ 00134000
*     /* WE EXPECT THE 'SOMETHING' THAT WE EXTRACTED         @Y30LB12*/ 00135000
*     /* FROM THE INPUT BUFFER TO BE A KEYWORD (A FIELD      @Y30LB12*/ 00136000
*     /* TERMINATED BY AN EQUAL SIGN. IF THE DATA IS         @Y30LB12*/ 00137000
*     /* NOT A KEYWORD, WE ARE LOST. WRITE ERROR             @Y30LB12*/ 00138000
*     /* MESSAGE 'ICG209I EXPECTED, BUT DID NOT FIND,        @Y30LB12*/ 00139000
*     /* KEYWORD', AND DISCONTINUE SCAN OF THIS              @Y30LB12*/ 00140000
*     /* CONTROL STATEMENT.                                  @Y30LB12*/ 00141000
*     /* KEYBIT IS SET IN THE MODULE ICGDSS99.               @Y30LB12*/ 00142000
*     /* ***********************************************     @Y30LB12*/ 00143000
*     /*                                                             */ 00144000
*     /***************************************************************/ 00145000
*                                                                  0067 00146000
*     IF KEYBIT^='1'B               /* IF NOT KEYWORD,       @Y30LB12*/ 00147000
*       THEN                        /*                       @Y30LB12*/ 00148000
         TM    KEYBIT(R4),B'01000000'                              0067 00149000
         BO    @RF00067                                            0067 00150000
*       DO;                         /*                       @Y30LB12*/ 00151000
*         MSGNO=ICG209I;            /* ID FOR ICGDS209       @Y30LB12*/ 00152000
         MVC   MSGNO(2,R4),ICG209I                                 0069 00153000
*         CALL PUTIT2;              /* CALL MSG WRITER       @Y30LB12*/ 00154000
         BAL   @14,PUTIT2                                          0070 00155000
*         RETURN;                   /* TO S04 MAINLINE       @Y30LB12*/ 00156000
@EL00003 DS    0H                                                  0071 00157000
@EF00003 DS    0H                                                  0071 00158000
@ER00003 LM    @14,@12,@SA00003                                    0071 00159000
         BR    @14                                                 0071 00160000
*       END;                        /*                       @Y30LB12*/ 00161000
*     ELSE                                                         0073 00162000
*       ;                           /*                       @Y30LB12*/ 00163000
*                                                                  0073 00164000
@RF00067 DS    0H                                                  0074 00165000
*     /***************************************************************/ 00166000
*     /*                                                             */ 00167000
*     /* ***********************************************     @Y30LB12*/ 00168000
*     /* IF THE FIELD LAST SCANNED WAS THE KEYWORD 'SA'      @Y30LB12*/ 00169000
*     /* ***********************************************     @Y30LB12*/ 00170000
*     /*                                                             */ 00171000
*     /***************************************************************/ 00172000
*                                                                  0074 00173000
*     IF SCANDATA(1:3)='SA='        /*                       @Y30LB12*/ 00174000
*       THEN                        /*                       @Y30LB12*/ 00175000
         L     @07,STARTCOL(,R4)                                   0074 00176000
         CLC   SCANDATA(3,@07),@CC00554                            0074 00177000
         BNE   @RF00074                                            0074 00178000
*       DO;                         /*                       @Y30LB12*/ 00179000
*         KNOWN='1'B;               /* RECOGNIZED KEYWD      @Y30LB12*/ 00180000
         OI    KNOWN,B'10000000'                                   0076 00181000
*         CALL S04DS;               /* TO GET PARAMETER      @Y30LB12*/ 00182000
         BAL   @14,S04DS                                           0077 00183000
*       END;                        /*                       @Y30LB12*/ 00184000
*     ELSE                                                         0079 00185000
*       ;                           /*                       @Y30LB12*/ 00186000
*                                                                  0079 00187000
@RF00074 DS    0H                                                  0080 00188000
*     /***************************************************************/ 00189000
*     /*                                                             */ 00190000
*     /* ***********************************************     @Y30LB12*/ 00191000
*     /* IF THE FIELD LAST SCANNED WAS THE KEYWORD 'CI'      @Y30LB12*/ 00192000
*     /* ***********************************************     @Y30LB12*/ 00193000
*     /*                                                             */ 00194000
*     /***************************************************************/ 00195000
*                                                                  0080 00196000
*     IF SCANDATA(1:3)='CI='        /*                       @Y30LB12*/ 00197000
*       THEN                        /*                       @Y30LB12*/ 00198000
         L     @07,STARTCOL(,R4)                                   0080 00199000
         CLC   SCANDATA(3,@07),@CC00556                            0080 00200000
         BNE   @RF00080                                            0080 00201000
*       DO;                         /*                       @Y30LB12*/ 00202000
*         KNOWN='1'B;               /* RECOGNIZED KEYWD      @Y30LB12*/ 00203000
         OI    KNOWN,B'10000000'                                   0082 00204000
*         CALL S04CI;               /* TO GET PARAMETER      @Y30LB12*/ 00205000
         BAL   @14,S04CI                                           0083 00206000
*       END;                        /*                       @Y30LB12*/ 00207000
*     ELSE                                                         0085 00208000
*       ;                           /*                       @Y30LB12*/ 00209000
*                                                                  0085 00210000
@RF00080 DS    0H                                                  0086 00211000
*     /***************************************************************/ 00212000
*     /*                                                             */ 00213000
*     /* ***********************************************     @Y30LB12*/ 00214000
*     /* IF THE FIELD LAST SCANNED WAS THE KEYWORD 'CH'      @Y30LB12*/ 00215000
*     /* ***********************************************     @Y30LB12*/ 00216000
*     /*                                                             */ 00217000
*     /***************************************************************/ 00218000
*                                                                  0086 00219000
*     IF SCANDATA(1:3)='CH='        /*                       @Y30LB12*/ 00220000
*       THEN                        /*                       @Y30LB12*/ 00221000
         L     @07,STARTCOL(,R4)                                   0086 00222000
         CLC   SCANDATA(3,@07),@CC00558                            0086 00223000
         BNE   @RF00086                                            0086 00224000
*       DO;                         /*                       @Y30LB12*/ 00225000
*         KNOWN='1'B;               /* RECOGNIZED KEYWD      @Y30LB12*/ 00226000
         OI    KNOWN,B'10000000'                                   0088 00227000
*         CALL S04CH;               /* TO GET PARAMETER      @Y30LB12*/ 00228000
         BAL   @14,S04CH                                           0089 00229000
*       END;                        /*                       @Y30LB12*/ 00230000
*     ELSE                                                         0091 00231000
*       ;                           /*                       @Y30LB12*/ 00232000
*                                                                  0091 00233000
@RF00086 DS    0H                                                  0092 00234000
*     /***************************************************************/ 00235000
*     /*                                                             */ 00236000
*     /* ***********************************************     @Y30LB12*/ 00237000
*     /* IF THE FIELD LAST SCANNED WAS THE KEYWORD @Y30LB12X 'CUID'  */ 00238000
*     /*                                                     @Y30LB12*/ 00239000
*     /* ***********************************************     @Y30LB12*/ 00240000
*     /*                                                             */ 00241000
*     /***************************************************************/ 00242000
*                                                                  0092 00243000
*     IF SCANDATA(1:5)='CUID='      /*                       @Y30LB12*/ 00244000
*       THEN                        /*                       @Y30LB12*/ 00245000
         L     @07,STARTCOL(,R4)                                   0092 00246000
         CLC   SCANDATA(5,@07),@CC00560                            0092 00247000
         BNE   @RF00092                                            0092 00248000
*       DO;                         /*                       @Y30LB12*/ 00249000
*         KNOWN='1'B;               /* RECOGNIZED KEYWD      @Y30LB12*/ 00250000
         OI    KNOWN,B'10000000'                                   0094 00251000
*         CALL S04CUID;             /* TO GET PARAMETER      @Y30LB12*/ 00252000
         BAL   @14,S04CUID                                         0095 00253000
*       END;                        /*                       @Y30LB12*/ 00254000
*     ELSE                                                         0097 00255000
*       ;                           /*                       @Y30LB12*/ 00256000
*                                                                  0097 00257000
@RF00092 DS    0H                                                  0098 00258000
*     /***************************************************************/ 00259000
*     /*                                                             */ 00260000
*     /* ***********************************************     @Y30LB12*/ 00261000
*     /* IF THE FIELD LAST SCANNED WAS THE KEYWORD           @Y30LB12*/ 00262000
*     /* 'CPUID'                                             @Y30LB12*/ 00263000
*     /* ***********************************************     @Y30LB12*/ 00264000
*     /*                                                             */ 00265000
*     /***************************************************************/ 00266000
*                                                                  0098 00267000
*     IF SCANDATA(1:6)='CPUID='     /*                       @Y30LB12*/ 00268000
*       THEN                        /*                       @Y30LB12*/ 00269000
         L     @07,STARTCOL(,R4)                                   0098 00270000
         CLC   SCANDATA(6,@07),@CC00562                            0098 00271000
         BNE   @RF00098                                            0098 00272000
*       DO;                         /*                       @Y30LB12*/ 00273000
*         KNOWN='1'B;               /* RECOGNIZED KEYWD      @Y30LB12*/ 00274000
         OI    KNOWN,B'10000000'                                   0100 00275000
*         CALL S04CPUID;            /* TO GET PARAMETER      @Y30LB12*/ 00276000
         BAL   @14,S04CPUID                                        0101 00277000
*       END;                        /*                       @Y30LB12*/ 00278000
*     ELSE                                                         0103 00279000
*       ;                           /*                       @Y30LB12*/ 00280000
*                                                                  0103 00281000
@RF00098 DS    0H                                                  0104 00282000
*     /***************************************************************/ 00283000
*     /*                                                             */ 00284000
*     /* ***********************************************     @Y30LB12*/ 00285000
*     /* IF THE FIELD LAST SCANNED WAS THE KEYWORD 'V',      @Y30LB12*/ 00286000
*     /* THERE IS POSSIBILITY THAT ALTERNATE PATHS ARE       @Y30LB12*/ 00287000
*     /* SPECIFIED, SO INITIALIZE ALTERNATE PATH AREAS.      @Y30LB12*/ 00288000
*     /* SET UP VARIABLE NAME IN PLUGIN IN CASE ANY          @Y30LB12*/ 00289000
*     /* MESSAGES ARE NEEDED IN ANY CALLED PROCEDURES.       @Y30LB12*/ 00290000
*     /* WHEN ALL THE SUB-KEYWORDS AND SUB-PARAMETERS        @Y30LB12*/ 00291000
*     /* ASSOCIATED WITH THE KEYWORD 'V' HAVE BEEN           @Y30LB12*/ 00292000
*     /* SCANNED AND STORED IN THE PROPER WORK AREAS,        @Y30LB12*/ 00293000
*     /* SET THE FLAG BIT 'USEV' FOR ALL ADDRESSES           @Y30LB12*/ 00294000
*     /* SPECIFIED, MOVE ALTERNATE PATH INFORMATION          @Y30LB12*/ 00295000
*     /* INTO EACH SPECIFIED ADDRESS ENTRY, AND UPDATE       @Y30LB12*/ 00296000
*     /* THE SECOND ADDRESS WORK AREA FROM DATA SAVED        @Y30LB12*/ 00297000
*     /* IN THE FIRST ADDRESS WORK AREA.                     @Y30LB12*/ 00298000
*     /* ***********************************************     @Y30LB12*/ 00299000
*     /*                                                             */ 00300000
*     /***************************************************************/ 00301000
*                                                                  0104 00302000
*     IF SCANDATA(1:2)='V='&KNOWN='0'B/*                     @Y30LB12*/ 00303000
*       THEN                        /*                       @Y30LB12*/ 00304000
         L     @07,STARTCOL(,R4)                                   0104 00305000
         CLC   SCANDATA(2,@07),@CC00564                            0104 00306000
         BNE   @RF00104                                            0104 00307000
         TM    KNOWN,B'10000000'                                   0104 00308000
         BNZ   @RF00104                                            0104 00309000
*       DO;                         /*                       @Y30LB12*/ 00310000
*         ALTCOUNT=0;               /*                       @Y30LB12*/ 00311000
         SLR   @07,@07                                             0106 00312000
         STH   @07,ALTCOUNT                                        0106 00313000
*         ALTPATHS='000000000000000000000000'X;/*            @Y30LB12*/ 00314000
         MVC   ALTPATHS(12),@CB00566                               0107 00315000
*         KNOWN='1'B;               /* RECOGNIZED KEYWD      @Y30LB12*/ 00316000
         OI    KNOWN,B'10000000'                                   0108 00317000
*         PLUGIN='V, ADDR ';        /* FOR MESSAGE TEXT      @YM31098*/ 00318000
         MVC   PLUGIN(8),@CC00568                                  0109 00319000
*         CALL S04VVS;              /* GET SUB-KEYWORDS      @Y30LB12*/ 00320000
         BAL   @14,S04VVS                                          0110 00321000
*         DO I=1 TO MAXDEV;         /* 64 POSSIBLE ADDRS     @Y30LB12*/ 00322000
         LA    I,1                                                 0111 00323000
         B     @DE00111                                            0111 00324000
@DL00111 DS    0H                                                  0112 00325000
*           IF ADR1SPEC(I)='1'B     /* IF USED HERE          @Y30LB12*/ 00326000
*             THEN                  /*                       @Y30LB12*/ 00327000
         LR    @07,I                                               0112 00328000
         MH    @07,@CH00257                                        0112 00329000
         LA    @05,ADR1SPEC-11(@07)                                0112 00330000
         TM    0(@05),B'10000000'                                  0112 00331000
         BNO   @RF00112                                            0112 00332000
*             ADR1V(I)='1'B;        /* SET USE TO VIRT.      @Y30LB12*/ 00333000
         LA    @05,ADR1V-11(@07)                                   0113 00334000
         OI    0(@05),B'01000000'                                  0113 00335000
*           ELSE                                                   0114 00336000
*             ;                     /* ELSE DO NOTHING       @Y30LB12*/ 00337000
@RF00112 DS    0H                                                  0115 00338000
*         END;                      /* EXAMINED ALL 64       @Y30LB12*/ 00339000
         AH    I,@CH00044                                          0115 00340000
@DE00111 CH    I,MAXDEV                                            0115 00341000
         BNH   @DL00111                                            0115 00342000
*         CALL RSGALTP;             /* MOVE IN ALT PATH      @Y30LB12*/ 00343000
         BAL   @14,RSGALTP                                         0116 00344000
*         CALL WK1TOWK2;            /* MOVE TO 2ND WORKA     @Y30LB12*/ 00345000
         BAL   @14,WK1TOWK2                                        0117 00346000
*       END;                        /*                       @Y30LB12*/ 00347000
*     ELSE                                                         0119 00348000
*       ;                           /*                       @Y30LB12*/ 00349000
*                                                                  0119 00350000
@RF00104 DS    0H                                                  0120 00351000
*     /***************************************************************/ 00352000
*     /*                                                             */ 00353000
*     /* ***********************************************     @Y30LB12*/ 00354000
*     /* IF THE FIELD LAST SCANNED WAS THE KEYWORD           @Y30LB12*/ 00355000
*     /* 'VS', PROCESSING IS THE SAME AS FOR KEYWORD         @Y30LB12*/ 00356000
*     /* 'V' EXCEPT THAT THE FLAG 'USEVS' IS SET             @Y30LB12*/ 00357000
*     /* INSTEAD OF THE FLAG 'USEV'.                         @Y30LB12*/ 00358000
*     /* ***********************************************     @Y30LB12*/ 00359000
*     /*                                                             */ 00360000
*     /***************************************************************/ 00361000
*                                                                  0120 00362000
*     IF SCANDATA(1:3)='VS='&KNOWN='0'B/*                    @Y30LB12*/ 00363000
*       THEN                        /*                       @Y30LB12*/ 00364000
         L     @07,STARTCOL(,R4)                                   0120 00365000
         CLC   SCANDATA(3,@07),@CC00572                            0120 00366000
         BNE   @RF00120                                            0120 00367000
         TM    KNOWN,B'10000000'                                   0120 00368000
         BNZ   @RF00120                                            0120 00369000
*       DO;                         /*                       @Y30LB12*/ 00370000
*         ALTCOUNT=0;               /* ALT. PATH COUNTER     @Y30LB12*/ 00371000
         SLR   @07,@07                                             0122 00372000
         STH   @07,ALTCOUNT                                        0122 00373000
*         ALTPATHS='000000000000000000000000'X;/*            @Y30LB12*/ 00374000
         MVC   ALTPATHS(12),@CB00566                               0123 00375000
*         KNOWN='1'B;               /* RECOGNIZED KEYWD      @Y30LB12*/ 00376000
         OI    KNOWN,B'10000000'                                   0124 00377000
*         PLUGIN='VS, ADDR';        /* FOR MESSAGE TEXT      @YM31098*/ 00378000
         MVC   PLUGIN(8),@CC00573                                  0125 00379000
*         CALL S04VVS;              /* GET SUB-KEYWORDS      @Y30LB12*/ 00380000
         BAL   @14,S04VVS                                          0126 00381000
*         DO I=1 TO MAXDEV;         /* 64 POSSIBLE ADDRS     @Y30LB12*/ 00382000
         LA    I,1                                                 0127 00383000
         B     @DE00127                                            0127 00384000
@DL00127 DS    0H                                                  0128 00385000
*           IF ADR1SPEC(I)='1'B     /* IF USED HERE          @Y30LB12*/ 00386000
*             THEN                  /*                       @Y30LB12*/ 00387000
         LR    @07,I                                               0128 00388000
         MH    @07,@CH00257                                        0128 00389000
         LA    @05,ADR1SPEC-11(@07)                                0128 00390000
         TM    0(@05),B'10000000'                                  0128 00391000
         BNO   @RF00128                                            0128 00392000
*             ADR1VS(I)='1'B;       /* SET SHARED VIRT       @Y30LB12*/ 00393000
         LA    @05,ADR1VS-11(@07)                                  0129 00394000
         OI    0(@05),B'00100000'                                  0129 00395000
*           ELSE                                                   0130 00396000
*             ;                     /* ELSE DO NOTHING       @Y30LB12*/ 00397000
@RF00128 DS    0H                                                  0131 00398000
*         END;                      /* EXAMINED ALL 64       @Y30LB12*/ 00399000
         AH    I,@CH00044                                          0131 00400000
@DE00127 CH    I,MAXDEV                                            0131 00401000
         BNH   @DL00127                                            0131 00402000
*         CALL RSGALTP;             /* MOVE IN ALT PATH      @Y30LB12*/ 00403000
         BAL   @14,RSGALTP                                         0132 00404000
*         CALL WK1TOWK2;            /* MOVE TO 2ND WORKA     @Y30LB12*/ 00405000
         BAL   @14,WK1TOWK2                                        0133 00406000
*       END;                        /*                       @Y30LB12*/ 00407000
*     ELSE                                                         0135 00408000
*       ;                           /*                       @Y30LB12*/ 00409000
*                                                                  0135 00410000
@RF00120 DS    0H                                                  0136 00411000
*     /***************************************************************/ 00412000
*     /*                                                             */ 00413000
*     /* ***********************************************     @Y30LB12*/ 00414000
*     /* IF THE FIELD LAST SCANNED WAS THE KEYWORD           @Y30LB12*/ 00415000
*     /* 'REAL', ONLY THE FIRST 32 ADDRESSES                 @Y30LB12*/ 00416000
*     /* (00-1F) ARE VALID.                                  @Y30LB12*/ 00417000
*     /* ***********************************************     @Y30LB12*/ 00418000
*     /*                                                             */ 00419000
*     /***************************************************************/ 00420000
*                                                                  0136 00421000
*     IF SCANDATA(1:5)='REAL='&KNOWN='0'B/*                  @Y30LB12*/ 00422000
*       THEN                        /*                       @Y30LB12*/ 00423000
         L     @07,STARTCOL(,R4)                                   0136 00424000
         CLC   SCANDATA(5,@07),@CC00574                            0136 00425000
         BNE   @RF00136                                            0136 00426000
         TM    KNOWN,B'10000000'                                   0136 00427000
         BNZ   @RF00136                                            0136 00428000
*       DO;                         /*                       @Y30LB12*/ 00429000
*         ALTCOUNT=0;               /*                       @OZ09548*/ 00430000
         SLR   @07,@07                                             0138 00431000
         STH   @07,ALTCOUNT                                        0138 00432000
*         ALTPATHS='000000000000000000000000'X;/*            @OZ09548*/ 00433000
         MVC   ALTPATHS(12),@CB00566                               0139 00434000
*         KNOWN='1'B;               /* RECOGNIZED KEYWD      @Y30LB12*/ 00435000
         OI    KNOWN,B'10000000'                                   0140 00436000
*         PLUGIN='REAL    ';        /* FOR MESSAGE TEXT      @Y30LB12*/ 00437000
         MVC   PLUGIN(8),@CC00575                                  0141 00438000
*         CALL S04ADDR;             /* TO GET ADDRESSES      @Y30LB12*/ 00439000
         BAL   @14,S04ADDR                                         0142 00440000
*         DO I=1 TO MAXREAL;        /* FIRST 32 VALID        @Y30LB12*/ 00441000
         LA    I,1                                                 0143 00442000
         B     @DE00143                                            0143 00443000
@DL00143 DS    0H                                                  0144 00444000
*           IF ADR1SPEC(I)='1'B     /* IF USED HERE          @Y30LB12*/ 00445000
*             THEN                  /*                       @Y30LB12*/ 00446000
         LR    @07,I                                               0144 00447000
         MH    @07,@CH00257                                        0144 00448000
         LA    @05,ADR1SPEC-11(@07)                                0144 00449000
         TM    0(@05),B'10000000'                                  0144 00450000
         BNO   @RF00144                                            0144 00451000
*             ADR1REAL(I)='1'B;     /* USE IS REAL           @Y30LB12*/ 00452000
         LA    @05,ADR1REAL-11(@07)                                0145 00453000
         OI    0(@05),B'00010000'                                  0145 00454000
*           ELSE                                                   0146 00455000
*             ;                     /*                       @Y30LB12*/ 00456000
@RF00144 DS    0H                                                  0147 00457000
*         END;                      /* CHECKED 1ST 32        @Y30LB12*/ 00458000
         AH    I,@CH00044                                          0147 00459000
@DE00143 CH    I,MAXREAL                                           0147 00460000
         BNH   @DL00143                                            0147 00461000
*         DO I=MAXREAL+1 TO MAXDEV; /* 2ND 32 ERROR          @Y30LB12*/ 00462000
         LA    I,1                                                 0148 00463000
         AH    I,MAXREAL                                           0148 00464000
         B     @DE00148                                            0148 00465000
@DL00148 DS    0H                                                  0149 00466000
*           IF ADR1SPEC(I)='1'B     /* IF USED HERE          @Y30LB12*/ 00467000
*             THEN                  /*                       @Y30LB12*/ 00468000
         LR    @07,I                                               0149 00469000
         MH    @07,@CH00257                                        0149 00470000
         LA    @05,ADR1SPEC-11(@07)                                0149 00471000
         TM    0(@05),B'10000000'                                  0149 00472000
         BNO   @RF00149                                            0149 00473000
*             DO;                   /*                       @Y30LB12*/ 00474000
*                                                                  0150 00475000
*               /*****************************************************/ 00476000
*               /*                                                   */ 00477000
*               /* *********************************         @Y30LB12*/ 00478000
*               /* ICG238I ADDRESS XX INVALID                @Y30LB12*/ 00479000
*               /* FOR REAL                                  @Y30LB12*/ 00480000
*               /* *********************************         @Y30LB12*/ 00481000
*               /*                                                   */ 00482000
*               /*****************************************************/ 00483000
*                                                                  0151 00484000
*               OUTBUF2(1:32)=ICGDS238;/*                    @Y30LB12*/ 00485000
         MVC   OUTBUF2(32,R4),ICGDS238                             0151 00486000
*               OUTBUF2(33:36)='REAL';/*                     @Y30LB12*/ 00487000
         MVC   OUTBUF2+32(4,R4),@CC00579                           0152 00488000
*               OUTBUF2(18:19)=PATTERN(I);/*                 @Y30LB12*/ 00489000
         LR    @07,I                                               0153 00490000
         ALR   @07,@07                                             0153 00491000
         LA    @05,PATTERN-2(@07)                                  0153 00492000
         MVC   OUTBUF2+17(2,R4),0(@05)                             0153 00493000
*               CALL PUTIT1;        /* TO MESSAGE WRITER     @Y30LB12*/ 00494000
         BAL   @14,PUTIT1                                          0154 00495000
*             END;                  /*                       @Y30LB12*/ 00496000
*           ELSE                                                   0156 00497000
*             ;                     /*                       @Y30LB12*/ 00498000
@RF00149 DS    0H                                                  0157 00499000
*         END;                      /* CHECKED 2ND 32        @Y30LB12*/ 00500000
         AH    I,@CH00044                                          0157 00501000
@DE00148 CH    I,MAXDEV                                            0157 00502000
         BNH   @DL00148                                            0157 00503000
*         CALL REALALTP;            /* CHECK FOR ALTPATH     @OZ09548*/ 00504000
         BAL   @14,REALALTP                                        0158 00505000
*         CALL WK1TOWK2;            /* MOVE TO 2ND WORKA     @Y30LB12*/ 00506000
         BAL   @14,WK1TOWK2                                        0159 00507000
*       END;                        /*                       @Y30LB12*/ 00508000
*     ELSE                                                         0161 00509000
*       ;                           /*                       @Y30LB12*/ 00510000
*                                                                  0161 00511000
@RF00136 DS    0H                                                  0162 00512000
*     /***************************************************************/ 00513000
*     /*                                                             */ 00514000
*     /* ***********************************************     @Y30LB12*/ 00515000
*     /* IF THE FIELD LAST SCANNED WAS THE KEYWORD           @Y30LB12*/ 00516000
*     /* 'CONVREAL', PROCESSING IS THE SAME AS FOR           @Y30LB12*/ 00517000
*     /* REAL EXCEPT THAT THE USE FLAG SET                   @Y30LB12*/ 00518000
*     /* IS 'USECONVR'                                       @Y30LB12*/ 00519000
*     /* ***********************************************     @Y30LB12*/ 00520000
*     /*                                                             */ 00521000
*     /***************************************************************/ 00522000
*                                                                  0162 00523000
*     IF SCANDATA(1:9)='CONVREAL='&KNOWN='0'B/*              @Y30LB12*/ 00524000
*       THEN                        /*                       @Y30LB12*/ 00525000
         L     @07,STARTCOL(,R4)                                   0162 00526000
         CLC   SCANDATA(9,@07),@CC00584                            0162 00527000
         BNE   @RF00162                                            0162 00528000
         TM    KNOWN,B'10000000'                                   0162 00529000
         BNZ   @RF00162                                            0162 00530000
*       DO;                         /*                       @Y30LB12*/ 00531000
*         ALTCOUNT=0;               /* ALT. PATH COUNTER     @OZ09548*/ 00532000
         SLR   @07,@07                                             0164 00533000
         STH   @07,ALTCOUNT                                        0164 00534000
*         ALTPATHS='000000000000000000000000'X;/*            @OZ09548*/ 00535000
         MVC   ALTPATHS(12),@CB00566                               0165 00536000
*         KNOWN='1'B;               /* RECOGNIZED KEYWD      @Y30LB12*/ 00537000
         OI    KNOWN,B'10000000'                                   0166 00538000
*         PLUGIN='CONVREAL';        /* FOR MESSAGE TEXT      @Y30LB12*/ 00539000
         MVC   PLUGIN(8),@CC00586                                  0167 00540000
*         CALL S04ADDR;             /* TO GET ADDRESSES      @Y30LB12*/ 00541000
         BAL   @14,S04ADDR                                         0168 00542000
*         DO I=1 TO MAXREAL;        /* FIRST 32 VALID        @Y30LB12*/ 00543000
         LA    I,1                                                 0169 00544000
         B     @DE00169                                            0169 00545000
@DL00169 DS    0H                                                  0170 00546000
*           IF ADR1SPEC(I)='1'B     /* IF USED HERE          @Y30LB12*/ 00547000
*             THEN                  /*                       @Y30LB12*/ 00548000
         LR    @07,I                                               0170 00549000
         MH    @07,@CH00257                                        0170 00550000
         LA    @05,ADR1SPEC-11(@07)                                0170 00551000
         TM    0(@05),B'10000000'                                  0170 00552000
         BNO   @RF00170                                            0170 00553000
*             ADR1CONV(I)='1'B;     /* USE CONVERTIBLE       @Y30LB12*/ 00554000
         LA    @05,ADR1CONV-11(@07)                                0171 00555000
         OI    0(@05),B'00000100'                                  0171 00556000
*           ELSE                                                   0172 00557000
*             ;                     /*                       @Y30LB12*/ 00558000
@RF00170 DS    0H                                                  0173 00559000
*         END;                      /* CHECKED FIRST 32      @Y30LB12*/ 00560000
         AH    I,@CH00044                                          0173 00561000
@DE00169 CH    I,MAXREAL                                           0173 00562000
         BNH   @DL00169                                            0173 00563000
*         DO I=MAXREAL+1 TO MAXDEV; /* 32 INVALID            @Y30LB12*/ 00564000
         LA    I,1                                                 0174 00565000
         AH    I,MAXREAL                                           0174 00566000
         B     @DE00174                                            0174 00567000
@DL00174 DS    0H                                                  0175 00568000
*           IF ADR1SPEC(I)='1'B     /*                       @Y30LB12*/ 00569000
*             THEN                  /*                       @Y30LB12*/ 00570000
         LR    @07,I                                               0175 00571000
         MH    @07,@CH00257                                        0175 00572000
         LA    @05,ADR1SPEC-11(@07)                                0175 00573000
         TM    0(@05),B'10000000'                                  0175 00574000
         BNO   @RF00175                                            0175 00575000
*             DO;                   /*                       @Y30LB12*/ 00576000
*                                                                  0176 00577000
*               /*****************************************************/ 00578000
*               /*                                                   */ 00579000
*               /* *********************************         @Y30LB12*/ 00580000
*               /* ICG238I ADDRESS XX INVALID                @Y30LB12*/ 00581000
*               /* FOR CONVREAL                              @Y30LB12*/ 00582000
*               /* *********************************         @Y30LB12*/ 00583000
*               /*                                                   */ 00584000
*               /*****************************************************/ 00585000
*                                                                  0177 00586000
*               OUTBUF2(1:32)=ICGDS238;/*                    @Y30LB12*/ 00587000
         MVC   OUTBUF2(32,R4),ICGDS238                             0177 00588000
*               OUTBUF2(33:40)='CONVREAL';/*                 @Y30LB12*/ 00589000
         MVC   OUTBUF2+32(8,R4),@CC00586                           0178 00590000
*               OUTBUF2(18:19)=PATTERN(I);/*                 @Y30LB12*/ 00591000
         LR    @07,I                                               0179 00592000
         ALR   @07,@07                                             0179 00593000
         LA    @05,PATTERN-2(@07)                                  0179 00594000
         MVC   OUTBUF2+17(2,R4),0(@05)                             0179 00595000
*               CALL PUTIT1;        /* TO MESSAGE WRITER     @Y30LB12*/ 00596000
         BAL   @14,PUTIT1                                          0180 00597000
*             END;                  /*                       @Y30LB12*/ 00598000
*           ELSE                                                   0182 00599000
*             ;                     /*                       @Y30LB12*/ 00600000
@RF00175 DS    0H                                                  0183 00601000
*         END;                      /* CHECKED 2ND 32        @Y30LB12*/ 00602000
         AH    I,@CH00044                                          0183 00603000
@DE00174 CH    I,MAXDEV                                            0183 00604000
         BNH   @DL00174                                            0183 00605000
*         CALL REALALTP;            /* CHECK FOR ALTPATH     @OZ09548*/ 00606000
         BAL   @14,REALALTP                                        0184 00607000
*         CALL WK1TOWK2;            /* MOVE TO 2ND WORKA     @Y30LB12*/ 00608000
         BAL   @14,WK1TOWK2                                        0185 00609000
*       END;                        /*                       @Y30LB12*/ 00610000
*     ELSE                                                         0187 00611000
*       ;                           /*                       @Y30LB12*/ 00612000
*                                                                  0187 00613000
@RF00162 DS    0H                                                  0188 00614000
*     /***************************************************************/ 00615000
*     /*                                                             */ 00616000
*     /* ***********************************************     @Y30LB12*/ 00617000
*     /* THE KEYWORD WAS NOT RECOGNIZED AS ANY OF THE        @Y30LB12*/ 00618000
*     /* ABOVE...                                            @Y30LB12*/ 00619000
*     /* ***********************************************     @Y30LB12*/ 00620000
*     /*                                                             */ 00621000
*     /***************************************************************/ 00622000
*                                                                  0188 00623000
*     IF KNOWN='0'B                 /* REC. KEYWORD FLAG     @Y30LB12*/ 00624000
*       THEN                        /*                       @Y30LB12*/ 00625000
         TM    KNOWN,B'10000000'                                   0188 00626000
         BNZ   @RF00188                                            0188 00627000
*       CALL UNKNOWN;               /* TO WRITE MSG, ETC     @Y30LB12*/ 00628000
         BAL   @14,UNKNOWN                                         0189 00629000
*     ELSE                                                         0190 00630000
*       ;                           /*                       @Y30LB12*/ 00631000
@RF00188 DS    0H                                                  0191 00632000
*   END;                            /* END OF DO WHILE       @Y30LB12*/ 00633000
@DE00060 TM    LASTPARM(R4),B'00001000'                            0191 00634000
         BNO   @DL00060                                            0191 00635000
*   END S04SCAN;                    /* RET. TO MAINLINE      @Y30LB12*/ 00636000
         B     @EL00003                                            0192 00637000
*                                                                  0193 00638000
*/********************************************************** @Y30LB12*/ 00639000
*/*                                                          @Y30LB12*/ 00640000
*/* PROCEDURE NAME - RSGALTP                                 @Y30LB12*/ 00641000
*/*                                                          @Y30LB12*/ 00642000
*/* FUNCTION - FOR VIRTUAL AND SHARED VIRTUAL ADDRESSES,     @Y30LB12*/ 00643000
*/*            MOVE ALTERNATE PATH INFORMATION AND RSG       @Y30LB12*/ 00644000
*/*            INFORMATION INTO APPROPRIATE SLOTS IN         @Y30LB12*/ 00645000
*/*            WK1ADDRS.                                     @Y30LB12*/ 00646000
*/*                                                          @Y30LB12*/ 00647000
*/********************************************************** @Y30LB12*/ 00648000
*                                                                  0193 00649000
*RSGALTP:                                                          0193 00650000
*   PROCEDURE;                      /*                       @Y30LB12*/ 00651000
RSGALTP  STM   @14,@12,12(@13)                                     0193 00652000
*   DO I=1 TO MAXDEV;               /* 64 POSSIBLE ADDRS     @Y30LB12*/ 00653000
         LA    I,1                                                 0194 00654000
         B     @DE00194                                            0194 00655000
@DL00194 DS    0H                                                  0195 00656000
*     IF ADR1SPEC(I)='1'B           /* IF ADDR SPECIFIED     @Y30LB12*/ 00657000
*       THEN                        /*                       @Y30LB12*/ 00658000
         LR    @07,I                                               0195 00659000
         MH    @07,@CH00257                                        0195 00660000
         LA    @05,ADR1SPEC-11(@07)                                0195 00661000
         TM    0(@05),B'10000000'                                  0195 00662000
         BNO   @RF00195                                            0195 00663000
*       DO;                         /*                       @Y30LB12*/ 00664000
*         WK1RSG(I)=WORKRSG(2);     /* ALL V AND VS          @Y30LB12*/ 00665000
         LA    @05,WK1RSG-11(@07)                                  0197 00666000
         MVC   0(1,@05),WORKRSG+1                                  0197 00667000
*         WK1ADS1(I)=WORKADS(1);    /* 1ST ALT PATH          @Y30LB12*/ 00668000
         LA    @05,WK1ADS1-11(@07)                                 0198 00669000
         MVC   0(1,@05),WORKADS                                    0198 00670000
*         WK1ACI1(I)=WORKACI(1);    /* 1ST ALT PATH          @Y30LB12*/ 00671000
         LA    @05,WK1ACI1-11(@07)                                 0199 00672000
         MVC   0(1,@05),WORKACI                                    0199 00673000
*         WK1ACH1(I)=WORKACH(1);    /* 1ST ALT PATH          @Y30LB12*/ 00674000
         LA    @05,WK1ACH1-11(@07)                                 0200 00675000
         MVC   0(1,@05),WORKACH                                    0200 00676000
*         WK1ADS2(I)=WORKADS(2);    /* 2ND ALT PATH          @Y30LB12*/ 00677000
         LA    @05,WK1ADS2-11(@07)                                 0201 00678000
         MVC   0(1,@05),WORKADS+4                                  0201 00679000
*         WK1ACI2(I)=WORKACI(2);    /* 2ND ALT PATH          @Y30LB12*/ 00680000
         LA    @05,WK1ACI2-11(@07)                                 0202 00681000
         MVC   0(1,@05),WORKACI+4                                  0202 00682000
*         WK1ACH2(I)=WORKACH(2);    /* 2ND ALT PATH          @Y30LB12*/ 00683000
         LA    @05,WK1ACH2-11(@07)                                 0203 00684000
         MVC   0(1,@05),WORKACH+4                                  0203 00685000
*         WK1ADS3(I)=WORKADS(3);    /* 3RD ALT PATH          @Y30LB12*/ 00686000
         LA    @05,WK1ADS3-11(@07)                                 0204 00687000
         MVC   0(1,@05),WORKADS+8                                  0204 00688000
*         WK1ACI3(I)=WORKACI(3);    /* 3RD ALT PATH          @Y30LB12*/ 00689000
         LA    @05,WK1ACI3-11(@07)                                 0205 00690000
         MVC   0(1,@05),WORKACI+8                                  0205 00691000
*         WK1ACH3(I)=WORKACH(3);    /* 3RD ALT PATH          @Y30LB12*/ 00692000
         LA    @05,WK1ACH3-11(@07)                                 0206 00693000
         MVC   0(1,@05),WORKACH+8                                  0206 00694000
*       END;                        /*                       @Y30LB12*/ 00695000
*     ELSE                                                         0208 00696000
*       ;                           /*                       @Y30LB12*/ 00697000
@RF00195 DS    0H                                                  0209 00698000
*   END;                            /* CHECKED ALL 64        @Y30LB12*/ 00699000
         AH    I,@CH00044                                          0209 00700000
@DE00194 CH    I,MAXDEV                                            0209 00701000
         BNH   @DL00194                                            0209 00702000
*   END RSGALTP;                    /* RET. TO S04SCAN       @Y30LB12*/ 00703000
@EL00004 DS    0H                                                  0210 00704000
@EF00004 DS    0H                                                  0210 00705000
@ER00004 LM    @14,@12,12(@13)                                     0210 00706000
         BR    @14                                                 0210 00707000
*                                                                  0211 00708000
*/********************************************************** @Y30LB12*/ 00709000
*/*                                                          @Y30LB12*/ 00710000
*/* PROCEDURE NAME - WK1TOWK2                                @Y30LB12*/ 00711000
*/*                                                          @Y30LB12*/ 00712000
*/* FUNCTION - IF ADDRESS SPECIFIED FOR THIS SUB-GROUP (V,   @Y30LB12*/ 00713000
*/*            VS, REAL, OR CONVREAL), AND NOT               @Y30LB12*/ 00714000
*/*            SPECIFIED PREVIOUSLY IN THIS CONTROL          @Y30LB12*/ 00715000
*/*            STATEMENT, MOVE INFORMATION ABOUT EACH        @Y30LB12*/ 00716000
*/*            ADDRESS SPECIFIED FOR SUB-GROUP WORKAREA      @Y30LB12*/ 00717000
*/*            (WK1ADDRS) TO CONTROL STATEMENT WORKAREA      @Y30LB12*/ 00718000
*/*            (WK2ADDRS).                                   @Y30LB12*/ 00719000
*/*                                                          @Y30LB12*/ 00720000
*/********************************************************** @Y30LB12*/ 00721000
*                                                                  0211 00722000
*WK1TOWK2:                                                         0211 00723000
*   PROCEDURE;                      /*                       @Y30LB12*/ 00724000
WK1TOWK2 STM   @14,@12,@SA00005                                    0211 00725000
*   DO I=1 TO MAXDEV;               /* 64 POSSIBLE ADDRS     @Y30LB12*/ 00726000
         LA    I,1                                                 0212 00727000
         B     @DE00212                                            0212 00728000
@DL00212 DS    0H                                                  0213 00729000
*     IF ADR1SPEC(I)='1'B           /* SPEC IN WORK1         @Y30LB12*/ 00730000
*       THEN                        /*                       @Y30LB12*/ 00731000
         LR    @07,I                                               0213 00732000
         MH    @07,@CH00257                                        0213 00733000
         LA    @05,ADR1SPEC-11(@07)                                0213 00734000
         TM    0(@05),B'10000000'                                  0213 00735000
         BNO   @RF00213                                            0213 00736000
*       IF ADR2SPEC(I)='0'B         /* NOT SPEC IN WORK2     @Y30LB12*/ 00737000
*         THEN                      /*                       @Y30LB12*/ 00738000
         LA    @05,ADR2SPEC-11(@07)                                0214 00739000
         TM    0(@05),B'10000000'                                  0214 00740000
         BNZ   @RF00214                                            0214 00741000
*         WK2ADDR(I)=WK1ADDR(I);    /* MOVE DATA             @Y30LB12*/ 00742000
         LA    @05,WK2ADDR-11(@07)                                 0215 00743000
         LA    @03,WK1ADDR-11(@07)                                 0215 00744000
         MVC   0(11,@05),0(@03)                                    0215 00745000
*       ELSE                        /*                       @Y30LB12*/ 00746000
*         DO;                       /*                       @Y30LB12*/ 00747000
*                                                                  0216 00748000
         B     @RC00214                                            0216 00749000
@RF00214 DS    0H                                                  0217 00750000
*           /*********************************************************/ 00751000
*           /*                                                       */ 00752000
*           /* ***********************************           @Y30LB12*/ 00753000
*           /* ICG226I DUPLICATE SPECIFICATION               @Y30LB12*/ 00754000
*           /* FOR DEVICE XX                                 @Y30LB12*/ 00755000
*           /* ***********************************           @Y30LB12*/ 00756000
*           /*                                                       */ 00757000
*           /*********************************************************/ 00758000
*                                                                  0217 00759000
*           OUTBUF2(1:44)=ICGDS226; /*                       @Y30LB12*/ 00760000
         MVC   OUTBUF2(44,R4),ICGDS226                             0217 00761000
*           OUTBUF2(45:46)=PATTERN(I);/*                     @Y30LB12*/ 00762000
         LR    @07,I                                               0218 00763000
         ALR   @07,@07                                             0218 00764000
         LA    @05,PATTERN-2(@07)                                  0218 00765000
         MVC   OUTBUF2+44(2,R4),0(@05)                             0218 00766000
*           CALL PUTIT1;            /* TO MESSAGE WRITER     @Y30LB12*/ 00767000
         BAL   @14,PUTIT1                                          0219 00768000
*         END;                      /*                       @Y30LB12*/ 00769000
*     WK1ADDR(I)='0000000000000000000000'X;/* CLEAR          @Y30LB12*/ 00770000
@RC00214 DS    0H                                                  0221 00771000
@RF00213 LR    @07,I                                               0221 00772000
         MH    @07,@CH00257                                        0221 00773000
         LA    @05,WK1ADDR-11(@07)                                 0221 00774000
         MVC   0(11,@05),@CB00531                                  0221 00775000
*   END;                            /* HANDLED ALL 64        @Y30LB12*/ 00776000
         AH    I,@CH00044                                          0222 00777000
@DE00212 CH    I,MAXDEV                                            0222 00778000
         BNH   @DL00212                                            0222 00779000
*   END WK1TOWK2;                   /* RETURN TO CALLER      @Y30LB12*/ 00780000
@EL00005 DS    0H                                                  0223 00781000
@EF00005 DS    0H                                                  0223 00782000
@ER00005 LM    @14,@12,@SA00005                                    0223 00783000
         BR    @14                                                 0223 00784000
*                                                                  0224 00785000
*/********************************************************** @Y30LB12*/ 00786000
*/*                                                          @Y30LB12*/ 00787000
*/* PROCEDURE NAME - S04DS                                   @Y30LB12*/ 00788000
*/*                                                          @Y30LB12*/ 00789000
*/* FUNCTION - HANDLE THE DS PARAMETER FOR THE DATA STAGER   @Y30LB12*/ 00790000
*/*            THAT THIS CPU/CHANNEL/CONTROL UNIT DESCRIBES  @Y30LB12*/ 00791000
*/*            (DS FOR ALTERNATE PATH IS HANDLED IN THE      @Y30LB12*/ 00792000
*/*            PROCEDURE S04ADS.)  ONLY ONE DS KEYWORD IS    @Y30LB12*/ 00793000
*/*            ALLOWED PER CONTROL STATEMENT, THE PARAMETER  @Y30LB12*/ 00794000
*/*            MUST BE ONE CHARACTER IN LENGTH, AND THE      @Y30LB12*/ 00795000
*/*            CHARACTER MUST BE THE REPRESENTATION OF A     @Y30LB12*/ 00796000
*/*            HEXADECIMAL DIGIT IN THE RANGE 0-F.  THE      @Y30LB12*/ 00797000
*/*            VALUE SCANNED IS USED IN CONJUNCTION WITH     @Y30LB12*/ 00798000
*/*            THE VALUE SCANNED FOR CHANNEL INTERFACE       @Y30LB12*/ 00799000
*/*            TO INDEX TO THE PROPER ENTRY IN THE CONFGCON  @Y30LB12*/ 00800000
*/*            AND CONFGUCB (FIRST INDEX).                   @Y30LB12*/ 00801000
*/*                                                          @Y30LB12*/ 00802000
*/********************************************************** @Y30LB12*/ 00803000
*                                                                  0224 00804000
*S04DS:                                                            0224 00805000
*   PROCEDURE;                      /*                       @Y30LB12*/ 00806000
S04DS    STM   @14,@12,@SA00006                                    0224 00807000
*   CALL READS99;                   /* EXTRACT PARAMETER     @Y30LB12*/ 00808000
         BAL   @14,READS99                                         0225 00809000
*   IF HAVEDS^='1'B                 /*                       @Y30LB12*/ 00810000
*     THEN                          /*                       @Y30LB12*/ 00811000
         TM    HAVEDS,B'10000000'                                  0226 00812000
         BO    @RF00226                                            0226 00813000
*     HAVEDS='1'B;                  /*                       @Y30LB12*/ 00814000
         OI    HAVEDS,B'10000000'                                  0227 00815000
*   ELSE                            /*                       @Y30LB12*/ 00816000
*     DO;                           /*                       @Y30LB12*/ 00817000
*                                                                  0228 00818000
         B     @RC00226                                            0228 00819000
@RF00226 DS    0H                                                  0229 00820000
*       /*************************************************************/ 00821000
*       /*                                                           */ 00822000
*       /* *****************************************         @Y30LB12*/ 00823000
*       /* 'ICG219I DUPLICATE KEYWORD SA'                    @Y30LB12*/ 00824000
*       /* *****************************************         @Y30LB12*/ 00825000
*       /*                                                           */ 00826000
*       /*************************************************************/ 00827000
*                                                                  0229 00828000
*       OUTBUF2(1:27)=ICGDS219;     /*                       @Y30LB12*/ 00829000
         MVC   OUTBUF2(27,R4),ICGDS219                             0229 00830000
*       OUTBUF2(28:29)='SA';        /*                       @Y30LB12*/ 00831000
         MVC   OUTBUF2+27(2,R4),@CC00600                           0230 00832000
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/ 00833000
         BAL   @14,PUTIT1                                          0231 00834000
*       RETURN;                     /* RETURN TO S04SCAN     @Y30LB12*/ 00835000
@EL00006 DS    0H                                                  0232 00836000
@EF00006 DS    0H                                                  0232 00837000
@ER00006 LM    @14,@12,@SA00006                                    0232 00838000
         BR    @14                                                 0232 00839000
*     END;                          /*                       @Y30LB12*/ 00840000
*   IF PARMBIT^='1'B                /* SET BY ICGDSS99       @Y30LB12*/ 00841000
*     THEN                          /*                       @Y30LB12*/ 00842000
@RC00226 TM    PARMBIT(R4),B'00100000'                             0234 00843000
         BO    @RF00234                                            0234 00844000
*     DO;                           /*                       @Y30LB12*/ 00845000
*                                                                  0235 00846000
*       /*************************************************************/ 00847000
*       /*                                                           */ 00848000
*       /* *****************************************         @Y30LB12*/ 00849000
*       /* ICG211I EXPECTED, BUT DID NOT FIND,               @Y30LB12*/ 00850000
*       /* PARAMETER                                         @Y30LB12*/ 00851000
*       /* *****************************************         @Y30LB12*/ 00852000
*       /*                                                           */ 00853000
*       /*************************************************************/ 00854000
*                                                                  0236 00855000
*       MSGNO=ICG211I;              /* ID FOR ICGDS211       @Y30LB12*/ 00856000
         MVC   MSGNO(2,R4),ICG211I                                 0236 00857000
*       CALL PUTIT2;                /* TO MESSAGE WRITER     @Y30LB12*/ 00858000
         BAL   @14,PUTIT2                                          0237 00859000
*       RETURN;                     /* RETURN TO S04SCAN     @Y30LB12*/ 00860000
         B     @EL00006                                            0238 00861000
*     END;                          /*                       @Y30LB12*/ 00862000
*   ELSE                                                           0240 00863000
*     ;                             /*                       @Y30LB12*/ 00864000
@RF00234 DS    0H                                                  0241 00865000
*   IF SCANLEN^=1                   /* SET BY ICGDSS99       @Y30LB12*/ 00866000
*     THEN                          /*                       @Y30LB12*/ 00867000
         CLC   SCANLEN(2,R4),@CH00044                              0241 00868000
         BE    @RF00241                                            0241 00869000
*     DO;                           /*                       @Y30LB12*/ 00870000
*                                                                  0242 00871000
*       /*************************************************************/ 00872000
*       /*                                                           */ 00873000
*       /* *****************************************         @Y30LB12*/ 00874000
*       /* 'ICG220I INVALID PARAMETER LENGTH,                @Y30LB12*/ 00875000
*       /* KEYWORD IS SA'                                    @Y30LB12*/ 00876000
*       /* *****************************************         @Y30LB12*/ 00877000
*       /*                                                           */ 00878000
*       /*************************************************************/ 00879000
*                                                                  0243 00880000
*       OUTBUF2(1:46)=ICGDS220;     /*                       @Y30LB12*/ 00881000
         MVC   OUTBUF2(46,R4),ICGDS220                             0243 00882000
*       OUTBUF2(47:48)='SA';        /*                       @Y30LB12*/ 00883000
         MVC   OUTBUF2+46(2,R4),@CC00600                           0244 00884000
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/ 00885000
         BAL   @14,PUTIT1                                          0245 00886000
*       RETURN;                     /* RETURN TO S04SCAN     @Y30LB12*/ 00887000
         B     @EL00006                                            0246 00888000
*     END;                          /*                       @Y30LB12*/ 00889000
*   ELSE                                                           0248 00890000
*     ;                             /*                       @Y30LB12*/ 00891000
@RF00241 DS    0H                                                  0249 00892000
*   HEXCHAR=SCANDATA(1);            /* CHAR TO CONVHEX       @Y30LB12*/ 00893000
         L     @07,STARTCOL(,R4)                                   0249 00894000
         MVC   HEXCHAR(1),SCANDATA(@07)                            0249 00895000
*   PLUGIN2='SA      ';             /* FOR POSSIBLE MSG      @YM31098*/ 00896000
         MVC   PLUGIN2(8),@CC00601                                 0250 00897000
*   CALL CONVHEX;                   /* TO CONVERT TO HEX     @Y30LB12*/ 00898000
         BAL   @14,CONVHEX                                         0251 00899000
*   DSINDEX=HEXINDEX;               /* = BIN HEXCHAR+1       @Y30LB12*/ 00900000
         MVC   DSINDEX(2),HEXINDEX                                 0252 00901000
*   END S04DS;                      /* RET TO S04SCAN        @Y30LB12*/ 00902000
         B     @EL00006                                            0253 00903000
*                                                                  0254 00904000
*/********************************************************** @Y30LB12*/ 00905000
*/*                                                          @Y30LB12*/ 00906000
*/* PROCEDURE NAME - S04CI                                   @Y30LB12*/ 00907000
*/*                                                          @Y30LB12*/ 00908000
*/* FUNCTION - HANDLE THE CHANNEL INTERFACE DESIGNATION FOR  @Y30LB12*/ 00909000
*/*            THE PRIMARY CHANNEL SPECIFIED IN THIS CONTROL @Y30LB12*/ 00910000
*/*            STATEMENT (CI FOR ALTPATH IS HANDLED BY THE   @Y30LB12*/ 00911000
*/*            PROCEDURE S04ACI).  ONLY ONE CI KEYWORD IS    @Y30LB12*/ 00912000
*/*            ALLOWED.  THE PARAMETER MUST BE THE SINGLE    @Y30LB12*/ 00913000
*/*            CHARACTER 'B', 'C', OR 'D'.  THE VALUE IS     @Y30LB12*/ 00914000
*/*            SAVED AS BINARY '1', '2', OR '3', AND IS USED @Y30LB12*/ 00915000
*/*            IN CONJUNCTION WITH THE VALUE SCANNED FOR     @Y30LB12*/ 00916000
*/*            DATA STAGER TO LOCATE THE PROPER ENTRY IN     @Y30LB12*/ 00917000
*/*            CONFGCON AND CONFGUCB(FIRST INDEX).           @Y30LB12*/ 00918000
*/*                                                          @Y30LB12*/ 00919000
*/********************************************************** @Y30LB12*/ 00920000
*                                                                  0254 00921000
*S04CI:                                                            0254 00922000
*   PROCEDURE;                      /*                       @Y30LB12*/ 00923000
S04CI    STM   @14,@12,@SA00007                                    0254 00924000
*   CALL READS99;                   /* EXTRACT PARAMETER     @Y30LB12*/ 00925000
         BAL   @14,READS99                                         0255 00926000
*   IF HAVECI^='1'B                 /*                       @Y30LB12*/ 00927000
*     THEN                          /*                       @Y30LB12*/ 00928000
         TM    HAVECI,B'01000000'                                  0256 00929000
         BO    @RF00256                                            0256 00930000
*     HAVECI='1'B;                  /*                       @Y30LB12*/ 00931000
         OI    HAVECI,B'01000000'                                  0257 00932000
*   ELSE                            /*                       @Y30LB12*/ 00933000
*     DO;                           /*                       @Y30LB12*/ 00934000
*                                                                  0258 00935000
         B     @RC00256                                            0258 00936000
@RF00256 DS    0H                                                  0259 00937000
*       /*************************************************************/ 00938000
*       /*                                                           */ 00939000
*       /* *****************************************         @Y30LB12*/ 00940000
*       /* 'ICG219I DUPLICATE KEYWORD CI'                    @Y30LB12*/ 00941000
*       /* *****************************************         @Y30LB12*/ 00942000
*       /*                                                           */ 00943000
*       /*************************************************************/ 00944000
*                                                                  0259 00945000
*       OUTBUF2(1:27)=ICGDS219;     /*                       @Y30LB12*/ 00946000
         MVC   OUTBUF2(27,R4),ICGDS219                             0259 00947000
*       OUTBUF2(28:29)='CI';        /*                       @Y30LB12*/ 00948000
         MVC   OUTBUF2+27(2,R4),@CC00606                           0260 00949000
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/ 00950000
         BAL   @14,PUTIT1                                          0261 00951000
*       RETURN;                     /* RET. TO S04SCAN       @Y30LB12*/ 00952000
@EL00007 DS    0H                                                  0262 00953000
@EF00007 DS    0H                                                  0262 00954000
@ER00007 LM    @14,@12,@SA00007                                    0262 00955000
         BR    @14                                                 0262 00956000
*     END;                          /*                       @Y30LB12*/ 00957000
*   IF PARMBIT^='1'B                /* SET BY ICGDSS99       @Y30LB12*/ 00958000
*     THEN                          /*                       @Y30LB12*/ 00959000
@RC00256 TM    PARMBIT(R4),B'00100000'                             0264 00960000
         BO    @RF00264                                            0264 00961000
*     DO;                           /*                       @Y30LB12*/ 00962000
*                                                                  0265 00963000
*       /*************************************************************/ 00964000
*       /*                                                           */ 00965000
*       /* *****************************************         @Y30LB12*/ 00966000
*       /* ICG211I EXPECTED, BUT DID NOT FIND,               @Y30LB12*/ 00967000
*       /* PARAMETER                                         @Y30LB12*/ 00968000
*       /* *****************************************         @Y30LB12*/ 00969000
*       /*                                                           */ 00970000
*       /*************************************************************/ 00971000
*                                                                  0266 00972000
*       MSGNO=ICG211I;              /* ID FOR ICGDS211       @Y30LB12*/ 00973000
         MVC   MSGNO(2,R4),ICG211I                                 0266 00974000
*       CALL PUTIT2;                /* TO MESSAGE WRITER     @Y30LB12*/ 00975000
         BAL   @14,PUTIT2                                          0267 00976000
*       RETURN;                     /* RET. TO S04SCAN       @Y30LB12*/ 00977000
         B     @EL00007                                            0268 00978000
*     END;                          /*                       @Y30LB12*/ 00979000
*   ELSE                                                           0270 00980000
*     ;                             /*                       @Y30LB12*/ 00981000
@RF00264 DS    0H                                                  0271 00982000
*   IF SCANLEN^=1                   /* SET BY ICGDSS99       @Y30LB12*/ 00983000
*     THEN                          /*                       @Y30LB12*/ 00984000
         CLC   SCANLEN(2,R4),@CH00044                              0271 00985000
         BE    @RF00271                                            0271 00986000
*     DO;                           /*                       @Y30LB12*/ 00987000
*                                                                  0272 00988000
*       /*************************************************************/ 00989000
*       /*                                                           */ 00990000
*       /* *****************************************         @Y30LB12*/ 00991000
*       /* 'ICG220I INVALID PARAMETER LENGTH,                @Y30LB12*/ 00992000
*       /* KEYWORD IS CI                                     @Y30LB12*/ 00993000
*       /* *****************************************         @Y30LB12*/ 00994000
*       /*                                                           */ 00995000
*       /*************************************************************/ 00996000
*                                                                  0273 00997000
*       OUTBUF2(1:46)=ICGDS220;     /*                       @Y30LB12*/ 00998000
         MVC   OUTBUF2(46,R4),ICGDS220                             0273 00999000
*       OUTBUF2(47:48)='CI';        /*                       @Y30LB12*/ 01000000
         MVC   OUTBUF2+46(2,R4),@CC00606                           0274 01001000
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/ 01002000
         BAL   @14,PUTIT1                                          0275 01003000
*       RETURN;                     /* RET. TO S04SCAN       @Y30LB12*/ 01004000
         B     @EL00007                                            0276 01005000
*     END;                          /*                       @Y30LB12*/ 01006000
*   ELSE                                                           0278 01007000
*     ;                             /*                       @Y30LB12*/ 01008000
@RF00271 DS    0H                                                  0279 01009000
*   WORKCI='00'X;                   /* ZERO WORKA FOR CI     @Y30LB12*/ 01010000
         MVI   WORKCI,X'00'                                        0279 01011000
*   IF SCANDATA(1)='B'              /* IF PARAMETER 'B'      @Y30LB12*/ 01012000
*     THEN                          /*                       @Y30LB12*/ 01013000
         L     @07,STARTCOL(,R4)                                   0280 01014000
         CLI   SCANDATA(@07),C'B'                                  0280 01015000
         BNE   @RF00280                                            0280 01016000
*     WORKCI='01'X;                 /* CHANNEL INT IS 1      @Y30LB12*/ 01017000
         MVI   WORKCI,X'01'                                        0281 01018000
*   ELSE                                                           0282 01019000
*     ;                             /*                       @Y30LB12*/ 01020000
@RF00280 DS    0H                                                  0283 01021000
*   IF SCANDATA(1)='C'              /* IF PARAMETER 'C'      @Y30LB12*/ 01022000
*     THEN                          /*                       @Y30LB12*/ 01023000
         L     @07,STARTCOL(,R4)                                   0283 01024000
         CLI   SCANDATA(@07),C'C'                                  0283 01025000
         BNE   @RF00283                                            0283 01026000
*     WORKCI='02'X;                 /* CHANNEL INT IS 2      @Y30LB12*/ 01027000
         MVI   WORKCI,X'02'                                        0284 01028000
*   ELSE                                                           0285 01029000
*     ;                             /*                       @Y30LB12*/ 01030000
@RF00283 DS    0H                                                  0286 01031000
*   IF SCANDATA(1)='D'              /* IF PARAMETER 'D'      @Y30LB12*/ 01032000
*     THEN                          /*                       @Y30LB12*/ 01033000
         L     @07,STARTCOL(,R4)                                   0286 01034000
         CLI   SCANDATA(@07),C'D'                                  0286 01035000
         BNE   @RF00286                                            0286 01036000
*     WORKCI='03'X;                 /* CHANNEL INT IS 3      @Y30LB12*/ 01037000
         MVI   WORKCI,X'03'                                        0287 01038000
*   ELSE                                                           0288 01039000
*     ;                             /*                       @Y30LB12*/ 01040000
@RF00286 DS    0H                                                  0289 01041000
*   IF WORKCI='00'X                 /* IF NO MATCH           @Y30LB12*/ 01042000
*     THEN                          /*                       @Y30LB12*/ 01043000
         CLI   WORKCI,X'00'                                        0289 01044000
         BNE   @RF00289                                            0289 01045000
*     DO;                           /*                       @Y30LB12*/ 01046000
*                                                                  0290 01047000
*       /*************************************************************/ 01048000
*       /*                                                           */ 01049000
*       /* *****************************************         @Y30LB12*/ 01050000
*       /* 'ICG223I VALUE ERROR FOR CI'                      @Y30LB12*/ 01051000
*       /* *****************************************         @Y30LB12*/ 01052000
*       /*                                                           */ 01053000
*       /*************************************************************/ 01054000
*                                                                  0291 01055000
*       OUTBUF2(1:25)=ICGDS223;     /*                       @Y30LB12*/ 01056000
         MVC   OUTBUF2(25,R4),ICGDS223                             0291 01057000
*       OUTBUF2(26:27)='CI';        /*                       @Y30LB12*/ 01058000
         MVC   OUTBUF2+25(2,R4),@CC00606                           0292 01059000
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/ 01060000
         BAL   @14,PUTIT1                                          0293 01061000
*     END;                          /*                       @Y30LB12*/ 01062000
*   ELSE                                                           0295 01063000
*     ;                             /*                       @Y30LB12*/ 01064000
@RF00289 DS    0H                                                  0296 01065000
*   END S04CI;                      /* RET. TO S04SCAN       @Y30LB12*/ 01066000
         B     @EL00007                                            0296 01067000
*                                                                  0297 01068000
*/********************************************************** @Y30LB12*/ 01069000
*/*                                                          @Y30LB12*/ 01070000
*/* PROCEDURE NAME - S04CH                                   @Y30LB12*/ 01071000
*/*                                                          @Y30LB12*/ 01072000
*/* FUNCTION - EXTRACT THE CHANNEL PARAMETER FROM THE INPUT  @Y30LB12*/ 01073000
*/*            BUFFER.  ONLY ONE CHANNEL IS ALLOWED PER      @Y30LB12*/ 01074000
*/*            DATA STAGER/CHANNEL INTERFACE, SO CHECK FOR   @Y30LB12*/ 01075000
*/*            DUPLICATE SPECIFICATION.  CHANNEL PARAMETER   @Y30LB12*/ 01076000
*/*            IS ONE BYTE IN LENGTH.  CALL CONVHEX TO       @Y30LB12*/ 01077000
*/*            OBTAIN THE BINARY EQUIVALENT OF THE           @Y30LB12*/ 01078000
*/*            CHARACTER REPRESENTATION OF CHANNEL.  STORE   @Y30LB12*/ 01079000
*/*            RESULT IN 'WORKCH'.                           @Y30LB12*/ 01080000
*/*                                                          @Y30LB12*/ 01081000
*/*            NOTE - FLAG 'HAVECH' IS CHECKED IN PROCEDURE  @Y30LB12*/ 01082000
*/*            'MISSREQ' IN 'S04ANAL' TO BE SURE THAT A      @Y30LB12*/ 01083000
*/*            CHANNEL WAS SPECIFIED.  'WORKCH' IS MOVED TO  @Y30LB12*/ 01084000
*/*            'RSGCHAN' IN THE STRUCTURE 'CONFGCON' IN      @Y30LB12*/ 01085000
*/*            COMTAB2 IN THE PROCEDURE 'S04BUILD'.          @Y30LB12*/ 01086000
*/*                                                          @Y30LB12*/ 01087000
*/********************************************************** @Y30LB12*/ 01088000
*                                                                  0297 01089000
*S04CH:                                                            0297 01090000
*   PROCEDURE;                      /*                       @Y30LB12*/ 01091000
S04CH    STM   @14,@12,@SA00008                                    0297 01092000
*   CALL READS99;                   /* EXTRACT PARAMETER     @Y30LB12*/ 01093000
         BAL   @14,READS99                                         0298 01094000
*   IF HAVECH^='1'B                 /* IF KEYWORD WAS        @Y30LB12*/ 01095000
*     THEN                          /* NOT USED EARLIER      @Y30LB12*/ 01096000
         TM    HAVECH,B'00100000'                                  0299 01097000
         BO    @RF00299                                            0299 01098000
*     HAVECH='1'B;                  /* SET ITS USED FLAG     @Y30LB12*/ 01099000
         OI    HAVECH,B'00100000'                                  0300 01100000
*   ELSE                            /* ELSE WRITE MSG        @Y30LB12*/ 01101000
*     DO;                           /*                       @Y30LB12*/ 01102000
*                                                                  0301 01103000
         B     @RC00299                                            0301 01104000
@RF00299 DS    0H                                                  0302 01105000
*       /*************************************************************/ 01106000
*       /*                                                           */ 01107000
*       /* *****************************************         @Y30LB12*/ 01108000
*       /* 'ICG219I DUPLICATE KEYWORD CH'                    @Y30LB12*/ 01109000
*       /* *****************************************         @Y30LB12*/ 01110000
*       /*                                                           */ 01111000
*       /*************************************************************/ 01112000
*                                                                  0302 01113000
*       OUTBUF2(1:27)=ICGDS219;     /*                       @Y30LB12*/ 01114000
         MVC   OUTBUF2(27,R4),ICGDS219                             0302 01115000
*       OUTBUF2(28:29)='CH';        /*                       @Y30LB12*/ 01116000
         MVC   OUTBUF2+27(2,R4),@CC00617                           0303 01117000
*       CALL PUTIT1;                /* CALL MSG WRITER       @Y30LB12*/ 01118000
         BAL   @14,PUTIT1                                          0304 01119000
*       RETURN;                     /* TO S04SCAN            @Y30LB12*/ 01120000
@EL00008 DS    0H                                                  0305 01121000
@EF00008 DS    0H                                                  0305 01122000
@ER00008 LM    @14,@12,@SA00008                                    0305 01123000
         BR    @14                                                 0305 01124000
*     END;                          /*                       @Y30LB12*/ 01125000
*   IF PARMBIT^='1'B                /* SET IN ICGDSS99       @Y30LB12*/ 01126000
*     THEN                          /*                       @Y30LB12*/ 01127000
@RC00299 TM    PARMBIT(R4),B'00100000'                             0307 01128000
         BO    @RF00307                                            0307 01129000
*     DO;                           /*                       @Y30LB12*/ 01130000
*                                                                  0308 01131000
*       /*************************************************************/ 01132000
*       /*                                                           */ 01133000
*       /* *****************************************         @Y30LB12*/ 01134000
*       /* ICG211I EXPECTED, BUT DID NOT FIND,               @Y30LB12*/ 01135000
*       /* PARAMETER                                         @Y30LB12*/ 01136000
*       /* *****************************************         @Y30LB12*/ 01137000
*       /*                                                           */ 01138000
*       /*************************************************************/ 01139000
*                                                                  0309 01140000
*       MSGNO=ICG211I;              /* ID FOR ICGDS211       @Y30LB12*/ 01141000
         MVC   MSGNO(2,R4),ICG211I                                 0309 01142000
*       CALL PUTIT2;                /* CALL MSG WRITER       @Y30LB12*/ 01143000
         BAL   @14,PUTIT2                                          0310 01144000
*       RETURN;                     /* TO S04SCAN            @Y30LB12*/ 01145000
         B     @EL00008                                            0311 01146000
*     END;                          /*                       @Y30LB12*/ 01147000
*   ELSE                                                           0313 01148000
*     ;                             /*                       @Y30LB12*/ 01149000
@RF00307 DS    0H                                                  0314 01150000
*   IF SCANLEN^=1                   /* SET IN ICGDSS99       @Y30LB12*/ 01151000
*     THEN                          /*                       @Y30LB12*/ 01152000
         CLC   SCANLEN(2,R4),@CH00044                              0314 01153000
         BE    @RF00314                                            0314 01154000
*     DO;                           /*                       @Y30LB12*/ 01155000
*                                                                  0315 01156000
*       /*************************************************************/ 01157000
*       /*                                                           */ 01158000
*       /* *****************************************         @Y30LB12*/ 01159000
*       /* 'ICG220I INVALID PARAMETER LENGTH,                @Y30LB12*/ 01160000
*       /* KEYWORD IS CH'                                    @Y30LB12*/ 01161000
*       /* *****************************************         @Y30LB12*/ 01162000
*       /*                                                           */ 01163000
*       /*************************************************************/ 01164000
*                                                                  0316 01165000
*       OUTBUF2(1:46)=ICGDS220;     /*                       @Y30LB12*/ 01166000
         MVC   OUTBUF2(46,R4),ICGDS220                             0316 01167000
*       OUTBUF2(47:48)='CH';        /*                       @Y30LB12*/ 01168000
         MVC   OUTBUF2+46(2,R4),@CC00617                           0317 01169000
*       CALL PUTIT1;                /* CALL MSG WRITER       @Y30LB12*/ 01170000
         BAL   @14,PUTIT1                                          0318 01171000
*       RETURN;                     /* TO S04SCAN            @Y30LB12*/ 01172000
         B     @EL00008                                            0319 01173000
*     END;                          /*                       @Y30LB12*/ 01174000
*   ELSE                                                           0321 01175000
*     ;                             /*                       @Y30LB12*/ 01176000
@RF00314 DS    0H                                                  0322 01177000
*   HEXCHAR=SCANDATA(1);            /* SCANNED VALUE         @Y30LB12*/ 01178000
         L     @07,STARTCOL(,R4)                                   0322 01179000
         MVC   HEXCHAR(1),SCANDATA(@07)                            0322 01180000
*   PLUGIN2='CH      ';             /* FOR MESSAGE TEXT      @YM31098*/ 01181000
         MVC   PLUGIN2(8),@CC00618                                 0323 01182000
*   CALL CONVHEX;                   /* CONVERT TO HEX        @Y30LB12*/ 01183000
         BAL   @14,CONVHEX                                         0324 01184000
*   IF HEXCHAR^=0                   /* IF NOT CHANNEL 0      @Y30LB12*/ 01185000
*     THEN                          /*                       @Y30LB12*/ 01186000
         CLI   HEXCHAR,0                                           0325 01187000
         BE    @RF00325                                            0325 01188000
*     WORKCH=HEXCHAR;               /* CONVERTED VALUE       @Y30LB12*/ 01189000
         MVC   WORKCH(1),HEXCHAR                                   0326 01190000
*   ELSE                            /*                       @Y30LB12*/ 01191000
*     DO;                           /*                       @Y30LB12*/ 01192000
*                                                                  0327 01193000
         B     @RC00325                                            0327 01194000
@RF00325 DS    0H                                                  0328 01195000
*       /*************************************************************/ 01196000
*       /*                                                           */ 01197000
*       /* *****************************************         @Y30LB12*/ 01198000
*       /* ICG223I VALUE ERROR FOR CH                        @Y30LB12*/ 01199000
*       /* *****************************************         @Y30LB12*/ 01200000
*       /*                                                           */ 01201000
*       /*************************************************************/ 01202000
*                                                                  0328 01203000
*       OUTBUF2(1:25)=ICGDS223;     /*                       @Y30LB12*/ 01204000
         MVC   OUTBUF2(25,R4),ICGDS223                             0328 01205000
*       OUTBUF2(26:27)='CH';        /*                       @Y30LB12*/ 01206000
         MVC   OUTBUF2+25(2,R4),@CC00617                           0329 01207000
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/ 01208000
         BAL   @14,PUTIT1                                          0330 01209000
*     END;                          /*                       @Y30LB12*/ 01210000
*   END S04CH;                      /* RETURN TO S04SCAN     @Y30LB12*/ 01211000
         B     @EL00008                                            0332 01212000
*                                                                  0333 01213000
*/********************************************************** @Y30LB12*/ 01214000
*/*                                                          @Y30LB12*/ 01215000
*/* PROCEDURE NAME - CONVHEX                                 @Y30LB12*/ 01216000
*/*                                                          @Y30LB12*/ 01217000
*/* FUNCTION - THIS PROCEDURE RECEIVES AS INPUT THE EBCDIC   @Y30LB12*/ 01218000
*/*            REPRESENTATION OF ONE HEXADECIMAL CHARACTER   @Y30LB12*/ 01219000
*/*            IN 'HEXCHAR'.  IF THE CHARACTER REPRESENTS A  @Y30LB12*/ 01220000
*/*            VALID HEXADECIMAL CHARACTER, IT IS CONVERTED  @Y30LB12*/ 01221000
*/*            TO BINARY IN 'HEXCHAR' AND 'HEXINDEX' IS SET  @Y30LB12*/ 01222000
*/*            TO INDICATE A HALFWORD EQUAL TO HEXCHAR+1.    @Y30LB12*/ 01223000
*/*                                                          @Y30LB12*/ 01224000
*/*            THIS ROUTINE IS CALLED BY  PROCEDURES S04DS,  @Y30LB12*/ 01225000
*/*            S04CH, S04ADS, AND S04ACH.  S04DS AND S04ADS  @Y30LB12*/ 01226000
*/*            TAKE THE RETURNED VALUE FROM HEXINDEX.  S04CH @Y30LB12*/ 01227000
*/*            AND S04ACH TAKE THE RETURNED VALUE FROM       @Y30LB12*/ 01228000
*/*            HEXCHAR.                                      @Y30LB12*/ 01229000
*/*                                                          @Y30LB12*/ 01230000
*/********************************************************** @Y30LB12*/ 01231000
*                                                                  0333 01232000
*CONVHEX:                                                          0333 01233000
*   PROCEDURE;                      /*                       @Y30LB12*/ 01234000
CONVHEX  STM   @14,@12,@SA00009                                    0333 01235000
*   HEXINDEX=0;                     /* INITIALIZE            @Y30LB12*/ 01236000
         SLR   @07,@07                                             0334 01237000
         STH   @07,HEXINDEX                                        0334 01238000
*   IF HIGHHEX=ALPHA                /* PASSED CHARACTER      @Y30LB12*/ 01239000
*     THEN                          /* HIGH-ORDER BITS       @Y30LB12*/ 01240000
         TM    HIGHHEX,B'11000000'                                 0335 01241000
         BNO   @RF00335                                            0335 01242000
         TM    HIGHHEX,B'00110000'                                 0335 01243000
         BNZ   @RF00335                                            0335 01244000
*     DO;                           /* OF CHARACTER A-I,     @Y30LB12*/ 01245000
*       HIGHHEX=ZEROBITS;           /* ZERO BITS AND ADD     @Y30LB12*/ 01246000
         NI    HIGHHEX,B'00001111'                                 0337 01247000
*       HEXCHAR=HEXCHAR+9;          /* BINARY 9 FOR BIN      @Y30LB12*/ 01248000
         IC    @07,HEXCHAR                                         0338 01249000
         LA    @07,9(,@07)                                         0338 01250000
         STC   @07,HEXCHAR                                         0338 01251000
*     END;                          /* EQUIVALENT.           @Y30LB12*/ 01252000
*   ELSE                            /* NOT CHAR A-I          @Y30LB12*/ 01253000
*     IF HIGHHEX=NUMERIC            /* CHECK CHAR 0-9        @Y30LB12*/ 01254000
*       THEN                        /* IF SIGN IS OKAY,      @Y30LB12*/ 01255000
         B     @RC00335                                            0340 01256000
@RF00335 TM    HIGHHEX,B'11110000'                                 0340 01257000
         BNO   @RF00340                                            0340 01258000
*       HIGHHEX=ZEROBITS;           /* ZERO SIGN BITS        @Y30LB12*/ 01259000
         NI    HIGHHEX,B'00001111'                                 0341 01260000
*     ELSE                                                         0342 01261000
*       ;                           /*                       @Y30LB12*/ 01262000
*                                                                  0342 01263000
@RF00340 DS    0H                                                  0343 01264000
*   /*****************************************************************/ 01265000
*   /*                                                               */ 01266000
*   /* ************************************************@Y30LB12 IF   */ 01267000
*   /* CHARACTER NOT 0-9 OR A-F, THE HIGH-ORDER              @Y30LB12*/ 01268000
*   /* BITS ARE NOT ZERO. NOTE THAT 'G', 'H', AND 'I'        @Y30LB12*/ 01269000
*   /* WHICH COULD BE ACCEPTED ABOVE FORCE A CARRY           @Y30LB12*/ 01270000
*   /* INTO HIGHHEX WHEN 9 IS ADDED TO THE DIGIT.            @Y30LB12*/ 01271000
*   /* ************************************************@Y30LB12      */ 01272000
*   /*                                                               */ 01273000
*   /*****************************************************************/ 01274000
*                                                                  0343 01275000
*   IF HIGHHEX^=ZEROBITS            /* IF ZONE NOT ZERO      @Y30LB12*/ 01276000
*     THEN                          /*                       @Y30LB12*/ 01277000
@RC00335 TM    HIGHHEX,B'11110000'                                 0343 01278000
         BZ    @RF00343                                            0343 01279000
*     DO;                           /*                       @Y30LB12*/ 01280000
*                                                                  0344 01281000
*       /*************************************************************/ 01282000
*       /*                                                           */ 01283000
*       /* *****************************************         @Y30LB12*/ 01284000
*       /* ICG227I PARAMETER MUST BE HEXADECIMAL.            @Y30LB12*/ 01285000
*       /* KEYWORD IS (SA/SA (ALT)/CH/CH (ALT))              @Y30LB12*/ 01286000
*       /* *****************************************         @Y30LB12*/ 01287000
*       /*                                                           */ 01288000
*       /*************************************************************/ 01289000
*                                                                  0345 01290000
*       OUTBUF2(1:51)=ICGDS227;     /*                       @Y30LB12*/ 01291000
         MVC   OUTBUF2(51,R4),ICGDS227                             0345 01292000
*       OUTBUF2(52:59)=PLUGIN2;     /*                       @YM31098*/ 01293000
         MVC   OUTBUF2+51(8,R4),PLUGIN2                            0346 01294000
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/ 01295000
         BAL   @14,PUTIT1                                          0347 01296000
*     END;                          /*                       @Y30LB12*/ 01297000
*   ELSE                            /*                       @Y30LB12*/ 01298000
*     HEXINDEX=HEXCHAR+1;           /* SAVE PARAMETER        @Y30LB12*/ 01299000
         B     @RC00343                                            0349 01300000
@RF00343 SLR   @07,@07                                             0349 01301000
         IC    @07,HEXCHAR                                         0349 01302000
         LA    @07,1(,@07)                                         0349 01303000
         STH   @07,HEXINDEX                                        0349 01304000
*   END CONVHEX;                    /* RETURN TO CALLER      @Y30LB12*/ 01305000
@EL00009 DS    0H                                                  0350 01306000
@EF00009 DS    0H                                                  0350 01307000
@ER00009 LM    @14,@12,@SA00009                                    0350 01308000
         BR    @14                                                 0350 01309000
*                                                                  0351 01310000
*/********************************************************** @Y30LB12*/ 01311000
*/*                                                          @Y30LB12*/ 01312000
*/* PROCEDURE NAME - S04CUID                                 @Y30LB12*/ 01313000
*/*                                                          @Y30LB12*/ 01314000
*/* FUNCTION - HANDLE THE PARAMETER FOR THE CONTROL UNIT     @Y30LB12*/ 01315000
*/*            IDENTIFICATION WIRED INTO THE CHANNEL         @Y30LB12*/ 01316000
*/*            INTERFACE.  THE ENTIRE DEVICE ADDRESS IS 12   @Y30LB12*/ 01317000
*/*            BITS IN LENGTH, AND CONSISTS OF CHANNEL (4    @Y30LB12*/ 01318000
*/*            BITS), CONTROL UNIT (2 BITS), DEVICE (6 BITS) @Y30LB12*/ 01319000
*/*            ONLY ONE CONTROL UNIT ADDRESS SPECIFICATION   @Y30LB12*/ 01320000
*/*            IS ALLOWED PER CONTROL STATEMENT.  THE        @Y30LB12*/ 01321000
*/*            PARAMETER IS TWO CHARACTERS IN LENGTH, AND IT @Y30LB12*/ 01322000
*/*            MUST BE ONE OF THE VALUES '00', '01', '10',   @Y30LB12*/ 01323000
*/*            OR '11'.                                      @Y30LB12*/ 01324000
*/*                                                          @Y30LB12*/ 01325000
*/********************************************************** @Y30LB12*/ 01326000
*                                                                  0351 01327000
*S04CUID:                                                          0351 01328000
*   PROCEDURE;                      /*                       @Y30LB12*/ 01329000
S04CUID  STM   @14,@12,@SA00010                                    0351 01330000
*   CALL READS99;                   /* EXTRACT PARAMETER     @Y30LB12*/ 01331000
         BAL   @14,READS99                                         0352 01332000
*   IF HAVECU^='1'B                 /*                       @Y30LB12*/ 01333000
*     THEN                          /*                       @Y30LB12*/ 01334000
         TM    HAVECU,B'00010000'                                  0353 01335000
         BO    @RF00353                                            0353 01336000
*     HAVECU='1'B;                  /*                       @Y30LB12*/ 01337000
         OI    HAVECU,B'00010000'                                  0354 01338000
*   ELSE                            /*                       @Y30LB12*/ 01339000
*     DO;                           /*                       @Y30LB12*/ 01340000
*                                                                  0355 01341000
         B     @RC00353                                            0355 01342000
@RF00353 DS    0H                                                  0356 01343000
*       /*************************************************************/ 01344000
*       /*                                                           */ 01345000
*       /* *****************************************         @Y30LB12*/ 01346000
*       /* 'ICG219I DUPLICATE KEYWORD CUID'                  @Y30LB12*/ 01347000
*       /* *****************************************         @Y30LB12*/ 01348000
*       /*                                                           */ 01349000
*       /*************************************************************/ 01350000
*                                                                  0356 01351000
*       OUTBUF2(1:27)=ICGDS219;     /*                       @Y30LB12*/ 01352000
         MVC   OUTBUF2(27,R4),ICGDS219                             0356 01353000
*       OUTBUF2(28:31)='CUID';      /*                       @Y30LB12*/ 01354000
         MVC   OUTBUF2+27(4,R4),@CC00627                           0357 01355000
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/ 01356000
         BAL   @14,PUTIT1                                          0358 01357000
*       RETURN;                     /* RET. TO S04SCAN       @Y30LB12*/ 01358000
@EL00010 DS    0H                                                  0359 01359000
@EF00010 DS    0H                                                  0359 01360000
@ER00010 LM    @14,@12,@SA00010                                    0359 01361000
         BR    @14                                                 0359 01362000
*     END;                          /*                       @Y30LB12*/ 01363000
*   IF PARMBIT^='1'B                /* SET BY ICGDSS99       @Y30LB12*/ 01364000
*     THEN                          /*                       @Y30LB12*/ 01365000
@RC00353 TM    PARMBIT(R4),B'00100000'                             0361 01366000
         BO    @RF00361                                            0361 01367000
*     DO;                           /*                       @Y30LB12*/ 01368000
*                                                                  0362 01369000
*       /*************************************************************/ 01370000
*       /*                                                           */ 01371000
*       /* *****************************************         @Y30LB12*/ 01372000
*       /* ICG211I EXPECTED, BUT DID NOT FIND,               @Y30LB12*/ 01373000
*       /* PARAMETER                                         @Y30LB12*/ 01374000
*       /* *****************************************         @Y30LB12*/ 01375000
*       /*                                                           */ 01376000
*       /*************************************************************/ 01377000
*                                                                  0363 01378000
*       MSGNO=ICG211I;              /* ID FOR ICGDS211       @Y30LB12*/ 01379000
         MVC   MSGNO(2,R4),ICG211I                                 0363 01380000
*       CALL PUTIT2;                /* TO MESSAGE WRITER     @Y30LB12*/ 01381000
         BAL   @14,PUTIT2                                          0364 01382000
*       RETURN;                     /* RET. TO S04SCAN       @Y30LB12*/ 01383000
         B     @EL00010                                            0365 01384000
*     END;                          /*                       @Y30LB12*/ 01385000
*   ELSE                                                           0367 01386000
*     ;                             /*                       @Y30LB12*/ 01387000
@RF00361 DS    0H                                                  0368 01388000
*   IF SCANLEN^=2                   /* SET BY ICGDSS99       @Y30LB12*/ 01389000
*     THEN                          /*                       @Y30LB12*/ 01390000
         CLC   SCANLEN(2,R4),@CH00052                              0368 01391000
         BE    @RF00368                                            0368 01392000
*     DO;                           /*                       @Y30LB12*/ 01393000
*                                                                  0369 01394000
*       /*************************************************************/ 01395000
*       /*                                                           */ 01396000
*       /* *****************************************         @Y30LB12*/ 01397000
*       /* ICG220I INVALID PARAMETER LENGTH,                 @Y30LB12*/ 01398000
*       /* KEYWORD IS CUID                                   @Y30LB12*/ 01399000
*       /* *****************************************         @Y30LB12*/ 01400000
*       /*                                                           */ 01401000
*       /*************************************************************/ 01402000
*                                                                  0370 01403000
*       OUTBUF2(1:46)=ICGDS220;     /*                       @Y30LB12*/ 01404000
         MVC   OUTBUF2(46,R4),ICGDS220                             0370 01405000
*       OUTBUF2(47:50)='CUID';      /*                       @Y30LB12*/ 01406000
         MVC   OUTBUF2+46(4,R4),@CC00627                           0371 01407000
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/ 01408000
         BAL   @14,PUTIT1                                          0372 01409000
*       RETURN;                     /* RET. TO S04SCAN       @Y30LB12*/ 01410000
         B     @EL00010                                            0373 01411000
*     END;                          /*                       @Y30LB12*/ 01412000
*   ELSE                                                           0375 01413000
*     ;                             /*                       @Y30LB12*/ 01414000
@RF00368 DS    0H                                                  0376 01415000
*   BINCHAR(1:2)=SCANDATA(1:2);     /* PASS PARAMETER        @Y30LB12*/ 01416000
         L     @07,STARTCOL(,R4)                                   0376 01417000
         MVC   BINCHAR(2),SCANDATA(@07)                            0376 01418000
*   CALL CONVBIN;                   /* TO CONVERT PARM       @Y30LB12*/ 01419000
         BAL   @14,CONVBIN                                         0377 01420000
*   IF BININDEX^=0                  /* PARM CONVERTED OK     @Y30LB12*/ 01421000
*     THEN                          /*                       @Y30LB12*/ 01422000
         LH    @07,BININDEX                                        0378 01423000
         LTR   @07,@07                                             0378 01424000
         BZ    @RF00378                                            0378 01425000
*     WORKCU=BININDEX-1;            /* SAVE CONV. PARM       @Y30LB12*/ 01426000
         BCTR  @07,0                                               0379 01427000
         STC   @07,WORKCU                                          0379 01428000
*   ELSE                            /*                       @Y30LB12*/ 01429000
*     DO;                           /*                       @Y30LB12*/ 01430000
*                                                                  0380 01431000
         B     @RC00378                                            0380 01432000
@RF00378 DS    0H                                                  0381 01433000
*       /*************************************************************/ 01434000
*       /*                                                           */ 01435000
*       /* *****************************************         @Y30LB12*/ 01436000
*       /* ICG223I VALUE ERROR FOR CUID                      @Y30LB12*/ 01437000
*       /* *****************************************         @Y30LB12*/ 01438000
*       /*                                                           */ 01439000
*       /*************************************************************/ 01440000
*                                                                  0381 01441000
*       OUTBUF2(1:25)=ICGDS223;     /*                       @Y30LB12*/ 01442000
         MVC   OUTBUF2(25,R4),ICGDS223                             0381 01443000
*       OUTBUF2(26:29)='CUID';      /*                       @Y30LB12*/ 01444000
         MVC   OUTBUF2+25(4,R4),@CC00627                           0382 01445000
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/ 01446000
         BAL   @14,PUTIT1                                          0383 01447000
*     END;                          /*                       @Y30LB12*/ 01448000
*   END S04CUID;                    /* RET. TO S04SCAN       @Y30LB12*/ 01449000
         B     @EL00010                                            0385 01450000
*                                                                  0386 01451000
*/********************************************************** @Y30LB12*/ 01452000
*/*                                                          @Y30LB12*/ 01453000
*/* PROCEDURE NAME - CONVBIN                                 @Y30LB12*/ 01454000
*/*                                                          @Y30LB12*/ 01455000
*/* FUNCTION - THIS PROCEDURE RECEIVES AS INPUT THE          @Y30LB12*/ 01456000
*/*            CHARACTER REPRESENTATION OF TWO BINARY BITS   @Y30LB12*/ 01457000
*/*            IN 'BINCHAR'.  IF THE CHARACTER REPRESENTS    @Y30LB12*/ 01458000
*/*            A VALID BINARY NUMBER, 'BININDEX' IS SET TO   @Y30LB12*/ 01459000
*/*            THE BINARY VALUE OF THE CHARACTER PLUS ONE.   @Y30LB12*/ 01460000
*/*                                                          @Y30LB12*/ 01461000
*/********************************************************** @Y30LB12*/ 01462000
*                                                                  0386 01463000
*CONVBIN:                                                          0386 01464000
*   PROCEDURE;                      /*                       @Y30LB12*/ 01465000
CONVBIN  STM   @14,@12,12(@13)                                     0386 01466000
*   BININDEX=0;                     /* INIT RETURN FIELD     @Y30LB12*/ 01467000
         SLR   @07,@07                                             0387 01468000
         STH   @07,BININDEX                                        0387 01469000
*   IF BINCHAR='00'                 /*                       @Y30LB12*/ 01470000
*     THEN                          /*                       @Y30LB12*/ 01471000
         CLC   BINCHAR(2),@CC00383                                 0388 01472000
         BNE   @RF00388                                            0388 01473000
*     BININDEX=1;                   /*                       @Y30LB12*/ 01474000
         MVC   BININDEX(2),@CH00044                                0389 01475000
*   ELSE                                                           0390 01476000
*     ;                             /*                       @Y30LB12*/ 01477000
@RF00388 DS    0H                                                  0391 01478000
*   IF BINCHAR='01'                 /*                       @Y30LB12*/ 01479000
*     THEN                          /*                       @Y30LB12*/ 01480000
         CLC   BINCHAR(2),@CC00384                                 0391 01481000
         BNE   @RF00391                                            0391 01482000
*     BININDEX=2;                   /*                       @Y30LB12*/ 01483000
         MVC   BININDEX(2),@CH00052                                0392 01484000
*   ELSE                                                           0393 01485000
*     ;                             /*                       @Y30LB12*/ 01486000
@RF00391 DS    0H                                                  0394 01487000
*   IF BINCHAR='10'                 /*                       @Y30LB12*/ 01488000
*     THEN                          /*                       @Y30LB12*/ 01489000
         CLC   BINCHAR(2),@CC00399                                 0394 01490000
         BNE   @RF00394                                            0394 01491000
*     BININDEX=3;                   /*                       @Y30LB12*/ 01492000
         MVC   BININDEX(2),@CH00050                                0395 01493000
*   ELSE                                                           0396 01494000
*     ;                             /*                       @Y30LB12*/ 01495000
@RF00394 DS    0H                                                  0397 01496000
*   IF BINCHAR='11'                 /*                       @Y30LB12*/ 01497000
*     THEN                          /*                       @Y30LB12*/ 01498000
         CLC   BINCHAR(2),@CC00400                                 0397 01499000
         BNE   @RF00397                                            0397 01500000
*     BININDEX=4;                   /*                       @Y30LB12*/ 01501000
         MVC   BININDEX(2),@CH00070                                0398 01502000
*   ELSE                                                           0399 01503000
*     ;                             /*                       @Y30LB12*/ 01504000
@RF00397 DS    0H                                                  0400 01505000
*   END CONVBIN;                    /* RET. TO S04CUID       @Y30LB12*/ 01506000
@EL00011 DS    0H                                                  0400 01507000
@EF00011 DS    0H                                                  0400 01508000
@ER00011 LM    @14,@12,12(@13)                                     0400 01509000
         BR    @14                                                 0400 01510000
*                                                                  0401 01511000
*/********************************************************** @Y30LB12*/ 01512000
*/*                                                          @Y30LB12*/ 01513000
*/* PROCEDURE NAME - S04CPUID                                @Y30LB12*/ 01514000
*/*                                                          @Y30LB12*/ 01515000
*/* FUNCTION - WHEN THE KEYWORD IS 'CPUID', READ THE         @Y30LB12*/ 01516000
*/*            PARAMETER, CHECK FOR DUPLICATE KEYWORD,       @Y30LB12*/ 01517000
*/*            CALL PROCEDURE CPUCONV TO FORMAT AS PACKED,   @Y30LB12*/ 01518000
*/*            AND RETURN TO S04SCAN.                        @Y30LB12*/ 01519000
*/*                                                          @Y30LB12*/ 01520000
*/********************************************************** @Y30LB12*/ 01521000
*                                                                  0401 01522000
*S04CPUID:                                                         0401 01523000
*   PROCEDURE;                      /*                       @Y30LB12*/ 01524000
S04CPUID STM   @14,@12,@SA00012                                    0401 01525000
*   CALL READS99;                   /* EXTRACT PARAMETER     @Y30LB12*/ 01526000
         BAL   @14,READS99                                         0402 01527000
*   IF HAVECPU^='1'B                /* IF KEYWORD WAS        @Y30LB12*/ 01528000
*     THEN                          /* NOT USED EARLIER      @Y30LB12*/ 01529000
         TM    HAVECPU,B'00001000'                                 0403 01530000
         BO    @RF00403                                            0403 01531000
*     HAVECPU='1'B;                 /* SET FLAG FOR USED     @Y30LB12*/ 01532000
         OI    HAVECPU,B'00001000'                                 0404 01533000
*   ELSE                            /* ELSE WRITE MSG        @Y30LB12*/ 01534000
*     DO;                           /*                       @Y30LB12*/ 01535000
*                                                                  0405 01536000
         B     @RC00403                                            0405 01537000
@RF00403 DS    0H                                                  0406 01538000
*       /*************************************************************/ 01539000
*       /*                                                           */ 01540000
*       /* ******************************************        @Y30LB12*/ 01541000
*       /* ICG219I DUPLICATE KEYWORD CPUID                   @Y30LB12*/ 01542000
*       /* ******************************************        @Y30LB12*/ 01543000
*       /*                                                           */ 01544000
*       /*************************************************************/ 01545000
*                                                                  0406 01546000
*       OUTBUF2(1:27)=ICGDS219;     /*                       @Y30LB12*/ 01547000
         MVC   OUTBUF2(27,R4),ICGDS219                             0406 01548000
*       OUTBUF2(28:32)='CPUID';     /*                       @Y30LB12*/ 01549000
         MVC   OUTBUF2+27(5,R4),@CC00636                           0407 01550000
*       CALL PUTIT1;                /* CALL MSG WRITER       @Y30LB12*/ 01551000
         BAL   @14,PUTIT1                                          0408 01552000
*       RETURN;                     /* TO S04SCAN            @Y30LB12*/ 01553000
@EL00012 DS    0H                                                  0409 01554000
@EF00012 DS    0H                                                  0409 01555000
@ER00012 LM    @14,@12,@SA00012                                    0409 01556000
         BR    @14                                                 0409 01557000
*     END;                          /*                       @Y30LB12*/ 01558000
*   IF PARMBIT^='1'B                /* SET BY ICGDSS99       @Y30LB12*/ 01559000
*     THEN                          /*                       @Y30LB12*/ 01560000
@RC00403 TM    PARMBIT(R4),B'00100000'                             0411 01561000
         BO    @RF00411                                            0411 01562000
*     DO;                           /*                       @Y30LB12*/ 01563000
*                                                                  0412 01564000
*       /*************************************************************/ 01565000
*       /*                                                           */ 01566000
*       /* *****************************************         @Y30LB12*/ 01567000
*       /* ICG211I EXPECTED, BUT DID NOT FIND,               @Y30LB12*/ 01568000
*       /* PARAMETER                                         @Y30LB12*/ 01569000
*       /* *****************************************         @Y30LB12*/ 01570000
*       /*                                                           */ 01571000
*       /*************************************************************/ 01572000
*                                                                  0413 01573000
*       MSGNO=ICG211I;              /* ID FOR ICGDS211       @Y30LB12*/ 01574000
         MVC   MSGNO(2,R4),ICG211I                                 0413 01575000
*       CALL PUTIT2;                /* CALL MSG WRITER       @Y30LB12*/ 01576000
         BAL   @14,PUTIT2                                          0414 01577000
*       RETURN;                     /* TO S04SCAN            @Y30LB12*/ 01578000
         B     @EL00012                                            0415 01579000
*     END;                          /*                       @Y30LB12*/ 01580000
*   ELSE                                                           0417 01581000
*     ;                             /*                       @Y30LB12*/ 01582000
@RF00411 DS    0H                                                  0418 01583000
*   ERROR='0'B;                     /* SET OFF ERROR FLG     @Y30LB12*/ 01584000
         NI    ERROR,B'11101111'                                   0418 01585000
*   CALL CPUCONV;                   /* TO PACK CPUID         @Y30LB12*/ 01586000
         BAL   @14,CPUCONV                                         0419 01587000
*   IF ERROR='0'B                   /* CHECK ERROR FLAG      @Y30LB12*/ 01588000
*     THEN                          /* IF NO ERROR           @Y30LB12*/ 01589000
         TM    ERROR,B'00010000'                                   0420 01590000
         BNZ   @RF00420                                            0420 01591000
*     WORKCPU=PACKED(1:5);          /* CPUID TO LCL WORK     @Y30LB12*/ 01592000
         MVC   WORKCPU(5),PACKED                                   0421 01593000
*   ELSE                            /* ELSE WRITE MSG        @Y30LB12*/ 01594000
*     DO;                           /*                       @Y30LB12*/ 01595000
*                                                                  0422 01596000
         B     @RC00420                                            0422 01597000
@RF00420 DS    0H                                                  0423 01598000
*       /*************************************************************/ 01599000
*       /*                                                           */ 01600000
*       /* *****************************************         @Y30LB12*/ 01601000
*       /* ICG220I INVALID PARAMETER LENGTH.                 @Y30LB12*/ 01602000
*       /* KEYWORD IS CPUID                                  @Y30LB12*/ 01603000
*       /* *****************************************         @Y30LB12*/ 01604000
*       /*                                                           */ 01605000
*       /*************************************************************/ 01606000
*                                                                  0423 01607000
*       OUTBUF2(1:46)=ICGDS220;     /*                       @Y30LB12*/ 01608000
         MVC   OUTBUF2(46,R4),ICGDS220                             0423 01609000
*       OUTBUF2(47:51)='CPUID';     /*                       @Y30LB12*/ 01610000
         MVC   OUTBUF2+46(5,R4),@CC00636                           0424 01611000
*       CALL PUTIT1;                /* CALL MSG WRITER       @Y30LB12*/ 01612000
         BAL   @14,PUTIT1                                          0425 01613000
*     END;                          /*                       @Y30LB12*/ 01614000
*   END S04CPUID;                   /* TO S04SCAN            @Y30LB12*/ 01615000
         B     @EL00012                                            0427 01616000
*                                                                  0428 01617000
*/********************************************************** @Y30LB12*/ 01618000
*/*                                                          @Y30LB12*/ 01619000
*/* PROCEDURE NAME - CPUCONV                                 @Y30LB12*/ 01620000
*/*                                                          @Y30LB12*/ 01621000
*/* FUNCTION - CONVERT MANUFACTURER'S IDENTIFICATION FROM    @Y30LB12*/ 01622000
*/*            CHARACTER REPRESENTATION TO PACKED.  IF WRONG @Y30LB12*/ 01623000
*/*            LENGTH, SET INDICATOR THAT ERROR MESSAGE IS   @Y30LB12*/ 01624000
*/*            NEEDED.                                       @Y30LB12*/ 01625000
*/*                                                          @Y30LB12*/ 01626000
*/********************************************************** @Y30LB12*/ 01627000
*                                                                  0428 01628000
*CPUCONV:                                                          0428 01629000
*   PROCEDURE;                      /*                       @Y30LB12*/ 01630000
CPUCONV  STM   @14,@12,@SA00013                                    0428 01631000
*   IF SCANLEN=10                   /* SET BY ICGDSS99       @Y30LB12*/ 01632000
*     THEN                          /*                       @Y30LB12*/ 01633000
         CLC   SCANLEN(2,R4),@CH00448                              0429 01634000
         BNE   @RF00429                                            0429 01635000
*     DO;                           /*                       @Y30LB12*/ 01636000
*       UNPACKED(1:10)=SCANDATA(1:10);/*                     @Y30LB12*/ 01637000
         L     @07,STARTCOL(,R4)                                   0431 01638000
         MVC   UNPACKED(10),SCANDATA(@07)                          0431 01639000
*       UNPACKED(11)='F0'X;         /*                       @Y30LB12*/ 01640000
         MVI   UNPACKED+10,X'F0'                                   0432 01641000
*       GEN(PACK  PACKED(6),UNPACKED(11));/*                 @Y30LB12*/ 01642000
         PACK  PACKED(6),UNPACKED(11)                                   01643000
*       CALL CPUCHECK;              /* CHECK FOR NUMERICS    @Y30LB12*/ 01644000
         BAL   @14,CPUCHECK                                        0434 01645000
*     END;                          /*                       @Y30LB12*/ 01646000
*   ELSE                            /*                       @Y30LB12*/ 01647000
*     ERROR='1'B;                   /* TESTED IN S04CPUID    @Y30LB12*/ 01648000
         B     @RC00429                                            0436 01649000
@RF00429 OI    ERROR,B'00010000'                                   0436 01650000
*   END CPUCONV;                    /* RETURN TO S04CPUID    @Y30LB12*/ 01651000
@EL00013 DS    0H                                                  0437 01652000
@EF00013 DS    0H                                                  0437 01653000
@ER00013 LM    @14,@12,@SA00013                                    0437 01654000
         BR    @14                                                 0437 01655000
*                                                                  0438 01656000
*/***********************************************************@Y30LB12*/ 01657000
*/*                                                          @Y30LB12*/ 01658000
*/* PROCEDURE NAME - CPUCHECK                                @Y30LB12*/ 01659000
*/*                                                          @Y30LB12*/ 01660000
*/* FUNCTION - CHECK EACH CHARACTER OF CPUID FOR A NUMERIC   @Y30LB12*/ 01661000
*/*            DIGIT IN THE RANGE 0-9                        @Y30LB12*/ 01662000
*/*                                                          @Y30LB12*/ 01663000
*/***********************************************************@Y30LB12*/ 01664000
*                                                                  0438 01665000
*CPUCHECK:                                                         0438 01666000
*   PROCEDURE;                      /*                       @Y30LB12*/ 01667000
CPUCHECK STM   @14,@12,@SA00014                                    0438 01668000
*   DO I=1 TO 10;                   /* INDEX TO SCANDATA     @Y30LB12*/ 01669000
         LA    I,1                                                 0439 01670000
@DL00439 DS    0H                                                  0440 01671000
*     HAVENUM='0'B;                 /* FOUND NUMBER FLAG     @Y30LB12*/ 01672000
         NI    HAVENUM,B'11111101'                                 0440 01673000
*     DO J=1 TO 10;                 /* INDEX TO NUMBERS      @Y30LB12*/ 01674000
         LA    J,1                                                 0441 01675000
@DL00441 DS    0H                                                  0442 01676000
*       IF SCANDATA(I)=PATTERN2(J)  /* IF MATCH              @Y30LB12*/ 01677000
*         THEN                      /*                       @Y30LB12*/ 01678000
         L     @07,STARTCOL(,R4)                                   0442 01679000
         ALR   @07,I                                               0442 01680000
         BCTR  @07,0                                               0442 01681000
         LA    @05,PATTERN2-1(J)                                   0442 01682000
         CLC   SCANDATA(1,@07),0(@05)                              0442 01683000
         BNE   @RF00442                                            0442 01684000
*         HAVENUM='1'B;             /* SET FOUND MATCH       @Y30LB12*/ 01685000
         OI    HAVENUM,B'00000010'                                 0443 01686000
*       ELSE                                                       0444 01687000
*         ;                         /*                       @Y30LB12*/ 01688000
@RF00442 DS    0H                                                  0445 01689000
*     END;                          /* ALL VALID NUMBERS     @Y30LB12*/ 01690000
         AH    J,@CH00044                                          0445 01691000
         CH    J,@CH00448                                          0445 01692000
         BNH   @DL00441                                            0445 01693000
*     IF HAVENUM^='1'B              /* NO MATCH FOUND        @Y30LB12*/ 01694000
*       THEN                        /*                       @Y30LB12*/ 01695000
         TM    HAVENUM,B'00000010'                                 0446 01696000
         BO    @RF00446                                            0446 01697000
*       DO;                         /*                       @Y30LB12*/ 01698000
*                                                                  0447 01699000
*         /***********************************************************/ 01700000
*         /*                                                         */ 01701000
*         /* ******************************************@Y30LB12      */ 01702000
*         /* ICG223I VALUE ERROR FOR CPUID                   @Y30LB12*/ 01703000
*         /* ******************************************@Y30LB12      */ 01704000
*         /*                                                         */ 01705000
*         /***********************************************************/ 01706000
*                                                                  0448 01707000
*         OUTBUF2(1:25)=ICGDS223;   /*                       @Y30LB12*/ 01708000
         MVC   OUTBUF2(25,R4),ICGDS223                             0448 01709000
*         OUTBUF2(26:30)='CPUID';   /*                       @Y30LB12*/ 01710000
         MVC   OUTBUF2+25(5,R4),@CC00636                           0449 01711000
*         CALL PUTIT1;              /* TO MESSAGE WRITER     @Y30LB12*/ 01712000
         BAL   @14,PUTIT1                                          0450 01713000
*         RETURN;                   /* STOP CHECKING         @Y30LB12*/ 01714000
@EL00014 DS    0H                                                  0451 01715000
@EF00014 DS    0H                                                  0451 01716000
@ER00014 LM    @14,@12,@SA00014                                    0451 01717000
         BR    @14                                                 0451 01718000
*       END;                        /*                       @Y30LB12*/ 01719000
*     ELSE                                                         0453 01720000
*       ;                           /*                       @Y30LB12*/ 01721000
@RF00446 DS    0H                                                  0454 01722000
*   END;                            /* CHECKED ALL CHARS     @Y30LB12*/ 01723000
         AH    I,@CH00044                                          0454 01724000
         CH    I,@CH00448                                          0454 01725000
         BNH   @DL00439                                            0454 01726000
*   END CPUCHECK;                   /* RETURN TO CPUCONV     @Y30LB12*/ 01727000
         B     @EL00014                                            0455 01728000
*                                                                  0456 01729000
*/********************************************************** @OZ09548*/ 01730000
*/*                                                          @OZ09548*/ 01731000
*/* PROCEDURE NAME - REALALTP                                @OZ09548*/ 01732000
*/*                                                          @OZ09548*/ 01733000
*/* FUNCTION - CHECK THE FIRST KEYWORD FOLLOWING 'REAL' OR   @OZ09548*/ 01734000
*/*            'CONVREAL' FOR THE VALUE 'ALTPATH='.  IF THE  @OZ09548*/ 01735000
*/*            VALUE IS FOUND, CALL THE ROUTINE 'S04ALTP'    @OZ09548*/ 01736000
*/*            TO PROCESS THE ALTERNATE PATH INFORMATION,    @OZ09548*/ 01737000
*/*            AND THEN CALL 'RSGALTP' TO MOVE THE           @OZ09548*/ 01738000
*/*            ALTERNATE PATH INFORMATION INTO EACH BLOCK.   @OZ09548*/ 01739000
*/*            IF THE KEYWORD SCANNED IS NOT 'ALTPATH=',     @OZ09548*/ 01740000
*/*            RESET THE POINTERS 'STARTCCOL' AND 'NEXTCOL'  @OZ09548*/ 01741000
*/*            TO RESCAN THE KEYWORD IN THE MAIN SCAN        @OZ09548*/ 01742000
*/*            ROUTINE, 'S04SCAN'.                           @OZ09548*/ 01743000
*/*                                                          @OZ09548*/ 01744000
*/********************************************************** @OZ09548*/ 01745000
*                                                                  0456 01746000
*REALALTP:                                                         0456 01747000
*   PROCEDURE;                      /*                       @OZ09548*/ 01748000
REALALTP STM   @14,@12,@SA00015                                    0456 01749000
*   ALTPDUN='0'B;                   /* INIT. OUT FLAG        @ZA28470*/ 01750000
         NI    ALTPDUN,B'11111011'                                 0457 01751000
*   DO WHILE LASTPARM='0'B&         /* CHECK ALL PARMS       @ZA28470*/ 01752000
*         ALTPDUN='0'B;             /* CHECK OUT FLAG,ON EXIT@ZA28470*/ 01753000
         B     @DE00458                                            0458 01754000
@DL00458 DS    0H                                                  0459 01755000
*     SAVESCOL=STARTCOL;            /* SAVE FOR RESTART      @OZ09548*/ 01756000
         MVC   SAVESCOL(4,R4),STARTCOL(R4)                         0459 01757000
*     SAVENCOL=NEXTCOL;             /* SAVE FOR RESTART      @OZ09548*/ 01758000
         MVC   SAVENCOL(4,R4),NEXTCOL(R4)                          0460 01759000
*     CALL READS99;                 /* READ NEXT KEYWORD     @OZ09548*/ 01760000
         BAL   @14,READS99                                         0461 01761000
*     IF SCANDATA(1:8)='ALTPATH='   /*                       @OZ09548*/ 01762000
*       THEN                        /*                       @OZ09548*/ 01763000
         L     @07,STARTCOL(,R4)                                   0462 01764000
         CLC   SCANDATA(8,@07),@CC00649                            0462 01765000
         BNE   @RF00462                                            0462 01766000
*       DO;                         /*                       @OZ09548*/ 01767000
*         CALL S04ALTP;             /* GET PARAMETERS        @OZ09548*/ 01768000
         BAL   @14,S04ALTP                                         0464 01769000
*         CALL RSGALTP;             /* MOVE TO WORK AREA     @OZ09548*/ 01770000
         BAL   @14,RSGALTP                                         0465 01771000
*       END;                        /*                       @OZ09548*/ 01772000
*     ELSE                          /*                       @OZ09548*/ 01773000
*       DO;                         /*                       @OZ09548*/ 01774000
         B     @RC00462                                            0467 01775000
@RF00462 DS    0H                                                  0468 01776000
*         ALTPDUN='1'B;             /* SET OUT FLAG 'ON'     @ZA28470*/ 01777000
         OI    ALTPDUN,B'00000100'                                 0468 01778000
*         STARTCOL=SAVESCOL;        /* RESTORE TO RESTART    @OZ09548*/ 01779000
         MVC   STARTCOL(4,R4),SAVESCOL(R4)                         0469 01780000
*         NEXTCOL=SAVENCOL;         /* RESTORE TO RESTART    @OZ09548*/ 01781000
         MVC   NEXTCOL(4,R4),SAVENCOL(R4)                          0470 01782000
*       END;                        /*                       @OZ09548*/ 01783000
*   END;                            /*                       @ZA28470*/ 01784000
@RC00462 DS    0H                                                  0472 01785000
@DE00458 TM    LASTPARM(R4),B'00001000'                            0472 01786000
         BNZ   @DC00458                                            0472 01787000
         TM    ALTPDUN,B'00000100'                                 0472 01788000
         BZ    @DL00458                                            0472 01789000
@DC00458 DS    0H                                                  0473 01790000
*   END REALALTP;                   /*                       @OZ09548*/ 01791000
@EL00015 DS    0H                                                  0473 01792000
@EF00015 DS    0H                                                  0473 01793000
@ER00015 LM    @14,@12,@SA00015                                    0473 01794000
         BR    @14                                                 0473 01795000
*                                                                  0474 01796000
*/********************************************************** @Y30LB12*/ 01797000
*/*                                                          @Y30LB12*/ 01798000
*/* PROCEDURE NAME - S04VVS                                  @Y30LB12*/ 01799000
*/*                                                          @Y30LB12*/ 01800000
*/* FUNCTION - SCAN FOR SECONDARY KEYWORDS 'RSG', 'ADDR', &  @Y30LB12*/ 01801000
*/*            'ALTPATH' AND CALL THE APPROPRIATE SUBROUTINE @Y30LB12*/ 01802000
*/*            TO HANDLE EACH PARAMETER OR PARAMETERS THAT   @Y30LB12*/ 01803000
*/*            FOLLOW.  IF THE KEYWORD IS NONE OF THE THREE  @Y30LB12*/ 01804000
*/*            KEYWORDS LISTED ABOVE, LOGICALLY REPOSITION   @Y30LB12*/ 01805000
*/*            TO THE START OF THE KEYWORD AND RETURN TO     @Y30LB12*/ 01806000
*/*            S04SCAN TO REPROCESS.                         @Y30LB12*/ 01807000
*/*                                                          @Y30LB12*/ 01808000
*/********************************************************** @Y30LB12*/ 01809000
*                                                                  0474 01810000
*S04VVS:                                                           0474 01811000
*   PROCEDURE;                      /*                       @Y30LB12*/ 01812000
S04VVS   STM   @14,@12,@SA00016                                    0474 01813000
*   HAVERSG='0'B;                   /* ALLOW 1 PER GROUP     @Y30LB12*/ 01814000
         NI    HAVERSG,B'11111011'                                 0475 01815000
*   KNOWN2='1'B;                    /* LOOP CONTROL FLAG     @Y30LB12*/ 01816000
         OI    KNOWN2,B'01000000'                                  0476 01817000
*   DO WHILE(KNOWN2='1'B            /*                       @YM32178*/ 01818000
*         &LASTPARM='0'B);          /*                       @YM32178*/ 01819000
         B     @DE00477                                            0477 01820000
@DL00477 DS    0H                                                  0478 01821000
*     KNOWN2='0'B;                  /* RESET FLAG            @Y30LB12*/ 01822000
         NI    KNOWN2,B'10111111'                                  0478 01823000
*     SAVESCOL=STARTCOL;            /* SAVE FOR RESTART      @Y30LB12*/ 01824000
         MVC   SAVESCOL(4,R4),STARTCOL(R4)                         0479 01825000
*     SAVENCOL=NEXTCOL;             /* SAVE FOR RESTART      @Y30LB12*/ 01826000
         MVC   SAVENCOL(4,R4),NEXTCOL(R4)                          0480 01827000
*     CALL READS99;                 /* EXTRACT KEYWORD       @Y30LB12*/ 01828000
*                                                                  0481 01829000
         BAL   @14,READS99                                         0481 01830000
*     /***************************************************************/ 01831000
*     /*                                                             */ 01832000
*     /* ***********************************************     @Y30LB12*/ 01833000
*     /* IF THE KEYWORD SCANNED IS SDG                       @Y30LB12*/ 01834000
*     /* ***********************************************     @Y30LB12*/ 01835000
*     /*                                                             */ 01836000
*     /***************************************************************/ 01837000
*                                                                  0482 01838000
*     IF SCANDATA(1:4)='SDG='&KNOWN2='0'B/*                  @Y30LB12*/ 01839000
*       THEN                        /*                       @Y30LB12*/ 01840000
         L     @07,STARTCOL(,R4)                                   0482 01841000
         CLC   SCANDATA(4,@07),@CC00654                            0482 01842000
         BNE   @RF00482                                            0482 01843000
         TM    KNOWN2,B'01000000'                                  0482 01844000
         BNZ   @RF00482                                            0482 01845000
*       DO;                         /*                       @Y30LB12*/ 01846000
*         KNOWN2='1'B;              /* RECOGNIZED KEYWD      @Y30LB12*/ 01847000
         OI    KNOWN2,B'01000000'                                  0484 01848000
*         CALL S04RSG;              /* TO GET PARAMETER      @Y30LB12*/ 01849000
         BAL   @14,S04RSG                                          0485 01850000
*       END;                        /*                       @Y30LB12*/ 01851000
*     ELSE                                                         0487 01852000
*       ;                           /*                       @Y30LB12*/ 01853000
*                                                                  0487 01854000
@RF00482 DS    0H                                                  0488 01855000
*     /***************************************************************/ 01856000
*     /*                                                             */ 01857000
*     /* ***********************************************     @Y30LB12*/ 01858000
*     /* IF THE KEYWORD SCANNED IS ADDR                      @Y30LB12*/ 01859000
*     /* ***********************************************     @Y30LB12*/ 01860000
*     /*                                                             */ 01861000
*     /***************************************************************/ 01862000
*                                                                  0488 01863000
*     IF SCANDATA(1:5)='ADDR='&KNOWN2='0'B/*                 @Y30LB12*/ 01864000
*       THEN                        /*                       @Y30LB12*/ 01865000
         L     @07,STARTCOL(,R4)                                   0488 01866000
         CLC   SCANDATA(5,@07),@CC00656                            0488 01867000
         BNE   @RF00488                                            0488 01868000
         TM    KNOWN2,B'01000000'                                  0488 01869000
         BNZ   @RF00488                                            0488 01870000
*       DO;                         /*                       @Y30LB12*/ 01871000
*         KNOWN2='1'B;              /* RECOGNIZED KEYWD      @Y30LB12*/ 01872000
         OI    KNOWN2,B'01000000'                                  0490 01873000
*         CALL S04ADDR;             /* TO GET PARAMETERS     @Y30LB12*/ 01874000
         BAL   @14,S04ADDR                                         0491 01875000
*       END;                        /*                       @Y30LB12*/ 01876000
*     ELSE                                                         0493 01877000
*       ;                           /*                       @Y30LB12*/ 01878000
*                                                                  0493 01879000
@RF00488 DS    0H                                                  0494 01880000
*     /***************************************************************/ 01881000
*     /*                                                             */ 01882000
*     /* ***********************************************     @Y30LB12*/ 01883000
*     /* IF THE KEYWORD SCANNED IS ALTPATH                   @Y30LB12*/ 01884000
*     /* ***********************************************     @Y30LB12*/ 01885000
*     /*                                                             */ 01886000
*     /***************************************************************/ 01887000
*                                                                  0494 01888000
*     IF SCANDATA(1:8)='ALTPATH='&KNOWN2='0'B/*              @Y30LB12*/ 01889000
*       THEN                        /*                       @Y30LB12*/ 01890000
         L     @07,STARTCOL(,R4)                                   0494 01891000
         CLC   SCANDATA(8,@07),@CC00649                            0494 01892000
         BNE   @RF00494                                            0494 01893000
         TM    KNOWN2,B'01000000'                                  0494 01894000
         BNZ   @RF00494                                            0494 01895000
*       DO;                         /*                       @Y30LB12*/ 01896000
*         KNOWN2='1'B;              /* RECOGNIZED KEYWD      @Y30LB12*/ 01897000
         OI    KNOWN2,B'01000000'                                  0496 01898000
*         CALL S04ALTP;             /* TO GET PARAMETERS     @Y30LB12*/ 01899000
         BAL   @14,S04ALTP                                         0497 01900000
*       END;                        /*                       @Y30LB12*/ 01901000
*     ELSE                                                         0499 01902000
*       ;                           /*                       @Y30LB12*/ 01903000
*                                                                  0499 01904000
@RF00494 DS    0H                                                  0500 01905000
*     /***************************************************************/ 01906000
*     /*                                                             */ 01907000
*     /* ***********************************************     @Y30LB12*/ 01908000
*     /* IF KEYWORD WAS NONE OF THE THREE TESTED ABOVE,      @Y30LB12*/ 01909000
*     /* RESTORE THE STARTING COLUMN AND NEXT COLUNM         @Y30LB12*/ 01910000
*     /* SO THAT THE KEYWORD CAN BE RESCANNED IN THE         @Y30LB12*/ 01911000
*     /* PROCEDURE S04SCAN, AND CHECK TO BE SURE THAT        @Y30LB12*/ 01912000
*     /* THE KEYWORD AND PARAMETER FOR RSG AND ADDR          @YM31098*/ 01913000
*     /* WERE SUPPLIED.                                      @YM31098*/ 01914000
*     /* ***********************************************     @Y30LB12*/ 01915000
*     /*                                                             */ 01916000
*     /***************************************************************/ 01917000
*                                                                  0500 01918000
*     IF KNOWN2='0'B                /* NO RECOGNITION        @Y30LB12*/ 01919000
*       THEN                        /*                       @Y30LB12*/ 01920000
         TM    KNOWN2,B'01000000'                                  0500 01921000
         BNZ   @RF00500                                            0500 01922000
*       DO;                         /*                       @Y30LB12*/ 01923000
*         STARTCOL=SAVESCOL;        /* RESTORE TO RESTRT     @Y30LB12*/ 01924000
         MVC   STARTCOL(4,R4),SAVESCOL(R4)                         0502 01925000
*         NEXTCOL=SAVENCOL;         /* RESTORE TO RESTRT     @Y30LB12*/ 01926000
         MVC   NEXTCOL(4,R4),SAVENCOL(R4)                          0503 01927000
*         IF HAVERSG='0'B           /* NO RSG SPECIFIED      @Y30LB12*/ 01928000
*           THEN                    /*                       @Y30LB12*/ 01929000
         TM    HAVERSG,B'00000100'                                 0504 01930000
         BNZ   @RF00504                                            0504 01931000
*           DO;                     /*                       @Y30LB12*/ 01932000
*                                                                  0505 01933000
*             /*******************************************************/ 01934000
*             /*                                                     */ 01935000
*             /* ***********************************         @Y30LB12*/ 01936000
*             /* ICG221I MISSING REQUIRED                    @Y30LB12*/ 01937000
*             /* KEYWORD SDG                                 @Y30LB12*/ 01938000
*             /* ***********************************         @Y30LB12*/ 01939000
*             /*                                                     */ 01940000
*             /*******************************************************/ 01941000
*                                                                  0506 01942000
*             OUTBUF2(1:34)=ICGDS221;/*                      @Y30LB12*/ 01943000
         MVC   OUTBUF2(34,R4),ICGDS221                             0506 01944000
*             OUTBUF2(35:37)='SDG'; /*                       @Y30LB12*/ 01945000
         MVC   OUTBUF2+34(3,R4),@CC00659                           0507 01946000
*             CALL PUTIT1;          /* TO MESSAGE WRITER     @Y30LB12*/ 01947000
         BAL   @14,PUTIT1                                          0508 01948000
*           END;                    /*                       @Y30LB12*/ 01949000
*         ELSE                                                     0510 01950000
*           ;                       /*                       @Y30LB12*/ 01951000
@RF00504 DS    0H                                                  0511 01952000
*         IF HAVEADDR='0'B          /* NO ADDR SPECIFIED     @Y30LB12*/ 01953000
*           THEN                    /*                       @Y30LB12*/ 01954000
         TM    HAVEADDR,B'00000001'                                0511 01955000
         BNZ   @RF00511                                            0511 01956000
*           DO;                     /*                       @Y30LB12*/ 01957000
*                                                                  0512 01958000
*             /*******************************************************/ 01959000
*             /*                                                     */ 01960000
*             /* ***********************************         @Y30LB12*/ 01961000
*             /* ICG221I MISSING REQUIRED                    @Y30LB12*/ 01962000
*             /* KEYWORD ADDR                                @Y30LB12*/ 01963000
*             /* ***********************************         @Y30LB12*/ 01964000
*             /*                                                     */ 01965000
*             /*******************************************************/ 01966000
*                                                                  0513 01967000
*             OUTBUF2(1:34)=ICGDS221;/*                      @Y30LB12*/ 01968000
         MVC   OUTBUF2(34,R4),ICGDS221                             0513 01969000
*             OUTBUF2(35:38)='ADDR';/*                       @Y30LB12*/ 01970000
         MVC   OUTBUF2+34(4,R4),@CC00661                           0514 01971000
*             CALL PUTIT1;          /* TO MESSAGE WRITER     @Y30LB12*/ 01972000
         BAL   @14,PUTIT1                                          0515 01973000
*           END;                    /*                       @Y30LB12*/ 01974000
*         ELSE                                                     0517 01975000
*           ;                       /*                       @Y30LB12*/ 01976000
@RF00511 DS    0H                                                  0518 01977000
*         RETURN;                   /* RETURN TO S04SCAN     @Y30LB12*/ 01978000
@EL00016 DS    0H                                                  0518 01979000
@EF00016 DS    0H                                                  0518 01980000
@ER00016 LM    @14,@12,@SA00016                                    0518 01981000
         BR    @14                                                 0518 01982000
*       END;                        /*                       @Y30LB12*/ 01983000
*     ELSE                                                         0520 01984000
*       ;                           /*                       @Y30LB12*/ 01985000
@RF00500 DS    0H                                                  0521 01986000
*   END;                            /* OF DO WHILE LOOP      @Y30LB12*/ 01987000
@DE00477 TM    KNOWN2,B'01000000'                                  0521 01988000
         BNO   @DC00477                                            0521 01989000
         TM    LASTPARM(R4),B'00001000'                            0521 01990000
         BZ    @DL00477                                            0521 01991000
@DC00477 DS    0H                                                  0522 01992000
*   END S04VVS;                     /* RETURN TO S04SCAN     @Y30LB12*/ 01993000
         B     @EL00016                                            0522 01994000
*                                                                  0523 01995000
*/********************************************************** @Y30LB12*/ 01996000
*/*                                                          @Y30LB12*/ 01997000
*/* PROCEDURE NAME - S04RSG                                  @Y30LB12*/ 01998000
*/*                                                          @Y30LB12*/ 01999000
*/* FUNCTION - CHECK TO BE SURE THERE IS ONLY ONE RSG GIVEN  @Y30LB12*/ 02000000
*/*            FOR THIS 'V' OR 'VS' GROUP.  CALL CONVRSG TO  @Y30LB12*/ 02001000
*/*            DEVELOP RSG NUMBER.  SAVE IN GETRSG UNTIL ALL @Y30LB12*/ 02002000
*/*            SUBKEYWORDS AND SUBPARAMETERS FOR THIS        @Y30LB12*/ 02003000
*/*            SUBGROUP HAVE BEEN READ.                      @Y30LB12*/ 02004000
*/*                                                          @Y30LB12*/ 02005000
*/********************************************************** @Y30LB12*/ 02006000
*                                                                  0523 02007000
*S04RSG:                                                           0523 02008000
*   PROCEDURE;                      /*                       @Y30LB12*/ 02009000
S04RSG   STM   @14,@12,@SA00017                                    0523 02010000
*   CALL READS99;                   /* EXTRACT PARAMETER     @Y30LB12*/ 02011000
         BAL   @14,READS99                                         0524 02012000
*   IF HAVERSG^='1'B                /*                       @Y30LB12*/ 02013000
*     THEN                          /*                       @Y30LB12*/ 02014000
         TM    HAVERSG,B'00000100'                                 0525 02015000
         BO    @RF00525                                            0525 02016000
*     HAVERSG='1'B;                 /*                       @Y30LB12*/ 02017000
         OI    HAVERSG,B'00000100'                                 0526 02018000
*   ELSE                            /*                       @Y30LB12*/ 02019000
*     DO;                           /*                       @Y30LB12*/ 02020000
*                                                                  0527 02021000
         B     @RC00525                                            0527 02022000
@RF00525 DS    0H                                                  0528 02023000
*       /*************************************************************/ 02024000
*       /*                                                           */ 02025000
*       /* *****************************************         @Y30LB12*/ 02026000
*       /* 'ICG219I DUPLICATE KEYWORD SDG'                   @Y30LB12*/ 02027000
*       /* *****************************************         @Y30LB12*/ 02028000
*       /*                                                           */ 02029000
*       /*************************************************************/ 02030000
*                                                                  0528 02031000
*       OUTBUF2(1:27)=ICGDS219;     /*                       @Y30LB12*/ 02032000
         MVC   OUTBUF2(27,R4),ICGDS219                             0528 02033000
*       OUTBUF2(28:30)='SDG';       /*                       @Y30LB12*/ 02034000
         MVC   OUTBUF2+27(3,R4),@CC00659                           0529 02035000
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/ 02036000
         BAL   @14,PUTIT1                                          0530 02037000
*       RETURN;                     /* RETURN TO S04VVS      @Y30LB12*/ 02038000
@EL00017 DS    0H                                                  0531 02039000
@EF00017 DS    0H                                                  0531 02040000
@ER00017 LM    @14,@12,@SA00017                                    0531 02041000
         BR    @14                                                 0531 02042000
*     END;                          /*                       @Y30LB12*/ 02043000
*   IF PARMBIT^='1'B                /* SET BY ICGDSS99       @Y30LB12*/ 02044000
*     THEN                          /*                       @Y30LB12*/ 02045000
@RC00525 TM    PARMBIT(R4),B'00100000'                             0533 02046000
         BO    @RF00533                                            0533 02047000
*     DO;                           /*                       @Y30LB12*/ 02048000
*                                                                  0534 02049000
*       /*************************************************************/ 02050000
*       /*                                                           */ 02051000
*       /* *****************************************         @Y30LB12*/ 02052000
*       /* ICG211I EXPECTED, BUT DID NOT FIND,               @Y30LB12*/ 02053000
*       /* PARAMETER                                         @Y30LB12*/ 02054000
*       /* *****************************************         @Y30LB12*/ 02055000
*       /*                                                           */ 02056000
*       /*************************************************************/ 02057000
*                                                                  0535 02058000
*       MSGNO=ICG211I;              /* ID FOR ICGDS211       @Y30LB12*/ 02059000
         MVC   MSGNO(2,R4),ICG211I                                 0535 02060000
*       CALL PUTIT2;                /* TO MESSAGE WRITER     @Y30LB12*/ 02061000
         BAL   @14,PUTIT2                                          0536 02062000
*       RETURN;                     /* RETURN TO S04VVS      @Y30LB12*/ 02063000
         B     @EL00017                                            0537 02064000
*     END;                          /*                       @Y30LB12*/ 02065000
*   ELSE                                                           0539 02066000
*     ;                             /*                       @Y30LB12*/ 02067000
@RF00533 DS    0H                                                  0540 02068000
*   WORKRSG='0000'X;                /* INITIALIZE TO 0       @Y30LB12*/ 02069000
         MVC   WORKRSG(2),@CB00665                                 0540 02070000
*   IF SCANLEN=1                    /* SET BY ICGDSS99       @Y30LB12*/ 02071000
*     THEN                          /*                       @Y30LB12*/ 02072000
         CLC   SCANLEN(2,R4),@CH00044                              0541 02073000
         BNE   @RF00541                                            0541 02074000
*     DO;                           /*                       @Y30LB12*/ 02075000
*       WORKRSG(1)='F0'X;           /*                       @Y30LB12*/ 02076000
         MVI   WORKRSG,X'F0'                                       0543 02077000
*       WORKRSG(2)=SCANDATA(1);     /*                       @Y30LB12*/ 02078000
         L     @07,STARTCOL(,R4)                                   0544 02079000
         MVC   WORKRSG+1(1),SCANDATA(@07)                          0544 02080000
*     END;                          /*                       @Y30LB12*/ 02081000
*   ELSE                            /*                       @Y30LB12*/ 02082000
*     IF SCANLEN=2                  /* SET BY ICGDSS99       @Y30LB12*/ 02083000
*       THEN                        /*                       @Y30LB12*/ 02084000
         B     @RC00541                                            0546 02085000
@RF00541 CLC   SCANLEN(2,R4),@CH00052                              0546 02086000
         BNE   @RF00546                                            0546 02087000
*       WORKRSG(1:2)=SCANDATA(1:2); /*                       @Y30LB12*/ 02088000
         L     @07,STARTCOL(,R4)                                   0547 02089000
         MVC   WORKRSG(2),SCANDATA(@07)                            0547 02090000
*     ELSE                                                         0548 02091000
*       ;                           /*                       @Y30LB12*/ 02092000
@RF00546 DS    0H                                                  0549 02093000
*   IF WORKRSG='0000'X              /*                       @Y30LB12*/ 02094000
*     THEN                          /*                       @Y30LB12*/ 02095000
@RC00541 CLC   WORKRSG(2),@CB00665                                 0549 02096000
         BNE   @RF00549                                            0549 02097000
*     DO;                           /*                       @Y30LB12*/ 02098000
*                                                                  0550 02099000
*       /*************************************************************/ 02100000
*       /*                                                           */ 02101000
*       /* *****************************************         @Y30LB12*/ 02102000
*       /* ICG220I INVALID PARAMETER LENGTH,                 @Y30LB12*/ 02103000
*       /* KEYWORD IS SDG                                    @Y30LB12*/ 02104000
*       /* *****************************************         @Y30LB12*/ 02105000
*       /*                                                           */ 02106000
*       /*************************************************************/ 02107000
*                                                                  0551 02108000
*       OUTBUF2(1:46)=ICGDS220;     /*                       @Y30LB12*/ 02109000
         MVC   OUTBUF2(46,R4),ICGDS220                             0551 02110000
*       OUTBUF2(47:49)='SDG';       /*                       @Y30LB12*/ 02111000
         MVC   OUTBUF2+46(3,R4),@CC00659                           0552 02112000
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/ 02113000
         BAL   @14,PUTIT1                                          0553 02114000
*     END;                          /*                       @Y30LB12*/ 02115000
*   ELSE                            /*                       @Y30LB12*/ 02116000
*     DO;                           /*                       @Y30LB12*/ 02117000
         B     @RC00549                                            0555 02118000
@RF00549 DS    0H                                                  0556 02119000
*       CALL CONVDEC;               /* TO CONVERT PARM       @Y30LB12*/ 02120000
         BAL   @14,CONVDEC                                         0556 02121000
*       IF WORKRSG>MAXRSG           /* MAXIMUM VALUE         @Y30LB12*/ 02122000
*         THEN                      /*                       @Y30LB12*/ 02123000
         MVC   @ZT00002+2(2),WORKRSG                               0557 02124000
         L     @07,@ZT00002                                        0557 02125000
         CH    @07,MAXRSG                                          0557 02126000
         BNH   @RF00557                                            0557 02127000
*         DO;                       /*                       @Y30LB12*/ 02128000
*                                                                  0558 02129000
*           /*********************************************************/ 02130000
*           /*                                                       */ 02131000
*           /* ***********************************           @Y30LB12*/ 02132000
*           /* ICG223I VALUE ERROR FOR SDG                   @Y30LB12*/ 02133000
*           /* ***********************************           @Y30LB12*/ 02134000
*           /*                                                       */ 02135000
*           /*********************************************************/ 02136000
*                                                                  0559 02137000
*           OUTBUF2(1:25)=ICGDS223; /*                       @Y30LB12*/ 02138000
         MVC   OUTBUF2(25,R4),ICGDS223                             0559 02139000
*           OUTBUF2(26:28)='SDG';   /*                       @Y30LB12*/ 02140000
         MVC   OUTBUF2+25(3,R4),@CC00659                           0560 02141000
*           CALL PUTIT1;            /* TO MESSAGE WRITER     @Y30LB12*/ 02142000
         BAL   @14,PUTIT1                                          0561 02143000
*         END;                      /*                       @Y30LB12*/ 02144000
*       ELSE                                                       0563 02145000
*         ;                         /*                       @Y30LB12*/ 02146000
@RF00557 DS    0H                                                  0564 02147000
*     END;                          /*                       @Y30LB12*/ 02148000
*   END S04RSG;                     /* RETURN TO S04VVS      @Y30LB12*/ 02149000
         B     @EL00017                                            0565 02150000
*                                                                  0566 02151000
*/********************************************************** @Y30LB12*/ 02152000
*/*                                                          @Y30LB12*/ 02153000
*/* PROCEDURE NAME - CONVDEC                                 @Y30LB12*/ 02154000
*/*                                                          @Y30LB12*/ 02155000
*/* FUNCTION - CONVERT DECIMAL NUMBER TO BINARY              @Y30LB12*/ 02156000
*/*                                                          @Y30LB12*/ 02157000
*/********************************************************** @Y30LB12*/ 02158000
*                                                                  0566 02159000
*CONVDEC:                                                          0566 02160000
*   PROCEDURE;                      /*                       @Y30LB12*/ 02161000
CONVDEC  STM   @14,@12,@SA00018                                    0566 02162000
*   IF HIGHRSG^='1111'B|LOWRSG^='1111'B/*                    @Y30LB12*/ 02163000
*     THEN                          /*                       @Y30LB12*/ 02164000
         TM    HIGHRSG,B'11110000'                                 0567 02165000
         BNO   @RT00567                                            0567 02166000
         TM    LOWRSG,B'11110000'                                  0567 02167000
         BO    @RF00567                                            0567 02168000
@RT00567 DS    0H                                                  0568 02169000
*     DO;                           /*                       @Y30LB12*/ 02170000
*                                                                  0568 02171000
*       /*************************************************************/ 02172000
*       /*                                                           */ 02173000
*       /* *****************************************         @Y30LB12*/ 02174000
*       /* ICG228I PARAMETER MUST BE NUMERIC,                @Y30LB12*/ 02175000
*       /* KEYWORD IS SDG                                    @Y30LB12*/ 02176000
*       /* *****************************************         @Y30LB12*/ 02177000
*       /*                                                           */ 02178000
*       /*************************************************************/ 02179000
*                                                                  0569 02180000
*       OUTBUF2(1:47)=ICGDS228;     /*                       @Y30LB12*/ 02181000
         MVC   OUTBUF2(47,R4),ICGDS228                             0569 02182000
*       OUTBUF2(48:50)='SDG';       /*                       @Y30LB12*/ 02183000
         MVC   OUTBUF2+47(3,R4),@CC00659                           0570 02184000
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/ 02185000
         BAL   @14,PUTIT1                                          0571 02186000
*     END;                          /*                       @Y30LB12*/ 02187000
*   ELSE                            /*                       @Y30LB12*/ 02188000
*     DO;                           /*                       @Y30LB12*/ 02189000
         B     @RC00567                                            0573 02190000
@RF00567 DS    0H                                                  0574 02191000
*       PACKWORK='0000000000000000'X;/*                      @Y30LB12*/ 02192000
         MVC   PACKWORK(8),@CB00671                                0574 02193000
*       GEN(PACK  PACKWORK+6(2),WORKRSG);/*                  @Y30LB12*/ 02194000
         PACK  PACKWORK+6(2),WORKRSG                                    02195000
*       GEN(CVB   R6,PACKWORK);     /*                       @Y30LB12*/ 02196000
         CVB   R6,PACKWORK                                              02197000
*       GEN(STH   R6,WORKRSG);      /*                       @Y30LB12*/ 02198000
         STH   R6,WORKRSG                                               02199000
*     END;                          /*                       @Y30LB12*/ 02200000
*   END CONVDEC;                    /* RETURN TO CALLER      @Y30LB12*/ 02201000
@EL00018 DS    0H                                                  0579 02202000
@EF00018 DS    0H                                                  0579 02203000
@ER00018 LM    @14,@12,@SA00018                                    0579 02204000
         BR    @14                                                 0579 02205000
*                                                                  0580 02206000
*/********************************************************** @Y30LB12*/ 02207000
*/*                                                          @Y30LB12*/ 02208000
*/* PROCEDURE NAME - CONVHEX2                                @Y30LB12*/ 02209000
*/*                                                          @Y30LB12*/ 02210000
*/* FUNCTION - CONVERT TWO HEX CHARACTERS TO BINARY          @Y30LB12*/ 02211000
*/*                                                          @Y30LB12*/ 02212000
*/********************************************************** @Y30LB12*/ 02213000
*                                                                  0580 02214000
*CONVHEX2:                                                         0580 02215000
*   PROCEDURE;                      /*                       @Y30LB12*/ 02216000
CONVHEX2 STM   @14,@12,12(@13)                                     0580 02217000
*   DO I=1 TO MAXDEV;               /* INDEX THRU TABLE      @Y30LB12*/ 02218000
         LA    I,1                                                 0581 02219000
         B     @DE00581                                            0581 02220000
@DL00581 DS    0H                                                  0582 02221000
*     IF PATTERN(I)=WORKHEX2        /* IF CHAR MATCH         @Y30LB12*/ 02222000
*       THEN                        /*                       @Y30LB12*/ 02223000
         LR    @07,I                                               0582 02224000
         ALR   @07,@07                                             0582 02225000
         LA    @05,PATTERN-2(@07)                                  0582 02226000
         CLC   0(2,@05),WORKHEX2                                   0582 02227000
         BNE   @RF00582                                            0582 02228000
*       DO;                         /*                       @Y30LB12*/ 02229000
*         WORKHEX2=I;               /* I IS BINARY EQUIV.    @YD00113*/ 02230000
         STH   I,WORKHEX2                                          0584 02231000
*         RETURN;                   /* RETURN TO CALLER      @Y30LB12*/ 02232000
@EL00019 DS    0H                                                  0585 02233000
@EF00019 DS    0H                                                  0585 02234000
@ER00019 LM    @14,@12,12(@13)                                     0585 02235000
         BR    @14                                                 0585 02236000
*       END;                        /*                       @Y30LB12*/ 02237000
*     ELSE                                                         0587 02238000
*       ;                           /*                       @Y30LB12*/ 02239000
@RF00582 DS    0H                                                  0588 02240000
*   END;                            /* NO MATCH IN 64        @Y30LB12*/ 02241000
         AH    I,@CH00044                                          0588 02242000
@DE00581 CH    I,MAXDEV                                            0588 02243000
         BNH   @DL00581                                            0588 02244000
*   END CONVHEX2;                   /* RETURN TO CALLER      @Y30LB12*/ 02245000
         B     @EL00019                                            0589 02246000
*                                                                  0590 02247000
*/********************************************************** @Y30LB12*/ 02248000
*/*                                                          @Y30LB12*/ 02249000
*/* PROCEDURE NAME - S04ADDR                                 @Y30LB12*/ 02250000
*/*                                                          @Y30LB12*/ 02251000
*/* FUNCTION - SCAN FROM 1 TO 64 UNIT ADDRESSES IN THE RANGE @Y30LB12*/ 02252000
*/*            00-3F.  AT END OF ADDRESSES WHEN LASTPARM=1   @Y30LB12*/ 02253000
*/*            OR WHEN ANOTHER KEYWORD IS READ.  SAVE IN     @Y30LB12*/ 02254000
*/*            TEMPORARY AREA WK1ADDR  UNTIL ALL SUBKEYWORDS @Y30LB12*/ 02255000
*/*            AND SUBPARAMETERS FOR THIS SUBGROUP HAVE      @Y30LB12*/ 02256000
*/*            BEEN READ.                                    @Y30LB12*/ 02257000
*/*                                                          @Y30LB12*/ 02258000
*/********************************************************** @Y30LB12*/ 02259000
*                                                                  0590 02260000
*S04ADDR:                                                          0590 02261000
*   PROCEDURE;                      /*                       @Y30LB12*/ 02262000
S04ADDR  STM   @14,@12,@SA00020                                    0590 02263000
*   KNOWN3='1'B;                    /* LOOP CONTROL FLAG     @Y30LB12*/ 02264000
         OI    KNOWN3,B'00100000'                                  0591 02265000
*   HAVEADDR='0'B;                  /* RESET ADDR FLAG       @Y30LB12*/ 02266000
         NI    HAVEADDR,B'11111110'                                0592 02267000
*   DO WHILE(KNOWN3='1'B);          /* FOR REC. KEYWORD      @Y30LB12*/ 02268000
         B     @DE00593                                            0593 02269000
@DL00593 DS    0H                                                  0594 02270000
*     SAVESCOL=STARTCOL;            /* TO RESCAN IF KEY      @Y30LB12*/ 02271000
         MVC   SAVESCOL(4,R4),STARTCOL(R4)                         0594 02272000
*     SAVENCOL=NEXTCOL;             /* TO RESCAN IF KEY      @Y30LB12*/ 02273000
         MVC   SAVENCOL(4,R4),NEXTCOL(R4)                          0595 02274000
*     CALL READS99;                 /* EXTRACT PARAMETER     @Y30LB12*/ 02275000
         BAL   @14,READS99                                         0596 02276000
*     IF PARMBIT='1'B               /* SET BY ICGDSS99       @Y30LB12*/ 02277000
*       THEN                        /*                       @Y30LB12*/ 02278000
         TM    PARMBIT(R4),B'00100000'                             0597 02279000
         BNO   @RF00597                                            0597 02280000
*       IF SCANLEN=2                /* SET BY ICGDSS99       @Y30LB12*/ 02281000
*         THEN                      /*                       @Y30LB12*/ 02282000
         CLC   SCANLEN(2,R4),@CH00052                              0598 02283000
         BNE   @RF00598                                            0598 02284000
*         DO;                       /*                       @Y30LB12*/ 02285000
*           HAVEADDR='1'B;          /* ADDRESS SPECIFIED     @Y30LB12*/ 02286000
         OI    HAVEADDR,B'00000001'                                0600 02287000
*           WORKHEX2=SCANDATA(1:2); /*                       @Y30LB12*/ 02288000
         L     @07,STARTCOL(,R4)                                   0601 02289000
         MVC   WORKHEX2(2),SCANDATA(@07)                           0601 02290000
*           CALL CONVHEX2;          /* FOR BINARY EQUIV.     @Y30LB12*/ 02291000
         BAL   @14,CONVHEX2                                        0602 02292000
*           WORKNUM=WORKHEX2;       /* SAVE VALUE RET'D      @Y30LB12*/ 02293000
         MVC   @ZT00002+2(2),WORKHEX2                              0603 02294000
         L     @07,@ZT00002                                        0603 02295000
         STH   @07,WORKNUM                                         0603 02296000
*           IF WORKNUM>0&WORKNUM<MAXDEV+1/*                  @Y30LB12*/ 02297000
*             THEN                  /*                       @Y30LB12*/ 02298000
         LTR   @07,@07                                             0604 02299000
         BNP   @RF00604                                            0604 02300000
         LA    @05,1                                               0604 02301000
         AH    @05,MAXDEV                                          0604 02302000
         CR    @07,@05                                             0604 02303000
         BNL   @RF00604                                            0604 02304000
*             IF ADR1SPEC(WORKNUM)^='1'B/*                   @YM31098*/ 02305000
*               THEN                /*                       @YM31098*/ 02306000
         MH    @07,@CH00257                                        0605 02307000
         LA    @05,ADR1SPEC-11(@07)                                0605 02308000
         TM    0(@05),B'10000000'                                  0605 02309000
         BO    @RF00605                                            0605 02310000
*               ADR1SPEC(WORKNUM)='1'B;/*                    @YM31098*/ 02311000
         LA    @05,ADR1SPEC-11(@07)                                0606 02312000
         OI    0(@05),B'10000000'                                  0606 02313000
*             ELSE                  /*                       @YM31098*/ 02314000
*               DO;                 /*                       @YM31098*/ 02315000
*                                                                  0607 02316000
         B     @RC00605                                            0607 02317000
@RF00605 DS    0H                                                  0608 02318000
*                 /***************************************************/ 02319000
*                 /*                                                 */ 02320000
*                 /* ***************************             @YM31098*/ 02321000
*                 /* ICG226I DUPLICATE                       @YM31098*/ 02322000
*                 /* SPECIFICATION FOR DEVICE                @YM31098*/ 02323000
*                 /* XX                                      @YM31098*/ 02324000
*                 /* ***************************             @YM31098*/ 02325000
*                 /*                                                 */ 02326000
*                 /***************************************************/ 02327000
*                                                                  0608 02328000
*                 OUTBUF2(1:44)=ICGDS226;/*                  @YM31098*/ 02329000
         MVC   OUTBUF2(44,R4),ICGDS226                             0608 02330000
*                 OUTBUF2(45:46)=PATTERN(WORKNUM);                 0609 02331000
         LH    @07,WORKNUM                                         0609 02332000
         ALR   @07,@07                                             0609 02333000
         LA    @05,PATTERN-2(@07)                                  0609 02334000
         MVC   OUTBUF2+44(2,R4),0(@05)                             0609 02335000
*                 CALL PUTIT1;      /*                       @YM31098*/ 02336000
         BAL   @14,PUTIT1                                          0610 02337000
*               END;                /*                       @YM31098*/ 02338000
*           ELSE                    /*                       @Y30LB12*/ 02339000
*             DO;                   /*                       @Y30LB12*/ 02340000
*                                                                  0612 02341000
         B     @RC00604                                            0612 02342000
@RF00604 DS    0H                                                  0613 02343000
*               /*****************************************************/ 02344000
*               /*                                                   */ 02345000
*               /* *******************************           @Y30LB12*/ 02346000
*               /* ICG223I VALUE ERROR FOR                   @Y30LB12*/ 02347000
*               /* (REAL/CONVREAL/                           @Y30LB12*/ 02348000
*               /* V, ADDR/VS, ADDR)                         @YM31098*/ 02349000
*               /* *******************************           @Y30LB12*/ 02350000
*               /*                                                   */ 02351000
*               /*****************************************************/ 02352000
*                                                                  0613 02353000
*               OUTBUF2(1:25)=ICGDS223;/*                    @Y30LB12*/ 02354000
         MVC   OUTBUF2(25,R4),ICGDS223                             0613 02355000
*               OUTBUF2(26:33)=PLUGIN;/*                     @Y30LB12*/ 02356000
         MVC   OUTBUF2+25(8,R4),PLUGIN                             0614 02357000
*               CALL PUTIT1;        /* TO MESSAGE WRITER     @Y30LB12*/ 02358000
         BAL   @14,PUTIT1                                          0615 02359000
*             END;                  /*                       @Y30LB12*/ 02360000
*         END;                      /*                       @Y30LB12*/ 02361000
*                                                                  0617 02362000
*     /***************************************************************/ 02363000
*     /*                                                             */ 02364000
*     /* *********************************************       @OZ09548*/ 02365000
*     /* CHECK FOR THE SPECIFICATION OF A RANGE OF           @OZ09548*/ 02366000
*     /* ADDRESSES (XX-YY)                                   @OZ09548*/ 02367000
*     /* *********************************************       @OZ09548*/ 02368000
*     /*                                                             */ 02369000
*     /***************************************************************/ 02370000
*                                                                  0618 02371000
*       ELSE                        /*                       @OZ09548*/ 02372000
*         IF SCANLEN=5              /*                       @OZ09548*/ 02373000
*           THEN                    /*                       @OZ09548*/ 02374000
         B     @RC00598                                            0618 02375000
@RF00598 CLC   SCANLEN(2,R4),@CH00121                              0618 02376000
         BNE   @RF00618                                            0618 02377000
*           DO;                     /*                       @OZ09548*/ 02378000
*             HAVEADDR='1'B;        /* ADDRESS SPECIFIED     @OZ09548*/ 02379000
         OI    HAVEADDR,B'00000001'                                0620 02380000
*             WORKHEX2=SCANDATA(1:2);/* LOW VALUE            @OZ09548*/ 02381000
         L     @07,STARTCOL(,R4)                                   0621 02382000
         MVC   WORKHEX2(2),SCANDATA(@07)                           0621 02383000
*             CALL CONVHEX2;        /* CONVERT TO BINARY     @OZ09548*/ 02384000
         BAL   @14,CONVHEX2                                        0622 02385000
*             WORKA=WORKHEX2;       /* SAVE LOW VALUE        @OZ09548*/ 02386000
         MVC   WORKA(2),WORKHEX2                                   0623 02387000
*             WORKHEX2=SCANDATA(4:5);/* HIGH VALUE           @OZ09548*/ 02388000
         L     @07,STARTCOL(,R4)                                   0624 02389000
         MVC   WORKHEX2(2),SCANDATA+3(@07)                         0624 02390000
*             CALL CONVHEX2;        /*                       @OZ09548*/ 02391000
         BAL   @14,CONVHEX2                                        0625 02392000
*             WORKB=WORKHEX2;       /* SAVE HIGH VALUE       @OZ09548*/ 02393000
*                                                                  0626 02394000
         MVC   WORKB(2),WORKHEX2                                   0626 02395000
*             /*******************************************************/ 02396000
*             /*                                                     */ 02397000
*             /* *************************************       @OZ09548*/ 02398000
*             /* TEST THE VALIDITY OF THE RANGE              @OZ09548*/ 02399000
*             /* SPECIFIED. VALIDITY TESTS ARE -             @OZ09548*/ 02400000
*             /* - LOW VALUE (WORKA) NOT NEGATIVE            @OZ09548*/ 02401000
*             /* - HIGH VALUE LESS THAN 65 (DEC.)            @OZ09548*/ 02402000
*             /* - LOW VALUE LESS THAN HIGH VALUE            @OZ09548*/ 02403000
*             /* - TWO VALUES SEPARATED BY DASH (-)          @OZ09548*/ 02404000
*             /* *************************************       @OZ09548*/ 02405000
*             /*                                                     */ 02406000
*             /*******************************************************/ 02407000
*                                                                  0627 02408000
*             IF WORKA>0            /*                       @OZ09548*/ 02409000
*                 &WORKB<MAXDEV+1   /*                       @OZ09548*/ 02410000
*                 &WORKA<WORKB      /*                       @OZ09548*/ 02411000
*                 &SCANDATA(3)='-'  /*                       @OZ09548*/ 02412000
*               THEN                /*                       @OZ09548*/ 02413000
*                                                                  0627 02414000
         MVC   @ZT00002+2(2),WORKA                                 0627 02415000
         L     @07,@ZT00002                                        0627 02416000
         LTR   @07,@07                                             0627 02417000
         BNP   @RF00627                                            0627 02418000
         LA    @05,1                                               0627 02419000
         AH    @05,MAXDEV                                          0627 02420000
         MVC   @ZT00002+2(2),WORKB                                 0627 02421000
         C     @05,@ZT00002                                        0627 02422000
         BNH   @RF00627                                            0627 02423000
         CLC   WORKA(2),WORKB                                      0627 02424000
         BNL   @RF00627                                            0627 02425000
         L     @05,STARTCOL(,R4)                                   0627 02426000
         CLI   SCANDATA+2(@05),C'-'                                0627 02427000
         BNE   @RF00627                                            0627 02428000
*               /*****************************************************/ 02429000
*               /*                                                   */ 02430000
*               /* *********************************         @OZ09548*/ 02431000
*               /* CHECK ALL VALUES WITHIN THE               @OZ09548*/ 02432000
*               /* RANGE FOR PREVIOUS USE. IF                @OZ09548*/ 02433000
*               /* NOT PREVIOUSLY USED, MARK AS              @OZ09548*/ 02434000
*               /* USED HERE                                 @OZ09548*/ 02435000
*               /* *********************************         @OZ09548*/ 02436000
*               /*                                                   */ 02437000
*               /*****************************************************/ 02438000
*                                                                  0628 02439000
*               DO I=WORKA TO WORKB;/*                       @OZ09548*/ 02440000
         LR    I,@07                                               0628 02441000
         B     @DE00628                                            0628 02442000
@DL00628 DS    0H                                                  0629 02443000
*                 IF ADR1SPEC(I)^='1'B/*                     @OZ09548*/ 02444000
*                   THEN            /*                       @OZ09548*/ 02445000
         LR    @07,I                                               0629 02446000
         MH    @07,@CH00257                                        0629 02447000
         LA    @05,ADR1SPEC-11(@07)                                0629 02448000
         TM    0(@05),B'10000000'                                  0629 02449000
         BO    @RF00629                                            0629 02450000
*                   ADR1SPEC(I)='1'B;/*                      @OZ09548*/ 02451000
         LA    @05,ADR1SPEC-11(@07)                                0630 02452000
         OI    0(@05),B'10000000'                                  0630 02453000
*                 ELSE              /*                       @OZ09548*/ 02454000
*                   DO;             /*                       @OZ09548*/ 02455000
*                                                                  0631 02456000
         B     @RC00629                                            0631 02457000
@RF00629 DS    0H                                                  0632 02458000
*                     /***********************************************/ 02459000
*                     /*                                             */ 02460000
*                     /* ***************************         @OZ09548*/ 02461000
*                     /* ICG226I DUPLICATE                   @OZ09548*/ 02462000
*                     /* SPECIFICATION FOR DEVICE            @OZ09548*/ 02463000
*                     /* XX                                  @OZ09548*/ 02464000
*                     /* ***************************         @OZ09548*/ 02465000
*                     /*                                             */ 02466000
*                     /***********************************************/ 02467000
*                                                                  0632 02468000
*                     OUTBUF2(1:44)=ICGDS226;/*              @OZ09548*/ 02469000
         MVC   OUTBUF2(44,R4),ICGDS226                             0632 02470000
*                     OUTBUF2(45:46)=PATTERN(I);/*           @OZ09548*/ 02471000
         LR    @07,I                                               0633 02472000
         ALR   @07,@07                                             0633 02473000
         LA    @05,PATTERN-2(@07)                                  0633 02474000
         MVC   OUTBUF2+44(2,R4),0(@05)                             0633 02475000
*                     CALL PUTIT1;  /*                       @OZ09548*/ 02476000
         BAL   @14,PUTIT1                                          0634 02477000
*                   END;            /* END OF DO LOOP        @OZ09548*/ 02478000
*               END;                /*                       @OZ09548*/ 02479000
@RC00629 AH    I,@CH00044                                          0636 02480000
@DE00628 MVC   @ZT00002+2(2),WORKB                                 0636 02481000
         C     I,@ZT00002                                          0636 02482000
         BNH   @DL00628                                            0636 02483000
*             ELSE                  /* BAD VALUE RETURNED    @OZ09548*/ 02484000
*               DO;                 /*                       @OZ09548*/ 02485000
*                                                                  0637 02486000
         B     @RC00627                                            0637 02487000
@RF00627 DS    0H                                                  0638 02488000
*                 /***************************************************/ 02489000
*                 /*                                                 */ 02490000
*                 /* *******************************         @OZ09548*/ 02491000
*                 /* ICG223I VALUE ERROR FOR                 @OZ09548*/ 02492000
*                 /* (REAL/CONVREAL/                         @OZ09548*/ 02493000
*                 /* V, ADDR/VS, ADDR)                       @OZ09548*/ 02494000
*                 /* *******************************         @OZ09548*/ 02495000
*                 /*                                                 */ 02496000
*                 /***************************************************/ 02497000
*                                                                  0638 02498000
*                 OUTBUF2(1:25)=ICGDS223;/*                  @OZ09548*/ 02499000
         MVC   OUTBUF2(25,R4),ICGDS223                             0638 02500000
*                 OUTBUF2(26:33)=PLUGIN;/*                   @OZ09548*/ 02501000
         MVC   OUTBUF2+25(8,R4),PLUGIN                             0639 02502000
*                 CALL PUTIT1;      /*                       @OZ09548*/ 02503000
         BAL   @14,PUTIT1                                          0640 02504000
*               END;                /*                       @OZ09548*/ 02505000
*           END;                    /*                       @OZ09548*/ 02506000
*         ELSE                      /*                       @OZ09548*/ 02507000
*           DO;                     /* SCANLEN NOT 2,5       @OZ09548*/ 02508000
         B     @RC00618                                            0643 02509000
@RF00618 DS    0H                                                  0644 02510000
*             HAVEADDR='1'B;        /* ADDRESS SPECIFIED     @OZ09548*/ 02511000
*                                                                  0644 02512000
         OI    HAVEADDR,B'00000001'                                0644 02513000
*             /*******************************************************/ 02514000
*             /*                                                     */ 02515000
*             /* *************************************       @Y30LB12*/ 02516000
*             /* ICG220I INVALID PARAMETER LENGTH            @Y30LB12*/ 02517000
*             /* KEYWORD IS (REAL/CONVREAL/                  @Y30LB12*/ 02518000
*             /* V, ADDR/VS, ADDR)                           @YM31098*/ 02519000
*             /* *************************************       @Y30LB12*/ 02520000
*             /*                                                     */ 02521000
*             /*******************************************************/ 02522000
*                                                                  0645 02523000
*             OUTBUF2(1:46)=ICGDS220;/*                      @Y30LB12*/ 02524000
         MVC   OUTBUF2(46,R4),ICGDS220                             0645 02525000
*             OUTBUF2(47:54)=PLUGIN;/*                       @Y30LB12*/ 02526000
         MVC   OUTBUF2+46(8,R4),PLUGIN                             0646 02527000
*             CALL PUTIT1;          /* TO MESSAGE WRITER     @Y30LB12*/ 02528000
         BAL   @14,PUTIT1                                          0647 02529000
*           END;                    /*                       @Y30LB12*/ 02530000
*     ELSE                          /* IF NOT PARAMETER      @Y30LB12*/ 02531000
*       DO;                         /*                       @Y30LB12*/ 02532000
         B     @RC00597                                            0649 02533000
@RF00597 DS    0H                                                  0650 02534000
*         STARTCOL=SAVESCOL;        /* RESTORE RESCAN        @Y30LB12*/ 02535000
         MVC   STARTCOL(4,R4),SAVESCOL(R4)                         0650 02536000
*         NEXTCOL=SAVENCOL;         /* RESTORE RESCAN        @Y30LB12*/ 02537000
         MVC   NEXTCOL(4,R4),SAVENCOL(R4)                          0651 02538000
*         KNOWN3='0'B;              /* END CONTROL LOOP      @Y30LB12*/ 02539000
         NI    KNOWN3,B'11011111'                                  0652 02540000
*         IF HAVEADDR='0'B          /* IF NO ADDR FOUND      @Y30LB12*/ 02541000
*           THEN                    /*                       @Y30LB12*/ 02542000
         TM    HAVEADDR,B'00000001'                                0653 02543000
         BNZ   @RF00653                                            0653 02544000
*           DO;                     /*                       @Y30LB12*/ 02545000
*                                                                  0654 02546000
*             /*******************************************************/ 02547000
*             /*                                                     */ 02548000
*             /* ***********************************         @Y30LB12*/ 02549000
*             /* ICG211I EXPECTED, BUT DID NOT FIND          @YM31090*/ 02550000
*             /* PARAMETER                                   @YM31090*/ 02551000
*             /* ***********************************         @Y30LB12*/ 02552000
*             /*                                                     */ 02553000
*             /*******************************************************/ 02554000
*                                                                  0655 02555000
*             MSGNO=ICG211I;        /*                       @YM31090*/ 02556000
         MVC   MSGNO(2,R4),ICG211I                                 0655 02557000
*             CALL PUTIT2;          /* TO MESSAGE WRITER     @YM31090*/ 02558000
         BAL   @14,PUTIT2                                          0656 02559000
*           END;                    /*                       @Y30LB12*/ 02560000
*         ELSE                                                     0658 02561000
*           ;                       /*                       @Y30LB12*/ 02562000
@RF00653 DS    0H                                                  0659 02563000
*         RETURN;                   /* RETURN TO CALLER      @Y30LB12*/ 02564000
@EL00020 DS    0H                                                  0659 02565000
@EF00020 DS    0H                                                  0659 02566000
@ER00020 LM    @14,@12,@SA00020                                    0659 02567000
         BR    @14                                                 0659 02568000
*       END;                        /*                       @Y30LB12*/ 02569000
*   END;                            /* OF DO WHILE LOOP      @Y30LB12*/ 02570000
@RC00597 DS    0H                                                  0661 02571000
@DE00593 TM    KNOWN3,B'00100000'                                  0661 02572000
         BO    @DL00593                                            0661 02573000
*   END S04ADDR;                    /* RETURN TO CALLER      @Y30LB12*/ 02574000
         B     @EL00020                                            0662 02575000
*                                                                  0663 02576000
*/********************************************************** @Y30LB12*/ 02577000
*/*                                                          @Y30LB12*/ 02578000
*/* PROCEDURE NAME - S04ALTP                                 @Y30LB12*/ 02579000
*/*                                                          @Y30LB12*/ 02580000
*/* FUNCTION - EXTRACT THE THREE REQUIRED SUBKEYWORDS THAT   @Y30LB12*/ 02581000
*/*           FOLLOW EACH ALTPATH KEYWORD AND CALL THE       @Y30LB12*/ 02582000
*/*           PROCEDURES THAT EXTRACT THE  PARAMETERS.       @Y30LB12*/ 02583000
*/*           UP TO THREE ALTERNATE PATHS CAN BE SPECIFIED   @Y30LB12*/ 02584000
*/*           IN VS1 OR ONE ALTERNATE PATH IN VS2            @Y30LB12*/ 02585000
*/*           TO EACH VIRTUAL AND SHARED VIRTUAL DEVICE      @Y30LB12*/ 02586000
*/*                                                          @Y30LB12*/ 02587000
*/********************************************************** @Y30LB12*/ 02588000
*                                                                  0663 02589000
*S04ALTP:                                                          0663 02590000
*   PROCEDURE;                      /*                       @Y30LB12*/ 02591000
S04ALTP  STM   @14,@12,@SA00021                                    0663 02592000
*   KNOWN3='0'B;                    /* CONTROL FLAG          @Y30LB12*/ 02593000
         NI    KNOWN3,B'11011111'                                  0664 02594000
*   ALTCOUNT=ALTCOUNT+1;            /* FOR THIS SUBGROUP     @Y30LB12*/ 02595000
         LA    @07,1                                               0665 02596000
         AH    @07,ALTCOUNT                                        0665 02597000
         STH   @07,ALTCOUNT                                        0665 02598000
*   IF ALTCOUNT>MAXALT              /* MAXIMUM PATHS VS2     @Y30LB12*/ 02599000
*     THEN                          /*                       @Y30LB12*/ 02600000
         CH    @07,MAXALT                                          0666 02601000
         BNH   @RF00666                                            0666 02602000
*     DO;                           /*                       @Y30LB12*/ 02603000
*                                                                  0667 02604000
*       /*************************************************************/ 02605000
*       /*                                                           */ 02606000
*       /* *****************************************         @Y30LB12*/ 02607000
*       /* ICG249I EXCEEDED SUPPORTED NUMBER OF              @Y30LB12*/ 02608000
*       /* OF ALTERNATE PATHS                                @Y30LB12*/ 02609000
*       /* *****************************************         @Y30LB12*/ 02610000
*       /*                                                           */ 02611000
*       /*************************************************************/ 02612000
*                                                                  0668 02613000
*       MSGNO=ICG249I;              /* IDENT FOR ICG249I     @Y30LB12*/ 02614000
         MVC   MSGNO(2,R4),ICG249I                                 0668 02615000
*       CALL PUTIT2;                /* TO MESSAGE WRITER     @Y30LB12*/ 02616000
         BAL   @14,PUTIT2                                          0669 02617000
*       RETURN;                     /* RETURN TO S04VVS      @Y30LB12*/ 02618000
@EL00021 DS    0H                                                  0670 02619000
@EF00021 DS    0H                                                  0670 02620000
@ER00021 LM    @14,@12,@SA00021                                    0670 02621000
         BR    @14                                                 0670 02622000
*     END;                          /*                       @Y30LB12*/ 02623000
*   ELSE                            /*                       @Y30LB12*/ 02624000
*     KNOWN3='1'B;                  /* SET FOR CONTROL       @Y30LB12*/ 02625000
@RF00666 OI    KNOWN3,B'00100000'                                  0672 02626000
*   DO I=1 TO 3;                    /*                       @Y30LB12*/ 02627000
         LA    I,1                                                 0673 02628000
@DL00673 DS    0H                                                  0674 02629000
*     KNOWN3='0'B;                  /* CONTROL SWITCH        @Y30LB12*/ 02630000
         NI    KNOWN3,B'11011111'                                  0674 02631000
*     SAVESCOL=STARTCOL;            /* START THIS SCAN       @Y30LB12*/ 02632000
         MVC   SAVESCOL(4,R4),STARTCOL(R4)                         0675 02633000
*     SAVENCOL=NEXTCOL;             /* START NEXT SCAN       @Y30LB12*/ 02634000
         MVC   SAVENCOL(4,R4),NEXTCOL(R4)                          0676 02635000
*     CALL READS99;                 /* EXTRACT KEYWORD       @Y30LB12*/ 02636000
*                                                                  0677 02637000
         BAL   @14,READS99                                         0677 02638000
*     /***************************************************************/ 02639000
*     /*                                                             */ 02640000
*     /* ***********************************************     @Y30LB12*/ 02641000
*     /* IF THE KEYWORD SCANNED WAS SA...                    @Y30LB12*/ 02642000
*     /* ***********************************************     @Y30LB12*/ 02643000
*     /*                                                             */ 02644000
*     /***************************************************************/ 02645000
*                                                                  0678 02646000
*     IF SCANDATA(1:3)='SA='        /*                       @Y30LB12*/ 02647000
*       THEN                        /*                       @Y30LB12*/ 02648000
         L     @07,STARTCOL(,R4)                                   0678 02649000
         CLC   SCANDATA(3,@07),@CC00554                            0678 02650000
         BNE   @RF00678                                            0678 02651000
*       DO;                         /*                       @Y30LB12*/ 02652000
*         KNOWN3='1'B;              /* RECOGNIZED KEYWD      @Y30LB12*/ 02653000
         OI    KNOWN3,B'00100000'                                  0680 02654000
*         CALL S04ADS;              /* TO GET PARAMETER      @Y30LB12*/ 02655000
         BAL   @14,S04ADS                                          0681 02656000
*       END;                        /*                       @Y30LB12*/ 02657000
*     ELSE                                                         0683 02658000
*       ;                           /*                       @Y30LB12*/ 02659000
*                                                                  0683 02660000
@RF00678 DS    0H                                                  0684 02661000
*     /***************************************************************/ 02662000
*     /*                                                             */ 02663000
*     /* ***********************************************     @Y30LB12*/ 02664000
*     /* IF THE KEYWORD SCANNED WAS CH...                    @Y30LB12*/ 02665000
*     /* ***********************************************     @Y30LB12*/ 02666000
*     /*                                                             */ 02667000
*     /***************************************************************/ 02668000
*                                                                  0684 02669000
*     IF SCANDATA(1:3)='CH='        /*                       @Y30LB12*/ 02670000
*       THEN                        /*                       @Y30LB12*/ 02671000
         L     @07,STARTCOL(,R4)                                   0684 02672000
         CLC   SCANDATA(3,@07),@CC00558                            0684 02673000
         BNE   @RF00684                                            0684 02674000
*       DO;                         /*                       @Y30LB12*/ 02675000
*         KNOWN3='1'B;              /* RECOGNIZED KEYWD      @Y30LB12*/ 02676000
         OI    KNOWN3,B'00100000'                                  0686 02677000
*         CALL S04ACH;              /* TO GET PARAMETER      @Y30LB12*/ 02678000
         BAL   @14,S04ACH                                          0687 02679000
*       END;                        /*                       @Y30LB12*/ 02680000
*     ELSE                                                         0689 02681000
*       ;                           /*                       @Y30LB12*/ 02682000
*                                                                  0689 02683000
@RF00684 DS    0H                                                  0690 02684000
*     /***************************************************************/ 02685000
*     /*                                                             */ 02686000
*     /* ***********************************************     @Y30LB12*/ 02687000
*     /* IF THE KEYWORD SCANNED WAS CI...                    @Y30LB12*/ 02688000
*     /* ***********************************************     @Y30LB12*/ 02689000
*     /*                                                             */ 02690000
*     /***************************************************************/ 02691000
*                                                                  0690 02692000
*     IF SCANDATA(1:3)='CI='        /*                       @Y30LB12*/ 02693000
*       THEN                        /*                       @Y30LB12*/ 02694000
         L     @07,STARTCOL(,R4)                                   0690 02695000
         CLC   SCANDATA(3,@07),@CC00556                            0690 02696000
         BNE   @RF00690                                            0690 02697000
*       DO;                         /*                       @Y30LB12*/ 02698000
*         KNOWN3='1'B;              /* RECOGNIZED KEYWD      @Y30LB12*/ 02699000
         OI    KNOWN3,B'00100000'                                  0692 02700000
*         CALL S04ACI;              /* TO GET PARAMETER      @Y30LB12*/ 02701000
         BAL   @14,S04ACI                                          0693 02702000
*       END;                        /*                       @Y30LB12*/ 02703000
*     ELSE                                                         0695 02704000
*       ;                           /*                       @Y30LB12*/ 02705000
@RF00690 DS    0H                                                  0696 02706000
*     IF KNOWN3='0'B                /* DIFFERENT KEYWORD     @Y30LB12*/ 02707000
*       THEN                        /*                       @Y30LB12*/ 02708000
         TM    KNOWN3,B'00100000'                                  0696 02709000
         BNZ   @RF00696                                            0696 02710000
*       DO;                         /*                       @Y30LB12*/ 02711000
*         CALL CHKALTP;             /* MISSING KEYWORDS      @Y30LB12*/ 02712000
         BAL   @14,CHKALTP                                         0698 02713000
*         STARTCOL=SAVESCOL;        /* START THIS SCAN       @Y30LB12*/ 02714000
         MVC   STARTCOL(4,R4),SAVESCOL(R4)                         0699 02715000
*         NEXTCOL=SAVENCOL;         /* START NEXT SCAN       @Y30LB12*/ 02716000
         MVC   NEXTCOL(4,R4),SAVENCOL(R4)                          0700 02717000
*         RETURN;                   /*                       @Y30LB12*/ 02718000
         B     @EL00021                                            0701 02719000
*       END;                        /*                       @Y30LB12*/ 02720000
*     ELSE                                                         0703 02721000
*       ;                           /*                       @Y30LB12*/ 02722000
@RF00696 DS    0H                                                  0704 02723000
*     IF LASTPARM='1'B              /*                       @Y30LB12*/ 02724000
*       THEN                        /*                       @Y30LB12*/ 02725000
         TM    LASTPARM(R4),B'00001000'                            0704 02726000
         BO    @RT00704                                            0704 02727000
*       RETURN;                     /*                       @Y30LB12*/ 02728000
*     ELSE                                                         0706 02729000
*       ;                           /*                       @Y30LB12*/ 02730000
*   END;                            /* END OF DO             @Y30LB12*/ 02731000
         AH    I,@CH00044                                          0707 02732000
         CH    I,@CH00050                                          0707 02733000
         BNH   @DL00673                                            0707 02734000
*   END S04ALTP;                    /* RETURN TO S04VVS      @Y30LB12*/ 02735000
         B     @EL00021                                            0708 02736000
*                                                                  0709 02737000
*/********************************************************** @Y30LB12*/ 02738000
*/*                                                          @Y30LB12*/ 02739000
*/* PROCEDURE NAME - S04ADS                                  @Y30LB12*/ 02740000
*/*                                                          @Y30LB12*/ 02741000
*/* FUNCTION - EXTRACT THE DATA STAGER THROUGH WHICH THE     @Y30LB12*/ 02742000
*/*            ALTERNATE CHANNEL FOR THIS GROUP OF VIRTUAL   @Y30LB12*/ 02743000
*/*            OR SHARED VIRTUAL ADDRESSES INTERFACES.       @Y30LB12*/ 02744000
*/*            THE ALTERNATE DATA STAGER MUST ATTACH TO THE  @Y30LB12*/ 02745000
*/*            SAME REAL SPINDLE GROUP AS THE PRIMARY DATA   @Y30LB12*/ 02746000
*/*            STAGER.  THE ALTERNATE DATA STAGER CAN BE THE @Y30LB12*/ 02747000
*/*            SAME DATA STAGER AS THE PRIMARY.              @Y30LB12*/ 02748000
*/*                                                          @Y30LB12*/ 02749000
*/********************************************************** @Y30LB12*/ 02750000
*                                                                  0709 02751000
*S04ADS:                                                           0709 02752000
*   PROCEDURE;                      /*                       @Y30LB12*/ 02753000
S04ADS   STM   @14,@12,@SA00022                                    0709 02754000
*   CALL READS99;                   /* EXTRACT PARAMETER     @Y30LB12*/ 02755000
         BAL   @14,READS99                                         0710 02756000
*   IF HAVEADS(ALTCOUNT)^='1'B      /*                       @Y30LB12*/ 02757000
*     THEN                          /*                       @Y30LB12*/ 02758000
         LH    @07,ALTCOUNT                                        0711 02759000
         SLA   @07,2                                               0711 02760000
         LA    @05,HAVEADS-4(@07)                                  0711 02761000
         TM    0(@05),B'00100000'                                  0711 02762000
         BO    @RF00711                                            0711 02763000
*     HAVEADS(ALTCOUNT)='1'B;       /*                       @Y30LB12*/ 02764000
         LA    @05,HAVEADS-4(@07)                                  0712 02765000
         OI    0(@05),B'00100000'                                  0712 02766000
*   ELSE                            /*                       @Y30LB12*/ 02767000
*     DO;                           /*                       @Y30LB12*/ 02768000
*                                                                  0713 02769000
         B     @RC00711                                            0713 02770000
@RF00711 DS    0H                                                  0714 02771000
*       /*************************************************************/ 02772000
*       /*                                                           */ 02773000
*       /* *****************************************         @Y30LB12*/ 02774000
*       /* 'ICG219I DUPLICATE KEYWORD SA (ALTPATH)           @Y30LB12*/ 02775000
*       /* *****************************************         @Y30LB12*/ 02776000
*       /*                                                           */ 02777000
*       /*************************************************************/ 02778000
*                                                                  0714 02779000
*       OUTBUF2(1:27)=ICGDS219;     /*                       @Y30LB12*/ 02780000
         MVC   OUTBUF2(27,R4),ICGDS219                             0714 02781000
*       OUTBUF2(28:39)='SA (ALTPATH)';/*                     @Y30LB12*/ 02782000
         MVC   OUTBUF2+27(12,R4),@CC00693                          0715 02783000
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/ 02784000
         BAL   @14,PUTIT1                                          0716 02785000
*       RETURN;                     /* RETURN TO S04ALTP     @Y30LB12*/ 02786000
@EL00022 DS    0H                                                  0717 02787000
@EF00022 DS    0H                                                  0717 02788000
@ER00022 LM    @14,@12,@SA00022                                    0717 02789000
         BR    @14                                                 0717 02790000
*     END;                          /*                       @Y30LB12*/ 02791000
*   IF PARMBIT^='1'B                /* SET BY ICGDSS99       @Y30LB12*/ 02792000
*     THEN                          /*                       @Y30LB12*/ 02793000
@RC00711 TM    PARMBIT(R4),B'00100000'                             0719 02794000
         BO    @RF00719                                            0719 02795000
*     DO;                           /*                       @Y30LB12*/ 02796000
*                                                                  0720 02797000
*       /*************************************************************/ 02798000
*       /*                                                           */ 02799000
*       /* *****************************************         @Y30LB12*/ 02800000
*       /* ICG211I EXPECTED, BUT DID NOT FIND,               @Y30LB12*/ 02801000
*       /* PARAMETER                                         @Y30LB12*/ 02802000
*       /* *****************************************         @Y30LB12*/ 02803000
*       /*                                                           */ 02804000
*       /*************************************************************/ 02805000
*                                                                  0721 02806000
*       MSGNO=ICG211I;              /* ID FOR ICGDS211       @Y30LB12*/ 02807000
         MVC   MSGNO(2,R4),ICG211I                                 0721 02808000
*       CALL PUTIT2;                /* TO MESSAGE WRITER     @Y30LB12*/ 02809000
         BAL   @14,PUTIT2                                          0722 02810000
*       RETURN;                     /* RETURN TO S04ALTP     @Y30LB12*/ 02811000
         B     @EL00022                                            0723 02812000
*     END;                          /*                       @Y30LB12*/ 02813000
*   ELSE                                                           0725 02814000
*     ;                             /*                       @Y30LB12*/ 02815000
@RF00719 DS    0H                                                  0726 02816000
*   IF SCANLEN^=1                   /* SET BY ICGDSS99       @Y30LB12*/ 02817000
*     THEN                          /*                       @Y30LB12*/ 02818000
         CLC   SCANLEN(2,R4),@CH00044                              0726 02819000
         BE    @RF00726                                            0726 02820000
*     DO;                           /*                       @Y30LB12*/ 02821000
*                                                                  0727 02822000
*       /*************************************************************/ 02823000
*       /*                                                           */ 02824000
*       /* *****************************************         @Y30LB12*/ 02825000
*       /* 'ICG220I INVALID PARAMETER LENGTH,                @Y30LB12*/ 02826000
*       /* KEYWORD IS SA (ALTPATH)'                          @Y30LB12*/ 02827000
*       /* *****************************************         @Y30LB12*/ 02828000
*       /*                                                           */ 02829000
*       /*************************************************************/ 02830000
*                                                                  0728 02831000
*       OUTBUF2(1:46)=ICGDS220;     /*                       @Y30LB12*/ 02832000
         MVC   OUTBUF2(46,R4),ICGDS220                             0728 02833000
*       OUTBUF2(47:58)='SA (ALTPATH)';/*                     @Y30LB12*/ 02834000
         MVC   OUTBUF2+46(12,R4),@CC00693                          0729 02835000
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/ 02836000
         BAL   @14,PUTIT1                                          0730 02837000
*       RETURN;                     /* RETURN TO S04ALTP     @Y30LB12*/ 02838000
         B     @EL00022                                            0731 02839000
*     END;                          /*                       @Y30LB12*/ 02840000
*   ELSE                                                           0733 02841000
*     ;                             /*                       @Y30LB12*/ 02842000
@RF00726 DS    0H                                                  0734 02843000
*   HEXCHAR=SCANDATA(1);            /* PASS CHARACTER        @Y30LB12*/ 02844000
         L     @07,STARTCOL(,R4)                                   0734 02845000
         MVC   HEXCHAR(1),SCANDATA(@07)                            0734 02846000
*   PLUGIN2='SA (ALT)';             /* FOR MESSAGE TEXT      @YM31098*/ 02847000
         MVC   PLUGIN2(8),@CC00696                                 0735 02848000
*   CALL CONVHEX;                   /* TO CONVERT CHAR       @Y30LB12*/ 02849000
         BAL   @14,CONVHEX                                         0736 02850000
*   IF HEXINDEX^=0                  /* IF SUCCESSFUL         @Y30LB12*/ 02851000
*     THEN                          /*                       @Y30LB12*/ 02852000
         LH    @07,HEXINDEX                                        0737 02853000
         LTR   @07,@07                                             0737 02854000
         BZ    @RF00737                                            0737 02855000
*     DO;                           /*                       @Y30LB12*/ 02856000
*       HEXINDEX=HEXINDEX-1;        /*                       @Y30LB12*/ 02857000
         BCTR  @07,0                                               0739 02858000
         STH   @07,HEXINDEX                                        0739 02859000
*       WORKADS(ALTCOUNT)=HEXINDEX; /* STORE CHAR            @Y30LB12*/ 02860000
         LH    @05,ALTCOUNT                                        0740 02861000
         SLA   @05,2                                               0740 02862000
         STC   @07,WORKADS-4(@05)                                  0740 02863000
*     END;                          /*                       @Y30LB12*/ 02864000
*   ELSE                                                           0742 02865000
*     ;                             /*                       @Y30LB12*/ 02866000
@RF00737 DS    0H                                                  0743 02867000
*   END S04ADS;                     /* RETURN TO S04ALTP     @Y30LB12*/ 02868000
         B     @EL00022                                            0743 02869000
*                                                                  0744 02870000
*/********************************************************** @Y30LB12*/ 02871000
*/*                                                          @Y30LB12*/ 02872000
*/* PROCEDURE NAME - S04ACH                                  @Y30LB12*/ 02873000
*/*                                                          @Y30LB12*/ 02874000
*/* FUNCTION - EXTRACT CHANNEL NUMBER OF ALTERNATE CHANNEL   @Y30LB12*/ 02875000
*/*            FOR THIS GROUP OF VIRTUAL OR VIRTUAL SHARED   @Y30LB12*/ 02876000
*/*            ADDRESSES.   CHANNEL IS THE CHARACTER         @Y30LB12*/ 02877000
*/*            REPRESENTATION OF A SINGLE HEXADECIMAL DIGIT. @Y30LB12*/ 02878000
*/*            UP TO THREE ALTERNATE PATHS CAN BE SPECIFIED  @Y30LB12*/ 02879000
*/*            IN VS1.  ONLY ONE ALTERNATE PATH CAN BE       @Y30LB12*/ 02880000
*/*            SPECIFIED IN VS2.  THE NUMBER OF THE          @Y30LB12*/ 02881000
*/*            ALTERNATE CHANNEL MUST BE HIGHER THAN THAT OF @Y30LB12*/ 02882000
*/*            THE PRIMARY CHANNEL.  (TEST FOR THIS IS MADE  @Y30LB12*/ 02883000
*/*            IN ICGDSA05.)                                 @Y30LB12*/ 02884000
*/*                                                          @Y30LB12*/ 02885000
*/********************************************************** @Y30LB12*/ 02886000
*                                                                  0744 02887000
*S04ACH:                                                           0744 02888000
*   PROCEDURE;                      /*                       @Y30LB12*/ 02889000
S04ACH   STM   @14,@12,@SA00023                                    0744 02890000
*   CALL READS99;                   /* EXTRACT PARAMETER     @Y30LB12*/ 02891000
         BAL   @14,READS99                                         0745 02892000
*   IF HAVEACH(ALTCOUNT)^='1'B      /*                       @Y30LB12*/ 02893000
*     THEN                          /*                       @Y30LB12*/ 02894000
         LH    @07,ALTCOUNT                                        0746 02895000
         SLA   @07,2                                               0746 02896000
         LA    @05,HAVEACH-4(@07)                                  0746 02897000
         TM    0(@05),B'10000000'                                  0746 02898000
         BO    @RF00746                                            0746 02899000
*     HAVEACH(ALTCOUNT)='1'B;       /*                       @Y30LB12*/ 02900000
         LA    @05,HAVEACH-4(@07)                                  0747 02901000
         OI    0(@05),B'10000000'                                  0747 02902000
*   ELSE                            /*                       @Y30LB12*/ 02903000
*     DO;                           /*                       @Y30LB12*/ 02904000
*                                                                  0748 02905000
         B     @RC00746                                            0748 02906000
@RF00746 DS    0H                                                  0749 02907000
*       /*************************************************************/ 02908000
*       /*                                                           */ 02909000
*       /* *****************************************         @Y30LB12*/ 02910000
*       /* 'ICG219I DUPLICATE KEYWORD CH (ALTPATH)'          @Y30LB12*/ 02911000
*       /* *****************************************         @Y30LB12*/ 02912000
*       /*                                                           */ 02913000
*       /*************************************************************/ 02914000
*                                                                  0749 02915000
*       OUTBUF2(1:27)=ICGDS219;     /*                       @Y30LB12*/ 02916000
         MVC   OUTBUF2(27,R4),ICGDS219                             0749 02917000
*       OUTBUF2(28:39)='CH (ALTPATH)';/*                     @Y30LB12*/ 02918000
         MVC   OUTBUF2+27(12,R4),@CC00700                          0750 02919000
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/ 02920000
         BAL   @14,PUTIT1                                          0751 02921000
*       RETURN;                     /* RETURN TO S04ALTP     @Y30LB12*/ 02922000
@EL00023 DS    0H                                                  0752 02923000
@EF00023 DS    0H                                                  0752 02924000
@ER00023 LM    @14,@12,@SA00023                                    0752 02925000
         BR    @14                                                 0752 02926000
*     END;                          /*                       @Y30LB12*/ 02927000
*   IF PARMBIT^='1'B                /* SET BY ICGDSS99       @Y30LB12*/ 02928000
*     THEN                          /*                       @Y30LB12*/ 02929000
@RC00746 TM    PARMBIT(R4),B'00100000'                             0754 02930000
         BO    @RF00754                                            0754 02931000
*     DO;                           /*                       @Y30LB12*/ 02932000
*                                                                  0755 02933000
*       /*************************************************************/ 02934000
*       /*                                                           */ 02935000
*       /* *****************************************         @Y30LB12*/ 02936000
*       /* ICG211I EXPECTED, BUT DID NOT FIND,               @Y30LB12*/ 02937000
*       /* PARAMETER                                         @Y30LB12*/ 02938000
*       /* *****************************************         @Y30LB12*/ 02939000
*       /*                                                           */ 02940000
*       /*************************************************************/ 02941000
*                                                                  0756 02942000
*       MSGNO=ICG211I;              /* ID FOR ICGDS211       @Y30LB12*/ 02943000
         MVC   MSGNO(2,R4),ICG211I                                 0756 02944000
*       CALL PUTIT2;                /* TO MESSAGE WRITER     @Y30LB12*/ 02945000
         BAL   @14,PUTIT2                                          0757 02946000
*       RETURN;                     /* RETURN TO S04ALTP     @Y30LB12*/ 02947000
         B     @EL00023                                            0758 02948000
*     END;                          /*                       @Y30LB12*/ 02949000
*   ELSE                                                           0760 02950000
*     ;                             /*                       @Y30LB12*/ 02951000
@RF00754 DS    0H                                                  0761 02952000
*   IF SCANLEN^=1                   /* SET BY ICGDSS99       @Y30LB12*/ 02953000
*     THEN                          /*                       @Y30LB12*/ 02954000
         CLC   SCANLEN(2,R4),@CH00044                              0761 02955000
         BE    @RF00761                                            0761 02956000
*     DO;                           /*                       @Y30LB12*/ 02957000
*                                                                  0762 02958000
*       /*************************************************************/ 02959000
*       /*                                                           */ 02960000
*       /* *****************************************         @Y30LB12*/ 02961000
*       /* 'ICG220I INVALID PARAMETER LENGTH,                @Y30LB12*/ 02962000
*       /* KEYWORD IS CH (ALTPATH)'                          @Y30LB12*/ 02963000
*       /* *****************************************         @Y30LB12*/ 02964000
*       /*                                                           */ 02965000
*       /*************************************************************/ 02966000
*                                                                  0763 02967000
*       OUTBUF2(1:46)=ICGDS220;     /*                       @Y30LB12*/ 02968000
         MVC   OUTBUF2(46,R4),ICGDS220                             0763 02969000
*       OUTBUF2(47:58)='CH (ALTPATH)';/*                     @Y30LB12*/ 02970000
         MVC   OUTBUF2+46(12,R4),@CC00700                          0764 02971000
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/ 02972000
         BAL   @14,PUTIT1                                          0765 02973000
*       RETURN;                     /* RETURN TO S04ALTP     @Y30LB12*/ 02974000
         B     @EL00023                                            0766 02975000
*     END;                          /*                       @Y30LB12*/ 02976000
*   ELSE                                                           0768 02977000
*     ;                             /*                       @Y30LB12*/ 02978000
@RF00761 DS    0H                                                  0769 02979000
*   HEXCHAR=SCANDATA(1);            /* CHAR TO BE PASSED     @Y30LB12*/ 02980000
         L     @07,STARTCOL(,R4)                                   0769 02981000
         MVC   HEXCHAR(1),SCANDATA(@07)                            0769 02982000
*   PLUGIN2='CH (ALT)';             /* FOR MESSAGE TEXT      @YM31098*/ 02983000
         MVC   PLUGIN2(8),@CC00702                                 0770 02984000
*   CALL CONVHEX;                   /* TO CONVERT CHAR       @Y30LB12*/ 02985000
         BAL   @14,CONVHEX                                         0771 02986000
*   IF HEXCHAR^=0                   /* IF SUCCESSFUL         @Y30LB12*/ 02987000
*     THEN                          /*                       @Y30LB12*/ 02988000
         CLI   HEXCHAR,0                                           0772 02989000
         BE    @RF00772                                            0772 02990000
*     WORKACH(ALTCOUNT)=HEXCHAR;    /* STORE CHANNEL         @Y30LB12*/ 02991000
         LH    @07,ALTCOUNT                                        0773 02992000
         SLA   @07,2                                               0773 02993000
         LA    @05,WORKACH-4(@07)                                  0773 02994000
         MVC   @TS00001(1),HEXCHAR                                 0773 02995000
         MVC   0(1,@05),@TS00001                                   0773 02996000
*   ELSE                            /*                       @Y30LB12*/ 02997000
*     DO;                           /*                       @Y30LB12*/ 02998000
*                                                                  0774 02999000
         B     @RC00772                                            0774 03000000
@RF00772 DS    0H                                                  0775 03001000
*       /*************************************************************/ 03002000
*       /*                                                           */ 03003000
*       /* *****************************************         @Y30LB12*/ 03004000
*       /* ICG223I VALUE ERROR FOR CH (ALTPATH)              @Y30LB12*/ 03005000
*       /* *****************************************         @Y30LB12*/ 03006000
*       /*                                                           */ 03007000
*       /*************************************************************/ 03008000
*                                                                  0775 03009000
*       OUTBUF2(1:25)=ICGDS223;     /*                       @Y30LB12*/ 03010000
         MVC   OUTBUF2(25,R4),ICGDS223                             0775 03011000
*       OUTBUF2(26:37)='CH (ALTPATH)';/*                     @Y30LB12*/ 03012000
         MVC   OUTBUF2+25(12,R4),@CC00700                          0776 03013000
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/ 03014000
         BAL   @14,PUTIT1                                          0777 03015000
*     END;                          /*                       @Y30LB12*/ 03016000
*   END S04ACH;                     /* RETURN TO S04ALTP     @Y30LB12*/ 03017000
         B     @EL00023                                            0779 03018000
*                                                                  0780 03019000
*/********************************************************** @Y30LB12*/ 03020000
*/*                                                          @Y30LB12*/ 03021000
*/* PROCEDURE NAME - S04ACI                                  @Y30LB12*/ 03022000
*/*                                                          @Y30LB12*/ 03023000
*/* FUNCTION - HANDLE THE CHANNEL INTERFACE DESIGNATION FOR  @Y30LB12*/ 03024000
*/*            THE ALTERNATE CHANNEL.  THE CONTROL UNIT      @Y30LB12*/ 03025000
*/*            ADDRESS OF THIS CHANNEL INTERFACE MUST BE     @Y30LB12*/ 03026000
*/*            IDENTICAL TO THAT OF THE PRIMARY CONTROL UNIT @Y30LB12*/ 03027000
*/*                                                          @Y30LB12*/ 03028000
*/********************************************************** @Y30LB12*/ 03029000
*                                                                  0780 03030000
*S04ACI:                                                           0780 03031000
*   PROCEDURE;                      /*                       @Y30LB12*/ 03032000
S04ACI   STM   @14,@12,@SA00024                                    0780 03033000
*   CALL READS99;                   /* EXTRACT PARAMETER     @Y30LB12*/ 03034000
         BAL   @14,READS99                                         0781 03035000
*   IF HAVEACI(ALTCOUNT)^='1'B      /*                       @Y30LB12*/ 03036000
*     THEN                          /*                       @Y30LB12*/ 03037000
         LH    @07,ALTCOUNT                                        0782 03038000
         SLA   @07,2                                               0782 03039000
         LA    @05,HAVEACI-4(@07)                                  0782 03040000
         TM    0(@05),B'01000000'                                  0782 03041000
         BO    @RF00782                                            0782 03042000
*     HAVEACI(ALTCOUNT)='1'B;       /*                       @Y30LB12*/ 03043000
         LA    @05,HAVEACI-4(@07)                                  0783 03044000
         OI    0(@05),B'01000000'                                  0783 03045000
*   ELSE                            /*                       @Y30LB12*/ 03046000
*     DO;                           /*                       @Y30LB12*/ 03047000
*                                                                  0784 03048000
         B     @RC00782                                            0784 03049000
@RF00782 DS    0H                                                  0785 03050000
*       /*************************************************************/ 03051000
*       /*                                                           */ 03052000
*       /* *****************************************         @Y30LB12*/ 03053000
*       /* ICG219I DUPLICATE KEYWORD CI (ALTPATH)            @Y30LB12*/ 03054000
*       /* *****************************************         @Y30LB12*/ 03055000
*       /*                                                           */ 03056000
*       /*************************************************************/ 03057000
*                                                                  0785 03058000
*       OUTBUF2(1:27)=ICGDS219;     /*                       @Y30LB12*/ 03059000
         MVC   OUTBUF2(27,R4),ICGDS219                             0785 03060000
*       OUTBUF2(28:39)='CI (ALTPATH)';/*                     @Y30LB12*/ 03061000
         MVC   OUTBUF2+27(12,R4),@CC00706                          0786 03062000
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/ 03063000
         BAL   @14,PUTIT1                                          0787 03064000
*       RETURN;                     /* RETURN TO S04ALTP     @Y30LB12*/ 03065000
@EL00024 DS    0H                                                  0788 03066000
@EF00024 DS    0H                                                  0788 03067000
@ER00024 LM    @14,@12,@SA00024                                    0788 03068000
         BR    @14                                                 0788 03069000
*     END;                          /*                       @Y30LB12*/ 03070000
*   IF PARMBIT^='1'B                /* SET BY ICGDSS99       @Y30LB12*/ 03071000
*     THEN                          /*                       @Y30LB12*/ 03072000
@RC00782 TM    PARMBIT(R4),B'00100000'                             0790 03073000
         BO    @RF00790                                            0790 03074000
*     DO;                           /*                       @Y30LB12*/ 03075000
*                                                                  0791 03076000
*       /*************************************************************/ 03077000
*       /*                                                           */ 03078000
*       /* *****************************************         @Y30LB12*/ 03079000
*       /* ICG211I EXPECTED, BUT DID NOT FIND,               @Y30LB12*/ 03080000
*       /* PARAMETER                                         @Y30LB12*/ 03081000
*       /* *****************************************         @Y30LB12*/ 03082000
*       /*                                                           */ 03083000
*       /*************************************************************/ 03084000
*                                                                  0792 03085000
*       MSGNO=ICG211I;              /* ID FOR ICGDS211       @Y30LB12*/ 03086000
         MVC   MSGNO(2,R4),ICG211I                                 0792 03087000
*       CALL PUTIT2;                /* TO MESSAGE WRITER     @Y30LB12*/ 03088000
         BAL   @14,PUTIT2                                          0793 03089000
*       RETURN;                     /* RETURN TO S04ALTP     @Y30LB12*/ 03090000
         B     @EL00024                                            0794 03091000
*     END;                          /*                       @Y30LB12*/ 03092000
*   ELSE                                                           0796 03093000
*     ;                             /*                       @Y30LB12*/ 03094000
@RF00790 DS    0H                                                  0797 03095000
*   IF SCANLEN^=1                   /* SET BY ICGDSS99       @Y30LB12*/ 03096000
*     THEN                          /*                       @Y30LB12*/ 03097000
         CLC   SCANLEN(2,R4),@CH00044                              0797 03098000
         BE    @RF00797                                            0797 03099000
*     DO;                           /*                       @Y30LB12*/ 03100000
*                                                                  0798 03101000
*       /*************************************************************/ 03102000
*       /*                                                           */ 03103000
*       /* *****************************************         @Y30LB12*/ 03104000
*       /* 'ICG220I INVALID PARAMETER LENGTH,                @Y30LB12*/ 03105000
*       /* KEYWORD IS CI (ALTPATH)                           @Y30LB12*/ 03106000
*       /* *****************************************         @Y30LB12*/ 03107000
*       /*                                                           */ 03108000
*       /*************************************************************/ 03109000
*                                                                  0799 03110000
*       OUTBUF2(1:46)=ICGDS220;     /*                       @Y30LB12*/ 03111000
         MVC   OUTBUF2(46,R4),ICGDS220                             0799 03112000
*       OUTBUF2(47:58)='CI (ALTPATH)';/*                     @Y30LB12*/ 03113000
         MVC   OUTBUF2+46(12,R4),@CC00706                          0800 03114000
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/ 03115000
         BAL   @14,PUTIT1                                          0801 03116000
*       RETURN;                     /* RETURN TO S04ALTP     @Y30LB12*/ 03117000
         B     @EL00024                                            0802 03118000
*     END;                          /*                       @Y30LB12*/ 03119000
*   ELSE                                                           0804 03120000
*     ;                             /*                       @Y30LB12*/ 03121000
@RF00797 DS    0H                                                  0805 03122000
*   WKCIALT='00'X;                  /* CLEAR CI WORKAREA     @Y30LB12*/ 03123000
         MVI   WKCIALT,X'00'                                       0805 03124000
*   IF SCANDATA(1)='B'              /*                       @Y30LB12*/ 03125000
*     THEN                          /*                       @Y30LB12*/ 03126000
         L     @07,STARTCOL(,R4)                                   0806 03127000
         CLI   SCANDATA(@07),C'B'                                  0806 03128000
         BNE   @RF00806                                            0806 03129000
*     WKCIALT='01'X;                /*                       @Y30LB12*/ 03130000
         MVI   WKCIALT,X'01'                                       0807 03131000
*   ELSE                                                           0808 03132000
*     ;                             /*                       @Y30LB12*/ 03133000
@RF00806 DS    0H                                                  0809 03134000
*   IF SCANDATA(1)='C'              /*                       @Y30LB12*/ 03135000
*     THEN                          /*                       @Y30LB12*/ 03136000
         L     @07,STARTCOL(,R4)                                   0809 03137000
         CLI   SCANDATA(@07),C'C'                                  0809 03138000
         BNE   @RF00809                                            0809 03139000
*     WKCIALT='02'X;                /*                       @Y30LB12*/ 03140000
         MVI   WKCIALT,X'02'                                       0810 03141000
*   ELSE                                                           0811 03142000
*     ;                             /*                       @Y30LB12*/ 03143000
@RF00809 DS    0H                                                  0812 03144000
*   IF SCANDATA(1)='D'              /*                       @Y30LB12*/ 03145000
*     THEN                          /*                       @Y30LB12*/ 03146000
         L     @07,STARTCOL(,R4)                                   0812 03147000
         CLI   SCANDATA(@07),C'D'                                  0812 03148000
         BNE   @RF00812                                            0812 03149000
*     WKCIALT='03'X;                /*                       @Y30LB12*/ 03150000
         MVI   WKCIALT,X'03'                                       0813 03151000
*   ELSE                                                           0814 03152000
*     ;                             /*                       @Y30LB12*/ 03153000
@RF00812 DS    0H                                                  0815 03154000
*   IF WKCIALT='00'X                /* NO MATCH              @Y30LB12*/ 03155000
*     THEN                          /*                       @Y30LB12*/ 03156000
         CLI   WKCIALT,X'00'                                       0815 03157000
         BNE   @RF00815                                            0815 03158000
*     DO;                           /*                       @Y30LB12*/ 03159000
*                                                                  0816 03160000
*       /*************************************************************/ 03161000
*       /*                                                           */ 03162000
*       /* *****************************************         @Y30LB12*/ 03163000
*       /* 'ICG223I VALUE ERROR FOR CI (ALTPATH)'            @Y30LB12*/ 03164000
*       /* *****************************************         @Y30LB12*/ 03165000
*       /*                                                           */ 03166000
*       /*************************************************************/ 03167000
*                                                                  0817 03168000
*       OUTBUF2(1:25)=ICGDS223;     /*                       @Y30LB12*/ 03169000
         MVC   OUTBUF2(25,R4),ICGDS223                             0817 03170000
*       OUTBUF2(26:37)='CI (ALTPATH)';/*                     @Y30LB12*/ 03171000
         MVC   OUTBUF2+25(12,R4),@CC00706                          0818 03172000
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/ 03173000
         BAL   @14,PUTIT1                                          0819 03174000
*     END;                          /*                       @Y30LB12*/ 03175000
*   ELSE                            /*                       @Y30LB12*/ 03176000
*     WORKACI(ALTCOUNT)=WKCIALT;    /* SAVE ALT. CI          @Y30LB12*/ 03177000
         B     @RC00815                                            0821 03178000
@RF00815 LH    @07,ALTCOUNT                                        0821 03179000
         SLA   @07,2                                               0821 03180000
         LA    @05,WORKACI-4(@07)                                  0821 03181000
         MVC   0(1,@05),WKCIALT                                    0821 03182000
*   END S04ACI;                     /* RETURN TO S04ALTP     @Y30LB12*/ 03183000
         B     @EL00024                                            0822 03184000
*                                                                  0823 03185000
*/********************************************************** @Y30LB12*/ 03186000
*/*                                                          @Y30LB12*/ 03187000
*/* PROCEDURE NAME - CHKALTP                                 @Y30LB12*/ 03188000
*/*                                                          @Y30LB12*/ 03189000
*/* FUNCTION - CHECK TO BE SURE THAT THE THREE REQUIRED      @Y30LB12*/ 03190000
*/*            KEYWORDS 'DS=', 'CH=', AND 'CI=' WERE         @Y30LB12*/ 03191000
*/*            SPECIFIED FOR THIS ALTERNATE PATH             @Y30LB12*/ 03192000
*/*                                                          @Y30LB12*/ 03193000
*/********************************************************** @Y30LB12*/ 03194000
*                                                                  0823 03195000
*CHKALTP:                                                          0823 03196000
*   PROCEDURE;                      /*                       @Y30LB12*/ 03197000
CHKALTP  STM   @14,@12,@SA00025                                    0823 03198000
*   I=ALTCOUNT;                     /*                       @Y30LB12*/ 03199000
         LH    I,ALTCOUNT                                          0824 03200000
*   IF ALTHAVES(I)^='E0'X&ALTHAVES(I)^='00'X/*               @Y30LB12*/ 03201000
*     THEN                          /*                       @Y30LB12*/ 03202000
         LR    @07,I                                               0825 03203000
         SLA   @07,2                                               0825 03204000
         LA    @05,ALTHAVES-4(@07)                                 0825 03205000
         CLI   0(@05),X'E0'                                        0825 03206000
         BE    @RF00825                                            0825 03207000
         LA    @05,ALTHAVES-4(@07)                                 0825 03208000
         CLI   0(@05),X'00'                                        0825 03209000
         BE    @RF00825                                            0825 03210000
*     DO;                           /*                       @Y30LB12*/ 03211000
*       IF HAVEADS(I)^='1'B         /*                       @Y30LB12*/ 03212000
*         THEN                      /*                       @Y30LB12*/ 03213000
         LA    @05,HAVEADS-4(@07)                                  0827 03214000
         TM    0(@05),B'00100000'                                  0827 03215000
         BO    @RF00827                                            0827 03216000
*         DO;                       /*                       @Y30LB12*/ 03217000
*                                                                  0828 03218000
*           /*********************************************************/ 03219000
*           /*                                                       */ 03220000
*           /* *****************************************     @Y30LB12*/ 03221000
*           /* ICG221I MISSING REQUIRED KEYWORD SA           @Y30LB12*/ 03222000
*           /* FOR ALTPATH                                   @Y30LB12*/ 03223000
*           /* *****************************************     @Y30LB12*/ 03224000
*           /*                                                       */ 03225000
*           /*********************************************************/ 03226000
*                                                                  0829 03227000
*           OUTBUF2(1:34)=ICGDS221; /*                       @Y30LB12*/ 03228000
         MVC   OUTBUF2(34,R4),ICGDS221                             0829 03229000
*           OUTBUF2(35:48)='SA FOR ALTPATH';/*               @Y30LB12*/ 03230000
         MVC   OUTBUF2+34(14,R4),@CC00712                          0830 03231000
*           CALL PUTIT1;            /* TO MESSAGE WRITER     @Y30LB12*/ 03232000
         BAL   @14,PUTIT1                                          0831 03233000
*         END;                      /*                       @Y30LB12*/ 03234000
*       ELSE                                                       0833 03235000
*         ;                         /*                       @Y30LB12*/ 03236000
@RF00827 DS    0H                                                  0834 03237000
*       IF HAVEACH(I)^='1'B         /*                       @Y30LB12*/ 03238000
*         THEN                      /*                       @Y30LB12*/ 03239000
         LR    @07,I                                               0834 03240000
         SLA   @07,2                                               0834 03241000
         LA    @05,HAVEACH-4(@07)                                  0834 03242000
         TM    0(@05),B'10000000'                                  0834 03243000
         BO    @RF00834                                            0834 03244000
*         DO;                       /*                       @Y30LB12*/ 03245000
*                                                                  0835 03246000
*           /*********************************************************/ 03247000
*           /*                                                       */ 03248000
*           /* *****************************************     @Y30LB12*/ 03249000
*           /* ICG221I MISSING REQUIRED KEYWORD CH           @Y30LB12*/ 03250000
*           /* FOR ALTPATH                                   @Y30LB12*/ 03251000
*           /* *****************************************     @Y30LB12*/ 03252000
*           /*                                                       */ 03253000
*           /*********************************************************/ 03254000
*                                                                  0836 03255000
*           OUTBUF2(1:34)=ICGDS221; /*                       @Y30LB12*/ 03256000
         MVC   OUTBUF2(34,R4),ICGDS221                             0836 03257000
*           OUTBUF2(35:48)='CH FOR ALTPATH';/*               @Y30LB12*/ 03258000
         MVC   OUTBUF2+34(14,R4),@CC00714                          0837 03259000
*           CALL PUTIT1;            /* TO MESSAGE WRITER     @Y30LB12*/ 03260000
         BAL   @14,PUTIT1                                          0838 03261000
*         END;                      /*                       @Y30LB12*/ 03262000
*       ELSE                                                       0840 03263000
*         ;                         /*                       @Y30LB12*/ 03264000
@RF00834 DS    0H                                                  0841 03265000
*       IF HAVEACI(I)^='1'B         /*                       @Y30LB12*/ 03266000
*         THEN                      /*                       @Y30LB12*/ 03267000
         LR    @07,I                                               0841 03268000
         SLA   @07,2                                               0841 03269000
         LA    @05,HAVEACI-4(@07)                                  0841 03270000
         TM    0(@05),B'01000000'                                  0841 03271000
         BO    @RF00841                                            0841 03272000
*         DO;                       /*                       @Y30LB12*/ 03273000
*                                                                  0842 03274000
*           /*********************************************************/ 03275000
*           /*                                                       */ 03276000
*           /* *****************************************     @Y30LB12*/ 03277000
*           /* ICG221I MISSING REQUIRED KEYWORD CI           @Y30LB12*/ 03278000
*           /* FOR ALTPATH                                   @Y30LB12*/ 03279000
*           /* *****************************************     @Y30LB12*/ 03280000
*           /*                                                       */ 03281000
*           /*********************************************************/ 03282000
*                                                                  0843 03283000
*           OUTBUF2(1:34)=ICGDS221; /*                       @Y30LB12*/ 03284000
         MVC   OUTBUF2(34,R4),ICGDS221                             0843 03285000
*           OUTBUF2(35:48)='CI FOR ALTPATH';/*               @Y30LB12*/ 03286000
         MVC   OUTBUF2+34(14,R4),@CC00716                          0844 03287000
*           CALL PUTIT1;            /* TO MESSAGE WRITER     @Y30LB12*/ 03288000
         BAL   @14,PUTIT1                                          0845 03289000
*         END;                      /*                       @Y30LB12*/ 03290000
*       ELSE                                                       0847 03291000
*         ;                         /*                       @Y30LB12*/ 03292000
@RF00841 DS    0H                                                  0848 03293000
*     END;                          /* END OF DO             @Y30LB12*/ 03294000
*   END CHKALTP;                    /* RETURN TO S04ALTP     @Y30LB12*/ 03295000
@EL00025 DS    0H                                                  0849 03296000
@EF00025 DS    0H                                                  0849 03297000
@ER00025 LM    @14,@12,@SA00025                                    0849 03298000
         BR    @14                                                 0849 03299000
*                                                                  0850 03300000
*/********************************************************** @Y30LB12*/ 03301000
*/*                                                          @Y30LB12*/ 03302000
*/* PROCEDURE NAME - UNKNOWN                                 @Y30LB12*/ 03303000
*/*                                                          @Y30LB12*/ 03304000
*/* FUNCTION - IF THE KEYWORD IS NOT RECOGNIZED, WRITE ERROR @Y30LB12*/ 03305000
*/*            MESSAGE 'ICG210I UNDEFINED KEYWORD FOUND'     @Y30LB12*/ 03306000
*/*            AND DO DUMMY READ OF PARAMETER TO  POSITION   @Y30LB12*/ 03307000
*/*            TO NEXT KEYWORD.                              @Y30LB12*/ 03308000
*/*                                                          @Y30LB12*/ 03309000
*/********************************************************** @Y30LB12*/ 03310000
*                                                                  0850 03311000
*UNKNOWN:                                                          0850 03312000
*   PROCEDURE;                      /*                       @Y30LB12*/ 03313000
UNKNOWN  STM   @14,@12,@SA00026                                    0850 03314000
*   MSGNO=ICG210I;                  /* ICGDS210              @Y30LB12*/ 03315000
         MVC   MSGNO(2,R4),ICG210I                                 0851 03316000
*   CALL PUTIT2;                    /* TO MESSAGE WRITER     @Y30LB12*/ 03317000
         BAL   @14,PUTIT2                                          0852 03318000
*   CALL READS99;                   /* DO DUMMY READ         @Y30LB12*/ 03319000
         BAL   @14,READS99                                         0853 03320000
*   END UNKNOWN;                    /* RETURN TO S04SCAN     @Y30LB12*/ 03321000
@EL00026 DS    0H                                                  0854 03322000
@EF00026 DS    0H                                                  0854 03323000
@ER00026 LM    @14,@12,@SA00026                                    0854 03324000
         BR    @14                                                 0854 03325000
*                                                                  0855 03326000
*/********************************************************** @Y30LB12*/ 03327000
*/*                                                          @Y30LB12*/ 03328000
*/* PROCEDURE NAME - S04ANAL                                 @Y30LB12*/ 03329000
*/*                                                          @Y30LB12*/ 03330000
*/* FUNCTION - CALL ANALYZE PROCEDURES MISSREQ AND CHECKRSG  @Y30LB12*/ 03331000
*/*                                                          @Y30LB12*/ 03332000
*/********************************************************** @Y30LB12*/ 03333000
*                                                                  0855 03334000
*S04ANAL:                                                          0855 03335000
*   PROCEDURE;                      /*                       @Y30LB12*/ 03336000
S04ANAL  STM   @14,@12,@SA00027                                    0855 03337000
*   CALL MISSREQ;                   /*                       @Y30LB12*/ 03338000
         BAL   @14,MISSREQ                                         0856 03339000
*   IF STOPSCAN^='1'B               /* NO TERM ERROR         @Y30LB12*/ 03340000
*     THEN                          /*                       @Y30LB12*/ 03341000
         TM    STOPSCAN,B'00001000'                                0857 03342000
         BO    @RF00857                                            0857 03343000
*     DO;                           /*                       @Y30LB12*/ 03344000
*       CALL CHECKRSG;              /* PRIMARY PATH SDG      @Y30LB12*/ 03345000
         BAL   @14,CHECKRSG                                        0859 03346000
*       CALL CKALTRSG;              /* ALTERNATE PATH SDG    @Y30LB12*/ 03347000
         BAL   @14,CKALTRSG                                        0860 03348000
*     END;                          /*                       @Y30LB12*/ 03349000
*   ELSE                                                           0862 03350000
*     ;                             /*                       @Y30LB12*/ 03351000
@RF00857 DS    0H                                                  0863 03352000
*   END S04ANAL;                    /* RET. TO MAINLINE      @Y30LB12*/ 03353000
@EL00027 DS    0H                                                  0863 03354000
@EF00027 DS    0H                                                  0863 03355000
@ER00027 LM    @14,@12,@SA00027                                    0863 03356000
         BR    @14                                                 0863 03357000
*                                                                  0864 03358000
*/********************************************************** @Y30LB12*/ 03359000
*/*                                                          @Y30LB12*/ 03360000
*/* PROCEDURE NAME - MISSREQ                                 @Y30LB12*/ 03361000
*/*                                                          @Y30LB12*/ 03362000
*/* FUNCTION - CHECK FOR REQUIRED KEYWORDS SA, CH, CI CUID,  @Y30LB12*/ 03363000
*/*            AND CPUID MISSING FROM THE CONTROL STATEMENT  @Y30LB12*/ 03364000
*/*                                                          @Y30LB12*/ 03365000
*/********************************************************** @Y30LB12*/ 03366000
*                                                                  0864 03367000
*MISSREQ:                                                          0864 03368000
*   PROCEDURE;                      /*                       @Y30LB12*/ 03369000
MISSREQ  STM   @14,@12,@SA00028                                    0864 03370000
*   IF HAVEDS^='1'B                 /*                       @Y30LB12*/ 03371000
*     THEN                          /*                       @Y30LB12*/ 03372000
         TM    HAVEDS,B'10000000'                                  0865 03373000
         BO    @RF00865                                            0865 03374000
*     DO;                           /*                       @Y30LB12*/ 03375000
*                                                                  0866 03376000
*       /*************************************************************/ 03377000
*       /*                                                           */ 03378000
*       /* *****************************************         @Y30LB12*/ 03379000
*       /* ICG221I MISSING REQUIRED KEYWORD SA               @Y30LB12*/ 03380000
*       /* *****************************************         @Y30LB12*/ 03381000
*       /*                                                           */ 03382000
*       /*************************************************************/ 03383000
*                                                                  0867 03384000
*       OUTBUF2(1:34)=ICGDS221;     /*                       @Y30LB12*/ 03385000
         MVC   OUTBUF2(34,R4),ICGDS221                             0867 03386000
*       OUTBUF2(35:36)='SA';        /*                       @Y30LB12*/ 03387000
         MVC   OUTBUF2+34(2,R4),@CC00600                           0868 03388000
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/ 03389000
         BAL   @14,PUTIT1                                          0869 03390000
*     END;                          /*                       @Y30LB12*/ 03391000
*   ELSE                                                           0871 03392000
*     ;                             /*                       @Y30LB12*/ 03393000
@RF00865 DS    0H                                                  0872 03394000
*   IF HAVECI^='1'B                 /*                       @Y30LB12*/ 03395000
*     THEN                          /*                       @Y30LB12*/ 03396000
         TM    HAVECI,B'01000000'                                  0872 03397000
         BO    @RF00872                                            0872 03398000
*     DO;                           /*                       @Y30LB12*/ 03399000
*                                                                  0873 03400000
*       /*************************************************************/ 03401000
*       /*                                                           */ 03402000
*       /* *****************************************         @Y30LB12*/ 03403000
*       /* ICG221I MISSING REQUIRED KEYWORD CI               @Y30LB12*/ 03404000
*       /* *****************************************         @Y30LB12*/ 03405000
*       /*                                                           */ 03406000
*       /*************************************************************/ 03407000
*                                                                  0874 03408000
*       OUTBUF2(1:34)=ICGDS221;     /*                       @Y30LB12*/ 03409000
         MVC   OUTBUF2(34,R4),ICGDS221                             0874 03410000
*       OUTBUF2(35:36)='CI';        /*                       @Y30LB12*/ 03411000
         MVC   OUTBUF2+34(2,R4),@CC00606                           0875 03412000
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/ 03413000
         BAL   @14,PUTIT1                                          0876 03414000
*     END;                          /*                       @Y30LB12*/ 03415000
*   ELSE                                                           0878 03416000
*     ;                             /*                       @Y30LB12*/ 03417000
@RF00872 DS    0H                                                  0879 03418000
*   IF HAVECH^='1'B                 /*                       @Y30LB12*/ 03419000
*     THEN                          /*                       @Y30LB12*/ 03420000
         TM    HAVECH,B'00100000'                                  0879 03421000
         BO    @RF00879                                            0879 03422000
*     DO;                           /*                       @Y30LB12*/ 03423000
*                                                                  0880 03424000
*       /*************************************************************/ 03425000
*       /*                                                           */ 03426000
*       /* *****************************************         @Y30LB12*/ 03427000
*       /* ICG221I MISSING REQUIRED KEYWORD CH               @Y30LB12*/ 03428000
*       /* *****************************************         @Y30LB12*/ 03429000
*       /*                                                           */ 03430000
*       /*************************************************************/ 03431000
*                                                                  0881 03432000
*       OUTBUF2(1:34)=ICGDS221;     /*                       @Y30LB12*/ 03433000
         MVC   OUTBUF2(34,R4),ICGDS221                             0881 03434000
*       OUTBUF2(35:36)='CH';        /*                       @Y30LB12*/ 03435000
         MVC   OUTBUF2+34(2,R4),@CC00617                           0882 03436000
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/ 03437000
         BAL   @14,PUTIT1                                          0883 03438000
*     END;                          /*                       @Y30LB12*/ 03439000
*   ELSE                                                           0885 03440000
*     ;                             /*                       @Y30LB12*/ 03441000
@RF00879 DS    0H                                                  0886 03442000
*   IF HAVECPU^='1'B                /*                       @Y30LB12*/ 03443000
*     THEN                          /*                       @Y30LB12*/ 03444000
         TM    HAVECPU,B'00001000'                                 0886 03445000
         BO    @RF00886                                            0886 03446000
*     DO;                           /*                       @Y30LB12*/ 03447000
*                                                                  0887 03448000
*       /*************************************************************/ 03449000
*       /*                                                           */ 03450000
*       /* *****************************************         @Y30LB12*/ 03451000
*       /* ICG221I MISSING REQUIRED KEYWORD CPUID            @Y30LB12*/ 03452000
*       /* *****************************************         @Y30LB12*/ 03453000
*       /*                                                           */ 03454000
*       /*************************************************************/ 03455000
*                                                                  0888 03456000
*       OUTBUF2(1:34)=ICGDS221;     /*                       @Y30LB12*/ 03457000
         MVC   OUTBUF2(34,R4),ICGDS221                             0888 03458000
*       OUTBUF2(35:39)='CPUID';     /*                       @Y30LB12*/ 03459000
         MVC   OUTBUF2+34(5,R4),@CC00636                           0889 03460000
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/ 03461000
         BAL   @14,PUTIT1                                          0890 03462000
*     END;                          /*                       @Y30LB12*/ 03463000
*   ELSE                                                           0892 03464000
*     ;                             /*                       @Y30LB12*/ 03465000
@RF00886 DS    0H                                                  0893 03466000
*   IF HAVECU^='1'B                 /*                       @Y30LB12*/ 03467000
*     THEN                          /*                       @Y30LB12*/ 03468000
         TM    HAVECU,B'00010000'                                  0893 03469000
         BO    @RF00893                                            0893 03470000
*     DO;                           /*                       @Y30LB12*/ 03471000
*                                                                  0894 03472000
*       /*************************************************************/ 03473000
*       /*                                                           */ 03474000
*       /* *****************************************         @Y30LB12*/ 03475000
*       /* ICG221I MISSING REQUIRED KEYWORD CUID             @Y30LB12*/ 03476000
*       /* *****************************************         @Y30LB12*/ 03477000
*       /*                                                           */ 03478000
*       /*************************************************************/ 03479000
*                                                                  0895 03480000
*       OUTBUF2(1:34)=ICGDS221;     /*                       @Y30LB12*/ 03481000
         MVC   OUTBUF2(34,R4),ICGDS221                             0895 03482000
*       OUTBUF2(35:38)='CUID';      /*                       @Y30LB12*/ 03483000
         MVC   OUTBUF2+34(4,R4),@CC00627                           0896 03484000
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/ 03485000
         BAL   @14,PUTIT1                                          0897 03486000
*     END;                          /*                       @Y30LB12*/ 03487000
*   ELSE                                                           0899 03488000
*     ;                             /*                       @Y30LB12*/ 03489000
@RF00893 DS    0H                                                  0900 03490000
*   END MISSREQ;                    /* RET. TO S04ANAL       @Y30LB12*/ 03491000
@EL00028 DS    0H                                                  0900 03492000
@EF00028 DS    0H                                                  0900 03493000
@ER00028 LM    @14,@12,@SA00028                                    0900 03494000
         BR    @14                                                 0900 03495000
*                                                                  0901 03496000
*/********************************************************** @Y30LB12*/ 03497000
*/*                                                          @Y30LB12*/ 03498000
*/* PROCEDURE NAME - CHECKRSG                                @Y30LB12*/ 03499000
*/*                                                          @Y30LB12*/ 03500000
*/* FUNCTION - FOR EACH DATA STAGER (ALL THREE CHANNEL       @Y30LB12*/ 03501000
*/*            INTERFACES), A MAXIMUM OF TWO REAL SPINDLE    @Y30LB12*/ 03502000
*/*            GROUPS ARE SUPPORTED.  THIS PROCEDURE CHECKS  @Y30LB12*/ 03503000
*/*            EVERY VIRTUAL AND VIRTUAL SHARED ADDRESS      @Y30LB12*/ 03504000
*/*            SPECIFICATION TO MAKE SURE THAT THE TOTAL     @Y30LB12*/ 03505000
*/*            NUMBER OF UNIQUE RSGS FOR THE DATA STAGER     @Y30LB12*/ 03506000
*/*            DOES NOT EXCEED 2.  CHECKING OF RSGS IN THE   @Y30LB12*/ 03507000
*/*            SPINDLES STATEMENT AGAINST RSGS IN THE        @Y30LB12*/ 03508000
*/*            UPPERCON STATEMENT IS DONE IN THE ANALYZE     @Y30LB12*/ 03509000
*/*            PROCEDURES.                                   @Y30LB12*/ 03510000
*/*                                                          @Y30LB12*/ 03511000
*/********************************************************** @Y30LB12*/ 03512000
*                                                                  0901 03513000
*CHECKRSG:                                                         0901 03514000
*   PROCEDURE;                      /*                       @Y30LB12*/ 03515000
CHECKRSG STM   @14,@12,@SA00029                                    0901 03516000
*   DO I=1 TO MAXDEV;               /* 64 POSSIBLE ADDRS     @Y30LB12*/ 03517000
         LA    I,1                                                 0902 03518000
         B     @DE00902                                            0902 03519000
@DL00902 DS    0H                                                  0903 03520000
*     IF ADR2SPEC(I)='1'B&ADR2V(I)='1'B/*                    @Y30LB12*/ 03521000
*         |ADR2SPEC(I)='1'B&ADR2VS(I)='1'B/*                 @Y30LB12*/ 03522000
*       THEN                        /*                       @Y30LB12*/ 03523000
         LR    @07,I                                               0903 03524000
         MH    @07,@CH00257                                        0903 03525000
         LA    @05,ADR2SPEC-11(@07)                                0903 03526000
         TM    0(@05),B'11000000'                                  0903 03527000
         BO    @RT00903                                            0903 03528000
         LA    @05,ADR2SPEC-11(@07)                                0903 03529000
         TM    0(@05),B'10100000'                                  0903 03530000
         BNO   @RF00903                                            0903 03531000
@RT00903 DS    0H                                                  0904 03532000
*       DO;                         /*                       @Y30LB12*/ 03533000
*         IF TORSG1(DSINDEX)='FF'X  /*                       @Y30LB12*/ 03534000
*           THEN                    /*                       @Y30LB12*/ 03535000
         LH    @07,DSINDEX                                         0905 03536000
         ALR   @07,@07                                             0905 03537000
         L     @05,COMPTR2(,R4)                                    0905 03538000
         ST    @07,@TF00001                                        0905 03539000
         ALR   @07,@05                                             0905 03540000
         BCTR  @07,0                                               0905 03541000
         BCTR  @07,0                                               0905 03542000
         CLI   TORSG1(@07),X'FF'                                   0905 03543000
         BNE   @RF00905                                            0905 03544000
*           TORSG1(DSINDEX)=WK2RSG(I);/*                     @Y30LB12*/ 03545000
         AL    @05,@TF00001                                        0906 03546000
         BCTR  @05,0                                               0906 03547000
         BCTR  @05,0                                               0906 03548000
         LR    @07,I                                               0906 03549000
         MH    @07,@CH00257                                        0906 03550000
         LA    @03,WK2RSG-11(@07)                                  0906 03551000
         MVC   TORSG1(1,@05),0(@03)                                0906 03552000
*         ELSE                      /*                       @Y30LB12*/ 03553000
*           IF TORSG1(DSINDEX)^=WK2RSG(I)/*                  @Y30LB12*/ 03554000
*             THEN                  /*                       @Y30LB12*/ 03555000
         B     @RC00905                                            0907 03556000
@RF00905 LH    @07,DSINDEX                                         0907 03557000
         ALR   @07,@07                                             0907 03558000
         L     @05,COMPTR2(,R4)                                    0907 03559000
         LR    @03,I                                               0907 03560000
         MH    @03,@CH00257                                        0907 03561000
         ST    @07,@TF00001                                        0907 03562000
         ALR   @07,@05                                             0907 03563000
         BCTR  @07,0                                               0907 03564000
         BCTR  @07,0                                               0907 03565000
         LA    @01,WK2RSG-11(@03)                                  0907 03566000
         CLC   TORSG1(1,@07),0(@01)                                0907 03567000
         BE    @RF00907                                            0907 03568000
*             IF TORSG2(DSINDEX)='FF'X/*                     @Y30LB12*/ 03569000
*               THEN                /*                       @Y30LB12*/ 03570000
         LR    @07,@05                                             0908 03571000
         AL    @07,@TF00001                                        0908 03572000
         BCTR  @07,0                                               0908 03573000
         CLI   TORSG2-1(@07),X'FF'                                 0908 03574000
         BNE   @RF00908                                            0908 03575000
*               TORSG2(DSINDEX)=WK2RSG(I);/*                 @Y30LB12*/ 03576000
         AL    @05,@TF00001                                        0909 03577000
         BCTR  @05,0                                               0909 03578000
         LA    @07,WK2RSG-11(@03)                                  0909 03579000
         MVC   TORSG2-1(1,@05),0(@07)                              0909 03580000
*             ELSE                  /*                       @Y30LB12*/ 03581000
*               IF TORSG2(DSINDEX)^=WK2RSG(I) THEN/*         @Y30LB12*/ 03582000
         B     @RC00908                                            0910 03583000
@RF00908 LH    @07,DSINDEX                                         0910 03584000
         ALR   @07,@07                                             0910 03585000
         L     @05,COMPTR2(,R4)                                    0910 03586000
         LR    @03,I                                               0910 03587000
         MH    @03,@CH00257                                        0910 03588000
         ALR   @05,@07                                             0910 03589000
         BCTR  @05,0                                               0910 03590000
         LA    @07,WK2RSG-11(@03)                                  0910 03591000
         CLC   TORSG2-1(1,@05),0(@07)                              0910 03592000
         BE    @RF00910                                            0910 03593000
*                 DO;               /*                       @Y30LB12   03594000
*                                      ********************* @Y30LB12   03595000
*                                      ICG232I SA            @Y30LB12   03596000
*                                      INTERFACES TO         @Y30LB12   03597000
*                                      MORE THAN TWO         @Y30LB12   03598000
*                                      SDGS                  @Y30LB12   03599000
*                                      ********************* @Y30LB12*/ 03600000
*                   OUTBUF2(1:44)=ICGDS232;                        0912 03601000
         MVC   OUTBUF2(44,R4),ICGDS232                             0912 03602000
*                   CALL PUTIT1;    /*                       @Y30LB12*/ 03603000
         BAL   @14,PUTIT1                                          0913 03604000
*                   RETURN;         /* WRITE ONCE            @Y30LB12*/ 03605000
@EL00029 DS    0H                                                  0914 03606000
@EF00029 DS    0H                                                  0914 03607000
@ER00029 LM    @14,@12,@SA00029                                    0914 03608000
         BR    @14                                                 0914 03609000
*                 END;              /*                       @Y30LB12*/ 03610000
*               ELSE                                               0916 03611000
*                 ;                 /*                       @Y30LB12*/ 03612000
@RF00910 DS    0H                                                  0917 03613000
*           ELSE                                                   0917 03614000
*             ;                     /*                       @Y30LB12*/ 03615000
@RF00907 DS    0H                                                  0918 03616000
*       END;                        /*                       @Y30LB12*/ 03617000
*     ELSE                                                         0919 03618000
*       ;                           /*                       @Y30LB12*/ 03619000
@RF00903 DS    0H                                                  0920 03620000
*   END;                            /* CHECKED 64 ADDRS      @Y30LB12*/ 03621000
@RC00903 AH    I,@CH00044                                          0920 03622000
@DE00902 CH    I,MAXDEV                                            0920 03623000
         BNH   @DL00902                                            0920 03624000
*   END CHECKRSG;                   /* RET. TO S04ANAL       @Y30LB12*/ 03625000
         B     @EL00029                                            0921 03626000
*                                                                  0922 03627000
*/********************************************************** @Y30LB12*/ 03628000
*/*                                                          @Y30LB12*/ 03629000
*/* PROCEDURE NAME - CKALTRSG                                @Y30LB12*/ 03630000
*/*                                                          @Y30LB12*/ 03631000
*/* FUNCTION - CHECK EACH DEVICE SPECIFICATION FOR ALTERNATE @Y30LB12*/ 03632000
*/*            PATH SPECIFICATION.  IF ALTERNATE PATH IS     @Y30LB12*/ 03633000
*/*            SPECIFIED AND IF THE DATA STAGER FOR THE      @Y30LB12*/ 03634000
*/*            ALTERNATE PATH IS DIFFERENT FROM THAT OF THE  @Y30LB12*/ 03635000
*/*            PRIMARY PATH, PASS THE RSG USED BY THE        @Y30LB12*/ 03636000
*/*            PRIMARY PATH AND THE INDEX VALUE (DS+1) OF    @Y30LB12*/ 03637000
*/*            THE ALTERNATE DS TO THE PROCEDURE PUTALT.     @Y30LB12*/ 03638000
*/*                                                          @Y30LB12*/ 03639000
*/********************************************************** @Y30LB12*/ 03640000
*                                                                  0922 03641000
*CKALTRSG:                                                         0922 03642000
*   PROCEDURE;                      /*                       @Y30LB12*/ 03643000
CKALTRSG STM   @14,@12,@SA00030                                    0922 03644000
*   DO I=1 TO MAXDEV;               /* 64 POSSIBLE ADDRS     @Y30LB12*/ 03645000
         LA    I,1                                                 0923 03646000
         B     @DE00923                                            0923 03647000
@DL00923 DS    0H                                                  0924 03648000
*     IF ADR2SPEC(I)='1'B           /* IF ADDRESS USED       @Y30LB12*/ 03649000
*       THEN                        /*                       @Y30LB12*/ 03650000
         LR    @07,I                                               0924 03651000
         MH    @07,@CH00257                                        0924 03652000
         LA    @05,ADR2SPEC-11(@07)                                0924 03653000
         TM    0(@05),B'10000000'                                  0924 03654000
         BNO   @RF00924                                            0924 03655000
*       IF ADR2V(I)='1'B|ADR2VS(I)='1'B/*                    @OZ09548*/ 03656000
*         THEN                      /*                       @OZ09548*/ 03657000
         LA    @05,ADR2V-11(@07)                                   0925 03658000
         TM    0(@05),B'01100000'                                  0925 03659000
         BZ    @RF00925                                            0925 03660000
*         DO;                       /*                       @Y30LB12*/ 03661000
*           IF WK2ACI1(I)^='00'X    /* IF ALTPATH AND        @Y30LB12*/ 03662000
*               &WK2ADS1(I)^=DSINDEX-1/* DIFFERENT SA        @Y30LB12*/ 03663000
*             THEN                  /*                       @Y30LB12*/ 03664000
         LA    @05,WK2ACI1-11(@07)                                 0927 03665000
         CLI   0(@05),X'00'                                        0927 03666000
         BE    @RF00927                                            0927 03667000
         SLR   @05,@05                                             0927 03668000
         IC    @05,WK2ADS1-11(@07)                                 0927 03669000
         LH    @03,DSINDEX                                         0927 03670000
         BCTR  @03,0                                               0927 03671000
         CR    @05,@03                                             0927 03672000
         BE    @RF00927                                            0927 03673000
*             DO;                   /*                       @Y30LB12*/ 03674000
*               ALTRSG=WK2RSG(I);   /* PASS ALT SDG          @Y30LB12*/ 03675000
         LA    @03,WK2RSG-11(@07)                                  0929 03676000
         MVC   ALTRSG(1),0(@03)                                    0929 03677000
*               ALTINDEX=WK2ADS1(I)+1;/* PASS SA             @Y30LB12*/ 03678000
         LA    @05,1(,@05)                                         0930 03679000
         STH   @05,ALTINDEX                                        0930 03680000
*               CALL PUTALT;        /* SDG 1ST ALTPATH       @Y30LB12*/ 03681000
         BAL   @14,PUTALT                                          0931 03682000
*             END;                  /*                       @Y30LB12*/ 03683000
*           ELSE                    /*                       @Y30LB12*/ 03684000
*             IF WK2ACI1(I)=WORKCI  /*                       @Y30LB12*/ 03685000
*                 &WORKCI^='00'X    /*                       @Y30LB12*/ 03686000
*               THEN                /*                       @Y30LB12*/ 03687000
         B     @RC00927                                            0933 03688000
@RF00927 LR    @07,I                                               0933 03689000
         MH    @07,@CH00257                                        0933 03690000
         LA    @05,WK2ACI1-11(@07)                                 0933 03691000
         CLC   0(1,@05),WORKCI                                     0933 03692000
         BNE   @RF00933                                            0933 03693000
         CLI   WORKCI,X'00'                                        0933 03694000
         BE    @RF00933                                            0933 03695000
*               DO;                 /*                       @Y30LB12*/ 03696000
*                                                                  0934 03697000
*                 /***************************************************/ 03698000
*                 /*                                                 */ 03699000
*                 /* *******************************         @Y30LB12*/ 03700000
*                 /* ICG223I VALUE ERROR FOR                 @Y30LB12*/ 03701000
*                 /* ALTPATH1                                @Y30LB12*/ 03702000
*                 /* *******************************         @Y30LB12*/ 03703000
*                 /*                                                 */ 03704000
*                 /***************************************************/ 03705000
*                                                                  0935 03706000
*                 OUTBUF2(1:25)=ICGDS223;/*                  @Y30LB12*/ 03707000
         MVC   OUTBUF2(25,R4),ICGDS223                             0935 03708000
*                 OUTBUF2(26:33)='ALTPATH1';/*               @Y30LB12*/ 03709000
         MVC   OUTBUF2+25(8,R4),@CC00738                           0936 03710000
*                 CALL PUTIT1;      /* TO MESSAGE WRITER     @Y30LB12*/ 03711000
         BAL   @14,PUTIT1                                          0937 03712000
*               END;                /*                       @Y30LB12*/ 03713000
*             ELSE                                                 0939 03714000
*               ;                                                  0939 03715000
@RF00933 DS    0H                                                  0940 03716000
*           IF WK2ACI2(I)^='00'X    /* 2ND ALTPATH USED      @Y30LB12*/ 03717000
*               &WK2ADS2(I)^=DSINDEX-1/* DIFFERENT SA        @Y30LB12*/ 03718000
*             THEN                  /*                       @Y30LB12*/ 03719000
@RC00927 LR    @07,I                                               0940 03720000
         MH    @07,@CH00257                                        0940 03721000
         LA    @05,WK2ACI2-11(@07)                                 0940 03722000
         CLI   0(@05),X'00'                                        0940 03723000
         BE    @RF00940                                            0940 03724000
         SLR   @05,@05                                             0940 03725000
         IC    @05,WK2ADS2-11(@07)                                 0940 03726000
         LH    @03,DSINDEX                                         0940 03727000
         BCTR  @03,0                                               0940 03728000
         CR    @05,@03                                             0940 03729000
         BE    @RF00940                                            0940 03730000
*             DO;                   /*                       @Y30LB12*/ 03731000
*               ALTRSG=WK2RSG(I);   /* SDG 2ND ALTPATH       @Y30LB12*/ 03732000
         LA    @03,WK2RSG-11(@07)                                  0942 03733000
         MVC   ALTRSG(1),0(@03)                                    0942 03734000
*               ALTINDEX=WK2ADS2(I)+1;/* 2ND SA              @Y30LB12*/ 03735000
         LA    @05,1(,@05)                                         0943 03736000
         STH   @05,ALTINDEX                                        0943 03737000
*               CALL PUTALT;        /* CHECK 2ND ALTPATH     @Y30LB12*/ 03738000
         BAL   @14,PUTALT                                          0944 03739000
*             END;                  /*                       @Y30LB12*/ 03740000
*           ELSE                    /*                       @Y30LB12*/ 03741000
*             IF WK2ACI2(I)=WORKCI  /*                       @Y30LB12*/ 03742000
*                 &WORKCI^='00'X    /*                       @Y30LB12*/ 03743000
*               THEN                /*                       @Y30LB12*/ 03744000
         B     @RC00940                                            0946 03745000
@RF00940 LR    @07,I                                               0946 03746000
         MH    @07,@CH00257                                        0946 03747000
         LA    @05,WK2ACI2-11(@07)                                 0946 03748000
         CLC   0(1,@05),WORKCI                                     0946 03749000
         BNE   @RF00946                                            0946 03750000
         CLI   WORKCI,X'00'                                        0946 03751000
         BE    @RF00946                                            0946 03752000
*               DO;                 /*                       @Y30LB12*/ 03753000
*                                                                  0947 03754000
*                 /***************************************************/ 03755000
*                 /*                                                 */ 03756000
*                 /* *******************************         @Y30LB12*/ 03757000
*                 /* ICG223I VALUE ERROR FOR                 @Y30LB12*/ 03758000
*                 /* ALTPATH2                                @Y30LB12*/ 03759000
*                 /* *******************************         @Y30LB12*/ 03760000
*                 /*                                                 */ 03761000
*                 /***************************************************/ 03762000
*                                                                  0948 03763000
*                 OUTBUF2(1:25)=ICGDS223;/*                  @Y30LB12*/ 03764000
         MVC   OUTBUF2(25,R4),ICGDS223                             0948 03765000
*                 OUTBUF2(26:33)='ALTPATH2';/*               @Y30LB12*/ 03766000
         MVC   OUTBUF2+25(8,R4),@CC00739                           0949 03767000
*                 CALL PUTIT1;      /* TO MESSAGE WRITER     @Y30LB12*/ 03768000
         BAL   @14,PUTIT1                                          0950 03769000
*               END;                /*                       @Y30LB12*/ 03770000
*           IF WK2ACI3(I)^='00'X    /* 3RD ALTPATH USED      @Y30LB12*/ 03771000
*               &WK2ADS3(I)^=DSINDEX-1/* DIFFERENT SA        @Y30LB12*/ 03772000
*             THEN                  /*                       @Y30LB12*/ 03773000
@RF00946 DS    0H                                                  0952 03774000
@RC00940 LR    @07,I                                               0952 03775000
         MH    @07,@CH00257                                        0952 03776000
         LA    @05,WK2ACI3-11(@07)                                 0952 03777000
         CLI   0(@05),X'00'                                        0952 03778000
         BE    @RF00952                                            0952 03779000
         SLR   @05,@05                                             0952 03780000
         IC    @05,WK2ADS3-11(@07)                                 0952 03781000
         LH    @03,DSINDEX                                         0952 03782000
         BCTR  @03,0                                               0952 03783000
         CR    @05,@03                                             0952 03784000
         BE    @RF00952                                            0952 03785000
*             DO;                   /*                       @Y30LB12*/ 03786000
*               ALTRSG=WK2RSG(I);   /* SDG 3RD ALTPATH       @Y30LB12*/ 03787000
         LA    @03,WK2RSG-11(@07)                                  0954 03788000
         MVC   ALTRSG(1),0(@03)                                    0954 03789000
*               ALTINDEX=WK2ADS3(I)+1;/* 3RD SA              @Y30LB12*/ 03790000
         LA    @05,1(,@05)                                         0955 03791000
         STH   @05,ALTINDEX                                        0955 03792000
*               CALL PUTALT;        /* CHECK 3RD ALTPATH     @Y30LB12*/ 03793000
         BAL   @14,PUTALT                                          0956 03794000
*             END;                  /*                       @Y30LB12*/ 03795000
*           ELSE                    /*                       @Y30LB12*/ 03796000
*             IF WK2ACI3(I)=WORKCI  /*                       @Y30LB12*/ 03797000
*                 &WORKCI^='00'X    /*                       @Y30LB12*/ 03798000
*               THEN                /*                       @Y30LB12*/ 03799000
         B     @RC00952                                            0958 03800000
@RF00952 LR    @07,I                                               0958 03801000
         MH    @07,@CH00257                                        0958 03802000
         LA    @05,WK2ACI3-11(@07)                                 0958 03803000
         CLC   0(1,@05),WORKCI                                     0958 03804000
         BNE   @RF00958                                            0958 03805000
         CLI   WORKCI,X'00'                                        0958 03806000
         BE    @RF00958                                            0958 03807000
*               DO;                 /*                       @Y30LB12*/ 03808000
*                                                                  0959 03809000
*                 /***************************************************/ 03810000
*                 /*                                                 */ 03811000
*                 /* *******************************         @Y30LB12*/ 03812000
*                 /* ICG223I VALUE ERROR FOR                 @Y30LB12*/ 03813000
*                 /* ALTPATH3                                @Y30LB12*/ 03814000
*                 /* *******************************         @Y30LB12*/ 03815000
*                 /*                                                 */ 03816000
*                 /***************************************************/ 03817000
*                                                                  0960 03818000
*                 OUTBUF2(1:25)=ICGDS223;/*                  @Y30LB12*/ 03819000
         MVC   OUTBUF2(25,R4),ICGDS223                             0960 03820000
*                 OUTBUF2(26:33)='ALTPATH3';/*               @Y30LB12*/ 03821000
         MVC   OUTBUF2+25(8,R4),@CC00740                           0961 03822000
*                 CALL PUTIT1;      /* TO MESSAGE WRITER     @Y30LB12*/ 03823000
         BAL   @14,PUTIT1                                          0962 03824000
*               END;                /*                       @Y30LB12*/ 03825000
*         END;                      /*                       @Y30LB12*/ 03826000
*       ELSE                                                       0965 03827000
*         ;                         /*                       @Y30LB12*/ 03828000
@RF00925 DS    0H                                                  0966 03829000
*   END;                            /*                       @Y30LB12*/ 03830000
@RC00925 DS    0H                                                  0966 03831000
@RF00924 AH    I,@CH00044                                          0966 03832000
@DE00923 CH    I,MAXDEV                                            0966 03833000
         BNH   @DL00923                                            0966 03834000
*   END CKALTRSG;                   /* RETURN TO S04ANAL     @Y30LB12*/ 03835000
@EL00030 DS    0H                                                  0967 03836000
@EF00030 DS    0H                                                  0967 03837000
@ER00030 LM    @14,@12,@SA00030                                    0967 03838000
         BR    @14                                                 0967 03839000
*                                                                  0968 03840000
*/********************************************************** @Y30LB12*/ 03841000
*/*                                                          @Y30LB12*/ 03842000
*/* PROCEDURE NAME - PUTALT                                  @Y30LB12*/ 03843000
*/*                                                          @Y30LB12*/ 03844000
*/* FUNCTION - AN ALTERNATE PATH THROUGH A DIFFERENT DS      @Y30LB12*/ 03845000
*/*            THAN THE PRIMARY PATH DEDICATES ONE OF THE    @Y30LB12*/ 03846000
*/*            POSSIBLE RSGS THAT CAN BE USED THROUGH THE    @Y30LB12*/ 03847000
*/*            ALTERNATE DS TO THE SAME RSG AS USED FOR THE  @Y30LB12*/ 03848000
*/*            DS.  A MAXIMUM OF TWO RSGS CAN BE SPECIFIED   @Y30LB12*/ 03849000
*/*            THROUGH ANY DATA STAGER.                      @Y30LB12*/ 03850000
*/*                                                          @Y30LB12*/ 03851000
*/********************************************************** @Y30LB12*/ 03852000
*                                                                  0968 03853000
*PUTALT:                                                           0968 03854000
*   PROCEDURE;                      /*                       @Y30LB12*/ 03855000
PUTALT   STM   @14,@12,@SA00031                                    0968 03856000
*   IF TORSG1(ALTINDEX)='FF'X       /* NO PREVIOUS SDG       @Y30LB12*/ 03857000
*     THEN                          /*                       @Y30LB12*/ 03858000
         LH    @07,ALTINDEX                                        0969 03859000
         ALR   @07,@07                                             0969 03860000
         L     @05,COMPTR2(,R4)                                    0969 03861000
         ST    @07,@TF00001                                        0969 03862000
         ALR   @07,@05                                             0969 03863000
         BCTR  @07,0                                               0969 03864000
         BCTR  @07,0                                               0969 03865000
         CLI   TORSG1(@07),X'FF'                                   0969 03866000
         BNE   @RF00969                                            0969 03867000
*     TORSG1(ALTINDEX)=ALTRSG;      /* TO 1ST SDG ENTRY      @Y30LB12*/ 03868000
         AL    @05,@TF00001                                        0970 03869000
         BCTR  @05,0                                               0970 03870000
         BCTR  @05,0                                               0970 03871000
         MVC   TORSG1(1,@05),ALTRSG                                0970 03872000
*   ELSE                            /*                       @Y30LB12*/ 03873000
*     IF TORSG1(ALTINDEX)^=ALTRSG   /* NO MATCH              @Y30LB12*/ 03874000
*       THEN                        /*                       @Y30LB12*/ 03875000
         B     @RC00969                                            0971 03876000
@RF00969 LH    @07,ALTINDEX                                        0971 03877000
         ALR   @07,@07                                             0971 03878000
         L     @05,COMPTR2(,R4)                                    0971 03879000
         ST    @07,@TF00001                                        0971 03880000
         ALR   @07,@05                                             0971 03881000
         BCTR  @07,0                                               0971 03882000
         BCTR  @07,0                                               0971 03883000
         CLC   TORSG1(1,@07),ALTRSG                                0971 03884000
         BE    @RF00971                                            0971 03885000
*       IF TORSG2(ALTINDEX)='FF'X   /* 2ND UNUSED            @Y30LB12*/ 03886000
*         THEN                      /*                       @Y30LB12*/ 03887000
         LR    @07,@05                                             0972 03888000
         AL    @07,@TF00001                                        0972 03889000
         BCTR  @07,0                                               0972 03890000
         CLI   TORSG2-1(@07),X'FF'                                 0972 03891000
         BNE   @RF00972                                            0972 03892000
*         TORSG2(ALTINDEX)=ALTRSG;  /* TO 2ND                @Y30LB12*/ 03893000
         AL    @05,@TF00001                                        0973 03894000
         BCTR  @05,0                                               0973 03895000
         MVC   TORSG2-1(1,@05),ALTRSG                              0973 03896000
*       ELSE                        /*                       @Y30LB12*/ 03897000
*         IF TORSG2(ALTINDEX)^=ALTRSG/*                      @Y30LB12*/ 03898000
*           THEN                    /*                       @Y30LB12*/ 03899000
         B     @RC00972                                            0974 03900000
@RF00972 LH    @07,ALTINDEX                                        0974 03901000
         ALR   @07,@07                                             0974 03902000
         L     @05,COMPTR2(,R4)                                    0974 03903000
         ALR   @05,@07                                             0974 03904000
         BCTR  @05,0                                               0974 03905000
         CLC   TORSG2-1(1,@05),ALTRSG                              0974 03906000
         BE    @RF00974                                            0974 03907000
*           DO;                     /*                       @Y30LB12*/ 03908000
*                                                                  0975 03909000
*             /*******************************************************/ 03910000
*             /*                                                     */ 03911000
*             /* *****************************               @Y30LB12*/ 03912000
*             /* ICGDS232 SA INTERFACES TO                   @Y30LB12*/ 03913000
*             /* MORE THAN TWO SDGS (ALTPATH                 @Y30LB12*/ 03914000
*             /* SA)                                         @Y30LB12*/ 03915000
*             /* *****************************               @Y30LB12*/ 03916000
*             /*                                                     */ 03917000
*             /*******************************************************/ 03918000
*                                                                  0976 03919000
*             OUTBUF2(1:44)=ICGDS232;/*                      @Y30LB12*/ 03920000
         MVC   OUTBUF2(44,R4),ICGDS232                             0976 03921000
*             OUTBUF2(46:57)='(ALTPATH SA)';                       0977 03922000
         MVC   OUTBUF2+45(12,R4),@CC00745                          0977 03923000
*             CALL PUTIT1;          /* TO MSG WRITER         @Y30LB12*/ 03924000
         BAL   @14,PUTIT1                                          0978 03925000
*           END;                    /*                       @Y30LB12*/ 03926000
*         ELSE                                                     0980 03927000
*           ;                       /*                       @Y30LB12*/ 03928000
@RF00974 DS    0H                                                  0981 03929000
*   END PUTALT;                     /* RET. TO CKALTRSG      @Y30LB12*/ 03930000
@EL00031 DS    0H                                                  0981 03931000
@EF00031 DS    0H                                                  0981 03932000
@ER00031 LM    @14,@12,@SA00031                                    0981 03933000
         BR    @14                                                 0981 03934000
*                                                                  0982 03935000
*/********************************************************** @Y30LB12*/ 03936000
*/*                                                          @Y30LB12*/ 03937000
*/* PROCEDURE NAME - S04BUILD                                @Y30LB12*/ 03938000
*/*                                                          @Y30LB12*/ 03939000
*/* FUNCTION - CHECK TO BE SURE THAT THIS DATA STAGER/       @Y30LB12*/ 03940000
*/*            CHANNEL INTERFACE HAS NOT BEEN SPECIFIED IN A @Y30LB12*/ 03941000
*/*            PREVIOUS UPPERCON CONTROL STATEMENT.  IF NOT  @Y30LB12*/ 03942000
*/*            PREVIOUSLY SPECIFIED, ENTER CPUID, CHANNEL    @Y30LB12*/ 03943000
*/*            NUMBER, AND CONTROL UNIT IDENTIFICATION INTO  @Y30LB12*/ 03944000
*/*            THE PROPER ENTRY AND MARK THAT INTERFACE AS   @Y30LB12*/ 03945000
*/*            USED.                                         @Y30LB12*/ 03946000
*/*                                                          @Y30LB12*/ 03947000
*/*            CHECK EACH ADDRESS SPECIFIED IN THIS CONTROL  @Y30LB12*/ 03948000
*/*            STATEMENT TO BE SURE IT WAS NOT PREVIOUSLY    @Y30LB12*/ 03949000
*/*            SPECIFIED AND MOVE DATA STORED IN WK2ADDRS    @Y30LB12*/ 03950000
*/*            TO APPROPRIATE ENTRY IN CONFGUCB.             @Y30LB12*/ 03951000
*/*                                                          @Y30LB12*/ 03952000
*/********************************************************** @Y30LB12*/ 03953000
*                                                                  0982 03954000
*S04BUILD:                                                         0982 03955000
*   PROCEDURE;                      /*                       @Y30LB12*/ 03956000
*                                                                  0982 03957000
S04BUILD STM   @14,@12,@SA00032                                    0982 03958000
*   /*****************************************************************/ 03959000
*   /*                                                               */ 03960000
*   /* ***********************************************       @Y30LB12*/ 03961000
*   /* DEVELOP FIRST INDEX INTO CONFGUCB AND ONLY            @Y30LB12*/ 03962000
*   /* INTO CONFGCON. I IS A VALUE IN THE RANGE 1            @Y30LB12*/ 03963000
*   /* TO 48. FOR EACH DATA STAGER (0-F) THERE ARE           @Y30LB12*/ 03964000
*   /* THREE CHANNEL INTERFACES WHICH ARE STORED             @Y30LB12*/ 03965000
*   /* INTERNALLY AS 1, 2, AND 3.                            @Y30LB12*/ 03966000
*   /* ***********************************************       @Y30LB12*/ 03967000
*   /*                                                               */ 03968000
*   /*****************************************************************/ 03969000
*                                                                  0983 03970000
*   I=DSINDEX-1;                    /* ZERO FOR DS 0         @Y30LB12*/ 03971000
         LH    I,DSINDEX                                           0983 03972000
         BCTR  I,0                                                 0983 03973000
*   I=I*3;                          /* MULTIPLY BY 3         @Y30LB12*/ 03974000
         LR    @07,I                                               0984 03975000
         MH    @07,@CH00050                                        0984 03976000
         LR    I,@07                                               0984 03977000
*   I=WORKCI+I;                     /* ADD CHANNEL INT.      @Y30LB12*/ 03978000
         MVC   @ZT00003+3(1),WORKCI                                0985 03979000
         AL    I,@ZT00003                                          0985 03980000
*   IF CISPEC(I)^='1'B              /* CHECK INT. USED       @Y30LB12*/ 03981000
*     THEN                          /*                       @Y30LB12*/ 03982000
         LR    @07,I                                               0986 03983000
         MH    @07,@CH00114                                        0986 03984000
         L     @05,COMPTR2(,R4)                                    0986 03985000
         ST    @07,@TF00001                                        0986 03986000
         ALR   @07,@05                                             0986 03987000
         TM    CISPEC-9(@07),B'10000000'                           0986 03988000
         BO    @RF00986                                            0986 03989000
*     DO;                           /*                       @Y30LB12*/ 03990000
*       CISPEC(I)='1'B;             /* MARK INT. USED        @Y30LB12*/ 03991000
         LR    @07,@05                                             0988 03992000
         AL    @07,@TF00001                                        0988 03993000
         OI    CISPEC-9(@07),B'10000000'                           0988 03994000
*       RSGCPUID(I)=WORKCPU;        /* MOVE MANUFACTURER     @Y30LB12*/ 03995000
         LR    @07,@05                                             0989 03996000
         AL    @07,@TF00001                                        0989 03997000
         MVC   RSGCPUID-9(5,@07),WORKCPU                           0989 03998000
*       RSGCHAN(I)=WORKCH;          /* MOVE CHANNEL          @Y30LB12*/ 03999000
         LR    @07,@05                                             0990 04000000
         AL    @07,@TF00001                                        0990 04001000
         MVC   RSGCHAN-9(1,@07),WORKCH                             0990 04002000
*       RSGCUA(I)=WORKCU;           /* MOVE CONTROL UNIT     @Y30LB12*/ 04003000
         SLR   @07,@07                                             0991 04004000
         IC    @07,WORKCU                                          0991 04005000
         L     @03,@TF00001                                        0991 04006000
         STC   @07,RSGCUA-9(@03,@05)                               0991 04007000
*     END;                          /*                       @Y30LB12*/ 04008000
*   ELSE                            /*                       @Y30LB12*/ 04009000
*     DO;                           /*                       @Y30LB12*/ 04010000
         B     @RC00986                                            0993 04011000
@RF00986 DS    0H                                                  0994 04012000
*       IF RSGCPUID(I)^=WORKCPU     /* NONMATCH              @Y30LB12*/ 04013000
*           |RSGCHAN(I)^=WORKCH     /* OR NONMATCH           @Y30LB12*/ 04014000
*           |RSGCUA(I)^=WORKCU      /* OR NONMATCH           @Y30LB12*/ 04015000
*         THEN                      /*                       @Y30LB12*/ 04016000
         LR    @07,I                                               0994 04017000
         MH    @07,@CH00114                                        0994 04018000
         L     @05,COMPTR2(,R4)                                    0994 04019000
         ST    @07,@TF00001                                        0994 04020000
         ALR   @07,@05                                             0994 04021000
         CLC   RSGCPUID-9(5,@07),WORKCPU                           0994 04022000
         BNE   @RT00994                                            0994 04023000
         LR    @07,@05                                             0994 04024000
         AL    @07,@TF00001                                        0994 04025000
         CLC   RSGCHAN-9(1,@07),WORKCH                             0994 04026000
         BNE   @RT00994                                            0994 04027000
         L     @07,@TF00001                                        0994 04028000
         SLR   @03,@03                                             0994 04029000
         IC    @03,RSGCUA-9(@07,@05)                               0994 04030000
         MVC   @ZT00003+3(1),WORKCU                                0994 04031000
         C     @03,@ZT00003                                        0994 04032000
         BE    @RF00994                                            0994 04033000
@RT00994 DS    0H                                                  0995 04034000
*         DO;                       /*                       @Y30LB12*/ 04035000
*                                                                  0995 04036000
*           /*********************************************************/ 04037000
*           /*                                                       */ 04038000
*           /* ***********************************           @Y30LB12*/ 04039000
*           /* ICG230I SA/CI PREVIOUSLY                      @Y30LB12*/ 04040000
*           /* SPECIFIED                                     @Y30LB12*/ 04041000
*           /* ***********************************           @Y30LB12*/ 04042000
*           /*                                                       */ 04043000
*           /*********************************************************/ 04044000
*                                                                  0996 04045000
*           MSGNO=ICG230I;          /* IDENT FOR ICG230I     @Y30LB12*/ 04046000
         MVC   MSGNO(2,R4),ICG230I                                 0996 04047000
*           CALL PUTIT2;            /* TO MESSAGE WRITER     @YD00113*/ 04048000
         BAL   @14,PUTIT2                                          0997 04049000
*           RETURN;                 /* RET. TO MAINLINE      @Y30LB12*/ 04050000
@EL00032 DS    0H                                                  0998 04051000
@EF00032 DS    0H                                                  0998 04052000
@ER00032 LM    @14,@12,@SA00032                                    0998 04053000
         BR    @14                                                 0998 04054000
*         END;                      /*                       @Y30LB12*/ 04055000
*     END;                          /*                       @Y30LB12*/ 04056000
@RF00994 DS    0H                                                  1001 04057000
*   DO J=1 TO MAXDEV;               /* 64 POSSIBLE ADDRS     @Y30LB12*/ 04058000
@RC00986 LA    J,1                                                 1001 04059000
         B     @DE01001                                            1001 04060000
@DL01001 DS    0H                                                  1002 04061000
*     IF ADR2SPEC(J)='1'B           /* ADDR USED HERE        @Y30LB12*/ 04062000
*       THEN                        /*                       @Y30LB12*/ 04063000
         LA    @07,11                                              1002 04064000
         LR    @01,J                                               1002 04065000
         MR    @00,@07                                             1002 04066000
         LA    @05,ADR2SPEC-11(@01)                                1002 04067000
         TM    0(@05),B'10000000'                                  1002 04068000
         BNO   @RF01002                                            1002 04069000
*       IF USESPEC(I,J)='0'B        /* NOT USED BEFORE       @Y30LB12*/ 04070000
*         THEN                      /*                       @Y30LB12*/ 04071000
         LR    @09,I                                               1003 04072000
         SLA   @09,6                                               1003 04073000
         ALR   @09,J                                               1003 04074000
         MR    @08,@07                                             1003 04075000
         L     @07,COMPTR2(,R4)                                    1003 04076000
         ST    @09,@TF00001                                        1003 04077000
         ALR   @09,@07                                             1003 04078000
         AL    @09,@CF00781                                        1003 04079000
         TM    USESPEC-464(@09),B'10000000'                        1003 04080000
         BNZ   @RF01003                                            1003 04081000
*         CONFGDEV(I,J)=WK2ADDR(J); /* MOVE IT               @Y30LB12*/ 04082000
         AL    @07,@TF00001                                        1004 04083000
         AL    @07,@CF00781                                        1004 04084000
         LA    @05,WK2ADDR-11(@01)                                 1004 04085000
         MVC   CONFGDEV-464(11,@07),0(@05)                         1004 04086000
*       ELSE                        /*                       @Y30LB12*/ 04087000
*         DO;                       /*                       @Y30LB12*/ 04088000
*                                                                  1005 04089000
         B     @RC01003                                            1005 04090000
@RF01003 DS    0H                                                  1006 04091000
*           /*********************************************************/ 04092000
*           /*                                                       */ 04093000
*           /* ***********************************           @Y30LB12*/ 04094000
*           /* ICG237I ADDRESS XX PREVIOUSLY                 @Y30LB12*/ 04095000
*           /* SPECIFIED                                     @Y30LB12*/ 04096000
*           /* ***********************************           @Y30LB12*/ 04097000
*           /*                                                       */ 04098000
*           /*********************************************************/ 04099000
*                                                                  1006 04100000
*           OUTBUF2(1:40)=ICGDS237; /*                       @Y30LB12*/ 04101000
         MVC   OUTBUF2(40,R4),ICGDS237                             1006 04102000
*           OUTBUF2(18:19)=PATTERN(J);/*                     @Y30LB12*/ 04103000
         LR    @07,J                                               1007 04104000
         ALR   @07,@07                                             1007 04105000
         LA    @05,PATTERN-2(@07)                                  1007 04106000
         MVC   OUTBUF2+17(2,R4),0(@05)                             1007 04107000
*           CALL PUTIT1;            /* TO MESSAGE WRITER     @Y30LB12*/ 04108000
         BAL   @14,PUTIT1                                          1008 04109000
*         END;                      /*                       @Y30LB12*/ 04110000
*     ELSE                                                         1010 04111000
*       ;                           /*                       @Y30LB12*/ 04112000
@RF01002 DS    0H                                                  1011 04113000
*   END;                            /* DID ALL 64 ADDRS      @Y30LB12*/ 04114000
@RC01002 AH    J,@CH00044                                          1011 04115000
@DE01001 CH    J,MAXDEV                                            1011 04116000
         BNH   @DL01001                                            1011 04117000
*   END S04BUILD;                   /* RET. TO MAINLINE      @Y30LB12*/ 04118000
         B     @EL00032                                            1012 04119000
*                                                                  1013 04120000
*/***********************************************************@Y30LB12*/ 04121000
*/*                                                          @Y30LB12*/ 04122000
*/* PROCEDURE NAME - READS99                                 @Y30LB12*/ 04123000
*/*                                                          @Y30LB12*/ 04124000
*/* FUNCTION - CALL SCAN READ KEYWORD/PARAMETER SUBROUTINE   @Y30LB12*/ 04125000
*/*            ICGDSS99.  PICK UP STARTING COLUMN FOR THIS   @Y30LB12*/ 04126000
*/*            SCAN AND STARTING COLUMN FOR NEXT ENTRY INTO  @Y30LB12*/ 04127000
*/*            ICGDSS99.  IF TERMINATING ERROR OCCURS IN     @Y30LB12*/ 04128000
*/*            ICGDSS99, SET 'LASTPARM' TO TERMINATE IN THIS @Y30LB12*/ 04129000
*/*            MODULE ON NEXT READ OF KEYWORD                @Y30LB12*/ 04130000
*/*                                                          @Y30LB12*/ 04131000
*/***********************************************************@Y30LB12*/ 04132000
*                                                                  1013 04133000
*READS99:                                                          1013 04134000
*   PROCEDURE;                      /*                       @Y30LB12*/ 04135000
READS99  STM   @14,@12,@SA00033                                    1013 04136000
*   GEN(LINK EP=ICGDSS99);          /* TO SCAN KEYWORD/PARAMETER     */ 04137000
*                                                                  1014 04138000
         LINK EP=ICGDSS99                                               04139000
*   /*****************************************************************/ 04140000
*   /*                                                               */ 04141000
*   /* ************************************************@Y30LB12 IF   */ 04142000
*   /* 'ENDSCAN' BIT IS ON, WE ENCOUNTERED SOME              @Y30LB12*/ 04143000
*   /* DISASTEROUS CONDITION THAT TERMINATED THE SCAN        @Y30LB12*/ 04144000
*   /* OF THIS CONTROL STATEMENT. THERE ERRORS ARE           @Y30LB12*/ 04145000
*   /* ASSOCIATED WITH SCANNING INTO COLUMN 73 AND           @Y30LB12*/ 04146000
*   /* WITH FINDING A FORMAT ERROR IN THE                    @Y30LB12*/ 04147000
*   /* CONTINUATION STATEMENT. SHOULD SUCH A                 @Y30LB12*/ 04148000
*   /* CONDITION OCCUR, WE TERMINATE SCAN OF THE             @Y30LB12*/ 04149000
*   /* CONTROL STATEMENT UPON READ OF THE NEXT               @Y30LB12*/ 04150000
*   /* KEYWORD.                                              @Y30LB12*/ 04151000
*   /* ************************************************@Y30LB12      */ 04152000
*   /*                                                               */ 04153000
*   /*****************************************************************/ 04154000
*                                                                  1015 04155000
*   IF ENDSCAN='1'B                 /*                       @Y30LB12*/ 04156000
*     THEN                          /*                       @Y30LB12*/ 04157000
         TM    ENDSCAN(R4),B'00010000'                             1015 04158000
         BNO   @RF01015                                            1015 04159000
*     LASTPARM='1'B;                /*                       @Y30LB12*/ 04160000
         OI    LASTPARM(R4),B'00001000'                            1016 04161000
*   ELSE                                                           1017 04162000
*     ;                             /*                       @Y30LB12*/ 04163000
@RF01015 DS    0H                                                  1018 04164000
*   END READS99;                    /*                       @Y30LB12*/ 04165000
@EL00033 DS    0H                                                  1018 04166000
@EF00033 DS    0H                                                  1018 04167000
@ER00033 LM    @14,@12,@SA00033                                    1018 04168000
         BR    @14                                                 1018 04169000
*                                                                  1019 04170000
*/***********************************************************@Y30LB12*/ 04171000
*/*                                                          @Y30LB12*/ 04172000
*/* PROCEDURE NAME - PUTIT1                                  @Y30LB12*/ 04173000
*/*                                                          @Y30LB12*/ 04174000
*/* FUNCTION - CALL ICGDSMSG, MESSAGE PRINT SUBROUTINE, TO   @Y30LB12*/ 04175000
*/*            PUT TERMINATING MESSAGE FOR WHICH TEXT IS NOT @Y30LB12*/ 04176000
*/*            IN ICGDSMSG BUT ALREADY BUILT IN 'OUTBUF2'    @Y30LB12*/ 04177000
*/*                                                          @Y30LB12*/ 04178000
*/***********************************************************@Y30LB12*/ 04179000
*                                                                  1019 04180000
*PUTIT1:                                                           1019 04181000
*   PROCEDURE;                      /*                       @Y30LB12*/ 04182000
PUTIT1   STM   @14,@12,@SA00034                                    1019 04183000
*   STOPSCAN='1'B;                  /*                       @Y30LB12*/ 04184000
         OI    STOPSCAN,B'00001000'                                1020 04185000
*   PRNTBUF2='1'B;                  /*                       @Y30LB12*/ 04186000
         OI    PRNTBUF2(R4),B'00000001'                            1021 04187000
*   TERMINAT=TERMINAT+1;            /*                       @Y30LB12*/ 04188000
         LA    @07,1                                               1022 04189000
         AH    @07,TERMINAT(,R4)                                   1022 04190000
         STH   @07,TERMINAT(,R4)                                   1022 04191000
*   GEN(LINK  EP=ICGDSMSG);         /*                       @Y30LB12*/ 04192000
         LINK  EP=ICGDSMSG                                              04193000
*   PRNTBUF2='0'B;                  /*                       @Y30LB12*/ 04194000
         NI    PRNTBUF2(R4),B'11111110'                            1024 04195000
*   END PUTIT1;                     /*                       @Y30LB12*/ 04196000
@EL00034 DS    0H                                                  1025 04197000
@EF00034 DS    0H                                                  1025 04198000
@ER00034 LM    @14,@12,@SA00034                                    1025 04199000
         BR    @14                                                 1025 04200000
*                                                                  1026 04201000
*/***********************************************************@Y30LB12*/ 04202000
*/*                                                          @Y30LB12*/ 04203000
*/* PROCEDURE NAME - PUTIT2                                  @Y30LB12*/ 04204000
*/*                                                          @Y30LB12*/ 04205000
*/* FUNCTION - CALL ICGDSMSG, MESSAGE PRINT SUBROUTINE, TO   @Y30LB12*/ 04206000
*/*            PUT TERMINATING MESSAGE FOR WHICH MESSAGE     @Y30LB12*/ 04207000
*/*            TEXT IS IN ICGDSMSG.  'MSGNO' INDICATES THE   @Y30LB12*/ 04208000
*/*            OFFSET OF THE MESSAGE TEXT.                   @Y30LB12*/ 04209000
*/*                                                          @Y30LB12*/ 04210000
*/***********************************************************@Y30LB12*/ 04211000
*                                                                  1026 04212000
*PUTIT2:                                                           1026 04213000
*   PROCEDURE;                      /*                       @Y30LB12*/ 04214000
PUTIT2   STM   @14,@12,@SA00035                                    1026 04215000
*   STOPSCAN='1'B;                  /*                       @Y30LB12*/ 04216000
         OI    STOPSCAN,B'00001000'                                1027 04217000
*   TERMINAT=TERMINAT+1;            /*                       @Y30LB12*/ 04218000
         LA    @07,1                                               1028 04219000
         AH    @07,TERMINAT(,R4)                                   1028 04220000
         STH   @07,TERMINAT(,R4)                                   1028 04221000
*   GEN(LINK  EP=ICGDSMSG);         /*                       @Y30LB12*/ 04222000
         LINK  EP=ICGDSMSG                                              04223000
*   END PUTIT2;                     /*                       @Y30LB12*/ 04224000
@EL00035 DS    0H                                                  1030 04225000
@EF00035 DS    0H                                                  1030 04226000
@ER00035 LM    @14,@12,@SA00035                                    1030 04227000
         BR    @14                                                 1030 04228000
*                                                                  1031 04229000
*/********************************************************** @Y30LB12*/ 04230000
*/*                 P A T C H   A R E A                      @Y30LB12*/ 04231000
*/********************************************************** @Y30LB12*/ 04232000
*                                                                  1031 04233000
*   GENERATE;                                                      1031 04234000
*                                                         /*@Y30LB12*/  04235000
PATCHS04 DC    32C'PATCHS04'                              /*@Y30LB12*/  04236000
*   END ICGDSS04                    /*                       @Y30LB12*/ 04237000
*                                                                  1032 04238000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 04239000
*/*%INCLUDE SYSLIB  (ICGDSMAC)                                       */ 04240000
*/*%INCLUDE SYSLIB  (ICGDSMA1)                                       */ 04241000
*/*%INCLUDE SYSLIB  (ICGDSMA2)                                       */ 04242000
*/*%INCLUDE SYSLIB  (ICGDSMA3)                                       */ 04243000
*                                                                  1032 04244000
*       ;                                                          1032 04245000
         B     @EL00001                                            1032 04246000
@DATA    DS    0H                                                       04247000
@CH00044 DC    H'1'                                                     04248000
@CH00052 DC    H'2'                                                     04249000
@CH00050 DC    H'3'                                                     04250000
@CH00070 DC    H'4'                                                     04251000
@CH00121 DC    H'5'                                                     04252000
@CH00114 DC    H'9'                                                     04253000
@CH00448 DC    H'10'                                                    04254000
@CH00257 DC    H'11'                                                    04255000
@DATD    DSECT                                                          04256000
         DS    0F                                                       04257000
@SA00001 DS    18F                                                      04258000
@SA00003 DS    15F                                                      04259000
@SA00027 DS    15F                                                      04260000
@SA00032 DS    15F                                                      04261000
@SA00033 DS    15F                                                      04262000
@SA00035 DS    15F                                                      04263000
@SA00006 DS    15F                                                      04264000
@SA00007 DS    15F                                                      04265000
@SA00008 DS    15F                                                      04266000
@SA00010 DS    15F                                                      04267000
@SA00012 DS    15F                                                      04268000
@SA00016 DS    15F                                                      04269000
@SA00005 DS    15F                                                      04270000
@SA00020 DS    15F                                                      04271000
@SA00034 DS    15F                                                      04272000
@SA00015 DS    15F                                                      04273000
@SA00026 DS    15F                                                      04274000
@SA00009 DS    15F                                                      04275000
@SA00013 DS    15F                                                      04276000
@SA00014 DS    15F                                                      04277000
@SA00021 DS    15F                                                      04278000
@SA00017 DS    15F                                                      04279000
@SA00018 DS    15F                                                      04280000
@SA00022 DS    15F                                                      04281000
@SA00023 DS    15F                                                      04282000
@SA00024 DS    15F                                                      04283000
@SA00025 DS    15F                                                      04284000
@SA00028 DS    15F                                                      04285000
@SA00029 DS    15F                                                      04286000
@SA00030 DS    15F                                                      04287000
@SA00031 DS    15F                                                      04288000
@TF00001 DS    F                                                        04289000
@ZTEMPS  DS    0F                                                       04290000
@ZT00002 DC    F'0'                                                     04291000
@ZT00003 DC    F'0'                                                     04292000
@ZTEMPND EQU   *                                                        04293000
@ZLEN    EQU   @ZTEMPND-@ZTEMPS                                         04294000
ICGDSS04 CSECT                                                          04295000
         DS    0F                                                       04296000
@CF00781 DC    F'-251'                                                  04297000
@DATD    DSECT                                                          04298000
         DS    0D                                                       04299000
@TS00001 DS    CL1                                                      04300000
         DS    CL7                                                      04301000
UPCWORKA DS    CL1479                                                   04302000
         ORG   UPCWORKA                                                 04303000
PACKWORK DS    CL8                                                      04304000
BININDEX DS    FL2                                                      04305000
HEXINDEX DS    FL2                                                      04306000
DSINDEX  DS    FL2                                                      04307000
WORKNUM  DS    FL2                                                      04308000
ALTCOUNT DS    FL2                                                      04309000
ALTINDEX DS    FL2                                                      04310000
WORKHEX2 DS    CL2                                                      04311000
WORKA    DS    CL2                                                      04312000
WORKB    DS    CL2                                                      04313000
WORKRSG  DS    CL2                                                      04314000
         ORG   WORKRSG                                                  04315000
HIGHRSG  DS    BL1                                                      04316000
@NM00019 EQU   WORKRSG+0                                                04317000
LOWRSG   DS    BL1                                                      04318000
@NM00020 EQU   WORKRSG+1                                                04319000
         ORG   UPCWORKA+28                                              04320000
ALTRSG   DS    CL1                                                      04321000
WORKCI   DS    CL1                                                      04322000
WKCIALT  DS    CL1                                                      04323000
WORKCU   DS    FL1                                                      04324000
WORKCH   DS    CL1                                                      04325000
WORKCPU  DS    CL5                                                      04326000
ALTPATHS DS    CL12                                                     04327000
         ORG   ALTPATHS                                                 04328000
ALTPATH  DS    CL4                                                      04329000
         ORG   ALTPATH+0                                                04330000
ALTHAVES DS    BL1                                                      04331000
         ORG   ALTHAVES+0                                               04332000
HAVEACH  DS    BL1                                                      04333000
HAVEACI  EQU   ALTHAVES+0                                               04334000
HAVEADS  EQU   ALTHAVES+0                                               04335000
@NM00021 EQU   ALTHAVES+0                                               04336000
         ORG   ALTPATH+1                                                04337000
WORKADS  DS    CL1                                                      04338000
WORKACI  DS    CL1                                                      04339000
WORKACH  DS    CL1                                                      04340000
         ORG   UPCWORKA+50                                              04341000
HEXCHAR  DS    CL1                                                      04342000
         ORG   HEXCHAR                                                  04343000
HIGHHEX  DS    BL1                                                      04344000
@NM00022 EQU   HEXCHAR+0                                                04345000
         ORG   UPCWORKA+51                                              04346000
BINCHAR  DS    CL2                                                      04347000
PLUGIN   DS    CL8                                                      04348000
PLUGIN2  DS    CL8                                                      04349000
WK1ADDRS DS    CL11                                                     04350000
         ORG   WK1ADDRS+0                                               04351000
WK1ADDR  DS    CL11                                                     04352000
         ORG   WK1ADDR+0                                                04353000
WK1FLAGS DS    BL1                                                      04354000
         ORG   WK1FLAGS+0                                               04355000
ADR1SPEC DS    BL1                                                      04356000
ADR1V    EQU   WK1FLAGS+0                                               04357000
ADR1VS   EQU   WK1FLAGS+0                                               04358000
ADR1REAL EQU   WK1FLAGS+0                                               04359000
@NM00023 EQU   WK1FLAGS+0                                               04360000
ADR1CONV EQU   WK1FLAGS+0                                               04361000
@NM00024 EQU   WK1FLAGS+0                                               04362000
         ORG   WK1ADDR+1                                                04363000
WK1RSG   DS    BL1                                                      04364000
WK1ADS1  DS    BL1                                                      04365000
WK1ACI1  DS    BL1                                                      04366000
WK1ACH1  DS    BL1                                                      04367000
WK1ADS2  DS    BL1                                                      04368000
WK1ACI2  DS    BL1                                                      04369000
WK1ACH2  DS    BL1                                                      04370000
WK1ADS3  DS    BL1                                                      04371000
WK1ACI3  DS    BL1                                                      04372000
WK1ACH3  DS    BL1                                                      04373000
         ORG   UPCWORKA+773                                             04374000
WK2ADDRS DS    CL11                                                     04375000
         ORG   WK2ADDRS+0                                               04376000
WK2ADDR  DS    CL11                                                     04377000
         ORG   WK2ADDR+0                                                04378000
WK2FLAGS DS    BL1                                                      04379000
         ORG   WK2FLAGS+0                                               04380000
ADR2SPEC DS    BL1                                                      04381000
ADR2V    EQU   WK2FLAGS+0                                               04382000
ADR2VS   EQU   WK2FLAGS+0                                               04383000
ADR2REAL EQU   WK2FLAGS+0                                               04384000
@NM00025 EQU   WK2FLAGS+0                                               04385000
ADR2CONV EQU   WK2FLAGS+0                                               04386000
@NM00026 EQU   WK2FLAGS+0                                               04387000
         ORG   WK2ADDR+1                                                04388000
WK2RSG   DS    BL1                                                      04389000
WK2ADS1  DS    BL1                                                      04390000
WK2ACI1  DS    BL1                                                      04391000
WK2ACH1  DS    BL1                                                      04392000
WK2ADS2  DS    BL1                                                      04393000
WK2ACI2  DS    BL1                                                      04394000
WK2ACH2  DS    BL1                                                      04395000
WK2ADS3  DS    BL1                                                      04396000
WK2ACI3  DS    BL1                                                      04397000
WK2ACH3  DS    BL1                                                      04398000
         ORG   UPCWORKA+1477                                            04399000
HAVES    DS    CL1                                                      04400000
         ORG   HAVES                                                    04401000
HAVEDS   DS    BL1                                                      04402000
HAVECI   EQU   HAVES+0                                                  04403000
HAVECH   EQU   HAVES+0                                                  04404000
HAVECU   EQU   HAVES+0                                                  04405000
HAVECPU  EQU   HAVES+0                                                  04406000
HAVERSG  EQU   HAVES+0                                                  04407000
HAVEALTP EQU   HAVES+0                                                  04408000
HAVEADDR EQU   HAVES+0                                                  04409000
         ORG   UPCWORKA+1478                                            04410000
UPCMSGID DS    CL1                                                      04411000
         ORG   UPCMSGID                                                 04412000
KNOWN    DS    BL1                                                      04413000
KNOWN2   EQU   UPCMSGID+0                                               04414000
KNOWN3   EQU   UPCMSGID+0                                               04415000
ERROR    EQU   UPCMSGID+0                                               04416000
STOPSCAN EQU   UPCMSGID+0                                               04417000
ALTPDUN  EQU   UPCMSGID+0                                               04418000
HAVENUM  EQU   UPCMSGID+0                                               04419000
         ORG   UPCWORKA+1479                                            04420000
PACKED   DS    CL6                                                      04421000
UNPACKED DS    CL11                                                     04422000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                04423000
@ENDDATD EQU   *                                                        04424000
ICGDSS04 CSECT                                                          04425000
         DS    0F                                                       04426000
@SIZDATD DC    AL1(0)                                                   04427000
         DC    AL3(@ENDDATD-@DATD)                                      04428000
         DS    0D                                                       04429000
ICG209I  DC    H'209'                                                   04430000
ICG210I  DC    H'210'                                                   04431000
ICG211I  DC    H'211'                                                   04432000
ICG230I  DC    H'230'                                                   04433000
ICG249I  DC    H'249'                                                   04434000
MAXALT   DC    H'3'                                                     04435000
MAXDEV   DC    H'64'                                                    04436000
MAXREAL  DC    H'32'                                                    04437000
MAXRSG   DC    H'27'                                                    04438000
@CC00712 DC    C'SA FOR ALTPATH'                                        04439000
@CC00714 DC    C'CH FOR ALTPATH'                                        04440000
@CC00716 DC    C'CI FOR ALTPATH'                                        04441000
@CC00693 DC    C'SA (ALTPATH)'                                          04442000
@CC00700 DC    C'CH (ALTPATH)'                                          04443000
@CC00706 DC    C'CI (ALTPATH)'                                          04444000
@CC00745 DC    C'(ALTPATH SA)'                                          04445000
@CC00584 DC    C'CONVREAL='                                             04446000
@CC00568 DC    C'V, ADDR '                                              04447000
@CC00573 DC    C'VS, ADDR'                                              04448000
@CC00575 DC    C'REAL    '                                              04449000
@CC00586 EQU   @CC00584                                                 04450000
@CC00601 DC    C'SA      '                                              04451000
@CC00618 DC    C'CH      '                                              04452000
@CC00649 DC    C'ALTPATH='                                              04453000
@CC00696 DC    C'SA (ALT)'                                              04454000
@CC00702 DC    C'CH (ALT)'                                              04455000
@CC00738 DC    C'ALTPATH1'                                              04456000
@CC00739 DC    C'ALTPATH2'                                              04457000
@CC00740 DC    C'ALTPATH3'                                              04458000
@CC00562 DC    C'CPUID='                                                04459000
@CC00560 DC    C'CUID='                                                 04460000
@CC00574 DC    C'REAL='                                                 04461000
@CC00636 EQU   @CC00562                                                 04462000
@CC00656 DC    C'ADDR='                                                 04463000
@CC00579 EQU   @CC00575                                                 04464000
@CC00627 EQU   @CC00560                                                 04465000
@CC00654 DC    C'SDG='                                                  04466000
@CC00661 EQU   @CC00656                                                 04467000
@CC00554 DC    C'SA='                                                   04468000
@CC00556 DC    C'CI='                                                   04469000
@CC00558 DC    C'CH='                                                   04470000
@CC00572 DC    C'VS='                                                   04471000
@CC00659 EQU   @CC00654                                                 04472000
@CC00383 DC    C'00'                                                    04473000
@CC00384 DC    C'01'                                                    04474000
@CC00399 DC    C'10'                                                    04475000
@CC00400 DC    C'11'                                                    04476000
@CC00564 DC    C'V='                                                    04477000
@CC00600 EQU   @CC00712                                                 04478000
@CC00606 EQU   @CC00716                                                 04479000
@CC00617 EQU   @CC00714                                                 04480000
@CB00566 DC    X'000000000000000000000000'                              04481000
@CB00531 EQU   @CB00566                                                 04482000
@CB00671 EQU   @CB00566                                                 04483000
@CB00665 EQU   @CB00566                                                 04484000
ICGDS219 DC    CL27' ICG219I DUPLICATE KEYWORD '                        04485000
ICGDS220 DC    CL46' ICG220I INVALID PARAMETER LENGTH, KEYWORD IS '     04486000
ICGDS221 DC    CL34' ICG221I MISSING REQUIRED KEYWORD '                 04487000
ICGDS223 DC    CL25' ICG223I VALUE ERROR FOR '                          04488000
ICGDS226 DC    CL44' ICG226I DUPLICATE SPECIFICATION FOR DEVICE '       04489000
ICGDS227 DC    CL51' ICG227I PARAMETER MUST BE HEXADECIMAL. KEYWORD IS C04490000
               '                                                        04491000
ICGDS228 DC    CL47' ICG228I PARAMETER MUST BE NUMERIC. KEYWORD IS '    04492000
ICGDS232 DC    CL44' ICG232I SA INTERFACES TO MORE THAN TWO SDGS'       04493000
ICGDS237 DC    CL40' ICG237I ADDRESS XX PREVIOUSLY SPECIFIED'           04494000
ICGDS238 DC    CL32' ICG238I ADDRESS XX INVALID FOR '                   04495000
INITDEV  DC    X'0000000000000000000000'                                04496000
PATTERN  DC    CL2'00'                                                  04497000
         DC    CL2'01'                                                  04498000
         DC    CL2'02'                                                  04499000
         DC    CL2'03'                                                  04500000
         DC    CL2'04'                                                  04501000
         DC    CL2'05'                                                  04502000
         DC    CL2'06'                                                  04503000
         DC    CL2'07'                                                  04504000
         DC    CL2'08'                                                  04505000
         DC    CL2'09'                                                  04506000
         DC    CL2'0A'                                                  04507000
         DC    CL2'0B'                                                  04508000
         DC    CL2'0C'                                                  04509000
         DC    CL2'0D'                                                  04510000
         DC    CL2'0E'                                                  04511000
         DC    CL2'0F'                                                  04512000
         DC    CL2'10'                                                  04513000
         DC    CL2'11'                                                  04514000
         DC    CL2'12'                                                  04515000
         DC    CL2'13'                                                  04516000
         DC    CL2'14'                                                  04517000
         DC    CL2'15'                                                  04518000
         DC    CL2'16'                                                  04519000
         DC    CL2'17'                                                  04520000
         DC    CL2'18'                                                  04521000
         DC    CL2'19'                                                  04522000
         DC    CL2'1A'                                                  04523000
         DC    CL2'1B'                                                  04524000
         DC    CL2'1C'                                                  04525000
         DC    CL2'1D'                                                  04526000
         DC    CL2'1E'                                                  04527000
         DC    CL2'1F'                                                  04528000
         DC    CL2'20'                                                  04529000
         DC    CL2'21'                                                  04530000
         DC    CL2'22'                                                  04531000
         DC    CL2'23'                                                  04532000
         DC    CL2'24'                                                  04533000
         DC    CL2'25'                                                  04534000
         DC    CL2'26'                                                  04535000
         DC    CL2'27'                                                  04536000
         DC    CL2'28'                                                  04537000
         DC    CL2'29'                                                  04538000
         DC    CL2'2A'                                                  04539000
         DC    CL2'2B'                                                  04540000
         DC    CL2'2C'                                                  04541000
         DC    CL2'2D'                                                  04542000
         DC    CL2'2E'                                                  04543000
         DC    CL2'2F'                                                  04544000
         DC    CL2'30'                                                  04545000
         DC    CL2'31'                                                  04546000
         DC    CL2'32'                                                  04547000
         DC    CL2'33'                                                  04548000
         DC    CL2'34'                                                  04549000
         DC    CL2'35'                                                  04550000
         DC    CL2'36'                                                  04551000
         DC    CL2'37'                                                  04552000
         DC    CL2'38'                                                  04553000
         DC    CL2'39'                                                  04554000
         DC    CL2'3A'                                                  04555000
         DC    CL2'3B'                                                  04556000
         DC    CL2'3C'                                                  04557000
         DC    CL2'3D'                                                  04558000
         DC    CL2'3E'                                                  04559000
         DC    CL2'3F'                                                  04560000
PATTERN2 DC    CL1'0'                                                   04561000
         DC    CL1'1'                                                   04562000
         DC    CL1'2'                                                   04563000
         DC    CL1'3'                                                   04564000
         DC    CL1'4'                                                   04565000
         DC    CL1'5'                                                   04566000
         DC    CL1'6'                                                   04567000
         DC    CL1'7'                                                   04568000
         DC    CL1'8'                                                   04569000
         DC    CL1'9'                                                   04570000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       04571000
@01      EQU   01                                                       04572000
@02      EQU   02                                                       04573000
@03      EQU   03                                                       04574000
@04      EQU   04                                                       04575000
@05      EQU   05                                                       04576000
@06      EQU   06                                                       04577000
@07      EQU   07                                                       04578000
@08      EQU   08                                                       04579000
@09      EQU   09                                                       04580000
@10      EQU   10                                                       04581000
@11      EQU   11                                                       04582000
@12      EQU   12                                                       04583000
@13      EQU   13                                                       04584000
@14      EQU   14                                                       04585000
@15      EQU   15                                                       04586000
J        EQU   @03                                                      04587000
I        EQU   @02                                                      04588000
R11      EQU   @11                                                      04589000
R10      EQU   @10                                                      04590000
R4       EQU   @04                                                      04591000
R6       EQU   @06                                                      04592000
COMTAB   EQU   0                                                        04593000
READER   EQU   COMTAB+256                                               04594000
READFLAG EQU   READER+96                                                04595000
KEYBIT   EQU   READFLAG                                                 04596000
PARMBIT  EQU   READFLAG                                                 04597000
ENDSCAN  EQU   READFLAG                                                 04598000
LASTPARM EQU   READFLAG                                                 04599000
PCHBF    EQU   READER+99                                                04600000
STARTCOL EQU   READER+180                                               04601000
NEXTCOL  EQU   READER+184                                               04602000
SAVESCOL EQU   READER+188                                               04603000
SAVENCOL EQU   READER+192                                               04604000
SCANLEN  EQU   READER+204                                               04605000
PRINTER  EQU   COMTAB+464                                               04606000
OUTBUF2  EQU   PRINTER+225                                              04607000
MESSAGES EQU   COMTAB+810                                               04608000
MSGNO    EQU   MESSAGES+2                                               04609000
TERMINAT EQU   MESSAGES+6                                               04610000
SPECLMSG EQU   MESSAGES+18                                              04611000
PRNTBUF2 EQU   SPECLMSG                                                 04612000
GENIO    EQU   COMTAB+832                                               04613000
DCBPTR   EQU   GENIO+4                                                  04614000
COMPTR2  EQU   GENIO+16                                                 04615000
INVOKED  EQU   COMTAB+856                                               04616000
SAVEDDS  EQU   INVOKED+4                                                04617000
BUILDRSG EQU   COMTAB+900                                               04618000
RSGS     EQU   BUILDRSG                                                 04619000
RSG      EQU   RSGS                                                     04620000
RSGABOX  EQU   RSG                                                      04621000
RSGTODS  EQU   RSG+7                                                    04622000
LIBRARY  EQU   COMTAB+1170                                              04623000
LIBS     EQU   LIBRARY                                                  04624000
LIB      EQU   LIBS                                                     04625000
LIBBITS  EQU   LIB                                                      04626000
PABTABLE EQU   COMTAB+1218                                              04627000
PABDEV   EQU   PABTABLE                                                 04628000
PABFLAGS EQU   PABDEV                                                   04629000
PABREAL  EQU   PABDEV+1                                                 04630000
PABAADDD EQU   PABDEV+2                                                 04631000
DSPAIRS  EQU   COMTAB+1938                                              04632000
PHYSTYPE EQU   COMTAB+2002                                              04633000
PHYSFLGS EQU   PHYSTYPE                                                 04634000
CPUASSOC EQU   COMTAB+3026                                              04635000
CPUS     EQU   CPUASSOC+2                                               04636000
CPU      EQU   CPUS                                                     04637000
CPUFLAG1 EQU   CPU+6                                                    04638000
OPSYSTYP EQU   CPUFLAG1                                                 04639000
CPUFLAG2 EQU   CPU+7                                                    04640000
LOWERCON EQU   COMTAB+3156                                              04641000
LOWDSS   EQU   LOWERCON                                                 04642000
LOWFLGS  EQU   LOWDSS                                                   04643000
LIBCTL   EQU   COMTAB+3284                                              04644000
LIBCTLS  EQU   LIBCTL                                                   04645000
CREATE   EQU   COMTAB+3288                                              04646000
@NM00017 EQU   CREATE                                                   04647000
COMTAB2  EQU   0                                                        04648000
DSTORSG  EQU   COMTAB2                                                  04649000
DSENTRY  EQU   DSTORSG                                                  04650000
TORSG1   EQU   DSENTRY                                                  04651000
TORSG2   EQU   DSENTRY+1                                                04652000
CONFGCON EQU   COMTAB2+32                                               04653000
RSGUCB   EQU   CONFGCON                                                 04654000
RSGFLAGS EQU   RSGUCB                                                   04655000
CISPEC   EQU   RSGFLAGS                                                 04656000
RSGCPUID EQU   RSGUCB+1                                                 04657000
RSGCHAN  EQU   RSGUCB+7                                                 04658000
RSGCUA   EQU   RSGUCB+8                                                 04659000
CONFGUCB EQU   COMTAB2+464                                              04660000
CONFGDEV EQU   CONFGUCB                                                 04661000
USEFLAGS EQU   CONFGDEV                                                 04662000
USESPEC  EQU   USEFLAGS                                                 04663000
ALTPATH1 EQU   CONFGDEV+2                                               04664000
ALTPATH2 EQU   CONFGDEV+5                                               04665000
ALTPATH3 EQU   CONFGDEV+8                                               04666000
SCANDATA EQU   0                                                        04667000
SCANBUF  EQU   0                                                        04668000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    04669000
ALTCH3   EQU   ALTPATH3+2                                               04670000
ALTCI3   EQU   ALTPATH3+1                                               04671000
ALTDS3   EQU   ALTPATH3                                                 04672000
ALTCH2   EQU   ALTPATH2+2                                               04673000
ALTCI2   EQU   ALTPATH2+1                                               04674000
ALTDS2   EQU   ALTPATH2                                                 04675000
ALTCH1   EQU   ALTPATH1+2                                               04676000
ALTCI1   EQU   ALTPATH1+1                                               04677000
ALTDS1   EQU   ALTPATH1                                                 04678000
INDEXRSG EQU   CONFGDEV+1                                               04679000
ICEBERG  EQU   USEFLAGS                                                 04680000
ITISALTP EQU   USEFLAGS                                                 04681000
USECONVR EQU   USEFLAGS                                                 04682000
SUPPUNCH EQU   USEFLAGS                                                 04683000
USEREAL  EQU   USEFLAGS                                                 04684000
USEVS    EQU   USEFLAGS                                                 04685000
USEV     EQU   USEFLAGS                                                 04686000
CPUREFNO EQU   RSGUCB+6                                                 04687000
@NM00018 EQU   RSGFLAGS                                                 04688000
COM2BASE EQU   COMTAB+3304                                              04689000
LRUCLOCK EQU   CREATE+11                                                04690000
VOLSER   EQU   CREATE+5                                                 04691000
VPAGES   EQU   CREATE+1                                                 04692000
DINTIND  EQU   @NM00017                                                 04693000
CINTIND  EQU   @NM00017                                                 04694000
BINTIND  EQU   @NM00017                                                 04695000
CYLFAULT EQU   @NM00017                                                 04696000
PRNTONLY EQU   @NM00017                                                 04697000
UPDCREAT EQU   @NM00017                                                 04698000
NEWCREAT EQU   @NM00017                                                 04699000
CMDCREAT EQU   @NM00017                                                 04700000
RW67RGHT EQU   LIBCTLS                                                  04701000
RW67LEFT EQU   LIBCTLS                                                  04702000
RW45RGHT EQU   LIBCTLS                                                  04703000
RW45LEFT EQU   LIBCTLS                                                  04704000
RW23RGHT EQU   LIBCTLS                                                  04705000
RW23LEFT EQU   LIBCTLS                                                  04706000
RW01RGHT EQU   LIBCTLS                                                  04707000
RW01LEFT EQU   LIBCTLS                                                  04708000
LOWLIB   EQU   LOWDSS+1                                                 04709000
@NM00016 EQU   LOWFLGS                                                  04710000
LOWRGHT  EQU   LOWFLGS                                                  04711000
LOWLEFT  EQU   LOWFLGS                                                  04712000
LOWRW67  EQU   LOWFLGS                                                  04713000
LOWRW45  EQU   LOWFLGS                                                  04714000
LOWRW23  EQU   LOWFLGS                                                  04715000
LOWRW01  EQU   LOWFLGS                                                  04716000
LOWSPEC  EQU   LOWFLGS                                                  04717000
ALTMSCIN EQU   CPUFLAG2                                                 04718000
@NM00015 EQU   CPUFLAG2                                                 04719000
ALTMSGBF EQU   CPUFLAG2                                                 04720000
@NM00014 EQU   CPUFLAG2                                                 04721000
CPUSPEC  EQU   CPUFLAG2                                                 04722000
CPUMSCIN EQU   CPUFLAG1                                                 04723000
OPJES3   EQU   OPSYSTYP                                                 04724000
OPVS2    EQU   OPSYSTYP                                                 04725000
OPVS1    EQU   OPSYSTYP                                                 04726000
CPUALTFL EQU   CPUFLAG1                                                 04727000
CPUTIGHT EQU   CPUFLAG1                                                 04728000
@NM00013 EQU   CPUFLAG1                                                 04729000
TOMPCPU  EQU   CPU+5                                                    04730000
CPUID    EQU   CPU                                                      04731000
CPUNUM   EQU   CPUASSOC                                                 04732000
SPNRSGNO EQU   PHYSTYPE+1                                               04733000
LGDEVICE EQU   PHYSFLGS                                                 04734000
LOGABOX1 EQU   PHYSFLGS                                                 04735000
PHYSSSID EQU   PHYSFLGS                                                 04736000
PHYSREAL EQU   PHYSFLGS                                                 04737000
MERLICEB EQU   PHYSFLGS                                                 04738000
PHYSDS2  EQU   DSPAIRS                                                  04739000
PABDDD   EQU   PABAADDD                                                 04740000
PABAA    EQU   PABAADDD                                                 04741000
PABZEROS EQU   PABAADDD                                                 04742000
PAB2D    EQU   PABREAL                                                  04743000
PAB2C    EQU   PABREAL                                                  04744000
PAB2B    EQU   PABREAL                                                  04745000
@NM00012 EQU   PABREAL                                                  04746000
PAB1D    EQU   PABREAL                                                  04747000
PAB1C    EQU   PABREAL                                                  04748000
PAB1B    EQU   PABREAL                                                  04749000
PABIMPLR EQU   PABREAL                                                  04750000
PABBERG2 EQU   PABFLAGS                                                 04751000
@NM00011 EQU   PABFLAGS                                                 04752000
PABDSMTL EQU   PABFLAGS                                                 04753000
PABIBERG EQU   PABFLAGS                                                 04754000
@NM00010 EQU   PABFLAGS                                                 04755000
PABVOVIR EQU   PABFLAGS                                                 04756000
PABEXIST EQU   PABFLAGS                                                 04757000
MAPEXIT  EQU   LIB+4                                                    04758000
LIBMAP   EQU   LIB+3                                                    04759000
LIBDSMID EQU   LIB+2                                                    04760000
LIBSIZE  EQU   LIB+1                                                    04761000
@NM00009 EQU   LIBBITS                                                  04762000
LIBSPEC  EQU   LIBBITS                                                  04763000
TODS2    EQU   RSGTODS+1                                                04764000
TODS1    EQU   RSGTODS                                                  04765000
RSGSLICE EQU   RSG+3                                                    04766000
RSGUDEL  EQU   RSG+2                                                    04767000
RSGLDEL  EQU   RSG+1                                                    04768000
@NM00008 EQU   RSG                                                      04769000
RSGABOX1 EQU   RSGABOX                                                  04770000
RSGABOX0 EQU   RSGABOX                                                  04771000
RSGSPEC  EQU   RSG                                                      04772000
SVSYSUT3 EQU   SAVEDDS+32                                               04773000
SVSYSUT2 EQU   SAVEDDS+24                                               04774000
SVSYSUT1 EQU   SAVEDDS+16                                               04775000
SVSYSPCH EQU   SAVEDDS+8                                                04776000
SVSYSIN  EQU   SAVEDDS                                                  04777000
PARMPTR  EQU   INVOKED                                                  04778000
BUILDPTR EQU   GENIO+20                                                 04779000
SAVE14   EQU   GENIO+12                                                 04780000
EXLST    EQU   GENIO+8                                                  04781000
@NM00007 EQU   DCBPTR+1                                                 04782000
DCBFLAG  EQU   DCBPTR                                                   04783000
OPENLIST EQU   GENIO                                                    04784000
@NM00006 EQU   MESSAGES+19                                              04785000
NEEDEOJ  EQU   SPECLMSG                                                 04786000
ENDPHASE EQU   SPECLMSG                                                 04787000
@NM00005 EQU   SPECLMSG                                                 04788000
PRNTCARD EQU   SPECLMSG                                                 04789000
@NM00004 EQU   SPECLMSG                                                 04790000
NEED102  EQU   SPECLMSG                                                 04791000
NEED101  EQU   SPECLMSG                                                 04792000
PRINTRC  EQU   MESSAGES+16                                              04793000
TERM     EQU   MESSAGES+12                                              04794000
WARN     EQU   MESSAGES+8                                               04795000
WARNING  EQU   MESSAGES+4                                               04796000
RETCODE  EQU   MESSAGES                                                 04797000
OUTBUF   EQU   PRINTER+104                                              04798000
LINECT   EQU   PRINTER+102                                              04799000
LINECTR  EQU   PRINTER+100                                              04800000
PAGENO   EQU   PRINTER+96                                               04801000
DCBPRINT EQU   PRINTER                                                  04802000
@NM00003 EQU   READER+206                                               04803000
SVEODAD  EQU   READER+200                                               04804000
SVSYNAD2 EQU   READER+196                                               04805000
INBUF    EQU   READER+100                                               04806000
SSELECT  EQU   PCHBF                                                    04807000
@NM00002 EQU   READER+97                                                04808000
@NM00001 EQU   READFLAG                                                 04809000
READTERM EQU   READFLAG                                                 04810000
READDCB  EQU   READER                                                   04811000
PATCH    EQU   COMTAB                                                   04812000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      04813000
@RT00064 EQU   @EL00003                                                 04814000
@RC00325 EQU   @EL00008                                                 04815000
@RC00343 EQU   @EL00009                                                 04816000
@RC00378 EQU   @EL00010                                                 04817000
@RC00420 EQU   @EL00012                                                 04818000
@RC00429 EQU   @EL00013                                                 04819000
@RC00549 EQU   @EL00017                                                 04820000
@RC00567 EQU   @EL00018                                                 04821000
@RC00618 EQU   @RC00597                                                 04822000
@RC00598 EQU   @RC00597                                                 04823000
@RT00704 EQU   @EL00021                                                 04824000
@RC00772 EQU   @EL00023                                                 04825000
@RC00815 EQU   @EL00024                                                 04826000
@RF00825 EQU   @EL00025                                                 04827000
@RC00907 EQU   @RC00903                                                 04828000
@RC00905 EQU   @RC00903                                                 04829000
@RF00958 EQU   @RC00925                                                 04830000
@RC00952 EQU   @RC00925                                                 04831000
@RC00972 EQU   @EL00031                                                 04832000
@RF00971 EQU   @EL00031                                                 04833000
@RC00969 EQU   @EL00031                                                 04834000
@RC01003 EQU   @RC01002                                                 04835000
@RC00604 EQU   @RC00598                                                 04836000
@RC00627 EQU   @RC00618                                                 04837000
@RC00908 EQU   @RC00907                                                 04838000
@RC00605 EQU   @RC00604                                                 04839000
@ENDDATA EQU   *                                                        04840000
         END   ICGDSS04,(C'PLS1203',0701,78023)                         04841000
