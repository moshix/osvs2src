         TITLE 'ICGDSS05 MSC TABLE CREATE, SCAN LOWERCON STATEMENT     *00001000
                        '                                               00002000
ICGDSS05 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'ICGDSS05  76.337'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@12                                         0001 00013000
         L     @00,@SIZDATD                                        0001 00014000
         GETMAIN  R,LV=(0)                                              00015000
         LR    @11,@01                                             0001 00016000
         USING @DATD,@11                                           0001 00017000
         ST    @13,@SA00001+4                                      0001 00018000
         LM    @00,@01,20(@13)                                     0001 00019000
         ST    @11,8(,@13)                                         0001 00020000
         LR    @13,@11                                             0001 00021000
         XC    @ZTEMPS(@ZLEN),@ZTEMPS                                   00022000
*                                                                  0025 00023000
*/********************************************************** @Y30LB12*/ 00024000
*/*                                                          @Y30LB12*/ 00025000
*/*            ICGDSS05 (MAINLINE)                           @YD00113*/ 00026000
*/*                                                          @Y30LB12*/ 00027000
*/*            CALL S05INIT, S05SCAN, S05ANAL.  IF NO        @YD00113*/ 00028000
*/*            TERMINATING ERRORS, CALL S05BUILD             @Y30LB12*/ 00029000
*/*                                                          @Y30LB12*/ 00030000
*/********************************************************** @Y30LB12*/ 00031000
*                                                                  0025 00032000
*   CALL S05INIT;                   /* INITIALIZE            @Y30LB12*/ 00033000
         BAL   @14,S05INIT                                         0025 00034000
*   CALL S05SCAN;                   /* GET KEYWDS, PARMS     @Y30LB12*/ 00035000
         BAL   @14,S05SCAN                                         0026 00036000
*   CALL S05ANAL;                   /* CROSS-CHECK PARMS     @Y30LB12*/ 00037000
         BAL   @14,S05ANAL                                         0027 00038000
*   IF STOPSCAN^='1'B               /* IF NO TERM. ERROR     @Y30LB12*/ 00039000
*     THEN                          /*                       @Y30LB12*/ 00040000
         TM    STOPSCAN,B'10000000'                                0028 00041000
         BO    @RF00028                                            0028 00042000
*     CALL S05BUILD;                /* UPDATE LIB,LIBCTL     @Y30LB12*/ 00043000
         BAL   @14,S05BUILD                                        0029 00044000
*   ELSE                                                           0030 00045000
*     ;                             /*                       @Y30LB12*/ 00046000
@RF00028 DS    0H                                                  0031 00047000
*   RETURN;                         /* RET. TO ICGDSSCN      @Y30LB12*/ 00048000
@EL00001 L     @13,4(,@13)                                         0031 00049000
@EF00001 L     @00,@SIZDATD                                        0031 00050000
         LR    @01,@11                                             0031 00051000
         FREEMAIN R,LV=(0),A=(1)                                        00052000
@ER00001 LM    @14,@12,12(@13)                                     0031 00053000
         BR    @14                                                 0031 00054000
*                                                                  0032 00055000
*/********************************************************** @Y30LB12*/ 00056000
*/*                                                          @Y30LB12*/ 00057000
*/* PROCEDURE NAME - S05INIT                                 @Y30LB12*/ 00058000
*/*                                                          @Y30LB12*/ 00059000
*/* FUNCTION -  INITIALIZE LOCAL WORK AREA                   @Y30LB12*/ 00060000
*/*                                                          @Y30LB12*/ 00061000
*/********************************************************** @Y30LB12*/ 00062000
*                                                                  0032 00063000
*S05INIT:                                                          0032 00064000
*   PROCEDURE;                      /*                       @Y30LB12*/ 00065000
S05INIT  STM   @14,@12,12(@13)                                     0032 00066000
*   DSINDEX=0;                      /* DS PTR INTO TABLE     @Y30LB12*/ 00067000
         SLR   @10,@10                                             0033 00068000
         STH   @10,DSINDEX                                         0033 00069000
*   CUINDEX=0;                      /* CU PTR INTO TABLE     @Y30LB12*/ 00070000
         STH   @10,CUINDEX                                         0034 00071000
*   DO I=1 TO 4;                    /* 4 CUIDS PER DS        @Y30LB12*/ 00072000
         LA    @10,1                                               0035 00073000
         STH   @10,I                                               0035 00074000
@DL00035 DS    0H                                                  0036 00075000
*     CUIDS(I)='0000'X;             /* INIT TO ZEROS         @YM31085*/ 00076000
         LR    @05,@10                                             0036 00077000
         ALR   @05,@05                                             0036 00078000
         LA    @01,CUIDS-2(@05)                                    0036 00079000
         MVC   0(2,@01),@CB00394                                   0036 00080000
*     HAVEFLAG(I)='00'X;            /* CONTROL UNIT FLGS     @YM31085*/ 00081000
         LA    @05,HAVEFLAG-1(@10)                                 0037 00082000
         MVI   0(@05),X'00'                                        0037 00083000
*   END;                            /* END OF DO I           @Y30LB12*/ 00084000
         AH    @10,@CH00042                                        0038 00085000
         STH   @10,I                                               0038 00086000
         CH    @10,@CH00068                                        0038 00087000
         BNH   @DL00035                                            0038 00088000
*   HAVES='00'X;                    /* 'FOUND IT' FLAGS      @Y30LB12*/ 00089000
         MVI   HAVES,X'00'                                         0039 00090000
*   LOWMSGID='00'X;                 /* FLAG BYTE             @Y30LB12*/ 00091000
         MVI   LOWMSGID,X'00'                                      0040 00092000
*   END S05INIT;                    /* RET. TO MAINLINE      @Y30LB12*/ 00093000
@EL00002 DS    0H                                                  0041 00094000
@EF00002 DS    0H                                                  0041 00095000
@ER00002 LM    @14,@12,12(@13)                                     0041 00096000
         BR    @14                                                 0041 00097000
*                                                                  0042 00098000
*/********************************************************** @Y30LB12*/ 00099000
*/*                                                          @Y30LB12*/ 00100000
*/* PROCEDURE NAME - S05SCAN                                 @Y30LB12*/ 00101000
*/*                                                          @Y30LB12*/ 00102000
*/* FUNCTION - EXTRACT A KEYWORD FROM THE CONTROL STATEMENT  @Y30LB12*/ 00103000
*/*            AND DETERMINE THE ROUTINE TO BE CALLED TO     @Y30LB12*/ 00104000
*/*            HANDLE THE PARAMETER.                         @Y30LB12*/ 00105000
*/*                                                          @Y30LB12*/ 00106000
*/********************************************************** @Y30LB12*/ 00107000
*                                                                  0042 00108000
*S05SCAN:                                                          0042 00109000
*   PROCEDURE;                      /*                       @Y30LB12*/ 00110000
S05SCAN  STM   @14,@12,@SA00003                                    0042 00111000
*   DO WHILE(LASTPARM^='1'B);       /* TILL NO MORE DATA     @Y30LB12*/ 00112000
         B     @DE00043                                            0043 00113000
@DL00043 DS    0H                                                  0044 00114000
*     CALL READS99;                 /* EXTRACT KEYWORD       @Y30LB12*/ 00115000
         BAL   @14,READS99                                         0044 00116000
*     KNOWN='0'B;                   /* REC. KEYWORD FLAG     @Y30LB12*/ 00117000
*                                                                  0045 00118000
         NI    KNOWN,B'10111111'                                   0045 00119000
*     /***************************************************************/ 00120000
*     /*                                                             */ 00121000
*     /* ***********************************************     @Y30LB12*/ 00122000
*     /* LASTPARM IS SET BY ICGDSS99 WHEN NO MORE            @Y30LB12*/ 00123000
*     /* KEYWORDS OR PARAMETERS TO BE SCANNED FROM           @Y30LB12*/ 00124000
*     /* THIS STATEMENT.                                     @Y30LB12*/ 00125000
*     /* ***********************************************     @Y30LB12*/ 00126000
*     /*                                                             */ 00127000
*     /***************************************************************/ 00128000
*                                                                  0046 00129000
*     IF LASTPARM='1'B              /* IF END OF DATA        @Y30LB12*/ 00130000
*       THEN                        /*                       @Y30LB12*/ 00131000
         TM    LASTPARM(R4),B'00001000'                            0046 00132000
         BO    @RT00046                                            0046 00133000
*       RETURN;                     /* TO MAINLINE S05       @Y30LB12*/ 00134000
*     ELSE                                                         0048 00135000
*       ;                           /*                       @Y30LB12*/ 00136000
*     IF KEYBIT^='1'B               /* SET IN ICGDSS99       @Y30LB12*/ 00137000
*       THEN                        /*                       @Y30LB12*/ 00138000
         TM    KEYBIT(R4),B'01000000'                              0049 00139000
         BO    @RF00049                                            0049 00140000
*       DO;                         /*                       @Y30LB12*/ 00141000
*                                                                  0050 00142000
*         /***********************************************************/ 00143000
*         /*                                                         */ 00144000
*         /* *****************************************       @Y30LB12*/ 00145000
*         /* ICG209I EXPECTED, BUT DID NOT FIND,             @Y30LB12*/ 00146000
*         /* KEYWORD                                         @Y30LB12*/ 00147000
*         /* *****************************************       @Y30LB12*/ 00148000
*         /*                                                         */ 00149000
*         /***********************************************************/ 00150000
*                                                                  0051 00151000
*         MSGNO=ICG209I;            /* ID FOR ICGDS209       @Y30LB12*/ 00152000
         MVC   MSGNO(2,R4),ICG209I                                 0051 00153000
*         CALL PUTIT2;              /* TO MESSAGE WRITER     @Y30LB12*/ 00154000
         BAL   @14,PUTIT2                                          0052 00155000
*         RETURN;                   /* RET. TO MAINLINE      @Y30LB12*/ 00156000
@EL00003 DS    0H                                                  0053 00157000
@EF00003 DS    0H                                                  0053 00158000
@ER00003 LM    @14,@12,@SA00003                                    0053 00159000
         BR    @14                                                 0053 00160000
*       END;                        /*                       @Y30LB12*/ 00161000
*     ELSE                                                         0055 00162000
*       ;                           /*                       @Y30LB12*/ 00163000
*                                                                  0055 00164000
@RF00049 DS    0H                                                  0056 00165000
*     /***************************************************************/ 00166000
*     /*                                                             */ 00167000
*     /* ***********************************************     @Y30LB12*/ 00168000
*     /* IF THE KEYWORD SCANNED WAS 'SA', SET FLAG           @YD00113*/ 00169000
*     /* 'KNOWN' TO '1', AND CALL 'S05DS' TO GET THE         @YD00113*/ 00170000
*     /* PARAMETER                                           @YD00113*/ 00171000
*     /* ***********************************************     @Y30LB12*/ 00172000
*     /*                                                             */ 00173000
*     /***************************************************************/ 00174000
*                                                                  0056 00175000
*     IF SCANDATA(1:3)='SA='        /*                       @Y30LB12*/ 00176000
*       THEN                        /*                       @Y30LB12*/ 00177000
         L     @10,STARTCOL(,R4)                                   0056 00178000
         CLC   SCANDATA(3,@10),@CC00402                            0056 00179000
         BNE   @RF00056                                            0056 00180000
*       DO;                         /*                       @Y30LB12*/ 00181000
*         KNOWN='1'B;               /* RECOGNIZED KEYWD      @Y30LB12*/ 00182000
         OI    KNOWN,B'01000000'                                   0058 00183000
*         CALL S05DS;               /* TO GET PARAMETER      @Y30LB12*/ 00184000
         BAL   @14,S05DS                                           0059 00185000
*       END;                        /*                       @Y30LB12*/ 00186000
*     ELSE                                                         0061 00187000
*       ;                           /*                       @Y30LB12*/ 00188000
*                                                                  0061 00189000
@RF00056 DS    0H                                                  0062 00190000
*     /***************************************************************/ 00191000
*     /*                                                             */ 00192000
*     /* ***********************************************     @Y30LB12*/ 00193000
*     /* IF THE KEYWORD SCANNED WAS 'CUXX', SET FLAG         @YD00113*/ 00194000
*     /* 'KNOWN' TO '1', AND CALL 'S05DS' TO GET THE         @YD00113*/ 00195000
*     /* PARAMETER                                           @YD00113*/ 00196000
*     /* ***********************************************     @Y30LB12*/ 00197000
*     /*                                                             */ 00198000
*     /***************************************************************/ 00199000
*                                                                  0062 00200000
*     IF SCANDATA(1:2)='CU'         /*                       @Y30LB12*/ 00201000
*       THEN                        /*                       @Y30LB12*/ 00202000
         L     @10,STARTCOL(,R4)                                   0062 00203000
         CLC   SCANDATA(2,@10),@CC00404                            0062 00204000
         BNE   @RF00062                                            0062 00205000
*       DO;                         /*                       @Y30LB12*/ 00206000
*         KNOWN='1'B;               /* RECOGNIZED KEYWD      @Y30LB12*/ 00207000
         OI    KNOWN,B'01000000'                                   0064 00208000
*         CALL S05CUID;             /* TO GET PARAMETER      @Y30LB12*/ 00209000
         BAL   @14,S05CUID                                         0065 00210000
*       END;                        /*                       @Y30LB12*/ 00211000
*     ELSE                                                         0067 00212000
*       ;                           /*                       @Y30LB12*/ 00213000
*                                                                  0067 00214000
@RF00062 DS    0H                                                  0068 00215000
*     /***************************************************************/ 00216000
*     /*                                                             */ 00217000
*     /* ***********************************************     @Y30LB12*/ 00218000
*     /* IF THE KEYWORD SCANNED WAS NOT RECOGNIZED,          @YD00113*/ 00219000
*     /* CALL PROC 'UNKNOWN' TO PRINT MESSAGE AND            @YD00113*/ 00220000
*     /* POSITION TO NEXT KEYWORD.                           @YD00113*/ 00221000
*     /* ***********************************************     @Y30LB12*/ 00222000
*     /*                                                             */ 00223000
*     /***************************************************************/ 00224000
*                                                                  0068 00225000
*     IF KNOWN^='1'B                /* REC. KEYWORD FLAG     @Y30LB12*/ 00226000
*       THEN                        /*                       @Y30LB12*/ 00227000
         TM    KNOWN,B'01000000'                                   0068 00228000
         BO    @RF00068                                            0068 00229000
*       CALL UNKNOWN;               /* MSG AND POSITION      @Y30LB12*/ 00230000
         BAL   @14,UNKNOWN                                         0069 00231000
*     ELSE                                                         0070 00232000
*       ;                           /*                       @Y30LB12*/ 00233000
@RF00068 DS    0H                                                  0071 00234000
*   END;                            /* END OF DO WHILE       @Y30LB12*/ 00235000
@DE00043 TM    LASTPARM(R4),B'00001000'                            0071 00236000
         BNO   @DL00043                                            0071 00237000
*   END S05SCAN;                    /* RET. TO MAINLINE      @Y30LB12*/ 00238000
         B     @EL00003                                            0072 00239000
*                                                                  0073 00240000
*/********************************************************** @Y30LB12*/ 00241000
*/*                                                          @Y30LB12*/ 00242000
*/* PROCEDURE NAME - S05DS                                   @Y30LB12*/ 00243000
*/*                                                          @Y30LB12*/ 00244000
*/* FUNCTION - READ THE SA PARAMETER.  CHECK FOR DUPLICATE   @YM31085*/ 00245000
*/*            KEYWORD AND INCORRECT LENGTH.  IF NEITHER     @YD00113*/ 00246000
*/*            ERROR, CALL CONVHEX TO CONVERT THE            @Y30LB12*/ 00247000
*/*            CHARACTER REPRESENTATION OF THE HEXADECIMAL   @Y30LB12*/ 00248000
*/*            NUMBER TO ITS EQUIVALENT IN BINARY.           @YD00113*/ 00249000
*/*            SAVE THE VALUE IN DSINDEX.                    @Y30LB12*/ 00250000
*/*                                                          @Y30LB12*/ 00251000
*/********************************************************** @Y30LB12*/ 00252000
*                                                                  0073 00253000
*S05DS:                                                            0073 00254000
*   PROCEDURE;                      /*                       @Y30LB12*/ 00255000
S05DS    STM   @14,@12,@SA00004                                    0073 00256000
*   ERROR='0'B;                     /* RESET ERROR FLAG      @Y30LB12*/ 00257000
         NI    ERROR,B'11101111'                                   0074 00258000
*   CALL READS99;                   /* EXTRACT PARAMETER     @Y30LB12*/ 00259000
         BAL   @14,READS99                                         0075 00260000
*   IF HAVEDS^='1'B                 /*                       @Y30LB12*/ 00261000
*     THEN                          /*                       @Y30LB12*/ 00262000
         TM    HAVEDS,B'10000000'                                  0076 00263000
         BO    @RF00076                                            0076 00264000
*     HAVEDS='1'B;                  /*                       @Y30LB12*/ 00265000
         OI    HAVEDS,B'10000000'                                  0077 00266000
*   ELSE                            /*                       @Y30LB12*/ 00267000
*     DO;                           /*                       @Y30LB12*/ 00268000
*                                                                  0078 00269000
         B     @RC00076                                            0078 00270000
@RF00076 DS    0H                                                  0079 00271000
*       /*************************************************************/ 00272000
*       /*                                                           */ 00273000
*       /* *****************************************         @Y30LB12*/ 00274000
*       /* 'ICG219I DUPLICATE KEYWORD SA'                    @YM31085*/ 00275000
*       /* *****************************************         @Y30LB12*/ 00276000
*       /*                                                           */ 00277000
*       /*************************************************************/ 00278000
*                                                                  0079 00279000
*       OUTBUF2(1:27)=ICGDS219;     /*                       @Y30LB12*/ 00280000
         MVC   OUTBUF2(27,R4),ICGDS219                             0079 00281000
*       OUTBUF2(28:29)='SA';        /*                       @Y30LB12*/ 00282000
         MVC   OUTBUF2+27(2,R4),@CC00412                           0080 00283000
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/ 00284000
         BAL   @14,PUTIT1                                          0081 00285000
*       RETURN;                     /* RET. TO S05SCAN       @Y30LB12*/ 00286000
@EL00004 DS    0H                                                  0082 00287000
@EF00004 DS    0H                                                  0082 00288000
@ER00004 LM    @14,@12,@SA00004                                    0082 00289000
         BR    @14                                                 0082 00290000
*     END;                          /*                       @Y30LB12*/ 00291000
*   IF PARMBIT^='1'B                /* SET BY ICGDSS99       @Y30LB12*/ 00292000
*     THEN                          /*                       @Y30LB12*/ 00293000
@RC00076 TM    PARMBIT(R4),B'00100000'                             0084 00294000
         BO    @RF00084                                            0084 00295000
*     DO;                           /*                       @Y30LB12*/ 00296000
*                                                                  0085 00297000
*       /*************************************************************/ 00298000
*       /*                                                           */ 00299000
*       /* *****************************************         @Y30LB12*/ 00300000
*       /* ICG211I EXPECTED, BUT DID NOT FIND,               @Y30LB12*/ 00301000
*       /* PARAMETER                                         @Y30LB12*/ 00302000
*       /* *****************************************         @Y30LB12*/ 00303000
*       /*                                                           */ 00304000
*       /*************************************************************/ 00305000
*                                                                  0086 00306000
*       MSGNO=ICG211I;              /* ID FOR ICGDS211       @Y30LB12*/ 00307000
         MVC   MSGNO(2,R4),ICG211I                                 0086 00308000
*       CALL PUTIT2;                /* TO MESSAGE WRITER     @Y30LB12*/ 00309000
         BAL   @14,PUTIT2                                          0087 00310000
*       RETURN;                     /* RET. TO S05SCAN       @Y30LB12*/ 00311000
         B     @EL00004                                            0088 00312000
*     END;                          /*                       @Y30LB12*/ 00313000
*   ELSE                                                           0090 00314000
*     ;                             /*                       @Y30LB12*/ 00315000
@RF00084 DS    0H                                                  0091 00316000
*   IF SCANLEN^=1                   /* SET BY ICGDSS99       @Y30LB12*/ 00317000
*     THEN                          /*                       @Y30LB12*/ 00318000
         CLC   SCANLEN(2,R4),@CH00042                              0091 00319000
         BE    @RF00091                                            0091 00320000
*     DO;                           /*                       @Y30LB12*/ 00321000
*                                                                  0092 00322000
*       /*************************************************************/ 00323000
*       /*                                                           */ 00324000
*       /* *****************************************         @Y30LB12*/ 00325000
*       /* 'ICG220I INVALID PARAMETER LENGTH,                @Y30LB12*/ 00326000
*       /* KEYWORD IS SA'                                    @Y30LB12*/ 00327000
*       /* *****************************************         @Y30LB12*/ 00328000
*       /*                                                           */ 00329000
*       /*************************************************************/ 00330000
*                                                                  0093 00331000
*       ERROR='1'B;                 /* ERROR FLAG ON         @Y30LB12*/ 00332000
         OI    ERROR,B'00010000'                                   0093 00333000
*       OUTBUF2(1:46)=ICGDS220;     /*                       @Y30LB12*/ 00334000
         MVC   OUTBUF2(46,R4),ICGDS220                             0094 00335000
*       OUTBUF2(47:48)='SA';        /*                       @Y30LB12*/ 00336000
         MVC   OUTBUF2+46(2,R4),@CC00412                           0095 00337000
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/ 00338000
         BAL   @14,PUTIT1                                          0096 00339000
*     END;                          /*                       @Y30LB12*/ 00340000
*   ELSE                                                           0098 00341000
*     ;                             /*                       @Y30LB12*/ 00342000
@RF00091 DS    0H                                                  0099 00343000
*   IF ERROR^='1'B                  /* IF NO ERROR           @Y30LB12*/ 00344000
*     THEN                          /*                       @Y30LB12*/ 00345000
         TM    ERROR,B'00010000'                                   0099 00346000
         BO    @RF00099                                            0099 00347000
*     DO;                           /*                       @Y30LB12*/ 00348000
*       HEXCHAR=SCANDATA(1);        /* PASS VALUE            @Y30LB12*/ 00349000
         L     @10,STARTCOL(,R4)                                   0101 00350000
         MVC   HEXCHAR(1),SCANDATA(@10)                            0101 00351000
*       PLUGIN='SA      ';          /* FOR POSSIBLE MSG      @Y30LB12*/ 00352000
         MVC   PLUGIN(8),@CC00415                                  0102 00353000
*       CALL CONVHEX;               /* TRANSLATE VALUE       @Y30LB12*/ 00354000
         BAL   @14,CONVHEX                                         0103 00355000
*       DSINDEX=HEXINDEX;           /* HEXINDEX=HEXCHAR+1    @Y30LB12*/ 00356000
         MVC   DSINDEX(2),HEXINDEX                                 0104 00357000
*     END;                          /*                       @Y30LB12*/ 00358000
*   ELSE                                                           0106 00359000
*     ;                             /*                       @Y30LB12*/ 00360000
@RF00099 DS    0H                                                  0107 00361000
*   END S05DS;                      /* RET. TO S05SCAN       @Y30LB12*/ 00362000
         B     @EL00004                                            0107 00363000
*                                                                  0108 00364000
*/********************************************************** @Y30LB12*/ 00365000
*/*                                                          @Y30LB12*/ 00366000
*/* PROCEDURE NAME - S05CUID                                 @Y30LB12*/ 00367000
*/*                                                          @Y30LB12*/ 00368000
*/* FUNCTION - EXTRACT CONTROL UNIT IDENTIFIER FROM SUFFIX   @Y30LB12*/ 00369000
*/*            OF KEYWORD AND CHECK FOR VALIDITY.  IF VALID, @Y30LB12*/ 00370000
*/*            CALL S05CUPRM TO EXTRACT REQUIRED PARAMETERS  @Y30LB12*/ 00371000
*/*            THAT FOLLOW THIS KEYWORD.  IF INVALID, RETURN @Y30LB12*/ 00372000
*/*            TO S05SCAN.                                   @Y30LB12*/ 00373000
*/*            IF SUBPARAMETERS NOT PROCESSED, ERROR MESSAGE @Y30LB12*/ 00374000
*/*            'ICGDS209 EXPECTED, BUT DID NOT FIND,         @Y30LB12*/ 00375000
*/*            KEYWORD' WILL BE PRODUCED BY S05SCAN.         @YM31085*/ 00376000
*/*                                                          @Y30LB12*/ 00377000
*/********************************************************** @Y30LB12*/ 00378000
*                                                                  0108 00379000
*S05CUID:                                                          0108 00380000
*   PROCEDURE;                      /*                       @Y30LB12*/ 00381000
S05CUID  STM   @14,@12,@SA00005                                    0108 00382000
*   SAVECUID=SCANDATA(3:4);         /* EXTRACT SUFFIX        @Y30LB12*/ 00383000
         L     @10,STARTCOL(,R4)                                   0109 00384000
         MVC   SAVECUID(2),SCANDATA+2(@10)                         0109 00385000
*   BINCHAR(1:2)=SCANDATA(3:4);     /* AGAIN TO PASS IT      @Y30LB12*/ 00386000
         MVC   BINCHAR(2),SCANDATA+2(@10)                          0110 00387000
*   CALL CONVBIN;                   /* GET INDEX POINTER     @Y30LB12*/ 00388000
*                                                                  0111 00389000
         BAL   @14,CONVBIN                                         0111 00390000
*   /*****************************************************************/ 00391000
*   /*                                                               */ 00392000
*   /* ***********************************************       @YM31085*/ 00393000
*   /* CHECK THAT THE XX PORTION OF CUXX IS VALID            @YM31085*/ 00394000
*   /* BY VERIFYING THAT THE VALUE WAS CONVERTED AND         @YM31085*/ 00395000
*   /* THAT THE LENGTH OF THE PARAMETER IS CORRECT           @YM31085*/ 00396000
*   /* (EQUAL SIGN APPEARS IN PROPER POSITION)               @YM31085*/ 00397000
*   /* ***********************************************       @YM31085*/ 00398000
*   /*                                                               */ 00399000
*   /*****************************************************************/ 00400000
*                                                                  0112 00401000
*   IF BININDEX^=0&SCANDATA(5)='='  /* GOOD DATA             @Y30LB12*/ 00402000
*     THEN                          /*                       @Y30LB12*/ 00403000
         LH    @10,BININDEX                                        0112 00404000
         LTR   @10,@10                                             0112 00405000
         BZ    @RF00112                                            0112 00406000
         L     @05,STARTCOL(,R4)                                   0112 00407000
         CLI   SCANDATA+4(@05),C'='                                0112 00408000
         BNE   @RF00112                                            0112 00409000
*     IF HAVECUID(BININDEX)^='1'B   /* NOT YET USED          @Y30LB12*/ 00410000
*       THEN                        /*                       @Y30LB12*/ 00411000
         LR    @05,@10                                             0113 00412000
         ALR   @05,@05                                             0113 00413000
         LA    @01,HAVECUID-2(@05)                                 0113 00414000
         TM    0(@01),B'10000000'                                  0113 00415000
         BO    @RF00113                                            0113 00416000
*       DO;                         /*                       @Y30LB12*/ 00417000
*         HAVECUID(BININDEX)='1'B;  /* SET USED              @Y30LB12*/ 00418000
         LA    @01,HAVECUID-2(@05)                                 0115 00419000
         OI    0(@01),B'10000000'                                  0115 00420000
*         KNOWN2='1'B;              /* FOR CALLED PROC       @Y30LB12*/ 00421000
         OI    KNOWN2,B'00100000'                                  0116 00422000
*         CUINDEX=BININDEX;         /* PTR TO ENTRY          @Y30LB12*/ 00423000
         STH   @10,CUINDEX                                         0117 00424000
*         CALL S05CUPRM;            /* TO GET PARMS          @Y30LB12*/ 00425000
         BAL   @14,S05CUPRM                                        0118 00426000
*       END;                        /*                       @Y30LB12*/ 00427000
*     ELSE                          /*                       @Y30LB12*/ 00428000
*       DO;                         /*                       @Y30LB12*/ 00429000
*                                                                  0120 00430000
         B     @RC00113                                            0120 00431000
@RF00113 DS    0H                                                  0121 00432000
*         /***********************************************************/ 00433000
*         /*                                                         */ 00434000
*         /* *************************************           @Y30LB12*/ 00435000
*         /* 'ICG219I DUPLICATE KEYWORD CUXX'                @Y30LB12*/ 00436000
*         /* *************************************           @Y30LB12*/ 00437000
*         /*                                                         */ 00438000
*         /***********************************************************/ 00439000
*                                                                  0121 00440000
*         OUTBUF2(1:27)=ICGDS219;   /*                       @Y30LB12*/ 00441000
         MVC   OUTBUF2(27,R4),ICGDS219                             0121 00442000
*         OUTBUF2(28:31)=SCANDATA(1:4);/*                    @Y30LB12*/ 00443000
         L     @10,STARTCOL(,R4)                                   0122 00444000
         MVC   OUTBUF2+27(4,R4),SCANDATA(@10)                      0122 00445000
*         CALL PUTIT1;              /* TO MESSAGE WRITER     @Y30LB12*/ 00446000
         BAL   @14,PUTIT1                                          0123 00447000
*       END;                        /*                       @Y30LB12*/ 00448000
*   ELSE                            /*                       @Y30LB12*/ 00449000
*     DO;                           /*                       @Y30LB12*/ 00450000
*                                                                  0125 00451000
         B     @RC00112                                            0125 00452000
@RF00112 DS    0H                                                  0126 00453000
*       /*************************************************************/ 00454000
*       /*                                                           */ 00455000
*       /* *****************************************         @Y30LB12*/ 00456000
*       /* 'ICG235I RANGE ERROR IN SUFFIX OF                 @Y30LB12*/ 00457000
*       /* KEYWORD CU'                                       @Y30LB12*/ 00458000
*       /* *****************************************         @Y30LB12*/ 00459000
*       /*                                                           */ 00460000
*       /*************************************************************/ 00461000
*                                                                  0126 00462000
*       OUTBUF2(1:42)=ICGDS235;     /*                       @Y30LB12*/ 00463000
         MVC   OUTBUF2(42,R4),ICGDS235                             0126 00464000
*       OUTBUF2(43:44)='CU';        /*                       @Y30LB12*/ 00465000
         MVC   OUTBUF2+42(2,R4),@CC00404                           0127 00466000
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/ 00467000
         BAL   @14,PUTIT1                                          0128 00468000
*     END;                          /*                       @Y30LB12*/ 00469000
*   END S05CUID;                    /* RET. TO S05SCAN       @Y30LB12*/ 00470000
@EL00005 DS    0H                                                  0130 00471000
@EF00005 DS    0H                                                  0130 00472000
@ER00005 LM    @14,@12,@SA00005                                    0130 00473000
         BR    @14                                                 0130 00474000
*                                                                  0131 00475000
*/********************************************************** @Y30LB12*/ 00476000
*/*                                                          @Y30LB12*/ 00477000
*/* PROCEDURE NAME - S05CUPRM                                @Y30LB12*/ 00478000
*/*                                                          @Y30LB12*/ 00479000
*/* FUNCTION - SAVE THE STARTING READ VALUES BEFORE READING  @Y30LB12*/ 00480000
*/*            THE NEXT PARAMETER.  IF THE PARAMETER IS      @Y30LB12*/ 00481000
*/*            'MSFX' OR 'DRCX', CALL THE PROPER             @Y30LB12*/ 00482000
*/*            PROCEDURE TO HANDLE.  OTHERWISE, BACK OUT     @Y30LB12*/ 00483000
*/*            READ AND RETURN TO S05CUID.                   @Y30LB12*/ 00484000
*/*                                                          @Y30LB12*/ 00485000
*/********************************************************** @Y30LB12*/ 00486000
*                                                                  0131 00487000
*S05CUPRM:                                                         0131 00488000
*   PROCEDURE;                      /*                       @Y30LB12*/ 00489000
S05CUPRM STM   @14,@12,@SA00006                                    0131 00490000
*   DO WHILE(KNOWN2='1'B);          /* WHILE REC. PARM       @Y30LB12*/ 00491000
         B     @DE00132                                            0132 00492000
@DL00132 DS    0H                                                  0133 00493000
*     KNOWN2='0'B;                  /* RESET REC. FLAG       @Y30LB12*/ 00494000
         NI    KNOWN2,B'11011111'                                  0133 00495000
*     SAVENCOL=NEXTCOL;             /* SAVE STARTING COL     @Y30LB12*/ 00496000
         MVC   SAVENCOL(4,R4),NEXTCOL(R4)                          0134 00497000
*     SAVESCOL=STARTCOL;            /* SAVE START NEXT       @Y30LB12*/ 00498000
         MVC   SAVESCOL(4,R4),STARTCOL(R4)                         0135 00499000
*     CALL READS99;                 /* EXTRACT PARAMETER     @Y30LB12*/ 00500000
*                                                                  0136 00501000
         BAL   @14,READS99                                         0136 00502000
*     /***************************************************************/ 00503000
*     /*                                                             */ 00504000
*     /* ***********************************************     @Y30LB12*/ 00505000
*     /* IF FIRST THREE CHARACTERS OF PARAMETER ARE          @Y30LB12*/ 00506000
*     /* 'MSF', SET 'KNOWN2' FLAG AND CALL 'S05LIB' TO       @YD00113*/ 00507000
*     /* EXAMINE THE PARAMETER.                              @YD00113*/ 00508000
*     /* ***********************************************     @Y30LB12*/ 00509000
*     /*                                                             */ 00510000
*     /***************************************************************/ 00511000
*                                                                  0137 00512000
*     IF SCANDATA(1:3)='MSF'        /*                       @Y30LB12*/ 00513000
*       THEN                        /*                       @Y30LB12*/ 00514000
         L     @10,STARTCOL(,R4)                                   0137 00515000
         CLC   SCANDATA(3,@10),@CC00428                            0137 00516000
         BNE   @RF00137                                            0137 00517000
*       DO;                         /*                       @Y30LB12*/ 00518000
*         KNOWN2='1'B;              /* RECOGNIZED PARM       @Y30LB12*/ 00519000
         OI    KNOWN2,B'00100000'                                  0139 00520000
*         CALL S05LIB;              /* TO EXAMINE PARM       @Y30LB12*/ 00521000
         BAL   @14,S05LIB                                          0140 00522000
*       END;                        /*                       @Y30LB12*/ 00523000
*     ELSE                                                         0142 00524000
*       ;                           /*                       @Y30LB12*/ 00525000
*                                                                  0142 00526000
@RF00137 DS    0H                                                  0143 00527000
*     /***************************************************************/ 00528000
*     /*                                                             */ 00529000
*     /* ***********************************************     @Y30LB12*/ 00530000
*     /* IF FIRST THREE CHARACTERS OF PARAMETER ARE          @Y30LB12*/ 00531000
*     /* 'DRC', SET 'KNOWN2' FLAG AND CALL 'S05RDWRT'        @YD00113*/ 00532000
*     /* TO EXAMINE THE PARAMETER.                           @YD00113*/ 00533000
*     /* ***********************************************     @Y30LB12*/ 00534000
*     /*                                                             */ 00535000
*     /***************************************************************/ 00536000
*                                                                  0143 00537000
*     IF SCANDATA(1:3)='DRC'        /*                       @Y30LB12*/ 00538000
*       THEN                        /*                       @Y30LB12*/ 00539000
         L     @10,STARTCOL(,R4)                                   0143 00540000
         CLC   SCANDATA(3,@10),@CC00430                            0143 00541000
         BNE   @RF00143                                            0143 00542000
*       DO;                         /*                       @Y30LB12*/ 00543000
*         KNOWN2='1'B;              /* RECOGNIZED PARM       @Y30LB12*/ 00544000
         OI    KNOWN2,B'00100000'                                  0145 00545000
*         CALL S05RDWRT;            /* TO EXTRACT PARM       @Y30LB12*/ 00546000
         BAL   @14,S05RDWRT                                        0146 00547000
*       END;                        /*                       @Y30LB12*/ 00548000
*     ELSE                                                         0148 00549000
*       ;                           /*                       @Y30LB12*/ 00550000
@RF00143 DS    0H                                                  0149 00551000
*     IF KNOWN2='0'B                /* IF PARM NOT REC.,     @Y30LB12*/ 00552000
*         &KEYBIT='1'B              /* KEYWORD SCANNED       @Y30LB12*/ 00553000
*       THEN                        /*                       @Y30LB12*/ 00554000
         TM    KNOWN2,B'00100000'                                  0149 00555000
         BNZ   @RF00149                                            0149 00556000
         TM    KEYBIT(R4),B'01000000'                              0149 00557000
         BNO   @RF00149                                            0149 00558000
*       DO;                         /*                       @Y30LB12*/ 00559000
*         NEXTCOL=SAVENCOL;         /* ORIGINAL START COL    @Y30LB12*/ 00560000
         MVC   NEXTCOL(4,R4),SAVENCOL(R4)                          0151 00561000
*         STARTCOL=SAVESCOL;        /* ORIGINAL NEXT COL     @Y30LB12*/ 00562000
         MVC   STARTCOL(4,R4),SAVESCOL(R4)                         0152 00563000
*       END;                        /*                       @Y30LB12*/ 00564000
*     ELSE                          /*                       @Y30LB12*/ 00565000
*       IF KNOWN2='0'B              /* IF PARM NOT REC.      @Y30LB12*/ 00566000
*           &PARMBIT='1'B           /* PARAMETER SCANNED     @Y30LB12*/ 00567000
*         THEN                      /*                       @Y30LB12*/ 00568000
         B     @RC00149                                            0154 00569000
@RF00149 TM    KNOWN2,B'00100000'                                  0154 00570000
         BNZ   @RF00154                                            0154 00571000
         TM    PARMBIT(R4),B'00100000'                             0154 00572000
         BNO   @RF00154                                            0154 00573000
*         DO;                       /*                       @Y30LB12*/ 00574000
*                                                                  0155 00575000
*           /*********************************************************/ 00576000
*           /*                                                       */ 00577000
*           /* *************************************         @Y30LB12*/ 00578000
*           /* ICG212I UNDEFINED PARAMETER FOUND             @Y30LB12*/ 00579000
*           /* *************************************         @Y30LB12*/ 00580000
*           /*                                                       */ 00581000
*           /*********************************************************/ 00582000
*                                                                  0156 00583000
*           MSGNO=ICG212I;          /* ID FOR ICG212I        @Y30LB12*/ 00584000
         MVC   MSGNO(2,R4),ICG212I                                 0156 00585000
*           CALL PUTIT2;            /* TO MESSAGE WRITER     @Y30LB12*/ 00586000
         BAL   @14,PUTIT2                                          0157 00587000
*         END;                      /*                       @Y30LB12*/ 00588000
*   END;                            /* END OF 'DO WHILE'     @Y30LB12*/ 00589000
@RF00154 DS    0H                                                  0159 00590000
@RC00149 DS    0H                                                  0159 00591000
@DE00132 TM    KNOWN2,B'00100000'                                  0159 00592000
         BO    @DL00132                                            0159 00593000
*   END S05CUPRM;                   /* RET. TO S05CUID       @Y30LB12*/ 00594000
@EL00006 DS    0H                                                  0160 00595000
@EF00006 DS    0H                                                  0160 00596000
@ER00006 LM    @14,@12,@SA00006                                    0160 00597000
         BR    @14                                                 0160 00598000
*                                                                  0161 00599000
*/********************************************************** @Y30LB12*/ 00600000
*/*                                                          @Y30LB12*/ 00601000
*/* PROCEDURE NAME - S05LIB                                  @Y30LB12*/ 00602000
*/*                                                          @Y30LB12*/ 00603000
*/* FUNCTION - CHECK THE LENGTH OF THE PARAMETER AND WRITE   @Y30LB12*/ 00604000
*/*            MESSAGE IF THE LENGTH IS INCORRECT.           @YD00113*/ 00605000
*/*            OTHERWISE MOVE LIBRARY ID INTO PROPER SLOT    @Y30LB12*/ 00606000
*/*            FOR THIS CONTROL UNIT.                        @Y30LB12*/ 00607000
*/*            (VALIDITY OF LIBRARY ID WILL BE CHECKED IN    @Y30LB12*/ 00608000
*/*            S05ANAL.)                                     @Y30LB12*/ 00609000
*/*                                                          @Y30LB12*/ 00610000
*/********************************************************** @Y30LB12*/ 00611000
*                                                                  0161 00612000
*S05LIB:                                                           0161 00613000
*   PROCEDURE;                      /*                       @Y30LB12*/ 00614000
S05LIB   STM   @14,@12,@SA00007                                    0161 00615000
*   HAVEMSF(CUINDEX)='1'B;          /* HAVE MSF FOR CU       @YM31085*/ 00616000
         LH    @10,CUINDEX                                         0162 00617000
         LA    @05,HAVEMSF-1(@10)                                  0162 00618000
         OI    0(@05),B'10000000'                                  0162 00619000
*   IF SCANLEN^=4                   /* SET BY ICGDSS99       @Y30LB12*/ 00620000
*     THEN                          /*                       @Y30LB12*/ 00621000
         CLC   SCANLEN(2,R4),@CH00068                              0163 00622000
         BE    @RF00163                                            0163 00623000
*     DO;                           /*                       @Y30LB12*/ 00624000
*                                                                  0164 00625000
*       /*************************************************************/ 00626000
*       /*                                                           */ 00627000
*       /* *****************************************         @Y30LB12*/ 00628000
*       /* ICG220I INVALID PARAMETER LENGTH,                 @Y30LB12*/ 00629000
*       /* KEYWORD IS MSFX.                                  @Y30LB12*/ 00630000
*       /* *****************************************         @Y30LB12*/ 00631000
*       /*                                                           */ 00632000
*       /*************************************************************/ 00633000
*                                                                  0165 00634000
*       OUTBUF2(1:46)=ICGDS220;     /*                       @Y30LB12*/ 00635000
         MVC   OUTBUF2(46,R4),ICGDS220                             0165 00636000
*       OUTBUF2(47:50)=SCANDATA(1:4);/*                      @Y30LB12*/ 00637000
         L     @10,STARTCOL(,R4)                                   0166 00638000
         MVC   OUTBUF2+46(4,R4),SCANDATA(@10)                      0166 00639000
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/ 00640000
         BAL   @14,PUTIT1                                          0167 00641000
*     END;                          /*                       @Y30LB12*/ 00642000
*                                                                  0168 00643000
*   /*****************************************************************/ 00644000
*   /*                                                               */ 00645000
*   /* *********************************************         @YM31085*/ 00646000
*   /* IF NO MSFX PARAMETER HAS BEEN ENCOUNTERED             @YM31085*/ 00647000
*   /* IN THIS STATEMENT FOR THIS CONTROL UNIT,              @YM31085*/ 00648000
*   /* SAVE THE LOGICAL MSF ID IN CHARACTER FORM.            @YM31085*/ 00649000
*   /* *********************************************         @YM31085*/ 00650000
*   /*                                                               */ 00651000
*   /*****************************************************************/ 00652000
*                                                                  0169 00653000
*   ELSE                            /*                       @Y30LB12*/ 00654000
*     IF WORKLIB(CUINDEX)='00'X     /* IF UNUSED             @Y30LB12*/ 00655000
*       THEN                        /*                       @Y30LB12*/ 00656000
         B     @RC00163                                            0169 00657000
@RF00163 LH    @10,CUINDEX                                         0169 00658000
         ALR   @10,@10                                             0169 00659000
         LA    @05,WORKLIB-2(@10)                                  0169 00660000
         CLI   0(@05),X'00'                                        0169 00661000
         BNE   @RF00169                                            0169 00662000
*       WORKLIB(CUINDEX)=SCANDATA(4);/* USE IT               @Y30LB12*/ 00663000
         LA    @05,WORKLIB-2(@10)                                  0170 00664000
         L     @10,STARTCOL(,R4)                                   0170 00665000
         MVC   0(1,@05),SCANDATA+3(@10)                            0170 00666000
*     ELSE                          /*                       @Y30LB12*/ 00667000
*       DO;                         /*                       @Y30LB12*/ 00668000
*                                                                  0171 00669000
         B     @RC00169                                            0171 00670000
@RF00169 DS    0H                                                  0172 00671000
*         /***********************************************************/ 00672000
*         /*                                                         */ 00673000
*         /* *************************************           @Y30LB12*/ 00674000
*         /* ICG234I 2 MSF SPECIFICATIONS FOR                @Y30LB12*/ 00675000
*         /* CUXX.                                           @Y30LB12*/ 00676000
*         /* *************************************           @Y30LB12*/ 00677000
*         /*                                                         */ 00678000
*         /***********************************************************/ 00679000
*                                                                  0172 00680000
*         OUTBUF2(1:36)=ICGDS234;   /*                       @Y30LB12*/ 00681000
         MVC   OUTBUF2(36,R4),ICGDS234                             0172 00682000
*         OUTBUF2(12:14)='MSF';     /*                       @Y30LB12*/ 00683000
         MVC   OUTBUF2+11(3,R4),@CC00428                           0173 00684000
*         OUTBUF2(37:38)=SAVECUID;  /*                       @Y30LB12*/ 00685000
         MVC   OUTBUF2+36(2,R4),SAVECUID                           0174 00686000
*         CALL PUTIT1;              /* TO MESSAGE WRITER     @Y30LB12*/ 00687000
         BAL   @14,PUTIT1                                          0175 00688000
*       END;                        /*                       @Y30LB12*/ 00689000
*   END S05LIB;                     /* RET. TO S05CUPRM      @Y30LB12*/ 00690000
@EL00007 DS    0H                                                  0177 00691000
@EF00007 DS    0H                                                  0177 00692000
@ER00007 LM    @14,@12,@SA00007                                    0177 00693000
         BR    @14                                                 0177 00694000
*                                                                  0178 00695000
*/********************************************************** @Y30LB12*/ 00696000
*/*                                                          @Y30LB12*/ 00697000
*/* PROCEDURE NAME - S05RDWRT                                @Y30LB12*/ 00698000
*/*                                                          @Y30LB12*/ 00699000
*/* FUNCTION - CHECK THE LENGTH OF THE PARAMETER AND WRITE   @Y30LB12*/ 00700000
*/*            ERROR MESSAGE IF THE LENGTH IS INCORRECT.     @Y30LB12*/ 00701000
*/*            CHECK THE LAST CHARACTER FOR EXPECTED DATA    @Y30LB12*/ 00702000
*/*            RECORDING CONTROL UNIT ID AND SET THE         @Y30LB12*/ 00703000
*/*            PROPER BIT FOR THIS LIBRARY CONTROL UNIT.     @Y30LB12*/ 00704000
*/*            (IF NO BIT IS SET, IT WILL BE CAUGHT IN       @Y30LB12*/ 00705000
*/*            S05ANAL.)                                     @Y30LB12*/ 00706000
*/*                                                          @Y30LB12*/ 00707000
*/********************************************************** @Y30LB12*/ 00708000
*                                                                  0178 00709000
*S05RDWRT:                                                         0178 00710000
*   PROCEDURE;                      /*                       @Y30LB12*/ 00711000
S05RDWRT STM   @14,@12,@SA00008                                    0178 00712000
*   HAVEDRC(CUINDEX)='1'B;          /* HAVE DRC FOR CU       @YM31085*/ 00713000
         LH    @10,CUINDEX                                         0179 00714000
         LA    @05,HAVEDRC-1(@10)                                  0179 00715000
         OI    0(@05),B'01000000'                                  0179 00716000
*   IF SCANLEN^=4                   /* SET BY ICGDSS99       @Y30LB12*/ 00717000
*     THEN                          /*                       @Y30LB12*/ 00718000
         CLC   SCANLEN(2,R4),@CH00068                              0180 00719000
         BE    @RF00180                                            0180 00720000
*     DO;                           /*                       @Y30LB12*/ 00721000
*                                                                  0181 00722000
*       /*************************************************************/ 00723000
*       /*                                                           */ 00724000
*       /* *****************************************         @Y30LB12*/ 00725000
*       /* ICG220I INVALID PARAMETER LENGTH,                 @Y30LB12*/ 00726000
*       /* KEYWORD IS DRCX                                   @Y30LB12*/ 00727000
*       /* *****************************************         @Y30LB12*/ 00728000
*       /*                                                           */ 00729000
*       /*************************************************************/ 00730000
*                                                                  0182 00731000
*       OUTBUF2(1:46)=ICGDS220;     /*                       @Y30LB12*/ 00732000
         MVC   OUTBUF2(46,R4),ICGDS220                             0182 00733000
*       OUTBUF2(47:50)=SCANDATA(1:4);/*                      @Y30LB12*/ 00734000
         L     @10,STARTCOL(,R4)                                   0183 00735000
         MVC   OUTBUF2+46(4,R4),SCANDATA(@10)                      0183 00736000
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/ 00737000
         BAL   @14,PUTIT1                                          0184 00738000
*     END;                          /*                       @Y30LB12*/ 00739000
*   ELSE                            /*                       @Y30LB12*/ 00740000
*     IF RDWRS(CUINDEX)='0000'B     /* IF ENTRY FREE         @Y30LB12*/ 00741000
*       THEN                        /*                       @Y30LB12*/ 00742000
         B     @RC00180                                            0186 00743000
@RF00180 LH    @10,CUINDEX                                         0186 00744000
         ALR   @10,@10                                             0186 00745000
         LA    @05,RDWRS-2(@10)                                    0186 00746000
         TM    0(@05),B'01111000'                                  0186 00747000
         BNZ   @RF00186                                            0186 00748000
*       DO;                         /*                       @Y30LB12*/ 00749000
*         IF SCANDATA(4)='0'        /*                       @Y30LB12*/ 00750000
*           THEN                    /*                       @Y30LB12*/ 00751000
         L     @05,STARTCOL(,R4)                                   0188 00752000
         CLI   SCANDATA+3(@05),C'0'                                0188 00753000
         BNE   @RF00188                                            0188 00754000
*           RDWR01(CUINDEX)='1'B;   /*                       @Y30LB12*/ 00755000
         LA    @05,RDWR01-2(@10)                                   0189 00756000
         OI    0(@05),B'01000000'                                  0189 00757000
*         ELSE                                                     0190 00758000
*           ;                       /*                       @Y30LB12*/ 00759000
@RF00188 DS    0H                                                  0191 00760000
*         IF SCANDATA(4)='1'        /*                       @Y30LB12*/ 00761000
*           THEN                    /*                       @Y30LB12*/ 00762000
         L     @10,STARTCOL(,R4)                                   0191 00763000
         CLI   SCANDATA+3(@10),C'1'                                0191 00764000
         BNE   @RF00191                                            0191 00765000
*           RDWR23(CUINDEX)='1'B;   /*                       @Y30LB12*/ 00766000
         LH    @10,CUINDEX                                         0192 00767000
         ALR   @10,@10                                             0192 00768000
         LA    @05,RDWR23-2(@10)                                   0192 00769000
         OI    0(@05),B'00100000'                                  0192 00770000
*         ELSE                                                     0193 00771000
*           ;                       /*                       @Y30LB12*/ 00772000
@RF00191 DS    0H                                                  0194 00773000
*         IF SCANDATA(4)='2'        /*                       @Y30LB12*/ 00774000
*           THEN                    /*                       @Y30LB12*/ 00775000
         L     @10,STARTCOL(,R4)                                   0194 00776000
         CLI   SCANDATA+3(@10),C'2'                                0194 00777000
         BNE   @RF00194                                            0194 00778000
*           RDWR45(CUINDEX)='1'B;   /*                       @Y30LB12*/ 00779000
         LH    @10,CUINDEX                                         0195 00780000
         ALR   @10,@10                                             0195 00781000
         LA    @05,RDWR45-2(@10)                                   0195 00782000
         OI    0(@05),B'00010000'                                  0195 00783000
*         ELSE                                                     0196 00784000
*           ;                       /*                       @Y30LB12*/ 00785000
@RF00194 DS    0H                                                  0197 00786000
*         IF SCANDATA(4)='3'        /*                       @Y30LB12*/ 00787000
*           THEN                    /*                       @Y30LB12*/ 00788000
         L     @10,STARTCOL(,R4)                                   0197 00789000
         CLI   SCANDATA+3(@10),C'3'                                0197 00790000
         BNE   @RF00197                                            0197 00791000
*           RDWR67(CUINDEX)='1'B;   /*                       @Y30LB12*/ 00792000
         LH    @10,CUINDEX                                         0198 00793000
         ALR   @10,@10                                             0198 00794000
         LA    @05,RDWR67-2(@10)                                   0198 00795000
         OI    0(@05),B'00001000'                                  0198 00796000
*         ELSE                                                     0199 00797000
*           ;                       /*                       @Y30LB12*/ 00798000
@RF00197 DS    0H                                                  0200 00799000
*       END;                        /*                       @Y30LB12*/ 00800000
*     ELSE                          /*                       @Y30LB12*/ 00801000
*       DO;                         /*                       @Y30LB12*/ 00802000
*                                                                  0201 00803000
         B     @RC00186                                            0201 00804000
@RF00186 DS    0H                                                  0202 00805000
*         /***********************************************************/ 00806000
*         /*                                                         */ 00807000
*         /* *************************************           @Y30LB12*/ 00808000
*         /* ICG234I 2 DRC SPECIFICATIONS FOR                @Y30LB12*/ 00809000
*         /* CUXX.                                           @Y30LB12*/ 00810000
*         /* *************************************           @Y30LB12*/ 00811000
*         /*                                                         */ 00812000
*         /***********************************************************/ 00813000
*                                                                  0202 00814000
*         OUTBUF2(1:36)=ICGDS234;   /*                       @Y30LB12*/ 00815000
         MVC   OUTBUF2(36,R4),ICGDS234                             0202 00816000
*         OUTBUF2(12:14)='DRC';     /*                       @Y30LB12*/ 00817000
         MVC   OUTBUF2+11(3,R4),@CC00430                           0203 00818000
*         OUTBUF2(37:38)=SAVECUID;  /*                       @Y30LB12*/ 00819000
         MVC   OUTBUF2+36(2,R4),SAVECUID                           0204 00820000
*         CALL PUTIT1;              /* TO MESSAGE WRITER     @Y30LB12*/ 00821000
         BAL   @14,PUTIT1                                          0205 00822000
*       END;                        /*                       @Y30LB12*/ 00823000
*   END S05RDWRT;                   /* RET. TO S05CUPRM      @Y30LB12*/ 00824000
@EL00008 DS    0H                                                  0207 00825000
@EF00008 DS    0H                                                  0207 00826000
@ER00008 LM    @14,@12,@SA00008                                    0207 00827000
         BR    @14                                                 0207 00828000
*                                                                  0208 00829000
*/********************************************************** @Y30LB12*/ 00830000
*/*                                                          @Y30LB12*/ 00831000
*/* PROCEDURE NAME - UNKNOWN                                 @Y30LB12*/ 00832000
*/*                                                          @Y30LB12*/ 00833000
*/* FUNCTION - IF THE KEYWORD IS NOT 'SA' OR 'CUXX', WRITE   @YM31085*/ 00834000
*/*            ERROR MESSAGE 'ICG210I  UNDEFINED KEYWORD     @Y30LB12*/ 00835000
*/*            FOUND' AND DO DUMMY READ OF PARAMETER TO      @Y30LB12*/ 00836000
*/*            POSITION TO NEXT KEYWORD.                     @Y30LB12*/ 00837000
*/*                                                          @Y30LB12*/ 00838000
*/********************************************************** @Y30LB12*/ 00839000
*                                                                  0208 00840000
*UNKNOWN:                                                          0208 00841000
*   PROCEDURE;                      /*                       @Y30LB12*/ 00842000
UNKNOWN  STM   @14,@12,@SA00009                                    0208 00843000
*   MSGNO=ICG210I;                  /* ID FOR ICGDS210       @Y30LB12*/ 00844000
         MVC   MSGNO(2,R4),ICG210I                                 0209 00845000
*   CALL PUTIT2;                    /* TO MESSAGE WRITER     @Y30LB12*/ 00846000
         BAL   @14,PUTIT2                                          0210 00847000
*   CALL READS99;                   /* DO DUMMY READ         @Y30LB12*/ 00848000
         BAL   @14,READS99                                         0211 00849000
*   END UNKNOWN;                    /* RET. TO S05SCAN       @Y30LB12*/ 00850000
@EL00009 DS    0H                                                  0212 00851000
@EF00009 DS    0H                                                  0212 00852000
@ER00009 LM    @14,@12,@SA00009                                    0212 00853000
         BR    @14                                                 0212 00854000
*                                                                  0213 00855000
*/********************************************************** @Y30LB12*/ 00856000
*/*                                                          @Y30LB12*/ 00857000
*/* PROCEDURE NAME - S05ANAL                                 @Y30LB12*/ 00858000
*/*                                                          @Y30LB12*/ 00859000
*/* FUNCTION - VERIFY THAT THE PROPER VALUES HAVE BEEN       @Y30LB12*/ 00860000
*/*            SPECIFIED IN THE SUFFIX OF THE 'DRCX' AND     @Y30LB12*/ 00861000
*/*            'MSFX' PARAMETERS, AND VERIFY THAT A DATA     @Y30LB12*/ 00862000
*/*             STAGER HAS BEEN SPECIFIED                    @Y30LB12*/ 00863000
*/*                                                          @YD00113*/ 00864000
*/*            IF ANY OF THE TESTS FAIL, ISSUE APPROPRIATE   @YD00113*/ 00865000
*/*            ERROR MESSAGE.                                @YD00113*/ 00866000
*/*                                                          @Y30LB12*/ 00867000
*/********************************************************** @Y30LB12*/ 00868000
*                                                                  0213 00869000
*S05ANAL:                                                          0213 00870000
*   PROCEDURE;                      /*                       @Y30LB12*/ 00871000
*                                                                  0213 00872000
S05ANAL  STM   @14,@12,@SA00010                                    0213 00873000
*   /*****************************************************************/ 00874000
*   /*                                                               */ 00875000
*   /* ***********************************************       @YM31085*/ 00876000
*   /* UP TO FOUR CONTROL UNIT ADDRESSES FROM THE            @YM31085*/ 00877000
*   /* STAGING ADAPTER CAN BE SPECIFIED FROM A               @YM31085*/ 00878000
*   /* LOWERCON STATEMENT. CHECK ALL 4 POSSIBLE.             @YM31085*/ 00879000
*   /* ***********************************************       @YM31085*/ 00880000
*   /*                                                               */ 00881000
*   /*****************************************************************/ 00882000
*                                                                  0214 00883000
*   DO I=1 TO MAXCU;                /* FOR EACH CU ID        @YM31085*/ 00884000
         LA    @10,1                                               0214 00885000
         STH   @10,I                                               0214 00886000
@DL00214 DS    0H                                                  0215 00887000
*     IF HAVECUID(I)='1'B           /*                       @YM31062*/ 00888000
*       THEN                        /*                       @YM31062*/ 00889000
         ALR   @10,@10                                             0215 00890000
         LA    @05,HAVECUID-2(@10)                                 0215 00891000
         TM    0(@05),B'10000000'                                  0215 00892000
         BNO   @RF00215                                            0215 00893000
*       CUSPEC='1'B;                /*                       @YM31062*/ 00894000
         OI    CUSPEC,B'01000000'                                  0216 00895000
*     ELSE                                                         0217 00896000
*       ;                           /*                       @YM31062*/ 00897000
@RF00215 DS    0H                                                  0218 00898000
*     IF RDWRS(I)='0000'B           /*                       @YM32176*/ 00899000
*         &HAVECUID(I)='1'B         /*                       @YM31085*/ 00900000
*         &HAVEDRC(I)='1'B          /*                       @YM31085*/ 00901000
*       THEN                        /*                       @Y30LB12*/ 00902000
         LH    @10,I                                               0218 00903000
         LR    @05,@10                                             0218 00904000
         ALR   @05,@05                                             0218 00905000
         LA    @01,RDWRS-2(@05)                                    0218 00906000
         TM    0(@01),B'01111000'                                  0218 00907000
         BNZ   @RF00218                                            0218 00908000
         LA    @01,HAVECUID-2(@05)                                 0218 00909000
         TM    0(@01),B'10000000'                                  0218 00910000
         BNO   @RF00218                                            0218 00911000
         LA    @01,HAVEDRC-1(@10)                                  0218 00912000
         TM    0(@01),B'01000000'                                  0218 00913000
         BNO   @RF00218                                            0218 00914000
*       DO;                         /*                       @Y30LB12*/ 00915000
*                                                                  0219 00916000
*         /***********************************************************/ 00917000
*         /*                                                         */ 00918000
*         /* *****************************************       @Y30LB12*/ 00919000
*         /* ICG236I FORMAT ERROR IN PARAMETER               @Y30LB12*/ 00920000
*         /* DRCX FOR CUXX                                   @Y30LB12*/ 00921000
*         /* *****************************************       @Y30LB12*/ 00922000
*         /*                                                         */ 00923000
*         /***********************************************************/ 00924000
*                                                                  0220 00925000
*         OUTBUF2(1:35)=ICGDS236;   /*                       @Y30LB12*/ 00926000
         MVC   OUTBUF2(35,R4),ICGDS236                             0220 00927000
*         OUTBUF2(36:39)='DRCX';    /*                       @Y30LB12*/ 00928000
         MVC   OUTBUF2+35(4,R4),@CC00454                           0221 00929000
*         OUTBUF2(40:46)=MSGADDON;  /*                       @YM31085*/ 00930000
         MVC   OUTBUF2+39(7,R4),MSGADDON                           0222 00931000
*         OUTBUF2(47:48)=CULOOKUP(I);/*                      @YM31085*/ 00932000
         LA    @10,CULOOKUP-2(@05)                                 0223 00933000
         MVC   OUTBUF2+46(2,R4),0(@10)                             0223 00934000
*         CALL PUTIT1;              /* TO MESSAGE WRITER     @Y30LB12*/ 00935000
         BAL   @14,PUTIT1                                          0224 00936000
*       END;                        /*                       @Y30LB12*/ 00937000
*     ELSE                                                         0226 00938000
*       ;                           /*                       @Y30LB12*/ 00939000
@RF00218 DS    0H                                                  0227 00940000
*     IF HAVECUID(I)='1'B           /* IF POSITION SPEC      @Y30LB12*/ 00941000
*         &HAVEMSF(I)='1'B          /* MSF SPECIFIED         @YM31085*/ 00942000
*       THEN                        /*                       @Y30LB12*/ 00943000
         LH    @10,I                                               0227 00944000
         LR    @05,@10                                             0227 00945000
         ALR   @05,@05                                             0227 00946000
         LA    @01,HAVECUID-2(@05)                                 0227 00947000
         TM    0(@01),B'10000000'                                  0227 00948000
         BNO   @RF00227                                            0227 00949000
         LA    @01,HAVEMSF-1(@10)                                  0227 00950000
         TM    0(@01),B'10000000'                                  0227 00951000
         BNO   @RF00227                                            0227 00952000
*       IF ONEBITS(I)^='1111'B      /* NOT NUMERIC ZONE      @Y30LB12*/ 00953000
*           |ZEROBITS(I)^='000'B    /* OR DIGIT > 1          @Y30LB12*/ 00954000
*         THEN                      /*                       @Y30LB12*/ 00955000
         LA    @10,ONEBITS-2(@05)                                  0228 00956000
         TM    0(@10),B'11110000'                                  0228 00957000
         BNO   @RT00228                                            0228 00958000
         LA    @10,ZEROBITS-2(@05)                                 0228 00959000
         TM    0(@10),B'00001110'                                  0228 00960000
         BZ    @RF00228                                            0228 00961000
@RT00228 DS    0H                                                  0229 00962000
*         DO;                       /*                       @Y30LB12*/ 00963000
*                                                                  0229 00964000
*           /*********************************************************/ 00965000
*           /*                                                       */ 00966000
*           /* *************************************         @Y30LB12*/ 00967000
*           /* ICG236I FORMAT ERROR IN PARAMETER             @Y30LB12*/ 00968000
*           /* MSFX FOR CUXX                                 @YM31085*/ 00969000
*           /* *************************************         @Y30LB12*/ 00970000
*           /*                                                       */ 00971000
*           /*********************************************************/ 00972000
*                                                                  0230 00973000
*           OUTBUF2(1:35)=ICGDS236; /*                       @Y30LB12*/ 00974000
         MVC   OUTBUF2(35,R4),ICGDS236                             0230 00975000
*           OUTBUF2(36:39)='MSFX';  /*                       @Y30LB12*/ 00976000
         MVC   OUTBUF2+35(4,R4),@CC00458                           0231 00977000
*           OUTBUF2(40:46)=MSGADDON;/*                       @YM31085*/ 00978000
         MVC   OUTBUF2+39(7,R4),MSGADDON                           0232 00979000
*           OUTBUF2(47:48)=CULOOKUP(I);/*                    @YM31085*/ 00980000
         LH    @10,I                                               0233 00981000
         ALR   @10,@10                                             0233 00982000
         LA    @05,CULOOKUP-2(@10)                                 0233 00983000
         MVC   OUTBUF2+46(2,R4),0(@05)                             0233 00984000
*           CALL PUTIT1;            /* TO MESSAGE WRITER     @Y30LB12*/ 00985000
         BAL   @14,PUTIT1                                          0234 00986000
*         END;                      /*                       @Y30LB12*/ 00987000
*       ELSE                                                       0236 00988000
*         ;                         /*                       @Y30LB12*/ 00989000
@RF00228 DS    0H                                                  0237 00990000
*     ELSE                                                         0237 00991000
*       ;                           /*                       @Y30LB12*/ 00992000
@RF00227 DS    0H                                                  0238 00993000
*     IF HAVECUID(I)='1'B           /*                       @YM31085*/ 00994000
*         &HAVEMSF(I)='0'B          /*                       @YM31085*/ 00995000
*       THEN                        /*                       @YM31085*/ 00996000
         LH    @10,I                                               0238 00997000
         LR    @05,@10                                             0238 00998000
         ALR   @05,@05                                             0238 00999000
         LA    @01,HAVECUID-2(@05)                                 0238 01000000
         TM    0(@01),B'10000000'                                  0238 01001000
         BNO   @RF00238                                            0238 01002000
         LA    @01,HAVEMSF-1(@10)                                  0238 01003000
         TM    0(@01),B'10000000'                                  0238 01004000
         BNZ   @RF00238                                            0238 01005000
*       DO;                         /*                       @YM31085*/ 01006000
*                                                                  0239 01007000
*         /***********************************************************/ 01008000
*         /*                                                         */ 01009000
*         /* *****************************************       @YM31085*/ 01010000
*         /* ICG241I MISSING REQUIRED PARAMETER MSFX         @YM31085*/ 01011000
*         /* FOR CUXX                                        @YM31085*/ 01012000
*         /* *****************************************       @YM31085*/ 01013000
*         /*                                                         */ 01014000
*         /***********************************************************/ 01015000
*                                                                  0240 01016000
*         OUTBUF2(1:36)=ICGDS241;   /*                       @YM31085*/ 01017000
         MVC   OUTBUF2(36,R4),ICGDS241                             0240 01018000
*         OUTBUF2(37:40)='MSFX';    /*                       @YM31085*/ 01019000
         MVC   OUTBUF2+36(4,R4),@CC00458                           0241 01020000
*         OUTBUF2(41:47)=MSGADDON;  /*                       @YM31085*/ 01021000
         MVC   OUTBUF2+40(7,R4),MSGADDON                           0242 01022000
*         OUTBUF2(48:49)=CULOOKUP(I);/*                      @YM31085*/ 01023000
         LA    @10,CULOOKUP-2(@05)                                 0243 01024000
         MVC   OUTBUF2+47(2,R4),0(@10)                             0243 01025000
*         CALL PUTIT1;              /* TO MESSAGE WRITER     @YM31085*/ 01026000
         BAL   @14,PUTIT1                                          0244 01027000
*       END;                        /*                       @YM31085*/ 01028000
*     ELSE                                                         0246 01029000
*       ;                           /*                       @YM31085*/ 01030000
@RF00238 DS    0H                                                  0247 01031000
*     IF HAVECUID(I)='1'B           /*                       @YM31085*/ 01032000
*         &HAVEDRC(I)='0'B          /*                       @YM31085*/ 01033000
*       THEN                        /*                       @YM31085*/ 01034000
         LH    @10,I                                               0247 01035000
         LR    @05,@10                                             0247 01036000
         ALR   @05,@05                                             0247 01037000
         LA    @01,HAVECUID-2(@05)                                 0247 01038000
         TM    0(@01),B'10000000'                                  0247 01039000
         BNO   @RF00247                                            0247 01040000
         LA    @01,HAVEDRC-1(@10)                                  0247 01041000
         TM    0(@01),B'01000000'                                  0247 01042000
         BNZ   @RF00247                                            0247 01043000
*       DO;                         /*                       @YM31085*/ 01044000
*                                                                  0248 01045000
*         /***********************************************************/ 01046000
*         /*                                                         */ 01047000
*         /* *****************************************       @YM31085*/ 01048000
*         /* ICG241I MISSING REQUIRED PARAMETER DRCX         @YM31085*/ 01049000
*         /* FOR CUXX                                        @YM31085*/ 01050000
*         /* *****************************************       @YM31085*/ 01051000
*         /*                                                         */ 01052000
*         /***********************************************************/ 01053000
*                                                                  0249 01054000
*         OUTBUF2(1:36)=ICGDS241;   /*                       @YM31085*/ 01055000
         MVC   OUTBUF2(36,R4),ICGDS241                             0249 01056000
*         OUTBUF2(37:40)='DRCX';    /*                       @YM31085*/ 01057000
         MVC   OUTBUF2+36(4,R4),@CC00454                           0250 01058000
*         OUTBUF2(41:47)=MSGADDON;  /*                       @YM31085*/ 01059000
         MVC   OUTBUF2+40(7,R4),MSGADDON                           0251 01060000
*         OUTBUF2(48:49)=CULOOKUP(I);/*                      @YM31085*/ 01061000
         LA    @10,CULOOKUP-2(@05)                                 0252 01062000
         MVC   OUTBUF2+47(2,R4),0(@10)                             0252 01063000
*         CALL PUTIT1;              /* TO MESSAGE WRITER     @YM31085*/ 01064000
         BAL   @14,PUTIT1                                          0253 01065000
*       END;                        /*                       @YM31085*/ 01066000
*     ELSE                                                         0255 01067000
*       ;                           /*                       @YM31085*/ 01068000
@RF00247 DS    0H                                                  0256 01069000
*   END;                            /* DID ALL 4             @Y30LB12*/ 01070000
         LA    @10,1                                               0256 01071000
         AH    @10,I                                               0256 01072000
         STH   @10,I                                               0256 01073000
         CH    @10,@CH00068                                        0256 01074000
         BNH   @DL00214                                            0256 01075000
*   IF HAVEDS^='1'B                 /* NO DS KEYWORD         @Y30LB12*/ 01076000
*     THEN                          /*                       @Y30LB12*/ 01077000
         TM    HAVEDS,B'10000000'                                  0257 01078000
         BO    @RF00257                                            0257 01079000
*     DO;                           /*                       @Y30LB12*/ 01080000
*                                                                  0258 01081000
*       /*************************************************************/ 01082000
*       /*                                                           */ 01083000
*       /* ***************************************           @Y30LB12*/ 01084000
*       /* ICG221I MISSING REQUIRED KEYWORD SA               @Y30LB12*/ 01085000
*       /* ***************************************           @Y30LB12*/ 01086000
*       /*                                                           */ 01087000
*       /*************************************************************/ 01088000
*                                                                  0259 01089000
*       OUTBUF2(1:34)=ICGDS221;     /*                       @Y30LB12*/ 01090000
         MVC   OUTBUF2(34,R4),ICGDS221                             0259 01091000
*       OUTBUF2(35:36)='SA';        /*                       @Y30LB12*/ 01092000
         MVC   OUTBUF2+34(2,R4),@CC00412                           0260 01093000
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/ 01094000
         BAL   @14,PUTIT1                                          0261 01095000
*     END;                          /*                       @Y30LB12*/ 01096000
*   ELSE                                                           0263 01097000
*     ;                             /*                       @Y30LB12*/ 01098000
@RF00257 DS    0H                                                  0264 01099000
*   IF CUSPEC^='1'B                 /* NO CUXX KEYWORD       @YM31062*/ 01100000
*     THEN                          /*                       @YM31062*/ 01101000
         TM    CUSPEC,B'01000000'                                  0264 01102000
         BO    @RF00264                                            0264 01103000
*     DO;                           /*                       @YM31062*/ 01104000
*                                                                  0265 01105000
*       /*************************************************************/ 01106000
*       /*                                                           */ 01107000
*       /* ***************************************           @YM31062*/ 01108000
*       /* ICG221I MISSING REQUIRED KEYWORD CUXX             @YM31062*/ 01109000
*       /* ***************************************           @YM31062*/ 01110000
*       /*                                                           */ 01111000
*       /*************************************************************/ 01112000
*                                                                  0266 01113000
*       OUTBUF2(1:34)=ICGDS221;     /*                       @YM31062*/ 01114000
         MVC   OUTBUF2(34,R4),ICGDS221                             0266 01115000
*       OUTBUF2(35:38)='CUXX';      /*                       @YM31062*/ 01116000
         MVC   OUTBUF2+34(4,R4),@CC00461                           0267 01117000
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @YM31062*/ 01118000
         BAL   @14,PUTIT1                                          0268 01119000
*     END;                          /*                       @YM31062*/ 01120000
*   ELSE                                                           0270 01121000
*     ;                             /*                       @YM31062*/ 01122000
@RF00264 DS    0H                                                  0271 01123000
*   END S05ANAL;                    /* RET. TO MAINLINE      @Y30LB12*/ 01124000
@EL00010 DS    0H                                                  0271 01125000
@EF00010 DS    0H                                                  0271 01126000
@ER00010 LM    @14,@12,@SA00010                                    0271 01127000
         BR    @14                                                 0271 01128000
*                                                                  0272 01129000
*/********************************************************** @Y30LB12*/ 01130000
*/*                                                          @Y30LB12*/ 01131000
*/* PROCEDURE NAME - S05BUILD                                @Y30LB12*/ 01132000
*/*                                                          @Y30LB12*/ 01133000
*/* FUNCTION - CHECK TO BE SURE THAT THE CONTROL UNIT        @Y30LB12*/ 01134000
*/*            IDENTIFICATION FROM THE DATA STAGER HAS NOT   @Y30LB12*/ 01135000
*/*            BEEN USED PREVIOUSLY.  IF PREVIOUSLY USED,    @Y30LB12*/ 01136000
*/*            WRITE MESSAGE ICG233I.  IF NOT USED YET, SET  @YM31085*/ 01137000
*/*            USED FLAG AND CALL FINDSLOT TO CHECK TO SEE   @Y30LB12*/ 01138000
*/*            THAT THERE IS A MATCHING FREE CONTROL UNIT    @Y30LB12*/ 01139000
*/*            POSITION IN THE LIBRARY.                      @Y30LB12*/ 01140000
*/*                                                          @Y30LB12*/ 01141000
*/********************************************************** @Y30LB12*/ 01142000
*                                                                  0272 01143000
*S05BUILD:                                                         0272 01144000
*   PROCEDURE;                      /*                       @Y30LB12*/ 01145000
S05BUILD STM   @14,@12,@SA00011                                    0272 01146000
*   DO I=1 TO MAXCU;                /* EACH POSITION         @YM31085*/ 01147000
         LA    @10,1                                               0273 01148000
         STH   @10,I                                               0273 01149000
@DL00273 DS    0H                                                  0274 01150000
*     IF HAVECUID(I)='1'B           /* SPECIFIED HERE        @Y30LB12*/ 01151000
*       THEN                        /*                       @Y30LB12*/ 01152000
         LR    @05,@10                                             0274 01153000
         ALR   @05,@05                                             0274 01154000
         LA    @01,HAVECUID-2(@05)                                 0274 01155000
         TM    0(@01),B'10000000'                                  0274 01156000
         BNO   @RF00274                                            0274 01157000
*       DO;                         /*                       @Y30LB12*/ 01158000
*         IF LOWSPEC(DSINDEX,I)='1'B/* SPEC BEFORE           @Y30LB12*/ 01159000
*           THEN                    /*                       @Y30LB12*/ 01160000
         LH    @15,DSINDEX                                         0276 01161000
         SLA   @15,2                                               0276 01162000
         ALR   @15,@10                                             0276 01163000
         ALR   @15,@15                                             0276 01164000
         ALR   @15,R4                                              0276 01165000
         TM    LOWSPEC-10(@15),B'10000000'                         0276 01166000
         BNO   @RF00276                                            0276 01167000
*           DO;                     /*                       @Y30LB12*/ 01168000
*                                                                  0277 01169000
*             /*******************************************************/ 01170000
*             /*                                                     */ 01171000
*             /* ***********************************         @Y30LB12*/ 01172000
*             /* ICG233I CONTROL UNIT XX                     @Y30LB12*/ 01173000
*             /* PREVIOUSLY SPECIFIED                        @Y30LB12*/ 01174000
*             /* ***********************************         @Y30LB12*/ 01175000
*             /*                                                     */ 01176000
*             /*******************************************************/ 01177000
*                                                                  0278 01178000
*             OUTBUF2(1:46)=ICGDS233;/*                      @Y30LB12*/ 01179000
         MVC   OUTBUF2(46,R4),ICGDS233                             0278 01180000
*             OUTBUF2(23:24)=CULOOKUP(I);/*                  @YM31085*/ 01181000
         LA    @10,CULOOKUP-2(@05)                                 0279 01182000
         MVC   OUTBUF2+22(2,R4),0(@10)                             0279 01183000
*             CALL PUTIT1;          /* TO MESSAGE WRITER     @Y30LB12*/ 01184000
         BAL   @14,PUTIT1                                          0280 01185000
*           END;                    /*                       @Y30LB12*/ 01186000
*         ELSE                      /*                       @Y30LB12*/ 01187000
*           DO;                     /*                       @Y30LB12*/ 01188000
         B     @RC00276                                            0282 01189000
@RF00276 DS    0H                                                  0283 01190000
*             CALL FINDSLOT;        /* TO LOCATE LIB CU      @Y30LB12*/ 01191000
         BAL   @14,FINDSLOT                                        0283 01192000
*             IF STOPSCAN^='1'B     /* IF NO ERROR           @Y30LB12*/ 01193000
*               THEN                /*                       @Y30LB12*/ 01194000
         TM    STOPSCAN,B'10000000'                                0284 01195000
         BO    @RF00284                                            0284 01196000
*               DO;                 /*                       @YM32160*/ 01197000
*                 IF HAVECUID(I)='1'B/*                      @YM32160*/ 01198000
*                   THEN            /*                       @YM32160*/ 01199000
         LH    @10,I                                               0286 01200000
         LR    @05,@10                                             0286 01201000
         ALR   @05,@05                                             0286 01202000
         LA    @01,HAVECUID-2(@05)                                 0286 01203000
         TM    0(@01),B'10000000'                                  0286 01204000
         BNO   @RF00286                                            0286 01205000
*                   LOWSPEC(DSINDEX,I)='1'B;/*               @YM32160*/ 01206000
         LH    @05,DSINDEX                                         0287 01207000
         SLA   @05,2                                               0287 01208000
         ALR   @05,@10                                             0287 01209000
         ALR   @05,@05                                             0287 01210000
         ALR   @05,R4                                              0287 01211000
         OI    LOWSPEC-10(@05),B'10000000'                         0287 01212000
*                 IF RDWR01(I)='1'B /*                       @YM32160*/ 01213000
*                   THEN            /*                       @YM32160*/ 01214000
@RF00286 LH    @10,I                                               0288 01215000
         LR    @05,@10                                             0288 01216000
         ALR   @05,@05                                             0288 01217000
         LA    @01,RDWR01-2(@05)                                   0288 01218000
         TM    0(@01),B'01000000'                                  0288 01219000
         BNO   @RF00288                                            0288 01220000
*                   LOWRW01(DSINDEX,I)='1'B;/*               @YM32160*/ 01221000
         LH    @05,DSINDEX                                         0289 01222000
         SLA   @05,2                                               0289 01223000
         ALR   @05,@10                                             0289 01224000
         ALR   @05,@05                                             0289 01225000
         ALR   @05,R4                                              0289 01226000
         OI    LOWRW01-10(@05),B'01000000'                         0289 01227000
*                 IF RDWR23(I)='1'B /*                       @YM32160*/ 01228000
*                   THEN            /*                       @YM32160*/ 01229000
@RF00288 LH    @10,I                                               0290 01230000
         LR    @05,@10                                             0290 01231000
         ALR   @05,@05                                             0290 01232000
         LA    @01,RDWR23-2(@05)                                   0290 01233000
         TM    0(@01),B'00100000'                                  0290 01234000
         BNO   @RF00290                                            0290 01235000
*                   LOWRW23(DSINDEX,I)='1'B;/*               @YM32160*/ 01236000
         LH    @05,DSINDEX                                         0291 01237000
         SLA   @05,2                                               0291 01238000
         ALR   @05,@10                                             0291 01239000
         ALR   @05,@05                                             0291 01240000
         ALR   @05,R4                                              0291 01241000
         OI    LOWRW23-10(@05),B'00100000'                         0291 01242000
*                 IF RDWR45(I)='1'B /*                       @YM32160*/ 01243000
*                   THEN            /*                       @YM32160*/ 01244000
@RF00290 LH    @10,I                                               0292 01245000
         LR    @05,@10                                             0292 01246000
         ALR   @05,@05                                             0292 01247000
         LA    @01,RDWR45-2(@05)                                   0292 01248000
         TM    0(@01),B'00010000'                                  0292 01249000
         BNO   @RF00292                                            0292 01250000
*                   LOWRW45(DSINDEX,I)='1'B;/*               @YM32160*/ 01251000
         LH    @05,DSINDEX                                         0293 01252000
         SLA   @05,2                                               0293 01253000
         ALR   @05,@10                                             0293 01254000
         ALR   @05,@05                                             0293 01255000
         ALR   @05,R4                                              0293 01256000
         OI    LOWRW45-10(@05),B'00010000'                         0293 01257000
*                 IF RDWR67(I)='1'B /*                       @YM32160*/ 01258000
*                   THEN            /*                       @YM32160*/ 01259000
@RF00292 LH    @10,I                                               0294 01260000
         LR    @05,@10                                             0294 01261000
         ALR   @05,@05                                             0294 01262000
         LA    @01,RDWR67-2(@05)                                   0294 01263000
         TM    0(@01),B'00001000'                                  0294 01264000
         BNO   @RF00294                                            0294 01265000
*                   LOWRW67(DSINDEX,I)='1'B;/*               @YM32160*/ 01266000
         LH    @05,DSINDEX                                         0295 01267000
         SLA   @05,2                                               0295 01268000
         ALR   @05,@10                                             0295 01269000
         ALR   @05,@05                                             0295 01270000
         ALR   @05,R4                                              0295 01271000
         OI    LOWRW67-10(@05),B'00001000'                         0295 01272000
*                 IF LEFT(I)='1'B   /*                       @YM32160*/ 01273000
*                   THEN            /*                       @YM32160*/ 01274000
@RF00294 LH    @10,I                                               0296 01275000
         LR    @05,@10                                             0296 01276000
         ALR   @05,@05                                             0296 01277000
         LA    @01,LEFT-2(@05)                                     0296 01278000
         TM    0(@01),B'00000100'                                  0296 01279000
         BNO   @RF00296                                            0296 01280000
*                   LOWLEFT(DSINDEX,I)='1'B;/*               @YM32160*/ 01281000
         LH    @05,DSINDEX                                         0297 01282000
         SLA   @05,2                                               0297 01283000
         ALR   @05,@10                                             0297 01284000
         ALR   @05,@05                                             0297 01285000
         ALR   @05,R4                                              0297 01286000
         OI    LOWLEFT-10(@05),B'00000100'                         0297 01287000
*                 IF RIGHT(I)='1'B  /*                       @YM32160*/ 01288000
*                   THEN            /*                       @YM32160*/ 01289000
@RF00296 LH    @10,I                                               0298 01290000
         LR    @05,@10                                             0298 01291000
         ALR   @05,@05                                             0298 01292000
         LA    @01,RIGHT-2(@05)                                    0298 01293000
         TM    0(@01),B'00000010'                                  0298 01294000
         BNO   @RF00298                                            0298 01295000
*                   LOWRGHT(DSINDEX,I)='1'B;/*               @YM32160*/ 01296000
         LH    @05,DSINDEX                                         0299 01297000
         SLA   @05,2                                               0299 01298000
         ALR   @05,@10                                             0299 01299000
         ALR   @05,@05                                             0299 01300000
         ALR   @05,R4                                              0299 01301000
         OI    LOWRGHT-10(@05),B'00000010'                         0299 01302000
*                 LOWLIB(DSINDEX,I)=WORKLIB(I);/*            @YM32160*/ 01303000
@RF00298 LH    @10,I                                               0300 01304000
         LH    @05,DSINDEX                                         0300 01305000
         SLA   @05,2                                               0300 01306000
         ALR   @05,@10                                             0300 01307000
         ALR   @05,@05                                             0300 01308000
         ALR   @05,R4                                              0300 01309000
         ALR   @10,@10                                             0300 01310000
         LA    @01,WORKLIB-2(@10)                                  0300 01311000
         MVC   LOWLIB-10(1,@05),0(@01)                             0300 01312000
*               END;                /*                       @YM32160*/ 01313000
*             ELSE                                                 0302 01314000
*               ;                   /*                       @Y30LB12*/ 01315000
@RF00284 DS    0H                                                  0303 01316000
*           END;                    /*                       @Y30LB12*/ 01317000
*       END;                        /*                       @Y30LB12*/ 01318000
*     ELSE                                                         0305 01319000
*       ;                           /*                       @Y30LB12*/ 01320000
@RF00274 DS    0H                                                  0306 01321000
*   END;                            /* END OF DO I           @Y30LB12*/ 01322000
@RC00274 LA    @10,1                                               0306 01323000
         AH    @10,I                                               0306 01324000
         STH   @10,I                                               0306 01325000
         CH    @10,@CH00068                                        0306 01326000
         BNH   @DL00273                                            0306 01327000
*   END S05BUILD;                   /* RET. TO MAINLINE      @Y30LB12*/ 01328000
@EL00011 DS    0H                                                  0307 01329000
@EF00011 DS    0H                                                  0307 01330000
@ER00011 LM    @14,@12,@SA00011                                    0307 01331000
         BR    @14                                                 0307 01332000
*                                                                  0308 01333000
*/********************************************************** @Y30LB12*/ 01334000
*/*                                                          @Y30LB12*/ 01335000
*/* PROCEDURE NAME - FINDSLOT                                @Y30LB12*/ 01336000
*/*                                                          @Y30LB12*/ 01337000
*/* FUNCTION - CHECK THE READ/WRITE CONTROLLER POSITION TO   @Y30LB12*/ 01338000
*/*            ASSIGN TO THIS DATA STAGER CONTROL UNIT       @Y30LB12*/ 01339000
*/*            INTERFACE.  IF LEFT-HAND INTERFACE FREE, USE  @Y30LB12*/ 01340000
*/*            IT.  IF LEFT INTERFACE NOT FREE, USE RIGHT-   @Y30LB12*/ 01341000
*/*            HAND INTERFACE, IF IT IS FREE.  IF BOTH       @Y30LB12*/ 01342000
*/*            INTERFACES ALREADY IN USE, WRITE MESSAGE      @Y30LB12*/ 01343000
*/*            ICG231I.                                      @Y30LB12*/ 01344000
*/*                                                          @Y30LB12*/ 01345000
*/********************************************************** @Y30LB12*/ 01346000
*                                                                  0308 01347000
*FINDSLOT:                                                         0308 01348000
*   PROCEDURE;                      /*                       @Y30LB12*/ 01349000
FINDSLOT STM   @14,@12,@SA00012                                    0308 01350000
*   HEXCHAR=WORKLIB(I);             /*                       @Y30LB12*/ 01351000
         LH    @10,I                                               0309 01352000
         ALR   @10,@10                                             0309 01353000
         LA    @05,WORKLIB-2(@10)                                  0309 01354000
         MVC   HEXCHAR(1),0(@05)                                   0309 01355000
*   HIGHHEX='0000'B;                /*                       @Y30LB12*/ 01356000
         NI    HIGHHEX,B'00001111'                                 0310 01357000
*   HEXINDEX=HEXCHAR+1;             /*                       @Y30LB12*/ 01358000
         LA    @05,1                                               0311 01359000
         MVC   @ZT00003+3(1),HEXCHAR                               0311 01360000
         AL    @05,@ZT00003                                        0311 01361000
         STH   @05,HEXINDEX                                        0311 01362000
*   IF RDWR01(I)='1'B               /* FOR READ/WRITE 01     @Y30LB12*/ 01363000
*     THEN                          /*                       @Y30LB12*/ 01364000
         LA    @01,RDWR01-2(@10)                                   0312 01365000
         TM    0(@01),B'01000000'                                  0312 01366000
         BNO   @RF00312                                            0312 01367000
*     IF RW01LEFT(HEXINDEX)^='1'B   /* IF LEFT FREE          @Y30LB12*/ 01368000
*       THEN                        /*                       @Y30LB12*/ 01369000
         ALR   @05,R4                                              0313 01370000
         TM    RW01LEFT-1(@05),B'10000000'                         0313 01371000
         BO    @RF00313                                            0313 01372000
*       DO;                         /*                       @Y30LB12*/ 01373000
*         RW01LEFT(HEXINDEX)='1'B;  /* USE LEFT              @Y30LB12*/ 01374000
         LH    @05,HEXINDEX                                        0315 01375000
         ALR   @05,R4                                              0315 01376000
         OI    RW01LEFT-1(@05),B'10000000'                         0315 01377000
*         LEFT(I)='1'B;             /* SET LEFT INT USED     @Y30LB12*/ 01378000
         LA    @05,LEFT-2(@10)                                     0316 01379000
         OI    0(@05),B'00000100'                                  0316 01380000
*       END;                        /*                       @Y30LB12*/ 01381000
*     ELSE                          /*                       @Y30LB12*/ 01382000
*       IF RW01RGHT(HEXINDEX)^='1'B /* RT FREE               @Y30LB12*/ 01383000
*         THEN                      /*                       @Y30LB12*/ 01384000
         B     @RC00313                                            0318 01385000
@RF00313 LH    @10,HEXINDEX                                        0318 01386000
         ALR   @10,R4                                              0318 01387000
         TM    RW01RGHT-1(@10),B'01000000'                         0318 01388000
         BO    @RF00318                                            0318 01389000
*         DO;                       /*                       @Y30LB12*/ 01390000
*           RW01RGHT(HEXINDEX)='1'B;/* USE RT                @Y30LB12*/ 01391000
         LH    @10,HEXINDEX                                        0320 01392000
         ALR   @10,R4                                              0320 01393000
         OI    RW01RGHT-1(@10),B'01000000'                         0320 01394000
*           RIGHT(I)='1'B;          /* SET RIGHT USED        @Y30LB12*/ 01395000
         LH    @10,I                                               0321 01396000
         ALR   @10,@10                                             0321 01397000
         LA    @05,RIGHT-2(@10)                                    0321 01398000
         OI    0(@05),B'00000010'                                  0321 01399000
*         END;                      /*                       @Y30LB12*/ 01400000
*       ELSE                        /*                       @Y30LB12*/ 01401000
*         DO;                       /*                       @Y30LB12*/ 01402000
*                                                                  0323 01403000
         B     @RC00318                                            0323 01404000
@RF00318 DS    0H                                                  0324 01405000
*           /*********************************************************/ 01406000
*           /*                                                       */ 01407000
*           /* ***********************************           @Y30LB12*/ 01408000
*           /* ICG231I BOTH DRC0 CONTROLLER                  @Y30LB12*/ 01409000
*           /* INTERFACES ALREADY IN USE                     @Y30LB12*/ 01410000
*           /* ***********************************           @Y30LB12*/ 01411000
*           /*                                                       */ 01412000
*           /*********************************************************/ 01413000
*                                                                  0324 01414000
*           OUTBUF2(1:55)=ICGDS231; /*                       @Y30LB12*/ 01415000
         MVC   OUTBUF2(55,R4),ICGDS231                             0324 01416000
*           OUTBUF2(15:18)='DRC0';  /*                       @Y30LB12*/ 01417000
         MVC   OUTBUF2+14(4,R4),@CC00471                           0325 01418000
*           CALL PUTIT1;            /* TO MESSAGE WRITER     @Y30LB12*/ 01419000
         BAL   @14,PUTIT1                                          0326 01420000
*         END;                      /*                       @Y30LB12*/ 01421000
*   IF RDWR23(I)='1'B               /* FOR READ/WRITE 23     @Y30LB12*/ 01422000
*     THEN                          /*                       @Y30LB12*/ 01423000
@RC00318 DS    0H                                                  0328 01424000
@RC00313 DS    0H                                                  0328 01425000
@RF00312 LH    @10,I                                               0328 01426000
         ALR   @10,@10                                             0328 01427000
         LA    @05,RDWR23-2(@10)                                   0328 01428000
         TM    0(@05),B'00100000'                                  0328 01429000
         BNO   @RF00328                                            0328 01430000
*     IF RW23LEFT(HEXINDEX)^='1'B   /* IF LEFT FREE          @Y30LB12*/ 01431000
*       THEN                        /*                       @Y30LB12*/ 01432000
         LH    @05,HEXINDEX                                        0329 01433000
         ALR   @05,R4                                              0329 01434000
         TM    RW23LEFT-1(@05),B'00100000'                         0329 01435000
         BO    @RF00329                                            0329 01436000
*       DO;                         /*                       @Y30LB12*/ 01437000
*         RW23LEFT(HEXINDEX)='1'B;  /* USE LEFT              @Y30LB12*/ 01438000
         LH    @05,HEXINDEX                                        0331 01439000
         ALR   @05,R4                                              0331 01440000
         OI    RW23LEFT-1(@05),B'00100000'                         0331 01441000
*         LEFT(I)='1'B;             /* SET LEFT INT USED     @Y30LB12*/ 01442000
         LA    @05,LEFT-2(@10)                                     0332 01443000
         OI    0(@05),B'00000100'                                  0332 01444000
*       END;                        /*                       @Y30LB12*/ 01445000
*     ELSE                          /*                       @Y30LB12*/ 01446000
*       IF RW23RGHT(HEXINDEX)^='1'B /* RT FREE               @Y30LB12*/ 01447000
*         THEN                      /*                       @Y30LB12*/ 01448000
         B     @RC00329                                            0334 01449000
@RF00329 LH    @10,HEXINDEX                                        0334 01450000
         ALR   @10,R4                                              0334 01451000
         TM    RW23RGHT-1(@10),B'00010000'                         0334 01452000
         BO    @RF00334                                            0334 01453000
*         DO;                       /*                       @Y30LB12*/ 01454000
*           RW23RGHT(HEXINDEX)='1'B;/* USE RT                @Y30LB12*/ 01455000
         LH    @10,HEXINDEX                                        0336 01456000
         ALR   @10,R4                                              0336 01457000
         OI    RW23RGHT-1(@10),B'00010000'                         0336 01458000
*           RIGHT(I)='1'B;          /* SET RIGHT USED        @Y30LB12*/ 01459000
         LH    @10,I                                               0337 01460000
         ALR   @10,@10                                             0337 01461000
         LA    @05,RIGHT-2(@10)                                    0337 01462000
         OI    0(@05),B'00000010'                                  0337 01463000
*         END;                      /*                       @Y30LB12*/ 01464000
*       ELSE                        /*                       @Y30LB12*/ 01465000
*         DO;                       /*                       @Y30LB12*/ 01466000
*                                                                  0339 01467000
         B     @RC00334                                            0339 01468000
@RF00334 DS    0H                                                  0340 01469000
*           /*********************************************************/ 01470000
*           /*                                                       */ 01471000
*           /* *********************************             @Y30LB12*/ 01472000
*           /* ICG231I BOTH DRC1 CONTROLLER                  @Y30LB12*/ 01473000
*           /* INTERFACES ALREADY IN USE                     @Y30LB12*/ 01474000
*           /* *********************************             @Y30LB12*/ 01475000
*           /*                                                       */ 01476000
*           /*********************************************************/ 01477000
*                                                                  0340 01478000
*           OUTBUF2(1:55)=ICGDS231; /*                       @Y30LB12*/ 01479000
         MVC   OUTBUF2(55,R4),ICGDS231                             0340 01480000
*           OUTBUF2(15:18)='DRC1';  /*                       @Y30LB12*/ 01481000
         MVC   OUTBUF2+14(4,R4),@CC00472                           0341 01482000
*           CALL PUTIT1;            /* TO MESSAGE WRITER     @Y30LB12*/ 01483000
         BAL   @14,PUTIT1                                          0342 01484000
*         END;                      /*                       @Y30LB12*/ 01485000
*   IF RDWR45(I)='1'B               /* FOR READ/WRITE 45     @Y30LB12*/ 01486000
*     THEN                          /*                       @Y30LB12*/ 01487000
@RC00334 DS    0H                                                  0344 01488000
@RC00329 DS    0H                                                  0344 01489000
@RF00328 LH    @10,I                                               0344 01490000
         ALR   @10,@10                                             0344 01491000
         LA    @05,RDWR45-2(@10)                                   0344 01492000
         TM    0(@05),B'00010000'                                  0344 01493000
         BNO   @RF00344                                            0344 01494000
*     IF RW45LEFT(HEXINDEX)^='1'B   /* IF LEFT FREE          @Y30LB12*/ 01495000
*       THEN                        /*                       @Y30LB12*/ 01496000
         LH    @05,HEXINDEX                                        0345 01497000
         ALR   @05,R4                                              0345 01498000
         TM    RW45LEFT-1(@05),B'00001000'                         0345 01499000
         BO    @RF00345                                            0345 01500000
*       DO;                         /*                       @Y30LB12*/ 01501000
*         RW45LEFT(HEXINDEX)='1'B;  /* USE LEFT              @Y30LB12*/ 01502000
         LH    @05,HEXINDEX                                        0347 01503000
         ALR   @05,R4                                              0347 01504000
         OI    RW45LEFT-1(@05),B'00001000'                         0347 01505000
*         LEFT(I)='1'B;             /* SET LEFT INT USED     @Y30LB12*/ 01506000
         LA    @05,LEFT-2(@10)                                     0348 01507000
         OI    0(@05),B'00000100'                                  0348 01508000
*       END;                        /*                       @Y30LB12*/ 01509000
*     ELSE                          /*                       @Y30LB12*/ 01510000
*       IF RW45RGHT(HEXINDEX)^='1'B /* RT FREE               @Y30LB12*/ 01511000
*         THEN                      /*                       @Y30LB12*/ 01512000
         B     @RC00345                                            0350 01513000
@RF00345 LH    @10,HEXINDEX                                        0350 01514000
         ALR   @10,R4                                              0350 01515000
         TM    RW45RGHT-1(@10),B'00000100'                         0350 01516000
         BO    @RF00350                                            0350 01517000
*         DO;                       /*                       @Y30LB12*/ 01518000
*           RW45RGHT(HEXINDEX)='1'B;/* USE RT                @Y30LB12*/ 01519000
         LH    @10,HEXINDEX                                        0352 01520000
         ALR   @10,R4                                              0352 01521000
         OI    RW45RGHT-1(@10),B'00000100'                         0352 01522000
*           RIGHT(I)='1'B;          /* SET RIGHT USED        @Y30LB12*/ 01523000
         LH    @10,I                                               0353 01524000
         ALR   @10,@10                                             0353 01525000
         LA    @05,RIGHT-2(@10)                                    0353 01526000
         OI    0(@05),B'00000010'                                  0353 01527000
*         END;                      /*                       @Y30LB12*/ 01528000
*       ELSE                        /*                       @Y30LB12*/ 01529000
*         DO;                       /*                       @Y30LB12*/ 01530000
*                                                                  0355 01531000
         B     @RC00350                                            0355 01532000
@RF00350 DS    0H                                                  0356 01533000
*           /*********************************************************/ 01534000
*           /*                                                       */ 01535000
*           /* *********************************             @Y30LB12*/ 01536000
*           /* ICG231I BOTH DRC2 CONTROLLER                  @Y30LB12*/ 01537000
*           /* INTERFACES ALREADY IN USE                     @Y30LB12*/ 01538000
*           /* *********************************             @Y30LB12*/ 01539000
*           /*                                                       */ 01540000
*           /*********************************************************/ 01541000
*                                                                  0356 01542000
*           OUTBUF2(1:55)=ICGDS231; /*                       @Y30LB12*/ 01543000
         MVC   OUTBUF2(55,R4),ICGDS231                             0356 01544000
*           OUTBUF2(15:18)='DRC2';  /*                       @Y30LB12*/ 01545000
         MVC   OUTBUF2+14(4,R4),@CC00473                           0357 01546000
*           CALL PUTIT1;            /* TO MESSAGE WRITER     @Y30LB12*/ 01547000
         BAL   @14,PUTIT1                                          0358 01548000
*         END;                      /*                       @Y30LB12*/ 01549000
*   IF RDWR67(I)='1'B               /* FOR READ/WRITE 67     @Y30LB12*/ 01550000
*     THEN                          /*                       @Y30LB12*/ 01551000
@RC00350 DS    0H                                                  0360 01552000
@RC00345 DS    0H                                                  0360 01553000
@RF00344 LH    @10,I                                               0360 01554000
         ALR   @10,@10                                             0360 01555000
         LA    @05,RDWR67-2(@10)                                   0360 01556000
         TM    0(@05),B'00001000'                                  0360 01557000
         BNO   @RF00360                                            0360 01558000
*     IF RW67LEFT(HEXINDEX)^='1'B   /* IF LEFT FREE          @Y30LB12*/ 01559000
*       THEN                        /*                       @Y30LB12*/ 01560000
         LH    @05,HEXINDEX                                        0361 01561000
         ALR   @05,R4                                              0361 01562000
         TM    RW67LEFT-1(@05),B'00000010'                         0361 01563000
         BO    @RF00361                                            0361 01564000
*       DO;                         /*                       @Y30LB12*/ 01565000
*         RW67LEFT(HEXINDEX)='1'B;  /* USE LEFT              @Y30LB12*/ 01566000
         LH    @05,HEXINDEX                                        0363 01567000
         ALR   @05,R4                                              0363 01568000
         OI    RW67LEFT-1(@05),B'00000010'                         0363 01569000
*         LEFT(I)='1'B;             /* SET LEFT INT USED     @Y30LB12*/ 01570000
         LA    @05,LEFT-2(@10)                                     0364 01571000
         OI    0(@05),B'00000100'                                  0364 01572000
*       END;                        /*                       @Y30LB12*/ 01573000
*     ELSE                          /*                       @Y30LB12*/ 01574000
*       IF RW67RGHT(HEXINDEX)^='1'B /* RT FREE               @Y30LB12*/ 01575000
*         THEN                      /*                       @Y30LB12*/ 01576000
         B     @RC00361                                            0366 01577000
@RF00361 LH    @10,HEXINDEX                                        0366 01578000
         ALR   @10,R4                                              0366 01579000
         TM    RW67RGHT-1(@10),B'00000001'                         0366 01580000
         BO    @RF00366                                            0366 01581000
*         DO;                       /*                       @Y30LB12*/ 01582000
*           RW67RGHT(HEXINDEX)='1'B;/* USE RT                @Y30LB12*/ 01583000
         LH    @10,HEXINDEX                                        0368 01584000
         ALR   @10,R4                                              0368 01585000
         OI    RW67RGHT-1(@10),B'00000001'                         0368 01586000
*           RIGHT(I)='1'B;          /* SET RIGHT USED        @Y30LB12*/ 01587000
         LH    @10,I                                               0369 01588000
         ALR   @10,@10                                             0369 01589000
         LA    @05,RIGHT-2(@10)                                    0369 01590000
         OI    0(@05),B'00000010'                                  0369 01591000
*         END;                      /*                       @Y30LB12*/ 01592000
*       ELSE                        /*                       @Y30LB12*/ 01593000
*         DO;                       /*                       @Y30LB12*/ 01594000
*                                                                  0371 01595000
         B     @RC00366                                            0371 01596000
@RF00366 DS    0H                                                  0372 01597000
*           /*********************************************************/ 01598000
*           /*                                                       */ 01599000
*           /* *********************************             @Y30LB12*/ 01600000
*           /* IDG231I BOTH DRC3 CONTROLLER                  @Y30LB12*/ 01601000
*           /* INTERFACES ALREADY IN USE                     @Y30LB12*/ 01602000
*           /* *********************************             @Y30LB12*/ 01603000
*           /*                                                       */ 01604000
*           /*********************************************************/ 01605000
*                                                                  0372 01606000
*           OUTBUF2(1:55)=ICGDS231; /*                       @Y30LB12*/ 01607000
         MVC   OUTBUF2(55,R4),ICGDS231                             0372 01608000
*           OUTBUF2(15:18)='DRC3';  /*                       @Y30LB12*/ 01609000
         MVC   OUTBUF2+14(4,R4),@CC00474                           0373 01610000
*           CALL PUTIT1;            /* TO MESSAGE WRITER     @Y30LB12*/ 01611000
         BAL   @14,PUTIT1                                          0374 01612000
*         END;                      /*                       @Y30LB12*/ 01613000
*   END FINDSLOT;                   /* RET. TO S05BUILD      @Y30LB12*/ 01614000
@EL00012 DS    0H                                                  0376 01615000
@EF00012 DS    0H                                                  0376 01616000
@ER00012 LM    @14,@12,@SA00012                                    0376 01617000
         BR    @14                                                 0376 01618000
*                                                                  0377 01619000
*/********************************************************** @Y30LB12*/ 01620000
*/*                                                          @Y30LB12*/ 01621000
*/* PROCEDURE NAME - CONVHEX                                 @Y30LB12*/ 01622000
*/*                                                          @Y30LB12*/ 01623000
*/* FUNCTION - THIS PROCEDURE RECEIVES AS INPUT THE          @Y30LB12*/ 01624000
*/*            CHARACTER REPRESENTATION OF A SINGLE HEX      @Y30LB12*/ 01625000
*/*            CHARACTER IN 'HEXCHAR'.  IF THE DATA          @Y30LB12*/ 01626000
*/*            REPRESENTS A VALID HEXADECIMAL CHARACTER,     @Y30LB12*/ 01627000
*/*            IT IS CONVERTED TO BINARY IN 'HEXCHAR' AND    @Y30LB12*/ 01628000
*/*            'HEXINDEX' IS SET TO THE VALUE OF HEXCHAR+1   @Y30LB12*/ 01629000
*/*            IF THE CHARACTER IN 'HEXCHAR' IS NOT A VALUE  @YD00113*/ 01630000
*/*            BETWEEN 0 THRU 9 OR 'A' THRU 'F', ISSUE ERROR @YD00113*/ 01631000
*/*            MESSAGE ICG227I.                              @YD00113*/ 01632000
*/*                                                          @Y30LB12*/ 01633000
*/********************************************************** @Y30LB12*/ 01634000
*                                                                  0377 01635000
*CONVHEX:                                                          0377 01636000
*   PROCEDURE;                      /*                       @Y30LB12*/ 01637000
CONVHEX  STM   @14,@12,@SA00013                                    0377 01638000
*   HEXINDEX=0;                     /* INIT HEXINDEX         @Y30LB12*/ 01639000
         SLR   @10,@10                                             0378 01640000
         STH   @10,HEXINDEX                                        0378 01641000
*   IF HIGHHEX='1100'B              /* IF CHAR A-F           @Y30LB12*/ 01642000
*     THEN                          /*                       @Y30LB12*/ 01643000
         TM    HIGHHEX,B'11000000'                                 0379 01644000
         BNO   @RF00379                                            0379 01645000
         TM    HIGHHEX,B'00110000'                                 0379 01646000
         BNZ   @RF00379                                            0379 01647000
*     DO;                           /*                       @Y30LB12*/ 01648000
*       HIGHHEX='0000'B;                                           0381 01649000
         NI    HIGHHEX,B'00001111'                                 0381 01650000
*       ;                           /* ZERO ZONE PART        @Y30LB12*/ 01651000
*       HEXCHAR=HEXCHAR+9;          /* ADD 9 TO DIGIT        @Y30LB12*/ 01652000
         LA    @10,9                                               0383 01653000
         MVC   @ZT00003+3(1),HEXCHAR                               0383 01654000
         AL    @10,@ZT00003                                        0383 01655000
         STC   @10,HEXCHAR                                         0383 01656000
*     END;                          /*                       @Y30LB12*/ 01657000
*   ELSE                            /*                       @Y30LB12*/ 01658000
*     IF HIGHHEX='1111'B            /* IF CHAR 0-9           @Y30LB12*/ 01659000
*       THEN                        /*                       @Y30LB12*/ 01660000
         B     @RC00379                                            0385 01661000
@RF00379 TM    HIGHHEX,B'11110000'                                 0385 01662000
         BNO   @RF00385                                            0385 01663000
*       HIGHHEX='0000'B;            /* ZERO ZONE PART        @YD00113*/ 01664000
         NI    HIGHHEX,B'00001111'                                 0386 01665000
*     ELSE                                                         0387 01666000
*       ;                           /*                       @Y30LB12*/ 01667000
@RF00385 DS    0H                                                  0388 01668000
*   IF HIGHHEX^='0000'B             /* IF ZONE NOT ZERO      @Y30LB12*/ 01669000
*     THEN                          /*                       @Y30LB12*/ 01670000
@RC00379 TM    HIGHHEX,B'11110000'                                 0388 01671000
         BZ    @RF00388                                            0388 01672000
*     DO;                           /*                       @Y30LB12*/ 01673000
*                                                                  0389 01674000
*       /*************************************************************/ 01675000
*       /*                                                           */ 01676000
*       /* *****************************************         @Y30LB12*/ 01677000
*       /* ICG227I PARAMETER MUST BE HEXADECIMAL,            @Y30LB12*/ 01678000
*       /* KEYWORD IS (SA)                                   @Y30LB12*/ 01679000
*       /* *****************************************         @Y30LB12*/ 01680000
*       /*                                                           */ 01681000
*       /*************************************************************/ 01682000
*                                                                  0390 01683000
*       OUTBUF2(1:51)=ICGDS227;     /*                       @Y30LB12*/ 01684000
         MVC   OUTBUF2(51,R4),ICGDS227                             0390 01685000
*       OUTBUF2(52:59)=PLUGIN;      /*                       @Y30LB12*/ 01686000
         MVC   OUTBUF2+51(8,R4),PLUGIN                             0391 01687000
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/ 01688000
         BAL   @14,PUTIT1                                          0392 01689000
*     END;                          /*                       @Y30LB12*/ 01690000
*   ELSE                            /*                       @Y30LB12*/ 01691000
*     HEXINDEX=HEXCHAR+1;           /* RETURN VALUE          @Y30LB12*/ 01692000
         B     @RC00388                                            0394 01693000
@RF00388 LA    @10,1                                               0394 01694000
         MVC   @ZT00003+3(1),HEXCHAR                               0394 01695000
         AL    @10,@ZT00003                                        0394 01696000
         STH   @10,HEXINDEX                                        0394 01697000
*   END CONVHEX;                                                   0395 01698000
@EL00013 DS    0H                                                  0395 01699000
@EF00013 DS    0H                                                  0395 01700000
@ER00013 LM    @14,@12,@SA00013                                    0395 01701000
         BR    @14                                                 0395 01702000
*                                                                  0396 01703000
*/********************************************************** @Y30LB12*/ 01704000
*/*                                                          @Y30LB12*/ 01705000
*/* PROCEDURE NAME - CONVBIN                                 @Y30LB12*/ 01706000
*/*                                                          @Y30LB12*/ 01707000
*/* FUNCTION - THIS PROCEDURE RECEIVES AS INPUT THE          @Y30LB12*/ 01708000
*/*            CHARACTER REPRESENTATION OF TWO BINARY BITS   @Y30LB12*/ 01709000
*/*            IN 'BINCHAR'.  IF THE CHARACTERS REPRESENT    @Y30LB12*/ 01710000
*/*            TWO VALID BINARY BITS, 'BININDEX' IS SET TO   @Y30LB12*/ 01711000
*/*            A HALFWORD EQUAL TO THE VALUE OF BINCHAR+1.   @Y30LB12*/ 01712000
*/*                                                          @Y30LB12*/ 01713000
*/********************************************************** @Y30LB12*/ 01714000
*                                                                  0396 01715000
*CONVBIN:                                                          0396 01716000
*   PROCEDURE;                      /*                       @Y30LB12*/ 01717000
CONVBIN  STM   @14,@12,12(@13)                                     0396 01718000
*   BININDEX=0;                     /* INIT BININDEX         @Y30LB12*/ 01719000
*                                                                  0397 01720000
         SLR   @10,@10                                             0397 01721000
         STH   @10,BININDEX                                        0397 01722000
*   /*****************************************************************/ 01723000
*   /*                                                               */ 01724000
*   /* ***********************************************       @YM31085*/ 01725000
*   /* OBTAIN IN BININDEX THE BINARY EQUIVALENT + 1          @YM31085*/ 01726000
*   /* OF THE CHARACTER REPRESENTATION OF TWO BINARY         @YM31085*/ 01727000
*   /* BITS.                                                 @YM31085*/ 01728000
*   /* ***********************************************       @YM31085*/ 01729000
*   /*                                                               */ 01730000
*   /*****************************************************************/ 01731000
*                                                                  0398 01732000
*   DO I=1 TO MAXCU;                /* 4 POSSIBILITIES       @YM31085*/ 01733000
         LA    @10,1                                               0398 01734000
         STH   @10,I                                               0398 01735000
@DL00398 DS    0H                                                  0399 01736000
*     IF BINCHAR=CULOOKUP(I)        /* IF MATCH              @YM31085*/ 01737000
*       THEN                        /*                       @YM31085*/ 01738000
         LR    @05,@10                                             0399 01739000
         ALR   @05,@05                                             0399 01740000
         LA    @01,CULOOKUP-2(@05)                                 0399 01741000
         CLC   BINCHAR(2),0(@01)                                   0399 01742000
         BNE   @RF00399                                            0399 01743000
*       BININDEX=I;                 /* I = 1, 2, 3, OR 4     @YM31085*/ 01744000
         STH   @10,BININDEX                                        0400 01745000
*     ELSE                                                         0401 01746000
*       ;                           /*                       @YM31085*/ 01747000
@RF00399 DS    0H                                                  0402 01748000
*   END;                            /*                       @YM31085*/ 01749000
         LA    @10,1                                               0402 01750000
         AH    @10,I                                               0402 01751000
         STH   @10,I                                               0402 01752000
         CH    @10,@CH00068                                        0402 01753000
         BNH   @DL00398                                            0402 01754000
*   END CONVBIN;                    /* RET. TO S05CUID       @Y30LB12*/ 01755000
@EL00014 DS    0H                                                  0403 01756000
@EF00014 DS    0H                                                  0403 01757000
@ER00014 LM    @14,@12,12(@13)                                     0403 01758000
         BR    @14                                                 0403 01759000
*                                                                  0404 01760000
*/***********************************************************@Y30LB12*/ 01761000
*/*                                                          @Y30LB12*/ 01762000
*/* PROCEDURE NAME - READS99                                 @Y30LB12*/ 01763000
*/*                                                          @Y30LB12*/ 01764000
*/* FUNCTION - CALL SCAN READ KEYWORD/PARAMETER SUBROUTINE   @Y30LB12*/ 01765000
*/*            ICGDSS99.  PICK UP STARTING COLUMN FOR THIS   @Y30LB12*/ 01766000
*/*            SCAN AND STARTING COLUMN FOR NEXT ENTRY INTO  @Y30LB12*/ 01767000
*/*            ICGDSS99.  IF TERMINATING ERROR OCCURS IN     @Y30LB12*/ 01768000
*/*            ICGDSS99, SET 'LASTPARM' TO TERMINATE IN THIS @Y30LB12*/ 01769000
*/*            MODULE ON NEXT READ OF KEYWORD                @Y30LB12*/ 01770000
*/*                                                          @Y30LB12*/ 01771000
*/***********************************************************@Y30LB12*/ 01772000
*                                                                  0404 01773000
*READS99:                                                          0404 01774000
*   PROCEDURE;                      /*                       @Y30LB12*/ 01775000
READS99  STM   @14,@12,@SA00015                                    0404 01776000
*   GEN(LINK EP=ICGDSS99);          /* TO SCAN KEYWORD/PARAMETER     */ 01777000
*                                                                  0405 01778000
         LINK EP=ICGDSS99                                               01779000
*   /*****************************************************************/ 01780000
*   /*                                                               */ 01781000
*   /* ************************************************@Y30LB12 IF   */ 01782000
*   /* 'ENDSCAN' BIT IS ON, WE ENCOUNTERED SOME              @Y30LB12*/ 01783000
*   /* DISASTEROUS CONDITION THAT TERMINATED THE SCAN        @Y30LB12*/ 01784000
*   /* OF THIS CONTROL STATEMENT. THERE ERRORS ARE           @Y30LB12*/ 01785000
*   /* ASSOCIATED WITH SCANNING INTO COLUMN 73 AND           @Y30LB12*/ 01786000
*   /* WITH FINDING A FORMAT ERROR IN THE                    @Y30LB12*/ 01787000
*   /* CONTINUATION STATEMENT. SHOULD SUCH A                 @Y30LB12*/ 01788000
*   /* CONDITION OCCUR, WE TERMINATE SCAN OF THE             @Y30LB12*/ 01789000
*   /* CONTROL STATEMENT UPON READ OF THE NEXT               @Y30LB12*/ 01790000
*   /* KEYWORD.                                              @Y30LB12*/ 01791000
*   /* ************************************************@Y30LB12      */ 01792000
*   /*                                                               */ 01793000
*   /*****************************************************************/ 01794000
*                                                                  0406 01795000
*   IF ENDSCAN='1'B                 /*                       @Y30LB12*/ 01796000
*     THEN                          /*                       @Y30LB12*/ 01797000
         TM    ENDSCAN(R4),B'00010000'                             0406 01798000
         BNO   @RF00406                                            0406 01799000
*     LASTPARM='1'B;                /*                       @Y30LB12*/ 01800000
         OI    LASTPARM(R4),B'00001000'                            0407 01801000
*   ELSE                                                           0408 01802000
*     ;                             /*                       @Y30LB12*/ 01803000
@RF00406 DS    0H                                                  0409 01804000
*   END READS99;                    /*                       @Y30LB12*/ 01805000
@EL00015 DS    0H                                                  0409 01806000
@EF00015 DS    0H                                                  0409 01807000
@ER00015 LM    @14,@12,@SA00015                                    0409 01808000
         BR    @14                                                 0409 01809000
*                                                                  0410 01810000
*/***********************************************************@Y30LB12*/ 01811000
*/*                                                          @Y30LB12*/ 01812000
*/* PROCEDURE NAME - PUTIT1                                  @Y30LB12*/ 01813000
*/*                                                          @Y30LB12*/ 01814000
*/* FUNCTION - CALL ICGDSMSG, MESSAGE PRINT SUBROUTINE, TO   @Y30LB12*/ 01815000
*/*            PUT TERMINATING MESSAGE FOR WHICH TEXT IS NOT @Y30LB12*/ 01816000
*/*            IN ICGDSMSG BUT ALREADY BUILT IN 'OUTBUF2'    @Y30LB12*/ 01817000
*/*                                                          @Y30LB12*/ 01818000
*/***********************************************************@Y30LB12*/ 01819000
*                                                                  0410 01820000
*PUTIT1:                                                           0410 01821000
*   PROCEDURE;                      /*                       @Y30LB12*/ 01822000
PUTIT1   STM   @14,@12,@SA00016                                    0410 01823000
*   STOPSCAN='1'B;                  /*                       @Y30LB12*/ 01824000
         OI    STOPSCAN,B'10000000'                                0411 01825000
*   PRNTBUF2='1'B;                  /*                       @Y30LB12*/ 01826000
         OI    PRNTBUF2(R4),B'00000001'                            0412 01827000
*   TERMINAT=TERMINAT+1;            /*                       @Y30LB12*/ 01828000
         LA    @10,1                                               0413 01829000
         AH    @10,TERMINAT(,R4)                                   0413 01830000
         STH   @10,TERMINAT(,R4)                                   0413 01831000
*   GEN(LINK  EP=ICGDSMSG);         /*                       @Y30LB12*/ 01832000
         LINK  EP=ICGDSMSG                                              01833000
*   PRNTBUF2='0'B;                  /*                       @Y30LB12*/ 01834000
         NI    PRNTBUF2(R4),B'11111110'                            0415 01835000
*   END PUTIT1;                     /*                       @Y30LB12*/ 01836000
@EL00016 DS    0H                                                  0416 01837000
@EF00016 DS    0H                                                  0416 01838000
@ER00016 LM    @14,@12,@SA00016                                    0416 01839000
         BR    @14                                                 0416 01840000
*                                                                  0417 01841000
*/***********************************************************@Y30LB12*/ 01842000
*/*                                                          @Y30LB12*/ 01843000
*/* PROCEDURE NAME - PUTIT2                                  @Y30LB12*/ 01844000
*/*                                                          @Y30LB12*/ 01845000
*/* FUNCTION - CALL ICGDSMSG, MESSAGE PRINT SUBROUTINE, TO   @Y30LB12*/ 01846000
*/*            PUT TERMINATING MESSAGE FOR WHICH MESSAGE     @Y30LB12*/ 01847000
*/*            TEXT IS IN ICGDSMSG.  'MSGNO' INDICATES THE   @Y30LB12*/ 01848000
*/*            OFFSET OF THE MESSAGE TEXT.                   @Y30LB12*/ 01849000
*/*                                                          @Y30LB12*/ 01850000
*/***********************************************************@Y30LB12*/ 01851000
*                                                                  0417 01852000
*PUTIT2:                                                           0417 01853000
*   PROCEDURE;                      /*                       @Y30LB12*/ 01854000
PUTIT2   STM   @14,@12,@SA00017                                    0417 01855000
*   STOPSCAN='1'B;                  /*                       @Y30LB12*/ 01856000
         OI    STOPSCAN,B'10000000'                                0418 01857000
*   TERMINAT=TERMINAT+1;            /*                       @Y30LB12*/ 01858000
         LA    @10,1                                               0419 01859000
         AH    @10,TERMINAT(,R4)                                   0419 01860000
         STH   @10,TERMINAT(,R4)                                   0419 01861000
*   GEN(LINK  EP=ICGDSMSG);         /*                       @Y30LB12*/ 01862000
         LINK  EP=ICGDSMSG                                              01863000
*   END PUTIT2;                     /*                       @Y30LB12*/ 01864000
@EL00017 DS    0H                                                  0421 01865000
@EF00017 DS    0H                                                  0421 01866000
@ER00017 LM    @14,@12,@SA00017                                    0421 01867000
         BR    @14                                                 0421 01868000
*                                                                  0422 01869000
*/********************************************************** @Y30LB12*/ 01870000
*/*                                                          @Y30LB12*/ 01871000
*/*                    P A T C H   A R E A                   @Y30LB12*/ 01872000
*/*                                                          @Y30LB12*/ 01873000
*/********************************************************** @Y30LB12*/ 01874000
*                                                                  0422 01875000
*   GENERATE;                                                      0422 01876000
*                                                         /*@Y30LB12*/  01877000
PATCHS05 DC    32C'PATCHS05'                              /*@Y30LB12*/  01878000
*   END ICGDSS05                    /*                       @Y30LB12*/ 01879000
*                                                                  0423 01880000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 01881000
*/*%INCLUDE SYSLIB  (ICGDSMAC)                                       */ 01882000
*/*%INCLUDE SYSLIB  (ICGDSMA1)                                       */ 01883000
*/*%INCLUDE SYSLIB  (ICGDSMA2)                                       */ 01884000
*/*%INCLUDE SYSLIB  (ICGDSMA3)                                       */ 01885000
*                                                                  0423 01886000
*       ;                                                          0423 01887000
         B     @EL00001                                            0423 01888000
@DATA    DS    0H                                                       01889000
@CH00042 DC    H'1'                                                     01890000
@CH00068 DC    H'4'                                                     01891000
@DATD    DSECT                                                          01892000
         DS    0F                                                       01893000
@SA00001 DS    18F                                                      01894000
@SA00003 DS    15F                                                      01895000
@SA00010 DS    15F                                                      01896000
@SA00011 DS    15F                                                      01897000
@SA00015 DS    15F                                                      01898000
@SA00017 DS    15F                                                      01899000
@SA00004 DS    15F                                                      01900000
@SA00005 DS    15F                                                      01901000
@SA00009 DS    15F                                                      01902000
@SA00016 DS    15F                                                      01903000
@SA00013 DS    15F                                                      01904000
@SA00006 DS    15F                                                      01905000
@SA00007 DS    15F                                                      01906000
@SA00008 DS    15F                                                      01907000
@SA00012 DS    15F                                                      01908000
@ZTEMPS  DS    0F                                                       01909000
@ZT00003 DC    F'0'                                                     01910000
@ZTEMPND EQU   *                                                        01911000
@ZLEN    EQU   @ZTEMPND-@ZTEMPS                                         01912000
ICGDSS05 CSECT                                                          01913000
         DS    0F                                                       01914000
@DATD    DSECT                                                          01915000
         DS    0D                                                       01916000
LOWWORKA DS    CL37                                                     01917000
         ORG   LOWWORKA                                                 01918000
I        DS    FL2                                                      01919000
BININDEX DS    FL2                                                      01920000
HEXINDEX DS    FL2                                                      01921000
DSINDEX  DS    FL2                                                      01922000
CUINDEX  DS    FL2                                                      01923000
CUIDS    DS    CL2                                                      01924000
         ORG   CUIDS+0                                                  01925000
CUID     DS    CL2                                                      01926000
         ORG   CUID+0                                                   01927000
FLAGS    DS    BL1                                                      01928000
         ORG   FLAGS+0                                                  01929000
HAVECUID DS    BL1                                                      01930000
RDWRS    EQU   FLAGS+0                                                  01931000
         ORG   RDWRS+0                                                  01932000
RDWR01   EQU   RDWRS+0                                                  01933000
RDWR23   EQU   RDWRS+0                                                  01934000
RDWR45   EQU   RDWRS+0                                                  01935000
RDWR67   EQU   RDWRS+0                                                  01936000
         ORG   FLAGS+0                                                  01937000
LEFT     EQU   FLAGS+0                                                  01938000
RIGHT    EQU   FLAGS+0                                                  01939000
@NM00020 EQU   FLAGS+0                                                  01940000
         ORG   CUID+1                                                   01941000
WORKLIB  DS    CL1                                                      01942000
         ORG   WORKLIB+0                                                01943000
ONEBITS  DS    BL1                                                      01944000
ZEROBITS EQU   WORKLIB+0                                                01945000
DONTCARE EQU   WORKLIB+0                                                01946000
         ORG   LOWWORKA+18                                              01947000
HAVEFLAG DS    BL1                                                      01948000
         ORG   HAVEFLAG+0                                               01949000
HAVEMSF  DS    BL1                                                      01950000
HAVEDRC  EQU   HAVEFLAG+0                                               01951000
@NM00021 EQU   HAVEFLAG+0                                               01952000
         ORG   LOWWORKA+22                                              01953000
HEXCHAR  DS    CL1                                                      01954000
         ORG   HEXCHAR                                                  01955000
HIGHHEX  DS    BL1                                                      01956000
@NM00022 EQU   HEXCHAR+0                                                01957000
         ORG   LOWWORKA+23                                              01958000
BINCHAR  DS    CL2                                                      01959000
SAVECUID DS    CL2                                                      01960000
PLUGIN   DS    CL8                                                      01961000
HAVES    DS    CL1                                                      01962000
         ORG   HAVES                                                    01963000
HAVEDS   DS    BL1                                                      01964000
CUSPEC   EQU   HAVES+0                                                  01965000
@NM00023 EQU   HAVES+0                                                  01966000
         ORG   LOWWORKA+36                                              01967000
LOWMSGID DS    CL1                                                      01968000
         ORG   LOWMSGID                                                 01969000
STOPSCAN DS    BL1                                                      01970000
KNOWN    EQU   LOWMSGID+0                                               01971000
KNOWN2   EQU   LOWMSGID+0                                               01972000
ERROR    EQU   LOWMSGID+0                                               01973000
@NM00024 EQU   LOWMSGID+0                                               01974000
         ORG   LOWWORKA+37                                              01975000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                01976000
@ENDDATD EQU   *                                                        01977000
ICGDSS05 CSECT                                                          01978000
         DS    0F                                                       01979000
@SIZDATD DC    AL1(0)                                                   01980000
         DC    AL3(@ENDDATD-@DATD)                                      01981000
         DS    0D                                                       01982000
ICG209I  DC    H'209'                                                   01983000
ICG210I  DC    H'210'                                                   01984000
ICG211I  DC    H'211'                                                   01985000
ICG212I  DC    H'212'                                                   01986000
@CC00415 DC    C'SA      '                                              01987000
@CC00454 DC    C'DRCX'                                                  01988000
@CC00458 DC    C'MSFX'                                                  01989000
@CC00461 DC    C'CUXX'                                                  01990000
@CC00471 DC    C'DRC0'                                                  01991000
@CC00472 DC    C'DRC1'                                                  01992000
@CC00473 DC    C'DRC2'                                                  01993000
@CC00474 DC    C'DRC3'                                                  01994000
@CC00402 DC    C'SA='                                                   01995000
@CC00428 EQU   @CC00458                                                 01996000
@CC00430 EQU   @CC00454                                                 01997000
@CC00404 EQU   @CC00461                                                 01998000
@CC00412 EQU   @CC00415                                                 01999000
@CB00394 DC    X'0000'                                                  02000000
ICGDS219 DC    CL27' ICG219I DUPLICATE KEYWORD '                        02001000
ICGDS220 DC    CL46' ICG220I INVALID PARAMETER LENGTH, KEYWORD IS '     02002000
ICGDS221 DC    CL34' ICG221I MISSING REQUIRED KEYWORD '                 02003000
ICGDS227 DC    CL51' ICG227I PARAMETER MUST BE HEXADECIMAL. KEYWORD IS C02004000
               '                                                        02005000
ICGDS231 DC    CL55' ICG231I BOTH DRCX CONTROLLER INTERFACES ALREADY INC02006000
                USE'                                                    02007000
ICGDS233 DC    CL46' ICG233I CONTROL UNIT XX PREVIOUSLY SPECIFIED'      02008000
ICGDS234 DC    CL36' ICG234I 2 XXX SPECIFICATIONS FOR CU'               02009000
ICGDS235 DC    CL42' ICG235I RANGE ERROR IN SUFFIX OF KEYWORD '         02010000
ICGDS236 DC    CL35' ICG236I FORMAT ERROR IN PARAMETER '                02011000
ICGDS241 DC    CL36' ICG241I MISSING REQUIRED PARAMETER '               02012000
MSGADDON DC    CL7' FOR CU'                                             02013000
CULOOKUP DC    CL2'00'                                                  02014000
         DC    CL2'01'                                                  02015000
         DC    CL2'10'                                                  02016000
         DC    CL2'11'                                                  02017000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       02018000
@01      EQU   01                                                       02019000
@02      EQU   02                                                       02020000
@03      EQU   03                                                       02021000
@04      EQU   04                                                       02022000
@05      EQU   05                                                       02023000
@06      EQU   06                                                       02024000
@07      EQU   07                                                       02025000
@08      EQU   08                                                       02026000
@09      EQU   09                                                       02027000
@10      EQU   10                                                       02028000
@11      EQU   11                                                       02029000
@12      EQU   12                                                       02030000
@13      EQU   13                                                       02031000
@14      EQU   14                                                       02032000
@15      EQU   15                                                       02033000
R4       EQU   @04                                                      02034000
COMTAB   EQU   0                                                        02035000
READER   EQU   COMTAB+256                                               02036000
READFLAG EQU   READER+96                                                02037000
KEYBIT   EQU   READFLAG                                                 02038000
PARMBIT  EQU   READFLAG                                                 02039000
ENDSCAN  EQU   READFLAG                                                 02040000
LASTPARM EQU   READFLAG                                                 02041000
PCHBF    EQU   READER+99                                                02042000
STARTCOL EQU   READER+180                                               02043000
NEXTCOL  EQU   READER+184                                               02044000
SAVESCOL EQU   READER+188                                               02045000
SAVENCOL EQU   READER+192                                               02046000
SCANLEN  EQU   READER+204                                               02047000
PRINTER  EQU   COMTAB+464                                               02048000
OUTBUF2  EQU   PRINTER+225                                              02049000
MESSAGES EQU   COMTAB+810                                               02050000
MSGNO    EQU   MESSAGES+2                                               02051000
TERMINAT EQU   MESSAGES+6                                               02052000
SPECLMSG EQU   MESSAGES+18                                              02053000
PRNTBUF2 EQU   SPECLMSG                                                 02054000
GENIO    EQU   COMTAB+832                                               02055000
DCBPTR   EQU   GENIO+4                                                  02056000
COMPTR2  EQU   GENIO+16                                                 02057000
INVOKED  EQU   COMTAB+856                                               02058000
SAVEDDS  EQU   INVOKED+4                                                02059000
BUILDRSG EQU   COMTAB+900                                               02060000
RSGS     EQU   BUILDRSG                                                 02061000
RSG      EQU   RSGS                                                     02062000
RSGABOX  EQU   RSG                                                      02063000
RSGTODS  EQU   RSG+7                                                    02064000
LIBRARY  EQU   COMTAB+1170                                              02065000
LIBS     EQU   LIBRARY                                                  02066000
LIB      EQU   LIBS                                                     02067000
LIBBITS  EQU   LIB                                                      02068000
PABTABLE EQU   COMTAB+1218                                              02069000
PABDEV   EQU   PABTABLE                                                 02070000
PABFLAGS EQU   PABDEV                                                   02071000
PABREAL  EQU   PABDEV+1                                                 02072000
PABAADDD EQU   PABDEV+2                                                 02073000
DSPAIRS  EQU   COMTAB+1938                                              02074000
PHYSTYPE EQU   COMTAB+2002                                              02075000
PHYSFLGS EQU   PHYSTYPE                                                 02076000
MERLICEB EQU   PHYSFLGS                                                 02077000
CPUASSOC EQU   COMTAB+3026                                              02078000
CPUS     EQU   CPUASSOC+2                                               02079000
CPU      EQU   CPUS                                                     02080000
CPUFLAG1 EQU   CPU+6                                                    02081000
OPSYSTYP EQU   CPUFLAG1                                                 02082000
CPUFLAG2 EQU   CPU+7                                                    02083000
LOWERCON EQU   COMTAB+3156                                              02084000
LOWDSS   EQU   LOWERCON                                                 02085000
LOWFLGS  EQU   LOWDSS                                                   02086000
LOWSPEC  EQU   LOWFLGS                                                  02087000
LOWRW01  EQU   LOWFLGS                                                  02088000
LOWRW23  EQU   LOWFLGS                                                  02089000
LOWRW45  EQU   LOWFLGS                                                  02090000
LOWRW67  EQU   LOWFLGS                                                  02091000
LOWLEFT  EQU   LOWFLGS                                                  02092000
LOWRGHT  EQU   LOWFLGS                                                  02093000
LOWLIB   EQU   LOWDSS+1                                                 02094000
LIBCTL   EQU   COMTAB+3284                                              02095000
LIBCTLS  EQU   LIBCTL                                                   02096000
RW01LEFT EQU   LIBCTLS                                                  02097000
RW01RGHT EQU   LIBCTLS                                                  02098000
RW23LEFT EQU   LIBCTLS                                                  02099000
RW23RGHT EQU   LIBCTLS                                                  02100000
RW45LEFT EQU   LIBCTLS                                                  02101000
RW45RGHT EQU   LIBCTLS                                                  02102000
RW67LEFT EQU   LIBCTLS                                                  02103000
RW67RGHT EQU   LIBCTLS                                                  02104000
CREATE   EQU   COMTAB+3288                                              02105000
@NM00017 EQU   CREATE                                                   02106000
COMTAB2  EQU   0                                                        02107000
DSTORSG  EQU   COMTAB2                                                  02108000
DSENTRY  EQU   DSTORSG                                                  02109000
CONFGCON EQU   COMTAB2+32                                               02110000
RSGUCB   EQU   CONFGCON                                                 02111000
RSGFLAGS EQU   RSGUCB                                                   02112000
CONFGUCB EQU   COMTAB2+464                                              02113000
CONFGDEV EQU   CONFGUCB                                                 02114000
USEFLAGS EQU   CONFGDEV                                                 02115000
ALTPATH1 EQU   CONFGDEV+2                                               02116000
ALTPATH2 EQU   CONFGDEV+5                                               02117000
ALTPATH3 EQU   CONFGDEV+8                                               02118000
SCANDATA EQU   0                                                        02119000
SCANBUF  EQU   0                                                        02120000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    02121000
ALTCH3   EQU   ALTPATH3+2                                               02122000
ALTCI3   EQU   ALTPATH3+1                                               02123000
ALTDS3   EQU   ALTPATH3                                                 02124000
ALTCH2   EQU   ALTPATH2+2                                               02125000
ALTCI2   EQU   ALTPATH2+1                                               02126000
ALTDS2   EQU   ALTPATH2                                                 02127000
ALTCH1   EQU   ALTPATH1+2                                               02128000
ALTCI1   EQU   ALTPATH1+1                                               02129000
ALTDS1   EQU   ALTPATH1                                                 02130000
INDEXRSG EQU   CONFGDEV+1                                               02131000
ICEBERG  EQU   USEFLAGS                                                 02132000
ITISALTP EQU   USEFLAGS                                                 02133000
USECONVR EQU   USEFLAGS                                                 02134000
SUPPUNCH EQU   USEFLAGS                                                 02135000
USEREAL  EQU   USEFLAGS                                                 02136000
USEVS    EQU   USEFLAGS                                                 02137000
USEV     EQU   USEFLAGS                                                 02138000
USESPEC  EQU   USEFLAGS                                                 02139000
RSGCUA   EQU   RSGUCB+8                                                 02140000
RSGCHAN  EQU   RSGUCB+7                                                 02141000
CPUREFNO EQU   RSGUCB+6                                                 02142000
RSGCPUID EQU   RSGUCB+1                                                 02143000
@NM00019 EQU   RSGFLAGS                                                 02144000
CISPEC   EQU   RSGFLAGS                                                 02145000
TORSG2   EQU   DSENTRY+1                                                02146000
TORSG1   EQU   DSENTRY                                                  02147000
COM2BASE EQU   COMTAB+3304                                              02148000
LRUCLOCK EQU   CREATE+11                                                02149000
VOLSER   EQU   CREATE+5                                                 02150000
VPAGES   EQU   CREATE+1                                                 02151000
@NM00018 EQU   @NM00017                                                 02152000
PRNTONLY EQU   @NM00017                                                 02153000
UPDCREAT EQU   @NM00017                                                 02154000
NEWCREAT EQU   @NM00017                                                 02155000
CMDCREAT EQU   @NM00017                                                 02156000
@NM00016 EQU   LOWFLGS                                                  02157000
ALTMSCIN EQU   CPUFLAG2                                                 02158000
@NM00015 EQU   CPUFLAG2                                                 02159000
ALTMSGBF EQU   CPUFLAG2                                                 02160000
@NM00014 EQU   CPUFLAG2                                                 02161000
CPUSPEC  EQU   CPUFLAG2                                                 02162000
CPUMSCIN EQU   CPUFLAG1                                                 02163000
OPJES3   EQU   OPSYSTYP                                                 02164000
OPVS2    EQU   OPSYSTYP                                                 02165000
OPVS1    EQU   OPSYSTYP                                                 02166000
CPUALTFL EQU   CPUFLAG1                                                 02167000
CPUTIGHT EQU   CPUFLAG1                                                 02168000
@NM00013 EQU   CPUFLAG1                                                 02169000
TOMPCPU  EQU   CPU+5                                                    02170000
CPUID    EQU   CPU                                                      02171000
CPUNUM   EQU   CPUASSOC                                                 02172000
SPNRSGNO EQU   PHYSTYPE+1                                               02173000
LGDEVICE EQU   PHYSFLGS                                                 02174000
LOGABOX1 EQU   PHYSFLGS                                                 02175000
PHYSSSID EQU   PHYSFLGS                                                 02176000
PHYSREAL EQU   PHYSFLGS                                                 02177000
PHYSICEB EQU   MERLICEB                                                 02178000
PHYSMERL EQU   MERLICEB                                                 02179000
PHYSDS2  EQU   DSPAIRS                                                  02180000
PABDDD   EQU   PABAADDD                                                 02181000
PABAA    EQU   PABAADDD                                                 02182000
PABZEROS EQU   PABAADDD                                                 02183000
PAB2D    EQU   PABREAL                                                  02184000
PAB2C    EQU   PABREAL                                                  02185000
PAB2B    EQU   PABREAL                                                  02186000
@NM00012 EQU   PABREAL                                                  02187000
PAB1D    EQU   PABREAL                                                  02188000
PAB1C    EQU   PABREAL                                                  02189000
PAB1B    EQU   PABREAL                                                  02190000
PABIMPLR EQU   PABREAL                                                  02191000
PABBERG2 EQU   PABFLAGS                                                 02192000
@NM00011 EQU   PABFLAGS                                                 02193000
PABDSMTL EQU   PABFLAGS                                                 02194000
PABIBERG EQU   PABFLAGS                                                 02195000
@NM00010 EQU   PABFLAGS                                                 02196000
PABVOVIR EQU   PABFLAGS                                                 02197000
PABEXIST EQU   PABFLAGS                                                 02198000
MAPEXIT  EQU   LIB+4                                                    02199000
LIBMAP   EQU   LIB+3                                                    02200000
LIBDSMID EQU   LIB+2                                                    02201000
LIBSIZE  EQU   LIB+1                                                    02202000
@NM00009 EQU   LIBBITS                                                  02203000
LIBSPEC  EQU   LIBBITS                                                  02204000
TODS2    EQU   RSGTODS+1                                                02205000
TODS1    EQU   RSGTODS                                                  02206000
RSGSLICE EQU   RSG+3                                                    02207000
RSGUDEL  EQU   RSG+2                                                    02208000
RSGLDEL  EQU   RSG+1                                                    02209000
@NM00008 EQU   RSG                                                      02210000
RSGABOX1 EQU   RSGABOX                                                  02211000
RSGABOX0 EQU   RSGABOX                                                  02212000
RSGSPEC  EQU   RSG                                                      02213000
SVSYSUT3 EQU   SAVEDDS+32                                               02214000
SVSYSUT2 EQU   SAVEDDS+24                                               02215000
SVSYSUT1 EQU   SAVEDDS+16                                               02216000
SVSYSPCH EQU   SAVEDDS+8                                                02217000
SVSYSIN  EQU   SAVEDDS                                                  02218000
PARMPTR  EQU   INVOKED                                                  02219000
BUILDPTR EQU   GENIO+20                                                 02220000
SAVE14   EQU   GENIO+12                                                 02221000
EXLST    EQU   GENIO+8                                                  02222000
@NM00007 EQU   DCBPTR+1                                                 02223000
DCBFLAG  EQU   DCBPTR                                                   02224000
OPENLIST EQU   GENIO                                                    02225000
@NM00006 EQU   MESSAGES+19                                              02226000
NEEDEOJ  EQU   SPECLMSG                                                 02227000
ENDPHASE EQU   SPECLMSG                                                 02228000
@NM00005 EQU   SPECLMSG                                                 02229000
PRNTCARD EQU   SPECLMSG                                                 02230000
@NM00004 EQU   SPECLMSG                                                 02231000
NEED102  EQU   SPECLMSG                                                 02232000
NEED101  EQU   SPECLMSG                                                 02233000
PRINTRC  EQU   MESSAGES+16                                              02234000
TERM     EQU   MESSAGES+12                                              02235000
WARN     EQU   MESSAGES+8                                               02236000
WARNING  EQU   MESSAGES+4                                               02237000
RETCODE  EQU   MESSAGES                                                 02238000
OUTBUF   EQU   PRINTER+104                                              02239000
LINECT   EQU   PRINTER+102                                              02240000
LINECTR  EQU   PRINTER+100                                              02241000
PAGENO   EQU   PRINTER+96                                               02242000
DCBPRINT EQU   PRINTER                                                  02243000
@NM00003 EQU   READER+206                                               02244000
SVEODAD  EQU   READER+200                                               02245000
SVSYNAD2 EQU   READER+196                                               02246000
INBUF    EQU   READER+100                                               02247000
SSELECT  EQU   PCHBF                                                    02248000
@NM00002 EQU   READER+97                                                02249000
@NM00001 EQU   READFLAG                                                 02250000
READTERM EQU   READFLAG                                                 02251000
READDCB  EQU   READER                                                   02252000
PATCH    EQU   COMTAB                                                   02253000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      02254000
@RT00046 EQU   @EL00003                                                 02255000
@RC00112 EQU   @EL00005                                                 02256000
@RC00169 EQU   @EL00007                                                 02257000
@RC00163 EQU   @EL00007                                                 02258000
@RC00186 EQU   @EL00008                                                 02259000
@RC00180 EQU   @EL00008                                                 02260000
@RC00276 EQU   @RC00274                                                 02261000
@RC00366 EQU   @EL00012                                                 02262000
@RC00361 EQU   @EL00012                                                 02263000
@RF00360 EQU   @EL00012                                                 02264000
@RC00388 EQU   @EL00013                                                 02265000
@RC00113 EQU   @RC00112                                                 02266000
@ENDDATA EQU   *                                                        02267000
         END   ICGDSS05,(C'PLS2115',0603,76337)                         02268000
