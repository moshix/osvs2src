         TITLE 'ICGDSS09 MSC TABLE CREATE, SCAN DASD STATEMENT         *00001000
                        '                                               00002000
ICGDSS09 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'ICGDSS09  76.349'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @11,0                                               0001 00011000
@PSTART  LA    @10,4095(,@11)                                      0001 00012000
         USING @PSTART,@11                                         0001 00013000
         USING @PSTART+4095,@10                                    0001 00014000
         L     @00,@SIZDATD                                        0001 00015000
         GETMAIN  R,LV=(0)                                              00016000
         LR    @12,@01                                             0001 00017000
         USING @DATD,@12                                           0001 00018000
         ST    @13,@SA00001+4                                      0001 00019000
         LM    @00,@01,20(@13)                                     0001 00020000
         ST    @12,8(,@13)                                         0001 00021000
         LR    @13,@12                                             0001 00022000
         XC    @ZTEMPS(@ZLEN),@ZTEMPS                                   00023000
*                                                                  0035 00024000
*/********************************************************** @Y30LB12*/ 00025000
*/*                                                          @Y30LB12*/ 00026000
*/*                  ICGDSS09 (MAINLINE)                     @YD00113*/ 00027000
*/*                                                          @Y30LB12*/ 00028000
*/*            CALL MAJOR ROUTINES TO INITIALIZE LOCAL WORK  @YD00113*/ 00029000
*/*            AREAS, EXTRACT KEYWORDS AND PARAMETERS FROM   @Y30LB12*/ 00030000
*/*            CONTROL STATEMENT, CHECK FOR MISSING AND      @Y30LB12*/ 00031000
*/*            DUPLICATE VALUES.  IF NO TERMINATING ERRORS,  @Y30LB12*/ 00032000
*/*            CALL ROUTINE TO UPDATE ALL AFFECTED TABLES.   @Y30LB12*/ 00033000
*/*                                                          @Y30LB12*/ 00034000
*/********************************************************** @Y30LB12*/ 00035000
*                                                                  0035 00036000
*   CALL S09INIT;                   /* TO INITIALIZE         @Y30LB12*/ 00037000
         BAL   @14,S09INIT                                         0035 00038000
*   CALL S09SCAN;                   /* EXTRACT KEY, PARM     @Y30LB12*/ 00039000
         BAL   @14,S09SCAN                                         0036 00040000
*   CALL S09ANAL;                   /* CHECK VALUES          @Y30LB12*/ 00041000
         BAL   @14,S09ANAL                                         0037 00042000
*   IF STOPSCAN^='1'B               /* IF NO TERM. ERROR     @Y30LB12*/ 00043000
*     THEN                          /*                       @Y30LB12*/ 00044000
         TM    STOPSCAN,B'01000000'                                0038 00045000
         BO    @RF00038                                            0038 00046000
*     CALL S09BUILD;                /* BUILD CORE TABLES     @Y30LB12*/ 00047000
         BAL   @14,S09BUILD                                        0039 00048000
*   ELSE                                                           0040 00049000
*     ;                             /*                       @Y30LB12*/ 00050000
@RF00038 DS    0H                                                  0041 00051000
*   RETURN;                         /* RET. TO ICGDSSCN      @Y30LB12*/ 00052000
@EL00001 L     @13,4(,@13)                                         0041 00053000
@EF00001 L     @00,@SIZDATD                                        0041 00054000
         LR    @01,@12                                             0041 00055000
         FREEMAIN R,LV=(0),A=(1)                                        00056000
@ER00001 LM    @14,@12,12(@13)                                     0041 00057000
         BR    @14                                                 0041 00058000
*                                                                  0042 00059000
*/********************************************************** @Y30LB12*/ 00060000
*/*                                                          @Y30LB12*/ 00061000
*/* PROCEDURE NAME - S09INIT                                 @Y30LB12*/ 00062000
*/*                                                          @Y30LB12*/ 00063000
*/* FUNCTION - INITIALIZE LOCAL WORK AREA SPNWORKA.          @Y30LB12*/ 00064000
*/*                                                          @Y30LB12*/ 00065000
*/********************************************************** @Y30LB12*/ 00066000
*                                                                  0042 00067000
*S09INIT:                                                          0042 00068000
*   PROCEDURE;                      /*                       @Y30LB12*/ 00069000
S09INIT  STM   @14,@12,12(@13)                                     0042 00070000
*   DO I=1 TO 8;                    /* 8 POSSIBLE ADDRS      @Y30LB12*/ 00071000
         LA    I,1                                                 0043 00072000
@DL00043 DS    0H                                                  0044 00073000
*     FLAGS(I)='0000'X;             /* CLEAR FLAG BYTE       @Y30LB12*/ 00074000
         LR    @05,I                                               0044 00075000
         SLA   @05,2                                               0044 00076000
         LA    @03,FLAGS-4(@05)                                    0044 00077000
         MVC   0(2,@03),@CB00462                                   0044 00078000
*     WKLOGDEV(I)='00'X;            /* LOGICAL DEVICE        @Y30LB12*/ 00079000
         LA    @03,WKLOGDEV-4(@05)                                 0045 00080000
         MVI   0(@03),X'00'                                        0045 00081000
*     WORKRSG(I)='00'X;             /* STAGING DASD GROUP    @XD00153*/ 00082000
         LA    @03,WORKRSG-4(@05)                                  0046 00083000
         MVI   0(@03),X'00'                                        0046 00084000
*   END;                            /*                       @Y30LB12*/ 00085000
         AH    I,@CH00044                                          0047 00086000
         CH    I,@CH00042                                          0047 00087000
         BNH   @DL00043                                            0047 00088000
*   S09MSGID='00'X;                 /* CONTROL FLAGS         @Y30LB12*/ 00089000
         MVI   S09MSGID,X'00'                                      0048 00090000
*   HAVES='00'X;                    /* 'FOUND IT' FLAGS      @Y30LB12*/ 00091000
         MVI   HAVES,X'00'                                         0049 00092000
*   DSINDEX1=0;                     /* 1ST DATA STAGER       @Y30LB12*/ 00093000
         SLR   @05,@05                                             0050 00094000
         STH   @05,DSINDEX1                                        0050 00095000
*   DSINDEX2=0;                     /* 2ND DATA STAGER       @Y30LB12*/ 00096000
         STH   @05,DSINDEX2                                        0051 00097000
*   DEVINDEX=0;                     /* INDEX TO PHYS DEV     @Y30LB12*/ 00098000
         MVI   DEVINDEX,X'00'                                      0052 00099000
*   END S09INIT;                    /* RET. TO MAINLINE      @Y30LB12*/ 00100000
@EL00002 DS    0H                                                  0053 00101000
@EF00002 DS    0H                                                  0053 00102000
@ER00002 LM    @14,@12,12(@13)                                     0053 00103000
         BR    @14                                                 0053 00104000
*                                                                  0054 00105000
*/********************************************************** @Y30LB12*/ 00106000
*/*                                                          @Y30LB12*/ 00107000
*/* PROCEDURE NAME - S09SCAN                                 @Y30LB12*/ 00108000
*/*                                                          @Y30LB12*/ 00109000
*/* FUNCTION - SCAN CONTROL STATEMENT FOR MAJOR KEYWORDS     @Y30LB12*/ 00110000
*/*            'SA', 'CUA', AND 'DEV' AND CALL THE PROPER    @Y30LB12*/ 00111000
*/*            PROCEDURE TO SCAN FOR PARAMETER.              @Y30LB12*/ 00112000
*/*                                                          @Y30LB12*/ 00113000
*/********************************************************** @Y30LB12*/ 00114000
*                                                                  0054 00115000
*S09SCAN:                                                          0054 00116000
*   PROCEDURE;                      /*                       @Y30LB12*/ 00117000
S09SCAN  STM   @14,@12,@SA00003                                    0054 00118000
*   DO WHILE(LASTPARM^='1'B);       /* TILL NO MORE DATA     @Y30LB12*/ 00119000
         B     @DE00055                                            0055 00120000
@DL00055 DS    0H                                                  0056 00121000
*     CALL READS99;                 /* EXTRACT KEYWORD       @Y30LB12*/ 00122000
         BAL   @14,READS99                                         0056 00123000
*     KNOWN='0'B;                   /* REC. KEYWORD FLAG     @Y30LB12*/ 00124000
         NI    KNOWN,B'01111111'                                   0057 00125000
*     IF LASTPARM='1'B              /* SET BY ICGDSS99       @Y30LB12*/ 00126000
*       THEN                        /*                       @Y30LB12*/ 00127000
         TM    LASTPARM(R4),B'00001000'                            0058 00128000
         BO    @RT00058                                            0058 00129000
*       RETURN;                     /* RET. TO MAINLINE      @Y30LB12*/ 00130000
*     ELSE                                                         0060 00131000
*       ;                           /*                       @Y30LB12*/ 00132000
*     IF KEYBIT^='1'B               /* SET BY ICGDSS99       @Y30LB12*/ 00133000
*       THEN                        /*                       @Y30LB12*/ 00134000
         TM    KEYBIT(R4),B'01000000'                              0061 00135000
         BO    @RF00061                                            0061 00136000
*       DO;                         /*                       @Y30LB12*/ 00137000
*                                                                  0062 00138000
*         /***********************************************************/ 00139000
*         /*                                                         */ 00140000
*         /* *****************************************       @Y30LB12*/ 00141000
*         /* ICG209I EXPECTED, BUT DID NOT FIND,             @Y30LB12*/ 00142000
*         /* KEYWORD                                         @Y30LB12*/ 00143000
*         /* *****************************************       @Y30LB12*/ 00144000
*         /*                                                         */ 00145000
*         /***********************************************************/ 00146000
*                                                                  0063 00147000
*         MSGNO=ICG209I;            /* ID FOR ICGDS209       @Y30LB12*/ 00148000
         MVC   MSGNO(2,R4),ICG209I                                 0063 00149000
*         CALL PUTIT2;              /* TO MESSAGE WRITER     @Y30LB12*/ 00150000
         BAL   @14,PUTIT2                                          0064 00151000
*         RETURN;                   /* RET. TO MAINLINE      @Y30LB12*/ 00152000
@EL00003 DS    0H                                                  0065 00153000
@EF00003 DS    0H                                                  0065 00154000
@ER00003 LM    @14,@12,@SA00003                                    0065 00155000
         BR    @14                                                 0065 00156000
*       END;                        /*                       @Y30LB12*/ 00157000
*     ELSE                                                         0067 00158000
*       ;                           /*                       @Y30LB12*/ 00159000
*                                                                  0067 00160000
@RF00061 DS    0H                                                  0068 00161000
*     /***************************************************************/ 00162000
*     /*                                                             */ 00163000
*     /* ***********************************************     @Y30LB12*/ 00164000
*     /* IF THE KEYWORD SCANNED IS 'SA', SET FLAG TO         @YD00113*/ 00165000
*     /* '1' AND CALL 'S09DS' TO EXTRACT PARAMETERS          @YD00113*/ 00166000
*     /* ***********************************************     @Y30LB12*/ 00167000
*     /*                                                             */ 00168000
*     /***************************************************************/ 00169000
*                                                                  0068 00170000
*     IF SCANDATA(1:3)='SA='        /*                       @Y30LB12*/ 00171000
*       THEN                        /*                       @Y30LB12*/ 00172000
         L     @05,STARTCOL(,R4)                                   0068 00173000
         CLC   SCANDATA(3,@05),@CC00471                            0068 00174000
         BNE   @RF00068                                            0068 00175000
*       DO;                         /*                       @Y30LB12*/ 00176000
*         KNOWN='1'B;               /* RECOGNIZED KEYWD      @Y30LB12*/ 00177000
         OI    KNOWN,B'10000000'                                   0070 00178000
*         CALL S09DS;               /* TO GET PARAMETERS     @Y30LB12*/ 00179000
         BAL   @14,S09DS                                           0071 00180000
*       END;                        /*                       @Y30LB12*/ 00181000
*     ELSE                                                         0073 00182000
*       ;                           /*                       @Y30LB12*/ 00183000
*                                                                  0073 00184000
@RF00068 DS    0H                                                  0074 00185000
*     /***************************************************************/ 00186000
*     /*                                                             */ 00187000
*     /* ***********************************************     @Y30LB12*/ 00188000
*     /* IF THE KEYWORD SCANNED IS 'CUA', SET FLAG TO        @YD00113*/ 00189000
*     /* '1' AND CALL 'S09CUA' TO EXTRACT PARAMETERS         @YD00113*/ 00190000
*     /* ***********************************************     @Y30LB12*/ 00191000
*     /*                                                             */ 00192000
*     /***************************************************************/ 00193000
*                                                                  0074 00194000
*     IF SCANDATA(1:4)='CUA='       /*                       @Y30LB12*/ 00195000
*         &KNOWN='0'B               /*                       @YM31096*/ 00196000
*       THEN                        /*                       @Y30LB12*/ 00197000
         L     @05,STARTCOL(,R4)                                   0074 00198000
         CLC   SCANDATA(4,@05),@CC00473                            0074 00199000
         BNE   @RF00074                                            0074 00200000
         TM    KNOWN,B'10000000'                                   0074 00201000
         BNZ   @RF00074                                            0074 00202000
*       DO;                         /*                       @Y30LB12*/ 00203000
*         KNOWN='1'B;               /* RECOGNIZED KEYWD      @Y30LB12*/ 00204000
         OI    KNOWN,B'10000000'                                   0076 00205000
*         CALL S09CUA;              /* TO GET PARAMETER      @Y30LB12*/ 00206000
         BAL   @14,S09CUA                                          0077 00207000
*       END;                        /*                       @Y30LB12*/ 00208000
*     ELSE                                                         0079 00209000
*       ;                           /*                       @Y30LB12*/ 00210000
*                                                                  0079 00211000
@RF00074 DS    0H                                                  0080 00212000
*     /***************************************************************/ 00213000
*     /*                                                             */ 00214000
*     /* ***********************************************     @Y30LB12*/ 00215000
*     /* IF THE KEYWORD SCANNED IS 'DEVX', SET FLAG TO       @YD00113*/ 00216000
*     /* '1' AND CALL 'S09DEV' TO EXTRACT PARAMETERS         @YD00113*/ 00217000
*     /* ***********************************************     @Y30LB12*/ 00218000
*     /*                                                             */ 00219000
*     /***************************************************************/ 00220000
*                                                                  0080 00221000
*     IF SCANDATA(1:3)='DEV'        /*                       @Y30LB12*/ 00222000
*         &KNOWN='0'B               /*                       @YM31096*/ 00223000
*       THEN                        /*                       @Y30LB12*/ 00224000
         L     @05,STARTCOL(,R4)                                   0080 00225000
         CLC   SCANDATA(3,@05),@CC00475                            0080 00226000
         BNE   @RF00080                                            0080 00227000
         TM    KNOWN,B'10000000'                                   0080 00228000
         BNZ   @RF00080                                            0080 00229000
*       DO;                         /*                       @Y30LB12*/ 00230000
*         KNOWN='1'B;               /* RECOGNIZED KEYWD      @Y30LB12*/ 00231000
         OI    KNOWN,B'10000000'                                   0082 00232000
*         CALL S09DEV;              /* TO GET PARAMETER      @Y30LB12*/ 00233000
         BAL   @14,S09DEV                                          0083 00234000
*       END;                        /*                       @Y30LB12*/ 00235000
*     ELSE                                                         0085 00236000
*       ;                           /*                       @Y30LB12*/ 00237000
*                                                                  0085 00238000
@RF00080 DS    0H                                                  0086 00239000
*     /***************************************************************/ 00240000
*     /*                                                             */ 00241000
*     /* ***********************************************     @Y30LB12*/ 00242000
*     /* IF THE KEYWORD IS NOT SA, CUA, OR DEVX, CALL        @YD00113*/ 00243000
*     /* 'UNKNOWN' PROCEDURE TO WRITE ERROR MESSAGE          @YD00113*/ 00244000
*     /* AND POSITION TO NEXT KEYWORD.                       @YD00113*/ 00245000
*     /* ***********************************************     @Y30LB12*/ 00246000
*     /*                                                             */ 00247000
*     /***************************************************************/ 00248000
*                                                                  0086 00249000
*     IF KNOWN^='1'B                /* UNKNOWN KEYWORD       @Y30LB12*/ 00250000
*       THEN                        /*                       @Y30LB12*/ 00251000
         TM    KNOWN,B'10000000'                                   0086 00252000
         BO    @RF00086                                            0086 00253000
*       CALL UNKNOWN;               /* WRITE MESSAGE ETC     @Y30LB12*/ 00254000
         BAL   @14,UNKNOWN                                         0087 00255000
*     ELSE                                                         0088 00256000
*       ;                           /*                       @Y30LB12*/ 00257000
@RF00086 DS    0H                                                  0089 00258000
*   END;                            /* END OF DO WHILE       @Y30LB12*/ 00259000
@DE00055 TM    LASTPARM(R4),B'00001000'                            0089 00260000
         BNO   @DL00055                                            0089 00261000
*   END S09SCAN;                    /* RET. TO MAINLINE      @Y30LB12*/ 00262000
         B     @EL00003                                            0090 00263000
*                                                                  0091 00264000
*/********************************************************** @Y30LB12*/ 00265000
*/*                                                          @Y30LB12*/ 00266000
*/* PROCEDURE NAME - S09CUA                                  @Y30LB12*/ 00267000
*/*                                                          @Y30LB12*/ 00268000
*/* FUNCTION - EXTRACT THE CONTROL UNIT ADDRESS OF THE       @Y30LB12*/ 00269000
*/*            DASD CONTROLLER FROM THE CONTROL STATEMENT.   @Y30LB12*/ 00270000
*/*            ONLY ONE CUA KEYWORD AND PARMETER ARE         @Y30LB12*/ 00271000
*/*            PERMITTED PER SPINDLES CONTROL STATEMENT.     @Y30LB12*/ 00272000
*/*            THE CUA PARAMETER IS A SINGLE DECIMAL DIGIT   @Y30LB12*/ 00273000
*/*            IN THE RANGE 0-3.                             @Y30LB12*/ 00274000
*/*                                                          @Y30LB12*/ 00275000
*/********************************************************** @Y30LB12*/ 00276000
*                                                                  0091 00277000
*S09CUA:                                                           0091 00278000
*   PROCEDURE;                      /*                       @Y30LB12*/ 00279000
*                                                                  0091 00280000
S09CUA   STM   @14,@12,@SA00004                                    0091 00281000
*   /*****************************************************************/ 00282000
*   /*                                                               */ 00283000
*   /* ***********************************************       @YD00113*/ 00284000
*   /* CALL 'READS99' TO EXTRACT THE CUA PARAMETER.          @YD00113*/ 00285000
*   /* TEST TO ASSURE KEYWORD 'CUA' IS NOT DUPLICATED        @YD00113*/ 00286000
*   /* THEN SET FLAG TO INDICATE 'CUA' OBTAINED.             @YD00113*/ 00287000
*   /* IF A DUPLICATE EXISTS, ISSUE ERROR MESSAGE            @YD00113*/ 00288000
*   /* ***********************************************       @YD00113*/ 00289000
*   /*                                                               */ 00290000
*   /*****************************************************************/ 00291000
*                                                                  0092 00292000
*   CALL READS99;                   /* EXTRACT PARAMETER     @Y30LB12*/ 00293000
         BAL   @14,READS99                                         0092 00294000
*   IF HAVECUA^='1'B                /*                       @Y30LB12*/ 00295000
*     THEN                          /*                       @Y30LB12*/ 00296000
         TM    HAVECUA,B'01000000'                                 0093 00297000
         BO    @RF00093                                            0093 00298000
*     HAVECUA='1'B;                 /*                       @Y30LB12*/ 00299000
         OI    HAVECUA,B'01000000'                                 0094 00300000
*   ELSE                            /*                       @Y30LB12*/ 00301000
*     DO;                           /*                       @Y30LB12*/ 00302000
*                                                                  0095 00303000
         B     @RC00093                                            0095 00304000
@RF00093 DS    0H                                                  0096 00305000
*       /*************************************************************/ 00306000
*       /*                                                           */ 00307000
*       /* *****************************************         @Y30LB12*/ 00308000
*       /* 'ICG219I DUPLICATE KEYWORD CUA'                   @Y30LB12*/ 00309000
*       /* *****************************************         @Y30LB12*/ 00310000
*       /*                                                           */ 00311000
*       /*************************************************************/ 00312000
*                                                                  0096 00313000
*       OUTBUF2(1:27)=ICGDS219;     /*                       @Y30LB12*/ 00314000
         MVC   OUTBUF2(27,R4),ICGDS219                             0096 00315000
*       OUTBUF2(28:30)='CUA';       /*                       @Y30LB12*/ 00316000
         MVC   OUTBUF2+27(3,R4),@CC00481                           0097 00317000
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/ 00318000
         BAL   @14,PUTIT1                                          0098 00319000
*       RETURN;                     /* RETURN TO S09SCAN     @Y30LB12*/ 00320000
@EL00004 DS    0H                                                  0099 00321000
@EF00004 DS    0H                                                  0099 00322000
@ER00004 LM    @14,@12,@SA00004                                    0099 00323000
         BR    @14                                                 0099 00324000
*     END;                          /*                       @Y30LB12*/ 00325000
*                                                                  0100 00326000
*   /*****************************************************************/ 00327000
*   /*                                                               */ 00328000
*   /* ***********************************************       @YD00113*/ 00329000
*   /* TEST TO ASSURE DATA SCANNED IS A PARAMETER.           @YD00113*/ 00330000
*   /* IF NOT, PRINT ERROR MESSAGE                           @YD00113*/ 00331000
*   /* ***********************************************       @YD00113*/ 00332000
*   /*                                                               */ 00333000
*   /*****************************************************************/ 00334000
*                                                                  0101 00335000
*   IF PARMBIT^='1'B                /* SET BY ICGDSS99       @Y30LB12*/ 00336000
*     THEN                          /*                       @Y30LB12*/ 00337000
@RC00093 TM    PARMBIT(R4),B'00100000'                             0101 00338000
         BO    @RF00101                                            0101 00339000
*     DO;                           /*                       @Y30LB12*/ 00340000
*                                                                  0102 00341000
*       /*************************************************************/ 00342000
*       /*                                                           */ 00343000
*       /* *****************************************         @Y30LB12*/ 00344000
*       /* ICG211I EXPECTED, BUT DID NOT FIND,               @Y30LB12*/ 00345000
*       /* PARAMETER                                         @Y30LB12*/ 00346000
*       /* *****************************************         @Y30LB12*/ 00347000
*       /*                                                           */ 00348000
*       /*************************************************************/ 00349000
*                                                                  0103 00350000
*       MSGNO=ICG211I;              /* ID FOR ICG211I        @Y30LB12*/ 00351000
         MVC   MSGNO(2,R4),ICG211I                                 0103 00352000
*       CALL PUTIT2;                /* TO MESSAGE WRITER     @Y30LB12*/ 00353000
         BAL   @14,PUTIT2                                          0104 00354000
*       RETURN;                     /* RETURN TO S09SCAN     @Y30LB12*/ 00355000
         B     @EL00004                                            0105 00356000
*     END;                          /*                       @Y30LB12*/ 00357000
*   ELSE                                                           0107 00358000
*     ;                             /*                       @Y30LB12*/ 00359000
*                                                                  0107 00360000
@RF00101 DS    0H                                                  0108 00361000
*   /*****************************************************************/ 00362000
*   /*                                                               */ 00363000
*   /* ***********************************************       @YD00113*/ 00364000
*   /* TEST LENGTH OF PARAMETER (NOT TO EXCEED ONE           @YD00113*/ 00365000
*   /* BYTE). IF IT DOES, PRINT ERROR MESSAGE.               @YD00113*/ 00366000
*   /* ***********************************************       @YD00113*/ 00367000
*   /*                                                               */ 00368000
*   /*****************************************************************/ 00369000
*                                                                  0108 00370000
*   IF SCANLEN^=1                   /* SET BY ICGDSS99       #Y30LB12*/ 00371000
*     THEN                          /*                       @Y30LB12*/ 00372000
         CLC   SCANLEN(2,R4),@CH00044                              0108 00373000
         BE    @RF00108                                            0108 00374000
*     DO;                           /*                       @Y30LB12*/ 00375000
*                                                                  0109 00376000
*       /*************************************************************/ 00377000
*       /*                                                           */ 00378000
*       /* *****************************************         @Y30LB12*/ 00379000
*       /* 'ICG220I INVALID PARAMETER LENGTH,                @Y30LB12*/ 00380000
*       /* KEYWORD IS CUA'                                   @Y30LB12*/ 00381000
*       /* *****************************************         @Y30LB12*/ 00382000
*       /*                                                           */ 00383000
*       /*************************************************************/ 00384000
*                                                                  0110 00385000
*       OUTBUF2(1:46)=ICGDS220;     /*                       @Y30LB12*/ 00386000
         MVC   OUTBUF2(46,R4),ICGDS220                             0110 00387000
*       OUTBUF2(47:49)='CUA';       /*                       @Y30LB12*/ 00388000
         MVC   OUTBUF2+46(3,R4),@CC00481                           0111 00389000
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/ 00390000
         BAL   @14,PUTIT1                                          0112 00391000
*       RETURN;                     /* RETURN TO S09SCAN     @Y30LB12*/ 00392000
         B     @EL00004                                            0113 00393000
*     END;                          /*                       @Y30LB12*/ 00394000
*   ELSE                                                           0115 00395000
*     ;                             /*                       @Y30LB12*/ 00396000
*                                                                  0115 00397000
@RF00108 DS    0H                                                  0116 00398000
*   /*****************************************************************/ 00399000
*   /*                                                               */ 00400000
*   /* ***********************************************       @Y30LB12*/ 00401000
*   /* THE VALUE STORED IN WORKCUA AT EXIT FROM THIS         @Y30LB12*/ 00402000
*   /* ROUTINE IN WORKCUA IS THE BINARY VALUE 1, 2,          @Y30LB12*/ 00403000
*   /* 3, OR 4. THIS VALUE WILL BE USED AS THE               @Y30LB12*/ 00404000
*   /* SECOND INDEX INTO THE COMMON STRUCTURES               @Y30LB12*/ 00405000
*   /* DSPAIRS AND PHYSTYPE.                                 @Y30LB12*/ 00406000
*   /* IF THE VALUE SCANNED IS NOT 'F0','F1','F2',           @YD00113*/ 00407000
*   /* OR 'F3', PRINT ERROR MESSAGE.                         @YD00113*/ 00408000
*   /* ***********************************************       @Y30LB12*/ 00409000
*   /*                                                               */ 00410000
*   /*****************************************************************/ 00411000
*                                                                  0116 00412000
*   WORKCUA=SCANDATA(1);            /* CUA TO LOCAL WORK     @Y30LB12*/ 00413000
         L     @05,STARTCOL(,R4)                                   0116 00414000
         MVC   WORKCUA(1),SCANDATA(@05)                            0116 00415000
*   IF HIGHCUA='1111'B              /* ZONE 0F NUMBER        @Y30LB12*/ 00416000
*       &MIDCUA='00'B               /* DIGIT LESS THAN 4     @Y30LB12*/ 00417000
*     THEN                          /*                       @Y30LB12*/ 00418000
         TM    HIGHCUA,B'11110000'                                 0117 00419000
         BNO   @RF00117                                            0117 00420000
         TM    MIDCUA,B'00001100'                                  0117 00421000
         BNZ   @RF00117                                            0117 00422000
*     DO;                           /*                       @Y30LB12*/ 00423000
*       HIGHCUA='0000'B;            /* BINARY EQUIVALENT     @Y30LB12*/ 00424000
         NI    HIGHCUA,B'00001111'                                 0119 00425000
*       WORKCUA=WORKCUA+1;          /* VALUE IS 1-4          @Y30LB12*/ 00426000
         LA    @05,1                                               0120 00427000
         MVC   @ZT00003+3(1),WORKCUA                               0120 00428000
         AL    @05,@ZT00003                                        0120 00429000
         STC   @05,WORKCUA                                         0120 00430000
*     END;                          /*                       @Y30LB12*/ 00431000
*   ELSE                            /*                       @Y30LB12*/ 00432000
*     DO;                           /*                       @Y30LB12*/ 00433000
*                                                                  0122 00434000
         B     @RC00117                                            0122 00435000
@RF00117 DS    0H                                                  0123 00436000
*       /*************************************************************/ 00437000
*       /*                                                           */ 00438000
*       /* *****************************************         @Y30LB12*/ 00439000
*       /* ICG223I VALUE ERROR FOR CUA                       @Y30LB12*/ 00440000
*       /* *****************************************         @Y30LB12*/ 00441000
*       /*                                                           */ 00442000
*       /*************************************************************/ 00443000
*                                                                  0123 00444000
*       OUTBUF2(1:25)=ICGDS223;     /*                       @Y30LB12*/ 00445000
         MVC   OUTBUF2(25,R4),ICGDS223                             0123 00446000
*       OUTBUF2(26:28)='CUA';       /*                       @Y30LB12*/ 00447000
         MVC   OUTBUF2+25(3,R4),@CC00481                           0124 00448000
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/ 00449000
         BAL   @14,PUTIT1                                          0125 00450000
*     END;                          /*                       @Y30LB12*/ 00451000
*   END S09CUA;                     /* RETURN TO S09SCAN     @Y30LB12*/ 00452000
         B     @EL00004                                            0127 00453000
*                                                                  0128 00454000
*/********************************************************** @Y30LB12*/ 00455000
*/*                                                          @Y30LB12*/ 00456000
*/* PROCEDURE NAME - S09DS                                   @Y30LB12*/ 00457000
*/*                                                          @Y30LB12*/ 00458000
*/* FUNCTION - EXTRACT THE PARAMETER FOR EITHER ONE OR TWO   @Y30LB12*/ 00459000
*/*            DATA STAGERS THAT ATTACH TO THIS DASD         @Y30LB12*/ 00460000
*/*            CONTROLLER.  ONE DATA STAGER IS REQUIRED.     @Y30LB12*/ 00461000
*/*            THE SECOND DATA STAGER IS OPTIONAL.  IF TWO   @Y30LB12*/ 00462000
*/*            DATA STAGER SPECIFICATIONS ARE SUPPLIED,      @Y30LB12*/ 00463000
*/*            TWO ENTRIES IN PHYSTYPE WILL BE UPDATED       @Y30LB12*/ 00464000
*/*            WITH THE INFORMATION EXTRACTED FROM THIS      @Y30LB12*/ 00465000
*/*            CONTROL STATEMENT.                            @Y30LB12*/ 00466000
*/*                                                          @Y30LB12*/ 00467000
*/*            THE VALUES DSINDEX1 AND DSINDEX2 ARE BINARY   @Y30LB12*/ 00468000
*/*            NUMBERS ONE GREATER THAN THE ACTUAL STAGING   @YD00113*/ 00469000
*/*            ADAPTER AND ARE USED AS THE FIRST INDEX INTO  @Y30LB12*/ 00470000
*/*            DSPAIRS AND PHYSTYPE.                         @Y30LB12*/ 00471000
*/*                                                          @Y30LB12*/ 00472000
*/********************************************************** @Y30LB12*/ 00473000
*                                                                  0128 00474000
*S09DS:                                                            0128 00475000
*   PROCEDURE;                      /*                       @Y30LB12*/ 00476000
*                                                                  0128 00477000
S09DS    STM   @14,@12,@SA00005                                    0128 00478000
*   /*****************************************************************/ 00479000
*   /*                                                               */ 00480000
*   /* ***********************************************       @YD00113*/ 00481000
*   /* CALL 'READS99' TO EXTRACT THE FIRST PARAMETER         @YD00113*/ 00482000
*   /* THEN TEST FOR DUPLICATED KEYWORD ('SA').              @YD00113*/ 00483000
*   /* IF NO DUPLICATE, TEST IF EXPECTED PARAMETER           @YD00113*/ 00484000
*   /* WAS FOUND. IF IT WAS, TEST THE PARAMETER'S            @YD00113*/ 00485000
*   /* LENGTH (NOT TO EXCEED ONE BYTE). IF AN ERROR          @YD00113*/ 00486000
*   /* OCCURS ON ANY OF THE TESTS, PRINT AN ERROR            @YD00113*/ 00487000
*   /* MESSAGE AND RETURN TO CALLING PROCEDURE.              @YD00113*/ 00488000
*   /* ***********************************************       @YD00113*/ 00489000
*   /*                                                               */ 00490000
*   /*****************************************************************/ 00491000
*                                                                  0129 00492000
*   CALL READS99;                   /* EXTRACT 1ST PARM      @Y30LB12*/ 00493000
         BAL   @14,READS99                                         0129 00494000
*   IF HAVEDS^='1'B                 /*                       @Y30LB12*/ 00495000
*     THEN                          /*                       @Y30LB12*/ 00496000
         TM    HAVEDS,B'10000000'                                  0130 00497000
         BO    @RF00130                                            0130 00498000
*     HAVEDS='1'B;                  /*                       @Y30LB12*/ 00499000
         OI    HAVEDS,B'10000000'                                  0131 00500000
*   ELSE                            /*                       @Y30LB12*/ 00501000
*     DO;                           /*                       @Y30LB12*/ 00502000
*                                                                  0132 00503000
         B     @RC00130                                            0132 00504000
@RF00130 DS    0H                                                  0133 00505000
*       /*************************************************************/ 00506000
*       /*                                                           */ 00507000
*       /* *****************************************         @Y30LB12*/ 00508000
*       /* 'ICG219I DUPLICATE KEYWORD SA'                    @Y30LB12*/ 00509000
*       /* *****************************************         @Y30LB12*/ 00510000
*       /*                                                           */ 00511000
*       /*************************************************************/ 00512000
*                                                                  0133 00513000
*       OUTBUF2(1:27)=ICGDS219;     /*                       @Y30LB12*/ 00514000
         MVC   OUTBUF2(27,R4),ICGDS219                             0133 00515000
*       OUTBUF2(28:29)='SA';        /*                       @Y30LB12*/ 00516000
         MVC   OUTBUF2+27(2,R4),@CC00491                           0134 00517000
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/ 00518000
         BAL   @14,PUTIT1                                          0135 00519000
*       RETURN;                     /* RETURN TO S09SCAN     @Y30LB12*/ 00520000
@EL00005 DS    0H                                                  0136 00521000
@EF00005 DS    0H                                                  0136 00522000
@ER00005 LM    @14,@12,@SA00005                                    0136 00523000
         BR    @14                                                 0136 00524000
*     END;                          /*                       @Y30LB12*/ 00525000
*   IF PARMBIT^='1'B                /* SET BY ICGDSS99       @Y30LB12*/ 00526000
*     THEN                          /*                       @Y30LB12*/ 00527000
@RC00130 TM    PARMBIT(R4),B'00100000'                             0138 00528000
         BO    @RF00138                                            0138 00529000
*     DO;                           /*                       @Y30LB12*/ 00530000
*                                                                  0139 00531000
*       /*************************************************************/ 00532000
*       /*                                                           */ 00533000
*       /* *****************************************         @Y30LB12*/ 00534000
*       /* ICG211I EXPECTED, BUT DID NOT FIND,               @Y30LB12*/ 00535000
*       /* PARAMETER                                         @Y30LB12*/ 00536000
*       /* *****************************************         @Y30LB12*/ 00537000
*       /*                                                           */ 00538000
*       /*************************************************************/ 00539000
*                                                                  0140 00540000
*       MSGNO=ICG211I;              /* ID FOR ICG211I        @Y30LB12*/ 00541000
         MVC   MSGNO(2,R4),ICG211I                                 0140 00542000
*       CALL PUTIT2;                /* TO MESSAGE WRITER     @Y30LB12*/ 00543000
         BAL   @14,PUTIT2                                          0141 00544000
*       RETURN;                     /* RETURN TO S09SCAN     @Y30LB12*/ 00545000
         B     @EL00005                                            0142 00546000
*     END;                          /*                       @Y30LB12*/ 00547000
*   ELSE                                                           0144 00548000
*     ;                             /*                       @Y30LB12*/ 00549000
@RF00138 DS    0H                                                  0145 00550000
*   IF SCANLEN^=1                   /* SET BY ICGDSS99       @Y30LB12*/ 00551000
*     THEN                          /*                       @Y30LB12*/ 00552000
         CLC   SCANLEN(2,R4),@CH00044                              0145 00553000
         BE    @RF00145                                            0145 00554000
*     DO;                           /*                       @Y30LB12*/ 00555000
*                                                                  0146 00556000
*       /*************************************************************/ 00557000
*       /*                                                           */ 00558000
*       /* *****************************************         @Y30LB12*/ 00559000
*       /* 'ICG220I INVALID PARAMETER LENGTH,                @Y30LB12*/ 00560000
*       /* KEYWORD IS SA '                                   @Y30LB12*/ 00561000
*       /* *****************************************         @Y30LB12*/ 00562000
*       /*                                                           */ 00563000
*       /*************************************************************/ 00564000
*                                                                  0147 00565000
*       OUTBUF2(1:46)=ICGDS220;     /*                       @Y30LB12*/ 00566000
         MVC   OUTBUF2(46,R4),ICGDS220                             0147 00567000
*       OUTBUF2(47:48)='SA';        /*                       @Y30LB12*/ 00568000
         MVC   OUTBUF2+46(2,R4),@CC00491                           0148 00569000
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/ 00570000
         BAL   @14,PUTIT1                                          0149 00571000
*       RETURN;                     /* RETURN TO S09SCAN     @Y30LB12*/ 00572000
         B     @EL00005                                            0150 00573000
*     END;                          /*                       @Y30LB12*/ 00574000
*   ELSE                                                           0152 00575000
*     ;                             /*                       @Y30LB12*/ 00576000
*                                                                  0152 00577000
@RF00145 DS    0H                                                  0153 00578000
*   /*****************************************************************/ 00579000
*   /*                                                               */ 00580000
*   /* ***********************************************       @YD00113*/ 00581000
*   /* CALL 'CONVHEX' TO CONVERT DATA (1 BYTE) TO            @YD00113*/ 00582000
*   /* BINARY. IF THE VALUE IS NOT ZERO, SAVE DATA           @YD00113*/ 00583000
*   /* IN TABLE.                                             @YD00113*/ 00584000
*   /* ***********************************************       @YD00113*/ 00585000
*   /*                                                               */ 00586000
*   /*****************************************************************/ 00587000
*                                                                  0153 00588000
*   HEXCHAR=SCANDATA(1);            /* DS TO LOCAL WORK      @Y30LB12*/ 00589000
         L     @05,STARTCOL(,R4)                                   0153 00590000
         MVC   HEXCHAR(1),SCANDATA(@05)                            0153 00591000
*   CALL CONVHEX;                   /* CONVERT TO BINARY     @Y30LB12*/ 00592000
         BAL   @14,CONVHEX                                         0154 00593000
*   IF HEXINDEX^=0                  /* IF CONVERT OKAY       @Y30LB12*/ 00594000
*     THEN                          /*                       @Y30LB12*/ 00595000
         LH    @05,HEXINDEX                                        0155 00596000
         LTR   @05,@05                                             0155 00597000
         BZ    @RF00155                                            0155 00598000
*     DSINDEX1=HEXINDEX;            /* SAVE 1ST DS + 1       @Y30LB12*/ 00599000
         STH   @05,DSINDEX1                                        0156 00600000
*   ELSE                                                           0157 00601000
*     ;                             /*                       @Y30LB12*/ 00602000
*                                                                  0157 00603000
@RF00155 DS    0H                                                  0158 00604000
*   /*****************************************************************/ 00605000
*   /*                                                               */ 00606000
*   /* ***********************************************       @YD00113*/ 00607000
*   /* SET UP TO READ NEXT VALUE IN CASE A SECOND DS         @YD00113*/ 00608000
*   /* WAS SPECIFIED. CALL 'READS99' TO EXTRACT THE          @YD00113*/ 00609000
*   /* POSSIBLE PARAMETER. IF NO PARAMETER EXISTS,           @YD00113*/ 00610000
*   /* THUS NO SECOND DS, RETURN TO CALLING PROC.            @YD00113*/ 00611000
*   /* ***********************************************       @YD00113*/ 00612000
*   /*                                                               */ 00613000
*   /*****************************************************************/ 00614000
*                                                                  0158 00615000
*   SAVESCOL=STARTCOL;              /* IN CASE NO 2ND DS     @Y30LB12*/ 00616000
         MVC   SAVESCOL(4,R4),STARTCOL(R4)                         0158 00617000
*   SAVENCOL=NEXTCOL;               /* IN CASE NO 2ND DS     @Y30LB12*/ 00618000
         MVC   SAVENCOL(4,R4),NEXTCOL(R4)                          0159 00619000
*   CALL READS99;                   /* EXTRACT PARAMETER     @Y30LB12*/ 00620000
         BAL   @14,READS99                                         0160 00621000
*   IF PARMBIT^='1'B                /* SET BY ICGDSS99       @Y30LB12*/ 00622000
*     THEN                          /*                       @Y30LB12*/ 00623000
         TM    PARMBIT(R4),B'00100000'                             0161 00624000
         BO    @RF00161                                            0161 00625000
*     DO;                           /*                       @Y30LB12*/ 00626000
*       STARTCOL=SAVESCOL;          /* NO SECOND DS          @Y30LB12*/ 00627000
         MVC   STARTCOL(4,R4),SAVESCOL(R4)                         0163 00628000
*       NEXTCOL=SAVENCOL;           /* NO SECOND DS          @Y30LB12*/ 00629000
         MVC   NEXTCOL(4,R4),SAVENCOL(R4)                          0164 00630000
*       RETURN;                     /* RETURN TO S09SCAN     @Y30LB12*/ 00631000
         B     @EL00005                                            0165 00632000
*     END;                          /*                       @Y30LB12*/ 00633000
*   ELSE                                                           0167 00634000
*     ;                             /* SECOND DS PRESENT     @Y30LB12*/ 00635000
*                                                                  0167 00636000
@RF00161 DS    0H                                                  0168 00637000
*   /*****************************************************************/ 00638000
*   /*                                                               */ 00639000
*   /* ***********************************************       @YD00113*/ 00640000
*   /* A SECOND DS IS INDICATED BY THE PRESENCE OF           @YD00113*/ 00641000
*   /* ANOTHER PARAMETER. TEST IF THE LENGTH OF THE          @YD00113*/ 00642000
*   /* PARAMETER IS VALID. IF IT IS, CONVERT THE             @YD00113*/ 00643000
*   /* VALUE TO BINARY. IF RETURNED VALUE IS NOT             @YD00113*/ 00644000
*   /* ZERO, SAVE SECOND DSINDEX. IF VALUE IS ZERO,          @YD00113*/ 00645000
*   /* RETURN TO CALLING PROCEDURE.                          @YD00113*/ 00646000
*   /* ***********************************************       @YD00113*/ 00647000
*   /*                                                               */ 00648000
*   /*****************************************************************/ 00649000
*                                                                  0168 00650000
*   IF SCANLEN^=1                   /* SET BY ICGDSS99       @Y30LB12*/ 00651000
*     THEN                          /*                       @Y30LB12*/ 00652000
         CLC   SCANLEN(2,R4),@CH00044                              0168 00653000
         BE    @RF00168                                            0168 00654000
*     DO;                           /*                       @Y30LB12*/ 00655000
*                                                                  0169 00656000
*       /*************************************************************/ 00657000
*       /*                                                           */ 00658000
*       /* *****************************************         @Y30LB12*/ 00659000
*       /* 'ICG220I INVALID PARAMETER LENGTH,                @Y30LB12*/ 00660000
*       /* KEYWORD IS SA (2ND PARM)                          @Y30LB12*/ 00661000
*       /* *****************************************         @Y30LB12*/ 00662000
*       /*                                                           */ 00663000
*       /*************************************************************/ 00664000
*                                                                  0170 00665000
*       OUTBUF2(1:46)=ICGDS220;     /*                       @Y30LB12*/ 00666000
         MVC   OUTBUF2(46,R4),ICGDS220                             0170 00667000
*       OUTBUF2(47:59)='SA (2ND PARM)';/*                    @Y30LB12*/ 00668000
         MVC   OUTBUF2+46(13,R4),@CC00494                          0171 00669000
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/ 00670000
         BAL   @14,PUTIT1                                          0172 00671000
*       RETURN;                     /* RETURN TO S09SCAN     @Y30LB12*/ 00672000
         B     @EL00005                                            0173 00673000
*     END;                          /*                       @Y30LB12*/ 00674000
*   ELSE                                                           0175 00675000
*     ;                             /*                       @Y30LB12*/ 00676000
@RF00168 DS    0H                                                  0176 00677000
*   HEXCHAR=SCANDATA(1);            /* DS TO LOCAL WORK      @Y30LB12*/ 00678000
         L     @05,STARTCOL(,R4)                                   0176 00679000
         MVC   HEXCHAR(1),SCANDATA(@05)                            0176 00680000
*   CALL CONVHEX;                   /* CONVERT TO BINARY     @Y30LB12*/ 00681000
         BAL   @14,CONVHEX                                         0177 00682000
*   IF HEXINDEX^=0                  /* IF CONVERT OKAY       @Y30LB12*/ 00683000
*     THEN                          /*                       @Y30LB12*/ 00684000
         LH    @05,HEXINDEX                                        0178 00685000
         LTR   @05,@05                                             0178 00686000
         BZ    @RF00178                                            0178 00687000
*     DSINDEX2=HEXINDEX;            /* SAVE 2ND DS + 1       @Y30LB12*/ 00688000
         STH   @05,DSINDEX2                                        0179 00689000
*   ELSE                                                           0180 00690000
*     ;                             /*                       @Y30LB12*/ 00691000
@RF00178 DS    0H                                                  0181 00692000
*   END S09DS;                      /* RETURN TO S09SCAN     @Y30LB12*/ 00693000
         B     @EL00005                                            0181 00694000
*                                                                  0182 00695000
*/********************************************************** @Y30LB12*/ 00696000
*/*                                                          @Y30LB12*/ 00697000
*/* PROCEDURE NAME - CONVHEX                                 @Y30LB12*/ 00698000
*/*                                                          @Y30LB12*/ 00699000
*/* FUNCTION - THIS PROCEDURE RECEIVES AS INPUT THE          @Y30LB12*/ 00700000
*/*            CHARACTER REPRESENTATION OF A SINGLE          @Y30LB12*/ 00701000
*/*            HEXADECIMAL DIGIT IN 'HEXCHAR'.  IF THE       @Y30LB12*/ 00702000
*/*            CHARACTER REPRESENTS A VALID HEXADECIMAL      @Y30LB12*/ 00703000
*/*            DIGIT, IT IS CONVERTED TO BINARY IN HEXCHAR   @Y30LB12*/ 00704000
*/*            AND HEXINDEX IS SET TO HEXCHAR + 1.           @Y30LB12*/ 00705000
*/*            OTHERWISE MESSAGE ICGDS227 IS WRITTEN.        @Y30LB12*/ 00706000
*/*                                                          @Y30LB12*/ 00707000
*/********************************************************** @Y30LB12*/ 00708000
*                                                                  0182 00709000
*CONVHEX:                                                          0182 00710000
*   PROCEDURE;                      /*                       @Y30LB12*/ 00711000
CONVHEX  STM   @14,@12,@SA00006                                    0182 00712000
*   HEXINDEX=0;                     /* INITIALIZE TO 0       @Y30LB12*/ 00713000
         SLR   @05,@05                                             0183 00714000
         STH   @05,HEXINDEX                                        0183 00715000
*   DO I=1 TO 16;                   /* 16 POSSIBILITIES      @Y30LB12*/ 00716000
         LA    I,1                                                 0184 00717000
@DL00184 DS    0H                                                  0185 00718000
*     IF HEXCHAR=PATTERN(I)         /* IF MATCH TO CHAR      @Y30LB12*/ 00719000
*       THEN                        /*                       @Y30LB12*/ 00720000
         LA    @05,PATTERN-1(I)                                    0185 00721000
         CLC   HEXCHAR(1),0(@05)                                   0185 00722000
         BNE   @RF00185                                            0185 00723000
*       DO;                         /*                       @Y30LB12*/ 00724000
*         HEXINDEX=I;               /* INDEX IS 1-16 BIN     @Y30LB12*/ 00725000
         STH   I,HEXINDEX                                          0187 00726000
*         HEXCHAR=HEXINDEX-1;       /* CHARS ARE 0-F         @Y30LB12*/ 00727000
         LH    @05,HEXINDEX                                        0188 00728000
         BCTR  @05,0                                               0188 00729000
         STC   @05,HEXCHAR                                         0188 00730000
*         RETURN;                   /* RETURN TO S09DS       @Y30LB12*/ 00731000
@EL00006 DS    0H                                                  0189 00732000
@EF00006 DS    0H                                                  0189 00733000
@ER00006 LM    @14,@12,@SA00006                                    0189 00734000
         BR    @14                                                 0189 00735000
*       END;                        /*                       @Y30LB12*/ 00736000
*     ELSE                                                         0191 00737000
*       ;                           /*                       @Y30LB12*/ 00738000
@RF00185 DS    0H                                                  0192 00739000
*   END;                            /* ALL 16 & NO MATCH     @Y30LB12*/ 00740000
*                                                                  0192 00741000
         AH    I,@CH00044                                          0192 00742000
         CH    I,@CH00164                                          0192 00743000
         BNH   @DL00184                                            0192 00744000
*   /*****************************************************************/ 00745000
*   /*                                                               */ 00746000
*   /* ***********************************************       @Y30LB12*/ 00747000
*   /* ICG227I PARAMETER MUST BE HEXADECIMAL.                @Y30LB12*/ 00748000
*   /* KEYWORD IS SA                                         @Y30LB12*/ 00749000
*   /* ***********************************************       @Y30LB12*/ 00750000
*   /*                                                               */ 00751000
*   /*****************************************************************/ 00752000
*                                                                  0193 00753000
*   OUTBUF2(1:51)=ICGDS227;         /*                       @Y30LB12*/ 00754000
         MVC   OUTBUF2(51,R4),ICGDS227                             0193 00755000
*   OUTBUF2(52:53)='SA';            /*                       @Y30LB12*/ 00756000
         MVC   OUTBUF2+51(2,R4),@CC00491                           0194 00757000
*   CALL PUTIT1;                    /* TO MESSAGE WRITER     @Y30LB12*/ 00758000
         BAL   @14,PUTIT1                                          0195 00759000
*   END CONVHEX;                    /* RETURN TO S09DS       @Y30LB12*/ 00760000
         B     @EL00006                                            0196 00761000
*                                                                  0197 00762000
*/********************************************************** @Y30LB12*/ 00763000
*/*                                                          @Y30LB12*/ 00764000
*/* PROCEDURE NAME - S09DEV                                  @Y30LB12*/ 00765000
*/*                                                          @Y30LB12*/ 00766000
*/* FUNCTION - EXTRACT THE PHYSICAL DEVICE NUMBER FROM THE   @Y30LB12*/ 00767000
*/*            SUFFIX OF THE KEYWORD AND CALL S09DEVS1 TO    @Y30LB12*/ 00768000
*/*            EXAMINE THE PARAMETERS THAT ARE EXPECTED TO   @Y30LB12*/ 00769000
*/*            FOLLOW THE KEYWORD.                           @Y30LB12*/ 00770000
*/*                                                          @Y30LB12*/ 00771000
*/*            THE VALUE OF DEV PLUS ONE IS USED AS THE      @Y30LB12*/ 00772000
*/*            THIRD INDEX INTO PHYSTYPE AND REPRESENTS      @Y30LB12*/ 00773000
*/*            THE PHYSICAL ADDRESS OF THE DEVICE.  (IF      @Y30LB12*/ 00774000
*/*            THE DEVICE IS TO BE USED FOR STAGING, ITS     @Y30LB12*/ 00775000
*/*            SSID, WHICH CONSISTS OF SDG PLUS LUA, IS      @Y30LB12*/ 00776000
*/*            THE LOGICAL ADDRESS OF THE DEVICE.)           @Y30LB12*/ 00777000
*/*                                                          @Y30LB12*/ 00778000
*/********************************************************** @Y30LB12*/ 00779000
*                                                                  0197 00780000
*S09DEV:                                                           0197 00781000
*   PROCEDURE;                      /*                       @Y30LB12*/ 00782000
S09DEV   STM   @14,@12,@SA00007                                    0197 00783000
*   IF SCANLEN^=4                   /* SET BY ICGDSS99       @Y30LB12*/ 00784000
*     THEN                          /*                       @Y30LB12*/ 00785000
         CLC   SCANLEN(2,R4),@CH00070                              0198 00786000
         BE    @RF00198                                            0198 00787000
*     DO;                           /*                       @Y30LB12*/ 00788000
*                                                                  0199 00789000
*       /*************************************************************/ 00790000
*       /*                                                           */ 00791000
*       /* *****************************************         @Y30LB12*/ 00792000
*       /* 'ICG223I VALUE ERROR FOR DEVX                     @Y30LB12*/ 00793000
*       /* *****************************************         @Y30LB12*/ 00794000
*       /*                                                           */ 00795000
*       /*************************************************************/ 00796000
*                                                                  0200 00797000
*       OUTBUF2(1:25)=ICGDS223;     /*                       @Y30LB12*/ 00798000
         MVC   OUTBUF2(25,R4),ICGDS223                             0200 00799000
*       OUTBUF2(26:29)=SCANDATA(1:4);/*                      @Y30LB12*/ 00800000
         L     @05,STARTCOL(,R4)                                   0201 00801000
         MVC   OUTBUF2+25(4,R4),SCANDATA(@05)                      0201 00802000
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/ 00803000
         BAL   @14,PUTIT1                                          0202 00804000
*       RETURN;                     /* RETURN TO S09SCAN     @Y30LB12*/ 00805000
@EL00007 DS    0H                                                  0203 00806000
@EF00007 DS    0H                                                  0203 00807000
@ER00007 LM    @14,@12,@SA00007                                    0203 00808000
         BR    @14                                                 0203 00809000
*     END;                          /*                       @Y30LB12*/ 00810000
*   ELSE                                                           0205 00811000
*     ;                             /*                       @Y30LB12*/ 00812000
@RF00198 DS    0H                                                  0206 00813000
*   PLUGIN(1:4)=SCANDATA(1:4);      /* FOR POSSIBLE MSG      @Y30LB12*/ 00814000
         L     @05,STARTCOL(,R4)                                   0206 00815000
         MVC   PLUGIN(4),SCANDATA(@05)                             0206 00816000
*   WORKDEV=SCANDATA(4);            /* PHYSICAL DEVICE       @Y30LB12*/ 00817000
         MVC   WORKDEV(1),SCANDATA+3(@05)                          0207 00818000
*   DEVINDEX=0;                     /* INIT INDEX VALUE      @Y30LB12*/ 00819000
         MVI   DEVINDEX,X'00'                                      0208 00820000
*   CALL CONVDEC;                   /* GET INDEX VALUE       @Y30LB12*/ 00821000
         BAL   @14,CONVDEC                                         0209 00822000
*   DEVINDEX=DECINDEX;              /* STORE INDEX VALUE     @Y30LB12*/ 00823000
         SLR   @05,@05                                             0210 00824000
         IC    @05,DECINDEX                                        0210 00825000
         STC   @05,DEVINDEX                                        0210 00826000
*   IF DEVINDEX^=0                  /* IF VALUE OKAY         @Y30LB12*/ 00827000
*     THEN                          /*                       @Y30LB12*/ 00828000
         CLI   DEVINDEX,0                                          0211 00829000
         BE    @RF00211                                            0211 00830000
*     IF HAVEDEV(DEVINDEX)^='1'B    /* SPEC BEFORE           @Y30LB12*/ 00831000
*       THEN                        /*                       @Y30LB12*/ 00832000
         SLA   @05,2                                               0212 00833000
         LA    @01,HAVEDEV-4(@05)                                  0212 00834000
         TM    0(@01),B'10000000'                                  0212 00835000
         BO    @RF00212                                            0212 00836000
*       DO;                         /*                       @Y30LB12*/ 00837000
*         HAVEDEV(DEVINDEX)='1'B;   /* SET SPEC              @Y30LB12*/ 00838000
         LA    @01,HAVEDEV-4(@05)                                  0214 00839000
         OI    0(@01),B'10000000'                                  0214 00840000
*         KNOWN2='1'B;              /* FOR CONTROL LOOP      @Y30LB12*/ 00841000
         OI    KNOWN2,B'00100000'                                  0215 00842000
*         CALL S09DEVS1;            /* TO GET PARAMETERS     @Y30LB12*/ 00843000
         BAL   @14,S09DEVS1                                        0216 00844000
*       END;                        /*                       @Y30LB12*/ 00845000
*     ELSE                          /*                       @Y30LB12*/ 00846000
*       DO;                         /*                       @Y30LB12*/ 00847000
*                                                                  0218 00848000
         B     @RC00212                                            0218 00849000
@RF00212 DS    0H                                                  0219 00850000
*         /***********************************************************/ 00851000
*         /*                                                         */ 00852000
*         /* *************************************           @Y30LB12*/ 00853000
*         /* 'ICG219I DUPLICATE KEYWORD DEVX'                @Y30LB12*/ 00854000
*         /* *************************************           @Y30LB12*/ 00855000
*         /*                                                         */ 00856000
*         /***********************************************************/ 00857000
*                                                                  0219 00858000
*         OUTBUF2(1:27)=ICGDS219;   /*                       @Y30LB12*/ 00859000
         MVC   OUTBUF2(27,R4),ICGDS219                             0219 00860000
*         OUTBUF2(28:31)=SCANDATA(1:4);/*                    @Y30LB12*/ 00861000
         L     @05,STARTCOL(,R4)                                   0220 00862000
         MVC   OUTBUF2+27(4,R4),SCANDATA(@05)                      0220 00863000
*         CALL PUTIT1;              /* TO MESSAGE WRITER     @Y30LB12*/ 00864000
         BAL   @14,PUTIT1                                          0221 00865000
*       END;                        /*                       @Y30LB12*/ 00866000
*   END S09DEV;                     /* RETURN TO S09SCAN     @Y30LB12*/ 00867000
         B     @EL00007                                            0223 00868000
*                                                                  0224 00869000
*/********************************************************** @Y30LB12*/ 00870000
*/*                                                          @Y30LB12*/ 00871000
*/* PROCEDURE NAME - S09DEVS1                                @Y30LB12*/ 00872000
*/*                                                          @Y30LB12*/ 00873000
*/* FUNCTION - FOLLOWING DEVICE, THE DEVICE TYPE (3330-1 OR  @Y30LB12*/ 00874000
*/*            3330-11) AND THE MAJOR DEVICE USAGE (REAL OR  @Y30LB12*/ 00875000
*/*            STAGING) MUST APPEAR.  IF THE DEVICE IS USED  @Y30LB12*/ 00876000
*/*            FOR STAGING, CALL THE ROUTINE THAT GETS       @Y30LB12*/ 00877000
*/*            ADDITIONAL INFORMATION ABOUT ITS LOGICAL      @Y30LB12*/ 00878000
*/*            ADDRESS.                                      @Y30LB12*/ 00879000
*/*            THIS ROUTINE DETERMINES THE DEVICE TYPE AND   @Y30LB12*/ 00880000
*/*            CALLS S09DEVS2 TO DETERMINE DEVICE USAGE      @Y30LB12*/ 00881000
*/*                                                          @YD00113*/ 00882000
*/*            IF TEST FOR KEYWORD FAILS, ISSUE ERROR MSG    @YD00113*/ 00883000
*/*            ICG209I VIA 'PUTIT2'.  IF DEVICE IS NEITHER A @YD00113*/ 00884000
*/*            3330-1 OR A 3330-11, ISSUE ERROR MESSAGE      @YD00113*/ 00885000
*/*            ICG210I VIA 'UNKNOWN' PROCEDURE.              @YD00113*/ 00886000
*/*                                                          @Y30LB12*/ 00887000
*/********************************************************** @Y30LB12*/ 00888000
*                                                                  0224 00889000
*S09DEVS1:                                                         0224 00890000
*   PROCEDURE;                      /*                       @Y30LB12*/ 00891000
S09DEVS1 STM   @14,@12,@SA00008                                    0224 00892000
*   KNOWN2='0'B;                    /* FOUND KNOWN KEYWD     @Y30LB12*/ 00893000
         NI    KNOWN2,B'11011111'                                  0225 00894000
*   CALL READS99;                   /* EXTRACT PARAMETER     @Y30LB12*/ 00895000
         BAL   @14,READS99                                         0226 00896000
*   IF KEYBIT^='1'B                 /* SET BY ICGDSS99       @Y30LB12*/ 00897000
*     THEN                          /*                       @Y30LB12*/ 00898000
         TM    KEYBIT(R4),B'01000000'                              0227 00899000
         BO    @RF00227                                            0227 00900000
*     DO;                           /*                       @Y30LB12*/ 00901000
*                                                                  0228 00902000
*       /*************************************************************/ 00903000
*       /*                                                           */ 00904000
*       /* *****************************************         @Y30LB12*/ 00905000
*       /* ICG209I EXPECTED, BUT DID NOT FIND,               @Y30LB12*/ 00906000
*       /* KEYWORD                                           @Y30LB12*/ 00907000
*       /* *****************************************         @Y30LB12*/ 00908000
*       /*                                                           */ 00909000
*       /*************************************************************/ 00910000
*                                                                  0229 00911000
*       KNOWN2='1'B;                /* SUPPRESS ICG210I      @Y30LB12*/ 00912000
         OI    KNOWN2,B'00100000'                                  0229 00913000
*       MSGNO=ICG209I;              /* ID FOR ICG209I        @Y30LB12*/ 00914000
         MVC   MSGNO(2,R4),ICG209I                                 0230 00915000
*       CALL PUTIT2;                /* TO MESSAGE WRITER     @Y30LB12*/ 00916000
         BAL   @14,PUTIT2                                          0231 00917000
*       RETURN;                     /* RETURN TO S09DEV      @Y30LB12*/ 00918000
@EL00008 DS    0H                                                  0232 00919000
@EF00008 DS    0H                                                  0232 00920000
@ER00008 LM    @14,@12,@SA00008                                    0232 00921000
         BR    @14                                                 0232 00922000
*     END;                          /*                       @Y30LB12*/ 00923000
*   ELSE                                                           0234 00924000
*     ;                             /*                       @Y30LB12*/ 00925000
@RF00227 DS    0H                                                  0235 00926000
*   IF SCANLEN=6                    /* SET BY ICGDSS99       @Y30LB12*/ 00927000
*       &SCANDATA(1:7)='3330-1='    /* MERLIN TYPE DEV       @Y30LB12*/ 00928000
*     THEN                          /*                       @Y30LB12*/ 00929000
         CLC   SCANLEN(2,R4),@CH00227                              0235 00930000
         BNE   @RF00235                                            0235 00931000
         L     @05,STARTCOL(,R4)                                   0235 00932000
         CLC   SCANDATA(7,@05),@CC00509                            0235 00933000
         BNE   @RF00235                                            0235 00934000
*     DO;                           /*                       @Y30LB12*/ 00935000
*       KNOWN2='1'B;                /* RECOGNIZED PARM       @Y30LB12*/ 00936000
         OI    KNOWN2,B'00100000'                                  0237 00937000
*       REALTYPE(DEVINDEX)=PHYSFMER;/* LOCAL WORK            @X50RSPC*/ 00938000
         SLR   @05,@05                                             0238 00939000
         IC    @05,DEVINDEX                                        0238 00940000
         SLA   @05,2                                               0238 00941000
         LA    @01,REALTYPE-4(@05)                                 0238 00942000
         NI    0(@01),B'11111101'                                  0238 00943000
         OI    0(@01),B'00000100'                                  0238 00944000
*       CALL S09DEVS2;              /* FOR REAL OR SSID      @YM31093*/ 00945000
         BAL   @14,S09DEVS2                                        0239 00946000
*     END;                          /*                       @Y30LB12*/ 00947000
*   ELSE                                                           0241 00948000
*     ;                             /*                       @Y30LB12*/ 00949000
@RF00235 DS    0H                                                  0242 00950000
*   IF SCANLEN=7                    /* SET BY ICGDSS99       @Y30LB12*/ 00951000
*       &SCANDATA(1:8)='3330-11='   /* ICEBERG TYPE          @Y30LB12*/ 00952000
*     THEN                          /*                       @Y30LB12*/ 00953000
         CLC   SCANLEN(2,R4),@CH00135                              0242 00954000
         BNE   @RF00242                                            0242 00955000
         L     @05,STARTCOL(,R4)                                   0242 00956000
         CLC   SCANDATA(8,@05),@CC00511                            0242 00957000
         BNE   @RF00242                                            0242 00958000
*     DO;                           /*                       @Y30LB12*/ 00959000
*       KNOWN2='1'B;                /* RECOGNIZED PARM       @Y30LB12*/ 00960000
         OI    KNOWN2,B'00100000'                                  0244 00961000
*       REALTYPE(DEVINDEX)=PHYSFICE;/* LOCAL WORK            @X50RSPC*/ 00962000
         SLR   @05,@05                                             0245 00963000
         IC    @05,DEVINDEX                                        0245 00964000
         SLA   @05,2                                               0245 00965000
         LA    @01,REALTYPE-4(@05)                                 0245 00966000
         NI    0(@01),B'11111011'                                  0245 00967000
         OI    0(@01),B'00000010'                                  0245 00968000
*       CALL S09DEVS2;              /* FOR REAL OR SSID      @YM31093*/ 00969000
         BAL   @14,S09DEVS2                                        0246 00970000
*     END;                          /*                       @Y30LB12*/ 00971000
*   ELSE                                                           0248 00972000
*     ;                             /*                       @Y30LB12*/ 00973000
@RF00242 DS    0H                                                  0249 00974000
*   IF SCANLEN=4                    /* SET BY ICGDSS99       @X50RSPC*/ 00975000
*       &SCANDATA(1:5)='3350='      /* MADRID TYPE           @X50RSPC*/ 00976000
*     THEN                          /*                       @X50RSPC*/ 00977000
         CLC   SCANLEN(2,R4),@CH00070                              0249 00978000
         BNE   @RF00249                                            0249 00979000
         L     @05,STARTCOL(,R4)                                   0249 00980000
         CLC   SCANDATA(5,@05),@CC00512                            0249 00981000
         BNE   @RF00249                                            0249 00982000
*     DO;                           /*                       @X50RSPC*/ 00983000
*       KNOWN2='1'B;                /* RECOGNIZED PARM       @X50RSPC*/ 00984000
         OI    KNOWN2,B'00100000'                                  0251 00985000
*       REALTYPE(DEVINDEX)=PHYSFMAD;/* LOCAL WORK            @X50RSPC*/ 00986000
         SLR   @15,@15                                             0252 00987000
         IC    @15,DEVINDEX                                        0252 00988000
         LR    @14,@15                                             0252 00989000
         SLA   @14,2                                               0252 00990000
         LA    @01,REALTYPE-4(@14)                                 0252 00991000
         OI    0(@01),B'00000110'                                  0252 00992000
*       IF SCANDATA(6:9)^='REAL'    /* 3350 REAL             @ZZZZZZZ*/ 00993000
*         THEN                      /*                       @X50RSPC*/ 00994000
         CLC   SCANDATA+5(4,@05),@CC00513                          0253 00995000
         BE    @RF00253                                            0253 00996000
*         DO;                       /*                       @ZZZZZZZ*/ 00997000
*                                                                  0254 00998000
*           /*********************************************************/ 00999000
*           /*                                                       */ 01000000
*           /* ***********************************           @ZZZZZZZ*/ 01001000
*           /* ICG229I FOR DEVX, USAGE MUST BE               @ZZZZZZZ*/ 01002000
*           /* REAL                                          @ZZZZZZZ*/ 01003000
*           /* ***********************************           @ZZZZZZZ*/ 01004000
*           /*                                                       */ 01005000
*           /*********************************************************/ 01006000
*                                                                  0255 01007000
*           OUTBUF2(1:37)=ICGDS229; /*                       @ZZZZZZZ*/ 01008000
         MVC   OUTBUF2(37,R4),ICGDS229                             0255 01009000
*           OUTBUF2(17)=PATTERN(DEVINDEX);/*                 @ZZZZZZZ*/ 01010000
         LA    @05,PATTERN-1(@15)                                  0256 01011000
         MVC   OUTBUF2+16(1,R4),0(@05)                             0256 01012000
*           CALL PUTIT1;            /*                       @ZZZZZZZ*/ 01013000
         BAL   @14,PUTIT1                                          0257 01014000
*         END;                      /*                       @ZZZZZZZ*/ 01015000
*       CALL S09DEVS2;              /* REAL OR SSID          @X50RSPC*/ 01016000
@RF00253 BAL   @14,S09DEVS2                                        0259 01017000
*     END;                          /*                       @X50RSPC*/ 01018000
*   ELSE                                                           0261 01019000
*     ;                             /*                       @X50RSPC*/ 01020000
@RF00249 DS    0H                                                  0262 01021000
*   IF KNOWN2='0'B                  /* NOT MOD1 OR MOD11     @Y30LB12*/ 01022000
*     THEN                          /*                       @Y30LB12*/ 01023000
         TM    KNOWN2,B'00100000'                                  0262 01024000
         BNZ   @RF00262                                            0262 01025000
*     CALL UNKNOWN;                 /* FOR MSG ICG210I       @Y30LB12*/ 01026000
         BAL   @14,UNKNOWN                                         0263 01027000
*   ELSE                                                           0264 01028000
*     ;                             /*                       @Y30LB12*/ 01029000
@RF00262 DS    0H                                                  0265 01030000
*   END S09DEVS1;                   /*                       @Y30LB12*/ 01031000
         B     @EL00008                                            0265 01032000
*                                                                  0266 01033000
*/********************************************************** @Y30LB12*/ 01034000
*/*                                                          @Y30LB12*/ 01035000
*/* PROCEDURE NAME - S09DEVS2                                @Y30LB12*/ 01036000
*/*                                                          @Y30LB12*/ 01037000
*/* FUNCTION - SEARCH FOR VALUE 'REAL' OR 'SSID'.  CALL      @Y30LB12*/ 01038000
*/*            S09DEVSS IF 'SSID' FOUND                      @Y30LB12*/ 01039000
*/*                                                          @Y30LB12*/ 01040000
*/********************************************************** @Y30LB12*/ 01041000
*                                                                  0266 01042000
*S09DEVS2:                                                         0266 01043000
*   PROCEDURE;                      /*                       @Y30LB12*/ 01044000
S09DEVS2 STM   @14,@12,@SA00009                                    0266 01045000
*   KNOWN4='0'B;                    /* RESET FOUND FLAG      @YM32180*/ 01046000
         NI    KNOWN4,B'11110111'                                  0267 01047000
*   CALL READS99;                   /* EXTRACT VALUE         @Y30LB12*/ 01048000
*                                                                  0268 01049000
         BAL   @14,READS99                                         0268 01050000
*   /*****************************************************************/ 01051000
*   /*                                                               */ 01052000
*   /* ***********************************************       @Y30LB12*/ 01053000
*   /* IF THE SUB-PARAMETER IS REAL...                       @Y30LB12*/ 01054000
*   /* ***********************************************       @Y30LB12*/ 01055000
*   /*                                                               */ 01056000
*   /*****************************************************************/ 01057000
*                                                                  0269 01058000
*   IF SCANDATA(1:4)='REAL'         /*                       @Y30LB12*/ 01059000
*     THEN                          /*                       @Y30LB12*/ 01060000
         L     @05,STARTCOL(,R4)                                   0269 01061000
         CLC   SCANDATA(4,@05),@CC00513                            0269 01062000
         BNE   @RF00269                                            0269 01063000
*     DO;                           /*                       @Y30LB12*/ 01064000
*       KNOWN4='1'B;                /* RECOGNIZED PARM       @YM32180*/ 01065000
         OI    KNOWN4,B'00001000'                                  0271 01066000
*       REALSPEC(DEVINDEX)='1'B;    /* IN LOCAL WORK         @Y30LB12*/ 01067000
         SLR   @05,@05                                             0272 01068000
         IC    @05,DEVINDEX                                        0272 01069000
         SLA   @05,2                                               0272 01070000
         LA    @01,REALSPEC-4(@05)                                 0272 01071000
         OI    0(@01),B'01000000'                                  0272 01072000
*     END;                          /*                       @Y30LB12*/ 01073000
*   ELSE                                                           0274 01074000
*     ;                             /*                       @Y30LB12*/ 01075000
*                                                                  0274 01076000
@RF00269 DS    0H                                                  0275 01077000
*   /*****************************************************************/ 01078000
*   /*                                                               */ 01079000
*   /* ***********************************************       @Y30LB12*/ 01080000
*   /* IF THE SUB-PARAMETER IS SSID...                       @Y30LB12*/ 01081000
*   /* ***********************************************       @Y30LB12*/ 01082000
*   /*                                                               */ 01083000
*   /*****************************************************************/ 01084000
*                                                                  0275 01085000
*   IF SCANDATA(1:5)='SSID='        /*                       @Y30LB12*/ 01086000
*     THEN                          /*                       @Y30LB12*/ 01087000
         L     @05,STARTCOL(,R4)                                   0275 01088000
         CLC   SCANDATA(5,@05),@CC00518                            0275 01089000
         BNE   @RF00275                                            0275 01090000
*     DO;                           /*                       @Y30LB12*/ 01091000
*       KNOWN4='1'B;                /* RECOGNIZED PARM       @YM32180*/ 01092000
*       KNOWN3='1'B;                /* FOR CALLED PROC       @Y30LB12*/ 01093000
         OI    KNOWN4,B'00011000'                                  0278 01094000
*       SSIDSPEC(DEVINDEX)='1'B;    /*                       @Y30LB12*/ 01095000
         SLR   @05,@05                                             0279 01096000
         IC    @05,DEVINDEX                                        0279 01097000
         SLA   @05,2                                               0279 01098000
         LA    @01,SSIDSPEC-4(@05)                                 0279 01099000
         OI    0(@01),B'00100000'                                  0279 01100000
*       CALL S09DEVSS;              /* TO GET SUB-PARMS      @Y30LB12*/ 01101000
         BAL   @14,S09DEVSS                                        0280 01102000
*     END;                          /*                       @Y30LB12*/ 01103000
*   ELSE                                                           0282 01104000
*     ;                             /*                       @Y30LB12*/ 01105000
@RF00275 DS    0H                                                  0283 01106000
*   IF KNOWN4='0'B                  /* KEYWORD UNKNOWN       @YM32180*/ 01107000
*     THEN                          /*                       @Y30LB12*/ 01108000
         TM    KNOWN4,B'00001000'                                  0283 01109000
         BNZ   @RF00283                                            0283 01110000
*     IF PARMBIT='1'B               /*                       @Y30LB12*/ 01111000
*       THEN                        /*                       @Y30LB12*/ 01112000
         TM    PARMBIT(R4),B'00100000'                             0284 01113000
         BNO   @RF00284                                            0284 01114000
*       DO;                         /*                       @Y30LB12*/ 01115000
*                                                                  0285 01116000
*         /***********************************************************/ 01117000
*         /*                                                         */ 01118000
*         /* *************************************           @Y30LB12*/ 01119000
*         /* ICG212I UNDEFINED PARAMETER FOUND               @Y30LB12*/ 01120000
*         /* *************************************           @Y30LB12*/ 01121000
*         /*                                                         */ 01122000
*         /***********************************************************/ 01123000
*                                                                  0286 01124000
*         MSGNO=ICG212I;            /*                       @Y30LB12*/ 01125000
         MVC   MSGNO(2,R4),ICG212I                                 0286 01126000
*         CALL PUTIT2;              /* TO MESSAGE WRITER     @Y30LB12*/ 01127000
         BAL   @14,PUTIT2                                          0287 01128000
*       END;                        /*                       @Y30LB12*/ 01129000
*     ELSE                          /*                       @Y30LB12*/ 01130000
*       IF KEYBIT='1'B              /*                       @Y30LB12*/ 01131000
*         THEN                      /*                       @Y30LB12*/ 01132000
         B     @RC00284                                            0289 01133000
@RF00284 TM    KEYBIT(R4),B'01000000'                              0289 01134000
         BNO   @RF00289                                            0289 01135000
*         CALL UNKNOWN;             /*                       @Y30LB12*/ 01136000
         BAL   @14,UNKNOWN                                         0290 01137000
*       ELSE                                                       0291 01138000
*         ;                         /*                       @Y30LB12*/ 01139000
@RF00289 DS    0H                                                  0292 01140000
*   ELSE                                                           0292 01141000
*     ;                             /*                       @Y30LB12*/ 01142000
@RF00283 DS    0H                                                  0293 01143000
*   END S09DEVS2;                   /* RET TO S09DEVS1       @Y30LB12*/ 01144000
@EL00009 DS    0H                                                  0293 01145000
@EF00009 DS    0H                                                  0293 01146000
@ER00009 LM    @14,@12,@SA00009                                    0293 01147000
         BR    @14                                                 0293 01148000
*                                                                  0294 01149000
*/********************************************************** @Y30LB12*/ 01150000
*/*                                                          @Y30LB12*/ 01151000
*/* PROCEDURE NAME - S09DEVSS                                @Y30LB12*/ 01152000
*/*                                                          @Y30LB12*/ 01153000
*/* FUNCTION - WHEN THE DEVICE IS TO BE USED FOR STAGING,    @Y30LB12*/ 01154000
*/*            ITS LOGICAL ADDRESS (SSID) MUST ALSO BE       @Y30LB12*/ 01155000
*/*            KNOWN.  SSID CONSISTS OF STAGING DASD GROUP   @Y30LB12*/ 01156000
*/*            PLUS LOGICAL DEVICE WITHIN THE SDG.  IN       @Y30LB12*/ 01157000
*/*            ADDITION, STAGING DASD GROUP ATTACHES TO A    @Y30LB12*/ 01158000
*/*            'LOGICAL CONTROLLER' OR 'LOGICAL A-BOX' AND   @Y30LB12*/ 01159000
*/*            THE TWO LOGICAL CONTROLLERS FOR A GIVEN PAIR  @YD00113*/ 01160000
*/*            OF SDGS THAT ATTACH TO THE SAME STAGING       @Y30LB12*/ 01161000
*/*            ADAPTER MUST BE DIFFERENT.  THIS PROCEDURE    @Y30LB12*/ 01162000
*/*            LOOKS FOR THE THREE PARAMETERS REQUIRED       @Y30LB12*/ 01163000
*/*            TO LOGICALLY IDENTIFY A DEVICE WITHIN THE     @Y30LB12*/ 01164000
*/*            SUBSYSTEM AND CALLS THE PROPER PROCEDURES TO  @Y30LB12*/ 01165000
*/*            CHECK THE VALUES SPECIFIED.                   @Y30LB12*/ 01166000
*/*                                                          @Y30LB12*/ 01167000
*/********************************************************** @Y30LB12*/ 01168000
*                                                                  0294 01169000
*S09DEVSS:                                                         0294 01170000
*   PROCEDURE;                      /*                       @Y30LB12*/ 01171000
S09DEVSS STM   @14,@12,@SA00010                                    0294 01172000
*   DO WHILE(KNOWN3='1'B);          /* CONTROL LOOP          @Y30LB12*/ 01173000
         B     @DE00295                                            0295 01174000
@DL00295 DS    0H                                                  0296 01175000
*     KNOWN3='0'B;                  /* ZERO CONTROL FLAG     @Y30LB12*/ 01176000
         NI    KNOWN3,B'11101111'                                  0296 01177000
*     SAVENCOL=NEXTCOL;             /* SAVE FOR RESTART      @Y30LB12*/ 01178000
         MVC   SAVENCOL(4,R4),NEXTCOL(R4)                          0297 01179000
*     SAVESCOL=STARTCOL;            /* SAVE FOR RESTART      @Y30LB12*/ 01180000
         MVC   SAVESCOL(4,R4),STARTCOL(R4)                         0298 01181000
*     CALL READS99;                 /* EXTRACT PARAMETER     @Y30LB12*/ 01182000
*                                                                  0299 01183000
         BAL   @14,READS99                                         0299 01184000
*     /***************************************************************/ 01185000
*     /*                                                             */ 01186000
*     /* ***********************************************     @Y30LB12*/ 01187000
*     /* IF SUB-PARAMETER IS LUAX, SET FLAG 'KNOWN3'         @YD00113*/ 01188000
*     /* ON AND CALL 'S09LUA' TO GET SUFFIX DATA             @YD00113*/ 01189000
*     /* ***********************************************     @Y30LB12*/ 01190000
*     /*                                                             */ 01191000
*     /***************************************************************/ 01192000
*                                                                  0300 01193000
*     IF SCANDATA(1:3)='LUA'        /*                       @Y30LB12*/ 01194000
*       THEN                        /*                       @Y30LB12*/ 01195000
         L     @05,STARTCOL(,R4)                                   0300 01196000
         CLC   SCANDATA(3,@05),@CC00523                            0300 01197000
         BNE   @RF00300                                            0300 01198000
*       DO;                         /*                       @Y30LB12*/ 01199000
*         KNOWN3='1'B;              /* RECOGNIZED PARM       @Y30LB12*/ 01200000
         OI    KNOWN3,B'00010000'                                  0302 01201000
*         CALL S09LUA;              /* TO GET SUFFIX         @Y30LB12*/ 01202000
         BAL   @14,S09LUA                                          0303 01203000
*       END;                        /*                       @Y30LB12*/ 01204000
*     ELSE                                                         0305 01205000
*       ;                           /*                       @Y30LB12*/ 01206000
*                                                                  0305 01207000
@RF00300 DS    0H                                                  0306 01208000
*     /***************************************************************/ 01209000
*     /*                                                             */ 01210000
*     /* ***********************************************     @Y30LB12*/ 01211000
*     /* IF SUB-PARAMETER IS LCUX, SET FLAG 'KNOWN3'         @YD00113*/ 01212000
*     /* ON AND CALL 'S09LCU' TO GET SUFFIX DATA             @YD00113*/ 01213000
*     /* ***********************************************     @Y30LB12*/ 01214000
*     /*                                                             */ 01215000
*     /***************************************************************/ 01216000
*                                                                  0306 01217000
*     IF SCANDATA(1:3)='LCU'        /*                       @Y30LB12*/ 01218000
*       THEN                        /*                       @Y30LB12*/ 01219000
         L     @05,STARTCOL(,R4)                                   0306 01220000
         CLC   SCANDATA(3,@05),@CC00525                            0306 01221000
         BNE   @RF00306                                            0306 01222000
*       DO;                         /*                       @Y30LB12*/ 01223000
*         KNOWN3='1'B;              /* RECOGNIZED PARM       @Y30LB12*/ 01224000
         OI    KNOWN3,B'00010000'                                  0308 01225000
*         CALL S09LCU;              /* TO GET SUFFIX         @Y30LB12*/ 01226000
         BAL   @14,S09LCU                                          0309 01227000
*       END;                        /*                       @Y30LB12*/ 01228000
*     ELSE                                                         0311 01229000
*       ;                           /*                       @Y30LB12*/ 01230000
*                                                                  0311 01231000
@RF00306 DS    0H                                                  0312 01232000
*     /***************************************************************/ 01233000
*     /*                                                             */ 01234000
*     /* ***********************************************     @Y30LB12*/ 01235000
*     /* IF KEYWORD IS SDG, SET FLAG 'KNOWN3' ON AND         @YD00113*/ 01236000
*     /* CALL 'S09RSG' TO GET SUFFIX DATA                    @YD00113*/ 01237000
*     /* ***********************************************     @Y30LB12*/ 01238000
*     /*                                                             */ 01239000
*     /***************************************************************/ 01240000
*                                                                  0312 01241000
*     IF SCANDATA(1:3)='SDG'        /*                       @Y30LB12*/ 01242000
*       THEN                        /*                       @Y30LB12*/ 01243000
         L     @05,STARTCOL(,R4)                                   0312 01244000
         CLC   SCANDATA(3,@05),@CC00527                            0312 01245000
         BNE   @RF00312                                            0312 01246000
*       DO;                         /*                       @Y30LB12*/ 01247000
*         KNOWN3='1'B;              /* RECOGNIZED PARM       @Y30LB12*/ 01248000
         OI    KNOWN3,B'00010000'                                  0314 01249000
*         CALL S09RSG;              /* TO GET SUFFIX         @Y30LB12*/ 01250000
         BAL   @14,S09RSG                                          0315 01251000
*       END;                        /*                       @Y30LB12*/ 01252000
*     ELSE                                                         0317 01253000
*       ;                           /*                       @Y30LB12*/ 01254000
*                                                                  0317 01255000
@RF00312 DS    0H                                                  0318 01256000
*     /***************************************************************/ 01257000
*     /*                                                             */ 01258000
*     /* ***********************************************     @Y30LB12*/ 01259000
*     /* IF THE KEYWORD SCANNED IS NOT ANY OF THE ABOVE      @Y30LB12*/ 01260000
*     /* ***********************************************     @Y30LB12*/ 01261000
*     /*                                                             */ 01262000
*     /***************************************************************/ 01263000
*                                                                  0318 01264000
*     IF KNOWN3='0'B                /*                       @Y30LB12*/ 01265000
*         &KEYBIT='1'B              /* ITEM A KEYWORD        @YM32168*/ 01266000
*       THEN                        /*                       @Y30LB12*/ 01267000
         TM    KNOWN3,B'00010000'                                  0318 01268000
         BNZ   @RF00318                                            0318 01269000
         TM    KEYBIT(R4),B'01000000'                              0318 01270000
         BNO   @RF00318                                            0318 01271000
*       DO;                         /*                       @Y30LB12*/ 01272000
*         NEXTCOL=SAVENCOL;         /* RESTORE, RESCAN       @Y30LB12*/ 01273000
         MVC   NEXTCOL(4,R4),SAVENCOL(R4)                          0320 01274000
*         STARTCOL=SAVESCOL;        /* RESTORE, RESCAN       @Y30LB12*/ 01275000
         MVC   STARTCOL(4,R4),SAVESCOL(R4)                         0321 01276000
*         RETURN;                   /* RETURN TO S09DEVS2    @YM32168*/ 01277000
@EL00010 DS    0H                                                  0322 01278000
@EF00010 DS    0H                                                  0322 01279000
@ER00010 LM    @14,@12,@SA00010                                    0322 01280000
         BR    @14                                                 0322 01281000
*       END;                        /*                       @Y30LB12*/ 01282000
*     ELSE                                                         0324 01283000
*       ;                           /*                       @Y30LB12*/ 01284000
@RF00318 DS    0H                                                  0325 01285000
*     IF LASTPARM='1'B              /* NO MORE DATA          @YM32168*/ 01286000
*       THEN                        /*                       @YM32168*/ 01287000
         TM    LASTPARM(R4),B'00001000'                            0325 01288000
         BO    @RT00325                                            0325 01289000
*       RETURN;                     /* RETURN TO S09DEVS2    @YM32168*/ 01290000
*     IF KNOWN3='0'B                /*                       @YM32168*/ 01291000
*         &PARMBIT='1'B             /* ITEM A PARAMETER      @YM32168*/ 01292000
*       THEN                        /*                       @YM32168*/ 01293000
         TM    KNOWN3,B'00010000'                                  0327 01294000
         BNZ   @RF00327                                            0327 01295000
         TM    PARMBIT(R4),B'00100000'                             0327 01296000
         BNO   @RF00327                                            0327 01297000
*       DO;                         /*                       @YM32168*/ 01298000
*         KNOWN3='1'B;              /* TO KEEP SCANNING      @YM32168*/ 01299000
*                                                                  0329 01300000
         OI    KNOWN3,B'00010000'                                  0329 01301000
*         /***********************************************************/ 01302000
*         /*                                                         */ 01303000
*         /* *****************************************       @YM32168*/ 01304000
*         /* ICG212I UNDEFINED PARAMETER FOUND               @YM32168*/ 01305000
*         /* *****************************************       @YM32168*/ 01306000
*         /*                                                         */ 01307000
*         /***********************************************************/ 01308000
*                                                                  0330 01309000
*         MSGNO=ICG212I;            /*                       @YM32168*/ 01310000
         MVC   MSGNO(2,R4),ICG212I                                 0330 01311000
*         CALL PUTIT2;              /* TO MESSAGE WRITER     @YM32168*/ 01312000
         BAL   @14,PUTIT2                                          0331 01313000
*       END;                        /*                       @Y30LB12*/ 01314000
*     ELSE                                                         0333 01315000
*       ;                           /*                       @Y30LB12*/ 01316000
@RF00327 DS    0H                                                  0334 01317000
*   END;                            /* END OF 'DO WHILE'     @Y30LB12*/ 01318000
@DE00295 TM    KNOWN3,B'00010000'                                  0334 01319000
         BO    @DL00295                                            0334 01320000
*   END S09DEVSS;                   /* RET. TO S09DEVS1      @Y30LB12*/ 01321000
         B     @EL00010                                            0335 01322000
*                                                                  0336 01323000
*/********************************************************** @Y30LB12*/ 01324000
*/*                                                          @Y30LB12*/ 01325000
*/* PROCEDURE NAME - S09RSG                                  @Y30LB12*/ 01326000
*/*                                                          @Y30LB12*/ 01327000
*/* FUNCTION - EXTRACT THE VALUE SPECIFIED FOR SDG FROM THE  @Y30LB12*/ 01328000
*/*            PARAMETER AND CONVERT THE DECIMAL NUMBER 0-27 @Y30LB12*/ 01329000
*/*            TO A BINARY VALUE 01-1D AND STORE THE RESULT  @Y30LB12*/ 01330000
*/*            WORKRSG FOR THE PHYSICAL DEVICE. (ACTUAL      @Y30LB12*/ 01331000
*/*            STORE IS DONE IN THE PROCEDURE CONVRSG.)      @Y30LB12*/ 01332000
*/*            WORKRSG, AT THIS POINT, IS ONE GREATER THAN   @Y30LB12*/ 01333000
*/*            THE ACTUAL RSG, AND CAN BE USED DIRECTLY      @Y30LB12*/ 01334000
*/*            AS THE ONLY INDEX INTO BUILDRSG AND AS THE    @Y30LB12*/ 01335000
*/*            FIRST INDEX INTO PABTABLE.  THE VALUE THAT    @Y30LB12*/ 01336000
*/*            IS STORED IN SPNRSGNO WILL BE ONE LESS THAN   @Y30LB12*/ 01337000
*/*            THE CURRENT VALUE, AND WILL REPRESENT THE     @Y30LB12*/ 01338000
*/*            INPUT VALUE (0-27) IN BINARY (00-1C).         @Y30LB12*/ 01339000
*/*                                                          @Y30LB12*/ 01340000
*/********************************************************** @Y30LB12*/ 01341000
*                                                                  0336 01342000
*S09RSG:                                                           0336 01343000
*   PROCEDURE;                      /*                       @Y30LB12*/ 01344000
*                                                                  0336 01345000
S09RSG   STM   @14,@12,@SA00011                                    0336 01346000
*   /*****************************************************************/ 01347000
*   /*                                                               */ 01348000
*   /* ***********************************************       @YD00113*/ 01349000
*   /* INITIALIZE FIELD TO SAVE THE SDG NUMBER THEN          @YD00113*/ 01350000
*   /* TEST FOR DUPLICATE KEYWORD 'SDG' FOR DEVX.            @YD00113*/ 01351000
*   /* PRINT ERROR MESSAGE ICG219I FOR DUPLICATE.            @YD00113*/ 01352000
*   /* ***********************************************       @YD00113*/ 01353000
*   /*                                                               */ 01354000
*   /*****************************************************************/ 01355000
*                                                                  0337 01356000
*   HOLDRSG='0000'X;                /* RSG NUMBER            @Y30LB12*/ 01357000
         MVC   HOLDRSG(2),@CB00462                                 0337 01358000
*   IF WRSGSPEC(DEVINDEX)^='1'B     /*                       @Y30LB12*/ 01359000
*     THEN                          /*                       @Y30LB12*/ 01360000
         SLR   @05,@05                                             0338 01361000
         IC    @05,DEVINDEX                                        0338 01362000
         SLA   @05,2                                               0338 01363000
         LA    @01,WRSGSPEC-4(@05)                                 0338 01364000
         TM    0(@01),B'10000000'                                  0338 01365000
         BO    @RF00338                                            0338 01366000
*     WRSGSPEC(DEVINDEX)='1'B;      /*                       @Y30LB12*/ 01367000
         LA    @01,WRSGSPEC-4(@05)                                 0339 01368000
         OI    0(@01),B'10000000'                                  0339 01369000
*   ELSE                            /*                       @Y30LB12*/ 01370000
*     DO;                           /*                       @Y30LB12*/ 01371000
*                                                                  0340 01372000
         B     @RC00338                                            0340 01373000
@RF00338 DS    0H                                                  0341 01374000
*       /*************************************************************/ 01375000
*       /*                                                           */ 01376000
*       /* *****************************************         @Y30LB12*/ 01377000
*       /* ICG219I DUPLICATE KEYWORD SDG FOR DEVX            @Y30LB12*/ 01378000
*       /* *****************************************         @Y30LB12*/ 01379000
*       /*                                                           */ 01380000
*       /*************************************************************/ 01381000
*                                                                  0341 01382000
*       OUTBUF2(1:27)=ICGDS219;     /*                       @Y30LB12*/ 01383000
         MVC   OUTBUF2(27,R4),ICGDS219                             0341 01384000
*       OUTBUF2(28:38)='SDG FOR DEV';/*                      @Y30LB12*/ 01385000
         MVC   OUTBUF2+27(11,R4),@CC00533                          0342 01386000
*       OUTBUF2(39)=PATTERN(DEVINDEX);/*                     @Y30LB12*/ 01387000
         SLR   @05,@05                                             0343 01388000
         IC    @05,DEVINDEX                                        0343 01389000
         LA    @01,PATTERN-1(@05)                                  0343 01390000
         MVC   OUTBUF2+38(1,R4),0(@01)                             0343 01391000
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/ 01392000
         BAL   @14,PUTIT1                                          0344 01393000
*       RETURN;                     /* RET. TO S09DEVSS      @Y30LB12*/ 01394000
@EL00011 DS    0H                                                  0345 01395000
@EF00011 DS    0H                                                  0345 01396000
@ER00011 LM    @14,@12,@SA00011                                    0345 01397000
         BR    @14                                                 0345 01398000
*     END;                          /*                       @Y30LB12*/ 01399000
*                                                                  0346 01400000
*   /*****************************************************************/ 01401000
*   /*                                                               */ 01402000
*   /* ***********************************************       @YD00113*/ 01403000
*   /* TEST LENGTH OF DATA SCANNED. IF LENGTH IS 4,          @YD00113*/ 01404000
*   /* SET UP FIRST BYTE OF 'HOLDRSG' TO 'F0'X, THEN         @YD00113*/ 01405000
*   /* MOVE IN SECOND BYTE FROM THE DATA SCANNED.            @YD00113*/ 01406000
*   /* IF LENGTH IS 5, MOVE BOTH BYTES INTO 'HOLDRSG'        @YD00113*/ 01407000
*   /* FROM THE DATA SCANNED. IF SCANNED LENGTH IS           @YD00113*/ 01408000
*   /* NEITHER 4 NOR 5, PRINT ERROR MESSAGE ICG220I.         @YD00113*/ 01409000
*   /* ***********************************************       @YD00113*/ 01410000
*   /*                                                               */ 01411000
*   /*****************************************************************/ 01412000
*                                                                  0347 01413000
*   IF SCANLEN=4                    /* SET BY ICGDSS99       @Y30LB12*/ 01414000
*     THEN                          /*                       @Y30LB12*/ 01415000
@RC00338 CLC   SCANLEN(2,R4),@CH00070                              0347 01416000
         BNE   @RF00347                                            0347 01417000
*     DO;                           /*                       @Y30LB12*/ 01418000
*       HOLDRSG(1)='F0'X;           /* SET UP FIRST BYTE     @Y30LB12*/ 01419000
         MVI   HOLDRSG,X'F0'                                       0349 01420000
*       HOLDRSG(2)=SCANDATA(4);     /* MOVE 2ND BYTE         @Y30LB12*/ 01421000
         L     @05,STARTCOL(,R4)                                   0350 01422000
         MVC   HOLDRSG+1(1),SCANDATA+3(@05)                        0350 01423000
*     END;                          /*                       @Y30LB12*/ 01424000
*   ELSE                            /*                       @Y30LB12*/ 01425000
*     IF SCANLEN=5                  /* SET BY ICGDSS99       @Y30LB12*/ 01426000
*       THEN                        /*                       @Y30LB12*/ 01427000
         B     @RC00347                                            0352 01428000
@RF00347 CLC   SCANLEN(2,R4),@CH00121                              0352 01429000
         BNE   @RF00352                                            0352 01430000
*       HOLDRSG(1:2)=SCANDATA(4:5); /* MOVE 2                @Y30LB12*/ 01431000
         L     @05,STARTCOL(,R4)                                   0353 01432000
         MVC   HOLDRSG(2),SCANDATA+3(@05)                          0353 01433000
*     ELSE                          /*                       @Y30LB12*/ 01434000
*       DO;                         /*                       @Y30LB12*/ 01435000
*                                                                  0354 01436000
         B     @RC00352                                            0354 01437000
@RF00352 DS    0H                                                  0355 01438000
*         /***********************************************************/ 01439000
*         /*                                                         */ 01440000
*         /* *************************************           @Y30LB12*/ 01441000
*         /* ICG220I INVALID PARAMETER LENGTH,               @Y30LB12*/ 01442000
*         /* KEYWORD IS SDG FOR DEVX                         @Y30LB12*/ 01443000
*         /* *************************************           @Y30LB12*/ 01444000
*         /*                                                         */ 01445000
*         /***********************************************************/ 01446000
*                                                                  0355 01447000
*         OUTBUF2(1:46)=ICGDS220;   /*                       @Y30LB12*/ 01448000
         MVC   OUTBUF2(46,R4),ICGDS220                             0355 01449000
*         OUTBUF2(47:57)='SDG FOR DEV';/*                    @Y30LB12*/ 01450000
         MVC   OUTBUF2+46(11,R4),@CC00533                          0356 01451000
*         OUTBUF2(58)=PATTERN(DEVINDEX);/*                   @Y30LB12*/ 01452000
         SLR   @05,@05                                             0357 01453000
         IC    @05,DEVINDEX                                        0357 01454000
         LA    @01,PATTERN-1(@05)                                  0357 01455000
         MVC   OUTBUF2+57(1,R4),0(@01)                             0357 01456000
*         CALL PUTIT1;              /*                       @Y30LB12*/ 01457000
         BAL   @14,PUTIT1                                          0358 01458000
*         RETURN;                   /* RET. TO S09DEVSS      @Y30LB12*/ 01459000
         B     @EL00011                                            0359 01460000
*       END;                        /*                       @Y30LB12*/ 01461000
*   CALL CONVRSG;                   /* CONVERT AND STORE     @Y30LB12*/ 01462000
@RC00352 DS    0H                                                  0361 01463000
@RC00347 BAL   @14,CONVRSG                                         0361 01464000
*   END S09RSG;                     /* RET. TO S09DEVSS      @Y30LB12*/ 01465000
         B     @EL00011                                            0362 01466000
*                                                                  0363 01467000
*/********************************************************** @Y30LB12*/ 01468000
*/*                                                          @Y30LB12*/ 01469000
*/* PROCEDURE NAME - CONVRSG                                 @Y30LB12*/ 01470000
*/*                                                          @Y30LB12*/ 01471000
*/* FUNCTION - COMPARE THE XX PORTION OF SDGXX AS PASSED TO  @Y30LB12*/ 01472000
*/*            THIS PROCEDURE IN HOLDRSG TO THE VALID VALUES @Y30LB12*/ 01473000
*/*            FOR RSG AS DEFINED IN THE TABLE LOKUPRSG.  IF @Y30LB12*/ 01474000
*/*            A MATCH EXISTS, WORKRSG FOR THE APPROPRIATE   @Y30LB12*/ 01475000
*/*            DEVICE IS SET TO THE POSITION OF THE MATCH IN @Y30LB12*/ 01476000
*/*            IN THE TABLE IN BINARY, WHICH IS ONE GREATER  @Y30LB12*/ 01477000
*/*            THAN THE DECIMAL NUMBER PASSED.  IF NO MATCH, @Y30LB12*/ 01478000
*/*            WRITE MESSAGE ICG223I.                        @Y30LB12*/ 01479000
*/*                                                          @Y30LB12*/ 01480000
*/********************************************************** @Y30LB12*/ 01481000
*                                                                  0363 01482000
*CONVRSG:                                                          0363 01483000
*   PROCEDURE;                      /*                       @Y30LB12*/ 01484000
CONVRSG  STM   @14,@12,@SA00012                                    0363 01485000
*   DO I=1 TO 28;                   /* VALID VALUE RANGE     @Y30LB12*/ 01486000
         LA    I,1                                                 0364 01487000
@DL00364 DS    0H                                                  0365 01488000
*     IF HOLDRSG=LOKUPRSG(I)        /* MATCHING VALUE        @Y30LB12*/ 01489000
*       THEN                        /*                       @Y30LB12*/ 01490000
         LR    @05,I                                               0365 01491000
         ALR   @05,@05                                             0365 01492000
         LA    @03,LOKUPRSG-2(@05)                                 0365 01493000
         CLC   HOLDRSG(2),0(@03)                                   0365 01494000
         BNE   @RF00365                                            0365 01495000
*       DO;                         /*                       @Y30LB12*/ 01496000
*         WORKRSG(DEVINDEX)=I;      /* SDGXX+1, BINARY       @Y30LB12*/ 01497000
         SLR   @05,@05                                             0367 01498000
         IC    @05,DEVINDEX                                        0367 01499000
         SLA   @05,2                                               0367 01500000
         STC   I,WORKRSG-4(@05)                                    0367 01501000
*         RETURN;                   /* RETURN TO S09RSG      @Y30LB12*/ 01502000
@EL00012 DS    0H                                                  0368 01503000
@EF00012 DS    0H                                                  0368 01504000
@ER00012 LM    @14,@12,@SA00012                                    0368 01505000
         BR    @14                                                 0368 01506000
*       END;                        /*                       @Y30LB12*/ 01507000
*     ELSE                                                         0370 01508000
*       ;                           /*                       @Y30LB12*/ 01509000
@RF00365 DS    0H                                                  0371 01510000
*   END;                            /* DID 28, NO MATCH      @Y30LB12*/ 01511000
*                                                                  0371 01512000
         AH    I,@CH00044                                          0371 01513000
         CH    I,@CH00343                                          0371 01514000
         BNH   @DL00364                                            0371 01515000
*   /*****************************************************************/ 01516000
*   /*                                                               */ 01517000
*   /* ***********************************************       @Y30LB12*/ 01518000
*   /* ICG223I VALUE ERROR FOR SDG FOR DEVX                  @Y30LB12*/ 01519000
*   /* ***********************************************       @Y30LB12*/ 01520000
*   /*                                                               */ 01521000
*   /*****************************************************************/ 01522000
*                                                                  0372 01523000
*   OUTBUF2(1:25)=ICGDS223;         /*                       @Y30LB12*/ 01524000
         MVC   OUTBUF2(25,R4),ICGDS223                             0372 01525000
*   OUTBUF2(26:36)='SDG FOR DEV';   /*                       @Y30LB12*/ 01526000
         MVC   OUTBUF2+25(11,R4),@CC00533                          0373 01527000
*   OUTBUF2(37)=PATTERN(DEVINDEX);  /*                       @Y30LB12*/ 01528000
         SLR   @05,@05                                             0374 01529000
         IC    @05,DEVINDEX                                        0374 01530000
         LA    @01,PATTERN-1(@05)                                  0374 01531000
         MVC   OUTBUF2+36(1,R4),0(@01)                             0374 01532000
*   CALL PUTIT1;                    /*                       @Y30LB12*/ 01533000
         BAL   @14,PUTIT1                                          0375 01534000
*   END CONVRSG;                    /* RETURN TO S09RSG      @Y30LB12*/ 01535000
         B     @EL00012                                            0376 01536000
*                                                                  0377 01537000
*/********************************************************** @Y30LB12*/ 01538000
*/*                                                          @Y30LB12*/ 01539000
*/* PROCEDURE NAME - S09LCU                                  @Y30LB12*/ 01540000
*/*                                                          @Y30LB12*/ 01541000
*/* FUNCTION - EXTRACT THE LOGICAL CONTROLLER (OR LOGICAL    @Y30LB12*/ 01542000
*/*            A-BOX) FROM THE 'LCUX' PARAMETER.  THE        @Y30LB12*/ 01543000
*/*            LOGICAL CONTROLLER MUST BE EITHER 0 OR 1.     @Y30LB12*/ 01544000
*/*            THE FUNCTION OF LOCICAL CONTROLLER IS TO      @Y30LB12*/ 01545000
*/*            DISTINGUISH IN THE STAGING ADAPTER BETWEEN    @Y30LB12*/ 01546000
*/*            THE TWO STAGING DASD GROUPS.                  @Y30LB12*/ 01547000
*/*                                                          @Y30LB12*/ 01548000
*/********************************************************** @Y30LB12*/ 01549000
*                                                                  0377 01550000
*S09LCU:                                                           0377 01551000
*   PROCEDURE;                      /*                       @Y30LB12*/ 01552000
*                                                                  0377 01553000
S09LCU   STM   @14,@12,@SA00013                                    0377 01554000
*   /*****************************************************************/ 01555000
*   /*                                                               */ 01556000
*   /* ***********************************************       @YD00113*/ 01557000
*   /* TEST FOR DUPLICATE KEYWORD 'LCU' FOR DEVX. IF         @YD00113*/ 01558000
*   /* DUPLICATED, PRINT ERROR MESSAGE ICG219I.              @YD00113*/ 01559000
*   /* ***********************************************       @YD00113*/ 01560000
*   /*                                                               */ 01561000
*   /*****************************************************************/ 01562000
*                                                                  0378 01563000
*   IF ABOXSPEC(DEVINDEX)^='1'B     /*                       @Y30LB12*/ 01564000
*     THEN                          /*                       @Y30LB12*/ 01565000
         SLR   @05,@05                                             0378 01566000
         IC    @05,DEVINDEX                                        0378 01567000
         SLA   @05,2                                               0378 01568000
         LA    @01,ABOXSPEC-4(@05)                                 0378 01569000
         TM    0(@01),B'00010000'                                  0378 01570000
         BO    @RF00378                                            0378 01571000
*     ABOXSPEC(DEVINDEX)='1'B;      /*                       @Y30LB12*/ 01572000
         LA    @01,ABOXSPEC-4(@05)                                 0379 01573000
         OI    0(@01),B'00010000'                                  0379 01574000
*   ELSE                            /*                       @Y30LB12*/ 01575000
*     DO;                           /*                       @Y30LB12*/ 01576000
*                                                                  0380 01577000
         B     @RC00378                                            0380 01578000
@RF00378 DS    0H                                                  0381 01579000
*       /*************************************************************/ 01580000
*       /*                                                           */ 01581000
*       /* *****************************************         @Y30LB12*/ 01582000
*       /* ICG219I DUPLICATE KEYWORD LCU FOR                 @Y30LB12*/ 01583000
*       /* FOR DEVX                                          @Y30LB12*/ 01584000
*       /* *****************************************         @Y30LB12*/ 01585000
*       /*                                                           */ 01586000
*       /*************************************************************/ 01587000
*                                                                  0381 01588000
*       OUTBUF2(1:27)=ICGDS219;     /*                       @Y30LB12*/ 01589000
         MVC   OUTBUF2(27,R4),ICGDS219                             0381 01590000
*       OUTBUF2(28:38)='LCU FOR DEV';/*                      @Y30LB12*/ 01591000
         MVC   OUTBUF2+27(11,R4),@CC00545                          0382 01592000
*       OUTBUF2(39)=PATTERN(DEVINDEX);/*                     @Y30LB12*/ 01593000
         SLR   @05,@05                                             0383 01594000
         IC    @05,DEVINDEX                                        0383 01595000
         LA    @01,PATTERN-1(@05)                                  0383 01596000
         MVC   OUTBUF2+38(1,R4),0(@01)                             0383 01597000
*       CALL PUTIT1;                /*                       @Y30LB12*/ 01598000
         BAL   @14,PUTIT1                                          0384 01599000
*       RETURN;                     /*                       @Y30LB12*/ 01600000
@EL00013 DS    0H                                                  0385 01601000
@EF00013 DS    0H                                                  0385 01602000
@ER00013 LM    @14,@12,@SA00013                                    0385 01603000
         BR    @14                                                 0385 01604000
*     END;                          /*                       @Y30LB12*/ 01605000
*                                                                  0386 01606000
*   /*****************************************************************/ 01607000
*   /*                                                               */ 01608000
*   /* ***********************************************       @YD00113*/ 01609000
*   /* TEST TO ASSURE LENGTH OF DATA SCANNED IS 4.           @YD00113*/ 01610000
*   /* IF LENGTH IS ANY VALUE OTHER THAN 4, PRINT            @YD00113*/ 01611000
*   /* ERROR MESSAGE ICG220I.                                @YD00113*/ 01612000
*   /* ***********************************************       @YD00113*/ 01613000
*   /*                                                               */ 01614000
*   /*****************************************************************/ 01615000
*                                                                  0387 01616000
*   IF SCANLEN^=4                   /* SET BY ICGDSS99       @Y30LB12*/ 01617000
*     THEN                          /*                       @Y30LB12*/ 01618000
@RC00378 CLC   SCANLEN(2,R4),@CH00070                              0387 01619000
         BE    @RF00387                                            0387 01620000
*     DO;                           /*                       @Y30LB12*/ 01621000
*                                                                  0388 01622000
*       /*************************************************************/ 01623000
*       /*                                                           */ 01624000
*       /* *****************************************         @Y30LB12*/ 01625000
*       /* ICG220I INVALID PARAMETER LENGTH,                 @Y30LB12*/ 01626000
*       /* KEYWORD IS LCU FOR DEVX                           @Y30LB12*/ 01627000
*       /* *****************************************         @Y30LB12*/ 01628000
*       /*                                                           */ 01629000
*       /*************************************************************/ 01630000
*                                                                  0389 01631000
*       OUTBUF2(1:46)=ICGDS220;     /*                       @Y30LB12*/ 01632000
         MVC   OUTBUF2(46,R4),ICGDS220                             0389 01633000
*       OUTBUF2(47:57)='LCU FOR DEV';/*                      @Y30LB12*/ 01634000
         MVC   OUTBUF2+46(11,R4),@CC00545                          0390 01635000
*       OUTBUF2(58)=PATTERN(DEVINDEX);/*                     @Y30LB12*/ 01636000
         SLR   @05,@05                                             0391 01637000
         IC    @05,DEVINDEX                                        0391 01638000
         LA    @01,PATTERN-1(@05)                                  0391 01639000
         MVC   OUTBUF2+57(1,R4),0(@01)                             0391 01640000
*       CALL PUTIT1;                /*                       @Y30LB12*/ 01641000
         BAL   @14,PUTIT1                                          0392 01642000
*       RETURN;                     /* RET. TO S09DEVSS      @Y30LB12*/ 01643000
         B     @EL00013                                            0393 01644000
*     END;                          /*                       @Y30LB12*/ 01645000
*   ELSE                                                           0395 01646000
*     ;                             /*                       @Y30LB12*/ 01647000
*                                                                  0395 01648000
@RF00387 DS    0H                                                  0396 01649000
*   /*****************************************************************/ 01650000
*   /*                                                               */ 01651000
*   /* ***********************************************       @YD00113*/ 01652000
*   /* TEST PARAMETER VALUE FOR LCU TO BE EITHER             @YD00113*/ 01653000
*   /* 1 OR 0. IF VALUE IS 1, SET FLAG 'ABOX1'               @YD00113*/ 01654000
*   /* TO '1'. IF VALUE IS NEITHER 0 NOR 1, PRINT            @YD00113*/ 01655000
*   /* ERROR MESSAGE ICG223I.                                @YD00113*/ 01656000
*   /* ***********************************************       @YD00113*/ 01657000
*   /*                                                               */ 01658000
*   /*****************************************************************/ 01659000
*                                                                  0396 01660000
*   IF SCANDATA(4)='1'              /* IF PARM LCU1          @Y30LB12*/ 01661000
*     THEN                          /*                       @Y30LB12*/ 01662000
         L     @05,STARTCOL(,R4)                                   0396 01663000
         CLI   SCANDATA+3(@05),C'1'                                0396 01664000
         BNE   @RF00396                                            0396 01665000
*     ABOX1(DEVINDEX)='1'B;         /* SET EXTRA FLAG        @Y30LB12*/ 01666000
         SLR   @05,@05                                             0397 01667000
         IC    @05,DEVINDEX                                        0397 01668000
         SLA   @05,2                                               0397 01669000
         LA    @01,ABOX1-4(@05)                                    0397 01670000
         OI    0(@01),B'00001000'                                  0397 01671000
*   ELSE                            /*                       @Y30LB12*/ 01672000
*     IF SCANDATA(4)^='0'           /* IF PARM NOT LCU0      @Y30LB12*/ 01673000
*       THEN                        /*                       @Y30LB12*/ 01674000
         B     @RC00396                                            0398 01675000
@RF00396 L     @05,STARTCOL(,R4)                                   0398 01676000
         CLI   SCANDATA+3(@05),C'0'                                0398 01677000
         BE    @RF00398                                            0398 01678000
*       DO;                         /*                       @Y30LB12*/ 01679000
*                                                                  0399 01680000
*         /***********************************************************/ 01681000
*         /*                                                         */ 01682000
*         /* *************************************           @Y30LB12*/ 01683000
*         /* ICG223I VALUE ERROR FOR LCU FOR DEVX            @Y30LB12*/ 01684000
*         /* *************************************           @Y30LB12*/ 01685000
*         /*                                                         */ 01686000
*         /***********************************************************/ 01687000
*                                                                  0400 01688000
*         OUTBUF2(1:25)=ICGDS223;   /*                       @Y30LB12*/ 01689000
         MVC   OUTBUF2(25,R4),ICGDS223                             0400 01690000
*         OUTBUF2(26:36)='LCU FOR DEV';/*                    @Y30LB12*/ 01691000
         MVC   OUTBUF2+25(11,R4),@CC00545                          0401 01692000
*         OUTBUF2(37)=PATTERN(DEVINDEX);/*                   @Y30LB12*/ 01693000
         SLR   @05,@05                                             0402 01694000
         IC    @05,DEVINDEX                                        0402 01695000
         LA    @01,PATTERN-1(@05)                                  0402 01696000
         MVC   OUTBUF2+36(1,R4),0(@01)                             0402 01697000
*         CALL PUTIT1;              /*                       @Y30LB12*/ 01698000
         BAL   @14,PUTIT1                                          0403 01699000
*       END;                        /*                       @Y30LB12*/ 01700000
*     ELSE                                                         0405 01701000
*       ;                           /*                       @Y30LB12*/ 01702000
@RF00398 DS    0H                                                  0406 01703000
*   END S09LCU;                     /* RET. TO S09DEVSS      @Y30LB12*/ 01704000
         B     @EL00013                                            0406 01705000
*                                                                  0407 01706000
*/********************************************************** @Y30LB12*/ 01707000
*/*                                                          @Y30LB12*/ 01708000
*/* PROCEDURE NAME - S09LUA                                  @Y30LB12*/ 01709000
*/*                                                          @Y30LB12*/ 01710000
*/* FUNCTION - FOR SPINDLES THAT ARE USED FOR STAGING,       @Y30LB12*/ 01711000
*/*            EXTRACT THE LOGICAL UNIT (OR DEVICE) ADDRESS. @Y30LB12*/ 01712000
*/*            THE LOGICAL UNIT ADDRESS DOES NOT HAVE TO     @Y30LB12*/ 01713000
*/*            CORRESPOND TO THE PHYSICAL DEVICE ADDRESS.    @Y30LB12*/ 01714000
*/*            THE LOGICAL DEVICE ADDRESS BECOMES THE LOW-   @Y30LB12*/ 01715000
*/*            THREE BITS OF THE SSID.                       @Y30LB12*/ 01716000
*/*                                                          @Y30LB12*/ 01717000
*/*            LOGICAL UNIT ADDRESS IS A DIGIT IN THE RANGE  @Y30LB12*/ 01718000
*/*            0-7.  THE VALUE IS STORED IN WKLOGDEV AS A    @Y30LB12*/ 01719000
*/*            BINARY VALUE IN THE RANGE 0 TO 7.  WHEN 1     @Y30LB12*/ 01720000
*/*            IS ADDED TO IT, IT IS USED AS THE SECOND      @Y30LB12*/ 01721000
*/*            INDEX INTO PABTABLE.  THE VALUE STORED IN     @Y30LB12*/ 01722000
*/*            LGDEVICE IN PHYSTYPE IS THREE BITS IN THE     @Y30LB12*/ 01723000
*/*            RANGE 000-111.                                @Y30LB12*/ 01724000
*/*                                                          @Y30LB12*/ 01725000
*/*            IN THIS PROCEDURE, DECINDEX IS THE LOGICAL    @Y30LB12*/ 01726000
*/*            DEVICE INDEX AND DEVINDEX IS THE PHYSICAL     @Y30LB12*/ 01727000
*/*            DEVICE INDEX.                                 @Y30LB12*/ 01728000
*/*                                                          @Y30LB12*/ 01729000
*/********************************************************** @Y30LB12*/ 01730000
*                                                                  0407 01731000
*S09LUA:                                                           0407 01732000
*   PROCEDURE;                      /*                       @Y30LB12*/ 01733000
*                                                                  0407 01734000
S09LUA   STM   @14,@12,@SA00014                                    0407 01735000
*   /*****************************************************************/ 01736000
*   /*                                                               */ 01737000
*   /* ***********************************************       @YD00113*/ 01738000
*   /* TEST FOR DUPLICATE KEYWORD 'LUA' FOR DEVX. IF         @YD00113*/ 01739000
*   /* DUPLICATED, PRINT ERROR MESSAGE ICG219I.              @YD00113*/ 01740000
*   /* ***********************************************       @YD00113*/ 01741000
*   /*                                                               */ 01742000
*   /*****************************************************************/ 01743000
*                                                                  0408 01744000
*   IF LDEVSPEC(DEVINDEX)^='1'B     /*                       @Y30LB12*/ 01745000
*     THEN                          /*                       @Y30LB12*/ 01746000
         SLR   @05,@05                                             0408 01747000
         IC    @05,DEVINDEX                                        0408 01748000
         SLA   @05,2                                               0408 01749000
         LA    @01,LDEVSPEC-4(@05)                                 0408 01750000
         TM    0(@01),B'00000001'                                  0408 01751000
         BO    @RF00408                                            0408 01752000
*     LDEVSPEC(DEVINDEX)='1'B;      /*                       @Y30LB12*/ 01753000
         LA    @01,LDEVSPEC-4(@05)                                 0409 01754000
         OI    0(@01),B'00000001'                                  0409 01755000
*   ELSE                            /*                       @Y30LB12*/ 01756000
*     DO;                           /*                       @Y30LB12*/ 01757000
*                                                                  0410 01758000
         B     @RC00408                                            0410 01759000
@RF00408 DS    0H                                                  0411 01760000
*       /*************************************************************/ 01761000
*       /*                                                           */ 01762000
*       /* *****************************************         @Y30LB12*/ 01763000
*       /* ICG219I DUPLICATE KEYWORD LUA FOR DEVX            @Y30LB12*/ 01764000
*       /* *****************************************         @Y30LB12*/ 01765000
*       /*                                                           */ 01766000
*       /*************************************************************/ 01767000
*                                                                  0411 01768000
*       OUTBUF2(1:27)=ICGDS219;     /*                       @Y30LB12*/ 01769000
         MVC   OUTBUF2(27,R4),ICGDS219                             0411 01770000
*       OUTBUF2(28:39)='LUA FOR DEV';/*                      @Y30LB12*/ 01771000
         MVI   OUTBUF2+38(R4),C' '                                 0412 01772000
         MVC   OUTBUF2+27(11,R4),@CC00550                          0412 01773000
*       OUTBUF2(40)=PATTERN(DEVINDEX);/*                     @Y30LB12*/ 01774000
         SLR   @05,@05                                             0413 01775000
         IC    @05,DEVINDEX                                        0413 01776000
         LA    @01,PATTERN-1(@05)                                  0413 01777000
         MVC   OUTBUF2+39(1,R4),0(@01)                             0413 01778000
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/ 01779000
         BAL   @14,PUTIT1                                          0414 01780000
*       RETURN;                     /* RET. TO S09DEVSS      @Y30LB12*/ 01781000
@EL00014 DS    0H                                                  0415 01782000
@EF00014 DS    0H                                                  0415 01783000
@ER00014 LM    @14,@12,@SA00014                                    0415 01784000
         BR    @14                                                 0415 01785000
*     END;                          /*                       @Y30LB12*/ 01786000
*                                                                  0416 01787000
*   /*****************************************************************/ 01788000
*   /*                                                               */ 01789000
*   /* ***********************************************       @YD00113*/ 01790000
*   /* TEST TO ASSURE LENGTH OF DATA SCANNED IS 4.           @YD00113*/ 01791000
*   /* IF LENGTH IS ANY VALUE OTHER THAN 4, PRINT            @YD00113*/ 01792000
*   /* ERROR MESSAGE ICG220I.                                @YD00113*/ 01793000
*   /* ***********************************************       @YD00113*/ 01794000
*   /*                                                               */ 01795000
*   /*****************************************************************/ 01796000
*                                                                  0417 01797000
*   IF SCANLEN^=4                   /* SET BY ICGDSS99       @Y30LB12*/ 01798000
*     THEN                          /*                       @Y30LB12*/ 01799000
@RC00408 CLC   SCANLEN(2,R4),@CH00070                              0417 01800000
         BE    @RF00417                                            0417 01801000
*     DO;                           /*                       @Y30LB12*/ 01802000
*                                                                  0418 01803000
*       /*************************************************************/ 01804000
*       /*                                                           */ 01805000
*       /* *****************************************         @Y30LB12*/ 01806000
*       /* ICG220I INVALID PARAMETER LENGTH,                 @Y30LB12*/ 01807000
*       /* KEYWORD IS LUA FOR DEVX                           @Y30LB12*/ 01808000
*       /* *****************************************         @Y30LB12*/ 01809000
*       /*                                                           */ 01810000
*       /*************************************************************/ 01811000
*                                                                  0419 01812000
*       OUTBUF2(1:46)=ICGDS220;     /*                       @Y30LB12*/ 01813000
         MVC   OUTBUF2(46,R4),ICGDS220                             0419 01814000
*       OUTBUF2(47:57)='LUA FOR DEV';/*                      @Y30LB12*/ 01815000
         MVC   OUTBUF2+46(11,R4),@CC00550                          0420 01816000
*       OUTBUF2(58)=PATTERN(DEVINDEX);/*                     @Y30LB12*/ 01817000
         SLR   @05,@05                                             0421 01818000
         IC    @05,DEVINDEX                                        0421 01819000
         LA    @01,PATTERN-1(@05)                                  0421 01820000
         MVC   OUTBUF2+57(1,R4),0(@01)                             0421 01821000
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/ 01822000
         BAL   @14,PUTIT1                                          0422 01823000
*       RETURN;                     /* RET. TO S09DEVSS      @Y30LB12*/ 01824000
         B     @EL00014                                            0423 01825000
*     END;                          /*                       @Y30LB12*/ 01826000
*   ELSE                                                           0425 01827000
*     ;                             /*                       @Y30LB12*/ 01828000
*                                                                  0425 01829000
@RF00417 DS    0H                                                  0426 01830000
*   /*****************************************************************/ 01831000
*   /*                                                               */ 01832000
*   /* ***********************************************       @YD00113*/ 01833000
*   /* SAVE SCANNED DATA (4 BYTES) AS DATA FOR               @YD00113*/ 01834000
*   /* A POSSIBLE ERROR MESSAGE. SAVE LOW ORDER              @YD00113*/ 01835000
*   /* BYTE OF DATA AND CALL 'CONVDEC' PROCEDURE             @YD00113*/ 01836000
*   /* TO CONVERT THAT BYTE TO A BINARY VALUE, ONE           @YD00113*/ 01837000
*   /* HIGHER THAN THE ORIGINAL VALUE. IF THE VALUE          @YD00113*/ 01838000
*   /* DID NOT GET CONVERTED, RETURN TO CALLING              @YD00113*/ 01839000
*   /* ROUTINE. OTHERWISE, SAVE LOGICAL DEVICE ADDR          @YD00113*/ 01840000
*   /* IN THE TABLE.                                         @YD00113*/ 01841000
*   /* ***********************************************       @YD00113*/ 01842000
*   /*                                                               */ 01843000
*   /*****************************************************************/ 01844000
*                                                                  0426 01845000
*   PLUGIN(1:4)=SCANDATA(1:4);      /* FOR MESSAGE           @Y30LB12*/ 01846000
         L     @05,STARTCOL(,R4)                                   0426 01847000
         MVC   PLUGIN(4),SCANDATA(@05)                             0426 01848000
*   WORKDEV=SCANDATA(4);            /* VALUE TO CONVERT      @Y30LB12*/ 01849000
         MVC   WORKDEV(1),SCANDATA+3(@05)                          0427 01850000
*   CALL CONVDEC;                   /* CONV. TO BINARY+1     @Y30LB12*/ 01851000
         BAL   @14,CONVDEC                                         0428 01852000
*   IF DECINDEX=0                   /* CONVERT FAILED        @Y30LB12*/ 01853000
*     THEN                          /*                       @Y30LB12*/ 01854000
         CLI   DECINDEX,0                                          0429 01855000
         BE    @RT00429                                            0429 01856000
*     RETURN;                       /* MSG ALREADY DONE      @Y30LB12*/ 01857000
*   ELSE                                                           0431 01858000
*     ;                             /*                       @Y30LB12*/ 01859000
*   WKLOGDEV(DEVINDEX)=WORKDEV;     /* LOGICAL DEVICE        @Y30LB12*/ 01860000
         SLR   @05,@05                                             0432 01861000
         IC    @05,DEVINDEX                                        0432 01862000
         SLA   @05,2                                               0432 01863000
         SLR   @15,@15                                             0432 01864000
         IC    @15,WORKDEV                                         0432 01865000
         STC   @15,WKLOGDEV-4(@05)                                 0432 01866000
*   END S09LUA;                     /* RET. TO S09DEVSS      @Y30LB12*/ 01867000
         B     @EL00014                                            0433 01868000
*                                                                  0434 01869000
*/********************************************************** @Y30LB12*/ 01870000
*/*                                                          @Y30LB12*/ 01871000
*/* PROCEDURE NAME - UNKNOWN                                 @Y30LB12*/ 01872000
*/*                                                          @Y30LB12*/ 01873000
*/* FUNCTION - IF THE KEYWORD IS NOT 'SA', 'CUA' OR 'DEVX',  @Y30LB12*/ 01874000
*/*            WRITE ERROR MESSAGE ICG210I UNDEFINED         @Y30LB12*/ 01875000
*/*            KEYWORD FOUND, AND DO READ TO POSITION AT     @Y30LB12*/ 01876000
*/*            THE NEXT KEYWORD.                             @Y30LB12*/ 01877000
*/*                                                          @Y30LB12*/ 01878000
*/********************************************************** @Y30LB12*/ 01879000
*                                                                  0434 01880000
*UNKNOWN:                                                          0434 01881000
*   PROCEDURE;                      /*                       @Y30LB12*/ 01882000
UNKNOWN  STM   @14,@12,@SA00015                                    0434 01883000
*   MSGNO=ICG210I;                  /* ID FOR ICGDS210       @Y30LB12*/ 01884000
         MVC   MSGNO(2,R4),ICG210I                                 0435 01885000
*   CALL PUTIT2;                    /* TO MESSAGE WRITER     @Y30LB12*/ 01886000
         BAL   @14,PUTIT2                                          0436 01887000
*   CALL READS99;                   /* TO DO DUMMY READ      @Y30LB12*/ 01888000
         BAL   @14,READS99                                         0437 01889000
*   END UNKNOWN;                    /* RETURN TO S09SCAN     @Y30LB12*/ 01890000
@EL00015 DS    0H                                                  0438 01891000
@EF00015 DS    0H                                                  0438 01892000
@ER00015 LM    @14,@12,@SA00015                                    0438 01893000
         BR    @14                                                 0438 01894000
*                                                                  0439 01895000
*/********************************************************** @Y30LB12*/ 01896000
*/*                                                          @Y30LB12*/ 01897000
*/* PROCEDURE NAME - CONVDEC                                 @Y30LB12*/ 01898000
*/*                                                          @Y30LB12*/ 01899000
*/* FUNCTION - THIS PROCEDURE RECEIVES AS INPUT THE          @Y30LB12*/ 01900000
*/*            CHARACTER REPRESENTATION OF A SINGLE          @Y30LB12*/ 01901000
*/*            DECIMAL DIGIT IN 'WORKDEV'.  IF THE           @Y30LB12*/ 01902000
*/*            CHARACTER REPRESENTS A VALID DECIMAL          @Y30LB12*/ 01903000
*/*            DIGIT IN THE RANGE 0-7, IT IS CONVERTED       @Y30LB12*/ 01904000
*/*            TO BINARY IN WORKDEV, AND DECINDEX IS SET     @Y30LB12*/ 01905000
*/*            TO WORKDEV + 1.  OTHERWISE MESSAGE            @Y30LB12*/ 01906000
*/*            ICGDS223 IS WRITTEN.                          @Y30LB12*/ 01907000
*/*                                                          @Y30LB12*/ 01908000
*/********************************************************** @Y30LB12*/ 01909000
*                                                                  0439 01910000
*CONVDEC:                                                          0439 01911000
*   PROCEDURE;                      /*                       @Y30LB12*/ 01912000
CONVDEC  STM   @14,@12,@SA00016                                    0439 01913000
*   DECINDEX=0;                     /* INITIALIZE TO 0       @Y30LB12*/ 01914000
         MVI   DECINDEX,X'00'                                      0440 01915000
*   DO I=1 TO 8;                    /* 8 POSSIBILITIES       @Y30LB12*/ 01916000
         LA    I,1                                                 0441 01917000
@DL00441 DS    0H                                                  0442 01918000
*     IF WORKDEV=PATTERN(I)         /* IF MATCH TO CHAR      @Y30LB12*/ 01919000
*       THEN                        /*                       @Y30LB12*/ 01920000
         SLR   @05,@05                                             0442 01921000
         IC    @05,WORKDEV                                         0442 01922000
         LA    @03,PATTERN-1(I)                                    0442 01923000
         MVC   @ZT00003+3(1),0(@03)                                0442 01924000
         C     @05,@ZT00003                                        0442 01925000
         BNE   @RF00442                                            0442 01926000
*       DO;                         /*                       @Y30LB12*/ 01927000
*         DECINDEX=I;               /* INDEX IS 1-8 BIN      @Y30LB12*/ 01928000
         STC   I,DECINDEX                                          0444 01929000
*         WORKDEV=DECINDEX-1;       /* CHARS ARE 0-7         @Y30LB12*/ 01930000
         SLR   @05,@05                                             0445 01931000
         IC    @05,DECINDEX                                        0445 01932000
         BCTR  @05,0                                               0445 01933000
         STC   @05,WORKDEV                                         0445 01934000
*         RETURN;                   /* RETURN TO CALLER      @Y30LB12*/ 01935000
@EL00016 DS    0H                                                  0446 01936000
@EF00016 DS    0H                                                  0446 01937000
@ER00016 LM    @14,@12,@SA00016                                    0446 01938000
         BR    @14                                                 0446 01939000
*       END;                        /*                       @Y30LB12*/ 01940000
*     ELSE                                                         0448 01941000
*       ;                           /*                       @Y30LB12*/ 01942000
@RF00442 DS    0H                                                  0449 01943000
*   END;                            /* ALL 8 & NO MATCH      @Y30LB12*/ 01944000
*                                                                  0449 01945000
         AH    I,@CH00044                                          0449 01946000
         CH    I,@CH00042                                          0449 01947000
         BNH   @DL00441                                            0449 01948000
*   /*****************************************************************/ 01949000
*   /*                                                               */ 01950000
*   /* ***********************************************       @Y30LB12*/ 01951000
*   /* ICG223I VALUE ERROR FOR XXXXXXXX                      @Y30LB12*/ 01952000
*   /* ***********************************************       @Y30LB12*/ 01953000
*   /*                                                               */ 01954000
*   /*****************************************************************/ 01955000
*                                                                  0450 01956000
*   OUTBUF2(1:25)=ICGDS223;         /*                       @Y30LB12*/ 01957000
         MVC   OUTBUF2(25,R4),ICGDS223                             0450 01958000
*   OUTBUF2(26:29)=PLUGIN;          /*                       @Y30LB12*/ 01959000
         MVC   OUTBUF2+25(4,R4),PLUGIN                             0451 01960000
*   CALL PUTIT1;                    /* TO MESSAGE WRITER     @Y30LB12*/ 01961000
         BAL   @14,PUTIT1                                          0452 01962000
*   END CONVDEC;                    /* RETURN TO CALLER      @Y30LB12*/ 01963000
         B     @EL00016                                            0453 01964000
*                                                                  0454 01965000
*/********************************************************** @Y30LB12*/ 01966000
*/*                                                          @Y30LB12*/ 01967000
*/* PROCEDURE NAME - S09ANAL                                 @Y30LB12*/ 01968000
*/*                                                          @Y30LB12*/ 01969000
*/* FUNCTION - CHECK FOR OMITTED, REQUIRED KEYWORDS, 'SA',   @YD00113*/ 01970000
*/*            'CUA', AND DEVICE TYPE FOR 'DEVX'.  THEN      @YD00113*/ 01971000
*/*            CHECK FOR OMITTED PARAMETERS FOR 'DEVX',      @YD00113*/ 01972000
*/*            'REAL' OR 'SSID', 'SDG', 'LCU', AND 'LUA'.    @YD00113*/ 01973000
*/*            CHECK TO ASSURE THAT IF PHYSICAL DEVICE IS    @YD00113*/ 01974000
*/*            A 3330-11, LOGICAL DEVICES RESIDING ON THE    @YD00113*/ 01975000
*/*            PHYSICAL DEVICE MUST BE AN EVEN/ODD PAIR.     @YD00113*/ 01976000
*/*            TEST TO ASSURE THE TWO SA IDENTIFICATIONS     @YD00113*/ 01977000
*/*            ARE DIFFERENT, AND NON ZERO.                  @YD00113*/ 01978000
*/*                                                          @YD00113*/ 01979000
*/*            IF ANY OF ABOVE TESTS FAIL, PRINT APPROPRIATE @YD00113*/ 01980000
*/*            ERROR MESSAGE.                                @YD00113*/ 01981000
*/*                                                          @Y30LB12*/ 01982000
*/********************************************************** @Y30LB12*/ 01983000
*                                                                  0454 01984000
*S09ANAL:                                                          0454 01985000
*   PROCEDURE;                      /*                       @Y30LB12*/ 01986000
S09ANAL  STM   @14,@12,@SA00017                                    0454 01987000
*   IF HAVEDS^='1'B                 /*                       @Y30LB12*/ 01988000
*     THEN                          /*                       @Y30LB12*/ 01989000
         TM    HAVEDS,B'10000000'                                  0455 01990000
         BO    @RF00455                                            0455 01991000
*     DO;                           /*                       @Y30LB12*/ 01992000
*                                                                  0456 01993000
*       /*************************************************************/ 01994000
*       /*                                                           */ 01995000
*       /* *****************************************         @Y30LB12*/ 01996000
*       /* ICG221I MISSING REQUIRED KEYWORD SA               @Y30LB12*/ 01997000
*       /* *****************************************         @Y30LB12*/ 01998000
*       /*                                                           */ 01999000
*       /*************************************************************/ 02000000
*                                                                  0457 02001000
*       OUTBUF2(1:34)=ICGDS221;     /*                       @Y30LB12*/ 02002000
         MVC   OUTBUF2(34,R4),ICGDS221                             0457 02003000
*       OUTBUF2(35:36)='SA';        /*                       @Y30LB12*/ 02004000
         MVC   OUTBUF2+34(2,R4),@CC00491                           0458 02005000
*       CALL PUTIT1;                /*                       @Y30LB12*/ 02006000
         BAL   @14,PUTIT1                                          0459 02007000
*     END;                          /*                       @Y30LB12*/ 02008000
*   ELSE                                                           0461 02009000
*     ;                             /*                       @Y30LB12*/ 02010000
@RF00455 DS    0H                                                  0462 02011000
*   IF HAVECUA^='1'B                /*                       @Y30LB12*/ 02012000
*     THEN                          /*                       @Y30LB12*/ 02013000
         TM    HAVECUA,B'01000000'                                 0462 02014000
         BO    @RF00462                                            0462 02015000
*     DO;                           /*                       @Y30LB12*/ 02016000
*                                                                  0463 02017000
*       /*************************************************************/ 02018000
*       /*                                                           */ 02019000
*       /* *****************************************         @Y30LB12*/ 02020000
*       /* ICG221I MISSING REQUIRED KEYWORD CUA              @Y30LB12*/ 02021000
*       /* *****************************************         @Y30LB12*/ 02022000
*       /*                                                           */ 02023000
*       /*************************************************************/ 02024000
*                                                                  0464 02025000
*       OUTBUF2(1:34)=ICGDS221;     /*                       @Y30LB12*/ 02026000
         MVC   OUTBUF2(34,R4),ICGDS221                             0464 02027000
*       OUTBUF2(35:37)='CUA';       /*                       @Y30LB12*/ 02028000
         MVC   OUTBUF2+34(3,R4),@CC00481                           0465 02029000
*       CALL PUTIT1;                /*                       @Y30LB12*/ 02030000
         BAL   @14,PUTIT1                                          0466 02031000
*     END;                          /*                       @Y30LB12*/ 02032000
*   ELSE                                                           0468 02033000
*     ;                             /*                       @Y30LB12*/ 02034000
@RF00462 DS    0H                                                  0469 02035000
*   DO I=1 TO 8;                    /* 8 POSSIBLE DEVS       @Y30LB12*/ 02036000
         LA    I,1                                                 0469 02037000
@DL00469 DS    0H                                                  0470 02038000
*     IF HAVEDEV(I)='1'B            /* PHYSICAL DEVICE       @Y30LB12*/ 02039000
*       THEN                        /*                       @Y30LB12*/ 02040000
         LR    @05,I                                               0470 02041000
         SLA   @05,2                                               0470 02042000
         LA    @03,HAVEDEV-4(@05)                                  0470 02043000
         TM    0(@03),B'10000000'                                  0470 02044000
         BNO   @RF00470                                            0470 02045000
*       DO;                         /*                       @Y30LB12*/ 02046000
*         FOUNDDEV='1'B;            /* AT LEAST 1 DEVX       @Y30LB12*/ 02047000
         OI    FOUNDDEV,B'00100000'                                0472 02048000
*         IF REALTYPE(I)='00'B      /* NOT VALID             @X50RSPC*/ 02049000
*           THEN                    /*                       @Y30LB12*/ 02050000
         LA    @03,REALTYPE-4(@05)                                 0473 02051000
         TM    0(@03),B'00000110'                                  0473 02052000
         BNZ   @RF00473                                            0473 02053000
*           DO;                     /*                       @Y30LB12*/ 02054000
*                                                                  0474 02055000
*             /*******************************************************/ 02056000
*             /*                                                     */ 02057000
*             /* *********************************           @Y30LB12*/ 02058000
*             /* ICG221I MISSING REQUIRED                    @Y30LB12*/ 02059000
*             /* KEYWORD DEVICE TYPE FOR DEVX                @Y30LB12*/ 02060000
*             /* *********************************           @Y30LB12*/ 02061000
*             /*                                                     */ 02062000
*             /*******************************************************/ 02063000
*                                                                  0475 02064000
*             OUTBUF2(1:34)=ICGDS221;/*                      @Y30LB12*/ 02065000
         MVC   OUTBUF2(34,R4),ICGDS221                             0475 02066000
*             OUTBUF2(35:53)='DEVICE TYPE FOR DEV';                0476 02067000
         MVC   OUTBUF2+34(19,R4),@CC00563                          0476 02068000
*             OUTBUF2(54)=PATTERN(I);/*                      @Y30LB12*/ 02069000
         LA    @05,PATTERN-1(I)                                    0477 02070000
         MVC   OUTBUF2+53(1,R4),0(@05)                             0477 02071000
*             CALL PUTIT1;          /*                       @Y30LB12*/ 02072000
         BAL   @14,PUTIT1                                          0478 02073000
*           END;                    /*                       @Y30LB12*/ 02074000
*         ELSE                                                     0480 02075000
*           ;                       /*                       @Y30LB12*/ 02076000
@RF00473 DS    0H                                                  0481 02077000
*         IF REALSPEC(I)='0'B       /*                       @Y30LB12*/ 02078000
*             &SSIDSPEC(I)='0'B     /*                       @Y30LB12*/ 02079000
*           THEN                    /*                       @Y30LB12*/ 02080000
         LR    @05,I                                               0481 02081000
         SLA   @05,2                                               0481 02082000
         LA    @03,REALSPEC-4(@05)                                 0481 02083000
         TM    0(@03),B'01100000'                                  0481 02084000
         BNZ   @RF00481                                            0481 02085000
*           DO;                     /*                       @Y30LB12*/ 02086000
*                                                                  0482 02087000
*             /*******************************************************/ 02088000
*             /*                                                     */ 02089000
*             /* *********************************           @Y30LB12*/ 02090000
*             /* ICG241I MISSING REQUIRED                    @Y30LB12*/ 02091000
*             /* PARAMETER REAL OR SSID FOR DEVX             @Y30LB12*/ 02092000
*             /* *********************************           @Y30LB12*/ 02093000
*             /*                                                     */ 02094000
*             /*******************************************************/ 02095000
*                                                                  0483 02096000
*             OUTBUF2(1:36)=ICGDS241;/*                      @Y30LB12*/ 02097000
         MVC   OUTBUF2(36,R4),ICGDS241                             0483 02098000
*             OUTBUF2(37:56)='REAL OR SSID FOR DEV';               0484 02099000
         MVC   OUTBUF2+36(20,R4),@CC00567                          0484 02100000
*             OUTBUF2(57)=PATTERN(I);/*                      @Y30LB12*/ 02101000
         LA    @05,PATTERN-1(I)                                    0485 02102000
         MVC   OUTBUF2+56(1,R4),0(@05)                             0485 02103000
*             CALL PUTIT1;          /*                       @Y30LB12*/ 02104000
         BAL   @14,PUTIT1                                          0486 02105000
*           END;                    /*                       @Y30LB12*/ 02106000
*         ELSE                                                     0488 02107000
*           ;                       /*                       @Y30LB12*/ 02108000
@RF00481 DS    0H                                                  0489 02109000
*         IF SSIDSPEC(I)='1'B       /* IF HAS SSID           @Y30LB12*/ 02110000
*           THEN                    /*                       @Y30LB12*/ 02111000
         LR    @05,I                                               0489 02112000
         SLA   @05,2                                               0489 02113000
         LA    @03,SSIDSPEC-4(@05)                                 0489 02114000
         TM    0(@03),B'00100000'                                  0489 02115000
         BNO   @RF00489                                            0489 02116000
*           DO;                     /*                       @Y30LB12*/ 02117000
*             IF WRSGSPEC(I)='0'B   /* NEEDS RSG             @Y30LB12*/ 02118000
*               THEN                /*                       @Y30LB12*/ 02119000
         LA    @03,WRSGSPEC-4(@05)                                 0491 02120000
         TM    0(@03),B'10000000'                                  0491 02121000
         BNZ   @RF00491                                            0491 02122000
*               DO;                 /*                       @Y30LB12*/ 02123000
*                                                                  0492 02124000
*                 /***************************************************/ 02125000
*                 /*                                                 */ 02126000
*                 /* ***************************             @Y30LB12*/ 02127000
*                 /* ICG241I MISSING REQUIRED                @Y30LB12*/ 02128000
*                 /* PARAMETER SDG FOR DEVX                  @Y30LB12*/ 02129000
*                 /* ***************************             @Y30LB12*/ 02130000
*                 /*                                                 */ 02131000
*                 /***************************************************/ 02132000
*                                                                  0493 02133000
*                 OUTBUF2(1:36)=ICGDS241;/*                  @Y30LB12*/ 02134000
         MVC   OUTBUF2(36,R4),ICGDS241                             0493 02135000
*                 OUTBUF2(37:47)='SDG FOR DEV';                    0494 02136000
         MVC   OUTBUF2+36(11,R4),@CC00533                          0494 02137000
*                 OUTBUF2(48)=PATTERN(I);/*                  @Y30LB12*/ 02138000
         LA    @05,PATTERN-1(I)                                    0495 02139000
         MVC   OUTBUF2+47(1,R4),0(@05)                             0495 02140000
*                 CALL PUTIT1;      /*                       @Y30LB12*/ 02141000
         BAL   @14,PUTIT1                                          0496 02142000
*               END;                /*                       @Y30LB12*/ 02143000
*             ELSE                                                 0498 02144000
*               ;                   /*                       @Y30LB12*/ 02145000
@RF00491 DS    0H                                                  0499 02146000
*             IF ABOXSPEC(I)='0'B   /* NEEDS LCU             @Y30LB12*/ 02147000
*               THEN                /*                       @Y30LB12*/ 02148000
         LR    @05,I                                               0499 02149000
         SLA   @05,2                                               0499 02150000
         LA    @03,ABOXSPEC-4(@05)                                 0499 02151000
         TM    0(@03),B'00010000'                                  0499 02152000
         BNZ   @RF00499                                            0499 02153000
*               DO;                 /*                       @Y30LB12*/ 02154000
*                                                                  0500 02155000
*                 /***************************************************/ 02156000
*                 /*                                                 */ 02157000
*                 /* ***************************             @Y30LB12*/ 02158000
*                 /* ICG241I MISSING REQUIRED                @Y30LB12*/ 02159000
*                 /* PARAMETER LCU FOR DEVX                  @Y30LB12*/ 02160000
*                 /* ***************************             @Y30LB12*/ 02161000
*                 /*                                                 */ 02162000
*                 /***************************************************/ 02163000
*                                                                  0501 02164000
*                 OUTBUF2(1:36)=ICGDS241;/*                  @Y30LB12*/ 02165000
         MVC   OUTBUF2(36,R4),ICGDS241                             0501 02166000
*                 OUTBUF2(37:47)='LCU FOR DEV';                    0502 02167000
         MVC   OUTBUF2+36(11,R4),@CC00545                          0502 02168000
*                 OUTBUF2(48)=PATTERN(I);/*                  @Y30LB12*/ 02169000
         LA    @05,PATTERN-1(I)                                    0503 02170000
         MVC   OUTBUF2+47(1,R4),0(@05)                             0503 02171000
*                 CALL PUTIT1;      /*                       @Y30LB12*/ 02172000
         BAL   @14,PUTIT1                                          0504 02173000
*               END;                /*                       @Y30LB12*/ 02174000
*             ELSE                                                 0506 02175000
*               ;                   /*                       @Y30LB12*/ 02176000
@RF00499 DS    0H                                                  0507 02177000
*             IF LDEVSPEC(I)='0'B   /* NEEDS LUA             @Y30LB12*/ 02178000
*               THEN                /*                       @Y30LB12*/ 02179000
         LR    @05,I                                               0507 02180000
         SLA   @05,2                                               0507 02181000
         LA    @03,LDEVSPEC-4(@05)                                 0507 02182000
         TM    0(@03),B'00000001'                                  0507 02183000
         BNZ   @RF00507                                            0507 02184000
*               DO;                 /*                       @Y30LB12*/ 02185000
*                                                                  0508 02186000
*                 /***************************************************/ 02187000
*                 /*                                                 */ 02188000
*                 /* ***************************             @Y30LB12*/ 02189000
*                 /* ICG241I MISSING REQUIRED                @Y30LB12*/ 02190000
*                 /* PARAMETER LUA FOR DEVX                  @Y30LB12*/ 02191000
*                 /* ***************************             @Y30LB12*/ 02192000
*                 /*                                                 */ 02193000
*                 /***************************************************/ 02194000
*                                                                  0509 02195000
*                 OUTBUF2(1:36)=ICGDS241;/*                  @Y30LB12*/ 02196000
         MVC   OUTBUF2(36,R4),ICGDS241                             0509 02197000
*                 OUTBUF2(37:47)='LUA FOR DEV';                    0510 02198000
         MVC   OUTBUF2+36(11,R4),@CC00550                          0510 02199000
*                 OUTBUF2(48)=PATTERN(I);/*                  @Y30LB12*/ 02200000
         LA    @05,PATTERN-1(I)                                    0511 02201000
         MVC   OUTBUF2+47(1,R4),0(@05)                             0511 02202000
*                 CALL PUTIT1;      /*                       @Y30LB12*/ 02203000
         BAL   @14,PUTIT1                                          0512 02204000
*               END;                /*                       @Y30LB12*/ 02205000
*             ELSE                                                 0514 02206000
*               ;                   /*                       @Y30LB12*/ 02207000
*                                                                  0514 02208000
@RF00507 DS    0H                                                  0515 02209000
*             /*******************************************************/ 02210000
*             /*                                                     */ 02211000
*             /* **********************************          @Y30LB12*/ 02212000
*             /* IF THE PHYSICAL DEVICE IS A 3330            @Y30LB12*/ 02213000
*             /* MODEL 11, THE TWO LOGICAL                   @Y30LB12*/ 02214000
*             /* DEVICES RESIDING ON THE PHYSICAL            @Y30LB12*/ 02215000
*             /* DEVICE MUST BE AN EVEN/ODD PAIR.            @Y30LB12*/ 02216000
*             /* **********************************          @Y30LB12*/ 02217000
*             /*                                                     */ 02218000
*             /*******************************************************/ 02219000
*                                                                  0515 02220000
*             IF REALTYPE(I)=PHYSFICE/*                      @X50RSPC*/ 02221000
*               THEN                /*                       @Y30LB12*/ 02222000
         LR    @05,I                                               0515 02223000
         SLA   @05,2                                               0515 02224000
         LA    @03,REALTYPE-4(@05)                                 0515 02225000
         TM    0(@03),B'00000010'                                  0515 02226000
         BNO   @RF00515                                            0515 02227000
         TM    0(@03),B'00000100'                                  0515 02228000
         BNZ   @RF00515                                            0515 02229000
*               IF WKLOGDEV(I)^=0   /*                       @Y30LB12*/ 02230000
*                   &WKLOGDEV(I)^=2 /*                       @Y30LB12*/ 02231000
*                   &WKLOGDEV(I)^=4 /*                       @Y30LB12*/ 02232000
*                   &WKLOGDEV(I)^=6 /*                       @Y30LB12*/ 02233000
*                 THEN              /*                       @Y30LB12*/ 02234000
         SLR   @03,@03                                             0516 02235000
         IC    @03,WKLOGDEV-4(@05)                                 0516 02236000
         LTR   @03,@03                                             0516 02237000
         BZ    @RF00516                                            0516 02238000
         CH    @03,@CH00052                                        0516 02239000
         BE    @RF00516                                            0516 02240000
         CH    @03,@CH00070                                        0516 02241000
         BE    @RF00516                                            0516 02242000
         CH    @03,@CH00227                                        0516 02243000
         BE    @RF00516                                            0516 02244000
*                 DO;               /*                       @Y30LB12*/ 02245000
*                                                                  0517 02246000
*                   /*************************************************/ 02247000
*                   /*                                               */ 02248000
*                   /* ***********************               @Y30LB12*/ 02249000
*                   /* ICG247I LOGICAL DEVICE                @Y30LB12*/ 02250000
*                   /* FOR DEV X MUST BE 0,                  @Y30LB12*/ 02251000
*                   /* 2, 4, OR 6                            @Y30LB12*/ 02252000
*                   /* ***********************               @Y30LB12*/ 02253000
*                   /*                                               */ 02254000
*                   /*************************************************/ 02255000
*                                                                  0518 02256000
*                   OUTBUF2(1:55)=ICGDS247;                        0518 02257000
         MVC   OUTBUF2(55,R4),ICGDS247                             0518 02258000
*                   OUTBUF2(33)=PATTERN(I);                        0519 02259000
         LA    @05,PATTERN-1(I)                                    0519 02260000
         MVC   OUTBUF2+32(1,R4),0(@05)                             0519 02261000
*                   CALL PUTIT1;    /*                       @Y30LB12*/ 02262000
         BAL   @14,PUTIT1                                          0520 02263000
*                 END;              /*                       @Y30LB12*/ 02264000
*               ELSE                                               0522 02265000
*                 ;                 /*                       @Y30LB12*/ 02266000
@RF00516 DS    0H                                                  0523 02267000
*           END;                    /*                       @Y30LB12*/ 02268000
@RF00515 DS    0H                                                  0524 02269000
*       END;                        /*                       @Y30LB12*/ 02270000
@RF00489 DS    0H                                                  0525 02271000
*   END;                            /* EXAMINED ALL 8        @Y30LB12*/ 02272000
@RF00470 AH    I,@CH00044                                          0525 02273000
         CH    I,@CH00042                                          0525 02274000
         BNH   @DL00469                                            0525 02275000
*   IF FOUNDDEV='0'B THEN                                          0526 02276000
         TM    FOUNDDEV,B'00100000'                                0526 02277000
         BNZ   @RF00526                                            0526 02278000
*     DO;                                                          0527 02279000
*                                                                  0527 02280000
*       /*************************************************************/ 02281000
*       /*                                                           */ 02282000
*       /* *****************************************         @Y30LB12*/ 02283000
*       /* ICGDS221 MISSING REQUIRED KEYWORD DEVX            @Y30LB12*/ 02284000
*       /* *****************************************         @Y30LB12*/ 02285000
*       /*                                                           */ 02286000
*       /*************************************************************/ 02287000
*                                                                  0528 02288000
*       OUTBUF2(1:34)=ICGDS221;     /*                       @Y30LB12*/ 02289000
         MVC   OUTBUF2(34,R4),ICGDS221                             0528 02290000
*       OUTBUF2(35:38)='DEVX';      /*                       @Y30LB12*/ 02291000
         MVC   OUTBUF2+34(4,R4),@CC00570                           0529 02292000
*       CALL PUTIT1;                /* TO MESSAGE WRITER     @Y30LB12*/ 02293000
         BAL   @14,PUTIT1                                          0530 02294000
*     END;                          /*                       @Y30LB12*/ 02295000
*   ELSE                                                           0532 02296000
*     ;                             /*                       @Y30LB12*/ 02297000
@RF00526 DS    0H                                                  0533 02298000
*   IF DSINDEX1=DSINDEX2            /*                       @Y30LB12*/ 02299000
*       &DSINDEX1^=0                /*                       @Y30LB12*/ 02300000
*     THEN                          /*                       @Y30LB12*/ 02301000
         LH    @05,DSINDEX1                                        0533 02302000
         CH    @05,DSINDEX2                                        0533 02303000
         BNE   @RF00533                                            0533 02304000
         LTR   @05,@05                                             0533 02305000
         BZ    @RF00533                                            0533 02306000
*     DO;                           /*                       @Y30LB12*/ 02307000
*                                                                  0534 02308000
*       /*************************************************************/ 02309000
*       /*                                                           */ 02310000
*       /* *****************************************         @Y30LB12*/ 02311000
*       /* ICG243I TWO SA IDENTIFICATIONS MUST BE            @Y30LB12*/ 02312000
*       /* DIFFERENT                                         @Y30LB12*/ 02313000
*       /* *****************************************         @Y30LB12*/ 02314000
*       /*                                                           */ 02315000
*       /*************************************************************/ 02316000
*                                                                  0535 02317000
*       MSGNO=ICG243I;              /* IDENT FOR ICG243I     @Y30LB12*/ 02318000
         MVC   MSGNO(2,R4),ICG243I                                 0535 02319000
*       CALL PUTIT2;                /* TO MESSAGE WRITER     @Y30LB12*/ 02320000
         BAL   @14,PUTIT2                                          0536 02321000
*     END;                          /*                       @Y30LB12*/ 02322000
*   ELSE                                                           0538 02323000
*     ;                             /*                       @Y30LB12*/ 02324000
@RF00533 DS    0H                                                  0539 02325000
*   END S09ANAL;                    /* RET. TO MAINLINE      @Y30LB12*/ 02326000
@EL00017 DS    0H                                                  0539 02327000
@EF00017 DS    0H                                                  0539 02328000
@ER00017 LM    @14,@12,@SA00017                                    0539 02329000
         BR    @14                                                 0539 02330000
*                                                                  0540 02331000
*/********************************************************** @Y30LB12*/ 02332000
*/*                                                          @Y30LB12*/ 02333000
*/* PROCEDURE NAME - S09BUILD                                @Y30LB12*/ 02334000
*/*                                                          @Y30LB12*/ 02335000
*/* FUNCTION - UPDATE PHYSTYPE STRUCTURE EITHER ONCE OR      @Y30LB12*/ 02336000
*/*            TWICE, DEPENDING ON WHETHER ONE OR TWO SA'S   @Y30LB12*/ 02337000
*/*            WERE SPECIFIED.  IF TWO SA'S WERE SPECIFIED,  @Y30LB12*/ 02338000
*/*            UPDATE PHYSDS2 FOR BOTH STAGING ADAPTER/DASD  @Y30LB12*/ 02339000
*/*            CONTROLLER TO POINT AT OTHER DS.              @Y30LB12*/ 02340000
*/*            CALL UPDATPAB TO UPDATE THE PABTABLE AND      @Y30LB12*/ 02341000
*/*            BUILDRSG FOR STAGING DEVICES ONLY.            @Y30LB12*/ 02342000
*/*                                                          @Y30LB12*/ 02343000
*/********************************************************** @Y30LB12*/ 02344000
*                                                                  0540 02345000
*S09BUILD:                                                         0540 02346000
*   PROCEDURE;                      /*                       @Y30LB12*/ 02347000
*                                                                  0540 02348000
S09BUILD STM   @14,@12,@SA00018                                    0540 02349000
*   /*****************************************************************/ 02350000
*   /*                                                               */ 02351000
*   /* ***********************************************       @Y30LB12*/ 02352000
*   /* IF THIS DASD CONTROLLER INTERFACES TO TWO DATA        @Y30LB12*/ 02353000
*   /* STAGERS, PUT THE LOWER DATA STAGER INTO               @Y30LB12*/ 02354000
*   /* THE FIRST INDEX.                                      @Y30LB12*/ 02355000
*   /* ***********************************************       @Y30LB12*/ 02356000
*   /*                                                               */ 02357000
*   /*****************************************************************/ 02358000
*                                                                  0541 02359000
*   IF DSINDEX2^=0                  /*                       @Y30LB12*/ 02360000
*     THEN                          /*                       @Y30LB12*/ 02361000
         LH    @05,DSINDEX2                                        0541 02362000
         LTR   @05,@05                                             0541 02363000
         BZ    @RF00541                                            0541 02364000
*     IF DSINDEX2<DSINDEX1          /*                       @Y30LB12*/ 02365000
*       THEN                        /*                       @Y30LB12*/ 02366000
         LH    @15,DSINDEX1                                        0542 02367000
         CR    @05,@15                                             0542 02368000
         BNL   @RF00542                                            0542 02369000
*       DO;                         /*                       @Y30LB12*/ 02370000
*         PHYSINDX=DSINDEX1;        /*                       @Y30LB12*/ 02371000
         STC   @15,PHYSINDX                                        0544 02372000
*         DSINDEX1=DSINDEX2;        /*                       @Y30LB12*/ 02373000
         STH   @05,DSINDEX1                                        0545 02374000
*         DSINDEX2=PHYSINDX;        /*                       @Y30LB12*/ 02375000
         STH   @15,DSINDEX2                                        0546 02376000
*       END;                        /*                       @Y30LB12*/ 02377000
*     ELSE                                                         0548 02378000
*       ;                           /*                       @Y30LB12*/ 02379000
@RF00542 DS    0H                                                  0549 02380000
*   ELSE                                                           0549 02381000
*     ;                             /*                       @Y30LB12*/ 02382000
*                                                                  0549 02383000
@RF00541 DS    0H                                                  0550 02384000
*   /*****************************************************************/ 02385000
*   /*                                                               */ 02386000
*   /* ***********************************************       @Y30LB12*/ 02387000
*   /* UPDATE PHYSTYPE FOR THE FIRST (LOWER NUMBERED)        @Y30LB12*/ 02388000
*   /* DATA STAGER                                           @Y30LB12*/ 02389000
*   /* ***********************************************       @Y30LB12*/ 02390000
*   /*                                                               */ 02391000
*   /*****************************************************************/ 02392000
*                                                                  0550 02393000
*   PHYSINDX=DSINDEX1;              /*                       @Y30LB12*/ 02394000
         MVC   PHYSINDX(1),DSINDEX1+1                              0550 02395000
*   CALL UPDAPHYS;                  /*                       @Y30LB12*/ 02396000
*                                                                  0551 02397000
         BAL   @14,UPDAPHYS                                        0551 02398000
*   /*****************************************************************/ 02399000
*   /*                                                               */ 02400000
*   /* ***********************************************       @Y30LB12*/ 02401000
*   /* IF A SECOND DATA STAGER INTERFACES TO THIS            @Y30LB12*/ 02402000
*   /* DASD CONTROLLER, UPDATE PHYSTYPE FOR THE              @Y30LB12*/ 02403000
*   /* DATA STAGER, AND PUT POINTER TO 'OTHER' DATA          @Y30LB12*/ 02404000
*   /* STAGER IN THE APPROPRIATE ENTRY OF DSPAIRS FOR        @Y30LB12*/ 02405000
*   /* BOTH DATA STAGERS.                                    @Y30LB12*/ 02406000
*   /* ***********************************************       @Y30LB12*/ 02407000
*   /*                                                               */ 02408000
*   /*****************************************************************/ 02409000
*                                                                  0552 02410000
*   IF DSINDEX2^=0                  /*                       @Y30LB12*/ 02411000
*     THEN                          /*                       @Y30LB12*/ 02412000
         LH    @05,DSINDEX2                                        0552 02413000
         LTR   @05,@05                                             0552 02414000
         BZ    @RF00552                                            0552 02415000
*     DO;                           /*                       @Y30LB12*/ 02416000
*       PHYSINDX=DSINDEX2;          /*                       @Y30LB12*/ 02417000
         STC   @05,PHYSINDX                                        0554 02418000
*       CALL UPDAPHYS;              /*                       @Y30LB12*/ 02419000
         BAL   @14,UPDAPHYS                                        0555 02420000
*       IF PHYSDS2(DSINDEX1,WORKCUA)='FF'X/*                 @Y30LB12*/ 02421000
*         THEN                      /*                       @Y30LB12*/ 02422000
         LH    @05,DSINDEX1                                        0556 02423000
         SLA   @05,2                                               0556 02424000
         MVC   @ZT00003+3(1),WORKCUA                               0556 02425000
         AL    @05,@ZT00003                                        0556 02426000
         ST    @05,@TF00001                                        0556 02427000
         ALR   @05,R4                                              0556 02428000
         CLI   PHYSDS2-5(@05),X'FF'                                0556 02429000
         BNE   @RF00556                                            0556 02430000
*         PHYSDS2(DSINDEX1,WORKCUA)=DSINDEX2-1;                    0557 02431000
         LH    @05,DSINDEX2                                        0557 02432000
         BCTR  @05,0                                               0557 02433000
         L     @01,@TF00001                                        0557 02434000
         STC   @05,PHYSDS2-5(@01,R4)                               0557 02435000
*       ELSE                        /*                       @Y30LB12*/ 02436000
*         IF PHYSDS2(DSINDEX1,WORKCUA)^=DSINDEX2-1 THEN/*    @Y30LB12*/ 02437000
         B     @RC00556                                            0558 02438000
@RF00556 LH    @05,DSINDEX1                                        0558 02439000
         SLA   @05,2                                               0558 02440000
         MVC   @ZT00003+3(1),WORKCUA                               0558 02441000
         AL    @05,@ZT00003                                        0558 02442000
         LH    @15,DSINDEX2                                        0558 02443000
         BCTR  @15,0                                               0558 02444000
         ALR   @05,R4                                              0558 02445000
         MVC   @ZT00003+3(1),PHYSDS2-5(@05)                        0558 02446000
         C     @15,@ZT00003                                        0558 02447000
         BE    @RF00558                                            0558 02448000
*           DO;                     /*                       @Y30LB12*/ 02449000
*                                                                  0559 02450000
*             /*******************************************************/ 02451000
*             /*                                                     */ 02452000
*             /* *******************************             @Y30LB12*/ 02453000
*             /* ICG246I DASD CONTROLLER                     @Y30LB12*/ 02454000
*             /* PREVIOUSLY SPECIFIED WITH                   @Y30LB12*/ 02455000
*             /* ONE MATCHING SA                             @Y30LB12*/ 02456000
*             /* *******************************             @Y30LB12*/ 02457000
*             /*                                                     */ 02458000
*             /*******************************************************/ 02459000
*                                                                  0560 02460000
*             MSGNO=ICG246I;        /*                       @Y30LB12*/ 02461000
         MVC   MSGNO(2,R4),ICG246I                                 0560 02462000
*             CALL PUTIT2;          /*                       @Y30LB12*/ 02463000
         BAL   @14,PUTIT2                                          0561 02464000
*           END;                    /*                       @Y30LB12*/ 02465000
*         ELSE                                                     0563 02466000
*           ;                       /*                       @Y30LB12*/ 02467000
@RF00558 DS    0H                                                  0564 02468000
*       IF PHYSDS2(DSINDEX2,WORKCUA)='FF'X/*                 @Y30LB12*/ 02469000
*         THEN                      /*                       @Y30LB12*/ 02470000
@RC00556 LH    @05,DSINDEX2                                        0564 02471000
         SLA   @05,2                                               0564 02472000
         MVC   @ZT00003+3(1),WORKCUA                               0564 02473000
         AL    @05,@ZT00003                                        0564 02474000
         ST    @05,@TF00001                                        0564 02475000
         ALR   @05,R4                                              0564 02476000
         CLI   PHYSDS2-5(@05),X'FF'                                0564 02477000
         BNE   @RF00564                                            0564 02478000
*         PHYSDS2(DSINDEX2,WORKCUA)=DSINDEX1-1;                    0565 02479000
         LH    @05,DSINDEX1                                        0565 02480000
         BCTR  @05,0                                               0565 02481000
         L     @01,@TF00001                                        0565 02482000
         STC   @05,PHYSDS2-5(@01,R4)                               0565 02483000
*       ELSE                        /*                       @Y30LB12*/ 02484000
*         IF PHYSDS2(DSINDEX2,WORKCUA)^=DSINDEX1-1 THEN/*    @Y30LB12*/ 02485000
         B     @RC00564                                            0566 02486000
@RF00564 LH    @05,DSINDEX2                                        0566 02487000
         SLA   @05,2                                               0566 02488000
         MVC   @ZT00003+3(1),WORKCUA                               0566 02489000
         AL    @05,@ZT00003                                        0566 02490000
         LH    @15,DSINDEX1                                        0566 02491000
         BCTR  @15,0                                               0566 02492000
         ALR   @05,R4                                              0566 02493000
         MVC   @ZT00003+3(1),PHYSDS2-5(@05)                        0566 02494000
         C     @15,@ZT00003                                        0566 02495000
         BE    @RF00566                                            0566 02496000
*           DO;                     /*                       @Y30LB12*/ 02497000
*                                                                  0567 02498000
*             /*******************************************************/ 02499000
*             /*                                                     */ 02500000
*             /* *******************************             @Y30LB12*/ 02501000
*             /* ICG246I DASD CONTROLLER                     @Y30LB12*/ 02502000
*             /* PREVIOUSLY SPECIFIED WITH                   @Y30LB12*/ 02503000
*             /* ONE MATCHING SA                             @Y30LB12*/ 02504000
*             /* *******************************             @Y30LB12*/ 02505000
*             /*                                                     */ 02506000
*             /*******************************************************/ 02507000
*                                                                  0568 02508000
*             MSGNO=ICG246I;        /*                       @Y30LB12*/ 02509000
         MVC   MSGNO(2,R4),ICG246I                                 0568 02510000
*             CALL PUTIT2;          /*                       @Y30LB12*/ 02511000
         BAL   @14,PUTIT2                                          0569 02512000
*           END;                    /*                       @Y30LB12*/ 02513000
*         ELSE                                                     0571 02514000
*           ;                       /*                       @Y30LB12*/ 02515000
@RF00566 DS    0H                                                  0572 02516000
*     END;                          /*                       @Y30LB12*/ 02517000
*   ELSE                            /*                       @Y30LB12*/ 02518000
*                                                                  0573 02519000
*     /***************************************************************/ 02520000
*     /*                                                             */ 02521000
*     /* *******************************************         @Y30LB12*/ 02522000
*     /* IF TWO CONTROLLERS IN PREVIOUS STATEMENT            @Y30LB12*/ 02523000
*     /* BUT ONLY ONE IS CURRENT STATEMENT TO SAME           @Y30LB12*/ 02524000
*     /* DASD CONTROLLER, WRITE ERROR MESSAGE                @Y30LB12*/ 02525000
*     /* *******************************************         @Y30LB12*/ 02526000
*     /*                                                             */ 02527000
*     /***************************************************************/ 02528000
*                                                                  0573 02529000
*     IF PHYSDS2(DSINDEX1,WORKCUA)^='FF'X/*                  @Y30LB12*/ 02530000
*       THEN                        /*                       @Y30LB12*/ 02531000
         B     @RC00552                                            0573 02532000
@RF00552 LH    @05,DSINDEX1                                        0573 02533000
         SLA   @05,2                                               0573 02534000
         MVC   @ZT00003+3(1),WORKCUA                               0573 02535000
         AL    @05,@ZT00003                                        0573 02536000
         ALR   @05,R4                                              0573 02537000
         CLI   PHYSDS2-5(@05),X'FF'                                0573 02538000
         BE    @RF00573                                            0573 02539000
*       DO;                         /*                       @Y30LB12*/ 02540000
*                                                                  0574 02541000
*         /***********************************************************/ 02542000
*         /*                                                         */ 02543000
*         /* *************************************           @Y30LB12*/ 02544000
*         /* ICG246I DASD CONTROLLER PREVIOUSLY              @Y30LB12*/ 02545000
*         /* SPECIFIED WITH ONE MATCHING SA                  @Y30LB12*/ 02546000
*         /* *************************************           @Y30LB12*/ 02547000
*         /*                                                         */ 02548000
*         /***********************************************************/ 02549000
*                                                                  0575 02550000
*         MSGNO=ICG246I;            /*                       @Y30LB12*/ 02551000
         MVC   MSGNO(2,R4),ICG246I                                 0575 02552000
*         CALL PUTIT2;              /*                       @Y30LB12*/ 02553000
         BAL   @14,PUTIT2                                          0576 02554000
*       END;                        /*                       @Y30LB12*/ 02555000
*     ELSE                                                         0578 02556000
*       ;                           /*                       @Y30LB12*/ 02557000
*                                                                  0578 02558000
@RF00573 DS    0H                                                  0579 02559000
*   /*****************************************************************/ 02560000
*   /*                                                               */ 02561000
*   /* ***********************************************       @Y30LB12*/ 02562000
*   /* CALL PROCEDURE TO UPDATE PABTABLE FOR DASD            @Y30LB12*/ 02563000
*   /* DEVICES THAT HAVE AN SSID                             @Y30LB12*/ 02564000
*   /* ***********************************************       @Y30LB12*/ 02565000
*   /*                                                               */ 02566000
*   /*****************************************************************/ 02567000
*                                                                  0579 02568000
*   CALL UPDATPAB;                  /*                       @Y30LB12*/ 02569000
@RC00552 BAL   @14,UPDATPAB                                        0579 02570000
*   END S09BUILD;                   /* RET. TO MAINLINE      @Y30LB12*/ 02571000
@EL00018 DS    0H                                                  0580 02572000
@EF00018 DS    0H                                                  0580 02573000
@ER00018 LM    @14,@12,@SA00018                                    0580 02574000
         BR    @14                                                 0580 02575000
*                                                                  0581 02576000
*/********************************************************** @Y30LB12*/ 02577000
*/*                                                          @Y30LB12*/ 02578000
*/* PROCEDURE NAME - UPDAPHYS                                @Y30LB12*/ 02579000
*/*                                                          @Y30LB12*/ 02580000
*/* FUNCTION - UPDATE THE STRUCTURE PHYSTYPE FOR EITHER THE  @Y30LB12*/ 02581000
*/*            FIRST DATA STAGER OR THE SECOND DATA STAGER,  @Y30LB12*/ 02582000
*/*            DEPENDING ON THE VALUE PASSED TO THIS         @Y30LB12*/ 02583000
*/*            PROCEDURE IN PHYSINDX.                        @Y30LB12*/ 02584000
*/*                                                          @Y30LB12*/ 02585000
*/********************************************************** @Y30LB12*/ 02586000
*                                                                  0581 02587000
*UPDAPHYS:                                                         0581 02588000
*   PROCEDURE;                      /*                       @Y30LB12*/ 02589000
UPDAPHYS STM   @14,@12,@SA00019                                    0581 02590000
*   DO I=1 TO 8;                    /*                       @Y30LB12*/ 02591000
         LA    I,1                                                 0582 02592000
@DL00582 DS    0H                                                  0583 02593000
*     IF HAVEDEV(I)='1'B            /*                       @Y30LB12*/ 02594000
*       THEN                        /*                       @Y30LB12*/ 02595000
         LR    @05,I                                               0583 02596000
         SLA   @05,2                                               0583 02597000
         LA    @03,HAVEDEV-4(@05)                                  0583 02598000
         TM    0(@03),B'10000000'                                  0583 02599000
         BNO   @RF00583                                            0583 02600000
*       IF MERLICEB(PHYSINDX,WORKCUA,I)='00'B/*              @Y30LB12*/ 02601000
*         THEN                      /*                       @Y30LB12*/ 02602000
         SLR   @03,@03                                             0584 02603000
         IC    @03,PHYSINDX                                        0584 02604000
         SLA   @03,2                                               0584 02605000
         MVC   @ZT00003+3(1),WORKCUA                               0584 02606000
         AL    @03,@ZT00003                                        0584 02607000
         SLA   @03,3                                               0584 02608000
         ALR   @03,I                                               0584 02609000
         ALR   @03,@03                                             0584 02610000
         ST    @03,@TF00001                                        0584 02611000
         ALR   @03,R4                                              0584 02612000
         TM    MERLICEB-82(@03),B'11000000'                        0584 02613000
         BNZ   @RF00584                                            0584 02614000
*         DO;                       /*                       @Y30LB12*/ 02615000
*           IF REALTYPE(I)=PHYSFMER /*                       @X50RSPC*/ 02616000
*             THEN                  /*                       @X50RSPC*/ 02617000
         LA    @03,REALTYPE-4(@05)                                 0586 02618000
         TM    0(@03),B'00000100'                                  0586 02619000
         BNO   @RF00586                                            0586 02620000
         TM    0(@03),B'00000010'                                  0586 02621000
         BNZ   @RF00586                                            0586 02622000
*             MERLICEB(PHYSINDX,WORKCUA,I)=PHYSFMER;               0587 02623000
         LR    @05,R4                                              0587 02624000
         AL    @05,@TF00001                                        0587 02625000
         NI    MERLICEB-82(@05),B'10111111'                        0587 02626000
         OI    MERLICEB-82(@05),B'10000000'                        0587 02627000
*           ELSE                    /*                       @X50RSPC*/ 02628000
*             IF REALTYPE(I)=PHYSFICE/*                      @X50RSPC*/ 02629000
*               THEN                /*                       @X50RSPC*/ 02630000
         B     @RC00586                                            0588 02631000
@RF00586 LR    @05,I                                               0588 02632000
         SLA   @05,2                                               0588 02633000
         LA    @03,REALTYPE-4(@05)                                 0588 02634000
         TM    0(@03),B'00000010'                                  0588 02635000
         BNO   @RF00588                                            0588 02636000
         TM    0(@03),B'00000100'                                  0588 02637000
         BNZ   @RF00588                                            0588 02638000
*               MERLICEB(PHYSINDX,WORKCUA,I)=PHYSFICE;             0589 02639000
         SLR   @05,@05                                             0589 02640000
         IC    @05,PHYSINDX                                        0589 02641000
         SLA   @05,2                                               0589 02642000
         MVC   @ZT00003+3(1),WORKCUA                               0589 02643000
         AL    @05,@ZT00003                                        0589 02644000
         SLA   @05,3                                               0589 02645000
         ALR   @05,I                                               0589 02646000
         ALR   @05,@05                                             0589 02647000
         ALR   @05,R4                                              0589 02648000
         NI    MERLICEB-82(@05),B'01111111'                        0589 02649000
         OI    MERLICEB-82(@05),B'01000000'                        0589 02650000
*             ELSE                  /*                       @X50RSPC*/ 02651000
*               MERLICEB(PHYSINDX,WORKCUA,I)=PHYSFMAD;/*     @X50RSPC*/ 02652000
         B     @RC00588                                            0590 02653000
@RF00588 SLR   @05,@05                                             0590 02654000
         IC    @05,PHYSINDX                                        0590 02655000
         SLA   @05,2                                               0590 02656000
         MVC   @ZT00003+3(1),WORKCUA                               0590 02657000
         AL    @05,@ZT00003                                        0590 02658000
         SLA   @05,3                                               0590 02659000
         ALR   @05,I                                               0590 02660000
         ALR   @05,@05                                             0590 02661000
         ALR   @05,R4                                              0590 02662000
         OI    MERLICEB-82(@05),B'11000000'                        0590 02663000
*           IF REALSPEC(I)='1'B     /*                       @Y30LB12*/ 02664000
*             THEN                  /*                       @Y30LB12*/ 02665000
@RC00588 DS    0H                                                  0591 02666000
@RC00586 LR    @05,I                                               0591 02667000
         SLA   @05,2                                               0591 02668000
         LA    @03,REALSPEC-4(@05)                                 0591 02669000
         TM    0(@03),B'01000000'                                  0591 02670000
         BNO   @RF00591                                            0591 02671000
*             PHYSREAL(PHYSINDX,WORKCUA,I)='1'B;                   0592 02672000
         SLR   @05,@05                                             0592 02673000
         IC    @05,PHYSINDX                                        0592 02674000
         SLA   @05,2                                               0592 02675000
         MVC   @ZT00003+3(1),WORKCUA                               0592 02676000
         AL    @05,@ZT00003                                        0592 02677000
         SLA   @05,3                                               0592 02678000
         ALR   @05,I                                               0592 02679000
         ALR   @05,@05                                             0592 02680000
         ALR   @05,R4                                              0592 02681000
         OI    PHYSREAL-82(@05),B'00100000'                        0592 02682000
*           ELSE                    /*                       @Y30LB12*/ 02683000
*             DO;                   /*                       @Y30LB12*/ 02684000
         B     @RC00591                                            0593 02685000
@RF00591 DS    0H                                                  0594 02686000
*               PHYSSSID(PHYSINDX,WORKCUA,I)='1'B;                 0594 02687000
         SLR   @05,@05                                             0594 02688000
         IC    @05,PHYSINDX                                        0594 02689000
         SLA   @05,2                                               0594 02690000
         MVC   @ZT00003+3(1),WORKCUA                               0594 02691000
         AL    @05,@ZT00003                                        0594 02692000
         SLA   @05,3                                               0594 02693000
         ALR   @05,I                                               0594 02694000
         ALR   @05,@05                                             0594 02695000
         ST    @05,@TF00001                                        0594 02696000
         ALR   @05,R4                                              0594 02697000
         OI    PHYSSSID-82(@05),B'00010000'                        0594 02698000
*               IF ABOX1(I)='1'B    /*                       @Y30LB12*/ 02699000
*                 THEN              /*                       @Y30LB12*/ 02700000
         LR    @05,I                                               0595 02701000
         SLA   @05,2                                               0595 02702000
         LA    @03,ABOX1-4(@05)                                    0595 02703000
         TM    0(@03),B'00001000'                                  0595 02704000
         BNO   @RF00595                                            0595 02705000
*                 LOGABOX1(PHYSINDX,WORKCUA,I)='1'B;               0596 02706000
         LR    @05,R4                                              0596 02707000
         AL    @05,@TF00001                                        0596 02708000
         OI    LOGABOX1-82(@05),B'00001000'                        0596 02709000
*               ELSE                                               0597 02710000
*                 ;                 /*                       @Y30LB12*/ 02711000
@RF00595 DS    0H                                                  0598 02712000
*               WORKDEV=WKLOGDEV(I);/*                       @Y30LB12*/ 02713000
         LR    @05,I                                               0598 02714000
         SLA   @05,2                                               0598 02715000
         SLR   @03,@03                                             0598 02716000
         IC    @03,WKLOGDEV-4(@05)                                 0598 02717000
         STC   @03,WORKDEV                                         0598 02718000
*               IF WORKDEV='00'X    /*                       @Y30LB12*/ 02719000
*                 THEN              /*                       @Y30LB12*/ 02720000
         CLI   WORKDEV,0                                           0599 02721000
         BNE   @RF00599                                            0599 02722000
*                 LGDEVICE(PHYSINDX,WORKCUA,I)='000'B;             0600 02723000
         SLR   @05,@05                                             0600 02724000
         IC    @05,PHYSINDX                                        0600 02725000
         SLA   @05,2                                               0600 02726000
         MVC   @ZT00003+3(1),WORKCUA                               0600 02727000
         AL    @05,@ZT00003                                        0600 02728000
         SLA   @05,3                                               0600 02729000
         ALR   @05,I                                               0600 02730000
         ALR   @05,@05                                             0600 02731000
         ALR   @05,R4                                              0600 02732000
         NI    LGDEVICE-82(@05),B'11111000'                        0600 02733000
*               ELSE                                               0601 02734000
*                 ;                 /*                       @Y30LB12*/ 02735000
@RF00599 DS    0H                                                  0602 02736000
*               IF WORKDEV='01'X    /*                       @Y30LB12*/ 02737000
*                 THEN              /*                       @Y30LB12*/ 02738000
         CLI   WORKDEV,1                                           0602 02739000
         BNE   @RF00602                                            0602 02740000
*                 LGDEVICE(PHYSINDX,WORKCUA,I)='001'B;             0603 02741000
         SLR   @05,@05                                             0603 02742000
         IC    @05,PHYSINDX                                        0603 02743000
         SLA   @05,2                                               0603 02744000
         MVC   @ZT00003+3(1),WORKCUA                               0603 02745000
         AL    @05,@ZT00003                                        0603 02746000
         SLA   @05,3                                               0603 02747000
         ALR   @05,I                                               0603 02748000
         ALR   @05,@05                                             0603 02749000
         ALR   @05,R4                                              0603 02750000
         NI    LGDEVICE-82(@05),B'11111001'                        0603 02751000
         OI    LGDEVICE-82(@05),B'00000001'                        0603 02752000
*               ELSE                                               0604 02753000
*                 ;                 /*                       @Y30LB12*/ 02754000
@RF00602 DS    0H                                                  0605 02755000
*               IF WORKDEV='02'X    /*                       @Y30LB12*/ 02756000
*                 THEN              /*                       @Y30LB12*/ 02757000
         CLI   WORKDEV,2                                           0605 02758000
         BNE   @RF00605                                            0605 02759000
*                 LGDEVICE(PHYSINDX,WORKCUA,I)='010'B;             0606 02760000
         SLR   @05,@05                                             0606 02761000
         IC    @05,PHYSINDX                                        0606 02762000
         SLA   @05,2                                               0606 02763000
         MVC   @ZT00003+3(1),WORKCUA                               0606 02764000
         AL    @05,@ZT00003                                        0606 02765000
         SLA   @05,3                                               0606 02766000
         ALR   @05,I                                               0606 02767000
         ALR   @05,@05                                             0606 02768000
         ALR   @05,R4                                              0606 02769000
         NI    LGDEVICE-82(@05),B'11111010'                        0606 02770000
         OI    LGDEVICE-82(@05),B'00000010'                        0606 02771000
*               ELSE                                               0607 02772000
*                 ;                 /*                       @Y30LB12*/ 02773000
@RF00605 DS    0H                                                  0608 02774000
*               IF WORKDEV='03'X    /*                       @Y30LB12*/ 02775000
*                 THEN              /*                       @Y30LB12*/ 02776000
         CLI   WORKDEV,3                                           0608 02777000
         BNE   @RF00608                                            0608 02778000
*                 LGDEVICE(PHYSINDX,WORKCUA,I)='011'B;             0609 02779000
         SLR   @05,@05                                             0609 02780000
         IC    @05,PHYSINDX                                        0609 02781000
         SLA   @05,2                                               0609 02782000
         MVC   @ZT00003+3(1),WORKCUA                               0609 02783000
         AL    @05,@ZT00003                                        0609 02784000
         SLA   @05,3                                               0609 02785000
         ALR   @05,I                                               0609 02786000
         ALR   @05,@05                                             0609 02787000
         ALR   @05,R4                                              0609 02788000
         NI    LGDEVICE-82(@05),B'11111011'                        0609 02789000
         OI    LGDEVICE-82(@05),B'00000011'                        0609 02790000
*               ELSE                                               0610 02791000
*                 ;                 /*                       @Y30LB12*/ 02792000
@RF00608 DS    0H                                                  0611 02793000
*               IF WORKDEV='04'X    /*                       @Y30LB12*/ 02794000
*                 THEN              /*                       @Y30LB12*/ 02795000
         CLI   WORKDEV,4                                           0611 02796000
         BNE   @RF00611                                            0611 02797000
*                 LGDEVICE(PHYSINDX,WORKCUA,I)='100'B;             0612 02798000
         SLR   @05,@05                                             0612 02799000
         IC    @05,PHYSINDX                                        0612 02800000
         SLA   @05,2                                               0612 02801000
         MVC   @ZT00003+3(1),WORKCUA                               0612 02802000
         AL    @05,@ZT00003                                        0612 02803000
         SLA   @05,3                                               0612 02804000
         ALR   @05,I                                               0612 02805000
         ALR   @05,@05                                             0612 02806000
         ALR   @05,R4                                              0612 02807000
         NI    LGDEVICE-82(@05),B'11111100'                        0612 02808000
         OI    LGDEVICE-82(@05),B'00000100'                        0612 02809000
*               ELSE                                               0613 02810000
*                 ;                 /*                       @Y30LB12*/ 02811000
@RF00611 DS    0H                                                  0614 02812000
*               IF WORKDEV='05'X    /*                       @Y30LB12*/ 02813000
*                 THEN              /*                       @Y30LB12*/ 02814000
         CLI   WORKDEV,5                                           0614 02815000
         BNE   @RF00614                                            0614 02816000
*                 LGDEVICE(PHYSINDX,WORKCUA,I)='101'B;             0615 02817000
         SLR   @05,@05                                             0615 02818000
         IC    @05,PHYSINDX                                        0615 02819000
         SLA   @05,2                                               0615 02820000
         MVC   @ZT00003+3(1),WORKCUA                               0615 02821000
         AL    @05,@ZT00003                                        0615 02822000
         SLA   @05,3                                               0615 02823000
         ALR   @05,I                                               0615 02824000
         ALR   @05,@05                                             0615 02825000
         ALR   @05,R4                                              0615 02826000
         NI    LGDEVICE-82(@05),B'11111101'                        0615 02827000
         OI    LGDEVICE-82(@05),B'00000101'                        0615 02828000
*               ELSE                                               0616 02829000
*                 ;                 /*                       @Y30LB12*/ 02830000
@RF00614 DS    0H                                                  0617 02831000
*               IF WORKDEV='06'X    /*                       @Y30LB12*/ 02832000
*                 THEN              /*                       @Y30LB12*/ 02833000
         CLI   WORKDEV,6                                           0617 02834000
         BNE   @RF00617                                            0617 02835000
*                 LGDEVICE(PHYSINDX,WORKCUA,I)='110'B;             0618 02836000
         SLR   @05,@05                                             0618 02837000
         IC    @05,PHYSINDX                                        0618 02838000
         SLA   @05,2                                               0618 02839000
         MVC   @ZT00003+3(1),WORKCUA                               0618 02840000
         AL    @05,@ZT00003                                        0618 02841000
         SLA   @05,3                                               0618 02842000
         ALR   @05,I                                               0618 02843000
         ALR   @05,@05                                             0618 02844000
         ALR   @05,R4                                              0618 02845000
         NI    LGDEVICE-82(@05),B'11111110'                        0618 02846000
         OI    LGDEVICE-82(@05),B'00000110'                        0618 02847000
*               ELSE                                               0619 02848000
*                 ;                 /*                       @Y30LB12*/ 02849000
@RF00617 DS    0H                                                  0620 02850000
*               IF WORKDEV='07'X    /*                       @Y30LB12*/ 02851000
*                 THEN              /*                       @Y30LB12*/ 02852000
         CLI   WORKDEV,7                                           0620 02853000
         BNE   @RF00620                                            0620 02854000
*                 LGDEVICE(PHYSINDX,WORKCUA,I)='111'B;             0621 02855000
         SLR   @05,@05                                             0621 02856000
         IC    @05,PHYSINDX                                        0621 02857000
         SLA   @05,2                                               0621 02858000
         MVC   @ZT00003+3(1),WORKCUA                               0621 02859000
         AL    @05,@ZT00003                                        0621 02860000
         SLA   @05,3                                               0621 02861000
         ALR   @05,I                                               0621 02862000
         ALR   @05,@05                                             0621 02863000
         ALR   @05,R4                                              0621 02864000
         OI    LGDEVICE-82(@05),B'00000111'                        0621 02865000
*               ELSE                                               0622 02866000
*                 ;                 /*                       @Y30LB12*/ 02867000
@RF00620 DS    0H                                                  0623 02868000
*               SPNRSGNO(PHYSINDX,WORKCUA,I)=WORKRSG(I)-1;         0623 02869000
         SLR   @05,@05                                             0623 02870000
         IC    @05,PHYSINDX                                        0623 02871000
         SLA   @05,2                                               0623 02872000
         MVC   @ZT00003+3(1),WORKCUA                               0623 02873000
         AL    @05,@ZT00003                                        0623 02874000
         SLA   @05,3                                               0623 02875000
         ALR   @05,I                                               0623 02876000
         ALR   @05,@05                                             0623 02877000
         LR    @03,I                                               0623 02878000
         SLA   @03,2                                               0623 02879000
         SLR   @15,@15                                             0623 02880000
         IC    @15,WORKRSG-4(@03)                                  0623 02881000
         BCTR  @15,0                                               0623 02882000
         STC   @15,SPNRSGNO-82(@05,R4)                             0623 02883000
*             END;                  /*                       @Y30LB12*/ 02884000
*         END;                      /*                       @Y30LB12*/ 02885000
*       ELSE                        /*                       @Y30LB12*/ 02886000
*         DO;                       /*                       @Y30LB12*/ 02887000
*                                                                  0626 02888000
         B     @RC00584                                            0626 02889000
@RF00584 DS    0H                                                  0627 02890000
*           /*********************************************************/ 02891000
*           /*                                                       */ 02892000
*           /* *************************************         @Y30LB12*/ 02893000
*           /* ICG244I PHYSICAL DEVICE X PREVIOUSLY          @Y30LB12*/ 02894000
*           /* SPECIFIED                                     @Y30LB12*/ 02895000
*           /* *************************************         @Y30LB12*/ 02896000
*           /*                                                       */ 02897000
*           /*********************************************************/ 02898000
*                                                                  0627 02899000
*           OUTBUF2(1:47)=ICGDS244; /*                       @Y30LB12*/ 02900000
         MVC   OUTBUF2(47,R4),ICGDS244                             0627 02901000
*           OUTBUF2(26)=PATTERN(I); /*                       @Y30LB12*/ 02902000
         LA    @05,PATTERN-1(I)                                    0628 02903000
         MVC   OUTBUF2+25(1,R4),0(@05)                             0628 02904000
*           CALL PUTIT1;            /*                       @Y30LB12*/ 02905000
         BAL   @14,PUTIT1                                          0629 02906000
*         END;                      /*                       @Y30LB12*/ 02907000
*     ELSE                                                         0631 02908000
*       ;                           /*                       @Y30LB12*/ 02909000
@RF00583 DS    0H                                                  0632 02910000
*   END;                            /*                       @Y30LB12*/ 02911000
@RC00583 AH    I,@CH00044                                          0632 02912000
         CH    I,@CH00042                                          0632 02913000
         BNH   @DL00582                                            0632 02914000
*   END UPDAPHYS;                   /*                       @Y30LB12*/ 02915000
@EL00019 DS    0H                                                  0633 02916000
@EF00019 DS    0H                                                  0633 02917000
@ER00019 LM    @14,@12,@SA00019                                    0633 02918000
         BR    @14                                                 0633 02919000
*                                                                  0634 02920000
*/********************************************************** @Y30LB12*/ 02921000
*/*                                                          @Y30LB12*/ 02922000
*/* PROCEDURE NAME - UPDATPAB                                @Y30LB12*/ 02923000
*/*                                                          @Y30LB12*/ 02924000
*/* FUNCTION - FOR SPINDLES THAT HAVE SUBSYSTEM              @Y30LB12*/ 02925000
*/*            IDENTIFICATION (SSID), UPDATE THE PABTABLE    @Y30LB12*/ 02926000
*/*            TO INDICATE THAT THE SPINDLE EXISTS, AND      @Y30LB12*/ 02927000
*/*            WHETHER OR NOT IT IS A 3330 MODEL 11 (FIRST   @Y30LB12*/ 02928000
*/*            OR SECOND HALF).  PUT THE PHYSICAL ADDRESS    @Y30LB12*/ 02929000
*/*            (DASD CONTROLLER AND PHYSICAL DEVICE) INTO    @Y30LB12*/ 02930000
*/*            PABAADDD.                                     @Y30LB12*/ 02931000
*/*                                                          @Y30LB12*/ 02932000
*/*            CHECK TO BE SURE THAT THE LOGICAL A-BOX       @Y30LB12*/ 02933000
*/*            SPECIFIED FOR THIS STAGING DASD GROUP DOES    @Y30LB12*/ 02934000
*/*            NOT CONFLICT WITH A PREVIOUS SPECIFICATION    @Y30LB12*/ 02935000
*/*            BY CHECKING AND UPDATING THE 'RSGABOX' BITS   @Y30LB12*/ 02936000
*/*            IN THE STRUCTURE BUILDRSG.                    @Y30LB12*/ 02937000
*/*                                                          @Y30LB12*/ 02938000
*/*            ALSO CHECK TO BE SURE THAT NO MORE THAN TWO   @Y30LB12*/ 02939000
*/*            DIFFERENT DATA STAGERS INTERFACE TO THIS      @Y30LB12*/ 02940000
*/*            STAGING DATA GROUP                            @YD00113*/ 02941000
*/*                                                          @Y30LB12*/ 02942000
*/********************************************************** @Y30LB12*/ 02943000
*                                                                  0634 02944000
*UPDATPAB:                                                         0634 02945000
*   PROCEDURE;                      /*                       @Y30LB12*/ 02946000
UPDATPAB STM   @14,@12,@SA00020                                    0634 02947000
*   DO I=1 TO 8;                    /*                       @Y30LB12*/ 02948000
         LA    I,1                                                 0635 02949000
@DL00635 DS    0H                                                  0636 02950000
*     IF SSIDSPEC(I)='1'B           /*                       @Y30LB12*/ 02951000
*       THEN                        /*                       @Y30LB12*/ 02952000
         LR    @05,I                                               0636 02953000
         SLA   @05,2                                               0636 02954000
         LA    @03,SSIDSPEC-4(@05)                                 0636 02955000
         TM    0(@03),B'00100000'                                  0636 02956000
         BNO   @RF00636                                            0636 02957000
*       DO;                         /*                       @Y30LB12*/ 02958000
*         RSGINDEX=WORKRSG(I);      /*                       @Y30LB12*/ 02959000
*                                                                  0638 02960000
         SLR   @03,@03                                             0638 02961000
         IC    @03,WORKRSG-4(@05)                                  0638 02962000
         STH   @03,RSGINDEX                                        0638 02963000
*         /***********************************************************/ 02964000
*         /*                                                         */ 02965000
*         /* *****************************************       @Y30LB12*/ 02966000
*         /* VERIFY THAT THERE IS NO MIS-MATCH ON            @Y30LB12*/ 02967000
*         /* LOGICAL A-BOX AND UPDATE A-BOX IN               @Y30LB12*/ 02968000
*         /* BUILDRSG                                        @Y30LB12*/ 02969000
*         /* *****************************************       @Y30LB12*/ 02970000
*         /*                                                         */ 02971000
*         /***********************************************************/ 02972000
*                                                                  0639 02973000
*         CALL CHKABOX;             /*                       @Y30LB12*/ 02974000
*                                                                  0639 02975000
         BAL   @14,CHKABOX                                         0639 02976000
*         /***********************************************************/ 02977000
*         /*                                                         */ 02978000
*         /* *****************************************       @Y30LB12*/ 02979000
*         /* IF TWO DATA STAGERS INTERFACE TO THE            @Y30LB12*/ 02980000
*         /* RSG, THEY MUST BOTH HAVE ACCESS TO ALL          @Y30LB12*/ 02981000
*         /* THE SAME SPINDLES IN COMMON.                    @Y30LB12*/ 02982000
*         /* *****************************************       @Y30LB12*/ 02983000
*         /*                                                         */ 02984000
*         /***********************************************************/ 02985000
*                                                                  0640 02986000
*         CALL CHECKRSG;            /*                       @Y30LB12*/ 02987000
*                                                                  0640 02988000
         BAL   @14,CHECKRSG                                        0640 02989000
*         /***********************************************************/ 02990000
*         /*                                                         */ 02991000
*         /* *****************************************       @Y30LB12*/ 02992000
*         /* IF THE LOGICAL DEVICE HAS NOT BEEN              @Y30LB12*/ 02993000
*         /* PREVIOUSLY SPECIFIED, UPDATE THE FLAGS          @Y30LB12*/ 02994000
*         /* PABEXIST (ALWAYS) AND PABIBERG AND              @Y30LB12*/ 02995000
*         /* PABBERG2 AS APPROPRIATE. ALSO INSERT            @Y30LB12*/ 02996000
*         /* THE REAL DASD CONTROLLER AND DEVICE             @Y30LB12*/ 02997000
*         /* ADDRESS INTO PABAADDD. IF THE DEVICE            @Y30LB12*/ 02998000
*         /* WAS SPECIFIED BEFORE, WRITE ERROR               @Y30LB12*/ 02999000
*         /* MESSAGE ICGDS242                                @Y30LB12*/ 03000000
*         /* *****************************************       @Y30LB12*/ 03001000
*         /*                                                         */ 03002000
*         /***********************************************************/ 03003000
*                                                                  0641 03004000
*         CALL DODEVTBL;            /*                       @Y30LB12*/ 03005000
         BAL   @14,DODEVTBL                                        0641 03006000
*       END;                        /*                       @Y30LB12*/ 03007000
*   END;                            /*                       @Y30LB12*/ 03008000
@RF00636 AH    I,@CH00044                                          0643 03009000
         CH    I,@CH00042                                          0643 03010000
         BNH   @DL00635                                            0643 03011000
*   END UPDATPAB;                   /*                       @Y30LB12*/ 03012000
@EL00020 DS    0H                                                  0644 03013000
@EF00020 DS    0H                                                  0644 03014000
@ER00020 LM    @14,@12,@SA00020                                    0644 03015000
         BR    @14                                                 0644 03016000
*                                                                  0645 03017000
*/********************************************************** @Y30LB12*/ 03018000
*/*                                                          @Y30LB12*/ 03019000
*/* PROCEDURE NAME - CHKABOX                                 @Y30LB12*/ 03020000
*/*                                                          @Y30LB12*/ 03021000
*/* FUNCTION - VERIFY THAT THE LOGICAL A-BOX FOR THIS        @Y30LB12*/ 03022000
*/*            STAGING SPINDLE IS THE SAME AS FOR ALL OTHER  @Y30LB12*/ 03023000
*/*            STAGING SPINDLES IN THIS STAGING DASD GROUP.  @Y30LB12*/ 03024000
*/*            IF THIS IS THE FIRST SPINDLE SPECIFIED FOR    @Y30LB12*/ 03025000
*/*            THE STAGING DASD GROUP, UPDATE EITHER         @Y30LB12*/ 03026000
*/*            RSGABOX0 OR RSGABOX1, DEPENDING ON THE        @Y30LB12*/ 03027000
*/*            LOGICAL CONTROL UNIT SPECIFIED.               @Y30LB12*/ 03028000
*/*                                                          @Y30LB12*/ 03029000
*/********************************************************** @Y30LB12*/ 03030000
*                                                                  0645 03031000
*CHKABOX:                                                          0645 03032000
*   PROCEDURE;                      /*                       @Y30LB12*/ 03033000
CHKABOX  STM   @14,@12,@SA00021                                    0645 03034000
*   IF ABOX1(I)='1'B                /*                       @Y30LB12*/ 03035000
*     THEN                          /*                       @Y30LB12*/ 03036000
         LR    @05,I                                               0646 03037000
         SLA   @05,2                                               0646 03038000
         LA    @03,ABOX1-4(@05)                                    0646 03039000
         TM    0(@03),B'00001000'                                  0646 03040000
         BNO   @RF00646                                            0646 03041000
*     IF RSGABOX0(RSGINDEX)='1'B    /*                       @Y30LB12*/ 03042000
*       THEN                        /*                       @Y30LB12*/ 03043000
         LH    @05,RSGINDEX                                        0647 03044000
         MH    @05,@CH00114                                        0647 03045000
         ALR   @05,R4                                              0647 03046000
         TM    RSGABOX0-9(@05),B'01000000'                         0647 03047000
         BNO   @RF00647                                            0647 03048000
*       DO;                         /*                       @Y30LB12*/ 03049000
*                                                                  0648 03050000
*         /***********************************************************/ 03051000
*         /*                                                         */ 03052000
*         /* *************************************           @Y30LB12*/ 03053000
*         /* ICG245I SDG FOR DEV X PREVIOUSLY                @Y30LB12*/ 03054000
*         /* SPECIFIED WITH DIFFERENT LCU                    @Y30LB12*/ 03055000
*         /* *************************************           @Y30LB12*/ 03056000
*         /*                                                         */ 03057000
*         /***********************************************************/ 03058000
*                                                                  0649 03059000
*         OUTBUF2(1:62)=ICGDS245;   /*                       @Y30LB12*/ 03060000
         MVC   OUTBUF2(62,R4),ICGDS245                             0649 03061000
*         OUTBUF2(22)=PATTERN(I);   /*                       @Y30LB12*/ 03062000
         LA    @05,PATTERN-1(I)                                    0650 03063000
         MVC   OUTBUF2+21(1,R4),0(@05)                             0650 03064000
*         CALL PUTIT1;              /*                       @Y30LB12*/ 03065000
         BAL   @14,PUTIT1                                          0651 03066000
*       END;                        /*                       @Y30LB12*/ 03067000
*     ELSE                          /*                       @Y30LB12*/ 03068000
*       RSGABOX1(RSGINDEX)='1'B;    /*                       @Y30LB12*/ 03069000
         B     @RC00647                                            0653 03070000
@RF00647 LH    @05,RSGINDEX                                        0653 03071000
         MH    @05,@CH00114                                        0653 03072000
         ALR   @05,R4                                              0653 03073000
         OI    RSGABOX1-9(@05),B'00100000'                         0653 03074000
*   ELSE                            /*                       @Y30LB12*/ 03075000
*     IF RSGABOX1(RSGINDEX)='1'B    /*                       @Y30LB12*/ 03076000
*       THEN                        /*                       @Y30LB12*/ 03077000
         B     @RC00646                                            0654 03078000
@RF00646 LH    @05,RSGINDEX                                        0654 03079000
         MH    @05,@CH00114                                        0654 03080000
         ALR   @05,R4                                              0654 03081000
         TM    RSGABOX1-9(@05),B'00100000'                         0654 03082000
         BNO   @RF00654                                            0654 03083000
*       DO;                         /*                       @Y30LB12*/ 03084000
*                                                                  0655 03085000
*         /***********************************************************/ 03086000
*         /*                                                         */ 03087000
*         /* *************************************           @Y30LB12*/ 03088000
*         /* ICG245I SDG FOR DEV X PREVIOUSLY                @Y30LB12*/ 03089000
*         /* SPECIFIED WITH DIFFERENT LCU                    @Y30LB12*/ 03090000
*         /* *************************************           @Y30LB12*/ 03091000
*         /*                                                         */ 03092000
*         /***********************************************************/ 03093000
*                                                                  0656 03094000
*         OUTBUF2(1:62)=ICGDS245;   /*                       @Y30LB12*/ 03095000
         MVC   OUTBUF2(62,R4),ICGDS245                             0656 03096000
*         OUTBUF2(22)=PATTERN(I);   /*                       @Y30LB12*/ 03097000
         LA    @05,PATTERN-1(I)                                    0657 03098000
         MVC   OUTBUF2+21(1,R4),0(@05)                             0657 03099000
*         CALL PUTIT1;              /*                       @Y30LB12*/ 03100000
         BAL   @14,PUTIT1                                          0658 03101000
*       END;                        /*                       @Y30LB12*/ 03102000
*     ELSE                          /*                       @Y30LB12*/ 03103000
*       RSGABOX0(RSGINDEX)='1'B;    /*                       @Y30LB12*/ 03104000
         B     @RC00654                                            0660 03105000
@RF00654 LH    @05,RSGINDEX                                        0660 03106000
         MH    @05,@CH00114                                        0660 03107000
         ALR   @05,R4                                              0660 03108000
         OI    RSGABOX0-9(@05),B'01000000'                         0660 03109000
*   END CHKABOX;                    /*                       @Y30LB12*/ 03110000
@EL00021 DS    0H                                                  0661 03111000
@EF00021 DS    0H                                                  0661 03112000
@ER00021 LM    @14,@12,@SA00021                                    0661 03113000
         BR    @14                                                 0661 03114000
*                                                                  0662 03115000
*/********************************************************** @Y30LB12*/ 03116000
*/*                                                          @Y30LB12*/ 03117000
*/* PROCEDURE NAME - CHECKRSG                                @Y30LB12*/ 03118000
*/*                                                          @Y30LB12*/ 03119000
*/* FUNCTION - IF A STAGING DASD GROUP INTERFACES TO TWO     @Y30LB12*/ 03120000
*/*            DATA STAGERS, ALL SPINDLES THAT MAKE UP THE   @Y30LB12*/ 03121000
*/*            STAGING DASD GROUP MUST ALL INTERFACE TO THE  @Y30LB12*/ 03122000
*/*            SAME TWO DATA STAGERS.  IT IS NOT ALLOWED     @Y30LB12*/ 03123000
*/*            THAT A STAGING SPINDLE HAVE A PATH TO ONLY    @Y30LB12*/ 03124000
*/*            ONE OF THE DATA STAGERS.                      @Y30LB12*/ 03125000
*/*                                                          @Y30LB12*/ 03126000
*/********************************************************** @Y30LB12*/ 03127000
*                                                                  0662 03128000
*CHECKRSG:                                                         0662 03129000
*   PROCEDURE;                      /*                       @Y30LB12*/ 03130000
*                                                                  0662 03131000
CHECKRSG STM   @14,@12,@SA00022                                    0662 03132000
*   /*****************************************************************/ 03133000
*   /*                                                               */ 03134000
*   /* ***********************************************       @Y30LB12*/ 03135000
*   /* FIRST CASE - FIRST SPINDLE FOR THIS RSG.              @Y30LB12*/ 03136000
*   /* ENTER EITHER ONE OR TWO RSGS INTO BUILDRSG            @Y30LB12*/ 03137000
*   /* AND RETURN.                                           @Y30LB12*/ 03138000
*   /* ***********************************************       @Y30LB12*/ 03139000
*   /*                                                               */ 03140000
*   /*****************************************************************/ 03141000
*                                                                  0663 03142000
*   IF TODS1(RSGINDEX)='FF'X        /*                       @Y30LB12*/ 03143000
*       &TODS2(RSGINDEX)='FF'X      /*                       @Y30LB12*/ 03144000
*     THEN                          /*                       @Y30LB12*/ 03145000
         LH    @05,RSGINDEX                                        0663 03146000
         MH    @05,@CH00114                                        0663 03147000
         ST    @05,@TF00001                                        0663 03148000
         ALR   @05,R4                                              0663 03149000
         CLI   TODS1-9(@05),X'FF'                                  0663 03150000
         BNE   @RF00663                                            0663 03151000
         LR    @05,R4                                              0663 03152000
         AL    @05,@TF00001                                        0663 03153000
         CLI   TODS2-9(@05),X'FF'                                  0663 03154000
         BNE   @RF00663                                            0663 03155000
*     DO;                           /*                       @Y30LB12*/ 03156000
*       TODS1(RSGINDEX)=DSINDEX1-1; /*                       @Y30LB12*/ 03157000
         LH    @05,DSINDEX1                                        0665 03158000
         BCTR  @05,0                                               0665 03159000
         L     @01,@TF00001                                        0665 03160000
         STC   @05,TODS1-9(@01,R4)                                 0665 03161000
*       IF DSINDEX2^=0              /*                       @Y30LB12*/ 03162000
*         THEN                      /*                       @Y30LB12*/ 03163000
         LH    @05,DSINDEX2                                        0666 03164000
         LTR   @05,@05                                             0666 03165000
         BZ    @RF00666                                            0666 03166000
*         TODS2(RSGINDEX)=DSINDEX2-1;/*                      @Y30LB12*/ 03167000
         BCTR  @05,0                                               0667 03168000
         L     @01,@TF00001                                        0667 03169000
         STC   @05,TODS2-9(@01,R4)                                 0667 03170000
*       ELSE                                                       0668 03171000
*         ;                         /*                       @Y30LB12*/ 03172000
@RF00666 DS    0H                                                  0669 03173000
*       RETURN;                     /*                       @Y30LB12*/ 03174000
@EL00022 DS    0H                                                  0669 03175000
@EF00022 DS    0H                                                  0669 03176000
@ER00022 LM    @14,@12,@SA00022                                    0669 03177000
         BR    @14                                                 0669 03178000
*     END;                          /*                       @Y30LB12*/ 03179000
*   ELSE                                                           0671 03180000
*     ;                             /*                       @Y30LB12*/ 03181000
*                                                                  0671 03182000
@RF00663 DS    0H                                                  0672 03183000
*   /*****************************************************************/ 03184000
*   /*                                                               */ 03185000
*   /* ***********************************************       @Y30LB12*/ 03186000
*   /* SECOND CASE - THIS RSG INTERFACES TO ONLY ONE         @Y30LB12*/ 03187000
*   /* DATA STAGER AND IT IS THE SAME DATA STAGER            @Y30LB12*/ 03188000
*   /* THAT WAS ENTERED INTO THE TABLE IN THE FIRST          @Y30LB12*/ 03189000
*   /* CASE. IF THERE IS NO SECOND DATA STAGER IN            @Y30LB12*/ 03190000
*   /* EITHER THE PREVIOUS OR CURRENT SPINDLES               @Y30LB12*/ 03191000
*   /* STATEMENTS, BUT THE FIRST DATA STAGER DOES NOT        @Y30LB12*/ 03192000
*   /* AGREE WITH THE PREVIOUS SPECIFICATION, SET UP         @Y30LB12*/ 03193000
*   /* FOR AN ERROR MESSAGE.                                 @Y30LB12*/ 03194000
*   /* ***********************************************       @Y30LB12*/ 03195000
*   /*                                                               */ 03196000
*   /*****************************************************************/ 03197000
*                                                                  0672 03198000
*   IF TODS2(RSGINDEX)='FF'X        /*                       @Y30LB12*/ 03199000
*       &DSINDEX2=0                 /*                       @Y30LB12*/ 03200000
*     THEN                          /*                       @Y30LB12*/ 03201000
         LH    @05,RSGINDEX                                        0672 03202000
         MH    @05,@CH00114                                        0672 03203000
         ST    @05,@TF00001                                        0672 03204000
         ALR   @05,R4                                              0672 03205000
         CLI   TODS2-9(@05),X'FF'                                  0672 03206000
         BNE   @RF00672                                            0672 03207000
         LH    @05,DSINDEX2                                        0672 03208000
         LTR   @05,@05                                             0672 03209000
         BNZ   @RF00672                                            0672 03210000
*     IF TODS1(RSGINDEX)=DSINDEX1-1 /*                       @Y30LB12*/ 03211000
*       THEN                        /*                       @Y30LB12*/ 03212000
         LH    @05,DSINDEX1                                        0673 03213000
         BCTR  @05,0                                               0673 03214000
         LR    @01,R4                                              0673 03215000
         AL    @01,@TF00001                                        0673 03216000
         MVC   @ZT00003+3(1),TODS1-9(@01)                          0673 03217000
         C     @05,@ZT00003                                        0673 03218000
         BE    @RT00673                                            0673 03219000
*       RETURN;                     /*                       @Y30LB12*/ 03220000
*     ELSE                                                         0675 03221000
*       ;                           /*                       @Y30LB12*/ 03222000
*                                                                  0675 03223000
*   /*****************************************************************/ 03224000
*   /*                                                               */ 03225000
*   /* ***********************************************       @Y30LB12*/ 03226000
*   /* THIRD CASE - THERE ARE TWO DATA STAGERS               @Y30LB12*/ 03227000
*   /* SPECIFIED FOR THIS RSG - BOTH MUST AGREE WITH         @Y30LB12*/ 03228000
*   /* THE PREVIOUSLY SPECIFIED DATA STAGERS.                @Y30LB12*/ 03229000
*   /* ***********************************************       @Y30LB12*/ 03230000
*   /*                                                               */ 03231000
*   /*****************************************************************/ 03232000
*                                                                  0676 03233000
*   IF TODS1(RSGINDEX)=DSINDEX1-1   /*                       @Y30LB12*/ 03234000
*       &TODS2(RSGINDEX)=DSINDEX2-1 /*                       @Y30LB12*/ 03235000
*     THEN                          /*                       @Y30LB12*/ 03236000
@RF00672 LH    @05,RSGINDEX                                        0676 03237000
         MH    @05,@CH00114                                        0676 03238000
         LH    @15,DSINDEX1                                        0676 03239000
         BCTR  @15,0                                               0676 03240000
         ST    @05,@TF00001                                        0676 03241000
         ALR   @05,R4                                              0676 03242000
         MVC   @ZT00003+3(1),TODS1-9(@05)                          0676 03243000
         C     @15,@ZT00003                                        0676 03244000
         BNE   @RF00676                                            0676 03245000
         LH    @05,DSINDEX2                                        0676 03246000
         BCTR  @05,0                                               0676 03247000
         LR    @01,R4                                              0676 03248000
         AL    @01,@TF00001                                        0676 03249000
         MVC   @ZT00003+3(1),TODS2-9(@01)                          0676 03250000
         C     @05,@ZT00003                                        0676 03251000
         BE    @RT00676                                            0676 03252000
*     RETURN;                       /*                       @Y30LB12*/ 03253000
*   ELSE                                                           0678 03254000
*     ;                             /*                       @Y30LB12*/ 03255000
*                                                                  0678 03256000
@RF00676 DS    0H                                                  0679 03257000
*   /*****************************************************************/ 03258000
*   /*                                                               */ 03259000
*   /* ***********************************************       @Y30LB12*/ 03260000
*   /* IF WE REACH THIS POINT, WE HAVE NOT RETURNED          @Y30LB12*/ 03261000
*   /* TO UPDATPAB BY POSITIVELY VERIFYING THAT THE          @Y30LB12*/ 03262000
*   /* CONTENTS OF TODS1 AND TODS2 AGREE WITH THE            @Y30LB12*/ 03263000
*   /* DATA STAGERS SPECIFIED FOR THIS SPINDLE.              @Y30LB12*/ 03264000
*   /* WRITE ERROR MESSAGE ICG248I SDG XX PREVIOUSLY         @Y30LB12*/ 03265000
*   /* SPECIFIED TO DIFFERENT SA OR SA PAIR.                 @Y30LB12*/ 03266000
*   /* ***********************************************       @Y30LB12*/ 03267000
*   /*                                                               */ 03268000
*   /*****************************************************************/ 03269000
*                                                                  0679 03270000
*   OUTBUF2(1:63)=ICGDS248;         /*                       @Y30LB12*/ 03271000
         MVC   OUTBUF2(63,R4),ICGDS248                             0679 03272000
*   OUTBUF2(14:15)=LOKUPRSG(RSGINDEX);/*                     @Y30LB12*/ 03273000
         LH    @05,RSGINDEX                                        0680 03274000
         ALR   @05,@05                                             0680 03275000
         LA    @01,LOKUPRSG-2(@05)                                 0680 03276000
         MVC   OUTBUF2+13(2,R4),0(@01)                             0680 03277000
*   CALL PUTIT1;                    /*                       @Y30LB12*/ 03278000
         BAL   @14,PUTIT1                                          0681 03279000
*   END CHECKRSG;                   /*                       @Y30LB12*/ 03280000
         B     @EL00022                                            0682 03281000
*                                                                  0683 03282000
*/********************************************************** @Y30LB12*/ 03283000
*/*                                                          @Y30LB12*/ 03284000
*/* PROCEDURE NAME - DODEVTBL                                @Y30LB12*/ 03285000
*/*                                                          @Y30LB12*/ 03286000
*/* FUNCTION - UPDATE THE DEVICE PORTION OF THE PAB USING    @Y30LB12*/ 03287000
*/*            LOGICAL DEVICE AS INDEX INTO THE TABLE.  IF   @Y30LB12*/ 03288000
*/*            THE DEVICE IS A 3330 MODEL 11, TWO            @Y30LB12*/ 03289000
*/*            CONSECUTIVE ENTRIES MUST BE UPDATED.          @Y30LB12*/ 03290000
*/*                                                          @Y30LB12*/ 03291000
*/********************************************************** @Y30LB12*/ 03292000
*                                                                  0683 03293000
*DODEVTBL:                                                         0683 03294000
*   PROCEDURE;                      /*                       @Y30LB12*/ 03295000
DODEVTBL STM   @14,@12,@SA00023                                    0683 03296000
*   DEVINDEX=WKLOGDEV(I)+1;         /*                       @Y30LB12*/ 03297000
         LR    @05,I                                               0684 03298000
         SLA   @05,2                                               0684 03299000
         LA    @03,1                                               0684 03300000
         LA    @01,WKLOGDEV-4(@05)                                 0684 03301000
         MVC   @ZT00003+3(1),0(@01)                                0684 03302000
         AL    @03,@ZT00003                                        0684 03303000
         STC   @03,DEVINDEX                                        0684 03304000
*   IF PABEXIST(RSGINDEX,DEVINDEX)^='1'B/*                   @Y30LB12*/ 03305000
*     THEN                          /*                       @Y30LB12*/ 03306000
         LH    @05,RSGINDEX                                        0685 03307000
         SLA   @05,3                                               0685 03308000
         ALR   @05,@03                                             0685 03309000
         MH    @05,@CH00050                                        0685 03310000
         ST    @05,@TF00001                                        0685 03311000
         ALR   @05,R4                                              0685 03312000
         TM    PABEXIST-27(@05),B'10000000'                        0685 03313000
         BO    @RF00685                                            0685 03314000
*     DO;                           /*                       @Y30LB12*/ 03315000
*       PABEXIST(RSGINDEX,DEVINDEX)='1'B;/*                  @Y30LB12*/ 03316000
         LR    @05,R4                                              0687 03317000
         AL    @05,@TF00001                                        0687 03318000
         OI    PABEXIST-27(@05),B'10000000'                        0687 03319000
*       PABAADDD(RSGINDEX,DEVINDEX)=((WORKCUA-1)*8)+I-1;           0688 03320000
         SLR   @05,@05                                             0688 03321000
         IC    @05,WORKCUA                                         0688 03322000
         BCTR  @05,0                                               0688 03323000
         SLA   @05,3                                               0688 03324000
         ALR   @05,I                                               0688 03325000
         BCTR  @05,0                                               0688 03326000
         L     @03,@TF00001                                        0688 03327000
         STC   @05,PABAADDD-27(@03,R4)                             0688 03328000
*     END;                          /*                       @Y30LB12*/ 03329000
*   ELSE                            /*                       @Y30LB12*/ 03330000
*     DO;                           /*                       @Y30LB12*/ 03331000
*                                                                  0690 03332000
         B     @RC00685                                            0690 03333000
@RF00685 DS    0H                                                  0691 03334000
*       /*************************************************************/ 03335000
*       /*                                                           */ 03336000
*       /* *****************************************         @Y30LB12*/ 03337000
*       /* ICG242I LOGICAL DEVICE X FOR SDG XX               @YD00141*/ 03338000
*       /* PREVIOUSLY SPECIFIED                              @YD00141*/ 03339000
*       /* *****************************************         @Y30LB12*/ 03340000
*       /*                                                           */ 03341000
*       /*************************************************************/ 03342000
*                                                                  0691 03343000
*       OUTBUF2(1:57)=ICGDS242;     /*                       @YD00141*/ 03344000
         MVC   OUTBUF2(57,R4),ICGDS242                             0691 03345000
*       OUTBUF2(25)=PATTERN(DEVINDEX);/*                     @Y30LB12*/ 03346000
         SLR   @05,@05                                             0692 03347000
         IC    @05,DEVINDEX                                        0692 03348000
         LA    @03,PATTERN-1(@05)                                  0692 03349000
         MVC   OUTBUF2+24(1,R4),0(@03)                             0692 03350000
*       OUTBUF2(35:36)=LOKUPRSG(RSGINDEX);/*                 @YD00141*/ 03351000
         LH    @05,RSGINDEX                                        0693 03352000
         ALR   @05,@05                                             0693 03353000
         LA    @03,LOKUPRSG-2(@05)                                 0693 03354000
         MVC   OUTBUF2+34(2,R4),0(@03)                             0693 03355000
*       CALL PUTIT1;                /*                       @Y30LB12*/ 03356000
         BAL   @14,PUTIT1                                          0694 03357000
*     END;                          /*                       @Y30LB12*/ 03358000
*   IF REALTYPE(I)=PHYSFICE         /* DEVICE IS 3330-11     @Y30LB12*/ 03359000
*     THEN                          /*                       @Y30LB12*/ 03360000
@RC00685 LR    @05,I                                               0696 03361000
         SLA   @05,2                                               0696 03362000
         LA    @03,REALTYPE-4(@05)                                 0696 03363000
         TM    0(@03),B'00000010'                                  0696 03364000
         BNO   @RF00696                                            0696 03365000
         TM    0(@03),B'00000100'                                  0696 03366000
         BNZ   @RF00696                                            0696 03367000
*     DO;                           /*                       @Y30LB12*/ 03368000
*       PABIBERG(RSGINDEX,DEVINDEX)='1'B;/*                  @Y30LB12*/ 03369000
         LA    @05,3                                               0698 03370000
         SLR   @03,@03                                             0698 03371000
         IC    @03,DEVINDEX                                        0698 03372000
         LH    @15,RSGINDEX                                        0698 03373000
         SLA   @15,3                                               0698 03374000
         LR    @01,@15                                             0698 03375000
         ALR   @01,@03                                             0698 03376000
         MR    @00,@05                                             0698 03377000
         ALR   @01,R4                                              0698 03378000
         OI    PABIBERG-27(@01),B'00010000'                        0698 03379000
*       DEVINDEX=DEVINDEX+1;        /*                       @Y30LB12*/ 03380000
         AH    @03,@CH00044                                        0699 03381000
         STC   @03,DEVINDEX                                        0699 03382000
*       IF PABEXIST(RSGINDEX,DEVINDEX)^='1'B/*               @Y30LB12*/ 03383000
*         THEN                      /*                       @Y30LB12*/ 03384000
         ALR   @15,@03                                             0700 03385000
         MR    @14,@05                                             0700 03386000
         ST    @15,@TF00001                                        0700 03387000
         ALR   @15,R4                                              0700 03388000
         TM    PABEXIST-27(@15),B'10000000'                        0700 03389000
         BO    @RF00700                                            0700 03390000
*         DO;                       /*                       @Y30LB12*/ 03391000
*           PABEXIST(RSGINDEX,DEVINDEX)='1'B;/*              @Y30LB12*/ 03392000
         LR    @05,R4                                              0702 03393000
         AL    @05,@TF00001                                        0702 03394000
         OI    PABEXIST-27(@05),B'10000000'                        0702 03395000
*           PABAADDD(RSGINDEX,DEVINDEX)=((WORKCUA-1)*8)+I-1;       0703 03396000
         SLR   @05,@05                                             0703 03397000
         IC    @05,WORKCUA                                         0703 03398000
         BCTR  @05,0                                               0703 03399000
         SLA   @05,3                                               0703 03400000
         ALR   @05,I                                               0703 03401000
         BCTR  @05,0                                               0703 03402000
         L     @03,@TF00001                                        0703 03403000
         STC   @05,PABAADDD-27(@03,R4)                             0703 03404000
*           PABIBERG(RSGINDEX,DEVINDEX)='1'B;/*              @Y30LB12*/ 03405000
*           PABBERG2(RSGINDEX,DEVINDEX)='1'B;/*              @Y30LB12*/ 03406000
         LR    @05,R4                                              0705 03407000
         AL    @05,@TF00001                                        0705 03408000
         OI    PABIBERG-27(@05),B'00010001'                        0705 03409000
*         END;                      /*                       @Y30LB12*/ 03410000
*       ELSE                        /*                       @Y30LB12*/ 03411000
*         DO;                       /*                       @Y30LB12*/ 03412000
*                                                                  0707 03413000
         B     @RC00700                                            0707 03414000
@RF00700 DS    0H                                                  0708 03415000
*           /*********************************************************/ 03416000
*           /*                                                       */ 03417000
*           /* ***********************************           @Y30LB12*/ 03418000
*           /* ICG242I LOGICAL DEVICE X FOR SDG              @YD00141*/ 03419000
*           /* XX PREVIOUSLY SPECIFIED                       @YD00141*/ 03420000
*           /* ***********************************           @Y30LB12*/ 03421000
*           /*                                                       */ 03422000
*           /*********************************************************/ 03423000
*                                                                  0708 03424000
*           OUTBUF2(1:57)=ICGDS242; /*                       @YD00141*/ 03425000
         MVC   OUTBUF2(57,R4),ICGDS242                             0708 03426000
*           OUTBUF2(35:36)=LOKUPRSG(RSGINDEX);/*             @YD00141*/ 03427000
         LH    @05,RSGINDEX                                        0709 03428000
         ALR   @05,@05                                             0709 03429000
         LA    @03,LOKUPRSG-2(@05)                                 0709 03430000
         MVC   OUTBUF2+34(2,R4),0(@03)                             0709 03431000
*           OUTBUF2(25)=PATTERN(DEVINDEX);/*                 @Y30LB12*/ 03432000
         SLR   @05,@05                                             0710 03433000
         IC    @05,DEVINDEX                                        0710 03434000
         LA    @03,PATTERN-1(@05)                                  0710 03435000
         MVC   OUTBUF2+24(1,R4),0(@03)                             0710 03436000
*           CALL PUTIT1;            /*                       @Y30LB12*/ 03437000
         BAL   @14,PUTIT1                                          0711 03438000
*         END;                      /*                       @Y30LB12*/ 03439000
*     END;                          /*                       @Y30LB12*/ 03440000
*   ELSE                                                           0714 03441000
*     ;                             /*                       @Y30LB12*/ 03442000
@RF00696 DS    0H                                                  0715 03443000
*   END DODEVTBL;                   /* RET. TO UPDATPAB      @Y30LB12*/ 03444000
@EL00023 DS    0H                                                  0715 03445000
@EF00023 DS    0H                                                  0715 03446000
@ER00023 LM    @14,@12,@SA00023                                    0715 03447000
         BR    @14                                                 0715 03448000
*                                                                  0716 03449000
*/***********************************************************@Y30LB12*/ 03450000
*/*                                                          @Y30LB12*/ 03451000
*/* PROCEDURE NAME - READS99                                 @Y30LB12*/ 03452000
*/*                                                          @Y30LB12*/ 03453000
*/* FUNCTION - CALL SCAN READ KEYWORD/PARAMETER SUBROUTINE   @Y30LB12*/ 03454000
*/*            ICGDSS99.  PICK UP STARTING COLUMN FOR THIS   @Y30LB12*/ 03455000
*/*            SCAN AND STARTING COLUMN FOR NEXT ENTRY INTO  @Y30LB12*/ 03456000
*/*            ICGDSS99.  IF TERMINATING ERROR OCCURS IN     @Y30LB12*/ 03457000
*/*            ICGDSS99, SET 'LASTPARM' TO TERMINATE IN THIS @Y30LB12*/ 03458000
*/*            MODULE ON NEXT READ OF KEYWORD                @Y30LB12*/ 03459000
*/*                                                          @Y30LB12*/ 03460000
*/***********************************************************@Y30LB12*/ 03461000
*                                                                  0716 03462000
*READS99:                                                          0716 03463000
*   PROCEDURE;                      /*                       @Y30LB12*/ 03464000
READS99  STM   @14,@12,@SA00024                                    0716 03465000
*   GEN(LINK EP=ICGDSS99);          /* TO SCAN KEYWORD/PARAMETER     */ 03466000
*                                                                  0717 03467000
         LINK EP=ICGDSS99                                               03468000
*   /*****************************************************************/ 03469000
*   /*                                                               */ 03470000
*   /* ************************************************@Y30LB12 IF   */ 03471000
*   /* 'ENDSCAN' BIT IS ON, WE ENCOUNTERED SOME              @Y30LB12*/ 03472000
*   /* DISASTEROUS CONDITION THAT TERMINATED THE SCAN        @Y30LB12*/ 03473000
*   /* OF THIS CONTROL STATEMENT. THERE ERRORS ARE           @Y30LB12*/ 03474000
*   /* ASSOCIATED WITH SCANNING INTO COLUMN 73 AND           @Y30LB12*/ 03475000
*   /* WITH FINDING A FORMAT ERROR IN THE                    @Y30LB12*/ 03476000
*   /* CONTINUATION STATEMENT. SHOULD SUCH A                 @Y30LB12*/ 03477000
*   /* CONDITION OCCUR, WE TERMINATE SCAN OF THE             @Y30LB12*/ 03478000
*   /* CONTROL STATEMENT UPON READ OF THE NEXT               @Y30LB12*/ 03479000
*   /* KEYWORD.                                              @Y30LB12*/ 03480000
*   /* ************************************************@Y30LB12      */ 03481000
*   /*                                                               */ 03482000
*   /*****************************************************************/ 03483000
*                                                                  0718 03484000
*   IF ENDSCAN='1'B                 /*                       @Y30LB12*/ 03485000
*     THEN                          /*                       @Y30LB12*/ 03486000
         TM    ENDSCAN(R4),B'00010000'                             0718 03487000
         BNO   @RF00718                                            0718 03488000
*     LASTPARM='1'B;                /*                       @Y30LB12*/ 03489000
         OI    LASTPARM(R4),B'00001000'                            0719 03490000
*   ELSE                                                           0720 03491000
*     ;                             /*                       @Y30LB12*/ 03492000
@RF00718 DS    0H                                                  0721 03493000
*   END READS99;                    /*                       @Y30LB12*/ 03494000
@EL00024 DS    0H                                                  0721 03495000
@EF00024 DS    0H                                                  0721 03496000
@ER00024 LM    @14,@12,@SA00024                                    0721 03497000
         BR    @14                                                 0721 03498000
*                                                                  0722 03499000
*/***********************************************************@Y30LB12*/ 03500000
*/*                                                          @Y30LB12*/ 03501000
*/* PROCEDURE NAME - PUTIT1                                  @Y30LB12*/ 03502000
*/*                                                          @Y30LB12*/ 03503000
*/* FUNCTION - CALL ICGDSMSG, MESSAGE PRINT SUBROUTINE, TO   @Y30LB12*/ 03504000
*/*            PUT TERMINATING MESSAGE FOR WHICH TEXT IS NOT @Y30LB12*/ 03505000
*/*            IN ICGDSMSG BUT ALREADY BUILT IN 'OUTBUF2'    @Y30LB12*/ 03506000
*/*                                                          @Y30LB12*/ 03507000
*/***********************************************************@Y30LB12*/ 03508000
*                                                                  0722 03509000
*PUTIT1:                                                           0722 03510000
*   PROCEDURE;                      /*                       @Y30LB12*/ 03511000
PUTIT1   STM   @14,@12,@SA00025                                    0722 03512000
*   STOPSCAN='1'B;                  /*                       @Y30LB12*/ 03513000
         OI    STOPSCAN,B'01000000'                                0723 03514000
*   PRNTBUF2='1'B;                  /*                       @Y30LB12*/ 03515000
         OI    PRNTBUF2(R4),B'00000001'                            0724 03516000
*   TERMINAT=TERMINAT+1;            /*                       @Y30LB12*/ 03517000
         LA    @05,1                                               0725 03518000
         AH    @05,TERMINAT(,R4)                                   0725 03519000
         STH   @05,TERMINAT(,R4)                                   0725 03520000
*   GEN(LINK  EP=ICGDSMSG);         /*                       @Y30LB12*/ 03521000
         LINK  EP=ICGDSMSG                                              03522000
*   PRNTBUF2='0'B;                  /*                       @Y30LB12*/ 03523000
         NI    PRNTBUF2(R4),B'11111110'                            0727 03524000
*   END PUTIT1;                     /*                       @Y30LB12*/ 03525000
@EL00025 DS    0H                                                  0728 03526000
@EF00025 DS    0H                                                  0728 03527000
@ER00025 LM    @14,@12,@SA00025                                    0728 03528000
         BR    @14                                                 0728 03529000
*                                                                  0729 03530000
*/***********************************************************@Y30LB12*/ 03531000
*/*                                                          @Y30LB12*/ 03532000
*/* PROCEDURE NAME - PUTIT2                                  @Y30LB12*/ 03533000
*/*                                                          @Y30LB12*/ 03534000
*/* FUNCTION - CALL ICGDSMSG, MESSAGE PRINT SUBROUTINE, TO   @Y30LB12*/ 03535000
*/*            PUT TERMINATING MESSAGE FOR WHICH MESSAGE     @Y30LB12*/ 03536000
*/*            TEXT IS IN ICGDSMSG.  'MSGNO' INDICATES THE   @Y30LB12*/ 03537000
*/*            OFFSET OF THE MESSAGE TEXT.                   @Y30LB12*/ 03538000
*/*                                                          @Y30LB12*/ 03539000
*/***********************************************************@Y30LB12*/ 03540000
*                                                                  0729 03541000
*PUTIT2:                                                           0729 03542000
*   PROCEDURE;                      /*                       @Y30LB12*/ 03543000
PUTIT2   STM   @14,@12,@SA00026                                    0729 03544000
*   STOPSCAN='1'B;                  /*                       @Y30LB12*/ 03545000
         OI    STOPSCAN,B'01000000'                                0730 03546000
*   TERMINAT=TERMINAT+1;            /*                       @Y30LB12*/ 03547000
         LA    @05,1                                               0731 03548000
         AH    @05,TERMINAT(,R4)                                   0731 03549000
         STH   @05,TERMINAT(,R4)                                   0731 03550000
*   GEN(LINK  EP=ICGDSMSG);         /*                       @Y30LB12*/ 03551000
         LINK  EP=ICGDSMSG                                              03552000
*   END PUTIT2;                     /*                       @Y30LB12*/ 03553000
@EL00026 DS    0H                                                  0733 03554000
@EF00026 DS    0H                                                  0733 03555000
@ER00026 LM    @14,@12,@SA00026                                    0733 03556000
         BR    @14                                                 0733 03557000
*                                                                  0734 03558000
*/********************************************************** @Y30LB12*/ 03559000
*/*                    P A T C H   A R E A                   @Y30LB12*/ 03560000
*/********************************************************** @Y30LB12*/ 03561000
*                                                                  0734 03562000
*   GENERATE;                                                      0734 03563000
*                                                         /*@Y30LB12*/  03564000
PATCHS09 DC    32C'PATCHS09'                              /*@Y30LB12*/  03565000
*   END ICGDSS09                    /*                       @Y30LB12*/ 03566000
*                                                                  0735 03567000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 03568000
*/*%INCLUDE SYSLIB  (ICGDSMAC)                                       */ 03569000
*/*%INCLUDE SYSLIB  (ICGDSMA1)                                       */ 03570000
*/*%INCLUDE SYSLIB  (ICGDSMA2)                                       */ 03571000
*/*%INCLUDE SYSLIB  (ICGDSMA3)                                       */ 03572000
*                                                                  0735 03573000
*       ;                                                          0735 03574000
         B     @EL00001                                            0735 03575000
@DATA    DS    0H                                                       03576000
@CH00044 DC    H'1'                                                     03577000
@CH00052 DC    H'2'                                                     03578000
@CH00050 DC    H'3'                                                     03579000
@CH00070 DC    H'4'                                                     03580000
@CH00121 DC    H'5'                                                     03581000
@CH00227 DC    H'6'                                                     03582000
@CH00135 DC    H'7'                                                     03583000
@CH00042 DC    H'8'                                                     03584000
@CH00114 DC    H'9'                                                     03585000
@CH00164 DC    H'16'                                                    03586000
@CH00343 DC    H'28'                                                    03587000
@DATD    DSECT                                                          03588000
         DS    0F                                                       03589000
@SA00001 DS    18F                                                      03590000
@SA00003 DS    15F                                                      03591000
@SA00017 DS    15F                                                      03592000
@SA00018 DS    15F                                                      03593000
@SA00024 DS    15F                                                      03594000
@SA00026 DS    15F                                                      03595000
@SA00005 DS    15F                                                      03596000
@SA00004 DS    15F                                                      03597000
@SA00007 DS    15F                                                      03598000
@SA00015 DS    15F                                                      03599000
@SA00025 DS    15F                                                      03600000
@SA00006 DS    15F                                                      03601000
@SA00016 DS    15F                                                      03602000
@SA00008 DS    15F                                                      03603000
@SA00009 DS    15F                                                      03604000
@SA00010 DS    15F                                                      03605000
@SA00014 DS    15F                                                      03606000
@SA00013 DS    15F                                                      03607000
@SA00011 DS    15F                                                      03608000
@SA00012 DS    15F                                                      03609000
@SA00019 DS    15F                                                      03610000
@SA00020 DS    15F                                                      03611000
@SA00021 DS    15F                                                      03612000
@SA00022 DS    15F                                                      03613000
@SA00023 DS    15F                                                      03614000
@TF00001 DS    F                                                        03615000
@ZTEMPS  DS    0F                                                       03616000
@ZT00003 DC    F'0'                                                     03617000
@ZTEMPND EQU   *                                                        03618000
@ZLEN    EQU   @ZTEMPND-@ZTEMPS                                         03619000
ICGDSS09 CSECT                                                          03620000
         DS    0F                                                       03621000
@DATD    DSECT                                                          03622000
         DS    0D                                                       03623000
SPNWORKA DS    CL58                                                     03624000
         ORG   SPNWORKA                                                 03625000
PLUGIN   DS    CL8                                                      03626000
DEVICES  DS    CL4                                                      03627000
         ORG   DEVICES+0                                                03628000
FLAGS    DS    BL2                                                      03629000
         ORG   FLAGS+0                                                  03630000
HAVEDEV  DS    BL1                                                      03631000
REALSPEC EQU   FLAGS+0                                                  03632000
SSIDSPEC EQU   FLAGS+0                                                  03633000
ABOXSPEC EQU   FLAGS+0                                                  03634000
ABOX1    EQU   FLAGS+0                                                  03635000
REALTYPE EQU   FLAGS+0                                                  03636000
LDEVSPEC EQU   FLAGS+0                                                  03637000
WRSGSPEC DS    BL1                                                      03638000
@NM00020 EQU   FLAGS+1                                                  03639000
         ORG   DEVICES+2                                                03640000
WKLOGDEV DS    CL1                                                      03641000
WORKRSG  DS    CL1                                                      03642000
         ORG   SPNWORKA+40                                              03643000
HEXINDEX DS    FL2                                                      03644000
DSINDEX1 DS    FL2                                                      03645000
DSINDEX2 DS    FL2                                                      03646000
RSGINDEX DS    FL2                                                      03647000
DEVINDEX DS    FL1                                                      03648000
PHYSINDX DS    FL1                                                      03649000
DECINDEX DS    FL1                                                      03650000
WORKDEV  DS    FL1                                                      03651000
WORKCUA  DS    FL1                                                      03652000
         ORG   WORKCUA                                                  03653000
HIGHCUA  DS    BL1                                                      03654000
MIDCUA   EQU   WORKCUA+0                                                03655000
LOWCUA   EQU   WORKCUA+0                                                03656000
         ORG   SPNWORKA+53                                              03657000
HEXCHAR  DS    CL1                                                      03658000
HOLDRSG  DS    CL2                                                      03659000
HAVES    DS    CL1                                                      03660000
         ORG   HAVES                                                    03661000
HAVEDS   DS    BL1                                                      03662000
HAVECUA  EQU   HAVES+0                                                  03663000
FOUNDDEV EQU   HAVES+0                                                  03664000
@NM00021 EQU   HAVES+0                                                  03665000
         ORG   SPNWORKA+57                                              03666000
S09MSGID DS    CL1                                                      03667000
         ORG   S09MSGID                                                 03668000
KNOWN    DS    BL1                                                      03669000
STOPSCAN EQU   S09MSGID+0                                               03670000
KNOWN2   EQU   S09MSGID+0                                               03671000
KNOWN3   EQU   S09MSGID+0                                               03672000
KNOWN4   EQU   S09MSGID+0                                               03673000
@NM00022 EQU   S09MSGID+0                                               03674000
         ORG   SPNWORKA+58                                              03675000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                03676000
@ENDDATD EQU   *                                                        03677000
ICGDSS09 CSECT                                                          03678000
         DS    0F                                                       03679000
@SIZDATD DC    AL1(0)                                                   03680000
         DC    AL3(@ENDDATD-@DATD)                                      03681000
         DS    0D                                                       03682000
ICG209I  DC    H'209'                                                   03683000
ICG210I  DC    H'210'                                                   03684000
ICG211I  DC    H'211'                                                   03685000
ICG212I  DC    H'212'                                                   03686000
ICG243I  DC    H'243'                                                   03687000
ICG246I  DC    H'246'                                                   03688000
@CC00567 DC    C'REAL OR SSID FOR DEV'                                  03689000
@CC00563 DC    C'DEVICE TYPE FOR DEV'                                   03690000
@CC00494 DC    C'SA (2ND PARM)'                                         03691000
@CC00533 DC    C'SDG FOR DEV'                                           03692000
@CC00545 DC    C'LCU FOR DEV'                                           03693000
@CC00550 DC    C'LUA FOR DEV'                                           03694000
@CC00511 DC    C'3330-11='                                              03695000
@CC00509 DC    C'3330-1='                                               03696000
@CC00512 DC    C'3350='                                                 03697000
@CC00518 DC    C'SSID='                                                 03698000
@CC00473 DC    C'CUA='                                                  03699000
@CC00513 EQU   @CC00567                                                 03700000
@CC00570 DC    C'DEVX'                                                  03701000
@CC00471 DC    C'SA='                                                   03702000
@CC00475 EQU   @CC00563                                                 03703000
@CC00481 EQU   @CC00473                                                 03704000
@CC00523 EQU   @CC00550                                                 03705000
@CC00525 EQU   @CC00545                                                 03706000
@CC00527 EQU   @CC00533                                                 03707000
@CC00491 EQU   @CC00494                                                 03708000
@CB00462 DC    X'0000'                                                  03709000
ICGDS219 DC    CL27' ICG219I DUPLICATE KEYWORD '                        03710000
ICGDS220 DC    CL46' ICG220I INVALID PARAMETER LENGTH, KEYWORD IS '     03711000
ICGDS221 DC    CL34' ICG221I MISSING REQUIRED KEYWORD '                 03712000
ICGDS223 DC    CL25' ICG223I VALUE ERROR FOR '                          03713000
ICGDS227 DC    CL51' ICG227I PARAMETER MUST BE HEXADECIMAL. KEYWORD IS C03714000
               '                                                        03715000
ICGDS229 DC    CL37' ICG229I FOR DEVX, USAGE MUST BE REAL'              03716000
ICGDS241 DC    CL36' ICG241I MISSING REQUIRED PARAMETER '               03717000
ICGDS242 DC    CL57' ICG242I LOGICAL DEVICE X FOR SDG XX PREVIOUSLY SPEC03718000
               CIFIED'                                                  03719000
ICGDS244 DC    CL47' ICG244I PHYSICAL DEVICE X PREVIOUSLY SPECIFIED'    03720000
ICGDS245 DC    CL62' ICG245I SDG FOR DEV X PREVIOUSLY SPECIFIED WITH DIC03721000
               FFERENT LCU'                                             03722000
ICGDS247 DC    CL55' ICG247I LOGICAL DEVICE FOR DEV X MUST BE 0, 2, 4, C03723000
               OR 6'                                                    03724000
ICGDS248 DC    CL63' ICG248I SDG XX PREVIOUSLY SPECIFIED TO DIFFERENT SC03725000
               A OR SA PAIR'                                            03726000
PATTERN  DC    CL1'0'                                                   03727000
         DC    CL1'1'                                                   03728000
         DC    CL1'2'                                                   03729000
         DC    CL1'3'                                                   03730000
         DC    CL1'4'                                                   03731000
         DC    CL1'5'                                                   03732000
         DC    CL1'6'                                                   03733000
         DC    CL1'7'                                                   03734000
         DC    CL1'8'                                                   03735000
         DC    CL1'9'                                                   03736000
         DC    CL1'A'                                                   03737000
         DC    CL1'B'                                                   03738000
         DC    CL1'C'                                                   03739000
         DC    CL1'D'                                                   03740000
         DC    CL1'E'                                                   03741000
         DC    CL1'F'                                                   03742000
LOKUPRSG DC    CL2'00'                                                  03743000
         DC    CL2'01'                                                  03744000
         DC    CL2'02'                                                  03745000
         DC    CL2'03'                                                  03746000
         DC    CL2'04'                                                  03747000
         DC    CL2'05'                                                  03748000
         DC    CL2'06'                                                  03749000
         DC    CL2'07'                                                  03750000
         DC    CL2'08'                                                  03751000
         DC    CL2'09'                                                  03752000
         DC    CL2'10'                                                  03753000
         DC    CL2'11'                                                  03754000
         DC    CL2'12'                                                  03755000
         DC    CL2'13'                                                  03756000
         DC    CL2'14'                                                  03757000
         DC    CL2'15'                                                  03758000
         DC    CL2'16'                                                  03759000
         DC    CL2'17'                                                  03760000
         DC    CL2'18'                                                  03761000
         DC    CL2'19'                                                  03762000
         DC    CL2'20'                                                  03763000
         DC    CL2'21'                                                  03764000
         DC    CL2'22'                                                  03765000
         DC    CL2'23'                                                  03766000
         DC    CL2'24'                                                  03767000
         DC    CL2'25'                                                  03768000
         DC    CL2'26'                                                  03769000
         DC    CL2'27'                                                  03770000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       03771000
@01      EQU   01                                                       03772000
@02      EQU   02                                                       03773000
@03      EQU   03                                                       03774000
@04      EQU   04                                                       03775000
@05      EQU   05                                                       03776000
@06      EQU   06                                                       03777000
@07      EQU   07                                                       03778000
@08      EQU   08                                                       03779000
@09      EQU   09                                                       03780000
@10      EQU   10                                                       03781000
@11      EQU   11                                                       03782000
@12      EQU   12                                                       03783000
@13      EQU   13                                                       03784000
@14      EQU   14                                                       03785000
@15      EQU   15                                                       03786000
I        EQU   @02                                                      03787000
R11      EQU   @11                                                      03788000
R10      EQU   @10                                                      03789000
R4       EQU   @04                                                      03790000
COMTAB   EQU   0                                                        03791000
READER   EQU   COMTAB+256                                               03792000
READFLAG EQU   READER+96                                                03793000
KEYBIT   EQU   READFLAG                                                 03794000
PARMBIT  EQU   READFLAG                                                 03795000
ENDSCAN  EQU   READFLAG                                                 03796000
LASTPARM EQU   READFLAG                                                 03797000
PCHBF    EQU   READER+99                                                03798000
STARTCOL EQU   READER+180                                               03799000
NEXTCOL  EQU   READER+184                                               03800000
SAVESCOL EQU   READER+188                                               03801000
SAVENCOL EQU   READER+192                                               03802000
SCANLEN  EQU   READER+204                                               03803000
PRINTER  EQU   COMTAB+464                                               03804000
OUTBUF2  EQU   PRINTER+225                                              03805000
MESSAGES EQU   COMTAB+810                                               03806000
MSGNO    EQU   MESSAGES+2                                               03807000
TERMINAT EQU   MESSAGES+6                                               03808000
SPECLMSG EQU   MESSAGES+18                                              03809000
PRNTBUF2 EQU   SPECLMSG                                                 03810000
GENIO    EQU   COMTAB+832                                               03811000
DCBPTR   EQU   GENIO+4                                                  03812000
COMPTR2  EQU   GENIO+16                                                 03813000
INVOKED  EQU   COMTAB+856                                               03814000
SAVEDDS  EQU   INVOKED+4                                                03815000
BUILDRSG EQU   COMTAB+900                                               03816000
RSGS     EQU   BUILDRSG                                                 03817000
RSG      EQU   RSGS                                                     03818000
RSGABOX  EQU   RSG                                                      03819000
RSGABOX0 EQU   RSGABOX                                                  03820000
RSGABOX1 EQU   RSGABOX                                                  03821000
RSGTODS  EQU   RSG+7                                                    03822000
TODS1    EQU   RSGTODS                                                  03823000
TODS2    EQU   RSGTODS+1                                                03824000
LIBRARY  EQU   COMTAB+1170                                              03825000
LIBS     EQU   LIBRARY                                                  03826000
LIB      EQU   LIBS                                                     03827000
LIBBITS  EQU   LIB                                                      03828000
PABTABLE EQU   COMTAB+1218                                              03829000
PABDEV   EQU   PABTABLE                                                 03830000
PABFLAGS EQU   PABDEV                                                   03831000
PABEXIST EQU   PABFLAGS                                                 03832000
PABIBERG EQU   PABFLAGS                                                 03833000
PABBERG2 EQU   PABFLAGS                                                 03834000
PABREAL  EQU   PABDEV+1                                                 03835000
PABAADDD EQU   PABDEV+2                                                 03836000
DSPAIRS  EQU   COMTAB+1938                                              03837000
PHYSDS2  EQU   DSPAIRS                                                  03838000
PHYSTYPE EQU   COMTAB+2002                                              03839000
PHYSFLGS EQU   PHYSTYPE                                                 03840000
MERLICEB EQU   PHYSFLGS                                                 03841000
PHYSREAL EQU   PHYSFLGS                                                 03842000
PHYSSSID EQU   PHYSFLGS                                                 03843000
LOGABOX1 EQU   PHYSFLGS                                                 03844000
LGDEVICE EQU   PHYSFLGS                                                 03845000
SPNRSGNO EQU   PHYSTYPE+1                                               03846000
CPUASSOC EQU   COMTAB+3026                                              03847000
CPUS     EQU   CPUASSOC+2                                               03848000
CPU      EQU   CPUS                                                     03849000
CPUFLAG1 EQU   CPU+6                                                    03850000
OPSYSTYP EQU   CPUFLAG1                                                 03851000
CPUFLAG2 EQU   CPU+7                                                    03852000
LOWERCON EQU   COMTAB+3156                                              03853000
LOWDSS   EQU   LOWERCON                                                 03854000
LOWFLGS  EQU   LOWDSS                                                   03855000
LIBCTL   EQU   COMTAB+3284                                              03856000
LIBCTLS  EQU   LIBCTL                                                   03857000
CREATE   EQU   COMTAB+3288                                              03858000
@NM00017 EQU   CREATE                                                   03859000
COMTAB2  EQU   0                                                        03860000
DSTORSG  EQU   COMTAB2                                                  03861000
DSENTRY  EQU   DSTORSG                                                  03862000
CONFGCON EQU   COMTAB2+32                                               03863000
RSGUCB   EQU   CONFGCON                                                 03864000
RSGFLAGS EQU   RSGUCB                                                   03865000
CONFGUCB EQU   COMTAB2+464                                              03866000
CONFGDEV EQU   CONFGUCB                                                 03867000
USEFLAGS EQU   CONFGDEV                                                 03868000
ALTPATH1 EQU   CONFGDEV+2                                               03869000
ALTPATH2 EQU   CONFGDEV+5                                               03870000
ALTPATH3 EQU   CONFGDEV+8                                               03871000
SCANDATA EQU   0                                                        03872000
SCANBUF  EQU   0                                                        03873000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    03874000
ALTCH3   EQU   ALTPATH3+2                                               03875000
ALTCI3   EQU   ALTPATH3+1                                               03876000
ALTDS3   EQU   ALTPATH3                                                 03877000
ALTCH2   EQU   ALTPATH2+2                                               03878000
ALTCI2   EQU   ALTPATH2+1                                               03879000
ALTDS2   EQU   ALTPATH2                                                 03880000
ALTCH1   EQU   ALTPATH1+2                                               03881000
ALTCI1   EQU   ALTPATH1+1                                               03882000
ALTDS1   EQU   ALTPATH1                                                 03883000
INDEXRSG EQU   CONFGDEV+1                                               03884000
ICEBERG  EQU   USEFLAGS                                                 03885000
ITISALTP EQU   USEFLAGS                                                 03886000
USECONVR EQU   USEFLAGS                                                 03887000
SUPPUNCH EQU   USEFLAGS                                                 03888000
USEREAL  EQU   USEFLAGS                                                 03889000
USEVS    EQU   USEFLAGS                                                 03890000
USEV     EQU   USEFLAGS                                                 03891000
USESPEC  EQU   USEFLAGS                                                 03892000
RSGCUA   EQU   RSGUCB+8                                                 03893000
RSGCHAN  EQU   RSGUCB+7                                                 03894000
CPUREFNO EQU   RSGUCB+6                                                 03895000
RSGCPUID EQU   RSGUCB+1                                                 03896000
@NM00019 EQU   RSGFLAGS                                                 03897000
CISPEC   EQU   RSGFLAGS                                                 03898000
TORSG2   EQU   DSENTRY+1                                                03899000
TORSG1   EQU   DSENTRY                                                  03900000
COM2BASE EQU   COMTAB+3304                                              03901000
LRUCLOCK EQU   CREATE+11                                                03902000
VOLSER   EQU   CREATE+5                                                 03903000
VPAGES   EQU   CREATE+1                                                 03904000
@NM00018 EQU   @NM00017                                                 03905000
CYLFAULT EQU   @NM00017                                                 03906000
PRNTONLY EQU   @NM00017                                                 03907000
UPDCREAT EQU   @NM00017                                                 03908000
NEWCREAT EQU   @NM00017                                                 03909000
CMDCREAT EQU   @NM00017                                                 03910000
RW67RGHT EQU   LIBCTLS                                                  03911000
RW67LEFT EQU   LIBCTLS                                                  03912000
RW45RGHT EQU   LIBCTLS                                                  03913000
RW45LEFT EQU   LIBCTLS                                                  03914000
RW23RGHT EQU   LIBCTLS                                                  03915000
RW23LEFT EQU   LIBCTLS                                                  03916000
RW01RGHT EQU   LIBCTLS                                                  03917000
RW01LEFT EQU   LIBCTLS                                                  03918000
LOWLIB   EQU   LOWDSS+1                                                 03919000
@NM00016 EQU   LOWFLGS                                                  03920000
LOWRGHT  EQU   LOWFLGS                                                  03921000
LOWLEFT  EQU   LOWFLGS                                                  03922000
LOWRW67  EQU   LOWFLGS                                                  03923000
LOWRW45  EQU   LOWFLGS                                                  03924000
LOWRW23  EQU   LOWFLGS                                                  03925000
LOWRW01  EQU   LOWFLGS                                                  03926000
LOWSPEC  EQU   LOWFLGS                                                  03927000
ALTMSCIN EQU   CPUFLAG2                                                 03928000
@NM00015 EQU   CPUFLAG2                                                 03929000
ALTMSGBF EQU   CPUFLAG2                                                 03930000
@NM00014 EQU   CPUFLAG2                                                 03931000
CPUSPEC  EQU   CPUFLAG2                                                 03932000
CPUMSCIN EQU   CPUFLAG1                                                 03933000
OPJES3   EQU   OPSYSTYP                                                 03934000
OPVS2    EQU   OPSYSTYP                                                 03935000
OPVS1    EQU   OPSYSTYP                                                 03936000
CPUALTFL EQU   CPUFLAG1                                                 03937000
CPUTIGHT EQU   CPUFLAG1                                                 03938000
@NM00013 EQU   CPUFLAG1                                                 03939000
TOMPCPU  EQU   CPU+5                                                    03940000
CPUID    EQU   CPU                                                      03941000
CPUNUM   EQU   CPUASSOC                                                 03942000
PABDDD   EQU   PABAADDD                                                 03943000
PABAA    EQU   PABAADDD                                                 03944000
PABZEROS EQU   PABAADDD                                                 03945000
PAB2D    EQU   PABREAL                                                  03946000
PAB2C    EQU   PABREAL                                                  03947000
PAB2B    EQU   PABREAL                                                  03948000
@NM00012 EQU   PABREAL                                                  03949000
PAB1D    EQU   PABREAL                                                  03950000
PAB1C    EQU   PABREAL                                                  03951000
PAB1B    EQU   PABREAL                                                  03952000
PABIMPLR EQU   PABREAL                                                  03953000
@NM00011 EQU   PABFLAGS                                                 03954000
PABDSMTL EQU   PABFLAGS                                                 03955000
@NM00010 EQU   PABFLAGS                                                 03956000
PABVOVIR EQU   PABFLAGS                                                 03957000
MAPEXIT  EQU   LIB+4                                                    03958000
LIBMAP   EQU   LIB+3                                                    03959000
LIBDSMID EQU   LIB+2                                                    03960000
LIBSIZE  EQU   LIB+1                                                    03961000
@NM00009 EQU   LIBBITS                                                  03962000
LIBSPEC  EQU   LIBBITS                                                  03963000
RSGSLICE EQU   RSG+3                                                    03964000
RSGUDEL  EQU   RSG+2                                                    03965000
RSGLDEL  EQU   RSG+1                                                    03966000
@NM00008 EQU   RSG                                                      03967000
RSGSPEC  EQU   RSG                                                      03968000
SVSYSUT3 EQU   SAVEDDS+32                                               03969000
SVSYSUT2 EQU   SAVEDDS+24                                               03970000
SVSYSUT1 EQU   SAVEDDS+16                                               03971000
SVSYSPCH EQU   SAVEDDS+8                                                03972000
SVSYSIN  EQU   SAVEDDS                                                  03973000
PARMPTR  EQU   INVOKED                                                  03974000
BUILDPTR EQU   GENIO+20                                                 03975000
SAVE14   EQU   GENIO+12                                                 03976000
EXLST    EQU   GENIO+8                                                  03977000
@NM00007 EQU   DCBPTR+1                                                 03978000
DCBFLAG  EQU   DCBPTR                                                   03979000
OPENLIST EQU   GENIO                                                    03980000
@NM00006 EQU   MESSAGES+19                                              03981000
NEEDEOJ  EQU   SPECLMSG                                                 03982000
ENDPHASE EQU   SPECLMSG                                                 03983000
@NM00005 EQU   SPECLMSG                                                 03984000
PRNTCARD EQU   SPECLMSG                                                 03985000
@NM00004 EQU   SPECLMSG                                                 03986000
NEED102  EQU   SPECLMSG                                                 03987000
NEED101  EQU   SPECLMSG                                                 03988000
PRINTRC  EQU   MESSAGES+16                                              03989000
TERM     EQU   MESSAGES+12                                              03990000
WARN     EQU   MESSAGES+8                                               03991000
WARNING  EQU   MESSAGES+4                                               03992000
RETCODE  EQU   MESSAGES                                                 03993000
OUTBUF   EQU   PRINTER+104                                              03994000
LINECT   EQU   PRINTER+102                                              03995000
LINECTR  EQU   PRINTER+100                                              03996000
PAGENO   EQU   PRINTER+96                                               03997000
DCBPRINT EQU   PRINTER                                                  03998000
@NM00003 EQU   READER+206                                               03999000
SVEODAD  EQU   READER+200                                               04000000
SVSYNAD2 EQU   READER+196                                               04001000
INBUF    EQU   READER+100                                               04002000
SSELECT  EQU   PCHBF                                                    04003000
@NM00002 EQU   READER+97                                                04004000
@NM00001 EQU   READFLAG                                                 04005000
READTERM EQU   READFLAG                                                 04006000
READDCB  EQU   READER                                                   04007000
PATCH    EQU   COMTAB                                                   04008000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      04009000
@RT00058 EQU   @EL00003                                                 04010000
@RC00117 EQU   @EL00004                                                 04011000
@RC00212 EQU   @EL00007                                                 04012000
@RF00211 EQU   @EL00007                                                 04013000
@RC00283 EQU   @EL00009                                                 04014000
@RT00325 EQU   @EL00010                                                 04015000
@RC00396 EQU   @EL00013                                                 04016000
@RT00429 EQU   @EL00014                                                 04017000
@RC00564 EQU   @RC00552                                                 04018000
@RC00584 EQU   @RC00583                                                 04019000
@RC00654 EQU   @EL00021                                                 04020000
@RC00646 EQU   @EL00021                                                 04021000
@RT00673 EQU   @EL00022                                                 04022000
@RT00676 EQU   @EL00022                                                 04023000
@RC00696 EQU   @EL00023                                                 04024000
@RC00284 EQU   @RC00283                                                 04025000
@RC00591 EQU   @RC00584                                                 04026000
@RC00647 EQU   @RC00646                                                 04027000
@RC00700 EQU   @RC00696                                                 04028000
@ENDDATA EQU   *                                                        04029000
         END   ICGDSS09,(C'PLS2233',0603,76349)                         04030000
