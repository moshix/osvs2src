         TITLE '***** ICGTRINT - MSS TRACE DATA INTERPRET AND REFORMAT *00001000
                *****   '                                               00002000
ICGTRINT CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'ICGTRINT  77.354'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  LA    @11,4095(,@12)                                      0001 00012000
         LA    @10,4095(,@11)                                      0001 00013000
         LA    @09,4095(,@10)                                      0001 00014000
         USING @PSTART,@12                                         0001 00015000
         USING @PSTART+4095,@11                                    0001 00016000
         USING @PSTART+8190,@10                                    0001 00017000
         USING @PSTART+12285,@09                                   0001 00018000
         L     @00,@SIZDATD                                        0001 00019000
         GETMAIN  R,LV=(0)                                              00020000
         LR    @08,@01                                             0001 00021000
         USING @DATD,@08                                           0001 00022000
         ST    @13,@SA00001+4                                      0001 00023000
         LM    @00,@01,20(@13)                                     0001 00024000
         ST    @08,8(,@13)                                         0001 00025000
         LR    @13,@08                                             0001 00026000
         L     R1,0(R1)                                                 00027000
*   PARMPTR=R1;                     /* SAVE PARMS ADDRESS    @Y30LB40*/ 00028000
         LR    PARMPTR,R1                                          0156 00029000
*   RFY                                                            0157 00030000
*     R1 UNRSTD;                    /*                       @Y30LB40*/ 00031000
*   CALL INIT;                      /* INITIALIZE VALUES     @OZ05079*/ 00032000
         BAL   @14,INIT                                            0158 00033000
*   CALL OPENFILE;                  /* OPEN SYSPRINT, TRACEIN      0159 00034000
*                                                            @OZ05079*/ 00035000
         BAL   @14,OPENFILE                                        0159 00036000
*   IF RETURNCD=4                   /* SYSPRINT NOT OPEN     @OZ05079*/ 00037000
*     THEN                          /*                       @OZ05079*/ 00038000
         CLC   RETURNCD(2),@CH00104                                0160 00039000
         BNE   @RF00160                                            0160 00040000
*     RETURN CODE(4);               /* RETURN, NO MESSAGE    @OZ05079*/ 00041000
         L     @13,4(,@13)                                         0161 00042000
         L     @00,@SIZDATD                                        0161 00043000
         LR    @01,@08                                             0161 00044000
         FREEMAIN R,LV=(0),A=(1)                                        00045000
         LA    @15,4                                               0161 00046000
         L     @14,12(,@13)                                        0161 00047000
         LM    @00,@12,20(@13)                                     0161 00048000
         BR    @14                                                 0161 00049000
*   ELSE                            /*                       @OZ05079*/ 00050000
*     IF RETURNCD=8                 /* TRACEIN NOT OPENED    @OZ05079*/ 00051000
*       THEN                        /*                       @OZ05079*/ 00052000
@RF00160 CLC   RETURNCD(2),@CH00036                                0162 00053000
         BE    @RT00162                                            0162 00054000
*       GO TO CLOSEFIL;             /* CLOSE SYSPRINT        @OZ05079*/ 00055000
*   IF PARMLEN^=0                   /* CHECK IF ANY PARMS    @OZ05079*/ 00056000
*     THEN                          /*                       @OZ05079*/ 00057000
         LH    @06,PARMLEN(,PARMPTR)                               0164 00058000
         LTR   @06,@06                                             0164 00059000
         BZ    @RF00164                                            0164 00060000
*     CALL GETPARMS;                /* IF ANY, GET THEM      @OZ05079*/ 00061000
         BAL   @14,GETPARMS                                        0165 00062000
*   IF RETURNCD=8                   /* INVALID PARMS FOUND   @OZ05079*/ 00063000
*     THEN                          /*                       @OZ05079*/ 00064000
@RF00164 CLC   RETURNCD(2),@CH00036                                0166 00065000
         BE    @RT00166                                            0166 00066000
*     GO TO CLOSEFIL;               /* CLOSE OPEN FILES      @OZ05079*/ 00067000
*   ELSE                            /*                       @OZ05079*/ 00068000
*     IF PARMSW='R'|PARMSW='B'      /* REFORMAT WANTED       @OZ05079*/ 00069000
*       THEN                        /*                       @OZ05079*/ 00070000
         CLI   PARMSW,C'R'                                         0168 00071000
         BE    @RT00168                                            0168 00072000
         CLI   PARMSW,C'B'                                         0168 00073000
         BNE   @RF00168                                            0168 00074000
@RT00168 DS    0H                                                  0169 00075000
*       CALL OPENOUT;               /* OPEN TRACEOUT FILE    @OZ05079*/ 00076000
         BAL   @14,OPENOUT                                         0169 00077000
*   IF RETURNCD=8                   /* TRACEOUT OPEN FAIL    @OZ05079*/ 00078000
*     THEN                          /*                       @OZ05079*/ 00079000
@RF00168 CLC   RETURNCD(2),@CH00036                                0170 00080000
         BE    @RT00170                                            0170 00081000
*     GO TO CLOSEFIL;               /* CLOSE OPEN FILES      @OZ05079*/ 00082000
*   ELSE                                                           0172 00083000
*     ;                             /*                       @OZ05079*/ 00084000
*   RFY                                                            0173 00085000
*    (R0,                                                          0173 00086000
*     R1) RSTD;                     /* GET AND CONVERT TODAYS DATE 0173 00087000
*                                                            @Y30LB40*/ 00088000
*   GEN(TIME);                      /*                       @Y30LB40*/ 00089000
         TIME                                                           00090000
*   GEN(ST    R1,DOUBLEWD);         /*                       @Y30LB40*/ 00091000
         ST    R1,DOUBLEWD                                              00092000
*   RFY                                                            0176 00093000
*    (R0,                                                          0176 00094000
*     R1) UNRSTD;                   /*                       @Y30LB40*/ 00095000
*   UNPK(TODAY,DOUBLEWD(2:4));      /*                       @Y30LB40*/ 00096000
         UNPK  TODAY(5),DOUBLEWD+1(3)                              0177 00097000
*                                                                  0178 00098000
*/********************************************************** @OZ05079*/ 00099000
*/*                                                          @OZ05079*/ 00100000
*/* PROCEDURE NAME - RDTRACE (SUBSECTION OF MAINLINE)        @OZ05079*/ 00101000
*/*                                                          @OZ05079*/ 00102000
*/* FUNCTION - READ A RECORD FROM TRACEIN, AND DETERMINE     @OZ05079*/ 00103000
*/*            WHAT PROCESSING (IF ANY) IS TO BE PERFORMED.  @OZ05079*/ 00104000
*/*            CONTINUE READING RECORDS UNTIL END-OF-FILE    @OZ05079*/ 00105000
*/*            IS ENCOUNTERED, AT WHICH POINT BRANCH (VIA    @OZ05079*/ 00106000
*/*            IOS LOGIC) TO ROUTINE 'EOJ'.                  @OZ05079*/ 00107000
*/*                                                          @OZ05079*/ 00108000
*/********************************************************** @OZ05079*/ 00109000
*                                                                  0178 00110000
*RDTRACE:                           /* READ A RECORD AND COUNT IT  0178 00111000
*                                                            @Y30LB40*/ 00112000
*   RFY                                                            0178 00113000
*    (R0,                                                          0178 00114000
*     R1,                                                          0178 00115000
*     R14,                                                         0178 00116000
*     R15) RSTD;                    /*                       @Y30LB40*/ 00117000
RDTRACE  DS    0H                                                  0179 00118000
*   GEN(GET   INDCB,RECIN);         /*                       @Y30LB40*/ 00119000
         GET   INDCB,RECIN                                              00120000
*   RFY                                                            0180 00121000
*    (R0,                                                          0180 00122000
*     R1,                                                          0180 00123000
*     R14,                                                         0180 00124000
*     R15) UNRSTD;                  /*                       @Y30LB40*/ 00125000
*   RCDCOUNT=RCDCOUNT+1;            /* COUNT INPUT RECORDS   @Y30LB40*/ 00126000
         LA    @06,1                                               0181 00127000
         AL    @06,RCDCOUNT                                        0181 00128000
         ST    @06,RCDCOUNT                                        0181 00129000
*   IF TID^=XID&                    /* CHECK TO SEE IF THE   @OZ11006*/ 00130000
*       TID^=YID|                   /*                       @OZ11006*/ 00131000
*       CYL<LCYL|                   /* RECORD IS A VALID RECORD    0182 00132000
*                                                            @YM31057*/ 00133000
*       HEAD<LHD|                   /* BY CHECKING THE TABLE ID    0182 00134000
*                                                            @YM31057*/ 00135000
*       RECORD<LRD|                 /* AND THE CHR RANGE     @YM31057*/ 00136000
*       CYL>HCYL|                   /*                       @YM31057*/ 00137000
*       HEAD>HHD|                   /*                       @YM31057*/ 00138000
*       RECORD>HRD                  /*                       @YM31057*/ 00139000
*     THEN                          /*                       @YM31057*/ 00140000
         CLI   TID,192                                             0182 00141000
         BE    @GL00006                                            0182 00142000
         CLI   TID,128                                             0182 00143000
         BNE   @RT00182                                            0182 00144000
@GL00006 CLI   CYL,32                                              0182 00145000
         BL    @RT00182                                            0182 00146000
         CLI   RECORD,1                                            0182 00147000
         BL    @RT00182                                            0182 00148000
         CLI   CYL,39                                              0182 00149000
         BH    @RT00182                                            0182 00150000
         CLI   HEAD,18                                             0182 00151000
         BH    @RT00182                                            0182 00152000
         CLI   RECORD,32                                           0182 00153000
         BH    @RT00182                                            0182 00154000
*     GO TO RDTRACE;                /* GO TO NEXT ROUTINE    @YM31057*/ 00155000
*   IF LIBRID='11111111'B           /* IF TRAILER RECORD     @OZ05079*/ 00156000
*       &PARMSW^='R'                /* NOT REFORMAT ONLY     @OZ05079*/ 00157000
*     THEN                          /*                       @OZ05079*/ 00158000
         CLI   LIBRID,B'11111111'                                  0184 00159000
         BNE   @RF00184                                            0184 00160000
         CLI   PARMSW,C'R'                                         0184 00161000
         BE    @RF00184                                            0184 00162000
*     DO;                           /*                       @OZ05079*/ 00163000
*       CALL BLOCK;                 /* PRINT FILE TRAILER    @OZ05079*/ 00164000
         BAL   @14,BLOCK                                           0186 00165000
*       GO TO RDTRACE;              /* READ ANOTHER RECORD   @OZ05079*/ 00166000
         B     RDTRACE                                             0187 00167000
*     END;                          /*                       @OZ05079*/ 00168000
*   IF LIBRID='10000000'B           /* HEADER RECORD         @Y30LB40*/ 00169000
*     THEN                                                         0189 00170000
@RF00184 CLI   LIBRID,B'10000000'                                  0189 00171000
         BNE   @RF00189                                            0189 00172000
*     DO;                           /*                       @Y30LB40*/ 00173000
*       CALL PROCREC6;              /* PROCESS FILE HEADER   @OZ05079*/ 00174000
         BAL   @14,PROCREC6                                        0191 00175000
*       GO TO RDTRACE;              /* READ ANOTHER RECORD   @OZ05079*/ 00176000
         B     RDTRACE                                             0192 00177000
*     END;                          /*                       @OZ05079*/ 00178000
*   ELSE                                                           0194 00179000
*     ;                             /*                       @OZ05079*/ 00180000
@RF00189 DS    0H                                                  0195 00181000
*   IF IMLCNT<IMLSAVE               /* CHECK FOR MATCHING IML COUNT     00182000
*                                                            @ZA25867*/ 00183000
*     THEN                          /*                       @ZA25867*/ 00184000
         CLC   IMLCNT(2),IMLSAVE                                   0195 00185000
         BNL   @RF00195                                            0195 00186000
*     DO;                           /*                       @ZA25867*/ 00187000
*       IMLFLAG=FLAGONE;            /*                       @ZA25867*/ 00188000
         MVC   IMLFLAG(1),FLAGONE                                  0197 00189000
*       GO TO RDTRACE;              /* SKIP RECORD IF NO MATCH     0198 00190000
*                                                            @ZA25867*/ 00191000
         B     RDTRACE                                             0198 00192000
*     END;                          /*                       @ZA25867*/ 00193000
*/*  ******************************************************* @ZA13497*/ 00194000
*/*   IF SELECT SPECIFIC VOLID OR SDG SPECIFIED, CHECK       @ZA13497*/ 00195000
*/*   FOR MATCH TO SELECTED ITEM.  IF NO MATCH, READ         @ZA13497*/ 00196000
*/*   NEXT RECORD.                                           @ZA13497*/ 00197000
*/*  ******************************************************* @ZA13497*/ 00198000
*                                                                  0200 00199000
*   RSPINDGP(1)='0'B;               /*                       @ZA13497*/ 00200000
@RF00195 DS    0H                                                  0201 00201000
*   RSPINDGP(2)='0'B;               /*                       @ZA13497*/ 00202000
*   RSPINDGP(3)='0'B;               /*                       @ZA13497*/ 00203000
         NI    RSPINDGP,B'00011111'                                0202 00204000
*   IF SDGSELSW='1'B                /*                       @ZA13497*/ 00205000
*     THEN                          /*                       @ZA13497*/ 00206000
         TM    SDGSELSW,B'10000000'                                0203 00207000
         BNO   @RF00203                                            0203 00208000
*     IF HOLDSDG^=RSPINDGP          /*                       @ZA13497*/ 00209000
*       THEN                        /*                       @ZA13497*/ 00210000
         CLC   HOLDSDG(1),RSPINDGP                                 0204 00211000
         BNE   @RT00204                                            0204 00212000
*       GO TO RDTRACE;              /*                       @ZA13497*/ 00213000
*   IF VOLSELSW='1'B                /*                       @ZA13497*/ 00214000
*       &HOLDVOL(1:1+LENVOLID)^=VOLID/*                      @ZA13497*/ 00215000
*     THEN                          /*                       @ZA13497*/ 00216000
@RF00203 TM    VOLSELSW,B'10000000'                                0206 00217000
         BNO   @RF00206                                            0206 00218000
         LH    @06,LENVOLID                                        0206 00219000
         EX    @06,@SC01278                                        0206 00220000
         BNE   @RT00206                                            0206 00221000
*     GO TO RDTRACE;                /*                       @ZA13497*/ 00222000
*   IF MINIPTR='00000000'B          /* IF CURRENT MINIPTR 0 BYPASS 0208 00223000
*                                      RECORD                        */ 00224000
*     THEN                                                         0208 00225000
@RF00206 CLI   MINIPTR,B'00000000'                                 0208 00226000
         BE    @RT00208                                            0208 00227000
*     GO TO RDTRACE;                /*                       @Y30LB40*/ 00228000
*   IF PARMSW='I'                   /* INTERPRET ONLY        @Y30LB40*/ 00229000
*     THEN                          /*                       @OZ05079*/ 00230000
         CLI   PARMSW,C'I'                                         0210 00231000
         BNE   @RF00210                                            0210 00232000
*     DO;                           /*                       @OZ05079*/ 00233000
*       CALL BLOCK;                 /* PRINT                 @OZ05079*/ 00234000
         BAL   @14,BLOCK                                           0212 00235000
*       GO TO RDTRACE;              /* READ ANOTHER RECORD   @OZ05079*/ 00236000
         B     RDTRACE                                             0213 00237000
*     END;                          /*                       @OZ05079*/ 00238000
*   ELSE                            /*                       @OZ05079*/ 00239000
*     DO;                           /*                       @OZ05079*/ 00240000
@RF00210 DS    0H                                                  0216 00241000
*       CALL REFORMAT;              /* BUILD OUTPUT RECORD   @OZ05079*/ 00242000
         BAL   @14,REFORMAT                                        0216 00243000
*       IF PARMSW='B'               /* IF INTERPRET ALSO     @OZ05079*/ 00244000
*         THEN                      /*                       @OZ05079*/ 00245000
         CLI   PARMSW,C'B'                                         0217 00246000
         BNE   @RF00217                                            0217 00247000
*         CALL BLOCK;               /* PRINT                 @OZ05079*/ 00248000
         BAL   @14,BLOCK                                           0218 00249000
*       GO TO RDTRACE;              /* READ ANOTHER RECORD   @OZ05079*/ 00250000
         B     RDTRACE                                             0219 00251000
*     END;                                                         0220 00252000
*                                                                  0221 00253000
*/********************************************************************  00254000
*                                                                    */ 00255000
*/* END OF JOB PROCESSING ROUTINE                            @Y30LB40*/ 00256000
*/********************************************************************  00257000
*                                                                    */ 00258000
*                                                                  0221 00259000
*EOJ:                                                              0221 00260000
*   CALL NEWPAGE;                   /*                       @Y30LB40*/ 00261000
EOJ      BAL   @14,NEWPAGE                                         0221 00262000
*   BLKLINE=DTLHDR;                 /*                       @Y30LB40*/ 00263000
         MVC   BLKLINE(121),DTLHDR                                 0222 00264000
*   OPT=PARMSW;                     /* PRINT OUT PARM OPTION & RCD 0223 00265000
*                                      COUNT                         */ 00266000
         MVC   OPT(1),PARMSW                                       0223 00267000
*   CALL EDITFIX(ADDR(HLDSYR),1,'N');/*                      @Y30LB40*/ 00268000
         MVC   @AL00001+4(8),@AL00224                              0224 00269000
         LA    @06,HLDSYR                                          0224 00270000
         ST    @06,@AFTEMPS+20                                     0224 00271000
         LA    @06,@AFTEMPS+20                                     0224 00272000
         ST    @06,@AL00001                                        0224 00273000
         LA    @01,@AL00001                                        0224 00274000
         BAL   @14,EDITFIX                                         0224 00275000
*   UDATE1(1:2)=FIXOUT(12:13);      /*                       @Y30LB40*/ 00276000
         MVC   UDATE1(2),FIXOUT+11                                 0225 00277000
*   CALL EDITFIX(ADDR(HLDSDAY),2,'N');/*                     @Y30LB40*/ 00278000
         MVC   @AL00001+4(8),@AL00226                              0226 00279000
         LA    @06,HLDSDAY                                         0226 00280000
         ST    @06,@AFTEMPS+20                                     0226 00281000
         LA    @06,@AFTEMPS+20                                     0226 00282000
         ST    @06,@AL00001                                        0226 00283000
         LA    @01,@AL00001                                        0226 00284000
         BAL   @14,EDITFIX                                         0226 00285000
*   UDATE1(3:5)=FIXOUT(11:13);      /*                       @Y30LB40*/ 00286000
         MVC   UDATE1+2(3),FIXOUT+10                               0227 00287000
*   CALL EDITFIX(ADDR(HLDEYR),1,'N');/*                      @Y30LB40*/ 00288000
         MVC   @AL00001+4(8),@AL00228                              0228 00289000
         LA    @06,HLDEYR                                          0228 00290000
         ST    @06,@AFTEMPS+20                                     0228 00291000
         LA    @06,@AFTEMPS+20                                     0228 00292000
         ST    @06,@AL00001                                        0228 00293000
         LA    @01,@AL00001                                        0228 00294000
         BAL   @14,EDITFIX                                         0228 00295000
*   UDATE2(1:2)=FIXOUT(12:13);      /*                       @Y30LB40*/ 00296000
         MVC   UDATE2(2),FIXOUT+11                                 0229 00297000
*   CALL EDITFIX(ADDR(HLDEDAY),2,'N');/*                     @Y30LB40*/ 00298000
         MVC   @AL00001+4(8),@AL00230                              0230 00299000
         LA    @06,HLDEDAY                                         0230 00300000
         ST    @06,@AFTEMPS+20                                     0230 00301000
         LA    @06,@AFTEMPS+20                                     0230 00302000
         ST    @06,@AL00001                                        0230 00303000
         LA    @01,@AL00001                                        0230 00304000
         BAL   @14,EDITFIX                                         0230 00305000
*   UDATE2(3:5)=FIXOUT(11:13);      /*                       @Y30LB40*/ 00306000
         MVC   UDATE2+2(3),FIXOUT+10                               0231 00307000
*   DAYS=HLDSTIME;                  /*                       @Y30LB40*/ 00308000
         L     @06,HLDSTIME                                        0232 00309000
         ST    @06,DAYS                                            0232 00310000
*   CALL CONVERTM;                  /*                       @Y30LB40*/ 00311000
         BAL   @14,CONVERTM                                        0233 00312000
*   CALL EDITFIX(ADDR(HOUR),2,'N'); /*                       @Y30LB40*/ 00313000
         MVC   @AL00001+4(8),@AL00234                              0234 00314000
         LA    @06,HOUR                                            0234 00315000
         ST    @06,@AFTEMPS+20                                     0234 00316000
         LA    @06,@AFTEMPS+20                                     0234 00317000
         ST    @06,@AL00001                                        0234 00318000
         LA    @01,@AL00001                                        0234 00319000
         BAL   @14,EDITFIX                                         0234 00320000
*   UTIME1(1:2)=FIXOUT(12:13);      /*                       @Y30LB40*/ 00321000
         MVC   UTIME1(2),FIXOUT+11                                 0235 00322000
*   CALL EDITFIX(ADDR(MINUTE),2,'N');/*                      @Y30LB40*/ 00323000
         MVC   @AL00001+4(8),@AL00236                              0236 00324000
         LA    @06,MINUTE                                          0236 00325000
         ST    @06,@AFTEMPS+20                                     0236 00326000
         LA    @06,@AFTEMPS+20                                     0236 00327000
         ST    @06,@AL00001                                        0236 00328000
         LA    @01,@AL00001                                        0236 00329000
         BAL   @14,EDITFIX                                         0236 00330000
*   UTIME1(3:4)=FIXOUT(12:13);      /*                       @Y30LB40*/ 00331000
         MVC   UTIME1+2(2),FIXOUT+11                               0237 00332000
*   DAYS=HLDETIME;                  /*                       @Y30LB40*/ 00333000
         L     @06,HLDETIME                                        0238 00334000
         ST    @06,DAYS                                            0238 00335000
*   CALL CONVERTM;                  /*                       @Y30LB40*/ 00336000
         BAL   @14,CONVERTM                                        0239 00337000
*   CALL EDITFIX(ADDR(HOUR),2,'N'); /*                       @Y30LB40*/ 00338000
         MVC   @AL00001+4(8),@AL00240                              0240 00339000
         LA    @06,HOUR                                            0240 00340000
         ST    @06,@AFTEMPS+20                                     0240 00341000
         LA    @06,@AFTEMPS+20                                     0240 00342000
         ST    @06,@AL00001                                        0240 00343000
         LA    @01,@AL00001                                        0240 00344000
         BAL   @14,EDITFIX                                         0240 00345000
*   UTIME2(1:2)=FIXOUT(12:13);      /*                       @Y30LB40*/ 00346000
         MVC   UTIME2(2),FIXOUT+11                                 0241 00347000
*   CALL EDITFIX(ADDR(MINUTE),2,'N');/*                      @Y30LB40*/ 00348000
         MVC   @AL00001+4(8),@AL00242                              0242 00349000
         LA    @06,MINUTE                                          0242 00350000
         ST    @06,@AFTEMPS+20                                     0242 00351000
         LA    @06,@AFTEMPS+20                                     0242 00352000
         ST    @06,@AL00001                                        0242 00353000
         LA    @01,@AL00001                                        0242 00354000
         BAL   @14,EDITFIX                                         0242 00355000
*   UTIME2(3:4)=FIXOUT(12:13);      /*                       @Y30LB40*/ 00356000
         MVC   UTIME2+2(2),FIXOUT+11                               0243 00357000
*   CALL EDITFIX(ADDR(RCDCOUNT),4,'S');/*                    @Y30LB40*/ 00358000
         MVC   @AL00001+4(8),@AL00244                              0244 00359000
         LA    @06,RCDCOUNT                                        0244 00360000
         ST    @06,@AFTEMPS+20                                     0244 00361000
         LA    @06,@AFTEMPS+20                                     0244 00362000
         ST    @06,@AL00001                                        0244 00363000
         LA    @01,@AL00001                                        0244 00364000
         BAL   @14,EDITFIX                                         0244 00365000
*   INCNT=FIXOUT(8:13);             /*                       @Y30LB40*/ 00366000
         MVC   INCNT(6),FIXOUT+7                                   0245 00367000
*   CALL EDITFIX(ADDR(OUTCOUNT),4,'S');/*                    @Y30LB40*/ 00368000
         MVC   @AL00001+4(8),@AL00246                              0246 00369000
         LA    @06,OUTCOUNT                                        0246 00370000
         ST    @06,@AFTEMPS+20                                     0246 00371000
         LA    @06,@AFTEMPS+20                                     0246 00372000
         ST    @06,@AL00001                                        0246 00373000
         LA    @01,@AL00001                                        0246 00374000
         BAL   @14,EDITFIX                                         0246 00375000
*   OUTCNT=FIXOUT(8:13);            /*                       @Y30LB40*/ 00376000
         MVC   OUTCNT(6),FIXOUT+7                                  0247 00377000
*   IF SDGSELSW='1'B                /*                       @ZA13497*/ 00378000
*     THEN                          /*                       @ZA13497*/ 00379000
         TM    SDGSELSW,B'10000000'                                0248 00380000
         BNO   @RF00248                                            0248 00381000
*     SELECTID=SDGSAVE;             /*                       @ZA13497*/ 00382000
         MVC   SELECTID(6),SDGSAVE                                 0249 00383000
*   ELSE                            /*                       @ZA13497*/ 00384000
*     IF VOLSELSW='1'B              /*                       @ZA13497*/ 00385000
*       THEN                        /*                       @ZA13497*/ 00386000
         B     @RC00248                                            0250 00387000
@RF00248 TM    VOLSELSW,B'10000000'                                0250 00388000
         BNO   @RF00250                                            0250 00389000
*       DO;                         /*                       @ZA13497*/ 00390000
*         SELECTID='******';        /*                       @ZA13497*/ 00391000
         MVC   SELECTID(6),@CC01086                                0252 00392000
*         SELECTID(1:1+LENVOLID)=HOLDVOL;/*                  @ZA13497*/ 00393000
         LH    @06,LENVOLID                                        0253 00394000
         EX    @06,@SM01280                                        0253 00395000
*       END;                        /*                       @ZA13497*/ 00396000
*     ELSE                          /*                       @ZA13497*/ 00397000
*       SELECTID='NONE  ';          /*                       @ZA13497*/ 00398000
         B     @RC00250                                            0255 00399000
@RF00250 MVC   SELECTID(6),@CC01087                                0255 00400000
*   RFY                                                            0256 00401000
*    (R0,                                                          0256 00402000
*     R1,                                                          0256 00403000
*     R14,                                                         0256 00404000
*     R15) RSTD;                    /*                       @Y30LB40*/ 00405000
@RC00250 DS    0H                                                  0256 00406000
@RC00248 DS    0H                                                  0257 00407000
*   GEN(PUT   PRNTDCB,DTLCOUNT);    /*                       @Y30LB40*/ 00408000
         PUT   PRNTDCB,DTLCOUNT                                         00409000
*   GEN(PUT   PRNTDCB,DATEHDR2);    /*                       @Y30LB40*/ 00410000
         PUT   PRNTDCB,DATEHDR2                                         00411000
*   RFY                                                            0259 00412000
*    (R0,                                                          0259 00413000
*     R1,                                                          0259 00414000
*     R14,                                                         0259 00415000
*     R15) UNRSTD;                  /*                       @Y30LB40*/ 00416000
*   LINECNT=LINECNT+5;              /*                       @Y30LB40*/ 00417000
         AL    LINECNT,@CF00376                                    0260 00418000
*   DO I=1 TO 750;                  /* LOOP THROUGH ARRAY    @OZ11013*/ 00419000
         LA    I,1                                                 0261 00420000
@DL00261 DS    0H                                                  0262 00421000
*     IF DATECNT(I)^=0              /* PRINT NON 0 BUCKETS   @OZ09557*/ 00422000
*       THEN                                                       0262 00423000
         LR    @15,I                                               0262 00424000
         SLA   @15,4                                               0262 00425000
         L     @14,DATECNT-16(@15)                                 0262 00426000
         LTR   @14,@14                                             0262 00427000
         BZ    @RF00262                                            0262 00428000
*       DO;                         /*                       @Y30LB40*/ 00429000
*         DATELINE=' ';             /*                       @Y30LB40*/ 00430000
         MVI   DATELINE+1,C' '                                     0264 00431000
         MVC   DATELINE+2(119),DATELINE+1                          0264 00432000
         MVI   DATELINE,C' '                                       0264 00433000
*         CALL EDITFIX(ADDR(DATECNT(I)),4,'S');/*            @OZ09557*/ 00434000
         MVC   @AL00001+4(8),@AL00265                              0265 00435000
         LA    @15,DATECNT-16(@15)                                 0265 00436000
         ST    @15,@AFTEMPS+20                                     0265 00437000
         LA    @15,@AFTEMPS+20                                     0265 00438000
         ST    @15,@AL00001                                        0265 00439000
         LA    @01,@AL00001                                        0265 00440000
         BAL   @14,EDITFIX                                         0265 00441000
*         DLF18=FIXOUT(8:13);       /*                       @Y30LB40*/ 00442000
         MVC   DLF18(6),FIXOUT+7                                   0266 00443000
*         CALL EDITFIX(ADDR(STOREJUL(I)),2,'N');/*           @OZ09557*/ 00444000
         MVC   @AL00001+4(8),@AL00267                              0267 00445000
         LR    @15,I                                               0267 00446000
         SLA   @15,4                                               0267 00447000
         LA    @15,STOREJUL-16(@15)                                0267 00448000
         ST    @15,@AFTEMPS+20                                     0267 00449000
         LA    @15,@AFTEMPS+20                                     0267 00450000
         ST    @15,@AL00001                                        0267 00451000
         LA    @01,@AL00001                                        0267 00452000
         BAL   @14,EDITFIX                                         0267 00453000
*         DLF10A=FIXOUT(11:13);     /*                       @Y30LB40*/ 00454000
         MVC   DLF10A(3),FIXOUT+10                                 0268 00455000
*         CALL EDITFIX(ADDR(STOREYR(I)),2,'N');/*            @OZ09557*/ 00456000
         MVC   @AL00001+4(8),@AL00269                              0269 00457000
         LR    @15,I                                               0269 00458000
         SLA   @15,4                                               0269 00459000
         LA    @15,STOREYR-16(@15)                                 0269 00460000
         ST    @15,@AFTEMPS+20                                     0269 00461000
         LA    @15,@AFTEMPS+20                                     0269 00462000
         ST    @15,@AL00001                                        0269 00463000
         LA    @01,@AL00001                                        0269 00464000
         BAL   @14,EDITFIX                                         0269 00465000
*         DLF10=FIXOUT(12:13);      /*                       @Y30LB40*/ 00466000
         MVC   DLF10(2),FIXOUT+11                                  0270 00467000
*         DAYS=STORETIM(I);         /*                       @OZ09557*/ 00468000
         LR    @15,I                                               0271 00469000
         SLA   @15,4                                               0271 00470000
         L     @15,STORETIM-16(@15)                                0271 00471000
         ST    @15,DAYS                                            0271 00472000
*         CALL CONVERTM;            /*                       @Y30LB40*/ 00473000
         BAL   @14,CONVERTM                                        0272 00474000
*         CALL EDITFIX(ADDR(HOUR),2,'N');/*                  @Y30LB40*/ 00475000
         MVC   @AL00001+4(8),@AL00273                              0273 00476000
         LA    @15,HOUR                                            0273 00477000
         ST    @15,@AFTEMPS+20                                     0273 00478000
         LA    @15,@AFTEMPS+20                                     0273 00479000
         ST    @15,@AL00001                                        0273 00480000
         LA    @01,@AL00001                                        0273 00481000
         BAL   @14,EDITFIX                                         0273 00482000
*         DLF12=FIXOUT(12:13);      /*                       @Y30LB40*/ 00483000
         MVC   DLF12(2),FIXOUT+11                                  0274 00484000
*         CALL EDITFIX(ADDR(MINUTE),2,'N');/*                @Y30LB40*/ 00485000
         MVC   @AL00001+4(8),@AL00275                              0275 00486000
         LA    @15,MINUTE                                          0275 00487000
         ST    @15,@AFTEMPS+20                                     0275 00488000
         LA    @15,@AFTEMPS+20                                     0275 00489000
         ST    @15,@AL00001                                        0275 00490000
         LA    @01,@AL00001                                        0275 00491000
         BAL   @14,EDITFIX                                         0275 00492000
*         DLF14=FIXOUT(12:13);      /*                       @Y30LB40*/ 00493000
         MVC   DLF14(2),FIXOUT+11                                  0276 00494000
*         CALL EDITFIX(ADDR(SECOND),2,'N');/*                @Y30LB40*/ 00495000
         MVC   @AL00001+4(8),@AL00277                              0277 00496000
         LA    @15,SECOND                                          0277 00497000
         ST    @15,@AFTEMPS+20                                     0277 00498000
         LA    @15,@AFTEMPS+20                                     0277 00499000
         ST    @15,@AL00001                                        0277 00500000
         LA    @01,@AL00001                                        0277 00501000
         BAL   @14,EDITFIX                                         0277 00502000
*         DLF16=FIXOUT(12:13);      /*                       @Y30LB40*/ 00503000
         MVC   DLF16(2),FIXOUT+11                                  0278 00504000
*         DAYS=STOREDSM(I)/86400;   /* CALCULATE MSC DAY     @OZ09557*/ 00505000
         LR    @15,I                                               0279 00506000
         SLA   @15,4                                               0279 00507000
         L     @00,STOREDSM-16(@15)                                0279 00508000
         SRDA  @00,32                                              0279 00509000
         D     @00,@CF01088                                        0279 00510000
         ST    @01,DAYS                                            0279 00511000
*         CALL EDITFIX(ADDR(DAYS),4,'S');/*                  @Y30LB40*/ 00512000
         MVC   @AL00001+4(8),@AL00280                              0280 00513000
         LA    @15,DAYS                                            0280 00514000
         ST    @15,@AFTEMPS+20                                     0280 00515000
         LA    @15,@AFTEMPS+20                                     0280 00516000
         ST    @15,@AL00001                                        0280 00517000
         LA    @01,@AL00001                                        0280 00518000
         BAL   @14,EDITFIX                                         0280 00519000
*         DLF2=FIXOUT(12:13);       /*                       @Y30LB40*/ 00520000
         MVC   DLF2(2),FIXOUT+11                                   0281 00521000
*         DAYS=STOREDSM(I)-(DAYS*86400);/* SET UP TIME       @OZ09557*/ 00522000
         LR    @15,I                                               0282 00523000
         SLA   @15,4                                               0282 00524000
         L     @01,DAYS                                            0282 00525000
         M     @00,@CF01088                                        0282 00526000
         LCR   @01,@01                                             0282 00527000
         AL    @01,STOREDSM-16(@15)                                0282 00528000
         ST    @01,DAYS                                            0282 00529000
*         CALL CONVERTM;            /*                       @Y30LB40*/ 00530000
         BAL   @14,CONVERTM                                        0283 00531000
*         CALL EDITFIX(ADDR(HOUR),2,'N');/*                  @Y30LB40*/ 00532000
         MVC   @AL00001+4(8),@AL00284                              0284 00533000
         LA    @15,HOUR                                            0284 00534000
         ST    @15,@AFTEMPS+20                                     0284 00535000
         LA    @15,@AFTEMPS+20                                     0284 00536000
         ST    @15,@AL00001                                        0284 00537000
         LA    @01,@AL00001                                        0284 00538000
         BAL   @14,EDITFIX                                         0284 00539000
*         DLF4=FIXOUT(12:13);       /*                       @Y30LB40*/ 00540000
         MVC   DLF4(2),FIXOUT+11                                   0285 00541000
*         CALL EDITFIX(ADDR(MINUTE),2,'N');/*                @Y30LB40*/ 00542000
         MVC   @AL00001+4(8),@AL00286                              0286 00543000
         LA    @15,MINUTE                                          0286 00544000
         ST    @15,@AFTEMPS+20                                     0286 00545000
         LA    @15,@AFTEMPS+20                                     0286 00546000
         ST    @15,@AL00001                                        0286 00547000
         LA    @01,@AL00001                                        0286 00548000
         BAL   @14,EDITFIX                                         0286 00549000
*         DLF6=FIXOUT(12:13);       /*                       @Y30LB40*/ 00550000
         MVC   DLF6(2),FIXOUT+11                                   0287 00551000
*         CALL EDITFIX(ADDR(SECOND),2,'N');/*                @Y30LB40*/ 00552000
         MVC   @AL00001+4(8),@AL00288                              0288 00553000
         LA    @15,SECOND                                          0288 00554000
         ST    @15,@AFTEMPS+20                                     0288 00555000
         LA    @15,@AFTEMPS+20                                     0288 00556000
         ST    @15,@AL00001                                        0288 00557000
         LA    @01,@AL00001                                        0288 00558000
         BAL   @14,EDITFIX                                         0288 00559000
*         DLF8=FIXOUT(12:13);       /*                       @Y30LB40*/ 00560000
         MVC   DLF8(2),FIXOUT+11                                   0289 00561000
*         RFY                                                      0290 00562000
*          (R0,                                                    0290 00563000
*           R1,                                                    0290 00564000
*           R14,                                                   0290 00565000
*           R15) RSTD;              /*                       @Y30LB40*/ 00566000
*         GEN(PUT   PRNTDCB,DATELINE);/*                     @Y30LB40*/ 00567000
         PUT   PRNTDCB,DATELINE                                         00568000
*         GEN(PUT   PRNTDCB,ICGTR906);/*                     @ZA25867*/ 00569000
         PUT   PRNTDCB,ICGTR906                                         00570000
*         RFY                                                      0293 00571000
*          (R0,                                                    0293 00572000
*           R1,                                                    0293 00573000
*           R14,                                                   0293 00574000
*           R15) UNRSTD;            /*                       @Y30LB40*/ 00575000
*         LINECNT=LINECNT+1;        /*                       @Y30LB40*/ 00576000
         AL    LINECNT,@CF00045                                    0294 00577000
*         IF LINECNT>55 THEN                                       0295 00578000
         C     LINECNT,@CF01089                                    0295 00579000
         BNH   @RF00295                                            0295 00580000
*           CALL NEWPAGE;           /*                       @Y30LB40*/ 00581000
         BAL   @14,NEWPAGE                                         0296 00582000
*       END;                        /*                       @Y30LB40*/ 00583000
@RF00295 DS    0H                                                  0298 00584000
*   END;                            /*                       @Y30LB40*/ 00585000
@RF00262 AL    I,@CF00045                                          0298 00586000
         C     I,@CF01035                                          0298 00587000
         BNH   @DL00261                                            0298 00588000
*CLOSEFIL:                                                         0299 00589000
*   IF PARMSW='R'|PARMSW='B' THEN                                  0299 00590000
CLOSEFIL CLI   PARMSW,C'R'                                         0299 00591000
         BE    @RT00299                                            0299 00592000
         CLI   PARMSW,C'B'                                         0299 00593000
         BNE   @RF00299                                            0299 00594000
@RT00299 DS    0H                                                  0300 00595000
*     IF PARMERR='0'B               /* WAS OUTPUT DCB OPENED         */ 00596000
*       THEN                                                       0300 00597000
         TM    PARMERR,B'10000000'                                 0300 00598000
         BNZ   @RF00300                                            0300 00599000
*       DO;                         /* YES                   @Y30LB40*/ 00600000
*         RFY                                                      0302 00601000
*          (R0,                                                    0302 00602000
*           R1,                                                    0302 00603000
*           R14,                                                   0302 00604000
*           R15) RSTD;              /*                       @Y30LB40*/ 00605000
*         GEN(CLOSE OUTDCB,MF=(E,OPENCLOS));/* CLOSE OUTPUT DCB      */ 00606000
         CLOSE OUTDCB,MF=(E,OPENCLOS)                                   00607000
*         RFY                                                      0304 00608000
*          (R0,                                                    0304 00609000
*           R1,                                                    0304 00610000
*           R14,                                                   0304 00611000
*           R15) UNRSTD;            /*                       @Y30LB40*/ 00612000
*       END;                        /*                       @Y30LB40*/ 00613000
*   RFY                                                            0306 00614000
*    (R0,                                                          0306 00615000
*     R1,                                                          0306 00616000
*     R14,                                                         0306 00617000
*     R15) RSTD;                    /*                       @Y30LB40*/ 00618000
@RF00300 DS    0H                                                  0306 00619000
@RF00299 DS    0H                                                  0307 00620000
*   GEN(CLOSE INDCB,MF=(E,OPENCLOS));/* CLOSE INPUT DCB      @Y30LB40*/ 00621000
         CLOSE INDCB,MF=(E,OPENCLOS)                                    00622000
*   GEN(CLOSE PRNTDCB,MF=(E,OPENCLOS));/* CLOSE PRINT DCB    @Y30LB40*/ 00623000
         CLOSE PRNTDCB,MF=(E,OPENCLOS)                                  00624000
*   RFY                                                            0309 00625000
*    (R0,                                                          0309 00626000
*     R1,                                                          0309 00627000
*     R14,                                                         0309 00628000
*     R15) UNRSTD;                  /*                       @Y30LB40*/ 00629000
*   RETURN CODE(RETURNCD);          /* GO TO STEP TERMINATOR @Y30LB40*/ 00630000
         LH    @07,RETURNCD                                        0310 00631000
         L     @13,4(,@13)                                         0310 00632000
         L     @00,@SIZDATD                                        0310 00633000
         LR    @01,@08                                             0310 00634000
         FREEMAIN R,LV=(0),A=(1)                                        00635000
         LR    @15,@07                                             0310 00636000
         L     @14,12(,@13)                                        0310 00637000
         LM    @00,@12,20(@13)                                     0310 00638000
         BR    @14                                                 0310 00639000
*                                                                  0311 00640000
*/********************************************************** @OZ05079*/ 00641000
*/*                                                          @OZ05079*/ 00642000
*/* PROCEDURE NAME - INIT                                    @OZ05079*/ 00643000
*/*                                                          @OZ05079*/ 00644000
*/* FUNCTION - INITIALIZE LOCAL VARIABLES                    @OZ05079*/ 00645000
*/*                                                          @OZ05079*/ 00646000
*/********************************************************** @OZ05079*/ 00647000
*                                                                  0311 00648000
*INIT:                                                             0311 00649000
*   PROCEDURE;                      /*                       @OZ05079*/ 00650000
INIT     STM   @14,@06,12(@13)                                     0311 00651000
         STM   @08,@12,52(@13)                                     0311 00652000
*   RCDCOUNT=0;                     /* INITIALIZE VARIABLES  @Y30LB40*/ 00653000
         SLR   @06,@06                                             0312 00654000
         ST    @06,RCDCOUNT                                        0312 00655000
*   OUTCOUNT=0;                     /*                       @Y30LB40*/ 00656000
         ST    @06,OUTCOUNT                                        0313 00657000
*   DAYS=0;                         /*                       @Y30LB40*/ 00658000
         ST    @06,DAYS                                            0314 00659000
*   RETURNCD=0;                     /*                       @Y30LB40*/ 00660000
         STH   @06,RETURNCD                                        0315 00661000
*   M=0;                            /*                       @Y30LB40*/ 00662000
         STH   @06,M                                               0316 00663000
*   N=0;                            /*                       @OZ11013*/ 00664000
         STH   @06,N                                               0317 00665000
*   HOUR=0;                         /*                       @Y30LB40*/ 00666000
         STH   @06,HOUR                                            0318 00667000
*   MINUTE=0;                       /*                       @Y30LB40*/ 00668000
         STH   @06,MINUTE                                          0319 00669000
*   SECOND=0;                       /*                       @Y30LB40*/ 00670000
         STH   @06,SECOND                                          0320 00671000
*   LINECNT=56;                     /*                       @Y30LB40*/ 00672000
         LA    LINECNT,56                                          0321 00673000
*   OPENCLOS=0;                     /*                       @Y30LB40*/ 00674000
         ST    @06,OPENCLOS                                        0322 00675000
*   LENVOLID=0;                     /*                       @ZA13497*/ 00676000
         STH   @06,LENVOLID                                        0323 00677000
*   OPCLB1='10000000'B;             /*                       @Y30LB40*/ 00678000
         MVI   OPCLB1,B'10000000'                                  0324 00679000
*   PAGECNT=0;                      /*                       @Y30LB40*/ 00680000
         STH   @06,PAGECNT                                         0325 00681000
*   CONVERT=0;                      /*                       @Y30LB40*/ 00682000
         STH   @06,CONVERT                                         0326 00683000
*   HLDSYR=0;                       /*                       @Y30LB40*/ 00684000
         MVI   HLDSYR,X'00'                                        0327 00685000
*   HLDSDAY=1;                      /*                       @Y30LB40*/ 00686000
         LA    @15,1                                               0328 00687000
         STH   @15,HLDSDAY                                         0328 00688000
*   HLDSTIME=0;                     /*                       @Y30LB40*/ 00689000
         ST    @06,HLDSTIME                                        0329 00690000
*   HLDEYR=99;                      /*                       @Y30LB40*/ 00691000
         MVI   HLDEYR,X'63'                                        0330 00692000
*   HLDEDAY=365;                    /*                       @Y30LB40*/ 00693000
         MVC   HLDEDAY(2),@CH01095                                 0331 00694000
*   HLDETIME=86399;                 /*                       @Y30LB40*/ 00695000
         MVC   HLDETIME(4),@CF01096                                0332 00696000
*   PARMSW='R';                     /*                       @Y30LB40*/ 00697000
         MVI   PARMSW,C'R'                                         0333 00698000
*   FRSTSW='1'B;                    /*                       @Y30LB40*/ 00699000
         OI    FRSTSW,B'10000000'                                  0334 00700000
*   MINI1SW='1'B;                   /*                       @Y30LB40*/ 00701000
         OI    MINI1SW,B'10000000'                                 0335 00702000
*   SDGSELSW='0'B;                  /*                       @ZA13497*/ 00703000
         NI    SDGSELSW,B'01111111'                                0336 00704000
*   VOLSELSW='0'B;                  /*                       @ZA13497*/ 00705000
         NI    VOLSELSW,B'01111111'                                0337 00706000
*   PARMERR='0'B;                   /*                       @Y30LB40*/ 00707000
         NI    PARMERR,B'01111111'                                 0338 00708000
*   DATEINSW='0'B;                  /*                       @Y30LB40*/ 00709000
         NI    DATEINSW,B'01111111'                                0339 00710000
*   HOSTYEAR=0;                     /*                       @OZ09557*/ 00711000
         STH   @06,HOSTYEAR                                        0340 00712000
*   HOSTJUL=0;                      /*                       @OZ09557*/ 00713000
         STH   @06,HOSTJUL                                         0341 00714000
*   HOSTTME=0;                      /*                       @OZ09557*/ 00715000
         ST    @06,HOSTTME                                         0342 00716000
*   HDRTME=0;                       /*                       @OZ09557*/ 00717000
         ST    @06,HDRTME                                          0343 00718000
*   INCNT1=0;                       /*                       @ZA17158*/ 00719000
         STH   @06,INCNT1                                          0344 00720000
*   IMLSAVE=FOXES;                  /*                       @ZA16141*/ 00721000
         MVC   IMLSAVE(2),FOXES                                    0345 00722000
*   IMLFLAG=0;                      /*                       @ZA25867*/ 00723000
         MVI   IMLFLAG,X'00'                                       0346 00724000
*   DO I=1 TO 750;                  /*                       @OZ09557*/ 00725000
         LR    I,@15                                               0347 00726000
@DL00347 DS    0H                                                  0348 00727000
*     STOREYR(I)=0;                 /*                       @OZ09557*/ 00728000
         SLR   @15,@15                                             0348 00729000
         LR    @14,I                                               0348 00730000
         SLA   @14,4                                               0348 00731000
         STH   @15,STOREYR-16(@14)                                 0348 00732000
*     STOREJUL(I)=0;                /*                       @OZ09557*/ 00733000
         STH   @15,STOREJUL-16(@14)                                0349 00734000
*     STORETIM(I)=0;                /*                       @OZ09557*/ 00735000
         ST    @15,STORETIM-16(@14)                                0350 00736000
*     STOREDSM(I)=0;                /*                       @OZ09557*/ 00737000
         ST    @15,STOREDSM-16(@14)                                0351 00738000
*     DATECNT(I)=0;                 /*                       @OZ09557*/ 00739000
         ST    @15,DATECNT-16(@14)                                 0352 00740000
*   END;                            /*                       @Y30LB40*/ 00741000
         AL    I,@CF00045                                          0353 00742000
         C     I,@CF01035                                          0353 00743000
         BNH   @DL00347                                            0353 00744000
*   END INIT;                       /*                       @OZ05079*/ 00745000
@EL00002 DS    0H                                                  0354 00746000
@EF00002 DS    0H                                                  0354 00747000
@ER00002 LM    @14,@06,12(@13)                                     0354 00748000
         LM    @08,@12,52(@13)                                     0354 00749000
         BR    @14                                                 0354 00750000
*                                                                  0355 00751000
*/********************************************************** @OZ05079*/ 00752000
*/*                                                          @OZ05079*/ 00753000
*/* PROCEDURE NAME - OPENFILE                                @OZ05079*/ 00754000
*/*                                                          @OZ05079*/ 00755000
*/* FUNCTION - SET UP DCBS FOR SYSPRINT, TRACEIN, AND        @OZ05079*/ 00756000
*/*            TRACEOUT.  IF SYSPRINT CANNOT BE OPENED,      @OZ05079*/ 00757000
*/*            SET A RETURN CODE OF 4 AND RETURN TO THE      @OZ05079*/ 00758000
*/*            MAINLINE.  IF TRACEIN CANNOT BE OPENED,       @OZ05079*/ 00759000
*/*            WRITE MSG 'ICG901I OPEN ERROR FOR TRACEIN',   @OZ05079*/ 00760000
*/*            SET A RETURN CODE OF 8 AND RETURN TO THE      @OZ05079*/ 00761000
*/*            MAINLINE.                                     @OZ05079*/ 00762000
*/*                                                          @OZ05079*/ 00763000
*/********************************************************** @OZ05079*/ 00764000
*                                                                  0355 00765000
*OPENFILE:                                                         0355 00766000
*   PROCEDURE;                      /*                       @OZ05079*/ 00767000
OPENFILE STM   @14,@12,@SA00003                                    0355 00768000
*   GEN(MVC   PRNTDCB(PDCBL),PPATDCB);/* SETUP PRINT DCB     @Y30LB40*/ 00769000
         MVC   PRNTDCB(PDCBL),PPATDCB                                   00770000
*   GEN(MVC   INDCB(IDCBL),IPATDCB);/* SETUP INPUT DCB       @Y30LB40*/ 00771000
         MVC   INDCB(IDCBL),IPATDCB                                     00772000
*   GEN(MVC   OUTDCB(ODCBL),OPATDCB);/* SETUP OUTPUT DCB     @Y30LB40*/ 00773000
         MVC   OUTDCB(ODCBL),OPATDCB                                    00774000
*   RFY                                                            0359 00775000
*    (R0,                                                          0359 00776000
*     R1,                                                          0359 00777000
*     R14,                                                         0359 00778000
*     R15) RSTD;                    /*                       @Y30LB40*/ 00779000
*   GEN(OPEN  (PRNTDCB,(OUTPUT)),MF=(E,OPENCLOS));/* OPEN PRINT DCB  */ 00780000
         OPEN  (PRNTDCB,(OUTPUT)),MF=(E,OPENCLOS)                       00781000
*   RFY                                                            0361 00782000
*    (R0,                                                          0361 00783000
*     R1,                                                          0361 00784000
*     R14,                                                         0361 00785000
*     R15) UNRSTD;                  /*                       @Y30LB40*/ 00786000
*   IF(PRNTDCB(49:49)&'00010000'B)^='00010000'B/* WAS OPEN OK        */ 00787000
*     THEN                                                         0362 00788000
         MVC   @TS00001(1),PRNTDCB+48                              0362 00789000
         NI    @TS00001,B'00010000'                                0362 00790000
         CLI   @TS00001,B'00010000'                                0362 00791000
         BE    @RF00362                                            0362 00792000
*     DO;                           /* NO,EXIT WITH                  */ 00793000
*       RETURNCD=4;                 /* RC=4                  @OZ05079*/ 00794000
         MVC   RETURNCD(2),@CH00104                                0364 00795000
*       RETURN;                     /* RETURN TO MAINLINE    @OZ05079*/ 00796000
@EL00003 DS    0H                                                  0365 00797000
@EF00003 DS    0H                                                  0365 00798000
@ER00003 LM    @14,@12,@SA00003                                    0365 00799000
         BR    @14                                                 0365 00800000
*     END;                          /*                       @Y30LB40*/ 00801000
*   RFY                                                            0367 00802000
*    (R0,                                                          0367 00803000
*     R1,                                                          0367 00804000
*     R14,                                                         0367 00805000
*     R15) RSTD;                    /*                       @Y30LB40*/ 00806000
@RF00362 DS    0H                                                  0368 00807000
*   GEN(OPEN  (INDCB,(INPUT)),MF=(E,OPENCLOS));/* OPEN INPUT DCB     */ 00808000
         OPEN  (INDCB,(INPUT)),MF=(E,OPENCLOS)                          00809000
*   RFY                                                            0369 00810000
*    (R0,                                                          0369 00811000
*     R1,                                                          0369 00812000
*     R14,                                                         0369 00813000
*     R15) UNRSTD;                  /*                       @Y30LB40*/ 00814000
*   IF(INDCB(49:49)&'00010000'B)^='00010000'B/* WAS OPEN OK          */ 00815000
*     THEN                                                         0370 00816000
         MVC   @TS00001(1),INDCB+48                                0370 00817000
         NI    @TS00001,B'00010000'                                0370 00818000
         CLI   @TS00001,B'00010000'                                0370 00819000
         BE    @RF00370                                            0370 00820000
*     DO;                           /* NO                    @Y30LB40*/ 00821000
*       BLKLINE=TRINMSG;            /* PRINT ERROR MSG               */ 00822000
         MVI   BLKLINE+31,C' '                                     0372 00823000
         MVC   BLKLINE+32(89),BLKLINE+31                           0372 00824000
         MVC   BLKLINE(31),TRINMSG                                 0372 00825000
*       RFY                                                        0373 00826000
*        (R0,                                                      0373 00827000
*         R1,                                                      0373 00828000
*         R14,                                                     0373 00829000
*         R15) RSTD;                /*                       @Y30LB40*/ 00830000
*       GEN(PUT   PRNTDCB,BLKLINE); /*                       @Y30LB40*/ 00831000
         PUT   PRNTDCB,BLKLINE                                          00832000
*       RFY                                                        0375 00833000
*        (R0,                                                      0375 00834000
*         R1,                                                      0375 00835000
*         R14,                                                     0375 00836000
*         R15) UNRSTD;              /*                       @Y30LB40*/ 00837000
*       RETURNCD=8;                 /* EXIT WITH RC=8                */ 00838000
         MVC   RETURNCD(2),@CH00036                                0376 00839000
*     END;                          /*                       @Y30LB40*/ 00840000
*   END OPENFILE;                   /*                       @OZ05079*/ 00841000
         B     @EL00003                                            0378 00842000
*                                                                  0379 00843000
*/********************************************************** @OZ05079*/ 00844000
*/*                                                          @OZ05079*/ 00845000
*/* PROCEDURE NAME - GETPARMS                                @OZ05079*/ 00846000
*/*                                                          @OZ05079*/ 00847000
*/* FUNCTION - SCAN THE PARAMETERS PASSED IN THE PARM FIELD  @OZ05079*/ 00848000
*/*            OF THE EXEC STATEMENT FOR VALID PARAMETERS.   @OZ05079*/ 00849000
*/*            IF AN INVALID PARAMETER IS FOUND, WRITE MSG   @OZ05079*/ 00850000
*/*            'ICG900I INVALID PARM VALUES, SET A RETURN    @OZ05079*/ 00851000
*/*            CODE OF 8, AND RETURN TO THE MAINLINE.  IF    @OZ05079*/ 00852000
*/*            PARAMETERS ARE GOOD, RETURN TO MAINLINE WITH  @OZ05079*/ 00853000
*/*            RETURN CODE OF ZERO.                          @OZ05079*/ 00854000
*/*                                                          @OZ05079*/ 00855000
*/********************************************************** @OZ05079*/ 00856000
*                                                                  0379 00857000
*GETPARMS:                                                         0379 00858000
*   PROCEDURE;                      /*                       @OZ05079*/ 00859000
GETPARMS STM   @14,@12,@SA00004                                    0379 00860000
*   IF PARMLEN>28                   /* TOO MANY PARMS        @ZA13497*/ 00861000
*     THEN                                                         0380 00862000
         LH    @02,PARMLEN(,PARMPTR)                               0380 00863000
         C     @02,@CF00869                                        0380 00864000
         BNH   @RF00380                                            0380 00865000
*     DO;                           /* YES                   @Y30LB40*/ 00866000
*       PARMERR='1'B;               /* SET ERROR SWITCH AND GET OUT  */ 00867000
         OI    PARMERR,B'10000000'                                 0382 00868000
*       GO TO PARMEND;              /*                       @Y30LB40*/ 00869000
         B     PARMEND                                             0383 00870000
*     END;                          /*                       @Y30LB40*/ 00871000
*   PARMHOLD(1:1)=',';              /* SET PARM HOLD TO COMMAS     0385 00872000
*                                                            @Y30LB40*/ 00873000
@RF00380 MVI   PARMHOLD,C','                                       0385 00874000
*   MVC(PARMHOLD(2:29),PARMHOLD);   /*                       @ZA13497*/ 00875000
         MVC   PARMHOLD+1(28),PARMHOLD                             0386 00876000
*   SS=1;                           /* SET SUBSTRING VALUE TO 1    0387 00877000
*                                                            @Y30LB40*/ 00878000
         LA    SS,1                                                0387 00879000
*   PARMHOLD(1:PARMLEN)=PARMS;      /*                       @Y30LB40*/ 00880000
         LH    @02,PARMLEN(,PARMPTR)                               0388 00881000
         BCTR  @02,0                                               0388 00882000
         EX    @02,@SM01283                                        0388 00883000
*   IF PARMHOLD(1:1)=','            /* IS OPTION ENTERED     @Y30LB40*/ 00884000
*     THEN                                                         0389 00885000
         CLI   PARMHOLD,C','                                       0389 00886000
         BNE   @RF00389                                            0389 00887000
*     SS=2;                         /* NO, BUMP POINTER      @Y30LB40*/ 00888000
         LA    SS,2                                                0390 00889000
*   ELSE                                                           0391 00890000
*     DO;                           /* YES, CHECK VALUE      @Y30LB40*/ 00891000
         B     @RC00389                                            0391 00892000
@RF00389 DS    0H                                                  0392 00893000
*       IF PARMHOLD(1:1)='I'|PARMHOLD(1:1)='R'|PARMHOLD(1:1)='B'/* 0392 00894000
*                                      WAS IS I R OR D       @Y30LB40*/ 00895000
*         THEN                                                     0392 00896000
         CLI   PARMHOLD,C'I'                                       0392 00897000
         BE    @RT00392                                            0392 00898000
         CLI   PARMHOLD,C'R'                                       0392 00899000
         BE    @RT00392                                            0392 00900000
         CLI   PARMHOLD,C'B'                                       0392 00901000
         BNE   @RF00392                                            0392 00902000
@RT00392 DS    0H                                                  0393 00903000
*         DO;                       /* YES SAVE IT           @Y30LB40*/ 00904000
*           PARMSW=PARMHOLD(1:1);   /*                       @Y30LB40*/ 00905000
         MVC   PARMSW(1),PARMHOLD                                  0394 00906000
*           SS=3;                   /* SET POINTER TO NEXT VALUE   0395 00907000
*                                                            @Y30LB40*/ 00908000
         LA    SS,3                                                0395 00909000
*         END;                      /*                       @Y30LB40*/ 00910000
*       ELSE                                                       0397 00911000
*         DO;                       /* WAS NOT I R OR D      @Y30LB40*/ 00912000
         B     @RC00392                                            0397 00913000
@RF00392 DS    0H                                                  0398 00914000
*           PARMERR='1'B;           /* SET ERROR SWITCH AND GET OUT  */ 00915000
         OI    PARMERR,B'10000000'                                 0398 00916000
*           GO TO PARMEND;          /*                       @Y30LB40*/ 00917000
         B     PARMEND                                             0399 00918000
*         END;                      /*                       @Y30LB40*/ 00919000
*     END;                          /*                       @Y30LB40*/ 00920000
@RC00392 DS    0H                                                  0402 00921000
*   IF PARMHOLD(SS:SS)=','          /* WERE DATES ENTERED    @Y30LB40*/ 00922000
*     THEN                                                         0402 00923000
@RC00389 LA    @03,PARMHOLD-1(SS)                                  0402 00924000
         CLI   0(@03),C','                                         0402 00925000
         BNE   @RF00402                                            0402 00926000
*     SS=SS+1;                      /* NO,BUMP POINTER       @Y30LB40*/ 00927000
         AL    SS,@CF00045                                         0403 00928000
*   ELSE                                                           0404 00929000
*     DO;                           /* YES,VALIDATE AND CONVERT THEM    00930000
*                                                            @Y30LB40*/ 00931000
         B     @RC00402                                            0404 00932000
@RF00402 DS    0H                                                  0405 00933000
*       DO I=SS TO(SS+9);           /* CHECK FOR NUMBERS 0 THRU 9  0405 00934000
*                                                            @Y30LB40*/ 00935000
         LR    I,SS                                                0405 00936000
         B     @DE00405                                            0405 00937000
@DL00405 DS    0H                                                  0406 00938000
*         IF PARMHOLD(I:I)>='0'&PARMHOLD(I:I)<='9' THEN            0406 00939000
         LA    @07,PARMHOLD-1(I)                                   0406 00940000
         CLI   0(@07),C'0'                                         0406 00941000
         BL    @RF00406                                            0406 00942000
         LA    @07,PARMHOLD-1(I)                                   0406 00943000
         CLI   0(@07),C'9'                                         0406 00944000
         BNH   @RT00406                                            0406 00945000
*           ;                       /*                       @Y30LB40*/ 00946000
*         ELSE                                                     0408 00947000
*           PARMERR='1'B;           /* NON NUMERIC FOUND     @Y30LB40*/ 00948000
@RF00406 OI    PARMERR,B'10000000'                                 0408 00949000
*       END;                        /*                       @Y30LB40*/ 00950000
@RT00406 AL    I,@CF00045                                          0409 00951000
@DE00405 LA    @07,9                                               0409 00952000
         ALR   @07,SS                                              0409 00953000
         CR    I,@07                                               0409 00954000
         BNH   @DL00405                                            0409 00955000
*       IF PARMERR='1'B THEN                                       0410 00956000
         TM    PARMERR,B'10000000'                                 0410 00957000
         BO    @RT00410                                            0410 00958000
*         GO TO PARMEND;            /* IF ERROR FOUND GET OUT        */ 00959000
*       PACK(DOUBLEWD,PARMHOLD(SS:SS+1));/* NO ERROR,CONVERT DATES   */ 00960000
         LA    @03,PARMHOLD-1(SS)                                  0412 00961000
         PACK  DOUBLEWD(8),0(2,@03)                                0412 00962000
*       CVB(HLDSYR,DOUBLEWD);       /*                       @Y30LB40*/ 00963000
         CVB   @03,DOUBLEWD                                        0413 00964000
         STC   @03,HLDSYR                                          0413 00965000
*       PACK(DOUBLEWD,PARMHOLD(SS+2:SS+4));/*                @Y30LB40*/ 00966000
         LA    @03,PARMHOLD+1(SS)                                  0414 00967000
         PACK  DOUBLEWD(8),0(3,@03)                                0414 00968000
*       CVB(HLDSDAY,DOUBLEWD);      /*                       @Y30LB40*/ 00969000
         CVB   @03,DOUBLEWD                                        0415 00970000
         STH   @03,HLDSDAY                                         0415 00971000
*       PACK(DOUBLEWD,PARMHOLD(SS+5:SS+6));/*                @Y30LB40*/ 00972000
         LA    @01,PARMHOLD+4(SS)                                  0416 00973000
         PACK  DOUBLEWD(8),0(2,@01)                                0416 00974000
*       CVB(HLDEYR,DOUBLEWD);       /*                       @Y30LB40*/ 00975000
         CVB   @15,DOUBLEWD                                        0417 00976000
         STC   @15,HLDEYR                                          0417 00977000
*       PACK(DOUBLEWD,PARMHOLD(SS+7:SS+9));/*                @Y30LB40*/ 00978000
         LA    @01,PARMHOLD+6(SS)                                  0418 00979000
         PACK  DOUBLEWD(8),0(3,@01)                                0418 00980000
*       CVB(HLDEDAY,DOUBLEWD);      /*                       @Y30LB40*/ 00981000
         CVB   @15,DOUBLEWD                                        0419 00982000
         STH   @15,HLDEDAY                                         0419 00983000
*       IF HLDSDAY>0&HLDSDAY<366    /* IS DATE FROM 001 THRU 365     */ 00984000
*         THEN                                                     0420 00985000
         LTR   @03,@03                                             0420 00986000
         BNP   @RF00420                                            0420 00987000
         C     @03,@CF01110                                        0420 00988000
         BL    @RT00420                                            0420 00989000
*         ;                         /* YES DONT CHECK FOR LEAP YEAR  */ 00990000
*       ELSE                                                       0422 00991000
*         DO;                       /*                       @Y30LB40*/ 00992000
@RF00420 DS    0H                                                  0423 00993000
*           IF HLDSDAY=366          /* IS DAY 366            @Y30LB40*/ 00994000
*             THEN                                                 0423 00995000
         CLC   HLDSDAY(2),@CH01110                                 0423 00996000
         BNE   @RF00423                                            0423 00997000
*             DO;                   /* YES, CHECK FOR LEAP YEAR      */ 00998000
*               IF(CKSTIME(1:1)&'00000011'B)^='00000000'B THEN     0425 00999000
         MVC   @TS00001(1),CKSTIME                                 0425 01000000
         NI    @TS00001,B'00000011'                                0425 01001000
         CLI   @TS00001,B'00000000'                                0425 01002000
         BE    @RF00425                                            0425 01003000
*                 PARMERR='1'B;     /* ERROR, NOT LEAP YEAR          */ 01004000
         OI    PARMERR,B'10000000'                                 0426 01005000
*             END;                  /*                       @Y30LB40*/ 01006000
*           ELSE                                                   0428 01007000
*             PARMERR='1'B;         /* ERROR, DAY=000 OR >366        */ 01008000
         B     @RC00423                                            0428 01009000
@RF00423 OI    PARMERR,B'10000000'                                 0428 01010000
*         END;                      /*                       @Y30LB40*/ 01011000
@RC00423 DS    0H                                                  0430 01012000
*       IF HLDEDAY>0&HLDEDAY<366    /* SAME CHECKS AS FOR START DATE */ 01013000
*         THEN                                                     0430 01014000
@RT00420 LH    @03,HLDEDAY                                         0430 01015000
         LTR   @03,@03                                             0430 01016000
         BNP   @RF00430                                            0430 01017000
         C     @03,@CF01110                                        0430 01018000
         BL    @RT00430                                            0430 01019000
*         ;                         /*                       @Y30LB40*/ 01020000
*       ELSE                                                       0432 01021000
*         DO;                       /*                       @Y30LB40*/ 01022000
@RF00430 DS    0H                                                  0433 01023000
*           IF HLDEDAY=366 THEN                                    0433 01024000
         CLC   HLDEDAY(2),@CH01110                                 0433 01025000
         BNE   @RF00433                                            0433 01026000
*             DO;                   /*                       @Y30LB40*/ 01027000
*               IF(CKETIME(1:1)&'00000011'B)^='00000000'B THEN     0435 01028000
         MVC   @TS00001(1),CKETIME                                 0435 01029000
         NI    @TS00001,B'00000011'                                0435 01030000
         CLI   @TS00001,B'00000000'                                0435 01031000
         BE    @RF00435                                            0435 01032000
*                 PARMERR='1'B;     /*                       @Y30LB40*/ 01033000
         OI    PARMERR,B'10000000'                                 0436 01034000
*             END;                  /*                       @Y30LB40*/ 01035000
*           ELSE                                                   0438 01036000
*             PARMERR='1'B;         /*                       @Y30LB40*/ 01037000
         B     @RC00433                                            0438 01038000
@RF00433 OI    PARMERR,B'10000000'                                 0438 01039000
*         END;                      /*                       @Y30LB40*/ 01040000
@RC00433 DS    0H                                                  0440 01041000
*       IF HLDSYR<=HLDEYR           /* IS START YEAR <= END YEAR   0440 01042000
*                                                            @Y30LB40*/ 01043000
*         THEN                                                     0440 01044000
@RT00430 CLC   HLDSYR(1),HLDEYR                                    0440 01045000
         BNH   @RT00440                                            0440 01046000
*         ;                         /* YES,OK                @Y30LB40*/ 01047000
*       ELSE                                                       0442 01048000
*         PARMERR='1'B;             /* NO,ERROR AND GETOUT   @Y30LB40*/ 01049000
         OI    PARMERR,B'10000000'                                 0442 01050000
*       IF HLDSDAY<=HLDEDAY         /* IS START DAY <= END DAY     0443 01051000
*                                                            @Y30LB40*/ 01052000
*         THEN                                                     0443 01053000
@RT00440 LH    @03,HLDSDAY                                         0443 01054000
         CH    @03,HLDEDAY                                         0443 01055000
         BNH   @RT00443                                            0443 01056000
*         ;                         /* YES,OK                @Y30LB40*/ 01057000
*       ELSE                                                       0445 01058000
*         DO;                       /* NO, CHECK FOR DIFFERENT YEARS */ 01059000
*           IF HLDSYR=HLDEYR THEN                                  0446 01060000
         CLC   HLDSYR(1),HLDEYR                                    0446 01061000
         BNE   @RF00446                                            0446 01062000
*             PARMERR='1'B;         /* ERROR                 @Y30LB40*/ 01063000
         OI    PARMERR,B'10000000'                                 0447 01064000
*         END;                      /*                       @Y30LB40*/ 01065000
@RF00446 DS    0H                                                  0449 01066000
*       IF PARMERR='1'B THEN                                       0449 01067000
@RT00443 TM    PARMERR,B'10000000'                                 0449 01068000
         BO    @RT00449                                            0449 01069000
*         GO TO PARMEND;            /* IF ERRORS FOUND GETOUT        */ 01070000
*       DATEINSW='1'B;              /* INDICATE VALID DATES ENTERED     01071000
*                                                            @Y30LB40*/ 01072000
         OI    DATEINSW,B'10000000'                                0451 01073000
*       SS=SS+11;                   /* BUMP POINTER TO NEXT VALUE  0452 01074000
*                                                            @Y30LB40*/ 01075000
         AL    SS,@CF00033                                         0452 01076000
*     END;                          /*                       @Y30LB40*/ 01077000
*   IF PARMHOLD(SS:SS)=','          /* WERE TIMES ENTERED    @Y30LB40*/ 01078000
*     THEN                          /*                       @ZA13497*/ 01079000
@RC00402 LA    @03,PARMHOLD-1(SS)                                  0454 01080000
         CLI   0(@03),C','                                         0454 01081000
         BNE   @RF00454                                            0454 01082000
*     SS=SS+1;                      /*                       @ZA13497*/ 01083000
         AL    SS,@CF00045                                         0455 01084000
*   ELSE                                                           0456 01085000
*     DO;                           /* YES,CHECK FOR NUMERICS      0456 01086000
*                                                            @Y30LB40*/ 01087000
         B     @RC00454                                            0456 01088000
@RF00454 DS    0H                                                  0457 01089000
*       DO I=SS TO(SS+7);           /*                       @Y30LB40*/ 01090000
         LR    I,SS                                                0457 01091000
         B     @DE00457                                            0457 01092000
@DL00457 DS    0H                                                  0458 01093000
*         IF PARMHOLD(I:I)>='0'&PARMHOLD(I:I)<='9' THEN            0458 01094000
         LA    @07,PARMHOLD-1(I)                                   0458 01095000
         CLI   0(@07),C'0'                                         0458 01096000
         BL    @RF00458                                            0458 01097000
         LA    @07,PARMHOLD-1(I)                                   0458 01098000
         CLI   0(@07),C'9'                                         0458 01099000
         BNH   @RT00458                                            0458 01100000
*           ;                       /*                       @Y30LB40*/ 01101000
*         ELSE                                                     0460 01102000
*           PARMERR='1'B;           /* ERROR,NONNUMERIC FOUND      0460 01103000
*                                                            @Y30LB40*/ 01104000
@RF00458 OI    PARMERR,B'10000000'                                 0460 01105000
*       END;                        /*                       @Y30LB40*/ 01106000
@RT00458 AL    I,@CF00045                                          0461 01107000
@DE00457 LA    @07,7                                               0461 01108000
         ALR   @07,SS                                              0461 01109000
         CR    I,@07                                               0461 01110000
         BNH   @DL00457                                            0461 01111000
*       IF PARMERR='1'B THEN                                       0462 01112000
         TM    PARMERR,B'10000000'                                 0462 01113000
         BO    @RT00462                                            0462 01114000
*         GO TO PARMEND;            /* IF ERROR FOUND GETOUT         */ 01115000
*       PACK(DOUBLEWD,PARMHOLD(SS:SS+1));/* CONVERT TIMES    @Y30LB40*/ 01116000
         LA    @01,PARMHOLD-1(SS)                                  0464 01117000
         PACK  DOUBLEWD(8),0(2,@01)                                0464 01118000
*       CVB(TIMEWORK,DOUBLEWD);     /*                       @Y30LB40*/ 01119000
         CVB   TIMEWORK,DOUBLEWD                                   0465 01120000
*       IF TIMEWORK>23 THEN                                        0466 01121000
         C     TIMEWORK,@CF01111                                   0466 01122000
         BNH   @RF00466                                            0466 01123000
*         PARMERR='1'B;             /* HOUR > 23 = ERROR             */ 01124000
         OI    PARMERR,B'10000000'                                 0467 01125000
*       ELSE                                                       0468 01126000
*         HLDSTIME=TIMEWORK*3600;   /*                       @Y30LB40*/ 01127000
         B     @RC00466                                            0468 01128000
@RF00466 LR    @15,TIMEWORK                                        0468 01129000
         MH    @15,@CH01112                                        0468 01130000
         ST    @15,HLDSTIME                                        0468 01131000
*       PACK(DOUBLEWD,PARMHOLD(SS+2:SS+3));/*                @Y30LB40*/ 01132000
@RC00466 LA    @01,PARMHOLD+1(SS)                                  0469 01133000
         PACK  DOUBLEWD(8),0(2,@01)                                0469 01134000
*       CVB(TIMEWORK,DOUBLEWD);     /*                       @Y30LB40*/ 01135000
         CVB   TIMEWORK,DOUBLEWD                                   0470 01136000
*       IF TIMEWORK>59 THEN                                        0471 01137000
         C     TIMEWORK,@CF01113                                   0471 01138000
         BNH   @RF00471                                            0471 01139000
*         PARMERR='1'B;             /* MINUTE > 59 = ERROR           */ 01140000
         OI    PARMERR,B'10000000'                                 0472 01141000
*       ELSE                                                       0473 01142000
*         HLDSTIME=HLDSTIME+(TIMEWORK*60);/*                 @Y30LB40*/ 01143000
         B     @RC00471                                            0473 01144000
@RF00471 LR    @15,TIMEWORK                                        0473 01145000
         MH    @15,@CH00339                                        0473 01146000
         AL    @15,HLDSTIME                                        0473 01147000
         ST    @15,HLDSTIME                                        0473 01148000
*       PACK(DOUBLEWD,PARMHOLD(SS+4:SS+5));/*                @Y30LB40*/ 01149000
@RC00471 LA    @01,PARMHOLD+3(SS)                                  0474 01150000
         PACK  DOUBLEWD(8),0(2,@01)                                0474 01151000
*       CVB(TIMEWORK,DOUBLEWD);     /*                       @Y30LB40*/ 01152000
         CVB   TIMEWORK,DOUBLEWD                                   0475 01153000
*       IF TIMEWORK>23 THEN                                        0476 01154000
         C     TIMEWORK,@CF01111                                   0476 01155000
         BNH   @RF00476                                            0476 01156000
*         PARMERR='1'B;             /* HOUR > 23 = ERROR             */ 01157000
         OI    PARMERR,B'10000000'                                 0477 01158000
*       ELSE                                                       0478 01159000
*         HLDETIME=TIMEWORK*3600;   /*                       @Y30LB40*/ 01160000
         B     @RC00476                                            0478 01161000
@RF00476 LR    @15,TIMEWORK                                        0478 01162000
         MH    @15,@CH01112                                        0478 01163000
         ST    @15,HLDETIME                                        0478 01164000
*       PACK(DOUBLEWD,PARMHOLD(SS+6:SS+7));/*                @Y30LB40*/ 01165000
@RC00476 LA    @01,PARMHOLD+5(SS)                                  0479 01166000
         PACK  DOUBLEWD(8),0(2,@01)                                0479 01167000
*       CVB(TIMEWORK,DOUBLEWD);     /*                       @Y30LB40*/ 01168000
         CVB   TIMEWORK,DOUBLEWD                                   0480 01169000
*       IF TIMEWORK>59 THEN                                        0481 01170000
         C     TIMEWORK,@CF01113                                   0481 01171000
         BNH   @RF00481                                            0481 01172000
*         PARMERR='1'B;             /* MINUTE > 59 = ERROR           */ 01173000
         OI    PARMERR,B'10000000'                                 0482 01174000
*       ELSE                                                       0483 01175000
*         HLDETIME=HLDETIME+(TIMEWORK*60)+59;/*              @Y30LB40*/ 01176000
         B     @RC00481                                            0483 01177000
@RF00481 LR    @15,TIMEWORK                                        0483 01178000
         MH    @15,@CH00339                                        0483 01179000
         AL    @15,HLDETIME                                        0483 01180000
         AL    @15,@CF01113                                        0483 01181000
         ST    @15,HLDETIME                                        0483 01182000
*       IF HLDSYR=HLDEYR&HLDSDAY=HLDEDAY/* CHECK TIMES       @Y30LB40*/ 01183000
*         THEN                                                     0484 01184000
@RC00481 CLC   HLDSYR(1),HLDEYR                                    0484 01185000
         BNE   @RF00484                                            0484 01186000
         CLC   HLDSDAY(2),HLDEDAY                                  0484 01187000
         BNE   @RF00484                                            0484 01188000
*         IF HLDSTIME>HLDETIME THEN                                0485 01189000
         L     @03,HLDSTIME                                        0485 01190000
         C     @03,HLDETIME                                        0485 01191000
         BNH   @RF00485                                            0485 01192000
*           PARMERR='1'B;           /*                       @Y30LB40*/ 01193000
         OI    PARMERR,B'10000000'                                 0486 01194000
*       IF PARMERR='0'B&DATEINSW='0'B/* IF DATE NOT ENTERED          */ 01195000
*         THEN                                                     0487 01196000
@RF00485 DS    0H                                                  0487 01197000
@RF00484 TM    PARMERR,B'10000000'                                 0487 01198000
         BNZ   @RF00487                                            0487 01199000
         TM    DATEINSW,B'10000000'                                0487 01200000
         BNZ   @RF00487                                            0487 01201000
*         PARMERR='1'B;             /* ERROR                 @Y30LB40*/ 01202000
         OI    PARMERR,B'10000000'                                 0488 01203000
*       SS=SS+9;                    /*                       @ZA13497*/ 01204000
@RF00487 AL    SS,@CF00035                                         0489 01205000
*     END;                          /*                       @Y30LB40*/ 01206000
*   IF PARMHOLD(SS:SS)^=','         /*                       @ZA13497*/ 01207000
*     THEN                          /*                       @ZA13497*/ 01208000
@RC00454 LA    @03,PARMHOLD-1(SS)                                  0491 01209000
         CLI   0(@03),C','                                         0491 01210000
         BE    @RF00491                                            0491 01211000
*     CALL SELECT;                  /*                       @ZA13497*/ 01212000
         BAL   @14,SELECT                                          0492 01213000
*PARMEND:                                                          0493 01214000
*   IF PARMERR='1'B                 /* WERE THERE ANY ERRORS @Y30LB40*/ 01215000
*     THEN                                                         0493 01216000
@RF00491 DS    0H                                                  0493 01217000
PARMEND  TM    PARMERR,B'10000000'                                 0493 01218000
         BNO   @RF00493                                            0493 01219000
*     DO;                           /* YES                   @Y30LB40*/ 01220000
*       BLKLINE=PARMMSG;            /* PRINT ERROR MESSAGE   @Y30LB40*/ 01221000
         MVI   BLKLINE+28,C' '                                     0495 01222000
         MVC   BLKLINE+29(92),BLKLINE+28                           0495 01223000
         MVC   BLKLINE(28),PARMMSG                                 0495 01224000
*       RFY                                                        0496 01225000
*        (R0,                                                      0496 01226000
*         R1,                                                      0496 01227000
*         R14,                                                     0496 01228000
*         R15) RSTD;                /*                       @Y30LB40*/ 01229000
*       GEN(PUT   PRNTDCB,BLKLINE); /*                       @Y30LB40*/ 01230000
         PUT   PRNTDCB,BLKLINE                                          01231000
*       RFY                                                        0498 01232000
*        (R0,                                                      0498 01233000
*         R1,                                                      0498 01234000
*         R14,                                                     0498 01235000
*         R15) UNRSTD;              /*                       @Y30LB40*/ 01236000
*       RETURNCD=8;                 /* SET RETURN CODE = 8   @Y30LB40*/ 01237000
         MVC   RETURNCD(2),@CH00036                                0499 01238000
*     END;                          /*                       @Y30LB40*/ 01239000
*   END GETPARMS;                   /*                       @OZ05079*/ 01240000
@EL00004 DS    0H                                                  0501 01241000
@EF00004 DS    0H                                                  0501 01242000
@ER00004 LM    @14,@12,@SA00004                                    0501 01243000
         BR    @14                                                 0501 01244000
*                                                                  0502 01245000
*/********************************************************** @ZA13497*/ 01246000
*/*                                                          @ZA13497*/ 01247000
*/* PROCEDURE NAME - SELECT                                  @ZA13497*/ 01248000
*/*                                                          @ZA13497*/ 01249000
*/* FUNCTION - CHECK FOR EITHER A VOLID OR A STAGING DRIVE   @ZA13497*/ 01250000
*/*            GROUP SELECT PARAMETER.  IF THE SELECT        @ZA13497*/ 01251000
*/*            PARAMETER IS FOR A STAGING DRIVE GROUP, THE   @ZA13497*/ 01252000
*/*            VALUE IS 'SDGXX', WHERE 'XX' IS A DECIMAL     @ZA13497*/ 01253000
*/*            NUMBER IN THE RANGE 00-27.  IF THE VALUE IS   @ZA13497*/ 01254000
*/*            NOT 'SDGXX', IT IS ASSUMED TO BE A 1 TO 6     @ZA13497*/ 01255000
*/*            CHARACTER VOLID.                              @ZA13497*/ 01256000
*/*                                                          @ZA13497*/ 01257000
*/********************************************************** @ZA13497*/ 01258000
*                                                                  0502 01259000
*SELECT:                                                           0502 01260000
*   PROCEDURE;                      /*                       @ZA13497*/ 01261000
SELECT   STM   @14,@12,12(@13)                                     0502 01262000
*   IF PARMHOLD(SS:SS+2)='SDG'      /*                       @ZA13497*/ 01263000
*       &PARMHOLD(SS+5:SS+5)=','    /*                       @ZA13497*/ 01264000
*     THEN                          /*                       @ZA13497*/ 01265000
         LA    @03,PARMHOLD-1(SS)                                  0503 01266000
         CLC   0(3,@03),@CC01119                                   0503 01267000
         BNE   @RF00503                                            0503 01268000
         LA    @03,PARMHOLD+4(SS)                                  0503 01269000
         CLI   0(@03),C','                                         0503 01270000
         BNE   @RF00503                                            0503 01271000
*     DO;                           /*                       @ZA13497*/ 01272000
*                                                                  0504 01273000
*       /*************************************************************/ 01274000
*       /*                                                           */ 01275000
*       /* *****************************************         @ZA13497*/ 01276000
*       /* COMPARE THE FOURTH AND FIFTH CHARACTERS           @ZA13497*/ 01277000
*       /* FOR VALUES IN THE RANGE 00-27 DECIMAL.            @ZA13497*/ 01278000
*       /* IF MATCH, INDEX VALUE MINUS 1 IS THE              @ZA13497*/ 01279000
*       /* BINARY EQUIVALENT -- SAVE IT AND RETURN.          @ZA13497*/ 01280000
*       /* *****************************************         @ZA13497*/ 01281000
*       /*                                                           */ 01282000
*       /*************************************************************/ 01283000
*                                                                  0505 01284000
*       SDGSAVE=PARMHOLD(SS:SS+4);  /*                       @ZA13497*/ 01285000
         MVI   SDGSAVE+5,C' '                                      0505 01286000
         LA    @03,PARMHOLD-1(SS)                                  0505 01287000
         MVC   SDGSAVE(5),0(@03)                                   0505 01288000
*       DO SDGINDEX=1 TO 28;        /*                       @ZA13497*/ 01289000
         LA    SDGINDEX,1                                          0506 01290000
@DL00506 DS    0H                                                  0507 01291000
*         IF PARMHOLD(SS+3:SS+4)=   /*                       @ZA13497*/ 01292000
*             SDGLOKUP(SDGINDEX)    /*                       @ZA13497*/ 01293000
*           THEN                    /*                       @ZA13497*/ 01294000
         LR    @15,SDGINDEX                                        0507 01295000
         ALR   @15,@15                                             0507 01296000
         LA    @01,PARMHOLD+2(SS)                                  0507 01297000
         LA    @14,SDGLOKUP-2(@15)                                 0507 01298000
         CLC   0(2,@01),0(@14)                                     0507 01299000
         BNE   @RF00507                                            0507 01300000
*           DO;                     /*                       @ZA13497*/ 01301000
*             HOLDSDG=SDGINDEX-1;   /*                       @ZA13497*/ 01302000
         LR    @02,SDGINDEX                                        0509 01303000
         BCTR  @02,0                                               0509 01304000
         STC   @02,HOLDSDG                                         0509 01305000
*             SDGSELSW='1'B;        /*                       @ZA13497*/ 01306000
         OI    SDGSELSW,B'10000000'                                0510 01307000
*             RETURN;               /*                       @ZA13497*/ 01308000
@EL00005 DS    0H                                                  0511 01309000
@EF00005 DS    0H                                                  0511 01310000
@ER00005 LM    @14,@12,12(@13)                                     0511 01311000
         BR    @14                                                 0511 01312000
*           END;                    /*                       @ZA13497*/ 01313000
*       END;                        /*                       @ZA13497*/ 01314000
@RF00507 AL    SDGINDEX,@CF00045                                   0513 01315000
         C     SDGINDEX,@CF00869                                   0513 01316000
         BNH   @DL00506                                            0513 01317000
*     END;                          /*                       @ZA13497*/ 01318000
*   VOLSELSW='1'B;                  /*                       @ZA13497*/ 01319000
@RF00503 OI    VOLSELSW,B'10000000'                                0515 01320000
*   HOLDVOL='      ';               /*                       @ZA13497*/ 01321000
         MVC   HOLDVOL(6),@CC01120                                 0516 01322000
*   DO SDGINDEX=0 TO 5;             /*                       @ZA13497*/ 01323000
         SLR   SDGINDEX,SDGINDEX                                   0517 01324000
@DL00517 DS    0H                                                  0518 01325000
*     IF PARMHOLD(SS+SDGINDEX:SS+SDGINDEX)^=','/*            @ZA13497*/ 01326000
*       THEN                        /*                       @ZA13497*/ 01327000
         LR    @15,SS                                              0518 01328000
         ALR   @15,SDGINDEX                                        0518 01329000
         LA    @14,PARMHOLD-1(@15)                                 0518 01330000
         CLI   0(@14),C','                                         0518 01331000
         BE    @RF00518                                            0518 01332000
*       DO;                         /*                       @ZA13497*/ 01333000
*         HOLDVOL(1+SDGINDEX:1+SDGINDEX)=/*                  @ZA13497*/ 01334000
*             PARMHOLD(SS+SDGINDEX:SS+SDGINDEX);/*           @ZA13497*/ 01335000
         LA    @01,HOLDVOL(SDGINDEX)                               0520 01336000
         LA    @14,PARMHOLD-1(@15)                                 0520 01337000
         MVC   0(1,@01),0(@14)                                     0520 01338000
*         LENVOLID=SDGINDEX;        /*                       @ZA13497*/ 01339000
         STH   SDGINDEX,LENVOLID                                   0521 01340000
*       END;                        /*                       @ZA13497*/ 01341000
*   END;                            /*                       @ZA13497*/ 01342000
@RF00518 AL    SDGINDEX,@CF00045                                   0523 01343000
         C     SDGINDEX,@CF00376                                   0523 01344000
         BNH   @DL00517                                            0523 01345000
*   END SELECT;                     /*                       @ZA13497*/ 01346000
         B     @EL00005                                            0524 01347000
*                                                                  0525 01348000
*/********************************************************** @OZ05079*/ 01349000
*/*                                                          @OZ05079*/ 01350000
*/* PROCEDURE NAME - OPENOUT                                 @OZ05079*/ 01351000
*/*                                                          @OZ05079*/ 01352000
*/* FUNCTION - IF THE REFORMAT OPTION WAS SPECIFIED (OR      @OZ05079*/ 01353000
*/*            DEFAULTED), OPEN THE TRACEOUT DATA SET.  IF   @OZ05079*/ 01354000
*/*            ERROR DURING OPEN, WRITE MESSAGE 'ICG902      @OZ05079*/ 01355000
*/*            ERROR FOR TRACEOUT', SET A RETURN CODE OF 8,  @OZ05079*/ 01356000
*/*            AND RETURN TO MAINLINE.                       @OZ05079*/ 01357000
*/*                                                          @OZ05079*/ 01358000
*/********************************************************** @OZ05079*/ 01359000
*                                                                  0525 01360000
*OPENOUT:                                                          0525 01361000
*   PROCEDURE;                      /*                       @OZ05079*/ 01362000
OPENOUT  STM   @14,@12,@SA00006                                    0525 01363000
*   RFY                                                            0526 01364000
*    (R0,                                                          0526 01365000
*     R1,                                                          0526 01366000
*     R14,                                                         0526 01367000
*     R15) RSTD;                    /*                       @Y30LB40*/ 01368000
*   GEN(OPEN  (OUTDCB,(OUTPUT)),MF=(E,OPENCLOS));/*          @Y30LB40*/ 01369000
         OPEN  (OUTDCB,(OUTPUT)),MF=(E,OPENCLOS)                        01370000
*   RFY                                                            0528 01371000
*    (R0,                                                          0528 01372000
*     R1,                                                          0528 01373000
*     R14,                                                         0528 01374000
*     R15) UNRSTD;                  /*                       @Y30LB40*/ 01375000
*   IF(OUTDCB(49:49)&'00010000'B)^='00010000'B THEN                0529 01376000
         MVC   @TS00001(1),OUTDCB+48                               0529 01377000
         NI    @TS00001,B'00010000'                                0529 01378000
         CLI   @TS00001,B'00010000'                                0529 01379000
         BE    @RF00529                                            0529 01380000
*     DO;                           /* IF OPEN NOT OK        @Y30LB40*/ 01381000
*       BLKLINE=TROUTMSG;           /* PRINT ERROR MESSAGE   @Y30LB40*/ 01382000
         MVI   BLKLINE+32,C' '                                     0531 01383000
         MVC   BLKLINE+33(88),BLKLINE+32                           0531 01384000
         MVC   BLKLINE(32),TROUTMSG                                0531 01385000
*       RFY                                                        0532 01386000
*        (R0,                                                      0532 01387000
*         R1,                                                      0532 01388000
*         R14,                                                     0532 01389000
*         R15) RSTD;                /*                       @Y30LB40*/ 01390000
*       GEN(PUT   PRNTDCB,BLKLINE); /*                       @Y30LB40*/ 01391000
         PUT   PRNTDCB,BLKLINE                                          01392000
*       RFY                                                        0534 01393000
*        (R0,                                                      0534 01394000
*         R1,                                                      0534 01395000
*         R14,                                                     0534 01396000
*         R15) UNRSTD;              /*                       @Y30LB40*/ 01397000
*       RETURNCD=8;                 /* SET RETURN CODE=8     @Y30LB40*/ 01398000
         MVC   RETURNCD(2),@CH00036                                0535 01399000
*     END;                          /*                       @Y30LB40*/ 01400000
*   END OPENOUT;                    /*                       @OZ05079*/ 01401000
@EL00006 DS    0H                                                  0537 01402000
@EF00006 DS    0H                                                  0537 01403000
@ER00006 LM    @14,@12,@SA00006                                    0537 01404000
         BR    @14                                                 0537 01405000
*                                                                  0538 01406000
*/********************************************************** @OZ05079*/ 01407000
*/*                                                          @OZ05079*/ 01408000
*/* PROCEDURE NAME: PROCREC6                                 @OZ05079*/ 01409000
*/*                                                          @OZ05079*/ 01410000
*/* FUNCTION - PROCESS VERIFICATION RECORD 6, THE FIRST      @OZ05079*/ 01411000
*/*            RECORD OF THE TRACE FILE TO DETERMINE THE     @OZ05079*/ 01412000
*/*            CONFIGURATION, THAT IS, WHICH SUBSYSTEM UNITS @OZ05079*/ 01413000
*/*            ARE VALID (V), ONLINE (O), AND READY (R).     @OZ05079*/ 01414000
*/*                                                          @OZ05079*/ 01415000
*/********************************************************** @OZ05079*/ 01416000
*                                                                  0538 01417000
*PROCREC6:                                                         0538 01418000
*   PROCEDURE;                      /*                       @OZ05079*/ 01419000
PROCREC6 STM   @14,@06,@SA00007                                    0538 01420000
         STM   @08,@12,@SA00007+36                                 0538 01421000
*   IMLSAVE=IMLCNT;                 /* SAVE IML COUNT OF HEADER    0539 01422000
*                                                            @ZA16141*/ 01423000
         MVC   IMLSAVE(2),IMLCNT                                   0539 01424000
*   M=M+N+1;                        /* BUMP ARRAY COUNTER    @OZ11013*/ 01425000
         LH    @15,M                                               0540 01426000
         AH    @15,N                                               0540 01427000
         AL    @15,@CF00045                                        0540 01428000
         STH   @15,M                                               0540 01429000
*   N=0;                            /* RESET SAME DAY CHECKER      0541 01430000
*                                                            @OZ09557*/ 01431000
         SLR   @14,@14                                             0541 01432000
         STH   @14,N                                               0541 01433000
*   IF M>750                        /* MAX COUNTERS = 750    @OZ09557*/ 01434000
*     THEN                          /*                       @OZ09557*/ 01435000
         LA    @14,750                                             0542 01436000
         CR    @15,@14                                             0542 01437000
         BNH   @RF00542                                            0542 01438000
*     M=750;                        /* DO NOT EXCEED         @OZ09557*/ 01439000
         STH   @14,M                                               0543 01440000
*   CALL GENCONFG;                  /* DRC/DRD TRANSLATE     @OZ05079*/ 01441000
@RF00542 BAL   @14,GENCONFG                                        0544 01442000
*   FRSTSW='0'B;                    /* 1ST HEADER SWITCH OFF @OZ09557*/ 01443000
         NI    FRSTSW,B'01111111'                                  0545 01444000
*   DATEWORK=HOSTDATE;              /*                       @Y30LB40*/ 01445000
         MVC   DATEWORK(4),HOSTDATE                                0546 01446000
*   CVB(HOSTJUL,DATEWORK(3:4));     /* HOST DATE TO BINARY   @OZ09557*/ 01447000
         XC    @TS00001(8),@TS00001                                0547 01448000
         MVC   @TS00001+6(2),DATEWORK+2                            0547 01449000
         CVB   @06,@TS00001                                        0547 01450000
         STH   @06,HOSTJUL                                         0547 01451000
*   MVO(DATEWORK,DATEWORK(1:2));    /*                       @Y30LB40*/ 01452000
         MVO   DATEWORK(4),DATEWORK(2)                             0548 01453000
*   CVB(HOSTYEAR,DATEWORK(3:4));    /*                       @OZ09557*/ 01454000
         XC    @TS00001(8),@TS00001                                0549 01455000
         MVC   @TS00001+6(2),DATEWORK+2                            0549 01456000
         CVB   @06,@TS00001                                        0549 01457000
         STH   @06,HOSTYEAR                                        0549 01458000
*   HOSTTIME=HOSTTIME/100;          /* HOST TIME TO SECONDS  @OZ09557*/ 01459000
         L     @00,HOSTTIME                                        0550 01460000
         SRDA  @00,32                                              0550 01461000
         D     @00,@CF01050                                        0550 01462000
         ST    @01,HOSTTIME                                        0550 01463000
*   HOSTTME=HOSTTIME;               /*                       @OZ09557*/ 01464000
         ST    @01,HOSTTME                                         0551 01465000
*   SRL(DSMTIME,8);                 /* CONVERT DSM TIME TO SECONDS 0552 01466000
*                                                            @Y30LB40*/ 01467000
         L     @06,DSMTIME                                         0552 01468000
         SRL   @06,8                                               0552 01469000
         ST    @06,DSMTIME                                         0552 01470000
*   DSMTIME=DSMTIME/4;              /*                       @Y30LB40*/ 01471000
         L     @06,DSMTIME                                         0553 01472000
         SRL   @06,2                                               0553 01473000
         ST    @06,DSMTIME                                         0553 01474000
*   HDRTME=DSMTIME;                 /*                       @OZ09557*/ 01475000
         ST    @06,HDRTME                                          0554 01476000
*   CALL NEWPAGE;                   /* FORCE NEW PAGE        @Y30LB40*/ 01477000
         BAL   @14,NEWPAGE                                         0555 01478000
*   BLKLINE=HDLINE;                 /*                       @Y30LB40*/ 01479000
         MVC   BLKLINE(121),HDLINE                                 0556 01480000
*   UNPK(BLKLINE(29:33),HOSTDATE(2:4));/*                    @Y30LB40*/ 01481000
         UNPK  BLKLINE+28(5),HOSTDATE+1(3)                         0557 01482000
*   CALL EDITFIX(ADDR(HOSTTIME),4,'S');/*                    @Y30LB40*/ 01483000
         MVC   @AL00001+4(8),@AL00558                              0558 01484000
         LA    @06,HOSTTIME                                        0558 01485000
         ST    @06,@AFTEMPS                                        0558 01486000
         LA    @06,@AFTEMPS                                        0558 01487000
         ST    @06,@AL00001                                        0558 01488000
         LA    @01,@AL00001                                        0558 01489000
         BAL   @14,EDITFIX                                         0558 01490000
*   BLKLINE(54:58)=FIXOUT(9:13);    /* PRINT HOST TIME       @Y30LB40*/ 01491000
         MVC   BLKLINE+53(5),FIXOUT+8                              0559 01492000
*   CALL EDITFIX(ADDR(DSMTIME),4,'S');/*                     @Y30LB40*/ 01493000
         MVC   @AL00001+4(8),@AL00560                              0560 01494000
         LA    @06,DSMTIME                                         0560 01495000
         ST    @06,@AFTEMPS                                        0560 01496000
         LA    @06,@AFTEMPS                                        0560 01497000
         ST    @06,@AL00001                                        0560 01498000
         LA    @01,@AL00001                                        0560 01499000
         BAL   @14,EDITFIX                                         0560 01500000
*   BLKLINE(83:90)=FIXOUT(6:13);    /* PRINT DSM TIME        @Y30LB40*/ 01501000
         MVC   BLKLINE+82(8),FIXOUT+5                              0561 01502000
*   RFY                                                            0562 01503000
*    (R0,                                                          0562 01504000
*     R1,                                                          0562 01505000
*     R14,                                                         0562 01506000
*     R15) RSTD;                    /*                       @Y30LB40*/ 01507000
*   GEN(PUT   PRNTDCB,BLKLINE);     /* PRINT TRACE HEADER    @Y30LB40*/ 01508000
         PUT   PRNTDCB,BLKLINE                                          01509000
*   RFY                                                            0564 01510000
*    (R0,                                                          0564 01511000
*     R1,                                                          0564 01512000
*     R14,                                                         0564 01513000
*     R15) UNRSTD;                  /*                       @Y30LB40*/ 01514000
*   LINECNT=LINECNT+2;              /*                       @Y30LB40*/ 01515000
         AL    LINECNT,@CF00052                                    0565 01516000
*   BLKLINE='0';                    /* CLEAR PRINT LINE      @Y30LB40*/ 01517000
         MVI   BLKLINE+1,C' '                                      0566 01518000
         MVC   BLKLINE+2(119),BLKLINE+1                            0566 01519000
         MVI   BLKLINE,C'0'                                        0566 01520000
*   LINECNT=LINECNT+1;              /* BUMP LINECOUNTER      @Y30LB40*/ 01521000
         LA    @15,1                                               0567 01522000
         ALR   LINECNT,@15                                         0567 01523000
*                                                                  0568 01524000
*/********************************************************** @OZ05079*/ 01525000
*/*                                                          @OZ05079*/ 01526000
*/* PROCEDURE NAME - (SUBSECTION WITHIN) PROCREC6            @OZ05079*/ 01527000
*/*                                                          @OZ05079*/ 01528000
*/* FUNCTION - THIS SUBSECTION PRODUCES INFORMATION ON THE   @OZ05079*/ 01529000
*/*            STATUS OF DATA RECORDING DEVICES.             @OZ05079*/ 01530000
*/*                                                          @OZ05079*/ 01531000
*/********************************************************** @OZ05079*/ 01532000
*                                                                  0568 01533000
*   I=51;                           /* SET SUBSTRING POINTER         */ 01534000
         LA    I,51                                                0568 01535000
*   BLKLINE(17:42)='DATA RECORDING DEVICES';/* SET PRINT CONSTANT    */ 01536000
         MVI   BLKLINE+38,C' '                                     0569 01537000
         MVC   BLKLINE+39(3),BLKLINE+38                            0569 01538000
         MVC   BLKLINE+16(22),@CC01136                             0569 01539000
*   FOUNDSW='0'B;                   /* INIT 1 VALID FOUND INDICATOR  */ 01540000
         NI    FOUNDSW,B'01111111'                                 0570 01541000
*   DO J=1 TO 4;                    /* LOOP THROUGH 4 LIBRARIES      */ 01542000
         STH   @15,J                                               0571 01543000
@DL00571 DS    0H                                                  0572 01544000
*     STATMASK='10000000'B;         /* SET TEST MASK         @Y30LB40*/ 01545000
         MVI   STATMASK,B'10000000'                                0572 01546000
*     DO K=1 TO 8;                  /* LOOP THROUGH 8 READ WRITES    */ 01547000
         LA    @15,1                                               0573 01548000
         STH   @15,K                                               0573 01549000
@DL00573 DS    0H                                                  0574 01550000
*       IF(VRW(J)&STATMASK)=STATMASK/* IS RW VALID           @Y30LB40*/ 01551000
*         THEN                                                     0574 01552000
         LH    @15,J                                               0574 01553000
         LA    @14,VRW-1(@15)                                      0574 01554000
         MVC   @TS00001(1),0(@14)                                  0574 01555000
         NC    @TS00001(1),STATMASK                                0574 01556000
         CLC   @TS00001(1),STATMASK                                0574 01557000
         BNE   @RF00574                                            0574 01558000
*         DO;                       /* YES                   @Y30LB40*/ 01559000
*           FOUNDSW='1'B;           /* INDICATE VALID FOUND          */ 01560000
         OI    FOUNDSW,B'10000000'                                 0576 01561000
*           BLKLINE(I:I+4)='200-V'; /* SET SSID FORMAT       @Y30LB40*/ 01562000
         LA    @01,BLKLINE-1(I)                                    0577 01563000
         MVC   0(5,@01),@CC01138                                   0577 01564000
*           WORK1=J-1;              /* GET LIBRARY NUMBER    @Y30LB40*/ 01565000
         BCTR  @15,0                                               0578 01566000
         STC   @15,WORK1                                           0578 01567000
*           CALL EDITFIX(ADDR(WORK1),1,'N');/* EDIT IT       @Y30LB40*/ 01568000
         MVC   @AL00001+4(8),@AL00579                              0579 01569000
         LA    @15,WORK1                                           0579 01570000
         ST    @15,@AFTEMPS                                        0579 01571000
         LA    @15,@AFTEMPS                                        0579 01572000
         ST    @15,@AL00001                                        0579 01573000
         LA    @01,@AL00001                                        0579 01574000
         BAL   @14,EDITFIX                                         0579 01575000
*           BLKLINE(I+1:I+1)=FIXOUT(13:13);/* PRINT IT       @Y30LB40*/ 01576000
         LA    @01,BLKLINE(I)                                      0580 01577000
         MVC   0(1,@01),FIXOUT+12                                  0580 01578000
*           WORK1=K-1;              /* GET READ WRITE NUMBER         */ 01579000
         LH    @15,K                                               0581 01580000
         BCTR  @15,0                                               0581 01581000
         STC   @15,WORK1                                           0581 01582000
*           CALL EDITFIX(ADDR(WORK1),1,'N');/* EDIT IT       @Y30LB40*/ 01583000
         MVC   @AL00001+4(8),@AL00582                              0582 01584000
         LA    @15,WORK1                                           0582 01585000
         ST    @15,@AFTEMPS                                        0582 01586000
         LA    @15,@AFTEMPS                                        0582 01587000
         ST    @15,@AL00001                                        0582 01588000
         LA    @01,@AL00001                                        0582 01589000
         BAL   @14,EDITFIX                                         0582 01590000
*           BLKLINE(I+2:I+2)=FIXOUT(13:13);/* PRINT IT       @Y30LB40*/ 01591000
         LA    @01,BLKLINE+1(I)                                    0583 01592000
         MVC   0(1,@01),FIXOUT+12                                  0583 01593000
*           IF(ORW(J)&STATMASK)=STATMASK/* IS RW ONLINE              */ 01594000
*             THEN                                                 0584 01595000
         LH    @01,J                                               0584 01596000
         LA    @15,ORW-1(@01)                                      0584 01597000
         MVC   @TS00001(1),0(@15)                                  0584 01598000
         NC    @TS00001(1),STATMASK                                0584 01599000
         CLC   @TS00001(1),STATMASK                                0584 01600000
         BNE   @RF00584                                            0584 01601000
*             BLKLINE(I+5:I+5)='O'; /* YES,INDICATE IT               */ 01602000
         LA    @01,BLKLINE+4(I)                                    0585 01603000
         MVI   0(@01),C'O'                                         0585 01604000
*           IF(RRW(J)&STATMASK)=STATMASK/* IS RW READY               */ 01605000
*             THEN                                                 0586 01606000
@RF00584 LH    @01,J                                               0586 01607000
         LA    @15,RRW-1(@01)                                      0586 01608000
         MVC   @TS00001(1),0(@15)                                  0586 01609000
         NC    @TS00001(1),STATMASK                                0586 01610000
         CLC   @TS00001(1),STATMASK                                0586 01611000
         BNE   @RF00586                                            0586 01612000
*             BLKLINE(I+6:I+6)='R'; /* YES,INDICATE IT               */ 01613000
         LA    @01,BLKLINE+5(I)                                    0587 01614000
         MVI   0(@01),C'R'                                         0587 01615000
*           I=I+8;                  /* BUMP LINE POINTER     @Y30LB40*/ 01616000
@RF00586 AL    I,@CF00036                                          0588 01617000
*           IF I>121                /* IS LINE FULL          @Y30LB40*/ 01618000
*             THEN                                                 0589 01619000
         C     I,@CF00528                                          0589 01620000
         BNH   @RF00589                                            0589 01621000
*             DO;                   /* YES,PRINT IT          @Y30LB40*/ 01622000
*               RFY                                                0591 01623000
*                (R0,                                              0591 01624000
*                 R1,                                              0591 01625000
*                 R14,                                             0591 01626000
*                 R15) RSTD;        /*                       @Y30LB40*/ 01627000
*               GEN(PUT   PRNTDCB,BLKLINE);/*                @Y30LB40*/ 01628000
         PUT   PRNTDCB,BLKLINE                                          01629000
*               RFY                                                0593 01630000
*                (R0,                                              0593 01631000
*                 R1,                                              0593 01632000
*                 R14,                                             0593 01633000
*                 R15) UNRSTD;      /*                       @Y30LB40*/ 01634000
*               LINECNT=LINECNT+1;  /* BUMP LINE COUNTER             */ 01635000
         AL    LINECNT,@CF00045                                    0594 01636000
*               BLKLINE=' ';        /* CLEAR PRINT LINE      @Y30LB40*/ 01637000
         MVI   BLKLINE+1,C' '                                      0595 01638000
         MVC   BLKLINE+2(119),BLKLINE+1                            0595 01639000
         MVI   BLKLINE,C' '                                        0595 01640000
*               I=51;               /* RESET SUBSTRING POINTER       */ 01641000
         LA    I,51                                                0596 01642000
*             END;                  /*                       @Y30LB40*/ 01643000
*         END;                      /*                       @Y30LB40*/ 01644000
@RF00589 DS    0H                                                  0599 01645000
*       SRL(STATMASK,1);            /* SHIFT MASK 1 BIT      @Y30LB40*/ 01646000
@RF00574 SLR   @15,@15                                             0599 01647000
         IC    @15,STATMASK                                        0599 01648000
         SRL   @15,1                                               0599 01649000
         STC   @15,STATMASK                                        0599 01650000
*     END;                          /*                       @Y30LB40*/ 01651000
         LA    @15,1                                               0600 01652000
         AH    @15,K                                               0600 01653000
         STH   @15,K                                               0600 01654000
         C     @15,@CF00036                                        0600 01655000
         BNH   @DL00573                                            0600 01656000
*   END;                            /*                       @Y30LB40*/ 01657000
         LA    @15,1                                               0601 01658000
         AH    @15,J                                               0601 01659000
         STH   @15,J                                               0601 01660000
         C     @15,@CF00104                                        0601 01661000
         BNH   @DL00571                                            0601 01662000
*   CALL HEADPRNT;                  /* PRINT LAST LINE       @OZ05079*/ 01663000
         BAL   @14,HEADPRNT                                        0602 01664000
*                                                                  0603 01665000
*/********************************************************** @OZ05079*/ 01666000
*/*                                                          @OZ05079*/ 01667000
*/* PROCEDURE NAME - (SUBSECTION WITHIN) PROCREC6            @OZ05079*/ 01668000
*/*                                                          @OZ05079*/ 01669000
*/* FUNCTION - THIS SUBSECTION PRODUCES INFORMATION ON THE   @OZ05079*/ 01670000
*/*            STATUS OF STAGING ADAPTERS.                   @OZ05079*/ 01671000
*/*                                                          @OZ05079*/ 01672000
*/********************************************************** @OZ05079*/ 01673000
*                                                                  0603 01674000
*   BLKLINE(17:42)='STAGING ADAPTERS';/* SET PRINT CONSTANT          */ 01675000
         MVI   BLKLINE+32,C' '                                     0603 01676000
         MVC   BLKLINE+33(9),BLKLINE+32                            0603 01677000
         MVC   BLKLINE+16(16),@CC01141                             0603 01678000
*   FOUNDSW='0'B;                   /* INIT 1 VALID FOUND INDICATOR  */ 01679000
         NI    FOUNDSW,B'01111111'                                 0604 01680000
*   DO J=1 TO 2;                    /* LOOP THROUGH 2 GROUPS OF 8  0605 01681000
*                                      DATA STAGERS                  */ 01682000
         LA    @15,1                                               0605 01683000
         STH   @15,J                                               0605 01684000
@DL00605 DS    0H                                                  0606 01685000
*     STATMASK='10000000'B;         /* SET TEST MASK         @Y30LB40*/ 01686000
         MVI   STATMASK,B'10000000'                                0606 01687000
*     DO K=1 TO 8;                  /* LOOP THROUGH 8 DATA STAGERS   */ 01688000
         LA    @15,1                                               0607 01689000
         STH   @15,K                                               0607 01690000
@DL00607 DS    0H                                                  0608 01691000
*       IF(VDS(J)&STATMASK)=STATMASK/* IS DS VALID           @Y30LB40*/ 01692000
*         THEN                                                     0608 01693000
         LH    @14,J                                               0608 01694000
         LA    @01,VDS-1(@14)                                      0608 01695000
         MVC   @TS00001(1),0(@01)                                  0608 01696000
         NC    @TS00001(1),STATMASK                                0608 01697000
         CLC   @TS00001(1),STATMASK                                0608 01698000
         BNE   @RF00608                                            0608 01699000
*         DO;                       /* YES                   @Y30LB40*/ 01700000
*           FOUNDSW='1'B;           /* INDICATE VALID FOUND          */ 01701000
         OI    FOUNDSW,B'10000000'                                 0610 01702000
*           BLKLINE(I:I+4)='800-V'; /* SET SSID FORMAT       @Y30LB40*/ 01703000
         LA    @01,BLKLINE-1(I)                                    0611 01704000
         MVC   0(5,@01),@CC01143                                   0611 01705000
*           WORK1=((J-1)*8)+(K-1);  /* GET DS NUMBER         @Y30LB40*/ 01706000
         BCTR  @14,0                                               0612 01707000
         SLA   @14,3                                               0612 01708000
         BCTR  @15,0                                               0612 01709000
         ALR   @14,@15                                             0612 01710000
         STC   @14,WORK1                                           0612 01711000
*           CALL EDITHEX(ADDR(WORK1),1);/* EDIT IT           @Y30LB40*/ 01712000
         LA    @15,WORK1                                           0613 01713000
         ST    @15,@AFTEMPS                                        0613 01714000
         LA    @15,@AFTEMPS                                        0613 01715000
         ST    @15,@AL00001                                        0613 01716000
         LA    @15,@CF00045                                        0613 01717000
         ST    @15,@AL00001+4                                      0613 01718000
         LA    @01,@AL00001                                        0613 01719000
         BAL   @14,EDITHEX                                         0613 01720000
*           BLKLINE(I+1:I+1)=HEXOUT(2:2);/* PRINT IT         @Y30LB40*/ 01721000
         LA    @01,BLKLINE(I)                                      0614 01722000
         MVC   0(1,@01),HEXOUT+1                                   0614 01723000
*           IF(ODS(J)&STATMASK)=STATMASK/* IS DS ONLINE              */ 01724000
*             THEN                                                 0615 01725000
         LH    @01,J                                               0615 01726000
         LA    @15,ODS-1(@01)                                      0615 01727000
         MVC   @TS00001(1),0(@15)                                  0615 01728000
         NC    @TS00001(1),STATMASK                                0615 01729000
         CLC   @TS00001(1),STATMASK                                0615 01730000
         BNE   @RF00615                                            0615 01731000
*             BLKLINE(I+5:I+5)='O'; /* YES,INDICATE IT               */ 01732000
         LA    @01,BLKLINE+4(I)                                    0616 01733000
         MVI   0(@01),C'O'                                         0616 01734000
*           IF(RDS(J)&STATMASK)=STATMASK/* IS DS READY               */ 01735000
*             THEN                                                 0617 01736000
@RF00615 LH    @01,J                                               0617 01737000
         LA    @15,RDS-1(@01)                                      0617 01738000
         MVC   @TS00001(1),0(@15)                                  0617 01739000
         NC    @TS00001(1),STATMASK                                0617 01740000
         CLC   @TS00001(1),STATMASK                                0617 01741000
         BNE   @RF00617                                            0617 01742000
*             BLKLINE(I+6:I+6)='R'; /* YES,INDICATE IT               */ 01743000
         LA    @01,BLKLINE+5(I)                                    0618 01744000
         MVI   0(@01),C'R'                                         0618 01745000
*           I=I+8;                  /* BUMP LINE POINTER     @Y30LB40*/ 01746000
@RF00617 AL    I,@CF00036                                          0619 01747000
*           IF I>121                /* IS LINE FULL          @Y30LB40*/ 01748000
*             THEN                                                 0620 01749000
         C     I,@CF00528                                          0620 01750000
         BNH   @RF00620                                            0620 01751000
*             DO;                   /* YES,PRINT IT          @Y30LB40*/ 01752000
*               RFY                                                0622 01753000
*                (R0,                                              0622 01754000
*                 R1,                                              0622 01755000
*                 R14,                                             0622 01756000
*                 R15) RSTD;        /*                       @Y30LB40*/ 01757000
*               GEN(PUT   PRNTDCB,BLKLINE);/*                @Y30LB40*/ 01758000
         PUT   PRNTDCB,BLKLINE                                          01759000
*               RFY                                                0624 01760000
*                (R0,                                              0624 01761000
*                 R1,                                              0624 01762000
*                 R14,                                             0624 01763000
*                 R15) UNRSTD;      /*                       @Y30LB40*/ 01764000
*               LINECNT=LINECNT+1;  /* BUMP LINE COUNTER             */ 01765000
         AL    LINECNT,@CF00045                                    0625 01766000
*               BLKLINE=' ';        /* CLEAR PRINT LINE      @Y30LB40*/ 01767000
         MVI   BLKLINE+1,C' '                                      0626 01768000
         MVC   BLKLINE+2(119),BLKLINE+1                            0626 01769000
         MVI   BLKLINE,C' '                                        0626 01770000
*               I=51;               /* RESET SUBSTRING POINTER       */ 01771000
         LA    I,51                                                0627 01772000
*             END;                  /*                       @Y30LB40*/ 01773000
*         END;                      /*                       @Y30LB40*/ 01774000
@RF00620 DS    0H                                                  0630 01775000
*       SRL(STATMASK,1);            /* SHIFT MASK 1 BIT      @Y30LB40*/ 01776000
@RF00608 SLR   @15,@15                                             0630 01777000
         IC    @15,STATMASK                                        0630 01778000
         SRL   @15,1                                               0630 01779000
         STC   @15,STATMASK                                        0630 01780000
*     END;                          /*                       @Y30LB40*/ 01781000
         LA    @15,1                                               0631 01782000
         AH    @15,K                                               0631 01783000
         STH   @15,K                                               0631 01784000
         C     @15,@CF00036                                        0631 01785000
         BNH   @DL00607                                            0631 01786000
*   END;                            /*                       @Y30LB40*/ 01787000
         LA    @15,1                                               0632 01788000
         AH    @15,J                                               0632 01789000
         STH   @15,J                                               0632 01790000
         C     @15,@CF00052                                        0632 01791000
         BNH   @DL00605                                            0632 01792000
*   CALL HEADPRNT;                  /* PRINT LAST LINE       @OZ05079*/ 01793000
         BAL   @14,HEADPRNT                                        0633 01794000
*                                                                  0634 01795000
*/********************************************************** @OZ05079*/ 01796000
*/*                                                          @OZ05079*/ 01797000
*/* PROCEDURE NAME - (SUBSECTION WITHIN) PROCREC6            @OZ05079*/ 01798000
*/*                                                          @OZ05079*/ 01799000
*/* FUNCTION - THIS SUBSECTION PRODUCES INFORMATION ON THE   @OZ05079*/ 01800000
*/*            STATUS OF DATA RECORDING CONTROLLERS.         @OZ05079*/ 01801000
*/*                                                          @OZ05079*/ 01802000
*/********************************************************** @OZ05079*/ 01803000
*                                                                  0634 01804000
*   BLKLINE(17:42)='DATA RECORDING CONTROLLERS';/* SET CONSTANT      */ 01805000
         MVC   BLKLINE+16(26),@CC01145                             0634 01806000
*   FOUNDSW='0'B;                   /* INIT 1 VALID FOUND INDICATOR  */ 01807000
         NI    FOUNDSW,B'01111111'                                 0635 01808000
*   DO J=1 TO 2;                    /* LOOP THROUGH 2 GROUPS OF 8  0636 01809000
*                                      CONTROLLERS                   */ 01810000
         LA    @15,1                                               0636 01811000
         STH   @15,J                                               0636 01812000
@DL00636 DS    0H                                                  0637 01813000
*     STATMASK='10000000'B;         /* SET TEST MASK         @Y30LB40*/ 01814000
         MVI   STATMASK,B'10000000'                                0637 01815000
*     DO K=1 TO 8;                  /* LOOP THROUGH 2 GROUPS OF 4  0638 01816000
*                                      CONTROLLERS                   */ 01817000
         LA    @15,1                                               0638 01818000
         STH   @15,K                                               0638 01819000
@DL00638 DS    0H                                                  0639 01820000
*       IF(VRWC(J)&STATMASK)=STATMASK/* IS CONTROLLER VALID          */ 01821000
*         THEN                                                     0639 01822000
         LH    @14,J                                               0639 01823000
         LA    @01,VRWC-1(@14)                                     0639 01824000
         MVC   @TS00001(1),0(@01)                                  0639 01825000
         NC    @TS00001(1),STATMASK                                0639 01826000
         CLC   @TS00001(1),STATMASK                                0639 01827000
         BNE   @RF00639                                            0639 01828000
*         DO;                       /* YES                   @Y30LB40*/ 01829000
*           FOUNDSW='1'B;           /* INDICATE VALID FOUND          */ 01830000
         OI    FOUNDSW,B'10000000'                                 0641 01831000
*           BLKLINE(I:I+4)='400-V'; /* SET SSID FORMAT       @Y30LB40*/ 01832000
         LA    @01,BLKLINE-1(I)                                    0642 01833000
         MVC   0(5,@01),@CC01148                                   0642 01834000
*           IF J=1                  /* IS THIS FIRST GROUP OF 8      */ 01835000
*             THEN                                                 0643 01836000
         C     @14,@CF00045                                        0643 01837000
         BNE   @RF00643                                            0643 01838000
*             IF K>4                /* YES,IS THIS FIRST GROUP OF 4  */ 01839000
*               THEN                                               0644 01840000
         C     @15,@CF00104                                        0644 01841000
         BNH   @RF00644                                            0644 01842000
*               WORK1=1;            /* NO,SET LIBRARY 1      @Y30LB40*/ 01843000
         MVI   WORK1,X'01'                                         0645 01844000
*             ELSE                                                 0646 01845000
*               WORK1=0;            /* YES,SET LIBRARY 0     @Y30LB40*/ 01846000
         B     @RC00644                                            0646 01847000
@RF00644 MVI   WORK1,X'00'                                         0646 01848000
*           ELSE                                                   0647 01849000
*             IF K>4                /* NO,IS THIS FIRST GROUP OF 4   */ 01850000
*               THEN                                               0647 01851000
         B     @RC00643                                            0647 01852000
@RF00643 LH    @15,K                                               0647 01853000
         C     @15,@CF00104                                        0647 01854000
         BNH   @RF00647                                            0647 01855000
*               WORK1=3;            /* NO,SET LIBRARY 3      @Y30LB40*/ 01856000
         MVI   WORK1,X'03'                                         0648 01857000
*             ELSE                                                 0649 01858000
*               WORK1=2;            /* YES,SET LIBRARY 2     @Y30LB40*/ 01859000
         B     @RC00647                                            0649 01860000
@RF00647 MVI   WORK1,X'02'                                         0649 01861000
*           CALL EDITFIX(ADDR(WORK1),1,'N');/* EDIT IT       @Y30LB40*/ 01862000
@RC00647 DS    0H                                                  0650 01863000
@RC00643 MVC   @AL00001+4(8),@AL00650                              0650 01864000
         LA    @15,WORK1                                           0650 01865000
         ST    @15,@AFTEMPS                                        0650 01866000
         LA    @15,@AFTEMPS                                        0650 01867000
         ST    @15,@AL00001                                        0650 01868000
         LA    @01,@AL00001                                        0650 01869000
         BAL   @14,EDITFIX                                         0650 01870000
*           BLKLINE(I+1:I+1)=FIXOUT(13:13);/* PRINT IT       @Y30LB40*/ 01871000
         LA    @01,BLKLINE(I)                                      0651 01872000
         MVC   0(1,@01),FIXOUT+12                                  0651 01873000
*           IF K>4                  /* IS THIS SECOND GROUP OF 4     */ 01874000
*             THEN                                                 0652 01875000
         LH    @15,K                                               0652 01876000
         C     @15,@CF00104                                        0652 01877000
         BNH   @RF00652                                            0652 01878000
*             WORK1=K-5;            /* YES,SET CONTRL NO.    @Y30LB40*/ 01879000
         SL    @15,@CF00376                                        0653 01880000
         STC   @15,WORK1                                           0653 01881000
*           ELSE                                                   0654 01882000
*             WORK1=K-1;            /* NO,SET CONTRL NO.     @Y30LB40*/ 01883000
         B     @RC00652                                            0654 01884000
@RF00652 LH    @15,K                                               0654 01885000
         BCTR  @15,0                                               0654 01886000
         STC   @15,WORK1                                           0654 01887000
*           CALL EDITFIX(ADDR(WORK1),1,'N');/* EDIT IT       @Y30LB40*/ 01888000
@RC00652 MVC   @AL00001+4(8),@AL00655                              0655 01889000
         LA    @15,WORK1                                           0655 01890000
         ST    @15,@AFTEMPS                                        0655 01891000
         LA    @15,@AFTEMPS                                        0655 01892000
         ST    @15,@AL00001                                        0655 01893000
         LA    @01,@AL00001                                        0655 01894000
         BAL   @14,EDITFIX                                         0655 01895000
*           BLKLINE(I+2:I+2)=FIXOUT(13:13);/* PRINT IT       @Y30LB40*/ 01896000
         LA    @01,BLKLINE+1(I)                                    0656 01897000
         MVC   0(1,@01),FIXOUT+12                                  0656 01898000
*           IF(ORWC(J)&STATMASK)=STATMASK/* IS CONTRL ONLINE         */ 01899000
*             THEN                                                 0657 01900000
         LH    @01,J                                               0657 01901000
         LA    @15,ORWC-1(@01)                                     0657 01902000
         MVC   @TS00001(1),0(@15)                                  0657 01903000
         NC    @TS00001(1),STATMASK                                0657 01904000
         CLC   @TS00001(1),STATMASK                                0657 01905000
         BNE   @RF00657                                            0657 01906000
*             BLKLINE(I+5:I+5)='O'; /* YES,INDICATE IT               */ 01907000
         LA    @01,BLKLINE+4(I)                                    0658 01908000
         MVI   0(@01),C'O'                                         0658 01909000
*           IF(RRWC(J)&STATMASK)=STATMASK/* IS CONTRL READY          */ 01910000
*             THEN                                                 0659 01911000
@RF00657 LH    @01,J                                               0659 01912000
         LA    @15,RRWC-1(@01)                                     0659 01913000
         MVC   @TS00001(1),0(@15)                                  0659 01914000
         NC    @TS00001(1),STATMASK                                0659 01915000
         CLC   @TS00001(1),STATMASK                                0659 01916000
         BNE   @RF00659                                            0659 01917000
*             BLKLINE(I+6:I+6)='R'; /* YES,INDICATE IT               */ 01918000
         LA    @01,BLKLINE+5(I)                                    0660 01919000
         MVI   0(@01),C'R'                                         0660 01920000
*           I=I+8;                  /* BUMP LINE POINTER     @Y30LB40*/ 01921000
@RF00659 AL    I,@CF00036                                          0661 01922000
*           IF I>121                /* IS LINE FULL          @Y30LB40*/ 01923000
*             THEN                                                 0662 01924000
         C     I,@CF00528                                          0662 01925000
         BNH   @RF00662                                            0662 01926000
*             DO;                   /* YES,PRINT IT          @Y30LB40*/ 01927000
*               RFY                                                0664 01928000
*                (R0,                                              0664 01929000
*                 R1,                                              0664 01930000
*                 R14,                                             0664 01931000
*                 R15) RSTD;        /*                       @Y30LB40*/ 01932000
*               GEN(PUT   PRNTDCB,BLKLINE);/*                @Y30LB40*/ 01933000
         PUT   PRNTDCB,BLKLINE                                          01934000
*               RFY                                                0666 01935000
*                (R0,                                              0666 01936000
*                 R1,                                              0666 01937000
*                 R14,                                             0666 01938000
*                 R15) UNRSTD;      /*                       @Y30LB40*/ 01939000
*               LINECNT=LINECNT+1;  /* BUMP LINE COUNTER             */ 01940000
         AL    LINECNT,@CF00045                                    0667 01941000
*               BLKLINE=' ';        /* CLEAR PRINT LINE      @Y30LB40*/ 01942000
         MVI   BLKLINE+1,C' '                                      0668 01943000
         MVC   BLKLINE+2(119),BLKLINE+1                            0668 01944000
         MVI   BLKLINE,C' '                                        0668 01945000
*               I=51;               /* RESET SUBSTRING POINTER       */ 01946000
         LA    I,51                                                0669 01947000
*             END;                  /*                       @Y30LB40*/ 01948000
*         END;                      /*                       @Y30LB40*/ 01949000
@RF00662 DS    0H                                                  0672 01950000
*       SRL(STATMASK,1);            /* SHIFT MASK 1 BIT      @Y30LB40*/ 01951000
@RF00639 SLR   @15,@15                                             0672 01952000
         IC    @15,STATMASK                                        0672 01953000
         SRL   @15,1                                               0672 01954000
         STC   @15,STATMASK                                        0672 01955000
*     END;                          /*                       @Y30LB40*/ 01956000
         LA    @15,1                                               0673 01957000
         AH    @15,K                                               0673 01958000
         STH   @15,K                                               0673 01959000
         C     @15,@CF00036                                        0673 01960000
         BNH   @DL00638                                            0673 01961000
*   END;                            /*                       @Y30LB40*/ 01962000
         LA    @15,1                                               0674 01963000
         AH    @15,J                                               0674 01964000
         STH   @15,J                                               0674 01965000
         C     @15,@CF00052                                        0674 01966000
         BNH   @DL00636                                            0674 01967000
*   CALL HEADPRNT;                  /* PRINT LAST LINE       @OZ05079*/ 01968000
         BAL   @14,HEADPRNT                                        0675 01969000
*                                                                  0676 01970000
*/********************************************************** @OZ05079*/ 01971000
*/*                                                          @OZ05079*/ 01972000
*/* PROCEDURE NAME - (SUBSECTION WITHIN) PROCREC6            @OZ05079*/ 01973000
*/*                                                          @OZ05079*/ 01974000
*/* FUNCTION - THIS SUBSECTION PRODUCES INFORMATION ON THE   @OZ05079*/ 01975000
*/*            STATUS OF STAGING DRIVES WITHIN STAGING       @OZ05079*/ 01976000
*/*            DRIVE GROUPS.                                 @OZ05079*/ 01977000
*/*                                                          @OZ05079*/ 01978000
*/********************************************************** @OZ05079*/ 01979000
*                                                                  0676 01980000
*   DO J=1 TO 30;                   /* LOOP THROUGH 30 RSGS          */ 01981000
         LA    @06,1                                               0676 01982000
         STH   @06,J                                               0676 01983000
@DL00676 DS    0H                                                  0677 01984000
*     IF VRSG(J)='00000000'B        /* IS SPINDLE GROUP VALID        */ 01985000
*       THEN                                                       0677 01986000
         LA    @01,VRSG-1(@06)                                     0677 01987000
         CLI   0(@01),B'00000000'                                  0677 01988000
         BE    @RT00677                                            0677 01989000
*       ;                           /* NO,SKIP TO NEXT       @Y30LB40*/ 01990000
*     ELSE                                                         0679 01991000
*       DO;                         /* YES,PROCESS IT        @Y30LB40*/ 01992000
*         FOUNDSW='1'B;             /* INDICATE VALID FOUND          */ 01993000
         OI    FOUNDSW,B'10000000'                                 0680 01994000
*         I=51;                     /* SET SUBSTRING POINTER         */ 01995000
         LA    I,51                                                0681 01996000
*         BLKLINE(17:42)='STAGING DRIVE GROUP XX';/* SET CONSTANT    */ 01997000
         MVI   BLKLINE+38,C' '                                     0682 01998000
         MVC   BLKLINE+39(3),BLKLINE+38                            0682 01999000
         MVC   BLKLINE+16(22),@CC01149                             0682 02000000
*         WORK1=J-1;                /* GET RSG NUMBER        @Y30LB40*/ 02001000
         LH    @15,J                                               0683 02002000
         BCTR  @15,0                                               0683 02003000
         STC   @15,WORK1                                           0683 02004000
*         CALL EDITHEX(ADDR(WORK1),1);/* EDIT IT             @Y30LB40*/ 02005000
         LA    @15,WORK1                                           0684 02006000
         ST    @15,@AFTEMPS                                        0684 02007000
         LA    @15,@AFTEMPS                                        0684 02008000
         ST    @15,@AL00001                                        0684 02009000
         LA    @15,@CF00045                                        0684 02010000
         ST    @15,@AL00001+4                                      0684 02011000
         LA    @01,@AL00001                                        0684 02012000
         BAL   @14,EDITHEX                                         0684 02013000
*         BLKLINE(37:38)=HEXOUT(1:2);/* PRINT IT             @Y30LB40*/ 02014000
         MVC   BLKLINE+36(2),HEXOUT                                0685 02015000
*         STATMASK='10000000'B;     /* SET TEST MASK         @Y30LB40*/ 02016000
         MVI   STATMASK,B'10000000'                                0686 02017000
*         DO K=1 TO 8;              /* LOOP THROUGH 8 SPINDLES       */ 02018000
         LA    @15,1                                               0687 02019000
         STH   @15,K                                               0687 02020000
@DL00687 DS    0H                                                  0688 02021000
*           IF(VRSG(J)&STATMASK)=STATMASK/* IS SPINDLE VALID         */ 02022000
*             THEN                                                 0688 02023000
         LH    @14,J                                               0688 02024000
         LA    @01,VRSG-1(@14)                                     0688 02025000
         MVC   @TS00001(1),0(@01)                                  0688 02026000
         NC    @TS00001(1),STATMASK                                0688 02027000
         CLC   @TS00001(1),STATMASK                                0688 02028000
         BNE   @RF00688                                            0688 02029000
*             DO;                   /* YES                   @Y30LB40*/ 02030000
*               BLKLINE(I:I+4)='000-V';/* SET SSID FORMAT            */ 02031000
         LA    @01,BLKLINE-1(I)                                    0690 02032000
         MVC   0(5,@01),@CC01153                                   0690 02033000
*               WORK1=((J-1)*8)+(K-1);/* GET SPINDLE NUMBER          */ 02034000
         BCTR  @14,0                                               0691 02035000
         SLA   @14,3                                               0691 02036000
         BCTR  @15,0                                               0691 02037000
         ALR   @14,@15                                             0691 02038000
         STC   @14,WORK1                                           0691 02039000
*               CALL EDITHEX(ADDR(WORK1),1);/* EDIT IT       @Y30LB40*/ 02040000
         LA    @15,WORK1                                           0692 02041000
         ST    @15,@AFTEMPS                                        0692 02042000
         LA    @15,@AFTEMPS                                        0692 02043000
         ST    @15,@AL00001                                        0692 02044000
         LA    @15,@CF00045                                        0692 02045000
         ST    @15,@AL00001+4                                      0692 02046000
         LA    @01,@AL00001                                        0692 02047000
         BAL   @14,EDITHEX                                         0692 02048000
*               BLKLINE(I+1:I+2)=HEXOUT(1:2);/* PRINT IT             */ 02049000
         LA    @01,BLKLINE(I)                                      0693 02050000
         MVC   0(2,@01),HEXOUT                                     0693 02051000
*               IF(ORSG(J)&STATMASK)=STATMASK/* IS IT ONLINE         */ 02052000
*                 THEN                                             0694 02053000
         LH    @01,J                                               0694 02054000
         LA    @15,ORSG-1(@01)                                     0694 02055000
         MVC   @TS00001(1),0(@15)                                  0694 02056000
         NC    @TS00001(1),STATMASK                                0694 02057000
         CLC   @TS00001(1),STATMASK                                0694 02058000
         BNE   @RF00694                                            0694 02059000
*                 BLKLINE(I+5:I+5)='O';/* YES,INDICATE IT            */ 02060000
         LA    @01,BLKLINE+4(I)                                    0695 02061000
         MVI   0(@01),C'O'                                         0695 02062000
*               IF(RRSG(J)&STATMASK)=STATMASK/* IS IT READY          */ 02063000
*                 THEN                                             0696 02064000
@RF00694 LH    @01,J                                               0696 02065000
         LA    @15,RRSG-1(@01)                                     0696 02066000
         MVC   @TS00001(1),0(@15)                                  0696 02067000
         NC    @TS00001(1),STATMASK                                0696 02068000
         CLC   @TS00001(1),STATMASK                                0696 02069000
         BNE   @RF00696                                            0696 02070000
*                 BLKLINE(I+6:I+6)='R';/* YES,INDICATE IT            */ 02071000
         LA    @01,BLKLINE+5(I)                                    0697 02072000
         MVI   0(@01),C'R'                                         0697 02073000
*               I=I+8;              /* BUMP LINE POINTER             */ 02074000
@RF00696 AL    I,@CF00036                                          0698 02075000
*             END;                  /*                       @Y30LB40*/ 02076000
*           SRL(STATMASK,1);        /* SHIFT MASK 1 BIT      @Y30LB40*/ 02077000
@RF00688 SLR   @15,@15                                             0700 02078000
         IC    @15,STATMASK                                        0700 02079000
         SRL   @15,1                                               0700 02080000
         STC   @15,STATMASK                                        0700 02081000
*         END;                      /*                       @Y30LB40*/ 02082000
         LA    @15,1                                               0701 02083000
         AH    @15,K                                               0701 02084000
         STH   @15,K                                               0701 02085000
         C     @15,@CF00036                                        0701 02086000
         BNH   @DL00687                                            0701 02087000
*         RFY                                                      0702 02088000
*          (R0,                                                    0702 02089000
*           R1,                                                    0702 02090000
*           R14,                                                   0702 02091000
*           R15) RSTD;              /*                       @Y30LB40*/ 02092000
*         GEN(PUT   PRNTDCB,BLKLINE);/* PRINT LINE           @Y30LB40*/ 02093000
         PUT   PRNTDCB,BLKLINE                                          02094000
*         RFY                                                      0704 02095000
*          (R0,                                                    0704 02096000
*           R1,                                                    0704 02097000
*           R14,                                                   0704 02098000
*           R15) UNRSTD;            /*                       @Y30LB40*/ 02099000
*         LINECNT=LINECNT+1;        /* BUMP LINE COUNTER     @Y30LB40*/ 02100000
         AL    LINECNT,@CF00045                                    0705 02101000
*         BLKLINE=' ';              /* CLEAR PRINT LINE      @Y30LB40*/ 02102000
         MVI   BLKLINE+1,C' '                                      0706 02103000
         MVC   BLKLINE+2(119),BLKLINE+1                            0706 02104000
         MVI   BLKLINE,C' '                                        0706 02105000
*       END;                        /*                       @Y30LB40*/ 02106000
*   END;                            /*                       @Y30LB40*/ 02107000
@RT00677 LA    @06,1                                               0708 02108000
         AH    @06,J                                               0708 02109000
         STH   @06,J                                               0708 02110000
         C     @06,@CF00447                                        0708 02111000
         BNH   @DL00676                                            0708 02112000
*   IF FOUNDSW='0'B                 /* WERE ANY VALID GROUPS FOUND   */ 02113000
*     THEN                                                         0709 02114000
         TM    FOUNDSW,B'10000000'                                 0709 02115000
         BNZ   @RF00709                                            0709 02116000
*     DO;                           /* NO                    @Y30LB40*/ 02117000
*       BLKLINE(17:42)='STAGING DRIVE GROUPS';/* SET CONSTANT        */ 02118000
         MVI   BLKLINE+36,C' '                                     0711 02119000
         MVC   BLKLINE+37(5),BLKLINE+36                            0711 02120000
         MVC   BLKLINE+16(20),@CC01154                             0711 02121000
*       BLKLINE(51:54)='NONE';      /* INDICATE NONE FOUND   @Y30LB40*/ 02122000
         MVC   BLKLINE+50(4),@CC01156                              0712 02123000
*       RFY                                                        0713 02124000
*        (R0,                                                      0713 02125000
*         R1,                                                      0713 02126000
*         R14,                                                     0713 02127000
*         R15) RSTD;                /*                       @Y30LB40*/ 02128000
*       GEN(PUT   PRNTDCB,BLKLINE); /* PRINT MESSAGE         @Y30LB40*/ 02129000
         PUT   PRNTDCB,BLKLINE                                          02130000
*       RFY                                                        0715 02131000
*        (R0,                                                      0715 02132000
*         R1,                                                      0715 02133000
*         R14,                                                     0715 02134000
*         R15) UNRSTD;              /*                       @Y30LB40*/ 02135000
*       LINECNT=LINECNT+1;          /* BUMP LINE COUNT       @Y30LB40*/ 02136000
         AL    LINECNT,@CF00045                                    0716 02137000
*     END;                          /*                       @Y30LB40*/ 02138000
*   BLKLINE='0';                    /* CLEAR PRINT LINE      @Y30LB40*/ 02139000
@RF00709 MVI   BLKLINE+1,C' '                                      0718 02140000
         MVC   BLKLINE+2(119),BLKLINE+1                            0718 02141000
         MVI   BLKLINE,C'0'                                        0718 02142000
*   LINECNT=LINECNT+2;              /* BUMP LINE COUNTER     @Y30LB40*/ 02143000
         AL    LINECNT,@CF00052                                    0719 02144000
*                                                                  0720 02145000
*/********************************************************** @OZ05079*/ 02146000
*/*                                                          @OZ05079*/ 02147000
*/* PROCEDURE NAME - (SUBSECTION WITHIN) PROCREC6            @OZ05079*/ 02148000
*/*                                                          @OZ05079*/ 02149000
*/* FUNCTION - THIS SUBSECTION PRODUCES INFORMATION ON THE   @OZ05079*/ 02150000
*/*            STATUS OF THE ACCESSOR CONTROLS WITHIN EACH   @OZ05079*/ 02151000
*/*            MASS STORAGE FACILITY.                        @OZ05079*/ 02152000
*/*                                                          @OZ05079*/ 02153000
*/********************************************************** @OZ05079*/ 02154000
*                                                                  0720 02155000
*   I=51;                           /* SET SUBSTRING POINTER         */ 02156000
         LA    I,51                                                0720 02157000
*   BLKLINE(17:36)='ACCESSOR CONTROLS';/* SET CONSTANT       @OZ05079*/ 02158000
         MVI   BLKLINE+33,C' '                                     0721 02159000
         MVC   BLKLINE+34(2),BLKLINE+33                            0721 02160000
         MVC   BLKLINE+16(17),@CC01158                             0721 02161000
*   IF VL='00000000'B               /* ANY LIBRARIES VALID   @Y30LB40*/ 02162000
*     THEN                                                         0722 02163000
         CLI   VL,B'00000000'                                      0722 02164000
         BNE   @RF00722                                            0722 02165000
*     DO;                           /* NO                    @Y30LB40*/ 02166000
*       BLKLINE(51:54)='NONE';      /* INDICATE NONE FOUND   @Y30LB40*/ 02167000
         MVC   BLKLINE+50(4),@CC01156                              0724 02168000
*       RFY                                                        0725 02169000
*        (R0,                                                      0725 02170000
*         R1,                                                      0725 02171000
*         R14,                                                     0725 02172000
*         R15) RSTD;                /*                       @Y30LB40*/ 02173000
*       GEN(PUT   PRNTDCB,BLKLINE); /* PRINT LINE            @Y30LB40*/ 02174000
         PUT   PRNTDCB,BLKLINE                                          02175000
*       RFY                                                        0727 02176000
*        (R0,                                                      0727 02177000
*         R1,                                                      0727 02178000
*         R14,                                                     0727 02179000
*         R15) UNRSTD;              /*                       @Y30LB40*/ 02180000
*     END;                          /*                       @Y30LB40*/ 02181000
*   ELSE                                                           0729 02182000
*     DO;                           /* AT LEAST ONE LIBRARY VALID    */ 02183000
         B     @RC00722                                            0729 02184000
@RF00722 DS    0H                                                  0730 02185000
*       DO J=1 TO 4;                /* LOOP THROUGH 4 LIBRARIES      */ 02186000
         LA    @15,1                                               0730 02187000
         STH   @15,J                                               0730 02188000
@DL00730 DS    0H                                                  0731 02189000
*         WORK1=J-1;                /* CALC LIB NUMBER       @Y30LB40*/ 02190000
         BCTR  @15,0                                               0731 02191000
         STC   @15,WORK1                                           0731 02192000
*         CALL EDITFIX(ADDR(WORK1),1,'N');/* EDIT IT         @Y30LB40*/ 02193000
         MVC   @AL00001+4(8),@AL00732                              0732 02194000
         LA    @15,WORK1                                           0732 02195000
         ST    @15,@AFTEMPS                                        0732 02196000
         LA    @15,@AFTEMPS                                        0732 02197000
         ST    @15,@AL00001                                        0732 02198000
         LA    @01,@AL00001                                        0732 02199000
         BAL   @14,EDITFIX                                         0732 02200000
*         IF(VL&'01000000'B)='01000000'B/* IS UC1 VALID              */ 02201000
*           THEN                                                   0733 02202000
         MVC   @TS00001(1),VL                                      0733 02203000
         NI    @TS00001,B'01000000'                                0733 02204000
         CLI   @TS00001,B'01000000'                                0733 02205000
         BNE   @RF00733                                            0733 02206000
*           DO;                     /* YES                   @Y30LB40*/ 02207000
*             BLKLINE(I:I+4)='101-V';/* SET SSID PATTERN             */ 02208000
         LA    @01,BLKLINE-1(I)                                    0735 02209000
         MVC   0(5,@01),@CC01161                                   0735 02210000
*             BLKLINE(I+1:I+1)=FIXOUT(13:13);/* PUT IN LIB           */ 02211000
         LA    @01,BLKLINE(I)                                      0736 02212000
         MVC   0(1,@01),FIXOUT+12                                  0736 02213000
*             IF(OL&'01000000'B)='01000000'B/* IS UC1 ONLINE         */ 02214000
*               THEN                                               0737 02215000
         MVC   @TS00001(1),OL                                      0737 02216000
         NI    @TS00001,B'01000000'                                0737 02217000
         CLI   @TS00001,B'01000000'                                0737 02218000
         BNE   @RF00737                                            0737 02219000
*               BLKLINE(I+5:I+5)='O';/* YES,INDICATE IT              */ 02220000
         LA    @01,BLKLINE+4(I)                                    0738 02221000
         MVI   0(@01),C'O'                                         0738 02222000
*             IF(RL&'01000000'B)='01000000'B/* IS UC1 READY          */ 02223000
*               THEN                                               0739 02224000
@RF00737 MVC   @TS00001(1),RL                                      0739 02225000
         NI    @TS00001,B'01000000'                                0739 02226000
         CLI   @TS00001,B'01000000'                                0739 02227000
         BNE   @RF00739                                            0739 02228000
*               BLKLINE(I+6:I+6)='R';/* YES,INDICATE IT              */ 02229000
         LA    @01,BLKLINE+5(I)                                    0740 02230000
         MVI   0(@01),C'R'                                         0740 02231000
*             I=I+8;                /* BUMP LINE POINTER     @Y30LB40*/ 02232000
@RF00739 AL    I,@CF00036                                          0741 02233000
*           END;                    /*                       @Y30LB40*/ 02234000
*         IF(VL&'10000000'B)='10000000'B/* IS UC2 VALID              */ 02235000
*           THEN                                                   0743 02236000
@RF00733 MVC   @TS00001(1),VL                                      0743 02237000
         NI    @TS00001,B'10000000'                                0743 02238000
         CLI   @TS00001,B'10000000'                                0743 02239000
         BNE   @RF00743                                            0743 02240000
*           DO;                     /* YES                   @Y30LB40*/ 02241000
*             BLKLINE(I:I+4)='102-V';/* SET SSID PATTERN             */ 02242000
         LA    @01,BLKLINE-1(I)                                    0745 02243000
         MVC   0(5,@01),@CC01162                                   0745 02244000
*             BLKLINE(I+1:I+1)=FIXOUT(13:13);/* PUT IN LIB           */ 02245000
         LA    @01,BLKLINE(I)                                      0746 02246000
         MVC   0(1,@01),FIXOUT+12                                  0746 02247000
*             IF(OL&'10000000'B)='10000000'B/* IS UC2 ONLINE         */ 02248000
*               THEN                                               0747 02249000
         MVC   @TS00001(1),OL                                      0747 02250000
         NI    @TS00001,B'10000000'                                0747 02251000
         CLI   @TS00001,B'10000000'                                0747 02252000
         BNE   @RF00747                                            0747 02253000
*               BLKLINE(I+5:I+5)='O';/* YES,INDICATE IT              */ 02254000
         LA    @01,BLKLINE+4(I)                                    0748 02255000
         MVI   0(@01),C'O'                                         0748 02256000
*             IF(RL&'10000000'B)='10000000'B/* IS UC2 READY          */ 02257000
*               THEN                                               0749 02258000
@RF00747 MVC   @TS00001(1),RL                                      0749 02259000
         NI    @TS00001,B'10000000'                                0749 02260000
         CLI   @TS00001,B'10000000'                                0749 02261000
         BNE   @RF00749                                            0749 02262000
*               BLKLINE(I+6:I+6)='R';/* YES,INDICATE IT              */ 02263000
         LA    @01,BLKLINE+5(I)                                    0750 02264000
         MVI   0(@01),C'R'                                         0750 02265000
*             I=I+8;                /* BUMP LINE POINTER     @Y30LB40*/ 02266000
@RF00749 AL    I,@CF00036                                          0751 02267000
*           END;                    /*                       @Y30LB40*/ 02268000
*         SLL(VL,2);                /* SHIFT VL 2 BITS       @Y30LB40*/ 02269000
@RF00743 SLR   @15,@15                                             0753 02270000
         IC    @15,VL                                              0753 02271000
         SLL   @15,2                                               0753 02272000
         STC   @15,VL                                              0753 02273000
*         SLL(OL,2);                /* SHIFT OL 2 BITS       @Y30LB40*/ 02274000
         SLR   @15,@15                                             0754 02275000
         IC    @15,OL                                              0754 02276000
         SLL   @15,2                                               0754 02277000
         STC   @15,OL                                              0754 02278000
*         SLL(RL,2);                /* SHIFT RL 2 BITS       @Y30LB40*/ 02279000
         SLR   @15,@15                                             0755 02280000
         IC    @15,RL                                              0755 02281000
         SLL   @15,2                                               0755 02282000
         STC   @15,RL                                              0755 02283000
*       END;                        /*                       @Y30LB40*/ 02284000
         LA    @15,1                                               0756 02285000
         AH    @15,J                                               0756 02286000
         STH   @15,J                                               0756 02287000
         C     @15,@CF00104                                        0756 02288000
         BNH   @DL00730                                            0756 02289000
*       RFY                                                        0757 02290000
*        (R0,                                                      0757 02291000
*         R1,                                                      0757 02292000
*         R14,                                                     0757 02293000
*         R15) RSTD;                /*                       @Y30LB40*/ 02294000
*       GEN(PUT   PRNTDCB,BLKLINE); /* PRINT LINE            @Y30LB40*/ 02295000
         PUT   PRNTDCB,BLKLINE                                          02296000
*       RFY                                                        0759 02297000
*        (R0,                                                      0759 02298000
*         R1,                                                      0759 02299000
*         R14,                                                     0759 02300000
*         R15) UNRSTD;              /*                       @Y30LB40*/ 02301000
*     END;                          /*                       @Y30LB40*/ 02302000
*   END PROCREC6;                   /*                       @OZ05079*/ 02303000
@EL00007 DS    0H                                                  0761 02304000
@EF00007 DS    0H                                                  0761 02305000
@ER00007 LM    @14,@06,@SA00007                                    0761 02306000
         LM    @08,@12,@SA00007+36                                 0761 02307000
         BR    @14                                                 0761 02308000
*                                                                  0762 02309000
*/********************************************************** @OZ05079*/ 02310000
*/*                                                          @OZ05079*/ 02311000
*/* PROCEDURE NAME - HEADPRNT                                @OZ05079*/ 02312000
*/*                                                          @OZ05079*/ 02313000
*/* FUNCTION - PRINT THE LAST (OR ONLY) LINE FOR EACH        @OZ05079*/ 02314000
*/*            SUBSYSTEM DEVICE TYPE.  IF NO DEVICES WERE    @OZ05079*/ 02315000
*/*            FOUND TO BE VALID, PRINT 'NONE'.              @OZ05079*/ 02316000
*/*                                                          @OZ05079*/ 02317000
*/********************************************************** @OZ05079*/ 02318000
*                                                                  0762 02319000
*HEADPRNT:                                                         0762 02320000
*   PROCEDURE;                      /*                       @OZ05079*/ 02321000
HEADPRNT STM   @14,@05,@SA00008                                    0762 02322000
         STM   @08,@12,@SA00008+32                                 0762 02323000
*   IF I=51                         /* IS POINTER AT START OF LINE   */ 02324000
*     THEN                                                         0763 02325000
         C     I,@CF00484                                          0763 02326000
         BNE   @RF00763                                            0763 02327000
*     IF FOUNDSW='0'B               /* YES,WERE ANY VALIDS FOUND     */ 02328000
*       THEN                                                       0764 02329000
         TM    FOUNDSW,B'10000000'                                 0764 02330000
         BNZ   @RF00764                                            0764 02331000
*       DO;                         /* NO VALIDS FOUND       @Y30LB40*/ 02332000
*         BLKLINE(51:54)='NONE';    /* INDICATE NONE FOUND   @Y30LB40*/ 02333000
         MVC   BLKLINE+50(4),@CC01156                              0766 02334000
*         RFY                                                      0767 02335000
*          (R0,                                                    0767 02336000
*           R1,                                                    0767 02337000
*           R14,                                                   0767 02338000
*           R15) RSTD;              /*                       @Y30LB40*/ 02339000
*         GEN(PUT   PRNTDCB,BLKLINE);/* PRINT LINE           @Y30LB40*/ 02340000
         PUT   PRNTDCB,BLKLINE                                          02341000
*         RFY                                                      0769 02342000
*          (R0,                                                    0769 02343000
*           R1,                                                    0769 02344000
*           R14,                                                   0769 02345000
*           R15) UNRSTD;            /*                       @Y30LB40*/ 02346000
*         LINECNT=LINECNT+1;        /* BUMP LINE COUNTER     @Y30LB40*/ 02347000
         AL    LINECNT,@CF00045                                    0770 02348000
*       END;                        /*                       @Y30LB40*/ 02349000
*     ELSE                                                         0772 02350000
*       ;                           /* VALIDS FOUND,LINE ALREADY   0772 02351000
*                                      WRITTEN               @Y30LB40*/ 02352000
@RF00764 DS    0H                                                  0773 02353000
*   ELSE                                                           0773 02354000
*     DO;                           /* POINTER NOT 51        @Y30LB40*/ 02355000
         B     @RC00763                                            0773 02356000
@RF00763 DS    0H                                                  0774 02357000
*       RFY                                                        0774 02358000
*        (R0,                                                      0774 02359000
*         R1,                                                      0774 02360000
*         R14,                                                     0774 02361000
*         R15) RSTD;                /*                       @Y30LB40*/ 02362000
*       GEN(PUT   PRNTDCB,BLKLINE); /* PRINT LINE            @Y30LB40*/ 02363000
         PUT   PRNTDCB,BLKLINE                                          02364000
*       RFY                                                        0776 02365000
*        (R0,                                                      0776 02366000
*         R1,                                                      0776 02367000
*         R14,                                                     0776 02368000
*         R15) UNRSTD;              /*                       @Y30LB40*/ 02369000
*       LINECNT=LINECNT+1;          /* BUMP LINE COUNTER     @Y30LB40*/ 02370000
         AL    LINECNT,@CF00045                                    0777 02371000
*     END;                          /*                       @Y30LB40*/ 02372000
*   BLKLINE='0';                    /* CLEAR PRINT LINE      @Y30LB40*/ 02373000
@RC00763 MVI   BLKLINE+1,C' '                                      0779 02374000
         MVC   BLKLINE+2(119),BLKLINE+1                            0779 02375000
         MVI   BLKLINE,C'0'                                        0779 02376000
*   LINECNT=LINECNT+1;              /* BUMP LINE COUNTER     @Y30LB40*/ 02377000
         AL    LINECNT,@CF00045                                    0780 02378000
*   I=51;                           /* SET SUBSTRING POINTER         */ 02379000
         LA    I,51                                                0781 02380000
*   END HEADPRNT;                   /*                       @OZ05079*/ 02381000
@EL00008 DS    0H                                                  0782 02382000
@EF00008 DS    0H                                                  0782 02383000
@ER00008 LM    @14,@05,@SA00008                                    0782 02384000
         LM    @08,@12,@SA00008+32                                 0782 02385000
         BR    @14                                                 0782 02386000
*                                                                  0783 02387000
*/********************************************************** @OZ05079*/ 02388000
*/*                                                          @OZ05079*/ 02389000
*/* PROCEDURE NAME - REFORMAT                                @OZ05079*/ 02390000
*/*                                                          @OZ05079*/ 02391000
*/* FUNCTION - BUILD REFORMATTED EXTRACT RECORD              @OZ05079*/ 02392000
*/*                                                          @OZ05079*/ 02393000
*/********************************************************** @OZ05079*/ 02394000
*                                                                  0783 02395000
*REFORMAT:                                                         0783 02396000
*   PROCEDURE;                      /*                       @OZ05079*/ 02397000
REFORMAT STM   @14,@12,@SA00009                                    0783 02398000
*   RCDOUT=RCDOUT&&RCDOUT;          /* INIT OUTPUT RECORD TO ZEROS 0784 02399000
*                                                            @Y30LB40*/ 02400000
         XC    RCDOUT(72),RCDOUT                                   0784 02401000
*   PTR2=ADDR(FIRSTMIN);            /* SET POINTER TO 1ST MINI HDR   */ 02402000
         LA    @15,FIRSTMIN                                        0785 02403000
         ST    @15,PTR2                                            0785 02404000
*   LSTMINAD=ADDR(FIRSTMIN)-ADDR(BLOCKFLG);/* INITIALIZE     @YM31015   02405000
*                                      LAST ADDRESS          @YM31015*/ 02406000
         LA    LSTMINAD,32                                         0786 02407000
*   MINI1SW='1'B;                   /* SET FIRST MINI SWITCH @Y30LB40*/ 02408000
         OI    MINI1SW,B'10000000'                                 0787 02409000
*   HIT5TIME=0;                     /* CLEAR HIGH T5 TIME HOLD AREA     02410000
*                                                            @Y30LB40*/ 02411000
         SLR   HIT5TIME,HIT5TIME                                   0788 02412000
*MINILOOP:                          /* LOOP THROUGH THE MINI HDRS    */ 02413000
*   IF FLAG(2:2)='1'B               /* IS THIS A NON DATA MINI HEADER   02414000
*                                                            @Y30LB40*/ 02415000
*       |T4TIME=0&T5TIME=0          /* IS THIS A NULL MINI   @OZ05079*/ 02416000
*     THEN                                                         0789 02417000
MINILOOP L     @15,PTR2                                            0789 02418000
         TM    FLAG(@15),B'01000000'                               0789 02419000
         BO    @RT00789                                            0789 02420000
         LH    @14,T4TIME(,@15)                                    0789 02421000
         N     @14,@CF01285                                        0789 02422000
         LTR   @14,@14                                             0789 02423000
         BNZ   @RF00789                                            0789 02424000
         LH    @15,T5TIME(,@15)                                    0789 02425000
         N     @15,@CF01285                                        0789 02426000
         LTR   @15,@15                                             0789 02427000
         BNZ   @RF00789                                            0789 02428000
@RT00789 DS    0H                                                  0790 02429000
*     DO;                           /* YES                   @Y30LB40*/ 02430000
*       IF NXTMINAD^=0              /* IS IT THE LAST MINI   @Y30LB40*/ 02431000
*         THEN                                                     0791 02432000
         L     @15,PTR2                                            0791 02433000
         CLI   NXTMINAD(@15),0                                     0791 02434000
         BE    @RF00791                                            0791 02435000
*         DO;                       /* NO, NOT LAST          @Y30LB40*/ 02436000
*           IF NXTMINAD<=LSTMINAD   /* SET NEXT POINTER      @YM31015*/ 02437000
*             THEN                                                 0793 02438000
         SLR   @14,@14                                             0793 02439000
         IC    @14,NXTMINAD(,@15)                                  0793 02440000
         CR    @14,LSTMINAD                                        0793 02441000
         BNH   @RT00793                                            0793 02442000
*             RETURN;               /* READ ANOTHER RECORD   @OZ05079*/ 02443000
*           LSTMINAD=NXTMINAD;      /* SET LAST POINTER      @YM31015*/ 02444000
         LR    LSTMINAD,@14                                        0795 02445000
*           PTR2=ADDR(RECIN)+NXTMINAD+8;/* SET               @YM31015   02446000
*                                      POINTER               @YM31015*/ 02447000
         LA    @15,RECIN                                           0796 02448000
         ALR   @15,@14                                             0796 02449000
         AL    @15,@CF00036                                        0796 02450000
         ST    @15,PTR2                                            0796 02451000
*           GO TO MINILOOP;         /* PTR OK GO PROCESS NEXT MINI 0797 02452000
*                                                            @Y30LB40*/ 02453000
         B     MINILOOP                                            0797 02454000
*         END;                      /*                       @Y30LB40*/ 02455000
*       ELSE                                                       0799 02456000
*         GO TO CKREC;              /* LAST MINI FINISH PROCESS    0799 02457000
*                                                            @Y30LB40*/ 02458000
*     END;                          /*                       @Y30LB40*/ 02459000
*   IF MINI1SW='1'B                 /* IS THIS THE FIRST DATA MINI 0801 02460000
*                                                            @Y30LB40*/ 02461000
*     THEN                          /* YES,START REFORMATTING WITH 0801 02462000
*                                      FIXED DATA                    */ 02463000
@RF00789 TM    MINI1SW,B'10000000'                                 0801 02464000
         BNO   @RF00801                                            0801 02465000
*     CALL DOCOMMON;                /* INFO FROM BLOCK HDR   @OZ05079*/ 02466000
         BAL   @14,DOCOMMON                                        0802 02467000
*   ELSE                                                           0803 02468000
*     ;                             /*                       @OZ05079*/ 02469000
@RF00801 DS    0H                                                  0804 02470000
*   CALL DOMINIS;                   /* ALWAYS GET MINI       @OZ05079*/ 02471000
         BAL   @14,DOMINIS                                         0804 02472000
*CKREC:                                                            0805 02473000
*   IF NXTMINAD=0                   /* IS THIS LAST MINI HEADER    0805 02474000
*                                                            @Y30LB40*/ 02475000
*     THEN                                                         0805 02476000
CKREC    L     @01,PTR2                                            0805 02477000
         CLI   NXTMINAD(@01),0                                     0805 02478000
         BNE   @RF00805                                            0805 02479000
*     DO;                           /* CHECK FOR VALID OUTPUT RECORD    02480000
*                                                            @Y30LB40*/ 02481000
*       IF CKTIME<CKSTIME|CKTIME>CKETIME|(STGD+DSTGD)=0|PAGES=0 THEN    02482000
         CLC   CKTIME(7),CKSTIME                                   0807 02483000
         BL    @RT00807                                            0807 02484000
         CLC   CKTIME(7),CKETIME                                   0807 02485000
         BH    @RT00807                                            0807 02486000
         SLR   @06,@06                                             0807 02487000
         L     @15,STGD                                            0807 02488000
         AL    @15,DSTGD                                           0807 02489000
         CR    @15,@06                                             0807 02490000
         BE    @RT00807                                            0807 02491000
         CLI   PAGES,0                                             0807 02492000
         BE    @RT00807                                            0807 02493000
*         RETURN;                   /* RECORD NOT VALID,SKIP IT    0808 02494000
*                                                            @Y30LB40*/ 02495000
*       ELSE                                                       0809 02496000
*         DO;                       /* RECORD VALID          @Y30LB40*/ 02497000
*           IF HOLDT2TM=0&HOLDT3TM=0 THEN                          0810 02498000
         C     @06,HOLDT2TM                                        0810 02499000
         BNE   @RF00810                                            0810 02500000
         C     @06,HOLDT3TM                                        0810 02501000
         BNE   @RF00810                                            0810 02502000
*             BUSYTIME=DEVSGTM+DEVDSTM;/* CALC BUSY TIME             */ 02503000
         L     @15,DEVSGTM                                         0811 02504000
         AL    @15,DEVDSTM                                         0811 02505000
         ST    @15,BUSYTIME                                        0811 02506000
*           ELSE                                                   0812 02507000
*             BUSYTIME=HIT5TIME-HOLDT2TM;/* CALC BUSY TIME           */ 02508000
         B     @RC00810                                            0812 02509000
@RF00810 LR    @06,HIT5TIME                                        0812 02510000
         SL    @06,HOLDT2TM                                        0812 02511000
         ST    @06,BUSYTIME                                        0812 02512000
*           RFY                                                    0813 02513000
*            (R0,                                                  0813 02514000
*             R1,                                                  0813 02515000
*             R14,                                                 0813 02516000
*             R15) RSTD;            /*                       @Y30LB40*/ 02517000
@RC00810 DS    0H                                                  0814 02518000
*           GEN(PUT   OUTDCB,RCDOUT);/* WRITE RECORD AND COUNT IT    */ 02519000
         PUT   OUTDCB,RCDOUT                                            02520000
*           RFY                                                    0815 02521000
*            (R0,                                                  0815 02522000
*             R1,                                                  0815 02523000
*             R14,                                                 0815 02524000
*             R15) UNRSTD;          /*                       @Y30LB40*/ 02525000
*           OUTCOUNT=OUTCOUNT+1;    /*                       @Y30LB40*/ 02526000
         LA    @15,1                                               0816 02527000
         AL    @15,OUTCOUNT                                        0816 02528000
         ST    @15,OUTCOUNT                                        0816 02529000
*           RETURN;                 /*                       @OZ05079*/ 02530000
@EL00009 DS    0H                                                  0817 02531000
@EF00009 DS    0H                                                  0817 02532000
@ER00009 LM    @14,@12,@SA00009                                    0817 02533000
         BR    @14                                                 0817 02534000
*         END;                      /*                       @Y30LB40*/ 02535000
*     END;                          /*                       @Y30LB40*/ 02536000
*   IF NXTMINAD<=LSTMINAD           /* SET NEXT ADDRESS      @YM31015*/ 02537000
*     THEN                                                         0820 02538000
@RF00805 L     @01,PTR2                                            0820 02539000
         SLR   @15,@15                                             0820 02540000
         IC    @15,NXTMINAD(,@01)                                  0820 02541000
         CR    @15,LSTMINAD                                        0820 02542000
         BNH   @RT00820                                            0820 02543000
*     RETURN;                       /* GO TO NEXT ROUTINE    @OZ05079*/ 02544000
*   LSTMINAD=NXTMINAD;              /* SET LAST ADDRESS      @YM31015*/ 02545000
         LR    LSTMINAD,@15                                        0822 02546000
*   PTR2=ADDR(RECIN)+NXTMINAD+8;    /* SET POINTER           @YM31015*/ 02547000
         LA    @14,RECIN                                           0823 02548000
         ALR   @14,@15                                             0823 02549000
         AL    @14,@CF00036                                        0823 02550000
         ST    @14,PTR2                                            0823 02551000
*   GO TO MINILOOP;                 /* PTR OK, GO PROCESS NEXT MINI     02552000
*                                                            @Y30LB40*/ 02553000
         B     MINILOOP                                            0824 02554000
*   END REFORMAT;                   /*                       @OZ05079*/ 02555000
         B     @EL00009                                            0825 02556000
*                                                                  0826 02557000
*/********************************************************** @OZ05079*/ 02558000
*/*                                                          @OZ05079*/ 02559000
*/* PROCEDURE NAME - DOCOMMON                                @OZ05079*/ 02560000
*/*                                                          @OZ05079*/ 02561000
*/* FUNCTION - PICK UP FROM THE BLOCK HEADER PORTION OF THE  @OZ05079*/ 02562000
*/*            RECORD BEING PROCESSED THE INFORMATION COMMON @OZ05079*/ 02563000
*/*            TO ALL MINI-HEADERS IN THE RECORD.  THE       @OZ05079*/ 02564000
*/*            COMMON INFORMATION IS                         @OZ05079*/ 02565000
*/*            - TIMES T1, T2, AND T3                        @OZ05079*/ 02566000
*/*            - VOLID AND CO-ORDINATES OF CARTRIDGE         @OZ05079*/ 02567000
*/*            - DRD, DRC, AND STAGING ADAPTER               @OZ05079*/ 02568000
*/*            THIS INFORMATION IS CARRIED FORWARD INTO      @OZ05079*/ 02569000
*/*            THE REFORMATTED RECORD.                       @OZ05079*/ 02570000
*/*                                                          @OZ05079*/ 02571000
*/********************************************************** @OZ05079*/ 02572000
*                                                                  0826 02573000
*DOCOMMON:                                                         0826 02574000
*   PROCEDURE;                      /*                       @OZ05079*/ 02575000
DOCOMMON STM   @14,@12,@SA00010                                    0826 02576000
*   MINI1SW='0'B;                   /* RESET SWITCH          @Y30LB40*/ 02577000
         NI    MINI1SW,B'01111111'                                 0827 02578000
*   CALL SDTABLE;                   /* CONVERT TIMES AND SAVE DATES     02579000
*                                                            @Y30LB40*/ 02580000
         BAL   @14,SDTABLE                                         0828 02581000
*   HOLDT1TM=T1TIME;                /* GET MIDDLE TWO BYTES OF T1  0829 02582000
*                                      TIME                  @Y30LB40*/ 02583000
         L     @01,PTR2                                            0829 02584000
         L     HOLDT1TM,T1TIME(,@01)                               0829 02585000
*   SLL(HOLDT1TM,8);                /*                       @Y30LB40*/ 02586000
         SLL   HOLDT1TM,8                                          0830 02587000
*   SRL(HOLDT1TM,16);               /*                       @Y30LB40*/ 02588000
         SRL   HOLDT1TM,16                                         0831 02589000
*   HOLDT2TM=T2TIME;                /* EXPAND T2 TIME TO FULLWORD  0832 02590000
*                                                            @Y30LB40*/ 02591000
         LH    @03,T2TIME                                          0832 02592000
         N     @03,@CF01285                                        0832 02593000
         ST    @03,HOLDT2TM                                        0832 02594000
*   HOLDT3TM=T3TIME;                /* EXPAND T3 TIME TO FULLWORD  0833 02595000
*                                                            @Y30LB40*/ 02596000
         LH    @15,T3TIME                                          0833 02597000
         N     @15,@CF01285                                        0833 02598000
         ST    @15,HOLDT3TM                                        0833 02599000
*   IF HOLDT2TM=0&HOLDT3TM=0        /* IF T2 AND T3 ZERO     @Y30LB40*/ 02600000
*     THEN                                                         0834 02601000
         SLR   @14,@14                                             0834 02602000
         CR    @03,@14                                             0834 02603000
         BNE   @RF00834                                            0834 02604000
         CR    @15,@14                                             0834 02605000
         BE    @RT00834                                            0834 02606000
*     ;                             /* NO LOAD,SKIP ROLLOVER CHECK 0835 02607000
*                                                            @Y30LB40*/ 02608000
*   ELSE                                                           0836 02609000
*     DO;                           /*                       @Y30LB40*/ 02610000
@RF00834 DS    0H                                                  0837 02611000
*       IF HOLDT1TM>HOLDT2TM        /* IS THERE A ROLLOVER   @Y30LB40*/ 02612000
*         THEN                                                     0837 02613000
         L     @03,HOLDT2TM                                        0837 02614000
         CR    HOLDT1TM,@03                                        0837 02615000
         BNH   @RF00837                                            0837 02616000
*         DO;                       /* YES,BUMP T2 AND T3    @Y30LB40*/ 02617000
*           HOLDT2TM=HOLDT2TM+ROLLOVER;/*                    @Y30LB40*/ 02618000
         L     @02,ROLLOVER                                        0839 02619000
         ALR   @03,@02                                             0839 02620000
         ST    @03,HOLDT2TM                                        0839 02621000
*           HOLDT3TM=HOLDT3TM+ROLLOVER;/*                    @Y30LB40*/ 02622000
         AL    @02,HOLDT3TM                                        0840 02623000
         ST    @02,HOLDT3TM                                        0840 02624000
*         END;                      /*                       @Y30LB40*/ 02625000
*       IF HOLDT2TM>HOLDT3TM        /* IS THERE A ROLLOVER   @Y30LB40*/ 02626000
*         THEN                                                     0842 02627000
@RF00837 L     @15,HOLDT3TM                                        0842 02628000
         C     @15,HOLDT2TM                                        0842 02629000
         BNL   @RF00842                                            0842 02630000
*         HOLDT3TM=HOLDT3TM+ROLLOVER;/* YES,BUMP T3                  */ 02631000
         AL    @15,ROLLOVER                                        0843 02632000
         ST    @15,HOLDT3TM                                        0843 02633000
*       LOADTIME=LOADTIME+(HOLDT3TM-HOLDT2TM);/* CALC LOADTIME       */ 02634000
@RF00842 L     @15,HOLDT3TM                                        0844 02635000
         SL    @15,HOLDT2TM                                        0844 02636000
         AL    @15,LOADTIME                                        0844 02637000
         ST    @15,LOADTIME                                        0844 02638000
*       LOADNUM=LOADNUM+1;          /* INCREMENT NUMBER OF LOADS     */ 02639000
         IC    @01,LOADNUM                                         0845 02640000
         LA    @01,1(,@01)                                         0845 02641000
         STC   @01,LOADNUM                                         0845 02642000
*     END;                          /*                       @Y30LB40*/ 02643000
*   RCOVOLID=VOLID;                 /* PICK UP VOLID         @Y30LB40*/ 02644000
@RT00834 MVC   RCOVOLID(6),VOLID                                   0847 02645000
*   CALL TRDRCDRD;                  /* DRC/LOGICAL DRD TRANS @OZ05079*/ 02646000
         BAL   @14,TRDRCDRD                                        0848 02647000
*   READWRIT=DRDPRINT;              /* PHYSICAL DRD IN BINARY      0849 02648000
*                                                            @OZ05079*/ 02649000
         IC    @15,DRDPRINT                                        0849 02650000
         STC   @15,READWRIT                                        0849 02651000
*   CHARDRC=DRCPRINT;               /* DRC IN EBCDIC         @OZ05079*/ 02652000
         MVC   CHARDRC(1),DRCPRINT                                 0850 02653000
*   IF PAIRNUM='1'B THEN                                           0851 02654000
         TM    PAIRNUM,B'00001000'                                 0851 02655000
         BNO   @RF00851                                            0851 02656000
*     CARTPAIR(8:8)='1'B;           /* PICKUP CART PAIR              */ 02657000
         OI    CARTPAIR,B'00000001'                                0852 02658000
*   IF L(1:1)='1'B THEN                                            0853 02659000
@RF00851 TM    L,B'10000000'                                       0853 02660000
         BNO   @RF00853                                            0853 02661000
*     LIBRARY(7:7)='1'B;            /* PICKUP LIBRARY                */ 02662000
         OI    LIBRARY,B'00000010'                                 0854 02663000
*   IF L(2:2)='1'B THEN                                            0855 02664000
@RF00853 TM    L,B'01000000'                                       0855 02665000
         BNO   @RF00855                                            0855 02666000
*     LIBRARY(8:8)='1'B;            /*                       @Y30LB40*/ 02667000
         OI    LIBRARY,B'00000001'                                 0856 02668000
*   IF Z='1'B THEN                                                 0857 02669000
@RF00855 TM    Z,B'00100000'                                       0857 02670000
         BNO   @RF00857                                            0857 02671000
*     RCOZ(8:8)='1'B;               /* PICKUP Z COORD                */ 02672000
         OI    RCOZ,B'00000001'                                    0858 02673000
*   IF Y(1:1)='1'B THEN                                            0859 02674000
@RF00857 TM    Y,B'00010000'                                       0859 02675000
         BNO   @RF00859                                            0859 02676000
*     RCOY(4:4)='1'B;               /* PICKUP Y COORD                */ 02677000
         OI    RCOY,B'00010000'                                    0860 02678000
*   IF Y(2:2)='1'B THEN                                            0861 02679000
@RF00859 TM    Y,B'00001000'                                       0861 02680000
         BNO   @RF00861                                            0861 02681000
*     RCOY(5:5)='1'B;               /*                       @Y30LB40*/ 02682000
         OI    RCOY,B'00001000'                                    0862 02683000
*   IF Y(3:3)='1'B THEN                                            0863 02684000
@RF00861 TM    Y,B'00000100'                                       0863 02685000
         BNO   @RF00863                                            0863 02686000
*     RCOY(6:6)='1'B;               /*                       @Y30LB40*/ 02687000
         OI    RCOY,B'00000100'                                    0864 02688000
*   IF Y(4:4)='1'B THEN                                            0865 02689000
@RF00863 TM    Y,B'00000010'                                       0865 02690000
         BNO   @RF00865                                            0865 02691000
*     RCOY(7:7)='1'B;               /*                       @Y30LB40*/ 02692000
         OI    RCOY,B'00000010'                                    0866 02693000
*   IF Y(5:5)='1'B THEN                                            0867 02694000
@RF00865 TM    Y,B'00000001'                                       0867 02695000
         BNO   @RF00867                                            0867 02696000
*     RCOY(8:8)='1'B;               /*                       @Y30LB40*/ 02697000
         OI    RCOY,B'00000001'                                    0868 02698000
*   RCOX=X;                         /* PICKUP X COORD                */ 02699000
@RF00867 MVC   RCOX(1),X                                           0869 02700000
*   IF DS2VALID='1'B&DS2IOS='1'B    /* WAS DS2 USED          @Y30LB40*/ 02701000
*     THEN                                                         0870 02702000
         TM    DS2VALID,B'00010100'                                0870 02703000
         BNO   @RF00870                                            0870 02704000
*     DO;                           /* YES,PICKUP DS2 ADDRESS        */ 02705000
*       IF DS2PORT='1'B THEN                                       0872 02706000
         TM    DS2PORT,B'00001000'                                 0872 02707000
         BNO   @RF00872                                            0872 02708000
*         DSPORT(8:8)='1'B;         /*                       @Y30LB40*/ 02709000
         OI    DSPORT,B'00000001'                                  0873 02710000
*       IF DS2CU(1:1)='1'B THEN                                    0874 02711000
@RF00872 TM    DS2CU,B'00000100'                                   0874 02712000
         BNO   @RF00874                                            0874 02713000
*         DSCU(6:6)='1'B;           /*                       @Y30LB40*/ 02714000
         OI    DSCU,B'00000100'                                    0875 02715000
*       IF DS2CU(2:2)='1'B THEN                                    0876 02716000
@RF00874 TM    DS2CU,B'00000010'                                   0876 02717000
         BNO   @RF00876                                            0876 02718000
*         DSCU(7:7)='1'B;           /*                       @Y30LB40*/ 02719000
         OI    DSCU,B'00000010'                                    0877 02720000
*       IF DS2CU(3:3)='1'B THEN                                    0878 02721000
@RF00876 TM    DS2CU,B'00000001'                                   0878 02722000
         BNO   @RF00878                                            0878 02723000
*         DSCU(8:8)='1'B;           /*                       @Y30LB40*/ 02724000
         OI    DSCU,B'00000001'                                    0879 02725000
*     END;                          /*                       @Y30LB40*/ 02726000
*   ELSE                                                           0881 02727000
*     DO;                           /* PICK UP DS1 ADDRESS           */ 02728000
         B     @RC00870                                            0881 02729000
@RF00870 DS    0H                                                  0882 02730000
*       IF DS1PORT='1'B THEN                                       0882 02731000
         TM    DS1PORT,B'00001000'                                 0882 02732000
         BNO   @RF00882                                            0882 02733000
*         DSPORT(8:8)='1'B;         /*                       @Y30LB40*/ 02734000
         OI    DSPORT,B'00000001'                                  0883 02735000
*       IF DS1CU(1:1)='1'B THEN                                    0884 02736000
@RF00882 TM    DS1CU,B'00000100'                                   0884 02737000
         BNO   @RF00884                                            0884 02738000
*         DSCU(6:6)='1'B;           /*                       @Y30LB40*/ 02739000
         OI    DSCU,B'00000100'                                    0885 02740000
*       IF DS1CU(2:2)='1'B THEN                                    0886 02741000
@RF00884 TM    DS1CU,B'00000010'                                   0886 02742000
         BNO   @RF00886                                            0886 02743000
*         DSCU(7:7)='1'B;           /*                       @Y30LB40*/ 02744000
         OI    DSCU,B'00000010'                                    0887 02745000
*       IF DS1CU(3:3)='1'B THEN                                    0888 02746000
@RF00886 TM    DS1CU,B'00000001'                                   0888 02747000
         BNO   @RF00888                                            0888 02748000
*         DSCU(8:8)='1'B;           /*                       @Y30LB40*/ 02749000
         OI    DSCU,B'00000001'                                    0889 02750000
*     END;                          /*                       @Y30LB40*/ 02751000
@RF00888 DS    0H                                                  0891 02752000
*   SDGINBIN=RSPINDGP;              /* SDG NUMBER            @ZA13479*/ 02753000
@RC00870 MVC   SDGINBIN(1),RSPINDGP                                0891 02754000
*   END DOCOMMON;                   /*                       @OZ05079*/ 02755000
@EL00010 DS    0H                                                  0892 02756000
@EF00010 DS    0H                                                  0892 02757000
@ER00010 LM    @14,@12,@SA00010                                    0892 02758000
         BR    @14                                                 0892 02759000
*                                                                  0893 02760000
*/********************************************************** @OZ05079*/ 02761000
*/*                                                          @OZ05079*/ 02762000
*/* PROCEDURE NAME - DOMINIS                                 @OZ05079*/ 02763000
*/*                                                          @OZ05079*/ 02764000
*/* FUNCTION - THIS PROCEDURE PROCESSES ALL STAGE AND        @OZ05079*/ 02765000
*/*            DESTAGE MINI-HEADERS.  IN THIS PROCEDURE      @OZ05079*/ 02766000
*/*            T4 TIME AND T5 TIME ARE DEVELOPED, AND A      @OZ05079*/ 02767000
*/*            COUNT OF THE STAGING AND DESTAGING            @OZ05079*/ 02768000
*/*            STATISTICS IS MADE.                           @OZ05079*/ 02769000
*/*                                                          @OZ05079*/ 02770000
*/********************************************************** @OZ05079*/ 02771000
*                                                                  0893 02772000
*DOMINIS:                                                          0893 02773000
*   PROCEDURE;                      /*                       @OZ05079*/ 02774000
DOMINIS  STM   @14,@06,12(@13)                                     0893 02775000
         STM   @08,@12,52(@13)                                     0893 02776000
*   HOLDT1TM=T1TIME;                /* GET MIDDLE TWO BYTES OF T1  0894 02777000
*                                      TIME                  @Y30LB40*/ 02778000
         L     @06,PTR2                                            0894 02779000
         L     HOLDT1TM,T1TIME(,@06)                               0894 02780000
*   SLL(HOLDT1TM,8);                /*                       @Y30LB40*/ 02781000
         SLL   HOLDT1TM,8                                          0895 02782000
*   SRL(HOLDT1TM,16);               /*                       @Y30LB40*/ 02783000
         SRL   HOLDT1TM,16                                         0896 02784000
*   HOLDT4TM=T4TIME;                /* EXPAND T4 TO FULLWORD @Y30LB40*/ 02785000
         LH    HOLDT4TM,T4TIME(,@06)                               0897 02786000
         N     HOLDT4TM,@CF01285                                   0897 02787000
*   HOLDT5TM=T5TIME;                /* EXPAND T5 TO FULLWORD @Y30LB40*/ 02788000
         LH    HOLDT5TM,T5TIME(,@06)                               0898 02789000
         N     HOLDT5TM,@CF01285                                   0898 02790000
*   IF HOLDT1TM>HOLDT4TM            /* IS THERE A ROLLOVER   @Y30LB40*/ 02791000
*     THEN                                                         0899 02792000
         CR    HOLDT1TM,HOLDT4TM                                   0899 02793000
         BNH   @RF00899                                            0899 02794000
*     DO;                           /* YES                   @Y30LB40*/ 02795000
*       HOLDT4TM=HOLDT4TM+ROLLOVER; /* BUMP T4               @Y30LB40*/ 02796000
         L     @06,ROLLOVER                                        0901 02797000
         ALR   HOLDT4TM,@06                                        0901 02798000
*       HOLDT5TM=HOLDT5TM+ROLLOVER; /* BUMP T5               @Y30LB40*/ 02799000
         ALR   HOLDT5TM,@06                                        0902 02800000
*     END;                          /*                       @Y30LB40*/ 02801000
*   IF HOLDT4TM>HOLDT5TM            /* IS THERE A ROLLOVER   @Y30LB40*/ 02802000
*     THEN                                                         0904 02803000
@RF00899 CR    HOLDT4TM,HOLDT5TM                                   0904 02804000
         BNH   @RF00904                                            0904 02805000
*     HOLDT5TM=HOLDT5TM+ROLLOVER;   /* YES,BUMP T5           @Y30LB40*/ 02806000
         AL    HOLDT5TM,ROLLOVER                                   0905 02807000
*   IF HOLDT5TM>HIT5TIME            /* SAVE HIGHEST T5 IN BLOCK    0906 02808000
*                                                            @Y30LB40*/ 02809000
*     THEN                                                         0906 02810000
@RF00904 CR    HOLDT5TM,HIT5TIME                                   0906 02811000
         BNH   @RF00906                                            0906 02812000
*     HIT5TIME=HOLDT5TM;            /*                       @Y30LB40*/ 02813000
         LR    HIT5TIME,HOLDT5TM                                   0907 02814000
*   FLD2=COUNT;                     /*                       @Y30LB40*/ 02815000
@RF00906 L     @01,PTR2                                            0908 02816000
         MVC   FLD2(1),COUNT(@01)                                  0908 02817000
*   PAGES=PAGES+CONVERT;            /* PICKUP NUMBER OF PAGES      0909 02818000
*                                                            @Y30LB40*/ 02819000
         LH    @15,CONVERT                                         0909 02820000
         SLR   @14,@14                                             0909 02821000
         IC    @14,PAGES                                           0909 02822000
         ALR   @14,@15                                             0909 02823000
         STC   @14,PAGES                                           0909 02824000
*   K=0;                            /*                       @Y30LB40*/ 02825000
         SLR   @14,@14                                             0910 02826000
         STH   @14,K                                               0910 02827000
*   J=CONVERT;                      /*                       @Y30LB40*/ 02828000
         STH   @15,J                                               0911 02829000
*   HOLDCYLS=0;                     /* CLEAR CYLINDER ACCUMULATOR  0912 02830000
*                                                            @Y30LB40*/ 02831000
         SLR   HOLDCYLS,HOLDCYLS                                   0912 02832000
*   HOLDVTOC=0;                     /* CLEAR VTOC STAGING ACCUMULATOR   02833000
*                                                            @Y30LB40*/ 02834000
         SLR   HOLDVTOC,HOLDVTOC                                   0913 02835000
*   DO WHILE(K^=J);                 /* LOOP THROUGH ALL PAGE LISTS 0914 02836000
*                                                            @Y30LB40*/ 02837000
         B     @DE00914                                            0914 02838000
@DL00914 DS    0H                                                  0915 02839000
*     K=K+1;                        /*                       @Y30LB40*/ 02840000
         LA    @15,1                                               0915 02841000
         LH    @14,K                                               0915 02842000
         ALR   @14,@15                                             0915 02843000
         STH   @14,K                                               0915 02844000
*     CONVERT=0;                    /*                       @Y30LB40*/ 02845000
         SLR   @01,@01                                             0916 02846000
         STH   @01,CONVERT                                         0916 02847000
*     DECODCYL=CYLIND(K);           /*                       @Y30LB40*/ 02848000
         L     @01,PTR2                                            0917 02849000
         SLA   @14,2                                               0917 02850000
         ST    @14,@TF00001                                        0917 02851000
         ALR   @14,@01                                             0917 02852000
         MVC   DECODCYL(1),CYLIND-4(@14)                           0917 02853000
*     IF DECODCYL(1:1)='1'B&VIRTPAGE(K)='00000000'B THEN           0918 02854000
         TM    DECODCYL,B'10000000'                                0918 02855000
         BNO   @RF00918                                            0918 02856000
         AL    @01,@TF00001                                        0918 02857000
         CLI   VIRTPAGE-4(@01),B'00000000'                         0918 02858000
         BNE   @RF00918                                            0918 02859000
*       HOLDVTOC=HOLDVTOC+1;        /* IF VTOC STAGING ACCUMULATE  0919 02860000
*                                                            @Y30LB40*/ 02861000
*                                                                  0919 02862000
         ALR   HOLDVTOC,@15                                        0919 02863000
*     /***************************************************************/ 02864000
*     /*                                                             */ 02865000
*     /* COUNT CYLINDERS STAGED OR DESTAGED                  @Y30LB40*/ 02866000
*     /*                                                             */ 02867000
*     /***************************************************************/ 02868000
*                                                                  0920 02869000
*     IF DECODCYL(1:1)='1'B THEN                                   0920 02870000
@RF00918 TM    DECODCYL,B'10000000'                                0920 02871000
         BNO   @RF00920                                            0920 02872000
*       CONVERT=CONVERT+1;          /*                       @Y30LB40*/ 02873000
         LH    @01,CONVERT                                         0921 02874000
         LA    @01,1(,@01)                                         0921 02875000
         STH   @01,CONVERT                                         0921 02876000
*     IF DECODCYL(2:2)='1'B THEN                                   0922 02877000
@RF00920 TM    DECODCYL,B'01000000'                                0922 02878000
         BNO   @RF00922                                            0922 02879000
*       CONVERT=CONVERT+1;          /*                       @Y30LB40*/ 02880000
         LH    @01,CONVERT                                         0923 02881000
         LA    @01,1(,@01)                                         0923 02882000
         STH   @01,CONVERT                                         0923 02883000
*     IF DECODCYL(3:3)='1'B THEN                                   0924 02884000
@RF00922 TM    DECODCYL,B'00100000'                                0924 02885000
         BNO   @RF00924                                            0924 02886000
*       CONVERT=CONVERT+1;          /*                       @Y30LB40*/ 02887000
         LH    @01,CONVERT                                         0925 02888000
         LA    @01,1(,@01)                                         0925 02889000
         STH   @01,CONVERT                                         0925 02890000
*     IF DECODCYL(4:4)='1'B THEN                                   0926 02891000
@RF00924 TM    DECODCYL,B'00010000'                                0926 02892000
         BNO   @RF00926                                            0926 02893000
*       CONVERT=CONVERT+1;          /*                       @Y30LB40*/ 02894000
         LH    @01,CONVERT                                         0927 02895000
         LA    @01,1(,@01)                                         0927 02896000
         STH   @01,CONVERT                                         0927 02897000
*     IF DECODCYL(5:5)='1'B THEN                                   0928 02898000
@RF00926 TM    DECODCYL,B'00001000'                                0928 02899000
         BNO   @RF00928                                            0928 02900000
*       CONVERT=CONVERT+1;          /*                       @Y30LB40*/ 02901000
         LH    @01,CONVERT                                         0929 02902000
         LA    @01,1(,@01)                                         0929 02903000
         STH   @01,CONVERT                                         0929 02904000
*     IF DECODCYL(6:6)='1'B THEN                                   0930 02905000
@RF00928 TM    DECODCYL,B'00000100'                                0930 02906000
         BNO   @RF00930                                            0930 02907000
*       CONVERT=CONVERT+1;          /*                       @Y30LB40*/ 02908000
         LH    @01,CONVERT                                         0931 02909000
         LA    @01,1(,@01)                                         0931 02910000
         STH   @01,CONVERT                                         0931 02911000
*     IF DECODCYL(7:7)='1'B THEN                                   0932 02912000
@RF00930 TM    DECODCYL,B'00000010'                                0932 02913000
         BNO   @RF00932                                            0932 02914000
*       CONVERT=CONVERT+1;          /*                       @Y30LB40*/ 02915000
         LH    @01,CONVERT                                         0933 02916000
         LA    @01,1(,@01)                                         0933 02917000
         STH   @01,CONVERT                                         0933 02918000
*     IF DECODCYL(8:8)='1'B THEN                                   0934 02919000
@RF00932 TM    DECODCYL,B'00000001'                                0934 02920000
         BNO   @RF00934                                            0934 02921000
*       CONVERT=CONVERT+1;          /*                       @Y30LB40*/ 02922000
         LH    @01,CONVERT                                         0935 02923000
         LA    @01,1(,@01)                                         0935 02924000
         STH   @01,CONVERT                                         0935 02925000
*     HOLDCYLS=HOLDCYLS+CONVERT;    /*                       @Y30LB40*/ 02926000
@RF00934 AH    HOLDCYLS,CONVERT                                    0936 02927000
*   END;                            /*                       @Y30LB40*/ 02928000
@DE00914 CLC   K(2),J                                              0937 02929000
         BNE   @DL00914                                            0937 02930000
*   IF PLSTDEST='00'B               /* WAS THIS A STAGE OPERATION  0938 02931000
*                                                            @Y30LB40*/ 02932000
*     THEN                                                         0938 02933000
         L     @15,PTR2                                            0938 02934000
         TM    PLSTDEST(@15),B'11000000'                           0938 02935000
         BNZ   @RF00938                                            0938 02936000
*     DO;                           /* YES                   @Y30LB40*/ 02937000
*       STGD=STGD+HOLDCYLS;         /* ACCUM STAGED CYLINDERS      0940 02938000
*                                                            @Y30LB40*/ 02939000
         LR    @14,HOLDCYLS                                        0940 02940000
         AL    @14,STGD                                            0940 02941000
         ST    @14,STGD                                            0940 02942000
*       VTOCSTG=VTOCSTG+HOLDVTOC;   /* ACCUM VTOC STAGES     @Y30LB40*/ 02943000
         SLR   @14,@14                                             0941 02944000
         IC    @14,VTOCSTG                                         0941 02945000
         ALR   @14,HOLDVTOC                                        0941 02946000
         STC   @14,VTOCSTG                                         0941 02947000
*       STGDNUM=STGDNUM+1;          /* ACCUM NUMBER OF STAGES      0942 02948000
*                                                            @Y30LB40*/ 02949000
*                                                                  0942 02950000
         IC    @06,STGDNUM                                         0942 02951000
         LA    @06,1(,@06)                                         0942 02952000
         STC   @06,STGDNUM                                         0942 02953000
*       /*************************************************************/ 02954000
*       /*                                                           */ 02955000
*       /* IF STAGING CAUSED CYLINDER FAULT ACCUM CFAULT     @Y30LB40*/ 02956000
*       /*                                                           */ 02957000
*       /*************************************************************/ 02958000
*                                                                  0943 02959000
*       IF FUNCID='00110000'B|PLNOTU(1:1)='1'B THEN                0943 02960000
         CLI   FUNCID(@15),B'00110000'                             0943 02961000
         BE    @RT00943                                            0943 02962000
         TM    PLNOTU(@15),B'00100000'                             0943 02963000
         BNO   @RF00943                                            0943 02964000
@RT00943 DS    0H                                                  0944 02965000
*         CFAULT=CFAULT+HOLDCYLS;   /*                       @Y30LB40*/ 02966000
         LR    @06,HOLDCYLS                                        0944 02967000
         AL    @06,CFAULT                                          0944 02968000
         ST    @06,CFAULT                                          0944 02969000
*       SYSSGTM=SYSSGTM+(HOLDT5TM-HOLDT1TM);/* CALC SYSTEM TIME      */ 02970000
@RF00943 LR    @06,HOLDT5TM                                        0945 02971000
         SLR   @06,HOLDT1TM                                        0945 02972000
         AL    @06,SYSSGTM                                         0945 02973000
         ST    @06,SYSSGTM                                         0945 02974000
*       DEVSGTM=DEVSGTM+(HOLDT5TM-HOLDT4TM);/* CALC DEVICE TIME      */ 02975000
         LR    @06,HOLDT5TM                                        0946 02976000
         SLR   @06,HOLDT4TM                                        0946 02977000
         AL    @06,DEVSGTM                                         0946 02978000
         ST    @06,DEVSGTM                                         0946 02979000
*     END;                          /*                       @Y30LB40*/ 02980000
*   ELSE                                                           0948 02981000
*     IF PLSTDEST='10'B             /* WAS THIS A DESTAGE OPERATION  */ 02982000
*       THEN                                                       0948 02983000
         B     @RC00938                                            0948 02984000
@RF00938 L     @15,PTR2                                            0948 02985000
         TM    PLSTDEST(@15),B'10000000'                           0948 02986000
         BNO   @RF00948                                            0948 02987000
         TM    PLSTDEST(@15),B'01000000'                           0948 02988000
         BNZ   @RF00948                                            0948 02989000
*       DO;                         /* YES                   @Y30LB40*/ 02990000
*         DSTGD=DSTGD+HOLDCYLS;     /* ACCUM DESTAGES CYLINDERS      */ 02991000
         LR    @14,HOLDCYLS                                        0950 02992000
         AL    @14,DSTGD                                           0950 02993000
         ST    @14,DSTGD                                           0950 02994000
*         VTOCDSTG=VTOCDSTG+HOLDVTOC;/* ACCUM VTOC DESTAGINGS        */ 02995000
         SLR   @14,@14                                             0951 02996000
         IC    @14,VTOCDSTG                                        0951 02997000
         ALR   @14,HOLDVTOC                                        0951 02998000
         STC   @14,VTOCDSTG                                        0951 02999000
*         DSTGDNUM=DSTGDNUM+1;      /* ACCUM NUMBER OF DESTAGES    0952 03000000
*                                                            @Y30LB40*/ 03001000
         IC    @06,DSTGDNUM                                        0952 03002000
         LA    @06,1(,@06)                                         0952 03003000
         STC   @06,DSTGDNUM                                        0952 03004000
*         IF FUNCID='00001000'B|    /* MOUNT OR ACQUIRE OR LRU     0953 03005000
*                                                            @ZA28570*/ 03006000
*             FUNCID='00000010'B|FUNCID='00110000'B THEN           0953 03007000
         CLI   FUNCID(@15),B'00001000'                             0953 03008000
         BE    @RT00953                                            0953 03009000
         CLI   FUNCID(@15),B'00000010'                             0953 03010000
         BE    @RT00953                                            0953 03011000
         CLI   FUNCID(@15),B'00110000'                             0953 03012000
         BNE   @RF00953                                            0953 03013000
@RT00953 DS    0H                                                  0954 03014000
*           SALLOC=SALLOC+HOLDCYLS; /* SPACE ALLOC CAUSED            */ 03015000
         LR    @06,HOLDCYLS                                        0954 03016000
         AL    @06,SALLOC                                          0954 03017000
         ST    @06,SALLOC                                          0954 03018000
*         SYSDSTM=SYSDSTM+(HOLDT5TM-HOLDT1TM);/* CALC SYSTEM TIME    */ 03019000
@RF00953 LR    @06,HOLDT5TM                                        0955 03020000
         SLR   @06,HOLDT1TM                                        0955 03021000
         AL    @06,SYSDSTM                                         0955 03022000
         ST    @06,SYSDSTM                                         0955 03023000
*         DEVDSTM=DEVDSTM+(HOLDT5TM-HOLDT4TM);/* CALC DEVICE TIME    */ 03024000
         LR    @06,HOLDT5TM                                        0956 03025000
         SLR   @06,HOLDT4TM                                        0956 03026000
         AL    @06,DEVDSTM                                         0956 03027000
         ST    @06,DEVDSTM                                         0956 03028000
*       END;                        /*                       @Y30LB40*/ 03029000
*   MININUM=MININUM+1;              /* COUNT NUMBER OF MINI HEADERS  */ 03030000
@RF00948 DS    0H                                                  0958 03031000
@RC00938 IC    @06,MININUM                                         0958 03032000
         LA    @06,1(,@06)                                         0958 03033000
         STC   @06,MININUM                                         0958 03034000
*   IF HOLDT2TM=0&HOLDT3TM=0        /* WAS THERE A CARTRIDGE LOAD    */ 03035000
*     THEN                                                         0959 03036000
         SLR   @06,@06                                             0959 03037000
         C     @06,HOLDT2TM                                        0959 03038000
         BNE   @RF00959                                            0959 03039000
         C     @06,HOLDT3TM                                        0959 03040000
         BE    @RT00959                                            0959 03041000
*     ;                             /* NO                    @Y30LB40*/ 03042000
*   ELSE                                                           0961 03043000
*     DO;                           /* YES                   @Y30LB40*/ 03044000
@RF00959 DS    0H                                                  0962 03045000
*       IF HOLDT1TM>HOLDT2TM        /* WAS CARTRIDGE ALREADY LOADED  */ 03046000
*         THEN                                                     0962 03047000
         C     HOLDT1TM,HOLDT2TM                                   0962 03048000
         BNH   @RF00962                                            0962 03049000
*         HITNUM=HITNUM+1;          /* YES,COUNT NUMBER OF PRELOADS  */ 03050000
         IC    @06,HITNUM                                          0963 03051000
         LA    @06,1(,@06)                                         0963 03052000
         STC   @06,HITNUM                                          0963 03053000
*     END;                          /*                       @Y30LB40*/ 03054000
*   END DOMINIS;                    /*                       @OZ05079*/ 03055000
@EL00011 DS    0H                                                  0965 03056000
@EF00011 DS    0H                                                  0965 03057000
@ER00011 LM    @14,@06,12(@13)                                     0965 03058000
         LM    @08,@12,52(@13)                                     0965 03059000
         BR    @14                                                 0965 03060000
*                                                                  0966 03061000
*/********************************************************** @OZ05079*/ 03062000
*/*                                                          @OZ05079*/ 03063000
*/* PROCEDURE NAME - BLKHDR                                  @OZ09557*/ 03064000
*/*                                                          @OZ05079*/ 03065000
*/* FUNCTION - PRINT TRACE BLOCK HEADERS WHEN VALID STAGE    @OZ09557*/ 03066000
*/*            OR DETSAGE DATA AND 'INTERPRET' OR 'BOTH'     @OZ09557*/ 03067000
*/*            WAS SPECIFIED AS THE PARM OPTION.             @OZ05079*/ 03068000
*/*                                                          @OZ05079*/ 03069000
*/********************************************************** @OZ05079*/ 03070000
*                                                                  0966 03071000
*BLKHDR:                                                           0966 03072000
*   PROCEDURE;                      /*                       @OZ09557*/ 03073000
BLKHDR   STM   @14,@06,@SA00012                                    0966 03074000
         STM   @08,@12,@SA00012+36                                 0966 03075000
*   MINI1SW='0'B;                   /* RESET 1ST TIME        @OZ11670*/ 03076000
         NI    MINI1SW,B'01111111'                                 0967 03077000
*   IF LINECNT>52                   /* FORCE PAGE BREAK IF NECESSARY    03078000
*                                                            @Y30LB40*/ 03079000
*     THEN                                                         0968 03080000
         C     LINECNT,@CF00040                                    0968 03081000
         BNH   @RF00968                                            0968 03082000
*     CALL NEWPAGE;                 /*                       @Y30LB40*/ 03083000
         BAL   @14,NEWPAGE                                         0969 03084000
*   RFY                                                            0970 03085000
*    (R0,                                                          0970 03086000
*     R1,                                                          0970 03087000
*     R14,                                                         0970 03088000
*     R15) RSTD;                    /*                       @Y30LB40*/ 03089000
@RF00968 DS    0H                                                  0971 03090000
*   GEN(PUT   PRNTDCB,HDNG2);       /* PRINT BLOCK HEADER HEADLINES     03091000
*                                                            @Y30LB40*/ 03092000
         PUT   PRNTDCB,HDNG2                                            03093000
*   GEN(PUT   PRNTDCB,HDNG3);       /*                       @Y30LB40*/ 03094000
         PUT   PRNTDCB,HDNG3                                            03095000
*   RFY                                                            0973 03096000
*    (R0,                                                          0973 03097000
*     R1,                                                          0973 03098000
*     R14,                                                         0973 03099000
*     R15) UNRSTD;                  /*                       @Y30LB40*/ 03100000
*   LINECNT=LINECNT+3;              /*                       @Y30LB40*/ 03101000
         AL    LINECNT,@CF00117                                    0974 03102000
*   BLKLINE=' ';                    /* SET BLOCK LINE TO BLANKS    0975 03103000
*                                                            @Y30LB40*/ 03104000
         MVI   BLKLINE+1,C' '                                      0975 03105000
         MVC   BLKLINE+2(119),BLKLINE+1                            0975 03106000
         MVI   BLKLINE,C' '                                        0975 03107000
*   CALL EDITBIT(ADDR(BLKOFLG));    /*                       @Y30LB40*/ 03108000
         LA    @06,BLKOFLG                                         0976 03109000
         ST    @06,@AFTEMPS+4                                      0976 03110000
         LA    @06,@AFTEMPS+4                                      0976 03111000
         ST    @06,@AL00001                                        0976 03112000
         LA    @01,@AL00001                                        0976 03113000
         BAL   @14,EDITBIT                                         0976 03114000
*   BLKFLAG=BITOUT;                 /* PRINT BLOCK FLAG      @Y30LB40*/ 03115000
         MVC   BLKFLAG(8),BITOUT                                   0977 03116000
*   CALL EDITHEX(ADDR(MINIPTR),1);  /*                       @YD00173*/ 03117000
         LA    @06,MINIPTR                                         0978 03118000
         ST    @06,@AFTEMPS+4                                      0978 03119000
         LA    @06,@AFTEMPS+4                                      0978 03120000
         ST    @06,@AL00001                                        0978 03121000
         LA    @06,@CF00045                                        0978 03122000
         ST    @06,@AL00001+4                                      0978 03123000
         LA    @01,@AL00001                                        0978 03124000
         BAL   @14,EDITHEX                                         0978 03125000
*   BLKMINPT=HEXOUT(1:2);           /* PRINT CURRENT MINI PTR      0979 03126000
*                                                            @YD00173*/ 03127000
         MVC   BLKMINPT(2),HEXOUT                                  0979 03128000
*   CALL EDITHEX(ADDR(LIBRID),1);   /*                       @YD00173*/ 03129000
         LA    @06,LIBRID                                          0980 03130000
         ST    @06,@AFTEMPS+4                                      0980 03131000
         LA    @06,@AFTEMPS+4                                      0980 03132000
         ST    @06,@AL00001                                        0980 03133000
         LA    @06,@CF00045                                        0980 03134000
         ST    @06,@AL00001+4                                      0980 03135000
         LA    @01,@AL00001                                        0980 03136000
         BAL   @14,EDITHEX                                         0980 03137000
*   BLKLIBID=HEXOUT(1:2);           /* PRINT LIBRARY ID      @YD00173*/ 03138000
         MVC   BLKLIBID(2),HEXOUT                                  0981 03139000
*   CALL EDITHEX(ADDR(RSPINDGP),1); /*                       @YD00173*/ 03140000
*                                                                  0982 03141000
         LA    @06,RSPINDGP                                        0982 03142000
         ST    @06,@AFTEMPS+4                                      0982 03143000
         LA    @06,@AFTEMPS+4                                      0982 03144000
         ST    @06,@AL00001                                        0982 03145000
         LA    @06,@CF00045                                        0982 03146000
         ST    @06,@AL00001+4                                      0982 03147000
         LA    @01,@AL00001                                        0982 03148000
         BAL   @14,EDITHEX                                         0982 03149000
*   /*****************************************************************/ 03150000
*   /*                                                               */ 03151000
*   /* *************************************************     @OZ08841*/ 03152000
*   /* SAVE STAGING DRIVE GROUP TO BUILD DASD SSID IN        @OZ08841*/ 03153000
*   /* PAGE LIST                                             @OZ08841*/ 03154000
*   /* *************************************************     @OZ08841*/ 03155000
*   /*                                                               */ 03156000
*   /*****************************************************************/ 03157000
*                                                                  0983 03158000
*   SAVESDG='00'X;                  /* ZERO SAVE AREA        @OZ08841*/ 03159000
         MVI   SAVESDG,X'00'                                       0983 03160000
*   IF RSPINDGP(4)='1'B             /* SHIFT LEFT 3 BITS     @OZ08841*/ 03161000
*     THEN                          /*                       @OZ08841*/ 03162000
         TM    RSPINDGP,B'00010000'                                0984 03163000
         BNO   @RF00984                                            0984 03164000
*     SAVESDG(1)='1'B;              /*                       @OZ08841*/ 03165000
         OI    SAVESDG,B'10000000'                                 0985 03166000
*   IF RSPINDGP(5)='1'B             /* SHIFT LEFT 3 BITS     @OZ08841*/ 03167000
*     THEN                          /*                       @OZ08841*/ 03168000
@RF00984 TM    RSPINDGP,B'00001000'                                0986 03169000
         BNO   @RF00986                                            0986 03170000
*     SAVESDG(2)='1'B;              /*                       @OZ08841*/ 03171000
         OI    SAVESDG,B'01000000'                                 0987 03172000
*   IF RSPINDGP(6)='1'B             /* SHIFT LEFT 3 BITS     @OZ08841*/ 03173000
*     THEN                          /*                       @OZ08841*/ 03174000
@RF00986 TM    RSPINDGP,B'00000100'                                0988 03175000
         BNO   @RF00988                                            0988 03176000
*     SAVESDG(3)='1'B;              /*                       @OZ08841*/ 03177000
         OI    SAVESDG,B'00100000'                                 0989 03178000
*   IF RSPINDGP(7)='1'B             /* SHIFT LEFT 3 BITS     @OZ08841*/ 03179000
*     THEN                          /*                       @OZ08841*/ 03180000
@RF00988 TM    RSPINDGP,B'00000010'                                0990 03181000
         BNO   @RF00990                                            0990 03182000
*     SAVESDG(4)='1'B;              /*                       @OZ08841*/ 03183000
         OI    SAVESDG,B'00010000'                                 0991 03184000
*   IF RSPINDGP(8)='1'B             /* SHIFT LEFT 3 BITS     @OZ08841*/ 03185000
*     THEN                          /*                       @OZ08841*/ 03186000
@RF00990 TM    RSPINDGP,B'00000001'                                0992 03187000
         BNO   @RF00992                                            0992 03188000
*     SAVESDG(5)='1'B;              /*                       @OZ08841*/ 03189000
         OI    SAVESDG,B'00001000'                                 0993 03190000
*   BLKRSPPT=HEXOUT(1:2);           /* PRINT REAL SPINDLE GROUP    0994 03191000
*                                                            @YD00173*/ 03192000
*                                                                  0994 03193000
@RF00992 MVC   BLKRSPPT(2),HEXOUT                                  0994 03194000
*   /*****************************************************************/ 03195000
*   /*                                                               */ 03196000
*   /* BUILD SSID OF STAGING ADAPTER 1 AND STAGING           @OZ05079*/ 03197000
*   /* ADAPTER 2 (IF PRESENT)                                @OZ05079*/ 03198000
*   /*                                                               */ 03199000
*   /*****************************************************************/ 03200000
*                                                                  0995 03201000
*   CHAR8SA1='8';                   /* FIRST DIGIT ALWAYS 8  @OZ05079*/ 03202000
         MVI   CHAR8SA1,C'8'                                       0995 03203000
*   SAWORK='00'X;                   /* CLEAR WORK AREA       @OZ05079*/ 03204000
         MVI   SAWORK,X'00'                                        0996 03205000
*   SAWORK=DS1ADDR;                 /* FOUR LOW-ORDER BITS OF SA   0997 03206000
*                                                            @OZ05079*/ 03207000
         MVC   SAWORK(1),DS1ADDR                                   0997 03208000
*   SAWORK(1:1)='0'B;               /*                       @OZ05079*/ 03209000
*   SAWORK(2:2)='0'B;               /*                       @OZ05079*/ 03210000
*   SAWORK(3:3)='0'B;               /*                       @OZ05079*/ 03211000
*   SAWORK(4:4)='0'B;               /*                       @OZ05079*/ 03212000
         NI    SAWORK,B'00001111'                                  1001 03213000
*   SA1ID=SALOOKUP(SAWORK+1);       /* TRANSLATE SECOND DIGIT      1002 03214000
*                                                            @OZ05079*/ 03215000
         SLR   @06,@06                                             1002 03216000
         IC    @06,SAWORK                                          1002 03217000
         LA    @01,SALOOKUP(@06)                                   1002 03218000
         MVC   SA1ID(1),0(@01)                                     1002 03219000
*   CHAR0SA1='0';                   /* THIRD DIGIT ALWAYS 0  @OZ05079*/ 03220000
         MVI   CHAR0SA1,C'0'                                       1003 03221000
*   IF DS2VALID='1'B                /* CHECK SECOND SA VALID @OZ05079*/ 03222000
*     THEN                          /*                       @OZ05079*/ 03223000
         TM    DS2VALID,B'00010000'                                1004 03224000
         BNO   @RF01004                                            1004 03225000
*     DO;                           /*                       @OZ05079*/ 03226000
*       CHAR8SA2='8';               /* FIRST DIGIT ALWAYS 8  @OZ05079*/ 03227000
         MVI   CHAR8SA2,C'8'                                       1006 03228000
*       SAWORK='00'X;               /* CLEAR WORK AREA       @OZ05079*/ 03229000
         MVI   SAWORK,X'00'                                        1007 03230000
*       SAWORK=DS2ADDR;             /* FOUR LOW-ORDER BITS   @OZ05079*/ 03231000
         MVC   SAWORK(1),DS2ADDR                                   1008 03232000
*       SAWORK(1:1)='0'B;           /*                       @OZ05079*/ 03233000
*       SAWORK(2:2)='0'B;           /*                       @OZ05079*/ 03234000
*       SAWORK(3:3)='0'B;           /*                       @OZ05079*/ 03235000
*       SAWORK(4:4)='0'B;           /*                       @OZ05079*/ 03236000
         NI    SAWORK,B'00001111'                                  1012 03237000
*       SA2ID=SALOOKUP(SAWORK+1);   /* TRANSLATE 2ND DIGIT   @OZ05079*/ 03238000
         SLR   @06,@06                                             1013 03239000
         IC    @06,SAWORK                                          1013 03240000
         LA    @01,SALOOKUP(@06)                                   1013 03241000
         MVC   SA2ID(1),0(@01)                                     1013 03242000
*       CHAR0SA2='0';               /* THIRD DIGIT ALWAYS 0  @OZ05079*/ 03243000
         MVI   CHAR0SA2,C'0'                                       1014 03244000
*     END;                          /*                       @OZ05079*/ 03245000
*   ELSE                            /*                       @OZ05079*/ 03246000
*     SA2SSID='***';                /* NO SECOND SA          @OZ05079*/ 03247000
         B     @RC01004                                            1016 03248000
@RF01004 MVC   SA2SSID(3),@CC01192                                 1016 03249000
*   CALL EDITHEX(ADDR(VVADDR1),1);  /*                       @YD00173*/ 03250000
@RC01004 LA    @06,VVADDR1                                         1017 03251000
         ST    @06,@AFTEMPS+4                                      1017 03252000
         LA    @06,@AFTEMPS+4                                      1017 03253000
         ST    @06,@AL00001                                        1017 03254000
         LA    @06,@CF00045                                        1017 03255000
         ST    @06,@AL00001+4                                      1017 03256000
         LA    @01,@AL00001                                        1017 03257000
         BAL   @14,EDITHEX                                         1017 03258000
*   BLKVV1=HEXOUT(1:2);             /* PRINT VVA1            @YD00173*/ 03259000
         MVC   BLKVV1(2),HEXOUT                                    1018 03260000
*   CALL EDITHEX(ADDR(VVADDR2),1);  /*                       @YD00173*/ 03261000
         LA    @06,VVADDR2                                         1019 03262000
         ST    @06,@AFTEMPS+4                                      1019 03263000
         LA    @06,@AFTEMPS+4                                      1019 03264000
         ST    @06,@AL00001                                        1019 03265000
         LA    @06,@CF00045                                        1019 03266000
         ST    @06,@AL00001+4                                      1019 03267000
         LA    @01,@AL00001                                        1019 03268000
         BAL   @14,EDITHEX                                         1019 03269000
*   BLKVV2=HEXOUT(1:2);             /* PRINT VVA2            @YD00173*/ 03270000
         MVC   BLKVV2(2),HEXOUT                                    1020 03271000
*   CALL EDITHEX(ADDR(QCBENTS),6);  /*                       @Y30LB40*/ 03272000
         LA    @06,QCBENTS                                         1021 03273000
         ST    @06,@AFTEMPS+4                                      1021 03274000
         LA    @06,@AFTEMPS+4                                      1021 03275000
         ST    @06,@AL00001                                        1021 03276000
         LA    @06,@CF00344                                        1021 03277000
         ST    @06,@AL00001+4                                      1021 03278000
         LA    @01,@AL00001                                        1021 03279000
         BAL   @14,EDITHEX                                         1021 03280000
*   BLKQCB=HEXOUT(1:12);            /* PRINT QCB ENTRIES     @Y30LB40*/ 03281000
         MVC   BLKQCB(12),HEXOUT                                   1022 03282000
*   BLKVOLID=VOLID;                 /* PRINT VOLUME IDENTIFICATION 1023 03283000
*                                                            @Y30LB40*/ 03284000
         MVC   BLKVOLID(6),VOLID                                   1023 03285000
*   IF T2TIME=0                     /*                       @ZA13498*/ 03286000
*       &T3TIME=0                   /*                       @ZA13498*/ 03287000
*     THEN                          /*                       @ZA13498*/ 03288000
         LH    @06,T2TIME                                          1024 03289000
         N     @06,@CF01285                                        1024 03290000
         LTR   @06,@06                                             1024 03291000
         BNZ   @RF01024                                            1024 03292000
         LH    @06,T3TIME                                          1024 03293000
         N     @06,@CF01285                                        1024 03294000
         LTR   @06,@06                                             1024 03295000
         BNZ   @RF01024                                            1024 03296000
*     DO;                           /*                       @ZA13498*/ 03297000
*       T2SECOND(2:2)='0';          /*                       @ZA13498*/ 03298000
         MVI   T2SECOND+1,C'0'                                     1026 03299000
*       T3SECOND(2:2)='0';          /*                       @ZA13498*/ 03300000
         MVI   T3SECOND+1,C'0'                                     1027 03301000
*     END;                          /*                       @ZA13498*/ 03302000
*   ELSE                            /*                       @ZA13498*/ 03303000
*     DO;                           /*                       @ZA13498*/ 03304000
         B     @RC01024                                            1029 03305000
@RF01024 DS    0H                                                  1030 03306000
*       HOLDTXTM=T2TIME;            /*                       @ZA13498*/ 03307000
         LH    HOLDTXTM,T2TIME                                     1030 03308000
         N     HOLDTXTM,@CF01285                                   1030 03309000
*       CALL TIME2345;              /*                       @ZA13498*/ 03310000
         BAL   @14,TIME2345                                        1031 03311000
*       CALL EDITFIX(ADDR(HOUR),2,'S');/*                    @ZA13498*/ 03312000
         MVC   @AL00001+4(8),@AL01032                              1032 03313000
         LA    @06,HOUR                                            1032 03314000
         ST    @06,@AFTEMPS+4                                      1032 03315000
         LA    @06,@AFTEMPS+4                                      1032 03316000
         ST    @06,@AL00001                                        1032 03317000
         LA    @01,@AL00001                                        1032 03318000
         BAL   @14,EDITFIX                                         1032 03319000
*       T2HOUR=FIXOUT(12:13);       /*                       @ZA13498*/ 03320000
         MVC   T2HOUR(2),FIXOUT+11                                 1033 03321000
*       T2SEP1=':';                 /*                       @ZA13498*/ 03322000
         MVI   T2SEP1,C':'                                         1034 03323000
*       CALL EDITFIX(ADDR(MINUTE),2,'N');/*                  @ZA13498*/ 03324000
         MVC   @AL00001+4(8),@AL01035                              1035 03325000
         LA    @06,MINUTE                                          1035 03326000
         ST    @06,@AFTEMPS+4                                      1035 03327000
         LA    @06,@AFTEMPS+4                                      1035 03328000
         ST    @06,@AL00001                                        1035 03329000
         LA    @01,@AL00001                                        1035 03330000
         BAL   @14,EDITFIX                                         1035 03331000
*       T2MINUTE=FIXOUT(12:13);     /*                       @ZA13498*/ 03332000
         MVC   T2MINUTE(2),FIXOUT+11                               1036 03333000
*       T2SEP2=':';                 /*                       @ZA13498*/ 03334000
         MVI   T2SEP2,C':'                                         1037 03335000
*       CALL EDITFIX(ADDR(SECOND),2,'N');/*                  @ZA13498*/ 03336000
         MVC   @AL00001+4(8),@AL01038                              1038 03337000
         LA    @06,SECOND                                          1038 03338000
         ST    @06,@AFTEMPS+4                                      1038 03339000
         LA    @06,@AFTEMPS+4                                      1038 03340000
         ST    @06,@AL00001                                        1038 03341000
         LA    @01,@AL00001                                        1038 03342000
         BAL   @14,EDITFIX                                         1038 03343000
*       T2SECOND=FIXOUT(12:13);     /*                       @ZA13498*/ 03344000
         MVC   T2SECOND(2),FIXOUT+11                               1039 03345000
*       HOLDTXTM=T3TIME;            /*                       @ZA13498*/ 03346000
         LH    HOLDTXTM,T3TIME                                     1040 03347000
         N     HOLDTXTM,@CF01285                                   1040 03348000
*       CALL TIME2345;              /*                       @ZA13498*/ 03349000
         BAL   @14,TIME2345                                        1041 03350000
*       CALL EDITFIX(ADDR(HOUR),2,'S');/*                    @ZA13498*/ 03351000
         MVC   @AL00001+4(8),@AL01042                              1042 03352000
         LA    @06,HOUR                                            1042 03353000
         ST    @06,@AFTEMPS+4                                      1042 03354000
         LA    @06,@AFTEMPS+4                                      1042 03355000
         ST    @06,@AL00001                                        1042 03356000
         LA    @01,@AL00001                                        1042 03357000
         BAL   @14,EDITFIX                                         1042 03358000
*       T3HOUR=FIXOUT(12:13);       /*                       @ZA13498*/ 03359000
         MVC   T3HOUR(2),FIXOUT+11                                 1043 03360000
*       T3SEP1=':';                 /*                       @ZA13498*/ 03361000
         MVI   T3SEP1,C':'                                         1044 03362000
*       CALL EDITFIX(ADDR(MINUTE),2,'N');/*                  @ZA13498*/ 03363000
         MVC   @AL00001+4(8),@AL01045                              1045 03364000
         LA    @06,MINUTE                                          1045 03365000
         ST    @06,@AFTEMPS+4                                      1045 03366000
         LA    @06,@AFTEMPS+4                                      1045 03367000
         ST    @06,@AL00001                                        1045 03368000
         LA    @01,@AL00001                                        1045 03369000
         BAL   @14,EDITFIX                                         1045 03370000
*       T3MINUTE=FIXOUT(12:13);     /*                       @ZA13498*/ 03371000
         MVC   T3MINUTE(2),FIXOUT+11                               1046 03372000
*       T3SEP2=':';                 /*                       @ZA13498*/ 03373000
         MVI   T3SEP2,C':'                                         1047 03374000
*       CALL EDITFIX(ADDR(SECOND),2,'N');/*                  @ZA13498*/ 03375000
         MVC   @AL00001+4(8),@AL01048                              1048 03376000
         LA    @06,SECOND                                          1048 03377000
         ST    @06,@AFTEMPS+4                                      1048 03378000
         LA    @06,@AFTEMPS+4                                      1048 03379000
         ST    @06,@AL00001                                        1048 03380000
         LA    @01,@AL00001                                        1048 03381000
         BAL   @14,EDITFIX                                         1048 03382000
*       T3SECOND=FIXOUT(12:13);     /*                       @ZA13498*/ 03383000
         MVC   T3SECOND(2),FIXOUT+11                               1049 03384000
*     END;                          /*                       @ZA13498*/ 03385000
*   CALL EDITHEX(ADDR(QCBADDR),1);  /*                       @YD00173*/ 03386000
@RC01024 LA    @06,QCBADDR                                         1051 03387000
         ST    @06,@AFTEMPS+4                                      1051 03388000
         LA    @06,@AFTEMPS+4                                      1051 03389000
         ST    @06,@AL00001                                        1051 03390000
         LA    @06,@CF00045                                        1051 03391000
         ST    @06,@AL00001+4                                      1051 03392000
         LA    @01,@AL00001                                        1051 03393000
         BAL   @14,EDITHEX                                         1051 03394000
*   BLKQCBPT=HEXOUT(1:2);           /* PRINT QCB PTR         @YD00173*/ 03395000
*                                                                  1052 03396000
         MVC   BLKQCBPT(2),HEXOUT                                  1052 03397000
*   /*****************************************************************/ 03398000
*   /*                                                               */ 03399000
*   /* PRINT SSIDS OF BOTH DRC AND DRD                       @OZ05079*/ 03400000
*   /*                                                               */ 03401000
*   /*****************************************************************/ 03402000
*                                                                  1053 03403000
*   IF PARMSW='I'                   /* IF INTERPRET ONLY     @OZ05079*/ 03404000
*     THEN                          /*                       @OZ05079*/ 03405000
         CLI   PARMSW,C'I'                                         1053 03406000
         BNE   @RF01053                                            1053 03407000
*     CALL TRDRCDRD;                /* NEED TRANSLATE HERE   @OZ05079*/ 03408000
         BAL   @14,TRDRCDRD                                        1054 03409000
*   ELSE                                                           1055 03410000
*     ;                             /*                       @OZ05079*/ 03411000
@RF01053 DS    0H                                                  1056 03412000
*   CHAR4='4';                      /* FIRST CHAR ALWAYS 4   @OZ05079*/ 03413000
         MVI   CHAR4,C'4'                                          1056 03414000
*   MSFDRC=LIBRID;                  /* MSFID IN BINARY       @OZ05079*/ 03415000
         MVC   MSFDRC(1),LIBRID                                    1057 03416000
*   MSFDRC=MSFDRC|FOXZERO;          /* CONCATENATE SIGN      @OZ05079*/ 03417000
         OI    MSFDRC,B'11110000'                                  1058 03418000
*   PRINTDRC=DRCPRINT;              /* ALREADY EBCDIC        @OZ05079*/ 03419000
         MVC   PRINTDRC(1),DRCPRINT                                1059 03420000
*   CHAR2='2';                      /* FIRST CHAR ALWAYS 2   @OZ05079*/ 03421000
         MVI   CHAR2,C'2'                                          1060 03422000
*   MSFDRD=MSFDRC;                  /* MUST BE SAME MSF      @OZ05079*/ 03423000
         MVC   MSFDRD(1),MSFDRC                                    1061 03424000
*   PRINTDRD=DRDPRINT;              /* PHYSICAL DRD IN BINARY      1062 03425000
*                                                            @OZ05079*/ 03426000
         MVC   PRINTDRD(1),DRDPRINT                                1062 03427000
*   PRINTDRD=PRINTDRD|FOXZERO;      /* CONCATENATE SIGN      @OZ05079*/ 03428000
         OI    PRINTDRD,B'11110000'                                1063 03429000
*   FLD2='00000000'B;               /*                       @Y30LB40*/ 03430000
         MVI   FLD2,B'00000000'                                    1064 03431000
*   IF L(1:1)='1'B THEN                                            1065 03432000
         TM    L,B'10000000'                                       1065 03433000
         BNO   @RF01065                                            1065 03434000
*     FLD2(7:7)='1'B;               /*                       @Y30LB40*/ 03435000
         OI    FLD2,B'00000010'                                    1066 03436000
*   IF L(2:2)='1'B THEN                                            1067 03437000
@RF01065 TM    L,B'01000000'                                       1067 03438000
         BNO   @RF01067                                            1067 03439000
*     FLD2(8:8)='1'B;               /*                       @Y30LB40*/ 03440000
         OI    FLD2,B'00000001'                                    1068 03441000
*   CALL EDITFIX(ADDR(FLD2),1,'N'); /* PRINT L COORDINATE    @Y30LB40*/ 03442000
@RF01067 MVC   @AL00001+4(8),@AL01069                              1069 03443000
         LA    @06,FLD2                                            1069 03444000
         ST    @06,@AFTEMPS+4                                      1069 03445000
         LA    @06,@AFTEMPS+4                                      1069 03446000
         ST    @06,@AL00001                                        1069 03447000
         LA    @01,@AL00001                                        1069 03448000
         BAL   @14,EDITFIX                                         1069 03449000
*   BLKL=FIXOUT(13:13);             /*                       @Y30LB40*/ 03450000
         MVC   BLKL(1),FIXOUT+12                                   1070 03451000
*   IF Z='1'B THEN                                                 1071 03452000
         TM    Z,B'00100000'                                       1071 03453000
         BNO   @RF01071                                            1071 03454000
*     BLKZ='1';                     /*                       @Y30LB40*/ 03455000
         MVI   BLKZ,C'1'                                           1072 03456000
*   ELSE                                                           1073 03457000
*     BLKZ='0';                     /* PRINT Z COORDINATE    @Y30LB40*/ 03458000
         B     @RC01071                                            1073 03459000
@RF01071 MVI   BLKZ,C'0'                                           1073 03460000
*   FLD2='00000000'B;               /*                       @Y30LB40*/ 03461000
@RC01071 MVI   FLD2,B'00000000'                                    1074 03462000
*   IF Y(1:1)='1'B THEN                                            1075 03463000
         TM    Y,B'00010000'                                       1075 03464000
         BNO   @RF01075                                            1075 03465000
*     FLD2(4:4)='1'B;               /*                       @Y30LB40*/ 03466000
         OI    FLD2,B'00010000'                                    1076 03467000
*   IF Y(2:2)='1'B THEN                                            1077 03468000
@RF01075 TM    Y,B'00001000'                                       1077 03469000
         BNO   @RF01077                                            1077 03470000
*     FLD2(5:5)='1'B;               /*                       @Y30LB40*/ 03471000
         OI    FLD2,B'00001000'                                    1078 03472000
*   IF Y(3:3)='1'B THEN                                            1079 03473000
@RF01077 TM    Y,B'00000100'                                       1079 03474000
         BNO   @RF01079                                            1079 03475000
*     FLD2(6:6)='1'B;               /*                       @Y30LB40*/ 03476000
         OI    FLD2,B'00000100'                                    1080 03477000
*   IF Y(4:4)='1'B THEN                                            1081 03478000
@RF01079 TM    Y,B'00000010'                                       1081 03479000
         BNO   @RF01081                                            1081 03480000
*     FLD2(7:7)='1'B;               /*                       @Y30LB40*/ 03481000
         OI    FLD2,B'00000010'                                    1082 03482000
*   IF Y(5:5)='1'B THEN                                            1083 03483000
@RF01081 TM    Y,B'00000001'                                       1083 03484000
         BNO   @RF01083                                            1083 03485000
*     FLD2(8:8)='1'B;               /*                       @Y30LB40*/ 03486000
         OI    FLD2,B'00000001'                                    1084 03487000
*   CALL EDITFIX(ADDR(FLD2),1,'S'); /* PRINT Y COORDINATE    @Y30LB40*/ 03488000
@RF01083 MVC   @AL00001+4(8),@AL01085                              1085 03489000
         LA    @06,FLD2                                            1085 03490000
         ST    @06,@AFTEMPS+4                                      1085 03491000
         LA    @06,@AFTEMPS+4                                      1085 03492000
         ST    @06,@AL00001                                        1085 03493000
         LA    @01,@AL00001                                        1085 03494000
         BAL   @14,EDITFIX                                         1085 03495000
*   BLKY=FIXOUT(12:13);             /*                       @Y30LB40*/ 03496000
         MVC   BLKY(2),FIXOUT+11                                   1086 03497000
*   CALL EDITFIX(ADDR(X),1,'S');    /* PRINT X COORDINATE    @Y30LB40*/ 03498000
         MVC   @AL00001+4(8),@AL01087                              1087 03499000
         LA    @06,X                                               1087 03500000
         ST    @06,@AFTEMPS+4                                      1087 03501000
         LA    @06,@AFTEMPS+4                                      1087 03502000
         ST    @06,@AL00001                                        1087 03503000
         LA    @01,@AL00001                                        1087 03504000
         BAL   @14,EDITFIX                                         1087 03505000
*   BLKX=FIXOUT(11:13);             /*                       @Y30LB40*/ 03506000
         MVC   BLKX(3),FIXOUT+10                                   1088 03507000
*   RFY                                                            1089 03508000
*    (R0,                                                          1089 03509000
*     R1,                                                          1089 03510000
*     R14,                                                         1089 03511000
*     R15) RSTD;                    /*                       @Y30LB40*/ 03512000
*   GEN(PUT   PRNTDCB,BLKLINE);     /* PRINT BLOCK LINE      @Y30LB40*/ 03513000
         PUT   PRNTDCB,BLKLINE                                          03514000
*   RFY                                                            1091 03515000
*    (R0,                                                          1091 03516000
*     R1,                                                          1091 03517000
*     R14,                                                         1091 03518000
*     R15) UNRSTD;                  /*                       @Y30LB40*/ 03519000
*   LINECNT=LINECNT+1;              /*                       @Y30LB40*/ 03520000
         AL    LINECNT,@CF00045                                    1092 03521000
*   END BLKHDR;                     /*                       @OZ09557*/ 03522000
@EL00012 DS    0H                                                  1093 03523000
@EF00012 DS    0H                                                  1093 03524000
@ER00012 LM    @14,@06,@SA00012                                    1093 03525000
         LM    @08,@12,@SA00012+36                                 1093 03526000
         BR    @14                                                 1093 03527000
*                                                                  1094 03528000
*/********************************************************** @OZ05079*/ 03529000
*/*                                                          @OZ05079*/ 03530000
*/* PROCEDURE NAME - BLOCK                                   @OZ05079*/ 03531000
*/*                                                          @OZ05079*/ 03532000
*/* FUNCTION - PRINT TRACE BLOCK HEADERS, MINI HEADERS, AND  @OZ05079*/ 03533000
*/*            PAGE LISTS WHEN EITHER 'INTERPRET' OR 'BOTH'  @OZ05079*/ 03534000
*/*            WAS SPECIFIED AS THE PARM OPTION.             @OZ05079*/ 03535000
*/*                                                          @OZ05079*/ 03536000
*/********************************************************** @OZ05079*/ 03537000
*                                                                  1094 03538000
*BLOCK:                                                            1094 03539000
*   PROCEDURE;                                                     1094 03540000
BLOCK    STM   @14,@06,@SA00013                                    1094 03541000
         STM   @08,@12,@SA00013+36                                 1094 03542000
*   IF LINECNT>52                   /* FORCE PAGE BREAK IF NECESSARY    03543000
*                                                            @Y30LB40*/ 03544000
*     THEN                                                         1095 03545000
         C     LINECNT,@CF00040                                    1095 03546000
         BNH   @RF01095                                            1095 03547000
*     CALL NEWPAGE;                 /*                       @Y30LB40*/ 03548000
         BAL   @14,NEWPAGE                                         1096 03549000
*   IF LIBRID='11111111'B           /* TRAILER RECORD        @Y30LB40*/ 03550000
*     THEN                                                         1097 03551000
@RF01095 CLI   LIBRID,B'11111111'                                  1097 03552000
         BNE   @RF01097                                            1097 03553000
*     DO;                           /*                       @Y30LB40*/ 03554000
*       RFY                                                        1099 03555000
*        (R0,                                                      1099 03556000
*         R1,                                                      1099 03557000
*         R14,                                                     1099 03558000
*         R15) RSTD;                /*                       @Y30LB40*/ 03559000
*       GEN(PUT   PRNTDCB,TRLINE);  /* PRINT TRAILER         @Y30LB40*/ 03560000
         PUT   PRNTDCB,TRLINE                                           03561000
*       RFY                                                        1101 03562000
*        (R0,                                                      1101 03563000
*         R1,                                                      1101 03564000
*         R14,                                                     1101 03565000
*         R15) UNRSTD;              /*                       @Y30LB40*/ 03566000
*       LINECNT=LINECNT+2;          /*                       @Y30LB40*/ 03567000
         AL    LINECNT,@CF00052                                    1102 03568000
*       RETURN;                     /* GO GET NEXT RECORD    @OZ05079*/ 03569000
@EL00013 DS    0H                                                  1103 03570000
@EF00013 DS    0H                                                  1103 03571000
@ER00013 LM    @14,@06,@SA00013                                    1103 03572000
         LM    @08,@12,@SA00013+36                                 1103 03573000
         BR    @14                                                 1103 03574000
*     END;                          /*                       @Y30LB40*/ 03575000
*/*  PRINT MINI HEADERS                                      @Y30LB40*/ 03576000
*                                                                  1105 03577000
*   PTR2=ADDR(FIRSTMIN);            /* SET POINTER TO 1ST MINI HEADER*/ 03578000
@RF01097 LA    @15,FIRSTMIN                                        1105 03579000
         ST    @15,PTR2                                            1105 03580000
*   LSTMINAD=ADDR(FIRSTMIN)-ADDR(BLOCKFLG);/* INITIALIZE     @YM31015   03581000
*                                      LAST ADDRESS          @YM31015*/ 03582000
         LA    LSTMINAD,32                                         1106 03583000
*   MINI1SW='1'B;                   /* SET FIRST MINI HEADER SWITCH     03584000
*                                                            @Y30LB40*/ 03585000
         OI    MINI1SW,B'10000000'                                 1107 03586000
*   STDESTSW='1'B;                  /* SET FIRST STAGE/DESTAGE MINI     03587000
*                                                            @ZA13498*/ 03588000
         OI    STDESTSW,B'10000000'                                1108 03589000
*MINI:                                                             1109 03590000
*   IF FLAG(2:2)='1'B               /* IS THIS A NON DATA MINI HEADER   03591000
*                                                            @Y30LB40*/ 03592000
*       |T4TIME=0&T5TIME=0          /* IS THIS A NULL MINI   @OZ05079*/ 03593000
*     THEN                                                         1109 03594000
MINI     L     @15,PTR2                                            1109 03595000
         TM    FLAG(@15),B'01000000'                               1109 03596000
         BO    @RT01109                                            1109 03597000
         LH    @14,T4TIME(,@15)                                    1109 03598000
         N     @14,@CF01285                                        1109 03599000
         LTR   @14,@14                                             1109 03600000
         BNZ   @RF01109                                            1109 03601000
         LH    @15,T5TIME(,@15)                                    1109 03602000
         N     @15,@CF01285                                        1109 03603000
         LTR   @15,@15                                             1109 03604000
         BNZ   @RF01109                                            1109 03605000
@RT01109 DS    0H                                                  1110 03606000
*     DO;                           /* YES                   @Y30LB40*/ 03607000
*       IF NXTMINAD=0               /* LAST MINI             @OZ05079*/ 03608000
*           |NXTMINAD<=LSTMINAD     /* CHECK LAST MINI HEADER      1111 03609000
*                                                            @OZ05079*/ 03610000
*         THEN                                                     1111 03611000
         L     @15,PTR2                                            1111 03612000
         CLI   NXTMINAD(@15),0                                     1111 03613000
         BE    @RT01111                                            1111 03614000
         SLR   @14,@14                                             1111 03615000
         IC    @14,NXTMINAD(,@15)                                  1111 03616000
         CR    @14,LSTMINAD                                        1111 03617000
         BNH   @RT01111                                            1111 03618000
*         RETURN;                   /* GO TO NEXT ROUTINE    @OZ05079*/ 03619000
*       LSTMINAD=NXTMINAD;          /* SET LAST MINI HEADER  @YM31015*/ 03620000
         LR    LSTMINAD,@14                                        1113 03621000
*       PTR2=ADDR(RECIN)+NXTMINAD+8;/* SET POINTER           @YM31015*/ 03622000
         LA    @15,RECIN                                           1114 03623000
         ALR   @15,@14                                             1114 03624000
         AL    @15,@CF00036                                        1114 03625000
         ST    @15,PTR2                                            1114 03626000
*       GO TO MINI;                 /* GO TO NEXT ROUTINE    @YM31015*/ 03627000
         B     MINI                                                1115 03628000
*     END;                          /*                       @Y30LB40*/ 03629000
*   MINILINE=' ';                   /* BLANK OUT MINI LINE   @OZ09557*/ 03630000
@RF01109 MVI   MINILINE+1,C' '                                     1117 03631000
         MVC   MINILINE+2(119),MINILINE+1                          1117 03632000
         MVI   MINILINE,C' '                                       1117 03633000
*   IF MINI1SW='1'B                 /* TEST IF FIRST MINI    @Y30LB40*/ 03634000
*     THEN                                                         1118 03635000
         TM    MINI1SW,B'10000000'                                 1118 03636000
         BNO   @RF01118                                            1118 03637000
*     DO;                           /* YES,FIRST MINI        @Y30LB40   03638000
*                                      IF TIME NOT YET CONTERTED THEN*/ 03639000
*       IF PARMSW='I' THEN                                         1120 03640000
         CLI   PARMSW,C'I'                                         1120 03641000
         BNE   @RF01120                                            1120 03642000
*         CALL SDTABLE;             /* GO SAVE AND CONVERTS TIME     */ 03643000
         BAL   @14,SDTABLE                                         1121 03644000
*       MINICDAT='  /   ';          /* SETUP DATE PRINT PATTERN      */ 03645000
@RF01120 MVC   MINICDAT(6),@CC01200                                1122 03646000
*       MINICTIM='  :  :  ';        /* SETUP TIME PRINT PATTERN      */ 03647000
         MVC   MINICTIM(8),@CC01201                                1123 03648000
*       CALL EDITFIX(ADDR(SVEYEAR),1,'N');/*                 @Y30LB40*/ 03649000
         MVC   @AL00001+4(8),@AL01124                              1124 03650000
         LA    @15,SVEYEAR                                         1124 03651000
         ST    @15,@AFTEMPS+8                                      1124 03652000
         LA    @15,@AFTEMPS+8                                      1124 03653000
         ST    @15,@AL00001                                        1124 03654000
         LA    @01,@AL00001                                        1124 03655000
         BAL   @14,EDITFIX                                         1124 03656000
*       MINICDAT(1:2)=FIXOUT(12:13);/* PRINT CONVERTED YEAR          */ 03657000
         MVC   MINICDAT(2),FIXOUT+11                               1125 03658000
*       CALL EDITFIX(ADDR(SVEJUL),2,'N');/*                  @Y30LB40*/ 03659000
         MVC   @AL00001+4(8),@AL01126                              1126 03660000
         LA    @15,SVEJUL                                          1126 03661000
         ST    @15,@AFTEMPS+8                                      1126 03662000
         LA    @15,@AFTEMPS+8                                      1126 03663000
         ST    @15,@AL00001                                        1126 03664000
         LA    @01,@AL00001                                        1126 03665000
         BAL   @14,EDITFIX                                         1126 03666000
*       MINICDAT(4:6)=FIXOUT(11:13);/* PRINT CONVERTED DAY           */ 03667000
         MVC   MINICDAT+3(3),FIXOUT+10                             1127 03668000
*       DAYS=SVETME;                /*                       @Y30LB40*/ 03669000
         L     @15,SVETME                                          1128 03670000
         ST    @15,DAYS                                            1128 03671000
*       CALL CONVERTM;              /* CONVERT TIME TO HOURS,MINUTES    03672000
*                                      AND SECONDS                   */ 03673000
         BAL   @14,CONVERTM                                        1129 03674000
*       CALL EDITFIX(ADDR(HOUR),2,'S');/*                    @Y30LB40*/ 03675000
         MVC   @AL00001+4(8),@AL01130                              1130 03676000
         LA    @15,HOUR                                            1130 03677000
         ST    @15,@AFTEMPS+8                                      1130 03678000
         LA    @15,@AFTEMPS+8                                      1130 03679000
         ST    @15,@AL00001                                        1130 03680000
         LA    @01,@AL00001                                        1130 03681000
         BAL   @14,EDITFIX                                         1130 03682000
*       MINICTIM(1:2)=FIXOUT(12:13);/* PRINT HOURS           @Y30LB40*/ 03683000
         MVC   MINICTIM(2),FIXOUT+11                               1131 03684000
*       CALL EDITFIX(ADDR(MINUTE),2,'N');/*                  @Y30LB40*/ 03685000
         MVC   @AL00001+4(8),@AL01132                              1132 03686000
         LA    @15,MINUTE                                          1132 03687000
         ST    @15,@AFTEMPS+8                                      1132 03688000
         LA    @15,@AFTEMPS+8                                      1132 03689000
         ST    @15,@AL00001                                        1132 03690000
         LA    @01,@AL00001                                        1132 03691000
         BAL   @14,EDITFIX                                         1132 03692000
*       MINICTIM(4:5)=FIXOUT(12:13);/* PRINT MINUTES         @Y30LB40*/ 03693000
         MVC   MINICTIM+3(2),FIXOUT+11                             1133 03694000
*       CALL EDITFIX(ADDR(SECOND),2,'N');/*                  @Y30LB40*/ 03695000
         MVC   @AL00001+4(8),@AL01134                              1134 03696000
         LA    @15,SECOND                                          1134 03697000
         ST    @15,@AFTEMPS+8                                      1134 03698000
         LA    @15,@AFTEMPS+8                                      1134 03699000
         ST    @15,@AL00001                                        1134 03700000
         LA    @01,@AL00001                                        1134 03701000
         BAL   @14,EDITFIX                                         1134 03702000
*       MINICTIM(7:8)=FIXOUT(12:13);/* PRINT SECONDS         @Y30LB40*/ 03703000
         MVC   MINICTIM+6(2),FIXOUT+11                             1135 03704000
*     END;                          /*                       @Y30LB40*/ 03705000
*                                                                  1136 03706000
*   /*****************************************************************/ 03707000
*   /*                                                               */ 03708000
*   /* ***********************************************       @OZ09557*/ 03709000
*   /* CHECK THE TIME IN THE FIRST STAGE OR DESTAGE          @OZ09557*/ 03710000
*   /* MINI AGAINST THE TIME RANGE SPECIFIED IN THE          @OZ09557*/ 03711000
*   /* PARM FIELD OF THE EXECUTE STATEMENT. IF               @OZ09557*/ 03712000
*   /* WITHIN THE SPECIFIED RANGE, PRINT THE BLOCK           @OZ09557*/ 03713000
*   /* HEADER AND PROCESS THE APPROPRIATE MINI               @OZ09557*/ 03714000
*   /* HEADERS. IF NOT WITHIN THE SPECIFIED RANGE,           @OZ09557*/ 03715000
*   /* RETURN TO THE MAINLINE WITHOUT PROCESSING             @OZ09557*/ 03716000
*   /* EITHER THE HEADER OR THE MINIS.                       @OZ09557*/ 03717000
*   /* ***********************************************       @OZ09557*/ 03718000
*   /*                                                               */ 03719000
*   /*****************************************************************/ 03720000
*                                                                  1137 03721000
*   IF CKTIME<CKSTIME               /*                       @OZ09557*/ 03722000
*       |CKTIME>CKETIME             /*                       @OZ09557*/ 03723000
*     THEN                          /*                       @OZ09557*/ 03724000
@RF01118 CLC   CKTIME(7),CKSTIME                                   1137 03725000
         BL    @RT01137                                            1137 03726000
         CLC   CKTIME(7),CKETIME                                   1137 03727000
         BH    @RT01137                                            1137 03728000
*     RETURN;                       /*                       @OZ09557*/ 03729000
*   IF MINI1SW='1'B                 /* HEADER NOT WRITTEN    @OZ11670*/ 03730000
*     THEN                          /*                       @OZ11670*/ 03731000
         TM    MINI1SW,B'10000000'                                 1139 03732000
         BNO   @RF01139                                            1139 03733000
*     CALL BLKHDR;                  /* PRINT BLOCK HEADER    @OZ11670*/ 03734000
*                                                                  1140 03735000
         BAL   @14,BLKHDR                                          1140 03736000
*   /*****************************************************************/ 03737000
*   /*                                                               */ 03738000
*   /* ***********************************************       @ZA13498*/ 03739000
*   /* CONVERT T1 TIME (BUT NOT DATE) FOR SECOND OR          @ZA13498*/ 03740000
*   /* SUBSEQUENT STAGE/DESTAGE MINIS FOR THE SAME           @ZA13498*/ 03741000
*   /* BLOCK HEADER.                                         @ZA13498*/ 03742000
*   /* ***********************************************       @ZA13498*/ 03743000
*   /*                                                               */ 03744000
*   /*****************************************************************/ 03745000
*                                                                  1141 03746000
*   IF STDESTSW='0'B                /*                       @ZA13498*/ 03747000
*     THEN                          /*                       @ZA13498*/ 03748000
@RF01139 TM    STDESTSW,B'10000000'                                1141 03749000
         BNZ   @RF01141                                            1141 03750000
*     DO;                           /*                       @ZA13498*/ 03751000
*       MINICTIM='  :  :  ';        /*                       @ZA13498*/ 03752000
         MVC   MINICTIM(8),@CC01201                                1143 03753000
*       HOLDTXTM=T1TIME;            /*                       @ZA13498*/ 03754000
         L     @01,PTR2                                            1144 03755000
         L     HOLDTXTM,T1TIME(,@01)                               1144 03756000
*       SLL(HOLDTXTM,8);            /*                       @ZA13498*/ 03757000
         SLL   HOLDTXTM,8                                          1145 03758000
*       SRL(HOLDTXTM,16);           /*                       @ZA13498*/ 03759000
         SRL   HOLDTXTM,16                                         1146 03760000
*       CALL TIME2345;              /*                       @ZA13498*/ 03761000
         BAL   @14,TIME2345                                        1147 03762000
*       CALL EDITFIX(ADDR(HOUR),2,'S');/*                    @ZA13498*/ 03763000
         MVC   @AL00001+4(8),@AL01148                              1148 03764000
         LA    @15,HOUR                                            1148 03765000
         ST    @15,@AFTEMPS+8                                      1148 03766000
         LA    @15,@AFTEMPS+8                                      1148 03767000
         ST    @15,@AL00001                                        1148 03768000
         LA    @01,@AL00001                                        1148 03769000
         BAL   @14,EDITFIX                                         1148 03770000
*       MINICTIM(1:2)=FIXOUT(12:13);/*                       @ZA13498*/ 03771000
         MVC   MINICTIM(2),FIXOUT+11                               1149 03772000
*       CALL EDITFIX(ADDR(MINUTE),2,'N');/*                  @ZA13498*/ 03773000
         MVC   @AL00001+4(8),@AL01150                              1150 03774000
         LA    @15,MINUTE                                          1150 03775000
         ST    @15,@AFTEMPS+8                                      1150 03776000
         LA    @15,@AFTEMPS+8                                      1150 03777000
         ST    @15,@AL00001                                        1150 03778000
         LA    @01,@AL00001                                        1150 03779000
         BAL   @14,EDITFIX                                         1150 03780000
*       MINICTIM(4:5)=FIXOUT(12:13);/*                       @ZA13498*/ 03781000
         MVC   MINICTIM+3(2),FIXOUT+11                             1151 03782000
*       CALL EDITFIX(ADDR(SECOND),2,'N');/*                  @ZA13498*/ 03783000
         MVC   @AL00001+4(8),@AL01152                              1152 03784000
         LA    @15,SECOND                                          1152 03785000
         ST    @15,@AFTEMPS+8                                      1152 03786000
         LA    @15,@AFTEMPS+8                                      1152 03787000
         ST    @15,@AL00001                                        1152 03788000
         LA    @01,@AL00001                                        1152 03789000
         BAL   @14,EDITFIX                                         1152 03790000
*       MINICTIM(7:8)=FIXOUT(12:13);/*                       @ZA13498*/ 03791000
         MVC   MINICTIM+6(2),FIXOUT+11                             1153 03792000
*     END;                          /*                       @ZA13498*/ 03793000
*   STDESTSW='0'B;                  /*                       @ZA13498*/ 03794000
@RF01141 NI    STDESTSW,B'01111111'                                1155 03795000
*   IF LINECNT>52                   /* NEW PAGE HEADING NEEDED     1156 03796000
*                                                            @Y30LB40*/ 03797000
*     THEN                                                         1156 03798000
         C     LINECNT,@CF00040                                    1156 03799000
         BNH   @RF01156                                            1156 03800000
*     CALL NEWPAGE;                 /*                       @Y30LB40*/ 03801000
         BAL   @14,NEWPAGE                                         1157 03802000
*   HOLDHDG4=HDNG4;                 /*                       @CCCCCCC*/ 03803000
@RF01156 MVC   HOLDHDG4(121),HDNG4                                 1158 03804000
*   IF FLAG(1:2)='00'B              /*                       @CCCCCCC*/ 03805000
*     THEN                          /*                       @CCCCCCC*/ 03806000
         L     @01,PTR2                                            1159 03807000
         TM    FLAG(@01),B'11000000'                               1159 03808000
         BNZ   @RF01159                                            1159 03809000
*     HOLDDEST='DESTGE';            /*                       @CCCCCCC*/ 03810000
         MVC   HOLDDEST(6),@CC01202                                1160 03811000
*   RFY                                                            1161 03812000
*    (R0,                                                          1161 03813000
*     R1,                                                          1161 03814000
*     R14,                                                         1161 03815000
*     R15) RSTD;                    /*                       @Y30LB40*/ 03816000
@RF01159 DS    0H                                                  1162 03817000
*   GEN(PUT   PRNTDCB,HOLDHDG4);    /* MINI HEADER HEADLINES 1     1162 03818000
*                                                            @CCCCCCC*/ 03819000
         PUT   PRNTDCB,HOLDHDG4                                         03820000
*   GEN(PUT   PRNTDCB,HDNG5);       /*                       @Y30LB40*/ 03821000
         PUT   PRNTDCB,HDNG5                                            03822000
*   RFY                                                            1164 03823000
*    (R0,                                                          1164 03824000
*     R1,                                                          1164 03825000
*     R14,                                                         1164 03826000
*     R15) UNRSTD;                  /*                       @Y30LB40*/ 03827000
*   LINECNT=LINECNT+3;              /*                       @Y30LB40*/ 03828000
         AL    LINECNT,@CF00117                                    1165 03829000
*   CALL EDITBIT(ADDR(SEQUENCE));   /* BUILD SEQUENCE FIELD  @Y30LB40*/ 03830000
         LA    @15,PTR2                                            1166 03831000
         ST    @15,@AL00001                                        1166 03832000
         LA    @01,@AL00001                                        1166 03833000
         BAL   @14,EDITBIT                                         1166 03834000
*   MINISEQ=BITOUT;                 /*                       @Y30LB40*/ 03835000
         MVC   MINISEQ(8),BITOUT                                   1167 03836000
*   CALL EDITBIT(ADDR(FLAG));       /* BUILD MINI FLAG FIELD @Y30LB40*/ 03837000
         L     @01,PTR2                                            1168 03838000
         LA    @15,FLAG(,@01)                                      1168 03839000
         ST    @15,@AFTEMPS+8                                      1168 03840000
         LA    @15,@AFTEMPS+8                                      1168 03841000
         ST    @15,@AL00001                                        1168 03842000
         LA    @01,@AL00001                                        1168 03843000
         BAL   @14,EDITBIT                                         1168 03844000
*   MINIFLAG=BITOUT;                /*                       @Y30LB40*/ 03845000
         MVC   MINIFLAG(8),BITOUT                                  1169 03846000
*   CALL EDITHEX(ADDR(NXTMINAD),1); /*                       @YD00173*/ 03847000
         L     @01,PTR2                                            1170 03848000
         LA    @15,NXTMINAD(,@01)                                  1170 03849000
         ST    @15,@AFTEMPS+8                                      1170 03850000
         LA    @15,@AFTEMPS+8                                      1170 03851000
         ST    @15,@AL00001                                        1170 03852000
         LA    @15,@CF00045                                        1170 03853000
         ST    @15,@AL00001+4                                      1170 03854000
         LA    @01,@AL00001                                        1170 03855000
         BAL   @14,EDITHEX                                         1170 03856000
*   MINIADDR=HEXOUT(1:2);           /* PRINT NEXT MINI ADDRESS     1171 03857000
*                                                            @YD00173*/ 03858000
         MVC   MINIADDR(2),HEXOUT                                  1171 03859000
*   RCDTME=T1TIME;                  /*                       @Y30LB40*/ 03860000
         L     @01,PTR2                                            1172 03861000
         L     @15,T1TIME(,@01)                                    1172 03862000
         ST    @15,RCDTME                                          1172 03863000
*   SRL(RCDTME,8);                  /* GET HIGH ORDER THREE BYTES OF    03864000
*                                      T1                    @Y30LB40*/ 03865000
         SRL   @15,8                                               1173 03866000
         ST    @15,RCDTME                                          1173 03867000
*   CALL EDITFIX(ADDR(RCDTME),4,'S');/* EDIT T1 TIME         @Y30LB40*/ 03868000
         MVC   @AL00001+4(8),@AL01174                              1174 03869000
         LA    @15,RCDTME                                          1174 03870000
         ST    @15,@AFTEMPS+8                                      1174 03871000
         LA    @15,@AFTEMPS+8                                      1174 03872000
         ST    @15,@AL00001                                        1174 03873000
         LA    @01,@AL00001                                        1174 03874000
         BAL   @14,EDITFIX                                         1174 03875000
*   MINIT1A=FIXOUT(6:13);           /*                       @Y30LB40*/ 03876000
         MVC   MINIT1A(8),FIXOUT+5                                 1175 03877000
*   RCDTME=T1TIME;                  /*                       @Y30LB40*/ 03878000
         L     @01,PTR2                                            1176 03879000
         L     @15,T1TIME(,@01)                                    1176 03880000
         ST    @15,RCDTME                                          1176 03881000
*   SLL(RCDTME,24);                 /* GET LOW ORDER BYTE OF T1    1177 03882000
*                                                            @Y30LB40*/ 03883000
         SLL   @15,24                                              1177 03884000
         ST    @15,RCDTME                                          1177 03885000
*   SRL(RCDTME,24);                 /*                       @Y30LB40*/ 03886000
         L     @15,RCDTME                                          1178 03887000
         SRL   @15,24                                              1178 03888000
         ST    @15,RCDTME                                          1178 03889000
*   CALL EDITFIX(ADDR(RCDTME),4,'N');/*                      @Y30LB40*/ 03890000
         MVC   @AL00001+4(8),@AL01179                              1179 03891000
         LA    @15,RCDTME                                          1179 03892000
         ST    @15,@AFTEMPS+8                                      1179 03893000
         LA    @15,@AFTEMPS+8                                      1179 03894000
         ST    @15,@AL00001                                        1179 03895000
         LA    @01,@AL00001                                        1179 03896000
         BAL   @14,EDITFIX                                         1179 03897000
*   MINIT1C=FIXOUT(11:13);          /* PRINT T1              @Y30LB40*/ 03898000
         MVC   MINIT1C(3),FIXOUT+10                                1180 03899000
*   MINIT1B='-';                    /*                       @Y30LB40*/ 03900000
         MVI   MINIT1B,C'-'                                        1181 03901000
*   HOLDTXTM=T4TIME;                /*                       @ZA13498*/ 03902000
         L     @01,PTR2                                            1182 03903000
         LH    HOLDTXTM,T4TIME(,@01)                               1182 03904000
         N     HOLDTXTM,@CF01285                                   1182 03905000
*   CALL TIME2345;                  /*                       @ZA13498*/ 03906000
         BAL   @14,TIME2345                                        1183 03907000
*   CALL EDITFIX(ADDR(HOUR),2,'S'); /*                       @ZA13498*/ 03908000
         MVC   @AL00001+4(8),@AL01184                              1184 03909000
         LA    @15,HOUR                                            1184 03910000
         ST    @15,@AFTEMPS+8                                      1184 03911000
         LA    @15,@AFTEMPS+8                                      1184 03912000
         ST    @15,@AL00001                                        1184 03913000
         LA    @01,@AL00001                                        1184 03914000
         BAL   @14,EDITFIX                                         1184 03915000
*   T4HOUR=FIXOUT(12:13);           /*                       @ZA13498*/ 03916000
         MVC   T4HOUR(2),FIXOUT+11                                 1185 03917000
*   T4SEP1=':';                     /*                       @ZA13498*/ 03918000
         MVI   T4SEP1,C':'                                         1186 03919000
*   CALL EDITFIX(ADDR(MINUTE),2,'N');/*                      @ZA13498*/ 03920000
         MVC   @AL00001+4(8),@AL01187                              1187 03921000
         LA    @15,MINUTE                                          1187 03922000
         ST    @15,@AFTEMPS+8                                      1187 03923000
         LA    @15,@AFTEMPS+8                                      1187 03924000
         ST    @15,@AL00001                                        1187 03925000
         LA    @01,@AL00001                                        1187 03926000
         BAL   @14,EDITFIX                                         1187 03927000
*   T4MINUTE=FIXOUT(12:13);         /*                       @ZA13498*/ 03928000
         MVC   T4MINUTE(2),FIXOUT+11                               1188 03929000
*   T4SEP2=':';                     /*                       @ZA13498*/ 03930000
         MVI   T4SEP2,C':'                                         1189 03931000
*   CALL EDITFIX(ADDR(SECOND),2,'N');/*                      @ZA13498*/ 03932000
         MVC   @AL00001+4(8),@AL01190                              1190 03933000
         LA    @15,SECOND                                          1190 03934000
         ST    @15,@AFTEMPS+8                                      1190 03935000
         LA    @15,@AFTEMPS+8                                      1190 03936000
         ST    @15,@AL00001                                        1190 03937000
         LA    @01,@AL00001                                        1190 03938000
         BAL   @14,EDITFIX                                         1190 03939000
*   T4SECOND=FIXOUT(12:13);         /*                       @ZA13498*/ 03940000
         MVC   T4SECOND(2),FIXOUT+11                               1191 03941000
*   HOLDTXTM=T5TIME;                /*                       @ZA13498*/ 03942000
         L     @01,PTR2                                            1192 03943000
         LH    HOLDTXTM,T5TIME(,@01)                               1192 03944000
         N     HOLDTXTM,@CF01285                                   1192 03945000
*   CALL TIME2345;                  /*                       @ZA13498*/ 03946000
         BAL   @14,TIME2345                                        1193 03947000
*   CALL EDITFIX(ADDR(HOUR),2,'S'); /*                       @ZA13498*/ 03948000
         MVC   @AL00001+4(8),@AL01194                              1194 03949000
         LA    @15,HOUR                                            1194 03950000
         ST    @15,@AFTEMPS+8                                      1194 03951000
         LA    @15,@AFTEMPS+8                                      1194 03952000
         ST    @15,@AL00001                                        1194 03953000
         LA    @01,@AL00001                                        1194 03954000
         BAL   @14,EDITFIX                                         1194 03955000
*   T5HOUR=FIXOUT(12:13);           /*                       @ZA13498*/ 03956000
         MVC   T5HOUR(2),FIXOUT+11                                 1195 03957000
*   T5SEP1=':';                     /*                       @ZA13498*/ 03958000
         MVI   T5SEP1,C':'                                         1196 03959000
*   CALL EDITFIX(ADDR(MINUTE),2,'N');/*                      @ZA13498*/ 03960000
         MVC   @AL00001+4(8),@AL01197                              1197 03961000
         LA    @15,MINUTE                                          1197 03962000
         ST    @15,@AFTEMPS+8                                      1197 03963000
         LA    @15,@AFTEMPS+8                                      1197 03964000
         ST    @15,@AL00001                                        1197 03965000
         LA    @01,@AL00001                                        1197 03966000
         BAL   @14,EDITFIX                                         1197 03967000
*   T5MINUTE=FIXOUT(12:13);         /*                       @ZA13498*/ 03968000
         MVC   T5MINUTE(2),FIXOUT+11                               1198 03969000
*   T5SEP2=':';                     /*                       @ZA13498*/ 03970000
         MVI   T5SEP2,C':'                                         1199 03971000
*   CALL EDITFIX(ADDR(SECOND),2,'N');/*                      @ZA13498*/ 03972000
         MVC   @AL00001+4(8),@AL01200                              1200 03973000
         LA    @15,SECOND                                          1200 03974000
         ST    @15,@AFTEMPS+8                                      1200 03975000
         LA    @15,@AFTEMPS+8                                      1200 03976000
         ST    @15,@AL00001                                        1200 03977000
         LA    @01,@AL00001                                        1200 03978000
         BAL   @14,EDITFIX                                         1200 03979000
*   T5SECOND=FIXOUT(12:13);         /*                       @ZA13498*/ 03980000
         MVC   T5SECOND(2),FIXOUT+11                               1201 03981000
*   CALL EDITHEX(ADDR(FUNCID),1);   /*                       @Y30LB40*/ 03982000
         L     @01,PTR2                                            1202 03983000
         LA    @15,FUNCID(,@01)                                    1202 03984000
         ST    @15,@AFTEMPS+8                                      1202 03985000
         LA    @15,@AFTEMPS+8                                      1202 03986000
         ST    @15,@AL00001                                        1202 03987000
         LA    @15,@CF00045                                        1202 03988000
         ST    @15,@AL00001+4                                      1202 03989000
         LA    @01,@AL00001                                        1202 03990000
         BAL   @14,EDITHEX                                         1202 03991000
*   MINIFUNC=HEXOUT(1:2);           /* PRINT COMMAND CODE    @Y30LB40*/ 03992000
         MVC   MINIFUNC(2),HEXOUT                                  1203 03993000
*   CALL EDITHEX(ADDR(CPUID),1);    /*                       @Y30LB40*/ 03994000
         L     @01,PTR2                                            1204 03995000
         LA    @15,CPUID(,@01)                                     1204 03996000
         ST    @15,@AFTEMPS+8                                      1204 03997000
         LA    @15,@AFTEMPS+8                                      1204 03998000
         ST    @15,@AL00001                                        1204 03999000
         LA    @15,@CF00045                                        1204 04000000
         ST    @15,@AL00001+4                                      1204 04001000
         LA    @01,@AL00001                                        1204 04002000
         BAL   @14,EDITHEX                                         1204 04003000
*   MINICPU=HEXOUT(1:2);            /* PRINT HOST CPU ID     @Y30LB40*/ 04004000
         MVC   MINICPU(2),HEXOUT                                   1205 04005000
*   CALL EDITBIT(ADDR(PLFLAG));     /*                       @Y30LB40*/ 04006000
         L     @01,PTR2                                            1206 04007000
         LA    @15,PLFLAG(,@01)                                    1206 04008000
         ST    @15,@AFTEMPS+8                                      1206 04009000
         LA    @15,@AFTEMPS+8                                      1206 04010000
         ST    @15,@AL00001                                        1206 04011000
         LA    @01,@AL00001                                        1206 04012000
         BAL   @14,EDITBIT                                         1206 04013000
*   MINIPGFL=BITOUT;                /* PRINT PAGE LIST FLAG  @Y30LB40*/ 04014000
         MVC   MINIPGFL(8),BITOUT                                  1207 04015000
*   CALL EDITHEX(ADDR(VUA),1);      /*                       @Y30LB40*/ 04016000
         L     @01,PTR2                                            1208 04017000
         LA    @15,VUA(,@01)                                       1208 04018000
         ST    @15,@AFTEMPS+8                                      1208 04019000
         LA    @15,@AFTEMPS+8                                      1208 04020000
         ST    @15,@AL00001                                        1208 04021000
         LA    @15,@CF00045                                        1208 04022000
         ST    @15,@AL00001+4                                      1208 04023000
         LA    @01,@AL00001                                        1208 04024000
         BAL   @14,EDITHEX                                         1208 04025000
*   MINIVUA=HEXOUT(1:2);            /* PRINT VIRTUAL UNIT ADDRESS  1209 04026000
*                                                            @Y30LB40*/ 04027000
         MVC   MINIVUA(2),HEXOUT                                   1209 04028000
*   CALL EDITHEX(ADDR(VVA),1);      /*                       @Y30LB40*/ 04029000
         L     @01,PTR2                                            1210 04030000
         LA    @15,VVA(,@01)                                       1210 04031000
         ST    @15,@AFTEMPS+8                                      1210 04032000
         LA    @15,@AFTEMPS+8                                      1210 04033000
         ST    @15,@AL00001                                        1210 04034000
         LA    @15,@CF00045                                        1210 04035000
         ST    @15,@AL00001+4                                      1210 04036000
         LA    @01,@AL00001                                        1210 04037000
         BAL   @14,EDITHEX                                         1210 04038000
*   MINIVVA=HEXOUT(1:2);            /* PRINT VIRTUAL VOLUME ADDRESS     04039000
*                                                            @Y30LB40*/ 04040000
         MVC   MINIVVA(2),HEXOUT                                   1211 04041000
*   CALL EDITFIX(ADDR(COUNT),1,'S');/*                       @Y30LB40*/ 04042000
         MVC   @AL00001+4(8),@AL01212                              1212 04043000
         L     @01,PTR2                                            1212 04044000
         LA    @15,COUNT(,@01)                                     1212 04045000
         ST    @15,@AFTEMPS+8                                      1212 04046000
         LA    @15,@AFTEMPS+8                                      1212 04047000
         ST    @15,@AL00001                                        1212 04048000
         LA    @01,@AL00001                                        1212 04049000
         BAL   @14,EDITFIX                                         1212 04050000
*   MINICNT=FIXOUT(11:13);          /* PRINT PAGE COUNT      @Y30LB40*/ 04051000
         MVC   MINICNT(3),FIXOUT+10                                1213 04052000
*   CONVERT=0;                      /*                       @Y30LB40*/ 04053000
         SLR   @15,@15                                             1214 04054000
         STH   @15,CONVERT                                         1214 04055000
*   FLD2=COUNT;                     /*                       @Y30LB40*/ 04056000
         L     @01,PTR2                                            1215 04057000
         MVC   FLD2(1),COUNT(@01)                                  1215 04058000
*   J=CONVERT;                      /* SAVE PAGE LIST COUNT  @Y30LB40*/ 04059000
         LH    @14,CONVERT                                         1216 04060000
         STH   @14,J                                               1216 04061000
*   K=0;                            /*                       @Y30LB40*/ 04062000
         STH   @15,K                                               1217 04063000
*   RFY                                                            1218 04064000
*    (R0,                                                          1218 04065000
*     R1,                                                          1218 04066000
*     R14,                                                         1218 04067000
*     R15) RSTD;                    /*                       @Y30LB40*/ 04068000
*   GEN(PUT   PRNTDCB,PRNTLINE);    /* PRINT MINI HEADER LINE      1219 04069000
*                                                            @OZ09557*/ 04070000
         PUT   PRNTDCB,PRNTLINE                                         04071000
*   RFY                                                            1220 04072000
*    (R0,                                                          1220 04073000
*     R1,                                                          1220 04074000
*     R14,                                                         1220 04075000
*     R15) UNRSTD;                  /*                       @Y30LB40*/ 04076000
*   PRNTLINE=' ';                   /*                       @OZ09557*/ 04077000
         MVI   PRNTLINE+1,C' '                                     1221 04078000
         MVC   PRNTLINE+2(119),PRNTLINE+1                          1221 04079000
         MVI   PRNTLINE,C' '                                       1221 04080000
*   LINECNT=LINECNT+1;              /*                       @Y30LB40*/ 04081000
         AL    LINECNT,@CF00045                                    1222 04082000
*   IF J^=0                         /* IF ANY PAGE LIST      @OZ05079*/ 04083000
*     THEN                          /*                       @OZ05079*/ 04084000
         LH    @15,J                                               1223 04085000
         LTR   @15,@15                                             1223 04086000
         BZ    @RF01223                                            1223 04087000
*     CALL PAGE;                    /* PRINT PAGE LISTS      @OZ05079*/ 04088000
         BAL   @14,PAGE                                            1224 04089000
*   IF NXTMINAD=0                   /* LAST MINI             @OZ05079*/ 04090000
*       |NXTMINAD<=LSTMINAD         /* CHECK LAST MINI HEADER      1225 04091000
*                                                            @YM31015*/ 04092000
*     THEN                                                         1225 04093000
@RF01223 L     @15,PTR2                                            1225 04094000
         CLI   NXTMINAD(@15),0                                     1225 04095000
         BE    @RT01225                                            1225 04096000
         SLR   @14,@14                                             1225 04097000
         IC    @14,NXTMINAD(,@15)                                  1225 04098000
         CR    @14,LSTMINAD                                        1225 04099000
         BNH   @RT01225                                            1225 04100000
*     RETURN;                       /* GO TO NEXT ROUTINE    @OZ05079*/ 04101000
*   LSTMINAD=NXTMINAD;              /* SET LAST MINI HEADER  @YM31015*/ 04102000
         LR    LSTMINAD,@14                                        1227 04103000
*   PTR2=ADDR(RECIN)+NXTMINAD+8;    /* SET POINTER           @YM31015*/ 04104000
         LA    @15,RECIN                                           1228 04105000
         ALR   @15,@14                                             1228 04106000
         AL    @15,@CF00036                                        1228 04107000
         ST    @15,PTR2                                            1228 04108000
*   GO TO MINI;                     /* PTR OK, GO GET NEXT MINI    1229 04109000
*                                                            @Y30LB40*/ 04110000
         B     MINI                                                1229 04111000
*   END BLOCK;                      /*                       @OZ05079*/ 04112000
         B     @EL00013                                            1230 04113000
*                                                                  1231 04114000
*/********************************************************** @OZ05079*/ 04115000
*/*                                                          @OZ05079*/ 04116000
*/* PROCEDURE NAME - PAGE                                    @OZ05079*/ 04117000
*/*                                                          @OZ05079*/ 04118000
*/* FUNCTION - PRINT PAGE LIST                               @OZ05079*/ 04119000
*/*                                                          @OZ05079*/ 04120000
*/********************************************************** @OZ05079*/ 04121000
*                                                                  1231 04122000
*PAGE:                                                             1231 04123000
*   PROCEDURE;                      /*                       @OZ05079*/ 04124000
PAGE     STM   @14,@06,@SA00014                                    1231 04125000
         STM   @08,@12,@SA00014+36                                 1231 04126000
*STARTPG:                           /*                       @OZ05079*/ 04127000
*   IF LINECNT>52 THEN                                             1232 04128000
STARTPG  C     LINECNT,@CF00040                                    1232 04129000
         BNH   @RF01232                                            1232 04130000
*     CALL NEWPAGE;                 /*                       @Y30LB40*/ 04131000
         BAL   @14,NEWPAGE                                         1233 04132000
*   RFY                                                            1234 04133000
*    (R0,                                                          1234 04134000
*     R1,                                                          1234 04135000
*     R14,                                                         1234 04136000
*     R15) RSTD;                    /*                       @Y30LB40*/ 04137000
@RF01232 DS    0H                                                  1235 04138000
*   GEN(PUT   PRNTDCB,HDNG6);       /* PRINT PAGE LIST HEADLINES 1 1235 04139000
*                                      AND 2                         */ 04140000
         PUT   PRNTDCB,HDNG6                                            04141000
*   GEN(PUT   PRNTDCB,HDNG7);       /*                       @Y30LB40*/ 04142000
         PUT   PRNTDCB,HDNG7                                            04143000
*   RFY                                                            1237 04144000
*    (R0,                                                          1237 04145000
*     R1,                                                          1237 04146000
*     R14,                                                         1237 04147000
*     R15) UNRSTD;                  /*                       @Y30LB40*/ 04148000
*   LINECNT=LINECNT+3;              /*                       @Y30LB40*/ 04149000
         AL    LINECNT,@CF00117                                    1238 04150000
*   DO WHILE(K^=J);                 /* NUMBER PAGES EQUAL COUNT    1239 04151000
*                                                            @Y30LB40*/ 04152000
         B     @DE01239                                            1239 04153000
@DL01239 DS    0H                                                  1240 04154000
*     IF LINECNT>55                 /* PAGE FULL             @Y30LB40*/ 04155000
*       THEN                                                       1240 04156000
         C     LINECNT,@CF01089                                    1240 04157000
         BNH   @RF01240                                            1240 04158000
*       DO;                         /*                       @Y30LB40*/ 04159000
*         CALL NEWPAGE;             /*                       @Y30LB40*/ 04160000
         BAL   @14,NEWPAGE                                         1242 04161000
*         GO TO STARTPG;            /*                       @OZ05079*/ 04162000
         B     STARTPG                                             1243 04163000
*       END;                        /*                       @Y30LB40*/ 04164000
*     PAGELINE=' ';                 /*                       @Y30LB40*/ 04165000
@RF01240 MVI   PAGELINE+1,C' '                                     1245 04166000
         MVC   PAGELINE+2(119),PAGELINE+1                          1245 04167000
         MVI   PAGELINE,C' '                                       1245 04168000
*     K=K+1;                        /*                       @Y30LB40*/ 04169000
         LA    @06,1                                               1246 04170000
         AH    @06,K                                               1246 04171000
         STH   @06,K                                               1246 04172000
*     FLD2=SAVESDG;                 /* SDG PART OF DASD SSID @OZ08841*/ 04173000
         MVC   FLD2(1),SAVESDG                                     1247 04174000
*     IF DEVICE(K,1:1)='1'B THEN                                   1248 04175000
         SLA   @06,2                                               1248 04176000
         L     @01,PTR2                                            1248 04177000
         ALR   @01,@06                                             1248 04178000
         TM    DEVICE-4(@01),B'00000100'                           1248 04179000
         BNO   @RF01248                                            1248 04180000
*       FLD2(6:6)='1'B;             /*                       @Y30LB40*/ 04181000
         OI    FLD2,B'00000100'                                    1249 04182000
*     IF DEVICE(K,2:2)='1'B THEN                                   1250 04183000
@RF01248 LH    @06,K                                               1250 04184000
         SLA   @06,2                                               1250 04185000
         L     @01,PTR2                                            1250 04186000
         ALR   @01,@06                                             1250 04187000
         TM    DEVICE-4(@01),B'00000010'                           1250 04188000
         BNO   @RF01250                                            1250 04189000
*       FLD2(7:7)='1'B;             /*                       @Y30LB40*/ 04190000
         OI    FLD2,B'00000010'                                    1251 04191000
*     IF DEVICE(K,3:3)='1'B THEN                                   1252 04192000
@RF01250 LH    @06,K                                               1252 04193000
         SLA   @06,2                                               1252 04194000
         L     @01,PTR2                                            1252 04195000
         ALR   @01,@06                                             1252 04196000
         TM    DEVICE-4(@01),B'00000001'                           1252 04197000
         BNO   @RF01252                                            1252 04198000
*       FLD2(8:8)='1'B;             /*                       @Y30LB40*/ 04199000
         OI    FLD2,B'00000001'                                    1253 04200000
*     CALL EDITHEX(ADDR(FLD2),1);   /* 2 LOW-ORDER DIGITS    @OZ08841*/ 04201000
@RF01252 LA    @06,FLD2                                            1254 04202000
         ST    @06,@AFTEMPS+12                                     1254 04203000
         LA    @06,@AFTEMPS+12                                     1254 04204000
         ST    @06,@AL00001                                        1254 04205000
         LA    @06,@CF00045                                        1254 04206000
         ST    @06,@AL00001+4                                      1254 04207000
         LA    @01,@AL00001                                        1254 04208000
         BAL   @14,EDITHEX                                         1254 04209000
*     PAGEDEV(2:3)=HEXOUT(1:2);     /* TO PRINT LINE         @OZ08841*/ 04210000
         MVC   PAGEDEV+1(2),HEXOUT                                 1255 04211000
*     PAGEDEV(1:1)='0';             /* HIGH-ORDER DIGIT      @OZ08841*/ 04212000
         MVI   PAGEDEV,C'0'                                        1256 04213000
*     CALL EDITFIX(ADDR(VIRTPAGE(K)),1,'S');/*               @Y30LB40*/ 04214000
         MVC   @AL00001+4(8),@AL01257                              1257 04215000
         LH    @06,K                                               1257 04216000
         SLA   @06,2                                               1257 04217000
         L     @01,PTR2                                            1257 04218000
         LA    @06,VIRTPAGE-4(@06,@01)                             1257 04219000
         ST    @06,@AFTEMPS+12                                     1257 04220000
         LA    @06,@AFTEMPS+12                                     1257 04221000
         ST    @06,@AL00001                                        1257 04222000
         LA    @01,@AL00001                                        1257 04223000
         BAL   @14,EDITFIX                                         1257 04224000
*     PAGEVP=FIXOUT(11:13);         /* PRINT VIRTUAL PAGE NUMBER   1258 04225000
*                                                            @Y30LB40*/ 04226000
         MVC   PAGEVP(3),FIXOUT+10                                 1258 04227000
*     CALL EDITFIX(ADDR(REALPAGE(K)),1,'S');/*               @Y30LB40*/ 04228000
         MVC   @AL00001+4(8),@AL01259                              1259 04229000
         LH    @06,K                                               1259 04230000
         SLA   @06,2                                               1259 04231000
         L     @01,PTR2                                            1259 04232000
         LA    @06,REALPAGE-4(@06,@01)                             1259 04233000
         ST    @06,@AFTEMPS+12                                     1259 04234000
         LA    @06,@AFTEMPS+12                                     1259 04235000
         ST    @06,@AL00001                                        1259 04236000
         LA    @01,@AL00001                                        1259 04237000
         BAL   @14,EDITFIX                                         1259 04238000
*     PAGERP=FIXOUT(11:13);         /* PRINT REAL PAGE NUMBER      1260 04239000
*                                                            @Y30LB40*/ 04240000
         MVC   PAGERP(3),FIXOUT+10                                 1260 04241000
*     CALL EDITBIT(ADDR(CYLIND(K)));/*                       @Y30LB40*/ 04242000
         LH    @06,K                                               1261 04243000
         SLA   @06,2                                               1261 04244000
         L     @01,PTR2                                            1261 04245000
         LA    @06,CYLIND-4(@06,@01)                               1261 04246000
         ST    @06,@AFTEMPS+12                                     1261 04247000
         LA    @06,@AFTEMPS+12                                     1261 04248000
         ST    @06,@AL00001                                        1261 04249000
         LA    @01,@AL00001                                        1261 04250000
         BAL   @14,EDITBIT                                         1261 04251000
*     PAGECYL=BITOUT;               /* PRINT CYLINDER INDICATORS   1262 04252000
*                                                            @Y30LB40*/ 04253000
         MVC   PAGECYL(8),BITOUT                                   1262 04254000
*     RFY                                                          1263 04255000
*      (R0,                                                        1263 04256000
*       R1,                                                        1263 04257000
*       R14,                                                       1263 04258000
*       R15) RSTD;                  /*                       @Y30LB40*/ 04259000
*     GEN(PUT   PRNTDCB,PAGELINE);  /* PRINT PAGE LIST LINE  @Y30LB40*/ 04260000
         PUT   PRNTDCB,PAGELINE                                         04261000
*     RFY                                                          1265 04262000
*      (R0,                                                        1265 04263000
*       R1,                                                        1265 04264000
*       R14,                                                       1265 04265000
*       R15) UNRSTD;                /*                       @Y30LB40*/ 04266000
*     LINECNT=LINECNT+1;            /*                       @Y30LB40*/ 04267000
         AL    LINECNT,@CF00045                                    1266 04268000
*   END;                            /*                       @Y30LB40*/ 04269000
@DE01239 CLC   K(2),J                                              1267 04270000
         BNE   @DL01239                                            1267 04271000
*   END PAGE;                       /*                       @OZ05079*/ 04272000
@EL00014 DS    0H                                                  1268 04273000
@EF00014 DS    0H                                                  1268 04274000
@ER00014 LM    @14,@06,@SA00014                                    1268 04275000
         LM    @08,@12,@SA00014+36                                 1268 04276000
         BR    @14                                                 1268 04277000
*                                                                  1269 04278000
*/********************************************************** @OZ09557*/ 04279000
*/*                                                          @OZ09557*/ 04280000
*/* PROCEDURE NAME - SDTABLE                                 @OZ09557*/ 04281000
*/*                                                          @OZ09557*/ 04282000
*/* FUNCTION - THIS PROCEDURE IS CALLED TO PROCESS THE FIRST @OZ09557*/ 04283000
*/*            STAGE OR DESTAGE MINI IN EACH TRACE DETAIL    @OZ09557*/ 04284000
*/*            RECORD.  IF A TRACE HEADER HAS BEEN           @OZ09557*/ 04285000
*/*            PROCESSED, THE MSC TIME IN THE DETAIL RECORD  @OZ09557*/ 04286000
*/*            IS CONVERTED TO SECONDS FROM HUNDREDTHS OF A  @OZ09557*/ 04287000
*/*            SECOND, AND COMPARED TO THE MSC TIME IN THE   @OZ09557*/ 04288000
*/*            LAST HEADER RECORD.                           @OZ09557*/ 04289000
*/********************************************************** @OZ09557*/ 04290000
*                                                                  1269 04291000
*SDTABLE:                                                          1269 04292000
*   PROC OPTIONS(SAVE);                                            1269 04293000
SDTABLE  STM   @14,@12,12(@13)                                     1269 04294000
*   CKTIME=CKTIME&&CKTIME;          /* CLEAR DATES AND TIME  @Y30LB40*/ 04295000
         XC    CKTIME(7),CKTIME                                    1270 04296000
*   IF M>0                          /* WAS A HEADER STORED   @Y30LB40*/ 04297000
*     THEN                                                         1271 04298000
         LH    @15,M                                               1271 04299000
         LTR   @15,@15                                             1271 04300000
         BNP   @RF01271                                            1271 04301000
*     DO;                           /* CONVERT DATE AND TIME @Y30LB40*/ 04302000
*       RCDTME=T1TIME;              /* SAVE TIME             @Y30LB40*/ 04303000
         L     @01,PTR2                                            1273 04304000
         L     @15,T1TIME(,@01)                                    1273 04305000
         ST    @15,RCDTME                                          1273 04306000
*       SRL(RCDTME,8);              /* TO QUARTER SECONDS    @Y30LB40*/ 04307000
         SRL   @15,8                                               1274 04308000
         ST    @15,RCDTME                                          1274 04309000
*       RCDTME=RCDTME/4;            /* REDUCE TO SECONDS     @Y30LB40*/ 04310000
*                                                                  1275 04311000
         L     @00,RCDTME                                          1275 04312000
         SRDA  @00,32                                              1275 04313000
         D     @00,@CF00104                                        1275 04314000
         ST    @01,RCDTME                                          1275 04315000
*       /*************************************************************/ 04316000
*       /*                                                           */ 04317000
*       /* ************************************************* @OZ09557*/ 04318000
*       /* IF THE MSC TIME IN THE DETAIL RECORD IS GREATER   @OZ09557*/ 04319000
*       /* THAN THE MSC TIME IN THE HEADER RECORD, THEN      @OZ09557*/ 04320000
*       /* CALCULATE THE EQUIVALENT JULIAN DATE AND TIME FOR @OZ09557*/ 04321000
*       /* THIS RECORD FROM THE RELATIVE HOST DATE AND TIME  @OZ09557*/ 04322000
*       /* IN THE HEADER RECORD.                             @OZ09557*/ 04323000
*       /* ************************************************* @OZ09557*/ 04324000
*       /*                                                           */ 04325000
*       /*************************************************************/ 04326000
*                                                                  1276 04327000
*       IF RCDTME>HDRTME            /* RCD TIME LATER THAN HDR TIME     04328000
*                                                            @OZ09557*/ 04329000
*         THEN                                                     1276 04330000
         L     @15,HDRTME                                          1276 04331000
         CR    @01,@15                                             1276 04332000
         BNH   @RF01276                                            1276 04333000
*         DO;                       /* YES                   @Y30LB40*/ 04334000
*           SVETME=HOSTTME+(RCDTME-HDRTME);/* CALC TOD       @OZ09557*/ 04335000
         SLR   @01,@15                                             1278 04336000
         AL    @01,HOSTTME                                         1278 04337000
         ST    @01,SVETME                                          1278 04338000
*           SVEYEAR=HOSTYEAR;       /* SET YEAR              @OZ09557*/ 04339000
         LH    @15,HOSTYEAR                                        1279 04340000
         STC   @15,SVEYEAR                                         1279 04341000
*           SVEJUL=HOSTJUL;         /* SET JULIAN DAY        @OZ09557*/ 04342000
         LH    @15,HOSTJUL                                         1280 04343000
         STH   @15,SVEJUL                                          1280 04344000
*           DO WHILE(SVETME>86399); /* A FULL DAY OR MORE    @Y30LB40*/ 04345000
         B     @DE01281                                            1281 04346000
@DL01281 DS    0H                                                  1282 04347000
*             SVEJUL=SVEJUL+1;      /* BUMP DAY              @Y30LB40*/ 04348000
         LA    @15,1                                               1282 04349000
         AH    @15,SVEJUL                                          1282 04350000
         STH   @15,SVEJUL                                          1282 04351000
*             SVETME=SVETME-86400;  /* DECREMENT BY 1 DAY    @Y30LB40*/ 04352000
         L     @14,SVETME                                          1283 04353000
         SL    @14,@CF01088                                        1283 04354000
         ST    @14,SVETME                                          1283 04355000
*             IF SVEJUL>365         /* ADJUST YEAR AND DATE  @Y30LB40*/ 04356000
*               THEN                                               1284 04357000
         C     @15,@CF01095                                        1284 04358000
         BNH   @RF01284                                            1284 04359000
*               DO;                 /* CHECK FOR LEAP YEAR   @Y30LB40*/ 04360000
*                 IF(CKTIME(1:1)&'00000011'B)='00000000'B THEN     1286 04361000
         MVC   @TS00001(1),CKTIME                                  1286 04362000
         NI    @TS00001,B'00000011'                                1286 04363000
         CLI   @TS00001,B'00000000'                                1286 04364000
         BNE   @RF01286                                            1286 04365000
*                   IF SVEJUL=366   /* LEARYR,IS DAY 366     @Y30LB40*/ 04366000
*                     THEN                                         1287 04367000
         C     @15,@CF01110                                        1287 04368000
         BE    @RT01287                                            1287 04369000
*                     ;             /* YES,LEAVE YEAR ALONE          */ 04370000
*                   ELSE                                           1289 04371000
*                     DO;           /* NO                    @Y30LB40*/ 04372000
*                       SVEYEAR=SVEYEAR+1;/* BUMP YEAR       @Y30LB40*/ 04373000
         LA    @15,1                                               1290 04374000
         SLR   @14,@14                                             1290 04375000
         IC    @14,SVEYEAR                                         1290 04376000
         ALR   @14,@15                                             1290 04377000
         STC   @14,SVEYEAR                                         1290 04378000
*                       SVEJUL=1;   /* RESET DAY             @Y30LB40*/ 04379000
         STH   @15,SVEJUL                                          1291 04380000
*                     END;          /*                       @Y30LB40*/ 04381000
*                 ELSE                                             1293 04382000
*                   DO;             /* NOT LEAP YEAR         @Y30LB40*/ 04383000
         B     @RC01286                                            1293 04384000
@RF01286 DS    0H                                                  1294 04385000
*                     SVEYEAR=SVEYEAR+1;/* BUMP YEAR         @Y30LB40*/ 04386000
         LA    @15,1                                               1294 04387000
         SLR   @14,@14                                             1294 04388000
         IC    @14,SVEYEAR                                         1294 04389000
         ALR   @14,@15                                             1294 04390000
         STC   @14,SVEYEAR                                         1294 04391000
*                     SVEJUL=1;     /* RESET DAY             @Y30LB40*/ 04392000
         STH   @15,SVEJUL                                          1295 04393000
*                   END;            /*                       @Y30LB40*/ 04394000
*               END;                /*                       @Y30LB40*/ 04395000
@RC01286 DS    0H                                                  1298 04396000
*           END;                    /*                       @Y30LB40*/ 04397000
@RF01284 DS    0H                                                  1298 04398000
@DE01281 L     @15,SVETME                                          1298 04399000
         C     @15,@CF01096                                        1298 04400000
         BH    @DL01281                                            1298 04401000
*         END;                      /*                       @Y30LB40*/ 04402000
*                                                                  1299 04403000
*       /*************************************************************/ 04404000
*       /*                                                           */ 04405000
*       /* ************************************************* @OZ09557*/ 04406000
*       /* IF THE MSC TIME IN THE DETAIL RECORD IS LESS THAN @OZ09557*/ 04407000
*       /* THE MSC TIME IN THE HEADER RECORD, EITHER THE     @OZ09557*/ 04408000
*       /* DETAIL RECORD WAS PROCESSED BEFORE THE HEADER     @OZ09557*/ 04409000
*       /* RECORD (UNLIKELY), OR THE MSC CLOCK HAS ROLLED    @OZ09557*/ 04410000
*       /* OVER. THIS ROUTINE IGNORES THE POSSIBILITY OF     @OZ09557*/ 04411000
*       /* CLOCK ROLL-OVER, AND ATTEMPTS TO PROCESS RESIDUAL @OZ09557*/ 04412000
*       /* DATA LEFT FROM A DUMP MAXIMUM.                    @OZ09557*/ 04413000
*       /* ************************************************* @OZ09557*/ 04414000
*       /*                                                           */ 04415000
*       /*************************************************************/ 04416000
*                                                                  1300 04417000
*       ELSE                                                       1300 04418000
*         DO;                       /*                       @OZ09557*/ 04419000
         B     @RC01276                                            1300 04420000
@RF01276 DS    0H                                                  1301 04421000
*           SVETME=HOSTTME-(HDRTME-RCDTME);/* CALC TOD       @OZ09557*/ 04422000
         L     @15,RCDTME                                          1301 04423000
         SL    @15,HDRTME                                          1301 04424000
         AL    @15,HOSTTME                                         1301 04425000
         ST    @15,SVETME                                          1301 04426000
*           SVEYEAR=HOSTYEAR;       /* SET YEAR              @OZ09557*/ 04427000
         LH    @15,HOSTYEAR                                        1302 04428000
         STC   @15,SVEYEAR                                         1302 04429000
*           SVEJUL=HOSTJUL;         /* SET JULIAN DAY        @OZ09557*/ 04430000
         LH    @15,HOSTJUL                                         1303 04431000
         STH   @15,SVEJUL                                          1303 04432000
*           DO WHILE(SVETME<0);     /* A FULL DAY OR MORE    @Y30LB40*/ 04433000
         B     @DE01304                                            1304 04434000
@DL01304 DS    0H                                                  1305 04435000
*             SVEJUL=SVEJUL-1;      /* DECREMENT DAY         @Y30LB40*/ 04436000
         LH    @15,SVEJUL                                          1305 04437000
         BCTR  @15,0                                               1305 04438000
         STH   @15,SVEJUL                                          1305 04439000
*             SVETME=SVETME+86400;  /* BUMP BY 1 DAY         @Y30LB40*/ 04440000
         L     @14,@CF01088                                        1306 04441000
         AL    @14,SVETME                                          1306 04442000
         ST    @14,SVETME                                          1306 04443000
*             IF SVEJUL<1           /* ADJUST YEAR AND DATE  @Y30LB40*/ 04444000
*               THEN                                               1307 04445000
         LTR   @15,@15                                             1307 04446000
         BP    @RF01307                                            1307 04447000
*               DO;                 /* CHECK FOR LEAP YEAR   @Y30LB40*/ 04448000
*                 SVEYEAR=SVEYEAR-1;/* DECREMENT YEAR        @Y30LB40*/ 04449000
         SLR   @15,@15                                             1309 04450000
         IC    @15,SVEYEAR                                         1309 04451000
         BCTR  @15,0                                               1309 04452000
         STC   @15,SVEYEAR                                         1309 04453000
*                 IF(CKTIME(1:1)&'00000011'B)='00000000'B THEN     1310 04454000
         MVC   @TS00001(1),CKTIME                                  1310 04455000
         NI    @TS00001,B'00000011'                                1310 04456000
         CLI   @TS00001,B'00000000'                                1310 04457000
         BNE   @RF01310                                            1310 04458000
*                   SVEJUL=366;     /* LEAP YEAR             @Y30LB40*/ 04459000
         MVC   SVEJUL(2),@CH01110                                  1311 04460000
*                 ELSE                                             1312 04461000
*                   SVEJUL=365;     /* NOT LEAP YEAR         @Y30LB40*/ 04462000
         B     @RC01310                                            1312 04463000
@RF01310 MVC   SVEJUL(2),@CH01095                                  1312 04464000
*               END;                /*                       @Y30LB40*/ 04465000
@RC01310 DS    0H                                                  1314 04466000
*           END;                    /*                       @Y30LB40*/ 04467000
@RF01307 DS    0H                                                  1314 04468000
@DE01304 L     @15,SVETME                                          1314 04469000
         LTR   @15,@15                                             1314 04470000
         BM    @DL01304                                            1314 04471000
*         END;                      /*                       @Y30LB40*/ 04472000
*       N=(RCDTME/86400);           /* CHECK DAY LATER       @OZ09557*/ 04473000
@RC01276 L     @00,RCDTME                                          1316 04474000
         SRDA  @00,32                                              1316 04475000
         D     @00,@CF01088                                        1316 04476000
         STH   @01,N                                               1316 04477000
*       P=M+N;                      /* MAYBE NEW BUCKET      @OZ09557*/ 04478000
         AH    @01,M                                               1317 04479000
         LR    P,@01                                               1317 04480000
*       IF P>750                    /* CHECK BUCKET CTR      @OZ09557*/ 04481000
*         THEN                      /*                       @OZ09557*/ 04482000
         LA    @03,750                                             1318 04483000
         CR    P,@03                                               1318 04484000
         BNH   @RF01318                                            1318 04485000
*         P=750;                    /* MAXIMUM BUCKETS       @OZ09557*/ 04486000
         LR    P,@03                                               1319 04487000
*       DATECNT(P)=DATECNT(P)+1;    /* COUNT FOR DAY         @OZ09557*/ 04488000
@RF01318 LR    @03,P                                               1320 04489000
         SLA   @03,4                                               1320 04490000
         LA    @15,1                                               1320 04491000
         AL    @15,DATECNT-16(@03)                                 1320 04492000
         ST    @15,DATECNT-16(@03)                                 1320 04493000
*       STOREYR(P)=SVEYEAR;         /* SAVE JULIAN YEAR      @OZ09557*/ 04494000
         SLR   @15,@15                                             1321 04495000
         IC    @15,SVEYEAR                                         1321 04496000
         STH   @15,STOREYR-16(@03)                                 1321 04497000
*       STOREJUL(P)=SVEJUL;         /* SAVE JULIAN DAY       @OZ09557*/ 04498000
*                                                                  1322 04499000
         LH    @15,SVEJUL                                          1322 04500000
         STH   @15,STOREJUL-16(@03)                                1322 04501000
*       /*************************************************************/ 04502000
*       /*                                                           */ 04503000
*       /* ************************************************* @OZ09557*/ 04504000
*       /* THE VALUES SAVED FOR MSC TIME AND CONVERTED TIME  @OZ09557*/ 04505000
*       /* ARE THE ENDING TIMES FOR THE TRACE PERIOD. (THE   @OZ09557*/ 04506000
*       /* TRACE HEADERS CONTAIN THE STARTING TIMES OF THE   @OZ09557*/ 04507000
*       /* TRACE PERIODS.                                    @OZ09557*/ 04508000
*       /* ************************************************* @OZ09557*/ 04509000
*       /*                                                           */ 04510000
*       /*************************************************************/ 04511000
*                                                                  1323 04512000
*       IF RCDTME>STOREDSM(P)       /*                       @OZ09557*/ 04513000
*         THEN                                                     1323 04514000
         L     @15,RCDTME                                          1323 04515000
         C     @15,STOREDSM-16(@03)                                1323 04516000
         BNH   @RF01323                                            1323 04517000
*         DO;                       /*                       @Y30LB40*/ 04518000
*           STORETIM(P)=SVETME;     /*                       @OZ09557*/ 04519000
         L     @14,SVETME                                          1325 04520000
         ST    @14,STORETIM-16(@03)                                1325 04521000
*           STOREDSM(P)=RCDTME;     /*                       @OZ09557*/ 04522000
         ST    @15,STOREDSM-16(@03)                                1326 04523000
*         END;                      /*                       @Y30LB40*/ 04524000
*     END;                          /*                       @Y30LB40*/ 04525000
*   END SDTABLE;                    /*                       @Y30LB40*/ 04526000
@EL00015 DS    0H                                                  1329 04527000
@EF00015 DS    0H                                                  1329 04528000
@ER00015 LM    @14,@12,12(@13)                                     1329 04529000
         BR    @14                                                 1329 04530000
*                                                                  1330 04531000
*/********************************************************************  04532000
*                                                                    */ 04533000
*/**ROUTINE TO CONVERT TIME TO HH MM SS*                     @Y30LB40*/ 04534000
*/********************************************************************  04535000
*                                                                    */ 04536000
*                                                                  1330 04537000
*CONVERTM:                                                         1330 04538000
*   PROC OPTIONS(SAVE);             /*                       @Y30LB40*/ 04539000
CONVERTM STM   @14,@12,12(@13)                                     1330 04540000
*   HOUR=(DAYS/3600);               /* CALCULATE HOUR OF THE DAY     */ 04541000
         L     @15,DAYS                                            1331 04542000
         LA    @14,3600                                            1331 04543000
         LR    @00,@15                                             1331 04544000
         SRDA  @00,32                                              1331 04545000
         DR    @00,@14                                             1331 04546000
         STH   @01,HOUR                                            1331 04547000
*   MINUTE=(DAYS-(HOUR*3600))/60;   /* CALCULATE MINUTES OF DAY      */ 04548000
         LA    @07,60                                              1332 04549000
         MR    @00,@14                                             1332 04550000
         LR    @02,@15                                             1332 04551000
         SLR   @02,@01                                             1332 04552000
         SRDA  @02,32                                              1332 04553000
         DR    @02,@07                                             1332 04554000
         STH   @03,MINUTE                                          1332 04555000
*   SECOND=DAYS-((HOUR*3600)+(MINUTE*60));/* CALC SECONDS            */ 04556000
         MR    @02,@07                                             1333 04557000
         ALR   @01,@03                                             1333 04558000
         SLR   @15,@01                                             1333 04559000
         STH   @15,SECOND                                          1333 04560000
*   END CONVERTM;                   /*                       @Y30LB40*/ 04561000
@EL00016 DS    0H                                                  1334 04562000
@EF00016 DS    0H                                                  1334 04563000
@ER00016 LM    @14,@12,12(@13)                                     1334 04564000
         BR    @14                                                 1334 04565000
*                                                                  1335 04566000
*/********************************************************************  04567000
*                                                                    */ 04568000
*/* ROUTINE TO PRINT NEW PAGE HEADINGS                       @Y30LB40*/ 04569000
*/********************************************************************  04570000
*                                                                    */ 04571000
*                                                                  1335 04572000
*NEWPAGE:                                                          1335 04573000
*   PROC OPTIONS(SAVE);             /*                       @Y30LB40*/ 04574000
NEWPAGE  STM   @14,@06,@SA00017                                    1335 04575000
         STM   @08,@12,@SA00017+36                                 1335 04576000
*   LINECNT=1;                      /* RESET LINE COUNT      @Y30LB40*/ 04577000
         LA    @15,1                                               1336 04578000
         LR    LINECNT,@15                                         1336 04579000
*   PAGECNT=PAGECNT+1;              /* UPDATE PAGE COUNT     @Y30LB40*/ 04580000
         AH    @15,PAGECNT                                         1337 04581000
         STH   @15,PAGECNT                                         1337 04582000
*   BLKLINE=HDNG1;                  /*                       @Y30LB40*/ 04583000
         MVC   BLKLINE(121),HDNG1                                  1338 04584000
*   CALL EDITFIX(ADDR(PAGECNT),2,'S');/*                     @Y30LB40*/ 04585000
         MVC   @AL00001+4(8),@AL01339                              1339 04586000
         LA    @06,PAGECNT                                         1339 04587000
         ST    @06,@AFTEMPS+16                                     1339 04588000
         LA    @06,@AFTEMPS+16                                     1339 04589000
         ST    @06,@AL00001                                        1339 04590000
         LA    @01,@AL00001                                        1339 04591000
         BAL   @14,EDITFIX                                         1339 04592000
*   BLKLINE(118:121)=FIXOUT(10:13); /*                       @Y30LB40*/ 04593000
         MVC   BLKLINE+117(4),FIXOUT+9                             1340 04594000
*   BLKLINE(107:111)=TODAY;         /*                       @Y30LB40*/ 04595000
         MVC   BLKLINE+106(5),TODAY                                1341 04596000
*   RFY                                                            1342 04597000
*    (R0,                                                          1342 04598000
*     R1,                                                          1342 04599000
*     R14,                                                         1342 04600000
*     R15) RSTD;                    /*                       @Y30LB40*/ 04601000
*   GEN(PUT   PRNTDCB,BLKLINE);     /*                       @Y30LB40*/ 04602000
         PUT   PRNTDCB,BLKLINE                                          04603000
*   RFY                                                            1344 04604000
*    (R0,                                                          1344 04605000
*     R1,                                                          1344 04606000
*     R14,                                                         1344 04607000
*     R15) UNRSTD;                  /*                       @Y30LB40*/ 04608000
*   END NEWPAGE;                    /*                       @Y30LB40*/ 04609000
@EL00017 DS    0H                                                  1345 04610000
@EF00017 DS    0H                                                  1345 04611000
@ER00017 LM    @14,@06,@SA00017                                    1345 04612000
         LM    @08,@12,@SA00017+36                                 1345 04613000
         BR    @14                                                 1345 04614000
*                                                                  1346 04615000
*/********************************************************************  04616000
*                                                                    */ 04617000
*/* ROUTINE TO CONVERT A BYTE TO PRINTABLE BIT STRING        @Y30LB40*/ 04618000
*/********************************************************************  04619000
*                                                                    */ 04620000
*                                                                  1346 04621000
*EDITBIT:                                                          1346 04622000
*   PROC(BITADDR) OPTIONS(SAVE);    /*                       @Y30LB40*/ 04623000
EDITBIT  STM   @14,@12,@SA00018                                    1346 04624000
         MVC   @PC00018(4),0(@01)                                  1346 04625000
*   DCL                                                            1347 04626000
*     BITADDR PTR(31);              /* ADDRESS OF BYTE TO BE       1347 04627000
*                                      CONVERTED             @Y30LB40*/ 04628000
*   DCL                                                            1348 04629000
*     EIGHT0 CHAR(8) STATIC INIT('00000000');/*              @Y30LB40*/ 04630000
*   RFY                                                            1349 04631000
*    (R2) RSTD;                     /*                       @Y30LB40*/ 04632000
*   R2=BITADDR;                     /*                       @Y30LB40*/ 04633000
         L     @15,@PC00018                                        1350 04634000
         L     R2,BITADDR(,@15)                                    1350 04635000
*   GEN;                                                           1351 04636000
*                                                         /*@Y30LB40*/  04637000
         MVC   BITOUT,EIGHT0                                            04638000
         TM    0(R2),X'80'                                              04639000
         BZ    EB1                                                      04640000
         MVI   BITOUT,C'1'                                              04641000
EB1      EQU   *                                                        04642000
         TM    0(R2),X'40'                                              04643000
         BZ    EB2                                                      04644000
         MVI   BITOUT+1,C'1'                                            04645000
EB2      EQU   *                                                        04646000
         TM    0(R2),X'20'                                              04647000
         BZ    EB3                                                      04648000
         MVI   BITOUT+2,C'1'                                            04649000
EB3      EQU   *                                                        04650000
         TM    0(R2),X'10'                                              04651000
         BZ    EB4                                                      04652000
         MVI   BITOUT+3,C'1'                                            04653000
EB4      EQU   *                                                        04654000
         TM    0(R2),X'08'                                              04655000
         BZ    EB5                                                      04656000
         MVI   BITOUT+4,C'1'                                            04657000
EB5      EQU   *                                                        04658000
         TM    0(R2),X'04'                                              04659000
         BZ    EB6                                                      04660000
         MVI   BITOUT+5,C'1'                                            04661000
EB6      EQU   *                                                        04662000
         TM    0(R2),X'02'                                              04663000
         BZ    EB7                                                      04664000
         MVI   BITOUT+6,C'1'                                            04665000
EB7      EQU   *                                                        04666000
         TM    0(R2),X'01'                                              04667000
         BZ    EB8                                                      04668000
         MVI   BITOUT+7,C'1'                                            04669000
EB8      EQU   *                                                        04670000
*   RFY                                                            1352 04671000
*    (R2) UNRSTD;                   /*                       @Y30LB40*/ 04672000
*   END EDITBIT;                    /*                       @Y30LB40*/ 04673000
@EL00018 DS    0H                                                  1353 04674000
@EF00018 DS    0H                                                  1353 04675000
@ER00018 LM    @14,@12,@SA00018                                    1353 04676000
         BR    @14                                                 1353 04677000
*                                                                  1354 04678000
*/********************************************************************  04679000
*                                                                    */ 04680000
*/* EDITFIX IS CALLED TO CONVERT BINARY FIELDS INTO CHARACTER FORM   */ 04681000
*/* FOR PRINTING. IT IS CALLED WITH THE FOLLOWING PARAMETERS -       */ 04682000
*/*   1. FIXADDR - THE ADDRESS OF THE FIELD TO BE CONVERTED  @Y30LB40*/ 04683000
*/*   2. FIXLEN - THE LENGTH OF THE FIELD TO BE CONVERTED - 1, 2, OR 4  04684000
*                                                                    */ 04685000
*/*   3. FIXOPT - THE TYPE OF EDITING OPTION DESIRED WHERE   @Y30LB40*/ 04686000
*/*               N = CONVERT TO CHARACTER, NO EDITING       @Y30LB40*/ 04687000
*/*               S = CONVERT TO CHARACTER AND ZERO SUPPRESS @Y30LB40*/ 04688000
*/*               E = CONVERT TO CHARACTER, INSERT COMMAS    @Y30LB40*/ 04689000
*/*                   TO DIVIDE HUNDREDS,THOUSANDS AND MILLIONS      */ 04690000
*/*                   AND ZERO AND COMMA SUPPRESS            @Y30LB40*/ 04691000
*/* OUTPUT IS PROVIDED IN A FIELD CALLED FIXOUT WHICH IS 13 BYTES    */ 04692000
*/* LONG.                                                    @Y30LB40*/ 04693000
*/********************************************************************  04694000
*                                                                    */ 04695000
*                                                                  1354 04696000
*EDITFIX:                                                          1354 04697000
*   PROC(FIXADDR,FIXLEN,FIXOPT) OPTIONS(SAVE);/*             @Y30LB40*/ 04698000
EDITFIX  STM   @14,@12,@SA00019                                    1354 04699000
         MVC   @PC00019(12),0(@01)                                 1354 04700000
*   DCL                                                            1355 04701000
*     FIXADDR PTR(31);              /* ADDRESS OF INPUT FIELD      1355 04702000
*                                                            @Y30LB40*/ 04703000
*   DCL                                                            1356 04704000
*     FIXLEN PTR(31);               /* LENGTH OF INPUT FIELD @Y30LB40*/ 04705000
*   DCL                                                            1357 04706000
*     FIXOPT CHAR(1);               /* EDITING OPTION DESIRED      1357 04707000
*                                                            @Y30LB40*/ 04708000
*   RFY                                                            1358 04709000
*    (R2,                                                          1358 04710000
*     R3) RSTD;                     /*                       @Y30LB40*/ 04711000
*   R2=FIXADDR;                     /*                       @Y30LB40*/ 04712000
         L     @15,@PC00019                                        1359 04713000
         L     R2,FIXADDR(,@15)                                    1359 04714000
*   DOUBLEWD=DOUBLEWD&&DOUBLEWD;    /*                       @Y30LB40*/ 04715000
         XC    DOUBLEWD(8),DOUBLEWD                                1360 04716000
*   IF FIXLEN=1                     /* IF LENGTH IS 1 PICKUP ONE BYTE   04717000
*                                                            @Y30LB40*/ 04718000
*     THEN                                                         1361 04719000
         L     @15,@PC00019+4                                      1361 04720000
         CLC   FIXLEN(4,@15),@CF00045                              1361 04721000
         BNE   @RF01361                                            1361 04722000
*     DO;                           /*                       @Y30LB40*/ 04723000
*       GEN(MVC   DOUBLEWD+3(1),0(R2));/*                    @Y30LB40*/ 04724000
         MVC   DOUBLEWD+3(1),0(R2)                                      04725000
*     END;                          /*                       @Y30LB40*/ 04726000
*   ELSE                                                           1365 04727000
*     IF FIXLEN=2                   /* IF LENGTH IS 2 PICKUP TWO   1365 04728000
*                                      BYTES                 @Y30LB40*/ 04729000
*       THEN                                                       1365 04730000
         B     @RC01361                                            1365 04731000
@RF01361 L     @15,@PC00019+4                                      1365 04732000
         CLC   FIXLEN(4,@15),@CF00052                              1365 04733000
         BNE   @RF01365                                            1365 04734000
*       DO;                         /*                       @Y30LB40*/ 04735000
*         GEN(MVC   DOUBLEWD+2(2),0(R2));/*                  @Y30LB40*/ 04736000
         MVC   DOUBLEWD+2(2),0(R2)                                      04737000
*       END;                        /*                       @Y30LB40*/ 04738000
*     ELSE                                                         1369 04739000
*       DO;                         /* PICKUP 4 BYTES        @Y30LB40*/ 04740000
         B     @RC01365                                            1369 04741000
@RF01365 DS    0H                                                  1370 04742000
*         GEN(MVC   DOUBLEWD(4),0(R2));/*                    @Y30LB40*/ 04743000
         MVC   DOUBLEWD(4),0(R2)                                        04744000
*       END;                        /*                       @Y30LB40*/ 04745000
*   GEN;                                                           1372 04746000
@RC01365 DS    0H                                                  1372 04747000
@RC01361 DS    0H                                                  1372 04748000
*                   /*CONVERT FROM BINARY TO CHARACTER      @Y30LB40*/  04749000
  L     R2,DOUBLEWD                                                     04750000
  CVD   R2,DOUBLEWD                                                     04751000
  OI    DOUBLEWD+7,X'0F'                                                04752000
  UNPK  FIXOUT(13),DOUBLEWD+2(6)                                        04753000
*   IF FIXOPT='N' THEN                                             1373 04754000
         L     @15,@PC00019+8                                      1373 04755000
         CLI   FIXOPT(@15),C'N'                                    1373 04756000
         BE    @RT01373                                            1373 04757000
*     GO TO EFEND;                  /* NO EDITING WANTED,GET OUT     */ 04758000
*   IF FIXOPT='S' THEN                                             1375 04759000
         CLI   FIXOPT(@15),C'S'                                    1375 04760000
         BE    @RT01375                                            1375 04761000
*     GO TO EF4;                    /* NO COMMAS WANTED,SKIP       1376 04762000
*                                      INSERTION                     */ 04763000
*   GEN;                                                           1377 04764000
*             /*INSERT COMMA DIVIDERS                       @Y30LB40*/  04765000
  MVC   FIXOUT(1),FIXOUT+3                                              04766000
  MVI   FIXOUT+1,C','                                                   04767000
  MVC   FIXOUT+2(3),FIXOUT+4                                            04768000
  MVI   FIXOUT+5,C','                                                   04769000
  MVC   FIXOUT+6(3),FIXOUT+7                                            04770000
  MVI   FIXOUT+9,C','                                                   04771000
*EF4:                               /* ZERO AND COMMA SUPPRESS     1378 04772000
*                                                            @Y30LB40*/ 04773000
*   GEN;                                                           1378 04774000
EF4      DS    0H                                                  1378 04775000
*                                                         /*@Y30LB40*/  04776000
         LA    R2,FIXOUT                                                04777000
         LA    R3,12                                                    04778000
EF5      EQU   *                                                        04779000
         CLI   0(R2),C','                                               04780000
         BE    EF6                                                      04781000
         CLI   0(R2),C'0'                                               04782000
         BNE   EFEND                                                    04783000
EF6      EQU   *                                                        04784000
         MVI   0(R2),C' '                                               04785000
         LA    R2,1(R2)                                                 04786000
         BCT   R3,EF5                                                   04787000
*EFEND:                                                            1379 04788000
*   RFY                                                            1379 04789000
*    (R2,                                                          1379 04790000
*     R3) UNRSTD;                   /*                       @Y30LB40*/ 04791000
*   END EDITFIX;                    /*                       @Y30LB40*/ 04792000
@EL00019 DS    0H                                                  1380 04793000
@EF00019 DS    0H                                                  1380 04794000
@ER00019 LM    @14,@12,@SA00019                                    1380 04795000
         BR    @14                                                 1380 04796000
*                                                                  1381 04797000
*/********************************************************************  04798000
*                                                                    */ 04799000
*/* ROUTINE TO CONVERT BYTES TO PRINTABLE HEXADECIMAL        @Y30LB40*/ 04800000
*/********************************************************************  04801000
*                                                                    */ 04802000
*                                                                  1381 04803000
*EDITHEX:                                                          1381 04804000
*   PROC(HEXADDR,HEXLEN) OPTIONS(SAVE);/*                    @Y30LB40*/ 04805000
EDITHEX  STM   @14,@12,@SA00020                                    1381 04806000
         MVC   @PC00020(8),0(@01)                                  1381 04807000
*   DCL                                                            1382 04808000
*     HEXADDR PTR(31);              /* ADDRESS OF BYTES TO BE      1382 04809000
*                                      CONVERTED             @Y30LB40*/ 04810000
*   DCL                                                            1383 04811000
*     HEXLEN PTR(31);               /* NUMBER OF BYTES TO BE       1383 04812000
*                                      CONVERTED             @Y30LB40*/ 04813000
*   DCL                                                            1384 04814000
*     NINE FIXED(15) STATIC INIT(9);/*                       @Y30LB40*/ 04815000
*   DCL                                                            1385 04816000
*     MASK FIXED(31) STATIC INIT('0000000F'X);/*             @Y30LB40*/ 04817000
*   RFY                                                            1386 04818000
*    (R2,                                                          1386 04819000
*     R3,                                                          1386 04820000
*     R4,                                                          1386 04821000
*     R5) RSTD;                     /*                       @Y30LB40*/ 04822000
*   R2=HEXADDR;                     /*                       @Y30LB40*/ 04823000
         L     @15,@PC00020                                        1387 04824000
         L     R2,HEXADDR(,@15)                                    1387 04825000
*   R3=HEXLEN;                      /*                       @Y30LB40*/ 04826000
         L     @15,@PC00020+4                                      1388 04827000
         L     R3,HEXLEN(,@15)                                     1388 04828000
*   R4=0;                           /*                       @Y30LB40*/ 04829000
         SLR   R4,R4                                               1389 04830000
*   R5=ADDR(HEXOUT);                /*                       @Y30LB40*/ 04831000
         LA    R5,HEXOUT                                           1390 04832000
*   GEN;                                                           1391 04833000
*                                                         /*@Y30LB40*/  04834000
EH0      EQU   *                                                        04835000
         IC    R4,0(R2)                                                 04836000
         SRA   R4,4                                                     04837000
         STC   R4,0(R5)                                                 04838000
         CH    R4,NINE                                                  04839000
         BNH   EH1                                                      04840000
         SH    R4,NINE                                                  04841000
         STC   R4,0(R5)                                                 04842000
         OI    0(R5),X'C0'                                              04843000
         B     EH2                                                      04844000
EH1      EQU   *                                                        04845000
         OI    0(R5),X'F0'                                              04846000
EH2      EQU   *                                                        04847000
         LA    R5,1(R5)                                                 04848000
         IC    R4,0(R2)                                                 04849000
         N     R4,MASK                                                  04850000
         STC   R4,0(R5)                                                 04851000
         CH    R4,NINE                                                  04852000
         BNH   EH3                                                      04853000
         SH    R4,NINE                                                  04854000
         STC   R4,0(R5)                                                 04855000
         OI    0(R5),X'C0'                                              04856000
         B     EH4                                                      04857000
EH3      EQU   *                                                        04858000
         OI    0(R5),X'F0'                                              04859000
EH4      EQU   *                                                        04860000
         LA    R5,1(R5)                                                 04861000
         LA    R2,1(R2)                                                 04862000
         BCT   R3,EH0                                                   04863000
*   RFY                                                            1392 04864000
*    (R2,                                                          1392 04865000
*     R3,                                                          1392 04866000
*     R4,                                                          1392 04867000
*     R5) UNRSTD;                   /*                       @Y30LB40*/ 04868000
*   END EDITHEX;                    /*                       @Y30LB40*/ 04869000
@EL00020 DS    0H                                                  1393 04870000
@EF00020 DS    0H                                                  1393 04871000
@ER00020 LM    @14,@12,@SA00020                                    1393 04872000
         BR    @14                                                 1393 04873000
*                                                                  1394 04874000
*/********************************************************** @OZ05079*/ 04875000
*/*                                                          @OZ05079*/ 04876000
*/* PROCEDURE NAME - GENCONFG                                @OZ05079*/ 04877000
*/*                                                          @OZ05079*/ 04878000
*/* FUNCTION - THIS PROCEDURE EXTRACTS FROM THE TRACE        @OZ05079*/ 04879000
*/*            HEADER (COPY OF VERIFICATION RECORD 6) THE    @OZ05079*/ 04880000
*/*            NUMBER OF DATA RECORDING DEVICES THAT         @OZ05079*/ 04881000
*/*            ARE VALID FOR EACH MSF.  THIS INFORMATION     @OZ05079*/ 04882000
*/*            IS USED TO TRANSLATE THE LOGICAL DRD/DRD PATH @OZ05079*/ 04883000
*/*            INTO THE SSIDS FOR THE DATA RECORDING         @OZ05079*/ 04884000
*/*            CONTROLLER AND DATA RECORDING DEVICE.         @OZ05079*/ 04885000
*/*            THE ONLY MSF SIZE THAT REQUIRES SPECIAL       @OZ05079*/ 04886000
*/*            HANDLING IS A3/B3.                            @OZ05079*/ 04887000
*/*                                                          @OZ05079*/ 04888000
*/********************************************************** @OZ05079*/ 04889000
*                                                                  1394 04890000
*GENCONFG:                                                         1394 04891000
*   PROCEDURE;                      /*                       @OZ05079*/ 04892000
GENCONFG STM   @14,@12,12(@13)                                     1394 04893000
*   DO INDEX=1 TO MAXMSF;           /*                       @OZ05079*/ 04894000
         LA    INDEX,1                                             1395 04895000
@DL01395 DS    0H                                                  1396 04896000
*     MSFCONFG(INDEX)=NOSIZE;       /*                       @OZ05079*/ 04897000
         SLR   @03,@03                                             1396 04898000
         STC   @03,MSFCONFG-1(INDEX)                               1396 04899000
*     IF VRW(INDEX)=SIZEA3B3        /*                       @OZ05079*/ 04900000
*       THEN                        /*                       @OZ05079*/ 04901000
         LA    @03,VRW-1(INDEX)                                    1397 04902000
         CLI   0(@03),B'11111100'                                  1397 04903000
         BNE   @RF01397                                            1397 04904000
*       MSFCONFG(INDEX)=MSFA3B3;    /*                       @OZ05079*/ 04905000
         LA    @03,3                                               1398 04906000
         STC   @03,MSFCONFG-1(INDEX)                               1398 04907000
*   END;                            /*                       @OZ05079*/ 04908000
@RF01397 AL    INDEX,@CF00045                                      1399 04909000
         C     INDEX,@CF00104                                      1399 04910000
         BNH   @DL01395                                            1399 04911000
*   END GENCONFG;                   /*                       @OZ05079*/ 04912000
@EL00021 DS    0H                                                  1400 04913000
@EF00021 DS    0H                                                  1400 04914000
@ER00021 LM    @14,@12,12(@13)                                     1400 04915000
         BR    @14                                                 1400 04916000
*                                                                  1401 04917000
*/********************************************************** @OZ05079*/ 04918000
*/*                                                          @OZ05079*/ 04919000
*/* PROCEDURE NAME - TRDRCDRD                                @OZ05079*/ 04920000
*/*                                                          @OZ05079*/ 04921000
*/* FUNCTION - THIS PROCEDURE TRANSLATES CONTROLLER AND      @OZ05079*/ 04922000
*/*            AND LOGICAL DATA RECORDING DEVICE FOR THE     @OZ05079*/ 04923000
*/*            DRC INTO THE SSIDS FOR BOTH DRC AND DRD BASED @OZ05079*/ 04924000
*/*            ON THE CONFIGURATION OF THE MSF AS SPECIFIED  @OZ05079*/ 04925000
*/*            IN THE TRACE HEADER RECORD.                   @OZ05079*/ 04926000
*/*                                                          @OZ05079*/ 04927000
*/********************************************************** @OZ05079*/ 04928000
*                                                                  1401 04929000
*TRDRCDRD:                                                         1401 04930000
*   PROCEDURE;                      /*                       @OZ05079*/ 04931000
TRDRCDRD STM   @14,@12,12(@13)                                     1401 04932000
*   DRDINDEX=0;                     /*                       @OZ05079*/ 04933000
         SLR   DRDINDEX,DRDINDEX                                   1402 04934000
*   DRCINDEX=0;                     /*                       @OZ05079*/ 04935000
*                                                                  1403 04936000
         SLR   DRCINDEX,DRCINDEX                                   1403 04937000
*   /*****************************************************************/ 04938000
*   /*                                                               */ 04939000
*   /* ***********************************************       @OZ05079*/ 04940000
*   /* DETERMINE THE LOW-ORDER DIGIT OF THE SSID OF          @OZ05079*/ 04941000
*   /* THE DATA RECORDING CONTROLLER FROM THE FIFTH          @OZ05079*/ 04942000
*   /* AND SIXTH BITS OF 'DRD ADDRESS'.                      @OZ05079*/ 04943000
*   /* ***********************************************       @OZ05079*/ 04944000
*   /*                                                               */ 04945000
*   /*****************************************************************/ 04946000
*                                                                  1404 04947000
*   IF CONTRLR=ZEROZERO             /* DRC = 4X0             @OZ05079*/ 04948000
*     THEN                          /*                       @OZ05079*/ 04949000
         TM    CONTRLR,B'00001100'                                 1404 04950000
         BNZ   @RF01404                                            1404 04951000
*     DO;                           /*                       @OZ05079*/ 04952000
*       DRCPRINT='0';               /* PRINT LOW-ORDER       @OZ05079*/ 04953000
         MVI   DRCPRINT,C'0'                                       1406 04954000
*       DRCINDEX=1;                 /* TO DEVELOP DRD        @OZ05079*/ 04955000
         LA    DRCINDEX,1                                          1407 04956000
*     END;                          /*                       @OZ05079*/ 04957000
*   ELSE                                                           1409 04958000
*     ;                             /*                       @OZ05079*/ 04959000
@RF01404 DS    0H                                                  1410 04960000
*   IF CONTRLR=ZEROONE              /* DRC = 4X1             @OZ05079*/ 04961000
*     THEN                          /*                       @OZ05079*/ 04962000
         TM    CONTRLR,B'00000100'                                 1410 04963000
         BNO   @RF01410                                            1410 04964000
         TM    CONTRLR,B'00001000'                                 1410 04965000
         BNZ   @RF01410                                            1410 04966000
*     DO;                           /*                       @OZ05079*/ 04967000
*       DRCPRINT='1';               /* PRINT LOW-ORDER       @OZ05079*/ 04968000
         MVI   DRCPRINT,C'1'                                       1412 04969000
*       DRCINDEX=2;                 /* TO DEVELOP DRD        @OZ05079*/ 04970000
         LA    DRCINDEX,2                                          1413 04971000
*     END;                          /*                       @OZ05079*/ 04972000
*   ELSE                                                           1415 04973000
*     ;                             /*                       @OZ05079*/ 04974000
@RF01410 DS    0H                                                  1416 04975000
*   IF CONTRLR=ONEZERO              /* DRC = 4X2             @OZ05079*/ 04976000
*     THEN                          /*                       @OZ05079*/ 04977000
         TM    CONTRLR,B'00001000'                                 1416 04978000
         BNO   @RF01416                                            1416 04979000
         TM    CONTRLR,B'00000100'                                 1416 04980000
         BNZ   @RF01416                                            1416 04981000
*     DO;                           /*                       @OZ05079*/ 04982000
*       DRCPRINT='2';               /* PRINT LOW-ORDER       @OZ05079*/ 04983000
         MVI   DRCPRINT,C'2'                                       1418 04984000
*       DRCINDEX=3;                 /* TO DEVELOP DRD        @OZ05079*/ 04985000
         LA    DRCINDEX,3                                          1419 04986000
*     END;                          /*                       @OZ05079*/ 04987000
*   ELSE                                                           1421 04988000
*     ;                             /*                       @OZ05079*/ 04989000
@RF01416 DS    0H                                                  1422 04990000
*   IF CONTRLR=ONEONE               /* DRC = 4X3             @OZ05079*/ 04991000
*     THEN                          /*                       @OZ05079*/ 04992000
         TM    CONTRLR,B'00001100'                                 1422 04993000
         BNO   @RF01422                                            1422 04994000
*     DO;                           /*                       @OZ05079*/ 04995000
*       DRCPRINT='3';               /* PRINT LOW-ORDER       @OZ05079*/ 04996000
         MVI   DRCPRINT,C'3'                                       1424 04997000
*       DRCINDEX=4;                 /* TO DEVELOP DRD        @OZ05079*/ 04998000
         LA    DRCINDEX,4                                          1425 04999000
*     END;                          /*                       @OZ05079*/ 05000000
*   ELSE                                                           1427 05001000
*     ;                             /*                       @OZ05079*/ 05002000
*                                                                  1427 05003000
@RF01422 DS    0H                                                  1428 05004000
*   /*****************************************************************/ 05005000
*   /*                                                               */ 05006000
*   /* ***********************************************       @OZ05079*/ 05007000
*   /* DETERMINE THE INDEX VALUE FOR LOGICAL DRD BY          @OZ05079*/ 05008000
*   /* EXTRACTING THE TWO LOW-ORDER BITS FROM THE DRD        @OZ05079*/ 05009000
*   /* FIELD AND ADDING BINARY ONE.                          @OZ05079*/ 05010000
*   /* ***********************************************       @OZ05079*/ 05011000
*   /*                                                               */ 05012000
*   /*****************************************************************/ 05013000
*                                                                  1428 05014000
*   IF RWU=ZEROZERO                 /*                       @OZ05079*/ 05015000
*     THEN                          /*                       @OZ05079*/ 05016000
         TM    RWU,B'00000011'                                     1428 05017000
         BNZ   @RF01428                                            1428 05018000
*     DRDINDEX=1;                   /*                       @OZ05079*/ 05019000
         LA    DRDINDEX,1                                          1429 05020000
*   IF RWU=ZEROONE                  /*                       @OZ05079*/ 05021000
*     THEN                          /*                       @OZ05079*/ 05022000
@RF01428 TM    RWU,B'00000001'                                     1430 05023000
         BNO   @RF01430                                            1430 05024000
         TM    RWU,B'00000010'                                     1430 05025000
         BNZ   @RF01430                                            1430 05026000
*     DRDINDEX=2;                   /*                       @OZ05079*/ 05027000
         LA    DRDINDEX,2                                          1431 05028000
*   IF RWU=ONEZERO                  /*                       @OZ05079*/ 05029000
*     THEN                          /*                       @OZ05079*/ 05030000
@RF01430 TM    RWU,B'00000010'                                     1432 05031000
         BNO   @RF01432                                            1432 05032000
         TM    RWU,B'00000001'                                     1432 05033000
         BNZ   @RF01432                                            1432 05034000
*     DRDINDEX=3;                   /*                       @OZ05079*/ 05035000
         LA    DRDINDEX,3                                          1433 05036000
*   IF RWU=ONEONE                   /*                       @OZ05079*/ 05037000
*     THEN                          /*                       @OZ05079*/ 05038000
@RF01432 TM    RWU,B'00000011'                                     1434 05039000
         BNO   @RF01434                                            1434 05040000
*     DRDINDEX=4;                   /*                       @OZ05079*/ 05041000
*                                                                  1435 05042000
         LA    DRDINDEX,4                                          1435 05043000
*   /*****************************************************************/ 05044000
*   /*                                                               */ 05045000
*   /* ***********************************************       @OZ05079*/ 05046000
*   /* IF THIS MSF WAS DESCRIBED IN THE TRACE HEADER         @OZ05079*/ 05047000
*   /* RECORD AS AN A3/B3 MODEL, USE SPECIAL A3/B3           @OZ05079*/ 05048000
*   /* TRANSLATE ROUTINE. OTHERWISE, USE REGULAR             @OZ05079*/ 05049000
*   /* TRANSLATE ROUTINE.                                    @OZ05079*/ 05050000
*   /* ***********************************************       @OZ05079*/ 05051000
*   /*                                                               */ 05052000
*   /*****************************************************************/ 05053000
*                                                                  1436 05054000
*   IF MSFCONFG(LIBRID+1)=MSFA3B3   /*                       @OZ05079*/ 05055000
*     THEN                          /*                       @OZ05079*/ 05056000
@RF01434 SLR   @01,@01                                             1436 05057000
         IC    @01,LIBRID                                          1436 05058000
         SLR   @00,@00                                             1436 05059000
         IC    @00,MSFCONFG(@01)                                   1436 05060000
         C     @00,@CF00831                                        1436 05061000
         BNE   @RF01436                                            1436 05062000
*     DRDPRINT=SPECLKUP(DRCINDEX,DRDINDEX);/*                @OZ05079*/ 05063000
         LR    @15,DRCINDEX                                        1437 05064000
         SLA   @15,2                                               1437 05065000
         ALR   @15,DRDINDEX                                        1437 05066000
         LA    @14,SPECLKUP-5(@15)                                 1437 05067000
         MVC   DRDPRINT(1),0(@14)                                  1437 05068000
*   ELSE                            /*                       @OZ05079*/ 05069000
*     DRDPRINT=REGLOKUP(DRCINDEX,DRDINDEX);/*                @OZ05079*/ 05070000
         B     @RC01436                                            1438 05071000
@RF01436 LR    @15,DRCINDEX                                        1438 05072000
         SLA   @15,2                                               1438 05073000
         ALR   @15,DRDINDEX                                        1438 05074000
         LA    @14,REGLOKUP-5(@15)                                 1438 05075000
         MVC   DRDPRINT(1),0(@14)                                  1438 05076000
*   END TRDRCDRD;                   /*                       @OZ05079*/ 05077000
@EL00022 DS    0H                                                  1439 05078000
@EF00022 DS    0H                                                  1439 05079000
@ER00022 LM    @14,@12,12(@13)                                     1439 05080000
         BR    @14                                                 1439 05081000
*                                                                  1440 05082000
*/********************************************************** @OZ05124*/ 05083000
*/* SYNAD EXIT FOR TRACEIN, TAKEN FOR READ ERRORS.           @OZ05124*/ 05084000
*/********************************************************** @OZ05124*/ 05085000
*                                                                  1440 05086000
*READERR:                                                          1440 05087000
*   ;                               /*                       @OZ05124*/ 05088000
READERR  DS    0H                                                  1441 05089000
*   GEN(SYNADAF ACSMETH=QSAM);      /*                       @OZ05124*/ 05090000
         SYNADAF ACSMETH=QSAM                                           05091000
*   PRNTLINE=' ';                   /*                       @ZA17158*/ 05092000
         MVI   PRNTLINE+1,C' '                                     1442 05093000
         MVC   PRNTLINE+2(119),PRNTLINE+1                          1442 05094000
         MVI   PRNTLINE,C' '                                       1442 05095000
*   GEN(MVC   PRNTLINE+30(79),49(R1));/*                     @OZ05124*/ 05096000
         MVC   PRNTLINE+30(79),49(R1)                                   05097000
*   PRNTLINE(1:30)=ICGTR904;        /*                       @OZ05124*/ 05098000
         MVC   PRNTLINE(30),ICGTR904                               1444 05099000
*   INCNT1=INCNT1+1;                /*                       @ZA17158*/ 05100000
         LH    @07,INCNT1                                          1445 05101000
         LA    @07,1(,@07)                                         1445 05102000
         STH   @07,INCNT1                                          1445 05103000
*   SAVE14=R14;                     /*                       @OZ09522*/ 05104000
         LR    SAVE14,R14                                          1446 05105000
*   RFY                                                            1447 05106000
*    (R0,                                                          1447 05107000
*     R1,                                                          1447 05108000
*     R14,                                                         1447 05109000
*     R15) RSTD;                    /*                       @OZ05124*/ 05110000
*   GEN(PUT PRNTDCB,PRNTLINE);      /*                       @OZ05124*/ 05111000
         PUT PRNTDCB,PRNTLINE                                           05112000
*   RFY                                                            1449 05113000
*    (R0,                                                          1449 05114000
*     R1,                                                          1449 05115000
*     R14,                                                         1449 05116000
*     R15) UNRSTD;                  /*                       @OZ05124*/ 05117000
*   R14=SAVE14;                     /*                       @OZ09522*/ 05118000
         LR    R14,SAVE14                                          1450 05119000
*   GEN(SYNADRLS);                  /*                       @OZ05124*/ 05120000
         SYNADRLS                                                       05121000
*   RETURNCD=4;                     /*                       @OZ05124*/ 05122000
         MVC   RETURNCD(2),@CH00104                                1452 05123000
*   IF INCNT1=>100                  /*                       @ZA17158*/ 05124000
*     THEN                          /*                       @ZA17158*/ 05125000
         LH    @15,INCNT1                                          1453 05126000
         C     @15,@CF01050                                        1453 05127000
         BL    @RF01453                                            1453 05128000
*     DO;                           /*                       @ZA17158*/ 05129000
*       DCBPTR=ADDR(INDCB);         /*                       @ZA17158*/ 05130000
         LA    DCBPTR,INDCB                                        1455 05131000
*       DCBERACC=OFF;               /*                       @ZA17158*/ 05132000
*       DCBERSKP=OFF;               /*                       @ZA17158*/ 05133000
*       DCBERABE=ON;                /*                       @ZA17158*/ 05134000
         OI    DCBERABE+72(DCBPTR),B'00100000'                     1458 05135000
         NI    DCBERACC+72(DCBPTR),B'00111111'                     1458 05136000
*     END;                          /*                       @ZA17158*/ 05137000
*   GEN(BR    R14);                 /* RETURN TO IOS         @OZ05124*/ 05138000
@RF01453 DS    0H                                                  1460 05139000
         BR    R14                                                      05140000
*                                                                  1461 05141000
*/********************************************************** @OZ05124*/ 05142000
*/* SYNAD EXIT FOR TRACEOUT, TAKEN FOR WRITE ERRORS.         @OZ05124*/ 05143000
*/********************************************************** @OZ05124*/ 05144000
*                                                                  1461 05145000
*WRITEERR:                                                         1461 05146000
*   ;                               /*                       @OZ05124*/ 05147000
WRITEERR DS    0H                                                  1462 05148000
*   GEN(SYNADAF ACSMETH=QSAM);      /*                       @OZ05124*/ 05149000
         SYNADAF ACSMETH=QSAM                                           05150000
*   PRNTLINE=' ';                   /*                       @ZA17158*/ 05151000
         MVI   PRNTLINE+1,C' '                                     1463 05152000
         MVC   PRNTLINE+2(119),PRNTLINE+1                          1463 05153000
         MVI   PRNTLINE,C' '                                       1463 05154000
*   GEN(MVC   PRNTLINE+30(79),49(R1));/*                     @OZ05124*/ 05155000
         MVC   PRNTLINE+30(79),49(R1)                                   05156000
*   PRNTLINE(1:30)=ICGTR905;        /*                       @OZ05124*/ 05157000
         MVC   PRNTLINE(30),ICGTR905                               1465 05158000
*   SAVE14=R14;                     /*                       @OZ09522*/ 05159000
         LR    SAVE14,R14                                          1466 05160000
*   RFY                                                            1467 05161000
*    (R0,                                                          1467 05162000
*     R1,                                                          1467 05163000
*     R14,                                                         1467 05164000
*     R15) RSTD;                    /*                       @OZ05124*/ 05165000
*   GEN(PUT PRNTDCB,PRNTLINE);      /*                       @OZ05124*/ 05166000
         PUT PRNTDCB,PRNTLINE                                           05167000
*   RFY                                                            1469 05168000
*    (R0,                                                          1469 05169000
*     R1,                                                          1469 05170000
*     R14,                                                         1469 05171000
*     R15) UNRSTD;                  /*                       @OZ05124*/ 05172000
*   R14=SAVE14;                     /*                       @OZ09522*/ 05173000
         LR    R14,SAVE14                                          1470 05174000
*   GEN(SYNADRLS);                  /*                       @OZ05124*/ 05175000
         SYNADRLS                                                       05176000
*   RETURNCD=4;                     /*                       @OZ05124*/ 05177000
         MVC   RETURNCD(2),@CH00104                                1472 05178000
*   GEN(BR    R14);                 /* RETURN TO IOS         @OZ05124*/ 05179000
         BR    R14                                                      05180000
*                                                                  1474 05181000
*/********************************************************** @ZA13498*/ 05182000
*/*                                                          @ZA13498*/ 05183000
*/* PROCEDURE NAME - TIME2345                                @ZA13498*/ 05184000
*/*                                                          @ZA13498*/ 05185000
*/* FUNCTION - T2TIME, T3TIME, T4,TIME, OR T5TIME IS         @ZA13498*/ 05186000
*/*            PASSED AS 'HOLDTXTM'.  COMPARE HOLDTXTM TO    @ZA13498*/ 05187000
*/*            TO THE MIDDLE TWO BYTE OF T1TIME TO           @ZA13498*/ 05188000
*/*            DETERMINE WHETHER THE HOLDTXTM SHOULD BE      @ZA13498*/ 05189000
*/*            INCREMENTED BY 65,536 (10000 HEX).  EXTRACT   @ZA13498*/ 05190000
*/*            THE HIGH-ORDER BYTE OF T1TIME AND USE IT FOR  @ZA13498*/ 05191000
*/*            THE HIGH-ORDER BYTE OF HOLDTXTM.  CONVERT     @ZA13498*/ 05192000
*/*            HOLDTXTM FROM QUARTER-SECONDS TO SECONDS.     @ZA13498*/ 05193000
*/*            EXTRACT TIME PORTION OF DATE RELATIVE TO THE  @ZA13498*/ 05194000
*/*            TO THE JULIAN DATE IN THE TRACE HEADER.       @ZA13498*/ 05195000
*/*            CONVERT BINARY TIME TO HOURS/MINUTES/SECONDS. @ZA13498*/ 05196000
*/*                                                          @ZA13498*/ 05197000
*/********************************************************** @ZA13498*/ 05198000
*                                                                  1474 05199000
*TIME2345:                                                         1474 05200000
*   PROCEDURE;                      /*                       @ZA13498*/ 05201000
         B     @PB00023                                            1474 05202000
TIME2345 STM   @14,@12,@SA00023                                    1474 05203000
*   HOLDT1TM=T1TIME;                /*                       @ZA13498*/ 05204000
         L     @01,PTR2                                            1475 05205000
         L     HOLDT1TM,T1TIME(,@01)                               1475 05206000
*   SLL(HOLDT1TM,8);                /*                       @ZA13498*/ 05207000
         SLL   HOLDT1TM,8                                          1476 05208000
*   SRL(HOLDT1TM,16);               /*                       @ZA13498*/ 05209000
         SRL   HOLDT1TM,16                                         1477 05210000
*   IF HOLDT1TM>HOLDTXTM            /*                       @ZA13498*/ 05211000
*     THEN                          /*                       @ZA13498*/ 05212000
         CR    HOLDT1TM,HOLDTXTM                                   1478 05213000
         BNH   @RF01478                                            1478 05214000
*     HOLDTXTM=HOLDTXTM+ROLLOVER;   /*                       @ZA13498*/ 05215000
         AL    HOLDTXTM,ROLLOVER                                   1479 05216000
*   HOLDT1TM=T1TIME;                /*                       @ZA13498*/ 05217000
@RF01478 L     @01,PTR2                                            1480 05218000
         L     HOLDT1TM,T1TIME(,@01)                               1480 05219000
*   SRL(HOLDT1TM,24);               /*                       @ZA13498*/ 05220000
         SRL   HOLDT1TM,24                                         1481 05221000
*   SLL(HOLDT1TM,16);               /*                       @ZA13498*/ 05222000
         SLL   HOLDT1TM,16                                         1482 05223000
*   HOLDTXTM=HOLDTXTM+HOLDT1TM;     /*                       @ZA13498*/ 05224000
         ALR   HOLDTXTM,HOLDT1TM                                   1483 05225000
*   HOLDTXTM=HOLDTXTM/4;            /*                       @ZA13498*/ 05226000
         LR    @00,HOLDTXTM                                        1484 05227000
         SRDA  @00,32                                              1484 05228000
         D     @00,@CF00104                                        1484 05229000
         LR    HOLDTXTM,@01                                        1484 05230000
*   IF HOLDTXTM>HDRTME              /*                       @ZA13498*/ 05231000
*     THEN                          /*                       @ZA13498*/ 05232000
         L     @02,HDRTME                                          1485 05233000
         CR    HOLDTXTM,@02                                        1485 05234000
         BNH   @RF01485                                            1485 05235000
*     DO;                           /*                       @ZA13498*/ 05236000
*       SAVETIME=HOSTTME+(HOLDTXTM-HDRTME);/*                @ZA13498*/ 05237000
         L     @15,HDRTME                                          1487 05238000
         LCR   @15,@15                                             1487 05239000
         ALR   @15,HOLDTXTM                                        1487 05240000
         AL    @15,HOSTTME                                         1487 05241000
         LR    SAVETIME,@15                                        1487 05242000
*       DO WHILE(SAVETIME>86399);   /*                       @ZA13498*/ 05243000
         B     @DE01488                                            1488 05244000
@DL01488 DS    0H                                                  1489 05245000
*         SAVETIME=SAVETIME-86400;  /*                       @ZA13498*/ 05246000
         SL    SAVETIME,@CF01088                                   1489 05247000
*       END;                        /*                       @ZA13498*/ 05248000
@DE01488 C     SAVETIME,@CF01096                                   1490 05249000
         BH    @DL01488                                            1490 05250000
*     END;                          /*                       @ZA13498*/ 05251000
*   ELSE                            /*                       @ZA13498*/ 05252000
*     DO;                           /*                       @ZA13498*/ 05253000
         B     @RC01485                                            1492 05254000
@RF01485 DS    0H                                                  1493 05255000
*       SAVETIME=HOSTTME-(HDRTME-HOLDTXTM);/*                @ZA28189*/ 05256000
         LR    SAVETIME,HOLDTXTM                                   1493 05257000
         SL    SAVETIME,HDRTME                                     1493 05258000
         AL    SAVETIME,HOSTTME                                    1493 05259000
*       DO WHILE(SAVETIME<0);       /*                       @ZA13498*/ 05260000
         B     @DE01494                                            1494 05261000
@DL01494 DS    0H                                                  1495 05262000
*         SAVETIME=SAVETIME+86400;  /*                       @ZA13498*/ 05263000
         AL    SAVETIME,@CF01088                                   1495 05264000
*       END;                        /*                       @ZA13498*/ 05265000
@DE01494 LTR   SAVETIME,SAVETIME                                   1496 05266000
         BM    @DL01494                                            1496 05267000
*     END;                          /*                       @ZA13498*/ 05268000
*   DAYS=SAVETIME;                  /*                       @ZA13498*/ 05269000
@RC01485 ST    SAVETIME,DAYS                                       1498 05270000
*   CALL CONVERTM;                  /*                       @ZA13498*/ 05271000
         BAL   @14,CONVERTM                                        1499 05272000
*   END TIME2345;                   /*                       @ZA13498*/ 05273000
@EL00023 DS    0H                                                  1500 05274000
@EF00023 DS    0H                                                  1500 05275000
@ER00023 LM    @14,@12,@SA00023                                    1500 05276000
         BR    @14                                                 1500 05277000
*   END ICGTRINT                    /*                       @ZA13498*/ 05278000
*                                                                  1501 05279000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 05280000
*/*%INCLUDE SYSLIB  (IHADCBDF)                                       */ 05281000
*/*%INCLUDE SYSLIB  (IHADCB  )                                       */ 05282000
*                                                                  1501 05283000
*       ;                                                          1501 05284000
@EL00001 L     @13,4(,@13)                                         1501 05285000
@EF00001 L     @00,@SIZDATD                                        1501 05286000
         LR    @01,@08                                             1501 05287000
         FREEMAIN R,LV=(0),A=(1)                                        05288000
@ER00001 LM    @14,@12,12(@13)                                     1501 05289000
         BR    @14                                                 1501 05290000
@DATA    DS    0H                                                       05291000
@CH00339 DC    H'60'                                                    05292000
@CH01112 DC    H'3600'                                                  05293000
@SC01278 CLC   HOLDVOL(0),VOLID                                         05294000
@SM01280 MVC   SELECTID(0),HOLDVOL                                      05295000
@SM01283 MVC   PARMHOLD(0),PARMS(PARMPTR)                               05296000
         DS    0F                                                       05297000
@AL00224 EQU   *                       LIST WITH   2 ARGUMENT(S)        05298000
@AL00228 EQU   *                       LIST WITH   2 ARGUMENT(S)        05299000
@AL00579 EQU   *                       LIST WITH   2 ARGUMENT(S)        05300000
@AL00582 EQU   *                       LIST WITH   2 ARGUMENT(S)        05301000
@AL00650 EQU   *                       LIST WITH   2 ARGUMENT(S)        05302000
@AL00655 EQU   *                       LIST WITH   2 ARGUMENT(S)        05303000
@AL00732 EQU   *                       LIST WITH   2 ARGUMENT(S)        05304000
@AL01069 EQU   *                       LIST WITH   2 ARGUMENT(S)        05305000
@AL01124 DC    A(@CF00045)             LIST WITH   2 ARGUMENT(S)        05306000
         DC    A(@CC01083)                                              05307000
@AL00226 EQU   *                       LIST WITH   2 ARGUMENT(S)        05308000
@AL00230 EQU   *                       LIST WITH   2 ARGUMENT(S)        05309000
@AL00234 EQU   *                       LIST WITH   2 ARGUMENT(S)        05310000
@AL00236 EQU   *                       LIST WITH   2 ARGUMENT(S)        05311000
@AL00240 EQU   *                       LIST WITH   2 ARGUMENT(S)        05312000
@AL00242 EQU   *                       LIST WITH   2 ARGUMENT(S)        05313000
@AL00267 EQU   *                       LIST WITH   2 ARGUMENT(S)        05314000
@AL00269 EQU   *                       LIST WITH   2 ARGUMENT(S)        05315000
@AL00273 EQU   *                       LIST WITH   2 ARGUMENT(S)        05316000
@AL00275 EQU   *                       LIST WITH   2 ARGUMENT(S)        05317000
@AL00277 EQU   *                       LIST WITH   2 ARGUMENT(S)        05318000
@AL00284 EQU   *                       LIST WITH   2 ARGUMENT(S)        05319000
@AL00286 EQU   *                       LIST WITH   2 ARGUMENT(S)        05320000
@AL00288 EQU   *                       LIST WITH   2 ARGUMENT(S)        05321000
@AL01035 EQU   *                       LIST WITH   2 ARGUMENT(S)        05322000
@AL01038 EQU   *                       LIST WITH   2 ARGUMENT(S)        05323000
@AL01045 EQU   *                       LIST WITH   2 ARGUMENT(S)        05324000
@AL01048 EQU   *                       LIST WITH   2 ARGUMENT(S)        05325000
@AL01126 EQU   *                       LIST WITH   2 ARGUMENT(S)        05326000
@AL01132 EQU   *                       LIST WITH   2 ARGUMENT(S)        05327000
@AL01134 EQU   *                       LIST WITH   2 ARGUMENT(S)        05328000
@AL01150 EQU   *                       LIST WITH   2 ARGUMENT(S)        05329000
@AL01152 EQU   *                       LIST WITH   2 ARGUMENT(S)        05330000
@AL01187 EQU   *                       LIST WITH   2 ARGUMENT(S)        05331000
@AL01190 EQU   *                       LIST WITH   2 ARGUMENT(S)        05332000
@AL01197 EQU   *                       LIST WITH   2 ARGUMENT(S)        05333000
@AL01200 DC    A(@CF00052)             LIST WITH   2 ARGUMENT(S)        05334000
         DC    A(@CC01083)                                              05335000
@AL00244 EQU   *                       LIST WITH   2 ARGUMENT(S)        05336000
@AL00246 EQU   *                       LIST WITH   2 ARGUMENT(S)        05337000
@AL00265 EQU   *                       LIST WITH   2 ARGUMENT(S)        05338000
@AL00280 EQU   *                       LIST WITH   2 ARGUMENT(S)        05339000
@AL00558 EQU   *                       LIST WITH   2 ARGUMENT(S)        05340000
@AL00560 EQU   *                       LIST WITH   2 ARGUMENT(S)        05341000
@AL01174 DC    A(@CF00104)             LIST WITH   2 ARGUMENT(S)        05342000
         DC    A(@CC01085)                                              05343000
@AL01032 EQU   *                       LIST WITH   2 ARGUMENT(S)        05344000
@AL01042 EQU   *                       LIST WITH   2 ARGUMENT(S)        05345000
@AL01130 EQU   *                       LIST WITH   2 ARGUMENT(S)        05346000
@AL01148 EQU   *                       LIST WITH   2 ARGUMENT(S)        05347000
@AL01184 EQU   *                       LIST WITH   2 ARGUMENT(S)        05348000
@AL01194 EQU   *                       LIST WITH   2 ARGUMENT(S)        05349000
@AL01339 DC    A(@CF00052)             LIST WITH   2 ARGUMENT(S)        05350000
         DC    A(@CC01085)                                              05351000
@AL01085 EQU   *                       LIST WITH   2 ARGUMENT(S)        05352000
@AL01087 EQU   *                       LIST WITH   2 ARGUMENT(S)        05353000
@AL01212 EQU   *                       LIST WITH   2 ARGUMENT(S)        05354000
@AL01257 EQU   *                       LIST WITH   2 ARGUMENT(S)        05355000
@AL01259 DC    A(@CF00045)             LIST WITH   2 ARGUMENT(S)        05356000
         DC    A(@CC01085)                                              05357000
@AL01179 DC    A(@CF00104)             LIST WITH   2 ARGUMENT(S)        05358000
         DC    A(@CC01083)                                              05359000
@DATD    DSECT                                                          05360000
         DS    0F                                                       05361000
@SA00001 DS    18F                                                      05362000
@SA00003 DS    15F                                                      05363000
@SA00004 DS    15F                                                      05364000
@SA00006 DS    15F                                                      05365000
@SA00013 DS    14F                                                      05366000
@SA00007 DS    14F                                                      05367000
@SA00009 DS    15F                                                      05368000
@SA00017 DS    14F                                                      05369000
@SA00019 DS    15F                                                      05370000
@PC00019 DS    3F                                                       05371000
@SA00008 DS    13F                                                      05372000
@SA00020 DS    15F                                                      05373000
@PC00020 DS    2F                                                       05374000
@SA00010 DS    15F                                                      05375000
@SA00012 DS    14F                                                      05376000
@SA00018 DS    15F                                                      05377000
@PC00018 DS    1F                                                       05378000
@SA00023 DS    15F                                                      05379000
@SA00014 DS    14F                                                      05380000
@AL00001 DS    3A                                                       05381000
@TF00001 DS    F                                                        05382000
@AFTEMPS DS    6F                                                       05383000
ICGTRINT CSECT                                                          05384000
         DS    0F                                                       05385000
@CF00045 DC    F'1'                                                     05386000
@CF00052 DC    F'2'                                                     05387000
@CF00117 DC    F'3'                                                     05388000
@CF00104 DC    F'4'                                                     05389000
@CH00104 EQU   @CF00104+2                                               05390000
@CF00376 DC    F'5'                                                     05391000
@CF00344 DC    F'6'                                                     05392000
@CF00036 DC    F'8'                                                     05393000
@CH00036 EQU   @CF00036+2                                               05394000
@CF00035 DC    F'9'                                                     05395000
@CF00033 DC    F'11'                                                    05396000
@CF01111 DC    F'23'                                                    05397000
@CF00869 DC    F'28'                                                    05398000
@CF00447 DC    F'30'                                                    05399000
@CF00484 DC    F'51'                                                    05400000
@CF00040 DC    F'52'                                                    05401000
@CF01089 DC    F'55'                                                    05402000
@CF01113 DC    F'59'                                                    05403000
@CF01050 DC    F'100'                                                   05404000
@CF00528 DC    F'121'                                                   05405000
@CF01095 DC    F'365'                                                   05406000
@CH01095 EQU   @CF01095+2                                               05407000
@CF01110 DC    F'366'                                                   05408000
@CH01110 EQU   @CF01110+2                                               05409000
@CF01035 DC    F'750'                                                   05410000
@CF01096 DC    F'86399'                                                 05411000
@CF01088 DC    F'86400'                                                 05412000
@CF01285 DC    XL4'0000FFFF'                                            05413000
@CF00831 DC    BL4'00000011'                                            05414000
@DATD    DSECT                                                          05415000
         DS    0D                                                       05416000
PTR2     DS    A                                                        05417000
OPENCLOS DS    FL4                                                      05418000
         ORG   OPENCLOS                                                 05419000
OPCLB1   DS    BL1                                                      05420000
OPCLB234 DS    CL3                                                      05421000
         ORG   OPENCLOS+4                                               05422000
RCDCOUNT DS    F                                                        05423000
OUTCOUNT DS    F                                                        05424000
HOLDT2TM DS    F                                                        05425000
HOLDT3TM DS    F                                                        05426000
DAYS     DS    F                                                        05427000
RCDTME   DS    F                                                        05428000
LENVOLID DS    H                                                        05429000
RETURNCD DS    H                                                        05430000
INCNT1   DS    H                                                        05431000
J        DS    H                                                        05432000
K        DS    H                                                        05433000
M        DS    H                                                        05434000
N        DS    H                                                        05435000
HOUR     DS    H                                                        05436000
MINUTE   DS    H                                                        05437000
SECOND   DS    H                                                        05438000
PAGECNT  DS    H                                                        05439000
CONVERT  DS    H                                                        05440000
WORK1    DS    FL1                                                      05441000
         DS    0D                                                       05442000
@TS00001 DS    CL8                                                      05443000
RECIN    DS    CL264                                                    05444000
RCDOUT   DS    CL72                                                     05445000
         ORG   RCDOUT                                                   05446000
STGD     DS    FL4                                                      05447000
CFAULT   DS    FL4                                                      05448000
SYSSGTM  DS    FL4                                                      05449000
DEVSGTM  DS    FL4                                                      05450000
DSTGD    DS    FL4                                                      05451000
SALLOC   DS    FL4                                                      05452000
SYSDSTM  DS    FL4                                                      05453000
DEVDSTM  DS    FL4                                                      05454000
BUSYTIME DS    FL4                                                      05455000
LOADTIME DS    FL4                                                      05456000
LOADNUM  DS    FL1                                                      05457000
CKTIME   DS    CL7                                                      05458000
         ORG   CKTIME                                                   05459000
SVEYEAR  DS    FL1                                                      05460000
SVEJUL   DS    FL2                                                      05461000
SVETME   DS    FL4                                                      05462000
         ORG   RCDOUT+48                                                05463000
PAGES    DS    FL1                                                      05464000
MININUM  DS    FL1                                                      05465000
HITNUM   DS    FL1                                                      05466000
STGDNUM  DS    FL1                                                      05467000
DSTGDNUM DS    FL1                                                      05468000
VTOCSTG  DS    FL1                                                      05469000
VTOCDSTG DS    FL1                                                      05470000
LIBRARY  DS    BL1                                                      05471000
DSPORT   DS    BL1                                                      05472000
DSCU     DS    BL1                                                      05473000
RCOZ     DS    BL1                                                      05474000
RCOY     DS    BL1                                                      05475000
RCOX     DS    BL1                                                      05476000
CARTPAIR DS    BL1                                                      05477000
READWRIT DS    FL1                                                      05478000
RCOVOLID DS    CL6                                                      05479000
CHARDRC  DS    CL1                                                      05480000
SDGINBIN DS    CL1                                                      05481000
@NM00044 DS    CL1                                                      05482000
         ORG   RCDOUT+72                                                05483000
BLKLINE  DS    CL121                                                    05484000
         ORG   BLKLINE                                                  05485000
@NM00045 DS    CL11                                                     05486000
BLKFLAG  DS    CL8                                                      05487000
@NM00046 DS    CL3                                                      05488000
BLKMINPT DS    CL2                                                      05489000
@NM00047 DS    CL2                                                      05490000
BLKLIBID DS    CL2                                                      05491000
@NM00048 DS    CL4                                                      05492000
BLKRSPPT DS    CL2                                                      05493000
@NM00049 DS    CL2                                                      05494000
SA1SSID  DS    CL3                                                      05495000
         ORG   SA1SSID                                                  05496000
CHAR8SA1 DS    CL1                                                      05497000
SA1ID    DS    CL1                                                      05498000
CHAR0SA1 DS    CL1                                                      05499000
         ORG   BLKLINE+39                                               05500000
@NM00050 DS    CL2                                                      05501000
SA2SSID  DS    CL3                                                      05502000
         ORG   SA2SSID                                                  05503000
CHAR8SA2 DS    CL1                                                      05504000
SA2ID    DS    CL1                                                      05505000
CHAR0SA2 DS    CL1                                                      05506000
         ORG   BLKLINE+44                                               05507000
@NM00051 DS    CL3                                                      05508000
BLKVV1   DS    CL2                                                      05509000
@NM00052 DS    CL2                                                      05510000
BLKVV2   DS    CL2                                                      05511000
@NM00053 DS    CL2                                                      05512000
BLKQCB   DS    CL12                                                     05513000
@NM00054 DS    CL2                                                      05514000
DRCSSID  DS    CL3                                                      05515000
         ORG   DRCSSID                                                  05516000
CHAR4    DS    CL1                                                      05517000
MSFDRC   DS    CL1                                                      05518000
PRINTDRC DS    CL1                                                      05519000
         ORG   BLKLINE+72                                               05520000
@NM00055 DS    CL2                                                      05521000
DRDSSID  DS    CL3                                                      05522000
         ORG   DRDSSID                                                  05523000
CHAR2    DS    CL1                                                      05524000
MSFDRD   DS    CL1                                                      05525000
PRINTDRD DS    CL1                                                      05526000
         ORG   BLKLINE+77                                               05527000
@NM00056 DS    CL3                                                      05528000
BLKQCBPT DS    CL2                                                      05529000
@NM00057 DS    CL2                                                      05530000
BLKVOLID DS    CL6                                                      05531000
@NM00058 DS    CL2                                                      05532000
BLKL     DS    CL1                                                      05533000
@NM00059 DS    CL1                                                      05534000
BLKX     DS    CL3                                                      05535000
@NM00060 DS    CL1                                                      05536000
BLKY     DS    CL2                                                      05537000
@NM00061 DS    CL1                                                      05538000
BLKZ     DS    CL1                                                      05539000
@NM00062 DS    CL2                                                      05540000
BLKT2TIM DS    CL8                                                      05541000
         ORG   BLKT2TIM                                                 05542000
T2HOUR   DS    CL2                                                      05543000
T2SEP1   DS    CL1                                                      05544000
T2MINUTE DS    CL2                                                      05545000
T2SEP2   DS    CL1                                                      05546000
T2SECOND DS    CL2                                                      05547000
         ORG   BLKLINE+112                                              05548000
@NM00063 DS    CL1                                                      05549000
BLKT3TIM DS    CL8                                                      05550000
         ORG   BLKT3TIM                                                 05551000
T3HOUR   DS    CL2                                                      05552000
T3SEP1   DS    CL1                                                      05553000
T3MINUTE DS    CL2                                                      05554000
T3SEP2   DS    CL1                                                      05555000
T3SECOND DS    CL2                                                      05556000
         ORG   BLKLINE+121                                              05557000
PRNTLINE DS    CL121                                                    05558000
HOLDHDG4 DS    CL121                                                    05559000
         ORG   HOLDHDG4                                                 05560000
@NM00117 DS    CL2                                                      05561000
HOLDDEST DS    CL6                                                      05562000
@NM00118 DS    CL113                                                    05563000
         ORG   HOLDHDG4+121                                             05564000
DRCPRINT DS    CL1                                                      05565000
DRDPRINT DS    CL1                                                      05566000
SAWORK   DS    BL1                                                      05567000
SDGSELSW DS    BL1                                                      05568000
VOLSELSW DS    BL1                                                      05569000
STDESTSW DS    BL1                                                      05570000
HOLDSDG  DS    BL1                                                      05571000
HOLDVOL  DS    CL6                                                      05572000
SDGSAVE  DS    CL6                                                      05573000
STATMASK DS    BL1                                                      05574000
         DS    CL1                                                      05575000
STARTTIM DS    CL16                                                     05576000
         ORG   STARTTIM                                                 05577000
@NM00141 DS    CL1                                                      05578000
CKSTIME  DS    CL7                                                      05579000
         ORG   CKSTIME                                                  05580000
HLDSYR   DS    FL1                                                      05581000
HLDSDAY  DS    FL2                                                      05582000
HLDSTIME DS    FL4                                                      05583000
         ORG   STARTTIM+8                                               05584000
@NM00142 DS    CL1                                                      05585000
CKETIME  DS    CL7                                                      05586000
         ORG   CKETIME                                                  05587000
HLDEYR   DS    FL1                                                      05588000
HLDEDAY  DS    FL2                                                      05589000
HLDETIME DS    FL4                                                      05590000
         ORG   STARTTIM+16                                              05591000
FRSTSW   DS    BL1                                                      05592000
FOUNDSW  DS    BL1                                                      05593000
MINI1SW  DS    BL1                                                      05594000
PARMERR  DS    BL1                                                      05595000
DATEINSW DS    BL1                                                      05596000
DECODCYL DS    BL1                                                      05597000
         DS    CL2                                                      05598000
DOUBLEWD DS    CL8                                                      05599000
DATETABL DS    CL12                                                     05600000
         ORG   DATETABL                                                 05601000
HOSTYEAR DS    FL2                                                      05602000
HOSTJUL  DS    FL2                                                      05603000
HOSTTME  DS    FL4                                                      05604000
HDRTME   DS    FL4                                                      05605000
         ORG   DATETABL+12                                              05606000
PARMSW   DS    CL1                                                      05607000
BITOUT   DS    CL8                                                      05608000
HEXOUT   DS    CL16                                                     05609000
FIXOUT   DS    CL13                                                     05610000
TODAY    DS    CL5                                                      05611000
DATEWORK DS    CL4                                                      05612000
PARMHOLD DS    CL29                                                     05613000
PRNTDCB  DS    CL100                                                    05614000
INDCB    DS    CL100                                                    05615000
OUTDCB   DS    CL100                                                    05616000
SAVESDG  DS    BL1                                                      05617000
IMLSAVE  DS    CL2                                                      05618000
IMLFLAG  DS    CL1                                                      05619000
MSFCONFG DS    4AL1                                                     05620000
DATETABA DS    CL16                                                     05621000
         ORG   DATETABA+0                                               05622000
STOREYR  DS    FL2                                                      05623000
STOREJUL DS    FL2                                                      05624000
STORETIM DS    FL4                                                      05625000
STOREDSM DS    FL4                                                      05626000
DATECNT  DS    FL4                                                      05627000
         ORG   DATETABA+12000                                           05628000
ICGTRINT CSECT                                                          05629000
         DS    0F                                                       05630000
@SIZDATD DC    AL1(0)                                                   05631000
         DC    AL3(@ENDDATD-@DATD)                                      05632000
         DS    0D                                                       05633000
ROLLOVER DC    XL4'00010000'                                            05634000
MASK     DC    XL4'0000000F'                                            05635000
NINE     DC    H'9'                                                     05636000
@CC01145 DC    C'DATA RECORDING CONTROLLERS'                            05637000
@CC01136 DC    C'DATA RECORDING DEVICES'                                05638000
@CC01149 DC    C'STAGING DRIVE GROUP XX'                                05639000
@CC01154 DC    C'STAGING DRIVE GROUPS'                                  05640000
@CC01158 DC    C'ACCESSOR CONTROLS'                                     05641000
@CC01141 DC    C'STAGING ADAPTERS'                                      05642000
@CC01201 DC    C'  :  :  '                                              05643000
@CC01086 DC    C'******'                                                05644000
@CC01087 DC    C'NONE  '                                                05645000
@CC01120 DC    C'      '                                                05646000
@CC01200 DC    C'  /   '                                                05647000
@CC01202 DC    C'DESTGE'                                                05648000
@CC01138 DC    C'200-V'                                                 05649000
@CC01143 DC    C'800-V'                                                 05650000
@CC01148 DC    C'400-V'                                                 05651000
@CC01153 DC    C'000-V'                                                 05652000
@CC01161 DC    C'101-V'                                                 05653000
@CC01162 DC    C'102-V'                                                 05654000
@CC01156 EQU   @CC01087                                                 05655000
@CC01119 DC    C'SDG'                                                   05656000
@CC01192 EQU   @CC01086                                                 05657000
@CC01083 EQU   @CC01087                                                 05658000
@CC01085 EQU   @CC01149                                                 05659000
HDNG1    DS    CL121                                                    05660000
         ORG   HDNG1                                                    05661000
@NM00102 DC    CL41'1ICGTRINT'                                          05662000
@NM00103 DC    CL60'MSS TRACE DATA INTERPRETATION'                      05663000
@NM00104 DC    CL20'DATE        PAGE    '                               05664000
         ORG   HDNG1+121                                                05665000
HDNG2    DS    CL121                                                    05666000
         ORG   HDNG2                                                    05667000
@NM00105 DC    CL1'0'                                                   05668000
@NM00106 DC    CL40'*BLOCK *    BLOCK   M/H  MSF  SDG  SA1  '           05669000
@NM00107 DC    CL40'SA2   VVA VVA               DRC  DRD  QC'           05670000
@NM00108 DC    CL40'B          COORDINATES      T2       T3 '           05671000
         ORG   HDNG2+121                                                05672000
HDNG3    DS    CL121                                                    05673000
         ORG   HDNG3                                                    05674000
@NM00109 DC    CL1' '                                                   05675000
@NM00110 DC    CL40'*HEADER*    FLAG    PTR  ID   PTR  SSID '           05676000
@NM00111 DC    CL40'SSID  1   2   QCB ENTRIES   SSID SSID PT'           05677000
@NM00112 DC    CL40'R  VOLID   L   X  Y Z      TIME     TIME'           05678000
         ORG   HDNG3+121                                                05679000
HDNG4    DS    CL121                                                    05680000
         ORG   HDNG4                                                    05681000
@NM00113 DC    CL1'0'                                                   05682000
@NM00114 DC    CL40'*STAGE *                      NXT  FUNC '           05683000
@NM00115 DC    CL40' CPU   P-LIST   NO.OF             UNCONV'           05684000
@NM00116 DC    CL40'ERTED     T1       T1       T4       T5 '           05685000
         ORG   HDNG4+121                                                05686000
HDNG5    DS    CL121                                                    05687000
         ORG   HDNG5                                                    05688000
@NM00119 DC    CL1' '                                                   05689000
@NM00120 DC    CL40'* MINI *  SEQUENCE    FLAG    M/H   ID  '           05690000
@NM00121 DC    CL40' ID     FLAG    PAGES  VUA  VVA     T1 T'           05691000
@NM00122 DC    CL40'IME      DATE     TIME     TIME     TIME'           05692000
         ORG   HDNG5+121                                                05693000
HDNG6    DS    CL121                                                    05694000
         ORG   HDNG6                                                    05695000
@NM00123 DC    CL1'0'                                                   05696000
@NM00124 DC    CL40'* PAGE *  DASD  VIRT  REAL              '           05697000
@NM00125 DC    CL80' '                                                  05698000
         ORG   HDNG6+121                                                05699000
HDNG7    DS    CL121                                                    05700000
         ORG   HDNG7                                                    05701000
@NM00126 DC    CL1' '                                                   05702000
@NM00127 DC    CL40'* LIST *  SSID  PAGE  PAGE  CYLINDERS   '           05703000
@NM00128 DC    CL80' '                                                  05704000
         ORG   HDNG7+121                                                05705000
HDLINE   DS    CL121                                                    05706000
         ORG   HDLINE                                                   05707000
@NM00129 DC    CL1'0'                                                   05708000
@NM00130 DC    CL40'*FILE HEADER*  HOST DATE - YYDDD        '           05709000
@NM00131 DC    CL40'HOST TIME - XXXXX             MSC TIME -'           05710000
@NM00132 DC    CL40' XXXXXXXX                               '           05711000
         ORG   HDLINE+121                                               05712000
TRLINE   DS    CL121                                                    05713000
         ORG   TRLINE                                                   05714000
@NM00133 DC    CL121'0*FILE TRAILER*'                                   05715000
         ORG   TRLINE+121                                               05716000
DTLHDR   DS    CL121                                                    05717000
         ORG   DTLHDR                                                   05718000
@NM00134 DC    CL1'-'                                                   05719000
@NM00135 DC    CL40'PARM OPTION X, DATES YYDDD-YYDDD, TIMES '           05720000
@NM00136 DC    CL40'HHMM-HHMM, INPUT RECORD COUNT XXXXXX, OU'           05721000
@NM00137 DC    CL40'TPUT RECORD COUNT XXXXXX, SELECT XXXXXX '           05722000
         ORG   DTLHDR+121                                               05723000
DATEHDR2 DS    CL121                                                    05724000
         ORG   DATEHDR2                                                 05725000
@NM00138 DC    CL1'0'                                                   05726000
@NM00139 DC    CL40'FILE DATES ENCOUNTERED    MSC TIME    JU'           05727000
@NM00140 DC    CL80'LIAN CONVERSION    COUNT'                           05728000
         ORG   DATEHDR2+121                                             05729000
PARMMSG  DC    CL28'1ICG900I INVALID PARM VALUES'                       05730000
TRINMSG  DC    CL31'1ICG901I OPEN ERROR FOR TRACEIN'                    05731000
TROUTMSG DC    CL32'1ICG902I OPEN ERROR FOR TRACEOUT'                   05732000
ICGTR904 DC    CL30' ICG904I I/O ERROR ON TRACEIN '                     05733000
ICGTR905 DC    CL30' ICG905I I/O ERROR ON TRACEOUT'                     05734000
ICGTR906 DC    CL121' ICG906I IML COUNT MISMATCH'                       05735000
FLAGONE  DC    X'FF'                                                    05736000
FOXES    DC    X'FFFF'                                                  05737000
         DS    CL2                                                      05738000
FIXAREA  DS    CL200                                                    05739000
         ORG   FIXAREA                                                  05740000
@NM00143 DC    200CL1'Z'                                                05741000
         ORG   FIXAREA+200                                              05742000
EIGHT0   DC    CL8'00000000'                                            05743000
REGLOKUP DC    X'00'                                                    05744000
         DC    X'01'                                                    05745000
         DC    X'02'                                                    05746000
         DC    X'03'                                                    05747000
         DC    X'02'                                                    05748000
         DC    X'03'                                                    05749000
         DC    X'00'                                                    05750000
         DC    X'01'                                                    05751000
         DC    X'04'                                                    05752000
         DC    X'05'                                                    05753000
         DC    X'06'                                                    05754000
         DC    X'07'                                                    05755000
         DC    X'06'                                                    05756000
         DC    X'07'                                                    05757000
         DC    X'04'                                                    05758000
         DC    X'05'                                                    05759000
SPECLKUP DC    X'00'                                                    05760000
         DC    X'01'                                                    05761000
         DC    X'04'                                                    05762000
         DC    X'05'                                                    05763000
         DC    X'02'                                                    05764000
         DC    X'03'                                                    05765000
         DC    X'00'                                                    05766000
         DC    X'01'                                                    05767000
         DC    X'04'                                                    05768000
         DC    X'05'                                                    05769000
         DC    X'02'                                                    05770000
         DC    X'03'                                                    05771000
SALOOKUP DC    CL1'0'                                                   05772000
         DC    CL1'1'                                                   05773000
         DC    CL1'2'                                                   05774000
         DC    CL1'3'                                                   05775000
         DC    CL1'4'                                                   05776000
         DC    CL1'5'                                                   05777000
         DC    CL1'6'                                                   05778000
         DC    CL1'7'                                                   05779000
         DC    CL1'8'                                                   05780000
         DC    CL1'9'                                                   05781000
         DC    CL1'A'                                                   05782000
         DC    CL1'B'                                                   05783000
         DC    CL1'C'                                                   05784000
         DC    CL1'D'                                                   05785000
         DC    CL1'E'                                                   05786000
         DC    CL1'F'                                                   05787000
SDGLOKUP DC    CL2'00'                                                  05788000
         DC    CL2'01'                                                  05789000
         DC    CL2'02'                                                  05790000
         DC    CL2'03'                                                  05791000
         DC    CL2'04'                                                  05792000
         DC    CL2'05'                                                  05793000
         DC    CL2'06'                                                  05794000
         DC    CL2'07'                                                  05795000
         DC    CL2'08'                                                  05796000
         DC    CL2'09'                                                  05797000
         DC    CL2'10'                                                  05798000
         DC    CL2'11'                                                  05799000
         DC    CL2'12'                                                  05800000
         DC    CL2'13'                                                  05801000
         DC    CL2'14'                                                  05802000
         DC    CL2'15'                                                  05803000
         DC    CL2'16'                                                  05804000
         DC    CL2'17'                                                  05805000
         DC    CL2'18'                                                  05806000
         DC    CL2'19'                                                  05807000
         DC    CL2'20'                                                  05808000
         DC    CL2'21'                                                  05809000
         DC    CL2'22'                                                  05810000
         DC    CL2'23'                                                  05811000
         DC    CL2'24'                                                  05812000
         DC    CL2'25'                                                  05813000
         DC    CL2'26'                                                  05814000
         DC    CL2'27'                                                  05815000
ICGTRINT CSECT                                                          05816000
*                                                         /*@Y30LB40*/  05817000
IPATDCB  DCB   DSORG=PS,DDNAME=TRACEIN,MACRF=GM,RECFM=FB,LRECL=264,   **05818000
               EODAD=EOJ,EROPT=SKP,SYNAD=READERR                        05819000
IDCBL    EQU   *-IPATDCB                                                05820000
OPATDCB  DCB   DSORG=PS,DDNAME=TRACEOUT,MACRF=PM,RECFM=FB,LRECL=72,   **05821000
               EROPT=ABE,SYNAD=WRITEERR                                 05822000
ODCBL    EQU   *-OPATDCB                                                05823000
PPATDCB  DCB   DSORG=PS,DDNAME=SYSPRINT,MACRF=PM,RECFM=FBA,LRECL=121    05824000
PDCBL    EQU   *-PPATDCB                                                05825000
@DATD    DSECT                                                          05826000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                05827000
@ENDDATD EQU   *                                                        05828000
ICGTRINT CSECT                                                          05829000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       05830000
@01      EQU   01                                                       05831000
@02      EQU   02                                                       05832000
@03      EQU   03                                                       05833000
@04      EQU   04                                                       05834000
@05      EQU   05                                                       05835000
@06      EQU   06                                                       05836000
@07      EQU   07                                                       05837000
@08      EQU   08                                                       05838000
@09      EQU   09                                                       05839000
@10      EQU   10                                                       05840000
@11      EQU   11                                                       05841000
@12      EQU   12                                                       05842000
@13      EQU   13                                                       05843000
@14      EQU   14                                                       05844000
@15      EQU   15                                                       05845000
HOLDTXTM EQU   @03                                                      05846000
SAVETIME EQU   @02                                                      05847000
LINECNT  EQU   @07                                                      05848000
P        EQU   @02                                                      05849000
I        EQU   @06                                                      05850000
LSTMINAD EQU   @06                                                      05851000
SS       EQU   @02                                                      05852000
HIT5TIME EQU   @07                                                      05853000
HOLDT5TM EQU   @03                                                      05854000
HOLDT4TM EQU   @05                                                      05855000
HOLDT1TM EQU   @02                                                      05856000
HOLDCYLS EQU   @04                                                      05857000
HOLDVTOC EQU   @06                                                      05858000
TIMEWORK EQU   @03                                                      05859000
PARMPTR  EQU   @03                                                      05860000
SAVE14   EQU   @06                                                      05861000
SDGINDEX EQU   @03                                                      05862000
INDEX    EQU   @02                                                      05863000
DRDINDEX EQU   @03                                                      05864000
DRCINDEX EQU   @02                                                      05865000
DCBPTR   EQU   @02                                                      05866000
R0       EQU   @00                                                      05867000
R1       EQU   @01                                                      05868000
R2       EQU   @02                                                      05869000
R3       EQU   @03                                                      05870000
R4       EQU   @04                                                      05871000
R5       EQU   @05                                                      05872000
R14      EQU   @14                                                      05873000
R15      EQU   @15                                                      05874000
IHADCB   EQU   0                                                        05875000
IHADCS05 EQU   0                                                        05876000
DCBMODE  EQU   IHADCS05                                                 05877000
DCBSTACK EQU   DCBMODE                                                  05878000
DCBFUNC  EQU   IHADCS05+3                                               05879000
IHADCS11 EQU   0                                                        05880000
DCBRELB  EQU   IHADCS11                                                 05881000
DCBREL   EQU   DCBRELB+1                                                05882000
DCBBUFCB EQU   IHADCS11+4                                               05883000
DCBDSORG EQU   IHADCS11+10                                              05884000
DCBDSRG1 EQU   DCBDSORG                                                 05885000
DCBDSRG2 EQU   DCBDSORG+1                                               05886000
DCBIOBAD EQU   IHADCS11+12                                              05887000
DCBODEB  EQU   DCBIOBAD                                                 05888000
DCBLNP   EQU   DCBODEB                                                  05889000
DCBQSLM  EQU   DCBLNP                                                   05890000
DCBIOBAA EQU   DCBODEB+1                                                05891000
IHADCS50 EQU   0                                                        05892000
DCBSVCXL EQU   IHADCS50                                                 05893000
DCBEODAD EQU   IHADCS50+4                                               05894000
DCBBFALN EQU   DCBEODAD                                                 05895000
DCBHIARC EQU   DCBBFALN                                                 05896000
DCBBFTEK EQU   DCBHIARC                                                 05897000
DCBBFT   EQU   DCBBFTEK                                                 05898000
DCBEXLST EQU   IHADCS50+8                                               05899000
DCBRECFM EQU   DCBEXLST                                                 05900000
DCBRECLA EQU   DCBRECFM                                                 05901000
IHADCS24 EQU   0                                                        05902000
DCBOFLGS EQU   IHADCS24+8                                               05903000
DCBOFLWR EQU   DCBOFLGS                                                 05904000
DCBIFLG  EQU   IHADCS24+9                                               05905000
DCBIBPCT EQU   DCBIFLG                                                  05906000
DCBMACR  EQU   IHADCS24+10                                              05907000
DCBMACR1 EQU   DCBMACR                                                  05908000
DCBMRFE  EQU   DCBMACR1                                                 05909000
DCBMRGET EQU   DCBMRFE                                                  05910000
DCBMRAPG EQU   DCBMACR1                                                 05911000
DCBMRRD  EQU   DCBMRAPG                                                 05912000
DCBMRCI  EQU   DCBMACR1                                                 05913000
DCBMRMVG EQU   DCBMRCI                                                  05914000
DCBMRLCG EQU   DCBMACR1                                                 05915000
DCBMRABC EQU   DCBMACR1                                                 05916000
DCBMRPT1 EQU   DCBMRABC                                                 05917000
DCBMRSBG EQU   DCBMRPT1                                                 05918000
DCBMRCRL EQU   DCBMACR1                                                 05919000
DCBMRCHK EQU   DCBMRCRL                                                 05920000
DCBMRRDX EQU   DCBMRCHK                                                 05921000
DCBMRDMG EQU   DCBMACR1                                                 05922000
DCBMACR2 EQU   DCBMACR+1                                                05923000
DCBMRPUT EQU   DCBMACR2                                                 05924000
DCBMRWRT EQU   DCBMACR2                                                 05925000
DCBMRMVP EQU   DCBMACR2                                                 05926000
DCBMR5WD EQU   DCBMACR2                                                 05927000
DCBMRLDM EQU   DCBMR5WD                                                 05928000
DCBMRLCP EQU   DCBMRLDM                                                 05929000
DCBMR4WD EQU   DCBMACR2                                                 05930000
DCBMRPT2 EQU   DCBMR4WD                                                 05931000
DCBMRTMD EQU   DCBMRPT2                                                 05932000
DCBMR3WD EQU   DCBMACR2                                                 05933000
DCBMRCTL EQU   DCBMR3WD                                                 05934000
DCBMRSTK EQU   DCBMRCTL                                                 05935000
DCBMR1WD EQU   DCBMACR2                                                 05936000
DCBMRSWA EQU   DCBMR1WD                                                 05937000
DCBMRDMD EQU   DCBMRSWA                                                 05938000
IHADCS25 EQU   0                                                        05939000
DCBMACRF EQU   IHADCS25+2                                               05940000
DCBMACF1 EQU   DCBMACRF                                                 05941000
DCBMFFE  EQU   DCBMACF1                                                 05942000
DCBMFGET EQU   DCBMFFE                                                  05943000
DCBMFAPG EQU   DCBMACF1                                                 05944000
DCBMFRD  EQU   DCBMFAPG                                                 05945000
DCBMFCI  EQU   DCBMACF1                                                 05946000
DCBMFMVG EQU   DCBMFCI                                                  05947000
DCBMFLCG EQU   DCBMACF1                                                 05948000
DCBMFABC EQU   DCBMACF1                                                 05949000
DCBMFPT1 EQU   DCBMFABC                                                 05950000
DCBMFSBG EQU   DCBMFPT1                                                 05951000
DCBMFCRL EQU   DCBMACF1                                                 05952000
DCBMFCHK EQU   DCBMFCRL                                                 05953000
DCBMFDMG EQU   DCBMACF1                                                 05954000
DCBMACF2 EQU   DCBMACRF+1                                               05955000
DCBMFPUT EQU   DCBMACF2                                                 05956000
DCBMFWRT EQU   DCBMACF2                                                 05957000
DCBMFMVP EQU   DCBMACF2                                                 05958000
DCBMF5WD EQU   DCBMACF2                                                 05959000
DCBMFLDM EQU   DCBMF5WD                                                 05960000
DCBMFLCP EQU   DCBMFLDM                                                 05961000
DCBMF4WD EQU   DCBMACF2                                                 05962000
DCBMFPT2 EQU   DCBMF4WD                                                 05963000
DCBMFTMD EQU   DCBMFPT2                                                 05964000
DCBMF3WD EQU   DCBMACF2                                                 05965000
DCBMFCTL EQU   DCBMF3WD                                                 05966000
DCBMFSTK EQU   DCBMFCTL                                                 05967000
DCBMF1WD EQU   DCBMACF2                                                 05968000
DCBMFSWA EQU   DCBMF1WD                                                 05969000
DCBMFDMD EQU   DCBMFSWA                                                 05970000
DCBDEBAD EQU   IHADCS25+4                                               05971000
DCBIFLGS EQU   DCBDEBAD                                                 05972000
DCBIFPCT EQU   DCBIFLGS                                                 05973000
IHADCS26 EQU   0                                                        05974000
DCBWRITE EQU   IHADCS26                                                 05975000
DCBREAD  EQU   DCBWRITE                                                 05976000
DCBWRITA EQU   DCBREAD+1                                                05977000
IHADCS27 EQU   0                                                        05978000
DCBGET   EQU   IHADCS27                                                 05979000
DCBPUT   EQU   DCBGET                                                   05980000
DCBGETA  EQU   DCBPUT+1                                                 05981000
IHADCS36 EQU   0                                                        05982000
DCBGERR  EQU   IHADCS36                                                 05983000
DCBPERR  EQU   DCBGERR                                                  05984000
DCBCHECK EQU   DCBPERR                                                  05985000
DCBOPTCD EQU   DCBCHECK                                                 05986000
DCBOPTH  EQU   DCBOPTCD                                                 05987000
DCBOPTO  EQU   DCBOPTH                                                  05988000
DCBOPTZ  EQU   DCBOPTCD                                                 05989000
DCBGERRA EQU   DCBCHECK+1                                               05990000
DCBPERRA EQU   DCBGERRA                                                 05991000
DCBSYNAD EQU   IHADCS36+4                                               05992000
DCBCIND1 EQU   IHADCS36+8                                               05993000
DCBCIND2 EQU   IHADCS36+9                                               05994000
DCBIOBA  EQU   IHADCS36+16                                              05995000
DCBCICB  EQU   DCBIOBA                                                  05996000
IHADCS52 EQU   0                                                        05997000
DCBDIRCT EQU   IHADCS52                                                 05998000
DCBQSWS  EQU   DCBDIRCT                                                 05999000
DCBUSASI EQU   DCBQSWS                                                  06000000
DCBQADFS EQU   DCBUSASI                                                 06001000
DCBBUFOF EQU   DCBDIRCT+1                                               06002000
IHADCS37 EQU   0                                                        06003000
DCBFLAG1 EQU   IHADCS37                                                 06004000
IHADCS38 EQU   0                                                        06005000
DCBEOBR  EQU   IHADCS38                                                 06006000
DCBPOINT EQU   IHADCS38+12                                              06007000
DCBCNTRL EQU   DCBPOINT                                                 06008000
IHADCS40 EQU   0                                                        06009000
DCBEOBAD EQU   IHADCS40                                                 06010000
DCBCCCW  EQU   IHADCS40+4                                               06011000
DCBRECAD EQU   DCBCCCW                                                  06012000
DCBRECBT EQU   DCBRECAD                                                 06013000
DCBRCREL EQU   DCBRECBT                                                 06014000
@NM00027 EQU   IHADCS40+12                                              06015000
DCBEROPT EQU   @NM00027                                                 06016000
DCBERACC EQU   DCBEROPT                                                 06017000
DCBERSKP EQU   DCBEROPT                                                 06018000
DCBERABE EQU   DCBEROPT                                                 06019000
MINIHDR  EQU   0                                                        06020000
SEQUENCE EQU   MINIHDR                                                  06021000
FLAG     EQU   MINIHDR+1                                                06022000
NXTMINAD EQU   MINIHDR+3                                                06023000
T1TIME   EQU   MINIHDR+4                                                06024000
T4TIME   EQU   MINIHDR+8                                                06025000
T5TIME   EQU   MINIHDR+10                                               06026000
FUNCID   EQU   MINIHDR+12                                               06027000
CPUID    EQU   MINIHDR+13                                               06028000
PLFLAG   EQU   MINIHDR+16                                               06029000
PLSTDEST EQU   PLFLAG                                                   06030000
PLNOTU   EQU   PLFLAG                                                   06031000
COUNT    EQU   MINIHDR+17                                               06032000
VUA      EQU   MINIHDR+18                                               06033000
VVA      EQU   MINIHDR+19                                               06034000
PAGELIST EQU   MINIHDR+20                                               06035000
RUA      EQU   PAGELIST                                                 06036000
DEVICE   EQU   RUA                                                      06037000
VIRTPAGE EQU   PAGELIST+1                                               06038000
REALPAGE EQU   PAGELIST+2                                               06039000
CYLIND   EQU   PAGELIST+3                                               06040000
PARMVALS EQU   0                                                        06041000
PARMLEN  EQU   PARMVALS                                                 06042000
PARMS    EQU   PARMVALS+2                                               06043000
BITADDR  EQU   0                                                        06044000
FIXADDR  EQU   0                                                        06045000
FIXLEN   EQU   0                                                        06046000
FIXOPT   EQU   0                                                        06047000
HEXADDR  EQU   0                                                        06048000
HEXLEN   EQU   0                                                        06049000
BLOCKHDR EQU   RECIN                                                    06050000
CCHHRR   EQU   BLOCKHDR                                                 06051000
TID      EQU   CCHHRR                                                   06052000
CYL      EQU   CCHHRR+1                                                 06053000
HEAD     EQU   CCHHRR+2                                                 06054000
RECORD   EQU   CCHHRR+3                                                 06055000
IMLCNT   EQU   CCHHRR+4                                                 06056000
BLOCKFLG EQU   BLOCKHDR+8                                               06057000
DS2VALID EQU   BLOCKFLG                                                 06058000
DS2IOS   EQU   BLOCKFLG                                                 06059000
MINIPTR  EQU   BLOCKHDR+9                                               06060000
LIBRID   EQU   BLOCKHDR+10                                              06061000
RSPINDGP EQU   BLOCKHDR+11                                              06062000
DS1ADDR  EQU   BLOCKHDR+12                                              06063000
DS1PORT  EQU   DS1ADDR                                                  06064000
DS1CU    EQU   DS1ADDR                                                  06065000
DS2ADDR  EQU   BLOCKHDR+13                                              06066000
DS2PORT  EQU   DS2ADDR                                                  06067000
DS2CU    EQU   DS2ADDR                                                  06068000
VVADDR1  EQU   BLOCKHDR+14                                              06069000
VVADDR2  EQU   BLOCKHDR+15                                              06070000
QCBENTS  EQU   BLOCKHDR+16                                              06071000
@NM00033 EQU   QCBENTS+2                                                06072000
PAIRNUM  EQU   @NM00033                                                 06073000
RWADDR   EQU   BLOCKHDR+22                                              06074000
CONTRLR  EQU   RWADDR                                                   06075000
RWU      EQU   RWADDR                                                   06076000
QCBADDR  EQU   BLOCKHDR+23                                              06077000
VOLID    EQU   BLOCKHDR+24                                              06078000
LZYX     EQU   BLOCKHDR+30                                              06079000
L        EQU   LZYX                                                     06080000
Z        EQU   LZYX                                                     06081000
Y        EQU   LZYX                                                     06082000
X        EQU   LZYX+1                                                   06083000
T2TIME   EQU   BLOCKHDR+32                                              06084000
T3TIME   EQU   BLOCKHDR+34                                              06085000
FIRSTMIN EQU   BLOCKHDR+40                                              06086000
BLKHDROV EQU   RECIN                                                    06087000
BLKOFLG  EQU   BLKHDROV+8                                               06088000
HOSTDATE EQU   BLKHDROV+12                                              06089000
HOSTTIME EQU   BLKHDROV+16                                              06090000
DSMTIME  EQU   BLKHDROV+20                                              06091000
VRW      EQU   BLKHDROV+24                                              06092000
VDS      EQU   BLKHDROV+28                                              06093000
VRWC     EQU   BLKHDROV+30                                              06094000
VRSG     EQU   BLKHDROV+32                                              06095000
VL       EQU   BLKHDROV+63                                              06096000
ORW      EQU   BLKHDROV+64                                              06097000
ODS      EQU   BLKHDROV+68                                              06098000
ORWC     EQU   BLKHDROV+70                                              06099000
ORSG     EQU   BLKHDROV+72                                              06100000
OL       EQU   BLKHDROV+103                                             06101000
RRW      EQU   BLKHDROV+104                                             06102000
RDS      EQU   BLKHDROV+108                                             06103000
RRWC     EQU   BLKHDROV+110                                             06104000
RRSG     EQU   BLKHDROV+112                                             06105000
RL       EQU   BLKHDROV+143                                             06106000
MINILINE EQU   PRNTLINE                                                 06107000
MINISEQ  EQU   MINILINE+11                                              06108000
MINIFLAG EQU   MINILINE+21                                              06109000
MINIADDR EQU   MINILINE+32                                              06110000
MINIFUNC EQU   MINILINE+37                                              06111000
MINICPU  EQU   MINILINE+42                                              06112000
MINIPGFL EQU   MINILINE+47                                              06113000
MINICNT  EQU   MINILINE+58                                              06114000
MINIVUA  EQU   MINILINE+65                                              06115000
MINIVVA  EQU   MINILINE+70                                              06116000
MINIT1A  EQU   MINILINE+74                                              06117000
MINIT1B  EQU   MINILINE+82                                              06118000
MINIT1C  EQU   MINILINE+83                                              06119000
MINICDAT EQU   MINILINE+88                                              06120000
MINICTIM EQU   MINILINE+95                                              06121000
MINIT4TM EQU   MINILINE+104                                             06122000
T4HOUR   EQU   MINIT4TM                                                 06123000
T4SEP1   EQU   MINIT4TM+2                                               06124000
T4MINUTE EQU   MINIT4TM+3                                               06125000
T4SEP2   EQU   MINIT4TM+5                                               06126000
T4SECOND EQU   MINIT4TM+6                                               06127000
MINIT5TM EQU   MINILINE+113                                             06128000
T5HOUR   EQU   MINIT5TM                                                 06129000
T5SEP1   EQU   MINIT5TM+2                                               06130000
T5MINUTE EQU   MINIT5TM+3                                               06131000
T5SEP2   EQU   MINIT5TM+5                                               06132000
T5SECOND EQU   MINIT5TM+6                                               06133000
PAGELINE EQU   BLKLINE                                                  06134000
PAGEDEV  EQU   PAGELINE+12                                              06135000
PAGEVP   EQU   PAGELINE+18                                              06136000
PAGERP   EQU   PAGELINE+24                                              06137000
PAGECYL  EQU   PAGELINE+30                                              06138000
DTLCOUNT EQU   BLKLINE                                                  06139000
OPT      EQU   DTLCOUNT+13                                              06140000
UDATE1   EQU   DTLCOUNT+22                                              06141000
UDATE2   EQU   DTLCOUNT+28                                              06142000
UTIME1   EQU   DTLCOUNT+41                                              06143000
UTIME2   EQU   DTLCOUNT+46                                              06144000
INCNT    EQU   DTLCOUNT+71                                              06145000
OUTCNT   EQU   DTLCOUNT+99                                              06146000
SELECTID EQU   DTLCOUNT+114                                             06147000
DATELINE EQU   BLKLINE                                                  06148000
DLF2     EQU   DATELINE+25                                              06149000
DLF4     EQU   DATELINE+28                                              06150000
DLF6     EQU   DATELINE+31                                              06151000
DLF8     EQU   DATELINE+34                                              06152000
DLF10    EQU   DATELINE+40                                              06153000
DLF10A   EQU   DATELINE+42                                              06154000
DLF12    EQU   DATELINE+47                                              06155000
DLF14    EQU   DATELINE+50                                              06156000
DLF16    EQU   DATELINE+53                                              06157000
DLF18    EQU   DATELINE+59                                              06158000
OVLYCONV EQU   CONVERT                                                  06159000
CONVERTO EQU   CONVERT                                                  06160000
FLD2     EQU   CONVERTO+1                                               06161000
*                                      START UNREFERENCED COMPONENTS    06162000
FLD1     EQU   CONVERTO                                                 06163000
FIELD3   EQU   OVLYCONV+1                                               06164000
FIELD2   EQU   OVLYCONV+1                                               06165000
FIELD1   EQU   OVLYCONV                                                 06166000
@NM00101 EQU   DATELINE+65                                              06167000
@NM00100 EQU   DATELINE+55                                              06168000
@NM00099 EQU   DATELINE+52                                              06169000
@NM00098 EQU   DATELINE+49                                              06170000
@NM00097 EQU   DATELINE+45                                              06171000
@NM00096 EQU   DATELINE+36                                              06172000
@NM00095 EQU   DATELINE+33                                              06173000
@NM00094 EQU   DATELINE+30                                              06174000
@NM00093 EQU   DATELINE+27                                              06175000
@NM00092 EQU   DATELINE                                                 06176000
@NM00091 EQU   DTLCOUNT+120                                             06177000
@NM00090 EQU   DTLCOUNT+105                                             06178000
@NM00089 EQU   DTLCOUNT+77                                              06179000
@NM00088 EQU   DTLCOUNT+50                                              06180000
@NM00087 EQU   DTLCOUNT+45                                              06181000
@NM00086 EQU   DTLCOUNT+33                                              06182000
@NM00085 EQU   DTLCOUNT+27                                              06183000
@NM00084 EQU   DTLCOUNT+14                                              06184000
@NM00083 EQU   DTLCOUNT                                                 06185000
@NM00082 EQU   PAGELINE+38                                              06186000
@NM00081 EQU   PAGELINE+27                                              06187000
@NM00080 EQU   PAGELINE+21                                              06188000
@NM00079 EQU   PAGELINE+15                                              06189000
@NM00078 EQU   PAGELINE                                                 06190000
@NM00077 EQU   MINILINE+112                                             06191000
@NM00076 EQU   MINILINE+103                                             06192000
@NM00075 EQU   MINILINE+94                                              06193000
@NM00074 EQU   MINILINE+86                                              06194000
@NM00073 EQU   MINILINE+72                                              06195000
@NM00072 EQU   MINILINE+67                                              06196000
@NM00071 EQU   MINILINE+61                                              06197000
@NM00070 EQU   MINILINE+55                                              06198000
@NM00069 EQU   MINILINE+44                                              06199000
@NM00068 EQU   MINILINE+39                                              06200000
@NM00067 EQU   MINILINE+34                                              06201000
@NM00066 EQU   MINILINE+29                                              06202000
@NM00065 EQU   MINILINE+19                                              06203000
@NM00064 EQU   MINILINE                                                 06204000
@NM00042 EQU   BLKHDROV+142                                             06205000
@NM00041 EQU   BLKHDROV+102                                             06206000
@NM00040 EQU   BLKHDROV+62                                              06207000
@NM00039 EQU   BLKHDROV+9                                               06208000
@NM00038 EQU   BLKHDROV                                                 06209000
SPAREBYT EQU   BLOCKHDR+39                                              06210000
JLWAIT   EQU   BLOCKHDR+38                                              06211000
BRSAVE   EQU   BLOCKHDR+37                                              06212000
STSAVE   EQU   BLOCKHDR+36                                              06213000
@NM00037 EQU   RWADDR                                                   06214000
@NM00036 EQU   QCBENTS+3                                                06215000
@NM00035 EQU   @NM00033                                                 06216000
@NM00034 EQU   @NM00033                                                 06217000
@NM00032 EQU   QCBENTS                                                  06218000
DS2NOTU  EQU   DS2ADDR                                                  06219000
DS1NOTU  EQU   DS1ADDR                                                  06220000
BITS67   EQU   BLOCKFLG                                                 06221000
BIT4     EQU   BLOCKFLG                                                 06222000
BITS123  EQU   BLOCKFLG                                                 06223000
@NM00031 EQU   CCHHRR+6                                                 06224000
@NM00043 EQU   RUA                                                      06225000
RESERVED EQU   MINIHDR+14                                               06226000
SPARE    EQU   MINIHDR+2                                                06227000
BITS38   EQU   SEQUENCE                                                 06228000
MVEDATA  EQU   SEQUENCE                                                 06229000
VERIFY   EQU   SEQUENCE                                                 06230000
DCBEOB   EQU   IHADCS40+20                                              06231000
DCBPRECL EQU   IHADCS40+18                                              06232000
@NM00030 EQU   IHADCS40+16                                              06233000
@NM00029 EQU   @NM00027+1                                               06234000
@NM00028 EQU   DCBEROPT                                                 06235000
@NM00026 EQU   IHADCS40+10                                              06236000
@NM00025 EQU   IHADCS40+9                                               06237000
@NM00024 EQU   IHADCS40+8                                               06238000
DCBRECA  EQU   DCBRECAD+1                                               06239000
@NM00023 EQU   DCBRECBT                                                 06240000
DCBRCFGT EQU   DCBRCREL                                                 06241000
DCBRCTRU EQU   DCBRCREL                                                 06242000
DCBLCCW  EQU   DCBEOBAD                                                 06243000
DCBNOTE  EQU   DCBCNTRL                                                 06244000
DCBLRECL EQU   IHADCS38+10                                              06245000
@NM00022 EQU   IHADCS38+8                                               06246000
DCBEOBW  EQU   IHADCS38+4                                               06247000
DCBEOBRA EQU   DCBEOBR+1                                                06248000
DCBNCP   EQU   DCBEOBR                                                  06249000
@NM00021 EQU   DCBFLAG1                                                 06250000
DCBSTFLS EQU   DCBFLAG1                                                 06251000
DCBSTQCK EQU   DCBFLAG1                                                 06252000
DCBDIRCQ EQU   DCBBUFOF                                                 06253000
DCBQSTRU EQU   DCBUSASI                                                 06254000
@NM00020 EQU   DCBUSASI                                                 06255000
DCBQADF3 EQU   DCBQADFS                                                 06256000
DCBQADF2 EQU   DCBQADFS                                                 06257000
DCBQADF1 EQU   DCBQADFS                                                 06258000
DCBBLBP  EQU   DCBUSASI                                                 06259000
@NM00019 EQU   DCBUSASI                                                 06260000
DCBCICBA EQU   DCBCICB+1                                                06261000
@NM00018 EQU   DCBCICB                                                  06262000
DCBOFFSW EQU   IHADCS36+15                                              06263000
DCBOFFSR EQU   IHADCS36+14                                              06264000
DCBWCPL  EQU   IHADCS36+13                                              06265000
DCBWCPO  EQU   IHADCS36+12                                              06266000
DCBBLKSI EQU   IHADCS36+10                                              06267000
DCBCNQSM EQU   DCBCIND2                                                 06268000
DCBCNFEO EQU   DCBCIND2                                                 06269000
DCBCNCHS EQU   DCBCIND2                                                 06270000
DCBCNBFP EQU   DCBCIND2                                                 06271000
DCBCNIOE EQU   DCBCIND2                                                 06272000
DCBCNCLO EQU   DCBCIND2                                                 06273000
DCBCNWRO EQU   DCBCIND2                                                 06274000
DCBCNSTO EQU   DCBCIND2                                                 06275000
DCBCNEXB EQU   DCBCIND1                                                 06276000
@NM00017 EQU   DCBCIND1                                                 06277000
DCBCNBRM EQU   DCBCIND1                                                 06278000
@NM00016 EQU   DCBCIND1                                                 06279000
DCBCNEVA EQU   DCBCIND1                                                 06280000
DCBCNEVB EQU   DCBCIND1                                                 06281000
DCBCNSRD EQU   DCBCIND1                                                 06282000
DCBCNTOV EQU   DCBCIND1                                                 06283000
DCBSYNA  EQU   DCBSYNAD+1                                               06284000
DCBIOBL  EQU   DCBSYNAD                                                 06285000
DCBCHCKA EQU   DCBPERRA                                                 06286000
DCBOPTJ  EQU   DCBOPTCD                                                 06287000
DCBOPTT  EQU   DCBOPTCD                                                 06288000
DCBSRCHD EQU   DCBOPTZ                                                  06289000
DCBOPTQ  EQU   DCBOPTCD                                                 06290000
DCBBCKPT EQU   DCBOPTO                                                  06291000
DCBOPTC  EQU   DCBOPTCD                                                 06292000
DCBOPTU  EQU   DCBOPTCD                                                 06293000
DCBOPTW  EQU   DCBOPTCD                                                 06294000
DCBPUTA  EQU   DCBGETA                                                  06295000
@NM00015 EQU   DCBPUT                                                   06296000
DCBREADA EQU   DCBWRITA                                                 06297000
@NM00014 EQU   DCBREAD                                                  06298000
DCBDEBA  EQU   DCBDEBAD+1                                               06299000
@NM00013 EQU   DCBIFLGS                                                 06300000
DCBIFIOE EQU   DCBIFLGS                                                 06301000
DCBCH12  EQU   DCBIFPCT                                                 06302000
DCBCH9   EQU   DCBIFPCT                                                 06303000
DCBIFEC  EQU   DCBIFLGS                                                 06304000
DCBMFSTI EQU   DCBMFDMD                                                 06305000
DCBMFAWR EQU   DCBMFSTK                                                 06306000
DCBMFUIP EQU   DCBMFTMD                                                 06307000
DCBMFIDW EQU   DCBMFLCP                                                 06308000
DCBMFWRK EQU   DCBMFMVP                                                 06309000
DCBMFRDQ EQU   DCBMFWRT                                                 06310000
DCBMFGTQ EQU   DCBMFPUT                                                 06311000
DCBMFSTL EQU   DCBMACF2                                                 06312000
DCBMFCK  EQU   DCBMFDMG                                                 06313000
DCBMFRDX EQU   DCBMFCHK                                                 06314000
DCBMFDBF EQU   DCBMFSBG                                                 06315000
DCBMFRDI EQU   DCBMFLCG                                                 06316000
DCBMFRDK EQU   DCBMFMVG                                                 06317000
DCBMFWRQ EQU   DCBMFRD                                                  06318000
DCBMFPTQ EQU   DCBMFGET                                                 06319000
DCBMFECP EQU   DCBMACF1                                                 06320000
DCBTIOT  EQU   IHADCS25                                                 06321000
DCBMRSTI EQU   DCBMRDMD                                                 06322000
DCBMRAWR EQU   DCBMRSTK                                                 06323000
DCBMRUIP EQU   DCBMRTMD                                                 06324000
DCBMRIDW EQU   DCBMRLCP                                                 06325000
DCBMRWRK EQU   DCBMRMVP                                                 06326000
DCBMRRDQ EQU   DCBMRWRT                                                 06327000
DCBMRGTQ EQU   DCBMRPUT                                                 06328000
DCBMRSTL EQU   DCBMACR2                                                 06329000
DCBMRCK  EQU   DCBMRDMG                                                 06330000
DCBPGFXA EQU   DCBMRRDX                                                 06331000
DCBMRDBF EQU   DCBMRSBG                                                 06332000
DCBMRRDI EQU   DCBMRLCG                                                 06333000
DCBMRRDK EQU   DCBMRMVG                                                 06334000
DCBMRWRQ EQU   DCBMRRD                                                  06335000
DCBMRPTQ EQU   DCBMRGET                                                 06336000
DCBMRECP EQU   DCBMACR1                                                 06337000
@NM00012 EQU   DCBIFLG                                                  06338000
DCBIBIOE EQU   DCBIFLG                                                  06339000
DCBICH12 EQU   DCBIBPCT                                                 06340000
DCBICH9  EQU   DCBIBPCT                                                 06341000
DCBIBEC  EQU   DCBIFLG                                                  06342000
DCBOFIOF EQU   DCBOFLGS                                                 06343000
DCBOFUEX EQU   DCBOFLGS                                                 06344000
DCBOFTM  EQU   DCBOFLGS                                                 06345000
DCBOFPPC EQU   DCBOFLGS                                                 06346000
DCBOFOPN EQU   DCBOFLGS                                                 06347000
DCBOFEOV EQU   DCBOFLGS                                                 06348000
DCBOFLRB EQU   DCBOFLGS                                                 06349000
DCBOFIOD EQU   DCBOFLWR                                                 06350000
DCBDDNAM EQU   IHADCS24                                                 06351000
DCBEXLSA EQU   DCBEXLST+1                                               06352000
DCBRECKL EQU   DCBRECFM                                                 06353000
DCBRECCC EQU   DCBRECFM                                                 06354000
DCBRECSB EQU   DCBRECFM                                                 06355000
DCBRECBR EQU   DCBRECFM                                                 06356000
DCBRECTO EQU   DCBRECLA                                                 06357000
DCBRECL  EQU   DCBRECLA                                                 06358000
DCBEODA  EQU   DCBEODAD+1                                               06359000
DCBBFA   EQU   DCBBFTEK                                                 06360000
DCBH0    EQU   DCBBFTEK                                                 06361000
DCBBFTKD EQU   DCBBFTEK                                                 06362000
DCBBFTE  EQU   DCBBFT                                                   06363000
DCBBFTKR EQU   DCBBFT                                                   06364000
DCBBFTS  EQU   DCBBFT                                                   06365000
DCBH1    EQU   DCBBFTEK                                                 06366000
DCBSVCXA EQU   DCBSVCXL+1                                               06367000
@NM00011 EQU   DCBSVCXL                                                 06368000
DCBODEBA EQU   DCBIOBAA                                                 06369000
@NM00010 EQU   DCBQSLM                                                  06370000
DCBUPDBT EQU   DCBQSLM                                                  06371000
DCBUPDCM EQU   DCBQSLM                                                  06372000
DCB1DVDS EQU   DCBQSLM                                                  06373000
@NM00009 EQU   DCBDSRG2                                                 06374000
DCBDSGTR EQU   DCBDSRG2                                                 06375000
DCBACBM  EQU   DCBDSRG2                                                 06376000
@NM00008 EQU   DCBDSRG2                                                 06377000
DCBDSGTQ EQU   DCBDSRG2                                                 06378000
DCBDSGTX EQU   DCBDSRG2                                                 06379000
DCBDSGGS EQU   DCBDSRG2                                                 06380000
DCBDSGU  EQU   DCBDSRG1                                                 06381000
DCBDSGPO EQU   DCBDSRG1                                                 06382000
@NM00007 EQU   DCBDSRG1                                                 06383000
@NM00006 EQU   DCBDSRG1                                                 06384000
DCBDSGCX EQU   DCBDSRG1                                                 06385000
DCBDSGDA EQU   DCBDSRG1                                                 06386000
DCBDSGPS EQU   DCBDSRG1                                                 06387000
DCBDSGIS EQU   DCBDSRG1                                                 06388000
DCBBUFL  EQU   IHADCS11+8                                               06389000
DCBBUFCA EQU   DCBBUFCB+1                                               06390000
DCBBUFNO EQU   DCBBUFCB                                                 06391000
DCBDEVT  EQU   DCBREL                                                   06392000
DCBKEYLE EQU   DCBRELB                                                  06393000
@NM00005 EQU   DCBFUNC                                                  06394000
DCBFNCBT EQU   DCBFUNC                                                  06395000
DCBFNCBX EQU   DCBFUNC                                                  06396000
DCBFNCBD EQU   DCBFUNC                                                  06397000
DCBFNCBW EQU   DCBFUNC                                                  06398000
DCBFNCBP EQU   DCBFUNC                                                  06399000
DCBFNCBR EQU   DCBFUNC                                                  06400000
DCBFNCBI EQU   DCBFUNC                                                  06401000
@NM00004 EQU   IHADCS05+2                                               06402000
@NM00003 EQU   IHADCS05+1                                               06403000
DCBSTCK1 EQU   DCBSTACK                                                 06404000
DCBSTCK2 EQU   DCBSTACK                                                 06405000
@NM00002 EQU   DCBSTACK                                                 06406000
DCBMODER EQU   DCBSTACK                                                 06407000
DCBMODEO EQU   DCBSTACK                                                 06408000
DCBMODEE EQU   DCBSTACK                                                 06409000
DCBMODEC EQU   DCBSTACK                                                 06410000
@NM00001 EQU   IHADCB                                                   06411000
*                                      END UNREFERENCED COMPONENTS      06412000
@RT00162 EQU   CLOSEFIL                                                 06413000
@RT00166 EQU   CLOSEFIL                                                 06414000
@RT00170 EQU   CLOSEFIL                                                 06415000
@RT00182 EQU   RDTRACE                                                  06416000
@RT00204 EQU   RDTRACE                                                  06417000
@RT00206 EQU   RDTRACE                                                  06418000
@RT00208 EQU   RDTRACE                                                  06419000
@RF00217 EQU   RDTRACE                                                  06420000
@RF00370 EQU   @EL00003                                                 06421000
@RT00410 EQU   PARMEND                                                  06422000
@RF00425 EQU   @RC00423                                                 06423000
@RF00435 EQU   @RC00433                                                 06424000
@RT00449 EQU   PARMEND                                                  06425000
@RT00462 EQU   PARMEND                                                  06426000
@RF00493 EQU   @EL00004                                                 06427000
@RF00529 EQU   @EL00006                                                 06428000
@RC00644 EQU   @RC00643                                                 06429000
@RC00722 EQU   @EL00007                                                 06430000
@RT00793 EQU   @EL00009                                                 06431000
@RF00791 EQU   CKREC                                                    06432000
@RT00807 EQU   @EL00009                                                 06433000
@RT00820 EQU   @EL00009                                                 06434000
@RF00878 EQU   @RC00870                                                 06435000
@RT00959 EQU   @EL00011                                                 06436000
@RF00962 EQU   @EL00011                                                 06437000
@RT01111 EQU   @EL00013                                                 06438000
@RT01137 EQU   @EL00013                                                 06439000
@RT01225 EQU   @EL00013                                                 06440000
@RT01287 EQU   @RC01286                                                 06441000
@RF01271 EQU   @EL00015                                                 06442000
@RF01323 EQU   @EL00015                                                 06443000
@RT01375 EQU   EF4                                                      06444000
EFEND    EQU   @EL00019                                                 06445000
@RC01436 EQU   @EL00022                                                 06446000
@PB00023 EQU   @EL00001                                                 06447000
@RT01373 EQU   EFEND                                                    06448000
@ENDDATA EQU   *                                                        06449000
         END   ICGTRINT,(C'PLS2133',0701,77354)                         06450000
