         TITLE '***** ICGTRSUM MSS TRACE SDG AND RWU SUMMARY REPORT ****00001000
               ***      '                                               00002000
ICGTRSUM CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'ICGTRSUM  77.089'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  LA    @11,4095(,@12)                                      0001 00012000
         USING @PSTART,@12                                         0001 00013000
         USING @PSTART+4095,@11                                    0001 00014000
         L     @00,@SIZDATD                                        0001 00015000
         GETMAIN  R,LV=(0)                                              00016000
         LR    @10,@01                                             0001 00017000
         LA    @09,4095(,@10)                                      0001 00018000
         USING @DATD,@10                                           0001 00019000
         USING @DATD+4095,@09                                      0001 00020000
         ST    @13,@SA00001+4                                      0001 00021000
         LM    @00,@01,20(@13)                                     0001 00022000
         ST    @10,8(,@13)                                         0001 00023000
         LR    @13,@10                                             0001 00024000
         L     R1,0(R1)                                                 00025000
*   PARMPTR=R1;                     /* SAVE JCL PARMS ADDRESS      0086 00026000
*                                                            @Y30LB40*/ 00027000
         LR    PARMPTR,R1                                          0086 00028000
*   RFY                                                            0087 00029000
*     R1 UNRSTD;                    /*                       @Y30LB40*/ 00030000
*   CALL INIT;                      /* INITIALIZE VALUES     @OZ11673*/ 00031000
         BAL   @14,INIT                                            0088 00032000
*   CALL OPENFILE;                  /* OPEN PRINT, TRACEIN   @OZ11673*/ 00033000
         BAL   @14,OPENFILE                                        0089 00034000
*   IF RETURNCD=4                   /* SYSPRINT NOT OPEN     @OZ11673*/ 00035000
*     THEN                          /*                       @OZ11673*/ 00036000
         LH    @06,RETURNCD                                        0090 00037000
         C     @06,@CF00104                                        0090 00038000
         BNE   @RF00090                                            0090 00039000
*     RETURN CODE(RETURNCD);        /* RETURN, NO MESSAGE    @OZ11673*/ 00040000
         L     @13,4(,@13)                                         0091 00041000
         L     @00,@SIZDATD                                        0091 00042000
         LR    @01,@10                                             0091 00043000
         FREEMAIN R,LV=(0),A=(1)                                        00044000
         LR    @15,@06                                             0091 00045000
         L     @14,12(,@13)                                        0091 00046000
         LM    @00,@12,20(@13)                                     0091 00047000
         BR    @14                                                 0091 00048000
*   ELSE                                                           0092 00049000
*     IF RETURNCD=8                 /* TRACEIN NOT OPEN      @OZ11673*/ 00050000
*       THEN                        /*                       @OZ11673*/ 00051000
@RF00090 CLC   RETURNCD(2),@CH00069                                0092 00052000
         BE    @RT00092                                            0092 00053000
*       GO TO CLOSEFIL;             /* CLOSE OPENED FILES    @OZ11673*/ 00054000
*   IF PARMLEN^=0                   /* IF PARMS PASSED       @OZ11673*/ 00055000
*     THEN                          /*                       @OZ11673*/ 00056000
         LH    @06,PARMLEN(,PARMPTR)                               0094 00057000
         LTR   @06,@06                                             0094 00058000
         BZ    @RF00094                                            0094 00059000
*     CALL GETPARMS;                /* PROCESS PARMS         @OZ11673*/ 00060000
         BAL   @14,GETPARMS                                        0095 00061000
*   IF RETURNCD=8                   /* IF ERROR IN           @OZ11673*/ 00062000
*     THEN                          /* PROCESSING PARMS      @OZ11673*/ 00063000
@RF00094 CLC   RETURNCD(2),@CH00069                                0096 00064000
         BE    @RT00096                                            0096 00065000
*     GO TO CLOSEFIL;               /* CLOSE OPENED FILES    @OZ11673*/ 00066000
*   RFY                                                            0098 00067000
*    (R0,                                                          0098 00068000
*     R1,                                                          0098 00069000
*     R14,                                                         0098 00070000
*     R15) RSTD;                    /*                       @OZ11673*/ 00071000
*   GEN(TIME);                      /* GET AND CONVERT TODAYS DATE 0099 00072000
*                                                            @OZ11673*/ 00073000
         TIME                                                           00074000
*   GEN(ST    R1,DOUBLEWD);         /*                       @OZ11673*/ 00075000
         ST    R1,DOUBLEWD                                              00076000
*   RFY                                                            0101 00077000
*    (R0,                                                          0101 00078000
*     R1,                                                          0101 00079000
*     R14,                                                         0101 00080000
*     R15) UNRSTD;                  /*                       @OZ11673*/ 00081000
*   UNPK(TODAY,DOUBLEWD(2:4));      /*                       @OZ11673*/ 00082000
*                                                                  0102 00083000
         UNPK  TODAY(5),DOUBLEWD+1(3)                              0102 00084000
*   /*****************************************************************/ 00085000
*   /*                                                               */ 00086000
*   /* ************************************************      @OZ11673*/ 00087000
*   /* SET UP INITIAL TIMESLICE COMPARE RECORD USING         @OZ11673*/ 00088000
*   /* THE STARTING TIME SPECIFIED IN THE DATE AND           @OZ11673*/ 00089000
*   /* TIME PARAMETERS, OR THE DEFAULT VALUES.               @OZ11673*/ 00090000
*   /* ************************************************      @OZ11673*/ 00091000
*   /*                                                               */ 00092000
*   /*****************************************************************/ 00093000
*                                                                  0103 00094000
*   TSBEG=CKSTIME;                  /*                       @OZ11673*/ 00095000
         MVC   TSBEG(7),CKSTIME                                    0103 00096000
*   TSEND=CKSTIME;                  /*                       @OZ11673*/ 00097000
         MVC   TSEND(7),CKSTIME                                    0104 00098000
*   TSETIME=TSETIME+TIMESL;         /*                       @OZ11673*/ 00099000
         L     @06,TSETIME                                         0105 00100000
         AL    @06,TIMESL                                          0105 00101000
         ST    @06,TSETIME                                         0105 00102000
*   GO TO RDTRACE;                                                 0106 00103000
         B     RDTRACE                                             0106 00104000
*                                                                  0107 00105000
*/********************************************************** @OZ11673*/ 00106000
*/*                                                          @OZ11673*/ 00107000
*/* PRODEDURE NAME - RDTRACE (SUBSECTION WITHIN MAINLINE)    @OZ11673*/ 00108000
*/*                                                          @OZ11673*/ 00109000
*/* FUNCTION - READ A RECORD FROM TRACEIN, AND DETERMINE     @OZ11673*/ 00110000
*/********************************************************** @OZ11673*/ 00111000
*                                                                  0107 00112000
*RDTRACE:                                                          0107 00113000
*   RFY                                                            0107 00114000
*    (R0,                                                          0107 00115000
*     R1,                                                          0107 00116000
*     R14,                                                         0107 00117000
*     R15) RSTD;                    /*                       @Y30LB40*/ 00118000
RDTRACE  DS    0H                                                  0108 00119000
*   GEN(GET   INDCB,RCDIN);         /* READ AN INPUT RECORD  @Y30LB40*/ 00120000
         GET   INDCB,RCDIN                                              00121000
*   RFY                                                            0109 00122000
*    (R0,                                                          0109 00123000
*     R1,                                                          0109 00124000
*     R14,                                                         0109 00125000
*     R15) UNRSTD;                  /*                       @Y30LB40*/ 00126000
*   IF CKTIME<CKSTIME|CKTIME>CKETIME/* IF NOT IN TIME RANGE          */ 00127000
*     THEN                                                         0110 00128000
         CLC   CKTIME(7),CKSTIME                                   0110 00129000
         BL    @RT00110                                            0110 00130000
         CLC   CKTIME(7),CKETIME                                   0110 00131000
         BH    @RT00110                                            0110 00132000
*     GO TO RDTRACE;                /* READ NEXT RECORD              */ 00133000
*   IF SELECTSW='1'B                /* WAS SDG OR LU ENTERED @ZA16140*/ 00134000
*     THEN                                                         0112 00135000
         TM    SELECTSW,B'10000000'                                0112 00136000
         BNO   @RF00112                                            0112 00137000
*     IF PARMSW='D' THEN                                           0113 00138000
         CLI   PARMSW,C'D'                                         0113 00139000
         BNE   @RF00113                                            0113 00140000
*       DO;                         /* SDG ENTERED,IS THIS THE     0114 00141000
*                                      DESIRED SDG           @ZA16140*/ 00142000
*         IF SDGINBIN^=SELSDG THEN                                 0115 00143000
         CLC   SDGINBIN(1),SELSDG                                  0115 00144000
         BNE   @RT00115                                            0115 00145000
*           GO TO RDTRACE;          /* NO,READ NEXT RECORD   @Y30LB40*/ 00146000
*       END;                        /*                       @Y30LB40*/ 00147000
*     ELSE                                                         0118 00148000
*       DO;                         /* LU ENTERED,IS THIS THE DESIRED   00149000
*                                      LU                    @Y30LB40*/ 00150000
         B     @RC00113                                            0118 00151000
@RF00113 DS    0H                                                  0119 00152000
*         IF L^=LIBRARY|U^=READWRIT THEN                           0119 00153000
         SLR   @06,@06                                             0119 00154000
         IC    @06,LIBRARY                                         0119 00155000
         CR    L,@06                                               0119 00156000
         BNE   @RT00119                                            0119 00157000
         SLR   @06,@06                                             0119 00158000
         IC    @06,READWRIT                                        0119 00159000
         CR    U,@06                                               0119 00160000
         BNE   @RT00119                                            0119 00161000
*           GO TO RDTRACE;          /* NO,READ NEXT RECORD   @Y30LB40*/ 00162000
*       END;                        /*                       @Y30LB40*/ 00163000
*   IF(DSTGD+STGD)^>0 THEN                                         0122 00164000
@RC00113 DS    0H                                                  0122 00165000
@RF00112 L     @06,DSTGD                                           0122 00166000
         AL    @06,STGD                                            0122 00167000
         LTR   @06,@06                                             0122 00168000
         BNP   @RT00122                                            0122 00169000
*     GO TO RDTRACE;                /* BYPASS ZERO RCDS              */ 00170000
*   IF FIRSTSW='1'B                 /* TEST IF FIRST RECORD  @Y30LB40*/ 00171000
*     THEN                                                         0124 00172000
         TM    FIRSTSW,B'10000000'                                 0124 00173000
         BNO   @RF00124                                            0124 00174000
*     DO;                           /*                       @Y30LB40*/ 00175000
*       FIRSTSW='0'B;               /* TURN OFF 1ST RECORD SWITCH    */ 00176000
         NI    FIRSTSW,B'01111111'                                 0126 00177000
*       CKSEQ=CKTIME;               /* SETUP TIME SLICE START AND END*/ 00178000
         MVC   CKSEQ(7),CKTIME                                     0127 00179000
*       CALL GETSLICE;              /*                       @OZ11673*/ 00180000
         BAL   @14,GETSLICE                                        0128 00181000
*     END;                          /*                       @Y30LB40*/ 00182000
*   IF CKTIME<CKSEQ                 /* CHECK INPUT SEQUENCE  @Y30LB40*/ 00183000
*     THEN                                                         0130 00184000
@RF00124 CLC   CKTIME(7),CKSEQ                                     0130 00185000
         BNL   @RF00130                                            0130 00186000
*     DO;                           /* OUT OF SEQUENCE,PRINT MESSAGE    00187000
*                                      AND                   @Y30LB40*/ 00188000
*       DSLINE=SEQMSG;              /* EXIT WITH RC=8        @Y30LB40*/ 00189000
         MVI   DSLINE+43,C' '                                      0132 00190000
         MVC   DSLINE+44(81),DSLINE+43                             0132 00191000
         MVC   DSLINE(43),SEQMSG                                   0132 00192000
*       RFY                                                        0133 00193000
*        (R0,                                                      0133 00194000
*         R1,                                                      0133 00195000
*         R14,                                                     0133 00196000
*         R15) RSTD;                /*                       @Y30LB40*/ 00197000
*       GEN(PUT   PRNTDCB,DSLINE);  /*                       @Y30LB40*/ 00198000
         PUT   PRNTDCB,DSLINE                                           00199000
*       RFY                                                        0135 00200000
*        (R0,                                                      0135 00201000
*         R1,                                                      0135 00202000
*         R14,                                                     0135 00203000
*         R15) UNRSTD;              /*                       @Y30LB40*/ 00204000
*       RETURNCD=8;                 /*                       @Y30LB40*/ 00205000
         MVC   RETURNCD(2),@CH00069                                0136 00206000
*       GO TO CLOSEFIL;             /*                       @Y30LB40*/ 00207000
         B     CLOSEFIL                                            0137 00208000
*     END;                          /*                       @Y30LB40*/ 00209000
*   CKSEQ=CKTIME;                   /* UPDATE SEQUENCE CHECK @Y30LB40*/ 00210000
@RF00130 MVC   CKSEQ(7),CKTIME                                     0139 00211000
*   RCDCOUNT=RCDCOUNT+1;            /* COUNT INPUT RECORDS   @Y30LB40*/ 00212000
         LA    @06,1                                               0140 00213000
         AL    @06,RCDCOUNT                                        0140 00214000
         ST    @06,RCDCOUNT                                        0140 00215000
*CHECKEOF:                                                         0141 00216000
*   IF CKTIME>TSEND                 /*                       @OZ11673*/ 00217000
*       |EOFSW='1'B                 /* END OF JOB YET        @OZ11673*/ 00218000
*     THEN                          /*                       @OZ11673*/ 00219000
CHECKEOF CLC   CKTIME(7),TSEND                                     0141 00220000
         BH    @RT00141                                            0141 00221000
         TM    EOFSW,B'10000000'                                   0141 00222000
         BNO   @RF00141                                            0141 00223000
@RT00141 DS    0H                                                  0142 00224000
*     DO;                           /*                       @OZ11673*/ 00225000
*       IF PARMSW='R'               /*                       @OZ11673*/ 00226000
*         THEN                      /*                       @OZ11673*/ 00227000
         CLI   PARMSW,C'R'                                         0143 00228000
         BNE   @RF00143                                            0143 00229000
*         CALL RWCTLBRK;            /*                       @OZ11673*/ 00230000
         BAL   @14,RWCTLBRK                                        0144 00231000
*       ELSE                        /*                       @OZ11673*/ 00232000
*         CALL DSCTLBRK;            /*                       @OZ11673*/ 00233000
         B     @RC00143                                            0145 00234000
@RF00143 BAL   @14,DSCTLBRK                                        0145 00235000
*       CALL GETSLICE;              /*                       @OZ11673*/ 00236000
@RC00143 BAL   @14,GETSLICE                                        0146 00237000
*     END;                          /*                       @OZ11673*/ 00238000
*   IF EOFSW='1'B                   /* END OF JOB YET        @OZ11673*/ 00239000
*     THEN                          /*                       @OZ11673*/ 00240000
@RF00141 TM    EOFSW,B'10000000'                                   0148 00241000
         BNO   @RF00148                                            0148 00242000
*     DO;                           /*                       @OZ11673*/ 00243000
*       CALL TESTEOF;               /*                       @OZ11673*/ 00244000
         BAL   @14,TESTEOF                                         0150 00245000
*       IF I=2                      /* REPORT TOTALS WRITTEN,GETOUT  */ 00246000
*         THEN                      /*                       @OZ11673*/ 00247000
         C     I,@CF00051                                          0151 00248000
         BNE   @RF00151                                            0151 00249000
*         DO;                       /*                       @OZ11673*/ 00250000
*           CALL EOJ;               /*                       @OZ11673*/ 00251000
         BAL   @14,EOJ                                             0153 00252000
*           GO TO CLOSEFIL;         /*                       @OZ11673*/ 00253000
         B     CLOSEFIL                                            0154 00254000
*         END;                      /*                       @OZ11673*/ 00255000
*     END;                          /*                       @OZ11673*/ 00256000
@RF00151 DS    0H                                                  0157 00257000
*   IF PARMSW='R'                   /*                       @OZ11673*/ 00258000
*     THEN                          /*                       @OZ11673*/ 00259000
@RF00148 CLI   PARMSW,C'R'                                         0157 00260000
         BNE   @RF00157                                            0157 00261000
*     CALL RWACCUM;                 /*                       @OZ11673*/ 00262000
         BAL   @14,RWACCUM                                         0158 00263000
*   ELSE                            /*                       @OZ11673*/ 00264000
*     CALL DSACCUM;                 /*                       @OZ11673*/ 00265000
         B     @RC00157                                            0159 00266000
@RF00157 BAL   @14,DSACCUM                                         0159 00267000
*   GO TO RDTRACE;                  /*                       @OZ11673*/ 00268000
         B     RDTRACE                                             0160 00269000
*CLOSEFIL:                                                         0161 00270000
*   RFY                                                            0161 00271000
*    (R0,                                                          0161 00272000
*     R1,                                                          0161 00273000
*     R14,                                                         0161 00274000
*     R15) RSTD;                    /*                       @Y30LB40*/ 00275000
CLOSEFIL DS    0H                                                  0162 00276000
*   GEN(CLOSE INDCB,MF=(E,OPENCLOS));/* CLOSE INPUT DCB      @Y30LB40*/ 00277000
         CLOSE INDCB,MF=(E,OPENCLOS)                                    00278000
*   GEN(CLOSE PRNTDCB,MF=(E,OPENCLOS));/* CLOSE PRINT DCB    @Y30LB40*/ 00279000
         CLOSE PRNTDCB,MF=(E,OPENCLOS)                                  00280000
*   RFY                                                            0164 00281000
*    (R0,                                                          0164 00282000
*     R1,                                                          0164 00283000
*     R14,                                                         0164 00284000
*     R15) UNRSTD;                  /*                       @Y30LB40*/ 00285000
*   RETURN CODE(RETURNCD);          /* TERMINATE WITH RETURN CODE  0165 00286000
*                                                            @Y30LB40*/ 00287000
         LH    @08,RETURNCD                                        0165 00288000
         L     @13,4(,@13)                                         0165 00289000
         L     @00,@SIZDATD                                        0165 00290000
         LR    @01,@10                                             0165 00291000
         FREEMAIN R,LV=(0),A=(1)                                        00292000
         LR    @15,@08                                             0165 00293000
         L     @14,12(,@13)                                        0165 00294000
         LM    @00,@12,20(@13)                                     0165 00295000
         BR    @14                                                 0165 00296000
*                                                                  0166 00297000
*/********************************************************** @OZ11673*/ 00298000
*/*                                                          @OZ11673*/ 00299000
*/* PROCEDURE NAME - INIT                                    @OZ11673*/ 00300000
*/*                                                          @OZ11673*/ 00301000
*/* FUNCTION - INITIALIZE LOCAL VARIABLES                    @OZ11673*/ 00302000
*/*                                                          @OZ11673*/ 00303000
*/********************************************************** @OZ11673*/ 00304000
*                                                                  0166 00305000
*INIT:                                                             0166 00306000
*   PROCEDURE;                      /*                       @OZ11673*/ 00307000
INIT     STM   @14,@12,12(@13)                                     0166 00308000
*   RCDCOUNT=0;                     /* INITIALIZE VARIABLES  @Y30LB40*/ 00309000
         SLR   @08,@08                                             0167 00310000
         ST    @08,RCDCOUNT                                        0167 00311000
*   RETURNCD=0;                     /*                       @Y30LB40*/ 00312000
         STH   @08,RETURNCD                                        0168 00313000
*   TIMESL=600;                     /*                       @Y30LB40*/ 00314000
         MVC   TIMESL(4),@CF00700                                  0169 00315000
*   HOUR=0;                         /*                       @Y30LB40*/ 00316000
         ST    @08,HOUR                                            0170 00317000
*   MINUTE=0;                       /*                       @Y30LB40*/ 00318000
         ST    @08,MINUTE                                          0171 00319000
*   SECOND=0;                       /*                       @Y30LB40*/ 00320000
         ST    @08,SECOND                                          0172 00321000
*   SELECTSW='0'B;                  /*                       @Y30LB40*/ 00322000
         NI    SELECTSW,B'01111111'                                0173 00323000
*   LINECNT=56;                     /*                       @Y30LB40*/ 00324000
         MVC   LINECNT(2),@CH00701                                 0174 00325000
*   OPENCLOS=0;                     /*                       @Y30LB40*/ 00326000
         ST    @08,OPENCLOS                                        0175 00327000
*   OPCLB1='10000000'B;             /*                       @Y30LB40*/ 00328000
         MVI   OPCLB1,B'10000000'                                  0176 00329000
*   PAGECNT=0;                      /*                       @Y30LB40*/ 00330000
         ST    @08,PAGECNT                                         0177 00331000
*   EOFSW='0'B;                     /*                       @Y30LB40*/ 00332000
         NI    EOFSW,B'01111111'                                   0178 00333000
*   HLDSYR=0;                       /*                       @Y30LB40*/ 00334000
         MVI   HLDSYR,X'00'                                        0179 00335000
*   HLDSDAY=1;                      /*                       @Y30LB40*/ 00336000
         LA    @15,1                                               0180 00337000
         STH   @15,HLDSDAY                                         0180 00338000
*   HLDSTIME=0;                     /*                       @Y30LB40*/ 00339000
         ST    @08,HLDSTIME                                        0181 00340000
*   HLDEYR=99;                      /*                       @Y30LB40*/ 00341000
         MVI   HLDEYR,X'63'                                        0182 00342000
*   HLDEDAY=365;                    /*                       @Y30LB40*/ 00343000
         MVC   HLDEDAY(2),@CH00704                                 0183 00344000
*   HLDETIME=86399;                 /*                       @Y30LB40*/ 00345000
         MVC   HLDETIME(4),@CF00705                                0184 00346000
*   PARMSW='D';                     /*                       @Y30LB40*/ 00347000
         MVI   PARMSW,C'D'                                         0185 00348000
*   FIRSTSW='1'B;                   /*                       @Y30LB40*/ 00349000
         OI    FIRSTSW,B'10000000'                                 0186 00350000
*   PARMERR='0'B;                   /*                       @Y30LB40*/ 00351000
         NI    PARMERR,B'01111111'                                 0187 00352000
*   DATEINSW='0'B;                  /*                       @Y30LB40*/ 00353000
         NI    DATEINSW,B'01111111'                                0188 00354000
*   SPACE1=' ';                     /*                       @Y30LB40*/ 00355000
         MVI   SPACE1+1,C' '                                       0189 00356000
         MVC   SPACE1+2(119),SPACE1+1                              0189 00357000
         MVI   SPACE1,C' '                                         0189 00358000
*   DO I=1 TO 2;                    /*                       @Y30LB40*/ 00359000
         LR    I,@15                                               0190 00360000
@DL00190 DS    0H                                                  0191 00361000
*     DO J=1 TO 2;                  /*                       @ZA16140*/ 00362000
         LA    J,1                                                 0191 00363000
@DL00191 DS    0H                                                  0192 00364000
*       DO K=1 TO 29;               /*                       @ZA16140*/ 00365000
         LA    K,1                                                 0192 00366000
@DL00192 DS    0H                                                  0193 00367000
*         BKT1(I,J,K)=0;            /*                       @Y30LB40*/ 00368000
         SLR   @15,@15                                             0193 00369000
         LR    @14,I                                               0193 00370000
         ALR   @14,@14                                             0193 00371000
         ALR   @14,J                                               0193 00372000
         MH    @14,@CH00643                                        0193 00373000
         ALR   @14,K                                               0193 00374000
         SLA   @14,2                                               0193 00375000
         ST    @15,BKT1-352(@14)                                   0193 00376000
*         BKT2(I,J,K)=0;            /*                       @Y30LB40*/ 00377000
         ST    @15,BKT2-352(@14)                                   0194 00378000
*         BKT3(I,J,K)=0;            /*                       @Y30LB40*/ 00379000
         ST    @15,BKT3-352(@14)                                   0195 00380000
*         BKT4(I,J,K)=0;            /*                       @Y30LB40*/ 00381000
         ST    @15,BKT4-352(@14)                                   0196 00382000
*         BKT5(I,J,K)=0;            /*                       @Y30LB40*/ 00383000
         ST    @15,BKT5-352(@14)                                   0197 00384000
*         BKT6(I,J,K)=0;            /*                       @Y30LB40*/ 00385000
         ST    @15,BKT6-352(@14)                                   0198 00386000
*         BKT7(I,J,K)=0;            /*                       @Y30LB40*/ 00387000
         ST    @15,BKT7-352(@14)                                   0199 00388000
*       END;                        /*                       @Y30LB40*/ 00389000
         AL    K,@CF00044                                          0200 00390000
         C     K,@CF00643                                          0200 00391000
         BNH   @DL00192                                            0200 00392000
*     END;                          /*                       @Y30LB40*/ 00393000
         AL    J,@CF00044                                          0201 00394000
         C     J,@CF00051                                          0201 00395000
         BNH   @DL00191                                            0201 00396000
*   END;                            /*                       @Y30LB40*/ 00397000
         AL    I,@CF00044                                          0202 00398000
         C     I,@CF00051                                          0202 00399000
         BNH   @DL00190                                            0202 00400000
*   END INIT;                       /*                       @OZ11673*/ 00401000
@EL00002 DS    0H                                                  0203 00402000
@EF00002 DS    0H                                                  0203 00403000
@ER00002 LM    @14,@12,12(@13)                                     0203 00404000
         BR    @14                                                 0203 00405000
*                                                                  0204 00406000
*/********************************************************** @OZ11673*/ 00407000
*/*                                                          @OZ11673*/ 00408000
*/* PROCEDURE NAME - OPENFILE                                @OZ11673*/ 00409000
*/*                                                          @OZ11673*/ 00410000
*/* FUNCTION - SET UP DCBS FOR SYSPRINT AND TRACEIN.  IF     @OZ11673*/ 00411000
*/*            SYSPRINT CANNOT BE OPENED,SET A RETURN CODE   @OZ11673*/ 00412000
*/*            OF 4 AND RETURN TO THE MAINLINE.  IF TRACEIN  @OZ11673*/ 00413000
*/*            CANNOT BE OPENED, WRITE MESSAGE 'ICG901I      @OZ11673*/ 00414000
*/*            TRACEIN CANNOT BE OPENED', SET A RETURN CODE  @OZ11673*/ 00415000
*/*            OF 8, AND RETURN TO THE MAINLINE.             @OZ11673*/ 00416000
*/*                                                          @OZ11673*/ 00417000
*/********************************************************** @OZ11673*/ 00418000
*                                                                  0204 00419000
*OPENFILE:                                                         0204 00420000
*   PROCEDURE;                      /*                       @OZ11673*/ 00421000
OPENFILE STM   @14,@12,@SA00003                                    0204 00422000
*   GEN(MVC   PRNTDCB(PDCBL),PPATDCB);/* SETUP PRINT DCB     @Y30LB40*/ 00423000
         MVC   PRNTDCB(PDCBL),PPATDCB                                   00424000
*   GEN(MVC   INDCB(IDCBL),IPATDCB);/* SETUP INPUT DCB       @Y30LB40*/ 00425000
         MVC   INDCB(IDCBL),IPATDCB                                     00426000
*   RFY                                                            0207 00427000
*    (R0,                                                          0207 00428000
*     R1,                                                          0207 00429000
*     R14,                                                         0207 00430000
*     R15) RSTD;                    /*                       @Y30LB40*/ 00431000
*   GEN(OPEN  (PRNTDCB,(OUTPUT)),MF=(E,OPENCLOS));/* OPEN PRINT DCB  */ 00432000
         OPEN  (PRNTDCB,(OUTPUT)),MF=(E,OPENCLOS)                       00433000
*   RFY                                                            0209 00434000
*    (R0,                                                          0209 00435000
*     R1,                                                          0209 00436000
*     R14,                                                         0209 00437000
*     R15) UNRSTD;                  /*                       @Y30LB40*/ 00438000
*   IF(PRNTDCB(49:49)&'00010000'B)^='00010000'B THEN               0210 00439000
         MVC   @TS00001(1),PRNTDCB+48                              0210 00440000
         NI    @TS00001,B'00010000'                                0210 00441000
         CLI   @TS00001,B'00010000'                                0210 00442000
         BE    @RF00210                                            0210 00443000
*     DO;                           /*                       @Y30LB40*/ 00444000
*       RETURNCD=4;                 /* SET RETURN CODE = 4   @OZ11673*/ 00445000
         MVC   RETURNCD(2),@CH00104                                0212 00446000
*       RETURN;                     /* RETURN TO MAINLINE    @OZ11673*/ 00447000
@EL00003 DS    0H                                                  0213 00448000
@EF00003 DS    0H                                                  0213 00449000
@ER00003 LM    @14,@12,@SA00003                                    0213 00450000
         BR    @14                                                 0213 00451000
*     END;                          /*                       @Y30LB40*/ 00452000
*   RFY                                                            0215 00453000
*    (R0,                                                          0215 00454000
*     R1,                                                          0215 00455000
*     R14,                                                         0215 00456000
*     R15) RSTD;                    /*                       @Y30LB40*/ 00457000
@RF00210 DS    0H                                                  0216 00458000
*   GEN(OPEN  (INDCB,(INPUT)),MF=(E,OPENCLOS));/* OPEN INPUT DCB     */ 00459000
         OPEN  (INDCB,(INPUT)),MF=(E,OPENCLOS)                          00460000
*   RFY                                                            0217 00461000
*    (R0,                                                          0217 00462000
*     R1,                                                          0217 00463000
*     R14,                                                         0217 00464000
*     R15) UNRSTD;                  /*                       @Y30LB40*/ 00465000
*   IF(INDCB(49:49)&'00010000'B)^='00010000'B THEN                 0218 00466000
         MVC   @TS00001(1),INDCB+48                                0218 00467000
         NI    @TS00001,B'00010000'                                0218 00468000
         CLI   @TS00001,B'00010000'                                0218 00469000
         BE    @RF00218                                            0218 00470000
*     DO;                           /* OPEN BAD,PRINT MESSAGE,EXIT 0219 00471000
*                                      WITH RC=8             @Y30LB40*/ 00472000
*       DSLINE=TRINMSG;             /*                       @Y30LB40*/ 00473000
         MVI   DSLINE+31,C' '                                      0220 00474000
         MVC   DSLINE+32(93),DSLINE+31                             0220 00475000
         MVC   DSLINE(31),TRINMSG                                  0220 00476000
*       RFY                                                        0221 00477000
*        (R0,                                                      0221 00478000
*         R1,                                                      0221 00479000
*         R14,                                                     0221 00480000
*         R15) RSTD;                /*                       @Y30LB40*/ 00481000
*       GEN(PUT   PRNTDCB,DSLINE);  /*                       @Y30LB40*/ 00482000
         PUT   PRNTDCB,DSLINE                                           00483000
*       RFY                                                        0223 00484000
*        (R0,                                                      0223 00485000
*         R1,                                                      0223 00486000
*         R14,                                                     0223 00487000
*         R15) UNRSTD;              /*                       @Y30LB40*/ 00488000
*       RETURNCD=8;                 /*                       @Y30LB40*/ 00489000
         MVC   RETURNCD(2),@CH00069                                0224 00490000
*       RETURN;                     /* RETURN TO MAINLINE    @OZ11673*/ 00491000
         B     @EL00003                                            0225 00492000
*     END;                          /*                       @Y30LB40*/ 00493000
*   END OPENFILE;                   /*                       @OZ11673*/ 00494000
         B     @EL00003                                            0227 00495000
*                                                                  0228 00496000
*/********************************************************** @OZ11673*/ 00497000
*/*                                                          @OZ11673*/ 00498000
*/* PROCEDURE NAME - GETPARMS                                @OZ11673*/ 00499000
*/*                                                          @OZ11673*/ 00500000
*/* FUNCTION - SCAN THE PARAMETERS PASSED IN THE PARM FIELD  @OZ11673*/ 00501000
*/*            OF THE EXEC STATEMENT FOR VALID PARAMETERS.   @OZ11673*/ 00502000
*/*            IF AN INVALID PARAMETER IS FOUND, WRITE MSG   @OZ11673*/ 00503000
*/*            'ICG900I INVALID PARM VALUES', SET A RETURN   @OZ11673*/ 00504000
*/*            CODE OF 8, AND RETURN TO THE MAINLINE.  IF    @OZ11673*/ 00505000
*/*            PARAMETERS ARE GOOD, RETURN TO THE MAINLINE   @OZ11673*/ 00506000
*/*            WITH A RETURN CODE OF 0.                      @OZ11673*/ 00507000
*/*                                                          @OZ11673*/ 00508000
*/********************************************************** @OZ11673*/ 00509000
*                                                                  0228 00510000
*GETPARMS:                                                         0228 00511000
*   PROCEDURE;                      /*                       @OZ11673*/ 00512000
GETPARMS STM   @14,@06,@SA00004                                    0228 00513000
         STM   @09,@12,@SA00004+36                                 0228 00514000
*   IF PARMLEN>31                   /*                       @OZ05079*/ 00515000
*     THEN                                                         0229 00516000
         LH    @06,PARMLEN(,PARMPTR)                               0229 00517000
         C     @06,@CF00067                                        0229 00518000
         BNH   @RF00229                                            0229 00519000
*     DO;                           /* IF PARMS TOO LONG,SET ERROR 0230 00520000
*                                      AND GETOUT            @Y30LB40*/ 00521000
*       PARMERR='1'B;               /*                       @Y30LB40*/ 00522000
         OI    PARMERR,B'10000000'                                 0231 00523000
*       GO TO PARMEND;              /*                       @Y30LB40*/ 00524000
         B     PARMEND                                             0232 00525000
*     END;                          /*                       @Y30LB40*/ 00526000
*   PARMHOLD(1:1)=',';              /* SET PARMHOLD TO ALL COMMAS  0234 00527000
*                                                            @Y30LB40*/ 00528000
@RF00229 MVI   PARMHOLD,C','                                       0234 00529000
*   MVC(PARMHOLD(2:31),PARMHOLD);   /*                       @OZ05079*/ 00530000
         MVC   PARMHOLD+1(30),PARMHOLD                             0235 00531000
*   SS=1;                           /* SET SUBSTRING POINTER TO 1  0236 00532000
*                                                            @Y30LB40*/ 00533000
         LA    SS,1                                                0236 00534000
*   PARMHOLD(1:PARMLEN)=PARMS;      /* MOVE PARMS TO PARMHOLD      0237 00535000
*                                                            @Y30LB40*/ 00536000
         LH    @06,PARMLEN(,PARMPTR)                               0237 00537000
         BCTR  @06,0                                               0237 00538000
         EX    @06,@SM00832                                        0237 00539000
*                                                                  0238 00540000
*/********************************************************** @OZ11673*/ 00541000
*/*                                                          @OZ11673*/ 00542000
*/* PROCEDURE NAME - (SUBSECTION WITHIN) GETPARMS            @OZ11673*/ 00543000
*/*                                                          @OZ11673*/ 00544000
*/* FUNCTION - SCAN FOR EITHER 'D' (SDG REPORT)              @ZA16140*/ 00545000
*/*            OR 'R' (DATA RECORDING DEVICE REPORT) IN THE  @OZ11673*/ 00546000
*/*            FIRST PARAMETER.  (IF NEITHER SPECIFIED, 'D'  @OZ11673*/ 00547000
*/*            IS DEFAULTED.)  IF AN ERROR IS FOUND, SCAN OF @OZ11673*/ 00548000
*/*            PARAMETERS IS DISCONTINUED.                   @OZ11673*/ 00549000
*/*                                                          @OZ11673*/ 00550000
*/********************************************************** @OZ11673*/ 00551000
*                                                                  0238 00552000
*   IF PARMHOLD(1:1)=','            /* WAS REPORT SELECTOR ENTERED 0238 00553000
*                                                            @Y30LB40*/ 00554000
*     THEN                                                         0238 00555000
         CLI   PARMHOLD,C','                                       0238 00556000
         BNE   @RF00238                                            0238 00557000
*     SS=2;                         /* NO,BUMP TO NEXT VALUE @Y30LB40*/ 00558000
         LA    SS,2                                                0239 00559000
*   ELSE                                                           0240 00560000
*     DO;                           /* YES,CHECK FOR D OR R  @Y30LB40*/ 00561000
         B     @RC00238                                            0240 00562000
@RF00238 DS    0H                                                  0241 00563000
*       IF PARMHOLD(1:1)='D'|PARMHOLD(1:1)='R' THEN                0241 00564000
         CLI   PARMHOLD,C'D'                                       0241 00565000
         BE    @RT00241                                            0241 00566000
         CLI   PARMHOLD,C'R'                                       0241 00567000
         BNE   @RF00241                                            0241 00568000
@RT00241 DS    0H                                                  0242 00569000
*         DO;                       /*                       @Y30LB40*/ 00570000
*           PARMSW=PARMHOLD(1:1);   /* SELECTOR OK SAVE IT   @Y30LB40*/ 00571000
         MVC   PARMSW(1),PARMHOLD                                  0243 00572000
*           SS=3;                   /* BUMP POINTER TO NEXT VALUE    */ 00573000
         LA    SS,3                                                0244 00574000
*         END;                      /*                       @Y30LB40*/ 00575000
*       ELSE                                                       0246 00576000
*         DO;                       /*                       @Y30LB40*/ 00577000
         B     @RC00241                                            0246 00578000
@RF00241 DS    0H                                                  0247 00579000
*           PARMERR='1'B;           /* INVALID SELECTOR,ERROR        */ 00580000
         OI    PARMERR,B'10000000'                                 0247 00581000
*           GO TO PARMEND;          /*                       @Y30LB40*/ 00582000
         B     PARMEND                                             0248 00583000
*         END;                      /*                       @Y30LB40*/ 00584000
*     END;                          /*                       @Y30LB40*/ 00585000
@RC00241 DS    0H                                                  0251 00586000
*                                                                  0251 00587000
*/********************************************************** @OZ11673*/ 00588000
*/*                                                          @OZ11673*/ 00589000
*/* PROCEDURE NAME - (SUBSECTION WITHIN) GETPARMS            @OZ11673*/ 00590000
*/*                                                          @OZ11673*/ 00591000
*/* FUNCTION - SCAN FOR THE TIME SLICE SPECIFIED IN MINUTES. @OZ11673*/ 00592000
*/*            (IF NO TIMESLICE IS SPECIFIED, DEFAULT IS     @OZ11673*/ 00593000
*/*            010.)  IF AN ERROR IS FOUND, SCAN OF          @OZ11673*/ 00594000
*/*            PARAMETERS IS DISCONTINUED.                   @OZ11673*/ 00595000
*/*                                                          @OZ11673*/ 00596000
*/********************************************************** @OZ11673*/ 00597000
*                                                                  0251 00598000
*   IF PARMHOLD(SS:SS)=','          /* WAS TIME SLICE ENTERED      0251 00599000
*                                                            @Y30LB40*/ 00600000
*     THEN                                                         0251 00601000
@RC00238 LA    @06,PARMHOLD-1(SS)                                  0251 00602000
         CLI   0(@06),C','                                         0251 00603000
         BNE   @RF00251                                            0251 00604000
*     SS=SS+1;                      /* NO,BUMP TO NEXT VALUE @Y30LB40*/ 00605000
         AL    SS,@CF00044                                         0252 00606000
*   ELSE                                                           0253 00607000
*     DO;                           /* YES,CHECK TIME SLICE  @Y30LB40*/ 00608000
         B     @RC00251                                            0253 00609000
@RF00251 DS    0H                                                  0254 00610000
*       DO I=SS TO(SS+2);           /* CHECK FOR NON NUMERICS      0254 00611000
*                                                            @Y30LB40*/ 00612000
         LR    I,SS                                                0254 00613000
         B     @DE00254                                            0254 00614000
@DL00254 DS    0H                                                  0255 00615000
*         IF PARMHOLD(I:I)>='0'&PARMHOLD(I:I)<='9' THEN            0255 00616000
         LA    @03,PARMHOLD-1(I)                                   0255 00617000
         CLI   0(@03),C'0'                                         0255 00618000
         BL    @RF00255                                            0255 00619000
         LA    @03,PARMHOLD-1(I)                                   0255 00620000
         CLI   0(@03),C'9'                                         0255 00621000
         BNH   @RT00255                                            0255 00622000
*           ;                       /*                       @Y30LB40*/ 00623000
*         ELSE                                                     0257 00624000
*           PARMERR='1'B;           /* NON NUMERIC FOUND,ERROR     0257 00625000
*                                                            @Y30LB40*/ 00626000
@RF00255 OI    PARMERR,B'10000000'                                 0257 00627000
*       END;                        /*                       @Y30LB40*/ 00628000
@RT00255 AL    I,@CF00044                                          0258 00629000
@DE00254 LA    @03,2                                               0258 00630000
         ALR   @03,SS                                              0258 00631000
         CR    I,@03                                               0258 00632000
         BNH   @DL00254                                            0258 00633000
*       IF PARMERR='1'B THEN                                       0259 00634000
         TM    PARMERR,B'10000000'                                 0259 00635000
         BO    @RT00259                                            0259 00636000
*         GO TO PARMEND;            /* IF ERRORS FOUND,GETOUT        */ 00637000
*       IF PARMHOLD(SS:SS+2)='000' THEN                            0261 00638000
         LA    @06,PARMHOLD-1(SS)                                  0261 00639000
         CLC   0(3,@06),@CC00717                                   0261 00640000
         BNE   @RF00261                                            0261 00641000
*         DO;                       /*                       @Y30LB40*/ 00642000
*           PARMERR='1'B;           /* TIME SLICE CANNOT BE 000,ERROR*/ 00643000
         OI    PARMERR,B'10000000'                                 0263 00644000
*           GO TO PARMEND;          /*                       @Y30LB40*/ 00645000
         B     PARMEND                                             0264 00646000
*         END;                      /*                       @Y30LB40*/ 00647000
*       PACK(DOUBLEWD,PARMHOLD(SS:SS+2));/*                  @Y30LB40*/ 00648000
@RF00261 LA    @06,PARMHOLD-1(SS)                                  0266 00649000
         PACK  DOUBLEWD(8),0(3,@06)                                0266 00650000
*       CVB(TIMESL,DOUBLEWD);       /*                       @Y30LB40*/ 00651000
         CVB   @06,DOUBLEWD                                        0267 00652000
         ST    @06,TIMESL                                          0267 00653000
*       TIMESL=TIMESL*60;           /* CONVERT TIME SLICE TO SECONDS    00654000
*                                                            @Y30LB40*/ 00655000
         MH    @06,@CH00335                                        0268 00656000
         ST    @06,TIMESL                                          0268 00657000
*       SS=SS+4;                    /*                       @Y30LB40*/ 00658000
         AL    SS,@CF00104                                         0269 00659000
*     END;                          /*                       @Y30LB40*/ 00660000
*                                                                  0271 00661000
*/********************************************************** @OZ11673*/ 00662000
*/*                                                          @OZ11673*/ 00663000
*/* PROCEDURE NAME - (SUBSECTION WITHIN) GETPARMS            @OZ11673*/ 00664000
*/*                                                          @OZ11673*/ 00665000
*/* FUNCTION - SCAN FOR JULIAN DATES.                        @OZ11673*/ 00666000
*/*                                                          @OZ11673*/ 00667000
*/********************************************************** @OZ11673*/ 00668000
*                                                                  0271 00669000
*   IF PARMHOLD(SS:SS)=','          /* WERE DATES ENTERED    @Y30LB40*/ 00670000
*     THEN                                                         0271 00671000
@RC00251 LA    @06,PARMHOLD-1(SS)                                  0271 00672000
         CLI   0(@06),C','                                         0271 00673000
         BNE   @RF00271                                            0271 00674000
*     SS=SS+1;                      /* NO,BUMP TO NEXT VALUE @Y30LB40*/ 00675000
         AL    SS,@CF00044                                         0272 00676000
*   ELSE                                                           0273 00677000
*     DO;                           /* YES,CHECK DATES       @Y30LB40*/ 00678000
         B     @RC00271                                            0273 00679000
@RF00271 DS    0H                                                  0274 00680000
*       DO I=SS TO(SS+9);           /* CHECK FOR NON NUMERICS      0274 00681000
*                                                            @Y30LB40*/ 00682000
         LR    I,SS                                                0274 00683000
         B     @DE00274                                            0274 00684000
@DL00274 DS    0H                                                  0275 00685000
*         IF PARMHOLD(I:I)>='0'&PARMHOLD(I:I)<='9' THEN            0275 00686000
         LA    @03,PARMHOLD-1(I)                                   0275 00687000
         CLI   0(@03),C'0'                                         0275 00688000
         BL    @RF00275                                            0275 00689000
         LA    @03,PARMHOLD-1(I)                                   0275 00690000
         CLI   0(@03),C'9'                                         0275 00691000
         BNH   @RT00275                                            0275 00692000
*           ;                       /*                       @Y30LB40*/ 00693000
*         ELSE                                                     0277 00694000
*           PARMERR='1'B;           /* ERROR,NON NUMERIC FOUND     0277 00695000
*                                                            @Y30LB40*/ 00696000
@RF00275 OI    PARMERR,B'10000000'                                 0277 00697000
*       END;                        /*                       @Y30LB40*/ 00698000
@RT00275 AL    I,@CF00044                                          0278 00699000
@DE00274 LA    @03,9                                               0278 00700000
         ALR   @03,SS                                              0278 00701000
         CR    I,@03                                               0278 00702000
         BNH   @DL00274                                            0278 00703000
*       IF PARMERR='1'B THEN                                       0279 00704000
         TM    PARMERR,B'10000000'                                 0279 00705000
         BO    @RT00279                                            0279 00706000
*         GO TO PARMEND;            /* IF ERRORS FOUND GETOUT        */ 00707000
*       PACK(DOUBLEWD,PARMHOLD(SS:SS+1));/* CONVERT DATES    @Y30LB40*/ 00708000
         LA    @06,PARMHOLD-1(SS)                                  0281 00709000
         PACK  DOUBLEWD(8),0(2,@06)                                0281 00710000
*       CVB(HLDSYR,DOUBLEWD);       /*                       @Y30LB40*/ 00711000
         CVB   @06,DOUBLEWD                                        0282 00712000
         STC   @06,HLDSYR                                          0282 00713000
*       PACK(DOUBLEWD,PARMHOLD(SS+2:SS+4));/*                @Y30LB40*/ 00714000
         LA    @06,PARMHOLD+1(SS)                                  0283 00715000
         PACK  DOUBLEWD(8),0(3,@06)                                0283 00716000
*       CVB(HLDSDAY,DOUBLEWD);      /*                       @Y30LB40*/ 00717000
         CVB   @06,DOUBLEWD                                        0284 00718000
         STH   @06,HLDSDAY                                         0284 00719000
*       PACK(DOUBLEWD,PARMHOLD(SS+5:SS+6));/*                @Y30LB40*/ 00720000
         LA    @03,PARMHOLD+4(SS)                                  0285 00721000
         PACK  DOUBLEWD(8),0(2,@03)                                0285 00722000
*       CVB(HLDEYR,DOUBLEWD);       /*                       @Y30LB40*/ 00723000
         CVB   @03,DOUBLEWD                                        0286 00724000
         STC   @03,HLDEYR                                          0286 00725000
*       PACK(DOUBLEWD,PARMHOLD(SS+7:SS+9));/*                @Y30LB40*/ 00726000
         LA    @03,PARMHOLD+6(SS)                                  0287 00727000
         PACK  DOUBLEWD(8),0(3,@03)                                0287 00728000
*       CVB(HLDEDAY,DOUBLEWD);      /*                       @Y30LB40*/ 00729000
         CVB   @03,DOUBLEWD                                        0288 00730000
         STH   @03,HLDEDAY                                         0288 00731000
*       IF HLDSDAY>0&HLDSDAY<366    /* CHECK FOR VALID DAY   @Y30LB40*/ 00732000
*         THEN                                                     0289 00733000
         LTR   @06,@06                                             0289 00734000
         BNP   @RF00289                                            0289 00735000
         C     @06,@CF00720                                        0289 00736000
         BL    @RT00289                                            0289 00737000
*         ;                         /*                       @Y30LB40*/ 00738000
*       ELSE                                                       0291 00739000
*         DO;                       /*                       @Y30LB40*/ 00740000
@RF00289 DS    0H                                                  0292 00741000
*           IF HLDSDAY=366 THEN                                    0292 00742000
         CLC   HLDSDAY(2),@CH00720                                 0292 00743000
         BNE   @RF00292                                            0292 00744000
*             DO;                   /* CHECK FOR LEAP YEAR   @Y30LB40*/ 00745000
*               IF(CKSTIME(1:1)&'00000011'B)^='00000000'B THEN     0294 00746000
         MVC   @TS00001(1),CKSTIME                                 0294 00747000
         NI    @TS00001,B'00000011'                                0294 00748000
         CLI   @TS00001,B'00000000'                                0294 00749000
         BE    @RF00294                                            0294 00750000
*                 PARMERR='1'B;     /* ERROR,BAD DAY         @Y30LB40*/ 00751000
         OI    PARMERR,B'10000000'                                 0295 00752000
*             END;                  /*                       @Y30LB40*/ 00753000
*           ELSE                                                   0297 00754000
*             PARMERR='1'B;         /* ERROR,BAD DAY         @Y30LB40*/ 00755000
         B     @RC00292                                            0297 00756000
@RF00292 OI    PARMERR,B'10000000'                                 0297 00757000
*         END;                      /*                       @Y30LB40*/ 00758000
@RC00292 DS    0H                                                  0299 00759000
*       IF HLDEDAY>0&HLDEDAY<366    /* SAME AS FOR START DAY         */ 00760000
*         THEN                                                     0299 00761000
@RT00289 LH    @06,HLDEDAY                                         0299 00762000
         LTR   @06,@06                                             0299 00763000
         BNP   @RF00299                                            0299 00764000
         C     @06,@CF00720                                        0299 00765000
         BL    @RT00299                                            0299 00766000
*         ;                         /*                       @Y30LB40*/ 00767000
*       ELSE                                                       0301 00768000
*         DO;                       /*                       @Y30LB40*/ 00769000
@RF00299 DS    0H                                                  0302 00770000
*           IF HLDEDAY=366 THEN                                    0302 00771000
         CLC   HLDEDAY(2),@CH00720                                 0302 00772000
         BNE   @RF00302                                            0302 00773000
*             DO;                   /*                       @Y30LB40*/ 00774000
*               IF(CKETIME(1:1)&'00000011'B)^='00000000'B THEN     0304 00775000
         MVC   @TS00001(1),CKETIME                                 0304 00776000
         NI    @TS00001,B'00000011'                                0304 00777000
         CLI   @TS00001,B'00000000'                                0304 00778000
         BE    @RF00304                                            0304 00779000
*                 PARMERR='1'B;     /*                       @Y30LB40*/ 00780000
         OI    PARMERR,B'10000000'                                 0305 00781000
*             END;                  /*                       @Y30LB40*/ 00782000
*           ELSE                                                   0307 00783000
*             PARMERR='1'B;         /*                       @Y30LB40*/ 00784000
         B     @RC00302                                            0307 00785000
@RF00302 OI    PARMERR,B'10000000'                                 0307 00786000
*         END;                      /*                       @Y30LB40*/ 00787000
@RC00302 DS    0H                                                  0309 00788000
*       IF HLDSYR<=HLDEYR           /* START YEAR MUST BE <= END YEAR   00789000
*                                                            @Y30LB40*/ 00790000
*         THEN                                                     0309 00791000
@RT00299 CLC   HLDSYR(1),HLDEYR                                    0309 00792000
         BNH   @RT00309                                            0309 00793000
*         ;                         /*                       @Y30LB40*/ 00794000
*       ELSE                                                       0311 00795000
*         PARMERR='1'B;             /*                       @Y30LB40*/ 00796000
         OI    PARMERR,B'10000000'                                 0311 00797000
*       IF HLDSDAY<=HLDEDAY         /* CHECK YEARS AND DAYS TOGETHER */ 00798000
*         THEN                                                     0312 00799000
@RT00309 LH    @06,HLDSDAY                                         0312 00800000
         CH    @06,HLDEDAY                                         0312 00801000
         BNH   @RT00312                                            0312 00802000
*         ;                         /*                       @Y30LB40*/ 00803000
*       ELSE                                                       0314 00804000
*         DO;                       /*                       @Y30LB40*/ 00805000
*           IF HLDSYR=HLDEYR THEN                                  0315 00806000
         CLC   HLDSYR(1),HLDEYR                                    0315 00807000
         BNE   @RF00315                                            0315 00808000
*             PARMERR='1'B;         /*                       @Y30LB40*/ 00809000
         OI    PARMERR,B'10000000'                                 0316 00810000
*         END;                      /*                       @Y30LB40*/ 00811000
@RF00315 DS    0H                                                  0318 00812000
*       IF PARMERR='1'B THEN                                       0318 00813000
@RT00312 TM    PARMERR,B'10000000'                                 0318 00814000
         BO    @RT00318                                            0318 00815000
*         GO TO PARMEND;            /* IF ERRORS FOUND,GETOUT        */ 00816000
*       DATEINSW='1'B;              /* DATES VALID,SET INDICATOR   0320 00817000
*                                                            @Y30LB40*/ 00818000
         OI    DATEINSW,B'10000000'                                0320 00819000
*       SS=SS+11;                   /* BUMP TO NEXT VALUE    @Y30LB40*/ 00820000
         AL    SS,@CF00033                                         0321 00821000
*     END;                          /*                       @Y30LB40*/ 00822000
*                                                                  0323 00823000
*/********************************************************** @OZ11673*/ 00824000
*/*                                                          @OZ11673*/ 00825000
*/* PROCEDURE NAME - (SUBSECTION WITHIN) GETPARMS            @OZ11673*/ 00826000
*/*                                                          @OZ11673*/ 00827000
*/* FUNCTION - SCAN FOR TIME-OF-DAY PARAMETER                @OZ11673*/ 00828000
*/*                                                          @OZ11673*/ 00829000
*/********************************************************** @OZ11673*/ 00830000
*                                                                  0323 00831000
*   IF PARMHOLD(SS:SS)=','          /* WERE TIMES ENTERED    @Y30LB40*/ 00832000
*     THEN                                                         0323 00833000
@RC00271 LA    @06,PARMHOLD-1(SS)                                  0323 00834000
         CLI   0(@06),C','                                         0323 00835000
         BNE   @RF00323                                            0323 00836000
*     SS=SS+1;                      /* NO,BUMP TO NEXT VALUE @Y30LB40*/ 00837000
         AL    SS,@CF00044                                         0324 00838000
*   ELSE                                                           0325 00839000
*     DO;                           /* YES,CHECK TIMES       @Y30LB40*/ 00840000
         B     @RC00323                                            0325 00841000
@RF00323 DS    0H                                                  0326 00842000
*       DO I=SS TO(SS+7);           /* CHECK FOR NON NUMERICS      0326 00843000
*                                                            @Y30LB40*/ 00844000
         LR    I,SS                                                0326 00845000
         B     @DE00326                                            0326 00846000
@DL00326 DS    0H                                                  0327 00847000
*         IF PARMHOLD(I:I)>='0'&PARMHOLD(I:I)<='9' THEN            0327 00848000
         LA    @03,PARMHOLD-1(I)                                   0327 00849000
         CLI   0(@03),C'0'                                         0327 00850000
         BL    @RF00327                                            0327 00851000
         LA    @03,PARMHOLD-1(I)                                   0327 00852000
         CLI   0(@03),C'9'                                         0327 00853000
         BNH   @RT00327                                            0327 00854000
*           ;                       /*                       @Y30LB40*/ 00855000
*         ELSE                                                     0329 00856000
*           PARMERR='1'B;           /* NON NUMERIC FOUND,ERROR     0329 00857000
*                                                            @Y30LB40*/ 00858000
@RF00327 OI    PARMERR,B'10000000'                                 0329 00859000
*       END;                        /*                       @Y30LB40*/ 00860000
@RT00327 AL    I,@CF00044                                          0330 00861000
@DE00326 LA    @03,7                                               0330 00862000
         ALR   @03,SS                                              0330 00863000
         CR    I,@03                                               0330 00864000
         BNH   @DL00326                                            0330 00865000
*       IF PARMERR='1'B THEN                                       0331 00866000
         TM    PARMERR,B'10000000'                                 0331 00867000
         BO    @RT00331                                            0331 00868000
*         GO TO PARMEND;            /*                       @Y30LB40*/ 00869000
*       PACK(DOUBLEWD,PARMHOLD(SS:SS+1));/* CONVERT TIMES    @Y30LB40*/ 00870000
         LA    @06,PARMHOLD-1(SS)                                  0333 00871000
         PACK  DOUBLEWD(8),0(2,@06)                                0333 00872000
*       CVB(TIMEWORK,DOUBLEWD);     /*                       @Y30LB40*/ 00873000
         CVB   TIMEWORK,DOUBLEWD                                   0334 00874000
*       IF TIMEWORK>23 THEN                                        0335 00875000
         C     TIMEWORK,@CF00723                                   0335 00876000
         BNH   @RF00335                                            0335 00877000
*         PARMERR='1'B;             /*                       @Y30LB40*/ 00878000
         OI    PARMERR,B'10000000'                                 0336 00879000
*       ELSE                                                       0337 00880000
*         HLDSTIME=TIMEWORK*3600;   /*                       @Y30LB40*/ 00881000
         B     @RC00335                                            0337 00882000
@RF00335 LR    @06,TIMEWORK                                        0337 00883000
         MH    @06,@CH00724                                        0337 00884000
         ST    @06,HLDSTIME                                        0337 00885000
*       PACK(DOUBLEWD,PARMHOLD(SS+2:SS+3));/*                @Y30LB40*/ 00886000
@RC00335 LA    @06,PARMHOLD+1(SS)                                  0338 00887000
         PACK  DOUBLEWD(8),0(2,@06)                                0338 00888000
*       CVB(TIMEWORK,DOUBLEWD);     /*                       @Y30LB40*/ 00889000
         CVB   TIMEWORK,DOUBLEWD                                   0339 00890000
*       IF TIMEWORK>59 THEN                                        0340 00891000
         C     TIMEWORK,@CF00725                                   0340 00892000
         BNH   @RF00340                                            0340 00893000
*         PARMERR='1'B;             /*                       @Y30LB40*/ 00894000
         OI    PARMERR,B'10000000'                                 0341 00895000
*       ELSE                                                       0342 00896000
*         HLDSTIME=HLDSTIME+(TIMEWORK*60);/*                 @Y30LB40*/ 00897000
         B     @RC00340                                            0342 00898000
@RF00340 LR    @06,TIMEWORK                                        0342 00899000
         MH    @06,@CH00335                                        0342 00900000
         AL    @06,HLDSTIME                                        0342 00901000
         ST    @06,HLDSTIME                                        0342 00902000
*       PACK(DOUBLEWD,PARMHOLD(SS+4:SS+5));/*                @Y30LB40*/ 00903000
@RC00340 LA    @06,PARMHOLD+3(SS)                                  0343 00904000
         PACK  DOUBLEWD(8),0(2,@06)                                0343 00905000
*       CVB(TIMEWORK,DOUBLEWD);     /*                       @Y30LB40*/ 00906000
         CVB   TIMEWORK,DOUBLEWD                                   0344 00907000
*       IF TIMEWORK>23 THEN                                        0345 00908000
         C     TIMEWORK,@CF00723                                   0345 00909000
         BNH   @RF00345                                            0345 00910000
*         PARMERR='1'B;             /*                       @Y30LB40*/ 00911000
         OI    PARMERR,B'10000000'                                 0346 00912000
*       ELSE                                                       0347 00913000
*         HLDETIME=TIMEWORK*3600;   /*                       @Y30LB40*/ 00914000
         B     @RC00345                                            0347 00915000
@RF00345 LR    @06,TIMEWORK                                        0347 00916000
         MH    @06,@CH00724                                        0347 00917000
         ST    @06,HLDETIME                                        0347 00918000
*       PACK(DOUBLEWD,PARMHOLD(SS+6:SS+7));/*                @Y30LB40*/ 00919000
@RC00345 LA    @06,PARMHOLD+5(SS)                                  0348 00920000
         PACK  DOUBLEWD(8),0(2,@06)                                0348 00921000
*       CVB(TIMEWORK,DOUBLEWD);     /*                       @Y30LB40*/ 00922000
         CVB   TIMEWORK,DOUBLEWD                                   0349 00923000
*       IF TIMEWORK>59 THEN                                        0350 00924000
         C     TIMEWORK,@CF00725                                   0350 00925000
         BNH   @RF00350                                            0350 00926000
*         PARMERR='1'B;             /*                       @Y30LB40*/ 00927000
         OI    PARMERR,B'10000000'                                 0351 00928000
*       ELSE                                                       0352 00929000
*         HLDETIME=HLDETIME+(TIMEWORK*60)+59;/*              @Y30LB40*/ 00930000
         B     @RC00350                                            0352 00931000
@RF00350 LR    @06,TIMEWORK                                        0352 00932000
         MH    @06,@CH00335                                        0352 00933000
         AL    @06,HLDETIME                                        0352 00934000
         AL    @06,@CF00725                                        0352 00935000
         ST    @06,HLDETIME                                        0352 00936000
*       IF HLDSYR=HLDEYR&HLDSDAY=HLDEDAY THEN                      0353 00937000
@RC00350 CLC   HLDSYR(1),HLDEYR                                    0353 00938000
         BNE   @RF00353                                            0353 00939000
         CLC   HLDSDAY(2),HLDEDAY                                  0353 00940000
         BNE   @RF00353                                            0353 00941000
*         IF HLDSTIME>HLDETIME THEN                                0354 00942000
         L     @06,HLDSTIME                                        0354 00943000
         C     @06,HLDETIME                                        0354 00944000
         BNH   @RF00354                                            0354 00945000
*           PARMERR='1'B;           /*                       @Y30LB40*/ 00946000
         OI    PARMERR,B'10000000'                                 0355 00947000
*       IF PARMERR='0'B&DATEINSW='0'B THEN                         0356 00948000
@RF00354 DS    0H                                                  0356 00949000
@RF00353 TM    PARMERR,B'10000000'                                 0356 00950000
         BNZ   @RF00356                                            0356 00951000
         TM    DATEINSW,B'10000000'                                0356 00952000
         BNZ   @RF00356                                            0356 00953000
*         PARMERR='1'B;             /* IF DATES NOT ENTERED,ERROR  0357 00954000
*                                                            @Y30LB40*/ 00955000
         OI    PARMERR,B'10000000'                                 0357 00956000
*       SS=SS+9;                    /* OK SO FAR,BUMP TO NEXT VALUE     00957000
*                                                            @Y30LB40*/ 00958000
@RF00356 AL    SS,@CF00035                                         0358 00959000
*     END;                          /*                       @Y30LB40*/ 00960000
*                                                                  0360 00961000
*/********************************************************** @OZ11673*/ 00962000
*/*                                                          @OZ11673*/ 00963000
*/* PROCEDURE NAME - (SUBSECTION WITHIN) GETPARMS            @OZ11673*/ 00964000
*/*                                                          @OZ11673*/ 00965000
*/* FUNCTION - SCAN FOR THE SSID OR SDG OF THE DEVICE        @ZA16140*/ 00966000
*/*            SELECTED FOR                                  @ZA16140*/ 00967000
*/*            THE REPORT TO BE PRODUCED.                    @OZ11673*/ 00968000
*/*                                                          @OZ11673*/ 00969000
*/********************************************************** @OZ11673*/ 00970000
*                                                                  0360 00971000
*   IF PARMERR='1'B THEN                                           0360 00972000
@RC00323 TM    PARMERR,B'10000000'                                 0360 00973000
         BO    @RT00360                                            0360 00974000
*     GO TO PARMEND;                /* IF ERRORS FOUND,GETOUT        */ 00975000
*   IF PARMHOLD(SS:SS)=','          /* WERE SDG OR LU ENTERED      0362 00976000
*                                                            @ZA16140*/ 00977000
*     THEN                                                         0362 00978000
         LA    @06,PARMHOLD-1(SS)                                  0362 00979000
         CLI   0(@06),C','                                         0362 00980000
         BE    @RT00362                                            0362 00981000
*     ;                             /* NO,FINISH PROCESS     @Y30LB40*/ 00982000
*   ELSE                                                           0364 00983000
*     DO;                           /* YES,CHECK VALUES      @Y30LB40*/ 00984000
*       SELECTSW='1'B;              /* SET SELECTOR SWITCH   @Y30LB40*/ 00985000
         OI    SELECTSW,B'10000000'                                0365 00986000
*       IF PARMSW='D'               /* IF SDG REPORT         @ZA16140*/ 00987000
*         THEN                                                     0366 00988000
         CLI   PARMSW,C'D'                                         0366 00989000
         BNE   @RF00366                                            0366 00990000
*         DO;                       /* CHECK FOR VALID SDG VALUES  0367 00991000
*                                                            @ZA16140*/ 00992000
*           IF((PARMHOLD(SS:SS+2)='SDG')&(PARMHOLD(SS+3:SS+3)>='0')&(   00993000
*               PARMHOLD(SS+3:SS+3)<='2')&(PARMHOLD(SS+4:SS+4)>='0')&(  00994000
*               PARMHOLD(SS+4:SS+4)<='9')&(PARMHOLD(SS+3:SS+4)<='27'))  00995000
*             THEN                                                 0368 00996000
         LA    @06,PARMHOLD-1(SS)                                  0368 00997000
         CLC   0(3,@06),@CC00726                                   0368 00998000
         BNE   @RF00368                                            0368 00999000
         LA    @06,PARMHOLD+2(SS)                                  0368 01000000
         CLI   0(@06),C'0'                                         0368 01001000
         BL    @RF00368                                            0368 01002000
         LA    @06,PARMHOLD+2(SS)                                  0368 01003000
         CLI   0(@06),C'2'                                         0368 01004000
         BH    @RF00368                                            0368 01005000
         LA    @06,PARMHOLD+3(SS)                                  0368 01006000
         CLI   0(@06),C'0'                                         0368 01007000
         BL    @RF00368                                            0368 01008000
         LA    @06,PARMHOLD+3(SS)                                  0368 01009000
         CLI   0(@06),C'9'                                         0368 01010000
         BH    @RF00368                                            0368 01011000
         LA    @06,PARMHOLD+2(SS)                                  0368 01012000
         CLC   0(2,@06),@CC00727                                   0368 01013000
         BH    @RF00368                                            0368 01014000
*             DO;                   /*                       @ZA16140*/ 01015000
*               PACK(DOUBLEWD,PARMHOLD(SS+3:SS+4));/*        @ZA16140*/ 01016000
         LA    @06,PARMHOLD+2(SS)                                  0370 01017000
         PACK  DOUBLEWD(8),0(2,@06)                                0370 01018000
*               CVB(SELSDG,DOUBLEWD);/*                      @ZA16140*/ 01019000
         CVB   @06,DOUBLEWD                                        0371 01020000
         STC   @06,SELSDG                                          0371 01021000
*             END;                  /*                       @ZA16140*/ 01022000
*           ELSE                                                   0373 01023000
*             DO;                   /*                       @ZA16140*/ 01024000
         B     @RC00368                                            0373 01025000
@RF00368 DS    0H                                                  0374 01026000
*               PARMERR='1'B;       /*                       @ZA16140*/ 01027000
         OI    PARMERR,B'10000000'                                 0374 01028000
*               GO TO PARMEND;      /*                       @ZA16140*/ 01029000
         B     PARMEND                                             0375 01030000
*             END;                  /*                       @ZA16140*/ 01031000
*         END;                      /*                       @ZA16140*/ 01032000
*       ELSE                                                       0378 01033000
*         DO;                       /* CHECK LIBRARY AND RWU @Y30LB40*/ 01034000
         B     @RC00366                                            0378 01035000
@RF00366 DS    0H                                                  0379 01036000
*           IF PARMHOLD(SS:SS)^='2' /* 1ST DIGIT ALWAYS 2    @OZ05079*/ 01037000
*             THEN                  /*                       @OZ05079*/ 01038000
         LA    @06,PARMHOLD-1(SS)                                  0379 01039000
         CLI   0(@06),C'2'                                         0379 01040000
         BE    @RF00379                                            0379 01041000
*             DO;                   /*                       @OZ05079*/ 01042000
*               PARMERR='1'B;       /*                       @OZ05079*/ 01043000
         OI    PARMERR,B'10000000'                                 0381 01044000
*               GO TO PARMEND;      /*                       @OZ05079*/ 01045000
         B     PARMEND                                             0382 01046000
*             END;                  /*                       @OZ05079*/ 01047000
*           IF PARMHOLD(SS+1:SS+1)='0'/* MSF = 0             @OZ05079*/ 01048000
*               |PARMHOLD(SS+1:SS+1)='1'/* MSF = 1           @OZ05079*/ 01049000
*             THEN                                                 0384 01050000
@RF00379 LA    @06,PARMHOLD(SS)                                    0384 01051000
         CLI   0(@06),C'0'                                         0384 01052000
         BE    @RT00384                                            0384 01053000
         LA    @06,PARMHOLD(SS)                                    0384 01054000
         CLI   0(@06),C'1'                                         0384 01055000
         BNE   @RF00384                                            0384 01056000
@RT00384 DS    0H                                                  0385 01057000
*             DO;                   /*                       @Y30LB40*/ 01058000
*               PACK(DOUBLEWD,PARMHOLD(SS+1:SS+1));/* LIB OK @OZ05079*/ 01059000
         LA    @06,PARMHOLD(SS)                                    0386 01060000
         PACK  DOUBLEWD(8),0(1,@06)                                0386 01061000
*               CVB(L,DOUBLEWD);    /*                       @Y30LB40*/ 01062000
         CVB   L,DOUBLEWD                                          0387 01063000
*             END;                  /*                       @Y30LB40*/ 01064000
*           ELSE                                                   0389 01065000
*             DO;                   /*                       @Y30LB40*/ 01066000
         B     @RC00384                                            0389 01067000
@RF00384 DS    0H                                                  0390 01068000
*               PARMERR='1'B;       /* LIB BAD,SET ERROR     @Y30LB40*/ 01069000
         OI    PARMERR,B'10000000'                                 0390 01070000
*               GO TO PARMEND;      /*                       @Y30LB40*/ 01071000
         B     PARMEND                                             0391 01072000
*             END;                  /*                       @Y30LB40*/ 01073000
*           IF PARMHOLD(SS+2:SS+2)>='0'/* VALID RANGE        @OZ05079*/ 01074000
*               &PARMHOLD(SS+2:SS+2)<='7'/*                  @OZ05079*/ 01075000
*             THEN                                                 0393 01076000
@RC00384 LA    @06,PARMHOLD+1(SS)                                  0393 01077000
         CLI   0(@06),C'0'                                         0393 01078000
         BL    @RF00393                                            0393 01079000
         LA    @06,PARMHOLD+1(SS)                                  0393 01080000
         CLI   0(@06),C'7'                                         0393 01081000
         BH    @RF00393                                            0393 01082000
*             DO;                   /*                       @Y30LB40*/ 01083000
*               PACK(DOUBLEWD,PARMHOLD(SS+2:SS+2));/* RWU OK @OZ05079*/ 01084000
         LA    @06,PARMHOLD+1(SS)                                  0395 01085000
         PACK  DOUBLEWD(8),0(1,@06)                                0395 01086000
*               CVB(U,DOUBLEWD);    /*                       @Y30LB40*/ 01087000
         CVB   U,DOUBLEWD                                          0396 01088000
*             END;                  /*                       @Y30LB40*/ 01089000
*           ELSE                                                   0398 01090000
*             DO;                   /*                       @Y30LB40*/ 01091000
         B     @RC00393                                            0398 01092000
@RF00393 DS    0H                                                  0399 01093000
*               PARMERR='1'B;       /* RWU BAD,SET ERROR     @Y30LB40*/ 01094000
         OI    PARMERR,B'10000000'                                 0399 01095000
*               GO TO PARMEND;      /*                       @Y30LB40*/ 01096000
         B     PARMEND                                             0400 01097000
*             END;                  /*                       @Y30LB40*/ 01098000
*         END;                      /*                       @Y30LB40*/ 01099000
@RC00393 DS    0H                                                  0403 01100000
*     END;                          /*                       @Y30LB40*/ 01101000
@RC00366 DS    0H                                                  0404 01102000
*                                                                  0404 01103000
*/********************************************************** @OZ11673*/ 01104000
*/*                                                          @OZ11673*/ 01105000
*/* PROCEDURE NAME - PARMEND (SUBSECTION WITHIN GETPARMS)    @OZ11673*/ 01106000
*/*                                                          @OZ11673*/ 01107000
*/* FUNCTION - TEST FOR ERROR INDICATOR FOR BAD SCAN OF A    @OZ11673*/ 01108000
*/*            PARAMETER.  IF ERROR WAS ENCOUNTERED, SET     @OZ11673*/ 01109000
*/*            UP ERROR MESSAGE ICG910, SET RETURN CODE TO   @OZ11673*/ 01110000
*/*            8.  IN ANY CASE, RETURN TO MAINLINE.          @OZ11673*/ 01111000
*/*                                                          @OZ11673*/ 01112000
*/********************************************************** @OZ11673*/ 01113000
*                                                                  0404 01114000
*PARMEND:                                                          0404 01115000
*   IF PARMERR='1'B                 /* WERE THERE ANY ERRORS @Y30LB40*/ 01116000
*     THEN                                                         0404 01117000
@RT00362 DS    0H                                                  0404 01118000
PARMEND  TM    PARMERR,B'10000000'                                 0404 01119000
         BNO   @RF00404                                            0404 01120000
*     DO;                           /* YES,PRINT MESSAGE     @Y30LB40*/ 01121000
*       DSLINE=PARMMSG;             /*                       @Y30LB40*/ 01122000
         MVI   DSLINE+28,C' '                                      0406 01123000
         MVC   DSLINE+29(96),DSLINE+28                             0406 01124000
         MVC   DSLINE(28),PARMMSG                                  0406 01125000
*       RFY                                                        0407 01126000
*        (R0,                                                      0407 01127000
*         R1,                                                      0407 01128000
*         R14,                                                     0407 01129000
*         R15) RSTD;                /*                       @Y30LB40*/ 01130000
*       GEN(PUT   PRNTDCB,DSLINE);  /*                       @Y30LB40*/ 01131000
         PUT   PRNTDCB,DSLINE                                           01132000
*       RFY                                                        0409 01133000
*        (R0,                                                      0409 01134000
*         R1,                                                      0409 01135000
*         R14,                                                     0409 01136000
*         R15) UNRSTD;              /*                       @Y30LB40*/ 01137000
*       RETURNCD=8;                 /* SET RC=8 AND TERMINATE      0410 01138000
*                                                            @Y30LB40*/ 01139000
         MVC   RETURNCD(2),@CH00069                                0410 01140000
*     END;                          /*                       @Y30LB40*/ 01141000
*   END GETPARMS;                   /*                       @OZ11673*/ 01142000
@EL00004 DS    0H                                                  0412 01143000
@EF00004 DS    0H                                                  0412 01144000
@ER00004 LM    @14,@06,@SA00004                                    0412 01145000
         LM    @09,@12,@SA00004+36                                 0412 01146000
         BR    @14                                                 0412 01147000
*                                                                  0413 01148000
*/********************************************************** @OZ11673*/ 01149000
*/*                                                          @OZ11673*/ 01150000
*/* PROCEDURE NAME - DSACCUM                                 @OZ11673*/ 01151000
*/*                                                          @OZ11673*/ 01152000
*/* FUNCTION - ACCUUMLATE TOTALS FROM THE DETAIL ACTIVITY    @OZ11673*/ 01153000
*/*            WITHIN A TIME SLICE FOR THE SDG               @ZA16140*/ 01154000
*/*            ACTIVITY REPORT.                              @OZ11673*/ 01155000
*/*                                                          @OZ11673*/ 01156000
*/********************************************************** @OZ11673*/ 01157000
*                                                                  0413 01158000
*DSACCUM:                                                          0413 01159000
*   PROCEDURE;                      /*                       @OZ11673*/ 01160000
DSACCUM  STM   @14,@12,@SA00005                                    0413 01161000
*   J=1;                            /* SET ARRAY POINTER     @ZA16140*/ 01162000
         LA    @06,1                                               0414 01163000
         LR    J,@06                                               0414 01164000
*   K=SDGINBIN+1;                   /* SET ARRAY POINTER     @ZA16140*/ 01165000
         SLR   K,K                                                 0415 01166000
         IC    K,SDGINBIN                                          0415 01167000
         ALR   K,@06                                               0415 01168000
*   IF K>8 THEN                                                    0416 01169000
         C     K,@CF00069                                          0416 01170000
         BNH   @RF00416                                            0416 01171000
*     K=K+1;                        /* BYPASS INDEX 9        @ZA16140*/ 01172000
         ALR   K,@06                                               0417 01173000
*   DO I=1 TO 2;                    /* ACCUM TIME SLICE AND REPORT 0418 01174000
*                                      TOTALS                @Y30LB40*/ 01175000
@RF00416 LA    I,1                                                 0418 01176000
@DL00418 DS    0H                                                  0419 01177000
*     CALL BUCKETS;                                                0419 01178000
         BAL   @14,BUCKETS                                         0419 01179000
*     DSBKT6(I,J,K)=DSBKT6(I,J,K)+MININUM;/* NUMBER OF MINI HDRS     */ 01180000
         LR    @15,I                                               0420 01181000
         ALR   @15,@15                                             0420 01182000
         ALR   @15,J                                               0420 01183000
         MH    @15,@CH00643                                        0420 01184000
         ALR   @15,K                                               0420 01185000
         SLA   @15,2                                               0420 01186000
         SLR   @14,@14                                             0420 01187000
         IC    @14,MININUM                                         0420 01188000
         AL    @14,DSBKT6-352(@15)                                 0420 01189000
         ST    @14,DSBKT6-352(@15)                                 0420 01190000
*     DSBKT7(I,J,K)=DSBKT7(I,J,K)+HITNUM;/* NUMBER OF PRELOADS       */ 01191000
         SLR   @14,@14                                             0421 01192000
         IC    @14,HITNUM                                          0421 01193000
         AL    @14,DSBKT7-352(@15)                                 0421 01194000
         ST    @14,DSBKT7-352(@15)                                 0421 01195000
*   END;                            /*                       @Y30LB40*/ 01196000
         AL    I,@CF00044                                          0422 01197000
         C     I,@CF00051                                          0422 01198000
         BNH   @DL00418                                            0422 01199000
*   END DSACCUM;                    /* GO READ NEXT RECORD   @Y30LB40*/ 01200000
@EL00005 DS    0H                                                  0423 01201000
@EF00005 DS    0H                                                  0423 01202000
@ER00005 LM    @14,@12,@SA00005                                    0423 01203000
         BR    @14                                                 0423 01204000
*                                                                  0424 01205000
*/********************************************************** @OZ11673*/ 01206000
*/*                                                          @OZ11673*/ 01207000
*/* PROCEDURE NAME - DATETIME                                @OZ11673*/ 01208000
*/*                                                          @OZ11673*/ 01209000
*/* FUNCTION - SET UP DATE AND TIME IN THE FIRST LINE OF     @OZ11673*/ 01210000
*/*            THE TIMESLICE SUMMARY FOR EITHER A STAGING    @OZ11673*/ 01211000
*/*            ADAPTER ACTIVITY REPORT OR A DATA RECORDING   @OZ11673*/ 01212000
*/*            DEVICE ACTIVITY REPORT.                       @OZ11673*/ 01213000
*/*                                                          @OZ11673*/ 01214000
*/********************************************************** @OZ11673*/ 01215000
*                                                                  0424 01216000
*DATETIME:                                                         0424 01217000
*   PROCEDURE;                      /*                       @OZ11673*/ 01218000
DATETIME STM   @14,@12,@SA00006                                    0424 01219000
*   DSLINE=' ';                     /* CLEAR PRINT LINE      @Y30LB40*/ 01220000
         MVI   DSLINE+1,C' '                                       0425 01221000
         MVC   DSLINE+2(123),DSLINE+1                              0425 01222000
         MVI   DSLINE,C' '                                         0425 01223000
*   FLD1='0';                       /*                       @OZ11673*/ 01224000
         MVI   FLD1,C'0'                                           0426 01225000
*   FLD2='  /   ';                  /*                       @OZ11673*/ 01226000
         MVC   FLD2(6),@CC00737                                    0427 01227000
*   CALL EDITFIX(ADDR(TSSYR),1,'N');/*                       @Y30LB40*/ 01228000
         MVC   @AL00001+4(8),@AL00428                              0428 01229000
         LA    @08,TSSYR                                           0428 01230000
         ST    @08,@AFTEMPS                                        0428 01231000
         LA    @08,@AFTEMPS                                        0428 01232000
         ST    @08,@AL00001                                        0428 01233000
         LA    @01,@AL00001                                        0428 01234000
         BAL   @14,EDITFIX                                         0428 01235000
*   FLD2(1:2)=FIXOUT(12:13);        /*                       @OZ11673*/ 01236000
         MVC   FLD2(2),FIXOUT+11                                   0429 01237000
*   CALL EDITFIX(ADDR(TSSDAY),2,'N');/*                      @Y30LB40*/ 01238000
         MVC   @AL00001+4(8),@AL00430                              0430 01239000
         LA    @08,TSSDAY                                          0430 01240000
         ST    @08,@AFTEMPS                                        0430 01241000
         LA    @08,@AFTEMPS                                        0430 01242000
         ST    @08,@AL00001                                        0430 01243000
         LA    @01,@AL00001                                        0430 01244000
         BAL   @14,EDITFIX                                         0430 01245000
*   FLD2(4:6)=FIXOUT(11:13);        /*                       @OZ11673*/ 01246000
         MVC   FLD2+3(3),FIXOUT+10                                 0431 01247000
*   HOUR=TSSTIME/3600;              /*                       @Y30LB40*/ 01248000
         L     @08,TSSTIME                                         0432 01249000
         LA    @15,3600                                            0432 01250000
         LR    @00,@08                                             0432 01251000
         SRDA  @00,32                                              0432 01252000
         DR    @00,@15                                             0432 01253000
         ST    @01,HOUR                                            0432 01254000
*   MINUTE=(TSSTIME-(HOUR*3600))/60;/*                       @Y30LB40*/ 01255000
         LA    @14,60                                              0433 01256000
         MR    @00,@15                                             0433 01257000
         LR    @02,@08                                             0433 01258000
         SLR   @02,@01                                             0433 01259000
         SRDA  @02,32                                              0433 01260000
         DR    @02,@14                                             0433 01261000
         ST    @03,MINUTE                                          0433 01262000
*   SECOND=TSSTIME-((HOUR*3600)+(MINUTE*60));/*              @Y30LB40*/ 01263000
         MR    @02,@14                                             0434 01264000
         ALR   @01,@03                                             0434 01265000
         SLR   @08,@01                                             0434 01266000
         ST    @08,SECOND                                          0434 01267000
*   FLD2A='  :  :  ';               /*                       @OZ11673*/ 01268000
         MVC   FLD2A(8),@CC00740                                   0435 01269000
*   CALL EDITFIX(ADDR(HOUR),4,'S'); /*                       @Y30LB40*/ 01270000
         MVC   @AL00001+4(8),@AL00436                              0436 01271000
         LA    @08,HOUR                                            0436 01272000
         ST    @08,@AFTEMPS                                        0436 01273000
         LA    @08,@AFTEMPS                                        0436 01274000
         ST    @08,@AL00001                                        0436 01275000
         LA    @01,@AL00001                                        0436 01276000
         BAL   @14,EDITFIX                                         0436 01277000
*   FLD2A(1:2)=FIXOUT(12:13);       /*                       @OZ11673*/ 01278000
         MVC   FLD2A(2),FIXOUT+11                                  0437 01279000
*   CALL EDITFIX(ADDR(MINUTE),4,'N');/*                      @Y30LB40*/ 01280000
         MVC   @AL00001+4(8),@AL00438                              0438 01281000
         LA    @08,MINUTE                                          0438 01282000
         ST    @08,@AFTEMPS                                        0438 01283000
         LA    @08,@AFTEMPS                                        0438 01284000
         ST    @08,@AL00001                                        0438 01285000
         LA    @01,@AL00001                                        0438 01286000
         BAL   @14,EDITFIX                                         0438 01287000
*   FLD2A(4:5)=FIXOUT(12:13);       /*                       @OZ11673*/ 01288000
         MVC   FLD2A+3(2),FIXOUT+11                                0439 01289000
*   CALL EDITFIX(ADDR(SECOND),4,'N');/*                      @Y30LB40*/ 01290000
         MVC   @AL00001+4(8),@AL00440                              0440 01291000
         LA    @08,SECOND                                          0440 01292000
         ST    @08,@AFTEMPS                                        0440 01293000
         LA    @08,@AFTEMPS                                        0440 01294000
         ST    @08,@AL00001                                        0440 01295000
         LA    @01,@AL00001                                        0440 01296000
         BAL   @14,EDITFIX                                         0440 01297000
*   FLD2A(7:8)=FIXOUT(12:13);       /*                       @OZ11673*/ 01298000
         MVC   FLD2A+6(2),FIXOUT+11                                0441 01299000
*   END DATETIME;                   /*                       @OZ11673*/ 01300000
@EL00006 DS    0H                                                  0442 01301000
@EF00006 DS    0H                                                  0442 01302000
@ER00006 LM    @14,@12,@SA00006                                    0442 01303000
         BR    @14                                                 0442 01304000
*                                                                  0443 01305000
*/********************************************************** @OZ11673*/ 01306000
*/*                                                          @OZ11673*/ 01307000
*/* PROCEDURE NAME - DSCTLBRK                                @OZ11673*/ 01308000
*/*                                                          @OZ11673*/ 01309000
*/* FUNCTION - PRINT ONE LINE FOR EACH STAGING ADAPTER THAT  @OZ11673*/ 01310000
*/*            HAD ACTIVITY DURING THE SELECTED TIMESLICE.   @OZ11673*/ 01311000
*/*                                                          @OZ11673*/ 01312000
*/********************************************************** @OZ11673*/ 01313000
*                                                                  0443 01314000
*DSCTLBRK:                                                         0443 01315000
*   PROCEDURE;                      /*                       @OZ11673*/ 01316000
DSCTLBRK STM   @14,@12,@SA00007                                    0443 01317000
*   ACCUMTOT=BKT5(1,1,9);           /* T-SLICE TOT STAGNG    @ZA16140*/ 01318000
         L     @08,BKT5+32                                         0444 01319000
         ST    @08,ACCUMTOT                                        0444 01320000
*   BKT5(1,1,9)=0;                  /* CLEAR TIME SLICE TOT STGNG  0445 01321000
*                                      BUCKTS                        */ 01322000
         SLR   @08,@08                                             0445 01323000
         ST    @08,BKT5+32                                         0445 01324000
*   I=1;                            /* SET I TO DETAIL BUCKETS     0446 01325000
*                                                            @Y30LB40*/ 01326000
         LA    I,1                                                 0446 01327000
*   CALL DATETIME;                  /* PRINT DATE & TIME     @OZ11673*/ 01328000
         BAL   @14,DATETIME                                        0447 01329000
*   CALL PROCDSBK;                                                 0448 01330000
         BAL   @14,PROCDSBK                                        0448 01331000
*   END DSCTLBRK;                                                  0449 01332000
@EL00007 DS    0H                                                  0449 01333000
@EF00007 DS    0H                                                  0449 01334000
@ER00007 LM    @14,@12,@SA00007                                    0449 01335000
         BR    @14                                                 0449 01336000
*                                                                  0450 01337000
*/********************************************************** @OZ11673*/ 01338000
*/*                                                          @OZ11673*/ 01339000
*/* PROCEDURE NAME - PROCDSBK                                @OZ11673*/ 01340000
*/*                                                          @OZ11673*/ 01341000
*/* FUNCTION -                                               @OZ11673*/ 01342000
*/*                                                          @OZ11673*/ 01343000
*/********************************************************** @OZ11673*/ 01344000
*                                                                  0450 01345000
*PROCDSBK:                                                         0450 01346000
*   PROCEDURE;                                                     0450 01347000
PROCDSBK STM   @14,@12,@SA00008                                    0450 01348000
*   J=1;                            /*                       @ZA16140*/ 01349000
         LA    @07,1                                               0451 01350000
         LR    J,@07                                               0451 01351000
*   DO K=1 TO 29;                   /* LOOP THROUGH SDGS 0 - 27    0452 01352000
*                                                            @ZA16140*/ 01353000
         LA    @15,1                                               0452 01354000
         LR    K,@15                                               0452 01355000
@DL00452 DS    0H                                                  0453 01356000
*     IF LINECNT>55 THEN                                           0453 01357000
         LH    @15,LINECNT                                         0453 01358000
         C     @15,@CF00749                                        0453 01359000
         BNH   @RF00453                                            0453 01360000
*       DO;                         /* SKIP TO A NEW PAGE    @Y30LB40*/ 01361000
*         LINECNT=5;                /* RESET LINE COUNT      @Y30LB40*/ 01362000
         MVC   LINECNT(2),@CH00372                                 0455 01363000
*         PAGECNT=PAGECNT+1;        /* UP PAGE COUNTER       @Y30LB40*/ 01364000
         LA    @15,1                                               0456 01365000
         AL    @15,PAGECNT                                         0456 01366000
         ST    @15,PAGECNT                                         0456 01367000
*         HEADHOLD=HDNG1;           /*                       @Y30LB40*/ 01368000
         MVC   HEADHOLD(121),HDNG1                                 0457 01369000
*         CALL EDITFIX(ADDR(PAGECNT),4,'S');/*               @Y30LB40*/ 01370000
         MVC   @AL00001+4(8),@AL00458                              0458 01371000
         LA    @15,PAGECNT                                         0458 01372000
         ST    @15,@AFTEMPS+4                                      0458 01373000
         LA    @15,@AFTEMPS+4                                      0458 01374000
         ST    @15,@AL00001                                        0458 01375000
         LA    @01,@AL00001                                        0458 01376000
         BAL   @14,EDITFIX                                         0458 01377000
*         HEADHOLD(118:121)=FIXOUT(10:13);/*                 @Y30LB40*/ 01378000
         MVC   HEADHOLD+117(4),FIXOUT+9                            0459 01379000
*         HEADHOLD(107:111)=TODAY;  /*                       @Y30LB40*/ 01380000
         MVC   HEADHOLD+106(5),TODAY                               0460 01381000
*         RFY                                                      0461 01382000
*          (R0,                                                    0461 01383000
*           R1,                                                    0461 01384000
*           R14,                                                   0461 01385000
*           R15) RSTD;              /*                       @Y30LB40*/ 01386000
*         GEN(PUT   PRNTDCB,HEADHOLD);/* PRINT REPORT HEADLINES      */ 01387000
         PUT   PRNTDCB,HEADHOLD                                         01388000
*         GEN(PUT   PRNTDCB,HDNG2); /*                       @Y30LB40*/ 01389000
         PUT   PRNTDCB,HDNG2                                            01390000
*         GEN(PUT   PRNTDCB,HDNG3); /*                       @Y30LB40*/ 01391000
         PUT   PRNTDCB,HDNG3                                            01392000
*         GEN(PUT   PRNTDCB,SPACE1);/*                       @Y30LB40*/ 01393000
         PUT   PRNTDCB,SPACE1                                           01394000
*         RFY                                                      0466 01395000
*          (R0,                                                    0466 01396000
*           R1,                                                    0466 01397000
*           R14,                                                   0466 01398000
*           R15) UNRSTD;            /*                       @Y30LB40*/ 01399000
*         FLD1=' ';                 /*                       @Y30LB40*/ 01400000
         MVI   FLD1,C' '                                           0467 01401000
*       END;                        /*                       @Y30LB40*/ 01402000
*     IF(K^=9&BKT5(I,J,K)^=0) THEN                                 0469 01403000
@RF00453 LA    @15,9                                               0469 01404000
         CR    K,@15                                               0469 01405000
         BE    @RF00469                                            0469 01406000
         LR    @14,I                                               0469 01407000
         ALR   @14,@14                                             0469 01408000
         ALR   @14,J                                               0469 01409000
         MH    @14,@CH00643                                        0469 01410000
         ALR   @14,K                                               0469 01411000
         SLA   @14,2                                               0469 01412000
         L     @14,BKT5-352(@14)                                   0469 01413000
         LTR   @14,@14                                             0469 01414000
         BZ    @RF00469                                            0469 01415000
*       DO;                         /*                       @ZA16140*/ 01416000
*         IF K>9 THEN                                              0471 01417000
         CR    K,@15                                               0471 01418000
         BNH   @RF00471                                            0471 01419000
*           CALCFLD=K-2;            /* GET SDG NO.           @ZA16140*/ 01420000
         LR    @15,K                                               0472 01421000
         BCTR  @15,0                                               0472 01422000
         BCTR  @15,0                                               0472 01423000
         ST    @15,CALCFLD                                         0472 01424000
*         ELSE                                                     0473 01425000
*           CALCFLD=K-1;            /* GET SDG NO.           @ZA16140*/ 01426000
         B     @RC00471                                            0473 01427000
@RF00471 LR    @15,K                                               0473 01428000
         BCTR  @15,0                                               0473 01429000
         ST    @15,CALCFLD                                         0473 01430000
*         CALL EDITFIX(ADDR(CALCFLD),4,'N');/* EDIT SDG      @ZA16140*/ 01431000
@RC00471 MVC   @AL00001+4(8),@AL00474                              0474 01432000
         LA    @15,CALCFLD                                         0474 01433000
         ST    @15,@AFTEMPS+4                                      0474 01434000
         LA    @15,@AFTEMPS+4                                      0474 01435000
         ST    @15,@AL00001                                        0474 01436000
         LA    @01,@AL00001                                        0474 01437000
         BAL   @14,EDITFIX                                         0474 01438000
*         SDGFLD=FIXOUT(12:13);     /*                       @ZA16140*/ 01439000
         MVC   SDGFLD(2),FIXOUT+11                                 0475 01440000
*         IF DSBKT6(I,J,K)^=0 THEN                                 0476 01441000
         LR    @15,I                                               0476 01442000
         ALR   @15,@15                                             0476 01443000
         ALR   @15,J                                               0476 01444000
         MH    @15,@CH00643                                        0476 01445000
         ALR   @15,K                                               0476 01446000
         SLA   @15,2                                               0476 01447000
         L     @14,DSBKT6-352(@15)                                 0476 01448000
         LTR   @14,@14                                             0476 01449000
         BZ    @RF00476                                            0476 01450000
*           DO;                     /* CALC PRELOAD PERCENT          */ 01451000
*             CALCFLD=DSBKT7(I,J,K)*1000;/*                  @Y30LB40*/ 01452000
         L     @03,DSBKT7-352(@15)                                 0478 01453000
         MH    @03,@CH00753                                        0478 01454000
         ST    @03,CALCFLD                                         0478 01455000
*             CALCFLD2=DSBKT6(I,J,K);/*                      @Y30LB40*/ 01456000
         LR    CALCFLD2,@14                                        0479 01457000
*             CALCFLD=((CALCFLD/CALCFLD2)+5)/10;                   0480 01458000
         LR    @00,@03                                             0480 01459000
         SRDA  @00,32                                              0480 01460000
         DR    @00,CALCFLD2                                        0480 01461000
         LR    @04,@01                                             0480 01462000
         AL    @04,@CF00372                                        0480 01463000
         SRDA  @04,32                                              0480 01464000
         D     @04,@CF00034                                        0480 01465000
         ST    @05,CALCFLD                                         0480 01466000
*             CALL EDITFIX(ADDR(CALCFLD),4,'S');/*           @Y30LB40*/ 01467000
         MVC   @AL00001+4(8),@AL00481                              0481 01468000
         LA    @15,CALCFLD                                         0481 01469000
         ST    @15,@AFTEMPS+4                                      0481 01470000
         LA    @15,@AFTEMPS+4                                      0481 01471000
         ST    @15,@AL00001                                        0481 01472000
         LA    @01,@AL00001                                        0481 01473000
         BAL   @14,EDITFIX                                         0481 01474000
*             DSFLD18=FIXOUT(11:13);/*                       @Y30LB40*/ 01475000
         MVC   DSFLD18(3),FIXOUT+10                                0482 01476000
*           END;                    /*                       @Y30LB40*/ 01477000
*         ELSE                                                     0484 01478000
*           DSFLD18(3:3)='0';       /* PRELOAD PERCENT       @Y30LB40*/ 01479000
         B     @RC00476                                            0484 01480000
@RF00476 MVI   DSFLD18+2,C'0'                                      0484 01481000
*         DSBKT6(I,J,K)=0;          /* CLEAR MININUM BUCKET  @Y30LB40*/ 01482000
@RC00476 SLR   @15,@15                                             0485 01483000
         LR    @14,I                                               0485 01484000
         ALR   @14,@14                                             0485 01485000
         ALR   @14,J                                               0485 01486000
         MH    @14,@CH00643                                        0485 01487000
         ALR   @14,K                                               0485 01488000
         SLA   @14,2                                               0485 01489000
         ST    @15,DSBKT6-352(@14)                                 0485 01490000
*         DSBKT7(I,J,K)=0;          /* CLEAR HITNUM BUCKET   @Y30LB40*/ 01491000
         ST    @15,DSBKT7-352(@14)                                 0486 01492000
*         CALL DOCOMMON;                                           0487 01493000
         BAL   @14,DOCOMMON                                        0487 01494000
*         RFY                                                      0488 01495000
*          (R0,                                                    0488 01496000
*           R1,                                                    0488 01497000
*           R14,                                                   0488 01498000
*           R15) RSTD;              /*                       @Y30LB40*/ 01499000
*         GEN(PUT   PRNTDCB,DSLINE);/* PRINT DETAIL LINE             */ 01500000
         PUT   PRNTDCB,DSLINE                                           01501000
*         RFY                                                      0490 01502000
*          (R0,                                                    0490 01503000
*           R1,                                                    0490 01504000
*           R14,                                                   0490 01505000
*           R15) UNRSTD;            /*                       @Y30LB40*/ 01506000
*         IF FLD1='0'               /* BUMP LINECOUNT        @Y30LB40*/ 01507000
*           THEN                                                   0491 01508000
         CLI   FLD1,C'0'                                           0491 01509000
         BNE   @RF00491                                            0491 01510000
*           LINECNT=LINECNT+2;      /*                       @Y30LB40*/ 01511000
         LA    @15,2                                               0492 01512000
         AH    @15,LINECNT                                         0492 01513000
         STH   @15,LINECNT                                         0492 01514000
*         ELSE                                                     0493 01515000
*           LINECNT=LINECNT+1;      /*                       @Y30LB40*/ 01516000
         B     @RC00491                                            0493 01517000
@RF00491 LA    @15,1                                               0493 01518000
         AH    @15,LINECNT                                         0493 01519000
         STH   @15,LINECNT                                         0493 01520000
*         FLD1=' ';                 /* CLEAR CONSTANT INFO   @Y30LB40*/ 01521000
@RC00491 MVI   FLD1,C' '                                           0494 01522000
*         FLD2=' ';                 /*                       @Y30LB40*/ 01523000
         MVI   FLD2+1,C' '                                         0495 01524000
         MVC   FLD2+2(4),FLD2+1                                    0495 01525000
         MVI   FLD2,C' '                                           0495 01526000
*         FLD2A=' ';                /*                       @Y30LB40*/ 01527000
         MVI   FLD2A+1,C' '                                        0496 01528000
         MVC   FLD2A+2(6),FLD2A+1                                  0496 01529000
         MVI   FLD2A,C' '                                          0496 01530000
*       END;                        /*                       @Y30LB40*/ 01531000
*   END;                            /*                       @Y30LB40*/ 01532000
@RF00469 AL    K,@CF00044                                          0498 01533000
         C     K,@CF00643                                          0498 01534000
         BNH   @DL00452                                            0498 01535000
*   END PROCDSBK;                   /*                       @OZ11673*/ 01536000
@EL00008 DS    0H                                                  0499 01537000
@EF00008 DS    0H                                                  0499 01538000
@ER00008 LM    @14,@12,@SA00008                                    0499 01539000
         BR    @14                                                 0499 01540000
*                                                                  0500 01541000
*/********************************************************** @OZ11673*/ 01542000
*/*                                                          @OZ11673*/ 01543000
*/* PROCEDURE NAME - TESTEOF                                 @OZ11673*/ 01544000
*/*                                                          @OZ11673*/ 01545000
*/* FUNCTION - IF THE LAST RECORD HAS BEEN ENCOUNTERED,      @OZ11673*/ 01546000
*/*            FIRST WRITE TOTALS FOR THE REPORT TYPE, AND   @OZ11673*/ 01547000
*/*            THEN WRITE COMMON JOB-END TOTALS.             @OZ11673*/ 01548000
*/*                                                          @OZ11673*/ 01549000
*/********************************************************** @OZ11673*/ 01550000
*                                                                  0500 01551000
*TESTEOF:                                                          0500 01552000
*   PROCEDURE;                      /*                       @OZ11673*/ 01553000
TESTEOF  STM   @14,@05,@SA00009                                    0500 01554000
         STM   @07,@12,@SA00009+32                                 0500 01555000
*   RFY                                                            0501 01556000
*    (R0,                                                          0501 01557000
*     R1,                                                          0501 01558000
*     R14,                                                         0501 01559000
*     R15) RSTD;                    /*                       @Y30LB40*/ 01560000
*   GEN(PUT   PRNTDCB,SPACE1);      /* SKIP A LINE           @Y30LB40*/ 01561000
         PUT   PRNTDCB,SPACE1                                           01562000
*   RFY                                                            0503 01563000
*    (R0,                                                          0503 01564000
*     R1,                                                          0503 01565000
*     R14,                                                         0503 01566000
*     R15) UNRSTD;                  /*                       @Y30LB40*/ 01567000
*   LINECNT=LINECNT+1;              /*                       @Y30LB40*/ 01568000
         LA    @08,1                                               0504 01569000
         AH    @08,LINECNT                                         0504 01570000
         STH   @08,LINECNT                                         0504 01571000
*   I=2;                            /* INDICATE REPORT TOTALS WANTED */ 01572000
         LA    I,2                                                 0505 01573000
*   DSLINE=' ';                     /*                       @Y30LB40*/ 01574000
         MVI   DSLINE+1,C' '                                       0506 01575000
         MVC   DSLINE+2(123),DSLINE+1                              0506 01576000
         MVI   DSLINE,C' '                                         0506 01577000
*   FLD2='TOTALS';                  /* SETUP CONSTANT INFO   @OZ11673*/ 01578000
         MVC   FLD2(6),@CC00758                                    0507 01579000
*   IF PARMSW='R' THEN                                             0508 01580000
         CLI   PARMSW,C'R'                                         0508 01581000
         BNE   @RF00508                                            0508 01582000
*     ACCUMTOT=BKT5(2,1,9)+BKT5(2,2,9);/*                    @OZ11673*/ 01583000
         L     @08,BKT5+264                                        0509 01584000
         AL    @08,BKT5+380                                        0509 01585000
         ST    @08,ACCUMTOT                                        0509 01586000
*   ELSE                                                           0510 01587000
*     ACCUMTOT=BKT5(2,1,9);         /*                       @ZA16140*/ 01588000
         B     @RC00508                                            0510 01589000
@RF00508 L     @08,BKT5+264                                        0510 01590000
         ST    @08,ACCUMTOT                                        0510 01591000
*   IF PARMSW='R'                   /*                       @OZ11673*/ 01592000
*     THEN                          /*                       @OZ11673*/ 01593000
@RC00508 CLI   PARMSW,C'R'                                         0511 01594000
         BNE   @RF00511                                            0511 01595000
*     CALL PROCRWBK;                /*                       @OZ11673*/ 01596000
         BAL   @14,PROCRWBK                                        0512 01597000
*   ELSE                            /*                       @OZ11673*/ 01598000
*     CALL PROCDSBK;                /* WRITE REPORT TOTALS   @OZ11673*/ 01599000
         B     @RC00511                                            0513 01600000
@RF00511 BAL   @14,PROCDSBK                                        0513 01601000
*   END TESTEOF;                    /* NEXT SLICE PERIOD     @OZ11673*/ 01602000
@EL00009 DS    0H                                                  0514 01603000
@EF00009 DS    0H                                                  0514 01604000
@ER00009 LM    @14,@05,@SA00009                                    0514 01605000
         LM    @07,@12,@SA00009+32                                 0514 01606000
         BR    @14                                                 0514 01607000
*                                                                  0515 01608000
*/********************************************************** @OZ11673*/ 01609000
*/*                                                          @OZ11673*/ 01610000
*/* PROCEDURE NAME - GETSLICE                                @OZ11673*/ 01611000
*/*                                                          @OZ11673*/ 01612000
*/* FUNCTION - BUMP THE TIMESLICE COMPARE VALUE UNTIL THE    @OZ11673*/ 01613000
*/*            CURRENT TIME IN THE DETAIL RECORD FALLS       @OZ11673*/ 01614000
*/*            WITHIN THE TIMESLICE RANGE.                   @OZ11673*/ 01615000
*/*                                                          @OZ11673*/ 01616000
*/********************************************************** @OZ11673*/ 01617000
*                                                                  0515 01618000
*GETSLICE:                                                         0515 01619000
*   PROCEDURE;                      /*                       @OZ11673*/ 01620000
GETSLICE STM   @14,@12,12(@13)                                     0515 01621000
*   DO WHILE(CKTIME>TSEND);         /* SETUP NEXT TIME SLICE INTERVAL*/ 01622000
         B     @DE00516                                            0516 01623000
@DL00516 DS    0H                                                  0517 01624000
*     TSBEG=TSEND;                  /*                       @Y30LB40*/ 01625000
         MVC   TSBEG(7),TSEND                                      0517 01626000
*     TSETIME=TSETIME+TIMESL;       /*                       @Y30LB40*/ 01627000
         L     @08,TSETIME                                         0518 01628000
         AL    @08,TIMESL                                          0518 01629000
         ST    @08,TSETIME                                         0518 01630000
*     IF TSETIME>86399 THEN                                        0519 01631000
         C     @08,@CF00705                                        0519 01632000
         BNH   @RF00519                                            0519 01633000
*       DO;                         /*                       @Y30LB40*/ 01634000
*         TSETIME=TSETIME-86400;    /*                       @Y30LB40*/ 01635000
         SL    @08,@CF00763                                        0521 01636000
         ST    @08,TSETIME                                         0521 01637000
*         TSEDAY=TSEDAY+1;          /*                       @Y30LB40*/ 01638000
         LA    @08,1                                               0522 01639000
         LH    @15,TSEDAY                                          0522 01640000
         ALR   @15,@08                                             0522 01641000
         STH   @15,TSEDAY                                          0522 01642000
*         IF TSEDAY>365 THEN                                       0523 01643000
         C     @15,@CF00704                                        0523 01644000
         BNH   @RF00523                                            0523 01645000
*           DO;                     /*                       @Y30LB40*/ 01646000
*             IF(TSEND(1:1)&'00000011'B)='00000000'B THEN          0525 01647000
         MVC   @TS00001(1),TSEND                                   0525 01648000
         NI    @TS00001,B'00000011'                                0525 01649000
         CLI   @TS00001,B'00000000'                                0525 01650000
         BNE   @RF00525                                            0525 01651000
*               IF TSEDAY>366 THEN                                 0526 01652000
         LA    @14,366                                             0526 01653000
         CR    @15,@14                                             0526 01654000
         BNH   @RF00526                                            0526 01655000
*                 DO;               /*                       @Y30LB40*/ 01656000
*                   TSEDAY=TSEDAY-366;/*                     @Y30LB40*/ 01657000
         SLR   @15,@14                                             0528 01658000
         STH   @15,TSEDAY                                          0528 01659000
*                   TSEYR=TSEYR+1;  /*                       @Y30LB40*/ 01660000
         SLR   @15,@15                                             0529 01661000
         IC    @15,TSEYR                                           0529 01662000
         ALR   @08,@15                                             0529 01663000
         STC   @08,TSEYR                                           0529 01664000
*                 END;              /*                       @Y30LB40*/ 01665000
*               ELSE                                               0531 01666000
*                 ;                 /*                       @Y30LB40*/ 01667000
@RF00526 DS    0H                                                  0532 01668000
*             ELSE                                                 0532 01669000
*               DO;                 /*                       @Y30LB40*/ 01670000
         B     @RC00525                                            0532 01671000
@RF00525 DS    0H                                                  0533 01672000
*                 TSEDAY=TSEDAY-365;/*                       @Y30LB40*/ 01673000
         LH    @08,TSEDAY                                          0533 01674000
         SL    @08,@CF00704                                        0533 01675000
         STH   @08,TSEDAY                                          0533 01676000
*                 TSEYR=TSEYR+1;    /*                       @Y30LB40*/ 01677000
         LA    @08,1                                               0534 01678000
         SLR   @15,@15                                             0534 01679000
         IC    @15,TSEYR                                           0534 01680000
         ALR   @08,@15                                             0534 01681000
         STC   @08,TSEYR                                           0534 01682000
*               END;                /*                       @Y30LB40*/ 01683000
*           END;                    /*                       @Y30LB40*/ 01684000
@RC00525 DS    0H                                                  0537 01685000
*       END;                        /*                       @Y30LB40*/ 01686000
@RF00523 DS    0H                                                  0538 01687000
*   END;                            /*                       @Y30LB40*/ 01688000
@RF00519 DS    0H                                                  0538 01689000
@DE00516 CLC   CKTIME(7),TSEND                                     0538 01690000
         BH    @DL00516                                            0538 01691000
*   END GETSLICE;                   /*                       @OZ11673*/ 01692000
@EL00010 DS    0H                                                  0539 01693000
@EF00010 DS    0H                                                  0539 01694000
@ER00010 LM    @14,@12,12(@13)                                     0539 01695000
         BR    @14                                                 0539 01696000
*                                                                  0540 01697000
*/********************************************************** @OZ11673*/ 01698000
*/*                                                          @OZ11673*/ 01699000
*/* PROCEDURE NAME - BUCKETS                                 @OZ11673*/ 01700000
*/*                                                          @OZ11673*/ 01701000
*/* FUNCTION - UPDATE THOSE BUCKETS THAT ARE COMMON TO BOTH  @OZ11673*/ 01702000
*/*            THE STAGING ADAPTER ACTIVITY REPORT ABD THE   @OZ11673*/ 01703000
*/*            DATA RECORDING DEVICE ACTIVITY REPORT.        @OZ11673*/ 01704000
*/*                                                          @OZ11673*/ 01705000
*/********************************************************** @OZ11673*/ 01706000
*                                                                  0540 01707000
*BUCKETS:                                                          0540 01708000
*   PROCEDURE;                      /*                       @OZ11673*/ 01709000
BUCKETS  STM   @14,@12,12(@13)                                     0540 01710000
*   BKT1(I,J,K)=BKT1(I,J,K)+STGD;   /* CYLS STAGED           @OZ11673*/ 01711000
         LR    @15,I                                               0541 01712000
         ALR   @15,@15                                             0541 01713000
         ALR   @15,J                                               0541 01714000
         LR    @14,@15                                             0541 01715000
         MH    @14,@CH00643                                        0541 01716000
         ALR   @14,K                                               0541 01717000
         SLA   @14,2                                               0541 01718000
         L     @05,STGD                                            0541 01719000
         L     @04,BKT1-352(@14)                                   0541 01720000
         ALR   @04,@05                                             0541 01721000
         ST    @04,BKT1-352(@14)                                   0541 01722000
*   BKT2(I,J,K)=BKT2(I,J,K)+CFAULT; /* C FAULT CSD           @OZ11673*/ 01723000
         L     @04,BKT2-352(@14)                                   0542 01724000
         AL    @04,CFAULT                                          0542 01725000
         ST    @04,BKT2-352(@14)                                   0542 01726000
*   BKT3(I,J,K)=BKT3(I,J,K)+DSTGD;  /* CYLS DESTAGED         @OZ11673*/ 01727000
         L     @04,DSTGD                                           0543 01728000
         L     @03,BKT3-352(@14)                                   0543 01729000
         ALR   @03,@04                                             0543 01730000
         ST    @03,BKT3-352(@14)                                   0543 01731000
*   BKT4(I,J,K)=BKT4(I,J,K)+SALLOC; /* S ALLOC CSD           @OZ11673*/ 01732000
         L     @03,BKT4-352(@14)                                   0544 01733000
         AL    @03,SALLOC                                          0544 01734000
         ST    @03,BKT4-352(@14)                                   0544 01735000
*   BKT5(I,J,K)=BKT5(I,J,K)+(STGD+DSTGD);/* TOT STAGING              */ 01736000
         ALR   @05,@04                                             0545 01737000
         L     @04,BKT5-352(@14)                                   0545 01738000
         ALR   @04,@05                                             0545 01739000
         ST    @04,BKT5-352(@14)                                   0545 01740000
*   BKT5(I,J,9)=BKT5(I,J,9)+(STGD+DSTGD);/*                  @OZ11673*/ 01741000
         MH    @15,@CH00823                                        0546 01742000
         AL    @05,BKT5-316(@15)                                   0546 01743000
         ST    @05,BKT5-316(@15)                                   0546 01744000
*   END BUCKETS;                    /*                       @OZ11673*/ 01745000
@EL00011 DS    0H                                                  0547 01746000
@EF00011 DS    0H                                                  0547 01747000
@ER00011 LM    @14,@12,12(@13)                                     0547 01748000
         BR    @14                                                 0547 01749000
*                                                                  0548 01750000
*/********************************************************** @OZ11673*/ 01751000
*/*                                                          @OZ11673*/ 01752000
*/* PROCEDURE NAME - RWACCUM                                 @OZ11673*/ 01753000
*/*                                                          @OZ11673*/ 01754000
*/* FUNCTION - ACCUMULATE TOTALS FROM DETAIL FOR DATA        @OZ11673*/ 01755000
*/*            RECORDING DEVICE ACTIVITY REPORT.             @OZ11673*/ 01756000
*/*                                                          @OZ11673*/ 01757000
*/********************************************************** @OZ11673*/ 01758000
*                                                                  0548 01759000
*RWACCUM:                                                          0548 01760000
*   PROCEDURE;                      /*                       @OZ11673*/ 01761000
RWACCUM  STM   @14,@12,@SA00012                                    0548 01762000
*   J=LIBRARY+1;                    /* ALLOW FOR LIBRARY 0   @Y30LB40*/ 01763000
         LA    @06,1                                               0549 01764000
         SLR   J,J                                                 0549 01765000
         IC    J,LIBRARY                                           0549 01766000
         ALR   J,@06                                               0549 01767000
*   K=READWRIT+1;                   /* ALLOW FOR READ/WRITE UNIT 0   */ 01768000
         SLR   K,K                                                 0550 01769000
         IC    K,READWRIT                                          0550 01770000
         ALR   @06,K                                               0550 01771000
         LR    K,@06                                               0550 01772000
*   IF K>8 THEN                                                    0551 01773000
         LA    @06,8                                               0551 01774000
         CR    K,@06                                               0551 01775000
         BNH   @RF00551                                            0551 01776000
*     K=8;                          /* SET TO MAX VALUE      @Y30LB40*/ 01777000
         LR    K,@06                                               0552 01778000
*   DO I=1 TO 2;                    /* ACCUM TIME SLICE AND REPORT 0553 01779000
*                                      TOTALS                @Y30LB40*/ 01780000
@RF00551 LA    I,1                                                 0553 01781000
@DL00553 DS    0H                                                  0554 01782000
*     CALL BUCKETS;                                                0554 01783000
         BAL   @14,BUCKETS                                         0554 01784000
*     BKT6(I,J,K)=BKT6(I,J,K)+LOADNUM;/* NO. OF LOADS                */ 01785000
         LR    @15,I                                               0555 01786000
         ALR   @15,@15                                             0555 01787000
         ALR   @15,J                                               0555 01788000
         MH    @15,@CH00643                                        0555 01789000
         ALR   @15,K                                               0555 01790000
         SLA   @15,2                                               0555 01791000
         SLR   @14,@14                                             0555 01792000
         IC    @14,LOADNUM                                         0555 01793000
         AL    @14,BKT6-352(@15)                                   0555 01794000
         ST    @14,BKT6-352(@15)                                   0555 01795000
*     BKT7(I,J,K)=BKT7(I,J,K)+LOADTIME;/* LOAD TIME          @Y30LB40*/ 01796000
         L     @14,BKT7-352(@15)                                   0556 01797000
         AL    @14,LOADTIME                                        0556 01798000
         ST    @14,BKT7-352(@15)                                   0556 01799000
*   END;                            /*                       @Y30LB40*/ 01800000
         AL    I,@CF00044                                          0557 01801000
         C     I,@CF00051                                          0557 01802000
         BNH   @DL00553                                            0557 01803000
*   END RWACCUM;                    /*                       @OZ11673*/ 01804000
@EL00012 DS    0H                                                  0558 01805000
@EF00012 DS    0H                                                  0558 01806000
@ER00012 LM    @14,@12,@SA00012                                    0558 01807000
         BR    @14                                                 0558 01808000
*                                                                  0559 01809000
*/********************************************************** @OZ11673*/ 01810000
*/*                                                          @OZ11673*/ 01811000
*/* PROCEDURE NAME - RWCTLBRK                                @OZ11673*/ 01812000
*/*                                                          @OZ11673*/ 01813000
*/********************************************************** @OZ11673*/ 01814000
*                                                                  0559 01815000
*RWCTLBRK:                                                         0559 01816000
*   PROCEDURE;                                                     0559 01817000
RWCTLBRK STM   @14,@12,@SA00013                                    0559 01818000
*   ACCUMTOT=0;                     /*                       @Y30LB40*/ 01819000
         SLR   @08,@08                                             0560 01820000
         ST    @08,ACCUMTOT                                        0560 01821000
*   DO J=1 TO 2;                    /*                       @ZA16140*/ 01822000
         LA    J,1                                                 0561 01823000
@DL00561 DS    0H                                                  0562 01824000
*     ACCUMTOT=ACCUMTOT+BKT5(1,J,9);/* TSLICE TOT STGNG              */ 01825000
         LR    @15,J                                               0562 01826000
         MH    @15,@CH00823                                        0562 01827000
         L     @14,ACCUMTOT                                        0562 01828000
         AL    @14,BKT5-84(@15)                                    0562 01829000
         ST    @14,ACCUMTOT                                        0562 01830000
*     BKT5(1,J,9)=0;                /*                       @Y30LB40*/ 01831000
         SLR   @14,@14                                             0563 01832000
         ST    @14,BKT5-84(@15)                                    0563 01833000
*   END;                            /*                       @Y30LB40*/ 01834000
         AL    J,@CF00044                                          0564 01835000
         C     J,@CF00051                                          0564 01836000
         BNH   @DL00561                                            0564 01837000
*   I=1;                            /* SET I TO DETAIL BUCKETS     0565 01838000
*                                                            @Y30LB40*/ 01839000
         LA    I,1                                                 0565 01840000
*   CALL DATETIME;                  /*                       @OZ11673*/ 01841000
         BAL   @14,DATETIME                                        0566 01842000
*   CALL PROCRWBK;                                                 0567 01843000
         BAL   @14,PROCRWBK                                        0567 01844000
*   END RWCTLBRK;                                                  0568 01845000
@EL00013 DS    0H                                                  0568 01846000
@EF00013 DS    0H                                                  0568 01847000
@ER00013 LM    @14,@12,@SA00013                                    0568 01848000
         BR    @14                                                 0568 01849000
*                                                                  0569 01850000
*/********************************************************** @OZ11673*/ 01851000
*/*                                                          @OZ11673*/ 01852000
*/* PROCEDURE NAME - PROCRWBK                                @OZ11673*/ 01853000
*/*                                                          @OZ11673*/ 01854000
*/********************************************************** @OZ11673*/ 01855000
*                                                                  0569 01856000
*PROCRWBK:                                                         0569 01857000
*   PROCEDURE;                                                     0569 01858000
PROCRWBK STM   @14,@12,@SA00014                                    0569 01859000
*   DO J=1 TO 2;                    /* LOOP THROUGH LIBRARIES      0570 01860000
*                                                            @ZA16140*/ 01861000
         LA    J,1                                                 0570 01862000
@DL00570 DS    0H                                                  0571 01863000
*     DO K=1 TO 8;                  /* LOOP THROUGH READ WRITE UNITS    01864000
*                                                            @ZA16140*/ 01865000
         LA    K,1                                                 0571 01866000
@DL00571 DS    0H                                                  0572 01867000
*       IF LINECNT>55 THEN                                         0572 01868000
         LH    @15,LINECNT                                         0572 01869000
         C     @15,@CF00749                                        0572 01870000
         BNH   @RF00572                                            0572 01871000
*         DO;                       /* SKIP TO A NEW PAGE    @Y30LB40*/ 01872000
*           LINECNT=5;              /* RESET LINE COUNT      @Y30LB40*/ 01873000
         MVC   LINECNT(2),@CH00372                                 0574 01874000
*           PAGECNT=PAGECNT+1;      /* UP PAGE COUNTER       @Y30LB40*/ 01875000
         LA    @15,1                                               0575 01876000
         AL    @15,PAGECNT                                         0575 01877000
         ST    @15,PAGECNT                                         0575 01878000
*           HEADHOLD=HDNGA;         /*                       @Y30LB40*/ 01879000
         MVC   HEADHOLD(121),HDNGA                                 0576 01880000
*           CALL EDITFIX(ADDR(PAGECNT),4,'S');/*             @Y30LB40*/ 01881000
         MVC   @AL00001+4(8),@AL00577                              0577 01882000
         LA    @15,PAGECNT                                         0577 01883000
         ST    @15,@AFTEMPS+8                                      0577 01884000
         LA    @15,@AFTEMPS+8                                      0577 01885000
         ST    @15,@AL00001                                        0577 01886000
         LA    @01,@AL00001                                        0577 01887000
         BAL   @14,EDITFIX                                         0577 01888000
*           HEADHOLD(118:121)=FIXOUT(10:13);/*               @Y30LB40*/ 01889000
         MVC   HEADHOLD+117(4),FIXOUT+9                            0578 01890000
*           HEADHOLD(107:111)=TODAY;/*                       @Y30LB40*/ 01891000
         MVC   HEADHOLD+106(5),TODAY                               0579 01892000
*           RFY                                                    0580 01893000
*            (R0,                                                  0580 01894000
*             R1,                                                  0580 01895000
*             R14,                                                 0580 01896000
*             R15) RSTD;            /*                       @Y30LB40*/ 01897000
*           GEN(PUT   PRNTDCB,HEADHOLD);/* PRINT REPORT HEADLINES    */ 01898000
         PUT   PRNTDCB,HEADHOLD                                         01899000
*           GEN(PUT   PRNTDCB,HDNGB);/*                      @Y30LB40*/ 01900000
         PUT   PRNTDCB,HDNGB                                            01901000
*           GEN(PUT   PRNTDCB,HDNGC);/*                      @Y30LB40*/ 01902000
         PUT   PRNTDCB,HDNGC                                            01903000
*           GEN(PUT   PRNTDCB,SPACE1);/*                     @Y30LB40*/ 01904000
         PUT   PRNTDCB,SPACE1                                           01905000
*           RFY                                                    0585 01906000
*            (R0,                                                  0585 01907000
*             R1,                                                  0585 01908000
*             R14,                                                 0585 01909000
*             R15) UNRSTD;          /*                       @Y30LB40*/ 01910000
*           FLD1=' ';               /*                       @Y30LB40*/ 01911000
         MVI   FLD1,C' '                                           0586 01912000
*         END;                      /*                       @Y30LB40*/ 01913000
*       IF BKT5(I,J,K)^=0 THEN                                     0588 01914000
@RF00572 LR    @15,I                                               0588 01915000
         ALR   @15,@15                                             0588 01916000
         ALR   @15,J                                               0588 01917000
         MH    @15,@CH00643                                        0588 01918000
         ALR   @15,K                                               0588 01919000
         SLA   @15,2                                               0588 01920000
         L     @15,BKT5-352(@15)                                   0588 01921000
         LTR   @15,@15                                             0588 01922000
         BZ    @RF00588                                            0588 01923000
*         DO;                       /* PROCESS ALL NON 0 BUCKETS     */ 01924000
*           RWFLD4=SSIDEQ(J);       /* 2ND INDEX = MSF       @OZ05079*/ 01925000
         LA    @01,SSIDEQ-1(J)                                     0590 01926000
         MVC   RWFLD4(1),0(@01)                                    0590 01927000
*           CHAR2='2';              /* ALWAYS 2 FOR DRD      @OZ05079*/ 01928000
         MVI   CHAR2,C'2'                                          0591 01929000
*           DRDMSFID=SSIDEQ(J);     /* 2ND CHAR = MSF        @OZ05079*/ 01930000
         LA    @01,SSIDEQ-1(J)                                     0592 01931000
         MVC   DRDMSFID(1),0(@01)                                  0592 01932000
*           RWFLD6=SSIDEQ(K);       /* PHYSICAL DRD          @OZ05079*/ 01933000
         LA    @01,SSIDEQ-1(K)                                     0593 01934000
         MVC   RWFLD6(1),0(@01)                                    0593 01935000
*           CALL DOCOMMON;          /*                       @OZ11673*/ 01936000
         BAL   @14,DOCOMMON                                        0594 01937000
*           CALL EDITFIX(ADDR(BKT6(I,J,K)),4,'E');/*         @OZ11673*/ 01938000
         MVC   @AL00001+4(8),@AL00595                              0595 01939000
         LR    @15,I                                               0595 01940000
         ALR   @15,@15                                             0595 01941000
         ALR   @15,J                                               0595 01942000
         MH    @15,@CH00643                                        0595 01943000
         ALR   @15,K                                               0595 01944000
         SLA   @15,2                                               0595 01945000
         LA    @15,BKT6-352(@15)                                   0595 01946000
         ST    @15,@AFTEMPS+8                                      0595 01947000
         LA    @15,@AFTEMPS+8                                      0595 01948000
         ST    @15,@AL00001                                        0595 01949000
         LA    @01,@AL00001                                        0595 01950000
         BAL   @14,EDITFIX                                         0595 01951000
*           RWFLD18=FIXOUT(8:13);   /* NO. OF CARTRIDGE LOADS        */ 01952000
         MVC   RWFLD18(6),FIXOUT+7                                 0596 01953000
*           BKT7(I,J,K)=BKT7(I,J,K)/4;/* LOAD TIME TO SECS           */ 01954000
         LR    @15,I                                               0597 01955000
         ALR   @15,@15                                             0597 01956000
         ALR   @15,J                                               0597 01957000
         MH    @15,@CH00643                                        0597 01958000
         ALR   @15,K                                               0597 01959000
         SLA   @15,2                                               0597 01960000
         L     @00,BKT7-352(@15)                                   0597 01961000
         SRDA  @00,32                                              0597 01962000
         D     @00,@CF00104                                        0597 01963000
         ST    @01,BKT7-352(@15)                                   0597 01964000
*           CALL EDITFIX(ADDR(BKT7(I,J,K)),4,'E');/*         @OZ11673*/ 01965000
         MVC   @AL00001+4(8),@AL00598                              0598 01966000
         LA    @15,BKT7-352(@15)                                   0598 01967000
         ST    @15,@AFTEMPS+8                                      0598 01968000
         LA    @15,@AFTEMPS+8                                      0598 01969000
         ST    @15,@AL00001                                        0598 01970000
         LA    @01,@AL00001                                        0598 01971000
         BAL   @14,EDITFIX                                         0598 01972000
*           RWFLD20=FIXOUT(8:13);   /* LOAD TIME             @Y30LB40*/ 01973000
         MVC   RWFLD20(6),FIXOUT+7                                 0599 01974000
*           IF BKT6(I,J,K)>0 THEN                                  0600 01975000
         LR    @15,I                                               0600 01976000
         ALR   @15,@15                                             0600 01977000
         ALR   @15,J                                               0600 01978000
         MH    @15,@CH00643                                        0600 01979000
         ALR   @15,K                                               0600 01980000
         SLA   @15,2                                               0600 01981000
         L     @14,BKT6-352(@15)                                   0600 01982000
         LTR   @14,@14                                             0600 01983000
         BNP   @RF00600                                            0600 01984000
*             DO;                   /*                       @OZ11673*/ 01985000
*               CALCFLD=(BKT7(I,J,K)/BKT6(I,J,K));/* C RATE          */ 01986000
         L     @00,BKT7-352(@15)                                   0602 01987000
         SRDA  @00,32                                              0602 01988000
         DR    @00,@14                                             0602 01989000
         ST    @01,CALCFLD                                         0602 01990000
*               CALL EDITFIX(ADDR(CALCFLD),4,'E');/*         @OZ11673*/ 01991000
         MVC   @AL00001+4(8),@AL00603                              0603 01992000
         LA    @15,CALCFLD                                         0603 01993000
         ST    @15,@AFTEMPS+8                                      0603 01994000
         LA    @15,@AFTEMPS+8                                      0603 01995000
         ST    @15,@AL00001                                        0603 01996000
         LA    @01,@AL00001                                        0603 01997000
         BAL   @14,EDITFIX                                         0603 01998000
*               RWFLD22=FIXOUT(8:13);/* C RATE               @Y30LB40*/ 01999000
         MVC   RWFLD22(6),FIXOUT+7                                 0604 02000000
*             END;                  /*                       @Y30LB40*/ 02001000
*           ELSE                                                   0606 02002000
*             RWFLD22(6:6)='0';     /*                       @Y30LB40*/ 02003000
         B     @RC00600                                            0606 02004000
@RF00600 MVI   RWFLD22+5,C'0'                                      0606 02005000
*           BKT6(I,J,K)=0;          /*                       @OZ11673*/ 02006000
@RC00600 SLR   @15,@15                                             0607 02007000
         LR    @14,I                                               0607 02008000
         ALR   @14,@14                                             0607 02009000
         ALR   @14,J                                               0607 02010000
         MH    @14,@CH00643                                        0607 02011000
         ALR   @14,K                                               0607 02012000
         SLA   @14,2                                               0607 02013000
         ST    @15,BKT6-352(@14)                                   0607 02014000
*           BKT7(I,J,K)=0;          /*                       @OZ11673*/ 02015000
         ST    @15,BKT7-352(@14)                                   0608 02016000
*           RFY                                                    0609 02017000
*            (R0,                                                  0609 02018000
*             R1,                                                  0609 02019000
*             R14,                                                 0609 02020000
*             R15) RSTD;            /*                       @Y30LB40*/ 02021000
*           GEN(PUT   PRNTDCB,DSLINE);/* PRINT DETAIL PRINT LINE     */ 02022000
         PUT   PRNTDCB,DSLINE                                           02023000
*           RFY                                                    0611 02024000
*            (R0,                                                  0611 02025000
*             R1,                                                  0611 02026000
*             R14,                                                 0611 02027000
*             R15) UNRSTD;          /*                       @Y30LB40*/ 02028000
*           IF FLD1='0'             /* BUMP LINE COUNT       @OZ11673*/ 02029000
*             THEN                                                 0612 02030000
         CLI   FLD1,C'0'                                           0612 02031000
         BNE   @RF00612                                            0612 02032000
*             LINECNT=LINECNT+2;    /*                       @Y30LB40*/ 02033000
         LA    @15,2                                               0613 02034000
         AH    @15,LINECNT                                         0613 02035000
         STH   @15,LINECNT                                         0613 02036000
*           ELSE                                                   0614 02037000
*             LINECNT=LINECNT+1;    /*                       @Y30LB40*/ 02038000
         B     @RC00612                                            0614 02039000
@RF00612 LA    @15,1                                               0614 02040000
         AH    @15,LINECNT                                         0614 02041000
         STH   @15,LINECNT                                         0614 02042000
*           FLD1=' ';               /*                       @OZ11673*/ 02043000
@RC00612 MVI   FLD1,C' '                                           0615 02044000
*           FLD2=' ';               /* CLEAR CONSTANT INFO   @OZ11673*/ 02045000
         MVI   FLD2+1,C' '                                         0616 02046000
         MVC   FLD2+2(4),FLD2+1                                    0616 02047000
         MVI   FLD2,C' '                                           0616 02048000
*           FLD2A=' ';              /*                       @OZ11673*/ 02049000
         MVI   FLD2A+1,C' '                                        0617 02050000
         MVC   FLD2A+2(6),FLD2A+1                                  0617 02051000
         MVI   FLD2A,C' '                                          0617 02052000
*         END;                      /*                       @Y30LB40*/ 02053000
*       ELSE                                                       0619 02054000
*         ;                         /*                       @Y30LB40*/ 02055000
@RF00588 DS    0H                                                  0620 02056000
*     END;                          /*                       @Y30LB40*/ 02057000
         AL    K,@CF00044                                          0620 02058000
         C     K,@CF00069                                          0620 02059000
         BNH   @DL00571                                            0620 02060000
*   END;                            /*                       @Y30LB40*/ 02061000
         AL    J,@CF00044                                          0621 02062000
         C     J,@CF00051                                          0621 02063000
         BNH   @DL00570                                            0621 02064000
*   END PROCRWBK;                                                  0622 02065000
@EL00014 DS    0H                                                  0622 02066000
@EF00014 DS    0H                                                  0622 02067000
@ER00014 LM    @14,@12,@SA00014                                    0622 02068000
         BR    @14                                                 0622 02069000
*                                                                  0623 02070000
*/********************************************************** @OZ11673*/ 02071000
*/*                                                          @OZ11673*/ 02072000
*/* PROCEDURE NAME - DOCOMMON                                @OZ11673*/ 02073000
*/*                                                          @OZ11673*/ 02074000
*/* FUNCTION - SET UP PRINT FOR BUCKETS THAT ARE COMMON TO   @OZ11673*/ 02075000
*/*            BOTH THE STAGING ADAPTER ACTIVITY REPORT AND  @OZ11673*/ 02076000
*/*            THE DATA RECORDING DEVICE ACTIVITY REPORT.    @OZ11673*/ 02077000
*/*                                                          @OZ11673*/ 02078000
*/********************************************************** @OZ11673*/ 02079000
*                                                                  0623 02080000
*DOCOMMON:                                                         0623 02081000
*   PROCEDURE;                      /*                       @OZ11673*/ 02082000
DOCOMMON STM   @14,@12,@SA00015                                    0623 02083000
*   CALL EDITFIX(ADDR(BKT1(I,J,K)),4,'E');/*                 @OZ11673*/ 02084000
         MVC   @AL00001+4(8),@AL00624                              0624 02085000
         LR    @15,I                                               0624 02086000
         ALR   @15,@15                                             0624 02087000
         ALR   @15,J                                               0624 02088000
         MH    @15,@CH00643                                        0624 02089000
         ALR   @15,K                                               0624 02090000
         SLA   @15,2                                               0624 02091000
         LA    @15,BKT1-352(@15)                                   0624 02092000
         ST    @15,@AFTEMPS+12                                     0624 02093000
         LA    @15,@AFTEMPS+12                                     0624 02094000
         ST    @15,@AL00001                                        0624 02095000
         LA    @01,@AL00001                                        0624 02096000
         BAL   @14,EDITFIX                                         0624 02097000
*   FLD8=FIXOUT(3:13);              /* CYLINDERS STAGED      @OZ11673*/ 02098000
         MVC   FLD8(11),FIXOUT+2                                   0625 02099000
*   BKT1(I,J,K)=0;                  /* CLEAR CYLS STAGED     @OZ11673*/ 02100000
         LR    @15,I                                               0626 02101000
         ALR   @15,@15                                             0626 02102000
         ALR   @15,J                                               0626 02103000
         MH    @15,@CH00643                                        0626 02104000
         ALR   @15,K                                               0626 02105000
         SLA   @15,2                                               0626 02106000
         SLR   @14,@14                                             0626 02107000
         ST    @14,BKT1-352(@15)                                   0626 02108000
*   CALL EDITFIX(ADDR(BKT2(I,J,K)),4,'E');/*                 @OZ11673*/ 02109000
         MVC   @AL00001+4(8),@AL00627                              0627 02110000
         LA    @15,BKT2-352(@15)                                   0627 02111000
         ST    @15,@AFTEMPS+12                                     0627 02112000
         LA    @15,@AFTEMPS+12                                     0627 02113000
         ST    @15,@AL00001                                        0627 02114000
         LA    @01,@AL00001                                        0627 02115000
         BAL   @14,EDITFIX                                         0627 02116000
*   FLD9=FIXOUT(3:13);              /* CYL FAULT CAUSED      @OZ11673*/ 02117000
         MVC   FLD9(11),FIXOUT+2                                   0628 02118000
*   BKT2(I,J,K)=0;                  /* CLEAR CYL FAULT CAUSED      0629 02119000
*                                                            @OZ11673*/ 02120000
         LR    @15,I                                               0629 02121000
         ALR   @15,@15                                             0629 02122000
         ALR   @15,J                                               0629 02123000
         MH    @15,@CH00643                                        0629 02124000
         ALR   @15,K                                               0629 02125000
         SLA   @15,2                                               0629 02126000
         SLR   @14,@14                                             0629 02127000
         ST    @14,BKT2-352(@15)                                   0629 02128000
*   CALL EDITFIX(ADDR(BKT3(I,J,K)),4,'E');/*                 @OZ11673*/ 02129000
         MVC   @AL00001+4(8),@AL00630                              0630 02130000
         LA    @15,BKT3-352(@15)                                   0630 02131000
         ST    @15,@AFTEMPS+12                                     0630 02132000
         LA    @15,@AFTEMPS+12                                     0630 02133000
         ST    @15,@AL00001                                        0630 02134000
         LA    @01,@AL00001                                        0630 02135000
         BAL   @14,EDITFIX                                         0630 02136000
*   FLD11=FIXOUT(3:13);             /* CYLINDERS DESTAGED    @OZ11673*/ 02137000
         MVC   FLD11(11),FIXOUT+2                                  0631 02138000
*   BKT3(I,J,K)=0;                  /* CLEAR CYLS DESTAGED   @OZ11673*/ 02139000
         LR    @15,I                                               0632 02140000
         ALR   @15,@15                                             0632 02141000
         ALR   @15,J                                               0632 02142000
         MH    @15,@CH00643                                        0632 02143000
         ALR   @15,K                                               0632 02144000
         SLA   @15,2                                               0632 02145000
         SLR   @14,@14                                             0632 02146000
         ST    @14,BKT3-352(@15)                                   0632 02147000
*   CALL EDITFIX(ADDR(BKT4(I,J,K)),4,'E');/*                 @OZ11673*/ 02148000
         MVC   @AL00001+4(8),@AL00633                              0633 02149000
         LA    @15,BKT4-352(@15)                                   0633 02150000
         ST    @15,@AFTEMPS+12                                     0633 02151000
         LA    @15,@AFTEMPS+12                                     0633 02152000
         ST    @15,@AL00001                                        0633 02153000
         LA    @01,@AL00001                                        0633 02154000
         BAL   @14,EDITFIX                                         0633 02155000
*   FLD12=FIXOUT(3:13);             /* SPACE ALLOC CAUSED    @OZ11673*/ 02156000
         MVC   FLD12(11),FIXOUT+2                                  0634 02157000
*   BKT4(I,J,K)=0;                  /* CLEAR SPACE ALLOC     @OZ11673*/ 02158000
         LR    @15,I                                               0635 02159000
         ALR   @15,@15                                             0635 02160000
         ALR   @15,J                                               0635 02161000
         MH    @15,@CH00643                                        0635 02162000
         ALR   @15,K                                               0635 02163000
         SLA   @15,2                                               0635 02164000
         SLR   @14,@14                                             0635 02165000
         ST    @14,BKT4-352(@15)                                   0635 02166000
*   CALL EDITFIX(ADDR(BKT5(I,J,K)),4,'E');/*                 @OZ11673*/ 02167000
         MVC   @AL00001+4(8),@AL00636                              0636 02168000
         LA    @15,BKT5-352(@15)                                   0636 02169000
         ST    @15,@AFTEMPS+12                                     0636 02170000
         LA    @15,@AFTEMPS+12                                     0636 02171000
         ST    @15,@AL00001                                        0636 02172000
         LA    @01,@AL00001                                        0636 02173000
         BAL   @14,EDITFIX                                         0636 02174000
*   FLD14=FIXOUT(3:13);             /* TOTAL STAGING ACTIVITY      0637 02175000
*                                                            @OZ11673*/ 02176000
         MVC   FLD14(11),FIXOUT+2                                  0637 02177000
*   CALCFLD=BKT5(I,J,K)*1000;       /*                       @OZ11673*/ 02178000
         LR    @15,I                                               0638 02179000
         ALR   @15,@15                                             0638 02180000
         ALR   @15,J                                               0638 02181000
         MH    @15,@CH00643                                        0638 02182000
         ALR   @15,K                                               0638 02183000
         SLA   @15,2                                               0638 02184000
         L     @15,BKT5-352(@15)                                   0638 02185000
         MH    @15,@CH00753                                        0638 02186000
         ST    @15,CALCFLD                                         0638 02187000
*   CALCFLD=((CALCFLD/ACCUMTOT)+5)/10;/*                     @OZ11673*/ 02188000
         LR    @00,@15                                             0639 02189000
         SRDA  @00,32                                              0639 02190000
         D     @00,ACCUMTOT                                        0639 02191000
         LR    @02,@01                                             0639 02192000
         AL    @02,@CF00372                                        0639 02193000
         SRDA  @02,32                                              0639 02194000
         D     @02,@CF00034                                        0639 02195000
         ST    @03,CALCFLD                                         0639 02196000
*   CALL EDITFIX(ADDR(CALCFLD),4,'S');/*                     @OZ11673*/ 02197000
         MVC   @AL00001+4(8),@AL00640                              0640 02198000
         LA    @15,CALCFLD                                         0640 02199000
         ST    @15,@AFTEMPS+12                                     0640 02200000
         LA    @15,@AFTEMPS+12                                     0640 02201000
         ST    @15,@AL00001                                        0640 02202000
         LA    @01,@AL00001                                        0640 02203000
         BAL   @14,EDITFIX                                         0640 02204000
*   FLD16=FIXOUT(11:13);            /* TIME SLICE PERCENT    @OZ11673*/ 02205000
         MVC   FLD16(3),FIXOUT+10                                  0641 02206000
*   BKT5(I,J,K)=0;                  /* CLEAR TOT STAGING     @OZ11673*/ 02207000
         LR    @15,I                                               0642 02208000
         ALR   @15,@15                                             0642 02209000
         ALR   @15,J                                               0642 02210000
         MH    @15,@CH00643                                        0642 02211000
         ALR   @15,K                                               0642 02212000
         SLA   @15,2                                               0642 02213000
         SLR   @14,@14                                             0642 02214000
         ST    @14,BKT5-352(@15)                                   0642 02215000
*   END DOCOMMON;                   /*                       @OZ11673*/ 02216000
@EL00015 DS    0H                                                  0643 02217000
@EF00015 DS    0H                                                  0643 02218000
@ER00015 LM    @14,@12,@SA00015                                    0643 02219000
         BR    @14                                                 0643 02220000
*EOF:                               /* END OF FILE FOUND     @Y30LB40*/ 02221000
*   EOFSW='1'B;                     /* INDICATE END OF FILE HIT    0644 02222000
*                                                            @Y30LB40*/ 02223000
EOF      OI    EOFSW,B'10000000'                                   0644 02224000
*   GO TO CHECKEOF;                                                0645 02225000
         B     CHECKEOF                                            0645 02226000
*                                                                  0646 02227000
*/********************************************************************  02228000
*                                                                    */ 02229000
*/* END OF JOB, CLOSE FILES, PROCESSING COMPLETE.            @Y30LB40*/ 02230000
*/********************************************************************  02231000
*                                                                    */ 02232000
*                                                                  0646 02233000
*EOJ:                                                              0646 02234000
*   PROCEDURE;                                                     0646 02235000
EOJ      STM   @14,@12,@SA00016                                    0646 02236000
*   DSLINE=RCDTOTAL;                /*                       @Y30LB40*/ 02237000
         MVI   DSLINE+121,C' '                                     0647 02238000
         MVC   DSLINE+122(3),DSLINE+121                            0647 02239000
         MVC   DSLINE(121),RCDTOTAL                                0647 02240000
*   DSLINE(16:16)=PARMSW;           /*                       @Y30LB40*/ 02241000
         MVC   DSLINE+15(1),PARMSW                                 0648 02242000
*   TIMESL=TIMESL/60;               /*                       @Y30LB40*/ 02243000
         L     @00,TIMESL                                          0649 02244000
         SRDA  @00,32                                              0649 02245000
         D     @00,@CF00335                                        0649 02246000
         ST    @01,TIMESL                                          0649 02247000
*   CALL EDITFIX(ADDR(TIMESL),4,'S');/*                      @Y30LB40*/ 02248000
         MVC   @AL00001+4(8),@AL00650                              0650 02249000
         LA    @06,TIMESL                                          0650 02250000
         ST    @06,@AFTEMPS+16                                     0650 02251000
         LA    @06,@AFTEMPS+16                                     0650 02252000
         ST    @06,@AL00001                                        0650 02253000
         LA    @01,@AL00001                                        0650 02254000
         BAL   @14,EDITFIX                                         0650 02255000
*   DSLINE(29:31)=FIXOUT(11:13);    /*                       @Y30LB40*/ 02256000
         MVC   DSLINE+28(3),FIXOUT+10                              0651 02257000
*   CALL EDITFIX(ADDR(HLDSYR),1,'N');/*                      @Y30LB40*/ 02258000
         MVC   @AL00001+4(8),@AL00652                              0652 02259000
         LA    @06,HLDSYR                                          0652 02260000
         ST    @06,@AFTEMPS+16                                     0652 02261000
         LA    @06,@AFTEMPS+16                                     0652 02262000
         ST    @06,@AL00001                                        0652 02263000
         LA    @01,@AL00001                                        0652 02264000
         BAL   @14,EDITFIX                                         0652 02265000
*   DSLINE(42:43)=FIXOUT(12:13);    /*                       @Y30LB40*/ 02266000
         MVC   DSLINE+41(2),FIXOUT+11                              0653 02267000
*   CALL EDITFIX(ADDR(HLDSDAY),2,'N');/*                     @Y30LB40*/ 02268000
         MVC   @AL00001+4(8),@AL00654                              0654 02269000
         LA    @06,HLDSDAY                                         0654 02270000
         ST    @06,@AFTEMPS+16                                     0654 02271000
         LA    @06,@AFTEMPS+16                                     0654 02272000
         ST    @06,@AL00001                                        0654 02273000
         LA    @01,@AL00001                                        0654 02274000
         BAL   @14,EDITFIX                                         0654 02275000
*   DSLINE(44:46)=FIXOUT(11:13);    /*                       @Y30LB40*/ 02276000
         MVC   DSLINE+43(3),FIXOUT+10                              0655 02277000
*   CALL EDITFIX(ADDR(HLDEYR),1,'N');/*                      @Y30LB40*/ 02278000
         MVC   @AL00001+4(8),@AL00656                              0656 02279000
         LA    @06,HLDEYR                                          0656 02280000
         ST    @06,@AFTEMPS+16                                     0656 02281000
         LA    @06,@AFTEMPS+16                                     0656 02282000
         ST    @06,@AL00001                                        0656 02283000
         LA    @01,@AL00001                                        0656 02284000
         BAL   @14,EDITFIX                                         0656 02285000
*   DSLINE(48:49)=FIXOUT(12:13);    /*                       @Y30LB40*/ 02286000
         MVC   DSLINE+47(2),FIXOUT+11                              0657 02287000
*   CALL EDITFIX(ADDR(HLDEDAY),2,'N');/*                     @Y30LB40*/ 02288000
         MVC   @AL00001+4(8),@AL00658                              0658 02289000
         LA    @06,HLDEDAY                                         0658 02290000
         ST    @06,@AFTEMPS+16                                     0658 02291000
         LA    @06,@AFTEMPS+16                                     0658 02292000
         ST    @06,@AL00001                                        0658 02293000
         LA    @01,@AL00001                                        0658 02294000
         BAL   @14,EDITFIX                                         0658 02295000
*   DSLINE(50:52)=FIXOUT(11:13);    /*                       @Y30LB40*/ 02296000
         MVC   DSLINE+49(3),FIXOUT+10                              0659 02297000
*   HOUR=HLDSTIME/3600;             /*                       @Y30LB40*/ 02298000
         L     @06,HLDSTIME                                        0660 02299000
         LA    @15,3600                                            0660 02300000
         LR    @00,@06                                             0660 02301000
         SRDA  @00,32                                              0660 02302000
         DR    @00,@15                                             0660 02303000
         ST    @01,HOUR                                            0660 02304000
*   MINUTE=(HLDSTIME-(HOUR*3600))/60;/*                      @Y30LB40*/ 02305000
         MR    @00,@15                                             0661 02306000
         LR    @02,@06                                             0661 02307000
         SLR   @02,@01                                             0661 02308000
         SRDA  @02,32                                              0661 02309000
         D     @02,@CF00335                                        0661 02310000
         ST    @03,MINUTE                                          0661 02311000
*   CALL EDITFIX(ADDR(HOUR),4,'N'); /*                       @Y30LB40*/ 02312000
         MVC   @AL00001+4(8),@AL00662                              0662 02313000
         LA    @06,HOUR                                            0662 02314000
         ST    @06,@AFTEMPS+16                                     0662 02315000
         LA    @06,@AFTEMPS+16                                     0662 02316000
         ST    @06,@AL00001                                        0662 02317000
         LA    @01,@AL00001                                        0662 02318000
         BAL   @14,EDITFIX                                         0662 02319000
*   DSLINE(63:64)=FIXOUT(12:13);    /*                       @Y30LB40*/ 02320000
         MVC   DSLINE+62(2),FIXOUT+11                              0663 02321000
*   CALL EDITFIX(ADDR(MINUTE),4,'N');/*                      @Y30LB40*/ 02322000
         MVC   @AL00001+4(8),@AL00664                              0664 02323000
         LA    @06,MINUTE                                          0664 02324000
         ST    @06,@AFTEMPS+16                                     0664 02325000
         LA    @06,@AFTEMPS+16                                     0664 02326000
         ST    @06,@AL00001                                        0664 02327000
         LA    @01,@AL00001                                        0664 02328000
         BAL   @14,EDITFIX                                         0664 02329000
*   DSLINE(65:66)=FIXOUT(12:13);    /*                       @Y30LB40*/ 02330000
         MVC   DSLINE+64(2),FIXOUT+11                              0665 02331000
*   HOUR=HLDETIME/3600;             /*                       @Y30LB40*/ 02332000
         L     @06,HLDETIME                                        0666 02333000
         LA    @15,3600                                            0666 02334000
         LR    @00,@06                                             0666 02335000
         SRDA  @00,32                                              0666 02336000
         DR    @00,@15                                             0666 02337000
         ST    @01,HOUR                                            0666 02338000
*   MINUTE=(HLDETIME-(HOUR*3600))/60;/*                      @Y30LB40*/ 02339000
         MR    @00,@15                                             0667 02340000
         LR    @02,@06                                             0667 02341000
         SLR   @02,@01                                             0667 02342000
         SRDA  @02,32                                              0667 02343000
         D     @02,@CF00335                                        0667 02344000
         ST    @03,MINUTE                                          0667 02345000
*   CALL EDITFIX(ADDR(HOUR),4,'N'); /*                       @Y30LB40*/ 02346000
         MVC   @AL00001+4(8),@AL00668                              0668 02347000
         LA    @06,HOUR                                            0668 02348000
         ST    @06,@AFTEMPS+16                                     0668 02349000
         LA    @06,@AFTEMPS+16                                     0668 02350000
         ST    @06,@AL00001                                        0668 02351000
         LA    @01,@AL00001                                        0668 02352000
         BAL   @14,EDITFIX                                         0668 02353000
*   DSLINE(68:69)=FIXOUT(12:13);    /*                       @Y30LB40*/ 02354000
         MVC   DSLINE+67(2),FIXOUT+11                              0669 02355000
*   CALL EDITFIX(ADDR(MINUTE),4,'N');/*                      @Y30LB40*/ 02356000
         MVC   @AL00001+4(8),@AL00670                              0670 02357000
         LA    @06,MINUTE                                          0670 02358000
         ST    @06,@AFTEMPS+16                                     0670 02359000
         LA    @06,@AFTEMPS+16                                     0670 02360000
         ST    @06,@AL00001                                        0670 02361000
         LA    @01,@AL00001                                        0670 02362000
         BAL   @14,EDITFIX                                         0670 02363000
*   DSLINE(70:71)=FIXOUT(12:13);    /*                       @Y30LB40*/ 02364000
         MVC   DSLINE+69(2),FIXOUT+11                              0671 02365000
*   IF SELECTSW='1'B                /* PRINT THE SDG OR LU IF      0672 02366000
*                                      SELECTSW ON           @ZA16140*/ 02367000
*     THEN                                                         0672 02368000
         TM    SELECTSW,B'10000000'                                0672 02369000
         BNO   @RF00672                                            0672 02370000
*     IF PARMSW='D' THEN                                           0673 02371000
         CLI   PARMSW,C'D'                                         0673 02372000
         BNE   @RF00673                                            0673 02373000
*       DO;                         /*                       @Y30LB40*/ 02374000
*         DSLINE(73:80)='SDGXX   '; /*                       @ZA16140*/ 02375000
         MVC   DSLINE+72(8),@CC00795                               0675 02376000
*         CALL EDITFIX(ADDR(SELSDG),1,'N');/*                @ZA16140*/ 02377000
         MVC   @AL00001+4(8),@AL00676                              0676 02378000
         LA    @08,SELSDG                                          0676 02379000
         ST    @08,@AFTEMPS+16                                     0676 02380000
         LA    @08,@AFTEMPS+16                                     0676 02381000
         ST    @08,@AL00001                                        0676 02382000
         LA    @01,@AL00001                                        0676 02383000
         BAL   @14,EDITFIX                                         0676 02384000
*         DSLINE(76:77)=FIXOUT(12:13);/*                     @ZA16140*/ 02385000
         MVC   DSLINE+75(2),FIXOUT+11                              0677 02386000
*       END;                        /*                       @Y30LB40*/ 02387000
*     ELSE                                                         0679 02388000
*       DO;                         /*                       @Y30LB40*/ 02389000
         B     @RC00673                                            0679 02390000
@RF00673 DS    0H                                                  0680 02391000
*         DSLINE(78:78)='2';        /*                       @OZ05079*/ 02392000
         MVI   DSLINE+77,C'2'                                      0680 02393000
*         DSLINE(79:79)=SSIDEQ(L+1);/*                       @OZ05079*/ 02394000
         LA    @06,SSIDEQ(L)                                       0681 02395000
         MVC   DSLINE+78(1),0(@06)                                 0681 02396000
*         DSLINE(80:80)=SSIDEQ(U+1);/*                       @OZ05079*/ 02397000
         LA    @01,SSIDEQ(U)                                       0682 02398000
         MVC   DSLINE+79(1),0(@01)                                 0682 02399000
*       END;                        /*                       @Y30LB40*/ 02400000
*   ELSE                                                           0684 02401000
*     DSLINE(73:80)='       ';      /*                       @OZ05079*/ 02402000
         B     @RC00672                                            0684 02403000
@RF00672 MVI   DSLINE+79,C' '                                      0684 02404000
         MVC   DSLINE+72(7),@CC00800                               0684 02405000
*   CALL EDITFIX(ADDR(RCDCOUNT),4,'S');/*                    @Y30LB40*/ 02406000
@RC00672 MVC   @AL00001+4(8),@AL00685                              0685 02407000
         LA    @08,RCDCOUNT                                        0685 02408000
         ST    @08,@AFTEMPS+16                                     0685 02409000
         LA    @08,@AFTEMPS+16                                     0685 02410000
         ST    @08,@AL00001                                        0685 02411000
         LA    @01,@AL00001                                        0685 02412000
         BAL   @14,EDITFIX                                         0685 02413000
*   DSLINE(108:113)=FIXOUT(8:13);   /*                       @Y30LB40*/ 02414000
         MVC   DSLINE+107(6),FIXOUT+7                              0686 02415000
*   RFY                                                            0687 02416000
*    (R0,                                                          0687 02417000
*     R1,                                                          0687 02418000
*     R14,                                                         0687 02419000
*     R15) RSTD;                    /*                       @Y30LB40*/ 02420000
*   GEN(PUT   PRNTDCB,DSLINE);      /* PRINT PARM LINE       @Y30LB40*/ 02421000
         PUT   PRNTDCB,DSLINE                                           02422000
*   RFY                                                            0689 02423000
*    (R0,                                                          0689 02424000
*     R1,                                                          0689 02425000
*     R14,                                                         0689 02426000
*     R15) UNRSTD;                  /*                       @Y30LB40*/ 02427000
*   END EOJ;                                                       0690 02428000
@EL00016 DS    0H                                                  0690 02429000
@EF00016 DS    0H                                                  0690 02430000
@ER00016 LM    @14,@12,@SA00016                                    0690 02431000
         BR    @14                                                 0690 02432000
*                                                                  0691 02433000
*/********************************************************************  02434000
*                                                                    */ 02435000
*/* EDITFIX IS CALLED TO CONVERT BINARY FIELDS INTO CHARACTER FORM   */ 02436000
*/* FOR PRINTING. IT IS CALLED WITH THE FOLLOWING PARAMETERS -       */ 02437000
*/*   1. FIXADDR - THE ADDRESS OF THE FIELD TO BE CONVERTED  @Y30LB40*/ 02438000
*/*   2. FIXLEN - THE LENGTH OF THE FIELD TO BE CONVERTED - 1, 2, OR 4  02439000
*                                                                    */ 02440000
*/*   3. FIXOPT - THE TYPE OF EDITING OPTION DESIRED WHERE   @Y30LB40*/ 02441000
*/*               N = CONVERT TO CHARACTER, NO EDITING       @Y30LB40*/ 02442000
*/*               S = CONVERT TO CHARACTER AND ZERO SUPPRESS @Y30LB40*/ 02443000
*/*               E = CONVERT TO CHARACTER, INSERT COMMAS    @Y30LB40*/ 02444000
*/*                   TO DIVIDE HUNDREDS,THOUSANDS AND MILLIONS      */ 02445000
*/*                   AND ZERO AND COMMA SUPPRESS            @Y30LB40*/ 02446000
*/* OUTPUT IS PROVIDED IN A FIELD CALLED FIXOUT WHICH IS 13 BYTES    */ 02447000
*/* LONG.                                                    @Y30LB40*/ 02448000
*/********************************************************************  02449000
*                                                                    */ 02450000
*                                                                  0691 02451000
*EDITFIX:                                                          0691 02452000
*   PROC(FIXADDR,FIXLEN,FIXOPT) OPTIONS(SAVE);/*             @Y30LB40*/ 02453000
EDITFIX  STM   @14,@12,@SA00017                                    0691 02454000
         MVC   @PC00017(12),0(@01)                                 0691 02455000
*   DCL                                                            0692 02456000
*     FIXADDR PTR(31);              /* ADDRESS OF INPUT FIELD      0692 02457000
*                                                            @Y30LB40*/ 02458000
*   DCL                                                            0693 02459000
*     FIXLEN PTR(31);               /* LENGTH OF INPUT FIELD @Y30LB40*/ 02460000
*   DCL                                                            0694 02461000
*     FIXOPT CHAR(1);               /* EDITING OPTION DESIRED      0694 02462000
*                                                            @Y30LB40*/ 02463000
*   RFY                                                            0695 02464000
*    (R2,                                                          0695 02465000
*     R3) RSTD;                     /*                       @Y30LB40*/ 02466000
*   R2=FIXADDR;                     /*                       @Y30LB40*/ 02467000
         L     @08,@PC00017                                        0696 02468000
         L     R2,FIXADDR(,@08)                                    0696 02469000
*   R3=0;                           /*                       @Y30LB40*/ 02470000
         SLR   R3,R3                                               0697 02471000
*   IF FIXLEN=1                     /* IF LENGTH IS 1 PICKUP ONE BYTE   02472000
*                                                            @Y30LB40*/ 02473000
*     THEN                                                         0698 02474000
         L     @08,@PC00017+4                                      0698 02475000
         CLC   FIXLEN(4,@08),@CF00044                              0698 02476000
         BNE   @RF00698                                            0698 02477000
*     DO;                           /*                       @Y30LB40*/ 02478000
*       GEN(IC    R3,0(R2));        /*                       @Y30LB40*/ 02479000
         IC    R3,0(R2)                                                 02480000
*     END;                          /*                       @Y30LB40*/ 02481000
*   ELSE                                                           0702 02482000
*     IF FIXLEN=2                   /* IF LENGTH IS 2 PICKUP TWO   0702 02483000
*                                      BYTES                 @Y30LB40*/ 02484000
*       THEN                                                       0702 02485000
         B     @RC00698                                            0702 02486000
@RF00698 L     @08,@PC00017+4                                      0702 02487000
         CLC   FIXLEN(4,@08),@CF00051                              0702 02488000
         BNE   @RF00702                                            0702 02489000
*       DO;                         /*                       @Y30LB40*/ 02490000
*         GEN(LH    R3,0(R2));      /*                       @Y30LB40*/ 02491000
         LH    R3,0(R2)                                                 02492000
*       END;                        /*                       @Y30LB40*/ 02493000
*     ELSE                                                         0706 02494000
*       DO;                         /* PICKUP 4 BYTES        @Y30LB40*/ 02495000
         B     @RC00702                                            0706 02496000
@RF00702 DS    0H                                                  0707 02497000
*         GEN(L     R3,0(R2));      /*                       @Y30LB40*/ 02498000
         L     R3,0(R2)                                                 02499000
*       END;                        /*                       @Y30LB40*/ 02500000
*   GEN;                                                           0709 02501000
@RC00702 DS    0H                                                  0709 02502000
@RC00698 DS    0H                                                  0709 02503000
*                   /*CONVERT FROM BINARY TO CHARACTER      @Y30LB40*/  02504000
  CVD   R3,DOUBLEWD                                                     02505000
  OI    DOUBLEWD+7,X'0F'                                                02506000
  UNPK  FIXOUT(13),DOUBLEWD+2(6)                                        02507000
*   IF FIXOPT='N' THEN                                             0710 02508000
         L     @08,@PC00017+8                                      0710 02509000
         CLI   FIXOPT(@08),C'N'                                    0710 02510000
         BE    @RT00710                                            0710 02511000
*     GO TO EFEND;                  /* NO EDITING WANTED,GET OUT     */ 02512000
*   IF FIXOPT='S' THEN                                             0712 02513000
         CLI   FIXOPT(@08),C'S'                                    0712 02514000
         BE    @RT00712                                            0712 02515000
*     GO TO EF4;                    /* NO COMMAS WANTED,SKIP       0713 02516000
*                                      INSERTION                     */ 02517000
*   GEN;                                                           0714 02518000
*             /*INSERT COMMA DIVIDERS                       @Y30LB40*/  02519000
  MVC   FIXOUT(1),FIXOUT+3                                              02520000
  MVI   FIXOUT+1,C','                                                   02521000
  MVC   FIXOUT+2(3),FIXOUT+4                                            02522000
  MVI   FIXOUT+5,C','                                                   02523000
  MVC   FIXOUT+6(3),FIXOUT+7                                            02524000
  MVI   FIXOUT+9,C','                                                   02525000
*EF4:                               /* ZERO AND COMMA SUPPRESS     0715 02526000
*                                                            @Y30LB40*/ 02527000
*   GEN;                                                           0715 02528000
EF4      DS    0H                                                  0715 02529000
*                                                         /*@Y30LB40*/  02530000
         LA    R2,FIXOUT                                                02531000
         LA    R3,12                                                    02532000
EF5      EQU   *                                                        02533000
         CLI   0(R2),C','                                               02534000
         BE    EF6                                                      02535000
         CLI   0(R2),C'0'                                               02536000
         BNE   EFEND                                                    02537000
EF6      EQU   *                                                        02538000
         MVI   0(R2),C' '                                               02539000
         LA    R2,1(R2)                                                 02540000
         BCT   R3,EF5                                                   02541000
*EFEND:                                                            0716 02542000
*   RFY                                                            0716 02543000
*    (R2,                                                          0716 02544000
*     R3) UNRSTD;                   /*                       @Y30LB40*/ 02545000
*   END EDITFIX;                    /*                       @Y30LB40*/ 02546000
@EL00017 DS    0H                                                  0717 02547000
@EF00017 DS    0H                                                  0717 02548000
@ER00017 LM    @14,@12,@SA00017                                    0717 02549000
         BR    @14                                                 0717 02550000
*                                                                  0718 02551000
*/********************************************************** @OZ05124*/ 02552000
*/* SYNAD EXIT FOR TRACEIN, TAKEN FOR READ ERRORS.           @OZ05124*/ 02553000
*/********************************************************** @OZ05124*/ 02554000
*                                                                  0718 02555000
*READERR:                                                          0718 02556000
*   ;                               /*                       @OZ05124*/ 02557000
READERR  DS    0H                                                  0719 02558000
*   GEN(SYNADAF ACSMETH=QSAM);      /*                       @OZ05124*/ 02559000
         SYNADAF ACSMETH=QSAM                                           02560000
*   GEN(MVC   PRNTLINE+30(79),49(R1));/*                     @OZ05124*/ 02561000
         MVC   PRNTLINE+30(79),49(R1)                                   02562000
*   PRNTLINE(1:30)=ICGTR904;        /*                       @OZ05124*/ 02563000
         MVC   PRNTLINE(30),ICGTR904                               0721 02564000
*   SAVE14=R14;                     /*                       @OZ09522*/ 02565000
         LR    SAVE14,R14                                          0722 02566000
*   RFY                                                            0723 02567000
*    (R0,                                                          0723 02568000
*     R1,                                                          0723 02569000
*     R14,                                                         0723 02570000
*     R15) RSTD;                    /*                       @OZ05124*/ 02571000
*   GEN(PUT PRNTDCB,PRNTLINE);      /*                       @OZ05124*/ 02572000
         PUT PRNTDCB,PRNTLINE                                           02573000
*   RFY                                                            0725 02574000
*    (R0,                                                          0725 02575000
*     R1,                                                          0725 02576000
*     R14,                                                         0725 02577000
*     R15) UNRSTD;                  /*                       @OZ05124*/ 02578000
*   R14=SAVE14;                     /*                       @OZ09522*/ 02579000
         LR    R14,SAVE14                                          0726 02580000
*   GEN(SYNADRLS);                  /*                       @OZ05124*/ 02581000
         SYNADRLS                                                       02582000
*   RETURNCD=4;                     /*                       @OZ05124*/ 02583000
         MVC   RETURNCD(2),@CH00104                                0728 02584000
*   GEN(BR    R14);                 /* RETURN TO IOS         @OZ05124*/ 02585000
         BR    R14                                                      02586000
*   END ICGTRSUM                    /*                       @Y30LB40*/ 02587000
*                                                                  0730 02588000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 02589000
*/*%INCLUDE SYSLIB  (IHADCBDF)                                       */ 02590000
*/*%INCLUDE SYSLIB  (IHADCB  )                                       */ 02591000
*                                                                  0730 02592000
*       ;                                                          0730 02593000
@EL00001 L     @13,4(,@13)                                         0730 02594000
@EF00001 L     @00,@SIZDATD                                        0730 02595000
         LR    @01,@10                                             0730 02596000
         FREEMAIN R,LV=(0),A=(1)                                        02597000
@ER00001 LM    @14,@12,12(@13)                                     0730 02598000
         BR    @14                                                 0730 02599000
@DATA    DS    0H                                                       02600000
@CH00701 DC    H'56'                                                    02601000
@CH00823 DC    H'116'                                                   02602000
@CH00753 DC    H'1000'                                                  02603000
@CH00724 DC    H'3600'                                                  02604000
@SM00832 MVC   PARMHOLD(0),PARMS(PARMPTR)                               02605000
         DS    0F                                                       02606000
@AL00428 EQU   *                       LIST WITH   2 ARGUMENT(S)        02607000
@AL00652 EQU   *                       LIST WITH   2 ARGUMENT(S)        02608000
@AL00656 EQU   *                       LIST WITH   2 ARGUMENT(S)        02609000
@AL00676 DC    A(@CF00044)             LIST WITH   2 ARGUMENT(S)        02610000
         DC    A(@CC00739)                                              02611000
@AL00430 EQU   *                       LIST WITH   2 ARGUMENT(S)        02612000
@AL00654 EQU   *                       LIST WITH   2 ARGUMENT(S)        02613000
@AL00658 DC    A(@CF00051)             LIST WITH   2 ARGUMENT(S)        02614000
         DC    A(@CC00739)                                              02615000
@AL00436 EQU   *                       LIST WITH   2 ARGUMENT(S)        02616000
@AL00458 EQU   *                       LIST WITH   2 ARGUMENT(S)        02617000
@AL00481 EQU   *                       LIST WITH   2 ARGUMENT(S)        02618000
@AL00577 EQU   *                       LIST WITH   2 ARGUMENT(S)        02619000
@AL00640 EQU   *                       LIST WITH   2 ARGUMENT(S)        02620000
@AL00650 EQU   *                       LIST WITH   2 ARGUMENT(S)        02621000
@AL00685 DC    A(@CF00104)             LIST WITH   2 ARGUMENT(S)        02622000
         DC    A(@CC00741)                                              02623000
@AL00438 EQU   *                       LIST WITH   2 ARGUMENT(S)        02624000
@AL00440 EQU   *                       LIST WITH   2 ARGUMENT(S)        02625000
@AL00474 EQU   *                       LIST WITH   2 ARGUMENT(S)        02626000
@AL00662 EQU   *                       LIST WITH   2 ARGUMENT(S)        02627000
@AL00664 EQU   *                       LIST WITH   2 ARGUMENT(S)        02628000
@AL00668 EQU   *                       LIST WITH   2 ARGUMENT(S)        02629000
@AL00670 DC    A(@CF00104)             LIST WITH   2 ARGUMENT(S)        02630000
         DC    A(@CC00739)                                              02631000
@AL00595 EQU   *                       LIST WITH   2 ARGUMENT(S)        02632000
@AL00598 EQU   *                       LIST WITH   2 ARGUMENT(S)        02633000
@AL00603 EQU   *                       LIST WITH   2 ARGUMENT(S)        02634000
@AL00624 EQU   *                       LIST WITH   2 ARGUMENT(S)        02635000
@AL00627 EQU   *                       LIST WITH   2 ARGUMENT(S)        02636000
@AL00630 EQU   *                       LIST WITH   2 ARGUMENT(S)        02637000
@AL00633 EQU   *                       LIST WITH   2 ARGUMENT(S)        02638000
@AL00636 DC    A(@CF00104)             LIST WITH   2 ARGUMENT(S)        02639000
         DC    A(@CC00668)                                              02640000
@DATD    DSECT                                                          02641000
         DS    0F                                                       02642000
@SA00001 DS    18F                                                      02643000
@SA00003 DS    15F                                                      02644000
@SA00004 DS    13F                                                      02645000
@SA00013 DS    15F                                                      02646000
@SA00007 DS    15F                                                      02647000
@SA00009 DS    14F                                                      02648000
@SA00016 DS    15F                                                      02649000
@SA00012 DS    15F                                                      02650000
@SA00005 DS    15F                                                      02651000
@SA00006 DS    15F                                                      02652000
@SA00017 DS    15F                                                      02653000
@PC00017 DS    3F                                                       02654000
@SA00008 DS    15F                                                      02655000
@SA00015 DS    15F                                                      02656000
@SA00014 DS    15F                                                      02657000
@AL00001 DS    3A                                                       02658000
@AFTEMPS DS    5F                                                       02659000
ICGTRSUM CSECT                                                          02660000
         DS    0F                                                       02661000
@CF00044 DC    F'1'                                                     02662000
@CF00051 DC    F'2'                                                     02663000
@CF00104 DC    F'4'                                                     02664000
@CH00104 EQU   @CF00104+2                                               02665000
@CF00372 DC    F'5'                                                     02666000
@CH00372 EQU   @CF00372+2                                               02667000
@CF00069 DC    F'8'                                                     02668000
@CH00069 EQU   @CF00069+2                                               02669000
@CF00035 DC    F'9'                                                     02670000
@CF00034 DC    F'10'                                                    02671000
@CF00033 DC    F'11'                                                    02672000
@CF00723 DC    F'23'                                                    02673000
@CF00643 DC    F'29'                                                    02674000
@CH00643 EQU   @CF00643+2                                               02675000
@CF00067 DC    F'31'                                                    02676000
@CF00749 DC    F'55'                                                    02677000
@CF00725 DC    F'59'                                                    02678000
@CF00335 DC    F'60'                                                    02679000
@CH00335 EQU   @CF00335+2                                               02680000
@CF00704 DC    F'365'                                                   02681000
@CH00704 EQU   @CF00704+2                                               02682000
@CF00720 DC    F'366'                                                   02683000
@CH00720 EQU   @CF00720+2                                               02684000
@CF00700 DC    F'600'                                                   02685000
@CF00705 DC    F'86399'                                                 02686000
@CF00763 DC    F'86400'                                                 02687000
@DATD    DSECT                                                          02688000
         DS    0D                                                       02689000
DCBPTR   DS    A                                                        02690000
RCDCOUNT DS    F                                                        02691000
PAGECNT  DS    F                                                        02692000
OPENCLOS DS    FL4                                                      02693000
         ORG   OPENCLOS                                                 02694000
OPCLB1   DS    BL1                                                      02695000
OPCLB234 DS    CL3                                                      02696000
         ORG   OPENCLOS+4                                               02697000
TIMESL   DS    F                                                        02698000
HOUR     DS    F                                                        02699000
MINUTE   DS    F                                                        02700000
SECOND   DS    F                                                        02701000
ACCUMTOT DS    F                                                        02702000
CALCFLD  DS    F                                                        02703000
LINECNT  DS    H                                                        02704000
RETURNCD DS    H                                                        02705000
SAINDEX  DS    H                                                        02706000
SELSDG   DS    FL1                                                      02707000
@TS00001 DS    CL1                                                      02708000
RCDIN    DS    CL72                                                     02709000
         ORG   RCDIN                                                    02710000
STGD     DS    FL4                                                      02711000
CFAULT   DS    FL4                                                      02712000
SYSSGTM  DS    FL4                                                      02713000
DEVSGTM  DS    FL4                                                      02714000
DSTGD    DS    FL4                                                      02715000
SALLOC   DS    FL4                                                      02716000
SYSDSTM  DS    FL4                                                      02717000
DEVDSTM  DS    FL4                                                      02718000
BUSYTIME DS    FL4                                                      02719000
LOADTIME DS    FL4                                                      02720000
LOADNUM  DS    FL1                                                      02721000
CKTIME   DS    CL7                                                      02722000
         ORG   CKTIME                                                   02723000
SVEYEAR  DS    FL1                                                      02724000
SVEJUL   DS    FL2                                                      02725000
SVETIME  DS    FL4                                                      02726000
         ORG   RCDIN+48                                                 02727000
PAGES    DS    FL1                                                      02728000
MININUM  DS    FL1                                                      02729000
HITNUM   DS    FL1                                                      02730000
STGDNUM  DS    FL1                                                      02731000
DSTGDNUM DS    FL1                                                      02732000
VTOCSTG  DS    FL1                                                      02733000
VTOCDSTG DS    FL1                                                      02734000
LIBRARY  DS    FL1                                                      02735000
DSPORT   DS    FL1                                                      02736000
DSCU     DS    FL1                                                      02737000
Z        DS    FL1                                                      02738000
Y        DS    FL1                                                      02739000
X        DS    FL1                                                      02740000
CARTPAIR DS    FL1                                                      02741000
READWRIT DS    FL1                                                      02742000
VOLID    DS    CL6                                                      02743000
CHARDRC  DS    CL1                                                      02744000
SDGINBIN DS    FL1                                                      02745000
@NM00030 DS    CL1                                                      02746000
         ORG   RCDIN+72                                                 02747000
DSLINE   DS    CL125                                                    02748000
         ORG   DSLINE                                                   02749000
FLD1     DS    CL1                                                      02750000
FLD2     DS    CL6                                                      02751000
@NM00031 DS    CL1                                                      02752000
FLD2A    DS    CL8                                                      02753000
@NM00032 DS    CL2                                                      02754000
RWFLD4   DS    CL1                                                      02755000
@NM00033 DS    CL1                                                      02756000
SDGID    DS    CL3                                                      02757000
         ORG   SDGID                                                    02758000
@NM00034 DS    CL1                                                      02759000
SDGFLD   DS    CL2                                                      02760000
         ORG   DSLINE+23                                                02761000
@NM00035 DS    CL1                                                      02762000
FLD8     DS    CL11                                                     02763000
@NM00036 DS    CL1                                                      02764000
FLD9     DS    CL11                                                     02765000
@NM00037 DS    CL1                                                      02766000
FLD11    DS    CL11                                                     02767000
@NM00038 DS    CL2                                                      02768000
FLD12    DS    CL11                                                     02769000
@NM00039 DS    CL2                                                      02770000
FLD14    DS    CL11                                                     02771000
@NM00040 DS    CL6                                                      02772000
FLD16    DS    CL3                                                      02773000
@NM00041 DS    CL7                                                      02774000
DSFLD18  DS    CL3                                                      02775000
@NM00042 DS    CL21                                                     02776000
         ORG   DSLINE+125                                               02777000
SPACE1   DS    CL121                                                    02778000
HEADHOLD DS    CL121                                                    02779000
PRNTLINE DS    CL121                                                    02780000
PRNTDCB  DS    CL100                                                    02781000
INDCB    DS    CL100                                                    02782000
STARTTIM DS    CL16                                                     02783000
         ORG   STARTTIM                                                 02784000
@NM00073 DS    CL1                                                      02785000
CKSTIME  DS    CL7                                                      02786000
         ORG   CKSTIME                                                  02787000
HLDSYR   DS    FL1                                                      02788000
HLDSDAY  DS    FL2                                                      02789000
HLDSTIME DS    FL4                                                      02790000
         ORG   STARTTIM+8                                               02791000
@NM00074 DS    CL1                                                      02792000
CKETIME  DS    CL7                                                      02793000
         ORG   CKETIME                                                  02794000
HLDEYR   DS    FL1                                                      02795000
HLDEDAY  DS    FL2                                                      02796000
HLDETIME DS    FL4                                                      02797000
         ORG   STARTTIM+16                                              02798000
TSTIMES  DS    CL16                                                     02799000
         ORG   TSTIMES                                                  02800000
@NM00075 DS    CL1                                                      02801000
TSBEG    DS    CL7                                                      02802000
         ORG   TSBEG                                                    02803000
TSSYR    DS    FL1                                                      02804000
TSSDAY   DS    FL2                                                      02805000
TSSTIME  DS    FL4                                                      02806000
         ORG   TSTIMES+8                                                02807000
@NM00076 DS    CL1                                                      02808000
TSEND    DS    CL7                                                      02809000
         ORG   TSEND                                                    02810000
TSEYR    DS    FL1                                                      02811000
TSEDAY   DS    FL2                                                      02812000
TSETIME  DS    FL4                                                      02813000
         ORG   TSTIMES+16                                               02814000
DOUBLEWD DS    CL8                                                      02815000
TODAY    DS    CL5                                                      02816000
PARMSW   DS    CL1                                                      02817000
PARMHOLD DS    CL31                                                     02818000
CKSEQ    DS    CL7                                                      02819000
FIXOUT   DS    CL13                                                     02820000
PARMERR  DS    BL1                                                      02821000
DATEINSW DS    BL1                                                      02822000
SELECTSW DS    BL1                                                      02823000
FIRSTSW  DS    BL1                                                      02824000
EOFSW    DS    BL1                                                      02825000
         DS    CL2                                                      02826000
ARRAY1   DS    CL2320                                                   02827000
         ORG   ARRAY1                                                   02828000
RWTBLE   DS    CL2320                                                   02829000
         ORG   RWTBLE                                                   02830000
BKT1     DS    116F                                                     02831000
BKT2     DS    116F                                                     02832000
BKT3     DS    116F                                                     02833000
BKT4     DS    116F                                                     02834000
BKT5     DS    116F                                                     02835000
         ORG   ARRAY1+2320                                              02836000
ARRAY1A  DS    CL928                                                    02837000
         ORG   ARRAY1A                                                  02838000
BKT6     DS    116F                                                     02839000
BKT7     DS    116F                                                     02840000
         ORG   ARRAY1A+928                                              02841000
ICGTRSUM CSECT                                                          02842000
         DS    0F                                                       02843000
@SIZDATD DC    AL1(0)                                                   02844000
         DC    AL3(@ENDDATD-@DATD)                                      02845000
         DS    0D                                                       02846000
@CC00740 DC    C'  :  :  '                                              02847000
@CC00795 DC    C'SDGXX   '                                              02848000
@CC00800 DC    C'       '                                               02849000
@CC00737 DC    C'  /   '                                                02850000
@CC00758 DC    C'TOTALS'                                                02851000
@CC00717 DC    C'000'                                                   02852000
@CC00726 EQU   @CC00795                                                 02853000
@CC00727 DC    C'27'                                                    02854000
@CC00668 DC    C'E'                                                     02855000
@CC00739 DC    C'N'                                                     02856000
@CC00741 EQU   @CC00795                                                 02857000
HDNG1    DS    CL121                                                    02858000
         ORG   HDNG1                                                    02859000
@NM00047 DC    CL36'1ICGTRSUM'                                          02860000
@NM00048 DC    CL65'MSS TRACE STAGING DRIVE GROUP ACTIVITY'             02861000
@NM00049 DC    CL20'DATE YYDDD  PAGEXXXX'                               02862000
         ORG   HDNG1+121                                                02863000
HDNG2    DS    CL121                                                    02864000
         ORG   HDNG2                                                    02865000
@NM00050 DC    CL1'0'                                                   02866000
@NM00051 DC    CL40'                           CYLINDERS   C'           02867000
@NM00052 DC    CL40'YL FAULT   CYLINDERS  SPACE ALLOC  TOTAL'           02868000
@NM00053 DC    CL40' STGNG  % TOTAL  % CARTG                '           02869000
         ORG   HDNG2+121                                                02870000
HDNG3    DS    CL121                                                    02871000
         ORG   HDNG3                                                    02872000
@NM00054 DC    CL1' '                                                   02873000
@NM00055 DC    CL40' DATE    TIME       SDG      STAGED     '           02874000
@NM00056 DC    CL40' CAUSED     DESTAGED     CAUSED      ACT'           02875000
@NM00057 DC    CL40'IVITY   T-SLICE  PRELOADED              '           02876000
         ORG   HDNG3+121                                                02877000
HDNGA    DS    CL121                                                    02878000
         ORG   HDNGA                                                    02879000
@NM00058 DC    CL35'1ICGTRSUM'                                          02880000
@NM00059 DC    CL66'MSS TRACE DATA RECORDING DEVICE ACTIVITY'           02881000
@NM00060 DC    CL20'DATE YYDDD  PAGEXXXX'                               02882000
         ORG   HDNGA+121                                                02883000
HDNGB    DS    CL121                                                    02884000
         ORG   HDNGB                                                    02885000
@NM00061 DC    CL1'0'                                                   02886000
@NM00062 DC    CL40'                           CYLINDERS   C'           02887000
@NM00063 DC    CL40'YL FAULT   CYLINDERS  SPACE ALLOC  TOTAL'           02888000
@NM00064 DC    CL40' STGNG  % TOTAL  CARTG   LOAD  EFFECTIVE'           02889000
         ORG   HDNGB+121                                                02890000
HDNGC    DS    CL121                                                    02891000
         ORG   HDNGC                                                    02892000
@NM00065 DC    CL1' '                                                   02893000
@NM00066 DC    CL40' DATE    TIME   MSF DRD      STAGED     '           02894000
@NM00067 DC    CL40' CAUSED     DESTAGED     CAUSED      ACT'           02895000
@NM00068 DC    CL40'IVITY   T-SLICE  LOADS   TIME CARTG RATE'           02896000
         ORG   HDNGC+121                                                02897000
RCDTOTAL DS    CL121                                                    02898000
         ORG   RCDTOTAL                                                 02899000
@NM00069 DC    CL1'1'                                                   02900000
@NM00070 DC    CL40'PARM OPTION - X  T-SLICE - XXX  DATES - '           02901000
@NM00071 DC    CL40'YYDDD-YYDDD  TIMES - HHMM-HHMM SSID-XXX '           02902000
@NM00072 DC    CL40' INPUT RECORDS SELECTED - XXXXXX        '           02903000
         ORG   RCDTOTAL+121                                             02904000
PARMMSG  DC    CL28'1ICG900I INVALID PARM VALUES'                       02905000
TRINMSG  DC    CL31'1ICG901I OPEN ERROR FOR TRACEIN'                    02906000
SEQMSG   DC    CL43'1ICG903I INPUT FILE TRACEIN OUT OF SEQUENCE'        02907000
ICGTR904 DC    CL30' ICG904I I/O ERROR ON TRACEIN '                     02908000
         DS    CL3                                                      02909000
FIXAREA  DS    CL200                                                    02910000
         ORG   FIXAREA                                                  02911000
@NM00077 DC    200CL1'Z'                                                02912000
         ORG   FIXAREA+200                                              02913000
SSIDEQ   DC    CL1'0'                                                   02914000
         DC    CL1'1'                                                   02915000
         DC    CL1'2'                                                   02916000
         DC    CL1'3'                                                   02917000
         DC    CL1'4'                                                   02918000
         DC    CL1'5'                                                   02919000
         DC    CL1'6'                                                   02920000
         DC    CL1'7'                                                   02921000
         DC    CL1'8'                                                   02922000
         DC    CL1'9'                                                   02923000
         DC    CL1'A'                                                   02924000
         DC    CL1'B'                                                   02925000
         DC    CL1'C'                                                   02926000
         DC    CL1'D'                                                   02927000
         DC    CL1'E'                                                   02928000
         DC    CL1'F'                                                   02929000
ICGTRSUM CSECT                                                          02930000
*                                                         /*@Y30LB40*/  02931000
IPATDCB  DCB   DSORG=PS,DDNAME=TRACEIN,MACRF=GM,RECFM=FB,LRECL=72,    **02932000
               EODAD=EOF,EROPT=SKP,SYNAD=READERR                        02933000
IDCBL    EQU   *-IPATDCB                                                02934000
PPATDCB  DCB   DSORG=PS,DDNAME=SYSPRINT,MACRF=PM,RECFM=FBA,LRECL=121    02935000
PDCBL    EQU   *-PPATDCB                                                02936000
@DATD    DSECT                                                          02937000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                02938000
@ENDDATD EQU   *                                                        02939000
ICGTRSUM CSECT                                                          02940000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       02941000
@01      EQU   01                                                       02942000
@02      EQU   02                                                       02943000
@03      EQU   03                                                       02944000
@04      EQU   04                                                       02945000
@05      EQU   05                                                       02946000
@06      EQU   06                                                       02947000
@07      EQU   07                                                       02948000
@08      EQU   08                                                       02949000
@09      EQU   09                                                       02950000
@10      EQU   10                                                       02951000
@11      EQU   11                                                       02952000
@12      EQU   12                                                       02953000
@13      EQU   13                                                       02954000
@14      EQU   14                                                       02955000
@15      EQU   15                                                       02956000
U        EQU   @08                                                      02957000
L        EQU   @07                                                      02958000
SS       EQU   @02                                                      02959000
CALCFLD2 EQU   @02                                                      02960000
PARMPTR  EQU   @03                                                      02961000
TIMEWORK EQU   @03                                                      02962000
SAVE14   EQU   @06                                                      02963000
K        EQU   @07                                                      02964000
J        EQU   @08                                                      02965000
I        EQU   @06                                                      02966000
R0       EQU   @00                                                      02967000
R1       EQU   @01                                                      02968000
R2       EQU   @02                                                      02969000
R3       EQU   @03                                                      02970000
R14      EQU   @14                                                      02971000
R15      EQU   @15                                                      02972000
IHADCB   EQU   0                                                        02973000
IHADCS05 EQU   0                                                        02974000
DCBMODE  EQU   IHADCS05                                                 02975000
DCBSTACK EQU   DCBMODE                                                  02976000
DCBFUNC  EQU   IHADCS05+3                                               02977000
IHADCS11 EQU   0                                                        02978000
DCBRELB  EQU   IHADCS11                                                 02979000
DCBREL   EQU   DCBRELB+1                                                02980000
DCBBUFCB EQU   IHADCS11+4                                               02981000
DCBDSORG EQU   IHADCS11+10                                              02982000
DCBDSRG1 EQU   DCBDSORG                                                 02983000
DCBDSRG2 EQU   DCBDSORG+1                                               02984000
DCBIOBAD EQU   IHADCS11+12                                              02985000
DCBODEB  EQU   DCBIOBAD                                                 02986000
DCBLNP   EQU   DCBODEB                                                  02987000
DCBQSLM  EQU   DCBLNP                                                   02988000
DCBIOBAA EQU   DCBODEB+1                                                02989000
IHADCS50 EQU   0                                                        02990000
DCBSVCXL EQU   IHADCS50                                                 02991000
DCBEODAD EQU   IHADCS50+4                                               02992000
DCBBFALN EQU   DCBEODAD                                                 02993000
DCBHIARC EQU   DCBBFALN                                                 02994000
DCBBFTEK EQU   DCBHIARC                                                 02995000
DCBBFT   EQU   DCBBFTEK                                                 02996000
DCBEXLST EQU   IHADCS50+8                                               02997000
DCBRECFM EQU   DCBEXLST                                                 02998000
DCBRECLA EQU   DCBRECFM                                                 02999000
IHADCS24 EQU   0                                                        03000000
DCBOFLGS EQU   IHADCS24+8                                               03001000
DCBOFLWR EQU   DCBOFLGS                                                 03002000
DCBIFLG  EQU   IHADCS24+9                                               03003000
DCBMACR  EQU   IHADCS24+10                                              03004000
DCBMACR1 EQU   DCBMACR                                                  03005000
DCBMRFE  EQU   DCBMACR1                                                 03006000
DCBMRGET EQU   DCBMRFE                                                  03007000
DCBMRAPG EQU   DCBMACR1                                                 03008000
DCBMRRD  EQU   DCBMRAPG                                                 03009000
DCBMRCI  EQU   DCBMACR1                                                 03010000
DCBMRMVG EQU   DCBMRCI                                                  03011000
DCBMRLCG EQU   DCBMACR1                                                 03012000
DCBMRABC EQU   DCBMACR1                                                 03013000
DCBMRPT1 EQU   DCBMRABC                                                 03014000
DCBMRSBG EQU   DCBMRPT1                                                 03015000
DCBMRCRL EQU   DCBMACR1                                                 03016000
DCBMRCHK EQU   DCBMRCRL                                                 03017000
DCBMRRDX EQU   DCBMRCHK                                                 03018000
DCBMRDMG EQU   DCBMACR1                                                 03019000
DCBMACR2 EQU   DCBMACR+1                                                03020000
DCBMRPUT EQU   DCBMACR2                                                 03021000
DCBMRWRT EQU   DCBMACR2                                                 03022000
DCBMRMVP EQU   DCBMACR2                                                 03023000
DCBMR5WD EQU   DCBMACR2                                                 03024000
DCBMRLDM EQU   DCBMR5WD                                                 03025000
DCBMRLCP EQU   DCBMRLDM                                                 03026000
DCBMR4WD EQU   DCBMACR2                                                 03027000
DCBMRPT2 EQU   DCBMR4WD                                                 03028000
DCBMRTMD EQU   DCBMRPT2                                                 03029000
DCBMR3WD EQU   DCBMACR2                                                 03030000
DCBMRCTL EQU   DCBMR3WD                                                 03031000
DCBMRSTK EQU   DCBMRCTL                                                 03032000
DCBMR1WD EQU   DCBMACR2                                                 03033000
DCBMRSWA EQU   DCBMR1WD                                                 03034000
DCBMRDMD EQU   DCBMRSWA                                                 03035000
IHADCS25 EQU   0                                                        03036000
DCBMACRF EQU   IHADCS25+2                                               03037000
DCBMACF1 EQU   DCBMACRF                                                 03038000
DCBMFFE  EQU   DCBMACF1                                                 03039000
DCBMFGET EQU   DCBMFFE                                                  03040000
DCBMFAPG EQU   DCBMACF1                                                 03041000
DCBMFRD  EQU   DCBMFAPG                                                 03042000
DCBMFCI  EQU   DCBMACF1                                                 03043000
DCBMFMVG EQU   DCBMFCI                                                  03044000
DCBMFLCG EQU   DCBMACF1                                                 03045000
DCBMFABC EQU   DCBMACF1                                                 03046000
DCBMFPT1 EQU   DCBMFABC                                                 03047000
DCBMFSBG EQU   DCBMFPT1                                                 03048000
DCBMFCRL EQU   DCBMACF1                                                 03049000
DCBMFCHK EQU   DCBMFCRL                                                 03050000
DCBMFDMG EQU   DCBMACF1                                                 03051000
DCBMACF2 EQU   DCBMACRF+1                                               03052000
DCBMFPUT EQU   DCBMACF2                                                 03053000
DCBMFWRT EQU   DCBMACF2                                                 03054000
DCBMFMVP EQU   DCBMACF2                                                 03055000
DCBMF5WD EQU   DCBMACF2                                                 03056000
DCBMFLDM EQU   DCBMF5WD                                                 03057000
DCBMFLCP EQU   DCBMFLDM                                                 03058000
DCBMF4WD EQU   DCBMACF2                                                 03059000
DCBMFPT2 EQU   DCBMF4WD                                                 03060000
DCBMFTMD EQU   DCBMFPT2                                                 03061000
DCBMF3WD EQU   DCBMACF2                                                 03062000
DCBMFCTL EQU   DCBMF3WD                                                 03063000
DCBMFSTK EQU   DCBMFCTL                                                 03064000
DCBMF1WD EQU   DCBMACF2                                                 03065000
DCBMFSWA EQU   DCBMF1WD                                                 03066000
DCBMFDMD EQU   DCBMFSWA                                                 03067000
DCBDEBAD EQU   IHADCS25+4                                               03068000
DCBIFLGS EQU   DCBDEBAD                                                 03069000
IHADCS26 EQU   0                                                        03070000
DCBWRITE EQU   IHADCS26                                                 03071000
DCBREAD  EQU   DCBWRITE                                                 03072000
DCBWRITA EQU   DCBREAD+1                                                03073000
IHADCS27 EQU   0                                                        03074000
DCBGET   EQU   IHADCS27                                                 03075000
DCBPUT   EQU   DCBGET                                                   03076000
DCBGETA  EQU   DCBPUT+1                                                 03077000
IHADCS36 EQU   0                                                        03078000
DCBGERR  EQU   IHADCS36                                                 03079000
DCBPERR  EQU   DCBGERR                                                  03080000
DCBCHECK EQU   DCBPERR                                                  03081000
DCBOPTCD EQU   DCBCHECK                                                 03082000
DCBOPTH  EQU   DCBOPTCD                                                 03083000
DCBOPTO  EQU   DCBOPTH                                                  03084000
DCBOPTZ  EQU   DCBOPTCD                                                 03085000
DCBGERRA EQU   DCBCHECK+1                                               03086000
DCBPERRA EQU   DCBGERRA                                                 03087000
DCBSYNAD EQU   IHADCS36+4                                               03088000
DCBCIND1 EQU   IHADCS36+8                                               03089000
DCBCIND2 EQU   IHADCS36+9                                               03090000
DCBIOBA  EQU   IHADCS36+16                                              03091000
DCBCICB  EQU   DCBIOBA                                                  03092000
IHADCS52 EQU   0                                                        03093000
DCBDIRCT EQU   IHADCS52                                                 03094000
DCBQSWS  EQU   DCBDIRCT                                                 03095000
DCBUSASI EQU   DCBQSWS                                                  03096000
DCBQADFS EQU   DCBUSASI                                                 03097000
DCBBUFOF EQU   DCBDIRCT+1                                               03098000
IHADCS37 EQU   0                                                        03099000
DCBFLAG1 EQU   IHADCS37                                                 03100000
IHADCS38 EQU   0                                                        03101000
DCBEOBR  EQU   IHADCS38                                                 03102000
DCBPOINT EQU   IHADCS38+12                                              03103000
DCBCNTRL EQU   DCBPOINT                                                 03104000
IHADCS40 EQU   0                                                        03105000
DCBEOBAD EQU   IHADCS40                                                 03106000
DCBCCCW  EQU   IHADCS40+4                                               03107000
DCBRECAD EQU   DCBCCCW                                                  03108000
DCBRECBT EQU   DCBRECAD                                                 03109000
DCBRCREL EQU   DCBRECBT                                                 03110000
@NM00026 EQU   IHADCS40+12                                              03111000
DCBEROPT EQU   @NM00026                                                 03112000
PARMVALS EQU   0                                                        03113000
PARMLEN  EQU   PARMVALS                                                 03114000
PARMS    EQU   PARMVALS+2                                               03115000
FIXADDR  EQU   0                                                        03116000
FIXLEN   EQU   0                                                        03117000
FIXOPT   EQU   0                                                        03118000
RW       EQU   SDGID                                                    03119000
DRDSSID  EQU   RW                                                       03120000
CHAR2    EQU   DRDSSID                                                  03121000
DRDMSFID EQU   DRDSSID+1                                                03122000
RWFLD6   EQU   DRDSSID+2                                                03123000
RWLINE   EQU   FLD16                                                    03124000
RWFLD18  EQU   RWLINE+6                                                 03125000
RWFLD20  EQU   RWLINE+13                                                03126000
RWFLD22  EQU   RWLINE+22                                                03127000
ARRAY2   EQU   ARRAY1A                                                  03128000
DSTABLE  EQU   ARRAY2                                                   03129000
DSBKT6   EQU   DSTABLE                                                  03130000
DSBKT7   EQU   DSTABLE+464                                              03131000
*                                      START UNREFERENCED COMPONENTS    03132000
@NM00046 EQU   RWLINE+28                                                03133000
@NM00045 EQU   RWLINE+19                                                03134000
@NM00044 EQU   RWLINE+12                                                03135000
@NM00043 EQU   RWLINE                                                   03136000
DCBEOB   EQU   IHADCS40+20                                              03137000
DCBPRECL EQU   IHADCS40+18                                              03138000
@NM00029 EQU   IHADCS40+16                                              03139000
@NM00028 EQU   @NM00026+1                                               03140000
@NM00027 EQU   DCBEROPT                                                 03141000
DCBERABE EQU   DCBEROPT                                                 03142000
DCBERSKP EQU   DCBEROPT                                                 03143000
DCBERACC EQU   DCBEROPT                                                 03144000
@NM00025 EQU   IHADCS40+10                                              03145000
@NM00024 EQU   IHADCS40+9                                               03146000
@NM00023 EQU   IHADCS40+8                                               03147000
DCBRECA  EQU   DCBRECAD+1                                               03148000
@NM00022 EQU   DCBRECBT                                                 03149000
DCBRCFGT EQU   DCBRCREL                                                 03150000
DCBRCTRU EQU   DCBRCREL                                                 03151000
DCBLCCW  EQU   DCBEOBAD                                                 03152000
DCBNOTE  EQU   DCBCNTRL                                                 03153000
DCBLRECL EQU   IHADCS38+10                                              03154000
@NM00021 EQU   IHADCS38+8                                               03155000
DCBEOBW  EQU   IHADCS38+4                                               03156000
DCBEOBRA EQU   DCBEOBR+1                                                03157000
DCBNCP   EQU   DCBEOBR                                                  03158000
@NM00020 EQU   DCBFLAG1                                                 03159000
DCBSTFLS EQU   DCBFLAG1                                                 03160000
DCBSTQCK EQU   DCBFLAG1                                                 03161000
DCBDIRCQ EQU   DCBBUFOF                                                 03162000
DCBQSTRU EQU   DCBUSASI                                                 03163000
@NM00019 EQU   DCBUSASI                                                 03164000
DCBQADF3 EQU   DCBQADFS                                                 03165000
DCBQADF2 EQU   DCBQADFS                                                 03166000
DCBQADF1 EQU   DCBQADFS                                                 03167000
DCBBLBP  EQU   DCBUSASI                                                 03168000
@NM00018 EQU   DCBUSASI                                                 03169000
DCBCICBA EQU   DCBCICB+1                                                03170000
@NM00017 EQU   DCBCICB                                                  03171000
DCBOFFSW EQU   IHADCS36+15                                              03172000
DCBOFFSR EQU   IHADCS36+14                                              03173000
DCBWCPL  EQU   IHADCS36+13                                              03174000
DCBWCPO  EQU   IHADCS36+12                                              03175000
DCBBLKSI EQU   IHADCS36+10                                              03176000
DCBCNQSM EQU   DCBCIND2                                                 03177000
DCBCNFEO EQU   DCBCIND2                                                 03178000
DCBCNCHS EQU   DCBCIND2                                                 03179000
DCBCNBFP EQU   DCBCIND2                                                 03180000
DCBCNIOE EQU   DCBCIND2                                                 03181000
DCBCNCLO EQU   DCBCIND2                                                 03182000
DCBCNWRO EQU   DCBCIND2                                                 03183000
DCBCNSTO EQU   DCBCIND2                                                 03184000
DCBCNEXB EQU   DCBCIND1                                                 03185000
@NM00016 EQU   DCBCIND1                                                 03186000
DCBCNBRM EQU   DCBCIND1                                                 03187000
@NM00015 EQU   DCBCIND1                                                 03188000
DCBCNEVA EQU   DCBCIND1                                                 03189000
DCBCNEVB EQU   DCBCIND1                                                 03190000
DCBCNSRD EQU   DCBCIND1                                                 03191000
DCBCNTOV EQU   DCBCIND1                                                 03192000
DCBSYNA  EQU   DCBSYNAD+1                                               03193000
DCBIOBL  EQU   DCBSYNAD                                                 03194000
DCBCHCKA EQU   DCBPERRA                                                 03195000
@NM00014 EQU   DCBOPTCD                                                 03196000
DCBOPTT  EQU   DCBOPTCD                                                 03197000
DCBSRCHD EQU   DCBOPTZ                                                  03198000
DCBOPTQ  EQU   DCBOPTCD                                                 03199000
DCBBCKPT EQU   DCBOPTO                                                  03200000
DCBOPTC  EQU   DCBOPTCD                                                 03201000
DCBOPTU  EQU   DCBOPTCD                                                 03202000
DCBOPTW  EQU   DCBOPTCD                                                 03203000
DCBPUTA  EQU   DCBGETA                                                  03204000
@NM00013 EQU   DCBPUT                                                   03205000
DCBREADA EQU   DCBWRITA                                                 03206000
@NM00012 EQU   DCBREAD                                                  03207000
DCBDEBA  EQU   DCBDEBAD+1                                               03208000
@NM00011 EQU   DCBIFLGS                                                 03209000
DCBIFIOE EQU   DCBIFLGS                                                 03210000
DCBIFPCT EQU   DCBIFLGS                                                 03211000
DCBIFEC  EQU   DCBIFLGS                                                 03212000
DCBMFSTI EQU   DCBMFDMD                                                 03213000
DCBMFAWR EQU   DCBMFSTK                                                 03214000
DCBMFUIP EQU   DCBMFTMD                                                 03215000
DCBMFIDW EQU   DCBMFLCP                                                 03216000
DCBMFWRK EQU   DCBMFMVP                                                 03217000
DCBMFRDQ EQU   DCBMFWRT                                                 03218000
DCBMFGTQ EQU   DCBMFPUT                                                 03219000
DCBMFSTL EQU   DCBMACF2                                                 03220000
DCBMFCK  EQU   DCBMFDMG                                                 03221000
DCBMFRDX EQU   DCBMFCHK                                                 03222000
DCBMFDBF EQU   DCBMFSBG                                                 03223000
DCBMFRDI EQU   DCBMFLCG                                                 03224000
DCBMFRDK EQU   DCBMFMVG                                                 03225000
DCBMFWRQ EQU   DCBMFRD                                                  03226000
DCBMFPTQ EQU   DCBMFGET                                                 03227000
DCBMFECP EQU   DCBMACF1                                                 03228000
DCBTIOT  EQU   IHADCS25                                                 03229000
DCBMRSTI EQU   DCBMRDMD                                                 03230000
DCBMRAWR EQU   DCBMRSTK                                                 03231000
DCBMRUIP EQU   DCBMRTMD                                                 03232000
DCBMRIDW EQU   DCBMRLCP                                                 03233000
DCBMRWRK EQU   DCBMRMVP                                                 03234000
DCBMRRDQ EQU   DCBMRWRT                                                 03235000
DCBMRGTQ EQU   DCBMRPUT                                                 03236000
DCBMRSTL EQU   DCBMACR2                                                 03237000
DCBMRCK  EQU   DCBMRDMG                                                 03238000
DCBPGFXA EQU   DCBMRRDX                                                 03239000
DCBMRDBF EQU   DCBMRSBG                                                 03240000
DCBMRRDI EQU   DCBMRLCG                                                 03241000
DCBMRRDK EQU   DCBMRMVG                                                 03242000
DCBMRWRQ EQU   DCBMRRD                                                  03243000
DCBMRPTQ EQU   DCBMRGET                                                 03244000
DCBMRECP EQU   DCBMACR1                                                 03245000
@NM00010 EQU   DCBIFLG                                                  03246000
DCBIBIOE EQU   DCBIFLG                                                  03247000
DCBIBPCT EQU   DCBIFLG                                                  03248000
DCBIBEC  EQU   DCBIFLG                                                  03249000
DCBOFIOF EQU   DCBOFLGS                                                 03250000
DCBOFUEX EQU   DCBOFLGS                                                 03251000
DCBOFTM  EQU   DCBOFLGS                                                 03252000
DCBOFPPC EQU   DCBOFLGS                                                 03253000
DCBOFOPN EQU   DCBOFLGS                                                 03254000
DCBOFEOV EQU   DCBOFLGS                                                 03255000
DCBOFLRB EQU   DCBOFLGS                                                 03256000
DCBOFIOD EQU   DCBOFLWR                                                 03257000
DCBDDNAM EQU   IHADCS24                                                 03258000
DCBEXLSA EQU   DCBEXLST+1                                               03259000
DCBRECKL EQU   DCBRECFM                                                 03260000
DCBRECCC EQU   DCBRECFM                                                 03261000
DCBRECSB EQU   DCBRECFM                                                 03262000
DCBRECBR EQU   DCBRECFM                                                 03263000
DCBRECTO EQU   DCBRECLA                                                 03264000
DCBRECL  EQU   DCBRECLA                                                 03265000
DCBEODA  EQU   DCBEODAD+1                                               03266000
DCBBFA   EQU   DCBBFTEK                                                 03267000
DCBH0    EQU   DCBBFTEK                                                 03268000
DCBBFTKD EQU   DCBBFTEK                                                 03269000
DCBBFTE  EQU   DCBBFT                                                   03270000
DCBBFTKR EQU   DCBBFT                                                   03271000
DCBBFTS  EQU   DCBBFT                                                   03272000
DCBH1    EQU   DCBBFTEK                                                 03273000
DCBSVCXA EQU   DCBSVCXL+1                                               03274000
@NM00009 EQU   DCBSVCXL                                                 03275000
DCBODEBA EQU   DCBIOBAA                                                 03276000
@NM00008 EQU   DCBQSLM                                                  03277000
DCBUPDBT EQU   DCBQSLM                                                  03278000
DCBUPDCM EQU   DCBQSLM                                                  03279000
DCB1DVDS EQU   DCBQSLM                                                  03280000
@NM00007 EQU   DCBDSRG2                                                 03281000
DCBDSGTR EQU   DCBDSRG2                                                 03282000
DCBACBM  EQU   DCBDSRG2                                                 03283000
@NM00006 EQU   DCBDSRG2                                                 03284000
DCBDSGTQ EQU   DCBDSRG2                                                 03285000
DCBDSGTX EQU   DCBDSRG2                                                 03286000
DCBDSGGS EQU   DCBDSRG2                                                 03287000
DCBDSGU  EQU   DCBDSRG1                                                 03288000
DCBDSGPO EQU   DCBDSRG1                                                 03289000
DCBDSGMQ EQU   DCBDSRG1                                                 03290000
DCBDSGCQ EQU   DCBDSRG1                                                 03291000
DCBDSGCX EQU   DCBDSRG1                                                 03292000
DCBDSGDA EQU   DCBDSRG1                                                 03293000
DCBDSGPS EQU   DCBDSRG1                                                 03294000
DCBDSGIS EQU   DCBDSRG1                                                 03295000
DCBBUFL  EQU   IHADCS11+8                                               03296000
DCBBUFCA EQU   DCBBUFCB+1                                               03297000
DCBBUFNO EQU   DCBBUFCB                                                 03298000
DCBDEVT  EQU   DCBREL                                                   03299000
DCBKEYLE EQU   DCBRELB                                                  03300000
@NM00005 EQU   DCBFUNC                                                  03301000
DCBFNCBT EQU   DCBFUNC                                                  03302000
DCBFNCBX EQU   DCBFUNC                                                  03303000
DCBFNCBD EQU   DCBFUNC                                                  03304000
DCBFNCBW EQU   DCBFUNC                                                  03305000
DCBFNCBP EQU   DCBFUNC                                                  03306000
DCBFNCBR EQU   DCBFUNC                                                  03307000
DCBFNCBI EQU   DCBFUNC                                                  03308000
@NM00004 EQU   IHADCS05+2                                               03309000
@NM00003 EQU   IHADCS05+1                                               03310000
DCBSTCK1 EQU   DCBSTACK                                                 03311000
DCBSTCK2 EQU   DCBSTACK                                                 03312000
@NM00002 EQU   DCBSTACK                                                 03313000
DCBMODER EQU   DCBSTACK                                                 03314000
DCBMODEO EQU   DCBSTACK                                                 03315000
DCBMODEE EQU   DCBSTACK                                                 03316000
DCBMODEC EQU   DCBSTACK                                                 03317000
@NM00001 EQU   IHADCB                                                   03318000
*                                      END UNREFERENCED COMPONENTS      03319000
@RT00092 EQU   CLOSEFIL                                                 03320000
@RT00096 EQU   CLOSEFIL                                                 03321000
@RT00110 EQU   RDTRACE                                                  03322000
@RT00115 EQU   RDTRACE                                                  03323000
@RT00119 EQU   RDTRACE                                                  03324000
@RT00122 EQU   RDTRACE                                                  03325000
@RC00157 EQU   RDTRACE                                                  03326000
@RF00218 EQU   @EL00003                                                 03327000
@RT00259 EQU   PARMEND                                                  03328000
@RT00279 EQU   PARMEND                                                  03329000
@RF00294 EQU   @RC00292                                                 03330000
@RF00304 EQU   @RC00302                                                 03331000
@RT00318 EQU   PARMEND                                                  03332000
@RT00331 EQU   PARMEND                                                  03333000
@RT00360 EQU   PARMEND                                                  03334000
@RC00368 EQU   @RC00366                                                 03335000
@RF00404 EQU   @EL00004                                                 03336000
@RC00511 EQU   @EL00009                                                 03337000
@RC00673 EQU   @RC00672                                                 03338000
@RT00712 EQU   EF4                                                      03339000
EFEND    EQU   @EL00017                                                 03340000
@RT00710 EQU   EFEND                                                    03341000
@ENDDATA EQU   *                                                        03342000
         END   ICGTRSUM,(C'PLS1449',0603,77089)                         03343000
