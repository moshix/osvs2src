         TITLE '***** ICGTRVID MSS TRACE VOLUME IDENTIFICATION REPORT **00001000
               *****    '                                               00002000
ICGTRVID CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'ICGTRVID  76.198'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  LA    @11,4095(,@12)                                      0001 00012000
         USING @PSTART,@12                                         0001 00013000
         USING @PSTART+4095,@11                                    0001 00014000
         L     @00,@SIZDATD                                        0001 00015000
         GETMAIN  R,LV=(0)                                              00016000
         LR    @10,@01                                             0001 00017000
         USING @DATD,@10                                           0001 00018000
         ST    @13,@SA00001+4                                      0001 00019000
         LM    @00,@01,20(@13)                                     0001 00020000
         ST    @10,8(,@13)                                         0001 00021000
         LR    @13,@10                                             0001 00022000
         L     R1,0(R1)                                                 00023000
*   PARMPTR=R1;                     /* SAVE PTR TO PARMS     @Y30LB40*/ 00024000
         ST    R1,PARMPTR                                          0077 00025000
*   RFY                                                            0078 00026000
*     R1 UNRSTD;                    /*                       @Y30LB40*/ 00027000
*   RCDCOUNT=0;                     /* INITIALIZE VARIABLES  @Y30LB40*/ 00028000
         SLR   @15,@15                                             0079 00029000
         ST    @15,RCDCOUNT                                        0079 00030000
*   RETURNCD=0;                     /*                       @Y30LB40*/ 00031000
         LR    RETURNCD,@15                                        0080 00032000
*   TIMESL=600;                     /*                       @Y30LB40*/ 00033000
         MVC   TIMESL(4),@CF00631                                  0081 00034000
*   HOUR=0;                         /*                       @Y30LB40*/ 00035000
         ST    @15,HOUR                                            0082 00036000
*   MINUTE=0;                       /*                       @Y30LB40*/ 00037000
         ST    @15,MINUTE                                          0083 00038000
*   SECOND=0;                       /*                       @Y30LB40*/ 00039000
         ST    @15,SECOND                                          0084 00040000
*   LINECNT=56;                     /*                       @Y30LB40*/ 00041000
         LA    LINECNT,56                                          0085 00042000
*   OPENCLOS=0;                     /*                       @Y30LB40*/ 00043000
         ST    @15,OPENCLOS                                        0086 00044000
*   OPCLB1='10000000'B;             /*                       @Y30LB40*/ 00045000
         MVI   OPCLB1,B'10000000'                                  0087 00046000
*   PAGECNT=0;                      /*                       @Y30LB40*/ 00047000
         ST    @15,PAGECNT                                         0088 00048000
*   EOFSW='0'B;                     /*                       @Y30LB40*/ 00049000
         NI    EOFSW,B'01111111'                                   0089 00050000
*   HLDSYR=0;                       /*                       @Y30LB40*/ 00051000
         MVI   HLDSYR,X'00'                                        0090 00052000
*   HLDSDAY=1;                      /*                       @Y30LB40*/ 00053000
         LA    @14,1                                               0091 00054000
         STH   @14,HLDSDAY                                         0091 00055000
*   HLDSTIME=0;                     /*                       @Y30LB40*/ 00056000
         ST    @15,HLDSTIME                                        0092 00057000
*   HLDEYR=99;                      /*                       @Y30LB40*/ 00058000
         MVI   HLDEYR,X'63'                                        0093 00059000
*   HLDEDAY=365;                    /*                       @Y30LB40*/ 00060000
         MVC   HLDEDAY(2),@CH00636                                 0094 00061000
*   HLDETIME=86399;                 /*                       @Y30LB40*/ 00062000
         MVC   HLDETIME(4),@CF00637                                0095 00063000
*   FIRSTSW='1'B;                   /*                       @Y30LB40*/ 00064000
         OI    FIRSTSW,B'10000000'                                 0096 00065000
*   PARMERR='0'B;                   /*                       @Y30LB40*/ 00066000
         NI    PARMERR,B'01111111'                                 0097 00067000
*   DATEINSW='0'B;                  /*                       @Y30LB40*/ 00068000
         NI    DATEINSW,B'01111111'                                0098 00069000
*   VOL=' ';                        /*                       @Y30LB40*/ 00070000
         MVI   VOL+1,C' '                                          0099 00071000
         MVC   VOL+2(4),VOL+1                                      0099 00072000
         MVI   VOL,C' '                                            0099 00073000
*   LIBSW='0'B;                     /*                       @Y30LB40*/ 00074000
         NI    LIBSW,B'01111111'                                   0100 00075000
*   VOLSW='0'B;                     /*                       @Y30LB40*/ 00076000
         NI    VOLSW,B'01111111'                                   0101 00077000
*   TMESW='0'B;                     /*                       @Y30LB40*/ 00078000
         NI    TMESW,B'01111111'                                   0102 00079000
*   SPACE1=' ';                     /*                       @Y30LB40*/ 00080000
         MVI   SPACE1+1,C' '                                       0103 00081000
         MVC   SPACE1+2(119),SPACE1+1                              0103 00082000
         MVI   SPACE1,C' '                                         0103 00083000
*   DO I=1 TO 2;                    /*                       @Y30LB40*/ 00084000
         LR    I,@14                                               0104 00085000
@DL00104 DS    0H                                                  0105 00086000
*     DO J=1 TO 2;                  /*                       @Y30LB40*/ 00087000
         LA    J,1                                                 0105 00088000
@DL00105 DS    0H                                                  0106 00089000
*       SMSTGD(I,J)=0;              /*                       @Y30LB40*/ 00090000
         SLR   @15,@15                                             0106 00091000
         LR    @14,I                                               0106 00092000
         ALR   @14,@14                                             0106 00093000
         ALR   @14,J                                               0106 00094000
         MH    @14,@CH00729                                        0106 00095000
         ST    @15,SMSTGD-108(@14)                                 0106 00096000
*       SMCFAULT(I,J)=0;            /*                       @Y30LB40*/ 00097000
         ST    @15,SMCFAULT-108(@14)                               0107 00098000
*       SMDSTGD(I,J)=0;             /*                       @Y30LB40*/ 00099000
         ST    @15,SMDSTGD-108(@14)                                0108 00100000
*       SMSALLOC(I,J)=0;            /*                       @Y30LB40*/ 00101000
         ST    @15,SMSALLOC-108(@14)                               0109 00102000
*       LOADS(I,J)=0;               /*                       @Y30LB40*/ 00103000
         ST    @15,LOADS-108(@14)                                  0110 00104000
*       STGDTOT(I,J)=0;             /*                       @Y30LB40*/ 00105000
         ST    @15,STGDTOT-108(@14)                                0111 00106000
*       VTOCSG(I,J)=0;              /*                       @Y30LB40*/ 00107000
         ST    @15,VTOCSG-108(@14)                                 0112 00108000
*       DSTGDTOT(I,J)=0;            /*                       @Y30LB40*/ 00109000
         ST    @15,DSTGDTOT-108(@14)                               0113 00110000
*       VTOCDS(I,J)=0;              /*                       @Y30LB40*/ 00111000
         ST    @15,VTOCDS-108(@14)                                 0114 00112000
*     END;                          /*                       @Y30LB40*/ 00113000
         AL    J,@CF00043                                          0115 00114000
         C     J,@CF00050                                          0115 00115000
         BNH   @DL00105                                            0115 00116000
*   END;                            /*                       @Y30LB40*/ 00117000
         AL    I,@CF00043                                          0116 00118000
         C     I,@CF00050                                          0116 00119000
         BNH   @DL00104                                            0116 00120000
*   SEQOLD=SEQOLD&&SEQOLD;          /*                       @Y30LB40*/ 00121000
         XC    SEQOLD(14),SEQOLD                                   0117 00122000
*   GEN(MVC   PRNTDCB(PDCBL),PPATDCB);/* SETUP PRINT DCB     @Y30LB40*/ 00123000
         MVC   PRNTDCB(PDCBL),PPATDCB                                   00124000
*   GEN(MVC   INDCB(IDCBL),IPATDCB);/* SETUP INPUT DCB       @Y30LB40*/ 00125000
         MVC   INDCB(IDCBL),IPATDCB                                     00126000
*   RFY                                                            0120 00127000
*    (R0,                                                          0120 00128000
*     R1,                                                          0120 00129000
*     R14,                                                         0120 00130000
*     R15) RSTD;                    /*                       @Y30LB40*/ 00131000
*   GEN(OPEN  (PRNTDCB,(OUTPUT)),MF=(E,OPENCLOS));/* OPEN PRINT DCB  */ 00132000
         OPEN  (PRNTDCB,(OUTPUT)),MF=(E,OPENCLOS)                       00133000
*   RFY                                                            0122 00134000
*    (R0,                                                          0122 00135000
*     R1,                                                          0122 00136000
*     R14,                                                         0122 00137000
*     R15) UNRSTD;                  /*                       @Y30LB40*/ 00138000
*   IF(PRNTDCB(49:49)&'00010000'B)^='00010000'B THEN               0123 00139000
         MVC   @TS00001(1),PRNTDCB+48                              0123 00140000
         NI    @TS00001,B'00010000'                                0123 00141000
         CLI   @TS00001,B'00010000'                                0123 00142000
         BE    @RF00123                                            0123 00143000
*     DO;                           /* IF OPEN BAD EXIT WITH RC=4  0124 00144000
*                                                            @Y30LB40*/ 00145000
*       RETURN CODE(4);             /*                       @Y30LB40*/ 00146000
         L     @13,4(,@13)                                         0125 00147000
         L     @00,@SIZDATD                                        0125 00148000
         LR    @01,@10                                             0125 00149000
         FREEMAIN R,LV=(0),A=(1)                                        00150000
         LA    @15,4                                               0125 00151000
         L     @14,12(,@13)                                        0125 00152000
         LM    @00,@12,20(@13)                                     0125 00153000
         BR    @14                                                 0125 00154000
*     END;                          /*                       @Y30LB40*/ 00155000
*   RFY                                                            0127 00156000
*    (R0,                                                          0127 00157000
*     R1,                                                          0127 00158000
*     R14,                                                         0127 00159000
*     R15) RSTD;                    /*                       @Y30LB40*/ 00160000
@RF00123 DS    0H                                                  0128 00161000
*   GEN(OPEN  (INDCB,(INPUT)),MF=(E,OPENCLOS));/* OPEN INPUT DCB     */ 00162000
         OPEN  (INDCB,(INPUT)),MF=(E,OPENCLOS)                          00163000
*   RFY                                                            0129 00164000
*    (R0,                                                          0129 00165000
*     R1,                                                          0129 00166000
*     R14,                                                         0129 00167000
*     R15) UNRSTD;                  /*                       @Y30LB40*/ 00168000
*   IF(INDCB(49:49)&'00010000'B)^='00010000'B THEN                 0130 00169000
         MVC   @TS00001(1),INDCB+48                                0130 00170000
         NI    @TS00001,B'00010000'                                0130 00171000
         CLI   @TS00001,B'00010000'                                0130 00172000
         BE    @RF00130                                            0130 00173000
*     DO;                           /* IF OPEN BAD,PRINT ERROR MSG 0131 00174000
*                                      AND EXIT WITH RC=8            */ 00175000
*       PRINTLN=TRINMSG;            /*                       @Y30LB40*/ 00176000
         MVI   PRINTLN+31,C' '                                     0132 00177000
         MVC   PRINTLN+32(89),PRINTLN+31                           0132 00178000
         MVC   PRINTLN(31),TRINMSG                                 0132 00179000
*       RFY                                                        0133 00180000
*        (R0,                                                      0133 00181000
*         R1,                                                      0133 00182000
*         R14,                                                     0133 00183000
*         R15) RSTD;                /*                       @Y30LB40*/ 00184000
*       GEN(PUT   PRNTDCB,PRINTLN); /*                       @Y30LB40*/ 00185000
         PUT   PRNTDCB,PRINTLN                                          00186000
*       RFY                                                        0135 00187000
*        (R0,                                                      0135 00188000
*         R1,                                                      0135 00189000
*         R14,                                                     0135 00190000
*         R15) UNRSTD;              /*                       @Y30LB40*/ 00191000
*       RETURNCD=8;                 /*                       @Y30LB40*/ 00192000
         LA    RETURNCD,8                                          0136 00193000
*       GO TO CLOSEFIL;             /*                       @Y30LB40*/ 00194000
         B     CLOSEFIL                                            0137 00195000
*     END;                          /*                       @Y30LB40*/ 00196000
*   IF PARMLEN=0 THEN                                              0139 00197000
@RF00130 L     @01,PARMPTR                                         0139 00198000
         LH    @15,PARMLEN(,@01)                                   0139 00199000
         LTR   @15,@15                                             0139 00200000
         BZ    @RT00139                                            0139 00201000
*     GO TO PARMEND;                /* IF NO PARMS BYPASS PROCESS    */ 00202000
*   IF PARMLEN>30                   /* ARE PARMS TOO LONG    @Y30LB40*/ 00203000
*     THEN                                                         0141 00204000
         C     @15,@CF00539                                        0141 00205000
         BNH   @RF00141                                            0141 00206000
*     DO;                           /* YES,SET ERROR SWITCH AND EXIT    00207000
*                                                            @Y30LB40*/ 00208000
*       PARMERR='1'B;               /*                       @Y30LB40*/ 00209000
         OI    PARMERR,B'10000000'                                 0143 00210000
*       GO TO PARMEND;              /*                       @Y30LB40*/ 00211000
         B     PARMEND                                             0144 00212000
*     END;                          /*                       @Y30LB40*/ 00213000
*   PARMHOLD(1:1)=',';              /* SET PARMHOLD TO ALL COMMAS  0146 00214000
*                                                            @Y30LB40*/ 00215000
@RF00141 MVI   PARMHOLD,C','                                       0146 00216000
*   MVC(PARMHOLD(2:31),PARMHOLD);   /*                       @Y30LB40*/ 00217000
         MVC   PARMHOLD+1(30),PARMHOLD                             0147 00218000
*   SS=1;                           /* SET SUBSTRING PTR TO 1      0148 00219000
*                                                            @Y30LB40*/ 00220000
         LA    @15,1                                               0148 00221000
         LR    SS,@15                                              0148 00222000
*   PARMHOLD(1:PARMLEN)=PARMS;      /* MOVE PARMS TO PARMHOLD      0149 00223000
*                                                            @Y30LB40*/ 00224000
         L     @03,PARMPTR                                         0149 00225000
         LH    @14,PARMLEN(,@03)                                   0149 00226000
         BCTR  @14,0                                               0149 00227000
         EX    @14,@SM00738                                        0149 00228000
*   IF PARMHOLD(SS:SS)=','          /* WAS TIME SLICE ENTERED      0150 00229000
*                                                            @Y30LB40*/ 00230000
*     THEN                                                         0150 00231000
         LA    @03,PARMHOLD-1(SS)                                  0150 00232000
         CLI   0(@03),C','                                         0150 00233000
         BNE   @RF00150                                            0150 00234000
*     SS=SS+1;                      /* NO, BUMP POINTER      @Y30LB40*/ 00235000
         ALR   SS,@15                                              0151 00236000
*   ELSE                                                           0152 00237000
*     DO;                           /* YES,VALIDATE AND CONVERT TIME    00238000
*                                      SLICE                         */ 00239000
         B     @RC00150                                            0152 00240000
@RF00150 DS    0H                                                  0153 00241000
*       DO J=SS TO(SS+2);           /* CHECK FOR NUMERICS    @Y30LB40*/ 00242000
         LR    J,SS                                                0153 00243000
         B     @DE00153                                            0153 00244000
@DL00153 DS    0H                                                  0154 00245000
*         IF PARMHOLD(J:J)>='0'&PARMHOLD(J:J)<='9' THEN            0154 00246000
         LA    @07,PARMHOLD-1(J)                                   0154 00247000
         CLI   0(@07),C'0'                                         0154 00248000
         BL    @RF00154                                            0154 00249000
         LA    @07,PARMHOLD-1(J)                                   0154 00250000
         CLI   0(@07),C'9'                                         0154 00251000
         BNH   @RT00154                                            0154 00252000
*           ;                       /*                       @Y30LB40*/ 00253000
*         ELSE                                                     0156 00254000
*           PARMERR='1'B;           /* ERROR,NON NUMERIC FOUND     0156 00255000
*                                                            @Y30LB40*/ 00256000
@RF00154 OI    PARMERR,B'10000000'                                 0156 00257000
*       END;                        /*                       @Y30LB40*/ 00258000
@RT00154 AL    J,@CF00043                                          0157 00259000
@DE00153 LA    @07,2                                               0157 00260000
         ALR   @07,SS                                              0157 00261000
         CR    J,@07                                               0157 00262000
         BNH   @DL00153                                            0157 00263000
*       IF PARMERR='1'B THEN                                       0158 00264000
         TM    PARMERR,B'10000000'                                 0158 00265000
         BO    @RT00158                                            0158 00266000
*         GO TO PARMEND;            /* IF ERROR EXIT         @Y30LB40*/ 00267000
*       IF PARMHOLD(SS:SS+2)='000'  /* TIME SLICE 000 NOT ALLOWED    */ 00268000
*         THEN                                                     0160 00269000
         LA    @03,PARMHOLD-1(SS)                                  0160 00270000
         CLC   0(3,@03),@CC00646                                   0160 00271000
         BNE   @RF00160                                            0160 00272000
*         DO;                       /*                       @Y30LB40*/ 00273000
*           PARMERR='1'B;           /* SET ERROR AND EXIT    @Y30LB40*/ 00274000
         OI    PARMERR,B'10000000'                                 0162 00275000
*           GO TO PARMEND;          /*                       @Y30LB40*/ 00276000
         B     PARMEND                                             0163 00277000
*         END;                      /*                       @Y30LB40*/ 00278000
*       PACK(DOUBLEWD,PARMHOLD(SS:SS+2));/*                  @Y30LB40*/ 00279000
@RF00160 LA    @03,PARMHOLD-1(SS)                                  0165 00280000
         PACK  DOUBLEWD(8),0(3,@03)                                0165 00281000
*       CVB(TIMESL,DOUBLEWD);       /* CONVERT TIME SLICE TO SECONDS */ 00282000
         CVB   @03,DOUBLEWD                                        0166 00283000
         ST    @03,TIMESL                                          0166 00284000
*       TIMESL=TIMESL*60;           /*                       @Y30LB40*/ 00285000
         MH    @03,@CH00334                                        0167 00286000
         ST    @03,TIMESL                                          0167 00287000
*       SS=SS+4;                    /* BUMP POINTER TO NEXT VALUE  0168 00288000
*                                                            @Y30LB40*/ 00289000
         AL    SS,@CF00103                                         0168 00290000
*     END;                          /*                       @Y30LB40*/ 00291000
*   IF PARMHOLD(SS:SS)=','          /* WERE DATES ENTERED    @Y30LB40*/ 00292000
*     THEN                                                         0170 00293000
@RC00150 LA    @03,PARMHOLD-1(SS)                                  0170 00294000
         CLI   0(@03),C','                                         0170 00295000
         BNE   @RF00170                                            0170 00296000
*     SS=SS+1;                      /* NO, BUMP POINTER TO NEXT VALUE   00297000
*                                                            @Y30LB40*/ 00298000
         AL    SS,@CF00043                                         0171 00299000
*   ELSE                                                           0172 00300000
*     DO;                           /* YES,VALIDATE AND CONVERT DATES   00301000
*                                                            @Y30LB40*/ 00302000
         B     @RC00170                                            0172 00303000
@RF00170 DS    0H                                                  0173 00304000
*       DO J=SS TO(SS+9);           /* CHECK FOR NUMERICS    @Y30LB40*/ 00305000
         LR    J,SS                                                0173 00306000
         B     @DE00173                                            0173 00307000
@DL00173 DS    0H                                                  0174 00308000
*         IF PARMHOLD(J:J)>='0'&PARMHOLD(J:J)<='9' THEN            0174 00309000
         LA    @07,PARMHOLD-1(J)                                   0174 00310000
         CLI   0(@07),C'0'                                         0174 00311000
         BL    @RF00174                                            0174 00312000
         LA    @07,PARMHOLD-1(J)                                   0174 00313000
         CLI   0(@07),C'9'                                         0174 00314000
         BNH   @RT00174                                            0174 00315000
*           ;                       /*                       @Y30LB40*/ 00316000
*         ELSE                                                     0176 00317000
*           PARMERR='1'B;           /* ERROR,NON NUMERIC FOUND     0176 00318000
*                                                            @Y30LB40*/ 00319000
@RF00174 OI    PARMERR,B'10000000'                                 0176 00320000
*       END;                        /*                       @Y30LB40*/ 00321000
@RT00174 AL    J,@CF00043                                          0177 00322000
@DE00173 LA    @07,9                                               0177 00323000
         ALR   @07,SS                                              0177 00324000
         CR    J,@07                                               0177 00325000
         BNH   @DL00173                                            0177 00326000
*       IF PARMERR='1'B THEN                                       0178 00327000
         TM    PARMERR,B'10000000'                                 0178 00328000
         BO    @RT00178                                            0178 00329000
*         GO TO PARMEND;            /* IF ERROR,EXIT         @Y30LB40*/ 00330000
*       PACK(DOUBLEWD,PARMHOLD(SS:SS+1));/* CONVERT DATES    @Y30LB40*/ 00331000
         LA    @03,PARMHOLD-1(SS)                                  0180 00332000
         PACK  DOUBLEWD(8),0(2,@03)                                0180 00333000
*       CVB(HLDSYR,DOUBLEWD);       /*                       @Y30LB40*/ 00334000
         CVB   @03,DOUBLEWD                                        0181 00335000
         STC   @03,HLDSYR                                          0181 00336000
*       PACK(DOUBLEWD,PARMHOLD(SS+2:SS+4));/*                @Y30LB40*/ 00337000
         LA    @03,PARMHOLD+1(SS)                                  0182 00338000
         PACK  DOUBLEWD(8),0(3,@03)                                0182 00339000
*       CVB(HLDSDAY,DOUBLEWD);      /*                       @Y30LB40*/ 00340000
         CVB   @03,DOUBLEWD                                        0183 00341000
         STH   @03,HLDSDAY                                         0183 00342000
*       PACK(DOUBLEWD,PARMHOLD(SS+5:SS+6));/*                @Y30LB40*/ 00343000
         LA    @01,PARMHOLD+4(SS)                                  0184 00344000
         PACK  DOUBLEWD(8),0(2,@01)                                0184 00345000
*       CVB(HLDEYR,DOUBLEWD);       /*                       @Y30LB40*/ 00346000
         CVB   @15,DOUBLEWD                                        0185 00347000
         STC   @15,HLDEYR                                          0185 00348000
*       PACK(DOUBLEWD,PARMHOLD(SS+7:SS+9));/*                @Y30LB40*/ 00349000
         LA    @01,PARMHOLD+6(SS)                                  0186 00350000
         PACK  DOUBLEWD(8),0(3,@01)                                0186 00351000
*       CVB(HLDEDAY,DOUBLEWD);      /*                       @Y30LB40*/ 00352000
         CVB   @15,DOUBLEWD                                        0187 00353000
         STH   @15,HLDEDAY                                         0187 00354000
*       IF HLDSDAY>0&HLDSDAY<366    /* CHECK FOR VALID DAYS          */ 00355000
*         THEN                                                     0188 00356000
         LTR   @03,@03                                             0188 00357000
         BNP   @RF00188                                            0188 00358000
         C     @03,@CF00649                                        0188 00359000
         BL    @RT00188                                            0188 00360000
*         ;                         /*                       @Y30LB40*/ 00361000
*       ELSE                                                       0190 00362000
*         DO;                       /*                       @Y30LB40*/ 00363000
@RF00188 DS    0H                                                  0191 00364000
*           IF HLDSDAY=366 THEN                                    0191 00365000
         CLC   HLDSDAY(2),@CH00649                                 0191 00366000
         BNE   @RF00191                                            0191 00367000
*             DO;                   /* DAY = 366 CHECK FOR LEAP YEAR    00368000
*                                                            @Y30LB40*/ 00369000
*               IF(CKSTIME(1:1)&'00000011'B)^='00000000'B THEN     0193 00370000
         MVC   @TS00001(1),CKSTIME                                 0193 00371000
         NI    @TS00001,B'00000011'                                0193 00372000
         CLI   @TS00001,B'00000000'                                0193 00373000
         BE    @RF00193                                            0193 00374000
*                 PARMERR='1'B;     /* BAD DAY,ERROR         @Y30LB40*/ 00375000
         OI    PARMERR,B'10000000'                                 0194 00376000
*             END;                  /*                       @Y30LB40*/ 00377000
*           ELSE                                                   0196 00378000
*             PARMERR='1'B;         /* BAD DAY,ERROR         @Y30LB40*/ 00379000
         B     @RC00191                                            0196 00380000
@RF00191 OI    PARMERR,B'10000000'                                 0196 00381000
*         END;                      /*                       @Y30LB40*/ 00382000
@RC00191 DS    0H                                                  0198 00383000
*       IF HLDEDAY>0&HLDEDAY<366    /* CHECK END DAY FOR SAME        */ 00384000
*         THEN                                                     0198 00385000
@RT00188 LH    @03,HLDEDAY                                         0198 00386000
         LTR   @03,@03                                             0198 00387000
         BNP   @RF00198                                            0198 00388000
         C     @03,@CF00649                                        0198 00389000
         BL    @RT00198                                            0198 00390000
*         ;                         /*                       @Y30LB40*/ 00391000
*       ELSE                                                       0200 00392000
*         DO;                       /*                       @Y30LB40*/ 00393000
@RF00198 DS    0H                                                  0201 00394000
*           IF HLDEDAY=366 THEN                                    0201 00395000
         CLC   HLDEDAY(2),@CH00649                                 0201 00396000
         BNE   @RF00201                                            0201 00397000
*             DO;                   /*                       @Y30LB40*/ 00398000
*               IF(CKETIME(1:1)&'00000011'B)^='00000000'B THEN     0203 00399000
         MVC   @TS00001(1),CKETIME                                 0203 00400000
         NI    @TS00001,B'00000011'                                0203 00401000
         CLI   @TS00001,B'00000000'                                0203 00402000
         BE    @RF00203                                            0203 00403000
*                 PARMERR='1'B;     /*                       @Y30LB40*/ 00404000
         OI    PARMERR,B'10000000'                                 0204 00405000
*             END;                  /*                       @Y30LB40*/ 00406000
*           ELSE                                                   0206 00407000
*             PARMERR='1'B;         /*                       @Y30LB40*/ 00408000
         B     @RC00201                                            0206 00409000
@RF00201 OI    PARMERR,B'10000000'                                 0206 00410000
*         END;                      /*                       @Y30LB40*/ 00411000
@RC00201 DS    0H                                                  0208 00412000
*       IF HLDSYR<=HLDEYR           /* END YEAR MUST BE >= START YEAR   00413000
*                                                            @Y30LB40*/ 00414000
*         THEN                                                     0208 00415000
@RT00198 CLC   HLDSYR(1),HLDEYR                                    0208 00416000
         BNH   @RT00208                                            0208 00417000
*         ;                         /*                       @Y30LB40*/ 00418000
*       ELSE                                                       0210 00419000
*         PARMERR='1'B;             /*                       @Y30LB40*/ 00420000
         OI    PARMERR,B'10000000'                                 0210 00421000
*       IF HLDSDAY<=HLDEDAY         /* END DAY MUST BE >= END DAY  0211 00422000
*                                      UNLESS                        */ 00423000
*         THEN                                                     0211 00424000
@RT00208 LH    @03,HLDSDAY                                         0211 00425000
         CH    @03,HLDEDAY                                         0211 00426000
         BNH   @RT00211                                            0211 00427000
*         ;                         /* YEARS ARE DIFFERENT   @Y30LB40*/ 00428000
*       ELSE                                                       0213 00429000
*         DO;                       /*                       @Y30LB40*/ 00430000
*           IF HLDSYR=HLDEYR THEN                                  0214 00431000
         CLC   HLDSYR(1),HLDEYR                                    0214 00432000
         BNE   @RF00214                                            0214 00433000
*             PARMERR='1'B;         /* ERROR                         */ 00434000
         OI    PARMERR,B'10000000'                                 0215 00435000
*         END;                      /*                       @Y30LB40*/ 00436000
@RF00214 DS    0H                                                  0217 00437000
*       IF PARMERR='1'B THEN                                       0217 00438000
@RT00211 TM    PARMERR,B'10000000'                                 0217 00439000
         BO    @RT00217                                            0217 00440000
*         GO TO PARMEND;            /* IF ERRORS FOUND,EXIT          */ 00441000
*       DATEINSW='1'B;              /* INDICATE VALID DATES ENTERED     00442000
*                                                            @Y30LB40*/ 00443000
         OI    DATEINSW,B'10000000'                                0219 00444000
*       SS=SS+11;                   /* BUMP POINTER TO NEXT VALUE  0220 00445000
*                                                            @Y30LB40*/ 00446000
         AL    SS,@CF00033                                         0220 00447000
*     END;                          /*                       @Y30LB40*/ 00448000
*   IF PARMHOLD(SS:SS)=','          /* WERE TIMES ENTERED    @Y30LB40*/ 00449000
*     THEN                                                         0222 00450000
@RC00170 LA    @03,PARMHOLD-1(SS)                                  0222 00451000
         CLI   0(@03),C','                                         0222 00452000
         BNE   @RF00222                                            0222 00453000
*     SS=SS+1;                      /* NO, BUMP POINTER TO NEXT VALUE   00454000
*                                                            @Y30LB40*/ 00455000
         AL    SS,@CF00043                                         0223 00456000
*   ELSE                                                           0224 00457000
*     DO;                           /* YES                   @Y30LB40*/ 00458000
         B     @RC00222                                            0224 00459000
@RF00222 DS    0H                                                  0225 00460000
*       DO J=SS TO(SS+7);           /* VALIDATE AND CONVERT TIMES  0225 00461000
*                                                            @Y30LB40*/ 00462000
         LR    J,SS                                                0225 00463000
         B     @DE00225                                            0225 00464000
@DL00225 DS    0H                                                  0226 00465000
*         IF PARMHOLD(J:J)>='0'&PARMHOLD(J:J)<='9' THEN            0226 00466000
         LA    @07,PARMHOLD-1(J)                                   0226 00467000
         CLI   0(@07),C'0'                                         0226 00468000
         BL    @RF00226                                            0226 00469000
         LA    @07,PARMHOLD-1(J)                                   0226 00470000
         CLI   0(@07),C'9'                                         0226 00471000
         BNH   @RT00226                                            0226 00472000
*           ;                       /*                       @Y30LB40*/ 00473000
*         ELSE                                                     0228 00474000
*           PARMERR='1'B;           /* NON NUMERIC FOUND,ERROR     0228 00475000
*                                                            @Y30LB40*/ 00476000
@RF00226 OI    PARMERR,B'10000000'                                 0228 00477000
*       END;                        /*                       @Y30LB40*/ 00478000
@RT00226 AL    J,@CF00043                                          0229 00479000
@DE00225 LA    @07,7                                               0229 00480000
         ALR   @07,SS                                              0229 00481000
         CR    J,@07                                               0229 00482000
         BNH   @DL00225                                            0229 00483000
*       IF PARMERR='1'B THEN                                       0230 00484000
         TM    PARMERR,B'10000000'                                 0230 00485000
         BO    @RT00230                                            0230 00486000
*         GO TO PARMEND;            /* IF ERRORS FOUND,EXIT          */ 00487000
*       PACK(DOUBLEWD,PARMHOLD(SS:SS+1));/* CONVERT TIMES    @Y30LB40*/ 00488000
         LA    @01,PARMHOLD-1(SS)                                  0232 00489000
         PACK  DOUBLEWD(8),0(2,@01)                                0232 00490000
*       CVB(TIMEWORK,DOUBLEWD);     /*                       @Y30LB40*/ 00491000
         CVB   TIMEWORK,DOUBLEWD                                   0233 00492000
*       IF TIMEWORK>23 THEN                                        0234 00493000
         C     TIMEWORK,@CF00652                                   0234 00494000
         BNH   @RF00234                                            0234 00495000
*         PARMERR='1'B;             /* HOUR MUST BE <= 23            */ 00496000
         OI    PARMERR,B'10000000'                                 0235 00497000
*       ELSE                                                       0236 00498000
*         HLDSTIME=TIMEWORK*3600;   /*                       @Y30LB40*/ 00499000
         B     @RC00234                                            0236 00500000
@RF00234 LR    @15,TIMEWORK                                        0236 00501000
         MH    @15,@CH00653                                        0236 00502000
         ST    @15,HLDSTIME                                        0236 00503000
*       PACK(DOUBLEWD,PARMHOLD(SS+2:SS+3));/*                @Y30LB40*/ 00504000
@RC00234 LA    @01,PARMHOLD+1(SS)                                  0237 00505000
         PACK  DOUBLEWD(8),0(2,@01)                                0237 00506000
*       CVB(TIMEWORK,DOUBLEWD);     /*                       @Y30LB40*/ 00507000
         CVB   TIMEWORK,DOUBLEWD                                   0238 00508000
*       IF TIMEWORK>59 THEN                                        0239 00509000
         C     TIMEWORK,@CF00654                                   0239 00510000
         BNH   @RF00239                                            0239 00511000
*         PARMERR='1'B;             /* MINUTE MUST BE <= 59          */ 00512000
         OI    PARMERR,B'10000000'                                 0240 00513000
*       ELSE                                                       0241 00514000
*         HLDSTIME=HLDSTIME+(TIMEWORK*60);/*                 @Y30LB40*/ 00515000
         B     @RC00239                                            0241 00516000
@RF00239 LR    @15,TIMEWORK                                        0241 00517000
         MH    @15,@CH00334                                        0241 00518000
         AL    @15,HLDSTIME                                        0241 00519000
         ST    @15,HLDSTIME                                        0241 00520000
*       PACK(DOUBLEWD,PARMHOLD(SS+4:SS+5));/*                @Y30LB40*/ 00521000
@RC00239 LA    @01,PARMHOLD+3(SS)                                  0242 00522000
         PACK  DOUBLEWD(8),0(2,@01)                                0242 00523000
*       CVB(TIMEWORK,DOUBLEWD);     /*                       @Y30LB40*/ 00524000
         CVB   TIMEWORK,DOUBLEWD                                   0243 00525000
*       IF TIMEWORK>23 THEN                                        0244 00526000
         C     TIMEWORK,@CF00652                                   0244 00527000
         BNH   @RF00244                                            0244 00528000
*         PARMERR='1'B;             /*                       @Y30LB40*/ 00529000
         OI    PARMERR,B'10000000'                                 0245 00530000
*       ELSE                                                       0246 00531000
*         HLDETIME=TIMEWORK*3600;   /*                       @Y30LB40*/ 00532000
         B     @RC00244                                            0246 00533000
@RF00244 LR    @15,TIMEWORK                                        0246 00534000
         MH    @15,@CH00653                                        0246 00535000
         ST    @15,HLDETIME                                        0246 00536000
*       PACK(DOUBLEWD,PARMHOLD(SS+6:SS+7));/*                @Y30LB40*/ 00537000
@RC00244 LA    @01,PARMHOLD+5(SS)                                  0247 00538000
         PACK  DOUBLEWD(8),0(2,@01)                                0247 00539000
*       CVB(TIMEWORK,DOUBLEWD);     /*                       @Y30LB40*/ 00540000
         CVB   TIMEWORK,DOUBLEWD                                   0248 00541000
*       IF TIMEWORK>59 THEN                                        0249 00542000
         C     TIMEWORK,@CF00654                                   0249 00543000
         BNH   @RF00249                                            0249 00544000
*         PARMERR='1'B;             /*                       @Y30LB40*/ 00545000
         OI    PARMERR,B'10000000'                                 0250 00546000
*       ELSE                                                       0251 00547000
*         HLDETIME=HLDETIME+(TIMEWORK*60)+59;/*              @Y30LB40*/ 00548000
         B     @RC00249                                            0251 00549000
@RF00249 LR    @15,TIMEWORK                                        0251 00550000
         MH    @15,@CH00334                                        0251 00551000
         AL    @15,HLDETIME                                        0251 00552000
         AL    @15,@CF00654                                        0251 00553000
         ST    @15,HLDETIME                                        0251 00554000
*       IF HLDSYR=HLDEYR&HLDSDAY=HLDEDAY THEN                      0252 00555000
@RC00249 CLC   HLDSYR(1),HLDEYR                                    0252 00556000
         BNE   @RF00252                                            0252 00557000
         CLC   HLDSDAY(2),HLDEDAY                                  0252 00558000
         BNE   @RF00252                                            0252 00559000
*         IF HLDSTIME>HLDETIME THEN                                0253 00560000
         L     @03,HLDSTIME                                        0253 00561000
         C     @03,HLDETIME                                        0253 00562000
         BNH   @RF00253                                            0253 00563000
*           PARMERR='1'B;           /*                       @Y30LB40*/ 00564000
         OI    PARMERR,B'10000000'                                 0254 00565000
*       IF PARMERR='0'B&DATEINSW='0'B/* WERE DATES ENTERED           */ 00566000
*         THEN                                                     0255 00567000
@RF00253 DS    0H                                                  0255 00568000
@RF00252 TM    PARMERR,B'10000000'                                 0255 00569000
         BNZ   @RF00255                                            0255 00570000
         TM    DATEINSW,B'10000000'                                0255 00571000
         BNZ   @RF00255                                            0255 00572000
*         PARMERR='1'B;             /* NO,ERROR              @Y30LB40*/ 00573000
         OI    PARMERR,B'10000000'                                 0256 00574000
*       SS=SS+9;                    /* YES,BUMP TO NEXT VALUE        */ 00575000
@RF00255 AL    SS,@CF00423                                         0257 00576000
*     END;                          /*                       @Y30LB40*/ 00577000
*   IF PARMERR='1'B THEN                                           0259 00578000
@RC00222 TM    PARMERR,B'10000000'                                 0259 00579000
         BO    @RT00259                                            0259 00580000
*     GO TO PARMEND;                /* IF ERRORS FOUND,EXIT          */ 00581000
*   IF PARMHOLD(SS:SS)=','          /* WAS VOLID SPECIFIED   @Y30LB40*/ 00582000
*     THEN                                                         0261 00583000
         LA    @03,PARMHOLD-1(SS)                                  0261 00584000
         CLI   0(@03),C','                                         0261 00585000
         BE    @RT00261                                            0261 00586000
*     ;                             /* NO, PROCESS FINISHED  @Y30LB40*/ 00587000
*   ELSE                                                           0263 00588000
*     DO;                           /* YES,CHECK FOR SIX BYTES     0263 00589000
*                                      ENTERED                       */ 00590000
*       DO J=SS TO(SS+5);           /*                       @Y30LB40*/ 00591000
         LR    J,SS                                                0264 00592000
         B     @DE00264                                            0264 00593000
@DL00264 DS    0H                                                  0265 00594000
*         IF PARMHOLD(J:J)=',' THEN                                0265 00595000
         LA    @07,PARMHOLD-1(J)                                   0265 00596000
         CLI   0(@07),C','                                         0265 00597000
         BNE   @RF00265                                            0265 00598000
*           DO;                     /*                       @Y30LB40*/ 00599000
*             PARMERR='1'B;         /* COMMA FOUND BEFORE END,ERROR     00600000
*                                                            @Y30LB40*/ 00601000
         OI    PARMERR,B'10000000'                                 0267 00602000
*             J=SS+5;               /* STOP LOOP             @Y30LB40*/ 00603000
         LA    J,5                                                 0268 00604000
         ALR   J,SS                                                0268 00605000
*           END;                    /*                       @Y30LB40*/ 00606000
*       END;                        /*                       @Y30LB40*/ 00607000
@RF00265 AL    J,@CF00043                                          0270 00608000
@DE00264 LA    @07,5                                               0270 00609000
         ALR   @07,SS                                              0270 00610000
         CR    J,@07                                               0270 00611000
         BNH   @DL00264                                            0270 00612000
*       IF PARMERR='1'B             /* IF ERROR FOUND,EXIT   @Y30LB40*/ 00613000
*         THEN                                                     0271 00614000
         TM    PARMERR,B'10000000'                                 0271 00615000
         BO    @RT00271                                            0271 00616000
*         GO TO PARMEND;            /*                       @Y30LB40*/ 00617000
*       ELSE                                                       0273 00618000
*         VOL=PARMHOLD(SS:SS+5);    /* NO ERROR,SAVE VOLID   @Y30LB40*/ 00619000
         LA    @03,PARMHOLD-1(SS)                                  0273 00620000
         MVC   VOL(6),0(@03)                                       0273 00621000
*     END;                          /*                       @Y30LB40*/ 00622000
*PARMEND:                                                          0275 00623000
*   IF PARMERR='1'B                 /* IF ERRORS FOUND,PRINT ERROR 0275 00624000
*                                      MSG,EXIT WITH                 */ 00625000
*     THEN                                                         0275 00626000
@RT00261 DS    0H                                                  0275 00627000
PARMEND  TM    PARMERR,B'10000000'                                 0275 00628000
         BNO   @RF00275                                            0275 00629000
*     DO;                           /* RETURN CODE = 8       @Y30LB40*/ 00630000
*       PRINTLN=PARMMSG;            /*                       @Y30LB40*/ 00631000
         MVI   PRINTLN+28,C' '                                     0277 00632000
         MVC   PRINTLN+29(92),PRINTLN+28                           0277 00633000
         MVC   PRINTLN(28),PARMMSG                                 0277 00634000
*       RFY                                                        0278 00635000
*        (R0,                                                      0278 00636000
*         R1,                                                      0278 00637000
*         R14,                                                     0278 00638000
*         R15) RSTD;                /*                       @Y30LB40*/ 00639000
*       GEN(PUT   PRNTDCB,PRINTLN); /*                       @Y30LB40*/ 00640000
         PUT   PRNTDCB,PRINTLN                                          00641000
*       RFY                                                        0280 00642000
*        (R0,                                                      0280 00643000
*         R1,                                                      0280 00644000
*         R14,                                                     0280 00645000
*         R15) UNRSTD;              /*                       @Y30LB40*/ 00646000
*       RETURNCD=8;                 /*                       @Y30LB40*/ 00647000
         LA    RETURNCD,8                                          0281 00648000
*       GO TO CLOSEFIL;             /*                       @Y30LB40*/ 00649000
         B     CLOSEFIL                                            0282 00650000
*     END;                          /*                       @Y30LB40*/ 00651000
*   RFY                                                            0284 00652000
*    (R0,                                                          0284 00653000
*     R1,                                                          0284 00654000
*     R14,                                                         0284 00655000
*     R15) RSTD;                    /*                       @Y30LB40*/ 00656000
@RF00275 DS    0H                                                  0285 00657000
*   GEN(TIME);                      /* GET AND CONVERT TODAYS DATE 0285 00658000
*                                                            @Y30LB40*/ 00659000
         TIME                                                           00660000
*   GEN(ST    R1,DOUBLEWD);         /*                       @Y30LB40*/ 00661000
         ST    R1,DOUBLEWD                                              00662000
*   RFY                                                            0287 00663000
*    (R0,                                                          0287 00664000
*     R1,                                                          0287 00665000
*     R14,                                                         0287 00666000
*     R15) UNRSTD;                  /*                       @Y30LB40*/ 00667000
*   UNPK(TODAY,DOUBLEWD(2:4));      /*                       @Y30LB40*/ 00668000
         UNPK  TODAY(5),DOUBLEWD+1(3)                              0288 00669000
*                                                                  0289 00670000
*/********************************************************************  00671000
*                                                                    */ 00672000
*/* BEGIN PROCESSING THE FILE                                @Y30LB40*/ 00673000
*/********************************************************************  00674000
*                                                                    */ 00675000
*                                                                  0289 00676000
*RDTRACE:                                                          0289 00677000
*   RFY                                                            0289 00678000
*    (R0,                                                          0289 00679000
*     R1,                                                          0289 00680000
*     R14,                                                         0289 00681000
*     R15) RSTD;                    /*                       @Y30LB40*/ 00682000
RDTRACE  DS    0H                                                  0290 00683000
*   GEN(GET   INDCB,RCDIN);         /* READ AN INPUT RECORD  @Y30LB40*/ 00684000
         GET   INDCB,RCDIN                                              00685000
*   RFY                                                            0291 00686000
*    (R0,                                                          0291 00687000
*     R1,                                                          0291 00688000
*     R14,                                                         0291 00689000
*     R15) UNRSTD;                  /*                       @Y30LB40*/ 00690000
*   IF CKTIME<CKSTIME|CKTIME>CKETIME/* IF NOT IN DATE AND TIME       */ 00691000
*     THEN                                                         0292 00692000
         CLC   CKTIME(7),CKSTIME                                   0292 00693000
         BL    @RT00292                                            0292 00694000
         CLC   CKTIME(7),CKETIME                                   0292 00695000
         BH    @RT00292                                            0292 00696000
*     GO TO RDTRACE;                /* RANGE,READ NEXT RECORD        */ 00697000
*   IF(DSTGD+STGD)^>0 THEN                                         0294 00698000
         L     @15,DSTGD                                           0294 00699000
         AL    @15,STGD                                            0294 00700000
         LTR   @15,@15                                             0294 00701000
         BNP   @RT00294                                            0294 00702000
*     GO TO RDTRACE;                /* BYPASS ZERO RCDS              */ 00703000
*   IF VOL^='      '                /* IF VOLID SPECIFIED AND      0296 00704000
*                                                            @Y30LB40*/ 00705000
*     THEN                                                         0296 00706000
         CLC   VOL(6),@CC00659                                     0296 00707000
         BE    @RF00296                                            0296 00708000
*     IF VOLID^=VOL                 /* RECORD DOES NOT MATCH @Y30LB40*/ 00709000
*       THEN                                                       0297 00710000
         CLC   VOLID(6),VOL                                        0297 00711000
         BNE   @RT00297                                            0297 00712000
*       GO TO RDTRACE;              /* THEN READ NEXT RECORD @Y30LB40*/ 00713000
*   SNL=LIBRARY;                    /* SET UP NEW LIBRARY    @Y30LB40*/ 00714000
@RF00296 MVC   SNL(1),LIBRARY                                      0299 00715000
*   SNV=VOLID;                      /* SET UP NEW VOLID      @Y30LB40*/ 00716000
         MVC   SNV(6),VOLID                                        0300 00717000
*   SNT=CKTIME;                     /* SET UP NEW DATE AND TIME    0301 00718000
*                                                            @Y30LB40*/ 00719000
         MVC   SNT(7),CKTIME                                       0301 00720000
*   IF SEQNEW<SEQOLD                /* IS FILE OUT OF SEQUENCE     0302 00721000
*                                                            @Y30LB40*/ 00722000
*     THEN                                                         0302 00723000
         CLC   SEQNEW(14),SEQOLD                                   0302 00724000
         BNL   @RF00302                                            0302 00725000
*     DO;                           /* YES                   @Y30LB40*/ 00726000
*       PRINTLN=SEQMSG;             /* SET UP ERROR MESSAGE  @Y30LB40*/ 00727000
         MVI   PRINTLN+43,C' '                                     0304 00728000
         MVC   PRINTLN+44(77),PRINTLN+43                           0304 00729000
         MVC   PRINTLN(43),SEQMSG                                  0304 00730000
*       RFY                                                        0305 00731000
*        (R0,                                                      0305 00732000
*         R1,                                                      0305 00733000
*         R14,                                                     0305 00734000
*         R15) RSTD;                /*                       @Y30LB40*/ 00735000
*       GEN(PUT   PRNTDCB,PRINTLN); /* PRINT MESSAGE         @Y30LB40*/ 00736000
         PUT   PRNTDCB,PRINTLN                                          00737000
*       RFY                                                        0307 00738000
*        (R0,                                                      0307 00739000
*         R1,                                                      0307 00740000
*         R14,                                                     0307 00741000
*         R15) UNRSTD;              /*                       @Y30LB40*/ 00742000
*       RETURNCD=8;                 /* SET UP RETURN CODE    @Y30LB40*/ 00743000
         LA    RETURNCD,8                                          0308 00744000
*       GO TO CLOSEFIL;             /* GET OUT OF PROGRAM    @Y30LB40*/ 00745000
         B     CLOSEFIL                                            0309 00746000
*     END;                          /*                       @Y30LB40*/ 00747000
*   ELSE                                                           0311 00748000
*     SEQOLD=SEQNEW;                /* FILE OK,SAVE SEQUENCE @Y30LB40*/ 00749000
@RF00302 MVC   SEQOLD(14),SEQNEW                                   0311 00750000
*   RCDCOUNT=RCDCOUNT+1;            /* COUNT INPUT RECORDS   @Y30LB40*/ 00751000
         LA    @15,1                                               0312 00752000
         AL    @15,RCDCOUNT                                        0312 00753000
         ST    @15,RCDCOUNT                                        0312 00754000
*   IF FIRSTSW='1'B                 /* TEST IF FIRST RECORD  @Y30LB40*/ 00755000
*     THEN                                                         0313 00756000
         TM    FIRSTSW,B'10000000'                                 0313 00757000
         BNO   @RF00313                                            0313 00758000
*     DO;                           /*                       @Y30LB40*/ 00759000
*       FIRSTSW='0'B;               /* TURN OFF 1ST RECORD SWITCH    */ 00760000
         NI    FIRSTSW,B'01111111'                                 0315 00761000
*NEWLIB:                                                           0316 00762000
*                                                                  0316 00763000
*       /*************************************************************/ 00764000
*       /*                                                           */ 00765000
*       /* ************************************************  @OZ11673*/ 00766000
*       /* SET UP INITIAL TIMESLICE COMPARE RECORD USING     @OZ11673*/ 00767000
*       /* THE STARTING TIME SPECIFIED IN THE DATE AND       @OZ11673*/ 00768000
*       /* TIME PARAMETERS, OR THE DEFAULT VALUES.           @OZ11673*/ 00769000
*       /* ************************************************  @OZ11673*/ 00770000
*       /*                                                           */ 00771000
*       /*************************************************************/ 00772000
*                                                                  0316 00773000
*       TSBEG=CKSTIME;              /*                       @OZ11673*/ 00774000
NEWLIB   MVC   TSBEG(7),CKSTIME                                    0316 00775000
*       TSEND=CKSTIME;              /*                       @OZ11673*/ 00776000
         MVC   TSEND(7),CKSTIME                                    0317 00777000
*       TSEYR=SVEYEAR;              /*                       @OZ11673*/ 00778000
         MVC   TSEYR(1),SVEYEAR                                    0318 00779000
*       TSETIME=TSETIME+TIMESL;     /*                       @OZ11673*/ 00780000
         L     @15,TSETIME                                         0319 00781000
         AL    @15,TIMESL                                          0319 00782000
         ST    @15,TSETIME                                         0319 00783000
*       CALL GETSLICE;              /*                       @OZ11673*/ 00784000
         BAL   @14,GETSLICE                                        0320 00785000
*       VOLUME=VOLID;               /* STORE 1ST VOLUME IDENT      0321 00786000
*                                                            @Y30LB40*/ 00787000
         MVC   VOLUME(6),VOLID                                     0321 00788000
*       LIB=LIBRARY;                /* STORE 1ST LIBRARY     @Y30LB40*/ 00789000
         MVC   LIB(1),LIBRARY                                      0322 00790000
*     END;                          /*                       @Y30LB40*/ 00791000
*CHECKTIM:                          /* CHECK FOR CONTROL BREAKS    0324 00792000
*                                                            @Y30LB40*/ 00793000
*   IF LIBRARY^=LIB THEN                                           0324 00794000
@RF00313 DS    0H                                                  0324 00795000
CHECKTIM CLC   LIBRARY(1),LIB                                      0324 00796000
         BE    @RF00324                                            0324 00797000
*     DO;                           /* IF LIBRARY CHANGED,CONTROL  0325 00798000
*                                      BREAK                 @Y30LB40*/ 00799000
*       LIBSW='1'B;                 /*                       @Y30LB40*/ 00800000
         OI    LIBSW,B'10000000'                                   0326 00801000
*       GO TO VOLIDBRK;             /*                       @Y30LB40*/ 00802000
         B     VOLIDBRK                                            0327 00803000
*     END;                          /*                       @Y30LB40*/ 00804000
*   IF VOLUME^=VOLID THEN                                          0329 00805000
@RF00324 CLC   VOLUME(6),VOLID                                     0329 00806000
         BE    @RF00329                                            0329 00807000
*     DO;                           /* IF VOLUME CHANGED,CONTROL   0330 00808000
*                                      BREAK                 @Y30LB40*/ 00809000
*       VOLSW='1'B;                 /*                       @Y30LB40*/ 00810000
         OI    VOLSW,B'10000000'                                   0331 00811000
*       GO TO VOLIDBRK;             /*                       @Y30LB40*/ 00812000
         B     VOLIDBRK                                            0332 00813000
*     END;                          /*                       @Y30LB40*/ 00814000
*   IF CKTIME>TSEND THEN                                           0334 00815000
@RF00329 CLC   CKTIME(7),TSEND                                     0334 00816000
         BNH   @RF00334                                            0334 00817000
*     DO;                           /* IF TIME SLICE EXCEEDED,CONTROL   00818000
*                                      BREAK                 @Y30LB40*/ 00819000
*       TMESW='1'B;                 /*                       @Y30LB40*/ 00820000
         OI    TMESW,B'10000000'                                   0336 00821000
*       GO TO VOLIDBRK;             /*                       @Y30LB40*/ 00822000
         B     VOLIDBRK                                            0337 00823000
*     END;                          /*                       @Y30LB40*/ 00824000
*SUMIT:                             /* ACCUM VALUES FOR TIMESLICE AND   00825000
*                                      VOLID                 @Y30LB40*/ 00826000
*   DO I=1 TO 2;                    /*                       @Y30LB40*/ 00827000
@RF00334 DS    0H                                                  0339 00828000
SUMIT    LA    I,1                                                 0339 00829000
@DL00339 DS    0H                                                  0340 00830000
*     IF CARTPAIR=0                 /* SET J ACCORDING TO CARTRIDGE     00831000
*                                      PAIR NUMBER                   */ 00832000
*       THEN                                                       0340 00833000
         CLI   CARTPAIR,0                                          0340 00834000
         BNE   @RF00340                                            0340 00835000
*       J=1;                        /*                       @Y30LB40*/ 00836000
         LA    J,1                                                 0341 00837000
*     ELSE                                                         0342 00838000
*       J=2;                        /*                       @Y30LB40*/ 00839000
         B     @RC00340                                            0342 00840000
@RF00340 LA    J,2                                                 0342 00841000
*     SMSTGD(I,J)=SMSTGD(I,J)+STGD; /* ACCUM CYLS STAGED     @Y30LB40*/ 00842000
@RC00340 LR    @15,I                                               0343 00843000
         ALR   @15,@15                                             0343 00844000
         ALR   @15,J                                               0343 00845000
         MH    @15,@CH00729                                        0343 00846000
         L     @14,SMSTGD-108(@15)                                 0343 00847000
         AL    @14,STGD                                            0343 00848000
         ST    @14,SMSTGD-108(@15)                                 0343 00849000
*     SMCFAULT(I,J)=SMCFAULT(I,J)+CFAULT;/* ACCUM CYL FAULT CAUSED   */ 00850000
         L     @14,SMCFAULT-108(@15)                               0344 00851000
         AL    @14,CFAULT                                          0344 00852000
         ST    @14,SMCFAULT-108(@15)                               0344 00853000
*     SMDSTGD(I,J)=SMDSTGD(I,J)+DSTGD;/* ACCUM CYLS DESTAGED         */ 00854000
         L     @14,SMDSTGD-108(@15)                                0345 00855000
         AL    @14,DSTGD                                           0345 00856000
         ST    @14,SMDSTGD-108(@15)                                0345 00857000
*     SMSALLOC(I,J)=SMSALLOC(I,J)+SALLOC;/* ACCUM SPACE ALLOC CAUSED */ 00858000
         L     @14,SMSALLOC-108(@15)                               0346 00859000
         AL    @14,SALLOC                                          0346 00860000
         ST    @14,SMSALLOC-108(@15)                               0346 00861000
*     LOADS(I,J)=LOADS(I,J)+LOADNUM;/* ACCUM NUMBER OF LOADS         */ 00862000
         SLR   @14,@14                                             0347 00863000
         IC    @14,LOADNUM                                         0347 00864000
         AL    @14,LOADS-108(@15)                                  0347 00865000
         ST    @14,LOADS-108(@15)                                  0347 00866000
*     STGDTOT(I,J)=STGDTOT(I,J)+STGDNUM;/* ACCUM NUMBER OF STAGES    */ 00867000
         SLR   @14,@14                                             0348 00868000
         IC    @14,STGDNUM                                         0348 00869000
         AL    @14,STGDTOT-108(@15)                                0348 00870000
         ST    @14,STGDTOT-108(@15)                                0348 00871000
*     DSTGDTOT(I,J)=DSTGDTOT(I,J)+DSTGDNUM;/* ACCUM DESTAGES         */ 00872000
         SLR   @14,@14                                             0349 00873000
         IC    @14,DSTGDNUM                                        0349 00874000
         AL    @14,DSTGDTOT-108(@15)                               0349 00875000
         ST    @14,DSTGDTOT-108(@15)                               0349 00876000
*     IF CARTPAIR=0                 /* IF PAIR 0 ACCUM VTOC STAGES 0350 00877000
*                                      AND                   @Y30LB40*/ 00878000
*       THEN                                                       0350 00879000
         CLI   CARTPAIR,0                                          0350 00880000
         BNE   @RF00350                                            0350 00881000
*       DO;                         /* DESTAGES              @Y30LB40*/ 00882000
*         VTOCSG(I,J)=VTOCSG(I,J)+VTOCSTG;/*                 @Y30LB40*/ 00883000
         SLR   @14,@14                                             0352 00884000
         IC    @14,VTOCSTG                                         0352 00885000
         AL    @14,VTOCSG-108(@15)                                 0352 00886000
         ST    @14,VTOCSG-108(@15)                                 0352 00887000
*         VTOCDS(I,J)=VTOCDS(I,J)+VTOCDSTG;/*                @Y30LB40*/ 00888000
         SLR   @14,@14                                             0353 00889000
         IC    @14,VTOCDSTG                                        0353 00890000
         AL    @14,VTOCDS-108(@15)                                 0353 00891000
         ST    @14,VTOCDS-108(@15)                                 0353 00892000
*       END;                        /*                       @Y30LB40*/ 00893000
*   END;                            /*                       @Y30LB40*/ 00894000
@RF00350 AL    I,@CF00043                                          0355 00895000
         C     I,@CF00050                                          0355 00896000
         BNH   @DL00339                                            0355 00897000
*   GO TO RDTRACE;                  /* GO READ NEXT RECORD   @Y30LB40*/ 00898000
         B     RDTRACE                                             0356 00899000
*                                                                  0357 00900000
*/********************************************************************  00901000
*                                                                    */ 00902000
*/**ROUTINE TO PRINT VOL ID DETAIL AND PROCESS CONTROL BREAKS*       */ 00903000
*/********************************************************************  00904000
*                                                                    */ 00905000
*                                                                  0357 00906000
*VOLIDBRK:                                                         0357 00907000
*   I=1;                            /* SET I FOR TIME SLICE TOTAL  0357 00908000
*                                                            @Y30LB40*/ 00909000
VOLIDBRK LA    I,1                                                 0357 00910000
*PROCBRK:                                                          0358 00911000
*   CALL SETLINE;                   /* GET PRINT LINE CONSTANT INFO     00912000
*                                                            @Y30LB40*/ 00913000
PROCBRK  BAL   @14,SETLINE                                         0358 00914000
*   IF I=2                          /* IF DOING VOLID TOTALS @Y30LB40*/ 00915000
*     THEN                                                         0359 00916000
         C     I,@CF00050                                          0359 00917000
         BNE   @RF00359                                            0359 00918000
*     DO;                           /*                       @Y30LB40*/ 00919000
*       PF1='TOTALS';               /* INDICATE VOLID TOTALS @Y30LB40*/ 00920000
         MVC   PF1(6),@CC00672                                     0361 00921000
*       PF3='        ';             /*                       @Y30LB40*/ 00922000
         MVC   PF3(8),@CC00673                                     0362 00923000
*     END;                          /*                       @Y30LB40*/ 00924000
*   DO J=1 TO 2;                    /* CHECK FOR BOTH CARTRIDGE PAIRS   00925000
*                                                            @Y30LB40*/ 00926000
@RF00359 LA    J,1                                                 0364 00927000
@DL00364 DS    0H                                                  0365 00928000
*     IF LINECNT>55 THEN                                           0365 00929000
         C     LINECNT,@CF00674                                    0365 00930000
         BNH   @RF00365                                            0365 00931000
*       DO;                         /* FORCE NEW PAGE HEADING      0366 00932000
*                                                            @Y30LB40*/ 00933000
*         LINECNT=6;                /* RESET PAGE COUNTER AND PRINT  */ 00934000
         LA    LINECNT,6                                           0367 00935000
*         PAGECNT=PAGECNT+1;        /* HEADINGS              @Y30LB40*/ 00936000
         LA    @15,1                                               0368 00937000
         AL    @15,PAGECNT                                         0368 00938000
         ST    @15,PAGECNT                                         0368 00939000
*         HEADHOLD=HDNG1;           /*                       @Y30LB40*/ 00940000
         MVC   HEADHOLD(121),HDNG1                                 0369 00941000
*         CALL EDITFIX(ADDR(PAGECNT),4,'S');/*               @Y30LB40*/ 00942000
         MVC   @AL00001+4(8),@AL00370                              0370 00943000
         LA    @15,PAGECNT                                         0370 00944000
         ST    @15,@AFTEMPS+4                                      0370 00945000
         LA    @15,@AFTEMPS+4                                      0370 00946000
         ST    @15,@AL00001                                        0370 00947000
         LA    @01,@AL00001                                        0370 00948000
         BAL   @14,EDITFIX                                         0370 00949000
*         HEADHOLD(118:121)=FIXOUT(10:13);/*                 @Y30LB40*/ 00950000
         MVC   HEADHOLD+117(4),FIXOUT+9                            0371 00951000
*         HEADHOLD(107:111)=TODAY;  /*                       @Y30LB40*/ 00952000
         MVC   HEADHOLD+106(5),TODAY                               0372 00953000
*         RFY                                                      0373 00954000
*          (R0,                                                    0373 00955000
*           R1,                                                    0373 00956000
*           R14,                                                   0373 00957000
*           R15) RSTD;              /*                       @Y30LB40*/ 00958000
*         GEN(PUT   PRNTDCB,HEADHOLD);/*                     @Y30LB40*/ 00959000
         PUT   PRNTDCB,HEADHOLD                                         00960000
*         GEN(PUT   PRNTDCB,HDNG2); /*                       @Y30LB40*/ 00961000
         PUT   PRNTDCB,HDNG2                                            00962000
*         GEN(PUT   PRNTDCB,HDNG3); /*                       @Y30LB40*/ 00963000
         PUT   PRNTDCB,HDNG3                                            00964000
*         GEN(PUT   PRNTDCB,HDNG4); /*                       @Y30LB40*/ 00965000
         PUT   PRNTDCB,HDNG4                                            00966000
*         GEN(PUT   PRNTDCB,SPACE1);/*                       @Y30LB40*/ 00967000
         PUT   PRNTDCB,SPACE1                                           00968000
*         RFY                                                      0379 00969000
*          (R0,                                                    0379 00970000
*           R1,                                                    0379 00971000
*           R14,                                                   0379 00972000
*           R15) UNRSTD;            /*                       @Y30LB40*/ 00973000
*       END;                        /*                       @Y30LB40*/ 00974000
*     IF SMSTGD(I,J)+SMDSTGD(I,J)^=0 THEN                          0381 00975000
@RF00365 LR    @15,I                                               0381 00976000
         ALR   @15,@15                                             0381 00977000
         ALR   @15,J                                               0381 00978000
         MH    @15,@CH00729                                        0381 00979000
         L     @14,SMSTGD-108(@15)                                 0381 00980000
         AL    @14,SMDSTGD-108(@15)                                0381 00981000
         LTR   @14,@14                                             0381 00982000
         BZ    @RF00381                                            0381 00983000
*       DO;                         /* IF ANY ACTIVITY,PRINT VALUES     00984000
*                                                            @Y30LB40*/ 00985000
*         IF J=1 THEN                                              0383 00986000
         C     J,@CF00043                                          0383 00987000
         BNE   @RF00383                                            0383 00988000
*           PF13A='0';              /* SET CARTRIDGE PAIR NUMBER   0384 00989000
*                                                            @Y30LB40*/ 00990000
         MVI   PF13A,C'0'                                          0384 00991000
*         ELSE                                                     0385 00992000
*           PF13A='1';              /*                       @Y30LB40*/ 00993000
         B     @RC00383                                            0385 00994000
@RF00383 MVI   PF13A,C'1'                                          0385 00995000
*         CALL EDITFIX(ADDR(SMSTGD(I,J)),4,'E');/*           @Y30LB40*/ 00996000
@RC00383 MVC   @AL00001+4(8),@AL00386                              0386 00997000
         LR    @15,I                                               0386 00998000
         ALR   @15,@15                                             0386 00999000
         ALR   @15,J                                               0386 01000000
         MH    @15,@CH00729                                        0386 01001000
         LA    @15,SMSTGD-108(@15)                                 0386 01002000
         ST    @15,@AFTEMPS+4                                      0386 01003000
         LA    @15,@AFTEMPS+4                                      0386 01004000
         ST    @15,@AL00001                                        0386 01005000
         LA    @01,@AL00001                                        0386 01006000
         BAL   @14,EDITFIX                                         0386 01007000
*         PF15=FIXOUT(5:13);        /* CYLINDERS STAGED      @Y30LB40*/ 01008000
         MVC   PF15(9),FIXOUT+4                                    0387 01009000
*         CALL EDITFIX(ADDR(SMCFAULT(I,J)),4,'E');/*         @Y30LB40*/ 01010000
         MVC   @AL00001+4(8),@AL00388                              0388 01011000
         LR    @15,I                                               0388 01012000
         ALR   @15,@15                                             0388 01013000
         ALR   @15,J                                               0388 01014000
         MH    @15,@CH00729                                        0388 01015000
         LA    @15,SMCFAULT-108(@15)                               0388 01016000
         ST    @15,@AFTEMPS+4                                      0388 01017000
         LA    @15,@AFTEMPS+4                                      0388 01018000
         ST    @15,@AL00001                                        0388 01019000
         LA    @01,@AL00001                                        0388 01020000
         BAL   @14,EDITFIX                                         0388 01021000
*         PF17=FIXOUT(5:13);        /* CYLINDER FAULT CAUSED @Y30LB40*/ 01022000
         MVC   PF17(9),FIXOUT+4                                    0389 01023000
*         CALL EDITFIX(ADDR(SMDSTGD(I,J)),4,'E');/*          @Y30LB40*/ 01024000
         MVC   @AL00001+4(8),@AL00390                              0390 01025000
         LR    @15,I                                               0390 01026000
         ALR   @15,@15                                             0390 01027000
         ALR   @15,J                                               0390 01028000
         MH    @15,@CH00729                                        0390 01029000
         LA    @15,SMDSTGD-108(@15)                                0390 01030000
         ST    @15,@AFTEMPS+4                                      0390 01031000
         LA    @15,@AFTEMPS+4                                      0390 01032000
         ST    @15,@AL00001                                        0390 01033000
         LA    @01,@AL00001                                        0390 01034000
         BAL   @14,EDITFIX                                         0390 01035000
*         PF19=FIXOUT(5:13);        /* CYLINDERS DESTAGED    @Y30LB40*/ 01036000
         MVC   PF19(9),FIXOUT+4                                    0391 01037000
*         CALL EDITFIX(ADDR(SMSALLOC(I,J)),4,'E');/*         @Y30LB40*/ 01038000
         MVC   @AL00001+4(8),@AL00392                              0392 01039000
         LR    @15,I                                               0392 01040000
         ALR   @15,@15                                             0392 01041000
         ALR   @15,J                                               0392 01042000
         MH    @15,@CH00729                                        0392 01043000
         LA    @15,SMSALLOC-108(@15)                               0392 01044000
         ST    @15,@AFTEMPS+4                                      0392 01045000
         LA    @15,@AFTEMPS+4                                      0392 01046000
         ST    @15,@AL00001                                        0392 01047000
         LA    @01,@AL00001                                        0392 01048000
         BAL   @14,EDITFIX                                         0392 01049000
*         PF21=FIXOUT(5:13);        /* SPACE ALLOCATOR CAUSED      0393 01050000
*                                                            @Y30LB40*/ 01051000
         MVC   PF21(9),FIXOUT+4                                    0393 01052000
*         SMSTGD(I,J)=SMSTGD(I,J)+SMDSTGD(I,J);/* TOT STAGING        */ 01053000
         LR    @15,I                                               0394 01054000
         ALR   @15,@15                                             0394 01055000
         ALR   @15,J                                               0394 01056000
         MH    @15,@CH00729                                        0394 01057000
         L     @14,SMSTGD-108(@15)                                 0394 01058000
         AL    @14,SMDSTGD-108(@15)                                0394 01059000
         ST    @14,SMSTGD-108(@15)                                 0394 01060000
*         CALL EDITFIX(ADDR(SMSTGD(I,J)),4,'E');/*           @Y30LB40*/ 01061000
         MVC   @AL00001+4(8),@AL00395                              0395 01062000
         LA    @15,SMSTGD-108(@15)                                 0395 01063000
         ST    @15,@AFTEMPS+4                                      0395 01064000
         LA    @15,@AFTEMPS+4                                      0395 01065000
         ST    @15,@AL00001                                        0395 01066000
         LA    @01,@AL00001                                        0395 01067000
         BAL   @14,EDITFIX                                         0395 01068000
*         PF23=FIXOUT(5:13);        /*                       @Y30LB40*/ 01069000
         MVC   PF23(9),FIXOUT+4                                    0396 01070000
*         CALL EDITFIX(ADDR(LOADS(I,J)),4,'S');/*            @Y30LB40*/ 01071000
         MVC   @AL00001+4(8),@AL00397                              0397 01072000
         LR    @15,I                                               0397 01073000
         ALR   @15,@15                                             0397 01074000
         ALR   @15,J                                               0397 01075000
         MH    @15,@CH00729                                        0397 01076000
         LA    @15,LOADS-108(@15)                                  0397 01077000
         ST    @15,@AFTEMPS+4                                      0397 01078000
         LA    @15,@AFTEMPS+4                                      0397 01079000
         ST    @15,@AL00001                                        0397 01080000
         LA    @01,@AL00001                                        0397 01081000
         BAL   @14,EDITFIX                                         0397 01082000
*         PF31=FIXOUT(10:13);       /* NUMBER OF LOADS       @Y30LB40*/ 01083000
         MVC   PF31(4),FIXOUT+9                                    0398 01084000
*         CALL EDITFIX(ADDR(STGDTOT(I,J)),4,'S');/*          @Y30LB40*/ 01085000
         MVC   @AL00001+4(8),@AL00399                              0399 01086000
         LR    @15,I                                               0399 01087000
         ALR   @15,@15                                             0399 01088000
         ALR   @15,J                                               0399 01089000
         MH    @15,@CH00729                                        0399 01090000
         LA    @15,STGDTOT-108(@15)                                0399 01091000
         ST    @15,@AFTEMPS+4                                      0399 01092000
         LA    @15,@AFTEMPS+4                                      0399 01093000
         ST    @15,@AL00001                                        0399 01094000
         LA    @01,@AL00001                                        0399 01095000
         BAL   @14,EDITFIX                                         0399 01096000
*         PF33=FIXOUT(10:13);       /* NUMBER OF STAGES      @Y30LB40*/ 01097000
         MVC   PF33(4),FIXOUT+9                                    0400 01098000
*         IF J=1 THEN                                              0401 01099000
         C     J,@CF00043                                          0401 01100000
         BNE   @RF00401                                            0401 01101000
*           DO;                     /* VTOC STAGES IF CART PAIR 0  0402 01102000
*                                                            @Y30LB40*/ 01103000
*             CALL EDITFIX(ADDR(VTOCSG(I,J)),4,'S');/*       @Y30LB40*/ 01104000
         MVC   @AL00001+4(8),@AL00403                              0403 01105000
         LR    @15,I                                               0403 01106000
         ALR   @15,@15                                             0403 01107000
         ALR   @15,J                                               0403 01108000
         MH    @15,@CH00729                                        0403 01109000
         LA    @15,VTOCSG-108(@15)                                 0403 01110000
         ST    @15,@AFTEMPS+4                                      0403 01111000
         LA    @15,@AFTEMPS+4                                      0403 01112000
         ST    @15,@AL00001                                        0403 01113000
         LA    @01,@AL00001                                        0403 01114000
         BAL   @14,EDITFIX                                         0403 01115000
*             PF35=FIXOUT(10:13);   /*                       @Y30LB40*/ 01116000
         MVC   PF35(4),FIXOUT+9                                    0404 01117000
*           END;                    /*                       @Y30LB40*/ 01118000
*         ELSE                                                     0406 01119000
*           PF35='    ';            /*                       @Y30LB40*/ 01120000
         B     @RC00401                                            0406 01121000
@RF00401 MVC   PF35(4),@CC00681                                    0406 01122000
*         CALL EDITFIX(ADDR(DSTGDTOT(I,J)),4,'S');/*         @Y30LB40*/ 01123000
@RC00401 MVC   @AL00001+4(8),@AL00407                              0407 01124000
         LR    @15,I                                               0407 01125000
         ALR   @15,@15                                             0407 01126000
         ALR   @15,J                                               0407 01127000
         MH    @15,@CH00729                                        0407 01128000
         LA    @15,DSTGDTOT-108(@15)                               0407 01129000
         ST    @15,@AFTEMPS+4                                      0407 01130000
         LA    @15,@AFTEMPS+4                                      0407 01131000
         ST    @15,@AL00001                                        0407 01132000
         LA    @01,@AL00001                                        0407 01133000
         BAL   @14,EDITFIX                                         0407 01134000
*         PF37=FIXOUT(10:13);       /* NUMBER OF DESTAGES    @Y30LB40*/ 01135000
         MVC   PF37(4),FIXOUT+9                                    0408 01136000
*         IF J=1 THEN                                              0409 01137000
         C     J,@CF00043                                          0409 01138000
         BNE   @RF00409                                            0409 01139000
*           DO;                     /* VTOC DESTAGES IF CART PAIR 0     01140000
*                                                            @Y30LB40*/ 01141000
*             CALL EDITFIX(ADDR(VTOCDS(I,J)),4,'S');/*       @Y30LB40*/ 01142000
         MVC   @AL00001+4(8),@AL00411                              0411 01143000
         LR    @15,I                                               0411 01144000
         ALR   @15,@15                                             0411 01145000
         ALR   @15,J                                               0411 01146000
         MH    @15,@CH00729                                        0411 01147000
         LA    @15,VTOCDS-108(@15)                                 0411 01148000
         ST    @15,@AFTEMPS+4                                      0411 01149000
         LA    @15,@AFTEMPS+4                                      0411 01150000
         ST    @15,@AL00001                                        0411 01151000
         LA    @01,@AL00001                                        0411 01152000
         BAL   @14,EDITFIX                                         0411 01153000
*             PF39=FIXOUT(10:13);   /*                       @Y30LB40*/ 01154000
         MVC   PF39(4),FIXOUT+9                                    0412 01155000
*           END;                    /*                       @Y30LB40*/ 01156000
*         ELSE                                                     0414 01157000
*           PF39='    ';            /*                       @Y30LB40*/ 01158000
         B     @RC00409                                            0414 01159000
@RF00409 MVC   PF39(4),@CC00681                                    0414 01160000
*         RFY                                                      0415 01161000
*          (R0,                                                    0415 01162000
*           R1,                                                    0415 01163000
*           R14,                                                   0415 01164000
*           R15) RSTD;              /*                       @Y30LB40*/ 01165000
@RC00409 DS    0H                                                  0416 01166000
*         GEN(PUT   PRNTDCB,PRINTLN);/* PRINT THE LINE       @Y30LB40*/ 01167000
         PUT   PRNTDCB,PRINTLN                                          01168000
*         RFY                                                      0417 01169000
*          (R0,                                                    0417 01170000
*           R1,                                                    0417 01171000
*           R14,                                                   0417 01172000
*           R15) UNRSTD;            /*                       @Y30LB40*/ 01173000
*         LINECNT=LINECNT+1;        /* INCREMENT LINE COUNTER      0418 01174000
*                                                            @Y30LB40*/ 01175000
         AL    LINECNT,@CF00043                                    0418 01176000
*         PF1='      ';             /* CLEAR CONSTANT INFO   @Y30LB40*/ 01177000
         MVC   PF1(6),@CC00659                                     0419 01178000
*         PF3='        ';           /*                       @Y30LB40*/ 01179000
         MVC   PF3(8),@CC00673                                     0420 01180000
*         PF0A=' ';                 /*                       @Y30LB40*/ 01181000
         MVI   PF0A,C' '                                           0421 01182000
*         PF13='      ';            /*                       @Y30LB40*/ 01183000
*                                                                  0422 01184000
         MVC   PF13(6),@CC00659                                    0422 01185000
*         /***********************************************************/ 01186000
*         /*                                                         */ 01187000
*         /* ** CLEAR ARRAY **                               @Y30LB40*/ 01188000
*         /*                                                         */ 01189000
*         /***********************************************************/ 01190000
*                                                                  0423 01191000
*         SMSTGD(I,J)=0;            /*                       @Y30LB40*/ 01192000
         SLR   @15,@15                                             0423 01193000
         LR    @14,I                                               0423 01194000
         ALR   @14,@14                                             0423 01195000
         ALR   @14,J                                               0423 01196000
         MH    @14,@CH00729                                        0423 01197000
         ST    @15,SMSTGD-108(@14)                                 0423 01198000
*         SMCFAULT(I,J)=0;          /*                       @Y30LB40*/ 01199000
         ST    @15,SMCFAULT-108(@14)                               0424 01200000
*         SMDSTGD(I,J)=0;           /*                       @Y30LB40*/ 01201000
         ST    @15,SMDSTGD-108(@14)                                0425 01202000
*         SMSALLOC(I,J)=0;          /*                       @Y30LB40*/ 01203000
         ST    @15,SMSALLOC-108(@14)                               0426 01204000
*         LOADS(I,J)=0;             /*                       @Y30LB40*/ 01205000
         ST    @15,LOADS-108(@14)                                  0427 01206000
*         STGDTOT(I,J)=0;           /*                       @Y30LB40*/ 01207000
         ST    @15,STGDTOT-108(@14)                                0428 01208000
*         VTOCSG(I,J)=0;            /*                       @Y30LB40*/ 01209000
         ST    @15,VTOCSG-108(@14)                                 0429 01210000
*         DSTGDTOT(I,J)=0;          /*                       @Y30LB40*/ 01211000
         ST    @15,DSTGDTOT-108(@14)                               0430 01212000
*         VTOCDS(I,J)=0;            /*                       @Y30LB40*/ 01213000
         ST    @15,VTOCDS-108(@14)                                 0431 01214000
*       END;                        /*                       @Y30LB40*/ 01215000
*   END;                            /*                       @Y30LB40*/ 01216000
@RF00381 AL    J,@CF00043                                          0433 01217000
         C     J,@CF00050                                          0433 01218000
         BNH   @DL00364                                            0433 01219000
*   IF EOFSW='1'B THEN                                             0434 01220000
         TM    EOFSW,B'10000000'                                   0434 01221000
         BNO   @RF00434                                            0434 01222000
*     DO;                           /* IF END OF FILE REACHED      0435 01223000
*                                                            @Y30LB40*/ 01224000
*       IF I=2 THEN                                                0436 01225000
         C     I,@CF00050                                          0436 01226000
         BE    @RT00436                                            0436 01227000
*         GO TO EOJ;                /* IF VOLID TOTAL WRITTEN,EXIT   */ 01228000
*       RFY                                                        0438 01229000
*        (R0,                                                      0438 01230000
*         R1,                                                      0438 01231000
*         R14,                                                     0438 01232000
*         R15) RSTD;                /*                       @Y30LB40*/ 01233000
*       GEN(PUT   PRNTDCB,SPACE1);  /* SKIP A LINE           @Y30LB40*/ 01234000
         PUT   PRNTDCB,SPACE1                                           01235000
*       RFY                                                        0440 01236000
*        (R0,                                                      0440 01237000
*         R1,                                                      0440 01238000
*         R14,                                                     0440 01239000
*         R15) UNRSTD;              /*                       @Y30LB40*/ 01240000
*       LINECNT=LINECNT+1;          /* BUMP LINE COUNTER     @Y30LB40*/ 01241000
         AL    LINECNT,@CF00043                                    0441 01242000
*       I=2;                        /* SET FOR VOLID TOTALS  @Y30LB40*/ 01243000
         LA    I,2                                                 0442 01244000
*       GO TO PROCBRK;              /* GO PRINT VOLID TOTALS @Y30LB40*/ 01245000
         B     PROCBRK                                             0443 01246000
*     END;                          /*                       @Y30LB40*/ 01247000
*   IF LIBSW='1'B THEN                                             0445 01248000
@RF00434 TM    LIBSW,B'10000000'                                   0445 01249000
         BNO   @RF00445                                            0445 01250000
*     DO;                           /* IF LIBRARY CONTROL BREAK    0446 01251000
*                                                            @Y30LB40*/ 01252000
*       IF I=2                      /* IF VOLID TOTALS WRITTEN     0447 01253000
*                                                            @Y30LB40*/ 01254000
*         THEN                                                     0447 01255000
         C     I,@CF00050                                          0447 01256000
         BNE   @RF00447                                            0447 01257000
*         DO;                       /* FORCE NEW PAGE        @Y30LB40*/ 01258000
*           LIBSW='0'B;             /*                       @Y30LB40*/ 01259000
         NI    LIBSW,B'01111111'                                   0449 01260000
*           LINECNT=56;             /*                       @Y30LB40*/ 01261000
         LA    LINECNT,56                                          0450 01262000
*           GO TO NEWLIB;           /* GO SETUP NEW TIME SLICE     0451 01263000
*                                                            @Y30LB40*/ 01264000
         B     NEWLIB                                              0451 01265000
*         END;                      /*                       @Y30LB40*/ 01266000
*       ELSE                                                       0453 01267000
*         DO;                       /* VOLID TOTALS NOT YET WRITTEN     01268000
*                                                            @Y30LB40*/ 01269000
@RF00447 DS    0H                                                  0454 01270000
*           RFY                                                    0454 01271000
*            (R0,                                                  0454 01272000
*             R1,                                                  0454 01273000
*             R14,                                                 0454 01274000
*             R15) RSTD;            /*                       @Y30LB40*/ 01275000
*           GEN(PUT   PRNTDCB,SPACE1);/* SKIP A LINE         @Y30LB40*/ 01276000
         PUT   PRNTDCB,SPACE1                                           01277000
*           RFY                                                    0456 01278000
*            (R0,                                                  0456 01279000
*             R1,                                                  0456 01280000
*             R14,                                                 0456 01281000
*             R15) UNRSTD;          /*                       @Y30LB40*/ 01282000
*           LINECNT=LINECNT+1;      /* INCREMENT LINE COUNTER      0457 01283000
*                                                            @Y30LB40*/ 01284000
         AL    LINECNT,@CF00043                                    0457 01285000
*           I=2;                    /* SET FOR VOLID TOTALS  @Y30LB40*/ 01286000
         LA    I,2                                                 0458 01287000
*           GO TO PROCBRK;          /* GO PRINT VOLID TOTALS @Y30LB40*/ 01288000
         B     PROCBRK                                             0459 01289000
*         END;                      /*                       @Y30LB40*/ 01290000
*     END;                          /*                       @Y30LB40*/ 01291000
*   IF VOLSW='1'B THEN                                             0462 01292000
@RF00445 TM    VOLSW,B'10000000'                                   0462 01293000
         BNO   @RF00462                                            0462 01294000
*     DO;                           /* IF VOLUME CONTROL BREAK     0463 01295000
*                                                            @Y30LB40*/ 01296000
*       IF I=2                      /* IF VOLID TOTALS WRITTEN     0464 01297000
*                                                            @Y30LB40*/ 01298000
*         THEN                                                     0464 01299000
         C     I,@CF00050                                          0464 01300000
         BNE   @RF00464                                            0464 01301000
*         DO;                       /* SKIP TWO LINES        @Y30LB40*/ 01302000
*           VOLSW='0'B;             /*                       @Y30LB40*/ 01303000
         NI    VOLSW,B'01111111'                                   0466 01304000
*           RFY                                                    0467 01305000
*            (R0,                                                  0467 01306000
*             R1,                                                  0467 01307000
*             R14,                                                 0467 01308000
*             R15) RSTD;            /*                       @Y30LB40*/ 01309000
*           GEN(PUT   PRNTDCB,SPACE1);/* SKIP A LINE         @Y30LB40*/ 01310000
         PUT   PRNTDCB,SPACE1                                           01311000
*           GEN(PUT   PRNTDCB,SPACE1);/* SKIP A LINE         @Y30LB40*/ 01312000
         PUT   PRNTDCB,SPACE1                                           01313000
*           RFY                                                    0470 01314000
*            (R0,                                                  0470 01315000
*             R1,                                                  0470 01316000
*             R14,                                                 0470 01317000
*             R15) UNRSTD;          /*                       @Y30LB40*/ 01318000
*           LINECNT=LINECNT+2;      /* INCREMENT LINE COUNTER      0471 01319000
*                                                            @Y30LB40*/ 01320000
         AL    LINECNT,@CF00050                                    0471 01321000
*           GO TO NEWLIB;           /* GO SETUP NEW TIME SLICE     0472 01322000
*                                                            @Y30LB40*/ 01323000
         B     NEWLIB                                              0472 01324000
*         END;                      /*                       @Y30LB40*/ 01325000
*       ELSE                                                       0474 01326000
*         DO;                       /* VOLID TOTALS NOT YET WRITTEN     01327000
*                                                            @Y30LB40*/ 01328000
@RF00464 DS    0H                                                  0475 01329000
*           RFY                                                    0475 01330000
*            (R0,                                                  0475 01331000
*             R1,                                                  0475 01332000
*             R14,                                                 0475 01333000
*             R15) RSTD;            /*                       @Y30LB40*/ 01334000
*           GEN(PUT   PRNTDCB,SPACE1);/* SKIP A LINE         @Y30LB40*/ 01335000
         PUT   PRNTDCB,SPACE1                                           01336000
*           RFY                                                    0477 01337000
*            (R0,                                                  0477 01338000
*             R1,                                                  0477 01339000
*             R14,                                                 0477 01340000
*             R15) UNRSTD;          /*                       @Y30LB40*/ 01341000
*           LINECNT=LINECNT+1;      /* INCREMENT LINE COUNTER      0478 01342000
*                                                            @Y30LB40*/ 01343000
         AL    LINECNT,@CF00043                                    0478 01344000
*           I=2;                    /* SET FOR VOLID TOTALS  @Y30LB40*/ 01345000
         LA    I,2                                                 0479 01346000
*           GO TO PROCBRK;          /* GO PRINT VOLID TOTALS @Y30LB40*/ 01347000
         B     PROCBRK                                             0480 01348000
*         END;                      /*                       @Y30LB40*/ 01349000
*     END;                          /*                       @Y30LB40*/ 01350000
*   IF TMESW='1'B THEN                                             0483 01351000
@RF00462 TM    TMESW,B'10000000'                                   0483 01352000
         BNO   @RF00483                                            0483 01353000
*     DO;                           /* TIME SLICE EXCEEDED   @Y30LB40*/ 01354000
*       TMESW='0'B;                 /*                       @Y30LB40*/ 01355000
         NI    TMESW,B'01111111'                                   0485 01356000
*       RFY                                                        0486 01357000
*        (R0,                                                      0486 01358000
*         R1,                                                      0486 01359000
*         R14,                                                     0486 01360000
*         R15) RSTD;                /*                       @Y30LB40*/ 01361000
*       GEN(PUT   PRNTDCB,SPACE1);  /* SKIP A LINE           @Y30LB40*/ 01362000
         PUT   PRNTDCB,SPACE1                                           01363000
*       RFY                                                        0488 01364000
*        (R0,                                                      0488 01365000
*         R1,                                                      0488 01366000
*         R14,                                                     0488 01367000
*         R15) UNRSTD;              /*                       @Y30LB40*/ 01368000
*       LINECNT=LINECNT+1;          /* INCREMENT LINE COUNTER      0489 01369000
*                                                            @Y30LB40*/ 01370000
         AL    LINECNT,@CF00043                                    0489 01371000
*       CALL GETSLICE;              /*                       @OZ11673*/ 01372000
         BAL   @14,GETSLICE                                        0490 01373000
*     END;                          /*                       @OZ11673*/ 01374000
*   GO TO CHECKTIM;                 /* GO ACCUMULATE TOTALS  @Y30LB40*/ 01375000
         B     CHECKTIM                                            0492 01376000
*/********************************************************************  01377000
*                                                                    */ 01378000
*                                                                  0493 01379000
*EOF:                               /* IF END OF FILE REACHED      0493 01380000
*                                                            @Y30LB40*/ 01381000
*   EOFSW='1'B;                     /* INDICATE END OF FILE  @Y30LB40*/ 01382000
EOF      OI    EOFSW,B'10000000'                                   0493 01383000
*   GO TO VOLIDBRK;                 /* GO PRINT FINAL TOTALS @Y30LB40*/ 01384000
         B     VOLIDBRK                                            0494 01385000
*                                                                  0495 01386000
*/********************************************************************  01387000
*                                                                    */ 01388000
*/* END OF JOB, CLOSE FILES, PROCESSING COMPLETE.            @Y30LB40*/ 01389000
*/********************************************************************  01390000
*                                                                    */ 01391000
*                                                                  0495 01392000
*EOJ:                                                              0495 01393000
*   PRINTLN=RCDTOTAL;               /* PRINT JCL PARMS AND RECORD  0495 01394000
*                                      TOTALS                @Y30LB40*/ 01395000
EOJ      MVC   PRINTLN(121),RCDTOTAL                               0495 01396000
*   TIMESL=TIMESL/60;               /*                       @Y30LB40*/ 01397000
         L     @00,TIMESL                                          0496 01398000
         SRDA  @00,32                                              0496 01399000
         D     @00,@CF00334                                        0496 01400000
         ST    @01,TIMESL                                          0496 01401000
*   CALL EDITFIX(ADDR(TIMESL),4,'S');/*                      @Y30LB40*/ 01402000
         MVC   @AL00001+4(8),@AL00497                              0497 01403000
         LA    @15,TIMESL                                          0497 01404000
         ST    @15,@AFTEMPS+4                                      0497 01405000
         LA    @15,@AFTEMPS+4                                      0497 01406000
         ST    @15,@AL00001                                        0497 01407000
         LA    @01,@AL00001                                        0497 01408000
         BAL   @14,EDITFIX                                         0497 01409000
*   PRINTLN(12:14)=FIXOUT(11:13);   /*                       @Y30LB40*/ 01410000
         MVC   PRINTLN+11(3),FIXOUT+10                             0498 01411000
*   CALL EDITFIX(ADDR(HLDSYR),1,'N');/*                      @Y30LB40*/ 01412000
         MVC   @AL00001+4(8),@AL00499                              0499 01413000
         LA    @15,HLDSYR                                          0499 01414000
         ST    @15,@AFTEMPS+4                                      0499 01415000
         LA    @15,@AFTEMPS+4                                      0499 01416000
         ST    @15,@AL00001                                        0499 01417000
         LA    @01,@AL00001                                        0499 01418000
         BAL   @14,EDITFIX                                         0499 01419000
*   PRINTLN(25:26)=FIXOUT(12:13);   /*                       @Y30LB40*/ 01420000
         MVC   PRINTLN+24(2),FIXOUT+11                             0500 01421000
*   CALL EDITFIX(ADDR(HLDSDAY),2,'N');/*                     @Y30LB40*/ 01422000
         MVC   @AL00001+4(8),@AL00501                              0501 01423000
         LA    @15,HLDSDAY                                         0501 01424000
         ST    @15,@AFTEMPS+4                                      0501 01425000
         LA    @15,@AFTEMPS+4                                      0501 01426000
         ST    @15,@AL00001                                        0501 01427000
         LA    @01,@AL00001                                        0501 01428000
         BAL   @14,EDITFIX                                         0501 01429000
*   PRINTLN(27:29)=FIXOUT(11:13);   /*                       @Y30LB40*/ 01430000
         MVC   PRINTLN+26(3),FIXOUT+10                             0502 01431000
*   CALL EDITFIX(ADDR(HLDEYR),1,'N');/*                      @Y30LB40*/ 01432000
         MVC   @AL00001+4(8),@AL00503                              0503 01433000
         LA    @15,HLDEYR                                          0503 01434000
         ST    @15,@AFTEMPS+4                                      0503 01435000
         LA    @15,@AFTEMPS+4                                      0503 01436000
         ST    @15,@AL00001                                        0503 01437000
         LA    @01,@AL00001                                        0503 01438000
         BAL   @14,EDITFIX                                         0503 01439000
*   PRINTLN(31:32)=FIXOUT(12:13);   /*                       @Y30LB40*/ 01440000
         MVC   PRINTLN+30(2),FIXOUT+11                             0504 01441000
*   CALL EDITFIX(ADDR(HLDEDAY),2,'N');/*                     @Y30LB40*/ 01442000
         MVC   @AL00001+4(8),@AL00505                              0505 01443000
         LA    @15,HLDEDAY                                         0505 01444000
         ST    @15,@AFTEMPS+4                                      0505 01445000
         LA    @15,@AFTEMPS+4                                      0505 01446000
         ST    @15,@AL00001                                        0505 01447000
         LA    @01,@AL00001                                        0505 01448000
         BAL   @14,EDITFIX                                         0505 01449000
*   PRINTLN(33:35)=FIXOUT(11:13);   /*                       @Y30LB40*/ 01450000
         MVC   PRINTLN+32(3),FIXOUT+10                             0506 01451000
*   HOUR=HLDSTIME/3600;             /*                       @Y30LB40*/ 01452000
         L     @15,HLDSTIME                                        0507 01453000
         LA    @14,3600                                            0507 01454000
         LR    @00,@15                                             0507 01455000
         SRDA  @00,32                                              0507 01456000
         DR    @00,@14                                             0507 01457000
         ST    @01,HOUR                                            0507 01458000
*   MINUTE=(HLDSTIME-(HOUR*3600))/60;/*                      @Y30LB40*/ 01459000
         MR    @00,@14                                             0508 01460000
         LR    @02,@15                                             0508 01461000
         SLR   @02,@01                                             0508 01462000
         SRDA  @02,32                                              0508 01463000
         D     @02,@CF00334                                        0508 01464000
         ST    @03,MINUTE                                          0508 01465000
*   CALL EDITFIX(ADDR(HOUR),4,'N'); /*                       @Y30LB40*/ 01466000
         MVC   @AL00001+4(8),@AL00509                              0509 01467000
         LA    @15,HOUR                                            0509 01468000
         ST    @15,@AFTEMPS+4                                      0509 01469000
         LA    @15,@AFTEMPS+4                                      0509 01470000
         ST    @15,@AL00001                                        0509 01471000
         LA    @01,@AL00001                                        0509 01472000
         BAL   @14,EDITFIX                                         0509 01473000
*   PRINTLN(46:47)=FIXOUT(12:13);   /*                       @Y30LB40*/ 01474000
         MVC   PRINTLN+45(2),FIXOUT+11                             0510 01475000
*   CALL EDITFIX(ADDR(MINUTE),4,'N');/*                      @Y30LB40*/ 01476000
         MVC   @AL00001+4(8),@AL00511                              0511 01477000
         LA    @15,MINUTE                                          0511 01478000
         ST    @15,@AFTEMPS+4                                      0511 01479000
         LA    @15,@AFTEMPS+4                                      0511 01480000
         ST    @15,@AL00001                                        0511 01481000
         LA    @01,@AL00001                                        0511 01482000
         BAL   @14,EDITFIX                                         0511 01483000
*   PRINTLN(48:49)=FIXOUT(12:13);   /*                       @Y30LB40*/ 01484000
         MVC   PRINTLN+47(2),FIXOUT+11                             0512 01485000
*   HOUR=HLDETIME/3600;             /*                       @Y30LB40*/ 01486000
         L     @15,HLDETIME                                        0513 01487000
         LA    @14,3600                                            0513 01488000
         LR    @00,@15                                             0513 01489000
         SRDA  @00,32                                              0513 01490000
         DR    @00,@14                                             0513 01491000
         ST    @01,HOUR                                            0513 01492000
*   MINUTE=(HLDETIME-(HOUR*3600))/60;/*                      @Y30LB40*/ 01493000
         MR    @00,@14                                             0514 01494000
         LR    @02,@15                                             0514 01495000
         SLR   @02,@01                                             0514 01496000
         SRDA  @02,32                                              0514 01497000
         D     @02,@CF00334                                        0514 01498000
         ST    @03,MINUTE                                          0514 01499000
*   CALL EDITFIX(ADDR(HOUR),4,'N'); /*                       @Y30LB40*/ 01500000
         MVC   @AL00001+4(8),@AL00515                              0515 01501000
         LA    @15,HOUR                                            0515 01502000
         ST    @15,@AFTEMPS+4                                      0515 01503000
         LA    @15,@AFTEMPS+4                                      0515 01504000
         ST    @15,@AL00001                                        0515 01505000
         LA    @01,@AL00001                                        0515 01506000
         BAL   @14,EDITFIX                                         0515 01507000
*   PRINTLN(51:52)=FIXOUT(12:13);   /*                       @Y30LB40*/ 01508000
         MVC   PRINTLN+50(2),FIXOUT+11                             0516 01509000
*   CALL EDITFIX(ADDR(MINUTE),4,'N');/*                      @Y30LB40*/ 01510000
         MVC   @AL00001+4(8),@AL00517                              0517 01511000
         LA    @15,MINUTE                                          0517 01512000
         ST    @15,@AFTEMPS+4                                      0517 01513000
         LA    @15,@AFTEMPS+4                                      0517 01514000
         ST    @15,@AL00001                                        0517 01515000
         LA    @01,@AL00001                                        0517 01516000
         BAL   @14,EDITFIX                                         0517 01517000
*   PRINTLN(53:54)=FIXOUT(12:13);   /*                       @Y30LB40*/ 01518000
         MVC   PRINTLN+52(2),FIXOUT+11                             0518 01519000
*   IF VOL^='      '                /* IF VOLUME SPECIFIED   @Y30LB40*/ 01520000
*     THEN                                                         0519 01521000
         CLC   VOL(6),@CC00659                                     0519 01522000
         BE    @RF00519                                            0519 01523000
*     PRINTLN(66:71)=VOL;           /* PRINT IT              @Y30LB40*/ 01524000
         MVC   PRINTLN+65(6),VOL                                   0520 01525000
*   ELSE                                                           0521 01526000
*     PRINTLN(57:71)='               ';/* ELSE BLANK IT              */ 01527000
         B     @RC00519                                            0521 01528000
@RF00519 MVC   PRINTLN+56(15),@CC00701                             0521 01529000
*   CALL EDITFIX(ADDR(RCDCOUNT),4,'S');/*                    @Y30LB40*/ 01530000
@RC00519 MVC   @AL00001+4(8),@AL00522                              0522 01531000
         LA    @15,RCDCOUNT                                        0522 01532000
         ST    @15,@AFTEMPS+4                                      0522 01533000
         LA    @15,@AFTEMPS+4                                      0522 01534000
         ST    @15,@AL00001                                        0522 01535000
         LA    @01,@AL00001                                        0522 01536000
         BAL   @14,EDITFIX                                         0522 01537000
*   PRINTLN(99:104)=FIXOUT(8:13);   /*                       @Y30LB40*/ 01538000
         MVC   PRINTLN+98(6),FIXOUT+7                              0523 01539000
*   RFY                                                            0524 01540000
*    (R0,                                                          0524 01541000
*     R1,                                                          0524 01542000
*     R14,                                                         0524 01543000
*     R15) RSTD;                    /*                       @Y30LB40*/ 01544000
*   GEN(PUT   PRNTDCB,PRINTLN);     /*                       @Y30LB40*/ 01545000
         PUT   PRNTDCB,PRINTLN                                          01546000
*   RFY                                                            0526 01547000
*    (R0,                                                          0526 01548000
*     R1,                                                          0526 01549000
*     R14,                                                         0526 01550000
*     R15) UNRSTD;                  /*                       @Y30LB40*/ 01551000
*CLOSEFIL:                                                         0527 01552000
*   RFY                                                            0527 01553000
*    (R0,                                                          0527 01554000
*     R1,                                                          0527 01555000
*     R14,                                                         0527 01556000
*     R15) RSTD;                    /*                       @Y30LB40*/ 01557000
CLOSEFIL DS    0H                                                  0528 01558000
*   GEN(CLOSE INDCB,MF=(E,OPENCLOS));/* CLOSE INPUT DCB      @Y30LB40*/ 01559000
         CLOSE INDCB,MF=(E,OPENCLOS)                                    01560000
*   GEN(CLOSE PRNTDCB,MF=(E,OPENCLOS));/* CLOSE PRINT DCB    @Y30LB40*/ 01561000
         CLOSE PRNTDCB,MF=(E,OPENCLOS)                                  01562000
*   RFY                                                            0530 01563000
*    (R0,                                                          0530 01564000
*     R1,                                                          0530 01565000
*     R14,                                                         0530 01566000
*     R15) UNRSTD;                  /*                       @Y30LB40*/ 01567000
*   RETURN CODE(RETURNCD);          /* EXIT WITH RETURN CODE @Y30LB40*/ 01568000
         L     @13,4(,@13)                                         0531 01569000
         L     @00,@SIZDATD                                        0531 01570000
         LR    @01,@10                                             0531 01571000
         FREEMAIN R,LV=(0),A=(1)                                        01572000
         LR    @15,@09                                             0531 01573000
         L     @14,12(,@13)                                        0531 01574000
         LM    @00,@12,20(@13)                                     0531 01575000
         BR    @14                                                 0531 01576000
*/********************************************************************  01577000
*                                                                    */ 01578000
*                                                                  0532 01579000
*                                                                  0532 01580000
*/********************************************************** @OZ11673*/ 01581000
*/*                                                          @OZ11673*/ 01582000
*/* PROCEDURE NAME - GETSLICE                                @OZ11673*/ 01583000
*/*                                                          @OZ11673*/ 01584000
*/* FUNCTION - BUMP THE TIMESLICE COMPARE VALUE UNTIL THE    @OZ11673*/ 01585000
*/*            CURRENT TIME IN THE DETAIL RECORD FALLS       @OZ11673*/ 01586000
*/*            WITHIN THE TIMESLICE RANGE.                   @OZ11673*/ 01587000
*/*                                                          @OZ11673*/ 01588000
*/********************************************************** @OZ11673*/ 01589000
*                                                                  0532 01590000
*GETSLICE:                                                         0532 01591000
*   PROCEDURE;                      /*                       @OZ11673*/ 01592000
GETSLICE STM   @14,@12,12(@13)                                     0532 01593000
*   DO WHILE(CKTIME>TSEND);         /* SETUP NEXT TIME SLICE INTERVAL*/ 01594000
         B     @DE00533                                            0533 01595000
@DL00533 DS    0H                                                  0534 01596000
*     TSBEG=TSEND;                  /*                       @Y30LB40*/ 01597000
         MVC   TSBEG(7),TSEND                                      0534 01598000
*     TSETIME=TSETIME+TIMESL;       /*                       @Y30LB40*/ 01599000
         L     @15,TSETIME                                         0535 01600000
         AL    @15,TIMESL                                          0535 01601000
         ST    @15,TSETIME                                         0535 01602000
*     IF TSETIME>86399 THEN                                        0536 01603000
         C     @15,@CF00637                                        0536 01604000
         BNH   @RF00536                                            0536 01605000
*       DO;                         /*                       @Y30LB40*/ 01606000
*         TSETIME=TSETIME-86400;    /*                       @Y30LB40*/ 01607000
         SL    @15,@CF00708                                        0538 01608000
         ST    @15,TSETIME                                         0538 01609000
*         TSEDAY=TSEDAY+1;          /*                       @Y30LB40*/ 01610000
         LA    @15,1                                               0539 01611000
         LH    @14,TSEDAY                                          0539 01612000
         ALR   @14,@15                                             0539 01613000
         STH   @14,TSEDAY                                          0539 01614000
*         IF TSEDAY>365 THEN                                       0540 01615000
         C     @14,@CF00636                                        0540 01616000
         BNH   @RF00540                                            0540 01617000
*           DO;                     /*                       @Y30LB40*/ 01618000
*             IF(TSEND(1:1)&'00000011'B)='00000000'B THEN          0542 01619000
         MVC   @TS00001(1),TSEND                                   0542 01620000
         NI    @TS00001,B'00000011'                                0542 01621000
         CLI   @TS00001,B'00000000'                                0542 01622000
         BNE   @RF00542                                            0542 01623000
*               IF TSEDAY>366 THEN                                 0543 01624000
         LA    @07,366                                             0543 01625000
         CR    @14,@07                                             0543 01626000
         BNH   @RF00543                                            0543 01627000
*                 DO;               /*                       @Y30LB40*/ 01628000
*                   TSEDAY=TSEDAY-366;/*                     @Y30LB40*/ 01629000
         SLR   @14,@07                                             0545 01630000
         STH   @14,TSEDAY                                          0545 01631000
*                   TSEYR=TSEYR+1;  /*                       @Y30LB40*/ 01632000
         SLR   @14,@14                                             0546 01633000
         IC    @14,TSEYR                                           0546 01634000
         ALR   @15,@14                                             0546 01635000
         STC   @15,TSEYR                                           0546 01636000
*                 END;              /*                       @Y30LB40*/ 01637000
*               ELSE                                               0548 01638000
*                 ;                 /*                       @Y30LB40*/ 01639000
@RF00543 DS    0H                                                  0549 01640000
*             ELSE                                                 0549 01641000
*               DO;                 /*                       @Y30LB40*/ 01642000
         B     @RC00542                                            0549 01643000
@RF00542 DS    0H                                                  0550 01644000
*                 TSEDAY=TSEDAY-365;/*                       @Y30LB40*/ 01645000
         LH    @15,TSEDAY                                          0550 01646000
         SL    @15,@CF00636                                        0550 01647000
         STH   @15,TSEDAY                                          0550 01648000
*                 TSEYR=TSEYR+1;    /*                       @Y30LB40*/ 01649000
         LA    @15,1                                               0551 01650000
         SLR   @14,@14                                             0551 01651000
         IC    @14,TSEYR                                           0551 01652000
         ALR   @15,@14                                             0551 01653000
         STC   @15,TSEYR                                           0551 01654000
*               END;                /*                       @Y30LB40*/ 01655000
*           END;                    /*                       @Y30LB40*/ 01656000
@RC00542 DS    0H                                                  0554 01657000
*       END;                        /*                       @Y30LB40*/ 01658000
@RF00540 DS    0H                                                  0555 01659000
*   END;                            /*                       @Y30LB40*/ 01660000
@RF00536 DS    0H                                                  0555 01661000
@DE00533 CLC   CKTIME(7),TSEND                                     0555 01662000
         BH    @DL00533                                            0555 01663000
*   END GETSLICE;                   /*                       @OZ11673*/ 01664000
@EL00002 DS    0H                                                  0556 01665000
@EF00002 DS    0H                                                  0556 01666000
@ER00002 LM    @14,@12,12(@13)                                     0556 01667000
         BR    @14                                                 0556 01668000
*                                                                  0557 01669000
*/********************************************************************  01670000
*                                                                    */ 01671000
*/* EDITFIX IS CALLED TO CONVERT BINARY FIELDS INTO CHARACTER FORM   */ 01672000
*/* FOR PRINTING. IT IS CALLED WITH THE FOLLOWING PARAMETERS -       */ 01673000
*/*   1. FIXADDR - THE ADDRESS OF THE FIELD TO BE CONVERTED  @Y30LB40*/ 01674000
*/*   2. FIXLEN - THE LENGTH OF THE FIELD TO BE CONVERTED - 1, 2, OR 4  01675000
*                                                                    */ 01676000
*/*   3. FIXOPT - THE TYPE OF EDITING OPTION DESIRED WHERE   @Y30LB40*/ 01677000
*/*               N = CONVERT TO CHARACTER, NO EDITING       @Y30LB40*/ 01678000
*/*               S = CONVERT TO CHARACTER AND ZERO SUPPRESS @Y30LB40*/ 01679000
*/*               E = CONVERT TO CHARACTER, INSERT COMMAS    @Y30LB40*/ 01680000
*/*                   TO DIVIDE HUNDREDS,THOUSANDS AND MILLIONS      */ 01681000
*/*                   AND ZERO AND COMMA SUPPRESS            @Y30LB40*/ 01682000
*/* OUTPUT IS PROVIDED IN A FIELD CALLED FIXOUT WHICH IS 13 BYTES    */ 01683000
*/* LONG.                                                    @Y30LB40*/ 01684000
*/********************************************************************  01685000
*                                                                    */ 01686000
*                                                                  0557 01687000
*EDITFIX:                                                          0557 01688000
*   PROC(FIXADDR,FIXLEN,FIXOPT) OPTIONS(SAVE);/*             @Y30LB40*/ 01689000
EDITFIX  STM   @14,@12,@SA00003                                    0557 01690000
         MVC   @PC00003(12),0(@01)                                 0557 01691000
*   DCL                                                            0558 01692000
*     FIXADDR PTR(31);              /* ADDRESS OF INPUT FIELD      0558 01693000
*                                                            @Y30LB40*/ 01694000
*   DCL                                                            0559 01695000
*     FIXLEN PTR(31);               /* LENGTH OF INPUT FIELD @Y30LB40*/ 01696000
*   DCL                                                            0560 01697000
*     FIXOPT CHAR(1);               /* EDITING OPTION DESIRED      0560 01698000
*                                                            @Y30LB40*/ 01699000
*   RFY                                                            0561 01700000
*    (R2,                                                          0561 01701000
*     R3) RSTD;                     /*                       @Y30LB40*/ 01702000
*   R2=FIXADDR;                     /*                       @Y30LB40*/ 01703000
         L     @15,@PC00003                                        0562 01704000
         L     R2,FIXADDR(,@15)                                    0562 01705000
*   R3=0;                           /*                       @Y30LB40*/ 01706000
         SLR   R3,R3                                               0563 01707000
*   IF FIXLEN=1                     /* IF LENGTH IS 1 PICKUP ONE BYTE   01708000
*                                                            @Y30LB40*/ 01709000
*     THEN                                                         0564 01710000
         L     @15,@PC00003+4                                      0564 01711000
         CLC   FIXLEN(4,@15),@CF00043                              0564 01712000
         BNE   @RF00564                                            0564 01713000
*     DO;                           /*                       @Y30LB40*/ 01714000
*       GEN(IC    R3,0(R2));        /*                       @Y30LB40*/ 01715000
         IC    R3,0(R2)                                                 01716000
*     END;                          /*                       @Y30LB40*/ 01717000
*   ELSE                                                           0568 01718000
*     IF FIXLEN=2                   /* IF LENGTH IS 2 PICKUP TWO   0568 01719000
*                                      BYTES                 @Y30LB40*/ 01720000
*       THEN                                                       0568 01721000
         B     @RC00564                                            0568 01722000
@RF00564 L     @15,@PC00003+4                                      0568 01723000
         CLC   FIXLEN(4,@15),@CF00050                              0568 01724000
         BNE   @RF00568                                            0568 01725000
*       DO;                         /*                       @Y30LB40*/ 01726000
*         GEN(LH    R3,0(R2));      /*                       @Y30LB40*/ 01727000
         LH    R3,0(R2)                                                 01728000
*       END;                        /*                       @Y30LB40*/ 01729000
*     ELSE                                                         0572 01730000
*       DO;                         /* PICKUP 4 BYTES        @Y30LB40*/ 01731000
         B     @RC00568                                            0572 01732000
@RF00568 DS    0H                                                  0573 01733000
*         GEN(L     R3,0(R2));      /*                       @Y30LB40*/ 01734000
         L     R3,0(R2)                                                 01735000
*       END;                        /*                       @Y30LB40*/ 01736000
*   GEN;                                                           0575 01737000
@RC00568 DS    0H                                                  0575 01738000
@RC00564 DS    0H                                                  0575 01739000
*                   /*CONVERT FROM BINARY TO CHARACTER      @Y30LB40*/  01740000
  CVD   R3,DOUBLEWD                                                     01741000
  OI    DOUBLEWD+7,X'0F'                                                01742000
  UNPK  FIXOUT(13),DOUBLEWD+2(6)                                        01743000
*   IF FIXOPT='N' THEN                                             0576 01744000
         L     @15,@PC00003+8                                      0576 01745000
         CLI   FIXOPT(@15),C'N'                                    0576 01746000
         BE    @RT00576                                            0576 01747000
*     GO TO EFEND;                  /* NO EDITING WANTED,GET OUT     */ 01748000
*   IF FIXOPT='S' THEN                                             0578 01749000
         CLI   FIXOPT(@15),C'S'                                    0578 01750000
         BE    @RT00578                                            0578 01751000
*     GO TO EF4;                    /* NO COMMAS WANTED,SKIP       0579 01752000
*                                      INSERTION                     */ 01753000
*   GEN;                                                           0580 01754000
*             /*INSERT COMMA DIVIDERS                       @Y30LB40*/  01755000
  MVC   FIXOUT(1),FIXOUT+3                                              01756000
  MVI   FIXOUT+1,C','                                                   01757000
  MVC   FIXOUT+2(3),FIXOUT+4                                            01758000
  MVI   FIXOUT+5,C','                                                   01759000
  MVC   FIXOUT+6(3),FIXOUT+7                                            01760000
  MVI   FIXOUT+9,C','                                                   01761000
*EF4:                               /* ZERO AND COMMA SUPPRESS     0581 01762000
*                                                            @Y30LB40*/ 01763000
*   GEN;                                                           0581 01764000
EF4      DS    0H                                                  0581 01765000
*                                                         /*@Y30LB40*/  01766000
         LA    R2,FIXOUT                                                01767000
         LA    R3,12                                                    01768000
EF5      EQU   *                                                        01769000
         CLI   0(R2),C','                                               01770000
         BE    EF6                                                      01771000
         CLI   0(R2),C'0'                                               01772000
         BNE   EFEND                                                    01773000
EF6      EQU   *                                                        01774000
         MVI   0(R2),C' '                                               01775000
         LA    R2,1(R2)                                                 01776000
         BCT   R3,EF5                                                   01777000
*EFEND:                                                            0582 01778000
*   RFY                                                            0582 01779000
*    (R2,                                                          0582 01780000
*     R3) UNRSTD;                   /*                       @Y30LB40*/ 01781000
*   END EDITFIX;                    /*                       @Y30LB40*/ 01782000
@EL00003 DS    0H                                                  0583 01783000
@EF00003 DS    0H                                                  0583 01784000
@ER00003 LM    @14,@12,@SA00003                                    0583 01785000
         BR    @14                                                 0583 01786000
*                                                                  0584 01787000
*/********************************************************************  01788000
*                                                                    */ 01789000
*/* ROUTINE TO SETUP CONSTANT INFO IN PRINT LINE             @Y30LB40*/ 01790000
*/********************************************************************  01791000
*                                                                    */ 01792000
*                                                                  0584 01793000
*SETLINE:                                                          0584 01794000
*   PROC OPTIONS(SAVE);             /*                       @Y30LB40*/ 01795000
SETLINE  STM   @14,@12,@SA00004                                    0584 01796000
*   PRINTLN=' ';                    /* CLEAR PRINT LINE      @Y30LB40*/ 01797000
         MVI   PRINTLN+1,C' '                                      0585 01798000
         MVC   PRINTLN+2(119),PRINTLN+1                            0585 01799000
         MVI   PRINTLN,C' '                                        0585 01800000
*   PF1='  /   ';                   /*                       @Y30LB40*/ 01801000
         MVC   PF1(6),@CC00725                                     0586 01802000
*   CALL EDITFIX(ADDR(TSSYR),1,'N');/*                       @Y30LB40*/ 01803000
         MVC   @AL00001+4(8),@AL00587                              0587 01804000
         LA    @15,TSSYR                                           0587 01805000
         ST    @15,@AFTEMPS                                        0587 01806000
         LA    @15,@AFTEMPS                                        0587 01807000
         ST    @15,@AL00001                                        0587 01808000
         LA    @01,@AL00001                                        0587 01809000
         BAL   @14,EDITFIX                                         0587 01810000
*   PF1(1:2)=FIXOUT(12:13);         /* PRINT TIME SLICE YEAR @Y30LB40*/ 01811000
         MVC   PF1(2),FIXOUT+11                                    0588 01812000
*   CALL EDITFIX(ADDR(TSSDAY),2,'N');/*                      @Y30LB40*/ 01813000
         MVC   @AL00001+4(8),@AL00589                              0589 01814000
         LA    @15,TSSDAY                                          0589 01815000
         ST    @15,@AFTEMPS                                        0589 01816000
         LA    @15,@AFTEMPS                                        0589 01817000
         ST    @15,@AL00001                                        0589 01818000
         LA    @01,@AL00001                                        0589 01819000
         BAL   @14,EDITFIX                                         0589 01820000
*   PF1(4:6)=FIXOUT(11:13);         /* PRINT TIME SLICE DAY  @Y30LB40*/ 01821000
         MVC   PF1+3(3),FIXOUT+10                                  0590 01822000
*   HOUR=TSSTIME/3600;              /*                       @Y30LB40*/ 01823000
         L     @15,TSSTIME                                         0591 01824000
         LA    @14,3600                                            0591 01825000
         LR    @00,@15                                             0591 01826000
         SRDA  @00,32                                              0591 01827000
         DR    @00,@14                                             0591 01828000
         ST    @01,HOUR                                            0591 01829000
*   MINUTE=(TSSTIME-(HOUR*3600))/60;/*                       @Y30LB40*/ 01830000
         LA    @07,60                                              0592 01831000
         MR    @00,@14                                             0592 01832000
         LR    @02,@15                                             0592 01833000
         SLR   @02,@01                                             0592 01834000
         SRDA  @02,32                                              0592 01835000
         DR    @02,@07                                             0592 01836000
         ST    @03,MINUTE                                          0592 01837000
*   SECOND=TSSTIME-((HOUR*3600)+(MINUTE*60));/*              @Y30LB40*/ 01838000
         MR    @02,@07                                             0593 01839000
         ALR   @01,@03                                             0593 01840000
         SLR   @15,@01                                             0593 01841000
         ST    @15,SECOND                                          0593 01842000
*   PF3='  :  :  ';                 /*                       @Y30LB40*/ 01843000
         MVC   PF3(8),@CC00726                                     0594 01844000
*   CALL EDITFIX(ADDR(HOUR),4,'S'); /*                       @Y30LB40*/ 01845000
         MVC   @AL00001+4(8),@AL00595                              0595 01846000
         LA    @15,HOUR                                            0595 01847000
         ST    @15,@AFTEMPS                                        0595 01848000
         LA    @15,@AFTEMPS                                        0595 01849000
         ST    @15,@AL00001                                        0595 01850000
         LA    @01,@AL00001                                        0595 01851000
         BAL   @14,EDITFIX                                         0595 01852000
*   PF3(1:2)=FIXOUT(12:13);         /* PRINT TIME SLICE HOURS      0596 01853000
*                                                            @Y30LB40*/ 01854000
         MVC   PF3(2),FIXOUT+11                                    0596 01855000
*   CALL EDITFIX(ADDR(MINUTE),4,'N');/*                      @Y30LB40*/ 01856000
         MVC   @AL00001+4(8),@AL00597                              0597 01857000
         LA    @15,MINUTE                                          0597 01858000
         ST    @15,@AFTEMPS                                        0597 01859000
         LA    @15,@AFTEMPS                                        0597 01860000
         ST    @15,@AL00001                                        0597 01861000
         LA    @01,@AL00001                                        0597 01862000
         BAL   @14,EDITFIX                                         0597 01863000
*   PF3(4:5)=FIXOUT(12:13);         /* PRINT TIME SLICE MINUTES    0598 01864000
*                                                            @Y30LB40*/ 01865000
         MVC   PF3+3(2),FIXOUT+11                                  0598 01866000
*   CALL EDITFIX(ADDR(SECOND),4,'N');/*                      @Y30LB40*/ 01867000
         MVC   @AL00001+4(8),@AL00599                              0599 01868000
         LA    @15,SECOND                                          0599 01869000
         ST    @15,@AFTEMPS                                        0599 01870000
         LA    @15,@AFTEMPS                                        0599 01871000
         ST    @15,@AL00001                                        0599 01872000
         LA    @01,@AL00001                                        0599 01873000
         BAL   @14,EDITFIX                                         0599 01874000
*   PF3(7:8)=FIXOUT(12:13);         /* PRINT TIME SLICE SECONDS    0600 01875000
*                                                            @Y30LB40*/ 01876000
         MVC   PF3+6(2),FIXOUT+11                                  0600 01877000
*   PF13=VOLUME;                    /* PRINT VOLUME IDENTIFICATION 0601 01878000
*                                                            @Y30LB40*/ 01879000
         MVC   PF13(6),VOLUME                                      0601 01880000
*   CALL EDITFIX(ADDR(LIB),1,'N');  /*                       @Y30LB40*/ 01881000
         MVC   @AL00001+4(8),@AL00602                              0602 01882000
         LA    @15,LIB                                             0602 01883000
         ST    @15,@AFTEMPS                                        0602 01884000
         LA    @15,@AFTEMPS                                        0602 01885000
         ST    @15,@AL00001                                        0602 01886000
         LA    @01,@AL00001                                        0602 01887000
         BAL   @14,EDITFIX                                         0602 01888000
*   PF0A=FIXOUT(13:13);             /* PRINT LIBRARY NUMBER  @Y30LB40*/ 01889000
         MVC   PF0A(1),FIXOUT+12                                   0603 01890000
*   END SETLINE;                    /*                       @Y30LB40*/ 01891000
@EL00004 DS    0H                                                  0604 01892000
@EF00004 DS    0H                                                  0604 01893000
@ER00004 LM    @14,@12,@SA00004                                    0604 01894000
         BR    @14                                                 0604 01895000
*                                                                  0605 01896000
*/********************************************************** @OZ05124*/ 01897000
*/* SYNAD EXIT FOR TRACEIN, TAKEN FOR READ ERRORS.           @OZ05124*/ 01898000
*/********************************************************** @OZ05124*/ 01899000
*                                                                  0605 01900000
*READERR:                                                          0605 01901000
*   ;                               /*                       @OZ05124*/ 01902000
READERR  DS    0H                                                  0606 01903000
*   GEN(SYNADAF ACSMETH=QSAM);      /*                       @OZ05124*/ 01904000
         SYNADAF ACSMETH=QSAM                                           01905000
*   GEN(MVC   PRNTLINE+30(79),49(R1));/*                     @OZ05124*/ 01906000
         MVC   PRNTLINE+30(79),49(R1)                                   01907000
*   PRNTLINE(1:30)=ICGTR904;        /*                       @OZ05124*/ 01908000
         MVC   PRNTLINE(30),ICGTR904                               0608 01909000
*   SAVE14=R14;                     /*                       @OZ09522*/ 01910000
         LR    SAVE14,R14                                          0609 01911000
*   RFY                                                            0610 01912000
*    (R0,                                                          0610 01913000
*     R1,                                                          0610 01914000
*     R14,                                                         0610 01915000
*     R15) RSTD;                    /*                       @OZ05124*/ 01916000
*   GEN(PUT PRNTDCB,PRNTLINE);      /*                       @OZ05124*/ 01917000
         PUT PRNTDCB,PRNTLINE                                           01918000
*   RFY                                                            0612 01919000
*    (R0,                                                          0612 01920000
*     R1,                                                          0612 01921000
*     R14,                                                         0612 01922000
*     R15) UNRSTD;                  /*                       @OZ05124*/ 01923000
*   R14=SAVE14;                     /*                       @OZ09522*/ 01924000
         LR    R14,SAVE14                                          0613 01925000
*   GEN(SYNADRLS);                  /*                       @OZ05124*/ 01926000
         SYNADRLS                                                       01927000
*   RETURNCD=4;                     /*                       @OZ05124*/ 01928000
         LA    RETURNCD,4                                          0615 01929000
*   GEN(BR    R14);                 /* RETURN TO IOS         @OZ05124*/ 01930000
         BR    R14                                                      01931000
*   END ICGTRVID                    /*                       @Y30LB40*/ 01932000
*                                                                  0617 01933000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 01934000
*/*%INCLUDE SYSLIB  (IHADCBDF)                                       */ 01935000
*/*%INCLUDE SYSLIB  (IHADCB  )                                       */ 01936000
*                                                                  0617 01937000
*       ;                                                          0617 01938000
@EL00001 L     @13,4(,@13)                                         0617 01939000
@EF00001 L     @00,@SIZDATD                                        0617 01940000
         LR    @01,@10                                             0617 01941000
         FREEMAIN R,LV=(0),A=(1)                                        01942000
@ER00001 LM    @14,@12,12(@13)                                     0617 01943000
         BR    @14                                                 0617 01944000
@DATA    DS    0H                                                       01945000
@CH00729 DC    H'36'                                                    01946000
@CH00653 DC    H'3600'                                                  01947000
@SM00738 MVC   PARMHOLD(0),PARMS(@03)                                   01948000
         DS    0F                                                       01949000
@AL00370 EQU   *                       LIST WITH   2 ARGUMENT(S)        01950000
@AL00397 EQU   *                       LIST WITH   2 ARGUMENT(S)        01951000
@AL00399 EQU   *                       LIST WITH   2 ARGUMENT(S)        01952000
@AL00403 EQU   *                       LIST WITH   2 ARGUMENT(S)        01953000
@AL00407 EQU   *                       LIST WITH   2 ARGUMENT(S)        01954000
@AL00411 EQU   *                       LIST WITH   2 ARGUMENT(S)        01955000
@AL00497 EQU   *                       LIST WITH   2 ARGUMENT(S)        01956000
@AL00522 EQU   *                       LIST WITH   2 ARGUMENT(S)        01957000
@AL00595 DC    A(@CF00103)             LIST WITH   2 ARGUMENT(S)        01958000
         DC    A(@CC00676)                                              01959000
@AL00386 EQU   *                       LIST WITH   2 ARGUMENT(S)        01960000
@AL00388 EQU   *                       LIST WITH   2 ARGUMENT(S)        01961000
@AL00390 EQU   *                       LIST WITH   2 ARGUMENT(S)        01962000
@AL00392 EQU   *                       LIST WITH   2 ARGUMENT(S)        01963000
@AL00395 DC    A(@CF00103)             LIST WITH   2 ARGUMENT(S)        01964000
         DC    A(@CC00680)                                              01965000
@AL00499 EQU   *                       LIST WITH   2 ARGUMENT(S)        01966000
@AL00503 EQU   *                       LIST WITH   2 ARGUMENT(S)        01967000
@AL00587 EQU   *                       LIST WITH   2 ARGUMENT(S)        01968000
@AL00602 DC    A(@CF00043)             LIST WITH   2 ARGUMENT(S)        01969000
         DC    A(@CC00686)                                              01970000
@AL00501 EQU   *                       LIST WITH   2 ARGUMENT(S)        01971000
@AL00505 EQU   *                       LIST WITH   2 ARGUMENT(S)        01972000
@AL00589 DC    A(@CF00050)             LIST WITH   2 ARGUMENT(S)        01973000
         DC    A(@CC00686)                                              01974000
@AL00509 EQU   *                       LIST WITH   2 ARGUMENT(S)        01975000
@AL00511 EQU   *                       LIST WITH   2 ARGUMENT(S)        01976000
@AL00515 EQU   *                       LIST WITH   2 ARGUMENT(S)        01977000
@AL00517 EQU   *                       LIST WITH   2 ARGUMENT(S)        01978000
@AL00597 EQU   *                       LIST WITH   2 ARGUMENT(S)        01979000
@AL00599 DC    A(@CF00103)             LIST WITH   2 ARGUMENT(S)        01980000
         DC    A(@CC00686)                                              01981000
@DATD    DSECT                                                          01982000
         DS    0F                                                       01983000
@SA00001 DS    18F                                                      01984000
@SA00004 DS    15F                                                      01985000
@SA00003 DS    15F                                                      01986000
@PC00003 DS    3F                                                       01987000
@AL00001 DS    3A                                                       01988000
@AFTEMPS DS    2F                                                       01989000
ICGTRVID CSECT                                                          01990000
         DS    0F                                                       01991000
@CF00043 DC    F'1'                                                     01992000
@CF00050 DC    F'2'                                                     01993000
@CF00103 DC    F'4'                                                     01994000
@CF00423 DC    F'9'                                                     01995000
@CF00033 DC    F'11'                                                    01996000
@CF00652 DC    F'23'                                                    01997000
@CF00539 DC    F'30'                                                    01998000
@CF00674 DC    F'55'                                                    01999000
@CF00654 DC    F'59'                                                    02000000
@CF00334 DC    F'60'                                                    02001000
@CH00334 EQU   @CF00334+2                                               02002000
@CF00636 DC    F'365'                                                   02003000
@CH00636 EQU   @CF00636+2                                               02004000
@CF00649 DC    F'366'                                                   02005000
@CH00649 EQU   @CF00649+2                                               02006000
@CF00631 DC    F'600'                                                   02007000
@CF00637 DC    F'86399'                                                 02008000
@CF00708 DC    F'86400'                                                 02009000
@DATD    DSECT                                                          02010000
         DS    0D                                                       02011000
DCBPTR   DS    A                                                        02012000
TIMESL   DS    F                                                        02013000
PARMPTR  DS    A                                                        02014000
OPENCLOS DS    FL4                                                      02015000
         ORG   OPENCLOS                                                 02016000
OPCLB1   DS    BL1                                                      02017000
OPCLB234 DS    CL3                                                      02018000
         ORG   OPENCLOS+4                                               02019000
RCDCOUNT DS    F                                                        02020000
PAGECNT  DS    F                                                        02021000
HOUR     DS    F                                                        02022000
MINUTE   DS    F                                                        02023000
SECOND   DS    F                                                        02024000
LIB      DS    FL1                                                      02025000
@TS00001 DS    CL1                                                      02026000
         DS    CL2                                                      02027000
RCDIN    DS    CL72                                                     02028000
         ORG   RCDIN                                                    02029000
STGD     DS    FL4                                                      02030000
CFAULT   DS    FL4                                                      02031000
SYSSGTM  DS    FL4                                                      02032000
DEVSGTM  DS    FL4                                                      02033000
DSTGD    DS    FL4                                                      02034000
SALLOC   DS    FL4                                                      02035000
SYSDSTM  DS    FL4                                                      02036000
DEVDSTM  DS    FL4                                                      02037000
BUSYTIME DS    FL4                                                      02038000
LOADTIME DS    FL4                                                      02039000
LOADNUM  DS    FL1                                                      02040000
CKTIME   DS    CL7                                                      02041000
         ORG   CKTIME                                                   02042000
SVEYEAR  DS    FL1                                                      02043000
SVEJUL   DS    FL2                                                      02044000
SVETIME  DS    FL4                                                      02045000
         ORG   RCDIN+48                                                 02046000
PAGES    DS    FL1                                                      02047000
MININUM  DS    FL1                                                      02048000
HITNUM   DS    FL1                                                      02049000
STGDNUM  DS    FL1                                                      02050000
DSTGDNUM DS    FL1                                                      02051000
VTOCSTG  DS    FL1                                                      02052000
VTOCDSTG DS    FL1                                                      02053000
LIBRARY  DS    FL1                                                      02054000
DSPORT   DS    FL1                                                      02055000
DSCU     DS    FL1                                                      02056000
Z        DS    FL1                                                      02057000
Y        DS    FL1                                                      02058000
X        DS    FL1                                                      02059000
CARTPAIR DS    FL1                                                      02060000
READWRIT DS    FL1                                                      02061000
VOLID    DS    CL6                                                      02062000
@NM00030 DS    CL3                                                      02063000
         ORG   RCDIN+72                                                 02064000
PRINTLN  DS    CL121                                                    02065000
         ORG   PRINTLN                                                  02066000
PF0      DS    CL1                                                      02067000
PF1      DS    CL6                                                      02068000
@NM00031 DS    CL1                                                      02069000
PF3      DS    CL8                                                      02070000
@NM00032 DS    CL1                                                      02071000
PF0A     DS    CL1                                                      02072000
@NM00033 DS    CL1                                                      02073000
PF13     DS    CL6                                                      02074000
@NM00034 DS    CL4                                                      02075000
PF13A    DS    CL1                                                      02076000
@NM00035 DS    CL5                                                      02077000
PF15     DS    CL9                                                      02078000
@NM00036 DS    CL1                                                      02079000
PF17     DS    CL9                                                      02080000
@NM00037 DS    CL1                                                      02081000
PF19     DS    CL9                                                      02082000
@NM00038 DS    CL1                                                      02083000
PF21     DS    CL9                                                      02084000
@NM00039 DS    CL1                                                      02085000
PF23     DS    CL9                                                      02086000
@NM00040 DS    CL2                                                      02087000
PF31     DS    CL4                                                      02088000
@NM00041 DS    CL2                                                      02089000
PF33     DS    CL4                                                      02090000
@NM00042 DS    CL2                                                      02091000
PF35     DS    CL4                                                      02092000
@NM00043 DS    CL2                                                      02093000
PF37     DS    CL4                                                      02094000
@NM00044 DS    CL2                                                      02095000
PF39     DS    CL4                                                      02096000
@NM00045 DS    CL7                                                      02097000
         ORG   PRINTLN+121                                              02098000
SPACE1   DS    CL121                                                    02099000
HEADHOLD DS    CL121                                                    02100000
PRNTLINE DS    CL121                                                    02101000
PRNTDCB  DS    CL100                                                    02102000
INDCB    DS    CL100                                                    02103000
STARTTIM DS    CL16                                                     02104000
         ORG   STARTTIM                                                 02105000
@NM00065 DS    CL1                                                      02106000
CKSTIME  DS    CL7                                                      02107000
         ORG   CKSTIME                                                  02108000
HLDSYR   DS    FL1                                                      02109000
HLDSDAY  DS    FL2                                                      02110000
HLDSTIME DS    FL4                                                      02111000
         ORG   STARTTIM+8                                               02112000
@NM00066 DS    CL1                                                      02113000
CKETIME  DS    CL7                                                      02114000
         ORG   CKETIME                                                  02115000
HLDEYR   DS    FL1                                                      02116000
HLDEDAY  DS    FL2                                                      02117000
HLDETIME DS    FL4                                                      02118000
         ORG   STARTTIM+16                                              02119000
TSTIMES  DS    CL16                                                     02120000
         ORG   TSTIMES                                                  02121000
@NM00067 DS    CL1                                                      02122000
TSBEG    DS    CL7                                                      02123000
         ORG   TSBEG                                                    02124000
TSSYR    DS    FL1                                                      02125000
TSSDAY   DS    FL2                                                      02126000
TSSTIME  DS    FL4                                                      02127000
         ORG   TSTIMES+8                                                02128000
@NM00068 DS    CL1                                                      02129000
TSEND    DS    CL7                                                      02130000
         ORG   TSEND                                                    02131000
TSEYR    DS    FL1                                                      02132000
TSEDAY   DS    FL2                                                      02133000
TSETIME  DS    FL4                                                      02134000
         ORG   TSTIMES+16                                               02135000
         DS    CL4                                                      02136000
DOUBLEWD DS    CL8                                                      02137000
TODAY    DS    CL5                                                      02138000
PARMHOLD DS    CL31                                                     02139000
SEQOLD   DS    CL14                                                     02140000
         ORG   SEQOLD                                                   02141000
SOL      DS    FL1                                                      02142000
SOV      DS    CL6                                                      02143000
SOT      DS    CL7                                                      02144000
         ORG   SEQOLD+14                                                02145000
SEQNEW   DS    CL14                                                     02146000
         ORG   SEQNEW                                                   02147000
SNL      DS    FL1                                                      02148000
SNV      DS    CL6                                                      02149000
SNT      DS    CL7                                                      02150000
         ORG   SEQNEW+14                                                02151000
DATEINSW DS    BL1                                                      02152000
FIXOUT   DS    CL13                                                     02153000
VOL      DS    CL6                                                      02154000
PARMERR  DS    BL1                                                      02155000
LIBSW    DS    BL1                                                      02156000
VOLSW    DS    BL1                                                      02157000
TMESW    DS    BL1                                                      02158000
FIRSTSW  DS    BL1                                                      02159000
EOFSW    DS    BL1                                                      02160000
VOLUME   DS    CL6                                                      02161000
SUMARRAY DS    CL36                                                     02162000
         ORG   SUMARRAY+0                                               02163000
SMSTGD   DS    FL4                                                      02164000
SMCFAULT DS    FL4                                                      02165000
SMDSTGD  DS    FL4                                                      02166000
SMSALLOC DS    FL4                                                      02167000
LOADS    DS    FL4                                                      02168000
STGDTOT  DS    FL4                                                      02169000
VTOCSG   DS    FL4                                                      02170000
DSTGDTOT DS    FL4                                                      02171000
VTOCDS   DS    FL4                                                      02172000
         ORG   SUMARRAY+144                                             02173000
ICGTRVID CSECT                                                          02174000
         DS    0F                                                       02175000
@SIZDATD DC    AL1(0)                                                   02176000
         DC    AL3(@ENDDATD-@DATD)                                      02177000
         DS    0D                                                       02178000
@CC00701 DC    C'               '                                       02179000
@CC00673 EQU   @CC00701                                                 02180000
@CC00726 DC    C'  :  :  '                                              02181000
@CC00659 EQU   @CC00701                                                 02182000
@CC00672 DC    C'TOTALS'                                                02183000
@CC00725 DC    C'  /   '                                                02184000
@CC00681 EQU   @CC00701                                                 02185000
@CC00646 DC    C'000'                                                   02186000
@CC00676 DC    C'S'                                                     02187000
@CC00680 DC    C'E'                                                     02188000
@CC00686 DC    C'N'                                                     02189000
HDNG1    DS    CL121                                                    02190000
         ORG   HDNG1                                                    02191000
@NM00046 DC    CL43'1ICGTRVID'                                          02192000
@NM00047 DC    CL58'MSS TRACE VOLUME ACTIVITY'                          02193000
@NM00048 DC    CL20'DATE YYDDD  PAGEXXXX'                               02194000
         ORG   HDNG1+121                                                02195000
HDNG2    DS    CL121                                                    02196000
         ORG   HDNG2                                                    02197000
@NM00049 DC    CL1'0'                                                   02198000
@NM00050 DC    CL40'                                        '           02199000
@NM00051 DC    CL40'       CYLINDER            SPACE   TOTAL'           02200000
@NM00052 DC    CL40'                                        '           02201000
         ORG   HDNG2+121                                                02202000
HDNG3    DS    CL121                                                    02203000
         ORG   HDNG3                                                    02204000
@NM00053 DC    CL1' '                                                   02205000
@NM00054 DC    CL40'                         CARTRIDGE   CYL'           02206000
@NM00055 DC    CL40'INDERS FAULT    CYLINDERS  ALLOC   STAGI'           02207000
@NM00056 DC    CL40'NG   CARTG       VTOC        VTOC       '           02208000
         ORG   HDNG3+121                                                02209000
HDNG4    DS    CL121                                                    02210000
         ORG   HDNG4                                                    02211000
@NM00057 DC    CL1' '                                                   02212000
@NM00058 DC    CL40' DATE    TIME  MSF VOLID  NUMBER     STA'           02213000
@NM00059 DC    CL40'GED    CAUSED   DESTAGED   CAUSED  ACTIV'           02214000
@NM00060 DC    CL40'ITY  LOADS STGS  STGS  DSTGS DSTGS      '           02215000
         ORG   HDNG4+121                                                02216000
RCDTOTAL DS    CL121                                                    02217000
         ORG   RCDTOTAL                                                 02218000
@NM00061 DC    CL1'1'                                                   02219000
@NM00062 DC    CL40'T-SLICE - XXX  DATES - YYDDD-YYDDD  TIME'           02220000
@NM00063 DC    CL40'S - HHMM-HHMM  VOLUME - VVVVVV  INPUT RE'           02221000
@NM00064 DC    CL40'CORDS SELECTED - XXXXXX                 '           02222000
         ORG   RCDTOTAL+121                                             02223000
PARMMSG  DC    CL28'1ICG900I INVALID PARM VALUES'                       02224000
TRINMSG  DC    CL31'1ICG901I OPEN ERROR FOR TRACEIN'                    02225000
SEQMSG   DC    CL43'1ICG903I INPUT FILE TRACEIN OUT OF SEQUENCE'        02226000
ICGTR904 DC    CL30' ICG904I I/O ERROR ON TRACEIN '                     02227000
         DS    CL2                                                      02228000
FIXAREA  DS    CL200                                                    02229000
         ORG   FIXAREA                                                  02230000
@NM00069 DC    200CL1'Z'                                                02231000
         ORG   FIXAREA+200                                              02232000
ICGTRVID CSECT                                                          02233000
*                                                         /*@Y30LB40*/  02234000
IPATDCB  DCB   DSORG=PS,DDNAME=TRACEIN,MACRF=GM,RECFM=FB,LRECL=72,    **02235000
               EODAD=EOF,EROPT=SKP,SYNAD=READERR                        02236000
IDCBL    EQU   *-IPATDCB                                                02237000
PPATDCB  DCB   DSORG=PS,DDNAME=SYSPRINT,MACRF=PM,RECFM=FBA,LRECL=121    02238000
PDCBL    EQU   *-PPATDCB                                                02239000
@DATD    DSECT                                                          02240000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                02241000
@ENDDATD EQU   *                                                        02242000
ICGTRVID CSECT                                                          02243000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       02244000
@01      EQU   01                                                       02245000
@02      EQU   02                                                       02246000
@03      EQU   03                                                       02247000
@04      EQU   04                                                       02248000
@05      EQU   05                                                       02249000
@06      EQU   06                                                       02250000
@07      EQU   07                                                       02251000
@08      EQU   08                                                       02252000
@09      EQU   09                                                       02253000
@10      EQU   10                                                       02254000
@11      EQU   11                                                       02255000
@12      EQU   12                                                       02256000
@13      EQU   13                                                       02257000
@14      EQU   14                                                       02258000
@15      EQU   15                                                       02259000
J        EQU   @06                                                      02260000
I        EQU   @07                                                      02261000
SS       EQU   @02                                                      02262000
RETURNCD EQU   @09                                                      02263000
TIMEWORK EQU   @03                                                      02264000
SAVE14   EQU   @06                                                      02265000
LINECNT  EQU   @08                                                      02266000
R0       EQU   @00                                                      02267000
R1       EQU   @01                                                      02268000
R2       EQU   @02                                                      02269000
R3       EQU   @03                                                      02270000
R14      EQU   @14                                                      02271000
R15      EQU   @15                                                      02272000
IHADCB   EQU   0                                                        02273000
IHADCS05 EQU   0                                                        02274000
DCBMODE  EQU   IHADCS05                                                 02275000
DCBSTACK EQU   DCBMODE                                                  02276000
DCBFUNC  EQU   IHADCS05+3                                               02277000
IHADCS11 EQU   0                                                        02278000
DCBRELB  EQU   IHADCS11                                                 02279000
DCBREL   EQU   DCBRELB+1                                                02280000
DCBBUFCB EQU   IHADCS11+4                                               02281000
DCBDSORG EQU   IHADCS11+10                                              02282000
DCBDSRG1 EQU   DCBDSORG                                                 02283000
DCBDSRG2 EQU   DCBDSORG+1                                               02284000
DCBIOBAD EQU   IHADCS11+12                                              02285000
DCBODEB  EQU   DCBIOBAD                                                 02286000
DCBLNP   EQU   DCBODEB                                                  02287000
DCBQSLM  EQU   DCBLNP                                                   02288000
DCBIOBAA EQU   DCBODEB+1                                                02289000
IHADCS50 EQU   0                                                        02290000
DCBSVCXL EQU   IHADCS50                                                 02291000
DCBEODAD EQU   IHADCS50+4                                               02292000
DCBBFALN EQU   DCBEODAD                                                 02293000
DCBHIARC EQU   DCBBFALN                                                 02294000
DCBBFTEK EQU   DCBHIARC                                                 02295000
DCBBFT   EQU   DCBBFTEK                                                 02296000
DCBEXLST EQU   IHADCS50+8                                               02297000
DCBRECFM EQU   DCBEXLST                                                 02298000
DCBRECLA EQU   DCBRECFM                                                 02299000
IHADCS24 EQU   0                                                        02300000
DCBOFLGS EQU   IHADCS24+8                                               02301000
DCBOFLWR EQU   DCBOFLGS                                                 02302000
DCBIFLG  EQU   IHADCS24+9                                               02303000
DCBMACR  EQU   IHADCS24+10                                              02304000
DCBMACR1 EQU   DCBMACR                                                  02305000
DCBMRFE  EQU   DCBMACR1                                                 02306000
DCBMRGET EQU   DCBMRFE                                                  02307000
DCBMRAPG EQU   DCBMACR1                                                 02308000
DCBMRRD  EQU   DCBMRAPG                                                 02309000
DCBMRCI  EQU   DCBMACR1                                                 02310000
DCBMRMVG EQU   DCBMRCI                                                  02311000
DCBMRLCG EQU   DCBMACR1                                                 02312000
DCBMRABC EQU   DCBMACR1                                                 02313000
DCBMRPT1 EQU   DCBMRABC                                                 02314000
DCBMRSBG EQU   DCBMRPT1                                                 02315000
DCBMRCRL EQU   DCBMACR1                                                 02316000
DCBMRCHK EQU   DCBMRCRL                                                 02317000
DCBMRRDX EQU   DCBMRCHK                                                 02318000
DCBMRDMG EQU   DCBMACR1                                                 02319000
DCBMACR2 EQU   DCBMACR+1                                                02320000
DCBMRPUT EQU   DCBMACR2                                                 02321000
DCBMRWRT EQU   DCBMACR2                                                 02322000
DCBMRMVP EQU   DCBMACR2                                                 02323000
DCBMR5WD EQU   DCBMACR2                                                 02324000
DCBMRLDM EQU   DCBMR5WD                                                 02325000
DCBMRLCP EQU   DCBMRLDM                                                 02326000
DCBMR4WD EQU   DCBMACR2                                                 02327000
DCBMRPT2 EQU   DCBMR4WD                                                 02328000
DCBMRTMD EQU   DCBMRPT2                                                 02329000
DCBMR3WD EQU   DCBMACR2                                                 02330000
DCBMRCTL EQU   DCBMR3WD                                                 02331000
DCBMRSTK EQU   DCBMRCTL                                                 02332000
DCBMR1WD EQU   DCBMACR2                                                 02333000
DCBMRSWA EQU   DCBMR1WD                                                 02334000
DCBMRDMD EQU   DCBMRSWA                                                 02335000
IHADCS25 EQU   0                                                        02336000
DCBMACRF EQU   IHADCS25+2                                               02337000
DCBMACF1 EQU   DCBMACRF                                                 02338000
DCBMFFE  EQU   DCBMACF1                                                 02339000
DCBMFGET EQU   DCBMFFE                                                  02340000
DCBMFAPG EQU   DCBMACF1                                                 02341000
DCBMFRD  EQU   DCBMFAPG                                                 02342000
DCBMFCI  EQU   DCBMACF1                                                 02343000
DCBMFMVG EQU   DCBMFCI                                                  02344000
DCBMFLCG EQU   DCBMACF1                                                 02345000
DCBMFABC EQU   DCBMACF1                                                 02346000
DCBMFPT1 EQU   DCBMFABC                                                 02347000
DCBMFSBG EQU   DCBMFPT1                                                 02348000
DCBMFCRL EQU   DCBMACF1                                                 02349000
DCBMFCHK EQU   DCBMFCRL                                                 02350000
DCBMFDMG EQU   DCBMACF1                                                 02351000
DCBMACF2 EQU   DCBMACRF+1                                               02352000
DCBMFPUT EQU   DCBMACF2                                                 02353000
DCBMFWRT EQU   DCBMACF2                                                 02354000
DCBMFMVP EQU   DCBMACF2                                                 02355000
DCBMF5WD EQU   DCBMACF2                                                 02356000
DCBMFLDM EQU   DCBMF5WD                                                 02357000
DCBMFLCP EQU   DCBMFLDM                                                 02358000
DCBMF4WD EQU   DCBMACF2                                                 02359000
DCBMFPT2 EQU   DCBMF4WD                                                 02360000
DCBMFTMD EQU   DCBMFPT2                                                 02361000
DCBMF3WD EQU   DCBMACF2                                                 02362000
DCBMFCTL EQU   DCBMF3WD                                                 02363000
DCBMFSTK EQU   DCBMFCTL                                                 02364000
DCBMF1WD EQU   DCBMACF2                                                 02365000
DCBMFSWA EQU   DCBMF1WD                                                 02366000
DCBMFDMD EQU   DCBMFSWA                                                 02367000
DCBDEBAD EQU   IHADCS25+4                                               02368000
DCBIFLGS EQU   DCBDEBAD                                                 02369000
IHADCS26 EQU   0                                                        02370000
DCBWRITE EQU   IHADCS26                                                 02371000
DCBREAD  EQU   DCBWRITE                                                 02372000
DCBWRITA EQU   DCBREAD+1                                                02373000
IHADCS27 EQU   0                                                        02374000
DCBGET   EQU   IHADCS27                                                 02375000
DCBPUT   EQU   DCBGET                                                   02376000
DCBGETA  EQU   DCBPUT+1                                                 02377000
IHADCS36 EQU   0                                                        02378000
DCBGERR  EQU   IHADCS36                                                 02379000
DCBPERR  EQU   DCBGERR                                                  02380000
DCBCHECK EQU   DCBPERR                                                  02381000
DCBOPTCD EQU   DCBCHECK                                                 02382000
DCBOPTH  EQU   DCBOPTCD                                                 02383000
DCBOPTO  EQU   DCBOPTH                                                  02384000
DCBOPTZ  EQU   DCBOPTCD                                                 02385000
DCBGERRA EQU   DCBCHECK+1                                               02386000
DCBPERRA EQU   DCBGERRA                                                 02387000
DCBSYNAD EQU   IHADCS36+4                                               02388000
DCBCIND1 EQU   IHADCS36+8                                               02389000
DCBCIND2 EQU   IHADCS36+9                                               02390000
DCBIOBA  EQU   IHADCS36+16                                              02391000
DCBCICB  EQU   DCBIOBA                                                  02392000
IHADCS52 EQU   0                                                        02393000
DCBDIRCT EQU   IHADCS52                                                 02394000
DCBQSWS  EQU   DCBDIRCT                                                 02395000
DCBUSASI EQU   DCBQSWS                                                  02396000
DCBQADFS EQU   DCBUSASI                                                 02397000
DCBBUFOF EQU   DCBDIRCT+1                                               02398000
IHADCS37 EQU   0                                                        02399000
DCBFLAG1 EQU   IHADCS37                                                 02400000
IHADCS38 EQU   0                                                        02401000
DCBEOBR  EQU   IHADCS38                                                 02402000
DCBPOINT EQU   IHADCS38+12                                              02403000
DCBCNTRL EQU   DCBPOINT                                                 02404000
IHADCS40 EQU   0                                                        02405000
DCBEOBAD EQU   IHADCS40                                                 02406000
DCBCCCW  EQU   IHADCS40+4                                               02407000
DCBRECAD EQU   DCBCCCW                                                  02408000
DCBRECBT EQU   DCBRECAD                                                 02409000
DCBRCREL EQU   DCBRECBT                                                 02410000
@NM00026 EQU   IHADCS40+12                                              02411000
DCBEROPT EQU   @NM00026                                                 02412000
PARMVALS EQU   0                                                        02413000
PARMLEN  EQU   PARMVALS                                                 02414000
PARMS    EQU   PARMVALS+2                                               02415000
FIXADDR  EQU   0                                                        02416000
FIXLEN   EQU   0                                                        02417000
FIXOPT   EQU   0                                                        02418000
*                                      START UNREFERENCED COMPONENTS    02419000
DCBEOB   EQU   IHADCS40+20                                              02420000
DCBPRECL EQU   IHADCS40+18                                              02421000
@NM00029 EQU   IHADCS40+16                                              02422000
@NM00028 EQU   @NM00026+1                                               02423000
@NM00027 EQU   DCBEROPT                                                 02424000
DCBERABE EQU   DCBEROPT                                                 02425000
DCBERSKP EQU   DCBEROPT                                                 02426000
DCBERACC EQU   DCBEROPT                                                 02427000
@NM00025 EQU   IHADCS40+10                                              02428000
@NM00024 EQU   IHADCS40+9                                               02429000
@NM00023 EQU   IHADCS40+8                                               02430000
DCBRECA  EQU   DCBRECAD+1                                               02431000
@NM00022 EQU   DCBRECBT                                                 02432000
DCBRCFGT EQU   DCBRCREL                                                 02433000
DCBRCTRU EQU   DCBRCREL                                                 02434000
DCBLCCW  EQU   DCBEOBAD                                                 02435000
DCBNOTE  EQU   DCBCNTRL                                                 02436000
DCBLRECL EQU   IHADCS38+10                                              02437000
@NM00021 EQU   IHADCS38+8                                               02438000
DCBEOBW  EQU   IHADCS38+4                                               02439000
DCBEOBRA EQU   DCBEOBR+1                                                02440000
DCBNCP   EQU   DCBEOBR                                                  02441000
@NM00020 EQU   DCBFLAG1                                                 02442000
DCBSTFLS EQU   DCBFLAG1                                                 02443000
DCBSTQCK EQU   DCBFLAG1                                                 02444000
DCBDIRCQ EQU   DCBBUFOF                                                 02445000
DCBQSTRU EQU   DCBUSASI                                                 02446000
@NM00019 EQU   DCBUSASI                                                 02447000
DCBQADF3 EQU   DCBQADFS                                                 02448000
DCBQADF2 EQU   DCBQADFS                                                 02449000
DCBQADF1 EQU   DCBQADFS                                                 02450000
DCBBLBP  EQU   DCBUSASI                                                 02451000
@NM00018 EQU   DCBUSASI                                                 02452000
DCBCICBA EQU   DCBCICB+1                                                02453000
@NM00017 EQU   DCBCICB                                                  02454000
DCBOFFSW EQU   IHADCS36+15                                              02455000
DCBOFFSR EQU   IHADCS36+14                                              02456000
DCBWCPL  EQU   IHADCS36+13                                              02457000
DCBWCPO  EQU   IHADCS36+12                                              02458000
DCBBLKSI EQU   IHADCS36+10                                              02459000
DCBCNQSM EQU   DCBCIND2                                                 02460000
DCBCNFEO EQU   DCBCIND2                                                 02461000
DCBCNCHS EQU   DCBCIND2                                                 02462000
DCBCNBFP EQU   DCBCIND2                                                 02463000
DCBCNIOE EQU   DCBCIND2                                                 02464000
DCBCNCLO EQU   DCBCIND2                                                 02465000
DCBCNWRO EQU   DCBCIND2                                                 02466000
DCBCNSTO EQU   DCBCIND2                                                 02467000
DCBCNEXB EQU   DCBCIND1                                                 02468000
@NM00016 EQU   DCBCIND1                                                 02469000
DCBCNBRM EQU   DCBCIND1                                                 02470000
@NM00015 EQU   DCBCIND1                                                 02471000
DCBCNEVA EQU   DCBCIND1                                                 02472000
DCBCNEVB EQU   DCBCIND1                                                 02473000
DCBCNSRD EQU   DCBCIND1                                                 02474000
DCBCNTOV EQU   DCBCIND1                                                 02475000
DCBSYNA  EQU   DCBSYNAD+1                                               02476000
DCBIOBL  EQU   DCBSYNAD                                                 02477000
DCBCHCKA EQU   DCBPERRA                                                 02478000
@NM00014 EQU   DCBOPTCD                                                 02479000
DCBOPTT  EQU   DCBOPTCD                                                 02480000
DCBSRCHD EQU   DCBOPTZ                                                  02481000
DCBOPTQ  EQU   DCBOPTCD                                                 02482000
DCBBCKPT EQU   DCBOPTO                                                  02483000
DCBOPTC  EQU   DCBOPTCD                                                 02484000
DCBOPTU  EQU   DCBOPTCD                                                 02485000
DCBOPTW  EQU   DCBOPTCD                                                 02486000
DCBPUTA  EQU   DCBGETA                                                  02487000
@NM00013 EQU   DCBPUT                                                   02488000
DCBREADA EQU   DCBWRITA                                                 02489000
@NM00012 EQU   DCBREAD                                                  02490000
DCBDEBA  EQU   DCBDEBAD+1                                               02491000
@NM00011 EQU   DCBIFLGS                                                 02492000
DCBIFIOE EQU   DCBIFLGS                                                 02493000
DCBIFPCT EQU   DCBIFLGS                                                 02494000
DCBIFEC  EQU   DCBIFLGS                                                 02495000
DCBMFSTI EQU   DCBMFDMD                                                 02496000
DCBMFAWR EQU   DCBMFSTK                                                 02497000
DCBMFUIP EQU   DCBMFTMD                                                 02498000
DCBMFIDW EQU   DCBMFLCP                                                 02499000
DCBMFWRK EQU   DCBMFMVP                                                 02500000
DCBMFRDQ EQU   DCBMFWRT                                                 02501000
DCBMFGTQ EQU   DCBMFPUT                                                 02502000
DCBMFSTL EQU   DCBMACF2                                                 02503000
DCBMFCK  EQU   DCBMFDMG                                                 02504000
DCBMFRDX EQU   DCBMFCHK                                                 02505000
DCBMFDBF EQU   DCBMFSBG                                                 02506000
DCBMFRDI EQU   DCBMFLCG                                                 02507000
DCBMFRDK EQU   DCBMFMVG                                                 02508000
DCBMFWRQ EQU   DCBMFRD                                                  02509000
DCBMFPTQ EQU   DCBMFGET                                                 02510000
DCBMFECP EQU   DCBMACF1                                                 02511000
DCBTIOT  EQU   IHADCS25                                                 02512000
DCBMRSTI EQU   DCBMRDMD                                                 02513000
DCBMRAWR EQU   DCBMRSTK                                                 02514000
DCBMRUIP EQU   DCBMRTMD                                                 02515000
DCBMRIDW EQU   DCBMRLCP                                                 02516000
DCBMRWRK EQU   DCBMRMVP                                                 02517000
DCBMRRDQ EQU   DCBMRWRT                                                 02518000
DCBMRGTQ EQU   DCBMRPUT                                                 02519000
DCBMRSTL EQU   DCBMACR2                                                 02520000
DCBMRCK  EQU   DCBMRDMG                                                 02521000
DCBPGFXA EQU   DCBMRRDX                                                 02522000
DCBMRDBF EQU   DCBMRSBG                                                 02523000
DCBMRRDI EQU   DCBMRLCG                                                 02524000
DCBMRRDK EQU   DCBMRMVG                                                 02525000
DCBMRWRQ EQU   DCBMRRD                                                  02526000
DCBMRPTQ EQU   DCBMRGET                                                 02527000
DCBMRECP EQU   DCBMACR1                                                 02528000
@NM00010 EQU   DCBIFLG                                                  02529000
DCBIBIOE EQU   DCBIFLG                                                  02530000
DCBIBPCT EQU   DCBIFLG                                                  02531000
DCBIBEC  EQU   DCBIFLG                                                  02532000
DCBOFIOF EQU   DCBOFLGS                                                 02533000
DCBOFUEX EQU   DCBOFLGS                                                 02534000
DCBOFTM  EQU   DCBOFLGS                                                 02535000
DCBOFPPC EQU   DCBOFLGS                                                 02536000
DCBOFOPN EQU   DCBOFLGS                                                 02537000
DCBOFEOV EQU   DCBOFLGS                                                 02538000
DCBOFLRB EQU   DCBOFLGS                                                 02539000
DCBOFIOD EQU   DCBOFLWR                                                 02540000
DCBDDNAM EQU   IHADCS24                                                 02541000
DCBEXLSA EQU   DCBEXLST+1                                               02542000
DCBRECKL EQU   DCBRECFM                                                 02543000
DCBRECCC EQU   DCBRECFM                                                 02544000
DCBRECSB EQU   DCBRECFM                                                 02545000
DCBRECBR EQU   DCBRECFM                                                 02546000
DCBRECTO EQU   DCBRECLA                                                 02547000
DCBRECL  EQU   DCBRECLA                                                 02548000
DCBEODA  EQU   DCBEODAD+1                                               02549000
DCBBFA   EQU   DCBBFTEK                                                 02550000
DCBH0    EQU   DCBBFTEK                                                 02551000
DCBBFTKD EQU   DCBBFTEK                                                 02552000
DCBBFTE  EQU   DCBBFT                                                   02553000
DCBBFTKR EQU   DCBBFT                                                   02554000
DCBBFTS  EQU   DCBBFT                                                   02555000
DCBH1    EQU   DCBBFTEK                                                 02556000
DCBSVCXA EQU   DCBSVCXL+1                                               02557000
@NM00009 EQU   DCBSVCXL                                                 02558000
DCBODEBA EQU   DCBIOBAA                                                 02559000
@NM00008 EQU   DCBQSLM                                                  02560000
DCBUPDBT EQU   DCBQSLM                                                  02561000
DCBUPDCM EQU   DCBQSLM                                                  02562000
DCB1DVDS EQU   DCBQSLM                                                  02563000
@NM00007 EQU   DCBDSRG2                                                 02564000
DCBDSGTR EQU   DCBDSRG2                                                 02565000
DCBACBM  EQU   DCBDSRG2                                                 02566000
@NM00006 EQU   DCBDSRG2                                                 02567000
DCBDSGTQ EQU   DCBDSRG2                                                 02568000
DCBDSGTX EQU   DCBDSRG2                                                 02569000
DCBDSGGS EQU   DCBDSRG2                                                 02570000
DCBDSGU  EQU   DCBDSRG1                                                 02571000
DCBDSGPO EQU   DCBDSRG1                                                 02572000
DCBDSGMQ EQU   DCBDSRG1                                                 02573000
DCBDSGCQ EQU   DCBDSRG1                                                 02574000
DCBDSGCX EQU   DCBDSRG1                                                 02575000
DCBDSGDA EQU   DCBDSRG1                                                 02576000
DCBDSGPS EQU   DCBDSRG1                                                 02577000
DCBDSGIS EQU   DCBDSRG1                                                 02578000
DCBBUFL  EQU   IHADCS11+8                                               02579000
DCBBUFCA EQU   DCBBUFCB+1                                               02580000
DCBBUFNO EQU   DCBBUFCB                                                 02581000
DCBDEVT  EQU   DCBREL                                                   02582000
DCBKEYLE EQU   DCBRELB                                                  02583000
@NM00005 EQU   DCBFUNC                                                  02584000
DCBFNCBT EQU   DCBFUNC                                                  02585000
DCBFNCBX EQU   DCBFUNC                                                  02586000
DCBFNCBD EQU   DCBFUNC                                                  02587000
DCBFNCBW EQU   DCBFUNC                                                  02588000
DCBFNCBP EQU   DCBFUNC                                                  02589000
DCBFNCBR EQU   DCBFUNC                                                  02590000
DCBFNCBI EQU   DCBFUNC                                                  02591000
@NM00004 EQU   IHADCS05+2                                               02592000
@NM00003 EQU   IHADCS05+1                                               02593000
DCBSTCK1 EQU   DCBSTACK                                                 02594000
DCBSTCK2 EQU   DCBSTACK                                                 02595000
@NM00002 EQU   DCBSTACK                                                 02596000
DCBMODER EQU   DCBSTACK                                                 02597000
DCBMODEO EQU   DCBSTACK                                                 02598000
DCBMODEE EQU   DCBSTACK                                                 02599000
DCBMODEC EQU   DCBSTACK                                                 02600000
@NM00001 EQU   IHADCB                                                   02601000
*                                      END UNREFERENCED COMPONENTS      02602000
@RT00139 EQU   PARMEND                                                  02603000
@RT00158 EQU   PARMEND                                                  02604000
@RT00178 EQU   PARMEND                                                  02605000
@RF00193 EQU   @RC00191                                                 02606000
@RF00203 EQU   @RC00201                                                 02607000
@RT00217 EQU   PARMEND                                                  02608000
@RT00230 EQU   PARMEND                                                  02609000
@RT00259 EQU   PARMEND                                                  02610000
@RT00271 EQU   PARMEND                                                  02611000
@RT00292 EQU   RDTRACE                                                  02612000
@RT00294 EQU   RDTRACE                                                  02613000
@RT00297 EQU   RDTRACE                                                  02614000
@RT00436 EQU   EOJ                                                      02615000
@RF00483 EQU   CHECKTIM                                                 02616000
@RT00578 EQU   EF4                                                      02617000
EFEND    EQU   @EL00003                                                 02618000
@RT00576 EQU   EFEND                                                    02619000
@ENDDATA EQU   *                                                        02620000
         END   ICGTRVID,(C'PLS2119',0603,76198)                         02621000
