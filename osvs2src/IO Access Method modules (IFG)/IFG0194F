         TITLE 'IFG0194F                      TAPE MOUNT VERIFICATION'  00010002
IFG0194F CSECT                                                          00020002
         ENTRY IFG0554F                 ENTRY POINT FROM EOV     Y02134 00021002
IFG0554F EQU   IFG0194F                 ALIAS ENTRY POINT        Y02134 00022002
*********************************************************************** 00025002
*                                                                     * 00025137
*        VS2 RELEASE 2.0 DELETION/CHANGES                             * 00025637
*                                                                     * 00026137
*0000003373-003381,420470,420869-420879,410825                 @ZA00615 00026637
*0000356381-356431,356465-356485,356576,358452,358553           ZA00706 00027202
*0000                                                           ZA01493 00029202
*0000383100-3831100,383738-383758                              @ZA01337 00029602
*0000                                                          @ZA08328 00029737
*                                                                     * 00029837
*        VS2 RELEASE 3.0 DELETIONS/CHANGES                            * 00031837
*                                                                     * 00033837
*0000406355,408710                                             @ZA02881 00037837
*        VS2 SU32 DELETIONS                                           * 00038832
*D356496-356576                                                @G32DSMI 00040032
*                                                              @ZM04454 00040632
*                                                              @ZM04457 00041232
*                                                              @ZM04458 00041632
*                                                              @ZM04613 00041832
*        VS2 RELEASE 04 DELETIONS/CHANGES                             * 00042032
*0000                                                          @ZA06438 00045837
*0000408705                                                    @ZA08904 00053837
*0000003359-0033380                                            @ZA08253 00061837
*0000                                                          @ZA10004 00065837
*0000409070-4091150                                            @ZA11140 00066837
*0000317968,797160,317970-318141,318340,318396,318756          @ZA10245 00067837
*0000                                                          @ZA12921 00068837
*0000353924,409567,409659,409797,410050                        @ZA13577 00069837
*00005083,5695,319092                                          @ZA14560 00070337
*0000404720,404724                                             @ZA14623 00070837
*0000                                                          @ZA15064 00071337
*        VS2 RELEASE 3.7 DELETIONS/CHANGES                            * 00071437
*                                                                     * 00071537
*0000                                                          @ZA18506 00071637
*0000                                                          @ZA19728 00071737
*A318362-318372                                                @ZA20480 00071837
*A319195,319200-319208,319212,319213,353874,C319214            @ZA20457 00071937
*C410630                                                       @ZA30793 00072032
*0000                                                          @ZA32328 00072400
*********************************************************************** 00072637
*********************************************************************** 00072732
*********************************************************************** 00072837
*                                                                     * 00072937
*                                                                     * 00077032
*********************************************************************** 00078032
*                                                                     * 00079032
* MODULE NAME = IFG0194F (OS/VS2)                                     * 00080002
*                                                                     * 00130002
* DESCRIPTIVE NAME = TAPE MOUNT VERIFICATION                          * 00180002
*                                                                     * 00190002
* COPYRIGHT = NONE                                                    * 00200002
*                                                                     * 00210002
* STATUS = RELEASE 2, LEVEL 0                                         * 00220002
*                                                                     * 00222002
* FUNCTION =                                                          * 00224002
*        1. BUILD THE DXDEBMOD FIELD TO SET THE DENSITY IN WHICH      * 00226002
*        THE LABELS ARE TO BE WRITTEN AND TO INSURE COMPLETION OF THE * 00228002
*        JFCB FIELD.                                                  * 00228402
*                                                                     * 00228502
*        2. DETERMINE IF THE ASCII OPTION WAS SYSGENED WHEN THE USER  * 00228802
*        SPECIFIED ASCII PROCESSING OR 7 TRACK TAPE REQUEST. (ERROR   * 00229502
*        OUTPUTTED IF NOT).                                           * 00231502
*                                                                     * 00231902
*        3. INSURES MOUNTING OF TAPE VOLUMES BASED ON THE DISPOSITION * 00233502
*        OF THE MOUNT BIT (UCBDMCT, HIGH ORDER BIT AT OFFSET 35 IN    * 00235502
*        TAPE UCB) AND THE CONTENTS OF THE VOLUME SERIAL FIELD        * 00235902
*        (UCBVOLI, OFFSET 28 OF TAPE UCB).  IF THE MOUNT BIT IS ON,   * 00236002
*        THE VOLUME SERIAL NUMBER IS ZEROED IN THE UCB SO THAT LABEL  * 00236202
*        VERIFICATION CAN BE MADE.                                    * 00236302
*        IF THE MOUNT BIT IS OFF, A CHECK IS MADE TO DETERMINE IF     * 00236402
*        THE CORRECT VOLUME IS MOUNTED BY COMPARING VOLUME SERIAL IN  * 00236502
*        JFCB AGAINST THAT IN UCB. IF THE CORRECT VOLUME IS NOT       * 00236702
*        MOUNTED, A MOUNT MESSAGE WILL BE SET UP FOR FIRST AVAILABLE  * 00237102
*        UNIT, AND A DISMOUNT OR RETAIN MESSAGE ISSUED FOR THE DRIVE  * 00237202
*        CONTAINING THE TAPE.                                         * 00237302
*                                                                     * 00237402
*        4. VERIFY TAPE VOLUME LABEL UNLESS BLP IS SPECIFIED.  AN     * 00237502
*        ATTEMPT IS MADE TO READ A VOLUME LABEL.  IF A LABEL CONFLICT * 00237902
*        OCCURS, THE LABEL EDITOR INTERFACE MODULE IS ENTERED.  IF    * 00238002
*        A VOLUME CONFLICT OCCURS, THE VOLUME MOUNTING MODULE IS      * 00238402
*        ENTERED FOR A DISMOUNT AND REMOUNT.  FOR NL OR BLP NON-      * 00238502
*        SPECIFIC REQUESTS, A LXXXYY WILL BE GENERATED FOR THE VOLUME * 00238602
*        SERIAL NUMBER.  FILE PROTECTION IS CHECKED FOR OUTPUT,       * 00238702
*        OUTIN, INOUT, AND RACF PROTECTED DATA SETS.  IF THE TAPE     * 00238832
*        IS FILE-PROTECTED FOR OUTPUT-TYPE PROCESSING, A MESSAGE      * 00238932
*        IS ISSUED FOR THE OPERATOR TO INSERT THE FILE-PROTECT RING.  * 00239032
*                                                                     * 00239132
*        5. IF THE SYSTEM HAS RACF TAPE VOLUME PROTECTION AND THE TAPE* 00239232
*        IS FILE-PROTECTED, A RACHECK FOR READ IS ISSUED.  IF THE     * 00239332
*        TAPE IS NOT FILE PROTECTED, A RACHECK FOR UPDATE IS ISSUED.  * 00239432
*        IN THIS CASE, IF THE USER DOES NOT HAVE THE REQUIRED UPDATE  * 00239532
*        AUTHORIZATION BUT DOES HAVE READ AUTHORIZATION, MESSAGE      * 00239632
*        IEC135A IS ISSUED FOR THE OPERATOR TO REMOVE THE FILE        * 00239732
*        PROTECT RING.  IF THE VOLUME IS AN ASCII TAPE AND THE        * 00239932
*        VOLUME ACCESSABILITY BYTE IS NOT BLANK, THEN THE TAPE        * 00240332
*        AND THE VOLUME ACCESSIBILITY BYTE IS NOT BLANK, THE TAPE     * 00240432
*        CANNOT BE PROCESSED.  IF THE REQUEST WAS FOR A NON-SPECIFIC  * 00240632
*        VOLUME, THE VOLUME IS DISMOUNTED AND A REQUEST FOR A SCRATCH * 00240832
*        VOLUME IS MADE.                                              * 00241032
*                                                                     * 00241232
* NOTES = SEE  BELOW                                                  * 00241402
*                                                                     * 00241502
*    DEPENDENCIES =                                                   * 00241602
*            CLASS ONE CHARACTER CODE.  THE EBCDIC CHARACTER CODE     * 00242002
*            WAS USED FOR ASSEMBLY.  THE MODULE MUST BE REASSEMBLED   * 00242102
*            IF A DIFFERENT CHARACTER SET IS USED FOR EXECUTION.      * 00242502
*                                                                     * 00242802
*    RESTRICTIONS = NONE                                              * 00242902
*                                                                     * 00243002
*    REGISTER CONVENTIONS =                                           * 00243102
*            R2 POINTS TO DCB                                         * 00243202
*            R4 POINTS TO OPEN WORK AREA                              * 00243602
*            R5 POINTS TO THE RESIDENT ROUTINE                        * 00244002
*            R6 POINTS TO THE WTG TABLE                               * 00244102
*            R7 POINTS TO THE CURRENT PARAMETER LIST ENTRY            * 00244502
*            R8 POINTS TO THE CURRENT WTG TABLE ENTRY                 * 00244602
*            R9 POINTS TO THE DD ENTRY IN THE TIOT                    * 00244702
*            R10 POINTS TO THE UCB                                    * 00245102
*                                                                     * 00245402
*    PATCH LABEL = SEE NEXT TO LAST LABEL BEFORE ORG STATEMENT AT END * 00245602
*                  OF LISTING.                                        * 00245702
*                                                                     * 00245902
* MODULE TYPE = CONTROL (OPEN, CLOSE, EOV DATA MANAGEMENT)            * 00246002
*                                                                     * 00246102
*    PROCESSOR = ASSEMBLER XF                                         * 00246202
*                                                                     * 00246302
*    MODULE SIZE = SEE EXTERNAL SYMBOL DICTIONARY OR LOC FIELD ON     * 00246502
*                   ORG STATEMENT AT END OF LISTING                   * 00248502
*                                                                     * 00248902
*    ATTRIBUTES = REENTRANT, REFRESHABLE,READ-ONLY, ENABLED,          * 00249302
*                 PRIVILEGED, SUPERVISOR STATE, DATA MANAGEMENT KEY,  * 00249702
*                 LINK PACK AREA RESIDENT/PAGEABLE                    * 00249802
*                                                                     * 00249902
* ENTRY POINT = IFGO194F FROM OPEN                                    * 00250202
*               IFG0554F FROM END OF VOLUME                           * 00250302
*                                                                     * 00250402
*    PURPOSE = TO INSURE A SPECIFIED TAPE VOLUME IS MOUNTED AND       * 00250502
*              VERIFIED ON A SPECIFIED TAPE UNIT.                     * 00251802
*                                                                     * 00254502
*    LINKAGE = IECRES LOAD,MODID=ID4F,BRCODE=OFFSET,BRANCH=QUEUED     * 00255802
*                                                                     * 00257002
* INPUT = STANDARD OPEN/CLOSE/EOV WORKAREAS AND REGISTERS. DXVOLSR2   * 00258402
*         CONTAINS THE SERIAL NUMBER OF THE VOLUME REQUESTED.         * 00259302
*         DXUCBADR CONTAINS THE UCB ADDRESS OF THE UNIT THAT IS       * 00259502
*         TO CONTAIN THE REQUESTED VOLUME.                            * 00259902
*         DXVOLSR1 IF NOT ZERO CONTAINS THE SERIAL NUMBER OF THE      * 00260102
*         VOLUME TO BE DISMOUNTED FROM THE UNIT SPECIFIED BY          * 00260302
*         DXUCBADR BEFORE THE VOLUME SPECIFIED BY DXVOLSR2 CAN        * 00260402
*         BE ACCEPTED.                                                * 00260802
*                                                                     * 00261502
* OUTPUT = VOLUME SPECIFIED BY DXVOLSR2 IS MOUNTED AND VERIFIED       * 00261802
*          ON THE UNIT SPECIFIED BY DXUCBADR.                         * 00262002
*                                                                     * 00262302
* EXIT-NORMAL = IFG0194A LOOK AHEAD MOUNT NEXT VOLUME                 * 00263602
*               IFG0194J MESSAGE ROUTINE                              * 00264802
*               OMODVOL1 LABEL EDITOR ROUTINE                         * 00266202
*               EMODVOL1 LABEL EDITOR ROUTINE                         * 00266602
*                                                                     * 00267502
* EXIT-ERROR = IFG0190P ABEND INTERPRETATION AND RECOVERY             * 00268802
*                                                                     * 00270002
* EXTERNAL REFERENCES = AS FOLLOWS -                                  * 00271402
*                                                                     * 00272602
*    ROUTINES = IFG0194A,IFG0554A,IFG0194J,IFG0554J,IFG0193C,OMODVOL1,* 00274002
*               EMODVOL1,IFG0190P,IFG0550P.                           * 00274902
*                                                                     * 00275302
*    DATA AREAS = SEE PARAMETERS ON THE IECDSECS MACRO.               * 00276502
*                                                                     * 00277902
*    CONTROL BLOCKS = SEE PARAMETERS ON THE IECDSECS MACRO.           * 00279102
*                                                                     * 00280502
* TABLES = SEE XCTLTABL MACRO.                                        * 00281702
*          INTERNAL ABEND CODE TABLE FOR ISSUEING SEPARATE            * 00282802
*          ABENDS FROM OPEN & EOV FOR THE SAME ERRORS.                * 00282902
*                                                                     * 00283002
*                                                                     * 00283202
* MACROS = MODESET,EXCP,IECRES,DOM,XLATE,ENQ,DMABCOND,XCTLTABL,       * 00284302
*          IECDSECS,IECEQU,RACHECK.                                   * 00285432
*                                                                     * 00285602
* CHANGE ACTIVITY = SEE DELETIONS/CHANGES SECTION AFTER CSECT CARD.   * 00287032
*                                                                     * 00288202
*********************************************************************** 00289502
         EJECT                                                          00290902
         USING FORCORE,RCORE            WORK AREA                       00292102
         USING WTG,RWTG                 WHERE-TO-GO              Y02080 00292802
         USING WTGENTRY,RWTGC           RWTGC POINTS TO CURRENT  Y02134 00293502
         USING TIOENTRY,RTIOT           TIOT ENTRY                      00294202
         USING IHADCB,RDCB              DCB                             00294902
         USING USERPRML,RPARC           RPARC POINTS TO CURRENT  Y02134 00295602
         USING UCBOB,RUCB               UCB                             00297402
         BALR  RBASE,R0                 SET BASE REGISTER               00298402
         USING *,RBASE                                                  00299402
*                                                                       00300402
* BRANCH TABLE                                                   M0034  00301402
*                                                                M0034  00301602
         B     TMV00000(RET)            GO TO PROPER FUNCTION    M0034  00301802
TMV00000 EQU   *                        BRANCH TABLE ENTRIES     M0034  00302002
         B     TMV00050                 INITIAL COMMON FUNCTION  M0034  00302202
         B     TMV02000                 MOUNT/VERIFY             M0034  00302602
         B     TMV07620                 RETURN FROM WTOR FILE PR Y02134 00303502
         B     TMV19950                 RETURN FROM ERROR DISMNT Y02134 00304002
         B     TMV02010                 ENTRY FROM LABEL EDITOR  YM5781 00306002
         B     TMV07530                 RET FROM LBL ERR MSG   @ZA02881 00306237
*                                                                M0034  00307002
TMV00050 EQU   *                        ENTRY                    M0034  00307802
*                                                                Y02134 00311702
         MVC   DXDEBUCB+K1(K3),DXUCBADR+K1 MOVE UCB TO DEB       YM1472 00313702
*                                                                YM1472 00314602
REDERROR EQU   X'01'                    REDUCED ERROR RECOVERY   YM3925 00316602
         NI    DXDEBOFL,ALLBITS-REDERROR ZERO OUT RER BIT 7      Y02134 00319502
         TM    JFCBLTYP,JFCNL           TEST FOR NL TAPES SPEC   Y02134 00319702
         BZ    TMV00500                 BRANCH IF NOT NL TAPES   Y02134 00319902
         OI    DXDEBOFL,REDERROR        SET RER BIT 7            Y02134 00320502
         EJECT                                                          00320602
*                                                                Y02134 00320702
TMV00500 EQU   *                        NOT NL TAPES             Y02134 00321402
*                                                                Y02134 00325902
*****************************************************************Y02134 00326902
*                                                                Y02134 00330002
*        THE FOLLOWING CODE WILL BUILD THE DXDEBMOD FIELD        Y02134 00330602
*        TO SET THE DENSITY IN WHICH THE LABELS ARE TO BE        Y02134 00330802
*        WRITTEN AND TO INSURE COMPLETION OF THE JFCDEN FIELD    Y02134 00330902
*                                                                Y02134 00332002
*****************************************************************Y02134 00332202
*                                                                Y02134 00332402
         CLC   TMVEOV,WTGMODNM+K3       TEST FOR EOV             YM1472 00332802
         BNE   TMV00700                 BRANCH NOT EOV           YM1472 00333202
*                                                                YM1472 00333302
         CLI   DXDEBMOD,K0              DEN ALREADY SPECIFIED    YM1472 00333402
         BNZ   TMV01500                 BRANCH IF SPECIFIED      YM4647 00335502
         B     TMV00900                 BYPASS DCB MERGE         YM1472 00335602
*                                                                       00335937
TMV00700 EQU   *                        CHECK DCB DENSITY      @ZA08253 00336937
*                                                                YM1472 00338502
         TM    DCBMACRF,DCBMEXCP        IF ACC METH NOT EXCP     Y02134 00338602
         BZ    TMV00800                 GO TEST FOR DEN IN DCB   Y02134 00338902
*                                                                Y02134 00339202
         TM    DCBMCRF1,DEPEND          IF NO TAPE DEPEND FLDS   Y02134 00339502
         BZ    TMV00900                 GO FIND DEVICE TYPE      Y02134 00339802
*                                                                Y02134 00340102
TMV00800 EQU   *                        TEST IF DENSITY SPECIFD  Y02134 00340402
*                                                                Y02134 00340702
         CLI   DCBDEN,K0                IF NO DENSITY IN THE DCB Y02134 00341002
         BE    TMV00900                 GO FIND DEVICE TYPE      Y02134 00341302
*                                                                Y02134 00342302
         MVC   JFCDEN,DCBDEN            USE DCB DENSITY IF AVAIL Y02134 00343302
*                                                                Y02134 00344302
TMV00900 EQU   *                        DETERMINE DENSITY        YM1472 00344502
*                                                                Y02134 00344702
         CLI   JFCDEN,K0                DENSITY SPECIFIED        YM1472 00345102
         BZ    TMV01000                 BRANCH TO GET DEFAULT    YM1472 00345202
         CLI   JFCDEN,DCBD6250          CHECK FOR 6250 BPI       YM1472 00345402
         BE    TMV00910                 BRANCH IF 6250           YM1472 00345502
         CLI   JFCDEN,DCBD1600          CHECK FOR 1600 BPI       YM1472 00345602
         BE    TMV00920                 BRANCH IF 1600 BPI       YM1472 00345702
         CLI   JFCDEN,DCBD800           CHECK FOR 800 BPI        YM1472 00345902
         BE    TMV00930                 BRANCH IF 800 BPI        YM1472 00346002
*                                                                YM1472 00346802
         TM    UCBTBYT2,UCB2OPT0        TEST FOR 7-TRK           YM1472 00346902
         BO    TMV01080                 BRANCH IF 7-TRK          YM1472 00347702
         B     TMV01100                 BRANCH INVALID DENSITY   YM1472 00348402
         EJECT                                                          00348502
*                                                                Y02134 00348602
*****************************************************************Y02134 00348702
*                                                                Y02134 00348802
*        6250 BPI SPECIFIED                                      YM1472 00348902
*                                                                Y02134 00349002
*****************************************************************Y02134 00349102
*                                                                Y02134 00349202
TMV00910 EQU   *                        6250 BPI SPECIFIED       YM1472 00349302
*                                                                YM1472 00349702
         TM    UCBTBYT1,UCBD6250        UNIT CAPABLE OF 6250     YM1472 00349802
         BO    TMV01020                 BRANCH IF 6250 OK        YM1472 00350202
         B     TMV01100                 BRANCH, INVALID DENSITY  YM1472 00350302
*                                                                Y02134 00352402
*****************************************************************Y02134 00354402
*                                                                Y02134 00356402
*        1600 BPI SPECIFIED                                      YM1472 00358402
*                                                                Y02134 00360402
*****************************************************************Y02134 00362402
*                                                                Y02134 00364402
TMV00920 EQU   *                        1600 BPI SPECIFIED       YM1472 00366402
*                                                                YM1472 00368402
         TM    UCBTBYT2,UCBDUDN1+UCBDUDN2 DUAL DENSITY           YM1472 00370402
         BNZ   TMV01040                 BRANCH IF 1600 OK        YM5369 00372402
         TM    UCBTBYT1,UCBD1600        TEST FOR 1600 BPI        YM1472 00372802
         BO    TMV01040                 BRANCH IF 1600 OK        YM1472 00373202
         B     TMV01100                 BRANCH, INVALID DENSITY  YM1472 00374402
*                                                                Y02134 00376402
*****************************************************************Y02134 00378402
*                                                                Y02134 00380402
*        800 BPI SPECIFIED                                       YM1472 00382402
*                                                                Y02134 00384402
*****************************************************************Y02134 00386402
*                                                                Y02134 00386802
TMV00930 EQU   *                        800 BPI SPECIFIED        YM1472 00387202
*                                                                YM1472 00387602
         TM    UCBTBYT2,UCB2OPT0        TEST FOR 7-TRK           YM1472 00387702
         BO    TMV01080                 BRANCH IF 7-TRK          YM1472 00387802
         TM    UCBTBYT2,UCBDUDN1        DUAL DENSITY 800/1600    YM1472 00387902
         BO    TMV01060                 BRANCH IF  800 OK        YM1472 00388002
         TM    UCBTBYT1,UCBD1600+UCBD6250 1600 OR 6250           YM1472 00388102
         BZ    TMV01060                 BRANCH IF NEITHER 800 OK YM1472 00388302
         B     TMV01100                 BRANCH, INVALID DENSITY  YM1472 00388702
         EJECT                                                          00389002
*                                                                Y02134 00389102
*****************************************************************Y02134 00389202
*                                                                Y02134 00389302
*        DENSITY NOT SPECIFIED - GET DEFAULT DENSITY             YM1472 00389402
*                                                                Y02134 00389502
*****************************************************************Y02134 00389602
*                                                                Y02134 00389702
TMV01000 EQU   *                        GET DEFAULT DENSITY      YM1472 00389802
*                                                                YM1472 00390102
         TM    UCBTBYT2,UCB2OPT0        TEST FOR 7-TRK           YM1472 00390902
         BO    TMV01070                 BRANCH IF 7-TRK          YM1472 00391002
         TM    UCBTBYT1,UCBD6250        TEST FOR 6250 MAX        YM1472 00391102
         BO    TMV01010                 BRANCH IF 6250 OK        YM1472 00391502
         TM    UCBTBYT1,UCBD1600        TEST FOR 1600 MAX        YM1472 00391602
         BO    TMV01030                 BRANCH IF 1600 OK        YM1472 00391702
         B     TMV01050                 BRANCH ASSUME 800 MAX    YM1472 00391802
*                                                                YM1472 00392202
*****************************************************************Y02134 00392802
*                                                                Y02134 00393202
*        SET DENSITY AT 6250 BPI                                 YM1472 00393602
*                                                                Y02134 00394002
*****************************************************************Y02134 00394102
*                                                                Y02134 00394202
TMV01010 EQU   *                        6250 BPI                 YM1472 00394402
*                                                                YM1472 00394802
         MVI   JFCDEN,DCBD6250          SET JFCB AT 6250 BPI     YM1472 00395002
*                                                                YM1472 00395202
TMV01020 EQU   *                        MODESET AT 6250 BPI      YM1472 00395602
*                                                                YM1472 00395702
         MVI   DXDEBMOD,DCBD6250        6250 MODESET DENSITY     YM6514 00395802
         B     TMV01500                 BRANCH TO CONTINUE       YM1472 00396002
*                                                                YM1472 00396602
*****************************************************************Y02134 00396802
*                                                                Y02134 00397202
*        SET DENSITY AT 1600 BPI                                 YM1472 00397302
*                                                                Y02134 00397402
*****************************************************************Y02134 00397602
*                                                                Y02134 00398002
TMV01030 EQU   *                        1600 BPI                 YM1472 00398402
*                                                                YM1472 00398802
         MVI   JFCDEN,DCBD1600          SET JFCB AT 1600 BPI     YM1472 00398902
*                                                                YM1472 00399302
TMV01040 EQU   *                        MODESET AT 1600 BPI      YM1472 00399702
*                                                                YM1472 00400102
         MVI   DXDEBMOD,DCBD1600        1600 MODESET DENSITY     YM1472 00400502
         B     TMV01500                 BRANCH TO CONTINUE       YM1472 00400602
         EJECT                                                          00400702
*                                                                YM1472 00400802
*****************************************************************Y02134 00401102
*                                                                Y02134 00401502
*        SET DENSITY AT  800 BPI                                 YM1472 00401902
*                                                                Y02134 00402002
*****************************************************************Y02134 00402102
*                                                                Y02134 00402202
TMV01050 EQU   *                        0800 BPI                 YM1472 00403002
*                                                                YM1472 00405002
         MVI   JFCDEN,DCBD800           SET JFCB AT  800 BPI     YM1472 00405102
*                                                                YM1472 00405202
TMV01060 EQU   *                        MODESET AT  800 BPI      YM1472 00405302
*                                                                YM1472 00405602
         MVI   DXDEBMOD,DX800           0800 MODESET DENSITY     YM1472 00405702
         B     TMV01500                 BRANCH TO CONTINUE       YM1472 00405802
*                                                                YM1472 00406102
*****************************************************************Y02134 00406202
*                                                                Y02134 00406302
*        SET 7-TRK DEFAULT AT 800 BPI                            YM1472 00406602
*                                                                Y02134 00406702
*****************************************************************Y02134 00406802
*                                                                Y02134 00406902
TMV01070 EQU   *                        800 BPI - 7-TRK          YM1472 00407102
*                                                                YM1472 00407502
         MVI   JFCDEN,DCBD800           SET JFCB AT  800 BPI     YM1472 00407602
*                                                                YM1472 00407702
TMV01080 EQU   *                        MODESET AT JFCB DENSITY  YM1472 00407902
*                                                                YM1472 00408302
         MVC   DXDEBMOD,JFCDEN          GET USER SPEC DENSITY           00408402
*                                                                Y02134 00408602
         OI    DXDEBMOD,DCBTRTET        EVEN PARITY & TRANSLATOR        00409202
         B     TMV01500                 BRANCH TO CONTINUE       YM1472 00409302
*                                                                YM1472 00409602
*****************************************************************Y02134 00409702
*                                                                Y02134 00409802
*        INCOMPATIBLE DENSITY AND UNIT SPECIFIED                 YM1472 00410102
*                                                                Y02134 00410202
*****************************************************************Y02134 00410302
*                                                                Y02134 00410602
TMV01100 EQU   *                        INCOMPATIBLE DENSITY     YM1472 00410702
*                                                                YM1472 00410802
         BAL   RDEB,TMV02060            CHECK FOR DOM NEEDED   @ZA14560 00410937
         LA    R0,K1                    OPEN=413-24 EOV=NA       YM1472 00411002
         B     TMV19900                 BRANCH TO PROB DET       YM1472 00411402
*                                                                YM1472 00411602
         EJECT                                                          00411802
*                                                                Y02134 00412002
*****************************************************************Y02134 00412202
*                                                                       00412402
*   THIS SECTION WILL TEST IF THE ASCII OPTION WAS SYSGENED WHEN        00412602
*   THE USER SPECIFIED ASCII PROCESSING, OR 7-TRACK TAPE REQUEST        00413402
*                                                                       00414202
*****************************************************************Y02134 00415002
*                                                                       00415802
TMV01500 EQU   *                                                        00416602
         L     RC,UCBXTN                ADDRESS OF UCB EXTEN   @ZA19728 00417437
         MODESET EXTKEY=SUPR            UCB KEY                @ZA19728 00417537
         USING UCBMT,RC                                        @ZA19728 00417637
         MVC   UCBMS,JFCDEN            MOVE TAPE JFCDEN TO EXT @ZA19728 00417737
         DROP  RC                                              @ZA19728 00417837
         MODESET EXTKEY=DATAMGT         DATA MGT KEY           @ZA19728 00417937
*                                                              @ZA19728 00418037
         CLC   TMVEOV,WTGMODNM+K3       TEST FOR EOV           @ZA10004 00418137
         BE    TMV01550                 BRANCH EOV             @ZA10004 00418237
*                                                              @ZA10004 00418337
         CLC   DXVOLSR2,SCRTCH          CHECK FOR NON-SPECIFIC @ZA08253 00418437
         BNE   TMV01550                 BRANCH IF SPECIFIC REQ @ZA08253 00418537
*                                                              @ZA08253 00418637
         CLC   JFCBFLSQ,ONET            TEST IF FILE SEQ IS 1  @ZA08253 00418737
         BE    TMV01550                 BR IF EQUAL            @ZA08253 00418837
         BAL   RDEB,TMV02060            CHECK FOR DOM NEEDED   @ZA14560 00418937
         LA    R0,K12                   OPEN=413-34 EOV=NA     @ZA08253 00419037
         B     TMV19900                 BRANCH TO PROB DET     @ZA08253 00419137
*                                                              @ZA08253 00419237
TMV01550 EQU   *                                               @ZA08253 00419337
*                                                              @ZA08253 00419437
         TM    JFCBLTYP,JFCBAL          WAS AL REQUESTED         Y02134 00419537
         BO    TMV01600                 YES, GO TEST IF SYSGENED Y02134 00419637
         TM    JFCBLTYP,JFCNL           NO LABEL SPECIFIED       Y02134 00419802
         BNO   TMV02000                 NO, BRANCH               Y02134 00420602
         TM    JFCOPTCD,JFCBUL          OPT CODE Q SPECIFIED     Y02134 00421402
         BO    TMV01700                 YES, BRANCH              Y02134 00422202
         TM    DCBMACRF,DCBMEXCP        IS DCB FOR EXCP          Y02134 00423002
         BO    TMV02000                 YES, BRANCH              Y02134 00423802
         TM    DCBOPTCD,JFCBUL          OPT CODE Q IN DCB        Y02134 00424602
         BO    TMV01700                 YES, BRANCH              Y02134 00425402
         B     TMV02000                 NO, CONTINUE             Y02134 00426202
*                                                                Y02134 00427002
TMV01600 EQU   *                        TEST IF AL SYSGENED      Y02134 00427802
*                                                                Y02134 00428602
         OI    JFCOPTCD,JFCBUL          DEFAULT TO OPTCD = Q     Y02134 00429402
*                                                                Y02134 00430202
TMV01700 EQU   *                        OPT CODE Q IN DCB        Y02134 00431002
*                                                                Y02134 00441002
         L     R1,CVTPTR                LOAD ADDRESS OF CVT      Y02134 00457102
         TM    CVTOPTA-CVT(R1),CVTASCII WAS ASCII SYSGENED       YM1472 00482702
         BNZ   TMV01750                 CONTINUE               @ZA14560 00492737
         BAL   RDEB,TMV02060            CHECK FOR DOM NEEDED   @ZA14560 02492737
         LA    R0,K2                    OPEN=013-04 EOV=NA       Y02080 04492737
         LA    R1,K3                    SET ASCII CODE           Y02134 06492737
         B     TMV19910                 BRANCH TO GET ERR MSG  @ZA14560 08492737
*                                                                Y02134 10492737
TMV01750 EQU   *                                               @ZA14560 12492737
*                                                              @ZA14560 14492737
         TM    UCBTBYT2,UCB2OPT0        SEVEN TRACK TAPE         Y02134 16492737
         BNO   TMV02000                 CONTINUE               @ZA14560 18492737
         BAL   RDEB,TMV02060            CHECK FOR DOM NEEDED   @ZA14560 20492737
         LA    R0,K3                    OPEN=013-08 EOV=NA       Y02080 22492737
         LA    R1,K4                    SET ASCII CODE           Y02134 24492737
         B     TMV19910                 BRANCH TO GET ERR MSG  @ZA14560 26492737
         EJECT                                                          31584802
*                                                                YM1472 31585802
*****************************************************************YM1472 31586902
*                                                                YM1472 31587802
*        CHECK FOR MOUNT IN PROGRESS                             YM1472 31588102
*                                                                YM1472 31588502
*****************************************************************YM1472 31588602
*                                                                YM1472 31588702
TMV02000 EQU   *                        MOUNT VERIFY ENTRY              31588802
*                                                                       31592402
         L     RET,ADRACPRT             PROTECT CHECK ROUTINE  @ZA18506 31593332
         BALR  RD,RET                   TEST FOR VALID SPECIF- @ZA18506X31593632
                                        CATION OF PROTECT      @G32DSMI 31594032
         NI    JFCBMASK+K5,X'FF'-LBLERR2V-LBLERR-JFCDUAL RESET   YM2850 31596202
*                                       LABEL & DEN CONFLICTS    YM2850 31598202
*                                                                       31600002
         TM    UCBDMCT,UCBMOUNT         TEST MOUNT BIT                  31770002
         BNO   TMV05000                 BRANCH NO MOUNT PENDING  Y02134 31775002
         B     TMV02020                 BYPASS REJECT TURN OFF   YM5781 31780002
*                                                                YM1472 31795002
TMV02010 EQU   *                        CLEAR REJECT             YM5781 31795702
*                                                                YM5781 31795802
         XC    DXVOLSR1,DXVOLSR1        CLEAR REJECT             YM1472 31796002
*                                                                YM1472 31796202
TMV02020 EQU   *                        VERIFY OUTSTANDING MOUNT YM5781 31796402
*                                                                YM1472 31796602
         NI    DXRCFLAG,0               CLEAR RACF FLAG BYTE   @G32DSMI 31796732
         MODESET EXTKEY=SUPR            UCB/TIOT KEY             Y02082 31796932
         EJECT                                                          31816102
*****************************************************************YM7890 31818102
*                                                                YM7890 31818502
*        IF MOUNT PENDING AND UNIT NOT READY MEMORY MAY          YM7890 31818902
*        NOT BE SWAPPED OUT, BECAUSE IF OPERATOR CANCELS         YM7890 31819302
*        THE JOB, THE JOB WILL NOT TERMINATE UNTIL THE           YM7890 31819702
*        MOUNT IS SATISFIED.                                     YM7890 31819802
*                                                                YM7890 31819902
*****************************************************************YM7890 31820002
*                                                                YM7890 31830002
         TM    UCBFL1,UCBNOTRD          TEST IF READY            YM7890 31832002
         BZ    TMV02030                 BR READY- BYPASS NOSWAP@ZA10245 31834037
*                                                                YM7890 31836002
         CLC   DXVOLSR1,ZEROS           VOLUME TO REJECT?      @ZA20480 31836237
         BE    TMV02025                 NO, CONTINUE           @ZA20480 31836437
         LA    RDEB,TMV08000            SET UP TO REJ AFT DOM  @ZA20480 31836637
         B     TMV02060                 GO DOM MESSAGE FOR VOL @ZA20480 31836837
*                                       TO BE REJECTED         @ZA20480 31837037
TMV02025 EQU   *                                               @ZA20480 31837237
         SYSEVENT DONTSWAP              IN CASE OPERATOR CANCEL  YM7890 31838002
*                                                                YM7890 31838402
         SLL   R1,K24                   CLEAR HI 3 BYTES         YM7890 31838802
         LTR   R1,R1                    CHECK FOR ERROR          YM7890 31839202
         BNZ   TMV02030                 BRANCH IF ERROR        @ZA10245 31839637
*                                                                YM8511 31843202
         OI    DXATALL,DXATSWAP         SET RECOVERY INDICATOR   YM8511 31844202
*                                                                YM7890 31846802
         MVC   DXCCW1,REWIND            MOVE IN REWIND COMMAND   YM7890 31850402
         EXCP  DXIOB                    READ VOLUME LABEL        YM7890 31854002
*                                                                YM7890 31857602
         IECRES WAIT                    WAIT FOR READ TO FINISH  YM7890 31861202
*                                                                YM8511 31862202
         NI    DXATALL,ALLBITS-DXATSWAP RESET RECOVERY INDICATOR YM8511 31863202
*                                                                YM7890 31864802
         SYSEVENT OKSWAP                ALLOW SWAPOUT-UNIT READY YM7890 31868402
*                                                                YM7890 31872002
         MODESET EXTKEY=SUPR            UCB/TIOT KEY           @ZA10245 31875637
         XC    UCBVOLI,UCBVOLI          CLEAR VOL SERIAL       @ZA10245 31875837
         XC    UCBFSCT,UCBFSCT          CLEAR FILE COUNTERS    @ZA10245 31876037
         XC    UCBFSEQ,UCBFSEQ          CLEAR FILE SEQ COUNTERS@ZA10245 31876237
         NI    UCBWGT,ALLBITS-UCBREW    SET REWIND OFF         @ZA10245 31876437
         NI    UCBSTAB,ALLBITS-UCBBSTR  SET AL NOT MOUNTED     @ZA10245 31876637
         NI    UCBSTAT,ALLBITS-UCBDADI  SET SL NOT MOUNTED     @ZA10245 31876837
         NI    UCBTFL1,ALLBITS-UCBNLTP  SET NL NOT MOUNTED     @ZA10245 31877037
         NI    UCBTFL1,ALLBITS-UCBDQDSP RESET DEQ AT DISMOUNT  @ZA18506 31877137
         NI    UCBTFL1,ALLBITS-UCBNSLTP SET NSL NOT MOUNTED    @ZA10245 31877237
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY    @ZA10245 31877437
         LA    RDEB,TMV02100            LOAD BRANCH ADDRESS    @ZA14560 31877537
         B     TMV02060                 BRANCH TO VERIFY LABEL   YM7890 31877637
*                                                                YM7890 31877837
TMV02030 EQU   *                                                        31878037
*                                                                       31878237
         MODESET EXTKEY=SUPR            UCB/TIOT KEY           @ZA10245 31878437
         XC    UCBVOLI,UCBVOLI          CLEAR VOL SERIAL       @ZA10245 31878637
         XC    UCBFSCT,UCBFSCT          CLEAR FILE COUNTERS    @ZA10245 31878837
         XC    UCBFSEQ,UCBFSEQ          CLEAR FILE SEQ COUNTERS@ZA10245 31879037
         NI    UCBWGT,ALLBITS-UCBREW    SET REWIND OFF         @ZA10245 31879237
         NI    UCBSTAB,ALLBITS-UCBBSTR  SET AL NOT MOUNTED     @ZA10245 31879437
         NI    UCBSTAT,ALLBITS-UCBDADI  SET SL NOT MOUNTED     @ZA10245 31879637
         NI    UCBTFL1,ALLBITS-UCBNLTP  SET NL NOT MOUNTED     @ZA10245 31879837
         NI    UCBTFL1,ALLBITS-UCBNSLTP SET NSL NOT MOUNTED    @ZA10245 31880037
         NI    UCBTFL1,ALLBITS-UCBDQDSP RESET DEQ AT DISMOUNT  @ZA18506 31880137
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY    @ZA10245 31880237
*                                                                       31880437
TMV02040 EQU   *                        READ LABEL - UNIT READY  YM7890 31882802
*                                                                Y02134 31886402
         MVC   DXCCW1,REWIND            MOVE IN REWIND COMMAND   Y02134 31890002
         EXCP  DXIOB                                                    31895002
*                                                                Y02134 31900002
         IECRES WAIT                                                    31905002
         LA    RDEB,TMV02100            LOAD BRANCH ADDRESS    @ZA14560 31905137
         EJECT                                                          31905237
*                                                                YM7890 31905402
TMV02060 EQU   *                        VERIFY LABEL             YM7890 31905802
*                                                                Y02134 31906002
         MODESET EXTKEY=SUPR            UCB/TIOT KEY             Y02082 31906202
         NI    UCBDMCT,ALLBITS-UCBMOUNT RESET THE MOUNT BIT      Y02134 31908402
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY      Y02082 31908602
*                                                                Y02134 31908802
         TM    UCBSTAB,UCBBNUL          TEST FOR DOM REQUIRED    Y02134 31909002
         BCR   14,RDEB                  BRANCH IF NO DOM       @ZA14560 31909237
*                                                                Y02134 31909402
         XR    R0,R0                    CLEAR REG FOR CS INST    Y02134 31909602
         LM    RET,RF,UCBFSER           LOAD DOM IDS             Y02134 31909802
         MODESET EXTKEY=SUPR            UCB/TIOT KEY             Y02082 31910002
         CS    RET,R0,UCBFSER           ZERO CONTENTS IF VALID   Y02134 31910202
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY      Y02082 31910402
         BCR   7,RDEB                   BYPASS DOM IF INVALID    Y02134 31910637
*                                                                Y02134 31910802
         SRDL  RET,K8                   MOVE 2ND IDS TO RF       Y02134 31911002
         SRL   RF,K8                    RIGHT JUSTIFY 2ND IDS    Y02134 31911302
         STM   RET,RF,DXWORK1           SET UP DOM LIST          Y02134 31911602
*                                                                Y02134 31913202
         MVI   DXWORK2,LASTNTRY         SET UP FOR 2 ENTRIES     Y02134 31913502
         NC    DXWORK2+K1(K3),DXWORK2+K1 CHECK IF IDS PRESENT    Y02134 31913802
         BNZ   TMV02080                 BRANCH IF TWO IDS        Y02134 31914102
*                                                                Y02134 31914402
         MVI   DXWORK1,LASTNTRY         SET UP FOR 1 ENTRY       Y02134 31914802
         NC    DXWORK1+K1(K3),DXWORK1+K1 CHECK IF IDS PRESENT    Y02134 31915002
         BCR   8,RDEB                   BRANCH IF NO IDS         Y02134 31915237
*                                                                Y02134 31915602
TMV02080 EQU   *                        TWO IDS'S                Y02134 31915902
*                                                                Y02134 31916102
         DOM   MSGLIST=DXWORK1          DELETE MESSAGE           Y02134 31916202
         BR    RDEB                     CONTINUE               @ZA14560 31916337
         EJECT                                                          31916437
*                                                                Y02134 31916502
TMV02100 EQU   *                        NO IDS                   Y02134 31916802
*                                                                Y02134 31917102
         MODESET EXTKEY=SUPR            UCB/TIOT KEY             Y02082 31917402
*                                                                Y02134 31917702
         XC    UCBFSER,UCBFSER          CLEAR MSG IDS            Y02134 31918002
         NI    UCBSTAB,ALLBITS-UCBBNUL  CLEAR DOM FLAG           Y02134 31918302
*                                                                Y02134 31918602
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY      Y02082 31918902
*                                                                Y02134 31919202
         MVI   DXDCBDEB,K0              RESET IOS BITS         @ZA20457 31919537
         TM    DXECB,ECBNOERR           TEST FOR I/O ERROR       Y02134 31919737
         BO    TMV02300                 BRANCH IF NOT I/O ERROR  A47788 31919837
*                                                                Y02134 31919937
         TM    UCBEXTPT,UCBIVRR         TEST INTERVENTION REQ. @ZA20457 31920037
         BNO   TMV02200                 CONTINUE IF NOT        @ZA20457 31920137
         MVI   DXECB,K0                 CLEAR ECB              @ZA20457 31920437
*                                                              @ZA20457 31920637
         MODESET EXTKEY=SUPR            UCB/TIOT KEY           @ZA20457 31920737
*                                                              @ZA20457 31920837
         OI    UCBFLA,UCBNRY            SET NOT READY BIT      @ZA20457 31920937
*                                                                Y02134 31921037
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY      Y02082 31921137
*                                                                Y02134 31921237
         B     TMV08000                 REJECT VOLUME          @ZA20457 31921337
*                                                              @ZA20457 31921437
TMV02200 CLI   DXECB,X40+X04            TEST FOR CHANNEL PGM   @ZA20457 31921537
*                                       INTERCEPTED              A47788 31921637
         LA    R0,K4                    OPEN=413-08 EOV=637-2C   Y02134 31921737
         BNE   TMV19900                 BRANCH ON OTHER ERROR    A47788 31921837
*                                                                Y02134 31921937
         MVC   DXCCW1,REWIND            INSURE CCW FOR REW       A47788 31922037
*                                                                Y02134 31922137
         EXCP  DXIOB                    ISSUE REW                A47788 31922237
*                                                                Y02134 31922302
         IECRES WAIT                                             Y02134 31922502
*                                                                Y02134 31922702
         TM    DXECB,ECBNOERR           TEST FOR I/O ERROR       Y02134 31923002
         LA    R0,K4                    OPEN=413-08 EOV=637-2C   Y02134 31923102
         BNO   TMV19900                 BRANCH IF I/O ERROR      A47788 31923502
         EJECT                                                          31934402
*                                                                Y02134 31936202
TMV02300 EQU   *                        VERIFY TAPE              YM2850 31938002
*                                                                Y02134 31939802
         TM    JFCBLTYP,JFCBLP          BLP SPECIFIED            Y02134 31941602
         BO    TMV02330                 BRANCH IF BLP SPECIFIED  YM1472 31943402
*                                                                Y02134 31945202
*****************************************************************Y02134 31947002
*                                                                Y02134 31948802
*        TRY TO READ AN 80 CHARACTER LABEL                       Y02134 31950602
*                                                                Y02134 31952402
*****************************************************************Y02134 31954202
*                                                                Y02134 31956002
         XC    DXLBL,DXLBL              CLEAR LABEL AREA        SA54629 31957802
         XC    DXCCW1,DXCCW1            CLEAR CCW FOR READ      SA54629 31959602
         LA    RCORE,0(RCORE)           CLEAR HI-ORDER BYTE    @ZA12921 31960537
         ST    RCORE,DXCCW1             LABEL AREA ADDR IN CCW   Y02134 31961402
         OC    DXCCW1,READ              INITIALIZE FOR READ     SA54629 31963202
*                                                                Y02134 31965002
         EXCP  DXIOB                                             Y02134 31966802
*                                                                Y02134 31966902
         IECRES WAIT                                             Y02134 31976902
*                                                                Y02134 31993002
ERRORFLG EQU   X'3E'                    CHAN PROG/PROT/DATA/CTRL/IFCE   31995002
         TM    IOBSTAT1,ERRORFLG        TEST FOR CHAN PROG/PROT/DATA    31997102
*                                       CTRL/IFCE CHECK          Y02134 32007202
         LA    R0,K5                    OPEN=413-0C EOV=637-34   Y02080 32016702
         BNZ   TMV19900                 YES,ABEND IF ANY         Y02080 32017302
*                                                                Y02080 32027402
         TM    IOBSTAT0,IOERR           CK FOR UNIT CHECK        Y02080 32037502
         BZ    TMV02310                 BR IF NO                 Y02134 32047602
*                                                                Y02134 32057702
DATACHK  EQU   X'F7'                    DATA CHECK               YM3925 32067702
         TM    IOBSENSE,DATACHK         OTHER THAN DATA CHK      Y02134 32067802
         LA    R0,K6                    OPEN=613-0C EOV=637-34   Y02080 32077902
         BNZ   TMV19900                 YES,ABEND                Y02134 32078002
         TM    IOBSENS1,X01             NOT CAPABLE BIT SET     SA58696 32088002
         BZ    TMV02320                 BR TO ACCEPT NL TAPE    SA58696 32088202
         EJECT                                                          32088302
*                                                                YM1472 32088702
*****************************************************************YM1472 32088802
*                                                                YM1472 32088902
*        CANNOT DETERMINE TYPE OF VOLUME MOUNTED.                YM1472 32089102
*                                                                YM1472 32089202
*****************************************************************YM1472 32089302
*                                                                YM1472 32089402
         MODESET EXTKEY=SUPR            UCB KEY                 SA58696 32089602
         OI    UCBTFL1,UCBNLTP          SET NL INDICATOR        SA58696 32089702
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY     SA58696 32089802
*                                                                YM4647 32090202
         CLC   DXVOLSR1,ZEROS           CHECK FOR REJECT MTD VOL YM4647 32090602
         MVC   DXVOLSR1,ZEROS           CANNOT TELL WHATS MTD    YM2850 32090702
         BNZ   TMV08000                 BRANCH TO REJECT MTD VOL YM4647 32090802
*                                                              @G32DSMI 32090932
         L     RB,DXJSCBAD              LOAD JSCB ADDRESS      @G32DSMI 32091032
         USING IEZJSCB,RB               JSCB ADDRESSABILITY    @G32DSMI 32091132
         TM    JSCBSWT1,JSCBPASS        TEST IF RACF PROTECTION@G32DSMIX32091232
                                        SHOULD BE BYPASSED     @G32DSMI 32091332
         BO    TMV02305                 BRANCH IF BYPASS SET   @G32DSMI 32091432
*                                                              @G32DSMI 32091532
         L     RB,CVTPTR                LOAD CVT ADDRESS       @G32DSMI 32091632
         USING CVT,RB                   CVT ADDRESSABILITY     @G32DSMI 32091732
         L     RB,CVTRAC                LOAD RACF CVT ADDRESS  @G32DSMI 32091832
         LTR   RB,RB                    RACF ACTIVE            @G32DSMI 32091932
         BZ    TMV02305                 RACF NOT ACTIVE        @G32DSMI 32092032
         USING RCVT,RB                                         @G32DSMI 32092132
         TM    RCVTSTA1,RCVTTAPE        TEST FOR TAPE VOLUME   @G32DSMIX32092232
                                        PROTECTION OPTION      @G32DSMI 32092332
         BO    TMV08000                 BRANCH IF YES TO       @G32DSMIX32092432
                                        REJECT THE VOLUME      @G32DSMI 32092532
         DROP  RB                                              @G32DSMI 32092632
*                                                              @G32DSMI 32092732
TMV02305 EQU   *                        NO RACF PROTECTION     @G32DSMI 32092832
*                                                              @G32DSMI 32092932
         TM    JFCBLTYP,JFCNL+JFCNSL    TEST FOR NL OR NSL      SA58696 32093032
         BNZ   TMV04100                 BRANCH TO DESTROY LABEL  YM4647 32093132
         B     TMV02390                 BR TO CREATE LABEL      SA58696 32093232
         EJECT                                                          32093332
*                                                                YM4647 32093432
*****************************************************************YM4647 32094802
*                                                                YM4647 32096802
*        CHECK FOR SL OR AL MOUNTED                              YM4647 32098802
*                                                                YM4647 32100802
*****************************************************************YM4647 32102802
*                                                               SA54629 32104802
TMV02310 EQU   *                        NO UNIT CHECK            Y02134 32108202
*                                                                Y02134 32118302
         TM    IOBSTAT1,ERROROUT        CK FOR INCORRECT LENGTH SA54629 32128302
         BNO   TMV02315                 BRANCH TO CHECK SL       YM3161 32131702
*                                                               SA54629 32141802
         CLI   IOBCNT+K1,K0             CHECK IF RESIDUAL COUNT SA54629 32143702
         BNE   TMV02320                 LABL LESS THAN 80 BYTES SA54629 32145802
         B     TMV02317                 LABEL GREATER THAN 80   SA54629 32146702
*                                                               SA54629 32148602
TMV02315 EQU   *                        CHECK FOR SL LABEL      SA54629 32153602
*                                                               SA54629 32158602
         CLC   DXLBL(K4),VOL1           CHECK FOR STANDARD VOL1 SA54629 32189002
         BE    TMV04000                 BRANCH TO ACCEPT SL     SA54629 32199102
*                                                               SA54629 32201202
TMV02317 EQU   *                        CHECK FOR ASCII LABEL   SA54629 32201302
*                                                               SA54629 32201602
         CLC   DXLBL(K4),ANSIVOL1       ASCII VOLUME LABEL      SA54629 32203102
         BE    TMV03000                 BRANCH TO ACCEPT ASCII  SA54629 32205202
         EJECT                                                          32209102
*                                                                Y02134 32209202
*****************************************************************Y02134 32219302
*                                                                Y02134 32229402
*        NL OR NSL TAPE MOUNTED                                  Y02134 32239502
*                                                                Y02134 32249602
*****************************************************************Y02134 32259702
*                                                                Y02134 32269802
TMV02320 EQU   *                                                 Y02134 32279902
*                                                                Y02134 32290002
         TM    JFCBLTYP,JFCNSL          TEST FOR NSL SPECIFIED   Y02134 32300102
         BO    TMV02350                 BRANCH IF NSL SPECIFIED  Y02134 32310202
*                                                                Y02134 32320302
TMV02330 EQU   *                        BLP/NL SPECIFIED         YM1472 32325302
*                                                                YM1472 32330502
         MODESET EXTKEY=SUPR            UCB/TIOT KEY             Y02082 32330602
         OI    UCBTFL1,UCBNLTP          SET NL INDICATOR         Y02134 32340502
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY      Y02082 32350602
         B     TMV02360                 BRANCH AROUND NSL CODE   Y02134 32360702
*                                                                Y02134 32370802
TMV02350 EQU   *                        NSL SPECIFIED            Y02134 32380902
*                                                                Y02134 32391002
         MODESET EXTKEY=SUPR            UCB/TIOT KEY             Y02082 32401102
         OI    UCBTFL1,UCBNSLTP         SET NSL INDICATOR        Y02134 32411202
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY      Y02082 32421302
         EJECT                                                          32423302
*                                                                Y02134 32431402
TMV02360 EQU   *                        SKIPPED NSL CODE         Y02134 32441502
*                                                                Y02134 32451602
         MVI   DXECB,K0                 SET OFF I/O ERROR        YM3916 32453602
*                                                                YM4647 32455602
         CLC   DXVOLSR1,ZEROS           CHECK FOR REJECT MTD VOL YM4647 32457602
         BNZ   TMV07500                 BRANCH TO REJECT MTD VOL YM4647 32459602
*                                                                YM4647 32461602
         TM    JFCBLTYP,JFCNL+JFCNSL+JFCBLP TEST FOR NL,NSL,BLP  YM1472 32552602
         BNZ   TMV02400                 BRANCH IF NL OR NSL      Y02134 32562702
*                                                                Y02134 32572802
*****************************************************************Y02134 32582902
*                                                                Y02134 32593002
*        NL/NSL MOUNTED AND AL/SL REQUESTED                      Y02134 32603102
*                                                                Y02134 32613202
*****************************************************************Y02134 32623302
*                                                                Y02134 32633402
TMV02390 EQU   *                                                 Y02134 32643502
*                                                                Y02134 32653602
         OI    JFCBMASK+K5,LBLERR2V+JFCSLCRE SWITCH TO CREATE SL YM3840 32694002
         B     TMV07510                 BRANCH TO LABEL EDITOR   YM4611 32704102
*                                                                Y02134 32714202
*****************************************************************Y02134 32724302
*                                                                Y02134 32734402
*        NL/NSL MOUNTED AND NL/NSL REQUESTED                     Y02134 32744502
*                                                                Y02134 32754602
*****************************************************************Y02134 32764702
*                                                                Y02134 32774802
TMV02400 EQU   *                                                 Y02134 32784902
*                                                                Y02134 32795002
         MVC   DXVOLSR1,DXVOLSR2        SET UP FOR VOL VERIFY    Y02134 32805102
*                                                                Y02134 32815202
         CLC   DXVOLSR2,SCRTCH          CHECK IF NONSPECIFIC REQ Y02134 32825302
         BNE   TMV06000                 BRANCH, GET DISPOSITION  Y02134 32835402
*                                                                Y02134 32845502
         EJECT                                                          32865602
*                                                                Y02134 32865702
         XC    DXVOLSR1,DXVOLSR1        CLEAR FOR REJECT         YM4647 32867702
*                                                                YM4647 32869702
         TM    JFCBMASK+K5,K1           TEST IF LXXXYY GENERATED Y02134 32875802
         BO    TMV02650                 BRANCH IF ALREADY GEND  SA58025 32885902
*                                                                Y02134 32896002
*****************************************************************Y02134 32906102
*                                                                Y02134 32916202
*        GENERATE LXXXYY NUMBER FOR NON-SPECIFIC NL/NSL TAPE     Y02134 32926302
*        INCREMENT DATA SET SERIAL NUMBER IN THE CVT             Y02080 32936402
*                                                                Y02080 32946502
*****************************************************************Y02134 32956602
*                                                                Y02134 32966702
TMV02500 EQU   *                                                SA58025 32967002
         L     R1,CVTPTR                LOAD ADDRESS OF CVT      Y02134 32976802
         LA    RF,K1                    SET MODIFY VALUE         Y02080 32986902
         SLL   RF,K24-(K8*((CVTSNCTR+K1-CVT)-(((CVTSNCTR+K1-CVT)/K4)*K4)32997002
               )))                      SHIFT VALUE TO POSITION  Y02080 33007102
*                                       TO BE MODIFIED           Y02080 33017202
*                                                                Y02134 33027302
         L     R0,(((CVTSNCTR+K1-CVT)/4)*4)(R1) WORD CONTAINING  Y02134 33037402
*                                       BYTE TO BE MODIFIED      Y02134 33047502
TMV02600 EQU   *                        TRY AGAIN FOR CS         Y02080 33057602
*                                                                Y02134 33067702
         LR    RC,R0                    GET READY TO MODIFY      Y02080 33077802
         AR    RC,RF                    MODIFY IT                Y02080 33087902
*                                                                Y02134 33098002
         MODESET EXTKEY=SUPR            UCB/TIOT KEY             Y02082 33108102
*                                                                Y02134 33118202
         CS    R0,RC,(((CVTSNCTR+K1-CVT)/4)*4)(R1) UPDATE COUNT  Y02134 33128302
*                                                                Y02134 33138402
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY      Y02082 33148502
*                                                                Y02134 33158602
         BNE   TMV02600                 IF NO, DO IT AGAIN       Y02080 33168702
*                                       SHIFT SERIAL NO.         Y02080 33178802
         SRL   R0,K24-(K8*((CVTSNCTR+K1-CVT)-(((CVTSNCTR+K1-CVT)/K4)*K4)33188902
               )))                      SHIFT TO LOW 16 BITS     YM3925 33198902
         CVD   R0,DXWORK                CONVERT DATA SET NO.     Y02080 33199002
         MVI   DXVOLSR1,CHARL           MOVE L TO LABEL          Y02134 33209102
         UNPK  DXVOLSR1+K1(K3),DXWORK(K8) DATA SET NUMBER        YM3928 33219202
         MVZ   DXVOLSR1+K2(K4),DXVOLSR1+K1 SET PROPER SIGN BITS  Y02134 33229302
         B     TMV05500                 BRANCH TO ENQ ON SCRTCH  Y02134 33269702
*                                                               SA58025 33270002
TMV02650 EQU   *                        EOV PROCESSING          SA58025 33270302
*                                                                YM1472 33270502
         LA    RD,JFCBVOLS              POINTER TO VOLSERS      SA58025 33270702
         LA    RET,JFCBEXAD             PTR TO JFCB EXTENSION   SA58025 33270902
         LH    R1,DXVOLSEQ              GET VOLUME SEQ NO.      SA58025 33271202
         BCTR  R1,R0                    GET PREVIOUS VOLUME      YM3840 33271302
         LTR   R1,R1                    TEST FOR REJECT NUMBER   YM3840 33271402
         BNP   TMV02500                 BRANCH TO GEN NEW NUMBER YM3840 33271902
         CH    R1,VOL5                  IS VOLSER IN MAIN JFCB  SA58025 33274902
         BNH   TMV02690                 BR IF YES, IN MAIN      SA58025 33275402
         SH    R1,VOL5                  DECR FOR INDEXING       SA58025 33275902
*                                                                YM1472 33276402
TMV02670 EQU   *                        GET JFCB EXTENSION      SA58025 33276902
*                                                                YM1472 33277402
*        CHECK FOR EXTENSION ADDR = ZERO DONE IN 194A           SA58025 33277902
         IECRES LOCJFCB,(RET)           LOCATE JFCB EXTENSION   SA58025 33278402
         LA    RD,K4(,RET)              PTR TO VOLSERS          SA58025 33278902
         CH    R1,VOL15                 VOL SEQ < 15            SA58025 33279402
         BNH   TMV02690                 BR IF YES, IN THIS EXTN SA58025 33279902
         SH    R1,VOL15                 DECREMENT FOR INDEXING  SA58025 33280402
         B     TMV02670                 CHECK IF VOLSER IN NEXT SA58025 33280902
*                                                                YM1472 33281402
TMV02690 EQU   *                        VOL SER LOCATED         SA58025 33281902
*                                                                YM1472 33282402
         BCTR  R1,K0                    DECREMENT FOR INDEXING  SA58025 33282902
         MH    R1,VOL6                  OFFSET TO VOLSER        SA58025 33283702
         AR    RD,R1                    PTR TO VOLSERS          SA58025 33283902
         CLC   K4(K2,RD),CHAR99         DOES YY = 99            SA58025 33284402
         BE    TMV02500                 BR IF YES               SA58025 33284902
         PACK  DXWORK(K8),K4(K2,RD)     VOL SEQ TO DECIMAL       YM3928 33285402
         CVB   R1,DXWORK                LOAD BINARY VOL SEQ      YM3928 33285902
         LA    R1,K1(,R1)               INCREMENT BY ONE        SA58025 33286402
         MVC   DXVOLSR1,K0(RD)          JFCB VOL SER TO VOLSR1  SA58025 33286902
         CVD   R1,DXWORK                MAKE NUMBER DECIMAL     SA58025 33287402
         UNPK  DXVOLSR1+K4(K2),DXWORK(K8) MAKE PRINTABLE        SA58025 33287902
         OI    DXVOLSR1+K5,CHAR0        MASK OUT SIGN            YM3928 33288302
         B     TMV05500                 ENQ VOLSER               YM3840 33288402
         EJECT                                                          33288902
*                                                                Y02134 33289402
*****************************************************************Y02134 33289902
*                                                                Y02134 33300002
*        AL TAPE MOUNTED.                                        Y02134 33310102
*                                                                Y02134 33320202
*****************************************************************Y02134 33330302
*                                                                Y02134 33340402
TMV03000 EQU   *                                                 Y02134 33350502
*                                                                Y02134 33360602
         MODESET EXTKEY=SUPR            SET KEY TO UCB KEY       Y02134 33370702
*                                                                Y02134 33380802
         OI    UCBSTAB,UCBBSTR          INDICATE AL TAPE MOUNTED Y02080 33390902
*                                                                Y02134 33401002
         MODESET EXTKEY=DATAMGT         RESET KEY TO DATA MANGMT Y02134 33411102
*                                                                Y02134 33421202
         L     R1,CVTPTR                GET CVT ADDRESS          Y02134 33431302
         TM    CVTOPTA-CVT(R1),CVTASCII ASCII SYSGENED           Y02134 33441402
         BO    TMV03100                 YES, GO CONTINUE         M0034  33451502
*                                                                Y02134 33461602
*****************************************************************Y02134 33471602
*                                                                Y02134 33475002
*        DISMOUNT VOLUME IF AL MOUNTED AND NOT REQUESTED         Y02134 33478402
*        WHEN ASCII NOT SYSGENED                                 Y02134 33491902
*                                                                Y02134 33501902
*****************************************************************Y02134 33505302
*                                                                Y02134 33508702
         LA    R1,K3                    PASS MSG MODIFIER CHAR   M0034  33512102
*                                                                Y02134 33522202
         MVC   DXRETMOD,ID4F4F          RETURN ID TO SAVE AREA   Y02134 33532302
         MVI   DXRETCOD,K4              SET RETURN INDICATOR     Y02134 33542402
*                                                                Y02134 33552502
         IECRES LOAD,MODID=ID4F4J,BRCODE=K8,BRANCH=QUEUED        Y02134 33562602
         EJECT                                                          33572602
*                                                                Y02134 33572702
*****************************************************************Y02134 33582802
*                                                                Y02134 33592902
*        CONTINUE ASCII PROCESSING                               Y02134 33603002
*                                                                Y02134 33613102
*****************************************************************Y02134 33623202
*                                                                Y02134 33633302
TMV03100 EQU   *                                                 M0034  33643402
*                                                                Y02134 33653502
         LA    R0,K80                   LENGTH OF LABEL          Y02134 33663602
         LA    R1,DXLBL                 ADDRESS OF LABEL         Y02134 33673702
*                                                                Y02134 33683802
         XLATE (1),(0),TO=E             TRANSLATE TO EBCDIC      Y02134 33693902
*                                                                Y02134 33704002
         CLC   DXVOLSR1,VOLSERNO        SAME AS REJECT           YM4647 33706002
         BE    TMV07500                 BRANCH TO REJECT         YM4647 33708002
*                                                                YM4647 33710002
         MVC   DXVOLSR1,VOLSERNO        SETUP VOL SER FOR REJECT Y02134 33714102
*                                                                Y02134 34087802
*****************************************************************Y02134 34097902
*                                                                Y02134 34108002
*        AL TAPE MOUNTED, CHECK ACCESSABILITY.                   Y02134 34118102
*                                                                Y02134 34128202
*****************************************************************Y02134 34138302
*                                                                Y02134 34148402
         CLI   VOLSEC,BLANK             VOL ACCESSIBILITY BLANK  Y02134 34178702
         BE    TMV03200                 BRANCH TO VERIFY IF OK   YM3921 34188802
*                                                                Y02134 34198902
         TM    JFCBLTYP,JFCBAL          TEST FOR AL REQUEST      YM4647 34200902
         BNO   TMV03150                 BRANCH TO GET RIGHT VOL  YM4647 34202902
*                                                                YM4647 34204902
         CLC   DXVOLSR2,DXVOLSR1        RIGHT VOL MOUNTED        M0034  34209002
         LA    R0,K8                    OPEN=913-04 EOV=937-20   YM1238 34219002
         LA    R1,K1                    LOAD ASCII DISMOUNT CODE Y02134 34222402
         BE    TMV19910                 BRANCH IF RIGHT VOLUME   Y02134 34225802
*                                                                Y02134 34400902
TMV03150 EQU   *                        REJECT ASCII VOL         YM4647 34402902
*                                                                YM4647 34404902
         MVC   DXRETMOD,ID4F4F          RETURN ID TO SAVE AREA   Y02134 34411002
         MVI   DXRETCOD,K4              SET RETURN INDICATOR     Y02134 34421102
*                                                                Y02134 34431202
         IECRES LOAD,MODID=ID4F4J,BRCODE=K8,BRANCH=QUEUED        Y02134 34441302
         EJECT                                                          34441702
*                                                                YM4647 34443302
*****************************************************************YM4647 34443702
*                                                                YM4647 34444102
*        AL TAPE MOUNTED, CHECK LABEL TYPE REQUESTED             YM4647 34444502
*                                                                YM4647 34444902
*****************************************************************YM4647 34445002
*                                                                YM4647 34445102
TMV03200 EQU   *                        CHECK LABEL TYPE REQST   YM4647 34445202
*                                                                YM4647 34445902
         TM    JFCBLTYP,JFCBAL          TEST FOR AL REQUEST      YM4647 34446602
         BO    TMV03500                 BRANCH IF AL REQUEST     YM4647 34447302
*                                                                YM4647 34449302
TMV03300 EQU   *                        EDIT LABEL               YM4647 34451302
*                                                                YM4647 34453302
         TM    JFCBLTYP,JFCSL           STANDARD LABEL REQUESTED YM4647 34453702
         BNO   TMV03400                 BRANCH, NL/NSL REQST     YM4647 34454102
*                                                                YM4647 34454902
*****************************************************************YM4647 34455002
*                                                                YM4647 34455102
*        AL TAPE MOUNTED AND SL TAPE REQUESTED                   YM4647 34455202
*                                                                YM4647 34457202
*****************************************************************YM4647 34457602
*                                                                YM4647 34458002
TMV03350 EQU   *                                                 YM4647 34458402
*                                                                YM4647 34458802
         OI    JFCBMASK+K5,JFCSLDES+JFCSLCRE+LBLERR2V CREATE SL  YM3840 34458902
         B     TMV07510                 BRANCH TO LABEL EDITOR   YM4611 34459002
*                                                                YM4647 34459102
*****************************************************************YM4647 34459902
*                                                                YM4647 34460302
*        AL TAPE MOUNTED AND NL/NSL REQUESTED.                   YM4647 34460402
*                                                                YM4647 34460502
*****************************************************************YM4647 34460602
*                                                                YM4647 34460902
TMV03400 EQU   *                                                 YM4647 34461002
*                                                                YM4647 34461102
         OI    JFCBMASK+K5,JFCSLDES+LBLERR2V DESTROY AL          YM3840 34463102
         B     TMV07510                 BRANCH TO LABEL EDITOR   YM4611 34463502
         EJECT                                                          34463902
*                                                                Y02134 34465102
*****************************************************************Y02134 34467102
*                                                                Y02134 34471602
*        AL TAPE MOUNTED AND AL TAPE REQUESTED.                  Y02134 34481702
*                                                                Y02134 34491802
*****************************************************************Y02134 34501902
*                                                                Y02134 34512002
TMV03500 EQU   *                                                 Y02134 34522102
*                                                                Y02134 34532202
         CLC   DXVOLSR2,DXVOLSR1        RIGHT VOL MOUNTED        M0034  34542302
         BE    TMV06000                 BRANCH IF RIGHT VOLUME   Y02134 34552402
*                                                                Y02134 34562502
         CLC   DXVOLSR2,SCRTCH          IS THIS SCRATCH REQUEST  M0034  34572602
         BNE   TMV04060                 BRANCH TO EDIT VOLUME    Y02134 34582702
         B     TMV05500                 BRANCH TO ACCEPT SCRTCH  Y02134 34592802
         EJECT                                                          34602902
*                                                                Y02134 34613002
*****************************************************************Y02134 34623102
*                                                                Y02134 34633202
*        SL TAPE MOUNTED.                                        Y02134 34643302
*                                                                Y02134 34653402
*****************************************************************Y02134 34663502
*                                                                Y02134 34673602
TMV04000 EQU   *                                                 Y02134 34683702
*                                                                Y02134 34693802
         MODESET EXTKEY=SUPR            SET KEY TO UCB KEY       Y02134 34703902
*                                                                Y02134 34714002
         OI    UCBSTAT,UCBDADI          INDICATE SL TAPE MOUNTED Y02080 34724102
*                                                                Y02134 34734202
         MODESET EXTKEY=DATAMGT         RESET KEY TO DATA MANGMT Y02134 34744302
*                                                                Y02134 34754402
         CLC   DXVOLSR1,VOLSERNO        SAME AS REJECT           YM4647 34756402
         BE    TMV07500                 BRANCH TO REJECT         YM4647 34758402
*                                                                YM4647 34760402
         MVC   DXVOLSR1,VOLSERNO        SAVE VOL SER FOR REJECT  Y02134 34764502
*                                                                Y02134 34774602
         TM    JFCBLTYP,JFCSL           TEST FOR SL REQUEST      Y02134 34784702
         BO    TMV04200                 BRANCH TO ACCEPT VOLUME  Y02134 34794802
*                                                                Y02134 34804902
TMV04050 EQU   *                        EDIT LABEL               Y02134 34815002
*                                                                Y02134 34825102
         TM    JFCBLTYP,JFCBAL          TEST FOR AL REQUEST      Y02134 34835202
         BNO   TMV04100                 BRANCH, NL/NSL REQST     Y02134 34845302
         EJECT                                                          34847302
*                                                                Y02134 34855402
*****************************************************************Y02134 34865502
*                                                                Y02134 34875602
*        SL TAPE MOUNTED AND AL TAPE REQUESTED.                  Y02134 34885702
*                                                                Y02134 34895802
*****************************************************************Y02134 34905902
*                                                                Y02134 34916002
TMV04060 EQU   *                                                 Y02134 34926102
*                                                                Y02134 34936202
         OI    JFCBMASK+K5,JFCSLDES+JFCSLCRE+LBLERR2V CREATE AL  YM3840 34976602
         B     TMV07510                 BRANCH TO LABEL EDITOR   YM4611 34986702
*                                                                Y02134 34996802
*****************************************************************Y02134 35006902
*                                                                Y02134 35017002
*        SL TAPE MOUNTED AND NL/NSL TAPE REQUESTED.              Y02134 35027102
*                                                                Y02134 35037202
*****************************************************************Y02134 35047302
*                                                                Y02134 35057402
TMV04100 EQU   *                                                 Y02134 35067502
*                                                                Y02134 35077602
         OI    JFCBMASK+K5,JFCSLDES+LBLERR2V DESTROY SL          YM3840 35118002
         B     TMV07510                 BRANCH TO LABEL EDITOR   YM4611 35128102
*                                                                Y02134 35138202
*****************************************************************Y02134 35148302
*                                                                Y02134 35158402
*        SL TAPE MOUNTED AND SL TAPE REQUESTED.                  Y02134 35168502
*                                                                Y02134 35178602
*****************************************************************Y02134 35188702
*                                                                Y02134 35198802
TMV04200 EQU   *                                                 Y02134 35208902
*                                                                Y02134 35219002
         CLC   DXVOLSR2,DXVOLSR1        RIGHT VOL MOUNTED        M0034  35229102
         BE    TMV06000                 BRANCH IF RIGHT VOLUME   Y02134 35239202
*                                                                Y02134 35249302
         CLC   DXVOLSR2,SCRTCH          IS THIS SCRATCH REQUEST  M0034  35259402
         BNE   TMV03350                 BRANCH TO EDIT VOLUME    YM4647 35269502
         B     TMV05500                 BRANCH TO ACCEPT SCRTCH  Y02134 35279602
         EJECT                                                          35289702
*                                                                Y02134 35299802
*****************************************************************Y02134 35309902
*                                                                Y02134 35320002
*        VERIFY MOUNTED VOLUME                                   Y02134 35330102
*                                                                Y02134 35340202
*****************************************************************Y02134 35350302
*                                                                Y02134 35360402
TMV05000 EQU   *                        VOL ALREADY MOUNTED      YM2850 35370502
*                                                                Y02134 35380602
         TM    UCBFL1,UCBNOTRD          TEST IF UNIT READY       YM3916 35385602
         BO    TMV08000                 BRANCH IF NOT READY      YM3916 35387202
         MVI   DXDCBDEB,K12             SET IOS BITS           @ZA20457 35387437
*                                                                YM3916 35387602
         MVC   VOLSERNO,DXVOLSR1        SAVE VOLSER FOR DEQ      YM2850 35387902
         CLC   DXVOLSR1,ZEROS           CHECK IF NO REJECT       YM2850 35388302
         BNZ   TMV05010                 BRANCH IF REJECT VOLSER  YM2850 35388402
*                                                                YM2850 35388502
         MVC   VOLSERNO,UCBVOLI         SAVE VOLSER FOR DEQ      YM2850 35388602
         CLC   UCBVOLI,ZEROS            CHECK FOR PRE-MOUNT VOL  YM2850 35388702
         BZ    TMV05020                 BYPASS DEQ, NOTHING MTD  YM5781 35388902
*                                                                YM2850 35389002
TMV05010 EQU   *                        TEST FOR SCRTCH PREMOUNT YM2850 35389102
*                                                                YM2850 35389202
         L     RF,UCBEXTPT              LOAD EXTENSION PTR       YM2850 35389402
         TM    UCBFLP1-UCBCMEXT(RF),UCBNSRCH  TEST IF NON-SCRTCH YM2850 35389502
         BO    TMV05020                 BRANCH IF NONSCRTCH VOL  YM2850 35389702
*                                                                YM2850 35389802
* NOTE: VOLUME SHOULD BE NON-SCRTCH IF VOLSER SAME AS REQUEST    YM2850 35389902
*                                                                YM2850 35390002
         CLC   DXVOLSR2,VOLSERNO        CHECK IF MTD VOL = REQ   YM2850 35390802
         BE    TMV05020                 BYPASS DEQ IF THE SAME   YM2850 35390902
*                                                                YM2850 35391002
         MODESET EXTKEY=SUPR            CHANGE TO UCB KEY        YM2850 35391102
         XC    UCBVOLI,UCBVOLI          CLEAR FOR REVERIFY       YM2850 35391502
         MODESET EXTKEY=DATAMGT         RESET TO DM KEY          YM2850 35391902
*                                                                YM2850 35392002
         LA    RC,VOLSERNO              POINT TO VOLSER        @ZA13577 35392437
         BAL   RD,TMV07850              LINK TO DEQ ROUTINE      YM5781 35392502
*                                                                YM2850 35393202
TMV05020 EQU   *                        BYPASS DEQ               YM2850 35393302
*                                                                YM2850 35393402
         CLC   DXVOLSR1,ZEROS           TEST FOR VOLUME REJECT   YM2850 35393502
         BNZ   TMV07500                 BRANCH IF REJECT REQST   YM2850 35393602
*                                                                YM2850 35393702
         CLC   UCBVOLI,ZEROS            CHECK IF NOTHING VERIFIEDYM1472 35393802
         BE    TMV02010                 BRANCH TO VERIFY         YM1472 35394702
*                                                                YM1472 35395602
         MVC   DXVOLSR1,UCBVOLI         MOVE VOL SER FOR REJECT  YM1472 35415702
*                                                                YM3855 35420702
         TM    JFCBLTYP,JFCNSL          TEST FOR NSL SPECIFIED  ZA00706 35638102
         BNZ   TMV02010                 BRANCH IF NSL           ZA00706 35643102
*                                                               ZA00706 35657802
         TM    JFCBLTYP,JFCBLP          TEST IF BLP SPECIFIED   ZA00706 35657902
         BNO   TMV05060                 BRANCH IF NOT BLP       ZA00706 35658002
         TM    UCBTFL1,UCBNLTP          TEST FOR NL MOUNTED     ZA00706 35658102
         BNO   TMV02010                 REVERIFY BLP AND NOT NL ZA00706 35658602
         B     TMV05400                 BRANCH TO VERIFY VOLSER ZA00706 35659002
*                                                               ZA00706 35659702
TMV05060 EQU   *                        CHECK FOR SL            ZA00706 35660002
*                                                               ZA00706 35660302
         TM    UCBSTAT,UCBDADI          SL TAPE MOUNTED          A39784 35660602
         BNO   TMV05100                 NO, BRANCH               A39784 35660902
         TM    JFCBLTYP,JFCSL           SL SPECIFIED             A39784 35663402
         BO    TMV05400                 BRANCH TO VERIFY VOL SER Y02134 35673502
         B     TMV04050                 BRANCH TO EDIT LABEL     Y02134 35683602
*                                                                Y02134 35693702
TMV05100 EQU   *                        NO SL TAPE MOUNTED       A39784 35703802
*                                                                Y02134 35713902
         TM    UCBSTAB,UCBBSTR          ASCII TAPE MOUNTED       A39784 35724002
         BNO   TMV05200                 NO, BRANCH               A39784 35734002
         TM    JFCBLTYP,JFCBAL          ASCII SPECIFIED          A39784 35734102
         BO    TMV05400                 BRANCH TO VERIFY VOL SER Y02134 35754302
         B     TMV03300                 BRANCH TO EDIT LABEL     YM4647 35764402
*                                                                Y02134 35774502
TMV05200 EQU   *                        NO ASCII TAPE MOUNTED    A39784 35784602
*                                                                Y02134 35794702
         TM    UCBTFL1,UCBNLTP          NL TAPE MOUNTED          A39784 35804802
         BNO   TMV02010                 GO CHECK VOLUME          YM1472 35814902
         TM    JFCBLTYP,JFCNL           NL SPECIFIED             A39784 35825002
         BO    TMV05400                 BRANCH TO VERIFY VOL SER Y02134 35835102
         B     TMV02390                 BRANCH TO EDIT LABEL     Y02134 35865402
         EJECT                                                          35976402
*                                                                Y02134 35976502
*****************************************************************Y02134 35986602
*                                                                Y02134 35996702
*        MOUNTED VOLUME CONTAINS REQUESTED LABEL.                Y02134 36006802
*                                                                Y02134 36016902
*****************************************************************Y02134 36027002
*                                                                Y02134 36037102
TMV05400 EQU   *                                                 Y02134 36047202
*                                                                Y02134 36057302
         CLC   DXVOLSR2,DXVOLSR1        RIGHT VOL MOUNTED        M0034  36067402
         BE    TMV06000                 BRANCH IF RIGHT VOLUME   Y02134 36077502
*                                                                Y02134 36087602
         CLC   DXVOLSR2,SCRTCH          IS THIS SCRATCH REQUEST  M0034  36097702
         BE    TMV06000                 BRANCH TO ACCEPT SCRTCH  Y02134 36107802
*                                                                Y02134 36117902
TMV05450 EQU   *                        SET UP FOR LABEL EDITOR  YM1472 36123002
*                                                                YM1472 36127902
         TM    JFCBLTYP,JFCNL+JFCNSL    NL OR NSL SPECIFIED      Y02134 36134802
         BNZ   TMV04100                 BRANCH IF NL OR NSL      Y02134 36138102
         B     TMV04060                 BRANCH TO CREATE LABEL   Y02134 36148202
*                                                                Y02134 36158302
*****************************************************************Y02134 36168402
*                                                                Y02134 36178502
*        SCRATCH VOLUME MOUNTED WITH SERIAL IN DXVOLSR1          Y02134 36188602
*                                                                Y02134 36198702
*****************************************************************Y02134 36208802
*                                                                Y02134 36218902
TMV05500 EQU   *                        ENTRY FROM LABEL EDITOR  Y02134 36229002
*                                                                Y02134 36239102
         MVC   DXWORK1(K16),ENQLIST     INIT ENQ LIST            Y02134 36249202
         L     RF,DXJSCBAD              LOAD JSCB ADDRESS        Y02134 36259302
         L     R0,JSCBTCBP-IEZJSCB(,RF) INITIATOR TCB POINTER    Y02134 36269402
TMV05515 ENQ   (,DXVOLSR1),TCB=(0),RET=USE,MF=(E,DXWORK2),       YM2850X36279502
               RELATED=(SYSZVOLS,IFG0194F(TMV07855))             YM5781 36289602
*                                                                Y02134 36299702
         LTR   RF,RF                    VOLUME ALREADY IN USE    Y02134 36309802
         BZ    TMV06000                 BRANCH IF NO ERROR       Y02134 36319902
         B     TMV08000                 BRANCH TO REJECT         Y02134 36330002
         EJECT                                                          36340102
*                                                                Y02134 36350202
*****************************************************************Y02134 36360302
*                                                                Y02134 36370402
*        VOLUME MOUNTED ON UNIT - GET DISPOSITION                Y02134 36380502
*                                                                Y02134 36390602
*****************************************************************Y02134 36400702
*                                                                Y02134 36410802
TMV06000 EQU   *                                                 Y02134 36420902
*                                                                Y02134 36431002
         MODESET EXTKEY=SUPR            UCB/SETLOCK KEY          Y02082 36441102
*                                                                Y02134 36451202
         MVC   UCBVOLI,DXVOLSR1         VERIFIED VOL SER TO UCB  Y02134 36461302
*                                                                Y02134 36481502
         NI    UCBWGT,ALLBITS-UCBREW    CLEAR REWIND IND         YM1472 36483502
*                                                                       36485502
         TM    UCBSTAT,UCBRESV          TEST IF RESERVED        ZA01493 36487502
         BO    TMV06305                 BYPASS DISP IF RESVRVED ZA01493 36489502
*                                                                       36493502
         NI    UCBJBNR,ALLBITS-UCBMONT  SET PASS TO ZERO         Y02134 36495502
         NI    UCBSTAB,ALLBITS-UCBBPRV  SET PRIVATE TO ZERO      Y02134 36501702
         NI    UCBSTAB,ALLBITS-UCBBPUB  SET PUBLIC TO ZERO       Y02134 36511802
*                                                                Y02134 36521902
         L     RB,DXDSAB                CURRENT DSAB POINTER     Y02134 36532002
         TM    DSABFLG3-DSAB(RB),DSABPASS TEST FOR PASSED DATA   Y02134 36542102
         BNO   TMV06100                 BRANCH IF NOT PASSED     Y02134 36552202
*                                                                Y02134 36562302
         OI    UCBJBNR,UCBMONT          SET PASS INDICATOR       Y02134 36572402
*                                                                Y02134 36582502
TMV06100 EQU   *                        NOT PASSED               Y02134 36592602
*                                                                Y02134 36602702
         TM    TIOESTTA,TIOSDSP1        TEST FOR PRIVATE DATA    Y02134 36612802
         BNO   TMV06200                 BRANCH IF NOT PRIVATE    Y02134 36622902
*                                                                Y02134 36633002
         OI    UCBSTAB,UCBBPRV          SET PRIVATE INDICATOR    Y02134 36643102
*                                                                Y02134 36653202
TMV06200 EQU   *                        NOT PRIVATE              Y02134 36663302
*                                                                Y02134 36673402
         TM    TIOESTTA,TIOSDSP2        TEST FOR PUBLIC DATA     Y02134 36683502
         BNO   TMV06300                 BRANCH IF NOT PUBLIC     Y02134 36693602
*                                                                Y02134 36703702
         OI    UCBSTAB,UCBBPUB          SET PUBLIC INDICATOR     Y02134 36713802
*                                                                Y02134 36723902
TMV06300 EQU   *                        NOT PUBLIC               Y02134 36734002
*                                                                Y02134 36744102
         L     RF,UCBEXTPT              LOAD EXTENSION PTR       Y02146 36754202
         OI    UCBFLP1-UCBCMEXT(RF),UCBNSRCH SET TO NON-SCRTCH   Y02146 36774402
*                                                                       36784402
TMV06305 EQU   *                        CHECK FILE PROTECT      ZA01493 36794402
*                                                                Y02134 36794602
         MODESET EXTKEY=DATAMGT         DM KEY                   Y02082 36804702
         EJECT                                                          36806702
*                                                                Y02134 36814702
*****************************************************************Y02134 36818102
*                                                                Y02134 36820102
*        CHECK FILE PROTECT AND DENSITY FROM SENSE INFORMATION   YM1472 36820502
*                                                                Y02134 36820902
*****************************************************************Y02134 36821302
*                                                                Y02134 36821502
         CLC   UCBFSEQ,ZEROS            CHECK FOR JUST MOUNTED   YM1472 36827002
         BNZ   TMV06310                 BRANCH IF NOT            YM1472 36829002
         CLI   UCBTBYT4,UCB3400         TEST FOR 3400 DRIVE      YM1491 37636502
         BNE   TMV06310                 NO.  CONTINUE            YM1491 37681402
         L     RF,UCBEXTPT              LOAD UCB EXTENSION PTR   Y02146 37681902
         CLI   UCBSNSCT-UCBCMEXT(RF),K24 UNIT HAVE 24 SENSE BYTS Y02146 37726302
         BNE   TMV06310                 NO.  CONTINUE             99223 37771202
*                                                                 99223 37816102
         BAL   RD,TMV07700              GET SENSE INFO           YM1472 37818102
*                                                                 99223 37820102
         L     RC,UCBXTN                ADDRESS OF UCB EXTEN      99223 37861002
         MODESET EXTKEY=SUPR            UCB KEY                   99223 37905902
         USING UCBMT,RC                                           99223 37950802
         MVC   UCBCTD,DXCCW4+K15        MOVE UNIT ID TO UCB EXT  YM1472 37995702
         DROP  RC                                                 99223 38040602
         MODESET EXTKEY=DATAMGT         DATA MGT KEY              99223 38085502
*                                                                 99223 38130402
TMV06310 EQU   *                        CONTINUE                 YM1472 38175302
*                                                                Y02134 38220202
         CLI   DXCCW1,CCWSENSE          CHECK IF SENSE DONE    @ZA01337 38230202
         BE    TMV06315                 BRANCH IF SENSE DONE   @ZA01337 38240202
*                                                              @ZA01337 38250202
         BAL   RD,TMV07700              GET SENSE INFORMATION  @ZA01337 38260202
*                                                              @ZA01337 38262202
TMV06315 EQU   *                                               @ZA01337 38264202
         TM    DXDCBLST,X02             OUTPUT, OUTIN, INOUT     YM1472 38265102
         BZ    TMV06330                 NO, GO CHK FOR RACF    @G32DSMI 38310032
*                                                                YM1472 38310102
TMV06320 EQU   *                        CONTINUE                 YM1472 38311402
*                                                                Y02134 38311702
         BAL   RD,TMV07600              CHECK FILE PROTECT       Y02134 38312002
*                                                              @G32DSMI 38312232
TMV06330 EQU   *                        TEST LABEL             @G32DSMI 38312332
         TM    UCBSTAT,UCBDADI          TEST IF SL             @G32DSMI 38312532
         BO    TMV06340                 BRANCH IF SL           @G32DSMI 38312632
         TM    UCBSTAB,UCBBSTR          TEST IF AL             @G32DSMI 38312732
         BNO   TMV06350                 BRANCH IF NOT AL       @G32DSMI 38312832
*                                                              @G32DSMI 38312932
TMV06340 EQU   *                        RACF-PROTECTED VOLUMES @G32DSMIX38313032
                                        MUST BE SL OR AL       @G32DSMI 38313132
*                                                              @G32DSMI 38313232
         L     RB,DXJSCBAD              LOAD JSCB ADDRESS      @G32DSMI 38313332
         USING IEZJSCB,RB               JSCB ADDRESSABILITY    @G32DSMI 38313432
         TM    JSCBSWT1,JSCBPASS        TEST IF RACF PROTECTION@G32DSMIX38313532
                                        SHOULD BE BYPASSED     @G32DSMI 38313632
         BO    TMV06350                 BRANCH IF YES          @G32DSMI 38313732
*                                                              @G32DSMI 38313832
         L     RB,CVTPTR                LOAD CVT ADDRESS       @G32DSMI 38313932
         USING CVT,RB                   CVT ADDRESSABILITY     @G32DSMI 38314032
         L     RB,CVTRAC                LOAD RACF CVT ADDRESS  @G32DSMI 38314132
         LTR   RB,RB                    RACF ACTIVE            @G32DSMI 38314232
         BZ    TMV06350                 RACF NOT ACTIVE        @G32DSMI 38314332
         USING RCVT,RB                                         @G32DSMI 38314432
         TM    RCVTSTA1,RCVTTAPE        TEST FOR TAPE VOLUME   @G32DSMIX38314532
                                        PROTECTION OPTION      @G32DSMI 38314632
         BNO   TMV06350                 BRANCH IF NOT          @G32DSMI 38314732
         DROP  RB                                              @G32DSMI 38314832
*                                                              @G32DSMI 38314932
         TM    DXCCW4+K1,UCBPRTCT       TEST IF FILE-PROTECTED @G32DSMI 38315032
         BNO   TMV06345                 BRANCH IF NOT TO CALL  @G32DSMIX38315132
                                        RACHECK FOR OUTPUT     @G32DSMI 38315232
*                                                              @G32DSMI 38315332
         L     RF,ADRACIN               RACHECK INPUT ROUTINE  @ZA18506 38315432
         BALR  RD,RF                    RETURN ONLY IF OK      @ZA18506 38315532
*                                                              @G32DSMI 38315632
         B     TMV06350                 BRANCH TO CONTINUE     @G32DSMI 38315732
*                                                              @G32DSMI 38315832
TMV06345 EQU   *                        GO RACHECK FOR OUTPUT  @G32DSMI 38315932
*                                                              @G32DSMI 38316032
         L     RC,ADRACOUT              RACHECK OUTPUT ROUTINE @ZA18506 38316132
         BALR  RD,RC                    RETURN ONLY IF OK      @ZA18506 38316232
*                                                              @G32DSMI 38316332
         TM    DXDCBLST,X02             OUTPUT, OUTIN, INOUT   @G32DSMI 38316432
         BO    TMV06350                 BRANCH IF YES          @G32DSMI 38316532
*                                                              @G32DSMI 38316632
         TM    DXRCFLAG,DXRCOUT+DXRCINP TEST IF VOLUME IS      @G32DSMI*38316732
                                        NOT DEFINED TO RACF    @G32DSMI 38316832
         BZ    TMV06350                 BRANCH IF NOT DEFINED  @G32DSMI 38316932
*                                                              @G32DSMI 38317032
         TM    DXRCFLAG,DXRCOUT         TEST IF AUTHORIZED     @G32DSMIX38317132
                                        FOR UPDATE (OUTPUT)    @G32DSMI 38317232
         BO    TMV06350                 BRANCH IF YES          @G32DSMI 38317332
*                                                              @G32DSMI 38317432
         MVC   DXRETMOD,ID4F4F          RETURN TO IFG0194F     @G32DSMI 38317532
         MVI   DXRETCOD,K4              RETURN TO OFFSET 4     @G32DSMI 38317632
*                                                              @G32DSMI 38317732
         IECRES LOAD,MODID=ID4F4J,BRCODE=K72,BRANCH=QUEUED     @G32DSMIX38317832
                                        GO ISSUE MSG TO REMOVE @G32DSMIX38318232
                                        THE FILE-PROTECT RING  @G32DSMI 38318832
*                                                              @G32DSMI 38319432
TMV06350 EQU   *                        SET DEBSDSSI           @G32DSMI 38320032
         L     RD,DXDEBXAD              ADDR OF DEB EXTENSION  @G32DSMI 38320632
         USING DEBXTN,RD                                       @G32DSMI 38321232
         TM    DCBOFLGS,DCBOFEOV        CONCATENATION          @G32DSMI 38321832
         BZ    TMV06360                 NO - CHECK IF OPEN     @G32DSMI 38322432
         NI    DEBXFLG1,X'FF'-DEBXDSSI  TURN OFF FLAG          @G32DSMI 38323032
         TM    DXRCFLAG,DXRCINP+DXRCOUT RACF PROTECTED VOLUME  @G32DSMI 38323632
         BZ    TMV06380                 NO LEAVE FLAG OFF      @G32DSMI 38324232
         OI    DEBXFLG1,DEBXDSSI        VOL PROT - TURN OF FLG @G32DSMI 38324832
         B     TMV06380                 SKIP OPEN CHECK        @G32DSMI 38325432
TMV06360 EQU   *                        NOT CONCATENATION      @G32DSMI 38326032
         CLC   TMVEOV,WTGMODNM+K3       EOV                    @G32DSMI 38326632
         BZ    TMV06380                 EOV - LEAVE DEBXDSSI   @G32DSMI 38327232
         TM    DXRCFLAG,DXRCINP+DXRCOUT OPEN - CHECK IF RACF   @G32DSMI 38327832
         BZ    TMV06380                 NOT RACF - CONTINUE    @G32DSMI 38328432
         OI    DEBXFLG1,DEBXDSSI        OPEN & RACF VOL SET FLG@G32DSMI 38329032
TMV06380 EQU   *                                               @G32DSMI 38329632
         DROP  RD                                              @G32DSMI 38330232
         TM    JFCBLTYP,JFCBLP          TEST IF BLP SPECIFIED    YM1472 38332102
         BO    TMV07000                 RETURN IF BLP            YM1472 38341802
         EJECT                                                          38351502
*                                                                Y02134 38361202
*****************************************************************Y02134 38363602
*                                                                Y02134 38364002
*        VERIFY DENSITY OF VOLUME COMPATIBLE                     Y02134 38364102
*        WITH DENSITY SPECIFIED.                                 Y02134 38365702
*                                                                Y02134 38367802
*****************************************************************Y02134 38369402
*                                                                Y02134 38371002
*                                                                YM1472 38377802
         TM    UCBTBYT2,UCBDUDN1+UCBDUDN2 DUAL DENSITY           YM1472 38379802
         BZ    TMV07000                 BRANCH IF NOT DUAL DEN   YM1472 38381802
*                                                                YM1472 38383802
         TM    DXCCW4+K3,X04            VOL LABEL DEN = 1600 BPI YM1472 38395002
         BNO   TMV06400                 BRANCH IF NOT 1600 BPI   YM1472 38400002
         CLI   DXDEBMOD,DCBD1600        CHECK FOR 1600 BPI       YM1472 38405002
         BE    TMV07000                 IF YES, CONT NORM PROC   Y02134 38410002
         MVI   DXWORK,DCBD1600          SAVE JFCB DENSITY        YM1472 38412002
         MVI   DXWORK+K1,DCBD1600       SAVE MODESET DENSITY     YM1472 38414002
         B     TMV06600                 SET DENSITY CONFLICT     Y02134 38415002
*                                                                Y02134 38417002
TMV06400 EQU   *                        CHECK FOR 1600/6250 BPI  YM1472 38417402
*                                                                YM1472 38417802
         TM    UCBTBYT2,UCBDUDN2        DUAL DENSITY 1600/6250   YM1472 38417902
         BNO   TMV06500                 NO,MUST BE 800/1600 BPI  YM1472 38418202
*                                                                YM1472 38418302
*****************************************************************Y02134 38418402
*                                                                Y02134 38418502
*        LABEL DENSITY IS NOT 1600 BPI AND                       YM1472 38418802
*        CAPABILITY OF UNIT IS 1600/6250 BPI                     YM1472 38418902
*        THEREFORE THE TAPE MUST BE 6250 BPI DENSITY             YM1472 38419002
*                                                                YM1472 38419102
*****************************************************************Y02134 38419202
*                                                                Y02134 38419302
         CLI   DXDEBMOD,DCBD6250        CHECK FOR 6250 BPI       YM6514 38419402
         BE    TMV07000                 BRANCH IF 6250 BPI       YM1472 38419602
         MVI   DXWORK,DCBD6250          SAVE JFCB DENSITY        YM1472 38419902
         MVI   DXWORK+K1,DCBD6250       SAVE MODESET DENSITY     YM6514 38420002
         B     TMV06600                 SET DENSITY CONFLICT     Y02134 38420102
*                                                                Y02134 38420202
TMV06500 EQU   *                        CHECK FOR 0800/1600 BPI  YM1472 38420302
*                                                                YM1472 38420702
*****************************************************************Y02134 38420802
*                                                                YM1472 38421102
*        LABEL DENSITY IS NOT 1600 BPI AND                       YM1472 38421202
*        CAPABILITY OF UNIT IS 0800/1600 BPI                     YM1472 38421602
*        THEREFORE THE TAPE MUST BE 0800 BPI DENSITY             YM1472 38421702
*                                                                YM1472 38421802
*****************************************************************Y02134 38421902
*                                                                YM1472 38422002
         CLI   DXDEBMOD,DX800           CHECK FOR 800 BPI        YM1472 38422202
         BE    TMV07000                 BRANCH IF 800 BPI        YM1472 38422602
         MVI   DXWORK,DCBD800           SAVE JFCB DENSITY        YM1472 38425402
         MVI   DXWORK+K1,DX800          SAVE MODESET DENSITY     YM1472 38427402
*                                                                Y02134 38432002
TMV06600 EQU   *                        DENSITY CONFLICT         Y02134 38435002
         TM    DXDCBLST,DEBOPOIN        OUTPUT OR OUTIN        @ZA01337 38435402
         BNO   TMV06610                 BR IF NEITHER          @ZA01337 38435802
*                                                                Y02134 38437002
         TM    JFCBMASK+K5,JFCDUAL      PRIOR DUAL DENSITY CHK   Y02134 38440002
         BNO   TMV06700                 NO, BRANCH               Y02134 38445002
         CLC   TMVEOV,WTGMODNM+K3       CHECK FOR EOV            YM3813 38447002
         BE    TMV07000                 BRANCH IF EOV            YM3813 38449002
         CLC   JFCBFLSQ,ONET            FILE SEQ GREATER THAN 1  Y02134 38450002
         BNH   TMV07000                 NO, BRANCH               Y02134 38455002
TMV06610 EQU   *                                               @ZA01337 38457002
         MVC   JFCDEN,DXWORK            UPDATE DENSITY           YM1472 38460002
         MVC   DXDEBMOD(K1),DXWORK+K1   UPDATE MODESET FOR MSGS  YM1472 38462002
         B     TMV07000                 RETURN TO CALLER         Y02134 38465002
*                                                                Y02134 38467002
TMV06700 EQU   *                        CONTINUE DENSITY CONFLICTY02134 38470002
*                                                                Y02134 38472002
         OI    JFCBMASK+K5,JFCDUAL      SET DENSITY CONFLICT BIT Y02134 38475002
*                                                                Y02134 38496002
         BAL   RD,TMV07800              LINK TO DEQ VOL SER      YM5781 38500002
         B     TMV07550                 GO TO LABEL EDITOR       Y02134 38525002
         EJECT                                                          38575002
*                                                              @ZA18506 38615037
************************************************************** @ZA18506 38655037
*                                                              @ZA18506 38695037
*        CHECK FOR REQUEST TO DEQ VOLUME WHEN DISMOUNTED.      @ZA18506 38735037
*        IFG0194J WILL DEQ AT IEC502E MESSAGE.                 @ZA18506 38775037
*                                                              @ZA18506 38815037
************************************************************** @ZA18506 38855037
*                                                              @ZA18506 38895037
TMV09000 EQU   *                        CHECK DEQ AT DISMOUNT  @ZA18506 38935037
*                                                              @ZA18506 38975037
         TM    JFCBFLG3,JFCDQDSP        IS DEQ AT DISMOUNT     @ZA18506*39015037
                                        FACILITY REQUESTED     @ZA18506 39055037
         BZR   RD                       BRANCH IF NOT          @ZA18506 39095037
         CLC   TMVEOV,WTGMODNM+K3       TEST FOR EOV           @ZA18506 39135037
         BNE   TMV09100                 BRANCH IF OPEN         @ZA18506 39175037
         TM    DXDCBLST,X02             OUTPUT,INOUT,OUTIN     @ZA18506 39215037
         BZR   RD                       BRANCH IF INPUT/RDBACK @ZA18506 39255037
         TM    DCBOFLGS,DCBOFLWR        OUTPUT EOV DATASET     @ZA18506 39295037
         BZR   RD                       BRANCH IF INPUT        @ZA18506 39335037
         B     TMV09200                 TEST APF               @ZA18506 39375037
*                                                              @ZA18506 39415037
TMV09100 EQU   *                        OPEN                   @ZA18506 39455037
*                                                              @ZA18506 39495037
         TM    DXDCBLST,DEBOPOIN        OUTPUT OR OUTIN        @ZA18506 39535037
         BNOR  RD                       BRANCH IF IN/INOUT/RBK @ZA18506 39575037
*                                                              @ZA18506 39615037
TMV09200 EQU   *                        TEST APF               @ZA18506 39655037
*                                                              @ZA18506 39695037
         TESTAUTH FCTN=1                TEST APF AUTHORIZATION @ZA18506 39735037
         LTR   RF,RF                    ZERO RETURN IF APF     @ZA18506 39775037
         BNZR  RD                       BRANCH IF NOT APF AUTH @ZA18506 39815037
*                                                              @ZA18506 39855037
         MODESET EXTKEY=SUPR            UCB IN SUPERVISOR KEY  @ZA18506 39895037
         OI    UCBTFL1,UCBDQDSP         SET BIT TO CAUSE OPEN/ @ZA18506*39915037
                                        EOV TO DEQ VOLUME WHEN @ZA18506*39935037
                                        IT IS DISMOUNTED       @ZA18506 39955037
         MODESET EXTKEY=DATAMGT         RETURN TO DATAMGT KEY  @ZA18506 39975037
         BR    RD                       RETURN                 @ZA18506 40015037
         EJECT                                                          40055037
*                                                                Y02134 40400002
*****************************************************************Y02134 40405002
*                                                                Y02134 40410002
*        REWIND VOLUME IF ON FIRST FILE                          Y02134 40412002
*                                                                Y02134 40420002
*****************************************************************Y02134 40425002
*                                                                Y02134 40430002
TMV07000 EQU   *                                                 Y02134 40435002
*                                                              @ZA18506 40436037
         BAL   RD,TMV09000              CHECK DEQ AT DISMOUNT  @ZA18506 40437037
*                                                                Y02134 40440002
         CLC   UCBFSEQ,ONET             CHECK IF ON FIRST FILE @ZA15064 40472837
         BH    TMV07100                 BRANCH IF NOT ON FIRST @ZA15064 40473237
*                                                                Y02134 40473637
TMV07010 EQU   *                                               @ZA08328 40474037
         TM    JFCBLTYP,JFCBLTM         TEST FOR DOS TAPE      @ZA08328 40474437
         BNO   TMV07020                 BRANCH IF NO LEADING TM  YM4658 40475202
*                                                                YM4658 40476002
         TM    DXDCBLST,DEBOPOIN        TEST FOR OUTPUT OR OUTIN YM4658 40476802
         BO    TMV07020                 BRANCH IF OUTPUT         YM4658 40477602
*                                                                YM4658 40478402
         TM    IOBSTAT0,CSWUNITX        TEST FOR TM READ         YM4658 40479202
         BO    TMV07040                 BRANCH IF LEADING TM     YM4658 40480002
*                                                                YM4658 40481002
TMV07020 EQU   *                        REWIND TAPE              YM4658 40482502
*                                                                YM4658 40484002
         MVC   DXCCW1,REWIND            INSURE CCW FOR REW       A47788 40485502
         EXCP  DXIOB                    ISSUE REW                A47788 40487002
*                                                                Y02134 40488502
         IECRES WAIT                                             Y02134 40490002
*                                                                Y02134 40491502
         TM    DXECB,ECBNOERR           TEST FOR I/O ERROR       Y02134 40493002
         LA    R0,K9                    OPEN=413-08 EOV=137-18   Y02134 40494502
         BNO   TMV19900                 BRANCH IF ERROR          Y02134 40496002
*                                                                YM1219 40497502
TMV07040 EQU   *                        INITIALIZE UCB           YM4658 40499002
*                                                                YM4658 40500502
         MODESET EXTKEY=SUPR            UCB/TIOT KEY             YM1219 40502002
*                                                                YM1472 40503502
         MVC   UCBFSER,JFCBVOLS         MOVE IN FIRST VOL        YM1472 40505002
*                                                                YM1472 40506502
         CLC   TMVEOV,WTGMODNM+K3       CHECK FOR EOV            YM1472 40508002
         BE    TMV07100                 BRANCH IF EOV            YM1472 40509502
*                                                                YM1472 40511002
         MVC   UCBFSER,UCBVOLI          OPEN VOL SER             YM1472 40512502
         EJECT                                                          40514002
*                                                                YM1472 40515502
TMV07100 EQU   *                        SET DATA SET ON DEVICE   YM1472 40517002
*                                                                Y02134 40518502
         MODESET EXTKEY=SCHED           TIOT KEY                 YM1472 40520002
         OI    TIOESTTB,TIOSUSED                                 Y02134 40521502
         MODESET EXTKEY=DATAMGT         BACK TO KEY 5            Y02082 40523002
*                                                                YM1472 40524502
         XC    DXVOLSR1,DXVOLSR1        CLEAR VOL SER            YM1472 40526002
*                                                                YM4647 40527502
         TM    JFCBMASK+K5,LBLERR2V     TEST FOR LABEL CONFLICT  YM4647 40529002
         BNO   TMV07200                 BRANCH IF NONE           YM4647 40530502
         TM    JFCBLTYP,JFCNL+JFCNSL    TEST IF NL/NSL LBL CREAT YM4647 40532002
         BNZ   TMV07300                 BRANCH TO ISSUE ATTR MSG YM4647 40533502
*                                                                Y02134 40535002
*****************************************************************Y02134 40536502
*                                                                Y02134 40538002
*        RETURN TO IFG0194A TO LOOK AHEAD MOUNT NEXT VOLUME      Y02134 40539502
*                                                                Y02134 40541002
*****************************************************************Y02134 40542502
*                                                                Y02134 40544002
TMV07200 EQU   *                        GO TO LOOK AHEAD MOUNT   YM4647 40545502
*                                                                YM4647 40547002
         IECRES LOAD,MODID=ID4F4A,BRCODE=K12,BRANCH=QUEUED       Y02134 40548502
*                                                                YM4647 40550002
*****************************************************************YM4647 40551502
*                                                                YM4647 40553002
*        ISSUE TAPE ATTRIBUTE MESSAGE FOR NL OR NSL TAPES ONLY   YM4647 40554502
*        SL AND AL TAPES HANDLED LATER                           YM4647 40556002
*                                                                YM4647 40557502
*****************************************************************YM4647 40559002
*                                                                YM4647 40560502
TMV07300 EQU   *                        RETURN TO 4A AFTER MSG   YM4647 40562002
*                                                                YM4647 40563502
         MVC   DXRETMOD,ID4F4A          RETURN MOD NAME          YM4647 40565002
         MVI   DXRETCOD,K12             LOOK AHEAD MOUNT OFFSET  YM4647 40566502
*                                                                YM4647 40568002
         IECRES LOAD,MODID=ID4F4J,BRCODE=K48,BRANCH=QUEUED       YM4647 40569502
         EJECT                                                          40571002
*                                                                Y02134 40572502
*****************************************************************Y02134 40574002
*                                                                Y02134 40575502
*        EXIT TO LABEL EDITOR ROUTINE                            Y02134 40577002
*                                                                Y02134 40578502
*****************************************************************Y02134 40580002
*                                                                Y02134 40581502
TMV07500 EQU   *                                                 Y02134 40583002
*                                                                YM4611 40584502
         OI    JFCBMASK+K5,LBLERR2V+JFCSLDES DESTROY LABEL       YM4611 40586002
*                                                                YM4611 40587502
         TM    JFCBLTYP,JFCSL+JFCBAL    TEST FOR STD LABELS      YM4611 40589002
         BNO   TMV07510                 BRANCH IF NOT SL/AL      YM4611 40590502
*                                                                YM4611 40592002
         OI    JFCBMASK+K5,JFCSLCRE     CREATE LABEL             YM4611 40593502
*                                                                YM4611 40595002
*****************************************************************YM4611 40596502
*                                                                YM4611 40598002
*        CHECK IF OK TO EDIT LABEL                               YM4611 40599502
*                                                                YM4611 40601002
*****************************************************************YM4611 40602502
*                                                                YM4611 40604002
TMV07510 EQU   *                        OK TO EDIT LABEL?        YM4611 40605502
*                                                                YM4611 40607002
         TM    DXDCBLST,DEBOPOIN        TEST FOR OUTPUT OR OUTIN YM4611 40608502
         BNO   TMV08000                 BRANCH TO REJECT INPUT   YM4611 40610002
*                                                                YM4611 40611502
         CLC   DXVOLSR1,ZEROS           CHECK FOR NO VOL SER     YM2850 40613002
         BZ    TMV07520                 BRANCH IF NO VOL SER     YM2850 40614502
*                                                                YM5781 40616002
         CLC   DXVOLSR1,DXVOLSR2        MTD VOL = REQ VOL        YM5781 40617502
         BE    TMV07520                 BRANCH IF SAME VOL       YM5781 40619002
*                                                                YM2850 40620502
         MVC   DXWORK1(K16),ENQLIST     INIT ENQ LIST            YM4611 40622002
         L     RF,DXJSCBAD              LOAD JSCB ADDRESS        YM4611 40623502
         L     R0,JSCBTCBP-IEZJSCB(,RF) INITIATOR TCB POINTER    YM4611 40625002
         ENQ   (,DXVOLSR1),TCB=(0),RET=TEST,MF=(E,DXWORK2),      YM4611X40626502
               RELATED=(SYSZVOLS,IFG0194A(TMV00202))             YM4611 40628002
*                                                                YM4611 40629502
         LTR   RF,RF                    VOLUME ALREADY IN USE    YM4611 40631002
         BNZ   TMV08000                 BRANCH TO REJECT         YM4611 40632502
*                                                                Y02134 40634002
TMV07520 EQU   *                        ISSUE LBL ERR MSG      @ZA02881 40635537
         MVC   DXRETMOD,ID4F4F          RETURN MOD NAME        @ZA02881 40636537
         MVI   DXRETCOD,K20             RETURN OFFSET          @ZA02881 40636737
         IECRES LOAD,MODID=ID4F4J,BRCODE=K64,BRANCH=QUEUED     @ZA01881 40636937
TMV07530 EQU   *                        CHECK IF RING IN       @ZA02881 40637437
*                                                                YM2850 40638037
         BAL   RD,TMV07700              GET SENSE INFO           YM4647 40638502
         BAL   RD,TMV07605              CHECK FILE PROTECT       YM5950 40640002
*                                                                Y02134 40641502
TMV07550 EQU   *                        GO TO LABEL EDITOR       Y02134 40643002
*                                                                Y02134 40644502
         MVC   DXCCW1,REWIND            INSURE CCW FOR REW       A47788 40646002
         EXCP  DXIOB                    ISSUE REW                A47788 40647502
*                                                                Y02134 40649002
         IECRES WAIT                                             Y02134 40650502
*                                                                Y02134 40652002
         TM    DXECB,ECBNOERR           TEST FOR I/O ERROR       Y02134 40653502
         LA    R0,K9                    OPEN=413-08 EOV=137-18   Y02134 40655002
         BNO   TMV19900                 BRANCH IF ERROR          Y02134 40656502
*                                                                YM1219 40658002
         MVI   DXECB,K0                 ZERO I/O ERROR           YM3822 40659502
*                                                                YM3822 40661002
         MODESET EXTKEY=SUPR            UCB/TIOT KEY             Y02082 40662502
         XC    UCBFSEQ,UCBFSEQ          ZERO FILE SEQ NUMBER     Y02134 40664002
         XC    UCBFSCT,UCBFSCT          ZERO FILE SEQ COUNT      Y02134 40665502
         MODESET EXTKEY=DATAMGT         BACK TO KEY 5            Y02082 40667002
*                                                                YM1472 40668502
         IECRES SYNCHDCB                SYNCH BEFORE GOING       YM3117 40670002
*                                                                Y02134 40671502
         L     RPAR,WTGPREFX            POINT TO WTC BASE PREFIX Y02080 40673002
         L     RPAR,IECUPRML-IECPREFX(,RPAR) GET PARAMETER LIST  Y02080 40674502
         LR    RPARC,RPAR               POINT TO CURRENT ENTRY   Y02134 40676002
         LA    RWTGC,WTGENTRY-WTG(RWTG) INITIALIZE WTGENTRY PTR  YM1157 40677502
*                                                                YM3117 40679002
TMV07560 EQU   *                        LOOP, INDICATE OMOD/EMOD YM3117 40680502
*                                                                Y02134 40682002
         CLC   WTGIDTTR(K2),ID4F4F      CHECK FOR THIS MOD       YM3117 40683502
         BNE   TMV07570                 BRANCH IF NOT            YM3117 40685002
*                                                                YM3117 40686502
         MVC   WTGIDTTR,ID4F3C          MOVE LABEL EDITOR PTR    YM3117 40688002
*                                                                YM3117 40689502
TMV07570 EQU   *                        CHECK FOR LAST ENTRY     YM3117 40691002
*                                                                YM3117 40692502
         TM    DXDCBLST,LASTNTRY        CHECK FOR LAST ENTRY     YM3117 40694002
         LA    RPARC,DXDCBLST+L'DXDCBLST GET TO NEXT ENTRY       YM3117 40695502
         LA    RWTGC,WTGENTRY+L'WTGENTRY GET TO NEXT ENTRY       YM3117 40697002
         BNO   TMV07560                 LOOP IF MORE             YM3117 40698502
*                                                                YM3117 40700002
         LR    RPARC,RPAR               POINT TO FIRST ENTRY     YM3117 40701502
         LA    RWTGC,WTGENTRY-WTG(RWTG) INITIALIZE WTGENTRY PTR  YM3117 40703002
*                                                                YM3117 40704502
         MODESET EXTKEY=SUPR            KEY ZERO TO LABEL EDITOR YM1403 40706002
*                                                                Y02134 40707502
         CLC   TMVEOV,WTGMODNM+K3       TEST FOR EOV             YM1403 40709002
         BE    TMV07580                 BRANCH TO EMODVOL1       YM4611 40710502
*                                                                YM1403 40712002
         IECRES LOAD,MODNM=OMODVOL1,                             YM1403X40713502
               PREFIX=WTGPREFX,BRANCH=DIRECT                     YM1403 40715002
*                                                                YM1403 40716502
TMV07580 EQU   *                        GO TO EMODVOL1           YM4611 40718002
*                                                                YM1403 40719502
         IECRES LOAD,MODNM=EMODVOL1,                             YM1403X40721002
               PREFIX=WTGPREFX,BRANCH=DIRECT                     YM1403 40722502
         EJECT                                                          40724002
*                                                                Y02134 40725502
*****************************************************************Y02134 40727002
*                                                                Y02134 40728502
*        CHECK FOR FILE PROTECT                                  Y02134 40730002
*                                                                Y02134 40731502
*****************************************************************Y02134 40733002
*                                                                Y02134 40734502
TMV07600 EQU   *                                                 Y02134 40736002
*                                                                Y02134 40737502
         XR    RC,RC                    INIT TO PERFORM DEQ      YM5950 40739002
         B     TMV07607                 BYPASS DEQ OFF           YM5950 40740502
*                                                                YM5950 40742002
TMV07605 EQU   *                        BYPASS DEQ ENTRY         YM5950 40743502
*                                                                YM5950 40745002
         LA    RC,K4                    BYPASS DEQ SWITCH        YM5950 40746502
*                                                                YM5950 40748002
TMV07607 EQU   *                        CHECK FILE PROTECT       YM5950 40749502
*                                                                YM5950 40751002
         TM    DXCCW4+K1,UCBPRTCT       FILE PROTECTED           Y02134 40752502
         BNO   TMV07630                 RETURN IF NOT            YM5950 40754002
         TM    0(RPARC),DEBOPOIN        TEST FOR OUTPUT OR OUTIN Y02134 40755502
         BNO   TMV07610                 BRANCH IF INOUT          Y02134 40757002
*                                                                Y02134 40758502
         B     TMV07608(RC)             0=DEQ 4=NOT DEQ          YM5950 40760002
TMV07608 BAL   RD,TMV07800              LINK TO DEQ VOL SER      YM5781 40761502
*                                                                YM5781 40763002
         MVC   DXRETMOD,ID4F4F          RETURN ID TO SAVE AREA   Y02134 40764502
         MVI   DXRETCOD,K4              SET RETURN INDICATOR     Y02134 40766002
*                                                                Y02134 40767502
         IECRES LOAD,MODID=ID4F4J,BRCODE=K24,BRANCH=QUEUED       Y02134 40769002
*                                                                Y02134 40770502
TMV07610 EQU   *                        INOUT                    Y02134 40772002
*                                                                Y02134 40773502
         XC    DXWORK1,DXWORK1          CLEAR REPLY AREA         Y02134 40775002
         LA    R1,DXWORK1               LOAD POINTER TO REPLY    Y02134 40776502
         LA    R0,K1                    LOAD LENGTH OF REPLY     Y02134 40778002
         SLL   R0,K24                   SHIFT TO HI BYTE         Y02134 40779502
         OR    R1,R0                    MOVE LENGTH TO REG 1     Y02134 40781002
*                                                                Y02134 40782502
         MVC   DXRETMOD,ID4F4F          RETURN ID TO SAVE AREA   Y02134 40784002
         MVI   DXRETCOD,K8              SET RETURN INDICATOR     Y02134 40785502
*                                                                Y02134 40787002
         IECRES LOAD,MODID=ID4F4J,BRCODE=K28,BRANCH=QUEUED       Y02134 40788502
*                                                                Y02134 40790002
TMV07620 EQU   *                        RETURN FROM WTOR         Y02134 40791502
*                                                                Y02134 40793002
         IECRES WAIT                    WAIT FOR REPLY           Y02134 40794502
*                                                                Y02134 40796002
         OI    DXWORK1,BLANK            FOLD REPLY               Y02134 40797502
         CLI   DXWORK1,CHARF            CHECK IF UNLOAD SPECIFD  Y02134 40799002
         BE    TMV07640(RC)             BRANCH TO DEQ & REJECT   Y02134 40800502
*                                                                Y02134 40802002
         CLI   DXWORK1,CHARU            CHECK FOR OK TO USE      Y02134 40803502
         BNE   TMV07610                 BRANCH TO ASK AGAIN      Y02134 40805002
*                                                                Y02134 40806502
TMV07630 EQU   *                        RETURN-NOT FILE PROT     YM5950 40808002
*                                                                Y02134 40809502
         BR    RD                       RETURN                   Y02134 40811002
*                                                                YM5950 40812502
TMV07640 EQU   *                        DEQ AND REJECT           YM5950 40814002
*                                                                YM5950 40815502
         BAL   RD,TMV07800              LINK TO DEQ ROUTINE      YM5950 40817002
         B     TMV08000                 BRANCH TO REJECT         YM7311 40818502
         EJECT                                                          40820002
*                                                                Y02134 40821502
*****************************************************************Y02134 40823002
*                                                                Y02134 40824502
*        GET UNIT SENSE INFORMATION                              YM1472 40826002
*        SENSE INFORMATION BUFFER = DXCCW4 - DXCCW6              YM1472 40827502
*                                                                Y02134 40829002
*****************************************************************Y02134 40830502
*                                                                Y02134 40832002
TMV07700 EQU   *                                                 Y02134 40833502
*                                                                Y02134 40835002
         MVC   DXCCW1,NOP               WAIT FOR TAPE IN MOTION  YM4647 40836502
*                                                                YM4647 40838002
         EXCP  DXIOB                                             YM4647 40839502
*                                                                YM4647 40841002
         IECRES WAIT                                             YM4647 40842502
*                                                                YM4647 40844002
         MVI   DXDCBDEB,K0              RESET IOS BITS         @ZA32328 40845537
         TM    DXECB,ECBNOERR           CK FOR I/O ERROR         YM5781 40845937
         BO    TMV07745                 BRANCH IF NO ERROR     @ZA32328 40846337
         TM    UCBEXTPT,UCBIVRR         INTERVENTION REQUIRED? @ZA32328 40846737
         BNO   TMV07725                 NO ! BRANCH            @ZA32328 40847137
*                                                              @ZA32328 40847537
         MVI   DXECB,K0                 CLEAR ECB              @ZA32328 40847937
         MODESET EXTKEY=SUPR            UCB/TIOT KEY           @ZA32328 40848337
         OI    UCBFLA,UCBNRY            SET NOT READY BIT      @ZA32328 40848737
         MODESET EXTKEY=DATAMGT         DATAMANAGEMENT KEY     @ZA32328 40849137
         B     TMV08000                 REJECT VOLUME          @ZA32328 40849537
TMV07725 LA    R0,K11                   OPEN=413-08 EOV=637-44 @ZA32328 40849937
         B     TMV19900                 BRANCH ON OTHER ERROR  @ZA32328 40850337
*                                                                YM5781 40850737
TMV07745 XC    DXCCW1,DXCCW1            CLEAR CCW AREA         @ZA32328 40851137
         LA    R1,DXCCW4                LOAD SENSE BUFFER PTR    YM1472 40853002
         ST    R1,DXCCW1                STORE SENSE AREA IN CCW  Y02134 40854502
         OC    DXCCW1,SENSE             CMD, FLAGGS, AND LENGTH  YM1472 40856002
*                                                                Y02134 40857502
         EXCP  DXIOB                                             Y02134 40859002
*                                                                Y02134 40860502
         IECRES WAIT                                             Y02134 40862002
*                                                                Y02134 40863502
         TM    DXECB,ECBNOERR           CK FOR I/O ERROR         Y02134 40865002
         LA    R0,K11                   OPEN=413-08 EOV=637-44   Y02134 40866502
         BNO   TMV19900                 BRANCH IF ERROR          Y02134 40868002
*                                                                YM1472 40869502
         TM    JFCBLTYP,JFCBLP          TEST IF BLP SPECIFIED  @ZA06438 40870037
         BO    TMV07790                 YES, RETURN            @ZA08904 40870537
         TM    DXCCW4+K1,X08            TEST FOR LOAD POINT    @ZA02881 40871037
         BNO   TMV07790                 BRANCH IF NOT LOAD POINT YM1472 40872502
*                                                                YM1472 40874002
         MODESET EXTKEY=SUPR            UCB/TIOT KEY             Y02082 40875502
         XC    UCBFSCT,UCBFSCT          CLEAR FILE COUNTERS      Y02134 40877002
         XC    UCBFSEQ,UCBFSEQ          CLEAR FILE SEQ COUNTERS  Y02134 40878502
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY      Y02082 40880002
*                                                                YM1472 40881502
*        READ AWAY FROM LOAD POINT                               YM1472 40883002
*                                                                YM1472 40884502
         MVC   DXCCW1,FSR               FSR CCW                  YM5781 40886002
         EXCP  DXIOB                                             Y02134 40887502
*                                                                Y02134 40889002
         IECRES WAIT                    WAIT FOR CHAN END        YM1472 40890502
*                                                                Y02134 40892002
         TM    DXECB,ECBNOERR           CK FOR I/O ERROR         Y02134 40893502
         LA    R0,K11                   OPEN=413-08 EOV=637-44   Y02134 40895002
         BNO   TMV19900                 BRANCH IF ERROR          Y02134 40896502
*                                                                YM5781 40898002
         MVC   DXCCW1,NOP               WAIT FOR TAPE IN MOTION  YM5781 40899502
*                                                                YM5781 40901002
         EXCP  DXIOB                                             YM5781 40902502
*                                                                YM5781 40904002
         IECRES WAIT                                             YM5781 40905502
*                                                                YM5781 40913002
         XC    DXCCW1,DXCCW1            CLEAR CCW AREA           YM1472 40914502
         LA    R1,DXCCW4                LOAD SENSE BUFFER PTR    YM1472 40916002
         ST    R1,DXCCW1                STORE SENSE AREA IN CCW  Y02134 40917502
         OC    DXCCW1,SENSE             CMD, FLAGS, AND LENGTH   YM1472 40919002
*                                                                Y02134 40920502
         EXCP  DXIOB                                             Y02134 40922002
*                                                                Y02134 40923502
         IECRES WAIT                                             Y02134 40925002
*                                                                Y02134 40926502
         TM    DXECB,ECBNOERR           CK FOR I/O ERROR         Y02134 40928002
         LA    R0,K11                   OPEN=413-08 EOV=637-44   Y02134 40929502
         BNO   TMV19900                 BRANCH IF ERROR          Y02134 40931002
*                                                                YM1472 40932502
TMV07790 EQU   *                        RETURN                   YM1472 40934002
*                                                                YM1472 40935502
         BR    RD                       RETURN                   YM1472 40937002
         EJECT                                                          40938502
*                                                                       40940002
*********************************************************************** 40941502
*                                                                       40943002
*        DEQ VOLUME SERIAL NUMBER                                       40944502
*                                                                       40946002
*********************************************************************** 40947502
*                                                                       40949802
TMV07800 EQU   *                        FIND VOLSER TO DEQ       YM5781 40952102
*                                                                YM5781 40954402
         LA    RC,DXVOLSR1              POINT TO VOL SER       @ZA13577 40956732
         CLC   DXVOLSR1,ZEROS           CHECK IF VOL SER       @ZM04613 40957732
         BNE   TMV07810                 BRANCH TO DEQ            YM5781 40958732
*                                                                YM5781 40960732
         LA    RC,UCBVOLI               POINT TO UCB VOL SER   @ZA13577 40962732
         CLC   UCBVOLI,ZEROS            CHECK IF UCB HAS VOL SER YM5781 40968202
         BE    TMV07890                 RETURN IF NOT            YM5781 40970502
*                                                                YM5781 40972802
TMV07810 EQU   *                        CHECK FOR SCRATCH        YM5781 40975102
*                                                                YM5781 40977402
         CLC   DXVOLSR2,K0(RC)          CHECK IF SAME          @ZA13577 40979732
         BE    TMV07890                 RETURN IF SAME           YM5781 40982002
*                                                                YM5781 40984302
         CLC   DXVOLSR2,SCRTCH          CHECK FOR SCRATCH        YM5781 40986602
         BNE   TMV07890                 BRANCH IF NOT            YM5781 40988902
*                                                                YM5781 40991202
TMV07850 EQU   *                        DEQ ROUTINE              YM5781 40993502
*                                                                YM5781 40995802
         MODESET EXTKEY=SUPR            KEY OF UCB             @ZA18506 40996837
         NI    UCBTFL1,ALLBITS-UCBDQDSP RESET DEQ REQUEST      @ZA18506 40997137
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY    @ZA18506 40997437
         MVC   DXWORK1(K16),DEQLIST     INIT DEQ LIST            YM5728 40998102
         L     RF,DXJSCBAD              LOAD JSCB ADDRESS        YM5781 41000402
         L     R0,JSCBTCBP-IEZJSCB(,RF) INITIATOR TCB POINTER    YM5781 41002702
TMV07855 DEQ   (,(RC)),TCB=(0),MF=(E,DXWORK2),                 @ZA13577X41005032
               RELATED=(SYSZVOLS,IFG0194F(TMV05515))             YM5781 41007302
*                                                                YM5781 41009602
TMV07890 EQU   *                        RETURN                   YM5781 41011902
*                                                                YM5781 41014202
         BR    RD                       RETURN                   YM5781 41016502
         EJECT                                                          41018802
*                                                                Y02134 41021102
*****************************************************************Y02134 41023402
*                                                                Y02134 41025702
*        REJECT WRONG VOLUME MOUNTED.                            Y02134 41028002
*                                                                Y02134 41030302
*****************************************************************Y02134 41032602
*                                                                Y02134 41034902
TMV08000 EQU   *                                                 Y02134 41037202
*                                                                Y02134 41039502
         MVC   DXRETMOD,ID4F4F          RETURN ID TO SAVE AREA   Y02134 41041802
         MVI   DXRETCOD,K4              SET RETURN INDICATOR     Y02134 41044102
*                                                                Y02134 41046402
         IECRES LOAD,MODID=ID4F4J,BRCODE=K4,BRANCH=QUEUED        Y02134 41048702
         EJECT                                                          41051002
*                                                                Y02134 41051232
*****************************************************************Y02134 41051332
*                                                                Y02134 41051432
*        PROBLEM DETERMINATION INTERFACE                         Y02134 41051532
*                                                                Y02134 41051632
*****************************************************************Y02134 41051732
*                                                                Y02134 41051832
TMV19900 EQU   *                                                 Y02080 41051932
*                                                                Y02080 41052032
*****************************************************************Y02134 41052132
*                                                                Y02134 41052232
*        SET UP FOR REWIND UNLOAD AND MESSAGE                    Y02134 41052332
*                                                                Y02134 41052432
*****************************************************************Y02134 41052532
*                                                                Y02134 41052632
         XR    R1,R1                    CLEAR REG FOR DISMOUNT   Y02134 41052732
*                                                                Y02080 41052832
*****************************************************************Y02134 41052932
*                                                                Y02134 41053032
*        SET UP FOR AL REWIND UNLOAD AND MESSAGE                 Y02134 41053132
*                                                                Y02134 41053232
*****************************************************************Y02134 41053332
*                                                                Y02134 41053432
TMV19910 EQU   *                                                 Y02080 41053532
*                                                                Y02080 41053632
*****************************************************************Y02134 41053732
*                                                                Y02134 41053832
*        DETERMINE PROPER RETURN CODE FOR OPEN OR EOV            Y02134 41053932
*                                                                Y02134 41054032
*****************************************************************Y02134 41054132
*                                                                Y02134 41054232
         LA    RF,TMVERRFF              GET HIGHEST CODE NO.   @ZA00615 41054332
         CR    RF,R0                    CHECK IF CODE IS OK      Y02134 41054432
         BNL   TMV19930                 BRANCH IF OK             Y02080 41054532
         LA    R0,K0                    SET BAD CODE IN REG 0    Y02080 41054632
*                                                                Y02134 41054732
TMV19930 EQU   *                        ERROR CODE OK            Y02080 41054832
*                                                                Y02080 41054932
         LA    RF,TMVERR19              POINT TO OPEN CODES      Y02080 41055032
         CLC   TMVEOV,WTGMODNM+K3       CHECK FOR EOV CALL       Y02080 41055132
         BNE   TMV19940                 BRANCH IF OPEN           Y02080 41055232
         LA    RF,TMVERR55              POINT TO EOV  CODES      Y02080 41055332
*                                                                Y02134 41055432
TMV19940 EQU   *                        OPEN ERROR CODE          Y02080 41055532
*                                                                Y02080 41055632
         AR    RF,R0                    ADD ERROR OFFSET         Y02080 41055732
         IC    R0,K0(RF)                INSERT PROPER PD CODE    Y02080 41055832
*                                                                Y02080 41055932
*****************************************************************Y02134 41056032
*                                                                Y02134 41056132
*        DISMOUNT TAPE AND ISSUE MESSAGE                         Y02134 41056232
*                                                                Y02134 41056332
*****************************************************************Y02134 41056432
*                                                                Y02134 41056532
         MVI   DXRETCOD,K12             SET UP RETURN OFFSET     Y02080 41056632
         MVC   DXRETMOD,ID4F4F          SET UP RETURN MOD        Y02134 41056732
*                                                                Y02134 41056832
         IECRES LOAD,MODID=ID4F4J,BRCODE=K8,BRANCH=QUEUED        Y02080 41056932
*                                                                Y02134 41057032
*****************************************************************Y02134 41057132
*                                                                Y02134 41057232
*        AN ERROR HAS BEEN DETECTED                              Y02134 41057332
*        REG 0 CONTAINS PROPER PROBLEM DETERMINATION CODE        Y02134 41057432
*        THE UNIT HAS BEEN DISMOUNTED                            Y02134 41057532
*                                                                Y02080 41057632
*****************************************************************Y02134 41057732
*                                                                Y02134 41057832
TMV19950 EQU   *                        RETURN FROM ERROR DISMNT Y02080 41057932
*                                                                     * 41058032
         MVC   DXRETMOD,ID4F4A          SET UP RETURN MOD        Y02080 41058132
         LA    RET,K24                  SET UP RETURN OFFSET     Y02080 41058232
*                                                                Y02134 41058332
*        NOTE - 4A RETURN MODULE SAVED AT DXSAVMOD               Y02080 41058432
*                                                                Y02080 41058532
         DMABCOND (0),ID4F0P                                     Y02080 41058632
         EJECT                                                          41058732
*                                                                       41058832
*********************************************************************** 41058932
*                                                                       41059032
*        CONSTANTS                                                      41059132
*                                                                       41059232
*********************************************************************** 41059332
*                                                                       41059432
VOL5     DC    H'5'                     HW CONSTANT OF 5        SA58025 41059532
VOL6     DC    H'6'                     HW CONSTANT OF 6        SA58025 41059632
VOL15    DC    H'15'                    HW CONSTANT OF 15       SA58025 41059732
CHAR99   DC    CL2'99'                  CHARACTER 99 CONSTANT   SA58025 41059832
TMVEOV   DC    CL3'055'                 EOV SVC CODE IN WTG TBLE Y02134 41059932
CHARF    EQU   C'F'                     FILE PROTECT REPLY       Y02134 41060032
VOL1     DC    C'VOL1'                  STANDARD VOLUME LABEL ID        41060132
ANSIVOL1 DC    X'564F4C31'              CHARACTER 'VOL1' IN ASCII       41060232
ONET     DC    X'0001'                  CONSTANT OF 1                   41060332
*                                                                       41060432
REWIND   CCW   CCWREW,K0,CCWSILI,L'DXLBL REWIND CCW             SA54629 41060532
READ     CCW   CCWRDTAP,K0,K0,L'DXLBL   READ 80 CHAR LABEL      SA54629 41060632
SENSE    CCW   CCWSENSE,K0,CCWSILI,K24  24 BYTE SENSE INFO       YM1472 41060732
NOP      CCW   CCWNOP,K0,CCWSILI,K1     NOP FOR MOTION ERRORS    YM4647 41060832
FSR      CCW   X'37',K0,CCWSILI,L'DXLBL FORWARD SPACE RECORD CCW YM5781 41060932
*                                                                Y02134 41061032
ENQLIST  DC    A(0)                     ENQ LIST                 Y02134 41061132
         ENQ   (SYSZVOLS,,E,6,SYSTEM),TCB=,RET=USE,MF=L          Y02134 41061232
DEQLIST  DS    0F                       DEQ LIST                 YM5728 41061332
         DEQ   (SYSZVOLS,,6,SYSTEM),TCB=0,MF=L                   YM5728 41061432
SYSZVOLS DC    CL8'SYSZVOLS'            ENQ ARGUMENT             Y02134 41061532
SCRTCH   DC    CL6'SCRTCH'              NON-SPECIFIC REQUEST     Y02134 41061632
BLANKS   DC    CL6' '                   BLANK VOLUME SERIAL NO.  Y02134 41061732
ZEROS    DC    XL6'00'                  ZERO VOLUME SERIAL NO.   Y02134 41061832
ADRACIN  DC    A(TMV08100)              RACHECK INPUT          @ZA18506 41061932
ADRACOUT DC    A(TMV08200)              RACHECK OUTPUT         @ZA18506 41062032
ADRACPRT DC    A(TMV08300)              RACF PROTECT CHECK     @ZA18506 41062132
         EJECT                                                          41062232
*                                                                Y02080 41062332
TMVERR19 DC    AL1(0)                   OPEN ERROR CODES         Y02080 41062432
         DC    AL1(23)                  CODE 1 = 413-24          Y02080 41062532
         DC    AL1(17)                  CODE 2 = 013-04          Y02080 41062632
         DC    AL1(18)                  CODE 3 = 013-08          Y02080 41062732
         DC    AL1(2)                   CODE 4 = 413-08          Y02080 41062832
         DC    AL1(3)                   CODE 5 = 413-0C          Y02080 41062932
         DC    AL1(11)                  CODE 6 = 613-08        @ZA30793 41063032
         DC    AL1(2)                   CODE 7 = 413-08          Y02080 41063732
         DC    AL1(19)                  CODE 8 = 913-04          Y02134 41063832
         DC    AL1(2)                   CODE 9 = 413-08          Y02134 41063932
         DC    AL1(2)                   CODE 10 = 413-08         Y02134 41064032
         DC    AL1(2)                   CODE 11 = 413-08         Y02134 41064132
         DC    AL1(110)                 CODE 12 = 413-34       @ZA00615 41064232
         DC    AL1(141)                 CODE 13 = 913-38       @G32DSMI 41064332
         DC    AL1(0)                   CODE 14 = CANNOT OCCUR @G32DSMI 41064432
         DC    AL1(0)                   CODE 15 = CANNOT OCCUR @G32DSMI 41064532
         DC    AL1(247)                 CODE 16 = 913-48       @G32DSMI 41064632
         DC    AL1(249)                 CODE 17 = 913-50       @G32DSMI 41064732
         DC    AL1(250)                 CODE 18 = 913-54       @G32DSMI 41064832
         DC    AL1(251)                 CODE 19 = 913-58       @G32DSMI 41064932
         DC    AL1(252)                 CODE 20 = 913-5C       @G32DSMI 41065032
         DC    AL1(245)                 CODE 21 = 913-44       @G32DSMI 41065132
*                                                                Y02134 41065232
TMVERR55 DC    AL1(0)                   EOV  ERROR CODES         Y02080 41065332
         DC    AL1(0)                   CODE 1 = CANNOT OCCUR    Y02080 41065432
         DC    AL1(0)                   CODE 2 = CANNOT OCCUR    Y02080 41065532
         DC    AL1(0)                   CODE 3 = CANNOT OCCUR    Y02080 41065632
         DC    AL1(158)                 CODE 4 = 637-2C          Y02080 41065732
         DC    AL1(160)                 CODE 5 = 637-34          Y02080 41065832
         DC    AL1(160)                 CODE 6 = 637-34          Y02080 41065932
         DC    AL1(161)                 CODE 7 = 637-38          Y02080 41066032
         DC    AL1(249)                 CODE 8 = 937-20          YM1238 41066132
         DC    AL1(191)                 CODE 9 = 137-18          Y02134 41066232
         DC    AL1(155)                 CODE 10 = 637-24         Y02080 41066332
         DC    AL1(192)                 CODE 11 = 637-44         Y02080 41066432
         DC    AL1(0)                   CODE 12 = CANNOT OCCUR @ZA00615 41066532
         DC    AL1(1)                   CODE 13 = 937-28       @G32DSMI 41066632
         DC    AL1(6)                   CODE 14 = 937-3C       @G32DSMI 41066732
         DC    AL1(7)                   CODE 15 = 937-40       @G32DSMI 41066832
         DC    AL1(0)                   CODE 16 = CANNOT OCCUR @G32DSMI 41066932
         DC    AL1(0)                   CODE 17 = CANNOT OCCUR @G32DSMI 41067032
         DC    AL1(0)                   CODE 18 = CANNOT OCCUR @G32DSMI 41067132
         DC    AL1(0)                   CODE 19 = CANNOT OCCUR @G32DSMI 41067232
         DC    AL1(0)                   CODE 20 = CANNOT OCCUR @G32DSMI 41067332
         DC    AL1(0)                   CODE 21 = CANNOT OCCUR @G32DSMI 41067432
TMVERRFF EQU   TMVERR55-TMVERR19-1      HIGHEST CODE NO.       @ZA00615 41067532
         EJECT                                                          41067632
*                                                                       41067732
         XCTLTABL ID=(ID4F4F,4F,ID4F4A,4A,ID4F4J,4J,ID4F3C,3C,   Y02134X41067832
               ,OMODVOL1,,EMODVOL1,ID4F0P,0P),BRT=SHORT,       @ZA18506X41067932
               LENGTH=                                         @ZA18506 41068032
         EJECT                                                 @ZA18506 41068132
***************************************************************@ZA18506 41068232
*                                                              @ZA18506 41068332
*              PAGE TWO OF MODULE                              @ZA18506 41068432
*                                                              @ZA18506 41068532
***************************************************************@ZA18506 41068632
*                                                              @ZA18506 41068732
*                                                              @G32DSMI 41068832
***************************************************************@G32DSMI 41068932
*                                                              @G32DSMI 41069032
*        ISSUE RACHECK FOR OUTPUT                              @G32DSMI 41069132
*        TWO BASE REGISTERS USED-                              @ZA18506 41069232
*              RBASE FOR FIRST PAGE OF MODULE                  @ZA18506 41069332
*              RC FOR THIS SUBROUTINE                          @ZA18506 41069432
*                                                              @G32DSMI 41069532
***************************************************************@G32DSMI 41069632
*                                                              @G32DSMI 41069732
TMV08200 EQU   *                        RACHECK FOR OUTPUT     @G32DSMI 41069832
*                                                              @G32DSMI 41069932
         USING TMV08200,RC              BASE FOR SUBROUTINE    @ZA18506 41070032
         MVC   DXCCW5(RACULNTH),RACULIST  MOVE IN PARM LIST    @G32DSMI 41070132
         LA    RB,DXCCW5                ADDRESS OF PARM LIST   @G32DSMI 41070232
         USING ACHKLIST,RB                                     @G32DSMI 41070332
*                                                              @G32DSMI 41070432
         CLC   DXVOLSR2,SCRTCH          TEST IF NON-SPECIFIC   @G32DSMIX41070532
                                        VOLUME REQUEST         @G32DSMI 41070632
         BNE   TMV08210                 BRANCH IF SPECIFIC     @G32DSMI 41070732
         OI    ACHKFLG1,ACHKLOGF        NON-SPECIFIC LOG=NOFAIL@G32DSMI 41070832
TMV08210 EQU   *                                               @G32DSMI 41070932
         CLC   TMVEOV,WTGMODNM+K3       IS IT EOV              @G32DSMI 41071032
         BNE   TMV08220                 NO OPEN - ISSUE RACHECK@G32DSMI 41071132
         TM    DCBOFLGS,DCBOFEOV        CONCATENATION SPECIFIED@G32DSMI 41071232
         BO    TMV08220                 YES - TREAT LIKE OPEN  @G32DSMI 41071332
         TM    DXDCBLST,X02             INPUT                  @G32DSMI 41071432
         BZ    TMV08220                 YES - SKIP OLDVOL PARM @G32DSMI 41071532
         L     RF,DXDEBXAD              ADDRESS OF DEB EXTENSN @G32DSMI 41071632
         USING DEBXTN,RF                                       @G32DSMI 41071732
         TM    DEBXFLG1,DEBXDSSI        FIRST VOL RACF DEFINED @G32DSMI 41071832
         BZ    TMV08220                 NO - SKIP OLDVOL PARM  @G32DSMI 41071932
         DROP  RF                                              @G32DSMI 41072032
         LA    RF,DXOLDVOL              ADDR OF PREV VOLSER    @G32DSMI 41072132
         ST    RF,ACHKOVOL              SET IN PARM LIST       @G32DSMI 41072232
TMV08220 EQU   *                        ISSUE RACHECK          @G32DSMI 41072332
*                                                              @G32DSMI 41072432
         RACHECK ENTITY=UCBVOLI,MF=(E,DXCCW5)   ISSUE RACHECK  @G32DSMI 41072532
         LTR   RF,RF                    RC = 0 AUTHORIZED      @G32DSMI 41072632
         BNZ   TMV08250                 NOT RC=0               @G32DSMI 41072732
         CLC   TMVEOV,WTGMODNM+K3       IS IT EOV              @G32DSMI 41072832
         BNE   TMV08230                 NO - OPEN - CHECK PROT @G32DSMI 41072932
         L     RB,DXDEBXAD              ADDRESS OF DEB EXT     @G32DSMI 41073032
         USING DEBXTN,RB                                       @G32DSMI 41073132
         TM    DEBXFLG1,DEBXDSSI        FIRST VOL RACF DEFINED @G32DSMI 41073232
         BO    TMV08230                 YES - CHECK PROTECT    @G32DSMI 41073332
         DROP  RB                                              @G32DSMI 41073432
         TM    DCBOFLGS,DCBOFEOV        CONCATENATION SPECIFIED@G32DSMI 41073532
         BO    TMV08230                 YES - CHECK PROTECT    @G32DSMI 41073632
         TM    DXDCBLST,X02             CHECK OF INPUT         @G32DSMI 41073732
         BZ    TMV08230                 YES - CHECK PROTECT    @G32DSMI 41073832
*                                                                       41073932
*        THE FIRST VOLUME WAS NOT RACF DEFINED AND THIS ONE IS.         41074032
*        IT IS NOT INPUT, CONCATENATION OR OPEN.                        41074132
*        THIS MEANS THERE IS AN INCONSISTENCY BETWEEN THE FIRST         41074232
*        VOLUME AND THIS ONE. SET UP TO CAUSE A 937-3C ABEND AND        41074332
*        GO CHECK IF THIS WAS A SPECIFIC REQUEST.                       41074432
*                                                                       41074532
         LA    R0,K14                   SEE TMVER55            @G32DSMI 41074632
         B     TMV08290                 ABEND IF SPECIFIC REQ  @G32DSMI 41074732
TMV08230 EQU   *                        TEST IF PROTECT REQUEST@G32DSMI 41074832
         TM    JFCFLGS1,JFCBPROT        WAS PROTECT SPECIFIED  @G32DSMI 41074932
         BZ    TMV08240                 NO - AUTHORIZED RETURN @G32DSMI 41075032
         LA    R0,K21                   SET FOR 913-44         @G32DSMI 41075132
         B     TMV08290                 ABEND IF SPECIFIC REQ  @G32DSMI 41075232
TMV08240 EQU   *                        AUTHORIZED RC = 0      @G32DSMI 41075332
         OI    DXRCFLAG,DXRCOUT         SET AUTHORIZED FOR OUT @G32DSMI 41075432
         BR    RD                       RETURN TO MAIN LINE    @G32DSMI 41075532
TMV08250 EQU   *                        RC NOT EQUAL TO ZERO   @G32DSMI 41075632
         LA    RB,K12                   CHECK FOR RC = 12      @G32DSMI 41075732
         CR    RF,RB                    OLDVOL NOT IN SAME GRP @G32DSMI 41075832
         BNE   TMV08260                 RC NOT 0 OR 12         @G32DSMI 41075932
         LA    R0,K15                   SET FOR 937-40         @G32DSMI 41076032
         B     TMV08290                 ABEND IF SPECIFIC REQ  @G32DSMI 41076132
TMV08260 EQU   *                        RC NOT 0 OR 12         @G32DSMI 41076232
         LA    RB,K4                    RC FOUR                @G32DSMI 41076332
         CR    RF,RB                    RC = 4 - NOT DEFINED   @G32DSMI 41076432
         BER   RD                       YES - RETURN           @G32DSMI 41076532
*                                                                       41076632
*        IF HERE THE RETURN CODE WAS 8 - NOT AUTHORIZED                 41076732
*                                                                       41076832
         TM    DXDCBLST,X02             SEE IF INPUT           @G32DSMI 41076932
         BNZ   TMV08270                 NOT INPUT              @G32DSMI 41077032
         L     RF,ADRACIN               RACHECK INPUT ROUTINE  @ZA18506 41077132
         LR    RC,RD                    SAVE RETURN ADDRESS    @G32DSMI 41077232
         DROP  RC                       RC BASE NOT NEEDED     @ZA18506 41077332
         BALR  RD,RF                    RACHECK FOR INPUT,     @ZA18506*41077432
                                        RETURN ONLY IF OK      @ZA18506 41077532
         LR    RD,RC                    RESTORE RETURN ADDRESS @G32DSMI 41077632
         BR    RD                       RETURN TO CALLER       @G32DSMI 41077732
TMV08270 EQU   *                        NOT AUTHORIZED AND OUT @G32DSMI 41077832
         USING TMV08200,RC              RC STILL BASE          @ZA18506 41077932
         LA    R0,K13                   913-38 OR 937-28       @G32DSMI 41078032
*                                                                       41078132
*        IF THE REQUEST WAS A SPECIFIC REQUEST ABEND, OTHERWISE         41078232
*        REQUEST ANOTHER TAPE. REG 0 IS ALREADY SET UP TO GO TO         41078332
*        PROBLEM DETERMINATION IF NECESSARY.                            41078432
*                                                                       41078532
TMV08290 EQU   *                                               @G32DSMI 41078632
         CLC   DXVOLSR2,SCRTCH          IS IT NON SPECIFIC     @G32DSMI 41078732
         BNE   TMV19900                 SPECIFIC REQ. ABEND    @G32DSMI 41078832
         BAL   RD,TMV07800              DEQUE VOLUME           @G32DSMI 41078932
         B     TMV08000                 REQUEST ANOTHER VOLUME @G32DSMI 41079032
         DROP  RC                                              @ZA18506 41079132
         EJECT                                                 @ZA18506 41079232
*                                                              @G32DSMI 41079332
***************************************************************@G32DSMI 41079432
*                                                              @G32DSMI 41079532
*        ISSUE RACHECK FOR INPUT                               @G32DSMI 41079632
*                                                              @G32DSMI 41079732
***************************************************************@G32DSMI 41079832
*                                                              @G32DSMI 41079932
TMV08100 EQU   *                        RACHECK FOR INPUT      @G32DSMI 41080032
         USING TMV08100,RF              BASE FOR NEXT MVC      @ZA18506 41080132
*                                                              @G32DSMI 41080232
         MVC   DXCCW5(RACRLNTH),RACRLIST  MOVE IN RACHECK LIST @G32DSMI 41080332
         DROP  RF                       BASE NOT NEEDED        @ZA18506 41080432
*                                                              @G32DSMI 41080532
         RACHECK ENTITY=UCBVOLI,MF=(E,DXCCW5)   ISSUE RACHECK  @G32DSMI 41080632
*                                                              @G32DSMI 41080732
         LA    RB,K4                    TEST IF RETURN CODE=4  @G32DSMI 41080832
         CR    RF,RB                    TEST IF VOLUME NOT     @G32DSMIX41080932
                                        DEFINED TO RACF        @G32DSMI 41081032
         BER   RD                       NOT DEFINED RETURN     @G32DSMI 41081132
*                                                              @G32DSMI 41081232
         OI    DXRCFLAG,DXRCINP         SET AUTHORIZED FOR IN  @G32DSMI 41081332
         LTR   RF,RF                    TEST IF AUTHORIZED     @G32DSMIX41081432
                                        FOR INPUT PROCESSING   @G32DSMI 41081532
         BZR   RD                       AUTHORIZED RETURN      @G32DSMI 41081632
         NI    DXRCFLAG,X'FF'-DXRCINP   TURN OFF FLAG          @G32DSMI 41081732
*                                                              @G32DSMI 41081832
         LA    R0,K13                   OPEN=913-38 EOV=937-28 @G32DSMI 41081932
         B     TMV19900                 BRANCH TO PROBLEM      @G32DSMIX41082032
                                        DETERMINATION          @G32DSMI 41082132
         EJECT                                                 @ZA18506 41082232
***************************************************************@G32DSMI 41092732
*                                                              @G32DSMI 41092832
*        TEST FOR VALID PROTECT SPECIFICATION                  @G32DSMI 41092932
*        TWO BASE REGISTERS USED                               @ZA18506 41093032
*              RBASE FOR FIRST PAGE OF MODULE                  @ZA18506 41093132
*              RET FOR THIS SUBROUTINE                         @ZA18506 41093232
*                                                              @G32DSMI 41093332
***************************************************************@G32DSMI 41093432
*                                                              @G32DSMI 41093532
TMV08300 EQU   *                                               @G32DSMI 41093632
         USING TMV08300,RET                                    @ZA18506 41093732
         L     RF,DXJSCBAD              ADDRESS OF JSCB        @G32DSMI 41093832
         USING IEZJSCB,RF                                      @G32DSMI 41093932
         TM    JSCBSWT1,JSCBPASS        JSCB PASS ON           @G32DSMI 41094032
         BO    TMV08350                 YES TURN OFF PROTECT   @ZM04454 41094132
         TM    JFCFLGS1,JFCBPROT        PROTECT SPECIFIED      @G32DSMI 41094232
         BZR   RD                       NO - PROTECT RETURN    @G32DSMI 41094332
         LA    R0,K16                   SET FOR 913-48         @G32DSMI 41094432
         L     RF,CVTPTR                ADDRESS OF CVT         @G32DSMI 41094532
         USING CVT,RF                                          @G32DSMI 41094632
         L     RF,CVTRAC                ADDRESS OF RACF CVT    @G32DSMI 41094732
         LTR   RF,RF                    RACF ACTIVE            @G32DSMI 41094832
         BZ    TMV19900                 NO ABEND               @G32DSMI 41094932
         USING RCVT,RF                                         @G32DSMI 41095032
         TM    RCVTSTA1,RCVTTAPE        TAPE OPTION SET        @G32DSMI 41095132
         BZ    TMV19900                 NO ABEND               @G32DSMI 41095232
         LA    R0,K20                   SET FOR 913-5C         @G32DSMI 41095332
         TM    TIOESTTA,TIOSDSP2        PUBLIC VOLUME          @G32DSMI 41095432
         BO    TMV19900                 YES ABEND              @G32DSMI 41095532
         LA    R0,K18                   SET FOR 913-54         @G32DSMI 41095632
         TM    DXDCBLST,PLISTM0C        INOUT OR INPUT         @G32DSMI 41095732
         BZ    TMV19900                 YES ABEND              @G32DSMI 41095832
         TM    JFCBLTYP,JFCNSL          LABEL=NSL              @G32DSMI 41095932
         BOR   RD                       YES - RETURN           @G32DSMI 41096032
         LA    R0,K17                   SET FOR 913-50         @G32DSMI 41096132
         TM    JFCBLTYP,JFCBAL+JFCSL    IS LABEL = AL OR SL    @G32DSMI 41096232
         BZ    TMV19900                 NO - ABEND             @G32DSMI 41096332
         LA    R0,K19                   SET FOR 913-58         @G32DSMI 41096432
         CLC   JFCBVLSQ,ONET            CHECK IF FIRST VOLUME  @G32DSMI 41096532
         BH    TMV19900                 NOT FIRST - ABEND      @G32DSMI 41096632
         CLC   JFCBFLSQ,ONET            CHECK IF FIRST FILE    @G32DSMI 41096732
         BH    TMV19900                 NOT FIRST - ABEND      @G32DSMI 41096832
         TM    JFCBIND2,JFCOLD          DISP = MOD             @ZM04457 41096932
         BZ    TMV19900                 YES - ABEND            @ZM04457 41097032
         BR    RD                       RETURN                 @G32DSMI 41097132
TMV08350 EQU   *                        TURN OFF PROTECT       @ZM04454 41097232
         NI    JFCFLGS1,X'FF'-JFCBPROT  ZERO PROTECT FLAG      @ZM04454 41097332
         BR    RD                       RETURN                 @ZM04454 41097432
         DROP  RET                                             @ZA18506 41097532
         EJECT                                                 @ZA18506 41097632
***************************************************************@ZA18506 41147632
*                                                              @ZA18506 41197632
*              CONSTANTS                                       @ZA18506 41247632
*                                                              @ZA18506 41297632
***************************************************************@ZA18506 41347632
*                                                              @G32DSMI 41683532
RACRLIST RACHECK CLASS='TAPEVOL',ATTR=READ,MF=L                @G32DSMIX41684532
                                        RACHECK PARAMETER LIST @G32DSMI 41685532
RACRLNTH EQU   *-RACRLIST-10            LENGTH OF RACHECK LIST @ZM04458 41686532
RACULIST RACHECK CLASS='TAPEVOL',ATTR=UPDATE,MF=L              @G32DSMIX41688532
                                        RACHECK PARAMETER LIST @G32DSMI 41690532
RACULNTH EQU   *-RACULIST-10            LENGTH OF RACHECK LIST @ZM04458 41692532
         XCTLTABL BRT=YES,LENGTH=                              @ZA18506 42279532
         IECDSECS CVT,TCB,JSCB,DSAB,TIOT,DCB,MAIN,WTG,PREFX,UCB, Y02146X42297102
               RACVT,IEZDEB,ICHACHKL,                          @G32DSMIX42300032
               EXPAND=YES                                        Y02146 45300032
         IECEQU  IEZDEB=YES                                             48300032
         END                                                            51300032
