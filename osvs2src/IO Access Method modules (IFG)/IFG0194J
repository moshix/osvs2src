         TITLE 'IFG0194J                      MESSAGE ROUTINE'   Y02134 00050002
IFG0194J CSECT                                                          01600021
         ENTRY IFG0204J                 ENTRY POINT FOR CLOSE    Y02134 01605002
         ENTRY IFG0554J                 ENTRY POINT FOR EOV      Y02134 01610002
IFG0204J EQU   IFG0194J                 ALIAS ENTRY POINT        Y02134 01615002
IFG0554J EQU   IFG0194J                 ALIAS ENTRY POINT        Y02134 01620002
*                                                                     * 01622032
*********************************************************************** 01624032
*                                                                       01850002
*        VS 2 RELEASE 03.824  ADDITIONS/CHANGES/DELETIONS      @G24LSFS 01850437
*272505                                                        @G24LSFS 01850637
*        VS 2 RELEASE 03.818  ADDITIONS/CHANGES/DELETIONS               01850837
*A000                                                          @G18MSBS 01851037
*C000271660,271866,271890,272010                               @G18MSBS 01851237
*D000271868-271871                                             @G18MSBS 01851437
*        VS 2 RELEASE 03 DELETIONS/CHANGES                            * 01851637
*0000265988                                                    @ZA00014 01852002
*0000105042,105146-105211,105918-106008                        @ZA00700 01852402
*0000107312-107329                                             @ZM32752 01852503
*0000284178-284477                                             @ZA00018 01854002
*0000383255,384935,385544,388899,390648                        @ZA01278 01856002
*0000104587,104593,104597,105510,105562,105640,105718,105864,  @ZA01544 01857002
*105900,106044,106386,106404,107016,107034,107574,107592,      @ZA01544 01858002
*108096,108114,108654,108672,109418,109423,115977,115982,      @ZA01544 01859002
*129977,130077,130082,130601,130622,130627,143977,143982,      @ZA01544 01859202
*153061,153067,153077,153197,153351,153357,153367,153477,      @ZA01544 01859402
*153487,153641,153647,153657,153767,251200,256702,256703,      @ZA01544 01859602
*256717,256719,256721,256722,256725,257290,257445,257796,      @ZA01544 01859802
*257896,258869,259700,260700,263200,265685,265958,265988,      @ZA01544 01859902
*266000,266220,267120,267200,267520,267640,282700,283200,      @ZA01544 01860902
*283766,283776,283788,283798,283804,284562,284568,284688,      @ZA01544 01861102
*284694,284862,284940,284952,285042,285048,285078,285114,      @ZA01544 01861302
*285120-286122,286146,286152,286158,286164,298200,307700,      @ZA01544 01861502
*308350,308690,308773,308838,309670,309681,309694,309728,      @ZA01544 01861702
*309754,309768,309964,310079,310214,310349,310484,317700,      @ZA01544 01861802
*366227-366717,370700-382700,393232,393340                     @ZA01544 01862802
*0000384935                                                    @ZA02505 01863002
*0000285078                                                    @ZM30627 01863203
*0000285635                                                    @ZM34658 01863303
*        VS 2 RELEASE 04 DELETIONS/CHANGES                            * 01863537
*0000044520,044540,044560,044580,044600,044620,044640,044660,  @ZA02881 01864337
*044680,044700,044720,044740,044760,044780,044800,044820,      @ZA02881 01864637
*044840,044860,044880,044900,044920,288342,288344,288396-      @ZA02881 01864837
*288421,288928.288929,309670,309675-310538,310585,310608,      @ZA02881 01865637
*386700,389103,389610,389934,390150,393448,401200,401540,      @ZA02881 01865837
*401542                                                        @ZA02881 01866637
*0000100000-248200,256200,256739,256781,256815,257146,257247,  @ZA03694 01866737
*273003-283704                                                 @ZA03694 01866837
*0000                                                          @ZA03184 01866937
*0000                                                          @ZA03196 01867037
*0000385346-385347,385546,453950                               @ZA04633 01867437
*0000385618                                                    @ZA07691 01867537
*0000385727                                                    @ZA06693 01867637
*0000272513                                                    @ZA05096 01877637
*A284486-284493                                                @ZA10463 01882637
*0000283800,283804                                             @ZA12197 01883632
*               VS2 SU32 DELETIONS                                    * 01884132
*                                                              @G32DSMI 01884732
*0000                                                          @ZA12572 01887637
*0000                                                          @ZA16016 01893637
*             VS 2 RELEASE 037 DELETIONS/CHANGES                      * 01894637
*                                                                     * 01895637
*0000387687,387729,389069,389093,389528,389547,389902,389910   @ZA18541 01896637
*390531,390533,403651,403654,404108,404111                     @ZA18541 01897637
*38542737-807                                                  @ZA17796 01898137
*C000390536                                                    @ZA19630 01898337
*0000288410-288432,385636                                      @ZA18506 01898437
*00004524                                                      @ZA20470 01898637
*0000,D38569437,D38569537                                      @ZA28467 01899337
*D34381702-24387702                                            @ZA30562 01899637
* MODULE NAME = IFG0194J (OS/VS2)                                     * 01900002
*                                                                     * 01950002
* DESCRIPTIVE NAME =  MESSAGE ROUTINE                                 * 02000002
*                                                                     * 02050002
* COPYRIGHT = NONE                                                    * 02100002
*                                                                     * 02150002
* STATUS = RELEASE 2, LEVEL 0                                         * 02200002
*                                                                     * 02250002
* FUNCTION =                                                          * 02300002
*        1. CONSTRUCTS MESSAGES FOR TAPE AND DIRECT ACCESS STRING BY  * 02310002
*        INSERTING THE APPROPRIATE INFORMATION SUCH AS LABEL TYPE,    * 02320002
*        VOLUME SERIAL, DENSITY, JOB/STEP NAME.                       * 02330002
*                                                                     * 02340002
*        2. WRITES THE MESSAGE.                                       * 02342002
*           ANY MESSAGE REQUIRING A REPLY IS WRITTEN AS A NORMAL      * 02343037
*           WRITE TO OPERATOR FOLLOWED BY A MESSAGE REQUESTING        * 02343237
*           THE REPLY.                                                * 02343437
*                                                                     * 02344002
*        3. WRITES MESSAGE TO TSO TERMINAL WHERE APPROPRIATE:         * 02346002
*           A. MOUNT MESSAGE;                                         * 02348002
*           B. EXPIRATION DATE MESSAGE;                               * 02348402
*           C. FILE PROTECT MESSAGE;                                  * 02348802
*           D. WTOR FILE PROTECT MESSAGE.                             * 02349202
*                                                                     * 02349602
*        4. WRITES SMF RECORD 19.                                     * 02349702
*                                                                     * 02349802
*        5. REWINDS AND UNLOADS TAPE UNIT.                            * 02349902
*           DEQUEUES TAPE VOLUME SERIAL WITH IEC502E MESSAGE   @ZA18506 02350537
*           IF INDICATED IN UCB.                               @ZA18506 02351137
*                                                                     * 02351903
*        6. DIRECTS VIRTUAL VOLUME MOUNT/DEMOUNT REQUESTS             * 02353903
*           TO THE SSC ROUTINE.                                       * 02355903
*                                                                     * 02383302
* NOTES = SEE BELOW                                                   * 02400002
*                                                                     * 02450002
*    DEPENDENCIES =                                                   * 02500002
*            CLASS ONE CHARACTER CODE.  THE EBCDIC CHARACTER CODE     * 02550002
*            WAS USED FOR ASSEMBLY.  THE MODULE MUST BE REASSEMBLED   * 02600002
*            IF A DIFFERENT CHARACTER SET IS USED FOR EXECUTION.      * 02650002
*                                                                     * 02700002
*    RESTRICTIONS = NONE                                              * 02750002
*                                                                     * 02800002
*    REGISTER CONVENTIONS =                                           * 02850002
*            R2 POINTS TO DCB                                         * 02900002
*            R4 POINTS TO OPEN WORK AREA                              * 02950002
*            R5 POINTS TO THE RESIDENT ROUTINE                        * 03000002
*            R6 POINTS TO THE WTG TABLE                               * 03050002
*            R7 POINTS TO THE CURRENT PARAMETER LIST ENTRY            * 03100002
*            R8 POINTS TO THE CURRENT WTG TABLE ENTRY                 * 03150002
*            R9 POINTS TO THE DD ENTRY IN THE TIOT                    * 03200002
*            R10 POINTS TO THE UCB                                    * 03250002
*                                                                     * 03300002
*     PATCH LABEL = SEE THIRD LABEL BEFORE ORG STATEMENT AT END       * 03350002
*                   OF LISTING.                                       * 03400002
*                                                                     * 03450002
* MODULE TYPE = CONTROL (OPEN, CLOSE, EOV DATA MANAGEMENT)            * 03500002
*                                                                     * 03550002
*     PROCESSOR = ASSEMBLER XF                                        * 03600002
*                                                                     * 03650002
*     MODULE SIZE = SEE EXTERNAL SYMBOL DICTIONARY OR LOC FIELD ON    * 03700002
*                   ORG STATEMENT AT END OF LISTING                   * 03750002
*                                                                     * 03800002
*     ATTRIBUTES = REENTRANT, REFRESHABLE,READ-ONLY, ENABLED,         * 03850002
*                  PRIVILEGED, SUPERVISOR STATE, DATA MANAGEMENT KEY, * 03900002
*                  LINK PACK AREA RESIDENT/PAGEABLE.                  * 03950002
*                                                                     * 04000002
* ENTRY POINT =                                                       * 04050002
*        IFG0194J FROM OPEN                                           * 04060002
*        IFG0204J FROM CLOSE                                          * 04070002
*        IFG0554J FROM EOV                                            * 04080002
*                                                                     * 04100002
*     PURPOSE = ISSUE MESSAGES.                                       * 04150002
*                                                                     * 04200002
*     LINKAGE = AS FOLLOWS -                                          * 04250002
*               MVC   DXRETMOD,IDRETURN          RETURN MOD ID        * 04252002
*               MVI   DXRETCOD,OFFSET            RETURN OFFSET IN R14 * 04254002
*               LA    R0,PARMS                   LOAD PARMS IN R0     * 04258002
*               LA    R1,PARMS                   LOAD PARMS IN R1     * 04260002
*               LA    R14,MSGOFSET               LOAD OFFSET TO MSG   * 04260402
*               IECRES LOAD,MODID=ID4J,BRCODE=(14),BRANCH=QUEUED      * 04262002
*                                                                     * 04300002
* INPUT = ABOVE LINKAGE AND STANDARD OPEN/CLOSE/EOV REGISTERS         * 04350002
*         AND WORKAREAS.                                              * 04352002
*                                                                     * 04400002
* OUTPUT = THE FOLLOWING MESSAGES:                                    * 04450002
*                                                                     * 04450402
*IEC501A M DDD,VOLSER,LBL,DENS,JOBNAME,STEPNAME,DSNAME                * 04452037
*                                                                     * 04452402
*IEC501E M DDD,VOLSER,LBL,DENS,JOBNAME,STEPNAME,DSNAME                * 04454037
*                                                                     * 04454402
*IEC502E XX DDD,VOLSER,SPACE=CCCC,TTTT,AAAA/YYYY,ZZZZ                 * 04456037
*IEC502E JOBNAME,STEPNAME,DSNAME                                      * 04458037
*                                                                     * 04458402
*IEC502E XX DDD,VOLSER,LBL,DDNAME-CODE,JOBNAME,STEPNAME,DSNAME        * 04460037
*                                                                     * 04460402
*IEC507D E DDD,VOLSER,JOBNAME,STEPNAME,DSNAME                         * 04462037
*                                                                     * 04462402
*IEC509A F DDD,VOLSER,JOBNAME,STEPNAME,DSNAME                         * 04464037
*                                                                     * 04464402
*IEC510D F DDD,VOLSER,JOBNAME,STEPNAME,DSNAME                         * 04466037
*                                                                     * 04466402
*IEC135A U DDD,VOLSER,JOBNAME,STEPNAME,DSNAME                  @G32DSMI 04466832
*                                                                     * 04467232
*IEC534D A DDD,VOLSER,LBL,JOBNAME,STEPNAME,DSNAME                     * 04468037
*                                                                     * 04468402
*IEC704A L DDD,VOLSER,LBL,DEN,JOBNAME,STEPNAME,DSNAME                 * 04470037
*                                                                     * 04470402
*IEC512I SEC VOL DDD,VOLSER,LBL,JOBNAME,STEPNAME,DSNAME               * 04472037
*                                                                     * 04472402
*IEC512I I/O ERR DDD,VOLSER,LBL,JOBNAME,STEPNAME,DSNAME               * 04474037
*                                                                     * 04474402
*IEC512I LBL ERR DDD,VOLSER,LBL,VOLREQ,LBLREQ,                        * 04475437
*IEC512I JOBNAME,STEPNAME,DSNAME                                      * 04475637
*                                                                     * 04475737
*IEC513D I/O ERR DDD,VOLSER,LBL,JOBNAME,STEPNAME,DSNAME               * 04475837
*                                                                     * 04476237
*IEC705I TAPE ON DDD,VOLSER,LBL,DEN,JOBNAME,STEPNAME,DSNAME           * 04476337
*                                                                     * 04476402
*IEC108I OPERATOR ACTION HAS BEEN REQUESTED FOR YOUR DATA SET         * 04478037
*                                                                     * 04478402
*IEC254D SHOULD JOBNAME USE (DDNAME,DDD,VOLSER) FOR CREATING          * 04480037
*        A NEW CHECKPOINT DATA SET                                    * 04482037
*                                                                     * 04482402
*IEC255D JOBNAME IS (DDNAME,DDD,VOLSER) A SECURE                      * 04484037
*        CHECKPOINT VOLUME                                            * 04486037
*                                                                     * 04486402
*IEC256A JOBNAME (DDNAME,DDD,VOLSER) IS NO LONGER A SECURE            * 04488037
*        CHECKPOINT VOLUME                                            * 04490037
*                                                                     * 04490402
*00 IECNNNY REPLY 'REPLY OPTIONS'                                     * 04492037
*                                                                     * 04500002
* EXIT-NORMAL = CALLER                                                * 04550002
*               NOTE-REGS 4-13 NOT DESTROYED.                         * 04552002
*                                                                     * 04600002
* EXIT-ERROR = DMABCOND SET LOCK ERROR                                * 04650002
*              ICBMNTDE ERROR - 737-30 ABEND                          * 04652003
*                                                                     * 04700002
* EXTERNAL REFERENCES = SEE BELOW                                     * 04750002
*                                                                     * 04800002
*    ROUTINES = IFG019RA,EXCP,LSPACE,TPUT,IOSGEN,WTO,VOLSTAT,SETLOCK. * 04850002
*                                                                     * 04900002
*    DATA AREAS = SEE PARAMETERS OF IECDSECS AND IECEQU MACRO.        * 04950002
*                                                                     * 05000002
*    CONTROL BLOCK = SEE PARAMETERS OF IECDSECS AND IECEQU MACRO.     * 05050002
*                                                                     * 05100002
* TABLES = XCTLTABL.                                                  * 05150002
*                                                                     * 05200002
* MACROS = IECDSECS,IECEQU,IECRES,XCTLTABL,DMABCOND,WTO,WTOR,TPUT,    * 05250002
*          SETLOCK,MODESET,IOSGEN,EXCP,OIL,IECDIOCM,ICBMNTDE.         * 05252003
*                                                                     * 05300002
* CHANGE ACTIVITY = SEE DELETIONS/CHANGES SECTION AFTER CSECT CARD.   * 05350032
*                                                                     * 05400002
*********************************************************************** 05450002
         EJECT                                                          09600002
*                                                                       09650002
         USING FORCORE,RCORE            WORK AREA                       09700002
         USING WTG,RWTG                 WHERE-TO-GO TABLE        Y02080 09750002
         USING IHADCB,RDCB              RDCB POINTS TO DCB       Y02134 09751002
         USING USERPRML,RPARC           RPARC POINTS TO CURRENT  Y02134 09752002
         USING TIOENTRY,RTIOT           RTIOT POINTS TO ENTRY    Y02134 09755002
         USING UCBOB,RUCB               UCB                             09800002
         USING WTOBUFFR,RD              BASE FOR WTO AREA      @ZA01544 09801002
         BALR  RBASE,R0                 SET BASE REGISTER               09850002
         USING *,RBASE                                                  09900002
*                                                                       09950002
         L     RET,WTO00100(RET)        GET MSG RTN ADDR       @ZA03694 10000037
         BR    RET                      GOTO MESSAGE ROUTINE   @ZA03694 10001037
*                                                                       10002037
WTO00100 DS    0F                       MESSAGE TABLE          @ZA03694 10050037
         DC    A(IEC502E1)              EOV - CLOSE POSITIONING  YM7526 10100037
         DC    A(IEC501A)               COMPLETE MOUNT MESSAGE   Y02134 10152037
         DC    A(IEC502E2)              ASCII DISMOUNT MESSAGE   Y02134 10155037
         DC    A(IEC502E3)              REJECT VOLUME            Y02134 10165037
         DC    A(IEC501E)               LOOK AHEAD MOUNT MESSAGE Y02134 10205037
         DC    A(IEC507D)               EXPIRATION DATE MESSAGE  Y02134 10250037
         DC    A(IEC509A)               FILE PROTECT MESSAGE     Y02134 10300037
         DC    A(IEC510D)               WTOR FILE PROTECT MSG    Y02134 10301037
         DC    A(IEC534D)               WTOR DESTROY LABEL MSG   Y02134 10303037
         DC    A(IEC704A)               WTOR CREATE SL MSG       Y02134 10303437
         DC    A(IEC512IS)              SEC VOL MESSAGE          Y02134 10303837
         DC    A(IEC512II)              I/O ERROR MESSAGE        Y02134 10304237
         DC    A(IEC705I)               TAPE ATTRIBUTE MESSAGE   Y02134 10304637
         DC    A(IEC254D)               REQ FOR NEW CHKPT D/S    Y02083 10304737
         DC    A(IEC255D)               QUERY CHKPT VOL STATUS   Y02083 10304837
         DC    A(IEC256A)               REVOKE CHKPT VOL STATUS  Y02083 10304937
         EJECT                                                          10305032
         DC    A(IEC512IL)              LBL ERR MSG            @ZA02881 10305332
         DC    A(IEC513D)               OPER I/O ERROR MESSAGE @ZA03196 10305632
         DC    A(IEC135A)               REMOVE FILE PROT RING  @G32DSMI 10305932
         EJECT                                                          10306337
*                                                                Y02134 10307137
*****************************************************************Y02134 10308137
*                                                                Y02134 10309137
*        RETURN TO CALLER                                        Y02134 10310137
*                                                                Y02134 10311137
*****************************************************************Y02134 10312137
*                                                                Y02134 10313137
WTO01000 EQU   *                                                 Y02134 10314137
*                                                                Y02134 10315137
         LM    RTIOT,RET,DXREGSAV       RESTORE REGISTERS        Y02134 10316137
         LM    R0,R1,DXREG0             RESTORE REGISTERS        Y02134 10317137
*                                                                Y02134 10318137
         XR    RET,RET                  CLEAR RETURN REGISTER    Y02134 10319137
         IC    RET,DXRETCOD             LOAD RETURN OFFSET       Y02134 10320137
         IECRES LOAD,MODID=DXRETMOD,BRCODE=(RET),BRANCH=QUEUED   Y02134 10321137
         EJECT                                                 @G32DSMI 21000032
*                                                                Y02134 24470002
*****************************************************************Y02134 24520002
*                                                                Y02134 24570002
*        ISSUE WTO                                               Y02134 24620002
*                                                                Y02134 24670002
*****************************************************************Y02134 24720002
*                                                                Y02134 24770002
WTO02000 EQU   *                                                 Y02134 24820037
*                                                                Y02134 24870002
         XR    R0,R0                    CLEAR FOR MULTI LINE WTO Y02134 24920002
         WTO   MF=(E,WTOAREA)           ISSUE WTO SVC          @ZA01544 25120002
         BR    RET                      RETURN R1=WTO ID         YM7310 25122002
         EJECT                                                          25172002
*                                                                Y02134 25270002
*****************************************************************Y02134 25320002
*                                                                Y02134 25370002
*        ISSUE WTOR                                              Y02134 25420002
*                                                                Y02134 25470002
*****************************************************************Y02134 25520002
*                                                                Y02134 25570002
WTO03000 EQU   *                                                 Y02134 25620037
*                                                                Y02134 25670002
         ST    RET,DXREGE               SAVE RETURN ADDRESS      Y02134 25670102
         LH    R1,WTOLNGTH              LOAD LENGTH OF MESSAGE @ZA01544 25670202
         LA    R1,WTOAREA+WTOCODES-WTOEND(R1) END OF LINE 1    @ZA01544 25670303
         OC    WTOCODES-WTOCODES(L'WTOCODES,R1),WTORCODE WTOR  @ZA01544 25681003
*                                                                YM7526 25690603
         MVC   WTODRCDS,WTOCODES-WTOCODES(R1) SAVE CODES       @ZA01544 25693103
*                                                                Y02134 25709803
         BAL   RET,WTO02000             LINK TO MULTI-LINE WTO   Y02134 25714637
         LR    RB,R1                    SAVE MSG ID FOR DOM    @ZM30627 25715603
*                                                                Y02134 25719403
         L     RET,DXREGE               RESTORE RETURN ADDRESS   Y02134 25724203
         MVC   WTOMSID2,MSG1STRT        SAVE MSG ID            @ZA01544 25729003
         MVC   WTOMSG1(L'IECREPLY),IECREPLY SETUP REPLY MSG    @ZA01544 25744502
         MVC   MSG1STRT(L'WTOMSID2),WTOMSID2 RESTORE MSG ID    @ZA01544 25779603
         SR    R1,R1                    ZERO REG FOR INSERT    @ZA01544 25780602
         IC    R1,K0(RC)                GET REPLY MSG LENGTH   @ZA01544 25781602
         BCTR  R1,R0                    DECREMENT FOR EXECUTE  @ZA01544 25782602
         EX    R1,MOVE4                 MOVE IN REPLY INFO     @ZA01544 25783602
         LA    R1,K1(R1)                RESET LENGTH           @ZA01544 25784602
         LA    R1,L'IECREPLY(R1)        GET MSG LENGTH         @ZA01544 25785602
         STH   R1,WTOLNGTH              STORE LENGTH           @ZA01544 25786602
         LA    R1,WTOAREA+WTOCODES-WTOEND(R1) END OF LINE 1    @ZA01544 25788103
         MVC   WTOCODES-WTOCODES(L'WTOCODES,R1),WTODRCDS R & D @ZA01544 25789103
*                                                                Y02134 25884902
         MVC   WTOSWTCH,WTORFLAG        SET FOR WTOR           @ZA01544 25886902
         LA    R1,DXECB                 LOAD POINTER TO ECB      Y02134 25920002
         ST    R1,WTOECBAD              SAVE ECB POINTER       @ZA01544 25970002
         L     R1,DXREG1                LOAD REPLY POINTER       Y02134 26020002
         ST    R1,WTORPLYP              SAVE REPLY POINTER     @ZA01544 26070002
*                                       AND LENGTH             @ZA01544 26071002
*                                                                Y02134 26170002
         MVI   DXECB,K0                 INITIALIZE ECB FOR WTOR  Y02134 26220002
*                                                                Y02134 26270002
         WTOR  MF=(E,WTORAREA)          ISSUE WTOR SVC         @ZA01544 26320002
*                                                                Y02134 26370002
         STM   RB,RET,DXCCW2            SAVE REGISTERS         @ZM30627 26371003
*                                                                       26371237
         BAL   RET,WTO04000             LINK TO TELL TERMINAL  @ZA03694 26371437
*                                                                       26371637
         LM    RTIOT,RET,DXREGSAV       RESTORE CALLERS REGS   @ZM30627 26372003
         LM    R0,R1,DXREG0             RESTORE 0 AND 1        @ZM30627 26373003
         IECRES WAIT                    WAIT FOR REPLY         @ZM30627 26374003
         MVI   DXECB,ECBCOD7F           SET TO NO ERROR        @ZA02881 26374237
         LM    RB,RET,DXCCW2            RESTORE REGS           @ZM30627 26375003
*                                                                       26375237
         DOM   MSG=(11)                 DOM MESSAGE            @ZM30627 26376003
*                                                                       26377037
         XR    RB,RB                    CLEAR REG FOR IC       @ZA02881 26378037
         IC    RB,DXREG1                GET REPLY LENGTH       @ZA02881 26379037
         L     R1,DXREG1                GET REPLY BUFFER       @ZA02881 26380037
         BCTR  RB,0                     DECREMENT FOR MOVE     @ZA02881 26381037
         EX    RB,FOLD                  FOLD REPLY             @ZA02881 26382037
         BR    RET                      RETURN                   Y02134 26520002
MOVE4    MVC   WTOMSG1+L'IECREPLY(R0),K1(RC) REPLY INFO        @ZA01544 26521003
FOLD     OC    IECREPLY-IECREPLY(R0,R1),BLANKS FOLD REPLY      @ZA02881 26521237
         EJECT                                                          26522002
*                                                                Y02134 26530002
*****************************************************************Y02134 26540002
*                                                                Y02134 26550002
*        ISSUE TPUT MESSAGE                                      Y02134 26560002
*                                                                Y02134 26562002
*****************************************************************Y02134 26564002
*                                                                Y02134 26566002
WTO04000 EQU   *                                                 Y02134 26568037
*                                                                Y02134 26568402
         TM    WTOTSOSW,X80             TEST IF ALREADY ISSUED @ZA01544 26568502
         BO    WTO04020                 BRANCH IF MSG ISSUED     Y02134 26571537
*                                                                Y02134 26573502
         L     RF,DXASCBAD              LOAD CURRENT ASCB ADDR   Y02134 26574802
         L     RF,ASCBTSB-ASCB(,RF)     LOAD TSB ADDRESS         Y02134 26580802
         LTR   RF,RF                    TEST FOR TERMINAL TASK   Y02134 26583802
         BZ    WTO04020                 BRANCH IF NOT            Y02134 26586837
*                                                                Y02134 26589802
         LA    R0,L'IEC108I             GET LENGTH OF MESSAGE    Y02134 26592802
         STCM  R0,B'0011',WTOSWTCH      SAVE LENGTH            @ZA01544 26595802
         LA    R1,MSG1STRT              POINT TO TSO MSG       @ZA01544 26598802
         MVC   MSG1STRT(L'IEC108I),IEC108I TSO MSG TO BUFFER   @ZA01544 26600002
*                                                                Y02134 26610002
         L     RF,DXJSCBAD              GET JSCB ADDRESS         Y02134 26620002
         MVC   WTOLNGTH(L'JSCBTJID),JSCBTJID-IEZJSCB(RF) ID    @ZA01544 26622002
         L     RF,JSCBPSCB-IEZJSCB(,RF) GET THE PSCB ADDRESS     Y02134 26630002
         LTR   RF,RF                    PSCB INITIALIZED         Y02134 26640002
         BZ    WTO04010                 DEFAULT TPUT W/MSG ID    Y02134 26650037
*                                                                Y02134 26660002
         MODESET EXTKEY=ZERO            NEED KEY 0 FOR THE PSCB  YM4814 26665002
         L     RF,PSCBUPT-PSCB(,RF)     GET UPT ADDRESS          Y02134 26670002
         TM    UPTSWS-UPT(RF),UPTMID    IS MESSAGE ID REQUIRED   Y02134 26680002
         BO    WTO04010                 BRANCH IF REQUIRED       Y02134 26690037
*                                                                Y02134 26700002
         MODESET EXTKEY=DATAMGT         RETURN TO DATAMGT KEY    YM6725 26702002
*                                                                Y02134 26704002
         LA    R0,L'IEC108I+WTOMSGID-WTOINSTR GET LENGTH - ID    Y02134 26710002
         STCM  R0,B'0011',WTOSWTCH      SAVE LENGTH            @ZA01544 26712002
         LA    R1,WTOINSTR-WTOMSGID+MSG1STRT POINT PASSED      @ZA01544 26720002
*                                       MESSAGE ID             @ZA01544 26721002
*                                                                Y02134 26730002
WTO04010 EQU   *                        ISSUE TERMINAL MSG       Y02134 26740037
*                                                                Y02134 26750002
         MODESET EXTKEY=DATAMGT         RETURN TO DATAMGT KEY    YM6725 26750402
*                                                                Y02134 26750802
         ICM   R0,B'1111',WTOMSG1       LOAD ID AND LENGTH     @ZA01544 26752002
         TPUT  (1),(0),R                SEND MSG TO TERMINAL     Y02134 26760002
*                                                                Y02134 26762002
         OI    WTOTSOSW,X80             SET TSO SWITCH         @ZA01544 26764002
*                                                                Y02134 26770002
WTO04020 EQU   *                        RETURN                   Y02134 26780037
*                                                                Y02134 26790002
         BR    RET                      RETURN                   Y02134 26800002
         EJECT                                                          26801037
*                                                                Y02134 26802037
*****************************************************************Y02134 26803037
*                                                                Y02134 26804037
*        GET MESSAGE WORK AREA                                   Y02134 26805037
*                                                                Y02134 26806037
*****************************************************************Y02134 26807037
*                                                                Y02134 26808037
WTO05000 EQU   *                                                 Y02134 26809037
*                                                                Y02134 26810037
         L     RF,WTGPREFX              LOAD POINTER TO PREFIX   Y02134 26811037
         L     RD,IECMSGQA-IECPREFX(,RF) LOAD WORK AREA POINTER  Y02134 26812037
         LTR   RD,RD                    TEST FOR VALID POINTER   Y02134 26813037
         BNZ   WTO05010                 BRANCH, WORK AREA VALID  Y02134 26814037
*                                                                Y02134 26815037
         IECRES GET,LV=WTOBUFFL,PREFIX=YES,ID=MSGS,              Y02134X26816037
               STM=(R2,RF,IECREGSV-IECPREFX(RF))                 Y02134 26817037
*                                                                Y02134 26818037
         LR    RD,R1                    LOAD WORK AREA POINTER   Y02134 26819037
         ST    RD,IECMSGQA-IECPREFX(,RF) SAVE MESSAGE WORK AREA  Y02134 26820037
*                                                                Y02134 26821037
WTO05010 EQU   *                        INITIALIZE WTO BUFFER    Y02134 26822037
*                                                                Y02134 26823037
         MVI   WTOBUFFR,BLANK           SET UP,                @ZA01544 26824037
*                                       PROPAGATE BLANKS       @ZA01544 26825037
         MVC   WTOBUFFR+K1(WTOEND2-WTOBUFFR),WTOBUFFR BLANKS   @ZA01544 26826037
         BR    RET                      RETURN                   Y02134 26827037
         EJECT                                                          26850002
*                                                              @Y30LSFY 26900003
***************************************************************@Y30LSBS 26950003
*                                                              @Y30LSFY 27000003
*        VIRTUAL DASD MOUNT AND DEMOUNT ROUTINES               @Y30LSFY 27050003
*                                                              @Y30LSFY 27100003
***************************************************************@Y30LSBS 27150003
*                                                              @Y30LSFY 27160003
WTO08900 EQU   *                        VIRTUAL DASD MOUNT RTN @Y30LSFY 27162003
***************************************************************@Y30LSFY 27164003
         XC    WTOBUFFR(MNTSIZE+MNTXLGTH+K4),WTOBUFFR CLEAR    @G18MSBS 27166037
*                                       PARMAMETER LIST        @G18MSBS 27166537
         ST    RD,MNTSIZE+MNTXLGTH(,RD) SAVE WTOBUFFR ADDRESS  @G18MSBS 27167037
*                                                              @Y30LSFY 27168003
         BAL   RET,WTO09110             MOVE VOLSER TO UCB     @Y30LSFY 27168403
*                                                              @Y30LSFY 27168803
         CLC   SCRTCH,K0(R1)            REQ FOR SCRATCH VOLUME @Y30LSFY 27170203
         BNE   WTO08910                 BRANCH NO              @Y30LSFY 27170303
         OI    MNTFLAGS-ICBMNTD1(RD),SCRPACK SET SCR VOL FLAG  @G18MSBS 27186637
         CLI   WTGMODNM+K4,EOVID        WAS EOV THE CALLER?    @Y30LSFY 27187137
         BNE   WTO08910                 NO                     @Y30LSFY 27187637
*                                       EOV MOUNT SCRATCH REQ  @Y30LSFY 27188137
         OI    MNTFLAGS-ICBMNTD1(RD),SCNDRY+MNTLSTX SET SCNDRY @G18MSBS 27188637
*                                       AND MNT LST EXT FLAGS  @G18MSBS 27189137
         LA    RF,MNTSIZE(,RD)          GET ADDRESS OF MOUNT   @G18MSBS 27189637
*                                       LIST EXTENSION AND     @G18MSBS 27190137
         ST    RF,MNTEXTP-ICBMNTD1(,RD) MOVE IT TO LIST        @G18MSBS 27190637
         LR    RD,RF                    SETUP FOR EXTENSION    @G18MSBS 27191137
         LA    RF,DXJBF                 WORK AREA JFCB         @Y30LSFY 27191637
         ST    RF,MNTXJFCB-MNTXT(,RD)   MOVE JFCB PTR TO LIST  @G18MSBS 27192137
         L     RF,DXJSCBAD              LOAD JSCB ADDRESS      @G18MSBS 27192637
         L     RF,JSCBJCT-IEZJSCB(,RF)  GET JCT PTR FROM JSCB  @G18MSBS 27193137
         LA    RF,SWAPREFX+JCTJNAME-JCTABLE(,RF) GET PTR OF    @G18MSBS 27193637
*                                       JOB NAME               @G18MSBS 27194137
         ST    RF,MNTXJOBN-MNTXT(,RD)   AND SAVE IT IN EXT     @G18MSBS 27194637
         L     RF,DXJSCBAD              RELOAD JSCB ADDRESS    @G18MSBS 27195137
         L     RF,JSCSCT-IEZJSCB(,RF)   GET SCT PTR FROM JSCB  @G18MSBS 27195637
         LA    RF,SWAPREFX+SCTSNUMB-SCTABLE(,RF) GET PTR OF    @G18MSBS 27196137
*                                       STEP NUMBER            @G18MSBS 27196637
         ST    RF,MNTXSTEP-MNTXT(,RD)   AND SAVE IT IN EXT     @G18MSBS 27197137
         L     RD,MNTXLGTH(,RD)         RELOAD PARMLIST        @G18MSBS 27197637
         B     WTO08920                 DON'T MOVE IN VOLSER   @Y30LSFY 27198137
*                                                              @Y30LSFY 27198637
WTO08910 EQU   *                        NOT A SCRATCH REQUEST  @Y30LSFY 27199137
*                                                              @Y30LSFY 27199637
         MVC   MNTVOLID-ICBMNTD1(K6,RD),K0(R1) VOLSER TO LIST  @G18MSBS 27200137
*                                                              @Y30LSFY 27203103
WTO08920 EQU   *                        ISSUE MOUNT MACRO      @Y30LSFY 27203203
*                                                              @Y30LSFY 27208803
         ICBMNTDE TYPE=MNT,VUA=UCBCHA,MF=(E,(RD))              @Y30LSFY 27210803
*                                                              @Y30LSFY 27212803
         LTR   RF,RF                    ANY ERRORS             @Y30LSFY 27213203
         BNZ   WTO10050                 BRANCH IF ERRORS       @Y30LSFY 27213603
*                                                              @Y30LSFY 27214003
         BAL   RET,WTO09150             SET THE MOUNT BIT      @Y30LSFY 27214103
*                                                              @Y30LSFY 27214203
         B     WTO01000                 BRANCH TO EXIT         @Y30LSFY 27214337
         EJECT                                                          27224337
***************************************************************@Y30LSFY 27241903
WTO08950 EQU   *                        VIRT DASD DEMOUNT RTN  @Y30LSFY 27242003
***************************************************************@Y30LSFY 27242103
         XC    WTOBUFFR(K30),WTOBUFFR   CLEAR PARM LIST        @Y30LSFY 27246703
         BAL   RET,WTO09100             GET VOLSER & UNIT      @ZA05096 27248737
*                                                              @Y30LSFY 27249637
         ICBMNTDE TYPE=DMNT,VOLID=WTOVOLSR,VUA=UCBCHA,         @G24LSFS*27250537
               MF=(E,(RD))                                              27250837
*                                                              @Y30LSFY 27251403
         LTR   RF,RF                    ANY ERRORS             @Y30LSFY 27256003
         BNZ   WTO10050                 BRANCH IF ERRORS       @Y30LSFY 27258003
*                                                              @Y30LSFY 27260003
         BAL   RET,WTO09400             LINK TO CLEAR UCB      @Y30LSFY 27260403
*                                                              @Y30LSFY 27260503
         XC    DXVOLSR1,DXVOLSR1        CLEAR REJECT VOLSER    @Y30LSFY 27260603
*                                                              @Y30LSFY 27260703
         LR    RET,RB                   RESTORE RETURN REG     @Y30LSFY 27272503
         BR    RET                      RETURN                 @Y30LSFY 27282503
*                                                              @Y30LSFY 27284503
         EJECT                                                          28370402
*                                                                       28370537
*********************************************************************** 28370637
*                                                                       28371037
*        ASCII DDNAME-CODE MESSAGE ROUTINE                              28371137
*                                                                       28371237
*********************************************************************** 28371437
*                                                                       28371537
WTO09000 EQU   *                        DDNAME-CODE RTN        @ZA03694 28371637
*                                                                       28371837
         L     R1,DXREG1                LOAD ASCII CODE        @ZA03694 28371937
         LTR   R1,R1                    TEST FOR AL CODE         Y02134 28372037
         BZ    WTO09008                 BRANCH, ASSUME NOT AL    Y02134 28372137
*                                                                Y02134 28372237
         MVC   WTOADDN(L'TIOEDDNM),TIOEDDNM MOVE IN DDNAME     @ZA01544 28372337
         LA    RF,WTOADDN+L'TIOEDDNM+K1 POINT TO LAST CHAR     @ZA01544 28372437
*                                                                Y02134 28372537
WTO09002 EQU   *                        SET UP DDNAME-CODE       Y02134 28372637
*                                                                Y02134 28372737
         BCTR  RF,R0                    LOOKING FOR LAST CHAR    Y02134 28372837
         CLI   K0(RF),BLANK             FIND END OF DDNAME       Y02134 28372937
         BE    WTO09002                 BRANCH IF NOT AT END     Y02134 28373137
*                                                                Y02134 28373337
         MVI   K1(RF),DASH              FORM DDNAME-CODE         Y02134 28373437
         STC   R1,K2(,RF)               STORE CODE               Y02134 28373537
         OI    K2(RF),CHAR0             SET TO PRINT CODE        Y02134 28373637
*                                                                Y02134 28373737
WTO09008 EQU   *                        RETURN                 @ZA03694 28373837
*                                                                       28373937
         BR    RET                      RETURN                 @ZA03694 28374037
*                                                                       28374137
         EJECT                                                          28374237
*                                                                       28374437
*****************************************************************Y02134 28374737
*                                                                Y02134 28374837
*        MOVE VOLUME SERIAL AND UNIT ID TO MESSAGE               Y02134 28374937
*                                                                Y02134 28375037
*****************************************************************Y02134 28375137
*                                                                Y02134 28375237
WTO09100 EQU   *                        CHECK UCB VOLSER         YM3916 28375337
*                                                                Y02134 28375437
         LA    R1,UCBVOLI               POINT TO UCB VOLSER      YM3916 28375537
         CLC   UCBVOLI,ZEROS            CHECK FOR VOL SER        YM3916 28375637
         BNZ   WTO09102                 BRANCH IF UCB = VOLSER @ZA01544 28375737
         LA    R1,DXVOLSR1              ASSUME VOLSER AT DXVOLSR1YM3916 28375837
*                                                              @ZA01544 28375903
WTO09102 EQU   *                        R1 POINTS TO VOLSER    @ZA01544 28376003
*                                                              @ZA01544 28376103
         MVC   WTOUNIT,UCBNAME          LOGICAL UNIT ADDR      @ZA01544 28376203
         MVC   WTOVOLSR,K0(R1)          VOLUME SERIAL NO.      @ZA01544 28376403
         B     WTO09106                 RETURN                 @ZA01544 28376703
*                                                                YM3916 28376803
WTO09105 EQU   *                        R1 POINTS TO VOLSER      YM3916 28377003
*                                                                YM3916 28377203
         MVC   WTOUNIT,UCBNAME          LOGICAL UNIT ADDR      @ZA01544 28377403
         MVC   WTOVOLSR,K0(R1)          VOLUME SERIAL NO.      @ZA01544 28377602
*                                                                Y02134 28377802
         CLC   SCRTCH,WTOVOLSR          CHECK FOR NON SPECIFIC @ZA01544 28378802
         BNE   WTO09106                 BRANCH NOT SCRTCH        YM3916 28379002
*                                                                Y02134 28379403
         TM    TIOESTTA,TIOSDSP1        TEST FOR PRIVATE REQUEST Y02134 28379503
         BNO   WTO09106                 BRANCH IF NOT PRIVATE    YM3916 28379602
*                                                                Y02134 28379702
         MVC   WTOVOLSR,PRIVAT          ASK FOR PRIVATE VOL    @ZA01544 28379802
*                                                                Y02134 28379902
WTO09106 EQU   *                        RETURN                 @ZA12197 28380037
*                                                                Y02134 28380337
         CLI   WTOVOLSR,BLANK           IS VOLSER PRESENT      @ZA01544 28380602
         BCR   K7,RET                   RETURN IF PRESENT      @ZA01544 28380702
         MVI   WTOVOLSR,COMMA           PUT IN COMMA FOR       @ZA01544 28380802
*                                       SKIPPED FIELD          @ZA01544 28381002
         BR    RET                      RETURN                   Y02134 28381402
         EJECT                                                          28381502
*                                                                Y02134 28381602
*****************************************************************Y02134 28381702
*                                                                Y02134 28381802
*        MOVE VOLUME SERIAL TO UCB                               Y02134 28381902
*                                                                Y02134 28391902
*****************************************************************Y02134 28392302
*                                                                Y02134 28392702
WTO09110 EQU   *                                                 Y02134 28393102
*                                                                Y02134 28393702
         L     RF,WTGPREFX              LOAD PREFIX ADDRESS      Y02134 28394202
         STM   R0,RF,IECREGSV-IECPREFX(RF) SAVE REGISTERS        Y02134 28394702
*                                                                Y02134 28395202
         MODESET EXTKEY=ZERO            SETLOCK KEY              Y02082 28395702
*                                                                Y02134 28396202
WTO09120 SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                  Y02134X28396702
               RELATED=(LOCAL,IFG0194J(WTO09140))                Y02134 28397202
*                                                                Y02134 28397702
         MODESET EXTKEY=DATAMGT         RETURN TO DATA MGMNT KEY Y02082 28398202
*                                                                Y02134 28398702
         LTR   RD,RD                    TEST FOR SETLOCK ERROR   Y02134 28399202
         LM    R0,RF,IECREGSV-IECPREFX(RF) RESTORE REGISTERS     Y02134 28399702
         BNZ   WTO10000                 BRANCH IF SETLOCK ERROR  Y02134 28400202
*                                                                Y02134 28400702
         MODESET EXTKEY=SUPR            UCB KEY                  Y02082 28401202
*                                                                Y02134 28401702
         XC    UCBVOLI,UCBVOLI          CLEAR VOL SERIAL NO.     Y02134 28402202
*                                                                Y02134 28402702
         CLC   SCRTCH,K0(R1)            CHECK FOR SCRATCH        Y02134 28403202
         BE    WTO09130                 BRANCH FOR SCRATCH VOL   Y02134 28403702
*                                                                Y02134 28404202
         MVC   UCBVOLI,K0(R1)           MOVE VOLUME SER TO UCB   Y02134 28404702
*                                                                Y02134 28405202
WTO09130 EQU   *                        RELEASE LOCK             Y02134 28405702
*                                                                Y02134 28406202
         MODESET EXTKEY=ZERO            SETLOCK KEY              Y02134 28406702
*                                                                Y02134 28407202
WTO09140 SETLOCK RELEASE,TYPE=LOCAL,                             Y02134X28407702
               RELATED=(LOCAL,IFG0194J(WTO09120))                Y02134 28408202
*                                                                Y02134 28408702
         MODESET EXTKEY=DATAMGT         DM KEY                   Y02082 28409202
*                                                                Y02134 28409702
         LTR   RD,RD                    TEST FOR SETLOCK ERROR   Y02134 28410202
         LM    R0,RF,IECREGSV-IECPREFX(RF) RESTORE REGISTERS     Y02134 28410702
         BNZ   WTO10000                 BRANCH IF SETLOCK ERROR  Y02134 28411202
*                                                                Y02134 28411702
         BR    RET                      RETURN                   Y02134 28412202
         EJECT                                                          28412602
*                                                                Y02134 28412702
*****************************************************************Y02134 28413202
*                                                                Y02134 28413702
*        SET UP DOM MESSAGE ID                                          28413802
*        NOTE - DOM IS ISSUED FOR MOUNT MESSAGES ONLY                   28413902
*        OTHER MESSAGES ARE INFORMATIONAL                               28414002
*        WTOR MSGS ARE DOMED BY WTO EXCEPT 2 LINE WTOR WHERE THE        28414102
*        MSG IS MULTI-LINE.                                             28414202
*        DOM NOT SUPPORTED FOR DA BECAUSE OF UCB CHANGES                28414302
*                                                                       28414402
*        R1 HAS WTO ID ON ENTRY TO THIS ROUTINE                         28414502
*                                                                Y02134 28414702
*****************************************************************Y02134 28415202
*                                                                Y02134 28415702
WTO09150 EQU   *                        SET UP DOM MSG ID      @ZA00018 28416202
*                                                                Y02134 28416702
         MODESET EXTKEY=SUPR            UCB KEY                  Y02082 28417202
*                                                                Y02134 28417702
         TM    UCBTBYT3,UCB3DACC        TEST FOR DIRECT ACCESS   YM7310 28447802
         BO    WTO09170                 BYPASS DOM               YM7310 28447902
*                                                                YM7310 28448002
         XC    UCBFSER,UCBFSER          CLEAR MCS IDS            YM7310 28448302
         STCM  R1,B'0111',UCBFSER       SAVE DOM ID              YM7310 28448402
         OI    UCBSTAB,UCBBNUL          SET DOM INDICATOR        YM7310 28448502
*                                                                       28448602
         CLC   SCRTCH,WTOVOLSR          CHECK FOR NON SPECIFIC @ZA10463 28448737
         BE    WTO09160                 BRANCH SCRATCH         @ZA10463 28448837
*                                                                       28448937
         TM    TIOESTTA,TIOSDSP1        TEST FOR PRIVATE REQ   @ZA10463 28449037
         BNO   WTO09170                 BRANCH IF NOT PRIVATE  @ZA10463 28449137
WTO09160 EQU   *                                               @ZA10463 28449237
         OI    UCBSTAB,UCBBPRV          SET PRIVATE INDICATOR  @ZA10463 28449337
*                                                                       28449437
*********************************************************************** 28449537
*                                                                       28449637
*        SET THE MOUNT BIT                                              28449737
*                                                                       28449837
*********************************************************************** 28449937
*                                                                YM7310 28450037
WTO09170 EQU   *                        RETURN                   YM7310 28450137
*                                                                YM7310 28450237
         OIL   UCBDMCT,UCBMOUNT,REF=UCBOB,WREGS=(,,RF) MOUNT ON@ZA00018 28450337
*                                                                       28450437
         MODESET EXTKEY=DATAMGT         DM KEY                   Y02082 28450537
*                                                                YM7310 28450637
         BR    RET                      RETURN                   YM7310 28450737
         EJECT                                                          28450837
*                                                                Y02134 28450937
*****************************************************************Y02134 28451037
*                                                                Y02134 28451137
*        FINISH MESSAGE                                          Y02134 28451402
*                                                                Y02134 28452002
*****************************************************************Y02134 28452602
*                                                                Y02134 28453202
WTO09300 EQU   *                                                 Y02134 28453802
*                                                                Y02134 28454402
         L     RF,WTGPREFX              FETCH PREFIX ADDRESS   @ZM30627 28454603
         STM   R0,RF,IECREGSV-IECPREFX(RF) SAVE REGS           @ZM30627 28454803
         L     RF,DXTCBADR              LOAD CURRENT TCB ADDRESS Y02134 28455002
         L     RF,TCBTIO-TCB(,RF)       LOAD TIOT ADDRESS        Y02134 28455602
         MVC   WTOJOB,TIOCNJOB-TIOT(RF) JOB NAME               @ZA01544 28456202
         MVC   WTOSTEP,TIOCSTEP-TIOT(RF) STEP NAME             @ZA01544 28456802
         OC    WTOJOB,BLANKS            FOLD TO UPPER CASE     @ZA01544 28457002
         CLI   WTOJOB,BLANK             IS JOBNAME PRESENT     @ZA01544 28457202
         BNE   WTO09310                 BRANCH IF PRESENT      @ZA01544 28457302
         MVI   WTOJOB,COMMA             PUT IN COMMA FOR       @ZA01544 28457502
*                                       SKIPPED FIELD          @ZA01544 28457702
WTO09310 EQU   *                                               @ZA01544 28457902
*                                                                Y02134 28458602
         OC    WTOSTEP,BLANKS           FOLD TO UPPER CASE     @ZA01544 28458802
         CLI   WTOSTEP,BLANK            IS STEPNAME PRESENT    @ZA01544 28459002
         BNE   WTO09311                 BRANCH IF PRESENT      @ZA01544 28459202
         MVI   WTOSTEP,COMMA            PUT IN COMMA FOR       @ZA01544 28459302
*                                       SKIPPED FIELD          @ZA01544 28459502
WTO09311 EQU   *                                               @ZA01544 28459702
*                                                              @ZA01544 28459902
*****************************************************************Y02134 28460002
*                                                                Y02134 28460202
*        REMOVE BLANKS FROM MESSAGE                            @ZA01544 28460402
*                                                                Y02134 28460602
*****************************************************************Y02134 28460802
*                                                                Y02134 28461002
*        NO. OF CHARACTERS TO MOVE (1 CHAR TO LEFT TO REMOVE BLANKS) =  28461602
*              LENGTH OF THE FIELD                                      28462202
*              - 1 (BECAUSE CHARACTER 1 DOES NOT MOVE)                  28462802
*              + 1 (FOR THE BLANK OFF THE END TO PAD WITH)              28463402
*              - 1 (BECAUSE MVC REQUIRES 1 LESS THAN TOTAL)             28464002
*                                                                       28464602
*        NO. OF CHARACTERS TO CHECK FOR BLANK =                         28465202
*              LENGTH OF THE FIELD                                      28465802
*              - 1 (BECAUSE NO NEED TO CHECK THE LAST ONE)              28466402
*                                                                       28467002
*        THEREFORE NUMBER TO TEST = NUMBER TO MOVE                      28467602
*                                                                       28468202
         LA    RF,WTOEND-WTOUNIT+K1     LENGTH OF LINE 1 SCAN  @ZA01544 28468803
         LA    R1,WTOUNIT-K1            INIT FOR LOOP          @ZA01544 28469402
*                                                                Y02134 28470002
WTO09312 EQU   *                        LOOP TO REMOVE BLANKS    Y02134 28470602
*                                                                Y02134 28471202
         CLI   K1(R1),BLANK             LOOK FOR BLANKS          Y02134 28471802
         BNE   WTO09316                 BRANCH GET NEXT          Y02134 28472402
*                                                                Y02134 28473002
         CLI   K0(R1),COMMA             COMMA PRESENT            Y02134 28473602
         BNE   WTO09314                 BRANCH TO INSERT COMMA   Y02134 28474202
*                                                                Y02134 28474802
         EX    RF,MOVE1                 MVC   K1(R0,R1),K2(R1)   Y02134 28475402
         B     WTO09318                 BRANCH TO CHECK NEXT     Y02134 28476002
*                                                                Y02134 28476602
WTO09314 EQU   *                        SET COMMA AT STRING END  Y02134 28477202
*                                                                Y02134 28477802
         MVI   K1(R1),COMMA             MOVE IN COMMA            Y02134 28478402
*                                                                Y02134 28479002
WTO09316 EQU   *                        CHECK NEXT CHARACTER     Y02134 28479602
*                                                                Y02134 28480202
         LA    R1,K1(,R1)               INCREMENT TO NEXT BYTE   Y02134 28480802
*                                                                Y02134 28481402
WTO09318 EQU   *                        TEST FOR END OF LINE 1   Y02134 28482002
*                                                                Y02134 28482602
         BCT   RF,WTO09312              CHECK NEXT CHARACTER     Y02134 28483202
         LR    RB,R1                    SAVE POINTER TO END+1  @ZA01544 28483402
         MVI   K0(R1),BLANK             BLANK LAST COMMA       @ZA01544 28483602
         MVI   WTOBREAK,COMMA           SET MSG BREAK CHAR     @ZA01544 28483702
         EJECT                                                          28483802
*                                                                Y02134 28484402
*****************************************************************Y02134 28485002
*                                                                Y02134 28485602
*        REMOVE BLANKS FROM WTOINSTR FIELD                     @ZA01544 28486202
*                                                                Y02134 28486802
*****************************************************************Y02134 28487402
*                                                                Y02134 28488002
*        IN ORDER TO LEFT JUSTIFY WTOINSTR FIELD:                       28488602
*        NO. OF CHARACTERS TO MOVE (1 CHAR TO LEFT TO REMOVE BLANKS) =  28489202
*              LENGTH OF THE FIELD (ALREADY INCLUDES BLANK AT END)      28489802
*              - 1 (BECAUSE CHARACTER 1 DOES NOT MOVE)                  28490402
*              - 1 (BECAUSE MVC REQUIRES 1 LESS THAN TOTAL)             28491002
*                                                                       28491602
*        NO. OF CHARACTERS TO CHECK FOR BLANK = 1                       28492202
*                                                                       28492802
         LA    RF,WTOUNIT-WTOINSTR-K2   GET MOVE LENGTH          YM3855 28493402
         LA    R1,WTOINSTR-K1           MOVE ADDRESS -1        @ZA01544 28494002
*                                                                Y02134 28494602
         CLI   WTOINSTR,BLANK           BLANK = D OR K MSG     @ZA01544 28495202
         BNE   WTO09319                 BRANCH IF CHAR EXISTS    Y02134 28495802
         EX    RF,MOVE1                 MVC   K1(R0,R1),K2(R1)   Y02134 28496402
*                                                                Y02134 28497002
WTO09319 EQU   *                        REMOVE BLANKS (WTOINSTR) YM3855 28497602
*                                                                Y02134 28498202
*        NO. OF CHARACTERS TO MOVE (1 CHAR TO LEFT TO REMOVE BLANKS) =  28498802
*              LENGTH OF THE FIELD                                      28499402
*              + 1 (TO INCLUDE LEADING BLANK)                           28500002
*              - 1 (BECAUSE CHARACTER 1 DOES NOT MOVE)                  28500602
*              + 1 (FOR THE BLANK OFF THE END TO PAD WITH)              28501202
*              - 1 (BECAUSE MVC REQUIRES 1 LESS THAN TOTAL)             28501802
*                                                                       28502402
*        NO. OF CHARACTERS TO CHECK FOR BLANK= UNTIL NON-BLANK IS FOUND 28503002
*                                                                       28503602
         LA    R1,WTOUNIT-K2-K1         MOVE ADDRESS -1        @ZA01544 28504802
         LR    RF,RB                    GET END POINTER        @ZA01544 28505002
         SR    RF,R1                    GET MOVE LENGTH        @ZA01544 28505202
*                                                                Y02134 28505402
WTO09320 EQU   *                        LOOP TO REMOVE BLANKS    Y02134 28506002
*                                                                Y02134 28506602
         CLI   K1(R1),BLANK             LOOK FOR BLANKS          Y02134 28507202
         BNE   WTO09332                 BRANCH GET NEXT        @ZM30627 28507803
*                                                                Y02134 28508402
         EX    RF,MOVE1                 MVC   K1(R0,R1),K2(R1)   Y02134 28509002
         BCTR  RB,R0                    DECREMENT END POINTER  @ZA01544 28509202
*                                                                Y02134 28509602
         BCT   R1,WTO09320              DECREMENT AND BRANCH     Y02134 28510202
         EJECT                                                          28510802
*                                                              @ZA01544 28511802
************************************************************** @ZA01544 28512802
*                                                              @ZA01544 28513802
*        ADD WTO PARAMETERS TO MESSAGE AND SPLIT INTO TWO      @ZA01544 28514802
*        LINES IF THE TEXT IS GREATER THAN 34 BYTES OR THREE   @ZA01544 28515802
*        LINES IF THE TEXT IS GREATER THAN 104 BYTES           @ZA01544 28516802
*                                                              @ZA01544 28517002
*        INPUT: RB = ADDRESS OF END OF MESSAGE TEXT + 1        @ZA01544 28517802
*               COMPRESSED MESSAGE STARTING AT 'WTOMSGID'      @ZA01544 28518802
*                                                              @ZA01544 28519802
*        OUTPUT: COMPLETED MESSAGE(S) READY FOR WTO(R)         @ZA01544 28520802
*                                                              @ZA01544 28521802
************************************************************** @ZA01544 28522802
*                                                              @ZA01544 28523802
WTO09330 EQU   *                                               @ZA01544 28524002
         L     RF,WTGPREFX              FETCH PREFIX ADDRESS   @ZA01544 28524802
         STM   R0,RF,IECREGSV-IECPREFX(RF) SAVE REGS           @ZA01544 28525802
WTO09332 EQU   *                                               @ZM30627 28526003
         LA    R1,MSG1MAX               GET MAX END OF MESSAGE @ZA01544 28526802
         CR    R1,RB                    WILL MSG FIT ON 1 LINE @ZA01544 28527002
         BL    WTO09335                 NO, BRANCH             @ZA01544 28527202
         LR    R1,RB                    POINT TO END+1         @ZA01544 28527302
         BCTR  R1,R0                    POINT TO END           @ZA01544 28527402
         B     WTO09345                 SKIP BREAK             @ZA01544 28527502
WTO09335 EQU   *                                               @ZA01544 28527602
         BCTR  R1,R0                    ADJUST START           @ZA01544 28527802
         CLC   K0(K1,R1),WTOBREAK       NATURAL BREAK          @ZA01544 28528202
         BE    WTO09340                 YES, BRANCH            @ZA01544 28528802
         B     WTO09335                 GO CHECK NEXT          @ZA01544 28529802
WTO09340 CLI   K0(R1),BLANK             BLANK ON END           @ZA01544 28530802
         BNE   WTO09345                 NO, BRANCH             @ZA01544 28531802
         BCT   R1,WTO09340              REMOVE BLANK FROM END  @ZA01544 28532802
WTO09345 LA    R4,K1(,R1)               SAVE PTR TO LAST BLANK @ZA01544 28533802
         LA    R2,WTOMSGID              POINT TO MSG START     @ZA01544 28534802
         SR    R1,R2                    GET MOVE LENGTH        @ZA01544 28535802
         EX    R1,MOVE2                 SPLIT MSG              @ZA01544 28536802
*MOVE2   MVC   MSG1STRT(R0),WTOMSGID                           @ZA01544 28537802
         EX    R1,FOLD1                 FOLD BLANKS            @ZA01544 28538002
         MVC   WTOSWTCH,WTOFLAGS        SET WTO FLAGS          @ZA01544 28538802
         LA    R1,MSG1STRT-WTOMSG1+K1(,R1) GET MSG 1 LENGTH    @ZA01544 28539802
         STH   R1,WTOLNGTH              STORE IN WTO PARMS     @ZA01544 28540802
         LA    R1,WTOMSG1-WTOBUFFR(R1,RD)  GET POINTER TO END  @ZA01544 28541802
         XC    WTOCODES-WTOEND(K4,R1),WTOCODES-WTOEND(R1) CODE @ZA01544 28542802
         MVC   WTOCODES+K2-WTOEND(L'WTODCODE,R1),WTODCODE DA   @ZA01544 28543802
         TM    UCBTBYT3,UCB3DACC        TEST FOR DA DEVICE     @ZA01544 28544802
         BO    WTO09350                 BRANCH IF DA           @ZA01544 28545802
         MVC   WTOCODES+K2-WTOEND(L'WTOTCODE,R1),WTOTCODE TAPE @ZA01544 28546802
WTO09350 OC    WTOCODES-WTOEND(K4,R1),WTODRCDS ROUT & DESC     @ZA01544 28547802
         MVC   WTOLINE1-WTOEND(L'WTOD,R1),WTOD LINE 1 TYPE     @ZA01544 28548802
         MVI   WTONLINE-WTOEND(R1),K2  INDICATE 2 LINES        @ZA01544 28550802
         MVC   WTOLGTH2-WTOEND(L'WTOLGTHE,R1),WTOLGTHE SET     @ZA01544 28551802
*                                       LENGTH AND TYPE-LINE 2 @ZA01544 28552802
         CR    R4,RB                    2ND LINE NEEDED        @ZA01544 28553802
         BE    WTO09375                 IF NOT, BRANCH         @ZA01544 28554802
         MVI   WTONLINE-WTOEND(R1),K3   INDICATE 3 LINES       @ZA01544 28555002
         LA    RC,WTOMSG2-WTOCODES(R1)  POINT TO LINE 2        @ZA01544 28555202
         MVC   WTOLINE2-WTOMSG2(K2,RC),WTOD RESET LINE TYPE    @ZA01544 28555402
         MVC   WTOMSID2-WTOMSG2(K8,RC),MSG1STRT PROPAGATE ID   @ZA01544 28555602
         LA    R1,62(R4)                MAX END OF LINE 2      @ZA01544 28555702
         LR    RA,R4                    SAVE PTR TO LINE 1 END @ZA01544 28555902
         CR    R1,RB                    MSG FIT ON 2 LINES     @ZA01544 28556102
         BL    WTO09355                 NO, BRANCH             @ZA01544 28556302
         LR    R1,RB                    POINT TO END+1         @ZA01544 28556402
         BCTR  R1,R0                    POINT TO END           @ZA01544 28556602
         B     WTO09365                 SKIP BREAK             @ZA01544 28556702
WTO09355 EQU   *                                               @ZA01544 28556902
         BCTR  R1,R0                    ADJUST START           @ZA01544 28557202
         CLC   K0(K1,R1),WTOBREAK       NATURAL BREAK          @ZA01544 28557302
         BE    WTO09360                 YES, BRANCH            @ZA01544 28557502
         B     WTO09355                 GO CHECK NEXT          @ZA01544 28557602
WTO09360 CLI   K0(R1),BLANK             BLANK ON END           @ZA01544 28557802
         BNE   WTO09365                 NO, BRANCH             @ZA01544 28557902
         LA    RA,K1(RA)                ADJUST LINE BEGIN      @ZA01544 28558002
         BCT   R1,WTO09360              REMOVE BLANK FROM END  @ZA01544 28558102
WTO09365 LA    R4,K1(,R1)               SAVE PTR TO LAST BLANK @ZA01544 28558202
         SR    R1,RA                    GET LENGTH OF LINE 2   @ZA01544 28558402
         EX    R1,MOVE3                 SPLIT MESSAGE          @ZA01544 28558502
         EX    R1,FOLD2                 FOLD BLANKS            @ZA01544 28558602
         LA    R1,WTOEND2-WTOMSG2+K1(R1) LINE 2 LENGTH         @ZA01544 28558702
         STCM  R1,B'0011',WTOLGTH2-WTOLGTH2(RC) STORE LENGTH   @ZA01544 28558902
         LA    RC,WTOEND2-WTOEND2(R1,RC) POINT TO END          @ZA01544 28559002
         MVC   WTOLGTH2-WTOMSG2(L'WTOLGTHE,RC),WTOLGTHE        @ZA01544 28559402
         CR    R4,RB                    LINE 3 NEEDED          @ZA01544 28559502
         BE    WTO09375                 NO, BRANCH             @ZA01544 28559602
         CLI   WTOBREAK,BLANK           CHKPT MESSAGE          @ZA01544 28560102
         BNE   WTO09370                 NO, BRANCH             @ZA01544 28560202
         LA    R4,K1(R4)                BEGINING OF LAST LINE  @ZA01544 28560402
         LR    RA,R4                    SET FOR EXECUTE MOVE   @ZA01544 28560602
         LR    R1,RB                    POINT TO END+1         @ZA01544 28560702
         BCTR  R1,R0                    POINT TO END           @ZA01544 28560902
         SR    R1,R4                    GET LENGTH OF MOVE     @ZA01544 28561102
         EX    R1,MOVE3                 MOVE LAST LINE         @ZA01544 28561202
WTO09370 EQU   *                                               @ZA01544 28561302
         SR    RB,R4                    GET LENGTH OF LINE 3   @ZA01544 28561902
         BCTR  RB,R0                    DECREMENT FOR OR       @ZA01544 28562002
         EX    RB,FOLD2                 FOLD BLANKS            @ZA01544 28562202
         LA    RB,WTOEND2-WTOMSG2+K1(,RB) LINE 3 LNGTH         @ZA01544 28562602
         STCM  RB,B'0011',WTOLGTH2-WTOMSG2(RC) STORE LENGTH    @ZA01544 28562702
         MVC   WTOLINE2-WTOMSG2(L'WTODE,RC),WTODE LINE 3 TYPE  @ZA01544 28562802
         MVC   WTOMSID2-WTOMSG2(K8,RC),MSG1STRT PROPAGATE ID   @ZA01544 28563402
WTO09375 EQU   *                                               @ZM34658 28563503
         L     RF,WTGPREFX              FETCH PREFIX ADDRESS   @ZM34658 28563603
         LM    R0,RF,IECREGSV-IECPREFX(RF) RESTORE REGS        @ZM34658 28563703
         BR    RET                      RETURN                 @ZA01544 28563803
*                                                                Y02134 28612802
MOVE1    MVC   K1(R0,R1),K2(R1)         FILL BLANKS ON LEFT AND  Y02134 28613402
*                                       PROPAGTE BLANKS ON RIGHT Y02134 28614002
*                                                              @ZA01544 28616602
MOVE2    MVC   MSG1STRT(R0),WTOMSGID    SPLIT MSG              @ZA01544 28616802
*                                                              @ZA01544 28616902
FOLD1    OC    MSG1STRT(R0),BLANKS                             @ZA01544 28617002
*                                                              @ZA01544 28617202
MOVE3    MVC   WTOEND2-WTOMSG2(R0,RC),K0(RA) SPLIT FOR LINE 3  @ZA01544 28617302
*                                                              @ZA01544 28617502
FOLD2    OC    WTOEND2-WTOMSG2(R0,RC),BLANKS                   @ZA01544 28617702
         EJECT                                                          28617802
*                                                                Y02134 28618002
*****************************************************************Y02134 28618202
*                                                                Y02134 28618802
*        CLEAR UCB FOR UNLOAD                                    Y02134 28619402
*                                                                Y02134 28620002
*****************************************************************Y02134 28670002
*                                                                Y02134 28720002
WTO09400 EQU   *                                                 Y02134 28770002
*                                                                Y02134 28820002
         L     RF,WTGPREFX              LOAD POINTER TO PREFIX   Y02134 28820202
         ST    RD,IECREGSV-IECPREFX(,RF) SAVE REGISTER 13        Y02134 28820402
         LA    RD,IECREGSV+K4-IECPREFX(,RF) IOSGEN SAVE AREA     Y02134 28820602
*                                                                Y02134 28820802
         MODESET EXTKEY=ZERO            KEY 0 FOR IOSGEN         Y02082 28821502
*                                                                Y02134 28821702
         IOSGEN UCBFLG,UCB=(RUCB),VAR=ON,TABLE=UCBNRY  NOT READY YM5390 28821902
*                                                                Y02134 28822102
         MODESET EXTKEY=DATAMGT         RETURN TO DATA MGMNT KEY Y02082 28822302
         L     RD,IECREGSV-IECPREFX(,RF) RESTORE REGISTER 13     Y02134 28823402
*                                                                Y02134 28823602
         L     RF,WTGPREFX              LOAD PREFIX ADDRESS      Y02134 28823802
         STM   R0,RF,IECREGSV-IECPREFX(RF) SAVE REGISTERS        Y02134 28823902
*                                                                Y02134 28824002
         MODESET EXTKEY=ZERO            SETLOCK KEY              Y02082 28824102
*                                                                Y02134 28824202
WTO09410 SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                  Y02134X28824402
               RELATED=(LOCAL,IFG0194J(WTO09420))                Y02134 28824602
*                                                                Y02134 28825002
         MODESET EXTKEY=DATAMGT         RETURN TO DATA MGMNT KEY Y02082 28825402
*                                                                Y02134 28825802
         LTR   RD,RD                    TEST FOR SETLOCK ERROR   Y02134 28826202
         LM    R0,RF,IECREGSV-IECPREFX(RF) RESTORE REGISTERS     Y02134 28826602
         BNZ   WTO10000                 BRANCH IF SETLOCK ERROR  Y02134 28827602
*                                                                Y02134 28827802
         MODESET EXTKEY=SUPR            UCB KEY                  Y02082 28832602
*                                                                Y02134 28832702
         XC    UCBVOLI,UCBVOLI          CLEAR VOL SERIAL NO.     Y02134 28833102
         NI    UCBDMCT,ALLBITS-UCBMOUNT RESET MOUNT BIT          YM7503 28833502
         NI    UCBJBNR,ALLBITS-UCBMONT  SET PASS TO 0            YM1472 28834002
         NI    UCBSTAB,ALLBITS-(UCBBPRV+UCBBPUB) SET PRIVATE   @ZA02881 28834237
*                                       AND PUBLIC TO ZERO     @ZA02881 28834437
         NI    UCBSTAT,ALLBITS-UCBDADI  SET SL TO 0              YM1472 28834602
*                                                                Y02134 28834702
         L     RF,UCBEXTPT              LOAD UCB EXTENSION PTR   Y02146 28834902
         USING UCBCMEXT,RF              RF POINTS TO EXTENSION   Y02146 28836102
         NI    UCBFLP1,ALLBITS-UCBNSRCH RESET NONSCRATCH         YM7503 28836202
         DROP  RF                                                Y02146 28836902
*                                                                Y02134 28837002
         TM    UCBTBYT3,UCB3TAPE        TEST FOR TAPE UNIT       Y02134 28837202
         BNO   WTO09415                 BRANCH IF NOT TAPE       Y02134 28837402
*                                                                Y02134 28837602
         XC    UCBFSER,UCBFSER          CLEAR MCS IDS            Y02134 28837702
         XC    UCBFSCT,UCBFSCT          CLEAR FILE COUNTERS      Y02134 28838802
         XC    UCBFSEQ,UCBFSEQ          CLEAR FILE SEQ COUNTERS  Y02134 28839202
         NI    UCBWGT,ALLBITS-UCBREW    SET REWIND OFF           YM3925 28839302
         NI    UCBSTAB,ALLBITS-(UCBBNUL+UCBBSTR) CLR DOM FLG   @ZA02881 28839637
*                                       AND SET AL TO ZERO     @ZA02881 28839937
         NI    UCBTFL1,ALLBITS-(UCBNLTP+UCBNSLTP+UCBDQDSP) NL/ @ZA18506*28841037
                                        NSL/DEQ RESET          @ZA18506 28844037
WTO09415 EQU   *                        RELEASE LOCAL LOCK       Y02134 28848202
*                                                                Y02134 28853202
         L     RF,WTGPREFX              LOAD PREFIX ADDRESS      YM3221 28855202
*                                                                YM3221 28857202
         MODESET EXTKEY=ZERO            SETLOCK KEY              Y02134 28858202
*                                                                Y02134 28868002
WTO09420 SETLOCK RELEASE,TYPE=LOCAL,                             Y02134X28869002
               RELATED=(LOCAL,IFG0194J(WTO09410))                Y02134 28869202
*                                                                Y02134 28869902
         MODESET EXTKEY=DATAMGT         DM KEY                   Y02082 28870002
*                                                                Y02134 28871002
         LTR   RD,RD                    TEST FOR SETLOCK ERROR   Y02134 28874902
         LM    R0,RF,IECREGSV-IECPREFX(RF) RESTORE REGISTERS     Y02134 28875902
         BNZ   WTO10000                 BRANCH IF SETLOCK ERROR  Y02134 28876902
*                                                                Y02134 28877902
         BR    RET                      RETURN                   Y02134 28879902
         EJECT                                                          28889902
*                                                                       28890002
*********************************************************************** 28890102
*                                                                       28890202
*        CLEAR DISPOSITION FOR VOLUME REJECT                            28890302
*                                                                       28890402
*********************************************************************** 28890502
*                                                                       28890602
WTO09450 EQU   *                        CLEAR DISPOSITION      @ZA00700 28890702
*                                                                       28890802
         L     RF,WTGPREFX              LOAD PREFIX ADDRESS    @ZA00700 28890902
         STM   R0,RF,IECREGSV-IECPREFX(RF) SAVE REGISTERS      @ZA00700 28891002
*                                                                       28891102
         MODESET EXTKEY=ZERO            SETLOCK KEY            @ZA00700 28891202
*                                                                       28891302
WTO09460 SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                @ZA00700X28891402
               RELATED=(LOCAL,IFG0194J(WTO09470))              @ZA00700 28891502
*                                                                       28892202
         LM    R0,RF,IECREGSV-IECPREFX(RF) SAVE REGISTERS      @ZA00700 28892302
*                                                                       28892402
         NI    UCBSTAB,ALLBITS-(UCBBPRV+UCBBPUB) SET PRIVATE   @ZA02881 28892837
*                                       AND PUBLIC TO ZERO     @ZA02881 28892937
         NI    UCBJBNR,ALLBITS-UCBMONT  SET PASS TO 0          @ZA00700 28893002
*                                                                       28893102
WTO09470 SETLOCK RELEASE,TYPE=LOCAL,                           @ZA00700X28894702
               RELATED=(LOCAL,IFG0194J(WTO09460))              @ZA00700 28894802
*                                                                       28895002
         MODESET EXTKEY=DATAMGT         DM KEY                 @ZA00700 28895102
*                                                                       28895202
         L     RF,WTGPREFX              LOAD PREFIX ADDRESS    @ZA00700 28895302
         LM    R0,RF,IECREGSV-IECPREFX(RF) RESTORE REGISTERS   @ZA00700 28895402
*                                                                       28895502
         BR    RET                      RETURN                 @ZA00700 28895602
         EJECT                                                          28895702
*                                                                Y02134 28920002
*****************************************************************Y02134 28970002
*                                                                Y02134 29020002
*        GET DSNAME FOR MESSAGE                                  Y02134 29070002
*                                                                Y02134 29120002
*****************************************************************Y02134 29170002
*                                                                Y02134 29220002
WTO09500 EQU   *                                                 Y02134 29270002
*                                                                Y02134 29320002
         LA    R1,DXJBF                 WORK AREA JFCB           Y02134 29330002
         CLC   DXDSAB,DXDSABAD          CONCATENATION CHECK      Y02134 29340002
         BE    WTO09510                 BRANCH IF NO CONCATENATN Y02134 29350002
         LA    R1,TIOEJFCB              POINTER TO JFCB PREFIX   Y02134 29370002
         IECRES LOCJFCB,(R1)            LOCATE JFCB              Y02134 29420002
*                                                                Y02134 29470002
WTO09510 EQU   *                        R1 POINTS TO DSNAME      Y02134 29472002
*                                                                Y02134 29480002
         TM    JFCBIND2-INFMJFCB(R1),JFCTEMP TEMPORARY DATA SET  Y02134 29520002
         BO    WTO09530                 YES, DSNAME NOT REQUIRED Y02134 29570002
         L     RF,CVTPTR                LOAD CVT POINTER         Y02134 29575002
         L     RF,CVTMSLT-CVT(,RF)      MASTER SCHED LINK TABLE  Y02134 29620002
         TM    BAMONITR-BASE(RF),BADSN  MONITOR DSNAMES ACTIVE   Y02080 29670002
         BNO   WTO09530                 NO, BRANCH               Y02134 29720002
*                                                                Y02134 29770002
WTO09520 EQU   *                        DSNAME TO MESSAGE        Y02134 29780002
*                                                                Y02134 29790002
         MVC   WTODSN,JFCBDSNM-INFMJFCB(R1)  MOVE DSNAME       @ZA01544 29820002
*                                                                Y02134 30070002
WTO09530 EQU   *                        RETURN                   Y02134 30120002
*                                                                Y02134 30170002
         BR    RET                      RETURN                   Y02134 30220002
         EJECT                                                          30230002
*                                                              @ZA18506 30230937
************************************************************** @ZA18506 30231837
*                                                              @ZA18506 30232737
*        DEQ TAPE VOLUME SERIAL IF UCB INDICATES TO DO SO.     @ZA18506 30233637
*        MESSAGE AREA ADDRESS PASSED IN RD.                    @ZA18506 30234537
*                                                              @ZA18506 30235437
************************************************************** @ZA18506 30236337
*                                                              @ZA18506 30237237
WTO09550 EQU   *                                               @ZA18506 30238137
*                                                              @ZA18506 30239037
         TM    UCBTBYT3,UCB3TAPE        IS IT A TAPE           @ZA18506 30239937
         BZR   RET                      RETURN IF NO           @ZA18506 30240837
         TM    UCBTFL1,UCBDQDSP         IS DEQ REQUIRED        @ZA18506 30241737
         BZR   RET                      RETURN IF NOT          @ZA18506 30242637
*                                                              @ZA18506 30243537
*        USE MESSAGE AREA ADDRESSED BY RD                      @ZA18506 30244437
*                                                              @ZA18506 30245337
         ST    RET,DEQRTN               SAVE RETURN            @ZA18506 30246237
         MVC   DEQLIST,DEQPLIST         MOVE PARMLIST FOR DEQ  @ZA18506 30247137
         L     R1,DXJSCBAD              ACTIVE JSCB            @ZA18506 30248037
         USING IEZJSCB,R1                                      @ZA18506 30248937
         L     R0,JSCBTCBP              INITIATOR TCB          @ZA18506 30249837
         DROP  R1                                              @ZA18506 30250737
         LA    RF,UCBVOLI               ADDRESS VOLSER IF UCB  @ZA18506 30251637
         CLC   UCBVOLI,ZEROS            IS VOLSER IN UCB       @ZA18506 30252537
         BNZ   WTO09560                 BR IF VOLSER IN UCB    @ZA18506 30253437
         LA    RF,DXVOLSR1              ADDRESS VOLSER         @ZA18506 30254337
*                                                              @ZA18506 30255237
WTO09560 EQU   *                        DEQ VOLUME SERIAL      @ZA18506 30256137
*                                                              @ZA18506 30257037
         DEQ   (,(RF)),TCB=(0),MF=(E,DEQ),RET=HAVE DEQ VOLSER  @ZA18506 30257937
*                                                              @ZA18506 30258837
         L     RET,DEQRTN               RESTORE RETURN         @ZA18506 30259737
         B     WTO05010                 BLANK BUFFER & RETURN  @ZA18506 30260637
*                                                              @ZA18506 30261537
DEQPLIST DS    0F                       DEQ PARMLIST           @ZA18506 30262437
         DEQ   (SYSZVOLS,,6,SYSTEM),TCB=0,MF=L DEQ PARMLIST    @ZA18506 30263337
DEQPLTH  EQU   *-DEQPLIST               LENGTH OF PARMLIST     @ZA18506 30264237
SYSZVOLS DC    C'SYSZVOLS'              MAJOR NAME             @ZA18506 30265137
         EJECT                                                          30266037
*                                                                Y02134 30270002
*****************************************************************Y02134 30320002
*                                                                Y02134 30370002
*        GET LABEL TYPE FOR TAPE MESSAGE FROM UCB                Y02134 30420002
*                                                                Y02134 30470002
*****************************************************************Y02134 30520002
*                                                                Y02134 30570002
WTO09600 EQU   *                                                 Y02134 30620002
*                                                                Y02134 30670002
         TM    UCBTBYT3,UCB3TAPE        TEST FOR TAPE            Y02134 30720002
         BNO   WTO09645                 BRANCH IF NOT TAPE     @ZA01544 30770002
*                                                                Y02134 30820002
         TM    UCBSTAT,UCBDADI          TEST FOR SL VOLUME       Y02134 30825002
         BNO   WTO09610                 BRANCH IF NOT SL         Y02134 30830002
         MVC   WTOLBLTP(L'SLCHAR),SLCHAR MOVE SL TO MESSAGE    @ZA01544 30835002
         B     WTO09640                 BRANCH TO RETURN         Y02134 30845002
*                                                                Y02134 30850002
WTO09610 EQU   *                        TEST FOR AL TAPE         Y02134 30855002
*                                                                Y02134 30860002
         TM    UCBSTAB,UCBBSTR          TEST FOR ANSI VOLUME     Y02134 30867002
         BNO   WTO09620                 BRANCH IF NOT ANSI VOL   Y02134 30868002
         MVC   WTOLBLTP(L'ALCHAR),ALCHAR MOVE AL TO MESSAGE    @ZA01544 30869002
         B     WTO09640                 BRANCH TO RETURN         Y02134 30869202
*                                                                Y02134 30869602
WTO09620 EQU   *                        TEST FOR NL TAPE         Y02134 30869802
*                                                                Y02134 30869902
         TM    UCBTFL1,UCBNLTP          TEST FOR NL VOLUME       Y02134 30876902
         BNO   WTO09630                 BRANCH IF NOT NL VOL     Y02134 30877102
         MVC   WTOLBLTP(L'NLCHAR),NLCHAR MOVE NL TO MESSAGE    @ZA01544 30877302
         B     WTO09640                 BRANCH TO RETURN         Y02134 30877502
*                                                                Y02134 30878102
WTO09630 EQU   *                        TEST FOR NSL TAPE        Y02134 30878302
*                                                                Y02134 30878502
         TM    UCBTFL1,UCBNSLTP         TEST FOR NSL VOLUME      Y02134 30878702
         BNO   WTO09640                 BRANCH, VOL NOT IDENTIFD Y02134 30878802
         MVC   WTOLBLTP(L'NSLCHAR),NSLCHAR MOVE NSL TO MSSAGE  @ZA01544 30883802
*                                                                Y02134 30888802
WTO09640 EQU   *                        RETURN                   Y02134 30893802
*                                                                Y02134 30898802
         CLI   WTOLBLTP,BLANK           IS LABEL TYPE PRESENT  @ZA01544 30900802
         BCR   K7,RET                   RETURN IF PRESENT      @ZA01544 30901802
         MVI   WTOLBLTP,COMMA           PUT IN COMMA FOR       @ZA01544 30902802
*                                       SKIPPED FIELD          @ZA01544 30903802
WTO09645 EQU   *                        RETURN                 @ZA01544 30904803
         BR    RET                      RETURN                   Y02134 30920002
         EJECT                                                          30922002
*                                                                Y02134 30925002
*****************************************************************Y02134 30930002
*                                                                Y02134 30935002
*        GET LABEL TYPE FOR TAPE MESSAGE FROM JFCB               Y02134 30940002
*                                                                Y02134 30945002
*****************************************************************Y02134 30950002
*                                                                Y02134 30955002
WTO09650 EQU   *                                                 Y02134 30960002
*                                                                Y02134 30965002
         TM    UCBTBYT3,UCB3TAPE        TEST FOR TAPE            Y02134 30966002
         BNO   WTO09698                 BRANCH IF NOT TAPE     @ZA02881 30967037
*                                                                YM4647 30967102
WTO09654 EQU   *                        TEST FOR DENSITY       @ZA02881 30969137
*                                                              @ZA02881 30970137
         TM    DXDEBMOD,DEN1600         IS THIS NINE TRK UNIT  @ZA02881 30971137
         BO    WTO09658                 BRANCH TO TEST DEN     @ZA02881 30972137
*                                                              @ZA02881 30973137
         BZ    WTO09668                 BRANCH, DENSITY IS 200 @ZA02881 30974137
*                                                              @ZA02881 30975137
         TM    DXDEBMOD,DCBDEN08        TEST FOR 800 BPI       @ZA02881 30976137
         BZ    WTO09666                 BRANCH IF 556          @ZA02881 30977137
         B     WTO09664                 BRANCH, MOVE 800 BPI   @ZA02881 30978137
*                                                              @ZA02881 30979137
WTO09658 EQU   *                        TEST FOR 1600 BPI      @ZA02881 30980137
*                                                              @ZA02881 30981137
         CLI   DXDEBMOD,DX800           IS THIS 800 BPI        @ZA02881 30982137
         BE    WTO09664                 BRANCH, MOVE 800 BPI   @ZA02881 30983137
*                                                              @ZA02881 30984137
         CLI   DXDEBMOD,DCBD6250        IS THIS 6250 BPI       @ZA02881 30985137
         BE    WTO09662                 BRANCH, MOVE 6250 BPI  @ZA02881 30986137
*                                                              @ZA02881 30987137
         CLI   DXDEBMOD,DCBD1600        IS THIS 1600 BPI       @ZA02881 30988137
         BNE   WTO09670                 BRANCH TO SKIP         @ZA02881 30989137
*                                                              @ZA02881 30990137
         MVC   WTODEN(L'BPICN160),BPICN160 MOVE IN 1600 BPI    @ZA02881 30991137
         B     WTO09670                 BRANCH TO GET LBL TYPE @ZA02881 30992137
*                                                              @ZA02881 30993137
WTO09662 EQU   *                        SET 6250 BPI           @ZA02881 30994137
*                                                              @ZA02881 30995137
         MVC   WTODEN(L'BPICN625),BPICN625  MOVE IN 6250 BPI   @ZA02881 30996137
         B     WTO09670                 BRANCH TO GET LBL TYPE @ZA02881 30997137
*                                                              @ZA02881 30998137
WTO09664 EQU   *                        SET 800 BPI            @ZA02881 30999137
*                                                              @ZA02881 31000137
         MVC   WTODEN(L'BPICON80),BPICON80 MOVE IN 800 BPI     @ZA02881 31001137
         B     WTO09670                 BRANCH TO GET LBL TYPE @ZA02881 31002137
*                                                              @ZA02881 31003137
WTO09666 EQU   *                        SET 556 BPI            @ZA02881 31004137
*                                                              @ZA02881 31005137
         MVC   WTODEN(L'BPICON55),BPICON55 MOVE IN 556 BPI     @ZA02881 31006137
         B     WTO09670                 BRANCH TO GET LBL TYPE @ZA02881 31007137
*                                                              @ZA02881 31008137
WTO09668 EQU   *                        SET 200 BPI            @ZA02881 31009137
*                                                              @ZA02881 31010137
         MVC   WTODEN(L'BPICON20),BPICON20 MOVE IN 200 BPI     @ZA02881 31011137
*                                                              @ZA02881 31012137
WTO09670 EQU   *                                               @ZA02881 31013137
*                                                                       31013337
         CLI   WTODEN,BLANK             IS DENSITY PRESENT     @ZA02881 31014137
         BNE   WTO09674                 RETURN IF PRESENT      @ZA02881 31015137
         MVI   WTODEN,COMMA             PUT IN COMMA FOR       @ZA02881 31016137
*                                       SKIPPED FIELD          @ZA02881 31017137
WTO09674 EQU   *                        FIND LABEL TYPE        @ZA02881 31017337
*                                                                       31017537
         TM    JFCBLTYP,JFCBLP          CHECK FOR BLP REQUEST  @ZA02881 31018137
         BNO   WTO09678                 BR IF NOT BLP REQUEST  @ZA02881 31019137
         MVC   WTOLBLTP(L'BLPCHAR),BLPCHAR MOVE BLP TO MESSAGE @ZA02881 31020137
         B     WTO09694                 BRANCH TO RETURN       @ZA02881 31021137
*                                                              @ZA02881 31022137
WTO09678 EQU   *                        TEST FOR SL REQUEST    @ZA02881 31023137
*                                                              @ZA02881 31024137
         TM    JFCBLTYP,JFCSL           CHECK FOR SL REQUEST   @ZA02881 31025137
         BNO   WTO09682                 BR IF NOT SL REQUEST   @ZA02881 31026137
         MVC   WTOLBLTP(L'SLCHAR),SLCHAR MOVE SL TO MESSAGE    @ZA02881 31027137
         B     WTO09694                 BRANCH TO RETURN       @ZA02881 31028137
*                                                              @ZA02881 31029137
WTO09682 EQU   *                        TEST FOR AL REQUEST    @ZA02881 31030137
*                                                              @ZA02881 31031137
         TM    JFCBLTYP,JFCBAL          TEST FOR AL REQUEST    @ZA02881 31032137
         BNO   WTO09686                 BR IF NOT AL REQUEST   @ZA02881 31033137
         MVC   WTOLBLTP(L'ALCHAR),ALCHAR MOVE AL TO MESSAGE    @ZA02881 31034137
         B     WTO09694                 BRANCH TO RETURN       @ZA02881 31035137
*                                                              @ZA02881 31036137
WTO09686 EQU   *                        TEST FOR NL REQUEST    @ZA02881 31037137
*                                                              @ZA02881 31038137
         TM    JFCBLTYP,JFCNL           CHECK FOR NL REQUEST   @ZA02881 31039137
         BNO   WTO09690                 BR IF NOT NL REQUEST   @ZA02881 31040137
         MVC   WTOLBLTP(L'NLCHAR),NLCHAR MOVE NL TO MESSAGE    @ZA02881 31041137
         B     WTO09694                 BRANCH TO RETURN       @ZA02881 31042137
*                                                              @ZA02881 31043137
WTO09690 EQU   *                        TEST FOR NSL REQUEST   @ZA02881 31044137
*                                                              @ZA02881 31045137
         TM    JFCBLTYP,JFCNSL          CHECK FOR NSL REQUEST  @ZA02881 31046137
         BNO   WTO09694                 BR IF NOT NSL REQEST   @ZA02881 31047137
         MVC   WTOLBLTP(L'NSLCHAR),NSLCHAR MOVE NSL TO MSG     @ZA02881 31048137
*                                                              @ZA02881 31049137
WTO09694 EQU   *                                               @ZA02881 31053837
*                                                                Y02134 31056502
         CLI   WTOLBLTP,BLANK           LABEL TYPE PRESENT     @ZA01544 31057537
         BCR   K7,RET                   YES, BRANCH            @ZA02881 31058537
         MVI   WTOLBLTP,COMMA           PUT IN COMMA FOR       @ZA01544 31058737
*                                       SKIPPED FIELD          @ZA01544 31058902
WTO09698 EQU   *                        RETURN                 @ZA02881 31060837
         BR    RET                      RETURN                   Y02134 31061002
         EJECT                                                          31061902
*                                                                Y02134 31064602
*****************************************************************Y02134 31067302
*                                                                Y02134 31070002
*        GET SPACE INFORMATION AND WRITE SMF RECORD 19           Y02134 31120002
*                                                                Y02134 31170002
*****************************************************************Y02134 31220002
*                                                                Y02134 31270002
WTO09700 EQU   *                                                 Y02134 31320002
*                                                                Y02134 31370002
         TM    UCBTBYT3,UCB3TAPE        TEST FOR TAPE            Y02134 31420002
         BO    WTO09740                 BRANCH IF TAPE           Y02134 31470002
*                                                                Y02134 31520002
         TM    UCBDMCT,UCBMOUNT         UNSATISFIED MOUNT        YM7503 31530002
         BO    WTO09740                 BRANCH IF PENDING        YM7503 31540002
*                                                                YM7503 31550002
         XR    R1,R1                    CLEAR REG FOR LSPACE     Y02134 31570002
         L     RF,CVTPTR                LOAD CVT POINTER         Y02134 31575002
         L     RF,CVTMSLT-CVT(,RF)      MASTER SCHED LINK TABLE  Y02134 31620002
         TM    BAMONITR-BASE(RF),BASPACE MONITOR SPACE ACTIVE    Y02080 31670002
         BNO   WTO09710                 BRANCH IF NO             Y02080 31720002
         LA    R1,WTOSPACE              POINTER TO SPACE AREA  @ZA01544 31770002
*                                                                Y02134 31820002
WTO09710 EQU   *                        TEST FOR SMF ACTIVE      Y02134 31870002
*                                                                Y02134 31920002
         L     RF,CVTPTR                LOAD CVT POINTER         Y02134 31925002
         L     RF,CVTSMCA-CVT(,RF)      GET SMCA ADDRESS         Y02134 31970002
         LTR   RF,RF                    TEST FOR SMF SYSTEM      Y02134 32020002
         BZ    WTO09720                 BRANCH IF NON-SMF SYSTEM Y02134 32070002
*                                                                Y02134 32120002
         TM    SMCAOPT-SMCABASE(RF),SMCAVOL TEST IF SMF VOL ACCT Y02134 32170002
         BZ    WTO09720                 BRANCH IF NO ACCT'G      Y02134 32220002
*                                                                Y02134 32270002
         LA    RF,X80                   SET UP LSPACE SMF FLAG   Y02134 32320002
         SLL   RF,K24                   MOVE FLAG TO BIT 0       Y02134 32370002
         OR    R1,RF                    PUT FLAG INTO PARM REG   Y02134 32420002
*                                                                Y02134 32470002
WTO09720 EQU   *                        CALL LSPACE              Y02134 32520002
*                                                                Y02134 32570002
         LTR   R1,R1                    IS LSPACE SVC REQUIRED   Y02134 32620002
         BZ    WTO09740                 BRANCH IF NOT, RETURN    Y02134 32670002
*                                                                Y02134 32720002
         LA    R0,UCBOB                 PT TO UCB IN REG 0       Y02134 32770002
LSPACE   EQU   78                       LSPACE SVC NUMBER        YM3925 32772002
         SVC   LSPACE                   ISSUE SPACE SVC          Y02134 32820002
*                                                                Y02134 32970002
         CLI   WTOSPACE,BLANK           INFO PRESENT           @ZA01544 32971002
         BE    WTO09735                 NO, BRANCH             @ZA01544 32972002
         LA    R1,WTODEN                POINT TO END OF SPACE  @ZA01544 32973002
         LA    RF,WTOSPACE              POINT TO BEGIN         @ZA01544 32974002
         SR    R1,RF                    FIND LENGTH            @ZA01544 32975002
         BCTR  R1,R0                    DECREMENT              @ZA01544 32976002
WTO09722 CLI   K0(RF),COMMA             IS THIS A COMMA        @ZA01544 32977002
         BE    WTO09725                 YES, BRANCH            @ZA01544 32978002
         CLI   K0(RF),BLANK             IS THIS A BLANK        @ZA01544 32979002
         BNE   WTO09730                 NO, BRANCH             @ZA01544 32980002
         CLI   K1(RF),BLANK             IS THIS THE END        @ZA01544 32981002
         BE    WTO09740                 YES, BRANCH            @ZA01544 32982002
WTO09725 NI    K0(RF),LOWCASE           MAKE LOWER CASE        @ZA01544 32983002
WTO09730 LA    RF,K1(RF)                CHECK NEXT CHAR        @ZA01544 32984002
         BCT   R1,WTO09722              GO CHECK NEXT          @ZA01544 32985002
         BR    RET                      RETURN                 @ZA01544 32986002
WTO09735 MVI   WTOSPACE,COMMA           SET FOR SKIPPED FIELD  @ZA01544 32987002
WTO09740 EQU   *                        RETURN                   Y02134 33570002
*                                                                Y02134 33620002
         BR    RET                      RETURN                   Y02134 33670002
         EJECT                                                          33680002
*                                                                Y02134 33720002
*****************************************************************Y02134 33770002
*                                                                Y02134 33820002
*        REWIND UNLOAD TAPE UNIT                                 Y02134 33870002
*                                                                Y02134 33920002
*****************************************************************Y02134 33970002
*                                                                YM1472 33980002
*        NOTE- THIS ROUTINE MUST BE EXECUTED BEFORE CLEARING     YM1472 33990002
*              THE MESSAGE AREA. SEE LABEL WTO05000.             YM1472 34000037
*                                                                YM1472 34002002
*****************************************************************YM1472 34010002
*                                                                Y02134 34020002
WTO09800 EQU   *                                                 Y02134 34070002
*                                                                Y02134 34168002
         TM    UCBFL1,UCBNOTRD          TEST IF NOT READY        YM7503 34168402
         BO    WTO09820                 BRANCH NOT READY         YM7503 34168802
*                                                                YM7503 34169202
         TM    UCBTBYT3,UCB3TAPE        TEST FOR TAPE            Y02134 34170002
         BNO   WTO09810                 BRANCH IF NOT TAPE       Y02134 34220002
*                                                                YM7503 34230002
         TM    UCBDMCT,UCBMOUNT         UNSATISFIED MOUNT        YM7503 34240002
         BO    WTO09805                 BRANCH TO UNLOAD         YM7503 34250002
*                                                                YM6449 34270002
*        VOLSTAT (0)                    ISSUE VOLUME STATISTICS  A46383 34320002
*                                                                YM6449 34370002
         CLC   UCBVOLI,ZEROS            CHECK FOR VOL SER        YM6449 34372002
         BNZ   WTO09802                 BRANCH IF GOOD VOL SER   YM6449 34374002
*                                                                YM6449 34376002
         MODESET EXTKEY=ZERO            UCB KEY                  YM6449 34378002
*                                                                YM6449 34378402
         MVC   UCBVOLI,DXVOLSR1         SETUP VOL SER            YM6449 34378802
*                                                                YM6449 34378902
         MODESET EXTKEY=DATAMGT         DATA MNGT KEY            YM6449 34379002
*                                                                YM6449 34379202
WTO09802 EQU   *                        VOL SER IN UCB           YM6449 34379602
*                                                                YM6449 34379702
*                                                                YM6441 34388102
         LCR   R0,RUCB                  LOAD UCB FOR VOLSTAT     YM6441 34389702
*                                                                YM6441 34389802
WTO09803 EQU   *                        INITIALIZE FOR VOLSTAT   YM6441 34389902
*                                                                YM6441 34393202
         L     R1,DXTCBADR              LOAD TCB ADDRESS         YM6449 34396702
         L     R1,TCBTIO-TCB(R1)        LOAD JOBNAME POINTER     YM6449 34400002
VOLSTAT  EQU   91                       VOLSTAT SVC NUMBER       YM3925 34410002
         SVC   VOLSTAT                  VOLSTAT SVC              YM6449 34412002
*                                                                YM7503 34414002
WTO09805 EQU   *                        REWIND UNLOAD TAPE       YM7503 34416002
*                                                                Y02134 34420002
         MVC   DXREGA+K1,DXDEBUCB+K1    SAVE WORK AREA UCB       YM4647 34422002
         STCM  RUCB,B'0111',DXDEBUCB+K1 SET UP UCB ADDRESS       YM4647 34424002
*                                                                YM4647 34428002
         MVC   DXCCW1,REWDUNLD          REWIND AND UNLOAD CCW    Y02134 34470002
         EXCP  DXIOB                    REWIND AND UNLOAD        Y02134 34520002
*                                                                Y02134 34570002
         STM   RB,RET,DXCCW2            SAVE REGS 11 - 14        Y02134 34572002
         LM    RTIOT,RET,DXREGSAV       RESTORE REGISTERS        Y02134 34575002
         LM    R0,R1,DXREG0             RESTORE REGISTERS        Y02134 34580002
*                                                                Y02134 34585002
         IECRES WAIT                    WAIT FOR IMMED CHAN END  Y02134 34620002
*                                                                Y02134 34625002
         LM    RB,RET,DXCCW2            RESTORE REGS 11 - 14     Y02134 34630002
*                                                                YM4647 34630402
         MVC   DXREGA+K1,DXDEBUCB+K1    RESTORE REG 10 SAVE AREA YM4647 34632002
         STCM  RUCB,B'0111',DXDEBUCB+K1 RESTORE WORK AREA UCB    YM4647 34634002
         L     RUCB,DXREGA              RESTORE REG 10           YM4647 34634402
*                                                                YM4647 34636002
         XC    DXCCW2,DXCCW2            CLEAR SAVE AREA          Y02134 34680002
         XC    DXCCW3,DXCCW3            CLEAR SAVE AREA          Y02134 34730002
         B     WTO09820                 BRANCH TO RETURN         YM6449 34780002
*                                                                YM6449 34830002
WTO09810 EQU   *                        DIRECT ACCESS            YM6449 34880002
*                                                                YM7503 34890002
         TM    UCBDMCT,UCBMOUNT         UNSATISFIED MOUNT        YM7503 34900002
         BO    WTO09820                 BRANCH TO EXIT           YM7503 34910002
*                                                                YM6449 34930002
*        VOLSTAT (0)                    ISSUE VOLUME STATISTICS  A46383 35030002
*                                                                YM6449 35080002
         CLC   UCBVOLI,ZEROS            CHECK FOR VOL SER        YM6449 35090002
         BNZ   WTO09812                 BRANCH IF GOOD VOL SER   YM6449 35100002
*                                                                YM6449 35110002
         MODESET EXTKEY=ZERO            UCB KEY                  YM6449 35120002
*                                                                YM6449 35122002
         MVC   UCBVOLI,DXVOLSR1         SETUP VOL SER            YM6449 35124002
*                                                                YM6449 35126002
         MODESET EXTKEY=DATAMGT         DATA MNGT KEY            YM6449 35126402
*                                                                YM6449 35126802
WTO09812 EQU   *                        VOL SER IN UCB           YM6449 35128002
*                                                                YM6449 35128402
         LCR   R0,RUCB                  LOAD UCB FOR VOLSTAT     YM6441 35178402
         L     R1,DXTCBADR              LOAD TCB ADDRESS         YM6449 35180002
         L     R1,TCBTIO-TCB(R1)        LOAD JOBNAME POINTER     YM6449 35190002
         SVC   VOLSTAT                  VOLSTAT SVC              YM6449 35210002
*                                                                YM6449 35220002
WTO09820 EQU   *                        RETURN                   YM6449 35270002
*                                                                Y02134 35320002
         BR    RET                      RETURN                   Y02134 35370002
         EJECT                                                          35380002
*                                                                Y02134 35390002
*****************************************************************Y02134 35400002
*                                                                Y02134 35410002
*        REWIND TAPE UNIT                                        Y02134 35412002
*                                                                Y02134 35414002
*****************************************************************Y02134 35416002
*                                                                YM1472 35416402
*        NOTE- THIS ROUTINE MUST BE EXECUTED BEFORE CLEARING     YM1472 35416802
*              THE MESSAGE AREA. SEE LABEL WTO05000.             YM1472 35417237
*                                                                YM1472 35417602
*****************************************************************YM1472 35417702
*                                                                Y02134 35418002
WTO09850 EQU   *                                                 Y02134 35418402
*                                                                Y02134 35418802
         TM    UCBTBYT3,UCB3TAPE        TEST FOR TAPE            Y02134 35448602
         BNO   WTO09860                 BRANCH IF NOT TAPE       Y02134 35450602
*                                                                YM3925 35451002
         MODESET EXTKEY=ZERO            UCB KEY                  YM3925 35451402
*                                                                YM3925 35451802
         NI    UCBDMCT,ALLBITS-UCBMOUNT RESET UNSATISFIED MOUNT  YM7503 35451902
         XC    UCBFSER,UCBFSER          CLEAR MCS IDS            YM3925 35452202
         XC    UCBFSCT,UCBFSCT          CLEAR FILE COUNTERS      YM3925 35453002
         XC    UCBFSEQ,UCBFSEQ          CLEAR FILE SEQ COUNTERS  YM3925 35453402
*                                                                YM3925 35454002
         MODESET EXTKEY=DATAMGT         RESET TO DM KEY          YM3925 35454802
*                                                                YM7503 35455202
         TM    UCBFL1,UCBNOTRD          TEST FOR NOT READY TAPE  YM7503 35455302
         BO    WTO09860                 BRANCH IF NOT READY      YM7503 35455402
*                                                                Y02134 35455602
         MVC   DXREGA+K1,DXDEBUCB+K1    SAVE WORK AREA UCB       YM4647 35456002
         STCM  RUCB,B'0111',DXDEBUCB+K1 SET UP UCB ADDRESS       YM4647 35456102
*                                                                YM4647 35456202
         MVC   DXCCW1,REWIND            REWIND CCW               Y02134 35456402
         EXCP  DXIOB                    REWIND                   Y02134 35457202
*                                                                Y02134 35458002
         STM   RB,RET,DXCCW2            SAVE REGS 11 - 14        Y02134 35458802
         LM    RTIOT,RET,DXREGSAV       RESTORE REGISTERS        Y02134 35460802
         LM    R0,R1,DXREG0             RESTORE REGISTERS        Y02134 35462802
*                                                                Y02134 35463202
         IECRES WAIT                    WAIT FOR IMMED CHAN END  Y02134 35463602
*                                                                Y02134 35464002
         LM    RB,RET,DXCCW2            RESTORE REGS 11 - 14     Y02134 35464102
*                                                                YM4647 35464602
         MVC   DXREGA+K1,DXDEBUCB+K1    RESTORE REG 10 SAVE AREA YM4647 35465002
         STCM  RUCB,B'0111',DXDEBUCB+K1 RESTORE WORK AREA UCB    YM4647 35465102
         L     RUCB,DXREGA              RESTORE REG 10           YM4647 35465202
*                                                                YM4647 35465402
         XC    DXCCW2,DXCCW2            CLEAR SAVE AREA          Y02134 35465602
         XC    DXCCW3,DXCCW3            CLEAR SAVE AREA          Y02134 35465802
*                                                                YM3925 35466302
         MODESET EXTKEY=ZERO            UCB KEY                  YM3925 35468302
*                                                                YM3925 35470302
         OI    UCBWGT,UCBREW            SET REWIND BIT FOR SCHED YM3925 35472302
*                                                                YM3925 35474302
         MODESET EXTKEY=DATAMGT         RESET TO DM KEY          YM3925 35476302
*                                                                Y02134 35478202
WTO09860 EQU   *                        RETURN                   Y02134 35488202
*                                                                Y02134 35490202
         BR    RET                      RETURN                   Y02134 35490602
         EJECT                                                          35491002
*                                                                Y02134 36070002
*****************************************************************Y02134 36120002
*                                                                Y02134 36170002
*        AN ERROR HAS BEEN DETECTED                              Y02134 36220002
*                                                                Y02134 36270002
*****************************************************************Y02134 36320002
*                                                                Y02134 36370002
WTO10000 EQU   *                                                 Y02134 36420002
*                                                                Y02134 36470002
         DMABCOND PCK,SETLOCK           SETLOCK ERROR ROUTINE    Y02134 36570002
         EJECT                                                          36575002
***************************************************************@Y30LSBS 36575103
*                                                              @Y30LSBS 36575203
*        SSC  MOUNT/DEMOUNT FAILURE - 737-30 ABEND             @Y30LSBS 36575303
*                                                              @Y30LSFY 36575903
***************************************************************@Y30LSBS 36576003
*                                                              @Y30LSFY 36576203
WTO10050 EQU   *                        MOUNT/DEMOUNT ERROR    @Y30LSFY 36576403
         STH   R0,K0(,R1)               SAVE REASON CODE       @Y30LSBS 36578603
         LR    RB,R1                    PASS PARM LIST PTR     @Y30LSBS 36579103
         DMABCOND ERR111,ID4J0P         XCTL TO PROB DET       @Y30LSBS 36579603
*                                                              @Y30LSFY 36586003
***************************************************************@Y30LSBS 36591103
         EJECT                                                          36591403
*****************************************************************Y02083 36594503
*                                                                Y02083 36597603
*        MOVE JOB NAME TO CHECKPOINT SECURITY MESSAGE            Y02083 36600703
*                                                                Y02083 36603803
*        INPUT: RB = ADDRESS OF NEXT AVAILABLE MESSAGE SLOT      Y02083 36606903
*                                                                Y02083 36610003
*        OUTPUT: JOB NAME IN MESSAGE                             Y02083 36613103
*                RB     = ADDRESS OF FIRST BLANK BYTE            Y02083 36616203
*                         AFTER THE JOB NAME                     Y02083 36619303
*                                                                Y02083 36622403
*****************************************************************Y02083 36625503
*                                                                Y02083 36628603
WTO10100 L     RF,DXTCBADR              GET TCB ADDRESS          Y02083 36631703
         L     RF,TCBTIO-TCB(,RF)       GET TIOT ADDRESS         Y02083 36634803
         MVC   K0(K8,RB),TIOCNJOB-TIOT(RF) JOB NAME TO MESSAGE   Y02083 36637903
         BAL   RF,WTO10200              FIND END OF JOB NAME     Y02083 36641003
         BR    RET                      RETURN                   Y02083 36644103
         EJECT                                                          36647203
*                                                                Y02083 36650303
*****************************************************************Y02083 36653403
*                                                                Y02083 36656503
*        MOVE DDNAME, UNIT ADDRESS, AND VOLUME SERIAL TO         Y02083 36659603
*        CHECKPOINT SECURITY MESSAGE                             Y02083 36662703
*                                                                Y02083 36665803
*        INPUT: RB = ADDRESS OF NEXT AVAILABLE MESSAGE SLOT      Y02083 36668903
*                                                                Y02083 36672003
*        OUTPUT: DDNAME, UNIT ADDRESS, AND VOLUME SERIAL IN      Y02083 36675103
*                MESSAGE                                         Y02083 36678203
*                RB = ADDRESS OF FIRST BLANK AFTER VOLUME        Y02083 36681303
*                     SERIAL AND RIGHT PARENTHESIS               Y02083 36684403
*                                                                Y02083 36687503
*****************************************************************Y02083 36690603
*                                                                Y02083 36693703
WTO10150 MVI   K0(RB),LEFTPAR           DROP IN LEFT PARENTHESIS Y02083 36696803
         MVC   K1(K8,RB),TIOEDDNM       MOVE IN DD NAME          Y02083 36699903
         BAL   RF,WTO10200              FIND END OF DD NAME      Y02083 36703003
         MVI   K0(RB),COMMA             DROP IN COMMA            Y02083 36706103
         MVC   K1(K3,RB),UCBNAME        MOVE IN UNIT ADDRESS     Y02083 36709203
         MVI   K4(RB),COMMA             DROP IN COMMA            Y02083 36712303
         LA    RB,K5(,RB)               BUMP TO START OF VOL ID  Y02083 36715403
         MVC   K0(K6,RB),UCBVOLI        MOVE IN VOLUME SERIAL    Y02083 36718503
         OC    K0(K6,RB),BLANKS         FOLD ZEROS TO BLANKS     Y02083 36721603
         BAL   RF,WTO10200              FIND END OF VOL ID       Y02083 36724703
         MVI   K0(RB),RIGHTPAR          DROP IN RIGHT PAREN      Y02083 36727803
         LA    RB,K1(,RB)               POINT TO AFTER PAREN     Y02083 36730903
         BR    RET                      RETURN                   Y02083 36734003
*                                                                Y02083 36737103
WTO10200 CLI   K0(RB),BLANK             LOOK FOR BLANK           Y02083 36740203
         BCR   EQ,RF                    RETURN WHEN BLANK FOUND  Y02083 36743303
         LA    RB,K1(,RB)               BUMP TO NEXT BYTE        Y02083 36746403
         B     WTO10200                 LOOP BACK                Y02083 36749503
         EJECT                                                          36752603
*                                                                Y02134 36920002
*****************************************************************Y02134 36921002
*                                                                Y02134 36922002
*              CONSTANTS                                         Y02134 36923002
*                                                                Y02134 36924002
*****************************************************************Y02134 36924202
*                                                                Y02134 36925002
CHARK    EQU   C'K'                     KEEP CHARACTER ID        Y02134 36970002
CHARR    EQU   C'R'                     RETAIN CHARACTER ID      Y02134 37020002
DASH     EQU   C'-'                     HYPHEN SEPARATOR         Y02134 37025002
SWAPREFX EQU   16                       PREFIX OF QUEUE ELEMENT@G18MSBS 37025137
ERR111   EQU   111                      MSS FAILURE CODE       @Y30LSFY 37028137
LOWCASE  EQU   X'BF'                    FOLD CHARACTER TO      @ZA01544 37031137
*                                       LOWER CASE             @ZA01544 37034137
EOVID    EQU   C'5'                     EOV ID CHARACTER       @Y30LSFY 37037137
LEFTPAR  EQU   C'('                     ( CHARACTER CONSTANT     Y02083 37043603
RIGHTPAR EQU   C')'                     ) CHARACTER CONSTANT     Y02083 37052403
EQ       EQU   8                        BRANCH MASK              Y02083 37061203
CLOSEID  DC    CL3'020'                 CLOSE ID               @ZA03196 37062237
OPENID   DC    CL3'019'                 OPEN IDENTIFIER        @ZA06693 37662237
PRIVAT   DC    CL6'PRIVAT'              PRIVATE SCRTCH REQUEST   Y02134 38270503
SCRTCH   DC    CL6'SCRTCH'              SCRTCH VOLUME SERIAL     Y02134 38271003
ZEROS    DC    XL6'00'                  ZERO VOLUME SERIAL       Y02134 38271503
REWDUNLD DC    X'0F00000020000050'      REWIND UNLOAD CCW        Y02134 38272003
REWIND   DC    X'0700000020000050'      REWIND CCW               Y02134 38272503
*                                                                Y02134 38273003
*              0AL2(0),B'123456789ABCDEF0'                       YM7526 38273503
WTOFLAGS DC    0AL2(0),B'1000000001000000' MCS MULTI-LINE FLAGS  YM7526 38274003
WTOTCODE DC    0AL2(0),B'0010100000000000' TAPE POOL ROUT CODE   YM7526 38274503
WTODCODE DC    0AL2(0),B'0001010000000000' DA POOL ROUT CODE     YM7526 38274603
WTOD     DC    0XL3'00',X'2000',X'00'   LINE 1 DELIMITER         Y02134 38274703
WTODE    DC    XL2'3000'                LINE 2 DELIMITER         Y02134 38274803
WTOLGTHE DC    XL4'00041000'            LENGTH AND TYPE E      @ZA01544 38274903
*                                                                Y02134 38275003
NLCHAR   DC    CL2'NL'                  NL LABEL TYPE            Y02134 38275403
ALCHAR   DC    CL2'AL'                  AL LABEL TYPE            Y02134 38275503
SLCHAR   DC    CL2'SL'                  SL LABEL TYPE            Y02134 38275603
NSLCHAR  DC    CL3'NSL'                 NSL LABEL TYPE           Y02134 38275703
BLPCHAR  DC    CL3'BLP'                 BLP LABEL REQUEST        YM4647 38275803
*                                                                Y02134 38276303
BPICON80 DC    0CL7' ',C'800',X'00',C'BPI' 800 BPI               Y02134 38276403
BPICON55 DC    0CL7' ',C'556',X'00',C'BPI' 556 BPI               Y02134 38276503
BPICON20 DC    0CL7' ',C'200',X'00',C'BPI' 200 BPI               Y02134 38276603
BPICN160 DC    0CL8' ',C'1600',X'00',C'BPI' 1600 BPI             YM1157 38276703
BPICN625 DC    0CL8' ',C'6250',X'00',C'BPI' 6250 BPI             YM1157 38277203
*                                                                Y02134 38277303
BLANKS   DC    CL80' '                  BLANK VOLUME SERIAL      Y02134 38277403
         EJECT                                                          38277637
*                                                                Y02134 38277837
*****************************************************************Y02134 38277937
*                                                                Y02134 38278137
*        REPLY OUTSTANDING MESSAGE                               Y02134 38278237
*                                                                Y02134 38278537
*****************************************************************Y02134 38278737
*                                                                Y02134 38278837
IECREPLY DC    0CL18'IECREPLY'          REPLY MESSAGE          @ZA01544 38278937
         DC    AL2(IECEND-IECREPLY)     WTOR MESSAGE LENGTH      Y02134 38279037
WTORFLAG DC    0XL2'8000',B'1000000000000000' WTOR MCS INDICATOR Y02134 38279137
         DC    C'IECNNNY REPLY '        MESSAGE                @ZA01544 38279237
IECEND   EQU   *                        END OF MESSAGE           YM1238 38279337
*              DESC=(2),ROUT=(1)        ROUTING & DESCRIPTOR CDS YM7526 38279437
*              0AL4(0),B'123456789ABCDEF0',B'123456789ABCDEF0'   YM7526 38279637
WTORCODE DC    0AL4(0),B'0100000000000000',B'1000000000000000'   YM7526 38279737
*                                                                Y02134 38279837
*00 IECNNNY REPLY 'REPLY OPTIONS'                              @ZA02881 38280037
*                                                                Y02134 38280137
*****************************************************************Y02134 38280237
*                                                                Y02134 38280437
         EJECT                                                          38280637
*                                                                Y02134 38280837
*****************************************************************Y02134 38280937
*                                                                Y02134 38281037
*IEC108I OPERATOR ACTION HAS BEEN REQUESTED FOR YOUR DATA SET    Y02134 38281237
*                                                                Y02134 38281337
*****************************************************************Y02134 38281437
*                                                                Y02134 38281637
IEC108I  DC    0CL60'IEC108I'           TSO MESSAGE              Y02134 38281737
         DC    C'IEC108I OPERATOR ACTION HAS BEEN ' TSO OPER MSG YM3925 38281837
         DC    C'REQUESTED FOR YOUR DATA SET' TSO OPER MSG       YM3925 38282037
*                                                                Y02134 38282137
*****************************************************************Y02134 38283137
*                                                                Y02134 38283337
         EJECT                                                          38284137
         XCTLTABL ID=(ID4J0P,0P),BRT=SHORT                     @ZA03694 38285137
*                                                              @Y30LSBS 38286137
         EJECT                                                          38287137
*                                                              @Y30LSBS 38288137
***************************************************************@Y30LSBS 38289137
*                                                              @Y30LSBS 38290137
WTOPAGE2 DS    0H                       PAGE TWO OF MODULE     @Y30LSBS 38291137
*                                                              @Y30LSBS 38292137
***************************************************************@Y30LSBS 38293137
         EJECT                                                          38294137
*                                                                Y02134 38320002
*****************************************************************Y02134 38320437
*                                                                Y02134 38320637
*        IEC501A MOUNT MESSAGE                                   YM1238 38320837
*                                                                Y02134 38320937
*****************************************************************Y02134 38321037
*                                                                Y02134 38321637
IEC501A  DS    0H                       MOUNT MESSAGE RTN      @ZA03694 38321737
*                                                                Y02134 38321837
         BALR  RET,0                    BASE ADDRESS           @ZA03694 38321937
         USING *,RET                    ESTABLISH BASE         @ZA03694 38322037
         BAL   RET,IEC502E4             LINK TO UNLOAD UCB     @ZA03694 38322137
         DROP  RET                                             @ZA03694 38322237
*                                                                Y02134 38322337
         BAL   RET,WTO05000             LINK TO GET MESSAGE AREA Y02134 38322437
         USING *,RET                    ESTABLISH BASE         @ZA03694 38322537
*                                                              @Y30LSFY 38322637
         LA    R1,DXVOLSR2              POINT TO VOLUME TO MNT @Y30LSFY 38322737
*                                                              @Y30LSFY 38322837
         TM    UCBTBYT3,UCB3DACC        TEST FOR DIRECT ACCESS @Y30LSFY 38322937
         BZ    WTO20110                 BRANCH NO              @Y30LSFY 38323137
         TM    UCBTBYT2,UCBRVDEV        TEST FOR VIRTUAL DASD  @Y30LSFY 38323337
         BO    WTO08900                 BRANCH YES UCBRVDEV RTN@Y30LSFY 38323537
*                                                              @Y30LSFY 38323737
WTO20110 EQU   *                        NOT VIRTUAL DASD       @Y30LSFY 38323837
*                                                              @Y30LSFY 38324037
         MVC   WTOMSGID(L'MIEC501A),MIEC501A MOUNT MESSAGE     @ZA03694 38324537
         MVC   WTODRCDS,IEC501AC        ROUT & DESC CODES      @ZA01544 38324937
         DROP  RET                                             @ZA03694 38325937
*                                                                Y02134 38326037
         BAL   RET,WTO09105             GET VOLSER & UNIT        YM3916 38326237
*                                                                Y02134 38326337
         BAL   RET,WTO09110             MOVE VOLSER TO UCB       Y02134 38326537
*                                                                Y02134 38326637
         BAL   RET,WTO09650             LINK TO GET LABEL,DEN    Y02134 38326837
*                                                                Y02134 38326937
         BAL   RET,WTO09500             LINK TO GET DSNAME       Y02134 38327137
*                                                                Y02134 38327237
         BAL   RET,WTO09300             FINISH MESSAGE           Y02134 38327437
*                                                                Y02134 38327537
         BAL   RET,WTO02000             LINK TO ISSUE WTO        Y02134 38327737
*                                                                Y02134 38327837
         BAL   RET,WTO09150             SET THE MOUNT BIT        Y02134 38328037
*                                                                Y02134 38328137
         BAL   RET,WTO04000             LINK TO TELL TERMINAL    Y02134 38328337
*                                                                Y02134 38328437
         B     WTO01000                 BRANCH TO EXIT           Y02134 38328637
*                                                                Y02134 38328737
*****************************************************************Y02134 38329037
*                                                                Y02134 38329137
*IEC501A M DDD,VOLSER,LBL,DENS,JOBNAME,STEPNAME,DSNAME           YM1238 38330137
*                                                                Y02134 38330337
*****************************************************************Y02134 38330537
*                                                                Y02134 38330737
MIEC501A DC    CL16'IEC501A M'          MOUNT VOLUME           @ZA03694 38335137
*              DESC=(2),ROUT=()         ROUTING & DESCRIPTOR CDS        38336137
*              0AL4(0),B'123456789ABCDEF0',B'123456789ABCDEF0'   YM7526 38337137
IEC501AC DC    0AL4(0),B'0100000000000000',B'0000000000000000' @ZA01278 38338137
*                                                                Y02134 38485202
*****************************************************************Y02134 38485402
*                                                                Y02134 38485602
         EJECT                                                          38485702
*                                                                Y02134 38486002
*****************************************************************Y02134 38486737
*                                                                Y02134 38486837
*        IEC501E LOOK AHEAD MOUNT MESSAGE                        YM1238 38486937
*                                                                Y02134 38487037
*****************************************************************Y02134 38487137
*                                                                Y02134 38487837
IEC501E  DS    0H                       LOOK AHEAD MOUNT RTN   @ZA03694 38487937
*                                                                Y02134 38488037
         BALR  RET,0                    BASE ADDRESS           @ZA03694 38488137
         USING *,RET                    ESTABLISH BASE         @ZA03694 38488237
         BAL   RET,IEC502E4             LINK TO UNLOAD UNIT    @ZA03694 38488337
         DROP  RET                                             @ZA03694 38488437
*                                                                Y02134 38488537
         BAL   RET,WTO05000             LINK TO GET MESSAGE AREA Y02134 38488637
         USING *,RET                    ESTABLISH BASE         @ZA03694 38488737
*                                                              @ZM32752 38488837
         MVC   WTOMSGID(L'MIEC501E),MIEC501E MOUNT MESSAGE     @ZA01544 38488937
         MVC   WTODRCDS,IEC501EC        ROUT & DESC CODES      @ZA01544 38489037
         DROP  RET                                             @Y30LSBS 38489137
*                                                                Y02134 38489237
         LA    R1,DXVOLSR3              POINT TO LOOKAHEAD VOL @ZA03660 38489437
         BAL   RET,WTO09105             GET VOLSER & UNIT        YM3916 38489637
*                                                                Y02134 38489837
         BAL   RET,WTO09110             MOVE VOLSER TO UCB       Y02134 38490037
*                                                                Y02134 38490337
         BAL   RET,WTO09650             LINK TO GET LABEL,DEN    Y02134 38490537
*                                                                Y02134 38490737
         BAL   RET,WTO09500             LINK TO GET DSNAME       Y02134 38490937
*                                                                Y02134 38491037
         BAL   RET,WTO09300             FINISH MESSAGE           Y02134 38491137
*                                                                Y02134 38491237
         BAL   RET,WTO02000             LINK TO ISSUE WTO        Y02134 38491337
*                                                                Y02134 38491437
         BAL   RET,WTO09150             SET THE MOUNT BIT        Y02134 38491637
*                                                                Y02134 38491737
         B     WTO01000                 BRANCH TO EXIT           Y02134 38491837
*                                                                Y02134 38491937
*****************************************************************Y02134 38492137
*                                                                Y02134 38492337
*IEC501E M DDD,VOLSER,LBL,DENS,JOBNAME,STEPNAME,DSNAME           YM1238 38492437
*                                                                Y02134 38492537
*****************************************************************Y02134 38492637
*                                                                Y02134 38492737
MIEC501E DC    CL16'IEC501E M'          MOUNT VOLUME           @ZA03694 38492837
*              DESC=(3),ROUT=()         ROUTING & DESCRIPTOR CDS        38492937
*              0AL4(0),B'123456789ABCDEF0',B'123456789ABCDEF0'   YM7526 38493237
IEC501EC DC    0AL4(0),B'0100000000000000',B'0000000000000000' @ZA02505 38493502
*                                                                Y02134 38506002
*****************************************************************Y02134 38509802
*                                                                Y02134 38513602
         EJECT                                                          38517402
*                                                                Y02134 38518437
*****************************************************************Y02134 38519437
*                                                                Y02134 38520437
*        IEC502E K VOLUME DISPOSITION MESSAGE                  @ZA03694 38520637
*                                                                Y02134 38520837
*****************************************************************Y02134 38521037
*                                                                Y02134 38521137
IEC502E1 DS    0H                       VOLUME DISP RTN        @ZA03694 38522137
*                                                                Y02134 38522337
         TM    UCBDMCT,UCBDMC           CHECK FOR ANY ACTIVITY   YM7503 38522537
         BNZ   WTO01000                 BRANCH YES, SKIP         Y02134 38522737
         TM    UCBTBYT3,UCB3TAPE        TEST FOR TAPE            YM7526 38522937
         BNO   WTO01000                 BRANCH IF NOT TAPE       YM7526 38523037
         CLC   UCBFSCT,ZEROS            REWIND INDICATED         YM7843 38523637
         BNZ   WTO01000                 BRANCH IF NOT TO RETURN  YM7843 38523837
*                                                                YM3916 38524037
*****************************************************************YM3916 38524237
*                                                                YM3916 38524337
*        IF EXACTLY TWO UNITS ARE SPECIFIED BYPASS REWIND SO     YM7526 38524537
*        LOOKAHEAD MOUNT DOES NOT WAIT FOR REWIND TO FINISH.     YM7526 38524737
*                                                                YM3916 38525737
*****************************************************************YM3916 38525937
*                                                                YM3916 38526137
         MODESET EXTKEY=ZERO            UCB KEY                  YM7526 38526337
*                                                                YM7526 38526537
         XC    UCBFSER,UCBFSER          CLEAR MCS IDS            YM7526 38526637
         XC    UCBFSCT,UCBFSCT          CLEAR FILE COUNTERS      YM7526 38526937
         XC    UCBFSEQ,UCBFSEQ          CLEAR FILE SEQ COUNTERS  YM7526 38527137
*                                                                YM7526 38527337
         MODESET EXTKEY=DATAMGT         RESET TO DM KEY          YM7526 38527437
*                                                                YM7526 38527537
         BALR  RET,0                    BASE ADDRESS           @ZA03184 38527837
         USING *,RET                    ESTABLISH BASE REG     @ZA03184 38527937
*                                                                       38528037
         CLC   DXVOLSR3,ZEROS           CHECK IF LOOKAHEAD MOUNT YM7526 38528137
         BZ    WTO20212                 BRANCH IF NOT          @ZA03184 38528237
         LA    RF,TIOEFSRT-K1-TIOENTRY+K4+K4 LEN FOR TWO UNITS   YM7526 38528337
         CLM   RF,B'0001',TIOENTRY      CHECK FOR TWO UNITS      YM7526 38528437
         BE    WTO01000                 BRANCH IF TWO            YM7526 38528537
*                                                                       38528637
WTO20212 EQU   *                        CHECK DISPOSITION      @ZA03184 38528737
*                                                                       38528837
         CLC   CLOSEID,WTGMODNM+K3      CHECK FOR CLOSE        @ZA03184 38528937
         BNE   WTO20218                 BRANCH IF EOV          @ZA03184 38529137
         TM    DXDCBLST,PLISTOP2        CHECK FOR DISP         @ZA03184 38529337
         BNZ   WTO20218                 BRANCH IF NOT DISP     @ZA03184 38529637
         TM    UCBJBNR,UCBMONT          CHECK FOR DISP=PASS    @ZA03184 38529837
         BO    WTO20218                 BRANCH IF VOL RETAINED @ZA03184 38529937
         TM    UCBSTAB,UCBBPRV          TEST FOR DISP=KEEP     @ZA03184 38530037
         BZ    WTO20218                 BRANCH IF PUBLIC VOL   @ZA03184 38530137
         TM    UCBTFL1,UCBNLTP+UCBNSLTP TEST IF NL,NSL, OR BLP @ZA03184 38530237
         BZ    WTO20218                 BRANCH NOT NL          @ZA03184 38530337
         B     IEC502E                  ISSUE IEC502E K        @ZA03184 38530437
         DROP  RET                                             @ZA03184 38530637
*                                                                YM3916 38530937
WTO20218 EQU   *                        REWIND VOLUME            YM7526 38531037
*                                                                YM3916 38531237
         BAL   RET,WTO09850             REWIND TAPE VOL          Y02134 38531437
*                                                                Y02134 38531637
         B     WTO01000                 BRANCH TO EXIT           Y02134 38531737
*                                                                Y02134 38531837
         EJECT                                                          38532137
*                                                                       38533137
*********************************************************************** 38533237
*                                                                       38533437
*        IEC502E DDNAME-CODE ASCII ERROR DISMOUNT MESSAGE               38533537
*                                                                       38533737
*********************************************************************** 38533837
*                                                                       38534037
IEC502E2 DS    0H                       ASCII ERROR MSG RTN    @ZA03694 38534137
*                                                                       38534337
         BALR  RET,0                    BASE ADDRESS           @ZA03694 38534437
         USING *,RET                    ESTABLISH BASE REG     @ZA03694 38534537
         LA    RB,MIEC502E              SET ASCII INDICATOR    @ZA04633 38534637
         B     IEC502E5                 ISSUE IEC502E MSG      @ZA04633 38534737
         DROP  RET                                             @ZA03694 38535737
         EJECT                                                          38541737
*                                                                       38541837
*********************************************************************** 38542037
*                                                                       38542137
*        IEC502E R REJECT VOLUME SPECIFIED BY DXVOLSR1                  38542337
*                                                                       38542437
*********************************************************************** 38542637
*                                                                       38542737
IEC502E3 DS    0H                       REJECT MESSAGE RTN     @ZA03694 38543337
*                                                                       38543937
         BAL   RET,WTO09450             CLEAR FOR REJECT       @ZA00700 38544237
         USING *,RET                    ESTABLISH BASE REG     @ZA03694 38544337
         B     IEC502E                  ISSUE IEC502E MSG      @ZA03694 38544437
         DROP  RET                                             @ZA03694 38544537
         EJECT                                                          38544637
*                                                                       38544737
*********************************************************************** 38544837
*                                                                       38544937
*        IEC502E DISMOUNT MESSAGE                                       38545037
*                                                                       38545137
*********************************************************************** 38545237
*                                                                       38545337
IEC502E  DS    0H                       DISMOUNT MESSAGE RTN   @ZA03694 38545437
*                                                                       38545637
         LA    RET,WTO01000             PREPARE RETURN REG       Y02134 38545737
*                                                                Y02134 38545837
IEC502E4 EQU   *                        ENTER FROM INTERNAL CALL Y02134 38545937
*                                                                Y02134 38546037
         LR    RB,RET                   SAVE RETURN REGISTER     Y02134 38546137
*                                                                Y02134 38546237
IEC502E5 EQU   *                                               @ZA04633 38546437
         BALR  RET,0                    BASE ADDRESS           @ZA03694 38558237
         USING *,RET                    ESTABLISH BASE REG     @ZA03694 38558437
         TM    DXECB,ECBNOERR           TEST FOR I/O ERROR     @ZA03196 38558637
         BO    WTO20242                 BRANCH IF NO ERROR       YM3916 38558837
         TM    DXECB,ECBCOMPL           TEST FOR I/O ERROR     @ZA03196 38559037
         BNO   WTO20242                 BRANCH IF NONE           YM7488 38559237
*                                                                Y02134 38559437
         BAL   RET,IEC512IA             LINK TO I/O ERROR MSG    Y02134 38559637
         DROP  RET                                             @ZA03694 38559837
*                                                                Y02134 38560037
WTO20242 EQU   *                        ISSUE DISMOUNT MESSAGE @ZA03694 38560237
*                                                                Y02134 38560437
         BALR  RET,0                    BASE ADDRESS           @ZA03694 38560637
         USING *,RET                    ESTABLISH BASE REG     @ZA03694 38560837
         TM    UCBDMCT,UCBMOUNT         UNSATISFIED MOUNT        YM7503 38561037
         BO    WTO20244                 BRANCH TO ISSUE MSG ONLY YM7526 38561237
*                                                                YM7503 38561437
         TM    UCBFL1,UCBNOTRD          TEST FOR UNIT UNLOADED   Y02134 38561637
         BNO   WTO20244                 BRANCH TO ISSUE MSG    @ZA07691 38561837
         LA    R1,MIEC502E              GET ASCII INDICATOR    @ZA07691 38561937
         CR    RB,R1                    TEST FOR ASCII MSG     @ZA07691 38562037
         BNE   WTO20290                 RETURN                 @ZA07691 38562137
         LA    RB,WTO01000              PREPARE RETURN REG     @ZA07691 38562237
         B     WTO20290                 RETURN                 @ZA07691 38562337
*                                                                YM7526 38562437
WTO20244 EQU   *                        DISMOUNT VOLUME        @ZA03694 38562537
*                                                                Y02134 38562637
         DROP  RET                                             @ZA03694 38562737
         BAL   RET,WTO09800             LINK TO REWIND UNLOAD    YM1472 38562837
*                                                                YM1472 38563037
         MODESET EXTKEY=ZERO            GO TO KEY ZERO         @ZA17796 38563237
         NI    UCBVOPT,X'ED'            CLEAR ERROR RECOV      @ZA17796 38563337
         MODESET EXTKEY=DATAMGT         BACK TO DATA MGT KEY   @ZA17796 38563437
*                                                                       38563537
         BAL   RET,WTO05000             LINK TO GET MSG AREA   @ZA18506 38563637
         USING *,RET                    ESTABLISH BASE REG     @ZA03694 38563737
*                                                                       38563837
         BAL   RET,WTO09550             DEQ VOLSER IF REQUIRED @ZA18506 38563937
         USING *,RET                    REESTABLISH 2ND BASE   @ZA18506 38564037
*                                                              @Y30LSFY 38564137
         TM    UCBTBYT3,UCB3DACC        TEST FOR DIRECT ACCESS @Y30LSFY 38564237
         BZ    WTO20246                 BRANCH NO              @ZA03694 38564337
         TM    UCBTBYT2,UCBRVDEV        TEST FOR VIRTUAL DASD  @Y30LSFY 38564437
         BO    WTO08950                 BRANCH YES UCBRVDEV RTN@Y30LSFY 38564537
*                                                              @Y30LSFY 38564737
WTO20246 EQU   *                        NOT VIRTUAL DASD       @ZA03694 38564837
*                                                                Y02134 38565037
         MVC   WTOMSGID(L'MIEC502E),MIEC502E DISMOUNT MESSAGE  @ZA01544 38565237
         MVC   WTODRCDS,IEC502EC        ROUT & DESC CODES      @ZA01544 38565437
*                                                                Y02134 38565637
         TM    UCBJBNR,UCBMONT          TEST FOR DISP=PASS       Y02134 38565837
         BNO   WTO20248                 BRANCH NOT DISP=PASS     Y02134 38566037
         MVI   WTOINSTR,CHARR           MOVE IN PASS INDICATOR @ZA01544 38566237
*                                                                Y02134 38566437
WTO20248 EQU   *                        TEST FOR PUBLIC VOLUME   Y02134 38566637
*                                                                Y02134 38566837
         TM    UCBSTAB,UCBBPUB          TEST FOR PUBLIC          Y02134 38567037
         BNO   WTO20252                 BRANCH NOT PUBLIC        YM7526 38567237
*                                                                       38567437
WTO20250 EQU   *                        DEFAULT DISMOUNT       @ZA00700 38567637
*                                                                       38567837
         MVI   WTOINSTR+K1,CHARD        MOVE D TO MSG          @ZA01544 38568037
         B     WTO20254                 BRANCH TO FINISH         YM7526 38568237
*                                                                Y02134 38568437
WTO20252 EQU   *                        TEST FOR PRIVATE VOLUME  Y02134 38568637
*                                                                Y02134 38568837
         TM    UCBSTAB,UCBBPRV          TEST FOR PRIVATE         Y02134 38569037
         BNO   WTO20254                 BRANCH NOT PRIVATE       Y02134 38569237
         MVI   WTOINSTR+K1,CHARK        MOVE K TO MSG          @ZA01544 38569637
*                                                                YM7526 38569737
WTO20254 EQU   *                        DETERMINE DEFAULT        Y02134 38569837
*                                                                Y02134 38570037
         CLI   WTOINSTR+K1,BLANK        TEST IF DISP SPECIFIED @ZA01544 38570237
         BNE   WTO20256                 BRANCH IF DISP SPECIFIED Y02134 38570437
         CLI   WTOINSTR,CHARR           CHECK FOR PASS         @ZA01544 38570637
         BE    WTO20250                 BRANCH TO GET PUBLIC   @ZA00700 38570837
*                                                                Y02134 38571037
         MVI   WTOINSTR,CHARR           SET IND TO REJECT      @ZA01544 38571237
         B     WTO20258                 BYPASS DSN AND SPACE   @ZA03694 38571437
*                                                                Y02134 38571637
WTO20256 EQU   *                        LSPACE AND DSNAME      @ZA03694 38571837
*                                                                Y02134 38572037
         DROP  RET                                             @ZA03694 38572237
         BAL   RET,WTO09700             LINK TO GET SPACE INFO   YM7526 38572437
*                                                                YM7526 38572637
*   DON'T PRINT DSNAME IF DISMOUNT IS FROM OPEN AS THE         @ZA06693 38572737
*   JFCB ADDRESS DOES NOT REFLECT THE CORRECT DATASET.         @ZA06693 38573037
         CLC   OPENID,WTGMODNM+K3       IS IT OPEN             @ZA06693 38573337
         BE    WTO20258                 YES - SKIP DSNAME      @ZA06693 38573637
*                                                              @ZA06693 38573937
         TM    DCBOFLGS,DCBOCON         CONCATENATION?         @ZA04633 38574237
         LA    RET,WTO20258             ESTABLISH RETURN ADDR  @ZA04633 38574837
         BNO   WTO09500                 BR TO GET DSNAME       @ZA04633 38576837
         L     R1,DXDSAB                GET DSAB ADDR          @ZA04633 38578837
         L     R1,DSABBCHN-DSAB(R1)     GET PREVIOUS DSAB ADDR @ZA04633 38579237
         L     R1,DSABTIOT-DSAB(R1)     GET TIOT ENTRY ADDR    @ZA04633 38579737
         LA    R1,TIOEJFCB-TIOENTRY(R1) GET PTR TO JFCB PREFIX @ZA04633 38579837
         IECRES LOCJFCB,(R1)            LOCATE JFCB            @ZA04633 38579937
         BAL   RET,WTO09510             LINK TO GET DSNAME     @ZA04633 38580237
*                                                                Y02134 38581837
WTO20258 EQU   *                        TEST FOR ASCII         @ZA03694 38583937
*                                                                Y02134 38586037
         BALR  RET,0                    BASE ADDRESS           @ZA03694 38588137
         USING *,RET                    ESTABLISH BASE REG     @ZA03694 38590237
         LA    R1,MIEC502E              GET ASCII INDICATOR    @ZA03694 38592337
         CR    RB,R1                    TEST FOR ASCII MSG     @ZA03694 38594437
         BNE   WTO20260                 BRANCH NOT ASCII       @ZA03694 38596537
         LA    RB,WTO01000              PREPARE RETURN REG     @ZA03694 38598637
         DROP  RET                                             @ZA03694 38600737
*                                                                       38602837
         BAL   RET,WTO09000             GET DDNAME-CODE        @ZA03694 38604937
*                                                                       38607037
WTO20260 EQU   *                        FINISH MESSAGE         @ZA03694 38609137
*                                                                       38611237
         BAL   RET,WTO09100             GET VOLSER & UNIT        YM3916 38613337
*                                                                Y02134 38615437
         BAL   RET,WTO09600             LINK TO GET LABEL TYPE   Y02134 38617537
*                                                                Y02134 38619637
         BAL   RET,WTO09400             LINK TO CLEAR UCB        Y02134 38621737
*                                                                Y02134 38623837
         BAL   RET,WTO09300             FINISH MESSAGE           Y02134 38625937
*                                                                Y02134 38628037
         BAL   RET,WTO02000             LINK TO ISSUE WTO        Y02134 38630137
*                                                                Y02134 38632237
WTO20290 EQU   *                        RETURN                   Y02134 38634337
*                                                                Y02134 38636437
         XC    DXVOLSR1,DXVOLSR1        CLEAR REJECT             YM1472 38638537
         LR    RET,RB                   RESTORE RETURN REG       Y02134 38640637
         BR    RET                      RETURN                   Y02134 38642737
*                                                                       38644837
*********************************************************************** 38646937
*                                                                       38649037
*IEC502E XX DDD,VOLSER,SPACE=CCCC,TTTT,AAAA/YYYY,ZZZZ                   38651137
*IEC502E JOBNAME,STEPNAME,DSNAME                                        38653237
*                                                                       38655337
*IEC502E XX DDD,VOLSER,LBL,DDNAME-CODE,JOBNAME,STEPNAME,DSNAME          38657437
*        DISMOUNT MESSAGE                                               38659537
*                                                                       38661637
*********************************************************************** 38663737
*                                                                       38665837
MIEC502E DC    CL16'IEC502E'            K,D,R,RK,RD            @ZA03694 38667937
*              DESC=(3),ROUT=()         ROUTING & DESCRIPTOR CDS        38670037
*              0AL4(0),B'123456789ABCDEF0',B'123456789ABCDEF0'   YM7526 38672137
IEC502EC DC    0AL4(0),B'0010000000000000',B'0000000000000000' @ZA01278 38674237
*                                                                Y02134 38676337
*****************************************************************Y02134 38678437
*                                                                Y02134 38680537
         EJECT                                                          38682637
*                                                                Y02134 38684737
*****************************************************************Y02134 38686837
*                                                                Y02134 38688937
*        IEC507D EXPIRATION DATE MESSAGE                         YM1238 38691037
*                                                                Y02134 38693137
*****************************************************************Y02134 38695237
*                                                                Y02134 38697337
IEC507D  DS    0H                       EXPIRATION DATE RTN    @ZA03694 38699437
*                                                                Y02134 38701537
         BAL   RET,WTO05000             LINK TO GET MESSAGE AREA Y02134 38703637
         USING *,RET                    ESTABLISH BASE         @ZA03694 38705737
*                                                                       38707837
         MVC   WTOMSGID(L'MIEC507D),MIEC507D EXPIRATION MSG    @ZA03694 38709937
         MVC   WTODRCDS,IEC507DC        ROUT & DESC CODES      @ZA01544 38712037
         DROP  RET                                             @Y30LSBS 38714137
*                                                                Y02134 38716237
         BAL   RET,WTO09100             GET VOLSER & UNIT        Y02134 38718337
*                                                                Y02134 38720437
         L     R1,DXREG0                LOAD DSNAME POINTER      Y02134 38722537
         BAL   RET,WTO09520             LINK TO GET DSNAME       Y02134 38724637
*                                                                Y02134 38726737
         BAL   RET,WTO09300             FINISH MESSAGE           Y02134 38728837
         USING *,RET                    ESTABLISH BASE         @ZA03694 38730937
*                                                                Y02134 38733037
         LA    RC,IEC507DL              POINT TO REPLY         @ZA01544 38735137
*                                       MESSAGE LENGTH         @ZA01544 38737237
         DROP  RET                                             @ZA03694 38739337
         BAL   RET,WTO03000             LINK TO ISSUE WTOR       Y02134 38741437
*                                                                Y02134 38743537
         B     WTO01000                 BRANCH TO EXIT           Y02134 38745637
*                                                                Y02134 38747737
*****************************************************************Y02134 38749837
*                                                                Y02134 38751937
*IEC507D E DDD,VOLSER,JOBNAME,STEPNAME,DSNAME                  @ZA02881 38754037
*        R 00,'U' TO USE OR                                      Y02134 38756137
*        R 00,'M' TO UNLOAD                                      Y02134 38758237
*                                                                Y02134 38760337
*****************************************************************Y02134 38762437
*                                                                Y02134 38764537
MIEC507D DC    CL16'IEC507D E'          EXPIRATION DATE MSG    @ZA03694 38766637
*              DESC=(2,7),ROUT=(1)   ROUTING & DESCRIPTOR CDS  @ZA18541 38768737
*              0AL4(0),B'123456789ABCDEF0',B'123456789ABCDEF0'   YM7526 38770737
IEC507DC DC    0AL4(0),B'0100001000000000',B'1000000000000000' @ZA18541 38772737
*                                                                Y02134 38775002
IEC507DL DC    AL1(IEC507DE-IEC507DR)   LENGTH OF REPLY        @ZA01544 38776002
IEC507DR DC    C'''U''-USE OR ''M''-UNLOAD'                    @ZA01544 38777002
IEC507DE EQU   *                                               @ZA01544 38778002
*                                                              @ZA01544 38779002
*****************************************************************Y02134 38780002
*                                                                Y02134 38820002
         EJECT                                                          38821002
*                                                                Y02134 38821137
*****************************************************************Y02134 38821337
*                                                                Y02134 38821537
*        IEC509A FILE PROTECT MESSAGE                            YM1238 38821837
*                                                                Y02134 38822037
*****************************************************************Y02134 38822137
*                                                                Y02134 38822237
IEC509A  DS    0H                       FILE PROTECT RTN       @ZA03694 38822337
*                                                                Y02134 38822437
         BAL   RET,WTO09800             LINK TO REWIND UNLOAD    Y02134 38822537
*                                                                Y02134 38822637
         BAL   RET,WTO05000             LINK TO GET MESSAGE AREA Y02134 38822837
         USING *,RET                    ESTABLISH BASE         @ZA03694 38823137
*                                                                       38823337
         MVC   WTOMSGID(L'MIEC509A),MIEC509A FILE PROTECT MSG  @ZA03694 38823437
         MVC   WTODRCDS,IEC509AC        ROUT & DESC CODES      @ZA01544 38823537
         DROP  RET                                             @ZA03694 38823737
*                                                                Y02134 38823937
         BAL   RET,WTO09100             GET VOLSER & UNIT        YM3840 38824937
*                                                                Y02134 38825137
         BAL   RET,WTO09400             LINK TO CLEAR UCB        Y02134 38825337
*                                                                Y02134 38825537
         BAL   RET,WTO09500             LINK TO GET DSNAME       Y02134 38825737
*                                                                Y02134 38825837
         BAL   RET,WTO09300             FINISH MESSAGE           Y02134 38826137
*                                                                Y02134 38826337
         BAL   RET,WTO02000             LINK TO ISSUE WTO        Y02134 38826537
*                                                                Y02134 38826637
         BAL   RET,WTO09150             SET THE MOUNT BIT        Y02134 38826737
*                                                                Y02134 38827037
         BAL   RET,WTO04000             LINK TO TELL TERMINAL    Y02134 38827237
*                                                                Y02134 38827337
         XC    DXVOLSR1,DXVOLSR1        CLEAR REJECT SERIAL      YM1487 38827437
         B     WTO01000                 BRANCH TO EXIT           Y02134 38827537
*                                                                Y02134 38827737
*****************************************************************Y02134 38827837
*                                                                Y02134 38827937
*IEC509A F DDD,VOLSER,JOBNAME,STEPNAME,DSNAME                    YM1238 38828937
*                                                                Y02134 38829937
*****************************************************************Y02134 38830937
*                                                                Y02134 38880002
MIEC509A DC    CL16'IEC509A F'          FILE PROTECTED VOLUME  @ZA03694 38885037
*              DESC=(2),ROUT=()         ROUTING & DESCRIPTOR CDS        38887502
*              0AL4(0),B'123456789ABCDEF0',B'123456789ABCDEF0'   YM7526 38889502
IEC509AC DC    0AL4(0),B'0100000000000000',B'0000000000000000' @ZA01278 38889902
*                                                                Y02134 38900002
*****************************************************************Y02134 38900102
*                                                                Y02134 38900502
         EJECT                                                          38901402
*                                                                Y02134 38901537
*****************************************************************Y02134 38901637
*                                                                Y02134 38901837
*        IEC510D FILE PROTECT MESSAGE                            YM1238 38901937
*                                                                Y02134 38902037
*****************************************************************Y02134 38902237
*                                                                Y02134 38902337
IEC510D  DS    0H                       FILE PROTECT WTOR RTN  @ZA03694 38902437
*                                                                Y02134 38902537
         BAL   RET,WTO05000             LINK TO GET MESSAGE AREA Y02134 38902737
         USING *,RET                    ESTABLISH BASE         @ZA03694 38902937
*                                                                       38903037
         MVC   WTOMSGID(L'MIEC510D),MIEC510D FILE PROTECT MSG  @ZA03694 38903137
         MVC   WTODRCDS,IEC510DC        ROUT & DESC CODES      @ZA01544 38903337
         DROP  RET                                             @ZA03694 38903637
*                                                                Y02134 38903837
         BAL   RET,WTO09100             GET VOLSER & UNIT        YM3822 38903937
*                                                                Y02134 38904037
         BAL   RET,WTO09500             LINK TO GET DSNAME       Y02134 38904237
*                                                                Y02134 38904337
         BAL   RET,WTO09300             FINISH MESSAGE           Y02134 38904437
         USING *,RET                    ESTABLISH BASE         @ZA03694 38904637
*                                                                Y02134 38904737
         LA    RC,IEC510DL              POINT TO REPLY         @ZA01544 38905037
*                                       MESSAGE LENGTH         @ZA01544 38905137
         DROP  RET                                             @ZA03694 38905337
         BAL   RET,WTO03000             LINK TO ISSUE WTOR       Y02134 38905537
*                                                                Y02134 38905637
         B     WTO01000                 BRANCH TO EXIT           Y02134 38905737
*                                                                Y02134 38905937
*****************************************************************Y02134 38906037
*                                                                Y02134 38906137
*IEC510D F DDD,VOLSER,JOBNAME,STEPNAME,DSNAME                  @ZA02881 38906237
*        R 00,'U' TO USE OR                                      Y02134 38906337
*        R 00,'F' TO UNLOAD                                      Y02134 38906437
*                                                                Y02134 38906537
*****************************************************************Y02134 38906637
*                                                                Y02134 38906737
MIEC510D DC    CL16'IEC510D F'          FILE PROTECTED VOLUME  @ZA03694 38906837
*              DESC=(2,7),ROUT=(1)    ROUTING & DESCRIPTOR CDS @ZA18541 38906937
*              0AL4(0),B'123456789ABCDEF0',B'123456789ABCDEF0'   YM7526 38907937
IEC510DC DC    0AL4(0),B'0100001000000000',B'1000000000000000' @ZA18541 38908937
*                                                                Y02134 38910302
IEC510DL DC    AL1(IEC510DE-IEC510DR)   LENGTH OF REPLY        @ZA01544 38922302
IEC510DR DC    C'''U''-USE OR ''F''-UNLOAD'                    @ZA01544 38923302
IEC510DE EQU   *                                               @ZA01544 38923437
*                                                              @ZA01544 38924102
*****************************************************************Y02134 38925002
*                                                                Y02134 38925702
         EJECT                                                          38926032
*                                                              @G32DSMI 38926132
***************************************************************@G32DSMI 38926232
*                                                              @G32DSMI 38926332
*        IEC135A REMOVE FILE PROTECT RING MESSAGE              @G32DSMI 38926432
*                                                              @G32DSMI 38926532
***************************************************************@G32DSMI 38926632
*                                                              @G32DSMI 38926732
IEC135A  EQU   *                        ISSUE MESSAGE IEC135A  @G32DSMI 38926832
*                                                              @G32DSMI 38926932
         BAL   RET,WTO09800             LINK TO REWIND UNLOAD  @G32DSMI 38927032
*                                                              @G32DSMI 38927132
         BAL   RET,WTO05000             LINK TO GET MSG AREA   @G32DSMI 38927232
         USING *,RET                    BASE FOR MESSAGE       @G32DSMI 38927332
*                                                              @G32DSMI 38927432
         MVC   WTOMSGID(L'MIEC135A),MIEC135A  MOVE IN MESSAGE  @G32DSMI 38927532
         MVC   WTODRCDS,IEC135AC        ROUTING & DESC CODES   @G32DSMI 38927632
*                                                              @G32DSMI 38927732
         BAL   RET,WTO09100             GET VOLSER AND UNIT    @G32DSMI 38927832
*                                                              @G32DSMI 38927932
         BAL   RET,WTO09400             LINK TO CLEAR UCB      @G32DSMI 38928032
*                                                              @G32DSMI 38928132
         BAL   RET,WTO09500             LINK TO GET DSNAME     @G32DSMI 38928232
*                                                              @G32DSMI 38928332
         BAL   RET,WTO09300             FINISH MESSAGE         @G32DSMI 38928432
*                                                              @G32DSMI 38928532
         BAL   RET,WTO02000             LINK TO ISSUE WTO      @G32DSMI 38928632
*                                                              @G32DSMI 38928732
         BAL   RET,WTO09150             SET THE MOUNT BIT      @G32DSMI 38928832
*                                                              @G32DSMI 38928932
         BAL   RET,WTO04000             LINK TO TELL TERMINAL  @G32DSMI 38929032
*                                                              @G32DSMI 38929132
         XC    DXVOLSR1,DXVOLSR1        CLEAR REJECT VOL SER   @G32DSMI 38929232
         B     WTO01000                 BRANCH TO EXIT         @G32DSMI 38929332
*                                                              @G32DSMI 38929432
*                                                              @G32DSMI 38929532
***************************************************************@G32DSMI 38929632
*                                                              @G32DSMI 38929732
*        REMOVE FILE PROTECT RING MESSAGE                      @G32DSMI 38929832
*                                                              @G32DSMI 38929932
***************************************************************@G32DSMI 38930032
*                                                              @G32DSMI 38930132
MIEC135A DC    CL16'IEC135A U'          REMOVE FILE PROT RING  @G32DSMI 38930232
*              DESC=(2),ROUT=(1)        ROUTING & DESCRIPTOR   @G32DSMI 38930332
*              0AL4(0),B'123456789ABCDEF0',B'123456789ABCDEF0' @G32DSMI 38930432
IEC135AC DC    0AL4(0),B'0100000000000000',B'0010000000000000' @G32DSMI 38930532
*                                                              @G32DSMI 38930632
*                                                              @G32DSMI 38930732
*IEC135A U DDD,VOLSER,JOBNAME,STEPNAME,DSNAME                  @G32DSMI 38930832
*                                                              @G32DSMI 38930932
***************************************************************@G32DSMI 38931032
*                                                              @G32DSMI 38931132
        EJECT                                                           38931232
*****************************************************************Y02134 38931332
*                                                                Y02134 38931432
*        IEC534D DESTROY LABEL MESSAGE                           YM1238 38931532
*                                                                Y02134 38931632
*****************************************************************Y02134 38931732
*                                                                Y02134 38931832
IEC534D  DS    0H                       DESTROY LABEL RTN      @ZA03694 38931932
*                                                                Y02134 38932032
         BAL   RET,WTO05000             LINK TO GET MESSAGE AREA Y02134 38932132
         USING *,RET                    ESTABLISH BASE         @ZA03694 38932232
*                                                                       38932637
         MVC   WTOMSGID(L'MIEC534D),MIEC534D DESTROY LABEL MSG @ZA03694 38933237
         MVC   WTODRCDS,IEC534DC        ROUT & DESC CODES      @ZA01544 38933837
         DROP  RET                                             @ZA03694 38934037
*                                                                Y02134 38934237
         BAL   RET,WTO09100             GET VOLSER & UNIT        Y02134 38934537
*                                                                Y02134 38934737
         BAL   RET,WTO09600             LINK TO GET LABEL TYPE   YM1238 38934837
*                                                                Y02134 38934937
         L     R1,DXREG0                GET DSNAME ADDRESS       YM3855 38935037
         BAL   RET,WTO09510             LINK TO GET DSNAME       Y02134 38935137
*                                                                Y02134 38935237
         BAL   RET,WTO09300             FINISH MESSAGE           Y02134 38935437
         USING *,RET                    ESTABLISH BASE         @ZA03694 38935637
*                                                                Y02134 38935837
         LA    RC,IEC534DL              POINT TO REPLY         @ZA01544 38936237
*                                       MESSAGE LENGTH         @ZA01544 38936437
         DROP  RET                                             @ZA03694 38936737
         BAL   RET,WTO03000             LINK TO ISSUE WTOR       Y02134 38936837
*                                                                Y02134 38937037
         B     WTO01000                 BRANCH TO EXIT           Y02134 38937237
*                                                                Y02134 38937737
*****************************************************************Y02134 38937937
*                                                                Y02134 38938137
*IEC534D A DDD,VOLSER,LBL,JOBNAME,STEPNAME,DSNAME              @ZA02881 38938337
*        R 00,'U' TO USE OR                                      Y02134 38938537
*        R 00,'M' TO UNLOAD                                      Y02134 38939537
*                                                                Y02134 38946502
*****************************************************************Y02134 38948502
*                                                                Y02134 38950502
MIEC534D DC    CL16'IEC534D A'          DESTROY LABEL REQUEST  @ZA03694 38952637
*              DESC=(2,7),ROUT=(1)    ROUTING & DESCRIPTOR CDS @ZA18541 38952837
*              0AL4(0),B'123456789ABCDEF0',B'123456789ABCDEF0'   YM7526 38957837
IEC534DC DC    0AL4(0),B'0100001000000000',B'1000000000000000' @ZA18541 38962837
*                                                                Y02134 38968202
IEC534DL DC    AL1(IEC534DE-IEC534DR)   LENGTH OF REPLY        @ZA01544 38969202
IEC534DR DC    C'''U''-USE OR ''M''-UNLOAD'                    @ZA01544 38969402
IEC534DE EQU   *                                               @ZA01544 38969502
*                                                              @ZA01544 38969602
*****************************************************************Y02134 38970002
*                                                                Y02134 38971802
         EJECT                                                          38973602
*                                                                Y02134 38974637
*****************************************************************Y02134 38974837
*                                                                Y02134 38975037
*        IEC704A STANDARD LABEL CREATE MESSAGE                   Y02134 38975237
*                                                                Y02134 38975337
*****************************************************************Y02134 38975937
*                                                                Y02134 38976137
IEC704A  DS    0H                       CREATE LABEL RTN       @ZA03694 38976337
*                                                                Y02134 38976537
         BAL   RET,WTO05000             LINK TO GET MESSAGE AREA Y02134 38976737
         USING *,RET                    ESTABLISH BASE         @ZA03694 38976937
*                                                                       38977437
         MVC   WTOMSGID(L'MIEC704A),MIEC704A CREATE LABEL MSG  @ZA03694 38978437
         MVC   WTODRCDS,IEC704AC        ROUT & DESC CODES      @ZA01544 38978637
*                                                                Y02134 38979037
         LA    R1,ZEROS                 POINT TO VOLSER OF ZERO  Y02134 38979237
         CLC   DXVOLSR2,SCRTCH          NON-SPECIFIC REQUEST     YM3855 38979337
         BE    WTO20410                 NO VOLSER IF SCRTCH    @ZA03694 38979437
         LA    R1,DXVOLSR2              POINT TO VOL SER         YM3855 38979537
*                                                                YM3855 38979637
WTO20410 EQU   *                        GET VOLSER AND UNIT    @ZA03694 38979737
*                                                                YM3855 38979837
         DROP  RET                                             @ZA03694 38980037
         BAL   RET,WTO09105             GET VOLSER & UNIT        YM3916 38980137
*                                                                Y02134 38980237
         BAL   RET,WTO09650             LINK TO GET LABEL, DEN   Y02134 38980337
*                                                                Y02134 38980437
         BAL   RET,WTO09500             LINK TO GET DSNAME       Y02134 38980537
*                                                                Y02134 38980637
         BAL   RET,WTO09300             FINISH MESSAGE           Y02134 38980737
         USING *,RET                    ESTABLISH BASE         @ZA03694 38980837
*                                                                Y02134 38980937
         LA    RC,IEC704AL              POINT TO REPLY         @ZA01544 38981337
*                                       MESSAGE LENGTH         @ZA01544 38981537
         CLC   DXVOLSR2,SCRTCH          SCRATCH REQUEST        @ZA02881 38981637
         BE    WTO20420                 YES, BRANCH            @ZA02881 38981737
         LA    RC,IEC704UL              POINT TO ALTERNATE     @ZA02881 38981837
*                                       REPLY MSG LENGTH       @ZA02881 38982037
WTO20420 EQU   *                        ISSUE WTOR             @ZA02881 38982237
*                                                                YM3855 38982437
         DROP  RET                                             @ZA03694 38982537
         BAL   RET,WTO03000             LINK TO ISSUE WTOR       Y02134 38982637
*                                                                Y02134 38982737
         B     WTO01000                 BRANCH TO EXIT           Y02134 38982837
*                                                                Y02134 38983437
*****************************************************************Y02134 38983537
*                                                                Y02134 38983637
*IEC704A L DDD,VOLSER,LBL,DEN,JOBNAME,STEPNAME,DSNAME          @ZA02881 38983737
*        R 00,'VOLSER,OWNER INFORMATION'                         Y02134 38983837
*        R 00,'M' TO UNLOAD                                      Y02134 38983937
*        R 00,'U' TO USE - ONLY APLICABLE FOR SCRATCH REQUEST  @ZA02881 38984037
*                                                                Y02134 38984137
*        IF VOLSER IS NOT SCRTCH IT APPEARS IN MESSAGE           YM3855 38984237
*                                                                Y02134 38984337
*****************************************************************Y02134 38984402
*                                                                Y02134 38986202
MIEC704A DC    CL16'IEC704A L'          CREATE STD LABEL MSG   @ZA03694 38988037
*              DESC=(2,7),ROUT=(1)    ROUTING & DESCRIPTOR CDS @ZA18541 38990237
*              0AL4(0),B'123456789ABCDEF0',B'123456789ABCDEF0'   YM7526 38994237
IEC704AC DC    0AL4(0),B'0100001000000000',B'1000000000000000' @ZA18541 38998237
*                                                                Y02134 39002402
IEC704AL DC    AL1(IEC704AE-IEC704AR)   LENGTH OF REPLY        @ZA01544 39003402
IEC704AR DC    C'''VOLSER,OWNER INFORMATION'' OR ''M'''        @ZA01544 39003602
IEC704AE EQU   *                                               @ZA01544 39003802
*                                                              @ZA01544 39004002
IEC704UL DC    AL1(IEC704UE-IEC704UR)   LENGTH OF REPLY        @ZA02881 39004137
IEC704UR DC    C'''VOLSER,OWNER INFORMATION'',''M''OR''U'''    @ZA02881 39004737
IEC704UE EQU   *                                               @ZA02881 39004937
*                                                              @ZA02881 39005137
*****************************************************************Y02134 39005437
*                                                                Y02134 39006002
         EJECT                                                          39007802
*                                                                Y02134 39008837
*****************************************************************Y02134 39009037
*                                                                Y02134 39009237
*        IEC512I SECURITY VOLUME MESSAGE                         YM1238 39009437
*                                                                Y02134 39009537
*****************************************************************Y02134 39010137
*                                                                Y02134 39010337
IEC512IS DS    0H                       SECURITY MSG RTN       @ZA03694 39010537
*                                                                Y02134 39010737
         LA    RC,WTO01000              LOAD MOUNT RETURN ADR  @ZA03694 39011037
*                                                                Y02134 39011137
         BAL   RET,WTO05000             LINK TO GET MESSAGE AREA Y02134 39011237
         USING *,RET                    ESTABLISH BASE         @ZA03694 39011637
*                                                                       39011837
         MVC   WTOMSGID(L'IEC512I1),IEC512I1 SEC VOL MSG       @ZA03694 39012037
*                                                                       39012237
         B     IEC512I                  FINISH MESSAGE         @ZA03694 39012637
         DROP  RET                                             @ZA03694 39013137
*                                                                Y02134 39013337
*****************************************************************Y02134 39013437
*                                                                Y02134 39013537
*IEC512I SEC VOL DDD,VOLSER,LBL,JOBNAME,STEPNAME,DSNAME          YM1238 39013637
*                                                                Y02134 39013737
*****************************************************************Y02134 39013837
*                                                                Y02134 39013937
IEC512I1 DC    CL16'IEC512I SEC VOL'    SECURITY MESSAGE       @ZA03694 39014037
*                                                                Y02134 39014137
*****************************************************************Y02134 39014237
*                                                                Y02134 39014337
         EJECT                                                          39014437
*                                                                Y02134 39014537
*****************************************************************Y02134 39014637
*                                                                Y02134 39014737
*        IEC512I I/O ERROR MESSAGE                                      39014837
*                                                                Y02134 39014937
*****************************************************************Y02134 39015037
*                                                                Y02134 39015137
IEC512II DS    0H                       I/O ERROR MSG RTN      @ZA03694 39015237
*                                                                Y02134 39015337
         LA    RET,WTO01000             LOAD MOUNT RETURN ADR  @ZA03694 39015437
*                                                                       39015537
IEC512IA EQU   *                        INTERNAL ENTRY         @ZA03694 39015637
*                                                                       39015737
         LR    RC,RET                   SAVE RETURN REG        @ZA03694 39015837
         BAL   RET,WTO05000             LINK TO GET MESSAGE AREA Y02134 39015937
         USING *,RET                    ESTABLISH BASE         @ZA03694 39016037
*                                                                       39016137
         MVC   WTOMSGID(L'IEC512I2),IEC512I2 I/O ERR MSG       @ZA03694 39016237
         B     IEC512I                  FINISH MESSAGE         @ZA03694 39016337
         DROP  RET                                             @ZA03694 39016437
*                                                                Y02134 39016537
*****************************************************************Y02134 39016637
*                                                                Y02134 39016737
*IEC512I I/O ERR DDD,VOLSER,LBL,JOBNAME,STEPNAME,DSNAME          YM1238 39016837
*                                                                Y02134 39016937
*****************************************************************Y02134 39017037
*                                                                Y02134 39017137
IEC512I2 DC    CL16'IEC512I I/O ERR'    I/O ERROR MESSAGE      @ZA03694 39017237
*                                                                Y02134 39017337
*****************************************************************Y02134 39017437
*                                                                Y02134 39017537
         EJECT                                                          39017637
*                                                                Y02134 39017737
*****************************************************************Y02134 39017837
*                                                                Y02134 39017937
*        IEC512I LABEL ERROR MESSAGE                                    39018137
*                                                                Y02134 39018337
*****************************************************************Y02134 39018537
*                                                                Y02134 39018737
IEC512IL DS    0H                       LABEL ERROR MSG RTN    @ZA03694 39018937
*                                                                       39019837
         LA    RC,WTO01000              LOAD MOUNT RETURN ADR  @ZA03694 39019937
*                                                                       39020037
         BAL   RET,WTO05000             LINK TO GET MESSAGE AREA Y02134 39020137
         USING *,RET                    ESTABLISH BASE         @ZA03694 39020237
*                                                                       39020337
         MVC   WTOMSGID(L'IEC512I3),IEC512I3 I/O ERR MSG       @ZA03694 39020437
         DROP  RET                                             @ZA03694 39020537
*                                                                Y02134 39020637
         LA    R1,DXVOLSR2              POINT TO VOL RQSTD     @ZA03694 39020737
         BAL   RET,WTO09105             LINK TO GET VOLSER     @ZA03694 39020837
*                                                                       39020937
         BAL   RET,WTO09674             GET LABEL TYPE         @ZA03694 39021037
         USING *,RET                    ESTABLISH BASE         @ZA03694 39021137
*                                                                       39021237
         MVC   WTOVOL2,WTOVOLSR         REQUESTED VOL          @ZA03694 39021437
         MVC   WTOLBL2,WTOLBLTP         REQUESTED LABEL        @ZA03694 39021637
         MVC   WTOVOLSR,BLANKS          RESET                  @ZA03694 39021837
         MVC   WTOLBLTP,BLANKS          RESET                  @ZA03694 39022837
*                                                                       39022937
         B     IEC512I                  FINISH MESSAGE         @ZA03694 39023737
         DROP  RET                                             @ZA03694 39023837
*                                                                Y02134 39023937
*****************************************************************Y02134 39024037
*                                                                       39024137
*IEC512I LBL ERR DDD,VOLSER,LBL,VOLREQ,LBLREQ,JOBNAME,STEPNAME,DSNAME   39024237
*                                                                       39025137
*****************************************************************Y02134 39025237
*                                                                Y02134 39025337
IEC512I3 DC    CL16'IEC512I LBL ERR'    LABEL ERROR MESSAGE    @ZA03694 39025437
*                                                                Y02134 39025537
*****************************************************************Y02134 39025637
*                                                                Y02134 39025737
         EJECT                                                          39025837
*                                                                Y02134 39026037
*****************************************************************Y02134 39027037
*                                                                Y02134 39027137
*        IEC512I SEC VOL - I/O ERROR - LABEL ERROR MESSAGE              39027237
*                                                                Y02134 39028237
*****************************************************************Y02134 39028337
*                                                                Y02134 39028437
IEC512I  DS    0H                       ERROR MESSAGE          @ZA03694 39029437
*                                                                Y02134 39029637
         BALR  RET,0                    ADDRESSABILITY         @ZA03694 39029837
         USING *,RET                    ESTABLISH BASE         @ZA03694 39030837
*                                                                       39031837
         MVC   WTODRCDS,IEC512IC        ROUT & DESC CODES      @ZA01544 39032337
         DROP  RET                                             @ZA03694 39033337
*                                                                Y02134 39033937
         BAL   RET,WTO09100             GET VOLSER & UNIT        Y02134 39034937
*                                                                Y02134 39035137
         BAL   RET,WTO09600             LINK TO GET LABEL TYPE   Y02134 39035337
*                                                              @ZA02881 39035537
         BAL   RET,WTO09500             LINK TO GET DSNAME     @ZA02881 39036537
*                                                                Y02134 39036737
         BAL   RET,WTO09300             FINISH MESSAGE           Y02134 39036937
*                                                                Y02134 39037137
         BAL   RET,WTO02000             LINK TO ISSUE WTO        Y02134 39037337
*                                                                Y02134 39037537
         MVI   DXECB,ECBCOD7F           SET ECB COMPLETE       @ZA03196 39037737
         LR    RET,RC                   RESTORE RETURN REGISTER  Y02134 39037937
         BR    RET                      RETURN                   Y02134 39038937
*                                                                Y02134 39039137
*****************************************************************Y02134 39039437
*                                                                Y02134 39039637
*        IEC512I SEC VOL - I/O ERR - LBL ERR MESSAGE                    39039837
*                                                                Y02134 39040037
*****************************************************************Y02134 39040237
*                                                                Y02134 39040437
*IEC512I DC    CL16'IEC512I'            ERROR MESSAGE          @ZA03694 39040637
*              DESC=(4),ROUT=(2,10)     ROUTING & DESCRIPTOR CDS YM7526 39041237
*              0AL4(0),B'123456789ABCDEF0',B'123456789ABCDEF0'   YM7526 39041437
IEC512IC DC    0AL4(0),B'0001000000000000',B'0100000001000000'   YM7526 39041637
*                                                              @ZA02881 39043437
*****************************************************************Y02134 39043637
*                                                                Y02134 39043802
         EJECT                                                          39045602
*                                                                       39045837
*********************************************************************** 39046037
*                                                                       39046237
*        IEC513D I/O ERROR OPERATOR INTERVENTION MESSAGE                39046437
*                                                                       39046537
*********************************************************************** 39046637
*                                                                       39046837
IEC513D  DS    0H                       I/O ERROR OPER MSG     @ZA03196 39046937
*                                                                       39047037
         BAL   RET,WTO05000             LINK TO GET MSG AREA   @ZA03196 39047237
         USING *,RET                    ESTABLISH BASE         @ZA03694 39047337
*                                                                       39047537
         MVC   WTOMSGID(L'MIEC513D),MIEC513D I/O ERR MSG       @ZA03196 39047637
         MVC   WTODRCDS,IEC513DC        ROUT & DESC CODES      @ZA03196 39047837
         DROP  RET                                             @ZA03196 39048037
*                                                                       39048137
         BAL   RET,WTO09100             GET VOLSER & UNIT      @ZA03196 39048237
*                                                                       39048437
         BAL   RET,WTO09600             LINK TO GET LABEL TYPE @ZA03196 39048637
*                                                                       39048837
         BAL   RET,WTO09500             LINK TO GET DSNAME     @ZA03196 39048937
*                                                                       39049037
         BAL   RET,WTO09300             FINISH MESSAGE         @ZA03196 39049137
         USING *,RET                    ESTABLISH BASE         @ZA03694 39049337
*                                                                       39049437
         LA    RC,IEC513DL              POINT TO REPLY         @ZA01544 39049737
*                                       MESSAGE LENGTH         @ZA01544 39049837
         DROP  RET                                             @ZA03196 39050037
         BAL   RET,WTO03000             LINK TO ISSUE WTOR     @ZA03196 39050237
*                                                                       39051137
         B     WTO01000                 RETURN                 @ZA03196 39051337
*                                                                       39051837
*********************************************************************** 39051937
*                                                                       39052037
*IEC513D I/O ERR DDD,VOLSER,LBL,JOBNAME,STEPNAME,DSNAME        @ZA03196 39052137
*        R 00,'U' TO ABEND OR                                  @ZA03196 39052337
*        R 00,'M' TO MOUNT A NEW TAPE                          @ZA03196 39052437
*                                                                       39052737
*********************************************************************** 39052837
*                                                                       39052937
MIEC513D DC    CL16'IEC513D I/O ERR'    I/O ERROR MESSAGE      @ZA03196 39053037
*              DESC=(2,7),ROUT=(1,10)    OUTING & DESCRIPTOR   @ZA18541 39053137
*              0AL4(0),B'123456789ABCDEF0',B'123456789ABCDEF0' @ZA03196 39053237
IEC513DC DC    0AL4(0),B'0100001000000000',B'1000000001000000' @ZA18541 39053337
*                                                                       39053437
IEC513DL DC    AL1(IEC513DE-IEC513DR)   LENGTH OF REPLY        @ZA03196 39053537
IEC513DR DC    C'''U''-ABEND OR ''M''-MOUNT SCRATCH'           @ZA19630 39053637
IEC513DE EQU   *                                               @ZA03196 39053737
*                                                                       39053837
*********************************************************************** 39053937
*                                                                       39054037
         EJECT                                                          39054137
*                                                                Y02134 39054437
*****************************************************************Y02134 39054637
*                                                                Y02134 39054837
*        IEC705I TAPE ATTRIBUTE MESSAGE                          Y02134 39054937
*                                                                Y02134 39055037
*****************************************************************Y02134 39055137
*                                                                Y02134 39055237
IEC705I  DS    0H                       TAPE ATTRIBUTE MSG RTN @ZA03694 39055337
*                                                                Y02134 39055437
         BAL   RET,WTO05000             LINK TO GET MESSAGE AREA Y02134 39055537
         USING *,RET                    ESTABLISH BASE         @ZA03694 39055637
*                                                                       39055737
         MVC   WTOMSGID(L'MIEC705I),MIEC705I TAPE ATTRIBUTES   @ZA01544 39055837
         MVC   WTODRCDS,IEC705IC        ROUT & DESC CODES      @ZA01544 39056137
         DROP  RET                                             @ZA03694 39056337
*                                                                Y02134 39056437
         BAL   RET,WTO09100             GET VOLSER & UNIT        Y02134 39056537
*                                                                Y02134 39056637
         BAL   RET,WTO09650             LINK TO GET LABEL, DEN   Y02134 39056737
*                                                                Y02134 39056837
         BAL   RET,WTO09500             LINK TO GET DSNAME       Y02134 39056937
*                                                                Y02134 39057037
         BAL   RET,WTO09300             FINISH MESSAGE           Y02134 39057137
*                                                                Y02134 39057237
         BAL   RET,WTO02000             LINK TO ISSUE WTO        Y02134 39057337
*                                                                Y02134 39057437
         B     WTO01000                 BRANCH TO EXIT           Y02134 39057537
*                                                                Y02134 39058637
*****************************************************************Y02134 39058837
*                                                                Y02134 39059037
*IEC705I TAPE ON DDD,VOLSER,LBL,DEN,JOBNAME,STEPNAME,DSNAME      Y02134 39059137
*                                                                Y02134 39061137
*****************************************************************Y02134 39061737
*                                                                Y02134 39062337
MIEC705I DC    CL16'IEC705I TAPE ON'    TAPE ATTRIBUTES MSG    @ZA03694 39062937
*              DESC=(4),ROUT=()         ROUTING & DESCRIPTOR CDS        39063502
*              0AL4(0),B'123456789ABCDEF0',B'123456789ABCDEF0'   YM7526 39064402
IEC705IC DC    0AL4(0),B'0001000000000000',B'0000000000000000' @ZA01278 39064802
*                                                                Y02134 39066202
*****************************************************************Y02134 39069002
*                                                                Y02134 39070802
         EJECT                                                          39225002
*                                                                Y02083 40321037
*****************************************************************Y02083 40322037
*                                                                Y02083 40323037
*        IEC254D REQUEST TO CREATE A NEW CHKPT DATA SET          Y02083 40324037
*                                                                Y02083 40325037
*****************************************************************Y02083 40326037
*                                                                Y02083 40327037
IEC254D  DS    0H                       CHECKPOINT CREATE RTN  @ZA03694 40327237
*                                                                       40327437
         BAL   RET,WTO05000             LINK TO GET MESSAGE AREA Y02083 40328037
         USING *,RET                    ESTABLISH BASE         @ZA03694 40329037
*                                                                       40330037
         MVC   WTODRCDS,IEC254D4        DESC &ROUT CDS         @ZA01544 40331037
         MVC   WTOMSGID(L'IEC254D1),IEC254D1 MSG SEG 1         @ZA01544 40332037
         DROP  RET                                             @ZA03694 40333037
         LA    RB,WTOMSGID+L'IEC254D1   INIT POSITION PTR      @ZA01544 40334037
*                                                                Y02083 40335037
         BAL   RET,WTO10100             GET JOB NAME             Y02083 40336037
         USING *,RET                    ESTABLISH BASE         @ZA03694 40336237
*                                                                Y02083 40337037
         MVC   K0(L'IEC254D2,RB),IEC254D2 MSG SEG 2              Y02083 40340037
         DROP  RET                                             @ZA03694 40341037
         LA    RB,L'IEC254D2(,RB)       BUMP POSITION PTR        Y02083 40342037
*                                                                Y02083 40343037
         BAL   RET,WTO10150             GET DDNAME,UNIT, & VOLID Y02083 40344037
         USING *,RET                    ESTABLISH BASE         @ZA03694 40344237
*                                                                Y02083 40345037
         MVC   K0(L'IEC254D3,RB),IEC254D3 MSG SEG 3              Y02083 40348037
         DROP  RET                                             @ZA03694 40349037
         LA    RB,L'IEC254D3(,RB)       BUMP POSITION PTR        Y02083 40350037
*                                                                Y02083 40351037
         MVI   WTOBREAK,BLANK           SET MSG BREAK CHAR     @ZA01544 40352037
         BAL   RET,WTO09330             GO FINISH MESSAGE      @ZA01544 40353037
         USING *,RET                    ESTABLISH BASE         @ZA03694 40353237
*                                                                Y02083 40354037
         LA    RC,IEC254DL              POINT TO REPLY         @ZA01544 40357037
*                                       MESSAGE LENGTH         @ZA01544 40358037
         DROP  RET                                             @ZA03694 40359037
         BAL   RET,WTO03000             LINK TO ISSUE WTOR       Y02083 40360037
*                                                                Y02083 40361037
         B     WTO01000                 BRANCH TO EXIT           Y02083 40362037
*                                                                Y02083 40363237
*****************************************************************Y02083 40363437
*                                                                Y02083 40363637
*IEC254D SHOULD JOBNAME USE (DDNAME,DDD,VOLSER) FOR CREATING     Y02083 40363737
*        A NEW CHECKPOINT DATA SET                               Y02083 40363837
*                                                                       40363937
*        R 00,'YES' TO ALLOW CREATION OR                       @ZA03196 40364037
*        R 00,'NO'  TO DISSALLOW                               @ZA03196 40364137
*                                                                Y02083 40364237
*****************************************************************Y02083 40364537
*                                                                Y02083 40364637
IEC254D1 DC    C'IEC254D SHOULD '       IEC254D SEG 1            Y02083 40364737
IEC254D2 DC    C' USE '                 IEC254D SEG 2            Y02083 40364837
IEC254D3 DC    C' FOR CREATING A NEW CHECKPOINT DATA SET' SEG 3  Y02083 40364937
*              DESC=(2,7),ROUT=(1)   ROUTING & DESCRIPTOR CDS  @ZA18541 40365137
*              0AL4(0),B'123456789ABCDEF0',B'123456789ABCDEF0'   YM7526 40365237
IEC254D4 DC    0AL4(0),B'0100001000000000',B'1000000000000000' @ZA18541 40365337
*                                                                YM7526 40365537
IEC254DL DC    AL1(IEC254DE-IEC254DR)   LENGTH OF REPLY        @ZA01544 40369537
IEC254DR DC    C'''YES'' OR ''NO'''                            @ZA01544 40369737
IEC254DE EQU   *                                               @ZA01544 40369937
*                                                              @ZA01544 40370737
*****************************************************************Y02083 40370937
*                                                                Y02083 40371137
         EJECT                                                          40371237
*                                                                Y02083 40371437
*****************************************************************Y02083 40371637
*                                                                Y02083 40371837
*        IEC255D QUERY CHKPT VOLUME SECURE STATUS                Y02083 40372037
*                                                                Y02083 40372237
*****************************************************************Y02083 40372437
*                                                                Y02083 40372637
IEC255D  DS    0H                       SECURE VOL CHKPT RTN   @ZA03694 40372737
*                                                                       40372937
         BAL   RET,WTO05000             LINK TO GET MESSAGE AREA Y02083 40373637
         USING *,RET                    ESTABLISH BASE         @ZA03694 40373837
*                                                                Y02083 40374037
         MVC   WTODRCDS,IEC255D4        DESC &ROUT CDS         @ZA01544 40376037
         MVC   WTOMSGID(L'IEC255D1),IEC255D1 MSG SEG 1         @ZA01544 40377037
         DROP  RET                                             @ZA03694 40378037
         LA    RB,WTOMSGID+L'IEC255D1   INIT POSITION PTR      @ZA01544 40379037
*                                                                Y02083 40380037
         BAL   RET,WTO10100             GET JOB NAME             Y02083 40381037
         USING *,RET                    ESTABLISH BASE         @ZA03694 40381237
*                                                                Y02083 40382037
         MVC   K0(L'IEC255D2,RB),IEC255D2 MSG SEG 2              Y02083 40385037
         DROP  RET                                             @ZA03694 40386237
         LA    RB,L'IEC255D2(,RB)       BUMP POSITION PTR        Y02083 40387037
*                                                                Y02083 40388037
         BAL   RET,WTO10150             GET DDNAME,UNIT, & VOLID Y02083 40389037
         USING *,RET                    ESTABLISH BASE         @ZA03694 40389237
*                                                                Y02083 40390037
         MVC   K0(L'IEC255D3,RB),IEC255D3 MSG SEG 3              Y02083 40393037
         DROP  RET                                             @ZA03694 40394237
         LA    RB,L'IEC255D3(,RB)       BUMP POSITION PTR        Y02083 40395037
*                                                                Y02083 40396037
         MVI   WTOBREAK,BLANK           SET MSG BREAK CHAR     @ZA01544 40397037
         BAL   RET,WTO09330             GO FINISH MESSAGE      @ZA01544 40398037
         USING *,RET                    ESTABLISH BASE         @ZA03694 40398237
*                                                                Y02083 40399037
         LA    RC,IEC255DL              POINT TO REPLY         @ZA01544 40402037
*                                       MESSAGE LENGTH         @ZA01544 40403037
         DROP  RET                                             @ZA03694 40404037
         BAL   RET,WTO03000             LINK TO ISSUE WTOR       Y02083 40405037
*                                                                Y02083 40406037
         B     WTO01000                 BRANCH TO EXIT           Y02083 40407037
*                                                                Y02083 40408037
*****************************************************************Y02083 40408237
*                                                                Y02083 40408437
*IEC255D JOBNAME IS (DDNAME,DDD,VOLSER) A SECURE                 Y02083 40408537
*        CHECKPOINT VOLUME                                       Y02083 40408637
*                                                                       40408837
*        R 00,'YES' IF SECURE OR                               @ZA03196 40408937
*        R 00,'NO'  IF NOT SECURE                              @ZA03196 40409137
*                                                                Y02083 40409237
*****************************************************************Y02083 40409337
*                                                                Y02083 40409437
IEC255D1 DC    C'IEC255D '              IEC255D SEG 1            Y02083 40410537
IEC255D2 DC    C' IS '                  IEC255D SEG 2            Y02083 40410637
IEC255D3 DC    C' A SECURE CHECKPOINT VOLUME' IEC255D SEG 3      Y02083 40410737
*              DESC=(2,7),ROUT=(1)   ROUTING & DESCRIPTOR CDS  @ZA18541 40410837
*              0AL4(0),B'123456789ABCDEF0',B'123456789ABCDEF0'   YM7526 40411837
IEC255D4 DC    0AL4(0),B'0100001000000000',B'1000000000000000' @ZA18541 40412837
*                                                                Y02083 40414137
IEC255DL DC    AL1(IEC255DE-IEC255DR)   LENGTH OF REPLY        @ZA01544 40414937
IEC255DR DC    C'''YES'' OR ''NO'''                            @ZA01544 40415137
IEC255DE EQU   *                                               @ZA01544 40415337
*                                                              @ZA01544 40415537
*****************************************************************Y02083 40415737
*                                                                Y02083 40415937
         EJECT                                                          40416237
*                                                                Y02083 40416437
*****************************************************************Y02083 40416637
*                                                                Y02083 40416837
*        IEC256A REVOKE SECURE STATUS OF CHKPT VOLUME            Y02083 40417037
*                                                                Y02083 40417237
*****************************************************************Y02083 40417437
*                                                                Y02083 40417637
IEC256A  DS    0H                       REVOKE SECURE VOL RTN  @ZA03694 40417737
*                                                                       40418237
         BAL   RET,WTO05000             LINK TO GET MESSAGE AREA Y02083 40418437
         USING *,RET                    ESTABLISH BASE         @ZA03694 40418637
*                                                                Y02083 40418937
         MVC   WTODRCDS,IEC256A4        DESC &ROUT CDS         @ZA01544 40421037
         MVC   WTOMSGID(L'IEC256A1),IEC256A1 MSG SEG 1         @ZA01544 40422037
         DROP  RET                                             @ZA03694 40423037
         LA    RB,WTOMSGID+L'IEC256A1   INIT POSITION PTR      @ZA01544 40424037
*                                                                Y02083 40425037
         BAL   RET,WTO10100             GET JOB NAME             Y02083 40426037
*                                                                Y02083 40427037
         LA    RB,K1(,RB)               LEAVE A BLANK            Y02083 40428037
*                                                                Y02083 40429037
         BAL   RET,WTO10150             GET DDNAME,UNIT, & VOLID Y02083 40430037
         USING *,RET                    ESTABLISH BASE         @ZA03694 40430237
*                                                                Y02083 40431037
         MVC   K0(L'IEC256A2,RB),IEC256A2 MSG SEG 2            @ZA03694 40434037
         DROP  RET                                             @ZA03694 40435037
         LA    RB,L'IEC256A2(,RB)       BUMP POSITION PTR      @ZA03694 40436037
*                                                                Y02083 40437037
         MVI   WTOBREAK,BLANK           SET MSG BREAK CHAR     @ZA01544 40438037
         BAL   RET,WTO09330             GO FINISH MESSAGE      @ZA01544 40439037
*                                                                Y02083 40440037
         BAL   RET,WTO02000             LINK TO ISSUE WTO        Y02083 40441037
*                                                                Y02083 40442037
         B     WTO01000                 BRANCH TO EXIT           Y02083 40443037
*                                                                Y02083 40444037
*****************************************************************Y02083 40545037
*                                                                Y02083 40595037
*IEC256A JOBNAME (DDNAME,DDD,VOLSER) IS NO LONGER A SECURE       Y02083 40596037
*        CHECKPOINT VOLUME                                       Y02083 40597037
*                                                                Y02083 40598037
*****************************************************************Y02083 40745037
*                                                                Y02083 40795037
IEC256A1 DC    C'IEC256A '              IEC256A SEG 1            Y02083 41495037
IEC256A2 DC    C' IS NO LONGER A SECURE CHECKPOINT VOLUME' SEG 2        41545037
*              DESC=(3),ROUT=(2)        ROUTING & DESCRIPTOR CDS YM7885 41645037
*              0AL4(0),B'123456789ABCDEF0',B'123456789ABCDEF0'   YM7526 41695037
IEC256A4 DC    0AL4(0),B'0010000000000000',B'0100000000000000'   YM7885 41745037
*                                                                Y02083 41795037
*****************************************************************Y02083 42545037
*                                                                Y02083 42595037
         EJECT                                                          42645037
*                                                                Y02134 42695037
         XCTLTABL BRT=YES,LENGTH=                              @ZA02881 42745037
*                                                                Y02134 42795037
         EJECT                                                          42845037
WTOBUFFR DSECT                                                 @ZA01544 42895037
WTORAREA EQU   WTOBUFFR                 OFFSET FOR WTOR        @ZA01544 42945037
WTORPLYL DS    0X                       WTOR REPLY LENGTH      @ZA01544 42995037
WTORPLYP DS    A                        WTOR REPLY ADDRESS     @ZA01544 43045037
WTOECBAD DS    A                        WTOR ECB ADDRESS       @ZA01544 43095037
WTOAREA  DS    0A                       QFFSET FOR WTO         @ZA01544 43145037
WTOMSG1  DS    0A                       OFFSET TO LINE 1       @ZA01544 43195037
WTOLNGTH DS    H                        LINE 1 LENGTH          @ZA01544 43245037
WTOSWTCH DS    H                        MCS FLAGS              @ZA01544 43295037
MSG1STRT DS    0C                       START OF MESSAGE       @ZA01544 43345037
         ORG   WTOBUFFR+44                                     @ZA01544 43395037
WTOMSGID DS    CL7                      LINE 1 MESSAGE ID      @ZA01544 43445037
         DS    C                        BLANK                  @ZA01544 43495037
WTOINSTR DS    CL7                      MESSAGE INSTRUCTION    @ZA01544 43545037
         DS    C                        BALNK                  @ZA01544 43595037
WTOUNIT  DS    CL3                      UNIT ADDRESS           @ZA01544 43645037
         DS    C                        COMMA                  @ZA01544 43695037
WTOVOLSR DS    CL6                      VOLUME SERIAL NUMBER   @ZA01544 43745037
         DS    C                        COMMA                  @ZA01544 43795037
WTOSPACE DS    0CL30                    SPACE INFORMATION      @ZA02881 43845037
WTOLBLTP DS    CL3                      LABEL TYPE             @ZA02881 43895037
         DS    C                        COMMA                  @ZA01544 43945037
WTOVOL2  DS    CL6                      REQUESTED VOL SER      @ZA02881 43995037
         DS    C                        COMMA                  @ZA02881 44045037
WTOLBL2  DS    CL3                      REQUESTED LBL TYPE     @ZA02881 44095037
         DS    17C                                             @ZA02881 44145037
WTODEN   DS    0CL8                     DENSITY                @ZA01544 44195037
WTOADDN  DS    CL10                     DDNAME                 @ZA01544 44245037
         DS    C                        COMMA                  @ZA01544 44295037
WTOJOB   DS    CL8                      JOBNAME                @ZA01544 44345037
         DS    C                        COMMA                  @ZA01544 44395037
WTOSTEP  DS    CL8                      STEPNAME               @ZA01544 44445037
         DS    C                        COMMA                  @ZA01544 44495037
WTODSN   DS    CL44                     DSNAME                 @ZA01544 44545037
WTOEND   DS    0X                       END OF MESSAGE TEXT    @ZA01544 44595037
WTOCODES DS    XL4                      DESC AND ROUT CODES    @ZA01544 44645037
WTOLINE1 DS    XL3                      LINE 1 TYPE            @ZA01544 44695037
WTONLINE DS    X                        NUMBER OF LINES        @ZA01544 44745037
WTOMSG2  DS    0X                       LINE 2                 @ZA01544 44795037
WTOLGTH2 DS    XL2                      LINE 2 LENGTH          @ZA01544 44845037
WTOLINE2 DS    XL2                      LINE 2 TYPE            @ZA01544 44895037
WTOMSID2 DS    CL8                      MESSAGE ID FOR LINE 2  @ZA01544 44945037
WTOEND2  DS    0C                       END LINE 2             @ZA01544 44995037
         ORG   WTOBUFFR+250                                    @ZA01544 45045037
WTOBREAK DS    C                        MESSAGE BREAK CHAR     @ZA01544 45095037
WTODRCDS DS    XL4                      DESC AND ROUTE SAVE    @ZA01544 45145037
WTOTSOSW DS    X                        TSO TPUT SWITCH        @ZA01544 45195037
MSG1MAX  EQU   WTOMSGID+34              OFFSET TO LINE 1 END   @ZA20470 45245037
WTOBUFFL EQU   256                      LENGTH OF BUFFER       @ZA01544 45295037
         ORG   WTOBUFFR                                        @ZA18506 45300037
*                                                              @ZA18506 45305037
*        PARMLIST FOR DEQ VOLSER SUBROUTINE                    @ZA18506 45310037
*                                                              @ZA18506 45315037
DEQRTN   DS    F                        RETURN ADDRESS SAVE    @ZA18506 45320037
DEQLIST  DS    0CL(DEQPLTH)             DEQ PARMLIST           @ZA18506 45325037
         DS    F                        FULLWORD FOR TCB       @ZA18506 45330037
DEQ      EQU   *                        MACRO PARMLIST SKIPS   @ZA18506*45335037
                                        TCB ADDRESS            @ZA18506 45340037
         IECDSECS CVT,ASCB,TCB,JSCB,TIOT,PSCB,UPT,SMF,BASE,PSA,  Y02134X45345037
               UCB,DCB,MAIN,PREFX,WTG,DSAB,EXPAND=YES          @ZA04633 45395037
         IECEQU                                                         45445037
         EJECT                                                          45495037
         IECDIOCM                                                Y02134 45545037
         EJECT                                                          45595037
         ICBMNTDE MF=(L,MAP),TYPE=MNT                                   45645037
SCRPACK  EQU   X'10'                    FLAG BIT FOR SCRATCH   @G18MSBS 45695037
SCNDRY   EQU   X'20'                    SECONDARY ALLOC FLAG   @G18MSBS 45745037
MNTLSTX  EQU   X'08'                    MOUNT LIST EXT FLAG    @G18MSBS 45795037
MNTSIZE  EQU   *-ICBMNTD1               SIZE OF MOUNT LIST     @G18MSBS 45845037
         EJECT                                                          45895037
         IEZMNTXT                                                       45945037
MNTSAVE  DS    A                        MOUNT LIST PTR SAVED   @G18MSBS 45995037
         EJECT                                                          46045037
JCTABLE  DSECT                                                          46095037
         IEFAJCTB                                              @G18MSBS 46145037
         EJECT                                                          46195037
SCTABLE  DSECT                                                 @G18MSBS 46245037
         IEFASCTB                                              @G18MSBS 46295037
         EJECT                                                          46345037
         END                                                            46395037
