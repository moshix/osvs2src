         TITLE 'IFG0196M/OPEN - DCB TO JFCB MERGE'                      00100021
         COPY  LCGASMSW                                                 00150000
IFG0196M CSECT                                                          00400021
*********************************************************************** 00450002
*             VS2037 DELETIONS/CHANGES                                * 00460037
*0000339000-343000                                             @ZA25724 00462037
*315000-316000                                                 @ZA14154 00463037
*D315000-31600                                                 @ZA33498 00464037
*********************************************************************** 00466037
* MODULE NAME = IFG0196M (OS/VS2)                                     * 00470002
*                                                                     * 00480002
* DESCRIPTIVE NAME = DCB TO JFCB MERGE                                * 00490002
*                                                                     * 00492002
* COPYRIGHT = NONE                                                    * 00494002
*                                                                     * 00496002
* STATUS = RELEASE 2, LEVEL 0                                         * 00498002
*                                                                     * 00498402
* FUNCTION =                                                          * 00498802
*        1. MERGE DCB FIELDS TO JFCB FIELDS.  THE FIELDS MERGED ARE   * 00498902
*        A FUNCTION OF THE ACCESS METHOD USED.                        * 00499002
*                                                                     * 00499102
*        2. TEST FOR CONFLICTS BETWEEN ASCII AND EBCDIC DATA SET      * 00499202
*        SPECIFICATIONS.                                              * 00499302
*                                                                     * 00499602
* NOTES = SEE BELOW                                                   * 00499702
*                                                                     * 00499802
*    DEPENDENCIES =                                                   * 00499902
*            CLASS ONE CHARACTER CODE.  THE EBCDIC CHARACTER CODE     * 00500002
*            WAS USED FOR ASSEMBLY.  THE MODULE MUST BE REASSEMBLED   * 00533202
*            IF A DIFFERENT CHARACTER SET IS USED FOR EXECUTION.      * 00543202
*                                                                     * 00553202
*    RESTRICTIONS = NONE                                              * 00563202
*                                                                     * 00565202
*    REGISTER CONVENTIONS =                                           * 00565602
*            R2 POINTS TO DCB                                         * 00566002
*            R4 POINTS TO OPEN WORK AREA                              * 00566402
*            R5 POINTS TO THE RESIDENT ROUTINE                        * 00566502
*            R6 POINTS TO THE WTG TABLE                               * 00566602
*            R7 POINTS TO THE CURRENT PARAMETER LIST ENTRY            * 00577702
*            R8 POINTS TO THE CURRENT WTG TABLE ENTRY                 * 00587702
*            R9 POINTS TO THE DD ENTRY IN THE TIOT                    * 00588102
*            R10 POINTS TO THE UCB                                    * 00588502
*                                                                     * 00588602
*    PATCH LABEL = SEE NEXT TO LAST LABEL BEFORE ORG STATEMENT AT END * 00588702
*                  OF LISTING.                                        * 00588802
*                                                                     * 00592502
* MODULE TYPE = CONTROL (OPEN, CLOSE, EOV DATA MANAGEMENT)            * 00594502
*                                                                     * 00594902
*    PROCESSOR = ASSEMBLER XF                                         * 00595302
*                                                                     * 00595702
*    MODULE SIZE = SEE EXTERNAL SYMBOL DICTIONARY OR LOC FIELD ON     * 00596102
*                  ORG STATEMENT AT END OF LISTING                    * 00596202
*                                                                     * 00609602
*    ATTRIBUTES = REENTRANT, REFRESHABLE,READ-ONLY, ENABLED,          * 00619602
*                  PRIVILEGED, SUPERVISOR STATE, DATA MANAGEMENT KEY, * 00621602
*                  LINK PACK AREA RESIDENT/PAGEABLE                   * 00622002
*                                                                     * 00622402
* ENTRY POINT = IFG0196M FROM IFG0196L                                * 00624402
*                                                                     * 00626702
*    PURPOSE = SEE FUNCTION                                           * 00627602
*                                                                     * 00628502
*    LINKAGE =                                                        * 00629402
*        IECRES LOAD,ID6L6M,BRANCH=QUEUED                             * 00630002
*                                                                     * 00630302
* INPUT = STANDARD                                                    * 00631602
*                                                                     * 00632102
* OUTPUT = MERGED FIELDS IN THE JFCB IN THE DCB WORK AREA             * 00636502
*                                                                     * 00638502
* EXIT-NORMAL =                                                       * 00640502
*        IFG0196N TAPE OUTPUT SECURITY PROCESSING                     * 00640602
*        IFG0196P USER LABEL (ALIAS FOR IFG0555J)                     * 00640702
*        IFG0196O NSL OUTPUT                                          * 00640802
*        IFG0196V ACCESS METHOD DETERMINATION                         * 00640902
*                                                                     * 00641002
* EXIT-ERROR =                                                        * 00644702
*        IFG0190P PROBLEM DETERMINATION                               * 00645902
*           013 ABEND FOR MIXED ASCII AND NON-ASCII TAPE OPTIONS      * 00646302
*                                                                     * 00646702
* EXTERNAL REFERENCES = SEE BELOW                                     * 00647102
*                                                                     * 00647502
*    ROUTINES = NONE                                                  * 00647902
*                                                                     * 00648302
*    DATA AREAS = NONE                                                * 00648402
*                                                                     * 00648502
*    CONTROL BLOCK = NONE                                             * 00649002
*                                                                     * 00649402
* TABLES = NONE                                                       * 00649802
*                                                                     * 00649902
* MACROS = IECDSECS, MODESET, DMABCOND, IECRES, XCTLTABL, IECEQU      * 00653202
*                                                                     * 00655202
* CHANGE ACTIVITY = NEW RELEASE (LEVEL 0)                             * 00655602
*                                                                     * 00656002
*********************************************************************** 00656402
         EJECT                                                          00656502
         IECDSECS TIOT,UCB,DCB,MAIN,WTG,DSAB                     Y02134 11000002
         IECEQU ,                       DEFINE EQUATES                  11300021
*                                                                       11400021
         USING IHADCB,RDCB              DEFINE BASE TO USER'S DCB       11500021
         USING FORCORE,RCORE            DEFINE BASE TO MAIN WORK AREA   11600021
         USING WTG,RWTG                 WHERE-TO-GO TABLE        Y02080 11650002
         USING TIOENTRY,RTIOT           DEFINE BASE TO TIOT DD ENTRY    11700021
         USING UCBOB,RUCB               DEFINE BASE TO MAIN UCB         11800021
*                                                                       11900021
         BALR  RBASE,0                  ESTABLISH BASE REGISTER         12000021
         USING *,RBASE                  DEFINE BASE REGISTER            12100021
*                                                                       12200021
         MVI   DXCCW11+K1,0             ZERO REVERSE MERGE FIELD Y02134 12250002
         BAL   RC,OMG47700              GO DETERMINE IF HIARCHY IS MEAN 12300021
         B     OMG41000                 RETURN HERE IF NOT MEANINGFUL   12400021
*  RETURN HERE IF HIARCHY IS MEANINGFUL.                                12500021
         MVC   DXCCW11(K1),JFCBFTEK     PRESERVE SETTING OF HIARCHY     12600021
         NI    DXCCW11,JFCBH1           ONLY SAVE HIARCHY        A36911 12650021
         NI    JFCBFTEK,X'FF'-JFCBH1    FLAG,  THEN INSURE THAT         12700021
*  HIARCHY FLAG DOES NOT INTERFERE WITH MERGE OF BFTEK/BFALN            12800021
*  FROM DCB TO JFCB (WHEN INPUT/INOUT).                                 12900021
OMG41000 EQU   *                        MERGE PROCESS                   13000002
         TM    JFCBTSDM,JFCNDCB         TEST IF DCB TO JFCB MERGE IS    13100021
         BO    OMG46500                 INHIBITED, BR IF YES            13200021
*                                                                       13300021
*                                                                       13400021
*        DCB/JFCB MERGE                                                 13500021
*                                                                       13600021
         TM    DCBMACRF,DCBMEXCP        CHECK FOR EXCP                  13700021
         BNO   OMG43400                 BR IF NOT EXCP                  13800021
         LA    R1,K15                   POINT TO FBE IN MERGE TABLE     13900021
         TM    DCBMACRF,DCBMFOUN        IS F.B.E. PRESENT               14000021
         BZ    OMG46800                 BR NO, SKIP BACK MERGE          14100021
         TM    DCBMACRF,DCBMAPP         EXCP INTERFACE PRESENT          14200021
         BO    OMG44800                 BR IF YES TO MERGE              14300021
         LA    R1,K16                   DO NOT MERGE OPTCD FIELD        14400021
         B     OMG44800                 BRANCH TO MERGE                 14500021
*                                                                       14600021
OMG43400 EQU   *                        NOT EXCP                        14700002
         LA    RF,K5                    SET INDICATOR FOR BSAM          14800021
         TM    DCBMACRF,DCBMREAD        IS MACRF = READ                 14900021
         BO    OMG43600                 BR IF YES, BSAM                 15000021
         TM    DCBMACRF+K1,DCBMWRIT     IS MACRF = WRITE                15100021
         BO    OMG43600                 BR IF YES, BSAM                 15200021
         SR    RF,RF                    SET INDICATOR FOR QSAM          15300021
OMG43600 EQU   *                        BSAM                            15400002
         TM    DCBDSORG,DCBORGPS        IS IT PHYSICAL SEQUENTIAL       15500021
         BO    OMG43800                 BR IF YES                       15600021
         TM    DCBDSORG,DCBORGPO        IS IT PARTITIONED               15700021
         BO    OMG44000                 BR IF YES, BPAM                 15800021
         SR    R1,R1                    POINT TO ISAM IN MERGE TABLE    15900021
         TM    DCBDSORG,DCBORGIS        IS IT INDEXED SEQUENTIAL        16000021
         BO    OMG44800                 BR IF YES TO MERGE              16100021
         TM    DCBDSORG,DCBORGDA        IS IT DIRECT ACCESS ORG         16200021
         LA    R1,K8                    POINT TO DAM IN MRG TABLE       16300021
         BO    OMG44800                 BR IF YES                       16400021
         TM    DCBDSORG,DCBORGCX        IS IT COMM LINE GROUP           16500021
         BO    OMG44200                 BR IF YES                       16600021
         TM    DCBDSORG+K1,DCBORGTX     IS THIS TCAM LINE GROUP         16700021
         BO    OMG44200                 BR IF YES                       16800021
         TM    DCBDSORG,DCBORGCQ        IS IT COMM D.A. GROUP           16900021
         BO    OMG46800                 BR IF YES, CQ ACCESS METHOD     17000021
         TM    DCBDSORG+K1,DCBORGTQ     IS THIS TCAM MSG QUEUE          17100021
         BO    OMG46800                 BR IF YES                       17200021
         TM    DCBDSORG,DCBORGMQ        IS IT PROCESS PGM MSG QUEUE     17300021
         BO    OMG44600                 BR IF YES                       17400021
         TM    DCBDSORG+K1,DCBORGTQ+DCBORGGR  IS IT TCAM TQ OR GRAPHIC  17500021
         BM    OMG44100                 BR IF YES                       17600021
*                                                                       17700021
*                                       DEFAULT TO PS/PO                17800021
*                                                                       17900021
OMG43800 EQU   *                        PHYSICAL SEQUENTIAL             18000002
         LA    R1,K5                    POINT TO QSAM IN MERGE TABLE    18100021
         LTR   RF,RF                    READ/WRITE OR GET/PUT           18200021
         BZ    OMG44800                 BR IF GET/PUT                   18300021
OMG44000 EQU   *                        BPAM                            18400002
         LA    R1,K10                   POINT TO SAM AND PAM IN MRGTAB  18500021
         B     OMG44800                 BR TO MERGE                     18600021
*                                                                       18700021
OMG44100 EQU   *                        TCAM TQ OR GRAPHIC              18800002
         LA    R1,K22                   PT TO GRAPHICS IN MERGE TABLE   18900021
         B     OMG44800                 BR IF MERGE                     19000021
*                                                                       19100021
OMG44200 EQU   *                        TCAM LINE GROUP                 19200002
         LA    R1,K18                   POINT TO TAM IN MERGE TABLE     19300021
         LTR   RF,RF                    READ/WRITE OR GET/PUT           19400021
         BNZ   OMG44800                 BR IF R/W TO MERGE              19500021
         TM    0(RPARC),PLISTM0C        CHECK FOR INPUT OR INOUT        19600021
         BNZ   OMG44300                 BR IF NO                        19700021
         CLI   JFCINTVL,K0              IS INTVL=0                      19800021
         BNE   OMG44400                 BR IF NO                        19900021
OMG44300 EQU   *                        NOT INPUT OR INOUT              20000002
         MVC   JFCINTVL,K24(RDCB)       ****MERGE INTVL****             20100021
         MVI   DXCCW11+K1,K255          SET REVERSE MERGE FIELD  Y02134 20150002
OMG44400 EQU   *                        NOT INTVL                       20200002
         TM    0(RPARC),PLISTM0C        CHECK FOR INPUT OR INOUT        20300021
         BNZ   OMG44500                 BR IF NO                        20400021
         CLI   JFCCPRI,K0               IS CPRI=0                       20500021
         BNE   OMG44800                 BR IF NO                        20600021
OMG44500 EQU   *                        NOT INPUT OR INOUT              20700002
         MVC   JFCCPRI,K32(RDCB)        ****MERGE CPRI****              20800021
         MVI   DXCCW11+K1,K255          SET REVERSE MERGE FIELD  Y02134 20850002
         B     OMG44800                 BR TO MERGE                     20900021
OMG44600 EQU   *                        PROCESS PGM MSG QUEUE           21000002
         LA    R1,K18                   POINT TO TAM IN MERGE TABLE     21100021
         LTR   RF,RF                    READ/WRITE OR GET/PUT           21200021
         BNZ   OMG44800                 BR IF READ/WRITE                21300021
         TM    0(RPARC),PLISTM0C        CHECK FOR INPUT OR INOUT        21400021
         BNZ   OMG44700                 BR IF NO                        21500021
         NC    JFCSOWA,JFCSOWA          IS SOWA = 0                     21600021
         BNZ   OMG44800                 BR IF NO                        21700021
OMG44700 EQU   *                        NOT INPUT OR INOUT              21800002
         MVC   JFCSOWA,24(RDCB)         ****MERGE SOWA****              21900021
         MVI   DXCCW11+K1,K255          SET REVERSE MERGE FIELD  Y02134 21950002
*                                                                       22000021
OMG44800 EQU   *                        SOWA NOT ZERO                   22100002
*                                                                       22200021
*********************************************************************** 22300021
*                                                                       22400021
*        DCB TO JFCB MERGE ROUTINE                                      22500021
*                                                                       22600021
*                                                                       22700021
         LR    R0,RDCB                  DCB WORK REGISTER               22800021
         LA    RET,OMG4800K(R1)         DCB DISP PTR FOR MERGE  SA56418 22900002
         LA    RF,OMG4840K(R1)          JFCB DISP PTR FOR MERGE SA56418 23000002
         LA    RD,OMG4860K(R1)          FIELD LENGTHS FOR JFCB- SA56418 23100002
*                                       ..DCB MERGE             SA56418 23150002
*                                                                       23500021
OMG44900 EQU   *                        START LOOP PROCESS              23600002
         LA    RUCB,DXJBF               JFCB ADDRESS                    23700021
         SR    RC,RC                    CLEAR REGISTER                  23800021
         IC    RC,0(,RET)               PICK UP DCB DISP                23900021
         AR    RDCB,RC                  POINT TO DCB FIELD              24000021
         IC    RC,0(,RF)                PICK UP JFCB DISP               24100021
         AR    RUCB,RC                  POINT TO JFCB FIELD             24200021
         IC    RC,0(,RD)                PICK UP FIELD LENGTH-1          24300021
         TM    0(RPARC),PLISTM0C        CHECK FOR INPUT OR INOUT        24400021
         BNZ   OMG45200                 BR IF NO                        24500021
OMG45000 EX    RC,OMG45100              CHECK FOR ZERO FIELD            24600021
         BNZ   OMG45600                 BR IF FIELD IS NOT ZERO         24700021
         B     OMG45400                 BR TO MERGE FIELD               24800021
*                                                                       24900021
OMG45100 NC    0(*-*,RUCB),0(RUCB)      CHECK FOR ZERO FIELD            25000021
*                                                                       25100021
OMG45200 EQU   *                        NOT INPUT OR INOUT              25200002
         CLI   0(RET),X'1A'             IS THIS FIELD DSORG             25300021
         BE    OMG45000                 BR IF IT IS DSORG               25400021
OMG45400 EQU   *                        MERGE FIELD                     25500002
         EX    RC,OMG46200              ****EXECUTE THE MERGE****       25600021
         MVI   DXCCW11+K1,K255          SET REVERSE MERGE FIELD  Y02134 25650002
*                                                                       25700021
OMG45600 EQU   *                        FIELD NOT ZERO                  25800002
         LA    RET,K1(RET)              STEP DCB DISP POINTER           25900021
         TM    0(RET),X'FF'             TEST IF AT END OF MERGE         26000021
         BZ    OMG46400                 BR IF AT END OF MERGE           26100021
         BO    OMG46300                 BRANCH IF END OF A.M. MERGE     26200021
         LA    RF,K1(RF)                STEP JFCB DISP POINTER          26300021
         LA    RD,K1(RD)                STEP FIELD LENGTH POINTER       26400021
OMG45800 EQU   *                        RESET DCB PT AND LOOP           26500002
         LR    RDCB,R0                  RESET DCB POINTER               26600021
         B     OMG44900                 BR TO START OF LOOP             26700021
*                                                                       26800021
OMG46200 MVC   0(*-*,RUCB),0(RDCB)      ****MERGE****                   26900021
*                                                                       27000021
OMG46300 EQU   *                        END OF AM MERGE                 27100002
         LA    RET,OMG4810K             RESET POINTERS                  27200021
         LA    RF,OMG4850K                                              27300021
         LA    RD,OMG4870K                                              27400021
         B     OMG45800                 BR TO RESET DCB PTR AND LOOP    27500021
*                                                                       27600021
OMG46400 EQU   *                        END OF MERGE                    27700002
         LR    RDCB,R0                  RESTORE DCB ADDRESS             27800021
*                                                                       27900021
OMG46500 EQU   *                        MERGE INHIBITED                 28000002
         BAL   RC,OMG47700              GO DETERMINE IF HIARCHY IS MEAN 28100021
         B     OMG46700                 RETURN HERE IF NOT MEANINGFUL   28200021
*  RETURN HERE IF HIARCHY IS MEANINGFUL.                                28300021
         NI    JFCBFTEK,X'FF'-DCBH0-DCBH1  INSURE THAT HIARCHY NOT      28400021
*              MERGED TO JFCB ALONG WITH BFTEK/BFALN.                   28500021
         OC    JFCBFTEK,DXCCW11         RESET HIARCHY FLAG              28600021
         TM    DCBBFTEK,DCBH0+DCBH1     TEST,BR IF HIARCHY ALREADY      28700021
         BM    OMG46700                 EXISTS IN DCB                   28800021
*  AT NO TIME SHOULD DCBBFTEK BITS 0,5 = 1,1.  IF THEY ARE SET 1,1      28900021
*  THEN THIS ERROR DEFAULTS TO HIARCHY=0 (UNLESS JFCBH1 IS ON).         29000021
         NI    DCBBFTEK,X'FF'-DCBH0-DCBH1                               29100021
         TM    JFCBFTEK,JFCBH1          TEST,BR IF USER HAS NOT         29200021
         BZ    OMG46600                 REQUESTED HIARCHY=1 IN DD       29300021
         OI    DCBBFTEK,DCBH1           SET HIARCHY=1 IN DCB            29400021
         B     OMG46700                 BR TO CONTINUE                  29500021
OMG46600 EQU   *                        HIARCHY = ONE                   29600002
         OI    DCBBFTEK,DCBH0           SET HIARCHY=O IN DCB            29700021
OMG46700 EQU   *                        CONTINUE                        29800002
         TM    DXCCW11+K1,K255          ANY REVERSE MERGE?       Y02134 29850002
         BZ    OMG46800                 BRANCH IF NO             Y02134 29860002
         TM    K0(RPARC),PLISTM0C       INPUT,INOUT, OR RDBACK?  Y02134 29870002
         BNZ   OMG46800                 BRANCH IF NO             Y02134 29880002
         L     RC,DXDSAB                LOAD CURRENT DSAB ADDR   Y02134 29890002
         USING DSAB,RC                                           Y02134 29892002
         MODESET EXTKEY=SCHED           GET INTO SCHEDULER KEY   Y02082 29892802
         OI    DSABFLG2,DSABIRM         SET INPUT REVERSE MERGE  Y02134 29894002
         MODESET EXTKEY=DATAMGT         RETURN TO DATA MGT KEY   Y02082 29894402
*                                       BIT IN DSAB              Y02134 29896002
         DROP  RC                                                Y02134 29898002
OMG46800 EQU   *                        NO REVERSE MERGE                29900002
*                                                                       30000021
*********************************************************************** 30100021
*                                                                       30200021
         TM    TIOELINK,TIOESYIN+TIOESYOT SPOOLED DATA SET?      Y02120 30250002
         BM    OMG47600                 BRANCH IF YES            Y02120 30260002
         L     RUCB,TIOEFSRT-K1         RESTORE FIRST UCB ADDR          30300021
*                                                                       30400021
         TM    JFCBMASK+K4,JFCMNULL     TEST IF DUMMY DATA SET          30500021
         BO    OMG47600                 BR IF YES                       30600021
*                                                                       30700021
* ABEND IF HAVE ASCII OPTCD=Q WHEN NOT TAPE, NOT DUMMY, NOT EXCP, M0943 30750021
* BUT PS OR PO (SAM)                                              M0943 30760021
*                                                                 M0943 30770021
         TM    UCBTBYT3,UCB3TAPE        TAPE DEVICE               M0943 30792021
         BO    OMG46860                 YES, GO SKIP ABEND        M0943 30794021
         TM    DCBMACRF,DCBMEXCP        EXCP DCB                  M0943 30798021
         BO    OMG46860                 YES, GO SKIP ABEND        M0943 30798421
         TM    DCBDSORG,DCBORGPO+DCBORGPS  PS OR PO (SAM)         M0943 30798821
         BZ    OMG46860                 NO, BR, OPTCD=Q TEST NOT  M0943 30799221
*                                       VALID                     M0943 30799621
         TM    DCBOPTCD,DCBOPTQ         OPTCD=Q                   M0943 30799721
         BO    OMG47100                 YES, ABEND, BAD OPTCD     M0943 30799821
*                                                                 M0943 30799921
OMG46860 EQU   *                        BACK MERGE SKIPPED        M0943 30833202
*                                                                       31000021
         TM    UCBTBYT3,UCB3DACC        TEST IF DIRECT ACCESS           31100021
         BO    OMG47500                 BR IF YES                       31200021
*                                                                       31300021
         TM    UCBTBYT3,UCB3TAPE        TEST IF MAGNETIC TAPE           31400021
         BNO   OMG47600                 BR IF NOT TAPE                  31500021
**********************************************************************  31510037
*                                                                       31800021
*  TEST FOR CONFLICTS BETWEEN ASCII AND EBCDIC DATA SET SPECIFICATIONS  31900000
*  AND MERGE DCBBUFOF AND DCBUSASI TO JFCBUFOF.                         31950021
*                                                                       32000021
OMG46868 EQU   *                                               @ZA14154 32050037
         TM    DCBMACRF,DCBMEXCP        EXCP DCB                        32100021
         BO    OMG47300                 YES, BRANCH                     32200021
*                                                                       32300021
         TM    DCBOPTCD,DCBOPTQ         ASCII DATA SET, OPTCD=Q  A43865 32700021
         BZ    OMG47000                 NO, GO TEST FOR ASCII FLDS      32800021
*                                                                       32900021
         TM    JFCBLTYP,JFCSL           STANDARD LABEL WANTED           33000021
         BO    OMG47100                 BR IF YES - LABEL ERROR         33100021
*                                                                       33200021
         TM    DCBRECFM,DCBRECUN        U-FORMAT RECORDS                33300021
         BO    OMG46900                 BR IF YES                       33400021
         TM    DCBRECFM,DCBRECVR        VARIABLE RECORDS SPEC.          33500021
         BO    OMG47100                 BR IF YES TO ERROR EXIT         33600021
*                                                                       33700021
OMG46900 CLI   DCBBUFOF,K99             BUFOF GREATER THAN 99           33800021
         BH    OMG47100                 BR IF YES TO ERROR              33900021
         TM    JFCBTSDM,JFCNDCB         JFCB MERGE INHIBITED   @ZA25724 34000037
         BO    OMG47300                 YES, GO SKIP MERGE     @ZA25724 34010037
         TM    PLISTOPT(RPARC),PLISTOIN OPEN FOR OUTPUT/INOUT  @ZA25724 34020037
         BNO   OMG46920                 NO, BR INPUT PROCESS   @ZA25724 34030037
         CLI   DCBBUFOF,K0              DOES BUFFER OFFSET = 0 @ZA25724 34040037
         BH    OMG46910                 NO-CONTINUE            @ZA25724 34050037
         TM    DCBUSASI,DCBBLBP         BUFOF=L SPECIFIED      @ZA25724 34060037
         BNO   OMG46930                 NO, MERGE BUFOF=NOT L  @ZA25724 34070037
*                                       TO JFCB                @ZA25724 34080037
OMG46905 EQU   *                                               @ZA25724 34090037
         TM    DCBRECFM,JFCVARD         D-TYPE RECORD FORMAT   @ZA25724 34100037
         BNO   OMG47100                 NO. BR TO ERROR EXIT   @ZA25724 34110037
*                                       BUFOF=L ONLY VALID FOR @ZA25724 34120037
*                                       D-TYPE RECORD FORMAT   @ZA25724 34130037
         B     OMG46940                 MERGE BUFOF=L TO JFCB  @ZA25724 34140037
*                                                              @ZA25724 34150037
OMG46910 TM    DCBUSASI,DCBBLBP         BUFOF = L SPECIFIED    @ZA25724 34160037
         BNO   OMG47100                 NO, BR TO ERROR EXIT     A43865 34350021
*                                       CAN'T HAVE NON-ZERO BUFOF       34400021
*                                       FOR OUTPUT UNLESS BUFOF=L.      34450021
*                                       IBM DOES NOT SUPPORT BUFOF      34500021
*                                       FOR OUTPUT (EXCEPT =L).         34550021
         B     OMG46905                 CHECK D-TYPE RECORDS   @ZA25724 34600037
*                                                              @ZA25724 34650037
OMG46920 EQU   *                        NOT OPENED FOR OUTPUT    A43865 34800002
         CLI   JFCBUFOF,K0              BUFOF IN JFCB            A43865 34850021
         BNE   OMG47300                 YES, GO SKIP MERGE       A43865 34860021
         TM    DCBUSASI,DCBBLBP         BUFOF=L SPECIFIED        A43865 34870021
         BO    OMG46940                 YES, GO SKIP MERGE     @ZA25724 34880037
*                                                              @ZA25724 34882037
OMG46930 EQU   *                                               @ZA25724 34884037
         MVC   JFCBUFOF,DCBBUFOF        MERGE BUFOF NOT =L       A43865 34886037
         B     OMG46960                 GO SET JFCB MODIFIED     A43865 34888037
*                                                              @ZA25724 34890037
OMG46940 EQU   *                        MERGE BUFOF=L            A43865 34892037
         MVI   JFCBUFOF,JFCBFOFL+K4     MERGE BUFOF=L AND 4 BYTE A43865 34899221
*                                       OFFSET TO JFCB           A43865 34899621
OMG46960 EQU   *                        SET JFCB MODIFIED        A43865 34899702
         OI    JFCBMASK+4,JFCMJMOD      SET JFCB MODIFIED        A43865 34899821
         B     OMG47300                 GO TO RESUME PROCESSING         34900021
*                                                                       35000021
*   CHECK FOR ASCII FIELD FOR EBCDIC DATA SETS                          35100021
OMG47000 EQU   *                        CHECK FOR ASCII FIELDS          35200021
         TM    JFCBLTYP,JFCBAL          ASCII LABEL SPECIFIED           35300021
         BO    OMG47100                 YES, BRANCH - ERROR             35400021
*                                                                       35500021
         TM    DCBRECFM,DCBRECUN        IS RECFM U, F OR V      SA41465 35550021
         BNZ   OMG47300                 BRANCH IF YES           SA41465 35560021
*                                                                       35610002
         TM    DCBRECFM,DCBRECD         D-TYPE RECORD FORMAT    SA56418 35660002
         BNO   OMG47300                 NO, BR TO CONTINUE      SA56418 35710002
*                                                                       35800021
*   IF ANY CONFLICTS IN DCB ATTRIBUTES, PROCESSING OF THIS              35900021
*   DCB WILL BE DISCONTINUED AFTER GOING TO PROBLEM DETERMINATION       36000021
*   TO WRITE AN ERROR MESSAGE.                                          36100021
*                                                                       36200021
OMG47100 EQU   *                        GO TO PROB DETERM               36300002
OABD047  EQU   47                       MIXED EBCDIC AND ASCII          36400021
*                                       ATTRIBUTES OR INVALID  @ZA14154 36500037
*                                       TRTCH FOR MAGNETIC TAPE         36530037
         DMABCOND OABD047,ID6M0P        XCTL TO PROBLEM DET / ABEND     36600002
*                                                                       36700021
*********************************************************************** 37100021
*                                                                       37200021
*  PROCESSING FOR MAGNETIC TAPE ONLY.  DETERMINE NEXT MODULE TO GO TO.  37300021
*                                                                       37400021
OMG47300 EQU   *                                                        37450002
*                                                                       37460002
         TM    0(RPARC),X'07'           TEST IF OPEN FOR OUTPUT         37500021
         BNO   OMG47600                 BR IF NOT OUTPUT OR OUTIN       37600021
*                                                                       37700021
         TM    JFCBIND2,JFCOLD          IS THIS DISP=MOD (NOT NEW, OLD) 37800021
         BNO   OMG47600                 BR IF MOD                       37900021
*                                                                       38000021
         TM    JFCBLTYP,JFCSL+JFCBAL    TEST IF LABEL=SL, SUL, AL, AUL  38100021
         BNZ   OMG47400                 BR IF YES                       38200021
*                                                                       38300021
         TM    JFCBLTYP,JFCNSL          TEST IF LABEL=NSL               38400021
         BNO   OMG47600                 BR IF NOT NSL, ASSUME NL        38500021
*                                                                       38600021
         IECRES LOAD,MODID=ID6M6O,BRCODE=4,BRANCH=QUEUED         Y02080 38750002
*                                   XCTL TO NSL OUTPUT INTERFACE Y02080 38760002
*                                                                       38800021
OMG47400 EQU   *                        STANDARD LABEL                  38900002
         IECRES LOAD,MODID=ID6M6N,BRCODE=0,BRANCH=QUEUED         Y02080 39050002
*                                 XCTL TO MAG TAPE OUTPUT SL MOD Y02080 39060002
*                                                                       39100021
*********************************************************************** 39200021
*                                                                       39300021
*  PROCESSING FOR DIRECT ACCESS ONLY.  DETERMINE IF OUTPUT UHL.         39400021
*                                                                       39500021
OMG47500 EQU   *                        DIRECT ACCESS                   39600002
         TM    JFCBMASK+K5,X'04'        TEST IF OUTPUT UL NEEDED        39700021
         BZ    OMG47600                 BR IF NO                        39800021
*                                                                       39900021
         NI    JFCBMASK+K5,X'FF'-X'04'  CLEAR OPEN UL INDICATOR         40000021
*                                                                       40100021
         L     RC,DXCCW6                RESTORE EXIT ADDR FOR UL MOD    40200021
*                                                                       40300021
         MVC   DXRETMOD,ID6M6V          MODULE FOR UL TO XCTL TO NEXT   40400002
         IECRES LOAD,MODID=ID6M6P,BRCODE=0,BRANCH=QUEUED         Y02080 40550002
*                                  XCTL TO OUTPUT DA USER LABELS Y02080 40560002
*                                                                       40600021
*********************************************************************** 40700021
*                                                                       40800021
OMG47600 EQU   *                        GO TO IFG0196V                  40900002
         IECRES LOAD,MODID=ID6M6V,BRCODE=0,BRANCH=QUEUED         Y02080 41050002
*                                 XCTL TO SELECT EXECUTOR MODULE Y02080 41060002
*                                                                       41100021
*********************************************************************** 41200021
*                                                                       41300021
OMG47700 EQU   *                        IS HIARCHY MEANINGFUL           41400002
         TM    DCBMACRF,DCBMEXCP        TEST IF EXCP                    41500021
         BZ    OMG47800                 BR IF NO                        41600021
         TM    DCBMACRF,DCBMFOUN        IS FBE PRESENT                  41700021
         BCR   8,RC                     BR IF NO                        41800021
OMG47800 EQU   *                        NOT EXCP                        41900002
         TM    DCBDSORG,DCBORGIS+DCBORGDA+DCBORGPO  IS IT - IS, DA, PO  42000021
         BM    K4(,RC)                  BR IF YES                       42100021
         TM    DCBDSORG,DCBORGPS        IS THIS PS                      42200021
         BNO   OMG47900                 BR IF NO                        42300021
         TM    TIOELINK,TIOEQNAM        IS THIS TCAM PS                 42400021
         BCR   1,RC                     BR IF YES                       42500021
         B     K4(,RC)                  BR, IT IS NORMAL PS             42600021
OMG47900 TM    DCBDSORG+K1,DCBORGGR+DCBORGTQ+DCBORGTX  IS IT - GR,TQ,TX 42700021
         BCR   4,RC                     BR IF YES                       42800021
*  ELIMINATED ALL EXCEPT TAM.  FOR TAM, ONLY (CX)BTAM HAS               42900021
*  VALID HIARCHY FLAGS.                                                 43000021
         TM    DCBMACRF,DCBMREAD        IS MACRF = READ                 43100021
         BO    K4(,RC)                  BR IF YES, BTAM                 43200021
         TM    DCBMACRF+K1,DCBMWRIT     IS MACRF = WRITE                43300021
         BO    K4(,RC)                  BR IF YES, BTAM                 43400021
         BR    RC                       BR NO HIARCHY                   43500021
*                                                                       43600021
**********************************************************************  43700021
         EJECT                                                          43800021
**********************************************************************  43900021
*                                                                       44000021
*                                                                       44100021
*                                                                       44200021
*        THE FOLLOWING ARE DISPLACEMENTS WITHIN THE DCB                 44300021
*                                                                       44400021
*                                                                       44500021
*                                                                       44600021
*        OF FIELDS WHICH WILL BE MERGED TO THE DCB FROM THE JFCB        44700021
*                                                                       44800021
*                                                                       44900021
*                                                                       45000021
**********************************************************************  45100021
OMG4800K EQU   *                                                        45200021
*                   ****ISAM SECTION OF MERGE TABLE FOLLOWS****         45300021
         DC    FL1'54'                  ISAM NTM                        45400021
         DC    FL1'55'                  ISAM CYLOF                      45500021
         DC    FL1'60'                  ISAM RKP                        45600021
         DC    FL1'112'                 ISAM DUBFN                      45700021
         DC    FL1'72'                  ISAM NCP                        45800021
         DC    FL1'84'                  ISAM-QSAM EROPT                 45900021
         DC    FL1'82'                  ISAM-QSAM LRECL                 46000021
         DC    X'FF'                    ****DIVISION LINE*****          46100021
*                   ****BDAM SECTION OF MERGE TABLE FOLLOWS****         46200021
         DC    FL1'81'                  BDAM LIMCT                      46300021
         DC    X'FF'                    ****DIVISION LINE****           46400021
*                   ****BSAM SECTION OF MERGE TABLE FOLLOWS****         46500021
         DC    FL1'72'                  BSAM NCP                        46600021
         DC    FL1'82'                  BSAM LRECL                      46700021
         DC    X'FF'                    *****DIVISION LINE****          46800021
*                                       COMMON SECTION FOLLOWS          46900021
OMG4810K EQU   *                                                        47000021
         DC    FL1'16'                  KEY LENGTH                      47100021
         DC    FL1'62'                  BLOCK SIZE                      47200021
OMG4820K EQU   *                                                        47300021
         DC    FL1'52'                  OPTCOD                          47400021
         DC    FL1'26'                  DSORG                           47500021
         DC    FL1'18'                  DEN                             47600021
OMG4830K EQU   *                                                        47700021
         DC    FL1'32'                  BFTEK OR BFALN                  47800021
         DC    FL1'24'                  BUFL                            47900021
         DC    FL1'20'                  BUFNO                           48000021
         DC    X'00'                    ****END OF TABLE****            48100021
*                   ****GRAPHICS SECTION OF MERGE TABLE FOLLOWS****     48200021
         DC    FL1'26'                  DSORG                           48300021
         DC    FL1'32'                  GNCP                            48400021
         DC    X'00'                    ****END OF GRAPHICS****         48500021
**********************************************************************  48600021
         EJECT                                                          48700021
**********************************************************************  48800021
*                                                                       48900021
*                                                                       49000021
*                                                                       49100021
*        THE FOLLOWING ARE THE DISPLACEMENTS OF FIELDS IN THE           49200021
*                                                                       49300021
*                                                                       49400021
*                                                                       49500021
*        JFCB WHICH WILL BE MERGED INTO THE DCB                         49600021
*                                                                       49700021
*                                                                       49800021
*                                                                       49900021
**********************************************************************  50000021
OMG4840K EQU   *                                                        50100021
*                   ****ISAM SECTION OF MERGE TABLE FOLLOWS****         50200021
         DC    FL1'107'                 ISAM NTM OFFSET                 50300021
         DC    FL1'110'                 ISAM CYLOF OFFSET               50400021
         DC    FL1'108'                 ISAM RKP OFFSET                 50500021
         DC    FL1'111'                 ISAM DUBFN OFFSET               50600021
         DC    FL1'106'                 ISAM NCP OFFSET                 50700021
         DC    FL1'92'                  ISAM-QSAM EROPT OFFSET          50800021
         DC    FL1'104'                 ISAM-QSAM LRECL OFFSET          50900021
         DC    X'FF'                    ****DIVISION LINE****           51000021
*                   ****BDAM SECTION OF MERGE TABLE FOLLOWS****         51100021
         DC    FL1'95'                  BDAM LIMCT OFFSET               51200021
         DC    X'FF'                    ****DIVISION LINE****           51300021
*                   ****BSAM SECTION OF MERGE TABLE FOLLOWS****         51400021
         DC    FL1'106'                 BSAM NCP OFFSSET                51500021
         DC    FL1'104'                 BSAM LRECL OFFSET               51600021
         DC    X'FF'                    ****DIVISION LINE****           51700021
OMG4850K EQU   *                                                        51800021
         DC    FL1'93'                  KEY LENGTH OFFSET               51900021
         DC    FL1'102'                 BLOCKSIZE OFFSET                52000021
         DC    FL1'101'                 OPTCOD OFFSET                   52100021
         DC    FL1'98'                  DSORG                           52200021
         DC    FL1'94'                  DEN OFFSET                      52300021
         DC    FL1'89'                  BFTEK-BALN OFFSET               52400021
         DC    FL1'90'                  BUFL OFFSET                     52500021
         DC    FL1'88'                  BUFNO OFFSET                    52600021
         DC    X'00'                    END OF TABLE**********          52800021
*                   ****GRAPHICS SECTION OF MERGE TABLE FOLLOWS****     52900021
         DC    FL1'98'                  DSORG                           53000021
         DC    FL1'89'                  GNCP                            53100021
         DC    X'00'                    END OF GRAPHICS                 53200021
**********************************************************************  53300021
         EJECT                                                          53400021
**********************************************************************  53500021
*                                                                       53600021
*                                                                       53700021
*                                                                       53800021
*        THE FOLLOWING ARE THE LENGTHS-1 OF THE FIELDS                  53900021
*                                                                       54000021
*                                                                       54100021
*                                                                       54200021
*        WHICH ARE MERGED FROM THE JFCB TO THE DCB                      54300021
*                                                                       54400021
*                                                                       54500021
*                                                                       54600021
**********************************************************************  54700021
OMG4860K EQU   *                                                        54800021
*                   ****ISAM SECTION OF MERGE TABLE FOLLOWS****         54900021
         DC    FL1'0'                   ISAM NTM LGH                    55000021
         DC    FL1'0'                   ISAM CYLOF LGH                  55100021
         DC    FL1'1'                   ISAM RKP LGH                    55200021
         DC    FL1'0'                   ISAM DUBFN LGH                  55300021
         DC    FL1'0'                   ISAM NCP LGH                    55400021
         DC    FL1'0'                   ISAM-QSAM EROPT LGH             55500021
         DC    FL1'1'                   ISAM-QSAM LRECL LGH             55600021
         DC    X'FF'                    ****DIVISION LINE****           55700021
*                   ****BDAM SECTION OF MERGE TABLE FOLLOWS****         55800021
         DC    FL1'2'                   BDAM LIMCT LGH                  55900021
         DC    X'FF'                    ****DIVISION LINE****           56000021
*                   ****BSAM SECTION OF MERGE TABLE FOLLOWS****         56100021
         DC    FL1'0'                   BSAM NCP LGH                    56200021
         DC    FL1'1'                   BSAM LRECL LGH                  56300021
         DC    X'FF'                    ****DIVISION LINE*******        56400021
OMG4870K EQU   *                                                        56500021
         DC    FL1'0'                   KEY LENGTH LENGHT               56600021
         DC    FL1'1'                   BLOCK SIZE LENGTH               56700021
         DC    FL1'0'                   OPTCOD LGH                      56800021
         DC    FL1'1'                   DSORG                           56900021
         DC    FL1'0'                   DEN LGH                         57000021
         DC    FL1'0'                   BFTEK-BALN LGH                  57100021
         DC    FL1'1'                   BUFL LGH                        57200021
         DC    FL1'0'                   BUFNO LGH                       57300021
         DC    X'00'                    ****END OF TABLE****            57500021
*                   ****GRAPHICS SECTION OF MERGE TABLE FOLLOWS****     57600021
         DC    FL1'1'                   DSORG                           57700021
         DC    FL1'0'                   GNCP                            57800021
         DC    X'00'                    ****END OF GRAPHICS****         57900021
*********************************************************************** 58000021
         EJECT                                                          58100021
*                                                                       58200021
         XCTLTABL ID=(ID6M0P,0P,ID6M6N,6N,ID6M6P,6P,             YM3076X58450002
               ID6M6O,6O,ID6M6V,6V),BRT=YES,LENGTH=              Y02080 58460002
*                                                                       58500021
         IECDSECS EXPAND=YES            EXPAND DESIRED DSECTS HERE      58600021
*                                                                       58700021
         END                                                            58800021
