         TITLE 'IFG0200Y - CLOSE ACCESS METHOD RETURN FUNCTION - DA'    00100000
IFG0200Y CSECT                                                          00400021
         ENTRY IGG0200F,IGG0200G                                 Y02080 00450002
IGG0200F EQU   IFG0200Y                 ALLIAS ENTRY POINT       Y02080 00460002
IGG0200G EQU   IFG0200Y                 ALLIAS ENTRY POINT       Y02080 00470002
*********************************************************************** 00500021
*                                                                     * 00600021
*          VS2 RELEASE 3.7 CHANGES,DELETIONS                          * 00602037
*0000                                                          @ZA14553 00604037
*0000725070-725840                                             @ZA16048 00605037
*                                                                     * 00606037
*          VS2 RELEASE 03 DELETIONS                                   * 00610037
*0000                                                          @ZA02202 00620037
*          VS2 RELEASE 02 DELETIONS                                   * 00630037
*0000                                                           ZA01327 00652002
*0000                                                          @ZA01343 00654002
*                                                                     * 00660002
*          VS1 RELEASE 1 DELETIONS/CHANGES                            * 00660402
*0000027000-034000                                               XM5598 00660802
*          VS1 RELEASE 2 DELETIONS/CHANGES                            * 00662002
*0000788000                                                      X02989 00664002
*0000788000,788200                                               XM1037 00666002
*0000297300,297700-298500                                       XA00547 00674002
*          VS2 RELEASE 01 DELETIONS                                     00680400
*0000                                                            YM0850 00682000
*0000303520-303540,303957-303960,303998,304020,303050-303075,    YM0993 00684000
*0000304225,304275                                               YM0993 00686000
*                                                                     * 00700021
*          RELEASE 21.7 DELETIONS/CHANGES                             * 01150002
*0000023000,033000-034000,034780-034784,057000-058000,          SA53753 01160002
*0000077000-078000,290500-290700,291000-292000,428000,          SA53753 01170002
*0000497000-560000,562000-615000,740000-743000,758000-          SA53753 01180002
*0000759000,787000-788000                                       SA53753 01190002
*          RELEASE 21 DELETIONS/CHANGES                               * 01200021
*0000587000,603000                                               M0194  01202021
*0000315000,339000,468090-468300,783000-787000                   M0171  01205021
*0000565600,613000                                               M0155  01210021
*                                                                A39245 01230021
*                                                                A39789 01260021
*                                                                A38013 01270021
*                                                                M0050  01280021
*0000478000-481000                                               M1801  01350021
*0000                                                           SA53186 01352002
*          VS2-2 DELETIONS/CHANGES                                    * 01360002
*339600-339920,342500                                           ZA01326 01364002
* MODULE NAME = IFG0200Y                                              * 01370002
*                                                                     * 01380002
* DESCRIPTIVE NAME = CLOSE ACCESS METHOD RETURN FUNCTION - DA         * 01390002
*                                                                     * 01392002
* COPYRIGHT = NONE                                                    * 01394002
*                                                                     * 01396002
* STATUS CHANGE LEVEL 000                                             * 01400021
*                                                                     * 01500021
* FUNCTION -                                                          * 01600021
*    THIS MODULE CONTAINS THE FUNCTION(S) OR PART(S) OF FUNCTION(S)-- * 01700021
*    CLOSE TAPE ACCESS METHOD EXECUTOR INTERFACE FUNCTION.            * 01800021
*    CLOSE UNIT RECORD/TELEPROCESSING FUNCTION.                       * 01900021
*    CLOSE DA ACCESS METHOD EXECUTOR INTERFACE FUNCTION.              * 02000021
*       THE ABOVE THREE FUNCTIONS STARTS IN MODULE IFG0200W.          * 02100021
*    CLOSE DA UPDATE DSCB FUNCTION.                                   * 02200021
*    REFER TO THE FOLLOWING 'FUNCTION PROLOG(S)' FOR DETAILS.         * 02500021
*    THE DEB ADDRESS WILL BE DELETED FROM THE DEB TABLE BY USE   Y02082 02550002
*    OF THE DEBCHK MACRO FOR ALL DCBS EXCEPT SPOOLED, AND        Y02082 02560002
*    SPOOLED ACBS. THIS WILL BE FOLLOWED BY A PURGE WITH THE     Y02082 02570002
*    HALT I/O AND NO POST OPTIONS FOR ALL DCBS EXCEPT SPOOLED.   Y02082 02580002
*    THE DATA MANAGEMENT COUNT WILL BE DECREMENTED FROM TAPE     YM6559 02590002
*    DEVICES WHICH ARE NOT READY.                                YM6559 02592002
*                                                                     * 02600021
* ENTRY POINTS -                                                      * 03462000
*         IFG0200Y - ENTRY POINT VIA AN XCTL FROM THE FOLLOWING--     * 03464000
*             IFG0200W   TELEPROCESSING FUNCTION, TAPE ACCESS METHOD  * 03472000
*                        EXECUTOR INTERFACE FUNCTION, AND DA ACCESS   * 03474000
*                        METHOD EXECUTOR INTERFACE FUNCTION.          * 03476000
*                                                                     * 03500021
* INPUT -                                                             * 03600021
*    ENTERED IN DATA MANAGEMENT KEY                              Y02082 03650002
*    REFER TO THE FOLLOWING 'FUNCTION PROLOG(S)'.                     * 03700021
*                                                                     * 03800021
* OUTPUT -                                                            * 03900021
*    EXIT IN DATA MANAGEMENT KEY                                 Y02082 03950002
*    REFER TO THE FOLLOWING 'FUNCTION PROLOG(S)'.                     * 04000021
*                                                                     * 04100021
* EXTERNAL REFERENCES -                                               * 04200021
*         IFG019RA - OPEN/CLOSE/EOV RESIDENT ROUTINE FOR XCTL AND     * 04300002
*                    WAIT.                                            * 04400021
*    REFER TO THE FOLLOWING 'FUNCTION PROLOG(S)'.                     * 04500021
*                                                                     * 04600021
* EXITS, NORMAL -                                                     * 04700021
*    EXIT VIA THE RESIDENT ROUTINE XCTL TO THE FOLLOWING--            * 04800021
*         IFG0200Z - PROCESS CLOSE TAPE STANDARD TRAILER LABEL        * 04900021
*                    FUNCTION.                                        * 05000021
*         IFG0202A - PROCESS CLOSE TAPE STANDARD USER LABEL FUNCTION. * 05100021
*         IFG0202B - PROCESS CLOSE TAPE NONSTANDARD LABEL FUNCTION.   * 05200021
*         IFG0202F - PROCESS CLOSE TAPE VOLUME DISPOSITION FUNCTION.  * 05270021
*         IFG0201R - PROCESS CLOSE DA WRITE DSCB FUNCTION.            * 05340021
*         IFG0202C - PROCESS CLOSE DA INPUT USER LABEL FUNCTION.      * 05410021
*         IFG0202E - PROCESS CLOSE DA EXIT FUNCTION.                  * 05500021
*         IFG0202J - PROCESS CLOSE FINAL STRING.                      * 05600021
*         IFG0202K - IF BUSY ACB                                      * 05650002
*         IFG0202L - IF VSAM ACB                                      * 05700002
*                                                                     * 05900021
* EXITS, ERROR -                                                      * 06000021
*    EXIT IS TO THE PROBLEM DETERMINATION MODULE IFG0200P, IF AN      * 06100021
*    ABEND SITUATION OCCURS IN THIS MODULE.  REFER TO THE FOLLOWING   * 06200021
*    'FUNCTION PROLOG(S)'.                                            * 06300021
*                                                                     * 06400021
* TABLES/WORK AREAS -                                                 * 06500021
*    REFER TO THE FOLLOWING 'FUNCTION PROLOG(S)'.                     * 06600021
*                                                                     * 06700021
* ATTRIBUTES -                                                        * 06800021
*    REENTRANT, REFRESHABLE, READ-ONLY, ENABLED, PRIVILEGED           * 06900021
*                                                                     * 07000021
* CHARACTER CODE DEPENDENCY -                                         * 07100021
*    CLASS ONE CHARACTER CODE DEPENDENCY - THE EBCDIC CHARACTER CODE  * 07200021
*    WAS USED FOR ASSEMBLY.  THE MODULE MUST BE REASSEMBLED IF A      * 07300021
*    DIFFERENT CHARACTER SET IS USED FOR EXECUTION.                   * 07400021
*                                                                     * 07500021
* NOTES -                                                             * 07600021
*    THIS MODULE ALSO HAS A NAME ALIAS OF IGG0200G FOR THE ACCESS     * 07900021
*    METHOD EXECUTORS TO RETURN TO.                                   * 08000021
*    REFER TO THE FOLLOWING 'FUNCTION PROLOG(S)'.                     * 08100021
*                                                                     * 08200021
*********************************************************************** 08300021
         EJECT                                                          08400021
         USING IHADCB,RDCB                                              08500021
         USING FORCORE,RCORE                                            08600021
         USING TCB,RET                                                  08700021
         USING UCBOB,RUCB                                               08800021
         USING CVT,RD                                                   08900021
         USING TIOENTRY,RTIOT                                           09000021
         USING DEB,RDEB                                                 09100021
         USING WTG,RWTG                                                 09200021
         USING WTGENTRY,RWTGC                                           09300021
         BALR  RBASE,0                  ESTABLISH BASE REGISTER         09400021
         USING *,RBASE                                                  09500021
         EJECT                                                          09600021
*                                                                     * 22400021
*                          FUNCTION PROLOG                            * 22500021
*                                                                     * 22600021
*********************************************************************** 22700021
*                                                                     * 22800021
* FUNCTION NAME -                                                     * 22900021
*    CLOSE  ACCESS METHOD EXECUTOR INTERFACE FUNCTION.                * 23000002
*                                                                     * 23100021
* (STATUS) -                                                          * 23200021
*    NOT APPLICABLE                                                   * 23300021
*                                                                     * 23400021
* FUNCTION -                                                          * 23500021
*    DETERMINE WHICH FUNCTIONS IT NEEDS TO PERFORM AFTER RETURN FROM  * 23900021
*    THE EXECUTORS.                                                   * 24000021
*                                                                     * 24100021
* ENTRY POINTS -                                                      * 24200021
*    ENTERED FROM THE FOLLOWING--                                     * 24300021
*    CLOSE INITIALIZATION FUNCTION.                                   * 24400021
*    CLOSE DA READ DSCB FUNCTION.                                     * 24500021
*                                                                     * 24600021
* INPUT -                                                             * 24700021
*    A POINTER TO EACH OF THE FOLLOWING--                             * 24800021
*       CURRENT PARAMETER LIST ENTRY- RPARC                           * 24900021
*       DD ENTRY IN THE TIOT- RTIOT                                   * 25000021
*       WTG TABLE- RWTG                                               * 25100021
*       CURRENT WTG TABLE ENTRY- RWTGC                                * 25200021
*       DCB- RDCB                                                     * 25300021
*       WORK AREA- RCORE                                              * 25400021
*       RESIDENT ROUTINE- RES                                         * 25500021
*       UCB- RUCB                                                     * 25600021
*       DEB- RDEB                                                     * 25700021
*                                                                     * 25800021
* OUTPUT -                                                            * 25900021
*    ALL PENDING CHANNEL PROGRAMS ARE HANDLED AND MAIN STORAGE USED   * 26000021
*    BY THE IOBS, ICBS AND CHANNEL PROGRAMS ARE RELEASED.             * 26100021
*                                                                     * 26200021
* EXTERNAL REFERENCES -                                               * 26300021
*    REFER TO THE PRECEEDING MODULE PROLOG.                           * 26400021
*                                                                     * 26500021
* EXITS, NORMAL -                                                     * 26600021
*    REFER TO THE PRECEEDING MODULE PROLOG.                           * 26700021
*                                                                     * 27200021
* EXITS, ERROR -                                                      * 27300021
*    REFER TO THE PRECEEDING MODULE PROLOG.                           * 27400021
*                                                                     * 27500021
* TABLES/WORK AREAS -                                                 * 27600021
*    THE OPEN, CLOSE, OR EOV WORK AREA AND THE WHERE-TO-GO (WTG)      * 27700021
*    TABLE ARE DESCRIBED BY THE DSECTS AT THE END OF THE LISTING.     * 27800021
*                                                                     * 27900021
* ATTRIBUTES -                                                        * 28000021
*    REFER TO THE PRECEEDING MODULE PROLOG.                           * 28100021
*                                                                     * 28200021
* CHARACTER CODE DEPENDENCY -                                         * 28300021
*    REFER TO THE PRECEEDING MODULE PROLOG.                           * 28400021
*                                                                     * 28500021
* NOTES -                                                             * 28600021
*    NOT APPLICABLE                                                   * 28700021
*                                                                     * 28800021
*********************************************************************** 28900021
         EJECT                                                          29000021
*                                                                       29300021
*        PROCEED WITH CLOSE PROCESSING                                  29400021
*                                                                       29500021
         L     RF,WTGPREFX              GET PTR TO WTG PREFIX    Y02144 29550002
         L     RF,IECRRPRM-IECPREFX(,RF) GET RRPLIST PTR         Y02144 29560002
         USING RRPLIST,RF                                        Y02144 29570002
         OI    RRFLAGS1,RRFAMEXR        SHOW BACH FROM A.M. EXEC Y02144 29580002
         IECRES LOAD,PREFIX=WTGPREFX,MODNM=THISMOD,BRANCH=NO     Y02080X29590002
                                        GIVE OPT TRACE A SHOT    Y02080 29592002
         XC    WTGMODEP,WTGMODEP        CLEAR NEXT MOD ADDR      Y02080 29594002
         LR    RPARC,RPAR               INITIALIZE PARM LIST            29600021
         LA    RWTGC,WTGENTRY-WTG(,RWTG)  INITIALIZE WTG TABLE          29700021
CIN06100 EQU   *                                                        29800021
         L     RDCB,PLISTDCB(RPARC)     GET DCB ADDR                    29900021
         L     RCORE,WTGCORE-1          GET WORK AREA ADDR              30000021
         LA    RCORE,0(RCORE)           CLEAR HIGH ORDER BYTE           30100021
         LTR   RCORE,RCORE              W.A. ADDR PRESENT               30200021
         BZ    CIN06500                 BRANCH NO TO GET NEXT ENTRY     30300021
         BAL   RF,CIN08800              SET UP TASK PARAMETERS   YM6572 30300402
         TM    DCBOFLGS,DCBOBUSY        STILL PROCESSING         YM6572 30302002
         BZ    CIN06140                 BRANCH IS NO             YM6572 30304002
*                                                                Y02082 30310402
* UPDATE WORKAREA COPY OF USER'S DCB - BUSY BIT MERGED           YM7883 30310802
*                                                                Y02082 30311202
         IECRES INIT,DCBCOPY=TOWKAR,STM=(2,14,WTGPREFX)          Y02082 30312002
         L     RDCB,DXUDCBAD            GET PTR TO USER'S DCB    Y02082 30320002
         MODESET KEYADDR=DXUKEY,WORKREG=1 ASSUME USER'S KEY      Y02082 30330002
         ICM   R1,B'1111',DCBOFLGS      GET USER'S DCBOFLGS WORD YM3923 30344002
         IC    R0,DCBIFLGS              GET USER'S ERROR FLSGS   YM3136 30346002
         MODESET EXTKEY=DATAMGT         RESUME DATA MGT KEY      Y02082 30348002
         L     RDCB,DXPDCBAD            POINT TO COPIED DCB      Y02082 30348102
         STC   R0,DCBIFLGS              SET ERROR FLAGS IN COPY  YM3136 30349702
         STCM  R1,B'0111',DCBOFLGS+K1   STORE LAST 3 BYTES       YM3923 30351702
         SRL   R1,K24(0)                SHIFT DCBOFLGS TO LOW    YM3923 30352102
*                                       ORDER BYTE               YM3923 30352202
*********************************************************************** 30352402
         LA    R0,DCBOFLRB+DCBOFLWR+DCBOFTM SET MASK FOR READ BKWD,    *30354002
                         LAST OPERATION WRITE, TAPE MARK WRITTEN YM3136 30355602
*********************************************************************** 30357202
         NR    R1,R0                    SELECT INDICATED BITS    Y02082 30358802
         NI    DCBOFLGS,X'FF'-DCBOFLRB-DCBOFLWR-DCBOFTM          YM3136 30360102
*                                       ZERO INDICATED BITS      YM3136 30360202
*                                       IN DCB COPY              YM3136 30360302
         IC    R0,DCBOFLGS              COMBINE WITH DCBOFLGS    Y02082 30360402
         OR    R1,R0                      FROM COPIED DCB.       Y02082 30362002
         STC   R1,DCBOFLGS              UPDATE DCBOFLGS IN COPY  Y02082 30363602
         TM    DCBOFLGS,DCBOBUSY        DCB STILL BUSY           YM7883 30365602
         BZ    CIN06140                 BRANCH IF NOT            YM7883 30367602
         TM    DCBMACRF,DCBMEXCP        IS ACCESS METHOD EXCP           30368402
         BO    CIN06103                 YES-DO DEBCHK            Y02120 30370002
         TM    DCBDSRG2,ACBDORGA        TEST FOR ACB             Y02082 30380002
         BZ    CIN06102                 NO, NOT AN ACB           Y02082 30390002
         CLI   ACBAMETH-IFGACB(RDCB),ACBVTAM BYPASS DEBCHK       YM3011*30400002
                                        FOR VTAM ACBS.           Y02082 30410002
         BE    CIN06110                 BRANCH IF VTAM           YM1342 30412002
         B     CIN06103                 DEBCHK OTHER ACBS.       Y02082 30414002
CIN06102 EQU   *                        TEST FOR SPOOLED         Y02082 30414402
         TM    TIOELINK,TIOTSPOL        BYPASS DEBCHK FOR        Y02082 30414802
         BM    CIN06300                   SPOOLED DCBS.          Y02082 30414902
CIN06103 EQU   *                        DEBCHECK                 Y02082 30417702
         L     R1,DXUDCBAD              GET PTR TO USER'S DCB    Y02082 30419702
         DEBCHK (1),TYPE=DELETE         CHECK DEB AND DELETE IT  Y02082 30420102
         MVI   DXATCLOS,DXATDBCK        DEB DELETED FR DEB TABLE Y02082 30420502
         LR    RDEB,R1                  GET VERIFIED DEB POINTER Y02082 30420902
         L     RDCB,DXPDCBAD            POINT TO COPIED DCB    @ZA16048 30421637
         TM    DEBFLGS1,DEBF1CEV        DID CLOSE CALL EOV     @ZA16048 30421837
         BZ    CIN08850                 BRANCH IF NO           @ZA16048 30422037
         NC    DCBDSORG,DCBDSORG        ANY DSORG SPECIFIED?   @ZA16048 30422237
         BZ    CIN08840                 NO, BR TO ASSUME PS    @ZA16048 30422437
         TM    DCBDSORG,DCBORGPS        IS IT PS               @ZA16048 30422637
         BZ    CIN08850                 BRANCH IF NOT          @ZA16048 30422837
CIN08840 EQU   *                                               @ZA16048 30423037
         MVC   DXUCBADR+K1(K3),DEBUCBAD+1    USE FIRST UCB     @ZA16048 30423237
*                      ADDRESS IN DEB AS CURRENT UCB. IF EOV   @ZA16048 30423437
*                      COULD NOT EXTEND ON THE SAME VOLUME     @ZA16048 30423637
*                      THEY MAY BE DIFFERENT.                  @ZA16048 30423837
         L     RUCB,DXUCBADR            USE NEW UCB ADDRESS    @ZA16048 30424037
         LA    RUCB,0(,RUCB)            CLEAR HI-ORDER BYTE    @ZA16048 30424237
CIN08850 EQU   *                                               @ZA16048 30424437
         L     RDCB,DXUDCBAD            POINT TO USER'S DCB      Y02082 30424637
         MODESET KEYADDR=DXUKEY,WORKREG=1 ENTER USER'S KEY       Y02082 30424837
         STCM  RDEB,B'0111',DCBDEBAD+K1 STORE DEB PTR IN DCB     Y02082 30425037
         MODESET EXTKEY=DATAMGT         BACK TO DATA MGMT KEY    Y02082 30425237
         L     RDCB,DXPDCBAD            POINT TO COPIED DCB      Y02082 30425437
         STCM  RDEB,B'0111',DCBDEBAD+K1 STORE DEB PTR IN DCB     Y02082 30425902
*                                                                Y02082 30427902
* PURGE DEBS FOR ALL DCBS (NOT ACBS) EXCEPT SPOOLED DCBS         Y02082 30429902
*                                                                Y02082 30430602
         TM    DCBMACRF,DCBMEXCP        BYPASS ACB TEST FOR EXCP Y02082 30431002
         BO    CIN06105                 GO GET PURGED            Y02082 30431402
         TM    DCBDSRG2,ACBDORGA        DO NOT PURGE ACBS        Y02082 30431802
         BO    CIN06110                 ESCAPE PURGE             Y02082 30431902
CIN06105 EQU   *                        PURGE                    Y02082 30432002
         LA    R1,DXCCW                 BUILD PURGE PARM LIST IN Y02082 30432102
         USING PURGPRM,R1                 CCW WORK AREA.         Y02082 30432802
         ST    RDEB,PURGDEB             STORE DEB TO BE PURGED   Y02082 30433202
         MVI   PURGOPT,B'10100000'      SET OPTION BITS          Y02082 30433602
         XC    PURGECB,PURGECB          CLEAR COMPLETION CODE    Y02082 30434002
         LA    R0,DEBUSRPG              SET POINTER TO IOB CHAIN Y02082 30434102
         ST    R0,PURGCHN                                        Y02082 30434202
         XC    PURGMVM,PURGMVM          CLEAR 4TH WORD OF LIST   Y02082 30434602
         PURGE (1)                      PURGE ALL IOBS, THIS DEB Y02082 30434802
         LA    R1,DXCCW                 ADDRESS PURGE PARM LIST  Y02082 30434902
         LA    R1,PURGECB-PURGPRM(R1)   POINT TO PURGE ECB       Y02082 30435202
         WAIT  ECB=(1)                  WAIT TILL PURGE COMPLETE Y02082 30435602
         DROP  R1                                                       30436002
         B     CIN06200                 GO CHECK DEVICE TYPE     YM1342 30454002
*  NOW HAVE ACB                                                  Y02004 30457002
CIN06110 EQU   *                        SPOOLED/JAM/VTAM ACB     Y02004 30460002
         OI    DCBOFLGS,DCBOLOCK        TURN OFF LOCK BIT        Y02004 30462502
         LA    RF,FINMOD                LOAD ADDR OF IFG0202K    Y02004 30465002
         B     CIN06400                 GO STORE ID IN WTG       Y02004 30467502
CIN06140 EQU   *                        NO, NORMAL DCB PROCESSING       30495000
*                                                                       30500002
         LA    RF,EXITMOD               SET UP TO GO TO LAST LOAD       30700021
         B     CIN06400                 BRANCH TO NEXT                  30900021
CIN06200 EQU   *                                                        31000021
*                                                                       31170002
         LTR   RUCB,RUCB                TEST FOR NULL DATA SET          31200021
         BZ    CIN06300                 BRANCH IF YES TO FINAL PROCESS  31300021
         MVC   DXDEBBIN,ACCW3C          ZERO BB                  M0171  31350021
         USING UCBOB,RUCB                                        M0171  31490021
         ST    RUCB,DXDEBUCB            PLACE UCB ADDR IN DEB    M0171  31510021
         TM    UCBTBYT3,UCB3DACC        IS DEVICE DIRECT ACCESS         31600021
         BO    CIN07300                 YES, BR TO DA PROCESSING        31700021
         TM    UCBTBYT3,UCB3TAPE        IS DEVICE TYPE TAPE             31800021
         BO    CIN06600                 YES, BRANCH TO TAPE PROCESSING  31900021
CIN06300 EQU   *                                                        32000021
         LA    RF,FINALMOD              LOAD ADDR OF FINAL STRING       32200021
CIN06400 EQU   *                                                        32300021
         MVC   WTGIDTTR,0(RF)           MOVE IN ID OF STRING            32400021
CIN06450 EQU   *                                                        32500021
         MVI   DXRESIND,K0              INSURE RES ROUT BITS ARE OFF    32600021
         STM   RTIOT,RET,DXREGSAV       SAVE REG 9 THRU 14              32700021
         STM   R0,R1,DXREG0             SAVE REG 0 AND 1                32800021
CIN06500 EQU   *                                                        32900021
         TM    PLISTOPT(RPARC),LASTNTRY  CK LAST ENTRY ON LIST          33000021
         LA    RWTGC,K8(,RWTGC)         NEXT WTG ENTRY                  33100021
         BO    CIN07000                 BRANCH IF LAST ENTRY            33200021
         LA    RPARC,K4(,RPARC)         NEXT DCB ENTRY                  33300021
         B     CIN06100                 BRANCH TO NEXT ENTRY            33400021
*          TAPE PROCESSING                                              33450021
CIN06600 EQU   *                                                        33500021
         TM    UCBFL1,UCBNOTRD          IS DEVICE READY                 33600021
         BNO   CIN06650                 YES-CONTINUE             YM6559 33650002
         MODESET EXTKEY=SUPR            UCB KEY                  YM6559 33700002
         MVI   UCBDMCT,K0               ZERO DATA MANAGEMENT CT  YM6559 33750002
*                                       BEFORE GOING TO IFG0202J YM6559 33800002
         MODESET EXTKEY=DATAMGT         RETURN TO D.M. KEY       YM6559 33850002
         OI    DXATEOV,DXATNVOL         TELL RECOVERY DM CT. 0   YM6559 33900002
CIN06650 EQU   *                        DETERMINE NEXT MODULE    YM6559 33950002
         TM    UCBTBYT2,UCB3TAPE        IS IT 7 TRK TAPE        ZA01326 33960002
         BO    CIN06651                 BRANCH IF YES           ZA01326 33970002
         MVC   DXDEBMOD(K1),DEBDVMOD    SET MODE CODE-9 TRK     ZA01326 33980002
         B     CIN06652                 BRANCH TO CONTINUE      ZA01326 33990002
CIN06651 EQU   *                        SET MODE CODE-7 TRK     ZA01326 33992002
         MVI   DXDEBMOD,X'2B'           EVEN PARITY, TRANSLATE ON       34000021
         OC    DXDEBMOD,JFCDEN          SET DENSITY TO DEN USED TO      34100021
*                                       CREATE DATA SET                 34200021
CIN06652 EQU   *                        CONTINUE TAPE PROCESS   ZA01326 34250002
         SR    RET,RET                  SET UP FOR BRANCH TABLE         34300021
         TM    UCBSTAT,UCBDADI          SL SPECIFIED                    34400021
         BO    CIN06800                 BRANCH IF YES                   34500021
         TM    UCBSTAB,UCBBSTR          AL SPECIFIED                    34600021
         BO    CIN06800                 BRANCH IF YES                   34700021
         TM    DEBOFLGS,DEBOFNSL        NSL SPECIFIED                   34800021
         BO    CIN06900                 BRANCH IF YES                   34900021
CIN06700 EQU   *                                                        35000021
         LA    RF,VOLDPMOD              GO TO VOL DISP MODULE           35100021
         B     CIN06400                 GO CHECK NEXT DCB               35200021
CIN06800 EQU   *                                                        35300021
         TM    DCBOFLGS,DCBOWRIT        OUTPUT PROCESSING TAKE PLACE    35400021
         LA    RF,SLMOD                 GO TO SL PROCESSING MOD         35500021
         BO    CIN06400                 GO CHECK NEXT DCB               35600021
*                                                                       35700021
*****          TEST FOR DEFERRED PROCESSING OF INPUT TRAILER LABELS     35800021
*                                                                       35900021
         TM    JFCBLTYP,JFCBUL          IS UL SPECIFIED                 36000021
         BNO   CIN06700                 BR IF NOT TO CONTINUE PROCESS   36100021
         TM    DEBFLGS1,DEBF1EOF        EOF ON THIS DCB                 36200021
         BNO   CIN06700                 BR IF NOT TO CONTINUE CLOSE     36300021
         LA    RF,ULTAMOD               LOAD UL MODULE ID               36400021
         LA    RET,K4                   SET UP FOR BRANCH TABLE         36500021
         B     CIN06400                 BR TO CHK NEXT DCB              36600021
CIN06900 EQU   *                                                        36700021
         LA    RF,NSLMOD                GO TO NSL PROCESSING MOD        36800021
         B     CIN06400                 GO CHECK NEXT DCB               36900021
CIN07000 EQU   *                                                        37000021
         MVI   WTGMODNM+K1,C'F'         CHANGE ID TO IFG                37100021
         MVI   WTGIDTTR,K0              ZERO '0G' ENTRY                 37200021
         L     RES,K4(RWTGC)            LOAD ADDR OF RES. RTN           37300021
         LA    RWTGC,WTGENTRY-WTG(,RWTG)  INITIALIZE WTG ENTRY ADDR     37400021
CIN07100 EQU   *                                                        37500021
         L     RCORE,WTGCORE-1          GET WORK AREA ADDR              37600021
         LA    RCORE,0(RCORE)           CLEAR HIGH ORDER BYTE           37700021
         LTR   RCORE,RCORE              WORK AREA ADDR PRESENT          37800021
         BZ    CIN07200                 BRANCH IF NOT                   37900021
         LM    RTIOT,RET,DXREGSAV       RELOAD REG 9 THRU 14            38000021
         LM    R0,R1,DXREG0             RELOAD REG 0 AND 1              38100021
         B     RESXCTL(RES)             BRANCH TO RES. RTN              38200021
CIN07200 EQU   *                                                        38300021
         LA    RWTGC,K8(,RWTGC)         GET NEXT ENTRY                  38400021
         B     CIN07100                 LOOP BACK TO CHECK NEXT ENTRY   38500021
         EJECT                                                          38600021
*                                                                     * 38700021
*                          FUNCTION PROLOG                            * 38800021
*                                                                     * 38900021
*********************************************************************** 39000021
*                                                                     * 39100021
* FUNCTION NAME -                                                     * 39200021
*    CLOSE DA UPDATE DSCB FUNCTION.                                   * 39300021
*                                                                     * 39400021
* (STATUS) -                                                          * 39500021
*    NOT APPLICABLE                                                   * 39600021
*                                                                     * 39700021
* FUNCTION -                                                          * 39800021
*    READ FORMAT 1 DSCB IF CLOSE EXECUTORS HAD CALLED EOV WHEN        * 39830021
*    FLUSHING OUTPUT BUFFER.                                          * 39860021
*    UPDATE THE LAST-TRACK-USED AND THE TRACK BALANCE FIELDS IN THE   * 39900021
*    DSCB FOR OUTPUT PS OR PO DATA SET.                               * 40000021
*    UPDATE THE DIRECTORY COUNT FOR BPAM DATA SET.                    * 40100021
*                                                                     * 40200021
* ENTRY POINTS -                                                      * 40300021
*    ENTERED FROM THE FOLLOWING--                                     * 40400021
*    CLOSE DA ACCESS METHOD EXECUTOR INTERFACE FUNCTION.              * 40500021
*                                                                     * 40600021
* INPUT -                                                             * 40700021
*    A POINTER TO EACH OF THE FOLLOWING--                             * 40800021
*       CURRENT PARAMETER LIST ENTRY- RPARC                           * 40900021
*       DD ENTRY IN THE TIOT- RTIOT                                   * 41000021
*       WTG TABLE- RWTG                                               * 41100021
*       CURRENT WTG TABLE ENTRY- RWTGC                                * 41200021
*       DCB- RDCB                                                     * 41300021
*       WORK AREA- RCORE                                              * 41400021
*       RESIDENT ROUTINE- RES                                         * 41500021
*       UCB- RUCB                                                     * 41600021
*       DEB- RDEB                                                     * 41700021
*                                                                     * 41800021
* OUTPUT -                                                            * 41900021
*    DSCB IS UPDATED.                                                 * 42000021
*                                                                     * 42100021
* EXTERNAL REFERENCES -                                               * 42200021
*    REFER TO THE PRECEEDING MODULE PROLOG.                           * 42300021
*    CONVERT ROUTINE MBBCCHHR TO TTR.                                 * 42400021
*                                                                     * 42500021
* EXITS, NORMAL -                                                     * 42600021
*    REFER TO THE PRECEEDING MODULE PROLOG.                           * 42700021
*    CLOSE DA WRITE DSCB FUNCTION.                                    * 42900021
*                                                                     * 43000021
* EXITS, ERROR -                                                      * 43100021
*    REFER TO THE PRECEEDING MODULE PROLOG.                           * 43200021
*                                                                     * 43300021
* TABLES/WORK AREAS -                                                 * 43400021
*    THE OPEN, CLOSE, OR EOV WORK AREA AND THE WHERE-TO-GO (WTG)      * 43500021
*    TABLE ARE DESCRIBED BY THE DSECTS AT THE END OF THE LISTING.     * 43600021
*                                                                     * 43700021
* ATTRIBUTES -                                                        * 43800021
*    REFER TO THE PRECEEDING MODULE PROLOG.                           * 43900021
*                                                                     * 44000021
* CHARACTER CODE DEPENDENCY -                                         * 44100021
*    REFER TO THE PRECEEDING MODULE PROLOG.                           * 44200021
*                                                                     * 44300021
* NOTES -                                                             * 44400021
*    NOT APPLICABLE                                                   * 44500021
*                                                                     * 44600021
*********************************************************************** 44700021
         EJECT                                                          44800021
CIN07300 EQU   *                                                        44900021
         TM    DCBMACRF,DCBMEXCP        IS IT EXCP                      45000021
         BZ    CIN07400                 BRANCH IF NOT EXCP              45100021
         TM    DCBMCRF1,DCBMDEV         IS DA DEV. DEP. PRESENT         45200021
         BZ    CIN08700                 BRANCH IF NO                    45300021
CIN07400 EQU   *                                                        45400021
         TM    DCBOFLGS,DCBOWRIT        IS TRAILER SWITCH ON            46000021
         BO    CIN07600                 YES,GO TO CONVERT ROUTINE       46100021
         TM    JFCBLTYP,JFCSL+JFCBUL    USER LABELS SPECIFIED           46200021
         BNO   CIN08700                 NO, GO GET NEXT DCB             46300021
         TM    DCBDSORG,DCBORGDA        CK FOR DIRECT            A38013 46330021
         BO    CIN08600                 BRANCH IF DIRECT         A38013 46360021
         B     CIN08500                 BRANCH TO USER LABEL TESTING    46400021
*                                                                       46500021
*        GO TO CONVERT ROUTINE TO CONVERT CCHHR TO TTR                  46600021
*                                                                       46700021
CIN07600 EQU   *                                                        46800021
         TM    DEBFLGS1,DEBF1CEV        NEED FORMAT 1 DSCB       M0050  46803021
         BZ    CIN07680                 BRANCH IF NOT            M0050  46806021
CIN07620 EQU   *                                                 M0050  46833021
         LR    RC,RDEB                  USE RC FOR WORK REG.     M0050  46836021
         LA    RF,K16                   DISPLACEMENT FACTOR TO   M0050  46839021
         SR    RC,RF                    POINT TO DSCB SCH ADDR   M0050  46842021
         MVC   DXDAADDR+K1(K7),K1(RC)   BBCCHHR TO WORK AREA     M0050  46845002
         LA    RC,DXDAADDR+K3           PLACE ADDR OF CCHHR INTO M0050  46848021
         ST    RC,DXCCW1                FIRST CCW                M0050  46851021
         LA    RC,DXCCW1                PLACE ADDR OF SEARCH CCW M0050  46854021
         ST    RC,DXCCW2                INTO TIC CCW             M0050  46857021
         LA    RF,DXDSCB                BUFFER ADDRESS           M0050  46860021
         ST    RF,DXCCW3                STORE IN CCW             M0050  46863021
         MVI   DXCCW1,CCWSCHID          SEARCH FOR EQUAL ID OP   M0050  46866021
         MVC   DXCCW1+K4(K5),ACCW1C     CC, 5 CHAR, TIC OP       M0050  46869021
         MVC   DXCCW2+K4(K5),ACCW2C     CC,READ DATA OP CODE     M0050  46872021
         MVC   DXCCW3+K4(K4),ACCW3C     LENGTH OF THE DSCB       M0050  46875021
         EXCP  DXIOB                    INITIATE I/O OPERATION   M0050  46878021
         WAIT  ,ECB=DXECB               WAIT FOR COMPLETION      M0050  46881021
         TM    DXECB,ECBNOERR           TEST FOR ERROR           M0050  46884021
         BNO   CIN08900                 YES-BR IF ERROR          M0050  46887021
         OI    DXATDACC,DXATF1CE        SHOW CLOSE REREAD FMT 1  Y02144 46889002
*                                       DSCB IF EXECS CALLED EOV Y02144 46889402
CIN07680 EQU   *                        TEST FOR ORG TYPE        M0050  46890002
         CLI   DXDSCB,CHAR4             OPENED TO VTOC?        @ZA02202 46890437
         BE    CIN08700                 YES,BYPASS DSCB UPDATE @ZA02202 46890837
         TM    DCBMACRF,DCBMEXCP        EXCP?                  @ZA02202 46891237
         BZ    CIN07682                 NO, CONTINUE           @ZA02202 46891637
         TM    DCBMACRF,DCBMCOM         COMMON SECTION PRESENT?@ZA02202 46891737
         BZ    CIN07685                 NO, ASSUME PS          @ZA02202 46923037
CIN07682 EQU   *                                               @ZA02202 46938437
         NC    DCBDSORG,DCBDSORG        ANY DSORG SPECIFIED?   @ZA02202 46953837
         BZ    CIN07685                 NO, BR TO ASSUME PS    @ZA02202 46969237
         TM    DCBDSORG,DCBORGPS+DCBORGPO  TEST FOR PS OR PO            46984637
         BZ    CIN08200                 BRANCH TO LAST DA LOAD   A38013 47000021
CIN07685 EQU   *                                               @ZA02202 47002037
         CLC   DCBFDAD+K3(K4),FOXES     ANY DATA WRITTEN?      @ZA01343 47010002
         BE    CIN07750                 NO,DO NOT UPDATE       @ZA01343 47030002
*                                       LAST TRACK ADDR OR     @ZA01343 47040002
*                                       TRACK BALANCE IN FMT 1 @ZA01343 47042002
         NC    DCBFDAD+K3(K4),DCBFDAD+K3    TEST FOR ZERO CCHH  ZA01327 47050002
         BZ    CIN07750                 YES, DO NOT UPDATE      ZA01327 47060002
*                                       LAST TRACK ADDR OR      ZA01327 47070002
*                                       TRACK BALANCE IN FMT 1  ZA01327 47080002
         STM   R0,RF,DXCCW1             SAVE ALL REGISTERS              47100021
         L     R1,DCBDEBAD              LOAD DEB ADDR            Y02082 47270002
         LA    RDCB,DCBFDAD             POINT TO FULL DISK ADDRESS      47300021
         L     RF,CVTPRLTV              CONVERT ROUTINE ADDRESS         47400021
         BALR  RET,RF                   BRANCH TO CONVERT ROUTINE       47500021
         LM    R1,RF,DXCCW1+K4          RESTORE REGISTERS               47600021
         ST    R0,DXDAADDR              STORE CONVERTED ADDR-(TTR)      47700021
CIN07700 EQU   *                                                        48200021
*                                                                       48300021
*        MODIFY LAST TRACK USED FIELD IN DSCB                           48400021
*                                                                       48500021
         MVC   DSCLSTAR(K3),DXDAADDR    MOVE IN LAST TRACK ADDR         48600021
         MVC   DSCLSTAR+K3(K2),DCBTRBAL  MOVE IN TRACK BALANCE          48700021
CIN07750 EQU   *                                                ZA01327 48750002
         OI    DSCDSIND,X'80'           SET LAST VOL. IND.              48800021
         TM    DCBMACRF,DCBMEXCP        IS IT EXCP                      48900021
         BO    CIN07800                 YES,BRANCH                      49000021
         TM    DSCFILTY,X'02'           IS DATA SET PARTITIONED         49100021
         BZ    CIN07800                 BRANCH IF NOT                   49200021
         TM    DEBOPATB,DEBOPOIN-DEBOPRBK OUTP,OUTIN,INOUT,UPD @ZA07592 49300037
         BZ    CIN07800                 BRANCH IF NO                    49400021
         MVC   DSCBLDBL,DCBDIRCT+K1     MOVE IN DIRCT COUNT             49500021
         MVI   DCBDIRCT+K1,K0           CLEAR DIRECTORY COUNT           49600021
CIN07800 EQU   *                                                        56100021
         L     RET,DXTCBADR             TCB ADDRESS              Y02134 56130002
CIN08100 EQU   *                        SET UP BRANCH            M0194  61900002
         LA    RF,DAOUTMOD              GO TO DA OUTPUT MOD      A38013 62300021
         B     CIN08400                 BRANCH TO SET OFFSET     A38013 63300021
CIN08200 EQU   *                        SET UP BRANCH            A38013 64300002
         LA    RF,DAFINMOD              GO TO FINAL DA LOAD      A38013 65300021
CIN08400 EQU   *                        SET OFFSET               A38013 66300002
         SR    RET,RET                  SET BRANCH OFFSET TO 0   A38013 67300021
         B     CIN06400                 GO CHECK NEXT DCB               70600021
*     INPUT USER LABEL CHECKING                                         70700021
CIN08500 EQU   *                                                        70800021
         TM    DEBFLGS1,DEBF1EOF        EOF ON THIS DCB                 70900021
         BNO   CIN08700                 NO,GO GET NEXT DCB              71000021
         LA    RF,SULDFR                YES,POINT TO DEFER LABL  A38013 71010021
*                                       PROC CODE-0D             A38013 71020021
CIN08520 EQU   *                        TEST FOR EXIT LIST       A38013 71030002
         L     RC,DCBEXLST              PICK UP EXIT LIST ADDR   A38013 71040021
         LA    RC,0(,RC)                ZERO HIGH ORDER BYTE     A38013 71050021
         LTR   RC,RC                    IS THIS EXIT LIST ZERO   A38013 71060021
         BZ    CIN08700                 YES, DO NOT PROCESS UL   A38013 71070021
         MODESET KEYADDR=DXUKEY,WORKREG=13 ASSUME USER KEY       YM1318 71072002
CIN08540 EQU   *                        TEST EXIT LIST CODES     A38013 71080002
         CLC   0(K1,RC),0(RF)           DO CODE BYTES MATCH      A38013 71090021
         BE    CIN08740                 YES,GO TO THE SPECIFIED  A38013 71100021
*                                       EXIT ADDRESS             A38013 71110021
         CLC   0(K1,RC),K1(RF)          DO CODE BYTES MATCH      A38013 71120021
         BE    CIN08740                 YES,GO TO THE SPECIFIED  A38013 71130021
*                                       EXIT ADDRESS             A38013 71140021
         TM    0(RC),LASTNTRY           IS THIS THE LAST ENTRY   A38013 71150021
*                                       IN EXLST                 A38013 71160021
         BO    CIN08700                 YES, CONTINUE CLOSE      A38013 71170021
         LA    RC,K4(,RC)               POINT TO NEXT ENTRY      A38013 71180021
         B     CIN08540                 BR TO PROCESS NEXT ENTRY A38013 71190021
CIN08600 EQU   *                                                        71300021
         LA    RF,UTL1                  POINT TO THE UTL INPUT   A38013 71340021
*                                       CODE BYTE-03             A38013 71380021
         TM    DEBOPATB,DEBOPOUT        OPND FOR OUTPT/INPT      A38013 71420021
         BNM   CIN08520                 YES,BR TO PROCESS UL    SM05469 71460002
         TM    DEBOPATB,DEBOPUPD        OPENED FOR UPDAT         A38013 71500021
         BO    CIN08520                 BRANCH TO PROCESS UL     A38013 71540021
CIN08700 EQU   *                                                        71600021
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY      YM1318 71650002
         LA    RF,DAFINMOD              LAST DA LOAD                    71700021
         LA    RET,K8                   SET BRANCH OFFSET        A38013 71800021
         B     CIN06400                 GO CHECK NEXT DCB               71900021
CIN08740 EQU   *                        EXIT LIST                A38013 71910002
         L     RC,0(,RC)                C(RC)=EXIT LIST ENTRY    A38013 71920021
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY      YM1318 71922002
         LA    R1,0(,RC)                EXIT ADDRESS IN R1       A38013 71930021
         LTR   R1,R1                    CK EXIT ADDR FOR ZERO    A38013 71940021
         BZ    CIN08760                 BRANCH IF ZERO          SM05469 71950002
         LA    RF,ULDAIMOD              INPUT UL MOD ID          A38013 71960021
         B     CIN06400                 GO CHECK NEXT DCB        A38013 71970021
         SPACE 3                                                 A38013 71980021
CIN08760 EQU   *                        TRY '03' SEARCH         SM05469 71990002
         CLI   K0(RF),XLDEFSL           IS THIS DEFER LABEL     SM05469 71992002
         BNE   CIN08700                 BR IF NO, SKIP UL CODE  SM05469 71994002
         B     CIN08600                 BR IF YES TO SEARCH FOR SM05469 71996002
*                                       03 EXIT, SINCE EXIT     SM05469 71998002
*                                       LIST ADDR MAY BE 0 FOR  SM05469 71998402
*                                       '0C'. NOTE WE ARE OPEN  SM05469 71998802
*                                       INPUT AT THIS POINT.    SM05469 71999202
CIN08800 EQU   *                                                        72000021
         L     RD,CVTPTR                VECTOR TABLE ADDRESS            72100021
         L     RET,DXTCBADR             CURRENT TCB ADDRESS      Y02134 72300002
         L     RTIOT,DXTIOTAD           POINT TO THIS DCB'S ENTRYY02134 72500002
         L     RUCB,DXUCBADR            ESTABLISH UCB ADDRESS    Y02134 72600002
         LA    RUCB,0(,RUCB)            CLEAR REG'S HI-ORDER BYTE       72700021
         BR    RF                       RETURN TO CALLER OF SUBROUTINE  72800021
         EJECT                                                          72900021
         SPACE 1                                                        73000021
*********************************************************************** 73100021
*                                                                     * 73200021
*                        ERROR PROCESSING                             * 73300021
*                                                                     * 73400021
*********************************************************************** 73500021
         SPACE 1                                                        73600021
CIN08900 EQU   *                                                        73700021
         LA    R0,CABD086               ERR- READ DSCB           M0050  73800021
         LA    RC,DAFINMOD              SET RETURN ADDRESS              73900021
CIN09100 EQU   *                                                        74400021
         SR    RET,RET                  SET UP BRANCH OFFSET     A38013 74450021
         DMABCOND (0),PDMOD,RETURN=(RC),RES=NO  ABEND MACRO             74500021
         B     CIN06450                 BRANCH TO GET NEXT ENTRY        74600021
         EJECT                                                          74700021
         SPACE 1                                                        74800021
*********************************************************************** 74900021
*                                                                     * 75000021
*                       CONSTANTS                                     * 75100021
*                                                                     * 75200021
*********************************************************************** 75300021
         SPACE 1                                                        75400021
ACCW1C   DC    X'6000000508'            COMM CHAIN,SILI,5 CHAR,TIC OP   75500021
ACCW2C   DC    X'4000000086'            COMMAND CHAIN,READ DATA OP CODE 75600021
ACCW3C   DC    X'00000060'              96 CHARACTERS                   75700021
FOXES    DC    X'FFFFFFFF'              NO DATA WRITTEN MASK   @ZA01343 75750002
*                                                                A38013 76100021
*****          DCB EXIT LIST CODE BYTES USED FOR TESTING         A38013 76300021
*                                                                A38013 76500021
SULDFR   DC    X'0C'                    DEFER LABEL PROCESSING   A38013 76700021
*                                       CODE BYTE                A38013 76900021
         DC    X'8C'                    DEFER LABEL PROCESSING   A38013 77100021
*                                       CODE--LAST               A38013 77300021
UTL1     DC    X'03'                    USER TRAILER LABEL INPUT A38013 77500021
*                                       CODE BYTE                A38013 77700021
         DC    X'83'                    USER TRAILER LABEL INPUT A38013 77900021
*                                       CODE--LAST               A38013 78100021
         XCTLTABL ID=(SLMOD,0Z,DAFINMOD,2E,PDMOD,0P,DAOUTMOD,1R,       *78760000
               FINALMOD,2J,VOLDPMOD,2F,NSLMOD,2B,ULTAMOD,2A,           *78780000
               EXITMOD,2L,ULDAIMOD,2C,FINMOD,2K,                SA53753*78800002
               THISMOD,IFG0200Y,                                 Y02080X78810002
               VSAMMOD,1A),SVC=020,BRT=YES,LENGTH=               Y02080 78820002
         IECDSECS CVT,TCB,TIOT,DCB,DEB,UCB,MAIN,WTG,PREFX,ACB,   Y02080*78900002
               RRPL,EXPAND=YES                                   Y02144 78950002
PURGPRM  DSECT                          PURGE PARAMETER LIST     Y02082 79000002
PURGDEB  DS    0F                       DEB TO BE PURGED         Y02082 79010002
PURGOPT  DS    C                        OPTION BITS              Y02082 79020002
         DS    AL3                      DEB POINTER              Y02082 79022002
PURGECB  DS    0F                       USE THIS FIELD FOR ECB   Y02082 79024002
         DS    C                        COMPLETION CODE          Y02082 79026002
PURGTCB  DS    AL3                      TCB POINTER (0=CURRENT)  Y02082 79028002
PURGCHN  DS    AL4                      CHAIN OF IOBS            Y02082 79028402
PURGMVM  DS    F                        4TH WORD FOR MVM         Y02082 79028502
IFG0200Y CSECT                                                   Y02082 79028802
ACBMJEP  EQU  X'40'                     ACB CREATED BY JEPS           $ 79030000
TIOTSPOL EQU   X'06'                    JES SPOOL D.S. INDICATORS     $ 79040000
*                                                                       79060000
         IECEQU  AOS=YES                                                79070000
         END                                                            79100021
