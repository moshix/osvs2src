         TITLE 'IFG0202J - CLOSE FINAL COMMON FUNCTION STRING'          00100021
IFG0202J CSECT                                                          00400021
*********************************************************************** 00500021
*                                                                     * 00600021
*                                                                     * 00700021
*          VS2 RELEASE 04.0 DELETIONS/CHANGES                         * 00740003
*0000342000,348000,348200,348300                               @ZA02211 00741003
*          VS2 RELEASE 2 DELETIONS/CHANGES                            * 00750002
*0000480636,480661                                              ZA00702 00850002
*          RELEASE 21 DELETIONS/CHANGES                               * 01200021
*0000479000,628900,629000                                        M1752  01201021
*0000018000,047600-050000,247500,367000,376000-384000,417000-    M0528  01202021
*0000477000,480000,482000-483000,485000-619000,628000-630000,    M0528  01204021
*0000639000                                                      M0528  01206021
*0000018000,025000-033000,048000,086000-185000,205000,248000,    A38013 01210021
*0000638000-639000                                               A38013 01220021
*0000019000,049000-050000,116000-124000,193000,209000-217000,    A41440 01230021
*0000372000                                                      A41440 01260021
*0000266000-267000                                               M1798  01270021
*                                                                     * 01300021
* MODULE NAME = IFG0202J                                                01350002
*                                                                     * 01370002
* DESCRIPTIVE NAME = CLOSE FINAL COMMON FUNCTION STRING               * 01380002
*                                                                     * 01390002
* COPYRIGHT = NONE                                                    * 01392002
*                                                                     * 01394002
* STATUS CHANGE LEVEL 000                                             * 01400021
*                                                                     * 01500021
* FUNCTION -                                                          * 01600021
*    THIS MODULE CONTAINS THE FUNCTION(S) OR PART(S) OF FUNCTION(S)-- * 01700021
*    CLOSE FINAL RESTORE DATA MANAGEMENT FUNCTION.                    * 01900021
*    CLOSE FINAL RESTORE SYSTEM FUNCTION.                             * 02000021
*    REFER TO THE FOLLOWING 'FUNCTION PROLOG(S)' FOR DETAILS.         * 02100021
*                                                                     * 02200021
* ENTRY POINTS -                                                      * 02300021
*         IFG0202J - ENTRY POINT VIA AN XCTL FROM THE FOLLOWING--     * 02400021
*             IFG0200Y - PROCESS CLOSE FINAL STRING FUNCTION.         * 02500021
*             IFG0202B                                                * 02600021
*             IFG0202E                                                * 02700021
*             IFG0202F                                                * 02800021
*             IFG0202H                                                * 02900003
*             IFG0202I                                                * 03000003
*                                                                     * 03400021
* INPUT -                                                             * 03500021
*    ENTERED IN DATA MANAGEMENT KEY                              Y02082 03550002
*    REFER TO THE FOLLOWING 'FUNCTION PROLOG(S)'.                     * 03600021
*                                                                     * 03700021
* OUTPUT -                                                            * 03800021
*    EXIT IN DATA MANAGEMENT KEY                                 Y02082 03850002
*    REFER TO THE FOLLOWING 'FUNCTION PROLOG(S)'.                     * 03900021
*                                                                     * 04000021
* EXTERNAL REFERENCES -                                               * 04100021
*         IFG019RA - OPEN/CLOSE/EOV RESIDENT ROUTINE FOR XCTL AND     * 04200002
*                    WAIT.                                            * 04300021
*    REFER TO THE FOLLOWING 'FUNCTION PROLOG(S)'.                     * 04400021
*                                                                     * 04500021
* EXITS, NORMAL -                                                     * 04600021
*    EXIT VIA THE RESIDENT ROUTINE XCTL TO THE FOLLOWING--            * 04700021
*         IFG0202K - CONTINUE PROCESS CLOSE FINAL RESTORE             * 04800021
*                    SYSTEM FUNCTION.                                 * 04900021
*    REFER TO THE FOLLOWING 'FUNCTION PROLOG(S)'.                     * 05100021
*                                                                     * 05200021
* EXITS, ERROR -                                                      * 05300021
*    EXIT IS TO THE PROBLEM DETERMINATION MODULE IFG0200P, IF AN      * 05400021
*    ABEND SITUATION OCCURS IN THIS MODULE.  REFER TO THE FOLLOWING   * 05500021
*    'FUNCTION PROLOG(S)'.                                            * 05600021
*                                                                     * 05700021
* TABLES/WORK AREAS -                                                 * 05800021
*    REFER TO THE FOLLOWING 'FUNCTION PROLOG(S)'.                     * 05900021
*                                                                     * 06000021
* ATTRIBUTES -                                                        * 06100021
*    REENTRANT, REFRESHABLE, READ-ONLY, ENABLED, PRIVILEGED           * 06200021
*                                                                     * 06300021
* CHARACTER CODE DEPENDENCY -                                         * 06400021
*    CLASS ONE CHARACTER CODE DEPENDENCY - THE EBCDIC CHARACTER CODE  * 06500021
*    WAS USED FOR ASSEMBLY.  THE MODULE MUST BE REASSEMBLED IF A      * 06600021
*    DIFFERENT CHARACTER SET IS USED FOR EXECUTION.                   * 06700021
*                                                                     * 06800021
* NOTES -                                                             * 06900021
*    REFER TO THE FOLLOWING 'FUNCTION PROLOG(S)'.                     * 07000021
*                                                                     * 07100021
*********************************************************************** 07200021
         EJECT                                                          07300021
         USING IHADCB,RDCB                                              07400021
         USING FORCORE,RCORE                                            07500021
         USING UCBOB,RUCB                                               07700021
         USING CVT,RD                                                   07800021
         USING TIOENTRY,RTIOT                                           07900021
         USING DEBBASIC,RDEB                                     Y02134 08000002
         USING WTG,RWTG                                                 08100021
         USING WTGENTRY,RWTGC                                           08200021
*                                                                       08300021
         BALR  RBASE,0                  ESTABLISH BASE REGISTER         08400021
         USING *,RBASE                                                  08500021
         EJECT                                                          18600021
*********************************************************************** 18650003
*                                                                     * 18700021
*                          FUNCTION PROLOG                            * 18800021
*                                                                     * 18900021
*********************************************************************** 19000021
*                                                                     * 19100021
* FUNCTION NAME -                                                     * 19200021
*    CLOSE FINAL RESTORE DATA MANAGEMENT FUNCTION.                    * 19300021
*                                                                     * 19400021
* (STATUS) -                                                          * 19500021
*    NOT APPLICABLE                                                   * 19600021
*                                                                     * 19700021
* FUNCTION -                                                          * 19800021
*    DELETE ACCESS METHOD SUBROUTINES AND I/O APPENDAGES LOADED WHEN  * 19900021
*    DATA SET WAS OPENED.                                             * 20000021
*    RELEASE USER TOTALING SAVE AREA.                                 * 20100021
*    DECREMENT COUNT IN UCBERADR (NO. OF DCB'S OPEN TO 3211 PRINTER)  * 20150021
*    AND FREEMAIN ERP WORKAREA IF LAST DCB.                           * 20160021
*                                                                     * 20200021
* ENTRY POINTS -                                                      * 20300021
*    ENTERED FROM THE FOLLOWING--                                     * 20400021
*    CLOSE UNIT RECORD/TELEPROCESSING FUNCTION.                       * 20440021
*    CLOSE TAPE NONSTANDARD LABEL FUNCTION.                           * 20480021
*    CLOSE DA EXIT FUNCTION.                                          * 20520021
*    CLOSE TAPE VOLUME DISPOSITION FUNCTION.                          * 20560021
*                                                                     * 20600021
* INPUT -                                                             * 20700021
*    A POINTER TO EACH OF THE FOLLOWING--                             * 20800021
*       CURRENT PARAMETER LIST ENTRY- RPARC                           * 20900021
*       DD ENTRY IN THE TIOT- RTIOT                                   * 21000021
*       WTG TABLE- RWTG                                               * 21100021
*       CURRENT WTG TABLE ENTRY- RWTGC                                * 21200021
*       DCB- RDCB                                                     * 21300021
*       WORK AREA- RCORE                                              * 21400021
*       RESIDENT ROUTINE- RES                                         * 21500021
*       UCB- RUCB                                                     * 21600021
*       DEB- RDEB                                                     * 21700021
*                                                                     * 21800021
* OUTPUT -                                                            * 21900021
*    ALL SUBROUTINES AND I/O APPENDAGES DELETED.                      * 22000021
*    USER TOTALING SAVE AREA RELEASED.                                * 22100021
*                                                                     * 22200021
* EXTERNAL REFERENCES -                                               * 22300021
*    REFER TO THE PRECEEDING MODULE PROLOG.                           * 22400021
*                                                                     * 22500021
* EXITS, NORMAL -                                                     * 22600021
*    REFER TO THE PRECEEDING MODULE PROLOG.                           * 22700021
*    CLOSE FINAL RESTORE SYSTEM FUNCTION.                             * 22800021
*                                                                     * 22900021
* EXITS, ERROR -                                                      * 23000021
*    REFER TO THE PRECEEDING MODULE PROLOG.                           * 23100021
*                                                                     * 23200021
* TABLES/WORK AREAS -                                                 * 23300021
*    THE OPEN, CLOSE, OR EOV WORK AREA AND THE WHERE-TO-GO (WTG)      * 23400021
*    TABLE ARE DESCRIBED BY THE DSECTS AT THE END OF THE LISTING.     * 23500021
*                                                                     * 23600021
* ATTRIBUTES -                                                        * 23700021
*    REFER TO THE PRECEEDING MODULE PROLOG.                           * 23800021
*                                                                     * 23900021
* CHARACTER CODE DEPENDENCY -                                         * 24000021
*    REFER TO THE PRECEEDING MODULE PROLOG.                           * 24100021
*                                                                     * 24200021
* NOTES -                                                             * 24300021
*    NOT APPLICABLE                                                   * 24400021
*                                                                     * 24500021
*********************************************************************** 24600021
         EJECT                                                          24700021
         L     RD,CVTPTR                GET VECTOR TABLE ADDRESS M0528  24709021
         L     RTIOT,DXTIOTAD           LOAD TIOT ENTRY ADDR     Y02134 24745002
*                                                                       24772021
         L     RUCB,DXUCBADR            SRT-UCB ADDRESS          Y02134 24781002
         LA    RUCB,0(RUCB)             CLEAR HI-ORDER BYTE      M0528  24790021
         TM    DCBMACRF,DCBMEXCP        IS ACCESS METHOD EXCP           24792000
         BO    CFN00499                 YES NORMAL PROCESSING           24793000
         TM    DCBDSORG+K1,ACBDORGA     IS THIS AN ACB                  24794000
         BO    CFN01710                 YES JAM OR SPOOL ACB            24795000
CFN00499 EQU   *                                                        24796000
         TM    TIOELINK,TIOESYIN+TIOESYOT SPOOLED DCB?           Y02120 24799002
         BM    CFN01230                 BRANCH IF YES            Y02120 24799402
         LTR   RUCB,RUCB                TEST FOR DUMMY           A38013 24800021
         BZ    CFN00550                 BRANCH IF DUMMY         SA68439 24850002
*                                                                       25500021
*    FREE ERP WORKAREA FOR LAST DCB OPEN TO A 3211 PRINTER              25600021
*    WHEN EXCP IS BEING USED                                            25700021
*                                                                       25800021
CFN00500 EQU   *                                                        25900021
         CLI   UCBTBYT3,UCB3UREC        CHK FOR UNIT REC DEVICE         26200021
         BNE   CFN00550                 BRANCH IF NOT 3211              26300021
         CLI   UCBTBYT4,X'09'           CHK FOR 3211 PRINTER            26400021
         BNE   CFN00550                 BRANCH IF NOT 3211              26500021
         L     RC,UCBXTADR              GET PRINTER EXT FROM UCB        26800021
         USING UCBUCS,RC                                                26900021
         L     RF,WTGPREFX              PREFIX ADDRESS           Y02082 26901002
         STM   RA,RET,IECREGSV-IECPREFX(RF) SAVE SETLOCK REGS    Y02082 26905002
         MODESET EXTKEY=SUPR            UCB, SETLOCK KEY         Y02082 26910002
CFN00520 SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                  Y02082*26915002
               RELATED=(LOCAL,IFG0202J(CFN00545)) GET LOCAL LOCK Y02082 26920002
         LTR   RD,RD                    TEST SETLOCK RETURN CODE Y02082 26925002
         LM    RA,RET,IECREGSV-IECPREFX(RF) RESTORE SETLOCK REGS Y02082 26930002
         BNZ   CFN01730                 BRANCH IF SETLOCK ERROR  Y02082 26935002
         SR    RF,RF                    CLEAR REG                       27000021
         IC    RF,UCBERADR              NO. OF DCBS OPEN TO 3211        27100021
         LTR   RF,RF                    IS COUNT 0              SA63705 27150002
         BZ    CFN00540                 YES, AVOID DECREMENT    SA63705 27160002
         BCTR  RF,0                     DECREMENT BY 1                  27200021
         STC   RF,UCBERADR              STORE NO. OF DCBS               27300021
         LTR   RF,RF                    LAST DCB OPEN TO 3211           27400021
         BNZ   CFN00540                 NO, BR AROUND FREEMAIN   Y02082 27500002
         L     R1,UCBERADR              GET ERP W/A ADDR                27600021
         LA    R0,WALNTH                SET SUBPOOL LENGTH       YM2445 27700002
WALNTH   EQU   X'23A'                   SUBPOOL LENGTH           YM2445 27710002
         XC    UCBERADR,UCBERADR        ZERO ERP WORKAREA ADDR  SA63705 27750002
         IECRES FREE,WLH,LV=(0),A=(1),KEY=K0,SP=K255,PREFIX=NO,  Y02082*27850002
               STM=(2,14,WTGPREFX)      FREE 3211 ERP WORKAREA   Y02082 27855002
         DROP  RC                                                       28000021
CFN00540 EQU   *                        NOT LAST DCB             Y02082 28001002
         L     RF,WTGPREFX              PREFIX ADDRESS           Y02082 28005002
         MODESET EXTKEY=DATAMGT         KEY 5 FOR SAVE AREA      Y02082 28006002
         STM   RA,RET,IECREGSV-IECPREFX(RF) SAVE SETLOCK REGS    Y02082 28010002
         MODESET EXTKEY=SUPR            UCB, SETLOCK KEY         Y02082 28015002
CFN00545 SETLOCK RELEASE,TYPE=LOCAL,                             Y02082*28020002
               RELATED=(LOCAL,IFG0202J(CFN00520)) RELEASE LOCK   Y02082 28025002
         LTR   RD,RD                    TEST SETLOCK RETURN CODE Y02082 28030002
         LM    RA,RET,IECREGSV-IECPREFX(RF) RESTORE SETLOCK REGS Y02082 28035002
         BNZ   CFN01730                 BRANCH IF SETLOCK ERROR  Y02082 28040002
         MODESET EXTKEY=DATAMGT         RETURN TO D.M. KEY       Y02082 28045002
*                                                                       28050003
*********************************************************************** 28060003
*                                                                       28100021
*  DELETE THE IGG019XX ACCESS METHOD SUBROUTINES AND I/O APPENDAGES     28200003
*  WHOSE ID IS STORED IN THE SUBROUTINE NAME SECTION OF THE DEB.        28300003
*                                                                       28400021
CFN00550 EQU   *                                                        28500021
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY      Y02082 28550002
         SR    R0,R0                    CLEAR REG 0                     28600021
         SR    RC,RC                    CLEAR REG C                     28700021
         IC    RC,DEBNMSUB              PICK UP NUM OF SUBROUTINES      28800021
         LTR   RC,RC                    ARE THERE ANY SUBRTNS           28900021
         BZ    CFN01100                 BRANCH IF NO SUBRTNS INDICATED  29000021
         SR    RD,RD                    CLEAR REG                       29100021
         IC    RD,DEBNMEXT              PICK UP NR OF EXTENTS           29200021
         SLL   RD,2                     MULTIPLY BY TWO                 29300021
         TM    DEBEXSCL,X'04'           TEST EXTENT TYPE FOR NON-D.A.   29400021
         BZ    CFN00600                 BRANCH IF NOT D.A.              29500021
         SLL   RD,2                     MULTIPLY BY TWO                 29600021
CFN00600 EQU   *                                                        29700021
         LA    RD,DEBSUCBA-DEBBASIC(,RD) ADD SIZE OF DEB BASIC   Y02134 29800002
*                                       SECTION                  Y02134 29850002
         IC    R0,DEBAMLNG              PICK UP SIZE OF AM SECTION      29900021
         TM    DCBMACRF,DCBMEXCP        IS DCB EXCP              A41440 29930021
         BO    CFN00700                 BRANCH IF SO             A41440 29960021
         TM    DCBDSORG,DCBORGDA        IS IT BDAM                      30000021
         BZ    CFN00700                 BRANCH IF NOT BDAM              30100003
         SLL   R0,2                     GET NUMBER OF BYTES             30200021
CFN00700 EQU   *                                                        30300021
         AR    RD,R0                    TOTAL OFFSET TO SUBRTN SECT     30400021
         AR    RD,RDEB                  POINTER TO SUBRTN SECT IN RC    30500021
         MVC   WTGMODNM,CL3IGG          SET UP FOR DELETE FUNCTION      30600021
CFN00800 EQU   *                                                        30700021
         TM    DCBOFLGS,DCBOCON         SEQTL CONCATENATION             30800021
         BZ    CFN00900                 BRANCH IF NO                    30900021
         CLC   0(K2,RD),GERRID          IS THIS THE GERR SUBRTN         31200021
         BE    CFN01000                 BR IF IT IS GERR                31300021
         CLC   0(K2,RD),CHECKID         IS THIS THE CHECK SUBRTN        31400021
         BE    CFN01000                 BR IF IT IS CHECK               31500021
CFN00900 EQU   *                                                        31600021
         MVC   WTGMODID,0(RD)           MOVE IN SUBRTN ID               31700021
         LR    R0,RWTG                  SUBRTN NAME POINTER             31800021
         DELETE EPLOC=(0)               DELETE                          31900021
CFN01000 EQU   *                                                        32000021
         LA    RD,K2(,RD)               POINT TO NEXT ID IN THE DEB     32100021
         BCT   RC,CFN00800              TEST FOR LOOP COMPLETION        32200021
         L     RC,DXDSAB                FETCH DSAB ADDRESS       YM1234 32200502
         USING DSAB,RC                  ADDRESS DSAB             YM1234 32200602
         TM    DSABFLG4,DSABCKSI        DOES CHKPT S/I EXIST     YM1234 32200702
         DROP  RC                       DSAB ADDRESSABILITY      YM1234 32200802
         BZ    CFN01005                 IF NOT, BRANCH           YM1234 32200902
         MVC   WTGMODID,ID19SI          SETUP TO DELETE S/I      YM1234 32201002
         LR    R0,RWTG                  ROUTINE 'IGG019SI'       YM1234 32201202
         DELETE EPLOC=(0)               DELETE                   YM1234 32201302
CFN01005 EQU   *                        END OF DELETE LOGIC      YM1234 32201402
         MVI   DXATCLOS,DXATDELT        SHOW A.M. SUBROUTINES &  Y02144 32201702
*                                       I/O APPENDAGES DELETED   Y02144 32202002
*                                                                       32202503
*********************************************************************** 32203003
*                                                                       32204002
*  QSAM PARALLEL INPUT PROCESSING OCCURS HERE.  IF DCBPOPEN IS 1,       32205002
*  DCBPOPEN IS SET TO 0; THE ADDRESS OF THE PARALLEL DATA ACCESS        32206002
*  BLOCK IS OBTAINED FROM THE DCB EXIT LIST; THE DCB ADDRESS IS         32207002
*  REMOVED FROM THE DCB ADDRESS QUEUE IN THE PDAB; AND THE PARALLEL     32208002
*  GET ROUTINE IS DELETED.                                              32209002
*                                                                       32210002
         TM    DCBMACF1,DCBMEXCP        USING EXCP              YL03123 32211002
         BO    CFN01100                 BR YES                  YL03123 32212002
         TM    DCBDSRG2,DCBACBM         CONTROL BLOCK AN ACB    YL03123 32213002
         BO    CFN01100                 BR YES                  YL03123 32214002
         TM    DCBDSRG1,DCBDSGPS+DCBDSGPO CAPABLE OF QSAM       YL03123 32215002
         BZ    CFN01100                 BR NO                   YL03123 32216002
         TM    DCBMACF1,DCBMRGET        QSAM INPUT              YL03123 32217002
         BZ    CFN01100                 BR NO                   YL03123 32218002
         TM    DCBQSWS,DCBPOPEN         USING PARALLEL GET      YL03123 32219002
         BZ    CFN01100                 BR NO                   YL03123 32220002
         NI    DCBQSWS,X'FF'-DCBPOPEN   RESET PARALLEL INPUT    YL03123 32221002
         L     RC,DCBEXLST                                      YL03123 32222002
         N     RC,ADDRMASK              EXIT LIST PRESENT       YL03123 32223002
         BZ    CFN01100                 BR NO                   YL03123 32224002
         L     RDCB,DXUDCBAD            ADDR USER DCB           YL03127 32225002
         MODESET KEYADDR=DXUKEY,WORKREG=1                       YL03123 32226002
         NI    DCBQSWS,X'FF'-DCBPOPEN   RESET PARALLEL INPUT     YM1343 32226502
CFN01010 EQU   *                        CHECK NEXT ENTRY        YL03123 32227002
         CLI   0(RC),XLQPIP             PDAB ADDR               YL03123 32228002
         BE    CFN01020                 BR YES                  YL03123 32229002
         CLI   0(RC),XLQPIP+LASTNTRY    PDAB ADDR               YL03123 32230002
         BE    CFN01020                 BR YES                  YL03123 32231002
         TM    0(RC),LASTNTRY           LAST EXLST ENTRY        YL03123 32232002
         BO    CFN01050                 BR YES                  YL03123 32233002
         LA    RC,K4(,RC)               STEP TO NEXT ENTRY      YL03123 32234002
         B     CFN01010                 GO CHECK NEXT ENTRY     YL03123 32235002
CFN01020 EQU   *                        PDAB ADDR FOUND         YL03123 32236002
         L     RC,0(,RC)                LOCATE PDAB             YL03123 32237002
         USING IHAPDAB,RC                                       YL03123 32238002
         LA    RD,PDADCBAL-K4           DCB QUEUE FOR BXH INSTR YL03123 32239002
         LM    RET,R1,PDADCBAI          GET PDAB PARMS          YL03123 32240002
         LA    RDCB,0(,RDCB)            READY FOR COMPARE       YL03123 32241002
CFN01030 EQU   *                                                YL03123 32242002
         BXH   RD,RET,CFN01050          BR IF END OF DCB LIST   YL03123 32243002
         C     RDCB,0(,RD)              FOUND DCB ENTRY         YL03123 32244002
         BNE   CFN01030                 BR NO                   YL03123 32245002
         MVC   0(K4,RD),0(RF)           DELETE CLOSED DCB ENTRY YL03123 32246002
         XC    0(K4,RF),0(RF)           HOUSEKEEPING            YL03123 32247002
         SR    RF,RET                   BOTTOM DCB ENTRY ADDR   YL03123 32248002
         SR    R1,RET                   UPDATE ECB INDEX        YL03123 32249002
         STM   RET,R1,PDADCBAI          UPDATE PDAB PARMS       YL03123 32250002
         LH    R1,PDANODCB              FETCH NUMBER OF DCB'S   YL03123 32251002
         SH    R1,HWONE                 SUBTRACT THIS ENTRY     YL03123 32252002
         BP    CFN01040                 BR IF QUEUE NOT EMPTY   YL03123 32253002
         XC    PDAGRTNA,PDAGRTNA        CLEAR PARALLEL GET ADDR YL03123 32254002
CFN01040 EQU   *                        QUEUE NOT EMPTY         YL03123 32255002
         STH   R1,PDANODCB              UPDATE NO. OF DCB'S     YL03123 32256002
         MODESET EXTKEY=DATAMGT         RESUME DATA MGT KEY      YM1466 32256402
         MVC   WTGMODID,QPGET           IGG019JD                YL03123 32257002
         LR    R0,RWTG                                          YL03123 32258002
         DELETE EPLOC=(0)               DELETE PARALLEL GET RTN YL03123 32259002
         B     CFN01060                 AVOID 2ND MODESET        YM1466 32259402
CFN01050 EQU   *                        GET IN DM KEY           YL03123 32260002
         MODESET EXTKEY=DATAMGT         RESUME DATA MGT KEY     YL03123 32261002
CFN01060 EQU   *                        RELOAD DCB REG           YM1466 32261402
         L     RDCB,DXPDCBAD            ADDR COPY OF DCB        YL03123 32262002
CFN01100 EQU   *                                                        32300021
         MVC   WTGMODNM,CLIFGNM         MOVE BACK IFG0202J      SA68439 32350002
*                                                                       32400021
*********************************************************************** 32450003
*                                                                       32500021
*    IF USER TOTALING WAS SPECIFIED, FREE THE TOTALING SAVE AREA        32600021
*                                                                       32700021
*                                                                       32800021
         TM    DCBMACRF,DCBMEXCP        CK FOR EXCP                     32900021
         BO    CFN01200                 IF EXCP, SKIP TOTALING          33000021
         TM    DCBDSORG,DCBORGPS        CK FOR PHYS SEQ                 33100021
         BZ    CFN01200                 NOT PS, SKIP TOTALING           33200021
         TM    DCBOPTCD,DCBOPTT         TEST IF TOTALING SPECIFIED      33300021
         BZ    CFN01200                 NO,BR TO SKIP TOTALING          33400021
         LTR   RUCB,RUCB                TEST FOR DUMMY          SA68439 33450002
         BZ    CFN01200                 BRANCH IF YES           SA68439 33460002
         TM    DEBOPATB,DEBOPOUT-DEBOPRBK  CK IF OPENED FOR EITHER      33500021
*                                       INPUT OR RDBACK                 33600021
         BZ    CFN01200                 YES, SKIP TOTALING              33700021
*                                                                       33800021
*              GET ADDRESS OF TOTALING AREA FROM ACCESS METHOD          33900021
*              PORTION OF DEB.                                          34000021
*                                                                       34100021
         SR    RC,RC                    CLEAR REGISTER                  34300021
         IC    RC,DEBNMEXT              GET NUMBER OF EXTENTS           34400021
         IC    R1,DEBEXSCL              GET EXTENT SCALE                34500021
         SLL   RC,0(R1)                 COMPUTE LENGTH OF EXTENTS       34600021
         L     R1,K36(RC,RDEB)          ADDR OF TOTLING SAVE AREA       34700021
         LA    R1,0(,R1)                CLEAR HI-ORDER BYTE             34750002
         LTR   R1,R1                    IS SAVE AREA ADDR ZERO          34760002
         BZ    CFN01200                 YES,DO NOT ISSUE FREEMAIN       34770002
         MODESET  KEYADDR=DXUKEY,WORKREG=12   ENTER USER KEY     YM1359 34780002
         L     RC,TOTTOTLN-TOTSAVWA(,R1)  TOTAL LENGTH OF AREA @ZA02211 34800003
         LA    RC,K0(,RC)               1ST BYTE IS SUBPOOL      YM3056 34810002
         FREEMAIN R,LV=(RC),A=(1)       FREE USER TOTAL AREA   @ZA02211 34830003
         MODESET EXTKEY=DATAMGT         CLOSE KEY RESTORED       YM3056 34840002
         MVI   DXATCLOS,DXATUTOT        USER TOTALING SAVE AREA  Y02144 35360102
*                                       RELEASED                 Y02144 35370002
         EJECT                                                          35400021
*********************************************************************** 35450003
*                                                                     * 35500021
*                          FUNCTION PROLOG                            * 35600021
*                                                                     * 35700021
*********************************************************************** 35800021
*                                                                     * 35900021
* FUNCTION NAME -                                                     * 36000021
*    CLOSE FINAL RESTORE SYSTEM FUNCTION.                             * 36100021
*                                                                     * 36200021
* (STATUS) -                                                          * 36300021
*    NOT APPLICABLE                                                   * 36400021
*                                                                     * 36500021
* FUNCTION -                                                          * 36600021
*    RESTORE DCB TO ITS PRE-OPEN STATE IF THE DCB WAS MODIFIED BY OPEN* 36800021
*    DECREMENT DATA MANAGEMENT COUNT.                                 * 36850021
*                                                                     * 36900021
* ENTRY POINTS -                                                      * 37000021
*    ENTERED FROM THE FOLLOWING--                                     * 37100021
*    CLOSE FINAL RESTORE DATA MANAGEMENT FUNCTION.                    * 37200021
*                                                                     * 37300021
* INPUT -                                                             * 37400021
*    A POINTER TO EACH OF THE FOLLOWING--                             * 37500021
*       CURRENT PARAMETER LIST ENTRY- RPARC                           * 37600021
*       DD ENTRY IN THE TIOT- RTIOT                                   * 37700021
*       WTG TABLE- RWTG                                               * 37800021
*       CURRENT WTG TABLE ENTRY- RWTGC                                * 37900021
*       DCB- RDCB                                                     * 38000021
*       WORK AREA- RCORE                                              * 38100021
*       RESIDENT ROUTINE- RES                                         * 38200021
*       UCB- RUCB                                                     * 38300021
*       DEB- RDEB                                                     * 38400021
*                                                                     * 38500021
* OUTPUT -                                                            * 38600021
*    DATA MANAGEMENT COUNT DECREMENTED BY ONE.                        * 38700021
*    DEB REMOVED FROM THE DEB CHAIN.                                  * 38800021
*    DCB RESTORED TO ITS PRE-OPEN STATE.                              * 38900021
*                                                                     * 39000021
* EXTERNAL REFERENCES -                                               * 39100021
*    REFER TO THE PRECEEDING MODULE PROLOG.                           * 39200021
*                                                                     * 39300021
* EXITS, NORMAL -                                                     * 39400021
*    REFER TO THE PRECEEDING MODULE PROLOG.                           * 39500021
*    CLOSE FINAL TERMINATION FUNCTION.                                * 39600021
*                                                                     * 39700021
* EXITS, ERROR -                                                      * 39800021
*    REFER TO THE PRECEEDING MODULE PROLOG.                           * 39900021
*                                                                     * 40000021
* TABLES/WORK AREAS -                                                 * 40100021
*    THE OPEN, CLOSE, OR EOV WORK AREA AND THE WHERE-TO-GO (WTG)      * 40200021
*    TABLE ARE DESCRIBED BY THE DSECTS AT THE END OF THE LISTING.     * 40300021
*                                                                     * 40400021
* ATTRIBUTES -                                                        * 40500021
*    REFER TO THE PRECEEDING MODULE PROLOG.                           * 40600021
*                                                                     * 40700021
* CHARACTER CODE DEPENDENCY -                                         * 40800021
*    REFER TO THE PRECEEDING MODULE PROLOG.                           * 40900021
*                                                                     * 41000021
* NOTES -                                                             * 41100021
*    NOT APPLICABLE                                                   * 41200021
*                                                                     * 41300021
*********************************************************************** 41400021
         EJECT                                                          41500021
CFN01200 EQU   *                                                        41600021
         TM    DEBOFLGS,DEBOFDCB        WAS DCB MODIFIED                47800021
         BZ    CFN02300                 BR IF DCB NOT MODIFIED   M1752  47850021
         B     CFN01270                 RESTORE DEB              Y02120 47900002
*                                                                       47901021
*        THIS ROUTINE WILL RESTORE DCB TO A FRESH CONDITION             47902021
*                                                                       47903021
*        THERE IS NO DEB REMAINING FOR A SPOOLED DCB - THE       Y02120 47903402
*        C/I CLOSE EXECUTORS SAVE THE DCB  MODIFICATION MASK IN  Y02120 47903802
*        THE FIRST WORD OF THE CLOSE WORK AREA.                  Y02120 47903902
*                                                                       47905202
CFN01230 EQU   *                        REFRESH DCB              Y02120 47907202
         STM   RES,RDEB,DXCCW1          SAVE REGISTERS           Y02120 47907402
         LR    RDEB,RCORE               POINT RDEB TO MOD MASK   Y02120 47907502
         B     CFN01280                 CONTINUE REFRESHING DEB  Y02120 47907602
*  WHEN RESTORING DCB TO PRE-OPEN STATUS, IT IS REQUIRED THAT           47908002
*        1)  HIARCHY FLAGS (DCBBFTEK BITS 0,5) ARE NOT RESET,           47908902
*   AND  2)  HIARCHY FLAGS DO NOT INTERFERE WITH THE RESETTING          47910202
*            OF THE BFTEK/BFALN FIELDS.                                 47911502
CFN01270 EQU   *                                                Y02120  47912402
         STM   RES,RDEB,DXCCW1          SAVE REGISTERS           M0528  47912802
         L     RDEB,DXDEBXAD            GET DEB EXTENSION ADDR   Y02134 47914102
         USING DEBXTN,RDEB                                       Y02134 47916102
         LA    RDEB,DEBXDCBM            POINT TO DCB MOD MASK    Y02134 47916202
CFN01280 EQU   *                        CONTINUE REFRESHING DCB  Y02120 47916402
         L     RPAR,0(,RDEB)            PICK UP MASK             M0528  47916702
         MVI   DXCCW11,K0               CLEAR TEMP SAVE AREA     M0528  47918002
         TM    DCBMACRF,DCBMEXCP        TEST FOR EXCP            M0528  47919302
         BZ    CFN04200                 BRANCH IF NOT EXCP       M0528  47920602
         TM    DCBMACRF,DCBMFOUN        TEST IF FBE IS PRESENT   M0528  47921902
         BZ    CFN04500                 BRANCH IF NOT            M0528  47923202
CFN04200 EQU   *                        NOT EXCP                 M0528  47924502
         TM    DCBDSORG,DCBORGIS+DCBORGDA+DCBORGPO  IS, DA OR PO M0528  47925802
         BM    CFN04400                 BRANCH IF ISAM, DA OR PO M0528  47927102
         TM    DCBDSORG,DCBORGPS        IS THIS PS               M0528  47928402
         BNO   CFN04300                 NOT PS                   M0528  47929702
         TM    TIOELINK,TIOEQNAM        IS THIS TCAM PS          M0528  47931002
         BNZ   CFN04500                 BRANCH IF TCAM           M0528  47932302
         TM    K3(RDEB),X08             FUNC BIT MASK            M0528  47933602
         BZ    CFN04400                 BRANCH IF NOT            M0528  47934902
         MVI   DCBFUNC,K0               RESTORE DCB FUNC FIELD   M0528  47936202
         B     CFN04400                 CONTINUE WITH PS         M0528  47937502
*                                       PROCESSING               M0528  47938802
CFN04300 TM    DCBDSORG+K1,DCBORGGR     IS THIS GRAPHIC          M0528  47940102
         BO    CFN04500                 BRANCH IF YES            M0528  47941402
         TM    DCBDSORG+K1,DCBORGTX+DCBORGTQ  IS THIS TX OR TQ   M0528  47942702
         BM    CFN05100                 BRANCH IF YES            M0528  47944002
         TM    DCBDSORG+K1,DCBDSGTR     DSORG=TCAM TR            S22024 47944402
         BO    CFN05650                 YES, BRANCH              S22024 47944802
*  ELIMINATED ALL EXCEPT TAM.  FOR TAM, ONLY (CX)BTAM HAS               47945302
*  VALID HIARCHY FLAGS.                                                 47946602
         TM    DCBMACRF,DCBMREAD        TEST FOR 'READ'          M0528  47947902
         BO    CFN04400                 BRANCH IF 'READ'         M0528  47949202
         TM    DCBMACRF+K1,DCBMWRIT     TEST FOR 'WRITE'         S22024 47950502
         BO    CFN04400                 BRANCH IF BTAM USED      M0528  47951802
         B     CFN04500                 BYPASS SAVING OF HIARCHY M0528  47953102
*                                       FLAGS                    M0528  47954402
CFN04400 EQU   *                        SAVE FLAGS               M0528  47955702
         MVC   DXCCW11(K1),DCBHIARC     SAVE HIARCHY FLAGS UNTIL M0528  47957002
*                                       RESTORE COMPLETED               47958302
         NI    DXCCW11,DCBH0+DCBH1      CLEAR ALL BITS EXCEPT    M0528  47959602
*                                       HIARCHY INDICATIONS             47960902
CFN04500 EQU   *                        BYPASS SAVING FLAGS      M0528  47962202
         LA    R1,K1                    INITIALIZE R1 WITH ONE   M0528  47963502
         LA    RC,DADSP                 POINT TO DCB             M0528  47964802
*                                       DISPLACEMENT LIST        M0528  47966102
         LA    RD,DALGH                 POINT TO DCB FIELD       M0528  47967402
*                                       LENGTH LIST              M0528  47968702
         SR    RET,RET                  CLEAR RET                M0528  47970002
         SR    RF,RF                    AND RF                   M0528  47971302
*                                                                       47972602
*      CHECK  TO SEE IF NEXT FIELD IN DCB WAS ALTERED                   47973902
*                                                                       47975202
CFN04700 EQU   *                        WAS NEXT DCB ALTERED     M0528  47976502
         NR    R1,RPAR                  WAS DCB FIELD MODIFIED   M0528  47977802
         BZ    CFN04900                 NO, IT WAS NOT CHANGED   M0528  47979102
         IC    RET,0(,RC)               INSERT DCB FIELD         M0528  47980402
*                                       DISPLACEMENT             M0528  47981702
         IC    RF,0(,RD)                INSERT DCB FIELD         M0528  47983002
*                                       LENGTH-1                 M0528  47984302
         CLI   0(RC),X'24'              IS THIS FIELD RECFM      M0528  47985602
         BE    CFN05000                 BR IF IT IS RECFM        M0528  47986902
CFN04800 EQU   *                        RESTORE DCB FIELD        M0528  47988202
         AR    RET,RDCB                 LOCATION OF FIELD IN DCB M0528  47989502
         EX    RF,CFN05700              EXECUTE MOVE INSTRUCTION M0528  47990802
*                                                                       47992102
*        FIELD  IN  DCB  HAS  BEEN  RETURNED  TO ITS                    47993402
*                       FORMER  STATUS                                  47994702
CFN04900 EQU   *                        CHECK NEXT FIELD         M0528  47996002
         SRL   RPAR,1                   SHIFT MASK               M0528  47997302
         SR    RET,RET                  CLEAR RET                M0528  47998602
         SR    RF,RF                    AND RF                   M0528  47999902
         LA    RC,K1(,RC)               GET NEXT DISP PARAMETER  M0528  48001202
         LA    RD,K1(,RD)               GET NEXT LENGTH          M0528  48002502
*                                       PARAMETER                M0528  48003802
         LA    R1,K1                    REINITIALIZE R1 WITH ONE M0528  48005102
         CLI   0(RC),K0                 END OF RESTORE TABLE     M0528  48006402
         BE    CFN05800                 BRANCH IF THE END        M0528  48007702
         B     CFN04700                 CHECK NEXT FIELD         M0528  48009002
CFN05000 EQU   *                        RESTORE RECFM            M0528  48010302
         TM    DCBRECFM,K1              INDICATIOR BIT ON IN     M0528  48011602
*                                       RECFM                    M0528  48012902
         BZ    CFN04800                 BR IF INDICATOR BIT OFF  M0528  48014202
         MVC   DCBRECFM,DANULL          CLEAR RECFM              M0528  48015502
         OI    DCBRECFM,K1              SET INDICATOR BIT ON     M0528  48016802
         B     CFN04900                 BR TO LOOK AT NEXT FIELD M0528  48018102
*                                                                       48019402
* FOR TCAM WITH DSORG=TX OR DSORG=TQ, BUFMAX, PCI, RESERVE, BUFSIZE,    48020702
* AND THRESH FIELDS MAY HAVE BEEN MERGED FROM THE JFCB WITH A UNIQUE    48022002
* MERGE. THE MERGED FIELDS WILL BE RESTORED TO ZERO.                    48023302
*                                                                       48024602
CFN05100 EQU   *                        RESTORE MERGED FIELDS    M0528  48025902
         LA    R1,K8                    THRESH BIT MASK          M0528  48027202
         NR    R1,RPAR                  WAS FIELD MERGED         M0528  48028502
         BZ    CFN05200                 BRANCH IF NO             M0528  48029802
         MVI   K32(RDCB),K0             RESTORE FIELD TO ZERO    M0528  48031102
CFN05200 LA    R1,K256                  BUFMAX BIT MASK          M0528  48032402
         NR    R1,RPAR                  WAS FIELD MERGED         M0528  48033702
         BZ    CFN05300                 BRANCH IF NO             M0528  48035002
         MVI   K28(RDCB),K0             RESTORE FIELD TO ZERO    M0528  48036302
CFN05300 LA    R1,K1                    BUFSIZE BIT MASK         M0528  48037602
         SLL   R1,K12                   SHIFT MASK               M0528  48038902
         NR    R1,RPAR                  WAS FIELD MERGED         M0528  48040202
         BZ    CFN05400                 BRANCH IF NO             M0528  48041502
         SR    RD,RD                    ZERO OUT RD              M0528  48042802
         STH   RD,54(,RDCB)             RESTORE FIELD TO ZERO    M0528  48044102
CFN05400 LA    R1,K1                    RESERVE BIT MASK         M0528  48045402
         SLL   R1,K19                   SHIFT MASK               M0528  48046702
         NR    R1,RPAR                  WAS FIELD MERGED         M0528  48048002
         BZ    CFN05500                 BRANCH IF NO             M0528  48049302
         ST    RD,K56(,RDCB)            RESTORE FIELD TO ZERO    M0528  48050602
CFN05500 LA    R1,K1                    PCI BIT MASK             M0528  48051902
         SLL   R1,K21                   SHIFT MASK               M0528  48053202
         NR    R1,RPAR                  WAS FIELD MERGED         M0528  48054502
         BZ    CFN05600                 BRANCH IF NO             M0528  48055802
         MVI   K25(RDCB),K0             RESTORE FIELD TO ZERO    M0528  48057102
CFN05600 EQU   *                                                 M0528  48058402
         B     CFN04500                 CHECK OTHER FIELDS       M0528  48059702
CFN05650 EQU   *                        TCAM TR BRANCH           S22024 48060102
         LA    R1,X80                   IPLTX BIT MASK           S22024 48060502
         NR    R1,RPAR                  WAS FIELD MERGED         S22024 48060902
         BZ    CFN02200                 BRANCH IF NO            ZA00702 48063602
         MVC   DCBIPLTX,BLANKMSK        RESTORE FIELD TO BLANKS  S22024 48065602
         B     CFN02200                 XCTL TO NEXT MODULE     ZA00702 48066102
CFN05700 MVC   0(K1,RET),DANULL         MOVE ZEROS TO DCB FIELD  M0528  48066302
*                                                                       48069002
*                                                                       48071702
CFN05800 EQU   *                                                 M0528  48074402
*                                                                       48077102
*     RESTORE WRITE CHECK BIT IN DCBOPTCD TO PRE-OPEN STATUS            48079802
*                                                                       48082502
         TM    K1(RDEB),DCBOPTW         WAS WRITE CHECK BIT SET  M0528  48085202
*                                       ON                       M0528  48087902
         BZ    CFN05900                 BRANCH IF NOT            M0528  48090602
         NI    DCBOPTCD,X'FF'-DCBOPTW   RESTORE WRITE CHECK TO   M0528  48093302
*                                       OFF                      M0528  48096002
CFN05900 EQU   *                                                 M0528  48098702
         TM    0(RDEB),DCBUSAON         WAS DCBUSASI BIT SET ON  M0528  48101402
         BZ    CFN06000                 BRANCH IF NOT            M0528  48104102
         NI    DCBUSASI,X'FF'-DCBUSAON  TURN OFF DCBUSASI BIT    M0528  48106802
CFN06000 EQU   *                        BFTEK/BFALN              M0528  48109502
*                                                                       48112202
*  BFTEK/BFALN FIELDS HAVE BEEN RESTORED TO PRE-OPEN STATUS,            48114902
*  BUT HIARCHY INDICATIONS ARE NOT .                                    48117602
         OC    DCBHIARC,DXCCW11         MAINTAIN HIARCHY FLAGS   M0528  48120302
*                                       AFTER                    M0528  48123002
*  CLOSE HAS RESTORED THE BFTEK/BFALN FIELDS.                           48125702
*  FOR GAM,EXCP W/O FBE, AND QTAM THIS RESULTS IN OR'ING ZEROS.         48128402
*  NOTE - IF BOTH B0 AND B5 ARE ON, THIS ERROR CONDITION WILL           48131102
*  NOT BE ELIMINATED UNTIL THE DATA SET IS OPENED AGAIN.  THIS          48133802
*  CONDITION WILL DEFAULT TO A HIARCHY=0 INDICATION  AFTER THE          48136502
*  DCB TO JFCB MERGE DURING OPEN.                                       48139202
*                                                                       48141902
CFN02200 EQU   *                        RESTORE REGISTERS       ZA00702 48143902
         LM    RPAR,RDEB,DXCCW1         RESTORE REGS             M0528  48144602
CFN02300 EQU   *                                                        48147302
         MVI   DXATCLOS,DXATRDCB        DCB RESTORATION FINISHED Y02144 48150002
         IECRES LOAD,MODID=FINMOD,BRANCH=QUEUED XCTL TO FINMOD   Y02080 54450002
*  HAVE JAM OR SPOOLED ACB                                              54800000
CFN01710 EQU   *                        ENTRY FROM JES                  55000000
         TM    TIOELINK,TIOESYOT        SPOOLED OUTPUT FILE             55200003
         BZ    CFN02300                 NO-BYPASS JFCB WRITE     Y02134 55400002
         LR    RC,RET                   SAVE CURRENT TCB ADDR           55600000
         LA    R0,DXJBF                 POINT TO JFCB           SA68439 55650002
         LA    R1,TIOEJFCB              JFCB TTR IN TIOT        SA68439 55700002
         IECRES  WRJFCB,(R1),(R0)       WRITE JFCB              SA68439 55750002
         B     CFN02300                 XCTL TO NEXT MODULE             61200000
CFN01730 EQU   *                        SETLOCK ERROR            Y02082 61205002
         DMABCOND PCK,SETLOCK           SETLOCK ERROR ANALYSIS   Y02082 61210002
*                                       ROUTINE                  Y02082 61215002
         EJECT                                                          62000021
**********************************************************************  62200021
*                                                                    *  62300021
*                    CONSTANTS                                       *  62400021
*                                                                    *  62500021
**********************************************************************  62600021
         SPACE 1                                                        62700021
*                                                                       62705021
*                                                                       62710021
*        THE FOLLOWING TABLE REPRESENTS THE DISPLACEMENTS               62715021
*                                                                       62720021
*        OF FIELDS WITHIN THE DCB                                       62725021
*                                                                       62730021
*                                                                       62735021
DADSP    DS    0F                                                M0528  62740021
         DC    FL1'26'                  DSORG                    M0528  62745021
         DC    FL1'82'                  LRECL                    M0528  62750021
         DC    FL1'24'                  INTVL                    M0528  62755021
         DC    FL1'32'                  CPRI                     M0528  62760021
         DC    FL1'24'                  SOWA                     M0528  62765021
         DC    FL1'16'                  KEY LENGTH               M0528  62770021
         DC    FL1'20'                  BUFNO                    M0528  62775021
         DC    FL1'24'                  BUFL                     M0528  62780021
         DC    FL1'32'                  BFTEK AND BFALN          M0528  62785021
         DC    FL1'18'                  DENSITY                  M0528  62790021
         DC    FL1'36'                  RECFM                    M0528  62795021
         DC    FL1'52'                  OPTCOD                   M0528  62800021
         DC    FL1'62'                  BLOCK SIZE               M0528  62805021
         DC    FL1'72'                  BSAM NCP                 M0528  62810021
         DC    FL1'81'                  BDAM LIMCT               M0528  62815021
         DC    FL1'82'                  ISAN-QSAM LRECL          M0528  62820021
         DC    FL1'84'                  ISAM-QSAM EROPT          M0528  62825021
         DC    FL1'72'                  ISAM NCP                 M0528  62830021
         DC    FL1'112'                 ISAM DUBFN               M0528  62835021
         DC    FL1'60'                  ISAM RKP                 M0528  62840021
         DC    FL1'55'                  ISAM CYLOF               M0528  62845021
         DC    FL1'54'                  ISAM NTM                 M0528  62850021
         DC    FL1'81'                  BUFOF - ASCII            M0528  62855021
ENDOFTAB DC    X'00'                    END OF OFFSET TABLE      M0528  62860021
*                                                                       62865021
*                                                                       62870021
*                                                                       62875021
*                                                                       62880021
*                                                                       62885021
*        THE FOLLOWING IS A TABLE OF THE LENGTHS-1 OF                   62890021
*                                                                       62895021
*        THE FIELDS IN THE DCB WHICH WILL BE RESTORED AT CLOSE TIME     62900021
*                                                                       62905021
*                                                                       62910021
*                                                                       62915021
DALGH    DS    0F                                                M0528  62920021
         DC    FL1'0'                   DSORG                    M0528  62925021
         DC    FL1'1'                   LRECL                    M0528  62930021
         DC    FL1'0'                   INTVL                    M0528  62935021
         DC    FL1'0'                   CPRI                     M0528  62940021
         DC    FL1'1'                   SOWA                     M0528  62945021
         DC    FL1'0'                   KEY LENGTH               M0528  62950021
         DC    FL1'0'                   BUFNO                    M0528  62955021
         DC    FL1'1'                   BUFL                     M0528  62960021
         DC    FL1'0'                   BFTEK AND BFALN          M0528  62965021
         DC    FL1'0'                   DENSITY                  M0528  62970021
         DC    FL1'0'                   RECFM                    M0528  62975021
         DC    FL1'0'                   OPTCOD                   M0528  62980021
         DC    FL1'1'                   BLOCK SIZE               M0528  62985021
         DC    FL1'0'                   BSAM NCP                 M0528  62990021
         DC    FL1'2'                   BDAM LIMCT               M0528  62995021
         DC    FL1'1'                   ISAM-QSAM LRECL          M0528  63000021
         DC    FL1'0'                   ISAM-QSAM EROPT          M0528  63005021
         DC    FL1'0'                   ISAM NCP                 M0528  63010021
         DC    FL1'0'                   ISAM DUBFN               M0528  63015021
         DC    FL1'1'                   ISAM RKP                 M0528  63020021
         DC    FL1'0'                   ISAM CYLOF               M0528  63025021
         DC    FL1'0'                   ISAM NTM                 M0528  63030021
         DC    FL1'0'                   BUFOF - ASCII            M0528  63035021
DANULL   DC    X'000000'                ZERO CONSTANT            M0528  63040021
BLANKMSK DC    CL8' '                   BLANK CONSTANT           S22024 63090002
CL3IGG   DC    C'IGG019'                APPENDAGE FOR SUBRTN ID         63100003
GERRID   DC    C'AQ'                    INPUT SYNCH ROUTINE             63300021
CHECKID  DC    C'BB'                    CHECK ROUTINE                   63400021
ID19SI   DC    C'SI'                    CHKPT S/I ROUTINE ID     YM1234 63400502
CLIFGNM  DC    C'IFG0202J'              CLOSE MOD NAME                  63500021
QPGET    DC    C'JD'                    QSAM PARALLEL INPUT MOD YL03123 63821002
HWONE    DC    H'1'                                             YL03123 63821503
ADDRMASK DC    A(X'FFFFFC')             ADDRESS MASK            YL03123 63822002
*                                                                       63825003
         XCTLTABL ID=(FINMOD,2K,PDMOD,0P),                             *63830000
               SVC=020,BRT=YES,LENGTH=                           Y02080 63840002
         EJECT                                                          63850003
         IECEQU IEZDEB=YES              DEFINE EQUATES                  63860003
         IECDSECS CVT,TIOT,IEZDEB,UCB,ACB,MAIN,WTG,USERTOT,      S22024*63900003
               PSA,                                              Y02082*63905002
               DSAB,                                             YM1234*63905502
               PREFX,PDAB,EXPAND=YES    DEFINE DSECTS                   63950003
         DCBD  DSORG=(PS,IS,DA,PO,BS,TQ,TR)   INCLUDE 3705       S22024 64180002
         END                                                            64200021
