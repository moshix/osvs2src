         TITLE 'IFG0202K                      CLOSE FINAL COMMON FUNCTIO00100002
               ON STRING 2'                                      Y02134 00150002
IFG0202K CSECT                                                          00400021
*********************************************************************** 00500021
*                                                                     * 00600021
*          VS2 RELEASE 03 DELETIONS                                   * 00610037
*360720,435924                                                 @ZA02193 00620037
*0000435602                                                    @ZA12942 00630037
*0000435905                                                    @ZA13790 00635037
*          VS2 RELEASE 02 DELETIONS                                   * 00640037
*0000                                                          @ZA02201 00652037
*          VS2 RELEASE 01 DELETIONS                                   * 00660002
*                                                                     * 00670000
*0000                                                            YM2093 00680000
*0000                                                            YM3035 00682000
*0000                                                            YM2949 00684000
*0000                                                            YM4411 00686000
*                                                                       00688002
*          VS1 RELEASE 02 DELETIONS                                     00688402
*0000                                                            XM0633 00688802
*                                                                     * 00700021
*          RELEASE 21 DELETIONS/CHANGES                               * 01200021
*0000025000-029000,079000-083000,097000,106000-114000,146000-    M0528  01210021
*0000292000,320000-328000,387000-388000,488000-555000            M0528  01220021
*                                                                A36405 01230021
*                                                                S21088 01260021
*                                                                M0023  01280021
*                                                                     * 01300021
* MODULE NAME = IFG0202K                                              * 01350002
*                                                                     * 01360002
* DESCRIPTIVE NAME = CLOSE COMMON FINAL FUNCTION STRING 2             * 01370002
*                                                                     * 01380002
* COPYRIGHT = NONE                                                    * 01390002
*                                                                     * 01392002
* STATUS CHANGE LEVEL 000                                             * 01400021
*                                                                     * 01500021
* FUNCTION -                                                          * 01600021
*    THIS MODULE CONTAINS THE FUNCTION(S) OR PART(S) OF FUNCTION(S)-- * 01700021
*    CLOSE FINAL RESTORE SYSTEM FUNCTION.                             * 01800021
*       THIS FUNCTION STARTS IN MODULE IFG0202J.                      * 01900021
*    CLOSE FINAL TERMINATION FUNCTION.                                * 02000021
*    REFER TO THE FOLLOWING 'FUNCTION PROLOG(S)' FOR DETAILS.         * 02100021
*                                                                     * 02200021
* ENTRY POINTS -                                                      * 02300021
*         IFG0202K - ENTRY POINT VIA AN XCTL FROM THE FOLLOWING--     * 02400021
*             IFG0202J - PROCESS CLOSE FINAL RESTORE SYSTEM           * 02600021
*                        FUNCTION.                                    * 02800021
*             IFG0200Y - IF ACB BUSY AFTER RETURN FROM EXECUTORS      * 02850002
*                                                                     * 03000021
* INPUT -                                                             * 03100021
*    ENTERED IN DATA MANAGEMENT KEY                              Y02082 03150002
*    REFER TO THE FOLLOWING 'FUNCTION PROLOG(S)'.                     * 03200021
*                                                                     * 03300021
* OUTPUT -                                                            * 03400021
*    EXIT IN DATA MANAGEMENT KEY                                 Y02082 03450002
*    REFER TO THE FOLLOWING 'FUNCTION PROLOG(S)'.                     * 03500021
*                                                                     * 03600021
* EXTERNAL REFERENCES -                                               * 03700021
*         IFG019RA - OPEN/CLOSE/EOV RESIDENT ROUTINE FOR XCTL AND     * 03800002
*                    WAIT.                                            * 03900021
*    REFER TO THE FOLLOWING 'FUNCTION PROLOG(S)'.                     * 04000021
*                                                                     * 04100021
* EXITS, NORMAL -                                                     * 04200021
*    EXIT VIA THE RESIDENT ROUTINE XCTL TO THE FOLLOWING--            * 04300021
*         IFG0202L - CONTINUE PROCESSING CLOSE FINAL TERMINATION      * 04400021
*                    FUNCTION.                                        * 04500021
*    REFER TO THE FOLLOWING 'FUNCTION PROLOG(S)'.                     * 04600021
*                                                                     * 04700021
* EXITS, ERROR -                                                      * 04800021
*    EXIT IS TO THE PROBLEM DETERMINATION MODULE IFG0200P, IF AN      * 04900021
*    ABEND SITUATION OCCURS IN THIS MODULE.  REFER TO THE FOLLOWING   * 05000021
*    'FUNCTION PROLOG(S)'.                                            * 05100021
*                                                                     * 05200021
* TABLES/WORK AREAS -                                                 * 05300021
*    REFER TO THE FOLLOWING 'FUNCTION PROLOG(S)'.                     * 05400021
*                                                                     * 05500021
* ATTRIBUTES -                                                        * 05600021
*    REENTRANT, REFRESHABLE, READ-ONLY, ENABLED, PRIVILEGED           * 05700021
*                                                                     * 05800021
* CHARACTER CODE DEPENDENCY -                                         * 05900021
*    CLASS ONE CHARACTER CODE DEPENDENCY - THE EBCDIC CHARACTER CODE  * 06000021
*    WAS USED FOR ASSEMBLY.  THE MODULE MUST BE REASSEMBLED IF A      * 06100021
*    DIFFERENT CHARACTER SET IS USED FOR EXECUTION.                   * 06200021
*                                                                     * 06300021
* NOTES -                                                             * 06400021
*    REFER TO THE FOLLOWING 'FUNCTION PROLOG(S)'.                     * 06500021
*                                                                     * 06600021
*********************************************************************** 06700021
         EJECT                                                          06800021
         USING IHADCB,RDCB                                              06900021
         USING FORCORE,RCORE                                            07000021
         USING WTG,RWTG                 WHERE-TO-GO TABLE        Y02080 07050002
         USING TCB,RET                                                  07100021
         USING UCBOB,RUCB                                               07200021
         USING CVT,RD                                                   07300021
         USING TIOENTRY,RTIOT                                           07400021
         USING DEBBASIC,RDEB                                     Y02134 07500002
*                                                                       07600021
         BALR  RBASE,0                  ESTABLISH BASE REGISTER         07700021
         USING *,RBASE                                                  07800021
         EJECT                                                          08400021
*                                                                     * 08500021
*                          FUNCTION PROLOG                            * 08600021
*                                                                     * 08700021
*********************************************************************** 08800021
*                                                                     * 08900021
* FUNCTION NAME -                                                     * 09000021
*    CLOSE FINAL RESTORE SYSTEM FUNCTION.                             * 09100021
*                                                                     * 09200021
* (STATUS) -                                                          * 09300021
*    NOT APPLICABLE                                                   * 09400021
*                                                                     * 09500021
* FUNCTION -                                                          * 09550000
*    RESTORE DCB TO ITS PRE-OPEN STATE IF THE DCB WAS MODIFIED BY OPEN* 09560000
*    DECREMENT DATA MANAGEMENT COUNT.                                 * 09570000
*                                                                     * 09900021
* ENTRY POINTS -                                                      * 10000021
*    ENTERED FROM THE FOLLOWING--                                     * 10100021
*    CLOSE FINAL RESTORE USER FUNCTION.                               * 10200021
*                                                                     * 10300021
* INPUT -                                                             * 10400021
*    A POINTER TO EACH OF THE FOLLOWING--                             * 10500021
*       CURRENT PARAMETER LIST ENTRY- RPARC                           * 10600021
*       DD ENTRY IN THE TIOT- RTIOT                                   * 10700021
*       WTG TABLE- RWTG                                               * 10800021
*       CURRENT WTG TABLE ENTRY- RWTGC                                * 10900021
*       DCB- RDCB                                                     * 11000021
*       WORK AREA- RCORE                                              * 11100021
*       RESIDENT ROUTINE- RES                                         * 11200021
*       UCB- RUCB                                                     * 11300021
*       DEB- RDEB                                                     * 11400021
*                                                                     * 11500021
* OUTPUT -                                                            * 11600021
*    DATA MANAGEMENT COUNT DECREMENTED BY ONE.                        * 11700021
*    DEB PAGE FREED IF IT HAD BEEN PAGE FIXED                         * 11750002
*    DEB REMOVED FROM THE DEB CHAIN.                                  * 11800021
*    DCB RESTORED TO ITS PRE-OPEN STATE.                              * 11900021
*                                                                     * 12000021
* EXTERNAL REFERENCES -                                               * 12100021
*    REFER TO THE PRECEEDING MODULE PROLOG.                           * 12200021
*                                                                     * 12300021
* EXITS, NORMAL -                                                     * 12400021
*    REFER TO THE PRECEEDING MODULE PROLOG.                           * 12500021
*    CLOSE FINAL TERMINATION FUNCTION.                                * 12600021
*                                                                     * 12700021
* EXITS, ERROR -                                                      * 12800021
*    REFER TO THE PRECEEDING MODULE PROLOG.                           * 12900021
*                                                                     * 13000021
* TABLES/WORK AREAS -                                                 * 13100021
*    THE OPEN, CLOSE, OR EOV WORK AREA AND THE WHERE-TO-GO (WTG)      * 13200021
*    TABLE ARE DESCRIBED BY THE DSECTS AT THE END OF THE LISTING.     * 13300021
*                                                                     * 13400021
* ATTRIBUTES -                                                        * 13500021
*    REFER TO THE PRECEEDING MODULE PROLOG.                           * 13600021
*                                                                     * 13700021
* CHARACTER CODE DEPENDENCY -                                         * 13800021
*    REFER TO THE PRECEEDING MODULE PROLOG.                           * 13900021
*                                                                     * 14000021
* NOTES -                                                             * 14100021
*    NOT APPLICABLE                                                   * 14200021
*                                                                     * 14300021
*********************************************************************** 14400021
         EJECT                                                          14500021
*********************************************************************** 14550002
*                                                                     * 29400021
*                          FUNCTION PROLOG                            * 29500021
*                                                                     * 29600021
*********************************************************************** 29700021
*                                                                     * 29800021
* FUNCTION NAME -                                                     * 29900021
*    CLOSE FINAL TERMINATION FUNCTION.                                * 30000021
*                                                                     * 30100021
* (STATUS) -                                                          * 30200021
*    NOT APPLICABLE                                                   * 30300021
*                                                                     * 30400021
* FUNCTION -                                                          * 30500021
*    REMOVE DEB FROM THE DEB CHAIN.                                   * 30600021
*    INTERFACE WITH TRACE TERMINATION FACILITY.                       * 30700021
*    FREE STORAGE FOR IRB, DEB, WORKAREA AND ECBLIST.                 * 30800021
*    DECREMENT DSAB OPEN COUNT IN DSABOPCT IN CURRENT DSAB       Y02134 30801002
*      AND IN ALL SUBSEQUENT CONCATENATED DSABS IF ISAM OR IF    Y02134 30802002
*      BPAM OPEN FOR INPUT OR UPDATE                             Y02134 30803002
*    DELETE RESIDENT ROUTINE.                                         * 30900021
*    RELEASE WTG TABLE.                                               * 31000021
*    EXIT TO CALLING PROGRAM OR INITIAL LOAD OF OPEN IF CONCATENATION * 31100021
*    OF UNLIKE ATTRIBUTES IS SPECIFIED.                               * 31200021
*                                                                     * 31300021
* ENTRY POINTS -                                                      * 31400021
*    ENTERED FROM THE FOLLOWING--                                     * 31500021
*    CLOSE FINAL RESTORE SYSTEM FUNCTION.                             * 31600021
*                                                                     * 31700021
* INPUT -                                                             * 31800021
*    A POINTER TO EACH OF THE FOLLOWING--                             * 31900021
*       CURRENT PARAMETER LIST ENTRY- RPARC                           * 32000021
*       DD ENTRY IN THE TIOT- RTIOT                                   * 32100021
*       WTG TABLE- RWTG                                               * 32200021
*       CURRENT WTG TABLE ENTRY- RWTGC                                * 32300021
*       DCB- RDCB                                                     * 32400021
*       WORK AREA- RCORE                                              * 32500021
*       RESIDENT ROUTINE- RES                                         * 32600021
*       UCB- RUCB                                                     * 32700021
*       DEB- RDEB                                                     * 32800021
*                                                                     * 32900021
* OUTPUT -                                                            * 33000021
*    ALL STORAGE USED BY CLOSE RELEASED.                              * 33100021
*    RESIDENT ROUTINE DELETED.                                        * 33200021
*                                                                     * 33300021
* EXTERNAL REFERENCES -                                               * 33400021
*    REFER TO THE PRECEEDING MODULE PROLOG.                           * 33500021
*                                                                     * 33600021
* EXITS, NORMAL -                                                     * 33700021
*    REFER TO THE PRECEEDING MODULE PROLOG.                           * 33800021
*    CALLING PROGRAM.                                                 * 33900021
*    INITIAL LOAD OF OPEN.                                            * 34000021
*                                                                     * 34100021
* EXITS, ERROR -                                                      * 34200021
*    REFER TO THE PRECEEDING MODULE PROLOG.                           * 34300021
*                                                                     * 34400021
* TABLES/WORK AREAS -                                                 * 34500021
*    THE OPEN, CLOSE, OR EOV WORK AREA AND THE WHERE-TO-GO (WTG)      * 34600021
*    TABLE ARE DESCRIBED BY THE DSECTS AT THE END OF THE LISTING.     * 34700021
*                                                                     * 34800021
* ATTRIBUTES -                                                        * 34900021
*    REFER TO THE PRECEEDING MODULE PROLOG.                           * 35000021
*                                                                     * 35100021
* CHARACTER CODE DEPENDENCY -                                         * 35200021
*    REFER TO THE PRECEEDING MODULE PROLOG.                           * 35300021
*                                                                     * 35400021
* NOTES -                                                             * 35500021
*    NOT APPLICABLE                                                   * 35600021
*                                                                     * 35700021
*********************************************************************** 35800021
         EJECT                                                          35900021
         L     RD,CVTPTR                GET VECTOR TABLE ADDRESS M0528  35910021
         BAL   RF,CFN07300              BR TO SET UP TASK        M0528  35970021
*                                       PARAMETERS               M0528  35980021
CFN06100 EQU   *                                                        36000021
         TM    DCBMACRF,DCBMEXCP        EXCP ACCESS TYPE                36020000
         BO    CFN06120                 YES  CANNOT BE JES              36030000
         TM    DCBDSORG+K1,ACBDORGA     JES DATA CONTROL BLOCK          36040000
         BO    CFN06110                 BR IF YES, CHECK VTAM    Y02004 36050002
         TM    TIOELINK,TIOESYIN+TIOESYOT SPOOLED DCB            Y02120 36060002
         BZ    CFN06120                 BR IF NO TO UNHOOK DEB   Y02120 36070002
         B     CFN06690                 BR YES TO RESTORE DCB  @ZA02193 36072037
CFN06110 EQU   *                        ACB                      Y02004 36074002
         CLI   ACBAMETH-IFGACB(RDCB),ACBVTAM IS IT VTAM ACB      YM3011 36076002
         BE    CFN06700                 BR IF YES TO RESTORE ACB YM3011 36078002
CFN06120 EQU   *                                                        36078202
         L     RDEB,DCBDEBAD            DEB ADDRESS              YM5929 36078402
         LA    RF,DEBBASIC              DEB ADDRESS-HIGH BYTE 0  YM5929 36078602
         SH    RF,AVTOFSET              RF POINTS TO AVT IF IT   YM5929 36078802
*                                       IS PRESENT IN DEB PREFIX YM5929 36079002
         CLM   RF,B'0111',DEBAPPB       IS AVT IN DEB PREFIX     YM5929 36079202
         BNE   CFN06122                 BRANCH IF NO             YM5929 36079402
         USING DEBAVT,RF                                         YM5929 36079602
         TM    DEBSIOAB,X10             IS DEB PAGE FIXED        YM5929 36079802
         BZ    CFN06122                 BRANCH IF NO             YM5929 36080002
         XR    R1,R1                    ZERO FOR IC              YM5929 36080202
         IC    R1,DEBLNGTH              LENGTH OF DEB IN DWORDS  YM5929 36080402
         SLL   R1,K3                    LENGTH OF DEB            YM5929 36080602
         AR    RF,R1                    END OF DEB + 1           YM5929 36080802
         ICM   R1,B'0111',DEBAPPB       START OF PAGE FREE       YM5929 36081002
         PGFREE R,A=(1),EA=(15)         PAGE FREE DEB            YM5929 36081202
         L     RF,DEBAPPAD              DEB AVT ADDR             YM5929 36081402
         NI    DEBSIOAB,K255-X10        ZERO DEB FIXED BIT       YM5929 36081602
         DROP  RF                                                YM5929 36081802
CFN06122 EQU   *                        UNCHAIN DEB FROM TCB     YM5929 36082002
*                                                                       36082402
*   REMOVE DEB FROM DEB CHAIN                                           36082602
*                                                                       36082802
         L     RF,WTGPREFX              LOAD POINTER TO PREFIX   Y02080 36083002
         USING IECPREFX,RF              RF POINTS TO PREFIX      Y02080 36084002
         STM   R0,RF,IECREGSV+K8        SAVE 16 REGISTERS        Y02080 36086002
         MODESET EXTKEY=ZERO            MODESET KEY              Y02082 36086402
CFN06121 SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND, DISABLE          Y02080X36088002
               RELATED=(LOCAL,IFG0202K(CFN06170))                Y02080 36088402
         LTR   RD,RD                    TEST FOR ERROR           Y02080 36090402
         LM    R0,RF,IECREGSV+K8        RESTORE 16 REGISTERS     Y02080 36098402
         BNZ   CFN01706                 BRANCH IF ERROR          Y02080 36098802
         L     RDEB,DCBDEBAD            LOAD POINTER TO DEB      Y02080 36148802
CFN06125 EQU   *                        LOOP TCB/DEB DECHAIN     Y02082 36198802
         L     R1,DEBTCBAD              TCB ADDRESS FROM DEB     Y02080 36400002
         LA    R1,TCBDEB-TCB-(DEBDEBAD-DEBBASIC)(,R1) INITIALIZE Y02134 36500002
*                                    TO PROCESS FIRST DEB        Y02134 36510002
CFN06130 EQU   *                                                        36800021
         CLM   RDEB,K7,DEBDEBAD-DEBBASIC+K1(R1) COMPARE DEBS     Y02134 36850002
         BE    CFN06150                 BRANCH IF DEB IS FOUND   Y02080 36860002
         CLC   DEBDEBAD-DEBBASIC+K1(K3,R1),ZERO CHECK FOR END    Y02134 36870002
*                                       OF DEBS                  Y02134 36874002
         BE    CFN06170                 DEB IS NOT ON CHAIN      Y02080 36880002
         L     R1,DEBDEBAD-DEBBASIC(,R1) GET ADDR OF NEXT DEB    Y02134 37500002
         B     CFN06130                 BRANCH TO PROCESS NEXT DEB      37600021
CFN06150 EQU   *                                                        37900021
         LR    RC,RDEB                  GET DEB ADDRESS          Y02082 37901002
         L     RD,DEBDEBAD              PT TO NEXT DEB           Y02082 37902002
         ICM   RD,K8,DEBDEBAD-DEBBASIC(R1) PRIME HI ORDER BYTE   Y02082 37903002
         ICM   RC,K8,DEBDEBAD-DEBBASIC(R1) PRIME HI ORDER BYTE   Y02082 37903202
         CS    RC,RD,DEBDEBAD-DEBBASIC(R1) DECHAIN DEB           Y02082 37904002
         BNZ   CFN06125                 BR IF NOT SUCCESSFUL     Y02082 37905002
         MVI   DXATCLOS,DXATRDEB        DEB REMOVED FR DEB CHAIN Y02144 38214002
CFN06170 SETLOCK RELEASE,TYPE=LOCAL,    ENABLE                   Y02080X38250002
               RELATED=(LOCAL,IFG0202K(CFN06121))                Y02080 38300002
         MODESET EXTKEY=DATAMGT         RETURN TO DATA MGT KEY   Y02082 38310002
         LTR   RD,RD                    TEST FOR ERROR           Y02080 38350002
         LM    R0,RF,IECREGSV+K8        RESTORE 16 REGISTERS     Y02080 38360002
         BNZ   CFN01706                 BRANCH IF ERROR          Y02080 38370002
         EJECT                                                          38372002
*                                                                       38374002
*        DECREMENT DSAB OPEN COUNT IN CURRENT DSAB               Y02134 38378002
*        AND IN ALL CONCATENATED DSABS UNLESS THE CONCATENATION  Y02134 38381002
*        BIT IN DCBOFLGS IS ON, INDICATING AN UNLIKE ATTRIBUTES  Y02134 38384002
*        CONCATENATION                                           Y02134 38384602
*        CHAIN THROUGH CONCATENATED DSABS BOTH IN FORWARD AND    Y02134 38385202
*        BACKWARD DIRECTION                                      Y02134 38385802
*                                                                       38386002
         MVI   DXATCLOS,DXATSABS        START DECREMENTING OPEN  Y02144 38399102
*                                       COUNT IN DSAB(S)         Y02144 38401102
         L     RC,DXDSABAD              GET CURRENT DSAB         Y02134 38401202
         LTR   RC,RC                    IS THERE A DSAB          Y02134 38406402
         BZ    CFN06192                 BRANCH IF NO             Y02134 38411602
         USING DSAB,RC                                           Y02134 38416802
         TM    DCBOFLGS,DCBOCON         CONCATENATION TEST       Y02134 38422002
         BO    CFN06192                 BRANCH IF YES            Y02134 38427202
CFN06172 EQU   *                        NEXT DSAB                Y02134 38432402
         L     RD,DSABOPCT-K2           DSABOPCT 2ND HALFWORD    Y02134 38437602
CFN06174 EQU   *                        TRY AGAIN                Y02134 38442802
         MODESET EXTKEY=SCHED           ASSUME SCHEDULER KEY     Y02082 38444002
         LR    RET,RD                   SAVE FOR CS IN RD        Y02134 38448002
         SRDL  RET,K16                  SHIFT OPEN CT TO RF      Y02134 38453202
         SRA   RF,K16                   PROPOGATE SIGN FOR LTR   Y02134 38458402
         LTR   RF,RF                    MAKE SURE ITS POSITIVE   Y02134 38463602
         BNP   CFN06180                 BRANCH IF NO             Y02134 38468802
         BCTR  RF,R0                    DECREMENT BY ONE         Y02134 38474002
         SLL   RF,K16                   SHIFT TO HIGH 16 BITS    Y02134 38479202
         SLDL  RET,K16                  UPDATED FULLWORD IN RET  Y02134 38484402
         CS    RD,RET,DSABOPCT-K2       TRY TO SNEAK IT IN       Y02134 38489602
         BNE   CFN06174                 BR IF HAVE TO TRY AGAIN  Y02134 38494802
CFN06180 EQU   *                        NEGATIVE OPEN COUNT      Y02134 38505202
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY      Y02082 38505602
*        DECREMENT COUNT IN ALL DSABS WHOSE TIOT                 Y02134 38506002
*        ENTRIES HAVE BLANK DDNAMES                              Y02134 38510002
         L     RC,DSABFCHN              NEXT DSAB                Y02134 38514002
         LTR   RC,RC                    IS THERE A NEXT DSAB?    Y02134 38518002
         BZ    CFN06186                 BRANCH IF NO             Y02134 38522002
         L     RTIOT,DSABTIOT           GET TIOT ENTRY           Y02134 38526002
         CLI   TIOEDDNM,C' '            CONCATENATION?           Y02134 38530002
         BE    CFN06172                 GET NEXT DSAB            Y02134 38537002
CFN06186 EQU   *                        NO MORE DSAB'S           Y02134 38546002
         L     RTIOT,DXTIOTAD           RESTORE TIOT ADDRESS     Y02134 38550002
         L     RC,DXDSABAD              GET CURRENT DSAB         Y02134 38552002
CFN06188 EQU   *                        BACK UP DSAB CHAIN       Y02134 38554002
         CLI   TIOEDDNM,C' '            IS THIS TIOT ENTRY       Y02134 38556002
*                                       CONCATENATED?            Y02134 38558002
         BNE   CFN06192                 BR IF NO-DONT BACK UP    Y02134 38560002
         L     RC,DSABBCHN              GET PREVIOUS DSAB        Y02134 38562002
         L     RTIOT,DSABTIOT           GET TIOT ADDRESS         Y02134 38564002
         L     RET,DSABOPCT-K2          GET OPEN COUNT           Y02134 38566002
CFN06190 EQU   *                        TRY AGAIN                Y02134 38568002
         LR    RD,RET                   SAVE FOR CS              Y02134 38570002
         SRDL  RET,K16                  SHIFT COUNT TO RF        Y02134 38572002
         SRA   RF,K16                   PROPOGATE SIGN BIT       Y02134 38574002
         LTR   RF,RF                    MAKE SURE ITS POSITIVE   Y02134 38576002
         BNP   CFN06188                 BRANCH IF NO TO KEEP     Y02134 38578002
*                                       BACKING UP DSAB CHAIN    Y02134 38580002
         BCTR  RF,R0                    DECREMENT OPEN COUNT     Y02134 38582002
         SLL   RF,K16                   SHIFT TO HIGH 16 BITS    Y02134 38584002
         SLDL  RET,K16                  UPDATED FULLWORD IN RET  Y02134 38586002
         MODESET EXTKEY=SCHED           SCHEDULER KEY FOR DSAB   Y02082 38586402
         CS    RD,RET,DSABOPCT-K2       TRY TO SNEAK IT IN       Y02134 38588002
         MODESET EXTKEY=DATAMGT         RETURN TO DATA MGT KEY   Y02082 38588402
         BNE   CFN06190                 BR IF NEED TO TRY AGAIN  Y02134 38590002
         B     CFN06188                 KEEP BACKING UP CHAIN    Y02134 38592002
         EJECT                                                          38592402
CFN06192 EQU   *                        NO CONCATENATION         Y02134 38594002
         MVI   DXATCLOS,DXATSABF        FINISHED DECREMENTING    Y02144 38594102
*                                       OPEN COUNT IN DSAB(S)    Y02144 38594202
         L     RTIOT,DXTIOTAD           RESTORE TIOT ADDRESS     Y02134 38594402
         TM    DCBMACRF,DCBMEXCP        EXCP                            38601000
         BO    CFN06195                 YES  NORMAL PROCESSING          38601500
         TM    DCBDSORG+K1,ACBDORGA     JES CONTROL BLOCK               38602000
         BO    CFN06010                 BR IF YES TO RESTORE ACB Y02102 38602402
*                                       MUST BE SPOOLED ACB      Y02120 38604402
CFN06195 EQU   *                                                        38611602
         LTR   RUCB,RUCB                DUMMY DATA SET           M0528  38617202
         BZ    CFN01800                 YES                      M0528  38620002
         TM    DXATEOV,DXATNVOL         DM CT ALREADY REDUCED    YM6559 38620502
         BO    CFN01800                 BRANCH IF YES            YM6559 38621002
         TM    UCBTBYT3,UCB3TAPE+UCB3DACC DA OR TAPE             YM6559 38621502
         BZ    CFN01800                 BRANCH IF NOT            YM6559 38622002
         SPACE 1                                                 M0528  38622802
*        DECREMENT DATA MANAGEMENT COUNT USING THE DEB EXTENTS          38625602
*        1. IF NOT BPAM CONCATENATION DEB, EACH UCB WHOSE               38626102
*           ADDRESS IS IN AT LEAST ONE OF THE DEB'S EXTENTS             38626602
*           WILL HAVE ITS DATA MANAGEMENT COUNT DECREMENTED ONCE.       38627102
*        2. IF BPAM CONCATENATION, EACH CONCATENATED DATA SET           38627602
*           WILL HAVE THE UCB ON WHICH IT EXISTS DECREMENTED            38628102
*           ONCE.                                                       38628602
*                                                                       38629102
*        NOTE- THE DATA MANAGEMENT COUNT WILL NOT BE                    38656002
*        DECREMENTED IF IT IS ALREADY ZERO.                             38660002
*                                                                       38676002
         MVI   DXATCLOS,DXATDMS         START DECREMENTING DATA  Y02144 38695602
*                                       MANAGEMENT CNT IN UCB(S) Y02144 38696002
         XR    RET,RET                  ZERO FOR IC              YM6559 38696502
         IC    RET,DEBNMEXT             NUMBER OF EXTENTS        YM6559 38697002
         LA    RC,DEBSUCBA              FIRST EXTENT ADDRESS     YM6559 38697502
         TM    UCBTBYT3,UCB3DACC        DIRECT ACCESS            YM6559 38698002
         BZ    CFN01295                 BRANCH IF NO             YM6559 38698502
         TM    DEBOFLGS,DEBRERR         BPAM CONCATENATION       YM6559 38699002
         BO    CFN01280                 BRANCH IF YES            YM6559 38699502
CFN01250 EQU   *                        NON BPAM CONCAT. LOGIC   YM6559 38700002
         LA    RD,DEBBASIC-DEBAMTYP     OFFSET BACK TO DEBAMTYP  YM6559 38700502
         LA    RDEB,K0(,RDEB)           CLEAR FOR SR             YM6559 38701002
         SR    RDEB,RD                  RDEB POINTS TO AMTYP     YM6559 38701502
         CLC   ISAMDEBT,DEBAMTYP-DEBAMTYP(RDEB) ISAM DEB         YM6559 38702002
         BNE   CFN01255                 BRANCH IF NOT            YM6559 38702502
         LA    RC,K16(,RC)              INCREMENT PAST FIRST     YM6559 38703002
*                                       DUMMY ISAM EXTENT        YM6559 38703502
         BCTR  RET,0                    REDUCE NO. OF EXTS BY 1  YM6559 38704002
CFN01255 EQU   *                        LOOP FOR EACH UNIQUE UCB YM6559 38704502
         LTR   RET,RET                  ANY MORE EXTENTS         YM6559 38705002
         BZ    CFN01700                 BRANCH IF NOT            YM6559 38705502
         L     RUCB,K0(,RC)             UCB FROM NEXT EXTENT     YM6559 38706002
         LA    RUCB,K0(,RUCB)           CLEAR FOR LTR            YM6559 38706502
         LTR   RUCB,RUCB                IS IT ZERO               YM6559 38707002
         BZ    CFN01275                 BRANCH IF YES            YM6559 38707502
         LR    RD,RET                   SAVE NO. EXTENTS         YM6559 38708002
         LR    RDEB,RC                  SAVE CURRENT EXT. ADDR.  YM6559 38708502
CFN01260 EQU   *                        ZERO UCBS IN DEB = RUCB  YM6559 38709002
         CLM   RUCB,B'0111',K1(RDEB)    EXTENT HAS OUR UCB       YM6559 38710502
         BNE   CFN01265                 BRANCH IF NOT            YM6559 38711002
         XC    K0(K4,RDEB),K0(RDEB)     ZERO UCB ADDR IN EXTENT  YM6559 38711502
CFN01265 EQU   *                        GET NEXT EXTENT          YM6559 38712002
         LA    RDEB,K16(,RDEB)          GET NEXT EXTENT          YM6559 38712502
         BCT   RD,CFN01260              PROCESS NEXT EXTENT      YM6559 38713002
CFN01270 EQU   *                        DECR. RUCB'S D.M. COUNT  YM6559 38713502
         BAL   RTIOT,CFN01300           DECR DM COUNT            YM6559 38714002
CFN01275 EQU   *                        PROCESS NEXT EXTENT      YM6559 38714502
         LA    RC,K16(,RC)              INCREMENT TO NEXT EXTENT YM6559 38715002
         BCT   RET,CFN01255             TRY NEXT EXTENT          YM6559 38715502
         B     CFN01700                 FINISHED                 YM6559 38716002
         SPACE 2                                                        38716502
CFN01280 EQU   *                        BPAM CONCAT. DEB         YM6559 38717002
         SLL   RET,K4                   SIZE OF EXTENTS          YM6559 38717502
         LA    RET,K0(RC,RET)           RET POINTS TO EXTENT     YM6559 38718002
*                                       NUMBERS AT END OF DEB    YM6559 38718502
         SR    RD,RD                    ZERO FOR IC              YM6559 38719002
         IC    RD,DEBAMLNG              NUMBER OF EXTENT NOS.    YM6559 38719502
         LA    RD,K1(,RD)               NUMBER OF DATASETS       YM6559 38720002
CFN01285 EQU   *                        LOOP FOR EACH DATA SET   YM6559 38720502
         CLM   RD,K1,DEBAMLNG           ARE WE ON EXTENT 0       YM6559 38721002
         LA    RF,K0(,0)                INIT EXTENT TO 0         YM6559 38721502
         BH    CFN01290                 BR IF EXTENT 0           YM6559 38722002
         IC    RF,K0(RET)               GET EXTENT NUMBER        YM6559 38722502
         SLL   RF,K4                    EXTNO TIMES 16           YM6559 38723002
         LA    RET,K1(,RET)             INCREMENT EXTENT NO.     YM6559 38723502
*                                       ADDR TO NEXT EXT. NO.    YM6559 38724002
CFN01290 EQU   *                        ZERO UCBADDR & DECR DMCT YM6559 38724502
         LA    RTIOT,K0(RC,RF)          ADDR OF EXTENT           YM6559 38725002
         L     RUCB,K0(,RTIOT)          GET UCB ADDR             YM6559 38725502
         XC    K0(K4,RTIOT),K0(RTIOT)   ZERO UCB ADDR            YM6559 38726002
         BAL   RTIOT,CFN01300           DECR. D. M. COUNT        YM6559 38726502
         BCT   RD,CFN01285              GET NEXT DATA SET        YM6559 38727002
         B     CFN01700                 FINISHED BPAM CONCAT     YM6559 38727502
         SPACE 2                                                        38727602
CFN01295 EQU   *                        TAPE                     YM6559 38728002
         L     RUCB,K0(,RC)             GET UCB ADDR             YM6559 38728502
         XC    K0(K4,RC),K0(RC)         ZERO UCB ADDR IN DEB     YM6559 38729002
         LA    RTIOT,CFN01700           FINISHED ADDR            YM6559 38729502
         SPACE 2                                                        38729602
CFN01300 EQU   *                        DECREMENT DATA           YM6559 38730002
*                                       MANAGEMENT COUNT         YM6559 38730502
         STM   RTIOT,RET,DXREG9         SAVE 9-14                YM6559 38731502
*                                                                Y02080 38778002
*        DECREMENT D M COUNT BY 1. REPLACE D M COUNT IN UCB      Y02080 38778402
*                                                                Y02080 38788402
         L     R0,UCB+(((UCBDMCT-UCB)/4)*4) LOAD WORD CONTAINING Y02080 38790402
*                                       BYTE TO BE MODIFIED      Y02080 38790702
         MODESET EXTKEY=ZERO            ASSUME KEY ZERO          YM6559 38790802
CFN01502 EQU   *                        DECREMENT DM COUNT       Y02132 38791002
         LR    R1,R0                    PREPARE RESET MOUNT BIT  YM6559 38791302
         L     RF,CONFF7F               GET MASK FOR MOUNT BIT   YM6559 38791602
         NR    R1,RF                    RESET MOUNT BIT IN REG   YM6559 38791902
         LR    RF,R0                    GET DATA MGT COUNT       Y02132 38794802
         SLL   RF,K25                   LEAVE ONLY DM COUNT      Y02132 38795002
         LTR   RF,RF                    TEST FOR COUNT OF ZERO   Y02132 38795202
         BZ    CFN01600                 BRANCH IF ZERO           Y02132 38795402
         SH    R1,ONE                   DECREMENT COUNT BY ONE   Y02132 38795902
CFN01600 EQU   *                        ZERO DM COUNT & MNT BIT  YM6559 38796202
         CS    R0,R1,UCB+(((UCBDMCT-UCB)/4)*4) TRY TO UPDATE     Y02080 38798502
         BNE   CFN01502                 IF NO, DO IT AGAIN       Y02080 38802502
*                                                                Y02132 38806702
*        IF DMCOUNT = 0 AND VIO UCB, ISSUE WICLOSE               Y02132 38806902
*                                                                Y02132 38807102
         TM    UCBJBNR,UCBVRDEV         TEST FOR VIO UCB         Y02132 38807302
         BNO   CFN01650                 BR IF NOT                Y02132 38807502
         TM    UCBDMCT,K255-UCBMOUNT    TEST COUNT FOR 0         Y02132 38807702
         BNZ   CFN01650                 BR IF NOT                Y02132 38807902
*        OBTAIN LOCAL LOCK -- FOR WICLOSE                        YM7363 38808202
*        TO BE RELEASED IN THIS MODULE                           YM7363 38808502
*                                                                YM7363 38808802
         MODESET EXTKEY=ZERO            ASSUME KEY ZERO          YM7363 38809102
         L     RF,WTGPREFX              LOAD PREFIX POINTER      YM7363 38809402
         USING IECPREFX,RF              PREFIX ADDRESSABILITY    YM7363 38809702
         STM   RD,RC,IECREGSV+K8        SAVE REGS 13 - 12        YM7363 38810002
CFN01610 SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                  YM7363*38810302
               RELATED=(LOCAL,IFG0202K(CFN01630)) GET LOCAL LOCK YM7363 38810602
         LM    RET,RC,IECREGSV+K12      RESTORE REGS 14 - 12     YM7363 38810902
         LTR   RD,RD                    TEST RETURN CODE         YM7363 38811502
         BNZ   CFN01706                 GO TO ERROR ROUTINE      YM7363 38811802
         LA    R1,VDSUCB-VDSCB(,RUCB)   GET ADDR OF VDSCB        Y02132 38816202
         LA    RD,IECREGSV              POINTER TO SAVE AREA     YM7363 38819402
         WICLOSE VDSCB=(1)              ISSUE VIO CLOSE          Y02132 38825802
*                                                                YM7363 38825902
*        RELEASE LOCAL LOCK -- OBTAINED IN THIS MODULE           YM7363 38826002
*                                                                YM7363 38826102
         L     RF,WTGPREFX              LOAD PREFIX POINTER      YM7363 38826302
         STM   RD,RC,IECREGSV+K8        SAVE REGS 13 - 12        YM7363 38826502
CFN01630 SETLOCK RELEASE,TYPE=LOCAL,                             YM7363*38826602
               RELATED=(LOCAL,IFG0202K(CFN01610)) RELEASE LOCK   YM7363 38826702
         LTR   RD,RD                    TEST RETURN CODE         YM7363 38826802
         LM    RD,RC,IECREGSV+K8        RESTORE REGS 13-12       YM7363 38826902
         BNZ   CFN01706                 YES ERROR, BRANCH        YM7363 38827002
CFN01650 EQU   *                        RETURN FROM ROUTINE      YM6559 38827102
         MODESET EXTKEY=DATAMGT         RETURN TO D.M. KEY       YM6559 38827202
         LM    RTIOT,RET,DXREG9         RESTORE 9-14             YM7334 38827502
         BR    RTIOT                    RETURN                   YM6559 38827602
         DROP  RF                                                YM7363 38827902
         SPACE 2                                                        38828202
CFN01700 EQU   *                                                 M0528  38880202
         MVI   DXATCLOS,DXATDMF         FINISHED DECREMENTING    Y02144 38883402
*                                       DATA MANAGEMENT COUNT(S) Y02144 38886602
         L     RDEB,DCBDEBAD            RESTORE DEB ADDR         YM6559 38887102
         L     RTIOT,DXTIOTAD           RESTORE TO CURRENT TIOT  Y02134 38893002
*                                       ENTRY                    Y02134 38896202
         L     RUCB,DXUCBADR            RESTORE TO CURRENT UCB   YM2381 38898202
         LA    RUCB,K0(,RUCB)           ZERO HIGH ORDER BYTE     YM2381 38898602
         B     CFN01800                 BRANCH AROUND ERROR RTN  YM7363 38898902
*                                                                Y02080 39018402
*         SETLOCK ERROR ROUTINE                                  Y02080 39036102
*                                                                Y02080 39053802
CFN01706 EQU   *                        SETLOCK ERROR            Y02082 39063802
         MODESET EXTKEY=DATAMGT         RETURN TO DATA MGT KEY   Y02082 39065802
         DMABCOND PCK,SETLOCK           SETLOCK ERROR            Y02132 39071502
*                                                                Y02080 39089202
         EJECT                                                          39116902
*                                                                       39124602
*  RESTORE MERGED FIELDS TO PRE-OPEN STATUS                      Y02120 39142302
*                                                                       39160002
CFN06010 EQU   *                        RESTORE MERGED FIELDS    Y02080 39177702
         BAL   RF,CFN07300              BRANCH TO RESTORE REGS   Y02080 39195402
         TM    DEBOFLGS,MODACB          WAS ACB MODIFIED                39213102
         BZ    CFN06030                 NO, SKIP ACB RESTORE            39230802
         L     RC,DXDEBXAD              GET DEB EXTENSION ADDR   Y02120 39240802
         USING DEBXTN,RC                                         Y02120 39250802
         LA    RF,DEBXDCBM              POINT RF TO MODIFICATION Y02120 39260802
*                                       MASK                     Y02120 39270802
         DROP  RC                                                Y02120 39280802
         USING IFGACB,RDCB              USING FOR ACB                   39301602
         TM    K2(RC),K16               WAS BLKSIZE MODIFIED            39319302
         BZ    CFN06020                 NO, DO NOT RESTORE              39337002
         XC    ACBBLKSZ,ACBBLKSZ        YES, ZERO BLKSIZE               39354702
CFN06020 TM    K3(RC),K22               WAS LRECL MODIFIED              39372402
         BZ    CFN06030                 NO, DO NOT RESTORE              39390102
         XC    ACBLRECL,ACBLRECL        YES, ZERO LRECL                 39407802
         USING IHADCB,RDCB              USING FOR DCB                   39425502
CFN06030 EQU   *                        END OF ACB MODIFICATION         39443202
         EJECT                                                          39478602
CFN01800 EQU   *                                                 M0528  39496302
         L     R1,DCBDEBAD              DEB ADDRESS                     42300021
         TM    TIOELINK,TIOESYIN+TIOESYOT SPOOLED ACB            Y02120 42390002
         BNZ   CFN06600                 BRANCH IF YES-NO IRB OR  Y02120 42392002
*                                       RELATED REQUEST QUEUE    Y02120 42394002
         L     R1,DEBIRBAD-DEBBASIC(R1) LOAD IRB ADDRESS         Y02134 42400002
         LA    R1,0(R1)                 CLEAR HI ORDER BYTE             42500021
         LTR   R1,R1                    IS THERE AN IRB                 42600021
         BZ    CFN06550                 BRANCH IS THERE ISN'T    Y02080 42700002
         TM    RBSTAB2-RBSECT(R1),RBFACTV  IS IRB BUSY           A36405 42730021
         BO    CFN06550                 BRANCH IF YES            Y02080 42760002
         LH    R0,RBSIZE-RBSECT(R1)     SIZE OF IRB              Y02080 42860002
         SLL   R0,K3                    IRB SIZE IN BYTES        Y02080 42910002
         LA    RF,RBPRFLNA              GET LENGTH OF IRB PREFIX Y02080 42960002
         SR    R1,RF                    POINT TO IRB PREFIX      Y02080 43110002
*                                       FREE IRB                 Y02080 43130002
         IECRES FREE,A=(1),PREFIX=NO,STM=(0,14,WTGPREFX),SP=253,       *43160002
               LV=(R0),KEY=0            FREE IRB                 Y02134 43210002
         EJECT                                                          43212002
CFN06550 EQU   *                        IRB BUSY                 Y02080 43220002
         MVI   DXATCLOS,DXATIRB         IRB (IF ANY) HANDLED     Y02144 43230002
         L     R1,DCBDEBAD              DEB ADDRESS              Y02080 43264002
         L     R1,DEBECBAD-DEBBASIC(R1) RELATED REQUEST QUE PTR  Y02134 43314502
         LA    R1,0(R1)                 CLEAR HI ORDER BYTE      Y02080 43314602
         LTR   R1,R1                    RELATED REQUEST QUE ZERO Y02080 43314702
         BZ    CFN06600                 BRANCH IS ZERO           Y02080 43314802
         TM    UCBTBYT3,UCB3UREC        UNIT RECORD DEVICE       YM7233 43315102
         BZ    CFN06570                 BRANCH IF NOT            YM7233 43315402
*                                                                       43315702
*        ENSURE NO DEB ON CURRENT TCB DEB CHAIN HAS SAME         YM7233 43316002
*        RELATED REQUEST QUEUE POINTER.                          YM7233 43316302
*        ONLY WITH 3505/3525 ASSOCIATED DATA SETS SHOULD THIS    YM7233 43316602
*        OCCUR.                                                  YM7233 43316902
*                                                                       43317202
         L     RF,WTGPREFX              PREFIX ADDRESS           YM7233 43317502
         STM   RDEB,RET,IECREGSV-IECPREFX(RF) SAVE SETLOCK REGS  YM7233 43317802
         MODESET EXTKEY=SUPR            SETLOCK KEY              YM7233 43317902
*                                                                       43318102
*        LOCAL LOCK SERIALIZES TCB DEB CHAIN                     YM7233 43318202
*                                                                       43318302
CFN06555 SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                  YM7233*43318402
               RELATED=(LOCAL,IFG0202K(CFN06568)) GET LOCK       YM7233 43318702
         MODESET EXTKEY=DATAMGT         RETURN TO OUR KEY        YM7233 43319002
         LM    RDEB,RET,IECREGSV-IECPREFX(RF) RESTORE REGS       YM7233 43319302
         L     RF,DXTCBADR              TCB ADDRESS IN RF        YM7233 43323202
         LA    RF,(TCBDEB-TCB)-(DEBDEBAD-DEBBASIC)(RF) INIT'LIZE YM7233 43323502
CFN06560 EQU   *                        CHECK ALL RRQS           YM7233 43323802
         ICM   RF,B'0111',DEBDEBB-DEBBASIC(RF) NEXT DEB          YM7233 43324102
         BZ    CFN06566                 NO MORE DEBS-FREE RRQ    YM7233 43324402
         CLM   R1,B'0111',DEBECBB-DEBBASIC(RF) IS RRQ SAME       YM7233 43324702
         BNE   CFN06560                 BR IF NO-TRY NEXT DEB    YM7233 43325002
         XR    R1,R1                    DO NOT FREE RRQ          YM7233 43325302
CFN06566 EQU   *                        RELEASE LOCK             YM7233 43325602
         L     RF,WTGPREFX              PREFIX ADDRESS           YM7233 43325902
         STM   RDEB,RET,IECREGSV-IECPREFX(RF) SAVE SETLOCK REGS  YM7233 43326202
         MODESET EXTKEY=SUPR            SETLOCK KEY              YM7233 43326502
CFN06568 SETLOCK RELEASE,TYPE=LOCAL,                             YM7233*43326802
               RELATED=(LOCAL,IFG0202K(CFN06555)) RELEASE LOCK   YM7233 43327102
         MODESET EXTKEY=DATAMGT         RETURN TO OUR KEY        YM7233 43327402
         LM    RDEB,RET,IECREGSV-IECPREFX(RF) RESTORE LOCK REGS  YM7233 43327702
         LTR   R1,R1                    DO WE FREE RRQ           YM7233 43328002
         BZ    CFN06600                 BRANCH IF NO             YM7233 43328302
CFN06570 EQU   *                        FREE RRQ                 YM7233 43332302
*                                       FREE RELATED REQUEST QUE Y02080 43332602
         IECRES FREE,A=(1),PREFIX=NO,STM=(0,14,WTGPREFX),SP=254,       *43332902
               LV=K8,KEY=0              FREE RELATED REQ QUEUE   Y02134 43333202
         EJECT                                                          43333502
CFN06600 EQU   *                        SPOOLED ACB              Y02080 43333802
         MVI   DXATCLOS,DXATRRQ         RELATED REQUEST Q DONE   Y02144 43342002
         L     R1,DCBDEBAD              LOAD DEB ADDRESS         Y02080 43368202
         LA    R1,K0(,R1)               CLEAR HIGH BYTE          Y02120 43370202
         LA    RF,K4                    DISP OF DEB LENGTH       Y02080 43378202
         SR    R1,RF                    POINT TO DEB LENGTH      Y02080 43380202
         SR    R0,R0                    CLEAR R0 FOR IC INST     Y02080 43380602
         IC    R0,0(R1)                 DEB LENGTH IN DOUBLE WDS Y02080 43381002
         LA    R1,K4(R1)                POINT BACK TO DEB        Y02080 43400802
         LA    RF,K8                    LENGTH OF ACB DEB PREFIX Y02080 43410802
         TM    TIOELINK,TIOESYIN+TIOESYOT SPOOLED ACB            Y02120 43412802
         BNZ   CFN06601                 YES, BRANCH             YA03025 43414802
         LA    RF,K36                   LENGTH OF DCB DEB PREFIX Y02080 43421302
CFN06601 EQU   *                        SPOOLED ACB             YA03025 43423102
         SR    R1,RF                    FIND ADDR OF DEB PREFIX  Y02080 43424902
         SLL   R0,K3                    DEB SIZE IN BYTES        Y02080 43426702
         TM    DCBMACRF,DCBMEXCP        TEST FOR EXCP            Y02004 43428302
         BO    CFN06602                 YES, CANNOT BE ACB      YA03025 43428402
         TM    DCBDSRG2,ACBDORGA        IS CONTROL BLOCK AN ACB? Y02004 43428702
         BO    CFN06608                 BR IF YES, NO DEVICE     Y02120 43429102
*                                       TYPE FIELDS-FREE DEB     Y02120 43439102
         LTR   RUCB,RUCB                TEST FOR DUMMY           Y02080 43448002
         BZ    CFN06607                 BRANCH IF DUMMY          Y02080 43451802
CFN06602 EQU   *                        TEST DEVICE TYPE        YA03025 43462302
* ZERO OUT DEVT AND DVTBL FIELDS FOR D.A. DCB'S HERE             Y02080 43474602
*                                                                Y02080 43478402
         TM    UCBTBYT3,UCB3DACC        IS IT DIRECT ACCESS      Y02080 43482202
         BNO   CFN06606                 NO, CONTINUE USUAL RTN   Y02080 43486002
         TM    DCBMACRF,DCBMEXCP        IS IT EXCP              YA03025 43486102
         BNO   CFN06603                 NO, GO TEST DSORG       YA03025 43486202
         TM    DCBMACRF+K1,DCBMDI1W     EXCP AND 1 WORD DI?     YA03025 43486302
         BO    CFN06605                 YES BRANCH              YA03025 43487102
*    CHECK FOR 3,4, OR 5 WORD DEVICE INTERFACE WITH EXCP        YA03025 43487502
         TM    DCBMACRF+K1,DCBMDI5W+DCBMDI3W+DCBMDI4W           YA03025 43487902
         BZ    CFN06608                 NO DEVICE INTERFACE     YA03025 43488302
         B     CFN06604                 YES, ZERO DI FIELDS     YA03025 43488702
CFN06603 EQU   *                        TEST DSORG              YA03025 43488902
         TM    DCBDSORG,DCBORGIS+DCBORGDA  ISAM OR DIRECT?      YA03025 43490402
         BM    CFN06605                 NO DCBDVTBL IF ISAM/DA  YA03025 43491202
CFN06604 EQU   *                        DVTBL FIELD             YA03025 43491602
         XC    DCBDVTBL+K1(K3),DCBDVTBL+K1  CLEAR DVTBL FIELD   YA03025 43492002
CFN06605 EQU   *                        CLEAR DEVT FIELD        YA03025 43492802
         MVI   DCBDEVT,K0               CLEAR DEVT FIELD         Y02080 43493602
         XC    DCBTRBAL(K2),DCBTRBAL    CLEAR TRACK BALANCE     XA02424 43495602
         B     CFN06608                 GO FREE DEB             YA03025 43496002
CFN06606 EQU   *                        TEST FOR TP              Y02080 43497402
         TM    DCBDSORG,DCBORGMQ        QTAM DUMMY               Y02080 43501202
         BZ    CFN06608                 BRANCH IF NO             Y02080 43505002
CFN06607 EQU   *                        DUMMY                    Y02080 43508802
         TM    DCBMACRF,DCBMEXCP        EXCP?                  @ZA02201 43509237
         BZ    CFN06611                 NO, CONTINUE           @ZA02201 43509637
         TM    DCBMACRF,DCBMCOM         COMMON SECTION PRESENT?@ZA02201 43510037
         BZ    CFN06609                 NO, ASSUME PS          @ZA02201 43510437
CFN06611 EQU   *                                               @ZA02201 43510537
         NC    DCBDSORG,DCBDSORG        ANY DSORG?             @ZA02201 43510837
         BZ    CFN06609                 NO, ASSUME PS          @ZA02201 43511237
         TM    DCBDSORG,DCBORGPS+DCBORGMQ  QTAM OR TCAM DUMMY    Y02080 43512602
         BNM   CFN06608                 BR IF NO                 Y02080 43516402
         TM    TIOELINK,TIOTTERM        IS THIS TSO              Y02080 43520202
         BO    CFN06608                 BRANCH IF YES            Y02080 43524002
CFN06609 EQU   *                                               @ZA02201 43526037
         LA    R1,K20(,R1)              POINT TO DEB ORIGIN      Y02080 43527802
CFN06608 EQU   *                        FREE DEB                 Y02080 43531602
*                                       FREE DEB                 Y02080 43539202
         IECRES FREE,LV=(R0),A=(R1),KEY=5,SP=230,PREFIX=NO,      Y02080C43543002
               STM=(0,14,WTGPREFX)                               Y02080 43546802
         EJECT                                                          43548802
         MVI   DXATCLOS,DXATDEB         DEB CORE FREED           Y02144 43556402
         L     R1,DXDEBXAD              GET DEB EXTENSION ADDR   Y02134 43556802
         LTR   R1,R1                    TEST FOR DEB EXTENSION @ZA02193 43556937
         BZ    CFN06690                 BRANCH IF NO DEBX      @ZA02193 43557037
         XC    DXDEBXAD,DXDEBXAD        CLEAR DEBX PTR         @ZA02193 43557237
         USING DEBXTN,R1                                         Y02134 43558202
         L     RD,DEBXOPNJ              LOAD OPENJ ALLOC PTR   @ZA12942 43560237
         LH    R0,DEBXLNGH              GET DEB EXTENSION LENGTH Y02134 43562002
         IECRES FREE,LV=(0),A=(1),KEY=5,SP=230,PREFIX=NO,        Y02134*43565802
               STM=(2,14,WTGPREFX)      FREE DEB EXTENSION       Y02134 43569602
         EJECT                                                          43570037
*                                                                       43571637
*********************************************************************** 43572037
*                                                                       43572437
*        SET UP PARMLIST FOR SVC 99 DYNAMIC ALLOCATION                  43573637
*                                                                       43574037
*        DYNAMICALLY UNALLOCATE DDNAME ALLOCATED BY OPEN TYPE=J         43574437
*        WITH INHIBIT JFCB UPDATE                                       43574837
*                                                                       43575637
*********************************************************************** 43576037
*                                                                       43576437
         LTR   RD,RD                    TEST FOR OPENJ ALLOC   @ZA02193 43576837
         BZ    CFN06690                 BRANCH IF NONE         @ZA02193 43577237
         XC    DXXCTL(OPNJDLEN),DXXCTL  CLEAR PARM LIST        @ZA02193 43577637
         XC    DXCCW1(TEXTLEN),DXCCW1   CLEAR TEXT UNITS       @ZA02193 43578037
         LA    R1,DXXCTL                PARM LIST              @ZA02193 43578437
         USING OPNJDYNA,R1              R1 PTR TO PARM WORD    @ZA02193 43578837
         LA    RF,PARMS                 POINT TO PARM LIST     @ZA02193 43579237
         ST    RF,DAPTR                 R1 -> DAPTR -> PARMS   @ZA02193 43579337
         OI    DAPTR,LASTNTRY           LAST IN LIST           @ZA02193 43579437
         MVC   PARMS(L'DYNPRM1),DYNPRM1 SET UP LIST            @ZA02193 43579537
         LA    RF,DXCCW1                POINT TO TEXT UNITS    @ZA02193 43579637
         ST    RF,TXTPP                 TXTPP -> TEXT UNITS    @ZA02193 43580037
         MVI   FLAGS21,DYNEQU5          SET FLAGS              @ZA02193 43580437
*                                                                       43580637
         LA    R1,DXCCW1                POINT TO TEXT UNITS    @ZA02193 43580737
         USING TEXTUNIT,R1              TEXT UNIT POINTER      @ZA02193 43581237
         LA    RF,UNIT1                 POINT TO UNALLOC UNIT  @ZA02193 43581637
         ST    RF,TEXTU1                UNIT 1 POINTER         @ZA02193 43581737
         LA    RF,UNIT2                 POINT TO DDNAME UNIT   @ZA02193 43581837
         ST    RF,TEXTU2                UNIT 2 POINTER         @ZA02193 43581937
         OI    TEXTU2,LASTNTRY          IND LAST IN LIST       @ZA02193 43584337
*                                                                       43584737
*        SET UP TEXT UNITS                                              43585137
*                                                                       43585237
         MVC   UNIT1(L'DYNU1),DYNU1     UNALLOCATE APRMS       @ZA02193 43585337
         MVC   UNIT2(L'DYNU2),DYNU2     DDNAME PARMS           @ZA02193 43585637
*                                                                       43586037
         L     RD,DSABTIOT-DSAB(,RD)    GET TIOT PTR           @ZA02193 43586437
         MVC   U2PRM,TIOEDDNM-TIOENTRY(RD) MOVE IN DDNAME      @ZA02193 43587637
*                                                                       43589137
*        GET NUMBER OF NON-BLANK CHARACTERS IN DDNAME NAME              43589237
*                                                                       43589337
         LA    RC,U2PRM+L'TIOEDDNM-K1   LAST BYTE OF DDNAME    @ZA02193 43589537
CFN06620 EQU   *                        SEARCH FOR NON-BLANK   @ZA02193 43589637
         CLI   K0(RC),C' '              IS THIS ONE BLANK      @ZA02193 43589737
         BNE   CFN06630                 BR IF NO TO COMPUTE    @ZA02193 43589937
*                                       LENGTH OF NAME         @ZA02193 43590037
         BCT   RC,CFN06620              TRY NEXT BYTE          @ZA02193 43590137
CFN06630 EQU   *                        CALCULATE LENGTH       @ZA02193 43590337
         LA    RF,U2PRM-K1              BYTE PRECEDING DDNAME  @ZA02193 43590437
         SR    RC,RF                    RC HAS LENGTH          @ZA13790 43590537
         LTR   RC,RC                    TEST NO DDNAME         @ZA13790 43590637
         BZ    CFN06640                 BRANCH IF BLANKS       @ZA02193 43590737
         STH   RC,U2LEN                 STORE DDNAME LENGTH    @ZA02193 43590837
*                                                                       43590937
         DROP  R1                                                       43591037
         LA    R1,DXXCTL                DYN ALLOC PRM LIST     @ZA02193 43591137
         DYNALLOC                       CALL DYNAMIC ALLOC     @ZA02193 43591237
*                                                                       43591637
CFN06640 EQU   *                        CLEAR PARM LIST        @ZA02193 43592037
*                                                                       43592437
         XC    DXCCW1(TEXTLEN),DXCCW1   CLEAR PARMS            @ZA02193 43593237
         XC    DXXCTL(OPNJDLEN),DXXCTL  CLEAR PARM LIST        @ZA02193 43593637
         EJECT                                                          43595037
CFN06690 EQU   *                        RESTORE DCB/ACB        @ZA02193 43595237
         MVI   DXATCLOS,DXATDEBX        DEB EXTENSION CORE FREED Y02144 43595437
*        TURN OFF TRAILER SW,RD BKWD SW, OPEN BIT, TM READ BIT,  Y02120 43595637
*        AND BUSY BIT. LEAVE LOCK AND CONCATENATION BITS ON.     Y02120 43595837
         NI    DCBOFLGS,DCBOCON+DCBOUNLK+DCBOLOCK                Y02080 43596037
         BAL   RF,CFN07300              BRANCH TO SET TASK PERAMETER    43596202
         TM    TCBFLGS,TCBFA            IS ABEND BIT ON                 43600021
         BO    CFN06700                 BRANCH IF ABEND BIT IS ON       43700021
         TM    DCBOFLGS,DCBOCON         SEQTL CONCATENATION TEST        43800021
         BO    CFN07200                 BR IF SEQTL CONCATENATION       43900021
CFN06700 EQU   *                                                        44000021
*    VTAM ROUTINES USE 'DCBOBUSY' AND 'ACBERFLG' TO INDICATE     YM3011 44000102
*    SUCCESSFUL OR UNSUCCESSFUL CLOSE OF A VTAM ACB, AS FOLLOWS  YM3011 44005602
*        -BUSY BIT SET TO 0 BY VTAM INDICATES AN ERROR. THE OPEN YM3011 44007602
*         BIT AND 'ACBDDNAM' WILL NOT BE RESTORED.               YM3011 44009602
*        -BUSY BIT LEFT AT 1 AND 'ACBERFLG' NON-ZERO ALSO        YM3011 44011602
*         INDICATES AN ERROR. IN THIS CASE THE OPEN BIT WILL BE  YM3011 44011702
*         RESET TO ZERO AND 'ACBDDNAM' RESTORED.                 YM3011 44011802
*        -A SUCCESSFUL CLOSE OF A VTAM ACB WILL ALSO CAUSE A     YM3011 44011902
*         RESET OF 'ACBDDNAM' AND THE OPEN BIT.                  YM3011 44021802
*        -THE BUSY BIT IS RESET TO 0 FOR ALL OF THE ABOVE CASES  YM3011 44023802
*                                                                Y02004 44031702
* CHECK FOR VTAM ACB                                             Y02004 44041602
*                                                                Y02004 44051502
         TM    DCBMACRF,DCBMEXCP        TEST FOR EXCP            Y02004 44061402
         BO    CFN06750                 YES, CANNOT BE ACB       Y02004 44071302
         TM    DCBDSRG2,ACBDORGA        IS CONTROL BLOCK AN ACB? Y02004 44081202
         BZ    CFN06750                 NO, RESTORE DCB FIELDS   Y02004 44091102
         CLI   ACBAMETH-IFGACB(RDCB),ACBVTAM IS ACB FOR VTAM?    YM3011 44101002
         BNE   CFN06750                 BR IF NO                 Y02004 44110902
*    INSURE THAT VSAM BIT AND THE DELAYED ABEND BIT IN THE WORK  YM3011 44112902
*    AREA ARE SET TO 0. ALTHOUGH THESE ARE NOT USED BY VTAM,     YM3011 44114902
*    THEY WILL BE TESTED IN THE NEXT LOAD (IFG0202L) AND SHOULD  YM3011 44116902
*    BE 0 TO AVOID ERRONEOUS BRANCHES.                           YM3011 44118902
*                                                                YM3011 44119302
         NI    JFCDSRG2,X'FF'-JFCORGAM  ZERO VSAM BIT            YM3011 44119702
         NI    JFCBMASK+K4,X'FF'-JFCMABND  0 DELAYED ABEND BIT   YM3011 44120102
*    TEST THE BUSY BIT                                           YM3011 44120502
         TM    DCBOFLGS,DCBOBUSY        DID VTAM SET BUSY BIT 0  YM3011 44120802
         BNZ   CFN06720                 NO,  RESTORE ACB         YM3011 44130702
         NI    DCBOFLGS,DCBOPEN+DCBOLOCK  RESET ALL DCBOFLAGS    YM3011 44132702
*                                       EXCEPT OPEN AND LOCK BIT YM3011 44134702
         B     CFN07200                 GO TO NEXT LOAD          YM3011 44135102
CFN06720 EQU   *                        RESTORE ACB              YM3011 44136702
         MVI   DCBOFLGS,DCBOLOCK        RESTSORE OFLGS           Y02004 44140602
         MVC   DCBDDNAM,=X'FF00000000000000' RESTORE NAME        Y02004 44160402
         B     CFN07200                 GO TO NEXT LOAD          YM3011 44170302
CFN06750 EQU   *                        NOT ACB                  Y02004 44180202
         CLI   TIOEDDNM,BLANK           IS THIS NAME BLANKS             44190102
         BNE   CFN07100                 BR IF NAME NOT BLANK            44200021
         L     RF,DXDSABAD              GET DSAB ADDR            Y02134 44300002
         USING DSAB,RF                                           Y02134 44301002
CFN06800 EQU   *                        GET PREVIOUS DSAB        Y02134 44302002
         L     RTIOT,DSABTIOT           GET TIOT ADDR            Y02134 44303002
         CLI   TIOEDDNM,C' '            BLANK DDNAME?            Y02134 44304002
         BNE   CFN07100                 BRANCH IF NON-BLANK      Y02134 44305002
         L     RF,DSABBCHN              GET PREVIOUS DSAB        Y02134 44306002
         B     CFN06800                 TRY IT                   Y02134 44307002
CFN07100 EQU   *                                                        46200021
         MVC   DCBMACR,DCBMACRF         RESTORE MACRF                   46300021
         MVC   DCBIFLG,DCBIFLGS         RESTORE IFLGS                   46400021
         MVC   DCBDDNAM,TIOEDDNM        RESTORE DDNAME                  46500021
CFN07170 EQU   *                        TURN OFF IOS ERROR FLAGS Y02004 46501002
         NI    DCBIFLG,X'FF'-DCBIFPIO   SET OFF ERROR FLAGS IN DCB      46600021
CFN07200 EQU   *                                                        46700021
         SR    RET,RET                  SET UP FOR BRANCH TABLE         46800021
         IECRES LOAD,MODID=EXITMOD,BRCODE=(RET),BRANCH=QUEUED    Y02080 46950002
*                                       BRANCH TO XCTL           Y02080 46960002
         EJECT                                                          46970002
CFN07300 EQU   *                                                        47000021
         L     RD,CVTPTR                GET VECTOR TABLE ADDRESS        47100021
         L     RET,DXTCBADR             CURRENT TCB ADDR         Y02134 47200002
         L     RTIOT,DXTIOTAD           CURRENT TIOT ENTRY ADDR  Y02134 47201002
*                                                                       47600021
         L     RUCB,DXUCBADR            SRT-UCB ADDRESS          Y02134 47700002
         LA    RUCB,0(RUCB)             CLEAR HI-ORDER BYTE             47800021
         BR    RF                       BRANCH TO CALLER                47900021
         EJECT                                                          48383600
         SPACE 1                                                        48387700
**********************************************************************  48391800
*                                                                    *  48395900
*                    CONSTANTS                                       *  48400021
*                                                                    *  48500021
**********************************************************************  48600021
         SPACE 1                                                        48700021
TIOTSPOL EQU   X'06'                    SPOOL D.S. INDICATORS    Y02080 48702002
MODACB   EQU   X'08'                    MODIFIED ACB INDICATOR   Y02080 48704002
         DS    0F                       FULLWORD BOUNDARY        YM6559 48704237
CONFF7F  DC    X'FFFFFF7F'              CONST TO RESET MOUNT BIT YM6559 48704302
ISAMDEBT DEBCHK AM=ISAM,MF=L            ISAM DEBAMTYP            YM6559 48704502
ZERO     DC    X'00000000'              ZERO COMPARE FIELD       Y02080 48706002
ONE      DC    H'1'                     HALFWORD VALUE OF ONE    Y02132 48706202
AVTOFSET DC    AL2(DEBBASIC-DEBAVT)     OFFSET FROM DEB TO AVT   YM5929 48706402
BLANKS   DC    CL8' '                   BLANK DD NAME MODEL      M0528  48710000
         EJECT                                                          48710437
*                                                                       48712037
*********************************************************************** 48714037
*                                                                       48716037
*        DYNAMIC UNALLOCATION PARAMETERS                                48718037
*                                                                       48720037
*********************************************************************** 48722037
*                                                                       48724037
DYNPRM1  DS    0CL2                     SVC 99 PARMS           @ZA02193 48726037
         DC    AL1(S99RBEND-S99RB)      LENGTH OF PARMS        @ZA02193 48728037
         DC    AL1(S99VRBUN)            UNALLOCATE DDNAME      @ZA02193 48730037
         DS    0F                       ALIGN BOUNDRY          @ZA02193 48734037
DYNU1    DS    0CL4                     UNALLOCATE             @ZA02193 48738037
         DC    AL2(DUNUNALC)            UNALLOCATE FUNCTION    @ZA02193 48740037
         DC    AL2(K0)                  1 PARM                 @ZA13790 48742037
DYNU2    DS    0CL4                     UNALLOCATE DDNAME      @ZA02193 48744037
         DC    AL2(DUNDDNAM)            UNALLOC DDNAME FUNCTION@ZA02193 48746037
         DC    AL2(K1)                  1 PARM                 @ZA02193 48747237
         EJECT                                                          48748037
         XCTLTABL ID=(EXITMOD,2L,,0P),SVC=020,BRT=YES,LENGTH=    Y02080 55612002
         EJECT                                                          55614037
*                                                                       55616037
*********************************************************************** 55618037
*                                                                       55620037
*        DYNAMIC ALLOCATION MACROS AND WORKAREAS               @ZA02193 55622037
*                                                                       55624037
*********************************************************************** 55626037
*                                                                       55628037
         IEFZB4D0                       DYNAMIC ALLOC PARM LIST@ZA02193 55630037
         EJECT                                                          55632037
         IEFZB4D2                       DYNAMIC ALLOC KEYS     @ZA02193 55634037
         EJECT                                                          55636037
*                                                                       55638037
***************************************************************@ZA02193 55640037
*                                                              @ZA02193 55642037
*        DYNAMIC ALLOCATE PARMLIST FOR UNALLOCATION            @ZA02193 55644037
*                                                              @ZA02193 55646037
***************************************************************@ZA02193 55648037
*                                                              @ZA02193 55650037
OPNJDYNA DSECT                          ALLOCATION PARMS       @ZA02193 55652037
DAPTR    DS    A                        POINTER TO PARMS       @ZA02193 55654037
PARMS    DS    0A                       PARM LIST              @ZA02193 55656037
LENGTH   DC    AL1(S99RBEND-S99RB)      LENGTH OF LIST         @ZA02193 55658037
VERB     DC    AL1(S99VRBUN)            ALLOCATE DSNAME        @ZA02193 55660037
FLAGS1   DS    0AL2                     FLAG BYTES 1           @ZA02193 55660437
FLAGS11  DC    AL1(0)                   NO PARMS               @ZA02193 55660837
FLAGS12  DC    AL1(0)                   RESERVED               @ZA02193 55661237
ERRCODE  DS    AL2                      ERROR RETURN CODE      @ZA02193 55661637
INFOCODE DS    AL2                      INFORMATION CODE       @ZA02193 55661737
TXTPP    DS    A                        TEXT POINTER           @ZA02193 55661837
         DS    F                        RESERVED FIELD         @ZA02193 55661937
FLAGS2   DS    0A                       FLAG BYTES 2           @ZA02193 55662237
DYNEQU1  EQU   S99WTVOL                 WAIT FOR VOLUMES       @ZA02193 55662637
DYNEQU2  EQU   S99WTDSN                 WAIT FOR DATA SETS     @ZA02193 55664637
DYNEQU3  EQU   S99WTUNT                 WAIT FOR UNITS         @ZA02193 55665037
DYNEQU4  EQU   S99OFFLN                 CONSIDER OFFLINE UNITS @ZA02193 55665437
DYNEQU5  EQU   S99TIONQ                 TIOT ENQD              @ZA02193 55665837
DYNEQU6  EQU   S99MOUNT                 MOUNTING PERMITED      @ZA02193 55666237
DYNEQU   EQU   DYNEQU1+DYNEQU2+DYNEQU3+DYNEQU4+DYNEQU5+DYNEQU6 @ZA02193 55666337
FLAGS21  DC    AL1(DYNEQU)              ALLOCATION REQUEST     @ZA02193 55666437
FLAGS22  DS    AL1                      RESERVED               @ZA02193 55666537
FLAGS23  DS    AL1                      RESERVED               @ZA02193 55667237
FLAGS24  DS    AL1                      RESERVED               @ZA02193 55667637
OPNJDEND DS    0F                       END OF PARM LIST       @ZA02193 55667737
OPNJDLEN EQU   OPNJDEND-OPNJDYNA        LENGTH OF ALLOC PARMS  @ZA02193 55667837
*                                                                       55668037
TEXTUNIT DSECT                          TEXT UNITS             @ZA02193 55668137
TEXTU1   DC    A(UNIT1)                 PTR TEXT UNIT 1        @ZA02193 55668237
TEXTU2   DC    AL1(LASTNTRY),AL3(UNIT2) PTR TEXT UNIT 2        @ZA02193 55671537
UNIT1    DS    0CL4                     UNALLOCATE UNIT        @ZA02193 55671637
U1KEY    DC    AL2(DUNUNALC)            UNALLOCATE FUNCTION    @ZA02193 55671737
U1NUM    DC    AL2(K0)                  NUMBER OF PARMS        @ZA02193 55671837
UNIT2    DS    0CL14                    DDNAME UNALLOC UNIT    @ZA02193 55671937
U2KEY    DC    AL2(DALRTDDN)            DDNAME UNALOC FUNCTION @ZA02193 55672037
U2NUM    DC    AL2(K1)                  NUMBER OF PARMS        @ZA02193 55672137
U2LEN    DC    AL2(L'TIOEDDNM)          LENGTH OF DDNAME       @ZA02193 55672237
U2PRM    DS    CL8                      PARM                   @ZA02193 55672937
TEXTEND  DS    0F                       END OF TEXT UNITS      @ZA02193 55674937
TEXTLEN  EQU   TEXTEND-TEXTUNIT         LENGTH OF TEXT         @ZA02193 55676937
         EJECT                                                          55683437
         IECDSECS CVT,TCB,TIOT,DCB,UCB,MAIN,WTG,RB,TSENQ,        Y02134*55683737
               ACB,PSA,PREFX,DSAB,IEZDEB,EXPAND=YES              Y02134 55685737
         IECEQU IEZDEB=YES                                       Y02134 55800002
         IDDVDSCB                                                Y02132 55850002
         END                                                            55900021
