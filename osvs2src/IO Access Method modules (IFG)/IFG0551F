         TITLE 'IFG0551F   EOV BASIC READ JFCB'                         00100021
IFG0551F CSECT                                                          00400021
*********************************************************************** 00500021
*                                                                     * 00600021
*                                                                     * 00660000
*          VS2 RELEASE 03 DELETIONS                                   * 00660400
*0000                                                          @ZA02187 00660500
*          VS2 RELEASE 02 DELETIONS                                   * 00660600
*                                                                       00660700
*                                                                       00710502
*********************************************************************** 00760502
*                                                                     * 00810502
* MODULE NAME = IFG0551F (OS/VS2)                                     * 00860502
*                                                                     * 00910502
* DESCRIPTIVE NAME = EOV BASIC READ JFCB                              * 00960502
*                                                                     * 01010502
* COPYRIGHT = NONE                                                    * 01060502
*                                                                     * 01110502
* STATUS = RELEASE 2, LEVEL 0                                         * 01160502
*                                                                     * 01210502
* FUNCTION =                                                          * 01260502
*        THIS MODULE IS THE SECOND LOAD OF THE EOV ROUTINES AND       * 01310502
*        PERFORMS THE FOLLOWING FUNCTIONS.                            * 01360502
*                                                                     * 01410502
*        THE DEB IS VALIDITY CHECKED (IF NOT ENTERED FROM THE         * 01460502
*        CONCATENATION FUNCTION TO PROCESS LIKE ATTRIBUTES            * 01510502
*        CONCATENATION) BY ISSUING THE DEBCHK MACRO.                  * 01560502
*        THIS IS NOT DONE FOR VSAM.                                   * 01660502
*                                                                     * 01710502
*        EXCEPT FOR VSAM, CONCATENATION, FEOV REPOSITIONING           * 01760502
*        FREE-OLD-DEB PROCESSING, AND FOR SPOOLED DCBS, THE DEBDCBAD  * 01810502
*        POINTED TO THE COPIED DCB AND THE DEB IS PURGED TO           * 01860502
*        ENSURE THAT NO OUTSTANDING I/O IS IN PROCESS AND DOES        * 01910502
*        NOT GET INITIATED DURING EOV.                                * 01960502
*                                                                     * 02010502
*        THE JFCB IS MOVED INTO THE EOV WORKAREA UNLESS A VSAM        * 02060502
*        CATALOG AMB, IN WHICH CASE MODULE IFG0550Y IS GIVEN          * 02110502
*        CONTROL TO LOCATE THE JFCB AND MOVE IT INTO THE EOV          * 02160502
*        WORKAREA. IFG0550Y RETURNS CONTROL TO THIS MODULE.           * 02210502
*                                                                     * 02260502
*        THE USER TOTALING SAVE AREA IS UPDATED TO INDICATE           * 02310502
*        THE LAST RECORD OF THE LAST BLOCK ON THE VOLUME BEING        * 02360502
*        PROCESSED.                                                   * 02410502
*                                                                     * 02460502
*        THE NUMBER OF UNITS ALLOCATED IN THE TIOT ENTRY IS           * 02510502
*        DETERMINED AND DXNOUNIT IS INITIALIZED WITH THIS VALUE       * 02560502
*        EXCEPT FOR VSAM.                                             * 02610502
*                                                                     * 02660502
*        IF IFG0550Y DETERMINED AN ERROR IN LOCATING THE JFCB         * 02710502
*        FOR A VSAM CATALOG, VSAM PROBLEM DETERMINATION MODULE        * 02760502
*        IDA0192P IS LOADED AND BALRED TO.                            * 02810502
         EJECT                                                          02860502
* NOTES = SEE BELOW                                                   * 02910502
*                                                                     * 02960502
*    DEPENDENCIES =                                                   * 03010502
*            CLASS ONE CHARACTER CODE.  THE EBCDIC CHARACTER CODE     * 03060502
*            WAS USED FOR ASSEMBLY.  THE MODULE MUST BE REASSEMBLED   * 03110502
*            IF A DIFFERENT CHARACTER SET IS USED FOR EXECUTION.      * 03160502
*                                                                     * 03210502
*    RESTRICTIONS = NONE                                              * 03260502
*                                                                     * 03310502
*    REGISTER CONVENTIONS =                                           * 03360502
*            R2 POINTS TO DCB                                         * 03410502
*            R4 POINTS TO EOV WORK AREA                               * 03460502
*            R5 POINTS TO THE RESIDENT ROUTINE                        * 03510502
*            R6 POINTS TO THE WTG TABLE                               * 03560502
*            R7 POINTS TO THE CURRENT PARAMETER LIST ENTRY            * 03610502
*            R8 POINTS TO THE CURRENT WTG TABLE ENTRY                 * 03660502
*            R9 POINTS TO THE DD ENTRY IN THE TIOT                    * 03710502
*            R10 POINTS TO THE UCB                                    * 03760502
*                                                                     * 03810502
*    PATCH LABEL = SEE THIRD FROM LAST LABEL BEFORE ORG STATEMENT AT  * 03860502
*                  END OF LISTING.                                    * 03910502
*                                                                     * 03960502
* MODULE TYPE = CONTROL (OPEN, CLOSE, EOV DATA MANAGEMENT)            * 04010502
*                                                                     * 04060502
*    PROCESSOR = ASSEMBLER XF                                         * 04110502
*                                                                     * 04160502
*    MODULE SIZE = SEE EXTERNAL SYMBOL DICTIONARY OR LOC FIELD ON     * 04210502
*                  ORG STATEMENT AT END OF LISTING                    * 04260502
*                                                                     * 04310502
*    ATTRIBUTES = REENTRANT, REFRESHABLE,READ-ONLY, ENABLED,          * 04360502
*                 PRIVILEGED, SUPERVISOR STATE, DATA MANAGEMENT KEY,  * 04410502
*                 LINK PACK AREA RESIDENT/PAGEABLE                    * 04460502
*                                                                     * 04510502
* ENTRY POINT = IFG0551F                                              * 04560502
*                                                                     * 04610502
*    PURPOSE = SEE FUNCTION                                           * 04660502
*                                                                     * 04710502
*    LINKAGE =                                                        * 04760502
*        GIVEN CONTROL BY LOADING AND BEING BRANCHED TO OR BY         * 04810502
*        USE OF THE XCTL MACRO.                                       * 04860502
         EJECT                                                          04910502
* INPUT =                                                             * 04960502
*        CONTROL IS PASSED IN PROTECT KEY 5.                          * 04970502
*        REGISTER 2 POINTS TO A COPIED DCB, UNLESS VSAM, IN WHICH     * 04980502
*              CASE REGISTER 2 POINTS TO THE AMB.                     * 04980902
*        REGISTER 4 POINTS TO THE EOV WORKAREA.                       * 04982502
*                                                                     * 04990502
*        REGISTER 14 CONTAINS A BRANCH TABLE CODE -                   * 05010502
*        0 - ENTERED FROM IGC0005E, THE FIRST LOAD OF EOV,            * 05060502
*        FOR NON-VSAM DATA SETS, OR                                   * 05110502
*        FROM IGC0003A, THE FIRST LOAD OF FEOV.                       * 05160502
*        4 - ENTRY FROM IFG0550Y FOR VSAM CATALOG DATA SETS.          * 05210502
*        8 - ENTERED FROM THE CONCATENATION MODULE, IFG0552X,         * 05260502
*        TO PROCESS LIKE ATTRIBUTES CONCATENATION. THE EOV            * 05310502
*        WORKAREA HAS BEEN UPDATED TO POINT TO THE NEW DSAB           * 05360502
*        AND TIOT ENTRY BEING CONCATENATED TO.                        * 05410502
*        12 - ENTERED FROM IGC0005E FOR VSAM AMBS.                    * 05460502
*                                                                     * 05510502
*        DCBC2FEOV, BIT 6, IN DCBCIND2 IS SET TO 1 BY IGC0003A        * 05560502
*        TO INDICATE FEOV PROCESSING.                                 * 05610502
*                                                                     * 05660502
*        DCBOCON, BIT 2, IN DCBOFLGS IS SET TO 1 BY IFG0552X          * 05710502
*        TO INDICATE CONCATENATION OF LIKE ATTRIBUTE DATA SETS.       * 05760502
*                                                                     * 05810502
* OUTPUT =                                                            * 05860502
*        CONTROL IS PASSED IN PROTECT KEY 5.                          * 05870502
*        REGISTER 2 POINTS TO A COPIED DCB UNLESS VSAM, IN WHICH      * 05880502
*              REGISTER 2 POINTS TO THE AMB.                          * 05890502
*        REGISTER 4 POINTS TO THE EOV WORKAREA.                       * 05900502
*                                                                     * 05902502
*        DEBDCBAD POINTS TO COPIED DCB EXCEPT FOR SPOOLED DCBS,       * 05910502
*        VSAM AMBS, AND IF CONCATENATION IS BEING PROCESSED.          * 05960502
*                                                                     * 06010502
*        THE JFCB IS IN THE EOV WORKAREA AT LABEL DXJBF.              * 06060502
*                                                                     * 06110502
*        DXXNOUNIT INITIALIZED TO THE NUMBER OF UNITS IN THE          * 06160502
*        TIOT ENTRY FOR NON VSAM DATA SETS.                           * 06210502
*                                                                     * 06260502
*        VSAM PROBLEM DETERMINATION PARAMETER LIST CONSTRUCTED        * 06310502
*        BEFORE BALRING TO VSAM PROBLEM DETERMINATION MODULE          * 06360502
*        IDA0192P.                                                    * 06410502
*                                                                     * 06460502
* EXIT-NORMAL =                                                       * 06510502
*        IFG0551H FOR NOT SPOOLED DCBS.                               * 06560502
*        IFG0552X FOR SPOOLED DCBS.                                   * 06610502
*        IFG0550Y TO LOCATE JFCB FOR VSAM CATALOG DATA SETS.          * 06660502
*        IFG0557A FOR ALL VSAM DATA SETS.                             * 06710502
*                                                                     * 06760502
* EXIT-ERROR =                                                        * 06810502
*        IFG0550P, EOV PROBLEM DETERMINATION, WITH AN INTERNAL        * 06860502
*        ABEND CODE IN REGISTER 0 -                                   * 06910502
*                                                                     * 06960502
*        219 - CAUSING AN A37-08 ABEND IF THE SPOOLED DCB'S DEB       * 07010502
*        POINTS TO AN ACB (THROUGH DEBDCBAD) WHICH DOES NOT           * 07060502
*        POINT BACK (THROUGH ACBDEBAD) TO THE SAME DEB, OR IF         * 07110502
*        THE SPOOLED DCB'S DEB DOES NOT POINT (THROUGH DEBECBAD)      * 07160502
*        BACK TO THE DCB.                                             * 07210502
         EJECT                                                          07410502
* EXTERNAL REFERENCES = SEE BELOW                                     * 07460502
*                                                                     * 07510502
*    ROUTINES =                                                       * 07560502
*        IDA0192P GIVEN CONTROL IF IFG0550Y DETECTED AN ERROR         * 07610502
*        LOCATING THE JFCB FOR A VSAM CATALOG DATA SET.               * 07660502
*                                                                     * 07710502
*    DATA AREAS = NONE.                                               * 07760502
*                                                                     * 07810502
*    CONTROL BLOCK =                                                  * 07860502
*        CVT                                                          * 07910502
*        DEB                                                          * 07960502
*        DCB                                                          * 08010502
*        TIOT                                                         * 08060502
*        TCB                                                          * 08110502
*        AMB                                                          * 08160502
*        DSAB                                                         * 08210502
*        UCB                                                          * 08260502
*        USER TOTALING AREA                                           * 08310502
*                                                                     * 08360502
* TABLES =                                                            * 08410502
*        EOV WORKAREA.                                                * 08460502
*                                                                     * 08510502
* MACROS =                                                            * 08560502
*        DEBCHK                                                       * 08610502
*        DMABCOND                                                     * 08660502
*        MODESET                                                      * 08710502
*        IECRES LOAD                                                  * 08760502
*        PURGE                                                        * 08810502
*        WAIT                                                         * 08860502
*        IECRES LOCJFCB                                               * 08910502
*        LOAD                                                         * 08960502
*        DELETE                                                       * 09010502
*        XCTLTABL                                                     * 09060502
*        IECDSECS                                                     * 09110502
*        IECEQU                                                       * 09160502
*        IDAAMB                                                       * 09210502
*                                                                     * 09260502
* CHANGE ACTIVITY =                                                   * 09310502
*        SEE CHANGES/DELETIONS SECTION JUST AFTER CSECT CARD          * 09320502
*                                                                     * 09360502
*********************************************************************** 09410502
         EJECT                                                          14700021
*                                                                       14800021
EABD219  EQU   219                      INTERNAL CODE FOR ABEND A37-08  14850002
*                                                                       15100021
         USING UCB,RUCB                                                 15200021
         USING FORCORE,RCORE                                            15300021
         USING WTG,RWTG                 BASE FOR WTG TABLE       Y02080 15350002
         USING CVT,RET                                                  15400021
         USING TIOENTRY,RTIOT                                           15500021
         USING DEBBASIC,RDEB                                     YM1272 15600002
         USING IHADCB,RDCB                                              15700021
*                                                                       15800021
*********************************************************************** 15900021
*              END OF VOLUME PROCESSING STARTS HERE                     16000021
*********************************************************************** 16100021
*                                                                       16200021
EIN10800 BALR  RBASE,0                  ESTABLISH BASE                  16300021
         USING *,RBASE                                                  16400021
*                                                                       16900021
         L     RPAR,CVTPTR              CVT ADDRESS              Y02082 16950002
         L     RPAR,CVTDMSR-CVT(,RPAR)  RESIDENT ROUTINE ADDR    Y02082 16952002
         B     EIN10850(RET)            BR TO INDICATED FUNCTION X02989 16960002
EIN10850 EQU   *                        BRANCH TABLE             X02989 16970002
         B     EIN10875                 INITIAL ENTRY            YM1277 16980002
         B     EIN11251                 ENTRY FOR VSAM CATALOG   X02989 16990002
*                                       EOV ROUTINE              X02989 16992002
         B     EIN10900                 ENTRY FOR CONCAT(552X)   YM1277 16992402
         B     EIN11150                 VSAM ENTRY FROM 005E     YM1391 16992502
EIN10875 EQU   *                        INITIAL ENTRY            YM1277 16992802
         NI    DCBOFLGS,ALLBITS-DCBOCON FORCE OFF CONCAT BIT     YM1277 17029302
EIN10900 EQU   *                        CONCATENATION ENTRY      X02989 17047302
*                                                                Y02082 17404002
         L     RET,CVTPTR               GET CVT ADDR             Y01018 17420000
         USING TIOENTRY,RTIOT           RE-DEFINE TIOT BASE      Y01018 17476600
         L     RTIOT,DXTIOTAD           GET TIOT ENTRY ADDRESS   Y02134 17592002
         ST    RCORE,DXXCORE-K1         SAVE WORK AREA PTR       X02989 17596202
         L     RDEB,DCBDEBAD            POINT TO DEB                    17601202
         NI    DCBIFLGS,X'FF'-DCBIFPIO  RESET ERROR FLAGS        Y02082 17654002
         TM    TIOELINK,TIOTSPOL        SPOOLED ENTRY?           Y02120 17655002
         BZ    EIN11050                 NO,CONTINUE                     17655902
         EJECT                                                          17656302
*                                                                       17656802
*        SPOOLED DCB'S DEB DOES NOT POINT BACK TO DCB, BUT TO    Y02120 17657702
*        THE SPOOLED ACB WHICH CAN BE DEBCHK VERIFIED.           Y02120 17659802
*        DEBECBAD POINT TO SPOOLED DCB.                          Y02120 17660202
*                                                                       17661802
         LA    RDCB,K0(RDCB)            CLEAR HIGH BYTE          Y02120 17662202
         L     R7,DEBECBAD              GET CI DCB ADDRESS       Y02120 17662602
         LA    R0,EABD219               A37 ABEND CODE           Y02120 17663002
         CLM   R7,B'0111',DXUDCBAD+K1   DOES DEB PT TO USER DCB  Y02082 17663102
         BNE   EIN11040                 NO--INVALID DCB          Y02120 17668002
         L     R7,DEBDCBAD              GET ACB TO DEBCHK        Y02120 17668102
         LA    R7,K0(,R7)               CLEAR HIGH BYTE          Y02120 17668202
         DEBCHK (R7),AM=SUBSYS          VERIFY DEB               Y02120 17668402
         LA    RDEB,K0(RDEB)            CLEAR HIGH BYTE          Y02120 17668802
         LA    R1,K0(R1)                CLEAR HIGH BYTE          Y02120 17669402
*                                       OF DEB RETURNED IN REG 1 Y02120 17670302
         LA    R0,EABD219               A37 ABEND CODE           Y02120 17670702
         CR    R1,RDEB                  DEBS EQUAL               Y02120 17671202
         BE    EIN11240                 BR TO BYPASS PURGE DEB   Y02120 17672102
EIN11040 EQU   *                        PROBLEM DETERMINATION EXIT      17672402
         LA    RWTGC,DXXENTRY           POINT TO CURRENT ENTRY   A50321 17672702
         DMABCOND (0),MODPD1F,REGSAVE=YES                        Y02134 17673002
         SPACE 2                                                        17673302
EIN11050 EQU   *                        NON-SPOOLED DEB CHECK           17673902
         TM    DCBOFLGS,DCBOCON         CHK FOR CONCAT PROC      Y02082 17674702
         BO    EIN11200                 YES, BR TO BYPASS DEBCHK Y02082 17677102
         L     R1,DXUDCBAD              POINT TO USER'S DCB      Y02082 17680102
         DEBCHK (R1)                    VALIDATE DEB             Y02082 17682502
         LR    RDEB,R1                  LOAD VERIFIED DEB ADDR   Y01021 17684902
         STCM  RDEB,B'0111',DCBDEBAD+K1 STORE VALID DEB ADDR IN  Y02082 17687302
*                                       COPIED DCB               Y02082 17689702
         B     EIN11200                 CONTINUE                 YM3809 17690102
         EJECT                                                          17691702
*                                                                       17743502
*        VSAM ENTRY FROM IGC0005E                                       17793502
*                                                                       17843502
*        GIVE VSAM CATALOG JFCB FINDING MODULE CONTROL IF AMB           17893502
*        IS CONNECTED TO A VSAM CATALOG                                 17943502
*                                                                       17993502
EIN11150 EQU   *                        VSAM ENTRY               YM1391 19000002
         MODESET EXTKEY=ZERO            ASSUME KEY ZERO          YM1391 19010002
         USING  IDAAMB,RDCB             DEFINE BASE TO AMB       YM1391 19020002
         TM    AMBINFL,AMBCAT+AMBSCRA+AMBUCRA  VSAM CATALOG?   @Y30DSDT 19050000
         USING IHADCB,RDCB              REDEFINE BASE FOR DCB    YM1391 19100002
         BZ    EIN11250                 BR IF NO               @Y30DSDT 19150000
         MVC   DXXMODID,MODVS0Y         MOVE ID TO NAME          YM1391 19200002
         MVC   DXXMODEP+K1(K3),MODVS0Y+K2 MOVE IN TTR            YM1391 19210002
         OI    DXATEOV,DXATVCAT         GOING TO VSAM CATLG 550Y YM1391 19240002
         IECRES LOAD,PREFIX=DXXPREFX,BRANCH=DIRECT               YM1391 19242002
*                                       XCTL TO VSAM CATLG MOD   YM1391 19242402
         EJECT                                                          19244002
EIN11200 EQU   *                        I/O CTL BLKS                    19254002
*                                                                       19294002
*        SETUP EOV WORK AREA & FORMAT                                   19300002
*                                                                       19350002
         NI    DXXPATHS+K1,WTGTSENQ     ZERO ALL BUT TSENQ BIT   YM2179 19874000
         TM    DCBOFLGS,DCBOCON         IF CONCATENATION, BYPASS Y02082 19950002
         BO    EIN11240                 DEBCHK DELETE            YM1391 20000002
         TM    DCBMACRF,DCBMEXCP        EXCP                     YM5370 20050002
         BO    EIN11220                 BRANCH IF NO             YM5370 20060002
         TM    DCBCIND2,DCBC2FEO        FEOV                     YM5370 20070002
         BZ    EIN11220                 BRANCH IF NO             YM5370 20080002
         TM    DCBIOBAD,DCBUPDCM+DCBSVDEB FEOV REPOSITIONING,    YM5370 20090002
*                                       FREE OLD DEB FUNCTION    YM5370 20092002
         BO    EIN11240                 BRANCH IF YES-BYPASS     YM5370 20094002
*                                       DEBCHK DELETE, PURGE     YM5370 20094402
EIN11220 EQU   *                        POINT DEB TO COPY DCB    YM5370 20094802
*                                                                Y02082 20096002
* SIMULATE DEBCHK DELETE BY DISCONNECTING DEB FROM USER'S DCB    Y02082 20098002
*                                                                Y02082 20098402
         MVC   DEBDCBAD+K1(L'DEBDCBAD-K1),DXPDCBAD+K1 POINT DEB  Y02082*20099202
                                        TO COPIED DCB            Y02082 20099602
         L     R1,DXDEBXAD              GET PTR TO DEB EXTN      YM1272 20108302
         OI    DEBXFLG1-DEBXTN(R1),DEBXCDCB INDIC DEB PT TO COPY YM1272 20110302
*                                                                Y02082 20113102
* PURGE DEBS FOR ALL DCBS (NOT ACBS) EXCEPT SPOOLED DCBS         Y02082 20119802
*                                                                Y02082 20126502
         LA    R1,DXCCW                 BUILD PURGE PARM LIST IN Y02082 20133202
         USING PURGPRM,R1                 CCW WORK AREA.         Y02082 20143202
         ST    RDEB,PURGDEB             STORE DEB TO BE PURGED   Y02082 20153202
         MVI   PURGOPT,X80+X20          SET OPTION BITS          Y02082 20163202
         XC    PURGECB,PURGECB          CLEAR COMPLETION CODE    Y02082 20165202
         LA    R0,DEBUSRPG              SET POINTER TO IOB CHAIN Y02082 20165602
         ST    R0,PURGCHN                                        Y02082 20166002
         XC    PURGMVM,PURGMVM          CLEAR 4TH WORD OF LIST   Y02082 20166402
         PURGE (1)                      PURGE ALL IOBS, THIS DEB Y02082 20166502
         LA    R1,DXCCW                 ADDRESS PURGE PARM LIST  Y02082 20166602
         LA    R1,PURGECB-PURGPRM(R1)   POINT TO PURGE ECB       Y02082 20177702
         WAIT  ECB=(1)                  WAIT TILL PURGE COMPLETE Y02082 20187702
         DROP  R1                                                Y02082 20188102
         EJECT                                                          20190102
EIN11240 EQU   *                        FORMAT WORKAREA          YM1391 20195302
*                                                                       20196302
*              CONSTRUCT DUMMY BLOCKS IN WORK AREA                      20200021
*                                                                       20300021
         LA    RC,DXDCB                 DUMMY DCB ADDR                  20400021
         ST    RC,IOBDCBPT-K1           DCB PTR GOES IN DUMMY IOB       20500021
         LA    RC,DXECB                 DUMMY ECB ADDR                  20600021
         ST    RC,IOBECBPT              ECB PTR GOES IN DUMMY IOB       20700021
         LA    RC,DXCCW                 LOC OF CHANNEL PROGRAM          20800021
         ST    RC,IOBSTART-K1           CHNL PRGM PTR INTO DUMMY IOB    20900021
         OI    IOBFLAG1,K2              NO RELATION BETWEEN IO REQSTS   21000021
         LA    RC,DXDEB                 DUMMY DEB ADDR                  21100021
         ST    RC,DXDCBDEB              DEB PTR GOES IN DUMMY DCB       21200021
         L     R1,CVTSVDCB              LOC OF SVCLIB DCB        Y02120 21300002
         L     R1,DCBDEBAD-IHADCB(K0,R1)  LOC OF SVCLIB DEB      Y02120 21400002
         MVC   DXDEB+K4(K44),K4(R1)     USE SVCLIB DEB           Y02120 21500002
         MVI   DXDEB+(DEBNMEXT-DEBBASIC),K1 SET NO. EXTENTS 1   YA03003 21510002
         MVC   DXDEBAPP,CVTXAPG         SET DUMMY APPEND VEC TBL Y02080 21550002
         MVI   DXDEBMOD,K0              SET FILE MASK TO ZERO    YM6841 21560002
         XC    DXDEB+K21(K3),DXDEB+K21  ZERO DEBECBAD                   21600021
         IC    R0,DXDEBID               SAVE BYTE 0                     21700021
         LA    RC,DXDCB                 LOC OF DUMMY DCB                21800021
         ST    RC,DXDEBDCB              DUMMY DCB PTR IN DUMMY DEB      21900021
         STC   R0,DXDEBID               RESTORE BYTE 0                  22000021
         LA    R1,DXDEB                 POINT TO DUMMY DEB              22100021
         ST    RCORE,DXXCORE-K1         PUT WORK AREA PTR IN PARM       32703002
         SPACE 2                                                        32704002
EIN11250 EQU   *                        VSAM NON-CATALOG ENTRY   YM1391 32705802
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY      YM1391 32707802
*                                                                Y02134 32708102
         L     RTIOT,DXDSABAD           LOAD POINTER TO DSAB     Y02134 32709902
         L     RTIOT,DSABTIOT-DSAB(,RTIOT) GET TIOT ENTRY        Y02134 32711702
         LA    RET,TIOEJFCB             POINT TO JFCB POINTER    Y02134 32713502
         IECRES LOCJFCB,(RET)           LOCATE JFCB              Y02134 32715302
         MVC   DXJBF(JFCBLGTH),INFMJFCB-INFMJFCB(RET) GET JFCB   Y02134 32717102
*                                                                Y02134 32768002
* TURN ON 'JFCB OPENED' BIT TO INDICATE THIS FACT TO SCHEDULER   Y02134 32848202
* IN CASE WE ARE PASSING THROUGH THIS CODE FOR LIKE ATTRIBUTES   Y02134 32850402
* CONCATENATION                                                  Y02134 32852602
*                                                                Y02134 32854602
         OI    JFCFLGS1,X80             SET BIT                  Y02134 32854802
         EJECT                                                          32855202
         MODESET EXTKEY=ZERO            ASSUME KEY ZERO          YM1391 32856802
         TM    DCBMACRF,DCBMEXCP        IS ACCESS METHOD EXCP    X02989 32857002
         BO    EIN11255                 BR IF YES, NOT ACB       X02989 32859202
         TM    DCBDSORG+K1,ACBDORGA     IS CNTRL BLK AN ACB/AMB  X02989 32861402
         BNO   EIN11255                 BR IF NO                 X02989 32863602
         USING IDAAMB,RDCB              DEFINE BASE TO AMB       X02989 32865802
         TM    AMBID,AMBIDENT           IS CNTRL BLK AN AMB      X02989 32868002
         BNO   EIN11255                 BR IF NO                 X02989 32870202
EIN11251 EQU   *                        IFG0550Y RETURN          X02989 32872402
         MVC   DXXIDTTR(K5),MODVS7A     LD ID OF VSAM MOD IN WTG X02989 32874602
         LA    RWTG,DXXAREA             POINT TO EOV WTG TABLE   XM1037 32876802
         SR    RET,RET                  ZERO RETURN REG          XM1037 32879002
         TM    AMBINFL,AMBCAT+AMBSCRA+AMBUCRA  VSAM CATALOG?   @Y30DSDT 32883400
         USING IHADCB,RDCB              REDEFINE BASE TO DCB     X02989 32885602
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY      YM1391 32887602
         BZ    EIN11252                 BR IF NO               @Y30DSDT 32887800
         TM    DXECB,ECBNOERR           TEST FOR I/O             X02989 32890002
         BNO   EIN11253                 BR IF ERROR              X02989 32892202
EIN11252 EQU   *                        GO TO VSAM               YM1391 32892602
         OI    DXATGENS,DXATVSMG        VSAM STRING TO GET CNTRL Y02144 32894202
         B     EIN12975                 BR TO GO TO NEXT MODULE  X02989 32903202
         EJECT                                                          32905202
EIN11253 EQU   *                        VSAM PROBLEM DETERMINATION      32905402
         LA    RC,DXIOB                 LD ADDR OF WORK AREA     X02989 32907602
         USING IDAPDPRM,RC              SET BASE FOR PARM LIST   X02989 32909802
         XC    IDAPDPRM(PDPLNGTH),IDAPDPRM ZERO PARAMETER LIST   X02989 32912002
         MVI   PDPCALL,PDPEOV           INDICATE CALLER          X02989 32914202
         MVI   PDPCODE,VSJFBERR         SET INTERNAL ERROR CODE  X02989 32916402
         MVI   PDPFUNC,VSEOV            LD FUNCTION CODE         X02989 32918602
         ST    RDCB,PDPACB              ST ADDR OF AMB           X02989 32920802
         ST    RTIOT,PDPTIOT            ST ADDR OF TIOT ENTRY    X02989 32923002
         L     RD,CVTADDR               GET CVT ADDR             X02989 32925202
         L     RD,CVTSVDCB-CVT(,RD)     GET SVCLIB DCB ADDR      XM1037 32927402
         MVC   DXXCTL,EIN1347P          LD NAME OF PROB DET RTN  XM1037 32929602
         LOAD  EPLOC=DXXCTL,DCB=(RD)    GET ADDR OF ROUTINE      XM1037 32931802
         LR    RF,R0                    LOAD ADDR OF PD ROUTINE  X02989 32934002
         LR    R1,RCORE                 LD ADDR OF WORK AREA     X02989 32936202
         BALR  RET,RF                   BR TO VSAM PD ROUTINE    X02989 32938402
         DELETE EPLOC=DXXCTL            DELETE VSAM PD ROUTINE   XM1037 32940602
         XC    DXXCTL,DXXCTL            ZERO NAME FIELD          XM1037 32942802
         MVI   JFCDSRG2,JFCORGAM        SET VSAM INDICATOR       X02989 32945002
         OI    DXATGENS,DXATVSMG        VSAM STRING TO GET CNTRL Y02144 32947002
         B     EIN12975                 BR TO GO TO NEXT MODULE  X02989 32947202
         EJECT                                                          32949202
EIN11255 EQU   *                        NON-VSAM EOV             X02989 32949402
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY      YM1391 32949802
         TM    TIOELINK,TIOTSPOL        SPOOLED ENTRY?           YM1308 32951402
         BM    EIN12900                 YES,BRANCH               YM1308 32951502
         DROP  RC                                                X02989 32951602
*********************************************************************** 32956002
*        NON-SPOOLED DCB - FEOV AND NOT FEOV                            32969202
*********************************************************************** 32971402
*                                                                       32973402
*        PREPARE NOW TO KNOW IF A.M. EXECUTOR NEEDS CONTROL             32973602
*        BEFORE RETURNING TO PROBLEM PROGRAM                            32975802
*                                                                       32978002
         TM    DCBMACRF,DCBMEXCP        EXCP                            32980202
         BO    EIN11270                 YES, GO                         32982402
         OI    DXOPCLSW,UCBMOUNT        SET SWITCH TO LOAD EXECUTOR     32984602
*                                                                       32986802
EIN11270 EQU   *                        INITIALIZE WORKAREA DEB         32989002
*                                                                       32991202
         MVC   DXDEBECC(K4),MAXN        MAX CYL NO                      32995602
*                                                                       32997802
***     SET REDUCED ERROR RECOVERY BIT IN EOV'S WORK DEB-UNL TAPE       33000021
*                                                                       33100021
         L     RUCB,DXUCBADR            LOAD CURRENT UCB         Y02134 33200002
         TM    UCBTBYT3,DCBDEVTP        IS THIS A TAPE DEVICE           33300021
         BZ    EIN11600                 NO                              33400021
         NI    K40(RDEB),ALLBITS-X80    TURN OFF DOS CHKPT BIT  YA03190 33450002
         NI    DXDEBOFL,ALLBITS-K1      INSURE REDUCED ERROR RECOV BIT  33500021
*                                       IS OFF                          33600021
         TM    JFCBLTYP,JFCNL           IS THIS AN UNLABELED TAPE       33700021
         BZ    EIN11600                 NO                              33800021
         OI    DXDEBOFL,K1              YES,TURN ON RED ERROR REC BIT   33900021
         EJECT                                                          34000002
EIN11600 EQU   *                        SKIP OPTION INIT IF CONCAT      34100002
*                                                                Y02134 34150002
         TM    DCBOFLGS,DCBOCON         TEST FOR CONCATENATION   Y02134 34152002
         BO    EIN12900                 BRANCH, CONCAT IN PROG   Y02134 34154002
*                                                                Y02134 34156002
         L     RPARC,DXXPREFX           LOAD PREFIX POINTER      Y02134 34158002
         L     RPARC,IECUPRML-IECPREFX(,RPARC) LOAD PTR TO PARMS Y02134 34158402
         USING USERPRML,RPARC           RPARC POINTS TO PARMS    Y02134 34159202
*                                                                Y02134 34161202
*****************************************************************Y02134 34163202
*                                                                Y02134 34165202
*        INITIALIZE OPTION 2 FLAG                                Y02134 34167202
*                                                                Y02134 34169202
*****************************************************************Y02134 34171202
*                                                                Y02134 34171602
         TM    DCBMACRF,DCBMEXCP        TEST FOR EXCP          @ZA02187 34171700
         BO    EIN11620                 BR, CANNOT BE FEOV     @ZA02187 34171800
         TM    DCBCIND2,DCBC2FEO        TEST FOR FEOV            Y02134 34172002
         BNO   EIN11610                 BRANCH NOT FEOV          Y02134 34174002
         TM    DXDCBLST,PLISTOP2        TEST FOR FEOV OPT2       Y02134 34180002
         BNZ   EIN11620                 BRANCH IF FEOV OPT2 SPEC Y02134 34182002
*                                                                Y02134 34184002
EIN11610 EQU   *                        REWIND/REREAD FROM DEB   Y02134 34186002
*                                                                Y02134 34188002
         MVZ   DXDCBLST(K1),DEBOPATB    MOVE IN OPEN OPTION 2    Y02134 34188402
         OI    DXDCBLST,LASTNTRY        SET END OF LIST          Y02134 34188802
*                                                                Y02134 34189202
EIN11620 EQU   *                        OPEN OPTION FROM DEB     Y02134 34189602
*                                                                Y02134 34192202
*****************************************************************Y02134 34194202
*                                                                Y02134 34194602
*        INITIALIZE OPTION 1 FLAG                                Y02134 34194702
*                                                                Y02134 34215702
*****************************************************************Y02134 34225702
*                                                                Y02134 34237002
         MVN   DXDCBLST(K1),DEBOPATB    MOVE OPEN OPTION1 IN LST Y02134 34258002
*                                                                Y02134 34268002
         TM    DCBMACRF,DCBMEXCP        CHECK FOR EXCP                  34279002
         BO    EIN12900                 BRANCH IF EXCP                  34300021
         TM    DCBOFLGS,DCBOWRIT        TEST FOR A WRITE                34350002
         BZ    EIN12900                 BR IF NOT                       34360002
*                                                                Y02134 34362002
         OI    DXDCBLST,PLISTOUT        SET TO OUTPUT            Y02134 34364002
         DROP  RPARC                                             Y02134 34366002
*                                                                Y02134 34370002
         TITLE 'IFG0551F - EOV/TOTALING SPECIAL PROCESSING'             34600021
         TM    DCBOPTCD,DCBOPTT         IS TOTAL OPTION BIT ON          34650002
         BZ    EIN12900                 NO, GO XCTL                     34660002
*                                                                       34670002
*              USER TOTALING ROUTINE                                    34680002
*                                                                       34710002
*              THE PURPOSE OF THIS ROUTINE IS TO PROVIDE SPECIAL      * 36000002
*              PROCESSING OF THE POINTER TO THE USER TOTALING         * 36100021
*              FACILITIE'S SAVE AREA WHICH CORRESPONDS TO THE         * 36200021
*              LAST RECORD OF THE LAST BLOCK ON THE VOLUME BEING      * 36300021
*              TERMINATED.                                            * 36400021
*                                                                     * 36500021
*              THE TOTALING SAVE AREA IS DESCRIBED BY THE TOTSAVWA    * 37100021
*              DSECT AT THE END OF THIS MODULE.  THE WORK AREA IS     * 37200021
*              POINTED TO BY THE SECOND WORD OF THE ACCESS METHOD     * 37300021
*              SECTION OF THE DEB                                     * 37400021
*                                                                     * 37500021
*********************************************************************** 40800021
*  NOW GET THE ADDRESS OF THE SAVE AREA FROM THE DEB                  * 40900021
*********************************************************************** 41000021
*                                                                     * 41100021
         SR    R7,R7                    CLEAR THIS REGISTER             41200021
         SR    RC,RC                    CLEAR THIS REGISTER             41300021
         IC    R7,DEBNMEXT              GET NO. OF EXTENTS              41400021
         IC    RC,DEBEXSCL              GET EXTENT SCALING FACTOR       41500021
         SLL   R7,K0(RC)                MULT TO GET EXTENT SIZE         41600021
         L     RWTG,K36(RDEB,R7)        GET IMAGE SAVE AREA ADDR        41700021
         USING TOTSAVWA,RWTG            ESTABLISH TOTAL AREA BASE       41800021
         MODESET KEYADDR=DXUKEY,WORKREG=15 ASSUME USER KEY       Y02082 41850002
*                                                                     * 41900021
*********************************************************************** 42000021
*RUCB CONTAINS THE ADDRESS OF THE IMAGE SAVE AREA                       42100021
*********************************************************************** 42200021
*                                                                     * 42300021
         TM    DCBCIND2,DCBC2FEO        TEST FOR FEOV CONDITION         42400021
         BO    EIN12800                 BR IF FEOV BIT ON               42500021
         TM    DCBCIND2,DCBC2CHN        TEST FOR CHAINED SCDEDLNG       42600021
         BO    EIN12500                 BR IF SPECIFIED                 42700021
         EJECT                                                          42750002
*********************************************************************** 42900021
*  NEXT COUNT THE IOB'S SCHEDULED BY EOB ROUTINE BUT NOT POSTED AS      43000021
*        COMPLETE.  THIS POINTER TO THE LAST IMAGE AREA WILL HAVE TO    43100021
*        BE ADJUSTED TO POINT TO THE IMAGE AREA WHICH CORRESPONDS TO    43200021
*        THE LAST BLOCK ACTUALLY WRITTEN                                43300021
*********************************************************************** 43400021
         L     R7,DCBIOBA               GET THE CURRENT IOB ADDR        43500021
         L     RC,K4(R7)                GET 'ERROR' IOB                 43600021
         LA    RC,K0(RC)                CLEAR HIGH-ORDER BYTE           43700021
         L     RD,K0(R7)                GET NEXT IOB IN CHAIN           43800021
         LA    RD,K0(RD)                CLEAR HIGH-ORDER BYTE           43900021
         SR    RET,RET                  CLEAR THIS REGISTER             44000021
*********************************************************************** 44200021
*  NOTE - RD WILL SERVE AS A COUNTER FOR THE NUMBER OF IOB'S OUTSTANDNG 44300021
*********************************************************************** 44400021
*                                                                       44500021
EIN11800 EQU   *                        SYMBOLIC ADDR                   44600021
*                                                                       44700021
         LA    RET,K1(RET)              BUMP COUNT BY ONE               44800021
         L     RD,K0(RD)                GET NEXT IOB IN CHAIN           44900021
         LA    RD,K0(RD)                CLEAR HIGH-ORDER BYTE           45000021
         CR    RD,RC                    COMPARE NEXT IOB TO ERROR IOB   45100021
         BNE   EIN11800                 BR IF NOT EQUAL                 45200021
         EJECT                                                          45250002
*********************************************************************** 45400021
*  NOTE - THE COUNT IN REGISTER RD WILL BE USED TO LOGICALLY BACKSPACE  45500021
*        THE EOV IMAGE AREA POINTER.                                    45600021
*********************************************************************** 45700021
*                                                                     * 45800021
*                                                                       45900021
EIN11900 EQU   *                        SYMBOLIC ADDR                   46000021
*                                                                       46100021
         L     R7,TOTCURNT              GET THE CURRENT IMAGE AREA      46200021
         TM    DCBDEVT,DCBDEVTP         TEST FOR TAPE DEV               46300021
         BZ    EIN12000                 BR IF NOT TAPE                  46400021
         BCTR  RET,R0                   DECREMENT COUNT IF TAPE         46500021
         LTR   RET,RET                  CHECK IF COUNT IS 0             46600021
         BZ    EIN12300                 IF COUNT=0 CURRENT IS           46700021
*                                       CORRECT-NOT NECESS TO           46800021
*                                       BACKUP IMAGE POINTER            46900021
*                                                                       47000021
EIN12000 EQU   *                        SYMBOLIC ADDR                   47100021
*                                                                     * 47200021
         L     RC,TOTSVLNG              GET THE SEG (IMAGE) LENGTH      47300021
         L     RD,TOTSTART              GET ADDR OF FIRST SEG           47400021
*                                                                     * 47500021
EIN12100 EQU   *                        ESTABLISH LAST SEGMENT          47600002
*                                                                     * 47700021
         SR    R7,RC                    POINT TO PREVIOUS SEG           47800021
         CR    R7,RD                    COMPARE TO FIRST SEG            47900021
         BNL   EIN12200                 BR IF NOT LOW                   48000021
         L     R7,TOTENDAD              A LOW SO GET LAST SEG           48100021
*                                                                       48200021
EIN12200 EQU   *                        SYMBOLIC ADDR                   48300021
*                                                                       48400021
         BCT   RET,EIN12100             BR ON COUNT                     48500021
*********************************************************************** 48700021
*  R7 NOW POINTS TO THE SAVE IMAGE AREA WHICH CORRESPONDS TO THE LAST * 48800021
*        BLOCK ACTUALLY WRITTEN AT EOV AND THIS IS TO BE STORED IN THE* 48900021
*        SAVE AREA FIRLD TOTEOVPT, AND WILL LATER BE PASSED TO THE USR* 49000021
*********************************************************************** 49100021
*                                                                       49200021
EIN12300 EQU   *                        SYMBOLIC ADDR                   49300021
*                                                                     * 49400021
         ST    R7,TOTEOVPT              STORE IMAGE ADDR IN CTL BLOCK   49500021
EIN12400 EQU   *                        SYMB. ADDR                      49600021
         B     EIN12900                 BRANCH TO COMPUTE DXNOUNIT      49700002
         EJECT                                                          49750002
*********************************************************************** 49800021
*  THE FOLLOWING SECTION OF CODE COUNTS THE NUMBER OF                 * 49900002
*        ICB'S WHICH HAVE NOT BEEN POSTED AS COMPLETE.  THIS COUNT    * 50000021
*        IS USED TO CALCULATE THE ADDRESS OF THE SAVE IMAGE AREA      * 50100021
*        THAT CORRESPONDS TO THE LAST BLOCK WRITTEN PRIOR TO          * 50200021
*        END-OF-VOLUME.                                               * 50300021
*********************************************************************** 50400021
*                                                                       50500021
EIN12500 EQU   *                        SYMBOLIC ADDR                   50600021
*                                                                       50700021
         LA    RET,K1                   MAKE COUNT = 1                  50800021
         L     RC,DCBIOBAD              GET IOB ADDR FROM DCB           50900021
         L     RC,K8(RC)                GET ICB ADDR                    51000021
         LA    RC,K0(RC)                CLEAR HIGH ORDER BYTE           51100021
         L     R7,K0(RC)                GET NEXT ICB                    51200021
*                                                                       51300021
EIN12600 EQU   *                        SYMBOLIC ADDR                   51400021
*                                                                       51500021
         LA    R7,K0(R7)                CLEAR HIGH ORDER BYTE           51600021
         CR    RC,R7                    CHECK FOR FIRST ICB             51700021
         BE    EIN12700                 BR IF LOOP COMPLETE             51800021
*                                                                       51900021
         LA    RET,K1(RET)              BUMP COUNT BY ONE               52000021
         L     R7,K0(R7)                POINT TO NEXT ICB               52100021
*                                                                       52200021
         B     EIN12600                 UNCONDITIONAL BRANCH            52300021
*                                                                       52400021
EIN12700 EQU   *                        SYMBOLIC ADDR                   52500021
*                                                                       52600021
         LTR   RET,RET                  TEST IF COUNT IS ZERO           52700021
         BNZ   EIN11900                 BR IF NOT ZERO                  52800021
*                                                                       52900021
         L     R7,TOTCURNT              GET CURRENT IMAGE AREA          53000021
*                                                                       53100021
         B     EIN12300                 UNCONDITIONAL BRANCH            53200021
*********************************************************************** 53400021
*                                                                     * 53500021
EIN12800 EQU   *                        SYMBOLIC ADDRESS              * 53600021
*                                                                     * 53700021
*********************************************************************** 53800021
* SINCE IT HAS BEEN DETERMINED THAT A FEOV HAS OCCURRED THE LAST      * 53900021
*        IMAGE AREA STORED IS THE LAST WRITTEN SINCE FEOV TERMINATES  * 54000021
*        ALL I/O PRIOR TO XCTL'ING TO THIS MOD.                       * 54100021
*********************************************************************** 54200021
*                                                                     * 54300021
         L     R7,TOTCURNT              POINT TO LAST IMAGE SAVED       54400021
         ST    R7,TOTEOVPT              STORE IN EOV IMAGE POINTER      54500021
         TITLE 'IFG0551F   EOV BASIC READ JFCB'                         54510002
*                                                                       54600021
*              COMPUTE NUMBER OF UNITS ALLOCATED TO DATA SET IN TIOT    54700002
*              FIRST LOCATE THE DATA SET ENTRY IN THE TIOT              54800021
*                                                                       54900021
EIN12900 SR    R7,R7                    ZERO FOR IC                     55000002
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY      Y02082 55050002
         IC    R7,TIOELNGH              LENGTH OF ENTRY                 55100021
         LA    RC,TIOESTTB-TIOENTRY(K0,K0)  DSP OF UCB(1) PTR IN TIOENT 55200021
         SR    R7,RC                    BYTES IN ALL POINTERS           55300021
         SRL   R7,K2                    R7 CONTAINS NO. OF UNITS ALLOC. 55400021
         STH   R7,DXNOUNIT              SAVE NO. UNITS IN WORK AREA     55500021
         LA    RWTG,DXXAREA             POINT TO EOV WTG                55600021
         USING WTG,RWTG                 RWTG POINTS TO WTG TABLE Y02134 55610002
         TM    DCBMACRF,DCBMEXCP        DCB USING EXCP                  55660000
         BO    EIN12950                 YES, BYPASS SPOOL TEST          55670000
         TM    TIOELINK,TIOTSPOL        SPOOLED DCB?             Y02120 55680002
         BZ    EIN12950                 NO,CONTINUE                     55690000
         MVC   DXXIDTTR,MOD2X1F         MOVE ID TO WORK AREA     Y02134 55692002
         B     EIN12975                 BR TO CONTINUE                  55694000
EIN12950 EQU   *                        IFG0551H NEXT                   55696002
         MVC   DXXIDTTR,MOD1H1F         MOVE ID TO WORK AREA     Y02134 55748002
EIN12975 EQU   *                        TRANSFER CONTROL                55760002
         MVC   DXXMODNM(K6),IFG1F       SET UP XCTL NAME                55800021
         LA    R0,DXECB                 GET ECB ADDR             Y02080 56350002
         L     R1,DXXPREFX              GET POINTER TO PREFIX    Y02080 57060002
         USING IECPREFX,R1                                       Y02080 57062002
         L     R1,IECRESWA              PTR TO RESIDENT WKAREA   Y02080 57070002
         USING RWARESWA,R1                                       Y02080 57080002
         ST    R0,RWALIST               ST IN PARM               Y02080 57800002
         MVI   RWALIST,UCBMOUNT         IND END OF LIST          Y02080 57900002
         DROP  R1                                                Y02080 57950002
         L     RES,CVTPTR               LOAD POINTER TO CVT      Y02080 57960002
         L     RES,CVTDMSR-CVT(,RES)    LOAD IFG019RA PTR        Y02080 57970002
         TM    JFCBMASK+K6,JFCTRACE     CHK FOR TRACE OPTION            58000021
         BZ    EIN13300                 BR, NO                          58100021
         OI    DXXPATHS+K1,UCBMOUNT     IND TRACE INIT                  58200021
*                                                                Y02134 58762002
EIN13300 IECRES LOAD,BRANCH=QUEUED      GO TO NEXT LOAD          Y02134 58770002
         EJECT                                                          58820002
*                                                                       58900021
*                   CONSTANTS                                           59000021
*                                                                       59050002
SPOOLM   EQU   X'08'                    DCB SPOOLED INDICATOR           59060000
EIN1347P DC    C'IDA0192P'              VSAM PROB DET RTN        XM1037 59062002
IFG1F    DC    C'IFG055'                1ST 6 CHAR OF MODULE NAME       59100021
XCTLCN1F DC    X'C37800'                MODULE                          59200021
         DC    X'04000400'              ATTRIBUTES                      59300021
CON40Z   DC    H'4'                     HWD CONSTANT OF 4               59700021
CON6     DC    H'6'                     HWD CONSTANT OF 6               59800021
MAXN     DC    X'019B7FFF'              MAX EXTENT NO                   59900021
         EJECT                                                          59950002
*                                                                       60200021
*              IFG0551F XCTL TABLE                                      60300002
XCTLTA0Z XCTLTABL ID=(MODPD1F,0P,MOD1H1F,1H,MOD2X1F,2X,MODVS7A,7A,     *60470002
               MODVS0Y,0Y),SVC=055,BRT=YES,LENGTH=               Y02080 60480002
         EJECT                                                          60530002
         IECDSECS CVT,TCB,DSAB,TIOT,DCB,ACB,UCB,IEZDEB,          YM1272X60532002
               MAIN,PREFX,WTG,USERTOT,IDAPDPRM,EXPAND=YES               60534002
PURGPRM  DSECT                          PURGE PARAMETER LIST     Y02082 60584002
PURGDEB  DS    0F                       DEB TO BE PURGED         Y02082 60594002
PURGOPT  DS    C                        OPTION BITS              Y02082 60604002
         DS    AL3                      DEB POINTER              Y02082 60614002
PURGECB  DS    0F                       USE THIS FIELD FOR ECB   Y02082 60624002
         DS    C                        COMPLETION CODE          Y02082 60626002
PURGTCB  DS    AL3                      TCB POINTER (0=CURRENT)  Y02082 60628002
PURGCHN  DS    AL4                      CHAIN OF IOBS            Y02082 60628402
PURGMVM  DS    F                        4TH WORD FOR MVM         Y02082 60628802
IFG0551F CSECT                                                   Y02082 60629202
         IECEQU AOS=YES,IEZDEB=YES                               YM1272 60630002
         IDAAMB                                                  X02989 60632402
TIOTSPOL EQU   X'06'                    JESSPOOL D.S. INDICATORS Y01021 60634000
         END                                                            60700021
