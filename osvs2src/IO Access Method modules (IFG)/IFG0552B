         TITLE 'IFG0552B  EOV - RE-WRITE VOLUME LABEL'                  00200021
FFG0552B CSECT                                                          00800000
*********************************************************************** 00850002
*                                                                     * 00900002
*                                                                     * 00950002
*          VS2 RELEASE 03 DELETIONS                                   * 00960037
*0000                                                          @ZA02874 00970037
*0000474962,475022                                             @ZA09625 00980037
*          VS2 SU32 DELETIONS                                           00985032
*301902-301010                                                 @ZA32147 00990037
*                                                              @G32DSMI 00990132
*                                                              @ZM04476 00995032
*          VS2 RELEASE 02 DELETIONS                                   * 01000002
*                                                                     * 01050002
*                                                                     * 01100002
*********************************************************************** 01150002
*                                                                     * 01200002
* MODULE NAME = IFG0552B (OS/VS2)                                     * 01250002
*                                                                     * 01300002
* DESCRIPTIVE NAME = RE-WRITE VOLUME LABEL                            * 01350002
*                                                                     * 01400002
* COPYRIGHT = NONE                                                    * 01450002
*                                                                     * 01500002
* STATUS = RELEASE 2, LEVEL 0                                         * 01550002
*                                                                     * 01600002
* FUNCTION =                                                          * 01650002
*        1) IF NSL IS SPECIFIED, THE DCB IS COPIED FROM THE           * 01700002
*        WORK AREA TO THE CALLER'S STORAGE AND CONTROL IS PASSED TO   * 01750002
*        NSLEHDRO ROUTINE.                                            * 01800002
*        2) IF NL/BLP SPECIFIED, TRANSFER CONTROL TO IFG0552F WITH A  * 01850002
*        BRANCH CODE OF 4.                                            * 01900002
*        3) READ HDR1 LABEL AND TRANSLATE IF ASCII. IF UNIT EXCEPTION * 01950002
*        OCCURS, A NEW VOLUME IS REQUESTED VIA TRANSFER OF CONTROL    * 02000002
*        TO IFG0552N WITH A BRANCH CODE OF 0.                         * 02050002
*        4) EXAMINE THE LABEL TO CHECK FOR SECURITY PROTECTION. IF    * 02100002
*        DATA SET SECURITY IS INCONSISTENT WITH THAT SPECIFIED IN THE * 02150002
*        JFCB, ISSUE AN ASCII DISMOUNT MESSAGE FOR ASCII (TRANSFER    * 02200002
*        CONTROL TO IFG0554J, BRANCH CODE = 8), OR A SECURE VOLUME    * 02250002
*        MESSAGE FOR SL (TRANSFER CONTROL TO IFG0554J, BRANCH CODE=40)* 02300002
*        IN EITHER CASE, THE RETURN MODULE IS IFG0552N WITH A         * 02350002
*        RETURN OFFSET OF 0.                                          * 02400002
*        5) IF THE DATA SET IS SECURITY PROTECTED, TRANSFER CONTROL   * 02450002
*        TO IFG0555T TO REQUEST PASSWORD WITH A BRANCH CODE = 0. THE  * 02500002
*        RETURN MODULE IS IFG0552B WITH A RETURN OFFSET OF 20.        * 02550002
*        6) RETURN FROM PASSWORD CHECK TO EXAMINE THE EXPIRATION      * 02600002
*        DATE. IF THE DATE HAS NOT BEEN PASSED, TRANSFER CONTROL      * 02650002
*        TO IFG0554J, BRANCH CODE = 20, TO ISSUE THE EXPIRATION DATE  * 02700002
*        MESSAGE. THE RETURN MODULE IS IFG0552B WITH A RETURN OFFSET  * 02750002
*        OF 4.                                                        * 02800002
*        7) IF THE VOLUME IS REJECTED (REPLY OF M), THEN TRANSFER     * 02850002
*        CONTROL TO IFG0552N, BRANCH CODE = 0, TO ASK FOR A NEW VOL.  * 02900002
*        8) IF THE VOLUME IS ACCEPTED, PERFORM CHECKPOINT DATA SET    * 02950002
*        PROCESSING.                                                  * 03000002
*        9) REWINDS THE TAPE, CLEARS THE LABEL AREA, AND REREADS THE  * 03050002
*        VOLUME LABEL. IF THE FIRST 4 CHARACTERS OF THE LABEL ARE     * 03100002
*        CORRECT (VOL1), THEN THE LABEL IS REWRITTEN; OTHERWISE, THE  * 03150002
*        LABEL IS REBUILT (AND TRANSLATED IF ASCII), AND REWRITTEN.   * 03200002
*        THE TEST FOR ERRORS IS IN THE NEXT MODULE.                   * 03250002
*        10) TRANSFER CONTROL TO IFG0552D, BRANCH CODE = 0.           * 03300002
*                                                                     * 03350002
* NOTES = SEE BELOW                                                   * 03400002
*                                                                     * 03450002
*    DEPENDENCIES =                                                   * 03500002
*            CLASS ONE CHARACTER CODE.  THE EBCDIC CHARACTER CODE     * 03550002
*            WAS USED FOR ASSEMBLY.  THE MODULE MUST BE REASSEMBLED   * 03600002
*            IF A DIFFERENT CHARACTER SET IS USED FOR EXECUTION.      * 03650002
*                                                                     * 03700002
*    RESTRICTIONS = NONE                                              * 03750002
*                                                                     * 03800002
*    REGISTER CONVENTIONS =                                           * 03850002
*            R2 POINTS TO DCB                                         * 03900002
*            R4 POINTS TO OPEN WORK AREA                              * 03950002
*            R5 POINTS TO THE RESIDENT ROUTINE                        * 04000002
*            R6 POINTS TO THE WTG TABLE                               * 04050002
*            R7 POINTS TO THE CURRENT PARAMETER LIST ENTRY            * 04100002
*            R8 POINTS TO THE CURRENT WTG TABLE ENTRY                 * 04150002
*            R9 POINTS TO THE DD ENTRY IN THE TIOT                    * 04200002
*            R10 POINTS TO THE UCB                                    * 04250002
*                                                                     * 04300002
*    PATCH LABEL = SEE THIRD FROM LAST LABEL BEFORE ORG STATEMENT AT  * 04350002
*                  END OF LISTING.                                    * 04400002
*                                                                     * 04450002
* MODULE TYPE = CONTROL (OPEN, CLOSE, EOV DATA MANAGEMENT)            * 04500002
*                                                                     * 04550002
*    PROCESSOR = ASSEMBLER XF                                         * 04600002
*                                                                     * 04650002
*    MODULE SIZE = SEE EXTERNAL SYMBOL DICTIONARY OR LOC FIELD ON     * 04700002
*                  ORG STATEMENT AT END OF LISTING                    * 04750002
*                                                                     * 04800002
*    ATTRIBUTES = REENTRANT, REFRESHABLE,READ-ONLY, ENABLED,          * 04850002
*                 PRIVILEGED, SUPERVISOR STATE, DATA MANAGEMENT KEY,  * 04900002
*                 LINK PACK AREA RESIDENT/PAGEABLE                    * 04950002
*                                                                     * 05000002
* ENTRY POINT =                                                       * 05050002
*        IFG0552B                                                     * 05100002
*                                                                     * 05150002
*    PURPOSE = SEE FUNCTION                                           * 05200002
*                                                                     * 05250002
*    LINKAGE =                                                        * 05300002
*        THIS MODULE IS TRANSFERRED CONTROL THROUGH THE IECRES-LOAD   * 05350002
*        MACRO INSTRUCTION.                                           * 05400002
*                                                                     * 05450002
* INPUT =                                                             * 05500002
*        GIVEN CONTROL IN PROTECT KEY 5.                              * 05550002
*        REGISTER 2 POINTS TO THE COPIED DCB.                         * 05600002
*        DEBDCBAD POINTS TO THE COPIED DCB.                           * 05650002
*        REGISTER 4 POINTS TO THE EOV WORKAREA                        * 05700002
*                                                                     * 05750002
* OUTPUT =                                                            * 05800002
*        THE NEXT MODULE IS GIVEN CONTROL IN PROTECT KEY 5 WITH       * 05850002
*        REGISTER 2 POINTING TO THE COPIED DCB,                       * 05900002
*        DEBDCBAD POINTING TO THE COPIED DCB,                         * 05950002
*        AND REGISTER 4 POINTING TO THE EOV WORKAREA,                 * 06000002
*                                                                     * 06050002
* EXIT-NORMAL =                                                       * 06100002
*        IFG0552D - WAIT VOL LABEL REWRITE, BRANCH CODE = 0           * 06150002
*        IFG0554J - ISSUE EXPIR. DATE MSG, BRANCH CODE = 20           * 06200002
*                   ISSUE SECURE VOL. MSG, BRANCH CODE = 40           * 06250002
*                   ISSUE ASCII DISMOUNT MSG, BRANCH CODE = 8         * 06300002
*        IFG0552F - NL/BLP, BRANCH CODE = 4                           * 06350002
*        IFG0552N - I/O ERROR, NEW VOL., BRANCH CODE = 0              * 06400002
*        IFG0555T - CHECK PSWD FOR SECURITY PROTECT, BRANCH CODE = 0  * 06410002
*            RETURN MOD = IFG0552B, BRANCH CODE = 20                  * 06420002
*                                                                     * 06450002
* EXIT-ERROR =                                                        * 06500002
*                                                                     * 06550002
* EXTERNAL REFERENCES = SEE BELOW                                     * 06600002
*                                                                     * 06650002
*    ROUTINES =                                                       * 06700002
*        IFG019RA THROUGH THE IECRES MACRO.                           * 06750002
*                                                                     * 06800002
*    DATA AREAS =                                                     * 06850002
*        EOV WORKAREA.                                                * 06900002
*                                                                     * 06950002
*    CONTROL BLOCK =                                                  * 07000002
*        CVT                                                          * 07050002
*        DEB                                                          * 07100002
*        JFCB                                                         * 07150002
*        TCB                                                          * 07200002
*        UCB                                                          * 07250002
*                                                                     * 07300002
* TABLES =                                                            * 07350002
*                                                                     * 07400002
* MACROS =                                                            * 07450002
*        MODESET                                                      * 07500002
*        IECRES LOAD                                                  * 07550002
*        IECRES WAIT                                                  * 07600002
*        IECRES INIT                                                  * 07650002
*        EXCP                                                         * 07700002
*        WAIT                                                         * 07750002
*        XLATE                                                        * 07800002
*                                                                     * 07850002
* CHANGE ACTIVITY =                                                   * 07900002
*        SEE CHANGES/DELETIONS SECTION JUST AFTER CSECT CARD.         * 07950002
*                                                                     * 08000002
*********************************************************************** 08050002
         EJECT                                                          08100002
*                                                                       27600002
*        INTERNAL ABEND CODES                                           27650002
*                                                                       27700002
EABD108  EQU   108                      EXPIRATION DATE NOT PASS YM5718 27750002
EABD109  EQU   109                      PASSWORD PROTECTION IN   YM5718 27770002
*                                       JFCB NOT MATCH HDR LABEL YM5718 27780002
EABD144  EQU   144                      I/O ERROR READING/REWIND YM8520 27790002
EABD249  EQU   249                      ASCII ACCESS BYT NONBLNK YM5718 27792002
*                   ADDRESSABILITY                                      27800021
         SPACE 1                                                        28000021
         BALR  RBASE,0                  ESTABLISH BASE                  28200021
         USING *,RBASE                                                  28400021
         USING FORCORE,RCORE                                            28600021
         USING WTG,RWTG                 BASE OF WTG TABLE        Y02080 28650002
         USING DEBBASIC,RDEB                                   @G32DSMI 28800032
         USING IHADCB,RDCB                                              29000021
         USING TIOENTRY,RTIOT                                           29200021
         USING SRT,RUCB                                                 29400021
         SPACE 1                                                        29600021
         B     ETO14400(RET)            BRANCH TO BRANCH TABLE   Y02134 29800002
*                                                                Y02134 29850002
ETO14400 EQU   *                        BRANCH TABLE             Y02134 29900002
*                                                                Y02134 29950002
         B     ETO14500                 BRANCH INITIAL ENTRY     Y02134 29960002
         B     ETO17000                 BRANCH EXPIRATION DATE   Y02134 29970002
         B     ETO17120                 FROM QUERY CHKPT STATUS  Y02083 29972002
         B     ETO17200                 FROM REVOKE CHKPT STATUS Y02083 29974002
         B     ETO17170                 FROM REQ TO CHKPT MSG    Y02083 29976002
         B     ETO16860                 RETURN FROM PASSWORD     Y02082 29978002
*                                                                Y02134 30000002
         EJECT                                                          30010002
*                                                                Y02134 30020002
*****************************************************************Y02134 30030002
*                                                                Y02134 30040002
*  SET UP THE DESIRED DENSITY FOR THE TAPE VOLUME LABEL REWRITE.        30050002
*  CONTINUE TO READ HEADER LABELS AT THE CURRENT DENSITY.               30100002
*                                                                Y02134 30110002
*****************************************************************Y02134 30120002
*                                                                       30150002
ETO14500 EQU   *                        DENSITY                  Y02134 30160002
*                                                                Y02134 30162002
         L     RDEB,DCBDEBAD            LOAD DEB ADDRESS         Y02134 30170002
         STCM  RUCB,B'0111',DEBSUCBB    PUT UNIT ADDR INTO DEB @G32DSMI 30172032
*                                                                       30178032
         TM    DCBMACRF,DCBMEXCP        TEST FOR EXCP          @ZA32147 30180000
         BO    ETO14600                 BR, IF EXCP            @ZA32147 30190237
         TM    DCBCIND2,DCBC2PUT        EOV CALLED BY CLOSE?   @ZA32147 30190437
         BNO   ETO14600                 NO, BYPASS CL/EOV BIT  @ZA32147 30190637
         OI    DEBFLGS1,DEBF1CEV        IND TO CLOSE THAT EOV  @ZA32147 30190837
*                                       WAS CALLED BY QSAM     @ZA32147 30191037
ETO14600 MVC   DEBSDVM,DXDEBMOD         SET MODE & DENSITY     @G32DSMI 30191200
         TM    UCBTBYT2,UCB3TAPE        TEST FOR 7 TRK TAPE      Y02134 30192002
         BNO   ETO14800                 BRANCH IF NOT 7-TRK      Y02134 30194002
*                                                                       30198002
*              SET UP DEBDVMOD WITH TRTCH AND DENSITY                   30198402
*                                                                       30198802
         MVC   DEBSDVM,DCBDEN           DENSITY                @G32DSMI 30289932
         OC    DEBSDVM,DCBTRTCH         TAPE RECORDING TECH    @G32DSMI 30290932
ETOHEX38 EQU   X'38'                    TAPE RECORD TECH MASK           30291932
ETOHEX30 EQU   X'30'                    DEBDVMOD MASK                   30292932
         TM    DEBSDVM,ETOHEX38         WAS TRTCH SPECIFIED    @G32DSMI 30293932
         BNZ   ETO14800                 YES, BRANCH                     30294932
         OI    DEBSDVM,ETOHEX30         ASSUME XLATE,NO CONVERT@G32DSMI 30295932
*                                       ODD PARITY, LOW DENSITY         30298302
*                                                                       30298702
         EJECT                                                          30298802
*                                                                       30299102
ETO14800 EQU   *                        CHECK FOR NSL                   30299502
         TM    JFCBLTYP,JFCNSL          NSL SPEC                        30313102
         BNO   ETO15700                 BR IF NSL NOT SPEC       YM3841 30319802
ETO15200 EQU   *                        NSL                             30333202
*                                                                Y02082 30335202
* COPY THE DCB FROM THE WORK AREA TO USER'S STORAGE              Y02082 30337202
*                                                                Y02082 30339202
         IECRES INIT,DCBCOPY=FRWKAR,STM=(3,14,WTGPREFX)          Y02082 30341202
*                                                                Y02082 30341602
         OI    DXOPCLSW,HEX40           IND ENTRY TO NSLEHDRO           30343202
         MODESET EXTKEY=SUPR            ASSUME KEY ZERO          Y02082 30345202
         NI    UCBDMCT,ALLBITS-UCBMOUNT CLEAR MOUNT FLAG IN UCB  Y02080 30353202
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY      Y02082 30355202
         MVC   DXXMODNM,NSLEHDRO        CHANGE TO NSLEHDRO       Y02134 30363202
         LR    R8,RES                   SAVE RES PTR                    30366002
         LR    RES,RDEB                 PUT DEB IN R5 FOR NSL           30366402
         L     RDCB,DXPDCBAD            PASS ADDR COPY DCB       YM5702 30376402
         OI    DXATOUTA,DXATNSL         CONTROL TO NSL ROUTINE   Y02144 30376502
         L     RF,DXATCOM3              GET RRPLIST PTR          Y02144 30386402
         USING RRPLIST,RF                                        Y02144 30386802
         OI    RRFLAGS1,RRFNSL          SET NSL GIVEN CONTROL    Y02144 30387202
         CLC   DXVOLSR2,SCRTCH          SCRATCH REQUEST?       @ZA02874 30389237
         BNE   ETO15225                 NO, BR                 @ZA02874 30391237
         MVC   DXCCW7(L'UCBVOLI),UCBVOLI SAVE VOL SER FOR 552N @ZA02874 30391637
ETO15225 EQU   *                                               @ZA02874 30392037
         SR    RET,RET                  BR ENTRY RETURN FOR 552N YM5315 30392902
         MODESET EXTKEY=ZERO            ASSUME KEY ZERO          YM2866 30399202
         IECRES LOAD,PREFIX=DXXPREFX,BRANCH=DIRECT XCTL BY NAME  Y02080 30404902
*                                                                       30410602
         EJECT                                                          30416302
*                                                                Y02134 30422002
ETO15700 EQU   *                        NOT NSL                  Y02134 30424002
*                                                                Y02134 30433402
*        INITIALIZE UCB FILE SEQUENCE NUMBER/COUNT               YM6559 30433502
         MODESET EXTKEY=SUPR            ASSUME KEY ZERO          YM6559 30434002
         MVC   SRTEFSEQ(K2),DXCCW7+K6   GET SAVED LOG COUNT      YM6559 30434602
         MVC   SRTEFSCT(K2),CONSTONE    SET PHYSICAL TO 1        YM6559 30435202
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY      YM6559 30435802
         LA    R7,ID2B2F                SET UP NL/BLP LOAD       Y02134 30439102
         LA    RET,K4                   LOAD ENTRY CODE          Y02134 30444802
         TM    JFCBLTYP,JFCBAL+JFCSL    TEST FOR SL OR AL        Y02134 30450502
         BZ    ETO17400                 BRANCH IF NEITHER        Y02134 30456202
*                                                                Y02134 30461902
*                                                                       30467602
*        RE-ESTABLISH 17 LAST SIGNIFICANT NON-BLANK CHARACTERS   YM3880 30473302
*        IN DATASET NAME - USED IN SECURITY CHECK AND TO         YM3880 30479002
*        CONSTRUCT NEW LABEL                                     YM3880 30484702
*                                                                       30490402
         LA    RET,JFCBDSNM+(L'JFCBDSNM-K17) ADDR OF LAST 17     YM3880 30496102
*                                       CHARACTERS               YM3880 30501802
ETO15710 EQU   *                        IS 17TH CHAR BLANK       YM3880 30507502
         CLI   K16(RET),BLANK           STOP SCAN IF NOT BLANK   YM3880 30513202
         BNE   ETO15720                 BRANCH IF NOT BLANK      YM3880 30518902
         BCT   RET,ETO15710             REDUCE RET BY ONE        YM3880 30524602
ETO15720 EQU   *                        SEE IF DSN LESS THAN 17  YM3880 30530302
         LA    RF,JFCBDSNM              DSN ADDRESS              YM3880 30536002
         CR    RF,RET                   RET BACKED UP TOO FAR    YM3880 30541702
         BL    ETO15730                 BRANCH IF NOT            YM3880 30547402
         LR    RET,RF                   SET TO START OF DSN      YM3880 30553102
ETO15730 EQU   *                        SAVE ADDR                YM3880 30558802
         ST    RET,DXCCW4               SAVE IN DXCCW4           YM3880 30564502
*                                                                       30570202
*        FIND ADDR OF GENERATION & VERSION NUMBER IF GDG         YM3880 30575902
*                                                                       30581602
         CLI   JFCBELNM+K1,BLANK        IS IT A GDG              YM3880 30587302
         BE    ETO15760                 BRANCH IF NO             YM3880 30593002
         LA    RET,JFCBDSNM+(L'JFCBDSNM-K1-K9) LAST CHAR - 9     YM3880 30598702
ETO15740 EQU   *                        FIND LAST NON-BLANK CHAR YM3880 30604402
         CLI   K9(RET),BLANK            STOP SCAN IF NOT BLANK   YM3880 30610102
         BNE   ETO15750                 BRANCH IF NOT BLANK      YM3880 30615802
         BCT   RET,ETO15740             CONTINUE SCAN            YM3880 30621502
ETO15750 EQU   *                        SAVE GEN/VER ADDR        YM3880 30627202
         ST    RET,DXCCW4+K4            SAVE IN DXCCW4+4         YM3880 30632902
ETO15760 EQU   *                        READ THOSE LABELS        YM3880 30638602
*                                                                       30644302
*              SET UP CHANNEL PROGRAM AND READ LABEL                    30650002
*              IT IS ASSUMED THAT THE TAPE IS CURRENTLY POSITIONED      30650502
*              JUST AFTER THE VOL1 LABEL BY IFG0554F             Y02134 30800002
*                                                                       31000021
         MVC   DXCCW1,ACCW              SET UP BASIC CCW                31200021
*                                                                       31400021
ETO15800 EQU   *                        FIND HEADER LABEL 1             31600021
         SPACE                                                          31800021
         BAL   RWTG,ETO17600            GO READ AGAIN                   32000021
         LA    RWTG,DXXAREA             RESTORE REG RWTG         YM3841 32050002
         SPACE                                                          32200021
ETO15900 EQU   *                        CHECK FOR VOLUME LABEL          32400021
         TM    JFCBLTYP,JFCBAL          WERE ANSI LABEL SPEC            32600021
         BZ    ETO16100                 NO, CONTINUE PROCESSING         32800021
         CLC   AHDR1,FL1LABI            EBCDIC HDR1 LABEL               33000021
         BNE   ETO16000                 NO, GO TRANSLATE LABEL          33200021
         CLI   FL1FSEC,CHAR0            SECURITY PROTECTED              33400021
         BNE   ETO16200                 MAYBE, GO CHECK SOME MORE       33600021
         MVI   FL1FSEC,BLANK            NO SECURITY PROTECT             33800021
         B     ETO16900                 CONTINUE PROCESSING      Y02134 34000002
         EJECT                                                          34050002
*                                                                Y02134 34060002
*****************************************************************Y02134 34100002
*                                                                Y02134 34150002
*        TRANSLATE LABEL BEFORE PROCESSING                       Y02134 34200002
*                                                                Y02134 34250002
*****************************************************************Y02134 34300002
*                                                                Y02134 34350002
ETO16000 XLATE DXLBL,K80                TRANSLATE LABEL                 34400021
         CLC   VOLLABI(K3),UVOL0G       IS THIS A USER VOL LABEL        34600021
         BE    ETO15800                 YES, GO READ AGAIN              34800021
ETO16100 EQU   *                        CHECK FOR VOL LABEL             35000021
         SPACE                                                          35200021
         CLI   VOLLABI,CHARV            IF THIS IS VOLUME LABEL         35400021
         BE    ETO15800                 YES, GO READ AGAIN              35600021
         SPACE                                                          35800021
         CLC   AHDR1,FL1LABI            TEST FOR HDR 1                  36000021
         BE    ETO16200                 BR YES TO CHK SECURITY          36200021
         SPACE                                                          36400021
         TM    IOBSTAT0,CSWUNITX        CHK FOR UNIT EXCEPTION          36600021
         BZ    ETO17900                 NO, GO ASK FOR NEW VOLUME       36800021
         B     ETO17100                 BR TO PROCESS LABEL             37000021
*                                                                       37200021
         SPACE 1                                                        37400021
ETO16200 EQU   *                        CHECK FOR SECURITY              37600002
*              DETERMINE IF DATA SET SECURITY IS INCONSISTENT WITH    * 37800002
*              JFCB. DEMOUNT THE VOLUME IF IT IS. OTHERWISE GO   Y02082 37804002
*              TO CHECK PASSWORD IF DATA SET IS PROTECTED.       Y02082 37806002
*                                                                       38200021
         CLI   FL1FSEC,CHAR1            HDR READ INDICATES SECURITY     38400021
         BNE   ETO16300                 BRANCH IF NO                    38600021
         TM    JFCBIND2,JFCBRWPW        JFCB SPECIFY SECURITY IS FOR    38800021
*                                       READ AND WRITE                  39000021
         BM    ETO16400                 YES, BRANCH                     39200021
         B     ETO18500                 NO, MOUNT A SCRATCH VOLUME      39400021
ETO16300 EQU   *                        NO SECURITY IN HEADER           39600002
         CLI   FL1FSEC,FL1WRSEC         IS SECURITY FOR WRITE ONLY      39800021
         BNE   ETO16800                 NO, BRANCH                      40000021
         TM    JFCBIND2,JFCBRWPW        JFCB SPECIFY SECURITY IS FOR    40200021
*                                       WRITE ONLY                      40400021
         BNO   ETO18500                 NO, MOUNT A SCRATCH VOLUME      40600021
ETO16400 EQU   *                        GET STARTING ADR OF DSN         40800021
         LM    RET,RF,DXCCW4            SAVED BY TRL LBL MODULE         41000021
ETO16500 CLC   FL1ID,K0(RET)            HDR ID EQ JFCBDSNM              41200021
         BE    ETO16850                 YES, CHECK PASSWORD      Y02082 41402002
         CLI   JFCBELNM+K1,BLANK        IS THIS A GDG                   41600021
         BE    ETO18500                 NO, BYPASS DOS TESTS            41800021
         CLC   FL1GNO,K3(RF)            IS GEN NO EQ                    42000021
         BNE   ETO18500                 NO, BR                          42200021
         CLC   FL1VNG,K8(RF)            IS VER NO EQ                    42400021
         BNE   ETO18500                 NO, BR                          42600021
         LA    R0,K9                    FIND LENGTH OF DSN              42800021
         SR    RET,R0                   WITHOUT GENERATION NO           43000021
         LA    R0,JFCBDSNM              POINT TO START OF DSN           43200021
         CLR   RET,R0                   IS DSN STILL MORE THAN 17       43400021
         BNL   ETO16600                 BR, YES COMP LAST 17 OF DSN     43600021
         LR    RET,R0                   SET RD TO START OF NAME         43800021
         SR    RF,RET                   GET NO CHARS IN DSN             44000021
         LA    R1,FL1ID(RF)             POINT TO END OF DSN             44200021
         CLI   K1(R1),BLANK             IN LABEL                        44400021
         BNE   ETO18500                 BR, MUST BE DIFF LENGTH         44600021
         EX    RF,ETO16700              DSN WITHOUT GDG NO.             44800021
         BNE   ETO18500                 GO ASK FOR NEW TAPE             45000021
         B     ETO16850                 GO CHECK PASSWORD        Y02082 45202002
ETO16600 EX    R0,ETO16500              COMP 17 CHAR W/O GEN NO.        45400021
         BNE   ETO18500                 GO GET NEW TAPE                 45600021
         B     ETO16850                 GO CHECK PASSWORD        Y02082 45802002
ETO16700 CLC   FL1ID(K0),K0(RET)        MOVE DSNAME                     46000002
ETO16800 EQU   *                        READ/WRITE SECURITY             46200002
         TM    JFCBLTYP,JFCBAL          WERE ANSI LABEL SPEC.           46400021
         BZ    ETO16900                 NO, CHECK EXPIRE DATE    YM3841 46602002
         CLI   FL1FSEC,BLANK            UNLIMITED ACCESS TO D.S.        46800021
         BNE   ETO18500                 NO, CAN'T USE VOLUME            47000021
         B     ETO16900                 CHECK EXPIRATION DATE    YM8520 47010002
         EJECT                                                          47050002
ETO16850 EQU   *                        GO TO VERIFY PASSWORD    Y02082 47052002
         MVC   DXRETMOD(K5),ID2B2B      SET UP RETURN            Y02082 47054002
         MVI   DXRETCOD,K20             SET UP RETURN CODE       Y02082 47056002
         NI    DEBFLGS1,X'FF'-DEBPWCKD  TURN OFF PASSWORD BIT    Y02082 47058002
         IECRES LOAD,MODID=ID2B5T,BRCODE=K0,BRANCH=QUEUED        Y02082 47060002
ETO16860 EQU   *                        RETURN FROM PASSWORD     Y02082 47062002
         OI    DEBFLGS1,DEBPWCKD        TURN ON PASSWORD BIT     Y02082 47064002
*                                                                Y02134 47100002
*****************************************************************Y02134 47150002
*                                                                Y02134 47160002
*        CHECK EXPIRATION DATE                                   Y02134 47170002
*                                                                Y02134 47180002
*****************************************************************Y02134 47190002
*                                                                Y02134 47192002
ETO16900 EQU   *                        EXPIRATION DATE CHK      Y02134 47194002
*                                                                Y02134 47196002
         XC    DXWORK,DXWORK            CLEAR WORK AREA          Y02134 47198002
         PACK  DXWORK(K4),FL1EXPDT+K1(K5)  EBCDIC TO DECIMAL     YM5368 47198402
         L     R1,CVTPTR                LOAD CVT ADDRESS         Y02080 47198802
         USING CVT,R1                   R1 POINTS TO CVT         Y02134 47198902
         CLC   CVTDATE,DXWORK           CHECK IF DATE EXPIRED    Y02080 47199202
         DROP  R1                                                Y02134 47199302
         BNL   ETO17100                 BRANCH IF DATE PASSED    Y02134 47199602
*                                                                Y02134 47199702
*****************************************************************Y02134 47199802
*                                                                Y02134 47199902
*        GO TO ERROR ROUTINE TO WRITE EXPIRATION DATE            Y02134 47249902
*        ERROR MESSAGE TO THE OPERATOR, AND WAIT FOR             Y02134 47259902
*        HIS REPLY TO USE OR NOT USE THE DATA SET.               Y02134 47269902
*                                                                Y02134 47279902
*****************************************************************Y02134 47289902
*                                                                Y02134 47291902
ETO16950 EQU   *                        GO TO ERROR ROUTINE             47293902
*                                                                Y02134 47295902
         MVC   DXRETMOD,ID2B2B          RETURN ID TO SAVE AREA   Y02134 47297902
         MVI   DXRETCOD,K4              SET RETURN INDICATOR     Y02134 47298302
*                                                                Y02134 47298702
         XC    DXWORK1,DXWORK1          SET REPLY AREA TO BLANKS Y02134 47299102
         LA    R1,DXWORK1               POINT TO REPLY AREA      Y02134 47299502
         LA    R0,K1                    SET REPLY LENGTH         Y02134 47299602
         SLL   R0,K24                   MOVE LENGTH TO HI BYTE   Y02134 47299702
         OR    R1,R0                    SET UP WTOR PARM         Y02134 47299802
         LA    R0,FL1ID                 GET DSNAME ADDRESS       Y02134 47333202
         MVI   FL1ID+L'FL1ID,BLANK      DELIMIT 17 CHAR NAME     Y02134 47343202
         MVC   FL1ID+L'FL1ID+K1(L'JFCBDSNM-L'FL1ID-K1),FL1ID+L'FL1ID    47353202
*                                                                Y02134 47363202
         IECRES LOAD,MODID=ID2B4J,BRCODE=K20,BRANCH=QUEUED       Y02134 47365202
*                                                                Y02134 47365602
*****************************************************************Y02134 47366002
*                                                                Y02134 47366402
*        RETURN HERE FROM EXPIRATION CHECK                       Y02134 47366502
*                                                                Y02134 47377602
*****************************************************************Y02134 47387602
*                                                                Y02134 47388002
ETO17000 EQU   *                        RET FROM EXPIR DATE CHK  Y02134 47388402
*                                                                Y02134 47388802
         IECRES WAIT                    WAIT FOR OPERATOR REPLY  Y02134 47392502
*                                                                Y02134 47394502
         OI    DXWORK1,BLANK            FOLD REPLY               Y02134 47394902
         CLI   DXWORK1,CHARU            CHECK FOR REPLY U        Y02134 47395302
         BE    ETO17100                 BRANCH TO USE            Y02134 47395702
*                                                                Y02134 47396102
         CLI   DXWORK1,CHARM            CHECK IF REJECT          Y02134 47396202
         BNE   ETO16950                 BRANCH, INCORRECT REPLY  Y02134 47446202
*                                                                Y02134 47456202
         LA    R0,EABD108               ABEND 137-24             YM5718 47458202
         B     ETO17900                 BRANCH TO REJECT VOLUME  Y02134 47466202
         EJECT                                                          47476202
*                                                                Y02083 47478202
*****************************************************************Y02083 47480202
*                                                                Y02083 47482202
*        CHECKPOINT DATA SET PROCESSING                          Y02083 47484202
*                                                                Y02083 47486202
*****************************************************************Y02083 47488202
*                                                                Y02083 47490202
ETO17100 EQU   *                        CHKPT/RESTART PROC       Y02083 47492202
         CLC   AHDR1,FL1LABI            TEST FOR HDR 1           Y02083 47494202
         BNE   ETO17150                 IF NOT, BYPASS WTOR    @ZA09625 47496237
         BAL   RWTG,ETO17600            GO READ HDR 2            Y02083 47498202
         LA    RWTG,DXXAREA             RESTORE REG RWTG         YM3841 47498602
         CLC   AHDR2,FL1LABI            TEST FOR HDR 2           Y02083 47500202
         BNE   ETO17150                 IF NOT, BYPASS WTOR    @ZA09625 47502237
         CLI   FL2DSIND,FL2CKDS         TEST FOR CHKPT D/S       Y02083 47504202
         BNE   ETO17150                 IF NOT, BYPASS WTOR      Y02083 47506202
*                                                                Y02083 47508202
*        ASK OPERATOR IF VOLUME IS SECURE                        Y02083 47510202
*                                                                Y02083 47512202
ETO17110 MVC   DXRETMOD,ID2B2B          SET RETURN NAME & EPA    Y02083 47514202
         MVI   DXRETCOD,K8              SET BR TABLE RETURN CODE Y02083 47516202
         XC    DXWORK1,DXWORK1          CLEAR WTOR REPLY AREA    Y02083 47518202
         LA    R1,DXWORK1               POINT TO REPLY AREA      Y02083 47520202
         LA    R0,K3                    SET REPLY LENGTH         Y02083 47522202
         SLL   R0,K24                   MOVE LENGTH TO HI BYTE   Y02083 47524202
         OR    R1,R0                    SET UP WTOR PARM         Y02083 47526202
         IECRES LOAD,MODID=ID2B4J,BRCODE=K56,BRANCH=QUEUED       Y02083 47528202
ETO17120 IECRES WAIT                    WAIT FOR REPLY           Y02083 47530202
         OC    DXWORK1,BLANKS           FOLD REPLY TO UPPER CASE Y02083 47532202
         CLC   KNO,DXWORK1              REPLY = 'NO'             Y02083 47534202
         BE    ETO17150                 IF 'NO', BRANCH          Y02083 47536202
         CLC   KYES,DXWORK1             REPLY = 'YES'            Y02083 47538202
         BNE   ETO17110                 IF NOT, TRY AGAIN        Y02083 47540202
         L     R1,DXDSAB                FETCH DSAB ADDRESS       Y02083 47542202
         TM    DSABFLG4-DSAB(R1),DSABCKDS TEST FOR CHKPT D/S     Y02083 47544202
         BO    ETO17180                 IF YES, GO SET SECURE FLGY02083 47546202
*                                                                Y02083 47548202
*        TELL OPERATOR VOLUME IS NO LONGER SECURE                Y02083 47550202
*                                                                Y02083 47552202
ETO17130 MVC   DXRETMOD,ID2B2B          SET RETURN NAME & EPA    Y02083 47554202
         MVI   DXRETCOD,K12             SET BR TABLE RETURN CODE Y02083 47556202
         IECRES LOAD,MODID=ID2B4J,BRCODE=K60,BRANCH=QUEUED       Y02083 47558202
*                                                                Y02083 47560202
*        IF USER INTENDS TO USE D/S FOR CHECKPOINTING, SEE       Y02083 47562202
*        IF VOLUME CAN BE MADE SECURE                            Y02083 47564202
*                                                                Y02083 47566202
ETO17150 L     R1,DXDSAB                FETCH DSAB ADDRESS       Y02083 47568202
         TM    DSABFLG4-DSAB(R1),DSABCKDS TEST FOR CHKPT D/S     Y02083 47570202
         BZ    ETO17200                 IF NOT, CONTINUE         Y02083 47572202
ETO17160 MVC   DXRETMOD,ID2B2B          SET RETURN NAME & EPA    Y02083 47574202
         MVI   DXRETCOD,K16             SET BR TABLE RETURN CODE Y02083 47576202
         XC    DXWORK1,DXWORK1          CLEAR WTOR REPLY AREA    Y02083 47578202
         LA    R1,DXWORK1               POINT TO REPLY AREA      Y02083 47580202
         LA    R0,K3                    SET REPLY LENGTH         Y02083 47582202
         SLL   R0,K24                   MOVE LENGTH TO HI BYTE   Y02083 47584202
         OR    R1,R0                    SET UP WTOR PARM         Y02083 47586202
         IECRES LOAD,MODID=ID2B4J,BRCODE=K52,BRANCH=QUEUED       Y02083 47588202
ETO17170 IECRES WAIT                    WAIT FOR REPLY           Y02083 47590202
         OC    DXWORK1,BLANKS           FOLD REPLY TO UPPER CASE Y02083 47592202
         CLC   KYES,DXWORK1             REPLY = 'YES'            Y02083 47594202
         BE    ETO17180                 IF YES, BRANCH           Y02083 47596202
         CLC   KNO,DXWORK1              REPLY = 'NO'             Y02083 47598202
         BNE   ETO17160                 IF NOT, TRY AGAIN        Y02083 47600202
*                                                                Y02083 47602202
*        AT THIS POINT IT IS FOUND THAT A SUBSEQUENT VOLUME      Y02083 47604202
*        OF A CHECKPOINT D/S CAN NOT BE MADE SECURE, SO ISSUE    Y02083 47606202
*        ABEND 937-10                                            Y02083 47608202
*                                                                Y02083 47610202
         LA    R0,EABD240               LOAD INTERNAL ABEND CODE Y02083 47612202
         DMABCOND (R0),ID2B0P           GO ABEND                 Y02083 47614202
*                                                                Y02083 47616202
*        SET THE VOLUME SECURE INDICATOR IN THE DSAB             Y02083 47618202
*                                                                Y02083 47620202
ETO17180 L     R1,DXDSAB                FETCH DSAB ADDRESS       Y02083 47622202
         MODESET EXTKEY=SCHED           DSAB KEY                 Y02083 47624202
         OI    DSABFLG4-DSAB(R1),DSABCKVL SET SECURE VOL IND     Y02083 47626202
         MODESET EXTKEY=DATAMGT         BACK TO D/M KEY          Y02083 47628202
         B     ETO17200                 CONTINUE                 Y02083 47630202
         EJECT                                                          47632202
*                                                                       49000021
*********************************************************************** 49200021
*                                                                       49400021
*  REREAD VOLUME LABEL AND REWRITE IT, POSSIBLY IN A DIFFERENT DENSITY  49600021
*                                                                       49650002
*********************************************************************** 49700002
*                                                                       49800021
ETO17200 EQU   *                        VOLUME LABEL PROC        Y02083 50000002
*                                                                       50050002
         BAL   RWTG,ETO17500            GO REWIND, CLEAR AND READ       50200021
         SPACE                                                          50400021
         CLI   VOLLABI,CHARV            CHECK TAPE CONTAINS VOLID       50600021
         BE    ETO17300                 BR TO BUILD CHANNEL PROG        50800021
         CLI   VOLLABI,ASCIIV           DOES TAPE HAVE ANSI LABEL       51000021
         BE    ETO17300                 YES, WRITE LABEL                51200021
         SPACE                                                          51400021
         MVI   VOLLABI,BLANK            CLEAR                           51600021
         MVC   VOLLABI+K1(L'DXLBL-K1),VOLLABI LABEL AREA                51800002
         SPACE                                                          52000021
         MVC   VOLLABI(K4),AVOL         VOL LBL IDENTIFIER              52200021
         MVC   VOLSERNO,UCBVOLI         VOLUME SERIAL NUMBER            52400021
         MVI   VOLSEC,K0                SECURITY CODE                   52600021
         TM    JFCBLTYP,JFCBAL          WERE ANSI LABEL SPEC.           52800021
         BNO   ETO17300                 NO, GO WRITE LABEL              53000021
         MVI   VOLSEC,BLANK             SET ACCESSIBILITY BLANK         53200021
         MVI   LABSTAND,CHAR1           SET LABEL STANDARD BYTE         53400021
         XLATE DXLBL,K80,TO=A           TO ASCII                        53800021
         SPACE                                                          54000021
ETO17300 EQU   *                        BUILD CCW'S AND RACDEF @G32DSMI 54200032
         SPACE                                                          54400021
         L     R7,DXJSCBAD              ADDRESS OF JSCB        @G32DSMI 54406032
         USING IEZJSCB,R7                                      @G32DSMI 54412032
         TM    JSCBSWT1,JSCBPASS        JSCB PASS SPECIFIED    @G32DSMI 54418032
         BO    ETO17350                 YES - SKIP RACDEF      @G32DSMI 54424032
         DROP  R7                                              @G32DSMI 54430032
         L     R7,CVTPTR                ADDRESS OF CVT         @G32DSMI 54436032
         USING CVT,R7                                          @G32DSMI 54442032
         L     R7,CVTRAC                ADDRESS OF RACF CVT    @G32DSMI 54448032
         LTR   R7,R7                    IS RACF ACTIVE         @G32DSMI 54454032
         BZ    ETO17350                 NO - SKIP RACDEF       @G32DSMI 54460032
         USING RCVT,R7                                         @G32DSMI 54466032
         TM    RCVTSTA1,RCVTTAPE        TAPE OPTION SET        @G32DSMI 54472032
         BZ    ETO17350                 NO - SKIP RACDEF       @G32DSMI 54478032
         L     R7,DXDEBXAD              ADDRESS OF THE DEB EXT @G32DSMI 54484032
         USING DEBXTN,R7                                       @G32DSMI 54490032
         TM    DEBXFLG1,DEBXDSSI        PREV VOL RACF DEFINED  @G32DSMI 54496032
         BZ    ETO17350                 NO - SKIP RACDEF       @G32DSMI 54502032
         DROP  R7                                              @G32DSMI 54508032
         TM    DXRCFLAG,DXRCOUT         TAPE ALREADY RACDEF-ED @G32DSMI 54514032
         BO    ETO17350                 YES - SKIP RACDEF      @G32DSMI 54520032
         MVC   DXCCW8(RACDFLEN),RACDFL  MOVE IN LIST FORM      @G32DSMI 54526032
         RACDEF ENTITY=DXOLDVOL,VOLSER=UCBVOLI,MF=(E,DXCCW8)   @ZM04449 54532032
         LTR   15,15                    RETURN CODE ZERO       @G32DSMI 54538032
         BZ    ETO17350                 YES CONTINUE           @G32DSMI 54544032
         LA    R0,EABD007               SET FOR 937-40         @G32DSMI 54550032
         LA    RWTG,DXXAREA             GET ADDR OF WTG TABLE  @ZM04476 54553032
         DMABCOND (R0),ID2B0P           GO ABEND               @G32DSMI 54556032
EABD007  EQU   7                                               @G32DSMI 54562032
ETO17350 EQU   *                        END RACF CODE          @G32DSMI 54568032
         MVI   DXCCW1,CCWREW            REWIND COMMAND                  54600021
         SPACE                                                          54800021
         BAL   R7,ETO17800              GO REWIND AGAIN                 55000021
         SPACE                                                          55200021
         MVI   DXCCW1,CCWWRTAP          1ST CCW IS WRITE VOL1           55400021
         SPACE                                                          55600021
         EXCP  DXIOB                    WRITE VOL1 NXT MOD CHKS ERR     55800021
         SR    RET,RET                  ZERO RETURN REG                 56000021
*                                                                       56200021
         LA    R7,MOD2D2B               SET R7 TO TTR                   57200021
         EJECT                                                          57250002
ETO17400 LA    RWTGC,DXXENTRY           SET R8 FOR RES RTN              57400021
         LA    RWTG,DXXAREA             POINT TO EOV WTG                57600021
         IECRES LOAD,MODID=(R7),BRANCH=QUEUED GO TO NEXT MODULE  Y02080 57850002
         EJECT                                                          57900002
         SPACE                                                          58000021
*                     REFRESH LABEL AREA                                58200021
         SPACE                                                          58400021
ETO17500 EQU   *                        REWIND, CLEAR AREA & READ       58600021
         SPACE                                                          58800021
         MVC   DXCCW1,ACCW              SET UP TO REWIND                59000021
         SPACE                                                          59200021
         BAL   R7,ETO17800              GO ISSUE REWIND AND WAIT        59400021
         SPACE                                                          59600021
ETO17600 EQU   *                        CLEAR AREA & READ               59800021
         SPACE                                                          60000021
         XC    DXLBL,DXLBL              CLEAR LABEL AREA                60200021
         SPACE                                                          60400021
ETO17700 EQU   *                        READ                            60600021
         SPACE                                                          60800021
         ST    RCORE,DXCCW1             GET ADDRESS OF READ AREA        61000021
         MVI   DXCCW1,CCWRDTAP          AND READ OP CODE                61200021
         MVI   DXCCW1,CCWRDTAP          AND READ OP CODE                61400021
         SPACE                                                          61600021
         BAL   R7,ETO17800              GO ISSUE READ AND WAIT          61800021
         SPACE                                                          62000021
         BR    RWTG                     RETURN TO MAIN LINE             62200021
         EJECT                                                          62250002
         SPACE                                                          62400021
*                   CLOSED SUBROUTINE TO ISSUE I/O OPERATIONS           62600021
         SPACE 1                                                        62800021
*                        IT IS ASSUMED THAT ALL CONTROL BLOCKS          63000021
*                        HAVE ALREADY BEEN SET UP                       63200021
         SPACE 1                                                        63400021
*                             BAL  R7,PRHR50                            63600021
*                             RETURN                                    63800021
         SPACE 1                                                        64000021
ETO17800 EXCP  DXIOB                    ISSUE I/O OPERATION             64200021
*                                                                       64400021
         WAIT  ,ECB=DXECB               WAIT FOR COMPLETION OF I/O OPER 64600021
*                                                                       64800021
         TM    DXECB,ECBNOERR           IS THERE AN UNUSUAL I/O COND    65000021
         BCR   1,R7                     NO - RETURN TO CALLER           65200021
         SPACE                                                          65400021
         TM    IOBSTAT0,CSWUNITX        CHK FOR UNIT EXCEPTION          65600021
         BCR   1,R7                     YES - IGNORE FOR NOW            65800021
         SPACE                                                          66000021
ETO17900 EQU   *                        I/O ERR GO ASK FOR NEW VOL      66200021
         LA    R0,EABD144               613-04 ABEND INDICATOR   YM8520 66250002
         SR    RET,RET                  ZERO RETURN REG                 66600021
         LA    R7,ID2B2N                GO TO REMOUNT            Y02134 66800002
         B     ETO17400                 BR TO DO XCTL                   67000021
         EJECT                                                          75400002
ETO18500 EQU   *                        CHECK FOR ASCII LABEL           75600002
         TM    JFCBLTYP,JFCBAL          IS THIS ASCII LABEL             75800021
         BO    ETO18700                 YES, BR                         76000021
*                                                                Y02134 76200002
*****************************************************************Y02134 76250002
*                                                                Y02134 76300002
*        GO ISSUE SEC VOL MESSAGE                                Y02134 76350002
*                                                                Y02134 76360002
*****************************************************************Y02134 76370002
*                                                                Y02134 76380002
         MVC   DXRETMOD,ID2B2N          SET UP RETURN LOAD       Y02134 76400002
         MVI   DXRETCOD,K0              RETURN OFFSET            Y02134 76450002
         LA    R0,EABD109               ABEND 937-24             YM5718 76460002
*                                                                Y02134 76500002
         IECRES LOAD,MODID=ID2B4J,BRCODE=K40,BRANCH=QUEUED       Y02134 76550002
*                                                                Y02134 76570002
*****************************************************************Y02134 76580002
*                                                                Y02134 76590002
*        GO ISSUE ASCII DISMOUNT MESSAGE                         Y02134 76592002
*                                                                Y02134 76594002
*****************************************************************Y02134 76596002
*                                                                Y02134 76598002
ETO18700 EQU   *                        ASCII DISMOUNT MSG       Y02134 76598102
*                                                                Y02134 76598202
         MVC   DXRETMOD,ID2B2N          SET UP RETURN LOAD       Y02134 76598402
         MVI   DXRETCOD,K0              RETURN OFFSET            Y02134 76598802
*                                                                Y02134 76598902
         LA    R1,K2                    SET ASCII ERROR CODE     Y02134 76599002
         LA    R0,EABD249               ABEND 937-20             YM5718 76599102
*                                                                Y02134 76599202
         IECRES LOAD,MODID=ID2B4J,BRCODE=K8,BRANCH=QUEUED        Y02134 76599602
*                                                                Y02134 76599702
         EJECT                                                          76649702
*                                                                Y02134 77450002
*****************************************************************Y02134 77500002
*                                                                Y02134 77550002
*                   CONSTANTS                                           78200021
*                                                                Y02134 78250002
*****************************************************************Y02134 78300002
*                                                                Y02134 78350002
ACCW     DC    X'0700000020000050'      BASIC CCW - REWIND COMMAND      78800021
AHDR1    DC    C'HDR1'                  CHAR HDR1                       79000021
AHDR2    DC    C'HDR2'                  CHAR HDR2                Y02083 79002002
AVOL     DC    C'VOL1'                  CHAR VOL1                       79200021
UVOL0G   DC    C'UVL'                   USER VOLUME LABEL               81400021
CONSTONE DC    X'0001'                  CONSTANT OF ONE          YM6559 81400602
KNO      DC    C'NO '                   WTOR REPLY COMPARAND     Y02083 81402002
KYES     DC    C'YES'                   WTOR REPLY COMPARAND     Y02083 81404002
BLANKS   DC    CL4' '                   CHAR BLANKS              Y02083 81406002
SCRTCH   DC    C'SCRTCH'                SCRATCH REQUEST        @ZA02874 81456037
RACDFL   RACDEF TYPE=ADDVOL,CLASS='TAPEVOL',MF=L RACDEF        @G32DSMI 81526032
RACDFLEN EQU   *-RACDFL                 LENGTH OF PARM LIST    @G32DSMI 81556032
*                                                                       81600021
         EJECT                                                          81602002
*                                                                Y02083 81604002
*****************************************************************Y02083 81606002
*                                                                Y02083 81608002
*        EQUATES                                                 Y02083 81610002
*                                                                Y02083 81612002
*****************************************************************Y02083 81614002
*                                                                Y02083 81616002
FL2CKDS  EQU   C'C'                     FL2 CHECKPOINT D/S IND   Y02083 81618002
EABD240  EQU   240                      937-10 INTERNAL CODE     Y02083 81620002
         EJECT                                                          82000002
*                                                                       82200021
XCTLTA2B XCTLTABL ID=(ID2B4J,4J,ID2B2B,2B,MOD2D2B,2D,ID2B2F,2F,  Y02134X82250002
               ,NSLEHDRO,ID2B2N,2N,ID2B0P,0P,ID2B5T,5T),         Y02082X82252002
               SVC=055,BRT=YES,LENGTH=                           Y02134 82350002
         IECDSECS CVT,TCB,DCB,UCB,MAIN,TIOT,WTG,PREFX,IEZDEB,  @G32DSMI*85200032
               DSAB,RACVT,JSCB,RRPL,EXPAND=YES                 @G32DSMI 88200032
         IECEQU IEZDEB=YES                                              91200032
         END                                                            94200032
