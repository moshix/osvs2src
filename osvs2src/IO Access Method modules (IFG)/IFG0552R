         TITLE 'IFG0552R - EOV TAPE INPUT STD TRAILER LABEL FUNCTION'   00100021
         COPY  LCGASMSW                                                 00200000
IFG0552R CSECT                                                          00400021
         ENTRY IGG0550B                                          Y02080 00500002
IGG0550B EQU   IFG0552R                 ALLIAS ENTRY POINT       Y02080 00600002
*********************************************************************** 00650002
*                                                                     * 00700002
*          VS2 RELEASE 03.7 DELETIONS                                 * 00710037
*0000207000,210000                                             @ZA19126 00720037
*                                                                     * 00750002
*          VS2 RELEASE 03 DELETIONS                                   * 00760002
*0000                                                          @ZA07712 00761037
*0000                                                          @ZA01503 00762002
*0000293000,301000,307000,346000,347000,654600                 @ZA01338 00763002
*0000364600-365000,369960                                      @ZA01342 00765037
*0000                                                          @ZA07604 00767037
*0000                                                          @ZA13589 00768037
*                                                                     * 00770002
*          VS2 RELEASE 02 DELETIONS                                   * 00800002
*                                                                     * 00850002
*                                                                     * 00900002
*********************************************************************** 00950002
*                                                                     * 01000002
* MODULE NAME = IFG0552R (OS/VS2)                                     * 01050002
*                                                                     * 01100002
* DESCRIPTIVE NAME = INPUT TAPE - STANDARD HEADER LABEL               * 01150002
*                                                                     * 01200002
* COPYRIGHT = NONE                                                    * 01250002
*                                                                     * 01300002
* STATUS = RELEASE 2, LEVEL 0                                         * 01350002
*                                                                     * 01400002
* FUNCTION =                                                          * 01450002
*        1) FOR STANDARD LABELS (BRANCH ENTRY = 0), POSITION TO       * 01500002
*        AND READ TRAILER LABEL 1 (EOV1,EOF1,HDR1) AND TRANSLATE IF   * 01550002
*        ASCII SPECIFIED.                                             * 01600002
*        2) IF THE DCB CONTAINS A DEVICE DEPENDENT SECTION, COMPARE   * 01650002
*        THE BLOCK COUNT IN THE DCB TO THE BLOCK COUNT IN THE LABEL,  * 01700002
*        PASSING CONTROL TO THE CALLER'S BLOCK COUNT EXIT ROUTINE IF  * 01750002
*        THE BLOCK COUNTS ARE UNEQUAL. THE IECRES UEXIT MACRO GIVES   * 01800002
*        CONTROL TO IFG019RA WHO WILL SYNCH TO THE CALLER. THE BLOCK  * 01850002
*        COUNT EXIT INTERFACE IS AS FOLLOWS:                          * 01900002
*        2A) REGISTERS ARE INITIALIZED FOR THE CALLER:                * 01950002
*            R0 - CONTAINS THE BLOCK COUNT FROM THE LABEL.            * 02000002
*            R1 - ADDRESS OF DCB WITH INCORRECT BLOCK COUNT.          * 02050002
*            R2-R13 - CALLER'S REGS AT ENTRY TO EOV.                  * 02100002
*            R15 - CALLER'S BLOCK COUNT EXIT ROUTINE ADDRESS.         * 02150002
*        2B) CONTROL BLOCK INDICATORS                                 * 02200002
*            THE 'LOCK' BIT IS TURNED OFF WHEN CONTROL IS             * 02250002
*            PASSED TO THE CALLER AND IS RESET UPON RETURN.           * 02300002
*        2C) RETURN CODES FROM THE CALLER PASSED IN R15.              * 02350002
*            0 - TERMINATE PROCESSING DUE TO INCORRECT BLOCK          * 02400002
*                COUNT.                                               * 02450002
*        3) CONTROL IS PASSED TO IFG0552T TO PROCESS USER LABELS IF   * 02500002
*        THEY WERE SPECIFIED AND A VALID EXIT ROUTINE ADDRESS EXISTS. * 02550002
*        USER LABELS ARE NOT PROCESSED IF DEFERRED USER LABEL PRO-    * 02600002
*        CESSING HAS BEEN SPECIFIED AND END-OF=FILE (EOF) HAS         * 02650002
*        OCCURRED.                                                    * 02700002
*        4) IF USER LABELS ARE NOT TO BE PROCESSED, POSITION THE      * 02750002
*        TAPE TO THE LOGICAL END OF THE DATA SET (IE. AT THE INTER-   * 02800002
*        BLOCK GAP FOLLOWING THE TAPE MARK FOLLOWING THE TRAILER      * 02850002
*        LABELS FOR READ FORWARD, OR AT THE INTERBLOCK GAP PRE-       * 02900002
*        CEDING HEADER LABEL 1 FOR READ BACKWARD. CONTINUE PRO-       * 02950002
*        CESSING AT 6) BELOW.                                         * 03000002
*        5) IF ENTRY IS FROM NSLETRLI (BRANCH ENTRY CODE = 12)        * 03050002
*        FOLLOWING DEFERRED LABEL PROCESSING DURING 'CLOSE', RETURN   * 03100002
*        TO IFG0202B (ALIAS IFG0556B) TO COMPLETE THAT PROCESSING.    * 03150002
*        6) FOR ALL OTHER ENTRIES, DETERMINE IF EOF HAS OCCURRED,     * 03200002
*        IN WHICH CASE CONTROL IS TRANSFERRED TO THE EOD FUNCTION     * 03250002
*        IFG0552X.                                                    * 03300002
*        7) IF NOT EOD AND SMF IS ACTIVE, TRANSFER CONTROL TO THE     * 03350002
*        CLOSE SMF RECORD BUILDER FUNCTION TO PROCESS SMF RECORDS.    * 03400002
*        SET UP TO RETURN TO IFG0552V UPON COMPLETION OF SMF          * 03450002
*        PROCESSING.                                                  * 03500002
*        8) TRANSFER CONTROL TO IFG0552V FOR EOV INPUT POSITIONING.   * 03550002
*                                                                     * 03600002
* NOTES = SEE BELOW                                                   * 03650002
*                                                                     * 03700002
*    DEPENDENCIES =                                                   * 03750002
*            CLASS ONE CHARACTER CODE.  THE EBCDIC CHARACTER CODE     * 03800002
*            WAS USED FOR ASSEMBLY.  THE MODULE MUST BE REASSEMBLED   * 03850002
*            IF A DIFFERENT CHARACTER SET IS USED FOR EXECUTION.      * 03900002
*                                                                     * 03950002
*    RESTRICTIONS = NONE                                              * 04000002
*                                                                     * 04050002
*    REGISTER CONVENTIONS =                                           * 04100002
*            R2 POINTS TO DCB                                         * 04150002
*            R4 POINTS TO OPEN WORK AREA                              * 04200002
*            R5 POINTS TO THE RESIDENT ROUTINE                        * 04250002
*            R6 POINTS TO THE WTG TABLE                               * 04300002
*            R7 POINTS TO THE CURRENT PARAMETER LIST ENTRY            * 04350002
*            R8 POINTS TO THE CURRENT WTG TABLE ENTRY                 * 04400002
*            R9 POINTS TO THE DD ENTRY IN THE TIOT                    * 04450002
*            R10 POINTS TO THE UCB                                    * 04500002
*                                                                     * 04550002
*    PATCH LABEL = SEE THIRD FROM LAST LABEL BEFORE ORG STATEMENT AT  * 04600002
*                  END OF LISTING.                                    * 04650002
*                                                                     * 04700002
* MODULE TYPE = CONTROL (OPEN, CLOSE, EOV DATA MANAGEMENT)            * 04750002
*                                                                     * 04800002
*    PROCESSOR = ASSEMBLER XF                                         * 04850002
*                                                                     * 04900002
*    MODULE SIZE = SEE EXTERNAL SYMBOL DICTIONARY OR LOC FIELD ON     * 04950002
*                  ORG STATEMENT AT END OF LISTING                    * 05000002
*                                                                     * 05050002
*    ATTRIBUTES = REENTRANT, REFRESHABLE,READ-ONLY, ENABLED,          * 05100002
*                 PRIVILEGED, SUPERVISOR STATE, DATA MANAGEMENT KEY,  * 05150002
*                 LINK PACK AREA RESIDENT/PAGEABLE                    * 05200002
*                                                                     * 05250002
* ENTRY POINT =                                                       * 05300002
*        IFG0552R                                                     * 05350002
*        IGG0550B - ALIAS                                             * 05400002
*                                                                     * 05450002
*    PURPOSE = SEE FUNCTION                                           * 05500002
*                                                                     * 05550002
*    LINKAGE =                                                        * 05600002
*        THIS MODULE IS TRANSFERRED CONTROL THROUGH THE IECRES-LOAD   * 05650002
*        MACRO INSTRUCTION.                                           * 05700002
*                                                                     * 05750002
* INPUT =                                                             * 05800002
*        GIVEN CONTROL IN PROTECT KEY 5.                              * 05850002
*        REGISTER 2 POINTS TO THE COPIED DCB.                         * 05900002
*        DEBDCBAD POINTS TO THE COPIED DCB.                           * 05950002
*        REGISTER 4 POINTS TO THE EOV WORKAREA                        * 06000002
*                                                                     * 06050002
* OUTPUT =                                                            * 06100002
*        THE NEXT MODULE IS GIVEN CONTROL IN PROTECT KEY 5 WITH       * 06150002
*        REGISTER 2 POINTING TO THE COPIED DCB,                       * 06200002
*        DEBDCBAD POINTING TO THE COPIED DCB,                         * 06250002
*        AND REGISTER 4 POINTING TO THE EOV WORKAREA,                 * 06300002
*                                                                     * 06350002
* EXIT-NORMAL =                                                       * 06400002
*        IFG0552V - POSITION VOLUME AT EOV.                           * 06450002
*        IFG0552X - PROCESS THE DATA SET AT EOF.                      * 06500002
*        IFG0553B - PROCESS SMF RECORDS.                              * 06550002
*        IFG0556B - FINISH DEFERRED NSL PROCESSING.                   * 06600002
*        IFG0552T - PROCESS USER LABELS.                              * 06650002
*                                                                     * 06700002
* EXIT-ERROR =                                                        * 06750002
*        IFG0550P - PROBLEM DETERMINATION                             * 06800002
*             INTERNAL CODE = 180, INVALID LABEL                      * 06850002
*             INTERNAL CODE = 148, INVALID BLOCK COUNT AND NO EXLST   * 06900002
*             INTERNAL CODE = 146, POSITIONING ERROR                  * 06950002
*             INTERNAL CODE = 147, ERROR READING TRAILER LABEL        * 07000002
*                                                                     * 07050002
* EXTERNAL REFERENCES = SEE BELOW                                     * 07100002
*                                                                     * 07150002
*    ROUTINES =                                                       * 07200002
*        IFG019RA THROUGH THE IECRES MACRO.                           * 07250002
*                                                                     * 07300002
*    DATA AREAS =                                                     * 07350002
*        EOV WORKAREA.                                                * 07360002
*                                                                     * 07370002
*    CONTROL BLOCK =                                                  * 07380002
*        CVT                                                          * 07390002
*        DEB                                                          * 07392002
*        JFCB                                                         * 07394002
*        TCB                                                          * 07396002
*        UCB                                                          * 07398002
*                                                                     * 07398402
* TABLES =                                                            * 07398802
*                                                                     * 07399202
* MACROS =                                                            * 07399602
*        IECRES LOAD                                                  * 07399702
*        IECRES INIT                                                  * 07399802
*        IECRES UEXIT                                                 * 07399902
*        XLATE                                                        * 07433202
*        DMABCOND                                                     * 07443202
*                                                                     * 07453202
* CHANGE ACTIVITY =                                                   * 07463202
*        SEE CHANGES/DELETIONS SECTION JUST AFTER CSECT CARD.         * 07465202
*                                                                     * 07465602
*********************************************************************** 07466002
         EJECT                                                          07466402
*                                                                       07466702
*****    INTERNAL ERROR CODES                                           07500021
*                                                                       07600021
EABD146  EQU   146                      ERROR POS TO TRAILER LABELS     07700021
EABD147  EQU   147                      ERROR READING TRAILER LABELS    07800021
EABD148  EQU   148                      INCORRECT DCB BLOCK COUNT       07900021
EABD150  EQU   150                      ERROR POS TO END OF DATA SET    08000021
EABD180  EQU   180                      INVALID TRAILER LABEL READ      08100021
CHARH    EQU   C'H'                     CHARH = CHARACTER H    @ZA07604 08130037
CHARE    EQU   C'E'                     CHARE = CHARACTER E    @ZA07604 08160037
*                                                                       08200021
         BALR  RBASE,R0                 ESTABLISH ADDRESSABILITY        08300002
         USING *,RBASE                                                  08400021
         USING FORCORE,RCORE                                            08500021
         USING IHADCB,RDCB                                              08600021
         USING UCB,RUCB                                                 08700021
         USING TIOENTRY,RTIOT                                           08800021
         USING DEB,RDEB                                                 08900021
         USING WTG,RWTG                                                 09000021
         MODESET EXTKEY=DATAMGT         DM KEY                 @ZA01503 09050002
*                                                                       09100021
*****          DETERMINE TYPE OF ENTRY INTO MODULE                      09200021
*                                                                       09300021
         B     ETI00100(RET)            DETERMINE TYPE OF ENTRY TO MOD  09400021
ETI00100 EQU   *                        BRANCH TABLE                    09500002
         B     ETI00200                 BR IF SL ENTRY  ( 0)            09600002
         B     ETI02100                 BR IF NL ENTRY  ( 4)            09700002
         B     ETI02050                 BR IF NSL ENTRY DURING EOV ( 8) 09800002
         B     ETI02700                 BR NSL ENTRY DURING CLOSE  (12) 09900002
*                                       ..FOR DEFERRED NSL PROCESSING   10000021
         B     ETI01400                 BR IF RETURN FROM PROB @ZA01338 10001002
*                                       DETERMINATION  (16)    @ZA01338 10002002
*                                                                       20200021
ETI00200 EQU   *                        CHECK FOR READBACK              20300002
         MVC   DXCCW1(K16),ABSFCCW      INITLZ CCW FOR 'BSF' AND MOVE   20400021
*                                       ..UNCHAINED 'NOP' INTO DXCCW2   20500021
         TM    DCBOFLGS,DCBORDBK        IS READBACK INDICATED IN DCB-   20600021
         BO    ETI00250                 YES, BR TO POSITION TA @ZA19126 20700037
         TM    DCBMACRF,DCBMEXCP        TEST FOR EXCP          @ZA19126 20740037
         BNO   ETI00400                 NO, READ TRAILER,HEADE @ZA19126 20780037
         TM    DCBOFLGS,DCBOEOF         TAPEMARK READ ?        @ZA19126 20820037
         BO    ETI00400                 YES, READ TRAILER,HEAD @ZA19126 20860037
         BNO   ETI00300                 NO, SPACE OVER TM.     @ZA19126 20900037
*****          POSITION TAPE TO READ HEADER LABEL 1                     20940037
ETI00250 EQU   *                                               @ZA19126 20980037
         LA    RD,EABD146               POSITIONING ERR INTERNAL CODE   21100021
         BAL   RC,ETI02800              BACKSPACE PAST TAPE MARK        21160021
*                                       ..PRECEDING HEADER LBLS         21220021
         MVI   DXCCW1,CCWNOP            INITLZ CCW FOR 'NOP' COMMAND    21300021
         BAL   RC,ETI02800              ISSUE 'NOP' TO TAPE UNIT        21400021
         BAL   RC,ETI02750              ISSUE SENSE COMMAND     XA01537 21500002
         TM    DXCCW3+K1,UCBLDPT        IS TAPE AT LOAD PT      XA01537 21550002
         BO    ETI00400                 ..BR IF YES TO READ HEADER LBL  21600021
ETI00300 EQU   *                        NOT AT LOAD POINT               21700002
         MVI   DXCCW1,CCWFSF            INITLZ CCW FOR 'FWD SPACE FILE' 21800021
         OI    DXCCW1+K4,CCWCMDCH       CHAIN TO 'NOP' CMD              21900021
         BAL   RC,ETI02800              FORWARD SPACE TO HEADER LABELS  22000021
*                                                                       22100021
*****          READ TRAILER ( OR HEADER ) LABEL 1                       22200021
*                                                                       22300021
ETI00400 EQU   *                        READ TRAILER/HDR LABEL          22400002
         LA    RD,EABD147               INTERNAL ERROR CODE IN CASE OF  22500021
*                                       ERROR READING TRAILER LABEL 1   22600021
         LA    RC,DXLBL                 PLACE ADDRESS OF LABEL AREA IN  22700021
         ST    RC,DXCCW1                OBTAINED CORE INTO THE CCW      22800021
         MVI   DXCCW1,CCWRDTAP          INITLZ CCW FOR 'TAPE READ' CMD  22900021
         MVC   DXCCW1+K4(K4),ARDCCW     SET LENGTH EQUAL 80, NO FLAGS   23000021
         TM    JFCBLTYP,JFCBAL          WERE ANSI LABELS SPECIFIED-     23100021
         BZ    ETI00500                 ..BRANCH IF NOT                 23200021
         OI    DXCCW1+K4,CCWSILI        SET 'SILI' BIT ON               23300021
ETI00500 EQU   *                        NOT ANSI LABELS                 23400002
         BAL   RC,ETI02800              READ TRAILER (OR HEADER) LABEL  23500021
         TM    JFCBLTYP,JFCBAL          WERE ANSI LABELS SPECIFIED-     23600021
         BZ    ETI00600                 ..BRANCH IF NOT                 23700021
         XLATE DXLBL,K80                TRANSLATE ANSI LABELS           23800021
         CLC   FL1LABI,UVOL             IS THIS A USER VOLUME LABEL-    23900021
         BE    ETI00500                 ..BR IF YES- READ ANOTHER LABEL 24000021
ETI00600 EQU   *                        NOT USER LABEL                  24100002
         LA    RD,EABD180               ERROR CODE FOR INVALID LABEL    24200021
         CLC   FL1LABI,AVOL             IS THIS A VOLUME LABEL-         24300021
         BE    ETI00500                 ..BR IF YES- READ ANOTHER LABEL 24400021
         CLI   FL1NO,FILPOS1            IS THIS A FILE LABEL 1-         24500021
         BNE   ETI02900                 ..BR IF NOT- WRONG LABEL        24600021
         CLI   FL1LABI,CHARH            IS THIS A HDR LABLE    @ZA07604 24608037
         BNE   ETI00610                 BR NO TO TEST EOV-EOF  @ZA07604 24616037
         TM    DCBOFLGS,DCBORDBK        IS RD BK INDIC IN DCB  @ZA07604 24624037
         BNO   ETI02900                 .BR IF NO WRONG LABEL  @ZA07604 24632037
         B     ETI00620                 BR TO VER BLOCK COUNT  @ZA07604 24640037
ETI00610 EQU   *                                               @ZA07604 24648037
         CLI   FL1LABI,CHARE            IS THIS A EOV-EOF LABEL@ZA07604 24656037
         BNE   ETI02900                 .BR IF NO WRONG LABEL  @ZA07604 24664037
         TM    DCBOFLGS,DCBORDBK        IS RD BK INDIC IN DCB  @ZA07604 24672037
         BNO   ETI00620                 BR TO VER BLOCK COUNT  @ZA07604 24680037
         B     ETI02900                 .BR IF NO WRONG LABEL  @ZA07604 24688037
*                                                                       24700021
*********************************************************************** 24800021
*              VERIFY BLOCK COUNT. NOTE THAT IF THE DATA SET WAS      * 24900021
*              CREATED WITH A DCB THAT HAD NO DEVICE-DEPENDENT        * 25000021
*              SECTION, THE BLOCK COUNT WAS WRITTEN AS ZERO AND       * 25100021
*              CANNOT BE VERIFIED.                                    * 25200021
*********************************************************************** 25300021
*                                                                       25400021
ETI00620 EQU   *                                               @ZA07604 25450037
         L     RC,DCBBLKCT              LOAD BLOCK COUNT FROM THE DCB   25500021
         PACK  DXCCW7,FL1BLKCT          CONVERT THE BLOCK COUNT IN      25600021
         CVB   RF,DXCCW7                ..THE FILE LABEL TO BINARY      25700021
         TM    DCBMACRF,DCBMEXCP        IS THIS AN 'EXCP' DCB-          25800021
         BNO   ETI00700                 ..BR IF NOT- BLOCK COUNT EXISTS 25900021
         TM    DCBMACRF,DCBMFOUN        DOES FOUNDATION EXTENSION EXIST 26000021
         BNO   ETI01900                 ..BR IF NOT- NO BLOCK COUNT     26100021
         TM    DCBMACRF+K1,DCBMDEV      DOES DEV-DEPEND SECTION EXIST-  26200021
         BZ    ETI01400                 ..BR IF NOT- CHK FOR USER LBLS  26300021
         B     ETI00900                 ..ELSE BR TO VERIFY BLOCK COUNT 26400021
ETI00700 EQU   *                        NOT EXCP                        26500002
         TM    DCBCIND2,DCBC2CHN        IS CHAINED SCHEDULING IN USE-   26600021
         BO    ETI00800                 ..BRANCH IF YES                 26700021
         MODESET KEYADDR=DXUKEY,WORKREG=13 ASSUME USER KEY       Y02082 26750002
         L     RD,DCBIOBA               LD ADDR OF IOB THAT CAUSED EOF  26800021
         SH    RC,IOBINCNT(,RD)         UPDATE BLOCK COUNT TO ACCOUNT   26900021
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY      Y02082 26950002
         ST    RC,DCBBLKCT              ..FOR EOF AND STORE IN DCB      27000021
ETI00800 EQU   *                        CHAIN SCHEDULING                27100002
         LTR   RF,RF                    WAS BLOCK COUNT WRITTEN AS 0-   27200021
         BNZ   ETI00900                 ..BR IF NOT- THE BLOCK COUNT    27300021
*                                       ..IN THE LABEL IS VALID         27400021
         TM    DCBOFLGS,DCBORDBK        WAS LAST OPERATION 'READBACK'-  27500021
         BNO   ETI01400                 ..BR IF NOT- BLOCK CT NOT VALID 27600021
ETI00900 EQU   *                        VALID BLOCK COUNT               27700002
         CLR   RC,RF                    IS BLOCK COUNT IN DCB CORRECT-  27800021
         BE    ETI01400                 ..BR IF YES- TEST FOR USER LBL  27900021
*                                                                       28000021
*********************************************************************** 28100021
*              INCORRECT BLOCK COUNT PROCESSING                       * 28200021
*********************************************************************** 28300021
*                                                                       28400021
*****          TEST FOR A VALID BLOCK COUNT EXIT                        28500021
*                                                                       28600021
ETI01000 EQU   *                        TEST FOR BLOCK COUNT EXIT       28700002
         LA    RD,EABD148               INTERNAL ERROR CODE IN CASE     28800021
*                                       ..BLOCK COUNT IS UNACCEPTABLE   28900021
         L     RC,DCBEXLST              GET EXIT LIST ADDR FROM THE DCB 29000021
         LA    RC,K0(,RC)               ZERO HI-ORDER BYTE OF EXIT LIST 29100021
         LTR   RC,RC                    IS THERE A DCB EXIT LIST-       29200021
         BZ    ETI01300                 BR IF NOT TO ERROR RTN @ZA01338 29300002
ETI01100 EQU   *                        EXIT LIST EXISTS                29400002
         MODESET KEYADDR=DXUKEY,WORKREG=14 ASSUME USER KEY     @ZA07712 29450037
         CLI   K0(RC),XLBLKCT           IS THIS AN ACTIVE BLK CT EXIT-  29500021
         BE    ETI01200                 ..BR IF YES                     29600021
         CLI   K0(RC),XLBLKCT+LASTNTRY  IS 'LAST ENTRY' IND ALSO ON-    29700021
         BE    ETI01200                 ..BRANCH IF YES                 29800021
         TM    K0(RC),LASTNTRY          IS THIS THE LAST LIST ENTRY-    29900021
         LA    RC,K4(,RC)               INCREMENT POINTER TO NEXT ENTRY 30000021
         BO    ETI01300                 BR IF YES TO ERROR RTN @ZA01338 30100002
         B     ETI01100                 ..ELSE BR TO TST FOR VALID EXIT 30200021
ETI01200 EQU   *                        ACTIVE BLOCK COUNT EXIT         30300002
         L     RC,K0(,RC)               GET EXIT ADDRESS FROM DCB       30400021
         LA    RC,K0(,RC)               ZERO THE HI-ORDER BYTE          30500021
         LTR   RC,RC                    IS EXIT ADDR ZERO-              30600021
         BZ    ETI01300                 BR IF YES TO ERROR RTN @ZA01338 30700002
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY      Y02082 30750002
*                                                                       30800021
****           A VALID EXIT EXISTS- INITLZ FOR 'SYNCH' TO USER          30900021
*                                                                       31000021
         LR    RET,RF                   SAVE TRAILER LBL BLK CT  Y02082 31010002
         NI    DCBOFLGS,X'FF'-DCBOLOCK  IND THAT USER EXIT TAKEN Y02082 31050002
*                                                                Y02082 31060002
* COPY THE DCB FROM THE WORK AREA TO USER'S STORAGE              Y02082 31070002
*                                                                Y02082 31080002
         IECRES INIT,DCBCOPY=FRWKAR,STM=(3,14,WTGPREFX)          Y02082 31090002
         LR    RDCB,RET                 SAVE TRAILER LBL BLK CT  Y02082 31090402
*                                                                Y02082 31092002
         IECRES UEXIT,REG0=(RET),REG1=DXUDCBAD,EXITAD=(RC),      Y02082*31100002
               STM=(2,12,DXXPREFX)                               Y02082 31150002
         LR    RET,RDCB                 RESTORE TRLR LBL BLK CT  Y02082 31200002
         L     RDCB,DXUDCBAD            PT TO CALLER'S DCB       YM3005 31250002
         MODESET KEYADDR=DXUKEY,WORKREG=1 ASSUME CALLER'S KEY    YM3005 31300002
         OI    DCBOFLGS,DCBOLOCK        INDICATE RETURN FR USER  Y02082 31350002
         LA    R0,ALLBITS-DCBOBUSY      ISOLATE BUSY BIT MASK    YM3005 31400002
         IC    R1,DCBOFLGS              GET CALLER'S OFLGS       YM3005 31450002
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY      YM3005 31500002
         L     RDCB,DXPDCBAD            PT TO COPIED DCB         YM3005 31550002
         OR    R0,R1                    ISOLATE CALLER BUSY BIT  YM3005 31600002
         IC    R1,DCBOFLGS              GET COPIED DCBOFLGS      YM3005 31650002
         NR    R1,R0                    UPDTE BUSY BIT TO CALLER YM3005 31700002
         STC   R1,DCBOFLGS              UPDATE OFLGS FIELD       YM3005 31750002
         OI    DCBOFLGS,DCBOLOCK        INDICATE RETURN FROM USER EXIT  34200021
         LA    RD,EABD148               INTERNAL ERROR CODE IN CASE     34300021
*                                       ..BLOCK COUNT IS UNACCEPTABLE   34400021
         LTR   RF,RF                    IS THE USER'S RET CODE ZERO-    34500021
         BNZ   ETI01400                 BR IF NO TO CONTINUE   @ZA01338 34600002
ETI01300 EQU   *                                               @ZA01338 34601002
         LA    RET,K16                  RETURN OFFSET          @ZA01338 34602002
         MODESET EXTKEY=DATAMGT         DATA MANAGMENT KEY     @ZA01338 34602202
         DMABCOND (RD),ABEND2R,RETURN=MOD2R2R                  @ZA01338 34603002
*                                                                       34604002
*********************************************************************** 34900021
*              TEST FOR USER LABEL PROCESSING                         * 35000021
*********************************************************************** 35100021
*                                                                       35200021
ETI01400 EQU   *                        TEST FOR USER LABELS            35300002
         ST    RPARC,DXREG0             SAVE REGISTER 7         SA55619 35310000
         TM    DCBOFLGS,DCBORDBK        IS THIS 'READBACK' MODE SA55619 35350000
         BNO   ETI01450                 BRANCH IF NOT           SA55619 35360000
         CLI   DXVOLSEQ+K1,K1           LAST READBACK VOL        Y02134 35380002
         BH    ETI01456                 BRANCH IF NOT EOF        Y02134 35390002
         B     ETI01455                 SET SWITCH              SA55619 35392000
ETI01450 BAL   R7,ETI02150              TEST FOR E-O-F          SA55619 35396000
         BNE   ETI01456                 BRANCH NOT E-O-F         Y02134 35398002
ETI01455 MVC   DXREG1+K1(K3),AEOF       SET SWITCH              SA55619 35398402
ETI01456 L     RPARC,DXREG0             RESTORE REGISTER 7      SA55619 35398800
         TM    JFCBLTYP,JFCBUL          WERE USER LABELS SPECIFIED-     35400021
         BNO   ETI01900                 ..BR IF NOT TO POSITION TAPE    35500021
         TM    DCBMACRF,DCBMEXCP        IS THIS AN EXCP DCB-            35600021
         BNO   ETI01500                 ..BR IF NOT                     35700021
         TM    DCBMACRF,DCBMFOUN        IS THERE A FOUNDATION EXT-      35800021
         BZ    ETI01900                 ..BR IF NOT                     35900021
ETI01500 EQU   *                        NOT EXCP                        36000002
         L     RC,DCBEXLST              LD EXIT LIST ADDR FROM THE DCB  36100021
         LA    RC,K0(,RC)               ZERO HI-ORDER BYTE OF EXIT LIST 36200021
         LTR   RC,RC                    IS THERE A DCB EXIT LIST-       36300021
         BZ    ETI01900                 ..BR IF NOT TO POSITION TAPE    36400021
         CLC   DXREG1+K1(K3),AEOF       IS THIS E-O-F           SA55619 36450002
         BNE   ETI01600                 BR IF NO (EOV)         @ZA01342 36460037
         L     R1,DXDSABAD              GET CURRENT DSAB       @ZA01342 36470037
         USING DSAB,R1                                         @ZA01342 36480037
         L     R1,DSABFCHN              GET NEXT DSAB          @ZA01342 36490037
         LTR   R1,R1                    IS THERE ANOTHER DSAB? @ZA01342 36492037
         BZ    ETI01650                 NO,BR (EOF)            @ZA01342 36494037
         L     R1,DSABTIOT              GET NEXT TIOT ENTRY    @ZA01342 36496037
         CLI   TIOEDDNM-TIOENTRY(R1),BLANK IS DDNAME BLANK?    @ZA01342 36498037
         BNE   ETI01650                 NO,BR (EOF)            @ZA01342 36498437
         TM    TIOELINK-TIOENTRY(R1),TIOESYIN+TIOESYOT IS IT   @ZA01342 36498837
*                                       A SPOOLED DATA SET?    @ZA01342 36498937
         BM    ETI01650                 YES,BR (EOF)           @ZA01342 36499237
         TM    DCBOFLGS,DCBOUNLK        UNLIKE CONCATENATION?  @ZA01342 36499637
         BO    ETI01650                 YES,BR (EOF)           @ZA01342 36499737
         L     RF,TIOESTTB-TIOENTRY(R1) GET CONC UCB ADDR      @ZA01342 36499837
         LA    RF,K0(RF)                CLEAR HIGH ORDER BYTE  @ZA01342 36499937
         LTR   RF,RF                    DUMMY DATA SET?        @ZA01342 36516637
         BZ    ETI01650                 YES, BR (EOF)          @ZA01342 36526637
         XC    DXREG1+K1(K3),DXREG1+K1  CLEAR EOF INDICATOR    @ZA01342 36528637
ETI01600 EQU   *                        EOV LABEL PROCESSING   @ZA01342 36533337
         MODESET KEYADDR=DXUKEY,WORKREG=15 ASSUME USER'S KEY     Y02082 36550002
         CLI   K0(RC),XLIUTL            IS THERE A TRAILER LABEL ENTRY- 36600021
         BE    ETI01800                 ..BR IF YES TO PROCESS USER LBL 36700021
         CLI   K0(RC),XLIUTL+LASTNTRY   IS 'LAST ENTRY' IND ALSO ON     36800021
         BE    ETI01800                 ..BR IF YES TO PROCESS USER LBL 36900021
         TM    K0(RC),LASTNTRY          IS THIS LAST ENTRY      SA55619 36950000
         LA    RC,K4(,RC)               INCR POINTER            SA55619 36960000
         BNO   ETI01600                 NO,CHECK NEXT ENTRY     SA55619 36970000
         CLC   DXREG1+K1(K3),AEOF       IS THIS E-O-F           SA55619 36980002
         BE    ETI01900                 YES, POSITION TAPE      SA55619 36990000
         L     RC,DCBEXLST              NO,GET EXIT LIST        SA55619 36992000
         LA    RC,K0(,RC)               ZERO HIGH ORDER BYTE    SA55619 36994000
ETI01650 EQU   *                        EOF LABEL PROCESSING   @ZA01342 36996037
         MODESET KEYADDR=DXUKEY,WORKREG=15 ASSUME USER'S KEY     Y02082 36998002
         CLI   K0(RC),XLDEFSL           IS 'DEFERRED USER TRAILER       37000021
*                                       ..LABEL PROCESSING' SPECIFIED-  37100021
         BE    ETI01700                 ..BR IF YES TO TEST FOR EOF     37200021
         CLI   K0(RC),XLDEFSL+LASTNTRY  IS 'LAST ENTRY' IND ALSO ON-    37300021
         BE    ETI01700                 ..BR IF YES TO TEST FOR EOF     37400021
         TM    K0(RC),LASTNTRY          IS THIS THE LAST LIST ENTRY-    37500021
         LA    RC,K4(,RC)               INCREMENT POINTER TO NEXT ENTRY 37600021
         BNO   ETI01650                 BR IF NOT TO CKECK NEXT ENTRYSA 37650000
         L     RC,DCBEXLST              GET EXIT LIST ADDR      SA55619 37700000
         LA    RC,K0(,RC)               ZERO HIGH ORDER BYTE    SA55619 37750000
         CLC   DXREG1+K1(K3),AEOF       IS THIS E-O-F           SA55619 37760002
         BE    ETI01600                 BR IS YES               SA55619 37770000
         B     ETI01900                 ..ELSE BR TO POSITION TAPE      37800021
*                                                                       37900021
*****          IF 'DEFERRED USER LABEL PROCESSING' WAS SPECIFIED AND    38000021
*****          EOF HAS OCCURRED, DEFER PROCESSING UNTIL 'CLOSE' OR      38100021
*****          'TCLOSE.                                                 38200021
*****          NOTE- THE TAPE IS LEFT AT THE INTERBLOCK GAP PRECEDING   38300021
*****          USER TRAILER LABEL 1 WHEN DEFERRED USER LABEL PROCESSING 38400021
*****          IS SPECIFIED.                                            38500021
*                                                                       38600021
ETI01700 EQU   *                        TEST FOR EOF                    38700002
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY      Y02082 38750002
         CLC   DXREG1+K1(K3),AEOF       IS THIS E-O-F           SA55619 38800002
         BE    ETI02100                 ..BR IF YES- DO NOT PROCESS UL  38900021
         MODESET KEYADDR=DXUKEY,WORKREG=15 ASSUME USER KEY       YM7387 38950002
*                                                                       39000021
*****          IF A VALID EXIT ADDR EXISTS, EXIT TO PROCESS USER LABELS 39100021
*                                                                       39200021
ETI01800 EQU   *                        CHECK FOR VALID EXIT            39300002
         LA    RF,MOD2R2T               PT TO ID/TTR OF USER LABEL MOD  39400021
         SR    RET,RET                  LD BR TABLE OFFSET FOR THAT MOD 39500021
         L     RC,K0(,RC)               LOAD EXIT ADDRESS FROM DCB      39600021
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY      Y02082 39650002
         LA    RC,K0(,RC)               ZERO THE HI-ORDER BYTE          39700021
         LTR   RC,RC                    DOES AN EXIT ADDRESS EXIST-     39800021
         BNZ   ETI02600                 ..BR IF YES- PROCESS USER LBLS  39900021
*                                                                       40000021
*********************************************************************** 40100021
*              POSITION TAPE BEYOND LABELS                            * 40200021
*********************************************************************** 40300021
*                                                                       40400021
ETI01900 EQU   *                        POSITION TAPE                   40500002
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY      Y02082 40550002
         LA    RD,EABD150               INTERNAL ERROR CODE IN CASE OF  40600021
*                                       ..POSITIONING ERROR             40700021
         MVC   DXCCW1,ABSFCCW           INITLZ CCW FOR 'BACKSPACE FILE' 40800021
         TM    DCBOFLGS,DCBORDBK        IS THIS READ BACKWARD MODE-     40900021
         BNO   ETI02000                 ..BRANCH IF NOT                 41000021
         BAL   RC,ETI02800              BACKSPACE PAST HEADER LABELS    41100021
         MVI   DXCCW1,CCWNOP            INITLZ CCW FOR 'NOP' COMMAND    41200021
         BAL   RC,ETI02800              ISSUE 'NOP' TO TAPE DRIVE       41300021
         BAL   RC,ETI02750              ISSUE SENSE COMMAND     XA01537 41350002
         TM    DXCCW3+K1,UCBLDPT        IS TAPE AT LOAD PT      XA01537 41360002
         BO    ETI02100                 ..BR IF YES TO CONTINUE         41500021
ETI02000 EQU   *                        NOT AT LOAD POINT               41600002
         MVI   DXCCW1,CCWFSF            INITLZ CCW FOR 'FWD SPACE FILE' 41700021
         OI    DXCCW1+K4,CCWCMDCH       CHAIN TO 'NOP' COMMAND          41800021
         BAL   RC,ETI02800              FSF TO END OF DATA SET (READ    41900021
*                                       ..FWD) OR PRECEDING HEADER      42000021
*                                       ..LABEL (RDBACK)                42100021
         B     ETI02100                 BR TO CONTINUE PROCESSING       42200021
*                                                                       50500021
*********************************************************************** 50600021
*              DETERMINE WHETHER EOV OR EOF HAS OCCURRED              * 50700021
*********************************************************************** 50800021
*                                                                       50900021
*****          RESTORE REGISTERS AND WORK AREA UPON RETURN FROM         50920021
*****          NSLETRLI                                                 50940021
*                                                                       50960021
ETI02050 EQU   *                        RETURN FROM NSLETRLI            51000002
         L     RDCB,DXUDCBAD            GET PTR TO USER'S DCB    Y02082 51050002
         MODESET KEYADDR=DXUKEY,WORKREG=1 ASSUME USER'S KEY      Y02082 51060002
         OC    DCBOFLGS,DCBOFLGS        TOUCH THE USER'S MEMORY  Y02082 51070002
         LA    R0,ALLBITS-DCBOBUSY      ISOLATE BUSY BIT MASK    YM3005 51080002
         IC    R1,DCBOFLGS              GET CALLER'S OFLGS       YM3005 51090002
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY      YM3005 51092002
         MVI   DXECB,K32                RESTORE DXECB          @ZA13589 51093037
         L     RDCB,DXPDCBAD            PT TO COPIED DCB         YM3005 51094002
         OR    R0,R1                    ISOLATE CALLER BUSY BIT  YM3005 51096002
         IC    R1,DCBOFLGS              GET COPIED DCBOFLGS      YM3005 51098002
         NR    R1,R0                    UPDTE BUSY BIT TO CALLER YM3005 51098402
         STC   R1,DCBOFLGS              UPDATE OFLGS FIELD       YM3005 51098802
         LR    RES,RWTGC                RESTORE RESIDENT RTN ADDRESS    51100021
         LA    RWTGC,DXXENTRY           RESTORE CURRENT ENTRY ADDRESS   51200021
         MVC   DXXMODNM(L'IFG055NM),IFG055NM  MOVE IN 'IFG055'   YM3271 51264000
         MVI   DXRESIND,K0              RESET RES RTN INDICATORS M0110  51270021
ETI02100 EQU   *                        BSF                             51300002
         MVC   DXCCW1,ABSFCCW           INITLZ CCW FOR BACKSPACE FILE   51400021
         MVC   DXCCW7+K4(K4),SRTEFSCT   SAVE SEQ CT/ NO. IN WORK AREA   51500021
         LA    RF,MOD2R2X               PT TO ID/TTR OF EOD MODULE      51600021
         SR    RET,RET                  LD BR TABLE OFFSET FOR THAT MOD 51700021
         TM    DCBOFLGS,DCBORDBK        IS THIS 'READBACK' MODE-        51800021
         BO    ETI02400                 ..BR IF YES TO READBACK RTN     51900021
         ST    RPARC,DXREG0             SAVE REGISTER 7         SA55619 51950000
         BAL   R7,ETI02150              TEST FOR E-O-F          SA55619 51960000
         L     RPARC,DXREG0             RESTORE REGISTER 7      SA55619 51970000
         BE    ETI02600                 BRANCH IF ALL VOLS      SA55619 51980002
*                                       BEEN PROCESSED          SA55619 51990000
         B     ETI02300                 CONTINUE PROCESSING     SA55619 51992000
*                                                                       52000021
*****          READ FORWARD TESTING FOR EOV                             52100021
*                                                                       52200021
ETI02150 EQU   *                                                SA55619 52250000
         MVC   DXCCW7(L'DXVOLSEQ),DXVOLSEQ SAVE VOL SEQ          Y02134 52300002
         CLC   JFCBNVOL,DXVOLSEQ+K1     CHECK FOR EOF            Y02134 53200002
         BCR   13,R7                    ..BRANCH IF YES         SA55619 53300002
*                                                                       53400021
*****          PERFORM POSITIVE CHECK FOR END-OF-FILE IF ON OTHER       53500021
*****          THAN THE LAST VOLUME OF A MULTI-VOLUME DATA SET.         53600021
*                                                                       53700021
         TM    JFCOPTCD,JFCALLOW        DO WE BYPASS EOF PROCESSING-    53800021
         BCR   1,R7                     ..BRANCH IF YES         SA55619 53900000
         CLC   VOLLABI(K3),AEOF         TEST FOR 'E-O-F' LABEL-         54000021
         BR    R7                       RETURN                  SA55619 54100000
*                                                                       55000021
*****    READ BACKWARD TESTING FOR EOF                                  55100021
*                                                                       55200021
ETI02400 EQU   *                        TEST FOR READBACK               55300002
         CLI   DXVOLSEQ+K1,K1           LAST VOL ON READBACK     Y02134 55400002
         BE    ETI02600                 BRANCH ON EOF READBACK   Y02134 55500002
         EJECT                                                          55600021
*********************************************************************** 55700021
*              END-OF-VOLUME PROCESSING                               * 55800021
*********************************************************************** 55900021
*                                                                A46383 56350021
ETI02300 EQU   *                        EOV PROCESSING           Y02134 56360002
*                                                                Y02134 56370002
         LA    RF,MOD2R2V               PT TO ID/TTR OF POSITIONING MOD 56400021
         SR    RET,RET                  LD BR TABLE OFFSET FOR THAT MOD 56500021
*                                                                M0110  56600021
*****          DETERMINE WHETHER OR NOT SMF PROCESSING IS        M0110  56700021
*****          REQUIRED                                          M0110  56800021
*                                                                M0110  56900021
         TM    DXXPATHS,WTGSMF          IS SMF PROCESSING REQ'D- A38013 57100021
         BNO   ETI02600                 ..BR IF NOT- XCTL TO VOL A38013 57700021
*                                       ..POSITIONING FUNCTION   A38013 58300021
         LA    RF,MOD2RSMF              PT TO SMF MODULE'S ID/TTR       58900021
         LA    RET,K4                   LD BR TABLE OFFSET FOR THAT MOD 59000021
         MVC   DXRETMOD(K5),MOD2R2V     MOVE POSITIONING MOD ID/TTR     59100021
*                                       ..INTO RETURN ADDRESS SAVE AREA 59200021
         EJECT                                                          59300021
*********************************************************************** 59400021
*              EXITS                                                  * 59500021
*********************************************************************** 59600021
*                                                                       59700021
*****          EXIT TO THE NEXT MODULE IN THE STRING                    59800021
*                                                                       59900021
ETI02600 EQU   *                        EXIT                            60000002
         IECRES LOAD,MODID=(RF),BRCODE=(RET),BRANCH=QUEUED       Y02080 60150002
*                                  INVOKE IECRES MACRO TO 'XCTL' Y02080 60170002
         SPACE 2                                                        60200021
*                                                                       60300021
*****          XCTL TO 'CLOSE' FOLLOWING DEFERRED NSL PROCESSING        60400021
*                                                                       60500021
ETI02700 EQU   *                        'XCTL' TO CLOSE                 60600002
         LA    RWTG,DXXMODNM            RELOAD WTG PTR         @ZA01503 60650002
         MVC   WTGMODNM,IFG0556B        MOVE ALIAS OF 'CLOSE'    M0110  60700021
*                                       ..NSL-PROCESSING MODULE INTO    60800021
*                                       ..THE WTG TABLE                 60900021
         MVC   WTGMODEP+K1(K3),MOD2R6B+K2 MOVE ADDR FOR THAT MOD Y02080 60930002
*                                       ..INTO PSEUDO BLDL LIST  M0110  60960021
         LA    RF,DXCCW12               PT TO THE XCTL WORK AREA M0147  61030021
         LA    RET,K4                   LOAD TABLE OFFSET FOR IFG0202B  61100021
         IECRES LOAD,PREFIX=DXXPREFX,BRANCH=DIRECT               Y02080 61250002
*                                       XFER BY EPA TO IFG0202B  Y02080 61260002
         EJECT                                                          61300021
*********************************************************************** 61400021
*              SUBROUTINES                                            * 61500021
*********************************************************************** 61600021
*                                                                       61700021
*        SUBROUTINE TO ISSUE SENSE COMMAND                      XA01537 61750002
*                                                               XA01537 61760002
ETI02750 EQU   *                                                XA01537 61770002
         LA    RET,DXCCW3               DATA AREA FOR SENSE     XA01537 61780002
         ST    RET,DXCCW1               PUT ADDR IN CCW         XA01537 61790002
         MVI   DXCCW1,CCWSENSE          MOVE IN SENSE COMMAND   XA01537 61792002
         MVI   DXCCW1+K7,K2             READ 2 SENSE BYTES      XA01537 61794002
*                                                               XA01537 61796002
*****          CLOSED SUBROUTINE TO PERFORM I/O OPERATIONS              61800021
*****          ENTRY TO THE ROUTINE IS VIA A 'BAL  RC,ETI02800'         61900021
*                                                                       62000021
ETI02800 EQU   *                        I/O SUBROUTINE                  62100002
         OI    DXATALL,DXATFC           FORCE CLOSE ON ERROR     YM7099 62150002
         EXCP  DXIOB                    INITIATE I/O OPERATION          62200021
         IECRES WAIT                    INVOKE IECRES MACRO TO 'WAIT'   62300021
         TM    DXECB,ECBNOERR           TEST FOR AN UNUSUAL I/O CONDITI 62400021
         BCR   1,RC                     ..BR IF NOT- RETURN TO CALLER   62500021
         TM    IOBSENS1,UCBLDPT         IS THE TAPE AT 'LOAD POINT'-    62600021
         BCR   1,RC                     ..BR IF YES- RETURN TO CALLER   62700021
*                                       ..ELSE DROP THROUGH TO ERR RTN  62800021
         SPACE 2                                                        62900021
*********************************************************************** 63000021
*              ERROR PROCESSING                                       * 63100021
*********************************************************************** 63200021
*                                                                       63300021
ETI02900 EQU   *                        ERROR PROCESSING                63400002
         MODESET EXTKEY=DATAMGT         DATA MANAGEMENT KEY      Y02082 63450002
         DMABCOND (RD),ABEND2R          EXIT TO PROB DETERMINATION RTN  63500021
         SPACE 3                                                        63600021
*********************************************************************** 63700021
*              CONSTANTS                                              * 63800021
*********************************************************************** 63900021
*                                                                       64000021
ABSFCCW  CCW   X'2F',0,X'20',1          BSF CMD, SILI FLAG, LNG EQ 1    64100021
NOPCCW   DC    X'0300000020000001'      NOP CMD, SILI FLAG, LNG EQ 1    64200021
ARDCCW   DC    X'00000050'              NO FLAGS, LNG EQ 80 FOR STD LBL 64300021
IFG0556B DC    CL8'IFG0556B'            ALIAS OF CLOSE NSL MOD   M0110  64400021
AVOL     DC    C'VOL'                   VOLUME LABEL IDENTIFIER         64500021
UVOL     DC    C'UVL'                   USER VOLUME LABEL IDENTIFIER    64600021
AEOF     DC    C'EOF'                   END-OF-FILE LABEL IDENTIFIER    64700021
IFG055NM DC    C'IFG055'                PREFIX FOR XCTL  (EOV)   YM3271 64750000
         EJECT                                                          64800021
*********************************************************************** 64900021
*              XCTL TABLE                                             * 65000021
*********************************************************************** 65100021
*                                                                       65200021
XCTLTB2R XCTLTABL ID=(ABEND2R,0P,MOD2R2T,2T,MOD2R2V,2V,MOD2R2X,2X,     C65450000
               MOD2RSMF,3B,MOD2R6B,6B,MOD2R2R,2R),SVC=055,     @ZA01338C65460002
               BRT=YES,LENGTH=                                   Y02080 65470002
         SPACE 2                                                        65500021
         IECDSECS CVT,                                                 C65600021
               TCB,                                                    C65700021
               RB,                                                     C65800021
               TIOT,                                                   C65900021
               DCB,                                                    C66100021
               DEB,                                                    C66200021
               UCB,                                                    C66300021
               MAIN,                                                   C66400021
               WTG,                                                    C66500021
               PREFX,                                            Y02080*66550002
               RRPL,                                             Y02144*66560002
               DSAB,                                           @ZA01342*66570037
               EXPAND=YES                                               66600021
         IECEQU ,                       INVOKE OPEN/CLOSE/EOV EQUATES   66700021
         SPACE 2                                                        66800021
         END                                                            66900021
