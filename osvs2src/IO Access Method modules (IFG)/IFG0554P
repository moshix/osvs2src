         TITLE 'IFG0554P                      END OF VOLUME DA OUTPUT ' 00100002
IFG0554P CSECT                                                          00200002
*********************************************************************** 00250002
*                                                                     * 00300002
*          VS2 RELEASE 3.7 DELETIONS/CHANGES                          * 00350037
*0000320740                                                    @ZA16814 00354037
*0000320540                                                    @ZA12175 00358037
*0000043600-043900,320526-320532                               @ZA12174 00362037
*000074000,289968,285969,307908                                @ZA15053 00364037
*C320540,320600,320660,D320550,320620,320640,320680,           @ZA18328 00365008
*D320700-320768,A320570,320630,320690                          @ZA18328 00365508
*                                                                     * 00366037
*          VS2 RELEASE 03 DELETIONS                                   * 00374037
*0000                                                          @ZA02221 00382037
*0000028000,042500,069000,073500,101453,307504,307520          @ZA02218 00390037
*307900,307912,514600                                          @ZA02218 00398037
*          VS2 RELEASE 02 DELETIONS                                   * 00406037
*0000140000                                                    @ZA06676 00414037
*0000108000,160000,285936-285938,285996-288996,353517-353597    ZA01265 00422037
*515000,515500                                                  ZA01265 00430037
*                                                                     * 00438037
*                                                                     * 00450002
*                                                                     * 00500002
*********************************************************************** 00550002
*                                                                     * 00600002
* MODULE NAME = IFG0554P (OS/VS2)                                     * 00650002
*                                                                     * 00700002
* DESCRIPTIVE NAME =                                                  * 00750002
*        EOV DA OUTPUT                                                * 00800002
*                                                                     * 00850002
* COPYRIGHT = NONE                                                    * 00900002
*                                                                     * 00950002
* STATUS = RELEASE 2, LEVEL 0                                         * 01000002
*                                                                     * 01050002
* FUNCTION =                                                          * 01100002
*        THIS IS THE CENTRAL FUNCTION CONTROL MODULE FOR DIRECT       * 01150002
*        ACCESS OUTPUT END OF VOLUME PROCESSING. IT IS ENTERED        * 01200002
*        UNDER THE FOLLOWING CONDITIONS -                             * 01250002
*                                                                     * 01300002
*        1) IF WTGMODNM IN THE EOV WORKAREA DOES NOT INDICATE A       * 01350002
*        RETURN FROM DADSM, REGISTER 14 CONTAINS                      * 01400002
*        A BRANCH TABLE CODE 0, 4, 8, 12, 16 -                        * 01450002
*                                                                     * 01500002
*        - 0 - ENTRY FROM IFG0551H, THE INITIALIZATION FUNCTION FOR   * 01550002
*        EOV. IT IS DETERMINED WHETHER TO OBTAIN ADDITIONAL SPACE ON  * 01600002
*        THE CURRENT VOLUME OR TO OBTAIN A NEW VOLUME.                * 01650002
*                                                                     * 01700002
*        AN ATTEMPT TO ACQUIRE ADDITIONAL SPACE ON THE CURRENT        * 01750002
*        VOLUME WILL BE MADE IF THE DEB DOES NOT ALREADY CONTAIN      * 01800002
*        16 EXTENTS, VIO IS NOT BEING USED, THE SECONDARY SPACE       * 01850002
*        VALUE IN THE JFCB IS NONZERO, AND ONE OF THE FOLLOWING       * 01900002
*        CONDITIONS EXIST -                                           * 01950002
*              1) DISPOSITION IS MOD OR NEW.                          * 02000002
*              2) DISPOSITION IS OLD AND THE LAST VOLUME SUPPLIED     * 02050002
*              IN THE JFCB IS BEING PROCESSED.                        * 02100002
*              3) DISPOSITION IS OLD AND THE LAST VOLUME SUPPLIED     * 02150002
*              IN THE JFCB IS NOT BEING PROCESSED BUT BIT 0 OF        * 02200002
*              DEBVOLSQ (THE 'TREAT AS NEW' BIT) IS SET TO ONE.       * 02250002
*                                                                     * 02300002
*        ADDITIONAL SPACE IS REQUESTED ON THE CURRENT VOLUME BY       * 02350002
*        GIVING CONTROL TO THE DADSM EXTEND ROUTINE'S FIRST MODULE,   * 02400002
*        IGG0553A, WITH REGISTER 13 SET TO 1.                         * 02450002
         EJECT                                                          02500002
*        IF SECONDARY SPACE IS ZERO, IFG0554T IS                      * 02800037
*        GIVEN CONTROL WITH INTERNAL ABEND CODE 186 CAUSING ABEND     * 02850002
*        D37-04.                                                      * 02900002
*                                                                     * 02950002
*        IF 1) THE DEB HAS 16 EXTENTS OR                              * 03000002
*        2) A VIO UNIT IS BEING PROCESSED OR                          * 03000102
*        3) THE DISPOSITION IS OLD AND THE LAST VOLUME SUPPLIED IN    * 03010002
*        THE JFCB IS NOT BEING PROCESSED AND THE 'TREAT AS NEW' BIT   * 03050002
*        (BIT 0 OF DEBVOLSQ) IS NOT SET TO ONE,                       * 03100002
*        MODULE IFG0554Z IS GIVEN CONTROL (IF SMF                     * 03160002
*        PROCESSING IS NOT REQUIRED) IN ORDER TO UPDATE               * 03200002
*        THE DSCB ON THE CURRENT VOLUME AND INTERFACE WITH USER       * 03250002
*        TRAILER LABEL PROCESSING IF REQUIRED.                        * 03300002
*        IF SMF PROCESSING IS REQUIRED UNDER THESE CIRCUMSTANCES,     * 03310002
*        MODULE IFG0553B (ALIAS FOR IFG0202H) IS GIVEN CONTROL WITH   * 03320002
*        DXRETMOD SET IN THE EOV WORKAREA CAUSING MODULE IFG0554Z TO  * 03330002
*        GAIN CONTROL AFTER SMF PROCESSING IS COMPLETED.              * 03340002
*                                                                     * 03350002
*        - 4 - ENTRY FROM IFG0554Z OR IFG0554N AFTER UPDATING THE     * 03400002
*        CURRENT VOLUME'S DSCB AND INTERFACING WITH USER LABEL        * 03450002
*        PROCESSING, THUS COMPLETING PROCESSING ON THE CURRENT        * 03500002
*        VOLUME.                                                      * 03520002
*                                                                     * 03600002
*        IF MORE VOLUMES ARE REQUESTED                                * 03650002
*        (USING THE JFCB VOLUME COUNT OR NUMBER OF                    * 03700002
*        VOLUMES, WHICHEVER IS GREATER), THE DATA MANAGEMENT          * 03750002
*        COUNT ON THE CURRENT VOLUME IS DECREMENTED AND, IF A         * 03752002
*        VIO UNIT, A WICLOSE IS ISSUED IF THE D. M. COUNT DROPS       * 03754002
*        TO ZERO. MODULE IFG0554A (ALIAS                              * 03760002
*        FOR IFG0194A) IS GIVEN CONTROL WITH REGISTER 14 SET TO       * 03800002
*        8 AND THE RETURN MODULE SET TO IFG0555H IN ORDER TO          * 03850002
*        MOUNT AND VERIFY THE NEXT VOLUME. IF THE DSCB IS PRESENT     * 03900002
*        ON THE NEXT VOLUME, IFG0554C (GIVEN CONTROL BY IFG0554A)     * 03950002
*        WILL PASS CONTROL TO IFG0555H TO BUILD A NEW DEB.            * 04000002
*        OTHERWISE A RETURN WILL BE MADE TO THIS MODULE               * 04050002
*        WITH REGISTER 14 SET TO 8.                                   * 04100002
*                                                                     * 04150002
*        IF NO MORE VOLUMES ARE REQUESTED, OR IF THIS IS A PDS,       * 04200002
*        IFG0554T IS GIVEN CONTROL WITH AN INTERNAL ABEND CODE OF     * 04250037
*        184 CAUSING AN E37-4 ABEND.                                  * 04300037
*                                                                     * 04350037
         EJECT                                                          04410002
*        - 8 - RETURN FROM IFG0554C AFTER MOUNTING A NEW VOLUME AND   * 04450002
*        NOT FINDING A DSCB ON THE VOLUME. REGISTER 13 IS SET TO 4    * 04500002
*        AND DADSM EXTEND MODULE IGG0553A IS GIVEN CONTROL TO         * 04550002
*        OBTAIN SECONDARY SPACE ON THE NEW VOLUME.                    * 04600002
*                                                                     * 04650002
*        - 12 - RETURN FROM SMF MODULE IFG0202I WHEN NO MORE VOLUMES  * 04700002
*        ARE AVAILABLE. PROBLEM DETERMINATION IS GIVEN CONTROL WITH   * 04750002
*        INTERNAL ABEND CODE 184 CAUSING AN E37-4 ABEND.              * 04800002
*                                                                     * 04850002
*        - 16 - ENTRY FROM IFG0554T AFTER TAKING THE B37 ABEND EXIT   * 04900002
*        AND RECEIVING A RETURN CODE FROM THE EXIT INDICATING FOR     * 04950002
*        EOV TO TRY ONCE AGAIN TO OBTAIN ADDITIONAL SPACE ON THE      * 05000002
*        CURRENT VOLUME. DADSM EXTEND MODULE IGG0553A IS GIVEN        * 05050002
*        CONTROL WITH REGISTER 13 SET TO 1, THE VALUE PASSED FROM     * 05100002
*        IFG0554T.                                                    * 05150002
*                                                                     * 05200002
*        2) IF WTGMODNM IN THE EOV WORKAREA IS SET TO IGG0553A, THIS  * 05250002
*        INDICATES THAT DADSM IS RETURNING AFTER ATTEMPTING TO        * 05300002
*        ACQUIRE ADDITIONAL SPACE ON THE CURRENT OR A NEW VOLUME.     * 05350002
*        A RETURN CODE IS IN REGISTER 13 -                            * 05400002
*                                                                     * 05450002
*        - 4 - SPACE WAS OBTAINED ON A NEW VOLUME. DEBF1CEV IN        * 05500002
*        DEBFLGS1 IS SET TO 1 (INDICATING THAT EOV HAS EXTENDED),     * 05550002
*        IF DCBC2PUT IS SET TO ONE IN DCBCIND2 (INDICATING            * 05600002
*        CLOSE CALLED EOV).                                           * 05650002
*        IFG0554C IS GIVEN CONTROL USING DXRETMOD AND DXRETCOD        * 05700002
*        (WHICH HAS BEEN SET UP BY IFG0554C BEFORE GIVING THIS        * 05750002
*        MODULE CONTROL WITH REGISTER 14 SET TO 8). THIS WILL         * 05800002
*        RESULT IN THE JFCB BEING UPDATED AND THE DSCB(S) BEING       * 05850002
*        READ AND MODULE IFG0555H BEING GIVEN CONTROL TO BUILD A      * 05900002
*        NEW DEB.                                                     * 05950002
*                                                                     * 06000002
*        - 1 - SPACE HAS BEEN OBTAINED ON THE CURRENT VOLUME.         * 06050002
*        DEBF1CEV IN DEBFLGS1 IS SET TO 1                             * 06100002
*        (INDICATING THAT EOV HAS EXTENDED),                          * 06150002
*        IF DCBC2PUT IS SET TO ONE IN DCBCIND2 (INDICATING            * 06200002
*        CLOSE CALLED EOV).                                           * 06250002
*        THE DSCB IS READ USING THE DEB'S DSCB BBCCHHR, AND CONTROL   * 06300002
*        IS GIVEN TO IFG0555H WITH REGISTER 14 SET TO 8 IN ORDER      * 06350002
*        TO BUILD A NEW DEB.                                          * 06400002
         EJECT                                                          06450002
*        - -1 - NO SPACE AVAILABLE ON THE CURRENT VOLUME. IF MORE     * 06500002
*        VOLUMES ARE SPECIFIED (USING THE VOLUME COUNT OR THE         * 06550002
*        NUMBER OF VOLUMES IN THE JFCB, WHICHEVER IS GREATER),        * 06600002
*        MODULE IFG0554Z IS GIVEN CONTROL (IF                         * 06650002
*        SMF PROCESSING IS NOT REQUIRED) TO UPDATE THE DSCB ON THE    * 06700002
*        CURRENT VOLUME AND PROCESS USER TRAILER LABELS IF NEEDED.    * 06750002
*        IFG0554Z WILL RETURN TO THIS MODULE WITH REGISTER 14 SET     * 06800002
*        TO 4.                                                        * 06850002
*                                                                     * 06860002
*        IF MORE VOLUMES ARE SPECIFIED AND SMF PROCESSING IS          * 06870002
*        REQUIRED, MODULE IFG0553B (ALIAS FOR IFG0202H) IS GIVEN      * 06880002
*        CONTROL WITH DXRETMOD IN THE EOV WORKAREA CAUSING CONTROL    * 06890002
*        NEXT TO BE GIVEN TO IFG0554Z AFTER SMF PROCESSING IS DONE.   * 06892002
*                                                                     * 06894002
*        IF NO MORE VOLUMES ARE SPECIFIED, IFG0554T                   * 06900037
*        IS GIVEN CONTROL WITH INTERNAL ABEND CODE 184 CAUSING        * 06950002
*        AN E37-4 ABEND, IF SMF PROCESSING IS NOT REQUIRED.           * 07000002
*        IF SMF PROCESSING IS REQUIRED UNDER THIS SITUATION,          * 07010002
*        MODULE IFG0553B (ALIAS FOR IFG0202H) IS GIVEN CONTROL WITH   * 07050002
*        DXRETMOD INDICATING THAT CONTROL SHOULD RETURN TO THIS       * 07100002
*        MODULE WITH 12 IN REGISTER 14, WHICH WILL RESULT IN THE      * 07102002
*        E37-4 ABEND.                                                 * 07104002
*                                                                     * 07110002
*        - -4 - NO SPACE COULD BE OBTAINED ON A NEW VOLUME.           * 07150002
*        IF THE NEW VOLUME IS FOR A NON-SPECIFIC REQUEST, MODULE      * 07200002
*        IFG0554A IS GIVEN CONTROL WITH REGISTER 14 SET TO 16         * 07250002
*        TO REJECT THE CURRENT VOLUME AND MOUNT ANOTHER.              * 07300002
*        OTHERWISE, IFG0554T IS GIVEN CONTROL WITH AN                 * 07350037
*        INTERNAL ABEND CODE OF 183 CAUSING AN E37-8 ABEND.   @ZA15053* 07400037
*                                                                     * 07450002
*        - -8 - A VOLUME WAS ENCOUNTERED WHOSE VTOC COULD             * 07500002
*        NOT BE CONVERTED TO STANDARD FORMAT.                         * 07550002
*        IF THE NEW VOLUME IS FOR A NON-SPECIFIC REQUEST, MODULE      * 07600002
*        IFG0554A IS GIVEN CONTROL WITH REGISTER 14 SET TO 16         * 07650002
*        TO REJECT THE CURRENT VOLUME AND MOUNT ANOTHER.              * 07700002
*        OTHERWISE, PROBLEM DETERMINATION IS GIVEN CONTROL WITH       * 07750002
*        AN INTERNAL ABEND CODE OF 177 CAUSING AN B37-8 ABEND.        * 07800002
*                                                              @Z40RSDH 07800208
*        - -12 - RACDEF IN EXTEND FAILED. IF THE DATA SET ON   @Z40RSDH 07800408
*        THE VOLUME PROCESSED AT OPEN IS DEFINED TO RAC A RIDT @Z40RSDH 07800608
*        IS BUILT. EXTEND CHECKS TO SEE IF THE DATA SET ON THE @Z40RSDH 07800808
*        FIRST VOLUME WAS DEFINED TO RAC AND IF IT WAS THEN    @Z40RSDH 07801008
*        A RACDEF TYPE=ADDVOL IS ISSUED TO DEFINE THE NEWLY    @Z40RSDH 07801208
*        CREATED DATA SET/VOLUME TO RAC. THIS WILL FAIL IF     @Z40RSDH 07801408
*        THE DATA SET NAME AT EOV IS NOT THE SAME AS AT OPEN;  @Z40RSDH 07801608
*        HENCE AN INTERVENING OPENJ MUST HAVE ALTERED THE      @Z40RSDH 07801808
*        DATA SET NAME.                                        @Z40RSDH 07802208
*                                                                     * 07850002
*        - -16 - AN I/O ERROR WAS ENCOUNTERED IN PROCESSING THE VTOC. * 07900002
*        IF THE NEW VOLUME IS FOR A NON-SPECIFIC REQUEST, MODULE      * 07950002
*        IFG0554A IS GIVEN CONTROL WITH REGISTER 14 SET TO 16         * 08000002
*        TO REJECT THE CURRENT VOLUME AND MOUNT ANOTHER.              * 08050002
*        OTHERWISE, PROBLEM DETERMINATION IS GIVEN CONTROL WITH       * 08100002
*        AN INTERNAL ABEND CODE OF 190 CAUSING AN 737-4 ABEND.        * 08150002
         EJECT                                                          08200002
* NOTES =                                                             * 08250002
*        THE 'TREAT AS NEW' BIT IS USED AS FOLLOWS.                   * 08300002
*        SECONDARY SPACE WILL NOT BE ACQUIRED ON THE VOLUMES OF       * 08350002
*        OF AN OLD DATA SET UNTIL THE LAST VOLUME OR UNTIL A          * 08400002
*        VOLUME IS ENCOUNTERED UPON WHICH NO DSCB RESIDES. AT         * 08450002
*        THIS POINT THE HIGH ORDER BIT OF DEBVOLSQ IS SET TO ONE      * 08500002
*        TO INFORM THIS MODULE THAT, EVEN THOUGH AN OLD DATA SET      * 08550002
*        IS BEING PROCESSED AND THE LAST VOLUME SPECIFIED IN THE      * 08600002
*        JFCB HAS NOT YET BEEN ENCOUNTERED, SECONDARY SPACE SHOULD    * 08650002
*        ATTEMPT TO BE ACQUIRED.                                      * 08700002
*        IFG0555H TURNS THIS BIT ON.                                  * 08750002
*                                                                     * 08800002
*    DEPENDENCIES =                                                   * 08850002
*            CLASS ONE CHARACTER CODE.  THE EBCDIC CHARACTER CODE     * 08900002
*            WAS USED FOR ASSEMBLY.  THE MODULE MUST BE REASSEMBLED   * 08950002
*            IF A DIFFERENT CHARACTER SET IS USED FOR EXECUTION.      * 09000002
*                                                                     * 09050002
*    RESTRICTIONS = NONE                                              * 09100002
*                                                                     * 09110002
*    REGISTER CONVENTIONS =                                           * 09200002
*            R2 POINTS TO DCB                                         * 09250002
*            R4 POINTS TO OPEN WORK AREA                              * 09300002
*            R5 POINTS TO THE RESIDENT ROUTINE                        * 09350002
*            R6 POINTS TO THE WTG TABLE                               * 09400002
*            R7 POINTS TO THE CURRENT PARAMETER LIST ENTRY            * 09450002
*            R8 POINTS TO THE CURRENT WTG TABLE ENTRY                 * 09500002
*            R9 POINTS TO THE DD ENTRY IN THE TIOT                    * 09550002
*            R10 POINTS TO THE UCB                                    * 09600002
*                                                                     * 09650002
*    PATCH LABEL = SEE THIRD FROM LAST LABEL BEFORE ORG STATEMENT AT  * 09700002
*                  END OF LISTING.                                    * 09750002
*                                                                     * 09800002
* MODULE TYPE = CONTROL (OPEN, CLOSE, EOV DATA MANAGEMENT)            * 09850002
*                                                                     * 09860002
*    PROCESSOR = ASSEMBLER XF                                         * 09870002
*                                                                     * 09880002
*    MODULE SIZE = SEE EXTERNAL SYMBOL DICTIONARY OR LOC FIELD ON     * 09890002
*                  ORG STATEMENT AT END OF LISTING                    * 09892002
*                                                                     * 09894002
*    ATTRIBUTES = REENTRANT, REFRESHABLE,READ-ONLY, ENABLED,          * 09896002
*                 PRIVILEGED, SUPERVISOR STATE, DATA MANAGEMENT KEY,  * 09898002
*                 LINK PACK AREA RESIDENT/PAGEABLE                    * 09898402
*                                                                     * 09898802
* ENTRY POINT =                                                       * 09899202
*        IFG0554P                                                     * 09899602
*                                                                     * 09899702
*    PURPOSE = SEE FUNCTION                                           * 09899802
         EJECT                                                          09909802
*    LINKAGE =                                                        * 09933202
*        THIS MODULE IS TRANSFERRED CONTROL THROUGH THE IECRES-LOAD   * 09943202
*        MACRO INSTRUCTION.                                           * 09953202
*                                                                     * 09955202
* INPUT =                                                             * 09965202
*        GIVEN CONTROL IN PROTECT KEY 5.                              * 09965602
*        REGISTER 2 POINTS TO THE COPIED DCB.                         * 09966002
*        DEBDCBAD POINTS TO THE COPIED DCB.                           * 09966402
*        REGISTER 4 POINTS TO THE EOV WORKAREA                        * 09966502
*                                                                     * 09966602
*        DADSM RETURN -                                               * 09977702
*        WTGMODNM IN THE EOV WORKAREA SET TO 'IGG0553A'.              * 09987702
*        REGISTER 13 CONTAINS RETURN CODE 4, 1, -1, -4, -8, OR -16.   * 09988102
*                                                                     * 09988602
* OUTPUT =                                                            * 09988702
*        THE NEXT MODULE IS GIVEN CONTROL IN PROTECT KEY 5 WITH       * 09988802
*        REGISTER 2 POINTING TO THE COPIED DCB,                       * 09992502
*        THE DEBDCBAD POINTING TO THE COPIED DCB,                     * 09994502
*        AND REGISTER 4 POINTING TO THE EOV WORKAREA,                 * 09994902
*                                                                     * 09995302
*        IFG0553B -                                                   * 09995702
*        DXRETMOD SET TO ID-VCON OF IFG0554Z OR IFG0554P.             * 09996102
*        REGISTER 14 SET TO ZERO (DXRETMOD FOR IFG0554Z),             * 09996202
*        OR TO 12 (DXRETMOD FOR IFG0554P).                            * 10022102
*                                                                     * 10032102
*        IFG0554Z -                                                   * 10042102
*        REGISTER 14 SET TO 0.                                        * 10044102
*                                                                     * 10046102
*        IFG0554A -                                                   * 10048102
*        DXRETMOD SET UP -                                            * 10056702
*              IFG0555H TO GET A NEW VOLUME                           * 10058702
*              UNTOUCHED IF REJECTING THE CURRENT NON-SPECIFIC VOL    * 10060702
*        DXRETCOD SET UP -                                            * 10062702
*              8 TO GET A NEW VOLUME                                  * 10064702
*              UNTOUCHED IF REJECTING THE CURRENT NON-SPECIFIC VOL    * 10065102
*        REGISTER 14 CONTAINS AN ENTRY CODE -                         * 10065202
*              0 TO GET A NEW VOLUME                                  * 10065302
*              16 TO REJECTEC THE CURRENT NON-SPECIFIC VOLUME         * 10065402
*                                                                     * 10074002
*        IFG0555H -                                                   * 10076002
*        REGISTER 14 CONTAINS 12                                      * 10078002
*                                                                     * 10080002
*        IFG0550P GIVEN CONTROL THROUGH DMABCOND MACRO -              * 10082002
*        REGISTER 0 CONTAINS INTERNAL ABEND CODE                      * 10082402
*                                                                     * 10082502
*        IGG0553A - DADSM EXTEND -                                    * 10082602
*        REGISTER 13 CONTAINS FUNCTION CODE -                         * 10082702
*              1 - OBTAIN SPACE ON THE CURRENT VOLUME.                * 10106102
*              4 - OBTAIN SPACE ON A NEW VOLUME.                      * 10116102
*                                                                     * 10116537
*        IFG0554T -                                                   * 10118137
*        REGISTER 12 CONTAINS INTERNAL ABEND CODE                     * 10122137
         EJECT                                                          10126102
* EXIT-NORMAL =                                                       * 10128102
*        IFG0554Z TO UPDATE THE CURRENT VOLUME'S DSCB AND             * 10128502
*        PROCESS USER TRAILER LABELS.                                 * 10128902
*        IFG0554A TO REJECT THE CURRENT NON-SPECIFIC REQUEST          * 10129302
*        VOLUME AND/OR MOUNT A NEW VOLUME.                            * 10129702
*        IFG0553B (ALIAS FOR IFG0202H) FOR SMF PROCESSING.            * 10137502
*        IFG0555H TO BUILD A NEW DEB.                                 * 10139502
*        IGG0553A TO OBTAIN ADDITIONAL SPACE (DADSM EXTEND)           * 10141502
*                                                                     * 10143502
* EXIT-ERROR =                                                        * 10143902
*        IFG0550P GIVEN CONTROL THROUGH DMABCOND MACRO WITH AN        * 10144302
*        INTERNAL ABEND CODE IN REGISTER 0 -                          * 10144702
*        190 - 737-4 - I/O ERROR READING DSCB OR I/O ERROR RETURN     * 10145102
*        CODE PASSED BACK FROM DADSM.                                 * 10145202
*        177 - B37-8 - VTOC COUND NOT BE CONVERTED TO                 * 10147437
*        STANDARD FORMAT BY DADSM.                                    * 10149437
*        IFG0554T GIVEN CONTROL WITH AN INTERNAL ABEND CODE IN        * 10149837
*        REGISTER 12 -                                                * 10150237
*        186 - D37-4 - NO SECONDARY SPACE SUPPLIED.                   * 10150837
*        184 - E37-04 - NO MORE VOLUMES SPECIFIED IN JFCB (VOLUME     * 10153102
*        COUNT OR NUMBER OF VOLUMES REACHED).                         * 10155237
*        184 - E37-08 - NO SPACE AVAILABLE ON NEW VOLUME OR   @ZA15053  10157237
*        DUPLICATE NAME FOUND ON NEW VOLUME                   @ZA15053  10159237
*        005 - 937-38 RACDEF FAILED AT EXTEND                  @Z40RSDH 10159308
*                                                                     * 10161837
* EXTERNAL REFERENCES = SEE BELOW                                     * 10164037
*                                                                     * 10166237
*    ROUTINES =                                                       * 10168437
*        IFG019RA THROUGH THE IECRES MACRO.                           * 10170637
*                                                                     * 10172837
*    DATA AREAS =                                                     * 10175037
*        EOV WORKAREA.                                                * 10177237
*                                                                     * 10179437
*    CONTROL BLOCK =                                                  * 10181637
*        DCB                                                          * 10183837
*        TCB                                                          * 10186037
*        CVT                                                          * 10188237
*        UCB                                                          * 10190437
*        VDSCB                                                        * 10192637
*        DEB                                                          * 10194837
*                                                                     * 10197002
* TABLES =                                                            * 10207002
*        NONE.                                                        * 10217002
         EJECT                                                          10217402
* MACROS =                                                            * 10217802
*        MODESET                                                      * 10217902
*        IECRES-LOAD                                                  * 10224702
*        IECRES-GET                                                   * 10226702
*        EXCP                                                         * 10228702
*        WAIT                                                         * 10230702
*        DMABCOND                                                     * 10231102
*        XCTLTABL                                                     * 10231502
*        IECDSECS                                                     * 10231602
*        IECEQU                                                       * 10238402
*                                                                     * 10240402
* CHANGE ACTIVITY =                                                   * 10242402
*        SEE CHANGES/DELETIONS SECTION JUST AFTER CSECT CARD.         * 10244402
*                                                                     * 10244802
*********************************************************************** 10245202
         EJECT                                                          10245302
EABD183  EQU   183                      E37-8 ABEND INTERNAL            10247337
*                                       CODE                   @YA15053 10249337
EABD184  EQU   184                      E37-4 ABEND INTERNAL CODE       10252202
EABD177  EQU   177                      B37-8 INTERNAL ABCODE    M0179  10259002
EABD186  EQU   186                      D37-4 ABEND INTERNAL CODE       10279502
EABD190  EQU   190                      737-4 ABEND INTERNAL CODE       10300002
         BALR  RBASE,0                  ESTABLISH ADDRESSABILITY        10400021
         USING FORCORE,RCORE                                            10500021
         USING WTG,RWTG                 WHERE-TO-GO TABLE        Y02080 10550002
         USING TIOENTRY,RTIOT                                           10600021
         USING UCB,RUCB                                                 10700021
         USING DEBBASIC,RDEB                                            10800002
         USING IHADCB,RDCB              ADDRESSABILITY FOR DCB          10900021
         USING *,RBASE                                                  11000021
*                                                                       11100021
*                                                                       11300021
         CLC   WTGMODNM,IGG0553A        CHECK FOR DADSM ENTRY    Y02134 11400002
         BE    EDO03500                 BRANCH IF EXTEND RETURN  Y02134 11500002
*                                                                       11600021
*      BRANCH TABLE RET IS SET TO THE FOLLOWING VALUES                  11700021
*                RET=0   FROM BASIC STRING IFG0551H                     11800021
*                RET=4   FROM IFG0554Z OR IFG0554N               Y02134 11900002
*                        OR FROM IFG0202I BY WAY OF IFG0554N     Y02134 11910002
*                RET=8   FROM NEW VOLUME MOUNT TO EXTEND         Y02134 11950002
*                RET=12  FROM SMF AFTER EXTEND ERROR             Y02134 12000002
*                RET=16  FROM B37 ABEND EXIT RETURN              Y02082 12050002
*                                                                       12200021
         B     EDO02700(RET)            BRANCH TABLE                    12300021
EDO02700 EQU   *                        BRANCH TABLE                    12400002
         B     EDO02800                 FROM BASIC IFG0551H             12500021
         B     EDO03800                 FROM 554Z OR 554N        Y02134 12600002
         B     EDO02910                 ENTRY FROM IFG0554C      Y02134 12700002
         B     EDO03660                 FROM IFG0553B AFTER ERR  Y02134 12750002
         B     EDO03300                 ENTRY FROM IFG0554T      Y02134 12800002
         EJECT                                                          13000002
EDO02800 EQU   *                        RET=0 FROM IFG0551H             13100002
*                                                                Y02134 13150002
         L     RUCB,DXUCBADR            LOAD UCB ADDRESS         Y02134 13200002
         L     RDEB,DCBDEBAD            LOAD DEB ADDRESS         Y02134 13250002
         MVC   DXDEBUCB+K1(K3),DXUCBADR+K1 MOVE UCB TO WORK AREA Y02134 13400002
*                                                                       13500021
*        COMPUTE OFFSET FOR DEBVOLSQ REFERENCES                         13600021
*                                                                       13700021
         SR    RC,RC                    ZERO REG.                       13800021
         IC    RC,DEBNMEXT              PICK UP NO.EXTENTS              13900021
         SLL   RC,K4                    MPY BY 16-BYTES PER EXTENT      14100021
         AR    RC,RDEB                  ADD DEB BASE ADDRESS            14200021
*                                                                Y02134 14250002
         LA    RD,K1                    SET REG TO 1             Y02132 14300002
         LNR   RD,RD                    INDIC NO SPACE           Y02132 14350002
         TM    JFCBIND2,JFCMOD          IS IT AN OLD DATA SET           15300002
*                                       HI ORDER BITS OF JFCBIND2       15400002
*                                       01=OLD                          15450002
*                                       11=NEW                          15500002
*                                       10=MOD                          15600002
*                                                                       15700021
         BO    EDO02900                 NO GO GET SPACE ON THIS VOL     15800021
*                                                                       15800102
*        OLD DATA SET                                                   15800202
*                                                                       15800302
         CLC   JFCBNVOL,DXVOLSEQ+K1     CHECK FOR LAST VOL       Y02134 15900002
         BNH   EDO02900                 BRANCH IF LAST VOL       Y02134 16000002
         TM    DEBVOLSQ-DEBACSMD+DEBSUCBA-DEBTCBAD(RC),JFCMOD  @ZA06676 16100037
*                                       TREAT AS NEW ON?       @ZA06676 16150037
         BZ    EDO03515                 NO,DETERMINE DISPO-5F    YM3862 16200002
         EJECT                                                          16300002
EDO02900 EQU   *                        GET SPACE ON THIS VOLUME        16700002
*                                                                Y02134 16750002
*****************************************************************Y02134 16760002
*                                                                Y02134 16770002
*        SET REGISTER RD = 1 - INDICATOR TO GET SPACE            Y02134 16780002
*                              ON SAME VOLUME                    Y02134 16790002
*                                                                Y02134 16792002
*****************************************************************Y02134 16794002
*                                                                Y02134 16796002
         LA    RD,K1                    GET SPACE ON CURRENT VOL Y02134 16798802
         B     EDO02920                 EXTEND ON CURRENT VOL    Y02134 16799202
*                                                                Y02134 16799602
EDO02910 EQU   *                        RET=8 - FROM IFG0554C    Y02134 16799702
*                                                                Y02134 16809502
*****************************************************************Y02134 16813902
*                                                                Y02134 16818302
*        SET REGISTER RD = 4 - INDICATOR TO GET SPACE            Y02134 16822702
*                              ON NEXT (CURRENT NOW) VOLUME      Y02134 16827102
*                                                                Y02134 16831502
*****************************************************************Y02134 16835902
*                                                                Y02134 16840302
         OC    JFCBSQTY(K3),JFCBSQTY    IS SECONDARY QTY SPEC. @ZA12174 16841337
         BZ    EDO03650                 BRANCH IF NO           @ZA12174 16842337
         LA    RD,K4                    GET SPACE ON NEXT VOLUME Y02134 16844702
         B     EDO03300                 BRANCH TO EXTEND         Y02134 16849102
         EJECT                                                          16853502
EDO02920 EQU   *                        SEE IF SPACE CAN BE      Y02134 16857902
*                                       OBTAINED ON THIS VOLUME  Y02134 16862302
         CLI   DEBNMEXT,K16             CHECK FOR 16 EXTENTS            16866702
         BNL   EDO03515                 BRANCH IF 16 OR MORE     Y02134 16900002
*                                                                Y02134 16950002
EDO03000 EQU   *                        CHECK SECONDARY QUANTITY        17000002
*                                                                Y02134 17050002
         OC    JFCBSQTY(K3),JFCBSQTY    IS SECONDARY QTY SPECIFIED      17100021
         BZ    EDO03650                 BRANCH IF NO SPACE SPEC  Y02134 17160002
         TM    UCBJBNR,UCBVRDEV         TEST FOR VIO UCB         YM7888 17210002
         BO    EDO03515                 BR IF YES                YM7888 17260002
*                                                                Y02134 21650002
EDO03300 EQU   *                        RET=16 - RETURN FROM B37 EXIT   22100002
*                                                                Y02134 22150002
*        EXTEND IGG0553A SAVES REGS 2-12                         Y02134 22200002
*                                                                Y02134 22300002
         ST    RES,DXWORK               SAVE RES POINTER         Y02134 22350002
         MVC   DXWORK1(K8),DXCCW12      SAVE RETURN INFORMATION  Y02134 22400002
         L     R5,DCBDEBAD              LOAD DEB ADDRESS         Y02134 24050002
         L     RA,DXUCBADR              LOAD UCB INTERFACE       Y02134 24060002
         LA    RWTG,DXXAREA             POINT TO WTG TABLE       Y02134 24110002
         MVC   DXXMODNM(K12),IGG0553A   EXTEND ROUTINE           Y02134 24150002
         OI    DXATEOV,DXATDADM         SHOW GOING TO EXTEND     Y02144 24150102
         MVI   DXEXTSW,CHAR00           ZERO EXTEND SWITCH       Y02082 24160102
*                                                                Y02134 24200002
         IECRES LOAD,PREFIX=DXXPREFX,BRANCH=DIRECT               Y02080 24450002
         EJECT                                                          24460002
*********************************************************************** 24600021
*                                                                Y02134 24650002
*        RETURN HERE FROM DADSM WITH RESULT INDICATED IN  RD            24700002
*        + INDICATES SPACE OBTAINED,  - INDICATES NO SPACE              24800021
*                                                                       24900021
*****************************************************************Y02134 24950002
*                                                                Y02134 24960002
EDO03500 EQU   *                        DADSM RETURN POINT              25000002
*                                                                Y02134 25050002
         NI    DXATEOV,ALLBITS-DXATDADM SHOW BACK FROM EXTEND    Y02144 25060002
         MVC   WTGMODNM,NAME554P        SET UP WTG NAME          Y02134 25150002
         STM   RTIOT,RC,DXREGSAV        RESTORE REGISTERS               25600021
         MVI   DXRESIND,K0              ZERO RESIDENT RTN SW    SA57998 25602002
         L     RES,DXWORK               RESTORE RES POINTER      Y02134 25610002
         MVC   DXCCW12(K8),DXWORK1      RESTORE RETURN INFO      Y02134 25650002
         SR    R0,R0                    ZERO REGISTER                   25700021
         ST    R0,DXCCW6                ZERO RESIDENT RTN INDICATOR     25800021
*                                                                       26500021
*****************************************************************Y02134 27500002
*                                                                       27700021
*                        CHECK IF SPACE AVAILABLE                       27800021
*                                                                       27900021
*****************************************************************Y02134 27950002
*                                                                Y02134 27960002
EDO03502 EQU   *                        IS RD POSITIVE           Y02132 27960202
         LTR   RD,RD                    SET CONDITION CODE              28000021
*                                                                Y02134 28050002
*****************************************************************Y02134 28060002
*                                                                       28100021
*        ON RETURN FROM EXTEND ROUTINE, RD IS POSITIVE           Y02134 28200002
*        IF SPACE WAS OBTAINED AND NEGATIVE IF NOT.                     28300021
*                                                                       28400021
*****************************************************************Y02134 28450002
*                                                                Y02134 28452002
         BP    EDO03560                 CHECK DADSM RETURN CODE  Y02134 28460002
*                                                                Y02134 28560002
         LPR   RD,RD                    GET POSITIVE VALUE       Y02134 28562002
         BCT   RD,EDO03520              BRANCH, COUNT NOT ONE    Y02134 28564002
         EJECT                                                          28566002
*****************************************************************Y02134 28568002
*                                                                Y02134 28568402
*        UNABLE TO OBTAIN SPACE ON CURRENT VOLUME - RD = -1      Y02134 28568502
*                                                                Y02134 28568802
*****************************************************************Y02134 28569202
*                                                                Y02134 28569602
EDO03515 EQU   *                        MORE VOLUMES AVAILABEL   Y02134 28588802
*                                                                Y02134 28590002
         TM    DXXPATHS,WTGSMF          TEST FOR SMF             Y02134 28590102
         BNO   EDO03516                 GO TO USER LABEL ROUTINE Y02134 28590202
*                                                                Y02134 28590302
         LA    RET,K4                   SET UP ENTRY OFFSET      YM6729 28590602
         MVC   DXRETMOD,ID4P4Z          RETURN FOR USER LBLS     Y02134 28591002
         LA    R7,ID4P3B                SMF ROUTINE              Y02134 28591402
         B     EDO03790                 GO TO SMF ROUTINE        Y02134 28591502
*                                                                Y02134 28591902
EDO03516 EQU   *                        UPDATE CURR VOL'S DSCB,  Y02134 28592002
*                                       CHECK FOR USER LABELS    Y02134 28592102
         LA    RET,K0                   SET UP RETURN OFFSET     Y02134 28592802
         LA    R7,ID4P4Z                USER LABEL PROCESSING    Y02134 28592902
         B     EDO03790                 PROCESS USER LABELS      Y02134 28593002
         EJECT                                                          28593102
EDO03520 EQU   *                        -4,-8,-12,-16 FR DADSM @Z40RSDH 28593208
*                                                                Y02134 28593402
         LA    RD,K1(RD)                INCREMENT FOR BR TABLE   Y02134 28595202
EDO03530 EQU   *                        BRANCH TABLE             Y02134 28596002
         B     EDO03530(RD)             RD WILL NEVER BE ZERO    Y02134 28596402
         B     EDO03655                 RD=4 NO SPACE ON NEW   @ZA15053 28596837
*                                       VOLUME                 @ZA15053 28597437
         B     EDO03670                 RD=8 VTOC NOT CONVERTED  Y02134 28598002
         B     EDO03590                 RD=12 RACDEF ERROR     @Z40RSDH 28598408
         B     EDO03640                 RD=16 EXTEND I/O ERROR   Y02134 28599202
*                                                                Y02134 28901602
*****************************************************************Y02134 28903602
*                                                                Y02134 28905602
*        SPACE HAS BEEN SUCCESSFULLY OBTAINED                    Y02134 28907602
*                                                                Y02134 28908002
*****************************************************************Y02134 28908402
*                                                                Y02134 28909602
EDO03560 EQU   *                        RD = 1, 4 FROM DADSM     Y02134 28919602
*                                                                Y02134 28929602
         TM    DCBMACRF,DCBMEXCP        TEST FOR EXCP           SA59750 28931602
         BO    EDO03570                 BRANCH IF EXCP          SA59750 28932002
         TM    DCBCIND2,DCBC2PUT        EOV CALLED DURING CLOSE  M0050  28933602
         BNO   EDO03570                 BYPASS CLOSE/EOV BIT     M0050  28937602
*                                                                Y02134 28938002
         OI    DEBFLGS1,DEBF1CEV        INDICATE TO CLOSE THAT   Y02080 28938402
*                                       EOV WAS CALLED BY QSAM   M0050  28938802
*                                       EOB MODULE TO GET SPACE  M0050  28939202
*                                                                Y02134 28939302
EDO03570 EQU   *                        SEE IF 1 OR 4            M0050  28939402
*                                                                Y02134 28939902
         BCT   RD,EDO03580              BRANCH IF NEW VOLUME     Y02134 28940302
*                                                                Y02134 28941102
         B     EDO04000                 READ F1 DSCB FUNCTION    M0050  28958202
*                                                                Y02134 28959802
EDO03580 EQU   *                        RD = 4 - RETURN TO       M0050  28961802
*                                       DXRETMOD (IFG0554C)      Y02134 28963802
         XR    RET,RET                  CLEAR FOR IC INST        Y02134 28965802
         IC    RET,DXRETCOD             LOAD RETURN OFFSET       Y02134 28966202
         LA    R7,DXRETMOD              POINT TO RETURN MODULE   Y02134 28979502
         B     EDO03790                 RETURN                   Y02134 29006902
*                                                              @Z40RSDH 29007108
EDO03590 EQU   *                        RD = 12 RACDEF ERROR   @Z40RSDH 29007308
         LA    R0,EABD005               937-38 TO PROB DET     @Z40RSDH 29007508
         B     EDO03680                 ABEND                  @Z40RSDH 29007708
         EJECT                                                          29020202
*****************************************************************Y02134 29033502
*                                                                Y02134 29046802
*        ERROR EXITS                                             Y02134 29060102
*                                                                Y02134 29073402
*****************************************************************Y02134 29086702
*                                                                Y02134 29100002
EDO03640 EQU   *                        737-4 TO PROB. DET.      Y02134 30604002
         LA    R0,EABD190               I/O ERROR ON R/W DSCB    Y02134 30610002
*                                       IN EXTEND                Y02134 30612002
         B     EDO03680                 ISSUE 737 ABEND          Y02134 30620002
*                                                                Y02134 30650002
EDO03650 EQU   *                        D37-4 TO PROB. DET.             30700002
         LA    RC,EABD186               D37 ABEND              @ZA02218 30750437
*                                       NO SECONDARY SPACE SPEC  Y02134 30750802
         LA    R7,ID4P4T                D37/E37 ABEND ROUTINE  @ZA02218 30751237
         B     EDO03790                 BRANCH TO IFG0554T     @ZA02218 30752037
*                                                                       30760037
EDO03655 EQU   *                        E37-8 TO PROB. DET.    @ZA15053 30760637
         LA    RC,EABD183               SPACE NOT AVAIL. OR    @ZA15053 30761237
*                                       DUP. NAME ON NEW VOL   @ZA15053 30761837
         B     EDO03665                 ISSUE E37-8 ABEND      @ZA15053 30762437
*                                                              @ZA15053 30763037
*                                       R14 = 12                        30764002
*                                       RETURN FROM SMF PROCESSING      30766002
EDO03660 EQU   *                        E37-4 TO PROB DET.       Y02134 30770002
         LA    RC,EABD184               E37 FAIL TO EXTEND     @ZA02218 30790037
*                                       ALL VOL USED             Y02134 30790402
EDO03665 CLC   DXVOLSR2,SCRTCH          NONSPECIFIC REQUEST?   @ZA15053 30790837
         BE    EDO03700                 BR TO GET NEW VOL      @ZA02218 30790937
         LA    R7,ID4P4T                D37/E37 ABEND ROUTINE  @ZA02218 30791037
         B     EDO03790                 BRANCH TO IFG0554T     @ZA02218 30791237
*                                                                Y02134 30793202
EDO03670 EQU   *                        B37-8 TO PROB DET        Y02134 30794002
         LA    R0,EABD177               B37 ABEND                Y02134 30796402
*                                       UNABLE TO MOUNT NEW VOL. Y02134 30796802
         B     EDO03680                 BR TO PROB DET         @ZA02218 30797237
EDO03680 EQU   *                        GO TO PROB DETERMINATION Y02134 30825537
*                                                                Y02134 30839102
         CLC   DXVOLSR2,SCRTCH          NONSPECIFIC REQUEST     ZA01265 30841102
         BE    EDO03700                 BRANCH TO GET NEW VOL   ZA01265 30841602
         NI    DCBOFLGS,ALLBITS-DCBOBUSY  TURN OFF BUSY BIT      Y02134 30859402
         LA    RWTGC,DXXENTRY           SET R8 FOR RES RTN              30879702
         LA    RWTG,DXXAREA             POINT TO EOV WTG                30900021
         DMABCOND (0),ID4P0P            LOAD ERROR CODE          Y02134 31000002
         SPACE 2                                                        31050002
*                                                               ZA01265 31050502
EDO03700 EQU   *                        REJECT CURRENT VOL      ZA01265 31051002
*                                                               ZA01265 31051102
*        IFG0554A SAVED PREV RETMOD/RETCOD IN SAVEMOD/SAVEOFF   ZA01265 31051202
         MVC   DXRETMOD,DXSAVMOD        RESTORE TO PREV RETMOD  ZA01265 31051302
         MVC   DXRETCOD,DXSAVOFF        RESTORE TO PREV RETCOD  ZA01265 31051402
         LA    RET,K16                  LOAD REJECT OFFSET      ZA01265 31051902
         LA    R7,ID4P4A                NEW VOL MOUNT ROUTINE   ZA01265 31052002
*                                                                Y02134 31052402
EDO03790 EQU   *                        EXIT TO NEXT MODULE      Y02134 31450002
         LA    RWTGC,DXXENTRY           SET R8 FOR RES RTN       Y02134 31460002
         LA    RWTG,DXXAREA             POINT TO EOV WTG         Y02134 31470002
         IECRES LOAD,MODID=(R7),BRCODE=(RET),BRANCH=QUEUED       Y02080 31480002
         EJECT                                                          31492002
*********************************************************************** 31500021
*                                                                       31550002
*        RET = 4 ENTRY POINT                                            31560002
*        RETURN FROM IFG0554N OR IFG0554Z                               31570002
*                                                                Y02134 31600002
*        NEW VOLUME MOUNTING FUNCTION                            Y02134 31650002
*                                                                Y02134 31660002
*        DECREMENT DM COUNT IF MORE VOLUMES ARE SPECIFIED               31900002
*                                                                       32000021
*****************************************************************Y02134 32050002
*                                                                       32050402
EDO03800 EQU   *                        DECREMENT D.M. COUNT     YM6520 32052002
         XR    RET,RET                  CLEAR REG FOR IC INST  @ZA18328 32054008
         IC    RET,JFCBNVOL             GET NUMBER OF VOLUMES  @ZA18328 32057008
         CH    RET,DXVOLSEQ             CHECK FOR MORE VOLUMES @ZA18328 32060008
         BH    EDO03804                 BRANCH IF MORE VOLUMES @ZA18328 32063008
         OC    JFCBSQTY(K3),JFCBSQTY    SECONDARY QTY SPEC?    @ZA18328 32066008
         BZ    EDO03650                 ABEND IF NOT SPECIFIED @ZA18328 32069008
*                                                              @ZA18328 32072008
EDO03804 EQU   *                                               @ZA18328 32075008
*                                                                YM6520 32078002
         TM    DSCFILTY,DCBORGPO        IS THIS A PARTITIONED    YM6520 32080002
*                                       DATA SET                 YM6520 32082002
         BO    EDO03660                 ABEND IF YES, NO SUCH    YM6520 32084002
*                                       THING AS MULTIVOLUME PDS YM6520 32086002
         EJECT                                                          32088002
         L     RF,DXXPREFX              GET PREFIX ADDR          YM3868 32105002
         USING IECPREFX,RF              USING FOR PREFIX         YM3868 32110002
         STM   RB,RET,IECREGSV          SAVE SETLOCK REGS        YM3868 32115002
         MODESET EXTKEY=SUPR            SETLOCK KEY              YM3868 32120002
EDO03805 SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                  YM3868*32125002
               RELATED=(LOCAL,IFG0554P(EDO03817)) GET LOCAL LOCK YM3868 32130002
         MODESET EXTKEY=DATAMGT         RETURN TO D.M. KEY       YM3868 32135002
         LM    RB,RET,IECREGSV          RESTORE REGS             YM3868 32140002
*                                                                Y02134 32150002
         L     RUCB,DXUCBADR            GET UCB ADDR             Y02134 32150402
         LA    RF,K1                    LOAD DECREMENT VALUE     Y02134 32152002
*        SHIFT DECREMENT TO USE WITH CS INSTRUCTION              Y02134 32154002
         SLL   RF,K24-(K8*((UCBDMCT-UCB)-(((UCBDMCT-UCB)/4)*4))) Y02134 32156002
         L     R0,UCB+(((UCBDMCT-UCB)/K4)*K4) ALLIGN & LOAD WORD Y02134 32158002
EDO03810 EQU   *                        SWAP IN UPDATED COUNT    Y02134 32158802
*                                                                Y02134 32159202
         LR    RET,R0                   SAVE CS OPERAND          Y02134 32159602
         SLL   RET,K25                  LEAVE ONLY UCBDMCT COUNT Y02134 32159702
         LTR   RET,RET                  TEST FOR COUNT OF 0      Y02134 32159802
         BZ    EDO03815                 BRANCH IF ALREADY 0      YM3931 32159902
*                                                                Y02134 32163202
         LR    R1,R0                    LOAD OLD VALUE TO MODIFY Y02134 32165202
         SR    R1,RF                    ADD DECREMENT TO COUNT   Y02134 32165602
*                                                                Y02134 32166002
         MODESET EXTKEY=SUPR            UCB KEY                  Y02082 32166402
         CS    R0,R1,UCB+(((UCBDMCT-UCB)/K4)*K4) STORE NEW COUNT Y02134 32166502
         MODESET EXTKEY=DATAMGT         RETURN TO DATA MGMNT KEY Y02082 32166602
         BNE   EDO03810                 BRANCH IF NOT THE SAME   Y02134 32166702
         OI    DXATEOV,DXATNVOL         INDIC CURR UNIT INACTIVE YM6520 32168702
         TM    UCBJBNR,UCBVRDEV         IS IT VIO UNIT           YM3868 32170102
         BZ    EDO03815                 BRANCH IF NO             YM3868 32170202
         EJECT                                                          32170902
*                                                                       32172902
*        VIO UNIT - WICLOSE IF DATA MANAGEMENT COUNT NOW ZERO           32173302
*                                                                       32173702
         SLL   R1,K25                   GET COUNT IN REG         YM3868 32173902
         LTR   R1,R1                    IS COUNT ZERO            YM3868 32174602
         BNZ   EDO03815                 BRANCH IF NOT            YM3868 32175302
         LA    R1,VDSUCB-VDSCB(,RUCB)   GET VDSCB ADDR           YM3868 32176002
         L     RD,DXXPREFX              GET PREFIX ADDR          YM3868 32176702
         LA    RD,IECREGSV-IECPREFX(,RD) GET REG SAVE AREA       YM3868 32177402
         MODESET EXTKEY=SUPR            GET IN KEY ZERO          YM3868 32178102
         WICLOSE VDSCB=(1)              WICLOSE DATA SET         YM3868 32178802
         MODESET EXTKEY=DATAMGT         RETURN TO D.M. KEY       YM3868 32179502
EDO03815 EQU   *                        RELEASE LOCK             YM3868 32180202
         L     RF,DXXPREFX              GET PREFIX ADDR          YM3868 32180902
         STM   RB,RET,IECREGSV          SAVE MODESET REGS        YM3868 32181602
         MODESET EXTKEY=SUPR            GET IN KEY ZERO          YM3930 32182002
EDO03817 SETLOCK RELEASE,TYPE=LOCAL,    RELEASE LOCAL LOCK       YM3868*32182302
               RELATED=(LOCAL,IFG0554P(EDO03805))                YM3868 32183002
         MODESET EXTKEY=DATAMGT         RETURN TO D.M. KEY       YM3930 32183402
         LM    RB,RET,IECREGSV          RESTORE MODESET REGS     YM3868 32183702
         DROP  RF                                                YM3868 32184402
         EJECT                                                          32185802
EDO03820 EQU   *                        GET MAX(VOLCT, NVOL)     Y02134 32186502
*                                                                Y02134 32187202
         LH    R1,DXVOLSEQ              GET CURRENT SEQUENCE NO. Y02134 32249702
         LA    R1,K1(R1)                INCREMENT TO NEXT VOLUME Y02134 32299702
         STH   R1,DXVOLSEQ              SAVE SEQUENCE NUMBER     Y02134 32349702
*                                                                Y02134 32399702
         MVI   DXRETCOD,K8              SET UP OFFSET FOR 555H   Y02134 32449702
         MVC   DXRETMOD,ID4P5H          SAVE RETURN MODULE NAME  Y02134 32499702
*                                                                Y02134 32549702
         IECRES LOAD,MODID=ID4P4A,BRCODE=K0,BRANCH=QUEUED        Y02134 32599702
         SPACE 2                                                        32609702
*****************************************************************Y02134 32699702
*                                                                Y02134 32749702
*        READ F1 DSCB IF OBTAINED SECONDARY SPACE                YM6520 32799702
*        ON CURRENT VOLUME                                       YM6520 32803702
*                                                                Y02134 32849702
*****************************************************************Y02134 32899702
*                                                                Y02134 32949702
EDO04000 EQU   *                        USE DEB PREFIX BBCCHHR   Y02134 32999702
*                                                                Y02134 33049702
*****************************************************************Y02134 33149702
*                                                                Y02134 33199702
*        SET UP EXTENT TO COVER THE WHOLE DISK.                  Y02134 33249702
*                                                                Y02134 33299702
*****************************************************************Y02134 33349702
*                                                                Y02134 33399702
         XC    DXDEBSCC(K4),DXDEBSCC    EXTENT TO COVER DISK     Y02134 33549702
*                                                                Y02134 33599702
         L     RF,CVTPTR                GET CVT ADDR             Y02134 33649702
         L     RF,CVTZDTAB-CVT(,RF)     I/O DEVICE TABLE ADDRESS Y02134 33699702
*                                                                Y02134 33749702
         XR    R1,R1                    ZERO WORK REGISTER       Y02080 34149702
         IC    R1,UCBTBYT4              GET UCB DEVICE TYPE      Y02134 34199702
         IC    R1,0(R1,RF)              INDEX TO DEVICE OFFSET   Y02134 34249702
         AR    RF,R1                    ADDR OF DEVICE ENTRY     Y02134 34299702
         MVC   DXDEBECC(K4),0(RF)       SET MAX EXTENT FROM TBL  Y02134 34349702
         MVC   DXCCW8(K4),0(RF)         SAVE MAX PACK EXTENTS    Y02082 34399702
*                                                                Y02134 34449702
         MVC   DXDEBNTR,ODA0660K        SET TRACKS TO LARGEST NO Y02134 34499702
         MVC   DXDEBUCB+K1(K3),DXUCBADR+K1 UCB ADDRESS TO DEB    Y02134 34549702
         XC    DXDEBBIN,DXDEBBIN        ZERO OUT BIN NUMBER      Y02134 34599702
         EJECT                                                          34609702
*****************************************************************Y02134 34649702
*                                                                Y02134 34699702
*        CONSTRUCT CHANNEL PROGRAM TO READ DSCB DIRECTLY         Y02134 34749702
*        SEARCH ID EQ                                            Y02134 34799702
*        TIC *-8                                                 Y02134 34849702
*        SEARCH KEY EQ                                           Y02134 34899702
*        NOP  (NO CHAIN BIT, SLI)                                Y02134 34949702
*        READ DATA (DSCB)                                        Y02134 34999702
*                                                                Y02134 35049702
*        CHANNEL PROGRAM TO READ FORMAT 4 IS CORRECT TO READ     Y02082 35099702
*        FORMAT 1 EXCPT THE SEARCH KEY EQUAL MUST SEARCH ON 44   Y02082 35149702
*        BYTES OF THE JFCB DSNAME AND OMIT THE SLI BIT           Y02082 35199702
*                                                                Y02134 35249702
*****************************************************************Y02134 35299702
*                                                                Y02082 35349702
         LR    R8,RDEB                  GET DEBBASIC            ZA01265 35351702
         LA    RF,DEBBASIC-DEB          GET OFFSET TO PREFIX    ZA01265 35352202
         SR    R8,RF                    GET PTR TO PREFX        ZA01265 35352702
         MVC   DXDAADDR+K1(K7),DEBDSCBA-DEB(R8)  BBCCHHR OF     ZA01265 35359702
*                                              DSCB TO SEE WRD   Y02134 35369702
         MVI   DXDAADDR,K0              SET-M- TO ZERO           Y02134 35379702
         XC    DXCCW1(K40),DXCCW1       CLEAR AREA (5 CCWS)      Y02134 35399702
         LA    RF,DXDAADDR+K3           SEARCH ADDRESS           Y02134 35449702
         ST    RF,DXCCW1                                         Y02134 35499702
         LA    RF,DXCCW1                TIC ADDRESS              Y02134 35549702
         ST    RF,DXCCW2                                         Y02134 35599702
         LA    RF,DXDSCB                LOAD POINTER TO BUFFER   Y02134 35699702
         ST    RF,DXCCW5                                         Y02134 35749702
         MVI   DXCCW3+K7,L'JFCBDSNM     COUNT OF 44              Y02082 35999702
         LA    RF,JFCBDSNM              DATA SET NAME KEY ADDR   Y02082 36099702
         ST    RF,DXCCW3                STORE KEY ADDR IN CCW    Y02134 36149702
         OC    DXCCW1(K40),ODA0640K     CMND CODE, FLAGS, LENGTH Y02134 36159702
*                                                                Y02082 36249702
         EXCP  DXIOB                    READ DSCB VIA EXCP       Y02134 36299702
*                                                                Y02134 36349702
         IECRES WAIT                    WAIT FOR READ TO FINISH  Y02134 36399702
*                                                                Y02134 36449702
         TM    DXECB,ECBNOERR           CHECK FOR IO ERROR       Y02134 36499702
         BZ    EDO03640                 BRANCH IF I/O ERROR      Y02134 36549702
*                                                                Y02134 36599702
         LA    RF,DXCCW6                TEST IF CHANNEL PROGRAM  Y02134 36649702
         L     R1,IOBCOMAD              TERMINATED AFTER READ    Y02134 36699702
         LA    R1,0(R1)                 CCW BY EXAMINING CSW     Y02134 36749702
         CR    R1,RF                    STORED IN IOB            Y02134 36799702
         BNE   EDO03640                 BRANCH IF ERROR          Y02134 36849702
*                                                                Y02134 36899702
         LA    RB,DXDSCB                LOAD POINTER TO DSCB     Y02134 36949702
         EJECT                                                          37099702
*****************************************************************Y02134 37149702
*                                                                Y02134 37199702
*        CHECK FOR MORE DSCB'S.                                  Y02134 37249702
*                                                                Y02134 37299702
*****************************************************************Y02134 37349702
*                                                                Y02134 37359702
EDO04100 EQU   *                        READ FORMAT 3 IF THERE   Y02134 37369702
*                                                                Y02134 37399702
         NC    DSCNEXT-DXDSCB(L'DSCNEXT,RB),DSCNEXT-DXDSCB(RB)   Y02134 37449702
         BZ    EDO04200                 BRANCH IF NO MORE        Y02134 37499702
*                                                                Y02134 37549702
         MVC   DXDAADDR+K3(L'DSCNEXT),DSCNEXT-DXDSCB(RB) CCHHR   Y02134 37599702
*                                                                Y02134 37649702
         LA    R0,DSCBLNG+K4            LENGTH OF DSCB + PTR     Y02134 37699702
         IECRES GET,LV=(0),PREFIX=YES,STM=(2,14,DXXPREFX),       Y02144*37749702
               ID=DJWA                                           Y02144 37759702
*                                                                Y02134 37799702
         LA    R1,DXDSCB-DXDSCB(,R1)    CLEAR HIGH ORDER BYTE    Y02134 37849702
         ST    R1,CORECH(,RB)           CHAIN TO PREVIOUS CORE   Y02134 37899702
         LR    RB,R1                    LOAD DSCB BUFFER ADDR    Y02134 37949702
         EJECT                                                          37999702
*****************************************************************Y02134 38049702
*                                                                Y02134 38099702
*        MODIFY CCW TO READ NEXT FORMAT 2 OR 3 DSCB KEY & DATA   Y02134 38149702
*                                                                Y02134 38199702
*        SEARCH ID EQ                                            Y02134 38249702
*        TIC *-8                                                 Y02134 38299702
*        READ KEY & DATA                                         Y02134 38349702
*                                                                Y02134 38399702
*****************************************************************Y02134 38449702
*                                                                Y02134 38499702
         LA    RC,DSCBLNG               LENGTH OF DSCB KEY+DATA  Y02134 38549702
         STM   RB,RC,DXCCW3             DSCB BUFFER & LENGTH     Y02134 38599702
         MVI   DXCCW3,CCWRDKEY          READ KEY & DATA CMND     Y02134 38649702
         LA    RB,L'JFCBDSNM(,RB)       INCREMENT PASSED KEY     Y02134 38699702
*                                                                Y02134 38749702
         EXCP  DXIOB                    READ FORMAT 2 OR 3 DSCB  Y02134 38799702
*                                                                Y02134 38849702
         IECRES WAIT                    WAIT FOR READ COMPLETE   Y02134 38899702
*                                                                Y02134 38949702
         TM    DXECB,ECBNOERR           CHECK FOR I/O ERROR      Y02134 38999702
         BNO   EDO03640                 BRANCH IF ERROR          Y02134 39049702
         B     EDO04100                 BRANCH IF NO ERROR       Y02134 39099702
*                                                                Y02134 39109702
EDO04200 EQU   *                        BUILD NEW DEB IN 555H    Y02134 39119702
*                                                                Y02134 39129702
         L     RDEB,DCBDEBAD            RESTORE DEB POINTER      Y02134 39179702
         LA    R7,ID4P5H                LOAD IFG0555H ADDRESS    Y02134 41199702
         LA    RET,K12                  IFG0555H ENTRY OFFSET    Y02134 41249702
         B     EDO03790                 BRANCH TO IFG0555H       Y02134 41269702
         EJECT                                                          41299702
*                                                                       41349702
*        CONSTANTS                                                      41399702
*                                                                       41449702
SCRTCH   DC    CL6'SCRTCH'              SCRTCH REQUEST NAME      Y02134 42249702
*                                                                Y02134 42299702
*        CCW'S TO READ FORMAT 1 OR 4 DSCB DIRECTLY.              Y02134 42349702
*                                                                Y02134 42399702
ODA0640K DC    X'3100000040000005'      SEARCH ID EQ             Y02134 42449702
         DC    X'0800000000000000'      TIC *-8                  Y02134 42499702
         DC    X'290000004000002C'      SEARCH KEY EQ            Y02134 42549702
         DC    X'0300000020000001'      NOP  (NO CHAIN, SLI)     Y02134 42599702
         DC    X'0600000000000060'      READ DATA (DSCB)         Y02134 42649702
*                                                                Y02134 42699702
ODA0660K DC    X'7FFF'                  MAX NO. TRACKS IN EXTENT Y02134 42749702
         EJECT                                                          42799702
*                                                                       50900021
*          XCTL TABLE FOR IFG0554P                                      51000021
*                                                                       51100021
         XCTLTABL ID=(ID4P4P,4P,ID4P3B,3B,ID4P4Z,4Z,ID4P4A,4A,   Y02134X51450002
               ID4P5H,5H,ID4P0P,0P,ID4P4T,4T,                  @ZA02218X51460037
               NAME554P,IFG0554P,,IGG0553A),                     Y02134X51470002
               SVC=055,BRT=YES,LENGTH=                           Y02134 51472002
*                                                                Y02134 51480002
         IECDSECS CVT,TIOT,DCB,IEZDEB,UCB,MAIN,WTG,PREFX,PSA,   ZA01265*51500002
               EXPAND=YES                                        YM3868 51500102
         IDDVDSCB                                                YM3868 51500202
         IECEQU IEZDEB=YES                                      ZA01265 51550002
         END                                                            51700021
