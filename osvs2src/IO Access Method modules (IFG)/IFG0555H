         TITLE 'IFG0555H                      END OF VOLUME DA OUTPUT -*00200002
                BUILD DEB FUNCTION'                                     00250002
IFG0555H CSECT                                                          00450002
*********************************************************************** 00460002
*                                                                     * 00470002
*                                                                     * 00480002
*          VS2 RELEASE 02 DELETIONS                                   * 00490002
*                                                                     * 00492002
*          VS2 RELEASE 3 DELETIONS                                    * 00492403
*0000007475,019419,196918-196951,197328                        @Y30LSBS 00492803
*                                                                       00493124
*          VS2 RELEASE SU24                                    @G24LSFS 00493524
*DELETE FIX FOR APAR OZ16031                                   @G24LSFS 00493924
*197148-197188,668054-668159                                   @G24LSFS 00494324
*D388020-456000,463000-467600                                  @G24LSFS 00494724
*                                                              @ZM44640 00495124
*                                                                       00495524
*          VS2 RELEASE 3.7 CHANGES/DELETIONS                          * 00496037
*0000196885,666852-667452,668054                               @ZA13555 00498037
*0000                                                          @ZA16031 00499037
*0000193700,193800,A905980                                     @ZA13538 00499224
*0000                                                          @ZA17972 00499624
*********************************************************************** 00500002
*                                                                     * 00550002
* MODULE NAME = IFG0555H (OS/VS2)                                     * 00600002
*                                                                     * 00650002
* DESCRIPTIVE NAME = END OF VOLUME DA OUTPUT - BUILD DEB FUNCTION     * 00660002
*                                                                     * 00670002
* COPYRIGHT = NONE                                                    * 00680002
*                                                                     * 00690002
* STATUS = RELEASE 2, LEVEL 0                                         * 00692002
*                                                                     * 00694002
* FUNCTION =                                                          * 00696002
*        THIS MODULE IS ENTERED FROM -                                * 00706002
*        IFG0554C (ALIAS FOR IFG0194C) IF A NEW VOLUME WERE MOUNTED   * 00716002
*        IFG0554P AFTER EXTENDING ON THE SAME VOLUME                  * 00718002
*        IFG0555J AFTER RETURNING FROM PROCESSING USER HEADER LABELS  * 00720002
*                                                                     * 00720102
*        1) THE DEB IS PAGE FREED IF IT HAD BEEN PAGE FIXED.          * 00722102
*        THIS MODULE SAVES THE DEB IN THE EOV WORKAREA AND            * 00723402
*        UNCHAINS IT FROM THE TCB IT IS CHAINED TO (NOT NECESSARILY   * 00727902
*        THE CURRENT TCB.                                             * 00729902
*                                                                     * 00730002
*        2) IF THE DEB IS CHAINED TO THE CURRENT TCB, THE DEB IS      * 00730802
*        DELETED FROM THE DEB TABLE WITH THE DEBCHK-DELETE MACRO.     * 00731202
*        OTHERWISE, THE DEB ADDRESS IS LOCATED IN THE DEB TABLE AND   * 00731602
*        INVALIDATED (UNTIL THE NEW DEB IS BUILT) BY FLIPPING THE LOW * 00732002
*        ORDER BIT IN THE DEB ADDRESS.                                * 00732402
*                                                                     * 00732502
*        3) THE DEB IS FREED USING THE BRANCH ENTRY TO FREEMAIN,      * 00733302
*        DIRECTED TO THE TCB THE DEB WAS CHAINED TO.                  * 00733702
*                                                                     * 00734102
*        4) STORAGE FOR A NEW DEB IS OBTAINED USING THE BRANCH ENTRY  * 00734502
*        TO GETMAIN DIRECTED TO THE TCB THE DEB WAS CHAINED TO. THE   * 00734902
*        NEW DEB IS CONSTRUCTED FROM THE CONTENTS OF THE OLD DEB      * 00735002
*        SAVED IN THE EOV WORKAREA AND THE DSCB(S) READ BY THE        * 00735802
*        PREVIOUS MODULES.                                            * 00736202
*                                                                     * 00736602
*        5) THE DEB IS CHAINED TO THE TCB WHICH THE OLD DEB WAS       * 00737002
*        CHAINED TO. IF THAT IS THE CURRENT TCB, THE NEW DEB ADDRESS  * 00737402
*        IS ADDED TO THE DEB TABLE USING THE DEBCHK-ADD MACRO.        * 00737502
*        OTHERWISE THE ENTRY IN THE DEB TABLE POINTING TO THE OLD DEB * 00738302
*        IS  REPLACED WITH THE ADDRESS OF THE NEW DEB.                * 00738702
         EJECT                                                          00739102
*        6) AFTER BUILDING THE DEB, IF A NEW VOLUME IS NOW BEING      * 00739502
*        PROCESSED THE USER HEADER LABEL MODULE, IFG0555J, IS GIVEN   * 00739902
*        CONTROL IF USER LABELS PROCESSING IS REQUIRED.               * 00740002
*                                                                     * 00740802
*        7) UPON RETURN FROM USER LABEL PROCESSING, OR IF IT IS NOT   * 00741202
*        REQUIRED, THE DEBDCBAD IN THE NEW DEB IS POINTED TO THE USER * 00741602
*        DCB, AND THE EOV ACCESS METHOD EXECUTOR, IFG0551L, IS GIVEN  * 00742002
*        CONTROL UNLESS THE DCB IS USING THE EXCP ACCESS METHOD. IN   * 00742402
*        THIS CASE THE USER DCB IS REFRESHED FROM THE COPY DCB, THE   * 00742502
*        EOV WORKAREA IS FREED AND THE CALLER OF EOV IS RETURNED TO.  * 00742702
*                                                                     * 00743302
* NOTES                                                               * 00743402
*        1) IF THE DEB IS NOT CHAINED OFF THE CURRENT TCB'S DEB       * 00743802
*        CHAIN, THE DEBCHK-DELETE, DEBCHK-ADD LOGIC IS AVOIDED        * 00743902
*        BECAUSE DEBCHK-ADD REQUIRES THE DEB TO BE CHAINED OFF THE    * 00744002
*        CURRENT TCB'S DEB CHAIN.                                     * 00744102
*                                                                     * 00744902
*        2) A DIRECTED FREEMAIN/GETMAIN IS USED TO FREE THE OLD DEB   * 00745302
*        AND OBTAIN CORE FOR THE NEW DEB SO THE CORE IS ATTACHED TO   * 00745702
*        THE TCB UNDER WHICH THE DEB WAS OPENED AND WILL BE FREED     * 00746102
*        DURING CLOSE. THIS TCB'S ADDRESS IS IN DEBTCBAD.             * 00746502
*                                                                     * 00746702
*        3) IF THE EXTENT IS ON ONE OF THE  MSS SUBSYSTEM'S           * 00746803
*        VIRTUAL DASD PACKS, AN ICBACREL MACRO (SVC 126) IS           * 00747003
*        ISSUED TO GET STAGING SPACE FOR THE EXTENT.  STAGING         * 00747103
*        WILL BE INHIBITED IF THE EXTENT IS ALLOCATED IN CYL-         * 00747203
*        INDERS.  THE PARAMETER LIST AREA FOR THIS MACRO IS           * 00747303
*        GOTTEN AND FREED VIA THE IECRES MACRO.  DXCCW2+4 WILL        * 00747403
*        SAVE THE POINTER TO THIS LIST.                               * 00747503
*                                                                     * 00747603
*    DEPENDENCIES =                                                   * 00747703
*            CLASS ONE CHARACTER CODE.  THE EBCDIC CHARACTER CODE     * 00748302
*            WAS USED FOR ASSEMBLY.  THE MODULE MUST BE REASSEMBLED   * 00749102
*            IF A DIFFERENT CHARACTER SET IS USED FOR EXECUTION.      * 00749902
*                                                                     * 00750002
*    RESTRICTIONS = NONE                                              * 00753302
*                                                                     * 00756602
*    REGISTER CONVENTIONS =                                           * 00759902
*            R2 POINTS TO DCB                                         * 00763202
*            R4 POINTS TO OPEN WORK AREA                              * 00765202
*            R5 POINTS TO THE RESIDENT ROUTINE                        * 00765602
*            R6 POINTS TO THE WTG TABLE                               * 00766002
*            R8 POINTS TO THE CURRENT WTG TABLE ENTRY                 * 00766502
*            R9 POINTS TO THE DD ENTRY IN THE TIOT                    * 00766602
*            R10 POINTS TO THE UCB                                    * 00777702
*            R11 POINTS TO THE DEB.                                   * 00779702
*                                                                     * 00787702
*    PATCH LABEL = SEE NEXT TO LAST LABEL BEFORE ORG STATEMENT AT END * 00788102
*                  OF LISTING.                                        * 00788502
         EJECT                                                          00788602
* MODULE TYPE = CONTROL (OPEN, CLOSE, EOV DATA MANAGEMENT)            * 00788702
*                                                                     * 00788802
*    PROCESSOR = ASSEMBLER XF                                         * 00792502
*                                                                     * 00794502
*    MODULE SIZE = SEE EXTERNAL SYMBOL DICTIONARY OR LOC FIELD ON     * 00794902
*                  ORG STATEMENT AT END OF LISTING                    * 00795302
*                                                                     * 00795702
*    ATTRIBUTES = REENTRANT, REFRESHABLE,READ-ONLY, ENABLED,          * 00796102
*                  PRIVILEGED, SUPERVISOR STATE, DATA MANAGEMENT KEY, * 00796202
*                  LINK PACK AREA RESIDENT/PAGEABLE                   * 00812102
*                                                                     * 00822102
* ENTRY POINT = IFG0555H FROM:                                        * 00824102
*                 IFG0554C MOUNT VERIFY                               * 00824502
*                 IFG0554P DA OUTPUT                                  * 00824902
*                 IFG0555J DA OUTPUT USER HEADER LABELS               * 00825302
*                                                                     * 00826102
*    PURPOSE = SEE FUNCTION                                           * 00828102
*                                                                     * 00833402
*    LINKAGE =                                                        * 00835402
*        THIS MODULE IS GIVEN CONTROL THROUGH THE IECRES-LOAD MACRO   * 00835802
         EJECT                                                          00840602
* INPUT =                                                             * 00841302
*        ENTERED IN PROTECT KEY 5.                                    * 00841402
*        THE DEB'S DEBDCBAD POINTS TO THE COPIED DCB.                 * 00841502
*        REGISTER 2 POINTS TO THE COPIED DCB                          * 00841702
*        REGISTER 4 POINTS TO THE EOV WORKAREA                        * 00841802
*        REGISTER 10 CONTAINS THE CURRENT UCB ADDRESS                 * 00841902
*        REGISTER 14 CONTAINS A BRANCH TABLE OFFSET -                 * 00891902
*              0 - RETURN FROM USER LABEL MODULE IFG0555J             * 00901902
*              4 - ENTRY FROM IFG0554C AFTER MOUNTING A NEW VOLUME    * 00911902
*              16 - ENTRY FROM IFG0554P AFTER EXTENDING ON THE        * 00921902
*              CURRENT VOLUME.                                        * 00931902
*                                                                     * 00941902
* OUTPUT =                                                            * 00991902
*        A NEW DEB IS BUILT, CHAINED TO THE TCB, AND IN THE DEB TABLE * 01001902
*                                                                     * 01003902
*        IFG0555J                                                     * 01011902
*              CONTROL IS PASSED IN PROTECT KEY 5.                    * 01021902
*              THE DEBDCBAD POINTS TO THE COPIED DCB.                 * 01031902
*              REGISTER 2 POINTS TO THE COPIED DCB.                   * 01033902
*              REGISTER 4 POINTS TO THE EOV WORKAREA                  * 01035902
*              DXRETMOD INDICATES IFG0555H IS TO BE RETURNED CONTROL  * 01037902
*              REGISTER 12 CONTAINS THE USER EXIT ENTRY FROM THE DCB  * 01039902
*              EXIT LIST, OR ZEROS IF USER LABELS ARE NOT SPECIFIED   * 01040302
*              IN THE JFCB BUT A USER LABEL TRACK IS ALLOCATED.       * 01041102
*        IFG0551L                                                     * 01041502
*              CONTROL IS PASSED IN PROTECT KEY 5.                    * 01041602
*              REGISTER 2 POINTS TO THE COPIED DCB.                   * 01041802
*              REGISTER 4 POINTS TO THE EOV WORKAREA                  * 01058502
*        EXIT TO CALLER                                               * 01068502
*              USER DCB REFRESHED FROM COPY                           * 01070502
*              DEB POINTS TO USER DCB                                 * 01072502
*              REGISTER 15 = 0                                        * 01074502
         EJECT                                                          01075202
* EXIT-NORMAL =                                                       * 01091902
*        IFG0555J DA OUTPUT USER HEADER LABELS                        * 01141902
*        IFG0551L BSAM/QSAM END OF VOLUME EXECUTOR                    * 01191902
*        CALLER OF EOV                                                * 01241902
*                                                                     * 01291902
* EXIT-ERROR =                                                        * 01341902
*        IFG0550P PROBLEM DETERMINATION WITH INTERNAL ABEND CODE      * 01351902
*        IN REGISTER 0 -                                              * 01361902
*              199 - CAUSING 437-0C ABEND, DEB NOT IN DEB TABLE       * 01371902
*              111 - CAUSING 737-34 ABEND, ACQUIRE FAILED             * 01376903
*                                                                     * 01381903
*        DMABCOND PCK IF PAGE FREE RETURN CODE                   YM5929 01386903
*                                                                     * 01391902
* EXTERNAL REFERENCES = SEE BELOW                                     * 01441902
*                                                                     * 01491902
*    ROUTINES =                                                       * 01541902
*        IFG019RA TO TRANSFER CONTROL THROUGH IECRES MACRO            * 01551902
*                                                                     * 01552002
*        IEAVPSIB VIA CVTVPSIB TO PAGE FREE DEB                  YM5929 01552102
*        R0 = 0 INDICATING NO ECB                                YM5929 01552302
*        R1 = X'20', ADDR OF DEB PREFIX: START OF PAGE FREE      YM5929 01552502
*        R2 = ADDR OF LAST BYTE OF DEB + 1: END OF PAGE FREE     YM5929 01552702
*        R4 = ADDRESS OF TCB FROM DEBTCBAD                       YM5929 01552902
*                                                                     * 01591902
*    DATA AREAS =                                                     * 01641902
*        NONE                                                         * 01651902
*                                                                     * 01691902
*    CONTROL BLOCK =                                                  * 01741902
*        DEB                                                          * 01751902
*        DCB                                                          * 01761902
*        TCB                                                          * 01771902
*        CVT                                                          * 01781902
*                                                                     * 01791902
* TABLES = EOV WORK AREA                                              * 01841902
*                                                                     * 01891902
* MACROS = DEBCHK, MODESET, SETLOCK, IECRES, IECDSECS, ICBACREL@Y30LSBS 01941903
*                                                                     * 01991902
* CHANGE ACTIVITY =                                                   * 02041902
*        SEE CHANGES/DELETIONS SECTION JUST AFTER CSECT CARD          * 02051902
*                                                                     * 02091902
*********************************************************************** 02141902
         EJECT                                                          02191902
*                                                                     * 15000021
ERR199   EQU   199                      INTERNAL ABEND CODE      Y02082 15420002
         BALR  RBASE,0                  ESTABLISH ADDRESSABILITY        15600021
         USING FORCORE,RCORE                                            15800021
         USING WTG,RWTG                 BASE FOR WTG TABLE       Y02080 15850002
         USING UCB,RUCB                                                 16200021
         USING DEBBASIC,RDEB                                     YM1272 16400002
         USING DCBRELAD,RDCB                                            16600021
         USING TIOENTRY,RTIOT           TIOT ENTRY USING         YM3116 16650002
         USING *,RBASE                                                  16800021
*                                                                       17200021
*        DETERMINE ENTRY CONDITION                                      17400002
*                                                                       18000021
         B     EDO22700(RET)            BRANCH TABLE                    18400021
*                                                                       18600021
EDO22700 EQU   *                        BRANCH TABLE                    18800002
         B     EDO24800                 RETURNING FROM UL PROCESSING    19000002
         NOP   EDO22700                 NO ENTRY OFFSET 4        YM1193 19200002
         B     EDO22710                 ENTRY FROM NEW VOL MNT   Y02134 19250002
         B     EDO22720                 ENTRY FROM IFG0554P      Y02134 19300002
*                                                                Y02134 19350002
EDO22710 EQU   *                        ENTRY FROM NEW VOL MNT   Y02134 19360002
*                                                                Y02134 19370002
         L     RDEB,DCBDEBAD            LOAD DEB ADDRESS         Y02134 19372002
         LA    R8,K0(,RDEB)             DEB ADDRESS TO R8      @ZA13538 19374037
         SH    R8,MLCN10                POINT TO DEB PREFIX    @ZA13538 19382037
         MVC   DEB+K3-DEB(K5,R8),DXCCW7 CCHHR OF DSCB TO DEB   @ZA13538 19390037
         LA    RD,K4                    SET NEW VOL INDICATOR    Y02134 19398402
         B     EDO22730                 BRANCH TO PROCESS        Y02134 19408402
*                                                                Y02134 19442502
EDO22720 EQU   *                        ENTRY FROM IFG0554P      Y02134 19452502
*                                                                Y02134 19462502
         LA    RD,K1                    SET OLD VOL INDICATOR    Y02134 19464502
         EJECT                                                          19468502
EDO22730 EQU   *                        PROCESS DEB              Y02134 19468902
         OI    DXATALL,DXATFC           FORCE CLOSE ON ERROR     YM7099 19469102
*                                                                Y02134 19469302
         MVC   DXCCW6(K1),JFCBLTYP      SAVE LBL TYPE FOR UL     Y02134 19469902
         LA    RDEB,DEBBASIC            CLEAR HIGH BYTE          YM5929 19470002
         L     RF,DEBAPPAD              DEB AVT ADDR             YM5929 19470202
         SH    RDEB,MLCN36              POSITION AT APPENDAGES   Y02134 19479902
         TM    DEBSIOAB-DEBAVT(RF),X10  IS DEB FIXED             YM5929 19480002
         BZ    EDO22735                 BRANCH IF NOT            YM5929 19481002
         XR    RF,RF                    ZERO FOR IC              YM5929 19482002
         IC    RF,DEBLNGTH-DEBAVT(RDEB) LENGTH IN DWORDS OF DEB  YM5929 19483002
         SLL   RF,K3                    LENGTH IN BYTES OF DEB   YM5929 19484002
         AR    RF,RDEB                  END OF DEB + 1           YM5929 19485002
         LR    R1,RDEB                  START OF DEB             YM5929 19486002
*        PGFREE R,A=(1),EA=(15)         PAGE FREE DEB            YM5929 19486202
         LA    R2,K0(,RF)               END ADDRESS OF PGFREE    YM5929 19486402
         L     RF,DXXPREFX              PREFIX ADDRESS           YM5929 19486602
         STM   RDEB,RET,IECREGSV-IECPREFX(RF) SAVE SETLOCK REGS  YM5929 19486802
         MODESET EXTKEY=SUPR            SETLOCK, PGFREE KEY      YM5929 19487002
EDO22731 SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                  YM5929*19487202
               RELATED=(LOCAL,IFG0555H(EDO22732)) GET LOCAL LOCK YM5929 19487402
         LM    RDEB,RET,IECREGSV-IECPREFX(RF) RESTORE REGS       YM5929 19487602
         EJECT                                                          19487802
         XR    R0,R0                    NO ECB                   YM5929 19488002
         ICM   R1,B'1000',=AL1(X20)     PGFREE BIT               YM5929 19488202
         LR    RDEB,RCORE               SAVE RCORE               YM5929 19488402
         L     RCORE,DEBTCBAD-DEB(,R1)  PGFREE BY TCB            YM5929 19488602
         L     RF,CVTPTR                CVT                      YM5929 19488802
         L     RF,CVTVPSIB-CVT(,RF)     IEAVPSIB ENTRY           YM5929 19488902
         BALR  RET,RF                   REGS 0-14 UNCHANGED      YM5929 19489102
         LTR   RF,RF                    ERROR IN PGFREE          YM5929 19489202
         BNZ   EDO25300                 BRANCH IF YES            YM5929 19489402
         LR    RCORE,RDEB               RESTORE RCORE            YM5929 19489502
         L     RDCB,DXPDCBAD            RESTORE DCB ADDRESS      YM5929 19489602
         L     RDEB,DCBDEBAD            RESTORE DEB ADDRESS      YM5929 19489702
         L     RF,DEBAPPAD              DEB AVT ADDR             YM5929 19489902
         NI    DEBSIOAB-DEBAVT(RF),K255-X10 ZERO DEB FIXED BIT   YM5929 19490002
         LA    RDEB,DEBBASIC            CLEAR HIGH BYTE          YM5929 19490102
         SH    RDEB,MLCN36              POSITION AT APPENDAGES   YM5929 19490202
         L     RF,DXXPREFX              PREFIX ADDRESS           YM5929 19490302
         STM   RDEB,RET,IECREGSV-IECPREFX(RF) SAVE SETLOCK REGS  YM5929 19490402
EDO22732 SETLOCK RELEASE,TYPE=LOCAL,                             YM5929*19490502
               RELATED=(LOCAL,IFG0555H(EDO22731)) RELEASE LOCK   YM5929 19490602
         LM    RDEB,RET,IECREGSV-IECPREFX(RF) RESTORE REGS       YM5929 19490702
         MODESET EXTKEY=DATAMGT         RETURN TO D M KEY        YM5929 19490802
EDO22735 EQU   *                        MOVE DEB TO WORKAREA     YM5929 19490902
         MVC   JFCBDSNM(K74),DEBBASIC   MOVE DEB-APPENDAGE,OPEN  YM1272 19491102
*                                       PARAM,AND BASIC SECTS TO Y02134 19491902
*                                       WKAREA-ON TOP OF JFCB    Y02134 19493902
         LR    RC,RDEB                  DEB ADDR FOR FREEMAIN    Y02134 19495902
         AH    RDEB,MLCN36              RESET TO BASIC SECT      Y02134 19497902
         SR    R1,R1                    ZERO R1                  Y02134 19498302
         IC    R1,DEBNMEXT              NO. OF EXTENTS IN OLDDEB Y02134 19498702
         SLL   R1,K4                    MPY BY 16                Y02134 19499102
         SH    R1,MLCN6                 SUBTRACT 6 FOR MODIF,UCB Y02134 19499502
*                                           ADDR, AND BB         Y02134 19499602
         AR    R1,RC                    BUMP FWA PTR (APP.ADDR)  Y02134 19499702
         SR    R7,R7                    ZERO R7                  Y02134 19499802
         IC    R7,DEBNMSUB              NUMBER OF SUBROUT.       Y02134 19533202
         SLL   R7,K1                    MPY X 2                  Y02134 19543202
         SR    RF,RF                    CLEAR WORK REGISTER      Y02134 19553202
         IC    RF,DEBAMLNG              LENGTH FOR MEMBER NAME,  Y02134 19563202
         AR    R7,RF                    VOL SEQ AND NUM OF VOLS  Y02134 19565202
         ST    R7,DXCCW3                SAVE FOR LATER           Y02134 19565602
         LTR   R7,R7                    TEST IF NO BYTES TO MOVE A40437 19566002
         BZ    EDO22740                 BRANCH IF NO BYTES       A40437 19566402
         BCTR  R7,0                     SUB ONE FOR EXECUTE      Y02134 19566502
         EX    R7,EDO25650              MOVE SUBRTINES,VOLSQ,NO. Y02134 19577602
*                                           VOLS TO SAVE AREA    Y02134 19587602
         EJECT                                                          19587702
*                                                                       19588002
*        PUT NEW EXTENT NUMBER AT DXCCW7+4 -                     Y02134 19588402
*        ZERO IF EXTENDED ON NEW VOLUME OR                       Y02134 19588802
*              FIRST EXTENT OF DATA SET JUST NOW OBTAINED        Y02134 19589602
*                                                                       19592502
EDO22740 EQU   *                        SET R7 TO SAVE OLD M     A40437 19594502
*                                                                Y02134 19594602
         XR    R7,R7                    CLEAR NO. OF EXTENTS     YM1252 19594902
*                                                                Y02134 19656202
*        UPDATE DEB VOL. SEQUENCE NUMBER                         Y02134 19666202
*                                                                Y02134 19676202
         TM    DCBMACRF,DCBMEXCP        IS ACCESS METHOD EXCP    YM1184 19678202
         BO    EDO22744                 BRANCH EXCP, ASSUME PS   YM1184 19680202
*                                                                YM1184 19682202
         NC    DCBDSORG,DCBDSORG        CHECK IF DSORG SPECIFIED YM1184 19684202
         BZ    EDO22744                 BRANCH 0, ASSUME PS      YM1184 19684602
*                                                                YM1184 19685002
         TM    DCBDSORG,DCBDSGPS        PHYSICAL SEQUENTIAL DCB  YM1184 19685402
         BNO   EDO22745                 BRANCH IF NOT PS         YM1184 19685902
*                                                                YM1184 19686002
EDO22744 EQU   *                        IF PS, SET VOLSEQ        YM1184 19686102
*                                                                YM1184 19687202
         MVC   JFCBDSNM+K75(1),DXVOLSEQ+1 MOVE IN SEQ NO.      @ZA13555 19688537
*                                                                YM1184 19689602
EDO22745 EQU   *                        CONTINUE                 YM1184 19690702
         CH    RD,MLCN1                 EXTEND ON OLD VOLUME     YM1252 19694003
         BNE   EDO22750                 BRANCH IF NEW VOLUME     Y02134 19694103
         IC    R7,DEBNMEXT              PICK UP NO. DEB EXTENTS  Y02134 19696202
         CLI   DEBNMEXT,K1              ONE EXTENT.Q             A40053 19697302
         BNE   EDO22750                 NO, CONTINUE             A40053 19698402
         LA    R1,DEBBASND              PT TO DA SECTION         YM1272 19699502
         USING DEBDASD,R1               BASE FOR DA SECTION      YM1272 19700602
         CLI   DEBSTRCC,ALLBITS         DUMMY EXTENT.Q           A40053 19701702
         BNE   EDO22750                 NO, CONTINUE             A40053 19702802
         SR    R7,R7                    YES, FIRST EXTENT DUMMY  A40053 19703902
EDO22750 EQU   *                        NEW VOLUME               Y02134 19705002
         DROP  R1                                                YM1272 19706102
         ST    R7,DXCCW7+K4             STORE NEW -M- FOR LATER  Y02134 19712802
         USING DEBDASD-(DEBBASND-DEBBASIC),RDEB                @G24LSFS 19714824
         MVC   OLDSTRCC(1),DEBSTRCC     OLD DEB CYL NUMBER     @G24LSFS 19715324
         DROP  RDEB                                            @G24LSFS 19716124
         USING DEBBASIC,RDEB                                   @G24LSFS 19716924
*                                                              @G24LSFS 19718824
*                                                              @Y30LSBS 19722803
*        ZERO DXCCW2+4 - ASSUME NO VIRTUAL  MSS DASD           @Y30LSBS 19724803
*        IF VIRTUAL DASD, GET 96 BYTES FOR PARAMETER LIST      @Y30LSBS 19726803
*        PARTIALLY FORMAT THE HEADER AND SAVE ADDR IN DXCCW2+4 @Y30LSBS 19728803
*                                                              @Y30LSBS 19730803
         XC    DXCCW2+K4(K4),DXCCW2+K4  ZERO POINTER TO LIST   @Y30LSBS 19731203
         TM    UCBTBYT2,UCBRVDEV        IS OLD VOL VIRT DASD   @Y30LSBS 19731603
         BNO   EDO22753                 NO, NOTHING TO DO THEN @Y30LSBS 19732003
         TM    DCBDSORG,DCBDSGIS        IS IT AN ISAM D.S.     @Y30LSBS 19732403
         BO    EDO22753                 ISAM CYLINDER FAULTS   @Y30LSBS 19732503
         IECRES GET,PREFIX=YES,ID=MSSH,LV=ACQPLN,              @Y30LSBS.19732603
               STM=(2,14,WTGPREFX)                             @Y30LSBS 19732703
         USING ACQLST,R1                ACQUIRE ADDRESSABILITY @Y30LSBS 19734703
         ST    R1,DXCCW2+K4             SAVE POINTER TO CORE   @Y30LSBS 19742703
         LA    RF,AREXT                 POINT TO START OF ENTS @Y30LSBS 19748703
         ST    RF,ARECB                 SAVE IT IN ECB AREA    @Y30LSBS 19750703
         DROP  R1                                              @Y30LSBS 19750803
EDO22753 EQU   *                                               @Y30LSBS 19751103
*                                                              @Y30LSBS 19751503
         EJECT                                                          19752703
*                                                                       19790202
*              DELETE OLD DEB FROM THE DEB TABLE                        19795102
*                                                                       19800021
         L     R1,DEBTCBAD              TCB ADDRESS              YM2133 19860000
         LA    R1,K0(R1)                ZERO HIGH ORDER BYTE     YM2133 19870000
         L     RF,DXTCBADR              CURRENT TCB ADDR         Y02082 19880002
         LA    RF,K0(RF)                ZERO HIGH ORDER BYTE     YM2133 19884000
         CLR   R1,RF                    IS DEB ON CURRENT TCB    YM2133 19886000
         BNE   EDO22755                 NO - BYPASS DEBCHK DLTE  Y02134 19890002
         L     R1,DXPDCBAD              GET PTR TO COPIED DCB    Y02082 19892002
         DEBCHK (1),TYPE=DELETE         DELETE DEB               Y02082 19900002
         B     EDO22780                 BYPASS DEBTABLE SEARCH   YM2133 19910000
         EJECT                                                          19910802
*                                                                YM2133 19912000
*        SEARCH DEBTABLE FOR OLD DEB ADDRESS                     YM2133 19914000
*                                                                YM2133 19916000
EDO22755 EQU   *                        GET TABLE OFFSET         Y02134 19920002
         USING TCB,R1                   R1 CONTAINS TCB ADDR     YM2133 19930000
         L     RC,TCBJSCB               ADDR OF JOB STEP JSCB    YM2133 19940000
         DROP  R1                                                YM2133 19942000
         L     R1,DCBDEBAD              GET ADDRESS OF DEB       Y02082 19943202
         LA    R1,K0(,R1)               CLEAR HIGH ORDER BYTE    Y02082 19943602
         BCTR  R1,R0                    POINT TO                 YM2133 19944400
         BCTR  R1,R0                    DEBTBLOF FLD IN DEB PFX  YM2133 19944800
         LH    R1,K0(R1)                GET DEB TABLE OFFSET     Y02080 19945002
         SLL   R1,K2                    MPY BY ENTRY LENGTH      YM2133 19946000
         ST    R1,DXCCW4+K4             SAVE DEB TABLE OFFSET    YM1387 19946402
         L     RF,DXXPREFX              GET PREFIX               Y02080 19946502
         STM   R0,RF,IECREGSV-IECPREFX(RF)  SAVE REGS            Y02080 19946602
         MODESET  EXTKEY=ZERO           KEY 0                    Y02080 19946702
EDO22758 SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                  Y02080X19946802
               RELATED=(LOCAL,IFG055H(EDO22765,EDO23000))        Y02080 19947202
         MODESET  EXTKEY=DATAMGT        DATA MANAGEMENT KEY      Y02080 19947402
         LM    R0,RF,IECREGSV-IECPREFX(RF)   RESTORE REGS        Y02080 19947802
EDO22760 EQU   *                        DEBTABLE CHECK           YM2133 19948002
         USING IEZJSCB,RC               ADDRESSABILITY FOR JSCB  YM2133 19948400
         L     R7,JSCBDBTB              DEB TABLE ADDRESS        YM2133 19948800
         LA    RF,K0(R1,R7)             POINT TO ENTRY           YM2133 19949200
         CLM   RDEB,B'0111',K1(RF)      CORRECT ENTRY            Y02082 19949602
         BE    EDO22770                 YES - CONTINUE           YM2133 19949700
         EJECT                                                          19949902
*        DEB NOT IN DEB TABLE - RELEASE LOCAL LOCK AND                  19950102
*        CALL PROBLEM DETERMINATION                                     19950302
*                                                                       19950502
         L     RF,DXXPREFX              GET PREFIX               Y02080 19950702
         STM   R0,RF,IECREGSV-IECPREFX(RF)  SAVE REGS            Y02080 19951702
         MODESET  EXTKEY=ZERO           KEY 0                    Y02080 19952702
EDO22765 SETLOCK RELEASE,TYPE=LOCAL,                             Y02080X19959702
               RELATED=(LOCAL,IFG0555H(EDO22758))                Y02080 19969702
         MODESET  EXTKEY=DATAMGT        DATA MANAGEMENT KEY      Y02080 19970702
         LM    R0,RF,IECREGSV-IECPREFX(RF)  RESTORE REGS         YM3116 19970902
*                                                                       19971702
*        REREAD JFCB TO REFRESH WORKAREA OVERLAID BY DEB         YM3116 19972702
*                                                                       19973702
         L     RTIOT,DXTIOTAD           GET TIOT ENTRY ADDRESS   YM3116 19974702
         LA    RF,TIOEJFCB              GET JFCB ADDRESS ADDRESS YM3116 19975702
         IECRES LOCJFCB,(RF)            LOCATE JFCB              YM3116 19976702
         MVC   DXJBF(JFCBLGTH),INFMJFCB-INFMJFCB(RF) MOVE JFCB   YM3116 19977702
*                                                                       19978702
         LA    RWTGC,DXXENTRY           SET RWTGC FOR RES RTN    YM2133 19983000
         LA    RWTG,DXXAREA             POINT TO EOV WTG         YM2133 19983100
         DMABCOND ERR199,MODPD5H        LOAD ERROR CODE          YM2133 19983202
         EJECT                                                          19983402
*                                                                Y02080 19987602
*        SETUP TO UNCHAIN DEB FROM TCB AND FREE DEB STORAGE             19987802
*                                                                       19988002
EDO22770 EQU   *                        CONTINUE                 YM2133 19988802
         MODESET EXTKEY=ZERO            DEB TABLE                Y02082 19991202
         OI    K3(RF),K1                INVALIDATE OLD ENTRY     YM2133 19992800
         LA    RC,DEBBASIC              DEB ADDRESS              YM1272 20011402
         LA    RET,K36                  DEB PREFIX LENGTH        YM2133 20014902
         SLR   RC,RET                   POINT TO DEB PREFIX      YM2133 20018402
         B     EDO22790                 BRANCH IN KEY 0 TO       Y02082 20020402
*                                       UNCHAIN DEB - LOCK HELD  Y02082 20020802
         SPACE 2                                                        20021602
EDO22780 EQU   *                        GET LOCK TO UNCHAIN DEB  YM2133 20021902
         L     RF,WTGPREFX              PT TO PREFIX             Y02082 20025402
         USING IECPREFX,RF                                       Y02082 20028902
         STM   R0,RET,IECREGSV          SAVE REGS THRU LOCK      Y02082 20032402
*        OBTAIN LOCAL LOCK                                       Y02082 20035902
         MODESET EXTKEY=ZERO            KEY FOR SETLOCK, DEB CHN Y02082 20039402
EDO22785 SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                  Y02082*20042902
               RELATED=(LOCAL,IFG0555H(EDO23000))                Y02082 20046402
         LM    R0,RET,IECREGSV          RESTORE REGS             Y02082 20049902
         EJECT                                                          20050902
EDO22790 EQU   *                        REMOVE DEB FROM CHAIN    Y02082 20059902
         MODESET EXTKEY=DATAMGT         RETURN TO DM KEY         Y02082 20061902
         LR    R7,RDEB                  PRIME REG 7              Y02082 20069902
         L     R1,DEBTCBAD              PICK UP TCB ADDR.               20099902
         LA    R8,K0(R1)                SAVE TCB ADDR& CLEAR HIBYTE     20200021
         LA    R1,K4(,R1)                                               20400021
EDO22800 EQU   *                        CHECK NEXT DEB                  20600002
         CLC   DCBDEBAD+K1(K3),DEBDEBAD+K1-DEBBASIC(R1) R1=ADDR  YM1482 20800002
*                                       OF PREV DEB/TCB          YM1482 21000002
         BE    EDO22900                 CONTINUE                        21200021
         L     R1,DEBDEBAD-DEBBASIC(,R1) R1=ADDR OF NEXT DEB     YM1482 21400002
         B     EDO22800                 GO CK AGAIN                     21600021
EDO22900 EQU   *                        CONTINUE                        21800002
         L     RET,DEBDEBAD             PT TO NEXT DEB           Y02082 21810002
         ICM   RET,K8,DEBDEBAD-DEBBASIC(R1) PRIME HI BYTE        YM1482 21820002
         ICM   R7,K8,DEBDEBAD-DEBBASIC(R1)                       YM1482 21830002
         MODESET EXTKEY=ZERO            KEY FOR SETLOCK, DEB CHN Y02082 21832002
         CS    R7,RET,DEBDEBAD-DEBBASIC(R1) DECHAIN DEB          YM1482 21840002
         MODESET EXTKEY=DATAMGT         RETURN TO DM KEY         Y02082 21842002
         BNZ   EDO22790                 BR IF NOT SUCCESSFUL     Y02082 21850002
         OI    DXATEOV,DXATDCHN         SHOW DEB DECHAINED       Y02144 21852002
         EJECT                                                          21872002
*                                                                       21892002
*        BRANCH ENTER FREEMAIN TO FREE OLD DEB STORAGE                  21912002
*                                                                       21932002
         SR    RET,RET                  CLEAR LENGTH             Y02080 22200002
         IC    RET,DEB+K32-DEB(,RC)     DEB LENGTH IN DUBL WDS.  Y02080 22400002
         SLL   RET,K3                   MPY X 8                  Y02080 22600002
         L     RF,DXXPREFX              EOV WORKAREA PREFIX      Y02082 22604002
         STM   R0,RET,IECREGSV          SAVE REGS FOR FREEMAIN   Y02082 22620002
         LR    RA,RF                    SAVE PREFIX ADDR         Y02082 22640002
         L     R7,DXASCBAD              ASCB ADDR FOR FREEMAIN   Y02082 22660002
         L     RCORE,DEBTCBAD           TCB ADDR FROM DEB        Y02082 22680002
         LA    RCORE,K0(,RCORE)         CLEAR HIGH BYTE          Y02082 22700002
         LA    R1,K0(,RC)               CLEAR HIHG BYTE OF DEBAD Y02082 22704002
         MODESET EXTKEY=SUPR            FREEMAIN KEY             Y02082 22720002
         FREEMAIN RU,LV=(RET),A=(1),SP=230,KEY=5,BRANCH=YES      Y02082*22740002
                                        FREE DEB DIRECTED TO TCB Y02082 22760002
         MODESET EXTKEY=DATAMGT         RETURN TO D.M. KEY       Y02082 22780002
         LM    R0,RET,IECREGSV-IECPREFX(RA) RESTORE REGS         Y02082 22800002
         OI    DXATEOV,DXATDFRE         SHOW DEB FREED           Y02144 22950002
         EJECT                                                          22970002
*                                                                       23000021
*        CALCULATE SIZE OF NEW DEB                                      23200002
*                                                                       23400021
         SR    RET,RET                  ZERO REG.14                     23600021
         IC    RET,DSCNOEXT             NO.EXT IN NEW DSCB              23800021
         STC   RET,JFCBDSNM+K52         SAVE IN DEBNMEXT                24000021
         SLL   RET,K4                   MPY X 16                        24200021
         LR    RC,RET                   SAVE IN RC                      24400021
         L     R7,DXCCW3                PICK UP NO. SUBRT.BYTES         24600021
         AR    RET,R7                   ADD NO.SUBR BYTES(+4)           24800021
         LA    R0,K68(,RET)             ADD 68 FOR BASIC,APP,OPN Y02080 25000002
         ST    R0,DXCCW3+K4                                      Y02080 25200002
*                                                                       25400021
*****    GET CORE FOR NEW DEB  *****        PARAMETERS                  25600021
*                                                                       25800021
         SPACE 1                                                        26600021
         L     RF,DXXPREFX              PREFIX ADDR              Y02082 26604002
         STM   R0,RET,IECREGSV          SAVE REGS FOR GETMAIN,   Y02082 26608002
*                                       AND SETLOCK              Y02082 26612002
         LR    RA,RF                    SAVE PREFIX ADDR IN RA   Y02082 26620002
         DROP  RF                                                Y02082 26624002
         L     R7,DXASCBAD              ASCB ADDR FOR GETMAIN    Y02082 26640002
         L     RCORE,JFCBDSNM+K36+(DEBTCBAD-DEBBASIC) TCB ADDR   YM3873 26660002
*                                       IN OLD DEB SAVED IN W/A  YM3873 26680002
         LA    RCORE,K0(,RCORE)         CLEAR HIGH BYTE          Y02082 26700002
         MODESET EXTKEY=SUPR            GETMAIN KEY              Y02082 26720002
         GETMAIN RU,LV=(0),SP=230,KEY=5,BRANCH=YES GETMAIN DEB   Y02082 26740002
         EJECT                                                          26740202
         MODESET EXTKEY=SUPR            SETLOCK KEY              Y02082 26760002
EDO23000 SETLOCK RELEASE,TYPE=LOCAL,    RELEASE LOCAL LOCK       Y02082*26780002
               RELATED=(LOCAL,IFG0555H(EDO22785,EDO22758))       Y02082 26800002
         LM    R2,RET,IECREGSV-IECPREFX+R2*K4(RA) RESTORE REGS   Y02082 26820002
         OI    DXATEOV,DXATDNEW         SHOW NEW DEB CORE GOTTEN Y02144 29450002
         LR    RDEB,R1                  SET UP NEW DEB POINTER          29800021
*                                                                       30000021
*        MOVE DEB DATA FROM WKAREA TO NEW DEB CORE                      30200021
*                                                                       30400021
         MVC   DEBBASIC(K74),JFCBDSNM   MOVE BASIC,APP,OPEN PARM YM1272 30600002
*        DEBMODIF, UCB ADDRESS, DEB EXTENSION PTR, AND BB        Y02134 30800002
         AR    RC,RDEB                  ADD NO. EXTENT BYTES TO DEB     31000021
*                                           APPENDAGE ADDRESS           31200021
         SH    RC,MLCN6                 SUBTRACT 6-MOD.,UCBAD,BB        31400021
*                                           ARE ALREADY MOVED           31600021
         LTR   R7,R7                    TEST IF NO BYTES TO MOVE A40437 31660021
         BZ    EDO23050                 BRANCH IF NO BYTES       A40437 31720021
         BCTR  R7,0                     SUBTRACT ONE FOR EXECUTE        31800021
         EX    R7,EDO25600              R7=NO.SUBR BYTES+4              32000021
*                                                                       32200021
***      MOVE SUBROUTINES TO NEW DEB  ***                               32400021
*                                                                       32600021
EDO23050 EQU   *                        NO BYTES TO MOVE         A40437 32700002
         XC    JFCBDSNM+K72(K2),JFCBDSNM+K72  YES, ZERO BB              33200021
         ST    RUCB,DXCCW10             UCB ADDR TO HOLD                33400021
         MVC   JFCBDSNM+K69(K3),DXCCW10+K1  MOVE TO NEW DEB AREA        33600021
EDO23100 EQU   *                        APPENDAGE                       33800002
         ST    RDEB,DXCCW10+K4          DEB-USE FOR APPENDAGE ADDR      34000021
         MVC   DEBAPPAD+K37(K3),DXCCW10+K5  TO APPENDADR-+36 BECAUSE    34200021
*                                       OF RDEB SETTING                 34400021
*                                                                       34600021
*        COMPUTE DEB LENGTH IN DOUBLE WORDS AND INSERT                  34800021
*        IN DEB LENGTH FIELD                                            35000021
*                                                                       35200021
         L     RF,DXCCW3+K4             NO. OF GOT CORE BYTES           35400021
         LA    RF,K7(,RF)               SET RF =DEB CORE LENGTH+7       35600021
         SRL   RF,K3                    DIVIDE BY EIGHT                 35800021
         STC   RF,DEBBASIC+K32          STORE DEB LTH IN DW      YM1272 36000002
         EJECT                                                          36000202
*                                                                       36200021
*        SET DEB REGISTER TO POINT TO BASIC SECTION OF DEB              36400021
*                                                                       36600021
         LA    RDEB,K36(,RDEB)          ESTABLISH DEB POINTER           36800021
         ST    RDEB,DXCCW11+K4          SAVE DEB ADDRESS                37000021
         L     R7,DXDEBXAD              GET DEB EXTENSION ADDR   Y02134 37010002
         USING DEBXTN,R7                                         Y02134 37020002
         ST    RDEB,DEBXDBPR            PUT DEB ADDR IN DEBX     Y02134 37030002
         DROP  R7                                                Y02134 37040002
         MVC   DCBDEBAD+K1(K3),DXCCW11+K5  STORE IN DCB                 37200021
*                                                                       37400002
******   INSERT DSCB EXTENTS INTO NEW DEB  ******                       37600021
*                                                                       37800021
         LR    R7,RCORE                 R7 SET AS CORE REGISTER         38000021
         ST    R7,DXWORK1               SAVE PTR TO F1           Y02134 38050002
         LA    R7,K50+K7(,R7)           ADD HEX 39 TO POS AT EXTNT      38200002
         LA    R8,DEBBASND              PT TO DA SECTION         YM1272 38400002
         USING DEBDASD,R8               BASE TO DA SECTION       YM1272 38450002
         SR    RWTG,RWTG                                                38600021
         STC   RWTG,DXCCW5              SET-M-TO ZERO                   38800021
*                                                                       38830021
         MVC   DXCCW6+K1(K6),DSCEXTYP   SAVE ANY UL EXTENT INFO  M1784  38860021
         CLI   DSCEXTYP,ULEXTYP         IS FIRST EXTENT A UL EXT M1784  38890021
         BE    EDO23700                 BR IF YES TO SKIP UL EXT M1784  38920021
*                                                                       38950021
EDO23200 EQU   *                        BUILD AN EXTENT                 39000002
         MVC   DEBDVMOD(K6),JFCBDSNM+K68 MOVE IN M,UCBAD AND BB  YM1272 39800002
         MVI   DEBDVMOD,X10             PERMIT SEEK HH COMMANDS  YM1272 40000002
         CLI   DSCBEXTY-DXDSCB(R7),X80+X01 CYLINDER ALLOCATION   Y02134 40200002
         BE    EDO23300                 YES,FILE MASK ALREADY SET UP    40400021
         OI    DEBDVMOD,DEBOFDCB        SET TO INHIBIT ALL       YM1272*40600002
                                        SEEK COMMANDS                   40800002
*                                                                       41200021
*                   FILE MASK SETTING NOW COMPLETE                      41400021
*                                                                       41600021
         EJECT                                                          41620002
EDO23300 EQU   *                        CHECK IF DCBFDAD UPDATE NOW     41800002
         MVC   DEBSTRCC(K8),DSCBLLMT-DXDSCB(R7) LOWER EXT        YM1272 42000002
*                                                                       42200021
*              MOVE -M- AND STARTING BBCCHH TO DEB     ******           42400021
*                                                                       42600021
         L     RC,DXCCW7+K4             PICK UP OLD DEB NOEXT OR 0      42800021
         CR    RC,RWTG                  IS THIS THE CCHH FOR DCB        43600021
         BNE   EDO23600                 NO,TRANSFER                     43800021
         TM    DCBMACRF,DCBMEXCP        YES,CHECK FOR EXCP DCB          44200021
         BZ    EDO23500                 BR IF NO TO FULL DISK ADDR      44400002
         TM    DCBMACRF+K1,DEPEND       DOES DEV.DEP.SECT EXIST         44600021
         BZ    EDO23600                 NO,DONT UPDATE ADDR             44800021
EDO23500 EQU   *                        NO EXCP DCB                     45000002
         STC   RC,DCBFDAD               STORE M- ZERO FOR NEW VOL.      45200021
*                                       NO.OLD DEB EXTNTS FOR SAME      45400002
         MVC   DCBFDAD+K1(K6),DEBBINUM  STARTING BBCCHH TO DCB   YM1272 45600024
         MVI   DCBFDAD+K7,K0            SET R = 0                       45800024
*                                                                       46000024
*        COMPUTE NUMBER OF TRACKS                                       46200021
*                                                                       46250024
EDO23600 EQU   *                        DON'T UPDATE ADDR               46450024
         ST    RDCB,DXCCW7              SAVE DCB PIINTER                46800021
         STM   RTIOT,RD,DXCCW8          SAVE REGS.                      47000021
         L     RF,CVTPTR                ADDR OF COMM VECTOR TABLE       47200021
         L     RF,CVTPRLTV-CVT(,RF)     CONVERT ROUTINE ADDR MBB-TTR    47400021
         LA    R1,DXDEB                 LOAD ADDR. OF DUMMY DEB         47600021
         LA    RDCB,DXCCW5              LOAD ADDR OF MBBCCHHR           47800021
         MVI   DXCCW5,K0                STORE-M- IN DUMMY AREA          48000021
         LA    RWTG,K1(,RWTG)                                           48200021
         MVC   DXCCW5+K1(K2),JFCBDSNM+K72  STORE BB IN INPUT PARAM.     48400021
         MVC   DXCCW5+K3(K4),DSCBLLMT-FORCORE(R7)  MOVE LOWER CCHH      48600021
         MVI   DXCCW5+K7,K0             ZERO R                          48800021
*                                                                       49000021
****     CONVERT LOWER MBBCCHHR TO TTR  ***                             49200021
*                                                                       49400021
         BALR  RET,RF                   GO TO CONVERT RTN               49600021
         ST    R0,DXCCW4                SAVE CONVERSION RESULT(TTR)     49800021
         EJECT                                                          49820002
*                                                                       50000021
****     NOW CONVERT UPPER EXTENT BOUNDARY ***                          50200021
*                                                                       50400021
         L     RF,CVTPTR                ADDR OF COMM VECTOR TABLE       50600021
         MVC   DXCCW5+K3(K4),DSCBULMT-DXDSCB(R7) UPPER EXTENT    Y02134 50800002
         L     RF,CVTPRLTV-CVT(,RF)     CONVERT RTN ADDR  MBB-TTR       51000021
         BALR  RET,RF                   BRANCH TO CONVERSION ROUT.      51200021
         L     RDCB,DXCCW7              RESTORE DCB PTR.                51400021
         LM    RTIOT,RD,DXCCW8                                          51600021
         S     R0,DXCCW4                SUBTRACT LO FROM HI TTR         51800021
         SRL   R0,K16                   RIGHT JUSTIFY                   52000021
         LR    R1,R0                                                    52200021
         LA    R1,K1(,R1)               ADD ONE                         52400021
         STH   R1,DEBNMTRK              NO. TRKS TO DEB EXTENT   YM1272 52600002
         SR    R1,R1                    ZERO RF                         52800021
         IC    R1,DEBNMEXT              NUMBER EXTENTS IN NEW DEB       53000021
         CR    R1,RWTG                  CHECK FOR LAST EXTENT           53200021
         BE    EDO24100                 YES,GO                          53400021
         LA    R8,K16(,R8)              BUMP PTR TO DEB EXTENTS         53600021
         DROP  R8                                                YM1272 53650002
*                                                                       53800021
EDO23700 EQU   *                        SKIP USL EXT                    54000002
         LA    R7,K10(,R7)              ADD 10 TO DSCB EXTNT REG        54200021
         LA    R1,K3                    SET REG =3,NO EXTNTS IN FM1     54400021
         CLI   DXCCW6+K1,ULEXTYP        IS THERE A UL EXTENT IN  M1784  54600021
         BNE   EDO23800                 FMT 1 DSCB, BR IF NO     M1784  54800021
         BCTR  R1,K0                    UL EXTNT, ONLY 2 EXTNTS IN F1   55000021
EDO23800 EQU   *                        NO FMT 1 DSCB                   55200002
         CR    R1,RWTG                  CK IF LAST EXTNT FROM F1 IN DEB 55400021
         BNE   EDO23200                 MERGE NEXT EXTENT               55600021
         L     R1,DXWORK1               LOAD DSCB PTR            Y02134 55650002
         CLI   DSCBNEXT+K4-DXDSCB(R1),K0 CHECK CCHHR OF NXT DSCB Y02134 55800002
         BE    EDO24100                 TRANSFER IF ZEROS--FINSHED      56000021
*                                                                       58400021
         MVC   DXCCW11+K2(K4),DSCLOWLM-DXDSCB(R1) CCHH FOR 555J  Y02134 59600002
*                                                                       59800021
         L     R7,CORECH(,R1)           GET FORMAT 3 PTR         Y02134 59850002
         LA    R1,L'JFCBDSNM(,R7)       BUMP PASSED KEY          Y02134 59900002
         ST    R1,DXWORK1               SAVE PTR FOR NEXT EXTENT Y02134 59950002
*                                                                Y02134 60000002
         MVC   DSCBFMID+K44-DXDSCB(K91,R7),DSCBFMID+K45-DXDSCB(R7)      62200002
*                                           LAY FORMAT ID AND FOLLOW    62400021
*                                           KEY PORTION DIRECTLY        62600021
         B     EDO23200                 GO INSERT FORMAT 3 DSCB INTO    63000021
*                                            NEW DEB                    63200021
         EJECT                                                          63220002
*                                                                       65200021
*              INCLUDE NEW DEB IN THE CHAINING                          65400021
*                                                                       65600021
EDO24100 EQU   *                        USE TCB IN DEB                  65800002
         L     R1,DEBTCBAD              TCB ADDR                        66000021
EDO24105 EQU   *                        CHAIN NEW DEB            Y02082 66010002
         L     R7,TCBDEB-TCB(,R1)       PT TO FIRST DEB          Y02080 66060002
         MVC   DEBDEBAD+K1(K3),K9(R1)   PT TO DEB                       66200002
         LA    RDEB,K0(,RDEB)           CLEAR HI-ORDER BYTE      Y02082 66250002
         MODESET EXTKEY=SUPR            TCB KEY                  Y02082 66454902
         CS    R7,RDEB,K8(R1)           CHAIN NEW DEB            Y02082 66456002
         MODESET EXTKEY=DATAMGT         KEY OF EOV               Y02082 66456402
         BNZ   EDO24105                 BR IF NOT SUCCESS        Y02082 66457502
         NI    DXATEOV,ALLBITS-DXATDCHN SHOW DEB CHAINED         Y02144 66467502
         EJECT                                                          66468302
*                                                                YM2133 66470000
*        CHECK FOR DEB CHAINED TO CURRENT TCB                    YM2133 66480000
*                                                                YM2133 66490000
         L     RF,DXTCBADR              CURRENT TCB ADDR         Y02082 66494002
         LA    RF,K0(RF)                ZERO HIGH ORDER BYTE     YM2133 66504502
         LA    R1,K0(R1)                ZERO HIGH ORDER BYTE     YM2133 66508002
*                                                                YM2133 66511502
*        THE EOV WAS ISSUED FROM A TASK DIFFERENT THAN THE ONE   YM2133 66515002
*        IN WHICH THE DEB WAS CREATED IF THE TCB ADDRESS IN THE  YM2133 66518502
*        DEB IS NOT THE SAME AS THE CURRENT TCB ADDRESS.         YM2133 66522002
*                                                                YM2133 66525502
         CLR   R1,RF                    IS DEB ON THIS TCB       YM2133 66529002
         BNE   EDO24110                 NO - DON'T ISSUE DEBCHK  YM2133 66532502
*                                                                YM2133 66536002
*        EOV IN SAME TASK AS OPEN   -   ISSUE DEBCHK ADD         YM2133 66539502
*                                                                YM2133 66543002
         LA    R7,K3                    DEBAMTYP NEGATIVE OFFSET Y01021 66546502
         SR    RDEB,R7                  ADDRESS DEBAMTYP         Y01021 66550000
         IC    R7,K0(RDEB)              GET ACCESS METHOD TYPE   Y01021 66560000
         XC    K0(K3,RDEB),K0(RDEB)     ZERO DEBAMTYP, DEBTBLOF  Y01021 66570002
         L     R1,DXPDCBAD              DEBCHK PROTECTED DCB     Y02082 66572002
         DEBCHK (R1),TYPE=ADD,AM=((R7)) ADD DEB                  Y02082 66580002
         LR    RDEB,R1                  RELOAD DEB ADDRESS       Y01021 66590000
         B     EDO24120                 GO TO UHL PROCESSING     YM2133 66590400
         EJECT                                                   YM2133 66590800
*                                                                YM2133 66591200
*        THE FOLLOWING CODE IS EXECUTED IN LIEU OF DEBCHK        YM2133 66591600
*        WHENEVER THE DEB IS CHAINED TO A TCB DIFFERENT THAN     YM2133 66591700
*        THE CURRENT ONE.  THIS IS ACCOMPLISHED BY REPLACING     YM2133 66602100
*        THE EXISTING DEBTABLE ENTRY WITH THE NEW DEB ADDRESS.   YM2133 66612700
*                                                                YM2133 66633500
EDO24110 EQU   *                        OBTAIN LOCK FOR DEBTABLE YM2133 66643502
         L     RF,DXXPREFX                                       Y02080 66643702
         STM   R0,RF,IECREGSV-IECPREFX(RF)  SAVE REGS            Y02080 66643902
         MODESET  EXTKEY=ZERO           KEY 0                    Y02080 66644102
EDO24112 SETLOCK OBTAIN,TYPE=LOCAL,MODE=UNCOND,                  Y02080X66644502
               RELATED=(LOCAL,IFG0555H(EDO24114))                Y02080 66645502
         MODESET  EXTKEY=DATAMGT        DATA MANAGEMENT KEY      Y02080 66645602
         LM    R0,RF,IECREGSV-IECPREFX(RF)  RESTORE REGS         Y02080 66646102
         L     RF,DXTCBADR              GET CURRENT TCB          Y02080 66646502
         USING TCB,RF                   ESTABLISH TCB ADDR       Y02080 66647502
         L     RF,TCBJSCB               GET ADDR OF JSCB         Y02080 66648502
         DROP  RF                                                Y02080 66649502
         USING IEZJSCB,RF               ESTABLISH JSCB ADDR      Y02080 66650502
         L     R1,JSCBDBTB              GET ADDR OF DEB TABL     Y02080 66651502
         DROP  RF                                                Y02080 66652502
         L     RF,DXCCW4+K4             GET SAVED OFFSET         YM1387 66653502
         LA    RDEB,K0(RDEB)            ZERO HIGH ORDER BYTE     YM2133 66655500
         MODESET EXTKEY=ZERO            DEB TABLE                Y02082 66657502
         ST    RDEB,K0(RF,R1)           PLACE NEW ADDR IN TBL    Y02080 66659502
         EJECT                                                          66660302
         L     RF,DXXPREFX              GET PREFIX               Y02080 66660502
         STM   R0,RF,IECREGSV-IECPREFX(RF)  SAVE REGS            Y02080 66660702
EDO24114 SETLOCK RELEASE,TYPE=LOCAL,                             Y02080X66661502
               RELATED=(LOCAL,IFG0555H(EDO24112))                Y02080 66663502
         MODESET  EXTKEY=DATAMGT        EOV KEY                  Y02082 66664102
         LM    R0,RF,IECREGSV-IECPREFX(RF)  RESTORE REGS         Y02080 66665302
EDO24120 EQU   *                        UHL PROCESSING           YM2133 66673502
         STCM  RDEB,B'0111',DCBDEBAD+K1 REFRESH DCBCOPY'S DEBAD  Y02082 66675202
*                                                                       66758400
******** END OF NEW DEB CONSTRUCTION *********                          66800021
*                                                              @Y30LSBS 66801003
*        IF DXCCW2+4 POINTS TO A PARAMETER LIST, THE VOLUME IS @Y30LSBS 66802003
*         MSS VIRTUAL DASD AND STAGING SPACE MUST BE ACQUIRED. @Y30LSBS 66803003
*        THIS LIST SPACE MUST ALSO BE FREED.                   @Y30LSBS 66804003
*                                                              @Y30LSBS 66805003
         USING ACQLST,R8                ACQUIRE ADDRESSABILITY @G24LSFS 66805424
         L     R8,DXCCW2+K4             SEE IF THERE'S A LIST  @G24LSFS 66805724
         LTR   R8,R8                    IF SO,  MSS            @G24LSFS 66806724
         BZ    EDO24140                 IF NOT, NOTHING TO DO  @Y30LSBS 66807724
         LR    RC,RDEB                  RC IS DEB POINTER      @G24LSFS 66809124
         USING DEBDASD-(DEBBASND-DEBBASIC),RC                  @G24LSFS 66809224
         CLI   DEBSTRCC,ALLBITS         IS THIS A DUMMY EXTENT @G24LSFS 66809324
         BE    EDO24130                 YES, NO NEW EXTENTS    @G24LSFS 66809424
         SR    R1,R1                    CLEAR REG              @G24LSFS 66809524
         IC    R1,DEBNMEXT              DEB EXTENT NUMBER      @G24LSFS 66809624
         CH    RD,NEWVOL                ON NEW VOL             @G24LSFS 66809724
         BE    EDO24125                 YES,GET NEW EXTENTS    @G24LSFS 66809824
**                                                             @G24LSFS 66810124
**   IF OLD EXTENT WAS DUMMY,ALL EXTENTS ARE NEW***************@G24LSFS 66810224
**                                                             @G24LSFS 66810424
         CLI   OLDSTRCC,ALLBITS         WAS OLD EXTENT DUMMY   @G24LSFS 66810824
         BE    EDO24125                 YES,ALL EXTENTS NEW    @G24LSFS 66810924
         L     RF,DXCCW7+4              OLD DEB EXTENT NUMBER  @G24LSFS 66811024
         SR    R1,RF                    NUMBER OF NEW EXTENTS  @G24LSFS 66811224
         SR    RC,RC                    CLEAR DEB REG          @G24LSFS 66811324
         IC    RC,DEBEXSCL              EXTENT SCALE           @G24LSFS 66811424
         SLL   RF,0(RC)                 DISPLACEMENT TO EXTS   @G24LSFS 66811524
         LA    RC,0(RF,RDEB)            PTR TO REF NEW EXTS    @G24LSFS 66811724
EDO24125 EQU   *                        CONTINUE               @G24LSFS 66811824
         STC   R1,ARNMEXTS              EXTENT NUMBER TO PARM  @G24LSFS 66811924
         LA    RF,AREXT                 EXTENTS AREA IN PARM   @G24LSFS 66812024
         OI    ARFLAG,INHIBST           SET TO INHIBIT STAGE   @G24LSFS 66812124
EDO24126 EQU  *                         LOOP THROUGH ALL EXTS  @G24LSFS 66812224
         MVC   K0(K2,RF),DEBSTRCC       START AND END CYLINDER-@G24LSFS 66812324
         MVC   K2(K2,RF),DEBENDCC       TO ACQUIRE PARM LIST   @G24LSFS 66812424
**                                                             @G24LSFS 66812524
** IF ANY EXTENT IS NOT ON A CYLINDER BOUNDARY THEN ALL THE    @G24LSFS 66812624
** EXTENTS WILL BE STAGED.                                     @G24LSFS 66812724
**                                                             @G24LSFS 66812824
         TM    DEBDVMOD,X'18'           IS EXT NOT CYL BNDRY.  @G24LSFS 66812924
         BO    EDO24127                 YES,STAGE ALL EXTENTS  @G24LSFS 66813024
         TM    DCBMACF1,DCBMRPT1        IS POINT BEING USED    @G24LSFS 66813124
         BZ    EDO24128                 NO,DON'T STAGE IF CYL  @G24LSFS 66813224
EDO24127 EQU   *                        HERE TO RESET INHIBIT  @G24LSFS 66813324
         NI    ARFLAG,X'FF'-INHIBST     STAGE THESE EXTENTS    @G24LSFS 66813424
EDO24128 EQU   *                        CONTINUE TO INHIBIT    @G24LSFS 66813524
         DROP  RC                                              @G24LSFS 66813624
         LA    RF,K4(RF)                INCR PARM LIST PTR     @G24LSFS 66813724
         LA    RC,K16(RC)               INCR DEB EXT PTR       @G24LSFS 66813824
         BCT   R1,EDO24126              BRANCH IF MORE EXTENTS @G24LSFS 66813924
         OI    ARFLAG,ARSEC             SET SECONDARY EXTEND   @G24LSFS 66815124
         XC    ARECB(K4),ARECB          ZERO ECB ADDRESS       @Y30LSBS 66815324
         MVC   ARVOL,UCBVOLI            MOVE VOLID TO HEADER   @Y30LSBS 66815424
         MVI   ACQLST+K3,ACQPLN         SET LIST LENGTH        @Y30LSFY 66815524
         MVI   AROP,ACQOP               ACQ. OPCODE IN LIST    @Y30LSFY 66815624
         ICBACREL TYPE=ACQ,MF=(E,ACQLST)  GET STAGING SPACE    @Y30LSBS 66815724
         LA    RWTGC,DXXENTRY           SET RWTGC FOR RES RTN  @Y30LSFY 66815824
         LA    RWTG,DXXAREA             POINT TO EOV WTG       @Y30LSFY 66815924
         LTR   RF,RF                    ANY ERRORS             @Y30LSBS 66816024
         BZ    EDO24130                 NO   FREE THE CORE     @Y30LSBS 66816124
*****    ACQUIRE FAILED - ABEND                                @Y30LSFY 66816224
* NOTE: IFG0199B MAY DESTROY THE 2ND WORD OF THE PARM LIST ON ABEND     66816324
*                                                              @Y30LSFY 66816403
ERR111   EQU   111                      IDMS FAILURE CODE      @Y30LSFY 66816603
         LR    RB,R1                    PASS PARM LIST PTR     @Y30LSFY 66816803
         DMABCOND ERR111,MODPD5H        XCTL TO PROB DET       @Y30LSFY 66817203
*                                                              @Y30LSFY 66817403
EDO24130 EQU   *                                               @Y30LSBS 66817503
         DROP  R8                                              @G24LSFS 66817724
         IECRES FREE,A=(1),PREFIX=YES,STM=(R2,RET,WTGPREFX)    @Y30LSBS 66818003
*                                                              @Y30LSBS 66818403
EDO24140 EQU   *                                               @Y30LSBS 66819003
         EJECT                                                          66820002
*                                                                       67000021
***********    USER HEADER LABEL PROCESSING SECTION                     67200021
*                                                                       67400021
*        REREAD JFCB TO REFRESH WORKAREA OVERLAID BY DEB         YM3116 67420002
*                                                                       67430002
         L     RTIOT,DXTIOTAD           GET TIOT ENTRY ADDRESS   YM3116 67440002
         LA    R7,TIOEJFCB              GET JFCB ADDRESS ADDRESS YM3116 67450002
         IECRES LOCJFCB,(R7)            LOCATE JFCB              YM3116 67460002
         MVC   DXJBF(JFCBLGTH),INFMJFCB-INFMJFCB(R7) MOVE JFCB   YM3116 67470002
*                                                                       67480002
         LA    R7,K1                                                    67600021
         CR    RD,R7                    WAS EXTEND ON SAME VOLUME       67800021
         BE    EDO24800                 SKIP USER HEADER LABELS         68000021
         MVC   DSCEXTYP(K6),DXCCW6+K1   RESTORE UL EXTENT INFO   M1784  68100021
         TM    DXCCW6,JFCSL+JFCBUL      TEST IF LABEL TYPE IS SUL       68200021
         BNO   EDO24300                 BRANCH IF NOT SUL               68400021
         TM    DCBMACRF,DCBMEXCP        IS THIS EXCP DCB        YA02186 68420002
         BZ    EDO24150                 BRANCH IF NO            YA02186 68440002
         TM    DCBMACRF,DCBMRFE         IS EXIT LIST PRESENT     Y02082 68460002
         BZ    EDO24300                 BRANCH IF NO             Y02082 68480002
         TM    DCBMACRF,DCBMRCI         IS DSORG PRESENT         Y02082 68500102
         BZ    EDO24160                 BRANCH IF NO-ASSUME PS   Y02082 68520002
EDO24150 EQU   *                        TEST DSORG               Y02082 68540002
         TM    DCBDSORG,DCBORGPS        TEST IF DSORG IS PHYS SEQ       68600021
         BZ    EDO24300                 BRANCH IF NOT PHYS SEQ          68800002
         TM    DCBMACRF,DCBMEXCP        IS THIS EXCP DCB        YA02186 68800202
         BO    EDO24160                 BRANCH IF YES           YA02186 68800402
         TM    JFCDSORG,JFCORGDA        IS DATA SET BDAM        YA02186 68850002
         BO    EDO24300                 BR IF YES-SPECIAL EXIT  YA02186 68900002
EDO24160 EQU   *                        LOOK FOR UHL EXIT       YA02186 68950002
         L     RC,DCBEXLST              PICK UP EXIT LIST FROM DCB      69000021
         LA    RC,K0(,RC)               ZERO HI ORDER BYTE OF EXIT LST  69200021
         LTR   RC,RC                    IS EXIT LIST ZERO               69400021
         BZ    EDO24300                 GO TO CHECK PRE-ALLOC UL TRK    69600021
         MODESET KEYADDR=DXUKEY,WORKREG=7 USER'S EXIT LIST       Y02082 69650002
EDO24200 EQU   *                        PROCESS ENTRY                   69800002
         CLI   K0(RC),K2                IS THIS ACTIVE EXIT 2           70000021
         BE    EDO24400                 GO TO PROCESS USER LABELS       70200021
         CLI   K0(RC),K2+LASTNTRY       SEE IF LAST IND ALSO ON         70400021
         BE    EDO24400                 GO TO PROCESS USER LABELS       70600021
         TM    K0(RC),LASTNTRY          IS THIS LAST ENTRY IN LIST      70800021
         LA    RC,K4(,RC)               POINT TO NEXT ENTRY             71000021
         BZ    EDO24200                 NO, BRANCH                      71200021
         EJECT                                                          71201002
         MODESET EXTKEY=DATAMGT         EOV KEY                  Y02082 71250002
EDO24300 EQU   *                        CHECK PRE-ALLOC UL TRK          71400002
         L     RC,MLZEROS               VALUE FOR IFG0555J       A40053 71500021
         CLI   DSCEXTYP,ULEXTYP         USER LABEL TRACK PRE-ALLOCATED  71600021
         BE    EDO24500                 YES, SPECIAL EXIT        A40053 71800021
         B     EDO24800                 BYPASS                          72000021
*                                                                       72200021
EDO24400 EQU   *                        PROCESS USER LABELS             72400002
         L     RC,K0(,RC)               PICK UP USER'S EXIT ADDRESS     72600021
         MODESET EXTKEY=DATAMGT         EOV KEY                  Y02082 72650002
         LR    R7,RC                                                    72800021
         LA    R7,K0(,R7)               ZERO HI ORDER BYTE              73000021
         LTR   R7,R7                    IS EXIT ADDRESS ZERO            73200021
         BZ    EDO24300                 YES,CK PRE-ALLOC UL TRK         73400021
EDO24500 EQU   *                        SPECIAL EXIT                    73600002
         SR    RET,RET                  SET BRANCH TABLE RET TO  A40053 73900021
*                                       ZERO                     A40053 74000021
         MVC   DXRETMOD,LOAD0H0H        ID OF CURRENT MODULE            74200021
         LA    R7,LOAD2Q                LOAD 555J                       74400021
         LA    RWTGC,DXXENTRY           SET RWTGC FOR RES RTN    M1773  74450021
         LA    RWTG,DXXAREA             POINT TO EOV WTG                74800021
         IECRES LOAD,MODID=(R7),BRCODE=(RET),BRANCH=QUEUED       Y02080 75050002
         EJECT                                                          75200002
*                                                                       76600021
*        EXIT TO EXCP-DCB CALLER OR GO TO IFG0551L                      76620002
*                                                                       77000021
EDO24800 EQU   *                        TURN OFF EOF BIT                77600002
         NI    DCBOFLGS,K255-DCBOEOF    TURN OFF FILE MARK FLAG         77800021
*                        CHECK IF EXCP SPECIFIED                        78000021
EDO24900 EQU   *                        UPDATE DEBDCBAD                 79600002
         L     RDEB,DCBDEBAD            GET ADDR OF DEB          Y02082 81250002
         MVC   DEBDCBAD+K1(L'DEBDCBAD-K1),DXUDCBAD+K1 POINT DEB  Y02082*81300002
                                        TO USER DCB              Y02082 81350002
         L     RF,DXDEBXAD              GET PTR TO DEB EXTENSION YM1272 81450002
         NI    DEBXFLG1-DEBXTN(RF),ALLBITS-DEBXCDCB DEB PT USER  YM1272 81500002
         TM    DCBMACRF,DCBMEXCP        EXCP IND IN BIT 0               81600021
         BZ    EDO25100                 NO,BRANCH                       81800002
*                                                                Y02080 82600002
* FREE THE END OF VOLUME WORK AREA                               Y02080 82650002
*                                                                Y02080 82700002
         NI    DCBOFLGS,ALLBITS-DCBOBUSY  RESET I/O SUPPORT BIT  Y02080 83000002
         IECRES INIT,DCBCOPY=FRWKAR,STM=(0,14,DXXPREFX)          Y02082 83002002
         LR    R1,RCORE                                          Y02080 83010002
         IECRES FREE,A=(1),PREFIX=EOV   RELEASE CORE             Y02080 83030002
         EJECT                                                          83031002
*                                                                Y02080 83050002
*        RETURN TO CALLER                                        Y02080 83100002
*                                                                Y02080 83150002
         SR    RF,RF                    ZERO RETURN CODE         Y02082 83170002
         IECRES EXIT                    RETURN                   Y02080 83200002
         SPACE 2                                                        83350002
EDO25100 EQU   *                        NO EXCP                         83800002
         MVC   DXXMODID,VOL1A           ACCESS METHOD EXECUTOR          84000021
         MVC   DXXMODEP+K1(K3),VOL1A+K2 ADDR OF 551L             Y02080 84200002
         SR    RF,RF                    ZERO WORK REG            YM0992 84300000
EDO25200 EQU   *                        BRANCH DIRECT                   84400002
         IECRES LOAD,PREFIX=DXXPREFX,BRANCH=DIRECT               Y02080 85050002
         SPACE 2                                                        85050202
EDO25300 DMABCOND PCK,PGFREE            PAGE FREE ERROR          YM5929 85050402
         EJECT                                                          85070002
*                                                                       85200021
*              EXECUTED INSTRUCTIONS                                    85400002
*                                                                       88000021
EDO25600 EQU   *                        USED IN EX INSTRUCTION          88200002
         MVC   DEB+K74-DEB(,RC),JFCBDSNM+K74  RESTORE SUBRTNS    Y02134 88400002
EDO25650 EQU   *                        USED IN EX INSTRUCTION          88420002
         MVC   JFCBDSNM+K74(K0),DEB+K74-DEB(R1)  SAVE SUBRTNS    Y02134 88450002
*                                                                       88600021
*                        CONSTANTS                                      88800021
*                                                                       89000021
         DS    0F                                                       90200021
MLZEROS  DC    X'02000000'              VALUE PASSED TO 555J            90400021
MLCN36   DC    H'36'                    HALF WORD OF 36          Y02134 90594002
MLCN6    DC    H'06'                    HALF WORD OF 6           Y02134 90596002
MLCN1    DC    H'1'                     HALF WORD CONSTANT OF 1  YM1252 90598002
MLCN10   DC    H'16'                    HALF WORD CONST OF 16  @ZA13538 90598124
OLDVOL   EQU   MLCN1                    EXTEND ON CURRENT VOL  @G24LSFS 90598224
NEWVOL   DC    H'4'                     EXTEND ON NEW VOL      @G24LSFS 90598324
*                                                              @Y30LSBS 90598424
*                                                              @Y30LSBS 90598524
*        SOME  MSS EQUATES                                     @Y30LSBS 90598624
*                                                              @Y30LSBS 90598724
*                                                              @Y30LSBS 90599024
ARSEC    EQU   X'10'                    SECONDARY EXTEND       @G24LSFS 90599124
INHIBST  EQU   X'20'                    INHIBIT STAGING        @Y30LSBS 90599224
ACQPLN   EQU   96                       LENGTH OF ICBACREL LIST@Y30LSBS 90599324
ACQOP    EQU   X'02'                    OPCODE FOR ACQUIRE     @ZM44640 90599624
         EJECT                                                          90600002
*                                                                       90800021
*        XCTL  TABLE FOR IFG0555H                                       91000021
*                                                                       91200021
         XCTLTABL SVC=055,ID=(MODPD5H,0P,VOL1A,1L,LOAD0H0H,5H,   YM1193X91500002
               LOAD2Q,5J),BRT=YES,LENGTH=                        YM1193 91800002
         EJECT                                                   YM2133 91810000
         IECEQU IEZDEB=YES                                       YM1272 91830002
         IECDSECS CVT,TCB,DCB,IEZDEB,UCB,MAIN,WTG,PREFX,TIOT,    YM3116*91900002
               JSCB,PSA,EXPAND=YES                               YM1272 91950002
ACQLST   DSECT                                                 @Y30LSFY 91950203
OLDSTRCC EQU   DXCCW+4                  OLD DEB START CYL NO.  @G24LSFS 91950324
         ICBACREL TYPE=ACQ,MF=L         LIST FORM OF ACQUIRE   @Y30LSBS 91950403
         END                                                            92950224
