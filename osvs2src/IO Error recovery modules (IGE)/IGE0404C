         TITLE 'IGE0404C - BSC ERP TIME OUT LOAD 2'                     00050002
IGE0404C CSECT                                                          00100002
*********************************************************************** 00150002
*                                                                     * 00200002
* MODULE NAME:                                                        * 00250002
*    IGE0404C                                                         * 00300002
*                                                                     * 00350002
* DESCRIPTIVE NAME:                                                   * 00400002
*    BTAM BSC TIME OUT ERP LOAD 2                                     * 00450002
*                                                                     * 00500002
* COPYRIGHT:                                                          * 00550002
*    NONE                                                             * 00600002
*                                                                     * 00650002
* STATUS:                                                             * 00700002
*    CHANGE LEVEL 000                                                 * 00750002
*                                                                     * 00800002
* FUNCTION:                                                           * 00850002
*    THIS RECOVERS FROM TIME OUT ERRORS THAT OCCUR DURING             * 00900002
*    BSC OPERATION. THE FAILING CCW IS FOUND AND THE CORRECT          * 00950002
*    PROCEDURE IS INITIATED.                                          * 01000002
*                                                                     * 01050002
* NOTES:                                                              * 01100002
*    DEPENDENCIES:                                                    * 01150002
*        NONE                                                         * 01200002
*    RESTRICTIONS:                                                    * 01250002
*        THIS ERP IS ONLY FOR DEVICES SUPPORTED BY BTAM.              * 01300002
*    REGISTER CONVENTIONS:                                            * 01350002
*        SEE 'REGISTER DEFINITION' BELOW                              * 01400002
*                                                                     * 01450002
* PATCHLABEL:                                                         * 01500002
*    PACHAREA (92 BYTES)                                              * 01550002
*                                                                     * 01600002
* MODULE TYPE:                                                        * 01650002
*    PROCEDURE                                                        * 01700002
*    PROCESSOR:                                                       * 01750002
*        BAL                                                          * 01800002
*    ATTRIBUTES:                                                      * 01950002
*        REENTRANT, ENABLED, KEY 0, SUPERVISOR STATE, NO LOCKS HELD.  * 02000002
*                                                                     * 02050002
* ENTRY POINT:                                                        * 02100002
*    IGE0404C                                                         * 02150002
*    PURPOSE:                                                         * 02200002
*        SEE 'FUNCTION'                                               * 02250002
*    LINKAGE:                                                         * 02300002
*        THIS MODULE IS SCHEDULED FOR EXECUTION BY THE INPUT/OUTPUT   * 02350002
*        SUPERVISOR. IT RUNS UNDER AN SIRB.                           * 02400002
*    INPUT:                                                           * 02450002
*        REG 1 = ADDRESS OF IOSB                                      * 02500002
*    OUTPUT:                                                          * 02550002
*        SETS INDICATOR IN DECERRST FOR SHOULD NOT OCCUR ERROR        * 02600002
*        ALTERED CHANNEL PROGRAM                                      * 02650002
*                                                                     * 02700002
* EXITS-NORMAL:                                                       * 02750002
*    APPROPRIATE BTAM ERROR HANDLER VIA BRANCH ENTRY TO XCTL.         * 02850002
*        ALL LOADS START WITH IGE0. THE FIRST LOAD IS IGE0004A.       * 02900002
*        SUBSEQUENT LOADS ARE NUMBERED 1000 HIGHER THAN THE PREVIOUS  * 02950002
*        LOAD. THE ELEVENTH LOAD IS IGE0004B AND ALL SUBSEQUENT       * 03000002
*        LOADS ARE 1000 GREATER.                                      * 03050002
*        NO REGISTERS ARE SAVED BY THE ERROR ROUTINES AND ONLY        * 03100002
*        REGISTER 1 MAINTAINS TRANSPARENCY BETWEEN LOADS.             * 03150002
*                                                                     * 03200002
* EXITS-ERROR:                                                        * 03250002
*    NONE                                                             * 03300002
*                                                                     * 03350002
* EXTERNAL REFERENCES:                                                * 03400002
*    ROUTINES:                                                        * 03450002
*        NONE                                                         * 03500002
*    DATA AREAS                                                       * 03600002
*        IOB (MAPPED BY IEZIOB)                                       * 03650002
*        VIRTUAL CHANNEL PROGRAM                                      * 03700002
*        ERP WORKAREA (MAPPED BY IECDERWA)                            * 03750002
*    CONTROL BLOCKS                                                   * 03800002
*        UCB                                                          * 03850002
*        DCB                                                          * 03900002
*        DECB                                                         * 03950002
*        IOSB         (MAPPED BY IECDIOSB)                            * 04000002
*        CVT          (MAPPED BY CVT)                                 * 04050002
*        IOB          (MAPPED BY IEZIOB)                              * 04100002
*        RQE          (MAPPED BY IECDRQE)                             * 04150002
*                                                                     * 04200002
* TABLES-WORKAREAS:                                                   * 04250002
*    ERP WORKAREA                                                     * 04300002
*    IOB CHANNEL PROGRAM AREA IN IOB BTAM EXTENSION                   * 04350002
*                                                                     * 04400002
* MACROS:                                                             * 04450002
*    NONE                                                             * 04500002
*                                                                     * 04550002
* CHANGE ACTIVITY:                                                    * 04600002
*    YA01231  (IN BASE)                                               * 04610002
*    YM02595K (9/20/73)                                               * 04650002
*    YM02594K (9/24/73)                                               * 04700002
*    YA02436  (11/5/73)                                               * 04710002
*    YA02160  (11/5/73)                                               * 04720002
*    YM05652K (1/25/74)                                               * 04730002
*    YA03261  (2/5/74)                                                * 04740000
*    YA03262  (2/5/74)                                                * 04742000
*    YA03249  (2/15/74)                                               * 04744000
*    ZA00504  (5/9/74)                                                * 04746000
*    AZ03990  (04/24/75)                                              * 04748000
*    ZA04863  (10/03/75)               ZA11456  (07/06/76)            * 04749000
*    ZA17702  (02/15/77)                                              * 04749500
*    ZA26097  (10/26/77)                                              * 04750000
*********************************************************************** 04800002
         EJECT                                                          04850002
         USING *,BASEREG                                                04900002
         LR    BASEREG,ERREG5      SET BASE REG                         04950002
         B     BEGIN               BRANCH AROUND ID            @ZA00504 04960000
         DC    C' IGE0404C '       MODULE ID                   @ZA00504 04970000
         DC    C' UZ15202'         PTF NUMBER                  @ZA26097 04980000
         DC    CL8'&SYSDATE'       DATE LAST ASSEMBLY          @ZA00504 04990000
BEGIN    DS    0H                                              @ZA00504 04992000
         USING RQE,ERREG5                                               05000002
         USING IOSB,IOSBREG                                             05050002
         USING IOBSTDRD,IOBRG                                           05100002
         USING EWA,EWAREG                                               05150002
         USING IECTDECB,DECBRG                                          05200002
         USING IHADCB,DCBREG                                            05250002
         L     ERREG5,IOSUSE       BASE RQE                             05300002
         L     EWAREG,IOSERP       BASE ERP WORKAREA                    05350002
         L     IOBRG,RQEIOB        BASE IOB                             05400002
         L     DECBRG,IOBECBPT     BASE DECB                            05450002
         L     DCBREG,IOBDCBPT     BASE DCB                             05500002
         L     UCBREG,IOSUCB       BASE UCB                             05550002
         DROP  ERREG5                                                   05600002
         L     CCWREG,IOBFL3       GET IOB CSW                          05650002
         LA    CCWREG,ZERO(CCWREG)   CLEAR OUT FLAG BYTE                05700002
         SH    CCWREG,ERRCN8       ADJUST TO FAILING CCW IN IOB         05750002
BSCTO0AA TM    IOBWORK,TPOPPTXT    ERROR OCCUR PRIOR TEXT               05800002
         BZ    BSCTO02             YES, CONTINUE FLOW                   05850002
         CLI   ZERO(CCWREG),CCWREAD   ERROR OCCUR ON A READ             05900002
         BNE   BSCTO11             NO, CHECK SPECIAL ERRORS             05950002
         TM    IOBWORK,TPOPDTXT    ERROR OCCUR DURING TEXT              06000002
         BO    BSCTO14             YES, CHECK FURTHER                   06050002
         CLI   IOBWORK,TPOPRRTX    ERROR ON RESPONSE TO TEXT            06100002
         BE    BSCTOT01            YES, SET UP WRITE ENQ                06150002
BSCTO00  OI    DECERRST,DECSNO     INDICATE SHOULD NOT OCCUR            06200002
BSCTO01  MVI   IOBERRCT,ERRMAXCT   SET FOR NO RETRIES                   06250002
         B     BSCTOT07            CHECK FOR LERB                       06300002
BSCTO02  CLI   ZERO(CCWREG),CCWDIAL   ERROR ON A DIAL COMMAND           06350002
         BE    BSCTOT0A            YES, SET UP DISABLE                  06400002
         CLI   IOBWORK,TPOPRENQ    ERROR ON A READ ENQ                  06450002
         BE    BSCTO21X            YES, CHECK OPERATION TYPE            06500002
         CLI   IOBWORK,TPREADID    THIS READ ID CCW                     06550002
         BE    BSCTO22X            YES, CHECK FURTHER                   06600002
         B     BSCTO04                                                  06650002
BSCTO21X CLI   DECTYPE+L1,READINIT   THIS A READ INITIAL                06700002
         BNE   BSCTO02A            NO, CONTINUE CHECKING                06750002
         TM    L17(UCBREG),X90     ARE WE ON DIAL LINE                  06800002
         BNZ   BSCTOT07            YES, RESTART WIRH READ ENQ           06850002
         B     BSCTO03             NO, ADJUST TO PREPARE                06900002
BSCTO02A CLI   DECTYPE+L1,RDINITEN   THIS A READ INITIAL ENQ            06950002
         BE    BSCTO03             YES, REWRITE EOT'S                   07000002
         CLI   DECTYPE+L1,WRENQCP    RD ENQ CP                          07050002
         BNE   BSCTOT07            NO, CHECK FURTHER            YA03261 07100000
         TM    L35(DCBREG),RJEMASK   RJE REQUESTING NO RETRIES          07150002
         BZ    BSCTOT07            CHECK FOR LERB                       07200002
         B     BSCTO01             SET NO RETRIES                       07250002
BSCTOT0B EQU   *                                                        07300002
         CLI   DECTYPE+L1,WRRESET    WRITE RESET CHAN PROGRAM           07400002
         BE    BSCTO01             YES, SET NO RETRIES                  07450002
         B     BSCTOT07            NO, SET CPA TO FAILURE CM            07550002
BSCTO03  SH    CCWREG,ERRCN8       BACK UP ONE CCW                      07600002
         B     BSCTOT07            CONTINUE FLOW                        07650002
BSCTO22X SH    CCWREG,ERRCN8       BACK UP ONE CCW                      07700002
         CLI   L5(CCWREG),TPWRITID   THIS WRITE ID CCW                  07800002
         BE    BSCTOT07            YES, RESTART HERE                    07850002
         LA    CCWREG,L8(CCWREG)   STEP TO NEXT CCW                     07950002
         B     BSCTOT07                                                 08000002
BSCTO04  CLI   IOBWORK,TPOPRREN    ERROR ON A READ RESP TO ENQ          08050002
         BNE   BSCTO2              NO CONTINUE                          08100002
         B     BSCTO03             RETRY                                08150002
BSCTO10  LA    NAMEREG,ERLOD12     ADDRESS OF LERB ROUTINE              08200002
XCTLOUT  EQU   *                                                        08250002
         L     ERRETR,CVTPTR       POINT TO CVT                         08300002
         USING CVTMAP,ERRETR                                            08350002
         L     ERRETR,CVTXTLER     POINT TO XCTL ROUITNE                08400002
         DROP  ERRETR                                                   08450002
         BR    ERRETR              EXIT VIA LERB ROUTINE                08500002
BSCTO11  CLI   ZERO(CCWREG),CCWWRITE    ERROR ON A WRITE                08550002
         BE    BSCTO12             YES, SET UP WRITE CHAN PROG          08600002
         CLI   ZERO(CCWREG),CCWDISAB    ERROR ON A DISABLE              08650002
         BNE   BSCTO00             NO, SET SHOULD NOT OCCUR             08700002
         B     BSCTOT07            YES, SET UP TO RETRY                 08750002
BSCTO12  CLI   L13(CCWREG),WENDRSP   ERROR DURING WR TRANS TXT          08800002
         BNE   BSCTO00             NO, POST SNO                         08850002
         MVC   IOBWORK+L2,DCBBSDLE   PREPARE TO WRITE DLE ENQ           08950002
         MVC   IOBWORK+L3,DCBBSENQ                                      09000002
         LA    ERREG2,IOBWORK+L2   ADDRESS OF DLE ENQ                   09050002
         LA    ERREG4,CCWREAD      COUNT OF 2                           09100002
         ST    ERREG4,IOBERCCW+L4   STORE IN CCW                        09150002
         LA    ERREG4,CCWWRITE     SET WRITE COMMAND                    09200002
         LA    ERRLNK,CCWTIC       SET TIC COMMAND                      09250002
         B     BSCTO04A            COMPLETE CHANNEL PROGRAM             09300002
BSCTO14  TM    DCBBFTEK,DYNBUF     DYNAMIC BUFFERING USED               09350002
         BO    BSCTOT09            YES, POST WITH ERROR                 09400002
         CLI   IOBCPA,CCWAPOLL     THIS A POLL OPERATION                09450002
         BNE   BSCTOT07            NO, BRANCH                  @ZA17702 09500000
         SH    CCWREG,ERRCN8       BACK UP ONE CCW                      09550002
         L     ERREG5,ZERO(CCWREG)   PICK UP AREA ADDRESS               09600002
         LA    ERREG5,L1(ERREG5)   INCREMENT ADDRESS BY ONE             09650002
         CLM   ERREG5,L7,L9(CCWREG) IS ADDR & COUNT ADJUSTED   @ZA11456 09700000
         BE    BSCTOTCA            SET UP WRITE NAK AND TIC    @ZA11456 09750000
         STCM  ERREG5,L7,L9(CCWREG)   NO, STORE IN READ        @ZA00504 09800000
         LH    ERREG5,L14(CCWREG)   PICK UP COUNT                       09850002
         LA    ERREG5,L1(ERREG5)   INCREMENT COUNT BY ONE               09900002
         STH   ERREG5,L14(CCWREG)   STORE IN CCW                        09950002
BSCTOTCA AH    CCWREG,ERRCN8       READJUST POINTER            @ZA11456 10000000
         LA    ERREG4,CCWWRITE     WRITE OP TYPE                YA03249 10050000
         LA    ERREG2,DCBBSNAK     NAK                          YA03249 10060000
         LA    ERRLNK,CCWTIC       TIC OP TYPE                  YA03249 10070000
BSCTO142 MVI   IOBWORK+L1,RTRNCDE2   INDICATE INTERNAL ROUTINE  YA03249 10100000
         B     BSCTOT04            CONTINUE CHAN PROG GEN       YA03249 10150000
BSCTOT07 ST    CCWREG,IOBSTART     SET CHAN PROG ADDRESS                10200000
BSCTOTB7 TM    IOBSENS0,LERBDCID   LINE ERROR RECORD REQ                10300002
         BZ    BSCTOTA7            NO, CONTINUE FLOW                    10350002
         TM    DCBERROP,DCBLERBI   IS LERB REQUIRED                     10400002
         BNO   BSCTOTA7            NO, CONTINUE FLOW                    10450002
         TM    DECTYPE,NOLERB      SUPPRESS LERB                        10500002
         BO    BSCTOTA7            YES, DON'T SET LERB                  10550002
         MVI   IOBINCAM+L1,LERBTOID   TIME OUT LERB REQUIRED            10600002
BSCTOTA7 CLI   IOBERRCT,ERRMAXCT   ARE RETRIES EXHAUSTED                10650002
         BNL   BSCTOT09            YES, SET PERM ERROR                  10700002
         IC    ERREG5,IOBERRCT     PICK UP RETRY COUNT                  10750002
         LA    ERREG5,L1(ERREG5)   INCREMENT BY ONE                     10800002
         STC   ERREG5,IOBERRCT     STORE NEW COUNT                      10850002
BSCTO26  EQU   *                                                        10900002
         CLI   IOBINCAM+L1,LERBTOID     LERB REQUIRED           YA02436 10950002
         BE    BSCTO10             YES, EXIT VIA LERB           YA02436 11000002
         MVI   EWAIND1,EWAISVCF    SVC 15                      YM05652K 11050002
         L     NAMEREG,TRANSRTN    LOAD NAME OF 904B           YM02594K 11100002
         B     XCTLOUT             XCTL                                 11150002
BSCTOT09 NI    IOSFLA,L255-IOSERR   INDICATE PERMANENT ERROR            11200002
         NI    IOBFLAG1,L255-IOBERRTN   ALSO IN IOB                     11250002
         L     ERREG5,DECENTRY     GET ADDR OF TERMINAL LIST            11300002
         CLI   ZERO(ERREG5),SWLST   IS THIS A SWLST                     11350002
         BNE   BSCTO21D                                                 11400002
         CLI   DECTYPE+L1,WRTCON   IS THIS WRITE CONNECT                11500002
         BE    BSCTOSW3                                                 11550002
*                                  THE FOLLOWING DELETED FOR    YA03261 11600000
***      CLI   IOBCPA+L21,X07      READ ID (WORLD TRADE)                11650000
***      BE    BSCTO21                                                  11700000
         CLI   L5(CCWREG),X07      IS THIS READ ID ENQ          YA03262 11750000
         BNE   BSCTO21D                                                 11800002
BSCTO21  EQU   *                                                        11850002
         LA    CCWREG,L32(CCWREG)   POINT TO DISABLE CCW                11900002
BSCTODIS EQU   *                                                        11950002
         MVC   IOBERCCW(L16),ZERO(CCWREG)   MOVE DISABLE AND TIC CCWS   12000002
         LA    CCWREG,IOBERCCW     POINT TO ERROR CCW AREA              12100002
         MVI   IOBERRCT,ZERO       ZERO OUT RETRY COUNT                 12150002
         B     BSCTO21E                                                 12200002
BSCTOSW3 EQU   *                                                        12250002
         MVC   IOBERCCW(L16),DLEOTCCW   WRITE DLE EOT , DISABLE         12300002
         LA    ERREG5,DCBBSDLE     GET ADDRESS OF DLE EOT               12400002
         ST    ERREG5,IOBERCCW     STORE ADDRESS IN CCW                 12450002
         MVI   IOBERCCW,CCWWRITE   MOVE IN WRITE COMMAND                12500002
         LA    CCWREG,IOBERCCW                                          12550002
BSCTO21C EQU   *                                                        12600002
         MVC   IOBERCCW+L16(L1),IOBSENS0   MOVE SENSE INFO TO AREA      12650002
         MVC   IOBERCCW+L17(L7),IOBCSW   MOVE CSW TO AREA               12700002
         MVI   IOBERRCT+L1,RTRNSPCD   SET SPECIAL RETURN CODE           12750002
         MVI   IOBWORK+L1,RTNCD8C   SET BRANCH OFFSET                   12800002
BSCTO21E ST    CCWREG,IOBSTART     STORE IN IOBSTART                    12850002
         OI    IOSFLA,IOSERR       TURN ON ERP IN CONTROL               12950002
         OI    IOBFLAG1,IOBERRTN   ALSO IN IOB                          13000002
         B     BSCTO26             EXECUTE CHAN PROGRAM                 13050002
BSCTO21D EQU   *                                                        13100002
         CLI   IOBINCAM+L1,LERBTOID   LERB REQUIRED             YA02436 13150002
         BE    BSCTO10             YES, EXIT VIA LERB           YA02436 13200002
         LH    NAMEREG,ERLOD35     ADDRESS OF ERROR POST ROUTINE        13250002
         B     XCTLOUT             EXIT                                 13300002
BSCTOT01 LA    ERREG2,DCBBSENQ     ADDRESS OF ENQ CHARACTER             13350002
         MVI   IOBWORK+L1,RTNCDE6                                       13400002
BSCTOT02 LA    ERREG4,CCWWRITE     SET WRITE COMMAND                    13450002
         LA    ERRLNK,CCWTIC       SET TIC COMMAND                      13500002
BSCTOT04 ST    ERREG4,IOBERCCW+L4   SET COUNT IN CCW                    13550002
BSCTO04A ST    ERREG2,IOBERCCW     STORE ADDRESS IN CCW                 13600002
         STC   ERREG4,IOBERCCW     SET COMMAND IN CCW                   13650002
         CLI   IOBWORK+L1,ZERO     SPECIAL RETURN REQUIRED              13700002
         BE    BSCTOTA6            NO, DON'T SET CODE                   13750002
         MVI   IOBERRCT+L1,RTRNSPCD   SET SPECIAL RETURN CODE           13800002
BSCTOTA6 ST    CCWREG,IOBERCCW+L8   STORE TIC ADDRESS                   13850002
         STC   ERRLNK,IOBERCCW+L8   SET COMMAND IN CCW                  13900002
         ST    ERREG4,IOBERCCW+L12   SET COUNT IN CCW           YA02160 13950002
         MVI   IOBERCCW+L4,CHAINCDE   SET COMMND CHN & SLI FLAGS        14000002
         LA    CCWREG,IOBERCCW     CHANNEL PROGRAM ADDRESS              14100002
         B     BSCTOT07            RETRY ERROR                          14150002
BSCTOT2A LA    ERRLNK,CCWNOP                                            14200002
         LA    ERREG2,IOBWORK+L2                                        14250002
         LA    ERREG4,CCWREAD                                           14300002
         MVI   IOBWORK+L1,RTRNCDE1  SET SPECIAL RET CD = 81    @ZA11456 14320000
         B     BSCTOT04                                                 14350002
BSCTO2   CLI   IOBWORK,TPOPRRPL    READ RESPONSE TO POLLING             14400002
         BNE   BSCTO23             NO CHECK FURTHER                     14450002
         TM    DCBBFTEK,DYNBUF     DYNAMIC BUFFERING           @ZA03990 14455000
         BNO   BSCT02A             NO, CHECK RETRY             @ZA03990 14460000
         MVC   L9(L3,CCWREG),L1(CCWREG)   PUT INPUT            @ZA03990 14465000
*                     AREA ADDR IN RD TEXT CCW (FROM RD INDEX) @ZA03990 14470000
*                        FOR MB TO RELEASE BUFFERS. THIS MVC   @ZA03990 14475000
*                        IS GOOD FOR BOTH OPEN AND WRAP LIST.  @ZA03990 14480000
         B     BSCTOT09         POST WITH ERROR                @ZA03990 14485000
BSCT02A  EQU   *                                                        14490000
         L     ERREG2,DECAREA      POINT TO BUFFER              YA03249 14500000
         CLC   ZERO(L1,ERREG2),IOBDCBPT   INDEX EQUAL           YA03249 14550000
         BE    INDXEQUL            YES                          YA03249 14600000
         MVC   IOBDCBPT(L1),ZERO(ERREG2)   SET NEW INDEX        YA03249 14610000
         MVI   IOBERRCT,ZERO       SET COUNT TO ZERO            YA03249 14620000
INDXEQUL EQU   *                                                YA03249 14630000
         L     ERREG5,IOBCPA+L8    USER POLLING ENTRY                   14650002
         MVC   IOBCPA+L9(L3),DECENTRY+L1   FAILING ADDR TO CHAN PROG    14700002
         L     ERREG2,IOBCPA+L8    PICK UP FAILING ADDR                 14750002
         SR    ERREG5,ERREG2       DIFF BETWEEN USERS AND FAILED        14800002
         AH    ERREG5,IOBCPA+L14   ADD TOTAL                            14850002
         STH   ERREG5,IOBCPA+L14   STORE NEW COUNT                      14900002
         L     ERREG5,ZERO(CCWREG)   GET DATA ADDRESS           YA03249 14950000
         LA    ERREG5,L1(ERREG5)   BUMP BY ONE                  YA03249 15000000
         STCM  ERREG5,L7,L9(CCWREG)   STORE IN NEXT CCW        @ZA00504 15010000
         LH    ERREG5,L14(CCWREG)   GET COUNT                   YA03249 15020000
         LA    ERREG5,L1(ERREG5)   BUMP BY ONE                  YA03249 15030000
         STH   ERREG5,L14(CCWREG)   RESET COUNT                 YA03249 15040000
         MVI   IOBWORK+L1,RTRNCDE2   SET SPECIAL RETURN         YA03249 15042000
         LA    ERREG2,DCBBSNAK     NAK                          YA03249 15044000
         LA    CCWREG,L8(CCWREG)   START ON NEXT CCW            YA03249 15046000
         B     BSCTOT02            BUILD CHANNEL PROGRAM        YA03249 15048000
BSCTO23  CLI   IOBWORK,TPOPRRAD    READ RESP TO ADDRESSING              15050002
         BE    BSCTO24             YES SET UP RETRY                     15100002
         CLI   ZERO(CCWREG),CCWPREP   IS CCW PREPARE                    15150002
         BE    BSCTO231            YES, POST SNO                        15200002
         CLI   IOBWORK,TPWRITRS    IS THIS WR RESP TO ENQ               15250002
         BE    BSCTO231            YES, POST SNO                        15300002
         CLI   IOBWORK,ZERO        ERP CCW                              15350002
         BNE   BSCTO231            NO, BRANCH                  @ZA26097 15400000
         L     CCWREG,IOBERCCW+L8   LOAD FAILING CCW                    15450002
         B     BSCTOT07            RESTART WITH IT                      15500002
BSCTO242 SH    CCWREG,ERRCN8       RESEND ID AND ENQ                    15550002
         B     BSCTOT07            CONTINUE FLOW                        15600002
BSCTO231 EQU   *                                                        15650002
         OI    DECERRST,DECSNO     SET SHOULD NOT OCCUR                 15700002
         B     BSCTOT09                                                 15750002
BSCTO24  LA    CCWREG,IOBCPA       START OF CHANNEL PROG                15800002
         B     BSCTOT07                                                 15850002
BSCTOT0A MVC   IOBERCCW(L8),DISABCCW   MOVE IN DISABLE                  15900002
         LA    ERRLNK,CCWTIC       SET TIC COMMAND                      15950002
         LA    ERREG4,CCWWRITE     SET COUNT TO ONE                     16000002
         B     BSCTOTA6            SET UP CHANNEL PROGRAM               16050002
         EJECT                                                          16750002
**********                                                              16800002
*                                                                       16850002
*        CONSTANTS                                                      16900002
*                                                                       16950002
**********                                                              17000002
TRANSRTN DC    F'9042'             NAME OF BTAM TRANSLATE ROUTINE       17050002
DLEOTCCW DC    X'0100000060210002'                                      17100002
DISABCCW DC    X'2F00000020010001'   DISABLE CCW                        17150002
ERLOD35  DC    H'2043'                                                  17200002
ERRCN8   DC    H'8'                                                     17250002
PACHAREA DC    23C'404C'           PATCHAREA FOR MAINTENANCE            17300002
**********                                                              17350002
*                                                                       17400002
*        MISCELLANEOUS EQUATES                                          17450002
*                                                                       17500002
**********                                                              17550002
STATUP   EQU   254                 STATISTICS UPDATE ROUTINE NAME       17600002
TPOPRRPL EQU   X'0A'                                                    17700002
TPOPRRAD EQU   X'06'                                                    17750002
DECSNO   EQU   X'40'                                                    17800002
DCBLERBI EQU   X'08'                                                    17850002
LERBTOID EQU   X'03'                                                    17900002
ERRMAXCT EQU   7                                                        17950002
WRTCON   EQU   X'1C'               WRITE CONNECT                        18000002
CCWDIAL  EQU   X'29'                                                    18050002
WENDRSP  EQU   X'13'                                                    18100002
L1       EQU   1                   LENGTH AND DISPLACEMENT              18150002
L2       EQU   2                   LENGTH AND DISPLACEMENT              18200002
L3       EQU   3                   LENGTH AND DISPLACEMENT              18250002
L4       EQU   4                   LENGTH AND DISPLACEMENT              18300002
L5       EQU   5                   LENGTH AND DISPLACEMENT              18350002
L6       EQU   6                   LENGTH AND DISPLACEMENT              18400002
L7       EQU   7                   LENGTH AND DISPLACEMENT              18450002
L8       EQU   8                   LENGTH AND DISPLACEMENT              18500002
L9       EQU   9                   LENGTH AND DISPLACEMENT              18550002
L12      EQU   12                  LENGTH AND DISPLACEMENT              18560002
L13      EQU   13                  LENGTH AND DISPLACEMENT              18600002
L14      EQU   14                  LENGTH AND DISPLACEMENT              18650002
L16      EQU   16                  LENGTH AND DISPLACEMENT              18700002
L17      EQU   17                  LENGTH AND DISPLACEMENT              18750002
L21      EQU   21                  LENGTH AND DISPLACEMENT              18800002
L32      EQU   32                  LENGTH AND DISPLACEMENT              18850002
L35      EQU   35                  LENGTH AND DISPLACEMENT              18900002
ZERO     EQU   X'00'               LENGTH AND DISPLACEMENT              18950002
X07      EQU   X'07'               READ ID MASK                         19000002
X87      EQU   X'87'               WRITE CONNECT MASK                   19050002
X90      EQU   X'90'               DIAL MASK                            19100002
ERLOD12  EQU   2042                                                     19250002
NOLERB   EQU   X'40'                                                    19300002
L255     EQU   X'FF'               AND MASK                             19350002
CHAINCDE EQU   X'60'                                                    19400002
RTRNSPCD EQU   X'14'                                                    19450002
CCWTIC   EQU   X'08'                                                    19500002
LERBDCID EQU   X'01'                                                    19550002
RTRNCDE1 EQU   X'81'                                                    19600002
RTRNCDE2 EQU   X'82'                                            YA03249 19610000
CCWAPOLL EQU   X'09'                                                    19650002
DYNBUF   EQU   X'08'                                                    19700002
CCWPREP  EQU   X'06'                                                    19750002
CCWDISAB EQU   X'2F'                                                    19800002
CCWWRITE EQU   X'01'                                                    19850002
TPOPRREN EQU   X'0C'                                                    19900002
RDINITEN EQU   X'19'                                                    19950002
RTNCDE6  EQU   X'86'                                                    20000002
TPOPRENQ EQU   X'0B'                                                    20050002
READINIT EQU   X'01'                                                    20100002
TPOPRRTX EQU   X'25'                                                    20150002
TPOPDTXT EQU   X'11'                                                    20200002
CCWREAD  EQU   X'02'                                                    20250002
CCWNOP   EQU   X'03'                                                    20300002
TPOPPTXT EQU   X'30'                                                    20350002
TPREADID EQU   X'07'                                                    20400002
WRRESET  EQU   X'0A'                                                    20450002
WRENQCP  EQU   X'15'                                                    20500002
RJEMASK  EQU   X'80'                                                    20550002
TPWRITID EQU   X'03'                                                    20600002
TPWRITRS EQU   7                                                        20650002
SWLST    EQU   X'FF'                                                    20700002
RTNCD8C  EQU   X'8C'                                                    20750002
COUNT2   EQU   X'02'                                                    20800002
**********                                                              20900002
*                                                                       20950002
*        REGISTER EQUATES                                               21000002
*                                                                       21050002
**********                                                              21100002
ERREG3   EQU   0                   WORK REG                             21150002
IOSBREG  EQU   1                   IOSB BASE/PARAMETER REG              21200002
ERREG2   EQU   2                   WORK REG                             21250002
ERREG1   EQU   3                   WORK REG                             21300002
CCWREG   EQU   4                   CCW ADDRESS REG                      21350002
DECBRG   EQU   5                   DECB BASE                            21400002
DCBREG   EQU   6                   DCB BASE                             21450002
UCBREG   EQU   7                   UCB BASE                             21500002
BASEREG  EQU   8                   PROGRAM BASE                         21550002
EWAREG   EQU   9                   ERP WORKAREA BASE                    21600002
IOBRG    EQU   10                  IOB BASE                             21650002
ERREG4   EQU   11                  WORK REG                             21700002
ERRLNK   EQU   12                  LINK REG                             21750002
NAMEREG  EQU   13                  LINK REG                             21800002
ERRETR   EQU   14                  LINK REG                             21850002
ERREG5   EQU   15                  WORK REG/LINK REG                    21900002
         EJECT                                                          21950002
         IECTDECB                                                       22000002
         EJECT                                                          22050002
         DCBD  DSORG=BX,DEVD=BS                                         22100002
         EJECT                                                          22150002
         IECDRQE                                                        22200002
         EJECT                                                          22250002
         IEZIOB                                                         22300002
         EJECT                                                          22350002
CVT      DSECT                                                          22400002
         CVT                                                            22450002
         EJECT                                                          22500002
         IECDERWA                                                       22550002
**********                                                              22600002
*                                                                       22650002
*        THE FOLLOWING DEFINITIONS ARE LOCAL FOR BTAM ERPS ONLY.        22700002
*                                                                       22750002
**********                                                              22800002
         ORG   EWAIERP                                                  22850002
EWAITRAN DS    F                   ADDRESS OF IECVTCCW         YM02594K 22900002
EWAITCCW DS    F                   PARALLEL TCCW               YM02594K 22950002
EWAIOVST DS    F                   ORIGINAL IOSVST CONTENTS    YM02594K 23000002
EWAIND0  DS    B                   FLAG BYTE                            23050002
EWAIVISR EQU   X'10'               V=R REQUEST                          23650002
EWAIPMAP EQU   X'08'               PARALLEL MAPPING DONE       YM02594K 23700002
EWAIGPRO EQU   X'04'               GETMAIN IN PROCESS          YM02594K 23750002
EWAIFPRO EQU   X'02'               FREEMAIN IN PROCESS         YM02594K 23800002
EWAIND1  DS    B                   FLAG BYTE                            23850002
EWAILD00 EQU   X'80'               EXIT TO 004C                YM02594K 23900002
EWAILD15 EQU   X'40'               EXIT TO LOAD 15             YM02594K 23950002
EWAIWTOL EQU   X'20'               EXIT TO IOS WTO             YM02594K 24000002
EWAISTAT EQU   X'10'               EXIT TO STAT UPDATE         YM05652K 24010002
EWAISVCF EQU   X'08'               SVC 15/SVC 3                YM05652K 24020002
EWAIND2  DS    B                   FLAG BYTE                            24050002
EWAIND3  DS    B                   FLAG BYTE                            24100002
EWAIAREA DS    20F                 SAVE AREA FOR MA OR AREA FOR WTO     24150002
EWAISAVE DS    2F                  TEMPORARY SAVE AREA                  24200002
EWAIEXIT DS    4F                  ESATE PARAMETER LIST                 24250002
*********  END OF BTAM LOCAL DEFINITIONS **********                     24260002
         EJECT                                                          24300002
         IECDIOSB                                                       24350002
         END                                                            24400002
