         TITLE 'IGE0504C - BSC ERP SPECIAL RETURN MODULE'               00100002
IGE0504C CSECT                                                          00150002
*********************************************************************** 00200002
*                                                                     * 00250002
* MODULE NAME:                                                        * 00300002
*    IGE0504C                                                         * 00350002
*                                                                     * 00400002
* DESCRIPTIVE NAME:                                                   * 00450002
*    BTAM BSC SPECIAL RETURN ERP                                      * 00500002
*                                                                     * 00550002
* COPYRIGHT:                                                          * 00600002
*    NONE                                                             * 00650002
*                                                                     * 00700002
* STATUS:                                                             * 00750002
*    CHANGE LEVEL 000                                                 * 00800002
*                                                                     * 00850002
* FUNCTION:                                                           * 00900002
*    THIS ROUTINE CHECKS THE RESULTS OF SPECIAL I/O OPERATIONS        * 00950002
*    INITIATED BY THE OTHER BSC ERP ROUTINES. IF THE RESULT IS THE    * 01000002
*    DESIRED ONE, THE CHANNEL PROGRAM IS RESTARTED AT THE POINT       * 01050002
*    INDICATED BY THE INITIATING ERP. THE FOLLOWING TABLE INDICATES   * 01100002
*    THE INITIATED OPERATION AND RESPONSE ACTION:                     * 01150002
*                    VALUE  OP CODE  ACTION                           * 01200002
*                    X'80'    11     IF ENQ RECEIVED- (MULTIPT LINE)  * 01250002
*                                      RESEND ACK AND TIC TO FAIL CCW * 01300002
*                                    IF ENQ RECEIVED- (NON-MULTIPOINT)* 01350002
*                                      RESTART FAILING CCW            * 01400002
*                                    IF ENQ WAS NOT RECEIVED-         * 01450002
*                                      RESTART CHAN PROG AT BEGINNING * 01500002
*                   X'81'     11     IF ENQ WAS RECEIVED-             * 01550002
*                                      WRITE NAK AND TIC TO FAIL CCW  * 01600002
*                                    IF ENQ WAS NOT RECEIVED-         * 01650002
*                                      RESTART CHAN PROG AT BEGINNING * 01700002
*                   X'82'     11     WRITE NAK AND TIC TO FAILING CCW * 01750002
*                   X'83'   07 OR 25 WRITE ENQ AND TIC TO FAILING CCW * 01800002
*                   X'84'   03 OR 0C RESTART FAILING CCW OR CHECK FOR * 01850002
*                                      CONTENTION                     * 01900002
*                   X'85'            NOT USED                         * 01950002
*                   X'86'     25     RESTART AT WRITE TEXT, RESTART   * 02000002
*                                      ERP CHANNEL PROG OR RETURN TO  * 02050002
*                                      SUPERVISOR                     * 02100002
*                   X'87'     21     IF ENQ WAS RECEIVED-             * 02150002
*                                      RESTART AT FAILING CCW         * 02200002
*                                    IF ENQ WAS NOT RECEIVED-         * 02250002
*                                      RESTART AT FOLLOWING CCW IF    * 02300002
*                                      FAILING CCW IS NOT LAST CCW    * 02350002
*                                      IF FAILING CCW IS LAST CCW,    * 02400002
*                                      RESTART AT FAILING CCW.        * 02450002
*                   X'88'   09 OR 11 RESTART AT FAILING CCW.          * 02500002
*                   X'89'     11     IF FIRST TWO CHARACTERS ARE STX  * 02550002
*                                      ENQ, RESTART AT FAILING CCW.   * 02600002
*                   X'8A'            EXECUTE A READ SKIP CCW THEN     * 02650002
*                                      RESTORE ORIGINAL COMMAND.      * 02700002
*                   X'8B'     11     IF ENQ WAS RECEIVED, WRITE NAK   * 02750002
*                                      AND TIC TO THE READ CCW; OTHER-* 02800002
*                                      WISE, POST WITH ERROR.         * 02850002
*                   X'8C'    07      CLEAR SPECIAL RETURN INDICATORS  * 02900002
*                                      AND PROCESS WITH ERROR POSTING * 02950002
*                   X'8D'            GARBLED SYN CHARACTERS IN FRONT  * 02960000
*                                    OF AN EOT                        * 02970000
*                                                                     * 03000002
* NOTES:                                                              * 03050002
*    DEPENDENCIES:                                                    * 03100002
*        NONE                                                         * 03150002
*    RESTRICTIONS:                                                    * 03200002
*        THIS ERP IS ONLY FOR DEVICES SUPPORTED BY BTAM.              * 03250002
*    REGISTER CONVENTIONS:                                            * 03300002
*        SEE 'REGISTER DEFINITION' BELOW                              * 03350002
*                                                                     * 03400002
* PATCHLABEL:                                                         * 03450002
*    PACHAREA (120 BYTES)                                             * 03500002
*                                                                     * 03550002
* MODULE TYPE:                                                        * 03600002
*    PROCEDURE                                                        * 03650002
*    PROCESSOR:                                                       * 03700002
*        BAL                                                          * 03750002
*    ATTRIBUTES:                                                      * 03900002
*        REENTRANT, ENABLED, KEY 0, SUPERVISOR STATE, NO LOCKS HELD.  * 03950002
*                                                                     * 04000002
* ENTRY POINT:                                                        * 04050002
*    IGE0504C                                                         * 04100002
*    PURPOSE:                                                         * 04150002
*        SEE 'FUNCTION'                                               * 04200002
*    LINKAGE:                                                         * 04250002
*        THIS MODULE IS SCHEDULED FOR EXECUTION BY THE INPUT/OUTPUT   * 04300002
*        SUPERVISOR. IT RUNS UNDER AN SIRB.                           * 04350002
*    INPUT:                                                           * 04400002
*        REG 1 = ADDRESS OF IOSB                                      * 04450002
*    OUTPUT:                                                          * 04500002
*        SETS INDICATOR IN DECERRST FOR PERMANENT ERRORS              * 04550002
*        ALTERED CHANNEL PROGRAM                                      * 04600002
*                                                                     * 04608000
*        X'9F' IN IOBWORK+1 INDICATES A SPECIAL RESTART OF THE        * 04616000
*              CHANNEL PROGRAM WHICH CAUSES 19MB TO PASS CONTROL      * 04624000
*              TO IOS. IOS WILL RESTART THE CHANNEL PROGRAM AS IF     * 04632000
*              IT WERE A SVC "0"                                      * 04640000
*                                                                     * 04650002
* EXITS-NORMAL:                                                       * 04700002
*    APPROPRIATE BTAM ERROR HANDLER VIA BRANCH ENTRY TO XCTL.         * 04800002
*        ALL LOADS START WITH IGE0. THE FIRST LOAD IS IGE0004C.       * 04850000
*        SUBSEQUENT LOADS ARE NUMBERED 1000 HIGHER THAN THE PREVIOUS  * 04900002
*        LOAD.                                                        * 04950000
*        NO REGISTERS ARE SAVED BY THE ERROR ROUTINES AND ONLY        * 05050002
*        REGISTER 1 MAINTAINS TRANSPARENCY BETWEEN LOADS.             * 05100002
*                                                                     * 05150002
* EXITS-ERROR:                                                        * 05200002
*    NONE                                                             * 05250002
*                                                                     * 05300002
* EXTERNAL REFERENCES:                                                * 05350002
*    ROUTINES:                                                        * 05400002
*        NONE                                                         * 05450002
*    DATA AREAS                                                       * 05550002
*        IOB (MAPPED BY IEZIOB)                                       * 05600002
*        VIRTUAL CHANNEL PROGRAM                                      * 05650002
*        ERP WORKAREA (MAPPED BY IECDERWA)                            * 05700002
*    CONTROL BLOCKS                                                   * 05750002
*        UCB                                                          * 05800002
*        DCB                                                          * 05850002
*        DECB                                                         * 05900002
*        IOSB         (MAPPED BY IECDIOSB)                            * 05950002
*        CVT          (MAPPED BY CVT)                                 * 06000002
*        IOB          (MAPPED BY IEZIOB)                              * 06050002
*        RQE          (MAPPED BY IECDRQE)                             * 06100002
*                                                                     * 06150002
* TABLES-WORKAREAS:                                                   * 06200002
*    ERP WORKAREA                                                     * 06250002
*    IOB CHANNEL PROGRAM AREA IN IOB BTAM EXTENSION                   * 06300002
*                                                                     * 06350002
* MACROS:                                                             * 06400002
*    NONE                                                             * 06450002
*                                                                     * 06500002
* CHANGE ACTIVITY:                                                    * 06550002
*    YM02595K (9/20/73)                                               * 06600002
*    YM02594K (9/24/73)                                               * 06650002
*    YA02438  (11/1/73)                                               * 06660002
*    YA02439  (11/1/73)                                               * 06670002
*    YA02440  (11/1/73)                                               * 06680002
*    YM05652K (1/25/74)                                               * 06690002
*    YA03249  (2/15/74)                                               * 06692000
*    YA02308  (11/7/74)                                               * 06694003
*    YA02309  (11/7/74)                                               * 06696003
*    YA02310  (12,6,74)                                               * 06698000
*    ZA02833  (2/21/75)                                               * 06698400
*    AZ03970  (04/22/75)          AZ03971  (04/22/75)                 * 06698900
*    AZ04185  (10/01/75)          AZ04665  (10/01/75)                 * 06700900
*    AZ04679  (10/20/75)          AZ04859  (10/01/75)                 * 06702900
*    AZ04861  (10/01/75)          AZ06381  (10/01/75)                 * 06704900
*    AZ07640  (11/07/75)          AZ07651  (11/12/75)                 * 06706900
*    AZ11037  (05/17/76)          AZ12146  (07/28/76)                 * 06708900
*    AZ12156  (08/04/76)          AZ15426  (12/07/76)                 * 06710900
*    AZ17702  (02/15/77)          AZ20110  (05/12/77)                 * 06712900
*    AZ24635  (09/06/77)          AZ30537  (03/13/78)                 * 06720000
*    AZ31718  (04/12/78)          AZ32428  (05/05/78)                 * 06722000
*    AZ32980  (05/26/78)          AZ33188  (07/05/78)                 * 06724000
*    AZ33188  (07/06/78)                                              * 06732000
*********************************************************************** 06750002
         EJECT                                                          06800002
         USING *,BASEREG                                                06850002
         LR    BASEREG,ERREG5      SET BASE REG                         06860000
         B     BEGIN               BRANCH AROUND ID         LD @ZA02308 06870000
         DC    C'IGE0504C'         MODULE ID                LD @ZA02308 06880000
         DC    C' UZ20070'         PTF NUMBER                  @ZA32980 06890000
         DC    CL8'&SYSDATE'       DATE LAST ASSEMBLY       LD @ZA02308 06940003
BEGIN    DS    0H                                           LD @ZA02308 06942003
         USING RQE,ERREG5                                               06950002
         USING IECTDECB,DECBRG                                          07000002
         USING IHADCB,DCBREG                                            07050002
         USING IOSB,IOSBREG                                             07100002
         USING IOBSTDRD,IOBRG                                           07150002
         USING EWA,EWAREG                                               07200002
         L     ERREG5,IOSUSE       BASE RQE                             07350002
         L     EWAREG,IOSERP       BASE ERP WORKAREA                    07400002
         L     IOBRG,RQEIOB        BASE IOB                             07450002
         L     DECBRG,IOBECBPT     BASE DECB                            07500002
         L     DCBREG,IOBDCBPT     BASE DCB                             07550002
         L     UCBREG,IOSUCB       BASE UCB                             07600002
         DROP  ERREG5                                                   07650002
         L     CCWREG,IOBFL3       GET IOB CSW                          07700002
         LA    CCWREG,ZERO(CCWREG)   CLEAR OUT FLAG BYTE                07750002
         SH    CCWREG,ERRCN8       ADDRESS OF FAILING CCW IN IOB        07800002
         SR    ERREG5,ERREG5       INITIALIZE IC REGISTER               07900002
         LA    ERREG1,FLIPBIT      ACK FLIP BIT                         07950002
         NI    IOBWORK+L1,L255-HIGHBIT0   ZIP UNSED BIT                 08000002
         IC    ERREG5,IOBWORK+L1   PICK UP INDEX FACTOR                 08050002
         TM    IOBSENS0,TOERROR    TIME OUT ERROR OCCUR                 08100002
         BZ    BSCSP00A            NO  CONTINUE                         08150002
         CLI   IOBWORK+L1,X02      RETURN X'82'                 YA03249 08160000
         BE    BSCSP00A            YES                          YA03249 08170000
         TM    IOBERCCW+L4,SKIP    THIS READ SKIP               ZA20110 08200000
         BO    BSCSP00A            YES, CONTINUE                        08250002
         CLI   IOBWORK+L1,UERDSKP   READ SKIP FOR U E                   08300002
         BE    BSCSP00A            YES, CONTINUE NORMAL                 08350002
         CLI   IOBWORK+L1,X04      THIS T.O. ON RD,NOP                  08400002
         BE    BSCSP00A            BRANCH IF YES                        08450002
         CLI   IOBWORK+L1,CODEA    THIS T.O. FOR ERP READ SKIP          08500002
         BE    BSCSP00A            YES, BRANCH                          08550002
         CLI   IOBWORK+L1,X03      L.D. ON RD,NOP                       08600002
         BE    BSCSP00A            YES, BRANCH                          08650002
         TM    IOSSNS,X02          LOST DATA ERROR                      08700002
         BZ    BSCSP073            NO, BRANCH                           08750002
         CLI   IOBWORK+L1,ZERO     L.D. ON RD ENQ                       08800002
         BNE   BSCSP073            NO, BRANCH TO RESTART                08850002
BSCSP00A EQU   *                                                        08900002
         TM    IOBCSW+L3,CSWUE     UNIT EXCEPTION OCCUR                 08950002
         BO    BSCSPX01            YES, CHECK FOR READ SKIP             09000002
BSCSPX02 SLL   ERREG5,L2           MULTIPLY BY FOUR                     09050002
         B     BSCSP00(ERREG5)     BRANCH TO ROUTINE VIA BR TABLE       09100002
BSCSP00  B     BSCSP01             ENTRY FOR RD ENQ,TIC FAIL CCW        09150002
         B     BSCSP021        ENTRY FOR RD ENQ,WRT NAK,TIC LD @ZA02308 09200003
         B     BSCSP02         ENTRY FOR RD SKP,WRT NAK,TIC LD @ZA02308 09250003
         B     BSCSP03             ENTRY FOR RD SKP,WRT ENQ,TIC         09300002
         B     BSCSP04             ENTRY FOR CONTENTION CHECK           09350002
         B     BSCSP06             ENTRY FOR WR ENQ,CHECK RESP          09400002
         B     BSCSP06             ENTRY FOR WRT ENQ BOTH RESP          09450002
         B     BSCSP07A                                                 09500002
         B     BSCSP07                                                  09550002
         B     BSCSP09             ENTRY FOR 2780 ABORT,STX/ENQ         09600002
         B     BSCSP0A                                                  09650002
         B     BSCSP0B             ENTRY FOR WR NAK,TIC,RD TXT          09700002
         B     BSCSP0C             ENTRY FOR T.O. ON W TC ,R TC         09750002
BSCSP0D  EQU   *                                               @ZA04185 09752000
*              THE NEXT LINE IS THE ENTRY FOR INTERNAL CODE    @ZA04185 09754000
*              OF X'8D' FOR GARBLED SYN CHARACTERS IN FRONT    @ZA04185 09756000
*              OF AN EOT.                                      @ZA04185 09758000
         TM    IOBCSW+L3,UNITCK    UNIT CHECK                  @ZA04185 09760000
         BNO   BSCSP063            NO, WE RECOVERED            @ZA04185 09762000
BSCSP0D2 TM    IOBSENS0,IOBTO      TIME OUT SENSE              @ZA04185 09764000
         BNO   BSCSP073            NO, RETRY WRITE NAK         @ZA04185 09766000
*              CHANGE IOBCSW TO MAKE IT APPEAR AS IF ONLY      @ZA04185 09768000
*              AN EOT HAD BEEN READ.                           @ZA04185 09770000
         MVC   IOBCSW+L3(L2),UNITEXCP SET STAT FOR EOT RECVD   @ZA04185 09772000
         L     ERREG2,L0(CCWREG)   GET I/O AREA ADDR           @ZA04185 09774000
         MVC   L0(L1,ERREG2),DCBBSEOT  MOVE IN EOT             @ZA04185 09776000
         LH    ERREG2,L6(CCWREG)   GET RD TXT LENGTH           @ZA04185 09778000
         BCTR  ERREG2,ZERO         DECREMENT BY ONE FOR....    @ZA04185 09780000
         STH   ERREG2,IOBCSW+L5    RESIDUAL COUNT              @ZA04185 09782000
         B     BSCSP063            RETURN                      @ZA04185 09784000
BSCSPX01 CLI   ZERO(CCWREG),CCWWRITE   IS THIS WRITE CCW                09800002
         BNE   BSCSPX02            NO, CONTINUE NORMAL                  09850002
         LA    ERREG4,IOBERCCW     POINT TO FIRST ERP CCW               09900002
         CR    CCWREG,ERREG4       ERROR OCCUR ON FIRST CCW             09950002
         BNE   BSCSPX02            NO, CONTINUE NORMAL                  10000002
         MVC   IOBERCCW+L15(1),IOBWORK+L1   SAVE RETURN CODE IN CCW     10050002
         OI    IOBERCCW+L15,X80    TURN ON HIGH ORDER BIT               10100002
         MVC   IOBERCCW+L14(L1),IOBERCCW+L8   SAVE CCW COMMAND CODE     10150002
         CLI   TPCODE(CCWREG),X03   WRITE ENQ TP OP CODE       @ZA12156 10160000
         BNE   SET8A               NO                           YA02438 10170002
         CLI   L8(CCWREG),CCWTIC   NEXT CCW A TIC               YA02438 10180002
         BNE   SET8A               NO                           YA02438 10190002
         L     ERREG4,L8(CCWREG)   GET CCW ADDR FROM TIC        YA02438 10192002
         LA    ERREG4,ZERO(ERREG4)   CLEAR OUT OP CODE          YA02438 10194002
         TM    TPCODE(ERREG4),TPOPWRTX   READ RESP TO TEXT      YA02438 10196002
         BNO   SET8A               NO                           YA02438 10198002
         CLI   L16(UCBREG),DEVICE    IS IT BSC1 ?              @ZA04861 10198100
         BE    SET8A              YES SET RETURN 8A            @ZA04861 10198200
         MVI   IOBWORK+L1,RTNCD86  SET RTN CODE=X'86'           YA02438 10198402
         LR    CCWREG,ERREG4       SET UP REG                   YA02438 10198502
         B     BSCSPX03            EXIT TO IOS                  YA02438 10198802
SET8A    EQU   *                                                YA02438 10199202
         MVI   IOBERCCW+L8,CCWREAD   SET COMMAND CODE TO READ           10200002
         MVI   IOBERCCW+L12,CCWFLAG1   SET ON SLI, SKIP                 10250002
         MVI   IOBWORK+L1,RTRNCDEA   SET SPECIAL RETURN                 10300002
         LA    CCWREG,IOBERCCW+L8   READ SKIP CCW ADDRESS               10400002
BSCSPX03 ST    CCWREG,IOBSTART                                          10450002
         B     RETRY               RETRY EXCP                           10550002
BSCSP0A  MVC   IOBWORK+L1(L1),IOBERCCW+L15   RESTORE RETURN CODE        10600002
         MVC   IOBERCCW+L8(L1),IOBERCCW+L14   RESTORE COMMAND CODE      10650002
         MVI   IOBERCCW+L12,CCWFLAG2   SET CCW FLAGS                    10700002
         LA    CCWREG,IOBERCCW                                          10800002
         ST    CCWREG,IOBSTART                                          10850002
         B     BSCSP073            UPDATE RETRY COUNT                   10950002
BSCSP0C  NI    IOSFLA,L255-IOSERR   INDICATE ERROR POST                 11000002
         NI    IOBFLAG1,L255-IOBERRTN   ALSO IN IOB                     11050002
         B     BSCSP043                                                 11100002
BSCSP07A CLC   IOBWORK+L2(L1),DCBBSENQ   ENQ RECEIVED                   11150002
         BE    BSCSP07             YES RETRANSMIT                       11200002
         L     CCWREG,IOBERCCW+L8   NO DISABLE CHECK                    11250002
         TM    TPCODE(CCWREG),HIGHBIT0   THIS THE LAST CCW              11300002
         BO    BSCSP071           YES, START WITH IT                    11350002
         TM    TPCODE+L8(CCWREG),HIGHBIT0   IS NEXT CCW LAST            11400002
         BNO   BSCSPZZZ           NO, RESTART WITH IT                   11450002
         CLI   TPCODE(CCWREG),TPRESET   THIS WRITE DLE-EOT              11550002
         BE    BSCSP071           YES, REWRITE DLE-EOT                  11600002
BSCSPZZZ LA    CCWREG,L8(CCWREG)    BUMP TO NEXT CCW                    11700002
         B     BSCSP071            CONTINUE FLOW                        11750002
BSCSP09  L     ERREG1,ZERO(CCWREG)   GET AREA ADDRESS                   11800002
         CLC   ZERO(L1,ERREG1),DCBBSEOT   EOT RECEIVED?                 11850002
         BNE   BSCSP091            NO, CHECK FURTHER                    11900002
         MVI   IOBERRCT,ERRMAXCT   SET RETRY COUNT TO MAXIMUM           11950002
         MVC   IOBCSW+L5(L2),IOBERCCW+L22  SAVE NEW RESIDUAL COUNT      12000002
         B     BSCSP043            POST OPERATION                       12100002
BSCSP091 EQU   *                                                        12150002
         LH    ERREG2,L6(CCWREG)   GET ORIGINAL COUNT                   12200002
         SH    ERREG2,IOBCSW+L5    SUBTRACT RESIDUAL COUNT              12250002
         BCTR  ERREG2,ZERO         BACK UP ONE                          12300002
         AR    ERREG2,ERREG1       POINT TO LAST CHAR                   12350002
         CLC   ZERO(L1,ERREG2),DCBBSENQ   ENQ SEQUENCE                  12400002
         BNE   BSCSP092            NO, BRANCH                           12450002
         BCTR  ERREG2,ZERO         BACK UP ONE                          12500002
         CLC   ZERO(L1,ERREG2),DCBBSSTX   STX-ENQ SEQUENCE              12550002
         BE    BSCSP073            YES, CONTINUE TO RETRY               12600002
         B     BSCSP042            SET SHOULD NOT OCCUR                 12650002
BSCSP092 CLC   ZERO(L1,ERREG1),DCBBSSTX   STX    FIRST CHAR             12700002
         BE    BSCSP093            YES, BRANCH                          12750002
         CLC   ZERO(L2,ERREG1),DCBBSTSX   DLE-STX FIRST CHAR            12800002
         BNE   BSCSP042            SET SHOULD NOT OCCUR                 12850002
BSCSP093 NI    DECFLAGS,NONABT     NOT ABORT CONDITION                  12900002
         TM    IOBSENS0,DATACHK+OVERRUN                        @ZA33188 12910000
         BNZ   BSCSP073            RETRY WT NAK & TIC RD TXT   @ZA33188 12920000
         B     BSCSP063            STX ENQ RECOVERY                     12950002
BSCSP06  IC    ERREG5,IOBRCVPT     RECEIVE ACK PTR                      13000002
         LA    ERREG2,DCBBSAK0(ERREG5)   ADDRESS OF EXPECTED ACK        13050002
         CLI   ZERO(CCWREG),CCWWRITE   IS THIS WRITE ENQ                13150002
         BE    BSCSP073            YES, RETRY WRITE ENQ                 13200002
         L     ERREG4,ZERO(CCWREG)   AREA POINTER                       13300002
         AH    ERREG4,L6(CCWREG)   ORIG COUNT                           13350002
         SH    ERREG4,IOBCSW+L5    SUBTRACT RESID COUNT                 13400002
         SH    ERREG4,ERRCN2       BACK UP TWO                          13450002
         CLC   L1(L1,ERREG4),DCBBSNAK   NAK RECEIVED                    13500002
         BE    BSCSP066            YES, CHK FOR ITB MODE                13550002
         CLC   L1(L1,ERREG4),DCBBSEOT   EOT RECEIVED            ZA15426 13557000
         BE    BSCSP063                                         ZA15426 13564000
         CLC   L1(L1,ERREG4),DCBBSENQ   WAS IT AN ENQ           ZA15426 13571000
         BE    BSCSP06A            YES, BRANCH                  ZA15426 13578000
         C     ERREG4,ZERO(CCWREG)  CHECK FOR ONLY 1 BYTE REC.  ZA15426 13585000
         BL    BSCSP06B       YES, DON'T CHECK DOUBLE RESP.     ZA15426 13592000
         CLC   ZERO(L2,ERREG4),ZERO(ERREG2)   THE EXPECTED RESPONSE     13600002
         BE    BSCSP063            YES INDICATE NORMAL COMP             13650002
         XR    ERREG2,ERREG1       FLIP TO WRONG ACK                    13700002
         CLC   ZERO(L2,ERREG4),ZERO(ERREG2)   WRONG ACK RECEIVED        13750002
         BE    BSCSP061            YES RETRANSMIT                       13800002
         CLC   ZERO(L2,ERREG4),DCBBSRVI   RVI RECEIVED                  13950002
         BE    BSCSP063            YES, BRANCH                          14000002
         CLC   ZERO(L2,ERREG4),DCBBSSAK   WAS WACK RECEIVED     YA02440 14010002
         BE    BSCSP063            YES, NORMAL COMP             YA02440 14020002
BSCSP06B EQU   *                                               @ZA15426 14025000
         CLI   L5(CCWREG),RDTEXT     READ TEXT ?               @ZA07651 14032600
         BE    BSCSP063      YES, GO TO NORMAL COMPLETION      @ZA04859 14033200
         CLI   L5(CCWREG),TPOPWRTX  READ RESPONSE CCW       LD @ZA02310 14034000
         BNE   BSCSP073            NO, CHECK RETRIES            YA02439 14040002
         CLI   L7(CCWREG),LEN20    LENGTH OF 20 INDICATES...LD @ZA02310 14040400
*                                  ...CONVERSATIONAL WRITE  LD @ZA02310 14040800
         BNE   BSCSP073            NO CHECK RETRIES         LD @ZA02310 14041200
         B     BSCSP063            SET NORMAL RETURN...     LD @ZA02310 14041600
*                                  ...DATA RECEIVED         LD @ZA02310 14041700
BSCSP06A EQU   *                                            LD @ZA02310 14041800
         SH    CCWREG,ERRCN8       BACK UP TO PREVIOUS CCW      YA02439 14042002
         CLI   L5(CCWREG),TPOPWTXT   IS IT A WRITE TEXT         YA02439 14044002
         BE    BSCSP013            YES                          YA02439 14046002
         CLI   L5(CCWREG),TPOPWDLE   WRITE DLE ETX              YA02439 14048002
         BNE   BSCSP073            NO, CHECK RETRIES            YA02439 14048402
         SH    CCWREG,ERRCN8       BACK UP TO WRITE TEXT        YA02439 14048802
BSCSP013 EQU   *                                                YA02439 14049202
         ST    CCWREG,IOBSTART     SET RESTART ADDR             YA02439 14049602
         B     BSCSP073            NO RETRY WRITE ENQ                   14050002
BSCSP01  CLC   IOBWORK+L2(L1),DCBBSENQ   WAS AN ENQ RECEIVED   @ZA04665 14100000
         BNE   BSCSP073            NO RETRY RD ENQ                      14150002
         CLI   IOBCPA,CCWAPOLL     THIS AUTO POLL                       14200002
         BNE   BSCSP07             NO RESTART FAIL CCW                  14250002
         IC    ERREG5,IOBSNDPT     ACK OFFSET                           14300002
         LA    CCWREG,DCBBSAK0(ERREG5)   LAST GOOD ACK                  14350002
         LA    ERREG1,L2           SET UP COUNT FOR CCW                 14400002
         B     BSCSP074            SET UP RETRY                         14450002
BSCSP02  EQU   *                                                YA03249 14500000
         TM    IOBCSW+L3,X02       UNIT CHECK                   YA03249 14550000
         BO    UNITCHEK            YES                          YA03249 14560000
         CLI   DECTYPE+1,READTI    READ INITIAL                @ZA03971 14562000
         BNE   BSCSP02A                                        @ZA03971 14564000
         CLI   IOBCPA,AUTOPOLL      IS,IT AUTOPOLL?            @ZA03971 14564600
         BNE   BSCSP02A                                        @ZA03971 14565200
         L     ERRLNK,ZERO(CCWREG) GET DATA AREA ADDRESS       @ZA06381 14565300
         LA    ERRLNK,ZERO(ERRLNK)  CLEAR UNUSED BYTE          @ZA06381 14565400
         CLC   ZERO(L1,ERRLNK),DCBBSEOT WAS FIRST CHAR AN EOT  @ZA12156 14565500
         BE    READINIT            YES RESTART POLLING         @ZA06381 14565600
BSCSP02B EQU   *                                               @AZ03971 14566000
         NI    IOBFLAG1,L255-IOBERRTN-IOBIOERR   NO ERROR       YA03249 14570000
         NI    IOSFLA,L255-IOSEX-IOSERR   ALSO IN IOSB          YA03249 14580000
         B     BSCSP075            EXIT                         YA03249 14580700
BSCSP02A EQU   *                                               @ZA03971 14581400
         CLI   IOBWORK+3,CON9B       SPEC SPEC RETURN?         @ZA32428 14582100
         BNE   NOSPEC                NO! BRANCH                @ZA32428 14582800
         MVI   IOBWORK+3,ZERO        CLEAR SPEC SPEC RETURN    @ZA32428 14583500
         ST    CCWREG,IOBERCCW+8     SET TIC ADDR              @ZA32428 14584200
         L     CCWREG,0(CCWREG)      GET ADDR OF TEXT          @ZA32428 14584900
         CLC   0(1,CCWREG),DCBBSENQ  READ ENQ?                 @ZA32428 14585600
         BNE   BSCSP063              NO! POST NORMAL           @ZA32428 14586300
         LA    CCWREG,IOBERCCW       GET ERP CH PGM ADDR       @ZA32428 14587000
         ST    CCWREG,IOBSTART       SET IOBSTART              @ZA32428 14587700
         LA    CCWREG,DCBBSNAK       GET NAK POINTER           @ZA32428 14588400
         B     BSCSP03A              COMP WRT NAK & TIC TO RD  @ZA32428 14589100
NOSPEC   TM    IOBERINF+L8,LSTDATA   LOST DATA?                @ZA32428 14590400
         BO    BSCSP021              YES, CHECK FOR ENQ        @ZA03971 14590600
         TM    IOBERINF+L8,DATACHK   DATA CHECK ?              @ZA03970 14590800
         BO    BSCSP02B              YES, RESET ERP IN CONTROL @ZA03970 14591000
         B     BSCSP021              NO, CHECK FOR ENQ         @ZA03970 14591200
UNITCHEK EQU   *                                                YA03249 14592000
         TM    IOBSENS0,TIMEOUT    TIME OUT ERROR               YA03249 14594000
         BZ    BSCSP073            NO,RETRY WRITE NAK           YA03249 14596000
         CLI   DECTYPE+L1,READTI   READ INITIAL                 YA03249 14596200
         BNE   BSCSP073            NO, RETRY                    YA03249 14596400
* 2 LINES DELETED                                              @ZA12146 14596500
         CLC   IOBCSW+L5(L2),L6(CCWREG) DOES RES. CNT=ORG CNT  @ZA11037 14597000
         BE    READINIT           YES GO BACK TO POLLING       @ZA11037 14597200
         L     ERREG2,ZERO(CCWREG)  GET DATA AREA ADDRESS      @ZA07640 14598700
         LA    ERREG2,ZERO(ERREG2)   CLEAR HIGH BYTE           @ZA07640 14598800
         CLI   ZERO(ERREG2),L1     IS IT AN SOH                @ZA12146 14598900
         BE    BSCSP073          YES, RETRY WRITE NAK          @ZA12146 14599000
READINIT LA    ERREG2,IOBCPA       POINT TO START OF CCWS       YA03249 14599200
         ST    ERREG2,IOBSTART     RETRY FROM START             YA03249 14599600
         MVI   IOBRCVPT,X02        INITIALIZE RCV PTR       LD @ZA02309 14603003
         MVI   IOBSNDPT,ZERO       INITIALIZE SND PTR       LD @ZA02309 14605003
         LA    ERREG2,IOBCPA+L24   POINT TO CCW 4               YA03249 14606400
         CLI   L5(ERREG2),READINDX   READ INDEX                 YA03249 14609800
         BE    FOUNDIDX            YES                          YA03249 14613200
         LA    ERREG2,L24(ERREG2)   NOT READINDX, IS WRAP LIST  YA03249 14616600
FOUNDIDX EQU   *                                                YA03249 14628600
         L     CCWREG,ZERO(ERREG2)   LOAD AREA ADDRESS          YA03249 14630600
         LA    CCWREG,L2(CCWREG)   ADD 2                        YA03249 14632600
         ST    CCWREG,L8(ERREG2)   STORE IN READ TEXT           YA03249 14633000
         MVI   L8(ERREG2),CCWREAD   RESTORE COMMAND CODE        YA03249 14633100
         LH    CCWREG,DECLNGTH     GET LENGTH                   YA03249 14633200
         BCTR  CCWREG,ZERO         REDUCE                       YA03249 14638800
         BCTR  CCWREG,ZERO         BY TWO                       YA03249 14640800
         STH   CCWREG,L14(ERREG2)   PUT COUNT IN READ TEXT      YA03249 14642800
*  *****     LINES 146432-146443 DELETED BY ZA02833  *****  L5 @ZA02833 14652800
         NI    IOSFLA,L255-IOSEX-IOSERR  SET NRM COMP IN IOSB  @ZA04679 14653700
         NI    IOBFLAG1,L255-IOBERRTN-IOBIOERR  ALSO IN IOB    @ZA04679 14654600
         MVI   IOBERRCT+L1,ZERO      SET NORMAL RETURN         @ZA04679 14655500
         MVI   IOBWORK+L1,SPFLAG    SET SPECIAL FLAG FOR 19MB  @ZA04679 14656400
         B     RETRY                EXIT                       @ZA04679 14658200
BSCSP021 EQU   *                                            LD @ZA02308 14659200
         CLI   IOBWORK+L3,CON9A        SPEC. IND SET?          @ZA17702 14660200
         BNE   BSCSP02C                NO, CHECK ENQ RECEIVED  @ZA17702 14661200
         L     ERREG2,L0(CCWREG)       GET DATA ADDR.          @ZA17702 14662200
         MVI   IOBWORK+L3,ZERO         CLEAR INDICATOR         @ZA24635 14663200
         ST    CCWREG,IOBERCCW+L8      RESTORE TIC ADDRESS     @ZA24635 14664200
         CLC   L0(L1,ERREG2),DCBBSENQ  IS IT AN ENQ?           @ZA17702 14665200
         BE    BSCSP02D                YES, SET UP NAK         @ZA17702 14666200
         TM    IOBSENS0,DATACHK+OVERRUN  DATACHK OR OVERRUN?   @ZA31718 14667000
         BNZ   BSCSP02D                YES! SET UP NAK         @ZA31718 14667800
         B     BSCSP063                                        @ZA17702 14669600
BSCSP02C CLC   IOBWORK+L2(L1),DCBBSENQ ENQ RECEIVED            @ZA17702 14670200
         BNE   BSCSP073            NO,RETRY READ ENQ        LD @ZA02308 14670603
BSCSP02D LA    CCWREG,DCBBSNAK     ADDRESS OF NAK CHARACTER LD @ZA17702 14672200
         CLI   DECTYPE+1,READTRV   READ INTERRUPT??            @ZA32980 14673200
         BE    SPEC9B              YES BRANCH                  @ZA32980 14674200
         CLI   DECTYPE+1,READTT    READ TT?                    @ZA32428 14675200
         BNE   BSCSP03A            NO BRANCH                   @ZA32428 14676200
SPEC9B   MVI   IOBWORK+3,CON9B     SET SPEC SPEC RETURN        @ZA32980 14677200
         LA    CCWREG,IOBCPA       PTR TO RDTT CH PGM          @ZA32428 14678200
         ST    CCWREG,IOBSTART     SET IOBSTART                @ZA32428 14679200
         B     RETRY               RETRY RDTT                  @ZA32428 14680200
****     THIS STATEMENT REMOVED BY APAR @ZA32428               @ZA32428 14686100
BSCSP03  LA    CCWREG,DCBBSENQ     ADDRESS OF ENQ CHARACTER             14700002
BSCSP03A LA    ERREG1,L1           SET UP COUNT FOR CCW                 14750002
         B     BSCSP074            COMPLETE WRITE OPERATION             14800002
BSCSP04  EQU   *                                                        14850002
         CLI   DECTYPE+L1,WRITTQ   IS THIS A WRITE ENQUIRY              14950002
         BE    BSCSP076            YES, RETRY WRITE ENQ                 15000002
         CLC   IOBWORK+L2(L1),DCBBSENQ   WAS ENQ RECEIVED      @ZA04665 15100000
         BE    BSCSP045                                                 15150002
         CLI   DECTYPE+L1,WRTCONN   IS THIS A WRITE CONNECT             15200002
         BNE   BSCSP07             NO, CONTINUE                         15250002
         OI    IOBERCCW+L4,SKIP    SET UP READ SKIP                     15350002
         MVC   IOBERCCW+L6(L2),SKIPCNT   TO CLEAR THE LINE              15400002
         B     BSCSP072                                                 15500002
BSCSP045 EQU   *                                                        15550002
         MVI   IOBWORK+L1,INITCONS   SET UP TO CHECK WRT INIT           15600002
         XC    IOBWORK+L1(L1),DECTYPE+L1   CHECK VALUE                  15650002
         TM    IOBWORK+L1,MASK15   THIS WRITE INITIAL OPERATION         15700002
         BM    BSCSP042            NO SET SNO                           15750002
         B     BSCSP041            YES CHECK POINT TO POINT             15800002
BSCSP042 OI    DECERRST,DECSNO     INDICATE SNO                         15850002
         MVI   IOBERRCT,ERRMAXCT   SET RETRY COUNT TO MAX               15900002
BSCSP043 LA    NAMEREG,ERLOD25     ADDRESS OF ERROR POST                15950002
         MVI   IOBERRCT+L1,ZERO                                         16000002
         MVI   IOBWORK+L1,ZERO                                          16050002
XCTLOUT  EQU   *                                                        16100002
         L     ERRETR,CVTPTR       POINT TO CVT                         16150002
         USING CVTMAP,ERRETR                                            16200002
         L     ERRETR,CVTXTLER     POINT TO XCTL ROUTINE                16250002
         DROP  ERRETR                                                   16300002
         BR    ERRETR              XCTL                                 16350002
BSCSP041 TM    UCBTYPE+L1(UCBREG),NOTPTPT   AUTO-CALL,ANSR,POLL         16400002
         BNZ   BSCSP042            YES SET SNO                          16450002
BSCSP048 EQU   *                                                        16500002
         TM    DCBXCODE,DCBMASTA   THIS THE MASTER STATION              16550002
         BZ    BSCSP044            YES RESTART CHAN PROGRAM             16600002
BSCSP046 OI    DECFLAGS,SLVCONT    INDICATE CONTENTION                  16650002
BSCSP047 NI    IOSFLA,L255-IOSERR   INDICATE ERROR POST                 16700002
         NI    IOBFLAG1,L255-IOBERRTN   ALSO IN IOB                     16750002
         MVC   IOBCSW(L7),IOBERCCW+L17   RESTORE FAILURE DATA           16800002
         B     BSCSP075            EXIT VIA IOS                         16900002
BSCSP044 LA    CCWREG,IOBCPA       SET TO RESTART CHAN PROGRAM          16950002
         B     BSCSP078            COMPLETE OPERATION                   17000002
BSCSP061 EQU   *                                                        17050002
         TM    DCBBFTEK,DYNBUF     THIS DYNAMIC BUFFERING               17100002
         BO    BSCSP043            YES POST WITH ERROR                  17150002
         TM    IOBERCCW+L16,IOBTO   DID THIS WRONG ACK OCCUR IN         17200002
*                                  TIME OUT SITUATION                   17250002
         BNO   BSCSP073            NO, RESEND THE ENQ                   17300002
         B     BSCSP065                                                 17350002
BSCSP063 NI    IOSFLA,L255-IOSEX-IOSERR   INDICATE NORMAL COMPLETION    17400002
         NI    IOBFLAG1,L255-IOBERRTN-IOBIOERR   ALSO IN IOB            17450002
         B     BSCSP075            SET NORMAL RETURN                    17500002
BSCSP066 LH    ERREG4,IOBCSW+L5    GET RESIDUAL COUNT                   17550002
         LA    ERREG4,L1(ERREG4)   ADD ONE                              17600002
         CH    ERREG4,L6(CCWREG)   EQUAL TO ORIGINAL                    17650002
         BL    BSCSP043            MORE THAN ONE CHARACTER              17700002
         TM    DCBBFTEK,DYNBUF     THIS DYNAMIC BUFFERING               17750002
         BO    BSCSP043            YES POST WITH ERROR                  17800002
BSCSP065 EQU   *                                                        17850002
         LA    ERRLNK,IOBCPA       START OF CHANNEL PROGRAM             17900002
         CR    ERRLNK,CCWREG       COMPARE TO CCW ADDRESS               17950002
         BE    BSCSP071            IF EQUAL, RESTART CHAN PROG          18000002
         SH    CCWREG,ERRCN8       BACK UP ONE CCW                      18050002
         CLI   L5(CCWREG),TPOPDTXT   THIS TEXT TRANSFER                 18100002
         BNE   BSCSP065            NO BACK UP ANOTHER CCW               18150002
         B     BSCSP071            SET TO RESTART CHAN PROG             18200002
BSCSP0B  EQU   *                                                        18250002
         TM    IOBCSW+L3,X02       UNIT CHECK                           18300002
         BNZ   BSCSP073            YES, SEND NAK AGAIN                  18350002
         L     ERREG2,ZERO(CCWREG)   ENQ POINTER                        18400002
         TM    IOBCSW+L3,X01       UNIT EXCEPTION                       18450002
         BZ    BSCSP0B1                                                 18500002
         CLC   ZERO(L1,ERREG2),DCBBSEOT   EOT RECEIVED                  18550002
         BE    BSCSP063            YES, POST                            18600002
         B     BSCSP073            NO, RETRY                            18650002
BSCSP0B1 EQU   *                                                        18700002
         CLC   ZERO(L1,ERREG2),DCBBSENQ   ENQ RECD                      18750002
         BE    BSCSP073            YES, SEND NAK AGAIN                  18800002
         B     BSCSP063            OTHERWISE POST                       18850002
BSCSP07  L     CCWREG,IOBERCCW+L8   ADDRESS OF FAILING CCW              18900002
BSCSP071 ST    CCWREG,IOBSTART     STORE IN START PTR                   18950002
         B     BSCSP075            COMPLETE CHAN PROGRAM                19050002
BSCSP077 L     ERREG2,L8(CCWREG)   GET DATA ADDRESS OF READ CCW         19100002
         MVC   ZERO(L2,ERREG2),IOBWORK+L2   MOVE DLE-EOT TO USERS AREA  19150002
         B     BSCSP047                                                 19200002
BSCSP076 L     CCWREG,IOBERCCW+L8   ADDRESS OF FAILING CCW              19250002
         CLC   IOBWORK+L2(L1),DCBBSENQ   WAS ENQ RECEIVED      @ZA04665 19300000
         BE    BSCSP048            YES, CHECK CONTENTION                19350002
         CLC   IOBWORK+L2(L2),DCBBSDLE   DLE-EOT RECEIVED               19400002
         BE    BSCSP077            YES, POST DISCONNECT SEQUENCE        19450002
BSCSP078 EQU   *                                                        19500002
         ST    CCWREG,IOBSTART     STORE CHAN PROG ADDRESS              19550002
BSCSP072 MVI   IOBERRCT+L1,ZERO    SET NORMAL RETURN                    19650002
         MVI   IOBWORK+L1,ZERO     CLEAR RETURN CODE                    19700002
BSCSP073 CLI   IOBERRCT,ERRMAXCT   CHECK RETRIES                        19750002
         BNL   BSCSP043            NONE LEFT                            19800002
         IC    ERREG1,IOBERRCT     PICK UP COUNT                        19850002
         LA    ERREG1,L1(ERREG1)   BUMP ONCE                            19900002
         STC   ERREG1,IOBERRCT     RESTORE                              19950002
         MVI   IOBSENS0,ZERO       CLEAR SENSE BYTE                     20000002
         B     RETRY               RETRY EXCP                           20050002
BSCSP074 ST    CCWREG,IOBERCCW     NEW DATA ADDRESS                     20100002
         STH   ERREG1,IOBERCCW+L6   SET COUNT                           20200002
         MVI   IOBERCCW,CCWWRITE   SET WRITE COMMAND                    20250002
         MVI   IOBERCCW+L8,CCWTIC   PUT TIC IN SECOND COMMANE           20300002
BSCSP075 MVI   IOBERRCT+L1,ZERO    SET NORM RETURN                      20400002
         MVI   IOBWORK+L1,ZERO     CLEAR RETURN CODE                    20450002
RETRY    MVI   EWAIND1,EWAISVCF    SVC 15                      @ZA12156 20500000
         L     NAMEREG,TRANSRTN    LOAD NAME                            23250002
         B     XCTLOUT             XCTL                                 23300002
         EJECT                                                          24100002
**********                                                              24150002
*                                                                       24200002
*        CONSTANTS                                                      24250002
*                                                                       24300002
**********                                                              24350002
TRANSRTN DC    F'9042'             NAME OF BTAM TRANSLATE ROUTINE       24400002
ERRCN2   DC    H'2'                                                     24450002
ERRCN8   DC    H'8'                                                     24500002
SKIPCNT  DC    X'5FFF'                                                  24550002
UNITEXCP DC    X'0D00'             CE,DE, UNIT EXECPTION STAT  @ZA04185 24570000
PACHAREA DC    30C'0000'           PATCH AREA FOR MAINTENANCE           24600000
**********                                                              24650002
*                                                                       24700002
*        MISCELLANEOUS EQUATES                                          24750002
*                                                                       24800002
**********                                                              24850002
TIMEOUT  EQU   X'01'               TIME OUT SENSE               YA03249 24900000
AUTOPOLL EQU   X'09'               CCMD FOR AUTOPOLL           @ZA03971 24905000
READTI   EQU   X'01'               READ INITIAL                 YA03249 24910000
READINDX EQU   X'0A'               READ INDEX                   YA03249 24920000
NONABT   EQU   X'FE'               MASK OFF ABORT SEQUENCE              24950002
SKIP     EQU   X'10'                                                    25000002
TOERROR  EQU   3                                                        25050002
L255     EQU   X'FF'               AND MASK                             25100002
ZERO     EQU   X'00'               LENGTH AND DISPLACEMENT              25150002
L0       EQU   0                                               @ZA04185 25170000
L1       EQU   1                   LENGTH AND DISPLACEMENT              25200002
L2       EQU   2                   LENGTH AND DISPLACEMENT              25250002
L3       EQU   3                   LENGTH AND DISPLACEMENT              25300002
L4       EQU   4                   LENGTH AND DISPLACEMENT              25350002
L5       EQU   5                   LENGTH AND DISPLACEMENT              25400002
L6       EQU   6                   LENGTH AND DISPLACEMENT              25450002
L7       EQU   7                   LENGTH AND DISPLACEMENT              25500002
L8       EQU   8                   LENGTH AND DISPLACEMENT              25550002
L9       EQU   9                   LENGTH AND DISPLACEMENT              25600002
L12      EQU   12                  LENGTH AND DISPLACEMENT              25650002
L14      EQU   14                  LENGTH AND DISPLACEMENT              25700002
L15      EQU   15                  LENGTH AND DISPLACEMENT              25750002
L16      EQU   16                  LENGTH AND DISPLACEMENT              25800002
L17      EQU   17                  LENGTH AND DISPLACEMENT              25850002
L22      EQU   22                  LENGTH AND DISPLACEMENT              25900002
L24      EQU   24                  LENGTH AND DISPLACEMENT      YA03249 25910000
X01      EQU   X'01'                                                    25950002
X02      EQU   X'02'                                                    26000002
X03      EQU   X'03'                                                    26050002
X04      EQU   X'04'                                                    26100002
X80      EQU   X'80'                                                    26150002
SPFLAG   EQU   X'9F'     SPECIAL FLAG FOR IOB WORK             @ZA04679 26220000
UCBTYPE  EQU   16                                                       26300002
TPOPDTXT EQU   X'11'                                                    26350002
HIGHBIT0 EQU   X'80'                                                    26400002
DYNBUF   EQU   X'08'                                                    26450002
CCWAPOLL EQU   9                                                        26500002
IOBTO    EQU   1                   TIME OUT                             26550002
INITCONS EQU   X'0D'                                                    26600002
MASK15   EQU   X'0F'                                                    26650002
WRTCONN  EQU   X'1C'                                                    26700002
WRITTQ   EQU   X'16'                                                    26750002
READTRV  EQU   X'1B'             READ INTERRUPT                @ZA32980 26760000
READTT   EQU   X'03'             READ CONTINUE                 @ZA32428 26770000
CON9B    EQU   X'9B'             SPEC SPEC RETURN FOR 504C     @ZA32428 26780000
TPCODE   EQU   5                                                        26800002
DECSNO   EQU   X'40'                                                    26850002
ERLOD25  EQU   2043                                                     26900002
ERRMAXCT EQU   7                                                        26950002
LSTDATA  EQU   X'02'      LOST DATA SENSE BYTE                 @ZA03971 27000000
DATACHK  EQU   X'08'      DATA CHECK SENSE BYTE                @ZA03970 27050000
OVERRUN  EQU   X'04'      OVERRUN SENSE BYTE                   @ZA31718 27070000
SLVCONT  EQU   X'10'                                                    27150002
NOTPTPT  EQU   X'D0'                                                    27200002
DCBMASTA EQU   X'80'                                                    27250002
CCWWRITE EQU   X'01'                                                    27300002
FLIPBIT  EQU   X'02'                                                    27350002
CCWTIC   EQU   X'08'                                                    27400002
UERDSKP  EQU   X'07'                                                    27450002
CODEA    EQU   X'0A'                                                    27500002
CSWUE    EQU   X'01'                                                    27550002
CCWREAD  EQU   X'02'                                                    27600002
CCWFLAG1 EQU   X'30'                                                    27650002
CCWFLAG2 EQU   X'70'                                                    27700002
RTRNCDEA EQU   X'8A'                                                    27750002
TPRESET  EQU   X'21'                                                    27800002
TPOPWTXT EQU   X'11'               WRITE TEXT                   YA02439 27802002
TPOPWDLE EQU   X'13'               WRITE DLE ETX                YA02439 27804002
TPOPWRTX EQU   X'25'               READ RESP TO TEXT            YA02438 27810002
RDTEXT   EQU   X'91'     READ TEXT TP CODE (LAST ONE)          @ZA04859 27811000
LEN20    EQU   X'14'               LENGTH OF READ RESP...   LD @ZA02310 27812000
*                                  ...CCW FOR CONVERSATINAL LD @ZA02310 27814000
*                                  ...MODE.                 LD @ZA02310 27818000
RTNCD86  EQU   X'86'               RETURN CODE OF 86            YA02438 27820002
DEVICE   EQU   X'55'                                           @ZA04861 27827000
UNITCK   EQU   X'02'               UNIT CHECK STATUS           @ZA04185 27834000
EOTCHAR  EQU   X'37'               EOT CHECK                   @ZA06381 27841000
CON9A    EQU   X'9A'               SPECIAL CODE                @ZA17702 27845000
**********                                                              27850002
*                                                                       27900002
*        REGISTER DEFINITION                                            27950002
*                                                                       28000002
**********                                                              28050002
ERREG3   EQU   0                   WORK REG                             28100002
IOSBREG  EQU   1                   IOSB BASE/PARAMETER REG              28150002
ERREG2   EQU   2                   WORK REG                             28200002
EWAREG   EQU   3                   ERP WORKAREA BASE                    28250002
CCWREG   EQU   4                   CCW ADDRESS REG                      28300002
DECBRG   EQU   5                   DECB BASE                            28350002
DCBREG   EQU   6                   DCB BASE                             28400002
UCBREG   EQU   7                   UCB BASE                             28450002
BASEREG  EQU   8                   PROGRAM BASE                         28500002
ERREG1   EQU   9                   WORK REG                             28550002
IOBRG    EQU   10                  IOB BASE                             28600002
ERREG4   EQU   11                  WORK REG                             28650002
ERRLNK   EQU   12                  LINK REG                             28700002
NAMEREG  EQU   13                  LINK REG                             28750002
ERRETR   EQU   14                  LINK REG                             28800002
ERREG5   EQU   15                  LINK REG/WORK REG                    28850002
         EJECT                                                          28900002
         IECTDECB                                                       28950002
         EJECT                                                          29000002
         DCBD  DSORG=BX,DEVD=BS                                         29050002
         EJECT                                                          29100002
         IECDRQE                                                        29150002
         EJECT                                                          29200002
         IEZIOB                                                         29250002
         EJECT                                                          29300002
CVT      DSECT                                                          29350002
         CVT                                                            29400002
         EJECT                                                          29450002
         IECDERWA                                                       29500002
**********                                                              29550002
*                                                                       29600002
*        THE FOLLOWING DEFINITIONS ARE LOCAL FOR BTAM ERPS ONLY.        29650002
*                                                                       29700002
**********                                                              29750002
         ORG   EWAIERP                                                  29800002
EWAITRAN DS    F                   ADDRESS OF IECVTCCW         YM02594K 29850002
EWAITCCW DS    F                   PARALLEL TCCW               YM02594K 29900002
EWAIOVST DS    F                   ORIGINAL IOSVST CONTENTS    YM02594K 29950002
EWAIND0  DS    B                   FLAG BYTE                            30000002
EWAIVISR EQU   X'10'               V=R REQUEST                          30600002
EWAIPMAP EQU   X'08'               PARALLEL MAPPING DONE       YM02594K 30650002
EWAIGPRO EQU   X'04'               GETMAIN IN PROCESS          YM02594K 30700002
EWAIFPRO EQU   X'02'               FREEMAIN IN PROCESS         YM02594K 30750002
EWAIND1  DS    B                   FLAG BYTE                            30800002
EWAILD00 EQU   X'80'               EXIT TO 004C                YM02594K 30850002
EWAILD15 EQU   X'40'               EXIT TO LOAD 15             YM02594K 30900002
EWAIWTOL EQU   X'20'               EXIT TO IOS WTO             YM02594K 30950002
EWAISTAT EQU   X'10'               EXIT TO STAT UPDATE         YM05652K 30960002
EWAISVCF EQU   X'08'               SVC 15                      YM05652K 30970002
EWAIND2  DS    B                   FLAG BYTE                            31000002
EWAIND3  DS    B                   FLAG BYTE                            31050002
EWAIAREA DS    20F                 SAVE AREA FOR MA OR AREA FOR WTO     31100002
EWAISAVE DS    2F                  TEMPORARY SAVE AREA                  31150002
EWAIEXIT DS    4F                  ESATE PARAMETER LIST                 31200002
*********  END OF BTAM LOCAL DEFINITIONS **********                     31250002
         EJECT                                                          31900002
         IECDIOSB                                                       31950002
         END                                                            32000002
