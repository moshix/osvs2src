504G TITLE 'IGE0504G ERROR POST AND ERP CCW RETURN'                     00200020
IGE0504G CSECT                                                          00400020
*A-000000-999999                                               @Y02X6E0 00400308
*A274000,352600,714000                                           S22025 00400722
*C195500,238000-240000,274000,275200,348900,502000,662000-668000 S22025 00401422
*C672000                                                         S22025 00401722
*D320000-332000                                                  S22025 00402122
*A194000,196000                                                  CLUP21 00403021
*A372000,380000                                                  A42420 00406021
*A206000,694000,720000                                           S21101 00410021
*C348000-366200                                                  S21101 00420021
*C630000                                                        SA58994 00510022
*A284000,288000,310000,392000,608000,673000,730000              SA65392 00510152
*C213000-216000,252000-254000,274700-274800,275600-275760       SA65392 00510252
*C316000,460000,472000,544000,586000-588000                     SA65392 00510352
*D194500,292000-300000,430000,664000,670000-672000,676000       SA65392 00510452
*D682000,702000,712000                                          SA65392 00510552
*A 042600-043200,259000,262070-263890,673300,714100-714900       X01004 00510606
*C 275680,302000-306000,630000                                   X01004 00510706
*D 275760                                                        X01004 00510806
*D646000                                                       SA66363  00511505
*C017200,198000,438000                                         @Z30AAEE 00511608
*D698000                                                       @Z30AAEE 00511708
*A392500,602000                                                @SA70291 00513561
*C392600-392950,393050-393400,393600-393900                    @SA70291 00515561
*D284300                                                       @SA70291 00517561
*A372000,734000                                                @XA03955 00517661
*A392000                                                       @XA05319 00517761
*C402000                                                       @XA05319 00517861
*C392520,392800,393250                                         @SA73187 00517961
*A644000                                                       @OY11534 00518081
*D602300-603500                                                @YA10246 00537909
*C393600                                                       @SA75445 00557909
*A630000                                                       @ZA06642 00577909
*C582000,C586000,A673400                                       @OX13491 00578091
*C582000,C608000,C642000-646000,A648000                        @OX14080 00578191
*A628000                                                       @OZ16799 00578291
*C392450,A392500,C642000-643000,C648000-649600,A728000         @OX16393 00578391
*A392500,C643200,C644000-645000,C648000,A729200                @OZ24288 00578491
*A602000                                                       @OZ30194 00578586
*C602080,602720,603200-603520                                  @OZ32827 00578686
*                                                                     * 00600020
*********************************************************************** 00800020
*                                                                     * 01000020
*TITLE -- 'IGE0504G',START/STOP ERP CCW RETURN AND ERROR POST.        * 01200020
*                                                                     * 01400020
*  MODULE NAME = IGE0504G                                             * 01600006
*                                                                     * 01620005
*  DESCRIPTIVE NAME = START-STOP ERP CCW RETURN AND POST              * 01640005
*                                                                     * 01660005
*  COPYRIGHT = 'NONE'                                                 * 01680005
*                                                                     * 01700005
*  STATUS: CHANGE LEVEL 8                                      @Z30AAEE 01720008
*                                                                     * 01800020
*FUNCTION -- TO ATTEMPT RETRY AFTER INTERMEDIATE ERP ACTION AND TO    * 02000020
*   INTERFACE WITH THE OS MESSAGE WRITER AND OBR/SDR.                 * 02200020
*                                                                     * 02400020
*ENTRY POINTS -- FIRST EXECUTABLE INSTRUCTION.                        * 02600020
*                                                                     * 02800020
*INPUT --                                                             * 03000020
*   R1 - POINTER TO I/O SUPERVISOR BLOCK                         Y02027 03200006
*   R15 - ENTRY POINT ADDRESS                                         * 03400020
*                                                                     * 03600020
*OUTPUT -- R1 POINTS TO I/O SUPERVISOR BLOCK                     Y02027 03800006
*                                                                     * 04000020
*EXTERNAL ROUTINES - 'IEDQTNT' - TO OBTAIN TERMINAL ENTRY ADDRESS     * 04200020
*                  - 'IGG019QE' - TO CONVERT VIRTUAL CCW ADDRESSES TO * 04260006
*   REAL BEFORE RETRY.                                                * 04320006
*                                                                     * 04400020
*EXITS-NORMAL -- R1 POINTS TO I/O SUPERVISOR BLOCK               Y02027 04600006
*        SVC   15   'ERP IN CONTROL (IOSERR)' AND 'EXCEPTIONAL   Y02027 04700006
*                CONDITION(IOSEX)'. RETURN TO IOS TO RETRY THE   Y02027 04800006
*                   ERROR.                                       Y02027 04900006
*        SVC   3                                                      * 05000020
*                                                                     * 05200020
*        SVC   15   'NO ERROR FLAGS'. RETURN TO LINE END         Y02027 05400006
*                   APPENDAGE. ERROR CLEARED                     Y02027 05500006
*        SVC   3                                                      * 05600020
*                                                                     * 05800020
*   TO SCHEDULE NEXT LOAD OF ERP                                      * 06000020
*        L     13,DECIMAL VALUE OF NEXT LOAD                          * 06200020
*        L   14,X'10'    CVT ADDRESS                                  * 06400020
*        L     14,X'2C'(14)    ADDRESS OF XCTL ROUTINE                * 06600020
*        BR    14   EXIT TO XCTL                                      * 06800020
*                                                                     * 07000020
*EXITS-ERROR -- R1 POINTS TO I/O SUPERVISOR BLOCK                Y02027 07200006
*        SVC   15   'EXCEPTIONAL CONDITION(IOSEX)'. RETURN TO    Y02027 07260006
*                   LINE END APPENDAGE. ERROR PERMANENT.         Y02027 07320006
*        SVC   15  LCBFLAG1 X'C6'                                     * 07400020
*        SVC   3                                                      * 07600020
*                                                                     * 07800020
*        L     13,DECIMAL VALUE OF NEXT LOAD                          * 08000020
*        L   14,X'10'    CVT ADDRESS                                  * 08200020
*        L     14,X'2C'(14)    ADDRESS OF XCTL ROUTINE                * 08400020
*        BR    14   EXIT TO XCTL                                      * 08600020
*                                                                     * 08800020
*   TO SCHEDULE ERROR POST                                            * 09000020
*                                                                     * 09200020
*TABLES/WORK AREAS --                                                 * 09400020
*   TAVTD                                                             * 09600020
*   TTRMD                                                             * 09800020
*   TCCWD                                                             * 10000020
*   TLCBD                                                             * 10200020
*   DCBD                                                              * 10400020
*   TSCBD                                                             * 10600020
*   IECDIOSB                                                     Y02027 10700006
*                                                                     * 10800020
*ATTRIBUTES -- SERIALLY REUSABLE, REFRESHABLE, SUPERVISOR KEY,   Y02027 11000006
*              SUPERVISOR MODE, ENABLED                          Y02027 11100006
*                                                                     * 11200020
*NOTES -- THE OPERATION OF THIS MODULE DOES NOT DEPEND UPON A         * 11400020
*   PARTICUALR INTERNAL REPRESENTATION OF THE EXTERNAL CHARACTER      * 11600020
*   SET.                                                              * 11800020
*                                                                     * 12000020
*   R1 REMAINS TRANSPARENT TO ALL LOADS OF ERP.                       * 12200020
*                                                                     * 12400020
*   IF OPERATOR CONTROL IS IN USE, THE OS MESSAGE WRITER IS BYPASSED. * 12600020
*                                                                     * 12800020
*   CERTAIN PERMANENT ERRORS ARE NOT RECORDED TO PREVENT OVERFLOW OF  * 13000020
*   SYS1.LOGREC.                                                      * 13200020
*                                                                     * 13400020
*   PARAMETERS PASSED TO OBR/SDR RECORDING MODULE:                    * 13600020
*   LCBERCCW+16 - X'00' 1 BYTE INDICATES PERMANENT ERROR              * 13800020
*   LCBERCCW+20 - 1 BYTE SIZE OF TERMINAL NAME                        * 14000020
*   LCBERCCW+21 - 3 BYTES - ADDRESS OF TERMINAL NAME                  * 14200020
*   LCBERCCW+17 - 3 BYTES - ADDRESS OF TERMINAL COUNTERS              * 14400020
*                                                                     * 14600020
*********************************************************************** 14800020
         EJECT                                                          15000020
         USING IEDQLCB,RLCB                                             15200020
         USING IEDQCCW,RCCW                                             15400020
         USING IEDQAVTD,RAVT                                            15600020
         USING IEDQTRM,RTERM                                            15800020
         USING IHADCB,RDCB                                              16000020
         USING IOSB,RIOSB                                        Y02027 16060006
         USING EWA,RERPWA                                        Y02027 16120006
         USING *,R15                                                    16200020
*              REGISTERS                                                16400020
R0       EQU   0                                                        16600020
RIOSB    EQU   1                        ADDR OF I/O SUPVR BLOCK  Y02027 16800006
RLCB     EQU   2                        LCB CBASE                       17000020
RCCW     EQU   5                        CCW BASE                        17200020
RUCB     EQU   3                        UCB REGISTER                    17400020
RDCB     EQU   4                        DCB BASE                        17600020
RWKA     EQU   6                        WORK REGISTER                   17800020
RWKB     EQU   7                        WORK REGISTER                   18000020
RTST     EQU   7                        ADDR OF REQUEST QUEUE    Y02027 18060006
*                                       ELEMENT                  Y02027 18120006
RTERM    EQU   8                        TERMINAL BASE                   18200020
RWKC     EQU   9                        WORK REGISTER                   18400020
RWKD     EQU   10                       WORK REGISTER                   18600020
RAVT     EQU   11                       AAVT BASE                       18800020
RERPWA   EQU   12                       ADDR OF ERP WORK AREA    Y02027 18900006
RLINK    EQU   13                       LINKAGE FOR SUBSEQUENT LOAD     19000020
RSAVE    EQU   13                       SAVE REGISTER FOR IOSB   Y02027 19100006
RXCTL    EQU   14                       XCTL REGISTER                   19200020
R15      EQU   15                       ADDRESSABILITY REGISTER         19400020
         EJECT                                                          19600020
         L     RTST,IOSUSE              PICKUP ADDR OF RQE       Y02027 19650006
         L     RERPWA,IOSERP            PICKUP ADDR OF ERP WORK  Y02027 19700006
*                                       AREA                     Y02027 19750006
         L     RUCB,IOSUCB              ADDRESS OF UCB         @Z30AAEE 19800008
         L     RLCB,IOBOFFST(R0,RTST)   ADDRESS OF IOB                  20000020
         SH    RLCB,LCBSIZE             ADJUST BASE                     20200020
         L     RDCB,LCBDCBPT            DCB BASE                        20400020
         L     RWKB,LCBSCBA-1           CURRENT SCB                     20600020
         USING IEDQSCB,RWKB                                      S21101 20900021
         L     RXCTL,CVTPTR             CVT ADDRESS             SA65392 21200052
         L     RAVT,AVTCVTPT(RXCTL)     LOAD LIST ADDRESS       SA65392 21500052
         L     RAVT,AVTEZERO(,RAVT)     AVT BASE                        21800020
         SR    RWKA,RWKA                CLEAR INDEX RETISTER            22000020
         IC    RWKA,LCBINCAM+1          GET RETURN BYTE                 22200020
         MVI   LCBINCAM+1,0             RESET CODE               Y02027 22400006
         B     TABLE-4(RWKA)            BRANCH TO APPROPRITE ETNRY      22600020
         SPACE 2                                                        22800020
TABLE    EQU   *                                                        23000020
         B     SKIPRET                  SKIP RETURN                     23200020
         B     BRKRET                   BREAK RETURN                    23400020
         B     UNUSRET                  UNUSUAL RETURN                  23600020
         B     SNORET                   SHOULD-NOT-OCCUR RETURN  S22025 23800022
         B     PERMRET                  PERMANENT ERROR RETURN   S22025 24000022
         SPACE 2                                                        24200020
SKIPRET  EQU   *                                                        24400020
         SPACE                                                          25000020
         MVC   LCBCSW,LCBCSWSV          ORIGINAL CSW                    25060006
         MVC   LCBSENS0,LCBSNSV         ORIGINAL SENSE                  25120006
         TM    LCBCSWSV+3,UNITCHK       UNIT CHECK ORIGINAL ERROR       25200006
         BZ    TRYRETRY                 NO, IT WAS UNIT EXCEPTION       25400006
         CLI   LCBINCAM,RETRY           TEST RTRY COUNT                 25600020
         BNL   EXHAUST                  EXHAUSTED                       25800020
SETERR   EQU   *                                                        25900006
         NI    IOSFLA,AVTEFF-IOSERR     POST PERMANENT ERROR TO  Y02027 26000006
*                                       ABNORMAL END APPENDAGE   Y02027 26100006
EXIT     EQU   *                                                        26200020
*********************************************************************** 26206006
*                                                                     * 26212006
*        THE FOLLOWING CODE IS ADDED FOR AOS.                         * 26218006
*                                                                     * 26224006
         BAL   RXCTL,HIOSUB             CHECK FOR HALTIO         Y02027 26230006
         SPACE 1                                                 Y02027 26236006
         TM    IOSFLA,IOSERR+IOSEX      ARE WE DOING A RETRY     Y02027 26242006
         BNO   NOTRETRY                 BRANCH IF NO.            X01004 26248006
         LR    RSAVE,RIOSB              SAVE IOSB ADDRESS        Y02027 26254006
         L     RTST,IOSUSE              PICKUP ADDR OF RQE       Y02027 26260006
         LA    RLCB,LCBFLAG1            IOB ADDRESS TO SIO       Y02027 26266006
         SR    RTERM,RTERM              CLEAR FOR ICM.           X01004 26272006
         ICM   RTERM,7,DEBPTR(RTST)     GET DEB ADDRESS FROM RQE.X01004 26278006
         LA    R15,DEBNMSUB-IEDQDEB     GET APDG. TABLE SIZE     Y02027 26284006
         SLR   RTERM,R15                POINT TO APDG. TABLE     Y02027 26290006
         L     RTERM,SIOPTR(ZERO,RTERM) GET ADDR OF SIO APDG.    X01004 26296006
*                                       FROM APDG. VECTOR TABLE.        26302006
         SR    R15,R15                  CLEAR R15 TO TELL SIO    X01004 26308006
*                                       APDG. IT'S A SUBROUTINE.        26314006
         BAL   RXCTL,SIOENTRY(ZERO,RTERM)  LINK TO SIO APDG AT   X01004 26320006
*                                       OFFSET +16 TO CONVERT CCW'S     26326006
*                                       FROM VIRTUAL TO REAL.    X01004 26332006
         LR    RIOSB,RSAVE              RESTORE IOSB ADDR        Y02027 26338006
*                                                                     * 26344006
*        END OF CODE ADDED FOR AOS.                                   * 26350006
*                                                                     * 26356006
*********************************************************************** 26362006
NOTRETRY EQU   *                                                 X01004 26368006
         SVC   EREXCP                                                   26400020
         SVC   RETURN                                                   26600020
         SPACE 2                                                        26800020
BRKRET   EQU   *                                                        27000020
         MVC   LCBSENS1,LCBSENS0        SENSE BYTE FROM BREAK           27200020
         MVC   LCBCSW,LCBCSWSV          ORIGINAL CSW                    27260006
         MVC   LCBSENS0,LCBSNSV         ORIGINAL SENSE                  27320006
         TM    LCBTSOB,LCB2741N         2741 TERMINAL ?          S22025 27400022
         BNO   TRYRETRY                 BRANCH IF NO             S22025 27410022
         TM    LCBCSWSV+3,UNITCHK       WAS ORIGINAL ERROR A     S22025 27420022
*                                       UNIT CHK OR UNIT EXCPTN  S22025 27430022
         BZ    TRYRETRY                 BRANCH IF UNIT EXCPTN    S22025 27440022
         CLI   LCBRESTR,TPRDRESP        TEXT CCW OR RESP TO POLL S22025 27450022
         BNE   EXHAUST                  BRANCH IF TEXT           S22025 27460022
         CLI   LCBSENS1,COMREJ          TEST RETURN FROM BREAK   S22025 27480722
*                                       FOR COMMAND REJECT       S22025 27481422
         BNE   RETLEND                  BRANCH IF NOT            S22025 27482122
         TM    AVTBIT1,AVTDLAYN+AVTCLOSN  CLOSEDOWN REQUESTED ?  S22025 27482822
         BNZ   RETLEND                  BRANCH IF YES - DO NOT   S22025 27483522
*                                       RETRY READ RESPONSE      S22025 27484222
         TM    LCBSTAT1,LCBOCNI         STOPLINE PENDING ?       S22025 27484922
         BNO   RERDRSP                  BRANCH IF NO - GO RETRY  S22025 27485622
*                                       READ RESPONSE            S22025 27486322
         SPACE 1                                                        27487022
RETLEND  EQU   *                                                 S22025 27487722
         NI    IOSFLA,AVTEFF-(IOSERR+IOSEX) INDICATE ERROR IS    Y02027 27488406
*                                       CLEARED                  Y02027 27488706
*                                       END APPENDAGE            S22025 27489122
         MVI   LCBCSW+3,NORMAL          SET ENDING STATUS FOR    S22025 27490022
*                                       ORIGINAL CCW TO LOOK     S22025 27495022
*                                       LIKE NEGATIVE RESPONSE   S22025 27500022
*                                       TO POLL                  S22025 27505022
         B     EXIT                     GO RETURN TO LINE END    S22025 27520022
         SPACE 2                                                        27528022
TRYRETRY EQU   *                                                        27800020
         CLI   LCBINCAM,RETRY           RETRY LIMIT REACHED             28000020
         BE    EXHAUST                  YES                             28200020
         SPACE                                                          28400020
         IC    RWKA,LCBINCAM            RETRY COUNT                     28460052
         LA    RWKA,1(,RWKA)            BUMP                            28490052
         STC   RWKA,LCBINCAM            SAVE BACK                       28520052
RERDRSP  EQU   *                                                 S22025 28550006
         MVI   IOSSNS,AVTEZERO          CLEAR SENSE FOR RETRY    Y02027 28570006
         L     RWKA,LCBCSWSV-1          ORIGINAL CCW FROM CSW           28600020
         SH    RWKA,H8                  BACK UP TO FAILING              28800020
         ST    RWKA,LCBSTART-1          SET FOR RESTART                 29000020
         B     EXIT                     BRANCH TO SET UP FOR RETRY.     30200006
         SPACE                                                          30800020
         SPACE                                                          33400020
UNUSRET  EQU   *                                                        33600020
SNORET   EQU   *                                                        33800020
         OI    SCBERR4-IEDQSCB(RWKB),SCBUNDFN  UNDEFINED ERROR          34000020
         OI    LCBCHAIN,LCBNORTY        NO RETRY POSSIBLE               34200020
         SPACE                                                          34400020
EXHAUST  EQU   *                                                        34500006
PERMRET  EQU   *                                                        34600020
         L     RCCW,LCBCSW-1            FAILING CW                      34650020
         LA    RCCW,AVTEZERO(,RCCW)     CLEAR FOR SUBTRCT               34700020
         SH    RCCW,H8                  BACK UP TO FAILING CCW          34750020
*        THE FOLLOWING CODE TEST FOR A PERMANENT ERROR IN        S21101 34760021
* ATTEMPTING TO SELECT A BUFFERED TERMINAL FOR A RECEIVE         S21101 34770021
* OPERATION.  IF WE ARE ATTEMTPING TO RECEIVE ANOTHER PART OF    S21101 34780021
* THE MESSAGE THE HEADER BUFFER IS CONVERTED TO TEXT AND ANEOT   S21101 34790021
* IS INSERTED IN THE BUFFER.  LINE END WILL POST IT TO MH AS A   S21101 34800021
* PERMANENT TEXT ERROR WITH NO RETRY.  THIS WILL FORMALLY END    S21101 34810021
* THE MESSAGE ON THE QUEUE.                                      S21101 34820021
         CLI   LCBRSKEY,BUFF            BUFFERED LINE            S21101 34830021
         BNE   NOTBFRD                  BRANCH NO                S21101 34840021
         TM    LCBSTAT1,LCBRECVN        RECEIVE SIDE             S21101 34850021
         BZ    NOTBFRD                  NO                       S21101 34860021
         SPACE 1                                                 S21101 34870021
         CLI   LCBRESTR,TPRDSKIP        TEXT RELATED             S21101 34880021
         BNL   NOTBFRD                  BRANCH TEXT RELATED      S22025 34890022
         SPACE 1                                                 S21101 34900021
         TM    SCBQTYPE,SCBBFMM         MIDDLE OF MESSAGE        S21101 34910021
         BZ    NOTBFRD                  BRANCH NO                S21101 34920021
         SPACE 1                                                 S21101 34930021
         CLI   LCBRESTR,TPRDLC          READ LCOUT               S21101 34940021
         BE    NOTBFRD                  YES, TEXT RELATED        S21101 34950021
         SPACE 1                                                 S21101 34960021
         CLI   LCBRESTR,TPWRAKNK        WRITE RESPONSE TO TEXT   S21101 34970021
         BE    NOTBFRD                  YES, EXIT                S21101 34980021
         SPACE 1                                                 S21101 34990021
         CLI   LCBRESTR,TPRESET         ABORT SEQUENCE           S21101 35000021
         BE    NOTBFRD                  YES                      S21101 35010021
         SPACE 1                                                 S21101 35020021
         OI    LCBCHAIN,LCBNORTY        SET NO RETRY FLAG        S21101 35030021
         L     RWKA,LCBLSPCI-1          GET ADDRESS OF HEADER    S21101 35040021
         USING IEDQPRF,RWKA                                      S21101 35050021
         TM    PRFSTAT1,PRFNHDRN        TEXT BUFFER              S21101 35060021
         BO    NOTBFRD                  BRANCH YES               S21101 35070021
         SPACE 1                                                 S21101 35080021
         OI    PRFSTAT1,PRFNHDRN        SET TO TEXT              S21101 35090021
         OI    PRFTIC,PRFBFMM           TELL AA ABOUT NEW ILDES  S21101 35100021
         OI    SCBERR4,SCBTXTTN         SET TEXT ERROR           S21101 35110021
         SR    RWKC,RWKC                CLEAR FOR INDEX          S21101 35120021
         IC    RWKC,LCBISZE             GET IDLES COUNT          S21101 35130021
         LA    RWKC,PRFSHDR-PRFSTXT(RWKC) BUMP IDLES COUNT       S21101 35140021
         STC   RWKC,LCBISZE                                      S21101 35150021
         LH    RWKD,PRFSIZE             GET PRE-SET SIZE         S21101 35160021
         LA    RWKD,1(,RWKD)            BUMP FOR EOT             S21101 35170021
         STH   RWKD,PRFSIZE             SET IN PREFIX            S21101 35180021
         LA    RWKD,PRFSTXT(RWKC)       ADDRESS OF EOT CHARACTER S21101 35190021
         DROP  RWKA                                              S21101 35200021
         L     RWKA,DCBSCTAD-1          GET SCT ADDRESS          S21101 35210021
         IC    RWKC,AVTEZERO(RWKA)      GET EOT INDEX            S21101 35220021
         LA    RWKA,1(RWKC,RWKA)        ADDRESS OF EOT CHARACTER S21101 35230021
         MVC   0(1,RWKD),0(RWKA)        MOVE EOT IN BUFFER       S21101 35240021
         EJECT                                                          35250021
NOTBFRD  EQU   *                                                 S21101 35260021
         CLI   LCBRESTR,TPTEXT          TEXT ERROR               S22025 35460022
         BNE   NOTEXT                   NO                       S22025 35660022
*                                                                S22025 35860022
         OI    SCBERR4,SCBTXTTN         SET TEXT ERROR           S22025 36060022
NOTEXT   EQU   *                                                 S22025 36260022
         TM    SCBERR4,SCBCTLUN+SCBCHANN CONTROL UNIT OR CHANERLERR     36640020
         BNZ   NOTLNTR                  BRANCH IF EITHEROR BOTH         36660020
         SPACE                                                          36680020
         OI    SCBERR4,SCBTRMLN         MUST BE TERMINAL/LINE ERROR     36700020
         DROP  RWKB                                                     36720020
NOTLNTR  EQU   *                                                        36740020
         NI    IOSFLA,AVTEFF-IOSERR     POST PERMANENT ERROR TO  Y02027 36800006
*                                       ABNORMAL END APPENDAGE   Y02027 36900006
         TM    AVTBIT2,AVTTOPOL         ERROR MSG ON TIMEOUT -POLL      37000020
         BZ    GOMSG                    BRANCH IF MSG TO BE SENT        37200020
         CLI   LCBRSKEY,DSPLOCSC        LOCAL DEVICE ?         @XA03955 37220061
         BE    GOMSG                    BRANCH YES             @XA03955 37240061
         CLI   CCWOPCDE,CCWPOLL         IS THIS AUTOPOLL         A42420 37260021
         BE    CKSENS                   IF SO, CHECK SENSE       A42420 37320021
         SPACE                                                          37400020
         CLI   LCBRESTR,TPRDRESP        TIME OUT IN POLLING RESONSE     37600020
         BNE   GOMSG                    NO, WRITE MSG                   37800020
         SPACE                                                          38000020
CKSENS   EQU   *                                                 A42420 38100021
         CLI   LCBSENS0,TIMEOUT         TIME OUT                        38200020
         BE    EXIT                     YES, NO MSG OR OBR              38400020
         CLI   LCBSENS0,IR              INTERVENTION REQUIRED           38600020
         BE    EXIT                     YES, NO MSG OR OBR              38800020
         SPACE                                                          39000020
GOMSG    EQU   *                                                        39200020
         MVI   LCBINCAM,6               SET RETRY COUNT TO MAX          39202061
         L     RWKA,DCBDEBAD            GET DEB ADDRESS         SA65392 39205052
         USING DEBTCBAD,RWKA            DEB ADDRESSIBILITY      SA65392 39210052
         SR    RWKB,RWKB                CLEAR WORK REGISTER     SA65392 39215052
         LR    RWKC,RWKB                CLEAR WORK REGISTER     SA65392 39220052
         IC    RWKB,DEBNMEXT            GET NUMBER OF EXTENTS   SA65392 39225052
         SLL   RWKB,TWO                 SIZE OF UCB ADDRESSES   SA65392 39230052
         L     RWKB,DEBUCBAD(RWKB)      THRESHOLD AREA          SA65392 39235052
         IC    RWKC,LCBUCBX             RLN MINUS ONE           SA65392 39240052
         SLL   RWKC,THREE               THRESHOLD INDEX        @OX16393 39245091
         AR    RWKB,RWKC                THRESHOLD COUNTERS      SA65392 39250052
         SRL   RWKC,1                   ADD HALF AGAIN FOR     @OZ24288 39250391
         AR    RWKB,RWKC                ERRMSG DATA SAVE AREA  @OZ24288 39250691
         LR    RLINK,RWKB               SAVE ADDRESS OF THRESH @OX16393 39251091
         MVC   LCBRESTR+3(1),AVTHRESH+1 SAVE CORRECT CNT       @SA73187 39252061
         CLI   LCBSENS0,DCK             DATA CHECK              SA65392 39255052
         BE    SETUP                    BR YES, DO THRESHHOLD  @SA70291 39260061
         LA    RWKB,1(RWKB)             BUMP TO IR COUNTER     @SA70291 39270061
         MVC   LCBRESTR+3(1),AVTHRESH+2 SAVE CORRECT CNT       @SA73187 39280061
         CLI   LCBSENS0,IR              INTERVENTION REQUIRED   SA65392 39300052
         BE    SETUP                    BR YES, DO THRESHHOLD  @SA70291 39305061
         LA    RWKB,1(RWKB)             BUMP TO TO COUNTER     @SA70291 39315061
         MVC   LCBRESTR+3(1),AVTHRESH+3 SAVE CORRECT CNT       @SA73187 39325061
         CLI   LCBSENS0,TIMEOUT         TIME OUT                SA65392 39345052
         BNE   GOTHRESH                 BRANCH NO-WRITE MSG     SA65392 39350052
         CLI   LCBRESTR,TPRDRPEB        TEXT TIMEOUT            SA65392 39355052
         BE    GOTHRESH                 BR YES-WRITE MSG       @SA75445 39360009
SETUP    EQU   *                                               @SA70291 39364061
         IC    RWKC,ONE(RWKB)           GET OLD VALUE          @SA70291 39368061
         LA    RWKC,ONE(RWKC)           INCREMENT              @SA70291 39372061
         STC   RWKC,ONE(RWKB)           AND SAVE               @SA70291 39376061
         CLC   ONE(ONE,RWKB),LCBRESTR+3 THRESHHOLD REACHED     @SA70291 39380061
         BL    EXIT                     BR NO, EXIT            @SA70291 39384061
         MVI   ONE(RWKB),ZERO           ELSE CLEAR COUNTER     @SA70291 39388061
GOTHRESH EQU   *                                                SA65392 39395052
         MVI   LCBSENS1,0               CLEAR 2ND SENSE BYTE            39600020
         MVI   EWTCTRM,BLANK                                     Y02027 39650006
         MVC   EWTCTRM+ONE(SEVEN),EWTCTRM BLANK OUT TERMINAL     Y02027 39700006
*                                       NAME FIELD IN EWA        Y02027 39750006
         SR    RWKA,RWKA                CLEAR WORK REGISTER             39800020
         STH   RWKA,LCBRESTR+2          CLEAR DEVICE CHARACTERS         40000020
         LH    RWKC,LCBTTCIN            TNT OFFSET                      40400020
         LTR   RWKC,RWKC                SOURCE SPECIFIED                40600020
         BNZ   SOURCE                   YES                             40800020
         SPACE                                                          41000020
         TM    LCBSTAT2,LCBDIAL         DIAL LINE                       41200020
         BZ    USEUCB                   BRANCH NO                       41400020
         SPACE                                                          41600020
         LH    RWKC,LCBLNENT            LINE ENTRY USED                 41800020
         LTR   RWKC,RWKC                LINE ENTRY?                     42000020
         BNZ   SOURCE                   BRANCH YES                      42200020
         SPACE                                                          42400020
USEUCB   EQU   *                                                        42600020
         L     RXCTL,CVTPTR             RELOAD CVT BASE          Y02027 42700006
         L     RTERM,STATTAB(,RXCTL)    STAT TABLE OFFSET FROM CVT      42800020
         L     RWKB,UCBEXTPT-UCBOB(,RUCB) UCB EXTENSION          Y02027 43200006
         IC    RWKC,UCBSTI-UCBCMEXT(,RWKB) STATAB INDEX          Y02027 43300006
         LR    RWKB,RTERM               COPY TABLE ADDRESS              43400020
LOOP1    EQU   *                                                        43600020
         CLM   RUCB,THREE,ZERO(RWKB)    IS DEV SUPPORTED HERE  @Z30AAEE 43800008
         BC    4,LOOP2                  BRANCH YES                      44000020
         SPACE                                                          44200020
         LA    RWKB,2(,RWKB)            NEXT ENTRY                      44400020
         LA    RWKC,256(,RWKC)          NEXT STAT TABLE IN              44600020
         B     LOOP1                    CHECK THIS ENTRY                44800020
         SPACE                                                          45000020
LOOP2    EQU   *                                                        45200020
         MH    RWKC,H10                 MULTIPLY BY 10                  45400020
         AR    RTERM,RWKC               SAT TABLE ADDRESS SET           45600020
         LA    RWKC,UCBNAME-UCBOB(,RUCB) UCB NAME ADDR           Y02027 45800006
         STM   RTERM,RWKC,LCBERCCW+16   ADDR OF SDR COUNTERS    SA65392 46000052
*                                         AND ADDR OF TERMNAME  SA65392 46100052
         LA    RWKA,TWO                 SET SIZE FOR EXECUTE    Y02027  46200006
*                                       INSTR  TO MOVE UCB NAME  Y02027 46250006
         EX    RWKA,MOVENAME            MOVE UCB NAME TO ERP     Y02027 46300006
*                                       WORK AREA                Y02027 46350006
         ST    RTERM,LCBERCCW+16        ADDRESS OF SDR COUNTERS         46400020
         B     NOADDR                   COMMMON CODE AND EXIT           46600020
         SPACE                                                          46800020
SOURCE   EQU   *                                                        47000020
         N     RWKC,AVTCLRHI            CLEAL NEG PROPAGATION   SA65392 47200052
         L     RWKB,AVTRNMPT            ROUTINE BASE                    47400020
         USING IEDQTNTD,RWKB                                            47600020
         BAL   RWKA,TNTDCODE            LINK TO ROUTINE                 47800020
         SR    R0,R0                    CLEAR WORK REGISTER             48000020
         IC    R0,X'28'(,RWKB)          GET SIZE OF NAME                48200020
         LA    RWKC,79(RWKB,RWKC)        ADDRESS OF TERM ADDRESS        48400020
         SR    RWKC,R0                  BACK UP TO NAME ADDRESS         48600020
*    THE FOLLOWING INSTRUCTION SETS LCBERCCW=0 - INDICATES OBR          48800020
         LA    RWKA,TRMSIO              ADDRESS OF COUNTERS             49000020
         ST    RWKA,LCBERCCW+16         ADDRESS OF COUNTERS FOR OBR     49200020
         CLC   1(1,RWKA),2(RWKA)        CHECK COUNTS                    49240020
         BH    NOADD                    OKAY                            49280020
         MVC   1(1,RWKA),2(RWKA)        SET COUNTS                      49320020
NOADD    EQU   *                                                        49360020
         ST    RWKC,LCBERCCW+20         ADDRESS OF EBCDIC NAME          49400020
         LR    RWKA,R0                  MOVE NAME COUNT FOR EXEC Y02027 49600006
*                                       INSTRUCTION              Y02027 49630006
         BCTR  RWKA,ZERO                REDUCE NAME CONT BY ONE  Y02027 49660006
*                                       FOR EXECUTE INSTRUCTION  Y02027 49690006
         EX    RWKA,MOVENAME            MOVE THE TERMINAL NAME   Y02027 49720006
*                                       TO THE ERP WORK AREA     Y02027 49750006
         SR    RWKB,RWKB                CLEAR WORK REGISTER             49800020
         TM    TRMSTATE,TRMOPTFN        OPTION FIELDS PRESENT           50000020
         BZ    NOOPT                    BRANCH IF NO             S22025 50200022
         SPACE                                                          50400020
         IC    RWKB,TRMOPNO             NO OF OPTION ENTRIES            50600020
         LA    RWKB,3(,RWKB)            ADJUST FOR REQUIRED             50800020
*                                         OPTION BYTES                  51000020
NOOPT    EQU   *                                                        51200020
         LH    RWKC,TRMDEVFL            DEVICE FLAGS                    51400020
         LTR   RWKC,RWKC                BUFSIZE SPECIFIED               51600020
         BNM   NOBUFSZ                  NO                              51800020
         SPACE                                                          52000020
         LA    RWKB,3(,RWKB)            ADJUST FOR BUFSIZE              52200020
NOBUFSZ  EQU   *                                                        52400020
         LA    RWKB,TRMCHCIN+1(RWKB)    DEVICE INGORMATION              52600020
         SLL   RWKC,17                  SHIFT DEVICE BITS               52800020
         LTR   RWKC,RWKC                DIAL DIGITS                     53000020
         BNM   NODIGITS                 NO                              53200020
         SPACE                                                          53400020
         SR    RWKA,RWKA                CLEAR WORK REGISTER             53600020
         CLI   0(RWKB),4                AT LEAST 4 DIGITS               53800020
         BNH   PACKIT                   BRANH IF 4 OR LESS              54000020
         IC    RWKA,0(,RWKB)            GET COUNT OF DIGITS             54200020
         SH    RWKA,AVTHA4              DECREMENT BY 4          SA65392 54400052
         LA    RWKB,0(RWKA,RWKB)        ADJUST FOR PACK                 54600020
PACKIT   EQU   *                                                        54800020
         PACK  LCBERCCW+8(4),1(7,RWKB)  PACK DIAL DIGITS                55000020
         MVC   LCBRESTR+2(2),LCBERCCW+8 MOVE FOR WTO MODULE             55200020
         B     POSTEXIT                 LEAVE                           55400020
         SPACE                                                          55600020
NODIGITS EQU   *                                                        55800020
         TM    LCBSTAT1,LCBSENDN        SEND STATE                      56000020
         BO    GETCHAR                  BRANCH YES TO ADDR CHARS        56200020
         TM    LCBSTAT2,LCBMSGNN        MESSAGE GEN                     56400020
         BZ    NOADDR                   BRANCH NO TO GET POLLING        56600020
GETCHAR  EQU   *                                                        56800020
         SLL   RWKC,1                   ADDRESSING  CHARS               57000020
         LTR   RWKC,RWKC                NO ADDRESSING CHARS             57200020
         BNM   NOADDR                   NO                              57400020
         SPACE                                                          57600020
         MVC   LCBRESTR+2(2),1(RWKB)    ASSUME AT LEAST 2 CHARS.        57800020
         CLI   AVTEZERO(RWKB),1         ONLY ONE CHAR                   58000020
         BE    CLEAR2                   BRANCH YES             @OX14080 58200091
         SPACE                                                          58400020
         CLI   AVTEZERO(RWKB),FIVE      FIVE CHARACTERS        @OX13491 58600091
         BNE   POSTEXIT                 NO-LEAVE               @OX13491 58700091
         MVC   LCBRESTR+THREE(ONE),THREE(RWKB) UPDATE 2ND BYTE @OX13491 58800091
         B     POSTEXIT                 LEAVE                  @OX13491 58900091
         SPACE 2                                                        59000020
NOADDR   EQU   *                                                        59200020
         SR RWKA,RWKA                   CLEAR WORK REGISTER             59400020
         IC    RWKA,LCBUCBX             RLN MINUS 1                     59600020
         SLL   RWKA,2                   MULTIPLY BY 4                   59800020
         L     RWKB,DCBINVLI(RWKA)      ILIST FOR THIS LINE             60000020
         SR    RWKA,RWKA                CLEAR WORK             @OZ30194 60200086
         SR    R0,R0                    CLEAR INDEX REGISTER   @OZ32827 60208086
         LA    RWKC,8(,RWKB)            GET CONTROL WORD       @OZ30194 60216086
         IC    RWKA,2(,RWKB)            GET ENTRY LENGTH       @OZ30194 60224086
         BCTR  RWKA,0                   REDUCE BY 1            @OZ30194 60232086
         B     STARLOOK                 CHECK LIST             @OZ30194 60240086
LOOPLOOK EQU   *                                               @OZ30194 60248086
         AR    RWKC,RWKA                MOVE TO NEXT           @OZ30194 60256086
         LA    RWKC,1(,RWKC)            ENTRY                  @OZ30194 60264086
         SR    R0,R0                    CLEAR INDEX REGISTER   @OZ32827 60272086
STARLOOK EQU   *                                               @OZ30194 60280086
         CLI   0(RWKC),XFE              END OF LIST            @OZ30194 60288086
         BE    YESEND                   BRANCH YES             @OZ30194 60296086
         CLI   1(RWKC),XFE              END OF LIST            @OZ30194 60304086
         BE    YESEND                   BRANCH YES AGAIN       @OZ30194 60312086
         IC    R0,0(RWKA,RWKC)          GET ENTRY INDEX        @OZ32827 60320086
         AR    R0,R0                    DOUBLE FOR SUBTRACT    @OZ32827 60326086
         LNR   R0,R0                    MAKE NEGATIVE          @OZ32827 60332086
         AR    R0,RWKB                  SUBTRACT FOR TNTINDEX  @OZ32827 60338086
         CH    R0,LCBTTCIN              CORRECT ENTRY          @OZ32827 60344086
         BNE   LOOPLOOK                 BRANCH NO              @OZ30194 60360086
YESEND   EQU   *                                               @OZ30194 60368086
         MVC   LCBRESTR+2(2),AVTEZERO(RWKC) ASSUME 2 CHARACTERS         60400020
         CLI   2(RWKB),2                ONLY 1 CHARACTER                60600020
         BNH   CLEAR2                   YES BRANCH             @OX14080 60800091
         CLI   TWO(RWKB),SIX            FIVE CHARACTERS        @OX13491 60820091
         BNE   POSTEXIT                 NO-LEAVE               @OX13491 60840091
         MVC   LCBRESTR+THREE(ONE),THREE(RWKC) UPDATE 2ND BYTE @OX13491 60860091
         B     POSTEXIT                 LEAVE                  @OX13491 60880091
CLEAR2   EQU   *                                                SA65392 60900052
         SPACE                                                          61000020
         MVI   LCBRESTR+3,AVTEZERO      CLEAR 2ND BYTE                  61200020
POSTEXIT EQU   *                                                        61400020
         LH    RWKB,AVTOPCON            OPERATOR CONTROL                61600020
         LTR   RWKB,RWKB                SPECIFIED                       61800020
         BZ    SYSCON                   NO, USE SYSTEM CONSOLE          62000020
         SPACE                                                          62200020
         N     RWKB,AVTCLRHI            CLEAR HIGH ORDER HALF WORD      62250020
         A     RWKB,AVTRNMPT            GET ADDR OF TERM NAME ENTRY     62300020
         L     RWKA,LCBERCCW+20         TERMNAME ADDR FOR LCBTTCIN      62350020
         LA    RWKA,0(,RWKA)            CLEAR HIGH ORDER BYTE           62400020
         CR    RWKA,RWKB                CHECK FOR PRIM CONTROL TERM     62450020
         BNE   OPCTL                    BRANCH IF ERROR NOT ON PRIM     62500020
SYSCON   EQU   *                                                        62800020
         USING UCBOB,RUCB                                      @OZ16799 62850091
         MVC   EWACHA,UCBCHA            SAVE DEV ADDR FOR MSG  @OZ16799 62900091
         DROP  RUCB                                            @OZ16799 62950091
         OI    IOSFLB,IOSMSG+IOSLOG     'I/O' MSG + OBR          Y02027 63000006
         OI    EWAFLG1,EWADDMSG         ERP DEP DATA IN ERRMSG @ZA06642 63100009
         MVC   EWTCTID(TWO),LCBRESTR+TWO MOVE TERMINAL ID CHARS  Y02027 63200006
*                                       TO ERP WK AREA FOR IOS   Y02027 63260006
*                                       WTO ERROR ROUTINE        Y02027 63320006
         LA    RLINK,WTOMSG             LINK TO MESSAGE WRITE           63400020
         B     NEXTLOAD                 COMMON CODE                     63600020
OPCTL    EQU   *                                                        63800020
         OI    LCBCHAIN,LCBERMSG        WE OWE MSG TO OPERATOR CTL      64000020
         USING LCBEXTX,RLINK            ADDRESSABILITY         @OX16393 64200091
         MVC   IEALTPCD(4),LCBRESTR     SAVE TP CDS AND CHARS  @OX16393 64260091
         MVC   IEASENS0,LCBSENS0        SAVE SENSE INFORMATION @OZ24288 64320091
         MVC   IEACSW,LCBCSW+3          SAVE CSW               @OZ24288 64400091
*                                       LAID BY MSGGEN OR RECAL@OX14080 64500091
         MVC   IEACMD,CCWOPCDE          SAVE COMMAND CODE      @OZ24288 64800091
         LA    RLINK,SDRLOAD            OBR ID                          65000020
NEXTLOAD EQU   *                                                        65200020
         MVC   EWTCCSW(SEVEN),LCBCSW    MOVE CSW INTO THE ERP    Y02027 65206006
*                                       WORK AREA                Y02027 65212006
         MVC   EWTCCCW(EIGHT),ZERO(RCCW) MOVE CCW INTO THE ERP   Y02027 65218006
*                                       WORK AREA                Y02027 65224006
         IC    RWKA,LCBERMSK            ASSUME LINE ERROR MASK   Y02027 65230006
         TM    LCBERMSK,LINEMASK        IS LINE MASK PRESENT     Y02027 65236006
         BNZ   MOVEMASK                 YES. MOVE MASK.          Y02027 65242006
         IC    RWKA,TRMSENSE            PICKUP TERMINAL ERR MASK Y02027 65248006
MOVEMASK EQU   *                                                 Y02027 65254006
         STC   RWKA,EWTCMSK             MOVE MASK INTO ERP WORK  Y02027 65260006
*                                       AREA                     Y02027 65266006
         L     RTERM,LCBERCCW+SIXTEEN   PICKUP ADDR OF SDR CTRS  Y02027 65272006
         USING TRMSIO,RTERM                                      Y02027 65278006
         MVC   EWTCSIO(THREE),TRMSIO    MOVE START I/O AND TEMP  Y02027 65284006
*                                       ERROR COUNTERS TO THE    Y02027 65290006
*                                       ERP WORK AREA            Y02027 65296006
         XC    TRMSIO(THREE),TRMSIO     CLEAR ERROR COUNTERS IN  Y02027 65302006
*                                       THE TERMINAL TABLE       Y02027 65308006
         MVC   EWTCTPF(ONE),LCBRESTR    MOVE 1ST TP OP CODE TO   Y02027 65314006
*                                       OBR/SDR RECORD           Y02027 65320006
         MVC   EWTCTPL(ONE),LCBRESTR+ONE MOVE LAST TP OP CODE TO Y02027 65326006
*                                       OBR/SDR RECORD           Y02027 65332006
         MVC   EWTCSNF(ONE),LCBSNSV     MOVE 1ST BYTE OF SENSE   Y02027 65338006
*                                       DATA TO OBR/SDR RECORD   Y02027 65344006
         MVC   EWTCSNL(ONE),LCBSENS0    MOVE LAST BYTE OF SENSE  Y02027 65350006
*                                       DATA TO OBR/SDR DATA     Y02027 65356006
         LA    RWKA,EWTCSIO             INDICATE ADDR OF START   Y02027 65362006
         STCM  RWKA,SEVEN,EWADDISP      DEVICE DEPENDENT INFO    Y02027 65368006
*                                       FOR OBR/SDR              Y02027 65374006
         MVI   EWADCNT,OBRDATA          INDICATE SIZE OF DEVICE  Y02027 65380006
*                                       DEPENDENT DATA FOR OBR   Y02027 65386006
         L     RXCTL,CVTPTR             CVT ADDRESS              Y02027 65392006
         L     RXCTL,XCTLADD(,RXCTL)    XCTL ADDRESS                    65400020
HIOSUB   EQU   *                                                 Y02027 65410006
**************************************************************** Y02027 65420006
*        THE FOLLOWING CODE MAPS THE NECESSARY FIELDS FROM THE   Y02027 65430006
*        LINE CONTROL BLOCK TO THE I/O SUPERVISOR BLOCK FOR EXCP Y02027 65440006
*        COMPATABILITY DURING RETRY OPERATIONS FROM ERP          Y02027 65450006
**************************************************************** Y02027 65460006
         MVC   IOSCSW(SEVEN),LCBCSW     MAP CSW FROM LCB TO IOSB Y02027 65470006
         MVC   IOSSNS(TWO),LCBSENS0     MAP SENSE INFO FROM LCB  Y02027 65480006
*                                       INTO IOSB                Y02027 65490006
         MVC   IOSCC(ONE),LCBSIOCC      MAP START I/O CONDITION  Y02027 65500006
*                                       CODE FROM LCB TO IOSB    Y02027 65510006
         CLI   LCBECBCC,HIOCC           WAS IOHALT DONE          Y02027 65530006
         BNER  RXCTL                    BRANCH NO - RETURN       Y02027 65540006
         NI    IOSFLA,X'FF'-(IOSERR+IOSEX) RESET ERP IN CNTRL    Y02027 65550006
         MVI   LCBINCAM+1,HIOCC         SET FOR LINEEND          Y02027 65560006
         BR    RXCTL                    LINK TO XCTL                    65600020
         EJECT                                                          65800020
*              EXECUTE INSTRUCTIONS                                     65830006
         SPACE                                                          65860006
MOVENAME MVC   EWTCTRM(ZERO),ZERO(RWKC) MOVE TERMINAL NAME INTO  Y02027 65890006
*                                       THE ERP WORK AREA        Y02027 65920006
         SPACE                                                          65950006
*              CONSTANTS                                                66000020
H8       DC    H'8'                     USED TO BACK UP TO       S22025 66200022
*                                       FAILING CCW              S22025 66300022
*                                       COUNTER                  S22025 66500022
H10      DC    H'10'                    USED TO ADJUST STATISTIC S22025 66600022
*                                       TABLE POINTER            S22025 66700022
LCBSIZE  DC    AL2(LCBFLAG1-IEDQLCB)    ADJUSTMENT TO BACK UP TO S22025 66800022
*                                       BEGINNING OF LCB         S22025 66900022
*                                       HALF OF REGISTER         S22025 67300022
SEVEN    EQU   7                                                 Y02027 67301006
EIGHT    EQU   8                                                 Y02027 67302006
TWELVE   EQU   12                                                Y02027 67303006
SIXTEEN  EQU   16                                                Y02027 67304006
BLANK    EQU   X'40'                                             Y02027 67305006
LINEMASK EQU   X'FF'                    TEST FOR LINE ERROR MASK Y02027 67306006
OBRDATA  EQU   18                       SIZE OF DEVICE DEPENDENT Y02027 67307006
*                                       DATA FOR OBR/SDR         Y02027 67308006
HIOCC    EQU   X'48'                    IOHALT COMPLETION CODE   Y02027 67309006
ZERO     EQU   0                        CONSTANT DISPLACEMENT   SA65392 67310052
ONE      EQU   1                        CONSTANT DISPLACEMENT   SA65392 67320052
TWO      EQU   2                        CONSTANT DISPLACEMENT   SA65392 67330052
THREE    EQU   3                        CONSTANT DISPLACEMENT   SA65392 67340052
FIVE     EQU   5                        CHARACTER COUNT        @OX13491 67343091
SIX      EQU   6                        CHARACTER COUNT        @OX13491 67346091
DCK      EQU   X'08'                    MASK FOR SENSE BYTE     SA65392 67350052
UCBMASK  EQU   X'17'                    OFFSET IN UCB TO SENSE BYTE     67400020
STATTAB  EQU   X'70'                    CVT OFFSET TO STATISTICS        67800020
RETRY    EQU   X'02'                    RETRY LIMIT                     68000020
CVTPTR   EQU   X'10'                    CVT LOCATION POINTER            68400020
X10      EQU   X'10'                    MASK-EXTENDED ERROR MESSAGE     68600020
XCTLADD  EQU   X'2C'                    OFFSET IN CVT-XCTL ROUTINE      68800020
EREXCP   EQU   15                       ERROR EXCP                      69000020
RETURN   EQU   3                        ETURN SVC FOR TRANSIENT S       69200020
TIMEOUT  EQU   X'01'                    MSK FOR SENSE BYTE              69400020
BUFF     EQU   X'1A'                    STVTO FOR BUFFERED LCB   S21101 69500021
IR       EQU   X'40'                    MSK FOR SENSE BYTE              69600020
IOBOFFST EQU   4                        IOB OFFSET IN RQE               70000020
WTOMSG   EQU   253                      LINK VALUE FOR WTO MODULE       70400020
SDRLOAD  EQU   256                      OBR/SDR MODULE ID               70600020
UNITCHK  EQU   X'02'                    MASK FOR UNIT CHECK IN CSW      71400020
IOBPTR   EQU   5                        OFFSET OF IOB ADDR. IN RQE.     71410006
DEBPTR   EQU   9                        OFFSET OF DEB ADDR. IN RQE.     71420006
SIOPTR   EQU   4                        OFFSET OF SIO APDG. ADDRESS     71450006
*                                       IN APDG. VECTOR TABLE.          71460006
SIOENTRY EQU   34                       OFFSET OF SUBRTNE. ENTRY Y02027 71470006
*                                       POINT IN SIO APPENDAGE.         71480006
NORMAL   EQU   X'0D'                    NORMAL END FOR RD RESP   S22025 71500022
DB       EQU   X'DB'                    MASK FOR IOS TO RETURN   S22025 71510022
*                                       TO LINE END APPENDAGE    S22025 71520022
*                                       WITHOUT SIO              S22025 71530022
COMREJ   EQU   X'80'                    MASK TO TEST FOR         S22025 71540022
*                                       COMMAND REJECT           S22025 71550022
XFE      EQU   X'FE'                    END OF LIST ID         @OZ30194 71570086
         EJECT                                                          71600020
         TSCBD                                                          72000020
         TPRFD                                                   S21101 72060021
         EJECT                                                          72120021
         TTRMD                                                          72200020
         TTNTD                                                          72400020
         TCCWD                                                          72600020
         TLCBD                                                          72800020
         EJECT                                                 @OX16393 72820091
LCBEXTX  DSECT                                                 @OX16393 72840091
THRWORD  DS    F                        FOUR BYTE THRESH INFO  @OX16393 72860091
IEALTPCD DS    CL1                      SAVED LAST TP OP CODE  @OX16393 72880091
IEAFTPCD DS    CL1                      SAVED FIRST TP OP CODE @OX16393 72900091
IEADVCHS DS    CL2                      SAVED DEVICE CHARACTERS@OX16393 72920091
IEASENS0 DS    CL1                      SAVED SENSE INFORMATION@OZ24288 72940091
IEACMD   DS    CL1                      SAVED COMMAND CODE     @OZ24288 72960091
IEACSW   DS    CL2                      SAVED CSW INFORMATION  @OZ24288 72980091
         DCBD  DSORG=TX                                                 73000020
         TDEBD                                                  SA65392 73100052
         TAVTD                                                          73200020
         TTPD                                                           73400020
         EJECT                                                          73420061
         TDISPD                                                @XA03955 73440061
         IECDIOSB                                                Y02027 73460006
         IECDERWA EWTC                                                  73520006
         EJECT                                                          73600006
         DSECT                                                          76600006
         IEFUCBOB                                                       79600006
         END                                                            82600006
