         TITLE 'IOESDKTO-3540 SETDISKT OUTPUT SERVICES                 *00001000
                        '                                               00002000
IOESDKTO CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'IOESDKTO  77.320'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  LA    @10,4095(,@12)                                      0001 00012000
         USING @PSTART,@12                                         0001 00013000
         USING @PSTART+4095,@10                                    0001 00014000
         L     @00,@SIZDATD                                        0001 00015000
         GETMAIN  R,LV=(0)                                              00016000
         LR    @09,@01                                             0001 00017000
         USING @DATD,@09                                           0001 00018000
         ST    @13,@SA00001+4                                      0001 00019000
         LM    @00,@01,20(@13)                                     0001 00020000
         ST    @09,8(,@13)                                         0001 00021000
         LR    @13,@09                                             0001 00022000
*   SETDSKPT=REG1;                  /* INIT SETDISKT POINTER @Y30OE6D*/ 00023000
         LR    SETDSKPT,REG1                                       0108 00024000
*   RESPECIFY                                                      0109 00025000
*     REG1 UNRSTD;                  /* RELEASE REGISTER      @Y30OE6D*/ 00026000
*   RFY                             /* ADDRESSABILITY TO IOB @Y30OE6D*/ 00027000
*     IOBPREFX BASED(IOBPTR-LENGTH(IOBPREFX));/* PREFIX      @Y30OE6D*/ 00028000
*   RFY                             /* ADDRESSABILITY TO IOB @Y30OE6D*/ 00029000
*     IOBSTDRD BASED(IOBSTPTR);     /* STANDARD SECTION      @Y30OE6D*/ 00030000
*   DCBPTR=SDKTDCB;                 /* SET POINTER TO DCB    @Y30OE6D*/ 00031000
         L     @08,SDKTDCB(,SETDSKPT)                              0112 00032000
         LR    DCBPTR,@08                                          0112 00033000
*   DEBPTR=DCBDEBAD;                /* SET POINTER TO DEB    @Y30OE6D*/ 00034000
         L     DEBPTR,DCBDEBAD+40(,DCBPTR)                         0113 00035000
*   AWORKPTR=DCBAMWKA;              /* GET PTR TO AM WORK    @Y30OE6D*/ 00036000
         LA    @15,16                                              0114 00037000
         LR    @14,DCBPTR                                          0114 00038000
         ALR   @14,@15                                             0114 00039000
         L     AWORKPTR,DCBAMWKA-1(,@14)                           0114 00040000
         LA    AWORKPTR,0(,AWORKPTR)                               0114 00041000
*   IOBSTPTR=IOBPTR;                /* SET POINTER TO IOB    @Y30OE6D*/ 00042000
         L     @14,IOBPTR-1(,AWORKPTR)                             0115 00043000
         LA    @14,0(,@14)                                         0115 00044000
         LR    IOBSTPTR,@14                                        0115 00045000
*   SAVEIOB=IOBSTPTR;               /* SAVE IOB POINTER      @Y30OE6D*/ 00046000
         ST    IOBSTPTR,SAVEIOB(,AWORKPTR)                         0116 00047000
*   SAVEIOBX=IOBPTR-LENGTH(IOBPREFX);/* SAVE PREFIX PTR      @Y30OE6D*/ 00048000
         SLR   @14,@15                                             0117 00049000
         ST    @14,SAVEIOBX(,AWORKPTR)                             0117 00050000
*   SAVEUCB=DEBSUCBB;               /* SAVE POINTER TO UCB   @Y30OE6D*/ 00051000
         L     @15,DEBSUCBB-1(,DEBPTR)                             0118 00052000
         LA    @15,0(,@15)                                         0118 00053000
         ST    @15,SAVEUCB(,AWORKPTR)                              0118 00054000
*   CHNPGMPT=IOBSTRTB;              /* GET PTR TO CCW CHAIN  @Y30OE6D*/ 00055000
         L     CHNPGMPT,IOBSTRTB-1(,IOBSTPTR)                      0119 00056000
         LA    CHNPGMPT,0(,CHNPGMPT)                               0119 00057000
*   MSGTYPCD=WTOCD;                 /* SET MSG TYPE TO WTO   @Y30OE6D*/ 00058000
         MVI   MSGTYPCD(AWORKPTR),X'01'                            0120 00059000
*   JNAMETXT=ACBJOBID;              /* PUT JOBNAME IN MSG    @Y30OE6D*/ 00060000
         MVC   JNAMETXT(8),ACBJOBID(AWORKPTR)                      0121 00061000
*   MSGDCBAD=SDKTDCB;               /* INIT DCB ADDR         @Y30OE6D*/ 00062000
         ST    @08,MSGDCBAD(,AWORKPTR)                             0122 00063000
*   DSIDTXT=SDKTDSID;               /* PUT DSID IN MSG       @Y30OE6D*/ 00064000
         MVC   DSIDTXT(8),SDKTDSID(SETDSKPT)                       0123 00065000
*   SETRETCD=''B;                   /* CLEAR SETDISKT RET CD @Y30OE6D*/ 00066000
         XC    SETRETCD(2,SETDSKPT),SETRETCD(SETDSKPT)             0124 00067000
*                                                                  0125 00068000
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE6D*/ 00069000
*/*                                                          @Y30OE6D*/ 00070000
*/*                 SETDISKT OUTPUT SERVICES                 @Y30OE6D*/ 00071000
*/*                                                          @Y30OE6D*/ 00072000
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE6D*/ 00073000
*                                                                  0125 00074000
*SETDIN:                                                           0125 00075000
*   DO;                             /* SETDIN:CASE(SETOPCDE)NAMES(OPE   00076000
*                                      NDS,EOV,CLOSEDS)              */ 00077000
SETDIN   DS    0H                                                  0126 00078000
*     DCL                                                          0126 00079000
*       CL0001@ LABEL BASED(CP0001@(SETOPCDE)) VALUERANGE(OPENDS,EOV,   00080000
*           CLOSEDS);               /* BRANCH TARGET                 */ 00081000
*     DCL                                                          0127 00082000
*       CP0001@(3) PTR(31) INIT(ADDR(OPENDS),ADDR(EOV),ADDR(CLOSEDS));  00083000
*     GOTO CL0001@;                 /* BRANCH TO SELECTED CASE     0128 00084000
*                                                            @Y30OE6D*/ 00085000
         SLR   @11,@11                                             0128 00086000
         IC    @11,SETOPCDE(,SETDSKPT)                             0128 00087000
         SLA   @11,2                                               0128 00088000
         L     @11,CP0001@-4(@11)                                  0128 00089000
         BR    @11                                                 0128 00090000
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE6D*/ 00091000
*/*                                                          @Y30OE6D*/ 00092000
*/*                 OPEN AN OUTPUT DATA SET                  @Y30OE6D*/ 00093000
*/*                                                          @Y30OE6D*/ 00094000
*/*  IF THIS IS THE 1ST OPEN AFTER OPENING THE DEVICE OR IF  @Y30OE6D*/ 00095000
*/*  MULTI-DATASETS PER DISKETTE ARE NOT ALLOWED, THEN FIND  @Y30OE6D*/ 00096000
*/*  A SCRATCH DISKETTE.                                     @Y30OE6D*/ 00097000
*/*                                                          @Y30OE6D*/ 00098000
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE6D*/ 00099000
*                                                                  0129 00100000
*OPENDS:                                                           0129 00101000
*     DO;                           /* SUBCASE               @Y30OE6D*/ 00102000
OPENDS   DS    0H                                                  0130 00103000
*       FIRSTTME=OFF;               /* INITIALIZE FLAG       @Y30OE95*/ 00104000
         NI    FIRSTTME(AWORKPTR),B'01111111'                      0130 00105000
*       IF AMWBOE=ZEROS             /* IS THIS FIRST OPEN    @Y30OE6D*/ 00106000
*         THEN                      /* YES                   @Y30OE95*/ 00107000
         CLC   AMWBOE(4,AWORKPTR),ZEROS                            0131 00108000
         BNE   @RF00131                                            0131 00109000
*         DO;                       /* CONTINUE              @Y30OE95*/ 00110000
*           FIRSTTME=ON;            /* INDICATE FIRST TIME   @Y30OE95*/ 00111000
         OI    FIRSTTME(AWORKPTR),B'10000000'                      0133 00112000
*           AMWEXDTE(1)=ZERO;       /* RESET EXP. DATE       @Y30OE6D*/ 00113000
         MVI   AMWEXDTE(AWORKPTR),X'00'                            0134 00114000
*           CALL FINDSCRT;          /* GO GET SCRATCH DSKT   @Y30OE95*/ 00115000
         BAL   @14,FINDSCRT                                        0135 00116000
*         END;                      /*                       @Y30OE95*/ 00117000
*       ELSE                        /*                       @Y30OE95*/ 00118000
*         IF ACBFEED=ON             /* MULTI-D.S./DISKT ?    @Y30OE95*/ 00119000
*           THEN                    /* NO                    @Y30OE95*/ 00120000
         B     @RC00131                                            0137 00121000
@RF00131 TM    ACBFEED(AWORKPTR),B'10000000'                       0137 00122000
         BNO   @RF00137                                            0137 00123000
*           CALL FINDSCRT;          /* FIND A SCRATCH DISKT  @Y30OE95*/ 00124000
         BAL   @14,FINDSCRT                                        0138 00125000
*         ELSE                      /*                       @Y30OE95*/ 00126000
*                                                                  0139 00127000
*           /*********************************************************/ 00128000
*           /*                                                       */ 00129000
*           /* MAKE SURE THERE IS AN AVAILABLE HDR1 SLOT IF  @Y30OE95*/ 00130000
*           /* MULTI-DATA SETS PER DISKETTE ARE ALLOWED.     @Y30OE95*/ 00131000
*           /*                                                       */ 00132000
*           /*********************************************************/ 00133000
*                                                                  0139 00134000
*           DO;                     /* CONTINUE              @Y30OE95*/ 00135000
         B     @RC00137                                            0139 00136000
@RF00137 DS    0H                                                  0140 00137000
*             FEEDCODE=OFF;         /* SET NOFEED INDICATOR  @Y30OE6D*/ 00138000
         NI    FEEDCODE(AWORKPTR),B'10111111'                      0140 00139000
*             CALL RDLABTRK;        /* READ LABEL TRACK      @Y30OE95*/ 00140000
         BAL   @14,RDLABTRK                                        0141 00141000
*             IF ERTNCDE=GOODRTN    /* IF NO ERRORS FROM     @Y30OE6D*/ 00142000
*               THEN                /* RDLABTRK ROUTINE      @Y30OE6D*/ 00143000
         CLI   ERTNCDE(SETDSKPT),X'00'                             0142 00144000
         BNE   @RF00142                                            0142 00145000
*               CALL FINDHDR1;      /* FIND HDR1 SLOT        @Y30OE6D*/ 00146000
         BAL   @14,FINDHDR1                                        0143 00147000
*           END;                    /*                       @Y30OE6D*/ 00148000
@RF00142 DS    0H                                                  0145 00149000
*       IF ERTNCDE=GOODRTN          /* IF NO ERRORS FROM     @Y30OE6D*/ 00150000
*         THEN                      /* FINDSCRT ROUTINE      @Y30OE6D*/ 00151000
@RC00137 DS    0H                                                  0145 00152000
@RC00131 CLI   ERTNCDE(SETDSKPT),X'00'                             0145 00153000
         BNE   @RF00145                                            0145 00154000
*         DO;                       /* CONTINUE              @Y30OE6D*/ 00155000
*           CALL UPDEBIOB;          /* UPDATE THE DEB & IOB  @Y30OE6D*/ 00156000
         BAL   @14,UPDEBIOB                                        0147 00157000
*           AMWDSOPN=ON;            /* IND DATA SET IS OPEN  @Y30OE6D*/ 00158000
         OI    AMWDSOPN(AWORKPTR),B'01000000'                      0148 00159000
*         END;                      /* END OF OPEN DS ROUT.  @Y30OE6D*/ 00160000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 00161000
         B     CE0001@                                             0150 00162000
*     END OPENDS;                   /* END OF SUBCASE        @Y30OE6D*/ 00163000
*                                                                  0152 00164000
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE6D*/ 00165000
*/*                                                          @Y30OE6D*/ 00166000
*/*               EOV  (END OF VOLUME) ROUTINE               @Y30OE6D*/ 00167000
*/*                                                          @Y30OE6D*/ 00168000
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE6D*/ 00169000
*                                                                  0152 00170000
*EOV:                                                              0152 00171000
*     DO;                           /* SUBCASE               @Y30OE6D*/ 00172000
EOV      DS    0H                                                  0153 00173000
*       EOVPROC=ON;                 /* IND. EOV PROCESSING   @Y30OE6D*/ 00174000
         OI    EOVPROC(AWORKPTR),B'10000000'                       0153 00175000
*       CALL CLOSEOPN;              /* CLOSE OPENED DATA SET @Y30OE6D*/ 00176000
         BAL   @14,CLOSEOPN                                        0154 00177000
*       IF ERTNCDE=GOODRTN          /* IF NO ERRORS,         @Y30OE95*/ 00178000
*         THEN                      /* CONTINUE              @Y30OE95*/ 00179000
         CLI   ERTNCDE(SETDSKPT),X'00'                             0155 00180000
         BNE   @RF00155                                            0155 00181000
*         DO;                       /*                       @Y30OE95*/ 00182000
*           FIRSTTME=OFF;           /* IND. NOT FIRST TIME   @Y30OE95*/ 00183000
         NI    FIRSTTME(AWORKPTR),B'01111111'                      0157 00184000
*           AMWMLTVL=ON;            /* SET MULTI-VOL IND ON  @Y30OE6D*/ 00185000
         OI    AMWMLTVL(AWORKPTR),B'00010000'                      0158 00186000
*           CALL FINDSCRT;          /* CALL FIND SCRTCH DSKT @Y30OE95*/ 00187000
         BAL   @14,FINDSCRT                                        0159 00188000
*           IF ERTNCDE=GOODRTN      /* WAS ONE FOUND         @Y30OE95*/ 00189000
*             THEN                  /* YES                   @Y30OE95*/ 00190000
         CLI   ERTNCDE(SETDSKPT),X'00'                             0160 00191000
         BNE   @RF00160                                            0160 00192000
*             DO;                   /*                       @Y30OE6D*/ 00193000
*               CALL UPDEBIOB;      /* UPDATE DEB AND IOB    @Y30OE6D*/ 00194000
         BAL   @14,UPDEBIOB                                        0162 00195000
*               AMWDSOPN=ON;        /* SET OPEN IND IN CASE  @Y30OE6D*/ 00196000
*                                                                  0163 00197000
         OI    AMWDSOPN(AWORKPTR),B'01000000'                      0163 00198000
*               /*****************************************************/ 00199000
*               /*                                                   */ 00200000
*               /* OF PERM I/O ERROR                         @Y30OE6D*/ 00201000
*               /* ON 1ST DISKETTE OPEN                      @Y30OE6D*/ 00202000
*               /*                                                   */ 00203000
*               /*****************************************************/ 00204000
*                                                                  0164 00205000
*             END;                  /*                       @Y30OE6D*/ 00206000
*           ELSE                    /*                       @Y30OE6D*/ 00207000
*             DO;                   /*                       @Y30OE6D*/ 00208000
         B     @RC00160                                            0165 00209000
@RF00160 DS    0H                                                  0166 00210000
*               IF ERTNCDE=IOERROR  /* IF PERM I/O ERROR     @Y30OE6D*/ 00211000
*                 THEN              /* OCCURRED, THEN        @Y30OE6D*/ 00212000
         CLI   ERTNCDE(SETDSKPT),X'10'                             0166 00213000
         BNE   @RF00166                                            0166 00214000
*                 ERTNCDQL=PIOE;    /* SET PERM IO QUALIFIER @Y30OE6D*/ 00215000
         MVI   ERTNCDQL(SETDSKPT),X'04'                            0167 00216000
*             END;                  /*                       @Y30OE6D*/ 00217000
@RF00166 DS    0H                                                  0169 00218000
*           EOVPROC=OFF;            /* RESET EOV PROC IND    @Y30OE6D*/ 00219000
@RC00160 NI    EOVPROC(AWORKPTR),B'01111111'                       0169 00220000
*         END;                      /* END OF EOV ROUTINE    @Y30OE95*/ 00221000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 00222000
         B     CE0001@                                             0171 00223000
*     END EOV;                      /* END OF SUBCASE        @Y30OE6D*/ 00224000
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE6D*/ 00225000
*/*                                                          @Y30OE6D*/ 00226000
*/*       CLOSE A PREVIOUSLY OPENED DATA SET ROUTINE.        @Y30OE6D*/ 00227000
*/*                                                          @Y30OE6D*/ 00228000
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE6D*/ 00229000
*                                                                  0173 00230000
*CLOSEDS:                                                          0173 00231000
*     DO;                           /* SUBCASE               @Y30OE6D*/ 00232000
CLOSEDS  DS    0H                                                  0174 00233000
*       CALL CLOSEOPN;              /* GO CLOSE THIS DATASET @Y30OE6D*/ 00234000
         BAL   @14,CLOSEOPN                                        0174 00235000
*       AMWDSOPN=OFF;               /* SET DS OPEN FLAG OFF  @Y30OE6D*/ 00236000
*       AMWMLTVL=OFF;               /* RESET MULTI-VOL IND,  @Y30OE6D*/ 00237000
         NI    AMWDSOPN(AWORKPTR),B'10101111'                      0176 00238000
*       AMWVSEQU=ZERO;              /* ZERO VOL SEQ NO.      @Y30OE6D*/ 00239000
         MVI   AMWVSEQU(AWORKPTR),X'00'                            0177 00240000
*       AMWWTPTI=ZERO;              /* WRITE PROTECT IND,    @Y30OE6D*/ 00241000
         MVI   AMWWTPTI(AWORKPTR),X'00'                            0178 00242000
*       AMWDSSQL=ZERO;              /* DATA SET SECURITY IND @Y30OE6D*/ 00243000
         MVI   AMWDSSQL(AWORKPTR),X'00'                            0179 00244000
*       AMWEXDTE(1)=ZERO;           /* AND EXPIRATION DATE   @Y30OE6D*/ 00245000
         MVI   AMWEXDTE(AWORKPTR),X'00'                            0180 00246000
*       GOTO CE0001@;               /* BRANCH TO END OF CASE         */ 00247000
         B     CE0001@                                             0181 00248000
*     END CLOSEDS;                  /* END OF SUBCASE        @Y30OE6D*/ 00249000
*CE0001@:                                                          0183 00250000
*   END SETDIN;                     /* END OF CASE           @Y30OE6D*/ 00251000
*                                                                  0184 00252000
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE6D*/ 00253000
*/*                                                          @Y30OE6D*/ 00254000
*/*     THIS ROUTINE CLOSES AN OUTPUT DATA SET WHICH HAS     @Y30OE6D*/ 00255000
*/*     BEEN PREVIOUSLY OPENED BY AN OPEN CALL OR CLOSE      @Y30OE6D*/ 00256000
*/*     THE DATA SET WHEN EOV OCCURRS.                       @Y30OE6D*/ 00257000
*/*     IF THE LAST BUFFER WRITTEN BEFORE THE CLOSE WAS NOT  @Y30OE6D*/ 00258000
*/*     FULL, A NOOPECCW WILL BE SOMEWHERE IN THE MIDDLE OF  @Y30OE6D*/ 00259000
*/*     THE CCW CHAIN AND MUST BE REPLACED WITH THE OLD      @Y30OE6D*/ 00260000
*/*     RWCCW.                                               @Y30OE6D*/ 00261000
*/*                                                          @Y30OE6D*/ 00262000
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE6D*/ 00263000
*                                                                  0184 00264000
*CLOSEOPN:                          /*                       @Y30OE6D*/ 00265000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30OE95*/ 00266000
@EL00001 L     @13,4(,@13)                                         0184 00267000
@EF00001 L     @00,@SIZDATD                                        0184 00268000
         LR    @01,@09                                             0184 00269000
         FREEMAIN R,LV=(0),A=(1)                                        00270000
@ER00001 LM    @14,@12,12(@13)                                     0184 00271000
         BR    @14                                                 0184 00272000
CLOSEOPN ST    @14,@SA00002                                        0184 00273000
*   CHANPGM(1,1)=NOOP;              /* RESTORE NOOPBCCW      @Y30OE6D*/ 00274000
         MVI   CHANPGM(CHNPGMPT),X'03'                             0185 00275000
*   I=((CCWPTR-CHNPGMPT)/EIGHT)+ONE;/*                       @Y30OE95*/ 00276000
         L     @00,CCWPTR-1(,AWORKPTR)                             0186 00277000
         ICM   @00,8,@CB01893                                      0186 00278000
         SLR   @00,CHNPGMPT                                        0186 00279000
         SRDA  @00,32                                              0186 00280000
         D     @00,@CF01815                                        0186 00281000
         AL    @01,@CF01817                                        0186 00282000
         ST    @01,I(,AWORKPTR)                                    0186 00283000
*   IF I>=3&                        /* TEST IF A CCW NEEDS   @Z30OE73*/ 00284000
*       CHANPGM(I,1)=NOOP           /* TO BE SWAPPED TO      @Z30OE73   00285000
*                                      RESTORE THE CCW CHAIN @Z30OE73*/ 00286000
*     THEN                          /* THE 3 RD CCW, THEN    @Y30OE6D*/ 00287000
         C     @01,@CF00217                                        0187 00288000
         BL    @RF00187                                            0187 00289000
         SLA   @01,3                                               0187 00290000
         ST    @01,@TF00001                                        0187 00291000
         ALR   @01,CHNPGMPT                                        0187 00292000
         AL    @01,@CF02104                                        0187 00293000
         CLI   CHANPGM(@01),X'03'                                  0187 00294000
         BNE   @RF00187                                            0187 00295000
*     DO;                           /* RESTORE CCW CHAIN     @Y30OE6D*/ 00296000
*       NOOPESAV=CHANPGM(29);       /* SAVE NOOPE CCW        @Y30OE6D*/ 00297000
         MVC   NOOPESAV(8,AWORKPTR),CHANPGM+224(CHNPGMPT)          0189 00298000
*       CHANPGM(29)=CHANPGM(I);     /* SAVE LAST CCW         @Y30OE6D*/ 00299000
         LR    @11,CHNPGMPT                                        0190 00300000
         AL    @11,@TF00001                                        0190 00301000
         AL    @11,@CF02104                                        0190 00302000
         MVC   @TS00001(8),CHANPGM(@11)                            0190 00303000
         MVC   CHANPGM+224(8,CHNPGMPT),@TS00001                    0190 00304000
*       CHANPGM(I)=NOOPESAV;        /* REPLACE WITH NOOPE    @Y30OE6D*/ 00305000
         LR    @11,CHNPGMPT                                        0191 00306000
         AL    @11,@TF00001                                        0191 00307000
         AL    @11,@CF02104                                        0191 00308000
         MVC   CHANPGM(8,@11),NOOPESAV(AWORKPTR)                   0191 00309000
*     END;                          /*                       @Y30OE6D*/ 00310000
*                                                                  0192 00311000
*   /*****************************************************************/ 00312000
*   /*                                                               */ 00313000
*   /* TEST THE DCB FOR A PERMANENT I/O ERROR. IF SAME       @Y30OE6D*/ 00314000
*   /* OCCURRED ON THIS DISKETTE, BYPASS WRITING THE         @Y30OE6D*/ 00315000
*   /* HDR1 LABEL FOR THIS DATA SET AS IT WILL BE RE-        @Y30OE6D*/ 00316000
*   /* WRITTEN ON A NEW DISKETTE.                            @Y30OE6D*/ 00317000
*   /*                                                               */ 00318000
*   /*****************************************************************/ 00319000
*                                                                  0193 00320000
*   IF DCBIFEC^=PERMIOER            /* IF NO PERMANENT I/O   @Y30OE6D*/ 00321000
*     THEN                          /* ERROR OCCURRED ON PUT @Y30OE6D*/ 00322000
*                                                                  0193 00323000
@RF00187 TM    DCBIFEC+40(DCBPTR),B'11000000'                      0193 00324000
         BO    @RF00193                                            0193 00325000
*     /***************************************************************/ 00326000
*     /*                                                             */ 00327000
*     /* THEN CONTINUE                                       @Y30OE6D*/ 00328000
*     /* FIND A HDR1 SLOT ON THE LABEL TRACK, THEN BUILD     @Y30OE6D*/ 00329000
*     /* AND WRITE THE HDR1 LABEL IN THE EMPTY SLOT FOUND.   @Y30OE6D*/ 00330000
*     /*                                                             */ 00331000
*     /***************************************************************/ 00332000
*                                                                  0194 00333000
*     CALL FORMHDR1;                /* GO BUILD HDR1 LABEL   @Y30OE6D*/ 00334000
         BAL   @14,FORMHDR1                                        0194 00335000
*   ELSE                            /* PERM ERR OCCURED      @Z30OE73*/ 00336000
*     DCBIFEC=OFF;                  /* RESET PERM I/O IND    @Y30OE6D*/ 00337000
         B     @RC00193                                            0195 00338000
@RF00193 NI    DCBIFEC+40(DCBPTR),B'00111111'                      0195 00339000
*   END CLOSEOPN;                   /* END OF CLOSE ROUT.    @Y30OE95*/ 00340000
@EL00002 DS    0H                                                  0196 00341000
@EF00002 DS    0H                                                  0196 00342000
@ER00002 L     @14,@SA00002                                        0196 00343000
         BR    @14                                                 0196 00344000
*                                                                  0197 00345000
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE95*/ 00346000
*/*                                                          @Y30OE95*/ 00347000
*/*  THIS PROCEDURE READS IN THE LABEL TRACK (TRACK 0) OF A  @Y30OE95*/ 00348000
*/*  DISKETTE. IT MAY ALSO CAUSE ANOTHER DISKETTE TO BE FED  @Y30OE95*/ 00349000
*/*  INTO THE READER. UPON ENTRY, THE 'FEEDCODE' BYTE OF THE @Y30OE95*/ 00350000
*/*  WORKAREA CONTAINS EITHER A '00'X IF ONLY A READ IS      @Y30OE95*/ 00351000
*/*  WANTED OR A '10'X IF A FEED/READ IS WANTED.             @Y30OE95*/ 00352000
*/*                                                          @Y30OE95*/ 00353000
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE95*/ 00354000
*                                                                  0197 00355000
*RDLABTRK:                          /*                       @Y30OE95*/ 00356000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30OE95*/ 00357000
*                                                                  0197 00358000
RDLABTRK ST    @14,@SA00003                                        0197 00359000
*   /*****************************************************************/ 00360000
*   /*                                                               */ 00361000
*   /* CHANGE NOOPCCWB TO A DFN OPS CCW                      @Y30OE95*/ 00362000
*   /*                                                               */ 00363000
*   /*****************************************************************/ 00364000
*                                                                  0198 00365000
*   CHANPGM(1,1:8)=CCWD1;           /* PUT DFNOP CCW IN CHN  @Y30OE6D*/ 00366000
         MVC   CHANPGM(8,CHNPGMPT),CCWD1                           0198 00367000
*   IOBSKADR=VOL1ADDR;              /* POINT TO TRK 0, REC 7 @Y30OE6D*/ 00368000
*                                                                  0199 00369000
         MVC   IOBSKADR(4,IOBSTPTR),VOL1ADDR                       0199 00370000
*   /*****************************************************************/ 00371000
*   /*                                                               */ 00372000
*   /* CHANGE THE CCW COUNT FIELD TO EIGHTY AND CHANGE THE   @Y30OE6D*/ 00373000
*   /* CCW OPCODES TO READS.                                 @Y30OE6D*/ 00374000
*   /*                                                               */ 00375000
*   /*****************************************************************/ 00376000
*                                                                  0200 00377000
*   DO I=3 TO 22;                   /* SET LOOP FOR RWCCW1   @Y30OE95   00378000
*                                      TO RWCCW20            @Y30OE95*/ 00379000
         LA    @11,3                                               0200 00380000
         ST    @11,I(,AWORKPTR)                                    0200 00381000
@DL00200 DS    0H                                                  0201 00382000
*     CHANPGM(I,7:8)=COUNT80;       /* SET BYTECOUNT = 80    @Y30OE6D*/ 00383000
         L     @11,I(,AWORKPTR)                                    0201 00384000
         SLA   @11,3                                               0201 00385000
         LH    @08,COUNT80                                         0201 00386000
         ST    @11,@TF00001                                        0201 00387000
         ALR   @11,CHNPGMPT                                        0201 00388000
         BCTR  @11,0                                               0201 00389000
         BCTR  @11,0                                               0201 00390000
         STCM  @08,3,CHANPGM(@11)                                  0201 00391000
*     CHANPGM(I,1)=READOP;          /* CHNG OPCODE TO READ   @Y30OE6D*/ 00392000
         LR    @11,CHNPGMPT                                        0202 00393000
         AL    @11,@TF00001                                        0202 00394000
         AL    @11,@CF02104                                        0202 00395000
         MVI   CHANPGM(@11),X'06'                                  0202 00396000
*   END;                            /*                       @Y30OE95*/ 00397000
*                                                                  0203 00398000
         LA    @11,1                                               0203 00399000
         AL    @11,I(,AWORKPTR)                                    0203 00400000
         ST    @11,I(,AWORKPTR)                                    0203 00401000
         C     @11,@CF01653                                        0203 00402000
         BNH   @DL00200                                            0203 00403000
*   /*****************************************************************/ 00404000
*   /*                                                               */ 00405000
*   /* CHANGE RWCCW21 TO DFNOPS CCW                          @Y30OE95*/ 00406000
*   /*                                                               */ 00407000
*   /*****************************************************************/ 00408000
*                                                                  0204 00409000
*   CCW21SAV=CHANPGM(23);           /* SAVE RWCCW21          @Y30OE95*/ 00410000
         MVC   CCW21SAV(8,AWORKPTR),CHANPGM+176(CHNPGMPT)          0204 00411000
*   CHANPGM(23,1:8)=CCWD2;          /* POINT TO OUTPUT CCW   @Y30OE6D*/ 00412000
         MVC   CHANPGM+176(8,CHNPGMPT),CCWD2                       0205 00413000
*                                                                  0206 00414000
*   /*****************************************************************/ 00415000
*   /*                                                               */ 00416000
*   /* IF THIS IS A READ/FEED REQUEST THEN CHANGE RWCCW26    @Y30OE95*/ 00417000
*   /* TO A FEED CCW AND BUILD A TIC IN NOOPCCWE TO          @Y30OE95*/ 00418000
*   /* NOOPCCWB                                              @Y30OE95*/ 00419000
*   /*                                                               */ 00420000
*   /*****************************************************************/ 00421000
*                                                                  0206 00422000
*   IF FEEDCODE=ON                  /* READ/FEED REQUEST?    @Y30OE6D*/ 00423000
*     THEN                          /* YES                   @Y30OE95*/ 00424000
         TM    FEEDCODE(AWORKPTR),B'01000000'                      0206 00425000
         BNO   @RF00206                                            0206 00426000
*     DO;                           /* CONTINUE              @Y30OE95*/ 00427000
*       SAVEVOL=''B;                /* ZERO VOL SER          @Y30OE6D*/ 00428000
         XC    SAVEVOL(6,AWORKPTR),SAVEVOL(AWORKPTR)               0208 00429000
*       CALL UCBUPDAT;              /* GO UPDATE UCB         @Y30OE6D*/ 00430000
         BAL   @14,UCBUPDAT                                        0209 00431000
*       CCW26SAV=CHANPGM(28);       /* SAVE RWCCW26          @Y30OE95*/ 00432000
         MVC   CCW26SAV(8,AWORKPTR),CHANPGM+216(CHNPGMPT)          0210 00433000
*       NOOPESAV=CHANPGM(29);       /* SAVE NOOPCCWE         @Y30OE95*/ 00434000
         MVC   NOOPESAV(8,AWORKPTR),CHANPGM+224(CHNPGMPT)          0211 00435000
*       CHANPGM(28,1)=FEEDOP;       /* CHANGE RWCCW26 TO A   @Y30OE6D   00436000
*                                      FEEDCCW               @Y30OE95*/ 00437000
         MVI   CHANPGM+216(CHNPGMPT),X'17'                         0212 00438000
*       CHANPGM(28,5)=CCSILI;       /* CHAIN CCW'S           @Y30OE6D*/ 00439000
         MVI   CHANPGM+220(CHNPGMPT),X'60'                         0213 00440000
*       CHANPGM(29,1:4)=ADDR(CHANPGM(1));/* NOOPB ADR        @Y30OE95   00441000
*                                      IN NOOPE              @Y30OE95*/ 00442000
         STCM  CHNPGMPT,15,CHANPGM+224(CHNPGMPT)                   0214 00443000
*       CHANPGM(29,1)=TICOP;        /* TIC OPCODE            @Y30OE6D*/ 00444000
         MVI   CHANPGM+224(CHNPGMPT),X'08'                         0215 00445000
*       IOBSTRTB=ADDR(CHANPGM(28)); /* CHANGE CHAN PGM       @Y30OE95   00446000
*                                      PTR IN IOB            @Y30OE95*/ 00447000
         LA    @11,CHANPGM+216(,CHNPGMPT)                          0216 00448000
         STCM  @11,7,IOBSTRTB(IOBSTPTR)                            0216 00449000
*     END;                          /*                       @Y30OE95*/ 00450000
*                                                                  0218 00451000
*   /*****************************************************************/ 00452000
*   /*                                                               */ 00453000
*   /* ISSUE EXCP TO READ IN LABEL TRACK                     @Y30OE95*/ 00454000
*   /*                                                               */ 00455000
*   /*****************************************************************/ 00456000
*                                                                  0218 00457000
*   CALL IOSBRTN;                   /* GO DO EXCP            @Y30OE95*/ 00458000
*                                                                  0218 00459000
@RF00206 BAL   @14,IOSBRTN                                         0218 00460000
*   /*****************************************************************/ 00461000
*   /*                                                               */ 00462000
*   /* RESTORE CCW CHAIN TO INITIAL FORM                     @Y30OE95*/ 00463000
*   /*                                                               */ 00464000
*   /*****************************************************************/ 00465000
*                                                                  0219 00466000
*   IF FEEDCODE=ON                  /* READ/FEED REQUEST?    @Y30OE6D*/ 00467000
*     THEN                          /* YES                   @Y30OE95*/ 00468000
         TM    FEEDCODE(AWORKPTR),B'01000000'                      0219 00469000
         BNO   @RF00219                                            0219 00470000
*     DO;                           /* CONTINUE              @Y30OE95*/ 00471000
*       CHANPGM(28)=CCW26SAV;       /* RESTORE RWCCW26       @Y30OE95*/ 00472000
         MVC   CHANPGM+216(8,CHNPGMPT),CCW26SAV(AWORKPTR)          0221 00473000
*       CHANPGM(29)=NOOPESAV;       /* RESTORE NOOPCCWE      @Y30OE95*/ 00474000
         MVC   CHANPGM+224(8,CHNPGMPT),NOOPESAV(AWORKPTR)          0222 00475000
*       IOBSTRTB=ADDR(CHANPGM(1));  /* RSTRE CHAN PGM        @Y30OE95*/ 00476000
         STCM  CHNPGMPT,7,IOBSTRTB(IOBSTPTR)                       0223 00477000
*     END;                          /*                       @Y30OE95*/ 00478000
*   CHANPGM(23)=CCW21SAV;           /* RESTORE RWCCW21       @Y30OE95*/ 00479000
@RF00219 MVC   CHANPGM+176(8,CHNPGMPT),CCW21SAV(AWORKPTR)          0225 00480000
*   CHANPGM(1,1)=NOOP;              /* RESTORE NOOPB CCW     @Y30OE6D*/ 00481000
         MVI   CHANPGM(CHNPGMPT),X'03'                             0226 00482000
*   DO I=3 TO 22;                   /* SET LOOP FOR RWCCW1   @Y30OE6D   00483000
*                                      TO RWCCW20            @Y30OE95*/ 00484000
         LA    @11,3                                               0227 00485000
         ST    @11,I(,AWORKPTR)                                    0227 00486000
@DL00227 DS    0H                                                  0228 00487000
*     CHANPGM(I,1)=WRITEOP;         /* CHNG OPCODE TO WRITE  @Y30OE6D*/ 00488000
         L     @11,I(,AWORKPTR)                                    0228 00489000
         SLA   @11,3                                               0228 00490000
         ALR   @11,CHNPGMPT                                        0228 00491000
         AL    @11,@CF02104                                        0228 00492000
         MVI   CHANPGM(@11),X'05'                                  0228 00493000
*   END;                            /*                       @Y30OE6D*/ 00494000
         LA    @11,1                                               0229 00495000
         AL    @11,I(,AWORKPTR)                                    0229 00496000
         ST    @11,I(,AWORKPTR)                                    0229 00497000
         C     @11,@CF01653                                        0229 00498000
         BNH   @DL00227                                            0229 00499000
*   END RDLABTRK;                   /* END OF SUBROUTINE     @Y30OE6D*/ 00500000
@EL00003 DS    0H                                                  0230 00501000
@EF00003 DS    0H                                                  0230 00502000
@ER00003 L     @14,@SA00003                                        0230 00503000
         BR    @14                                                 0230 00504000
*                                                                  0231 00505000
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE95*/ 00506000
*/*                                                          @Y30OE95*/ 00507000
*/*  THIS SECTION WILL FIND A SCRATCH DISKETTE BY FEEDING    @Y30OE95*/ 00508000
*/*  DISKETTES UNTIL A SCRATCH DISKETTE IS FOUND OR UNTIL    @Y30OE95*/ 00509000
*/*  END OF DISKETTE IS ENCOUNTERRED.  IF THIS ROUTINE IS    @Y30OE95*/ 00510000
*/*  ENTERED FROM OPEN OUTPUT, A DISKETTE HAS ALREADY BEEN   @Y30OE6D*/ 00511000
*/*  READ SO ANOTHER FEED/READ IS NOT NECESSARY UNLESS A     @Y30OE95*/ 00512000
*/*  SECOND DISKETTE NEEDS TO BE CHECKED.                    @Y30OE95*/ 00513000
*/*                                                          @Y30OE95*/ 00514000
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE95*/ 00515000
*                                                                  0231 00516000
*FINDSCRT:                          /*                       @Y30OE95*/ 00517000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30OE95*/ 00518000
FINDSCRT ST    @14,@SA00004                                        0231 00519000
*   SCRCHDSK=OFF;                   /* INIT SCRATCH DSKT OFF @Y30OE95*/ 00520000
         NI    SCRCHDSK(AWORKPTR),B'11110111'                      0232 00521000
*   DO WHILE SCRCHDSK=OFF;          /* LOOP UNTIL SCRATCH    @Y30OE95   00522000
*                                      DSKT IS FOUND         @Y30OE95*/ 00523000
         B     @DE00233                                            0233 00524000
@DL00233 DS    0H                                                  0234 00525000
*     IF FIRSTTME=OFF               /* IS THIS FIRST PASS    @Y30OE95*/ 00526000
*       THEN                        /* NO                    @Y30OE6D*/ 00527000
         TM    FIRSTTME(AWORKPTR),B'10000000'                      0234 00528000
         BNZ   @RF00234                                            0234 00529000
*       DO;                         /*                       @Y30OE6D*/ 00530000
*         FEEDCODE=ON;              /* INDICATE FEED         @Y30OE6D*/ 00531000
         OI    FEEDCODE(AWORKPTR),B'01000000'                      0236 00532000
*         IF AMWMLTVL=OFF           /* IF NOT PROCESSING     @Y30OE6D*/ 00533000
*           THEN                    /* MULTI-VOLUME, THEN    @Y30OE6D*/ 00534000
         TM    AMWMLTVL(AWORKPTR),B'00010000'                      0237 00535000
         BNZ   @RF00237                                            0237 00536000
*           DO;                     /*                       @Y30OE6D*/ 00537000
*             AMWVOLAC=ZERO;        /* RESET VOL ACCESS IND  @Y30OE6D*/ 00538000
         MVI   AMWVOLAC(AWORKPTR),X'00'                            0239 00539000
*             SECURVOL=OFF;         /* RESET SECURE VOL IND  @Y30OE6D*/ 00540000
         NI    SECURVOL(AWORKPTR),B'11110111'                      0240 00541000
*           END;                    /*                       @Y30OE6D*/ 00542000
*       END;                        /*                       @Y30OE6D*/ 00543000
*     ELSE                          /*                       @Y30OE6D*/ 00544000
*       FEEDCODE=OFF;               /* INDICATE NO FEED      @Y30OE6D*/ 00545000
         B     @RC00234                                            0243 00546000
@RF00234 NI    FEEDCODE(AWORKPTR),B'10111111'                      0243 00547000
*     CALL RDLABTRK;                /* GO READ LABEL TRACK   @Y30OE6D*/ 00548000
@RC00234 BAL   @14,RDLABTRK                                        0244 00549000
*     FIRSTTME=OFF;                 /* TURN OFF 1ST TIME IND @Y30OE95*/ 00550000
         NI    FIRSTTME(AWORKPTR),B'01111111'                      0245 00551000
*     IF ERTNCDE=GOODRTN            /* ANY ERRORS            @Y30OE95*/ 00552000
*       THEN                        /* NO                    @Y30OE95*/ 00553000
         CLI   ERTNCDE(SETDSKPT),X'00'                             0246 00554000
         BNE   @RF00246                                            0246 00555000
*       DO;                         /* CONTINUE              @Y30OE95*/ 00556000
*                                                                  0247 00557000
*         /***********************************************************/ 00558000
*         /*                                                         */ 00559000
*         /* CHECK FOR VALID VOL1 LABEL AND FOR END-OF-DISKETTE      */ 00560000
*         /*                                                 @Y30OE95*/ 00561000
*         /*                                                         */ 00562000
*         /***********************************************************/ 00563000
*                                                                  0248 00564000
*         CALL VOL1LABL;            /* GO CHECK VOL1 LABEL   @Y30OE95*/ 00565000
         BAL   @14,VOL1LABL                                        0248 00566000
*         IF ERTNCDE=GOODRTN        /* IS VOL1 LABEL OK      @Y30OE95*/ 00567000
*           THEN                    /* YES                   @Y30OE95*/ 00568000
         CLI   ERTNCDE(SETDSKPT),X'00'                             0249 00569000
         BNE   @RF00249                                            0249 00570000
*                                                                  0250 00571000
*           /*********************************************************/ 00572000
*           /*                                                       */ 00573000
*           /* CHECK IF DISKETTE IS SCRATCH                  @Y30OE95*/ 00574000
*           /*                                                       */ 00575000
*           /*********************************************************/ 00576000
*                                                                  0250 00577000
*           CALL CKSCRDSK;          /* GO CHECK IF THIS IS A @Y30OE95   00578000
*                                      SCRATCH DISKETTE      @Y30OE95*/ 00579000
         BAL   @14,CKSCRDSK                                        0250 00580000
*         ELSE                      /*                       @Y30OE95*/ 00581000
*           IF ERTNCDE=ENDDISK      /* END OF DSKT?          @Y30OE6D*/ 00582000
*             THEN                  /* YES                   @Y30OE95*/ 00583000
         B     @RC00249                                            0251 00584000
@RF00249 CLI   ERTNCDE(SETDSKPT),X'14'                             0251 00585000
         BNE   @RF00251                                            0251 00586000
*             SCRCHDSK=ON;          /* TURN ON SCRATCH DSK   @Y30OE95*/ 00587000
         OI    SCRCHDSK(AWORKPTR),B'00001000'                      0252 00588000
*           ELSE                    /*                       @Y30OE95*/ 00589000
*             SETRETCD=''B;         /* SET CODE TO END LOOP  @Y30OE6D*/ 00590000
         B     @RC00251                                            0253 00591000
@RF00251 XC    SETRETCD(2,SETDSKPT),SETRETCD(SETDSKPT)             0253 00592000
*       END;                        /*                       @Y30OE95*/ 00593000
*     ELSE                          /*                       @Y30OE95*/ 00594000
*       SCRCHDSK=ON;                /* TURN ON SCRATCH DSK   @Y30OE95   00595000
*                                      FLAG TO END LOOP      @Y30OE95*/ 00596000
         B     @RC00246                                            0255 00597000
@RF00246 OI    SCRCHDSK(AWORKPTR),B'00001000'                      0255 00598000
*   END;                            /*                       @Y30OE95*/ 00599000
@RC00246 DS    0H                                                  0256 00600000
@DE00233 TM    SCRCHDSK(AWORKPTR),B'00001000'                      0256 00601000
         BZ    @DL00233                                            0256 00602000
*   IF ERTNCDE=GOODRTN              /* ANY ERRORS            @Y30OE95*/ 00603000
*     THEN                          /* NO                    @Y30OE95*/ 00604000
*                                                                  0257 00605000
         CLI   ERTNCDE(SETDSKPT),X'00'                             0257 00606000
         BNE   @RF00257                                            0257 00607000
*     /***************************************************************/ 00608000
*     /*                                                             */ 00609000
*     /* BLANK OUT HDR1 LABEL OF THE SCRATCH DISKETTE FOR    @Y30OE95*/ 00610000
*     /* SECURITY PURPOSES.                                  @Y30OE95*/ 00611000
*     /*                                                             */ 00612000
*     /***************************************************************/ 00613000
*                                                                  0258 00614000
*     CALL BLANKHDR;                /* GO BLANK OUT HDR1     @Y30OE95*/ 00615000
         BAL   @14,BLANKHDR                                        0258 00616000
*   END FINDSCRT;                   /* END OF SUBROUTINE     @Y30OE95*/ 00617000
@EL00004 DS    0H                                                  0259 00618000
@EF00004 DS    0H                                                  0259 00619000
@ER00004 L     @14,@SA00004                                        0259 00620000
         BR    @14                                                 0259 00621000
*                                                                  0260 00622000
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE95*/ 00623000
*/*                                                          @Y30OE95*/ 00624000
*/*  THIS SECTION WILL DETERMINE IF THERE IS ENOUGH SPACE ON @Y30OE95*/ 00625000
*/*  A DISKETTE AND IF THERE IS A BLANK HDR1 TO BE USED FOR  @Y30OE95*/ 00626000
*/*  A DATA SET IF MULTI-DATA SETS PER DISKETTE ARE ALLOWED. @Y30OE95*/ 00627000
*/*  SEARCH THROUGH HDR1 LABELS UNTIL A DELETED HDR1 IS      @Y30OE95*/ 00628000
*/*  FOUND OR UNTIL ALL HDR1'S ARE CHECKED. IF A DELETED     @Y30OE95*/ 00629000
*/*  DATA SET IS FOUND CHECK THAT THERE IS AT LEAST 1 FREE   @Y30OE95*/ 00630000
*/*  TRACK TO BEGIN WRITING ON.                              @Y30OE95*/ 00631000
*/*                                                          @Y30OE95*/ 00632000
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE95*/ 00633000
*                                                                  0260 00634000
*FINDHDR1:                          /*                       @Y30OE95*/ 00635000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30OE95*/ 00636000
FINDHDR1 ST    @14,@SA00005                                        0260 00637000
*   I=1;                            /* INITIALIZE I TO 1     @Y30OE95*/ 00638000
         MVC   I(4,AWORKPTR),@CF00037                              0261 00639000
*   BLKHDRFG=OFF;                   /* SET BLANK HDR FLG OFF @Y30OE95*/ 00640000
*   DUPDSID=OFF;                    /* SET DUP DSID IND OFF  @Y30OE6D*/ 00641000
         NI    BLKHDRFG(AWORKPTR),B'11111100'                      0263 00642000
*   DO WHILE BLKHDRFG=OFF&          /* LOOP UNTIL BLANK HDR  @Y30OE95*/ 00643000
*         I<=19;                    /* IS FOUND OR END.      @Y30OE95*/ 00644000
         B     @DE00264                                            0264 00645000
@DL00264 DS    0H                                                  0265 00646000
*     HDR1PTR=CHANPGM(I+3,2:4);     /* GET PTR TO 1ST HDR1   @Y30OE95*/ 00647000
         L     @11,I(,AWORKPTR)                                    0265 00648000
         SLA   @11,3                                               0265 00649000
         L     HDR1PTR,CHANPGM+16(@11,CHNPGMPT)                    0265 00650000
         LA    HDR1PTR,0(,HDR1PTR)                                 0265 00651000
*     IF HDRID=DDR1                 /* IS THIS A BLANK HDR1  @Y30OE95*/ 00652000
*       THEN                        /* YES                   @Y30OE95*/ 00653000
         CLC   HDRID(4,HDR1PTR),DDR1                               0266 00654000
         BNE   @RF00266                                            0266 00655000
*       BLKHDRFG=ON;                /* IND BLANK HDR FOUND   @Y30OE95*/ 00656000
         OI    BLKHDRFG(AWORKPTR),B'00000010'                      0267 00657000
*     ELSE                          /*                       @Y30OE95*/ 00658000
*       DO;                         /*                       @Y30OE6D*/ 00659000
         B     @RC00266                                            0268 00660000
@RF00266 DS    0H                                                  0269 00661000
*         IF HDRDSID=SDKTDSID       /* DOES EQ DSIDS EXIST ? @Y30OE6D*/ 00662000
*           THEN                    /*                       @Y30OE6D*/ 00663000
         CLC   HDRDSID(8,HDR1PTR),SDKTDSID(SETDSKPT)               0269 00664000
         BNE   @RF00269                                            0269 00665000
*           DO;                     /* YES                   @Y30OE6D*/ 00666000
*             DUPDSID=ON;           /* SET DUPLICATE DS IND  @Y30OE6D*/ 00667000
*             BLKHDRFG=ON;          /* SET BLANK HDR IND ON  @Y30OE6D*/ 00668000
         OI    DUPDSID(AWORKPTR),B'00000011'                       0272 00669000
*             MSGINDEX=DUPMSG;      /* SET INDEX FOR MSG 27  @Y30OE6D*/ 00670000
         MVI   MSGINDEX(AWORKPTR),X'1B'                            0273 00671000
*             CALL MSGSUBRT;        /* CALL THE MSG SUBROUT. @Y30OE6D*/ 00672000
         BAL   @14,MSGSUBRT                                        0274 00673000
*           END;                    /*                       @Y30OE6D*/ 00674000
*         I=I+1;                    /* ADD 1 TO I            @Y30OE95*/ 00675000
@RF00269 LA    @11,1                                               0276 00676000
         AL    @11,I(,AWORKPTR)                                    0276 00677000
         ST    @11,I(,AWORKPTR)                                    0276 00678000
*       END;                        /*                       @Y30OE6D*/ 00679000
*   END;                            /*                       @Y30OE95*/ 00680000
@RC00266 DS    0H                                                  0278 00681000
@DE00264 TM    BLKHDRFG(AWORKPTR),B'00000010'                      0278 00682000
         BNZ   @DC00264                                            0278 00683000
         CLC   I(4,AWORKPTR),@CF01976                              0278 00684000
         BNH   @DL00264                                            0278 00685000
@DC00264 DS    0H                                                  0279 00686000
*   IF I^=1                         /* IS 1ST HDR BLANK      @Y30OE95*/ 00687000
*     THEN                          /* NO                    @Y30OE95*/ 00688000
         L     @11,I(,AWORKPTR)                                    0279 00689000
         C     @11,@CF00037                                        0279 00690000
         BE    @RF00279                                            0279 00691000
*     DO;                           /* CONTINUE              @Y30OE95*/ 00692000
*       HDR1PTR=CHANPGM(I+2,2:4);   /* POINT TO PREVIOUS     @Y30OE95   00693000
*                                      HDR1                  @Y30OE95*/ 00694000
         LR    @08,@11                                             0281 00695000
         SLA   @08,3                                               0281 00696000
         L     HDR1PTR,CHANPGM+8(@08,CHNPGMPT)                     0281 00697000
         LA    HDR1PTR,0(,HDR1PTR)                                 0281 00698000
*       IF I>19|                    /* IF NO BLANK HDRS      @Y30OE95*/ 00699000
*           HDREOECC>=TRK73|        /* FOUND OR PREV HDR     @Y30OE6D   00700000
*                                      DATA SET USED TRK 73  @Y30OE6D*/ 00701000
*           DUPDSID=ON              /* OR DUP DSID FOUND     @Y30OE6D*/ 00702000
*         THEN                      /* YES                   @Y30OE95*/ 00703000
         C     @11,@CF01976                                        0282 00704000
         BH    @RT00282                                            0282 00705000
         CLC   HDREOECC(2,HDR1PTR),TRK73                           0282 00706000
         BNL   @RT00282                                            0282 00707000
         TM    DUPDSID(AWORKPTR),B'00000001'                       0282 00708000
         BNO   @RF00282                                            0282 00709000
@RT00282 DS    0H                                                  0283 00710000
*                                                                  0283 00711000
*         /***********************************************************/ 00712000
*         /*                                                         */ 00713000
*         /* IF THIS DISKETTE CONTAINS NO DELETED HDR1'S, NO @Y30OE6D*/ 00714000
*         /* SPACE TO WRITE A DATA SET OR A DUPLICATE DATA   @Y30OE6D*/ 00715000
*         /* SET WAS FOUND, THEN FIND A SCRATCH DISKETTE.    @Y30OE6D*/ 00716000
*         /*                                                         */ 00717000
*         /***********************************************************/ 00718000
*                                                                  0283 00719000
*         CALL FINDSCRT;            /* GO FIND SCRATCH DISKT @Y30OE95*/ 00720000
         BAL   @14,FINDSCRT                                        0283 00721000
*       ELSE                        /*                       @Y30OE95*/ 00722000
*         HDR1PTR=CHANPGM(I+3,2:4); /* GET PTR TO HDR        @Y30OE95*/ 00723000
         B     @RC00282                                            0284 00724000
@RF00282 L     @11,I(,AWORKPTR)                                    0284 00725000
         SLA   @11,3                                               0284 00726000
         L     HDR1PTR,CHANPGM+16(@11,CHNPGMPT)                    0284 00727000
         LA    HDR1PTR,0(,HDR1PTR)                                 0284 00728000
*     END;                          /*                       @Y30OE95*/ 00729000
*   END FINDHDR1;                   /* END OF SUBROUTINE     @Y30OE95*/ 00730000
@EL00005 DS    0H                                                  0286 00731000
@EF00005 DS    0H                                                  0286 00732000
@ER00005 L     @14,@SA00005                                        0286 00733000
         BR    @14                                                 0286 00734000
*                                                                  0287 00735000
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE95*/ 00736000
*/*                                                          @Y30OE95*/ 00737000
*/*  THIS SECTION WILL FIND A SLOT FOR THE HDR1 LABEL,       @Y30OE6D*/ 00738000
*/*  THEN CREATE A HDR1 LABEL DESCRIBING THE DATA SET        @Y30OE6D*/ 00739000
*/*  BEING CLOSED. IT WILL BE CREATED IN THE EMPTY           @Y30OE6D*/ 00740000
*/*  SLOT FOUND AND POINTED TO BY HDR1PTR.                   @Y30OE6D*/ 00741000
*/*                                                          @Y30OE95*/ 00742000
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE95*/ 00743000
*                                                                  0287 00744000
*FORMHDR1:                          /*                       @Y30OE95*/ 00745000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30OE95*/ 00746000
FORMHDR1 ST    @14,@SA00006                                        0287 00747000
*   SAVESEEK=IOBSKADR;              /* SAVE IOBSEEK FROM     @Y30OE95   00748000
*                                      LAST PUT              @Y30OE95*/ 00749000
         MVC   SAVESEEK(4,AWORKPTR),IOBSKADR(IOBSTPTR)             0288 00750000
*   FEEDCODE=OFF;                   /* INDICATE NOFEED       @Y30OE6D*/ 00751000
         NI    FEEDCODE(AWORKPTR),B'10111111'                      0289 00752000
*   CALL RDLABTRK;                  /* GO READ LABEL TRK     @Y30OE95*/ 00753000
         BAL   @14,RDLABTRK                                        0290 00754000
*   IF ERTNCDE=GOODRTN              /* ANY ERRORS            @Y30OE95*/ 00755000
*     THEN                          /* NO                    @Y30OE95*/ 00756000
         CLI   ERTNCDE(SETDSKPT),X'00'                             0291 00757000
         BNE   @RF00291                                            0291 00758000
*     DO;                           /* CONTINUE              @Y30OE95*/ 00759000
*                                                                  0292 00760000
*       /*************************************************************/ 00761000
*       /*                                                           */ 00762000
*       /* GO THROUGH HDR1'S UNTIL ONE IS FOUND WITH "DDR1"  @Y30OE95*/ 00763000
*       /* IN THE HDRID FIELD.                               @Y30OE95*/ 00764000
*       /*                                                           */ 00765000
*       /*************************************************************/ 00766000
*                                                                  0293 00767000
*       HDR1PTR=CHANPGM(4,2:4);     /* GET PTR TO 1ST HDR1   @Y30OE6D*/ 00768000
         SLR   HDR1PTR,HDR1PTR                                     0293 00769000
         ICM   HDR1PTR,7,CHANPGM+25(CHNPGMPT)                      0293 00770000
*       DO I=4 TO 22                /* SET LOOP FOR 19 HDR1S @Y30OE95*/ 00771000
*             WHILE HDRID^=DDR1;    /* UNTIL SECTOR IS FOUND @Y30OE6D*/ 00772000
         LA    @11,4                                               0294 00773000
         ST    @11,I(,AWORKPTR)                                    0294 00774000
@DL00294 CLC   HDRID(4,HDR1PTR),DDR1                               0294 00775000
         BE    @DC00294                                            0294 00776000
*         HDR1PTR=CHANPGM(I,2:4);   /* GET PTR TO HDR1       @Y30OE95*/ 00777000
         L     @11,I(,AWORKPTR)                                    0295 00778000
         SLA   @11,3                                               0295 00779000
         AL    @11,@CF02104                                        0295 00780000
         L     HDR1PTR,CHANPGM(@11,CHNPGMPT)                       0295 00781000
         LA    HDR1PTR,0(,HDR1PTR)                                 0295 00782000
*       END;                        /*                       @Y30OE95*/ 00783000
*                                                                  0296 00784000
         LA    @11,1                                               0296 00785000
         AL    @11,I(,AWORKPTR)                                    0296 00786000
         ST    @11,I(,AWORKPTR)                                    0296 00787000
         C     @11,@CF01653                                        0296 00788000
         BNH   @DL00294                                            0296 00789000
@DC00294 DS    0H                                                  0297 00790000
*       /*************************************************************/ 00791000
*       /*                                                           */ 00792000
*       /* UPDATE CCW CHAIN TO WRITE ONE TRACK.              @Y30OE6D*/ 00793000
*       /*                                                           */ 00794000
*       /*************************************************************/ 00795000
*                                                                  0297 00796000
*       CHANPGM(1)=CCWD3;           /* PUT DFNOP CCW IN CHN  @Y30OE6D*/ 00797000
         MVC   CHANPGM(8,CHNPGMPT),CCWD3                           0297 00798000
*       CCW21SAV=CHANPGM(23);       /* SAVE RWCCW23          @Y30OE6D*/ 00799000
         MVC   CCW21SAV(8,AWORKPTR),CHANPGM+176(CHNPGMPT)          0298 00800000
*       CHANPGM(23)=CHANPGM(29);    /* SWAP CCW'S            @Y30OE6D*/ 00801000
         MVC   CHANPGM+176(8,CHNPGMPT),CHANPGM+224(CHNPGMPT)       0299 00802000
*       HDR13540='';                /* BLANK HDR1 LABEL      @Y30OE6D*/ 00803000
         MVI   HDR13540(HDR1PTR),C' '                              0300 00804000
         MVC   HDR13540+1(79,HDR1PTR),HDR13540(HDR1PTR)            0300 00805000
*       HDRID=HDR1;                 /* FILL IN 'HDR1'        @Y30OE95*/ 00806000
         MVC   HDRID(4,HDR1PTR),HDR1                               0301 00807000
*       HDRDSID=SDKTDSID;           /* FILL IN DATA SET ID   @Y30OE95*/ 00808000
         MVC   HDRDSID(8,HDR1PTR),SDKTDSID(SETDSKPT)               0302 00809000
*       IF AMWMLTVL=OFF             /* IF NOT MULTI-VOLUME   @Y30OE6D*/ 00810000
*         THEN                      /* PROCESSING AND        @Y30OE6D*/ 00811000
         TM    AMWMLTVL(AWORKPTR),B'00010000'                      0303 00812000
         BNZ   @RF00303                                            0303 00813000
*         IF ACBSECUR=ON            /* SECURITY PROCESSING   @Y30OE95*/ 00814000
*           THEN                    /* SPECIFIED, THEN       @Y30OE95*/ 00815000
         TM    ACBSECUR(AWORKPTR),B'01000000'                      0304 00816000
         BNO   @RF00304                                            0304 00817000
*           CALL SECRPROC;          /* CALL SECURITY PROC    @Y30OE95*/ 00818000
         BAL   @14,SECRPROC                                        0305 00819000
*       IOBSKADR=SAVESEEK;          /* RESTORE LAST PUT SEEK @Y30OE95*/ 00820000
@RF00304 DS    0H                                                  0306 00821000
@RF00303 MVC   IOBSKADR(4,IOBSTPTR),SAVESEEK(AWORKPTR)             0306 00822000
*       CVD(ACBLRECL,CONVERT);      /* GET PACKED REC LENGTH @Y30OE95*/ 00823000
         LH    @11,ACBLRECL(,AWORKPTR)                             0307 00824000
         CVD   @11,@TS00001                                        0307 00825000
         MVC   CONVERT(4,AWORKPTR),@TS00001+4                      0307 00826000
*       UNPK(HDRBLKLN,CONVERT);     /* PUT EBCDIC REC LENGTH @Y30OE95   00827000
*                                      IN HDR1               @Y30OE95*/ 00828000
         UNPK  HDRBLKLN(5,HDR1PTR),CONVERT(4,AWORKPTR)             0308 00829000
*       HDRBLKLN(5)=HDRBLKLN(5)|CHAR0;/* CHANGE SIGN         @Y30OE6D*/ 00830000
         OI    HDRBLKLN+4(HDR1PTR),C'0'                            0309 00831000
*                                                                  0310 00832000
*       /*************************************************************/ 00833000
*       /*                                                           */ 00834000
*       /* GO FIND EXTENTS (BOE,EOE,EOD) OF THE DATA SET.    @Y30OE95*/ 00835000
*       /*                                                           */ 00836000
*       /*************************************************************/ 00837000
*                                                                  0310 00838000
*       CALL CALCEXTS;              /* CALC EXTENTS FOR HDR  @Y30OE95*/ 00839000
*                                                                  0310 00840000
         BAL   @14,CALCEXTS                                        0310 00841000
*       /*************************************************************/ 00842000
*       /*                                                           */ 00843000
*       /* PUT IN VOLUME SEQUENCE NUMBER AND MULTI-VOLUME    @Y30OE95*/ 00844000
*       /* INDICATOR IF EOV.                                 @Y30OE95*/ 00845000
*       /*                                                           */ 00846000
*       /*************************************************************/ 00847000
*                                                                  0311 00848000
*       AMWVSEQU=AMWVSEQU+ONE;      /* ADD 1 TO VOL SEQ NUM  @Y30OE6D*/ 00849000
         LA    @11,1                                               0311 00850000
         SLR   @08,@08                                             0311 00851000
         IC    @08,AMWVSEQU(,AWORKPTR)                             0311 00852000
         ALR   @11,@08                                             0311 00853000
         STC   @11,AMWVSEQU(,AWORKPTR)                             0311 00854000
*       CVD(AMWVSEQU,TEMP1);        /* PACK VOL SEQ NUM      @Y30OE6D*/ 00855000
         CVD   @11,@TS00001                                        0312 00856000
         MVC   TEMP1(2,AWORKPTR),@TS00001+6                        0312 00857000
*       UNPK(HDRVOLSQ,TEMP1);       /* PUT VOL SEQ NO.       @Y30OE95   00858000
*                                      IN HDR1               @Y30OE95*/ 00859000
         UNPK  HDRVOLSQ(2,HDR1PTR),TEMP1(2,AWORKPTR)               0313 00860000
*       HDRVOLSQ(2)=HDRVOLSQ(2)|CHAR0;/* CHANGE SIGN         @Y30OE6D*/ 00861000
         OI    HDRVOLSQ+1(HDR1PTR),C'0'                            0314 00862000
*       IF EOVPROC=ON               /* THIS EOV PROCESSING   @Y30OE95*/ 00863000
*         THEN                      /* YES                   @Y30OE95*/ 00864000
         TM    EOVPROC(AWORKPTR),B'10000000'                       0315 00865000
         BNO   @RF00315                                            0315 00866000
*         HDRMVLI=C;                /* INDICATE CONTINUED DS @Y30OE95*/ 00867000
         MVI   HDRMVLI(HDR1PTR),C'C'                               0316 00868000
*       ELSE                        /*                       @Y30OE6D*/ 00869000
*         DO;                       /*                       @Y30OE6D*/ 00870000
         B     @RC00315                                            0317 00871000
@RF00315 DS    0H                                                  0318 00872000
*           IF AMWVSEQU>ONE         /* IF LAST VOL OF A      @Y30OE6D*/ 00873000
*             THEN                  /* MULTI-VOL DS, THEN    @Y30OE6D*/ 00874000
         CLI   AMWVSEQU(AWORKPTR),1                                0318 00875000
         BNH   @RF00318                                            0318 00876000
*             HDRMVLI=CHARL;        /* SET LAST VOL CHAR.    @Y30OE6D*/ 00877000
         MVI   HDRMVLI(HDR1PTR),C'L'                               0319 00878000
*         END;                      /*                       @Y30OE6D*/ 00879000
@RF00318 DS    0H                                                  0321 00880000
*       IF AMWDSSQL^=ZERO           /* IF DS QUALIFIER WAS   @Y30OE6D*/ 00881000
*         THEN                      /* SPECIFIED, THEN       @Y30OE6D*/ 00882000
@RC00315 CLI   AMWDSSQL(AWORKPTR),X'00'                            0321 00883000
         BE    @RF00321                                            0321 00884000
*         HDRSECIN=AMWDSSQL;        /* MOVE SAME IN HDR1     @Y30OE6D*/ 00885000
         MVC   HDRSECIN(1,HDR1PTR),AMWDSSQL(AWORKPTR)              0322 00886000
*       IF AMWWTPTI^=ZERO           /* IF WRITE PROTECT      @Y30OE6D*/ 00887000
*         THEN                      /* WAS SPECIFIED,        @Y30OE6D*/ 00888000
@RF00321 CLI   AMWWTPTI(AWORKPTR),X'00'                            0323 00889000
         BE    @RF00323                                            0323 00890000
*         HDRWTPTI=AMWWTPTI;        /* MOVE SAME IN HDR1     @Y30OE6D*/ 00891000
         MVC   HDRWTPTI(1,HDR1PTR),AMWWTPTI(AWORKPTR)              0324 00892000
*       IF AMWVOLAC^=ZERO           /* WAS VOLUME SECURITY   @Y30OE6D*/ 00893000
*         THEN                      /* SPECIFIED, IF SO      @Y30OE6D*/ 00894000
@RF00323 CLI   AMWVOLAC(AWORKPTR),X'00'                            0325 00895000
         BE    @RF00325                                            0325 00896000
*         DO;                       /*                       @Y30OE6D*/ 00897000
*           RESPECIFY                                              0327 00898000
*             VOL1PTR RSTD;         /* RESTRICT VOL1 PTR     @Y30OE95*/ 00899000
*           VOL1PTR=CHANPGM(3,2:4); /* GET PTR TO VOL1 LABEL @Y30OE95*/ 00900000
         SLR   VOL1PTR,VOL1PTR                                     0328 00901000
         ICM   VOL1PTR,7,CHANPGM+17(CHNPGMPT)                      0328 00902000
*           VOLACCIN=AMWVOLAC;      /* MOVE SAME IN VOL1     @Y30OE6D*/ 00903000
         MVC   VOLACCIN(1,VOL1PTR),AMWVOLAC(AWORKPTR)              0329 00904000
*           RESPECIFY                                              0330 00905000
*             VOL1PTR UNRSTD;       /* RELEASE VOL1PTR       @Y30OE6D*/ 00906000
*         END;                      /*                       @Y30OE6D*/ 00907000
*       IF AMWMLTVL=OFF|            /* IF NOT MULTI-VOLUME   @Y30OE6D*/ 00908000
*           AMWEXDTE(1)=ZERO        /* OR NO SAVED EXP DATE  @Y30OE6D*/ 00909000
*         THEN                      /*                       @Y30OE6D*/ 00910000
@RF00325 TM    AMWMLTVL(AWORKPTR),B'00010000'                      0332 00911000
         BZ    @RT00332                                            0332 00912000
         CLI   AMWEXDTE(AWORKPTR),X'00'                            0332 00913000
         BNE   @RF00332                                            0332 00914000
@RT00332 DS    0H                                                  0333 00915000
*         DO;                       /*                       @Y30OE6D*/ 00916000
*           RESPECIFY                                              0334 00917000
*             REG1 RSTD;            /* RESTRICT REG 1        @Y30OE95*/ 00918000
*                                                                  0334 00919000
*           /*********************************************************/ 00920000
*           /*                                                       */ 00921000
*           /* PUT IN EXPIRATION DATE.                       @Y30OE95*/ 00922000
*           /* EXPIRATION DATE = CREATION DATE + 1 DAY .     @Z30OEAD*/ 00923000
*           /*                                                       */ 00924000
*           /*********************************************************/ 00925000
*                                                                  0335 00926000
*           GEN;                                                   0335 00927000
*                                 /* GENERATE ASSEMBLER     @Y30OE95*/  00928000
         TIME DEC                    GET SYSTEM DATE          @Y30OE95  00929000
*           SAVEDATE=REG1;          /* SAVE DATE             @Y30OE95*/ 00930000
         ST    REG1,SAVEDATE(,AWORKPTR)                            0336 00931000
*           RESPECIFY                                              0337 00932000
*             REG1 UNRSTD;          /* UNRESTRICT REG 1      @Y30OE95*/ 00933000
*           UNPK(UNPKDATE,SAVEDATE);/* CONVERT SYSTEM DATE   @Y30OE95*/ 00934000
         UNPK  UNPKDATE(8,AWORKPTR),SAVEDATE(4,AWORKPTR)           0338 00935000
*           CVB(DAY1,SAVEDATE(3:4));/* TO BINARY             @Y30OE95*/ 00936000
         XC    @TS00001(8),@TS00001                                0339 00937000
         MVC   @TS00001+6(2),SAVEDATE+2(AWORKPTR)                  0339 00938000
         CVB   @11,@TS00001                                        0339 00939000
         STH   @11,DAY1(,AWORKPTR)                                 0339 00940000
*           DAY1=DAY1+ONE;          /* ADD 1 FOR NEW EXPIR-  @Z30OEAD   00941000
*                                      ATION DATE            @Y30OE95*/ 00942000
         AL    @11,@CF01817                                        0340 00943000
         STH   @11,DAY1(,AWORKPTR)                                 0340 00944000
*           PACK(SYSYEAR,UNPKYEAR); /* GET PACKED SYS YEAR   @Y30OE95*/ 00945000
         PACK  SYSYEAR(2,AWORKPTR),UNPKYEAR(2,AWORKPTR)            0341 00946000
*           CVB(YEAR,SYSYEAR);      /* GET BINARY SYS YEAR   @Y30OE95*/ 00947000
         XC    @TS00001(8),@TS00001                                0342 00948000
         MVC   @TS00001+6(2),SYSYEAR(AWORKPTR)                     0342 00949000
         CVB   @11,@TS00001                                        0342 00950000
         STC   @11,YEAR(,AWORKPTR)                                 0342 00951000
*           REMAIN=YEAR//FOUR;      /* GET REMAINDER OF YEAR @Y30OE95   00952000
*                                      DIVIDED BY FOUR       @Y30OE95*/ 00953000
         LR    @00,@11                                             0343 00954000
         SRDA  @00,32                                              0343 00955000
         D     @00,@CF01897                                        0343 00956000
         STCM  @00,15,REMAIN(AWORKPTR)                             0343 00957000
*           IF REMAIN=ZEROS         /* IS THIS A LEAP YEAR   @Y30OE95*/ 00958000
*             THEN                  /* YES                   @Y30OE95*/ 00959000
         C     @00,ZEROS                                           0344 00960000
         BNE   @RF00344                                            0344 00961000
*             DO;                   /* CONTINUE              @Y30OE95*/ 00962000
*               NUMDAY=NUM366;      /* SET NO. OF DAYS=366   @Y30OE95*/ 00963000
         MVC   NUMDAY(2,AWORKPTR),NUM366                           0346 00964000
*               TABLE=TABLELYR;     /* GET LEAP YEAR TABLE   @Y30OE95*/ 00965000
         MVC   TABLE(24,AWORKPTR),TABLELYR                         0347 00966000
*             END;                  /*                       @Y30OE95*/ 00967000
*           ELSE                    /*                       @Y30OE95*/ 00968000
*             DO;                   /* CONTINUE              @Y30OE95*/ 00969000
         B     @RC00344                                            0349 00970000
@RF00344 DS    0H                                                  0350 00971000
*               NUMDAY=NUM365;      /* SET NUM OF DAYS = 365 @Y30OE95*/ 00972000
         MVC   NUMDAY(2,AWORKPTR),NUM365                           0350 00973000
*               TABLE=TABLENLP;     /* GET NON-LEAP YEAR TBL @Y30OE95*/ 00974000
         MVC   TABLE(24,AWORKPTR),TABLENLP                         0351 00975000
*             END;                  /*                       @Y30OE95*/ 00976000
*           IF DAY1>NUMDAY          /* IF PAST END OF YEAR   @Y30OE95*/ 00977000
*             THEN                  /* YES                   @Y30OE95*/ 00978000
@RC00344 LH    @11,DAY1(,AWORKPTR)                                 0353 00979000
         SLR   @08,@08                                             0353 00980000
         ICM   @08,3,NUMDAY(AWORKPTR)                              0353 00981000
         CR    @11,@08                                             0353 00982000
         BNH   @RF00353                                            0353 00983000
*             DO;                   /* CONTINUE              @Y30OE95*/ 00984000
*               DAY1=DAY1-NUMDAY;   /* GET DAY NUM OF NXT YR @Y30OE95*/ 00985000
         SLR   @11,@08                                             0355 00986000
         STH   @11,DAY1(,AWORKPTR)                                 0355 00987000
*               YEAR=YEAR+ONE;      /* UPDATE YEAR BY ONE    @Y30OE95*/ 00988000
         LA    @11,1                                               0356 00989000
         SLR   @08,@08                                             0356 00990000
         IC    @08,YEAR(,AWORKPTR)                                 0356 00991000
         ALR   @11,@08                                             0356 00992000
         STC   @11,YEAR(,AWORKPTR)                                 0356 00993000
*             END;                  /*                       @Y30OE95*/ 00994000
*           I=TWELVE;               /* SET MONTH CTR TO 12   @Y30OE95*/ 00995000
@RF00353 LA    @11,12                                              0358 00996000
         ST    @11,I(,AWORKPTR)                                    0358 00997000
*           DO WHILE TRANSTBL(I)-DAY1>=ZERO;/* SET LOOP      @Y30OE95   00998000
*                                      UNTIL CORRECT MONTH   @Y30OE95   00999000
*                                      IS FOUND              @Y30OE95*/ 01000000
         B     @DE00359                                            0359 01001000
@DL00359 DS    0H                                                  0360 01002000
*             I=I-ONE;              /* DECREASE MONTH BY ONE @Y30OE95*/ 01003000
         L     @11,I(,AWORKPTR)                                    0360 01004000
         BCTR  @11,0                                               0360 01005000
         ST    @11,I(,AWORKPTR)                                    0360 01006000
*           END;                    /*                       @Y30OE95*/ 01007000
@DE00359 L     @11,I(,AWORKPTR)                                    0361 01008000
         LR    @08,@11                                             0361 01009000
         ALR   @08,@08                                             0361 01010000
         LH    @08,TRANSTBL-2(@08,AWORKPTR)                        0361 01011000
         LH    @15,DAY1(,AWORKPTR)                                 0361 01012000
         LR    @14,@08                                             0361 01013000
         SLR   @14,@15                                             0361 01014000
         LTR   @14,@14                                             0361 01015000
         BNM   @DL00359                                            0361 01016000
*           DAY1=DAY1-TRANSTBL(I);  /* GET CORRECT DAY       @Y30OE95*/ 01017000
         SLR   @15,@08                                             0362 01018000
         STH   @15,DAY1(,AWORKPTR)                                 0362 01019000
*           CVD(I,HDRMTH1);         /* GET PACKED MONTH      @Y30OE95*/ 01020000
         CVD   @11,@TS00001                                        0363 01021000
         MVC   HDRMTH1(2,AWORKPTR),@TS00001+6                      0363 01022000
*           UNPK(HDRMONTH,HDRMTH1); /* EBCDIC MONTH TO HDR1  @Y30OE95*/ 01023000
         UNPK  HDRMONTH(2,HDR1PTR),HDRMTH1(2,AWORKPTR)             0364 01024000
*           HDRMONTH(2)=HDRMONTH(2)|CHAR0;/* CHANGE SIGN     @Y30OE6D*/ 01025000
         OI    HDRMONTH+1(HDR1PTR),C'0'                            0365 01026000
*           CVD(DAY1,HDRDAY1);      /* GET PACKED DAY        @Y30OE95*/ 01027000
         CVD   @15,@TS00001                                        0366 01028000
         MVC   HDRDAY1(2,AWORKPTR),@TS00001+6                      0366 01029000
*           UNPK(HDRDAY,HDRDAY1);   /* EBCDIC DAY TO HDR1    @Y30OE95*/ 01030000
         UNPK  HDRDAY(2,HDR1PTR),HDRDAY1(2,AWORKPTR)               0367 01031000
*           HDRDAY(2)=HDRDAY(2)|CHAR0;/* CHANGE SIGN         @Y30OE6D*/ 01032000
         OI    HDRDAY+1(HDR1PTR),C'0'                              0368 01033000
*           CVD(YEAR,HDRYEAR1);     /* GET PACKED YEAR       @Y30OE95*/ 01034000
         SLR   @11,@11                                             0369 01035000
         IC    @11,YEAR(,AWORKPTR)                                 0369 01036000
         CVD   @11,@TS00001                                        0369 01037000
         MVC   HDRYEAR1(2,AWORKPTR),@TS00001+6                     0369 01038000
*           UNPK(HDRYEAR,HDRYEAR1); /* EBCDIC YEAR TO HDR1   @Y30OE95*/ 01039000
         UNPK  HDRYEAR(2,HDR1PTR),HDRYEAR1(2,AWORKPTR)             0370 01040000
*           HDRYEAR(2)=HDRYEAR(2)|CHAR0;/* CHANGE SIGN       @Y30OE6D*/ 01041000
         OI    HDRYEAR+1(HDR1PTR),C'0'                             0371 01042000
*           IF HDREXDTE<AMWEXDTE    /* 1 DAY PAST TODAY ?    @Z30OEAD*/ 01043000
*             THEN                  /* NO                    @Y30OE6D*/ 01044000
         CLC   HDREXDTE(6,HDR1PTR),AMWEXDTE(AWORKPTR)              0372 01045000
         BNL   @RF00372                                            0372 01046000
*             HDREXDTE=AMWEXDTE;    /* PUT DATE IN HDR1      @Y30OE6D*/ 01047000
         MVC   HDREXDTE(6,HDR1PTR),AMWEXDTE(AWORKPTR)              0373 01048000
*           ELSE                    /*                       @Y30OE6D*/ 01049000
*             AMWEXDTE=HDREXDTE;    /* SAVE NEW EXP. DATE    @Y30OE6D*/ 01050000
         B     @RC00372                                            0374 01051000
@RF00372 MVC   AMWEXDTE(6,AWORKPTR),HDREXDTE(HDR1PTR)              0374 01052000
*         END;                      /*                       @Y30OE6D*/ 01053000
*       ELSE                        /*                       @Y30OE6D*/ 01054000
*         HDREXDTE=AMWEXDTE;        /* MOVE EXP DATE TO HDR1 @Y30OE6D*/ 01055000
         B     @RC00332                                            0376 01056000
@RF00332 MVC   HDREXDTE(6,HDR1PTR),AMWEXDTE(AWORKPTR)              0376 01057000
*       IOBSKADR=VOL1ADDR;          /* SET SEEK ADDR TO VOL1 @Y30OE6D*/ 01058000
@RC00332 MVC   IOBSKADR(4,IOBSTPTR),VOL1ADDR                       0377 01059000
*       CALL IOSBRTN;               /* GO WRITE LABEL TRACK  @Y30OE6D*/ 01060000
         BAL   @14,IOSBRTN                                         0378 01061000
*       CHANPGM(1,1)=NOOP;          /* RESTORE NOOPCCW       @Y30OE6D*/ 01062000
         MVI   CHANPGM(CHNPGMPT),X'03'                             0379 01063000
*       CHANPGM(23)=CCW21SAV;       /* RESTORE RWCCW23       @Y30OE6D*/ 01064000
         MVC   CHANPGM+176(8,CHNPGMPT),CCW21SAV(AWORKPTR)          0380 01065000
*     END;                          /*                       @Y30OE6D*/ 01066000
*   END FORMHDR1;                   /* END OF SUBROUTINE     @Y30OE95*/ 01067000
@EL00006 DS    0H                                                  0382 01068000
@EF00006 DS    0H                                                  0382 01069000
@ER00006 L     @14,@SA00006                                        0382 01070000
         BR    @14                                                 0382 01071000
*                                                                  0383 01072000
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE95*/ 01073000
*/*                                                          @Y30OE95*/ 01074000
*/*  THIS ROUTINE IS CALLED TO UPDATE THE DEB, IOB AND       @Y30OE95*/ 01075000
*/*  THE CHANNEL PROGRAM TO PREPARE TO WRITE A NEW OPENED    @Y30OE95*/ 01076000
*/*  DATA SET OR CONTINUE TO WRITE AN ALREADY OPENED DATA    @Y30OE95*/ 01077000
*/*  SET ON A NEW DISKETTE.                                  @Y30OE95*/ 01078000
*/*                                                          @Y30OE95*/ 01079000
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE95*/ 01080000
*                                                                  0383 01081000
*UPDEBIOB:                          /*                       @Y30OE95*/ 01082000
*   PROC OPTIONS(NOSAVE);           /*                       @Y30OE95*/ 01083000
UPDEBIOB DS    0H                                                  0384 01084000
*   RFY                             /*                       @Y30OE6D*/ 01085000
*    (REG14,                        /*                       @Y30OE6D*/ 01086000
*     IOBPRPTR) RSTD;               /* RESTRICT REGISTERS    @Y30OE6D*/ 01087000
*   AMWBOE=''B;                     /* ZERO DEB BOE RESERVED @Y30OE6D*/ 01088000
         XC    AMWBOE(4,AWORKPTR),AMWBOE(AWORKPTR)                 0385 01089000
*   AMWBOESS=ONE;                   /* DEB BOE RECORD = 1    @Y30OE6D*/ 01090000
         MVI   AMWBOESS(AWORKPTR),X'01'                            0386 01091000
*   IF HDR1PTR=CHANPGM(4,2:4)       /* IF 1ST HDR1           @Y30OE95*/ 01092000
*     THEN                          /* YES                   @Y30OE95*/ 01093000
         SLR   @15,@15                                             0387 01094000
         ICM   @15,7,CHANPGM+25(CHNPGMPT)                          0387 01095000
         CR    HDR1PTR,@15                                         0387 01096000
         BNE   @RF00387                                            0387 01097000
*     AMWBOETT=ONE;                 /* SET TRK NUM TO 1      @Y30OE6D*/ 01098000
         MVI   AMWBOETT(AWORKPTR),X'01'                            0388 01099000
*   ELSE                            /*                       @Y30OE95*/ 01100000
*     DO;                           /* CONTINUE              @Y30OE95*/ 01101000
         B     @RC00387                                            0389 01102000
@RF00387 DS    0H                                                  0390 01103000
*       HDR1PTR=CHANPGM(I+2,2:4);   /* GET PTR TO PREV HDR   @Y30OE95*/ 01104000
         L     @15,I(,AWORKPTR)                                    0390 01105000
         SLA   @15,3                                               0390 01106000
         L     HDR1PTR,CHANPGM+8(@15,CHNPGMPT)                     0390 01107000
         LA    HDR1PTR,0(,HDR1PTR)                                 0390 01108000
*       PACK(TEMP1,HDREOECC);       /* PACK EOE TRK NUM      @Y30OE95*/ 01109000
         PACK  TEMP1(2,AWORKPTR),HDREOECC(2,HDR1PTR)               0391 01110000
*       TEMP1(2)=TEMP1(2)&PLUSSIGN; /* SET POSITIVE SIGN     @Y30OE6D*/ 01111000
         NI    TEMP1+1(AWORKPTR),X'FC'                             0392 01112000
*       CVB(TEMP2,TEMP1);           /* CONVERT IT TO BINARY  @Y30OE95*/ 01113000
         XC    @TS00001(8),@TS00001                                0393 01114000
         MVC   @TS00001+6(2),TEMP1(AWORKPTR)                       0393 01115000
         CVB   @15,@TS00001                                        0393 01116000
         STH   @15,TEMP2(,AWORKPTR)                                0393 01117000
*       AMWBOETT=TEMP2+ONE;         /* ADD 1 AND PUT IN DEB  @Y30OE6D*/ 01118000
         AL    @15,@CF01817                                        0394 01119000
         STC   @15,AMWBOETT(,AWORKPTR)                             0394 01120000
*     END;                          /*                       @Y30OE6D*/ 01121000
*   IOBSKADR=AMWBOE;                /* UPDTE 1ST IOB SEEKADR @Y30OE6D*/ 01122000
@RC00387 MVC   IOBSKADR(4,IOBSTPTR),AMWBOE(AWORKPTR)               0396 01123000
*   AMWBOETT=AMWBOETT-ONE;          /* SUBT 1 FROM TRK NUM   @Y30OE6D*/ 01124000
         SLR   @15,@15                                             0397 01125000
         IC    @15,AMWBOETT(,AWORKPTR)                             0397 01126000
         BCTR  @15,0                                               0397 01127000
         STC   @15,AMWBOETT(,AWORKPTR)                             0397 01128000
*   IOBPRPTR=SAVEIOBX;              /* GET PTR TO IOB PREFIX @Y30OE95*/ 01129000
         L     IOBPRPTR,SAVEIOBX(,AWORKPTR)                        0398 01130000
*   ECBCC=GOODIO;                   /* POST 1ST ECB GOOD     @Y30OE95*/ 01131000
         L     @15,IOBECBPT(,IOBSTPTR)                             0399 01132000
         MVI   ECBCC(@15),X'7F'                                    0399 01133000
*   IF ACBLRECL<=HZERO|             /* IF REC LNGTH <= 0 OR  @Y30OE6D*/ 01134000
*       ACBLRECL>MAXLRECL           /* > 128                 @Y30OE6D*/ 01135000
*     THEN                          /*                       @Y30OE6D*/ 01136000
         LH    @15,ACBLRECL(,AWORKPTR)                             0400 01137000
         LH    @11,HZERO                                           0400 01138000
         N     @11,@CF02109                                        0400 01139000
         CR    @15,@11                                             0400 01140000
         BNH   @RT00400                                            0400 01141000
         CH    @15,MAXLRECL                                        0400 01142000
         BNH   @RF00400                                            0400 01143000
@RT00400 DS    0H                                                  0401 01144000
*     ACBLRECL=MAXLRECL;            /* SET LRECL TO 128      @Y30OE6D*/ 01145000
         LH    @15,MAXLRECL                                        0401 01146000
         STH   @15,ACBLRECL(,AWORKPTR)                             0401 01147000
*   DO I=1 TO 2;                    /* SET LOOP FOR 2 IOB'S  @Y30OE95*/ 01148000
@RF00400 LA    @15,1                                               0402 01149000
         ST    @15,I(,AWORKPTR)                                    0402 01150000
@DL00402 DS    0H                                                  0403 01151000
*     CHNPGMPT=IOBSTART;            /* GET PTR TO CHAN PGM   @Y30OE95*/ 01152000
         L     CHNPGMPT,IOBSTART(,IOBSTPTR)                        0403 01153000
*     DO J=3 TO 28;                 /* SET LOOP FOR 26 CCWS  @Y30OE95*/ 01154000
         LA    @15,3                                               0404 01155000
         ST    @15,J(,AWORKPTR)                                    0404 01156000
@DL00404 DS    0H                                                  0405 01157000
*       CHANPGM(J,7:8)=ACBLRECL;    /* SET RIGHT BYTECNT     @Y30OE95*/ 01158000
         L     @15,J(,AWORKPTR)                                    0405 01159000
         SLA   @15,3                                               0405 01160000
         LH    @11,ACBLRECL(,AWORKPTR)                             0405 01161000
         ALR   @15,CHNPGMPT                                        0405 01162000
         BCTR  @15,0                                               0405 01163000
         BCTR  @15,0                                               0405 01164000
         STCM  @11,3,CHANPGM(@15)                                  0405 01165000
*     END;                          /*                       @Y30OE95*/ 01166000
         LA    @15,1                                               0406 01167000
         AL    @15,J(,AWORKPTR)                                    0406 01168000
         ST    @15,J(,AWORKPTR)                                    0406 01169000
         C     @15,@CF01584                                        0406 01170000
         BNH   @DL00404                                            0406 01171000
*     IOBSTPTR=IOBNIOBA+LENGTH(IOBORG01);/* 2ND IOB          @Y30OE95*/ 01172000
         L     @15,IOBPTR-1(,AWORKPTR)                             0407 01173000
         LA    IOBSTPTR,8                                          0407 01174000
         AL    @15,@CF02104                                        0407 01175000
         AL    IOBSTPTR,IOBNIOBA-8(,@15)                           0407 01176000
*     ECBCC=GOODIO;                 /* POST 2ND ECB GOOD     @Y30OE95*/ 01177000
         L     @15,IOBECBPT(,IOBSTPTR)                             0408 01178000
         MVI   ECBCC(@15),X'7F'                                    0408 01179000
*   END;                            /*                       @Y30OE95*/ 01180000
         LA    @15,1                                               0409 01181000
         AL    @15,I(,AWORKPTR)                                    0409 01182000
         ST    @15,I(,AWORKPTR)                                    0409 01183000
         C     @15,@CF00196                                        0409 01184000
         BNH   @DL00402                                            0409 01185000
*   IOBSKADR=AMWBOE;                /* UPDTE 2ND IOB SEEKADR @Y30OE6D*/ 01186000
         MVC   IOBSKADR(4,IOBSTPTR),AMWBOE(AWORKPTR)               0410 01187000
*   IOBSTPTR=SAVEIOB;               /* RESTORE PTR TO IOB    @Y30OE95*/ 01188000
         L     IOBSTPTR,SAVEIOB(,AWORKPTR)                         0411 01189000
*   CHNPGMPT=IOBSTART;              /* GET PTR TO CHAN PGM   @Y30OE95*/ 01190000
         L     CHNPGMPT,IOBSTART(,IOBSTPTR)                        0412 01191000
*   CCWPTR=ADDR(CHANPGM(3));        /* CCWPTR PTS TO 1ST     @Y30OE95   01192000
*                                      WRITE CCW OF 1ST IOB  @Y30OE95*/ 01193000
         LA    @15,CHANPGM+16(,CHNPGMPT)                           0413 01194000
         STCM  @15,7,CCWPTR(AWORKPTR)                              0413 01195000
*   AMWBOETT=AMWBOETT+ONE;          /* RESTORE DEB BOE       @Y30OE6D*/ 01196000
         LA    @15,1                                               0414 01197000
         SLR   @11,@11                                             0414 01198000
         IC    @11,AMWBOETT(,AWORKPTR)                             0414 01199000
         ALR   @15,@11                                             0414 01200000
         STC   @15,AMWBOETT(,AWORKPTR)                             0414 01201000
*   RFY                             /*                       @Y30OE6D*/ 01202000
*    (REG14,                        /*                       @Y30OE6D*/ 01203000
*     IOBPRPTR) UNRSTD;             /* RELEASE REGISTERS     @Y30OE6D*/ 01204000
*   END UPDEBIOB;                   /* END OF UPDATE ROUT.   @Y30OE95*/ 01205000
@EL00007 DS    0H                                                  0416 01206000
@EF00007 DS    0H                                                  0416 01207000
@ER00007 BR    @14                                                 0416 01208000
*                                                                  0417 01209000
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE95*/ 01210000
*/*                                                          @Y30OE95*/ 01211000
*/*  THIS PROCEDURE VALIDITY CHECKS THE VOL1 LABEL.  THE     @Y30OE95*/ 01212000
*/*  VOLID MUST BE LEFT JUSTIFIED, CONTAIN ONLY CHARACTERS   @Y30OE95*/ 01213000
*/*  A-Z, 0-9 AND MUST CONTAIN NO IMBEDDED BLANKS.           @Y30OE95*/ 01214000
*/*                                                          @Y30OE95*/ 01215000
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE95*/ 01216000
*                                                                  0417 01217000
*VOL1LABL:                          /*                       @Y30OE95*/ 01218000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30OE95*/ 01219000
VOL1LABL ST    @14,@SA00008                                        0417 01220000
*   RESPECIFY                                                      0418 01221000
*     VOL1PTR RSTD;                 /* RESTRICT VOL1 PTR     @Y30OE95*/ 01222000
*   VOL1PTR=CHANPGM(3,2:4);         /* GET PTR TO VOL1 LABEL @Y30OE95*/ 01223000
         SLR   VOL1PTR,VOL1PTR                                     0419 01224000
         ICM   VOL1PTR,7,CHANPGM+17(CHNPGMPT)                      0419 01225000
*   GOODVOL1=OFF;                   /* INITIALIZE FLAG       @Y30OE6D*/ 01226000
         NI    GOODVOL1(AWORKPTR),B'10111111'                      0420 01227000
*   IF VOLLABID=VOL1                /* IS LABEL = VOL1       @Y30OE95*/ 01228000
*     THEN                          /* YES                   @Y30OE95*/ 01229000
         CLC   VOLLABID(4,VOL1PTR),VOL1                            0421 01230000
         BNE   @RF00421                                            0421 01231000
*     DO;                           /*                       @Y30OE6D*/ 01232000
*       BLANKCHR=OFF;               /* INITIALIZE FLAGS      @Y30OE95*/ 01233000
         NI    BLANKCHR(AWORKPTR),B'11101111'                      0423 01234000
*       BADVOLID=OFF;               /* INITIALIZE FLAGS      @Y30OE95*/ 01235000
         NI    BADVOLID(AWORKPTR),B'11101111'                      0424 01236000
*       CHARPTR=ADDR(VOLID);        /* INIT CHAR PTR         @Y30OE95*/ 01237000
         LA    CHARPTR,VOLID(,VOL1PTR)                             0425 01238000
*       IF VOLID(1)=BLANK           /* IF 1ST CHAR IS A      @Y30OE6D*/ 01239000
*         THEN                      /* BLANK, THEN SET       @Y30OE6D*/ 01240000
         CLI   VOLID(VOL1PTR),C' '                                 0426 01241000
         BNE   @RF00426                                            0426 01242000
*         BADVOLID=ON;              /* BAD VOLID IND         @Y30OE6D*/ 01243000
         OI    BADVOLID(AWORKPTR),B'00010000'                      0427 01244000
*       ELSE                        /*                       @Y30OE6D*/ 01245000
*         DO I=1 TO 6               /* SET LOOP FOR 6 CHARS  @Y30OE95*/ 01246000
*               WHILE BADVOLID=OFF; /* TIL BAD ID FND        @Y30OE95*/ 01247000
         B     @RC00426                                            0428 01248000
@RF00426 LA    @15,1                                               0428 01249000
         ST    @15,I(,AWORKPTR)                                    0428 01250000
@DL00428 TM    BADVOLID(AWORKPTR),B'00010000'                      0428 01251000
         BNZ   @DC00428                                            0428 01252000
*           IF^(CHARACTR>=CHARA&    /*                       @Y30OE6D*/ 01253000
*               CHARACTR<=CHARI|    /*                       @Y30OE6D*/ 01254000
*               CHARACTR>=CHARJ&    /*                       @Y30OE6D*/ 01255000
*               CHARACTR<=CHARR|    /*                       @Y30OE6D*/ 01256000
*               CHARACTR>=CHARS&    /*                       @Y30OE6D*/ 01257000
*               CHARACTR<=CHARZ|    /*                       @Y30OE6D*/ 01258000
*               CHARACTR>=CHAR0&    /*                       @Y30OE6D*/ 01259000
*               CHARACTR<=CHAR9)    /*                       @Y30OE6D*/ 01260000
*             THEN                  /* NO                    @Y30OE95*/ 01261000
         CLI   CHARACTR(CHARPTR),C'A'                              0429 01262000
         BL    @GL00009                                            0429 01263000
         CLI   CHARACTR(CHARPTR),C'I'                              0429 01264000
         BNH   @RF00429                                            0429 01265000
@GL00009 CLI   CHARACTR(CHARPTR),C'J'                              0429 01266000
         BL    @GL00008                                            0429 01267000
         CLI   CHARACTR(CHARPTR),C'R'                              0429 01268000
         BNH   @RF00429                                            0429 01269000
@GL00008 CLI   CHARACTR(CHARPTR),C'S'                              0429 01270000
         BL    @GL00007                                            0429 01271000
         CLI   CHARACTR(CHARPTR),C'Z'                              0429 01272000
         BNH   @RF00429                                            0429 01273000
@GL00007 CLI   CHARACTR(CHARPTR),C'0'                              0429 01274000
         BL    @RT00429                                            0429 01275000
         CLI   CHARACTR(CHARPTR),C'9'                              0429 01276000
         BNH   @RF00429                                            0429 01277000
@RT00429 DS    0H                                                  0430 01278000
*             IF CHARACTR=BLANK     /* BLANK CHAR?           @Y30OE95*/ 01279000
*               THEN                /* YES                   @Y30OE95*/ 01280000
         CLI   CHARACTR(CHARPTR),C' '                              0430 01281000
         BNE   @RF00430                                            0430 01282000
*               BLANKCHR=ON;        /* BLANK BIT ON          @Y30OE95*/ 01283000
         OI    BLANKCHR(AWORKPTR),B'00010000'                      0431 01284000
*             ELSE                  /*                       @Y30OE95*/ 01285000
*               BADVOLID=ON;        /* ERROR BIT ON          @Y30OE95*/ 01286000
         B     @RC00430                                            0432 01287000
@RF00430 OI    BADVOLID(AWORKPTR),B'00010000'                      0432 01288000
*           ELSE                    /*                       @Y30OE95*/ 01289000
*             IF BLANKCHR=ON        /* PREVIOUS BLANK?       @Y30OE95*/ 01290000
*               THEN                /* YES                   @Y30OE95*/ 01291000
         B     @RC00429                                            0433 01292000
@RF00429 TM    BLANKCHR(AWORKPTR),B'00010000'                      0433 01293000
         BNO   @RF00433                                            0433 01294000
*               BADVOLID=ON;        /* ERROR BIT ON          @Y30OE95*/ 01295000
         OI    BADVOLID(AWORKPTR),B'00010000'                      0434 01296000
*           CHARPTR=CHARPTR+ONE;    /* PT NXT CHAR           @Y30OE95*/ 01297000
@RF00433 DS    0H                                                  0435 01298000
@RC00429 AL    CHARPTR,@CF01817                                    0435 01299000
*         END;                      /*                       @Y30OE95*/ 01300000
         LA    @15,1                                               0436 01301000
         AL    @15,I(,AWORKPTR)                                    0436 01302000
         ST    @15,I(,AWORKPTR)                                    0436 01303000
         C     @15,@CF00412                                        0436 01304000
         BNH   @DL00428                                            0436 01305000
@DC00428 DS    0H                                                  0437 01306000
*       IF BADVOLID=OFF             /* BAD VOLID?            @Y30OE95*/ 01307000
*         THEN                      /* NO                    @Y30OE95*/ 01308000
@RC00426 TM    BADVOLID(AWORKPTR),B'00010000'                      0437 01309000
         BNZ   @RF00437                                            0437 01310000
*         IF VOLLABVR=W             /* IS LBL VERSION=W      @Y30OE95*/ 01311000
*           THEN                    /* YES                   @Y30OE95*/ 01312000
         CLI   VOLLABVR(VOL1PTR),C'W'                              0438 01313000
         BNE   @RF00438                                            0438 01314000
*                                                                  0439 01315000
*           /*********************************************************/ 01316000
*           /*                                                       */ 01317000
*           /* IF VOL1 LABEL IS GOOD, THEN PUT VOLID IN      @Y30OE95*/ 01318000
*           /* UCB. IF NOT GOOD, CHECK IF END OF DISKETTE.   @Y30OE95*/ 01319000
*           /* IF SO, PUT END OF DISKETTE VOLID IN UCB.      @Y30OE95*/ 01320000
*           /* OTHERWISE ZERO UCBVOLID FIELD AND ISSUE       @Y30OE95*/ 01321000
*           /* ERROR MESSAGE.                                @Y30OE95*/ 01322000
*           /*                                                       */ 01323000
*           /*********************************************************/ 01324000
*                                                                  0439 01325000
*           DO;                     /* CONTINUE              @Y30OE95*/ 01326000
*             SAVEVOL=VOLID;        /* UPDATE VOL            @Y30OE6D*/ 01327000
         MVC   SAVEVOL(6,AWORKPTR),VOLID(VOL1PTR)                  0440 01328000
*             CALL UCBUPDAT;        /* SER IN UCB            @Y30OE6D*/ 01329000
         BAL   @14,UCBUPDAT                                        0441 01330000
*             GOODVOL1=ON;          /* IND GOOD VOL1         @Y30OE95*/ 01331000
         OI    GOODVOL1(AWORKPTR),B'01000000'                      0442 01332000
*           END;                    /*                       @Y30OE95*/ 01333000
*     END;                          /*                       @Y30OE95*/ 01334000
@RF00438 DS    0H                                                  0444 01335000
@RF00437 DS    0H                                                  0445 01336000
*   IF GOODVOL1=OFF                 /* WAS VOL1 LABEL OK     @Y30OE95*/ 01337000
*     THEN                          /* NO                    @Y30OE95*/ 01338000
@RF00421 TM    GOODVOL1(AWORKPTR),B'01000000'                      0445 01339000
         BNZ   @RF00445                                            0445 01340000
*     IF VOLID^=ENDDSKT             /* IS THIS LAST DISKETTE @Y30OE6D*/ 01341000
*       THEN                        /* NO                    @Y30OE95*/ 01342000
         CLC   VOLID(6,VOL1PTR),ENDDSKT                            0446 01343000
         BE    @RF00446                                            0446 01344000
*       DO;                         /* CONTINUE              @Y30OE95*/ 01345000
*         SAVEVOL=''B;              /* VOL SER = 0           @Y30OE6D*/ 01346000
         XC    SAVEVOL(6,AWORKPTR),SAVEVOL(AWORKPTR)               0448 01347000
*         CALL UCBUPDAT;            /* GO UPDATE VOL SER     @Y30OE6D*/ 01348000
         BAL   @14,UCBUPDAT                                        0449 01349000
*         ERTNCDE=BADVOL1;          /* SET BAD VOL1 RTN CODE @Y30OE6D*/ 01350000
         MVI   ERTNCDE(SETDSKPT),X'08'                             0450 01351000
*         MSGINDEX=VOL1MSG;         /* INDEX FOR VOL1 MSG 14 @Y30OE6D*/ 01352000
         MVI   MSGINDEX(AWORKPTR),X'0E'                            0451 01353000
*         CALL MSGSUBRT;            /* CALL THE MSG SUBROUT. @Y30OE6D*/ 01354000
         BAL   @14,MSGSUBRT                                        0452 01355000
*       END;                        /*                       @Y30OE95*/ 01356000
*     ELSE                          /*                       @Y30OE95*/ 01357000
*       DO;                         /* CONTINUE              @Y30OE95*/ 01358000
         B     @RC00446                                            0454 01359000
@RF00446 DS    0H                                                  0455 01360000
*         SAVEVOL=ENDDSKT;          /* UPDATE UCBVOLID       @Y30OE6D*/ 01361000
         MVC   SAVEVOL(6,AWORKPTR),ENDDSKT                         0455 01362000
*         CALL UCBUPDAT;            /* GO UPDATE UCB         @Y30OE6D*/ 01363000
         BAL   @14,UCBUPDAT                                        0456 01364000
*         ERTNCDE=ENDDISK;          /* SET END DISK R.C.     @Y30OE6D*/ 01365000
         MVI   ERTNCDE(SETDSKPT),X'14'                             0457 01366000
*       END;                        /*                       @Y30OE95*/ 01367000
*   ELSE                            /*                       @Y30OE95*/ 01368000
*     DO;                           /* CONTINUE              @Y30OE95*/ 01369000
         B     @RC00445                                            0459 01370000
@RF00445 DS    0H                                                  0460 01371000
*                                                                  0460 01372000
*       /*************************************************************/ 01373000
*       /*                                                           */ 01374000
*       /* SECURITY PROCESSING - A WTOR IS ISSUED TO WHICH   @Y30OE95*/ 01375000
*       /* THE OPERATOR MUST REPLY WITH THE CORRECT ACCESS   @Y30OE95*/ 01376000
*       /* CODE. IF MORE THAN ONE DATASET IS ON THE          @Y30OE95*/ 01377000
*       /* DISKETTE, THE MESSAGE IS ISSUED ONLY FOR THE      @Y30OE95*/ 01378000
*       /* FIRST DATA SET OPENED.                            @Y30OE95*/ 01379000
*       /*                                                           */ 01380000
*       /*************************************************************/ 01381000
*                                                                  0460 01382000
*       IF VOLACCIN^=BLANK          /* IS ACCESS CODE REQD   @Y30OE95*/ 01383000
*         THEN                      /* YES                   @Y30OE95*/ 01384000
         CLI   VOLACCIN(VOL1PTR),C' '                              0460 01385000
         BE    @RF00460                                            0460 01386000
*         DO;                       /* CONTINUE              @Y30OE95*/ 01387000
*           MSGINDEX=SECRMSG;       /* SET INDEX FOR MSG 17  @Y30OE6D*/ 01388000
         MVI   MSGINDEX(AWORKPTR),X'11'                            0462 01389000
*           DSIDLOP=ON;             /* DONT USE DSID         @Z30OE78*/ 01390000
         OI    DSIDLOP,B'10000000'                                 0463 01391000
*           JOBNMLOP=ON;            /* DONT USE JOBNAME      @Z30OE78*/ 01392000
         OI    JOBNMLOP,B'10000000'                                0464 01393000
*           SETRETCD=SECUREVL;      /* SET SECURE VOL CODE   @Y30OE6D*/ 01394000
         MVC   SETRETCD(2,SETDSKPT),SECUREVL                       0465 01395000
*           BADREPLY=ON;            /* SET BAD REPLY IND ON  @Y30OE6D*/ 01396000
         OI    BADREPLY(AWORKPTR),B'00100000'                      0466 01397000
*           DO I=1 TO 3 WHILE       /* GIVE OPER. 3 CHANCES  @Y30OE6D*/ 01398000
*                 BADREPLY=ON;      /* TO GIVE THE           @Y30OE6D   01399000
*                                      CORRECT REPLY         @Y30OE6D*/ 01400000
         LA    @08,1                                               0467 01401000
         ST    @08,I(,AWORKPTR)                                    0467 01402000
@DL00467 TM    BADREPLY(AWORKPTR),B'00100000'                      0467 01403000
         BNO   @DC00467                                            0467 01404000
*             MSGTYPCD=WTORCD;      /* MSG TYPE IS WTOR      @Y30OE6D*/ 01405000
         MVI   MSGTYPCD(AWORKPTR),X'02'                            0468 01406000
*             CALL MSGSUBRT;        /* CALL THE MSG SUBROUT. @Y30OE6D*/ 01407000
         BAL   @14,MSGSUBRT                                        0469 01408000
*             IF REPLYARA=VOLACCIN  /* IS REPLY CORRECT      @Y30OE6D*/ 01409000
*               THEN                /* YES                   @Y30OE95*/ 01410000
         L     @08,MSGREPAD(,AWORKPTR)                             0470 01411000
         CLC   REPLYARA(1,@08),VOLACCIN(VOL1PTR)                   0470 01412000
         BNE   @RF00470                                            0470 01413000
*               DO;                 /*                       @Y30OE6D*/ 01414000
*                 SETRETCD=''B;     /* SET RETURN CODE TO 0  @Y30OE6D*/ 01415000
         XC    SETRETCD(2,SETDSKPT),SETRETCD(SETDSKPT)             0472 01416000
*                 BADREPLY=OFF;     /* INDICATE GOOD REPLY   @Y30OE6D*/ 01417000
         NI    BADREPLY(AWORKPTR),B'11011111'                      0473 01418000
*               END;                /*                       @Y30OE6D*/ 01419000
*             ELSE                  /*                       @Y30OE95*/ 01420000
*               IF REPLYARA=BLANK   /* IF REPLY WAS BLANK    @Y30OE6D*/ 01421000
*                 THEN              /*                       @Y30OE6D*/ 01422000
         B     @RC00470                                            0475 01423000
@RF00470 L     @08,MSGREPAD(,AWORKPTR)                             0475 01424000
         CLI   REPLYARA(@08),C' '                                  0475 01425000
         BNE   @RF00475                                            0475 01426000
*                 BADREPLY=OFF;     /* THEN SET GOOD REPLY   @Y30OE6D*/ 01427000
         NI    BADREPLY(AWORKPTR),B'11011111'                      0476 01428000
*           END;                    /*                       @Y30OE95*/ 01429000
@RF00475 DS    0H                                                  0477 01430000
@RC00470 LA    @08,1                                               0477 01431000
         AL    @08,I(,AWORKPTR)                                    0477 01432000
         ST    @08,I(,AWORKPTR)                                    0477 01433000
         C     @08,@CF00217                                        0477 01434000
         BNH   @DL00467                                            0477 01435000
@DC00467 DS    0H                                                  0478 01436000
*           DSIDLOP=OFF;            /* MAKE DSID USEABLE     @Z30OE78*/ 01437000
         NI    DSIDLOP,B'01111111'                                 0478 01438000
*           JOBNMLOP=OFF;           /* MAKE JOBNAME USEABLE  @Z30OE78*/ 01439000
         NI    JOBNMLOP,B'01111111'                                0479 01440000
*           VOLACCIN=BLANK;         /* BLANK VOL SEC IND     @Y30OE95*/ 01441000
         MVI   VOLACCIN(VOL1PTR),C' '                              0480 01442000
*         END;                      /*                       @Y30OE95*/ 01443000
*     END;                          /*                       @Y30OE95*/ 01444000
*   RESPECIFY                                                      0483 01445000
*     VOL1PTR UNRSTD;               /* RELEASE VOL1PTR       @Y30OE6D*/ 01446000
*   END VOL1LABL;                   /* END OF SUBROUTINE     @Y30OE95*/ 01447000
@EL00008 DS    0H                                                  0484 01448000
@EF00008 DS    0H                                                  0484 01449000
@ER00008 L     @14,@SA00008                                        0484 01450000
         BR    @14                                                 0484 01451000
*                                                                  0485 01452000
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE95*/ 01453000
*/*                                                          @Y30OE95*/ 01454000
*/*  THIS SECTION WILL CHECK IF A DISKETTE IS SCRATCH AND    @Y30OE95*/ 01455000
*/*  CHECK ALL HDR1 LABELS FOR DELETED DATA SETS ('DDR1').   @Y30OE95*/ 01456000
*/*  IF NOT DELETED, CHECK FOR EXPIRED EXPIRATION DATES. IF  @Y30OE95*/ 01457000
*/*  ALL HDR1'S ARE EITHER DELETED OR EXPIRED, DISKETTE IS   @Y30OE95*/ 01458000
*/*  CONSIDERED SCRATCH.                                     @Y30OE95*/ 01459000
*/*                                                          @Y30OE95*/ 01460000
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE95*/ 01461000
*                                                                  0485 01462000
*CKSCRDSK:                          /*                       @Y30OE95*/ 01463000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30OE95*/ 01464000
CKSCRDSK ST    @14,@SA00009                                        0485 01465000
*   NOSRTCDS=OFF;                   /* SET NONSRTCH D.S. OFF @Y30OE95*/ 01466000
*   GOODHDR1=ON;                    /* SET GOOD HDR1 IND ON  @Y30OE6D*/ 01467000
         OI    GOODHDR1(AWORKPTR),B'00100000'                      0487 01468000
         NI    NOSRTCDS(AWORKPTR),B'11111011'                      0487 01469000
*   DO I=4 TO 22                    /* LOOP UNTIL A NON-     @Y30OE95*/ 01470000
*         WHILE NOSRTCDS=OFF;       /* SCRATCH D.S. IS FOUND @Y30OE95*/ 01471000
         LA    @11,4                                               0488 01472000
         ST    @11,I(,AWORKPTR)                                    0488 01473000
@DL00488 TM    NOSRTCDS(AWORKPTR),B'00000100'                      0488 01474000
         BNZ   @DC00488                                            0488 01475000
*     HDR1PTR=CHANPGM(I,2:4);       /* GET PTR TO HDR1       @Y30OE95*/ 01476000
         L     @11,I(,AWORKPTR)                                    0489 01477000
         SLA   @11,3                                               0489 01478000
         AL    @11,@CF02104                                        0489 01479000
         L     HDR1PTR,CHANPGM(@11,CHNPGMPT)                       0489 01480000
         LA    HDR1PTR,0(,HDR1PTR)                                 0489 01481000
*     IF HDRID(1)^=DELETED          /* IS THIS A DELETED DS  @Y30OE95*/ 01482000
*       THEN                        /* NO                    @Y30OE95*/ 01483000
         CLI   HDRID(HDR1PTR),C'D'                                 0490 01484000
         BE    @RF00490                                            0490 01485000
*       DO;                         /*                       @Y30OE6D*/ 01486000
*         IF HDREXDTE(1)^=BLANK     /* IS THERE AN EXP.      @Y30OE95*/ 01487000
*           THEN                    /* DATE                  @Y30OE95*/ 01488000
         CLI   HDREXDTE(HDR1PTR),C' '                              0492 01489000
         BE    @RF00492                                            0492 01490000
*           DO;                     /* YES, CONTINUE         @Y30OE95*/ 01491000
*             DO J=1 TO 6           /* SET LOOP FOR 6 CHARS. @ZA00796*/ 01492000
*                   WHILE GOODHDR1=ON;/* FOR VALIDATION      @Y30OE6D*/ 01493000
         LA    @11,1                                               0494 01494000
         ST    @11,J(,AWORKPTR)                                    0494 01495000
@DL00494 TM    GOODHDR1(AWORKPTR),B'00100000'                      0494 01496000
         BNO   @DC00494                                            0494 01497000
*               IF HDREXDTE(J)<CHAR0|/* DATE IS GOOD IF      @ZA04455*/ 01498000
*                   HDREXDTE(J)>CHAR9/* RANGE IS BETWEEN     @ZA04455*/ 01499000
*                 THEN              /* 0 AND 9               @Y30OE6D*/ 01500000
         L     @11,J(,AWORKPTR)                                    0495 01501000
         ALR   @11,HDR1PTR                                         0495 01502000
         CLI   HDREXDTE-1(@11),C'0'                                0495 01503000
         BL    @RT00495                                            0495 01504000
         L     @11,J(,AWORKPTR)                                    0495 01505000
         ALR   @11,HDR1PTR                                         0495 01506000
         CLI   HDREXDTE-1(@11),C'9'                                0495 01507000
         BNH   @RF00495                                            0495 01508000
@RT00495 DS    0H                                                  0496 01509000
*                 GOODHDR1=OFF;     /* IND BAD HDR1          @Y30OE6D*/ 01510000
         NI    GOODHDR1(AWORKPTR),B'11011111'                      0496 01511000
*             END;                  /*                       @Y30OE6D*/ 01512000
@RF00495 LA    @11,1                                               0497 01513000
         AL    @11,J(,AWORKPTR)                                    0497 01514000
         ST    @11,J(,AWORKPTR)                                    0497 01515000
         C     @11,@CF00412                                        0497 01516000
         BNH   @DL00494                                            0497 01517000
@DC00494 DS    0H                                                  0498 01518000
*             IF GOODHDR1=ON&       /* IF EXP DATE OK,       @Y30OE6D*/ 01519000
*                 (HDRMONTH>CHAR00& /* THEN CHECK FOR        @Y30OE6D*/ 01520000
*                 HDRMONTH<=CHAR12)&/* VALID MONTH AND       @Y30OE6D*/ 01521000
*                 (HDRDAY>CHAR00&   /* DAY ENTRIES           @Y30OE6D*/ 01522000
*                 HDRDAY<=CHAR31)   /*                       @Y30OE6D*/ 01523000
*               THEN                /*                       @Y30OE6D*/ 01524000
         TM    GOODHDR1(AWORKPTR),B'00100000'                      0498 01525000
         BNO   @RF00498                                            0498 01526000
         CLC   HDRMONTH(2,HDR1PTR),CHAR00                          0498 01527000
         BNH   @RF00498                                            0498 01528000
         CLC   HDRMONTH(2,HDR1PTR),CHAR12                          0498 01529000
         BH    @RF00498                                            0498 01530000
         CLC   HDRDAY(2,HDR1PTR),CHAR00                            0498 01531000
         BNH   @RF00498                                            0498 01532000
         CLC   HDRDAY(2,HDR1PTR),CHAR31                            0498 01533000
         BH    @RF00498                                            0498 01534000
*               DO;                 /*                       @Y30OE6D*/ 01535000
*                 RESPECIFY                                        0500 01536000
*                   REG1 RSTD;      /* RESTRICT REG 1        @Y30OE95*/ 01537000
*                 GEN;                                             0501 01538000
*                                  /* GENERATE ASSEMBLER    @Y30OE95*/  01539000
               TIME DEC                ISSUE TIME MACRO       @Y30OE95  01540000
*                 SAVEDATE=REG1;    /* SAVE SYSTEM DATE      @Y30OE95*/ 01541000
         ST    REG1,SAVEDATE(,AWORKPTR)                            0502 01542000
*                 RESPECIFY                                        0503 01543000
*                   REG1 UNRSTD;    /* UNRESTRICT REG1       @Y30OE95*/ 01544000
*                 UNPK(UNPKDATE,SAVEDATE);/* CONV TO EBCDIC  @Y30OE95*/ 01545000
         UNPK  UNPKDATE(8,AWORKPTR),SAVEDATE(4,AWORKPTR)           0504 01546000
*                 PACK(SYSYEAR,UNPKYEAR);/* PACK SYS YEAR    @Y30OE95*/ 01547000
         PACK  SYSYEAR(2,AWORKPTR),UNPKYEAR(2,AWORKPTR)            0505 01548000
*                 SYSDAY=SAVEDATE(3:4);/* GET PACKED SYS DAY @Y30OE95*/ 01549000
         MVC   SYSDAY(2,AWORKPTR),SAVEDATE+2(AWORKPTR)             0506 01550000
*                 PACK(HDRYEAR1,HDRYEAR);/* PACK HDR1 YEAR   @Y30OE95*/ 01551000
         PACK  HDRYEAR1(2,AWORKPTR),HDRYEAR(2,HDR1PTR)             0507 01552000
*                 IF HDRYEAR1=SYSYEAR/* IS THE YEAR THE SAME @Y30OE95*/ 01553000
*                   THEN            /* YES                   @Y30OE95*/ 01554000
         CLC   HDRYEAR1(2,AWORKPTR),SYSYEAR(AWORKPTR)              0508 01555000
         BNE   @RF00508                                            0508 01556000
*                   DO;             /* CONTINUE              @Y30OE95*/ 01557000
*                     PACK(HDRDAY1,HDRDAY);/* PACK HDR1 DAY  @Y30OE95*/ 01558000
         PACK  HDRDAY1(2,AWORKPTR),HDRDAY(2,HDR1PTR)               0510 01559000
*                     PACK(HDRMTH1,HDRMONTH);/* PACK HDR1 MON      0511 01560000
*                                                            @Y30OE95*/ 01561000
         PACK  HDRMTH1(2,AWORKPTR),HDRMONTH(2,HDR1PTR)             0511 01562000
*                     CVB(MONTH,HDRMTH1);/* GET BINARY MONTH @Y30OE95*/ 01563000
         XC    @TS00001(8),@TS00001                                0512 01564000
         MVC   @TS00001+6(2),HDRMTH1(AWORKPTR)                     0512 01565000
         CVB   @11,@TS00001                                        0512 01566000
         STC   @11,MONTH(,AWORKPTR)                                0512 01567000
*                     CVB(DAY,HDRDAY1);/* GET BINARY DAY     @Y30OE95*/ 01568000
         XC    @TS00001(8),@TS00001                                0513 01569000
         MVC   @TS00001+6(2),HDRDAY1(AWORKPTR)                     0513 01570000
         CVB   @08,@TS00001                                        0513 01571000
         STC   @08,DAY(,AWORKPTR)                                  0513 01572000
*                     CVB(YEAR,HDRYEAR1);/* GET BINARY YEAR  @Y30OE95*/ 01573000
         XC    @TS00001(8),@TS00001                                0514 01574000
         MVC   @TS00001+6(2),HDRYEAR1(AWORKPTR)                    0514 01575000
         CVB   @15,@TS00001                                        0514 01576000
         STC   @15,YEAR(,AWORKPTR)                                 0514 01577000
*                     REMAIN=YEAR//FOUR;/* DIVIDE YEAR BY 4  @Y30OE95   01578000
*                                      AND SAVE REMAINDER    @Y30OE95*/ 01579000
         LR    @00,@15                                             0515 01580000
         SRDA  @00,32                                              0515 01581000
         D     @00,@CF01897                                        0515 01582000
         STCM  @00,15,REMAIN(AWORKPTR)                             0515 01583000
*                     IF REMAIN=ZEROS/* IS THIS A LEAP YEAR  @Y30OE95*/ 01584000
*                       THEN        /* YES                   @Y30OE95*/ 01585000
         C     @00,ZEROS                                           0516 01586000
         BNE   @RF00516                                            0516 01587000
*                       JULIANDY=LPYRTBL(MONTH)+DAY;/* GET   @Y30OE95   01588000
*                                      JULIAN DAY            @Y30OE95*/ 01589000
         ALR   @11,@11                                             0517 01590000
         AH    @08,LPYRTBL-2(@11)                                  0517 01591000
         STH   @08,JULIANDY(,AWORKPTR)                             0517 01592000
*                     ELSE          /*                       @Y30OE95*/ 01593000
*                       JULIANDY=NLPYRTBL(MONTH)+DAY;/* GET  @Y30OE95   01594000
*                                      JULIANDY FOR          @Y30OE95   01595000
*                                      NON-LEAP YEAR         @Y30OE95*/ 01596000
         B     @RC00516                                            0518 01597000
@RF00516 SLR   @11,@11                                             0518 01598000
         IC    @11,MONTH(,AWORKPTR)                                0518 01599000
         ALR   @11,@11                                             0518 01600000
         SLR   @08,@08                                             0518 01601000
         IC    @08,DAY(,AWORKPTR)                                  0518 01602000
         AH    @08,NLPYRTBL-2(@11)                                 0518 01603000
         STH   @08,JULIANDY(,AWORKPTR)                             0518 01604000
*                     CVD(JULIANDY,JULIANDT);/* GET PACKED   @Y30OE95   01605000
*                                      JULIAN DAY            @Y30OE95*/ 01606000
@RC00516 LH    @11,JULIANDY(,AWORKPTR)                             0519 01607000
         CVD   @11,@TS00001                                        0519 01608000
         MVC   JULIANDT(2,AWORKPTR),@TS00001+6                     0519 01609000
*                     IF SYSDAY<JULIANDT/* HAS EXPIRATION    @Y30OE95   01610000
*                                      DATE BEEN MET         @Y30OE95*/ 01611000
*                       THEN        /* NO, D.S.IS STILL GOOD @Y30OE95*/ 01612000
         CLC   SYSDAY(2,AWORKPTR),JULIANDT(AWORKPTR)               0520 01613000
         BNL   @RF00520                                            0520 01614000
*                       NOSRTCDS=ON;/* INDIC NONSCRATCH DS   @Y30OE95*/ 01615000
         OI    NOSRTCDS(AWORKPTR),B'00000100'                      0521 01616000
*                   END;            /*                       @Y30OE95*/ 01617000
*                 ELSE              /*                       @Y30OE95*/ 01618000
*                   IF HDRYEAR1>SYSYEAR/* IS EXPIR YEAR >    @Y30OE95   01619000
*                                      THAN SYSTEM YEAR      @Y30OE95*/ 01620000
*                     THEN          /* YES, D.S. STILL GOOD  @Y30OE95*/ 01621000
         B     @RC00508                                            0523 01622000
@RF00508 CLC   HDRYEAR1(2,AWORKPTR),SYSYEAR(AWORKPTR)              0523 01623000
         BNH   @RF00523                                            0523 01624000
*                     NOSRTCDS=ON;  /* INDIC D.S. GOOD       @Y30OE95*/ 01625000
         OI    NOSRTCDS(AWORKPTR),B'00000100'                      0524 01626000
*               END;                /*                       @Y30OE95*/ 01627000
*             ELSE                  /*                       @Y30OE95*/ 01628000
*               DO;                 /*                       @Y30OE95*/ 01629000
         B     @RC00498                                            0526 01630000
@RF00498 DS    0H                                                  0527 01631000
*                 GOODHDR1=OFF;     /* IND BAD HDR1          @Y30OE95*/ 01632000
*                 NOSRTCDS=ON;      /* IND NO SCRATCH DS     @Y30OE95*/ 01633000
         OI    NOSRTCDS(AWORKPTR),B'00000100'                      0528 01634000
         NI    GOODHDR1(AWORKPTR),B'11011111'                      0528 01635000
*               END;                /*                       @Y30OE95*/ 01636000
*           END;                    /*                       @Y30OE6D*/ 01637000
@RC00498 DS    0H                                                  0531 01638000
*         IF HDRWTPTI^=BLANK        /* D.S. WRITE PROTECTED  @Y30OE95*/ 01639000
*           THEN                    /* YES                   @Y30OE95*/ 01640000
@RF00492 CLI   HDRWTPTI(HDR1PTR),C' '                              0531 01641000
         BE    @RF00531                                            0531 01642000
*           IF HDRWTPTI=P           /* IS IND EQUAL TO A 'P' @Y30OE95*/ 01643000
*             THEN                  /*                       @Y30OE95*/ 01644000
         CLI   HDRWTPTI(HDR1PTR),C'P'                              0532 01645000
         BNE   @RF00532                                            0532 01646000
*             NOSRTCDS=ON;          /* IND NOT SCRTCH D.S.   @Y30OE95*/ 01647000
         OI    NOSRTCDS(AWORKPTR),B'00000100'                      0533 01648000
*           ELSE                    /*                       @Y30OE95*/ 01649000
*             DO;                   /*                       @Y30OE95*/ 01650000
         B     @RC00532                                            0534 01651000
@RF00532 DS    0H                                                  0535 01652000
*               GOODHDR1=OFF;       /* IND BAD HDR1          @Y30OE95*/ 01653000
*               NOSRTCDS=ON;        /* IND NO SCRATCH DS     @Y30OE95*/ 01654000
         OI    NOSRTCDS(AWORKPTR),B'00000100'                      0536 01655000
         NI    GOODHDR1(AWORKPTR),B'11011111'                      0536 01656000
*             END;                  /*                       @Y30OE95*/ 01657000
*       END;                        /*                       @Y30OE6D*/ 01658000
@RC00532 DS    0H                                                  0538 01659000
@RF00531 DS    0H                                                  0539 01660000
*   END;                            /*                       @Y30OE95*/ 01661000
@RF00490 LA    @11,1                                               0539 01662000
         AL    @11,I(,AWORKPTR)                                    0539 01663000
         ST    @11,I(,AWORKPTR)                                    0539 01664000
         C     @11,@CF01653                                        0539 01665000
         BNH   @DL00488                                            0539 01666000
@DC00488 DS    0H                                                  0540 01667000
*                                                                  0540 01668000
*   /*****************************************************************/ 01669000
*   /*                                                               */ 01670000
*   /* IF DISKETTE IS NON-SCRATCH, ISSUE MESSAGE AND         @Y30OE95*/ 01671000
*   /* RETURN TO CHECK ANOTHER DISKETTE.                     @Y30OE95*/ 01672000
*   /*                                                               */ 01673000
*   /*****************************************************************/ 01674000
*                                                                  0540 01675000
*   IF NOSRTCDS=OFF                 /* WERE ANY NON-SCRATCH  @Y30OE95   01676000
*                                      DATA SETS FOUND       @Y30OE95*/ 01677000
*     THEN                          /* NO                    @Y30OE95*/ 01678000
         TM    NOSRTCDS(AWORKPTR),B'00000100'                      0540 01679000
         BNZ   @RF00540                                            0540 01680000
*     SCRCHDSK=ON;                  /* IND SCRATCH DISKETTE  @Y30OE95*/ 01681000
         OI    SCRCHDSK(AWORKPTR),B'00001000'                      0541 01682000
*   ELSE                            /*                       @Y30OE95*/ 01683000
*     DO;                           /*                       @Y30OE6D*/ 01684000
         B     @RC00540                                            0542 01685000
@RF00540 DS    0H                                                  0543 01686000
*       IF GOODHDR1=OFF             /* WAS BAD HDR1 FOUND    @Y30OE95*/ 01687000
*         THEN                      /* YES                   @Y30OE95*/ 01688000
         TM    GOODHDR1(AWORKPTR),B'00100000'                      0543 01689000
         BNZ   @RF00543                                            0543 01690000
*         DO;                       /*                       @Y30OE6D*/ 01691000
*           MSGINDEX=HDR1MSG;       /* INDEX FOR HDR1 MSG 15 @Y30OE6D*/ 01692000
         MVI   MSGINDEX(AWORKPTR),X'0F'                            0545 01693000
*           DSIDTXT=HDRDSID;        /* GET BAD HDR1 DSID     @Y30OE6D*/ 01694000
         MVC   DSIDTXT(8),HDRDSID(HDR1PTR)                         0546 01695000
*         END;                      /*                       @Y30OE6D*/ 01696000
*       ELSE                        /*                       @Y30OE95*/ 01697000
*         MSGINDEX=NONSMSG;         /* SET INDEX FOR MSG 19  @Y30OE6D*/ 01698000
         B     @RC00543                                            0548 01699000
@RF00543 MVI   MSGINDEX(AWORKPTR),X'13'                            0548 01700000
*       CALL MSGSUBRT;              /* CALL THE MSG SUBROUT. @Y30OE6D*/ 01701000
@RC00543 BAL   @14,MSGSUBRT                                        0549 01702000
*       DSIDTXT=SDKTDSID;           /* RESTORE OPENING DSID  @Y30OE6D*/ 01703000
         MVC   DSIDTXT(8),SDKTDSID(SETDSKPT)                       0550 01704000
*     END;                          /*                       @Y30OE95*/ 01705000
*   END CKSCRDSK;                   /* END OF PROCEDURE      @Y30OE95*/ 01706000
@EL00009 DS    0H                                                  0552 01707000
@EF00009 DS    0H                                                  0552 01708000
@ER00009 L     @14,@SA00009                                        0552 01709000
         BR    @14                                                 0552 01710000
*                                                                  0553 01711000
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE95*/ 01712000
*/*                                                          @Y30OE95*/ 01713000
*/*  THIS SECTION WILL BLANK OUT ALL THE HDR1 LABELS OF A    @Y30OE95*/ 01714000
*/*  SCRATCH DISKETTE TO LOOK AS FOLLOWS:                    @Y30OE95*/ 01715000
*/*    DDR1 NODATA (BLANKS TO COL 80).                       @Y30OE95*/ 01716000
*/*  SET THE CCW CHAIN TO WRITE 20 RECORDS ON TRACK 0,       @Y30OE6D*/ 01717000
*/*  RECORDS 7 TO 26.                                        @Y30OE6D*/ 01718000
*/*                                                          @Y30OE95*/ 01719000
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE95*/ 01720000
*                                                                  0553 01721000
*BLANKHDR:                          /*                       @Y30OE95*/ 01722000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30OE95*/ 01723000
BLANKHDR ST    @14,@SA00010                                        0553 01724000
*   IOBSKSS=SEVEN;                  /* PT IOB TO TRK 0 REC 7 @Y30OE6D*/ 01725000
         MVI   IOBSKSS(IOBSTPTR),X'07'                             0554 01726000
*   CHANPGM(1,1:8)=CCWD3;           /* PUT DFN CCW IN CHAIN  @Y30OE6D*/ 01727000
         MVC   CHANPGM(8,CHNPGMPT),CCWD3                           0555 01728000
*   CCW21SAV=CHANPGM(23);           /* SAVE CCW21            @Y30OE6D*/ 01729000
         MVC   CCW21SAV(8,AWORKPTR),CHANPGM+176(CHNPGMPT)          0556 01730000
*   CHANPGM(23,1:8)=CCWD2;          /* PUT DFN CCW IN CHAIN  @Y30OE6D*/ 01731000
         MVC   CHANPGM+176(8,CHNPGMPT),CCWD2                       0557 01732000
*   DO I=3 TO 22;                   /* SET LOOP FOR 20 RECDS @Y30OE6D*/ 01733000
         LA    @11,3                                               0558 01734000
         ST    @11,I(,AWORKPTR)                                    0558 01735000
@DL00558 DS    0H                                                  0559 01736000
*     CHANPGM(I,7:8)=COUNT80;       /* CHANGE COUNT TO 80    @Y30OE6D*/ 01737000
         L     @11,I(,AWORKPTR)                                    0559 01738000
         SLA   @11,3                                               0559 01739000
         LH    @08,COUNT80                                         0559 01740000
         ALR   @11,CHNPGMPT                                        0559 01741000
         BCTR  @11,0                                               0559 01742000
         BCTR  @11,0                                               0559 01743000
         STCM  @08,3,CHANPGM(@11)                                  0559 01744000
*   END;                            /*                       @Y30OE95*/ 01745000
*                                                                  0560 01746000
         LA    @11,1                                               0560 01747000
         AL    @11,I(,AWORKPTR)                                    0560 01748000
         ST    @11,I(,AWORKPTR)                                    0560 01749000
         C     @11,@CF01653                                        0560 01750000
         BNH   @DL00558                                            0560 01751000
*   /*****************************************************************/ 01752000
*   /*                                                               */ 01753000
*   /* POINT ALL CCW'S TO SAME BUFFER (I.E., BUFFER          @Y30OE95*/ 01754000
*   /* POINTED TO BY RWCCW1.                                 @Y30OE95*/ 01755000
*   /*                                                               */ 01756000
*   /*****************************************************************/ 01757000
*                                                                  0561 01758000
*   DO I=5 TO 22;                   /* SET LOOP FOR 18 HDR'S @Y30OE6D*/ 01759000
         LA    @11,5                                               0561 01760000
         ST    @11,I(,AWORKPTR)                                    0561 01761000
@DL00561 DS    0H                                                  0562 01762000
*     SAVEADDR(I)=CHANPGM(I,1:4);   /* SAVE DATA ADDR OF     @Y30OE95   01763000
*                                      RWCCW3-20             @Y30OE6D*/ 01764000
         L     @11,I(,AWORKPTR)                                    0562 01765000
         LR    @08,@11                                             0562 01766000
         SLA   @08,2                                               0562 01767000
         ALR   @08,AWORKPTR                                        0562 01768000
         SLA   @11,3                                               0562 01769000
         ST    @11,@TF00001                                        0562 01770000
         ALR   @11,CHNPGMPT                                        0562 01771000
         AL    @11,@CF02104                                        0562 01772000
         MVC   SAVEADDR-4(4,@08),CHANPGM(@11)                      0562 01773000
*     CHANPGM(I,1:4)=CHANPGM(4,1:4);/* POINT RWCCW'S         @Y30OE6D   01774000
*                                      TO SAME DATAAD        @Y30OE95*/ 01775000
         LR    @11,CHNPGMPT                                        0563 01776000
         AL    @11,@TF00001                                        0563 01777000
         AL    @11,@CF02104                                        0563 01778000
         MVC   @TS00001(4),CHANPGM+24(CHNPGMPT)                    0563 01779000
         MVC   CHANPGM(4,@11),@TS00001                             0563 01780000
*     CHANPGM(I,1)=WRTCNTL;         /* CHANGE CMD CODE TO    @ZA28058*/ 01781000
*                                                                  0564 01782000
         LR    @11,CHNPGMPT                                        0564 01783000
         AL    @11,@TF00001                                        0564 01784000
         AL    @11,@CF02104                                        0564 01785000
         MVI   CHANPGM(@11),X'21'                                  0564 01786000
*     /***************************************************************/ 01787000
*     /*                                                             */ 01788000
*     /* WRITE W/CONTROL                                     @ZA28058*/ 01789000
*     /*                                                             */ 01790000
*     /***************************************************************/ 01791000
*                                                                  0565 01792000
*   END;                            /*                       @Y30OE95*/ 01793000
*                                                                  0565 01794000
         LA    @11,1                                               0565 01795000
         AL    @11,I(,AWORKPTR)                                    0565 01796000
         ST    @11,I(,AWORKPTR)                                    0565 01797000
         C     @11,@CF01653                                        0565 01798000
         BNH   @DL00561                                            0565 01799000
*   /*****************************************************************/ 01800000
*   /*                                                               */ 01801000
*   /* BUILD BLANK HDR1 IN BUFFER POINED TO BY RWCCW1        @Y30OE95*/ 01802000
*   /*                                                               */ 01803000
*   /*****************************************************************/ 01804000
*                                                                  0566 01805000
*   HDR1PTR=CHANPGM(4,2:4);         /* GET PTR TO 1ST HDR1   @Y30OE6D*/ 01806000
         SLR   HDR1PTR,HDR1PTR                                     0566 01807000
         ICM   HDR1PTR,7,CHANPGM+25(CHNPGMPT)                      0566 01808000
*   HDR13540='';                    /* BLANK HDR1 LABEL      @Y30OE6D*/ 01809000
         MVI   HDR13540(HDR1PTR),C' '                              0567 01810000
         MVC   HDR13540+1(79,HDR1PTR),HDR13540(HDR1PTR)            0567 01811000
*   HDRID=DDR1;                     /* INDICATE DELETED D.S. @Y30OE95*/ 01812000
         MVC   HDRID(4,HDR1PTR),DDR1                               0568 01813000
*   HDRDSID(1:6)=NODATA;            /* DSID = 'NODATA'       @Y30OE95*/ 01814000
         MVC   HDRDSID(6,HDR1PTR),NODATA                           0569 01815000
*                                                                  0570 01816000
*   /*****************************************************************/ 01817000
*   /*                                                               */ 01818000
*   /* WRITE BLANK HDR1'S AND RESTORE CCW CHAIN              @Y30OE95*/ 01819000
*   /*                                                               */ 01820000
*   /*****************************************************************/ 01821000
*                                                                  0570 01822000
*   CALL IOSBRTN;                   /* GO DO I/O             @Y30OE95*/ 01823000
         BAL   @14,IOSBRTN                                         0570 01824000
*   DO I=5 TO 22;                   /* SET LOOP FOR 18 HDR'S @Y30OE6D*/ 01825000
         LA    @11,5                                               0571 01826000
         ST    @11,I(,AWORKPTR)                                    0571 01827000
@DL00571 DS    0H                                                  0572 01828000
*     CHANPGM(I,1:4)=SAVEADDR(I);   /* RESTORE DATAADR       @Y30OE95*/ 01829000
         L     @11,I(,AWORKPTR)                                    0572 01830000
         LR    @08,@11                                             0572 01831000
         SLA   @08,3                                               0572 01832000
         ST    @08,@TF00001                                        0572 01833000
         ALR   @08,CHNPGMPT                                        0572 01834000
         AL    @08,@CF02104                                        0572 01835000
         SLA   @11,2                                               0572 01836000
         ALR   @11,AWORKPTR                                        0572 01837000
         MVC   CHANPGM(4,@08),SAVEADDR-4(@11)                      0572 01838000
*     CHANPGM(I,1)=WRITEOP;         /* RESTORE WRT CMD CODE  @ZA28058*/ 01839000
         LR    @11,CHNPGMPT                                        0573 01840000
         AL    @11,@TF00001                                        0573 01841000
         AL    @11,@CF02104                                        0573 01842000
         MVI   CHANPGM(@11),X'05'                                  0573 01843000
*   END;                            /*                       @Y30OE95*/ 01844000
         LA    @11,1                                               0574 01845000
         AL    @11,I(,AWORKPTR)                                    0574 01846000
         ST    @11,I(,AWORKPTR)                                    0574 01847000
         C     @11,@CF01653                                        0574 01848000
         BNH   @DL00571                                            0574 01849000
*   CHANPGM(23)=CCW21SAV;           /* RESTORE RWCCW21       @Y30OE6D*/ 01850000
         MVC   CHANPGM+176(8,CHNPGMPT),CCW21SAV(AWORKPTR)          0575 01851000
*   CHANPGM(1,1)=NOOP;              /* RESTORE NOOPECCW      @Y30OE6D*/ 01852000
         MVI   CHANPGM(CHNPGMPT),X'03'                             0576 01853000
*   IF ERTNCDE^=GOODRTN             /* DID I/O ERROR OCCUR   @Y30OE6D*/ 01854000
*     THEN                          /*                       @Y30OE6D*/ 01855000
         CLI   ERTNCDE(SETDSKPT),X'00'                             0577 01856000
         BE    @RF00577                                            0577 01857000
*     SETRETCD=IOERROR;             /* YES, SET I/O RTN CODE @Y30OE6D*/ 01858000
         MVI   SETRETCD+1(SETDSKPT),X'00'                          0578 01859000
         MVI   SETRETCD(SETDSKPT),X'10'                            0578 01860000
*   END BLANKHDR;                   /* END OF SUBROUTINE     @Y30OE6D*/ 01861000
@EL00010 DS    0H                                                  0579 01862000
@EF00010 DS    0H                                                  0579 01863000
@ER00010 L     @14,@SA00010                                        0579 01864000
         BR    @14                                                 0579 01865000
*                                                                  0580 01866000
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE95*/ 01867000
*/*                                                          @Y30OE95*/ 01868000
*/*  THIS SECTION CALCULATES THE BEGIN OF EXTENT (BOE), END  @Y30OE95*/ 01869000
*/*  OF EXTENT (EOE) AND END OF DATA (EOD) OF THE DATA SET.  @Y30OE95*/ 01870000
*/*                                                          @Y30OE95*/ 01871000
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE95*/ 01872000
*                                                                  0580 01873000
*CALCEXTS:                          /*                       @Y30OE95*/ 01874000
*   PROC OPTIONS(NOSAVE);           /*                       @Y30OE6D*/ 01875000
*                                                                  0580 01876000
CALCEXTS DS    0H                                                  0581 01877000
*   /*****************************************************************/ 01878000
*   /*                                                               */ 01879000
*   /* CALCULATE BOE                                         @Y30OE95*/ 01880000
*   /*                                                               */ 01881000
*   /*****************************************************************/ 01882000
*                                                                  0581 01883000
*   RESPECIFY                                                      0581 01884000
*     REG14 RSTD;                   /* RESTRICT R14          @Y30OE6D*/ 01885000
*   CVD(AMWBOETT,TEMP1);            /* GET PACKED TRK NUM    @Y30OE6D*/ 01886000
         SLR   @15,@15                                             0582 01887000
         IC    @15,AMWBOETT(,AWORKPTR)                             0582 01888000
         CVD   @15,@TS00001                                        0582 01889000
         MVC   TEMP1(2,AWORKPTR),@TS00001+6                        0582 01890000
*   UNPK(HDRBOECC,TEMP1);           /* CHANGE SAME TO EBCDIC @Y30OE95*/ 01891000
         UNPK  HDRBOECC(2,HDR1PTR),TEMP1(2,AWORKPTR)               0583 01892000
*   HDRBOECC(2)=HDRBOECC(2)|CHAR0;  /* CHANGE SIGN           @Y30OE6D*/ 01893000
         OI    HDRBOECC+1(HDR1PTR),C'0'                            0584 01894000
*   CVD(AMWBOESS,TEMP1);            /* GET PACKED REC NUM    @Y30OE6D*/ 01895000
         SLR   @15,@15                                             0585 01896000
         IC    @15,AMWBOESS(,AWORKPTR)                             0585 01897000
         CVD   @15,@TS00001                                        0585 01898000
         MVC   TEMP1(2,AWORKPTR),@TS00001+6                        0585 01899000
*   UNPK(HDRBOERR,TEMP1);           /* CHANGE SAME TO EBCDIC @Y30OE95*/ 01900000
         UNPK  HDRBOERR(2,HDR1PTR),TEMP1(2,AWORKPTR)               0586 01901000
*   HDRBOERR(2)=HDRBOERR(2)|CHAR0;  /* CHANGE SIGN           @Y30OE6D*/ 01902000
         OI    HDRBOERR+1(HDR1PTR),C'0'                            0587 01903000
*   HDRBOEH=CHAR0;                  /* PUT ZERO FOR HEADER   @Y30OE6D*/ 01904000
*                                                                  0588 01905000
         MVI   HDRBOEH(HDR1PTR),C'0'                               0588 01906000
*   /*****************************************************************/ 01907000
*   /*                                                               */ 01908000
*   /* CALCULATE EOE                                         @Y30OE95*/ 01909000
*   /*                                                               */ 01910000
*   /*****************************************************************/ 01911000
*                                                                  0589 01912000
*   I=((CCWPTR-CHNPGMPT)/EIGHT)-TWO;/*                       @Y30OE95*/ 01913000
         L     @00,CCWPTR-1(,AWORKPTR)                             0589 01914000
         ICM   @00,8,@CB01893                                      0589 01915000
         SLR   @00,CHNPGMPT                                        0589 01916000
         SRDA  @00,32                                              0589 01917000
         D     @00,@CF01815                                        0589 01918000
         BCTR  @01,0                                               0589 01919000
         BCTR  @01,0                                               0589 01920000
         ST    @01,I(,AWORKPTR)                                    0589 01921000
*   IOBSKSS=IOBSKSS+I;              /* UPDATE IOB SEEKADR BY @Y30OE95   01922000
*                                      NUMBER OF REC WRITTEN @Y30OE95*/ 01923000
         SLR   @15,@15                                             0590 01924000
         IC    @15,IOBSKSS(,IOBSTPTR)                              0590 01925000
         ALR   @01,@15                                             0590 01926000
         STC   @01,IOBSKSS(,IOBSTPTR)                              0590 01927000
*   CVD(IOBSKTT,TEMP1);             /* GET PACKED START TRK  @Y30OE95*/ 01928000
         SLR   @15,@15                                             0591 01929000
         IC    @15,IOBSKTT(,IOBSTPTR)                              0591 01930000
         CVD   @15,@TS00001                                        0591 01931000
         MVC   TEMP1(2,AWORKPTR),@TS00001+6                        0591 01932000
*   UNPK(HDREOECC,TEMP1);           /* GET HDR EOE TRACK     @Y30OE95*/ 01933000
         UNPK  HDREOECC(2,HDR1PTR),TEMP1(2,AWORKPTR)               0592 01934000
*   HDREOECC(2)=HDREOECC(2)|CHAR0;  /* CHANGE SIGN           @Y30OE6D*/ 01935000
         OI    HDREOECC+1(HDR1PTR),C'0'                            0593 01936000
*   HDREOERR=CHAR26;                /* CHANGE REC NUM TO 26  @Y30OE6D*/ 01937000
         MVC   HDREOERR(2,HDR1PTR),CHAR26                          0594 01938000
*   HDREOEH=CHAR0;                  /* HDR EOE HEADER = 0    @Y30OE6D*/ 01939000
         MVI   HDREOEH(HDR1PTR),C'0'                               0595 01940000
*                                                                  0596 01941000
*   /*****************************************************************/ 01942000
*   /*                                                               */ 01943000
*   /* CALCULATE EOD. IF LAST BUFFER WRITTEN WAS FULL,       @Y30OE95*/ 01944000
*   /* EOD WILL EQUAL RECORD 1 OF THE NEXT TRACK.            @Y30OE95*/ 01945000
*   /*                                                               */ 01946000
*   /*****************************************************************/ 01947000
*                                                                  0596 01948000
*   IF IOBSKSS>TWNTYSIX             /* IS REC NUM > 26       @Y30OE95*/ 01949000
*     THEN                          /* YES                   @Y30OE95*/ 01950000
         CLI   IOBSKSS(IOBSTPTR),26                                0596 01951000
         BNH   @RF00596                                            0596 01952000
*     DO;                           /* CONTINUE              @Y30OE95*/ 01953000
*       IOBSKTT=IOBSKTT+ONE;        /* UPDTE TRK NUM BY 1    @Y30OE95*/ 01954000
         AL    @15,@CF01817                                        0598 01955000
         STC   @15,IOBSKTT(,IOBSTPTR)                              0598 01956000
*       CVD(IOBSKTT,TEMP1);         /* GET PACKED TRK NUM    @Y30OE95*/ 01957000
         CVD   @15,@TS00001                                        0599 01958000
         MVC   TEMP1(2,AWORKPTR),@TS00001+6                        0599 01959000
*       UNPK(HDREODCC,TEMP1);       /* EBCDIC TRK NO TO HDR  @Y30OE95*/ 01960000
         UNPK  HDREODCC(2,HDR1PTR),TEMP1(2,AWORKPTR)               0600 01961000
*       HDREODCC(2)=HDREODCC(2)|CHAR0;/* CHANGE SIGN         @Y30OE6D*/ 01962000
         OI    HDREODCC+1(HDR1PTR),C'0'                            0601 01963000
*       HDREODH=CHAR0;              /* HDR EOD HEADER = ZERO @Y30OE6D*/ 01964000
         MVI   HDREODH(HDR1PTR),C'0'                               0602 01965000
*       HDREODRR=CHAR01;            /* HDR EOD REC NUM = 1   @Y30OE6D*/ 01966000
         MVC   HDREODRR(2,HDR1PTR),CHAR01                          0603 01967000
*     END;                          /*                       @Y30OE95*/ 01968000
*   ELSE                            /*                       @Y30OE95*/ 01969000
*     DO;                           /* CONTINUE              @Y30OE95*/ 01970000
         B     @RC00596                                            0605 01971000
@RF00596 DS    0H                                                  0606 01972000
*       CVD(IOBSKSS,TEMP1);         /* GET PACKED REC NUM    @Y30OE95*/ 01973000
         SLR   @15,@15                                             0606 01974000
         IC    @15,IOBSKSS(,IOBSTPTR)                              0606 01975000
         CVD   @15,@TS00001                                        0606 01976000
         MVC   TEMP1(2,AWORKPTR),@TS00001+6                        0606 01977000
*       UNPK(HDREODRR,TEMP1);       /* CHANGE SAME TO EBCDIC @Y30OE95*/ 01978000
         UNPK  HDREODRR(2,HDR1PTR),TEMP1(2,AWORKPTR)               0607 01979000
*       HDREODRR(2)=HDREODRR(2)|CHAR0;/* CHANGE SIGN         @Y30OE6D*/ 01980000
         OI    HDREODRR+1(HDR1PTR),C'0'                            0608 01981000
*       HDREODCC=HDREOECC;          /* HDR EOD TRK = EOE TRK @Y30OE95*/ 01982000
         MVC   HDREODCC(2,HDR1PTR),HDREOECC(HDR1PTR)               0609 01983000
*       HDREODH=CHAR0;              /* HDR EOD HEADER = ZERO @Y30OE6D*/ 01984000
         MVI   HDREODH(HDR1PTR),C'0'                               0610 01985000
*       RESPECIFY                                                  0611 01986000
*         REG14 UNRSTD;             /* RELEASE R14           @Y30OE6D*/ 01987000
*     END;                          /*                       @Y30OE95*/ 01988000
*   END CALCEXTS;                   /* END OF SUBROUTINE     @Y30OE95*/ 01989000
@EL00011 DS    0H                                                  0613 01990000
@EF00011 DS    0H                                                  0613 01991000
@ER00011 BR    @14                                                 0613 01992000
*                                                                  0614 01993000
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE6D*/ 01994000
*/*  THIS SUBROUTINE IS ENTERED WHENEVER THE USER SPECIFIES  @Y30OE6D*/ 01995000
*/*  THE SECURITY PARAMETER ON THE START COMMAND FOR THE     @Y30OE6D*/ 01996000
*/*  ERIC WRITER.  A MESSAGE IS ISSUED TO THE OPERATOR TO    @Y30OE6D*/ 01997000
*/*  SPECIFY THE SECURITY INFORMATION FOR THE VOLUME AND     @Y30OE6D*/ 01998000
*/*  DATA SET.  THE FORMAT OF THE REPLY IS 'YYMMDD,W,D,V'.   @Y30OE6D*/ 01999000
*/*  WHERE YYMMDD IS THE EXPIRATION DATE OF THE DATA SET     @Y30OE6D*/ 02000000
*/*  ENTERED IN THE FORM YEAR, MONTH AND DAY.  IF NOT        @Y30OE6D*/ 02001000
*/*  SPECIFIED A DEFAULT 7 DAY EXPIRATION DATE WILL BE       @Y30OE6D*/ 02002000
*/*  ASSIGNED.                                               @Y30OE6D*/ 02003000
*/*                                                          @Y30OE6D*/ 02004000
*/*  W IS A ONE CHARACTER WRITE PROTECT INDICATOR FOR THE    @Y30OE6D*/ 02005000
*/*  DATA SET AND CAN BE SPECIFIED WITH A 'P' FOR WRITE      @Y30OE6D*/ 02006000
*/*  PROTECT OR A BLANK (' ') FOR NO WRITE PROTECT.  DEFAULT @Y30OE6D*/ 02007000
*/*  IS NO WRITE PROTECT.                                    @Y30OE6D*/ 02008000
*/*                                                          @Y30OE6D*/ 02009000
*/*  D IS A ONE CHARACTER SECURITY INDICATOR FOR THE DATA    @Y30OE6D*/ 02010000
*/*  SET AND CAN BE SPECIFIED BY ANY CHARACTER EXCEPT A      @Y30OE6D*/ 02011000
*/*  BLANK (' ').  DEFAULT IS NO DATA SECURITY.              @Y30OE6D*/ 02012000
*/*                                                          @Y30OE6D*/ 02013000
*/*  V IS A ONE CHARACTER VOLUME ACCESSABILITY INDICATOR     @Y30OE6D*/ 02014000
*/*  FOR THE VOLUME AND CAN BE SPECIFIED BY ANY CHARACTER    @Y30OE6D*/ 02015000
*/*  EXCEPT A BLANK (' ').  DEFAULT IS NO VOLUME SECURITY.   @Y30OE6D*/ 02016000
*/*                                                          @Y30OE6D*/ 02017000
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE6D*/ 02018000
*                                                                  0614 02019000
*SECRPROC:                          /*                       @Y30OE95*/ 02020000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30OE95*/ 02021000
SECRPROC ST    @14,@SA00012                                        0614 02022000
*   BADREPLY=ON;                    /* INITIALIZE FLAG       @Y30OE6D*/ 02023000
         OI    BADREPLY(AWORKPTR),B'00100000'                      0615 02024000
*   MSGINDEX=SSECMSG;               /* SET INDEX FOR MSG 24  @Y30OE6D*/ 02025000
*                                                                  0616 02026000
         MVI   MSGINDEX(AWORKPTR),X'18'                            0616 02027000
*   /*****************************************************************/ 02028000
*   /*                                                               */ 02029000
*   /* IF ANY SYNTAX OR LOGIC ERROR IS FOUND IN THE REPLY,   @Y30OE95*/ 02030000
*   /* THE MESSAGE IS RE-ISSUED.                             @Y30OE95*/ 02031000
*   /*                                                               */ 02032000
*   /*****************************************************************/ 02033000
*                                                                  0617 02034000
*   DO WHILE BADREPLY=ON;           /* ISSUE MSG UNTIL REPLY @Y30OE6D   02035000
*                                      IS CORRECT            @Y30OE95*/ 02036000
         B     @DE00617                                            0617 02037000
@DL00617 DS    0H                                                  0618 02038000
*     BADREPLY=OFF;                 /* INITIALIZE FLAG       @Y30OE95*/ 02039000
         NI    BADREPLY(AWORKPTR),B'11011111'                      0618 02040000
*     AMWEXDTE(1)=ZERO;             /* ZERO 1ST POS OF YEAR  @Y30OE6D*/ 02041000
         MVI   AMWEXDTE(AWORKPTR),X'00'                            0619 02042000
*     AMWWTPTI=ZERO;                /* RESET WRITE PROT IND  @Y30OE6D*/ 02043000
         MVI   AMWWTPTI(AWORKPTR),X'00'                            0620 02044000
*     AMWDSSQL=ZERO;                /* RESET D S SECUR IND   @Y30OE6D*/ 02045000
         MVI   AMWDSSQL(AWORKPTR),X'00'                            0621 02046000
*     MSGTYPCD=WTORCD;              /* MSG TYPE IS WTOR      @Y30OE6D*/ 02047000
         MVI   MSGTYPCD(AWORKPTR),X'02'                            0622 02048000
*     CALL MSGSUBRT;                /* CALL THE MSG SUBROUT. @Y30OE6D*/ 02049000
         BAL   @14,MSGSUBRT                                        0623 02050000
*     RESPECIFY                                                    0624 02051000
*       REPLYPTR RSTD;              /* RESTRICT REPLY PTR    @Y30OE95*/ 02052000
*     RESPECIFY                                                    0625 02053000
*       VOL1PTR RSTD;               /* RESTRICT VOL1 PTR     @Y30OE95*/ 02054000
*     VOL1PTR=CHANPGM(3,2:4);       /* GET PTR TO VOL1 LABEL @Y30OE95*/ 02055000
         SLR   VOL1PTR,VOL1PTR                                     0626 02056000
         ICM   VOL1PTR,7,CHANPGM+17(CHNPGMPT)                      0626 02057000
*     REPLYPTR=MSGREPAD;            /* ADDR OF REPLY AREA    @Y30OE6D*/ 02058000
         L     REPLYPTR,MSGREPAD(,AWORKPTR)                        0627 02059000
*     IF REPLYCHR>BLANK             /* TEST FOR NULL REPLY   @Y30OE6D*/ 02060000
*       THEN                        /* REPLY NORMALLY        @Y30OE6D*/ 02061000
         CLI   REPLYCHR(REPLYPTR),C' '                             0628 02062000
         BNH   @RF00628                                            0628 02063000
*       DO;                         /*                       @Y30OE6D*/ 02064000
*         IF REPLYCHR^=COMMA        /* IS CHARACTER A COMMA  @Y30OE95*/ 02065000
*           THEN                    /* NO                    @Y30OE95*/ 02066000
         CLI   REPLYCHR(REPLYPTR),C','                             0630 02067000
         BE    @RF00630                                            0630 02068000
*           DO;                     /* CONTINUE              @Y30OE95*/ 02069000
*                                                                  0631 02070000
*             /*******************************************************/ 02071000
*             /*                                                     */ 02072000
*             /* CHECK FOR THE PRESENCE OF AN EXPIRATION     @Y30OE6D*/ 02073000
*             /* DATE AND PROCESS SAME IF ENTERED.           @Y30OE6D*/ 02074000
*             /*                                                     */ 02075000
*             /*******************************************************/ 02076000
*                                                                  0632 02077000
*             REPLYPTR=REPLYPTR+SIX;/* POINT PAST EXP DATE   @Y30OE95*/ 02078000
         AL    REPLYPTR,@CF01810                                   0632 02079000
*             DO I=1 TO 6           /* SET LOOP FOR 6 CHAR   @Y30OE6D*/ 02080000
*                   WHILE BADREPLY=OFF;/* VALIDATION         @Y30OE6D*/ 02081000
         LA    @15,1                                               0633 02082000
         ST    @15,I(,AWORKPTR)                                    0633 02083000
@DL00633 TM    BADREPLY(AWORKPTR),B'00100000'                      0633 02084000
         BNZ   @DC00633                                            0633 02085000
*               IF REPLYARA(I)<CHAR0|/* CHARACTER RANGE MUST @Y30OE6D*/ 02086000
*                   REPLYARA(I)>CHAR9/* BE BETWEEN 0 AND 9   @Y30OE6D*/ 02087000
*                 THEN              /*                       @Y30OE6D*/ 02088000
         L     @15,I(,AWORKPTR)                                    0634 02089000
         L     @14,MSGREPAD(,AWORKPTR)                             0634 02090000
         ALR   @15,@14                                             0634 02091000
         BCTR  @15,0                                               0634 02092000
         CLI   REPLYARA(@15),C'0'                                  0634 02093000
         BL    @RT00634                                            0634 02094000
         L     @15,I(,AWORKPTR)                                    0634 02095000
         ALR   @14,@15                                             0634 02096000
         BCTR  @14,0                                               0634 02097000
         CLI   REPLYARA(@14),C'9'                                  0634 02098000
         BNH   @RF00634                                            0634 02099000
@RT00634 DS    0H                                                  0635 02100000
*                 BADREPLY=ON;      /* IND BAD REPLY         @Y30OE6D*/ 02101000
         OI    BADREPLY(AWORKPTR),B'00100000'                      0635 02102000
*             END;                  /*                       @Y30OE6D*/ 02103000
@RF00634 LA    @15,1                                               0636 02104000
         AL    @15,I(,AWORKPTR)                                    0636 02105000
         ST    @15,I(,AWORKPTR)                                    0636 02106000
         C     @15,@CF00412                                        0636 02107000
         BNH   @DL00633                                            0636 02108000
@DC00633 DS    0H                                                  0637 02109000
*             IF BADREPLY=OFF       /* CHARACTER RANGE OK    @Y30OE6D*/ 02110000
*               THEN                /* YES                   @Y30OE6D*/ 02111000
         TM    BADREPLY(AWORKPTR),B'00100000'                      0637 02112000
         BNZ   @RF00637                                            0637 02113000
*               IF(REPLYMAP(3:4)>CHAR00&/* IS MONTH          @Y30OE6D*/ 02114000
*                   REPLYMAP(3:4)<=CHAR12)&/* AND DAY        @Y30OE6D*/ 02115000
*                   (REPLYMAP(5:6)>CHAR00&/* LIMIT           @Y30OE6D*/ 02116000
*                   REPLYMAP(5:6)<=CHAR31)/* RANGE OK        @Y30OE6D*/ 02117000
*                 THEN              /* YES                   @Y30OE95*/ 02118000
         L     @15,MSGREPAD(,AWORKPTR)                             0638 02119000
         CLC   REPLYMAP+2(2,@15),CHAR00                            0638 02120000
         BNH   @RF00638                                            0638 02121000
         CLC   REPLYMAP+2(2,@15),CHAR12                            0638 02122000
         BH    @RF00638                                            0638 02123000
         CLC   REPLYMAP+4(2,@15),CHAR00                            0638 02124000
         BNH   @RF00638                                            0638 02125000
         CLC   REPLYMAP+4(2,@15),CHAR31                            0638 02126000
         BH    @RF00638                                            0638 02127000
*                 AMWEXDTE=REPLYMAP(1:6);/* SAVE EXPIR DATE  @Y30OE6D*/ 02128000
         MVC   AMWEXDTE(6,AWORKPTR),REPLYMAP(@15)                  0639 02129000
*               ELSE                /*                       @Y30OE95*/ 02130000
*                 BADREPLY=ON;      /* INDICATE BAD REPLY    @Y30OE95*/ 02131000
         B     @RC00638                                            0640 02132000
@RF00638 OI    BADREPLY(AWORKPTR),B'00100000'                      0640 02133000
*           END;                    /*                       @Y30OE95*/ 02134000
@RC00638 DS    0H                                                  0641 02135000
@RF00637 DS    0H                                                  0642 02136000
*         IF REPLYCHR=COMMA         /* IS CHAR A COMMA       @Y30OE95*/ 02137000
*           THEN                    /* YES                   @Y30OE95*/ 02138000
@RF00630 CLI   REPLYCHR(REPLYPTR),C','                             0642 02139000
         BNE   @RF00642                                            0642 02140000
*           DO;                     /* CONTINUE              @Y30OE95*/ 02141000
*                                                                  0644 02142000
*             /*******************************************************/ 02143000
*             /*                                                     */ 02144000
*             /* CHECK FOR AND PROCESS WRITE PROTECT.        @Y30OE6D*/ 02145000
*             /*                                                     */ 02146000
*             /*******************************************************/ 02147000
*                                                                  0644 02148000
*             REPLYPTR=REPLYPTR+ONE;/* POINT TO NEXT CHAR    @Y30OE95*/ 02149000
         LA    @15,1                                               0644 02150000
         ALR   REPLYPTR,@15                                        0644 02151000
*             IF REPLYCHR^=COMMA    /* IS CHAR A COMMA       @Y30OE95*/ 02152000
*               THEN                /* NO                    @Y30OE95*/ 02153000
         CLI   REPLYCHR(REPLYPTR),C','                             0645 02154000
         BE    @RF00645                                            0645 02155000
*               IF REPLYCHR=P       /* IS WRITE PROTECT SPEC @Y30OE95*/ 02156000
*                 THEN              /* YES                   @Y30OE95*/ 02157000
         CLI   REPLYCHR(REPLYPTR),C'P'                             0646 02158000
         BNE   @RF00646                                            0646 02159000
*                 DO;               /* CONTINUE              @Y30OE95*/ 02160000
*                   AMWWTPTI=P;     /* PUT INTO HOLDAREA     @Y30OE6D*/ 02161000
         MVI   AMWWTPTI(AWORKPTR),C'P'                             0648 02162000
*                   REPLYPTR=REPLYPTR+ONE;/* POINT NEXT CHAR @Y30OE95*/ 02163000
         ALR   REPLYPTR,@15                                        0649 02164000
*                 END;              /*                       @Y30OE95*/ 02165000
*               ELSE                /*                       @Y30OE95*/ 02166000
*                 IF REPLYCHR^=BLANK/* WAS BLANK SPECIFIED   @Y30OE95   02167000
*                                      FOR WRITE PROTECT     @Y30OE95*/ 02168000
*                   THEN            /* NO                    @Y30OE95*/ 02169000
         B     @RC00646                                            0651 02170000
@RF00646 CLI   REPLYCHR(REPLYPTR),C' '                             0651 02171000
         BE    @RF00651                                            0651 02172000
*                   BADREPLY=ON;    /* INDICATE BAD REPLY    @Y30OE95*/ 02173000
         OI    BADREPLY(AWORKPTR),B'00100000'                      0652 02174000
*                 ELSE              /*                       @Y30OE95*/ 02175000
*                   REPLYPTR=REPLYPTR+ONE;/* POINT NEXT CHAR @Y30OE95*/ 02176000
         B     @RC00651                                            0653 02177000
@RF00651 AL    REPLYPTR,@CF01817                                   0653 02178000
*             IF REPLYCHR=COMMA     /* IS CHAR A COMMA       @Y30OE95*/ 02179000
*               THEN                /* THEN                  @Y30OE95*/ 02180000
@RC00651 DS    0H                                                  0654 02181000
@RC00646 DS    0H                                                  0654 02182000
@RF00645 CLI   REPLYCHR(REPLYPTR),C','                             0654 02183000
         BNE   @RF00654                                            0654 02184000
*               DO;                 /* CONTINUE              @Y30OE95*/ 02185000
*                                                                  0655 02186000
*                 /***************************************************/ 02187000
*                 /*                                                 */ 02188000
*                 /* CHECK FOR AND PROCESS DATA SET SECURITY.        */ 02189000
*                 /*                                         @Y30OE6D*/ 02190000
*                 /*                                                 */ 02191000
*                 /***************************************************/ 02192000
*                                                                  0656 02193000
*                 REPLYPTR=REPLYPTR+ONE;/* POINT NEXT CHAR   @Y30OE95*/ 02194000
         LA    @15,1                                               0656 02195000
         ALR   REPLYPTR,@15                                        0656 02196000
*                 IF REPLYCHR^=COMMA/* IS CHAR A COMMA       @Y30OE95*/ 02197000
*                   THEN            /* NO                    @Y30OE95*/ 02198000
         CLI   REPLYCHR(REPLYPTR),C','                             0657 02199000
         BE    @RF00657                                            0657 02200000
*                   IF REPLYCHR>BLANK/* IS IT END OF REPLY   @Y30OE6D*/ 02201000
*                     THEN          /* OR A BLANK CHAR.      @Y30OE6D*/ 02202000
         CLI   REPLYCHR(REPLYPTR),C' '                             0658 02203000
         BNH   @RF00658                                            0658 02204000
*                     DO;           /* NO                    @Y30OE6D*/ 02205000
*                       AMWDSSQL=REPLYCHR;/* SAVE D.S. SEC IND     0660 02206000
*                                                            @Y30OE95*/ 02207000
         MVC   AMWDSSQL(1,AWORKPTR),REPLYCHR(REPLYPTR)             0660 02208000
*                       REPLYPTR=REPLYPTR+ONE;/* GET NEXT CHAR     0661 02209000
*                                                            @Y30OE95*/ 02210000
         ALR   REPLYPTR,@15                                        0661 02211000
*                     END;          /*                       @Y30OE95*/ 02212000
*                   ELSE            /*                       @Y30OE6D*/ 02213000
*                     BADREPLY=ON;  /* INDICATE BAD REPLY    @Y30OE6D*/ 02214000
         B     @RC00658                                            0663 02215000
@RF00658 OI    BADREPLY(AWORKPTR),B'00100000'                      0663 02216000
*                 IF REPLYCHR=COMMA /* IS CHAR A COMMA       @Y30OE95*/ 02217000
*                   THEN            /* YES                   @Y30OE95*/ 02218000
@RC00658 DS    0H                                                  0664 02219000
@RF00657 CLI   REPLYCHR(REPLYPTR),C','                             0664 02220000
         BNE   @RF00664                                            0664 02221000
*                   DO;             /* CONTINUE              @Y30OE95*/ 02222000
*                                                                  0666 02223000
*                     /***********************************************/ 02224000
*                     /*                                             */ 02225000
*                     /* CHECK FOR AND PROCESS VOLUME SECURITY.      */ 02226000
*                     /*                                     @Y30OE6D*/ 02227000
*                     /*                                             */ 02228000
*                     /***********************************************/ 02229000
*                                                                  0666 02230000
*                     REPLYPTR=REPLYPTR+ONE;/* GET NEXT CHAR @Y30OE95*/ 02231000
         AL    REPLYPTR,@CF01817                                   0666 02232000
*                     IF REPLYCHR<=BLANK|/* IS CHAR A BLANK  @Y30OE95*/ 02233000
*                         REPLYCHR=COMMA|/* OR A COMMA OR A  @Y30OE95*/ 02234000
*                         BADREPLY=ON|/* BAD REPLY PENDING   @Y30OE6D*/ 02235000
*                         SECURVOL=ON/* OR VOL ACCESS        @Y30OE6D   02236000
*                                      IND IS ON             @Y30OE6D*/ 02237000
*                       THEN        /* YES                   @Y30OE95*/ 02238000
         CLI   REPLYCHR(REPLYPTR),C' '                             0667 02239000
         BNH   @RT00667                                            0667 02240000
         CLI   REPLYCHR(REPLYPTR),C','                             0667 02241000
         BE    @RT00667                                            0667 02242000
         TM    BADREPLY(AWORKPTR),B'00101000'                      0667 02243000
         BZ    @RF00667                                            0667 02244000
@RT00667 DS    0H                                                  0668 02245000
*                       BADREPLY=ON;/* INDIC BAD REPLY       @Y30OE95*/ 02246000
         OI    BADREPLY(AWORKPTR),B'00100000'                      0668 02247000
*                     ELSE          /*                       @Y30OE95*/ 02248000
*                       DO;         /* CONTINUE              @Y30OE95*/ 02249000
         B     @RC00667                                            0669 02250000
@RF00667 DS    0H                                                  0670 02251000
*                         AMWVOLAC=REPLYCHR;/* SAVE VOL SER  @Y30OE6D*/ 02252000
         MVC   AMWVOLAC(1,AWORKPTR),REPLYCHR(REPLYPTR)             0670 02253000
*                         REPLYPTR=REPLYPTR+ONE;/* INDEX TO  @Y30OE95*/ 02254000
         AL    REPLYPTR,@CF01817                                   0671 02255000
*                       END;        /* THE NEXT CHARACTER    @Y30OE95*/ 02256000
*                   END;            /*                       @Y30OE95*/ 02257000
@RC00667 DS    0H                                                  0674 02258000
*                 IF AMWDSSQL^=ZERO /* WAS D.S. SEC SPEC     @Y30OE6D*/ 02259000
*                   THEN            /* YES                   @Y30OE95*/ 02260000
@RF00664 CLI   AMWDSSQL(AWORKPTR),X'00'                            0674 02261000
         BE    @RF00674                                            0674 02262000
*                   IF AMWVOLAC=ZERO/* WAS VOL SECUR SPEC    @Y30OE6D*/ 02263000
*                     THEN          /* NO                    @Y30OE95*/ 02264000
         CLI   AMWVOLAC(AWORKPTR),X'00'                            0675 02265000
         BNE   @RF00675                                            0675 02266000
*                     BADREPLY=ON;  /* INDICATE BAD REPLY    @Y30OE95*/ 02267000
         OI    BADREPLY(AWORKPTR),B'00100000'                      0676 02268000
*               END;                /*                       @Y30OE95*/ 02269000
@RF00675 DS    0H                                                  0677 02270000
@RF00674 DS    0H                                                  0678 02271000
*           END;                    /*                       @Y30OE95*/ 02272000
@RF00654 DS    0H                                                  0679 02273000
*         IF REPLYCHR^=ZERO         /* IS CHAR A HEX ZERO    @Y30OE95*/ 02274000
*           THEN                    /* NO                    @Y30OE95*/ 02275000
@RF00642 CLI   REPLYCHR(REPLYPTR),X'00'                            0679 02276000
         BE    @RF00679                                            0679 02277000
*           BADREPLY=ON;            /* INDICATE BAD REPLY    @Y30OE95*/ 02278000
         OI    BADREPLY(AWORKPTR),B'00100000'                      0680 02279000
*         RESPECIFY                                                0681 02280000
*           REPLYPTR UNRSTD;        /* UNRESTRICT REPLY PTR  @Y30OE95*/ 02281000
@RF00679 DS    0H                                                  0682 02282000
*         RESPECIFY                                                0682 02283000
*           VOL1PTR UNRSTD;         /* UNRESTRICT VOL1 PTR   @Y30OE95*/ 02284000
*       END;                        /*                       @Y30OE95*/ 02285000
*     ELSE                          /*                       @Y30OE6D*/ 02286000
*       IF REPLYMAP(2)^=ZERO        /* IF SECOND CHAR IS NOT @Y30OE6D*/ 02287000
*         THEN                      /* A ZERO FOR A NULL     @Y30OE6D*/ 02288000
         B     @RC00628                                            0684 02289000
@RF00628 L     @11,MSGREPAD(,AWORKPTR)                             0684 02290000
         CLI   REPLYMAP+1(@11),X'00'                               0684 02291000
         BE    @RF00684                                            0684 02292000
*         BADREPLY=ON;              /* RESPONSE, THEN ERROR  @Y30OE6D*/ 02293000
         OI    BADREPLY(AWORKPTR),B'00100000'                      0685 02294000
*     IF BADREPLY=ON                /* BAD REPLY ON ?        @ZA00797*/ 02295000
*       THEN                        /* YES                   @ZA00797*/ 02296000
@RF00684 DS    0H                                                  0686 02297000
@RC00628 TM    BADREPLY(AWORKPTR),B'00100000'                      0686 02298000
         BNO   @RF00686                                            0686 02299000
*       DO;                         /*                       @ZA00797*/ 02300000
*         AMWDSSQL=ZERO;            /* CLEAR D.S. IND        @ZA00797*/ 02301000
         MVI   AMWDSSQL(AWORKPTR),X'00'                            0688 02302000
*         IF SECURVOL=OFF           /* SECURE VOLUMN OFF     @ZA00797*/ 02303000
*           THEN                    /* YES                   @ZA00797*/ 02304000
         TM    SECURVOL(AWORKPTR),B'00001000'                      0689 02305000
         BNZ   @RF00689                                            0689 02306000
*           AMWVOLAC=ZERO;          /* CLEAR VOL SEC IND     @ZA00797*/ 02307000
         MVI   AMWVOLAC(AWORKPTR),X'00'                            0690 02308000
*       END;                        /*                       @ZA00797*/ 02309000
@RF00689 DS    0H                                                  0692 02310000
*   END;                            /*                       @Y30OE6D*/ 02311000
@RF00686 DS    0H                                                  0692 02312000
@DE00617 TM    BADREPLY(AWORKPTR),B'00100000'                      0692 02313000
         BO    @DL00617                                            0692 02314000
*   SECURVOL=ON;                    /* SET SECURE VOL IND ON @Y30OE6D*/ 02315000
         OI    SECURVOL(AWORKPTR),B'00001000'                      0693 02316000
*   END SECRPROC;                   /* END OF SUBROUTINE     @Y30OE95*/ 02317000
@EL00012 DS    0H                                                  0694 02318000
@EF00012 DS    0H                                                  0694 02319000
@ER00012 L     @14,@SA00012                                        0694 02320000
         BR    @14                                                 0694 02321000
*                                                                  0695 02322000
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE6D*/ 02323000
*/*                                                          @Y30OE6D*/ 02324000
*/*  THIS SUBROUTINE UPDATES THE UCB USING THE VOL SER       @Y30OE6D*/ 02325000
*/*  WHICH WAS SETUP IN SAVEVOL.                             @Y30OE6D*/ 02326000
*/*                                                          @Y30OE6D*/ 02327000
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE6D*/ 02328000
*                                                                  0695 02329000
*UCBUPDAT:                          /*                       @Y30OE6D*/ 02330000
*   PROC OPTIONS(SAVE(11,14));      /*                       @Y30OE6D*/ 02331000
UCBUPDAT ST    @14,@SA00013                                        0695 02332000
         ST    @11,@SA00013+4                                      0695 02333000
*   RFY                             /*                       @Y30OE6D*/ 02334000
*    (LOCKREG,                      /*                       @Y30OE6D*/ 02335000
*     UCBPTR) RSTD;                 /* RESTRICT REGISTERS    @Y30OE6D*/ 02336000
*   UCBPTR=SAVEUCB;                 /* GET POINTER TO THE UCB      0697 02337000
*                                                            @Y30OE6D*/ 02338000
         L     UCBPTR,SAVEUCB(,AWORKPTR)                           0697 02339000
*   LOCKREG=ADDR(UCBLOCK);          /* GET DEVICE LOCKWORD   @Y30OE6D*/ 02340000
         LR    LOCKREG,UCBPTR                                      0698 02341000
         AL    LOCKREG,@CF02104                                    0698 02342000
*   GENERATE;                                                      0699 02343000
*                                                         /*@Y30OE6D*/  02344000
        MODESET KEY=ZERO,MODE=SUP GET PGM IN KEY ZERO         @Y30OE6D  02345000
        SETLOCK OBTAIN,TYPE=IOSUCB,ADDR=(11),MODE=UNCOND,             XX02346000
               REGS=USE,RELATED=(UCB,(IOESDKTO,UCBUPDAT))     @Y30OE6D  02347000
*   UCBVLSER=SAVEVOL;               /* UPDATE VOL SER IN UCB @Y30OE6D*/ 02348000
         L     @01,UCBXTADR(,UCBPTR)                               0700 02349000
         MVC   UCBVLSER(6,@01),SAVEVOL(AWORKPTR)                   0700 02350000
*   LOCKREG=ADDR(UCBLOCK);          /* GET DEVICE LOCKWORD   @Y30OE6D*/ 02351000
         LR    LOCKREG,UCBPTR                                      0701 02352000
         AL    LOCKREG,@CF02104                                    0701 02353000
*   GENERATE;                                                      0702 02354000
*                                                         /*@Y30OE6D*/  02355000
        SETLOCK RELEASE,TYPE=IOSUCB,ADDR=(11),                        XX02356000
               REGS=USE,RELATED=(UCB,(IOESDKTO,UCBUPDAT))     @Y30OE6D  02357000
        MODESET KEY=NZERO,MODE=PROB RESTORE PROGRAM KEY       @Y30OE6D  02358000
*   RFY                             /*                       @Y30OE6D*/ 02359000
*    (LOCKREG,                      /*                       @Y30OE6D*/ 02360000
*     UCBPTR) UNRSTD;               /* RELEASE REGISTERS     @Y30OE6D*/ 02361000
*   END UCBUPDAT;                   /* END OF UCBUPDAT ROUT. @Y30OE6D*/ 02362000
@EL00013 DS    0H                                                  0704 02363000
@EF00013 DS    0H                                                  0704 02364000
@ER00013 L     @14,@SA00013                                        0704 02365000
         L     @11,@SA00013+4                                      0704 02366000
         BR    @14                                                 0704 02367000
*                                                                  0705 02368000
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE6D*/ 02369000
*/*                                                          @Y30OE6D*/ 02370000
*/*  THIS SUBROUTINE SETS UP THE MESSAGE WRITER PARAMETER    @Y30OE6D*/ 02371000
*/*  LIST AND CALLS THE MESSAGE WRITER TO ISSUE THE          @Y30OE6D*/ 02372000
*/*  MESSAGES FOR THIS PROGRAM.                              @Y30OE6D*/ 02373000
*/*                                                          @Y30OE6D*/ 02374000
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE6D*/ 02375000
*                                                                  0705 02376000
*MSGSUBRT:                          /*                       @Y30OE6D*/ 02377000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30OE6D*/ 02378000
MSGSUBRT ST    @14,@SA00014                                        0705 02379000
*   RFY                             /*                       @Y30OE6D*/ 02380000
*    (VOL1PTR,                      /*                       @Y30OE6D*/ 02381000
*     UCBPTR,                       /*                       @Y30OE6D*/ 02382000
*     REG1) RSTD;                   /* RESTRICT REGISTERS    @Y30OE6D*/ 02383000
*   VOL1PTR=CHANPGM(3,2:4);         /* GET PTR TO VOL1 LABEL @Y30OE6D*/ 02384000
         SLR   VOL1PTR,VOL1PTR                                     0707 02385000
         ICM   VOL1PTR,7,CHANPGM+17(CHNPGMPT)                      0707 02386000
*   UCBPTR=SAVEUCB;                 /* SET POINTER TO UCB    @Y30OE6D*/ 02387000
         L     UCBPTR,SAVEUCB(,AWORKPTR)                           0708 02388000
*   DEVADTXT=UCBNAME;               /* GET DEVICE ADDRESS    @Y30OE6D*/ 02389000
         MVC   DEVADTXT(3),UCBNAME(UCBPTR)                         0709 02390000
*   SERTXT=VOLID;                   /* GET VOLUME SERIAL     @Y30OE6D*/ 02391000
         MVC   SERTXT(6),VOLID(VOL1PTR)                            0710 02392000
*   MSGTEXT=MSGOPT;                 /* GET MESSAGE OPTIONS   @Y30OE6D*/ 02393000
         MVC   MSGTEXT(45,AWORKPTR),MSGOPT                         0711 02394000
*   REG1=ADDR(MSGAREA);             /* GET MSG LIST ADDRESS  @Y30OE6D*/ 02395000
         LA    REG1,MSGAREA(,AWORKPTR)                             0712 02396000
*   CALL IOEDKMSG;                  /* CALL MESSAGE WRITER   @Y30OE6D*/ 02397000
         L     @15,@CV01726                                        0713 02398000
         BALR  @14,@15                                             0713 02399000
*   MSGTYPCD=WTOCD;                 /* SET MSG TYPE TO WTO   @Y30OE6D*/ 02400000
         MVI   MSGTYPCD(AWORKPTR),X'01'                            0714 02401000
*   RFY                             /*                       @Y30OE6D*/ 02402000
*    (VOL1PTR,                      /*                       @Y30OE6D*/ 02403000
*     UCBPTR,                       /*                       @Y30OE6D*/ 02404000
*     REG1) UNRSTD;                 /* RELEASE REGISTERS     @Y30OE6D*/ 02405000
*   END MSGSUBRT;                   /* END OF MSG SUB ROUT.  @Y30OE6D*/ 02406000
@EL00014 DS    0H                                                  0716 02407000
@EF00014 DS    0H                                                  0716 02408000
@ER00014 L     @14,@SA00014                                        0716 02409000
         BR    @14                                                 0716 02410000
*                                                                  0717 02411000
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE95*/ 02412000
*/*                                                          @Y30OE6D*/ 02413000
*/*   THIS SUBROUTINE ISSUES AN EXCP AND THEN WAITS          @Y30OE95*/ 02414000
*/*   UNTIL THE I/O IS COMPLETED.                            @Y30OE95*/ 02415000
*/*                                                          @Y30OE6D*/ 02416000
*/* * * * * * * * * * * * * * * * * * * * * * * * * * * * *  @Y30OE95*/ 02417000
*                                                                  0717 02418000
*IOSBRTN:                           /*                       @Y30OE95*/ 02419000
*   PROC OPTIONS(NOSAVE);           /*                       @Y30OE6D*/ 02420000
IOSBRTN  DS    0H                                                  0718 02421000
*   RFY                             /*                       @Y30OE6D*/ 02422000
*    (REG14,                        /*                       @Y30OE6D*/ 02423000
*     REG15) RSTD;                  /* RESTRICT REGISTERS    @Y30OE6D*/ 02424000
*   GEN(EXCP (IOBSTPTR));           /* EXECUTE CHANNEL PGM   @Y30OE6D*/ 02425000
         EXCP (IOBSTPTR)                                                02426000
*   REG15=IOBECBPT;                 /* GET PTR TO ECB        @Y30OE6D*/ 02427000
         L     REG15,IOBECBPT(,IOBSTPTR)                           0720 02428000
*   GEN(WAIT ECB=(REG15));          /* WAIT FOR I/O COMPLETE @Y30OE6D*/ 02429000
         WAIT ECB=(REG15)                                               02430000
*   IF ECBCC^=GOODIO                /* ANY I/O ERRORS        @Y30OE6D*/ 02431000
*     THEN                          /* YES                   @Y30OE6D*/ 02432000
         L     @11,IOBECBPT(,IOBSTPTR)                             0722 02433000
         CLI   ECBCC(@11),X'7F'                                    0722 02434000
         BE    @RF00722                                            0722 02435000
*     ERTNCDE=IOERROR;              /* SET ERROR RETURN CODE @Y30OE6D*/ 02436000
         MVI   ERTNCDE(SETDSKPT),X'10'                             0723 02437000
*   RFY                             /*                       @Y30OE6D*/ 02438000
*    (REG14,                        /*                       @Y30OE6D*/ 02439000
*     REG15) UNRSTD;                /* RELEASE REGISTERS     @Y30OE6D*/ 02440000
*   END IOSBRTN;                    /* END OF I/O ROUTINE    @Y30OE95*/ 02441000
@EL00015 DS    0H                                                  0725 02442000
@EF00015 DS    0H                                                  0725 02443000
@ER00015 BR    @14                                                 0725 02444000
*   END IOESDKTO                    /* END OF PROGRAM        @Y30OE6D*/ 02445000
*                                                                  0726 02446000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 02447000
*/*%INCLUDE SYSLIB  (IEZIOB  )                                       */ 02448000
*/*%INCLUDE SYSLIB  (IEZDEB  )                                       */ 02449000
*/*%INCLUDE SYSLIB  (IHADCBDF)                                       */ 02450000
*/*%INCLUDE SYSLIB  (IHADCB  )                                       */ 02451000
*/*%INCLUDE SYSLIB  (IEFUCBOB)                                       */ 02452000
*/*%INCLUDE SYSLIB  (IHAPSA  )                                       */ 02453000
*                                                                  0726 02454000
*       ;                                                          0726 02455000
@DATA    DS    0H                                                       02456000
@DATD    DSECT                                                          02457000
         DS    0F                                                       02458000
@SA00001 DS    18F                                                      02459000
@SA00004 DS    1F                                                       02460000
@SA00003 DS    1F                                                       02461000
@SA00005 DS    1F                                                       02462000
@SA00002 DS    1F                                                       02463000
@SA00006 DS    1F                                                       02464000
@SA00013 DS    2F                                                       02465000
@SA00008 DS    1F                                                       02466000
@SA00009 DS    1F                                                       02467000
@SA00010 DS    1F                                                       02468000
@SA00012 DS    1F                                                       02469000
@SA00014 DS    0F                                                       02470000
         DS    1F                                                       02471000
@TF00001 DS    F                                                        02472000
IOESDKTO CSECT                                                          02473000
         DS    0F                                                       02474000
@CF00037 DC    F'1'                                                     02475000
@CF00196 DC    F'2'                                                     02476000
@CF00217 DC    F'3'                                                     02477000
@CF00412 DC    F'6'                                                     02478000
@CF01976 DC    F'19'                                                    02479000
@CF01653 DC    F'22'                                                    02480000
@CF01584 DC    F'28'                                                    02481000
@CF02104 DC    F'-8'                                                    02482000
@CF02109 DC    XL4'0000FFFF'                                            02483000
@CF01810 DC    XL4'06'                                                  02484000
@CF01815 DC    XL4'08'                                                  02485000
@CF01817 DC    XL4'01'                                                  02486000
@CF01897 DC    XL4'04'                                                  02487000
@DATD    DSECT                                                          02488000
         DS    0D                                                       02489000
DEBDAPTR DS    A                                                        02490000
DEBEXPTR DS    A                                                        02491000
DEBSBPTR DS    A                                                        02492000
         DS    0D                                                       02493000
@TS00001 DS    CL8                                                      02494000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                02495000
@ENDDATD EQU   *                                                        02496000
IOESDKTO CSECT                                                          02497000
         DS    0F                                                       02498000
@SIZDATD DC    AL1(0)                                                   02499000
         DC    AL3(@ENDDATD-@DATD)                                      02500000
@CV01726 DC    V(IOEDKMSG)                                              02501000
         DS    0D                                                       02502000
ZEROS    DC    F'0'                                                     02503000
MAXLRECL DC    H'128'                                                   02504000
NUM365   DC    H'365'                                                   02505000
NUM366   DC    H'366'                                                   02506000
HZERO    DC    AL2(0)                                                   02507000
COUNT80  DC    H'80'                                                    02508000
@CB01893 DC    X'00'                                                    02509000
MSGOPT   DS    CL45                                                     02510000
         ORG   MSGOPT                                                   02511000
MSGDSID  DS    CL10                                                     02512000
         ORG   MSGDSID                                                  02513000
DSIDLEN  DC    X'0A'                                                    02514000
DSIDKEY  DC    X'06'                                                    02515000
         ORG   DSIDKEY                                                  02516000
DSIDLOP  DS    BL1                                                      02517000
         ORG   MSGDSID+2                                                02518000
DSIDTXT  DS    CL8                                                      02519000
         ORG   MSGOPT+10                                                02520000
MSGSER   DS    CL8                                                      02521000
         ORG   MSGSER                                                   02522000
SERLEN   DC    X'08'                                                    02523000
SERKEY   DC    X'01'                                                    02524000
SERTXT   DS    CL6                                                      02525000
         ORG   MSGOPT+18                                                02526000
MSGVOLDS DS    CL10                                                     02527000
         ORG   MSGVOLDS                                                 02528000
VOLDSLEN DC    X'0A'                                                    02529000
VOLDSKEY DC    X'0A'                                                    02530000
VOLDSTXT DC    CL8'VOLUME  '                                            02531000
         ORG   MSGOPT+28                                                02532000
MSGDEVAD DS    CL5                                                      02533000
         ORG   MSGDEVAD                                                 02534000
DEVADLEN DC    X'05'                                                    02535000
DEVADKEY DC    X'08'                                                    02536000
DEVADTXT DS    CL3                                                      02537000
         ORG   MSGOPT+33                                                02538000
MSGJNAME DS    CL10                                                     02539000
         ORG   MSGJNAME                                                 02540000
JNAMELEN DC    X'0A'                                                    02541000
JNAMEKEY DC    X'0B'                                                    02542000
         ORG   JNAMEKEY                                                 02543000
JOBNMLOP DS    BL1                                                      02544000
         ORG   MSGJNAME+2                                               02545000
JNAMETXT DS    CL8                                                      02546000
         ORG   MSGOPT+43                                                02547000
MSGEND   DS    CL2                                                      02548000
         ORG   MSGEND                                                   02549000
ENDLEN   DC    X'02'                                                    02550000
ENDKEY   DC    X'7F'                                                    02551000
         ORG   MSGOPT+45                                                02552000
VOL1     DC    CL4'VOL1'                                                02553000
DDR1     DC    CL4'DDR1'                                                02554000
HDR1     DC    CL4'HDR1'                                                02555000
NODATA   DC    CL6'NODATA'                                              02556000
ENDDSKT  DC    CL6'/*DSKT'                                              02557000
CHAR00   DC    CL2'00'                                                  02558000
CHAR01   DC    CL2'01'                                                  02559000
CHAR12   DC    CL2'12'                                                  02560000
CHAR26   DC    CL2'26'                                                  02561000
CHAR31   DC    CL2'31'                                                  02562000
TRK73    DC    CL2'73'                                                  02563000
CCWD1    DS    CL8                                                      02564000
         ORG   CCWD1                                                    02565000
CCWOP1   DC    X'2F'                                                    02566000
CCWADDR1 DC    AL3(DFNOP1)                                              02567000
CCWFLAG1 DC    X'60'                                                    02568000
@NM00086 DC    X'00'                                                    02569000
CCWCNT1  DC    X'0004'                                                  02570000
         ORG   CCWD1+8                                                  02571000
DFNOP1   DC    X'1AA00000'                                              02572000
CCWD2    DS    CL8                                                      02573000
         ORG   CCWD2                                                    02574000
CCWOP2   DC    X'2F'                                                    02575000
CCWADDR2 DC    AL3(DFNOP2)                                              02576000
CCWFLAG2 DC    X'20'                                                    02577000
@NM00087 DC    X'00'                                                    02578000
CCWCNT2  DC    X'0004'                                                  02579000
         ORG   CCWD2+8                                                  02580000
DFNOP2   DC    X'1A400000'                                              02581000
CCWD3    DS    CL8                                                      02582000
         ORG   CCWD3                                                    02583000
CCWOP3   DC    X'2F'                                                    02584000
CCWADDR3 DC    AL3(DFNOP3)                                              02585000
CCWFLAG3 DC    X'60'                                                    02586000
@NM00088 DC    X'00'                                                    02587000
CCWCNT3  DC    X'0004'                                                  02588000
         ORG   CCWD3+8                                                  02589000
DFNOP3   DC    X'14400000'                                              02590000
SECUREVL DC    X'040C'                                                  02591000
VOL1ADDR DC    X'00000007'                                              02592000
TABLENLP DS    CL24                                                     02593000
         ORG   TABLENLP                                                 02594000
NLPYRTBL DC    H'0'                                                     02595000
         DC    H'31'                                                    02596000
         DC    H'59'                                                    02597000
         DC    H'90'                                                    02598000
         DC    H'120'                                                   02599000
         DC    H'151'                                                   02600000
         DC    H'181'                                                   02601000
         DC    H'212'                                                   02602000
         DC    H'243'                                                   02603000
         DC    H'273'                                                   02604000
         DC    H'304'                                                   02605000
         DC    H'334'                                                   02606000
         ORG   TABLENLP+24                                              02607000
TABLELYR DS    CL24                                                     02608000
         ORG   TABLELYR                                                 02609000
LPYRTBL  DC    H'0'                                                     02610000
         DC    H'31'                                                    02611000
         DC    H'60'                                                    02612000
         DC    H'91'                                                    02613000
         DC    H'121'                                                   02614000
         DC    H'152'                                                   02615000
         DC    H'182'                                                   02616000
         DC    H'213'                                                   02617000
         DC    H'244'                                                   02618000
         DC    H'274'                                                   02619000
         DC    H'305'                                                   02620000
         DC    H'335'                                                   02621000
         ORG   TABLELYR+24                                              02622000
MT3540AR DC    CL200' '                                                 02623000
         DS    CL2                                                      02624000
CP0001@  DC    AL4(OPENDS)                                              02625000
         DC    AL4(EOV)                                                 02626000
         DC    AL4(CLOSEDS)                                             02627000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       02628000
@01      EQU   01                                                       02629000
@02      EQU   02                                                       02630000
@03      EQU   03                                                       02631000
@04      EQU   04                                                       02632000
@05      EQU   05                                                       02633000
@06      EQU   06                                                       02634000
@07      EQU   07                                                       02635000
@08      EQU   08                                                       02636000
@09      EQU   09                                                       02637000
@10      EQU   10                                                       02638000
@11      EQU   11                                                       02639000
@12      EQU   12                                                       02640000
@13      EQU   13                                                       02641000
@14      EQU   14                                                       02642000
@15      EQU   15                                                       02643000
CHARPTR  EQU   @08                                                      02644000
DEBPTR   EQU   @11                                                      02645000
IOBPRPTR EQU   @08                                                      02646000
IOBSTPTR EQU   @04                                                      02647000
DCBPTR   EQU   @03                                                      02648000
UCBPTR   EQU   @08                                                      02649000
AWORKPTR EQU   @05                                                      02650000
REG1     EQU   @01                                                      02651000
SETDSKPT EQU   @02                                                      02652000
CHNPGMPT EQU   @06                                                      02653000
HDR1PTR  EQU   @07                                                      02654000
REPLYPTR EQU   @08                                                      02655000
VOL1PTR  EQU   @11                                                      02656000
LOCKREG  EQU   @11                                                      02657000
REG14    EQU   @14                                                      02658000
REG15    EQU   @15                                                      02659000
UCBDCPTR EQU   @11                                                      02660000
PSA      EQU   0                                                        02661000
FLCRNPSW EQU   PSA                                                      02662000
FLCROPSW EQU   PSA+8                                                    02663000
FLCICCW2 EQU   PSA+16                                                   02664000
PSAEEPSW EQU   PSA+132                                                  02665000
PSAESPSW EQU   PSA+136                                                  02666000
FLCSVILC EQU   PSAESPSW+1                                               02667000
PSAEPPSW EQU   PSA+140                                                  02668000
FLCPIILC EQU   PSAEPPSW+1                                               02669000
FLCPICOD EQU   PSAEPPSW+2                                               02670000
PSAPICOD EQU   FLCPICOD+1                                               02671000
FLCTEA   EQU   PSAEPPSW+4                                               02672000
FLCPER   EQU   PSA+152                                                  02673000
FLCMCLA  EQU   PSA+168                                                  02674000
FLCIOEL  EQU   FLCMCLA+4                                                02675000
FLCIOA   EQU   FLCMCLA+16                                               02676000
FLCFSA   EQU   FLCMCLA+80                                               02677000
PSASUPER EQU   PSA+552                                                  02678000
PSASUP1  EQU   PSASUPER                                                 02679000
PSASUP2  EQU   PSASUPER+1                                               02680000
PSASUP3  EQU   PSASUPER+2                                               02681000
PSASUP4  EQU   PSASUPER+3                                               02682000
PSACLHT  EQU   PSA+640                                                  02683000
PSALKSA  EQU   PSA+696                                                  02684000
PSAHLHI  EQU   PSA+760                                                  02685000
PSADSSFL EQU   PSA+836                                                  02686000
PSADSSF1 EQU   PSADSSFL                                                 02687000
PSADSSF3 EQU   PSADSSFL+2                                               02688000
PSADSSF4 EQU   PSADSSFL+3                                               02689000
PSARSVT  EQU   PSA+896                                                  02690000
IOBPREFX EQU   0                                                        02691000
IOBCFLG1 EQU   IOBPREFX                                                 02692000
IOBSTDRD EQU   0                                                        02693000
IOBFLAG1 EQU   IOBSTDRD                                                 02694000
IOBCYCCK EQU   IOBFLAG1                                                 02695000
IOBRSTRT EQU   IOBFLAG1                                                 02696000
IOBFLAG2 EQU   IOBSTDRD+1                                               02697000
IOBPURGE EQU   IOBFLAG2                                                 02698000
IOBRDHA0 EQU   IOBFLAG2                                                 02699000
IOBSENS0 EQU   IOBSTDRD+2                                               02700000
IOBS0B7  EQU   IOBSENS0                                                 02701000
IOBSENS1 EQU   IOBSTDRD+3                                               02702000
IOBECBPT EQU   IOBSTDRD+4                                               02703000
IOBFLAG3 EQU   IOBSTDRD+8                                               02704000
IOBFL3   EQU   IOBFLAG3                                                 02705000
IOBCSW   EQU   IOBSTDRD+9                                               02706000
IOBIOCSW EQU   IOBCSW                                                   02707000
IOBSTART EQU   IOBSTDRD+16                                              02708000
IOBSTRTB EQU   IOBSTART+1                                               02709000
IOBDCBPT EQU   IOBSTDRD+20                                              02710000
IOBFLAG4 EQU   IOBDCBPT                                                 02711000
IOBRESTR EQU   IOBSTDRD+24                                              02712000
IOBINCAM EQU   IOBSTDRD+28                                              02713000
IOBBTAMF EQU   IOBINCAM                                                 02714000
DEBBASIC EQU   0                                                        02715000
DEBTCBAD EQU   DEBBASIC                                                 02716000
DEBDEBAD EQU   DEBBASIC+4                                               02717000
DEBIRBAD EQU   DEBBASIC+8                                               02718000
DEBOFLGS EQU   DEBIRBAD                                                 02719000
DEBOPATB EQU   DEBBASIC+12                                              02720000
DEBFLGS1 EQU   DEBBASIC+14                                              02721000
DEBUSRPG EQU   DEBBASIC+16                                              02722000
DEBRRQ   EQU   DEBBASIC+20                                              02723000
DEBECBAD EQU   DEBRRQ                                                   02724000
DEBDCBAD EQU   DEBBASIC+24                                              02725000
DEBPROTG EQU   DEBDCBAD                                                 02726000
DEBAPPAD EQU   DEBBASIC+28                                              02727000
DEBBASND EQU   DEBBASIC+32                                              02728000
DEBDASD  EQU   0                                                        02729000
DEBUCBAD EQU   DEBDASD                                                  02730000
DEBACSMD EQU   0                                                        02731000
DEBVOLSQ EQU   DEBACSMD                                                 02732000
DEBVOLBT EQU   DEBVOLSQ                                                 02733000
DEBDSNM  EQU   DEBACSMD+4                                               02734000
DEBUTSAA EQU   DEBDSNM                                                  02735000
DEBACS01 EQU   0                                                        02736000
DEBDSNAM EQU   DEBACS01                                                 02737000
DEBACS02 EQU   0                                                        02738000
DEBDBLK  EQU   DEBACS02                                                 02739000
DEBACS03 EQU   0                                                        02740000
DEBACS04 EQU   0                                                        02741000
DEBTBFRA EQU   DEBACS04                                                 02742000
DEBTCCWA EQU   DEBACS04+4                                               02743000
DEBACS05 EQU   0                                                        02744000
DEBFUCBA EQU   DEBACS05                                                 02745000
DEBLUCBA EQU   DEBACS05+4                                               02746000
DEBACS06 EQU   0                                                        02747000
DEBACS07 EQU   0                                                        02748000
DEBACS08 EQU   0                                                        02749000
DEBSUBNM EQU   0                                                        02750000
DEB      EQU   0                                                        02751000
DEBAVT   EQU   DEB                                                      02752000
DEBEOEA  EQU   DEBAVT                                                   02753000
DEBEOEAB EQU   DEBEOEA                                                  02754000
DEBSIOA  EQU   DEBAVT+4                                                 02755000
DEBSIOAB EQU   DEBSIOA                                                  02756000
DEBPCIA  EQU   DEBAVT+8                                                 02757000
DEBPCIAB EQU   DEBPCIA                                                  02758000
DEBCEA   EQU   DEBAVT+12                                                02759000
DEBCEAB  EQU   DEBCEA                                                   02760000
DEBXCEA  EQU   DEBAVT+16                                                02761000
DEBXCEAB EQU   DEBXCEA                                                  02762000
DEBPREFX EQU   DEB+20                                                   02763000
DEBXTNP  EQU   DEBPREFX+8                                               02764000
DEBXTN   EQU   0                                                        02765000
DEBXFLG1 EQU   DEBXTN+2                                                 02766000
IHADCB   EQU   0                                                        02767000
IHADCS00 EQU   0                                                        02768000
DCBFDAD  EQU   IHADCS00+5                                               02769000
IHADCS01 EQU   0                                                        02770000
DCBDVTBL EQU   IHADCS01                                                 02771000
IHADCS11 EQU   0                                                        02772000
DCBRELB  EQU   IHADCS11                                                 02773000
DCBREL   EQU   DCBRELB+1                                                02774000
DCBBUFCB EQU   IHADCS11+4                                               02775000
DCBDSORG EQU   IHADCS11+10                                              02776000
DCBDSRG1 EQU   DCBDSORG                                                 02777000
DCBDSRG2 EQU   DCBDSORG+1                                               02778000
DCBIOBAD EQU   IHADCS11+12                                              02779000
DCBODEB  EQU   DCBIOBAD                                                 02780000
DCBLNP   EQU   DCBODEB                                                  02781000
DCBQSLM  EQU   DCBLNP                                                   02782000
DCBIOBAA EQU   DCBODEB+1                                                02783000
IHADCS50 EQU   0                                                        02784000
DCBSVCXL EQU   IHADCS50                                                 02785000
DCBEODAD EQU   IHADCS50+4                                               02786000
DCBBFALN EQU   DCBEODAD                                                 02787000
DCBHIARC EQU   DCBBFALN                                                 02788000
DCBBFTEK EQU   DCBHIARC                                                 02789000
DCBBFT   EQU   DCBBFTEK                                                 02790000
DCBEXLST EQU   IHADCS50+8                                               02791000
DCBRECFM EQU   DCBEXLST                                                 02792000
DCBRECLA EQU   DCBRECFM                                                 02793000
IHADCS24 EQU   0                                                        02794000
DCBOFLGS EQU   IHADCS24+8                                               02795000
DCBOFLWR EQU   DCBOFLGS                                                 02796000
DCBIFLG  EQU   IHADCS24+9                                               02797000
DCBMACR  EQU   IHADCS24+10                                              02798000
DCBMACR1 EQU   DCBMACR                                                  02799000
DCBMRFE  EQU   DCBMACR1                                                 02800000
DCBMRGET EQU   DCBMRFE                                                  02801000
DCBMRAPG EQU   DCBMACR1                                                 02802000
DCBMRRD  EQU   DCBMRAPG                                                 02803000
DCBMRCI  EQU   DCBMACR1                                                 02804000
DCBMRMVG EQU   DCBMRCI                                                  02805000
DCBMRLCG EQU   DCBMACR1                                                 02806000
DCBMRABC EQU   DCBMACR1                                                 02807000
DCBMRPT1 EQU   DCBMRABC                                                 02808000
DCBMRSBG EQU   DCBMRPT1                                                 02809000
DCBMRCRL EQU   DCBMACR1                                                 02810000
DCBMRCHK EQU   DCBMRCRL                                                 02811000
DCBMRRDX EQU   DCBMRCHK                                                 02812000
DCBMRDMG EQU   DCBMACR1                                                 02813000
DCBMACR2 EQU   DCBMACR+1                                                02814000
DCBMRPUT EQU   DCBMACR2                                                 02815000
DCBMRWRT EQU   DCBMACR2                                                 02816000
DCBMRMVP EQU   DCBMACR2                                                 02817000
DCBMR5WD EQU   DCBMACR2                                                 02818000
DCBMRLDM EQU   DCBMR5WD                                                 02819000
DCBMRLCP EQU   DCBMRLDM                                                 02820000
DCBMR4WD EQU   DCBMACR2                                                 02821000
DCBMRPT2 EQU   DCBMR4WD                                                 02822000
DCBMRTMD EQU   DCBMRPT2                                                 02823000
DCBMR3WD EQU   DCBMACR2                                                 02824000
DCBMRCTL EQU   DCBMR3WD                                                 02825000
DCBMRSTK EQU   DCBMRCTL                                                 02826000
DCBMR1WD EQU   DCBMACR2                                                 02827000
DCBMRSWA EQU   DCBMR1WD                                                 02828000
DCBMRDMD EQU   DCBMRSWA                                                 02829000
IHADCS25 EQU   0                                                        02830000
DCBMACRF EQU   IHADCS25+2                                               02831000
DCBMACF1 EQU   DCBMACRF                                                 02832000
DCBMFFE  EQU   DCBMACF1                                                 02833000
DCBMFGET EQU   DCBMFFE                                                  02834000
DCBMFAPG EQU   DCBMACF1                                                 02835000
DCBMFRD  EQU   DCBMFAPG                                                 02836000
DCBMFCI  EQU   DCBMACF1                                                 02837000
DCBMFMVG EQU   DCBMFCI                                                  02838000
DCBMFLCG EQU   DCBMACF1                                                 02839000
DCBMFABC EQU   DCBMACF1                                                 02840000
DCBMFPT1 EQU   DCBMFABC                                                 02841000
DCBMFSBG EQU   DCBMFPT1                                                 02842000
DCBMFCRL EQU   DCBMACF1                                                 02843000
DCBMFCHK EQU   DCBMFCRL                                                 02844000
DCBMFDMG EQU   DCBMACF1                                                 02845000
DCBMACF2 EQU   DCBMACRF+1                                               02846000
DCBMFPUT EQU   DCBMACF2                                                 02847000
DCBMFWRT EQU   DCBMACF2                                                 02848000
DCBMFMVP EQU   DCBMACF2                                                 02849000
DCBMF5WD EQU   DCBMACF2                                                 02850000
DCBMFLDM EQU   DCBMF5WD                                                 02851000
DCBMFLCP EQU   DCBMFLDM                                                 02852000
DCBMF4WD EQU   DCBMACF2                                                 02853000
DCBMFPT2 EQU   DCBMF4WD                                                 02854000
DCBMFTMD EQU   DCBMFPT2                                                 02855000
DCBMF3WD EQU   DCBMACF2                                                 02856000
DCBMFCTL EQU   DCBMF3WD                                                 02857000
DCBMFSTK EQU   DCBMFCTL                                                 02858000
DCBMF1WD EQU   DCBMACF2                                                 02859000
DCBMFSWA EQU   DCBMF1WD                                                 02860000
DCBMFDMD EQU   DCBMFSWA                                                 02861000
DCBDEBAD EQU   IHADCS25+4                                               02862000
DCBIFLGS EQU   DCBDEBAD                                                 02863000
DCBIFEC  EQU   DCBIFLGS                                                 02864000
IHADCS26 EQU   0                                                        02865000
DCBWRITE EQU   IHADCS26                                                 02866000
DCBREAD  EQU   DCBWRITE                                                 02867000
DCBWRITA EQU   DCBREAD+1                                                02868000
IHADCS27 EQU   0                                                        02869000
DCBGET   EQU   IHADCS27                                                 02870000
DCBPUT   EQU   DCBGET                                                   02871000
DCBGETA  EQU   DCBPUT+1                                                 02872000
IHADCS36 EQU   0                                                        02873000
DCBGERR  EQU   IHADCS36                                                 02874000
DCBPERR  EQU   DCBGERR                                                  02875000
DCBCHECK EQU   DCBPERR                                                  02876000
DCBOPTCD EQU   DCBCHECK                                                 02877000
DCBOPTH  EQU   DCBOPTCD                                                 02878000
DCBOPTO  EQU   DCBOPTH                                                  02879000
DCBOPTZ  EQU   DCBOPTCD                                                 02880000
DCBGERRA EQU   DCBCHECK+1                                               02881000
DCBPERRA EQU   DCBGERRA                                                 02882000
DCBSYNAD EQU   IHADCS36+4                                               02883000
DCBCIND1 EQU   IHADCS36+8                                               02884000
DCBCIND2 EQU   IHADCS36+9                                               02885000
DCBIOBA  EQU   IHADCS36+16                                              02886000
DCBCICB  EQU   DCBIOBA                                                  02887000
IHADCS52 EQU   0                                                        02888000
DCBDIRCT EQU   IHADCS52                                                 02889000
DCBQSWS  EQU   DCBDIRCT                                                 02890000
DCBUSASI EQU   DCBQSWS                                                  02891000
DCBQADFS EQU   DCBUSASI                                                 02892000
DCBBUFOF EQU   DCBDIRCT+1                                               02893000
IHADCS37 EQU   0                                                        02894000
DCBFLAG1 EQU   IHADCS37                                                 02895000
IHADCS38 EQU   0                                                        02896000
DCBEOBR  EQU   IHADCS38                                                 02897000
DCBPOINT EQU   IHADCS38+12                                              02898000
DCBCNTRL EQU   DCBPOINT                                                 02899000
IHADCS40 EQU   0                                                        02900000
DCBEOBAD EQU   IHADCS40                                                 02901000
DCBCCCW  EQU   IHADCS40+4                                               02902000
DCBRECAD EQU   DCBCCCW                                                  02903000
DCBRECBT EQU   DCBRECAD                                                 02904000
DCBRCREL EQU   DCBRECBT                                                 02905000
@NM00029 EQU   IHADCS40+12                                              02906000
DCBEROPT EQU   @NM00029                                                 02907000
UCB      EQU   0                                                        02908000
UCBLOCK  EQU   UCB+504                                                  02909000
UCBOB    EQU   0                                                        02910000
UCBJBNR  EQU   UCBOB                                                    02911000
UCBFL5   EQU   UCBOB+1                                                  02912000
UCBAF    EQU   UCBFL5                                                   02913000
UCBSTAT  EQU   UCBOB+3                                                  02914000
UCBCHAN  EQU   UCBOB+4                                                  02915000
UCBSFLS  EQU   UCBOB+6                                                  02916000
UCBFLA   EQU   UCBSFLS                                                  02917000
UCBFL1   EQU   UCBFLA                                                   02918000
UCBBSY   EQU   UCBFL1                                                   02919000
UCBNRY   EQU   UCBFL1                                                   02920000
UCBPST   EQU   UCBFL1                                                   02921000
UCBCUB   EQU   UCBFL1                                                   02922000
UCBFLB   EQU   UCBSFLS+1                                                02923000
UCBCHM   EQU   UCBOB+8                                                  02924000
UCBCHM1  EQU   UCBCHM                                                   02925000
UCBPTH0  EQU   UCBCHM1                                                  02926000
UCBPTH1  EQU   UCBCHM1                                                  02927000
UCBWGT   EQU   UCBOB+12                                                 02928000
UCBNAME  EQU   UCBOB+13                                                 02929000
UCBTYP   EQU   UCBOB+16                                                 02930000
UCBTBYT1 EQU   UCBTYP                                                   02931000
UCB1FEA5 EQU   UCBTBYT1                                                 02932000
UCB1FEA6 EQU   UCBTBYT1                                                 02933000
UCBTBYT2 EQU   UCBTYP+1                                                 02934000
UCB2OPT2 EQU   UCBTBYT2                                                 02935000
UCBDUDN1 EQU   UCB2OPT2                                                 02936000
UCB2OPT3 EQU   UCBTBYT2                                                 02937000
UCBDUDN2 EQU   UCB2OPT3                                                 02938000
UCB2OPT4 EQU   UCBTBYT2                                                 02939000
UCBRWTAU EQU   UCB2OPT4                                                 02940000
UCB2OPT6 EQU   UCBTBYT2                                                 02941000
UCB2OPT7 EQU   UCBTBYT2                                                 02942000
UCBTBYT3 EQU   UCBTYP+2                                                 02943000
UCBDVCLS EQU   UCBTBYT3                                                 02944000
UCBTBYT4 EQU   UCBTYP+3                                                 02945000
UCBEXTPT EQU   UCBOB+20                                                 02946000
UCBFLC   EQU   UCBEXTPT                                                 02947000
UCBDEV   EQU   UCBOB+24                                                 02948000
UCBCMEXT EQU   0                                                        02949000
UCBATI   EQU   UCBCMEXT+3                                               02950000
@NM00036 EQU   UCBATI                                                   02951000
UCBFLP1  EQU   UCBCMEXT+5                                               02952000
UCBMT    EQU   0                                                        02953000
UCBOCR   EQU   0                                                        02954000
UCB3540X EQU   0                                                        02955000
UCBVLSER EQU   UCB3540X                                                 02956000
UCBDKBYT EQU   UCB3540X+6                                               02957000
UCBUCS   EQU   0                                                        02958000
UCBUCSOP EQU   UCBUCS+4                                                 02959000
UCBFCBOP EQU   UCBUCS+5                                                 02960000
AMWORKAR EQU   0                                                        02961000
JAMWKAR  EQU   AMWORKAR+4                                               02962000
IOBPTR   EQU   JAMWKAR+1                                                02963000
CCWPTR   EQU   JAMWKAR+5                                                02964000
WORKAREA EQU   JAMWKAR+16                                               02965000
AMW3540E EQU   AMWORKAR+120                                             02966000
AMWVOLAC EQU   AMW3540E                                                 02967000
AMWDSSQL EQU   AMW3540E+1                                               02968000
AMWVSEQU EQU   AMW3540E+2                                               02969000
AMWEAMFG EQU   AMW3540E+3                                               02970000
AMWDSOPN EQU   AMWEAMFG                                                 02971000
AMWMLTVL EQU   AMWEAMFG                                                 02972000
AMWDSID  EQU   AMW3540E+4                                               02973000
AMWEXDTE EQU   AMWDSID                                                  02974000
AMWWTPTI EQU   AMWDSID+6                                                02975000
AMWEOD   EQU   AMW3540E+12                                              02976000
AMWBOE   EQU   AMWEOD                                                   02977000
AMWEODRV EQU   AMWBOE                                                   02978000
AMWEODTT EQU   AMWBOE+1                                                 02979000
AMWBOETT EQU   AMWEODTT                                                 02980000
AMWEOD0  EQU   AMWBOE+2                                                 02981000
AMWEODSS EQU   AMWBOE+3                                                 02982000
AMWBOESS EQU   AMWEODSS                                                 02983000
ACB35EXT EQU   AMWORKAR+136                                             02984000
ACBJOBID EQU   ACB35EXT+8                                               02985000
ACB35IND EQU   ACB35EXT+22                                              02986000
ACBFEED  EQU   ACB35IND                                                 02987000
ACBSECUR EQU   ACB35IND                                                 02988000
ACBLRECL EQU   AMWORKAR+162                                             02989000
EXLIST   EQU   AMWORKAR+164                                             02990000
RPLFIELD EQU   AMWORKAR+172                                             02991000
PRLOPTBT EQU   RPLFIELD+8                                               02992000
RPLFDBK  EQU   RPLFIELD+9                                               02993000
SETDLIST EQU   AMWORKAR+184                                             02994000
SETDWORK EQU   AMWORKAR+200                                             02995000
SAVEIOB  EQU   SETDWORK                                                 02996000
SAVEIOBX EQU   SETDWORK+4                                               02997000
SAVEUCB  EQU   SETDWORK+8                                               02998000
I        EQU   SETDWORK+12                                              02999000
J        EQU   SETDWORK+16                                              03000000
SAVESEEK EQU   SETDWORK+20                                              03001000
CCW21SAV EQU   SETDWORK+24                                              03002000
CCW26SAV EQU   SETDWORK+32                                              03003000
NOOPESAV EQU   SETDWORK+40                                              03004000
SAVEADDR EQU   SETDWORK+48                                              03005000
TABLE    EQU   SETDWORK+136                                             03006000
TRANSTBL EQU   TABLE                                                    03007000
MSGAREA  EQU   SETDWORK+160                                             03008000
MSGLIST  EQU   MSGAREA                                                  03009000
MSGINDEX EQU   MSGLIST                                                  03010000
MSGTYPCD EQU   MSGLIST+1                                                03011000
MSGDCBAD EQU   MSGLIST+4                                                03012000
MSGREPAD EQU   MSGLIST+8                                                03013000
MSGTEXT  EQU   MSGAREA+12                                               03014000
SAVEVOL  EQU   SETDWORK+218                                             03015000
CONVERT  EQU   SETDWORK+224                                             03016000
TEMP1    EQU   SETDWORK+230                                             03017000
TEMP2    EQU   SETDWORK+232                                             03018000
REMAIN   EQU   SETDWORK+234                                             03019000
JULIANDY EQU   SETDWORK+238                                             03020000
JULIANDT EQU   SETDWORK+240                                             03021000
DAY1     EQU   SETDWORK+242                                             03022000
SAVEDATE EQU   SETDWORK+244                                             03023000
UNPKDATE EQU   SETDWORK+248                                             03024000
UNPKYEAR EQU   UNPKDATE+3                                               03025000
SYSYEAR  EQU   SETDWORK+256                                             03026000
SYSDAY   EQU   SETDWORK+258                                             03027000
HDRYEAR1 EQU   SETDWORK+260                                             03028000
HDRDAY1  EQU   SETDWORK+262                                             03029000
DAY      EQU   SETDWORK+264                                             03030000
MONTH    EQU   SETDWORK+265                                             03031000
YEAR     EQU   SETDWORK+266                                             03032000
HDRMTH1  EQU   SETDWORK+267                                             03033000
NUMDAY   EQU   SETDWORK+269                                             03034000
WORKFLG1 EQU   SETDWORK+271                                             03035000
FIRSTTME EQU   WORKFLG1                                                 03036000
GOODVOL1 EQU   WORKFLG1                                                 03037000
GOODHDR1 EQU   WORKFLG1                                                 03038000
BADVOLID EQU   WORKFLG1                                                 03039000
SCRCHDSK EQU   WORKFLG1                                                 03040000
NOSRTCDS EQU   WORKFLG1                                                 03041000
BLKHDRFG EQU   WORKFLG1                                                 03042000
DUPDSID  EQU   WORKFLG1                                                 03043000
WORKFLG2 EQU   SETDWORK+272                                             03044000
EOVPROC  EQU   WORKFLG2                                                 03045000
FEEDCODE EQU   WORKFLG2                                                 03046000
BADREPLY EQU   WORKFLG2                                                 03047000
BLANKCHR EQU   WORKFLG2                                                 03048000
SECURVOL EQU   WORKFLG2                                                 03049000
SETDISKT EQU   0                                                        03050000
SETOPCDE EQU   SETDISKT                                                 03051000
SETFLAGS EQU   SETDISKT+1                                               03052000
SETRETCD EQU   SETDISKT+2                                               03053000
ERTNCDE  EQU   SETRETCD                                                 03054000
ERTNCDQL EQU   SETRETCD+1                                               03055000
SDKTDCB  EQU   SETDISKT+4                                               03056000
SDKTDSID EQU   SETDISKT+8                                               03057000
CHANPGM  EQU   0                                                        03058000
ECBMAP   EQU   0                                                        03059000
ECBCC    EQU   ECBMAP                                                   03060000
REPLYMAP EQU   0                                                        03061000
REPLYARA EQU   REPLYMAP                                                 03062000
REPLYCHR EQU   0                                                        03063000
CHARACTR EQU   0                                                        03064000
VOL13540 EQU   0                                                        03065000
VOLLABID EQU   VOL13540                                                 03066000
VOLID    EQU   VOL13540+4                                               03067000
VOLACCIN EQU   VOL13540+10                                              03068000
VOLLABVR EQU   VOL13540+79                                              03069000
HDR13540 EQU   0                                                        03070000
HDRID    EQU   HDR13540                                                 03071000
HDRDSID  EQU   HDR13540+5                                               03072000
HDRBLKLN EQU   HDR13540+22                                              03073000
HDRBOE   EQU   HDR13540+28                                              03074000
HDRBOECC EQU   HDRBOE                                                   03075000
HDRBOEH  EQU   HDRBOE+2                                                 03076000
HDRBOERR EQU   HDRBOE+3                                                 03077000
HDREOE   EQU   HDR13540+34                                              03078000
HDREOECC EQU   HDREOE                                                   03079000
HDREOEH  EQU   HDREOE+2                                                 03080000
HDREOERR EQU   HDREOE+3                                                 03081000
HDRSECIN EQU   HDR13540+41                                              03082000
HDRWTPTI EQU   HDR13540+42                                              03083000
HDRMVLI  EQU   HDR13540+44                                              03084000
HDRVOLSQ EQU   HDR13540+45                                              03085000
HDREXDTE EQU   HDR13540+66                                              03086000
HDRYEAR  EQU   HDREXDTE                                                 03087000
HDRMONTH EQU   HDREXDTE+2                                               03088000
HDRDAY   EQU   HDREXDTE+4                                               03089000
HDREOD   EQU   HDR13540+74                                              03090000
HDREODCC EQU   HDREOD                                                   03091000
HDREODH  EQU   HDREOD+2                                                 03092000
HDREODRR EQU   HDREOD+3                                                 03093000
CL0001@  EQU   0                                                        03094000
UCBBGN   EQU   0                                                        03095000
IOBORG01 EQU   IOBPREFX+8                                               03096000
IOBNIOBA EQU   IOBORG01                                                 03097000
IOBNFLG1 EQU   IOBNIOBA                                                 03098000
IOBORG02 EQU   IOBPREFX+8                                               03099000
IOBDQADA EQU   IOBORG02                                                 03100000
IOBDEQIN EQU   IOBDQADA                                                 03101000
IOBORG03 EQU   IOBPREFX+12                                              03102000
IOBORG04 EQU   IOBINCAM                                                 03103000
IOBORG12 EQU   IOBINCAM                                                 03104000
IOBFL4   EQU   IOBORG12                                                 03105000
IOBEXTEN EQU   IOBSTDRD+32                                              03106000
IOBSEEK  EQU   IOBEXTEN                                                 03107000
IOBBB    EQU   IOBSEEK+1                                                03108000
IOBCC    EQU   IOBSEEK+3                                                03109000
IOBHH    EQU   IOBSEEK+5                                                03110000
IOBORG05 EQU   IOBEXTEN                                                 03111000
IOBORG06 EQU   IOBEXTEN                                                 03112000
IOBNXTPT EQU   IOBORG06+4                                               03113000
IOBSTATA EQU   IOBNXTPT                                                 03114000
IOBORG07 EQU   IOBEXTEN+8                                               03115000
W1IEXTEN EQU   IOBORG07                                                 03116000
IOBORG08 EQU   IOBEXTEN+8                                               03117000
IOBINDCT EQU   IOBORG08+4                                               03118000
IOBUNSQR EQU   IOBORG08+5                                               03119000
IOBFCHAD EQU   IOBORG08+8                                               03120000
IOBORG09 EQU   IOBEXTEN+8                                               03121000
IOBDPLAD EQU   IOBORG09+4                                               03122000
IOBDTYPE EQU   IOBORG09+8                                               03123000
IOBDTYP2 EQU   IOBORG09+9                                               03124000
IOBDSTAT EQU   IOBORG09+10                                              03125000
IOBSTAT1 EQU   IOBDSTAT                                                 03126000
IOBORG10 EQU   IOBEXTEN+8                                               03127000
IOBSEEK2 EQU   IOBORG10                                                 03128000
IOBORG11 EQU   IOBEXTEN                                                 03129000
IOBERCT  EQU   IOBORG11                                                 03130000
IOBUCBXV EQU   IOBERCT                                                  03131000
IOBNAME  EQU   IOBORG11+4                                               03132000
IOBORG13 EQU   IOBEXTEN                                                 03133000
IOBSKADR EQU   IOBORG13                                                 03134000
IOBSKTT  EQU   IOBSKADR+1                                               03135000
IOBSKSS  EQU   IOBSKADR+3                                               03136000
DEBBAS02 EQU   DEBBASND                                                 03137000
DEBDDS1  EQU   DEBBAS02                                                 03138000
DEBSUCBA EQU   DEBDDS1                                                  03139000
DEBSUCBB EQU   DEBSUCBA+1                                               03140000
DEBDEVED EQU   DEBDDS1+4                                                03141000
DEBRDCB  EQU   DEBDDS1+4                                                03142000
DEBPDCB  EQU   DEBDDS1+8                                                03143000
DEBWDCB  EQU   DEBDDS1+12                                               03144000
DEBACS09 EQU   DEBDEVED                                                 03145000
DEBASC09 EQU   DEBACS09                                                 03146000
DEBEAMFG EQU   DEBASC09+3                                               03147000
DEBDSID  EQU   DEBASC09+4                                               03148000
DEBEOD   EQU   DEBASC09+12                                              03149000
DEBBOE   EQU   DEBEOD                                                   03150000
DEBEODRV EQU   DEBBOE                                                   03151000
DEBEODTT EQU   DEBBOE+1                                                 03152000
DEBEOD0  EQU   DEBBOE+2                                                 03153000
DEBEODSS EQU   DEBBOE+3                                                 03154000
DEBBAS01 EQU   DEBBASND                                                 03155000
DEBISAM  EQU   DEBBAS01                                                 03156000
DEBFIEAD EQU   DEBISAM                                                  03157000
DEBFPEAD EQU   DEBISAM+4                                                03158000
DEBFOEAD EQU   DEBISAM+8                                                03159000
DEBEXPT  EQU   DEBISAM+12                                               03160000
DEBRPSID EQU   DEBEXPT                                                  03161000
UCBOBS01 EQU   UCBDEV                                                   03162000
UCBSTAB  EQU   UCBOBS01+10                                              03163000
UCBBSVL  EQU   UCBSTAB                                                  03164000
UCBPRSRS EQU   UCBSTAB                                                  03165000
UCBDMCT  EQU   UCBOBS01+11                                              03166000
UCBFL4   EQU   UCBOBS01+13                                              03167000
UCBOBS02 EQU   UCBDEV                                                   03168000
UCBTFL1  EQU   UCBOBS02+19                                              03169000
UCBXTN   EQU   UCBOBS02+20                                              03170000
UCBVOPT  EQU   UCBXTN                                                   03171000
UCBOBS03 EQU   UCBDEV                                                   03172000
UCBXTADR EQU   UCBOBS03                                                 03173000
UCBOBS04 EQU   UCBDEV                                                   03174000
UCBBTA   EQU   UCBOBS04+12                                              03175000
UCBOBS06 EQU   UCBDEV                                                   03176000
UCBAOF   EQU   UCBOBS06                                                 03177000
UCBAOF1  EQU   UCBAOF                                                   03178000
UCBAOF2  EQU   UCBAOF+1                                                 03179000
@NM00035 EQU   UCBOBS06+3                                               03180000
UCBIRB   EQU   UCBOBS06+4                                               03181000
UCBGRAF  EQU   UCBIRB                                                   03182000
UCBLDNCA EQU   UCBOBS06+8                                               03183000
UCBRDYQ  EQU   UCBLDNCA                                                 03184000
UCBIRLN  EQU   UCBRDYQ                                                  03185000
UCBLDNCB EQU   UCBRDYQ+1                                                03186000
UCBCTLNK EQU   UCBOBS06+12                                              03187000
UCBOBS07 EQU   UCBDEV                                                   03188000
UCBOBS08 EQU   UCBDEV                                                   03189000
UCBOBS09 EQU   UCBDEV                                                   03190000
PSARSVTE EQU   PSARSVT                                                  03191000
DCBAMWRK EQU   DCBIOBAD                                                 03192000
@NM00073 EQU   DCBAMWRK                                                 03193000
DCBAMWKA EQU   DCBAMWRK+1                                               03194000
FLC      EQU   PSA                                                      03195000
*                                      START UNREFERENCED COMPONENTS    03196000
DCBAMOUT EQU   @NM00073                                                 03197000
DCBAMIN  EQU   @NM00073                                                 03198000
DCB3540A EQU   @NM00073                                                 03199000
@NM00074 EQU   @NM00073                                                 03200000
PSARSAV  EQU   PSARSVTE+60                                              03201000
PSARSTK  EQU   PSARSVTE+56                                              03202000
PSAESAV3 EQU   PSARSVTE+52                                              03203000
PSAESTK3 EQU   PSARSVTE+48                                              03204000
PSAESAV2 EQU   PSARSVTE+44                                              03205000
PSAESTK2 EQU   PSARSVTE+40                                              03206000
PSAESAV1 EQU   PSARSVTE+36                                              03207000
PSAESTK1 EQU   PSARSVTE+32                                              03208000
PSAPSAV  EQU   PSARSVTE+28                                              03209000
PSAPSTK  EQU   PSARSVTE+24                                              03210000
PSAMSAV  EQU   PSARSVTE+20                                              03211000
PSAMSTK  EQU   PSARSVTE+16                                              03212000
PSASSAV  EQU   PSARSVTE+12                                              03213000
PSASSTK  EQU   PSARSVTE+8                                               03214000
PSANSTK  EQU   PSARSVTE+4                                               03215000
PSACSTK  EQU   PSARSVTE                                                 03216000
UCBRV066 EQU   UCBOBS09+4                                               03217000
UCBIOSBA EQU   UCBOBS09                                                 03218000
UCBRV042 EQU   UCBOBS08+5                                               03219000
UCBCTCF1 EQU   UCBOBS08+4                                               03220000
UCBCTCAD EQU   UCBOBS08                                                 03221000
UCBICNCB EQU   UCBOBS07+4                                               03222000
UCBRV040 EQU   UCBOBS07                                                 03223000
UCBCTLNA EQU   UCBCTLNK+1                                               03224000
UCBRLN   EQU   UCBCTLNK                                                 03225000
UCBRDYQA EQU   UCBLDNCB                                                 03226000
UCBINRLN EQU   UCBIRLN                                                  03227000
UCBIRBA  EQU   UCBIRB+1                                                 03228000
UCBRV039 EQU   UCBGRAF                                                  03229000
UCBDWNR  EQU   UCBGRAF                                                  03230000
UCBRPND  EQU   UCBGRAF                                                  03231000
UCBUPM   EQU   UCBGRAF                                                  03232000
UCBBTAM  EQU   UCBGRAF                                                  03233000
UCBDRNO  EQU   UCBGRAF                                                  03234000
UCBDRO   EQU   UCBGRAF                                                  03235000
UCBOIP   EQU   UCBGRAF                                                  03236000
UCBATRCD EQU   @NM00035                                                 03237000
UCBSKPFG EQU   @NM00035                                                 03238000
UCBRIPND EQU   @NM00035                                                 03239000
UCBRTIAC EQU   @NM00035                                                 03240000
UCBRSV79 EQU   @NM00035                                                 03241000
UCBRSV78 EQU   @NM00035                                                 03242000
UCBRSV77 EQU   @NM00035                                                 03243000
UCBOLTEP EQU   @NM00035                                                 03244000
UCBATNCT EQU   UCBOBS06+2                                               03245000
UCBRSV76 EQU   UCBAOF2                                                  03246000
UCBRSV75 EQU   UCBAOF2                                                  03247000
UCBRSV74 EQU   UCBAOF2                                                  03248000
UCBRSV73 EQU   UCBAOF2                                                  03249000
UCBRSV72 EQU   UCBAOF2                                                  03250000
UCBRSV71 EQU   UCBAOF2                                                  03251000
UCBRSV70 EQU   UCBAOF2                                                  03252000
UCBRSV69 EQU   UCBAOF2                                                  03253000
UCBRSV68 EQU   UCBAOF1                                                  03254000
UCBRSV67 EQU   UCBAOF1                                                  03255000
UCBRSV66 EQU   UCBAOF1                                                  03256000
UCBRSV65 EQU   UCBAOF1                                                  03257000
UCBRSV64 EQU   UCBAOF1                                                  03258000
UCBOFNL  EQU   UCBAOF1                                                  03259000
UCBOFSP  EQU   UCBAOF1                                                  03260000
UCBOFMCR EQU   UCBAOF1                                                  03261000
UCBBTB   EQU   UCBBTA+1                                                 03262000
UCBDI    EQU   UCBBTA                                                   03263000
UCBSNS   EQU   UCBOBS04+8                                               03264000
UCBTEB   EQU   UCBOBS04+4                                               03265000
UCBGCB   EQU   UCBOBS04+3                                               03266000
UCBOPEN  EQU   UCBOBS04+2                                               03267000
UCBSTART EQU   UCBOBS04                                                 03268000
UCBXTNB  EQU   UCBXTN+1                                                 03269000
UCBRSV22 EQU   UCBVOPT                                                  03270000
UCBRSV21 EQU   UCBVOPT                                                  03271000
UCBRSV20 EQU   UCBVOPT                                                  03272000
UCBESVE  EQU   UCBVOPT                                                  03273000
UCBERPC  EQU   UCBVOPT                                                  03274000
UCBESVC  EQU   UCBVOPT                                                  03275000
UCBEVA   EQU   UCBVOPT                                                  03276000
UCBESV   EQU   UCBVOPT                                                  03277000
UCBRV009 EQU   UCBTFL1                                                  03278000
UCBRV008 EQU   UCBTFL1                                                  03279000
UCBRV007 EQU   UCBTFL1                                                  03280000
UCBRV006 EQU   UCBTFL1                                                  03281000
UCBRV005 EQU   UCBTFL1                                                  03282000
UCBRV038 EQU   UCBTFL1                                                  03283000
UCBNSLTP EQU   UCBTFL1                                                  03284000
UCBNLTP  EQU   UCBTFL1                                                  03285000
UCBRES1B EQU   UCBOBS02+18                                              03286000
UCBFSER  EQU   UCBOBS02+12                                              03287000
@NM00034 EQU   UCBOBS02+4                                               03288000
UCBFSEQ  EQU   UCBOBS02+2                                               03289000
UCBFSCT  EQU   UCBOBS02                                                 03290000
UCBNEXP  EQU   UCBOBS01+20                                              03291000
UCBBASE  EQU   UCBOBS01+16                                              03292000
UCBRES1A EQU   UCBOBS01+15                                              03293000
UCBUSER  EQU   UCBOBS01+14                                              03294000
UCBFL47  EQU   UCBFL4                                                   03295000
UCBFL46  EQU   UCBFL4                                                   03296000
UCBFL45  EQU   UCBFL4                                                   03297000
UCBRV065 EQU   UCBFL4                                                   03298000
UCBDSS   EQU   UCBFL4                                                   03299000
UCBRV028 EQU   UCBFL4                                                   03300000
UCBWDAV  EQU   UCBFL4                                                   03301000
UCBDAVV  EQU   UCBFL4                                                   03302000
UCBSQC   EQU   UCBOBS01+12                                              03303000
UCBDATP  EQU   UCBOBS01+12                                              03304000
UCBDMC   EQU   UCBDMCT                                                  03305000
UCBMOUNT EQU   UCBDMCT                                                  03306000
UCBBNUL  EQU   UCBSTAB                                                  03307000
UCBSHAR  EQU   UCBSTAB                                                  03308000
UCBBSTR  EQU   UCBSTAB                                                  03309000
UCBBPUB  EQU   UCBSTAB                                                  03310000
UCBBPRV  EQU   UCBSTAB                                                  03311000
UCBBALB  EQU   UCBPRSRS                                                 03312000
UCBPGFL  EQU   UCBSTAB                                                  03313000
UCBDVSHR EQU   UCBBSVL                                                  03314000
UCBVOLI  EQU   UCBOBS01+4                                               03315000
UCBVTOC  EQU   UCBOBS01                                                 03316000
DEBEXPTA EQU   DEBEXPT+1                                                03317000
DEBRSV12 EQU   DEBRPSID                                                 03318000
DEBRSV11 EQU   DEBRPSID                                                 03319000
DEBRSV10 EQU   DEBRPSID                                                 03320000
DEBRSV09 EQU   DEBRPSID                                                 03321000
DEBRPSAP EQU   DEBRPSID                                                 03322000
DEBRPSO  EQU   DEBRPSID                                                 03323000
DEBRPSI  EQU   DEBRPSID                                                 03324000
DEBRPSP  EQU   DEBRPSID                                                 03325000
DEBFOEB  EQU   DEBFOEAD+1                                               03326000
DEBNOEE  EQU   DEBFOEAD                                                 03327000
DEBFPEB  EQU   DEBFPEAD+1                                               03328000
DEBNPEE  EQU   DEBFPEAD                                                 03329000
DEBFIEB  EQU   DEBFIEAD+1                                               03330000
DEBNIEE  EQU   DEBFIEAD                                                 03331000
DEBBOESS EQU   DEBEODSS                                                 03332000
DEBBOE0  EQU   DEBEOD0                                                  03333000
DEBBOETT EQU   DEBEODTT                                                 03334000
DEBBOERV EQU   DEBEODRV                                                 03335000
DEBRV008 EQU   DEBDSID+7                                                03336000
DEBWTPTI EQU   DEBDSID+6                                                03337000
DEBEXDTE EQU   DEBDSID                                                  03338000
DEBRV007 EQU   DEBEAMFG                                                 03339000
DEBRV006 EQU   DEBEAMFG                                                 03340000
DEBRV005 EQU   DEBEAMFG                                                 03341000
DEBRV004 EQU   DEBEAMFG                                                 03342000
DEBSECVL EQU   DEBEAMFG                                                 03343000
DEBVAMSG EQU   DEBEAMFG                                                 03344000
DEBDSOPN EQU   DEBEAMFG                                                 03345000
DEBMULTI EQU   DEBEAMFG                                                 03346000
DEBVSEQU EQU   DEBASC09+2                                               03347000
DEBDSSQL EQU   DEBASC09+1                                               03348000
DEBVOLAC EQU   DEBASC09                                                 03349000
DEBWDCBA EQU   DEBWDCB+1                                                03350000
DEBRSV08 EQU   DEBWDCB                                                  03351000
DEBPDCBA EQU   DEBPDCB+1                                                03352000
DEBRSV07 EQU   DEBPDCB                                                  03353000
DEBRDCBA EQU   DEBRDCB+1                                                03354000
DEBRSV06 EQU   DEBRDCB                                                  03355000
DEBSDVM  EQU   DEBSUCBA                                                 03356000
IOBSK0   EQU   IOBSKADR+2                                               03357000
IOBSKRV  EQU   IOBSKADR                                                 03358000
IOBCSWSV EQU   IOBORG11+17                                              03359000
IOBSENSV EQU   IOBORG11+16                                              03360000
IOBRCD   EQU   IOBORG11+12                                              03361000
IOBMDREC EQU   IOBORG11+8                                               03362000
IOBNAMEA EQU   IOBNAME+1                                                03363000
IOBNAMSZ EQU   IOBNAME                                                  03364000
IOBERCTA EQU   IOBERCT+1                                                03365000
IOBRTYPE EQU   IOBUCBXV                                                 03366000
IOBRDCHP EQU   IOBORG10+20                                              03367000
IOBNEXTA EQU   IOBORG10+16                                              03368000
IOBREADA EQU   IOBORG10+12                                              03369000
IOBBUFC  EQU   IOBORG10+8                                               03370000
IOBSK2R  EQU   IOBSEEK2+7                                               03371000
IOBSK2HH EQU   IOBSEEK2+5                                               03372000
IOBSK2CC EQU   IOBSEEK2+3                                               03373000
IOBSK2BB EQU   IOBSEEK2+1                                               03374000
IOBSK2M  EQU   IOBSEEK2                                                 03375000
IOBCHNPR EQU   IOBORG09+40                                              03376000
IOBDNCRF EQU   IOBORG09+32                                              03377000
IOBRSV35 EQU   IOBORG09+24                                              03378000
IOBDQPTR EQU   IOBORG09+20                                              03379000
IOBRSV34 EQU   IOBORG09+18                                              03380000
IOBDBYTN EQU   IOBORG09+16                                              03381000
IOBDCPND EQU   IOBORG09+12                                              03382000
IOBSTAT2 EQU   IOBDSTAT+1                                               03383000
IOBSIORT EQU   IOBSTAT1                                                 03384000
IOBADDVU EQU   IOBSTAT1                                                 03385000
IOBBUFF  EQU   IOBSTAT1                                                 03386000
IOBENQUE EQU   IOBSTAT1                                                 03387000
IOBPASS2 EQU   IOBSTAT1                                                 03388000
IOBSYNCH EQU   IOBSTAT1                                                 03389000
IOBNEWVL EQU   IOBSTAT1                                                 03390000
IOBABNRM EQU   IOBSTAT1                                                 03391000
IOBRELEX EQU   IOBDTYP2                                                 03392000
IOBADDTY EQU   IOBDTYP2                                                 03393000
IOBTYPE  EQU   IOBDTYP2                                                 03394000
IOBRQUST EQU   IOBDTYP2                                                 03395000
IOBSUFFX EQU   IOBDTYP2                                                 03396000
IOBSBLKL EQU   IOBDTYP2                                                 03397000
IOBSKEY  EQU   IOBDTYP2                                                 03398000
IOBRELBL EQU   IOBDTYPE                                                 03399000
IOBRDEXC EQU   IOBDTYPE                                                 03400000
IOBDYNBF EQU   IOBDTYPE                                                 03401000
IOBACTAD EQU   IOBDTYPE                                                 03402000
IOBFDBCK EQU   IOBDTYPE                                                 03403000
IOBEXTSC EQU   IOBDTYPE                                                 03404000
IOBOVFLO EQU   IOBDTYPE                                                 03405000
IOBVERFY EQU   IOBDTYPE                                                 03406000
IOBDPLB  EQU   IOBDPLAD+1                                               03407000
IOBDAYLI EQU   IOBDPLAD                                                 03408000
IOBDIOBS EQU   IOBORG09+2                                               03409000
IOBDBYTR EQU   IOBORG09                                                 03410000
IOBBCHAD EQU   IOBORG08+12                                              03411000
IOBFCHNB EQU   IOBFCHAD+1                                               03412000
IOBCOUNT EQU   IOBFCHAD                                                 03413000
IOBASYN  EQU   IOBORG08+7                                               03414000
IOBAPP   EQU   IOBORG08+6                                               03415000
IOBRSV32 EQU   IOBUNSQR                                                 03416000
IOBRSV31 EQU   IOBUNSQR                                                 03417000
IOBRSV30 EQU   IOBUNSQR                                                 03418000
IOBKNRWR EQU   IOBUNSQR                                                 03419000
IOBKNWR  EQU   IOBUNSQR                                                 03420000
IOBNTAV2 EQU   IOBUNSQR                                                 03421000
IOBNTAV1 EQU   IOBUNSQR                                                 03422000
IOBCPBSY EQU   IOBUNSQR                                                 03423000
IOBCHNNL EQU   IOBINDCT                                                 03424000
IOBRSV29 EQU   IOBINDCT                                                 03425000
IOBRSV28 EQU   IOBINDCT                                                 03426000
IOBRSV27 EQU   IOBINDCT                                                 03427000
IOBKEYAD EQU   IOBINDCT                                                 03428000
IOBOVPTR EQU   IOBINDCT                                                 03429000
IOBUNSCH EQU   IOBINDCT                                                 03430000
IOBDEQCP EQU   IOBINDCT                                                 03431000
IOBCCWAD EQU   IOBORG08                                                 03432000
W1OEXTEN EQU   W1IEXTEN                                                 03433000
IOBCCW   EQU   IOBORG06+8                                               03434000
IOBNXTPB EQU   IOBNXTPT+1                                               03435000
IOBRSV26 EQU   IOBSTATA                                                 03436000
IOBRSV25 EQU   IOBSTATA                                                 03437000
IOBRSV24 EQU   IOBSTATA                                                 03438000
IOBRSV23 EQU   IOBSTATA                                                 03439000
IOBRSV22 EQU   IOBSTATA                                                 03440000
IOBRSV21 EQU   IOBSTATA                                                 03441000
IOBRSV20 EQU   IOBSTATA                                                 03442000
IOBAVLFL EQU   IOBSTATA                                                 03443000
IOBRSV37 EQU   IOBORG06+1                                               03444000
IOBUCBXG EQU   IOBORG06                                                 03445000
IOBCPA   EQU   IOBORG05+32                                              03446000
IOBERINF EQU   IOBORG05+16                                              03447000
IOBERCCW EQU   IOBORG05+8                                               03448000
IOBSNDPT EQU   IOBORG05+7                                               03449000
IOBRCVPT EQU   IOBORG05+6                                               03450000
IOBWORK  EQU   IOBORG05+1                                               03451000
IOBUCBX  EQU   IOBORG05                                                 03452000
IOBR     EQU   IOBSEEK+7                                                03453000
IOBHH2   EQU   IOBHH+1                                                  03454000
IOBHH1   EQU   IOBHH                                                    03455000
IOBCC2   EQU   IOBCC+1                                                  03456000
IOBCC1   EQU   IOBCC                                                    03457000
IOBBB2   EQU   IOBBB+1                                                  03458000
IOBBB1   EQU   IOBBB                                                    03459000
IOBM     EQU   IOBSEEK                                                  03460000
IOBRSV46 EQU   IOBFL4                                                   03461000
IOBRSV47 EQU   IOBFL4                                                   03462000
IOBENT   EQU   IOBFL4                                                   03463000
IOBEQP   EQU   IOBFL4                                                   03464000
IOBBUS   EQU   IOBFL4                                                   03465000
IOBDCK   EQU   IOBFL4                                                   03466000
IOBREJ   EQU   IOBFL4                                                   03467000
IOBOVR   EQU   IOBFL4                                                   03468000
IOBCRILC EQU   IOBORG04+1                                               03469000
IOBCRDCC EQU   IOBORG04                                                 03470000
IOBGQECB EQU   IOBORG03                                                 03471000
IOBSWAP  EQU   IOBORG02+4                                               03472000
IOBDQADB EQU   IOBDQADA+1                                               03473000
IOBRSV13 EQU   IOBDEQIN                                                 03474000
IOBRSV12 EQU   IOBDEQIN                                                 03475000
IOBRSV11 EQU   IOBDEQIN                                                 03476000
IOBRSV10 EQU   IOBDEQIN                                                 03477000
IOBRSV09 EQU   IOBDEQIN                                                 03478000
IOBRSV08 EQU   IOBDEQIN                                                 03479000
IOBRSV07 EQU   IOBDEQIN                                                 03480000
IOBDEQ   EQU   IOBDEQIN                                                 03481000
IOBNECB  EQU   IOBORG01+4                                               03482000
IOBNIOBB EQU   IOBNIOBA+1                                               03483000
IOBFIRST EQU   IOBNFLG1                                                 03484000
IOBUPERR EQU   IOBNFLG1                                                 03485000
IOBSPAN  EQU   IOBNFLG1                                                 03486000
IOBBKSPC EQU   IOBNFLG1                                                 03487000
IOBUPDAT EQU   IOBNFLG1                                                 03488000
IOBREAD  EQU   IOBNFLG1                                                 03489000
IOBWRITE EQU   IOBNFLG1                                                 03490000
IOBPRTOV EQU   IOBNFLG1                                                 03491000
HDRCONTI EQU   HDR13540+79                                              03492000
@NM00085 EQU   HDR13540+73                                              03493000
HDRVERFY EQU   HDR13540+72                                              03494000
@NM00084 EQU   HDR13540+53                                              03495000
HDRDSCD  EQU   HDR13540+47                                              03496000
HDRINTCH EQU   HDR13540+43                                              03497000
HDRBYPAS EQU   HDR13540+40                                              03498000
@NM00083 EQU   HDR13540+39                                              03499000
@NM00082 EQU   HDR13540+33                                              03500000
@NM00081 EQU   HDR13540+27                                              03501000
HDRNRECS EQU   HDR13540+17                                              03502000
HDRRECLN EQU   HDR13540+13                                              03503000
@NM00080 EQU   HDR13540+4                                               03504000
@NM00079 EQU   VOL13540+78                                              03505000
VOLSEQ   EQU   VOL13540+76                                              03506000
VOLPHYRL EQU   VOL13540+75                                              03507000
@NM00078 EQU   VOL13540+51                                              03508000
VOLOWNID EQU   VOL13540+37                                              03509000
@NM00077 EQU   VOL13540+16                                              03510000
VOLADMLB EQU   VOL13540+11                                              03511000
@NM00076 EQU   REPLYMAP+1                                               03512000
ECBRBA   EQU   ECBMAP+1                                                 03513000
@NM00075 EQU   SETFLAGS                                                 03514000
SDKTVFYI EQU   SETFLAGS                                                 03515000
BUFFER2  EQU   AMWORKAR+4488                                            03516000
CCWS2    EQU   AMWORKAR+4256                                            03517000
IOB2     EQU   AMWORKAR+4208                                            03518000
BUFFER1  EQU   AMWORKAR+880                                             03519000
CCWS1    EQU   AMWORKAR+648                                             03520000
IOB1     EQU   AMWORKAR+600                                             03521000
@NM00072 EQU   SETDWORK+273                                             03522000
@NM00071 EQU   WORKFLG2                                                 03523000
UNPKDAY  EQU   UNPKDATE+5                                               03524000
@NM00070 EQU   UNPKDATE                                                 03525000
CONVERT1 EQU   SETDWORK+228                                             03526000
@NM00069 EQU   SETDWORK+217                                             03527000
MSGRTCDE EQU   MSGLIST+2                                                03528000
SETDDSID EQU   SETDLIST+8                                               03529000
SETDDCB  EQU   SETDLIST+4                                               03530000
SETDRTNC EQU   SETDLIST+2                                               03531000
SETDVERY EQU   SETDLIST+1                                               03532000
SETDOPCD EQU   SETDLIST                                                 03533000
RPLFDBK3 EQU   RPLFDBK+2                                                03534000
RPLFDBK2 EQU   RPLFDBK+1                                                03535000
RPLFDBK1 EQU   RPLFDBK                                                  03536000
@NM00068 EQU   PRLOPTBT                                                 03537000
RPLEODS  EQU   PRLOPTBT                                                 03538000
RPLAREA  EQU   RPLFIELD+4                                               03539000
RPLRLEN  EQU   RPLFIELD                                                 03540000
EXLEODP  EQU   EXLIST+4                                                 03541000
EXLSYNP  EQU   EXLIST                                                   03542000
@NM00067 EQU   AMWORKAR+160                                             03543000
@NM00066 EQU   ACB35IND                                                 03544000
ACBVSSER EQU   ACB35EXT+16                                              03545000
ACBDSID  EQU   ACB35EXT                                                 03546000
AMWBOE0  EQU   AMWEOD0                                                  03547000
AMWBOERV EQU   AMWEODRV                                                 03548000
@NM00065 EQU   AMWDSID+7                                                03549000
@NM00064 EQU   AMWEAMFG                                                 03550000
AMWVAMSG EQU   AMWEAMFG                                                 03551000
AMWMULTI EQU   AMWEAMFG                                                 03552000
REGSAVE  EQU   WORKAREA+28                                              03553000
WORKBSL  EQU   WORKAREA                                                 03554000
IOBBFLN  EQU   JAMWKAR+13                                               03555000
@NM00063 EQU   JAMWKAR+12                                               03556000
IOB1ADDR EQU   JAMWKAR+9                                                03557000
@NM00062 EQU   JAMWKAR+8                                                03558000
@NM00061 EQU   JAMWKAR+4                                                03559000
IOBNO    EQU   JAMWKAR                                                  03560000
AMWLEN   EQU   AMWORKAR                                                 03561000
UCBERADR EQU   UCBUCS+12                                                03562000
UCBFCBID EQU   UCBUCS+8                                                 03563000
UCBERCNT EQU   UCBUCS+7                                                 03564000
UCBRSV51 EQU   UCBUCS+6                                                 03565000
UCBRSV50 EQU   UCBFCBOP                                                 03566000
UCBRSV49 EQU   UCBFCBOP                                                 03567000
UCBRSV48 EQU   UCBFCBOP                                                 03568000
UCBRSV47 EQU   UCBFCBOP                                                 03569000
UCBRSV46 EQU   UCBFCBOP                                                 03570000
UCBRSV45 EQU   UCBFCBOP                                                 03571000
UCBRSV44 EQU   UCBFCBOP                                                 03572000
UCBFCBO1 EQU   UCBFCBOP                                                 03573000
UCBUCSPE EQU   UCBUCSOP                                                 03574000
UCBRSV43 EQU   UCBUCSOP                                                 03575000
UCBRSV42 EQU   UCBUCSOP                                                 03576000
UCBRSV41 EQU   UCBUCSOP                                                 03577000
UCBRSV40 EQU   UCBUCSOP                                                 03578000
UCBRSV39 EQU   UCBUCSOP                                                 03579000
UCBUCSO2 EQU   UCBUCSOP                                                 03580000
UCBUCSO1 EQU   UCBUCSOP                                                 03581000
UCBUCSID EQU   UCBUCS                                                   03582000
UCBRV073 EQU   UCB3540X+7                                               03583000
UCBRV072 EQU   UCBDKBYT                                                 03584000
UCBRV071 EQU   UCBDKBYT                                                 03585000
UCBRV070 EQU   UCBDKBYT                                                 03586000
UCBRV069 EQU   UCBDKBYT                                                 03587000
UCBRV068 EQU   UCBDKBYT                                                 03588000
UCBRV067 EQU   UCBDKBYT                                                 03589000
UCBVLVER EQU   UCBDKBYT                                                 03590000
UCBDKAMX EQU   UCBDKBYT                                                 03591000
UCBRDATA EQU   UCBOCR+4                                                 03592000
UCBFRID  EQU   UCBOCR                                                   03593000
UCBCLN   EQU   UCBMT+14                                                 03594000
UCBERG   EQU   UCBMT+12                                                 03595000
UCBMS    EQU   UCBMT+11                                                 03596000
UCBNB    EQU   UCBMT+10                                                 03597000
UCBPW    EQU   UCBMT+9                                                  03598000
UCBPR    EQU   UCBMT+8                                                  03599000
UCBSIO   EQU   UCBMT+6                                                  03600000
UCBTW    EQU   UCBMT+5                                                  03601000
UCBTR    EQU   UCBMT+4                                                  03602000
UCBTWT   EQU   UCBMT+3                                                  03603000
UCBTRT   EQU   UCBMT+2                                                  03604000
UCBCTD   EQU   UCBMT                                                    03605000
UCBWTOID EQU   UCBCMEXT+17                                              03606000
UCBRV043 EQU   UCBCMEXT+16                                              03607000
UCBASID  EQU   UCBCMEXT+14                                              03608000
UCBMFCNT EQU   UCBCMEXT+12                                              03609000
UCBPMSK  EQU   UCBCMEXT+10                                              03610000
UCBCCWOF EQU   UCBCMEXT+8                                               03611000
UCBRV041 EQU   UCBCMEXT+6                                               03612000
UCBRV036 EQU   UCBFLP1                                                  03613000
UCBRV035 EQU   UCBFLP1                                                  03614000
UCBRV034 EQU   UCBFLP1                                                  03615000
UCBRV033 EQU   UCBFLP1                                                  03616000
UCBRV032 EQU   UCBFLP1                                                  03617000
UCBRV031 EQU   UCBFLP1                                                  03618000
UCBSHRUP EQU   UCBFLP1                                                  03619000
UCBNSRCH EQU   UCBFLP1                                                  03620000
UCBSNSCT EQU   UCBCMEXT+4                                               03621000
UCBHPDV  EQU   @NM00036                                                 03622000
UCBHALI  EQU   @NM00036                                                 03623000
UCBRSV09 EQU   @NM00036                                                 03624000
UCBRSV08 EQU   @NM00036                                                 03625000
UCBRSV07 EQU   @NM00036                                                 03626000
UCBRSV06 EQU   @NM00036                                                 03627000
UCBRSV05 EQU   @NM00036                                                 03628000
UCBRSV04 EQU   @NM00036                                                 03629000
UCBDTI   EQU   UCBCMEXT+2                                               03630000
UCBSTI   EQU   UCBCMEXT+1                                               03631000
UCBETI   EQU   UCBCMEXT                                                 03632000
UCBEXTP  EQU   UCBEXTPT+1                                               03633000
UCBDDRSW EQU   UCBFLC                                                   03634000
UCBTICBT EQU   UCBFLC                                                   03635000
UCBIVRR  EQU   UCBFLC                                                   03636000
UCBIVRS  EQU   UCBFLC                                                   03637000
UCBITF   EQU   UCBFLC                                                   03638000
UCBUDE   EQU   UCBFLC                                                   03639000
UCBWAA   EQU   UCBFLC                                                   03640000
UCBATTP  EQU   UCBFLC                                                   03641000
UCBUNTYP EQU   UCBTBYT4                                                 03642000
UCBRSV11 EQU   UCBDVCLS                                                 03643000
UCBRSV10 EQU   UCBDVCLS                                                 03644000
UCB3CHAR EQU   UCBDVCLS                                                 03645000
UCB3UREC EQU   UCBDVCLS                                                 03646000
UCB3DISP EQU   UCBDVCLS                                                 03647000
UCB3DACC EQU   UCBDVCLS                                                 03648000
UCB3COMM EQU   UCBDVCLS                                                 03649000
UCB3TAPE EQU   UCBDVCLS                                                 03650000
UCBDVPWR EQU   UCB2OPT7                                                 03651000
UCBVLPWR EQU   UCB2OPT6                                                 03652000
UCB2OPT5 EQU   UCBTBYT2                                                 03653000
UCBRVDEV EQU   UCBRWTAU                                                 03654000
UCBRPS   EQU   UCBDUDN2                                                 03655000
UCBRR    EQU   UCBDUDN1                                                 03656000
UCB2OPT1 EQU   UCBTBYT2                                                 03657000
UCB2OPT0 EQU   UCBTBYT2                                                 03658000
UCB1FEA7 EQU   UCBTBYT1                                                 03659000
UCBD6250 EQU   UCB1FEA6                                                 03660000
UCBD1600 EQU   UCB1FEA5                                                 03661000
UCB1FEA4 EQU   UCBTBYT1                                                 03662000
UCB1FEA3 EQU   UCBTBYT1                                                 03663000
UCB1FEA2 EQU   UCBTBYT1                                                 03664000
UCB1FEA1 EQU   UCBTBYT1                                                 03665000
UCB1FEA0 EQU   UCBTBYT1                                                 03666000
UCBRV029 EQU   UCBWGT                                                   03667000
UCBVHRSN EQU   UCBWGT                                                   03668000
UCBVORSN EQU   UCBWGT                                                   03669000
UCBMTPXP EQU   UCBWGT                                                   03670000
UCBREW   EQU   UCBWGT                                                   03671000
UCBPUB   EQU   UCBWGT                                                   03672000
UCBOUT   EQU   UCBWGT                                                   03673000
UCBIN    EQU   UCBWGT                                                   03674000
UCBCPU   EQU   UCBOB+11                                                 03675000
UCBLCI   EQU   UCBOB+10                                                 03676000
UCBCNT   EQU   UCBOB+9                                                  03677000
UCBRV017 EQU   UCBCHM1                                                  03678000
UCBRV016 EQU   UCBCHM1                                                  03679000
UCBRV015 EQU   UCBCHM1                                                  03680000
UCBRV014 EQU   UCBCHM1                                                  03681000
UCBSPB   EQU   UCBPTH1                                                  03682000
UCBPPB   EQU   UCBPTH1                                                  03683000
UCBSPA   EQU   UCBPTH0                                                  03684000
UCBPPA   EQU   UCBPTH0                                                  03685000
UCBFLB7  EQU   UCBFLB                                                   03686000
UCBVALPH EQU   UCBFLB                                                   03687000
UCBCRHSN EQU   UCBFLB                                                   03688000
UCBCRHRV EQU   UCBFLB                                                   03689000
UCBRESVH EQU   UCBFLB                                                   03690000
UCBSPST  EQU   UCBFLB                                                   03691000
UCBASNS  EQU   UCBFLB                                                   03692000
UCBIORST EQU   UCBFLB                                                   03693000
UCBQISCE EQU   UCBFL1                                                   03694000
UCBACTV  EQU   UCBFL1                                                   03695000
UCBSAP   EQU   UCBFL1                                                   03696000
UCBNOTRC EQU   UCBCUB                                                   03697000
UCBPSNS  EQU   UCBFL1                                                   03698000
UCBUSING EQU   UCBPST                                                   03699000
UCBNOTRD EQU   UCBNRY                                                   03700000
UCBBUSYD EQU   UCBBSY                                                   03701000
UCBUA    EQU   UCBCHAN+1                                                03702000
UCBCHA   EQU   UCBCHAN                                                  03703000
UCBDADI  EQU   UCBSTAT                                                  03704000
UCBSYSR  EQU   UCBSTAT                                                  03705000
UCBPRES  EQU   UCBSTAT                                                  03706000
UCBALOC  EQU   UCBSTAT                                                  03707000
UCBUNLD  EQU   UCBSTAT                                                  03708000
UCBRESV  EQU   UCBSTAT                                                  03709000
UCBCHGS  EQU   UCBSTAT                                                  03710000
UCBONLI  EQU   UCBSTAT                                                  03711000
UCBID    EQU   UCBOB+2                                                  03712000
UCBALTPH EQU   UCBFL5                                                   03713000
UCBALTCU EQU   UCBFL5                                                   03714000
UCBNALOC EQU   UCBFL5                                                   03715000
UCBENVRD EQU   UCBFL5                                                   03716000
UCBVSDR  EQU   UCBFL5                                                   03717000
UCBSASK  EQU   UCBFL5                                                   03718000
UCBAMV   EQU   UCBAF                                                    03719000
UCBDCC   EQU   UCBFL5                                                   03720000
UCBMONT  EQU   UCBJBNR                                                  03721000
UCBRV011 EQU   UCBJBNR                                                  03722000
UCBRSV02 EQU   UCBJBNR                                                  03723000
UCBOLDSM EQU   UCBJBNR                                                  03724000
UCBRV003 EQU   UCBJBNR                                                  03725000
UCBRV002 EQU   UCBJBNR                                                  03726000
UCBJES3  EQU   UCBJBNR                                                  03727000
UCBVRDEV EQU   UCBJBNR                                                  03728000
UCBCMSEG EQU   UCBOB                                                    03729000
UCBPFXND EQU   UCB+512                                                  03730000
UCBIOQ   EQU   UCB+508                                                  03731000
UCBPXST  EQU   UCB+504                                                  03732000
@NM00033 EQU   UCB                                                      03733000
DCBEOB   EQU   IHADCS40+20                                              03734000
DCBPRECL EQU   IHADCS40+18                                              03735000
@NM00032 EQU   IHADCS40+16                                              03736000
@NM00031 EQU   @NM00029+1                                               03737000
@NM00030 EQU   DCBEROPT                                                 03738000
DCBERABE EQU   DCBEROPT                                                 03739000
DCBERSKP EQU   DCBEROPT                                                 03740000
DCBERACC EQU   DCBEROPT                                                 03741000
@NM00028 EQU   IHADCS40+10                                              03742000
@NM00027 EQU   IHADCS40+9                                               03743000
@NM00026 EQU   IHADCS40+8                                               03744000
DCBRECA  EQU   DCBRECAD+1                                               03745000
@NM00025 EQU   DCBRECBT                                                 03746000
DCBRCFGT EQU   DCBRCREL                                                 03747000
DCBRCTRU EQU   DCBRCREL                                                 03748000
DCBLCCW  EQU   DCBEOBAD                                                 03749000
DCBNOTE  EQU   DCBCNTRL                                                 03750000
DCBLRECL EQU   IHADCS38+10                                              03751000
@NM00024 EQU   IHADCS38+8                                               03752000
DCBEOBW  EQU   IHADCS38+4                                               03753000
DCBEOBRA EQU   DCBEOBR+1                                                03754000
DCBNCP   EQU   DCBEOBR                                                  03755000
@NM00023 EQU   DCBFLAG1                                                 03756000
DCBSTFLS EQU   DCBFLAG1                                                 03757000
DCBSTQCK EQU   DCBFLAG1                                                 03758000
DCBDIRCQ EQU   DCBBUFOF                                                 03759000
DCBQSTRU EQU   DCBUSASI                                                 03760000
@NM00022 EQU   DCBUSASI                                                 03761000
DCBQADF3 EQU   DCBQADFS                                                 03762000
DCBQADF2 EQU   DCBQADFS                                                 03763000
DCBQADF1 EQU   DCBQADFS                                                 03764000
DCBBLBP  EQU   DCBUSASI                                                 03765000
@NM00021 EQU   DCBUSASI                                                 03766000
DCBCICBA EQU   DCBCICB+1                                                03767000
@NM00020 EQU   DCBCICB                                                  03768000
DCBOFFSW EQU   IHADCS36+15                                              03769000
DCBOFFSR EQU   IHADCS36+14                                              03770000
DCBWCPL  EQU   IHADCS36+13                                              03771000
DCBWCPO  EQU   IHADCS36+12                                              03772000
DCBBLKSI EQU   IHADCS36+10                                              03773000
DCBCNQSM EQU   DCBCIND2                                                 03774000
DCBCNFEO EQU   DCBCIND2                                                 03775000
DCBCNCHS EQU   DCBCIND2                                                 03776000
DCBCNBFP EQU   DCBCIND2                                                 03777000
DCBCNIOE EQU   DCBCIND2                                                 03778000
DCBCNCLO EQU   DCBCIND2                                                 03779000
DCBCNWRO EQU   DCBCIND2                                                 03780000
DCBCNSTO EQU   DCBCIND2                                                 03781000
DCBCNEXB EQU   DCBCIND1                                                 03782000
@NM00019 EQU   DCBCIND1                                                 03783000
DCBCNBRM EQU   DCBCIND1                                                 03784000
@NM00018 EQU   DCBCIND1                                                 03785000
DCBCNEVA EQU   DCBCIND1                                                 03786000
DCBCNEVB EQU   DCBCIND1                                                 03787000
DCBCNSRD EQU   DCBCIND1                                                 03788000
DCBCNTOV EQU   DCBCIND1                                                 03789000
DCBSYNA  EQU   DCBSYNAD+1                                               03790000
DCBIOBL  EQU   DCBSYNAD                                                 03791000
DCBCHCKA EQU   DCBPERRA                                                 03792000
@NM00017 EQU   DCBOPTCD                                                 03793000
DCBOPTT  EQU   DCBOPTCD                                                 03794000
DCBSRCHD EQU   DCBOPTZ                                                  03795000
DCBOPTQ  EQU   DCBOPTCD                                                 03796000
DCBBCKPT EQU   DCBOPTO                                                  03797000
DCBOPTC  EQU   DCBOPTCD                                                 03798000
DCBOPTU  EQU   DCBOPTCD                                                 03799000
DCBOPTW  EQU   DCBOPTCD                                                 03800000
DCBPUTA  EQU   DCBGETA                                                  03801000
@NM00016 EQU   DCBPUT                                                   03802000
DCBREADA EQU   DCBWRITA                                                 03803000
@NM00015 EQU   DCBREAD                                                  03804000
DCBDEBA  EQU   DCBDEBAD+1                                               03805000
@NM00014 EQU   DCBIFLGS                                                 03806000
DCBIFIOE EQU   DCBIFLGS                                                 03807000
DCBIFPCT EQU   DCBIFLGS                                                 03808000
DCBMFSTI EQU   DCBMFDMD                                                 03809000
DCBMFAWR EQU   DCBMFSTK                                                 03810000
DCBMFUIP EQU   DCBMFTMD                                                 03811000
DCBMFIDW EQU   DCBMFLCP                                                 03812000
DCBMFWRK EQU   DCBMFMVP                                                 03813000
DCBMFRDQ EQU   DCBMFWRT                                                 03814000
DCBMFGTQ EQU   DCBMFPUT                                                 03815000
DCBMFSTL EQU   DCBMACF2                                                 03816000
DCBMFCK  EQU   DCBMFDMG                                                 03817000
DCBMFRDX EQU   DCBMFCHK                                                 03818000
DCBMFDBF EQU   DCBMFSBG                                                 03819000
DCBMFRDI EQU   DCBMFLCG                                                 03820000
DCBMFRDK EQU   DCBMFMVG                                                 03821000
DCBMFWRQ EQU   DCBMFRD                                                  03822000
DCBMFPTQ EQU   DCBMFGET                                                 03823000
DCBMFECP EQU   DCBMACF1                                                 03824000
DCBTIOT  EQU   IHADCS25                                                 03825000
DCBMRSTI EQU   DCBMRDMD                                                 03826000
DCBMRAWR EQU   DCBMRSTK                                                 03827000
DCBMRUIP EQU   DCBMRTMD                                                 03828000
DCBMRIDW EQU   DCBMRLCP                                                 03829000
DCBMRWRK EQU   DCBMRMVP                                                 03830000
DCBMRRDQ EQU   DCBMRWRT                                                 03831000
DCBMRGTQ EQU   DCBMRPUT                                                 03832000
DCBMRSTL EQU   DCBMACR2                                                 03833000
DCBMRCK  EQU   DCBMRDMG                                                 03834000
DCBPGFXA EQU   DCBMRRDX                                                 03835000
DCBMRDBF EQU   DCBMRSBG                                                 03836000
DCBMRRDI EQU   DCBMRLCG                                                 03837000
DCBMRRDK EQU   DCBMRMVG                                                 03838000
DCBMRWRQ EQU   DCBMRRD                                                  03839000
DCBMRPTQ EQU   DCBMRGET                                                 03840000
DCBMRECP EQU   DCBMACR1                                                 03841000
@NM00013 EQU   DCBIFLG                                                  03842000
DCBIBIOE EQU   DCBIFLG                                                  03843000
DCBIBPCT EQU   DCBIFLG                                                  03844000
DCBIBEC  EQU   DCBIFLG                                                  03845000
DCBOFIOF EQU   DCBOFLGS                                                 03846000
DCBOFUEX EQU   DCBOFLGS                                                 03847000
DCBOFTM  EQU   DCBOFLGS                                                 03848000
DCBOFPPC EQU   DCBOFLGS                                                 03849000
DCBOFOPN EQU   DCBOFLGS                                                 03850000
DCBOFEOV EQU   DCBOFLGS                                                 03851000
DCBOFLRB EQU   DCBOFLGS                                                 03852000
DCBOFIOD EQU   DCBOFLWR                                                 03853000
DCBDDNAM EQU   IHADCS24                                                 03854000
DCBEXLSA EQU   DCBEXLST+1                                               03855000
DCBRECKL EQU   DCBRECFM                                                 03856000
DCBRECCC EQU   DCBRECFM                                                 03857000
DCBRECSB EQU   DCBRECFM                                                 03858000
DCBRECBR EQU   DCBRECFM                                                 03859000
DCBRECTO EQU   DCBRECLA                                                 03860000
DCBRECL  EQU   DCBRECLA                                                 03861000
DCBEODA  EQU   DCBEODAD+1                                               03862000
DCBBFA   EQU   DCBBFTEK                                                 03863000
DCBH0    EQU   DCBBFTEK                                                 03864000
DCBBFTKD EQU   DCBBFTEK                                                 03865000
DCBBFTE  EQU   DCBBFT                                                   03866000
DCBBFTKR EQU   DCBBFT                                                   03867000
DCBBFTS  EQU   DCBBFT                                                   03868000
DCBH1    EQU   DCBBFTEK                                                 03869000
DCBSVCXA EQU   DCBSVCXL+1                                               03870000
@NM00012 EQU   DCBSVCXL                                                 03871000
DCBODEBA EQU   DCBIOBAA                                                 03872000
@NM00011 EQU   DCBQSLM                                                  03873000
DCBUPDBT EQU   DCBQSLM                                                  03874000
DCBUPDCM EQU   DCBQSLM                                                  03875000
DCB1DVDS EQU   DCBQSLM                                                  03876000
@NM00010 EQU   DCBDSRG2                                                 03877000
DCBDSGTR EQU   DCBDSRG2                                                 03878000
DCBACBM  EQU   DCBDSRG2                                                 03879000
@NM00009 EQU   DCBDSRG2                                                 03880000
DCBDSGTQ EQU   DCBDSRG2                                                 03881000
DCBDSGTX EQU   DCBDSRG2                                                 03882000
DCBDSGGS EQU   DCBDSRG2                                                 03883000
DCBDSGU  EQU   DCBDSRG1                                                 03884000
DCBDSGPO EQU   DCBDSRG1                                                 03885000
DCBDSGMQ EQU   DCBDSRG1                                                 03886000
DCBDSGCQ EQU   DCBDSRG1                                                 03887000
DCBDSGCX EQU   DCBDSRG1                                                 03888000
DCBDSGDA EQU   DCBDSRG1                                                 03889000
DCBDSGPS EQU   DCBDSRG1                                                 03890000
DCBDSGIS EQU   DCBDSRG1                                                 03891000
DCBBUFL  EQU   IHADCS11+8                                               03892000
DCBBUFCA EQU   DCBBUFCB+1                                               03893000
DCBBUFNO EQU   DCBBUFCB                                                 03894000
DCBDEVT  EQU   DCBREL                                                   03895000
DCBKEYLE EQU   DCBRELB                                                  03896000
DCBTRBAL EQU   IHADCS01+6                                               03897000
@NM00008 EQU   IHADCS01+5                                               03898000
@NM00007 EQU   IHADCS01+4                                               03899000
DCBDVTBA EQU   DCBDVTBL+1                                               03900000
@NM00006 EQU   DCBDVTBL                                                 03901000
DCBKEYCN EQU   IHADCS00+4                                               03902000
DCBRELAD EQU   IHADCS00                                                 03903000
@NM00005 EQU   IHADCB                                                   03904000
DEBXRV40 EQU   DEBXTN+28                                                03905000
DEBXRV39 EQU   DEBXTN+24                                                03906000
DEBXXARG EQU   DEBXTN+20                                                03907000
DEBXMCF2 EQU   DEBXTN+19                                                03908000
DEBXMCF1 EQU   DEBXTN+18                                                03909000
DEBXDSO2 EQU   DEBXTN+17                                                03910000
DEBXDSO1 EQU   DEBXTN+16                                                03911000
DEBXDBPR EQU   DEBXTN+12                                                03912000
DEBXDCBM EQU   DEBXTN+8                                                 03913000
DEBXDSAB EQU   DEBXTN+4                                                 03914000
DEBXRV48 EQU   DEBXTN+3                                                 03915000
DEBXRV47 EQU   DEBXFLG1                                                 03916000
DEBXRV46 EQU   DEBXFLG1                                                 03917000
DEBXRV45 EQU   DEBXFLG1                                                 03918000
DEBXRV44 EQU   DEBXFLG1                                                 03919000
DEBXRV43 EQU   DEBXFLG1                                                 03920000
DEBXRV42 EQU   DEBXFLG1                                                 03921000
DEBXTSKC EQU   DEBXFLG1                                                 03922000
DEBXCDCB EQU   DEBXFLG1                                                 03923000
DEBXLNGH EQU   DEBXTN                                                   03924000
DEBTBLOF EQU   DEBPREFX+14                                              03925000
DEBAMTYP EQU   DEBPREFX+13                                              03926000
DEBLNGTH EQU   DEBPREFX+12                                              03927000
DEBDCBMK EQU   DEBXTNP                                                  03928000
DEBDSCBA EQU   DEBPREFX+1                                               03929000
DEBWKARA EQU   DEBPREFX                                                 03930000
DEBXCEAD EQU   DEBXCEA+1                                                03931000
DEBXCENP EQU   DEBXCEAB                                                 03932000
DEBRSV35 EQU   DEBXCEAB                                                 03933000
DEBRSV34 EQU   DEBXCEAB                                                 03934000
DEBRSV33 EQU   DEBXCEAB                                                 03935000
DEBRSV32 EQU   DEBXCEAB                                                 03936000
DEBCEAD  EQU   DEBCEA+1                                                 03937000
DEBCENP  EQU   DEBCEAB                                                  03938000
DEBRSV31 EQU   DEBCEAB                                                  03939000
DEBRSV30 EQU   DEBCEAB                                                  03940000
DEBRSV29 EQU   DEBCEAB                                                  03941000
DEBRSV28 EQU   DEBCEAB                                                  03942000
DEBPCIAD EQU   DEBPCIA+1                                                03943000
DEBPCINP EQU   DEBPCIAB                                                 03944000
DEBRSV27 EQU   DEBPCIAB                                                 03945000
DEBRSV26 EQU   DEBPCIAB                                                 03946000
DEBRSV25 EQU   DEBPCIAB                                                 03947000
DEBRSV24 EQU   DEBPCIAB                                                 03948000
DEBSIOAD EQU   DEBSIOA+1                                                03949000
DEBSIONP EQU   DEBSIOAB                                                 03950000
DEBFIX   EQU   DEBSIOAB                                                 03951000
DEBIOVR  EQU   DEBSIOAB                                                 03952000
DEBSIOX  EQU   DEBSIOAB                                                 03953000
DEBPGFX  EQU   DEBSIOAB                                                 03954000
DEBEOEAD EQU   DEBEOEA+1                                                03955000
DEBEOENP EQU   DEBEOEAB                                                 03956000
DEBRSV22 EQU   DEBEOEAB                                                 03957000
DEBRSV21 EQU   DEBEOEAB                                                 03958000
DEBRSV20 EQU   DEBEOEAB                                                 03959000
DEBRSV19 EQU   DEBEOEAB                                                 03960000
DEBSUBID EQU   DEBSUBNM                                                 03961000
DEBSIOA2 EQU   DEBACS08+24                                              03962000
DEBRPSIO EQU   DEBACS08+20                                              03963000
DEBFREED EQU   DEBACS08+16                                              03964000
@NM00004 EQU   DEBACS08+12                                              03965000
@NM00003 EQU   DEBACS08+8                                               03966000
DEBDISAD EQU   DEBACS08+4                                               03967000
@NM00002 EQU   DEBACS08                                                 03968000
DEBRPSST EQU   DEBACS07+64                                              03969000
DEBARECK EQU   DEBACS07+60                                              03970000
DEBAREWT EQU   DEBACS07+56                                              03971000
DEBACHK  EQU   DEBACS07+52                                              03972000
DEBAWRIT EQU   DEBACS07+48                                              03973000
DEBASETL EQU   DEBACS07+44                                              03974000
DEBAREAD EQU   DEBACS07+40                                              03975000
DEBCRECK EQU   DEBACS07+36                                              03976000
DEBCREWT EQU   DEBACS07+32                                              03977000
DEBCCHK  EQU   DEBACS07+28                                              03978000
DEBCWRIT EQU   DEBACS07+24                                              03979000
DEBCSETL EQU   DEBACS07+20                                              03980000
DEBCREAD EQU   DEBACS07+16                                              03981000
DEBWKPT5 EQU   DEBACS07+12                                              03982000
DEBWKPT4 EQU   DEBACS07+8                                               03983000
DEBGET   EQU   DEBACS07+4                                               03984000
@NM00001 EQU   DEBACS07                                                 03985000
DEBPUT   EQU   DEBACS06+4                                               03986000
DEBDCBFA EQU   DEBACS06                                                 03987000
DEBLUCBB EQU   DEBLUCBA+1                                               03988000
DEBRSV18 EQU   DEBLUCBA                                                 03989000
DEBFUCBB EQU   DEBFUCBA+1                                               03990000
DEBRSV17 EQU   DEBFUCBA                                                 03991000
DEBTCCWB EQU   DEBTCCWA+1                                               03992000
DEBRSV16 EQU   DEBTCCWA                                                 03993000
DEBTBFRB EQU   DEBTBFRA+1                                               03994000
DEBRSV15 EQU   DEBTBFRA                                                 03995000
DEBDBPEF EQU   DEBACS03+8                                               03996000
DEBDBPP  EQU   DEBACS03+4                                               03997000
DEBDTPP  EQU   DEBACS03                                                 03998000
DEBDBPE  EQU   DEBDBLK+1                                                03999000
DEBDBPT  EQU   DEBDBLK                                                  04000000
DEBEXTNM EQU   DEBDSNAM                                                 04001000
DEBRSV14 EQU   DEBDSNM+4                                                04002000
DEBUTSAB EQU   DEBUTSAA+1                                               04003000
DEBRSV13 EQU   DEBUTSAA                                                 04004000
DEBVOLNM EQU   DEBACSMD+2                                               04005000
DEBVLSEQ EQU   DEBVOLSQ+1                                               04006000
DEBRSV42 EQU   DEBVOLBT                                                 04007000
DEBRSV41 EQU   DEBVOLBT                                                 04008000
DEBRSV40 EQU   DEBVOLBT                                                 04009000
DEBRSV39 EQU   DEBVOLBT                                                 04010000
DEBRSV38 EQU   DEBVOLBT                                                 04011000
DEBRSV37 EQU   DEBVOLBT                                                 04012000
DEBRSV36 EQU   DEBVOLBT                                                 04013000
DEBEXFUL EQU   DEBVOLBT                                                 04014000
DEBNMTRK EQU   DEBDASD+14                                               04015000
DEBENDHH EQU   DEBDASD+12                                               04016000
DEBENDCC EQU   DEBDASD+10                                               04017000
DEBSTRHH EQU   DEBDASD+8                                                04018000
DEBSTRCC EQU   DEBDASD+6                                                04019000
DEBBINUM EQU   DEBDASD+4                                                04020000
DEBUCBA  EQU   DEBUCBAD+1                                               04021000
DEBDVMOD EQU   DEBUCBAD                                                 04022000
DEBAPPB  EQU   DEBAPPAD+1                                               04023000
DEBEXSCL EQU   DEBAPPAD                                                 04024000
DEBDCBB  EQU   DEBDCBAD+1                                               04025000
DEBDEBID EQU   DEBPROTG                                                 04026000
DEBECBB  EQU   DEBECBAD+1                                               04027000
DEBPRIOR EQU   DEBECBAD                                                 04028000
DEBUSRPB EQU   DEBUSRPG+1                                               04029000
DEBNMEXT EQU   DEBUSRPG                                                 04030000
DEBRSV05 EQU   DEBBASIC+15                                              04031000
DEBXTNIN EQU   DEBFLGS1                                                 04032000
DEBAPFIN EQU   DEBFLGS1                                                 04033000
DEBF1CEV EQU   DEBFLGS1                                                 04034000
DEBCINDI EQU   DEBFLGS1                                                 04035000
DEBRSV02 EQU   DEBFLGS1                                                 04036000
DEBRSIOA EQU   DEBFLGS1                                                 04037000
DEBEOFDF EQU   DEBFLGS1                                                 04038000
DEBPWCKD EQU   DEBFLGS1                                                 04039000
DEBQSCNT EQU   DEBBASIC+13                                              04040000
DEBACCS  EQU   DEBOPATB                                                 04041000
DEBPOSIT EQU   DEBOPATB                                                 04042000
DEBZERO  EQU   DEBOPATB                                                 04043000
DEBABEND EQU   DEBOPATB                                                 04044000
DEBIRBB  EQU   DEBIRBAD+1                                               04045000
DEBRERR  EQU   DEBOFLGS                                                 04046000
DEBLABEL EQU   DEBOFLGS                                                 04047000
DEBSPLIT EQU   DEBOFLGS                                                 04048000
DEBDCB   EQU   DEBOFLGS                                                 04049000
DEBRLSE  EQU   DEBOFLGS                                                 04050000
DEBEOF   EQU   DEBOFLGS                                                 04051000
DEBDISP  EQU   DEBOFLGS                                                 04052000
DEBDEBB  EQU   DEBDEBAD+1                                               04053000
DEBAMLNG EQU   DEBDEBAD                                                 04054000
DEBTCBB  EQU   DEBTCBAD+1                                               04055000
DEBNMSUB EQU   DEBTCBAD                                                 04056000
IOBERRCT EQU   IOBSTDRD+30                                              04057000
IOBRSV19 EQU   IOBINCAM+1                                               04058000
IOBOLTST EQU   IOBBTAMF                                                 04059000
IOBRFTMG EQU   IOBBTAMF                                                 04060000
IOBRSV17 EQU   IOBBTAMF                                                 04061000
IOBRSV16 EQU   IOBBTAMF                                                 04062000
IOBRSV15 EQU   IOBBTAMF                                                 04063000
IOBRSV14 EQU   IOBBTAMF                                                 04064000
IOBINUSE EQU   IOBBTAMF                                                 04065000
IOBPRMER EQU   IOBBTAMF                                                 04066000
IOBRSTRB EQU   IOBRESTR+1                                               04067000
IOBREPOS EQU   IOBRESTR                                                 04068000
IOBDCBPB EQU   IOBDCBPT+1                                               04069000
IOBRSV44 EQU   IOBFLAG4                                                 04070000
IOBJES3I EQU   IOBFLAG4                                                 04071000
IOBRSV42 EQU   IOBFLAG4                                                 04072000
IOBRSV41 EQU   IOBFLAG4                                                 04073000
IOBRSV40 EQU   IOBFLAG4                                                 04074000
IOBPMERR EQU   IOBFLAG4                                                 04075000
IOBCC3WE EQU   IOBFLAG4                                                 04076000
IOBGDPOL EQU   IOBFLAG4                                                 04077000
IOBSIOCC EQU   IOBSTART                                                 04078000
IOBSTBYT EQU   IOBIOCSW+3                                               04079000
IOBCMDA  EQU   IOBIOCSW                                                 04080000
IOBLOG   EQU   IOBFL3                                                   04081000
IOBICL   EQU   IOBFL3                                                   04082000
IOBMSG   EQU   IOBFL3                                                   04083000
IOBCNC   EQU   IOBFL3                                                   04084000
IOBACU   EQU   IOBFL3                                                   04085000
IOBCDC   EQU   IOBFL3                                                   04086000
IOBICC   EQU   IOBFL3                                                   04087000
IOBCCC   EQU   IOBFL3                                                   04088000
IOBECBPB EQU   IOBECBPT+1                                               04089000
IOBECBCC EQU   IOBECBPT                                                 04090000
IOBS1B7  EQU   IOBSENS1                                                 04091000
IOBS1B6  EQU   IOBSENS1                                                 04092000
IOBS1B5  EQU   IOBSENS1                                                 04093000
IOBS1B4  EQU   IOBSENS1                                                 04094000
IOBS1B3  EQU   IOBSENS1                                                 04095000
IOBS1B2  EQU   IOBSENS1                                                 04096000
IOBS1B1  EQU   IOBSENS1                                                 04097000
IOBS1B0  EQU   IOBSENS1                                                 04098000
IOBSNSC9 EQU   IOBS0B7                                                  04099000
IOBS0B6  EQU   IOBSENS0                                                 04100000
IOBS0B5  EQU   IOBSENS0                                                 04101000
IOBS0B4  EQU   IOBSENS0                                                 04102000
IOBS0B3  EQU   IOBSENS0                                                 04103000
IOBS0B2  EQU   IOBSENS0                                                 04104000
IOBS0B1  EQU   IOBSENS0                                                 04105000
IOBS0B0  EQU   IOBSENS0                                                 04106000
IOBPNCH  EQU   IOBFLAG2                                                 04107000
IOBSTATO EQU   IOBFLAG2                                                 04108000
IOBSKUPD EQU   IOBFLAG2                                                 04109000
IOBALTTR EQU   IOBFLAG2                                                 04110000
IOBRRT2  EQU   IOBRDHA0                                                 04111000
IOBRRT3  EQU   IOBPURGE                                                 04112000
IOBSENSE EQU   IOBFLAG2                                                 04113000
IOBHALT  EQU   IOBFLAG2                                                 04114000
IOBSPSVC EQU   IOBRSTRT                                                 04115000
IOBUNREL EQU   IOBFLAG1                                                 04116000
IOBIOERR EQU   IOBFLAG1                                                 04117000
IOBFCREX EQU   IOBCYCCK                                                 04118000
IOBRPSTN EQU   IOBFLAG1                                                 04119000
IOBERRTN EQU   IOBFLAG1                                                 04120000
IOBCMDCH EQU   IOBFLAG1                                                 04121000
IOBDATCH EQU   IOBFLAG1                                                 04122000
IOBCNOPA EQU   IOBPREFX+12                                              04123000
IOBCICB  EQU   IOBPREFX+8                                               04124000
IOBCECB  EQU   IOBPREFX+4                                               04125000
IOBCONOP EQU   IOBPREFX+3                                               04126000
IOBCINOP EQU   IOBPREFX+2                                               04127000
IOBRSV05 EQU   IOBPREFX+1                                               04128000
IOBPCI   EQU   IOBCFLG1                                                 04129000
IOBRSTCH EQU   IOBCFLG1                                                 04130000
IOBABAPP EQU   IOBCFLG1                                                 04131000
IOBPTST  EQU   IOBCFLG1                                                 04132000
IOBRSV04 EQU   IOBCFLG1                                                 04133000
IOBRSV03 EQU   IOBCFLG1                                                 04134000
IOBRSV02 EQU   IOBCFLG1                                                 04135000
IOBRSV01 EQU   IOBCFLG1                                                 04136000
@NM00060 EQU   PSA+3668                                                 04137000
PSASTAK  EQU   PSA+3072                                                 04138000
@NM00059 EQU   PSA+1040                                                 04139000
PSAUSEND EQU   PSA+1040                                                 04140000
PSARV062 EQU   PSA+1036                                                 04141000
PSAATCVT EQU   PSA+1032                                                 04142000
PSAPCPSW EQU   PSA+1024                                                 04143000
PSAPIR2  EQU   PSA+1020                                                 04144000
PSARV059 EQU   PSA+1018                                                 04145000
PSASVC13 EQU   PSA+1016                                                 04146000
PSALSFCC EQU   PSA+1012                                                 04147000
PSASFACC EQU   PSA+1008                                                 04148000
PSASTOP  EQU   PSA+992                                                  04149000
PSASTART EQU   PSA+976                                                  04150000
PSARSPSW EQU   PSA+968                                                  04151000
PSASRPSW EQU   PSA+960                                                  04152000
PSARV045 EQU   PSA+892                                                  04153000
PSARV044 EQU   PSA+888                                                  04154000
PSARV043 EQU   PSA+884                                                  04155000
PSARV042 EQU   PSA+880                                                  04156000
PSARV041 EQU   PSA+876                                                  04157000
PSARV040 EQU   PSA+872                                                  04158000
PSARV025 EQU   PSA+868                                                  04159000
PSADSSED EQU   PSA+868                                                  04160000
PSADSSPR EQU   PSA+864                                                  04161000
PSADSSFW EQU   PSA+860                                                  04162000
PSADSS14 EQU   PSA+856                                                  04163000
PSADSSPP EQU   PSA+848                                                  04164000
PSADSSRP EQU   PSA+840                                                  04165000
PSADSS05 EQU   PSADSSF4                                                 04166000
PSADSS10 EQU   PSADSSF4                                                 04167000
PSADSSVE EQU   PSADSSF4                                                 04168000
PSADSSDE EQU   PSADSSF4                                                 04169000
PSADSSC0 EQU   PSADSSF4                                                 04170000
PSADSSIE EQU   PSADSSF4                                                 04171000
PSADSS12 EQU   PSADSSF4                                                 04172000
PSADSSRC EQU   PSADSSF4                                                 04173000
PSARV057 EQU   PSADSSF3                                                 04174000
PSARV056 EQU   PSADSSF3                                                 04175000
PSARV055 EQU   PSADSSF3                                                 04176000
PSADSSMC EQU   PSADSSF3                                                 04177000
PSADSSRW EQU   PSADSSF3                                                 04178000
PSADSSNM EQU   PSADSSF3                                                 04179000
PSADSSES EQU   PSADSSF3                                                 04180000
PSADSSGP EQU   PSADSSF3                                                 04181000
PSADSSF2 EQU   PSADSSFL+1                                               04182000
PSADSSPI EQU   PSADSSF1                                                 04183000
PSADSSOI EQU   PSADSSF1                                                 04184000
PSADSSSP EQU   PSADSSF1                                                 04185000
PSADSSTP EQU   PSADSSF1                                                 04186000
PSADSSDW EQU   PSADSSF1                                                 04187000
PSADSSDD EQU   PSADSSF1                                                 04188000
PSADSSDM EQU   PSADSSF1                                                 04189000
PSADSSMV EQU   PSADSSF1                                                 04190000
PSADSSTS EQU   PSA+816                                                  04191000
PSADSSWK EQU   PSA+812                                                  04192000
PSADSSR3 EQU   PSA+808                                                  04193000
PSADSSR2 EQU   PSA+804                                                  04194000
PSADSSRS EQU   PSA+800                                                  04195000
PSASTOR  EQU   PSA+796                                                  04196000
PSACPUSA EQU   PSA+794                                                  04197000
PSAVSTAP EQU   PSA+792                                                  04198000
PSAWKVAP EQU   PSA+788                                                  04199000
PSAWKRAP EQU   PSA+784                                                  04200000
PSAMCHIC EQU   PSA+783                                                  04201000
PSARV061 EQU   PSA+782                                                  04202000
PSASYMSK EQU   PSA+781                                                  04203000
PSAMCHFL EQU   PSA+780                                                  04204000
PSACR0   EQU   PSA+776                                                  04205000
PSAPSWSV EQU   PSA+768                                                  04206000
PSALITA  EQU   PSA+764                                                  04207000
PSACLHS  EQU   PSAHLHI                                                  04208000
PSALKR15 EQU   PSALKSA+60                                               04209000
PSALKR14 EQU   PSALKSA+56                                               04210000
PSALKR13 EQU   PSALKSA+52                                               04211000
PSALKR12 EQU   PSALKSA+48                                               04212000
PSALKR11 EQU   PSALKSA+44                                               04213000
PSALKR10 EQU   PSALKSA+40                                               04214000
PSALKR9  EQU   PSALKSA+36                                               04215000
PSALKR8  EQU   PSALKSA+32                                               04216000
PSALKR7  EQU   PSALKSA+28                                               04217000
PSALKR6  EQU   PSALKSA+24                                               04218000
PSALKR5  EQU   PSALKSA+20                                               04219000
PSALKR4  EQU   PSALKSA+16                                               04220000
PSALKR3  EQU   PSALKSA+12                                               04221000
PSALKR2  EQU   PSALKSA+8                                                04222000
PSALKR1  EQU   PSALKSA+4                                                04223000
PSALKR0  EQU   PSALKSA                                                  04224000
PSARV023 EQU   PSACLHT+52                                               04225000
PSALOCAL EQU   PSACLHT+48                                               04226000
PSACMSL  EQU   PSACLHT+44                                               04227000
PSAOPTL  EQU   PSACLHT+40                                               04228000
PSATPACL EQU   PSACLHT+36                                               04229000
PSATPDNL EQU   PSACLHT+32                                               04230000
PSATPNCL EQU   PSACLHT+28                                               04231000
PSAIOSLL EQU   PSACLHT+24                                               04232000
PSAIOSUL EQU   PSACLHT+20                                               04233000
PSAIOSCL EQU   PSACLHT+16                                               04234000
PSAIOSSL EQU   PSACLHT+12                                               04235000
PSASALCL EQU   PSACLHT+8                                                04236000
PSAASML  EQU   PSACLHT+4                                                04237000
PSADISPL EQU   PSACLHT                                                  04238000
PSASRSA  EQU   PSA+636                                                  04239000
PSARV050 EQU   PSA+634                                                  04240000
PSADSSGO EQU   PSA+633                                                  04241000
PSARECUR EQU   PSA+632                                                  04242000
PSAHLHIS EQU   PSA+628                                                  04243000
PSAIPCSA EQU   PSA+624                                                  04244000
@NM00058 EQU   PSA+621                                                  04245000
PSAIPCDM EQU   PSA+620                                                  04246000
PSAIPCD  EQU   PSA+616                                                  04247000
@NM00057 EQU   PSA+613                                                  04248000
PSAIPCRM EQU   PSA+612                                                  04249000
PSAIPCR  EQU   PSA+608                                                  04250000
PSAMCHEX EQU   PSA+600                                                  04251000
PSAMPSW  EQU   PSA+592                                                  04252000
PSAEXPS2 EQU   PSA+584                                                  04253000
PSAEXPS1 EQU   PSA+576                                                  04254000
PSAPIREG EQU   PSA+572                                                  04255000
PSARSREG EQU   PSA+568                                                  04256000
PSAGPREG EQU   PSA+556                                                  04257000
PSARV022 EQU   PSASUP4                                                  04258000
PSARV021 EQU   PSASUP4                                                  04259000
PSARV020 EQU   PSASUP4                                                  04260000
PSARV019 EQU   PSASUP4                                                  04261000
PSARV018 EQU   PSASUP4                                                  04262000
PSARV017 EQU   PSASUP4                                                  04263000
PSARV016 EQU   PSASUP4                                                  04264000
PSARV015 EQU   PSASUP4                                                  04265000
PSARV014 EQU   PSASUP3                                                  04266000
PSARV013 EQU   PSASUP3                                                  04267000
PSARV012 EQU   PSASUP3                                                  04268000
PSARV011 EQU   PSASUP3                                                  04269000
PSARV010 EQU   PSASUP3                                                  04270000
PSAPSREG EQU   PSASUP3                                                  04271000
PSAPI2   EQU   PSASUP3                                                  04272000
PSAIOSUP EQU   PSASUP3                                                  04273000
PSALCR   EQU   PSASUP2                                                  04274000
PSARTM   EQU   PSASUP2                                                  04275000
PSAACR   EQU   PSASUP2                                                  04276000
PSAIPCE2 EQU   PSASUP2                                                  04277000
PSAIPCES EQU   PSASUP2                                                  04278000
PSAIPCEC EQU   PSASUP2                                                  04279000
PSAGTF   EQU   PSASUP2                                                  04280000
PSAIPCRI EQU   PSASUP2                                                  04281000
PSAIPCRP EQU   PSASUP1                                                  04282000
PSAIPCDR EQU   PSASUP1                                                  04283000
PSADISP  EQU   PSASUP1                                                  04284000
PSALOCK  EQU   PSASUP1                                                  04285000
PSAPI    EQU   PSASUP1                                                  04286000
PSAEXT   EQU   PSASUP1                                                  04287000
PSASVC   EQU   PSASUP1                                                  04288000
PSAIO    EQU   PSASUP1                                                  04289000
PSAAOLD  EQU   PSA+548                                                  04290000
PSAANEW  EQU   PSA+544                                                  04291000
PSATOLD  EQU   PSA+540                                                  04292000
PSATNEW  EQU   PSA+536                                                  04293000
PSALCCAR EQU   PSA+532                                                  04294000
PSALCCAV EQU   PSA+528                                                  04295000
PSAPCCAR EQU   PSA+524                                                  04296000
PSAPCCAV EQU   PSA+520                                                  04297000
PSACPULA EQU   PSA+518                                                  04298000
PSACPUPA EQU   PSA+516                                                  04299000
PSAPSA   EQU   PSA+512                                                  04300000
FLCHDEND EQU   PSA+512                                                  04301000
FLCCRSAV EQU   FLCMCLA+280                                              04302000
FLCGRSAV EQU   FLCMCLA+216                                              04303000
FLCFPSAV EQU   FLCMCLA+184                                              04304000
FLCFLA   EQU   FLCMCLA+88                                               04305000
FLCRGNCD EQU   FLCMCLA+84                                               04306000
FLCFSAA  EQU   FLCFSA+1                                                 04307000
@NM00056 EQU   FLCFSA                                                   04308000
@NM00055 EQU   FLCMCLA+72                                               04309000
FLCMCIC  EQU   FLCMCLA+64                                               04310000
@NM00054 EQU   FLCMCLA+20                                               04311000
FLCIOAA  EQU   FLCIOA+1                                                 04312000
@NM00053 EQU   FLCIOA                                                   04313000
@NM00052 EQU   FLCMCLA+15                                               04314000
@NM00051 EQU   FLCMCLA+14                                               04315000
@NM00050 EQU   FLCMCLA+12                                               04316000
FLCLCL   EQU   FLCMCLA+8                                                04317000
FLCIOELA EQU   FLCIOEL+1                                                04318000
@NM00049 EQU   FLCIOEL                                                  04319000
FLCCHNID EQU   FLCMCLA                                                  04320000
@NM00048 EQU   PSA+160                                                  04321000
FLCMTRCD EQU   PSA+157                                                  04322000
@NM00047 EQU   PSA+156                                                  04323000
FLCPERA  EQU   FLCPER+1                                                 04324000
@NM00046 EQU   FLCPER                                                   04325000
@NM00045 EQU   PSA+151                                                  04326000
FLCPERCD EQU   PSA+150                                                  04327000
FLCMCNUM EQU   PSA+149                                                  04328000
@NM00044 EQU   PSA+148                                                  04329000
FLCTEAA  EQU   FLCTEA+1                                                 04330000
@NM00043 EQU   FLCTEA                                                   04331000
PSAPIPC  EQU   PSAPICOD                                                 04332000
PSAPIMC  EQU   PSAPICOD                                                 04333000
PSAPIPER EQU   PSAPICOD                                                 04334000
PSARV049 EQU   FLCPICOD                                                 04335000
FLCPILCB EQU   FLCPIILC                                                 04336000
@NM00042 EQU   FLCPIILC                                                 04337000
@NM00041 EQU   PSAEPPSW                                                 04338000
FLCSVCN  EQU   PSAESPSW+2                                               04339000
FLCSILCB EQU   FLCSVILC                                                 04340000
@NM00040 EQU   FLCSVILC                                                 04341000
@NM00039 EQU   PSAESPSW                                                 04342000
FLCEICOD EQU   PSAEEPSW+2                                               04343000
PSASPAD  EQU   PSAEEPSW                                                 04344000
@NM00038 EQU   PSA+128                                                  04345000
FLCINPSW EQU   PSA+120                                                  04346000
FLCMNPSW EQU   PSA+112                                                  04347000
FLCPNPSW EQU   PSA+104                                                  04348000
FLCSNPSW EQU   PSA+96                                                   04349000
FLCENPSW EQU   PSA+88                                                   04350000
FLCTRACE EQU   PSA+84                                                   04351000
FLCTIMER EQU   PSA+80                                                   04352000
FLCCVT2  EQU   PSA+76                                                   04353000
FLCCAW   EQU   PSA+72                                                   04354000
FLCCSW   EQU   PSA+64                                                   04355000
FLCIOPSW EQU   PSA+56                                                   04356000
FLCMOPSW EQU   PSA+48                                                   04357000
FLCPOPSW EQU   PSA+40                                                   04358000
FLCSOPSW EQU   PSA+32                                                   04359000
FLCEOPSW EQU   PSA+24                                                   04360000
@NM00037 EQU   FLCICCW2+4                                               04361000
FLCCVT   EQU   FLCICCW2                                                 04362000
FLCICCW1 EQU   FLCROPSW                                                 04363000
FLCIPPSW EQU   FLCRNPSW                                                 04364000
*                                      END UNREFERENCED COMPONENTS      04365000
@RC00193 EQU   @EL00002                                                 04366000
@RF00237 EQU   @RC00234                                                 04367000
@RC00251 EQU   @RC00246                                                 04368000
@RC00249 EQU   @RC00246                                                 04369000
@RF00257 EQU   @EL00004                                                 04370000
@RF00279 EQU   @EL00005                                                 04371000
@RC00282 EQU   @EL00005                                                 04372000
@RC00372 EQU   @RC00332                                                 04373000
@RF00291 EQU   @EL00006                                                 04374000
@RC00430 EQU   @RC00429                                                 04375000
@RC00445 EQU   @EL00008                                                 04376000
@RF00460 EQU   @EL00008                                                 04377000
@RF00523 EQU   @RC00498                                                 04378000
@RC00508 EQU   @RC00498                                                 04379000
@RC00540 EQU   @EL00009                                                 04380000
@RF00577 EQU   @EL00010                                                 04381000
@RC00596 EQU   @EL00011                                                 04382000
@RF00722 EQU   @EL00015                                                 04383000
@PB00015 EQU   @EL00001                                                 04384000
@RC00446 EQU   @RC00445                                                 04385000
@RF00520 EQU   @RC00508                                                 04386000
@PB00014 EQU   @PB00015                                                 04387000
@PB00013 EQU   @PB00014                                                 04388000
@PB00012 EQU   @PB00013                                                 04389000
@PB00011 EQU   @PB00012                                                 04390000
@PB00010 EQU   @PB00011                                                 04391000
@PB00009 EQU   @PB00010                                                 04392000
@PB00008 EQU   @PB00009                                                 04393000
@PB00007 EQU   @PB00008                                                 04394000
@PB00006 EQU   @PB00007                                                 04395000
@PB00005 EQU   @PB00006                                                 04396000
@PB00004 EQU   @PB00005                                                 04397000
@PB00003 EQU   @PB00004                                                 04398000
@PB00002 EQU   @PB00003                                                 04399000
CE0001@  EQU   @PB00002                                                 04400000
@RF00145 EQU   CE0001@                                                  04401000
@RF00155 EQU   CE0001@                                                  04402000
@ENDDATA EQU   *                                                        04403000
         END   IOESDKTO,(C'PLS1312',0701,77320)                         04404000
