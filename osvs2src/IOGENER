         MACRO                                                          00100020
&NAME    IOGENER  &GEN=                                                 00101022
* ****************** MICROFICHE FLAGS *********************** SUPT CODE 00101100
* A079500-081500                                                 S22027 00101200
* A269510-269560,274050-274450,298975-298995,356570-356920       S99228 00101300
* A363070-363420,443210-443280,656050-656400,749600-749900       S99228 00101400
* A788000-790000,786840-796960,823600-823700,902330-902450,907700S99228 00101500
* A175200,322560,322680-322920,810000-812800                     S22029 00101600
* C165800-165850,272000-272300                                   S99228 00101700
* D162000                                                        S99228 00101800
* A175200,322560,322680-322860,808560,808680-808860              S22029 00101900
* C172000-173000                                                 S22029 00102000
* D176000                                                        S22029 00102300
* A272430-273034,653946-653994,744502-744512,                    S22028 00102600
* A901020-901160,907600,933800                                   S22028 00102900
* C273035-273036,648500                                          S22028 00103200
* D298512,298520-298929                                          S22028 00103500
* A259920                                                        A44890 00103800
* C061500,259530                                                 A44890 00104100
* A759000                                                         M1582 00104400
* C061500                                                         M1582 00104700
* A818000                                                         M6293 00105000
* C061500,805700-809000                                           M6293 00105300
* A165700,219200,378500,385500,402500,450700                     S21101 00105600
* C061500,194500-197500                                          S21101 00105900
* D157500,404000                                                 S21101 00106200
* A161500                                                         M5953 00106500
* C061500                                                         M5953 00106800
* C061500,086500                                                 A41024 00107100
* A073500,096200,100500-101000,105500-106500,444000,921500       A41027 00107400
* C061500,082500,084200,085500,091000,095000,097500,099000,      A41027 00107700
* D076000,079500-081500,107000                                   A41027 00108000
* A875000,876500,934500                                          A50191 00108300
* A280700,286000,290500,460500,744980,460640,460850              A48245 00108600
* C280700,727700                                                 A48245 00108900
* D459700,779700,585700                                          A48245 00109200
* C061500,106500-106600                                          A48273 00109500
* A442001-442005,473520-473900,934550                            A48276 00109800
* D460570-460920                                                 S22026 00110100
* A092080-092400,095540-095660,143520-143880,469550-469950       S22026 00110400
* A623060-623420,907580-907900,934200,949200                     S22026 00110700
* A312900,764500                                                 S22025 00111000
* C311500,767500,769500                                          S22025 00111300
* C061500                                                        S22025 00111600
* D460500,465200,460570-460640,460850                            S22025 00111900
* A341500                                                       SA56889 00112200
* A402915                                                       SA53632 00112500
* A205500,207000                                                SA55383 00112800
* A106700                                                       SA53628 00113100
* A356500,382500                                                SA55925 00113400
* C390500                                                       SA55925 00113700
* A026000,035000,491500,919500                                  SA57685 00114000
* C872500,937500,001999                                         SA57685 00114300
* D001500-001998                                                SA57685 00114600
* C005500-006500,934550                                         SA59501 00114900
* C347000,350000                                                SA60341 00115200
* A312920                                                       SA59034 00115500
* C219420,253500-254000                                         SA59034 00115800
* A201700,202500,859500                                         SA61781 00116100
* D341600-341700                                                SA62991 00116400
* D921600                                                        X01004 00116700
* C025500,106940                                                 X01004 00117000
* A322500,383000,810800                                          X02004 00117300
* C322500,322830,323000                                          X02004 00117600
* D811000-812600                                                 X02004 00117900
* A126000,947760                                                OY00451 00118200
* C269000-273023                                                SA68050 00118500
* A901080,933800,938420,947460                                  SA68050 00120000
* A470500                                                       SA69087 00121000
* D072500,152000,156500,184000,190000,198500,242000,272360       S21903 00122000
* D298995,340500,383200,447500,498000,776000,817200,854000       S21903 00123000
* D904000,923000,925000,926500,927000,927700,930000,938500       S21903 00124000
* D943440,943580-943620                                          S21903 00125000
* A269900                                                      @YA03846 00126000
* C165800,269580,298975,356530,363070,442001,443205,473520     @YA03846 00127000
* C848530,947580                                               @YA03846 00128000
* D269200,271500,274050                                        @YA03846 00129000
* A813500                                                      @SA64363 00130000
*A356640,379500                                                @SA69649 00131000
*C352000                                                       @SA69649 00132000
*D352000-356500,394000                                         @SA69649 00133000
*A272500                                                       @SA71925 00134000
*C900000-901040,901060-901085                                  @SA71925 00135000
*A140700                                                       @YA05148 00136000
*C272120-272450                                                @SA73356 00137000
*A787000,789300                                                @SA62375 00138000
*D787900,848530                                                @SA62375 00139000
*A350180,364000                                                @SA72446 00140000
*D813600,813700                                                @SA74549 00141000
.*A099500,D379700                                              @SA74956 00142000
*D925300                                                       @YA10024 00143000
*A157000,A934700                                               @ZA04039 00144000
*D272020-272040                                                @YA05471 00145000
*C936020                                                       @YA10455 00146000
*C938480,938640                                                @YA10429 00147000
.*C876620,C876650,C876670,C876690,A876820                      @YA11011 00148000
.*A372000,927500,930500                                         X30X5MT 00149000
*A372150                                                       @OY12260 00150000
*A255500                                                       @OY12393 00151000
*C875984,A876600                                               @SA76687 00152000
*C473880                                                       @SA76694 00153000
*A379266                                                       @OY12395 00154000
*A282000,940660                                                @XA08073 00155000
*A106988,184500,377000                                         @YA12276 00156000
*C925200                                                       @YA12276 00157000
*D443235                                                       @YA12276 00158000
*D255700                                                       @OX13501 00159000
*D165803-165806,165850,A165900,C350228                         @OX12562 00160000
*D219420-219440,A222000                                        @OS77414 00161000
*D934550                                                       @OY14057 00162000
*A797800                                                       @OS77835 00163000
*C282210,C282270                                               @OX14772 00164000
*C282210,C82270,A897501,A938321,A940641                        @OX14790 00165000
*A276950,277150,C276955                                        @OZ14183 00166000
*A372110,372420,479500,480500,930500                           @OS77867 00167000
.*C194000,199000,385500                                        @OY14092 00168000
.*D380070-380460,431500-432000                                 @OY14092 00187200
.*C078000,102000,372380,797800                                 @G36XRYP 00192200
*C272120-272450                                                @OZ09276 00193200
*A934800                                                       @OZ09276 00194200
*A372465,A930700                                               @OX16705 00195200
*A277210                                                       @OS79864 00195800
*A272270                                                       @OZ26670 00196400
*C290750-290800,A940642,D940680,C937700,A938322,C938360        @OZ28818 00196586
*A897500,D898500                                               @OZ28818 00196786
.********************************************************************** 00197200
IEDQKA01 CSECT                                                          00207200
&NAME    EQU   *                                                        00217200
         ENTRY &NAME                                                    00300020
         TITLE 'ACTIVATE (&NAME)- I/O GENERATOR SUBROUTINE (IEDQKA02)'  00350020
*                                                                     * 00400020
*********************************************************************** 00450020
*                                                                     * 00500020
*  TITLE:  ACTIVATE AND I/O GENERATOR SUBROUTINE ( IOGENER )          * 00550054
*                                                                     * 00556022
         AIF   ('&GEN' NE 'MINI').TAG1                          SA59501 00562022
*  MODULE NAME = IEDQKD (MINI)                                        * 00568022
         AGO   .TAG5                                            SA59501 00574022
.TAG1    AIF   ('&GEN' NE 'STSP').TAG2                          SA59501 00580022
*  MODULE NAME = IEDQKC (STSP)                                        * 00586022
         AGO   .TAG5                                            SA59501 00592022
.TAG2    AIF   ('&GEN' NE 'BISC').TAG3                          SA59501 00598022
*  MODULE NAME = IEDQKB (BISC)                                        * 00604022
         AGO   .TAG5                                            SA59501 00610022
.TAG3    AIF   ('&GEN' NE 'QTAM').TAG4                          SA59501 00616022
*  MODULE NAME = IEDQKE (QTAM)                                        * 00622022
         AGO   .TAG5                                            SA59501 00628022
.TAG4    ANOP                                                   SA59501 00634022
*  MODULE NAME = IEDQKA (BOTH)(BLANK)                                 * 00640022
.TAG5    ANOP                                                   SA59501 00646022
*                                                                     * 00652022
*  DESCRIPTIVE NAME = ACTIVATE AND I/O GENERATOR ROUTINE              * 00658022
*                                                                     * 00664022
*  COPYRIGHT = 'NONE'                                                 * 00670022
*                                                                     * 00676022
*  STATUS:  CHANGE LEVEL 5                                            * 00682051
*                                                                     * 00700020
*FUNCTION -- THE FUNCTION OF THIS MODULE IS TO CONSTRUCT CHANNEL      * 00750020
*   PROGRAMS FOR INITIAL CONTACT, CONTINUE, AND RESET SEQUENCES.      * 00800020
*                                                                     * 00850020
*ENTRY POINTS --                                                      * 00900020
*   ACTIVATE                                                          * 00950020
*        CALLING SEQUENCE                                             * 01000020
*        L     R15,ADDR OF ACTIVATE                                   * 01050020
*        BR    R15                                                    * 01100020
*                                                                     * 01150020
*   I/O GENERATOR SUBROUTINE                                          * 01200020
*        L     12,ADDR OF I/O GENERATOR SUBROUTINE                    * 01250020
*        BALR  5,12                                                   * 01300020
*                                                                     * 01350020
*INPUT -- REGISTERS SET BY CALLER                                     * 01400020
*   FOR 'ACTIVATE' --                                                 * 01450020
*   R1  ADDR OF ERB OR BUFFER                                         * 01500020
*   R13 ADDR OF AVTSAVE2                                              * 01550020
*                                                                     * 01600020
*   FOR 'I/O GENERATOR' --                                            * 01650020
*   R13 ADDR OF AVTSAVE2                                              * 01700020
*   R2  LCB ADDRESS                                                   * 01750020
*   R5  RETURN ADDRESS                                                * 01800020
*                                                                     * 01850020
*OUTPUT -- REGISTERS AT EXIT                                          * 01900020
*   FOR 'ACTIVATE' --                                                 * 01950020
*   R11 DISPATCHER BASE                                               * 02000020
*   R13 ADDR OF AVTSAVE2                                              * 02050020
*                                                                     * 02100020
*   FOR 'I/O GENERATOR SUBROUTINE' --                                 * 02150020
*   R5  RETURN ADDRESS                                                * 02200020
*   R13 ADDR OF AVTSAVE2                                              * 02250020
*                                                                     * 02300020
*EXTERNAL ROUTINES --                                                 * 02350020
*   'IEDQTNT'-- USED TO CONVERT TWO BYTE TNT OFFSET TO TERMIANL       * 02400020
*   TABLE ENTRY ADDRESS.                                              * 02450020
*                                                                     * 02500020
*   SVC 114 -- EXCPVR (AOS)                                           * 02550005
*   SVC 35--WTO                                                SA57685* 02600022
*EXITS-NORMAL --                                                      * 02650020
*   'ACTIVATE' - RETURNS TO DISPATCHER TO DISPATCH NEXT READY STCB OR * 02700020
*   TO POST A CHAIN OF BUFFERS TO MH.                                 * 02750020
*                                                                     * 02800020
*   'I/O GENERATOR SUBROUTINE' - RETURNS TO CALLER                    * 02850020
*                                                                     * 02900020
*EXITS-ERROR -- NONE                                                  * 02950020
*                                                                     * 03000020
*TABLES/WORK AREAS -- DSECTS OF CONTROL BLOCKS AS EXPANDED BY MACROS  * 03050020
*        DCBD  DSORG=TX                                                 03100022
*        TAVTD                                                          03110022
*        TCCWD                                                          03120022
*        TDEBD                                                          03130022
*        TDISPD                                                         03140022
*        TLCBD                                                          03150022
*        TPRFD                                                          03160022
*        TPRIOR                                                         03170022
*        TQCBD                                                          03180022
*        TQCBED                                                         03190022
*        TSCBD                                                          03200022
*        TSTCBD                                                         03210022
*        TTSID                                                          03220022
*        TTNTD                                                          03230022
*        TTPD                                                           03240022
*        TTRMD                                                          03250022
*                                                                     * 03550020
*ATTRIBUTES                                                           * 03600020
*   'ACTIVATE' -- REUSABLE,REFRESHABLE                                * 03650020
*                                                                     * 03700020
*   'I/O GENERATOR SUBROUTINE' - RE-ENTRANT,REFRESHABLE - WHEN        * 03750020
*                                ENTERED FROM ACTIVATE.               * 03800020
*   PROBLEM PROGRAM MODE, ENABLED.  WHEN ENTERED FROM IGG019R0        * 03850020
*   -SUPERVISOR MODE, DISABLED.                                       * 03900020
*                                                                     * 03950020
*NOTES -- THE OPERATION OF THIS MODULE DOES NOT DEPEND UPON A         * 04000020
*   PARTICUALR INTERNAL REPRESENTATION OF THE EXTERNAL CHARACTER      * 04050020
*   SET.                                                              * 04100020
*                                                                     * 04150020
* CHANGE ACTIVITY =                                            @Y16X5I0 04160000
*A-000000-999999                                               @Y16X5I0 04170000
*C147500                                                       @Y17XAII 04175000
*                                                              @Y16X5I0 04180000
*D184580-184900,377080-377400                                  @Y17XAIZ 04190000
*********************************************************************** 04200020
         EJECT                                                          04250020
         ENTRY IEDQKA02                                                 04350020
         DC    AL1(DSPMCPL2)            STCB OFFSET                     04400020
         DC    AL1(0)                                                   04450020
*    ACTIVATE IS ENTERED HERE WHEN GIVEN CONTROL BY THE DISPATCHER.   * 04500020
*                                                                       04550020
ACTIVATE EQU   *                        ENTRY PT FROM DISPATCHER        04600020
         SPACE 3                                                        04650020
         USING *,15                     LINK REGISTER                   04700022
         USING IHADCB,RDCB              DCB REGISTER                    04740022
         USING IEDQTRM,RTERM            TERM ENTRY REGISTER             04780022
         USING AVTSAVE2,RAVT            AVT SAVE REGISTER               04820022
         USING IEDQLCB,RLCB             LCB REGISTER                    04860022
         USING IEDQLCBX,RWKC            LCB EXTENSION ADDR       S99228 04920022
         USING IEDQCCW,RCCW             CCW REGISTER                    04950022
         USING IEDQDISP,RSUPBASE        DISPATCHER BASE                 04980022
         SPACE 3                                                        05010022
* REGISTER DEFINITIONS                                                  05050020
R0       EQU   0                        MODULE WORK REG                 05100022
RPARM    EQU   1                        PARAMETER REG                   05110022
RLCB     EQU   2                        LCB BASE                        05200020
RTPCDE   EQU   3                        PTS TO CURR TP FIELD IN LCB     05250020
RDCB     EQU   4                        DCB BASE                        05300020
R2       EQU   5                        WORK REGISTER                   05350020
RWKA     EQU   6                        WORK REG                        05400020
RWKB     EQU   7                        WORK REG                        05450020
RTERM    EQU   8                        TERM ENTRY BASE                 05500020
RWKC     EQU   9                        WORK REGISTER                   05550020
RCCW     EQU   10                       CCW BASE                        05600020
RSUPBASE EQU   11                       DISPATCHER BASE                 05650020
RMOD     EQU   11                       PTS TO MODEL CCW'S              05700020
RBASE    EQU   12                       BASE ADDRESS FOR I/O GENERATOR  05750020
RAVT     EQU   13                       AVT BASE ADDRESS                05800022
REXPND   EQU   14                       LINK REG FOR EXPAND ROUTINE     05850020
RLNK1    EQU   15                       WORK REG                        05900022
         EJECT                                                          05950020
         STM   11,15,12(13)             SAVE REQUIRED REGISTERS         06000020
&NAME    IEDHJN ID                                               S22025 06050022
         LR    RLCB,RPARM               ERB ADDRESS                     06250020
         TM    PRFTIC-IEDQPRF(RPARM),CCWTIC ERB OR BUFFER               06300020
         BZ    ITSERB                   BRANCH IF ERB                   06350020
         L     RLCB,PRFLCB-1-IEDQPRF(RPARM) SET LCB BASE                06400020
         B     ITSLCB                   CONTINUE                        06450020
ITSERB   EQU   *                                                        06500020
         SH    RLCB,LCBBKUP             BACK UP TO LCB                  06550020
ITSLCB   EQU   *                                                        06600020
         L     RDCB,LCBDCBPT            DCB BASE                        06650020
         AIF   ('&GEN' EQ 'BISC').L6                                    06700020
         AIF   ('&GEN' EQ 'MINI').L6                                    06750020
         AIF   ('&GEN' EQ 'QTAM').L6                                    06770020
         TM    LCBTSOB,LCBTSBUF         IS THIS A TS BUFFER?        TSO 06800020
         BZ    TSO1                     BRANCH ON NO                TSO 06850020
         L     RWKA,AVTTSOPT            GET ADDRESS OF TS SCHED     TSO 06900020
         L     RWKA,TSISCHED-IEDQTSI(,RWKA)                         TSO 06950020
         BAL   RTPCDE,24(RWKA)          BRANCH TO ROUTINE           TSO 07000020
TSO1     EQU   *                                                    TSO 07050020
.L6      ANOP                                                           07100020
         LA    RBASE,BUILD              IOGEN SUBROUTINE            TSO 07150020
         BALR  R2,RBASE                 LINK TO IO GEN                  07200020
         LM    11,15,12(13)             RESTORE REGISTERS               07300020
         MVC   LCBTTCIN,LCBTTBIN        TO BE CONNECTED IS NOW CON-     07350020
         SPACE 2                                                 A41027 07360020
         L     RWKB,DCBMH-1 .           GET MH -CB ADDRESS FOR POA41027 07370020
         SR    RWKC,RWKC .              CLEAR POST LIST FOR FINALA41027 07380020
*                                         EXIT TO DISPATCHER     A41027 07390020
         SPACE 2                                                 A41027 07392020
*        UNIT EXCEPTION BIT WILL BE SET WHEN AA CONTINUE OR ABORTA41027 07394020
* SEQUENCE CAN NOT BE SENT (EX. 1030, 2260L, ETC.)               A41027 07396020
         TM    LCBCSW+3,UNEX            NO RESTART ON CONTINUE          07400020
*                                         REQUEST                       07450020
         BZ    NOTUNEX                  BRANCH NO                       07500020
         SPACE                                                          07550020
         L     RPARM,LCBLSPCI-1         BUFFER TO POST                  07650020
         MVI   PRFPRI-IEDQPRF(RPARM),PRIMHBFR POST PRIORITY             07700020
         NI    PRFSTAT1-IEDQPRF(RPARM),PRFNLSTF 'LAST BUFFWR'           07750020
         STCM  RWKB,7,PRFQCBA-IEDQPRF(RPARM) SET POST ADDRESS  @G36XRYP 07800000
         BAL   REXPND,DSPPOST           POST BUFFER TO MH      @Y17XAIX 07850000
NOTUNEX  EQU   *                                                        07900020
         AIF   ('&GEN' EQ 'STSP').Z0 .                           S22027 07950022
         AIF   ('&GEN' EQ 'MINI' OR '&GEN' EQ 'QTAM').Z0 .       S22027 08000022
         TM    LCBSTICS+1,CBRDCAST .    BROADCAST MESSAGES       S22027 08050022
         BO    EXITDSP .                BRANCH IF YES            S22027 08100022
.Z0      ANOP                                                    S22027 08150022
         TM    LCBSTAT2,LCBMSGNN        MSG GEN                         08200020
         BO    EXITDSP .                BRANCH YES               A41027 08250020
         SPACE 2                                                 A41027 08260020
         TM    LCBSTAT1,LCBRECVN        RECEIVE STATE                   08400020
         AIF   ('&GEN' NE 'MINI').Z1                                    08410020
         BO    EXITDSP .                YES                      A41027 08420020
         AGO   .Z2                                                      08430020
.Z1      ANOP                                                           08440020
         BZ    NOTRCV                   NO                              08450020
         CLI   LCBCPA+24,CCWPOLL        AUTOPOLL IN USE                 08500020
         BNE   EXITDSP .                NO                       A41027 08550020
         SPACE                                                          08600020
*        WANT TO OPEN LIST FOR SEND STCB OR POLL DELAY           A41024 08650020
         CLI   DCBINTVL,AVTEZERO .      POLL DELAY  SPECIFIED    A41024 08660020
         BNE   ITSHERE .                BRANCH IF YES            A41024 08670020
         LA    RWKA,LCBSTCBA-5          RECEIVE STCB -4                 08700020
         CLI   LCBRSKEY,BUFFVTO         BUFFERED LCB                    08750020
         BNE   LOOPPOLL                 BRANCH IF NO                    08800020
         SPACE                                                          08850020
         LA    RWKA,LCBRSKEY            ADJUST FOR LOOP CONTROL         08900020
LOOPPOLL EQU   *                                                        08950020
         L     RWKA,STCBLINK-1-IEDQSTCB(RWKA) NEXT STCB IN CHAIN        09000020
         CLI   STCBPRI-IEDQSTCB(RWKA),0 LAST STCB (QEVENT)              09050020
         BE    EXITDSP .                YES                      A41027 09100020
         CLI   STCBVTO-IEDQSTCB(RWKA),SENDVTO SEND STCB                 09150020
         BE    ITSHERE                  YES                             09200020
         AIF   ('&GEN' EQ 'MINI').CONC1A .                       S22026 09208022
         CLI   STCBVTO-IEDQSTCB(RWKA),CSVTO .                    S22026 09216022
*                                       CONC SCHEDULER           S22026 09224022
         BE    ITSHERE .                BRANCH IF YES            S22026 09232022
.CONC1A  ANOP .                                                  S22026 09240022
         CLI   STCBVTO-IEDQSTCB(RWKA),BUFFVTO BUFFERED SEND STCB        09250020
         BNE   LOOPPOLL                 NO TRY NEXT STCB                09300020
         SPACE                                                          09350020
ITSHERE  EQU   *                                                        09400020
         MVI   LCBCPA+32,CCWNOP         NOP FIRST TIC                   09450020
         B     EXITDSP .                EXIT                     A41027 09500020
         SPACE 2                                                 A41027 09510020
NOTRCV   EQU   *                                                        09550020
.Z2      ANOP                                                           09570020
*                                                                A41027 09580020
*        FOR DEVICES THAT ARE NOT SELECTED BUFFERS ARE POSTED NOWA41027 09590020
         SPACE                                                          09600020
         TM    LCBSTAT2,LCBRESP         POST BUFFER NOW                 09610020
         BNZ   POST                     YES, CONVERSE RESPONSE          09620020
* INSTEAD OF LINE END APPENDAGE                                  A41027 09630020
*                                                                A41027 09640020
         TM    LCBSTICS+1,CBISYNC+CSTNCTL+CTWX CAN TERMINAL BE          09650020
*                                         SELECTED                      09700020
         BNZ   EXITDSP .                NOT START STOP CONTENTIONA41027 09750020
         SPACE                                                          09800020
         TM    LCBSTICS+2,CWTTA         WORLD TRADR                     09850020
         BNZ   EXITDSP .                YES                      A41027 09900020
POST     EQU   *                                                        09950020
         NI    LCBSTAT2,AVTEFF-LCBRESP  RESET RESPONSE BIT     @SA74956 09970058
         L     RWKA,LCBERBCH-1          ADDRESS OF FIRST BUFFER         10000020
         LR    RWKC,RWKA .              SAVE POINTER TO POST LISTA41027 10050020
LOOP     EQU   *                                                        10150020
         STCM  RWKB,7,1(RWKA)           QCB ADDRESS FOR POST   @G36XRYP 10200000
         MVI   4(RWKA),PRIMHBFR         SET POST PRIORITY               10250020
         L     RWKA,4(,RWKA)            LINK ADDRESS NEXT BUFFER        10300020
         LA    RWKA,AVTEZERO(,RWKA)     CLEAR HI ORDER BYTE             10350020
         LTR   RWKA,RWKA                IS THERE A NEXT BUFFER          10400020
         BNZ   LOOP                     YES                             10450020
         SPACE                                                          10500020
         XC    LCBERBCH,LCBERBCH .      RESET FIELD FOR LATER USEA41027 10550020
         LR    RPARM,RWKC .             ASSUME LOCAL DEVICE      A41027 10600020
         TM    LCBSTICS+1,CLOCAL+CAUDIO . LOCAL DEVICE           A48273 10650022
         BZ    ADDLABEL .               BR YES, EXCP WILL BE   @Y17XAIX 10660000
*                                         AT BUFFER ASSOCIATION  A41027 10670020
         BAL   REXPND,DSPCHAIN                                 @Y17XAIX 10671000
ADDLABEL TM    LCBSTICS+2,CNOIDLES      NO IDLES LOOP (2260R)  @Y17XAIX 10672000
         BNO   EXITDSP                  BRANCH IF YES,EXCP DONE@Y17XAIX 10674000
*                                         BUFFER ASSOCIATION    SA53628 10676022
         BAL   REXPND,DSPCHAIN                                 @Y17XAIX 10678000
EXITDSP  EQU   *                                                 A41027 10680020
         SPACE                                                          10690020
         LA    RPARM,LCBFLAG1 .         EXCP PARAMETER (IOB)     A41027 10692020
         EXCPVR (1),SUBSYS                                       X01004 10694005
         SPACE 2                                                 A41027 10696020
         LR    RPARM,RWKC .             POST PARAMETER LIST      A41027 10698020
         BAL   REXPND,DSPCHAIN          EXIT TO POST BUFFERS OR@Y17XAIX 10698400
*                                         DISPATCH NEXT STCB     A41027 10698820
         EJECT                                                          10750020
*        C O D I N G    T E C H N I Q U E S                             10800020
         SPACE 1                                                        10850020
*     THE CHANNEL PROGRAM CONSTRUCTED IS BASED UPON THE CHARACTER-      10900020
* ISTICS OF THE DEVICE (OBTAINED FROM THE DEVICE CHARACTERISTICS        10950020
* FOR THIS TERMINAL OR LINE ENTRY).  THE I/O GENERATOR SUBROUTINE       11000020
* TESTS CHARACTERISTICS BITS AND TRANSFERS CONTROL TO THE 'EXPAND'      11050020
* ROUTINE (DESCRIBED BELOW) PASSSING AN OFFSET INTO A MODEL CCW         11100020
* TABLE.                                                                11150020
*  E. G. REXPND (REG14)=A(EXPAND)                                       11200020
*        BALR  RLNK1,REXPND                                             11250020
*        DC    AL2(MODCCW08-MODCCW)                                     11300020
*     THIS SEQUENCE BUILDS A DISABLE-ENABLE SEQUENCE.                   11350020
*     THE MODEL CCW TABLE CONSISTS OF TWO BYTE ENTRIES.                 11400020
* THE FIRST BYTE IS AN OFFSET INTO A SECOND TABLE (EXPANDER TABLE).     11450020
* THE SECOND BYTE CONTAINS THE CCW FLAGS FOR THE CCW BEING BUILT.       11500020
* THE EXPAND ROUTINE MOVES THE SPECIFIED FLAGS FOR THE CCW              11550020
* THE EXPAND ROUTINE MOVES THE SPECIFIED FLAGS INTO THE CCW AND         11600020
* UTILIZES THE ONE BYTE INDEX (FROM THE MODEL CCW TABLE) TO ACCESS      11650020
* THE FOLLOWING INFORMATION FROM THE EXPANDER TABLE:                    11700020
*     EACH ENTRY IN THE EXPANDER TABLE HAS THE FOLLOWING FORMAT:        11750020
*        DC    AL2(OFFSET TO A ROUTINE THAT ESTABLISHES ADDRESS         11800020
*                  AND COUNT)                                           11850020
*        DC    AL1(CCWDISAB)            CCW OP CODE                     11900020
*        DC    AL1(TPDISAB)             TP OP CODE                      11950020
*     THE EXPAND ROUTINE PASSES CONTROL TO AN EXPANDER SUBROUTINE       12000020
* (BY BRANCHING TO ORGRTN INDEXED BY THE 2 BYTE OFFSET) THAT COM-       12050020
* PUTES CCWDATA ADDRESS AND COUNT.  UPON REGAINING CONTROL, THE         12100020
* EXPAND ROUTINE MOVES THE CCWOP CODE INTO THE CCW AND THE TP OP        12150020
* CODE INTO THE LCB FROM THE EXPANDER TABLE.                            12200020
*     RETURNING AGIN TO THE EXAMPLE, THE FIRST CCW IN THE SEQUENCE      12250020
* (DISABLE) HAS BEEN BUILT.  A REGISTER IS ADJUSTED TO POINT TO THE     12300020
* ENTRY IN THE MODEL CCW TABLE AND A TEST IS PERFORMED FOR THE LAST     12350020
* ENTRY.  IF THIS IS NOT THE LAST ENTRY THE ABOVE ACTION IS PER-        12400020
* FORMED AGAIN TO CONSTRUCT THE NEXT CCW (THE ENABLE).  EXPAND RE-      12450020
* TURNS TO IN-LINE CODE OF THE I/O GENERATOR WHEN THE LAST ENTRY        12500020
* IS REACHED.                                                           12550020
         SPACE 2                                                        12600020
         DC    A(IOGENEND-IEDQKA02)     LENGTH TO FIX FOR TSO   OY00451 12620005
* CONTROL IS GIVEN TO BUILD WHEN ENTERED FROM AN APPENDAGE.           * 12650020
BUILD    EQU   *                                                        12700020
IEDQKA02 EQU   *                                                        12750020
         USING *,RBASE                                                  12800020
         L     RDCB,LCBDCBPT                                            12850020
         LA    RWKA,LCBCPA+16           START ON 3RD CCW                12900020
         ST    RWKA,LCBSTART-1          PARAMETER FOR IOS               12950020
         NI    LCBCSW+3,AVTEFF-UNEX     RESET SWITCH                    13000020
         LH    RWKC,LCBTTBIN            TERMINAL TO BE CONNECTED        13050020
         AIF   ('&GEN' EQ 'MINI').L7                                    13070020
         LTR   RWKC,RWKC                SPECIFIC CONNECTION             13100020
         BNZ   CONNECT1                 BRANCH YES                      13150020
         TM    LCBSTAT2,LCBDIAL         DIAL LINE                       13250020
         BZ    NONDIAL                  NO                              13300020
         SPACE                                                          13350020
         LH    RWKC,LCBLNENT            ADDRESS OF LINE ENTRY           13400020
         LTR   RWKC,RWKC                DO WE HAVE LINE ENTRY           13450020
         BNZ   CONNECT1                 BRANCH YES                      13500020
         SPACE                                                          13550020
NONDIAL  EQU   *                                                        13600020
         SR    RTERM,RTERM              CLEAR FOR INDEXING              13700020
         IC    RTERM,LCBUCBX            RLN-1                           13750020
         SLL   RTERM,2                  MULTIPLY FOR INDESX             13800020
         L     RTERM,DCBINVLI(RTERM)    ILIST FOR THIS LINE             13850020
         LA    RTERM,AVTEZERO(,RTERM)   CLEAR HI ORDER BYTE             13900020
         AIF   ('&GEN' EQ 'BISC' OR '&GEN' EQ 'QTAM').LAA1              13910020
         L     RWKA,LCBINVPT-1          CURRENT INVITATION LIST         13920020
         CLI   0(RWKA),X'FE'            IS THIS END OF LIST             13930020
         BE    LEND                    END OF LIST              SA65910 13932005
         CLI   1(RWKA),X'FE'           IS THIS END OF LIST      SA65910 13934005
         BNE   NOTEND                  BRANCH NO                SA65910 13936005
LEND     EQU   *                                                SA65910 13938005
         BNE   NOTEND                   BRANCH ON NO                    13940020
.LAA1    ANOP                                                           13942020
         BCTR  RTERM,0                  BACK UP                         13950020
         BCTR  RTERM,0                  NOW TWO                         14000020
         AIF   ('&GEN' EQ 'BISC' OR '&GEN' EQ 'QTAM').LAA2              14010020
         B     CONNECT0                                                 14020020
NOTEND   EQU   *                                                        14030020
         SR    RWKC,RWKC                CLEAR FOR IC                    14040020
         IC    RWKC,2(RTERM)            ENTRY WIDTH                     14042020
         BCTR  RWKC,0                   REDUCE BY ONE                   14044020
         IC    RWKC,0(RWKA,RWKC)        GET ENTRY INDEX                 14046020
         SLL   RWKC,1                   MULTIPLY BY TWO                 14048020
         SR    RTERM,RWKC               GET ACTUAL ENTRY OFFSET         14048420
CONNECT0 EQU   *                                                        14048820
.LAA2    ANOP                                                           14049220
         LH    RWKC,AVTEZERO(,RTERM)    REPRESENATIVE ENTRY             14050020
         TM    LCBSTAT2,LCBMSGNN       IS THIS A MESSAGE GEN    SA65910 14060005
         BNO   CONNECT1                BRANCH NO                SA65910 14070005
         TM    LCBSTAT2,LCBDIAL         DIAL LINE              @YA05148 14073056
         BO    CONNECT1                 YES, BRANCH            @YA05148 14076056
         STH   RWKC,LCBTTBIN           REPRESENATIVE ENTRY      SA65910 14080005
CONNECT1 EQU   *                                                        14100020
.L7      ANOP                                                           14120020
         N     RWKC,AVTCLRHI            CLEAR NEGATIVE PROPAGATION      14150020
         L     RWKB,AVTRNMPT            ADDRESS OF TNT                  14200020
         USING IEDQTNTD,RWKB                                            14250020
         BAL   RWKA,TNTDCODE            LNK TO ROUTINE                  14300020
         DROP RWKB                                                      14350020
         AIF   ('&GEN' EQ 'MINI').CONC2A .                       S22026 14352022
         TM    TRMDEVFL+1,TRMCONC .     CONC                     S22026 14354022
         BNO   NOTCONC .                BRANCH IF NO             S22026 14356022
         L     RWKA,TRMDESTQ-1 .        QCB ADDR                 S22026 14358022
         TM    QCBDSFLG-IEDQQCB(RWKA),QCBDRQQ .                  S22026 14360022
*                                       DATA READY QUE           S22026 14362022
         BO    NOTCONC .                BRANCH IF YES            S22026 14364022
         TM    LCBSTAT1,LCBSENDN .      LCB SENDING              S22026 14366022
         BNO   NOTSEND .                BRANCH IF NO             S22026 14368022
         TM    TRMDEVFL,X'20' .         ADDRESSING CHARS         S22026 14370022
         BO    NOTCONC .                BRANCH IF YES            S22026 14372022
NOTSEND  EQU   * .                                               S22026 14374022
         LH    RWKB,QCBEXTO-IEDQQCB(RWKA) .                      S22026 14376022
*                                       QCB EXTENSION OFFSET     S22026 14378022
         AR    RWKA,RWKB .              COMPUTE ADDR             S22026 14380022
         L     RTERM,QCBECONC-IEDQQCBE-1(RWKA) .                 S22026 14382022
*                                       CONC TERM ADDR           S22026 14384022
NOTCONC  EQU   * .                                               S22026 14386022
.CONC2A  ANOP .                                                  S22026 14388022
         LA    REXPND,EXPAND            SET-UP LINK FOR EXPAND          14400020
         LH    RWKA,TRMSIO              SIO COUNTER                     14450020
         LA    RWKA,1(,RWKA)            BUMP                            14500020
         STH   RWKA,TRMSIO              ST BACK                         14550020
         SR    RWKA,RWKA                CLEAR WORK REGISTER             14600020
         IC    RWKA,TRMCHCIN            INDEX INTO CHARACTERISTIC       14650020
         BCTR  RWKA,R0                  DECREMENT FOR N-1TH ENTRY       14700020
         MH    RWKA,AVTDCTLN            MULTIPLY BY ENTRY LEN  @Y17XAII 14750000
         A     RWKA,AVTCSTCS            ADD TABLE START                 14800020
         MVC   LCBSTICS-1(4),0(RWKA)    CHARACTERISTICS TO LCB          14850020
         AIF   ('&GEN' EQ 'BISC').LA1                                   14900020
         AIF   ('&GEN' EQ 'MINI').LA1                                   14950020
         AIF   ('&GEN' EQ 'QTAM').LA1                                   14970020
         TM    LCBSTICS,C5041           1050/2741 LINE?             TSO 15000020
         BZ    TSO10                    NO                          TSO 15050020
         TM    LCBTSOB,LCB2741N         IS IT A 2741?               TSO 15100020
         BNO   S1050                    NO. USE 1050 CH'STICS       TSO 15150020
         MVC   LCBSTICS(3),D41STICS     2741 DEVICE CH'STICS        TSO 15250020
         B     TSO10                                                TSO 15300020
S1050    EQU   *                                                    TSO 15350020
         MVC   LCBSTICS(3),D50STICS     1050 CH'STICS               TSO 15400020
TSO10    EQU   *                                                    TSO 15450020
.LA1     ANOP                                                           15500020
         TM    LCBSTAT1,LCBCONT         REQU%EST FOR CONTINUE           15550020
         BNZ   CONTINUE                 BRANCH YES                      15600020
         MVI   LCBINCAM,AVTEZERO        RESET ERROR COUNTER             15700020
         CLI   DCBEIOBX,XC8             IS EXTENSION PRESENT   @ZA04039 15740058
         BL    CKMSGEN                  BRANCH-NO              @ZA04039 15780058
         MVI   LCBCPA+53,AVTEZERO       RESET LOCAL RETRY COUNT@ZA04039 15820058
CKMSGEN EQU *                                                  @ZA04039 15860058
         SPACE                                                          15900020
         TM    LCBSTAT2,LCBMSGNN        MSGEN                           15950020
         BO    MSGGEN                   YES                             16000020
         TM    LCBSTAT1,LCBSENDN        SEND STATE                      16050020
         BO    WRITINIT                 YES                             16100020
         TM    LCBSTAT2,LCBRESP         OWE A RESPONSE                  16110020
         BZ    READ                     NO                              16120020
         BAL   R0,WRRESP                BUILD RESPONSE                  16150020
READ     EQU   *                                                        16550020
         AIF   ('&GEN' EQ 'MINI').L4A3                         @YA03846 16580056
         BAL   RWKB,GLCBXA              LOCATE LCB EXTENSION     S99228 16580122
         TM    LCBXFLAG,LCBGPCTV        GENERAL POLL IN PROGRESS?S99228 16581022
         BO    KEEPSET                  YES, NO RESET ACK-1      S99228 16582022
.L4A3    ANOP                                                    S99228 16582522
         MVI   LCBERCCW+12,FLAG         SET ONLY SILI FLAG IN CCWS99228 16583022
         MVI   LCBMSGFM,AVTEZERO        RESET FORMAT BITS AND AC S99228 16584022
*                                         COUNTER                S21101 16590020
KEEPSET  EQU   *                                               @OX12562 16592000
         NI    LCBMSGFM,LCBACKI         CLEAR BSC CONTROL,LEAVE@OX12562 16594000
*                                       ACK COUNTER            @OX12562 16596000
         L     RWKC,LCBLSPCI-1           ADDRESS FO FIRST BUFFER        16600020
         LH    RWKA,AVTKEYLE             SIZE OF A UNIT                 16650020
         CH    RWKA,DCBBUFSI            COMPARE WITH DCB OPERAND        16700020
         BNH   SETSIZE                  BRANCH DCB LESS OR EQUAL        16750020
         LH    RWKA,DCBBUFSI            DCB PARAMETER                   16800020
SETSIZE  EQU   *                                                        16850020
          SR    RWKB,RWKB                CLEAR WORK REGISTER            16900020
         AIF   ('&GEN' EQ 'MINI').L8                                    16950020
         AIF   ('&GEN' EQ 'BISC').L8                                    17000020
         AIF   ('&GEN' EQ 'QTAM').L8                                    17020020
** TSO---CHECK FOR CORRECT DATA COUNT                               TSO 17050020
**                                                                  TSO 17100020
         TM    LCBTSOB,LCBTSBUF         IS THIS A TSO BUFFER        TSO 17150020
         BO    TSOB                     DO NOT RESERVE CHARS     S22029 17200022
*                                       FOR TIME-SHARING MSGS    S22029 17300022
.L8      ANOP                                                           17400020
         IC    RWKB,DCBRESER            IDLES RESERVED FOR HEADER       17450020
TSOB     EQU   *                                                 S22029 17470022
         STC   RWKB,LCBISZE             SET IDLES COUNT IN LCB          17500020
         LA    RWKB,PRFSHDR-PRFSUNIT(,RWKB) BUMP BY HEADER SIZE         17550020
         SR    RWKA,RWKB                 DATA COUNT FOR 1ST VUFFER      17650020
          STH  RWKA,CCWCOUNT-CCW(,RWKC) ESTABLISH COUNT                 17700020
         IC    RWKA,PRFOPCDE-IEDQPRF(,RWKC) SAVE OP CODE                17750020
         LA    RWKB,PRFSUNIT-IEDQPRF(RWKB,RWKC) START ADDRESS-CCW       17800020
         ST     RWKB,PRFIOADR-1-IEDQPRF(,RWKC) SET IN CCW               17850020
         STC    RWKA,PRFOPCDE-IEDQPRF(,RWKC) RESTORE OP CODE            17900020
         NI    PRFSTAT1-IEDQPRF(RWKC),PRFNHDRF 'TEXT' BIT OFF           17950020
         EJECT                                                          18000020
*                                                                       18050020
*        * * * * * * * * * * * * * * * * * * * * * * * * * *            18100020
*        *                                                 *            18150020
*        *     R E A D    I N I T I A L    L O G I C       *            18200020
*        *                                                 *            18250020
*        * * * * * * * * * * * * * * * * * * * * * * * * * *            18300020
         SPACE 3                                                        18350020
         NI    LCBSTAT2,AVTEFF-LCBRESP  TURN OFF RESPONSE BIT           18450020
         LA    RCCW,LCBCPA              SET CCW BASE                    18500020
         LA    RTPCDE,LCBTPCD           SET TP OP CODE BASE             18550020
         BALR  RLNK1,REXPND             LINK TO EXPAND                  18600020
         DC    AL2(MODCCW00-MODCCW)                                     18650020
         AIF   ('&GEN' EQ 'MINI').L10                                   18700020
         TM    LCBSTAT2,LCBDIAL         DIAL LINE?                      19050020
         BZ    NOSWITCH                 BRANCH IF NOT                   19100020
         SPACE 5                                                        19150020
******** D I A L    L I N E S ********                                  19200020
         SPACE 2                                                        19250020
         TM    LCBSTAT2,LCBNEGRP        NEG RESPL TO POLLING            19300020
         BO    ENAB                     YES, WANT TO DISCONNECT         19350020
         TM    LCBCHAIN,LCBCTLMD        DIAL UP READ           @OY14092 19400000
         BZ    CONNECT .                NO                       S21101 19450020
         SPACE 5                                                 S21101 19500020
* D I A L    C O N N E C T I O N                                        19800020
         NI    LCBCHAIN,AVTEFF-LCBCTLMD                        @OY14092 19900000
         AIF   ('&GEN' NE '').L11                                       19950020
         TM    LCBSTAT2,LCBSYNC         BSC LINE                        20000020
         BZ    NODLUPBS                 BRANCH NO                       20050020
.L11     ANOP                                                           20100020
         AIF   ('&GEN' EQ 'STSP').L12                                   20150020
         AIF   ('&GEN' EQ 'QTAM').L12                                   20170020
         TM    LCBTPCD+11,DISDLEOT      WRITE DISCONNECT        SA61781 20173005
         BO    GODISCON                 BR YES                  SA61781 20176005
         OI    LCBTPCD+11,DISDLEOT      SET TO WRITE DISCONNECT SA61781 20179005
*                                         PRIOR TO NEXT DISABLE SA61781 20182005
         LA    RTPCDE,ONE(,RTPCDE)      ADJUST TP CODE BASE     SA61781 20185005
         LA    RCCW,EIGHT(,RCCW)        ADJUST CCW BASE         SA61781 20188005
         ST    RCCW,LCBSTART-1          SET START ADDRESS       SA61781 20191005
         B     NODISCON                 CONTINUE                SA61781 20194005
GODISCON EQU   *                                                SA61781 20197005
         BALR  RLNK1,REXPND             LINK TO EXPAND                  20200020
         DC    AL2(MODCCW01-MODCCW)                                     20250020
         B     NEXT                     CONTINUE                SA61781 20258005
NODISCON EQU   *                                                SA61781 20266005
         BALR  RLNK1,REXPND             GO TO EXPAND ROUTINE    SA61781 20274005
         DC    AL2(MODCCW02-MODCCW)                             SA61781 20282005
NEXT     EQU   *                                                SA61781 20290005
         SPACE                                                          20300020
         BAL   RWKB,ILIST               GET ILIST ADDRESS               20350020
         CLI   IDLOC+1(RWKC),0          ID SPECIFIED                    20400020
         BE    NOTANID                  BRANCH IF NO ID                 20450020
         BALR  RLNK1,REXPND             LINK TO EXPAND                  20500020
         DC    AL2(MODCCW14-MODCCW)                                     20550020
         B     WREOT                    GO WRITE EOT ONLY       SA55383 20570022
NOTANID  EQU   *                                                        20600020
         BALR  RLNK1,REXPND             LINK TO EXPNAD                  20650020
         DC    AL2(MODCCW15-MODCCW)                                     20700020
WREOT    EQU   *                                                SA55383 20720022
         BALR  RLNK1,REXPND             LINK TO EXPNAD                  20750020
         DC    AL2(MODCCW16-MODCCW)                                     20800020
.L12     ANOP                                                           20850020
         AIF   ('&GEN' EQ 'BISC').L222                                  20900020
NODLUPBS EQU   *                                                        20950020
         BALR  RLNK1,REXPND             BUILD DISABLE DIAL              21000020
         DC    AL2(MODCCW02-MODCCW)                                     21050020
         TM    LCBSTICS+1,CTWX                                          21100020
         BZ    BLDPADS                  BUILD WRITE PADS                21150020
         BALR  RLNK1,REXPND             READ TERM ID                    21200020
         DC    AL2(MODCCW32-MODCCW)                                     21250020
         BALR  RLNK1,REXPND             WRITE CPU ID  AND READ          21300020
         DC    AL2(MODCCW18-MODCCW)                                     21350020
BLDPADS  EQU   *                                                        21360020
         BALR  RLNK1,REXPND             LINK TO EXPAND                  21370020
         DC    AL2(MODCCW36-MODCCW)                                     21380020
         B     CONNECT .                BUILD REST OF CANNEL PROGAM     21390020
.L222    ANOP                                                           21400020
         EJECT                                                          21450020
* E N A B L E    C O N N E C T I O N                                    21500020
ENAB     EQU   *                                                        21550020
         NI    LCBSTAT2,AVTEFF-LCBNEGRP NEGATIVE RESPONSE OFF           21600020
         MVI   LCBTSTSW,AVTEZERO        INDICATE LINE NOT CONNECTED     21650020
         AIF   ('&GEN' NE '').L14                                       21700020
         TM    LCBSTAT2,LCBSYNC         BSC LINE                        21750020
         BZ    NOBSD                    NO                              21800020
.L14     ANOP                                                           21850020
         AIF   ('&GEN' EQ 'STSP').L15                                   21900020
         AIF   ('&GEN' EQ 'QTAM').L15                                   21920020
         L     RWKA,LCBSCBA-1           GET SCB POINTER          S21101 21930020
         USING IEDQSCB,RWKA .                                    S21101 21940020
         TM    LCBTPCD+11,DISDLEOT      NEED DLE EOT PRIOR TO DISAB     21950020
         BO    SNDLEEOT                 BRANCH IF YES                   22000020
         SPACE                                                          22050020
         OI    LCBTPCD+11,DISDLEOT      SET FOR NEXT TIME-LINE END      22100020
*                                         WILL RESET IF DLE EOT         22150020
*                                         RECEIVED                      22200020
         TM    SCBBSCFM,SCBNOEOT        DO WE OWE EOT          @OS77414 22210000
         BO    SNDLEEOT                 YES SEND DLE EOT       @OS77414 22220000
         OI    SCBBSCFM,SCBNOEOT        SET EOT RECEIPT PENDING@OS77414 22230000
         DROP  RWKA                                            @OS77414 22240000
         LA    RTPCDE,1(,RTPCDE)        ADJUST TP OP CODE BASE          22250020
         LA    RCCW,8(,RCCW)            RESET CCW BASE                  22300020
         ST    RCCW,LCBSTART-1          AND SET START ADDRESS           22350020
         BALR  RLNK1,REXPND             LINK TO EXPAND                  22400020
         DC    AL2(MODCCW7B-MODCCW)                                     22450020
         B     NXTBSCCW                 CONTINUE BUILDING               22500020
SNDLEEOT EQU   *                                                        22550020
         SPACE                                                          22600020
         BALR  RLNK1,REXPND             LINK TO EXPAND                  22650020
         DC    AL2(MODCCW07-MODCCW)     DISABLE SEQUENCE                22700020
         SPACE                                                          22750020
NXTBSCCW EQU   *                                                        22800020
         CLI   DCBINTVL,TONEOPT         WRITE TONE REQUESTED            22850020
         BNE   NOTONE                   BRANCH IF NO                    22900020
         BALR  RLNK1,REXPND             LINK TO EXPAND                  22950020
         DC    AL2(MODCCW7A-MODCCW)                                     23000020
         SPACE                                                          23050020
NOTONE   EQU   *                                                        23100020
         BALR  RLNK1,REXPND             LINK TO EXPAND                  23150020
         DC    AL2(MODCCW10-MODCCW)                                     23200020
         BAL   RWKB,ILIST               GET ILIST ADDRESS               23250020
         CLI   IDLOC+1(RWKC),0          CPU ID SPECIFED                 23300020
         BE    NOBSID                   NO                              23350020
         BALR  RLNK1,REXPND             LINK TO EXPAND                  23400020
         DC    AL2(MODCCW11-MODCCW)                                     23450020
NOBSID   EQU   *                                                        23500020
         BALR  RLNK1,REXPND             LINK TO EXPAND                  23550020
         DC    AL2(MODCCW12-MODCCW)                                     23600020
.L15     ANOP                                                           23650020
         AIF   ('&GEN' EQ 'BISC').L16                                   23700020
         AIF   ('&GEN' EQ 'QTAM').L16A                                  23720020
         SPACE                                                          23730020
NOBSD    EQU   *                                                        23740020
         MVI   LCBTPCD+11,X'AB'         SET FIRST TIME SWITCH   TSO     23750020
         TM    LCBSTICS,C5041 .         THIS A 5041 LINE            TSO 23760020
         BZ    TSO99 .                  NO                          TSO 23770020
         NI    LCBTSOB,X'FF'-LCB2741N . RESET 2741 FLAG IF ON       TSO 23780020
TSO99    EQU   * .                                                  TSO 23790020
         L     RLNK1,DCBTRANS-1 .       POINT TO TABLE OR LIST      TSO 23802020
         TM    0(RLNK1),X'80' .         IS IT TRANLIST MACRO        TSO 23804020
         BZ    TSO20 .                  NO                          TSO 23806020
         MVC   AVTPARM3(4),OPTLIST .    SKELETON PARAM LIST         TSO 23808020
         IC    RWKB,1(,RLNK1) .         OPTION FIELD OFFSET         TSO 23810020
         STC   RWKB,AVTPARM3+2 .        TO PARM LIST                TSO 23812020
         LA    RPARM,AVTPARM3 .         PARM LIST POINTER           TSO 23814020
         LA    RAVT,72(,RAVT) .         KICK DOWN FOR UI            TSO 23818020
         STM   2,12,28(RAVT) .          SAME AS IEDQUI DOES         TSO 23818320
         LA    REXPND,LOCRTN .          SET UP RETURN            S22025 23818622
         ST    REXPND,12(,RAVT) .       SAVE IT                  S22025 23818722
         LR    RWKC,RAVT                LOAD CALLERS ADDR        S22025 23818822
         LA    RAVT,72(RAVT)            BUMP TO NEXT SAVEAREA    S22025 23818922
         ST    RWKC,4(RAVT)             STORE BACK CHAIN         S22025 23819022
         ST    RAVT,8(RWKC)             STORE FORWARD CHAIN             23819122
         L     RWKC,CVTPTR .                                        TSO 23819220
         L     RWKC,AVTCVTPT(,RWKC) .                               TSO 23819520
         L     RWKC,0(,RWKC) .          POINT TO AVT                TSO 23819820
         L     RBASE,AVTMSGS-1-IEDQAVTD(RWKC)                    S22025 23820122
*                                       VCON LIST ADDR           S22025 23820222
         L     RBASE,20(,RBASE) .       OFFSET TO AE VCON=20        TSO 23820420
         LR    RDCB,RLCB .              AE USES 4 FOR LCB           TSO 23820720
         BR    RBASE .                  TO IEDQAE                   TSO 23821020
LOCRTN   EQU   * .                                                  TSO 23821320
         SH    RAVT,H72 .               RESTORE AVTPOINTER          TSO 23822020
         LA    REXPND,EXPAND .          RESTORE CALL REG            TSO 23824020
         LTR   RLNK1,RLNK1 .            SEE IF OPTION FLD PRESENT   TSO 23826020
         BZ    TSO20 .                  NO. NOTHING TO DO               23828020
         XC    0(4,RLNK1),0(RLNK1) .    YES. ZERO FOR NEXT USE      TSO 23830020
TSO20    EQU   * .                                                  TSO 23832020
.L16A    ANOP                                                           23838020
         BALR  RLNK1,REXPND             GO TO EXPAND RTNE               23850020
         DC    AL2(MODCCW08-MODCCW)                                     23900020
         SPACE 2                                                        24150020
         AIF   ('&GEN' EQ 'QTAM').L16B                                  24170020
         TM    LCBTSOB,LCB2741N         THIS A 2741                 TSO 24250020
         BO    NOSWITCH                 USED LEASED CODE                24300020
         TM    LCBSTICS,C5041           1050/2741 LINE?             TSO 24350020
         BO    SPEC41                   YES. PUT UP SPECIAL CCWS    TSO 24400020
.L16B    ANOP                                                           24420020
         TM    LCBSTICS+1,CAUDIO        AUDIO                           24450020
         BNZ   NOSWITCH                 NO                              24500020
         EJECT                                                          24700020
.L16     ANOP                                                           24750020
* C O N N E C T I O N    P R E V I O U S L Y    D O N E                 24800020
         SPACE 1                                                        24850020
CONNECT  EQU   *                                                        24900020
         AIF   ('&GEN' NE '').L17                                       24950020
         TM    LCBSTICS+1,CBISYNC       BY SYNC LINE                    25000020
         BZ    NOTBSCD                                                  25050020
.L17     ANOP                                                           25100020
         AIF   ('&GEN' EQ 'STSP').L18                                   25150020
         AIF   ('&GEN' EQ 'QTAM').L18                                   25170020
         L     RWKA,LCBSCBA-1           GET SCB ADDRESS                 25200020
         USING IEDQSCB,RWKA                                             25250020
         TM    SCBBSCFM,SCBNOEOT .      DID WE SEND A MSG        S21101 25300020
         BO    SENDEOT                  BR IF NOT               SA59034 25350005
         OI    SCBBSCFM,SCBNOEOT        SET RECEIPT OF EOT AS   SA59034 25380005
*                                         PENDING               SA59034 25410005
         BALR  RLNK1,REXPND             BUILD READ ENQ                  25450020
         DC    AL2(MODCCW17-MODCCW)                                     25500020
SENDEOT  EQU   *                                                        25550020
         DROP RWKA                                                      25600020
         BALR  RLNK1,REXPND             GO TO EXPAND RTNE               25650020
         DC    AL2(MODCCW16-MODCCW)                                     25700020
.L18     ANOP                                                           25750020
         AIF   ('&GEN' EQ 'BISC').L10                                   25800020
NOTBSCD  EQU   *                                                        25850020
         TM    LCBSTICS+1,CTWX          TWX                             25900020
         BZ    NOSWITCH                 NO                              25950020
         AIF   ('&GEN' EQ 'QTAM').L18A                           A44890 25953021
         TM    LCBTSOB,LCBINHBN    INHIBITS TO BE DONE             TSO  25957020
         BZ    NOTWIN .                 BRANCH NO                       25964020
*                                                                       25971020
         BALR  RLNK1,REXPND                                             25978020
         DC    AL2(MODCCW19-MODCCW)                                     25985020
NOTWIN   EQU   *                                                        25992020
.L18A    ANOP                                                    A44890 25996021
         BALR  RLNK1,REXPND             LINK TO EXPAND                  26000020
         DC    AL2(MODCCW18-MODCCW)                                     26050020
.L10     ANOP                                                           26100020
         SPACE 5                                                        26150020
********       L E A S E D    L I N E S      ********                   26200020
         SPACE 2                                                        26250020
NOSWITCH EQU   *                                                        26300020
         TM    LCBSTICS+1,CCONTENT      CONTENTION                      26350020
         BO    CONTT                                                    26400020
         AIF   ('&GEN' EQ 'BISC').Z4                                    26420020
         TM    LCBSTICS+1,CLOCAL+CAUDIO  LOCAL OR AUDIO                 26450020
         AIF   ('&GEN' NE 'MINI').Z3                                    26460020
         BZ    TRSTCTL                                                  26470020
         AGO   .M4                                                      26480020
.Z3      ANOP                                                           26490020
         BZ    NOLOC                    NO                              26500020
         BAL   RWKB,ILIST               GET ILIST ADDRESS               26600020
         CLI   IDLOC+1(RWKC),0          CPU ID FOR AUDIO                26650020
         BE    NOIDAUD                  NONE SPECIFIED                  26700020
         SPACE                                                          26750020
         BALR  RLNK1,REXPND             LINK TO EXPAND                  26800020
         DC    AL2(MODCCW63-MODCCW)                                     26850020
NOIDAUD  EQU   *                                                        26900005
         TM    LCBSTICS,C3270           3270 DEVICE?             S99228 26910005
         BZ    NOC3270                  BRANCH NO                S99228 26915005
         TM    LCBSTICS+ONE,CLOCAL      LOCAL DEVICE?            S99228 26920005
         BZ    NOC3270                  BRANCH NO                S99228 26925005
         LA    RCCW,LCBCPA+16           SET CCW ADDR             S99228 26930005
         BALR  RLNK1,REXPND             LINK TO EXPAND           S99228 26935005
         DC    AL2(MODCCW73-MODCCW)     3270 LOCAL READ CH PGM   S99228 26940005
NOC3270  EQU   *                                                 S99228 26945005
         AIF   ('&GEN' EQ 'QTAM').M4                           @YA03846 26950056
         TM    LCBTSOB,LCBTSBUF .       IS THIS A TSO LINE          TSO 26955005
         BZ    NOSW1 .                  BRANCH NO                   TSO 26960005
         MVC   LCBSTART,LCBLSPCI .      START READ ON BUFFER        TSO 26965005
NOSW1    EQU   *                                                        26970005
.M4      ANOP                                                           26972056
         BALR  RLNK1,REXPND             LINK TO EXPAND                  26975005
         DC    AL2(MODCCW64-MODCCW)                                     26980005
         AIF   ('&GEN' EQ 'MINI').Z5                                    26985005
NOLOC    EQU   *                                                        26990005
.Z4      ANOP                                                           26995005
         BAL   RWKB,GLCBXA              LOCATE LCB EXTENSION     S99228 27005005
         TM    LCBXFLAG,LCBGPCTV        GENERAL POLL IN PROGRESS?S99228 27010005
         BO    SAMESET                  YES, NO RESET ACK CNTR   S99228 27015005
         OI    LCBMSGFM,LCBACKI         FIRST ACK ON P MPT IC OD S99228 27020005
SAMESET  EQU   *                                                 S99228 27025005
         BAL   RWKB,ILIST               LOCATE INVITATION LIST   S99228 27035005
         AIF   ('&GEN' EQ 'QTAM').L446                           S22028 27040005
         AIF   ('&GEN' EQ 'BISC').L446                           S22028 27045005
         L     RWKA,TRMDESTQ-1          GET ADDRESS OF QCB       S22028 27050005
         TM    QCBFLAG-IEDQQCB(RWKA),QCBTSSES IS THIS TSO SESSIONS22028 27055005
         BZ    AUTOPOLL                 BRANCH ON NO             S22028 27060005
         TM    LCBSTICS+2,CNOIDLES      IS THIS 2260 REMOTE         TSO 27065005
         BO    CHKRESTR                 BRANCH ON YES         S22028TSO 27070005
         TM    LCBSTICS,C3270           IS THIS A 3270 TERM   S22028TSO 27075005
         BZ    AUTOPOLL                 BRANCH ON NO             S22028 27080005
         TM    LCBSTICS+1,CBISYNC       IS THIS A 3270 REMOTE    S22028 27085005
         BZ    AUTOPOLL                 BRANCH ON NO             S22028 27090005
         BAL   RWKB,GLCBXA              LOCATE LCB EXTENSION     S99228 27095005
         TM    LCBXFLAG,LCBERPND        SOH%R PENDING?           S99228 27100005
         BO    AUTOPOLL                 BRANCH YES               S99228 27105005
         L     RWKA,TRMDESTQ-ONE        RESTORE DEST QCB ADDR    S99228 27110005
CHKRESTR EQU   *                                                 S22028 27115005
         CLI   LCBTPCD+11,X'BE'         IS START MI TO BE SENT   S22028 27120005
         BE    SNDSMI                   BRANCH ON YES            S22028 27125005
         TM    QCBTSOF2-IEDQQCB(RWKA),QCBDSSMI HAS START MI GONE S22028 27130005
         BO    AUTOPOLL                 YES, BRANCH              S22028 27135005
         MVI   LCBTPCD+11,X'BE'         SET TP CODE FOR SMI         TSO 27140005
         TM    LCBSTICS,C3270           IS THIS A 3270 TERM   S22028TSO 27145005
         BO    WRADD327                 BRANCH ON YES         S22028TSO 27150005
         BALR  RLNK1,REXPND             GO TO EXPAND ROUTINE        TSO 27155005
         DC    AL2(MODCCW51-MODCCW)                                 TSO 27160005
         BR    R2                       RETURN                      TSO 27165005
WRADD327 EQU   *                                              S22028TSO 27170005
         MVI   LCBMSGFM,AVTEZERO        RESET ACK COUNTER     S22028TSO 27175005
         BALR  RLNK1,REXPND             GO TO EXPAND ROUTINE  S22028TSO 27180005
         DC    AL2(MODCCW44-MODCCW)                           S22028TSO 27185005
SNDSMI   EQU   *                        TSO                             27190005
         TM    QCBTSOF2-IEDQQCB(RWKA),QCBDSSMI HAS WCC BEEN SENT S22028 27195005
         BO    CHK3270R                 YES, BRANCH              S22028 27200056
SNDSMI1  EQU   *                                                 S22028 27201056
         OI    QCBTSOF2-IEDQQCB(RWKA),QCBDSSMI SET START MI SENT    TSO 27205056
         TM    LCBSTICS,C3270           IS THIS A 3270 TERM     S22028  27206056
         BO    SNDRESTR                 BRANCH ON YES         S22028TSO 27207056
         MVI   LCBTPCD+11,AVTEZERO      RESET TP CODE               TSO 27208056
         BALR  RLNK1,REXPND             GO TO EXPAND ROUTINE        TSO 27209056
         DC    AL2(MODCCW90-MODCCW)                                 TSO 27210056
SNDRESTR EQU   *                                              S22028TSO 27211056
         L     RLNK1,DCBSCTAD-1         ADDR SP. CHAR. TABLE   @OZ09276 27211500
         SR    RWKB,RWKB                CLEAR WORK REGISTER    @OZ09276 27212000
         IC    RWKB,0(RLNK1)            PICK UP EOT OFFSET     @OZ09276 27217000
         AR    RLNK1,RWKB               POINT TO EOT ENTRY     @OZ09276 27222000
         CLI   ONE(RLNK1),ASCIIEOT      IS IT 3270 ASCII       @OZ09276 27227000
         BNE   EBCDWCC                  NO, MUST BE EBCDIC     @OZ26670 27236000
         OI    LCBTPCD+11,X'01'         INDICATE ASCII         @SA71925 27246056
EBCDWCC  EQU   *                                               @SA71925 27247056
         CLI   QCBSATCT-IEDQQCB(RWKA),ZERO IS THIS LINE ZERO    SA68050 27260005
         BNE   SNDREST1                 NO, BRANCH              SA68050 27265005
         BALR  RLNK1,REXPND             GO TO EXPAND ROUTINE    SA68050 27270005
         DC    AL2(MODCCW93-MODCCW)                             SA68050 27275005
         BR    R2                       RETURN                  SA68050 27280005
SNDREST1 EQU   *                                                SA68050 27285056
         BALR  RLNK1,REXPND             GO TO EXPAND ROUTINE  S22028TSO 27295056
         DC    AL2(MODCCW92-MODCCW)                           S22028TSO 27305056
         BR    R2                       RETURN                S22028TSO 27315056
CHK3270R EQU   *                                                 S22028 27325056
         TM    LCBSTICS,C3270           IS THIS A 3270 TERM   S22028TSO 27335056
         BZ    SNDSMI1                  NO, BRANCH               S22028 27345056
         MVI   LCBTPCD+11,AVTEZERO      RESET TP CODE            S22028 27355056
         B     AUTOPOLL                 BRANCH                   S22028 27365056
AUTOPOLL EQU   *                                                 S22028 27375056
         BAL   RWKB,ILIST               LOCATE INVITATION LIST   S22028 27385056
.L446    ANOP                                                    S22028 27395056
         TM    3(RWKC),AUTOPL           AUTO POLL IN USE         S22028 27405056
         BZ    TRSTCTL                  BRANCH NO                S22028 27415056
         L     RWKA,LCBSCBA-1 .         GET CURRENT WCB ADDRESS         27425056
         USING IEDQSCB,RWKA                                             27435056
         TM    SCBSTATE,SCBLCK1N+SCBMSGLN EXTENDED LOCK                 27445056
         BM    TRSTCTL .                BRANCH YES, DON'T WANT A        27455056
*                                         DIFFERENT SOURCE TERMINAL     27465056
         DROP  RWKA                                                     27475056
* A U T O P O L L    L I N E                                            27485056
         SPACE 1                                                        27495056
         BAL   RWKB,GLCBXA              LOCATE LCB EXTENSION     S99228 27505056
         TM    LCBXFLAG,LCBERPND        SOH%R MESSAGE PENDING?   S99228 27515056
         BO    GETSOHR                  BRANCH YES               S99228 27525056
         TM    LCBXFLAG,LCBGPCTV        GENERAL POLL IN PROGRESS?S99228 27535056
         BZ    AUTOREG                  BRANCH NO                S99228 27545056
GETSOHR  EQU   *                                                 S99228 27555056
         NI    LCBXFLAG,LCBGPSTP        RESET GENERAL POLL INDIC S99228 27565056
         BALR  RLNK1,REXPND             BRANCH TO EXPAND ROUTINE S99228 27575056
         DC    AL2(MODCCW28-MODCCW)     GENPOLL READ INIT OFFSET S99228 27585056
AUTOREG  EQU   *                                                 S99228 27595056
.L423    ANOP                                                    S99228 27605056
         BALR  RLNK1,REXPND             GO TO EXPAND RTNE               27615056
         DC    AL2(MODCCW26-MODCCW)                                     27625056
         SPACE 2                                                        27635056
         SPACE 2                                                        27645056
.Z5      ANOP                                                           27655056
* L O C A L    D E V I C E                                              27665056
         SPACE 1                                                        27675056
* C O N T E N T I O N    L I N E                                        27685056
         SPACE 1                                                        27695056
CONTT    EQU   *                                               @OZ14183 27700000
*                                       LEASED+DIALWITH ENABLE AND      27705000
*                                         DIAL REQUESTS.                27715056
         L     RWKA,TRMDESTQ-1          GET ADDR OF DEST QCB   @OZ14183 27715600
         TM    QCBFLAG-IEDQQCB(RWKA),QCBTSSES IS IT TSO SESSION@OZ14183 27716200
         BO    GORCV                    BRANCH YES-CONTINUE RCV@OZ14183 27716800
         TM    LCBSTAT1,LCBOCNI         STOPLINE IN PROGRESS   @OZ14183 27717400
         BO    GOSEND                   BRANCH YES             @OZ14183 27718000
         TM    LCBSTAT2,LCBSNDPR        SEND SCH WANT LINE?    @OZ14183 27718600
         BZ    GORCV                    BRANCH-NO              @OZ14183 27719200
GOSEND   EQU   *                                               @OZ14183 27719800
         MVC   LCBQCBA(THREE),AVTBSCAN+1 SET BD ADDRESS        @OZ14183 27720400
         MVI   LCBPRI,PRIFSPCI-1        SET CLEANUP PRIORITY   @OZ14183 27721000
         NI    LCBSTAT2,AVTEFF-LCBSNDPR CLEAR SEND SCHED BIT   @OS79864 27721300
         LR    RPARM,RLCB                                      @OZ14183 27721600
         L     RSUPBASE,AVTEA                                  @OZ14183 27722200
         BAL   REXPND,DSPPOST           GO END SEND OPERATION  @Y17XAIX 27722800
GORCV    EQU   *                                               @OZ14183 27723400
         AIF   ('&GEN' EQ 'BISC').L19                                   27725056
         AIF   ('&GEN' EQ 'STSP').L20                                   27735056
         AIF   ('&GEN' EQ 'MINI').L21                                   28050020
         AIF   ('&GEN' EQ 'QTAM').L20                            A48245 28070022
         TM    LCBSTICS+1,CBISYNC       BSC DEVICE                      28100020
         BZ    NOTBSC                   NO                              28150020
.L19     ANOP                                                           28200020
         L     RWKA,LCBSCBA-1           GET SCB PTR            @XA08073 28203058
         USING IEDQSCB,RWKA                                    @XA08073 28206058
         TM    SCBBSCFM,SCBNOEOT        SEND PRI W MASTER=YES? @XA08073 28209058
         BNO   NORMAL                   NO, FORGET EOT BUILD   @XA08073 28212058
         NI    SCBBSCFM,AVTEFF-SCBNOEOT RESET EOT BIT          @XA08073 28215058
         DROP  RWKA                                            @XA08073 28218058
         LA    RCCW,LCBCPA              ADDR OF CHANNEL PROGRAM@OX14790 28221000
         ST    RCCW,LCBSTART-1          SAVE FOR SIO           @XA08073 28224058
         LA    RTPCDE,LCBTPCD           TP OP CODE ADDRESS     @OX14790 28227000
         BALR  RLNK1,REXPND             GO TO EXPAND RTNE      @XA08073 28230058
         DC    AL2(MODCCW75-MODCCW)                            @XA08073 28233058
NORMAL   EQU   *                                               @XA08073 28236058
         BALR  RLNK1,REXPND             GO TO EXPAND RTNE               28250020
         DC    AL2(MODCCW22-MODCCW)                                     28300020
         AIF   ('&GEN' EQ 'BISC').L22                                   28350020
NOTBSC   EQU   *                                                        28400020
.L20     ANOP                                                           28450020
         TM    LCBTSOB,LCB2741N         2741 TERM?                  TSO 28550020
         BZ    TRY2                                                 TSO 28600020
         AIF   ('&GEN' EQ 'QTAM').L201                           A48245 28605022
         TM    LCBTSOB,LCBTSBUF         TSO IN CONTROL                  28610020
         BZ    ITSTCAM                  BRANCH IF NO                    28620020
         SPACE                                                          28630020
         CLI   LCBTPCD+11,X'AB'         FIRST TIME                  TSO 28650020
         BNE   NORM41                   SEND EOT NOW                TSO 28700020
         MVI   LCBTPCD+11,0             CLEAR FIRST TIME INDIC      TSO 28750020
         BALR  RLNK1,REXPND                                         TSO 28800020
         DC    AL2(MODCCW54-MODCCW)                                 TSO 28850020
         SPACE                                                          28900020
NORM41   EQU   *                                                    TSO 28950020
         BALR  RLNK1,REXPND                                         TSO 29000020
         DC    AL2(MODCCW52-MODCCW)                                 TSO 29050020
.L201    ANOP                                                    A48245 29052022
ITSTCAM  EQU   *                                                        29055020
         CLI   LCBTPCD+11,X'AB'         FIRST TIME                      29060020
         BNE   NOTFIRST                 BRANCH NO                       29065020
         MVI   LCBTPCD+11,0             RESET FIRST TIME SWITCH         29070020
         LA    RCCW,LCBCPA              START OF CHANNEL PROG  @OZ28818 29075086
         ST    RCCW,LCBSTART-1          SAVE FOR SIO           @OZ28818 29076086
         LA    RTPCDE,LCBTPCD           TP OP CODE             @OZ28818 29077086
         BALR  RLNK1,REXPND             LINK TO EXPAND ROUTINE @OZ28818 29078086
         DC    AL2(MODCCW75-MODCCW)                            @OZ28818 29079086
NOTFIRST EQU   *                                                        29085020
         BALR  RLNK1,REXPND             LINK TO EXPAND                  29090020
         DC    AL2(MODCCW20-MODCCW)                                     29095020
         SPACE                                                          29100020
TRY2     EQU   *                                                    TSO 29150020
.L21     ANOP                                                           29170020
         TM    LCBSTICS+2,CWTTA         WTTA                            29200020
         BZ    NOTWTTA                  NO                              29250020
         BALR  RLNK1,REXPND             LINK TO EXPND                   29300020
         DC    AL2(MODCCW21-MODCCW)                                     29350020
NOTWTTA  EQU   *                                                        29400020
         BALR  RLNK1,REXPND             GO TO EXPAND RTNE               29500020
         DC    AL2(MODCCW20-MODCCW)                                     29550020
.L22     ANOP                                                           29600020
         SPACE 2                                                        29650020
* T R A N S    O R    S T A T I O N    C T R L                          29700020
         SPACE 1                                                        29750020
TRSTCTL  EQU   *                        STNCTL+DIAL LINE WITH ENAB      29800020
*                                         AND DIAL REQUESTS             29850020
         AIF   ('&GEN' EQ 'MINI').L22A                                  29850620
         AIF   ('&GEN' EQ 'QTAM').L22A                                  29851620
         AIF   ('&GEN' EQ 'BISC').L22A                                  29851822
CHK50HBN TM    LCBTSOB,LCBINHBN         ARE INHIBITS BEING USED     TSO 29893022
         BZ    STCTLC                   BRANCH ON NO                TSO 29893122
         BALR  RLNK1,REXPND             GO TO EXPAND ROUTINE        TSO 29893220
         DC    AL2(MODCCW91-MODCCW)                                 TSO 29893620
STCTLC   EQU   *                                                    TSO 29894020
.L22A    ANOP                                                           29897020
         AIF   ('&GEN' EQ 'MINI').L433                         @YA03846 29897556
         BAL   RWKB,GLCBXA              LOCATE LCB EXTENSION     S99228 29898122
         NI    LCBXFLAG,LCBGPSTP        RESET GENERAL POLL INDIC S99228 29898722
.L433    ANOP                                                    S99228 29899722
         BALR  RLNK1,REXPND             GO TO EXPAND RTNE               29900020
         DC    AL2(MODCCW28-MODCCW)                                     29950020
         SPACE                                                          30000020
         AIF   ('&GEN' EQ 'MINI').LE                                    30050020
         AIF   ('&GEN' EQ 'BISC').LE                                    30100020
         AIF   ('&GEN' EQ 'QTAM').LE                                    30120020
SPEC41   EQU   *                                                    TSO 30150020
         MVC   LCBSTICS,D41STICS        RESET CH'STICS              TSO 30200020
         MVI   LCBTPCD+10,X'AE'         SPECIAL CHECK INDICATOR     TSO 30250020
         BALR  RLNK1,REXPND             BUILD CCW'S                 TSO 30300020
         DC    AL2(MODCCW70-MODCCW)                                 TSO 30350020
.LE      ANOP                                                           30400020
         EJECT                                                          30450020
*                                                                       30500020
*                                                                       30550020
*        R E A D  C O N T I N U E   L O G I C                           30600020
*                                                                       30650020
*                                                                       30700020
         SPACE 3                                                        30750020
CONTINUE EQU   *                                                        30800020
         XI    LCBSTAT1,LCBCONT         RESET CONTINUE INDICATOR        30850020
         NI    LCBSTAT2,AVTEFF-LCBRESP  RESET RESPONSE BIT              30900020
         L     RWKA,LCBCPA+12           OCNINUTE CCW                    30950020
         MVC   0(8,RWKA),LCBCPA+16      REBUILD BUFFER CCW              31000020
         NI    CCWFLAGS-CCW(RWKA),AVTEFF-CCWSLI SWITCH FOR LINE END     31010020
*                                       UNIT HAS WRAPPED VIA PCI        31020020
         LA    RCCW,LCBCPA+16           CONTINUE POINT                  31050020
         LA    RTPCDE,LCBTPCD+2         TP OP CODE BASE                 31100020
         NI    LCBMSGFM,LCBNAK+LCBACKI+LCBEOT+LCBOLT RESET FLAGS S22025 31150022
         TM    LCBCHAIN,LCBABRTN        ABORT REQUEST                   31200020
         BZ    NOABORT                  NO                              31250020
         AIF   ('&GEN' EQ 'BISC').L80                                   31257020
         L     RWKA,DCBSCTAD-1          GET SCT ADDRESS                 31264020
         CLI   AVTEZERO(RWKA),AVTEZERO  EOT SEQUENCE DEFINED            31271020
         BE    ABRTEXIT                 BRANCH IF NO                    31278020
         SPACE                                                          31285020
.L80     ANOP                                                           31292020
         L     RWKA,LCBSCBA-1           CURRENT SCB                     31292205
         USING IEDQSCB,RWKA             SCB REGISTER            SA59034 31292451
         NI    SCBBSCFM,AVTEFF-SCBNOEOT RESET EOT FLAG          SA59034 31292605
         AIF   ('&GEN' NE '' AND '&GEN' NE 'BISC').L80A          S22025 31293022
         TM    LCBMSGFM,LCBEOT .        RVI REQUEST              S22025 31294022
         BO    NOABORT                  BRANCH YES               S22025 31295022
.L80A    ANOP                                                    S22025 31296022
         BALR  RLNK1,REXPND             BUILD SEQUENCE                  31300020
         DC    AL2(MODCCW72-MODCCW)                                     31350020
         BR    R2                       RETURN                          31400020
         SPACE                                                          31450020
NOABORT  EQU   *                                                        31500020
         TM    LCBSTATE,LCBRECVN        READ CONTINUE                   31550020
         BZ    SEND                     NO WRITE CONTINUE               31600020
         SPACE                                                          31650020
         AIF   ('&GEN' NE '').L23                                       31700020
         TM    LCBSTAT2,LCBSYNC         BSC LINE                        31750020
         BZ    NOBSC1                   NO                              31800020
.L23     ANOP                                                           31850020
         AIF   ('&GEN' EQ 'MINI').L24                                   31900020
         AIF   ('&GEN' EQ 'STSP').L24                                   31950020
         AIF   ('&GEN' EQ 'QTAM').L24                                   31970020
         SPACE                                                          32000020
         L     RWKA,LCBSCBA-1           CURRENT SCB                     32050020
         TM    SCBBSCFM,SCBTRNSP+SCBNONTR TYPE MSG DETERMINED YETS21101 32150020
         BZ    NOBSC1                   BRANCH NO DONT KNOW FORMAT      32200020
         L     RWKB,DCBDEBAD            DEB ADDRESS              X02004 32250005
         L     RWKB,DEBAPPAD-DEBNMSUB(,RWKB) VECTOR TABLE        X02004 32253005
         L     RWKC,TRMDESTQ-1  .       PICKUP DEST QCB          S22029 32256022
         DROP  RWKC                                              S99228 32262022
         USING IEDQQCB,RWKC                                      S22029 32268022
         TM    QCBDSFLG,QCBALTMH        IS TERMINAL CONNECTED TO S22029 32274022
*                                       AN ALTERNATE MH          S22029 32277022
         BZ    NOALTMH                  NO - USE OWNING MH LC    S22029 32280022
         LA    RWKB,ONE(,RWKB)          USE ALTERNATE MH         X02004 32283005
         DROP  RWKC                                                     32286022
NOALTMH  EQU   *                        TEST FOR LC=IN OR OUT    S22029 32289022
         USING IEDQLCBX,RWKC            LCB EXTENSION ADDR       S99228 32292022
         TM    0(RWKB),LCIN             IS LC=IN SPECIFIED       X02004 32300005
         BZ    ITSLCOUT                 NO                              32350020
         TM    SCBBSCFM,SCBTRNSP .      RECEIVEING TRANSPARNET   S21101 32400020
         BZ    NOBSC1                   NO, IT'S LCIN                   32450020
         DROP  RWKA                                                     32500020
         SPACE                                                          32550020
ITSLCOUT EQU   *                                                        32600020
         BALR  RLNK1,REXPND             GO TO EXPAND                    32650020
         DC    AL2(MODCCW45-MODCCW)                                     32700020
.L24     ANOP                                                           32750020
NOBSC1   EQU   *                                                        32800020
         AIF   ('&GEN' EQ 'BISC').Z6                                    32820020
         TM    LCBSTICS+2,CCHECK        CHECKING                        32850020
         BNZ   TESTCONT                 YES                             32900020
ABRTEXIT EQU   *                                                        32920020
         OI    LCBCSW+3,UNEX            INDICATE NO RESTART             32950020
         BR    R2                       RETURN                          33000020
TESTCONT EQU   *                                                        33050020
         TM    LCBSTICS+2,CCONTIN       CONINUTE POSSIBLE               33100020
         BZ    NOCONT                   NO                              33150020
.Z6      ANOP                                                           33170020
         BALR  RLNK1,REXPND                                             33200020
         DC    AL2(MODCCW46-MODCCW)                                     33250020
         SPACE                                                          33300020
NOCONT   EQU   *                                                        33350020
         BALR  RLNK1,REXPND             BUILD SEQUENCE                  33400020
         DC    AL2(MODCCW56-MODCCW)     OFFSET TO SEQUENCE              33450020
         BR    R2                       REUTRN                          33500020
SEND     EQU   *                                                        33550020
         AIF   ('&GEN' NE '').L25                                       33600020
         TM    LCBSTICS+1,CBISYNC       BSC DEVICE                      33650020
         BZ    NBS                      NO                              33700020
.L25     ANOP                                                           33750020
         AIF   ('&GEN' EQ 'STSP').L26                                   33800020
         AIF   ('&GEN' EQ 'MINI').L26                                   33850020
         AIF   ('&GEN' EQ 'QTAM').L26                                   33870020
         BALR  RLNK1,REXPND                                             33900020
         DC    AL2(MODCCW48-MODCCW)                                     33950020
         BR    R2                       RETURN                          34000020
.L26     ANOP                                                           34050020
         AIF   ('&GEN' EQ 'BISC').L27                                   34100020
NBS      EQU   *                                                        34150020
         SPACE 1                                                SA62991 34160051
         BALR  RLNK1,REXPND             BUILD CCW                       34200020
         DC    AL2(MODCCW50-MODCCW)                                     34250020
.L27     ANOP                                                           34300020
         EJECT                                                          34350020
WRRESP   EQU   *                                                        34400020
         TM    LCBSTICS+2,CCHECK        CPABLE OF RESPONSE              34450020
         BZ    EXRESP1                  NO                              34500020
         SPACE                                                          34550020
         LA    RCCW,LCBERCCW+8          RESET CCW BASE                  34600020
         ST    RCCW,LCBSTART-1          START ADDRESS                   34650020
         LA    RTPCDE,LCBTPCD+2         SET TP OP CODE BASE     SA60341 34700022
.L28     ANOP                                                           34750020
         AIF   ('&GEN' EQ 'STSP').L29                                   34800020
         AIF   ('&GEN' EQ 'MINI').L29                                   34850020
         AIF   ('&GEN' EQ 'QTAM').L29                                   34920020
         TM    LCBSTAT2,LCBSYNC         BSC                             34950020
         BNO   TESTNAK                  BR NO                   SA60341 35000022
         BAL   RWKB,GLCBXA              LOCATE LCB EXTENSION    SA60341 35006022
         TM    LCBXFLAG,LCBGPCTV        GENR'L POLL IN PROGRESS SA60341 35012022
         BO    WRACK                    BR YES                  SA60341 35018022
         TM    LCBSTICS+1,CCONTENT      CONTENTION DEVICE      @SA72446 35018658
         BNO   RESET                    NO, DO WRITE RESET     @SA72446 35019258
         TM    LCBSTAT1,LCBSENDN        SEND OPERATION         @SA72446 35019858
         BO    RESET                    YES, DO WRITE RESET    @SA72446 35020458
         LA    RCCW,LCBCPA+32           GET ADDR OF WRITE ACK  @SA72446 35021058
         ST    RCCW,LCBSTART-1          CCW TO START ON        @SA72446 35021658
         LA    RCCW,LCBCPA+16           RESET CCW BASE         @SA72446 35022258
         B     KEEPSET                  AND RETURN             @OX12562 35022800
RESET    EQU   *                                               @SA72446 35023458
         BALR  RLNK1,REXPND             GO WRITE RESET          SA60341 35024022
         DC    AL2(MODCCW72-MODCCW)     RESET MODEL CCW         SA60341 35030022
         B     EXRESP                   EXIT                    SA60341 35036022
TESTNAK  EQU   *                                                SA60341 35042022
.L29     ANOP                                                           35050020
         SPACE                                                          35100020
         TM    LCBMSGFM,LCBNAK .        REQUEST FOR NAK RESPONSE S21101 35150020
         BNZ   WRACK                    BR YES                 @SA69649 35200056
         AIF   ('&GEN' EQ 'MINI').L443                         @YA03846 35653056
         TM    LCBSTICS,CUMASK          2260 UNDER GENPOLL?      S99228 35657022
         BZ    REGRESP                  NO SEND NORMAL RESP      S99228 35664022
.L443    ANOP                                                  @SA69649 35666056
WRACK    EQU   *                                               @SA69649 35668056
         BALR  RLNK1,REXPND             LINK TO EXPAND RTN       S99228 35671022
         DC    AL2(MODCCW60-MODCCW)     EXPANDER OFFSET          S99228 35678022
         B     EXRESP                   SKIP SPECIFIC POLL CODE  S99228 35685022
REGRESP  EQU   *                                                 S99228 35692022
         TM    LCBSTICS+2,CCONTIN       1030 OR 1060 TERMINAL?  SA55925 35696522
         BZ      WRACK                  YES-BRANCH TO WRITE     SA55925 35697022
*                                        CIRCLE Y NOT CIRCLE A  SA55925 35697522
         AIF   ('&GEN' EQ 'BISC').L4R1                                  35698022
         BALR  RLNK1,REXPND             LINK TO EXPAND                  35700020
         DC    AL2(MODCCW58-MODCCW)                                     35750020
.L4R1    ANOP                                                           35800022
EXRESP   EQU   *                                                        35850020
         TM    LCBSTAT2,LCBMSGNN        MSGGEN                          35900020
         BZ    EXRESP1                  NO                              35950020
         LA    RCCW,LCBCPA              SET TO CAHNGE TIC               36000020
         OI    LCBERCCW+12,CCWCD        CHANGE FLAGS                    36050020
         ST    RCCW,LCBERCCW+16         SET IN CCW                      36100020
         MVI   LCBERCCW+16,CCWTIC       SET COMMAND CODE                36150020
         BR    R2                       RETURN DO EXCP                  36200020
EXRESP1  EQU   *                                                        36250020
         LA    RCCW,LCBCPA+16           ESET CCW BASE                   36300020
         AIF   ('&GEN' EQ 'MINI').L453                         @YA03846 36307056
         BAL   RWKB,GLCBXA              LOCATE LCB EXTENSION     S99228 36311022
         TM    LCBXFLAG,LCBGPCTV        GENERAL POLL IN PROGRESS?S99228 36315022
         BZ    INAMESS                  NO, NO SET SPEC WRITE RE S99228 36321022
         OI    LCBERCCW+12,CCWCC+CCWSLI SET FLAGS FOR NO INTRPT  S99228 36328022
         LA    RCCW,LCBCPA+32           LOAD ADDR READ RESP IN T S99228 36335022
INAMESS  EQU   *                                                 S99228 36342022
.L453    ANOP                                                    S99228 36346022
         ST    RCCW,LCBERCCW+16         SET TIC ADDRESS                 36350020
         MVI   LCBERCCW+16,CCWTIC       SET COMMAND CODE                36400020
RESPEXIT EQU   *                                               @SA72446 36420058
         LA    RTPCDE,LCBTPCD+2         RESET TP OP CODE BASE           36450020
         NI    LCBSTAT2,AVTEFF-LCBRESP  RESET                           36500020
         LR    RWKB,R0                  RETURN ADDRESS                  36550020
         BR    RWKB                     RETURN                          36600020
         EJECT                                                          36650020
*        ***************************************************            36700020
*        *                                                 *            36750020
*        *     W R I T E    I N I T I A L    L O G I C     *            36800020
*        *                                                 *            36850020
*        ***************************************************            36900020
         SPACE 3                                                        36950020
MSGGEN   EQU   *                                                        37000020
         LA    RCCW,LCBCPA+16           ADDJUST TO BYPASS MSGEN CCW     37050020
         LA    RTPCDE,LCBTPCD+2         ADJUST TP OP CODE BASE          37100020
         L     RWKA,LCBSCBA-1           GET SCB BASE            SA59034 37110005
         NI    SCBBSCFM-IEDQSCB(RWKA),AVTEFF-SCBNOEOT RESET EOT SA59034 37120005
*                                         FLAG TO FORCE ENQ     SA59034 37130005
         B     DIALTEST                 CONTINUE BUILDING               37150020
WRITINIT EQU   *                                                        37200020
         L     RLNK1,AVTRDYA            USER EXIT ROUTINE LIST  X30X5MT 37201058
         ICM   RLNK1,SEVEN,PURGEXT(RLNK1)  LOAD EXIT ROUTINE ADDX30X5MT 37202058
         BZ    NOEXIT                   NO, PROCESS NORMAL      X30X5MT 37203058
         LR    RPARM,RTERM              LOAD TERM TABLE ADDRESS X30X5MT 37204058
         STM   RLCB,RBASE,AVTSAVE3+REGSAVE   SAVE REGS          X30X5MT 37205058
         BALR  REXPND,RLNK1             BRANCH TO EXIT ROUTINE  X30X5MT 37206058
         LM    RLCB,RBASE,AVTSAVE3+REGSAVE  RESTORE REGS        X30X5MT 37207058
         LTR   RLNK1,RLNK1              WAS RETURN CODE ZERO    X30X5MT 37208058
         BZ    DONTPOST                 YES, PROCESS NORMAL     X30X5MT 37209058
         C     RLNK1,RETURN4            RETURN CODE OF 4        X30X5MT 37210058
         BNE   DONTPOST                 NO, CONTINUE NORMALLY   X30X5MT 37211058
SIMERROR EQU   *                                               @OS77867 37211500
         MVC   LCBTTCIN(2),LCBTTBIN    TERM TO BE CONNECTED     X30X5MT 37212058
         L     RWKB,LCBSCBA-1           LOAD ADDR OF SCB        X30X5MT 37213058
         USING IEDQSCB,RWKB                                     X30X5MT 37214058
         OI    SCBERR4,SCBSLCTN+SCBTRMLN  SET ON SEL ERR        X30X5MT 37215058
         DROP  RWKB                                            @OY12260 37215558
         L     RTERM,LCBERBST            ADDR OF HDR BUFFER     X30X5MT 37216058
         L     RPARM,PRFLINK-1-IEDQPRF(RTERM) GET TXT BUFFER ADDX30X5MT 37217058
LOOPTRAN LA    RPARM,0(RPARM)            CLEAR HI BYTE          X30X5MT 37218058
         LTR   RPARM,RPARM               SEE IF ANY TEXT BUFFERSX30X5MT 37219058
         BZ    TRANENDC                  BRANCH IF NOT TO FREE  X30X5MT 37220058
*                                        HEADER AS PSEUDO ZERO LX30X5MT 37221058
         LA    RWKC,AVTBFRTB             AVAIL. BFR. QCB FOR POSX30X5MT 37222058
         ST    RWKC,0(RPARM)             STORE QCB ADDRESS      X30X5MT 37223058
         MVI   PRFPRI-IEDQPRF(RPARM),PRIBFRTB  POST PRIORTY     X30X5MT 37224058
         L     RTERM,PRFLINK-1-IEDQPRF(RPARM)  SAVE NEXT TXT BUFX30X5MT 37225058
         BAL   REXPND,DSPPOSTR           FREE TEXT BUFFERS      X30X5MT 37226058
         LR    RPARM,RTERM               SET FOR NEXT TXT IF ANYX30X5MT 37227058
         B     LOOPTRAN                  GO FREE IF PRESENT     X30X5MT 37228058
TRANENDC EQU   *                                                X30X5MT 37229058
         L     RPARM,LCBERBST          ADDRESS OF BUFFER        X30X5MT 37230058
         STCM  RPARM,SEVEN,LCBLSPCI    SET LAST BUFFER SERVICED X30X5MT 37231058
         SR    RWKB,RWKB               CLEAR REGISTER           X30X5MT 37232058
         STCM  RWKB,SEVEN,LCBERBCH     SET ZERO ADDRESS         X30X5MT 37233058
         STH   RWKB,PRFSIZE-IEDQPRF(RPARM)  STORE ZERO LENGTH   X30X5MT 37234058
         NI    PRFSTAT1-IEDQPRF(RPARM),PRFNLSTF MARK IT LAST    X30X5MT 37235058
         MVI   PRFPRI-IEDQPRF(RPARM),PRIMHBFR  P3ST PRIORITY    X30X5MT 37236058
         L     RWKB,DCBMH-1            GET MH QCB ADDR FOR POST X30X5MT 37237058
         STCM  RWKB,7,PRFQCBA-IEDQPRF(RPARM)  SET POST ADDR    @G36XRYP 37238000
         BAL   REXPND,DSPPOST          POST BUFFER TO MH       @Y17XAIX 37239000
DONTPOST EQU   *                                                X30X5MT 37240058
         LA    REXPND,EXPAND           SET UP LINK FOR EXPAND   X30X5MT 37241058
NOEXIT   EQU   *                                                X30X5MT 37242058
         TM    LCBSTAT2,LCBDIAL         DIAL LINE              @OS77867 37242600
         BZ    NODIAL                   BRANCH-NO              @OS77867 37243200
         CLI   LCBTSTSW,AVTEFF          REQUEST FOR DIALUP     @OS77867 37243800
         BNE   NODIAL                   BRANCH-NO              @OS77867 37244400
         L     RWKA,TRMDESTQ-1          GET QCB ADDRESS        @OS77867 37245000
         CLI   QCBSTPRI-IEDQQCB(RWKA),CALLOPT CLOCK OR CINTVL  @OS77867 37245600
         BL    NODIAL                   BRANCH-NO              @OS77867 37246200
         L     RWKA,DCBDEBAD            GET DEB ADDRESS        @OX16705 37246300
         USING DEBTCBAD,RWKA            ADDRESSABILTIY         @OX16705 37246400
         TM    DEBOPATB,OUTONLY         OUTPUT ONLY DEVICE?    @OX16705 37246500
         BO    NODIAL                   BRANCH IF YES-DIAL     @OX16705 37246600
         L     RWKA,LCBSCBA-1           GET SCB ADDRESS        @OS77867 37246800
         OI    SCBERR4-IEDQSCB(RWKA),SCBCONNN SET DIAL ERROR   @OS77867 37247400
         B     SIMERROR                 GO SIMULATE OUTPUT ERR @OS77867 37248000
NODIAL   EQU   *                                               @OS77867 37248600
         LA    RCCW,LCBCPA              SET CCW BASE                    37250020
         LA    RTPCDE,LCBTPCD           TP OP CODE AREA                 37300020
         BALR  RLNK1,REXPND             GO TO EXPAND ROUTINE            37350020
         DC    AL2(MODCCW30-MODCCW)                                     37400020
*              TIC (WRITE IDLES)                                        37450020
         LA    RWKA,LCBCPA              DATA DDRESS FOR TIC             37500020
         ST    RWKA,LCBCPA+8            SAVE IN TIC COMMAND             37550020
         MVI   LCBCPA+8,CCWTIC          TIC OP CODE                     37600020
         LA    RTPCDE,ONE(R0,RTPCDE)    BUMP TP REGISTER                37650020
         LA    RCCW,EIGHT(R0,RCCW)      BUMP CCW BASE                   37700020
         MVI   LCBCPA+12,FLAG           FLAG INDICATES WHICH WRITE      37750020
*                                       IDLES TO USE AFTER CONTACT      37800020
DIALTEST EQU   *                                                        37850020
         AIF   ('&GEN' NE '' AND '&GEN' NE 'BISC').Z66A          S21101 37860020
*                                                                S21101 37870020
*        SCBNOEOT IS SET FOR BSC DIAL LINE WITH SEND PRIORITY BY S21101 37880020
* LINE END APPENDAGE ON OUTPUT AND BY SEND SCHEDULER WHEN BYPASSIS21101 37890020
* CONTROL TO RECEIVE SCHEDULER (ALTERNATE SEND AND RECEIVE ON BSCS21101 37892020
* DIAL LINE.  WHENEVER AN EOT IS TRANSMITTED ON A BSC LDIAL LINE S21101 37894020
* LINE MUST BE MONITORED FOR A RECEVE OPERATION.  FOR SEND PRIORIS21101 37896020
* AN EOT IS NOT SENT AT THE END OF A MESSAGE IN ORDER TO FLUSH THS21101 37898020
* OUTPUT QUEUE.  THE TERMINAL IS STILL IN TEXT MODE AND THE ACK  S21101 37898420
* COUNTER MUST NOT BE RESET.   THIS HAS A BEARING ON THE WRITE   S21101 37898820
* INITIAL CONTACT  CHANNEL PROGRAM.  THERE IS NO LINE BID        S21101 37899220
* REQUIRED.  THE CHANNEL PROGRAM WILL START ON THE WRITE ESCAPE  S21101 37899620
* SEQUENCE OR ON THEWRITE IDLES LOOP.  SCBNOEOT IS RESET IN THIS S21101 37899720
* MODULE ON A DISABLE OR BY ERP OR LINE END .  ERP OR LINE END WIS21101 37899820
* RESET THE BIT ON A TCAM OR DEVICE ABORT (I. E. AN EOT WAS SENT S21101 37899920
* OR RECEVIED.)                                                  S21101 37916620
*                                                                S21101 37926620
         NI    LCBMSGFM,LCBACKI .       RESET FORMAT BITS EXCEPT S21101 37928620
*                                         ACK COUNTER            S21101 37930620
         L     RWKA,LCBSCBA-1 .         GET SCB BASE             S21101 37932620
         USING IEDQSCB,RWKA .                                    S21101 37933020
         TM    SCBBSCFM,SCBNOEOT .      BSC DIAL SEND PRIORITY INS21101 37933120
*                                         TEXT MODE              S21101 37933220
         DROP  RWKA .                                            S21101 37938820
         BO    LETACK .                 BRANCH IF YES            S21101 37940820
         MVI   LCBMSGFM,AVTEZERO .      RESET FORMAT BITS AND ACKS21101 37942820
*                                         COUNTER                S21101 37943220
LETACK   EQU   *                                                 S21101 37943620
.Z66A    ANOP                                                    S21101 37943858
         TM    LCBSTAT2,LCBMSGNN        MSGGEN                 @OY12395 37944058
         BO    NOTMSG1                  YES,BRANCH             @OY12395 37945058
         NI    LCBSTAT2,AVTEFF-LCBNEGRP POLL TERM ONE MORE TIME@OY12395 37946058
NOTMSG1  EQU   *                                               @OY12395 37947058
         TM    LCBSTAT2,LCBRESP         OWE A RESPONSE                  37948058
         BZ    NORP                     NO                              37950020
         SPACE                                                          38000020
         AIF   ('&GEN' EQ 'MINI').Z15XX                                 38048020
         AIF   ('&GEN' EQ 'QTAM').Z15XX                                 38048420
         AIF   ('&GEN' EQ 'BISC').Z15XX                                 38048820
         TM    LCBTSOB,LCBTSBUF         IS THIS TIME SHARING BUFFER TSO 38049220
         BO    SNDRSP                   BRANCH ON YES               TSO 38049620
.Z15XX   ANOP                                                           38049720
         CLC   LCBTTBIN,LCBTTCIN        SAME TERMINAL                   38050020
         BE    OWERSP                   YES                             38100020
         SPACE                                                          38150020
SNDRSP   EQU   *                                                        38160020
         TM    LCBSTAT2,LCBMSGNN        MSGGEN                          38200020
         BNZ   OWERSP                   YES                             38250020
SNDRSP1  EQU   *                                                SA55925 38270022
         BAL   R0,WRRESP                BUILD RESPO55SE                 38300020
         MVI   LCBERCCW+12,FLAG         ONLY SLI FLAG            X02004 38310005
         B     NORP                     RESUME CHANNEL PROG BUILD       38350020
         SPACE                                                          38400020
OWERSP   EQU   *                                                        38500020
         AIF   ('&GEN' NE '' AND '&GEN' NE 'BISC').L32         @OY14092 38550000
         OI    LCBMSGFM,LCBACKI .       FIRST CONVERSATIONAL REPLS21101 38560020
*                                         IS ODD ACK             S21101 38570020
         TM    LCBSTAT2,LCBSYNC         BSC                             38600020
         BNZ   STIDLES                  BRANCH YES                      38650020
.L32     ANOP                                                           38700020
         TM    LCBSTICS+2,CNOIDLES      IS THIS 2260 REMOTE             38710020
         BO    TSMSGN                   BRANCH ON YES                   38720020
         TM    LCBSTICS+2,C2760         2760                            38750020
         BO    STIDLES                  YES, START ON DILESOR MSGGEN    38800020
         SPACE                                                          38850020
         TM    LCBSTICS+2,CCONTIN       CAPABLE OF RESPONS              39000020
         BZ    SNDRSP1                  BRANCH IF NOT           SA55925 39050022
         BALR  RLNK1,REXPND             WR EOA AND TIC                  39100020
         DC    AL2(MODCCW62-MODCCW)                                     39150020
         SPACE                                                          39250020
.Z15     ANOP                                                           39270020
         AIF   ('&GEN' EQ 'MINI').L35                                   39300020
NORP     EQU   *                                                        39350020
         TM    LCBSTAT2,LCBDIAL         DIAL LINE                       39450020
         BZ    WRLSD                    NO, LEASED LINE                 39500020
         SPACE 3                                                        39550020
********       D I A L    L I N E S      ********                       39600020
         SPACE 2                                                        39650020
         CLI   LCBTSTSW,AVTEFF          THIS A DIAL UP REQUEST          39700020
         MVI   LCBTSTSW,F0              RESET FOR SUBSEQUENT SNED       39750020
         AIF   ('&GEN' NE 'BISC').LI2A                                  39800020
         BNE   WRLSD                                                    39850020
         AGO   .LI1                                                     39900020
.LI2A    ANOP                                                           39950020
         BNE   NODIALUP                 NO                              40000020
         AIF   ('&GEN' EQ 'BISC').LI1                                   40050020
         AIF   ('&GEN' NE '').LI2                                       40100020
         TM    LCBSTAT2,LCBSYNC        BSC LINE                         40150020
         BZ    NOSYNC                  NO                               40200020
.LI1     ANOP                                                           40250020
         L     RWKA,LCBSCBA-1 .         GET SCB POINTER          S21101 40260020
         USING IEDQSCB,RWKA .                                    S21101 40270020
         NI    SCBBSCFM,AVTEFF-SCBNOEOT RESET EOT FLAG           S21101 40280020
         DROP  RWKA .                                            S21101 40290020
         MVI   LCBMSGFM,AVTEZERO .      RESET ALL BITS           S21101 40290520
         TM    LCBTPCD+11,DISDLEOT .    WRITE DLE EOT            S21101 40291020
         BO    GODLEEOT .               YES                      S21101 40291520
         OI    LCBTPCD+11,DISDLEOT      SET FOR THE NEXT TIME   SA53632 40291622
*                                         SO AS TO WRITE ABORT  SA53632 40291722
*                                         SEQUENCE BEFORE DISAB SA53632 40291822
         LA    RTPCDE,ONE(,RTPCDE) .    ADJUST TP CODE BASE      S21101 40292020
         LA    RCCW,EIGHT(,RCCW) .      ADJUST CCW BASE          S21101 40292520
         ST    RCCW,LCBSTART-1 .        SET START ADDRESS        S21101 40293020
         B     NOSYNC .                 CONTINUE                 S21101 40293520
GODLEEOT EQU   * .                                               S21101 40294020
         BALR  RLNK1,REXPND            LINK TO EXPAND                   40300020
         DC    AL2(MODCCW01-MODCCW)                                     40350020
         B     NEXTCCW                                                  40450020
NOSYNC   EQU   *                                                        40500020
.LI2     ANOP                                                           40550020
         BALR  RLNK1,REXPND             GO TO EXPAND ROUTINE            40600020
         DC    AL2(MODCCW02-MODCCW)                                     40650020
NEXTCCW  EQU   *                                                        40700020
         AIF   ('&GEN' EQ 'BISC').L36                                   40750020
         TM    LCBSTICS+1,CTWX          TWX                             40800020
         BZ    NOTTWX                                                   40850020
         BALR  RLNK1,REXPND             GO TO EXPAND ROUTINE            40900020
         DC    AL2(MODCCW32-MODCCW)                                     40950020
         BR    R2                       RETURN                          41000020
NOTTWX   EQU   *                                                        41050020
         AIF   ('&GEN' EQ 'STSP').L37                                   41100020
         AIF   ('&GEN' EQ 'QTAM').L37                                   41120020
         TM    LCBSTICS+1,CBISYNC                                       41150020
         BZ    STSTOP                                                   41200020
.L36     ANOP                                                           41250020
         BAL   RWKB,ILIST               GET ILIST ADDRESS               41300020
         CLI   IDLOC+1(RWKC),AVTEZERO   ANY ID'S FOR CPU                41350020
         BE    NOID                     BRANCHNO                        41400020
         BALR  RLNK1,REXPND             LINK TO EXPAND                  41450020
         DC    AL2(MODCCW14-MODCCW)                                     41500020
         B     ENDTEST                  CONTINUE IN LINE TESTING        41550020
NOID     EQU   *                                                        41600020
         BALR  RLNK1,REXPND             LINK TO EXPAND                  41650020
         DC    AL2(MODCCW15-MODCCW)                                     41700020
ENDTEST  EQU   *                                                        41750020
         TM    LCBSTICS+2,CENDCTL       END/END CONTROL                 41800020
         BNZ   ENDCTL                   BRANCH IF END-END CTL           41850020
         SH    RCCW,H8                  BAK UP TO PREVIOUX              41900020
         OI    CCWFLAGS,CCWSLI          SET FLAG FOR APPENDAGE          41950020
         BR    R2                       RETURN                          42000020
ENDCTL   EQU   *                                                        42050020
         BALR  RLNK1,REXPND             LINK TO EXPAND                  42100020
         DC    AL2(MODCCW41-MODCCW)                                     42150020
         BR    R2                       RETURN                          42200020
.L37     ANOP                                                           42450020
         AIF   ('&GEN' EQ 'BISC').L35                                   42500020
STSTOP   EQU   *                                                        42550020
         BALR  RLNK1,REXPND             GO TO EXPAND ROUTINE            42600020
         DC    AL2(MODCCW36-MODCCW)                                     42650020
         TM    LCBSTICS+1,CSTNCTL       STATION CONTROL                 42700020
         BO    WRMLPT                   BRANCH YES                      42750020
NODIALUP EQU   *                                                        42800020
         TM    LCBSTICS+1,CTWX          TWX                             42850020
         BZ    WRLSD                    NO                              42900020
         NI    LCBSTICS+1,AVTEFF-CTWX   TURNOFF TWX BIT                 42950020
*                                         BUFFERS WILL BE POSTED        43000020
*                                         TO MH BY ACTIVATE             43050020
.L35     ANOP                                                           43100020
.M6      ANOP                                                           43250020
STIDLES  EQU   *                                                        43300020
         LA    RWKA,LCBCPA              WRITE IDLES ADDRESS             43350020
         ST    RWKA,LCBSTART-1          SET IOS PARAMETER               43400020
         BR    R2                       RETURN                          43450020
         SPACE 3                                                        43500020
*********      L E A S E D    L I N E S        *********                43550020
         SPACE 2                                                        43600020
         AIF   ('&GEN' NE 'MINI').N1                                    43650020
NORP     EQU   *                                                        43700020
         NI    LCBSTAT2,AVTEFF-LCBRESP                                  43750020
.N1      ANOP                                                           43800020
WRLSD    EQU   *                                                        43850020
         TM    LCBSTICS+1,CLOCAL+CAUDIO LOCAL OR AUDIO                  43900020
         BZ    NOAUD                    NO                              43950020
         MVC   LCBTTCIN,LCBTTBIN        SET CONNECTION DESIRED          44000020
TSMSGN   EQU   *                                                        44020020
         TM    LCBSTAT2,LCBMSGNN        MSGGEN                          44050020
         BZ    NOTMSGN                  NO                              44100020
         LA    RCCW,LCBCPA              START POINT                     44150020
         ST    RCCW,LCBSTART-1          START OF CHAN PROG              44200020
         AIF   ('&GEN' EQ 'BISC').TS11                         @YA03846 44200156
         AIF   ('&GEN' EQ 'MINI').TS11                           A48276 44200221
         TM    LCBSTICS+2,CNOIDLES      IS IT 2260R              A48276 44200321
         BO    TSRESP                   IF SO, BUILD ACK RESP    A48276 44200421
.TS11    ANOP                                                    A48276 44200521
         BR    R2                       RETURN                          44250020
NOTMSGN  EQU   *                                                        44300020
*        SIMULATE 'ADDRESSING' SEQUENCE FOR 2260 LOCAL FOR SCREEN       44310020
* TO MODIFY  WRITE COMMAND.                                             44320020
         AIF   ('&GEN' EQ 'MINI').L4R6                         @YA03846 44320556
         TM    LCBSTICS,C3270           3270 DEVICE?             S99228 44321022
         BZ    NOL3270                  BRANCH NO                S99228 44321522
         TM    LCBSTICS+ONE,CLOCAL      LOCAL DEVICE?            S99228 44322022
         BZ    NOL3270                  BRANCH NO                S99228 44322522
         OI    LCBCHAIN,LCBEXCP         EXCP AT ASSOCIATION      S99228 44323022
         LA    RCCW,LCBCPA+16           SET CCW ADDR             S99228 44324022
         BALR  RLNK1,REXPND             LINK TO EXPAND           S99228 44325022
         DC    AL2(MODCCW74-MODCCW)     3270 LOCAL WRITE CH PGM  S99228 44326022
         BR    R2                       RETURN TO ACTIVATE       S99228 44327022
NOL3270  EQU   *                                                 S99228 44328022
.L4R6    ANOP                                                           44329022
         BALR  RLNK1,REXPND             LINK TO EXPAND                  44330020
         DC    AL2(MODCCW29-MODCCW)                                     44340020
         OI    LCBCHAIN,LCBEXCP         DO EXCP AT ASSOCIAION           44350020
         BR    R2 .                     RETURN TO ACTIVATE       A41027 44400020
NOAUD    EQU   *                                                        44450020
         TM    LCBSTICS+1,CCONTENT+CXMITCTL CONTENTION OR XMITCTL       44500020
         BZ    WRMLPT                                                   44550020
         SPACE 2                                                        44600020
* C O N T E N T I O N    L I N E                                        44650020
         SPACE 1                                                        44700020
         AIF   ('&GEN' NE '').L38                                       44800020
         TM    LCBSTICS+1,CBISYNC       BSC DEVICE                      44850020
         BZ    NOBSCCT                                                  44900020
.L38     ANOP                                                           44950020
         AIF   ('&GEN' EQ 'STSP').L39                                   45000020
         AIF   ('&GEN' EQ 'MINI').L41                                   45050020
         AIF   ('&GEN' EQ 'QTAM').L39                                   45070020
         L     RWKA,LCBSCBA-1           GET SCB POINTER          S21101 45080020
         USING IEDQSCB,RWKA .                                    S21101 45090020
         TM    SCBBSCFM,SCBNOEOT .      DIAL WITH SEND PRIORITY  S21101 45092020
*                                         IN TEXT MODE           S21101 45094020
         DROP  RWKA .                                            S21101 45096020
         BZ    NOTEOT .                 BRANCH IF NO             S21101 45098020
         SPACE 1                                                 S21101 45098420
         TM    LCBSTICS+2,CENDCTL .     END TO END CONTROLS      S21101 45098820
         BO    ENDCTL .                 BRANCH IF YES TO BUILD   S21101 45099220
*                                         WRITE ESCAPE  AND READ S21101 45099620
         SPACE 1                                                 S21101 45099720
         OI    LCBSTAT2,LCBRESP .       SET FOR ACTIVATE TO POST S21101 45099820
*                                         BUFFERS.  THERE IS NO  S21101 45099920
*                                         SELECTION SEQUENCE.    S21101 45116620
         B     STIDLES .                START ON WRITE SYNS      S21101 45126620
         SPACE 2                                                 S21101 45128620
NOTEOT   EQU   *                                                 S21101 45130620
         TM    LCBSTICS+2,CENDCTL       END - END CONTROLS              45133320
         BZ    ITSCPU                   NO, MUST BE CPU                 45150020
         BALR  RLNK1,REXPND             GO TO EXPAND ROUTINE            45200020
         DC    AL2(MODCCW40-MODCCW)                                     45250020
         BR    R2                       RETURN                          45300020
         SPACE                                                          45350020
ITSCPU   EQU   *                                                        45400020
         BALR  RLNK1,REXPND             LINK TO EXPAND                  45450020
         DC    AL2(MODCCW43-MODCCW)                                     45500020
         BR    R2                       RETURN                          45550020
.L39     ANOP                                                           45600020
         AIF   ('&GEN' EQ 'BISC').L40                                   45650020
NOBSCCT  EQU   *                                                        45700020
         TM    LCBSTICS+2,CWTTA         WORLD TRADE                     45750020
         BZ    NOWTTA                   BR NO                           45800020
         BALR  RLNK1,REXPND             GO TO EXPAND ROUTINE            45850020
         DC    AL2(MODCCW42-MODCCW)                                     45900020
NOWTTA   EQU   *                                                        45950020
         TM    LCBTSOB,LCB2741N         SEE IF 2741 TERM            TSO 46000020
         BZ    NOTS                     BRANCH NO                       46050020
         TM    LCBTSOB,LCBCIRCD         CIRCLE D SENT LAST          TSO 46100020
         BO    TSNOD                                                TSO 46150020
         BALR  RLNK1,REXPND             GO TO EXPAND ROUTINE            46350020
         DC    AL2(MODCCW38-MODCCW)                                     46400020
         SPACE 2                                                        46450020
.L41     ANOP                                                           46460020
NOTS     EQU   *                                                        46470020
         BALR  RLNK1,REXPND             LINK TO EXPAND                  46480020
         DC    AL2(MODCCW39-MODCCW)                                     46490020
         AIF   ('&GEN' EQ 'MINI').L40                                   46500020
TSNOD    EQU   *                                                    TSO 46550020
         LA    RWKA,LCBCPA              START I/O ON IDLES          TSO 46600020
         ST    RWKA,LCBSTART-1                                      TSO 46650020
         BR    R2                                                   TSO 46700020
         SPACE                                                          46750020
.L40     ANOP                                                           46800020
* M U L T I P O I N T    L I N E                                        46850020
         SPACE 1                                                        46900020
WRMLPT   EQU   *                        LEASED +DIAL-2740,1050          46950020
         AIF   ('&GEN' EQ 'MINI').L40A                           S22026 46955022
         AIF   ('&GEN' EQ 'STSP').L40A                           S22026 46960022
         AIF   ('&GEN' EQ 'QTAM').L40A                           S22026 46965022
         TM    LCBSTICS+1,CBRDCAST .   FAST SELECT ?             S22026 46970022
         BNO   NOFSTSEL .              BRANCH NO                 S22026 46975022
         BALR  RLNK1,REXPND .          GO TO EXPAND              S22026 46980022
         DC    AL2(MODCCWFS-MODCCW) .                            S22026 46985022
NOFSTSEL EQU   * .                                               S22026 46990022
.L40A    ANOP                                                    S22026 46995022
         TM    LCBSTICS+2,CNOIDLES      NO IDLES DEFINED                47000020
         BNZ   ITSTV                    BRANCH YES                      47050020
         AIF   ('&GEN' EQ 'BISC' OR '&GEN' EQ 'STSP').L40B      SA69087 47056005
         AIF   ('&GEN' EQ 'MINI' OR '&GEN' EQ 'QTAM').L40B      SA69087 47062005
         TM    LCBSTAT2,LCBSYNC         BSC ?                   SA69087 47068005
         BZ    NTSOBSC                  NO, NOT BI-SYNC         SA69087 47074005
         MVI   LCBTPCD+11,0             RESET WCC FLAG IF ON    SA69087 47080005
NTSOBSC  EQU   *                                                SA69087 47086005
.L40B    ANOP                                                   SA69087 47092005
         BALR  RLNK1,REXPND             GO TO EXPAND ROUTINE            47100020
         DC    AL2(MODCCW44-MODCCW)                                     47150020
ITSTV    EQU   *                                                        47200020
         BALR  RLNK1,REXPND             LINK TO EXPAND                  47250020
         DC    AL2(MODCCW51-MODCCW)                                     47300020
         OI    LCBCHAIN,LCBEXCP         EXCP TO BE DONE LATER           47350020
         AIF   ('&GEN' EQ 'BISC').TS12                         @YA03846 47352056
         AIF   ('&GEN' EQ 'MINI').TS12                           A48276 47354021
*  CAN GET HERE FOR MSGGEN RESP ON 2260R. MAKE SURE IS MSGGEN    A48276 47356021
* BECAUSE CAN GET HERE FOR ANY 2260R WRITE.                      A48276 47358021
         TM    LCBSTAT2,LCBMSGNN        IS IT A MSGGEN           A48276 47360021
         BCR   8,R2                     BR NO. DO NOT WANT RESP  A48276 47362021
*                                       TO NON-MSGGEN WRITES     A48276 47364021
TSRESP   EQU   *                                                 A48276 47366021
         LA    RCCW,LCBERCCW+12         RESPONSE AREA FOR 2260R  A48276 47368021
*                                       MSGGEN MESSAGES          A48276 47370021
         ST    RCCW,LCBCPA+48           READ AREA FOR RESPONSE   A48276 47372021
         MVI   LCBCPA+48,CCWREAD        READ COMMAND             A48276 47374021
         LA    RCCW,2                   READ COUNT               A48276 47376021
         ST    RCCW,LCBCPA+52           COUNT TO CCW             A48276 47378021
         MVI   LCBTPCD+6,TPRSPMG        RESP MSG INDEX           A48276 47380021
         LA    RCCW,LCBCPA+48           FOR TIC TO RESP          A48276 47382021
         ST    RCCW,LCBCPA+8            FOLLOW MSGGEN WRITE      A48276 47384021
         MVI   LCBCPA+8,CCWTIC          STORE TIC                A48276 47386021
         MVI   LCBCPA+4,CCWCC+CCWSLI    SLI AND CMD CHAIN      @SA76694 47388058
.TS12    ANOP                                                    A48276 47390021
         BR    R2                       RETURN                          47400020
H8       DC    H'8'                                                     47408058
LCBBKUP  DC    AL2(LCBERB-IEDQLCB)      OFFSET ERB FROM LCB             47416058
H72      DC    H'72' .                                              TSO 47424058
*  OPTLIST--OFFSET TO IEDQAE,LENGTH,OFFSET TO OPT FIELD,REG 15 INDIC    47432058
OPTLIST  DC    AL1(20),XL3'040010' .    PARM LIST FOR IEDQAE        TSO 47440058
         EJECT                                                          47450020
*                                                                       47500020
*        *****************************************                      47550020
*        *                                       *                      47600020
*        *     E X P A N D    R O U T I N E      *                      47650020
*        *****************************************                      47700020
         SPACE 1                                                        47750020
*        THIS ROUTINE EXPAND THE SUBSET OF CHANNEL PROGRAM PROVIDED     47800020
*              FIRST  - BUILD CCW IN CHANNEL PROGRAM AREA(LCBCPA).      47850020
*              SECOND - SET-UP TP CODE IN LCBTPCD.                      47900020
         SPACE 2                                                        47950020
         USING *,REXPND                                        @OS77867 47970000
EXPAND   DS    0H                                                       48000020
         LA    RMOD,MODCCW              LOAD MODEL CHAN PROG TABLE AD.  48050020
         DROP  REXPND                                          @OS77867 48070000
         AH    RMOD,0(RLNK1)            ADD OFFSET                      48100020
EXLOOP0  EQU   *                                                        48150020
         LA    REXPND,EXPAND            REATORE REXPND REGISTER         48200020
         CLI   0(RMOD),X'FF'            END OF SUBSET                   48250020
         BE    2(RLNK1)                 YES,RETURN                      48300020
         LA    REXPND,EXPRTN            SET-UP RETURN ADDRESS           48350020
         SR    RWKB,RWKB                CLEAR WORK REGISTER             48400020
         SR    RWKA,RWKA                CLEAR REGISTER                  48450020
         STM   RWKA,RWKB,CCW            CLEAR CCW                       48500020
         IC    RWKA,0(RMOD)             OFFSET IN EXPANDEER TABLE       48550020
         LH    RWKA,ORGTB1(RWKA)        GET OFFSET FOR EXPANDER ROUTINE 48600020
         B     ORGRTN(RWKA)             AND BRANCH                      48650020
*                                                                       48700020
* RETURN HER FROM EXPANDER ROUTINES                                     48750020
* RWKA CONTAINS THE CCW DATA ADDRESS                                    48800020
*                                                                       48850020
EXPRTN   EQU   *                                                        48900020
         ST    RWKA,CCWADDR-1           SET DATA ADDRES                 48950020
         SR    RWKB,RWKB                CLEAR REGISTER                  49000020
         IC    RWKB,0(RMOD)             OFFSET IN EXPANDER TABLE        49050020
         IC    RWKA,ORGTB1+2(RWKB)      PICK-UP OP CODE                 49100020
         STC   RWKA,CCWOPCDE            AND STORE IT                    49150020
EXPRTN0  EQU   *                                                SA57685 49170022
         MVC   CCWFLAGS(1),1(RMOD)      YES, SET PROVIDED FLAGS         49200020
*                                                                       49250020
* SET-UP TP CODE IN LCB(LCBTPCD)                                        49300020
*        FOR EACH CCW A TP CODE IS REQUIRED                             49350020
*                                                                       49400020
         IC    RWKB,ORGTB1+3(RWKB)      PICK-UP TP CODE                 49450020
         STC   RWKB,ZERO(R0,RTPCDE)     SET TP OP CODE                  49500020
         LA    RTPCDE,ONE(R0,RTPCDE)    BUMP TP OP CODE POINTER         49550020
         LA    RCCW,EIGHT(R0,RCCW)      BUMP CCW BASE                   49600020
*                                                                       49650020
* RETURN HERE FROM EXPANDER ROUTINES WHEN NO EXPAND IS REQUIRED         49700020
*                                                                       49750020
         LA    RMOD,TWO(R0,RMOD)        POINT TO NEXT INTRY             49850020
         B     EXLOOP0                  BUILD NEXT CCW                  49900020
         EJECT                                                          49950020
*                                                                       75050020
*        E X P A N D E R    R O U T I N E S                             75100020
*        THE FUCTION OF THE EXPANDER ROUTINES IS ...                    75150020
*              - SET THE COUNT IN THE CCW                               75200020
*              - LOAD THE CCW DATA ADDRESS IN RWKA                      75250020
*              - RETURN TO THE EXPAND ROUTINE (EXPRTN)                  75300020
*                                                                       75350020
         SPACE 3                                                        75400020
ORGRTN   DS    0H                                                       75450020
         SPACE 2                                                        75500020
*        SENSE EXPANDER                                                 75550020
*        EXPANDERS FOR ANY VALID ADDRESS                                75600020
NOPRT    EQU   *                                                        75620020
PREPRT   EQU   *                                                        75650020
RDSKPRT  EQU   *                                                        75700020
DISBLRT  EQU   *                                                        75750020
ENABLRT  EQU   *                                                        75800020
SNSRT    EQU   *                                                        75850020
         LA    RWKA,LCBCSWSV            SET SENSE FIELD                 75900020
         MVI   LCBCSWSV,AVTEFF          INITIALIZE SENSE BYTE     M1582 75920021
         MVI   CCWCOUNT+1,X'01'         SET COUNT=1                     75950020
         BR    REXPND                   RETURN TO EXPAND ROUTINE        76000020
         SPACE 2                                                        76050020
         SPACE 2                                                        76100020
*        WRITE SPECIAL CHARACTERS EXPANDER                              76200020
WRACKRT  EQU   *                                                        76250020
         TM    LCBMSGFM,LCBNAK .        NAK REQUEST              S21101 76300020
         BO    WRNACKRT            IF YES, TAKE BRANCH                  76350020
         SPACE                                                          76400020
         AIF   ('&GEN' EQ 'STSP' OR '&GEN' EQ 'MINI').Z10               76420020
         AIF   ('&GEN' EQ 'QTAM').Z10                                   76430020
         XI    LCBMSGFM,LCBACKI .       FLIP ACK COUNTER         S21101 76450020
         TM    LCBCHAIN,LCBABRTN .      ABROT REQUEST FOR RVI    S22025 76460022
         BO    ITSRVI .                 BRANCH IF YES            S22025 76470022
         TM    LCBMSGFM,LCBACKI .       IF ON, WRITE ACK-0       S21101 76500020
         BNZ   ACK0                     BRANCH IF ACK0 REQUEST          76550020
.Z10     ANOP                                                           76570020
         B     ACK1                     MUST BE ACK 1                   76600020
         SPACE                                                          76650020
         AIF   ('&GEN' EQ 'STSP' OR '&GEN' EQ 'MINI').Z11               76670020
         AIF   ('&GEN' EQ 'QTAM').Z11                                   76680020
WRDLETRT EQU   *                                                        76700020
         LA    RWKB,1(,RWKB) .          INDEX INTO TABLE         S22025 76750022
ITSRVI   EQU   * .                                               S22025 76760022
         LA    RWKB,8(,RWKB) .          INDEX INTO TABLE         S22025 76770022
WRENQRT  EQU   *                                                        76800020
         LA    RWKB,1(,RWKB)                                            76850020
.Z11     ANOP                                                           76870020
WRNACKRT EQU   *                                                        76900020
         NI    LCBCHAIN,AVTEFF-LCBABRTN RESET ABORT REQUEST      S22025 76950022
         NI    LCBMSGFM,X'FF'-LCBNAK-LCBEOT RESET FLAGS          S22025 76970022
         LA    RWKB,1(RWKB)                                             77000020
ACK1     EQU   *                                                        77050020
         LA    RWKB,1(,RWKB)                                            77100020
ACK0     EQU   *                                                        77150020
         LA    RWKB,1(RWKB)                                             77200020
WRIDLRT  EQU   *                                                        77250020
         LA    RWKB,1(RWKB)                                             77300020
WRPADRT  EQU   *                                                        77350020
         LA    RWKB,1(RWKB)                                             77400020
         AIF   ('&GEN' EQ 'MINI').R65XX                                 77410020
         AIF   ('&GEN' EQ 'QTAM').R65XX                                 77420020
         AIF   ('&GEN' EQ 'BISC').R65XX                                 77430020
         B     SKPCHK                                               TSO 77440020
.R65XX   ANOP                                                           77442020
WREOART  EQU   *                                                        77450020
         AIF   ('&GEN' EQ 'MINI').R66XX                                 77460020
         AIF   ('&GEN' EQ 'QTAM').R66XX                                 77470020
         AIF   ('&GEN' EQ 'BISC').R66XX                                 77480020
         TM    LCBTSOB,LCBTSBUF         IS THIS TIME SHARING BUFFER TSO 77490020
         BZ    SKPCHK                   BRANCH ON NO                TSO 77492020
         TM    LCBSTICS+2,CNOIDLES      IS THIS 2260 REMOTE         TSO 77494020
         BO    WREOTRT                  BRANCH ON YES               TSO 77496020
SKPCHK   EQU   *                                                    TSO 77498020
.R66XX   ANOP                                                           77498420
         LA    RWKB,1(RWKB)                                             77500020
WREOTRT  EQU   *                                                        77550020
         L     RWKA,DCBSCTAD-1          ADDR OF SPEC CHAR TABLE         77650020
         IC    RWKB,0(RWKA,RWKB)        PICK-UP OFFSET                  77700020
         AR    RWKA,RWKB                POINT TO CURRENT ENTRY          77750020
         MVC   CCWCOUNT+1(1),0(RWKA)    MOVE COUNT IN CCW               77800020
         LA    RWKA,1(RWKA)             SET-UP DATA ADDRESS             77850020
         AIF   ('&GEN' EQ 'BISC').L65                                   77900020
         AIF   ('&GEN' EQ 'MINI').L65                                   77950020
         CLI   0(RWKA),X'1F'            SENDING EOT                 TSO 78000020
         BNE   TSLV                     NO                          TSO 78050020
         TM    LCBSTICS,C2741           2741 TERM                   TSO 78100020
         BZ    TSLV                     NO                          TSO 78150020
         MVI   CCWCOUNT+1,X'01'         1 EOT 6OR 2741              TSO 78200020
TSLV     EQU   *                                                    TSO 78250020
.L65     ANOP                                                           78300020
         BR    REXPND                   RETURN TO EXPAND ROUTINE        78350020
         SPACE 2                                                        78400020
*        WRITE POLLING CHARACTERS EXPANDER                              78450020
WRPOLRT  EQU   *                                                        78500020
         BAL   RWKB,ILIST               GET ILIST ADDRESS               78550020
         IC    RWKA,TWO(,RWKC)          SIZE OF EACH ENTRY              78600020
         BCTR  RWKA,0                   DECREMENT FOR INDEX BYTE        78650020
         STC   RWKA,CCWCOUNT+1          SET CCWC OUNT                   78700020
         BAL   RWKB,GLCBXA              LOCATE LCB EXTENSION   @SA62375 78720058
         AIF   ('&GEN' EQ 'STSP' OR '&GEN' EQ 'MINI').L463       S99228 78750022
         AIF   ('&GEN' EQ 'QTAM').L463                           S99228 78770022
         TM    LCBXFLAG,LCBERPND        SOH%R MESSAGE PENDING?   S99228 78810022
         BZ    STANDARD                 BRANCH NO                S99228 78830022
         NI    LCBXFLAG,LCBERSTP        RESET ERP POLL INDIC     S99228 78850022
         L     RWKA,LCBXRADR            LOAD ERP POLL CHAR ADDR  S99228 78870022
         BR    REXPND                   RETURN TO EXPAND ROUTINE S99228 78890022
STANDARD EQU   *                                                 S99228 78910022
.L463    ANOP                                                    S99228 78920022
         L     RWKA,LCBINVPT-ONE        LOAD CURRENT ENTRY ADDR  S99228 78930022
         MVC   LCBERADR(THREE),LCBINVPT SET POLL ADDRESS       @SA62375 78990058
         BR    REXPND                   RETURN TO EXPAND ROUTINE        79050020
         SPACE 2                                                        79100020
*        READ RESPONSE EXPANDER                                         79150020
*            READ IN BUFFER FOR RECEIVING                               79200020
*            READ IN LCBERCCW FOR SENDING                               79250020
RDRSPSRT EQU   *                                                        79300020
         MVI   CCWCOUNT+1,9             SET RESONSE COUNT               79350020
         LA    RWKA,LCBERCCW+12         RESPONSE AREA                   79400020
         BR    REXPND             RETURN TO EXPAND ROUTINE              79450020
RDRSPRT  EQU   *                                                        79500020
         L     RWKC,LCBLSPCI-1          GET HEADER BUFFER ADDRESS       79520020
         LH    RWKA,PRFCOUNT-IEDQPRF(,RWKC) ^ET ORIGINAL COUNT          79540020
         LA    RWKB,2                   ASSUME TWO CHARACTER RESP       79560020
*                                         (FOR NON 2260 LOCAL)          79580020
         TM    LCBTSOB,LCBTSBUF .       IS IT TSO                   TSO 79580620
         BZ    TS2260 .                 BR IF NO                    TSO 79581220
         TM    LCBTSOB,LCB2741N .       IS IT A 2741                TSO 79581820
         BO    TS2741 .                 BR IF YES                   TSO 79582420
         TM    LCBSTICS+1,CTWX .        IS IT TWX                   TSO 79583020
         BO    TS2741 .                 BR IF YES                   TSO 79583620
TS2260   EQU   *                                                        79584220
*                                                                       79595020
         TM    LCBSTICS+1,CLOCAL        2260 LOCAL                      79600020
         BZ    NOTALOC                  BRANCH IF NOT 2260 LOCAL        79620020
         TM    LCBTSOB,LCBTSBUF .       IS THIS TSO LOCAL               79625020
         BZ    TS2741 .                 BRANCH NO                       79630020
         BCTR  RWKB,0 .                 YES. NO READ RESPONSE           79635020
         SPACE                                                          79640020
TS2741   EQU   *                                                        79650020
         BCTR  RWKB,0                   ADJUST TO ONE CHARACTER         79660020
NOTALOC  EQU   *                                                        79680020
         SR    RWKA,RWKB                ADJUST ORIGINAL COUNT           79700020
         STH   RWKA,PRFCOUNT-IEDQPRF(,RWKC) RESET BUFFER COUNT          79720020
         L     RWKA,PRFIOADR-1-IEDQPRF(,RWKC) DATA ADDESS               79740020
         AR    RWKA,RWKB                BUMP BUFFER DATA ADDRESS        79760020
         STCM  RWKA,7,PRFIOADR-IEDQPRF(RWKC)  RESTORE DATA ADR @G36XRYP 79780000
         MVI   1(RWKA),AVTEZERO         CLEAR SECOND DATA BYTE @OS77835 79790000
         SR    RWKA,RWKB                BACK TO ORIGINAL DATA ADDRESS   79800020
*                                         FOR READ RESPONSE             79820020
         STC   RWKB,CCWCOUNT+1          SET READ RESPONSE COUNT         79840020
*                                         2260 LOCAL ALLOW ONE CHAR     79860020
*                                         MESSAGE                       79880020
         BR    REXPND                   RETURN TO EXPAND ROUTINE        80050020
         SPACE 2                                                        80100020
*        RETURN TO ACTIVATE                                             80150020
*            TIC BUFFER FOR READ OP                                     80200020
*            TIC WRITE IDLE FOR WRITE OP                                80250020
TCCONRT  EQU   *                                                        80300020
         L     RWKA,LCBCPA+12           RESTART CCW                     80350020
         B     LEAVE                    EXIT                            80400020
         SPACE 2                                                        80450020
TCBUFRT  EQU   *                                                        80500020
         L     RWKA,LCBLSPCI-1          BUFFER ADDRESS                  80550020
         AIF   ('&GEN' EQ 'MINI').L66                             M6293 80570020
         AIF   ('&GEN' EQ 'STSP').L66                             M6293 80580020
         AIF   ('&GEN' EQ 'QTAM').L66                             M6293 80590020
         TM    LCBSTAT2,LCBSYNC .       IS THIS A BISYNC LINE     M6293 80600020
         BNO   NOTSYNC .                BRANCH, IF NOT            M6293 80610020
* FOR BISYNC LINES, IF AUTOPOLL, THE AUTOPOLL INDEX BYTE SHOULD   M6293 80620020
* ALWAYS BE REMOVED SINCE THE EOA STRING IS ALWAYS PRESENT.  IF   M6293 80630020
* LC=OUT IS SPECIFIED, THE EOA CHARACTERS WILL BE REMOVED BY LINE M6293 80640020
* APPENDAGE IN THE SCAN ROUTINE.                                  M6293 80650020
         CLI   LCBCPA+24,CCWPOLL .      IS THIS LINE AUTOPOLL     M6293 80700020
         BE    ADDIDLE .                BRANCH IF SO              M6293 80750020
         B     RETACT .                 DO NOT REMOVE INDEX       M6293 80800020
NOTSYNC  EQU   * .                                                M6293 80850020
         AIF   ('&GEN' EQ 'BISC').L67A                            M6293 80900020
         SPACE                                                          80950020
         L     RWKC,TRMDESTQ-1          PICK UP DEST QCB         S22029 81000022
         DROP  RWKC                                                     81020022
         USING IEDQQCB,RWKC                                             81040022
         TM    QCBDSFLG,QCBALTMH        IS TERMINAL CONNECTED TO S22029 81060022
*                                       AN ALTERNATE MH          S22029 81080022
         L     RWKC,DCBDEBAD            DEB ADDRESS              X02004 81100005
         L     RWKC,DEBAPPAD-DEBNMSUB(,RWKC) VECTOR TABLE        X02004 81110005
         BZ    LCTEST                   USE OWNING MH            X02004 81120005
         DROP  RWKC                                              X02004 81130005
         LA    RWKC,ONE(,RWKC)          USE ALTERNATE MH         X02004 81140005
LCTEST   EQU   *                                                 X02004 81150005
         AGO   .L66Z                                             X02004 81160005
.L66     ANOP                                                    X02004 81170005
         L     RWKC,DCBDEBAD            DEB ADDRESS              X02004 81180005
         L     RWKC,DEBAPPAD-DEBNMSUB(,RWKC) VECTOR TABLE        X02004 81190005
.L66Z    ANOP                                                    X02004 81200005
         TM    0(RWKC),LCIN             IS LC=IN SPECIFIED              81210005
         BO    RETACT                   YES                      S22029 81280022
         TM    LCBSTICS+1,CCONTENT+CTWX+CLOCAL+CAUDIO NONEOA DEVICE     81300020
         BNZ   RETACT                   BRANCH IF YES                   81350020
         L     RWKC,DCBSCTAD-1          GET SCT ADDRESS                 81400020
         IC    RWKB,1(RWKC)             GET EOA OFFSET                  81450020
         AR    RWKC,RWKB                POINT TO START OF SEQUENCE      81500020
         CLI   0(RWKC),X'01'            COUNT OF 1 MEANS A HARDWARE     81550020
*                                         GENERATED SEQUENCE TO BE      81600020
*                                         REMOVED                       81650020
         BNE   RETACT                   LESS THAN OR MORE THAN ONE      81750020
*                                       CHAR, DON'T ADJUST IDLES        81800020
.L67A    ANOP                                                     M6293 81810020
ADDIDLE  EQU   *                                                        81850020
         IC    RWKB,LCBISZE             IDLES RESERVED                  81900020
         LA    RWKB,1(,RWKB)            BUMP IDLES COUNT                81950020
         STC   RWKB,LCBISZE             SET IN LCB                      82000020
RETACT   EQU   *                                                        82003020
         IC    RWKB,LCBISZE             GET NUMBER OF IDLES             82006020
         LA    RWKB,PRFSHDR-PRFSUNIT(,RWKB) IDLES +PREFIX SIZE          82010020
         STH   RWKB,PRFSIZE-IEDQPRF(RWKA) PRE SET PREFIX SIZE           82020020
LEAVE    EQU   *                                                        82120020
         TM    LCBSTICS+1,CLOCAL        LOCAL CEVICE                    82300020
         BZ    NOLOCL                   NO                              82350020
         TM    LCBSTICS,C3270           3270 DEVICE?             S99228 82360022
         BO    NOLOCL                   BRANCH YES               S99228 82370022
         L     RWKB,LCBINVPT-1          INVITATION ENTRY                82400020
         MVC   LCBCPA+16(1),0(RWKB)     SET MODIFIED READ               82450020
NOLOCL   EQU   *                                                        82500020
         ST    RWKA,CCWADDR-1                                           82550020
         MVI   CCWOPCDE,CCWTIC          SET TIC OP CODE                 82600020
         BR    R2                       RETURN TO ACTIVATE ROUTINE      82650020
         SPACE 2                                                        82700020
TCIDLRT  EQU   *                                                        82710020
         LA    RWKA,LCBCPA              WRITE IDLES LOCATION            82720020
         B     NOLOCL                   USE COMMON EXIT                 82730020
         SPACE 3                                                        82740020
         AIF   ('&GEN' EQ 'MINI').Z12                                   82770020
*        POLL EXPANDER                                                  82850020
POLLRT   EQU   *                        BUILD POLL COMMANDS FOR         82900020
*                                         ALL AUTOPOLL                  82950020
         BAL   RWKB,ILIST               FIND LILIST ADDRESS             83000020
         IC    RWKA,ONE(,RWKC)          NO. OF ACTIVE ENTIRES           83050020
         LR    RWKB,RWKA                CLEAR REG EXCEPT LO-ORDER       83100020
         IC    RWKB,TWO(,RWKC)          SIZE OF EACH ENTRY              83150020
         MR    RWKB-1,RWKA              PRODUCT OF SIZE AND NUMBER      83200020
         AIF   ('&GEN' NE '').L68                                       83250020
         TM    LCBSTAT2,LCBSYNC         BSC LINE                        83300020
         BZ    STSP                     BRANCH NO                       83350020
.L68     ANOP                                                           83400020
         AIF   ('&GEN' EQ 'STSP').L69                                   83450020
         AIF   ('&GEN' EQ 'QTAM').L69                                   83500020
         SPACE                                                          83550020
         LA    RWKB,1(,RWKB)            ADJUST -EOT AT END OF BSC       83600020
*                                         LIST                          83650020
.L69     ANOP                                                           83700020
STSP     EQU   *                                                        83750020
         LA    RWKA,LCBCPA+24           SET CCW ADDRESS                 83800020
         CR    RWKA,RCCW                THIS FIRST POLL                 83850020
         BE    FRSTPOLL                 BRANCH FIRST POLL               83900020
         SPACE                                                          83950020
         LA    RWKA,8(,RWKC)            SAT OF ENTRIES                  84000020
OUT      EQU   *                                                        84050020
         STH   RWKB,CCWCOUNT            SET COUNT                       84100020
         BR    REXPND                   REUTR TO EXPAND                 84150020
         SPACE                                                          84200020
FRSTPOLL EQU   *                                                        84250020
         L     RWKA,LCBINVPT-1          STARTING ADDRESS                84300020
         LA    RWKB,8(RWKB,RWKC)        BUMP TO I END OF LIST           84350020
         SR    RWKB,RWKA                COUNT                           84400020
         B     OUT                      USE COMMON EXIT                 84450020
.Z12     ANOP                                                           84470020
         SPACE                                                          84500020
ILIST    EQU   *                                                        84550020
         SR    RWKA,RWKA                CLEAR WORK REGISTER             84600020
         IC    RWKA,LCBUCBX             RLN-1                           84650020
         SLL   RWKA,2                   MULTILPY BY 4                   84700020
         L     RWKC,DCBINVLI(RWKA)      ILIST FOR LINE                  84750020
         SR    RWKA,RWKA                CLEAR WORK REGISTER             84800020
         BR    RWKB                     RETURN                          84850020
         SPACE 2                                                        84856022
*        THIS SUBROUTINE LOCATES THE LCB EXTENSION ABOVE THE     S99228 84859022
*        CHANNEL PROGRAM AREA                                    S99228 84862022
         SPACE 1                                                        84865022
GLCBXA   EQU   *                                                 S99228 84868022
         SR    RWKA,RWKA                CLEAR LENGTH REGISTER    S99228 84871022
         IC    RWKA,DCBEIOBX            INSERT LCB LENGTH        S99228 84874022
         SH    RWKA,AVTHA4              REDUCE LCB LENGTH BY     S99228 84877022
         SH    RWKA,AVTHA4              8 BYTES FOR ADDR LCB EXT S99228 84880022
         LA    RWKC,ZERO(RWKA,RLCB)     LOAD LCB EXTENSION ADDR  S99228 84883022
         BR    RWKB                     RETURN TO CALLER         S99228 84886022
.L483    ANOP                                                    S99228 84889022
         SPACE 2                                                        84900020
         AIF   ('&GEN' EQ 'MINI').Z13                                   84920020
TCRDXRT  EQU   *                        READ TO READ RESINDEX-AUTOP     84950020
         LA    RWKA,T24(RCCW)           ADDR OF READ RESP               85000020
         BR    REXPND                   RETURN TO EXPAND                85050020
*        TIC EXPANDERS                                                  85100020
TCPOLRT  EQU   *                        TIC TO POLL CCW I.E. PREV.      85150020
         MVI   CCWCOUNT+1,1             SET TIC COUNT FOR LATER NOP     85200020
         LA    RWKA,LCBCPA+48           ADDRESS OF 2ND POLL             85250020
         BR    REXPND                                                   85300020
.Z13     ANOP                                                           85350020
         LA    RWKA,LCBCPA              LOAD WRITE IDLE ADDRESS         85450020
         BR    REXPND                   RETURN TO EXPAND ROUTINE        85500020
TCSKPRT  EQU   *                                                        85600020
         LA    RWKA,LCBCPA              TIC TO READ SKIP                85650020
         MVC   LCBCPA+13(3),LCBLSPCI    SET CURRENT CCW ADDRESS         85700020
         BR    REXPND                   RETURN TO EXPAND ROUTINE        85750020
         SPACE 2                                                        85800020
*    WRITE ADDRESSING CHARS AND CIAL COMMANDS.                          85900020
DIALRT   EQU   *                                                        85950020
         OI    LCBTPCD+11,DISDLEOT      SET TO WRITE DISCONNECT SA61781 85960005
*                                         PRIOR TO NEXT DISABLE SA61781 85970005
WRADRRT  EQU   *                                                        86000020
         TM    TRMSTATE,TRMOPTFN        OPTION FIELDS PRESENT           86050020
         BZ    NOOPT                    BRANCH NO                       86100020
         SPACE                                                          86150020
         IC    RWKB,TRMOPNO             SIZE OF OPTION TABLE            86200020
         LA    RWKB,3(,RWKB)            ACCOUNT FOR OFFSET AND          86250020
*                                         OPTION NUMBER                 86300020
NOOPT    EQU   *                                                        86350020
         LH    RWKC,TRMDEVFL            DEVICE FLAGS                    86400020
         LTR   RWKC,RWKC                BUFSZ SPECIFIED                 86450020
         BNL   NOBUFSZ                  BRANCH IF NO                    86500020
         LA    RWKB,THREE(R0,RWKB)      ADJUST FOR BUFSX FIELD          86550020
NOBUFSZ  EQU   *                                                        86600020
         LA    RWKB,TRMCHCIN+1(RWKB)    POINT TO DEVICE DEPENDENT       86650020
*                                         AREA BYPASSING OPTION S       86700020
         AIF   ('&GEN' EQ 'MINI').L71                                   86750020
         SLL   RWKC,17                  SHIFT DIAL BIT                  86800020
         LTR   RWKC,RWKC                DIAL DIGITS PRESENT             86850020
         BNL   NODIGITS                 BRANCH NO                       86900020
         SR    RWKA,RWKA                CLEAR WORK REGISTER             86950020
         IC    RWKA,ZERO(R0,RMOD)       OFFSET INTO EXPANDER TABLE      87000020
         IC    RWKA,ORGTB1+2(RWKA)      CCW OP CODE                     87050020
         STC   RWKA,LCBERCCW            PUT IN WORK AREA                87100020
         IC    RWKA,ZERO(R0,RWKB)       COUNT OF DIAL OR ADDR  SEQ      87150020
         CLI   LCBERCCW,CCWDIAL         THIS A DIAL BUILD               87200020
********                                                                87250022
* NOTE * FOLLOWING CODE IS ONLY EXECUTED WHILE SYSTEM IS ENABLED        87250522
********                                                                87251022
         BNE   NOTDLBLD                BRANCH NO                SA57685 87251522
         STM   R0,RLNK1,AVTSAVE3       SAVE REGS                SA57685 87252022
         L     RWKC,DCBDEBAD           GET DEB                  SA57685 87252522
         IC    RWKA,LCBUCBX            RLN                      SA57685 87253022
         SLL   RWKA,2                  TIMES 4                  SA57685 87253522
         L     RWKC,DEBUCBAD-DEBNMSUB(RWKC,RWKA)   GET UCB ADRS SA57685 87254022
         TM    UCBTYP2(RWKC),AUTOCALL  AUTOCALL FEATURE         SA57685 87254522
         BO    DIALBLD                 BRANCH YES               SA57685 87255022
         MVC   WTO+22(3),UCBID(RWKC)   LINE NUMBER              SA57685 87255522
         MVI   WTO+26,C' '             SET BLANK                SA57685 87256022
         MVC   WTO+27(11),WTO+26       BLANK AREA               SA57685 87256522
         IC    RWKA,0(,RWKB)           COUNT OF DIGITS          SA57685 87257022
         BCTR  RWKA,0                  DECREMENT FOR MOVE       SA57685 87257522
         EX    RWKA,MOVEDIGT           SET DIGITS               SA57685 87258022
         OI    WTO+26,X'F0'            SET ZONE                 SA57685 87258522
         BCTR  RWKA,0                  COUNT FOR ZONE MOVE      SA57685 87259022
         EX    RWKA,MOVEZONE           SET ZONES                SA57685 87259522
WTO      WTO   'IED158I  DIAL    ,                    ',               C87260022
               ROUTCDE=8,DESC=3                                 SA57685 87260522
         LM    R0,RLNK1,AVTSAVE3       RESTORE REGS             SA57685 87261022
         ST    RLCB,CCWADDR-1          SET VLD PROTECT CMD ADDR SA57685 87261522
         MVI   CCWOPCDE,CCWENAB        SET COMMAND              SA57685 87262022
         MVI   CCWCOUNT+1,X'01'        SET COUNT OF 1           SA57685 87262522
         SR    RWKB,RWKB               CLEAR REGISTER           SA57685 87263022
         IC    RWKB,AVTEZERO(RMOD)     OFFSET IN EXPANDER TABLE SA57685 87263522
         B     EXPRTN0                 RETURN                   SA57685 87264022
*   EXCUTED   INSTRUCTIONS                                      SA57685 87264522
MOVEDIGT MVC   WTO+26(1),1(RWKB)       SET DIAL DIGITS          SA57685 87265022
MOVEZONE MVZ   WTO+27(1),WTO+26        SET ZONE                 SA57685 87265522
NOTDLBLD EQU   *                                                SA57685 87266022
*********************************************************************** 87266522
         LA    RWKB,1(RWKA,RWKB)        BUMP PAST DAIL DIGITS           87300020
DIALBLD  EQU   *                                                        87350020
NODIGITS EQU   *                                                        87400020
.L71     ANOP                                                           87450020
         MVC   CCWCOUNT+1(ONE),ZERO(RWKB) SET COUNT                     87500020
         ST    R2,LCBLINK-1 .           SAVE LINK REG            A50191 87508022
         TM    LCBSTICS+2,CNOIDLES .    2260 REMOTE              A50191 87516022
         BNZ   TESTCHAR .               BRANCH IF YES            A50191 87524022
NOCHAR   EQU   * .                                               A50191 87532022
         L     R2,LCBLINK-1 .           RESTORE LINK REG         A50191 87540022
         LA    RWKA,1(,RWKB)            POINT TO DEVICE CHARACTERS      87550020
         AIF   ('&GEN' EQ 'MINI').Z71XX                                 87560020
         AIF   ('&GEN' EQ 'QTAM').Z71XX                                 87570020
         AIF   ('&GEN' EQ 'BISC').Z71XX                                 87580020
         TM    LCBTSOB,LCBTSBUF         IS THIS TIME SHARING BUFFER TSO 87590020
         BZ    NOTS2260                 BRANCH ON NO                TSO 87592020
         TM    LCBSTICS+2,CNOIDLES      IS THIS 2260 REMOTE         TSO 87594020
         BZ    NOTS2260                 BRANCH ON NO                TSO 87596020
         CLI   0(RWKB),THREE            IS COUNT THREE              TSO 87598058
         BE    IS2260                   YES,BRANCH             @SA76687 87598158
         CLI   FOUR(RWKB),AVTEFF        CONTROL CHAR IN BFR    @SA76687 87598258
         BNE   NOTS2260                 NO,BRANCH              @SA76687 87598458
         CLI   ZERO(RWKB),FOUR          FOUR CHARS SPECIFIED   @SA76687 87598558
         BNE   NOTS2260                 NO,BRANCH              @SA76687 87598658
IS2260   EQU   *                                               @SA76687 87598758
         CLI   3(RWKB),X'E0'            IS SCREEN BEING ERASED      TSO 87598820
         BNE   NOTS2260                 BRANCH ON NO                TSO 87599220
         MVI   LCBTPCD+10,X'BD'         SET INDICATOR IN LCB        TSO 87599620
NOTS2260 EQU   *                                                    TSO 87599720
.Z71XX   ANOP                                                           87599820
         BR    REXPND                   RETURN TO EXPAND                87600020
         SPACE 2                                                        87650020
TESTCHAR EQU   * .                                               A50191 87651022
         SPACE                                                          87652022
*        TEST FOURTH ADDRESSING CHARACTER FOR X'FF' IF 2260    * A50191 87653022
*        REMOTE.  IF YES, MOVE CORRECT CONTROL CHARACTER FOR   * A50191 87654022
*        CURRENT TRANSMISSION FROM FIRST DATA BYTE IN BUFFER.  * A50191 87655022
         SPACE                                                          87656022
         CLI   FOUR(RWKB),AVTEFF .      CONTROL CHAR IN BUFFER   A50191 87657022
         BNE   NOCHAR .                 BRANCH IF NO             A50191 87658022
         CLI   ZERO(RWKB),FOUR .        FOUR CHARS SPECIFIED     A50191 87659022
         BNE   NOCHAR .                 BRANCH IF NO             A50191 87660022
         TM    LCBTSOB,LCBTSBUF         IS THIS TSO            @SA76687 87660358
         BO    NOCHARX                  YES-IGNORE CONTROL CHAR@SA76687 87660658
         NC    LCBERBCH,LCBERBCH .      BUFFER IN ERB            A50191 87661022
         BZ    NOCHAR1                  BRANCH NO              @YA11011 87662058
         L     R2,LCBERBCH-1 .          GET BUFFER ADDRESS       A50191 87663022
         TM    PRFSTAT1-IEDQPRF(R2),PRFNHDRN HEADER BUFFER       A50191 87664022
         BO    NOCHAR1                  BRANCH YES             @YA11011 87665058
         TM    PRFSTAT1-IEDQPRF(R2),PRFCNCLN CANCELLED MESSAGE   A50191 87666022
         BO    NOCHAR1                  BRANCH YES             @YA11011 87667058
         TM    LCBSTAT2,LCBMSGNN .      MSGGEN MESSAGE           A50191 87668022
         BO    NOCHAR1                  BRANCH YES             @YA11011 87669058
         SR    RWKC,RWKC .              CLEAR WORK REGISTER      A50191 87670022
         IC    RWKC,PRFSCAN+1-IEDQPRF(R2) GET IDLES COUNT        A50191 87671022
         LA    RWKC,PRFSHDR-IEDQPRF(RWKC,R2) FIRST DATA BYTE     A50191 87672022
         CLI   ZERO(RWKC),XA0 .         WRITE DC                 A50191 87673022
         BE    SCREENOK .               BRANCH IF YES            A50191 87674022
         CLI   ZERO(RWKC),XB0 .         WRITE AT LINE ADDRESS    A50191 87675022
         BE    SCREENOK .               BRANCH IF YES            A50191 87676022
         CLI   ZERO(RWKC),XE0 .         WRITE ERASE              A50191 87677022
         BE    SCREENOK .               BRANCH IF NO             A50191 87678022
         CLI   EQU3(RWKB),XB0 .         WLA                      A50191 87679022
         BE    NOCHARX .                BRANCH IF YES            A50191 87680022
         CLI   EQU3(RWKB),XE0 .         WRITE ERASE              A50191 87681022
         BE    NOCHARX .                BRANCH IF YES            A50191 87682022
NOCHAR1  EQU   *                                               @YA11011 87682558
         MVI   EQU3(RWKB),XA0 .         WDC IS DEFAULT           A50191 87683022
         B     NOCHARX .                RETURN TO MAINLINE       A50191 87684022
SCREENOK EQU   * .                                               A50191 87685022
         MVC   EQU3(1,RWKB),ZERO(RWKC)  SET CONTROL CHARACTER    A50191 87686022
NOCHARX  EQU   * .                                               A50191 87687022
         SR    RWKC,RWKC .              CLEAR WORK REGISTER      A50191 87688022
         IC    RWKC,CCWCOUNT+1 .        ADDR STRING LENGTH       A50191 87689022
         BCTR  RWKC,R0 .                DECREMENT COUNT BY ONE   A50191 87690022
         STC   RWKC,CCWCOUNT+1 .        RESET NEW COUNT          A50191 87691022
         B     NOCHAR .                 RETURN TO MAINLINE       A50191 87692022
         SPACE 2                                                        87693022
         AIF   ('&GEN' EQ 'MINI').L72                                   87700020
*        DIAL EXPANDER                                                  87750020
*        READ TERM/IDENTIFICATION EXPANDER                              87800020
RDTERMRT EQU   *                                                        87850020
         MVI   CCWCOUNT+1,24            MAC COUNT TWX ID                87900020
         LA    RWKA,LCBERCCW            DATA ADDRESXS                   87950020
         BR    REXPND                   RETURN TO EXPAND ROUTINE        88000020
         SPACE 2                                                        88050020
         SPACE 2                                                        88100020
WTTRSPRT EQU   *                                                        88150020
         LA    RWKA,LCBERCCW            DATA ADDRESS                    88200020
         MVI   CCWCOUNT+1,24            SET COUNT FOR READ              88250020
         BR    REXPND                   RETURN                          88300020
.L72     ANOP                                                           88350020
*   EXPANDER FOR CONTINUE OPERATIONS                                    88400020
RDEOBRT  EQU   *                                                        88450020
         MVI   CCWCOUNT+1,9             SET COUNT                       88500020
         LA    RWKA,LCBERCCW+12         READ ID ENQ                     88550020
         BR    REXPND                   RETURN TO EXPAND ROUTINE        88600020
         AIF   ('&GEN' EQ 'MINI').L73                                   88650020
         AIF   ('&GEN' EQ 'STSP').L74                                   88670020
         AIF   ('&GEN' EQ 'QTAM').L74                                   88680020
RDIDRT   EQU   *                                                        88700020
RDRSPEQ  EQU   *                                                        88750020
RDENQRT  EQU   *                                                        88800020
         MVI   CCWCOUNT+1,17            MAX COUNT RD ID ENQ             88850020
         LA    RWKA,LCBERCCW+7          RESPONSE AREA                   88900020
         BR    REXPND                   RETURN                          88950020
WRTONERT EQU   *                                                        89000020
         L     RWKA,AVTTONE             GET ADDDRESS OF COUNT           89050020
         MVC   CCWCOUNT,0(RWKA)         SET CCW COUNT                   89100020
         LA    RWKA,2(,RWKA)            BUMP TO FF SEQUENCE             89150020
         BR    REXPND                   RETURN TO EXPAND                89200020
RDLCRT   EQU   *                                                        89300020
         LA    RWKA,LCBERCCW+12         READ AREA                       89350020
         MVI   CCWCOUNT+1,1             ASSUME NONTRANSPARENT           89400020
         L     RWKC,LCBSCBA-1            URRNET SCB                     89450020
         USING IEDQSCB,RWKC                                             89500020
         TM    SCBBSCFM,SCBTRNSP .      RECEIVEING RRANSPARENT   S21101 89550020
         BCR   8,REXPND                 BRANCH NON-TRANSP.              89600020
         MVI   CCWCOUNT+1,2             SET COUN T                      89650020
         BR    REXPND                   RETURN                          89700020
         DROP  RWKC                                                     89750020
.L74     ANOP                                                  @OZ28818 89753086
         SPACE                                                          89757000
TCEOTRT  EQU   *                                               @OX14790 89764000
         LA    RWKA,LCBCPA+16           TIC TO THIRD CCW       @OX14790 89771000
         MVC   LCBCPA+13(3),LCBLSPCI    RESTORE CURRENT ADDRESS@0X14790 89778000
         BR    REXPND                   RETURN TO EXPAND ROUTIN@OX14790 89785000
         SPACE 1                                               @OX14790 89792000
WRCPURT  EQU   *                        WRITE CPU ID                    89900020
*        WRITE CPU/IDENTIFICATION EXPANDER                              89950020
         BAL   RWKB,ILIST               GET ILIST ADDRESS               90000056
         L     RWKB,IDLOC(,RWKC)        GET ADDRESS OF CPU ID           90010056
         B     NODIGITS                 USE COMMON CODE                 90020056
         SPACE                                                          90030056
WRWCCRT  LA    RWKA,WCCSEQU             ADDRESS OF WCC SEQUENCS22028TSO 90040056
         TM    LCBTPCD+11,X'01'         ASCII INDICATED ?      @SA71925 90050056
         BZ    WRWCCRT1                 NO, BRANCH             @SA71925 90060056
         LA    RWKA,WCCSEQUA            ADDR OF ASCII SEQUENCE @SA71925 90070056
         NI    LCBTPCD+11,X'FE'         TURN OFF ASCII INDICATO@SA71925 90080056
WRWCCRT1 EQU   *                                               @SA71925 90090056
         MVI   CCWCOUNT+1,X'05'         SET COUNT TO 5        S22028TSO 90106056
         BR    REXPND                   RETURN                S22028TSO 90106356
WRWCCR1  LA    RWKA,WCCNOMDT            ADDR WCC, NO MDT        SA68050 90106656
         TM    LCBTPCD+11,X'01'         ASCII INDICATED        @SA71925 90106956
         BZ    WRWCCR2                  NO, BRANCH             @SA71925 90107256
         LA    RWKA,WCCSEQA1            ADDR ASCII NO MDT SEQ  @SA71925 90107556
         NI    LCBTPCD+11,X'FE'         RESET ASCII INDICATOR  @SA71925 90107856
WRWCCR2  EQU   *                                               @SA71925 90108156
         MVI   CCWCOUNT+1,X'05'         SET COUNT TO 5          SA68050 90109005
         BR    REXPND                   RETURN                  SA68050 90109505
         SPACE                                                          90110022
RDWCCRT  MVI   CCWCOUNT+1,X'09'         SET COUNT TO 9        S22028TSO 90112022
         LA    RWKA,LCBERCCW+12         RESPONSE ADDRESS      S22028TSO 90114022
         BR    REXPND                   RETURN                S22028TSO 90116022
         AIF   ('&GEN' EQ 'BISC').L73                                   90120020
         SPACE 2                                                        90150020
BREAKCCW EQU   *                                                        90155020
WRSMIRT  LA    RWKA,SMISEQU             ADDRESS OF SMI SEQUENCE     TSO 90160020
         MVI   CCWCOUNT+1,X'03'         SET COUNT TO THREE          TSO 90170020
         BR    REXPND                   RETURN                      TSO 90180020
         SPACE                                                          90200020
         AIF   ('&GEN' EQ 'QTAM').L73                            A48245 90205022
RDACKRT  MVI   CCWCOUNT+1,X'01'         SET COUNT TO ONE            TSO 90210020
         LA    RWKA,LCBERCCW+12         RESPONSE ADDRESS            TSO 90220020
         BR    REXPND                   RETURN                      TSO 90230020
.L73     ANOP                                                    S99228 90231022
WRSEL    EQU   *                                                 S99228 90233022
* 3270 LOCAL SELECT EXPANDER                                     S99228 90236022
         SR    RWKA,RWKA                CLEAR ADDR REGISTER      S99228 90239022
         MVI   CCWCOUNT+ONE,ONE         SET DATA COUNT AT ONE    S99228 90242022
         BR    REXPND                   RETURN                   S99228 90245022
         SPACE                                                          90250020
*  E Q U A T E S  D I R E C T O R Y                                     90500020
*                                                                       90550020
*        D E V I C E    C H A R A C T E R I S T I C S                   90600020
*                                                                       90650020
* BYTE 2                                                                90700020
CBISYNC  EQU   X'80'                                                    90750020
C3270    EQU   X'04'                    3270 DEVICE              S99228 90752022
         AIF   ('&GEN' EQ 'MINI').L73C                           S22026 90758022
         AIF   ('&GEN' EQ 'STSP').L73C                           S22026 90766022
         AIF   ('&GEN' EQ 'QTAM').L73C                           S22026 90774022
CBRDCAST EQU   X'40' .                                           S22026 90782022
.L73C    ANOP                                                    S22026 90790022
CTWX     EQU   X'20'                                                    90800020
CSTNCTL  EQU   X'10'                                                    90850020
CXMITCTL EQU   X'08'                                                    90900020
CCONTENT EQU   X'04'                                                    90950020
CLOCAL   EQU   X'02'                                                    91000020
CAUDIO   EQU   X'01'                                                    91050020
* BYTE 3                                                                91100020
CWTTA    EQU   X'40'                    WORLD TRADE TELEGRAPH           91150020
CENDCTL  EQU   X'20'                    END TO END CONTROLS (2780)      91200020
CCHECK   EQU   X'10'                    CHECKING                        91250020
CBFRD    EQU   X'08'                    BUFFERED TERM.                  91300020
CCONTIN  EQU   X'04'                    CAPABLE OF CONTINUE OPER.       91350020
CNOIDLES EQU   X'02'                   NO IDLES DEFINED                 91400020
C2760    EQU   X'01'                    2760                            91450020
* BYTE 1                                                                91500020
CINHIBIT EQU   X'80'                    USE READ INHIBIT CCW'S          91550020
CBREAK   EQU   X'40'                    TERM HAS REVERSE BREAK FEATURE  91600020
CATTEN   EQU   X'20'                    TERM HAS ATTENTION FEATURE      91650020
C5041    EQU   X'10'                    2741'S AND 1050'S SUPPORTED     91700020
C2741    EQU   X'08'                    2741 ON THIS LINE               91750020
*                                                                       91800020
IDLOC    EQU   4                        OFFSET INTO ILIST               91850020
AUTOPL   EQU   X'01'                    AUTOPOLL FLAG IN ILIST          91900020
CUMASK   EQU   X'01'                    CU ENTRY DVC CHARS TABLE S99228 91910022
F0       EQU   X'F0'                    MASK USED FOR DAIL UP           91950020
AUTOCALL EQU   X'80'                   UBC MASK-AUTOCALL        SA57685 91950522
UCBTYP2  EQU   X'11'                   UCB OFFSET TO DIAL FEAT  SA57685 91951022
UCBID    EQU   X'0D'                   UCB OFFSET TO UCB ID     SA57685 91951522
SENDVTO  EQU   X'0E'                    SEND STCB FOR LEASED LINE       92000020
UNEX     EQU   X'01'                    UNIT EXCEPTION IN CSW-FLG       92050020
*                                         FOR NO RESTART                92100020
THREE    EQU   3                                                        92250020
ONE      EQU   1                                                        92350020
FLAG     EQU   X'20'                    USED IN WRITE IDLES LOOP        92450020
SLNTRC   EQU   X'08'                    TRACE REQUESTED FLAG   @YA12276 92520058
TWO      EQU   2                                                        92550020
T24      EQU   24                                                       92600020
FOUR     EQU   4                                                        92750020
SEVEN    EQU   7                                                X30X5MT 92770058
EIGHT    EQU   8                                                        92800020
LCIN     EQU   X'80'                    MASK FOR LCIN                   92950020
ZERO     EQU   X'00'                                                    93050020
CALLOPT  EQU   X'70'                    MASK FOR CHECKING CLOCK@OS77867 93053000
*                                       OR CINTVL              @OS77867 93056000
PURGEXT  EQU   9             OFFSET TO ADDRESS OF IOGENER EXIT  X30X5MT 93060058
REGSAVE  EQU   28                       OFFSET INTO SAVEAREA    X30X5MT 93070058
OUTONLY  EQU   X'03'                    OUTPUT ONLY DEVICE     @OX16705 93075000
RETURN4  DC    F'4'                     RETURN CODE OF 4        X30X5MT 93080058
* *   T E M P O R A R Y                                             TSO 93100020
CVTPTR   EQU   16 .                                                 TSO 93150020
TONEOPT  EQU   X'01'                    MASK FOR TONE GENERATION        93270020
D41STICS DC    XL3'F80400'              2741                        TSO 93300020
D50STICS DC    XL3'301014'               050                        TSO 93350020
SMISEQU  DC    XL3'02BD03'                                          TSO 93370020
WCCSEQU  DC    XL5'0227F1C303'                                S22028TSO 93380022
WCCSEQA1 DC    XL5'021B314203'          ASCII WCC NO MDT SEQU  @SA71925 93383056
WCCSEQUA DC    XL5'021B314303'          ASCII SEQUENCE         @SA71925 93386056
WCCNOMDT DC    XL5'0227F1C203'                                  SA68050 93390005
DISDLEOT EQU   X'01'                    FLAG TO WRITE DLE EOT           93400020
CSVTO    EQU   X'20' .                  CONC SCH VTO             S22026 93420022
BUFFVTO  EQU   X'1A'                    BUFFRERED TERMINAL VTO          93450020
XA0      EQU   X'A0' .                  WRITE DC                 A50191 93460022
XB0      EQU   X'B0' .                  WRITE AT LINE ADDRESS    A50191 93470022
XC8      EQU   X'C8'                    LENGTH OF LCB          @ZA04039 93475058
XE0      EQU   X'E0' .                  WRITE ERASE              A50191 93480022
ASCIIEOT EQU   X'04' .                  ASCII EOT CHAR         @OZ09276 93485000
EQU3     EQU   3 .                      CONSTANT                 A50191 93490022
*                                                                       93500022
*        E X P A N D E R S    T A B L E                                 93502022
*                                                                       93504022
*        EACH ENTRY IN THIS TABLE PROVIDES...                           93506022
*              - TWO BYTES OFFSET INTHE EXPANDER ROUTINES               93508022
*              - ONE BYTE OP CODE CCW                                   93510022
*              - ONE BYTE TP CODE EXPANDER                              93512022
*                                                                       93514022
*                                                                       93516022
ORGTB1   DS    0H                                                       93518022
         SPACE 3                                                        93520022
         AIF   ('&GEN' EQ 'BISC').L58                                   93522022
SNSCW    DC    AL2(SNSRT-ORGRTN)                                        93524022
         DC    AL1(CCWSENSE)                                            93526022
         DC    AL1(TPNULL)                                              93528022
         SPACE 1                                                        93530022
NOPCCW   EQU   *                                                        93532022
         DC    AL2(NOPRT-ORGRTN)                                        93534022
         DC    AL1(CCWNOP)                                              93536022
         DC    AL1(TPNULL)                                              93538022
         SPACE 1                                                        93540022
.L58     ANOP                                                           93542022
RDSKPCW  DC    AL2(RDSKPRT-ORGRTN)                                      93544022
         DC    AL1(CCWREAD)                                             93546022
         DC    AL1(TPRDSKIP)                                            93548022
         SPACE 1                                                        93550022
TCSKPCW  DC    AL2(TCSKPRT-ORGRTN)                                      93552022
         DC    AL1(CCWTIC)                                              93554022
         DC    AL1(TPNULL)                                              93556022
         SPACE 1                                                        93558022
WREOTCW  DC    AL2(WREOTRT-ORGRTN)                                      93560022
         DC    AL1(CCWWRITE)                                            93562022
         DC    AL1(TPWREOT)                                             93564022
         SPACE 1                                                        93566022
WRPOLCW  DC    AL2(WRPOLRT-ORGRTN)                                      93568022
         DC    AL1(CCWWRITE)                                            93570022
         DC    AL1(TPWRPOLL)                                            93572022
         SPACE 1                                                        93574022
RDRSPCW  DC    AL2(RDRSPRT-ORGRTN)                                      93576022
         DC    AL1(CCWREAD)                                             93578022
         DC    AL1(TPRDRESP)                                            93580022
         SPACE 1                                                        93582022
TCBUFCW  DC    AL2(TCBUFRT-ORGRTN)                                      93584022
         SPACE 1                                                        93586022
PREPCW   DC    AL2(PREPRT-ORGRTN)                                       93588022
         DC    AL1(CCWPREP)                                             93590022
         DC    AL1(TPNULL)                                              93592022
         SPACE 1                                                        93594022
         AIF   ('&GEN' EQ 'MINI').Z9                                    93596022
POLLCW   DC    AL2(POLLRT-ORGRTN)                                       93598022
         DC    AL1(CCWPOLL)                                             93600022
         DC    AL1(TPRDRESP)                                   @YA10455 93602058
         SPACE 1                                                        93604022
TCRDXCW  DC    AL2(TCRDXRT-ORGRTN)                                      93606022
         DC    AL1(CCWTIC)                                              93608022
         DC    AL1(TPNULL)                                              93610022
         SPACE 1                                                        93612022
TCPOLCW  DC    AL2(TCPOLRT-ORGRTN)                                      93614022
         DC    AL1(CCWTIC)                                              93616022
         DC    AL1(0)                   0 TP CODE FOR LINE END TABLE    93618022
         SPACE 1                                                        93620022
.Z9      ANOP                                                           93622022
WRIDLCW  DC    AL2(WRIDLRT-ORGRTN)                                      93624022
         DC    AL1(CCWWRITE)                                            93626022
         DC    AL1(TPWRIDLE)                                            93628022
         SPACE 1                                                        93630022
TCIDLCW  DC    AL2(TCIDLRT-ORGRTN)                                      93632022
         SPACE 1                                                        93634022
WRPADCW  DC    AL2(WRPADRT-ORGRTN)                                      93636022
         DC    AL1(CCWWRITE)                                            93638022
         DC    AL1(TPWRPAD)                                             93640022
         SPACE 1                                                        93642022
         AIF   ('&GEN' EQ 'MINI').L60                                   93644022
         AIF   ('&GEN' EQ 'STSP').L60                                   93646022
         AIF   ('&GEN' EQ 'QTAM').L60                                   93648022
RDENQCW  EQU   *                        READ ENQ                        93650022
         DC    AL2(RDENQRT-ORGRTN)                                      93652022
         DC    AL1(CCWREAD)                                             93654022
         DC    AL1(TPRDENQ)                                             93656022
         SPACE                                                          93658022
.L60     ANOP                                                           93660022
WRADRCW  DC    AL2(WRADRRT-ORGRTN)                                      93662022
         DC    AL1(CCWWRITE)                                            93664022
         DC    AL1(TPWRAD)              ADDRESSING SEQUENCE             93666022
         SPACE 1                                                        93668022
WREOACW  DC    AL2(WREOART-ORGRTN)                                      93670022
         DC    AL1(CCWWRITE)                                            93672022
         DC    AL1(TPWREOA)                                             93674022
         SPACE 1                                                        93676022
         AIF   ('&GEN' EQ 'MINI').L61                                   93678022
DISBLCW  DC    AL2(DISBLRT-ORGRTN)                                      93680022
         DC    AL1(CCWDISAB)                                            93682022
         DC    AL1(TPNULL)                                              93684022
         SPACE 1                                                        93686022
DIALCW   DC    AL2(DIALRT-ORGRTN)                                       93688022
         DC    AL1(CCWDIAL)                                             93690022
         DC    AL1(TPNULL)                                              93692022
         SPACE 1                                                        93694022
ENABLCW  DC    AL2(ENABLRT-ORGRTN)                                      93696022
         DC    AL1(CCWENAB)                                             93698022
         DC    AL1(TPENABLE)                                            93700022
         SPACE 1                                                        93702022
RDTERMCW DC    AL2(RDTERMRT-ORGRTN)                                     93704022
         DC    AL1(CCWREAD)                                             93706022
         DC    AL1(TPTWXID)                                             93708022
         SPACE 1                                                        93710022
WRCPUCW  DC    AL2(WRCPURT-ORGRTN)                                      93712022
         DC    AL1(CCWWRITE)                                            93714022
         DC    AL1(TPWRCPU)                                             93716022
         SPACE 1                                                        93718022
WTTRSPCW EQU   *                                                        93720022
         DC    AL2(WTTRSPRT-ORGRTN)                                     93722022
         DC    AL1(CCWREAD)                                             93724022
         DC    AL1(TPRDRSPD)                                            93726022
.L61     ANOP                                                           93728022
RDRSPSCW DC    AL2(RDRSPSRT-ORGRTN)                                     93730022
         DC    AL1(CCWREAD)                                             93732022
         DC    AL1(TPRDRSPD)                                            93734022
         SPACE                                                          93736022
WRACKCW  DC    AL2(WRACKRT-ORGRTN)                                      93738022
         DC    AL1(CCWWRITE)                                            93740022
         DC    AL1(TPWRACK)                                             93742022
         SPACE                                                          93744022
TCCONCW  EQU   *                                                        93746022
         DC    AL2(TCCONRT-ORGRTN)                                      93748022
         DC    AL1(CCWTIC)                                              93750022
         DC    AL1(TPNULL)                                              93752022
         SPACE                                                          93754022
RDEOBCW  EQU   *                                                        93756022
         DC    AL2(RDEOBRT-ORGRTN)                                      93758022
         DC    AL1(CCWREAD)                                             93760022
         DC    AL1(TPRDRPEB)                                            93762022
         SPACE                                                          93764022
         AIF   ('&GEN' EQ 'STSP').L62C                                  93766022
         AIF   ('&GEN' EQ 'MINI').L63                                   93768022
         AIF   ('&GEN' EQ 'QTAM').L62C                         @OZ28818 93770086
WRENQCW  EQU   *                                                        93772022
         DC    AL2(WRENQRT-ORGRTN)                                      93774022
         DC    AL1(CCWWRITE)                                            93776022
         DC    AL1(TPWRENQ)                                             93778022
         SPACE                                                          93780022
RSPENQCW EQU   *                                                        93782022
         DC    AL2(RDRSPEQ-ORGRTN)                                      93784022
         DC    AL1(CCWREAD)                                             93786022
         DC    AL1(TPRSPENQ)                                            93788022
RDLCOUT  EQU   *                                                        93790022
         DC    AL2(RDLCRT-ORGRTN)                                       93792022
         DC    AL1(CCWREAD)                                             93794022
         DC    AL1(TPRDLC)                                              93796022
         SPACE                                                          93798022
WRDLETCW EQU   *                                                        93800022
         DC    AL2(WRDLETRT-ORGRTN)                                     93802022
         DC    AL1(CCWWRITE)                                            93804022
         DC    AL1(TPWRDLET)                                            93806022
         SPACE                                                          93808022
RDIDENQ  EQU   *                                                        93810022
         DC    AL2(RDENQRT-ORGRTN)                                      93812022
         DC    AL1(CCWREAD)                                             93814022
         DC    AL1(TPRDIDNQ)            READ ID ENQ                     93816022
         SPACE                                                          93818022
WRTONECW EQU   *                                                        93820022
         DC    AL2(WRTONERT-ORGRTN)                                     93822022
         DC    AL1(CCWWRITE)                                            93824022
         DC    AL1(TPWRTONE)                                            93826022
RDIDAK   EQU   *                                                        93828022
         DC    AL2(RDIDRT-ORGRTN)                                       93830022
         DC    AL1(CCWREAD)                                             93832022
         DC    AL1(TPRDIDAK)                                            93832200
.L62C    ANOP                                                  @OZ28818 93832386
         SPACE 1                                               @OX14790 93832400
TCEOTCW  DC    AL2(TCEOTRT-ORGRTN)                             @OX14790 93832600
         DC    AL1(CCWTIC)                                     @OX14790 93832800
         DC    AL1(TPNULL)                                     @OX14790 93833000
         SPACE 1                                               @OX14790 93833200
         AIF   ('&GEN' EQ 'QTAM').L62B                         @OZ28818 93836086
WRWCCCW  DC    AL2(WRWCCRT-ORGRTN)                            S22028TSO 93838022
         DC    AL1(CCWWRITE)                                  S22028TSO 93840022
         DC    AL1(TPNULL)                                    S22028TSO 93842022
WRWCCC1  DC    AL2(WRWCCR1-ORGRTN)                              SA68050 93842505
         DC    AL1(CCWWRITE)                                    SA68050 93843005
         DC    AL1(TPNULL)                                      SA68050 93843505
RDWCCCW  DC    AL2(RDWCCRT-ORGRTN)                            S22028TSO 93844022
         DC    AL1(CCWREAD)                                   S22028TSO 93846022
         DC    AL1(TPRDRESP)                                   @YA10429 93848058
         AIF   ('&GEN' EQ 'BISC').L63                                   93852022
WRSMICW  DC    AL2(WRSMIRT-ORGRTN)                                  TSO 93854022
         DC    AL1(CCWWRITE)                                        TSO 93856022
         DC    AL1(TPNULL)                                          TSO 93858022
RDACKCW  DC    AL2(RDACKRT-ORGRTN)                                  TSO 93860022
         DC    AL1(CCWREAD)                                         TSO 93862022
         DC    AL1(TPRDRESP)                                   @YA10429 93864058
IHRSPCW  DC    AL2(RDRSPRT-ORGRTN)                                  TSO 93866022
         DC    AL1(CCWINHIB)                                        TSO 93868022
         DC    AL1(TPRDRESP)                                        TSO 93870022
.L62B    ANOP                                                    A48245 93872022
WRBRKCW  EQU   *                                                        93874022
         DC    AL2(BREAKCCW-ORGRTN)                                     93876022
         DC    AL1(CCWBREAK)                                            93878022
         DC    AL1(TPNULL)                                              93880022
.L63     ANOP                                                           93882022
RESETCCW EQU   *                                                        93884022
         DC    AL2(WREOTRT-ORGRTN)                                      93886022
         DC    AL1(CCWWRITE)                                            93888022
         DC    AL1(TPRESET)                                             93890022
         SPACE                                                          93892022
WRACKNAK EQU   *                                                        93894022
         DC    AL2(WRACKRT-ORGRTN)                                      93896022
         DC    AL1(CCWWRITE)                                            93898022
         DC    AL1(TPWRAKNK)                                            93900022
SELCTCW  EQU   *                                                 S99228 93902022
         DC    AL2(WRSEL-ORGRTN)                                 S99228 93904022
         DC    AL1(CCWSEL)                                       S99228 93906022
         DC    AL1(TPNULL)                                       S99228 93908022
         EJECT                                                          93910022
*                                                                       94000022
*        M O D E L S    C H A N N E L S    P R O G R A M                94002022
*                          T A B L E                                    94004022
*                                                                       94006022
*                                                                       94008022
*        THIS TABLE IS A SET OF SUBSETS                                 94010022
*        EACH SUBSET IS AN ELEMENT OF MODEL CHANNEL PROGRAM             94012022
*                                                                       94014022
*        THE LAST BYTE OF EACH SUBSET IS THE END ELEMENT X'FF'          94016022
*        (NOT NEEDED FOR THE LAST SUBSET OF A CHANNEL PROGRAM)          94018022
*                                                                       94020022
*        EACH ENTRY IN A SUBSET CONSISTS OF TWO BYTES.                  94022022
*    *** BYTE1   OFFSET IN EXPANDERS TABLE                              94024022
*    *** BYTE2     CCW/FLAGS  BYTE                                      94026022
*                                                                       94028022
         SPACE 3                                                        94030022
MODCCW   DS    0H                                                       94032022
MODCCW00 EQU   *                                                        94034022
         DC    AL1(RDSKPCW-ORGTB1)                                      94036022
         DC    XL1'B0'                                                  94038022
         DC    AL1(TCSKPCW-ORGTB1)                                      94040022
         DC    XL1'00'                                                  94042022
         DC    X'FF'                                                    94044022
         AIF   ('&GEN' EQ 'MINI').L42                                   94046022
         AIF   ('&GEN' EQ 'STSP').L41A                                  94048022
         AIF   ('&GEN' EQ 'QTAM').L41A                                  94050022
MODCCW01 EQU   *                                                        94052022
         DC    AL1(WRDLETCW-ORGTB1)                                     94054022
         DC    AL1(CCWCC+CCWSLI)                                        94056022
         DC    AL1(DISBLCW-ORGTB1)                                      94058022
         DC    AL1(CCWCC+CCWSLI)                                        94060022
         DC    AL1(DIALCW-ORGTB1)                                       94062022
         DC    AL1(CCWCC+CCWSLI)                                        94064086
         DC    X'FF'                                                    94064186
.L41A    ANOP                                                  @OZ28818 94064286
MODCCW75 EQU   *                                               @XA08073 94064400
         DC    AL1(WREOTCW-ORGTB1)                             @XA08073 94064600
         DC    AL1(CCWCC+CCWSLI)                               @XA08073 94064800
         DC    AL1(TCEOTCW-ORGTB1)                             @OX14790 94065000
         DC    XL1'00'                                         @OX14790 94065200
         DC    X'FF'                                           @XA08073 94066458
MODCCW02 EQU   *                                                        94070022
         DC    AL1(DISBLCW-ORGTB1)                                      94072022
         DC    XL1'60'                                                  94074022
         DC    AL1(DIALCW-ORGTB1)                                       94076022
         DC    XL1'60'                                                  94078022
         DC    XL1'FF'                                                  94080022
         AIF   ('&GEN' EQ 'STSP').L43                                   94082022
         AIF   ('&GEN' EQ 'QTAM').L43                                   94084022
MODCCW07 EQU   *                                                        94086022
         DC    AL1(WRDLETCW-ORGTB1)                                     94088022
         DC    AL1(CCWCC+CCWSLI)                                        94090022
MODCCW7B EQU   *                                                        94092022
         DC    AL1(DISBLCW-ORGTB1)                                      94094022
         DC    AL1(CCWCC+CCWSLI)                                        94096022
         DC    AL1(ENABLCW-ORGTB1)                                      94098022
         DC    AL1(CCWCC+CCWSLI)                                        94100022
         DC    X'FF'                                                    94102022
MODCCW7A EQU   *                                                        94104022
         DC    AL1(WRTONECW-ORGTB1)                                     94106022
         DC    AL1(CCWCC+CCWSLI)                                        94108022
         DC    X'FF'                                                    94110022
.L43     ANOP                                                           94112022
         AIF   ('&GEN' EQ 'BISC').L44                                   94114022
MODCCW08 EQU   *                                                        94116022
         DC    AL1(DISBLCW-ORGTB1)                                      94118022
         DC    AL1(CCWCC+CCWSLI)        FLAGS                           94120022
         DC    AL1(ENABLCW-ORGTB1)                                      94122022
         DC    AL1(0)                   NO GLAGS                        94124022
         DC    XL1'FF'                                                  94126022
.L44     ANOP                                                           94128022
         AIF   ('&GEN' EQ 'STSP').L45                                   94130022
         AIF   ('&GEN' EQ 'QTAM').L45                                   94132022
MODCCW10 EQU   *                                                        94134022
         DC    AL1(RDIDENQ-ORGTB1)                                      94136022
         DC    AL1(CCWSLI)                                              94138022
         DC    X'FF'                                                    94140022
MODCCW11 EQU   *                                                        94142022
         DC    AL1(WRCPUCW-ORGTB1)                                      94144022
         DC    AL1(CCWCD+CCWSLI)                                        94146022
MODCCW12 EQU   *                                                        94148022
         DC    AL1(WRACKCW-ORGTB1)                                      94150022
         DC    AL1(CCWCC+CCWSLI)                                        94152022
         DC    AL1(TCBUFCW-ORGTB1)                                      94154022
MODCCW14 EQU   *                                                        94156022
         DC    AL1(WRCPUCW-ORGTB1)                                      94158022
         DC    AL1(CCWCD+CCWSLI)                                        94160022
MODCCW15 EQU   *                                                        94162022
         DC    AL1(WRENQCW-ORGTB1)                                      94164022
         DC    AL1(CCWCC+CCWSLI)                                        94166022
         DC    AL1(RDIDAK-ORGTB1)                                       94168022
         DC    AL1(0)                                                   94170022
         DC    X'FF'                                                    94172022
MODCCW16 EQU   *                                                        94174022
         DC    AL1(WREOTCW-ORGTB1)                                      94176022
         DC    AL1(CCWCC+CCWSLI)                                        94178022
MODCCW17 EQU   *                                                        94180022
         DC    AL1(RDENQCW-ORGTB1)                                      94182022
         DC    AL1(0)                                                   94184022
         DC    AL1(WRACKCW-ORGTB1)                                      94186022
         DC    AL1(CCWCC+CCWSLI)                                        94188022
         DC    AL1(TCBUFCW-ORGTB1)                                      94190022
.L45     ANOP                                                           94192022
         AIF   ('&GEN' EQ 'BISC').L46                                   94194022
MODCCW18 EQU   *                                                        94196022
         DC    AL1(WRCPUCW-ORGTB1)      WRTIE CPU ID                    94198022
         DC    AL1(CCWCC+CCWSLI)        FLAGS                           94200022
         DC    AL1(RDRSPCW-ORGTB1)      READ RESPONSE                   94202022
         DC    AL1(CCWCD)                                               94204022
         DC    AL1(TCBUFCW-ORGTB1)                                      94206022
.L42     ANOP                                                           94208022
MODCCW20 EQU   *                                                        94210022
         DC    AL1(WREOTCW-ORGTB1)                                      94212022
         DC    XL1'60'                                                  94214022
MODCCW21 EQU   *                                                        94216022
         DC    AL1(PREPCW-ORGTB1)                                       94218022
         DC    XL1'60'                                                  94220022
         DC    AL1(SNSCW-ORGTB1)                                        94222022
         DC    XL1'60'                                                  94224022
         DC    AL1(RDRSPCW-ORGTB1)                                      94226022
         DC    AL1(CCWCD)                                               94228022
         DC    AL1(TCBUFCW-ORGTB1)                                      94230022
         AIF   ('&GEN' NE '').L47                                       94232022
.L46     ANOP                                                           94234022
MODCCW22 EQU   *                        BSC POINT - POINT               94236022
         DC    AL1(PREPCW-ORGTB1)                                       94238022
         DC    XL1'60'                                                  94240022
         DC    AL1(RDENQCW-ORGTB1)      READ ENQ                        94242022
         DC    AL1(0)                   NO FLAGS                        94244022
         DC    AL1(WRACKCW-ORGTB1)      WRITE ACK                       94246022
         DC    AL1(CCWCC+CCWSLI)        FLAGS                           94248022
         DC    AL1(TCBUFCW-ORGTB1)                                      94250022
.L47     ANOP                                                           94252022
         AIF   ('&GEN' EQ 'MINI').Z8                                    94254022
MODCCW26 EQU   *                        AUTOPOLL  CCW'S                 94256022
         DC    AL1(WREOTCW-ORGTB1)                                      94258022
         DC    XL1'60'                                                  94260022
         DC    AL1(POLLCW-ORGTB1)                                       94262022
         DC    XL1'60'                                                  94264022
         DC    AL1(TCPOLCW-ORGTB1)                                      94266022
         DC    XL1'00'                                                  94268022
         DC    AL1(TCRDXCW-ORGTB1)                                      94270022
         DC    XL1'00'                                                  94272022
         DC    AL1(POLLCW-ORGTB1)                                       94274022
         DC    XL1'60'                                                  94276022
         DC    AL1(TCPOLCW-ORGTB1)                                      94278022
         DC    XL1'00'                                                  94280022
         DC    AL1(RDRSPCW-ORGTB1)                                      94282022
         DC    XL1'80'                                                  94284022
         DC    AL1(TCBUFCW-ORGTB1)                                      94286022
.Z8      ANOP                                                           94288022
MODCCW28 EQU   *                        MULTIPT READ INT.               94290022
         DC    AL1(WREOTCW-ORGTB1)                                      94292022
         DC    AL1(CCWCC+CCWSLI)                                        94294022
         DC    AL1(WRPOLCW-ORGTB1)                                      94296022
         DC    XL1'60'                                                  94298022
         DC    AL1(RDRSPCW-ORGTB1)                                      94300022
         DC    XL1'80'                                                  94302022
         DC    AL1(TCBUFCW-ORGTB1)                                      94304022
MODCCW29 EQU   *                                                        94306022
         AIF   ('&GEN' EQ 'BISC').L46A                                  94308022
         SPACE 1                                                        94310022
         DC    AL1(NOPCCW-ORGTB1)                                       94312022
         DC    AL1(CCWCC+CCWSLI)                                        94314022
         DC    X'FF'                                                    94316022
.L46A    ANOP                                                           94318022
         SPACE 1                                                        94320022
MODCCW30 EQU   *                                                        94322022
         DC    AL1(WRIDLCW-ORGTB1)                                      94324022
         DC    AL1(CCWCD+CCWSKIP)       FLAGS FOR WRITE IDLES           94326022
         DC    XL1'FF'                                                  94328022
         AIF   ('&GEN' EQ 'BISC').L48                                   94330022
         AIF   ('&GEN' EQ 'MINI').L49A                                  94332022
MODCCW32 EQU   *                                                        94334022
         DC    AL1(RDTERMCW-ORGTB1)                                     94336022
         DC    XL1'20'                                                  94338022
         DC    X'FF'                                                    94340022
.L48     ANOP                                                           94342022
MODCCW36 EQU   *                                                        94346022
         DC    AL1(WRPADCW-ORGTB1)                                      94348022
         DC    XL1'80'                                                  94350022
         DC    XL1'FF'                                                  94352022
         AIF   ('&GEN' EQ 'BISC').L50                                   94354022
.L49     ANOP                                                           94356022
MODCCW38 EQU   *                        START STOP CONTENTION-WRITE     94364022
         DC    AL1(WREOACW-ORGTB1)                                      94366022
         DC    AL1(CCWCD)                                               94368022
         DC    AL1(TCIDLCW-ORGTB1)                                      94370022
.L49A    ANOP                                                           94372022
MODCCW39 EQU   *                                                        94374022
         DC    AL1(WREOTCW-ORGTB1)                                      94376022
         DC    AL1(CCWCD+CCWSLI)                                        94378022
         DC    AL1(WREOACW-ORGTB1)                                      94380022
         DC    AL1(CCWCD+CCWSLI)                                        94382022
         DC    AL1(WRPADCW-ORGTB1)                                      94384022
         DC    AL1(CCWCD+CCWSLI)                                        94386022
         DC    AL1(TCIDLCW-ORGTB1)                                      94388022
         AIF   ('&GEN' NE '').L51                                       94390022
.L50     ANOP                                                           94392022
MODCCW40 EQU   *                        PT - PT BSC WRITE INITIAL       94394022
         DC    AL1(WRENQCW-ORGTB1)                                      94396022
         DC    AL1(CCWCC+CCWSLI)                                        94398022
         DC    AL1(RSPENQCW-ORGTB1)                                     94400022
         DC    AL1(0)                                                   94402022
MODCCW41 EQU   *                                                        94404022
         DC    AL1(WRADRCW-ORGTB1)                                      94406022
         DC    AL1(CCWCC+CCWSLI)                                        94408022
         DC    AL1(RDRSPSCW-ORGTB1)                                     94410022
         DC    AL1(0)                   NO FLAGS                        94412022
         DC    X'FF'                                                    94414022
         AIF   ('&GEN' EQ 'BISC').L52                                   94416022
.L51     ANOP                                                           94418022
         AIF   ('&GEN' EQ 'MINI').L53                                   94420022
MODCCW42 EQU   *                                                        94422022
         DC    AL1(WRPADCW-ORGTB1)                                      94424022
         DC    AL1(CCWCD+CCWSLI)                                        94426022
         DC    AL1(WREOTCW-ORGTB1)                                      94428022
         DC    AL1(CCWCD+CCWSLI)                                        94430022
         DC    AL1(WRADRCW-ORGTB1)                                      94432022
         DC    AL1(CCWCC+CCWSLI)                                        94434022
         DC    AL1(WTTRSPCW-ORGTB1)                                     94436022
         DC    AL1(0)                                                   94438022
         DC    AL1(WREOACW-ORGTB1)                                      94440022
         DC    AL1(CCWCD+CCWSLI)                                        94442022
         DC    AL1(TCIDLCW-ORGTB1)                                      94444022
         AIF   ('&GEN' EQ 'STSP').L53                                   94446022
         AIF   ('&GEN' EQ 'QTAM').L53                                   94448022
.L52     ANOP                                                           94450022
MODCCW43 EQU   *                                                        94452022
         DC    AL1(WRENQCW-ORGTB1)                                      94454022
         DC    AL1(CCWCC+CCWSLI)                                        94456022
         DC    AL1(RDRSPSCW-ORGTB1)                                     94458022
         DC    AL1(0)                                                   94460022
         DC    X'FF'                                                    94462022
.L53     ANOP                                                           94464022
MODCCW44 EQU   *                        MULTI-POINT WRITE INITIAL       94466022
         DC    AL1(WREOTCW-ORGTB1)                                      94468022
         DC    AL1(CCWCC+CCWSLI)                                        94470022
         DC    AL1(WRADRCW-ORGTB1)                                      94472022
         DC    XL1'60'                                                  94474022
         DC    AL1(RDRSPSCW-ORGTB1)                                     94476022
         DC    AL1(0)                   INTERRUPT ON RESPONSE           94478022
MODCCW62 EQU   *                                                        94480022
         DC    AL1(WREOACW-ORGTB1)                                      94482022
         DC    XL1'80'                                                  94484022
         DC    AL1(TCIDLCW-ORGTB1)                                      94486022
         AIF   ('&GEN' EQ 'STSP').L54                                   94488022
         AIF   ('&GEN' EQ 'MINI').L54                                   94490022
         AIF   ('&GEN' EQ 'QTAM').L54                                   94492022
MODCCW45 EQU   *                                                        94494022
         DC    AL1(WRACKNAK-ORGTB1)                                     94496022
         DC    AL1(CCWCC+CCWSLI)                                        94498022
         DC    AL1(RDLCOUT-ORGTB1)                                      94500022
         DC    AL1(CCWCD)                                               94502022
         DC    AL1(TCCONCW-ORGTB1)                                      94504022
.L54     ANOP                                                           94506022
MODCCW46 EQU   *                                                        94508022
         DC    AL1(WRACKNAK-ORGTB1)                                     94510022
         DC    XL1'60'                  FLAGS                           94512022
         DC    AL1(TCCONCW-ORGTB1)                                      94514022
         AIF   ('&GEN' EQ 'MINI').L55                                   94516022
         AIF   ('&GEN' EQ 'STSP').L55                                   94518022
         AIF   ('&GEN' EQ 'QTAM').L55                                   94520022
         SPACE                                                          94522022
MODCCW48 EQU   *                                                        94524022
         DC    AL1(RDEOBCW-ORGTB1)                                      94526022
         DC    AL1(0)                   NO FLGS                         94528022
         DC    X'FF'                                                    94530022
MODCCWFS EQU   * .                                               S22026 94532022
         DC    AL1(WREOTCW-ORGTB1) .   WRITE EOT FOR SELECTION   S22026 94534022
         DC    AL1(CCWCC+CCWSLI) .                               S22026 94536022
         DC    AL1(WRADRCW-ORGTB1) .   WRITE ADDRESSING CHARS    S22026 94538022
         DC    XL1'60' .                                         S22026 94540022
         DC    AL1(TCIDLCW-ORGTB1) .   TIC TO WRITE IDLES        S22026 94542022
         DC    X'FF' .                                           S22026 94544022
.L55     ANOP                                                           94546022
         AIF   ('&GEN' EQ 'BISC').LB                                    94548022
MODCCW50 EQU   *                                                        94550022
         DC    AL1(RDEOBCW-ORGTB1)                                      94552022
         DC    X'60'                    FLAGS                           94554022
         DC    AL1(TCCONCW-ORGTB1)                                      94556022
.LB      ANOP                                                           94558022
         SPACE 1                                                        94560022
MODCCW51 EQU   *                                                        94562022
         DC    AL1(WREOTCW-ORGTB1)                                      94564022
         DC    AL1(CCWCD+CCWSLI)                                        94566022
         DC    AL1(WRADRCW-ORGTB1)                                      94568022
         DC    AL1(CCWCC+CCWSLI)                                        94570022
         DC    AL1(RDRSPSCW-ORGTB1)                                     94572022
         DC    AL1(0)                                                   94574022
         DC    X'FF'                                                    94576022
         AIF   ('&GEN' EQ 'BISC').L56                                   94578022
         AIF   ('&GEN' EQ 'MINI').L56                                   94580022
         AIF   ('&GEN' EQ 'QTAM').L56                                   94582022
         SPACE 1                                                        94584022
MODCCW52 EQU   *                                                    TSO 94586022
         DC    AL1(WREOTCW-ORGTB1)                                  TSO 94588022
         DC    XL1'60'                                              TSO 94590022
MODCCW54 EQU   *                                                        94592022
         DC    AL1(PREPCW-ORGTB1)                                       94594022
         DC    X'60'                                                    94596022
         DC    AL1(SNSCW-ORGTB1)                                        94598022
         DC    XL1'60'                                                  94600022
         DC    AL1(IHRSPCW-ORGTB1)                                      94602022
         DC    XL1'80'                                                  94604022
         DC    AL1(TCBUFCW-ORGTB1)                                  TSO 94606022
.L56     ANOP                                                           94608022
MODCCW56 EQU   *                                                        94610022
         DC    AL1(WRACKNAK-ORGTB1)                                     94612022
         DC    AL1(0)                   NO FLGAS                        94614022
         DC    X'FF'                                                    94616022
         AIF   ('&GEN' EQ 'BISC').L57                                   94618022
MODCCW58 EQU   *                                                        94620022
         DC    AL1(WREOACW-ORGTB1)                                      94622022
         DC    AL1(CCWCC+CCWSLI)                                        94624022
         DC    X'FF'                                                    94626022
.L57     ANOP                                                           94628022
MODCCW60 EQU   *                                                        94630022
         DC    AL1(WRACKCW-ORGTB1)                                      94632022
         DC    AL1(CCWCC+CCWSLI)                                        94634022
         DC    X'FF'                                                    94636022
         AIF   ('&GEN' EQ 'MINI').M7                                    94638022
MODCCW63 EQU   *                                                        94640022
         DC    AL1(WRCPUCW-ORGTB1)                                      94642022
         DC    AL1(CCWCC+CCWSLI)                                        94644022
.M7      ANOP                                                           94646022
MODCCW64 EQU   *                                                        94648022
         DC    AL1(RDRSPCW-ORGTB1)                                      94650022
         DC    AL1(CCWCD+CCWSLI)                                        94652022
         DC    AL1(TCBUFCW-ORGTB1)                                      94654022
         AIF   ('&GEN' EQ 'BISC').LD                                    94656022
         AIF   ('&GEN' EQ 'MINI').LD                                    94658022
         AIF   ('&GEN' EQ 'QTAM').LD                                    94660022
         SPACE                                                          94662022
MODCCW19 EQU   *                                                        94664022
         DC    AL1(WRCPUCW-ORGTB1)                                      94666022
         DC    AL1(CCWCC+CCWSLI)                                        94668022
         DC    AL1(IHRSPCW-ORGTB1)                                      94670022
         DC    AL1(CCWCD)                                               94672022
         DC    AL1(TCBUFCW-ORGTB1)                                      94674022
MODCCW70 EQU   *                                                    TSO 94676022
         DC    AL1(WREOTCW-ORGTB1)                                  TSO 94678022
         DC    XL1'60'                                              TSO 94680022
         DC    AL1(PREPCW-ORGTB1)                                   TSO 94682022
         DC    XL1'60'                                              TSO 94684022
         DC    AL1(WRPADCW-ORGTB1)                                  TSO 94686022
         DC    XL1'80'                                              TSO 94688022
         DC    AL1(TCBUFCW-ORGTB1)                                  TSO 94690022
MODCCW90 EQU   *                                                    TSO 94692022
         DC    AL1(WRSMICW-ORGTB1)                                  TSO 94694022
         DC    XL1'60'                                              TSO 94696022
         DC    AL1(RDACKCW-ORGTB1)                                  TSO 94698022
         DC    XL1'60'                                              TSO 94700022
         DC    AL1(WREOTCW-ORGTB1)                                  TSO 94702022
         DC    XL1'60'                                              TSO 94704022
         DC    AL1(WRPOLCW-ORGTB1)                                  TSO 94706022
         DC    XL1'60'                                              TSO 94708022
         DC    AL1(RDRSPCW-ORGTB1)                                  TSO 94710022
         DC    XL1'80'                                              TSO 94712022
         DC    AL1(TCBUFCW-ORGTB1)                                  TSO 94714022
MODCCW91 EQU   *                                                    TSO 94716022
         DC    AL1(WREOTCW-ORGTB1)                                  TSO 94718022
         DC    AL1(CCWCC+CCWSLI)                                    TSO 94720022
         DC    AL1(WRPOLCW-ORGTB1)                                  TSO 94722022
         DC    XL1'60'                                              TSO 94724022
         DC    AL1(IHRSPCW-ORGTB1)                                  TSO 94726022
         DC    XL1'80'                                              TSO 94728022
         DC    AL1(TCBUFCW-ORGTB1)                                  TSO 94730022
MODCCW92 EQU   *                                              S22028TSO 94732022
         DC    AL1(WRWCCCW-ORGTB1)                            S22028TSO 94734022
         DC    XL1'60'                                        S22028TSO 94736022
         DC    AL1(RDWCCCW-ORGTB1)                            S22028TSO 94738022
         DC    XL1'60'                                        S22028TSO 94740022
         DC    AL1(WREOTCW-ORGTB1)                            S22028TSO 94742022
         DC    AL1(0)                                         S22028TSO 94744022
         DC    X'FF'                                          S22028TSO 94746022
MODCCW93 DC    AL1(WRWCCC1-ORGTB1)                              SA68050 94746205
         DC    XL1'60'                                          SA68050 94746405
         DC    AL1(RDWCCCW-ORGTB1)                              SA68050 94746605
         DC    XL1'60'                                          SA68050 94746805
         DC    AL1(WREOTCW-ORGTB1)                              SA68050 94747005
         DC    AL1(0)                                           SA68050 94747205
         DC    X'FF'                                            SA68050 94747405
.LD      ANOP                                                           94748022
MODCCW72 EQU   *                                                        94750022
         DC    AL1(RESETCCW-ORGTB1)                                     94752022
         DC    AL1(0)                                                   94754022
         DC    X'FF'                                                    94756022
         AIF   ('&GEN' EQ 'MINI').L4R5                         @YA03846 94758056
MODCCW73 EQU   *   3270 LOCAL READ CHANNEL PROGRAM               S99228 94760022
         DC    AL1(SELCTCW-ORGTB1)                               S99228 94762022
         DC    AL1(CCWCC+CCWSLI)                                 S99228 94764022
         DC    AL1(TCBUFCW-ORGTB1)                               S99228 94766022
MODCCW74 EQU   *   3270 LOCAL WRITE CHANNEL PROGRAM              S99228 94768022
         DC    AL1(SELCTCW-ORGTB1)                               S99228 94770022
         DC    AL1(CCWCC+CCWSLI)                                 S99228 94772022
         DC    X'FF'                                             S99228 94774022
.L4R5    ANOP                                                           94776022
IOGENEND EQU   *                        END OF IOGENER CODE     OY00451 94777005
         EJECT                                                          94778022
*        DCBD  DSORG=TX                                                 95000022
         DCBD  DSORG=TX                                                 95001022
         EJECT                                                          95002022
*        TAVTD                                                          95003022
         TAVTD                                                          95004022
         EJECT                                                          95005022
*        TCCWD                                                          95006022
         TCCWD                                                          95007022
         EJECT                                                          95008022
*        TDEBD                                                          95009022
         TDEBD                                                          95010022
         EJECT                                                          95011022
*        TDISPD                                                         95012022
         TDISPD                                                         95013022
         EJECT                                                          95014022
*        TLCBD                                                          95015022
         TLCBD                                                          95016022
         EJECT                                                          95017022
*        TPRFD                                                          95018022
         TPRFD                                                          95019022
         EJECT                                                          95020022
*        TPRIOR                                                         95021022
         TPRIOR                                                         95022022
         EJECT                                                          95023022
*        TQCBD                                                          95024022
         TQCBD                                                          95025022
         EJECT                                                          95026022
*        TQCBED                                                         95027022
         TQCBED                                                         95028022
         EJECT                                                          95029022
*        TSCBD                                                          95030022
         TSCBD                                                          95031022
         EJECT                                                          95032022
*        TSTCBD                                                         95033022
         TSTCBD                                                         95034022
         EJECT                                                          95035022
*        TTSID                                                          95036022
         TTSID                                                          95037022
         EJECT                                                          95038022
*        TTNTD                                                          95039022
         TTNTD                                                          95040022
         EJECT                                                          95041022
*        TTPD                                                           95042022
         TTPD                                                           95043022
         EJECT                                                          95044022
*        TTRMD                                                          95045022
         TTRMD                                                          95046022
         MEND                                                           95260022
