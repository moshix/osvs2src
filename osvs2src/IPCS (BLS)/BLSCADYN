         TITLE 'EP=BLSCADYN -- IPCS DAS DYNAMIC ALLOCATION INTERFACE   *00001000
                        '                                               00002000
*     /* CHANGE ACTIVITY                                                00003000
*    THIS MODULE IS WRITTEN FOR @G57LPSR                                00004000
BLSCADYN CSECT ,                                                   0002 00005000
@MAINENT DS    0H                                                  0002 00006000
         USING *,@15                                               0002 00007000
         B     @PROLOG                                             0002 00008000
         DC    AL1(16)                                             0002 00009000
         DC    C'BLSCADYN  78.062'                                 0002 00010000
         DROP  @15                                                      00011000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00012000
         BALR  @12,0                                               0002 00013000
@PSTART  DS    0H                                                  0002 00014000
         USING @PSTART,@12                                         0002 00015000
         L     @00,@SIZDATD                                        0002 00016000
         BLSCGETS R,LV=(0)                                              00017000
         LR    @11,@01                                             0002 00018000
         USING @DATD,@11                                           0002 00019000
         ST    @13,@SA00001+4                                      0002 00020000
         LM    @00,@01,20(@13)                                     0002 00021000
         ST    @11,8(,@13)                                         0002 00022000
         LR    @13,@11                                             0002 00023000
*   DMCBPTR=GPR01P;                 /* BASE THE DMCB                 */ 00024000
         LR    DMCBPTR,GPR01P                                      0033 00025000
*   RFY                                                            0034 00026000
*     GPR01P UNRSTD;                                               0034 00027000
*   MODNAME=LMODNMC;                /* INIT THE MODULE NAME          */ 00028000
         MVC   MODNAME(8),@CC00522                                 0035 00029000
*   RETCODE=F0C;                    /* INIT THE MODULE RETURN CODE   */ 00030000
         SLR   @10,@10                                             0036 00031000
         ST    @10,RETCODE                                         0036 00032000
*   SUBCODE=F0C;                    /* INIT THE SUBROUTINE RETURN  0037 00033000
*                                      CODE                          */ 00034000
         ST    @10,SUBCODE                                         0037 00035000
*   S99TUFP=F0C;                    /* INIT THE TEXT UNIT MULTIPLE 0038 00036000
*                                      ENTRY BASE (UNUSED VARIABLE)  */ 00037000
*                                                                  0038 00038000
         SLR   S99TUFP,S99TUFP                                     0038 00039000
*   /*****************************************************************/ 00040000
*   /*                                                               */ 00041000
*   /* PERFORM DYNAMIC ALLOCATION FUNCTION                           */ 00042000
*   /*                                                               */ 00043000
*   /*****************************************************************/ 00044000
*                                                                  0039 00045000
*   RFY                                                            0039 00046000
*    (GPR01P,                                                      0039 00047000
*     GPR15F) RSTD;                                                0039 00048000
*   GPR01P=ADDR(DMCBDRBP);          /* PASS DYNALLOC PARM LIST     0040 00049000
*                                      ADDRESS                       */ 00050000
         LA    GPR01P,DMCBDRBP(,DMCBPTR)                           0040 00051000
*/* MACDATE Y-2 73082                                                */ 00052000
*                                                                  0041 00053000
*   SVC(99);                        /* PERFORM DYNAMIC ALLOCATION  0041 00054000
*                                      FUNCTION                      */ 00055000
         SVC   99                                                  0041 00056000
*   SUBCODE=GPR15F;                 /* SAVE SUBROUTINE RETURN CODE 0042 00057000
*                                      FOR EXAMINATION               */ 00058000
         ST    GPR15F,SUBCODE                                      0042 00059000
*   RFY                                                            0043 00060000
*    (GPR01P,                                                      0043 00061000
*     GPR15F) UNRSTD;                                              0043 00062000
*   IF SUBCODE^=F0C THEN            /* TEST FOR SUBROUTINE ERROR     */ 00063000
         L     @10,SUBCODE                                         0044 00064000
         LTR   @10,@10                                             0044 00065000
         BZ    @RF00044                                            0044 00066000
*     DO;                           /* DYNAMIC ALLOCATION FUNCTION 0045 00067000
*                                      FAILED                        */ 00068000
*                                                                  0045 00069000
*       /*************************************************************/ 00070000
*       /*                                                           */ 00071000
*       /* PERFORM ALLOCATION ERROR ANALYSIS FUNCTION                */ 00072000
*       /*                                                           */ 00073000
*       /*************************************************************/ 00074000
*                                                                  0046 00075000
*       DMCBSUBC=SUBCODE;           /* DYNALLOC RETURN CODE          */ 00076000
         ST    @10,DMCBSUBC(,DMCBPTR)                              0046 00077000
*       RFY                                                        0047 00078000
*        (GPR01P) RSTD;                                            0047 00079000
*       GPR01P=DMCBPTR;             /* PASS DMCB ADDRESS             */ 00080000
         LR    GPR01P,DMCBPTR                                      0048 00081000
*       RFY                                                        0049 00082000
*        (GPR01P) UNRSTD;                                          0049 00083000
*       CALL BLSCANAL;              /* PERFORM ERROR ANALYSIS        */ 00084000
         L     @15,@CV00270                                        0050 00085000
         BALR  @14,@15                                             0050 00086000
*       RFY                                                        0051 00087000
*        (GPR15F) RSTD;                                            0051 00088000
*       SUBCODE=GPR15F;             /* SAVE RETURN CODE FOR TEST     */ 00089000
         ST    GPR15F,SUBCODE                                      0052 00090000
*       RFY                                                        0053 00091000
*        (GPR15F) UNRSTD;                                          0053 00092000
*       IF SUBCODE^=F0C THEN        /* TEST FOR SUBROUTINE ERROR     */ 00093000
         L     @10,SUBCODE                                         0054 00094000
         LTR   @10,@10                                             0054 00095000
         BZ    @RF00054                                            0054 00096000
*         DO;                       /* ERROR ANALYSIS FAILED         */ 00097000
*           RETCODE=SUBCODE;        /* MARK ERROR TO CALLER          */ 00098000
         ST    @10,RETCODE                                         0056 00099000
*           IF SUBCODE^=SEVERE THEN /* TEST FOR OTHER THAN GETMAIN 0057 00100000
*                                      ERROR                         */ 00101000
         C     @10,@CF00502                                        0057 00102000
         BE    @RF00057                                            0057 00103000
*             DO;                   /* OTHER ERROR ANALYSIS ERROR    */ 00104000
*               DO;                 /* BLSDMSG (ZZ2,NOMSG,DMCBMSG,0)    00105000
*                                      ROUTE(TERM)                   */ 00106000
*                 CALL BLSDMSG0(ZZ2,NOMSG,DMCBMSG,0,'00010000'B,0);/*   00107000
*                                      BUILD MESSAGE                 */ 00108000
         MVC   @AL00001+4(20),@AL00060                             0060 00109000
         L     @10,DMCBTVP(,DMCBPTR)                               0060 00110000
         ST    @10,@AL00001                                        0060 00111000
         LA    @10,DMCBMSG(,DMCBPTR)                               0060 00112000
         ST    @10,@AL00001+8                                      0060 00113000
         L     @15,DMCBMSG0(,DMCBPTR)                              0060 00114000
         LA    @01,@AL00001                                        0060 00115000
         BALR  @14,@15                                             0060 00116000
*               END;                /* BLSDMSG (ZZ2,NOMSG,DMCBMSG,0)    00117000
*                                      ROUTE(TERM) OUTPUT MESSAGE  0061 00118000
*                                      LIST                          */ 00119000
*               DO;                 /* ABEND(F133C) DUMP USER        */ 00120000
*                 RESPECIFY                                        0063 00121000
*                  (GPR01F) RESTRICTED;                            0063 00122000
*                 GPR01F=(F133C)&'00000FFF'X;/* COMP CODE IN BITS  0064 00123000
*                                      20-31                         */ 00124000
         LA    GPR01F,133                                          0064 00125000
*                 GPR01F=GPR01F|'80000000'X;/* DUMP/STEP/DUMPOPTS  0065 00126000
*                                      FLAG                          */ 00127000
         O     GPR01F,@CF00531                                     0065 00128000
*                 SVC(13);          /* ISSUE ABEND SVC               */ 00129000
         SVC   13                                                  0066 00130000
*                 RESPECIFY                                        0067 00131000
*                  (GPR01F) UNRESTRICTED;                          0067 00132000
*               END;                /* ABEND(F133C) DUMP USER SVC99     00133000
*                                      ERROR ANALYSIS FAILED         */ 00134000
*             END;                  /* OTHER ERROR ANALYSIS ERROR    */ 00135000
*         END;                      /* ERROR ANALYSIS FAILED         */ 00136000
*       ELSE                                                       0071 00137000
*         DO;                       /* ERROR ANALYSIS OK             */ 00138000
         B     @RC00054                                            0071 00139000
@RF00054 DS    0H                                                  0072 00140000
*           RETCODE=ERROR;                                         0072 00141000
         MVC   RETCODE(4),@CF00044                                 0072 00142000
*         END;                      /* ERROR ANALYSIS OK             */ 00143000
*     END;                          /* DYNAMIC ALLOCATION FUNCTION 0074 00144000
*                                      FAILED                        */ 00145000
         EJECT                                                          00146000
*   ELSE                                                           0075 00147000
*     DO;                           /* DATA SET ALLOCATED, COMPLETE     00148000
*                                      THE DMCB INITIALIZATION       */ 00149000
*                                                                  0075 00150000
         B     @RC00044                                            0075 00151000
@RF00044 DS    0H                                                  0076 00152000
*       /*************************************************************/ 00153000
*       /*                                                           */ 00154000
*       /* DATA SET ALLOCATED, COMPLETE THE DMCB INITIALIZATION      */ 00155000
*       /*                                                           */ 00156000
*       /*************************************************************/ 00157000
*                                                                  0076 00158000
*       MLEN=F0C;                   /* INIT MOVE LENGTH TO KEEP THE     00159000
*                                      COMPILER QUIET                */ 00160000
         SLR   MLEN,MLEN                                           0076 00161000
*       KEYSW=F0C;                  /* DO THE SAME FOR THE KEY FOUND    00162000
*                                      SWITCH                        */ 00163000
         SLR   KEYSW,KEYSW                                         0077 00164000
*       IF DMCBDDNM(F1C)=LHEX0C THEN/* TEST DDNAME NOT FILLED IN     */ 00165000
         CLI   DMCBDDNM(DMCBPTR),X'00'                             0078 00166000
         BNE   @RF00078                                            0078 00167000
*         DO;                       /* FILL IN DDNAME                */ 00168000
*           DMCBDDNM='';            /* INIT THE ASSIGNED DDNAME TO 0080 00169000
*                                      BLANKS                        */ 00170000
         MVI   DMCBDDNM(DMCBPTR),C' '                              0080 00171000
         MVC   DMCBDDNM+1(7,DMCBPTR),DMCBDDNM(DMCBPTR)             0080 00172000
*           CALL GETDAT(DALRTDDN,DMCBDDNM);/* FILL IN THE DDNAME   0081 00173000
*                                      ASSIGNED                      */ 00174000
         LA    @10,@CB00450                                        0081 00175000
         ST    @10,@AL00001                                        0081 00176000
         LA    @10,DMCBDDNM(,DMCBPTR)                              0081 00177000
         ST    @10,@AL00001+4                                      0081 00178000
         LA    @01,@AL00001                                        0081 00179000
         BAL   @14,GETDAT                                          0081 00180000
*         END;                      /* FILL IN DDNAME                */ 00181000
*       IF DMCBDSN(F1C)=LHEX0C THEN /* TEST DSNAME NOT FILLED IN     */ 00182000
@RF00078 CLI   DMCBDSN(DMCBPTR),X'00'                              0083 00183000
         BNE   @RF00083                                            0083 00184000
*         DO;                       /* FILL IN DSNAME                */ 00185000
*           DMCBDSN='';             /* INIT THE ASSIGNED DSNAME TO 0085 00186000
*                                      BLANKS                        */ 00187000
         MVI   DMCBDSN(DMCBPTR),C' '                               0085 00188000
         MVC   DMCBDSN+1(43,DMCBPTR),DMCBDSN(DMCBPTR)              0085 00189000
*           CALL GETDAT(DALRTDSN,DMCBDSN);/* FILL IN THE DSNAME    0086 00190000
*                                      ASSIGNED                      */ 00191000
         LA    @10,@CB00452                                        0086 00192000
         ST    @10,@AL00001                                        0086 00193000
         LA    @10,DMCBDSN(,DMCBPTR)                               0086 00194000
         ST    @10,@AL00001+4                                      0086 00195000
         LA    @01,@AL00001                                        0086 00196000
         BAL   @14,GETDAT                                          0086 00197000
*         END;                      /* FILL IN DSNAME                */ 00198000
*       IF DMCBVOL(F1C)=LHEX0C THEN /* TEST VOLUME SERIAL NOT FILLED    00199000
*                                      IN                            */ 00200000
@RF00083 CLI   DMCBVOL(DMCBPTR),X'00'                              0088 00201000
         BNE   @RF00088                                            0088 00202000
*         DO;                       /* FILL IN VOLUME SERIAL         */ 00203000
*           DMCBVOL='';             /* INIT THE ASSIGNED VOLUME    0090 00204000
*                                      SERIAL TO BLANKS              */ 00205000
         MVI   DMCBVOL(DMCBPTR),C' '                               0090 00206000
         MVC   DMCBVOL+1(5,DMCBPTR),DMCBVOL(DMCBPTR)               0090 00207000
*           CALL GETDAT(DALRTVOL,DMCBVOL);/* FILL IN THE VOLUME    0091 00208000
*                                      SERIAL ASSIGNED               */ 00209000
         LA    @10,@CB00466                                        0091 00210000
         ST    @10,@AL00001                                        0091 00211000
         LA    @10,DMCBVOL(,DMCBPTR)                               0091 00212000
         ST    @10,@AL00001+4                                      0091 00213000
         LA    @01,@AL00001                                        0091 00214000
         BAL   @14,GETDAT                                          0091 00215000
*         END;                      /* FILL IN VOLUME SERIAL         */ 00216000
*       DMCBDSOR=LHEX0SC;           /* INIT THE DSORG TO ZEROS       */ 00217000
@RF00088 MVC   DMCBDSOR(2,DMCBPTR),@CB00518                        0093 00218000
*       CALL GETDAT(DALRTORG,DMCBDSOR);/* FILL IN THE DSORG          */ 00219000
         LA    @10,@CB00454                                        0094 00220000
         ST    @10,@AL00001                                        0094 00221000
         LA    @10,DMCBDSOR(,DMCBPTR)                              0094 00222000
         ST    @10,@AL00001+4                                      0094 00223000
         LA    @01,@AL00001                                        0094 00224000
         BAL   @14,GETDAT                                          0094 00225000
*       IF DMCBSTAT=LHEX0C THEN     /* TEST DS STATUS NOT FILLED IN  */ 00226000
         CLI   DMCBSTAT(DMCBPTR),X'00'                             0095 00227000
         BNE   @RF00095                                            0095 00228000
*         CALL GETDAT(DALSTATS,DMCBSTAT);/* FILL IN DATA SET STATUS  */ 00229000
         LA    @10,@CB00288                                        0096 00230000
         ST    @10,@AL00001                                        0096 00231000
         LA    @10,DMCBSTAT(,DMCBPTR)                              0096 00232000
         ST    @10,@AL00001+4                                      0096 00233000
         LA    @01,@AL00001                                        0096 00234000
         BAL   @14,GETDAT                                          0096 00235000
*       IF DMCBDISP=LHEX0C THEN     /* TEST DS DISPOSITION NOT FILLED   00236000
*                                      IN                            */ 00237000
@RF00095 CLI   DMCBDISP(DMCBPTR),X'00'                             0097 00238000
         BNE   @RF00097                                            0097 00239000
*         CALL GETDAT(DALNDISP,DMCBDISP);/* FILL IN DATA SET       0098 00240000
*                                      DISPOSITION                   */ 00241000
         LA    @10,@CB00290                                        0098 00242000
         ST    @10,@AL00001                                        0098 00243000
         LA    @10,DMCBDISP(,DMCBPTR)                              0098 00244000
         ST    @10,@AL00001+4                                      0098 00245000
         LA    @01,@AL00001                                        0098 00246000
         BAL   @14,GETDAT                                          0098 00247000
*       IF DMCBUNIT(F1C)=LHEX0C THEN/* TEST UNIT NOT FILLED IN       */ 00248000
@RF00097 CLI   DMCBUNIT(DMCBPTR),X'00'                             0099 00249000
         BNE   @RF00099                                            0099 00250000
*         DO;                       /* FILL IN UNIT                  */ 00251000
*           DMCBUNIT='';            /* INIT THE UNIT DESCRIPTION TO     00252000
*                                      BLANKS                        */ 00253000
         MVI   DMCBUNIT(DMCBPTR),C' '                              0101 00254000
         MVC   DMCBUNIT+1(7,DMCBPTR),DMCBUNIT(DMCBPTR)             0101 00255000
*           CALL GETDAT(DALUNIT,DMCBUNIT);/* FILL IN THE UNIT      0102 00256000
*                                      DESCRIPTION                   */ 00257000
         LA    @10,@CB00322                                        0102 00258000
         ST    @10,@AL00001                                        0102 00259000
         LA    @10,DMCBUNIT(,DMCBPTR)                              0102 00260000
         ST    @10,@AL00001+4                                      0102 00261000
         LA    @01,@AL00001                                        0102 00262000
         BAL   @14,GETDAT                                          0102 00263000
*         END;                      /* FILL IN UNIT                  */ 00264000
*       IF DMCBVSF=ON THEN          /* TEST FOR VSAM DATA SET      0104 00265000
*                                      ALLOCATION                    */ 00266000
@RF00099 TM    DMCBVSF(DMCBPTR),B'00000001'                        0104 00267000
         BNO   @RF00104                                            0104 00268000
*         ACBDDNM=DMCBDDNM;         /* FILL IN ACB DDNAME FIELD      */ 00269000
         MVC   ACBDDNM(8,DMCBPTR),DMCBDDNM(DMCBPTR)                0105 00270000
*       ELSE                                                       0106 00271000
*         DCBDDNAM=DMCBDDNM;        /* FILL IN DCB DDNAME FIELD      */ 00272000
         B     @RC00104                                            0106 00273000
@RF00104 MVC   DCBDDNAM(8,DMCBPTR),DMCBDDNM(DMCBPTR)               0106 00274000
*     END;                          /* DATA SET ALLOCATED, COMPLETE     00275000
*                                      THE DMCB INITIALIZATION       */ 00276000
*                                                                  0107 00277000
@RC00104 DS    0H                                                  0108 00278000
*   /*****************************************************************/ 00279000
*   /*                                                               */ 00280000
*   /* ALLOCATION COMPLETE, RETURN TO CALLER                         */ 00281000
*   /*                                                               */ 00282000
*   /*****************************************************************/ 00283000
*                                                                  0108 00284000
*   RETURN CODE(RETCODE);                                          0108 00285000
@RC00044 L     @10,RETCODE                                         0108 00286000
         L     @13,4(,@13)                                         0108 00287000
         L     @00,@SIZDATD                                        0108 00288000
         LR    @01,@11                                             0108 00289000
         BLSCFRES R,LV=(0),A=(1)                                        00290000
         LR    @15,@10                                             0108 00291000
         L     @14,12(,@13)                                        0108 00292000
         LM    @00,@12,20(@13)                                     0108 00293000
         BR    @14                                                 0108 00294000
         EJECT                                                          00295000
*                                                                  0109 00296000
*   /*****************************************************************/ 00297000
*   /*                                                               */ 00298000
*   /* INTERNAL PROCEDURE TO FIND REQUESTED DYNALLOC TEXT UNIT       */ 00299000
*   /*                                                               */ 00300000
*   /*****************************************************************/ 00301000
*                                                                  0109 00302000
*GETDAT:                                                           0109 00303000
*   PROCEDURE(KEYX,RETVAL);                                        0109 00304000
GETDAT   STM   @14,@12,12(@13)                                     0109 00305000
         MVC   @PC00002(8),0(@01)                                  0109 00306000
*   DCL                                                            0110 00307000
*     KEYX CHAR(2);                 /* TEXT UNIT KEY TO SEARCH ON    */ 00308000
*   DCL                                                            0111 00309000
*     RETVAL CHAR(*);               /* VALUE RETURNED                */ 00310000
*   MLEN=F0C;                       /* INITIALIZE THE TU PARM LENGTH    00311000
*                                      VALUE                         */ 00312000
         SLR   MLEN,MLEN                                           0112 00313000
*   KEYSW=F0C;                      /* INIT THE KEY FOUND SWITCH TO     00314000
*                                      NOT FOUND                     */ 00315000
         SLR   KEYSW,KEYSW                                         0113 00316000
*   DO S99TUPLX=F1C TO DMALTUPM WHILE KEYSW=F0C;/* LOOP THROUGH TEXT    00317000
*                                      UNITS                         */ 00318000
         LA    S99TUPLX,1                                          0114 00319000
         B     @DE00114                                            0114 00320000
@DL00114 SLR   @10,@10                                             0114 00321000
         CR    KEYSW,@10                                           0114 00322000
         BNE   @DC00114                                            0114 00323000
*     S99TUBAS=S99TUPTR(S99TUPLX);  /* SET TEXT UNIT ADDRESABILITY   */ 00324000
         LR    @15,S99TUPLX                                        0115 00325000
         SLA   @15,2                                               0115 00326000
         L     @01,S99TXTPP(,DMCBPTR)                              0115 00327000
         AL    @01,@CF00553                                        0115 00328000
         L     S99TUBAS,S99TUPTR(@15,@01)                          0115 00329000
*     RFY                                                          0116 00330000
*       S99TUNIT BASED(S99TUBAS);                                  0116 00331000
*     IF S99TUKEY=KEYX THEN         /* TEST FOR KEY MATCH            */ 00332000
         L     @15,@PC00002                                        0117 00333000
         CLC   S99TUKEY(2,S99TUBAS),KEYX(@15)                      0117 00334000
         BNE   @RF00117                                            0117 00335000
*       DO;                         /* KEY MATCH, MOVE IN DATA AND 0118 00336000
*                                      STOP SEARCH                   */ 00337000
*         MLEN=S99TULNG;            /* MOVE LENGTH                   */ 00338000
         ICM   MLEN,12,S99TULNG(S99TUBAS)                          0119 00339000
         SRA   MLEN,16                                             0119 00340000
*         IF MLEN>F0C THEN          /* TEST FOR SOMETHING TO MOVE    */ 00341000
         CR    MLEN,@10                                            0120 00342000
         BNH   @RF00120                                            0120 00343000
*           RETVAL(F1C:MLEN)=S99TUPAR(F1C:MLEN);/* MOVE IN THE     0121 00344000
*                                      PARAMETER                     */ 00345000
         L     @10,@PC00002+4                                      0121 00346000
         LR    @15,MLEN                                            0121 00347000
         BCTR  @15,0                                               0121 00348000
         EX    @15,@SM00554                                        0121 00349000
*         KEYSW=F1C;                /* STOP SEARCH                   */ 00350000
@RF00120 LA    KEYSW,1                                             0122 00351000
*       END;                        /* KEY MATCH, MOVE IN DATA AND 0123 00352000
*                                      STOP SEARCH                   */ 00353000
*   END;                            /* LOOP THROUGH TEXT UNITS       */ 00354000
@RF00117 AL    S99TUPLX,@CF00046                                   0124 00355000
@DE00114 C     S99TUPLX,DMALTUPM(,DMCBPTR)                         0124 00356000
         BNH   @DL00114                                            0124 00357000
@DC00114 DS    0H                                                  0125 00358000
*   END GETDAT;                                                    0125 00359000
@EL00002 DS    0H                                                  0125 00360000
@EF00002 DS    0H                                                  0125 00361000
@ER00002 LM    @14,@12,12(@13)                                     0125 00362000
         BR    @14                                                 0125 00363000
         EJECT                                                          00364000
*                                                                  0126 00365000
*   /*****************************************************************/ 00366000
*   /*                                                               */ 00367000
*   /* END OF EXECUTABLE PROCEDURE STATEMENTS                        */ 00368000
*   /*                                                               */ 00369000
*   /*****************************************************************/ 00370000
*                                                                  0126 00371000
*   DECLARE                         /* GENERAL PURPOSE REGISTERS     */ 00372000
*     GPR01F FIXED(31) REG(1),                                     0126 00373000
*     GPR15F FIXED(31) REG(15),                                    0126 00374000
*     GPR01P PTR(31) REG(1);                                       0126 00375000
*   DECLARE                         /* COMMON VARIABLES              */ 00376000
*     I256C CHAR(256) BASED,                                       0127 00377000
*     I031F FIXED(31) BASED,                                       0127 00378000
*     I031P PTR(31) BASED,                                         0127 00379000
*     I015F FIXED(15) BASED,                                       0127 00380000
*     I015P PTR(15) BASED,                                         0127 00381000
*     I008P PTR(8) BASED,                                          0127 00382000
*     I001C CHAR(1) BASED;                                         0127 00383000
*   DCL                                                            0128 00384000
*     1 DASPATCH LOCAL BDY(DWORD),  /* PATCH AREA                    */ 00385000
*      2 DASPATA(DASPATLN) PTR INIT((DASPATLN)0);                  0128 00386000
*   END BLSCADYN                                                   0129 00387000
*                                                                  0129 00388000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 00389000
*/*%INCLUDE SYSLIB  (IEFZB4D0)                                       */ 00390000
*/*%INCLUDE SYSLIB  (IEFZB4D2)                                       */ 00391000
*                                                                  0129 00392000
*       ;                                                          0129 00393000
@DATA    DS    0H                                                       00394000
@SM00554 MVC   RETVAL(0,@10),S99TUPAR(S99TUBAS)                         00395000
         DS    0F                                                       00396000
@AL00060 DC    A(@CF00510)             LIST WITH   5 ARGUMENT(S)        00397000
         DS    F                                                        00398000
         DC    A(@CF00190)                                              00399000
         DC    A(@CB00528)                                              00400000
         DC    A(@CF00190)                                              00401000
@DATD    DSECT                                                          00402000
         DS    0F                                                       00403000
@SA00001 DS    18F                                                      00404000
@PC00002 DS    2F                                                       00405000
@AL00001 DS    6A                                                       00406000
BLSCADYN CSECT                                                          00407000
         DS    0F                                                       00408000
@CF00190 DC    F'0'                                                     00409000
@CF00046 DC    F'1'                                                     00410000
@CF00044 DC    F'8'                                                     00411000
@CF00502 DC    F'12'                                                    00412000
@CF00553 DC    F'-4'                                                    00413000
@CF00510 DC    F'-1'                                                    00414000
@CF00531 DC    XL4'80000000'                                            00415000
@DATD    DSECT                                                          00416000
         DS    0D                                                       00417000
MODSTAT  DS    CL16                                                     00418000
         ORG   MODSTAT                                                  00419000
MODNAME  DS    CL8                                                      00420000
RETCODE  DS    FL4                                                      00421000
SUBCODE  DS    FL4                                                      00422000
         ORG   MODSTAT+16                                               00423000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                00424000
@ENDDATD EQU   *                                                        00425000
BLSCADYN CSECT                                                          00426000
         DS    0F                                                       00427000
@SIZDATD DC    AL1(0)                                                   00428000
         DC    AL3(@ENDDATD-@DATD)                                      00429000
@CV00270 DC    V(BLSCANAL)                                              00430000
         DS    0D                                                       00431000
@CC00522 DC    C'BLSCADYN'                                              00432000
@CB00288 DC    X'0004'                                                  00433000
@CB00290 DC    X'0005'                                                  00434000
@CB00322 DC    X'0015'                                                  00435000
@CB00450 DC    X'0055'                                                  00436000
@CB00452 DC    X'0056'                                                  00437000
@CB00454 DC    X'0057'                                                  00438000
@CB00466 DC    X'005D'                                                  00439000
@CB00518 DC    X'0000'                                                  00440000
@CB00528 DC    B'00010000'                                              00441000
         DS    CL7                                                      00442000
DASPATCH DS    CL256                                                    00443000
         ORG   DASPATCH                                                 00444000
DASPATA  DC    64A(0)                                                   00445000
         ORG   DASPATCH+256                                             00446000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00447000
@01      EQU   01                                                       00448000
@02      EQU   02                                                       00449000
@03      EQU   03                                                       00450000
@04      EQU   04                                                       00451000
@05      EQU   05                                                       00452000
@06      EQU   06                                                       00453000
@07      EQU   07                                                       00454000
@08      EQU   08                                                       00455000
@09      EQU   09                                                       00456000
@10      EQU   10                                                       00457000
@11      EQU   11                                                       00458000
@12      EQU   12                                                       00459000
@13      EQU   13                                                       00460000
@14      EQU   14                                                       00461000
@15      EQU   15                                                       00462000
KEYSW    EQU   @02                                                      00463000
MLEN     EQU   @02                                                      00464000
S99TUBAS EQU   @03                                                      00465000
S99TUPLX EQU   @04                                                      00466000
S99TUFP  EQU   @02                                                      00467000
DMCBPTR  EQU   @05                                                      00468000
GPR01P   EQU   @01                                                      00469000
GPR15F   EQU   @15                                                      00470000
GPR01F   EQU   @01                                                      00471000
DMCB     EQU   0                                                        00472000
DMCBTVP  EQU   DMCB+8                                                   00473000
DMCBFTY  EQU   DMCB+20                                                  00474000
DMCBVSF  EQU   DMCBFTY                                                  00475000
DMCBOPN  EQU   DMCB+21                                                  00476000
DMCBRMOD EQU   DMCB+23                                                  00477000
DMCBOUT  EQU   DMCBRMOD                                                 00478000
DMCBOPTS EQU   DMCB+24                                                  00479000
DMCBGKY  EQU   DMCBOPTS                                                 00480000
DMCBMFLG EQU   DMCB+28                                                  00481000
DMCBBUFP EQU   DMCB+32                                                  00482000
DMCBKEYP EQU   DMCB+44                                                  00483000
DMCBMSG  EQU   DMCB+52                                                  00484000
DMCBRI   EQU   DMCB+64                                                  00485000
DMCBMSG0 EQU   DMCB+68                                                  00486000
DMCBFRE  EQU   DMCB+88                                                  00487000
DMCBEOB  EQU   DMCB+92                                                  00488000
DMCBACBE EQU   DMCB+124                                                 00489000
DMCBDDNM EQU   DMCB+260                                                 00490000
DMCBVOL  EQU   DMCB+268                                                 00491000
DMCBDSOR EQU   DMCB+274                                                 00492000
DMCBUNIT EQU   DMCB+276                                                 00493000
DMCBDSN  EQU   DMCB+284                                                 00494000
DMCBSTAT EQU   DMCB+366                                                 00495000
DMCBDISP EQU   DMCB+367                                                 00496000
DMCBSPEC EQU   DMCB+380                                                 00497000
DMCBDRBP EQU   DMCB+400                                                 00498000
DMCBSUBC EQU   DMCB+404                                                 00499000
DMCBAMS  EQU   DMCB+416                                                 00500000
DMCBAUDT EQU   DMCB+568                                                 00501000
DMCBLSCP EQU   DMCBAUDT+16                                              00502000
DMCBWRK  EQU   DMCB+648                                                 00503000
S99TUPL  EQU   0                                                        00504000
S99TUPTR EQU   S99TUPL                                                  00505000
S99TUP   EQU   0                                                        00506000
S99TUNIT EQU   0                                                        00507000
S99TUKEY EQU   S99TUNIT                                                 00508000
S99TUENT EQU   S99TUNIT+4                                               00509000
S99TULNG EQU   S99TUENT                                                 00510000
S99TUPAR EQU   S99TUENT+2                                               00511000
S99TUFLD EQU   0                                                        00512000
BLSDMSG0 EQU   0                                                        00513000
ZZ2      EQU   0                                                        00514000
DMCBDMGR EQU   0                                                        00515000
DMCBRQC  EQU   0                                                        00516000
I001C    EQU   0                                                        00517000
I008P    EQU   0                                                        00518000
I015F    EQU   0                                                        00519000
I015P    EQU   0                                                        00520000
I031F    EQU   0                                                        00521000
I031P    EQU   0                                                        00522000
I256C    EQU   0                                                        00523000
MODELNAM EQU   0                                                        00524000
KEYX     EQU   0                                                        00525000
RETVAL   EQU   0                                                        00526000
DMCBVSM  EQU   DMCBAMS                                                  00527000
DMCBACB  EQU   DMCBVSM+76                                               00528000
DMCBQSM  EQU   DMCBAMS                                                  00529000
DMCBDCB  EQU   DMCBQSM                                                  00530000
DMAL     EQU   DMCBWRK                                                  00531000
DMALMODA EQU   DMAL+4                                                   00532000
DMALDYRB EQU   DMAL+16                                                  00533000
DMALTUPM EQU   DMAL+36                                                  00534000
ACBDDNM  EQU   DMCBACB+40                                               00535000
DCBDDNAM EQU   DMCBDCB+40                                               00536000
S99RBPTR EQU   DMCBDRBP                                                 00537000
S99RB    EQU   DMALDYRB                                                 00538000
S99FLAG1 EQU   S99RB+2                                                  00539000
S99FLG11 EQU   S99FLAG1                                                 00540000
S99RSC   EQU   S99RB+4                                                  00541000
S99TXTPP EQU   S99RB+8                                                  00542000
S99FLAG2 EQU   S99RB+16                                                 00543000
S99FLG21 EQU   S99FLAG2                                                 00544000
S99FLG22 EQU   S99FLAG2+1                                               00545000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    00546000
S99FLG24 EQU   S99FLAG2+3                                               00547000
S99FLG23 EQU   S99FLAG2+2                                               00548000
S99PCINT EQU   S99FLG22                                                 00549000
S99UDEVT EQU   S99FLG22                                                 00550000
S99MOUNT EQU   S99FLG21                                                 00551000
S99CATLG EQU   S99FLG21                                                 00552000
S99TIONQ EQU   S99FLG21                                                 00553000
S99OFFLN EQU   S99FLG21                                                 00554000
S99WTUNT EQU   S99FLG21                                                 00555000
S99NORES EQU   S99FLG21                                                 00556000
S99WTDSN EQU   S99FLG21                                                 00557000
S99WTVOL EQU   S99FLG21                                                 00558000
S99RSV01 EQU   S99RB+12                                                 00559000
S99INFO  EQU   S99RSC+2                                                 00560000
S99ERROR EQU   S99RSC                                                   00561000
S99FLG12 EQU   S99FLAG1+1                                               00562000
S99JBSYS EQU   S99FLG11                                                 00563000
S99NOMNT EQU   S99FLG11                                                 00564000
S99NOCNV EQU   S99FLG11                                                 00565000
S99ONCNV EQU   S99FLG11                                                 00566000
S99VERB  EQU   S99RB+1                                                  00567000
S99RBLN  EQU   S99RB                                                    00568000
S99RBPND EQU   S99RBPTR                                                 00569000
DMALEND  EQU   DMAL+1196                                                00570000
DMALTUS  EQU   DMAL+172                                                 00571000
DMALTUPL EQU   DMAL+44                                                  00572000
DMALTUBS EQU   DMAL+40                                                  00573000
DMALMODP EQU   DMAL+12                                                  00574000
DMALPRMP EQU   DMAL+8                                                   00575000
DMALID   EQU   DMAL                                                     00576000
DMCBRES7 EQU   DMCBQSM+96                                               00577000
DMCBRPL  EQU   DMCBVSM                                                  00578000
S99TUPRM EQU   S99TUFLD+2                                               00579000
S99TULEN EQU   S99TUFLD                                                 00580000
S99TUNUM EQU   S99TUNIT+2                                               00581000
S99TUPND EQU   S99TUP                                                   00582000
S99TUPLN EQU   S99TUPTR                                                 00583000
DMCBRES8 EQU   DMCB+640                                                 00584000
DMCBMODN EQU   DMCB+632                                                 00585000
DMCBCARY EQU   DMCBAUDT+20                                              00586000
DMCBCLC  EQU   DMCBAUDT+12                                              00587000
DMCBOPC  EQU   DMCBAUDT+8                                               00588000
DMCBFRC  EQU   DMCBAUDT+4                                               00589000
DMCBALC  EQU   DMCBAUDT                                                 00590000
DMCBFR   EQU   DMCB+412                                                 00591000
DMCBRES6 EQU   DMCB+410                                                 00592000
DMCBIRSC EQU   DMCB+408                                                 00593000
DMCBRSZM EQU   DMCB+398                                                 00594000
DMCBRSZA EQU   DMCB+396                                                 00595000
DMCBCISZ EQU   DMCB+394                                                 00596000
DMCBDCBL EQU   DMCB+392                                                 00597000
DMCBDCLR EQU   DMCB+390                                                 00598000
DMCBDCFM EQU   DMCB+389                                                 00599000
DMCBRES5 EQU   DMCB+388                                                 00600000
DMCBLBRT EQU   DMCB+386                                                 00601000
DMCBLBSQ EQU   DMCB+384                                                 00602000
DMCBLBPS EQU   DMCB+383                                                 00603000
DMCBLBTY EQU   DMCB+382                                                 00604000
DMCBRES4 EQU   DMCB+381                                                 00605000
DMCBSPRS EQU   DMCBSPEC                                                 00606000
DMCBSPRN EQU   DMCBSPEC                                                 00607000
DMCBSPCT EQU   DMCBSPEC                                                 00608000
DMCBSPRL EQU   DMCBSPEC                                                 00609000
DMCBSPSE EQU   DMCB+376                                                 00610000
DMCBSPPR EQU   DMCB+372                                                 00611000
DMCBSPTY EQU   DMCB+369                                                 00612000
DMCBODIS EQU   DMCB+368                                                 00613000
DMCBRES3 EQU   DMCB+364                                                 00614000
DMCBMEMB EQU   DMCB+356                                                 00615000
DMCBMODL EQU   DMCB+348                                                 00616000
DMCBRES9 EQU   DMCB+340                                                 00617000
DMCBPID  EQU   DMCB+332                                                 00618000
DMCBTYPE EQU   DMCB+328                                                 00619000
DMCBSYNM EQU   DMCB+132                                                 00620000
DMCBRPLF EQU   DMCB+128                                                 00621000
DMCBDCBE EQU   DMCBACBE                                                 00622000
DMCBARC  EQU   DMCB+120                                                 00623000
DMCBCPC  EQU   DMCB+116                                                 00624000
DMCBRET  EQU   DMCB+112                                                 00625000
DMCBSTL  EQU   DMCB+96                                                  00626000
DMCBRES2 EQU   DMCB+85                                                  00627000
DMCBSPID EQU   DMCB+84                                                  00628000
DMCBRESC EQU   DMCB+80                                                  00629000
DMCBZZ1P EQU   DMCB+76                                                  00630000
DMCBMSGS EQU   DMCB+72                                                  00631000
DMCBRRL  EQU   DMCB+60                                                  00632000
DMCBRBA  EQU   DMCB+56                                                  00633000
DMCBKEYL EQU   DMCB+48                                                  00634000
DMCBKPC  EQU   DMCBKEYP                                                 00635000
DMCBORL  EQU   DMCB+40                                                  00636000
DMCBBLEN EQU   DMCB+36                                                  00637000
DMCBBFPC EQU   DMCBBUFP                                                 00638000
DMCBRES1 EQU   DMCB+31                                                  00639000
DMCBACCM EQU   DMCB+30                                                  00640000
DMCBREJ  EQU   DMCB+29                                                  00641000
DMCBRESB EQU   DMCBMFLG                                                 00642000
DMCBFMOD EQU   DMCBMFLG                                                 00643000
DMCBLOPT EQU   DMCB+27                                                  00644000
DMCBLRM  EQU   DMCB+26                                                  00645000
DMCBLRQ  EQU   DMCB+25                                                  00646000
DMCBOPRS EQU   DMCBOPTS                                                 00647000
DMCBLRD  EQU   DMCBOPTS                                                 00648000
DMCBBWD  EQU   DMCBOPTS                                                 00649000
DMCBUPD  EQU   DMCBOPTS                                                 00650000
DMCBAPX  EQU   DMCBOPTS                                                 00651000
DMCBRNO  EQU   DMCBGKY                                                  00652000
DMCBKYD  EQU   DMCBOPTS                                                 00653000
DMCBRMRS EQU   DMCBRMOD                                                 00654000
DMCBRM5  EQU   DMCBRMOD                                                 00655000
DMCBRM6  EQU   DMCBRMOD                                                 00656000
DMCBTMP  EQU   DMCBOUT                                                  00657000
DMCBRQST EQU   DMCB+22                                                  00658000
DMCBRESA EQU   DMCBOPN                                                  00659000
DMCBSOUT EQU   DMCBOPN                                                  00660000
DMCBSIN  EQU   DMCBOPN                                                  00661000
DMCBKSF  EQU   DMCBFTY                                                  00662000
DMCBFTRS EQU   DMCBFTY                                                  00663000
DMCBSHF  EQU   DMCBFTY                                                  00664000
DMCBIRL  EQU   DMCB+16                                                  00665000
DMCBRTC  EQU   DMCB+12                                                  00666000
DMCBNEXT EQU   DMCB+4                                                   00667000
DMCBID   EQU   DMCB                                                     00668000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      00669000
@RC00054 EQU   @RC00044                                                 00670000
@RF00057 EQU   @RC00054                                                 00671000
@ENDDATA EQU   *                                                        00672000
         END   BLSCADYN,(C'PLS1637',0701,78062)                         00673000
