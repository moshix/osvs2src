         MACRO                                                          00050000
&N       BLSCAMMM &NXT,&ID,&T,&AMS,&OPEN=(,(INPUT,DISP)),              *00100000
               &DDNAME=,                                               *00150000
               &DSN=,&VOL=,&UNIT=,                                     *00200000
               &SPACE=,&LABEL=,&SSREQ=,&PASSW=,&PERMA=,&CNVRT=,        *00250000
               &DISP=(SHR,KEEP,KEEP),                                  *00300000
               &DYRB=AL,                                               *00350000
               &RTDATA=(RTDDN,RTDSN,RTVOL,RTORG),                      *00400000
               &SYSOUT=                                                 00450000
.** START OF SPECIFICATIONS ******************************************* 00500000
.*                                                                      00550000
.*  MACRO NAME= BLSCAMMM                                                00600000
.*                                                                      00650000
.*  DESCRIPTIVE NAME= IPCS DAS ALLOCATION MODEL GENERATOR MACRO         00700057
.*                                                                      00750000
.*  COPYRIGHT= NONE                                                     00800000
.*                                                                      00850000
.*  STATUS= SU57 RELEASE 1, LEVEL 0                                     00900057
.*                                                                      00950000
.*  FUNCTION= GENERATE ALLOCATION AND ACCESS CONTROL BLOCK MODELS FOR   01000000
.*            IPCS DAS DATA SETS. EACH MODEL CONSISTS OF THE FOLLOWING: 01050057
.*              MODEL COMPONENT ADDRESS LIST                            01100000
.*              DATA SET ACCESS CONTROL BLOCK MODELS                    01150000
.*                OPEN/CLOSE PARAMETER LIST MODEL                       01200000
.*                VSAM ACB AND RPL MODELS                               01250000
.*                OR                                                    01300000
.*                QSAM DCB MODEL                                        01350000
.*              DYNAMIC ALLOCATION PARAMETER LIST MODELS                01400000
.*                DYNAMIC ALLOCATION REQUEST BLOCK MODEL                01450000
.*                TEXT UNIT POINTER LIST MODEL                          01500000
.*                TEXT UNIT MODELS                                      01550000
.*              FOR NEW VSAM DATA SETS, THE ACCESS METHOD SERVICES      01600000
.*              COMMAND TEXT (SYSIN) STREAM MODEL                       01650000
.*                                                                      01700000
.*  NOTES= NONE                                                         01750057
.*                                                                      01800000
.*  MODULE TYPE= DATA AREA GENERATION MACRO                             01850057
.*                                                                      01900000
.*     PROCESSOR= ASSEMBLER F                                           01950057
.*                                                                      02000000
.*     ATTRIBUTES= REENTRABLE (READ ONLY DATA)                          02050057
.*                                                                      02100000
.*  INVOCATION SYNTAX=                                                  02150057
.*                                                                      02200000
.*   LOCSYMB BLSCAMMM NEXTLOC,MODEL,TYPE,AMS                            02250057
.*                                                                      02300000
.*                    [|,ALLOCATION MODEL KEYWORDS|                     02350057
.*                                                                      02400000
.*                                                                      02450057
.*           LOCSYMB                                                    02490057
.*             1 TO 3 BYTE LOCATION SYMBOL NAME TO PERMIT THE           02530057
.*             CONSTRUCTION OF A SINGLE THREADED LIST OF MODELS WITHIN  02570057
.*             THE BLSCAMOD MODULE.                                     02610057
.*                                                                      02700000
.*           NEXTLOC                                                    02750057
.*             1 TO 3 BYTE LOCATION SYMBOL OF THE MODEL THAT IS CHAINED 02790057
.*             AS THE SUCCESSOR OF THIS MODEL. FOR THE LAST MODEL IN    02830057
.*             THE CHAIN, THIS PARAMETER IS 0.                          02870057
.*                                                                      02910057
.*           MODEL                                                      02950057
.*             1 TO 8 BYTE ALLOCATION MODEL NAME. THIS PARAMETER IS     02990057
.*             PLACED INTO AN 8 BYTE FIELD LEFT JUSTIFIED AND PADDED    03030057
.*             WITH BLANKS. THIS NAME IS SEARCHED UPON BY THE           03070057
.*             ALLOCATION FUNCTION AND THE CONTENTS OF THE MODEL ARE    03110057
.*             MOVED INTO GETMAINED SPACE TO INITIALIZE THE DATA SET    03150057
.*             CONTROL BLOCKS.                                          03190057
.*                                                                      03230057
.*           TYPE                                                       03270057
.*             THE TYPE PARAMETER CONTROLS THE RESERVATION OF SPACE FOR 03310057
.*             THE VSAM ACB AND RPL OR THE QSAM DCB. VALID VALUES ARE:  03350057
.*               V (DEFAULT) CAUSES THE GENERATION OF                   03390057
.*                           A 76 BYTE FIELD LABELED ACBNN AND          03430057
.*                           A 76 BYTE FIELD LABELED RPLNN. NN IS THE   03470057
.*                           1 TO 3 BYTE LOCSYMB FOR THIS MODEL.        03510057
.*                           IT IS ASSUMED THAT THE USER WILL CODE AN   03550057
.*                           AN ACB MACRO ORIGINED AT ACBNN AND AN RPL  03590057
.*                           MACRO ORIGINED AT RPLNN FOR A VSAM         03630057
.*                           DATA SET.                                  03670057
.*                                                                      03710057
.*               (V,LRECL)   CAUSES THE GENERATION OF THE ACB AND RPL   03750057
.*                           AS STATED FOR THE 'V' ENTRY. IN ADDITION,  03790057
.*                           IT INITIALIZES A FIELD IN THE MODEL        03830057
.*                           COMPONENT LIST WITH THE VALUE OF THE       03870057
.*                           LRECL SUB PARAMETER. LRECL MUST BE         03910057
.*                           A SELF DEFINING NUMERIC VALUE.             03950057
.*                                                                      03990057
.*               Q           CAUSES THE GENERATION A 96 BYTE FIELD      04030057
.*                           LABELED DCBNN. NN IS THE 1 TO 3 BYTE       04070057
.*                           LOCSYMB FOR THIS MODEL. IT IS ASSUMED THAT 04110057
.*                           THE USER WILL CODE A DCB MACRO ORIGINED    04150057
.*                           AT DCBNN FOR A QSAM DATA SET.              04190057
.*                                                                      04600000
.*           AMS                                                        04650057
.*             VALID PARAMETER VALUE IS 'AMS'.                          04690057
.*             THE AMS PARAMETER CAUSES THE GENERATION OF AN ENTRY      04730057
.*             IN THE MODEL COMPONENT LIST THAT CONTAINS THE NAME       04770057
.*             AMSNN. NN IS THE 1 TO 3 BYTE LOCSYMB FOR THIS MODEL.     04810057
.*             IT IS ASSUMED THAT THE USER WILL CODE AN AMS SYSIN TEXT  04850057
.*             LIST NAMED AMSNN. THE FORMAT OF THE AMS SYSIN TEXT LIST  04890057
.*             IS SPECIFIED IN THE BLSCAMIN MODULE PROLOG.              04930057
.*                                                                      04970057
.*           ALLOCATION MODEL KEYWORD PARAMETERS:                       05010057
.*             FOR FURTHER INFORMATION REGARDING THE USE OF THE         05050057
.*             KEYWORDS THAT FOLLOW (EXECEPT OPEN) SEE OS/VS2 SYSTEM    05090057
.*             PROGRAMMING LIBRARY: JOB MANAGEMENT GC28-0627, DYNAMIC   05130057
.*             ALLOCATION.                                              05170057
.*                                                                      05350000
.*             OPEN=(OPEN MACRO LIST POSITIONAL PARAMETER LIST)         05400057
.*                  DEFAULT: OPEN=(,(INPUT,DISP))                       05440057
.*                  SEE OS/VS2 MVS DATA MANAGEMENT MACRO INSTRUCTIONS   05480057
.*                  GC26-3878 FOR INFORMATION ABOUT OPEN SUB-           05520057
.*                  PARAMETERS.                                         05560057
.*                                                                      05600057
.*             DYRB=( VERB |,FLAGS1| |,FLAGS2| )                        05640057
.*                         |,      |                                    05680057
.*                                                                      05720057
.*                  VERB (REQUIRED PARAMETER)                           05760057
.*                   ONLY VALID VALUE: AL                               05800057
.*                                                                      05840057
.*                  FLAGS1 (OPTIONAL PARAMETER)                         05880057
.*                   ONE OR MORE OF THE FOLLOWING VALUES:               05920057
.*                    (ONCVN,NOCVN,NOMNT,JBSYS)                         05960057
.*                                                                      06000057
.*                  FLAGS2 (OPTIONAL PARAMETER)                         06040057
.*                   ONE OR MORE OF THE FOLLOWING VALUES:               06080057
.*                    (WTVOL,WTDSN,NORES,WTUNT,OFFLN,TIONQ,CATLG,       06120057
.*                     MOUNT,UDEVT,PCINT)                               06160057
.*                                                                      06200057
.*                  DEFAULT: DYRB=AL                                    06240057
.*                                                                      06280057
.*             RTDATA=(DATA RETURN VALUES)                              06320057
.*                    ONE OR MORE OF THE FOLLOWING VALUES:              06360057
.*                      (RTDDN,RTDSN,RTVOL,RTORG)                       06400057
.*                    DEFAULT: RTDATA=(RTDDN,RTDSN,RTVOL,RTORG)         06440057
.*                                                                      06480057
.*             DDNAME=FILE NAME                                         06520057
.*                                                                      06560057
.*             DSN='DATA SET NAME'                                      06600057
.*                                                                      06640057
.*             VOL=VOLUME SERIAL                                        06680057
.*                                                                      06720057
.*             UNIT=UNIT NAME                                           06760057
.*                                                                      06800057
.*                     | TRK          |                                 06840057
.*             SPACE=( | CYL          | ,                               06880057
.*                     | BLOCK LENGTH |                                 06920057
.*                                                                      06960057
.*                     (PRIMARY QUANTITY |,SECONDARY QUANTITY|)         07000057
.*                                                                      07040057
.*                     |,RLSE | |,CONTIG | |,ROUND |)                   07080057
.*                     |,     | |,       |                              07120057
.*                                                                      07160057
.*             DISP=(|NEW | |,DELETE | |,DELETE |)                      07200057
.*                   |OLD | |,KEEP   | |,KEEP   |                       07240057
.*                   |SHR | |,CATLG  | |,CATLG  |                       07280057
.*                   |MOD | |,UNCATLG| |,UNCATLG|                       07320057
.*                   |,   | |,       |                                  07360057
.*                                                                      07400057
.*                  DEFAULT: DISP=(SHR,KEEP,KEEP)                       07440057
.*                                                                      07480057
.*             LABEL=( |DATA SET SEQUENCE NUMBER| |,SL |                07520057
.*                                                |,NL |                07560057
.*                                                |,BLP|                07600057
.*                                                |,LTM|                07640057
.*                                                |,   |                07680057
.*                                                                      07720057
.*                     |,PASSWORD| |,RETPD|)                            07760057
.*                     |,NOPWREAD|                                      07800057
.*                                                                      07840057
.*             PASSW=PASSWORD                                           07880057
.*                                                                      07920057
.*             SSREQ= SUB-SYSTEM NAME                                   07960057
.*                                                                      08000057
.*             PERMA=PERMA                                              08040057
.*                                                                      08080057
.*             CNVRT=CNVRT                                              08120057
.*                                                                      08160057
.*             SYSOUT=( |SYSOUT CLASS| |,PROGRAM NAME| )                08200057
.*                                                                      08240057
.*  OUTPUT= SPACE IS ALLOCATED AND INITIALIZED FOR A DATA SET MODEL.    08280057
.*                                                                      08320057
.*  EXIT NORMAL=  N/A                                                   08360057
.*                                                                      08400057
.*  EXIT ERROR= N/A                                                     08440057
.*                                                                      08480057
.*  EXTERNAL REFERENCES= SEE BELOW                                      08520057
.*                                                                      08560057
.*     ROUTINES= NONE                                                   08600057
.*                                                                      08640057
.*     DATA AREAS=  NONE                                                08680057
.*                                                                      08720057
.*     CONTROL BLOCKS=  ACB                                             08760057
.*                      DCB                                             08800057
.*                      RPL                                             08840057
.*                      AMS SYSIN TEXT LIST                             08880057
.*                                                                      08920057
.*  TABLES=  NONE                                                       08960057
.*                                                                      09000057
.*  MACROS=  OPEN  MVS SYSTEM MACRO (LIST FORM)                         09040057
.*           BLSCAMM1  COUNT PARAMETER SUBLIST ENTRIES                  09080057
.*           BLSCAMM2  OBTAIN PARAMETER SUBLIST ENTRY CHARACTER STRING  09120057
.*                                                                      09160057
.*  CHANGE ACTIVITY=                                                    09200057
.*         THIS MODULE IS WRITTEN FOR @G57LPSR                          09240057
.*                                                                      09280057
.*  MESSAGES ISSUED=                                                    10270057
.*     MACRO COMPILE TIME MESSAGES (MNOTE MESSAGES)                     10350057
.*     8,VALUE '&TT' INVALID FOR DATA SET TYPE CODE. MUST BE 'V'        10370057
.*       OR 'Q'. THE ACB/DCB AND RPL ADDRESSES ARE SET TO ZERO.         10406057
.*     8,VALUE '&AMS' INVALID FOR AMS REQUEST PARAMETER. ADDRESS OF     10500057
.*       AMS SYSIN TEXT IS SET TO ZERO.                                 10540057
.*     8,'&VERB' IS AN INVALID DYRB VERB. DYRB VERB CODE IS SET TO      10580057
.*        ZERO.                                                         10620057
.*     8,INVALID FLAGSX LIST. NO FLAGSX BITS ARE SET.                   10660057
.*     8,'VALUE' IS AN INVALID VALUE FOR 'DYRB(Y,Z)'. NO FLAGSX BIT IS  10700057
.*       SET.                                                           10740057
.*     8,'VALUE' IS AN INVALID VALUE FOR 'PARMNAME(FIELD)'. NO TEXT     10780057
.*       UNIT IS BUILT.                                                 10820057
.*     8,'DSN' KEY OPERAND MUST BE ENCLOSED IN QUOTES. NO 'DSN' TEXT    10860057
.*       UNIT IS BUILT.                                                 10900057
.*     8,'KEYNAME1' KEY IS REQUIRED WITH 'KEYNAME2' KEY. NO 'KEYNAME2'  10940057
.*       TEXT UNIT IS BUILT.                                            10980057
.*     8,'PARMNAME' IS A REQUIRED PARAMETER. NO TEXT UNIT IS BUILT.     11020057
.*     8,INVALID PRIMARY SPACE QUANTITY. NO TEXT UNIT IS BUILT.         11060057
.*     8,INVALID SECONDARY SPACE QUANTITY. NO TEXT UNIT IS BUILT.       11100057
.*                                                                      11140057
.*  DATA SETS ACCESSED= NONE                                            11180057
.*                                                                      11220057
.** END OF SPECIFICATIONS ********************************************* 11260057
         GBLA  &BLSCAGA            SUBLIST PARAMETER COUNT OR NUMBER    11300057
         GBLC  &BLSCAGC            SUBLIST CHARACTER STRING             11340057
         LCLA  &CTR                LOOP COUNTER                         11380057
         LCLA  &A                  ARITHMETIC TEMPORARY                 11420057
         LCLC  &C                  CHARACTER TEMPORARY                  11460057
.*   SET UP DEFAULTS FOR DATA SET TYPE                                  11500057
         LCLC  &TT                                                      11540057
&TT      SETC  '&T(1)'             PICK UP DATA SET TYPE CODE           11580057
         AIF   ('&TT' NE '').TSET  TEST FOR NULL                        11620057
&TT      SETC  'V'                 SET DEFAULT TO VSAM                  11660057
.TSET    ANOP                                                           11700057
&C       SETC  '0'                 DEFLT VSAM ESDS PSEUDO REL REC LRECL 11740057
         AIF   (N'&T LT 2 OR '&TT' NE 'V').TSET1   TEST FOR NULL        11780057
&C       SETC  '&T(2)'             SET VSAM ESDS PSEUDO REL REC LRECL   11820057
.TSET1   ANOP                                                           11860057
.* BEGIN MODEL CODE GENERATION                                          11900057
         DS    0D                                                       11940057
&N       DC    A(&NXT)             ADDRESS OF NEXT MODEL                11980057
         DC    A(0)                RESERVED                             12020057
         DC    CL8'&ID'            MODEL NAME                           12060057
         AIF   ('&TT' EQ 'V').ACB     TEST FOR VSAM DATA SET            12100057
         AIF   ('&TT' EQ 'Q').DCB     TEST FOR QSAM (NON-VSAM) DATA SET 12140057
         MNOTE 8,'VALUE ''&TT'' INVALID FOR DATA SET TYPE CODE. MUST BE*12180057
               ''V'' OR ''Q''. THE ACB/DCB AND RPL ADDRESSES ARE SET TO*12220057
                ZERO.'                                                  12260057
         DC    2A(0)               DUMMY ACB/DCB AND RPL ADDRESSES      12300057
         AGO   .JOIN1                                                   12340057
.ACB     ANOP                                                           12380057
         DC    A(ACB&N)            ADDRESS OF ACB CONTROL BLOCK         12420057
         DC    A(RPL&N)            ADDRESS OF RPL CONTROL BLOCK         12460057
         AGO   .JOIN1                                                   12500057
.DCB     ANOP                                                           12540057
         DC    A(DCB&N)            ADDRESS OF DCB CONTROL BLOCK         12580057
         DC    A(0)                UNUSED FOR QSAM                      12620057
.JOIN1   ANOP                                                           12660057
         DC    A(OPCL&N)           ADDRESS OF OPEN/CLOSE LIST           12700057
         DC    A(DYRB&N)           ADDRESS OF DYNALLOC REQUEST BLOCK    12740057
         AIF   ('&AMS' EQ 'AMS').AMS TEST FOR AMS REQUESTED             12780057
         AIF   ('&AMS' EQ '').AMSNUL TEST FOR AMS NOT REQUESTED         12820057
         MNOTE 8,'VALUE ''&AMS'' INVALID FOR AMS REQUEST PARAMETER. ADD*12860057
               RESS OF AMS SYSIN TEXT IS SET TO ZERO.'                  12900057
.AMSNUL  ANOP                                                           12940057
         DC    A(0)                NO AMS SYSIN TEXT SUPPLIED           12980057
         AGO   .JOIN2                                                   13020057
.AMS     DC    A(AMS&N)            ADDRESS OF AMS SYSIN TEXT            13060057
.JOIN2   ANOP                                                           13100057
         DC    F'&C'               VSAM ESDS PSEUDO RELATIVE REC LRECL  13140057
         AIF   ('&TT' EQ 'V').ACB1    TEST FOR VSAM DATA SET            13180057
         AIF   ('&TT' EQ 'Q').DCB1    TEST FOR QSAM DATA SET            13220057
         AGO   .JOIN3                                                   13260057
.ACB1    ANOP                                                           13300057
         DS    0F                                                       13340057
ACB&N    DC    XL76'0'             RESERVE SPACE FOR ACB                13380057
RPL&N    DC    XL76'0'             RESERVE SPACE FOR RPL                13420057
         AGO   .JOIN3                                                   13460057
.DCB1    ANOP                                                           13500057
         DS    0F                                                       13540057
DCB&N    DC    XL96'0'             RESERVE SPACE FOR DCB                13580057
.JOIN3   ANOP                                                           13620057
*   OPEN/CLOSE LIST                                                     13660057
         DS    4A(0)               RESERVE SPACE FOR OPEN/CLOSE LIST    13700057
         ORG   *-16                RESET TO LIST ORIGIN                 13740057
OPCL&N   OPEN  &OPEN,MF=L          OPEN/CLOSE LIST MODEL                13780057
         ORG   ,                   RESTORE LOC COUNTER                  13820057
.*   DYNAMIC ALLOCATION REQUEST BLOCK                                   13860057
.*   BUILD THE DYRB VERB FIELD                                          13900057
         LCLC  &VERB               TEMP FOR VERB CODE                   13940057
.AL      AIF   ('&DYRB(1)' NE 'AL').VBT TEST FOR DSNAME ALLOCATE VERB   13980057
&VERB    SETC  '1'                                                      14020057
         AGO   .VBT                BRANCH AROUND REST OF VERBS          14060057
.* THESE VERBS DISABLED BECAUSE TEXT UNITS FOR THEM NOT BUILT           14100057
.UN      AIF   ('&DYRB(1)' NE 'UN').CC TEST FOR UNALLOCATE VERB         14140057
&VERB    SETC  '2'                                                      14180057
.CC      AIF   ('&DYRB(1)' NE 'CC').DC TEST FOR CONCATENATE VERB        14220057
&VERB    SETC  '3'                                                      14260057
.DC      AIF   ('&DYRB(1)' NE 'DC').RI TEST FOR DECONCATENATE VERB      14300057
&VERB    SETC  '4'                                                      14340057
.RI      AIF   ('&DYRB(1)' NE 'RI').DN TEST FOR REMOVE IN-USE ATTR VERB 14380057
&VERB    SETC  '5'                                                      14420057
.DN      AIF   ('&DYRB(1)' NE 'DN').IN TEST FOR DDANME ALLOCATE VERB    14460057
&VERB    SETC  '6'                                                      14500057
.IN      AIF   ('&DYRB(1)' NE 'IN').VBT TEST FOR RETRIEVE INFORMATION   14540057
&VERB    SETC  '7'                                                      14580057
.VBT     AIF   ('&VERB' NE '').VBOK TEST FOR VALID VERB                 14620057
&VERB    SETC  '0'                 INVALID VERB CODE                    15670057
         MNOTE 8,'''&VERB'' IS AN INVALID DYRB VERB. DYRB VERB CODE IS *15710057
               SET TO ZERO.'                                            15750057
.VBOK    ANOP                                                           15850057
.*   BUILD THE DYRB FLAGS1 FIELD                                        15890057
         LCLB  &F(16)              FLAGS1 BIT MAP                       15930057
         LCLC  &FLAGS1             FLAGS1 TEMP                          15970057
         BLSCAMM1 &DYRB(2)         COUNT FLAGS1 ENTRIES INTO &BLSCAGA   16010057
         AIF   (&BLSCAGA GE 0).FL1A TEST FOR VALID FIELD                16050057
         MNOTE 8,'INVALID FLAGS1 LIST, NO FLAGS1 BITS ARE SET'          16090057
.FL1A    ANOP                                                           16130057
&CTR     SETA  &BLSCAGA            COUNT OF FLAGS TO BE SET             16170057
         AGO   .TEST1                                                   16210057
.* LOOP TO EXAMINE ALL FLAGS1 PARAMETERS SUPPLIED                       16250057
.LOOP1   ANOP                                                           16290057
         BLSCAMM2 &DYRB(2),&CTR   EXTRACT PARM SUBLIST CHAR STRING      16330057
.*                                INTO &BLSCAGA                         16370057
&C       SETC  '&BLSCAGC'         MAKE LOCAL COPY OF SUB-PARAMETER      16410057
         AIF   ('&C' EQ 'ONCVN' OR '&C' EQ 'NOCVN' OR '&C' EQ 'NOMNT'  *16450057
               OR '&C' EQ 'JBSYS').OK1  TEST FOR VALID SUB-FIELD VALUE  16490057
         MNOTE 8,'''&C'' IS AN INVALID VALUE FOR ''DYRB(2,&CTR)''.  NO *16530057
               FLAGS1 BIT IS SET.'                                      16570057
         AGO   .CNT1                                                    16610057
.OK1     ANOP                                                           16650057
         AIF   ('&C' NE 'ONCVN').F1 TEST NOT CONVERIBLE ALLOC           16690057
&F(1)    SETB  1                   EXISTING ALLOC MUST HAVE CONVERTIBLE 16730057
.*                                 ATTRIBUTE TO BE USED FOR THIS REQUST 16770057
.F1     AIF   ('&C' NE 'NOCVN').F2 TEST NOT NO EXISTING ALLOC           16810057
&F(2)    SETB  1                   DON'T USE EXISTING ALLOC FOR REQUEST 17060057
.F2     AIF   ('&C' NE 'NOMNT').F3 TEST NOT NO MOUNT OR OFFLINE DEVS    17100057
&F(3)    SETB  1                   DO NOT MOUNT VOLS OR OFFLINE DEVICES 17140057
.F3     AIF   ('&C' NE 'JBSYS').CNT1 TEST NOT DATA LIKE SYSOUT          17250057
&F(4)    SETB  1                   TREAT THIS DATA SET LIKE SYSOUT      17280057
.CNT1    ANOP                                                           17310057
&CTR     SETA  &CTR-1              DECREMENT SUB-FIELD COUNTER          17340057
.TEST1   AIF   (&CTR GT 0).LOOP1                                        17370057
.* LOOP END, NOW GENERATE FLAGS1 FIELD                                  17470057
&FLAGS1  SETC  '&F(1)&F(2)&F(3)&F(4)&F(5)&F(6)&F(7)&F(8).00000000'      17510057
.*   BUILD THE DYRB FLAGS2 FIELD                                        17550057
         LCLB  &G(32)              FLAGS2 BIT MAP                       17650057
         LCLC  &FLAGS2             FLAGS2 TEMP                          17690057
         BLSCAMM1 &DYRB(3)         COUNT FLAGS2 ENTRIES INTO &BLSCAGA   17730057
         AIF   (&BLSCAGA GE 0).FL2A TEST FOR VALID FIELD                17770057
         MNOTE 8,'INVALID FLAGS2 LIST, NO FLAGS2 BITS ARE SET'          17810057
.FL2A    ANOP                                                           17850057
&CTR     SETA  &BLSCAGA            COUNT OF FLAGS TO BE SET             17890057
         AGO   .TEST2                                                   17930057
.* LOOP TO EXAMINE ALL FLAGS2 PARAMETERS SUPPLIED                       17970057
.LOOP2   ANOP                                                           18010057
         BLSCAMM2 &DYRB(3),&CTR    EXTRACT PARM SUBLIST CHAR STRING     18050057
.*                                 INTO &BLSCAGA                        18090057
&C       SETC  '&BLSCAGC'          MAKE LOCAL COPY OF SUB-PARAMETER     18130057
         AIF   ('&C' EQ 'WTVOL' OR '&C' EQ 'WTDSN' OR '&C' EQ 'NORES'  *18170057
               OR '&C' EQ 'WTUNT' OR '&C' EQ 'OFFLN' OR '&C' EQ        *18210057
               'TIONQ').OK2 TEST FOR VALID SUB-FIELD                    18250057
         AIF   ('&C' EQ 'CATLG' OR '&C' EQ 'MOUNT' OR '&C' EQ 'UDEVT'  *18290057
               OR '&C' EQ 'PCINT').OK2  TEST FOR VALID SUB-FIELD        18330057
         MNOTE 8,'''&C'' IS AN INVALID VALUE FOR ''DYRB(3,&CTR)''.  NO *18370057
               FLAGS2 BIT IS SET.'                                      18410057
         AGO   .CNT2                                                    18450057
.OK2     ANOP                                                           18490057
         AIF   ('&C' NE 'WTVOL').G2 TEST NOT WAIT FOR VOLUMES           18530057
&G(1)    SETB  1                   WAIT FOR VOLUMES                     18570057
.G2      AIF   ('&C' NE 'WTDSN').G3 TEST NOT WAIT FOR DSNAME            18610057
&G(2)    SETB  1                   WAIT FOR DSNAME                      18650057
.G3      AIF   ('&C' NE 'NORES').G4 TEST NOT DON'T RESERVE DATA SETS    18690057
&G(3)    SETB  1                   DO NOT RESERVE DATA SETS             18730057
.G4      AIF   ('&C' NE 'WTUNT').G5 TEST NOT WAIT FOR UNITS             18770057
&G(4)    SETB  1                   WAIT FOR UNITS                       18810057
.G5      AIF   ('&C' NE 'OFFLN').G6 TEST NOT CONSIDER OFFLINE DEVICES   18850057
&G(5)    SETB  1                   CONSIDER OFFLINE DEVICES             18890057
.G6      AIF   ('&C' NE 'TIONQ').G7 TEST NOT TIOT ENQUED                18930057
&G(6)    SETB  1                   TIOT ENQ ALREADY PERFORMED           18970057
.G7      AIF   ('&C' NE 'CATLG').G8 TEST NOT SET CATALOG INDS           19010057
&G(7)    SETB  1                   SET SPECIAL CATALOG DATA SET INDS    19050057
.G8      AIF   ('&C' NE 'MOUNT').G9 TEST NOT VOLUMES MAY BE MOUNTED     19090057
&G(8)    SETB  1                   VOLUMES MAY BE MOUNTED               19130057
.G9      AIF   ('&C' NE 'UDEVT').G10 TEST NOT UNITPARM IS DEVTYPE       19170057
&G(9)    SETB  1                   UNITNAME PARAMETER IS A DEVICE TYPE  19580057
.G10     AIF   ('&C' NE 'PCINT').CNT2 TEST NOT ALLOC PRIVATE CATALOG    19610057
&G(10)   SETB  1                   ALLOCATE A PRIVATE CATALOG FOR INIT  19700057
.CNT2    ANOP                                                           19740057
&CTR     SETA  &CTR-1              DECREMENT SUB-FIELD COUNTER          19780057
.TEST2   AIF   (&CTR GT 0).LOOP2                                        19820057
.* LOOP END, NOW GENERATE FLAGS2 FIELD                                  19860057
&FLAGS2  SETC  '&G(1)&G(2)&G(3)&G(4)&G(5)&G(6)&G(7)&G(8)&G(9)&G(10)&G(1*19900057
               1)&G(12)&G(13)&G(14)&G(15)&G(16).0000000000000000'       19940057
.*   BUILD TEXT UNIT POINTERS                                           19980057
         LCLA  &NTUDEF             NUMBER OF TEXT UNITS DEFINED         20020057
&NTUDEF  SETA  29                  INITIALIZE                           20060057
         LCLB  &P(29)              TEXT UNIT PARAMETER BIT MAP          20100057
         LCLC  &TPA(29)            TEXT UNIT ADDRESS MODELS             20140057
.* INITIALIZE TEXT UNIT POINTER ADDRESS MODELS                          20180057
&TPA(1)  SETC  'RTDDN'                                                  20220057
&TPA(2)  SETC  'RTDSN'                                                  20260057
&TPA(3)  SETC  'RTVOL'                                                  20300057
&TPA(4)  SETC  'RTORG'                                                  20340057
&TPA(5)  SETC  'DDNAM'                                                  20380057
&TPA(6)  SETC  'DSNAM'                                                  20420057
&TPA(7)  SETC  'VLSER'                                                  20460057
&TPA(8)  SETC  'UNIT'                                                   20500057
&TPA(9)  SETC  'SSREQ'                                                  20540057
&TPA(10) SETC  'PASSW'                                                  20580057
&TPA(11) SETC  'PERMA'                                                  20620057
&TPA(12) SETC  'CNVRT'                                                  20660057
&TPA(13) SETC  'STATS'                                                  20700057
&TPA(14) SETC  'NDISP'                                                  20740057
&TPA(15) SETC  'CDISP'                                                  20780057
&TPA(16) SETC  'TRK'                                                    20820057
&TPA(17) SETC  'CYL'                                                    21150057
&TPA(18) SETC  'BLKLN'                                                  21190057
&TPA(19) SETC  'PRIME'                                                  21230057
&TPA(20) SETC  'SECND'                                                  21270057
&TPA(21) SETC  'RLSE'                                                   21310057
&TPA(22) SETC  'SPFRM'                                                  21350057
&TPA(23) SETC  'ROUND'                                                  21390057
&TPA(24) SETC  'DSSEQ'                                                  21430057
&TPA(25) SETC  'LABEL'                                                  21470057
&TPA(26) SETC  'PASPR'                                                  21510057
&TPA(27) SETC  'RETPD'                                                  21550057
&TPA(28) SETC  'SYSOC'                                                  21590057
&TPA(29) SETC  'SYSOP'                                                  21630057
.*   BUILD THE TEXT UNIT PARAMETER BIT MAP FOR THE RTDATA KEYWORD       21670057
&CTR     SETA  N'&RTDATA           COUNT OF SUBFIELDS                   21710057
         AGO   .TEST3                                                   21750057
.* LOOP TO EXAMINE ALL RTDATA PARAMETERS SUPPLIED                       21790057
.LOOP3   ANOP                                                           21830057
&C       SETC  '&RTDATA(&CTR)'     MAKE LOCAL COPY OF SUB-PARAMETER     21870057
         AIF   ('&C' EQ 'RTDDN' OR '&C' EQ 'RTDSN' OR '&C' EQ 'RTVOL'  *21910057
               OR '&C' EQ 'RTORG').OK3  TEST FOR VALID SUB-FIELD VALUE  21950057
         MNOTE 8,'''&C'' IS AN INVALID VALUE FOR ''RTDATA(&CTR)''.  NO *21990057
               TEXT UNIT IS BUILT'                                      22030057
         AGO   .CNT3                                                    22070057
.OK3     ANOP                                                           22350057
         AIF   ('&C' NE 'RTDDN').P2 TEST NOT RETURN DDNAME              22400057
&P(1)    SETB  1                   RETURN ASSOCIATED DDNAME             22450057
.P2      AIF   ('&C' NE 'RTDSN').P3 TEST NOT RETURN DSNAME              22500057
&P(2)    SETB  1                   RETURN ALLOCATED DATA SET NAME       22550057
.P3      AIF   ('&C' NE 'RTVOL').P4 TEST NOT RETURN VOLSER              22590057
&P(3)    SETB  1                   RETURN VOLUME SERIAL                 22630057
.P4      AIF   ('&C' NE 'RTORG').CNT3 TEST NOT RETURN DSORG             22670057
&P(4)    SETB  1                   RETURN THE DATA SET ORGANIZATION     22710057
.CNT3    ANOP                                                           22750057
&CTR     SETA  &CTR-1              DECREMENT SUB-FIELD COUNTER          22790057
.TEST3   AIF   (&CTR GT 0).LOOP3                                        22830057
.*    LOOP END                                                          22870057
.*   DO SET UP FOR THE DDNAME KEYWORD                                   22910057
&P(5)    SETB  ('&DDNAME' NE '')   DDNAME KEYWORD PRESENT               22950057
.*   DO SET UP FOR THE DSN KEYWORD                                      22990057
         AIF   ('&DSN' EQ '').END6 DSN KEY NOT PRESENT                  23030057
&C       SETC  '&DSN'(1,1)         FIRST BYTE OF DS NAME                23070057
         AIF   ('&C' EQ '''').OK6  SHOULD BE SINGLE QUOTE               23110057
         MNOTE 8,'''DSN'' KEY OPERAND MUST BE ENCLOSED IN SINGLE QUOTES*23150057
               . NO ''DSN'' TEXT UNIT IS BUILT'                         23190057
         AGO   .END6                                                    23230057
.OK6     ANOP                                                           23270057
&P(6)    SETB  1                   DSN KEYWORD PRESENT                  23310057
.END6    ANOP                                                           23350057
.*   DO SET UP FOR THE VOL KEYWORD                                      23390057
&P(7)    SETB  ('&VOL' NE '')      VOL KEYWORD PRESENT                  23430057
.*   DO SET UP FOR THE UNIT KEYWORD                                     23470057
&P(8)    SETB  ('&UNIT' NE '')     UNIT KEYWORD PRESENT                 23510057
.*   DO SET UP FOR THE SSREQ KEYWORD                                    23550057
&P(9)    SETB  ('&SSREQ' NE '')    SSREQ KEYWORD PRESENT                23590057
.*   DO SET UP FOR THE PASSWORD KEYWORD                                 23630057
         AIF   ('&PASSW' EQ '').END10 PASSW KEY NOT PRESENT             23670057
         AIF   ('&DSN' NE '').OK10 DSN KEY MUST BE ALSO PRESENT         23710057
         MNOTE 8,'''DSN'' KEY IS REQUIRED WITH ''PASSW'' KEY. NO ''PASS*23750057
               WORD'' TEXT UNIT IS BUILT'                               23790057
         AGO   .END10                                                   23830057
.OK10    ANOP                                                           23870057
&P(10)   SETB  1                   PASSW KEYWORD PRESENT                24250057
.END10   ANOP                                                           24290057
.*   DO SET UP FOR THE PERMA KEYWORD                                    24330057
         AIF   ('&PERMA' EQ '').END11 PERMA KEY NOT PRESENT             24370057
         AIF   ('&CNVRT' EQ '').OK11 CNVRT KEY MUST NOT BE PRESENT      24410057
         MNOTE 8,'''CNVRT'' KEY IS INVALID WITH ''PERMA'' KEY. NO ''PER*24450057
               MA'' TEXT UNIT IS BUILT'                                 24490057
         AGO   .END11                                                   24530057
.OK11    ANOP                                                           24570057
&P(11)   SETB  1                   PERMA KEYWORD PRESENT                24610057
.END11   ANOP                                                           24650057
&P(12)   SETB  ('&CNVRT' NE '')    CNVRT KEYWORD PRESENT                24690057
.*   BUILD THE TEXT UNIT PARAMETER BIT MAP FOR THE DISP KEYWORD         24730057
         LCLA  &STATS,&NDISP,&CDISP                                     24770057
&CTR     SETA  N'&DISP             COUNT OF SUBFIELDS                   24810057
         AIF   (&CTR EQ 0).END15   TEST IF DISP KEYWORD NOT SPECIFIED   24850057
.*   DISP KEY IS MUTUALLY EXCLUSIVE WITH SYSOUT KEY                     24890057
         AIF   ('&SYSOUT' EQ '').P13AA SYSOUT KEY MUST NOT BE PRESENT   24930057
         MNOTE 8,'''SYSOUT'' KEY IS INVALID WITH ''DISP'' KEY. NO ''DIS*24970057
               P'' TEXT UNITS ARE BUILT'                                25010057
         AGO   .END15                                                   25050057
.P13AA   ANOP                                                           25090057
.*    EXAMINE THE STATUS SUB-FIELD                                      25130057
&C       SETC  '&DISP(1)'          MAKE LOCAL COPY OF SUB-FIELD         25170057
         AIF   ('&C' EQ '').END13  TEST STATUS=NULL                     25210057
.P13A    AIF   ('&C' NE 'OLD').P13B TEST NOT STATUS=OLD                 25250057
&STATS   SETA  1                   STATUS=OLD                           25290057
.P13B    AIF   ('&C' NE 'MOD').P13C TEST NOT STATUS=MOD                 25330057
&STATS   SETA  2                   STATUS=MOD                           25370057
.P13C    AIF   ('&C' NE 'NEW').P13D TEST NOT STATUS=NEW                 25410057
&STATS   SETA  4                   STATUS=NEW                           25450057
.P13D    AIF   ('&C' NE 'SHR').P13E TEST NOT STATUS=SHR                 25490057
&STATS   SETA  8                   STATUS=SHR                           25530057
.P13E    AIF   (&STATS NE 0).OK13  TEST FOR VALID SUBFIELD VALUE        25570057
         MNOTE 8,'''&C'' IS AN INVALID VALUE FOR ''DISP(1)''.  NO TEXT *25610057
               UNIT IS BUILT'                                           25650057
         AGO   .END13                                                   25690057
.OK13    ANOP                                                           25730057
&P(13)   SETB  1                   STATUS SUB-FIELD PRESENT             25770057
.END13   ANOP                                                           25810057
.*   EXAMINE THE NORMAL DISPOSITION SUB-FIELD                           25850057
         AIF   (&CTR LT 2).END15   TEST IF NORMAL DISP NOT SPECIFIED    25890057
&C       SETC  '&DISP(2)'          MAKE LOCAL COPY OF SUB-FIELD         25930057
         AIF   ('&C' EQ '').END14  TEST NORMAL DISP=NULL                25970057
.P14A    AIF   ('&C' NE 'UNCATLG').P14B TEST NOT NORMAL DISP=UNCATLG    26010057
&NDISP   SETA  1                   NORMAL DISP=UNCATLG                  26050057
.P14B    AIF   ('&C' NE 'CATLG').P14C TEST NOT NORMAL DISP=CATLG        26090057
&NDISP   SETA  2                   NORMAL DISP=CATLG                    26130057
.P14C    AIF   ('&C' NE 'DELETE').P14D TEST NOT NORMAL DISP=DELETE      26170057
&NDISP   SETA  4                   NORMAL DISP=DELETE                   26210057
.P14D    AIF   ('&C' NE 'KEEP').P14E TEST NOT NORMAL DISP=KEEP          26250057
&NDISP   SETA  8                   NORMAL DISP=KEEP                     26290057
.P14E    AIF   (&NDISP NE 0).OK14  TEST FOR VALID SUBFIELD VALUE        26330057
         MNOTE 8,'''&C'' IS AN INVALID VALUE FOR ''DISP(2)''.  NO TEXT *26370057
               UNIT IS BUILT'                                           26410057
         AGO   .END14                                                   26450057
.OK14    ANOP                                                           26490057
&P(14)   SETB  1                   NORMAL DISP SUB-FIELD PRESENT        26530057
.END14   ANOP                                                           26570057
.*   EXAMINE THE CONDITIONAL DISPOSITION SUB-FIELD                      26610057
         AIF   (&CTR LT 3).END15   TEST IF CONDITION DISP NOT SPECIFIED 26650057
&C       SETC  '&DISP(3)'          MAKE LOCAL COPY OF SUB-FIELD         26690057
         AIF   ('&C' EQ '').END15  TEST CONDITIONAL DISP=NULL           26730057
.P15A    AIF   ('&C' NE 'UNCATLG').P15B TEST NOT CONDITION DISP=UNCATLG 26770057
&CDISP   SETA  1                   CONDITIONAL DISP=UNCATLG             26810057
.P15B    AIF   ('&C' NE 'CATLG').P15C TEST NOT CONDITIONAL DISP=CATLG   26850057
&CDISP   SETA  2                   CONDITIONAL DISP=CATLG               26890057
.P15C    AIF   ('&C' NE 'DELETE').P15D TEST NOT CONDITIONAL DISP=DELETE 26930057
&CDISP   SETA  4                   CONDITIONAL DISP=DELETE              26970057
.P15D    AIF   ('&C' NE 'KEEP').P15E TEST NOT CONDITIONAL DISP=KEEP     27010057
&CDISP   SETA  8                   CONDITIONAL DISP=KEEP                27050057
.P15E    AIF   (&CDISP NE 0).OK15  TEST FOR VALID SUBFIELD VALUE        27090057
         MNOTE 8,'''&C'' IS AN INVALID VALUE FOR ''DISP(3)''.  NO TEXT *27130057
               UNIT IS BUILT'                                           27900057
         AGO   .END15                                                   27920057
.OK15    ANOP                                                           28000057
&P(15)   SETB  1                   CONDITIONAL DISP SUB-FIELD PRESENT   28040057
.END15   ANOP                                                           28080057
.*   BUILD THE TEXT UNIT PARAMETER BIT MAP FOR THE SPACE KEYWORD        28120057
&CTR     SETA  N'&SPACE             COUNT OF SUBFIELDS                  28160057
         AIF   (&CTR EQ 0).END23   TEST IF SPACE KEYWORD NOT SPECIFIED  28200057
.*    EXAMINE THE TYPE SUB-FIELD                                        28240057
&C       SETC  '&SPACE(1)'          MAKE LOCAL COPY OF SUB-FIELD        28280057
         AIF   ('&C' NE '').P16    TEST NOT TYPE=NULL                   28320057
         MNOTE 8,'SPACE(1) IS A REQUIRED PARAMETER. NO TEXT UNIT IS BUI*28360057
               LT'                                                      28500057
         AGO   .END18                                                   28520057
.P16     AIF   ('&C' NE 'TRK').P17 TEST NOT TYPE=TRK                    28600057
&P(16)   SETB  1                   TYPE=TRK                             28640057
         AGO   .END18                                                   28680057
.P17     AIF   ('&C' NE 'CYL').P18 TEST NOT TYPE=CYL                    28720057
&P(17)   SETB  1                   TYPE=CYL                             28760057
         AGO   .END18                                                   28800057
.P18     ANOP                                                           28840057
&P(18)   SETB  1                   TYPE=BLKLEN                          28880057
.END18   ANOP                                                           28920057
.*    EXAMINE THE PRIMARY SPACE QUANTITY SUB-FIELD                      28960057
         BLSCAMM2 &SPACE(2),1      EXTRACT THE PRIMARY SPACE QUANTITY   29000057
.*                                 RETCODE IS IN &BLSCAGA, FIELD IS IN  29040057
.*                                 &BLSCAGC                             29080057
         AIF   (&BLSCAGA GE 0).P19A TEST FOR VALID FIELD EXTRACT        29120057
         MNOTE 8,'INVALID PRIMARY SPACE QUANTITY. NO TEXT UNIT IS BUILT*29160057
               '                                                        29200057
         AGO   .END19                                                   29240057
.P19A    ANOP                                                           29280057
         AIF   ('&BLSCAGC' NE '').P19 PRIMARY SPACE QUANTITY NOT NULL   29320057
         MNOTE 8,'SPACE(2,1) IS A REQUIRED PARAMETER. NO TEXT UNIT IS B*29360057
               UILT'                                                    29400057
         AGO   .END19                                                   29440057
.P19     ANOP                                                           29480057
&P(19)   SETB  1                   PRIMARY SPACE QUANTITY PRESENT       29520057
.END19   ANOP                                                           29560057
.*    EXAMINE THE SECONDARY SPACE QUANTITY SUB-FIELD                    29600057
         BLSCAMM2 &SPACE(2),2      EXTRACT THE SECONDARY SPACE QUANTITY 29640057
.*                                 RETCODE IS IN &BLSCAGA, FIELD IS IN  29680057
.*                                 &BLSCAGC                             29720057
         AIF   (&BLSCAGA GE 0).P20A TEST FOR VALID FIELD EXTRACT        29760057
         MNOTE 8,'INVALID SECONDARY SPACE QUANTITY. NO TEXT UNIT IS BUI*29800057
               LT'                                                      29840057
         AGO   .END20                                                   29880057
.P20A    ANOP                                                           29920057
         AIF   ('&BLSCAGC' EQ '').END20 NULL SECONDARY SPACE QUANTITY   29960057
&P(20)   SETB  1                   SECONDARY SPACE QUANTITY PRESENT     30000057
.END20   ANOP                                                           30040057
.*    EXAMINE THE UNUSED SPACE RELEASE SUB-FIELD                        30080057
&C       SETC  '&SPACE(3)'          MAKE LOCAL COPY OF SUB-FIELD        30120057
         AIF   ('&C' EQ '').END21  TEST FIELD=NULL                      30160057
         AIF   ('&C' EQ 'RLSE').P21 TEST FOR UNUSED SPACE RELEASE       30200057
         MNOTE 8,'''&C'' IS AN INVALID VALUE FOR ''SPACE(3)''. NO TEXT *30240057
               UNIT IS BUILT'                                           30280057
         AGO   .END21                                                   30320057
.P21     ANOP                                                           30360057
&P(21)   SETB  1                   UNUSED SPACE RELEASE FIELD PRESENT   30400057
.END21   ANOP                                                           30440057
.*    EXAMINE THE FORMAT OF ALLOCATED SPACE SUB-FIELD                   30480057
&C       SETC  '&SPACE(4)'          MAKE LOCAL COPY OF SUB-FIELD        30520057
         AIF   ('&C' EQ '').END22  TEST FIELD=NULL                      30560057
         AIF   ('&C' EQ 'CONTIG').P22 TEST FOR FORMAT OF ALLOC SPACE    30600057
         MNOTE 8,'''&C'' IS AN INVALID VALUE FOR ''SPACE(4)''. NO TEXT *30640057
               UNIT IS BUILT'                                           30680057
         AGO   .END22                                                   31250057
.P22     ANOP                                                           31290057
&P(22)   SETB  1                   FORMAT OF ALLOC SPACE FIELD PRESENT  31330057
.END22   ANOP                                                           31370057
.*    EXAMINE THE WHOLE CYLINDER ALLOCATION SUB-FIELD                   31410057
&C       SETC  '&SPACE(5)'          MAKE LOCAL COPY OF SUB-FIELD        31450057
         AIF   ('&C' EQ '').END23  TEST FIELD=NULL                      31490057
         AIF   ('&C' EQ 'ROUND').P23 TEST FOR WHOLE CYLINDER ALLOC      31530057
         MNOTE 8,'''&C'' IS AN INVALID VALUE FOR ''SPACE(5)''. NO TEXT *31570057
               UNIT IS BUILT'                                           31610057
         AGO   .END23                                                   31650057
.P23     ANOP                                                           31690057
&P(23)   SETB  1                   WHOLE CYLINDER ALLOC FIELD PRESENT   31730057
.END23   ANOP                                                           31770057
.*   BUILD THE TEXT UNIT PARAMETER BIT MAP FOR THE LABEL KEYWORD        31810057
         LCLA  &LABELTY,&PASPR                                          31850057
&CTR     SETA  N'&LABEL            COUNT OF SUBFIELDS                   31890057
         AIF   (&CTR EQ 0).END27   TEST IF LABEL KEYWORD NOT SPECIFIED  31930057
.*   LABEL KEY IS MUTUALLY EXCLUSIVE WITH SYSOUT KEY                    31970057
         AIF   ('&SYSOUT' EQ '').P24AA SYSOUT KEY MUST NOT BE PRESENT   32010057
         MNOTE 8,'''SYSOUT'' KEY IS INVALID WITH ''LABEL'' KEY. NO ''LA*32050057
               BEL'' TEXT UNITS ARE BUILT'                              32090057
         AGO   .END27                                                   32130057
.P24AA   ANOP                                                           32170057
.*    EXAMINE THE DATA SET SEQUENCE NUMBER SUB-FIELD                    32210057
         AIF   ('&LABEL(1)' EQ '').END24  NULL DATA SET SEQUENCE NUMBER 32250057
&P(24)   SETB  1                   DATA SET SEQUENCE NUMBER PRESENT     32290057
.END24   ANOP                                                           32330057
.*   EXAMINE THE LABEL TYPE SUB-FIELD                                   32370057
         AIF   (&CTR LT 2).END27   IF NO MORE SUB-FIELDS                32410057
&C       SETC  '&LABEL(2)'         MAKE LOCAL COPY OF SUB-FIELD         32450057
         AIF   ('&C' EQ '').END25  TEST LABEL TYPE=NULL                 32490057
.P25A    AIF   ('&C' NE 'NL').P25B TEST NOT LABEL TYPE=NL               32530057
&LABELTY SETA  1                   LABEL TYPE=NL                        32570057
.P25B    AIF   ('&C' NE 'SL').P25C TEST NOT LABEL TYPE=SL               32610057
&LABELTY SETA  2                   LABEL TYPE=SL                        32970057
.P25C    AIF   ('&C' NE 'BLP').P25D TEST NOT LABEL TYPE=BLP             33050057
&LABELTY SETA  10                  LABEL TYPE=BLP                       33100057
.P25D    AIF   ('&C' NE 'LTM').P25E TEST NOT LABEL TYPE=LTM             33130057
&LABELTY SETA  21                  LABEL TYPE=LTM                       33200057
.P25E    AIF   (&LABELTY NE 0).OK25  TEST FOR VALID SUBFIELD VALUE      33230057
         MNOTE 8,'''&C'' IS AN INVALID VALUE FOR ''LABEL(2)''.  NO TEXT*33260057
                UNIT IS BUILT'                                          33290057
         AGO   .END25                                                   33400057
.OK25    ANOP                                                           33440057
&P(25)   SETB  1                   LABEL TYPE SUB-FIELD PRESENT         33480057
.END25   ANOP                                                           33520057
.*   EXAMINE THE PASSWORD PROTECTION SUB-FIELD                          33560057
         AIF   (&CTR LT 3).END27   IF NO MORE SUB-FIELDS                33600057
&C       SETC  '&LABEL(3)'         MAKE LOCAL COPY OF SUB-FIELD         33640057
         AIF   ('&C' EQ '').END26  TEST PASSWORD PROTECTION=NULL        33680057
         AIF   ('&C' NE 'PASSWORD').P26B  NOT PASSWORD PROT=PASSWORD    33720057
&PASPR   SETA  10                  PASSWORD PROTECTION=PASSWORD         33760057
.P26B    AIF   ('&C' NE 'NOPWREAD').P26C  NOT PASSWORD PROT=NOPWREAD    33800057
&PASPR   SETA  30                  PASSWORD PROTECTION=NOPWREAD         33840057
.P26C    AIF   (&PASPR NE 0).OK26  TEST FOR VALID SUBFIELD VALUE        33880057
         MNOTE 8,'''&C'' IS AN INVALID VALUE FOR ''LABEL(3)''.  NO TEXT*33920057
                UNIT IS BUILT'                                          33960057
         AGO   .END26                                                   34000057
.OK26    ANOP                                                           34040057
&P(26)   SETB  1                   PASSWORD PROTECT SUB-FIELD PRESENT   34080057
.END26   ANOP                                                           34120057
.*   DATA SET RETENTION PERIOD SUB-FIELD                                34160057
&P(27)   SETB  (&CTR EQ 4)         RETENTION PERIOD SUB-FIELD PRESENT   34200057
.END27   ANOP                                                           34240057
.*   HANDLE SYSOUT KEYWORD                                              34280057
&CTR     SETA  N'&SYSOUT           COUNT OF SUBFIELDS                   34320057
         AIF   (&CTR EQ 0).END29   SYSOUT KEYWORD NOT PRESENT           34360057
.*  EXAMINE THE SYSOUT CLASS SUB-FIELD                                  34400057
&A       SETA  K'&SYSOUT(1)        LENGTH OF THE SYSOUT CLASS PARM      34440057
         AIF   (&A EQ 1).OK28      SYSOUT CLASS MUST BE ONE BYTE        34480057
&C       SETC  '&SYSOUT(1)'                                             34520057
         MNOTE 8,'''&C'' IS AN INVALID VALUE FOR ''SYSOUT(1)''. NO TEXT*34560057
                UNIT IS BUILT'                                          34600057
         AGO   .END28                                                   34640057
.OK28    ANOP                                                           34680057
&P(28)   SETB  1                   SYSOUT CLASS PRESENT                 34720057
.END28   ANOP                                                           34760057
.*  EXAMINE THE SYSOUT PROGRAM NAME SUB-FIELD                           34800057
         AIF   (&CTR LT 2).END29   NO PROGRAM NAME SUB-FIELD            34840057
&A       SETA  K'&SYSOUT(2)        LENGTH OF THE SYSOUT PROGRAM NAME    34880057
         AIF   (&A GT 0 AND &A LE 8).OK29  NAME MUST BE 1 TO 8 BYTES    34920057
&C       SETC  '&SYSOUT(2)'                                             34960057
         MNOTE 8,'''&C'' IS AN INVALID VALUE FOR ''SYSOUT(2)''. NO TEXT*35000057
                UNIT IS BUILT'                                          35040057
         AGO   .END29                                                   35080057
.OK29    ANOP                                                           35120057
&P(29)   SETB  1                   SYSOUT PROGRAM NAME PRESENT          35160057
.END29   ANOP                                                           35200057
.* COUNT TEXT UNIT PARAMETERS PRESENT                                   35240057
         LCLA  &TUCT               TEXT UNIT PARAMETERS PRESENT         35280057
&CTR     SETA  0                   INIT LOOP COUNTER                    35320057
         AGO   .CNT4                                                    35360057
.LOOP4   ANOP                                                           35400057
         AIF   (NOT &P(&CTR)).CNT4 TEST FOR TEXT UNIT PRESENT           35440057
&TUCT    SETA  &TUCT+1             TEXT UNIT IS PRESENT                 35480057
.CNT4    ANOP                                                           35520057
&CTR     SETA  &CTR+1              BUMP LOOP COUNTER                    35560057
         AIF   (&CTR LE &NTUDEF).LOOP4  TEST LOOP END                   35600057
*   DYNAMIC ALLOCATION REQUEST BLOCK                                    35640057
         DS    0F                                                       35680057
DYRB&N   DC    HL1'20'             DYRB LENGTH FIELD                    35720057
         DC    HL1'&VERB'          DYRB VERB CODE                       35760057
         DC    BL2'&FLAGS1'        FLAGS1 FIELD                         35800057
         DC    2XL2'0'             ERROR AND INFORMATIONAL REASON CODES 35840057
         AIF   (&TUCT EQ 0).TPP1   TEST FOR TEXT UNITS PRESENT          35880057
         DC    A(DYTP&N)           ADDRESS OF TEXT UNIT POINTERS        35920057
         AGO   .TPP2                                                    35960057
.TPP1    DC    A(0)                NO TEXT UNITS PRESENT                36000057
.TPP2    ANOP                                                           36040057
         DC    A(0)                RESERVED                             36080057
         DC    BL4'&FLAGS2'        FLAGS2 FIELD                         36120057
*   TEXT UNIT POINTERS                                                  36160057
         AIF   (&TUCT EQ 0).DONE   TEST FOR NO TEXT UNITS PRESENT       36200057
DYTP&N   DC    0F'0'               ALIGN LIST TO FULL WORD              36240057
.*   BUILD TEXT UNIT POINTER ENTRIES                                    36280057
         LCLA  &TUCTA              TEXT UNIT COUNTER                    36320057
&CTR     SETA  0                   INIT LOOP COUNTER                    36360057
&TUCTA   SETA  1                   INIT TEXT UNIT COUNTER               36400057
         AGO   .CNT5                                                    36440057
.LOOP5   ANOP                                                           36480057
         AIF   (NOT &P(&CTR)).CNT5 TEST FOR TEXT UNIT PRESENT           36520057
         AIF   (&TUCTA EQ &TUCT).LAST5  TEST FOR LAST TEXT UNIT         36560057
         DC    A(&TPA(&CTR)&N)     TEXT UNIT ADDRESS                    36600057
&TUCTA   SETA  &TUCTA+1            TEXT UNIT COUNTER                    36640057
         AGO   .CNT5                                                    36680057
.LAST5   ANOP                                                           36720057
         DC    X'80',AL3(&TPA(&CTR)&N)  LAST TEXT UNIT ADDRESS          36760057
         AGO   .END5                                                    36800057
.CNT5    ANOP                                                           36840057
&CTR     SETA  &CTR+1              BUMP LOOP COUNTER                    36880057
         AIF   (&CTR LE &NTUDEF).LOOP5  TEST LOOP END                   36920057
.END5    ANOP                                                           36960057
.*   BUILD TEXT UNITS                                                   37000057
*   TEXT UNITS                                                          37040057
.* RETURN DDNAME TEXT UNIT                                              37080057
         AIF   (NOT &P(1)).NOT1    TEST NOT RETURN DDNAME               37120057
         DS    0H                  ALIGN TEXT UNIT                      37160057
&TPA(1)&N DC   XL2'55',H'1',H'8',CL8' ' RETURN DDNAME TEXT UNIT         37200057
.NOT1    ANOP                                                           37240057
.* RETURN DSNAME TEXT UNIT                                              37280057
         AIF   (NOT &P(2)).NOT2    TEST NOT RETURN DSNAME               37320057
         DS    0H                  ALIGN TEXT UNIT                      38350000
&TPA(2)&N DC   XL2'56',H'1',H'44',CL44' ' RETURN DSNAME TEXT UNIT       38400057
.NOT2    ANOP                                                           38440057
.* RETURN VOLUME SERIAL TEXT UNIT                                       38480057
         AIF   (NOT &P(3)).NOT3    TEST NOT RETURN VOLUME SERIAL        38520057
         DS    0H                  ALIGN TEXT UNIT                      38600000
&TPA(3)&N DC   XL2'5D',H'1',H'6',CL6' ' RETURN VOLUME SERIAL TEXT UNIT  38650057
.NOT3    ANOP                                                           38690057
.* RETURN DSORG TEXT UNIT                                               38730057
         AIF   (NOT &P(4)).NOT4    TEST NOT RETURN DSORG                38770057
         DS    0H                  ALIGN TEXT UNIT                      38850000
&TPA(4)&N DC   XL2'57',H'1',H'2',CL2' ' RETURN DSORG TEXT UNIT          38900057
.NOT4    ANOP                                                           38940057
.* DDNAME TEXT UNIT                                                     38980057
         AIF   (NOT &P(5)).NOT5    TEST NOT DDNAME                      39020057
&A       SETA  K'&DDNAME                                                39060057
         DS    0H                  ALIGN TEXT UNIT                      39100057
&TPA(5)&N DC   XL2'01',H'1',H'&A',CL&A'&DDNAME' DDNAME TEXT UNIT        39140057
.NOT5    ANOP                                                           39180057
.* DSNAME TEXT UNIT                                                     39220057
         AIF   (NOT &P(6)).NOT6    TEST NOT DSNAME                      39260057
&A       SETA  K'&DSN-2                                                 39300057
         DS    0H                  ALIGN TEXT UNIT                      39340057
&TPA(6)&N DC   XL2'02',H'1',H'&A',CL&A&DSN DSNAME TEXT UNIT             39380057
.NOT6    ANOP                                                           39420057
.* VOLUME SERIAL TEXT UNIT                                              39460057
         AIF   (NOT &P(7)).NOT7    TEST NOT VOLUME SERIAL               39500057
&A       SETA  K'&VOL                                                   39540057
         DS    0H                  ALIGN TEXT UNIT                      39580057
&TPA(7)&N DC   XL2'10',H'1',H'&A',CL&A'&VOL' VOLUME SERIAL TEXT UNIT    39620057
.NOT7    ANOP                                                           39660057
.* UNIT TEXT UNIT                                                       39700057
         AIF   (NOT &P(8)).NOT8    TEST NOT UNIT                        39740057
&A       SETA  K'&UNIT                                                  39780057
         DS    0H                  ALIGN TEXT UNIT                      39820057
&TPA(8)&N DC   XL2'15',H'1',H'&A',CL&A'&UNIT' UNIT TEXT UNIT            39860057
.NOT8    ANOP                                                           39900057
.* SSREQ TEXT UNIT                                                      39940057
         AIF   (NOT &P(9)).NOT9    TEST NOT SSREQ                       39980057
&A       SETA  K'&SSREQ                                                 40020057
         DS    0H                  ALIGN TEXT UNIT                      40350000
&TPA(9)&N DC   XL2'5C',H'1',H'&A',CL&A'&SSREQ' SUB-SYSTEM REQ TEXT UNIT 40400057
.NOT9    ANOP                                                           40440057
.* PASSWORD TEXT UNIT                                                   40480057
         AIF   (NOT &P(10)).NOT10  TEST NOT PASSWORD                    40520057
&A       SETA  K'&PASSW                                                 40560057
         DS    0H                  ALIGN TEXT UNIT                      40600057
&TPA(10)&N DC  XL2'50',H'1',H'&A',CL&A'&PASSW' PASSWORD TEXT UNIT       40640057
.NOT10   ANOP                                                           40680057
.* PERMANENTLY ALLOCATED ATTRIBUTE TEXT UNIT                            40720057
         AIF   (NOT &P(11)).NOT11  TEST NOT PERMANENTLY ALLOCATED ATTRI 40850057
         DS    0H                  ALIGN TEXT UNIT                      40890057
&TPA(11)&N DC  XL2'52',H'0'        PERM ALLOCATED ATTRIBUTE TEXT UNIT   40930057
.NOT11   ANOP                                                           40970057
.* CONVERTIBLE ATTRIBUTE TEXT UNIT                                      41010057
         AIF   (NOT &P(12)).NOT12  TEST NOT CONVERTIBLE ATTRIBUTE       41050057
         DS    0H                  ALIGN TEXT UNIT                      41090057
&TPA(12)&N DC  XL2'53',H'0'        CONVERTIBLE ATTRIBUTE TEXT UNIT      41130057
.NOT12   ANOP                                                           41170057
.* DATA SET STATUS TEXT UNIT                                            41300057
         AIF   (NOT &P(13)).NOT13  TEST NOT DATA SET STATUS             41340057
         DS    0H                  ALIGN TEXT UNIT                      41380057
&TPA(13)&N DC  XL2'04',H'1',H'1',XL1'&STATS' DATA SET STATUS TEXT UNIT  41420057
.NOT13   ANOP                                                           41460057
.* DATA SET NORMAL DISP TEXT UNIT                                       41500057
         AIF   (NOT &P(14)).NOT14  TEST NOT DATA SET NORMAL DISP        41540057
         DS    0H                  ALIGN TEXT UNIT                      41580057
&TPA(14)&N DC  XL2'05',H'1',H'1',XL1'&NDISP' DSET NORM DISP TEXT UNIT   41620057
.NOT14   ANOP                                                           41660057
.* DATA SET CONDITIONAL DISP TEXT UNIT                                  41700057
         AIF   (NOT &P(15)).NOT15  TEST NOT DATA SET CONDITIONAL DISP   41740057
         DS    0H                  ALIGN TEXT UNIT                      41780057
&TPA(15)&N DC  XL2'06',H'1',H'1',XL1'&CDISP' DSET COND DISP TEXT UNIT   41820057
.NOT15   ANOP                                                           41860057
.* SPACE ALLOCATED BY TRACKS ATTRIBUTE TEXT UNIT                        41900057
         AIF   (NOT &P(16)).NOT16  TEST NOT SPACE ALLOCATED BY TRACKS   41940057
         DS    0H                  ALIGN TEXT UNIT                      41980057
&TPA(16)&N DC  XL2'07',H'0'        SPACE ALLOCATED BY TRACKS TEXT UNIT  42020057
.NOT16   ANOP                                                           42060057
.* SPACE ALLOC BY CYLS TEXT UNIT                                        42100057
         AIF   (NOT &P(17)).NOT17  TEST NOT SPACE ALLOC BY CYLS         42140057
         DS    0H                  ALIGN TEXT UNIT                      42180057
&TPA(17)&N DC  XL2'08',H'0'        SPACE ALLOC BY CYLS TEXT UNIT        42220057
.NOT17   ANOP                                                           42260057
.* BLOCK SPACE TEXT UNIT                                                42300057
         AIF   (NOT &P(18)).NOT18  TEST NOT BLOCK SPACE                 42340057
         DS    0H                  ALIGN TEXT UNIT                      42380057
&TPA(18)&N DC  XL2'09',H'1',H'3',FL3'&SPACE(1)' BLOCK SPACE TEXT UNIT   42420057
.NOT18   ANOP                                                           42460057
.* PRIME SPACE TEXT UNIT                                                42500057
         AIF   (NOT &P(19)).NOT19  TEST NOT PRIME SPACE                 42540057
         DS    0H                  ALIGN TEXT UNIT                      42580057
         BLSCAMM2 &SPACE(2),1      EXTRACT PRIMARY SPACE QUANTITY       42620057
&TPA(19)&N DC  XL2'0A',H'1',H'3',FL3'&BLSCAGC' PRIME SPACE TEXT UNIT    42660057
.NOT19   ANOP                                                           42700057
.* SECONDARY SPACE TEXT UNIT                                            42740057
         AIF   (NOT &P(20)).NOT20  TEST NOT SECONDARY SPACE             42780057
         DS    0H                  ALIGN TEXT UNIT                      42820057
         BLSCAMM2 &SPACE(2),2      EXTRACT SECONDARY SPACE QUANTITY     43250057
&TPA(20)&N DC  XL2'0B',H'1',H'3',FL3'&BLSCAGC' SECDY SPACE TEXT UNIT    43270057
.NOT20   ANOP                                                           43290057
.* SPACE RELEASE TEXT UNIT                                              43400057
         AIF   (NOT &P(21)).NOT21  TEST NOT SPACE RELEASE               43450057
         DS    0H                  ALIGN TEXT UNIT                      43500057
&TPA(21)&N DC  XL2'0D',H'0'        SPACE RELEASE TEXT UNIT              43550057
.NOT21   ANOP                                                           43600057
.* ALLOC CONTIG SPACE TEXT UNIT                                         43650057
         AIF   (NOT &P(22)).NOT22  TEST NOT ALLOC CONTIG SPACE          43700057
         DS    0H                  ALIGN TEXT UNIT                      43750057
&TPA(22)&N DC  XL2'0E',H'1',H'1',XL1'08' ALLOC CONTIG SPACE TEXT UNIT   43800057
.NOT22   ANOP                                                           43850057
.* SPACE ROUND TO CYLS TEXT UNIT                                        43900057
         AIF   (NOT &P(23)).NOT23  TEST NOT SPACE ROUND TO CYLS         43950057
         DS    0H                  ALIGN TEXT UNIT                      44000057
&TPA(23)&N DC  XL2'0F',H'0'        SPACE ROUND TO CYLS TEXT UNIT        44050057
.NOT23   ANOP                                                           44100057
.* DATA SET SEQNO TEXT UNIT                                             44150057
         AIF   (NOT &P(24)).NOT24  TEST NOT DATA SET SEQNO              44200057
         DS    0H                  ALIGN TEXT UNIT                      44250057
&TPA(24)&N DC  XL2'1F',H'1',H'2',H'&LABEL(1)' DATA SET SEQNO TEXT UNIT  44300057
.NOT24   ANOP                                                           44350057
.* LABEL TYPE TEXT UNIT                                                 44400057
         AIF   (NOT &P(25)).NOT25  TEST NOT LABEL TYPE                  44450057
         DS    0H                  ALIGN TEXT UNIT                      44500057
&TPA(25)&N DC  XL2'1E',H'1',H'1',XL1'&LABELTY' LABEL TYPE TEXT UNIT     44550057
.NOT25   ANOP                                                           44600057
.* PASSWORD PROTECT TEXT UNIT                                           44650057
         AIF   (NOT &P(26)).NOT26  TEST NOT PASSWORD PROTECT            44700057
         DS    0H                  ALIGN TEXT UNIT                      44750057
&TPA(26)&N DC  XL2'20',H'1',H'1',XL1'&PASPR' PASSWORD PROT TEXT UNIT    44800057
.NOT26   ANOP                                                           44850057
.* DATA SET RETENTION PERIOD TEXT UNIT                                  44900057
         AIF   (NOT &P(27)).NOT27  TEST NOT DATA SET RETENTION PERIOD   44950057
         DS    0H                  ALIGN TEXT UNIT                      45000057
&TPA(27)&N DC  XL2'23',H'1',H'2',H'&LABEL(4)' DATA SET RETPD TEXT UNIT  45050057
.NOT27   ANOP                                                           45100057
.* SYSOUT CLASS TEXT UNIT                                               45150057
         AIF   (NOT &P(28)).NOT28  TEST NOT SYSOUT CLASS                45200057
&C       SETC  '&SYSOUT(1)'                                             45250057
         DS    0H                  ALIGN TEXT UNIT                      45300057
&TPA(28)&N DC  XL2'18',H'1',H'1',CL1'&C' SYSOUT CLASS TEXT UNIT         45350057
.NOT28   ANOP                                                           45400057
.* SYSOUT PROGRAM NAME TEXT UNIT                                        45450057
         AIF   (NOT &P(29)).NOT29  TEST NOT SYSOUT PROGRAM NAME         45500057
&A       SETA  K'&SYSOUT(2)                                             45550057
&C       SETC  '&SYSOUT(2)'                                             45600057
         DS    0H                  ALIGN TEXT UNIT                      45650057
&TPA(29)&N DC  XL2'19',H'1',H'&A',CL&A'&C'  PROGRAM NAME TEXT UNIT      45700057
.NOT29   ANOP                                                           45750057
.DONE    ANOP                                                           45800057
         MEND                                                           45850057
