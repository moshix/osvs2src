         TITLE 'EP=BLSCANAL -- IPCS DAS DYNALLOC ERROR ANALYZER INTERFA*00001000
               ACE      '                                               00002000
BLSCANAL CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'BLSCANAL  78.062'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@12                                         0001 00013000
         L     @00,@SIZDATD                                        0001 00014000
         BLSCGETS R,LV=(0)                                              00015000
         LR    @11,@01                                             0001 00016000
         USING @DATD,@11                                           0001 00017000
         ST    @13,@SA00001+4                                      0001 00018000
         LM    @00,@01,20(@13)                                     0001 00019000
         ST    @11,8(,@13)                                         0001 00020000
         LR    @13,@11                                             0001 00021000
*   DMCBPTR=GPR01P;                 /* BASE THE DMCB                 */ 00022000
         LR    DMCBPTR,GPR01P                                      0028 00023000
*   RFY                                                            0029 00024000
*     GPR01P UNRSTD;                                               0029 00025000
*   MODNAME=LMODNMC;                /* INIT THE MODULE NAME          */ 00026000
         MVC   MODNAME(8),@CC00344                                 0030 00027000
*   RETCODE=F0C;                    /* INIT THE MODULE RETURN CODE   */ 00028000
         SLR   @10,@10                                             0031 00029000
         ST    @10,RETCODE                                         0031 00030000
*   SUBCODE=F0C;                    /* INIT THE SUBROUTINE RETURN  0032 00031000
*                                      CODE                          */ 00032000
*                                                                  0032 00033000
         ST    @10,SUBCODE                                         0032 00034000
*   /*****************************************************************/ 00035000
*   /*                                                               */ 00036000
*   /* ISSUE THE IPCS BASIC DYNALLOC ERROR MESSAGE                   */ 00037000
*   /*                                                               */ 00038000
*   /*****************************************************************/ 00039000
*                                                                  0033 00040000
*   CALL BASEMSG;                   /* ISSUE THE IPCS BASIC DYNALLOC    00041000
*                                      ERROR MESSAGE                 */ 00042000
*                                                                  0033 00043000
         BAL   @14,BASEMSG                                         0033 00044000
*   /*****************************************************************/ 00045000
*   /*                                                               */ 00046000
*   /* INITIALIZE THE DAIRFAIL PARAMETER LIST                        */ 00047000
*   /*                                                               */ 00048000
*   /*****************************************************************/ 00049000
*                                                                  0034 00050000
*   DFS99RBP=DMCBDRBP;              /* ADDRESS OF DYNALLOC REQUEST 0034 00051000
*                                      BLCOK                         */ 00052000
         L     @10,DMCBDRBP(,DMCBPTR)                              0034 00053000
         ST    @10,DFS99RBP                                        0034 00054000
*   DFRCP=ADDR(DMCBSUBC);           /* ADDRESS OF DYNALLOC RETURN  0035 00055000
*                                      CODE                          */ 00056000
         LA    @10,DMCBSUBC(,DMCBPTR)                              0035 00057000
         ST    @10,DFRCP                                           0035 00058000
*   DFJEFF02=ADDR(LDFMSGWT);        /* TSO MESSAGE WRITER ENTRY POINT*/ 00059000
         LA    @10,LDFMSGWT                                        0036 00060000
         ST    @10,DFJEFF02                                        0036 00061000
*   DFIDP=ADDR(LDFID);              /* ADDRESS OF CALLER           0037 00062000
*                                      IDENTIFICATION FIELD          */ 00063000
         LA    @05,LDFID                                           0037 00064000
         ST    @05,DFIDP                                           0037 00065000
*   DFCPPLP=F0C;                    /* CPPL PARAMETER LIST NOT     0038 00066000
*                                      SUPPLIED                      */ 00067000
         SLR   @15,@15                                             0038 00068000
         ST    @15,DFCPPLP                                         0038 00069000
*   DFBUFP=ADDR(DFBUFS);            /* ADDRESS OF MESSAGE BUFFERS    */ 00070000
*                                                                  0039 00071000
         LA    @14,DFBUFS                                          0039 00072000
         ST    @14,DFBUFP                                          0039 00073000
*   /*****************************************************************/ 00074000
*   /*                                                               */ 00075000
*   /* INITIALIZE DAIRFAIL PARAMETERS                                */ 00076000
*   /*                                                               */ 00077000
*   /*****************************************************************/ 00078000
*                                                                  0040 00079000
*   DFMSGWTP=F0C;                   /* FORCE DAIRFAIL TO LINK TO TSO    00080000
*                                      MESSAGE WRITER                */ 00081000
         ST    @15,DFMSGWTP(,@10)                                  0040 00082000
*   DFID=F0C;                       /* CLEAR THE FIELD               */ 00083000
         STH   @15,DFID(,@05)                                      0041 00084000
*   DFIDNUM=DFSVC99;                /* SUPPLY THE CALLER IDENTIFIER  */ 00085000
         MVI   DFIDNUM(@05),X'32'                                  0042 00086000
*   DFWTP=ON;                       /* ISSUE WTP INSTEAD OF PUTLINE  */ 00087000
*   DFBUFSW=ON;                     /* SET TO BUILD DAIRFAIL MESSAGE    00088000
*                                      BUFFERS                       */ 00089000
*   DFBUFS2=OFF;                    /* SET TO NOT OUTPUT DAIRFAIL  0045 00090000
*                                      MESSAGES TO TERMINAL          */ 00091000
*                                                                  0045 00092000
         OI    DFWTP(@05),B'11000000'                              0045 00093000
         NI    DFBUFS2(@05),B'11011111'                            0045 00094000
*   /*****************************************************************/ 00095000
*   /*                                                               */ 00096000
*   /* INITIALIZE THE MESSAGE RETURN BUFFERS                         */ 00097000
*   /*                                                               */ 00098000
*   /*****************************************************************/ 00099000
*                                                                  0046 00100000
*   DFBUF1=DFBUF1&&DFBUF1;          /* CLEAR THE BUFFER              */ 00101000
         XC    DFBUF1(255),DFBUF1                                  0046 00102000
*   DFBUF2=DFBUF2&&DFBUF2;          /* CLEAR THE BUFFER              */ 00103000
         XC    DFBUF2(255),DFBUF2                                  0047 00104000
*   DFBUFL1=LENGTH(DFBUFT1)+F4C;    /* INIT THE BUFFER LENGTH        */ 00105000
         LA    @10,255                                             0048 00106000
         STH   @10,DFBUFL1                                         0048 00107000
*   DFBUFL2=LENGTH(DFBUFT2)+F4C;    /* INIT THE BUFFER LENGTH        */ 00108000
*                                                                  0049 00109000
         STH   @10,DFBUFL2                                         0049 00110000
*   /*****************************************************************/ 00111000
*   /*                                                               */ 00112000
*   /* DO DYNALLOC ERROR ANALYSIS USING THE DAIRFAIL MODULE          */ 00113000
*   /*                                                               */ 00114000
*   /*****************************************************************/ 00115000
*                                                                  0050 00116000
*   CALL INVDAIRF;                  /* INVOKE IKJEFF18 TO DO DYNALLOC   00117000
*                                      ERROR ANALYSIS                */ 00118000
         BAL   @14,INVDAIRF                                        0050 00119000
*   IF RETCODE=F0C THEN             /* IF IKJEFF18 OK                */ 00120000
         L     @10,RETCODE                                         0051 00121000
         LTR   @10,@10                                             0051 00122000
         BNZ   @RF00051                                            0051 00123000
*     DO;                           /* REFORMAT IKJEFF18 MESSAGES  0052 00124000
*                                      INTO IPCS MESSAGE FORMAT      */ 00125000
*                                                                  0052 00126000
*       /*************************************************************/ 00127000
*       /*                                                           */ 00128000
*       /* REFORMAT IKJEFF18 MESSAGES INTO IPCS MESSAGE FORMAT       */ 00129000
*       /*                                                           */ 00130000
*       /*************************************************************/ 00131000
*                                                                  0053 00132000
*       CALL BLSCRFM(DMCB,DMCBMSG,ADDR(DFBUF1));/* REFORMAT FIRST  0053 00133000
*                                      LEVEL MESSAGE                 */ 00134000
         ST    DMCBPTR,@AL00001                                    0053 00135000
         LA    @10,DMCBMSG(,DMCBPTR)                               0053 00136000
         ST    @10,@AL00001+4                                      0053 00137000
         LA    @10,DFBUF1                                          0053 00138000
         ST    @10,@TF00001                                        0053 00139000
         LA    @10,@TF00001                                        0053 00140000
         ST    @10,@AL00001+8                                      0053 00141000
         L     @15,@CV00290                                        0053 00142000
         LA    @01,@AL00001                                        0053 00143000
         BALR  @14,@15                                             0053 00144000
*       RFY                                                        0054 00145000
*         GPR15F RSTD;                                             0054 00146000
*       SUBCODE=GPR15F;             /* OBTAIN THE SUBROUTINE RETURN     00147000
*                                      CODE                          */ 00148000
         ST    GPR15F,SUBCODE                                      0055 00149000
*       RFY                                                        0056 00150000
*         GPR15F UNRSTD;                                           0056 00151000
*       RETCODE=MAX(SUBCODE,RETCODE);/* PASS MAX ERROR TO CALLER     */ 00152000
         L     @10,SUBCODE                                         0057 00153000
         L     @05,RETCODE                                         0057 00154000
         CR    @05,@10                                             0057 00155000
         BNL   *+6                                                      00156000
         LR    @05,@10                                             0057 00157000
         ST    @05,RETCODE                                         0057 00158000
*       IF SUBCODE=F0C THEN         /* TEST FOR NO ERROR             */ 00159000
         LTR   @10,@10                                             0058 00160000
         BNZ   @RF00058                                            0058 00161000
*         DO;                       /* REFORMAT SECOND MESSAGE       */ 00162000
*           CALL BLSCRFM(DMCB,DMCBMSG,ADDR(DFBUF2));/* REFORMAT    0060 00163000
*                                      SECOND LEVEL MESSAGE          */ 00164000
         ST    DMCBPTR,@AL00001                                    0060 00165000
         LA    @10,DMCBMSG(,DMCBPTR)                               0060 00166000
         ST    @10,@AL00001+4                                      0060 00167000
         LA    @10,DFBUF2                                          0060 00168000
         ST    @10,@TF00001                                        0060 00169000
         LA    @10,@TF00001                                        0060 00170000
         ST    @10,@AL00001+8                                      0060 00171000
         L     @15,@CV00290                                        0060 00172000
         LA    @01,@AL00001                                        0060 00173000
         BALR  @14,@15                                             0060 00174000
*           RFY                                                    0061 00175000
*             GPR15F RSTD;                                         0061 00176000
*           SUBCODE=GPR15F;         /* OBTAIN THE SUBROUTINE RETURN     00177000
*                                      CODE                          */ 00178000
         ST    GPR15F,SUBCODE                                      0062 00179000
*           RFY                                                    0063 00180000
*             GPR15F UNRSTD;                                       0063 00181000
*           RETCODE=MAX(SUBCODE,RETCODE);/* PASS MAX ERROR TO CALLER */ 00182000
         L     @10,SUBCODE                                         0064 00183000
         L     @15,RETCODE                                         0064 00184000
         CR    @10,@15                                             0064 00185000
         BNL   *+6                                                      00186000
         LR    @10,@15                                             0064 00187000
         ST    @10,RETCODE                                         0064 00188000
*         END;                      /* REFORMAT SECOND MESSAGE       */ 00189000
*     END;                          /* REFORMAT IKJEFF18 MESSAGES  0066 00190000
*                                      INTO IPCS MESSAGE FORMAT      */ 00191000
*                                                                  0066 00192000
@RF00058 DS    0H                                                  0067 00193000
*   /*****************************************************************/ 00194000
*   /*                                                               */ 00195000
*   /* ANALYSIS COMPLETE, RETURN TO CALLER                           */ 00196000
*   /*                                                               */ 00197000
*   /*****************************************************************/ 00198000
*                                                                  0067 00199000
*   RETURN CODE(RETCODE);                                          0067 00200000
@RF00051 L     @10,RETCODE                                         0067 00201000
         L     @13,4(,@13)                                         0067 00202000
         L     @00,@SIZDATD                                        0067 00203000
         LR    @01,@11                                             0067 00204000
         BLSCFRES R,LV=(0),A=(1)                                        00205000
         LR    @15,@10                                             0067 00206000
         L     @14,12(,@13)                                        0067 00207000
         LM    @00,@12,20(@13)                                     0067 00208000
         BR    @14                                                 0067 00209000
         EJECT                                                          00210000
*                                                                  0068 00211000
*   /*****************************************************************/ 00212000
*   /*                                                               */ 00213000
*   /* PROCEDURE TO ISSUE THE IPCS BASIC DYNALLOC ERROR MESSAGE      */ 00214000
*   /*                                                               */ 00215000
*   /*****************************************************************/ 00216000
*                                                                  0068 00217000
*BASEMSG:                                                          0068 00218000
*   PROCEDURE;                      /* ISSUE THE IPCS BASIC DYNALLOC    00219000
*                                      ERROR MESSAGE                 */ 00220000
BASEMSG  STM   @14,@12,@SA00002                                    0068 00221000
*   CHSTR87=S99VERB;                /* GET DYNALLOC SVC VERB FIELD   */ 00222000
         L     @10,DMCBDRBP(,DMCBPTR)                              0069 00223000
         MVC   CHSTR87(1),S99VERB(@10)                             0069 00224000
*   CHSTR88=LHEX0FC;                /* TRANSLATE IT TO PRINTABLE HEX */ 00225000
         MVI   CHSTR88,X'0F'                                       0070 00226000
*   UNPK(CTEMP,CHSTR8);                                            0071 00227000
         UNPK  CTEMP(9),CHSTR8(8)                                  0071 00228000
*   TR(CTEMP,HEXTBL);                                              0072 00229000
         TR    CTEMP(9),HEXTBL                                     0072 00230000
*   OPCODE=CTEMP78;                 /* STORE THE VERB                */ 00231000
         MVC   OPCODE(2),CTEMP78                                   0073 00232000
*   CHSTR847=DMCBSUBC;              /* DYNALLOC SVC RETURN CODE      */ 00233000
         L     @05,DMCBSUBC(,DMCBPTR)                              0074 00234000
         STCM  @05,15,CHSTR847                                     0074 00235000
*   CHSTR88=LHEX0FC;                /* TRANSLATE IT TO PRINTABLE HEX */ 00236000
         MVI   CHSTR88,X'0F'                                       0075 00237000
*   UNPK(CTEMP,CHSTR8);                                            0076 00238000
         UNPK  CTEMP(9),CHSTR8(8)                                  0076 00239000
*   TR(CTEMP,HEXTBL);                                              0077 00240000
         TR    CTEMP(9),HEXTBL                                     0077 00241000
*   RCODE=CTEMP78;                  /* SAVE THE RETURN CODE          */ 00242000
         MVC   RCODE(2),CTEMP78                                    0078 00243000
*   CHSTR847=S99RSC;                /* DYNALLOC ERROR CODE AND REASON   00244000
*                                      CODE                          */ 00245000
         MVC   CHSTR847(4),S99RSC(@10)                             0079 00246000
*   CHSTR88=LHEX0FC;                /* TRANSLATE THEM TO PRINTABLE 0080 00247000
*                                      HEX                           */ 00248000
         MVI   CHSTR88,X'0F'                                       0080 00249000
*   UNPK(CTEMP,CHSTR8);                                            0081 00250000
         UNPK  CTEMP(9),CHSTR8(8)                                  0081 00251000
*   TR(CTEMP,HEXTBL);                                              0082 00252000
         TR    CTEMP(9),HEXTBL                                     0082 00253000
*   IF DMCBSUBC=0 THEN              /* TEST FOR RETURN CODE = 0      */ 00254000
         LTR   @05,@05                                             0083 00255000
         BNZ   @RF00083                                            0083 00256000
*     CTEMP14=CTEMP58;              /* MOVE INFO CODE INTO         0084 00257000
*                                      INFO/REASON CODE FIELD        */ 00258000
         MVC   CTEMP14(4),CTEMP58                                  0084 00259000
*   DO;                             /* BLSDMSG                     0085 00260000
*                                      (ZZ2,F3112C,DMCBMSG,BLSDMSGS)    00261000
*                                      INSERT(DMCBMODL,OPCODE,RCODE,C   00262000
*                                      TEMP14,DMCBDSN)               */ 00263000
@RF00083 DS    0H                                                  0086 00264000
*     IOPTLIST(1)=ADDR(IOPTLIST(4));/* CHAIN TO NEXT INSERT          */ 00265000
         LA    @10,IOPTLIST+12                                     0086 00266000
         ST    @10,IOPTLIST                                        0086 00267000
*     IOPTLIST(2)=ADDR(DMCBMODL);   /* INSERT NAME POINTER           */ 00268000
         LA    @10,DMCBMODL(,DMCBPTR)                              0087 00269000
         ST    @10,IOPTLIST+4                                      0087 00270000
*     IOPTLIST(3)=0;                /* ZERO RESERVED FIELD           */ 00271000
         SLR   @10,@10                                             0088 00272000
         ST    @10,IOPTLIST+8                                      0088 00273000
*     RFY                                                          0089 00274000
*       I015F BASED(ADDR(IOPTLIST(3)));/* ACCESS BYTES 1-2           */ 00275000
*     I015F=LENGTH(DMCBMODL);       /* INSERT LENGTH                 */ 00276000
         LA    @05,IOPTLIST+8                                      0090 00277000
         MVC   I015F(2,@05),@CH00044                               0090 00278000
*     IOPTLIST(4)=ADDR(IOPTLIST(7));/* CHAIN TO NEXT INSERT          */ 00279000
         LA    @05,IOPTLIST+24                                     0091 00280000
         ST    @05,IOPTLIST+12                                     0091 00281000
*     IOPTLIST(5)=ADDR(OPCODE);     /* INSERT NAME POINTER           */ 00282000
         LA    @05,OPCODE                                          0092 00283000
         ST    @05,IOPTLIST+16                                     0092 00284000
*     IOPTLIST(6)=0;                /* ZERO RESERVED FIELD           */ 00285000
         ST    @10,IOPTLIST+20                                     0093 00286000
*     RFY                                                          0094 00287000
*       I015F BASED(ADDR(IOPTLIST(6)));/* ACCESS BYTES 1-2           */ 00288000
*     I015F=LENGTH(OPCODE);         /* INSERT LENGTH                 */ 00289000
         LA    @05,2                                               0095 00290000
         LA    @15,IOPTLIST+20                                     0095 00291000
         STH   @05,I015F(,@15)                                     0095 00292000
*     IOPTLIST(7)=ADDR(IOPTLIST(10));/* CHAIN TO NEXT INSERT         */ 00293000
         LA    @15,IOPTLIST+36                                     0096 00294000
         ST    @15,IOPTLIST+24                                     0096 00295000
*     IOPTLIST(8)=ADDR(RCODE);      /* INSERT NAME POINTER           */ 00296000
         LA    @15,RCODE                                           0097 00297000
         ST    @15,IOPTLIST+28                                     0097 00298000
*     IOPTLIST(9)=0;                /* ZERO RESERVED FIELD           */ 00299000
         ST    @10,IOPTLIST+32                                     0098 00300000
*     RFY                                                          0099 00301000
*       I015F BASED(ADDR(IOPTLIST(9)));/* ACCESS BYTES 1-2           */ 00302000
*     I015F=LENGTH(RCODE);          /* INSERT LENGTH                 */ 00303000
         LA    @15,IOPTLIST+32                                     0100 00304000
         STH   @05,I015F(,@15)                                     0100 00305000
*     IOPTLIST(10)=ADDR(IOPTLIST(13));/* CHAIN TO NEXT INSERT        */ 00306000
         LA    @05,IOPTLIST+48                                     0101 00307000
         ST    @05,IOPTLIST+36                                     0101 00308000
*     IOPTLIST(11)=ADDR(CTEMP14);   /* INSERT NAME POINTER           */ 00309000
         LA    @05,CTEMP14                                         0102 00310000
         ST    @05,IOPTLIST+40                                     0102 00311000
*     IOPTLIST(12)=0;               /* ZERO RESERVED FIELD           */ 00312000
         ST    @10,IOPTLIST+44                                     0103 00313000
*     RFY                                                          0104 00314000
*       I015F BASED(ADDR(IOPTLIST(12)));/* ACCESS BYTES 1-2          */ 00315000
*     I015F=LENGTH(CTEMP14);        /* INSERT LENGTH                 */ 00316000
         LA    @05,IOPTLIST+44                                     0105 00317000
         MVC   I015F(2,@05),@CH00037                               0105 00318000
*     IOPTLIST(13)=0;               /* LAST INSERT                   */ 00319000
         ST    @10,IOPTLIST+48                                     0106 00320000
*     IOPTLIST(14)=ADDR(DMCBDSN);   /* INSERT NAME POINTER           */ 00321000
         LA    @05,DMCBDSN(,DMCBPTR)                               0107 00322000
         ST    @05,IOPTLIST+52                                     0107 00323000
*     IOPTLIST(15)=0;               /* ZERO RESERVED FIELD           */ 00324000
         ST    @10,IOPTLIST+56                                     0108 00325000
*     RFY                                                          0109 00326000
*       I015F BASED(ADDR(IOPTLIST(15)));/* ACCESS BYTES 1-2          */ 00327000
*     I015F=LENGTH(DMCBDSN);        /* INSERT LENGTH                 */ 00328000
         LA    @10,IOPTLIST+56                                     0110 00329000
         MVC   I015F(2,@10),@CH00119                               0110 00330000
*     CALL BLSDMSG0(ZZ2,F3112C,DMCBMSG,BLSDMSGS,'00000000'B,ADDR(  0111 00331000
*         IOPTLIST));               /* BUILD MESSAGE                 */ 00332000
         L     @10,DMCBTVP(,DMCBPTR)                               0111 00333000
         ST    @10,@AL00001                                        0111 00334000
         LA    @10,@CF00332                                        0111 00335000
         ST    @10,@AL00001+4                                      0111 00336000
         LA    @10,DMCBMSG(,DMCBPTR)                               0111 00337000
         ST    @10,@AL00001+8                                      0111 00338000
         L     @10,DMCBMSGS(,DMCBPTR)                              0111 00339000
         ST    @10,@AL00001+12                                     0111 00340000
         LA    @10,@CB00375                                        0111 00341000
         ST    @10,@AL00001+16                                     0111 00342000
         LA    @10,IOPTLIST                                        0111 00343000
         ST    @10,@AFTEMPS                                        0111 00344000
         LA    @10,@AFTEMPS                                        0111 00345000
         ST    @10,@AL00001+20                                     0111 00346000
         L     @15,DMCBMSG0(,DMCBPTR)                              0111 00347000
         LA    @01,@AL00001                                        0111 00348000
         BALR  @14,@15                                             0111 00349000
*   END;                            /* BLSDMSG                     0112 00350000
*                                      (ZZ2,F3112C,DMCBMSG,BLSDMSGS)    00351000
*                                      INSERT(DMCBMODL,OPCODE,RCODE,C   00352000
*                                      TEMP14,DMCBDSN) BUILD ERROR 0112 00353000
*                                      MESSAGE                       */ 00354000
*   END BASEMSG;                    /* END OF ISSUE THE IPCS BASIC 0113 00355000
*                                      DYNALLOC ERROR MESSAGE        */ 00356000
@EL00002 DS    0H                                                  0113 00357000
@EF00002 DS    0H                                                  0113 00358000
@ER00002 LM    @14,@12,@SA00002                                    0113 00359000
         BR    @14                                                 0113 00360000
         EJECT                                                          00361000
*                                                                  0114 00362000
*   /*****************************************************************/ 00363000
*   /*                                                               */ 00364000
*   /* PROCEDURE TO INVOKE IKJEFF18 TO DO DYNALLOC ERROR ANALYSIS    */ 00365000
*   /*                                                               */ 00366000
*   /*****************************************************************/ 00367000
*                                                                  0114 00368000
*INVDAIRF:                                                         0114 00369000
*   PROC;                           /* INVOKE IKJEFF18 TO DO DYNALLOC   00370000
*                                      ERROR ANALYSIS                */ 00371000
INVDAIRF STM   @14,@12,@SA00003                                    0114 00372000
*   RFY                                                            0115 00373000
*     GPR01P RSTD;                                                 0115 00374000
*   GPR01P=ADDR(DFPARMS);           /* PASS PARMLIST TO IJKEFF18     */ 00375000
         LA    GPR01P,DFPARMS                                      0116 00376000
*   GEN FLOWS(LINKERR);                                            0117 00377000
*                        /* TELL COMPILER ABOUT                         00378000
*                                      ERRET(LINKERR) IN LINK MACRO     00379000
*   RFY                                                            0118 00380000
*     GPR01P UNRSTD;                                               0118 00381000
*   DO;                             /* LINK EP(LINKNAME)           0119 00382000
*                                      ERRET(LINKERR)                */ 00383000
*     I00601='00'X;                 /* EP/DE FLAG                    */ 00384000
         MVI   I00601,X'00'                                        0120 00385000
*     I00602=ADDR(LINKNAME);        /* ADDR OF EP/DE                 */ 00386000
         LA    @10,@CC00346                                        0121 00387000
         STCM  @10,7,I00602                                        0121 00388000
*     I00604=0;                     /* DCB PTR                       */ 00389000
         SLR   @10,@10                                             0122 00390000
         STCM  @10,7,I00604                                        0122 00391000
*     I00603='80'X;                 /* ERRET FLAG                    */ 00392000
         MVI   I00603,X'80'                                        0123 00393000
*     I00605=ADDR(LINKERR);         /* ERRET PTR                     */ 00394000
         LA    @10,LINKERR                                         0124 00395000
         ST    @10,I00605                                          0124 00396000
*     RESPECIFY                                                    0125 00397000
*      (GPR15P) RESTRICTED;                                        0125 00398000
*     GPR15P=ADDR(I006);            /* ADDR OF LINK LIST             */ 00399000
         LA    GPR15P,I006                                         0126 00400000
*     SVC(6);                       /* ISSUE LINK SVC                */ 00401000
         SVC   6                                                   0127 00402000
*     RESPECIFY                                                    0128 00403000
*      (GPR15P) UNRESTRICTED;                                      0128 00404000
*   END;                            /* LINK EP(LINKNAME)           0129 00405000
*                                      ERRET(LINKERR) DO SVC 99 ERROR   00406000
*                                      ANALYSIS                      */ 00407000
*   RFY                                                            0130 00408000
*     GPR15F RSTD;                                                 0130 00409000
*   SUBCODE=GPR15F;                 /* SAVE THE RETURN CODE          */ 00410000
         ST    GPR15F,SUBCODE                                      0131 00411000
*   RFY                                                            0132 00412000
*     GPR15F UNRSTD;                                               0132 00413000
*   IF SUBCODE^=0 THEN              /* TEST FOR IKJEFF18 ERROR       */ 00414000
         L     @10,SUBCODE                                         0133 00415000
         LTR   @10,@10                                             0133 00416000
         BZ    @RF00133                                            0133 00417000
*     DO;                           /* IKJEFF18 ERROR                */ 00418000
*       RETCODE=ERROR;              /* FORCE ERROR TO CALLER         */ 00419000
         MVC   RETCODE(4),@CF00044                                 0135 00420000
*     END;                          /* IKJEFF18 ERROR                */ 00421000
*   RETURN;                                                        0137 00422000
@EL00003 DS    0H                                                  0137 00423000
@EF00003 DS    0H                                                  0137 00424000
@ER00003 LM    @14,@12,@SA00003                                    0137 00425000
         BR    @14                                                 0137 00426000
         EJECT                                                          00427000
*                                                                  0138 00428000
*/* START OF SPECIFICATIONS*******************************************/ 00429000
*/*                                                                  */ 00430000
*/*   MODULE NAME:  LINKERR (BLSCLKR)                                */ 00431000
*/*                                                                  */ 00432000
*/*   DESCRIPTIVE NAME:  IPCS DAS LINK SVC ERROR RETURN ROUTINE      */ 00433000
*/*                                                                  */ 00434000
*/*   COPYRIGHT: NONE                                                */ 00435000
*/*                                                                  */ 00436000
*/*   STATUS: SU57 RELEASE 1, LEVEL 0                                */ 00437000
*/*                                                                  */ 00438000
*/*   FUNCTION:                                                      */ 00439000
*/*     PROVIDE INCLUDED CODE FOR A LINK SVC ERROR RETURN THAT       */ 00440000
*/*     PRODUCES MESSAGE BLS03110 AND HOOKS IT TO THE DMCBMSG        */ 00441000
*/*     MESSAGE CHAIN ANCHOR.                                        */ 00442000
*/*                                                                  */ 00443000
*/*   NOTES:                                                         */ 00444000
*/*                                                                  */ 00445000
*/*     DEPENDENCIES:                                                */ 00446000
*/*       THE FOLLOWING SYMBOLS MUST BE DEFINED IN THE ENCLOSING     */ 00447000
*/*       PROCEDURE:                                                 */ 00448000
*/*          RETCODE                                                 */ 00449000
*/*          SUBCODE                                                 */ 00450000
*/*          ERROR                                                   */ 00451000
*/*          GPR01F                                                  */ 00452000
*/*          GPR15F                                                  */ 00453000
*/*          ABENDC                                                  */ 00454000
*/*          REASON                                                  */ 00455000
*/*          RESULT                                                  */ 00456000
*/*          MODNAME                                                 */ 00457000
*/*          LINKNAME                                                */ 00458000
*/*          CHSTR88                                                 */ 00459000
*/*          CHSTR847                                                */ 00460000
*/*          CTEMP                                                   */ 00461000
*/*          CTEMP18                                                 */ 00462000
*/*          HEXTBL                                                  */ 00463000
*/*          HEX0FC                                                  */ 00464000
*/*          F3110C                                                  */ 00465000
*/*                                                                  */ 00466000
*/*     RESTRICTIONS:   NONE                                         */ 00467000
*/*                                                                  */ 00468000
*/*     REGISTER CONVENTIONS:                                        */ 00469000
*/*       GPR01F - (1)                                               */ 00470000
*/*       GPR15F - (15)                                              */ 00471000
*/*                                                                  */ 00472000
*/*     PATCH LABEL:  N/A                                            */ 00473000
*/*                                                                  */ 00474000
*/*     SERIALIZATION REQUIREMENTS: NONE                             */ 00475000
*/*                                                                  */ 00476000
*/*   MODULE TYPE:  INCLUDED EXECUTABLE CODE                         */ 00477000
*/*                                                                  */ 00478000
*/*     PROCESSOR: PLS/2                                             */ 00479000
*/*                                                                  */ 00480000
*/*     MODULE SIZE: N/A                                             */ 00481000
*/*                                                                  */ 00482000
*/*     ATTRIBUTES:                                                  */ 00483000
*/*      EXECUTABLE          PROBLEM STATE      REENTRANT            */ 00484000
*/*                                                                  */ 00485000
*/*   ENTRY POINT:  LINKERR                                          */ 00486000
*/*                                                                  */ 00487000
*/*     PURPOSE:  SEE FUNCTION                                       */ 00488000
*/*                                                                  */ 00489000
*/*     LINKAGE:                                                     */ 00490000
*/*       R01 LOADED WITH ABEND CODE                                 */ 00491000
*/*       R15 LOADED WITH ABEND REASON CODE                          */ 00492000
*/*                                                                  */ 00493000
*/*     METHOD OF ACCESS:  SYSTEM LINK SVC ERRET                     */ 00494000
*/*                                                                  */ 00495000
*/*   INPUT:  SEE LINKAGE                                            */ 00496000
*/*                                                                  */ 00497000
*/*   OUTPUT:                                                        */ 00498000
*/*      MESSAGE BLS03110 CHAINED FROM DMCBMSG IN IPCS DM/PM FORMAT. */ 00499000
*/*      THE OUTPUT MESSAGE LIST FORMAT IS DESCRIBED IN THE BLSDMSG0 */ 00500000
*/*      MODULE DESCRIPTION.                                         */ 00501000
*/*                                                                  */ 00502000
*/*   EXIT-NORMAL:  RETURN TO LINK SVC                               */ 00503000
*/*     RETCODE = 8   MESSAGE BLS03110 IS ISSUED.                    */ 00504000
*/*                                                                  */ 00505000
*/*   EXIT-ERROR:  NONE                                              */ 00506000
*/*                                                                  */ 00507000
*/*   EXTERNAL REFERENCES:                                           */ 00508000
*/*                                                                  */ 00509000
*/*     ROUTINES:                                                    */ 00510000
*/*       BLSDMSG0      IPCS DM/PM MESSAGE TEXT BUILD FUNCTION       */ 00511000
*/*                                                                  */ 00512000
*/*     DATA AREAS: SEE SYMBOLS DEFINED UNDER DEPENDENCIES           */ 00513000
*/*                                                                  */ 00514000
*/*     CONTROL BLOCKS: DMCB      R,W                                */ 00515000
*/*                     BLSDMSGS  R                                  */ 00516000
*/*                     ZZ2       R                                  */ 00517000
*/*                                                                  */ 00518000
*/*   TABLES/WORKAREAS: NONE                                         */ 00519000
*/*                                                                  */ 00520000
*/*   MACROS: BLSDMSG                                                */ 00521000
*/*                                                                  */ 00522000
*/*   CHANGE ACTIVITY:                                               */ 00523000
*/*     THIS MODULE IS WRITTEN FOR @G57LPSR.                         */ 00524000
*/*                                                                  */ 00525000
*/*   MESSAGES ISSUED:                                               */ 00526000
*/*        BLS03110I LINK SVC TO LINKNAME FROM MODNAME FAILED.       */ 00527000
*/*                  ABEND CODE=XXXXXXXX, REASON CODE=YYYYYYYY       */ 00528000
*/*                                                                  */ 00529000
*/*   ABEND CODES:  NONE                                             */ 00530000
*/*                                                                  */ 00531000
*/*   DATA SETS ACCESSED:  NONE                                      */ 00532000
*/*                                                                  */ 00533000
*/*** END OF SPECIFICATIONS*******************************************/ 00534000
*                                                                  0138 00535000
*LINKERR:                                                          0138 00536000
*   RFY                                                            0138 00537000
*    (GPR01F,                                                      0138 00538000
*     GPR15F) RSTD;                                                0138 00539000
LINKERR  DS    0H                                                  0139 00540000
*   ABENDC=GPR01F;                  /* SAVE THE ABEND CODE           */ 00541000
         LR    ABENDC,GPR01F                                       0139 00542000
*   REASON=GPR15F;                  /* SAVE THE ABEND REASON CODE    */ 00543000
         LR    REASON,GPR15F                                       0140 00544000
*   RFY                                                            0141 00545000
*    (GPR01F,                                                      0141 00546000
*     GPR15F) UNRSTD;                                              0141 00547000
*   CHSTR847=ABENDC;                /* GET ABEND CODE FIELD          */ 00548000
         STCM  ABENDC,15,CHSTR847                                  0142 00549000
*   CHSTR88=LHEX0FC;                /* TRANSLATE IT TO PRINTABLE HEX */ 00550000
         MVI   CHSTR88,X'0F'                                       0143 00551000
*   UNPK(CTEMP,CHSTR8);                                            0144 00552000
         UNPK  CTEMP(9),CHSTR8(8)                                  0144 00553000
*   TR(CTEMP,HEXTBL);                                              0145 00554000
         TR    CTEMP(9),HEXTBL                                     0145 00555000
*   RESULT=CTEMP18;                 /* STORE THE RESULT              */ 00556000
         MVC   RESULT(8),CTEMP18                                   0146 00557000
*   CHSTR847=REASON;                /* GET REASON CODE FIELD         */ 00558000
         STCM  REASON,15,CHSTR847                                  0147 00559000
*   CHSTR88=LHEX0FC;                /* TRANSLATE IT TO PRINTABLE HEX */ 00560000
         MVI   CHSTR88,X'0F'                                       0148 00561000
*   UNPK(CTEMP,CHSTR8);                                            0149 00562000
         UNPK  CTEMP(9),CHSTR8(8)                                  0149 00563000
*   TR(CTEMP,HEXTBL);                                              0150 00564000
         TR    CTEMP(9),HEXTBL                                     0150 00565000
*   DO;                             /* BLSDMSG                     0151 00566000
*                                      (ZZ2,F3110C,DMCBMSG,BLSDMSGS)    00567000
*                                      INSERT(LINKNAME,MODNAME,RESULT   00568000
*                                      ,CTEMP18)                     */ 00569000
*     IOPTLIST(1)=ADDR(IOPTLIST(4));/* CHAIN TO NEXT INSERT          */ 00570000
         LA    @10,IOPTLIST+12                                     0152 00571000
         ST    @10,IOPTLIST                                        0152 00572000
*     IOPTLIST(2)=ADDR(LINKNAME);   /* INSERT NAME POINTER           */ 00573000
         LA    @10,@CC00346                                        0153 00574000
         ST    @10,IOPTLIST+4                                      0153 00575000
*     IOPTLIST(3)=0;                /* ZERO RESERVED FIELD           */ 00576000
         SLR   @10,@10                                             0154 00577000
         ST    @10,IOPTLIST+8                                      0154 00578000
*     RFY                                                          0155 00579000
*       I015F BASED(ADDR(IOPTLIST(3)));/* ACCESS BYTES 1-2           */ 00580000
*     I015F=LENGTH(LINKNAME);       /* INSERT LENGTH                 */ 00581000
         LA    @05,8                                               0156 00582000
         LA    @15,IOPTLIST+8                                      0156 00583000
         STH   @05,I015F(,@15)                                     0156 00584000
*     IOPTLIST(4)=ADDR(IOPTLIST(7));/* CHAIN TO NEXT INSERT          */ 00585000
         LA    @15,IOPTLIST+24                                     0157 00586000
         ST    @15,IOPTLIST+12                                     0157 00587000
*     IOPTLIST(5)=ADDR(MODNAME);    /* INSERT NAME POINTER           */ 00588000
         LA    @15,MODNAME                                         0158 00589000
         ST    @15,IOPTLIST+16                                     0158 00590000
*     IOPTLIST(6)=0;                /* ZERO RESERVED FIELD           */ 00591000
         ST    @10,IOPTLIST+20                                     0159 00592000
*     RFY                                                          0160 00593000
*       I015F BASED(ADDR(IOPTLIST(6)));/* ACCESS BYTES 1-2           */ 00594000
*     I015F=LENGTH(MODNAME);        /* INSERT LENGTH                 */ 00595000
         LA    @15,IOPTLIST+20                                     0161 00596000
         STH   @05,I015F(,@15)                                     0161 00597000
*     IOPTLIST(7)=ADDR(IOPTLIST(10));/* CHAIN TO NEXT INSERT         */ 00598000
         LA    @15,IOPTLIST+36                                     0162 00599000
         ST    @15,IOPTLIST+24                                     0162 00600000
*     IOPTLIST(8)=ADDR(RESULT);     /* INSERT NAME POINTER           */ 00601000
         LA    @15,RESULT                                          0163 00602000
         ST    @15,IOPTLIST+28                                     0163 00603000
*     IOPTLIST(9)=0;                /* ZERO RESERVED FIELD           */ 00604000
         ST    @10,IOPTLIST+32                                     0164 00605000
*     RFY                                                          0165 00606000
*       I015F BASED(ADDR(IOPTLIST(9)));/* ACCESS BYTES 1-2           */ 00607000
*     I015F=LENGTH(RESULT);         /* INSERT LENGTH                 */ 00608000
         LA    @15,IOPTLIST+32                                     0166 00609000
         STH   @05,I015F(,@15)                                     0166 00610000
*     IOPTLIST(10)=0;               /* LAST INSERT                   */ 00611000
         ST    @10,IOPTLIST+36                                     0167 00612000
*     IOPTLIST(11)=ADDR(CTEMP18);   /* INSERT NAME POINTER           */ 00613000
         LA    @15,CTEMP18                                         0168 00614000
         ST    @15,IOPTLIST+40                                     0168 00615000
*     IOPTLIST(12)=0;               /* ZERO RESERVED FIELD           */ 00616000
         ST    @10,IOPTLIST+44                                     0169 00617000
*     RFY                                                          0170 00618000
*       I015F BASED(ADDR(IOPTLIST(12)));/* ACCESS BYTES 1-2          */ 00619000
*     I015F=LENGTH(CTEMP18);        /* INSERT LENGTH                 */ 00620000
         LA    @10,IOPTLIST+44                                     0171 00621000
         STH   @05,I015F(,@10)                                     0171 00622000
*     CALL BLSDMSG0(ZZ2,F3110C,DMCBMSG,BLSDMSGS,'00000000'B,ADDR(  0172 00623000
*         IOPTLIST));               /* BUILD MESSAGE                 */ 00624000
         L     @10,DMCBTVP(,DMCBPTR)                               0172 00625000
         ST    @10,@AL00001                                        0172 00626000
         LA    @10,@CF00330                                        0172 00627000
         ST    @10,@AL00001+4                                      0172 00628000
         LA    @10,DMCBMSG(,DMCBPTR)                               0172 00629000
         ST    @10,@AL00001+8                                      0172 00630000
         L     @10,DMCBMSGS(,DMCBPTR)                              0172 00631000
         ST    @10,@AL00001+12                                     0172 00632000
         LA    @10,@CB00375                                        0172 00633000
         ST    @10,@AL00001+16                                     0172 00634000
         LA    @10,IOPTLIST                                        0172 00635000
         ST    @10,@AFTEMPS+4                                      0172 00636000
         LA    @10,@AFTEMPS+4                                      0172 00637000
         ST    @10,@AL00001+20                                     0172 00638000
         L     @15,DMCBMSG0(,DMCBPTR)                              0172 00639000
         LA    @01,@AL00001                                        0172 00640000
         BALR  @14,@15                                             0172 00641000
*   END;                            /* BLSDMSG                     0173 00642000
*                                      (ZZ2,F3110C,DMCBMSG,BLSDMSGS)    00643000
*                                      INSERT(LINKNAME,MODNAME,RESULT   00644000
*                                      ,CTEMP18) BUILD LINK SVC ERROR   00645000
*                                      MESSAGE                       */ 00646000
*   RETCODE=ERROR;                  /* MARK ERROR TO CALLER          */ 00647000
         MVC   RETCODE(4),@CF00044                                 0174 00648000
*   END INVDAIRF;                   /* END INVOKE IKJEFF18 TO DO   0175 00649000
*                                      DYNALLOC ERROR ANALYSIS       */ 00650000
         B     @EL00003                                            0175 00651000
         EJECT                                                          00652000
*                                                                  0176 00653000
*   /*****************************************************************/ 00654000
*   /*                                                               */ 00655000
*   /* END OF EXECUTABLE PROCEDURE STATEMENTS                        */ 00656000
*   /*                                                               */ 00657000
*   /*****************************************************************/ 00658000
*                                                                  0176 00659000
*   DECLARE                         /* GENERAL PURPOSE REGISTERS     */ 00660000
*     GPR01F FIXED(31) REG(1),                                     0176 00661000
*     GPR15F FIXED(31) REG(15),                                    0176 00662000
*     GPR01P PTR(31) REG(1),                                       0176 00663000
*     GPR15P PTR(31) REG(15);                                      0176 00664000
*   DCL                                                            0177 00665000
*     1 I006 DEF(ILIST),            /* DEFINE LIST                   */ 00666000
*      2 I00601 CHAR(1),            /* EP/DE FLAG                    */ 00667000
*      2 I00602 PTR(24),            /* EP/DE PTR                     */ 00668000
*      2 I00603 CHAR(1),            /* ERRET FLAG                    */ 00669000
*      2 I00604 PTR(24),            /* DCB PTR                       */ 00670000
*      2 I00605 PTR(31);            /* ERRET PTR                     */ 00671000
*   DECLARE                                                        0178 00672000
*     ILIST CHAR(12) BDY(DWORD);    /* STANDARD LIST                 */ 00673000
*   DECLARE                         /* COMMON VARIABLES              */ 00674000
*     I256C CHAR(256) BASED,                                       0179 00675000
*     I031F FIXED(31) BASED,                                       0179 00676000
*     I031P PTR(31) BASED,                                         0179 00677000
*     I015F FIXED(15) BASED,                                       0179 00678000
*     I015P PTR(15) BASED,                                         0179 00679000
*     I008P PTR(8) BASED,                                          0179 00680000
*     I001C CHAR(1) BASED;                                         0179 00681000
*   DECLARE                                                        0180 00682000
*     IOPTLIST(15) PTR(31) BDY(WORD);/* OPTION LIST ARRAY            */ 00683000
*   DCL                                                            0181 00684000
*     1 DASPATCH LOCAL BDY(DWORD),  /* PATCH AREA                    */ 00685000
*      2 DASPATA(DASPATLN) PTR INIT((DASPATLN)0);                  0181 00686000
*   GEN DATA DEFS(HEXTBL);                                         0182 00687000
*   END BLSCANAL                                                   0183 00688000
*                                                                  0183 00689000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 00690000
*/*%INCLUDE SYSLIB  (IEFZB4D0)                                       */ 00691000
*/*%INCLUDE SYSLIB  (IKJEFFDF)                                       */ 00692000
*/*%INCLUDE SYSLIB  (BLSCLKR )                                       */ 00693000
*                                                                  0183 00694000
*       ;                                                          0183 00695000
@EL00001 L     @13,4(,@13)                                         0183 00696000
@EF00001 L     @00,@SIZDATD                                        0183 00697000
         LR    @01,@11                                             0183 00698000
         BLSCFRES R,LV=(0),A=(1)                                        00699000
@ER00001 LM    @14,@12,12(@13)                                     0183 00700000
         BR    @14                                                 0183 00701000
@DATA    DS    0H                                                       00702000
@CH00037 DC    H'4'                                                     00703000
@CH00119 DC    H'44'                                                    00704000
@DATD    DSECT                                                          00705000
         DS    0F                                                       00706000
@SA00001 DS    18F                                                      00707000
@SA00002 DS    15F                                                      00708000
@SA00003 DS    15F                                                      00709000
@AL00001 DS    6A                                                       00710000
@TF00001 DS    F                                                        00711000
@AFTEMPS DS    2F                                                       00712000
BLSCANAL CSECT                                                          00713000
         DS    0F                                                       00714000
@CF00044 DC    F'8'                                                     00715000
@CH00044 EQU   @CF00044+2                                               00716000
@CF00330 DC    F'3110'                                                  00717000
@CF00332 DC    F'3112'                                                  00718000
@DATD    DSECT                                                          00719000
         DS    0D                                                       00720000
S99RBPTR DS    AL4                                                      00721000
         ORG   S99RBPTR                                                 00722000
S99RBPND DS    BL1                                                      00723000
         ORG   S99RBPTR+4                                               00724000
S99TUFP  DS    A                                                        00725000
LDFMSGWT DS    A                                                        00726000
LDFID    DS    H                                                        00727000
         DS    CL2                                                      00728000
DFPARMS  DS    CL24                                                     00729000
         ORG   DFPARMS                                                  00730000
DFS99RBP DS    AL4                                                      00731000
         ORG   DFS99RBP                                                 00732000
DFDAPLP  DS    AL4                                                      00733000
         ORG   DFPARMS+4                                                00734000
DFRCP    DS    AL4                                                      00735000
DFJEFF02 DS    AL4                                                      00736000
DFIDP    DS    AL4                                                      00737000
DFCPPLP  DS    AL4                                                      00738000
DFBUFP   DS    AL4                                                      00739000
         ORG   DFPARMS+24                                               00740000
DFBUFS   DS    CL511                                                    00741000
         ORG   DFBUFS                                                   00742000
DFBUF1   DS    CL255                                                    00743000
         ORG   DFBUF1                                                   00744000
DFBUFL1  DS    FL2                                                      00745000
DFBUFO1  DS    FL2                                                      00746000
DFBUFT1  DS    CL251                                                    00747000
         ORG   DFBUFS+255                                               00748000
@NM00003 DS    CL1                                                      00749000
DFBUF2   DS    CL255                                                    00750000
         ORG   DFBUF2                                                   00751000
DFBUFL2  DS    FL2                                                      00752000
DFBUFO2  DS    FL2                                                      00753000
DFBUFT2  DS    CL251                                                    00754000
         ORG   DFBUFS+511                                               00755000
         DS    CL1                                                      00756000
MODSTAT  DS    CL16                                                     00757000
         ORG   MODSTAT                                                  00758000
MODNAME  DS    CL8                                                      00759000
RETCODE  DS    FL4                                                      00760000
SUBCODE  DS    FL4                                                      00761000
         ORG   MODSTAT+16                                               00762000
OPCODE   DS    CL2                                                      00763000
RCODE    DS    CL2                                                      00764000
RESULT   DS    CL8                                                      00765000
         DS    CL4                                                      00766000
CHSTR8   DS    CL8                                                      00767000
         ORG   CHSTR8                                                   00768000
@NM00004 DS    CL3                                                      00769000
CHSTR847 DS    CL4                                                      00770000
         ORG   CHSTR847                                                 00771000
CHSTR846 DS    CL3                                                      00772000
CHSTR87  DS    CL1                                                      00773000
         ORG   CHSTR8+7                                                 00774000
CHSTR88  DS    CL1                                                      00775000
         ORG   CHSTR8+8                                                 00776000
CTEMP    DS    CL9                                                      00777000
         ORG   CTEMP                                                    00778000
CTEMP18  DS    CL8                                                      00779000
         ORG   CTEMP18                                                  00780000
CTEMP14  DS    CL4                                                      00781000
CTEMP58  DS    CL4                                                      00782000
         ORG   CTEMP58                                                  00783000
CTEMP56  DS    CL2                                                      00784000
CTEMP78  DS    CL2                                                      00785000
         ORG   CTEMP+9                                                  00786000
         DS    CL7                                                      00787000
ILIST    DS    CL12                                                     00788000
IOPTLIST DS    15A                                                      00789000
BLSCANAL CSECT                                                          00790000
         DS    0F                                                       00791000
@SIZDATD DC    AL1(0)                                                   00792000
         DC    AL3(@ENDDATD-@DATD)                                      00793000
@CV00290 DC    V(BLSCRFM)                                               00794000
         DS    0D                                                       00795000
@CC00344 DC    C'BLSCANAL'                                              00796000
@CC00346 DC    C'IKJEFF18'                                              00797000
@CB00375 DC    B'00000000'                                              00798000
         DS    CL7                                                      00799000
DASPATCH DS    CL80                                                     00800000
         ORG   DASPATCH                                                 00801000
DASPATA  DC    20A(0)                                                   00802000
         ORG   DASPATCH+80                                              00803000
BLSCANAL CSECT                                                          00804000
*                         /*                                            00805000
HEXTBL   EQU   *-240                                                    00806000
         DC    CL16'0123456789ABCDEF'                                   00807000
@DATD    DSECT                                                          00808000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                00809000
@ENDDATD EQU   *                                                        00810000
BLSCANAL CSECT                                                          00811000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00812000
@01      EQU   01                                                       00813000
@02      EQU   02                                                       00814000
@03      EQU   03                                                       00815000
@04      EQU   04                                                       00816000
@05      EQU   05                                                       00817000
@06      EQU   06                                                       00818000
@07      EQU   07                                                       00819000
@08      EQU   08                                                       00820000
@09      EQU   09                                                       00821000
@10      EQU   10                                                       00822000
@11      EQU   11                                                       00823000
@12      EQU   12                                                       00824000
@13      EQU   13                                                       00825000
@14      EQU   14                                                       00826000
@15      EQU   15                                                       00827000
REASON   EQU   @06                                                      00828000
ABENDC   EQU   @05                                                      00829000
DMCBPTR  EQU   @04                                                      00830000
GPR01P   EQU   @01                                                      00831000
GPR15F   EQU   @15                                                      00832000
GPR15P   EQU   @15                                                      00833000
GPR01F   EQU   @01                                                      00834000
DMCB     EQU   0                                                        00835000
DMCBTVP  EQU   DMCB+8                                                   00836000
DMCBFTY  EQU   DMCB+20                                                  00837000
DMCBOPN  EQU   DMCB+21                                                  00838000
DMCBRMOD EQU   DMCB+23                                                  00839000
DMCBOUT  EQU   DMCBRMOD                                                 00840000
DMCBOPTS EQU   DMCB+24                                                  00841000
DMCBGKY  EQU   DMCBOPTS                                                 00842000
DMCBMFLG EQU   DMCB+28                                                  00843000
DMCBBUFP EQU   DMCB+32                                                  00844000
DMCBKEYP EQU   DMCB+44                                                  00845000
DMCBMSG  EQU   DMCB+52                                                  00846000
DMCBRI   EQU   DMCB+64                                                  00847000
DMCBMSG0 EQU   DMCB+68                                                  00848000
DMCBMSGS EQU   DMCB+72                                                  00849000
DMCBFRE  EQU   DMCB+88                                                  00850000
DMCBEOB  EQU   DMCB+92                                                  00851000
DMCBACBE EQU   DMCB+124                                                 00852000
DMCBDSN  EQU   DMCB+284                                                 00853000
DMCBMODL EQU   DMCB+348                                                 00854000
DMCBSPEC EQU   DMCB+380                                                 00855000
DMCBDRBP EQU   DMCB+400                                                 00856000
DMCBSUBC EQU   DMCB+404                                                 00857000
DMCBAMS  EQU   DMCB+416                                                 00858000
DMCBAUDT EQU   DMCB+568                                                 00859000
DMCBLSCP EQU   DMCBAUDT+16                                              00860000
S99RB    EQU   0                                                        00861000
S99VERB  EQU   S99RB+1                                                  00862000
S99FLAG1 EQU   S99RB+2                                                  00863000
S99FLG11 EQU   S99FLAG1                                                 00864000
S99RSC   EQU   S99RB+4                                                  00865000
S99TXTPP EQU   S99RB+8                                                  00866000
S99FLAG2 EQU   S99RB+16                                                 00867000
S99FLG21 EQU   S99FLAG2                                                 00868000
S99FLG22 EQU   S99FLAG2+1                                               00869000
S99TUPL  EQU   0                                                        00870000
S99TUPTR EQU   S99TUPL                                                  00871000
S99TUP   EQU   0                                                        00872000
S99TUNIT EQU   0                                                        00873000
S99TUENT EQU   S99TUNIT+4                                               00874000
S99TUFLD EQU   0                                                        00875000
DFMSGWTP EQU   0                                                        00876000
DFID     EQU   0                                                        00877000
@NM00001 EQU   DFID                                                     00878000
DFWTP    EQU   @NM00001                                                 00879000
DFBUFSW  EQU   @NM00001                                                 00880000
DFBUFS2  EQU   @NM00001                                                 00881000
IDNUM    EQU   DFID+1                                                   00882000
DFIDNUM  EQU   IDNUM                                                    00883000
BLSDMSGS EQU   0                                                        00884000
BLSDMSG0 EQU   0                                                        00885000
ZZ2      EQU   0                                                        00886000
I015F    EQU   0                                                        00887000
DFRC     EQU   0                                                        00888000
DMCBDMGR EQU   0                                                        00889000
DMCBRQC  EQU   0                                                        00890000
I001C    EQU   0                                                        00891000
I008P    EQU   0                                                        00892000
I015P    EQU   0                                                        00893000
I031F    EQU   0                                                        00894000
I031P    EQU   0                                                        00895000
I256C    EQU   0                                                        00896000
DMCBVSM  EQU   DMCBAMS                                                  00897000
DMCBQSM  EQU   DMCBAMS                                                  00898000
I006     EQU   ILIST                                                    00899000
I00601   EQU   I006                                                     00900000
I00602   EQU   I006+1                                                   00901000
I00603   EQU   I006+4                                                   00902000
I00604   EQU   I006+5                                                   00903000
I00605   EQU   I006+8                                                   00904000
CHSTR878 EQU   CHSTR8+6                                                 00905000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    00906000
DMCBRES7 EQU   DMCBQSM+96                                               00907000
DMCBDCB  EQU   DMCBQSM                                                  00908000
DMCBACB  EQU   DMCBVSM+76                                               00909000
DMCBRPL  EQU   DMCBVSM                                                  00910000
@NM00002 EQU   @NM00001                                                 00911000
S99TUPRM EQU   S99TUFLD+2                                               00912000
S99TULEN EQU   S99TUFLD                                                 00913000
S99TUPAR EQU   S99TUENT+2                                               00914000
S99TULNG EQU   S99TUENT                                                 00915000
S99TUNUM EQU   S99TUNIT+2                                               00916000
S99TUKEY EQU   S99TUNIT                                                 00917000
S99TUPND EQU   S99TUP                                                   00918000
S99TUPLN EQU   S99TUPTR                                                 00919000
S99FLG24 EQU   S99FLAG2+3                                               00920000
S99FLG23 EQU   S99FLAG2+2                                               00921000
S99PCINT EQU   S99FLG22                                                 00922000
S99UDEVT EQU   S99FLG22                                                 00923000
S99MOUNT EQU   S99FLG21                                                 00924000
S99CATLG EQU   S99FLG21                                                 00925000
S99TIONQ EQU   S99FLG21                                                 00926000
S99OFFLN EQU   S99FLG21                                                 00927000
S99WTUNT EQU   S99FLG21                                                 00928000
S99NORES EQU   S99FLG21                                                 00929000
S99WTDSN EQU   S99FLG21                                                 00930000
S99WTVOL EQU   S99FLG21                                                 00931000
S99RSV01 EQU   S99RB+12                                                 00932000
S99INFO  EQU   S99RSC+2                                                 00933000
S99ERROR EQU   S99RSC                                                   00934000
S99FLG12 EQU   S99FLAG1+1                                               00935000
S99JBSYS EQU   S99FLG11                                                 00936000
S99NOMNT EQU   S99FLG11                                                 00937000
S99NOCNV EQU   S99FLG11                                                 00938000
S99ONCNV EQU   S99FLG11                                                 00939000
S99RBLN  EQU   S99RB                                                    00940000
DMCBWRK  EQU   DMCB+648                                                 00941000
DMCBRES8 EQU   DMCB+640                                                 00942000
DMCBMODN EQU   DMCB+632                                                 00943000
DMCBCARY EQU   DMCBAUDT+20                                              00944000
DMCBCLC  EQU   DMCBAUDT+12                                              00945000
DMCBOPC  EQU   DMCBAUDT+8                                               00946000
DMCBFRC  EQU   DMCBAUDT+4                                               00947000
DMCBALC  EQU   DMCBAUDT                                                 00948000
DMCBFR   EQU   DMCB+412                                                 00949000
DMCBRES6 EQU   DMCB+410                                                 00950000
DMCBIRSC EQU   DMCB+408                                                 00951000
DMCBRSZM EQU   DMCB+398                                                 00952000
DMCBRSZA EQU   DMCB+396                                                 00953000
DMCBCISZ EQU   DMCB+394                                                 00954000
DMCBDCBL EQU   DMCB+392                                                 00955000
DMCBDCLR EQU   DMCB+390                                                 00956000
DMCBDCFM EQU   DMCB+389                                                 00957000
DMCBRES5 EQU   DMCB+388                                                 00958000
DMCBLBRT EQU   DMCB+386                                                 00959000
DMCBLBSQ EQU   DMCB+384                                                 00960000
DMCBLBPS EQU   DMCB+383                                                 00961000
DMCBLBTY EQU   DMCB+382                                                 00962000
DMCBRES4 EQU   DMCB+381                                                 00963000
DMCBSPRS EQU   DMCBSPEC                                                 00964000
DMCBSPRN EQU   DMCBSPEC                                                 00965000
DMCBSPCT EQU   DMCBSPEC                                                 00966000
DMCBSPRL EQU   DMCBSPEC                                                 00967000
DMCBSPSE EQU   DMCB+376                                                 00968000
DMCBSPPR EQU   DMCB+372                                                 00969000
DMCBSPTY EQU   DMCB+369                                                 00970000
DMCBODIS EQU   DMCB+368                                                 00971000
DMCBDISP EQU   DMCB+367                                                 00972000
DMCBSTAT EQU   DMCB+366                                                 00973000
DMCBRES3 EQU   DMCB+364                                                 00974000
DMCBMEMB EQU   DMCB+356                                                 00975000
DMCBRES9 EQU   DMCB+340                                                 00976000
DMCBPID  EQU   DMCB+332                                                 00977000
DMCBTYPE EQU   DMCB+328                                                 00978000
DMCBUNIT EQU   DMCB+276                                                 00979000
DMCBDSOR EQU   DMCB+274                                                 00980000
DMCBVOL  EQU   DMCB+268                                                 00981000
DMCBDDNM EQU   DMCB+260                                                 00982000
DMCBSYNM EQU   DMCB+132                                                 00983000
DMCBRPLF EQU   DMCB+128                                                 00984000
DMCBDCBE EQU   DMCBACBE                                                 00985000
DMCBARC  EQU   DMCB+120                                                 00986000
DMCBCPC  EQU   DMCB+116                                                 00987000
DMCBRET  EQU   DMCB+112                                                 00988000
DMCBSTL  EQU   DMCB+96                                                  00989000
DMCBRES2 EQU   DMCB+85                                                  00990000
DMCBSPID EQU   DMCB+84                                                  00991000
DMCBRESC EQU   DMCB+80                                                  00992000
DMCBZZ1P EQU   DMCB+76                                                  00993000
DMCBRRL  EQU   DMCB+60                                                  00994000
DMCBRBA  EQU   DMCB+56                                                  00995000
DMCBKEYL EQU   DMCB+48                                                  00996000
DMCBKPC  EQU   DMCBKEYP                                                 00997000
DMCBORL  EQU   DMCB+40                                                  00998000
DMCBBLEN EQU   DMCB+36                                                  00999000
DMCBBFPC EQU   DMCBBUFP                                                 01000000
DMCBRES1 EQU   DMCB+31                                                  01001000
DMCBACCM EQU   DMCB+30                                                  01002000
DMCBREJ  EQU   DMCB+29                                                  01003000
DMCBRESB EQU   DMCBMFLG                                                 01004000
DMCBFMOD EQU   DMCBMFLG                                                 01005000
DMCBLOPT EQU   DMCB+27                                                  01006000
DMCBLRM  EQU   DMCB+26                                                  01007000
DMCBLRQ  EQU   DMCB+25                                                  01008000
DMCBOPRS EQU   DMCBOPTS                                                 01009000
DMCBLRD  EQU   DMCBOPTS                                                 01010000
DMCBBWD  EQU   DMCBOPTS                                                 01011000
DMCBUPD  EQU   DMCBOPTS                                                 01012000
DMCBAPX  EQU   DMCBOPTS                                                 01013000
DMCBRNO  EQU   DMCBGKY                                                  01014000
DMCBKYD  EQU   DMCBOPTS                                                 01015000
DMCBRMRS EQU   DMCBRMOD                                                 01016000
DMCBRM5  EQU   DMCBRMOD                                                 01017000
DMCBRM6  EQU   DMCBRMOD                                                 01018000
DMCBTMP  EQU   DMCBOUT                                                  01019000
DMCBRQST EQU   DMCB+22                                                  01020000
DMCBRESA EQU   DMCBOPN                                                  01021000
DMCBSOUT EQU   DMCBOPN                                                  01022000
DMCBSIN  EQU   DMCBOPN                                                  01023000
DMCBVSF  EQU   DMCBFTY                                                  01024000
DMCBKSF  EQU   DMCBFTY                                                  01025000
DMCBFTRS EQU   DMCBFTY                                                  01026000
DMCBSHF  EQU   DMCBFTY                                                  01027000
DMCBIRL  EQU   DMCB+16                                                  01028000
DMCBRTC  EQU   DMCB+12                                                  01029000
DMCBNEXT EQU   DMCB+4                                                   01030000
DMCBID   EQU   DMCB                                                     01031000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      01032000
@RF00133 EQU   @EL00003                                                 01033000
@ENDDATA EQU   *                                                        01034000
         END   BLSCANAL,(C'PLS1847',0701,78062)                         01035000
