         TITLE 'BLSCERSE -- IPCS DATA ACCESS SERVICES ERASE EXECUTOR   *00001000
                        '                                               00002000
*     /* CHANGE ACTIVITY                                                00003000
*    THIS MODULE IS WRITTEN FOR @G57LPSR                                00004000
BLSCERSE CSECT ,                                                   0002 00005000
@MAINENT DS    0H                                                  0002 00006000
         USING *,@15                                               0002 00007000
         B     @PROLOG                                             0002 00008000
         DC    AL1(16)                                             0002 00009000
         DC    C'BLSCERSE  78.062'                                 0002 00010000
         DROP  @15                                                      00011000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00012000
         BALR  @12,0                                               0002 00013000
@PSTART  DS    0H                                                  0002 00014000
         USING @PSTART,@12                                         0002 00015000
         L     @00,@SIZDATD                                        0002 00016000
         BLSCGETS R,LV=(0)                                              00017000
         LR    @11,@01                                             0002 00018000
         USING @DATD,@11                                           0002 00019000
         ST    @13,@SA00001+4                                      0002 00020000
         LM    @00,@01,20(@13)                                     0002 00021000
         ST    @11,8(,@13)                                         0002 00022000
         LR    @13,@11                                             0002 00023000
*   DMCBPTR=GPR01P;                 /* ESTABLISH ADDRESSIBILITY TO 0011 00024000
*                                      DMCB                          */ 00025000
         LR    DMCBPTR,GPR01P                                      0011 00026000
*   RFY                                                            0012 00027000
*     GPR01P UNRSTD;                                               0012 00028000
*   MODNAME=LMODNMC;                /* MARK AUTOMATIC AREA           */ 00029000
         MVC   MODNAME(8),@CC00240                                 0013 00030000
*   SUBCODE=F0C;                    /* SUB-ROUTINE RETURN CODE       */ 00031000
         SLR   @10,@10                                             0014 00032000
         ST    @10,SUBCODE                                         0014 00033000
*   DMCBREJ=F0C;                    /* INVALID REQUEST REJECT CODE   */ 00034000
         MVI   DMCBREJ(DMCBPTR),X'00'                              0015 00035000
*   DMCBRTC=F0C;                    /* WE ARE SUCCESSFUL UNTIL WE  0016 00036000
*                                      FAIL                          */ 00037000
*                                                                  0016 00038000
         ST    @10,DMCBRTC(,DMCBPTR)                               0016 00039000
*   /*****************************************************************/ 00040000
*   /*                                                               */ 00041000
*   /* FIRST DECIDE WHETHER DMCB IS OPEN                             */ 00042000
*   /*                                                               */ 00043000
*   /*****************************************************************/ 00044000
*                                                                  0017 00045000
*   IF DMCBSOUT=OFF THEN            /* DMCB NOT OPEN FOR OUTPUT      */ 00046000
         TM    DMCBSOUT(DMCBPTR),B'01000000'                       0017 00047000
         BNZ   @RF00017                                            0017 00048000
*     DO;                           /* FILE NOT OPEN                 */ 00049000
*       DMCBRTC=INVRQ;              /* INDICATE INVALID REQUEST      */ 00050000
         MVC   DMCBRTC(4,DMCBPTR),@CF00037                         0019 00051000
*       DMCBREJ=F0C;                /* REQ REJECTED SINCE DMCB IS NOT   00052000
*                                      OPEN FOR OUTPUT               */ 00053000
         MVI   DMCBREJ(DMCBPTR),X'00'                              0020 00054000
*     END;                          /* FILE NOT OPEN                 */ 00055000
*   ELSE                                                           0022 00056000
*     DO;                           /* DMCB IS OPEN                  */ 00057000
         B     @RC00017                                            0022 00058000
@RF00017 DS    0H                                                  0023 00059000
*       DMCBFMOD=ON;                /* INDICATE FILE IS TO BE      0023 00060000
*                                      MODIFIED                      */ 00061000
         OI    DMCBFMOD(DMCBPTR),B'10000000'                       0023 00062000
         EJECT                                                          00063000
*       IF DMCBVSF=OFF THEN                                        0024 00064000
*                                                                  0024 00065000
         TM    DMCBVSF(DMCBPTR),B'00000001'                        0024 00066000
         BNZ   @RF00024                                            0024 00067000
*         /***********************************************************/ 00068000
*         /*                                                         */ 00069000
*         /* QSAM FILE                                               */ 00070000
*         /*                                                         */ 00071000
*         /***********************************************************/ 00072000
*                                                                  0025 00073000
*         DO;                       /* QSAM FILE                     */ 00074000
*           DMCBRTC=INVRQ;          /* INVALID REQUEST               */ 00075000
         MVC   DMCBRTC(4,DMCBPTR),@CF00037                         0026 00076000
*           DMCBREJ=F10C;           /* FOR QSAM                      */ 00077000
         MVI   DMCBREJ(DMCBPTR),X'0A'                              0027 00078000
*         END;                      /* QSAM FILE                     */ 00079000
         SPACE 3                                                        00080000
*                                                                  0029 00081000
*       /*************************************************************/ 00082000
*       /*                                                           */ 00083000
*       /* VSAM FILE                                                 */ 00084000
*       /*                                                           */ 00085000
*       /*************************************************************/ 00086000
*                                                                  0029 00087000
*       ELSE                                                       0029 00088000
*         DO;                       /* VSAM FILE                     */ 00089000
*                                                                  0029 00090000
         B     @RC00024                                            0029 00091000
@RF00024 DS    0H                                                  0030 00092000
*           /*********************************************************/ 00093000
*           /*                                                       */ 00094000
*           /* FOR VSAM FILES CALL BLSCSETT TO PERFORM RPL           */ 00095000
*           /* MODIFICATIONS                                         */ 00096000
*           /*                                                       */ 00097000
*           /*********************************************************/ 00098000
*                                                                  0030 00099000
*           RFY                                                    0030 00100000
*             GPR01P RSTD;                                         0030 00101000
*           GPR01P=DMCBPTR;         /* BLSCSETT INTERFACE            */ 00102000
         LR    GPR01P,DMCBPTR                                      0031 00103000
*           CALL BLSCSETT;          /* PERFORM SET FUNCTION          */ 00104000
         L     @15,@CV00198                                        0032 00105000
         BALR  @14,@15                                             0032 00106000
*           RFY                                                    0033 00107000
*             GPR01P UNRSTD;                                       0033 00108000
*           IF DMCBRTC=F0C THEN     /* TEST BLSCSETT RETURN CODE     */ 00109000
         SLR   @10,@10                                             0034 00110000
         C     @10,DMCBRTC(,DMCBPTR)                               0034 00111000
         BNE   @RF00034                                            0034 00112000
*             DO;                   /* SET IS OK                     */ 00113000
*                                                                  0035 00114000
*               /*****************************************************/ 00115000
*               /*                                                   */ 00116000
*               /* DETERMINE IF ACCESS IS BY RELATIVE RECORD AND IF  */ 00117000
*               /* SO THEN CALCULATE EFFECTIVE RBA                   */ 00118000
*               /*                                                   */ 00119000
*               /*****************************************************/ 00120000
*                                                                  0036 00121000
*               IF DMCBKYD=OFF      /* NON KEYED ACCESS              */ 00122000
*                   &DMCBRNO=ON THEN/* RELATIVE RECORD ACCESS        */ 00123000
         TM    DMCBRNO(DMCBPTR),B'01000000'                        0036 00124000
         BNO   @RF00036                                            0036 00125000
         TM    DMCBKYD(DMCBPTR),B'10000000'                        0036 00126000
         BNZ   @RF00036                                            0036 00127000
*                 DO;               /* VSAM RELATVE RECORD FILE      */ 00128000
*                   IF DMCBRRL=F0C THEN/* IS THIS FILE ELIGIBLE FOR     00129000
*                                      RELATIVE RECORD ACCESS.     0038 00130000
*                                      DMCBRRL = 0 INDICATES THAT IT    00131000
*                                      IS NOT                        */ 00132000
         C     @10,DMCBRRL(,DMCBPTR)                               0038 00133000
         BNE   @RF00038                                            0038 00134000
*                     DO;           /* RELATIVE RECORD LENGTH ZERO   */ 00135000
*                       DMCBRTC=INVRQ;/* REJECT THE REQUEST          */ 00136000
         MVC   DMCBRTC(4,DMCBPTR),@CF00037                         0040 00137000
*                       DMCBREJ=F2C;/* INDICATE INELIGIBILITY FOR  0041 00138000
*                                      RELATIVE RECORD ACCESS        */ 00139000
         MVI   DMCBREJ(DMCBPTR),X'02'                              0041 00140000
*                     END;          /* RELATIVE RECORD LENGTH ZERO   */ 00141000
*                   IF RELRECNO<=F0C THEN/* RECORD NUMBER OUT OF   0043 00142000
*                                      RANGE                         */ 00143000
@RF00038 L     @10,DMCBKEYP(,DMCBPTR)                              0043 00144000
         L     @10,RELRECNO(,@10)                                  0043 00145000
         LTR   @10,@10                                             0043 00146000
         BP    @RF00043                                            0043 00147000
*                     DO;           /* RECORD NUMBER OUT OF RANGE    */ 00148000
*                       DMCBRTC=INVRQ;/* REJECT THE REQUEST          */ 00149000
         MVC   DMCBRTC(4,DMCBPTR),@CF00037                         0045 00150000
*                       DMCBREJ=F4C;/* INDICATE THE REASON           */ 00151000
         MVI   DMCBREJ(DMCBPTR),X'04'                              0046 00152000
*                     END;          /* RECORD NUMBER OUT OF RANGE    */ 00153000
*                   IF DMCBRTC=F0C THEN/* TEST VALID REQUEST         */ 00154000
@RF00043 L     @10,DMCBRTC(,DMCBPTR)                               0048 00155000
         LTR   @10,@10                                             0048 00156000
         BNZ   @RF00048                                            0048 00157000
*                     DMCBRBA=(RELRECNO-F1C)*DMCBRRL;/* COMPUTE RBA     00158000
*                                      OF RECORD                     */ 00159000
         L     @10,DMCBKEYP(,DMCBPTR)                              0049 00160000
         L     @01,RELRECNO(,@10)                                  0049 00161000
         BCTR  @01,0                                               0049 00162000
         M     @00,DMCBRRL(,DMCBPTR)                               0049 00163000
         ST    @01,DMCBRBA(,DMCBPTR)                               0049 00164000
*                 END;              /* VSAM RELATIVE RECORD FILE     */ 00165000
*                                                                  0050 00166000
@RF00048 DS    0H                                                  0051 00167000
*               /*****************************************************/ 00168000
*               /*                                                   */ 00169000
*               /* PERFORM VSAM ERASE REQUEST                        */ 00170000
*               /*                                                   */ 00171000
*               /*****************************************************/ 00172000
*                                                                  0051 00173000
*               IF DMCBRTC=F0C THEN /* TEST VALID REQUEST            */ 00174000
@RF00036 L     @10,DMCBRTC(,DMCBPTR)                               0051 00175000
         LTR   @10,@10                                             0051 00176000
         BNZ   @RF00051                                            0051 00177000
*                 DO;               /* DO ERASE                      */ 00178000
*                   RFY                                            0053 00179000
*                    (GPR01P,                                      0053 00180000
*                     GPR15F) RSTD;                                0053 00181000
*                   GPR01P=ADDR(DMCBRPL);                          0054 00182000
         LA    GPR01P,DMCBRPL(,DMCBPTR)                            0054 00183000
*                   GEN REFS(GPR01P) SETS(GPR15F)(ERASE RPL=(GPR01F));  00184000
         ERASE RPL=(GPR01F)                                             00185000
*                   DMCBSUBC=GPR15F;                               0056 00186000
         ST    GPR15F,DMCBSUBC(,DMCBPTR)                           0056 00187000
*                   RFY                                            0057 00188000
*                    (GPR01P,                                      0057 00189000
*                     GPR15F) UNRSTD;                              0057 00190000
*                   IF DMCBSUBC=F8C THEN/* IF A LOGICAL ERROR        */ 00191000
         L     @10,DMCBSUBC(,DMCBPTR)                              0058 00192000
         CL    @10,@CF00044                                        0058 00193000
         BNE   @RF00058                                            0058 00194000
*                     CALL VSMLERR; /* THEN ANALYSE THE FDBK FIELD IN   00195000
*                                      THE RPL                       */ 00196000
         BAL   @14,VSMLERR                                         0059 00197000
*                   ELSE                                           0060 00198000
*                     DO;           /* NOT LOGICAL ERROR             */ 00199000
         B     @RC00058                                            0060 00200000
@RF00058 DS    0H                                                  0061 00201000
*                       IF DMCBSUBC=F12C THEN/* ELSE IF A PHYSICAL 0061 00202000
*                                      ERROR                         */ 00203000
         LA    @10,12                                              0061 00204000
         CL    @10,DMCBSUBC(,DMCBPTR)                              0061 00205000
         BNE   @RF00061                                            0061 00206000
*                         DMCBRTC=PERMER;/* THEN REPORT IN RETURN  0062 00207000
*                                      CODE                          */ 00208000
         ST    @10,DMCBRTC(,DMCBPTR)                               0062 00209000
*                     END;          /* NOT LOGICAL ERROR             */ 00210000
@RF00061 DS    0H                                                  0064 00211000
*                 END;              /* DO ERASE                      */ 00212000
@RC00058 DS    0H                                                  0065 00213000
*             END;                  /* SET IS OK                     */ 00214000
@RF00051 DS    0H                                                  0066 00215000
*         END;                      /* VSAM FILE                     */ 00216000
@RF00034 DS    0H                                                  0067 00217000
*     END;                          /* DMCB IS OPEN                  */ 00218000
@RC00024 DS    0H                                                  0068 00219000
*   IF DMCBRTC^=F0C THEN            /* TEST FOR ERROR                */ 00220000
@RC00017 L     @10,DMCBRTC(,DMCBPTR)                               0068 00221000
         LTR   @10,@10                                             0068 00222000
         BZ    @RF00068                                            0068 00223000
*     DMCBMODN=MODNAME;             /* SUPPLY MODULE NAME TO ERROR 0069 00224000
*                                      MESSAGE                       */ 00225000
         MVC   DMCBMODN(8,DMCBPTR),MODNAME                         0069 00226000
*   RETURN;                                                        0070 00227000
@EL00001 L     @13,4(,@13)                                         0070 00228000
@EF00001 L     @00,@SIZDATD                                        0070 00229000
         LR    @01,@11                                             0070 00230000
         BLSCFRES R,LV=(0),A=(1)                                        00231000
@ER00001 LM    @14,@12,12(@13)                                     0070 00232000
         BR    @14                                                 0070 00233000
         EJECT                                                          00234000
*VSMLERR:                                                          0071 00235000
*   PROCEDURE;                                                     0071 00236000
*                                                                  0071 00237000
         B     @EL00001                                            0071 00238000
VSMLERR  STM   @14,@12,@SA00002                                    0071 00239000
*   /*****************************************************************/ 00240000
*   /*                                                               */ 00241000
*   /* THIS ROUTINE IS ENTERED IF A VSAM LOGICAL ERROR OCCURS IT     */ 00242000
*   /* EXTRACTS THE FEEDBACK FIELD FROM THE REQUEST PARAMETER LIST   */ 00243000
*   /* AND DETERMINES THE PROPER RETURN CODE. CERTAIN LOGICAL ERRORS */ 00244000
*   /* WHICH SHOULD NOT OCCUR MAY INDICATE THAT THE DATA MANAGER IS  */ 00245000
*   /* WORKING IMPROPERLY. IF THESE OCCUR THEN AN ABEND WILL BE      */ 00246000
*   /* ISSUED.                                                       */ 00247000
*   /*                                                               */ 00248000
*   /*****************************************************************/ 00249000
*                                                                  0072 00250000
*   RFY                                                            0072 00251000
*    (GPR02P,                                                      0072 00252000
*     GPR03P,                                                      0072 00253000
*     GPR08P,                                                      0072 00254000
*     GPR15F) RSTD;                                                0072 00255000
*   GPR08P=ADDR(DMCBRPL);           /* ADDRESS RPL FOR SHOWCB MACRO  */ 00256000
         LA    GPR08P,DMCBRPL(,DMCBPTR)                            0073 00257000
*   GPR02P=ADDR(SHWLIST);           /* POINT TO SHOW PARAMETER LIST  */ 00258000
         LA    GPR02P,SHWLIST                                      0074 00259000
*   GPR03P=ADDR(DMCBRPLF);          /* ADDRESS FEEDBACK FIELD        */ 00260000
         LA    GPR03P,DMCBRPLF(,DMCBPTR)                           0075 00261000
*   GEN SETS(SHWLIST,DMCBRPLF,GPR15F) REFS(GPR02P,GPR03P,GPR08P);  0076 00262000
         SHOWCB RPL=(GPR08P),AREA=(GPR03P),LENGTH=4,                   *00263000
               FIELDS=(FDBK),MF=(G,(GPR02P))                            00264000
*   SUBCODE=GPR15F;                                                0077 00265000
         ST    GPR15F,SUBCODE                                      0077 00266000
*   RFY                                                            0078 00267000
*    (GPR08P,                                                      0078 00268000
*     GPR02P,                                                      0078 00269000
*     GPR03P,                                                      0078 00270000
*     GPR15F) UNRSTD;                                              0078 00271000
*   IF SUBCODE^=F0C THEN            /* IF SHOW WAS UNSUCCESSFUL      */ 00272000
         L     @10,SUBCODE                                         0079 00273000
         LTR   @10,@10                                             0079 00274000
         BZ    @RF00079                                            0079 00275000
*     DO;                           /* ABEND(F139C) DUMP             */ 00276000
*       RESPECIFY                                                  0081 00277000
*        (GPR01F) RESTRICTED;                                      0081 00278000
*       GPR01F=F139C;               /* COMP CODE IN REG 1            */ 00279000
         LA    GPR01F,139                                          0082 00280000
*       GPR01F=GPR01F|'80000000'X;  /* DUMP/STEP/DUMPOPTS FLAG       */ 00281000
         O     GPR01F,@CF00252                                     0083 00282000
*       SVC(13);                    /* ISSUE ABEND SVC               */ 00283000
         SVC   13                                                  0084 00284000
*       RESPECIFY                                                  0085 00285000
*        (GPR01F) UNRESTRICTED;                                    0085 00286000
*     END;                          /* ABEND(F139C) DUMP SHOWCB ERROR*/ 00287000
*   IF DMCBRPLF=F8C                 /* DUPLICATE KEY                 */ 00288000
*       |DMCBRPLF=F92C THEN         /* ERASE W/O PRECEDING GET       */ 00289000
@RF00079 L     @10,DMCBRPLF(,DMCBPTR)                              0087 00290000
         CL    @10,@CF00044                                        0087 00291000
         BE    @RT00087                                            0087 00292000
         CL    @10,@CF00228                                        0087 00293000
         BNE   @RF00087                                            0087 00294000
@RT00087 DS    0H                                                  0088 00295000
*     DMCBRTC=NOUPD;                /* INDICATE DUPLICATE RECORD     */ 00296000
         MVC   DMCBRTC(4,DMCBPTR),@CF00044                         0088 00297000
*   ELSE                                                           0089 00298000
*     DO;                           /* PROBABLE INVALID REQUEST      */ 00299000
         B     @RC00087                                            0089 00300000
@RF00087 DS    0H                                                  0090 00301000
*       DMCBRTC=INVRQ;              /* PROBABLY INVALID REQUEST      */ 00302000
         MVC   DMCBRTC(4,DMCBPTR),@CF00037                         0090 00303000
*       IF DMCBRPLF=F32C THEN       /* INVALID RBA                   */ 00304000
         CLC   DMCBRPLF(4,DMCBPTR),@CF00084                        0091 00305000
         BNE   @RF00091                                            0091 00306000
*         DMCBREJ=F4C;              /* RELATIVE RECORD ERROR         */ 00307000
         MVI   DMCBREJ(DMCBPTR),X'04'                              0092 00308000
*       ELSE                                                       0093 00309000
*         IF DMCBRPLF=F72C THEN     /* WRONG ACCESS MODE             */ 00310000
         B     @RC00091                                            0093 00311000
@RF00091 CLC   DMCBRPLF(4,DMCBPTR),@CF00224                        0093 00312000
         BNE   @RF00093                                            0093 00313000
*           DMCBREJ=F2C;            /* ACCESS TYPE UNSUPPORTED       */ 00314000
         MVI   DMCBREJ(DMCBPTR),X'02'                              0094 00315000
*         ELSE                                                     0095 00316000
*           IF DMCBRPLF=F88C THEN   /* POSITIONING ERROR             */ 00317000
         B     @RC00093                                            0095 00318000
@RF00093 CLC   DMCBRPLF(4,DMCBPTR),@CF00226                        0095 00319000
         BNE   @RF00095                                            0095 00320000
*             DMCBREJ=F5C;                                         0096 00321000
         MVI   DMCBREJ(DMCBPTR),X'05'                              0096 00322000
*           ELSE                                                   0097 00323000
*             IF DMCBRPLF=F112C THEN/* INVALID KEY LENGTH            */ 00324000
         B     @RC00095                                            0097 00325000
@RF00095 CLC   DMCBRPLF(4,DMCBPTR),@CF00230                        0097 00326000
         BNE   @RF00097                                            0097 00327000
*               DMCBREJ=F9C;                                       0098 00328000
         MVI   DMCBREJ(DMCBPTR),X'09'                              0098 00329000
*             ELSE                                                 0099 00330000
*               DMCBREJ=F255C;      /* SEVERE ERROR EITHER VSAM OR 0099 00331000
*                                      DATA MANAGER ERROR            */ 00332000
         B     @RC00097                                            0099 00333000
@RF00097 MVI   DMCBREJ(DMCBPTR),X'FF'                              0099 00334000
*     END;                          /* PROBABLE INVALID REQUEST      */ 00335000
*   END VSMLERR;                                                   0101 00336000
@EL00002 DS    0H                                                  0101 00337000
@EF00002 DS    0H                                                  0101 00338000
@ER00002 LM    @14,@12,@SA00002                                    0101 00339000
         BR    @14                                                 0101 00340000
         EJECT                                                          00341000
*                                                                  0102 00342000
*   /*****************************************************************/ 00343000
*   /*                                                               */ 00344000
*   /* END OF EXECUTABLE PROCEDURE STATEMENTS                        */ 00345000
*   /*                                                               */ 00346000
*   /*****************************************************************/ 00347000
*                                                                  0102 00348000
*   DECLARE                         /* GENERAL PURPOSE REGISTERS     */ 00349000
*     GPR01F FIXED(31) REG(1),                                     0102 00350000
*     GPR15F FIXED(31) REG(15),                                    0102 00351000
*     GPR01P PTR(31) REG(1),                                       0102 00352000
*     GPR02P PTR(31) REG(2),                                       0102 00353000
*     GPR03P PTR(31) REG(3),                                       0102 00354000
*     GPR08P PTR(31) REG(8);                                       0102 00355000
*   DECLARE                         /* COMMON VARIABLES              */ 00356000
*     I256C CHAR(256) BASED,                                       0103 00357000
*     I031F FIXED(31) BASED,                                       0103 00358000
*     I031P PTR(31) BASED,                                         0103 00359000
*     I015F FIXED(15) BASED,                                       0103 00360000
*     I015P PTR(15) BASED,                                         0103 00361000
*     I008P PTR(8) BASED,                                          0103 00362000
*     I001C CHAR(1) BASED;                                         0103 00363000
*   DCL                                                            0104 00364000
*     1 DASPATCH LOCAL BDY(DWORD),  /* PATCH AREA                    */ 00365000
*      2 DASPATA(DASPATLN) PTR INIT((DASPATLN)0);                  0104 00366000
*   END BLSCERSE;                                                  0105 00367000
@DATA    DS    0H                                                       00368000
@DATD    DSECT                                                          00369000
         DS    0F                                                       00370000
@SA00001 DS    18F                                                      00371000
@SA00002 DS    15F                                                      00372000
BLSCERSE CSECT                                                          00373000
         DS    0F                                                       00374000
@CF00037 DC    F'4'                                                     00375000
@CF00044 DC    F'8'                                                     00376000
@CF00084 DC    F'32'                                                    00377000
@CF00224 DC    F'72'                                                    00378000
@CF00226 DC    F'88'                                                    00379000
@CF00228 DC    F'92'                                                    00380000
@CF00230 DC    F'112'                                                   00381000
@CF00252 DC    XL4'80000000'                                            00382000
@DATD    DSECT                                                          00383000
         DS    0D                                                       00384000
MODSTAT  DS    CL12                                                     00385000
         ORG   MODSTAT                                                  00386000
MODNAME  DS    CL8                                                      00387000
SUBCODE  DS    FL4                                                      00388000
         ORG   MODSTAT+12                                               00389000
         DS    CL4                                                      00390000
SHWLIST  DS    CL28                                                     00391000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                00392000
@ENDDATD EQU   *                                                        00393000
BLSCERSE CSECT                                                          00394000
         DS    0F                                                       00395000
@SIZDATD DC    AL1(0)                                                   00396000
         DC    AL3(@ENDDATD-@DATD)                                      00397000
@CV00198 DC    V(BLSCSETT)                                              00398000
         DS    0D                                                       00399000
@CC00240 DC    C'BLSCERSE'                                              00400000
DASPATCH DS    CL80                                                     00401000
         ORG   DASPATCH                                                 00402000
DASPATA  DC    20A(0)                                                   00403000
         ORG   DASPATCH+80                                              00404000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00405000
@01      EQU   01                                                       00406000
@02      EQU   02                                                       00407000
@03      EQU   03                                                       00408000
@04      EQU   04                                                       00409000
@05      EQU   05                                                       00410000
@06      EQU   06                                                       00411000
@07      EQU   07                                                       00412000
@08      EQU   08                                                       00413000
@09      EQU   09                                                       00414000
@10      EQU   10                                                       00415000
@11      EQU   11                                                       00416000
@12      EQU   12                                                       00417000
@13      EQU   13                                                       00418000
@14      EQU   14                                                       00419000
@15      EQU   15                                                       00420000
DMCBPTR  EQU   @05                                                      00421000
GPR01P   EQU   @01                                                      00422000
GPR15F   EQU   @15                                                      00423000
GPR02P   EQU   @02                                                      00424000
GPR03P   EQU   @03                                                      00425000
GPR08P   EQU   @08                                                      00426000
GPR01F   EQU   @01                                                      00427000
DMCB     EQU   0                                                        00428000
DMCBRTC  EQU   DMCB+12                                                  00429000
DMCBFTY  EQU   DMCB+20                                                  00430000
DMCBVSF  EQU   DMCBFTY                                                  00431000
DMCBOPN  EQU   DMCB+21                                                  00432000
DMCBSOUT EQU   DMCBOPN                                                  00433000
DMCBRMOD EQU   DMCB+23                                                  00434000
DMCBOUT  EQU   DMCBRMOD                                                 00435000
DMCBOPTS EQU   DMCB+24                                                  00436000
DMCBKYD  EQU   DMCBOPTS                                                 00437000
DMCBGKY  EQU   DMCBOPTS                                                 00438000
DMCBRNO  EQU   DMCBGKY                                                  00439000
DMCBMFLG EQU   DMCB+28                                                  00440000
DMCBFMOD EQU   DMCBMFLG                                                 00441000
DMCBREJ  EQU   DMCB+29                                                  00442000
DMCBBUFP EQU   DMCB+32                                                  00443000
DMCBKEYP EQU   DMCB+44                                                  00444000
DMCBRBA  EQU   DMCB+56                                                  00445000
DMCBRRL  EQU   DMCB+60                                                  00446000
DMCBFRE  EQU   DMCB+88                                                  00447000
DMCBEOB  EQU   DMCB+92                                                  00448000
DMCBACBE EQU   DMCB+124                                                 00449000
DMCBRPLF EQU   DMCB+128                                                 00450000
DMCBSPEC EQU   DMCB+380                                                 00451000
DMCBSUBC EQU   DMCB+404                                                 00452000
DMCBAMS  EQU   DMCB+416                                                 00453000
DMCBAUDT EQU   DMCB+568                                                 00454000
DMCBLSCP EQU   DMCBAUDT+16                                              00455000
DMCBMODN EQU   DMCB+632                                                 00456000
RELRECNO EQU   0                                                        00457000
DMCBRQC  EQU   0                                                        00458000
I001C    EQU   0                                                        00459000
I008P    EQU   0                                                        00460000
I015F    EQU   0                                                        00461000
I015P    EQU   0                                                        00462000
I031F    EQU   0                                                        00463000
I031P    EQU   0                                                        00464000
I256C    EQU   0                                                        00465000
DMCBVSM  EQU   DMCBAMS                                                  00466000
DMCBRPL  EQU   DMCBVSM                                                  00467000
DMCBQSM  EQU   DMCBAMS                                                  00468000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    00469000
DMCBRES7 EQU   DMCBQSM+96                                               00470000
DMCBDCB  EQU   DMCBQSM                                                  00471000
DMCBACB  EQU   DMCBVSM+76                                               00472000
DMCBWRK  EQU   DMCB+648                                                 00473000
DMCBRES8 EQU   DMCB+640                                                 00474000
DMCBCARY EQU   DMCBAUDT+20                                              00475000
DMCBCLC  EQU   DMCBAUDT+12                                              00476000
DMCBOPC  EQU   DMCBAUDT+8                                               00477000
DMCBFRC  EQU   DMCBAUDT+4                                               00478000
DMCBALC  EQU   DMCBAUDT                                                 00479000
DMCBFR   EQU   DMCB+412                                                 00480000
DMCBRES6 EQU   DMCB+410                                                 00481000
DMCBIRSC EQU   DMCB+408                                                 00482000
DMCBDRBP EQU   DMCB+400                                                 00483000
DMCBRSZM EQU   DMCB+398                                                 00484000
DMCBRSZA EQU   DMCB+396                                                 00485000
DMCBCISZ EQU   DMCB+394                                                 00486000
DMCBDCBL EQU   DMCB+392                                                 00487000
DMCBDCLR EQU   DMCB+390                                                 00488000
DMCBDCFM EQU   DMCB+389                                                 00489000
DMCBRES5 EQU   DMCB+388                                                 00490000
DMCBLBRT EQU   DMCB+386                                                 00491000
DMCBLBSQ EQU   DMCB+384                                                 00492000
DMCBLBPS EQU   DMCB+383                                                 00493000
DMCBLBTY EQU   DMCB+382                                                 00494000
DMCBRES4 EQU   DMCB+381                                                 00495000
DMCBSPRS EQU   DMCBSPEC                                                 00496000
DMCBSPRN EQU   DMCBSPEC                                                 00497000
DMCBSPCT EQU   DMCBSPEC                                                 00498000
DMCBSPRL EQU   DMCBSPEC                                                 00499000
DMCBSPSE EQU   DMCB+376                                                 00500000
DMCBSPPR EQU   DMCB+372                                                 00501000
DMCBSPTY EQU   DMCB+369                                                 00502000
DMCBODIS EQU   DMCB+368                                                 00503000
DMCBDISP EQU   DMCB+367                                                 00504000
DMCBSTAT EQU   DMCB+366                                                 00505000
DMCBRES3 EQU   DMCB+364                                                 00506000
DMCBMEMB EQU   DMCB+356                                                 00507000
DMCBMODL EQU   DMCB+348                                                 00508000
DMCBRES9 EQU   DMCB+340                                                 00509000
DMCBPID  EQU   DMCB+332                                                 00510000
DMCBTYPE EQU   DMCB+328                                                 00511000
DMCBDSN  EQU   DMCB+284                                                 00512000
DMCBUNIT EQU   DMCB+276                                                 00513000
DMCBDSOR EQU   DMCB+274                                                 00514000
DMCBVOL  EQU   DMCB+268                                                 00515000
DMCBDDNM EQU   DMCB+260                                                 00516000
DMCBSYNM EQU   DMCB+132                                                 00517000
DMCBDCBE EQU   DMCBACBE                                                 00518000
DMCBARC  EQU   DMCB+120                                                 00519000
DMCBCPC  EQU   DMCB+116                                                 00520000
DMCBRET  EQU   DMCB+112                                                 00521000
DMCBSTL  EQU   DMCB+96                                                  00522000
DMCBRES2 EQU   DMCB+85                                                  00523000
DMCBSPID EQU   DMCB+84                                                  00524000
DMCBRESC EQU   DMCB+80                                                  00525000
DMCBZZ1P EQU   DMCB+76                                                  00526000
DMCBMSGS EQU   DMCB+72                                                  00527000
DMCBMSG0 EQU   DMCB+68                                                  00528000
DMCBRI   EQU   DMCB+64                                                  00529000
DMCBMSG  EQU   DMCB+52                                                  00530000
DMCBKEYL EQU   DMCB+48                                                  00531000
DMCBKPC  EQU   DMCBKEYP                                                 00532000
DMCBORL  EQU   DMCB+40                                                  00533000
DMCBBLEN EQU   DMCB+36                                                  00534000
DMCBBFPC EQU   DMCBBUFP                                                 00535000
DMCBRES1 EQU   DMCB+31                                                  00536000
DMCBACCM EQU   DMCB+30                                                  00537000
DMCBRESB EQU   DMCBMFLG                                                 00538000
DMCBLOPT EQU   DMCB+27                                                  00539000
DMCBLRM  EQU   DMCB+26                                                  00540000
DMCBLRQ  EQU   DMCB+25                                                  00541000
DMCBOPRS EQU   DMCBOPTS                                                 00542000
DMCBLRD  EQU   DMCBOPTS                                                 00543000
DMCBBWD  EQU   DMCBOPTS                                                 00544000
DMCBUPD  EQU   DMCBOPTS                                                 00545000
DMCBAPX  EQU   DMCBOPTS                                                 00546000
DMCBRMRS EQU   DMCBRMOD                                                 00547000
DMCBRM5  EQU   DMCBRMOD                                                 00548000
DMCBRM6  EQU   DMCBRMOD                                                 00549000
DMCBTMP  EQU   DMCBOUT                                                  00550000
DMCBRQST EQU   DMCB+22                                                  00551000
DMCBRESA EQU   DMCBOPN                                                  00552000
DMCBSIN  EQU   DMCBOPN                                                  00553000
DMCBKSF  EQU   DMCBFTY                                                  00554000
DMCBFTRS EQU   DMCBFTY                                                  00555000
DMCBSHF  EQU   DMCBFTY                                                  00556000
DMCBIRL  EQU   DMCB+16                                                  00557000
DMCBTVP  EQU   DMCB+8                                                   00558000
DMCBNEXT EQU   DMCB+4                                                   00559000
DMCBID   EQU   DMCB                                                     00560000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      00561000
@RF00068 EQU   @EL00001                                                 00562000
@RC00087 EQU   @EL00002                                                 00563000
@RC00097 EQU   @EL00002                                                 00564000
@RC00095 EQU   @EL00002                                                 00565000
@RC00093 EQU   @EL00002                                                 00566000
@RC00091 EQU   @EL00002                                                 00567000
@ENDDATA EQU   *                                                        00568000
         END   BLSCERSE,(C'PLS1907',0701,78062)                         00569000
