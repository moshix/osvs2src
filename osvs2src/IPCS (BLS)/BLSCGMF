         TITLE 'EP=BLSCGMF -- IPCS DAS BUILD GETMAIN FAIL MESSAGE      *00001000
                        '                                               00002000
*     /* CHANGE ACTIVITY                                                00003000
*    THIS MODULE IS WRITTEN FOR @G57LPSR                                00004000
BLSCGMF  CSECT ,                                                   0002 00005000
@MAINENT DS    0H                                                  0002 00006000
         USING *,@15                                               0002 00007000
         B     @PROLOG                                             0002 00008000
         DC    AL1(16)                                             0002 00009000
         DC    C'BLSCGMF   78.062'                                 0002 00010000
         DROP  @15                                                      00011000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00012000
         BALR  @12,0                                               0002 00013000
@PSTART  DS    0H                                                  0002 00014000
         USING @PSTART,@12                                         0002 00015000
         L     @00,@SIZDATD                                        0002 00016000
         BLSCGETF R,LV=(0)                                              00017000
         LR    @11,@01                                             0002 00018000
         USING @DATD,@11                                           0002 00019000
         ST    @13,@SA00001+4                                      0002 00020000
         LM    @00,@01,20(@13)                                     0002 00021000
         ST    @11,8(,@13)                                         0002 00022000
         LR    @13,@11                                             0002 00023000
         MVC   @PC00001(12),0(@01)                                 0002 00024000
         EJECT                                                          00025000
*                                                                  0025 00026000
*   /*****************************************************************/ 00027000
*   /*                                                               */ 00028000
*   /* INITIALIZE MODULE STATUS                                      */ 00029000
*   /*                                                               */ 00030000
*   /*****************************************************************/ 00031000
*                                                                  0025 00032000
*   DMCBPTR=ADDR(DMCBPARM);         /* BASE THE DMCB                 */ 00033000
         L     DMCBPTR,@PC00001                                    0025 00034000
*   MODNAME=LMODNMC;                /* INIT THE MODULE NAME          */ 00035000
         MVC   MODNAME(8),@CC00258                                 0026 00036000
*   RETCODE=F0C;                    /* INIT THE MODULE RETURN CODE   */ 00037000
         SLR   @10,@10                                             0027 00038000
         ST    @10,RETCODE                                         0027 00039000
*   RCODE=F0C;                      /* INIT THE ABEND REASON CODE    */ 00040000
*                                                                  0028 00041000
         ST    @10,RCODE                                           0028 00042000
*   /*****************************************************************/ 00043000
*   /*                                                               */ 00044000
*   /* BUILD GETMAIN FAIL MESSAGE                                    */ 00045000
*   /*                                                               */ 00046000
*   /*****************************************************************/ 00047000
*                                                                  0029 00048000
*   RFY                                                            0029 00049000
*     MSGDENT BASED(MSGDPTR);       /* BASE THE GETMAIN FAIL MSG MAP */ 00050000
*   CALL LOCMSGSK;                  /* FIND THE GETMAIN FAIL MSG TXT */ 00051000
         BAL   @14,LOCMSGSK                                        0030 00052000
*   IF RCODE^=F0C THEN              /* TEST FOR BAD MESSAGE SKELETON */ 00053000
         L     @10,RCODE                                           0031 00054000
         LTR   @10,@10                                             0031 00055000
         BZ    @RF00031                                            0031 00056000
*     DO;                           /* BAD MESSAGE SKELETON - ABEND  */ 00057000
*       RFY                                                        0033 00058000
*         GPR15F RSTD;                                             0033 00059000
*       GPR15F=RCODE;               /* SET ABEND REASON CODE         */ 00060000
         LR    GPR15F,@10                                          0034 00061000
*       RFY                                                        0035 00062000
*         GPR15F UNRSTD;                                           0035 00063000
*       DO;                         /* ABEND(GMFAC) DUMP USER        */ 00064000
*         RESPECIFY                                                0037 00065000
*          (GPR01F) RESTRICTED;                                    0037 00066000
*         GPR01F=(GMFAC)&'00000FFF'X;/* COMP CODE IN BITS 20-31      */ 00067000
         LA    GPR01F,103                                          0038 00068000
*         GPR01F=GPR01F|'80000000'X;/* DUMP/STEP/DUMPOPTS FLAG       */ 00069000
         O     GPR01F,@CF00286                                     0039 00070000
*         SVC(13);                  /* ISSUE ABEND SVC               */ 00071000
         SVC   13                                                  0040 00072000
*         RESPECIFY                                                0041 00073000
*          (GPR01F) UNRESTRICTED;                                  0041 00074000
*       END;                        /* ABEND(GMFAC) DUMP USER UNABLE    00075000
*                                      TO ISSUE GETMAIN FAIL MESSAGE */ 00076000
*     END;                          /* BAD MESSAGE SKELETON - ABEND  */ 00077000
*   MSGDLN=(MSGSKL+LENGTH(MODNMPAR)+LENGTH(MSGDENT)+F7C)&XDWBDYC;/*     00078000
*                                      MESSAGE LENGTH ROUNDED UP TO A   00079000
*                                      DOUBLE WORD BOUNDARY          */ 00080000
@RF00031 LA    MSGDLN,31                                           0044 00081000
         SLR   @10,@10                                             0044 00082000
         IC    @10,MSGSKL(,MSGSKA)                                 0044 00083000
         ALR   MSGDLN,@10                                          0044 00084000
         N     MSGDLN,@CF00260                                     0044 00085000
*   MSGDPTR=DMCBEOB-MSGDLN;         /* GET SPACE FROM DATA MANAGER 0045 00086000
*                                      FREE BLOCK                    */ 00087000
         L     @10,DMCBEOB(,DMCBPTR)                               0045 00088000
         SLR   @10,MSGDLN                                          0045 00089000
         ST    @10,MSGDPTR                                         0045 00090000
*   IF MSGDPTR<DMCBFRE THEN         /* TEST FOR STORAGE AVAILABLE    */ 00091000
         CL    @10,DMCBFRE(,DMCBPTR)                               0046 00092000
         BNL   @RF00046                                            0046 00093000
*     DO;                           /* NO STORAGE AVAILABLE - ABEND  */ 00094000
*       RFY                                                        0048 00095000
*         GPR15F RSTD;                                             0048 00096000
*       GPR15F=NSTOR;               /* SET ABEND REASON CODE         */ 00097000
         LA    GPR15F,60                                           0049 00098000
*       RFY                                                        0050 00099000
*         GPR15F UNRSTD;                                           0050 00100000
*       DO;                         /* ABEND(GMFAC) DUMP USER        */ 00101000
*         RESPECIFY                                                0052 00102000
*          (GPR01F) RESTRICTED;                                    0052 00103000
*         GPR01F=(GMFAC)&'00000FFF'X;/* COMP CODE IN BITS 20-31      */ 00104000
         LA    GPR01F,103                                          0053 00105000
*         GPR01F=GPR01F|'80000000'X;/* DUMP/STEP/DUMPOPTS FLAG       */ 00106000
         O     GPR01F,@CF00286                                     0054 00107000
*         SVC(13);                  /* ISSUE ABEND SVC               */ 00108000
         SVC   13                                                  0055 00109000
*         RESPECIFY                                                0056 00110000
*          (GPR01F) UNRESTRICTED;                                  0056 00111000
*       END;                        /* ABEND(GMFAC) DUMP USER UNABLE    00112000
*                                      TO ISSUE GETMAIN FAIL MESSAGE */ 00113000
*     END;                          /* NO STORAGE AVAILABLE - ABEND  */ 00114000
*   DMCBEOB=MSGDPTR;                /* MARK STORAGE TAKEN            */ 00115000
@RF00046 L     @10,MSGDPTR                                         0059 00116000
         ST    @10,DMCBEOB(,DMCBPTR)                               0059 00117000
*   MSGDSPID=DMCBSPID;              /* SUBPOOL ID FOR FREEMAIN       */ 00118000
         IC    @02,DMCBSPID(,DMCBPTR)                              0060 00119000
         STC   @02,MSGDSPID(,@10)                                  0060 00120000
*   MSGDFLEN=MSGDLN;                /* FREEMAIN LENGTH               */ 00121000
         STCM  MSGDLN,7,MSGDFLEN(@10)                              0061 00122000
*   MSGDBAK=MSGDPTR;                /* MESSAGE BACK CHAIN            */ 00123000
         ST    @10,MSGDBAK(,@10)                                   0062 00124000
*   MSGDNXT=F0C;                    /* INIT CHAIN ADDRESS            */ 00125000
         SLR   @04,@04                                             0063 00126000
         ST    @04,MSGDNXT(,@10)                                   0063 00127000
*   MSGDLEN=MSGSKL+LENGTH(MODNMPAR)+LENGTH(MSGDMOV);/* SET MSG LEN   */ 00128000
         SLR   @02,@02                                             0064 00129000
         IC    @02,MSGSKL(,MSGSKA)                                 0064 00130000
         LA    @15,12                                              0064 00131000
         ALR   @15,@02                                             0064 00132000
         STH   @15,MSGDLEN(,@10)                                   0064 00133000
*   MSGDPAD=F0C;                    /* ZERO THE PAD                  */ 00134000
         STH   @04,MSGDPAD(,@10)                                   0065 00135000
*   MSGDTXT(F1C:MSGSKL)=MSGSKT(F1C:MSGSKL);/* MOVE IN MSG TEXT       */ 00136000
         LR    @04,@02                                             0066 00137000
         BCTR  @04,0                                               0066 00138000
         EX    @04,@SM00305                                        0066 00139000
*   MSGDTXT(MSGSKL+F1C:MSGSKL+LENGTH(MODNMPAR))=MODNMPAR;/* APPEND 0067 00140000
*                                      MODULE NAME                   */ 00141000
         ALR   @02,@10                                             0067 00142000
         L     @04,@PC00001+8                                      0067 00143000
         MVC   MSGDTXT(8,@02),MODNMPAR(@04)                        0067 00144000
*   MSGDPTR=MSGDPTR+LENGTH(MSGDPRF);/* BUMP MESSAGE BASE FOR HOOK    */ 00145000
         AL    @10,@CF00041                                        0068 00146000
         ST    @10,MSGDPTR                                         0068 00147000
*   CALL BLSCHOK(DMCB,MSGANCHR,MSGDPTR);/* HOOK GETMAIN FAIL MESSAGE    00148000
*                                      TO MESSAGE CHAIN OR ANCHOR    */ 00149000
         ST    DMCBPTR,@AL00001                                    0069 00150000
         L     @10,@PC00001+4                                      0069 00151000
         ST    @10,@AL00001+4                                      0069 00152000
         LA    @10,MSGDPTR                                         0069 00153000
         ST    @10,@AL00001+8                                      0069 00154000
         L     @15,@CV00224                                        0069 00155000
         LA    @01,@AL00001                                        0069 00156000
         BALR  @14,@15                                             0069 00157000
*   RETURN CODE(RETCODE);                                          0070 00158000
         L     @10,RETCODE                                         0070 00159000
         L     @13,4(,@13)                                         0070 00160000
         L     @00,@SIZDATD                                        0070 00161000
         LR    @01,@11                                             0070 00162000
         BLSCFREF R,LV=(0),A=(1)                                        00163000
         LR    @15,@10                                             0070 00164000
         L     @14,12(,@13)                                        0070 00165000
         LM    @00,@12,20(@13)                                     0070 00166000
         BR    @14                                                 0070 00167000
         EJECT                                                          00168000
*                                                                  0071 00169000
*   /*****************************************************************/ 00170000
*   /*                                                               */ 00171000
*   /* LOCATE THE MESSAGE SKELETON IN THE MESSAGE CSECT GIVEN THE    */ 00172000
*   /* MESSAGE NUMBER AS THE KEY. --NOTE-- THE STRUCTURE OF THE      */ 00173000
*   /* MESSAGE CSECT IS DESCRIBED IN THE PROLOG OF THE BLSDMSGG      */ 00174000
*   /* MACRO.                                                        */ 00175000
*   /*                                                               */ 00176000
*   /*****************************************************************/ 00177000
*                                                                  0071 00178000
*LOCMSGSK:                                                         0071 00179000
*   PROCEDURE;                                                     0071 00180000
@EL00001 L     @13,4(,@13)                                         0071 00181000
@EF00001 L     @00,@SIZDATD                                        0071 00182000
         LR    @01,@11                                             0071 00183000
         BLSCFREF R,LV=(0),A=(1)                                        00184000
@ER00001 LM    @14,@12,12(@13)                                     0071 00185000
         BR    @14                                                 0071 00186000
LOCMSGSK STM   @14,@02,12(@13)                                     0071 00187000
         STM   @04,@12,36(@13)                                     0071 00188000
*   SCTPTR=F0C;                     /* INIT POINTERS                 */ 00189000
         SLR   SCTPTR,SCTPTR                                       0072 00190000
*   SSCTPTR=F0C;                                                   0073 00191000
         SLR   SSCTPTR,SSCTPTR                                     0073 00192000
*   MSGSKA=F0C;                                                    0074 00193000
         SLR   MSGSKA,MSGSKA                                       0074 00194000
*   TEMP=MSGNO/COMPC;               /* ISOLATE THE COMPONENT CROSS 0075 00195000
*                                      REFERENCE TABLE INDEX         */ 00196000
         LA    TEMP,3                                              0075 00197000
*   IF TEMP>NCCRIT                  /* IF THIS INDEX IS GREATER THAN    00198000
*                                      THE NUMBER OF ENTRIES IN THE     00199000
*                                      TABLE, THEN SET THE REASON  0076 00200000
*                                      CODE.                         */ 00201000
*     THEN                                                         0076 00202000
         L     @10,DMCBMSGS(,DMCBPTR)                              0076 00203000
         L     @10,CCRITPTR(,@10)                                  0076 00204000
         C     TEMP,NCCRIT(,@10)                                   0076 00205000
         BNH   @RF00076                                            0076 00206000
*     RCODE=NCTE;                                                  0077 00207000
         MVC   RCODE(4),@CF00253                                   0077 00208000
*   ELSE                                                           0078 00209000
*     DO;                                                          0078 00210000
         B     @RC00076                                            0078 00211000
@RF00076 DS    0H                                                  0079 00212000
*       SCTPTR=SCTP(TEMP+F1C);      /* GET THE ADDRESS OF THE      0079 00213000
*                                      SUBCOMPONENT CROSS REFERENCE     00214000
*                                      TABLE.                        */ 00215000
         LR    @10,TEMP                                            0079 00216000
         SLA   @10,2                                               0079 00217000
         L     @04,DMCBMSGS(,DMCBPTR)                              0079 00218000
         L     @04,CCRITPTR(,@04)                                  0079 00219000
         L     SCTPTR,SCTP(@10,@04)                                0079 00220000
*       IF SCTPTR=F0C               /* IF THIS ADDRESS IS ZERO, THEN    00221000
*                                      THE NEEDED SUBCOMPONENT CROSS    00222000
*                                      REFERENCE TABLE DOES NOT    0080 00223000
*                                      EXIST. SET THE REASON CODE FOR   00224000
*                                      THIS SITUATION.               */ 00225000
*         THEN                                                     0080 00226000
         LTR   SCTPTR,SCTPTR                                       0080 00227000
         BNZ   @RF00080                                            0080 00228000
*         RCODE=ZCTE;                                              0081 00229000
         MVC   RCODE(4),@CF00210                                   0081 00230000
*     END;                                                         0082 00231000
@RF00080 DS    0H                                                  0083 00232000
*   IF RCODE=F0C                    /* IF NO ERROR HAS OCCURRED, THEN   00233000
*                                      ...                           */ 00234000
*     THEN                                                         0083 00235000
@RC00076 L     @10,RCODE                                           0083 00236000
         LTR   @10,@10                                             0083 00237000
         BNZ   @RF00083                                            0083 00238000
*     DO;                                                          0084 00239000
*       TEMP=MSGNO//COMPC;          /* ISOLATE THE SUBCOMPONENT CROSS   00240000
*                                      REFERENCE TABLE INDEX FROM THE   00241000
*                                      INPUT MESSAGE NUMBER (THE   0085 00242000
*                                      HUNDREDS DIGIT).              */ 00243000
         LA    TEMP,109                                            0085 00244000
*       TEMP1=TEMP/SCOMPC;                                         0086 00245000
         LR    @00,TEMP                                            0086 00246000
         SRDA  @00,32                                              0086 00247000
         D     @00,@CF00264                                        0086 00248000
         LR    TEMP1,@01                                           0086 00249000
*       IF TEMP1>NSCT               /* IF THE SUBCOMPONENT CROSS   0087 00250000
*                                      REFERENCE TABLE INDEX IS    0087 00251000
*                                      GREATER THAN THE NUMBER OF  0087 00252000
*                                      ENTRIES IN THE TABLE, THEN  0087 00253000
*                                      THEN SET THE REASON CODE TO 0087 00254000
*                                      INDICATE THIS FACT.           */ 00255000
*         THEN                                                     0087 00256000
         C     TEMP1,NSCT(,SCTPTR)                                 0087 00257000
         BNH   @RF00087                                            0087 00258000
*         RCODE=NSCTE;                                             0088 00259000
         MVC   RCODE(4),@CF00270                                   0088 00260000
*       ELSE                                                       0089 00261000
*         DO;                                                      0089 00262000
         B     @RC00087                                            0089 00263000
@RF00087 DS    0H                                                  0090 00264000
*           SSCTPTR=SSCTP(TEMP1+F1C);/* OTHERWISE, GET THE ADDRESS OF   00265000
*                                      THE SUB-SUBCOMPONENT CROSS  0090 00266000
*                                      REFERENCE TABLE.              */ 00267000
         LR    @10,TEMP1                                           0090 00268000
         SLA   @10,2                                               0090 00269000
         L     SSCTPTR,SSCTP(@10,SCTPTR)                           0090 00270000
*           IF SSCTPTR=F0C          /* IF THE ADDRESS OF THE       0091 00271000
*                                      SUB-SUBCOMPONENT CROSS      0091 00272000
*                                      REFERENCE TABLE IS ZERO, THEN    00273000
*                                      THIS TABLE DOES NOT EXIST. SET   00274000
*                                      THE REASON CODE TO INDICATE 0091 00275000
*                                      THIS SITUATION.               */ 00276000
*             THEN                                                 0091 00277000
         LTR   SSCTPTR,SSCTPTR                                     0091 00278000
         BNZ   @RF00091                                            0091 00279000
*             RCODE=ZSCTE;                                         0092 00280000
         MVC   RCODE(4),@CF00090                                   0092 00281000
*         END;                                                     0093 00282000
@RF00091 DS    0H                                                  0094 00283000
*     END;                                                         0094 00284000
@RC00087 DS    0H                                                  0095 00285000
*   IF RCODE=F0C                    /* IF NO ERRORS HAVE OCCURRED, 0095 00286000
*                                      THEN...                       */ 00287000
*     THEN                                                         0095 00288000
@RF00083 L     @10,RCODE                                           0095 00289000
         LTR   @10,@10                                             0095 00290000
         BNZ   @RF00095                                            0095 00291000
*     DO;                                                          0096 00292000
*       TEMP1=TEMP//SCOMPC;         /* EXTRACT THE SUB-SUBCOMPONENT     00293000
*                                      CROSS REFERENCE TABLE INDEX 0097 00294000
*                                      FROM THE INPUT MESSAGE NUMBER    00295000
*                                      (THE LAST TWO DIGITS).        */ 00296000
         LR    @00,TEMP                                            0097 00297000
         SRDA  @00,32                                              0097 00298000
         D     @00,@CF00264                                        0097 00299000
         LR    TEMP1,@00                                           0097 00300000
*       IF TEMP1>NSSCT              /* IF THIS INDEX IS GREATER THAN    00301000
*                                      THE NUMBER OF ENTRIES IN THE     00302000
*                                      TABLE, THEN SET THE REASON  0098 00303000
*                                      CODE TO INDICATE THIS FACT.   */ 00304000
*         THEN                                                     0098 00305000
         C     TEMP1,NSSCT(,SSCTPTR)                               0098 00306000
         BNH   @RF00098                                            0098 00307000
*         RCODE=NSSCTE;                                            0099 00308000
         MVC   RCODE(4),@CF00273                                   0099 00309000
*       ELSE                                                       0100 00310000
*         DO;                                                      0100 00311000
         B     @RC00098                                            0100 00312000
@RF00098 DS    0H                                                  0101 00313000
*           MSGSKA=MSGP(TEMP1+F1C); /* OTHERWISE, OBTAIN THE ADDRESS    00314000
*                                      OF THE MESSAGE SKELETON FROM     00315000
*                                      THE SUB-SUBCOMPONENT CROSS  0101 00316000
*                                      REFERENCE TABLE.              */ 00317000
         LR    @10,TEMP1                                           0101 00318000
         SLA   @10,2                                               0101 00319000
         L     MSGSKA,MSGP(@10,SSCTPTR)                            0101 00320000
*           IF MSGSKA=F0C           /* IF THIS ADDRESS IS ZERO, THE     00321000
*                                      THE REQUESTED MESSAGE DOES NOT   00322000
*                                      EXIST. SET THE REASON CODE TO    00323000
*                                      INDICATE THIS SITUATION.      */ 00324000
*             THEN                                                 0102 00325000
         LTR   MSGSKA,MSGSKA                                       0102 00326000
         BNZ   @RF00102                                            0102 00327000
*             RCODE=ZSSCTE;                                        0103 00328000
         MVC   RCODE(4),@CF00275                                   0103 00329000
*           ELSE                                                   0104 00330000
*             IF MSGSKNIN^=F0C      /* VALIDATE MESSAGE FORMAT FOR NO   00331000
*                                      INSERTS                       */ 00332000
*               THEN                                               0104 00333000
         B     @RC00102                                            0104 00334000
@RF00102 LH    @10,MSGSKNIN(,MSGSKA)                               0104 00335000
         LTR   @10,@10                                             0104 00336000
         BZ    @RF00104                                            0104 00337000
*               RCODE=NINSE;        /* MARK INSERTS PRESENT          */ 00338000
         MVC   RCODE(4),@CF00279                                   0105 00339000
*         END;                                                     0106 00340000
*     END;                                                         0107 00341000
*   END LOCMSGSK;                   /* RETURN THE ADDRESS OF THE   0108 00342000
*                                      MESSAGE SKELETON OR A REASON     00343000
*                                      CODE TO THE MAINLINE.         */ 00344000
@EL00002 DS    0H                                                  0108 00345000
@EF00002 DS    0H                                                  0108 00346000
@ER00002 LM    @14,@02,12(@13)                                     0108 00347000
         LM    @04,@12,36(@13)                                     0108 00348000
         BR    @14                                                 0108 00349000
*                                                                  0109 00350000
*   /*****************************************************************/ 00351000
*   /*                                                               */ 00352000
*   /* PROCEDURE STATEMENTS END                                      */ 00353000
*   /*                                                               */ 00354000
*   /*****************************************************************/ 00355000
*                                                                  0109 00356000
*   DECLARE                         /* GENERAL PURPOSE REGISTERS     */ 00357000
*     GPR01F FIXED(31) REG(1),                                     0109 00358000
*     GPR15F FIXED(31) REG(15);                                    0109 00359000
*   DECLARE                         /* COMMON VARIABLES              */ 00360000
*     I256C CHAR(256) BASED,                                       0110 00361000
*     I031F FIXED(31) BASED,                                       0110 00362000
*     I031P PTR(31) BASED,                                         0110 00363000
*     I015F FIXED(15) BASED,                                       0110 00364000
*     I015P PTR(15) BASED,                                         0110 00365000
*     I008P PTR(8) BASED,                                          0110 00366000
*     I001C CHAR(1) BASED;                                         0110 00367000
*   DCL                                                            0111 00368000
*     1 DASPATCH LOCAL BDY(DWORD),  /* PATCH AREA                    */ 00369000
*      2 DASPATA(DASPATLN) PTR INIT((DASPATLN)0);                  0111 00370000
*   END BLSCGMF                                                    0112 00371000
*                                                                  0112 00372000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 00373000
*/*%INCLUDE SYSLIB  (BLSDMSGD)                                       */ 00374000
*                                                                  0112 00375000
*       ;                                                          0112 00376000
@DATA    DS    0H                                                       00377000
@SM00305 MVC   MSGDTXT(0,@10),MSGSKT(MSGSKA)                            00378000
@DATD    DSECT                                                          00379000
         DS    0F                                                       00380000
@SA00001 DS    18F                                                      00381000
@PC00001 DS    3F                                                       00382000
@AL00001 DS    3A                                                       00383000
BLSCGMF  CSECT                                                          00384000
         DS    0F                                                       00385000
@CF00041 DC    F'8'                                                     00386000
@CF00253 DC    F'20'                                                    00387000
@CF00210 DC    F'24'                                                    00388000
@CF00270 DC    F'28'                                                    00389000
@CF00090 DC    F'32'                                                    00390000
@CF00273 DC    F'36'                                                    00391000
@CF00275 DC    F'40'                                                    00392000
@CF00279 DC    F'64'                                                    00393000
@CF00264 DC    F'100'                                                   00394000
@CF00260 DC    XL4'FFFFFFF8'                                            00395000
@CF00286 DC    XL4'80000000'                                            00396000
@DATD    DSECT                                                          00397000
         DS    0D                                                       00398000
MSGDPTR  DS    A                                                        00399000
MODSTAT  DS    CL16                                                     00400000
         ORG   MODSTAT                                                  00401000
MODNAME  DS    CL8                                                      00402000
RETCODE  DS    FL4                                                      00403000
RCODE    DS    FL4                                                      00404000
         ORG   MODSTAT+16                                               00405000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                00406000
@ENDDATD EQU   *                                                        00407000
BLSCGMF  CSECT                                                          00408000
         DS    0F                                                       00409000
@SIZDATD DC    AL1(0)                                                   00410000
         DC    AL3(@ENDDATD-@DATD)                                      00411000
@CV00224 DC    V(BLSCHOK)                                               00412000
         DS    0D                                                       00413000
@CC00258 DC    C'BLSCGMF '                                              00414000
DASPATCH DS    CL80                                                     00415000
         ORG   DASPATCH                                                 00416000
DASPATA  DC    20A(0)                                                   00417000
         ORG   DASPATCH+80                                              00418000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00419000
@01      EQU   01                                                       00420000
@02      EQU   02                                                       00421000
@03      EQU   03                                                       00422000
@04      EQU   04                                                       00423000
@05      EQU   05                                                       00424000
@06      EQU   06                                                       00425000
@07      EQU   07                                                       00426000
@08      EQU   08                                                       00427000
@09      EQU   09                                                       00428000
@10      EQU   10                                                       00429000
@11      EQU   11                                                       00430000
@12      EQU   12                                                       00431000
@13      EQU   13                                                       00432000
@14      EQU   14                                                       00433000
@15      EQU   15                                                       00434000
TEMP1    EQU   @04                                                      00435000
TEMP     EQU   @02                                                      00436000
MSGDLN   EQU   @04                                                      00437000
MSGSKA   EQU   @03                                                      00438000
SSCTPTR  EQU   @07                                                      00439000
SCTPTR   EQU   @06                                                      00440000
DMCBPTR  EQU   @05                                                      00441000
GPR15F   EQU   @15                                                      00442000
GPR01F   EQU   @01                                                      00443000
DMCB     EQU   0                                                        00444000
DMCBFTY  EQU   DMCB+20                                                  00445000
DMCBOPN  EQU   DMCB+21                                                  00446000
DMCBRMOD EQU   DMCB+23                                                  00447000
DMCBOUT  EQU   DMCBRMOD                                                 00448000
DMCBOPTS EQU   DMCB+24                                                  00449000
DMCBGKY  EQU   DMCBOPTS                                                 00450000
DMCBMFLG EQU   DMCB+28                                                  00451000
DMCBBUFP EQU   DMCB+32                                                  00452000
DMCBKEYP EQU   DMCB+44                                                  00453000
DMCBRI   EQU   DMCB+64                                                  00454000
DMCBMSGS EQU   DMCB+72                                                  00455000
DMCBSPID EQU   DMCB+84                                                  00456000
DMCBFRE  EQU   DMCB+88                                                  00457000
DMCBEOB  EQU   DMCB+92                                                  00458000
DMCBACBE EQU   DMCB+124                                                 00459000
DMCBSPEC EQU   DMCB+380                                                 00460000
DMCBAMS  EQU   DMCB+416                                                 00461000
DMCBAUDT EQU   DMCB+568                                                 00462000
DMCBLSCP EQU   DMCBAUDT+16                                              00463000
MSGDENT  EQU   0                                                        00464000
MSGDPRF  EQU   MSGDENT                                                  00465000
MSGDSPID EQU   MSGDPRF                                                  00466000
MSGDFLEN EQU   MSGDPRF+1                                                00467000
MSGDBAK  EQU   MSGDPRF+4                                                00468000
MSGDWRT  EQU   MSGDENT+8                                                00469000
MSGDNXT  EQU   MSGDWRT                                                  00470000
MSGDMOV  EQU   MSGDWRT+4                                                00471000
MSGDLEN  EQU   MSGDMOV                                                  00472000
MSGDPAD  EQU   MSGDMOV+2                                                00473000
MSGDTXT  EQU   MSGDMOV+4                                                00474000
MSGWENT  EQU   0                                                        00475000
MSGWMOV  EQU   MSGWENT+4                                                00476000
CCRITPTR EQU   0                                                        00477000
CCRIT    EQU   0                                                        00478000
NCCRIT   EQU   CCRIT                                                    00479000
SCTP     EQU   CCRIT+4                                                  00480000
SCT      EQU   0                                                        00481000
NSCT     EQU   SCT                                                      00482000
SSCTP    EQU   SCT+4                                                    00483000
SSCT     EQU   0                                                        00484000
NSSCT    EQU   SSCT                                                     00485000
MSGP     EQU   SSCT+4                                                   00486000
MSGSK    EQU   0                                                        00487000
MSGSKNIN EQU   MSGSK                                                    00488000
MSGSKL   EQU   MSGSK+2                                                  00489000
MSGSKT   EQU   MSGSK+3                                                  00490000
BLSDMSGS EQU   0                                                        00491000
DMCBDMGR EQU   0                                                        00492000
DMCBRQC  EQU   0                                                        00493000
I001C    EQU   0                                                        00494000
I008P    EQU   0                                                        00495000
I015F    EQU   0                                                        00496000
I015P    EQU   0                                                        00497000
I031F    EQU   0                                                        00498000
I031P    EQU   0                                                        00499000
I256C    EQU   0                                                        00500000
DMCBPARM EQU   0                                                        00501000
MSGANCHR EQU   0                                                        00502000
MODNMPAR EQU   0                                                        00503000
DMCBVSM  EQU   DMCBAMS                                                  00504000
DMCBQSM  EQU   DMCBAMS                                                  00505000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    00506000
DMCBRES7 EQU   DMCBQSM+96                                               00507000
DMCBDCB  EQU   DMCBQSM                                                  00508000
DMCBACB  EQU   DMCBVSM+76                                               00509000
DMCBRPL  EQU   DMCBVSM                                                  00510000
MSGWTXT  EQU   MSGWMOV+4                                                00511000
MSGWPAD  EQU   MSGWMOV+2                                                00512000
MSGWLEN  EQU   MSGWMOV                                                  00513000
MSGWNXT  EQU   MSGWENT                                                  00514000
DMCBWRK  EQU   DMCB+648                                                 00515000
DMCBRES8 EQU   DMCB+640                                                 00516000
DMCBMODN EQU   DMCB+632                                                 00517000
DMCBCARY EQU   DMCBAUDT+20                                              00518000
DMCBCLC  EQU   DMCBAUDT+12                                              00519000
DMCBOPC  EQU   DMCBAUDT+8                                               00520000
DMCBFRC  EQU   DMCBAUDT+4                                               00521000
DMCBALC  EQU   DMCBAUDT                                                 00522000
DMCBFR   EQU   DMCB+412                                                 00523000
DMCBRES6 EQU   DMCB+410                                                 00524000
DMCBIRSC EQU   DMCB+408                                                 00525000
DMCBSUBC EQU   DMCB+404                                                 00526000
DMCBDRBP EQU   DMCB+400                                                 00527000
DMCBRSZM EQU   DMCB+398                                                 00528000
DMCBRSZA EQU   DMCB+396                                                 00529000
DMCBCISZ EQU   DMCB+394                                                 00530000
DMCBDCBL EQU   DMCB+392                                                 00531000
DMCBDCLR EQU   DMCB+390                                                 00532000
DMCBDCFM EQU   DMCB+389                                                 00533000
DMCBRES5 EQU   DMCB+388                                                 00534000
DMCBLBRT EQU   DMCB+386                                                 00535000
DMCBLBSQ EQU   DMCB+384                                                 00536000
DMCBLBPS EQU   DMCB+383                                                 00537000
DMCBLBTY EQU   DMCB+382                                                 00538000
DMCBRES4 EQU   DMCB+381                                                 00539000
DMCBSPRS EQU   DMCBSPEC                                                 00540000
DMCBSPRN EQU   DMCBSPEC                                                 00541000
DMCBSPCT EQU   DMCBSPEC                                                 00542000
DMCBSPRL EQU   DMCBSPEC                                                 00543000
DMCBSPSE EQU   DMCB+376                                                 00544000
DMCBSPPR EQU   DMCB+372                                                 00545000
DMCBSPTY EQU   DMCB+369                                                 00546000
DMCBODIS EQU   DMCB+368                                                 00547000
DMCBDISP EQU   DMCB+367                                                 00548000
DMCBSTAT EQU   DMCB+366                                                 00549000
DMCBRES3 EQU   DMCB+364                                                 00550000
DMCBMEMB EQU   DMCB+356                                                 00551000
DMCBMODL EQU   DMCB+348                                                 00552000
DMCBRES9 EQU   DMCB+340                                                 00553000
DMCBPID  EQU   DMCB+332                                                 00554000
DMCBTYPE EQU   DMCB+328                                                 00555000
DMCBDSN  EQU   DMCB+284                                                 00556000
DMCBUNIT EQU   DMCB+276                                                 00557000
DMCBDSOR EQU   DMCB+274                                                 00558000
DMCBVOL  EQU   DMCB+268                                                 00559000
DMCBDDNM EQU   DMCB+260                                                 00560000
DMCBSYNM EQU   DMCB+132                                                 00561000
DMCBRPLF EQU   DMCB+128                                                 00562000
DMCBDCBE EQU   DMCBACBE                                                 00563000
DMCBARC  EQU   DMCB+120                                                 00564000
DMCBCPC  EQU   DMCB+116                                                 00565000
DMCBRET  EQU   DMCB+112                                                 00566000
DMCBSTL  EQU   DMCB+96                                                  00567000
DMCBRES2 EQU   DMCB+85                                                  00568000
DMCBRESC EQU   DMCB+80                                                  00569000
DMCBZZ1P EQU   DMCB+76                                                  00570000
DMCBMSG0 EQU   DMCB+68                                                  00571000
DMCBRRL  EQU   DMCB+60                                                  00572000
DMCBRBA  EQU   DMCB+56                                                  00573000
DMCBMSG  EQU   DMCB+52                                                  00574000
DMCBKEYL EQU   DMCB+48                                                  00575000
DMCBKPC  EQU   DMCBKEYP                                                 00576000
DMCBORL  EQU   DMCB+40                                                  00577000
DMCBBLEN EQU   DMCB+36                                                  00578000
DMCBBFPC EQU   DMCBBUFP                                                 00579000
DMCBRES1 EQU   DMCB+31                                                  00580000
DMCBACCM EQU   DMCB+30                                                  00581000
DMCBREJ  EQU   DMCB+29                                                  00582000
DMCBRESB EQU   DMCBMFLG                                                 00583000
DMCBFMOD EQU   DMCBMFLG                                                 00584000
DMCBLOPT EQU   DMCB+27                                                  00585000
DMCBLRM  EQU   DMCB+26                                                  00586000
DMCBLRQ  EQU   DMCB+25                                                  00587000
DMCBOPRS EQU   DMCBOPTS                                                 00588000
DMCBLRD  EQU   DMCBOPTS                                                 00589000
DMCBBWD  EQU   DMCBOPTS                                                 00590000
DMCBUPD  EQU   DMCBOPTS                                                 00591000
DMCBAPX  EQU   DMCBOPTS                                                 00592000
DMCBRNO  EQU   DMCBGKY                                                  00593000
DMCBKYD  EQU   DMCBOPTS                                                 00594000
DMCBRMRS EQU   DMCBRMOD                                                 00595000
DMCBRM5  EQU   DMCBRMOD                                                 00596000
DMCBRM6  EQU   DMCBRMOD                                                 00597000
DMCBTMP  EQU   DMCBOUT                                                  00598000
DMCBRQST EQU   DMCB+22                                                  00599000
DMCBRESA EQU   DMCBOPN                                                  00600000
DMCBSOUT EQU   DMCBOPN                                                  00601000
DMCBSIN  EQU   DMCBOPN                                                  00602000
DMCBVSF  EQU   DMCBFTY                                                  00603000
DMCBKSF  EQU   DMCBFTY                                                  00604000
DMCBFTRS EQU   DMCBFTY                                                  00605000
DMCBSHF  EQU   DMCBFTY                                                  00606000
DMCBIRL  EQU   DMCB+16                                                  00607000
DMCBRTC  EQU   DMCB+12                                                  00608000
DMCBTVP  EQU   DMCB+8                                                   00609000
DMCBNEXT EQU   DMCB+4                                                   00610000
DMCBID   EQU   DMCB                                                     00611000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      00612000
@RF00095 EQU   @EL00002                                                 00613000
@RC00098 EQU   @EL00002                                                 00614000
@RF00104 EQU   @EL00002                                                 00615000
@RC00102 EQU   @EL00002                                                 00616000
@ENDDATA EQU   *                                                        00617000
         END   BLSCGMF,(C'PLS1925',0701,78062)                          00618000
