         TITLE 'ITERATION DRIVER                                       *00001000
                        '                                               00002000
*           /*CHANGE ACTIVITY*/                                         00003000
*THIS MODULE IS WRITTEN FOR @G57LPMN                                    00004000
BLSELPDR CSECT ,                                                   0002 00005000
@MAINENT DS    0H                                                  0002 00006000
         USING *,@15                                               0002 00007000
         B     @PROLOG                                             0002 00008000
         DC    AL1(16)                                             0002 00009000
         DC    C'BLSELPDR  78.065'                                 0002 00010000
         DROP  @15                                                      00011000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00012000
         BALR  @12,0                                               0002 00013000
@PSTART  LA    @10,4095(,@12)                                      0002 00014000
         USING @PSTART,@12                                         0002 00015000
         USING @PSTART+4095,@10                                    0002 00016000
         L     @00,@SIZDATD                                        0002 00017000
         BLSUALLS R,LV=(0)                                              00018000
         LR    @11,@01                                             0002 00019000
         USING @DATD,@11                                           0002 00020000
         ST    @13,@SA00001+4                                      0002 00021000
         LM    @00,@01,20(@13)                                     0002 00022000
         ST    @11,8(,@13)                                         0002 00023000
         LR    @13,@11                                             0002 00024000
         MVC   @PC00001(8),0(@01)                                  0002 00025000
*                                                                  0154 00026000
*   /*****************************************************************/ 00027000
*   /*                                                               */ 00028000
*   /* START OF EXECUTABLE CODE. PERFORM NECESSARY INITIALIZATIONS   */ 00029000
*   /*                                                               */ 00030000
*   /*****************************************************************/ 00031000
*                                                                  0155 00032000
*   ZZ2PTR=ADDR(ZZ2PARM);           /* INITIALIZE ZZ2 POINTER        */ 00033000
         L     ZZ2PTR,@PC00001                                     0155 00034000
*   RETC=ZERO;                      /* INITIALIZE THE RETURN         */ 00035000
         SLR   RETC,RETC                                           0156 00036000
*   RETCDE=ZERO;                    /* CODES                         */ 00037000
         SLR   RETCDE,RETCDE                                       0157 00038000
*   MAXRETC=ZERO;                                                  0158 00039000
         SLR   MAXRETC,MAXRETC                                     0158 00040000
*   MSGHEAD=ZERO;                   /* INITIALIZE HEADER FOR MESSAGE    00041000
*                                      QUEUE                         */ 00042000
         SLR   @14,@14                                             0159 00043000
         ST    @14,MSGHEAD                                         0159 00044000
*   DATAHEAD=ZERO;                  /* INITIALIZE HEADER FOR OUTPUT     00045000
*                                      QUEUE                         */ 00046000
         ST    @14,DATAHEAD                                        0160 00047000
*   QUEUELNS=ZERO;                  /* INITIALIZE COUNT OF LINES IN     00048000
*                                      OUTPUT QUEUE                  */ 00049000
         ST    @14,QUEUELNS                                        0161 00050000
*   RECTYPE=PDRSTATC;               /* RECORD TYPE FETCHED IN THIS 0162 00051000
*                                      MODULE IS 'ST', OR STATUS     */ 00052000
         MVC   RECTYPE(2),@CC01020                                 0162 00053000
*   PDRPREF=FPDBPIDP;               /* PROBLEM PREFIX WHEN FETCHING     00054000
*                                      RECORDS                       */ 00055000
         L     @07,ZZ2ZZ1P(,ZZ2PTR)                                0163 00056000
         L     @04,ZZ1FPP(,@07)                                    0163 00057000
         MVC   PDRPREF(3),FPDBPIDP(@04)                            0163 00058000
*   ENDFLAG=OFF;                    /* TURN OFF LOOP CONTROL         */ 00059000
         NI    ENDFLAG,B'10111111'                                 0164 00060000
*   PIDCOUNT=ZERO;                  /* INITIALIZE COUNT OF LISTED  0165 00061000
*                                      PROBLEMS                      */ 00062000
         ST    @14,PIDCOUNT                                        0165 00063000
*   STATPTR=ADDR(BUFFER);           /* INITIALIZE PTR TO FETCHED   0166 00064000
*                                      STATUS RECORDS                */ 00065000
*                                                                  0166 00066000
         LA    @04,BUFFER                                          0166 00067000
         ST    @04,STATPTR                                         0166 00068000
*   /*****************************************************************/ 00069000
*   /*                                                               */ 00070000
*   /* OPEN THE PDR AND OBTAIN THE TIME AT WHICH THE PDR IS OPENED   */ 00071000
*   /*                                                               */ 00072000
*   /*****************************************************************/ 00073000
*                                                                  0167 00074000
*   NUMPROBS=ZERO;                  /* SET TO ZERO THE COUNTER FOR #    00075000
*                                      OF STATUS RECORDS FETCHED   0167 00076000
*                                      SEQUENTIALLY FROM THE PDR     */ 00077000
         ST    @14,NUMPROBS                                        0167 00078000
*   DO;                             /* BLSOPEN(ZZ1PDRP)INPUT         */ 00079000
*     RFY                                                          0169 00080000
*       GPR01P RSTD;                                               0169 00081000
*     GPR01P=ZZ1PDRP;               /* ADDRESS DMCB                  */ 00082000
         L     GPR01P,ZZ1PDRP(,@07)                                0170 00083000
*     RFY                                                          0171 00084000
*       DMCB BASED(GPR01P);                                        0171 00085000
*     IF((GPR01P&'FFFFFFF8'X)=GPR01P)&DMCBID='DMCB'/* VALID DMCB ?   */ 00086000
*       THEN                                                       0172 00087000
         LR    @14,GPR01P                                          0172 00088000
         N     @14,@CF01160                                        0172 00089000
         CLR   @14,GPR01P                                          0172 00090000
         BNE   @RF00172                                            0172 00091000
         CLC   DMCBID(4,GPR01P),@CC01161                           0172 00092000
         BNE   @RF00172                                            0172 00093000
*       DO;                                                        0173 00094000
*         DMCBRQST=DMCBOPR;         /* INDICATE OPEN REQUEST         */ 00095000
         MVI   DMCBRQST(GPR01P),X'01'                              0174 00096000
*         DMCBOUT='0'B;             /* INDICATE OPEN FOR INPUT       */ 00097000
         NI    DMCBOUT(GPR01P),B'01111111'                         0175 00098000
*         CALL DMCBRI->DMCBDMGR;    /* CALL BLSCRQST                 */ 00099000
         L     @15,DMCBRI(,GPR01P)                                 0176 00100000
         BALR  @14,@15                                             0176 00101000
*       END;                                                       0177 00102000
*     ELSE                                                         0178 00103000
*       DO;                                                        0178 00104000
         B     @RC00172                                            0178 00105000
@RF00172 DS    0H                                                  0179 00106000
*         RFY                                                      0179 00107000
*          (GPR00F,                                                0179 00108000
*           GPR15F) RSTD;                                          0179 00109000
*         GPR00F=0;                 /* INDICATE NO MESSAGE CHAIN     */ 00110000
         SLR   GPR00F,GPR00F                                       0180 00111000
*         GPR15F=16;                /* INDICATE INVALID DMCB         */ 00112000
         LA    GPR15F,16                                           0181 00113000
*         RFY                                                      0182 00114000
*          (GPR00F,                                                0182 00115000
*           GPR15F);                                               0182 00116000
*       END;                                                       0183 00117000
*     RFY                                                          0184 00118000
*       DMCB;                                                      0184 00119000
@RC00172 DS    0H                                                  0185 00120000
*     RFY                                                          0185 00121000
*       GPR01P;                                                    0185 00122000
*   END;                            /* BLSOPEN(ZZ1PDRP)INPUT OPEN THE   00123000
*                                      PDR                           */ 00124000
*   SAVEDRC=RETCDE;                 /* SAVE THE RETURN CODE          */ 00125000
         LR    SAVEDRC,RETCDE                                      0187 00126000
*   IF RETCDE^=ZZZFLAGI             /* IF RETURN CODE ^= 0           */ 00127000
*     THEN                                                         0188 00128000
         SLR   @14,@14                                             0188 00129000
         CR    RETCDE,@14                                          0188 00130000
         BE    @RF00188                                            0188 00131000
*     DO;                                                          0189 00132000
*       IF RETCDE=ZZZFLAGT          /* IF RETURN CODE = 16           */ 00133000
*         THEN                                                     0190 00134000
         C     RETCDE,@CF00056                                     0190 00135000
         BNE   @RF00190                                            0190 00136000
*         MSGHEAD=ZERO;             /* THEN OUTPUT 1 ERROR MSG       */ 00137000
         ST    @14,MSGHEAD                                         0191 00138000
*       ELSE                                                       0192 00139000
*         MSGHEAD=ZZ1PDRP->DMCBMSG; /* ELSE OUTPUT MSG CHAIN         */ 00140000
         B     @RC00190                                            0192 00141000
@RF00190 L     @14,ZZ2ZZ1P(,ZZ2PTR)                                0192 00142000
         L     @14,ZZ1PDRP(,@14)                                   0192 00143000
         L     @14,DMCBMSG(,@14)                                   0192 00144000
         ST    @14,MSGHEAD                                         0192 00145000
*       DO;                         /* BLSDMSG (ZZ2PARM,OPENID,MSGHEA   00146000
*                                      D,BLSDMSGS) LIFO ROUTE(TERM)  */ 00147000
@RC00190 DS    0H                                                  0194 00148000
*         CALL BLSDMSG0(ZZ2PARM,OPENID,MSGHEAD,BLSDMSGS,'10010000'B,0); 00149000
         L     @14,@PC00001                                        0194 00150000
         ST    @14,@AL00001                                        0194 00151000
         LA    @14,@CF01106                                        0194 00152000
         ST    @14,@AL00001+4                                      0194 00153000
         LA    @14,MSGHEAD                                         0194 00154000
         ST    @14,@AL00001+8                                      0194 00155000
         L     @14,ZZ2MSGSP(,ZZ2PTR)                               0194 00156000
         ST    @14,@AL00001+12                                     0194 00157000
         LA    @14,@CB01164                                        0194 00158000
         ST    @14,@AL00001+16                                     0194 00159000
         LA    @14,@CF00050                                        0194 00160000
         ST    @14,@AL00001+20                                     0194 00161000
         L     @15,ZZ2MSG0P(,ZZ2PTR)                               0194 00162000
         LA    @01,@AL00001                                        0194 00163000
         BALR  @14,@15                                             0194 00164000
*                                   /* BUILD MESSAGE                 */ 00165000
*       END;                        /* BLSDMSG (ZZ2PARM,OPENID,MSGHEA   00166000
*                                      D,BLSDMSGS) LIFO ROUTE(TERM)     00167000
*                                      BLSOPEN ERROR MSG             */ 00168000
*       IF SAVEDRC^=ZZZFLAGW        /* IF RETURN CODE ^= 4           */ 00169000
*         THEN                                                     0196 00170000
         C     SAVEDRC,@CF00042                                    0196 00171000
         BE    @RF00196                                            0196 00172000
*         DO;                       /* ABEND(OPABEND) DUMP           */ 00173000
*           RESPECIFY                                              0198 00174000
*            (GPR01F) RESTRICTED;                                  0198 00175000
*           GPR01F=OPABEND;         /* COMP CODE IN REG 1            */ 00176000
         LA    GPR01F,138                                          0199 00177000
*           GPR01F=GPR01F|'80000000'X;/* DUMP/STEP/DUMPOPTS FLAG     */ 00178000
         O     GPR01F,@CF00065                                     0200 00179000
*           SVC(13);                /* ISSUE ABEND SVC               */ 00180000
         SVC   13                                                  0201 00181000
*           RESPECIFY                                              0202 00182000
*            (GPR01F) UNRESTRICTED;                                0202 00183000
*         END;                      /* ABEND(OPABEND) DUMP ABEND     */ 00184000
*       ELSE                                                       0204 00185000
*         MAXRETC=ZZZFLAGS;         /* ELSE RETURN CODE = 12         */ 00186000
         B     @RC00196                                            0204 00187000
@RF00196 LA    MAXRETC,12                                          0204 00188000
*     END;                                                         0205 00189000
*   ELSE                                                           0206 00190000
*     DO;                           /* ELSE IF PDR OPENED CORRECTLY     00191000
*                                      THEN CONTINUE                 */ 00192000
         B     @RC00188                                            0206 00193000
@RF00188 DS    0H                                                  0207 00194000
*       GEN CODE SETS(FULLTIME);                                   0207 00195000
*                                             /*GET THE TIME          * 00196000
          STCK  FULLTIME                                                00197000
*       PARMTIME=FULLTIME;          /* PUT TIME IN PARAMETER         */ 00198000
*                                                                  0208 00199000
         MVC   PARMTIME(8),FULLTIME                                0208 00200000
*       /*************************************************************/ 00201000
*       /*                                                           */ 00202000
*       /* PROCESSING FOR 'PROBLEMS ALL'                             */ 00203000
*       /*                                                           */ 00204000
*       /*************************************************************/ 00205000
*                                                                  0209 00206000
*       IF LPPRBPTR=ALLPTR          /* IF 'PROBLEMS ALL'             */ 00207000
*         THEN                                                     0209 00208000
         L     @14,@PC00001+4                                      0209 00209000
         L     @14,LPWAPTR(,@14)                                   0209 00210000
         CLC   LPPRBPTR(4,@14),@CF00940                            0209 00211000
         BNE   @RF00209                                            0209 00212000
*         DO;                       /* THEN START FETCHING FIRST   0210 00213000
*                                      RECORD                        */ 00214000
*           PDRPID=FRSTPID#;        /* DO A SEARCH ON FIRST PID    0211 00215000
*                                      NUMBER = '00001'              */ 00216000
         MVC   PDRPID(5),@CC01078                                  0211 00217000
*           DO WHILE(ENDFLAG=OFF);  /* DO UNTIL AN ERROR OCCURS OR 0212 00218000
*                                      FETCH BEYOND STATUS RECORDS   */ 00219000
         B     @DE00212                                            0212 00220000
@DL00212 DS    0H                                                  0213 00221000
*             IF ZZ1EVEP=ON         /* IF ATTENTION KEY HAS BEEN   0213 00222000
*                                      POSTED                        */ 00223000
*               THEN                                               0213 00224000
         L     @14,ZZ2ZZ1P(,ZZ2PTR)                                0213 00225000
         TM    ZZ1EVEP(@14),B'01000000'                            0213 00226000
         BNO   @RF00213                                            0213 00227000
*               DO;                                                0214 00228000
*                 MAXRETC=ZZZFLAGS; /* RETURN CODE = 12              */ 00229000
         LA    MAXRETC,12                                          0215 00230000
*                 ZZ1EVEP=OFF;      /* TURN OFF POST BIT             */ 00231000
         L     @07,ZZ1EVEP(,@14)                                   0216 00232000
@GL00002 LR    @04,@07                                             0216 00233000
         N     @04,@CF01233                                        0216 00234000
         CS    @07,@04,ZZ1EVEP(@14)                                0216 00235000
         BNE   @GL00002                                            0216 00236000
*                 ENDFLAG=ON;       /* END LOOP                      */ 00237000
         OI    ENDFLAG,B'01000000'                                 0217 00238000
*               END;                                               0218 00239000
*             ELSE                                                 0219 00240000
*               DO;                                                0219 00241000
         B     @RC00213                                            0219 00242000
@RF00213 DS    0H                                                  0220 00243000
*                 IF NUMPROBS=ZERO  /* IF THIS IS FIRST STATUS RECORD   00244000
*                                      TO BE FETCHED SINCE PDR WAS 0220 00245000
*                                      LAST OPENED OR USED TO FETCH     00246000
*                                      ANOTHER TYPE OF RECORD        */ 00247000
*                   THEN            /* DO A DIRECT FETCH             */ 00248000
*                                                                  0220 00249000
         L     @14,NUMPROBS                                        0220 00250000
         LTR   @14,@14                                             0220 00251000
         BNZ   @RF00220                                            0220 00252000
*                   /*************************************************/ 00253000
*                   /*                                               */ 00254000
*                   /* BLSGET (ZZ1PDRP)                              */ 00255000
*                   /* AREAL(STATPTR)AREALEN(LENGTH(BUFFER))GENGE    */ 00256000
*                   /* ARG(SRCHKEY)ARGLEN(KEYLN)                     */ 00257000
*                   /*                                               */ 00258000
*                   /*************************************************/ 00259000
*                                                                  0221 00260000
*                   DO;             /* BLSGET (ZZ1PDRP) AREAL(STATPTR   00261000
*                                      )AREALEN(LENGTH(BUFFER))GENGE    00262000
*                                      ARG(SRCHKEY)ARGLEN(KEYLN)     */ 00263000
*                     RFY                                          0222 00264000
*                       GPR01P RSTD;                               0222 00265000
*                     GPR01P=ZZ1PDRP;/* ADDRESS DMCB                 */ 00266000
         L     @14,ZZ2ZZ1P(,ZZ2PTR)                                0223 00267000
         L     GPR01P,ZZ1PDRP(,@14)                                0223 00268000
*                     RFY                                          0224 00269000
*                       DMCB BASED(GPR01P);                        0224 00270000
*                     IF((GPR01P&'FFFFFFF8'X)=GPR01P)&DMCBID='DMCB'/*   00271000
*                                      VALID DMCB ?                  */ 00272000
*                       THEN                                       0225 00273000
         LR    @14,GPR01P                                          0225 00274000
         N     @14,@CF01160                                        0225 00275000
         CLR   @14,GPR01P                                          0225 00276000
         BNE   @RF00225                                            0225 00277000
         CLC   DMCBID(4,GPR01P),@CC01161                           0225 00278000
         BNE   @RF00225                                            0225 00279000
*                       DO;                                        0226 00280000
*                         DMCBBUFP=STATPTR&'7FFFFFFF'X;/* PLACE    0227 00281000
*                                      BUFFER ADDRESS IN DMCB        */ 00282000
         L     @14,STATPTR                                         0227 00283000
         N     @14,@CF01168                                        0227 00284000
         ST    @14,DMCBBUFP(,GPR01P)                               0227 00285000
*                         DMCBBLEN=LENGTH(BUFFER)&'7FFFFFFF'X;/*   0228 00286000
*                                      PLACE BUFFER LENGTH IN DMCB   */ 00287000
         MVC   DMCBBLEN(4,GPR01P),@CF01213                         0228 00288000
*                         DMCBKEYP=ADDR(SRCHKEY);/* PLACE KEY ADDRESS   00289000
*                                      IN DMCB                       */ 00290000
         LA    @14,SRCHKEY                                         0229 00291000
         ST    @14,DMCBKEYP(,GPR01P)                               0229 00292000
*                         DMCBKEYL=(KEYLN)&'7FFFFFFF'X;/* PLACE KEY     00293000
*                                      LENGTH IN DMCB                */ 00294000
         MVC   DMCBKEYL(4,GPR01P),@CF00035                         0230 00295000
*                         DMCBKYD='1'B;/* INDICATE KEYED ACCESS      */ 00296000
*                         DMCBGKY='1'B;/* INDICATE GENERIC KEY       */ 00297000
*                         DMCBAPX='1'B;/* INDICATE APROX MATCH       */ 00298000
*                         DMCBUPD='0'B;/* DEFAULT FOR GET IS NUP     */ 00299000
         OI    DMCBKYD(GPR01P),B'11100000'                         0234 00300000
         NI    DMCBUPD(GPR01P),B'11101111'                         0234 00301000
*                         DMCBRQST=DMCBGER;/* INDICATE GET REQUEST   */ 00302000
         MVI   DMCBRQST(GPR01P),X'04'                              0235 00303000
*                         CALL DMCBRI->DMCBDMGR;/* CALL BLSCRQST     */ 00304000
         L     @15,DMCBRI(,GPR01P)                                 0236 00305000
         BALR  @14,@15                                             0236 00306000
*                       END;                                       0237 00307000
*                     ELSE                                         0238 00308000
*                       DO;                                        0238 00309000
         B     @RC00225                                            0238 00310000
@RF00225 DS    0H                                                  0239 00311000
*                         RFY                                      0239 00312000
*                          (GPR00F,                                0239 00313000
*                           GPR15F) RSTD;                          0239 00314000
*                         GPR00F=0; /* INDICATE NO MESSAGE CHAIN     */ 00315000
         SLR   GPR00F,GPR00F                                       0240 00316000
*                         GPR15F=16;/* INDICATE INVALID DMCB         */ 00317000
         LA    GPR15F,16                                           0241 00318000
*                         RFY                                      0242 00319000
*                          (GPR00F,                                0242 00320000
*                           GPR15F);                               0242 00321000
*                       END;                                       0243 00322000
*                     RFY                                          0244 00323000
*                       DMCB;                                      0244 00324000
@RC00225 DS    0H                                                  0245 00325000
*                     RFY                                          0245 00326000
*                       GPR01P;                                    0245 00327000
*                   END;            /* BLSGET (ZZ1PDRP) AREAL(STATPTR   00328000
*                                      )AREALEN(LENGTH(BUFFER))GENGE    00329000
*                                      ARG(SRCHKEY)ARGLEN(KEYLN)     */ 00330000
*                 ELSE              /* ELSE DO A SEQUENTIAL FETCH    */ 00331000
*                                                                  0247 00332000
*                   /*************************************************/ 00333000
*                   /*                                               */ 00334000
*                   /* BLSGET (ZZ1PDRP) SEQ                          */ 00335000
*                   /*                                               */ 00336000
*                   /*************************************************/ 00337000
*                                                                  0247 00338000
*                   DO;             /* BLSGET (ZZ1PDRP) SEQ          */ 00339000
         B     @RC00220                                            0247 00340000
@RF00220 DS    0H                                                  0248 00341000
*                     RFY                                          0248 00342000
*                       GPR01P RSTD;                               0248 00343000
*                     GPR01P=ZZ1PDRP;/* ADDRESS DMCB                 */ 00344000
         L     @14,ZZ2ZZ1P(,ZZ2PTR)                                0249 00345000
         L     GPR01P,ZZ1PDRP(,@14)                                0249 00346000
*                     RFY                                          0250 00347000
*                       DMCB BASED(GPR01P);                        0250 00348000
*                     IF((GPR01P&'FFFFFFF8'X)=GPR01P)&DMCBID='DMCB'/*   00349000
*                                      VALID DMCB ?                  */ 00350000
*                       THEN                                       0251 00351000
         LR    @14,GPR01P                                          0251 00352000
         N     @14,@CF01160                                        0251 00353000
         CLR   @14,GPR01P                                          0251 00354000
         BNE   @RF00251                                            0251 00355000
         CLC   DMCBID(4,GPR01P),@CC01161                           0251 00356000
         BNE   @RF00251                                            0251 00357000
*                       DO;                                        0252 00358000
*                         DMCBKYD='0'B;/* INDICATE UNKEYED ACCESS    */ 00359000
*                         DMCBRNO='0'B;/* INDICATE SEQUENTIAL        */ 00360000
*                         DMCBAPX='0'B;/* RESET APPROX BIT           */ 00361000
*                         DMCBUPD='0'B;/* DEFAULT FOR GET IS NUP     */ 00362000
         NI    DMCBKYD(GPR01P),B'00001111'                         0256 00363000
*                         DMCBRQST=DMCBGER;/* INDICATE GET REQUEST   */ 00364000
         MVI   DMCBRQST(GPR01P),X'04'                              0257 00365000
*                         CALL DMCBRI->DMCBDMGR;/* CALL BLSCRQST     */ 00366000
         L     @15,DMCBRI(,GPR01P)                                 0258 00367000
         BALR  @14,@15                                             0258 00368000
*                       END;                                       0259 00369000
*                     ELSE                                         0260 00370000
*                       DO;                                        0260 00371000
         B     @RC00251                                            0260 00372000
@RF00251 DS    0H                                                  0261 00373000
*                         RFY                                      0261 00374000
*                          (GPR00F,                                0261 00375000
*                           GPR15F) RSTD;                          0261 00376000
*                         GPR00F=0; /* INDICATE NO MESSAGE CHAIN     */ 00377000
         SLR   GPR00F,GPR00F                                       0262 00378000
*                         GPR15F=16;/* INDICATE INVALID DMCB         */ 00379000
         LA    GPR15F,16                                           0263 00380000
*                         RFY                                      0264 00381000
*                          (GPR00F,                                0264 00382000
*                           GPR15F);                               0264 00383000
*                       END;                                       0265 00384000
*                     RFY                                          0266 00385000
*                       DMCB;                                      0266 00386000
@RC00251 DS    0H                                                  0267 00387000
*                     RFY                                          0267 00388000
*                       GPR01P;                                    0267 00389000
*                   END;            /* BLSGET (ZZ1PDRP) SEQ          */ 00390000
*                 IF((RETCDE^=ZZZFLAGI)/* IF RETURN CODE ^= 0        */ 00391000
*                     &(RETCDE^=ZZZFLAGE))/* AND RETURN CODE ^= 8    */ 00392000
*                   THEN                                           0269 00393000
@RC00220 SLR   @14,@14                                             0269 00394000
         CR    RETCDE,@14                                          0269 00395000
         BE    @RF00269                                            0269 00396000
         C     RETCDE,@CF00053                                     0269 00397000
         BE    @RF00269                                            0269 00398000
*                   DO;                                            0270 00399000
*                     IF RETCDE=ZZZFLAGT/* IF RETURN CODE = 16       */ 00400000
*                       THEN                                       0271 00401000
         C     RETCDE,@CF00056                                     0271 00402000
         BNE   @RF00271                                            0271 00403000
*                       MSGHEAD=ZERO;/* THEN OUTPUT 1 ERROR MSG      */ 00404000
         ST    @14,MSGHEAD                                         0272 00405000
*                     ELSE                                         0273 00406000
*                       MSGHEAD=ZZ1PDRP->DMCBMSG;/* ELSE OUTPUT MSG     00407000
*                                      CHAIN                         */ 00408000
         B     @RC00271                                            0273 00409000
@RF00271 L     @14,ZZ2ZZ1P(,ZZ2PTR)                                0273 00410000
         L     @14,ZZ1PDRP(,@14)                                   0273 00411000
         L     @14,DMCBMSG(,@14)                                   0273 00412000
         ST    @14,MSGHEAD                                         0273 00413000
*                     DO;           /* BLSDMSG (ZZ2PARM,PUTID,DATAHEA   00414000
*                                      D,BLSDMSGS) ROUTE(BOTH)       */ 00415000
@RC00271 DS    0H                                                  0275 00416000
*                       CALL BLSDMSG0(ZZ2PARM,PUTID,DATAHEAD,BLSDMSGS,  00417000
*                           '00110000'B,0);/* BUILD MESSAGE          */ 00418000
         L     @14,@PC00001                                        0275 00419000
         ST    @14,@AL00001                                        0275 00420000
         LA    @14,@CF01124                                        0275 00421000
         ST    @14,@AL00001+4                                      0275 00422000
         LA    @14,DATAHEAD                                        0275 00423000
         ST    @14,@AL00001+8                                      0275 00424000
         L     @14,ZZ2MSGSP(,ZZ2PTR)                               0275 00425000
         ST    @14,@AL00001+12                                     0275 00426000
         LA    @14,@CB01170                                        0275 00427000
         ST    @14,@AL00001+16                                     0275 00428000
         LA    @14,@CF00050                                        0275 00429000
         ST    @14,@AL00001+20                                     0275 00430000
         L     @15,ZZ2MSG0P(,ZZ2PTR)                               0275 00431000
         LA    @01,@AL00001                                        0275 00432000
         BALR  @14,@15                                             0275 00433000
*                     END;          /* BLSDMSG (ZZ2PARM,PUTID,DATAHEA   00434000
*                                      D,BLSDMSGS) ROUTE(BOTH) OUTPUT   00435000
*                                      WHATEVER IS IN THE DATA QUEUE */ 00436000
*                     DO;           /* BLSDMSG (ZZ2PARM,GETID,MSGHEAD   00437000
*                                      ,BLSDMSGS) LIFO ROUTE(TERM)   */ 00438000
*                       CALL BLSDMSG0(ZZ2PARM,GETID,MSGHEAD,BLSDMSGS,   00439000
*                           '10010000'B,0);/* BUILD MESSAGE          */ 00440000
         L     @14,@PC00001                                        0278 00441000
         ST    @14,@AL00001                                        0278 00442000
         LA    @14,@CF01104                                        0278 00443000
         ST    @14,@AL00001+4                                      0278 00444000
         LA    @14,MSGHEAD                                         0278 00445000
         ST    @14,@AL00001+8                                      0278 00446000
         L     @14,ZZ2MSGSP(,ZZ2PTR)                               0278 00447000
         ST    @14,@AL00001+12                                     0278 00448000
         LA    @14,@CB01164                                        0278 00449000
         ST    @14,@AL00001+16                                     0278 00450000
         LA    @14,@CF00050                                        0278 00451000
         ST    @14,@AL00001+20                                     0278 00452000
         L     @15,ZZ2MSG0P(,ZZ2PTR)                               0278 00453000
         LA    @01,@AL00001                                        0278 00454000
         BALR  @14,@15                                             0278 00455000
*                     END;          /* BLSDMSG (ZZ2PARM,GETID,MSGHEAD   00456000
*                                      ,BLSDMSGS) LIFO ROUTE(TERM) 0279 00457000
*                                      BLSGET ERROR                  */ 00458000
*                     DO;           /* ABEND(GETABEND) DUMP          */ 00459000
*                       RESPECIFY                                  0281 00460000
*                        (GPR01F) RESTRICTED;                      0281 00461000
*                       GPR01F=GETABEND;/* COMP CODE IN REG 1        */ 00462000
         LA    GPR01F,123                                          0282 00463000
*                       GPR01F=GPR01F|'80000000'X;/*               0283 00464000
*                                      DUMP/STEP/DUMPOPTS FLAG       */ 00465000
         O     GPR01F,@CF00065                                     0283 00466000
*                       SVC(13);    /* ISSUE ABEND SVC               */ 00467000
         SVC   13                                                  0284 00468000
*                       RESPECIFY                                  0285 00469000
*                        (GPR01F) UNRESTRICTED;                    0285 00470000
*                     END;          /* ABEND(GETABEND) DUMP ABEND    */ 00471000
*                   END;                                           0287 00472000
*                 ELSE                                             0288 00473000
*                   IF((PDRKRCTY^=PDRSTATC)/* IF FETCH OTHER THAN  0288 00474000
*                                      STATUS RECORD, OR             */ 00475000
*                       |(RETCDE=ZZZFLAGE))/* REACH END OF FILE OF 0288 00476000
*                                      PDR, THEN HAVE FETCHED ALL  0288 00477000
*                                      PROBLEMS                      */ 00478000
*                     THEN                                         0288 00479000
         B     @RC00269                                            0288 00480000
@RF00269 L     @14,STATPTR                                         0288 00481000
         CLC   PDRKRCTY(2,@14),@CC01020                            0288 00482000
         BNE   @RT00288                                            0288 00483000
         C     RETCDE,@CF00053                                     0288 00484000
         BNE   @RF00288                                            0288 00485000
@RT00288 DS    0H                                                  0289 00486000
*                     ENDFLAG=ON;   /* END LOOP                      */ 00487000
         OI    ENDFLAG,B'01000000'                                 0289 00488000
*                   ELSE                                           0290 00489000
*                     DO;                                          0290 00490000
         B     @RC00288                                            0290 00491000
@RF00288 DS    0H                                                  0291 00492000
*                       PDRPID=PDRKPNUM;/* SAVE CURRENT PID          */ 00493000
         L     @14,STATPTR                                         0291 00494000
         MVC   PDRPID(5),PDRKPNUM(@14)                             0291 00495000
*                       LASTCHAR=LASTCHAR+ONE;/* INCREMENT PDRPID BY    00496000
*                                      1 FOR NEXT FETCH              */ 00497000
         IC    @14,LASTCHAR                                        0292 00498000
         LA    @14,1(,@14)                                         0292 00499000
         STC   @14,LASTCHAR                                        0292 00500000
*                       CALL BLSELPCL(ZZ2PARM,LPWAPTR,STATPTR,/* CALL   00501000
*                                      TO CONTINUE LISTPROB        0293 00502000
*                                      PROCESSING                    */ 00503000
*                           PARMTIME,NUMPROBS,PIDCOUNT,DATAHEAD,   0293 00504000
*                           QUEUELNS);                             0293 00505000
         L     @14,@PC00001                                        0293 00506000
         ST    @14,@AL00001                                        0293 00507000
         L     @14,@PC00001+4                                      0293 00508000
         ST    @14,@AL00001+4                                      0293 00509000
         LA    @14,STATPTR                                         0293 00510000
         ST    @14,@AL00001+8                                      0293 00511000
         LA    @14,PARMTIME                                        0293 00512000
         ST    @14,@AL00001+12                                     0293 00513000
         LA    @14,NUMPROBS                                        0293 00514000
         ST    @14,@AL00001+16                                     0293 00515000
         LA    @14,PIDCOUNT                                        0293 00516000
         ST    @14,@AL00001+20                                     0293 00517000
         LA    @14,DATAHEAD                                        0293 00518000
         ST    @14,@AL00001+24                                     0293 00519000
         LA    @14,QUEUELNS                                        0293 00520000
         ST    @14,@AL00001+28                                     0293 00521000
         L     @07,ZZ2DVTP(,ZZ2PTR)                                0293 00522000
         L     @15,DVTLPCLP(,@07)                                  0293 00523000
         LA    @01,@AL00001                                        0293 00524000
         BALR  @14,@15                                             0293 00525000
*                       MAXRETC=MAX(MAXRETC,RETCDE);/* SET MAXIMUM 0294 00526000
*                                      RETURN CODE                   */ 00527000
         CR    MAXRETC,RETCDE                                      0294 00528000
         BNL   *+6                                                      00529000
         LR    MAXRETC,RETCDE                                      0294 00530000
*                       IF RETCDE=ZZZFLAGS/* IF RETURN CODE = 12     */ 00531000
*                         THEN                                     0295 00532000
         C     RETCDE,@CF00034                                     0295 00533000
         BNE   @RF00295                                            0295 00534000
*                         ENDFLAG=ON;/* END LOOP                     */ 00535000
         OI    ENDFLAG,B'01000000'                                 0296 00536000
*                       ELSE                                       0297 00537000
*                         ;                                        0297 00538000
@RF00295 DS    0H                                                  0298 00539000
*                     END;                                         0298 00540000
*               END;                                               0299 00541000
@RC00288 DS    0H                                                  0299 00542000
@RC00269 DS    0H                                                  0300 00543000
*           END;                                                   0300 00544000
@RC00213 DS    0H                                                  0300 00545000
@DE00212 TM    ENDFLAG,B'01000000'                                 0300 00546000
         BZ    @DL00212                                            0300 00547000
*         END;                                                     0301 00548000
*                                                                  0301 00549000
*       /*************************************************************/ 00550000
*       /*                                                           */ 00551000
*       /* PROCESSING FOR NO PROBLEM SPECIFIED                       */ 00552000
*       /*                                                           */ 00553000
*       /*************************************************************/ 00554000
*                                                                  0302 00555000
*       ELSE                                                       0302 00556000
*         IF LPPRBPTR=DEFPTR        /* IF NO PROBLEM SPECIFIED       */ 00557000
*           THEN                                                   0302 00558000
         B     @RC00209                                            0302 00559000
@RF00209 L     @14,@PC00001+4                                      0302 00560000
         L     @14,LPWAPTR(,@14)                                   0302 00561000
         L     @14,LPPRBPTR(,@14)                                  0302 00562000
         LTR   @14,@14                                             0302 00563000
         BNZ   @RF00302                                            0302 00564000
*           DO;                                                    0303 00565000
*             IF ZZ1EVEP=ON         /* IF ATTENTION KEY HAS BEEN   0304 00566000
*                                      POSTED                        */ 00567000
*               THEN                                               0304 00568000
         L     @14,ZZ2ZZ1P(,ZZ2PTR)                                0304 00569000
         TM    ZZ1EVEP(@14),B'01000000'                            0304 00570000
         BNO   @RF00304                                            0304 00571000
*               DO;                                                0305 00572000
*                 MAXRETC=ZZZFLAGS; /* RETURN CODE = 12              */ 00573000
         LA    MAXRETC,12                                          0306 00574000
*                 ZZ1EVEP=OFF;      /* TURN OFF POST BIT             */ 00575000
         L     @07,ZZ1EVEP(,@14)                                   0307 00576000
@GL00007 LR    @04,@07                                             0307 00577000
         N     @04,@CF01233                                        0307 00578000
         CS    @07,@04,ZZ1EVEP(@14)                                0307 00579000
         BNE   @GL00007                                            0307 00580000
*               END;                                               0308 00581000
*             ELSE                                                 0309 00582000
*               DO;                                                0309 00583000
         B     @RC00304                                            0309 00584000
@RF00304 DS    0H                                                  0310 00585000
*                 IF ZZ2APID^=ZZZNPROB/* IF DEFAULT PID IS NOT       */ 00586000
*                   THEN                                           0310 00587000
         CLC   ZZ2APID(8,ZZ2PTR),@CC00108                          0310 00588000
         BE    @RF00310                                            0310 00589000
*                   DO;             /* NULL THEN                     */ 00590000
*                     PDRPID=ZZ2APIDB;/* PID TO BE FETCHED IS DEFAULT   00591000
*                                      PID                           */ 00592000
*                                                                  0312 00593000
         MVC   PDRPID(5),ZZ2APIDB(ZZ2PTR)                          0312 00594000
*                     /***********************************************/ 00595000
*                     /*                                             */ 00596000
*                     /* BLSGET (ZZ1PDRP)                            */ 00597000
*                     /* AREAL(STATPTR)AREALEN(LENGTH(BUFFER))GENEQ  */ 00598000
*                     /* ARG(SRCHKEY)ARGLEN(KEYLN)                   */ 00599000
*                     /*                                             */ 00600000
*                     /***********************************************/ 00601000
*                                                                  0313 00602000
*                     DO;           /* BLSGET (ZZ1PDRP) AREAL(STATPTR   00603000
*                                      )AREALEN(LENGTH(BUFFER))GENEQ    00604000
*                                      ARG(SRCHKEY)ARGLEN(KEYLN)     */ 00605000
*                       RFY                                        0314 00606000
*                         GPR01P RSTD;                             0314 00607000
*                       GPR01P=ZZ1PDRP;/* ADDRESS DMCB               */ 00608000
         L     @14,ZZ2ZZ1P(,ZZ2PTR)                                0315 00609000
         L     GPR01P,ZZ1PDRP(,@14)                                0315 00610000
*                       RFY                                        0316 00611000
*                         DMCB BASED(GPR01P);                      0316 00612000
*                       IF((GPR01P&'FFFFFFF8'X)=GPR01P)&DMCBID='DMCB'   00613000
*                                   /* VALID DMCB ?                  */ 00614000
*                         THEN                                     0317 00615000
         LR    @14,GPR01P                                          0317 00616000
         N     @14,@CF01160                                        0317 00617000
         CLR   @14,GPR01P                                          0317 00618000
         BNE   @RF00317                                            0317 00619000
         CLC   DMCBID(4,GPR01P),@CC01161                           0317 00620000
         BNE   @RF00317                                            0317 00621000
*                         DO;                                      0318 00622000
*                           DMCBBUFP=STATPTR&'7FFFFFFF'X;/* PLACE  0319 00623000
*                                      BUFFER ADDRESS IN DMCB        */ 00624000
         L     @14,STATPTR                                         0319 00625000
         N     @14,@CF01168                                        0319 00626000
         ST    @14,DMCBBUFP(,GPR01P)                               0319 00627000
*                           DMCBBLEN=LENGTH(BUFFER)&'7FFFFFFF'X;/* 0320 00628000
*                                      PLACE BUFFER LENGTH IN DMCB   */ 00629000
         MVC   DMCBBLEN(4,GPR01P),@CF01213                         0320 00630000
*                           DMCBKEYP=ADDR(SRCHKEY);/* PLACE KEY    0321 00631000
*                                      ADDRESS IN DMCB               */ 00632000
         LA    @14,SRCHKEY                                         0321 00633000
         ST    @14,DMCBKEYP(,GPR01P)                               0321 00634000
*                           DMCBKEYL=(KEYLN)&'7FFFFFFF'X;/* PLACE KEY   00635000
*                                      LENGTH IN DMCB                */ 00636000
         MVC   DMCBKEYL(4,GPR01P),@CF00035                         0322 00637000
*                           DMCBKYD='1'B;/* INDICATE KEYED ACCESS    */ 00638000
*                           DMCBGKY='1'B;/* INDICATE GENERIC KEY     */ 00639000
*                           DMCBAPX='0'B;/* INDICATE EXACT KEY MATCH */ 00640000
*                           DMCBUPD='0'B;/* DEFAULT FOR GET IS NUP   */ 00641000
         OI    DMCBKYD(GPR01P),B'11000000'                         0326 00642000
         NI    DMCBAPX(GPR01P),B'11001111'                         0326 00643000
*                           DMCBRQST=DMCBGER;/* INDICATE GET REQUEST */ 00644000
         MVI   DMCBRQST(GPR01P),X'04'                              0327 00645000
*                           CALL DMCBRI->DMCBDMGR;/* CALL BLSCRQST   */ 00646000
         L     @15,DMCBRI(,GPR01P)                                 0328 00647000
         BALR  @14,@15                                             0328 00648000
*                         END;                                     0329 00649000
*                       ELSE                                       0330 00650000
*                         DO;                                      0330 00651000
         B     @RC00317                                            0330 00652000
@RF00317 DS    0H                                                  0331 00653000
*                           RFY                                    0331 00654000
*                            (GPR00F,                              0331 00655000
*                             GPR15F) RSTD;                        0331 00656000
*                           GPR00F=0;/* INDICATE NO MESSAGE CHAIN    */ 00657000
         SLR   GPR00F,GPR00F                                       0332 00658000
*                           GPR15F=16;/* INDICATE INVALID DMCB       */ 00659000
         LA    GPR15F,16                                           0333 00660000
*                           RFY                                    0334 00661000
*                            (GPR00F,                              0334 00662000
*                             GPR15F);                             0334 00663000
*                         END;                                     0335 00664000
*                       RFY                                        0336 00665000
*                         DMCB;                                    0336 00666000
@RC00317 DS    0H                                                  0337 00667000
*                       RFY                                        0337 00668000
*                         GPR01P;                                  0337 00669000
*                     END;          /* BLSGET (ZZ1PDRP) AREAL(STATPTR   00670000
*                                      )AREALEN(LENGTH(BUFFER))GENEQ    00671000
*                                      ARG(SRCHKEY)ARGLEN(KEYLN)   0338 00672000
*                                      FETCH STATUS RECORD           */ 00673000
*                     IF RETCDE=ZZZFLAGE/* IF RETURN CODE = 8        */ 00674000
*                       THEN                                       0339 00675000
         C     RETCDE,@CF00053                                     0339 00676000
         BNE   @RF00339                                            0339 00677000
*                       DO;                                        0340 00678000
*                         MSGHEAD=ZERO;/* SET MSG HEADER TO 0        */ 00679000
         SLR   @14,@14                                             0341 00680000
         ST    @14,MSGHEAD                                         0341 00681000
*                         DO;       /* BLSDMSG (ZZ2PARM,INVDEFID,MSGH   00682000
*                                      EAD,BLSDMSGS) ROUTE(TERM)INSER   00683000
*                                      T(FPPIDP,ZZ2APIDB)            */ 00684000
*                           IOPTLIST(1)=ADDR(IOPTLIST(4));/* CHAIN TO   00685000
*                                      NEXT INSERT                   */ 00686000
         LA    @04,IOPTLIST+12                                     0343 00687000
         ST    @04,IOPTLIST                                        0343 00688000
*                           IOPTLIST(2)=ADDR(FPPIDP);/* INSERT NAME     00689000
*                                      POINTER                       */ 00690000
         L     @04,ZZ2ZZ1P(,ZZ2PTR)                                0344 00691000
         L     @04,ZZ1FPP(,@04)                                    0344 00692000
         LA    @04,FPPIDP(,@04)                                    0344 00693000
         ST    @04,IOPTLIST+4                                      0344 00694000
*                           IOPTLIST(3)=0;/* ZERO RESERVED FIELD     */ 00695000
         ST    @14,IOPTLIST+8                                      0345 00696000
*                           RFY                                    0346 00697000
*                             I015F BASED(ADDR(IOPTLIST(3)));/*    0346 00698000
*                                      ACCESS BYTES 1-2              */ 00699000
*                           I015F=LENGTH(FPPIDP);/* INSERT LENGTH    */ 00700000
         LA    @04,IOPTLIST+8                                      0347 00701000
         MVC   I015F(2,@04),@CH00098                               0347 00702000
*                           IOPTLIST(4)=0;/* LAST INSERT             */ 00703000
         ST    @14,IOPTLIST+12                                     0348 00704000
*                           IOPTLIST(5)=ADDR(ZZ2APIDB);/* INSERT NAME   00705000
*                                      POINTER                       */ 00706000
         LA    @04,ZZ2APIDB(,ZZ2PTR)                               0349 00707000
         ST    @04,IOPTLIST+16                                     0349 00708000
*                           IOPTLIST(6)=0;/* ZERO RESERVED FIELD     */ 00709000
         ST    @14,IOPTLIST+20                                     0350 00710000
*                           RFY                                    0351 00711000
*                             I015F BASED(ADDR(IOPTLIST(6)));/*    0351 00712000
*                                      ACCESS BYTES 1-2              */ 00713000
*                           I015F=LENGTH(ZZ2APIDB);/* INSERT LENGTH  */ 00714000
         LA    @14,IOPTLIST+20                                     0352 00715000
         MVC   I015F(2,@14),@CH00095                               0352 00716000
*                           CALL BLSDMSG0(ZZ2PARM,INVDEFID,MSGHEAD,     00717000
*                               BLSDMSGS,'00010000'B,ADDR(IOPTLIST));   00718000
         L     @14,@PC00001                                        0353 00719000
         ST    @14,@AL00001                                        0353 00720000
         LA    @14,@CF01112                                        0353 00721000
         ST    @14,@AL00001+4                                      0353 00722000
         LA    @14,MSGHEAD                                         0353 00723000
         ST    @14,@AL00001+8                                      0353 00724000
         L     @14,ZZ2MSGSP(,ZZ2PTR)                               0353 00725000
         ST    @14,@AL00001+12                                     0353 00726000
         LA    @14,@CB01179                                        0353 00727000
         ST    @14,@AL00001+16                                     0353 00728000
         LA    @14,IOPTLIST                                        0353 00729000
         ST    @14,@AFTEMPS                                        0353 00730000
         LA    @14,@AFTEMPS                                        0353 00731000
         ST    @14,@AL00001+20                                     0353 00732000
         L     @15,ZZ2MSG0P(,ZZ2PTR)                               0353 00733000
         LA    @01,@AL00001                                        0353 00734000
         BALR  @14,@15                                             0353 00735000
*                                   /* BUILD MESSAGE                 */ 00736000
*                         END;      /* BLSDMSG (ZZ2PARM,INVDEFID,MSGH   00737000
*                                      EAD,BLSDMSGS) ROUTE(TERM)INSER   00738000
*                                      T(FPPIDP,ZZ2APIDB) AND OUTPUT    00739000
*                                      MESSAGE 'DEFAULT PROBLEM NOT     00740000
*                                      FOUND IN PDR'                 */ 00741000
*                         MSGHEAD=ZZ1PDRP->DMCBMSG;/* SET MSG HEADER    00742000
*                                      POINTER                       */ 00743000
         L     @14,ZZ2ZZ1P(,ZZ2PTR)                                0355 00744000
         L     @14,ZZ1PDRP(,@14)                                   0355 00745000
         L     @14,DMCBMSG(,@14)                                   0355 00746000
         ST    @14,MSGHEAD                                         0355 00747000
*                         DO;       /* BLSDMSG (ZZ2PARM,PUTID,MSGHEAD   00748000
*                                      ,BLSDMSGS)                    */ 00749000
*                           CALL BLSDMSG0(ZZ2PARM,PUTID,MSGHEAD,   0357 00750000
*                               BLSDMSGS,'00000000'B,0);/* BUILD   0357 00751000
*                                      MESSAGE                       */ 00752000
         L     @14,@PC00001                                        0357 00753000
         ST    @14,@AL00001                                        0357 00754000
         LA    @14,@CF01124                                        0357 00755000
         ST    @14,@AL00001+4                                      0357 00756000
         LA    @14,MSGHEAD                                         0357 00757000
         ST    @14,@AL00001+8                                      0357 00758000
         L     @14,ZZ2MSGSP(,ZZ2PTR)                               0357 00759000
         ST    @14,@AL00001+12                                     0357 00760000
         LA    @14,@CB01180                                        0357 00761000
         ST    @14,@AL00001+16                                     0357 00762000
         LA    @14,@CF00050                                        0357 00763000
         ST    @14,@AL00001+20                                     0357 00764000
         L     @15,ZZ2MSG0P(,ZZ2PTR)                               0357 00765000
         LA    @01,@AL00001                                        0357 00766000
         BALR  @14,@15                                             0357 00767000
*                         END;      /* BLSDMSG (ZZ2PARM,PUTID,MSGHEAD   00768000
*                                      ,BLSDMSGS) AND THROW OUT DAS     00769000
*                                      MESSAGES                      */ 00770000
*                         MAXRETC=ZZZFLAGE;/* RETURN CODE = 8        */ 00771000
         LA    MAXRETC,8                                           0359 00772000
*                       END;                                       0360 00773000
*                     ELSE                                         0361 00774000
*                       IF RETCDE^=ZZZFLAGI/* IF RETURN CODE ^= 0    */ 00775000
*                         THEN                                     0361 00776000
         B     @RC00339                                            0361 00777000
@RF00339 SLR   @14,@14                                             0361 00778000
         CR    RETCDE,@14                                          0361 00779000
         BE    @RF00361                                            0361 00780000
*                         DO;                                      0362 00781000
*                           IF RETCDE=ZZZFLAGT/* IF RETURN CODE=16   */ 00782000
*                             THEN                                 0363 00783000
         C     RETCDE,@CF00056                                     0363 00784000
         BNE   @RF00363                                            0363 00785000
*                             MSGHEAD=ZERO;/* OUTPUT 1 ERROR MSG     */ 00786000
         ST    @14,MSGHEAD                                         0364 00787000
*                           ELSE                                   0365 00788000
*                             MSGHEAD=ZZ1PDRP->DMCBMSG;/* ELSE OUTPUT   00789000
*                                      MSG CHAIN                     */ 00790000
         B     @RC00363                                            0365 00791000
@RF00363 L     @14,ZZ2ZZ1P(,ZZ2PTR)                                0365 00792000
         L     @14,ZZ1PDRP(,@14)                                   0365 00793000
         L     @14,DMCBMSG(,@14)                                   0365 00794000
         ST    @14,MSGHEAD                                         0365 00795000
*                           DO;     /* BLSDMSG (ZZ2PARM,GETID,MSGHEAD   00796000
*                                      ,BLSDMSGS) LIFO ROUTE(TERM)   */ 00797000
@RC00363 DS    0H                                                  0367 00798000
*                             CALL BLSDMSG0(ZZ2PARM,GETID,MSGHEAD, 0367 00799000
*                                 BLSDMSGS,'10010000'B,0);/* BUILD 0367 00800000
*                                      MESSAGE                       */ 00801000
         L     @14,@PC00001                                        0367 00802000
         ST    @14,@AL00001                                        0367 00803000
         LA    @14,@CF01104                                        0367 00804000
         ST    @14,@AL00001+4                                      0367 00805000
         LA    @14,MSGHEAD                                         0367 00806000
         ST    @14,@AL00001+8                                      0367 00807000
         L     @14,ZZ2MSGSP(,ZZ2PTR)                               0367 00808000
         ST    @14,@AL00001+12                                     0367 00809000
         LA    @14,@CB01164                                        0367 00810000
         ST    @14,@AL00001+16                                     0367 00811000
         LA    @14,@CF00050                                        0367 00812000
         ST    @14,@AL00001+20                                     0367 00813000
         L     @15,ZZ2MSG0P(,ZZ2PTR)                               0367 00814000
         LA    @01,@AL00001                                        0367 00815000
         BALR  @14,@15                                             0367 00816000
*                           END;    /* BLSDMSG (ZZ2PARM,GETID,MSGHEAD   00817000
*                                      ,BLSDMSGS) LIFO ROUTE(TERM) 0368 00818000
*                                      BLSGET ERROR                  */ 00819000
*                           DO;     /* ABEND(GETABEND) DUMP          */ 00820000
*                             RESPECIFY                            0370 00821000
*                              (GPR01F) RESTRICTED;                0370 00822000
*                             GPR01F=GETABEND;/* COMP CODE IN REG 1  */ 00823000
         LA    GPR01F,123                                          0371 00824000
*                             GPR01F=GPR01F|'80000000'X;           0372 00825000
*                                                                  0372 00826000
         O     GPR01F,@CF00065                                     0372 00827000
*/* DUMP/STEP/DUMPOPTS FLAG                                          */ 00828000
*                                                                  0373 00829000
*                             SVC(13);/* ISSUE ABEND SVC             */ 00830000
         SVC   13                                                  0373 00831000
*                             RESPECIFY                            0374 00832000
*                              (GPR01F) UNRESTRICTED;              0374 00833000
*                           END;    /* ABEND(GETABEND) DUMP ABEND    */ 00834000
*                         END;                                     0376 00835000
*                       ELSE                                       0377 00836000
*                         DO;                                      0377 00837000
         B     @RC00361                                            0377 00838000
@RF00361 DS    0H                                                  0378 00839000
*                           CALL BLSELPCL(ZZ2PARM,LPWAPTR,STATPTR, 0378 00840000
*                               PARMTIME,NUMPROBS,PIDCOUNT,DATAHEAD,    00841000
*                               QUEUELNS);/* CALL TO CONTINUE      0378 00842000
*                                      LISTPROB PROCESSING           */ 00843000
         L     @14,@PC00001                                        0378 00844000
         ST    @14,@AL00001                                        0378 00845000
         L     @14,@PC00001+4                                      0378 00846000
         ST    @14,@AL00001+4                                      0378 00847000
         LA    @14,STATPTR                                         0378 00848000
         ST    @14,@AL00001+8                                      0378 00849000
         LA    @14,PARMTIME                                        0378 00850000
         ST    @14,@AL00001+12                                     0378 00851000
         LA    @14,NUMPROBS                                        0378 00852000
         ST    @14,@AL00001+16                                     0378 00853000
         LA    @14,PIDCOUNT                                        0378 00854000
         ST    @14,@AL00001+20                                     0378 00855000
         LA    @14,DATAHEAD                                        0378 00856000
         ST    @14,@AL00001+24                                     0378 00857000
         LA    @14,QUEUELNS                                        0378 00858000
         ST    @14,@AL00001+28                                     0378 00859000
         L     @07,ZZ2DVTP(,ZZ2PTR)                                0378 00860000
         L     @15,DVTLPCLP(,@07)                                  0378 00861000
         LA    @01,@AL00001                                        0378 00862000
         BALR  @14,@15                                             0378 00863000
*                           MAXRETC=RETCDE;/* RETURN CODE=0,8, OR 12 */ 00864000
         LR    MAXRETC,RETCDE                                      0379 00865000
*                         END;                                     0380 00866000
*                   END;                                           0381 00867000
*                 ELSE                                             0382 00868000
*                   DO;                                            0382 00869000
         B     @RC00310                                            0382 00870000
@RF00310 DS    0H                                                  0383 00871000
*                     DO;           /* BLSDMSG (ZZ2PARM,NODEFID,MSGHE   00872000
*                                      AD,BLSDMSGS) ROUTE(TERM)      */ 00873000
*                       CALL BLSDMSG0(ZZ2PARM,NODEFID,MSGHEAD,BLSDMSGS, 00874000
*                           '00010000'B,0);/* BUILD MESSAGE          */ 00875000
         L     @14,@PC00001                                        0384 00876000
         ST    @14,@AL00001                                        0384 00877000
         LA    @14,@CF01114                                        0384 00878000
         ST    @14,@AL00001+4                                      0384 00879000
         LA    @14,MSGHEAD                                         0384 00880000
         ST    @14,@AL00001+8                                      0384 00881000
         L     @14,ZZ2MSGSP(,ZZ2PTR)                               0384 00882000
         ST    @14,@AL00001+12                                     0384 00883000
         LA    @14,@CB01179                                        0384 00884000
         ST    @14,@AL00001+16                                     0384 00885000
         LA    @14,@CF00050                                        0384 00886000
         ST    @14,@AL00001+20                                     0384 00887000
         L     @15,ZZ2MSG0P(,ZZ2PTR)                               0384 00888000
         LA    @01,@AL00001                                        0384 00889000
         BALR  @14,@15                                             0384 00890000
*                     END;          /* BLSDMSG (ZZ2PARM,NODEFID,MSGHE   00891000
*                                      AD,BLSDMSGS) ROUTE(TERM) NO 0385 00892000
*                                      PID SPECIFIED AND NO DEFAULT     00893000
*                                      EXISTS                        */ 00894000
*                     MAXRETC=ZZZFLAGE;/* RETURN CODE = 8            */ 00895000
         LA    MAXRETC,8                                           0386 00896000
*                   END;                                           0387 00897000
*               END;                                               0388 00898000
*           END;                                                   0389 00899000
*                                                                  0389 00900000
*       /*************************************************************/ 00901000
*       /*                                                           */ 00902000
*       /* PROCESSING FOR A LIST OF PROBLEMS AND RANGES              */ 00903000
*       /*                                                           */ 00904000
*       /*************************************************************/ 00905000
*                                                                  0390 00906000
*         ELSE                                                     0390 00907000
*           DO WHILE(ENDFLAG=OFF);  /* DO WHILE NO ERRORS HAVE     0390 00908000
*                                      OCCURRED AND PTR TO NEXT PDE     00909000
*                                      ^= 'FF000000'X                */ 00910000
         B     @RC00302                                            0390 00911000
@RF00302 B     @DE00390                                            0390 00912000
@DL00390 DS    0H                                                  0391 00913000
*             FULPRBI1=ZEROPROB;    /* FULPRBI1 = RANGE ORIGIN PADDED   00914000
*                                      ON LEFT WITH ZEROES           */ 00915000
         MVC   FULPRBI1(5),@CC01080                                0391 00916000
*             FULPRBI1(ZZZPRNUL-PRBIL(ONE)+ONE:ZZZPRNUL)=PRBI1(ONE:     00917000
*                 PRBIL(ONE));                                     0392 00918000
         L     @14,@PC00001+4                                      0392 00919000
         L     @14,LPWAPTR(,@14)                                   0392 00920000
         L     @14,LPPRBPTR(,@14)                                  0392 00921000
         LH    @07,PRBIL(,@14)                                     0392 00922000
         LA    @04,5                                               0392 00923000
         SLR   @04,@07                                             0392 00924000
         LA    @01,FULPRBI1(@04)                                   0392 00925000
         LCR   @07,@07                                             0392 00926000
         AL    @07,@CF00095                                        0392 00927000
         LCR   @07,@07                                             0392 00928000
         AL    @07,@CF00042                                        0392 00929000
         L     @04,PRBIP(,@14)                                     0392 00930000
         EX    @07,@SM01237                                        0392 00931000
*             PDRPID=FULPRBI1;      /* STORE PID TO BE FETCHED IN  0393 00932000
*                                      SEARCH KEY                    */ 00933000
*                                                                  0393 00934000
         MVC   PDRPID(5),FULPRBI1                                  0393 00935000
*             /*******************************************************/ 00936000
*             /*                                                     */ 00937000
*             /* PROCESSING FOR A SINGLE PROBLEM IN A LIST           */ 00938000
*             /*                                                     */ 00939000
*             /*******************************************************/ 00940000
*                                                                  0394 00941000
*             IF PRBIFP(TWO)=OFF    /* IF NOT A RANGE                */ 00942000
*               THEN                                               0394 00943000
         TM    PRBIFP+8(@14),B'10000000'                           0394 00944000
         BNZ   @RF00394                                            0394 00945000
*               DO;                                                0395 00946000
*                 IF ZZ1EVEP=ON     /* IF ATTENTION KEY HAS BEEN   0396 00947000
*                                      POSTED                        */ 00948000
*                   THEN                                           0396 00949000
         L     @14,ZZ2ZZ1P(,ZZ2PTR)                                0396 00950000
         TM    ZZ1EVEP(@14),B'01000000'                            0396 00951000
         BNO   @RF00396                                            0396 00952000
*                   DO;                                            0397 00953000
*                     MAXRETC=ZZZFLAGS;/* RETURN CODE = 12           */ 00954000
         LA    MAXRETC,12                                          0398 00955000
*                     ZZ1EVEP=OFF;  /* TURN OFF POST BIT             */ 00956000
         L     @07,ZZ1EVEP(,@14)                                   0399 00957000
@GL00009 LR    @04,@07                                             0399 00958000
         N     @04,@CF01233                                        0399 00959000
         CS    @07,@04,ZZ1EVEP(@14)                                0399 00960000
         BNE   @GL00009                                            0399 00961000
*                     ENDFLAG=ON;   /* END LOOP                      */ 00962000
         OI    ENDFLAG,B'01000000'                                 0400 00963000
*                   END;                                           0401 00964000
*                 ELSE                                             0402 00965000
*                   DO;                                            0402 00966000
*                                                                  0402 00967000
         B     @RC00396                                            0402 00968000
@RF00396 DS    0H                                                  0403 00969000
*                     /***********************************************/ 00970000
*                     /*                                             */ 00971000
*                     /* BLSGET (ZZ1PDRP)                            */ 00972000
*                     /* AREAL(STATPTR)AREALEN(LENGTH(BUFFER))GENEQ  */ 00973000
*                     /* ARG(SRCHKEY)ARGLEN(KEYLN)                   */ 00974000
*                     /*                                             */ 00975000
*                     /***********************************************/ 00976000
*                                                                  0403 00977000
*                     DO;           /* BLSGET (ZZ1PDRP) AREAL(STATPTR   00978000
*                                      )AREALEN(LENGTH(BUFFER))GENEQ    00979000
*                                      ARG(SRCHKEY)ARGLEN(KEYLN)     */ 00980000
*                       RFY                                        0404 00981000
*                         GPR01P RSTD;                             0404 00982000
*                       GPR01P=ZZ1PDRP;/* ADDRESS DMCB               */ 00983000
         L     @14,ZZ2ZZ1P(,ZZ2PTR)                                0405 00984000
         L     GPR01P,ZZ1PDRP(,@14)                                0405 00985000
*                       RFY                                        0406 00986000
*                         DMCB BASED(GPR01P);                      0406 00987000
*                       IF((GPR01P&'FFFFFFF8'X)=GPR01P)&DMCBID='DMCB'   00988000
*                                   /* VALID DMCB ?                  */ 00989000
*                         THEN                                     0407 00990000
         LR    @14,GPR01P                                          0407 00991000
         N     @14,@CF01160                                        0407 00992000
         CLR   @14,GPR01P                                          0407 00993000
         BNE   @RF00407                                            0407 00994000
         CLC   DMCBID(4,GPR01P),@CC01161                           0407 00995000
         BNE   @RF00407                                            0407 00996000
*                         DO;                                      0408 00997000
*                           DMCBBUFP=STATPTR&'7FFFFFFF'X;/* PLACE  0409 00998000
*                                      BUFFER ADDRESS IN DMCB        */ 00999000
         L     @14,STATPTR                                         0409 01000000
         N     @14,@CF01168                                        0409 01001000
         ST    @14,DMCBBUFP(,GPR01P)                               0409 01002000
*                           DMCBBLEN=LENGTH(BUFFER)&'7FFFFFFF'X;/* 0410 01003000
*                                      PLACE BUFFER LENGTH IN DMCB   */ 01004000
         MVC   DMCBBLEN(4,GPR01P),@CF01213                         0410 01005000
*                           DMCBKEYP=ADDR(SRCHKEY);/* PLACE KEY    0411 01006000
*                                      ADDRESS IN DMCB               */ 01007000
         LA    @14,SRCHKEY                                         0411 01008000
         ST    @14,DMCBKEYP(,GPR01P)                               0411 01009000
*                           DMCBKEYL=(KEYLN)&'7FFFFFFF'X;/* PLACE KEY   01010000
*                                      LENGTH IN DMCB                */ 01011000
         MVC   DMCBKEYL(4,GPR01P),@CF00035                         0412 01012000
*                           DMCBKYD='1'B;/* INDICATE KEYED ACCESS    */ 01013000
*                           DMCBGKY='1'B;/* INDICATE GENERIC KEY     */ 01014000
*                           DMCBAPX='0'B;/* INDICATE EXACT KEY MATCH */ 01015000
*                           DMCBUPD='0'B;/* DEFAULT FOR GET IS NUP   */ 01016000
         OI    DMCBKYD(GPR01P),B'11000000'                         0416 01017000
         NI    DMCBAPX(GPR01P),B'11001111'                         0416 01018000
*                           DMCBRQST=DMCBGER;/* INDICATE GET REQUEST */ 01019000
         MVI   DMCBRQST(GPR01P),X'04'                              0417 01020000
*                           CALL DMCBRI->DMCBDMGR;/* CALL BLSCRQST   */ 01021000
         L     @15,DMCBRI(,GPR01P)                                 0418 01022000
         BALR  @14,@15                                             0418 01023000
*                         END;                                     0419 01024000
*                       ELSE                                       0420 01025000
*                         DO;                                      0420 01026000
         B     @RC00407                                            0420 01027000
@RF00407 DS    0H                                                  0421 01028000
*                           RFY                                    0421 01029000
*                            (GPR00F,                              0421 01030000
*                             GPR15F) RSTD;                        0421 01031000
*                           GPR00F=0;/* INDICATE NO MESSAGE CHAIN    */ 01032000
         SLR   GPR00F,GPR00F                                       0422 01033000
*                           GPR15F=16;/* INDICATE INVALID DMCB       */ 01034000
         LA    GPR15F,16                                           0423 01035000
*                           RFY                                    0424 01036000
*                            (GPR00F,                              0424 01037000
*                             GPR15F);                             0424 01038000
*                         END;                                     0425 01039000
*                       RFY                                        0426 01040000
*                         DMCB;                                    0426 01041000
@RC00407 DS    0H                                                  0427 01042000
*                       RFY                                        0427 01043000
*                         GPR01P;                                  0427 01044000
*                     END;          /* BLSGET (ZZ1PDRP) AREAL(STATPTR   01045000
*                                      )AREALEN(LENGTH(BUFFER))GENEQ    01046000
*                                      ARG(SRCHKEY)ARGLEN(KEYLN)   0428 01047000
*                                      FETCH STATUS RECORD           */ 01048000
*                     IF RETCDE^=ZZZFLAGI/* IF RETURN CODE ^= 0      */ 01049000
*                       THEN                                       0429 01050000
         SLR   @14,@14                                             0429 01051000
         CR    RETCDE,@14                                          0429 01052000
         BE    @RF00429                                            0429 01053000
*                       IF RETCDE=ZZZFLAGE/* IF RECORD NOT FOUND     */ 01054000
*                         THEN                                     0430 01055000
         C     RETCDE,@CF00053                                     0430 01056000
         BNE   @RF00430                                            0430 01057000
*                         DO;                                      0431 01058000
*                           MSGHEAD=ZERO;/* SET MSG HEADER TO 0      */ 01059000
         ST    @14,MSGHEAD                                         0432 01060000
*                           DO;     /* BLSDMSG (ZZ2PARM,NOPIDID,DATAH   01061000
*                                      EAD,BLSDMSGS)               0433 01062000
*                                      INSERT(FPPIDP,FULPRBI1)       */ 01063000
*                             IOPTLIST(1)=ADDR(IOPTLIST(4));/* CHAIN    01064000
*                                      TO NEXT INSERT                */ 01065000
         LA    @04,IOPTLIST+12                                     0434 01066000
         ST    @04,IOPTLIST                                        0434 01067000
*                             IOPTLIST(2)=ADDR(FPPIDP);/* INSERT NAME   01068000
*                                      POINTER                       */ 01069000
         L     @04,ZZ2ZZ1P(,ZZ2PTR)                                0435 01070000
         L     @04,ZZ1FPP(,@04)                                    0435 01071000
         LA    @04,FPPIDP(,@04)                                    0435 01072000
         ST    @04,IOPTLIST+4                                      0435 01073000
*                             IOPTLIST(3)=0;/* ZERO RESERVED FIELD   */ 01074000
         ST    @14,IOPTLIST+8                                      0436 01075000
*                             RFY                                  0437 01076000
*                               I015F BASED(ADDR(IOPTLIST(3)));/*  0437 01077000
*                                      ACCESS BYTES 1-2              */ 01078000
*                             I015F=LENGTH(FPPIDP);/* INSERT LENGTH  */ 01079000
         LA    @04,IOPTLIST+8                                      0438 01080000
         MVC   I015F(2,@04),@CH00098                               0438 01081000
*                             IOPTLIST(4)=0;/* LAST INSERT           */ 01082000
         ST    @14,IOPTLIST+12                                     0439 01083000
*                             IOPTLIST(5)=ADDR(FULPRBI1);/* INSERT 0440 01084000
*                                      NAME POINTER                  */ 01085000
         LA    @04,FULPRBI1                                        0440 01086000
         ST    @04,IOPTLIST+16                                     0440 01087000
*                             IOPTLIST(6)=0;/* ZERO RESERVED FIELD   */ 01088000
         ST    @14,IOPTLIST+20                                     0441 01089000
*                             RFY                                  0442 01090000
*                               I015F BASED(ADDR(IOPTLIST(6)));/*  0442 01091000
*                                      ACCESS BYTES 1-2              */ 01092000
*                             I015F=LENGTH(FULPRBI1);/* INSERT LENGTH*/ 01093000
         LA    @14,IOPTLIST+20                                     0443 01094000
         MVC   I015F(2,@14),@CH00095                               0443 01095000
*                             CALL BLSDMSG0(ZZ2PARM,NOPIDID,DATAHEAD,   01096000
*                                 BLSDMSGS,'00000000'B,ADDR(IOPTLIST)); 01097000
         L     @14,@PC00001                                        0444 01098000
         ST    @14,@AL00001                                        0444 01099000
         LA    @14,@CF01110                                        0444 01100000
         ST    @14,@AL00001+4                                      0444 01101000
         LA    @14,DATAHEAD                                        0444 01102000
         ST    @14,@AL00001+8                                      0444 01103000
         L     @14,ZZ2MSGSP(,ZZ2PTR)                               0444 01104000
         ST    @14,@AL00001+12                                     0444 01105000
         LA    @14,@CB01180                                        0444 01106000
         ST    @14,@AL00001+16                                     0444 01107000
         LA    @14,IOPTLIST                                        0444 01108000
         ST    @14,@AFTEMPS                                        0444 01109000
         LA    @14,@AFTEMPS                                        0444 01110000
         ST    @14,@AL00001+20                                     0444 01111000
         L     @15,ZZ2MSG0P(,ZZ2PTR)                               0444 01112000
         LA    @01,@AL00001                                        0444 01113000
         BALR  @14,@15                                             0444 01114000
*                                   /* BUILD MESSAGE                 */ 01115000
*                           END;    /* BLSDMSG (ZZ2PARM,NOPIDID,DATAH   01116000
*                                      EAD,BLSDMSGS)               0445 01117000
*                                      INSERT(FPPIDP,FULPRBI1) AND 0445 01118000
*                                      OUTPUT MSG 'INVALID PROBLEM 0445 01119000
*                                      ID'                           */ 01120000
*                           MSGHEAD=ZZ1PDRP->DMCBMSG;/* SET MSG    0446 01121000
*                                      HEADER PTR                    */ 01122000
         L     @14,ZZ2ZZ1P(,ZZ2PTR)                                0446 01123000
         L     @14,ZZ1PDRP(,@14)                                   0446 01124000
         L     @14,DMCBMSG(,@14)                                   0446 01125000
         ST    @14,MSGHEAD                                         0446 01126000
*                           DO;     /* BLSDMSG (ZZ2PARM,PUTID,MSGHEAD   01127000
*                                      ,BLSDMSGS)                    */ 01128000
*                             CALL BLSDMSG0(ZZ2PARM,PUTID,MSGHEAD, 0448 01129000
*                                 BLSDMSGS,'00000000'B,0);/* BUILD 0448 01130000
*                                      MESSAGE                       */ 01131000
         L     @14,@PC00001                                        0448 01132000
         ST    @14,@AL00001                                        0448 01133000
         LA    @14,@CF01124                                        0448 01134000
         ST    @14,@AL00001+4                                      0448 01135000
         LA    @14,MSGHEAD                                         0448 01136000
         ST    @14,@AL00001+8                                      0448 01137000
         L     @14,ZZ2MSGSP(,ZZ2PTR)                               0448 01138000
         ST    @14,@AL00001+12                                     0448 01139000
         LA    @14,@CB01180                                        0448 01140000
         ST    @14,@AL00001+16                                     0448 01141000
         LA    @14,@CF00050                                        0448 01142000
         ST    @14,@AL00001+20                                     0448 01143000
         L     @15,ZZ2MSG0P(,ZZ2PTR)                               0448 01144000
         LA    @01,@AL00001                                        0448 01145000
         BALR  @14,@15                                             0448 01146000
*                           END;    /* BLSDMSG (ZZ2PARM,PUTID,MSGHEAD   01147000
*                                      ,BLSDMSGS) AND THROW OUT DAS     01148000
*                                      MESSAGES                      */ 01149000
*                           ZZ1PDRP->DMCBMSG=ZERO;/* SET MSG AREA PTR   01150000
*                                      TO 0 FOR NEXT USE             */ 01151000
         L     @14,ZZ2ZZ1P(,ZZ2PTR)                                0450 01152000
         L     @14,ZZ1PDRP(,@14)                                   0450 01153000
         SLR   @07,@07                                             0450 01154000
         ST    @07,DMCBMSG(,@14)                                   0450 01155000
*                           MAXRETC=ZZZFLAGE;/* RETURN CODE = 8      */ 01156000
         LA    MAXRETC,8                                           0451 01157000
*                         END;                                     0452 01158000
*                       ELSE                                       0453 01159000
*                         DO;       /* RETURN CODE = 4,12,OR 16      */ 01160000
         B     @RC00430                                            0453 01161000
@RF00430 DS    0H                                                  0454 01162000
*                           IF RETCDE=ZZZFLAGT/* IF RETURN CODE=16   */ 01163000
*                             THEN                                 0454 01164000
         C     RETCDE,@CF00056                                     0454 01165000
         BNE   @RF00454                                            0454 01166000
*                             MSGHEAD=ZERO;/* OUTPUT 1 ERROR MSG     */ 01167000
         SLR   @14,@14                                             0455 01168000
         ST    @14,MSGHEAD                                         0455 01169000
*                           ELSE                                   0456 01170000
*                             MSGHEAD=ZZ1PDRP->DMCBMSG;/* ELSE OUTPUT   01171000
*                                      MSG CHAIN                     */ 01172000
         B     @RC00454                                            0456 01173000
@RF00454 L     @14,ZZ2ZZ1P(,ZZ2PTR)                                0456 01174000
         L     @14,ZZ1PDRP(,@14)                                   0456 01175000
         L     @14,DMCBMSG(,@14)                                   0456 01176000
         ST    @14,MSGHEAD                                         0456 01177000
*                           DO;     /* BLSDMSG (ZZ2PARM,PUTID,DATAHEA   01178000
*                                      D,BLSDMSGS) ROUTE(BOTH)       */ 01179000
@RC00454 DS    0H                                                  0458 01180000
*                             CALL BLSDMSG0(ZZ2PARM,PUTID,DATAHEAD,     01181000
*                                 BLSDMSGS,'00110000'B,0);/* BUILD 0458 01182000
*                                      MESSAGE                       */ 01183000
         L     @14,@PC00001                                        0458 01184000
         ST    @14,@AL00001                                        0458 01185000
         LA    @14,@CF01124                                        0458 01186000
         ST    @14,@AL00001+4                                      0458 01187000
         LA    @14,DATAHEAD                                        0458 01188000
         ST    @14,@AL00001+8                                      0458 01189000
         L     @14,ZZ2MSGSP(,ZZ2PTR)                               0458 01190000
         ST    @14,@AL00001+12                                     0458 01191000
         LA    @14,@CB01170                                        0458 01192000
         ST    @14,@AL00001+16                                     0458 01193000
         LA    @14,@CF00050                                        0458 01194000
         ST    @14,@AL00001+20                                     0458 01195000
         L     @15,ZZ2MSG0P(,ZZ2PTR)                               0458 01196000
         LA    @01,@AL00001                                        0458 01197000
         BALR  @14,@15                                             0458 01198000
*                           END;    /* BLSDMSG (ZZ2PARM,PUTID,DATAHEA   01199000
*                                      D,BLSDMSGS) ROUTE(BOTH) OUTPUT   01200000
*                                      CONTENTS OF DATA QUEUE        */ 01201000
*                           DO;     /* BLSDMSG (ZZ2PARM,GETID,MSGHEAD   01202000
*                                      ,BLSDMSGS) LIFO ROUTE(TERM)   */ 01203000
*                             CALL BLSDMSG0(ZZ2PARM,GETID,MSGHEAD, 0461 01204000
*                                 BLSDMSGS,'10010000'B,0);/* BUILD 0461 01205000
*                                      MESSAGE                       */ 01206000
         L     @14,@PC00001                                        0461 01207000
         ST    @14,@AL00001                                        0461 01208000
         LA    @14,@CF01104                                        0461 01209000
         ST    @14,@AL00001+4                                      0461 01210000
         LA    @14,MSGHEAD                                         0461 01211000
         ST    @14,@AL00001+8                                      0461 01212000
         L     @14,ZZ2MSGSP(,ZZ2PTR)                               0461 01213000
         ST    @14,@AL00001+12                                     0461 01214000
         LA    @14,@CB01164                                        0461 01215000
         ST    @14,@AL00001+16                                     0461 01216000
         LA    @14,@CF00050                                        0461 01217000
         ST    @14,@AL00001+20                                     0461 01218000
         L     @15,ZZ2MSG0P(,ZZ2PTR)                               0461 01219000
         LA    @01,@AL00001                                        0461 01220000
         BALR  @14,@15                                             0461 01221000
*                           END;    /* BLSDMSG (ZZ2PARM,GETID,MSGHEAD   01222000
*                                      ,BLSDMSGS) LIFO ROUTE(TERM) 0462 01223000
*                                      BLSGET ERROR                  */ 01224000
*                           DO;     /* ABEND(GETABEND) DUMP          */ 01225000
*                             RESPECIFY                            0464 01226000
*                              (GPR01F) RESTRICTED;                0464 01227000
*                             GPR01F=GETABEND;/* COMP CODE IN REG 1  */ 01228000
         LA    GPR01F,123                                          0465 01229000
*                             GPR01F=GPR01F|'80000000'X;           0466 01230000
*                                                                  0466 01231000
         O     GPR01F,@CF00065                                     0466 01232000
*/* DUMP/STEP/DUMPOPTS FLAG                                          */ 01233000
*                                                                  0467 01234000
*                             SVC(13);/* ISSUE ABEND SVC             */ 01235000
         SVC   13                                                  0467 01236000
*                             RESPECIFY                            0468 01237000
*                              (GPR01F) UNRESTRICTED;              0468 01238000
*                           END;    /* ABEND(GETABEND) DUMP ABEND    */ 01239000
*                         END;                                     0470 01240000
*                     ELSE                                         0471 01241000
*                       DO;         /* CALL TO CONTINUE LISTPROB   0471 01242000
*                                      PROCESSING                    */ 01243000
         B     @RC00429                                            0471 01244000
@RF00429 DS    0H                                                  0472 01245000
*                         CALL BLSELPCL(ZZ2PARM,LPWAPTR,STATPTR,   0472 01246000
*                             PARMTIME,NUMPROBS,PIDCOUNT,DATAHEAD, 0472 01247000
*                             QUEUELNS);/* CALL CONTROLLER           */ 01248000
         L     @14,@PC00001                                        0472 01249000
         ST    @14,@AL00001                                        0472 01250000
         L     @14,@PC00001+4                                      0472 01251000
         ST    @14,@AL00001+4                                      0472 01252000
         LA    @14,STATPTR                                         0472 01253000
         ST    @14,@AL00001+8                                      0472 01254000
         LA    @14,PARMTIME                                        0472 01255000
         ST    @14,@AL00001+12                                     0472 01256000
         LA    @14,NUMPROBS                                        0472 01257000
         ST    @14,@AL00001+16                                     0472 01258000
         LA    @14,PIDCOUNT                                        0472 01259000
         ST    @14,@AL00001+20                                     0472 01260000
         LA    @14,DATAHEAD                                        0472 01261000
         ST    @14,@AL00001+24                                     0472 01262000
         LA    @14,QUEUELNS                                        0472 01263000
         ST    @14,@AL00001+28                                     0472 01264000
         L     @07,ZZ2DVTP(,ZZ2PTR)                                0472 01265000
         L     @15,DVTLPCLP(,@07)                                  0472 01266000
         LA    @01,@AL00001                                        0472 01267000
         BALR  @14,@15                                             0472 01268000
*                         MAXRETC=MAX(MAXRETC,RETCDE);/* SET MAXIMUM    01269000
*                                      RETURN CODE                   */ 01270000
         CR    MAXRETC,RETCDE                                      0473 01271000
         BNL   *+6                                                      01272000
         LR    MAXRETC,RETCDE                                      0473 01273000
*                         IF RETCDE=ZZZFLAGS/* IF RETURN CODE = 12   */ 01274000
*                           THEN                                   0474 01275000
         C     RETCDE,@CF00034                                     0474 01276000
         BNE   @RF00474                                            0474 01277000
*                           ENDFLAG=ON;/* END LOOP                   */ 01278000
         OI    ENDFLAG,B'01000000'                                 0475 01279000
*                         ELSE                                     0476 01280000
*                           ;                                      0476 01281000
@RF00474 DS    0H                                                  0477 01282000
*                       END;                                       0477 01283000
*                   END;                                           0478 01284000
*               END;                                               0479 01285000
*                                                                  0479 01286000
*             /*******************************************************/ 01287000
*             /*                                                     */ 01288000
*             /* PROCESSING FOR A RANGE WITHIN A LIST                */ 01289000
*             /*                                                     */ 01290000
*             /*******************************************************/ 01291000
*                                                                  0480 01292000
*             ELSE                                                 0480 01293000
*               DO;                                                0480 01294000
         B     @RC00394                                            0480 01295000
@RF00394 DS    0H                                                  0481 01296000
*                 FULPRBI2=ZEROPROB;/* FULPRBI2 = RANGE END PADDED ON   01297000
*                                      LEFT WITH ZEROES              */ 01298000
         MVC   FULPRBI2(5),@CC01080                                0481 01299000
*                 FULPRBI2(ZZZPRNUL-PRBIL(TWO)+ONE:ZZZPRNUL)=PRBI2(ONE: 01300000
*                     PRBIL(TWO));                                 0482 01301000
         L     @14,@PC00001+4                                      0482 01302000
         L     @14,LPWAPTR(,@14)                                   0482 01303000
         L     @14,LPPRBPTR(,@14)                                  0482 01304000
         LH    @07,PRBIL+8(,@14)                                   0482 01305000
         LA    @04,5                                               0482 01306000
         SLR   @04,@07                                             0482 01307000
         LA    @01,FULPRBI2(@04)                                   0482 01308000
         LCR   @07,@07                                             0482 01309000
         AL    @07,@CF00095                                        0482 01310000
         LCR   @07,@07                                             0482 01311000
         AL    @07,@CF00042                                        0482 01312000
         L     @14,PRBIP+8(,@14)                                   0482 01313000
         EX    @07,@SM01239                                        0482 01314000
*                 RANGEND=OFF;      /* TURN OFF FLAG INDICATING RANGE   01315000
*                                      END WAS REACHED               */ 01316000
         NI    RANGEND,B'11101111'                                 0483 01317000
*                 DO WHILE(ENDFLAG=OFF&/* DO WHILE NO ERRORS         */ 01318000
*                       RANGEND=OFF);/* AND HAVE NOT FETCHED BEYOND     01319000
*                                      RANGE END                     */ 01320000
         B     @DE00484                                            0484 01321000
@DL00484 DS    0H                                                  0485 01322000
*                   IF ZZ1EVEP=ON   /* IF ATTENTION KEY HAS BEEN   0485 01323000
*                                      POSTED                        */ 01324000
*                     THEN                                         0485 01325000
         L     @14,ZZ2ZZ1P(,ZZ2PTR)                                0485 01326000
         TM    ZZ1EVEP(@14),B'01000000'                            0485 01327000
         BNO   @RF00485                                            0485 01328000
*                     DO;                                          0486 01329000
*                       MAXRETC=ZZZFLAGS;/* RETURN CODE =12          */ 01330000
         LA    MAXRETC,12                                          0487 01331000
*                       ZZ1EVEP=OFF;/* TURN OFF POST BIT             */ 01332000
         L     @07,ZZ1EVEP(,@14)                                   0488 01333000
@GL00011 LR    @04,@07                                             0488 01334000
         N     @04,@CF01233                                        0488 01335000
         CS    @07,@04,ZZ1EVEP(@14)                                0488 01336000
         BNE   @GL00011                                            0488 01337000
*                       ENDFLAG=ON; /* END LOOP                      */ 01338000
         OI    ENDFLAG,B'01000000'                                 0489 01339000
*                     END;                                         0490 01340000
*                   ELSE                                           0491 01341000
*                     DO;           /* DO A DIRECT FETCH BLSGET    0491 01342000
*                                      (ZZ1PDRP) AREAL(STATPTR)AREALE   01343000
*                                      N(LENGTH(BUFFER))GENGE      0491 01344000
*                                      ARG(SRCHKEY)ARGLEN(KEYLN)     */ 01345000
         B     @RC00485                                            0491 01346000
@RF00485 DS    0H                                                  0492 01347000
*                       DO;         /* BLSGET (ZZ1PDRP) AREAL(STATPTR   01348000
*                                      )AREALEN(LENGTH(BUFFER))GENGE    01349000
*                                      ARG(SRCHKEY)ARGLEN(KEYLN)     */ 01350000
*                         RFY                                      0493 01351000
*                           GPR01P RSTD;                           0493 01352000
*                         GPR01P=ZZ1PDRP;/* ADDRESS DMCB             */ 01353000
         L     @14,ZZ2ZZ1P(,ZZ2PTR)                                0494 01354000
         L     GPR01P,ZZ1PDRP(,@14)                                0494 01355000
*                         RFY                                      0495 01356000
*                           DMCB BASED(GPR01P);                    0495 01357000
*                         IF((GPR01P&'FFFFFFF8'X)=GPR01P)&DMCBID='DMCB' 01358000
*                                                                  0496 01359000
*/*  VALID DMCB ?                                                    */ 01360000
*                                                                  0496 01361000
*                           THEN                                   0496 01362000
         LR    @14,GPR01P                                          0496 01363000
         N     @14,@CF01160                                        0496 01364000
         CLR   @14,GPR01P                                          0496 01365000
         BNE   @RF00496                                            0496 01366000
         CLC   DMCBID(4,GPR01P),@CC01161                           0496 01367000
         BNE   @RF00496                                            0496 01368000
*                           DO;                                    0497 01369000
*                             DMCBBUFP=STATPTR&'7FFFFFFF'X;/* PLACE     01370000
*                                      BUFFER ADDRESS IN DMCB        */ 01371000
         L     @14,STATPTR                                         0498 01372000
         N     @14,@CF01168                                        0498 01373000
         ST    @14,DMCBBUFP(,GPR01P)                               0498 01374000
*                             DMCBBLEN=LENGTH(BUFFER)&'7FFFFFFF'X;/*    01375000
*                                      PLACE BUFFER LENGTH IN DMCB   */ 01376000
         MVC   DMCBBLEN(4,GPR01P),@CF01213                         0499 01377000
*                             DMCBKEYP=ADDR(SRCHKEY);/* PLACE KEY  0500 01378000
*                                      ADDRESS IN DMCB               */ 01379000
         LA    @14,SRCHKEY                                         0500 01380000
         ST    @14,DMCBKEYP(,GPR01P)                               0500 01381000
*                             DMCBKEYL=(KEYLN)&'7FFFFFFF'X;/* PLACE     01382000
*                                      KEY LENGTH IN DMCB            */ 01383000
         MVC   DMCBKEYL(4,GPR01P),@CF00035                         0501 01384000
*                             DMCBKYD='1'B;/* INDICATE KEYED ACCESS  */ 01385000
*                             DMCBGKY='1'B;/* INDICATE GENERIC KEY   */ 01386000
*                             DMCBAPX='1'B;/* INDICATE APROX MATCH   */ 01387000
*                             DMCBUPD='0'B;/* DEFAULT FOR GET IS NUP */ 01388000
         OI    DMCBKYD(GPR01P),B'11100000'                         0505 01389000
         NI    DMCBUPD(GPR01P),B'11101111'                         0505 01390000
*                             DMCBRQST=DMCBGER;/* INDICATE GET     0506 01391000
*                                      REQUEST                       */ 01392000
         MVI   DMCBRQST(GPR01P),X'04'                              0506 01393000
*                             CALL DMCBRI->DMCBDMGR;/* CALL BLSCRQST */ 01394000
         L     @15,DMCBRI(,GPR01P)                                 0507 01395000
         BALR  @14,@15                                             0507 01396000
*                           END;                                   0508 01397000
*                         ELSE                                     0509 01398000
*                           DO;                                    0509 01399000
         B     @RC00496                                            0509 01400000
@RF00496 DS    0H                                                  0510 01401000
*                             RFY                                  0510 01402000
*                              (GPR00F,                            0510 01403000
*                               GPR15F) RSTD;                      0510 01404000
*                             GPR00F=0;/* INDICATE NO MESSAGE CHAIN  */ 01405000
         SLR   GPR00F,GPR00F                                       0511 01406000
*                             GPR15F=16;/* INDICATE INVALID DMCB     */ 01407000
         LA    GPR15F,16                                           0512 01408000
*                             RFY                                  0513 01409000
*                              (GPR00F,                            0513 01410000
*                               GPR15F);                           0513 01411000
*                           END;                                   0514 01412000
*                         RFY                                      0515 01413000
*                           DMCB;                                  0515 01414000
@RC00496 DS    0H                                                  0516 01415000
*                         RFY                                      0516 01416000
*                           GPR01P;                                0516 01417000
*                       END;        /* BLSGET (ZZ1PDRP) AREAL(STATPTR   01418000
*                                      )AREALEN(LENGTH(BUFFER))GENGE    01419000
*                                      ARG(SRCHKEY)ARGLEN(KEYLN)     */ 01420000
*                       IF((RETCDE^=ZZZFLAGI)/* IF RETURN CODE^=0    */ 01421000
*                           &(RETCDE^=ZZZFLAGE))/* AND RETURN CODE ^=   01422000
*                                      8                             */ 01423000
*                         THEN                                     0518 01424000
         SLR   @14,@14                                             0518 01425000
         CR    RETCDE,@14                                          0518 01426000
         BE    @RF00518                                            0518 01427000
         C     RETCDE,@CF00053                                     0518 01428000
         BE    @RF00518                                            0518 01429000
*                         DO;                                      0519 01430000
*                           IF RETCDE=ZZZFLAGT/* IF RETURN CODE = 16 */ 01431000
*                             THEN                                 0520 01432000
         C     RETCDE,@CF00056                                     0520 01433000
         BNE   @RF00520                                            0520 01434000
*                             MSGHEAD=ZERO;/* THEN OUTPUT 1 ERROR MSG*/ 01435000
         ST    @14,MSGHEAD                                         0521 01436000
*                           ELSE                                   0522 01437000
*                             MSGHEAD=ZZ1PDRP->DMCBMSG;/* ELSE OUTPUT   01438000
*                                      MSG CHAIN                     */ 01439000
         B     @RC00520                                            0522 01440000
@RF00520 L     @14,ZZ2ZZ1P(,ZZ2PTR)                                0522 01441000
         L     @14,ZZ1PDRP(,@14)                                   0522 01442000
         L     @14,DMCBMSG(,@14)                                   0522 01443000
         ST    @14,MSGHEAD                                         0522 01444000
*                           DO;     /* BLSDMSG (ZZ2PARM,PUTID,DATAHEA   01445000
*                                      D,BLSDMSGS) ROUTE(BOTH)       */ 01446000
@RC00520 DS    0H                                                  0524 01447000
*                             CALL BLSDMSG0(ZZ2PARM,PUTID,DATAHEAD,     01448000
*                                 BLSDMSGS,'00110000'B,0);/* BUILD 0524 01449000
*                                      MESSAGE                       */ 01450000
         L     @14,@PC00001                                        0524 01451000
         ST    @14,@AL00001                                        0524 01452000
         LA    @14,@CF01124                                        0524 01453000
         ST    @14,@AL00001+4                                      0524 01454000
         LA    @14,DATAHEAD                                        0524 01455000
         ST    @14,@AL00001+8                                      0524 01456000
         L     @14,ZZ2MSGSP(,ZZ2PTR)                               0524 01457000
         ST    @14,@AL00001+12                                     0524 01458000
         LA    @14,@CB01170                                        0524 01459000
         ST    @14,@AL00001+16                                     0524 01460000
         LA    @14,@CF00050                                        0524 01461000
         ST    @14,@AL00001+20                                     0524 01462000
         L     @15,ZZ2MSG0P(,ZZ2PTR)                               0524 01463000
         LA    @01,@AL00001                                        0524 01464000
         BALR  @14,@15                                             0524 01465000
*                           END;    /* BLSDMSG (ZZ2PARM,PUTID,DATAHEA   01466000
*                                      D,BLSDMSGS) ROUTE(BOTH)       */ 01467000
*                                                                  0525 01468000
*                           /*****************************************/ 01469000
*                           /*                                       */ 01470000
*                           /* OUTPUT CONTENTS OF DATA QUEUE         */ 01471000
*                           /*                                       */ 01472000
*                           /*****************************************/ 01473000
*                                                                  0526 01474000
*                           DO;     /* BLSDMSG (ZZ2PARM,GETID,MSGHEAD   01475000
*                                      ,BLSDMSGS) LIFO ROUTE(TERM)   */ 01476000
*                             CALL BLSDMSG0(ZZ2PARM,GETID,MSGHEAD, 0527 01477000
*                                 BLSDMSGS,'10010000'B,0);/* BUILD 0527 01478000
*                                      MESSAGE                       */ 01479000
         L     @14,@PC00001                                        0527 01480000
         ST    @14,@AL00001                                        0527 01481000
         LA    @14,@CF01104                                        0527 01482000
         ST    @14,@AL00001+4                                      0527 01483000
         LA    @14,MSGHEAD                                         0527 01484000
         ST    @14,@AL00001+8                                      0527 01485000
         L     @14,ZZ2MSGSP(,ZZ2PTR)                               0527 01486000
         ST    @14,@AL00001+12                                     0527 01487000
         LA    @14,@CB01164                                        0527 01488000
         ST    @14,@AL00001+16                                     0527 01489000
         LA    @14,@CF00050                                        0527 01490000
         ST    @14,@AL00001+20                                     0527 01491000
         L     @15,ZZ2MSG0P(,ZZ2PTR)                               0527 01492000
         LA    @01,@AL00001                                        0527 01493000
         BALR  @14,@15                                             0527 01494000
*                           END;    /* BLSDMSG (ZZ2PARM,GETID,MSGHEAD   01495000
*                                      ,BLSDMSGS) LIFO ROUTE(TERM) 0528 01496000
*                                      BLSGET ERROR                  */ 01497000
*                           DO;     /* ABEND(GETABEND) DUMP          */ 01498000
*                             RESPECIFY                            0530 01499000
*                              (GPR01F) RESTRICTED;                0530 01500000
*                             GPR01F=GETABEND;/* COMP CODE IN REG 1  */ 01501000
         LA    GPR01F,123                                          0531 01502000
*                             GPR01F=GPR01F|'80000000'X;/*         0532 01503000
*                                      DUMP/STEP/DUMPOPTS FLAG       */ 01504000
         O     GPR01F,@CF00065                                     0532 01505000
*                             SVC(13);/* ISSUE ABEND SVC             */ 01506000
         SVC   13                                                  0533 01507000
*                             RESPECIFY                            0534 01508000
*                              (GPR01F) UNRESTRICTED;              0534 01509000
*                           END;    /* ABEND(GETABEND) DUMP ABEND    */ 01510000
*                         END;                                     0536 01511000
*                       ELSE                                       0537 01512000
*                         IF((PDRKRCTY^=PDRSTATC)/* IF RECORD TYPE OF   01513000
*                                      RECORD FETCHED IS NOT 'ST'    */ 01514000
*                             |(PDRKPNUM>FULPRBI2)/* OR PROBLEM    0537 01515000
*                                      FETCHED IS > RANGE END        */ 01516000
*                             |(RETCDE=ZZZFLAGE))/* OR IF END OF FILE   01517000
*                                      OF PDR                        */ 01518000
*                           THEN                                   0537 01519000
         B     @RC00518                                            0537 01520000
@RF00518 L     @14,STATPTR                                         0537 01521000
         CLC   PDRKRCTY(2,@14),@CC01020                            0537 01522000
         BNE   @RT00537                                            0537 01523000
         CLC   PDRKPNUM(5,@14),FULPRBI2                            0537 01524000
         BH    @RT00537                                            0537 01525000
         C     RETCDE,@CF00053                                     0537 01526000
         BNE   @RF00537                                            0537 01527000
@RT00537 DS    0H                                                  0538 01528000
*                           DO;                                    0538 01529000
*                             RANGEND=ON;/* HAVE REACHED RANGE END   */ 01530000
         OI    RANGEND,B'00010000'                                 0539 01531000
*                             IF PDRPID=FULPRBI1/* IF SEARCH KEY WAS    01532000
*                                      RANGE ORIGIN                  */ 01533000
*                               THEN                               0540 01534000
         CLC   PDRPID(5),FULPRBI1                                  0540 01535000
         BNE   @RF00540                                            0540 01536000
*                               DO; /* THEN FOUND NO VALID PIDS IN 0541 01537000
*                                      RANGE                         */ 01538000
*                                 MSGHEAD=ZERO;                    0542 01539000
         SLR   @14,@14                                             0542 01540000
         ST    @14,MSGHEAD                                         0542 01541000
*                                 DO;/* BLSDMSG (ZZ2PARM,INVRNGID,DAT   01542000
*                                      AHEAD,BLSDMSGS) INSERT(FPPIDP,   01543000
*                                      FULPRBI1,FPPIDP,FULPRBI2)     */ 01544000
*                                   IOPTLIST(1)=ADDR(IOPTLIST(4));/*    01545000
*                                      CHAIN TO NEXT INSERT          */ 01546000
         LA    @07,IOPTLIST+12                                     0544 01547000
         ST    @07,IOPTLIST                                        0544 01548000
*                                   IOPTLIST(2)=ADDR(FPPIDP);/*    0545 01549000
*                                      INSERT NAME POINTER           */ 01550000
         L     @07,ZZ2ZZ1P(,ZZ2PTR)                                0545 01551000
         L     @07,ZZ1FPP(,@07)                                    0545 01552000
         LA    @07,FPPIDP(,@07)                                    0545 01553000
         ST    @07,IOPTLIST+4                                      0545 01554000
*                                   IOPTLIST(3)=0;/* ZERO RESERVED 0546 01555000
*                                      FIELD                         */ 01556000
         ST    @14,IOPTLIST+8                                      0546 01557000
*                                   RFY                            0547 01558000
*                                     I015F BASED(ADDR(IOPTLIST(3)));   01559000
*                                   /* ACCESS BYTES 1-2              */ 01560000
*                                   I015F=LENGTH(FPPIDP);/* INSERT 0548 01561000
*                                      LENGTH                        */ 01562000
         LA    @04,3                                               0548 01563000
         LA    @09,IOPTLIST+8                                      0548 01564000
         STH   @04,I015F(,@09)                                     0548 01565000
*                                   IOPTLIST(4)=ADDR(IOPTLIST(7));/*    01566000
*                                      CHAIN TO NEXT INSERT          */ 01567000
         LA    @09,IOPTLIST+24                                     0549 01568000
         ST    @09,IOPTLIST+12                                     0549 01569000
*                                   IOPTLIST(5)=ADDR(FULPRBI1);/*  0550 01570000
*                                      INSERT NAME POINTER           */ 01571000
         LA    @09,FULPRBI1                                        0550 01572000
         ST    @09,IOPTLIST+16                                     0550 01573000
*                                   IOPTLIST(6)=0;/* ZERO RESERVED 0551 01574000
*                                      FIELD                         */ 01575000
         ST    @14,IOPTLIST+20                                     0551 01576000
*                                   RFY                            0552 01577000
*                                     I015F BASED(ADDR(IOPTLIST(6)));   01578000
*                                   /* ACCESS BYTES 1-2              */ 01579000
*                                   I015F=LENGTH(FULPRBI1);/* INSERT    01580000
*                                      LENGTH                        */ 01581000
         LA    @09,5                                               0553 01582000
         LA    @08,IOPTLIST+20                                     0553 01583000
         STH   @09,I015F(,@08)                                     0553 01584000
*                                   IOPTLIST(7)=ADDR(IOPTLIST(10));/*   01585000
*                                      CHAIN TO NEXT INSERT          */ 01586000
         LA    @08,IOPTLIST+36                                     0554 01587000
         ST    @08,IOPTLIST+24                                     0554 01588000
*                                   IOPTLIST(8)=ADDR(FPPIDP);/*    0555 01589000
*                                      INSERT NAME POINTER           */ 01590000
         ST    @07,IOPTLIST+28                                     0555 01591000
*                                   IOPTLIST(9)=0;/* ZERO RESERVED 0556 01592000
*                                      FIELD                         */ 01593000
         ST    @14,IOPTLIST+32                                     0556 01594000
*                                   RFY                            0557 01595000
*                                     I015F BASED(ADDR(IOPTLIST(9)));   01596000
*                                   /* ACCESS BYTES 1-2              */ 01597000
*                                   I015F=LENGTH(FPPIDP);/* INSERT 0558 01598000
*                                      LENGTH                        */ 01599000
         LA    @07,IOPTLIST+32                                     0558 01600000
         STH   @04,I015F(,@07)                                     0558 01601000
*                                   IOPTLIST(10)=0;/* LAST INSERT    */ 01602000
         ST    @14,IOPTLIST+36                                     0559 01603000
*                                   IOPTLIST(11)=ADDR(FULPRBI2);/* 0560 01604000
*                                      INSERT NAME POINTER           */ 01605000
         LA    @07,FULPRBI2                                        0560 01606000
         ST    @07,IOPTLIST+40                                     0560 01607000
*                                   IOPTLIST(12)=0;/* ZERO RESERVED     01608000
*                                      FIELD                         */ 01609000
         ST    @14,IOPTLIST+44                                     0561 01610000
*                                   RFY                            0562 01611000
*                                     I015F BASED(ADDR(IOPTLIST(12)));  01612000
*                                   /* ACCESS BYTES 1-2              */ 01613000
*                                   I015F=LENGTH(FULPRBI2);/* INSERT    01614000
*                                      LENGTH                        */ 01615000
         LA    @14,IOPTLIST+44                                     0563 01616000
         STH   @09,I015F(,@14)                                     0563 01617000
*                                   CALL BLSDMSG0(ZZ2PARM,INVRNGID,     01618000
*                                       DATAHEAD,BLSDMSGS,'00000000'B,  01619000
*                                       ADDR(IOPTLIST));/* BUILD   0564 01620000
*                                      MESSAGE                       */ 01621000
         L     @14,@PC00001                                        0564 01622000
         ST    @14,@AL00001                                        0564 01623000
         LA    @14,@CF01116                                        0564 01624000
         ST    @14,@AL00001+4                                      0564 01625000
         LA    @14,DATAHEAD                                        0564 01626000
         ST    @14,@AL00001+8                                      0564 01627000
         L     @14,ZZ2MSGSP(,ZZ2PTR)                               0564 01628000
         ST    @14,@AL00001+12                                     0564 01629000
         LA    @14,@CB01180                                        0564 01630000
         ST    @14,@AL00001+16                                     0564 01631000
         LA    @14,IOPTLIST                                        0564 01632000
         ST    @14,@AFTEMPS                                        0564 01633000
         LA    @14,@AFTEMPS                                        0564 01634000
         ST    @14,@AL00001+20                                     0564 01635000
         L     @15,ZZ2MSG0P(,ZZ2PTR)                               0564 01636000
         LA    @01,@AL00001                                        0564 01637000
         BALR  @14,@15                                             0564 01638000
*                                 END;/* BLSDMSG (ZZ2PARM,INVRNGID,DA   01639000
*                                      TAHEAD,BLSDMSGS) INSERT(FPPIDP   01640000
*                                      ,FULPRBI1,FPPIDP,FULPRBI2)  0565 01641000
*                                      OUTPUT MESSAGE INDICATING   0565 01642000
*                                      'INVALID RANGE'               */ 01643000
*                                 MAXRETC=ZZZFLAGE;/* RETURN CODE=8  */ 01644000
         LA    MAXRETC,8                                           0566 01645000
*                               END;                               0567 01646000
*                             ELSE                                 0568 01647000
*                               ;                                  0568 01648000
@RF00540 DS    0H                                                  0569 01649000
*                           END;                                   0569 01650000
*                         ELSE                                     0570 01651000
*                           DO;                                    0570 01652000
         B     @RC00537                                            0570 01653000
@RF00537 DS    0H                                                  0571 01654000
*                             PDRPID=PDRKPNUM;/* SAVE CURRENT PID    */ 01655000
         L     @14,STATPTR                                         0571 01656000
         MVC   PDRPID(5),PDRKPNUM(@14)                             0571 01657000
*                             LASTCHAR=LASTCHAR+ONE;/* INCREMENT   0572 01658000
*                                      PDRPID BY 1 FOR NEXT FETCH    */ 01659000
         IC    @14,LASTCHAR                                        0572 01660000
         LA    @14,1(,@14)                                         0572 01661000
         STC   @14,LASTCHAR                                        0572 01662000
*                             CALL BLSELPCL(ZZ2PARM,LPWAPTR,/* CALL     01663000
*                                      TO CONTINUE LISTPROB        0573 01664000
*                                      PROCESSING                    */ 01665000
*                                 STATPTR,PARMTIME,NUMPROBS,PIDCOUNT,   01666000
*                                 DATAHEAD,QUEUELNS);              0573 01667000
         L     @14,@PC00001                                        0573 01668000
         ST    @14,@AL00001                                        0573 01669000
         L     @14,@PC00001+4                                      0573 01670000
         ST    @14,@AL00001+4                                      0573 01671000
         LA    @14,STATPTR                                         0573 01672000
         ST    @14,@AL00001+8                                      0573 01673000
         LA    @14,PARMTIME                                        0573 01674000
         ST    @14,@AL00001+12                                     0573 01675000
         LA    @14,NUMPROBS                                        0573 01676000
         ST    @14,@AL00001+16                                     0573 01677000
         LA    @14,PIDCOUNT                                        0573 01678000
         ST    @14,@AL00001+20                                     0573 01679000
         LA    @14,DATAHEAD                                        0573 01680000
         ST    @14,@AL00001+24                                     0573 01681000
         LA    @14,QUEUELNS                                        0573 01682000
         ST    @14,@AL00001+28                                     0573 01683000
         L     @07,ZZ2DVTP(,ZZ2PTR)                                0573 01684000
         L     @15,DVTLPCLP(,@07)                                  0573 01685000
         LA    @01,@AL00001                                        0573 01686000
         BALR  @14,@15                                             0573 01687000
*                             MAXRETC=MAX(RETCDE,MAXRETC);/* SET   0574 01688000
*                                      MAXIMUM RETURN CODE           */ 01689000
         CR    MAXRETC,RETCDE                                      0574 01690000
         BNL   *+6                                                      01691000
         LR    MAXRETC,RETCDE                                      0574 01692000
*                             IF RETCDE=ZZZFLAGS/* IF RETURN CODE =     01693000
*                                      12                            */ 01694000
*                               THEN                               0575 01695000
         C     RETCDE,@CF00034                                     0575 01696000
         BNE   @RF00575                                            0575 01697000
*                               ENDFLAG=ON;/* END LOOP               */ 01698000
         OI    ENDFLAG,B'01000000'                                 0576 01699000
*                             ELSE                                 0577 01700000
*                               ;                                  0577 01701000
@RF00575 DS    0H                                                  0578 01702000
*                             IF PDRKPNUM=FULPRBI2 THEN            0578 01703000
         L     @14,STATPTR                                         0578 01704000
         CLC   PDRKPNUM(5,@14),FULPRBI2                            0578 01705000
         BNE   @RF00578                                            0578 01706000
*                               RANGEND=ON;/* IF FETCHED LAST PROB 0579 01707000
*                                      THEN TURN ON FLAG             */ 01708000
         OI    RANGEND,B'00010000'                                 0579 01709000
*                             ELSE                                 0580 01710000
*                               ;                                  0580 01711000
@RF00578 DS    0H                                                  0581 01712000
*                           END;                                   0581 01713000
*                     END;                                         0582 01714000
@RC00537 DS    0H                                                  0582 01715000
@RC00518 DS    0H                                                  0583 01716000
*                 END;                                             0583 01717000
@RC00485 DS    0H                                                  0583 01718000
@DE00484 TM    ENDFLAG,B'01010000'                                 0583 01719000
         BZ    @DL00484                                            0583 01720000
*               END;                                               0584 01721000
*             IF PRBXP=LASTLINK     /* IF POINTER TO NEXT PROBLEM PDE   01722000
*                                      IS 'FF000000'X                */ 01723000
*               THEN                                               0585 01724000
@RC00394 L     @14,@PC00001+4                                      0585 01725000
         L     @14,LPWAPTR(,@14)                                   0585 01726000
         L     @14,LPPRBPTR(,@14)                                  0585 01727000
         CLC   PRBXP(4,@14),@CF00067                               0585 01728000
         BNE   @RF00585                                            0585 01729000
*               ENDFLAG=ON;         /* THEN HAVE REACHED END OF    0586 01730000
*                                      PROBLEM PDE CHAIN             */ 01731000
         OI    ENDFLAG,B'01000000'                                 0586 01732000
*             ELSE                                                 0587 01733000
*               LPPRBPTR=PRBXP;     /* MOVE PTR TO NEXT PDE          */ 01734000
         B     @RC00585                                            0587 01735000
@RF00585 L     @14,@PC00001+4                                      0587 01736000
         L     @14,LPWAPTR(,@14)                                   0587 01737000
         L     @07,LPPRBPTR(,@14)                                  0587 01738000
         L     @07,PRBXP(,@07)                                     0587 01739000
         ST    @07,LPPRBPTR(,@14)                                  0587 01740000
*           END;                                                   0588 01741000
*                                                                  0588 01742000
@RC00585 DS    0H                                                  0588 01743000
@DE00390 TM    ENDFLAG,B'01000000'                                 0588 01744000
         BZ    @DL00390                                            0588 01745000
*       /*************************************************************/ 01746000
*       /*                                                           */ 01747000
*       /* CLOSE THE PDR                                             */ 01748000
*       /*                                                           */ 01749000
*       /*************************************************************/ 01750000
*                                                                  0589 01751000
*       ZZ1PDRP->DMCBMSG=ZERO;      /* SET MSG AREA PTR TO ZERO      */ 01752000
@RC00302 DS    0H                                                  0589 01753000
@RC00209 L     @14,ZZ2ZZ1P(,ZZ2PTR)                                0589 01754000
         L     @14,ZZ1PDRP(,@14)                                   0589 01755000
         SLR   @07,@07                                             0589 01756000
         ST    @07,DMCBMSG(,@14)                                   0589 01757000
*       DO;                         /* BLSCLOSE(ZZ1PDRP)DISP         */ 01758000
*         RFY                                                      0591 01759000
*           GPR01P RSTD;                                           0591 01760000
*         GPR01P=ZZ1PDRP;           /* ADDRESS THE DMCB              */ 01761000
         LR    GPR01P,@14                                          0592 01762000
*         RFY                                                      0593 01763000
*           DMCB BASED(GPR01P);                                    0593 01764000
*         IF((GPR01P&'FFFFFFF8'X)=GPR01P)&DMCBID='DMCB'/* VALID DMCB    01765000
*                                      ?                             */ 01766000
*           THEN                                                   0594 01767000
         LR    @14,GPR01P                                          0594 01768000
         N     @14,@CF01160                                        0594 01769000
         CLR   @14,GPR01P                                          0594 01770000
         BNE   @RF00594                                            0594 01771000
         CLC   DMCBID(4,GPR01P),@CC01161                           0594 01772000
         BNE   @RF00594                                            0594 01773000
*           DO;                                                    0595 01774000
*             DMCBRQST=DMCBCLR;     /* INDICATE CLOSE REQUEST        */ 01775000
         MVI   DMCBRQST(GPR01P),X'02'                              0596 01776000
*             DMCBTMP='0'B;         /* INDICATE NON TEMP CLOSE       */ 01777000
*             DMCBRM6='0'B;         /* INDICATE                      */ 01778000
*             DMCBRM5='0'B;         /* DISP OPTION                   */ 01779000
         NI    DMCBTMP(GPR01P),B'00011111'                         0599 01780000
*             CALL DMCBRI->DMCBDMGR;/* CALL BLSCRQST                 */ 01781000
         L     @15,DMCBRI(,GPR01P)                                 0600 01782000
         BALR  @14,@15                                             0600 01783000
*           END;                                                   0601 01784000
*         ELSE                                                     0602 01785000
*           DO;                                                    0602 01786000
         B     @RC00594                                            0602 01787000
@RF00594 DS    0H                                                  0603 01788000
*             RFY                                                  0603 01789000
*              (GPR00F,                                            0603 01790000
*               GPR15F) RSTD;                                      0603 01791000
*             GPR00F=0;             /* INDICATE NO MESSAGE CHAIN     */ 01792000
         SLR   GPR00F,GPR00F                                       0604 01793000
*             GPR15F=16;            /* INDICATE INVALID DMCB         */ 01794000
         LA    GPR15F,16                                           0605 01795000
*             RFY                                                  0606 01796000
*              (GPR00F,                                            0606 01797000
*               GPR15F);                                           0606 01798000
*           END;                                                   0607 01799000
*         RFY                                                      0608 01800000
*           DMCB;                                                  0608 01801000
@RC00594 DS    0H                                                  0609 01802000
*         RFY                                                      0609 01803000
*           GPR01P;                                                0609 01804000
*       END;                        /* BLSCLOSE(ZZ1PDRP)DISP CLOSE 0610 01805000
*                                      THE PDR                       */ 01806000
*       IF RETCDE^=ZZZFLAGI         /* IF RETURN CODE ^= 0           */ 01807000
*         THEN                                                     0611 01808000
         SLR   @14,@14                                             0611 01809000
         CR    RETCDE,@14                                          0611 01810000
         BE    @RF00611                                            0611 01811000
*         DO;                                                      0612 01812000
*           IF RETCDE=ZZZFLAGT      /* IF RETURN CODE = 16           */ 01813000
*             THEN                                                 0613 01814000
         C     RETCDE,@CF00056                                     0613 01815000
         BNE   @RF00613                                            0613 01816000
*             MSGHEAD=ZERO;         /* OUTPUT 1 ERROR MSG            */ 01817000
         ST    @14,MSGHEAD                                         0614 01818000
*           ELSE                                                   0615 01819000
*             MSGHEAD=ZZ1PDRP->DMCBMSG;/* ELSE OUTPUT MSG CHAIN      */ 01820000
         B     @RC00613                                            0615 01821000
@RF00613 L     @14,ZZ2ZZ1P(,ZZ2PTR)                                0615 01822000
         L     @14,ZZ1PDRP(,@14)                                   0615 01823000
         L     @14,DMCBMSG(,@14)                                   0615 01824000
         ST    @14,MSGHEAD                                         0615 01825000
*           DO;                     /* BLSDMSG (ZZ2PARM,PUTID,DATAHEA   01826000
*                                      D,BLSDMSGS) ROUTE(BOTH)       */ 01827000
@RC00613 DS    0H                                                  0617 01828000
*             CALL BLSDMSG0(ZZ2PARM,PUTID,DATAHEAD,BLSDMSGS,'00110000'B 01829000
*                 ,0);              /* BUILD MESSAGE                 */ 01830000
         L     @14,@PC00001                                        0617 01831000
         ST    @14,@AL00001                                        0617 01832000
         LA    @14,@CF01124                                        0617 01833000
         ST    @14,@AL00001+4                                      0617 01834000
         LA    @14,DATAHEAD                                        0617 01835000
         ST    @14,@AL00001+8                                      0617 01836000
         L     @14,ZZ2MSGSP(,ZZ2PTR)                               0617 01837000
         ST    @14,@AL00001+12                                     0617 01838000
         LA    @14,@CB01170                                        0617 01839000
         ST    @14,@AL00001+16                                     0617 01840000
         LA    @14,@CF00050                                        0617 01841000
         ST    @14,@AL00001+20                                     0617 01842000
         L     @15,ZZ2MSG0P(,ZZ2PTR)                               0617 01843000
         LA    @01,@AL00001                                        0617 01844000
         BALR  @14,@15                                             0617 01845000
*           END;                    /* BLSDMSG (ZZ2PARM,PUTID,DATAHEA   01846000
*                                      D,BLSDMSGS) ROUTE(BOTH) OUTPUT   01847000
*                                      CONTENTS OF THE DATA QUEUE    */ 01848000
*           DO;                     /* BLSDMSG (ZZ2PARM,CLOSEID,MSGHE   01849000
*                                      AD,BLSDMSGS) LIFO ROUTE(TERM) */ 01850000
*             CALL BLSDMSG0(ZZ2PARM,CLOSEID,MSGHEAD,BLSDMSGS,'10010000' 01851000
*                 ,0);              /* BUILD MESSAGE                 */ 01852000
         L     @14,@PC00001                                        0620 01853000
         ST    @14,@AL00001                                        0620 01854000
         LA    @14,@CF01108                                        0620 01855000
         ST    @14,@AL00001+4                                      0620 01856000
         LA    @14,MSGHEAD                                         0620 01857000
         ST    @14,@AL00001+8                                      0620 01858000
         L     @14,ZZ2MSGSP(,ZZ2PTR)                               0620 01859000
         ST    @14,@AL00001+12                                     0620 01860000
         LA    @14,@CB01164                                        0620 01861000
         ST    @14,@AL00001+16                                     0620 01862000
         LA    @14,@CF00050                                        0620 01863000
         ST    @14,@AL00001+20                                     0620 01864000
         L     @15,ZZ2MSG0P(,ZZ2PTR)                               0620 01865000
         LA    @01,@AL00001                                        0620 01866000
         BALR  @14,@15                                             0620 01867000
*           END;                    /* BLSDMSG (ZZ2PARM,CLOSEID,MSGHE   01868000
*                                      AD,BLSDMSGS) LIFO ROUTE(TERM)    01869000
*                                      OUTPUT BLSCLOSE ERROR         */ 01870000
*           DO;                     /* ABEND(CLABEND) DUMP           */ 01871000
*             RESPECIFY                                            0623 01872000
*              (GPR01F) RESTRICTED;                                0623 01873000
*             GPR01F=CLABEND;       /* COMP CODE IN REG 1            */ 01874000
         LA    GPR01F,137                                          0624 01875000
*             GPR01F=GPR01F|'80000000'X;/* DUMP/STEP/DUMPOPTS FLAG   */ 01876000
         O     GPR01F,@CF00065                                     0625 01877000
*             SVC(13);              /* ISSUE ABEND SVC               */ 01878000
         SVC   13                                                  0626 01879000
*             RESPECIFY                                            0627 01880000
*              (GPR01F) UNRESTRICTED;                              0627 01881000
*           END;                    /* ABEND(CLABEND) DUMP ABEND     */ 01882000
*         END;                                                     0629 01883000
*       ELSE                                                       0630 01884000
*         ;                                                        0630 01885000
@RF00611 DS    0H                                                  0631 01886000
*     END;                                                         0631 01887000
*                                                                  0631 01888000
*   /*****************************************************************/ 01889000
*   /*                                                               */ 01890000
*   /* IF THE MAXIMUM RETURN CODE IS LESS THAN 12 THEN PERFORM THE   */ 01891000
*   /* FOLLOWING CLOSING PROCESSING                                  */ 01892000
*   /*                                                               */ 01893000
*   /*****************************************************************/ 01894000
*                                                                  0632 01895000
*   IF MAXRETC<ZZZFLAGS             /* IF RETURN CODE < 12           */ 01896000
*     THEN                                                         0632 01897000
@RC00188 C     MAXRETC,@CF00034                                    0632 01898000
         BNL   @RF00632                                            0632 01899000
*     DO;                                                          0633 01900000
*                                                                  0633 01901000
*       /*************************************************************/ 01902000
*       /*                                                           */ 01903000
*       /* OUTPUT SUBTITLES NEEDED FOR THE LIST AND ABSTRACT FORMATS */ 01904000
*       /*                                                           */ 01905000
*       /*************************************************************/ 01906000
*                                                                  0634 01907000
*       IF((LPLIST=ON               /* IF LIST FORMAT                */ 01908000
*           |LPABST=ON)             /* OR ABSTRACT FORMAT            */ 01909000
*           &(LPSUBTIT=OFF)         /* AND HAVE NOT OUTPUTTED      0634 01910000
*                                      SUBTITLES YET                 */ 01911000
*           &(PIDCOUNT>ZERO))       /* AND AT LEAST 1 PROBLEM HAS  0634 01912000
*                                      BEEN LISTED                   */ 01913000
*         THEN                                                     0634 01914000
         L     @14,@PC00001+4                                      0634 01915000
         L     @14,LPWAPTR(,@14)                                   0634 01916000
         TM    LPLIST(@14),B'11000000'                             0634 01917000
         BZ    @RF00634                                            0634 01918000
         TM    LPSUBTIT(@14),B'00000010'                           0634 01919000
         BNZ   @RF00634                                            0634 01920000
         SLR   @14,@14                                             0634 01921000
         C     @14,PIDCOUNT                                        0634 01922000
         BNL   @RF00634                                            0634 01923000
*         DO;                                                      0635 01924000
*           SUBTITHD=ZERO;          /* SET SUBTITLE ADDR TO 0        */ 01925000
         ST    @14,SUBTITHD                                        0636 01926000
*           IF ZZ2AFP=ON            /* IF OUTPUTTING TO              */ 01927000
*             THEN                                                 0637 01928000
         TM    ZZ2AFP(ZZ2PTR),B'10000000'                          0637 01929000
         BNO   @RF00637                                            0637 01930000
*             DO;                   /* PRINTER                       */ 01931000
*               DO;                 /* BLSDMSG (ZZ2PARM,LISTHDID,SUBT   01932000
*                                      ITHD,BLSDMSGS)                */ 01933000
*                 CALL BLSDMSG0(ZZ2PARM,LISTHDID,SUBTITHD,BLSDMSGS,     01934000
*                     '00000000'B,0);/* BUILD MESSAGE                */ 01935000
         L     @14,@PC00001                                        0640 01936000
         ST    @14,@AL00001                                        0640 01937000
         LA    @14,@CF01118                                        0640 01938000
         ST    @14,@AL00001+4                                      0640 01939000
         LA    @14,SUBTITHD                                        0640 01940000
         ST    @14,@AL00001+8                                      0640 01941000
         L     @14,ZZ2MSGSP(,ZZ2PTR)                               0640 01942000
         ST    @14,@AL00001+12                                     0640 01943000
         LA    @14,@CB01180                                        0640 01944000
         ST    @14,@AL00001+16                                     0640 01945000
         LA    @14,@CF00050                                        0640 01946000
         ST    @14,@AL00001+20                                     0640 01947000
         L     @15,ZZ2MSG0P(,ZZ2PTR)                               0640 01948000
         LA    @01,@AL00001                                        0640 01949000
         BALR  @14,@15                                             0640 01950000
*               END;                /* BLSDMSG (ZZ2PARM,LISTHDID,SUBT   01951000
*                                      ITHD,BLSDMSGS) PUT SUBTITLE IN   01952000
*                                      CSECT FOR BLSUPRTT            */ 01953000
*               DO;                 /* BLSDMSG (ZZ2PARM,BLANKID,SUBTI   01954000
*                                      THD,BLSDMSGS)                 */ 01955000
*                 CALL BLSDMSG0(ZZ2PARM,BLANKID,SUBTITHD,BLSDMSGS, 0643 01956000
*                     '00000000'B,0);/* BUILD MESSAGE                */ 01957000
         L     @14,@PC00001                                        0643 01958000
         ST    @14,@AL00001                                        0643 01959000
         LA    @14,@CF01120                                        0643 01960000
         ST    @14,@AL00001+4                                      0643 01961000
         LA    @14,SUBTITHD                                        0643 01962000
         ST    @14,@AL00001+8                                      0643 01963000
         L     @14,ZZ2MSGSP(,ZZ2PTR)                               0643 01964000
         ST    @14,@AL00001+12                                     0643 01965000
         LA    @14,@CB01180                                        0643 01966000
         ST    @14,@AL00001+16                                     0643 01967000
         LA    @14,@CF00050                                        0643 01968000
         ST    @14,@AL00001+20                                     0643 01969000
         L     @15,ZZ2MSG0P(,ZZ2PTR)                               0643 01970000
         LA    @01,@AL00001                                        0643 01971000
         BALR  @14,@15                                             0643 01972000
*               END;                /* BLSDMSG (ZZ2PARM,BLANKID,SUBTI   01973000
*                                      THD,BLSDMSGS) FOLLOWED BY A 0644 01974000
*                                      BLANK LINE                    */ 01975000
*               CALL BLSUPRTT(ZZ2PARM,SUBTEXT);/* CALL PRINT SUBTITLE   01976000
*                                      INTERFACE MODULE              */ 01977000
         L     @14,@PC00001                                        0645 01978000
         ST    @14,@AL00001                                        0645 01979000
         L     @14,SUBTITHD                                        0645 01980000
         ST    @14,@AL00001+4                                      0645 01981000
         L     @07,ZZ2BVTP(,ZZ2PTR)                                0645 01982000
         L     @15,BVTPRTTP(,@07)                                  0645 01983000
         LA    @01,@AL00001                                        0645 01984000
         BALR  @14,@15                                             0645 01985000
*               DO;                 /* BLSDMSG (ZZ2PARM,PUTID,SUBTITH   01986000
*                                      D,BLSDMSGS)                   */ 01987000
*                 CALL BLSDMSG0(ZZ2PARM,PUTID,SUBTITHD,BLSDMSGS,   0647 01988000
*                     '00000000'B,0);/* BUILD MESSAGE                */ 01989000
         L     @14,@PC00001                                        0647 01990000
         ST    @14,@AL00001                                        0647 01991000
         LA    @14,@CF01124                                        0647 01992000
         ST    @14,@AL00001+4                                      0647 01993000
         LA    @14,SUBTITHD                                        0647 01994000
         ST    @14,@AL00001+8                                      0647 01995000
         L     @14,ZZ2MSGSP(,ZZ2PTR)                               0647 01996000
         ST    @14,@AL00001+12                                     0647 01997000
         LA    @14,@CB01180                                        0647 01998000
         ST    @14,@AL00001+16                                     0647 01999000
         LA    @14,@CF00050                                        0647 02000000
         ST    @14,@AL00001+20                                     0647 02001000
         L     @15,ZZ2MSG0P(,ZZ2PTR)                               0647 02002000
         LA    @01,@AL00001                                        0647 02003000
         BALR  @14,@15                                             0647 02004000
*               END;                /* BLSDMSG (ZZ2PARM,PUTID,SUBTITH   02005000
*                                      D,BLSDMSGS) FREE SUBTITLE   0648 02006000
*                                      STORAGE                       */ 02007000
*             END;                                                 0649 02008000
*           ELSE                                                   0650 02009000
*             ;                                                    0650 02010000
@RF00637 DS    0H                                                  0651 02011000
*           SUBTITHD=ZERO;          /* SET SUBTITLE HEADER BACK TO 0651 02012000
*                                      ZERO                          */ 02013000
         SLR   @14,@14                                             0651 02014000
         ST    @14,SUBTITHD                                        0651 02015000
*           IF(ZZ2AFT=ON            /* IF OUTPUTTING TO THE TERMINAL */ 02016000
*               |(ZZ2AFP=OFF&ZZ2AFT=OFF))/* OR FORCING OUTPUT TO THE    02017000
*                                      TERMINAL                      */ 02018000
*             THEN                                                 0652 02019000
         TM    ZZ2AFT(ZZ2PTR),B'01000000'                          0652 02020000
         BO    @RT00652                                            0652 02021000
         TM    ZZ2AFP(ZZ2PTR),B'11000000'                          0652 02022000
         BNZ   @RF00652                                            0652 02023000
@RT00652 DS    0H                                                  0653 02024000
*             DO;                                                  0653 02025000
*               DO;                 /* BLSDMSG (ZZ2PARM,LISTHDID,SUBT   02026000
*                                      ITHD,BLSDMSGS)                */ 02027000
*                 CALL BLSDMSG0(ZZ2PARM,LISTHDID,SUBTITHD,BLSDMSGS,     02028000
*                     '00000000'B,0);/* BUILD MESSAGE                */ 02029000
         L     @14,@PC00001                                        0655 02030000
         ST    @14,@AL00001                                        0655 02031000
         LA    @14,@CF01118                                        0655 02032000
         ST    @14,@AL00001+4                                      0655 02033000
         LA    @14,SUBTITHD                                        0655 02034000
         ST    @14,@AL00001+8                                      0655 02035000
         L     @14,ZZ2MSGSP(,ZZ2PTR)                               0655 02036000
         ST    @14,@AL00001+12                                     0655 02037000
         LA    @14,@CB01180                                        0655 02038000
         ST    @14,@AL00001+16                                     0655 02039000
         LA    @14,@CF00050                                        0655 02040000
         ST    @14,@AL00001+20                                     0655 02041000
         L     @15,ZZ2MSG0P(,ZZ2PTR)                               0655 02042000
         LA    @01,@AL00001                                        0655 02043000
         BALR  @14,@15                                             0655 02044000
*               END;                /* BLSDMSG (ZZ2PARM,LISTHDID,SUBT   02045000
*                                      ITHD,BLSDMSGS) THEN PUT     0656 02046000
*                                      SUBTITLE IN QUEUE FOR       0656 02047000
*                                      OUTPUTTING                    */ 02048000
*               DO;                 /* BLSDMSG (ZZ2PARM,BLANKID,SUBTI   02049000
*                                      THD,BLSDMSGS)                 */ 02050000
*                 CALL BLSDMSG0(ZZ2PARM,BLANKID,SUBTITHD,BLSDMSGS, 0658 02051000
*                     '00000000'B,0);/* BUILD MESSAGE                */ 02052000
         L     @14,@PC00001                                        0658 02053000
         ST    @14,@AL00001                                        0658 02054000
         LA    @14,@CF01120                                        0658 02055000
         ST    @14,@AL00001+4                                      0658 02056000
         LA    @14,SUBTITHD                                        0658 02057000
         ST    @14,@AL00001+8                                      0658 02058000
         L     @14,ZZ2MSGSP(,ZZ2PTR)                               0658 02059000
         ST    @14,@AL00001+12                                     0658 02060000
         LA    @14,@CB01180                                        0658 02061000
         ST    @14,@AL00001+16                                     0658 02062000
         LA    @14,@CF00050                                        0658 02063000
         ST    @14,@AL00001+20                                     0658 02064000
         L     @15,ZZ2MSG0P(,ZZ2PTR)                               0658 02065000
         LA    @01,@AL00001                                        0658 02066000
         BALR  @14,@15                                             0658 02067000
*               END;                /* BLSDMSG (ZZ2PARM,BLANKID,SUBTI   02068000
*                                      THD,BLSDMSGS) ALONG WITH A  0659 02069000
*                                      BLANK LINE                    */ 02070000
*               DO;                 /* BLSDMSG (ZZ2PARM,PUTID,SUBTITH   02071000
*                                      D,BLSDMSGS) ROUTE(TERM)       */ 02072000
*                 CALL BLSDMSG0(ZZ2PARM,PUTID,SUBTITHD,BLSDMSGS,   0661 02073000
*                     '00010000'B,0);/* BUILD MESSAGE                */ 02074000
         L     @14,@PC00001                                        0661 02075000
         ST    @14,@AL00001                                        0661 02076000
         LA    @14,@CF01124                                        0661 02077000
         ST    @14,@AL00001+4                                      0661 02078000
         LA    @14,SUBTITHD                                        0661 02079000
         ST    @14,@AL00001+8                                      0661 02080000
         L     @14,ZZ2MSGSP(,ZZ2PTR)                               0661 02081000
         ST    @14,@AL00001+12                                     0661 02082000
         LA    @14,@CB01179                                        0661 02083000
         ST    @14,@AL00001+16                                     0661 02084000
         LA    @14,@CF00050                                        0661 02085000
         ST    @14,@AL00001+20                                     0661 02086000
         L     @15,ZZ2MSG0P(,ZZ2PTR)                               0661 02087000
         LA    @01,@AL00001                                        0661 02088000
         BALR  @14,@15                                             0661 02089000
*               END;                /* BLSDMSG (ZZ2PARM,PUTID,SUBTITH   02090000
*                                      D,BLSDMSGS) ROUTE(TERM) AND 0662 02091000
*                                      OUTPUT THE 2 LINES TO THE   0662 02092000
*                                      TERMINAL                      */ 02093000
*             END;                                                 0663 02094000
*           ELSE                                                   0664 02095000
*             ;                                                    0664 02096000
@RF00652 DS    0H                                                  0665 02097000
*           LPSUBTIT=ON;            /* TURN SUBTITLE FLAG ON         */ 02098000
         L     @14,@PC00001+4                                      0665 02099000
         L     @14,LPWAPTR(,@14)                                   0665 02100000
         OI    LPSUBTIT(@14),B'00000010'                           0665 02101000
*         END;                                                     0666 02102000
*       ELSE                                                       0667 02103000
*         ;                                                        0667 02104000
*                                                                  0667 02105000
@RF00634 DS    0H                                                  0668 02106000
*       /*************************************************************/ 02107000
*       /*                                                           */ 02108000
*       /* OUTPUT THE REST OF THE DATA QUEUE AND THE NUMBER OF       */ 02109000
*       /* PROBLEMS WHICH HAVE BEEN LISTED                           */ 02110000
*       /*                                                           */ 02111000
*       /*************************************************************/ 02112000
*                                                                  0668 02113000
*       DO;                         /* BLSDMSG (ZZ2PARM,PUTID,DATAHEA   02114000
*                                      D,BLSDMSGS) ROUTE(BOTH)       */ 02115000
*         CALL BLSDMSG0(ZZ2PARM,PUTID,DATAHEAD,BLSDMSGS,'00110000'B,0); 02116000
         L     @14,@PC00001                                        0669 02117000
         ST    @14,@AL00001                                        0669 02118000
         LA    @14,@CF01124                                        0669 02119000
         ST    @14,@AL00001+4                                      0669 02120000
         LA    @14,DATAHEAD                                        0669 02121000
         ST    @14,@AL00001+8                                      0669 02122000
         L     @14,ZZ2MSGSP(,ZZ2PTR)                               0669 02123000
         ST    @14,@AL00001+12                                     0669 02124000
         LA    @14,@CB01170                                        0669 02125000
         ST    @14,@AL00001+16                                     0669 02126000
         LA    @14,@CF00050                                        0669 02127000
         ST    @14,@AL00001+20                                     0669 02128000
         L     @15,ZZ2MSG0P(,ZZ2PTR)                               0669 02129000
         LA    @01,@AL00001                                        0669 02130000
         BALR  @14,@15                                             0669 02131000
*                                   /* BUILD MESSAGE                 */ 02132000
*       END;                        /* BLSDMSG (ZZ2PARM,PUTID,DATAHEA   02133000
*                                      D,BLSDMSGS) ROUTE(BOTH) OUTPUT   02134000
*                                      DATA LINES REMAINING IN OUTPUT   02135000
*                                      QUEUE                         */ 02136000
*       MSGHEAD=ZERO;               /* SET PTR TO ZERO FOR FINAL   0671 02137000
*                                      MESSAGE                       */ 02138000
         SLR   @14,@14                                             0671 02139000
         ST    @14,MSGHEAD                                         0671 02140000
*       CVD(PIDCOUNT,DCML);         /* CONVERT PIDCOUNT TO DECIMAL   */ 02141000
         L     @14,PIDCOUNT                                        0672 02142000
         CVD   @14,DCML                                            0672 02143000
*       UNPK(INSERT#,DCML);         /* UNPACK AND STORE IN INSERT    */ 02144000
         UNPK  INSERT#(8),DCML(8)                                  0673 02145000
*       INSERT#(LENGTH(INSERT#))=INSERT#(LENGTH(INSERT#))|EBCDIC0;/*    02146000
*                                      REMOVE THE SIGN               */ 02147000
         OI    INSERT#+7,C'0'                                      0674 02148000
*       DO COUNTER=ONE TO(LENGTH(INSERT#)-ONE)/* LOOP TO FIND THE  0675 02149000
*                                      FIRST                         */ 02150000
*             WHILE(INSERT#(COUNTER)=EBCDIC0);/* NON-ZERO NUMBER FOR */ 02151000
         LA    COUNTER,1                                           0675 02152000
@DL00675 LA    @14,INSERT#-1(COUNTER)                              0675 02153000
         CLI   0(@14),C'0'                                         0675 02154000
         BNE   @DC00675                                            0675 02155000
*       END;                        /* THE FOLLOWING INSERT          */ 02156000
         AL    COUNTER,@CF00045                                    0676 02157000
         C     COUNTER,@CF00161                                    0676 02158000
         BNH   @DL00675                                            0676 02159000
@DC00675 DS    0H                                                  0677 02160000
*       IF PIDCOUNT=ONE             /* IF 1 PROBLEM IS BEING LISTED  */ 02161000
*         THEN                                                     0677 02162000
         LA    @14,1                                               0677 02163000
         C     @14,PIDCOUNT                                        0677 02164000
         BNE   @RF00677                                            0677 02165000
*         DO;                       /* BLSDMSG (ZZ2PARM,PID#ID,MSGHEA   02166000
*                                      D,BLSDMSGS) ROUTE(BOTH)INSERT(   02167000
*                                      (INSERT#(COUNTER:LENGTH(INSERT   02168000
*                                      #)),LENGTH(INSERT#)-COUNTER+ON   02169000
*                                      E),SINGULAR)                  */ 02170000
*           IOPTLIST(1)=ADDR(IOPTLIST(4));/* CHAIN TO NEXT INSERT    */ 02171000
         LA    @07,IOPTLIST+12                                     0679 02172000
         ST    @07,IOPTLIST                                        0679 02173000
*           IOPTLIST(2)=ADDR(INSERT#(COUNTER:LENGTH(INSERT#)));/*  0680 02174000
*                                      INSERT NAME POINTER           */ 02175000
         LA    @07,INSERT#-1(COUNTER)                              0680 02176000
         ST    @07,IOPTLIST+4                                      0680 02177000
*           IOPTLIST(3)=0;          /* ZERO RESERVED FIELD           */ 02178000
         SLR   @07,@07                                             0681 02179000
         ST    @07,IOPTLIST+8                                      0681 02180000
*           RFY                                                    0682 02181000
*             I015F BASED(ADDR(IOPTLIST(3)));/* ACCESS BYTES 1-2     */ 02182000
*           I015F=LENGTH(INSERT#)-COUNTER+ONE;/* INSERT LENGTH       */ 02183000
         LA    @04,IOPTLIST+8                                      0683 02184000
         LA    @03,8                                               0683 02185000
         SLR   @03,COUNTER                                         0683 02186000
         ALR   @03,@14                                             0683 02187000
         STH   @03,I015F(,@04)                                     0683 02188000
*           IOPTLIST(4)=0;          /* LAST INSERT                   */ 02189000
         ST    @07,IOPTLIST+12                                     0684 02190000
*           IOPTLIST(5)=ADDR(SINGULAR);/* INSERT NAME POINTER        */ 02191000
         LA    @14,@CC01132                                        0685 02192000
         ST    @14,IOPTLIST+16                                     0685 02193000
*           IOPTLIST(6)=0;          /* ZERO RESERVED FIELD           */ 02194000
         ST    @07,IOPTLIST+20                                     0686 02195000
*           RFY                                                    0687 02196000
*             I015F BASED(ADDR(IOPTLIST(6)));/* ACCESS BYTES 1-2     */ 02197000
*           I015F=LENGTH(SINGULAR); /* INSERT LENGTH                 */ 02198000
         LA    @14,IOPTLIST+20                                     0688 02199000
         MVC   I015F(2,@14),@CH00042                               0688 02200000
*           CALL BLSDMSG0(ZZ2PARM,PID#ID,MSGHEAD,BLSDMSGS,'00110000'B,  02201000
*               ADDR(IOPTLIST));    /* BUILD MESSAGE                 */ 02202000
         L     @14,@PC00001                                        0689 02203000
         ST    @14,@AL00001                                        0689 02204000
         LA    @14,@CF01122                                        0689 02205000
         ST    @14,@AL00001+4                                      0689 02206000
         LA    @14,MSGHEAD                                         0689 02207000
         ST    @14,@AL00001+8                                      0689 02208000
         L     @14,ZZ2MSGSP(,ZZ2PTR)                               0689 02209000
         ST    @14,@AL00001+12                                     0689 02210000
         LA    @14,@CB01170                                        0689 02211000
         ST    @14,@AL00001+16                                     0689 02212000
         LA    @14,IOPTLIST                                        0689 02213000
         ST    @14,@AFTEMPS                                        0689 02214000
         LA    @14,@AFTEMPS                                        0689 02215000
         ST    @14,@AL00001+20                                     0689 02216000
         L     @15,ZZ2MSG0P(,ZZ2PTR)                               0689 02217000
         LA    @01,@AL00001                                        0689 02218000
         BALR  @14,@15                                             0689 02219000
*         END;                      /* BLSDMSG (ZZ2PARM,PID#ID,MSGHEA   02220000
*                                      D,BLSDMSGS) ROUTE(BOTH)INSERT(   02221000
*                                      (INSERT#(COUNTER:LENGTH(INSERT   02222000
*                                      #)),LENGTH(INSERT#)-COUNTER+ON   02223000
*                                      E),SINGULAR) THEN OUTPUT MSG     02224000
*                                      INDICAT- ING # OF PROBLEMS  0690 02225000
*                                      LISTED IN SINGULAR TENSE      */ 02226000
*       ELSE                                                       0691 02227000
*         DO;                       /* BLSDMSG (ZZ2PARM,PID#ID,MSGHEA   02228000
*                                      D,BLSDMSGS) ROUTE(BOTH)INSERT(   02229000
*                                      (INSERT#(COUNTER:LENGTH(INSERT   02230000
*                                      #)),LENGTH(INSERT#)-COUNTER+ON   02231000
*                                      E),PLURAL)                    */ 02232000
         B     @RC00677                                            0691 02233000
@RF00677 DS    0H                                                  0692 02234000
*           IOPTLIST(1)=ADDR(IOPTLIST(4));/* CHAIN TO NEXT INSERT    */ 02235000
         LA    @14,IOPTLIST+12                                     0692 02236000
         ST    @14,IOPTLIST                                        0692 02237000
*           IOPTLIST(2)=ADDR(INSERT#(COUNTER:LENGTH(INSERT#)));/*  0693 02238000
*                                      INSERT NAME POINTER           */ 02239000
         LA    @14,INSERT#-1(COUNTER)                              0693 02240000
         ST    @14,IOPTLIST+4                                      0693 02241000
*           IOPTLIST(3)=0;          /* ZERO RESERVED FIELD           */ 02242000
         SLR   @14,@14                                             0694 02243000
         ST    @14,IOPTLIST+8                                      0694 02244000
*           RFY                                                    0695 02245000
*             I015F BASED(ADDR(IOPTLIST(3)));/* ACCESS BYTES 1-2     */ 02246000
*           I015F=LENGTH(INSERT#)-COUNTER+ONE;/* INSERT LENGTH       */ 02247000
         LA    @07,IOPTLIST+8                                      0696 02248000
         LA    @04,8                                               0696 02249000
         SLR   @04,COUNTER                                         0696 02250000
         AL    @04,@CF00045                                        0696 02251000
         STH   @04,I015F(,@07)                                     0696 02252000
*           IOPTLIST(4)=0;          /* LAST INSERT                   */ 02253000
         ST    @14,IOPTLIST+12                                     0697 02254000
*           IOPTLIST(5)=ADDR(PLURAL);/* INSERT NAME POINTER          */ 02255000
         LA    @07,@CC01134                                        0698 02256000
         ST    @07,IOPTLIST+16                                     0698 02257000
*           IOPTLIST(6)=0;          /* ZERO RESERVED FIELD           */ 02258000
         ST    @14,IOPTLIST+20                                     0699 02259000
*           RFY                                                    0700 02260000
*             I015F BASED(ADDR(IOPTLIST(6)));/* ACCESS BYTES 1-2     */ 02261000
*           I015F=LENGTH(PLURAL);   /* INSERT LENGTH                 */ 02262000
         LA    @14,IOPTLIST+20                                     0701 02263000
         MVC   I015F(2,@14),@CH00138                               0701 02264000
*           CALL BLSDMSG0(ZZ2PARM,PID#ID,MSGHEAD,BLSDMSGS,'00110000'B,  02265000
*               ADDR(IOPTLIST));    /* BUILD MESSAGE                 */ 02266000
         L     @14,@PC00001                                        0702 02267000
         ST    @14,@AL00001                                        0702 02268000
         LA    @14,@CF01122                                        0702 02269000
         ST    @14,@AL00001+4                                      0702 02270000
         LA    @14,MSGHEAD                                         0702 02271000
         ST    @14,@AL00001+8                                      0702 02272000
         L     @14,ZZ2MSGSP(,ZZ2PTR)                               0702 02273000
         ST    @14,@AL00001+12                                     0702 02274000
         LA    @14,@CB01170                                        0702 02275000
         ST    @14,@AL00001+16                                     0702 02276000
         LA    @14,IOPTLIST                                        0702 02277000
         ST    @14,@AFTEMPS                                        0702 02278000
         LA    @14,@AFTEMPS                                        0702 02279000
         ST    @14,@AL00001+20                                     0702 02280000
         L     @15,ZZ2MSG0P(,ZZ2PTR)                               0702 02281000
         LA    @01,@AL00001                                        0702 02282000
         BALR  @14,@15                                             0702 02283000
*         END;                      /* BLSDMSG (ZZ2PARM,PID#ID,MSGHEA   02284000
*                                      D,BLSDMSGS) ROUTE(BOTH)INSERT(   02285000
*                                      (INSERT#(COUNTER:LENGTH(INSERT   02286000
*                                      #)),LENGTH(INSERT#)-COUNTER+ON   02287000
*                                      E),PLURAL) ELSE OUTPUT MSG IN    02288000
*                                      PLURAL TENSE                  */ 02289000
*     END;                                                         0704 02290000
*   ELSE                                                           0705 02291000
*     DO;                           /* BLSDMSG (ZZ2PARM,PUTID,DATAHEA   02292000
*                                      D,BLSDMSGS)                   */ 02293000
         B     @RC00632                                            0705 02294000
@RF00632 DS    0H                                                  0706 02295000
*       CALL BLSDMSG0(ZZ2PARM,PUTID,DATAHEAD,BLSDMSGS,'00000000'B,0);   02296000
         L     @14,@PC00001                                        0706 02297000
         ST    @14,@AL00001                                        0706 02298000
         LA    @14,@CF01124                                        0706 02299000
         ST    @14,@AL00001+4                                      0706 02300000
         LA    @14,DATAHEAD                                        0706 02301000
         ST    @14,@AL00001+8                                      0706 02302000
         L     @14,ZZ2MSGSP(,ZZ2PTR)                               0706 02303000
         ST    @14,@AL00001+12                                     0706 02304000
         LA    @14,@CB01180                                        0706 02305000
         ST    @14,@AL00001+16                                     0706 02306000
         LA    @14,@CF00050                                        0706 02307000
         ST    @14,@AL00001+20                                     0706 02308000
         L     @15,ZZ2MSG0P(,ZZ2PTR)                               0706 02309000
         LA    @01,@AL00001                                        0706 02310000
         BALR  @14,@15                                             0706 02311000
*                                   /* BUILD MESSAGE                 */ 02312000
*     END;                          /* BLSDMSG (ZZ2PARM,PUTID,DATAHEA   02313000
*                                      D,BLSDMSGS) IF MAX RETURN CODE   02314000
*                                      ^< 12 THEN THROW OUT THE    0707 02315000
*                                      CONTENTS OF THE OUTPUT DATA 0707 02316000
*                                      QUEUE                         */ 02317000
*                                                                  0707 02318000
*   /*****************************************************************/ 02319000
*   /*                                                               */ 02320000
*   /* MAKE A FINAL CHECK TO SEE IF THE ATTENTION KEY HAS BEEN POSTED*/ 02321000
*   /*                                                               */ 02322000
*   /*****************************************************************/ 02323000
*                                                                  0708 02324000
*   IF ZZ1EVEP=ON                   /* IF ATTENTION KEY HAS BEEN   0708 02325000
*                                      POSTED                        */ 02326000
*     THEN                                                         0708 02327000
@RC00632 L     @14,ZZ2ZZ1P(,ZZ2PTR)                                0708 02328000
         TM    ZZ1EVEP(@14),B'01000000'                            0708 02329000
         BNO   @RF00708                                            0708 02330000
*     DO;                                                          0709 02331000
*       MAXRETC=ZZZFLAGS;           /* RETURN CODE = 12              */ 02332000
         LA    MAXRETC,12                                          0710 02333000
*       ZZ1EVEP=OFF;                /* TURN OFF POST BIT             */ 02334000
         L     @07,ZZ1EVEP(,@14)                                   0711 02335000
@GL00020 LR    @04,@07                                             0711 02336000
         N     @04,@CF01233                                        0711 02337000
         CS    @07,@04,ZZ1EVEP(@14)                                0711 02338000
         BNE   @GL00020                                            0711 02339000
*       DO;                         /* BLSDMSG (ZZ2PARM,PUTID,DATAHEA   02340000
*                                      D,BLSDMSGS)                   */ 02341000
*         CALL BLSDMSG0(ZZ2PARM,PUTID,DATAHEAD,BLSDMSGS,'00000000'B,0); 02342000
         L     @14,@PC00001                                        0713 02343000
         ST    @14,@AL00001                                        0713 02344000
         LA    @14,@CF01124                                        0713 02345000
         ST    @14,@AL00001+4                                      0713 02346000
         LA    @14,DATAHEAD                                        0713 02347000
         ST    @14,@AL00001+8                                      0713 02348000
         L     @14,ZZ2MSGSP(,ZZ2PTR)                               0713 02349000
         ST    @14,@AL00001+12                                     0713 02350000
         LA    @14,@CB01180                                        0713 02351000
         ST    @14,@AL00001+16                                     0713 02352000
         LA    @14,@CF00050                                        0713 02353000
         ST    @14,@AL00001+20                                     0713 02354000
         L     @15,ZZ2MSG0P(,ZZ2PTR)                               0713 02355000
         LA    @01,@AL00001                                        0713 02356000
         BALR  @14,@15                                             0713 02357000
*                                   /* BUILD MESSAGE                 */ 02358000
*       END;                        /* BLSDMSG (ZZ2PARM,PUTID,DATAHEA   02359000
*                                      D,BLSDMSGS) THROW OUT CONTENTS   02360000
*                                      OF DATA QUEUE                 */ 02361000
*     END;                                                         0715 02362000
*   ELSE                                                           0716 02363000
*     ;                                                            0716 02364000
*                                                                  0716 02365000
@RF00708 DS    0H                                                  0717 02366000
*   /*****************************************************************/ 02367000
*   /*                                                               */ 02368000
*   /* REGARDLESS OF THE RETURN CODE, PERFORM THE FOLLOWING CLOSING  */ 02369000
*   /* PROCESSING                                                    */ 02370000
*   /*                                                               */ 02371000
*   /*****************************************************************/ 02372000
*                                                                  0717 02373000
*   IF LPSUBTIT=ON                  /* IF SUBTITLE WAS USED          */ 02374000
*     THEN                                                         0717 02375000
         L     @14,@PC00001+4                                      0717 02376000
         L     @14,LPWAPTR(,@14)                                   0717 02377000
         TM    LPSUBTIT(@14),B'00000010'                           0717 02378000
         BNO   @RF00717                                            0717 02379000
*     DO;                           /* CALL BLSUPRTT WITH A NULL   0718 02380000
*                                      SUBTITLE                      */ 02381000
*       SUBPTR=ZERO;                /* SET SUBTITLE PTR TO ZERO      */ 02382000
         SLR   @14,@14                                             0719 02383000
         ST    @14,SUBPTR                                          0719 02384000
*       SUBLN=NULLMSGL;             /* SET SUBTITLE LENGTH TO NULL 0720 02385000
*                                      SUBTITLE LENGTH               */ 02386000
         MVC   SUBLN(2),@CH00042                                   0720 02387000
*       SUBOS=ZERO;                 /* SET SUBTITLE OFFSET TO ZERO   */ 02388000
         STH   @14,SUBOS                                           0721 02389000
*       CALL BLSUPRTT(ZZ2PARM,NULLSUB);/* CALL PRINT SUBTITLE      0722 02390000
*                                      INTERFACE MODULE WITH A NULL     02391000
*                                      SUBTITLE SO THAT THE PREVIOUS    02392000
*                                      SUBTITLE WILL BE CANCELLED    */ 02393000
         L     @14,@PC00001                                        0722 02394000
         ST    @14,@AL00001                                        0722 02395000
         LA    @14,NULLSUB                                         0722 02396000
         ST    @14,@AL00001+4                                      0722 02397000
         L     @07,ZZ2BVTP(,ZZ2PTR)                                0722 02398000
         L     @15,BVTPRTTP(,@07)                                  0722 02399000
         LA    @01,@AL00001                                        0722 02400000
         BALR  @14,@15                                             0722 02401000
*     END;                                                         0723 02402000
*   ELSE                                                           0724 02403000
*     ;                                                            0724 02404000
@RF00717 DS    0H                                                  0725 02405000
*   ZZ1PDRP->DMCBMSG=ZERO;          /* SET MSG AREA PTR TO ZERO      */ 02406000
         L     @14,ZZ2ZZ1P(,ZZ2PTR)                                0725 02407000
         L     @14,ZZ1PDRP(,@14)                                   0725 02408000
         SLR   @07,@07                                             0725 02409000
         ST    @07,DMCBMSG(,@14)                                   0725 02410000
*   RETURN CODE(MAXRETC);           /* RETURN THE MAXIMUM RETURN CODE   02411000
*                                      FOUND                         */ 02412000
         L     @13,4(,@13)                                         0726 02413000
         L     @00,@SIZDATD                                        0726 02414000
         LR    @01,@11                                             0726 02415000
         BLSUFRES R,LV=(0),A=(1)                                        02416000
         LR    @15,@06                                             0726 02417000
         L     @14,12(,@13)                                        0726 02418000
         LM    @00,@12,20(@13)                                     0726 02419000
         BR    @14                                                 0726 02420000
*/*BLSUPEND--MVS IPCS MODULE                                         */ 02421000
*                                                                  0727 02422000
*   DECLARE                         /* GENERAL PURPOSE REGISTERS     */ 02423000
*     GPR00F FIXED(31) REG(0),                                     0727 02424000
*     GPR01F FIXED(31) REG(1),                                     0727 02425000
*     GPR15F FIXED(31) REG(15),                                    0727 02426000
*     GPR01P PTR(31) REG(1);                                       0727 02427000
*   DECLARE                         /* COMMON VARIABLES              */ 02428000
*     I256C CHAR(256) BASED,                                       0728 02429000
*     I031F FIXED(31) BASED,                                       0728 02430000
*     I031P PTR(31) BASED,                                         0728 02431000
*     I015F FIXED(15) BASED,                                       0728 02432000
*     I015P PTR(15) BASED,                                         0728 02433000
*     I008P PTR(8) BASED,                                          0728 02434000
*     I001C CHAR(1) BASED;                                         0728 02435000
*   DECLARE                                                        0729 02436000
*     IOPTLIST(12) PTR(31) BDY(WORD);/* OPTION LIST ARRAY            */ 02437000
*   GENERATE NODEFS NOREFS DATA;                                   0730 02438000
*   END                             /* BLRPEND                       */ 02439000
*                                                                  0731 02440000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 02441000
*/*%INCLUDE SYSLIB  (BLSUZZZ )                                       */ 02442000
*/*%INCLUDE SYSLIB  (BLRFULL )                                       */ 02443000
*/*%INCLUDE SYSLIB  (IKJCPPL )                                       */ 02444000
*/*%INCLUDE SYSLIB  (IKJPSCB )                                       */ 02445000
*/*%INCLUDE SYSLIB  (IKJECT  )                                       */ 02446000
*/*%INCLUDE SYSLIB  (IKJUPT  )                                       */ 02447000
*/*%INCLUDE SYSLIB  (BLSUSERV)                                       */ 02448000
*/*%INCLUDE SYSLIB  (BLRSERV )                                       */ 02449000
*/*%INCLUDE SYSLIB  (BLRSERVD)                                       */ 02450000
*/*%INCLUDE SYSLIB  (BLSDSERV)                                       */ 02451000
*/*%INCLUDE SYSLIB  (BLSFP   )                                       */ 02452000
*/*%INCLUDE SYSLIB  (BLSELPWA)                                       */ 02453000
*/*%INCLUDE SYSLIB  (BLSPDR  )                                       */ 02454000
*                                                                  0731 02455000
*       ;                                                          0731 02456000
@EL00001 L     @13,4(,@13)                                         0731 02457000
@EF00001 L     @00,@SIZDATD                                        0731 02458000
         LR    @01,@11                                             0731 02459000
         BLSUFRES R,LV=(0),A=(1)                                        02460000
@ER00001 LM    @14,@12,12(@13)                                     0731 02461000
         BR    @14                                                 0731 02462000
@DATA    DS    0H                                                       02463000
@CH00098 DC    H'3'                                                     02464000
@CH00138 DC    H'6'                                                     02465000
@SM01237 MVC   0(0,@01),PRBI1(@04)                                      02466000
@SM01239 MVC   0(0,@01),PRBI2(@14)                                      02467000
@DATD    DSECT                                                          02468000
         DS    0F                                                       02469000
@SA00001 DS    18F                                                      02470000
@PC00001 DS    2F                                                       02471000
@AL00001 DS    8A                                                       02472000
@AFTEMPS DS    1F                                                       02473000
BLSELPDR CSECT                                                          02474000
         DS    0F                                                       02475000
@CF00050 DC    F'0'                                                     02476000
@CF00045 DC    F'1'                                                     02477000
@CF00042 DC    F'4'                                                     02478000
@CH00042 EQU   @CF00042+2                                               02479000
@CF00095 DC    F'5'                                                     02480000
@CH00095 EQU   @CF00095+2                                               02481000
@CF00161 DC    F'7'                                                     02482000
@CF00053 DC    F'8'                                                     02483000
@CF00035 DC    F'10'                                                    02484000
@CF00034 DC    F'12'                                                    02485000
@CF00056 DC    F'16'                                                    02486000
@CF01213 DC    F'952'                                                   02487000
@CF01110 DC    F'4001'                                                  02488000
@CF01112 DC    F'4002'                                                  02489000
@CF01114 DC    F'4003'                                                  02490000
@CF01106 DC    F'4042'                                                  02491000
@CF01104 DC    F'4043'                                                  02492000
@CF01108 DC    F'4045'                                                  02493000
@CF01116 DC    F'5301'                                                  02494000
@CF01118 DC    F'40005'                                                 02495000
@CF01122 DC    F'40018'                                                 02496000
@CF01120 DC    F'40019'                                                 02497000
@CF01124 DC    F'-1'                                                    02498000
@CF00065 DC    XL4'80000000'                                            02499000
@CF00067 DC    XL4'FF000000'                                            02500000
@CF00940 DC    XL4'FFFFFFFF'                                            02501000
@CF01160 DC    XL4'FFFFFFF8'                                            02502000
@CF01168 DC    XL4'7FFFFFFF'                                            02503000
@CF01233 DC    BL4'10111111111111111111111111111111'                    02504000
@DATD    DSECT                                                          02505000
         DS    0D                                                       02506000
STATPTR  DS    A                                                        02507000
MSGHEAD  DS    A                                                        02508000
DATAHEAD DS    A                                                        02509000
QUEUELNS DS    F                                                        02510000
SUBTITHD DS    A                                                        02511000
PIDCOUNT DS    F                                                        02512000
NUMPROBS DS    F                                                        02513000
PARMTIME DS    CL8                                                      02514000
         DS    CL4                                                      02515000
FULLTIME DS    CL8                                                      02516000
SRCHKEY  DS    CL10                                                     02517000
         ORG   SRCHKEY                                                  02518000
RECTYPE  DS    CL2                                                      02519000
PDRPREF  DS    CL3                                                      02520000
PDRPID   DS    CL5                                                      02521000
         ORG   PDRPID                                                   02522000
@NM00070 DS    CL4                                                      02523000
LASTCHAR DS    CL1                                                      02524000
         ORG   SRCHKEY+10                                               02525000
BUFFER   DS    CL952                                                    02526000
FULPRBI1 DS    CL5                                                      02527000
FULPRBI2 DS    CL5                                                      02528000
NULLSUB  DS    CL8                                                      02529000
         ORG   NULLSUB                                                  02530000
SUBPTR   DS    FL4                                                      02531000
SUBLN    DS    FL2                                                      02532000
SUBOS    DS    FL2                                                      02533000
         ORG   NULLSUB+8                                                02534000
INSERT#  DS    CL8                                                      02535000
         DS    CL4                                                      02536000
DCML     DS    CL8                                                      02537000
ALLFLAGS DS    CL1                                                      02538000
         ORG   ALLFLAGS                                                 02539000
MATCHFLG DS    BL1                                                      02540000
ENDFLAG  EQU   ALLFLAGS+0                                               02541000
ERRFLAG  EQU   ALLFLAGS+0                                               02542000
RANGEND  EQU   ALLFLAGS+0                                               02543000
         ORG   ALLFLAGS+1                                               02544000
         DS    CL3                                                      02545000
IOPTLIST DS    12A                                                      02546000
BLSELPDR CSECT                                                          02547000
         DS    0F                                                       02548000
@SIZDATD DC    AL1(0)                                                   02549000
         DC    AL3(@ENDDATD-@DATD)                                      02550000
         DS    0D                                                       02551000
@CC00108 DC    C'000     '                                              02552000
@CC01134 DC    C'S HAVE'                                                02553000
@CC01078 DC    C'00001'                                                 02554000
@CC01080 DC    C'00000'                                                 02555000
@CC01132 DC    C' HAS'                                                  02556000
@CC01161 DC    C'DMCB'                                                  02557000
@CC01020 DC    C'ST'                                                    02558000
@CB01164 DC    B'10010000'                                              02559000
@CB01170 DC    B'00110000'                                              02560000
@CB01179 DC    B'00010000'                                              02561000
@CB01180 DC    B'00000000'                                              02562000
@DATD    DSECT                                                          02563000
         SPACE 2                                                        02564000
*********************************************************************** 02565000
* THE FOLLOWING AREA, BLRPATCH, IS RESERVED FOR PATCH APPLICATION     * 02566000
* TO OBTAIN PATCH ROOM IN THE @DATD AUTOMATIC STORAGE AREA, MODIFY    * 02567000
* CONSTANT @SIZDATD TO REFLECT THE DESIRED @DATD SIZE                 * 02568000
*********************************************************************** 02569000
         SPACE                                                          02570000
BLSELPDR CSECT                                                          02571000
         ORG                                                            02572000
         DS    0D                                                       02573000
BLRPATCH DC    CL8'ZAPAREA',(((*-BLSELPDR+19)/20+7)/8)CL8'BLSELPDR'     02574000
@DATD    DSECT                                                          02575000
         SPACE 2                                                        02576000
*********************************************************************** 02577000
* ALIGN END OF DATA ON A DOUBLEWORD BOUNDARY                          * 02578000
*********************************************************************** 02579000
         SPACE                                                          02580000
         DS    0D                                                       02581000
@DATD    DSECT                                                          02582000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                02583000
@ENDDATD EQU   *                                                        02584000
BLSELPDR CSECT                                                          02585000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       02586000
@01      EQU   01                                                       02587000
@02      EQU   02                                                       02588000
@03      EQU   03                                                       02589000
@04      EQU   04                                                       02590000
@05      EQU   05                                                       02591000
@06      EQU   06                                                       02592000
@07      EQU   07                                                       02593000
@08      EQU   08                                                       02594000
@09      EQU   09                                                       02595000
@10      EQU   10                                                       02596000
@11      EQU   11                                                       02597000
@12      EQU   12                                                       02598000
@13      EQU   13                                                       02599000
@14      EQU   14                                                       02600000
@15      EQU   15                                                       02601000
SAVEDRC  EQU   @07                                                      02602000
MAXRETC  EQU   @06                                                      02603000
COUNTER  EQU   @02                                                      02604000
RETC     EQU   @02                                                      02605000
ZZ2PTR   EQU   @05                                                      02606000
R0       EQU   @00                                                      02607000
R1       EQU   @01                                                      02608000
R2       EQU   @02                                                      02609000
R3       EQU   @03                                                      02610000
R4       EQU   @04                                                      02611000
R5       EQU   @05                                                      02612000
R9       EQU   @09                                                      02613000
RB       EQU   @11                                                      02614000
RD       EQU   @13                                                      02615000
RE       EQU   @14                                                      02616000
RF       EQU   @15                                                      02617000
RETCDE   EQU   @15                                                      02618000
GPR01P   EQU   @01                                                      02619000
GPR00F   EQU   @00                                                      02620000
GPR15F   EQU   @15                                                      02621000
GPR01F   EQU   @01                                                      02622000
RA       EQU   @10                                                      02623000
RC       EQU   @12                                                      02624000
R6       EQU   @06                                                      02625000
R7       EQU   @07                                                      02626000
R8       EQU   @08                                                      02627000
DMCB     EQU   0                                                        02628000
DMCBID   EQU   DMCB                                                     02629000
DMCBFTY  EQU   DMCB+20                                                  02630000
DMCBOPN  EQU   DMCB+21                                                  02631000
DMCBRQST EQU   DMCB+22                                                  02632000
DMCBRMOD EQU   DMCB+23                                                  02633000
DMCBOUT  EQU   DMCBRMOD                                                 02634000
DMCBTMP  EQU   DMCBOUT                                                  02635000
DMCBRM6  EQU   DMCBRMOD                                                 02636000
DMCBRM5  EQU   DMCBRMOD                                                 02637000
DMCBOPTS EQU   DMCB+24                                                  02638000
DMCBKYD  EQU   DMCBOPTS                                                 02639000
DMCBGKY  EQU   DMCBOPTS                                                 02640000
DMCBRNO  EQU   DMCBGKY                                                  02641000
DMCBAPX  EQU   DMCBOPTS                                                 02642000
DMCBUPD  EQU   DMCBOPTS                                                 02643000
DMCBMFLG EQU   DMCB+28                                                  02644000
DMCBBUFP EQU   DMCB+32                                                  02645000
DMCBBLEN EQU   DMCB+36                                                  02646000
DMCBKEYP EQU   DMCB+44                                                  02647000
DMCBKEYL EQU   DMCB+48                                                  02648000
DMCBMSG  EQU   DMCB+52                                                  02649000
DMCBRI   EQU   DMCB+64                                                  02650000
DMCBACBE EQU   DMCB+124                                                 02651000
DMCBSPEC EQU   DMCB+380                                                 02652000
DMCBAMS  EQU   DMCB+416                                                 02653000
DMCBAUDT EQU   DMCB+568                                                 02654000
DMCBLSCP EQU   DMCBAUDT+16                                              02655000
DMCBDMGR EQU   0                                                        02656000
ZZ1      EQU   0                                                        02657000
ZZ1PDRP  EQU   ZZ1+40                                                   02658000
ZZ1FPP   EQU   ZZ1+140                                                  02659000
ZZ1ATTN  EQU   ZZ1+360                                                  02660000
ZZ1EVE   EQU   ZZ1ATTN+4                                                02661000
ZZ1EVEP  EQU   ZZ1EVE                                                   02662000
ZZ1F     EQU   ZZ1+368                                                  02663000
ZZ1N     EQU   ZZ1+1116                                                 02664000
ZZ2      EQU   0                                                        02665000
ZZ2AMD   EQU   ZZ2                                                      02666000
@NM00013 EQU   ZZ2AMD+7                                                 02667000
ZZ2PRT   EQU   ZZ2+138                                                  02668000
ZZ2PRTT  EQU   ZZ2PRT+4                                                 02669000
ZZ2PRTT1 EQU   ZZ2PRTT+1                                                02670000
ZZ2A     EQU   ZZ2+272                                                  02671000
ZZ2AF    EQU   ZZ2A+16                                                  02672000
ZZ2AFP   EQU   ZZ2AF                                                    02673000
ZZ2AFT   EQU   ZZ2AF                                                    02674000
ZZ2APID  EQU   ZZ2A+64                                                  02675000
ZZ2APIDB EQU   ZZ2APID+3                                                02676000
ZZ2AD    EQU   ZZ2A+74                                                  02677000
ZZ2ADD   EQU   ZZ2AD                                                    02678000
ZZ2ADDT  EQU   ZZ2ADD+2                                                 02679000
ZZ2ADM   EQU   ZZ2AD+46                                                 02680000
ZZ2ADMT  EQU   ZZ2ADM+2                                                 02681000
ZZ2ADP   EQU   ZZ2AD+56                                                 02682000
ZZ2ADPT  EQU   ZZ2ADP+2                                                 02683000
ZZ2AQAS  EQU   ZZ2A+144                                                 02684000
ZZ2AQD   EQU   ZZ2A+160                                                 02685000
ZZ2AQDT  EQU   ZZ2AQD+10                                                02686000
ZZ2AQDF  EQU   ZZ2AQD+52                                                02687000
ZZ2STG   EQU   ZZ2+960                                                  02688000
ZZ2ALLOP EQU   ZZ2+992                                                  02689000
ZZ2FREEP EQU   ZZ2+996                                                  02690000
ZZ2FF19P EQU   ZZ2+1000                                                 02691000
ZZ2FRE1P EQU   ZZ2+1004                                                 02692000
ZZ2FF18P EQU   ZZ2+1008                                                 02693000
ZZ2DYNAP EQU   ZZ2+1012                                                 02694000
ZZ2ZZ2CP EQU   ZZ2+1016                                                 02695000
ZZ2ZZ2DP EQU   ZZ2+1020                                                 02696000
ZZ2STAIP EQU   ZZ2+1024                                                 02697000
ZZ2FF02P EQU   ZZ2+1028                                                 02698000
ZZ2GETLP EQU   ZZ2+1032                                                 02699000
ZZ2PARSP EQU   ZZ2+1036                                                 02700000
ZZ2PTGTP EQU   ZZ2+1040                                                 02701000
ZZ2PUTLP EQU   ZZ2+1044                                                 02702000
ZZ2SCANP EQU   ZZ2+1048                                                 02703000
ZZ2STCKP EQU   ZZ2+1052                                                 02704000
ZZ2ALOCP EQU   ZZ2+1056                                                 02705000
ZZ2MSGSP EQU   ZZ2+1060                                                 02706000
ZZ2TRMOP EQU   ZZ2+1064                                                 02707000
ZZ2TRMVP EQU   ZZ2+1068                                                 02708000
ZZ2MSG0P EQU   ZZ2+1076                                                 02709000
ZZ2PUTNP EQU   ZZ2+1084                                                 02710000
ZZ2TRMNP EQU   ZZ2+1088                                                 02711000
ZZ2ENQ0P EQU   ZZ2+1092                                                 02712000
ZZ2ADSDP EQU   ZZ2+1096                                                 02713000
ZZ2APDRP EQU   ZZ2+1100                                                 02714000
ZZ2FDSDP EQU   ZZ2+1104                                                 02715000
ZZ2FPDRP EQU   ZZ2+1108                                                 02716000
ZZ2ZZ1P  EQU   ZZ2+1264                                                 02717000
ZZ2DVTP  EQU   ZZ2+1276                                                 02718000
ZZ2BVTP  EQU   ZZ2+1280                                                 02719000
ZZ2CPPL  EQU   ZZ2+1292                                                 02720000
ZZ2CPPLC EQU   ZZ2CPPL                                                  02721000
ZZ2ITR   EQU   ZZ2+2840                                                 02722000
ZZ2ITRE  EQU   ZZ2ITR+16                                                02723000
ZZ2ITSE  EQU   ZZ2+2864                                                 02724000
ZZ2ES    EQU   ZZ2+2872                                                 02725000
ZZ2AMDX  EQU   ZZ2+7160                                                 02726000
ZZ2AXO   EQU   ZZ2+7934                                                 02727000
ZZ2AXOT  EQU   ZZ2AXO+2                                                 02728000
CMD      EQU   0                                                        02729000
CMDT     EQU   CMD+4                                                    02730000
PSCB     EQU   0                                                        02731000
PSCBATR1 EQU   PSCB+16                                                  02732000
ECT      EQU   0                                                        02733000
ECTSWS   EQU   ECT+28                                                   02734000
ECTSWS2  EQU   ECT+40                                                   02735000
ECTSWS21 EQU   ECTSWS2                                                  02736000
UPT      EQU   0                                                        02737000
UPTSWS   EQU   UPT+12                                                   02738000
SA       EQU   0                                                        02739000
SA1      EQU   SA                                                       02740000
SAR      EQU   SA+12                                                    02741000
BLSUPRTT EQU   0                                                        02742000
BVT      EQU   0                                                        02743000
BVTPUTLP EQU   BVT+4                                                    02744000
BVTPUTOP EQU   BVT+12                                                   02745000
BVTPUTTP EQU   BVT+16                                                   02746000
BVTPUTVP EQU   BVT+20                                                   02747000
BVTPUTAP EQU   BVT+24                                                   02748000
BVTPRTTP EQU   BVT+28                                                   02749000
BVTPRTAP EQU   BVT+32                                                   02750000
BVTPUTDP EQU   BVT+36                                                   02751000
BVTMONP  EQU   BVT+40                                                   02752000
BVTMON2P EQU   BVT+44                                                   02753000
BVTVSARP EQU   BVT+48                                                   02754000
BVTVSENP EQU   BVT+64                                                   02755000
BVTVSERP EQU   BVT+68                                                   02756000
BVTVSGEP EQU   BVT+72                                                   02757000
BVTVSGUP EQU   BVT+76                                                   02758000
BVTVSPOP EQU   BVT+80                                                   02759000
BVTVSPUP EQU   BVT+84                                                   02760000
BVTMPKNP EQU   BVT+104                                                  02761000
BVTMONLP EQU   BVT+108                                                  02762000
BVTPUTCP EQU   BVT+132                                                  02763000
BVTMPK1P EQU   BVT+136                                                  02764000
BVTZZ2RP EQU   BVT+140                                                  02765000
BVTPGMRP EQU   BVT+144                                                  02766000
BVTMONAP EQU   BVT+148                                                  02767000
BVTBLDDP EQU   BVT+152                                                  02768000
BVTBLDLP EQU   BVT+156                                                  02769000
BVTPGMCP EQU   BVT+160                                                  02770000
BVTPGMDP EQU   BVT+164                                                  02771000
BVTPGMLP EQU   BVT+168                                                  02772000
BVTMONCP EQU   BVT+180                                                  02773000
BVTMONDP EQU   BVT+184                                                  02774000
BVTMONTP EQU   BVT+188                                                  02775000
BVTPARIP EQU   BVT+192                                                  02776000
BVTPARUP EQU   BVT+196                                                  02777000
BVTPRTNP EQU   BVT+204                                                  02778000
BVTVSCRP EQU   BVT+208                                                  02779000
BVTVSMRP EQU   BVT+212                                                  02780000
BVTMONXP EQU   BVT+216                                                  02781000
BVTTRMAP EQU   BVT+228                                                  02782000
BLSDMSGS EQU   0                                                        02783000
BLSDMSG0 EQU   0                                                        02784000
BLSELPCL EQU   0                                                        02785000
DVT      EQU   0                                                        02786000
DVTDEQPP EQU   DVT+8                                                    02787000
DVTENQPP EQU   DVT+12                                                   02788000
DVTAUTHP EQU   DVT+20                                                   02789000
DVTLPCLP EQU   DVT+24                                                   02790000
DVTBP00P EQU   DVT+28                                                   02791000
DVTCN00P EQU   DVT+32                                                   02792000
DVTDF00P EQU   DVT+36                                                   02793000
DVTDS00P EQU   DVT+44                                                   02794000
DVTFL00P EQU   DVT+48                                                   02795000
DVTFP00P EQU   DVT+52                                                   02796000
DVTGD00P EQU   DVT+56                                                   02797000
DVTGG00P EQU   DVT+60                                                   02798000
DVTGP00P EQU   DVT+64                                                   02799000
DVTND00P EQU   DVT+68                                                   02800000
DVTND01P EQU   DVT+72                                                   02801000
DVTOD00P EQU   DVT+76                                                   02802000
DVTPS00P EQU   DVT+80                                                   02803000
DVTSD00P EQU   DVT+84                                                   02804000
DVTSL00P EQU   DVT+88                                                   02805000
DVTTL00P EQU   DVT+92                                                   02806000
DVTUD00P EQU   DVT+96                                                   02807000
DVTUP00P EQU   DVT+100                                                  02808000
DVTLP00P EQU   DVT+104                                                  02809000
DVTLALLP EQU   DVT+108                                                  02810000
DVTLPFMP EQU   DVT+112                                                  02811000
DVTCLOSP EQU   DVT+116                                                  02812000
DVTOPENP EQU   DVT+120                                                  02813000
DVTPERAP EQU   DVT+124                                                  02814000
DVTDALLP EQU   DVT+128                                                  02815000
FPBLOK   EQU   0                                                        02816000
FPPIDP   EQU   FPBLOK+96                                                02817000
FPDBPIDP EQU   FPBLOK+100                                               02818000
FPADMNM  EQU   FPBLOK+120                                               02819000
FPDELNM  EQU   FPBLOK+128                                               02820000
BLSELPWA EQU   0                                                        02821000
LPPRBPTR EQU   BLSELPWA+8                                               02822000
LPFRMFLG EQU   BLSELPWA+12                                              02823000
LPLIST   EQU   LPFRMFLG                                                 02824000
LPABST   EQU   LPFRMFLG                                                 02825000
LPSUBTIT EQU   LPFRMFLG                                                 02826000
BLSESCB  EQU   0                                                        02827000
PDREC    EQU   0                                                        02828000
PDRKEY   EQU   PDREC                                                    02829000
PDRGRP   EQU   PDRKEY                                                   02830000
PDRKRCTY EQU   PDRGRP                                                   02831000
PDRKPID  EQU   PDRGRP+2                                                 02832000
PDRKPNUM EQU   PDRKPID+3                                                02833000
PDRINFO  EQU   PDREC+16                                                 02834000
PRBX     EQU   0                                                        02835000
@NM00071 EQU   PRBX                                                     02836000
PRBIP    EQU   @NM00071                                                 02837000
PRBIL    EQU   @NM00071+4                                               02838000
PRBIF    EQU   @NM00071+6                                               02839000
PRBIFP   EQU   PRBIF                                                    02840000
PRBXP    EQU   PRBX+16                                                  02841000
PRBI1    EQU   0                                                        02842000
PRBI2    EQU   0                                                        02843000
SUBTEXT  EQU   0                                                        02844000
I015F    EQU   0                                                        02845000
BLSCALOC EQU   0                                                        02846000
BLSDADSD EQU   0                                                        02847000
BLSDAPDR EQU   0                                                        02848000
BLSDDEQP EQU   0                                                        02849000
BLSDENQP EQU   0                                                        02850000
BLSDENQ0 EQU   0                                                        02851000
BLSDFDSD EQU   0                                                        02852000
BLSDFPDR EQU   0                                                        02853000
BLSEAUTH EQU   0                                                        02854000
BLSELPFM EQU   0                                                        02855000
BLSFBP00 EQU   0                                                        02856000
BLSFCLOS EQU   0                                                        02857000
BLSFCN00 EQU   0                                                        02858000
BLSFDALL EQU   0                                                        02859000
BLSFDF00 EQU   0                                                        02860000
BLSFDS00 EQU   0                                                        02861000
BLSFFL00 EQU   0                                                        02862000
BLSFFP00 EQU   0                                                        02863000
BLSFGD00 EQU   0                                                        02864000
BLSFGG00 EQU   0                                                        02865000
BLSFGP00 EQU   0                                                        02866000
BLSFLALL EQU   0                                                        02867000
BLSFLP00 EQU   0                                                        02868000
BLSFND00 EQU   0                                                        02869000
BLSFND01 EQU   0                                                        02870000
BLSFOD00 EQU   0                                                        02871000
BLSFOPEN EQU   0                                                        02872000
BLSFPERA EQU   0                                                        02873000
BLSFPS00 EQU   0                                                        02874000
BLSFSD00 EQU   0                                                        02875000
BLSFSL00 EQU   0                                                        02876000
BLSFTL00 EQU   0                                                        02877000
BLSFUD00 EQU   0                                                        02878000
BLSFUP00 EQU   0                                                        02879000
BLSUALLO EQU   0                                                        02880000
BLSUBLDD EQU   0                                                        02881000
BLSUBLDL EQU   0                                                        02882000
BLSUDYNA EQU   0                                                        02883000
BLSUFREE EQU   0                                                        02884000
BLSUFRE1 EQU   0                                                        02885000
BLSUMON  EQU   0                                                        02886000
BLSUMONA EQU   0                                                        02887000
BLSUMONC EQU   0                                                        02888000
BLSUMOND EQU   0                                                        02889000
BLSUMONL EQU   0                                                        02890000
BLSUMONT EQU   0                                                        02891000
BLSUMONX EQU   0                                                        02892000
BLSUMON2 EQU   0                                                        02893000
BLSUMPKN EQU   0                                                        02894000
BLSUMPK1 EQU   0                                                        02895000
BLSUPARI EQU   0                                                        02896000
BLSUPARU EQU   0                                                        02897000
BLSUPGMC EQU   0                                                        02898000
BLSUPGMD EQU   0                                                        02899000
BLSUPGML EQU   0                                                        02900000
BLSUPGMR EQU   0                                                        02901000
BLSUPRTA EQU   0                                                        02902000
BLSUPRTN EQU   0                                                        02903000
BLSUPUTA EQU   0                                                        02904000
BLSUPUTC EQU   0                                                        02905000
BLSUPUTD EQU   0                                                        02906000
BLSUPUTL EQU   0                                                        02907000
BLSUPUTN EQU   0                                                        02908000
BLSUPUTO EQU   0                                                        02909000
BLSUPUTT EQU   0                                                        02910000
BLSUPUTV EQU   0                                                        02911000
BLSUSTAI EQU   0                                                        02912000
BLSUTRMA EQU   0                                                        02913000
BLSUTRMN EQU   0                                                        02914000
BLSUTRMO EQU   0                                                        02915000
BLSUTRMV EQU   0                                                        02916000
BLSUVSAR EQU   0                                                        02917000
BLSUVSCR EQU   0                                                        02918000
BLSUVSEN EQU   0                                                        02919000
BLSUVSER EQU   0                                                        02920000
BLSUVSGE EQU   0                                                        02921000
BLSUVSGU EQU   0                                                        02922000
BLSUVSMR EQU   0                                                        02923000
BLSUVSPO EQU   0                                                        02924000
BLSUVSPU EQU   0                                                        02925000
BLSUZZ2C EQU   0                                                        02926000
BLSUZZ2D EQU   0                                                        02927000
BLSUZZ2R EQU   0                                                        02928000
DMCBRQC  EQU   0                                                        02929000
IKJEFF02 EQU   0                                                        02930000
IKJEFF18 EQU   0                                                        02931000
IKJEFF19 EQU   0                                                        02932000
IKJGETL  EQU   0                                                        02933000
IKJPARS  EQU   0                                                        02934000
IKJPTGT  EQU   0                                                        02935000
IKJPUTL  EQU   0                                                        02936000
IKJSCAN  EQU   0                                                        02937000
IKJSTCK  EQU   0                                                        02938000
I001C    EQU   0                                                        02939000
I008P    EQU   0                                                        02940000
I015P    EQU   0                                                        02941000
I031F    EQU   0                                                        02942000
I031P    EQU   0                                                        02943000
I256C    EQU   0                                                        02944000
ZZ2PARM  EQU   0                                                        02945000
LPWAPTR  EQU   0                                                        02946000
DMCBVSM  EQU   DMCBAMS                                                  02947000
DMCBQSM  EQU   DMCBAMS                                                  02948000
CPPL     EQU   ZZ2CPPL                                                  02949000
CPPLUPT  EQU   CPPL+4                                                   02950000
CPPLPSCB EQU   CPPL+8                                                   02951000
CPPLECT  EQU   CPPL+12                                                  02952000
PDRSTREC EQU   PDRINFO                                                  02953000
PDRODATE EQU   PDRSTREC                                                 02954000
PDROWNNM EQU   PDRSTREC+32                                              02955000
PDRDEREC EQU   PDRINFO                                                  02956000
PDRDESCR EQU   PDRDEREC                                                 02957000
PDRDESC  EQU   PDRDESCR                                                 02958000
PDRTRREC EQU   PDRINFO                                                  02959000
PDRTRARR EQU   PDRTRREC                                                 02960000
PDRHSREC EQU   PDRINFO                                                  02961000
PDRDSREC EQU   PDRINFO                                                  02962000
PDRDSNM  EQU   PDRDSREC                                                 02963000
PDRSVALU EQU   PDRODATE                                                 02964000
PARTTIME EQU   FULLTIME                                                 02965000
*                                      START UNREFERENCED COMPONENTS    02966000
@NM00069 EQU   PARTTIME+4                                               02967000
STARTIME EQU   PARTTIME                                                 02968000
PDRSVNUM EQU   PDRSVALU+3                                               02969000
PDRSVRES EQU   PDRSVALU                                                 02970000
PDRDSRES EQU   PDRDSREC+52                                              02971000
PDRMEMB  EQU   PDRDSNM+44                                               02972000
PDRDSN   EQU   PDRDSNM                                                  02973000
PDRHYMSD EQU   PDRHSREC+4                                               02974000
PDRHSLEN EQU   PDRHSREC                                                 02975000
PDRTRKD  EQU   PDRTRARR                                                 02976000
PDRDSSEQ EQU   PDRSTREC+396                                             02977000
PDRRES6  EQU   PDRSTREC+392                                             02978000
PDRTRKL  EQU   PDRSTREC+388                                             02979000
PDRDESCL EQU   PDRSTREC+384                                             02980000
PDRABS   EQU   PDRSTREC+256                                             02981000
PDRRES5  EQU   PDRSTREC+252                                             02982000
PDRFIXID EQU   PDRSTREC+192                                             02983000
PDRFTIME EQU   PDRSTREC+184                                             02984000
PDRFDATE EQU   PDRSTREC+176                                             02985000
PDRFSTAT EQU   PDRSTREC+172                                             02986000
PDRRES4  EQU   PDRSTREC+167                                             02987000
PDRPTFID EQU   PDRSTREC+160                                             02988000
PDRTTIME EQU   PDRSTREC+152                                             02989000
PDRTDATE EQU   PDRSTREC+144                                             02990000
PDRTSTAT EQU   PDRSTREC+140                                             02991000
PDRRES3  EQU   PDRSTREC+135                                             02992000
PDRAPRID EQU   PDRSTREC+128                                             02993000
PDRITIME EQU   PDRSTREC+120                                             02994000
PDRIDATE EQU   PDRSTREC+112                                             02995000
PDRISTAT EQU   PDRSTREC+104                                             02996000
PDRRTIME EQU   PDRSTREC+96                                              02997000
PDRRDATE EQU   PDRSTREC+88                                              02998000
PDRPTIME EQU   PDRSTREC+80                                              02999000
PDRPDATE EQU   PDRSTREC+72                                              03000000
PDRPSTAT EQU   PDRSTREC+64                                              03001000
PDRUSER  EQU   PDRSTREC+56                                              03002000
PDRSYS   EQU   PDRSTREC+48                                              03003000
PDRGROUP EQU   PDRSTREC+40                                              03004000
PDROWNLN EQU   PDROWNNM+7                                               03005000
PDROWNID EQU   PDROWNNM                                                 03006000
PDRRES1  EQU   PDRSTREC+27                                              03007000
PDRSEV   EQU   PDRSTREC+26                                              03008000
PDRCOMP  EQU   PDRSTREC+16                                              03009000
PDROTIME EQU   PDRSTREC+8                                               03010000
CPPLCBUF EQU   CPPL                                                     03011000
DMCBRES7 EQU   DMCBQSM+96                                               03012000
DMCBDCB  EQU   DMCBQSM                                                  03013000
DMCBACB  EQU   DMCBVSM+76                                               03014000
DMCBRPL  EQU   DMCBVSM                                                  03015000
@NM00073 EQU   @NM00071+7                                               03016000
@NM00072 EQU   PRBIF                                                    03017000
PDRRESV  EQU   PDREC+14                                                 03018000
PDRRECSQ EQU   PDRKEY+10                                                03019000
PDRKPREF EQU   PDRKPID                                                  03020000
SCBVALS  EQU   BLSESCB+16                                               03021000
SCBLASTP EQU   BLSESCB+12                                               03022000
SCBNXTSC EQU   BLSESCB+8                                                03023000
SCBFLDLN EQU   BLSESCB+4                                                03024000
SCBFLDOF EQU   BLSESCB                                                  03025000
LPSCBLKS EQU   BLSELPWA+16                                              03026000
LPFRMRES EQU   LPFRMFLG                                                 03027000
LPDSDESC EQU   LPFRMFLG                                                 03028000
LPDSNAME EQU   LPFRMFLG                                                 03029000
LPDESC   EQU   LPFRMFLG                                                 03030000
LPSTAT   EQU   LPFRMFLG                                                 03031000
LPSCBLKP EQU   BLSELPWA+4                                               03032000
LPWALEN  EQU   BLSELPWA                                                 03033000
FPRES6   EQU   FPBLOK+136                                               03034000
FPDELLN  EQU   FPDELNM+7                                                03035000
FPDELID  EQU   FPDELNM                                                  03036000
FPADMLN  EQU   FPADMNM+7                                                03037000
FPADMID  EQU   FPADMNM                                                  03038000
FPGRPID  EQU   FPBLOK+112                                               03039000
FPSYSID  EQU   FPBLOK+104                                               03040000
FPRES4   EQU   FPBLOK+103                                               03041000
FPRES3   EQU   FPBLOK+99                                                03042000
FPRES2   EQU   FPBLOK+92                                                03043000
FPDSDS   EQU   FPBLOK+48                                                03044000
FPRES1   EQU   FPBLOK+44                                                03045000
FPPDDS   EQU   FPBLOK                                                   03046000
DVT99999 EQU   DVT+256                                                  03047000
DVT0064P EQU   DVT+252                                                  03048000
DVT0063P EQU   DVT+248                                                  03049000
DVT0062P EQU   DVT+244                                                  03050000
DVT0061P EQU   DVT+240                                                  03051000
DVT0060P EQU   DVT+236                                                  03052000
DVT0059P EQU   DVT+232                                                  03053000
DVT0058P EQU   DVT+228                                                  03054000
DVT0057P EQU   DVT+224                                                  03055000
DVT0056P EQU   DVT+220                                                  03056000
DVT0055P EQU   DVT+216                                                  03057000
DVT0054P EQU   DVT+212                                                  03058000
DVT0053P EQU   DVT+208                                                  03059000
DVT0052P EQU   DVT+204                                                  03060000
DVT0051P EQU   DVT+200                                                  03061000
DVT0050P EQU   DVT+196                                                  03062000
DVT0049P EQU   DVT+192                                                  03063000
DVT0048P EQU   DVT+188                                                  03064000
DVT0047P EQU   DVT+184                                                  03065000
DVT0046P EQU   DVT+180                                                  03066000
DVT0045P EQU   DVT+176                                                  03067000
DVT0044P EQU   DVT+172                                                  03068000
DVT0043P EQU   DVT+168                                                  03069000
DVT0042P EQU   DVT+164                                                  03070000
DVT0041P EQU   DVT+160                                                  03071000
DVT0040P EQU   DVT+156                                                  03072000
DVT0039P EQU   DVT+152                                                  03073000
DVT0038P EQU   DVT+148                                                  03074000
DVT0037P EQU   DVT+144                                                  03075000
DVT0036P EQU   DVT+140                                                  03076000
DVT0035P EQU   DVT+136                                                  03077000
DVT0034P EQU   DVT+132                                                  03078000
DVT0011P EQU   DVT+40                                                   03079000
DVT0005P EQU   DVT+16                                                   03080000
DVT0002P EQU   DVT+4                                                    03081000
DVT0001P EQU   DVT                                                      03082000
BVT99999 EQU   BVT+256                                                  03083000
BVT0064P EQU   BVT+252                                                  03084000
BVT0063P EQU   BVT+248                                                  03085000
BVT0062P EQU   BVT+244                                                  03086000
BVT0061P EQU   BVT+240                                                  03087000
BVT0060P EQU   BVT+236                                                  03088000
BVT0059P EQU   BVT+232                                                  03089000
BVT0057P EQU   BVT+224                                                  03090000
BVT0056P EQU   BVT+220                                                  03091000
BVTSTBLP EQU   BVT+200                                                  03092000
BVT0045P EQU   BVT+176                                                  03093000
BVT0044P EQU   BVT+172                                                  03094000
BVT0033P EQU   BVT+128                                                  03095000
BVT0032P EQU   BVT+124                                                  03096000
BVT0031P EQU   BVT+120                                                  03097000
BVT0030P EQU   BVT+116                                                  03098000
BVT0029P EQU   BVT+112                                                  03099000
BVT0026P EQU   BVT+100                                                  03100000
BVT0025P EQU   BVT+96                                                   03101000
BVT0024P EQU   BVT+92                                                   03102000
BVT0023P EQU   BVT+88                                                   03103000
BVT0016P EQU   BVT+60                                                   03104000
BVT0015P EQU   BVT+56                                                   03105000
BVT0014P EQU   BVT+52                                                   03106000
BVT0003P EQU   BVT+8                                                    03107000
BVT0001P EQU   BVT                                                      03108000
SA99     EQU   SA+72                                                    03109000
SARC     EQU   SAR+56                                                   03110000
SARB     EQU   SAR+52                                                   03111000
SARA     EQU   SAR+48                                                   03112000
SAR9     EQU   SAR+44                                                   03113000
SAR8     EQU   SAR+40                                                   03114000
SAR7     EQU   SAR+36                                                   03115000
SAR6     EQU   SAR+32                                                   03116000
SAR5     EQU   SAR+28                                                   03117000
SAR4     EQU   SAR+24                                                   03118000
SAR3     EQU   SAR+20                                                   03119000
SAR2     EQU   SAR+16                                                   03120000
SAR1     EQU   SAR+12                                                   03121000
SAR0     EQU   SAR+8                                                    03122000
SARF     EQU   SAR+4                                                    03123000
SARE     EQU   SAR                                                      03124000
SAFWD    EQU   SA+8                                                     03125000
SABAK    EQU   SA+4                                                     03126000
SA1L     EQU   SA1+1                                                    03127000
SA1P     EQU   SA1                                                      03128000
UPTPREFL EQU   UPT+23                                                   03129000
UPTPREFX EQU   UPT+16                                                   03130000
@NM00068 EQU   UPT+15                                                   03131000
UPTLDEL  EQU   UPT+14                                                   03132000
UPTCDEL  EQU   UPT+13                                                   03133000
UPTWTP   EQU   UPTSWS                                                   03134000
UPTMODE  EQU   UPTSWS                                                   03135000
UPTALD   EQU   UPTSWS                                                   03136000
UPTPAUS  EQU   UPTSWS                                                   03137000
UPTNCOM  EQU   UPTSWS                                                   03138000
UPTMID   EQU   UPTSWS                                                   03139000
UPTNPRM  EQU   UPTSWS                                                   03140000
UPTRCVR  EQU   UPTSWS                                                   03141000
UPTUSER  EQU   UPT+2                                                    03142000
@NM00067 EQU   UPT                                                      03143000
@NM00066 EQU   ECT+52                                                   03144000
@NM00065 EQU   ECT+48                                                   03145000
@NM00064 EQU   ECT+44                                                   03146000
@NM00063 EQU   ECTSWS2+1                                                03147000
@NM00062 EQU   ECTSWS21                                                 03148000
ECTTABND EQU   ECTSWS21                                                 03149000
ECTDEFCS EQU   ECTSWS21                                                 03150000
ECTBKPB  EQU   ECT+36                                                   03151000
ECTUSER  EQU   ECT+32                                                   03152000
ECTDDNUM EQU   ECT+29                                                   03153000
ECTATTN  EQU   ECTSWS                                                   03154000
ECTBKGRD EQU   ECTSWS                                                   03155000
ECTNNOT  EQU   ECTSWS                                                   03156000
ECTNMAL  EQU   ECTSWS                                                   03157000
ECTLOGF  EQU   ECTSWS                                                   03158000
ECTATRM  EQU   ECTSWS                                                   03159000
@NM00061 EQU   ECTSWS                                                   03160000
ECTNOPD  EQU   ECTSWS                                                   03161000
ECTSCMD  EQU   ECT+20                                                   03162000
ECTPCMD  EQU   ECT+12                                                   03163000
ECTSMSG  EQU   ECT+9                                                    03164000
ECTMSGF  EQU   ECT+8                                                    03165000
ECTIOWA  EQU   ECT+4                                                    03166000
ECTRTCD  EQU   ECT+1                                                    03167000
ECTRCDF  EQU   ECT                                                      03168000
PSCBU    EQU   PSCB+64                                                  03169000
PSCBRSZ  EQU   PSCB+60                                                  03170000
PSCBLINE EQU   PSCB+59                                                  03171000
PSCBCHAR EQU   PSCB+58                                                  03172000
PSCBUPTL EQU   PSCB+56                                                  03173000
PSCBUPT  EQU   PSCB+52                                                  03174000
PSCBRLGB EQU   PSCB+48                                                  03175000
PSCBDEST EQU   PSCB+40                                                  03176000
@NM00060 EQU   PSCB+36                                                  03177000
@NM00059 EQU   PSCB+32                                                  03178000
@NM00058 EQU   PSCB+28                                                  03179000
PSCBLTI2 EQU   PSCB+24                                                  03180000
PSCBLTIM EQU   PSCB+20                                                  03181000
PSCBATR2 EQU   PSCB+18                                                  03182000
@NM00057 EQU   PSCBATR1                                                 03183000
@NM00056 EQU   PSCBATR1                                                 03184000
@NM00055 EQU   PSCBATR1                                                 03185000
PSCBATTN EQU   PSCBATR1                                                 03186000
PSCBVMNT EQU   PSCBATR1                                                 03187000
PSCBJCL  EQU   PSCBATR1                                                 03188000
PSCBACCT EQU   PSCBATR1                                                 03189000
PSCBCTRL EQU   PSCBATR1                                                 03190000
PSCBGPNM EQU   PSCB+8                                                   03191000
PSCBUSRL EQU   PSCB+7                                                   03192000
PSCBUSER EQU   PSCB                                                     03193000
CMDT1    EQU   CMDT                                                     03194000
CMDO     EQU   CMD+2                                                    03195000
CMDL     EQU   CMD                                                      03196000
ZZ299999 EQU   ZZ2+8192                                                 03197000
ZZ2AXOT1 EQU   ZZ2AXOT                                                  03198000
ZZ2AXOL  EQU   ZZ2AXO                                                   03199000
@NM00054 EQU   ZZ2+7288                                                 03200000
@NM00053 EQU   ZZ2AMDX+4                                                03201000
ZZ2AMDXC EQU   ZZ2AMDX                                                  03202000
ZZ2HSD   EQU   ZZ2+3056                                                 03203000
@NM00052 EQU   ZZ2ES                                                    03204000
@NM00051 EQU   ZZ2+2868                                                 03205000
ZZ2ITSEC EQU   ZZ2ITSE+1                                                03206000
@NM00050 EQU   ZZ2ITSE                                                  03207000
ZZ2ITSEP EQU   ZZ2ITSE                                                  03208000
ZZ2ITSEW EQU   ZZ2ITSE                                                  03209000
@NM00049 EQU   ZZ2ITR+20                                                03210000
ZZ2ITREC EQU   ZZ2ITRE+1                                                03211000
@NM00048 EQU   ZZ2ITRE                                                  03212000
ZZ2ITREP EQU   ZZ2ITRE                                                  03213000
ZZ2ITREW EQU   ZZ2ITRE                                                  03214000
@NM00047 EQU   ZZ2ITR+9                                                 03215000
ZZ2ITRRC EQU   ZZ2ITR+8                                                 03216000
ZZ2ITR2P EQU   ZZ2ITR+4                                                 03217000
ZZ2ITRPP EQU   ZZ2ITR                                                   03218000
@NM00046 EQU   ZZ2+1544                                                 03219000
ZZ2PGM   EQU   ZZ2+1536                                                 03220000
@NM00045 EQU   ZZ2+1526                                                 03221000
ZZ2CW    EQU   ZZ2+1524                                                 03222000
@NM00044 EQU   ZZ2+1504                                                 03223000
@NM00043 EQU   ZZ2+1352                                                 03224000
ZZ2FFSYP EQU   ZZ2+1348                                                 03225000
ZZ2SASYP EQU   ZZ2+1344                                                 03226000
ZZ2RDSYP EQU   ZZ2+1340                                                 03227000
ZZ2RASYP EQU   ZZ2+1336                                                 03228000
ZZ2PHSYP EQU   ZZ2+1332                                                 03229000
ZZ2ESSYP EQU   ZZ2+1328                                                 03230000
ZZ200SYP EQU   ZZ2+1324                                                 03231000
ZZ2SCWP  EQU   ZZ2+1320                                                 03232000
ZZ2TTLP  EQU   ZZ2+1316                                                 03233000
ZZ2LOADP EQU   ZZ2+1312                                                 03234000
ZZ2VRESP EQU   ZZ2+1308                                                 03235000
ZZ2CPPLE EQU   ZZ2CPPL+12                                               03236000
ZZ2CPPLP EQU   ZZ2CPPL+8                                                03237000
ZZ2CPPLU EQU   ZZ2CPPL+4                                                03238000
ZZ2VRSAP EQU   ZZ2+1288                                                 03239000
ZZ2RVTP  EQU   ZZ2+1284                                                 03240000
@NM00042 EQU   ZZ2+1272                                                 03241000
@NM00041 EQU   ZZ2+1268                                                 03242000
ZZ2RPLP  EQU   ZZ2+1260                                                 03243000
ZZ2TCBP  EQU   ZZ2+1256                                                 03244000
@NM00040 EQU   ZZ2+1252                                                 03245000
ZZ2ZZ2P  EQU   ZZ2+1248                                                 03246000
@NM00039 EQU   ZZ2+1112                                                 03247000
@NM00038 EQU   ZZ2+1080                                                 03248000
ZZ2FT25P EQU   ZZ2+1072                                                 03249000
@NM00037 EQU   ZZ2+976                                                  03250000
ZZ2TOD   EQU   ZZ2+968                                                  03251000
ZZ2STGN  EQU   ZZ2STG+4                                                 03252000
ZZ2STGP  EQU   ZZ2STG                                                   03253000
@NM00036 EQU   ZZ2+952                                                  03254000
ZZ2SCMDE EQU   ZZ2+944                                                  03255000
ZZ2SCMDN EQU   ZZ2+936                                                  03256000
ZZ2IDENT EQU   ZZ2+928                                                  03257000
ZZ2A9999 EQU   ZZ2A+656                                                 03258000
@NM00035 EQU   ZZ2A+224                                                 03259000
@NM00034 EQU   ZZ2A+220                                                 03260000
ZZ2AQD99 EQU   ZZ2AQD+60                                                03261000
@NM00033 EQU   ZZ2AQD+56                                                03262000
@NM00032 EQU   ZZ2AQDF                                                  03263000
ZZ2AQDFA EQU   ZZ2AQDF                                                  03264000
ZZ2AQDIL EQU   ZZ2AQD+48                                                03265000
ZZ2AQDIM EQU   ZZ2AQD+44                                                03266000
ZZ2AQDT9 EQU   ZZ2AQDT+34                                               03267000
ZZ2AQDTE EQU   ZZ2AQDT+33                                               03268000
ZZ2AQDTD EQU   ZZ2AQDT+2                                                03269000
@NM00031 EQU   ZZ2AQDT+1                                                03270000
ZZ2AQDTY EQU   ZZ2AQDT                                                  03271000
ZZ2AQDT0 EQU   ZZ2AQDT                                                  03272000
ZZ2AQDLB EQU   ZZ2AQD+9                                                 03273000
ZZ2AQDOB EQU   ZZ2AQD+8                                                 03274000
ZZ2AQDLE EQU   ZZ2AQD+4                                                 03275000
ZZ2AQDOF EQU   ZZ2AQD                                                   03276000
ZZ2AQD00 EQU   ZZ2AQD                                                   03277000
ZZ2AQAS9 EQU   ZZ2AQAS+16                                               03278000
@NM00030 EQU   ZZ2AQAS+12                                               03279000
ZZ2AQAS2 EQU   ZZ2AQAS+8                                                03280000
ZZ2AQAS1 EQU   ZZ2AQAS+4                                                03281000
@NM00029 EQU   ZZ2AQAS+2                                                03282000
ZZ2AQAST EQU   ZZ2AQAS                                                  03283000
ZZ2AQAS0 EQU   ZZ2AQAS                                                  03284000
ZZ2AZZ6P EQU   ZZ2A+140                                                 03285000
ZZ2ADPTA EQU   ZZ2ADPT                                                  03286000
ZZ2ADPL  EQU   ZZ2ADP                                                   03287000
ZZ2ADMTA EQU   ZZ2ADMT                                                  03288000
ZZ2ADML  EQU   ZZ2ADM                                                   03289000
ZZ2ADDTA EQU   ZZ2ADDT                                                  03290000
ZZ2ADDL  EQU   ZZ2ADD                                                   03291000
@NM00028 EQU   ZZ2A+72                                                  03292000
ZZ2APIDA EQU   ZZ2APID                                                  03293000
@NM00027 EQU   ZZ2A+24                                                  03294000
@NM00026 EQU   ZZ2AF+5                                                  03295000
ZZ2AFX   EQU   ZZ2AF+5                                                  03296000
@NM00025 EQU   ZZ2AF+3                                                  03297000
ZZ2AFS   EQU   ZZ2AF+2                                                  03298000
ZZ2AFD   EQU   ZZ2AF+2                                                  03299000
ZZ2AFQ   EQU   ZZ2AF+2                                                  03300000
ZZ2AF$   EQU   ZZ2AF+2                                                  03301000
@NM00024 EQU   ZZ2AF+2                                                  03302000
ZZ2AFM   EQU   ZZ2AF+2                                                  03303000
@NM00023 EQU   ZZ2AF+2                                                  03304000
@NM00022 EQU   ZZ2AF+1                                                  03305000
ZZ2AFV   EQU   ZZ2AF+1                                                  03306000
@NM00021 EQU   ZZ2AF+1                                                  03307000
ZZ2AFC   EQU   ZZ2AF+1                                                  03308000
@NM00020 EQU   ZZ2AF                                                    03309000
ZZ2AFFS  EQU   ZZ2AF                                                    03310000
@NM00019 EQU   ZZ2A+8                                                   03311000
ZZ2ALINE EQU   ZZ2A+4                                                   03312000
@NM00018 EQU   ZZ2A+3                                                   03313000
ZZ2ASE   EQU   ZZ2A+2                                                   03314000
ZZ2ACH   EQU   ZZ2A                                                     03315000
@NM00017 EQU   ZZ2+264                                                  03316000
@NM00016 EQU   ZZ2+263                                                  03317000
ZZ2PRTT0 EQU   ZZ2PRTT                                                  03318000
ZZ2PRTO  EQU   ZZ2PRT+2                                                 03319000
ZZ2PRTL  EQU   ZZ2PRT                                                   03320000
@NM00015 EQU   ZZ2AMD+56                                                03321000
ZZ2AMDXP EQU   ZZ2AMD+52                                                03322000
ZZ2AMDD  EQU   ZZ2AMD+48                                                03323000
ZZ2AMDL  EQU   ZZ2AMD+44                                                03324000
ZZ2AMDU  EQU   ZZ2AMD+28                                                03325000
ZZ2AMDF  EQU   ZZ2AMD+24                                                03326000
ZZ2AMDS  EQU   ZZ2AMD+20                                                03327000
ZZ2AMDC  EQU   ZZ2AMD+16                                                03328000
ZZ2AMDP  EQU   ZZ2AMD+12                                                03329000
ZZ2AMDB  EQU   ZZ2AMD+8                                                 03330000
@NM00014 EQU   @NM00013                                                 03331000
ZZ2AMD2  EQU   @NM00013                                                 03332000
ZZ2AMD1  EQU   @NM00013                                                 03333000
ZZ2AMD0  EQU   ZZ2AMD+6                                                 03334000
ZZ2AMDA  EQU   ZZ2AMD+4                                                 03335000
ZZ2AMDT  EQU   ZZ2AMD                                                   03336000
ZZ199999 EQU   ZZ1+3072                                                 03337000
@NM00012 EQU   ZZ1+2160                                                 03338000
ZZ1TRTAS EQU   ZZ1+1904                                                 03339000
ZZ1TRUPC EQU   ZZ1+1648                                                 03340000
ZZ1TRCTX EQU   ZZ1+1392                                                 03341000
ZZ1NASID EQU   ZZ1N+274                                                 03342000
ZZ1NSTRL EQU   ZZ1N+272                                                 03343000
ZZ1NOFF  EQU   ZZ1N+268                                                 03344000
ZZ1NBDY  EQU   ZZ1N+264                                                 03345000
ZZ1NADE  EQU   ZZ1N+260                                                 03346000
ZZ1NADB  EQU   ZZ1N+256                                                 03347000
ZZ1NSTR  EQU   ZZ1N                                                     03348000
@NM00011 EQU   ZZ1+1080                                                 03349000
ZZ1TREBC EQU   ZZ1+824                                                  03350000
ZZ1TRHEX EQU   ZZ1+568                                                  03351000
@NM00010 EQU   ZZ1+377                                                  03352000
ZZ1USTAE EQU   ZZ1+376                                                  03353000
@NM00009 EQU   ZZ1F+1                                                   03354000
@NM00008 EQU   ZZ1F                                                     03355000
ZZ1FM    EQU   ZZ1F                                                     03356000
ZZ1FX    EQU   ZZ1F                                                     03357000
ZZ1FU    EQU   ZZ1F                                                     03358000
ZZ1EVEC  EQU   ZZ1EVE+1                                                 03359000
@NM00007 EQU   ZZ1EVE                                                   03360000
ZZ1EVEW  EQU   ZZ1EVE                                                   03361000
ZZ1ACMP  EQU   ZZ1ATTN                                                  03362000
@NM00006 EQU   ZZ1+144                                                  03363000
ZZ1ZZ6P  EQU   ZZ1+136                                                  03364000
@NM00005 EQU   ZZ1+84                                                   03365000
ZZ1PLINE EQU   ZZ1+80                                                   03366000
ZZ1PGSZ  EQU   ZZ1+76                                                   03367000
ZZ1PCNT  EQU   ZZ1+72                                                   03368000
@NM00004 EQU   ZZ1+68                                                   03369000
ZZ1TPAGE EQU   ZZ1+64                                                   03370000
ZZ1TLINE EQU   ZZ1+60                                                   03371000
@NM00003 EQU   ZZ1+52                                                   03372000
ZZ1DMCBP EQU   ZZ1+48                                                   03373000
ZZ1DSDP  EQU   ZZ1+44                                                   03374000
ZZ1ZZ2P  EQU   ZZ1+36                                                   03375000
ZZ1327WP EQU   ZZ1+32                                                   03376000
ZZ1ACBP  EQU   ZZ1+28                                                   03377000
@NM00002 EQU   ZZ1+24                                                   03378000
ZZ1PDCBP EQU   ZZ1+20                                                   03379000
ZZ1BLRBL EQU   ZZ1+16                                                   03380000
@NM00001 EQU   ZZ1+12                                                   03381000
ZZ1PNULL EQU   ZZ1+8                                                    03382000
ZZ1NULL  EQU   ZZ1+4                                                    03383000
ZZ1IDE   EQU   ZZ1                                                      03384000
DMCBWRK  EQU   DMCB+648                                                 03385000
DMCBRES8 EQU   DMCB+640                                                 03386000
DMCBMODN EQU   DMCB+632                                                 03387000
DMCBCARY EQU   DMCBAUDT+20                                              03388000
DMCBCLC  EQU   DMCBAUDT+12                                              03389000
DMCBOPC  EQU   DMCBAUDT+8                                               03390000
DMCBFRC  EQU   DMCBAUDT+4                                               03391000
DMCBALC  EQU   DMCBAUDT                                                 03392000
DMCBFR   EQU   DMCB+412                                                 03393000
DMCBRES6 EQU   DMCB+410                                                 03394000
DMCBIRSC EQU   DMCB+408                                                 03395000
DMCBSUBC EQU   DMCB+404                                                 03396000
DMCBDRBP EQU   DMCB+400                                                 03397000
DMCBRSZM EQU   DMCB+398                                                 03398000
DMCBRSZA EQU   DMCB+396                                                 03399000
DMCBCISZ EQU   DMCB+394                                                 03400000
DMCBDCBL EQU   DMCB+392                                                 03401000
DMCBDCLR EQU   DMCB+390                                                 03402000
DMCBDCFM EQU   DMCB+389                                                 03403000
DMCBRES5 EQU   DMCB+388                                                 03404000
DMCBLBRT EQU   DMCB+386                                                 03405000
DMCBLBSQ EQU   DMCB+384                                                 03406000
DMCBLBPS EQU   DMCB+383                                                 03407000
DMCBLBTY EQU   DMCB+382                                                 03408000
DMCBRES4 EQU   DMCB+381                                                 03409000
DMCBSPRS EQU   DMCBSPEC                                                 03410000
DMCBSPRN EQU   DMCBSPEC                                                 03411000
DMCBSPCT EQU   DMCBSPEC                                                 03412000
DMCBSPRL EQU   DMCBSPEC                                                 03413000
DMCBSPSE EQU   DMCB+376                                                 03414000
DMCBSPPR EQU   DMCB+372                                                 03415000
DMCBSPTY EQU   DMCB+369                                                 03416000
DMCBODIS EQU   DMCB+368                                                 03417000
DMCBDISP EQU   DMCB+367                                                 03418000
DMCBSTAT EQU   DMCB+366                                                 03419000
DMCBRES3 EQU   DMCB+364                                                 03420000
DMCBMEMB EQU   DMCB+356                                                 03421000
DMCBMODL EQU   DMCB+348                                                 03422000
DMCBRES9 EQU   DMCB+340                                                 03423000
DMCBPID  EQU   DMCB+332                                                 03424000
DMCBTYPE EQU   DMCB+328                                                 03425000
DMCBDSN  EQU   DMCB+284                                                 03426000
DMCBUNIT EQU   DMCB+276                                                 03427000
DMCBDSOR EQU   DMCB+274                                                 03428000
DMCBVOL  EQU   DMCB+268                                                 03429000
DMCBDDNM EQU   DMCB+260                                                 03430000
DMCBSYNM EQU   DMCB+132                                                 03431000
DMCBRPLF EQU   DMCB+128                                                 03432000
DMCBDCBE EQU   DMCBACBE                                                 03433000
DMCBARC  EQU   DMCB+120                                                 03434000
DMCBCPC  EQU   DMCB+116                                                 03435000
DMCBRET  EQU   DMCB+112                                                 03436000
DMCBSTL  EQU   DMCB+96                                                  03437000
DMCBEOB  EQU   DMCB+92                                                  03438000
DMCBFRE  EQU   DMCB+88                                                  03439000
DMCBRES2 EQU   DMCB+85                                                  03440000
DMCBSPID EQU   DMCB+84                                                  03441000
DMCBRESC EQU   DMCB+80                                                  03442000
DMCBZZ1P EQU   DMCB+76                                                  03443000
DMCBMSGS EQU   DMCB+72                                                  03444000
DMCBMSG0 EQU   DMCB+68                                                  03445000
DMCBRRL  EQU   DMCB+60                                                  03446000
DMCBRBA  EQU   DMCB+56                                                  03447000
DMCBKPC  EQU   DMCBKEYP                                                 03448000
DMCBORL  EQU   DMCB+40                                                  03449000
DMCBBFPC EQU   DMCBBUFP                                                 03450000
DMCBRES1 EQU   DMCB+31                                                  03451000
DMCBACCM EQU   DMCB+30                                                  03452000
DMCBREJ  EQU   DMCB+29                                                  03453000
DMCBRESB EQU   DMCBMFLG                                                 03454000
DMCBFMOD EQU   DMCBMFLG                                                 03455000
DMCBLOPT EQU   DMCB+27                                                  03456000
DMCBLRM  EQU   DMCB+26                                                  03457000
DMCBLRQ  EQU   DMCB+25                                                  03458000
DMCBOPRS EQU   DMCBOPTS                                                 03459000
DMCBLRD  EQU   DMCBOPTS                                                 03460000
DMCBBWD  EQU   DMCBOPTS                                                 03461000
DMCBRMRS EQU   DMCBRMOD                                                 03462000
DMCBRESA EQU   DMCBOPN                                                  03463000
DMCBSOUT EQU   DMCBOPN                                                  03464000
DMCBSIN  EQU   DMCBOPN                                                  03465000
DMCBVSF  EQU   DMCBFTY                                                  03466000
DMCBKSF  EQU   DMCBFTY                                                  03467000
DMCBFTRS EQU   DMCBFTY                                                  03468000
DMCBSHF  EQU   DMCBFTY                                                  03469000
DMCBIRL  EQU   DMCB+16                                                  03470000
DMCBRTC  EQU   DMCB+12                                                  03471000
DMCBTVP  EQU   DMCB+8                                                   03472000
DMCBNEXT EQU   DMCB+4                                                   03473000
*                                      END UNREFERENCED COMPONENTS      03474000
@RC00196 EQU   @RC00188                                                 03475000
@RC00304 EQU   @RC00302                                                 03476000
@RC00310 EQU   @RC00302                                                 03477000
@RC00396 EQU   @RC00394                                                 03478000
@RC00429 EQU   @RC00394                                                 03479000
@RC00677 EQU   @RC00632                                                 03480000
@RC00361 EQU   @RC00310                                                 03481000
@RC00339 EQU   @RC00310                                                 03482000
@RC00430 EQU   @RC00429                                                 03483000
@ENDDATA EQU   *                                                        03484000
         END   BLSELPDR,(C'PLS1152',0701,78065)                         03485000
