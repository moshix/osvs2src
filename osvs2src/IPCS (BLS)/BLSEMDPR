MDPR     TITLE 'BLSEMDPR- MODIFY PROBLEM IN IPCS DATA BASE             *00001000
                        '                                               00002000
*     /* CHANGE ACTIVITY                                                00003000
*    THIS MODULE IS WRITTEN FOR @G57LPJD                                00004000
*            01/25/78 PTM 7626                                          00005000
*            01/30/78 PTM 7647                                          00006000
*            01/30/78 PTM 7658                                          00007000
*            01/30/78 PTM 7662                                          00008000
*            01/31/78 PTM 7638                                          00009000
*            01/31/78 PTM 7665                                          00010000
*            02/10/78 PTM 7720                                          00011000
*            02/16/78 PTM 7769                                          00012000
BLSEMDPR CSECT ,                                                   0002 00013000
@MAINENT DS    0H                                                  0002 00014000
         USING *,@15                                               0002 00015000
         B     @PROLOG                                             0002 00016000
         DC    AL1(16)                                             0002 00017000
         DC    C'BLSEMDPR  78.066'                                 0002 00018000
         DROP  @15                                                      00019000
@PROLOG  STM   @14,@12,12(@13)                                     0002 00020000
         BALR  @12,0                                               0002 00021000
@PSTART  LA    @10,4095(,@12)                                      0002 00022000
         USING @PSTART,@12                                         0002 00023000
         USING @PSTART+4095,@10                                    0002 00024000
         L     @00,@SIZDATD                                        0002 00025000
         BLSUALLR R,LV=(0)                                              00026000
         LR    @11,@01                                             0002 00027000
         USING @DATD,@11                                           0002 00028000
         ST    @13,@SA00001+4                                      0002 00029000
         LM    @00,@01,20(@13)                                     0002 00030000
         ST    @11,8(,@13)                                         0002 00031000
         LR    @13,@11                                             0002 00032000
*BLREXTRN - IDENTIFY EXTERNAL REFERENCES                                00033000
         EXTRN BLSDDT00                                                 00034000
         EXTRN BLSDTM00                                                 00035000
         EXTRN BLSDSV00                                                 00036000
         EXTRN BLSDC070                                                 00037000
         EXTRN BLSDC600                                                 00038000
         EXTRN BLSDC128                                                 00039000
*   ZZ2PTR=R1;                      /* GET TASK VARIABLE             */ 00040000
         LR    ZZ2PTR,R1                                           0377 00041000
*   RESPECIFY                                                      0378 00042000
*     R1 UNRESTRICTED;              /* FINISHED WITH REG1            */ 00043000
*   RETC=0;                         /* INITIALIZE THE RETC           */ 00044000
         SLR   RETC,RETC                                           0379 00045000
         SPACE 1                                                        00046000
*   DO;                             /* BLSUPARS MF(E,PX)             */ 00047000
*     CALL BLSUPARI(ZZ2,PCCSECT,PDAPTR);/* PARSE OPERANDS            */ 00048000
         ST    ZZ2PTR,@AL00001                                     0381 00049000
         L     @09,PCPTR                                           0381 00050000
         ST    @09,@AL00001+4                                      0381 00051000
         LA    @09,PDAPTR                                          0381 00052000
         ST    @09,@AL00001+8                                      0381 00053000
         L     @09,ZZ2BVTP(,ZZ2PTR)                                0381 00054000
         L     @15,BVTPARIP(,@09)                                  0381 00055000
         LA    @01,@AL00001                                        0381 00056000
         BALR  @14,@15                                             0381 00057000
*     RESPECIFY                                                    0382 00058000
*      (GPR15F) RESTRICTED;                                        0382 00059000
*     IF GPR15F^=ZZZFLAGI THEN                                     0383 00060000
*                                                                  0383 00061000
         LTR   GPR15F,GPR15F                                       0383 00062000
         BZ    @RF00383                                            0383 00063000
*       /*************************************************************/ 00064000
*       /*                                                           */ 00065000
*       /* UNABLE TO PARSE                                           */ 00066000
*       /*                                                           */ 00067000
*       /*************************************************************/ 00068000
*                                                                  0384 00069000
*       DO;                         /* UNABLE TO PARSE               */ 00070000
*         RETC=GPR15F;              /* RETURN CODE                   */ 00071000
         LR    RETC,GPR15F                                         0385 00072000
*         GO TO EXITNORL;           /* EXIT WITHOUT PDL              */ 00073000
         B     EXITNORL                                            0386 00074000
*       END;                                                       0387 00075000
*     RESPECIFY                                                    0388 00076000
*      (GPR15F) UNRESTRICTED;                                      0388 00077000
@RF00383 DS    0H                                                  0389 00078000
*     RESPECIFY                                                    0389 00079000
*      (PDRPTR) RESTRICTED;                                        0389 00080000
*     PDRPTR=PDAPTR;                /* ->PDL                         */ 00081000
         L     PDRPTR,PDAPTR                                       0390 00082000
*     GENERATE REFS(PD,PDRPTR) CODE(USING PD,PDRPTR);              0391 00083000
         USING PD,PDRPTR                                                00084000
*     IF PXTEST=PXTEST1 THEN                                       0392 00085000
         CLC   PXTEST(2),@CH00041                                  0392 00086000
         BNE   @RF00392                                            0392 00087000
*       ZZ2AFX=ZZZ1;                /* TEST                          */ 00088000
         OI    ZZ2AFX(ZZ2PTR),B'10000000'                          0393 00089000
*     ELSE                                                         0394 00090000
*       IF PXTEST=PXTEST0 THEN                                     0394 00091000
         B     @RC00392                                            0394 00092000
@RF00392 CLC   PXTEST(2),@CH00068                                  0394 00093000
         BNE   @RF00394                                            0394 00094000
*         ZZ2AFX=ZZZ0;              /* NOTEST                        */ 00095000
         NI    ZZ2AFX(ZZ2PTR),B'01111111'                          0395 00096000
*   END;                            /* BLSUPARS MF(E,PX) ISSUE THE 0396 00097000
*                                      CALL TO IKJPARSE              */ 00098000
@RF00394 DS    0H                                                  0396 00099000
@RC00392 DS    0H                                                  0397 00100000
         EJECT                                                          00101000
*                                                                  0397 00102000
*/********************************************************************/ 00103000
*/*                                                                  */ 00104000
*/* COMMAND PROCESSOR CODE BEGINS                                    */ 00105000
*/*                                                                  */ 00106000
*/********************************************************************/ 00107000
*                                                                  0397 00108000
*   IF ZZ2APID=ZZZNPROB&(PIDIFP^=ON|PIDIL=0) THEN                  0397 00109000
         CLC   ZZ2APID(8,ZZ2PTR),@CC00104                          0397 00110000
         BNE   @RF00397                                            0397 00111000
         TM    PIDIFP,B'10000000'                                  0397 00112000
         BNO   @RT00397                                            0397 00113000
         LH    @09,PIDIL                                           0397 00114000
         LTR   @09,@09                                             0397 00115000
         BNZ   @RF00397                                            0397 00116000
@RT00397 DS    0H                                                  0398 00117000
*     DO;                           /* NO PROBLEM IDENTIFIER         */ 00118000
*       CALL MSG4(04003);           /* TELL USER                     */ 00119000
         LA    @01,@AL00399                                        0399 00120000
         BAL   @14,MSG4                                            0399 00121000
*       RETC=EIGHT;                 /* SET ERROR RETURN CODE         */ 00122000
         LA    RETC,8                                              0400 00123000
*     END;                                                         0401 00124000
*   ELSE                                                           0402 00125000
*     DO;                                                          0402 00126000
         B     @RC00397                                            0402 00127000
@RF00397 DS    0H                                                  0403 00128000
*       BUFPTR=ADDR(BUF1);          /* SET POINTER TO MYBUF          */ 00129000
         LA    BUFPTR,BUF1                                         0403 00130000
*       PDRKPID=ZZ2APID;            /* SET DEFAULT PROBLEM ID IN KEY */ 00131000
         MVC   PDRKPID(8,BUFPTR),ZZ2APID(ZZ2PTR)                   0404 00132000
*       IF PIDIFP=ON&PIDIL^=0 THEN  /* IF PID IN COMMAND             */ 00133000
         TM    PIDIFP,B'10000000'                                  0405 00134000
         BNO   @RF00405                                            0405 00135000
         LH    @09,PIDIL                                           0405 00136000
         LTR   @09,@09                                             0405 00137000
         BZ    @RF00405                                            0405 00138000
*         DO;                                                      0406 00139000
*           PDRKPID='00000000';     /* CLEAR PROBLEM ID              */ 00140000
         MVC   PDRKPID(8,BUFPTR),@CC01526                          0407 00141000
*           PDRKPID(9-PIDIL:8)=PIDI(1:PIDIL);/* USE IT               */ 00142000
         LCR   @09,@09                                             0408 00143000
         AL    @09,@CF01019                                        0408 00144000
         ST    @09,@TF00001                                        0408 00145000
         ALR   @09,BUFPTR                                          0408 00146000
         LA    @04,8                                               0408 00147000
         SL    @04,@TF00001                                        0408 00148000
         L     @01,PIDIP                                           0408 00149000
         EX    @04,@SM01651                                        0408 00150000
*         END;                                                     0409 00151000
*       ELSE                                                       0410 00152000
*         ;                         /* LEAVE DEFAULT PID IN KEY      */ 00153000
@RF00405 DS    0H                                                  0411 00154000
*       CALL BLSDENQP(ZZ2,PDRKPNUM,'E');/* ENQUEUE ON PROBLEM        */ 00155000
         ST    ZZ2PTR,@AL00001                                     0411 00156000
         LA    @09,PDRKPNUM(,BUFPTR)                               0411 00157000
         ST    @09,@AL00001+4                                      0411 00158000
         LA    @09,@CC01527                                        0411 00159000
         ST    @09,@AL00001+8                                      0411 00160000
         L     @09,ZZ2DVTP(,ZZ2PTR)                                0411 00161000
         L     @15,DVTENQPP(,@09)                                  0411 00162000
         LA    @01,@AL00001                                        0411 00163000
         BALR  @14,@15                                             0411 00164000
*       RESPECIFY                                                  0412 00165000
*         RF RESTRICTED;                                           0412 00166000
*       IF RF=0 THEN                                               0413 00167000
         LTR   RF,RF                                               0413 00168000
         BNZ   @RF00413                                            0413 00169000
*         DO;                                                      0414 00170000
*           RESPECIFY                                              0415 00171000
*             RF;                                                  0415 00172000
*           CALL BLSDTIME(ZZ2,CURTIME,CURDATE);/* GET CURRENT TIME 0416 00173000
*                                      AND DATE                      */ 00174000
         ST    ZZ2PTR,@AL00001                                     0416 00175000
         LA    @09,CURTIME                                         0416 00176000
         ST    @09,@AL00001+4                                      0416 00177000
         LA    @09,CURDATE                                         0416 00178000
         ST    @09,@AL00001+8                                      0416 00179000
         L     @15,@CV01369                                        0416 00180000
         LA    @01,@AL00001                                        0416 00181000
         BALR  @14,@15                                             0416 00182000
*           RESPECIFY                                              0417 00183000
*             RF RESTRICTED;                                       0417 00184000
*           IF RF^=0 THEN           /* CHECK RETURN CODE             */ 00185000
         LTR   RF,RF                                               0418 00186000
         BZ    @RF00418                                            0418 00187000
*             DO;                   /* SOMETHING IS WRONG WITH TIME  */ 00188000
*               RESPECIFY                                          0420 00189000
*                 RF UNRESTRICTED;                                 0420 00190000
*               CURTIME='';         /* SET TIME TO BLANKS            */ 00191000
         MVI   CURTIME,C' '                                        0421 00192000
         MVC   CURTIME+1(7),CURTIME                                0421 00193000
*               CURDATE='';         /* SET DATE TO BLANKS            */ 00194000
         MVI   CURDATE,C' '                                        0422 00195000
         MVC   CURDATE+1(7),CURDATE                                0422 00196000
*             END;                                                 0423 00197000
*           ELSE                                                   0424 00198000
*             ;                     /* TIME AND DATE ARE OK          */ 00199000
@RF00418 DS    0H                                                  0425 00200000
*           DO;                     /* BLSOPEN(ZZ1PDRP)OUTPUT        */ 00201000
*             RFY                                                  0426 00202000
*               GPR01P RSTD;                                       0426 00203000
*             GPR01P=ZZ1PDRP;       /* ADDRESS DMCB                  */ 00204000
         L     @09,ZZ2ZZ1P(,ZZ2PTR)                                0427 00205000
         L     GPR01P,ZZ1PDRP(,@09)                                0427 00206000
*             RFY                                                  0428 00207000
*               DMCB BASED(GPR01P);                                0428 00208000
*             IF((GPR01P&'FFFFFFF8'X)=GPR01P)&DMCBID='DMCB'/* VALID     00209000
*                                      DMCB ?                        */ 00210000
*               THEN                                               0429 00211000
         LR    @09,GPR01P                                          0429 00212000
         N     @09,@CF01531                                        0429 00213000
         CLR   @09,GPR01P                                          0429 00214000
         BNE   @RF00429                                            0429 00215000
         CLC   DMCBID(4,GPR01P),@CC01532                           0429 00216000
         BNE   @RF00429                                            0429 00217000
*               DO;                                                0430 00218000
*                 DMCBRQST=DMCBOPR; /* INDICATE OPEN REQUEST         */ 00219000
         MVI   DMCBRQST(GPR01P),X'01'                              0431 00220000
*                 DMCBOUT='1'B;     /* INDICATE OPEN FOR OUTPUR      */ 00221000
         OI    DMCBOUT(GPR01P),B'10000000'                         0432 00222000
*                 CALL DMCBRI->DMCBDMGR;/* CALL BLSCRQST             */ 00223000
         L     @15,DMCBRI(,GPR01P)                                 0433 00224000
         BALR  @14,@15                                             0433 00225000
*               END;                                               0434 00226000
*             ELSE                                                 0435 00227000
*               DO;                                                0435 00228000
         B     @RC00429                                            0435 00229000
@RF00429 DS    0H                                                  0436 00230000
*                 RFY                                              0436 00231000
*                  (GPR00F,                                        0436 00232000
*                   GPR15F) RSTD;                                  0436 00233000
*                 GPR00F=0;         /* INDICATE NO MESSAGE CHAIN     */ 00234000
         SLR   GPR00F,GPR00F                                       0437 00235000
*                 GPR15F=16;        /* INDICATE INVALID DMCB         */ 00236000
         LA    GPR15F,16                                           0438 00237000
*                 RFY                                              0439 00238000
*                  (GPR00F,                                        0439 00239000
*                   GPR15F);                                       0439 00240000
*               END;                                               0440 00241000
*             RFY                                                  0441 00242000
*               DMCB;                                              0441 00243000
@RC00429 DS    0H                                                  0442 00244000
*             RFY                                                  0442 00245000
*               GPR01P;                                            0442 00246000
*           END;                    /* BLSOPEN(ZZ1PDRP)OUTPUT OPEN 0443 00247000
*                                      PROBLEM DIRECTORY             */ 00248000
*           RESPECIFY                                              0444 00249000
*             RF RESTRICTED;                                       0444 00250000
*           IF RF^=0 THEN           /* IF OPEN NOT OK                */ 00251000
         LTR   RF,RF                                               0445 00252000
         BZ    @RF00445                                            0445 00253000
*             DO;                                                  0446 00254000
*               IF RF=16 THEN       /* IF INVALID DMCB               */ 00255000
         C     RF,@CF00052                                         0447 00256000
         BNE   @RF00447                                            0447 00257000
*                 DO;               /* ABEND(200) DUMP               */ 00258000
*                   RESPECIFY                                      0449 00259000
*                    (GPR01F) RESTRICTED;                          0449 00260000
*                   GPR01F=200;     /* COMP CODE IN REG 1            */ 00261000
         LA    GPR01F,200                                          0450 00262000
*                   GPR01F=GPR01F|'80000000'X;/* DUMP/STEP/DUMPOPTS     00263000
*                                      FLAG                          */ 00264000
         O     GPR01F,@CF00061                                     0451 00265000
*                   SVC(13);        /* ISSUE ABEND SVC               */ 00266000
         SVC   13                                                  0452 00267000
*                   RESPECIFY                                      0453 00268000
*                    (GPR01F) UNRESTRICTED;                        0453 00269000
*                 END;              /* ABEND(200) DUMP QUIT RIGHT  0454 00270000
*                                      HERE                          */ 00271000
*               ELSE                                               0455 00272000
*                 ;                                                0455 00273000
@RF00447 DS    0H                                                  0456 00274000
*               RETC=RF;            /* SAVE RETURN CODE              */ 00275000
         LR    RETC,RF                                             0456 00276000
*               RESPECIFY                                          0457 00277000
*                 RF UNRESTRICTED;                                 0457 00278000
*               CALL MSG4(04042);                                  0458 00279000
         LA    @01,@AL00458                                        0458 00280000
         BAL   @14,MSG4                                            0458 00281000
*             END;                                                 0459 00282000
*           ELSE                                                   0460 00283000
*             CALL SEG1;            /* OPEN IS OK                    */ 00284000
         B     @RC00445                                            0460 00285000
@RF00445 BAL   @14,SEG1                                            0460 00286000
*           IF RETC=0 THEN                                         0461 00287000
@RC00445 LTR   RETC,RETC                                           0461 00288000
         BNZ   @RF00461                                            0461 00289000
*             DO;                                                  0462 00290000
*               IF DFTWD=DEFAULT THEN/* IF DEFAULT KEYWORD PRESENT   */ 00291000
         CLC   DFTWD(2),@CH00041                                   0463 00292000
         BNE   @RF00463                                            0463 00293000
*                 ZZ1ZZ2P->ZZ2APID=PDRKPID;/* SET MODIFIED PROBLEM AS   00294000
*                                      DEFAULT                       */ 00295000
         L     @09,ZZ2ZZ1P(,ZZ2PTR)                                0464 00296000
         L     @09,ZZ1ZZ2P(,@09)                                   0464 00297000
         MVC   ZZ2APID(8,@09),PDRKPID(BUFPTR)                      0464 00298000
*               ELSE                                               0465 00299000
*                 ;                 /* LEAVE DEFAULT PROBLEM ALONE   */ 00300000
@RF00463 DS    0H                                                  0466 00301000
*             END;                                                 0466 00302000
*           ELSE                                                   0467 00303000
*             IF DFTWD=DEFAULT THEN                                0467 00304000
         B     @RC00461                                            0467 00305000
@RF00461 CLC   DFTWD(2),@CH00041                                   0467 00306000
         BNE   @RF00467                                            0467 00307000
*               CALL MSG4(04069);                                  0468 00308000
         LA    @01,@AL00468                                        0468 00309000
         BAL   @14,MSG4                                            0468 00310000
*             ELSE                                                 0469 00311000
*               ;                                                  0469 00312000
@RF00467 DS    0H                                                  0470 00313000
*           CALL BLSDDEQP(ZZ2,PDRKPNUM);/* DEQ THE PROBLEM           */ 00314000
@RC00461 ST    ZZ2PTR,@AL00001                                     0470 00315000
         LA    @09,PDRKPNUM(,BUFPTR)                               0470 00316000
         ST    @09,@AL00001+4                                      0470 00317000
         L     @09,ZZ2DVTP(,ZZ2PTR)                                0470 00318000
         L     @15,DVTDEQPP(,@09)                                  0470 00319000
         LA    @01,@AL00001                                        0470 00320000
         BALR  @14,@15                                             0470 00321000
*           RESPECIFY                                              0471 00322000
*             RF RESTRICTED;                                       0471 00323000
*           RETC=MAX(RETC,RF);      /* SAVE LARGEST RETURN CODE      */ 00324000
         CR    RETC,RF                                             0472 00325000
         BNL   *+6                                                      00326000
         LR    RETC,RF                                             0472 00327000
*           RESPECIFY                                              0473 00328000
*             RF;                                                  0473 00329000
*         END;                                                     0474 00330000
*       ELSE                                                       0475 00331000
*         RETC=12;                  /* ERROR RETURN FROM ENQ         */ 00332000
         B     @RC00413                                            0475 00333000
@RF00413 LA    RETC,12                                             0475 00334000
*     END;                                                         0476 00335000
@RC00413 DS    0H                                                  0477 00336000
         EJECT                                                          00337000
*EXITRLSA:                                                         0477 00338000
*   DO WHILE(PDAPTR^=0);            /* BLRRLSA MF(EXECUTE,PD)        */ 00339000
@RC00397 DS    0H                                                  0477 00340000
EXITRLSA B     @DE00477                                            0477 00341000
@DL00477 DS    0H                                                  0478 00342000
*     PDRPTR=PDAPTR;                                               0478 00343000
         L     PDRPTR,PDAPTR                                       0478 00344000
*     PDAPTR=PDXP;                                                 0479 00345000
         L     @09,PDXP-1(,PDRPTR)                                 0479 00346000
         LA    @09,0(,@09)                                         0479 00347000
         ST    @09,PDAPTR                                          0479 00348000
*     DO;                           /* FREEMAIN(R)                 0480 00349000
*                                      LV(PDL)SP(1)A(PDDSECT)        */ 00350000
*       RESPECIFY                                                  0481 00351000
*        (GPR01F,                                                  0481 00352000
*         GPR00F) RESTRICTED;                                      0481 00353000
*       GPR00F=PDL;                 /* LENGTH REQUESTED              */ 00354000
         L     GPR00F,PDL-1(,PDRPTR)                               0482 00355000
         ICM   GPR00F,8,@CB01653                                   0482 00356000
*       GPR01F=1;                   /* SP IN REG 1                   */ 00357000
         LA    GPR01F,1                                            0483 00358000
*       GEN(SLL   GPR01F,24)                                       0484 00359000
*       NODEFS NOREFS NOSETS NOEXIT NOFLOWS SEQFLOW;               0484 00360000
         SLL   GPR01F,24                                                00361000
*       GPR00F=GPR00F|GPR01F;       /* SP IN HI BYTE                 */ 00362000
         OR    GPR00F,GPR01F                                       0485 00363000
*       GPR01F=ADDR(PDDSECT);       /* SET REGISTER ONE              */ 00364000
         LR    GPR01F,PDRPTR                                       0486 00365000
*       SVC(10);                    /* R-FORM OF GETMAIN             */ 00366000
         SVC   10                                                  0487 00367000
*       RESPECIFY                                                  0488 00368000
*        (GPR01F,                                                  0488 00369000
*         GPR00F) UNRESTRICTED;                                    0488 00370000
*     END;                          /* FREEMAIN(R)                 0489 00371000
*                                      LV(PDL)SP(1)A(PDDSECT)        */ 00372000
*   END;                            /* BLRRLSA MF(EXECUTE,PD) FREE 0490 00373000
*                                      PARSE PARAMETER LIST          */ 00374000
@DE00477 L     @09,PDAPTR                                          0490 00375000
         LTR   @09,@09                                             0490 00376000
         BNZ   @DL00477                                            0490 00377000
*   RETURN CODE(RETC);              /* RETURN TO CALLING PROGRAM   0491 00378000
*                                      NORMAL EXIT                   */ 00379000
         L     @13,4(,@13)                                         0491 00380000
         L     @00,@SIZDATD                                        0491 00381000
         LR    @01,@11                                             0491 00382000
         BLSUFRER R,LV=(0),A=(1)                                        00383000
         LR    @15,@08                                             0491 00384000
         L     @14,12(,@13)                                        0491 00385000
         LM    @00,@12,20(@13)                                     0491 00386000
         BR    @14                                                 0491 00387000
         SPACE 1                                                        00388000
*EXITNORL:                                                         0492 00389000
*   RETURN CODE(RETC);              /* RETURN TO THE CALLER BAD    0492 00390000
*                                      RETURN CODE                   */ 00391000
EXITNORL L     @13,4(,@13)                                         0492 00392000
         L     @00,@SIZDATD                                        0492 00393000
         LR    @01,@11                                             0492 00394000
         BLSUFRER R,LV=(0),A=(1)                                        00395000
         LR    @15,@08                                             0492 00396000
         L     @14,12(,@13)                                        0492 00397000
         LM    @00,@12,20(@13)                                     0492 00398000
         BR    @14                                                 0492 00399000
         EJECT                                                          00400000
*SEG1:                                                             0493 00401000
*   PROCEDURE;                                                     0493 00402000
*                                                                  0493 00403000
SEG1     STM   @14,@07,@SA00002                                    0493 00404000
         STM   @09,@12,@SA00002+40                                 0493 00405000
*   /*****************************************************************/ 00406000
*   /*                                                               */ 00407000
*   /* BLSSET (ZZ1PDRP) AREA(MYBUF)AREALEN(MAXRSIZE)KEYEQ            */ 00408000
*   /*                                                               */ 00409000
*   /*****************************************************************/ 00410000
*                                                                  0494 00411000
*   DO;                             /* BLSSET (ZZ1PDRP) AREA(MYBUF)AR   00412000
*                                      EALEN(MAXRSIZE)KEYEQ          */ 00413000
*     RFY                                                          0495 00414000
*       GPR01P RSTD;                                               0495 00415000
*     GPR01P=ZZ1PDRP;               /* ADDRESS DMCB                  */ 00416000
         L     @09,ZZ2ZZ1P(,ZZ2PTR)                                0496 00417000
         L     GPR01P,ZZ1PDRP(,@09)                                0496 00418000
*     RFY                                                          0497 00419000
*       DMCB BASED(GPR01P);                                        0497 00420000
*     IF((GPR01P&'FFFFFFF8'X)=GPR01P)&DMCBID='DMCB'/* VALID DMCB ?   */ 00421000
*       THEN                                                       0498 00422000
         LR    @09,GPR01P                                          0498 00423000
         N     @09,@CF01531                                        0498 00424000
         CLR   @09,GPR01P                                          0498 00425000
         BNE   @RF00498                                            0498 00426000
         CLC   DMCBID(4,GPR01P),@CC01532                           0498 00427000
         BNE   @RF00498                                            0498 00428000
*       DO;                                                        0499 00429000
*         DMCBBUFP=ADDR(MYBUF);     /* PLACE BUFFER ADDRESS IN DMCB  */ 00430000
         ST    BUFPTR,DMCBBUFP(,GPR01P)                            0500 00431000
*         DMCBBLEN=MAXRSIZE&'7FFFFFFF'X;/* PLACE BUFFER LENGTH IN  0501 00432000
*                                      DMCB                          */ 00433000
         MVC   DMCBBLEN(4,GPR01P),@CF00394                         0501 00434000
*         DMCBKYD='1'B;             /* INDICATE KEYED ACCESS         */ 00435000
*         DMCBAPX='0'B;             /* INDICATE EXACT KEY MATCH      */ 00436000
*         DMCBGKY='0'B;             /* INDICATE FULL KEY SEARCH      */ 00437000
         OI    DMCBKYD(GPR01P),B'10000000'                         0504 00438000
         NI    DMCBAPX(GPR01P),B'10011111'                         0504 00439000
*         DMCBRQST=DMCBSER;         /* INDICATE SET REQUEST          */ 00440000
         MVI   DMCBRQST(GPR01P),X'03'                              0505 00441000
*         CALL DMCBRI->DMCBDMGR;    /* CALL BLSCRQST                 */ 00442000
         L     @15,DMCBRI(,GPR01P)                                 0506 00443000
         BALR  @14,@15                                             0506 00444000
*       END;                                                       0507 00445000
*     ELSE                                                         0508 00446000
*       DO;                                                        0508 00447000
         B     @RC00498                                            0508 00448000
@RF00498 DS    0H                                                  0509 00449000
*         RFY                                                      0509 00450000
*          (GPR00F,                                                0509 00451000
*           GPR15F) RSTD;                                          0509 00452000
*         GPR00F=0;                 /* INDICATE NO MESSAGE CHAIN     */ 00453000
         SLR   GPR00F,GPR00F                                       0510 00454000
*         GPR15F=16;                /* INDICATE INVALID DMCB         */ 00455000
         LA    GPR15F,16                                           0511 00456000
*         RFY                                                      0512 00457000
*          (GPR00F,                                                0512 00458000
*           GPR15F);                                               0512 00459000
*       END;                                                       0513 00460000
*     RFY                                                          0514 00461000
*       DMCB;                                                      0514 00462000
@RC00498 DS    0H                                                  0515 00463000
*     RFY                                                          0515 00464000
*       GPR01P;                                                    0515 00465000
*   END;                            /* BLSSET (ZZ1PDRP) AREA(MYBUF)AR   00466000
*                                      EALEN(MAXRSIZE)KEYEQ          */ 00467000
*   RESPECIFY                                                      0517 00468000
*     RF RESTRICTED;                                               0517 00469000
*   IF RF^=0 THEN                   /* IF RETURN CODE NOT ZERO       */ 00470000
         LTR   RF,RF                                               0518 00471000
         BZ    @RF00518                                            0518 00472000
*     DO;                                                          0519 00473000
*       IF RF=16 THEN               /* IF INVALID DMCB               */ 00474000
         C     RF,@CF00052                                         0520 00475000
         BNE   @RF00520                                            0520 00476000
*         DO;                       /* ABEND(200) DUMP               */ 00477000
*           RESPECIFY                                              0522 00478000
*            (GPR01F) RESTRICTED;                                  0522 00479000
*           GPR01F=200;             /* COMP CODE IN REG 1            */ 00480000
         LA    GPR01F,200                                          0523 00481000
*           GPR01F=GPR01F|'80000000'X;/* DUMP/STEP/DUMPOPTS FLAG     */ 00482000
         O     GPR01F,@CF00061                                     0524 00483000
*           SVC(13);                /* ISSUE ABEND SVC               */ 00484000
         SVC   13                                                  0525 00485000
*           RESPECIFY                                              0526 00486000
*            (GPR01F) UNRESTRICTED;                                0526 00487000
*         END;                      /* ABEND(200) DUMP QUIT RIGHT  0527 00488000
*                                      HERE                          */ 00489000
*       ELSE                                                       0528 00490000
*         ;                                                        0528 00491000
@RF00520 DS    0H                                                  0529 00492000
*       RETC=RF;                    /* SAVE RETURN CODE              */ 00493000
         LR    RETC,RF                                             0529 00494000
*       RESPECIFY                                                  0530 00495000
*         RF UNRESTRICTED;                                         0530 00496000
*       CALL MSG4(04041);                                          0531 00497000
         LA    @01,@AL00531                                        0531 00498000
         BAL   @14,MSG4                                            0531 00499000
*     END;                                                         0532 00500000
*   ELSE                                                           0533 00501000
*     CALL SEG2;                    /* NO PROBLEM                    */ 00502000
         B     @RC00518                                            0533 00503000
@RF00518 BAL   @14,SEG2                                            0533 00504000
*   END SEG1;                                                      0534 00505000
@EL00002 DS    0H                                                  0534 00506000
@EF00002 DS    0H                                                  0534 00507000
@ER00002 LM    @14,@07,@SA00002                                    0534 00508000
         LM    @09,@12,@SA00002+40                                 0534 00509000
         BR    @14                                                 0534 00510000
         EJECT                                                          00511000
*SEG2:                                                             0535 00512000
*   PROCEDURE;                                                     0535 00513000
SEG2     STM   @14,@07,@SA00003                                    0535 00514000
         STM   @09,@12,@SA00003+40                                 0535 00515000
*   CALL SEG3;                      /* NO PROBLEM SO FAR             */ 00516000
         BAL   @14,SEG3                                            0536 00517000
*   DO;                             /* BLSCLOSE(ZZ1PDRP)             */ 00518000
*     RFY                                                          0538 00519000
*       GPR01P RSTD;                                               0538 00520000
*     GPR01P=ZZ1PDRP;               /* ADDRESS THE DMCB              */ 00521000
         L     @09,ZZ2ZZ1P(,ZZ2PTR)                                0539 00522000
         L     GPR01P,ZZ1PDRP(,@09)                                0539 00523000
*     RFY                                                          0540 00524000
*       DMCB BASED(GPR01P);                                        0540 00525000
*     IF((GPR01P&'FFFFFFF8'X)=GPR01P)&DMCBID='DMCB'/* VALID DMCB ?   */ 00526000
*       THEN                                                       0541 00527000
         LR    @09,GPR01P                                          0541 00528000
         N     @09,@CF01531                                        0541 00529000
         CLR   @09,GPR01P                                          0541 00530000
         BNE   @RF00541                                            0541 00531000
         CLC   DMCBID(4,GPR01P),@CC01532                           0541 00532000
         BNE   @RF00541                                            0541 00533000
*       DO;                                                        0542 00534000
*         DMCBRQST=DMCBCLR;         /* INDICATE CLOSE REQUEST        */ 00535000
         MVI   DMCBRQST(GPR01P),X'02'                              0543 00536000
*         DMCBTMP='0'B;             /* INDICATE NON TEMP CLOSE       */ 00537000
*         DMCBRM6='0'B;             /* INDICATE                      */ 00538000
*         DMCBRM5='0'B;             /* DISP OPTION                   */ 00539000
         NI    DMCBTMP(GPR01P),B'00011111'                         0546 00540000
*         CALL DMCBRI->DMCBDMGR;    /* CALL BLSCRQST                 */ 00541000
         L     @15,DMCBRI(,GPR01P)                                 0547 00542000
         BALR  @14,@15                                             0547 00543000
*       END;                                                       0548 00544000
*     ELSE                                                         0549 00545000
*       DO;                                                        0549 00546000
         B     @RC00541                                            0549 00547000
@RF00541 DS    0H                                                  0550 00548000
*         RFY                                                      0550 00549000
*          (GPR00F,                                                0550 00550000
*           GPR15F) RSTD;                                          0550 00551000
*         GPR00F=0;                 /* INDICATE NO MESSAGE CHAIN     */ 00552000
         SLR   GPR00F,GPR00F                                       0551 00553000
*         GPR15F=16;                /* INDICATE INVALID DMCB         */ 00554000
         LA    GPR15F,16                                           0552 00555000
*         RFY                                                      0553 00556000
*          (GPR00F,                                                0553 00557000
*           GPR15F);                                               0553 00558000
*       END;                                                       0554 00559000
*     RFY                                                          0555 00560000
*       DMCB;                                                      0555 00561000
@RC00541 DS    0H                                                  0556 00562000
*     RFY                                                          0556 00563000
*       GPR01P;                                                    0556 00564000
*   END;                            /* BLSCLOSE(ZZ1PDRP) CLOSE     0557 00565000
*                                      PROBLEM DIRECTORY             */ 00566000
*   RESPECIFY                                                      0558 00567000
*     RF RESTRICTED;                                               0558 00568000
*   IF RF^=0 THEN                   /* IF RETURN CODE NOT ZERO       */ 00569000
         LTR   RF,RF                                               0559 00570000
         BZ    @RF00559                                            0559 00571000
*     DO;                                                          0560 00572000
*       IF RF=16 THEN               /* IF INVALID DMCB               */ 00573000
         C     RF,@CF00052                                         0561 00574000
         BNE   @RF00561                                            0561 00575000
*         DO;                       /* ABEND(200) DUMP               */ 00576000
*           RESPECIFY                                              0563 00577000
*            (GPR01F) RESTRICTED;                                  0563 00578000
*           GPR01F=200;             /* COMP CODE IN REG 1            */ 00579000
         LA    GPR01F,200                                          0564 00580000
*           GPR01F=GPR01F|'80000000'X;/* DUMP/STEP/DUMPOPTS FLAG     */ 00581000
         O     GPR01F,@CF00061                                     0565 00582000
*           SVC(13);                /* ISSUE ABEND SVC               */ 00583000
         SVC   13                                                  0566 00584000
*           RESPECIFY                                              0567 00585000
*            (GPR01F) UNRESTRICTED;                                0567 00586000
*         END;                      /* ABEND(200) DUMP QUIT RIGHT  0568 00587000
*                                      HERE                          */ 00588000
*       ELSE                                                       0569 00589000
*         ;                                                        0569 00590000
@RF00561 DS    0H                                                  0570 00591000
*       RETC=RF;                    /* SAVE RETURN CODE              */ 00592000
         LR    RETC,RF                                             0570 00593000
*       RESPECIFY                                                  0571 00594000
*         RF UNRESTRICTED;                                         0571 00595000
*       CALL MSG4(04045);                                          0572 00596000
         LA    @01,@AL00572                                        0572 00597000
         BAL   @14,MSG4                                            0572 00598000
*     END;                                                         0573 00599000
*   ELSE                                                           0574 00600000
*     ;                             /* NO PROBLEM                    */ 00601000
@RF00559 DS    0H                                                  0575 00602000
*   END SEG2;                                                      0575 00603000
@EL00003 DS    0H                                                  0575 00604000
@EF00003 DS    0H                                                  0575 00605000
@ER00003 LM    @14,@07,@SA00003                                    0575 00606000
         LM    @09,@12,@SA00003+40                                 0575 00607000
         BR    @14                                                 0575 00608000
         EJECT                                                          00609000
*SEG3:                                                             0576 00610000
*   PROCEDURE;                                                     0576 00611000
SEG3     STM   @14,@07,@SA00004                                    0576 00612000
         STM   @09,@12,@SA00004+40                                 0576 00613000
*   PDRKRCTY=PDRSTATC;              /* SET RECORD TYPE TO STATUS     */ 00614000
         MVC   PDRKRCTY(2,BUFPTR),@CC01273                         0577 00615000
*   PDRRECSQ='0000';                /* SET RECORD SEQUENCE NUMBER    */ 00616000
         MVC   PDRRECSQ(4,BUFPTR),@CC01560                         0578 00617000
*   PDRKPREF=FPDBPIDP;              /* SET PREFIX FROM LSFPARMS      */ 00618000
         L     @09,ZZ2ZZ1P(,ZZ2PTR)                                0579 00619000
         L     @09,ZZ1FPP(,@09)                                    0579 00620000
         MVC   PDRKPREF(3,BUFPTR),FPDBPIDP(@09)                    0579 00621000
*   CALL GET(MYBUF);                /* GET THE PROBLEM STATUS RECORD */ 00622000
         ST    BUFPTR,@AL00001                                     0580 00623000
         LA    @01,@AL00001                                        0580 00624000
         BAL   @14,GET                                             0580 00625000
*   IF RETC=0 THEN                  /* IF READ OK                    */ 00626000
         LTR   RETC,RETC                                           0581 00627000
         BNZ   @RF00581                                            0581 00628000
*     CALL SEGA;                    /* CONTINUE PROCESSING           */ 00629000
         BAL   @14,SEGA                                            0582 00630000
*   ELSE                                                           0583 00631000
*     ;                             /* ERROR READING STATUS RECORD   */ 00632000
@RF00581 DS    0H                                                  0584 00633000
*   END SEG3;                                                      0584 00634000
@EL00004 DS    0H                                                  0584 00635000
@EF00004 DS    0H                                                  0584 00636000
@ER00004 LM    @14,@07,@SA00004                                    0584 00637000
         LM    @09,@12,@SA00004+40                                 0584 00638000
         BR    @14                                                 0584 00639000
         EJECT                                                          00640000
*SEGA:                                                             0585 00641000
*   PROCEDURE;                                                     0585 00642000
*                                                                  0585 00643000
SEGA     STM   @14,@07,@SA00005                                    0585 00644000
         STM   @09,@12,@SA00005+40                                 0585 00645000
*   /*****************************************************************/ 00646000
*   /*                                                               */ 00647000
*   /* BLSEND (ZZ1PDRP)                                              */ 00648000
*   /*                                                               */ 00649000
*   /*****************************************************************/ 00650000
*                                                                  0586 00651000
*   DO;                             /* BLSEND (ZZ1PDRP)              */ 00652000
*     RFY                                                          0587 00653000
*       GPR01P RSTD;                                               0587 00654000
*     GPR01P=ZZ1PDRP;               /* ADDRESS DMCB                  */ 00655000
         L     @09,ZZ2ZZ1P(,ZZ2PTR)                                0588 00656000
         L     GPR01P,ZZ1PDRP(,@09)                                0588 00657000
*     RFY                                                          0589 00658000
*       DMCB BASED(GPR01P);                                        0589 00659000
*     IF((GPR01P&'FFFFFFF8'X)=GPR01P)&DMCBID='DMCB'/* VALID DMCB ?   */ 00660000
*       THEN                                                       0590 00661000
         LR    @09,GPR01P                                          0590 00662000
         N     @09,@CF01531                                        0590 00663000
         CLR   @09,GPR01P                                          0590 00664000
         BNE   @RF00590                                            0590 00665000
         CLC   DMCBID(4,GPR01P),@CC01532                           0590 00666000
         BNE   @RF00590                                            0590 00667000
*       DO;                                                        0591 00668000
*         DMCBRQST=DMCBENR;         /* INDICATE END REQUEST          */ 00669000
         MVI   DMCBRQST(GPR01P),X'07'                              0592 00670000
*         CALL DMCBRI->DMCBDMGR;    /* CALL BLSCRQST                 */ 00671000
         L     @15,DMCBRI(,GPR01P)                                 0593 00672000
         BALR  @14,@15                                             0593 00673000
*       END;                                                       0594 00674000
*     ELSE                                                         0595 00675000
*       DO;                                                        0595 00676000
         B     @RC00590                                            0595 00677000
@RF00590 DS    0H                                                  0596 00678000
*         RFY                                                      0596 00679000
*          (GPR00F,                                                0596 00680000
*           GPR15F) RSTD;                                          0596 00681000
*         GPR00F=0;                 /* INDICATE NO MESSAGE CHAIN     */ 00682000
         SLR   GPR00F,GPR00F                                       0597 00683000
*         GPR15F=16;                /* INDICATE INVALID DMCB         */ 00684000
         LA    GPR15F,16                                           0598 00685000
*         RFY                                                      0599 00686000
*          (GPR00F,                                                0599 00687000
*           GPR15F);                                               0599 00688000
*       END;                                                       0600 00689000
*     RFY                                                          0601 00690000
*       DMCB;                                                      0601 00691000
@RC00590 DS    0H                                                  0602 00692000
*     RFY                                                          0602 00693000
*       GPR01P;                                                    0602 00694000
*   END;                            /* BLSEND (ZZ1PDRP) DROP CURRENT    00695000
*                                      STATUS RECORD                 */ 00696000
*   RESPECIFY                                                      0604 00697000
*     RF RESTRICTED;                                               0604 00698000
*   IF RF^=0 THEN                   /* IF RETURN CODE NOT ZERO       */ 00699000
         LTR   RF,RF                                               0605 00700000
         BZ    @RF00605                                            0605 00701000
*     DO;                                                          0606 00702000
*       IF RF=16 THEN               /* IF INVALID DMCB               */ 00703000
         C     RF,@CF00052                                         0607 00704000
         BNE   @RF00607                                            0607 00705000
*         DO;                       /* ABEND(200) DUMP               */ 00706000
*           RESPECIFY                                              0609 00707000
*            (GPR01F) RESTRICTED;                                  0609 00708000
*           GPR01F=200;             /* COMP CODE IN REG 1            */ 00709000
         LA    GPR01F,200                                          0610 00710000
*           GPR01F=GPR01F|'80000000'X;/* DUMP/STEP/DUMPOPTS FLAG     */ 00711000
         O     GPR01F,@CF00061                                     0611 00712000
*           SVC(13);                /* ISSUE ABEND SVC               */ 00713000
         SVC   13                                                  0612 00714000
*           RESPECIFY                                              0613 00715000
*            (GPR01F) UNRESTRICTED;                                0613 00716000
*         END;                      /* ABEND(200) DUMP QUIT RIGHT  0614 00717000
*                                      HERE                          */ 00718000
*       ELSE                                                       0615 00719000
*         ;                                                        0615 00720000
@RF00607 DS    0H                                                  0616 00721000
*       RETC=RF;                    /* SAVE RETURN CODE              */ 00722000
         LR    RETC,RF                                             0616 00723000
*       RESPECIFY                                                  0617 00724000
*         RF UNRESTRICTED;                                         0617 00725000
*       CALL MSG4(04041);                                          0618 00726000
         LA    @01,@AL00618                                        0618 00727000
         BAL   @14,MSG4                                            0618 00728000
*     END;                                                         0619 00729000
*   ELSE                                                           0620 00730000
*     DO;                                                          0620 00731000
         B     @RC00605                                            0620 00732000
@RF00605 DS    0H                                                  0621 00733000
*       DMCBUPD='0'B;               /* CLEAR UPDATE BIT              */ 00734000
         L     @09,ZZ2ZZ1P(,ZZ2PTR)                                0621 00735000
         L     @09,ZZ1PDRP(,@09)                                   0621 00736000
         NI    DMCBUPD(@09),B'11101111'                            0621 00737000
*       CALL SEGB;                  /* CONTINUE PROCESSING           */ 00738000
         BAL   @14,SEGB                                            0622 00739000
*     END;                                                         0623 00740000
*   END SEGA;                                                      0624 00741000
@EL00005 DS    0H                                                  0624 00742000
@EF00005 DS    0H                                                  0624 00743000
@ER00005 LM    @14,@07,@SA00005                                    0624 00744000
         LM    @09,@12,@SA00005+40                                 0624 00745000
         BR    @14                                                 0624 00746000
         EJECT                                                          00747000
*SEGB:                                                             0625 00748000
*   PROCEDURE;                                                     0625 00749000
SEGB     STM   @14,@07,@SA00006                                    0625 00750000
         STM   @09,@12,@SA00006+40                                 0625 00751000
*   CALL SEG4;                      /* NO PROBLEMS SO FAR            */ 00752000
         BAL   @14,SEG4                                            0626 00753000
*   SRETC=RETC;                     /* SAVE RETURN CODE              */ 00754000
         LR    SRETC,RETC                                          0627 00755000
*   RETC=0;                         /* SET RETURN CODE TO ZERO       */ 00756000
         SLR   RETC,RETC                                           0628 00757000
*   CALL GET(BUF2);                 /* GET PROBLEM STATUS RECORD     */ 00758000
         LA    @04,BUF2                                            0629 00759000
         ST    @04,@AL00001                                        0629 00760000
         LA    @01,@AL00001                                        0629 00761000
         BAL   @14,GET                                             0629 00762000
*   IF RETC=0 THEN                                                 0630 00763000
         LTR   RETC,RETC                                           0630 00764000
         BNZ   @RF00630                                            0630 00765000
*     DO;                                                          0631 00766000
*                                                                  0631 00767000
*       /*************************************************************/ 00768000
*       /*                                                           */ 00769000
*       /* BLSPUT (ZZ1PDRP)                                          */ 00770000
*       /* RECLEN(LENGTH(PDREC)+LENGTH(PDRSTREC))AREA(MYBUF)         */ 00771000
*       /*                                                           */ 00772000
*       /*************************************************************/ 00773000
*                                                                  0632 00774000
*       DO;                         /* BLSPUT (ZZ1PDRP) RECLEN(LENGTH   00775000
*                                      (PDREC)+LENGTH(PDRSTREC))AREA(   00776000
*                                      MYBUF)                        */ 00777000
*         RFY                                                      0633 00778000
*           GPR01P RSTD;                                           0633 00779000
*         GPR01P=ZZ1PDRP;           /* ADDRESS DMCB                  */ 00780000
         L     @04,ZZ2ZZ1P(,ZZ2PTR)                                0634 00781000
         L     GPR01P,ZZ1PDRP(,@04)                                0634 00782000
*         RFY                                                      0635 00783000
*           DMCB BASED(GPR01P);                                    0635 00784000
*         IF((GPR01P&'FFFFFFF8'X)=GPR01P)&DMCBID='DMCB'/* VALID DMCB    00785000
*                                      ?                             */ 00786000
*           THEN                                                   0636 00787000
         LR    @04,GPR01P                                          0636 00788000
         N     @04,@CF01531                                        0636 00789000
         CLR   @04,GPR01P                                          0636 00790000
         BNE   @RF00636                                            0636 00791000
         CLC   DMCBID(4,GPR01P),@CC01532                           0636 00792000
         BNE   @RF00636                                            0636 00793000
*           DO;                                                    0637 00794000
*             DMCBBUFP=ADDR(MYBUF); /* PLACE BUFFER ADDRESS IN DMCB  */ 00795000
         ST    BUFPTR,DMCBBUFP(,GPR01P)                            0638 00796000
*             DMCBORL=(LENGTH(PDREC)+LENGTH(PDRSTREC))&'7FFFFFFF'X;/*   00797000
*                                      PLACE RECORD LENGTH IN DMCB   */ 00798000
         MVC   DMCBORL(4,GPR01P),@CF01640                          0639 00799000
*             DMCBRQST=DMCBPUR;     /* INDICATE PUT REQUEST          */ 00800000
         MVI   DMCBRQST(GPR01P),X'05'                              0640 00801000
*             CALL DMCBRI->DMCBDMGR;/* CALL BLSCRQST                 */ 00802000
         L     @15,DMCBRI(,GPR01P)                                 0641 00803000
         BALR  @14,@15                                             0641 00804000
*           END;                                                   0642 00805000
*         ELSE                                                     0643 00806000
*           DO;                                                    0643 00807000
         B     @RC00636                                            0643 00808000
@RF00636 DS    0H                                                  0644 00809000
*             RFY                                                  0644 00810000
*              (GPR00F,                                            0644 00811000
*               GPR15F) RSTD;                                      0644 00812000
*             GPR00F=0;             /* INDICATE NO MESSAGE CHAIN     */ 00813000
         SLR   GPR00F,GPR00F                                       0645 00814000
*             GPR15F=16;            /* INDICATE INVALID DMCB         */ 00815000
         LA    GPR15F,16                                           0646 00816000
*             RFY                                                  0647 00817000
*              (GPR00F,                                            0647 00818000
*               GPR15F);                                           0647 00819000
*           END;                                                   0648 00820000
*         RFY                                                      0649 00821000
*           DMCB;                                                  0649 00822000
@RC00636 DS    0H                                                  0650 00823000
*         RFY                                                      0650 00824000
*           GPR01P;                                                0650 00825000
*       END;                        /* BLSPUT (ZZ1PDRP) RECLEN(LENGTH   00826000
*                                      (PDREC)+LENGTH(PDRSTREC))AREA(   00827000
*                                      MYBUF) WRITE OUT THEN NEW   0651 00828000
*                                      PROBLEM STATUS RECORD         */ 00829000
*       RESPECIFY                                                  0652 00830000
*         RF RESTRICTED;                                           0652 00831000
*       IF RF^=0 THEN               /* IF RETURN CODE NOT ZERO       */ 00832000
         LTR   RF,RF                                               0653 00833000
         BZ    @RF00653                                            0653 00834000
*         DO;                                                      0654 00835000
*           IF RF=16 THEN           /* IF INVALID DMCB               */ 00836000
         C     RF,@CF00052                                         0655 00837000
         BNE   @RF00655                                            0655 00838000
*             DO;                   /* ABEND(200) DUMP               */ 00839000
*               RESPECIFY                                          0657 00840000
*                (GPR01F) RESTRICTED;                              0657 00841000
*               GPR01F=200;         /* COMP CODE IN REG 1            */ 00842000
         LA    GPR01F,200                                          0658 00843000
*               GPR01F=GPR01F|'80000000'X;/* DUMP/STEP/DUMPOPTS FLAG */ 00844000
         O     GPR01F,@CF00061                                     0659 00845000
*               SVC(13);            /* ISSUE ABEND SVC               */ 00846000
         SVC   13                                                  0660 00847000
*               RESPECIFY                                          0661 00848000
*                (GPR01F) UNRESTRICTED;                            0661 00849000
*             END;                  /* ABEND(200) DUMP QUIT RIGHT  0662 00850000
*                                      HERE                          */ 00851000
*           ELSE                                                   0663 00852000
*             ;                                                    0663 00853000
@RF00655 DS    0H                                                  0664 00854000
*           RETC=RF;                /* SAVE RETURN CODE              */ 00855000
         LR    RETC,RF                                             0664 00856000
*           RESPECIFY                                              0665 00857000
*             RF UNRESTRICTED;                                     0665 00858000
*           CALL MSG4(04044);       /* ERROR WRITING PROB DIRECTORY  */ 00859000
         LA    @01,@AL00666                                        0666 00860000
         BAL   @14,MSG4                                            0666 00861000
*         END;                                                     0667 00862000
*       ELSE                                                       0668 00863000
*         ;                         /* NO PROBLEM                    */ 00864000
@RF00653 DS    0H                                                  0669 00865000
*     END;                                                         0669 00866000
*   ELSE                                                           0670 00867000
*     ;                                                            0670 00868000
@RF00630 DS    0H                                                  0671 00869000
*   RETC=MAX(RETC,SRETC);           /* SET HIGHEST RETURN CODE       */ 00870000
         CR    RETC,SRETC                                          0671 00871000
         BNL   *+6                                                      00872000
         LR    RETC,SRETC                                          0671 00873000
*   END SEGB;                                                      0672 00874000
@EL00006 DS    0H                                                  0672 00875000
@EF00006 DS    0H                                                  0672 00876000
@ER00006 LM    @14,@07,@SA00006                                    0672 00877000
         LM    @09,@12,@SA00006+40                                 0672 00878000
         BR    @14                                                 0672 00879000
         EJECT                                                          00880000
*GET:                                                              0673 00881000
*   PROCEDURE(BUF);                                                0673 00882000
*                                                                  0673 00883000
GET      STM   @14,@07,@SA00007                                    0673 00884000
         STM   @09,@12,@SA00007+40                                 0673 00885000
         MVC   @PC00007(4),0(@01)                                  0673 00886000
*   /*****************************************************************/ 00887000
*   /*                                                               */ 00888000
*   /* BLSGET (ZZ1PDRP) ARG(PDRKEY)ARGLEN(LENGTH(PDRKEY))UPD KEYEQ   */ 00889000
*   /* AREA(BUF)                                                     */ 00890000
*   /*                                                               */ 00891000
*   /*****************************************************************/ 00892000
*                                                                  0674 00893000
*   DO;                             /* BLSGET (ZZ1PDRP) ARG(PDRKEY)AR   00894000
*                                      GLEN(LENGTH(PDRKEY))UPD KEYEQ    00895000
*                                      AREA(BUF)                     */ 00896000
*     RFY                                                          0675 00897000
*       GPR01P RSTD;                                               0675 00898000
*     GPR01P=ZZ1PDRP;               /* ADDRESS DMCB                  */ 00899000
         L     @09,ZZ2ZZ1P(,ZZ2PTR)                                0676 00900000
         L     GPR01P,ZZ1PDRP(,@09)                                0676 00901000
*     RFY                                                          0677 00902000
*       DMCB BASED(GPR01P);                                        0677 00903000
*     IF((GPR01P&'FFFFFFF8'X)=GPR01P)&DMCBID='DMCB'/* VALID DMCB ?   */ 00904000
*       THEN                                                       0678 00905000
         LR    @09,GPR01P                                          0678 00906000
         N     @09,@CF01531                                        0678 00907000
         CLR   @09,GPR01P                                          0678 00908000
         BNE   @RF00678                                            0678 00909000
         CLC   DMCBID(4,GPR01P),@CC01532                           0678 00910000
         BNE   @RF00678                                            0678 00911000
*       DO;                                                        0679 00912000
*         DMCBBUFP=ADDR(BUF);       /* PLACE BUFFER ADDRESS IN DMCB  */ 00913000
         L     @09,@PC00007                                        0680 00914000
         ST    @09,DMCBBUFP(,GPR01P)                               0680 00915000
*         DMCBKEYP=ADDR(PDRKEY);    /* PLACE KEY ADDRESS IN DMCB     */ 00916000
         ST    BUFPTR,DMCBKEYP(,GPR01P)                            0681 00917000
*         DMCBKEYL=(LENGTH(PDRKEY))&'7FFFFFFF'X;/* PLACE KEY LENGTH     00918000
*                                      IN DMCB                       */ 00919000
         MVC   DMCBKEYL(4,GPR01P),@CF01037                         0682 00920000
*         DMCBKYD='1'B;             /* INDICATE KEYED ACCESS         */ 00921000
*         DMCBAPX='0'B;             /* INDICATE EXACT KEY MATCH      */ 00922000
*         DMCBGKY='0'B;             /* INDICATE FULL KEY SEARCH      */ 00923000
*         DMCBUPD='1'B;             /* INDICATE UPDATE OPTION        */ 00924000
         OI    DMCBKYD(GPR01P),B'10010000'                         0686 00925000
         NI    DMCBAPX(GPR01P),B'10011111'                         0686 00926000
*         DMCBRQST=DMCBGER;         /* INDICATE GET REQUEST          */ 00927000
         MVI   DMCBRQST(GPR01P),X'04'                              0687 00928000
*         CALL DMCBRI->DMCBDMGR;    /* CALL BLSCRQST                 */ 00929000
         L     @15,DMCBRI(,GPR01P)                                 0688 00930000
         BALR  @14,@15                                             0688 00931000
*       END;                                                       0689 00932000
*     ELSE                                                         0690 00933000
*       DO;                                                        0690 00934000
         B     @RC00678                                            0690 00935000
@RF00678 DS    0H                                                  0691 00936000
*         RFY                                                      0691 00937000
*          (GPR00F,                                                0691 00938000
*           GPR15F) RSTD;                                          0691 00939000
*         GPR00F=0;                 /* INDICATE NO MESSAGE CHAIN     */ 00940000
         SLR   GPR00F,GPR00F                                       0692 00941000
*         GPR15F=16;                /* INDICATE INVALID DMCB         */ 00942000
         LA    GPR15F,16                                           0693 00943000
*         RFY                                                      0694 00944000
*          (GPR00F,                                                0694 00945000
*           GPR15F);                                               0694 00946000
*       END;                                                       0695 00947000
*     RFY                                                          0696 00948000
*       DMCB;                                                      0696 00949000
@RC00678 DS    0H                                                  0697 00950000
*     RFY                                                          0697 00951000
*       GPR01P;                                                    0697 00952000
*   END;                            /* BLSGET (ZZ1PDRP) ARG(PDRKEY)AR   00953000
*                                      GLEN(LENGTH(PDRKEY))UPD KEYEQ    00954000
*                                      AREA(BUF) GET STATUS RECORD 0698 00955000
*                                      FOR UPDATE                    */ 00956000
*   RESPECIFY                                                      0699 00957000
*     RF RESTRICTED;                                               0699 00958000
*   IF RF=8 THEN                                                   0700 00959000
         C     RF,@CF00049                                         0700 00960000
         BNE   @RF00700                                            0700 00961000
*     DO;                                                          0701 00962000
*       RETC=RF;                    /* SAVE RETURN CODE              */ 00963000
         LR    RETC,RF                                             0702 00964000
*       DO;                         /* BLSDMSG                     0703 00965000
*                                      (ZZ2,-1,DMCBMSG,BLSDMSGS)     */ 00966000
*         CALL BLSDMSG0(ZZ2,-1,DMCBMSG,BLSDMSGS,'00000000'B,0);/*  0704 00967000
*                                      BUILD MESSAGE                 */ 00968000
         ST    ZZ2PTR,@AL00001                                     0704 00969000
         LA    @14,@CF01580                                        0704 00970000
         ST    @14,@AL00001+4                                      0704 00971000
         L     @14,ZZ2ZZ1P(,ZZ2PTR)                                0704 00972000
         L     @14,ZZ1PDRP(,@14)                                   0704 00973000
         LA    @14,DMCBMSG(,@14)                                   0704 00974000
         ST    @14,@AL00001+8                                      0704 00975000
         L     @14,ZZ2MSGSP(,ZZ2PTR)                               0704 00976000
         ST    @14,@AL00001+12                                     0704 00977000
         LA    @14,@CB01581                                        0704 00978000
         ST    @14,@AL00001+16                                     0704 00979000
         LA    @14,@CF00046                                        0704 00980000
         ST    @14,@AL00001+20                                     0704 00981000
         L     @15,ZZ2MSG0P(,ZZ2PTR)                               0704 00982000
         LA    @01,@AL00001                                        0704 00983000
         BALR  @14,@15                                             0704 00984000
*       END;                        /* BLSDMSG                     0705 00985000
*                                      (ZZ2,-1,DMCBMSG,BLSDMSGS)   0705 00986000
*                                      FLUSH MESSAGE QUEUE           */ 00987000
*       DO;                         /* BLSDMSG                     0706 00988000
*                                      (ZZ2,04000,DMCBMSG,BLSDMSGS) R   00989000
*                                      OUTE(BOTH)INSERT(FPPIDP,PDRKPN   00990000
*                                      UM)LIFO                       */ 00991000
*         IOPTLIST(1)=ADDR(IOPTLIST(4));/* CHAIN TO NEXT INSERT      */ 00992000
         LA    @14,IOPTLIST+12                                     0707 00993000
         ST    @14,IOPTLIST                                        0707 00994000
*         IOPTLIST(2)=ADDR(FPPIDP); /* INSERT NAME POINTER           */ 00995000
         L     @14,ZZ2ZZ1P(,ZZ2PTR)                                0708 00996000
         L     @09,ZZ1FPP(,@14)                                    0708 00997000
         LA    @09,FPPIDP(,@09)                                    0708 00998000
         ST    @09,IOPTLIST+4                                      0708 00999000
*         IOPTLIST(3)=0;            /* ZERO RESERVED FIELD           */ 01000000
         SLR   @09,@09                                             0709 01001000
         ST    @09,IOPTLIST+8                                      0709 01002000
*         RFY                                                      0710 01003000
*           I015F BASED(ADDR(IOPTLIST(3)));/* ACCESS BYTES 1-2       */ 01004000
*         I015F=LENGTH(FPPIDP);     /* INSERT LENGTH                 */ 01005000
         LA    @04,IOPTLIST+8                                      0711 01006000
         MVC   I015F(2,@04),@CH00094                               0711 01007000
*         IOPTLIST(4)=0;            /* LAST INSERT                   */ 01008000
         ST    @09,IOPTLIST+12                                     0712 01009000
*         IOPTLIST(5)=ADDR(PDRKPNUM);/* INSERT NAME POINTER          */ 01010000
         LA    @04,PDRKPNUM(,BUFPTR)                               0713 01011000
         ST    @04,IOPTLIST+16                                     0713 01012000
*         IOPTLIST(6)=0;            /* ZERO RESERVED FIELD           */ 01013000
         ST    @09,IOPTLIST+20                                     0714 01014000
*         RFY                                                      0715 01015000
*           I015F BASED(ADDR(IOPTLIST(6)));/* ACCESS BYTES 1-2       */ 01016000
*         I015F=LENGTH(PDRKPNUM);   /* INSERT LENGTH                 */ 01017000
         LA    @09,IOPTLIST+20                                     0716 01018000
         MVC   I015F(2,@09),@CH00091                               0716 01019000
*         CALL BLSDMSG0(ZZ2,04000,DMCBMSG,BLSDMSGS,'10110000'B,ADDR(    01020000
*             IOPTLIST));           /* BUILD MESSAGE                 */ 01021000
         ST    ZZ2PTR,@AL00001                                     0717 01022000
         LA    @09,@CF01588                                        0717 01023000
         ST    @09,@AL00001+4                                      0717 01024000
         L     @14,ZZ1PDRP(,@14)                                   0717 01025000
         LA    @14,DMCBMSG(,@14)                                   0717 01026000
         ST    @14,@AL00001+8                                      0717 01027000
         L     @14,ZZ2MSGSP(,ZZ2PTR)                               0717 01028000
         ST    @14,@AL00001+12                                     0717 01029000
         LA    @14,@CB01589                                        0717 01030000
         ST    @14,@AL00001+16                                     0717 01031000
         LA    @14,IOPTLIST                                        0717 01032000
         ST    @14,@AFTEMPS                                        0717 01033000
         LA    @14,@AFTEMPS                                        0717 01034000
         ST    @14,@AL00001+20                                     0717 01035000
         L     @15,ZZ2MSG0P(,ZZ2PTR)                               0717 01036000
         LA    @01,@AL00001                                        0717 01037000
         BALR  @14,@15                                             0717 01038000
*       END;                        /* BLSDMSG                     0718 01039000
*                                      (ZZ2,04000,DMCBMSG,BLSDMSGS) R   01040000
*                                      OUTE(BOTH)INSERT(FPPIDP,PDRKPN   01041000
*                                      UM)LIFO                       */ 01042000
*     END;                                                         0719 01043000
*   ELSE                                                           0720 01044000
*     IF RF^=0 THEN                 /* IF RETURN CODE NOT ZERO       */ 01045000
         B     @RC00700                                            0720 01046000
@RF00700 LTR   RF,RF                                               0720 01047000
         BZ    @RF00720                                            0720 01048000
*       DO;                                                        0721 01049000
*         IF RF=16 THEN             /* IF INVALID DMCB               */ 01050000
         C     RF,@CF00052                                         0722 01051000
         BNE   @RF00722                                            0722 01052000
*           DO;                     /* ABEND(200) DUMP               */ 01053000
*             RESPECIFY                                            0724 01054000
*              (GPR01F) RESTRICTED;                                0724 01055000
*             GPR01F=200;           /* COMP CODE IN REG 1            */ 01056000
         LA    GPR01F,200                                          0725 01057000
*             GPR01F=GPR01F|'80000000'X;/* DUMP/STEP/DUMPOPTS FLAG   */ 01058000
         O     GPR01F,@CF00061                                     0726 01059000
*             SVC(13);              /* ISSUE ABEND SVC               */ 01060000
         SVC   13                                                  0727 01061000
*             RESPECIFY                                            0728 01062000
*              (GPR01F) UNRESTRICTED;                              0728 01063000
*           END;                    /* ABEND(200) DUMP QUIT RIGHT  0729 01064000
*                                      HERE                          */ 01065000
*         ELSE                                                     0730 01066000
*           ;                                                      0730 01067000
@RF00722 DS    0H                                                  0731 01068000
*         RETC=RF;                  /* SAVE RETURN CODE              */ 01069000
         LR    RETC,RF                                             0731 01070000
*         RESPECIFY                                                0732 01071000
*           RF UNRESTRICTED;                                       0732 01072000
*         CALL MSG4(04043);                                        0733 01073000
         LA    @01,@AL00733                                        0733 01074000
         BAL   @14,MSG4                                            0733 01075000
*       END;                                                       0734 01076000
*     ELSE                                                         0735 01077000
*       ;                                                          0735 01078000
@RF00720 DS    0H                                                  0736 01079000
*   END GET;                                                       0736 01080000
@EL00007 DS    0H                                                  0736 01081000
@EF00007 DS    0H                                                  0736 01082000
@ER00007 LM    @14,@07,@SA00007                                    0736 01083000
         LM    @09,@12,@SA00007+40                                 0736 01084000
         BR    @14                                                 0736 01085000
         EJECT                                                          01086000
*SEG4:                                                             0737 01087000
*   PROCEDURE;                                                     0737 01088000
*                                                                  0737 01089000
SEG4     STM   @14,@07,@SA00008                                    0737 01090000
         STM   @09,@12,@SA00008+40                                 0737 01091000
*/********************************************************************/ 01092000
*/*                                                                  */ 01093000
*/* MERGE COMMAND PARAMETERS INTO STATUS RECORD                      */ 01094000
*/*                                                                  */ 01095000
*/********************************************************************/ 01096000
*                                                                  0738 01097000
*   CALL BLSEAUTH(ZZ2,BUF1,'O');    /* TEST USER UPDATE AUTHORITY    */ 01098000
         ST    ZZ2PTR,@AL00001                                     0738 01099000
         LA    @09,BUF1                                            0738 01100000
         ST    @09,@AL00001+4                                      0738 01101000
         LA    @09,@CC01594                                        0738 01102000
         ST    @09,@AL00001+8                                      0738 01103000
         L     @09,ZZ2DVTP(,ZZ2PTR)                                0738 01104000
         L     @15,DVTAUTHP(,@09)                                  0738 01105000
         LA    @01,@AL00001                                        0738 01106000
         BALR  @14,@15                                             0738 01107000
*   RESPECIFY                                                      0739 01108000
*     RF RESTRICTED;                                               0739 01109000
*   IF RF=0 THEN                                                   0740 01110000
         LTR   RF,RF                                               0740 01111000
         BNZ   @RF00740                                            0740 01112000
*     AUTHSW=1;                     /* USER IS AUTHORIZED TO UPDATE     01113000
*                                      STATUS                        */ 01114000
         LA    AUTHSW,1                                            0741 01115000
*   ELSE                                                           0742 01116000
*     AUTHSW=0;                     /* USER IS NOT AUTHORIZED TO   0742 01117000
*                                      UPDATE STATUS                 */ 01118000
         B     @RC00740                                            0742 01119000
@RF00740 SLR   AUTHSW,AUTHSW                                       0742 01120000
*   RESPECIFY                                                      0743 01121000
*     RF;                                                          0743 01122000
@RC00740 DS    0H                                                  0744 01123000
*   IF AUTHSW=1 THEN                /* IF USER IS AUTHORIZED         */ 01124000
         C     AUTHSW,@CF00041                                     0744 01125000
         BNE   @RF00744                                            0744 01126000
*     DO;                                                          0745 01127000
*       IF DTEIFP=ON&DTEIL^=0 THEN  /* IF DATE PRESENT IN COMMAND    */ 01128000
         TM    DTEIFP,B'10000000'                                  0746 01129000
         BNO   @RF00746                                            0746 01130000
         LH    @09,DTEIL                                           0746 01131000
         LTR   @09,@09                                             0746 01132000
         BZ    @RF00746                                            0746 01133000
*         PDRODATE=DTEI(1:DTEIL);   /* SET DATE PROBLEM OCCURRED     */ 01134000
         MVI   PDRODATE+1(BUFPTR),C' '                             0747 01135000
         MVC   PDRODATE+2(6,BUFPTR),PDRODATE+1(BUFPTR)             0747 01136000
         BCTR  @09,0                                               0747 01137000
         L     @04,DTEIP                                           0747 01138000
         EX    @09,@SM01655                                        0747 01139000
*       ELSE                                                       0748 01140000
*         ;                         /* DATE IS NOT PRESENT, LEAVE IT */ 01141000
@RF00746 DS    0H                                                  0749 01142000
*       IF TMEIFP=ON&TMEIL^=0 THEN  /* IF TIME PRESENT IN COMMAND    */ 01143000
         TM    TMEIFP,B'10000000'                                  0749 01144000
         BNO   @RF00749                                            0749 01145000
         LH    @09,TMEIL                                           0749 01146000
         LTR   @09,@09                                             0749 01147000
         BZ    @RF00749                                            0749 01148000
*         PDROTIME=TMEI(1:TMEIL);   /* SET TIME PROBLEM OCCURRED     */ 01149000
         MVI   PDROTIME+1(BUFPTR),C' '                             0750 01150000
         MVC   PDROTIME+2(6,BUFPTR),PDROTIME+1(BUFPTR)             0750 01151000
         BCTR  @09,0                                               0750 01152000
         L     @04,TMEIP                                           0750 01153000
         EX    @09,@SM01657                                        0750 01154000
*       ELSE                                                       0751 01155000
*         ;                         /* TIME IS NOT PRESENT, LEAVE IT */ 01156000
@RF00749 DS    0H                                                  0752 01157000
*       IF GRPIFP=ON&GRPIL^=0 THEN  /* IF GROUP ID PRESENT IN COMMAND*/ 01158000
         TM    GRPIFP,B'10000000'                                  0752 01159000
         BNO   @RF00752                                            0752 01160000
         LH    @09,GRPIL                                           0752 01161000
         LTR   @09,@09                                             0752 01162000
         BZ    @RF00752                                            0752 01163000
*         PDRGROUP=GRPI(1:GRPIL);   /* SET GROUP ID IN STATUS RECORD */ 01164000
         MVI   PDRGROUP+1(BUFPTR),C' '                             0753 01165000
         MVC   PDRGROUP+2(6,BUFPTR),PDRGROUP+1(BUFPTR)             0753 01166000
         BCTR  @09,0                                               0753 01167000
         L     @04,GRPIP                                           0753 01168000
         EX    @09,@SM01659                                        0753 01169000
*       ELSE                                                       0754 01170000
*         ;                         /* USE DEFAULT GROUP ID          */ 01171000
@RF00752 DS    0H                                                  0755 01172000
*       IF SIDIFP=ON&SIDIL^=0 THEN  /* IF SYS ID PRESENT IN COMMAND  */ 01173000
         TM    SIDIFP,B'10000000'                                  0755 01174000
         BNO   @RF00755                                            0755 01175000
         LH    @09,SIDIL                                           0755 01176000
         LTR   @09,@09                                             0755 01177000
         BZ    @RF00755                                            0755 01178000
*         PDRSYS=SIDI(1:SIDIL);     /* SET SYSTEM ID IN STATUS RECORD*/ 01179000
         MVI   PDRSYS+1(BUFPTR),C' '                               0756 01180000
         MVC   PDRSYS+2(6,BUFPTR),PDRSYS+1(BUFPTR)                 0756 01181000
         BCTR  @09,0                                               0756 01182000
         L     @04,SIDIP                                           0756 01183000
         EX    @09,@SM01661                                        0756 01184000
*       ELSE                                                       0757 01185000
*         ;                         /* LEAVE IT ALONE                */ 01186000
@RF00755 DS    0H                                                  0758 01187000
*       IF CIDIFP=ON&CIDIL^=0 THEN  /* IF COMPONENT ID PRESENT       */ 01188000
         TM    CIDIFP,B'10000000'                                  0758 01189000
         BNO   @RF00758                                            0758 01190000
         LH    @09,CIDIL                                           0758 01191000
         LTR   @09,@09                                             0758 01192000
         BZ    @RF00758                                            0758 01193000
*         PDRCOMP=CIDI(1:CIDIL);    /* SET COMPONENT ID IN RECORD    */ 01194000
         MVI   PDRCOMP+1(BUFPTR),C' '                              0759 01195000
         MVC   PDRCOMP+2(8,BUFPTR),PDRCOMP+1(BUFPTR)               0759 01196000
         BCTR  @09,0                                               0759 01197000
         L     @04,CIDIP                                           0759 01198000
         EX    @09,@SM01663                                        0759 01199000
*       ELSE                                                       0760 01200000
*         ;                         /* LEAVE COMPONENT ID AS IS      */ 01201000
@RF00758 DS    0H                                                  0761 01202000
*       IF OWNIFP=ON&OWNIL^=0 THEN  /* IF PROBLEM OWNER ID PRESENT   */ 01203000
         TM    OWNIFP,B'10000000'                                  0761 01204000
         BNO   @RF00761                                            0761 01205000
         LH    @09,OWNIL                                           0761 01206000
         LTR   @09,@09                                             0761 01207000
         BZ    @RF00761                                            0761 01208000
*         DO;                                                      0762 01209000
*           PDROWNID=OWNI(1:OWNIL); /* SET PROBLEM OWNER IN RECORD   */ 01210000
         MVI   PDROWNID+1(BUFPTR),C' '                             0763 01211000
         MVC   PDROWNID+2(5,BUFPTR),PDROWNID+1(BUFPTR)             0763 01212000
         LR    @04,@09                                             0763 01213000
         BCTR  @04,0                                               0763 01214000
         L     @03,OWNIP                                           0763 01215000
         EX    @04,@SM01665                                        0763 01216000
*           PDROWNLN=OWNIL;         /* SET LENGTH OF OWNER ID        */ 01217000
         STC   @09,PDROWNLN(,BUFPTR)                               0764 01218000
*         END;                                                     0765 01219000
*       ELSE                                                       0766 01220000
*         ;                         /* LEAVE PROBLEM OWNER ID AS IS  */ 01221000
@RF00761 DS    0H                                                  0767 01222000
*       IF UFLIFP=ON&UFLIL^=0 THEN  /* IF USER FIELD IS PRESENT      */ 01223000
         TM    UFLIFP,B'10000000'                                  0767 01224000
         BNO   @RF00767                                            0767 01225000
         LH    @09,UFLIL                                           0767 01226000
         LTR   @09,@09                                             0767 01227000
         BZ    @RF00767                                            0767 01228000
*         PDRUSER=UFLI(1:UFLIL);    /* SET VALUE IN USER FIELD       */ 01229000
         MVI   PDRUSER+1(BUFPTR),C' '                              0768 01230000
         MVC   PDRUSER+2(6,BUFPTR),PDRUSER+1(BUFPTR)               0768 01231000
         BCTR  @09,0                                               0768 01232000
         L     @04,UFLIP                                           0768 01233000
         EX    @09,@SM01667                                        0768 01234000
*       ELSE                                                       0769 01235000
*         ;                         /* LEAVE USER FIELD AS IS        */ 01236000
@RF00767 DS    0H                                                  0770 01237000
*       IF SEVIFP=ON THEN           /* IF PROBLEM SEVERITY PRESENT   */ 01238000
         TM    SEVIFP,B'10000000'                                  0770 01239000
         BNO   @RF00770                                            0770 01240000
*         DO;                                                      0771 01241000
*           PDRSEV=SEVI(1);         /* SET PROBLEM SEVERITY          */ 01242000
         L     @09,SEVIP                                           0772 01243000
         MVC   PDRSEV(1,BUFPTR),SEVI(@09)                          0772 01244000
*           IF PDRSEV='0' THEN      /* IF PROBLEM SEVERITY IS ZERO   */ 01245000
         CLI   PDRSEV(BUFPTR),C'0'                                 0773 01246000
         BNE   @RF00773                                            0773 01247000
*             PDRSEV=' ';           /* BLANK IT OUT                  */ 01248000
         MVI   PDRSEV(BUFPTR),C' '                                 0774 01249000
*           ELSE                                                   0775 01250000
*             ;                     /* SEVERITY CODE IS 1 TO 4       */ 01251000
@RF00773 DS    0H                                                  0776 01252000
*         END;                      /* DONE                          */ 01253000
*       ELSE                                                       0777 01254000
*         ;                         /* LEAVE SEVERITY AS IS          */ 01255000
@RF00770 DS    0H                                                  0778 01256000
*       IF APRIFP=ON&APRIL^=0 THEN  /* IF APAR ID PRESENT IN COMMAND */ 01257000
         TM    APRIFP,B'10000000'                                  0778 01258000
         BNO   @RF00778                                            0778 01259000
         LH    @09,APRIL                                           0778 01260000
         LTR   @09,@09                                             0778 01261000
         BZ    @RF00778                                            0778 01262000
*         PDRAPRID=APRI(1:APRIL);   /* SET APAR ID IN RECORD         */ 01263000
         MVI   PDRAPRID+1(BUFPTR),C' '                             0779 01264000
         MVC   PDRAPRID+2(5,BUFPTR),PDRAPRID+1(BUFPTR)             0779 01265000
         BCTR  @09,0                                               0779 01266000
         L     @04,APRIP                                           0779 01267000
         EX    @09,@SM01669                                        0779 01268000
*       ELSE                                                       0780 01269000
*         ;                         /* LEAVE APAR ID AS IS           */ 01270000
@RF00778 DS    0H                                                  0781 01271000
*       IF PTFIFP=ON&PTFIL^=0 THEN  /* IF PTF ID PRESENT IN COMMAND  */ 01272000
         TM    PTFIFP,B'10000000'                                  0781 01273000
         BNO   @RF00781                                            0781 01274000
         LH    @09,PTFIL                                           0781 01275000
         LTR   @09,@09                                             0781 01276000
         BZ    @RF00781                                            0781 01277000
*         PDRPTFID=PTFI(1:PTFIL);   /* SET PTF ID IN RECORD          */ 01278000
         MVI   PDRPTFID+1(BUFPTR),C' '                             0782 01279000
         MVC   PDRPTFID+2(5,BUFPTR),PDRPTFID+1(BUFPTR)             0782 01280000
         BCTR  @09,0                                               0782 01281000
         L     @04,PTFIP                                           0782 01282000
         EX    @09,@SM01671                                        0782 01283000
*       ELSE                                                       0783 01284000
*         ;                         /* LEAVE PTF ID AS IS            */ 01285000
@RF00781 DS    0H                                                  0784 01286000
*       IF FIXQFP=ON&FIXQL^=0 THEN  /* IF FIX ID PRESENT IN COMMAND  */ 01287000
         TM    FIXQFP,B'10000000'                                  0784 01288000
         BNO   @RF00784                                            0784 01289000
         LH    @09,FIXQL                                           0784 01290000
         LTR   @09,@09                                             0784 01291000
         BZ    @RF00784                                            0784 01292000
*         PDRFIXID=FIXQ(1:FIXQL);   /* SET FIX ID IN RECORD          */ 01293000
         MVI   PDRFIXID+1(BUFPTR),C' '                             0785 01294000
         MVC   PDRFIXID+2(58,BUFPTR),PDRFIXID+1(BUFPTR)            0785 01295000
         BCTR  @09,0                                               0785 01296000
         L     @04,FIXQP                                           0785 01297000
         EX    @09,@SM01673                                        0785 01298000
*       ELSE                                                       0786 01299000
*         ;                         /* LEAVE FIX ID AS IS            */ 01300000
@RF00784 DS    0H                                                  0787 01301000
*       IF ABSQFP=ON&ABSQL^=0 THEN  /* IF ABSTRACT PRESENT IN COMMAND*/ 01302000
         TM    ABSQFP,B'10000000'                                  0787 01303000
         BNO   @RF00787                                            0787 01304000
         LH    @09,ABSQL                                           0787 01305000
         LTR   @09,@09                                             0787 01306000
         BZ    @RF00787                                            0787 01307000
*         PDRABS=ABSQ(1:ABSQL);     /* SET ABSTRACT IN RECORD        */ 01308000
         MVI   PDRABS+1(BUFPTR),C' '                               0788 01309000
         MVC   PDRABS+2(126,BUFPTR),PDRABS+1(BUFPTR)               0788 01310000
         BCTR  @09,0                                               0788 01311000
         L     @04,ABSQP                                           0788 01312000
         EX    @09,@SM01675                                        0788 01313000
*       ELSE                                                       0789 01314000
*         ;                         /* LEAVE ABSTRACT FIELD AS IS    */ 01315000
@RF00787 DS    0H                                                  0790 01316000
*       IF PSTTYPE>0 THEN           /* IF STATUS PRESENT             */ 01317000
         LH    @09,PSTTYPE                                         0790 01318000
         LTR   @09,@09                                             0790 01319000
         BNP   @RF00790                                            0790 01320000
*         DO;                                                      0791 01321000
*           PDRPSTAT=STATPROB(PSTTYPE);/* SET STATUS FIELD           */ 01322000
         SLA   @09,3                                               0792 01323000
         LA    @04,STATPROB-8(@09)                                 0792 01324000
         MVC   PDRPSTAT(8,BUFPTR),0(@04)                           0792 01325000
*           PDRPDATE=CURDATE;       /* SET DATE OF STATUS CHANGE     */ 01326000
         MVC   PDRPDATE(8,BUFPTR),CURDATE                          0793 01327000
*           PDRPTIME=CURTIME;       /* SET TIME OF STATUS CHANGE     */ 01328000
         MVC   PDRPTIME(8,BUFPTR),CURTIME                          0794 01329000
*         END;                                                     0795 01330000
*       ELSE                                                       0796 01331000
*         ;                         /* LEAVE STATUS AS AS IS         */ 01332000
@RF00790 DS    0H                                                  0797 01333000
*       IF IBMFLDWD>0 THEN          /* IF IBM STATUS PRESENT         */ 01334000
         LH    @09,IBMFLDWD                                        0797 01335000
         LTR   @09,@09                                             0797 01336000
         BNP   @RF00797                                            0797 01337000
*         DO;                                                      0798 01338000
*           PDRISTAT=STATIBM(IBMFLDWD);/* SET IBM STATUS FIELD       */ 01339000
         SLA   @09,3                                               0799 01340000
         LA    @04,STATIBM-8(@09)                                  0799 01341000
         MVC   PDRISTAT(8,BUFPTR),0(@04)                           0799 01342000
*           PDRIDATE=CURDATE;       /* SET DATE OF IBM STATUS CHANGE */ 01343000
         MVC   PDRIDATE(8,BUFPTR),CURDATE                          0800 01344000
*           PDRITIME=CURTIME;       /* SET TIME OF IBM STATUS CHANGE */ 01345000
         MVC   PDRITIME(8,BUFPTR),CURTIME                          0801 01346000
*         END;                                                     0802 01347000
*       ELSE                                                       0803 01348000
*         ;                         /* LEAVE IBM STATUS AS IS        */ 01349000
@RF00797 DS    0H                                                  0804 01350000
*       IF PTFFLDWD>0 THEN          /* IF PTF STATUS PRESENT         */ 01351000
         LH    @09,PTFFLDWD                                        0804 01352000
         LTR   @09,@09                                             0804 01353000
         BNP   @RF00804                                            0804 01354000
*         DO;                                                      0805 01355000
*           PDRTSTAT=STATPTF(PTFFLDWD);/* SET PTF STATUS FIELD       */ 01356000
         SLA   @09,2                                               0806 01357000
         LA    @04,STATPTF-4(@09)                                  0806 01358000
         MVC   PDRTSTAT(4,BUFPTR),0(@04)                           0806 01359000
*           PDRTDATE=CURDATE;       /* SET DATE OF PTF STATUS CHANGE */ 01360000
         MVC   PDRTDATE(8,BUFPTR),CURDATE                          0807 01361000
*           PDRTTIME=CURTIME;       /* SET TIME OF PTF STATUS CHANGE */ 01362000
         MVC   PDRTTIME(8,BUFPTR),CURTIME                          0808 01363000
*         END;                                                     0809 01364000
*       ELSE                                                       0810 01365000
*         ;                         /* LEAVE PTF STATUS AS IS        */ 01366000
@RF00804 DS    0H                                                  0811 01367000
*       IF FIXFLDWD>0 THEN          /* IF FIX STATUS PRESENT         */ 01368000
         LH    @09,FIXFLDWD                                        0811 01369000
         LTR   @09,@09                                             0811 01370000
         BNP   @RF00811                                            0811 01371000
*         DO;                                                      0812 01372000
*           PDRFSTAT=STATFIX(FIXFLDWD);/* SET FIX STATUS FIELD       */ 01373000
         SLA   @09,2                                               0813 01374000
         LA    @04,STATFIX-4(@09)                                  0813 01375000
         MVC   PDRFSTAT(4,BUFPTR),0(@04)                           0813 01376000
*           PDRFDATE=CURDATE;       /* SET DATE OF FIX STATUS CHANGE */ 01377000
         MVC   PDRFDATE(8,BUFPTR),CURDATE                          0814 01378000
*           PDRFTIME=CURTIME;       /* SET TIME OF FIX STATUS CHANGE */ 01379000
         MVC   PDRFTIME(8,BUFPTR),CURTIME                          0815 01380000
*         END;                                                     0816 01381000
*       ELSE                                                       0817 01382000
*         ;                         /* LEAVE FIX STATUS AS IS        */ 01383000
@RF00811 DS    0H                                                  0818 01384000
*       IF DDSDFP=ON THEN           /* IF PROB DESCRIPTION IN DATA 0818 01385000
*                                      SET AND USER IS AUTHORIZED    */ 01386000
         TM    DDSDFP,B'10000000'                                  0818 01387000
         BNO   @RF00818                                            0818 01388000
*         DO;                                                      0819 01389000
*           CALL BLSEMDP1(ZZ2,DDS,MYBUF);/* BUILD RECORDS REMOTELY   */ 01390000
         ST    ZZ2PTR,@AL00001                                     0820 01391000
         LA    @09,DDS                                             0820 01392000
         ST    @09,@AL00001+4                                      0820 01393000
         ST    BUFPTR,@AL00001+8                                   0820 01394000
         L     @15,@CV01370                                        0820 01395000
         LA    @01,@AL00001                                        0820 01396000
         BALR  @14,@15                                             0820 01397000
*           RESPECIFY                                              0821 01398000
*             RF RESTRICTED;                                       0821 01399000
*           RETC=RF;                /* SAVE RETURN CODE              */ 01400000
         LR    RETC,RF                                             0822 01401000
*           RESPECIFY                                              0823 01402000
*             RF UNRESTRICTED;                                     0823 01403000
*         END;                                                     0824 01404000
*       ELSE                                                       0825 01405000
*         ;                         /* NO PROBLEM DESCRIPTION DATASET*/ 01406000
@RF00818 DS    0H                                                  0826 01407000
*     END;                                                         0826 01408000
*   ELSE                                                           0827 01409000
*     ;                             /* USER NOT AUTHORIZED           */ 01410000
@RF00744 DS    0H                                                  0828 01411000
*   IF DSCQFP=ON THEN               /* IF PROBLEM DESCRIPTION PRESENT*/ 01412000
         TM    DSCQFP,B'10000000'                                  0828 01413000
         BNO   @RF00828                                            0828 01414000
*     DO;                                                          0829 01415000
*       CALL DESLOCAL;              /* BUILD DESCRIPTION RECORD(S)   */ 01416000
         BAL   @14,DESLOCAL                                        0830 01417000
*       RESPECIFY                                                  0831 01418000
*         RF RESTRICTED;                                           0831 01419000
*       RETC=RF;                    /* SAVE RETURN CODE              */ 01420000
         LR    RETC,RF                                             0832 01421000
*       RESPECIFY                                                  0833 01422000
*         RF UNRESTRICTED;                                         0833 01423000
*     END;                                                         0834 01424000
*   ELSE                                                           0835 01425000
*     ;                             /* NO PROBLEM DESCRIPTION TEXT   */ 01426000
@RF00828 DS    0H                                                  0836 01427000
*   IF AUTHSW=0&(DTEIFP=ON|TMEIFP=ON|GRPIFP=ON|SIDIFP=ON|CIDIFP=ON|     01428000
*       OWNIFP=ON|UFLIFP=ON|SEVIFP=ON|APRIFP=ON|PTFIFP=ON|FIXQFP=ON|    01429000
*       ABSQFP=ON|PSTTYPE>0|IBMFLDWD>0|PTFFLDWD>0|FIXFLDWD>0|DDSDFP=ON) 01430000
*     THEN                          /* IF USER NOT AUTHORIZED        */ 01431000
         SLR   @09,@09                                             0836 01432000
         CR    AUTHSW,@09                                          0836 01433000
         BNE   @RF00836                                            0836 01434000
         TM    DTEIFP,B'10000000'                                  0836 01435000
         BO    @RT00836                                            0836 01436000
         TM    TMEIFP,B'10000000'                                  0836 01437000
         BO    @RT00836                                            0836 01438000
         TM    GRPIFP,B'10000000'                                  0836 01439000
         BO    @RT00836                                            0836 01440000
         TM    SIDIFP,B'10000000'                                  0836 01441000
         BO    @RT00836                                            0836 01442000
         TM    CIDIFP,B'10000000'                                  0836 01443000
         BO    @RT00836                                            0836 01444000
         TM    OWNIFP,B'10000000'                                  0836 01445000
         BO    @RT00836                                            0836 01446000
         TM    UFLIFP,B'10000000'                                  0836 01447000
         BO    @RT00836                                            0836 01448000
         TM    SEVIFP,B'10000000'                                  0836 01449000
         BO    @RT00836                                            0836 01450000
         TM    APRIFP,B'10000000'                                  0836 01451000
         BO    @RT00836                                            0836 01452000
         TM    PTFIFP,B'10000000'                                  0836 01453000
         BO    @RT00836                                            0836 01454000
         TM    FIXQFP,B'10000000'                                  0836 01455000
         BO    @RT00836                                            0836 01456000
         TM    ABSQFP,B'10000000'                                  0836 01457000
         BO    @RT00836                                            0836 01458000
         CH    @09,PSTTYPE                                         0836 01459000
         BL    @RT00836                                            0836 01460000
         CH    @09,IBMFLDWD                                        0836 01461000
         BL    @RT00836                                            0836 01462000
         CH    @09,PTFFLDWD                                        0836 01463000
         BL    @RT00836                                            0836 01464000
         CH    @09,FIXFLDWD                                        0836 01465000
         BL    @RT00836                                            0836 01466000
         TM    DDSDFP,B'10000000'                                  0836 01467000
         BNO   @RF00836                                            0836 01468000
@RT00836 DS    0H                                                  0837 01469000
*     DO;                                                          0837 01470000
*       DO;                         /* BLSDMSG                     0838 01471000
*                                      (ZZ2,04004,DMCBMSG,BLSDMSGS) R   01472000
*                                      OUTE(BOTH)INSERT(FPPIDP,PDRKPN   01473000
*                                      UM)LIFO                       */ 01474000
*         IOPTLIST(1)=ADDR(IOPTLIST(4));/* CHAIN TO NEXT INSERT      */ 01475000
         LA    @09,IOPTLIST+12                                     0839 01476000
         ST    @09,IOPTLIST                                        0839 01477000
*         IOPTLIST(2)=ADDR(FPPIDP); /* INSERT NAME POINTER           */ 01478000
         L     @09,ZZ2ZZ1P(,ZZ2PTR)                                0840 01479000
         L     @04,ZZ1FPP(,@09)                                    0840 01480000
         LA    @04,FPPIDP(,@04)                                    0840 01481000
         ST    @04,IOPTLIST+4                                      0840 01482000
*         IOPTLIST(3)=0;            /* ZERO RESERVED FIELD           */ 01483000
         SLR   @04,@04                                             0841 01484000
         ST    @04,IOPTLIST+8                                      0841 01485000
*         RFY                                                      0842 01486000
*           I015F BASED(ADDR(IOPTLIST(3)));/* ACCESS BYTES 1-2       */ 01487000
*         I015F=LENGTH(FPPIDP);     /* INSERT LENGTH                 */ 01488000
         LA    @15,IOPTLIST+8                                      0843 01489000
         MVC   I015F(2,@15),@CH00094                               0843 01490000
*         IOPTLIST(4)=0;            /* LAST INSERT                   */ 01491000
         ST    @04,IOPTLIST+12                                     0844 01492000
*         IOPTLIST(5)=ADDR(PDRKPNUM);/* INSERT NAME POINTER          */ 01493000
         LA    @15,PDRKPNUM(,BUFPTR)                               0845 01494000
         ST    @15,IOPTLIST+16                                     0845 01495000
*         IOPTLIST(6)=0;            /* ZERO RESERVED FIELD           */ 01496000
         ST    @04,IOPTLIST+20                                     0846 01497000
*         RFY                                                      0847 01498000
*           I015F BASED(ADDR(IOPTLIST(6)));/* ACCESS BYTES 1-2       */ 01499000
*         I015F=LENGTH(PDRKPNUM);   /* INSERT LENGTH                 */ 01500000
         LA    @04,IOPTLIST+20                                     0848 01501000
         MVC   I015F(2,@04),@CH00091                               0848 01502000
*         CALL BLSDMSG0(ZZ2,04004,DMCBMSG,BLSDMSGS,'10110000'B,ADDR(    01503000
*             IOPTLIST));           /* BUILD MESSAGE                 */ 01504000
         ST    ZZ2PTR,@AL00001                                     0849 01505000
         LA    @04,@CF01602                                        0849 01506000
         ST    @04,@AL00001+4                                      0849 01507000
         L     @09,ZZ1PDRP(,@09)                                   0849 01508000
         LA    @09,DMCBMSG(,@09)                                   0849 01509000
         ST    @09,@AL00001+8                                      0849 01510000
         L     @09,ZZ2MSGSP(,ZZ2PTR)                               0849 01511000
         ST    @09,@AL00001+12                                     0849 01512000
         LA    @09,@CB01589                                        0849 01513000
         ST    @09,@AL00001+16                                     0849 01514000
         LA    @09,IOPTLIST                                        0849 01515000
         ST    @09,@AFTEMPS+4                                      0849 01516000
         LA    @09,@AFTEMPS+4                                      0849 01517000
         ST    @09,@AL00001+20                                     0849 01518000
         L     @15,ZZ2MSG0P(,ZZ2PTR)                               0849 01519000
         LA    @01,@AL00001                                        0849 01520000
         BALR  @14,@15                                             0849 01521000
*       END;                        /* BLSDMSG                     0850 01522000
*                                      (ZZ2,04004,DMCBMSG,BLSDMSGS) R   01523000
*                                      OUTE(BOTH)INSERT(FPPIDP,PDRKPN   01524000
*                                      UM)LIFO                       */ 01525000
*       RETC=EIGHT;                 /* SET ERROR RETURN CODE         */ 01526000
         LA    RETC,8                                              0851 01527000
*     END;                                                         0852 01528000
*   ELSE                                                           0853 01529000
*     ;                                                            0853 01530000
@RF00836 DS    0H                                                  0854 01531000
*   END SEG4;                                                      0854 01532000
@EL00008 DS    0H                                                  0854 01533000
@EF00008 DS    0H                                                  0854 01534000
@ER00008 LM    @14,@07,@SA00008                                    0854 01535000
         LM    @09,@12,@SA00008+40                                 0854 01536000
         BR    @14                                                 0854 01537000
         EJECT                                                          01538000
*DESLOCAL:                                                         0855 01539000
*   PROCEDURE;                                                     0855 01540000
*                                                                  0855 01541000
DESLOCAL STM   @14,@12,@SA00009                                    0855 01542000
*   /*****************************************************************/ 01543000
*   /*                                                               */ 01544000
*   /* THIS ROUTINE COPIES THE PROBLEM DESCRIPTION INTO THE PROBLEM  */ 01545000
*   /* DIRECTORY DATA SET                                            */ 01546000
*   /*                                                               */ 01547000
*   /*****************************************************************/ 01548000
*                                                                  0856 01549000
*   DECLARE                                                        0856 01550000
*     DESBUFP POINTER(31),          /* LOCAL BUFFER POINTER          */ 01551000
*     I POINTER(31),                /* INDEX TO INPUT BYTE           */ 01552000
*     J POINTER(31),                /* INDEX TO OUTPUT BYTE          */ 01553000
*     K POINTER(31),                /* INDEX TO DESCRIPTION LINE     */ 01554000
*     L POINTER(31),                /* INDEX TO LAST BLANK IN OUTPUT */ 01555000
*     RNUM FIXED(31);               /* DESCRIPTION RECORD SEQUENCE 0856 01556000
*                                      NUMBER                        */ 01557000
*   DESBUFP=ADDR(BUF2);             /* SET POINTER TO BUFFER         */ 01558000
         LA    DESBUFP,BUF2                                        0857 01559000
*   J=1;                            /* INITIALIZE BYTE INDEX         */ 01560000
         LA    @04,1                                               0858 01561000
         ST    @04,J                                               0858 01562000
*   L=1;                            /* INITIALIZE BLANK INDEX        */ 01563000
         ST    @04,L                                               0859 01564000
*   DESBUFP->PDREC=PDREC;           /* COPY RECORD HEADER            */ 01565000
         MVC   PDREC(16,DESBUFP),PDREC(BUFPTR)                     0860 01566000
*   RNUM=PDRDESCL/PDRDEMAX;         /* COMPUTE RECORD SEQUENCE NUMBER*/ 01567000
         LA    @04,13                                              0861 01568000
         L     @15,PDRDESCL(,BUFPTR)                               0861 01569000
         LR    @00,@15                                             0861 01570000
         SRDA  @00,32                                              0861 01571000
         DR    @00,@04                                             0861 01572000
         ST    @01,RNUM                                            0861 01573000
*   K=PDRDESCL//PDRDEMAX;           /* COMPUTE LINE NUMBER           */ 01574000
         LR    @02,@15                                             0862 01575000
         SRDA  @02,32                                              0862 01576000
         DR    @02,@04                                             0862 01577000
         ST    @02,K                                               0862 01578000
*   RESPECIFY                                                      0863 01579000
*     PDREC BASED(DESBUFP);         /* BASE DIRECTORY RECORD IN    0863 01580000
*                                      BUFFER                        */ 01581000
*   PDRKRCTY=PDRDESCC;              /* SET RECORD TYPE TO PROBLEM  0864 01582000
*                                      DESCRIPTION                   */ 01583000
         MVC   PDRKRCTY(2,DESBUFP),@CC01275                        0864 01584000
*   IF BUFPTR->PDRDESCL^=0 THEN     /* IF DESCRIPTION EXISTS         */ 01585000
         SLR   @04,@04                                             0865 01586000
         CR    @15,@04                                             0865 01587000
         BE    @RF00865                                            0865 01588000
*     DO;                           /* APPEND THIS DESCRIPTION       */ 01589000
*       IF K^=0 THEN                /* IF LAST RECORD NOT FULL       */ 01590000
         CR    @02,@04                                             0867 01591000
         BE    @RF00867                                            0867 01592000
*         DO;                       /* ADD LINES TO LAST RECORD      */ 01593000
*           CVD(RNUM,PACKED);       /* CONVERT RECORD NUMBER TO    0869 01594000
*                                      DECIMAL                       */ 01595000
         CVD   @01,PACKED                                          0869 01596000
*           UNPK(PDRRECSQ,PACKED);  /* UNPACK IT                     */ 01597000
         UNPK  PDRRECSQ(4,DESBUFP),PACKED(8)                       0870 01598000
*           PDRRECSQ(LENGTH(PDRRECSQ))=PDRRECSQ(LENGTH(PDRRECSQ))|'0';  01599000
*                                                                  0871 01600000
         OI    PDRRECSQ+3(DESBUFP),C'0'                            0871 01601000
*           /*********************************************************/ 01602000
*           /*                                                       */ 01603000
*           /* CORRECT ZONE OF LAST DIGIT BLSGET (ZZ1PDRP)           */ 01604000
*           /* AREAL(DESBUFP)ARG(PDRKEY)ARGLEN(LENGTH(PDRKEY))UPD    */ 01605000
*           /* KEYEQ                                                 */ 01606000
*           /*                                                       */ 01607000
*           /*********************************************************/ 01608000
*                                                                  0872 01609000
*           DO;                     /* BLSGET (ZZ1PDRP) AREAL(DESBUFP   01610000
*                                      )ARG(PDRKEY)ARGLEN(LENGTH(PDRK   01611000
*                                      EY))UPD KEYEQ                 */ 01612000
*             RFY                                                  0873 01613000
*               GPR01P RSTD;                                       0873 01614000
*             GPR01P=ZZ1PDRP;       /* ADDRESS DMCB                  */ 01615000
         L     @04,ZZ2ZZ1P(,ZZ2PTR)                                0874 01616000
         L     GPR01P,ZZ1PDRP(,@04)                                0874 01617000
*             RFY                                                  0875 01618000
*               DMCB BASED(GPR01P);                                0875 01619000
*             IF((GPR01P&'FFFFFFF8'X)=GPR01P)&DMCBID='DMCB'/* VALID     01620000
*                                      DMCB ?                        */ 01621000
*               THEN                                               0876 01622000
         LR    @04,GPR01P                                          0876 01623000
         N     @04,@CF01531                                        0876 01624000
         CLR   @04,GPR01P                                          0876 01625000
         BNE   @RF00876                                            0876 01626000
         CLC   DMCBID(4,GPR01P),@CC01532                           0876 01627000
         BNE   @RF00876                                            0876 01628000
*               DO;                                                0877 01629000
*                 DMCBBUFP=DESBUFP&'7FFFFFFF'X;/* PLACE BUFFER     0878 01630000
*                                      ADDRESS IN DMCB               */ 01631000
         LR    @04,DESBUFP                                         0878 01632000
         N     @04,@CF01548                                        0878 01633000
         ST    @04,DMCBBUFP(,GPR01P)                               0878 01634000
*                 DMCBKEYP=ADDR(PDRKEY);/* PLACE KEY ADDRESS IN DMCB */ 01635000
         ST    DESBUFP,DMCBKEYP(,GPR01P)                           0879 01636000
*                 DMCBKEYL=(LENGTH(PDRKEY))&'7FFFFFFF'X;/* PLACE KEY    01637000
*                                      LENGTH IN DMCB                */ 01638000
         MVC   DMCBKEYL(4,GPR01P),@CF01037                         0880 01639000
*                 DMCBKYD='1'B;     /* INDICATE KEYED ACCESS         */ 01640000
*                 DMCBAPX='0'B;     /* INDICATE EXACT KEY MATCH      */ 01641000
*                 DMCBGKY='0'B;     /* INDICATE FULL KEY SEARCH      */ 01642000
*                 DMCBUPD='1'B;     /* INDICATE UPDATE OPTION        */ 01643000
         OI    DMCBKYD(GPR01P),B'10010000'                         0884 01644000
         NI    DMCBAPX(GPR01P),B'10011111'                         0884 01645000
*                 DMCBRQST=DMCBGER; /* INDICATE GET REQUEST          */ 01646000
         MVI   DMCBRQST(GPR01P),X'04'                              0885 01647000
*                 CALL DMCBRI->DMCBDMGR;/* CALL BLSCRQST             */ 01648000
         L     @15,DMCBRI(,GPR01P)                                 0886 01649000
         BALR  @14,@15                                             0886 01650000
*               END;                                               0887 01651000
*             ELSE                                                 0888 01652000
*               DO;                                                0888 01653000
         B     @RC00876                                            0888 01654000
@RF00876 DS    0H                                                  0889 01655000
*                 RFY                                              0889 01656000
*                  (GPR00F,                                        0889 01657000
*                   GPR15F) RSTD;                                  0889 01658000
*                 GPR00F=0;         /* INDICATE NO MESSAGE CHAIN     */ 01659000
         SLR   GPR00F,GPR00F                                       0890 01660000
*                 GPR15F=16;        /* INDICATE INVALID DMCB         */ 01661000
         LA    GPR15F,16                                           0891 01662000
*                 RFY                                              0892 01663000
*                  (GPR00F,                                        0892 01664000
*                   GPR15F);                                       0892 01665000
*               END;                                               0893 01666000
*             RFY                                                  0894 01667000
*               DMCB;                                              0894 01668000
@RC00876 DS    0H                                                  0895 01669000
*             RFY                                                  0895 01670000
*               GPR01P;                                            0895 01671000
*           END;                    /* BLSGET (ZZ1PDRP) AREAL(DESBUFP   01672000
*                                      )ARG(PDRKEY)ARGLEN(LENGTH(PDRK   01673000
*                                      EY))UPD KEYEQ                 */ 01674000
*           RESPECIFY                                              0897 01675000
*             RF RESTRICTED;                                       0897 01676000
*           IF RF^=0 THEN           /* IF RETURN CODE NOT ZERO       */ 01677000
         LTR   RF,RF                                               0898 01678000
         BZ    @RF00898                                            0898 01679000
*             DO;                                                  0899 01680000
*               IF RF=16 THEN       /* IF INVALID DMCB               */ 01681000
         C     RF,@CF00052                                         0900 01682000
         BNE   @RF00900                                            0900 01683000
*                 DO;               /* ABEND(200) DUMP               */ 01684000
*                   RESPECIFY                                      0902 01685000
*                    (GPR01F) RESTRICTED;                          0902 01686000
*                   GPR01F=200;     /* COMP CODE IN REG 1            */ 01687000
         LA    GPR01F,200                                          0903 01688000
*                   GPR01F=GPR01F|'80000000'X;/* DUMP/STEP/DUMPOPTS     01689000
*                                      FLAG                          */ 01690000
         O     GPR01F,@CF00061                                     0904 01691000
*                   SVC(13);        /* ISSUE ABEND SVC               */ 01692000
         SVC   13                                                  0905 01693000
*                   RESPECIFY                                      0906 01694000
*                    (GPR01F) UNRESTRICTED;                        0906 01695000
*                 END;              /* ABEND(200) DUMP QUIT RIGHT  0907 01696000
*                                      HERE                          */ 01697000
*               ELSE                                               0908 01698000
*                 ;                                                0908 01699000
@RF00900 DS    0H                                                  0909 01700000
*               RETC=RF;            /* SAVE RETURN CODE              */ 01701000
         LR    RETC,RF                                             0909 01702000
*               RESPECIFY                                          0910 01703000
*                 RF UNRESTRICTED;                                 0910 01704000
*               CALL MSG4(04044);   /* ERROR WRITING PROB DIRECTORY  */ 01705000
         LA    @01,@AL00911                                        0911 01706000
         BAL   @14,MSG4                                            0911 01707000
*             END;                                                 0912 01708000
*           ELSE                    /* NO PROBLEM                    */ 01709000
*             DO;                                                  0913 01710000
         B     @RC00898                                            0913 01711000
@RF00898 DS    0H                                                  0914 01712000
*               J=1;                /* INITIALIZE INDEX TO OUTPUT  0914 01713000
*                                      BYTE                          */ 01714000
         LA    @04,1                                               0914 01715000
         ST    @04,J                                               0914 01716000
*               L=1;                /* INITIALIZE BLANK INDEX        */ 01717000
         ST    @04,L                                               0915 01718000
*               K=K+1;              /* STEP LINE INDEX               */ 01719000
         AL    @04,K                                               0916 01720000
         ST    @04,K                                               0916 01721000
*             END;                                                 0917 01722000
*         END;                                                     0918 01723000
*       ELSE                                                       0919 01724000
*         DO;                       /* SET FOR NEW RECORD            */ 01725000
         B     @RC00867                                            0919 01726000
@RF00867 DS    0H                                                  0920 01727000
*           J=1;                    /* INITIALIZE INDEX TO OUTPUT  0920 01728000
*                                      BYTE                          */ 01729000
         LA    @04,1                                               0920 01730000
         ST    @04,J                                               0920 01731000
*           L=1;                    /* INITIALIZE BLANK INDEX        */ 01732000
         ST    @04,L                                               0921 01733000
*           K=1;                    /* INITIALIZE LINE INDEX         */ 01734000
         ST    @04,K                                               0922 01735000
*         END;                                                     0923 01736000
*     END;                                                         0924 01737000
*   ELSE                                                           0925 01738000
*     DO;                           /* NO DESCRIPTION EXISTS         */ 01739000
         B     @RC00865                                            0925 01740000
@RF00865 DS    0H                                                  0926 01741000
*       J=1;                        /* INITIALIZE INDEX TO OUTPUT  0926 01742000
*                                      BYTE                          */ 01743000
         LA    @04,1                                               0926 01744000
         ST    @04,J                                               0926 01745000
*       L=1;                        /* INITIALIZE BLANK INDEX        */ 01746000
         ST    @04,L                                               0927 01747000
*       K=1;                        /* INITIALIZE LINE INDEX         */ 01748000
         ST    @04,K                                               0928 01749000
*       RNUM=0;                     /* INITIALIZE RECORD NUMBER      */ 01750000
         SLR   @04,@04                                             0929 01751000
         ST    @04,RNUM                                            0929 01752000
*     END;                                                         0930 01753000
*   DO I=1 TO DSCQL WHILE RETC=0;   /* COPY DESCRIPTION TEXT         */ 01754000
@RC00865 LA    I,1                                                 0931 01755000
         B     @DE00931                                            0931 01756000
@DL00931 LTR   RETC,RETC                                           0931 01757000
         BNZ   @DC00931                                            0931 01758000
*     IF J^=L|DSCQ(I)^=' ' THEN     /* SKIP OVER LEADING BLANKS      */ 01759000
         CLC   J(4),L                                              0932 01760000
         BNE   @RT00932                                            0932 01761000
         L     @04,DSCQP                                           0932 01762000
         ALR   @04,I                                               0932 01763000
         BCTR  @04,0                                               0932 01764000
         CLI   DSCQ(@04),C' '                                      0932 01765000
         BE    @RF00932                                            0932 01766000
@RT00932 DS    0H                                                  0933 01767000
*       DO;                         /* ON OUR WAY                    */ 01768000
*         PDRDESC(K,J)=DSCQ(I)|' '; /* COPY A BYTE                   */ 01769000
         L     @04,J                                               0934 01770000
         L     @03,K                                               0934 01771000
         MH    @03,@CH01256                                        0934 01772000
         ALR   @03,@04                                             0934 01773000
         ALR   @03,DESBUFP                                         0934 01774000
         AL    @03,@CF01677                                        0934 01775000
         L     @15,DSCQP                                           0934 01776000
         LR    @14,@15                                             0934 01777000
         ALR   @14,I                                               0934 01778000
         BCTR  @14,0                                               0934 01779000
         MVC   PDRDESC-16(1,@03),DSCQ(@14)                         0934 01780000
         OI    PDRDESC-16(@03),C' '                                0934 01781000
*         J=J+1;                    /* BUMP INDEX TO OUTPUT BYTE     */ 01782000
         AL    @04,@CF00041                                        0935 01783000
         ST    @04,J                                               0935 01784000
*         IF DSCQ(I)=' ' THEN       /* IF A BLANK WAS MOVED          */ 01785000
         ALR   @15,I                                               0936 01786000
         BCTR  @15,0                                               0936 01787000
         CLI   DSCQ(@15),C' '                                      0936 01788000
         BNE   @RF00936                                            0936 01789000
*           L=J;                    /* SAVE THE INDEX TO NEXT BYTE   */ 01790000
         ST    @04,L                                               0937 01791000
*         ELSE                                                     0938 01792000
*           ;                       /* NOT A BLANK                   */ 01793000
@RF00936 DS    0H                                                  0939 01794000
*         IF J>LENGTH(PDRDESC) THEN /* IF DESCRIPTION LINE IS FULL   */ 01795000
         CLC   J(4),@CF01256                                       0939 01796000
         BNH   @RF00939                                            0939 01797000
*           DO;                                                    0940 01798000
*             CALL STEPLINE;        /* STEP TO NEXT LINE             */ 01799000
         BAL   @14,STEPLINE                                        0941 01800000
*             RESPECIFY                                            0942 01801000
*               RF RESTRICTED;                                     0942 01802000
*             RETC=RF;              /* SAVE RETURN CODE              */ 01803000
         LR    RETC,RF                                             0943 01804000
*             RESPECIFY                                            0944 01805000
*               RF UNRESTRICTED;                                   0944 01806000
*           END;                                                   0945 01807000
*         ELSE                                                     0946 01808000
*           ;                       /* LINE NOT FULL                 */ 01809000
@RF00939 DS    0H                                                  0947 01810000
*       END;                        /* ONE BYTE MOVED                */ 01811000
*     ELSE                                                         0948 01812000
*       ;                           /* SKIPPING LEADING AND MULTIPLE    01813000
*                                      BLANKS                        */ 01814000
@RF00932 DS    0H                                                  0949 01815000
*   END;                            /* FINISHED WITH INPUT TEXT      */ 01816000
         AL    I,@CF00041                                          0949 01817000
@DE00931 CH    I,DSCQL                                             0949 01818000
         BNH   @DL00931                                            0949 01819000
@DC00931 DS    0H                                                  0950 01820000
*   IF J>1 THEN                     /* IF PARTIAL LINE FILLED        */ 01821000
         L     @04,J                                               0950 01822000
         C     @04,@CF00041                                        0950 01823000
         BNH   @RF00950                                            0950 01824000
*     DO;                           /* BLANK OUT THE REST OF IT      */ 01825000
*       DO I=J TO LENGTH(PDRDESC);  /* JUST DO ONE LINE              */ 01826000
         LR    I,@04                                               0952 01827000
         B     @DE00952                                            0952 01828000
@DL00952 DS    0H                                                  0953 01829000
*         PDRDESC(K,I)=' ';         /* PAD IT WITH BLANKS            */ 01830000
         L     @04,K                                               0953 01831000
         MH    @04,@CH01256                                        0953 01832000
         ALR   @04,I                                               0953 01833000
         ALR   @04,DESBUFP                                         0953 01834000
         AL    @04,@CF01677                                        0953 01835000
         MVI   PDRDESC-16(@04),C' '                                0953 01836000
*       END;                        /* END OF PADDING LOOP           */ 01837000
         AL    I,@CF00041                                          0954 01838000
@DE00952 C     I,@CF01256                                          0954 01839000
         BNH   @DL00952                                            0954 01840000
*       K=K+1;                      /* BUMP THE LINE COUNTER         */ 01841000
         LA    @04,1                                               0955 01842000
         L     @15,K                                               0955 01843000
         ALR   @15,@04                                             0955 01844000
         ST    @15,K                                               0955 01845000
*       BUFPTR->PDRDESCL=BUFPTR->PDRDESCL+1;/* LIKEWISE THE TOTAL    */ 01846000
         AL    @04,PDRDESCL(,BUFPTR)                               0956 01847000
         ST    @04,PDRDESCL(,BUFPTR)                               0956 01848000
*     END;                          /* END OF ODD LINE PROCESS       */ 01849000
*   ELSE                                                           0958 01850000
*     ;                             /* NO PARTIAL LINE PRESENT       */ 01851000
@RF00950 DS    0H                                                  0959 01852000
*   IF K>1&RETC=0 THEN              /* IF ANY LINES IN RECORD        */ 01853000
         L     @04,K                                               0959 01854000
         C     @04,@CF00041                                        0959 01855000
         BNH   @RF00959                                            0959 01856000
         LTR   RETC,RETC                                           0959 01857000
         BNZ   @RF00959                                            0959 01858000
*     DO;                           /* WRITE OUT THE LAST ONE        */ 01859000
*       K=K-1;                      /* STEP BACK TO TRUE LINE COUNT  */ 01860000
         BCTR  @04,0                                               0961 01861000
         ST    @04,K                                               0961 01862000
*       IF RNUM<10000 THEN                                         0962 01863000
         L     @15,RNUM                                            0962 01864000
         C     @15,@CF01617                                        0962 01865000
         BNL   @RF00962                                            0962 01866000
*         DO;                                                      0963 01867000
*           CVD(RNUM,PACKED);       /* CONVERT RECORD NUMBER TO    0964 01868000
*                                      DECIMAL                       */ 01869000
         CVD   @15,PACKED                                          0964 01870000
*           UNPK(PDRRECSQ,PACKED);  /* UNPACK IT                     */ 01871000
         UNPK  PDRRECSQ(4,DESBUFP),PACKED(8)                       0965 01872000
*           PDRRECSQ(LENGTH(PDRRECSQ))=PDRRECSQ(LENGTH(PDRRECSQ))|'0';  01873000
*                                                                  0966 01874000
         OI    PDRRECSQ+3(DESBUFP),C'0'                            0966 01875000
*           /*********************************************************/ 01876000
*           /*                                                       */ 01877000
*           /* CORRECT ZONE OF LAST DIGIT BLSPUT (ZZ1PDRP)           */ 01878000
*           /* AREA(PDREC)RECLEN(LENGTH(PDREC)+K*LENGTH(PDRDESC))    */ 01879000
*           /*                                                       */ 01880000
*           /*********************************************************/ 01881000
*                                                                  0967 01882000
*           DO;                     /* BLSPUT (ZZ1PDRP) AREA(PDREC)RE   01883000
*                                      CLEN(LENGTH(PDREC)+K*LENGTH(PD   01884000
*                                      RDESC))                       */ 01885000
*             RFY                                                  0968 01886000
*               GPR01P RSTD;                                       0968 01887000
*             GPR01P=ZZ1PDRP;       /* ADDRESS DMCB                  */ 01888000
         L     @15,ZZ2ZZ1P(,ZZ2PTR)                                0969 01889000
         L     GPR01P,ZZ1PDRP(,@15)                                0969 01890000
*             RFY                                                  0970 01891000
*               DMCB BASED(GPR01P);                                0970 01892000
*             IF((GPR01P&'FFFFFFF8'X)=GPR01P)&DMCBID='DMCB'/* VALID     01893000
*                                      DMCB ?                        */ 01894000
*               THEN                                               0971 01895000
         LR    @00,GPR01P                                          0971 01896000
         N     @00,@CF01531                                        0971 01897000
         CLR   @00,GPR01P                                          0971 01898000
         BNE   @RF00971                                            0971 01899000
         CLC   DMCBID(4,GPR01P),@CC01532                           0971 01900000
         BNE   @RF00971                                            0971 01901000
*               DO;                                                0972 01902000
*                 DMCBBUFP=ADDR(PDREC);/* PLACE BUFFER ADDRESS IN  0973 01903000
*                                      DMCB                          */ 01904000
         ST    DESBUFP,DMCBBUFP(,GPR01P)                           0973 01905000
*                 DMCBORL=(LENGTH(PDREC)+K*LENGTH(PDRDESC))&'7FFFFFFF'X 01906000
*                     ;             /* PLACE RECORD LENGTH IN DMCB   */ 01907000
         MH    @04,@CH01256                                        0974 01908000
         AL    @04,@CF00052                                        0974 01909000
         N     @04,@CF01548                                        0974 01910000
         ST    @04,DMCBORL(,GPR01P)                                0974 01911000
*                 DMCBRQST=DMCBPUR; /* INDICATE PUT REQUEST          */ 01912000
         MVI   DMCBRQST(GPR01P),X'05'                              0975 01913000
*                 CALL DMCBRI->DMCBDMGR;/* CALL BLSCRQST             */ 01914000
         L     @15,DMCBRI(,GPR01P)                                 0976 01915000
         BALR  @14,@15                                             0976 01916000
*               END;                                               0977 01917000
*             ELSE                                                 0978 01918000
*               DO;                                                0978 01919000
         B     @RC00971                                            0978 01920000
@RF00971 DS    0H                                                  0979 01921000
*                 RFY                                              0979 01922000
*                  (GPR00F,                                        0979 01923000
*                   GPR15F) RSTD;                                  0979 01924000
*                 GPR00F=0;         /* INDICATE NO MESSAGE CHAIN     */ 01925000
         SLR   GPR00F,GPR00F                                       0980 01926000
*                 GPR15F=16;        /* INDICATE INVALID DMCB         */ 01927000
         LA    GPR15F,16                                           0981 01928000
*                 RFY                                              0982 01929000
*                  (GPR00F,                                        0982 01930000
*                   GPR15F);                                       0982 01931000
*               END;                                               0983 01932000
*             RFY                                                  0984 01933000
*               DMCB;                                              0984 01934000
@RC00971 DS    0H                                                  0985 01935000
*             RFY                                                  0985 01936000
*               GPR01P;                                            0985 01937000
*           END;                    /* BLSPUT (ZZ1PDRP) AREA(PDREC)RE   01938000
*                                      CLEN(LENGTH(PDREC)+K*LENGTH(PD   01939000
*                                      RDESC)) WRITE OUT LAST      0986 01940000
*                                      DESCRIPTION RECORD            */ 01941000
*           RESPECIFY                                              0987 01942000
*             RF RESTRICTED;                                       0987 01943000
*           IF RF^=0 THEN           /* IF RETURN CODE NOT ZERO       */ 01944000
         LTR   RF,RF                                               0988 01945000
         BZ    @RF00988                                            0988 01946000
*             DO;                                                  0989 01947000
*               IF RF=16 THEN       /* IF INVALID DMCB               */ 01948000
         C     RF,@CF00052                                         0990 01949000
         BNE   @RF00990                                            0990 01950000
*                 DO;               /* ABEND(200) DUMP               */ 01951000
*                   RESPECIFY                                      0992 01952000
*                    (GPR01F) RESTRICTED;                          0992 01953000
*                   GPR01F=200;     /* COMP CODE IN REG 1            */ 01954000
         LA    GPR01F,200                                          0993 01955000
*                   GPR01F=GPR01F|'80000000'X;/* DUMP/STEP/DUMPOPTS     01956000
*                                      FLAG                          */ 01957000
         O     GPR01F,@CF00061                                     0994 01958000
*                   SVC(13);        /* ISSUE ABEND SVC               */ 01959000
         SVC   13                                                  0995 01960000
*                   RESPECIFY                                      0996 01961000
*                    (GPR01F) UNRESTRICTED;                        0996 01962000
*                 END;              /* ABEND(200) DUMP QUIT RIGHT  0997 01963000
*                                      HERE                          */ 01964000
*               ELSE                                               0998 01965000
*                 ;                                                0998 01966000
@RF00990 DS    0H                                                  0999 01967000
*               RETC=RF;            /* SAVE RETURN CODE              */ 01968000
         LR    RETC,RF                                             0999 01969000
*               RESPECIFY                                          1000 01970000
*                 RF UNRESTRICTED;                                 1000 01971000
*               CALL MSG4(04044);   /* ERROR WRITING PROB DIRECTORY  */ 01972000
         LA    @01,@AL01001                                        1001 01973000
         BAL   @14,MSG4                                            1001 01974000
*             END;                                                 1002 01975000
*           ELSE                                                   1003 01976000
*             ;                     /* NO PROBLEM                    */ 01977000
@RF00988 DS    0H                                                  1004 01978000
*         END;                                                     1004 01979000
*       ELSE                                                       1005 01980000
*         CALL MSG4(04070);         /* RECORD NUMBER OVERFLOW        */ 01981000
         B     @RC00962                                            1005 01982000
@RF00962 LA    @01,@AL01005                                        1005 01983000
         BAL   @14,MSG4                                            1005 01984000
*     END;                                                         1006 01985000
*   ELSE                                                           1007 01986000
*     ;                             /* CAME OUT EVEN WITH NOTHING  1007 01987000
*                                      LEFT OVER (THAT'S UNUSUAL!)   */ 01988000
@RF00959 DS    0H                                                  1008 01989000
*   RETURN CODE(RETC);              /* ALL IS WELL                   */ 01990000
@RC00959 LR    @15,RETC                                            1008 01991000
         L     @14,@SA00009                                        1008 01992000
         LM    @00,@12,@SA00009+8                                  1008 01993000
         BR    @14                                                 1008 01994000
         EJECT                                                          01995000
*STEPLINE:                                                         1009 01996000
*   PROCEDURE;                                                     1009 01997000
STEPLINE STM   @14,@01,@SA00010                                    1009 01998000
         STM   @03,@12,@SA00010+16                                 1009 01999000
*   IF L^=J&I<DSCQL&DSCQ(I+1)^=' '&L^=1 THEN/* NOT BLANK?            */ 02000000
         L     @04,L                                               1010 02001000
         L     @03,J                                               1010 02002000
         CR    @04,@03                                             1010 02003000
         BE    @RF01010                                            1010 02004000
         CH    I,DSCQL                                             1010 02005000
         BNL   @RF01010                                            1010 02006000
         L     @01,DSCQP                                           1010 02007000
         ALR   @01,I                                               1010 02008000
         CLI   DSCQ(@01),C' '                                      1010 02009000
         BE    @RF01010                                            1010 02010000
         C     @04,@CF00041                                        1010 02011000
         BE    @RF01010                                            1010 02012000
*     DO;                           /* PUT WORD IN NEXT LINE         */ 02013000
*       I=I+L-J;                    /* BACK UP THE INPUT             */ 02014000
         LR    @15,I                                               1012 02015000
         ALR   @15,@04                                             1012 02016000
         SLR   @15,@03                                             1012 02017000
         LR    I,@15                                               1012 02018000
*       DO L=L TO LENGTH(PDRDESC);  /* CLEAR PARTIAL WORD IN OUTPUT  */ 02019000
         B     @DE01013                                            1013 02020000
@DL01013 DS    0H                                                  1014 02021000
*         PDRDESC(K,L)=' ';         /* BLANK IT OUT                  */ 02022000
         L     @03,K                                               1014 02023000
         MH    @03,@CH01256                                        1014 02024000
         ALR   @03,@04                                             1014 02025000
         ALR   @03,DESBUFP                                         1014 02026000
         AL    @03,@CF01677                                        1014 02027000
         MVI   PDRDESC-16(@03),C' '                                1014 02028000
*       END;                        /* END OF BLANKING LOOP          */ 02029000
         AL    @04,@CF00041                                        1015 02030000
         ST    @04,L                                               1015 02031000
@DE01013 C     @04,@CF01256                                        1015 02032000
         BNH   @DL01013                                            1015 02033000
*     END;                          /* ALL DONE                      */ 02034000
*   ELSE                            /* NEXT CHARACTER IS BLANK OR    */ 02035000
*     ;                             /* LAST CHARACTER IN LINE BLANK  */ 02036000
@RF01010 DS    0H                                                  1018 02037000
*   L=1;                            /* RESET BLANK INDEX             */ 02038000
         LA    @04,1                                               1018 02039000
         ST    @04,L                                               1018 02040000
*   J=1;                            /* SET INDEX TO FIRST BYTE OF  1019 02041000
*                                      LINE                          */ 02042000
         ST    @04,J                                               1019 02043000
*   K=K+1;                          /* STEP INDEX TO NEXT LINE       */ 02044000
         L     @03,K                                               1020 02045000
         ALR   @03,@04                                             1020 02046000
         ST    @03,K                                               1020 02047000
*   BUFPTR->PDRDESCL=BUFPTR->PDRDESCL+1;/* BUMP TOTAL LINE COUNT     */ 02048000
         AL    @04,PDRDESCL(,BUFPTR)                               1021 02049000
         ST    @04,PDRDESCL(,BUFPTR)                               1021 02050000
*   IF K>PDRDEMAX THEN              /* IF RECORD IS FULL             */ 02051000
         C     @03,@CF00142                                        1022 02052000
         BNH   @RF01022                                            1022 02053000
*     DO;                                                          1023 02054000
*       CALL WRITEIT;               /* FILL IT IN AND WRITE IT OUT   */ 02055000
         BAL   @14,WRITEIT                                         1024 02056000
*       RESPECIFY                                                  1025 02057000
*         RF RESTRICTED;                                           1025 02058000
*       RETC=RF;                    /* SAVE RETURN CODE              */ 02059000
         LR    RETC,RF                                             1026 02060000
*       RESPECIFY                                                  1027 02061000
*         RF UNRESTRICTED;                                         1027 02062000
*     END;                                                         1028 02063000
*   ELSE                                                           1029 02064000
*     ;                             /* RECORD NOT FULL               */ 02065000
@RF01022 DS    0H                                                  1030 02066000
*   RETURN CODE(RETC);              /* ALL IS OK                     */ 02067000
         LR    @15,RETC                                            1030 02068000
         L     @14,@SA00010                                        1030 02069000
         LM    @00,@01,@SA00010+8                                  1030 02070000
         LM    @03,@12,@SA00010+16                                 1030 02071000
         BR    @14                                                 1030 02072000
*   END STEPLINE;                   /* READY TO PROCESS NEXT LINE    */ 02073000
         EJECT                                                          02074000
*WRITEIT:                                                          1032 02075000
*   PROCEDURE;                                                     1032 02076000
WRITEIT  STM   @14,@12,@SA00011                                    1032 02077000
*   K=1;                            /* RESET LINE NUMBER             */ 02078000
         LA    @06,1                                               1033 02079000
         ST    @06,K                                               1033 02080000
*   IF RNUM<10000 THEN                                             1034 02081000
         L     @04,RNUM                                            1034 02082000
         C     @04,@CF01617                                        1034 02083000
         BNL   @RF01034                                            1034 02084000
*     DO;                                                          1035 02085000
*       CVD(RNUM,PACKED);           /* CONVERT RSEQUENCE NUMBER TO   */ 02086000
         CVD   @04,PACKED                                          1036 02087000
*       UNPK(PDRRECSQ,PACKED);      /* DECIMAL AND UNPACK IT         */ 02088000
         UNPK  PDRRECSQ(4,DESBUFP),PACKED(8)                       1037 02089000
*       PDRRECSQ(LENGTH(PDRRECSQ))=PDRRECSQ(LENGTH(PDRRECSQ))|'0';/*    02090000
*                                      CORRECT THE ZONE OF LAST DIGIT*/ 02091000
         OI    PDRRECSQ+3(DESBUFP),C'0'                            1038 02092000
*       RNUM=RNUM+1;                /* BUMP THE SEQUENCE NUMBER      */ 02093000
*                                                                  1039 02094000
         ALR   @04,@06                                             1039 02095000
         ST    @04,RNUM                                            1039 02096000
*       /*************************************************************/ 02097000
*       /*                                                           */ 02098000
*       /* BLSPUT (ZZ1PDRP)                                          */ 02099000
*       /* AREA(PDREC)RECLEN(LENGTH(PDREC)+PDRDEMAX*LENGTH(PDRDESC)) */ 02100000
*       /*                                                           */ 02101000
*       /*************************************************************/ 02102000
*                                                                  1040 02103000
*       DO;                         /* BLSPUT (ZZ1PDRP) AREA(PDREC)RE   02104000
*                                      CLEN(LENGTH(PDREC)+PDRDEMAX*LE   02105000
*                                      NGTH(PDRDESC))                */ 02106000
*         RFY                                                      1041 02107000
*           GPR01P RSTD;                                           1041 02108000
*         GPR01P=ZZ1PDRP;           /* ADDRESS DMCB                  */ 02109000
         L     @06,ZZ2ZZ1P(,ZZ2PTR)                                1042 02110000
         L     GPR01P,ZZ1PDRP(,@06)                                1042 02111000
*         RFY                                                      1043 02112000
*           DMCB BASED(GPR01P);                                    1043 02113000
*         IF((GPR01P&'FFFFFFF8'X)=GPR01P)&DMCBID='DMCB'/* VALID DMCB    02114000
*                                      ?                             */ 02115000
*           THEN                                                   1044 02116000
         LR    @06,GPR01P                                          1044 02117000
         N     @06,@CF01531                                        1044 02118000
         CLR   @06,GPR01P                                          1044 02119000
         BNE   @RF01044                                            1044 02120000
         CLC   DMCBID(4,GPR01P),@CC01532                           1044 02121000
         BNE   @RF01044                                            1044 02122000
*           DO;                                                    1045 02123000
*             DMCBBUFP=ADDR(PDREC); /* PLACE BUFFER ADDRESS IN DMCB  */ 02124000
         ST    DESBUFP,DMCBBUFP(,GPR01P)                           1046 02125000
*             DMCBORL=(LENGTH(PDREC)+PDRDEMAX*LENGTH(PDRDESC))&    1047 02126000
*                 '7FFFFFFF'X;      /* PLACE RECORD LENGTH IN DMCB   */ 02127000
         MVC   DMCBORL(4,GPR01P),@CF01643                          1047 02128000
*             DMCBRQST=DMCBPUR;     /* INDICATE PUT REQUEST          */ 02129000
         MVI   DMCBRQST(GPR01P),X'05'                              1048 02130000
*             CALL DMCBRI->DMCBDMGR;/* CALL BLSCRQST                 */ 02131000
         L     @15,DMCBRI(,GPR01P)                                 1049 02132000
         BALR  @14,@15                                             1049 02133000
*           END;                                                   1050 02134000
*         ELSE                                                     1051 02135000
*           DO;                                                    1051 02136000
         B     @RC01044                                            1051 02137000
@RF01044 DS    0H                                                  1052 02138000
*             RFY                                                  1052 02139000
*              (GPR00F,                                            1052 02140000
*               GPR15F) RSTD;                                      1052 02141000
*             GPR00F=0;             /* INDICATE NO MESSAGE CHAIN     */ 02142000
         SLR   GPR00F,GPR00F                                       1053 02143000
*             GPR15F=16;            /* INDICATE INVALID DMCB         */ 02144000
         LA    GPR15F,16                                           1054 02145000
*             RFY                                                  1055 02146000
*              (GPR00F,                                            1055 02147000
*               GPR15F);                                           1055 02148000
*           END;                                                   1056 02149000
*         RFY                                                      1057 02150000
*           DMCB;                                                  1057 02151000
@RC01044 DS    0H                                                  1058 02152000
*         RFY                                                      1058 02153000
*           GPR01P;                                                1058 02154000
*       END;                        /* BLSPUT (ZZ1PDRP) AREA(PDREC)RE   02155000
*                                      CLEN(LENGTH(PDREC)+PDRDEMAX*LE   02156000
*                                      NGTH(PDRDESC)) WRITE OUT THE     02157000
*                                      RECORD                        */ 02158000
*       RESPECIFY                                                  1060 02159000
*         RF RESTRICTED;                                           1060 02160000
*       IF RF^=0 THEN               /* IF RETURN CODE NOT ZERO       */ 02161000
         LTR   RF,RF                                               1061 02162000
         BZ    @RF01061                                            1061 02163000
*         DO;                                                      1062 02164000
*           IF RF=16 THEN           /* IF INVALID DMCB               */ 02165000
         C     RF,@CF00052                                         1063 02166000
         BNE   @RF01063                                            1063 02167000
*             DO;                   /* ABEND(200) DUMP               */ 02168000
*               RESPECIFY                                          1065 02169000
*                (GPR01F) RESTRICTED;                              1065 02170000
*               GPR01F=200;         /* COMP CODE IN REG 1            */ 02171000
         LA    GPR01F,200                                          1066 02172000
*               GPR01F=GPR01F|'80000000'X;/* DUMP/STEP/DUMPOPTS FLAG */ 02173000
         O     GPR01F,@CF00061                                     1067 02174000
*               SVC(13);            /* ISSUE ABEND SVC               */ 02175000
         SVC   13                                                  1068 02176000
*               RESPECIFY                                          1069 02177000
*                (GPR01F) UNRESTRICTED;                            1069 02178000
*             END;                  /* ABEND(200) DUMP QUIT RIGHT  1070 02179000
*                                      HERE                          */ 02180000
*           ELSE                                                   1071 02181000
*             ;                                                    1071 02182000
@RF01063 DS    0H                                                  1072 02183000
*           RETC=RF;                /* SAVE RETURN CODE              */ 02184000
         LR    RETC,RF                                             1072 02185000
*           RESPECIFY                                              1073 02186000
*             RF UNRESTRICTED;                                     1073 02187000
*           CALL MSG4(04044);       /* ERROR WRITING PROB DIRECTORY  */ 02188000
         LA    @01,@AL01074                                        1074 02189000
         BAL   @14,MSG4                                            1074 02190000
*         END;                                                     1075 02191000
*       ELSE                                                       1076 02192000
*         ;                         /* NO PROBLEM                    */ 02193000
@RF01061 DS    0H                                                  1077 02194000
*     END;                                                         1077 02195000
*   ELSE                                                           1078 02196000
*     CALL MSG4(04070);             /* RECORD NUMBER OVERFLOW        */ 02197000
         B     @RC01034                                            1078 02198000
@RF01034 LA    @01,@AL01078                                        1078 02199000
         BAL   @14,MSG4                                            1078 02200000
*   RETURN CODE(RETC);              /* ALL IS OK                     */ 02201000
@RC01034 LR    @15,RETC                                            1079 02202000
         L     @14,@SA00011                                        1079 02203000
         LM    @00,@12,@SA00011+8                                  1079 02204000
         BR    @14                                                 1079 02205000
*   END WRITEIT;                    /* READY TO PROCESS NEXT RECORD  */ 02206000
*   END DESLOCAL;                   /* ALL DONE                      */ 02207000
         EJECT                                                          02208000
*MSG4:                                                             1082 02209000
*   PROCEDURE(MSGNO);                                              1082 02210000
MSG4     STM   @14,@12,@SA00012                                    1082 02211000
         MVC   @PC00012(4),0(@01)                                  1082 02212000
*   DO;                             /* BLSDMSG                     1083 02213000
*                                      (ZZ2,MSGNO,DMCBMSG,BLSDMSGS)     02214000
*                                      ROUTE(BOTH)LIFO               */ 02215000
*     CALL BLSDMSG0(ZZ2,MSGNO,DMCBMSG,BLSDMSGS,'10110000'B,0);/*   1084 02216000
*                                      BUILD MESSAGE                 */ 02217000
         ST    ZZ2PTR,@AL00001                                     1084 02218000
         L     @06,@PC00012                                        1084 02219000
         ST    @06,@AL00001+4                                      1084 02220000
         L     @06,ZZ2ZZ1P(,ZZ2PTR)                                1084 02221000
         L     @06,ZZ1PDRP(,@06)                                   1084 02222000
         LA    @06,DMCBMSG(,@06)                                   1084 02223000
         ST    @06,@AL00001+8                                      1084 02224000
         L     @06,ZZ2MSGSP(,ZZ2PTR)                               1084 02225000
         ST    @06,@AL00001+12                                     1084 02226000
         LA    @06,@CB01589                                        1084 02227000
         ST    @06,@AL00001+16                                     1084 02228000
         LA    @06,@CF00046                                        1084 02229000
         ST    @06,@AL00001+20                                     1084 02230000
         L     @15,ZZ2MSG0P(,ZZ2PTR)                               1084 02231000
         LA    @01,@AL00001                                        1084 02232000
         BALR  @14,@15                                             1084 02233000
*   END;                            /* BLSDMSG                     1085 02234000
*                                      (ZZ2,MSGNO,DMCBMSG,BLSDMSGS)     02235000
*                                      ROUTE(BOTH)LIFO               */ 02236000
*   END MSG4;                                                      1086 02237000
*                                                                  1086 02238000
@EL00012 DS    0H                                                  1086 02239000
@EF00012 DS    0H                                                  1086 02240000
@ER00012 LM    @14,@12,@SA00012                                    1086 02241000
         BR    @14                                                 1086 02242000
*/********************************************************************/ 02243000
*/*                                                                  */ 02244000
*/* COMMAND PROCESSOR CODE ENDS                                      */ 02245000
*/*                                                                  */ 02246000
*/********************************************************************/ 02247000
*                                                                  1087 02248000
         EJECT                                                          02249000
*                                                                  1087 02250000
*/*BLSUPEND--MVS IPCS MODULE                                         */ 02251000
*                                                                  1087 02252000
*   DECLARE                         /* GENERAL PURPOSE REGISTERS     */ 02253000
*     GPR00F FIXED(31) REG(0),                                     1087 02254000
*     GPR01F FIXED(31) REG(1),                                     1087 02255000
*     GPR15F FIXED(31) REG(15),                                    1087 02256000
*     GPR01P PTR(31) REG(1);                                       1087 02257000
*   DECLARE                         /* COMMON VARIABLES              */ 02258000
*     I256C CHAR(256) BASED,                                       1088 02259000
*     I031F FIXED(31) BASED,                                       1088 02260000
*     I031P PTR(31) BASED,                                         1088 02261000
*     I015F FIXED(15) BASED,                                       1088 02262000
*     I015P PTR(15) BASED,                                         1088 02263000
*     I008P PTR(8) BASED,                                          1088 02264000
*     I001C CHAR(1) BASED;                                         1088 02265000
*   DECLARE                                                        1089 02266000
*     IOPTLIST(6) PTR(31) BDY(WORD);/* OPTION LIST ARRAY             */ 02267000
*   GENERATE NODEFS NOREFS DATA;                                   1090 02268000
*   END                             /* BLRPEND                       */ 02269000
*                                                                  1091 02270000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 02271000
*/*%INCLUDE SYSLIB  (BLSUZZZ )                                       */ 02272000
*/*%INCLUDE SYSLIB  (BLRFULL )                                       */ 02273000
*/*%INCLUDE SYSLIB  (IKJCPPL )                                       */ 02274000
*/*%INCLUDE SYSLIB  (IKJPSCB )                                       */ 02275000
*/*%INCLUDE SYSLIB  (IKJECT  )                                       */ 02276000
*/*%INCLUDE SYSLIB  (IKJUPT  )                                       */ 02277000
*/*%INCLUDE SYSLIB  (BLSUSERV)                                       */ 02278000
*/*%INCLUDE SYSLIB  (BLRSERV )                                       */ 02279000
*/*%INCLUDE SYSLIB  (BLRSERVD)                                       */ 02280000
*/*%INCLUDE SYSLIB  (BLSDSERV)                                       */ 02281000
*/*%INCLUDE SYSLIB  (BLSEMP  )                                       */ 02282000
*/*%INCLUDE SYSLIB  (BLSPDR  )                                       */ 02283000
*/*%INCLUDE SYSLIB  (BLSFP   )                                       */ 02284000
*/*%INCLUDE SYSLIB  (BLSESTAT)                                       */ 02285000
*                                                                  1091 02286000
*       ;                                                          1091 02287000
@EL00001 L     @13,4(,@13)                                         1091 02288000
@EF00001 L     @00,@SIZDATD                                        1091 02289000
         LR    @01,@11                                             1091 02290000
         BLSUFRER R,LV=(0),A=(1)                                        02291000
@ER00001 LM    @14,@12,12(@13)                                     1091 02292000
         BR    @14                                                 1091 02293000
@DATA    DS    0H                                                       02294000
@CH00068 DC    H'2'                                                     02295000
@CH00094 DC    H'3'                                                     02296000
@CH00091 DC    H'5'                                                     02297000
@SM01651 MVC   PDRKPID-1(0,@09),PIDI(@01)                               02298000
@SM01655 MVC   PDRODATE(0,BUFPTR),DTEI(@04)                             02299000
@SM01657 MVC   PDROTIME(0,BUFPTR),TMEI(@04)                             02300000
@SM01659 MVC   PDRGROUP(0,BUFPTR),GRPI(@04)                             02301000
@SM01661 MVC   PDRSYS(0,BUFPTR),SIDI(@04)                               02302000
@SM01663 MVC   PDRCOMP(0,BUFPTR),CIDI(@04)                              02303000
@SM01665 MVC   PDROWNID(0,BUFPTR),OWNI(@03)                             02304000
@SM01667 MVC   PDRUSER(0,BUFPTR),UFLI(@04)                              02305000
@SM01669 MVC   PDRAPRID(0,BUFPTR),APRI(@04)                             02306000
@SM01671 MVC   PDRPTFID(0,BUFPTR),PTFI(@04)                             02307000
@SM01673 MVC   PDRFIXID(0,BUFPTR),FIXQ(@04)                             02308000
@SM01675 MVC   PDRABS(0,BUFPTR),ABSQ(@04)                               02309000
         DS    0F                                                       02310000
@AL00399 DC    A(@CF01525)             LIST WITH   1 ARGUMENT(S)        02311000
@AL00458 DC    A(@CF01537)             LIST WITH   1 ARGUMENT(S)        02312000
@AL00468 DC    A(@CF01539)             LIST WITH   1 ARGUMENT(S)        02313000
@AL00531 EQU   *                       LIST WITH   1 ARGUMENT(S)        02314000
@AL00618 DC    A(@CF01549)             LIST WITH   1 ARGUMENT(S)        02315000
@AL00572 DC    A(@CF01556)             LIST WITH   1 ARGUMENT(S)        02316000
@AL00666 EQU   *                       LIST WITH   1 ARGUMENT(S)        02317000
@AL00911 EQU   *                       LIST WITH   1 ARGUMENT(S)        02318000
@AL01001 EQU   *                       LIST WITH   1 ARGUMENT(S)        02319000
@AL01074 DC    A(@CF01573)             LIST WITH   1 ARGUMENT(S)        02320000
@AL00733 DC    A(@CF01590)             LIST WITH   1 ARGUMENT(S)        02321000
@AL01005 EQU   *                       LIST WITH   1 ARGUMENT(S)        02322000
@AL01078 DC    A(@CF01619)             LIST WITH   1 ARGUMENT(S)        02323000
@DATD    DSECT                                                          02324000
         DS    0F                                                       02325000
@SA00001 DS    18F                                                      02326000
@SA00012 DS    15F                                                      02327000
@PC00012 DS    1F                                                       02328000
@SA00002 DS    14F                                                      02329000
@SA00003 DS    14F                                                      02330000
@SA00004 DS    14F                                                      02331000
@SA00007 DS    14F                                                      02332000
@PC00007 DS    1F                                                       02333000
@SA00005 DS    14F                                                      02334000
@SA00006 DS    14F                                                      02335000
@SA00008 DS    14F                                                      02336000
@SA00009 DS    15F                                                      02337000
@SA00010 DS    14F                                                      02338000
@SA00011 DS    15F                                                      02339000
@AL00001 DS    6A                                                       02340000
@TF00001 DS    F                                                        02341000
@AFTEMPS DS    2F                                                       02342000
BLSEMDPR CSECT                                                          02343000
         DS    0F                                                       02344000
@CF00046 DC    F'0'                                                     02345000
@CF00041 DC    F'1'                                                     02346000
@CH00041 EQU   @CF00041+2                                               02347000
@CF00049 DC    F'8'                                                     02348000
@CF01019 DC    F'9'                                                     02349000
@CF00142 DC    F'13'                                                    02350000
@CF01037 DC    F'14'                                                    02351000
@CF00052 DC    F'16'                                                    02352000
@CF01256 DC    F'72'                                                    02353000
@CH01256 EQU   @CF01256+2                                               02354000
@CF01640 DC    F'416'                                                   02355000
@CF01643 DC    F'952'                                                   02356000
@CF00394 DC    F'1024'                                                  02357000
@CF01588 DC    F'4000'                                                  02358000
@CF01525 DC    F'4003'                                                  02359000
@CF01602 DC    F'4004'                                                  02360000
@CF01549 DC    F'4041'                                                  02361000
@CF01537 DC    F'4042'                                                  02362000
@CF01590 DC    F'4043'                                                  02363000
@CF01573 DC    F'4044'                                                  02364000
@CF01556 DC    F'4045'                                                  02365000
@CF01539 DC    F'4069'                                                  02366000
@CF01619 DC    F'4070'                                                  02367000
@CF01617 DC    F'10000'                                                 02368000
@CF01677 DC    F'-57'                                                   02369000
@CF01580 DC    F'-1'                                                    02370000
@CF00061 DC    XL4'80000000'                                            02371000
@CF01531 DC    XL4'FFFFFFF8'                                            02372000
@CF01548 DC    XL4'7FFFFFFF'                                            02373000
@DATD    DSECT                                                          02374000
         DS    0D                                                       02375000
PDAPTR   DS    A                                                        02376000
J        DS    A                                                        02377000
K        DS    A                                                        02378000
L        DS    A                                                        02379000
RNUM     DS    F                                                        02380000
CURDATE  DS    CL8                                                      02381000
CURTIME  DS    CL8                                                      02382000
         DS    CL4                                                      02383000
PACKED   DS    CL8                                                      02384000
BUF1     DS    CL1024                                                   02385000
BUF2     DS    CL1024                                                   02386000
IOPTLIST DS    6A                                                       02387000
BLSEMDPR CSECT                                                          02388000
         DS    0F                                                       02389000
@SIZDATD DC    AL1(0)                                                   02390000
         DC    AL3(@ENDDATD-@DATD)                                      02391000
@CV01369 DC    V(BLSDTIME)                                              02392000
@CV01370 DC    V(BLSEMDP1)                                              02393000
         DS    0D                                                       02394000
PCPTR    DC    AL4(PC)                                                  02395000
@CC00104 DC    C'000     '                                              02396000
@CC01526 DC    C'00000000'                                              02397000
@CC01532 DC    C'DMCB'                                                  02398000
@CC01560 EQU   @CC01526                                                 02399000
@CC01273 DC    C'ST'                                                    02400000
@CC01275 DC    C'DE'                                                    02401000
@CC01527 DC    C'E'                                                     02402000
@CC01594 DC    C'O'                                                     02403000
@CB01653 DC    X'00'                                                    02404000
@CB01581 DC    B'00000000'                                              02405000
@CB01589 DC    B'10110000'                                              02406000
STATPROB DC    CL8'ACTIVE  '                                            02407000
         DC    CL8'CLAPAR  '                                            02408000
         DC    CL8'CLDUP   '                                            02409000
         DC    CL8'CLFIX   '                                            02410000
         DC    CL8'CLNTF   '                                            02411000
         DC    CL8'CLOTHER '                                            02412000
         DC    CL8'CLPTF   '                                            02413000
         DC    CL8'INACTIVE'                                            02414000
         DC    CL8'INITIAL '                                            02415000
STATIBM  DC    CL8'        '                                            02416000
         DC    CL8'ABY     '                                            02417000
         DC    CL8'ACK     '                                            02418000
         DC    CL8'APARED  '                                            02419000
         DC    CL8'CAN     '                                            02420000
         DC    CL8'DOC     '                                            02421000
         DC    CL8'DUA     '                                            02422000
         DC    CL8'DUB     '                                            02423000
         DC    CL8'DUU     '                                            02424000
         DC    CL8'MCH     '                                            02425000
         DC    CL8'PER     '                                            02426000
         DC    CL8'PRS     '                                            02427000
         DC    CL8'PSRR    '                                            02428000
         DC    CL8'REPORTED'                                            02429000
         DC    CL8'RET     '                                            02430000
         DC    CL8'ROP     '                                            02431000
         DC    CL8'SUG     '                                            02432000
         DC    CL8'UR1     '                                            02433000
         DC    CL8'UR2     '                                            02434000
         DC    CL8'UR3     '                                            02435000
         DC    CL8'UR4     '                                            02436000
         DC    CL8'UR5     '                                            02437000
         DC    CL8'USE     '                                            02438000
STATPTF  DC    CL4'    '                                                02439000
         DC    CL4'ACPT'                                                02440000
         DC    CL4'INST'                                                02441000
         DC    CL4'RCVD'                                                02442000
         DC    CL4'REJD'                                                02443000
         DC    CL4'RQST'                                                02444000
STATFIX  DC    CL4'    '                                                02445000
         DC    CL4'ACPT'                                                02446000
         DC    CL4'INST'                                                02447000
         DC    CL4'RCVD'                                                02448000
         DC    CL4'REJD'                                                02449000
         DC    CL4'RQST'                                                02450000
@DATD    DSECT                                                          02451000
         SPACE 2                                                        02452000
*********************************************************************** 02453000
* THE FOLLOWING AREA, BLRPATCH, IS RESERVED FOR PATCH APPLICATION     * 02454000
* TO OBTAIN PATCH ROOM IN THE @DATD AUTOMATIC STORAGE AREA, MODIFY    * 02455000
* CONSTANT @SIZDATD TO REFLECT THE DESIRED @DATD SIZE                 * 02456000
*********************************************************************** 02457000
         SPACE                                                          02458000
BLSEMDPR CSECT                                                          02459000
         ORG                                                            02460000
         DS    0D                                                       02461000
BLRPATCH DC    CL8'ZAPAREA',(((*-BLSEMDPR+19)/20+7)/8)CL8'BLSEMDPR'     02462000
@DATD    DSECT                                                          02463000
         SPACE 2                                                        02464000
*********************************************************************** 02465000
* IKJPARM--BEGIN MACROS SPECIFYING COMMAND SYNTAX                     * 02466000
*********************************************************************** 02467000
         SPACE                                                          02468000
BLSEMDPR CSECT                                                          02469000
PC       IKJPARM DSECT=PD                                               02470000
@DATD    DSECT                                                          02471000
BLSEMDPR CSECT                                                          02472000
PROBWD   IKJKEYWD                                                       02473000
@DATD    DSECT                                                          02474000
BLSEMDPR CSECT                                                          02475000
         IKJNAME 'PROBLEM',SUBFLD=PROBSUB                               02476000
@DATD    DSECT                                                          02477000
BLSEMDPR CSECT                                                          02478000
DATEWD   IKJKEYWD                                                       02479000
@DATD    DSECT                                                          02480000
BLSEMDPR CSECT                                                          02481000
         IKJNAME 'DATE',SUBFLD=DATESUB                                  02482000
@DATD    DSECT                                                          02483000
BLSEMDPR CSECT                                                          02484000
TIMEWD   IKJKEYWD                                                       02485000
@DATD    DSECT                                                          02486000
BLSEMDPR CSECT                                                          02487000
         IKJNAME 'TIME',SUBFLD=TIMESUB                                  02488000
@DATD    DSECT                                                          02489000
BLSEMDPR CSECT                                                          02490000
GROUPWD  IKJKEYWD                                                       02491000
@DATD    DSECT                                                          02492000
BLSEMDPR CSECT                                                          02493000
         IKJNAME 'GROUP',SUBFLD=GRPSUB                                  02494000
@DATD    DSECT                                                          02495000
BLSEMDPR CSECT                                                          02496000
SYSTEMWD IKJKEYWD                                                       02497000
@DATD    DSECT                                                          02498000
BLSEMDPR CSECT                                                          02499000
         IKJNAME 'SYSTEM',SUBFLD=SIDSUB                                 02500000
@DATD    DSECT                                                          02501000
BLSEMDPR CSECT                                                          02502000
USERWD   IKJKEYWD                                                       02503000
@DATD    DSECT                                                          02504000
BLSEMDPR CSECT                                                          02505000
         IKJNAME 'USER',SUBFLD=USESUB                                   02506000
@DATD    DSECT                                                          02507000
BLSEMDPR CSECT                                                          02508000
COMPIDWD IKJKEYWD                                                       02509000
@DATD    DSECT                                                          02510000
BLSEMDPR CSECT                                                          02511000
         IKJNAME 'COMPID',SUBFLD=CIDSUB                                 02512000
@DATD    DSECT                                                          02513000
BLSEMDPR CSECT                                                          02514000
OWNERWD  IKJKEYWD                                                       02515000
@DATD    DSECT                                                          02516000
BLSEMDPR CSECT                                                          02517000
         IKJNAME 'OWNER',SUBFLD=OWNSUB                                  02518000
@DATD    DSECT                                                          02519000
BLSEMDPR CSECT                                                          02520000
SEVWD    IKJKEYWD                                                       02521000
@DATD    DSECT                                                          02522000
BLSEMDPR CSECT                                                          02523000
         IKJNAME 'SEVERITY',SUBFLD=SEVSUB                               02524000
@DATD    DSECT                                                          02525000
BLSEMDPR CSECT                                                          02526000
PSTATWD  IKJKEYWD                                                       02527000
@DATD    DSECT                                                          02528000
BLSEMDPR CSECT                                                          02529000
         IKJNAME 'PSTATUS',SUBFLD=PSTATSUB                              02530000
@DATD    DSECT                                                          02531000
BLSEMDPR CSECT                                                          02532000
IBMSTWD  IKJKEYWD                                                       02533000
@DATD    DSECT                                                          02534000
BLSEMDPR CSECT                                                          02535000
         IKJNAME 'IBMSTATUS',SUBFLD=IBMSTSUB                            02536000
@DATD    DSECT                                                          02537000
BLSEMDPR CSECT                                                          02538000
PTFSTWD  IKJKEYWD                                                       02539000
@DATD    DSECT                                                          02540000
BLSEMDPR CSECT                                                          02541000
         IKJNAME 'PTFSTATUS',SUBFLD=PTFSTSUB                            02542000
@DATD    DSECT                                                          02543000
BLSEMDPR CSECT                                                          02544000
FIXSTWD  IKJKEYWD                                                       02545000
@DATD    DSECT                                                          02546000
BLSEMDPR CSECT                                                          02547000
         IKJNAME 'FIXSTATUS',SUBFLD=FIXSTSUB                            02548000
@DATD    DSECT                                                          02549000
BLSEMDPR CSECT                                                          02550000
APARWD   IKJKEYWD                                                       02551000
@DATD    DSECT                                                          02552000
BLSEMDPR CSECT                                                          02553000
         IKJNAME 'APARID',SUBFLD=APARSUB                                02554000
@DATD    DSECT                                                          02555000
BLSEMDPR CSECT                                                          02556000
PTFIDWD  IKJKEYWD                                                       02557000
@DATD    DSECT                                                          02558000
BLSEMDPR CSECT                                                          02559000
         IKJNAME 'PTFID',SUBFLD=PTFSUB                                  02560000
@DATD    DSECT                                                          02561000
BLSEMDPR CSECT                                                          02562000
FIXWD    IKJKEYWD                                                       02563000
@DATD    DSECT                                                          02564000
BLSEMDPR CSECT                                                          02565000
         IKJNAME 'FIXID',SUBFLD=FIXSUB                                  02566000
@DATD    DSECT                                                          02567000
BLSEMDPR CSECT                                                          02568000
ABSWD    IKJKEYWD                                                       02569000
@DATD    DSECT                                                          02570000
BLSEMDPR CSECT                                                          02571000
         IKJNAME 'ABSTRACT',SUBFLD=ABSSUB                               02572000
@DATD    DSECT                                                          02573000
BLSEMDPR CSECT                                                          02574000
DESCWD   IKJKEYWD                                                       02575000
@DATD    DSECT                                                          02576000
BLSEMDPR CSECT                                                          02577000
         IKJNAME 'DESCRIPTION',SUBFLD=DESCSUB                           02578000
@DATD    DSECT                                                          02579000
BLSEMDPR CSECT                                                          02580000
         IKJNAME 'DSDESCRIPTION',SUBFLD=DSDSUB                          02581000
@DATD    DSECT                                                          02582000
BLSEMDPR CSECT                                                          02583000
DFTWD    IKJKEYWD                                                       02584000
@DATD    DSECT                                                          02585000
BLSEMDPR CSECT                                                          02586000
         IKJNAME 'DEFAULT'                                              02587000
@DATD    DSECT                                                          02588000
BLSEMDPR CSECT                                                          02589000
PXTEST   IKJKEYWD                                                       02590000
@DATD    DSECT                                                          02591000
BLSEMDPR CSECT                                                          02592000
         IKJNAME 'TEST'                                                 02593000
@DATD    DSECT                                                          02594000
BLSEMDPR CSECT                                                          02595000
         IKJNAME 'NOTEST'                                               02596000
@DATD    DSECT                                                          02597000
BLSEMDPR CSECT                                                          02598000
         SPACE                                                          02599000
PROBSUB  IKJSUBF                                                        02600000
@DATD    DSECT                                                          02601000
BLSEMDPR CSECT                                                          02602000
PID      IKJIDENT 'PROBLEM',UPPERCASE,FIRST=NUMERIC,MAXLNTH=5,OTHER=NUM*02603000
               ERIC,PROMPT='PROBLEM NUMBER'                             02604000
@DATD    DSECT                                                          02605000
BLSEMDPR CSECT                                                          02606000
         SPACE                                                          02607000
DATESUB  IKJSUBF                                                        02608000
@DATD    DSECT                                                          02609000
BLSEMDPR CSECT                                                          02610000
DTE      IKJIDENT 'DATE',UPPERCASE,FIRST=NUMERIC,MAXLNTH=8,OTHER=ANY,  *02611000
               PROMPT='DATE OCCURRED - MM/DD/YY',VALIDCK=BLSDDT00       02612000
@DATD    DSECT                                                          02613000
BLSEMDPR CSECT                                                          02614000
         SPACE                                                          02615000
TIMESUB  IKJSUBF                                                        02616000
@DATD    DSECT                                                          02617000
BLSEMDPR CSECT                                                          02618000
TME      IKJIDENT 'TIME',UPPERCASE,FIRST=NUMERIC,MAXLNTH=8,OTHER=ANY,  *02619000
               PROMPT='TIME OCCURRED - HH:MM:SS',VALIDCK=BLSDTM00       02620000
@DATD    DSECT                                                          02621000
BLSEMDPR CSECT                                                          02622000
         SPACE                                                          02623000
GRPSUB   IKJSUBF                                                        02624000
@DATD    DSECT                                                          02625000
BLSEMDPR CSECT                                                          02626000
GRP      IKJIDENT 'GROUP',UPPERCASE,FIRST=ALPHANUM,MAXLNTH=8,OTHER=ALPH*02627000
               ANUM,PROMPT='GROUP ASSIGNED TO THIS PROBLEM'             02628000
@DATD    DSECT                                                          02629000
BLSEMDPR CSECT                                                          02630000
         SPACE                                                          02631000
SIDSUB   IKJSUBF                                                        02632000
@DATD    DSECT                                                          02633000
BLSEMDPR CSECT                                                          02634000
SID      IKJIDENT 'SYSTEM ID',UPPERCASE,FIRST=ALPHANUM,MAXLNTH=8,OTHER=*02635000
               ALPHANUM,PROMPT='SYSTEM ID'                              02636000
@DATD    DSECT                                                          02637000
BLSEMDPR CSECT                                                          02638000
         SPACE                                                          02639000
USESUB   IKJSUBF                                                        02640000
@DATD    DSECT                                                          02641000
BLSEMDPR CSECT                                                          02642000
UFL      IKJIDENT 'USER FIELD',UPPERCASE,FIRST=ALPHANUM,MAXLNTH=8,     *02643000
               OTHER=ALPHANUM,PROMPT='USER FIELD'                       02644000
@DATD    DSECT                                                          02645000
BLSEMDPR CSECT                                                          02646000
         SPACE                                                          02647000
CIDSUB   IKJSUBF                                                        02648000
@DATD    DSECT                                                          02649000
BLSEMDPR CSECT                                                          02650000
CID      IKJIDENT 'COMPONENT ID',UPPERCASE,FIRST=ANY,MAXLNTH=10,OTHER=A*02651000
               NY,PROMPT='SUSPECTED FAILING COMPONENT ID'               02652000
@DATD    DSECT                                                          02653000
BLSEMDPR CSECT                                                          02654000
         SPACE                                                          02655000
OWNSUB   IKJSUBF                                                        02656000
@DATD    DSECT                                                          02657000
BLSEMDPR CSECT                                                          02658000
OWN      IKJIDENT 'OWNER',UPPERCASE,FIRST=ALPHA,MAXLNTH=7,OTHER=ALPHANU*02659000
               M,PROMPT='OWNER OF THE PROBLEM'                          02660000
@DATD    DSECT                                                          02661000
BLSEMDPR CSECT                                                          02662000
         SPACE                                                          02663000
SEVSUB   IKJSUBF                                                        02664000
@DATD    DSECT                                                          02665000
BLSEMDPR CSECT                                                          02666000
SEV      IKJIDENT 'SEVERITY',UPPERCASE,FIRST=NUMERIC,MAXLNTH=1,PROMPT='*02667000
               SEVERITY ASSOCIATED WITH THIS PROBLEM',VALIDCK=BLSDSV00  02668000
@DATD    DSECT                                                          02669000
BLSEMDPR CSECT                                                          02670000
         SPACE                                                          02671000
PSTATSUB IKJSUBF                                                        02672000
@DATD    DSECT                                                          02673000
BLSEMDPR CSECT                                                          02674000
PSTTYPE  IKJKEYWD                                                       02675000
@DATD    DSECT                                                          02676000
BLSEMDPR CSECT                                                          02677000
         IKJNAME 'ACTIVE'                                               02678000
@DATD    DSECT                                                          02679000
BLSEMDPR CSECT                                                          02680000
         IKJNAME 'CLAPAR'                                               02681000
@DATD    DSECT                                                          02682000
BLSEMDPR CSECT                                                          02683000
         IKJNAME 'CLDUP'                                                02684000
@DATD    DSECT                                                          02685000
BLSEMDPR CSECT                                                          02686000
         IKJNAME 'CLFIX'                                                02687000
@DATD    DSECT                                                          02688000
BLSEMDPR CSECT                                                          02689000
         IKJNAME 'CLNTF'                                                02690000
@DATD    DSECT                                                          02691000
BLSEMDPR CSECT                                                          02692000
         IKJNAME 'CLOTHER'                                              02693000
@DATD    DSECT                                                          02694000
BLSEMDPR CSECT                                                          02695000
         IKJNAME 'CLPTF'                                                02696000
@DATD    DSECT                                                          02697000
BLSEMDPR CSECT                                                          02698000
         IKJNAME 'INACTIVE'                                             02699000
@DATD    DSECT                                                          02700000
BLSEMDPR CSECT                                                          02701000
         IKJNAME 'INITIAL'                                              02702000
@DATD    DSECT                                                          02703000
BLSEMDPR CSECT                                                          02704000
         SPACE                                                          02705000
IBMSTSUB IKJSUBF                                                        02706000
@DATD    DSECT                                                          02707000
BLSEMDPR CSECT                                                          02708000
IBMFLDWD IKJKEYWD                                                       02709000
@DATD    DSECT                                                          02710000
BLSEMDPR CSECT                                                          02711000
         IKJNAME 'NONE'                                                 02712000
@DATD    DSECT                                                          02713000
BLSEMDPR CSECT                                                          02714000
         IKJNAME 'ABY'                                                  02715000
@DATD    DSECT                                                          02716000
BLSEMDPR CSECT                                                          02717000
         IKJNAME 'ACK'                                                  02718000
@DATD    DSECT                                                          02719000
BLSEMDPR CSECT                                                          02720000
         IKJNAME 'APARED'                                               02721000
@DATD    DSECT                                                          02722000
BLSEMDPR CSECT                                                          02723000
         IKJNAME 'CAN'                                                  02724000
@DATD    DSECT                                                          02725000
BLSEMDPR CSECT                                                          02726000
         IKJNAME 'DOC'                                                  02727000
@DATD    DSECT                                                          02728000
BLSEMDPR CSECT                                                          02729000
         IKJNAME 'DUA'                                                  02730000
@DATD    DSECT                                                          02731000
BLSEMDPR CSECT                                                          02732000
         IKJNAME 'DUB'                                                  02733000
@DATD    DSECT                                                          02734000
BLSEMDPR CSECT                                                          02735000
         IKJNAME 'DUU'                                                  02736000
@DATD    DSECT                                                          02737000
BLSEMDPR CSECT                                                          02738000
         IKJNAME 'MCH'                                                  02739000
@DATD    DSECT                                                          02740000
BLSEMDPR CSECT                                                          02741000
         IKJNAME 'PER'                                                  02742000
@DATD    DSECT                                                          02743000
BLSEMDPR CSECT                                                          02744000
         IKJNAME 'PRS'                                                  02745000
@DATD    DSECT                                                          02746000
BLSEMDPR CSECT                                                          02747000
         IKJNAME 'PSRR'                                                 02748000
@DATD    DSECT                                                          02749000
BLSEMDPR CSECT                                                          02750000
         IKJNAME 'REPORTED'                                             02751000
@DATD    DSECT                                                          02752000
BLSEMDPR CSECT                                                          02753000
         IKJNAME 'RET'                                                  02754000
@DATD    DSECT                                                          02755000
BLSEMDPR CSECT                                                          02756000
         IKJNAME 'ROP'                                                  02757000
@DATD    DSECT                                                          02758000
BLSEMDPR CSECT                                                          02759000
         IKJNAME 'SUG'                                                  02760000
@DATD    DSECT                                                          02761000
BLSEMDPR CSECT                                                          02762000
         IKJNAME 'UR1'                                                  02763000
@DATD    DSECT                                                          02764000
BLSEMDPR CSECT                                                          02765000
         IKJNAME 'UR2'                                                  02766000
@DATD    DSECT                                                          02767000
BLSEMDPR CSECT                                                          02768000
         IKJNAME 'UR3'                                                  02769000
@DATD    DSECT                                                          02770000
BLSEMDPR CSECT                                                          02771000
         IKJNAME 'UR4'                                                  02772000
@DATD    DSECT                                                          02773000
BLSEMDPR CSECT                                                          02774000
         IKJNAME 'UR5'                                                  02775000
@DATD    DSECT                                                          02776000
BLSEMDPR CSECT                                                          02777000
         IKJNAME 'USE'                                                  02778000
@DATD    DSECT                                                          02779000
BLSEMDPR CSECT                                                          02780000
         SPACE                                                          02781000
PTFSTSUB IKJSUBF                                                        02782000
@DATD    DSECT                                                          02783000
BLSEMDPR CSECT                                                          02784000
PTFFLDWD IKJKEYWD                                                       02785000
@DATD    DSECT                                                          02786000
BLSEMDPR CSECT                                                          02787000
         IKJNAME 'NONE'                                                 02788000
@DATD    DSECT                                                          02789000
BLSEMDPR CSECT                                                          02790000
         IKJNAME 'ACPT'                                                 02791000
@DATD    DSECT                                                          02792000
BLSEMDPR CSECT                                                          02793000
         IKJNAME 'INST'                                                 02794000
@DATD    DSECT                                                          02795000
BLSEMDPR CSECT                                                          02796000
         IKJNAME 'RCVD'                                                 02797000
@DATD    DSECT                                                          02798000
BLSEMDPR CSECT                                                          02799000
         IKJNAME 'REJD'                                                 02800000
@DATD    DSECT                                                          02801000
BLSEMDPR CSECT                                                          02802000
         IKJNAME 'RQST'                                                 02803000
@DATD    DSECT                                                          02804000
BLSEMDPR CSECT                                                          02805000
         SPACE                                                          02806000
FIXSTSUB IKJSUBF                                                        02807000
@DATD    DSECT                                                          02808000
BLSEMDPR CSECT                                                          02809000
FIXFLDWD IKJKEYWD                                                       02810000
@DATD    DSECT                                                          02811000
BLSEMDPR CSECT                                                          02812000
         IKJNAME 'NONE'                                                 02813000
@DATD    DSECT                                                          02814000
BLSEMDPR CSECT                                                          02815000
         IKJNAME 'ACPT'                                                 02816000
@DATD    DSECT                                                          02817000
BLSEMDPR CSECT                                                          02818000
         IKJNAME 'INST'                                                 02819000
@DATD    DSECT                                                          02820000
BLSEMDPR CSECT                                                          02821000
         IKJNAME 'RCVD'                                                 02822000
@DATD    DSECT                                                          02823000
BLSEMDPR CSECT                                                          02824000
         IKJNAME 'REJD'                                                 02825000
@DATD    DSECT                                                          02826000
BLSEMDPR CSECT                                                          02827000
         IKJNAME 'RQST'                                                 02828000
@DATD    DSECT                                                          02829000
BLSEMDPR CSECT                                                          02830000
         SPACE                                                          02831000
APARSUB  IKJSUBF                                                        02832000
@DATD    DSECT                                                          02833000
BLSEMDPR CSECT                                                          02834000
APR      IKJIDENT 'APAR',UPPERCASE,FIRST=ALPHA,MAXLNTH=7,OTHER=NONATNUM*02835000
               ,PROMPT='APAR IDENTIFIER ASSIGNED TO THIS PROBLEM',     *02836000
               VALIDCK=BLSDC070                                         02837000
@DATD    DSECT                                                          02838000
BLSEMDPR CSECT                                                          02839000
         SPACE                                                          02840000
PTFSUB   IKJSUBF                                                        02841000
@DATD    DSECT                                                          02842000
BLSEMDPR CSECT                                                          02843000
PTF      IKJIDENT 'PTF',UPPERCASE,FIRST=ALPHA,MAXLNTH=7,OTHER=NONATNUM,*02844000
               PROMPT='PTF IDENTIFIER ASSIGNED TO THIS PROBLEM',       *02845000
               VALIDCK=BLSDC070                                         02846000
@DATD    DSECT                                                          02847000
BLSEMDPR CSECT                                                          02848000
         SPACE                                                          02849000
FIXSUB   IKJSUBF                                                        02850000
@DATD    DSECT                                                          02851000
BLSEMDPR CSECT                                                          02852000
FIX      IKJPOSIT QSTRING,UPPERCASE,PROMPT='FIX IDENTIFIER ASSIGNED TO *02853000
               THIS PROBLEM',VALIDCK=BLSDC600                           02854000
@DATD    DSECT                                                          02855000
BLSEMDPR CSECT                                                          02856000
         SPACE                                                          02857000
ABSSUB   IKJSUBF                                                        02858000
@DATD    DSECT                                                          02859000
BLSEMDPR CSECT                                                          02860000
ABS      IKJPOSIT QSTRING,UPPERCASE,HELP=('MAXIMUM 128 CHARACTERS AS QU*02861000
               OTED TEXT'),PROMPT='ABSTRACT TEXT-128 CHARACTERS MAXIMUM*02862000
               ',VALIDCK=BLSDC128                                       02863000
@DATD    DSECT                                                          02864000
BLSEMDPR CSECT                                                          02865000
         SPACE                                                          02866000
DESCSUB  IKJSUBF                                                        02867000
@DATD    DSECT                                                          02868000
BLSEMDPR CSECT                                                          02869000
DSC      IKJPOSIT QSTRING,UPPERCASE,HELP=('ENTERED AS QUOTED TEXT'),   *02870000
               PROMPT='DESCRIPTION TEXT'                                02871000
@DATD    DSECT                                                          02872000
BLSEMDPR CSECT                                                          02873000
         SPACE                                                          02874000
DSDSUB   IKJSUBF                                                        02875000
@DATD    DSECT                                                          02876000
BLSEMDPR CSECT                                                          02877000
DDS      IKJPOSIT DSNAME,USID,UPPERCASE,PROMPT='DATA SET NAME CONTAININ*02878000
               G DESCRIPTION'                                           02879000
@DATD    DSECT                                                          02880000
PD       DSECT                                                          02881000
LISTEND  DS    0C                                                       02882000
BLSEMDPR CSECT                                                          02883000
         IKJENDP                                                        02884000
         SPACE 2                                                        02885000
*********************************************************************** 02886000
* IKJENDP--END SYNTAX DESCRIPTION                                     * 02887000
*********************************************************************** 02888000
         SPACE                                                          02889000
@DATD    DSECT                                                          02890000
         SPACE 2                                                        02891000
*********************************************************************** 02892000
* ALIGN END OF DATA ON A DOUBLEWORD BOUNDARY                          * 02893000
*********************************************************************** 02894000
         SPACE                                                          02895000
         DS    0D                                                       02896000
@DATD    DSECT                                                          02897000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                02898000
@ENDDATD EQU   *                                                        02899000
BLSEMDPR CSECT                                                          02900000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       02901000
@01      EQU   01                                                       02902000
@02      EQU   02                                                       02903000
@03      EQU   03                                                       02904000
@04      EQU   04                                                       02905000
@05      EQU   05                                                       02906000
@06      EQU   06                                                       02907000
@07      EQU   07                                                       02908000
@08      EQU   08                                                       02909000
@09      EQU   09                                                       02910000
@10      EQU   10                                                       02911000
@11      EQU   11                                                       02912000
@12      EQU   12                                                       02913000
@13      EQU   13                                                       02914000
@14      EQU   14                                                       02915000
@15      EQU   15                                                       02916000
I        EQU   @02                                                      02917000
DESBUFP  EQU   @09                                                      02918000
AUTHSW   EQU   @02                                                      02919000
SRETC    EQU   @09                                                      02920000
RETC     EQU   @08                                                      02921000
BUFPTR   EQU   @06                                                      02922000
ZZ2PTR   EQU   @07                                                      02923000
R0       EQU   @00                                                      02924000
R1       EQU   @01                                                      02925000
R2       EQU   @02                                                      02926000
R3       EQU   @03                                                      02927000
R4       EQU   @04                                                      02928000
R5       EQU   @05                                                      02929000
R9       EQU   @09                                                      02930000
RB       EQU   @11                                                      02931000
RD       EQU   @13                                                      02932000
RE       EQU   @14                                                      02933000
RF       EQU   @15                                                      02934000
PDRPTR   EQU   @05                                                      02935000
GPR15F   EQU   @15                                                      02936000
GPR01P   EQU   @01                                                      02937000
GPR00F   EQU   @00                                                      02938000
GPR01F   EQU   @01                                                      02939000
RA       EQU   @10                                                      02940000
RC       EQU   @12                                                      02941000
R6       EQU   @06                                                      02942000
R7       EQU   @07                                                      02943000
R8       EQU   @08                                                      02944000
ZZ1      EQU   0                                                        02945000
ZZ1ZZ2P  EQU   ZZ1+36                                                   02946000
ZZ1PDRP  EQU   ZZ1+40                                                   02947000
ZZ1FPP   EQU   ZZ1+140                                                  02948000
ZZ1ATTN  EQU   ZZ1+360                                                  02949000
ZZ1EVE   EQU   ZZ1ATTN+4                                                02950000
ZZ1F     EQU   ZZ1+368                                                  02951000
ZZ1N     EQU   ZZ1+1116                                                 02952000
ZZ2      EQU   0                                                        02953000
ZZ2AMD   EQU   ZZ2                                                      02954000
@NM00013 EQU   ZZ2AMD+7                                                 02955000
ZZ2PRT   EQU   ZZ2+138                                                  02956000
ZZ2PRTT  EQU   ZZ2PRT+4                                                 02957000
ZZ2PRTT1 EQU   ZZ2PRTT+1                                                02958000
ZZ2A     EQU   ZZ2+272                                                  02959000
ZZ2AF    EQU   ZZ2A+16                                                  02960000
ZZ2AFX   EQU   ZZ2AF+5                                                  02961000
ZZ2APID  EQU   ZZ2A+64                                                  02962000
ZZ2AD    EQU   ZZ2A+74                                                  02963000
ZZ2ADD   EQU   ZZ2AD                                                    02964000
ZZ2ADDT  EQU   ZZ2ADD+2                                                 02965000
ZZ2ADM   EQU   ZZ2AD+46                                                 02966000
ZZ2ADMT  EQU   ZZ2ADM+2                                                 02967000
ZZ2ADP   EQU   ZZ2AD+56                                                 02968000
ZZ2ADPT  EQU   ZZ2ADP+2                                                 02969000
ZZ2AQAS  EQU   ZZ2A+144                                                 02970000
ZZ2AQD   EQU   ZZ2A+160                                                 02971000
ZZ2AQDT  EQU   ZZ2AQD+10                                                02972000
ZZ2AQDF  EQU   ZZ2AQD+52                                                02973000
ZZ2STG   EQU   ZZ2+960                                                  02974000
ZZ2ALLOP EQU   ZZ2+992                                                  02975000
ZZ2FREEP EQU   ZZ2+996                                                  02976000
ZZ2FF19P EQU   ZZ2+1000                                                 02977000
ZZ2FRE1P EQU   ZZ2+1004                                                 02978000
ZZ2FF18P EQU   ZZ2+1008                                                 02979000
ZZ2DYNAP EQU   ZZ2+1012                                                 02980000
ZZ2ZZ2CP EQU   ZZ2+1016                                                 02981000
ZZ2ZZ2DP EQU   ZZ2+1020                                                 02982000
ZZ2STAIP EQU   ZZ2+1024                                                 02983000
ZZ2FF02P EQU   ZZ2+1028                                                 02984000
ZZ2GETLP EQU   ZZ2+1032                                                 02985000
ZZ2PARSP EQU   ZZ2+1036                                                 02986000
ZZ2PTGTP EQU   ZZ2+1040                                                 02987000
ZZ2PUTLP EQU   ZZ2+1044                                                 02988000
ZZ2SCANP EQU   ZZ2+1048                                                 02989000
ZZ2STCKP EQU   ZZ2+1052                                                 02990000
ZZ2ALOCP EQU   ZZ2+1056                                                 02991000
ZZ2MSGSP EQU   ZZ2+1060                                                 02992000
ZZ2TRMOP EQU   ZZ2+1064                                                 02993000
ZZ2TRMVP EQU   ZZ2+1068                                                 02994000
ZZ2MSG0P EQU   ZZ2+1076                                                 02995000
ZZ2PUTNP EQU   ZZ2+1084                                                 02996000
ZZ2TRMNP EQU   ZZ2+1088                                                 02997000
ZZ2ENQ0P EQU   ZZ2+1092                                                 02998000
ZZ2ADSDP EQU   ZZ2+1096                                                 02999000
ZZ2APDRP EQU   ZZ2+1100                                                 03000000
ZZ2FDSDP EQU   ZZ2+1104                                                 03001000
ZZ2FPDRP EQU   ZZ2+1108                                                 03002000
ZZ2ZZ1P  EQU   ZZ2+1264                                                 03003000
ZZ2DVTP  EQU   ZZ2+1276                                                 03004000
ZZ2BVTP  EQU   ZZ2+1280                                                 03005000
ZZ2CPPL  EQU   ZZ2+1292                                                 03006000
ZZ2CPPLC EQU   ZZ2CPPL                                                  03007000
ZZ2ITR   EQU   ZZ2+2840                                                 03008000
ZZ2ITRE  EQU   ZZ2ITR+16                                                03009000
ZZ2ITSE  EQU   ZZ2+2864                                                 03010000
ZZ2ES    EQU   ZZ2+2872                                                 03011000
ZZ2AMDX  EQU   ZZ2+7160                                                 03012000
ZZ2AXO   EQU   ZZ2+7934                                                 03013000
ZZ2AXOT  EQU   ZZ2AXO+2                                                 03014000
CMD      EQU   0                                                        03015000
CMDT     EQU   CMD+4                                                    03016000
PSCB     EQU   0                                                        03017000
PSCBATR1 EQU   PSCB+16                                                  03018000
ECT      EQU   0                                                        03019000
ECTSWS   EQU   ECT+28                                                   03020000
ECTSWS2  EQU   ECT+40                                                   03021000
ECTSWS21 EQU   ECTSWS2                                                  03022000
UPT      EQU   0                                                        03023000
UPTSWS   EQU   UPT+12                                                   03024000
SA       EQU   0                                                        03025000
SA1      EQU   SA                                                       03026000
SAR      EQU   SA+12                                                    03027000
BLSUPARI EQU   0                                                        03028000
BVT      EQU   0                                                        03029000
BVTPUTLP EQU   BVT+4                                                    03030000
BVTPUTOP EQU   BVT+12                                                   03031000
BVTPUTTP EQU   BVT+16                                                   03032000
BVTPUTVP EQU   BVT+20                                                   03033000
BVTPUTAP EQU   BVT+24                                                   03034000
BVTPRTTP EQU   BVT+28                                                   03035000
BVTPRTAP EQU   BVT+32                                                   03036000
BVTPUTDP EQU   BVT+36                                                   03037000
BVTMONP  EQU   BVT+40                                                   03038000
BVTMON2P EQU   BVT+44                                                   03039000
BVTVSARP EQU   BVT+48                                                   03040000
BVTVSENP EQU   BVT+64                                                   03041000
BVTVSERP EQU   BVT+68                                                   03042000
BVTVSGEP EQU   BVT+72                                                   03043000
BVTVSGUP EQU   BVT+76                                                   03044000
BVTVSPOP EQU   BVT+80                                                   03045000
BVTVSPUP EQU   BVT+84                                                   03046000
BVTMPKNP EQU   BVT+104                                                  03047000
BVTMONLP EQU   BVT+108                                                  03048000
BVTPUTCP EQU   BVT+132                                                  03049000
BVTMPK1P EQU   BVT+136                                                  03050000
BVTZZ2RP EQU   BVT+140                                                  03051000
BVTPGMRP EQU   BVT+144                                                  03052000
BVTMONAP EQU   BVT+148                                                  03053000
BVTBLDDP EQU   BVT+152                                                  03054000
BVTBLDLP EQU   BVT+156                                                  03055000
BVTPGMCP EQU   BVT+160                                                  03056000
BVTPGMDP EQU   BVT+164                                                  03057000
BVTPGMLP EQU   BVT+168                                                  03058000
BVTMONCP EQU   BVT+180                                                  03059000
BVTMONDP EQU   BVT+184                                                  03060000
BVTMONTP EQU   BVT+188                                                  03061000
BVTPARIP EQU   BVT+192                                                  03062000
BVTPARUP EQU   BVT+196                                                  03063000
BVTPRTNP EQU   BVT+204                                                  03064000
BVTVSCRP EQU   BVT+208                                                  03065000
BVTVSMRP EQU   BVT+212                                                  03066000
BVTMONXP EQU   BVT+216                                                  03067000
BVTTRMAP EQU   BVT+228                                                  03068000
BLSDDEQP EQU   0                                                        03069000
BLSDENQP EQU   0                                                        03070000
BLSDMSGS EQU   0                                                        03071000
BLSDMSG0 EQU   0                                                        03072000
BLSEAUTH EQU   0                                                        03073000
DVT      EQU   0                                                        03074000
DVTDEQPP EQU   DVT+8                                                    03075000
DVTENQPP EQU   DVT+12                                                   03076000
DVTAUTHP EQU   DVT+20                                                   03077000
DVTLPCLP EQU   DVT+24                                                   03078000
DVTBP00P EQU   DVT+28                                                   03079000
DVTCN00P EQU   DVT+32                                                   03080000
DVTDF00P EQU   DVT+36                                                   03081000
DVTDS00P EQU   DVT+44                                                   03082000
DVTFL00P EQU   DVT+48                                                   03083000
DVTFP00P EQU   DVT+52                                                   03084000
DVTGD00P EQU   DVT+56                                                   03085000
DVTGG00P EQU   DVT+60                                                   03086000
DVTGP00P EQU   DVT+64                                                   03087000
DVTND00P EQU   DVT+68                                                   03088000
DVTND01P EQU   DVT+72                                                   03089000
DVTOD00P EQU   DVT+76                                                   03090000
DVTPS00P EQU   DVT+80                                                   03091000
DVTSD00P EQU   DVT+84                                                   03092000
DVTSL00P EQU   DVT+88                                                   03093000
DVTTL00P EQU   DVT+92                                                   03094000
DVTUD00P EQU   DVT+96                                                   03095000
DVTUP00P EQU   DVT+100                                                  03096000
DVTLP00P EQU   DVT+104                                                  03097000
DVTLALLP EQU   DVT+108                                                  03098000
DVTLPFMP EQU   DVT+112                                                  03099000
DVTCLOSP EQU   DVT+116                                                  03100000
DVTOPENP EQU   DVT+120                                                  03101000
DVTPERAP EQU   DVT+124                                                  03102000
DVTDALLP EQU   DVT+128                                                  03103000
PCCSECT  EQU   0                                                        03104000
PDDSECT  EQU   0                                                        03105000
PDXP     EQU   PDDSECT+1                                                03106000
PDL      EQU   PDDSECT+5                                                03107000
PIDI     EQU   0                                                        03108000
DTEI     EQU   0                                                        03109000
TMEI     EQU   0                                                        03110000
GRPI     EQU   0                                                        03111000
SIDI     EQU   0                                                        03112000
UFLI     EQU   0                                                        03113000
CIDI     EQU   0                                                        03114000
OWNI     EQU   0                                                        03115000
SEVI     EQU   0                                                        03116000
APRI     EQU   0                                                        03117000
PTFI     EQU   0                                                        03118000
FIXQ     EQU   0                                                        03119000
ABSQ     EQU   0                                                        03120000
DSCQ     EQU   0                                                        03121000
PDREC    EQU   0                                                        03122000
PDRKEY   EQU   PDREC                                                    03123000
PDRGRP   EQU   PDRKEY                                                   03124000
PDRKRCTY EQU   PDRGRP                                                   03125000
PDRKPID  EQU   PDRGRP+2                                                 03126000
PDRKPREF EQU   PDRKPID                                                  03127000
PDRKPNUM EQU   PDRKPID+3                                                03128000
PDRRECSQ EQU   PDRKEY+10                                                03129000
PDRINFO  EQU   PDREC+16                                                 03130000
FPBLOK   EQU   0                                                        03131000
FPPIDP   EQU   FPBLOK+96                                                03132000
FPDBPIDP EQU   FPBLOK+100                                               03133000
FPADMNM  EQU   FPBLOK+120                                               03134000
FPDELNM  EQU   FPBLOK+128                                               03135000
MYBUF    EQU   0                                                        03136000
DMCB     EQU   0                                                        03137000
DMCBID   EQU   DMCB                                                     03138000
DMCBFTY  EQU   DMCB+20                                                  03139000
DMCBOPN  EQU   DMCB+21                                                  03140000
DMCBRQST EQU   DMCB+22                                                  03141000
DMCBRMOD EQU   DMCB+23                                                  03142000
DMCBOUT  EQU   DMCBRMOD                                                 03143000
DMCBTMP  EQU   DMCBOUT                                                  03144000
DMCBRM6  EQU   DMCBRMOD                                                 03145000
DMCBRM5  EQU   DMCBRMOD                                                 03146000
DMCBOPTS EQU   DMCB+24                                                  03147000
DMCBKYD  EQU   DMCBOPTS                                                 03148000
DMCBGKY  EQU   DMCBOPTS                                                 03149000
DMCBAPX  EQU   DMCBOPTS                                                 03150000
DMCBUPD  EQU   DMCBOPTS                                                 03151000
DMCBMFLG EQU   DMCB+28                                                  03152000
DMCBBUFP EQU   DMCB+32                                                  03153000
DMCBBLEN EQU   DMCB+36                                                  03154000
DMCBORL  EQU   DMCB+40                                                  03155000
DMCBKEYP EQU   DMCB+44                                                  03156000
DMCBKEYL EQU   DMCB+48                                                  03157000
DMCBMSG  EQU   DMCB+52                                                  03158000
DMCBRI   EQU   DMCB+64                                                  03159000
DMCBACBE EQU   DMCB+124                                                 03160000
DMCBSPEC EQU   DMCB+380                                                 03161000
DMCBAMS  EQU   DMCB+416                                                 03162000
DMCBAUDT EQU   DMCB+568                                                 03163000
DMCBLSCP EQU   DMCBAUDT+16                                              03164000
DMCBDMGR EQU   0                                                        03165000
I015F    EQU   0                                                        03166000
BLSCALOC EQU   0                                                        03167000
BLSDADSD EQU   0                                                        03168000
BLSDAPDR EQU   0                                                        03169000
BLSDENQ0 EQU   0                                                        03170000
BLSDFDSD EQU   0                                                        03171000
BLSDFPDR EQU   0                                                        03172000
BLSELPCL EQU   0                                                        03173000
BLSELPFM EQU   0                                                        03174000
BLSFBP00 EQU   0                                                        03175000
BLSFCLOS EQU   0                                                        03176000
BLSFCN00 EQU   0                                                        03177000
BLSFDALL EQU   0                                                        03178000
BLSFDF00 EQU   0                                                        03179000
BLSFDS00 EQU   0                                                        03180000
BLSFFL00 EQU   0                                                        03181000
BLSFFP00 EQU   0                                                        03182000
BLSFGD00 EQU   0                                                        03183000
BLSFGG00 EQU   0                                                        03184000
BLSFGP00 EQU   0                                                        03185000
BLSFLALL EQU   0                                                        03186000
BLSFLP00 EQU   0                                                        03187000
BLSFND00 EQU   0                                                        03188000
BLSFND01 EQU   0                                                        03189000
BLSFOD00 EQU   0                                                        03190000
BLSFOPEN EQU   0                                                        03191000
BLSFPERA EQU   0                                                        03192000
BLSFPS00 EQU   0                                                        03193000
BLSFSD00 EQU   0                                                        03194000
BLSFSL00 EQU   0                                                        03195000
BLSFTL00 EQU   0                                                        03196000
BLSFUD00 EQU   0                                                        03197000
BLSFUP00 EQU   0                                                        03198000
BLSUALLO EQU   0                                                        03199000
BLSUBLDD EQU   0                                                        03200000
BLSUBLDL EQU   0                                                        03201000
BLSUDYNA EQU   0                                                        03202000
BLSUFREE EQU   0                                                        03203000
BLSUFRE1 EQU   0                                                        03204000
BLSUMON  EQU   0                                                        03205000
BLSUMONA EQU   0                                                        03206000
BLSUMONC EQU   0                                                        03207000
BLSUMOND EQU   0                                                        03208000
BLSUMONL EQU   0                                                        03209000
BLSUMONT EQU   0                                                        03210000
BLSUMONX EQU   0                                                        03211000
BLSUMON2 EQU   0                                                        03212000
BLSUMPKN EQU   0                                                        03213000
BLSUMPK1 EQU   0                                                        03214000
BLSUPARU EQU   0                                                        03215000
BLSUPGMC EQU   0                                                        03216000
BLSUPGMD EQU   0                                                        03217000
BLSUPGML EQU   0                                                        03218000
BLSUPGMR EQU   0                                                        03219000
BLSUPRTA EQU   0                                                        03220000
BLSUPRTN EQU   0                                                        03221000
BLSUPRTT EQU   0                                                        03222000
BLSUPUTA EQU   0                                                        03223000
BLSUPUTC EQU   0                                                        03224000
BLSUPUTD EQU   0                                                        03225000
BLSUPUTL EQU   0                                                        03226000
BLSUPUTN EQU   0                                                        03227000
BLSUPUTO EQU   0                                                        03228000
BLSUPUTT EQU   0                                                        03229000
BLSUPUTV EQU   0                                                        03230000
BLSUSTAI EQU   0                                                        03231000
BLSUTRMA EQU   0                                                        03232000
BLSUTRMN EQU   0                                                        03233000
BLSUTRMO EQU   0                                                        03234000
BLSUTRMV EQU   0                                                        03235000
BLSUVSAR EQU   0                                                        03236000
BLSUVSCR EQU   0                                                        03237000
BLSUVSEN EQU   0                                                        03238000
BLSUVSER EQU   0                                                        03239000
BLSUVSGE EQU   0                                                        03240000
BLSUVSGU EQU   0                                                        03241000
BLSUVSMR EQU   0                                                        03242000
BLSUVSPO EQU   0                                                        03243000
BLSUVSPU EQU   0                                                        03244000
BLSUZZ2C EQU   0                                                        03245000
BLSUZZ2D EQU   0                                                        03246000
BLSUZZ2R EQU   0                                                        03247000
DDSD     EQU   0                                                        03248000
DDSM     EQU   0                                                        03249000
DDSP     EQU   0                                                        03250000
DMCBRQC  EQU   0                                                        03251000
IKJEFF02 EQU   0                                                        03252000
IKJEFF18 EQU   0                                                        03253000
IKJEFF19 EQU   0                                                        03254000
IKJGETL  EQU   0                                                        03255000
IKJPARS  EQU   0                                                        03256000
IKJPTGT  EQU   0                                                        03257000
IKJPUTL  EQU   0                                                        03258000
IKJSCAN  EQU   0                                                        03259000
IKJSTCK  EQU   0                                                        03260000
I001C    EQU   0                                                        03261000
I008P    EQU   0                                                        03262000
I015P    EQU   0                                                        03263000
I031F    EQU   0                                                        03264000
I031P    EQU   0                                                        03265000
I256C    EQU   0                                                        03266000
PIDIP    EQU   PID                                                      03267000
PIDIL    EQU   PID+4                                                    03268000
PIDIF    EQU   PID+6                                                    03269000
PIDIFP   EQU   PIDIF                                                    03270000
DTEIP    EQU   DTE                                                      03271000
DTEIL    EQU   DTE+4                                                    03272000
DTEIF    EQU   DTE+6                                                    03273000
DTEIFP   EQU   DTEIF                                                    03274000
TMEIP    EQU   TME                                                      03275000
TMEIL    EQU   TME+4                                                    03276000
TMEIF    EQU   TME+6                                                    03277000
TMEIFP   EQU   TMEIF                                                    03278000
GRPIP    EQU   GRP                                                      03279000
GRPIL    EQU   GRP+4                                                    03280000
GRPIF    EQU   GRP+6                                                    03281000
GRPIFP   EQU   GRPIF                                                    03282000
SIDIP    EQU   SID                                                      03283000
SIDIL    EQU   SID+4                                                    03284000
SIDIF    EQU   SID+6                                                    03285000
SIDIFP   EQU   SIDIF                                                    03286000
UFLIP    EQU   UFL                                                      03287000
UFLIL    EQU   UFL+4                                                    03288000
UFLIF    EQU   UFL+6                                                    03289000
UFLIFP   EQU   UFLIF                                                    03290000
CIDIP    EQU   CID                                                      03291000
CIDIL    EQU   CID+4                                                    03292000
CIDIF    EQU   CID+6                                                    03293000
CIDIFP   EQU   CIDIF                                                    03294000
OWNIP    EQU   OWN                                                      03295000
OWNIL    EQU   OWN+4                                                    03296000
OWNIF    EQU   OWN+6                                                    03297000
OWNIFP   EQU   OWNIF                                                    03298000
SEVIP    EQU   SEV                                                      03299000
SEVIF    EQU   SEV+6                                                    03300000
SEVIFP   EQU   SEVIF                                                    03301000
APRIP    EQU   APR                                                      03302000
APRIL    EQU   APR+4                                                    03303000
APRIF    EQU   APR+6                                                    03304000
APRIFP   EQU   APRIF                                                    03305000
PTFIP    EQU   PTF                                                      03306000
PTFIL    EQU   PTF+4                                                    03307000
PTFIF    EQU   PTF+6                                                    03308000
PTFIFP   EQU   PTFIF                                                    03309000
FIXQP    EQU   FIX                                                      03310000
FIXQL    EQU   FIX+4                                                    03311000
FIXQF    EQU   FIX+6                                                    03312000
FIXQFP   EQU   FIXQF                                                    03313000
ABSQP    EQU   ABS                                                      03314000
ABSQL    EQU   ABS+4                                                    03315000
ABSQF    EQU   ABS+6                                                    03316000
ABSQFP   EQU   ABSQF                                                    03317000
DSCQP    EQU   DSC                                                      03318000
DSCQL    EQU   DSC+4                                                    03319000
DSCQF    EQU   DSC+6                                                    03320000
DSCQFP   EQU   DSCQF                                                    03321000
DDSDP    EQU   DDS                                                      03322000
DDSDF    EQU   DDS+6                                                    03323000
DDSDFP   EQU   DDSDF                                                    03324000
DDSMP    EQU   DDS+8                                                    03325000
DDSMF    EQU   DDS+14                                                   03326000
DDSPP    EQU   DDS+16                                                   03327000
DDSPF    EQU   DDS+22                                                   03328000
BUF      EQU   0                                                        03329000
MSGNO    EQU   0                                                        03330000
CPPL     EQU   ZZ2CPPL                                                  03331000
CPPLUPT  EQU   CPPL+4                                                   03332000
CPPLPSCB EQU   CPPL+8                                                   03333000
CPPLECT  EQU   CPPL+12                                                  03334000
PDRSTREC EQU   PDRINFO                                                  03335000
PDRODATE EQU   PDRSTREC                                                 03336000
PDROTIME EQU   PDRSTREC+8                                               03337000
PDRCOMP  EQU   PDRSTREC+16                                              03338000
PDRSEV   EQU   PDRSTREC+26                                              03339000
PDROWNNM EQU   PDRSTREC+32                                              03340000
PDROWNID EQU   PDROWNNM                                                 03341000
PDROWNLN EQU   PDROWNNM+7                                               03342000
PDRGROUP EQU   PDRSTREC+40                                              03343000
PDRSYS   EQU   PDRSTREC+48                                              03344000
PDRUSER  EQU   PDRSTREC+56                                              03345000
PDRPSTAT EQU   PDRSTREC+64                                              03346000
PDRPDATE EQU   PDRSTREC+72                                              03347000
PDRPTIME EQU   PDRSTREC+80                                              03348000
PDRISTAT EQU   PDRSTREC+104                                             03349000
PDRIDATE EQU   PDRSTREC+112                                             03350000
PDRITIME EQU   PDRSTREC+120                                             03351000
PDRAPRID EQU   PDRSTREC+128                                             03352000
PDRTSTAT EQU   PDRSTREC+140                                             03353000
PDRTDATE EQU   PDRSTREC+144                                             03354000
PDRTTIME EQU   PDRSTREC+152                                             03355000
PDRPTFID EQU   PDRSTREC+160                                             03356000
PDRFSTAT EQU   PDRSTREC+172                                             03357000
PDRFDATE EQU   PDRSTREC+176                                             03358000
PDRFTIME EQU   PDRSTREC+184                                             03359000
PDRFIXID EQU   PDRSTREC+192                                             03360000
PDRABS   EQU   PDRSTREC+256                                             03361000
PDRDESCL EQU   PDRSTREC+384                                             03362000
PDRDEREC EQU   PDRINFO                                                  03363000
PDRDESCR EQU   PDRDEREC                                                 03364000
PDRDESC  EQU   PDRDESCR                                                 03365000
PDRTRREC EQU   PDRINFO                                                  03366000
PDRTRARR EQU   PDRTRREC                                                 03367000
PDRHSREC EQU   PDRINFO                                                  03368000
PDRDSREC EQU   PDRINFO                                                  03369000
PDRDSNM  EQU   PDRDSREC                                                 03370000
PDRSVALU EQU   PDRODATE                                                 03371000
DMCBVSM  EQU   DMCBAMS                                                  03372000
DMCBQSM  EQU   DMCBAMS                                                  03373000
*                                      START UNREFERENCED COMPONENTS    03374000
DMCBRES7 EQU   DMCBQSM+96                                               03375000
DMCBDCB  EQU   DMCBQSM                                                  03376000
DMCBACB  EQU   DMCBVSM+76                                               03377000
DMCBRPL  EQU   DMCBVSM                                                  03378000
PDRSVNUM EQU   PDRSVALU+3                                               03379000
PDRSVRES EQU   PDRSVALU                                                 03380000
PDRDSRES EQU   PDRDSREC+52                                              03381000
PDRMEMB  EQU   PDRDSNM+44                                               03382000
PDRDSN   EQU   PDRDSNM                                                  03383000
PDRHYMSD EQU   PDRHSREC+4                                               03384000
PDRHSLEN EQU   PDRHSREC                                                 03385000
PDRTRKD  EQU   PDRTRARR                                                 03386000
PDRDSSEQ EQU   PDRSTREC+396                                             03387000
PDRRES6  EQU   PDRSTREC+392                                             03388000
PDRTRKL  EQU   PDRSTREC+388                                             03389000
PDRRES5  EQU   PDRSTREC+252                                             03390000
PDRRES4  EQU   PDRSTREC+167                                             03391000
PDRRES3  EQU   PDRSTREC+135                                             03392000
PDRRTIME EQU   PDRSTREC+96                                              03393000
PDRRDATE EQU   PDRSTREC+88                                              03394000
PDRRES1  EQU   PDRSTREC+27                                              03395000
CPPLCBUF EQU   CPPL                                                     03396000
@NM00102 EQU   DDS+24                                                   03397000
@NM00101 EQU   DDS+23                                                   03398000
DDSPF8   EQU   DDSPF                                                    03399000
DDSPF7   EQU   DDSPF                                                    03400000
DDSPF6   EQU   DDSPF                                                    03401000
DDSPF5   EQU   DDSPF                                                    03402000
DDSPF4   EQU   DDSPF                                                    03403000
DDSPF3   EQU   DDSPF                                                    03404000
DDSPF2   EQU   DDSPF                                                    03405000
DDSPFP   EQU   DDSPF                                                    03406000
DDSPL    EQU   DDS+20                                                   03407000
@NM00100 EQU   DDS+15                                                   03408000
DDSMF8   EQU   DDSMF                                                    03409000
DDSMF7   EQU   DDSMF                                                    03410000
DDSMF6   EQU   DDSMF                                                    03411000
DDSMF5   EQU   DDSMF                                                    03412000
DDSMF4   EQU   DDSMF                                                    03413000
DDSMF3   EQU   DDSMF                                                    03414000
DDSMF2   EQU   DDSMF                                                    03415000
DDSMFP   EQU   DDSMF                                                    03416000
DDSML    EQU   DDS+12                                                   03417000
@NM00099 EQU   DDS+7                                                    03418000
@NM00098 EQU   DDSDF                                                    03419000
DDSDFQ   EQU   DDSDF                                                    03420000
DDSDL    EQU   DDS+4                                                    03421000
@NM00097 EQU   DSC+8                                                    03422000
@NM00096 EQU   DSC+7                                                    03423000
DSCQF8   EQU   DSCQF                                                    03424000
DSCQF7   EQU   DSCQF                                                    03425000
DSCQF6   EQU   DSCQF                                                    03426000
DSCQF5   EQU   DSCQF                                                    03427000
DSCQF4   EQU   DSCQF                                                    03428000
DSCQF3   EQU   DSCQF                                                    03429000
DSCQF2   EQU   DSCQF                                                    03430000
@NM00095 EQU   ABS+8                                                    03431000
@NM00094 EQU   ABS+7                                                    03432000
ABSQF8   EQU   ABSQF                                                    03433000
ABSQF7   EQU   ABSQF                                                    03434000
ABSQF6   EQU   ABSQF                                                    03435000
ABSQF5   EQU   ABSQF                                                    03436000
ABSQF4   EQU   ABSQF                                                    03437000
ABSQF3   EQU   ABSQF                                                    03438000
ABSQF2   EQU   ABSQF                                                    03439000
@NM00093 EQU   FIX+8                                                    03440000
@NM00092 EQU   FIX+7                                                    03441000
FIXQF8   EQU   FIXQF                                                    03442000
FIXQF7   EQU   FIXQF                                                    03443000
FIXQF6   EQU   FIXQF                                                    03444000
FIXQF5   EQU   FIXQF                                                    03445000
FIXQF4   EQU   FIXQF                                                    03446000
FIXQF3   EQU   FIXQF                                                    03447000
FIXQF2   EQU   FIXQF                                                    03448000
@NM00091 EQU   PTF+8                                                    03449000
@NM00090 EQU   PTF+7                                                    03450000
PTFIF8   EQU   PTFIF                                                    03451000
PTFIF7   EQU   PTFIF                                                    03452000
PTFIF6   EQU   PTFIF                                                    03453000
PTFIF5   EQU   PTFIF                                                    03454000
PTFIF4   EQU   PTFIF                                                    03455000
PTFIF3   EQU   PTFIF                                                    03456000
PTFIF2   EQU   PTFIF                                                    03457000
@NM00089 EQU   APR+8                                                    03458000
@NM00088 EQU   APR+7                                                    03459000
APRIF8   EQU   APRIF                                                    03460000
APRIF7   EQU   APRIF                                                    03461000
APRIF6   EQU   APRIF                                                    03462000
APRIF5   EQU   APRIF                                                    03463000
APRIF4   EQU   APRIF                                                    03464000
APRIF3   EQU   APRIF                                                    03465000
APRIF2   EQU   APRIF                                                    03466000
@NM00087 EQU   SEV+8                                                    03467000
@NM00086 EQU   SEV+7                                                    03468000
SEVIF8   EQU   SEVIF                                                    03469000
SEVIF7   EQU   SEVIF                                                    03470000
SEVIF6   EQU   SEVIF                                                    03471000
SEVIF5   EQU   SEVIF                                                    03472000
SEVIF4   EQU   SEVIF                                                    03473000
SEVIF3   EQU   SEVIF                                                    03474000
SEVIF2   EQU   SEVIF                                                    03475000
SEVIL    EQU   SEV+4                                                    03476000
@NM00085 EQU   OWN+8                                                    03477000
@NM00084 EQU   OWN+7                                                    03478000
OWNIF8   EQU   OWNIF                                                    03479000
OWNIF7   EQU   OWNIF                                                    03480000
OWNIF6   EQU   OWNIF                                                    03481000
OWNIF5   EQU   OWNIF                                                    03482000
OWNIF4   EQU   OWNIF                                                    03483000
OWNIF3   EQU   OWNIF                                                    03484000
OWNIF2   EQU   OWNIF                                                    03485000
@NM00083 EQU   CID+8                                                    03486000
@NM00082 EQU   CID+7                                                    03487000
CIDIF8   EQU   CIDIF                                                    03488000
CIDIF7   EQU   CIDIF                                                    03489000
CIDIF6   EQU   CIDIF                                                    03490000
CIDIF5   EQU   CIDIF                                                    03491000
CIDIF4   EQU   CIDIF                                                    03492000
CIDIF3   EQU   CIDIF                                                    03493000
CIDIF2   EQU   CIDIF                                                    03494000
@NM00081 EQU   UFL+8                                                    03495000
@NM00080 EQU   UFL+7                                                    03496000
UFLIF8   EQU   UFLIF                                                    03497000
UFLIF7   EQU   UFLIF                                                    03498000
UFLIF6   EQU   UFLIF                                                    03499000
UFLIF5   EQU   UFLIF                                                    03500000
UFLIF4   EQU   UFLIF                                                    03501000
UFLIF3   EQU   UFLIF                                                    03502000
UFLIF2   EQU   UFLIF                                                    03503000
@NM00079 EQU   SID+8                                                    03504000
@NM00078 EQU   SID+7                                                    03505000
SIDIF8   EQU   SIDIF                                                    03506000
SIDIF7   EQU   SIDIF                                                    03507000
SIDIF6   EQU   SIDIF                                                    03508000
SIDIF5   EQU   SIDIF                                                    03509000
SIDIF4   EQU   SIDIF                                                    03510000
SIDIF3   EQU   SIDIF                                                    03511000
SIDIF2   EQU   SIDIF                                                    03512000
@NM00077 EQU   GRP+8                                                    03513000
@NM00076 EQU   GRP+7                                                    03514000
GRPIF8   EQU   GRPIF                                                    03515000
GRPIF7   EQU   GRPIF                                                    03516000
GRPIF6   EQU   GRPIF                                                    03517000
GRPIF5   EQU   GRPIF                                                    03518000
GRPIF4   EQU   GRPIF                                                    03519000
GRPIF3   EQU   GRPIF                                                    03520000
GRPIF2   EQU   GRPIF                                                    03521000
@NM00075 EQU   TME+8                                                    03522000
@NM00074 EQU   TME+7                                                    03523000
TMEIF8   EQU   TMEIF                                                    03524000
TMEIF7   EQU   TMEIF                                                    03525000
TMEIF6   EQU   TMEIF                                                    03526000
TMEIF5   EQU   TMEIF                                                    03527000
TMEIF4   EQU   TMEIF                                                    03528000
TMEIF3   EQU   TMEIF                                                    03529000
TMEIF2   EQU   TMEIF                                                    03530000
@NM00073 EQU   DTE+8                                                    03531000
@NM00072 EQU   DTE+7                                                    03532000
DTEIF8   EQU   DTEIF                                                    03533000
DTEIF7   EQU   DTEIF                                                    03534000
DTEIF6   EQU   DTEIF                                                    03535000
DTEIF5   EQU   DTEIF                                                    03536000
DTEIF4   EQU   DTEIF                                                    03537000
DTEIF3   EQU   DTEIF                                                    03538000
DTEIF2   EQU   DTEIF                                                    03539000
@NM00071 EQU   PID+8                                                    03540000
@NM00070 EQU   PID+7                                                    03541000
PIDIF8   EQU   PIDIF                                                    03542000
PIDIF7   EQU   PIDIF                                                    03543000
PIDIF6   EQU   PIDIF                                                    03544000
PIDIF5   EQU   PIDIF                                                    03545000
PIDIF4   EQU   PIDIF                                                    03546000
PIDIF3   EQU   PIDIF                                                    03547000
PIDIF2   EQU   PIDIF                                                    03548000
DMCBWRK  EQU   DMCB+648                                                 03549000
DMCBRES8 EQU   DMCB+640                                                 03550000
DMCBMODN EQU   DMCB+632                                                 03551000
DMCBCARY EQU   DMCBAUDT+20                                              03552000
DMCBCLC  EQU   DMCBAUDT+12                                              03553000
DMCBOPC  EQU   DMCBAUDT+8                                               03554000
DMCBFRC  EQU   DMCBAUDT+4                                               03555000
DMCBALC  EQU   DMCBAUDT                                                 03556000
DMCBFR   EQU   DMCB+412                                                 03557000
DMCBRES6 EQU   DMCB+410                                                 03558000
DMCBIRSC EQU   DMCB+408                                                 03559000
DMCBSUBC EQU   DMCB+404                                                 03560000
DMCBDRBP EQU   DMCB+400                                                 03561000
DMCBRSZM EQU   DMCB+398                                                 03562000
DMCBRSZA EQU   DMCB+396                                                 03563000
DMCBCISZ EQU   DMCB+394                                                 03564000
DMCBDCBL EQU   DMCB+392                                                 03565000
DMCBDCLR EQU   DMCB+390                                                 03566000
DMCBDCFM EQU   DMCB+389                                                 03567000
DMCBRES5 EQU   DMCB+388                                                 03568000
DMCBLBRT EQU   DMCB+386                                                 03569000
DMCBLBSQ EQU   DMCB+384                                                 03570000
DMCBLBPS EQU   DMCB+383                                                 03571000
DMCBLBTY EQU   DMCB+382                                                 03572000
DMCBRES4 EQU   DMCB+381                                                 03573000
DMCBSPRS EQU   DMCBSPEC                                                 03574000
DMCBSPRN EQU   DMCBSPEC                                                 03575000
DMCBSPCT EQU   DMCBSPEC                                                 03576000
DMCBSPRL EQU   DMCBSPEC                                                 03577000
DMCBSPSE EQU   DMCB+376                                                 03578000
DMCBSPPR EQU   DMCB+372                                                 03579000
DMCBSPTY EQU   DMCB+369                                                 03580000
DMCBODIS EQU   DMCB+368                                                 03581000
DMCBDISP EQU   DMCB+367                                                 03582000
DMCBSTAT EQU   DMCB+366                                                 03583000
DMCBRES3 EQU   DMCB+364                                                 03584000
DMCBMEMB EQU   DMCB+356                                                 03585000
DMCBMODL EQU   DMCB+348                                                 03586000
DMCBRES9 EQU   DMCB+340                                                 03587000
DMCBPID  EQU   DMCB+332                                                 03588000
DMCBTYPE EQU   DMCB+328                                                 03589000
DMCBDSN  EQU   DMCB+284                                                 03590000
DMCBUNIT EQU   DMCB+276                                                 03591000
DMCBDSOR EQU   DMCB+274                                                 03592000
DMCBVOL  EQU   DMCB+268                                                 03593000
DMCBDDNM EQU   DMCB+260                                                 03594000
DMCBSYNM EQU   DMCB+132                                                 03595000
DMCBRPLF EQU   DMCB+128                                                 03596000
DMCBDCBE EQU   DMCBACBE                                                 03597000
DMCBARC  EQU   DMCB+120                                                 03598000
DMCBCPC  EQU   DMCB+116                                                 03599000
DMCBRET  EQU   DMCB+112                                                 03600000
DMCBSTL  EQU   DMCB+96                                                  03601000
DMCBEOB  EQU   DMCB+92                                                  03602000
DMCBFRE  EQU   DMCB+88                                                  03603000
DMCBRES2 EQU   DMCB+85                                                  03604000
DMCBSPID EQU   DMCB+84                                                  03605000
DMCBRESC EQU   DMCB+80                                                  03606000
DMCBZZ1P EQU   DMCB+76                                                  03607000
DMCBMSGS EQU   DMCB+72                                                  03608000
DMCBMSG0 EQU   DMCB+68                                                  03609000
DMCBRRL  EQU   DMCB+60                                                  03610000
DMCBRBA  EQU   DMCB+56                                                  03611000
DMCBKPC  EQU   DMCBKEYP                                                 03612000
DMCBBFPC EQU   DMCBBUFP                                                 03613000
DMCBRES1 EQU   DMCB+31                                                  03614000
DMCBACCM EQU   DMCB+30                                                  03615000
DMCBREJ  EQU   DMCB+29                                                  03616000
DMCBRESB EQU   DMCBMFLG                                                 03617000
DMCBFMOD EQU   DMCBMFLG                                                 03618000
DMCBLOPT EQU   DMCB+27                                                  03619000
DMCBLRM  EQU   DMCB+26                                                  03620000
DMCBLRQ  EQU   DMCB+25                                                  03621000
DMCBOPRS EQU   DMCBOPTS                                                 03622000
DMCBLRD  EQU   DMCBOPTS                                                 03623000
DMCBBWD  EQU   DMCBOPTS                                                 03624000
DMCBRNO  EQU   DMCBGKY                                                  03625000
DMCBRMRS EQU   DMCBRMOD                                                 03626000
DMCBRESA EQU   DMCBOPN                                                  03627000
DMCBSOUT EQU   DMCBOPN                                                  03628000
DMCBSIN  EQU   DMCBOPN                                                  03629000
DMCBVSF  EQU   DMCBFTY                                                  03630000
DMCBKSF  EQU   DMCBFTY                                                  03631000
DMCBFTRS EQU   DMCBFTY                                                  03632000
DMCBSHF  EQU   DMCBFTY                                                  03633000
DMCBIRL  EQU   DMCB+16                                                  03634000
DMCBRTC  EQU   DMCB+12                                                  03635000
DMCBTVP  EQU   DMCB+8                                                   03636000
DMCBNEXT EQU   DMCB+4                                                   03637000
FPRES6   EQU   FPBLOK+136                                               03638000
FPDELLN  EQU   FPDELNM+7                                                03639000
FPDELID  EQU   FPDELNM                                                  03640000
FPADMLN  EQU   FPADMNM+7                                                03641000
FPADMID  EQU   FPADMNM                                                  03642000
FPGRPID  EQU   FPBLOK+112                                               03643000
FPSYSID  EQU   FPBLOK+104                                               03644000
FPRES4   EQU   FPBLOK+103                                               03645000
FPRES3   EQU   FPBLOK+99                                                03646000
FPRES2   EQU   FPBLOK+92                                                03647000
FPDSDS   EQU   FPBLOK+48                                                03648000
FPRES1   EQU   FPBLOK+44                                                03649000
FPPDDS   EQU   FPBLOK                                                   03650000
PDRRESV  EQU   PDREC+14                                                 03651000
PDSP     EQU   PDDSECT+4                                                03652000
@NM00069 EQU   PDDSECT                                                  03653000
DVT99999 EQU   DVT+256                                                  03654000
DVT0064P EQU   DVT+252                                                  03655000
DVT0063P EQU   DVT+248                                                  03656000
DVT0062P EQU   DVT+244                                                  03657000
DVT0061P EQU   DVT+240                                                  03658000
DVT0060P EQU   DVT+236                                                  03659000
DVT0059P EQU   DVT+232                                                  03660000
DVT0058P EQU   DVT+228                                                  03661000
DVT0057P EQU   DVT+224                                                  03662000
DVT0056P EQU   DVT+220                                                  03663000
DVT0055P EQU   DVT+216                                                  03664000
DVT0054P EQU   DVT+212                                                  03665000
DVT0053P EQU   DVT+208                                                  03666000
DVT0052P EQU   DVT+204                                                  03667000
DVT0051P EQU   DVT+200                                                  03668000
DVT0050P EQU   DVT+196                                                  03669000
DVT0049P EQU   DVT+192                                                  03670000
DVT0048P EQU   DVT+188                                                  03671000
DVT0047P EQU   DVT+184                                                  03672000
DVT0046P EQU   DVT+180                                                  03673000
DVT0045P EQU   DVT+176                                                  03674000
DVT0044P EQU   DVT+172                                                  03675000
DVT0043P EQU   DVT+168                                                  03676000
DVT0042P EQU   DVT+164                                                  03677000
DVT0041P EQU   DVT+160                                                  03678000
DVT0040P EQU   DVT+156                                                  03679000
DVT0039P EQU   DVT+152                                                  03680000
DVT0038P EQU   DVT+148                                                  03681000
DVT0037P EQU   DVT+144                                                  03682000
DVT0036P EQU   DVT+140                                                  03683000
DVT0035P EQU   DVT+136                                                  03684000
DVT0034P EQU   DVT+132                                                  03685000
DVT0011P EQU   DVT+40                                                   03686000
DVT0005P EQU   DVT+16                                                   03687000
DVT0002P EQU   DVT+4                                                    03688000
DVT0001P EQU   DVT                                                      03689000
BVT99999 EQU   BVT+256                                                  03690000
BVT0064P EQU   BVT+252                                                  03691000
BVT0063P EQU   BVT+248                                                  03692000
BVT0062P EQU   BVT+244                                                  03693000
BVT0061P EQU   BVT+240                                                  03694000
BVT0060P EQU   BVT+236                                                  03695000
BVT0059P EQU   BVT+232                                                  03696000
BVT0057P EQU   BVT+224                                                  03697000
BVT0056P EQU   BVT+220                                                  03698000
BVTSTBLP EQU   BVT+200                                                  03699000
BVT0045P EQU   BVT+176                                                  03700000
BVT0044P EQU   BVT+172                                                  03701000
BVT0033P EQU   BVT+128                                                  03702000
BVT0032P EQU   BVT+124                                                  03703000
BVT0031P EQU   BVT+120                                                  03704000
BVT0030P EQU   BVT+116                                                  03705000
BVT0029P EQU   BVT+112                                                  03706000
BVT0026P EQU   BVT+100                                                  03707000
BVT0025P EQU   BVT+96                                                   03708000
BVT0024P EQU   BVT+92                                                   03709000
BVT0023P EQU   BVT+88                                                   03710000
BVT0016P EQU   BVT+60                                                   03711000
BVT0015P EQU   BVT+56                                                   03712000
BVT0014P EQU   BVT+52                                                   03713000
BVT0003P EQU   BVT+8                                                    03714000
BVT0001P EQU   BVT                                                      03715000
SA99     EQU   SA+72                                                    03716000
SARC     EQU   SAR+56                                                   03717000
SARB     EQU   SAR+52                                                   03718000
SARA     EQU   SAR+48                                                   03719000
SAR9     EQU   SAR+44                                                   03720000
SAR8     EQU   SAR+40                                                   03721000
SAR7     EQU   SAR+36                                                   03722000
SAR6     EQU   SAR+32                                                   03723000
SAR5     EQU   SAR+28                                                   03724000
SAR4     EQU   SAR+24                                                   03725000
SAR3     EQU   SAR+20                                                   03726000
SAR2     EQU   SAR+16                                                   03727000
SAR1     EQU   SAR+12                                                   03728000
SAR0     EQU   SAR+8                                                    03729000
SARF     EQU   SAR+4                                                    03730000
SARE     EQU   SAR                                                      03731000
SAFWD    EQU   SA+8                                                     03732000
SABAK    EQU   SA+4                                                     03733000
SA1L     EQU   SA1+1                                                    03734000
SA1P     EQU   SA1                                                      03735000
UPTPREFL EQU   UPT+23                                                   03736000
UPTPREFX EQU   UPT+16                                                   03737000
@NM00068 EQU   UPT+15                                                   03738000
UPTLDEL  EQU   UPT+14                                                   03739000
UPTCDEL  EQU   UPT+13                                                   03740000
UPTWTP   EQU   UPTSWS                                                   03741000
UPTMODE  EQU   UPTSWS                                                   03742000
UPTALD   EQU   UPTSWS                                                   03743000
UPTPAUS  EQU   UPTSWS                                                   03744000
UPTNCOM  EQU   UPTSWS                                                   03745000
UPTMID   EQU   UPTSWS                                                   03746000
UPTNPRM  EQU   UPTSWS                                                   03747000
UPTRCVR  EQU   UPTSWS                                                   03748000
UPTUSER  EQU   UPT+2                                                    03749000
@NM00067 EQU   UPT                                                      03750000
@NM00066 EQU   ECT+52                                                   03751000
@NM00065 EQU   ECT+48                                                   03752000
@NM00064 EQU   ECT+44                                                   03753000
@NM00063 EQU   ECTSWS2+1                                                03754000
@NM00062 EQU   ECTSWS21                                                 03755000
ECTTABND EQU   ECTSWS21                                                 03756000
ECTDEFCS EQU   ECTSWS21                                                 03757000
ECTBKPB  EQU   ECT+36                                                   03758000
ECTUSER  EQU   ECT+32                                                   03759000
ECTDDNUM EQU   ECT+29                                                   03760000
ECTATTN  EQU   ECTSWS                                                   03761000
ECTBKGRD EQU   ECTSWS                                                   03762000
ECTNNOT  EQU   ECTSWS                                                   03763000
ECTNMAL  EQU   ECTSWS                                                   03764000
ECTLOGF  EQU   ECTSWS                                                   03765000
ECTATRM  EQU   ECTSWS                                                   03766000
@NM00061 EQU   ECTSWS                                                   03767000
ECTNOPD  EQU   ECTSWS                                                   03768000
ECTSCMD  EQU   ECT+20                                                   03769000
ECTPCMD  EQU   ECT+12                                                   03770000
ECTSMSG  EQU   ECT+9                                                    03771000
ECTMSGF  EQU   ECT+8                                                    03772000
ECTIOWA  EQU   ECT+4                                                    03773000
ECTRTCD  EQU   ECT+1                                                    03774000
ECTRCDF  EQU   ECT                                                      03775000
PSCBU    EQU   PSCB+64                                                  03776000
PSCBRSZ  EQU   PSCB+60                                                  03777000
PSCBLINE EQU   PSCB+59                                                  03778000
PSCBCHAR EQU   PSCB+58                                                  03779000
PSCBUPTL EQU   PSCB+56                                                  03780000
PSCBUPT  EQU   PSCB+52                                                  03781000
PSCBRLGB EQU   PSCB+48                                                  03782000
PSCBDEST EQU   PSCB+40                                                  03783000
@NM00060 EQU   PSCB+36                                                  03784000
@NM00059 EQU   PSCB+32                                                  03785000
@NM00058 EQU   PSCB+28                                                  03786000
PSCBLTI2 EQU   PSCB+24                                                  03787000
PSCBLTIM EQU   PSCB+20                                                  03788000
PSCBATR2 EQU   PSCB+18                                                  03789000
@NM00057 EQU   PSCBATR1                                                 03790000
@NM00056 EQU   PSCBATR1                                                 03791000
@NM00055 EQU   PSCBATR1                                                 03792000
PSCBATTN EQU   PSCBATR1                                                 03793000
PSCBVMNT EQU   PSCBATR1                                                 03794000
PSCBJCL  EQU   PSCBATR1                                                 03795000
PSCBACCT EQU   PSCBATR1                                                 03796000
PSCBCTRL EQU   PSCBATR1                                                 03797000
PSCBGPNM EQU   PSCB+8                                                   03798000
PSCBUSRL EQU   PSCB+7                                                   03799000
PSCBUSER EQU   PSCB                                                     03800000
CMDT1    EQU   CMDT                                                     03801000
CMDO     EQU   CMD+2                                                    03802000
CMDL     EQU   CMD                                                      03803000
ZZ299999 EQU   ZZ2+8192                                                 03804000
ZZ2AXOT1 EQU   ZZ2AXOT                                                  03805000
ZZ2AXOL  EQU   ZZ2AXO                                                   03806000
@NM00054 EQU   ZZ2+7288                                                 03807000
@NM00053 EQU   ZZ2AMDX+4                                                03808000
ZZ2AMDXC EQU   ZZ2AMDX                                                  03809000
ZZ2HSD   EQU   ZZ2+3056                                                 03810000
@NM00052 EQU   ZZ2ES                                                    03811000
@NM00051 EQU   ZZ2+2868                                                 03812000
ZZ2ITSEC EQU   ZZ2ITSE+1                                                03813000
@NM00050 EQU   ZZ2ITSE                                                  03814000
ZZ2ITSEP EQU   ZZ2ITSE                                                  03815000
ZZ2ITSEW EQU   ZZ2ITSE                                                  03816000
@NM00049 EQU   ZZ2ITR+20                                                03817000
ZZ2ITREC EQU   ZZ2ITRE+1                                                03818000
@NM00048 EQU   ZZ2ITRE                                                  03819000
ZZ2ITREP EQU   ZZ2ITRE                                                  03820000
ZZ2ITREW EQU   ZZ2ITRE                                                  03821000
@NM00047 EQU   ZZ2ITR+9                                                 03822000
ZZ2ITRRC EQU   ZZ2ITR+8                                                 03823000
ZZ2ITR2P EQU   ZZ2ITR+4                                                 03824000
ZZ2ITRPP EQU   ZZ2ITR                                                   03825000
@NM00046 EQU   ZZ2+1544                                                 03826000
ZZ2PGM   EQU   ZZ2+1536                                                 03827000
@NM00045 EQU   ZZ2+1526                                                 03828000
ZZ2CW    EQU   ZZ2+1524                                                 03829000
@NM00044 EQU   ZZ2+1504                                                 03830000
@NM00043 EQU   ZZ2+1352                                                 03831000
ZZ2FFSYP EQU   ZZ2+1348                                                 03832000
ZZ2SASYP EQU   ZZ2+1344                                                 03833000
ZZ2RDSYP EQU   ZZ2+1340                                                 03834000
ZZ2RASYP EQU   ZZ2+1336                                                 03835000
ZZ2PHSYP EQU   ZZ2+1332                                                 03836000
ZZ2ESSYP EQU   ZZ2+1328                                                 03837000
ZZ200SYP EQU   ZZ2+1324                                                 03838000
ZZ2SCWP  EQU   ZZ2+1320                                                 03839000
ZZ2TTLP  EQU   ZZ2+1316                                                 03840000
ZZ2LOADP EQU   ZZ2+1312                                                 03841000
ZZ2VRESP EQU   ZZ2+1308                                                 03842000
ZZ2CPPLE EQU   ZZ2CPPL+12                                               03843000
ZZ2CPPLP EQU   ZZ2CPPL+8                                                03844000
ZZ2CPPLU EQU   ZZ2CPPL+4                                                03845000
ZZ2VRSAP EQU   ZZ2+1288                                                 03846000
ZZ2RVTP  EQU   ZZ2+1284                                                 03847000
@NM00042 EQU   ZZ2+1272                                                 03848000
@NM00041 EQU   ZZ2+1268                                                 03849000
ZZ2RPLP  EQU   ZZ2+1260                                                 03850000
ZZ2TCBP  EQU   ZZ2+1256                                                 03851000
@NM00040 EQU   ZZ2+1252                                                 03852000
ZZ2ZZ2P  EQU   ZZ2+1248                                                 03853000
@NM00039 EQU   ZZ2+1112                                                 03854000
@NM00038 EQU   ZZ2+1080                                                 03855000
ZZ2FT25P EQU   ZZ2+1072                                                 03856000
@NM00037 EQU   ZZ2+976                                                  03857000
ZZ2TOD   EQU   ZZ2+968                                                  03858000
ZZ2STGN  EQU   ZZ2STG+4                                                 03859000
ZZ2STGP  EQU   ZZ2STG                                                   03860000
@NM00036 EQU   ZZ2+952                                                  03861000
ZZ2SCMDE EQU   ZZ2+944                                                  03862000
ZZ2SCMDN EQU   ZZ2+936                                                  03863000
ZZ2IDENT EQU   ZZ2+928                                                  03864000
ZZ2A9999 EQU   ZZ2A+656                                                 03865000
@NM00035 EQU   ZZ2A+224                                                 03866000
@NM00034 EQU   ZZ2A+220                                                 03867000
ZZ2AQD99 EQU   ZZ2AQD+60                                                03868000
@NM00033 EQU   ZZ2AQD+56                                                03869000
@NM00032 EQU   ZZ2AQDF                                                  03870000
ZZ2AQDFA EQU   ZZ2AQDF                                                  03871000
ZZ2AQDIL EQU   ZZ2AQD+48                                                03872000
ZZ2AQDIM EQU   ZZ2AQD+44                                                03873000
ZZ2AQDT9 EQU   ZZ2AQDT+34                                               03874000
ZZ2AQDTE EQU   ZZ2AQDT+33                                               03875000
ZZ2AQDTD EQU   ZZ2AQDT+2                                                03876000
@NM00031 EQU   ZZ2AQDT+1                                                03877000
ZZ2AQDTY EQU   ZZ2AQDT                                                  03878000
ZZ2AQDT0 EQU   ZZ2AQDT                                                  03879000
ZZ2AQDLB EQU   ZZ2AQD+9                                                 03880000
ZZ2AQDOB EQU   ZZ2AQD+8                                                 03881000
ZZ2AQDLE EQU   ZZ2AQD+4                                                 03882000
ZZ2AQDOF EQU   ZZ2AQD                                                   03883000
ZZ2AQD00 EQU   ZZ2AQD                                                   03884000
ZZ2AQAS9 EQU   ZZ2AQAS+16                                               03885000
@NM00030 EQU   ZZ2AQAS+12                                               03886000
ZZ2AQAS2 EQU   ZZ2AQAS+8                                                03887000
ZZ2AQAS1 EQU   ZZ2AQAS+4                                                03888000
@NM00029 EQU   ZZ2AQAS+2                                                03889000
ZZ2AQAST EQU   ZZ2AQAS                                                  03890000
ZZ2AQAS0 EQU   ZZ2AQAS                                                  03891000
ZZ2AZZ6P EQU   ZZ2A+140                                                 03892000
ZZ2ADPTA EQU   ZZ2ADPT                                                  03893000
ZZ2ADPL  EQU   ZZ2ADP                                                   03894000
ZZ2ADMTA EQU   ZZ2ADMT                                                  03895000
ZZ2ADML  EQU   ZZ2ADM                                                   03896000
ZZ2ADDTA EQU   ZZ2ADDT                                                  03897000
ZZ2ADDL  EQU   ZZ2ADD                                                   03898000
@NM00028 EQU   ZZ2A+72                                                  03899000
ZZ2APIDB EQU   ZZ2APID+3                                                03900000
ZZ2APIDA EQU   ZZ2APID                                                  03901000
@NM00027 EQU   ZZ2A+24                                                  03902000
@NM00026 EQU   ZZ2AF+5                                                  03903000
@NM00025 EQU   ZZ2AF+3                                                  03904000
ZZ2AFS   EQU   ZZ2AF+2                                                  03905000
ZZ2AFD   EQU   ZZ2AF+2                                                  03906000
ZZ2AFQ   EQU   ZZ2AF+2                                                  03907000
ZZ2AF$   EQU   ZZ2AF+2                                                  03908000
@NM00024 EQU   ZZ2AF+2                                                  03909000
ZZ2AFM   EQU   ZZ2AF+2                                                  03910000
@NM00023 EQU   ZZ2AF+2                                                  03911000
@NM00022 EQU   ZZ2AF+1                                                  03912000
ZZ2AFV   EQU   ZZ2AF+1                                                  03913000
@NM00021 EQU   ZZ2AF+1                                                  03914000
ZZ2AFC   EQU   ZZ2AF+1                                                  03915000
@NM00020 EQU   ZZ2AF                                                    03916000
ZZ2AFFS  EQU   ZZ2AF                                                    03917000
ZZ2AFT   EQU   ZZ2AF                                                    03918000
ZZ2AFP   EQU   ZZ2AF                                                    03919000
@NM00019 EQU   ZZ2A+8                                                   03920000
ZZ2ALINE EQU   ZZ2A+4                                                   03921000
@NM00018 EQU   ZZ2A+3                                                   03922000
ZZ2ASE   EQU   ZZ2A+2                                                   03923000
ZZ2ACH   EQU   ZZ2A                                                     03924000
@NM00017 EQU   ZZ2+264                                                  03925000
@NM00016 EQU   ZZ2+263                                                  03926000
ZZ2PRTT0 EQU   ZZ2PRTT                                                  03927000
ZZ2PRTO  EQU   ZZ2PRT+2                                                 03928000
ZZ2PRTL  EQU   ZZ2PRT                                                   03929000
@NM00015 EQU   ZZ2AMD+56                                                03930000
ZZ2AMDXP EQU   ZZ2AMD+52                                                03931000
ZZ2AMDD  EQU   ZZ2AMD+48                                                03932000
ZZ2AMDL  EQU   ZZ2AMD+44                                                03933000
ZZ2AMDU  EQU   ZZ2AMD+28                                                03934000
ZZ2AMDF  EQU   ZZ2AMD+24                                                03935000
ZZ2AMDS  EQU   ZZ2AMD+20                                                03936000
ZZ2AMDC  EQU   ZZ2AMD+16                                                03937000
ZZ2AMDP  EQU   ZZ2AMD+12                                                03938000
ZZ2AMDB  EQU   ZZ2AMD+8                                                 03939000
@NM00014 EQU   @NM00013                                                 03940000
ZZ2AMD2  EQU   @NM00013                                                 03941000
ZZ2AMD1  EQU   @NM00013                                                 03942000
ZZ2AMD0  EQU   ZZ2AMD+6                                                 03943000
ZZ2AMDA  EQU   ZZ2AMD+4                                                 03944000
ZZ2AMDT  EQU   ZZ2AMD                                                   03945000
ZZ199999 EQU   ZZ1+3072                                                 03946000
@NM00012 EQU   ZZ1+2160                                                 03947000
ZZ1TRTAS EQU   ZZ1+1904                                                 03948000
ZZ1TRUPC EQU   ZZ1+1648                                                 03949000
ZZ1TRCTX EQU   ZZ1+1392                                                 03950000
ZZ1NASID EQU   ZZ1N+274                                                 03951000
ZZ1NSTRL EQU   ZZ1N+272                                                 03952000
ZZ1NOFF  EQU   ZZ1N+268                                                 03953000
ZZ1NBDY  EQU   ZZ1N+264                                                 03954000
ZZ1NADE  EQU   ZZ1N+260                                                 03955000
ZZ1NADB  EQU   ZZ1N+256                                                 03956000
ZZ1NSTR  EQU   ZZ1N                                                     03957000
@NM00011 EQU   ZZ1+1080                                                 03958000
ZZ1TREBC EQU   ZZ1+824                                                  03959000
ZZ1TRHEX EQU   ZZ1+568                                                  03960000
@NM00010 EQU   ZZ1+377                                                  03961000
ZZ1USTAE EQU   ZZ1+376                                                  03962000
@NM00009 EQU   ZZ1F+1                                                   03963000
@NM00008 EQU   ZZ1F                                                     03964000
ZZ1FM    EQU   ZZ1F                                                     03965000
ZZ1FX    EQU   ZZ1F                                                     03966000
ZZ1FU    EQU   ZZ1F                                                     03967000
ZZ1EVEC  EQU   ZZ1EVE+1                                                 03968000
@NM00007 EQU   ZZ1EVE                                                   03969000
ZZ1EVEP  EQU   ZZ1EVE                                                   03970000
ZZ1EVEW  EQU   ZZ1EVE                                                   03971000
ZZ1ACMP  EQU   ZZ1ATTN                                                  03972000
@NM00006 EQU   ZZ1+144                                                  03973000
ZZ1ZZ6P  EQU   ZZ1+136                                                  03974000
@NM00005 EQU   ZZ1+84                                                   03975000
ZZ1PLINE EQU   ZZ1+80                                                   03976000
ZZ1PGSZ  EQU   ZZ1+76                                                   03977000
ZZ1PCNT  EQU   ZZ1+72                                                   03978000
@NM00004 EQU   ZZ1+68                                                   03979000
ZZ1TPAGE EQU   ZZ1+64                                                   03980000
ZZ1TLINE EQU   ZZ1+60                                                   03981000
@NM00003 EQU   ZZ1+52                                                   03982000
ZZ1DMCBP EQU   ZZ1+48                                                   03983000
ZZ1DSDP  EQU   ZZ1+44                                                   03984000
ZZ1327WP EQU   ZZ1+32                                                   03985000
ZZ1ACBP  EQU   ZZ1+28                                                   03986000
@NM00002 EQU   ZZ1+24                                                   03987000
ZZ1PDCBP EQU   ZZ1+20                                                   03988000
ZZ1BLRBL EQU   ZZ1+16                                                   03989000
@NM00001 EQU   ZZ1+12                                                   03990000
ZZ1PNULL EQU   ZZ1+8                                                    03991000
ZZ1NULL  EQU   ZZ1+4                                                    03992000
ZZ1IDE   EQU   ZZ1                                                      03993000
*                                      END UNREFERENCED COMPONENTS      03994000
@RC00518 EQU   @EL00002                                                 03995000
@RC00605 EQU   @EL00005                                                 03996000
@RC00700 EQU   @EL00007                                                 03997000
@RC00867 EQU   @RC00865                                                 03998000
@RC00962 EQU   @RC00959                                                 03999000
@RC00898 EQU   @RC00867                                                 04000000
@ENDDATA EQU   *                                                        04001000
         END   BLSEMDPR,(C'PLS1123',0701,78066)                         04002000
