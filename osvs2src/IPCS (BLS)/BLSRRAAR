RAAR     TITLE 'BLSRRAAR--ADD OR REPLACE AN ADDRESS SPACE RECORD       *00001000
                        '                                               00002000
*/* CHANGE ACTIVITY -------------------------------------------------*/ 00003000
*/*   THIS MODULE WAS WRITTEN FOR @G57LPRW                           */ 00004000
*/*------------------------------------------------------------------*/ 00005000
BLSRRAAR CSECT ,                                                01S0002 00006000
@MAINENT DS    0H                                               01S0002 00007000
         USING *,@15                                            01S0002 00008000
         B     @PROLOG                                          01S0002 00009000
         DC    AL1(16)                                          01S0002 00010000
         DC    C'BLSRRAAR  78.160'                              01S0002 00011000
         DROP  @15                                                      00012000
@PROLOG  STM   @14,@12,12(@13)                                  01S0002 00013000
         BALR  @12,0                                            01S0002 00014000
@PSTART  DS    0H                                               01S0002 00015000
         USING @PSTART,@12                                      01S0002 00016000
         L     @00,@SIZDATD                                     01S0002 00017000
         BLSUALLS R,LV=(0)                                              00018000
         LR    @11,@01                                          01S0002 00019000
         LA    @10,4095(,@11)                                   01S0002 00020000
         USING @DATD,@11                                        01S0002 00021000
         USING @DATD+4095,@10                                   01S0002 00022000
         ST    @13,@SA00001+4                                   01S0002 00023000
         LM    @00,@01,20(@13)                                  01S0002 00024000
         ST    @11,8(,@13)                                      01S0002 00025000
         LR    @13,@11                                          01S0002 00026000
         MVC   @PC00001(8),0(@01)                               01S0002 00027000
*                                                               01S0140 00028000
*/*------------------------------------------------------------------*/ 00029000
*/* BLSRRAAR--ADD OR REPLACE AN ADDRESS SPACE RECORD                 */ 00030000
*/*------------------------------------------------------------------*/ 00031000
*                                                               01S0141 00032000
*                                                               02S0141 00033000
*/*------------------------------------------------------------------*/ 00034000
*/* BLSRRA01--BLSRRAAR INITIALIZATION                                */ 00035000
*/*------------------------------------------------------------------*/ 00036000
*                                                               02S0141 00037000
*   FLAG='00'X;                     /* PROCESSING CONTROL FLAGS      */ 00038000
         MVI   FLAG,X'00'                                       02S0141 00039000
         SPACE 1                                                        00040000
*                                                               02S0142 00041000
*/*------------------------------------------------------------------*/ 00042000
*/* INTERMEDIATE--OCCASIONALLY CONFLICTS WILL BE DETECTED DURING     */ 00043000
*/* MERGE PROCESSING WHICH MUST BE RESOLVED BY GENERATING SEVERAL    */ 00044000
*/* RECORD ENTRIES FROM A SINGLE INPUT ENTRY. IN THIS CASE AN        */ 00045000
*/* ADDITIONAL BUFFER, RABA, WILL BE ALLOCATED AND USED TO BUFFER    */ 00046000
*/* SOME OF THE ENTRIES PRODUCED. IF NO CONFLICTS ARISE DURING MERGE */ 00047000
*/* PROCESSING, NO ALLOCATION WILL TAKE PLACE.                       */ 00048000
*/*------------------------------------------------------------------*/ 00049000
*                                                               02S0142 00050000
*   RABAP=ZZZZNULL;                 /* RABA NOT ALLOCATED            */ 00051000
         SLR   @08,@08                                          02S0142 00052000
         ST    @08,RABAP                                        02S0142 00053000
         SPACE 1                                                        00054000
*                                                               02S0143 00055000
*/*------------------------------------------------------------------*/ 00056000
*/* INPUT 1--INITIALIZE RELATIVE TO THE ADDRESS SPACE PARAMETER      */ 00057000
*/* RECORD, RAPA. THIS RECORD SUPPLIES INFORMATION JUST GATHERED     */ 00058000
*/* REGARDING THE TOPOLOGY OF AN ADDRESS SPACE CONTAINED IN A DATA   */ 00059000
*/* SET ON DIRECT ACCESS STORAGE. FOR EXAMPLE, A SEGMENT TABLE       */ 00060000
*/* DESCRIBING NUMEROUS INVALID SEGMENTS MAY HAVE BEEN RETRIEVED     */ 00061000
*/* FROM A SYSTEM/370 DUMP.                                          */ 00062000
*/*------------------------------------------------------------------*/ 00063000
*                                                               02S0143 00064000
*   RAMEUSE=RAPAUSE;                /* ENTRIES IN USE                */ 00065000
         L     @15,@PC00001+4                                   02S0143 00066000
         LH    @15,RAPAUSE(,@15)                                02S0143 00067000
         STH   @15,RAMEUSE                                      02S0143 00068000
*   IF                              /* ABSURD INPUT RECORD           */ 00069000
*       RAMEUSE=0|                  /* NO ENTRIES IN USE             */ 00070000
*       RAMEUSE>RAPAHDI THEN        /* EXCESSIVE ENTRIES IN USE      */ 00071000
         CR    @15,@08                                          02S0144 00072000
         BE    @RT00144                                         02S0144 00073000
         CH    @15,@CH00191                                     02S0144 00074000
         BH    @RT00144                                         02S0144 00075000
*     GO TO ERREXIT;                /* ERROR EXIT                    */ 00076000
*   DO J1=RAMEUSE TO 1 BY-1;        /* VERIFY PARAMETER RECORD       */ 00077000
         LR    J1,@15                                           02S0146 00078000
         B     @DE00146                                         02S0146 00079000
@DL00146 DS    0H                                               02S0147 00080000
*     RAMER(JL)=RAPAR(J1);          /* COPY CURRENT ENTRY            */ 00081000
         LR    @08,J1                                           02S0147 00082000
         SLL   @08,5                                            02S0147 00083000
         L     @03,@PC00001+4                                   02S0147 00084000
         ALR   @03,@08                                          02S0147 00085000
         MVC   RAMER(32),RAPAR-32(@03)                          02S0147 00086000
*     IF                            /* PARAMETER RECORD ERROR        */ 00087000
*         (J1<RAMEUSE&RAMERIA(JL)>=RAMERIA(JH))|/* OUT OF ORDER      */ 00088000
*         RAMERLE(JL)=0|            /* ABSURD DATA LENGTH            */ 00089000
*         RAPARNM(JL)=0 THEN        /* ABSURD NUMBER OF RECORDS      */ 00090000
         LH    @08,RAMEUSE                                      02S0148 00091000
         CLR   J1,@08                                           02S0148 00092000
         BNL   @GL00003                                         02S0148 00093000
         CLC   RAMERIA(4),RAMERIA+32                            02S0148 00094000
         BNL   @RT00148                                         02S0148 00095000
@GL00003 SLR   @08,@08                                          02S0148 00096000
         CL    @08,RAMERLE                                      02S0148 00097000
         BE    @RT00148                                         02S0148 00098000
         L     @03,@PC00001+4                                   02S0148 00099000
         CH    @08,RAPARNM(,@03)                                02S0148 00100000
         BE    @RT00148                                         02S0148 00101000
*       GO TO ERREXIT;              /* ERROR EXIT                    */ 00102000
*     RAMER(JH)=RAMER(JL);          /* CURRENT ENTRY=>NEXT ENTRY     */ 00103000
         MVC   RAMER+32(32),RAMER                               02S0150 00104000
*   END;                            /* VERIFY PARAMETER RECORD       */ 00105000
         BCTR  J1,0                                             02S0151 00106000
@DE00146 CL    J1,@CF00047                                      02S0151 00107000
         BNL   @DL00146                                         02S0151 00108000
         SPACE 1                                                        00109000
*                                                               02S0152 00110000
*/*------------------------------------------------------------------*/ 00111000
*/* INPUT 2--ONE OR MORE ADDRESS SPACE RECORDS FOR THIS ADDRESS      */ 00112000
*/* SPACE MAY ALREADY BE STORED IN THE VSAM DEBUG CLUSTER. THE       */ 00113000
*/* EXISTING INFORMATION MUST BE MERGED WITH THAT JUST GATHERED TO   */ 00114000
*/* OBTAIN A COMPACT, CONSISTENT DESCRIPTION OF THE TOPOLOGY OF THE  */ 00115000
*/* ADDRESS SPACE                                                    */ 00116000
*/*------------------------------------------------------------------*/ 00117000
*                                                               02S0152 00118000
*   RAUP(1:RAUPLRL)=RACO(1:RACOLRL);/* INITIALIZE ADDITION BUFFER    */ 00119000
         L     @08,ZZ2RASYP(,R9)                                02S0152 00120000
         MVC   RAUP(148),RACO(@08)                              02S0152 00121000
*   RAUPRDX=ZZ6DRDX;                /* DATA SET INDEX                */ 00122000
         L     @08,ZZ2AZZ6P(,R9)                                02S0153 00123000
         MVC   RAUPRDX(4),ZZ6DRDX(@08)                          02S0153 00124000
*   RAUPAS=RAPAAS;                  /* ADDRESS SPACE                 */ 00125000
         L     @08,@PC00001+4                                   02S0154 00126000
         MVC   RAUPAS(16),RAPAAS(@08)                           02S0154 00127000
*   RESPECIFY                                                   02S0155 00128000
*    (R6,                           /* RECORD LENGTH                 */ 00129000
*     R7,                           /* ->ACB                         */ 00130000
*     R8) RESTRICTED;               /* KEY LENGTH                    */ 00131000
*   R6=ZZZVSHRL;                    /* RECORD LENGTH                 */ 00132000
         LA    R6,3072                                          02S0156 00133000
*   R7=ZZ1ACBP;                     /* ->ACB                         */ 00134000
         L     @01,ZZ2ZZ1P(,R9)                                 02S0157 00135000
         L     R7,ZZ1ACBP(,@01)                                 02S0157 00136000
*   R8=RAUPLKL;                     /* KEY LENGTH                    */ 00137000
         LA    R8,32                                            02S0158 00138000
*   GENERATE SETS(GENPRMU) CODE;                                02S0159 00139000
*/*-------------------------------------------------------------------* 00140000
*   CREATE AN RPL FOR UPDATE PROCESSING                               * 00141000
*---------------------------------------------------------------------* 00142000
         GENCB BLK=RPL,WAREA=(S,MYRPLU),ACB=(R7),AREA=(S,RAUP),        *00143000
               AREALEN=(R6),ARG=(S,RAUP),OPTCD=(SEQ,MVE,GEN,KGE,UPD),  *00144000
               LENGTH=256,KEYLEN=(R8),MF=(L,GENPRMU,GENPRMUL) */        00145000
*   RESPECIFY                                                   02S0160 00146000
*    (R6,                           /* RECORD LENGTH                 */ 00147000
*     R8) UNRESTRICTED;             /* KEY LENGTH                    */ 00148000
*   RESPECIFY                                                   02S0161 00149000
*    (RF) RESTRICTED;               /* BLSUVSCR RETURN CODE          */ 00150000
*   CALL BLSUVSCR(ZZ2,GENPRMU);     /* CREATE AN RPL FOR UPDATE      */ 00151000
         ST    R9,@AL00001                                      02S0162 00152000
         LA    @14,GENPRMU                                      02S0162 00153000
         ST    @14,@AL00001+4                                   02S0162 00154000
         L     @08,ZZ2BVTP(,R9)                                 02S0162 00155000
         L     @15,BVTVSCRP(,@08)                               02S0162 00156000
         LA    @01,@AL00001                                     02S0162 00157000
         BALR  @14,@15                                          02S0162 00158000
*   IF RF^=ZZZFLAGI THEN            /* BLSUVSCR DETECTED AN ERROR    */ 00159000
         SLR   @14,@14                                          02S0163 00160000
         CR    RF,@14                                           02S0163 00161000
         BNE   @RT00163                                         02S0163 00162000
*     GO TO ERREXIT;                /* ERROR EXIT                    */ 00163000
*   RESPECIFY                                                   02S0165 00164000
*    (RF) UNRESTRICTED;             /* BLSUVSCR RETURN CODE          */ 00165000
         SPACE 1                                                        00166000
*                                                               02S0166 00167000
*/*------------------------------------------------------------------*/ 00168000
*/* INTERMEDIATE--ONE ADDRESS SPACE RECORD IMAGE, RAME, IS UTILIZED  */ 00169000
*/* TO MERGE THE INFORMATION OBTAINED FROM INPUT 1 AND INPUT 2.      */ 00170000
*/* CONFLICTING INFORMATION IS EXPECTED REGARDING THE TOPOLOGY OF    */ 00171000
*/* ADDRESS SPACES IN SOME CIRCUMSTANCES. FOR EXAMPLE,               */ 00172000
*/* (1) AMASADMP ATTEMPTS TO RETRIEVE SOME STORAGE FROM PAGE DATA    */ 00173000
*/*     SETS TO AUGMENT THE INFORMATION OBTAINED FROM MAIN STORAGE.  */ 00174000
*/*     SUCH PAGES ARE, OF COURSE, DESCRIBED AS BEING INVALID IN     */ 00175000
*/*     THE APPLICABLE PAGE OR SEGMENT TABLES IN MAIN STORAGE.       */ 00176000
*/* (2) MVS REAL STORAGE MANAGEMENT SUPPORTS A PROCESS KNOWN AS      */ 00177000
*/*     RECLAIM WHERE A PAGE TABLE ENTRY IS MARKED INVALID BUT THE   */ 00178000
*/*     CONTENTS OF A REAL STORAGE FRAME STILL REFLECT THAT PAGE.    */ 00179000
*/* (3) MVS SDUMP WILL DUMP THE PAGE(S) CONTAINING THE CVT IF A DUMP */ 00180000
*/*     OF THE NUCLEUS IS ALSO REQUESTED.                            */ 00181000
*/*------------------------------------------------------------------*/ 00182000
*/* CONFLICTS ARE RESOLVED BY PREFERRING TO RETAIN:                  */ 00183000
*/* (1) INFORMATION DESCRIBING AVAILABLE STORAGE RATHER THAN         */ 00184000
*/*     INFORMATION ASSERTING THAT THE STORAGE IS NOT AVAILABLE      */ 00185000
*/* (2) INFORMATION DESCRIBING AVAILABLE STORAGE AT A LOWER ADDRESS  */ 00186000
*/*     IN THE DATA SET THAN ANOTHER AVAILABLE SOURCE OF THE DATA.   */ 00187000
*/*------------------------------------------------------------------*/ 00188000
*                                                               02S0166 00189000
*   RAME(1:RAMELRL)=RAUP(1:RAUPLRL);/* INITIALIZE MERGE BUFFER       */ 00190000
         MVC   RAME(148),RAUP                                   02S0166 00191000
*   RAMEUSE=0;                      /* INITIALIZE RAME               */ 00192000
         STH   @14,RAMEUSE                                      02S0167 00193000
         SPACE 1                                                        00194000
*                                                               02S0168 00195000
*/*------------------------------------------------------------------*/ 00196000
*/* OUTPUT--ONE ADDRESS SPACE RECORD IMAGE, RAAD, IS USED TO         */ 00197000
*/* CONSTRUCT OUTPUT RECORDS, ONE AT A TIME. ENTRIES ARE OBTAINED    */ 00198000
*/* FROM THE INTERMEDIATE MERGE BUFFER AS SOON AS THEY ARE           */ 00199000
*/* COMPLETE--CANNOT BE EXTENDED TO DESCRIBE A LARGER PART OF WHAT   */ 00200000
*/* IS KNOWN ABOUT THE ADDRESS SPACE.                                */ 00201000
*/*------------------------------------------------------------------*/ 00202000
*                                                               02S0168 00203000
*   RAAD(1:RAADLRL)=RAME(1:RAMELRL);/* INITIALIZE RAAD               */ 00204000
         MVC   RAAD(148),RAME                                   02S0168 00205000
*   RESPECIFY                                                   02S0169 00206000
*    (R6) RESTRICTED;               /* RECORD LENGTH                 */ 00207000
*   R6=RAADHRL;                     /* MAXIMUM RECORD LENGTH         */ 00208000
         LA    R6,3060                                          02S0170 00209000
*   GENERATE SETS(GENPRMA) CODE;                                02S0171 00210000
*/*-------------------------------------------------------------------* 00211000
*   CREATE AN RPL TO WRITE THE CONTENTS OF A FULL ADDITION BUFFER     * 00212000
*---------------------------------------------------------------------* 00213000
         GENCB BLK=RPL,WAREA=(S,MYRPLA),ACB=(R7),AREA=(S,RAAD),        *00214000
               OPTCD=(DIR,MVE,NUP),RECLEN=(R6),LENGTH=256,             *00215000
               MF=(L,GENPRMA,GENPRMAL) */                               00216000
*   RESPECIFY                                                   02S0172 00217000
*    (R6,                           /* RECORD LENGTH                 */ 00218000
*     R7) UNRESTRICTED;             /* ->ACB                         */ 00219000
*   RESPECIFY                                                   02S0173 00220000
*    (RF) RESTRICTED;               /* BLSUVSCR RETURN CODE          */ 00221000
*   CALL BLSUVSCR(ZZ2,GENPRMA);     /* CREATE AN RPL FOR ADDITION    */ 00222000
         ST    R9,@AL00001                                      02S0174 00223000
         LA    @14,GENPRMA                                      02S0174 00224000
         ST    @14,@AL00001+4                                   02S0174 00225000
         L     @08,ZZ2BVTP(,R9)                                 02S0174 00226000
         L     @15,BVTVSCRP(,@08)                               02S0174 00227000
         LA    @01,@AL00001                                     02S0174 00228000
         BALR  @14,@15                                          02S0174 00229000
*   IF RF^=ZZZFLAGI THEN            /* BLSUVSCR DETECTED AN ERROR    */ 00230000
         LTR   RF,RF                                            02S0175 00231000
         BNZ   @RT00175                                         02S0175 00232000
*     GO TO ERREXIT;                /* ERROR EXIT                    */ 00233000
*   RESPECIFY                                                   02S0177 00234000
*    (RF) UNRESTRICTED;             /* BLSUVSCR RETURN CODE          */ 00235000
*                                                               02S0178 00236000
*/*------------------------------------------------------------------*/ 00237000
*/* BLSRRA02--BLSRRAAR MERGE PROCESSING                              */ 00238000
*/*------------------------------------------------------------------*/ 00239000
*/* ITERATIVELY PROCESS ADDRESS SPACE RECORDS UNTIL:                 */ 00240000
*/* (1) THE INFORMATION ABOUT THE ADDRESS SPACE WHICH WAS SPECIFIED  */ 00241000
*/*     BY THE CALLER HAS BEEN MERGED WITH WHAT WAS ALREADY KNOWN    */ 00242000
*/*     AND                                                          */ 00243000
*/* (2) THE DESCRIPTION OF THE ADDRESS SPACE IS LEFT-JUSTIFIED IN A  */ 00244000
*/*     MINIMUM NUMBER OF ADDRESS SPACE RECORDS                      */ 00245000
*/*------------------------------------------------------------------*/ 00246000
*                                                               02S0178 00247000
*   JP=1;                           /* PARAMETER RECORD INDEX        */ 00248000
         MVC   JP(4),@CF00047                                   02S0178 00249000
*   JU=0;                           /* UPDATE RECORD INDEX           */ 00250000
         SLR   JU,JU                                            02S0179 00251000
*   PL=ZZZZNULL;                    /* ->BYTE AFTER LOW ENTRY        */ 00252000
         SLR   PL,PL                                            02S0180 00253000
*   PH=ZZZZNULL;                    /* ->BYTE AFTER HIGH ENTRY       */ 00254000
         SLR   PH,PH                                            02S0181 00255000
*   DO WHILE(                       /* PROCESS RA RECORDS            */ 00256000
*         FLAGERR=ZZZ0&             /* NO PROCESSING ERRORS          */ 00257000
*         (JP^=0|                   /* PARAMETER ENTRIES REMAIN      */ 00258000
*         FLAGEOF=ZZZ0|             /* EXISTING ENTRIES REMAIN       */ 00259000
*         RAMEUSE>JL|               /* INTERMEDIATE ENTRIES REMAIN   */ 00260000
*         (RABAP^=ZZZZNULL&         /* RABA HAS BEEN ALLOCATED       */ 00261000
*         RABAUSE^=0)));            /* ENTRIES REMAIN IN RABA        */ 00262000
         B     @DE00182                                         02S0182 00263000
@DL00182 DS    0H                                               02S0183 00264000
*                                                               03S0183 00265000
*/*------------------------------------------------------------------*/ 00266000
*/* BLSRRA03--READ EXISTING RECORD                                   */ 00267000
*/*------------------------------------------------------------------*/ 00268000
*                                                               03S0183 00269000
*   IF FLAGEOF=ZZZ0&JU=0 THEN       /* READ EXISTING RECORD          */ 00270000
*                                                               03S0183 00271000
         TM    FLAGEOF,B'10000000'                              03S0183 00272000
         BNZ   @RF00183                                         03S0183 00273000
         SLR   @15,@15                                          03S0183 00274000
         CLR   JU,@15                                           03S0183 00275000
         BNE   @RF00183                                         03S0183 00276000
*     /***************************************************************/ 00277000
*     /*                                                             */ 00278000
*     /* READ EXISTING RECORD                                        */ 00279000
*     /*                                                             */ 00280000
*     /***************************************************************/ 00281000
*                                                               03S0184 00282000
*     DO;                           /* READ EXISTING RECORD          */ 00283000
*       RESPECIFY                                               03S0185 00284000
*        (RF) RESTRICTED;           /* RETURN CODES                  */ 00285000
*       IF FLAGSCAN=ZZZ0 THEN       /* SEQUENTIAL SCAN INACTIVE      */ 00286000
*                                                               03S0186 00287000
         TM    FLAGSCAN,B'00100000'                             03S0186 00288000
         BNZ   @RF00186                                         03S0186 00289000
*         /***********************************************************/ 00290000
*         /*                                                         */ 00291000
*         /* SEQUENTIAL SCAN INACTIVE                                */ 00292000
*         /*                                                         */ 00293000
*         /***********************************************************/ 00294000
*                                                               03S0187 00295000
*         DO;                       /* SEQUENTIAL SCAN INACTIVE      */ 00296000
*           FLAGSCAN=ZZZ1;          /* SEQUENTIAL SCAN ACTIVE        */ 00297000
         OI    FLAGSCAN,B'00100000'                             03S0188 00298000
*           IF RAADFAD=ZZZZNULL THEN/* FIRST EXISTING RECORD         */ 00299000
         SLR   @14,@14                                          03S0189 00300000
         CL    @14,RAADFAD                                      03S0189 00301000
         BNE   @RF00189                                         03S0189 00302000
*             IF RAPARIA(1)>ZZZZNULL THEN/* NEW DATA IN MIDDLE OF       00303000
*                                      SPACE                         */ 00304000
         L     @05,@PC00001+4                                   03S0190 00305000
         L     @05,RAPARIA(,@05)                                03S0190 00306000
         CLR   @05,@14                                          03S0190 00307000
         BNH   @RF00190                                         03S0190 00308000
*               RAUPFAD=RAPARIA(1)-1;/* ->PORTION OF ADDRESS SPACE   */ 00309000
         BCTR  @05,0                                            03S0191 00310000
         ST    @05,RAUPFAD                                      03S0191 00311000
*             ELSE                  /* NEW DATA BEGINS SPACE         */ 00312000
*               RAUPFAD=ZZZZNULL;   /* ->ORIGIN OF ADDRESS SPACE     */ 00313000
         B     @RC00190                                         03S0192 00314000
@RF00190 SLR   @14,@14                                          03S0192 00315000
         ST    @14,RAUPFAD                                      03S0192 00316000
*           ELSE                    /* 2ND, 3RD, ... EXISTING RECORD */ 00317000
*             RAUPFAD=RAADFAD+1;    /* ->PORTION OF ADDRESS SPACE    */ 00318000
         B     @RC00189                                         03S0193 00319000
@RF00189 LA    @14,1                                            03S0193 00320000
         AL    @14,RAADFAD                                      03S0193 00321000
         ST    @14,RAUPFAD                                      03S0193 00322000
*           CALL BLSUVSPO(ZZ2,MYRPLU);/* INDICATE SCAN ORIGIN        */ 00323000
@RC00189 ST    R9,@AL00001                                      03S0194 00324000
         LA    @14,MYRPLU                                       03S0194 00325000
         ST    @14,@AL00001+4                                   03S0194 00326000
         L     @01,ZZ2BVTP(,R9)                                 03S0194 00327000
         L     @15,BVTVSPOP(,@01)                               03S0194 00328000
         LA    @01,@AL00001                                     03S0194 00329000
         BALR  @14,@15                                          03S0194 00330000
*           IF RF^=ZZZFLAGI THEN    /* POINT OPERATION FAILED        */ 00331000
*                                                               03S0195 00332000
         LTR   RF,RF                                            03S0195 00333000
         BZ    @RF00195                                         03S0195 00334000
*             /*******************************************************/ 00335000
*             /*                                                     */ 00336000
*             /* POINT OPERATION FAILED                              */ 00337000
*             /*                                                     */ 00338000
*             /*******************************************************/ 00339000
*                                                               03S0196 00340000
*             DO;                   /* POINT OPERATION FAILED        */ 00341000
*               FLAGEOF=ZZZ1;       /* ALL EXISTING RECORDS READ     */ 00342000
*               FLAGERR=ZZZ1;       /* AN ERROR HAS BEEN DETECTED    */ 00343000
         OI    FLAGEOF,B'11000000'                              03S0198 00344000
*               GO TO L020;         /* ABORT PROCESSING LOOP         */ 00345000
         B     L020                                             03S0199 00346000
*             END;                  /* POINT OPERATION FAILED        */ 00347000
*         END;                      /* SEQUENTIAL SCAN INACTIVE      */ 00348000
*       ELSE                        /* ERASE RECORD HELD FOR UPDATE  */ 00349000
*                                                               03S0202 00350000
*         /***********************************************************/ 00351000
*         /*                                                         */ 00352000
*         /* ERASE RECORD HELD FOR UPDATE. THE INFORMATION FROM IT   */ 00353000
*         /* WILL BE RECORDED IN ONE OR MORE NEW RECORDS             */ 00354000
*         /*                                                         */ 00355000
*         /***********************************************************/ 00356000
*                                                               03S0202 00357000
*         DO;                       /* ERASE RECORD HELD FOR UPDATE  */ 00358000
         B     @RC00186                                         03S0202 00359000
@RF00186 DS    0H                                               03S0203 00360000
*           CALL BLSUVSER(ZZ2,MYRPLU);/* ERASE RAUP                  */ 00361000
         ST    R9,@AL00001                                      03S0203 00362000
         LA    @14,MYRPLU                                       03S0203 00363000
         ST    @14,@AL00001+4                                   03S0203 00364000
         L     @01,ZZ2BVTP(,R9)                                 03S0203 00365000
         L     @15,BVTVSERP(,@01)                               03S0203 00366000
         LA    @01,@AL00001                                     03S0203 00367000
         BALR  @14,@15                                          03S0203 00368000
*           IF RF^=ZZZFLAGI THEN    /* ERASE OPERATION FAILED        */ 00369000
*                                                               03S0204 00370000
         LTR   RF,RF                                            03S0204 00371000
         BZ    @RF00204                                         03S0204 00372000
*             /*******************************************************/ 00373000
*             /*                                                     */ 00374000
*             /* ERASE OPERATION FAILED                              */ 00375000
*             /*                                                     */ 00376000
*             /*******************************************************/ 00377000
*                                                               03S0205 00378000
*             DO;                   /* ERASE OPERATION FAILED        */ 00379000
*               FLAGEOF=ZZZ1;       /* ALL EXISTING RECORDS READ     */ 00380000
*               FLAGERR=ZZZ1;       /* AN ERROR HAS BEEN DETECTED    */ 00381000
         OI    FLAGEOF,B'11000000'                              03S0207 00382000
*             END;                  /* ERASE OPERATION FAILED        */ 00383000
*         END;                      /* ERASE RECORD HELD FOR UPDATE  */ 00384000
@RF00204 DS    0H                                               03S0210 00385000
*       IF FLAGEOF=ZZZ0 THEN        /* READ EXISTING DATA            */ 00386000
*                                                               03S0210 00387000
@RC00186 TM    FLAGEOF,B'10000000'                              03S0210 00388000
         BNZ   @RF00210                                         03S0210 00389000
*         /***********************************************************/ 00390000
*         /*                                                         */ 00391000
*         /* READ EXISTING DATA                                      */ 00392000
*         /*                                                         */ 00393000
*         /***********************************************************/ 00394000
*                                                               03S0211 00395000
*         DO;                       /* READ EXISTING DATA            */ 00396000
*           CALL BLSUVSGU(ZZ2,MYRPLU);/* RETRIEVE NEXT RECORD        */ 00397000
         ST    R9,@AL00001                                      03S0212 00398000
         LA    @14,MYRPLU                                       03S0212 00399000
         ST    @14,@AL00001+4                                   03S0212 00400000
         L     @01,ZZ2BVTP(,R9)                                 03S0212 00401000
         L     @15,BVTVSGUP(,@01)                               03S0212 00402000
         LA    @01,@AL00001                                     03S0212 00403000
         BALR  @14,@15                                          03S0212 00404000
*           IF RF^=ZZZFLAGI THEN    /* NO RECORD READ                */ 00405000
*                                                               03S0213 00406000
         LTR   RF,RF                                            03S0213 00407000
         BZ    @RF00213                                         03S0213 00408000
*             /*******************************************************/ 00409000
*             /*                                                     */ 00410000
*             /* NO RECORD READ                                      */ 00411000
*             /*                                                     */ 00412000
*             /*******************************************************/ 00413000
*                                                               03S0214 00414000
*             DO;                   /* NO RECORD READ                */ 00415000
*               FLAGEOF=ZZZ1;       /* ALL EXISTING RECORDS READ     */ 00416000
*               FLAGERR=ZZZ1;       /* AN ERROR HAS BEEN DETECTED    */ 00417000
         OI    FLAGEOF,B'11000000'                              03S0216 00418000
*               GO TO L020;         /* ABORT PROCESSING LOOP         */ 00419000
         B     L020                                             03S0217 00420000
*             END;                  /* NO RECORD READ                */ 00421000
*           ELSE                    /* RECORD READ                   */ 00422000
*             IF                    /* IRRELEVANT RECORD             */ 00423000
*                 RAUPRID^=ZZZRIDRA|/* DIFFERENT RECORD TYPE         */ 00424000
*                 RAUPAS^=RAADAS THEN/* DIFFERENT ADDRESS SPACE      */ 00425000
@RF00213 CLC   RAUPRID(2),@CC00136                              03S0219 00426000
         BNE   @RT00219                                         03S0219 00427000
         CLC   RAUPAS(16),RAADAS                                03S0219 00428000
         BE    @RF00219                                         03S0219 00429000
@RT00219 DS    0H                                               03S0220 00430000
*               FLAGEOF=ZZZ1;       /* ALL EXISTING RECORDS READ     */ 00431000
         OI    FLAGEOF,B'10000000'                              03S0220 00432000
*             ELSE                  /* PERTINENT RECORD READ         */ 00433000
*                                                               03S0221 00434000
*               /*****************************************************/ 00435000
*               /*                                                   */ 00436000
*               /* PERTINENT RECORD READ                             */ 00437000
*               /*                                                   */ 00438000
*               /*****************************************************/ 00439000
*                                                               03S0221 00440000
*               DO;                 /* PERTINENT RECORD READ         */ 00441000
         B     @RC00219                                         03S0221 00442000
@RF00219 DS    0H                                               03S0222 00443000
*                 IF RAMEUSE=0 THEN /* NO ENTRIES IN MERGE BUFFER    */ 00444000
*                                                               03S0222 00445000
         ICM   @14,3,RAMEUSE                                    03S0222 00446000
         BNZ   @RF00222                                         03S0222 00447000
*                   /*************************************************/ 00448000
*                   /*                                               */ 00449000
*                   /* QUICKLY COPY THOSE ENTRIES WHICH HAVE BEEN    */ 00450000
*                   /* READ BUT NEED NOT BE PROCESSED INDIVIDUALLY BY*/ 00451000
*                   /* THE MERGE                                     */ 00452000
*                   /*                                               */ 00453000
*                   /*************************************************/ 00454000
*                                                               03S0223 00455000
*                   DO JU=1 TO RAUPUSE-1 WHILE(RAUPRIA(JU+1)<RAPARIA(1) 00456000
*                         );        /* PROCESS DISJOINT ENTRIES      */ 00457000
         LA    JU,1                                             03S0223 00458000
         B     @DE00223                                         03S0223 00459000
@DL00223 LR    @14,JU                                           03S0223 00460000
         SLL   @14,5                                            03S0223 00461000
         L     @05,@PC00001+4                                   03S0223 00462000
         L     @04,RAUPRIA(@14)                                 03S0223 00463000
         CL    @04,RAPARIA(,@05)                                03S0223 00464000
         BNL   @DC00223                                         03S0223 00465000
*                     RAMER(JX)=RAUPR(JU);/* NEW OUTPUT ENTRY        */ 00466000
         LA    @01,RAUPR-32(@14)                                03S0224 00467000
         MVC   RAMER+64(32),0(@01)                              03S0224 00468000
*                     CALL BLSRRA11;/* PROCESS NEW OUTPUT ENTRY      */ 00469000
         BAL   @14,BLSRRA11                                     03S0225 00470000
*                   END;            /* PROCESS DISJOINT ENTRIES      */ 00471000
         AL    JU,@CF00047                                      03S0226 00472000
@DE00223 LH    @14,RAUPUSE                                      03S0226 00473000
         BCTR  @14,0                                            03S0226 00474000
         CLR   JU,@14                                           03S0226 00475000
         BNH   @DL00223                                         03S0226 00476000
@DC00223 DS    0H                                               03S0227 00477000
*                 ELSE              /* ENTRY(IES) IN MERGE BUFFER    */ 00478000
*                   JU=1;           /* UPDATE RECORD INDEX           */ 00479000
         B     @RC00222                                         03S0227 00480000
@RF00222 LA    JU,1                                             03S0227 00481000
*               END;                /* PERTINENT RECORD READ         */ 00482000
@RC00222 DS    0H                                               03S0229 00483000
*         END;                      /* READ EXISTING DATA            */ 00484000
@RC00219 DS    0H                                               03S0230 00485000
*       RESPECIFY                                               03S0230 00486000
*        (RF) UNRESTRICTED;         /* RETURN CODES                  */ 00487000
@RF00210 DS    0H                                               03S0231 00488000
*     END;                          /* READ EXISTING RECORD          */ 00489000
*                                                               03S0232 00490000
*/*------------------------------------------------------------------*/ 00491000
*/* BLSRRA04--BLSRRAAR SEGMENT TO MERGE ENTRY INTO RAME              */ 00492000
*/*------------------------------------------------------------------*/ 00493000
*                                                               03S0232 00494000
*   PB=ZZZP31P1;                    /* NO RABA ENTRY AVAILABLE       */ 00495000
@RF00183 L     @15,@CF00067                                     03S0232 00496000
         LR    PB,@15                                           03S0232 00497000
*   PP=ZZZP31P1;                    /* NO PARAMETER ENTRY AVAILABLE  */ 00498000
         LR    PP,@15                                           03S0233 00499000
*   PU=ZZZP31P1;                    /* NO UPDATE ENTRY AVAILABLE     */ 00500000
         LR    PU,@15                                           03S0234 00501000
*   IF                              /* RABA ENTRY AVAILABLE          */ 00502000
*       RABAP^=ZZZZNULL&            /* RABA HAS BEEN ALLOCATED       */ 00503000
*       RABAUSE^=0 THEN             /* RABA ENTRY AVAILABLE          */ 00504000
         L     @02,RABAP                                        03S0235 00505000
         SLR   @15,@15                                          03S0235 00506000
         CR    @02,@15                                          03S0235 00507000
         BE    @RF00235                                         03S0235 00508000
         CH    @15,RABAUSE(,@02)                                03S0235 00509000
         BE    @RF00235                                         03S0235 00510000
*     PB=RABARIA(1);                /* ->FIRST BYTE DESCRIBED        */ 00511000
         L     PB,RABARIA(,@02)                                 03S0236 00512000
*   IF JP^=0 THEN                   /* PARAMETER ENTRY AVAILABLE     */ 00513000
@RF00235 L     @02,JP                                           03S0237 00514000
         LTR   @02,@02                                          03S0237 00515000
         BZ    @RF00237                                         03S0237 00516000
*     PP=RAPARIA(JP);               /* ->FIRST BYTE DESCRIBED        */ 00517000
         SLL   @02,5                                            03S0238 00518000
         L     @15,@PC00001+4                                   03S0238 00519000
         L     PP,RAPARIA-32(@02,@15)                           03S0238 00520000
*   IF JU^=0 THEN                   /* PARAMETER ENTRY AVAILABLE     */ 00521000
@RF00237 LTR   JU,JU                                            03S0239 00522000
         BZ    @RF00239                                         03S0239 00523000
*     PU=RAUPRIA(JU);               /* ->FIRST BYTE DESCRIBED        */ 00524000
         LR    @02,JU                                           03S0240 00525000
         SLL   @02,5                                            03S0240 00526000
         L     PU,RAUPRIA-32(@02)                               03S0240 00527000
*   PX=MIN(PB,PP,PU);               /* ->FIRST BYTE DESCRIBED        */ 00528000
@RF00239 LR    PX,PP                                            03S0241 00529000
         CLR   PX,PB                                            03S0241 00530000
         BNH   *+6                                                      00531000
         LR    PX,PB                                            03S0241 00532000
         CLR   PX,PU                                            03S0241 00533000
         BNH   *+6                                                      00534000
         LR    PX,PU                                            03S0241 00535000
*   IF PX<ZZZP31P1 THEN             /* SOURCE ENTRY TO BE MERGED     */ 00536000
*                                                               03S0242 00537000
         CL    PX,@CF00067                                      03S0242 00538000
         BNL   @RF00242                                         03S0242 00539000
*     /***************************************************************/ 00540000
*     /*                                                             */ 00541000
*     /* SOURCE ENTRY TO BE MERGED                                   */ 00542000
*     /*                                                             */ 00543000
*     /***************************************************************/ 00544000
*                                                               03S0243 00545000
*     DO;                           /* SOURCE ENTRY TO BE MERGED     */ 00546000
*       FLAGSEL=ZZZ0;               /* NO ENTRY SELECTED             */ 00547000
         NI    FLAGSEL,B'11101111'                              03S0244 00548000
*       IF PU=PX THEN               /* MERGE EXISTING ENTRY          */ 00549000
*                                                               03S0245 00550000
         CLR   PU,PX                                            03S0245 00551000
         BNE   @RF00245                                         03S0245 00552000
*         /***********************************************************/ 00553000
*         /*                                                         */ 00554000
*         /* MERGE EXISTING ENTRY                                    */ 00555000
*         /*                                                         */ 00556000
*         /***********************************************************/ 00557000
*                                                               03S0246 00558000
*         DO;                       /* MERGE EXISTING ENTRY          */ 00559000
*           RAMER(JH)=RAUPR(JU);    /* HIGH ENTRY                    */ 00560000
         LR    @08,JU                                           03S0247 00561000
         SLL   @08,5                                            03S0247 00562000
         LA    @04,RAUPR-32(@08)                                03S0247 00563000
         MVC   RAMER+32(32),0(@04)                              03S0247 00564000
*           IF JU<RAUPUSE THEN      /* ANOTHER ENTRY IN THIS RECORD  */ 00565000
         LH    @08,RAUPUSE                                      03S0248 00566000
         CLR   JU,@08                                           03S0248 00567000
         BNL   @RF00248                                         03S0248 00568000
*             JU=JU+1;              /* NEXT EXISTING ENTRY INDEX     */ 00569000
         AL    JU,@CF00047                                      03S0249 00570000
*           ELSE                    /* EXISTING DATA BUFFER EXHAUSTED*/ 00571000
*                                                               03S0250 00572000
*             /*******************************************************/ 00573000
*             /*                                                     */ 00574000
*             /* EXISTING DATA BUFFER EXHAUSTED                      */ 00575000
*             /*                                                     */ 00576000
*             /*******************************************************/ 00577000
*                                                               03S0250 00578000
*             DO;                   /* EXISTING DATA BUFFER EXHAUSTED*/ 00579000
         B     @RC00248                                         03S0250 00580000
@RF00248 DS    0H                                               03S0251 00581000
*               JU=0;               /* EXISTING DATA BUFFER EXHAUSTED*/ 00582000
         SLR   JU,JU                                            03S0251 00583000
*               IF RAUPFAD=ZZZP31MX THEN/* FINAL BYTE DESCRIBED      */ 00584000
         CLC   RAUPFAD(4),@CF00127                              03S0252 00585000
         BNE   @RF00252                                         03S0252 00586000
*                 FLAGEOF=ZZZ1;     /* ALL EXISTING RECORDS READ     */ 00587000
         OI    FLAGEOF,B'10000000'                              03S0253 00588000
*             END;                  /* EXISTING DATA BUFFER EXHAUSTED*/ 00589000
@RF00252 DS    0H                                               03S0255 00590000
*           FLAGSEL=ZZZ1;           /* ENTRY SELECTED                */ 00591000
@RC00248 OI    FLAGSEL,B'00010000'                              03S0255 00592000
*         END;                      /* MERGE EXISTING ENTRY          */ 00593000
*       IF FLAGSEL=ZZZ0&PP=PX THEN  /* MERGE EXISTING ENTRY          */ 00594000
*                                                               03S0257 00595000
@RF00245 TM    FLAGSEL,B'00010000'                              03S0257 00596000
         BNZ   @RF00257                                         03S0257 00597000
         CLR   PP,PX                                            03S0257 00598000
         BNE   @RF00257                                         03S0257 00599000
*         /***********************************************************/ 00600000
*         /*                                                         */ 00601000
*         /* MERGE PARAMETER ENTRY                                   */ 00602000
*         /*                                                         */ 00603000
*         /***********************************************************/ 00604000
*                                                               03S0258 00605000
*         DO;                       /* MERGE PARAMETER ENTRY         */ 00606000
*           RAMER(JH)=RAPAR(JP);    /* HIGH ENTRY                    */ 00607000
         L     @08,JP                                           03S0259 00608000
         SLL   @08,5                                            03S0259 00609000
         L     @15,@PC00001+4                                   03S0259 00610000
         ALR   @15,@08                                          03S0259 00611000
         MVC   RAMER+32(32),RAPAR-32(@15)                       03S0259 00612000
*           IF RAMERFU(JH)=ZZZ1 THEN/* MISSING STORAGE DESCRIBED     */ 00613000
*                                                               03S0260 00614000
         TM    RAMERFU+32,B'10000000'                           03S0260 00615000
         BNO   @RF00260                                         03S0260 00616000
*             /*******************************************************/ 00617000
*             /*                                                     */ 00618000
*             /* MISSING STORAGE DESCRIBED                           */ 00619000
*             /*                                                     */ 00620000
*             /*******************************************************/ 00621000
*                                                               03S0261 00622000
*             DO;                   /* MISSING STORAGE DESCRIBED     */ 00623000
*               RAMERLE(JH)=RAMERLE(JH)*MAX(RAMERNM(JH),1);/* LENGTH */ 00624000
         LA    @08,1                                            03S0262 00625000
         LH    @15,RAMERNM+32                                   03S0262 00626000
         CR    @15,@08                                          03S0262 00627000
         BNL   *+6                                                      00628000
         LR    @15,@08                                          03S0262 00629000
         M     @14,RAMERLE+32                                   03S0262 00630000
         ST    @15,RAMERLE+32                                   03S0262 00631000
*               RAMERNM(JH)=1;      /* ONE UNIT OF MISSING STORAGE   */ 00632000
         STH   @08,RAMERNM+32                                   03S0263 00633000
*               RAMERDA(JH)=0;      /* NO DISK RECORD ADDRESS        */ 00634000
         SLR   @08,@08                                          03S0264 00635000
         ST    @08,RAMERDA+32                                   03S0264 00636000
*               RAMEROF(JH)=0;      /* NO OFFSET                     */ 00637000
         ST    @08,RAMEROF+32                                   03S0265 00638000
*             END;                  /* MISSING STORAGE DESCRIBED     */ 00639000
*           IF JP<RAPAUSE THEN      /* ANOTHER PARAMETER RECORD ENTRY*/ 00640000
@RF00260 L     @08,JP                                           03S0267 00641000
         L     @15,@PC00001+4                                   03S0267 00642000
         LH    @15,RAPAUSE(,@15)                                03S0267 00643000
         CLR   @08,@15                                          03S0267 00644000
         BNL   @RF00267                                         03S0267 00645000
*             JP=JP+1;              /* NEXT PARAMETER ENTRY INDEX    */ 00646000
         AL    @08,@CF00047                                     03S0268 00647000
         ST    @08,JP                                           03S0268 00648000
*           ELSE                    /* PARAMETER BUFFER EXHAUSTED    */ 00649000
*             JP=0;                 /* PARAMETER BUFFER EXHAUSTED    */ 00650000
         B     @RC00267                                         03S0269 00651000
@RF00267 SLR   @08,@08                                          03S0269 00652000
         ST    @08,JP                                           03S0269 00653000
*           FLAGSEL=ZZZ1;           /* ENTRY SELECTED                */ 00654000
@RC00267 OI    FLAGSEL,B'00010000'                              03S0270 00655000
*         END;                      /* MERGE PARAMETER ENTRY         */ 00656000
*       IF FLAGSEL=ZZZ0&PB=PX THEN  /* MERGE RABA ENTRY              */ 00657000
*                                                               03S0272 00658000
@RF00257 TM    FLAGSEL,B'00010000'                              03S0272 00659000
         BNZ   @RF00272                                         03S0272 00660000
         CLR   PB,PX                                            03S0272 00661000
         BNE   @RF00272                                         03S0272 00662000
*         /***********************************************************/ 00663000
*         /*                                                         */ 00664000
*         /* MERGE RABA ENTRY                                        */ 00665000
*         /*                                                         */ 00666000
*         /***********************************************************/ 00667000
*                                                               03S0273 00668000
*         DO;                       /* MERGE RABA ENTRY              */ 00669000
*           RABAP1=ADDR(RABA);      /* ->RABA (DURING MERGE)         */ 00670000
         L     RABAP1,RABAP                                     03S0274 00671000
*           RESPECIFY                                           03S0275 00672000
*             RABA BASED(RABAP1);   /* LOCAL BASE                    */ 00673000
*           RAMER(JH)=RABAR(1);     /* MERGE RABA ENTRY              */ 00674000
         MVC   RAMER+32(32),RABAR(RABAP1)                       03S0276 00675000
*           RABAUSE=RABAUSE-1;      /* ENTRIES IN USE                */ 00676000
*                                                               03S0277 00677000
         LH    @08,RABAUSE(,RABAP1)                             03S0277 00678000
         BCTR  @08,0                                            03S0277 00679000
         STH   @08,RABAUSE(,RABAP1)                             03S0277 00680000
*           /*********************************************************/ 00681000
*           /*                                                       */ 00682000
*           /* ELIMINATE SELECTED ENTRY                              */ 00683000
*           /*                                                       */ 00684000
*           /*********************************************************/ 00685000
*                                                               03S0278 00686000
*           DO J3=1 TO RABAUSE;     /* ELIMINATE SELECTED ENTRY      */ 00687000
         LA    J3,1                                             03S0278 00688000
         B     @DE00278                                         03S0278 00689000
@DL00278 DS    0H                                               03S0279 00690000
*             RABAR(J3)=RABAR(J3+1);/* BY ITERATIVE LEFT SHIFT       */ 00691000
         LR    @08,J3                                           03S0279 00692000
         SLL   @08,5                                            03S0279 00693000
         ST    @08,@TF00001                                     03S0279 00694000
         ALR   @08,RABAP1                                       03S0279 00695000
         LR    @01,RABAP1                                       03S0279 00696000
         AL    @01,@TF00001                                     03S0279 00697000
         MVC   RABAR-32(32,@08),RABAR(@01)                      03S0279 00698000
*           END;                    /* ELIMINATE SELECTED ENTRY      */ 00699000
         AL    J3,@CF00047                                      03S0280 00700000
@DE00278 LH    @08,RABAUSE(,RABAP1)                             03S0280 00701000
         CLR   J3,@08                                           03S0280 00702000
         BNH   @DL00278                                         03S0280 00703000
*           RESPECIFY                                           03S0281 00704000
*             RABA BASED(RABAP);    /* GLOBAL BASE                   */ 00705000
*         END;                      /* MERGE RABA ENTRY              */ 00706000
*       PH=                         /* ->BYTE AFTER HIGH ENTRY       */ 00707000
*           RAMERIA(JH)+RAMERLE(JH)*RAMERNM(JH);                03S0283 00708000
@RF00272 L     PH,RAMERLE+32                                    03S0283 00709000
         MH    PH,RAMERNM+32                                    03S0283 00710000
         AL    PH,RAMERIA+32                                    03S0283 00711000
*       RAMEUSE=RAMEUSE+1;          /* ENTRIES IN USE                */ 00712000
         LA    @15,1                                            03S0284 00713000
         LH    @14,RAMEUSE                                      03S0284 00714000
         ALR   @14,@15                                          03S0284 00715000
         STH   @14,RAMEUSE                                      03S0284 00716000
*       IF RAMEUSE=JL THEN          /* INITIAL ENTRY                 */ 00717000
*                                                               03S0285 00718000
         CR    @14,@15                                          03S0285 00719000
         BNE   @RF00285                                         03S0285 00720000
*         /***********************************************************/ 00721000
*         /*                                                         */ 00722000
*         /* INITIAL ENTRY                                           */ 00723000
*         /*                                                         */ 00724000
*         /***********************************************************/ 00725000
*                                                               03S0286 00726000
*         DO;                       /* INITIAL ENTRY                 */ 00727000
*           RAMER(JL)=RAMER(JH);    /* LOW ENTRY                     */ 00728000
         MVC   RAMER(32),RAMER+32                               03S0287 00729000
*           PL=PH;                  /* ->BYTE AFTER LOW ENTRY        */ 00730000
         LR    PL,PH                                            03S0288 00731000
*           GO TO L020;             /* CONTINUE MERGE PROCESSING     */ 00732000
         B     L020                                             03S0289 00733000
*         END;                      /* INITIAL ENTRY                 */ 00734000
*     END;                          /* SOURCE ENTRY TO BE MERGED     */ 00735000
@RF00285 DS    0H                                               03S0292 00736000
*                                                               03S0292 00737000
*/*------------------------------------------------------------------*/ 00738000
*/* BLSRRA05--BLSRRAAR SEGMENT TO PROCESS MISSING STORAGE CASES      */ 00739000
*/*------------------------------------------------------------------*/ 00740000
*/* IF ENTRIES ARE DISJOINT, LOW ENTRY CAN BE TRANSMITTED TO OUTPUT  */ 00741000
*/* AND MERGE PROCESSING CAN CONTINUE                                */ 00742000
*/*------------------------------------------------------------------*/ 00743000
*                                                               03S0292 00744000
*   IF PL<RAMERIA(JH) THEN          /* ENTRIES ARE DISJOINT          */ 00745000
*                                                               03S0292 00746000
@RF00242 CL    PL,RAMERIA+32                                    03S0292 00747000
         BNL   @RF00292                                         03S0292 00748000
*     /***************************************************************/ 00749000
*     /*                                                             */ 00750000
*     /* ENTRIES ARE DISJOINT                                        */ 00751000
*     /*                                                             */ 00752000
*     /***************************************************************/ 00753000
*                                                               03S0293 00754000
*     DO;                           /* ENTRIES ARE DISJOINT          */ 00755000
*       CALL BLSRRA10;              /* SEND LOW ENTRY TO OUTPUT      */ 00756000
         BAL   @14,BLSRRA10                                     03S0294 00757000
*       GO TO L020;                 /* CONTINUE MERGE PROCESSING     */ 00758000
         B     L020                                             03S0295 00759000
*     END;                          /* ENTRIES ARE DISJOINT          */ 00760000
         SPACE 1                                                        00761000
*                                                               03S0297 00762000
*/*------------------------------------------------------------------*/ 00763000
*/* PROCESS THE SITUATION WHERE LOW ENTRY DESCRIBES MISSING STORAGE  */ 00764000
*/*------------------------------------------------------------------*/ 00765000
*                                                               03S0297 00766000
*   IF RAMERFU(JL)=ZZZ1 THEN        /* LOW ENTRY=>MISSING STORAGE    */ 00767000
*                                                               03S0297 00768000
@RF00292 TM    RAMERFU,B'10000000'                              03S0297 00769000
         BNO   @RF00297                                         03S0297 00770000
*     /***************************************************************/ 00771000
*     /*                                                             */ 00772000
*     /* LOW ENTRY=>MISSING STORAGE                                  */ 00773000
*     /*                                                             */ 00774000
*     /***************************************************************/ 00775000
*                                                               03S0298 00776000
*     DO;                           /* LOW ENTRY=>MISSING STORAGE    */ 00777000
*       IF RAMERFU(JH)=ZZZ1 THEN    /* ONE MISSING STORAGE RANGE     */ 00778000
*                                                               03S0299 00779000
         TM    RAMERFU+32,B'10000000'                           03S0299 00780000
         BNO   @RF00299                                         03S0299 00781000
*         /***********************************************************/ 00782000
*         /*                                                         */ 00783000
*         /* ENTRIES DESCRIBE A SINGLE MISSING STORAGE RANGE         */ 00784000
*         /*                                                         */ 00785000
*         /***********************************************************/ 00786000
*                                                               03S0300 00787000
*         DO;                       /* ONE MISSING STORAGE RANGE     */ 00788000
*           PL=MAX(PL,PH);          /* ->BYTE AFTER LOW ENTRY        */ 00789000
         CLR   PL,PH                                            03S0301 00790000
         BNL   *+6                                                      00791000
         LR    PL,PH                                            03S0301 00792000
*           RAMERLE(JL)=PL-RAMERIA(JL);/* LENGTH                     */ 00793000
         LR    @15,PL                                           03S0302 00794000
         SL    @15,RAMERIA                                      03S0302 00795000
         ST    @15,RAMERLE                                      03S0302 00796000
*           CALL BLSRRA21;          /* DELETE THE HIGH ENTRY         */ 00797000
         BAL   @14,BLSRRA21                                     03S0303 00798000
*         END;                      /* ONE MISSING STORAGE RANGE     */ 00799000
*       ELSE                        /* HIGH ENTRY AVAILABLE          */ 00800000
*                                                               03S0305 00801000
*         /***********************************************************/ 00802000
*         /*                                                         */ 00803000
*         /* HIGH ENTRY AVAILABLE                                    */ 00804000
*         /*                                                         */ 00805000
*         /***********************************************************/ 00806000
*                                                               03S0305 00807000
*         DO;                       /* HIGH ENTRY AVAILABLE          */ 00808000
         B     @RC00299                                         03S0305 00809000
@RF00299 DS    0H                                               03S0306 00810000
*           IF PL>PH THEN           /* SPLIT LOW ENTRY               */ 00811000
*                                                               03S0306 00812000
         CLR   PL,PH                                            03S0306 00813000
         BNH   @RF00306                                         03S0306 00814000
*             /*******************************************************/ 00815000
*             /*                                                     */ 00816000
*             /* SPLIT LOW ENTRY                                     */ 00817000
*             /*                                                     */ 00818000
*             /*******************************************************/ 00819000
*                                                               03S0307 00820000
*             DO;                   /* SPLIT LOW ENTRY               */ 00821000
*               RAMER(JX)=RAMER(JL);/* NEW RABA ENTRY                */ 00822000
         MVC   RAMER+64(32),RAMER                               03S0308 00823000
*               RAMERIA(JX)=PH;     /* FIRST BYTE DESCRIBED          */ 00824000
         ST    PH,RAMERIA+64                                    03S0309 00825000
*               RAMERLE(JX)=PL-PH;  /* MISSING STORAGE LENGTH        */ 00826000
         LR    @15,PL                                           03S0310 00827000
         SLR   @15,PH                                           03S0310 00828000
         ST    @15,RAMERLE+64                                   03S0310 00829000
*               CALL BLSRRA30;      /* ADD ENTRY TO RABA             */ 00830000
         BAL   @14,BLSRRA30                                     03S0311 00831000
*             END;                  /* SPLIT LOW ENTRY               */ 00832000
*           IF RAMERIA(JL)<RAMERIA(JH) THEN/* ELIMINATE ANY OVERLAP  */ 00833000
*                                                               03S0313 00834000
@RF00306 L     @15,RAMERIA                                      03S0313 00835000
         L     @14,RAMERIA+32                                   03S0313 00836000
         CLR   @15,@14                                          03S0313 00837000
         BNL   @RF00313                                         03S0313 00838000
*             /*******************************************************/ 00839000
*             /*                                                     */ 00840000
*             /* ELIMINATE ANY OVERLAP BETWEEN ENTRIES               */ 00841000
*             /*                                                     */ 00842000
*             /*******************************************************/ 00843000
*                                                               03S0314 00844000
*             DO;                   /* ELIMINATE ANY OVERLAP         */ 00845000
*               PL=MIN(PL,RAMERIA(JH));/* ->BYTE AFTER LOW ENTRY     */ 00846000
         CLR   PL,@14                                           03S0315 00847000
         BNH   *+6                                                      00848000
         LR    PL,@14                                           03S0315 00849000
*               RAMERLE(JL)=PL-RAMERIA(JL);/* LENGTH OF DATA         */ 00850000
         LCR   @15,@15                                          03S0316 00851000
         ALR   @15,PL                                           03S0316 00852000
         ST    @15,RAMERLE                                      03S0316 00853000
*               CALL BLSRRA10;      /* SEND LOW ENTRY TO OUTPUT      */ 00854000
         BAL   @14,BLSRRA10                                     03S0317 00855000
*             END;                  /* ELIMINATE ANY OVERLAP         */ 00856000
*           ELSE                    /* LOW ENTRY NOT INTERESTING     */ 00857000
*             CALL BLSRRA20;        /* DELETE LOW ENTRY              */ 00858000
         B     @RC00313                                         03S0319 00859000
@RF00313 BAL   @14,BLSRRA20                                     03S0319 00860000
*         END;                      /* HIGH ENTRY AVAILABLE          */ 00861000
*       GO TO L020;                 /* CONTINUE MERGE PROCESSING     */ 00862000
         B     L020                                             03S0321 00863000
*     END;                          /* LOW ENTRY=>MISSING STORAGE    */ 00864000
         SPACE 1                                                        00865000
*                                                               03S0323 00866000
*/*------------------------------------------------------------------*/ 00867000
*/* PROCESS THE SITUATION WHERE THE LOW ENTRY DESCRIBES AVAILABLE    */ 00868000
*/* AND THE HIGH ENTRY DESCRIBES MISSING STORAGE                     */ 00869000
*/*------------------------------------------------------------------*/ 00870000
*                                                               03S0323 00871000
*   IF RAMERFU(JH)=ZZZ1 THEN        /* HIGH ENTRY=>MISSING STORAGE   */ 00872000
*                                                               03S0323 00873000
@RF00297 TM    RAMERFU+32,B'10000000'                           03S0323 00874000
         BNO   @RF00323                                         03S0323 00875000
*     /***************************************************************/ 00876000
*     /*                                                             */ 00877000
*     /* HIGH ENTRY DESCRIBES A MISSING STORAGE RANGE                */ 00878000
*     /*                                                             */ 00879000
*     /***************************************************************/ 00880000
*                                                               03S0324 00881000
*     DO;                           /* HIGH ENTRY=>MISSING STORAGE   */ 00882000
*       IF PL=RAMERIA(JH) THEN      /* COMPATIBLE ENTRIES            */ 00883000
*                                                               03S0325 00884000
         CL    PL,RAMERIA+32                                    03S0325 00885000
         BNE   @RF00325                                         03S0325 00886000
*         /***********************************************************/ 00887000
*         /*                                                         */ 00888000
*         /* COMPATIBLE ENTRIES                                      */ 00889000
*         /*                                                         */ 00890000
*         /***********************************************************/ 00891000
*                                                               03S0326 00892000
*         DO;                       /* COMPATIBLE ENTRIES            */ 00893000
*           CALL BLSRRA10;          /* SEND LOW ENTRY TO OUTPUT      */ 00894000
         BAL   @14,BLSRRA10                                     03S0327 00895000
*           GO TO L020;             /* CONTINUE MERGE PROCESSING     */ 00896000
         B     L020                                             03S0328 00897000
*         END;                      /* COMPATIBLE ENTRIES            */ 00898000
*       IF PL<PH THEN               /* ELIMINATE ANY OVERLAP         */ 00899000
*                                                               03S0330 00900000
@RF00325 CLR   PL,PH                                            03S0330 00901000
         BNL   @RF00330                                         03S0330 00902000
*         /***********************************************************/ 00903000
*         /*                                                         */ 00904000
*         /* ELIMINATE ANY OVERLAP                                   */ 00905000
*         /*                                                         */ 00906000
*         /***********************************************************/ 00907000
*                                                               03S0331 00908000
*         DO;                       /* ELIMINATE ANY OVERLAP         */ 00909000
*           RAMER(JX)=RAMER(JH);    /* NEW RABA ENTRY                */ 00910000
         MVC   RAMER+64(32),RAMER+32                            03S0332 00911000
*           RAMERIA(JX)=PL;         /* FIRST BYTE DESCRIBED          */ 00912000
         ST    PL,RAMERIA+64                                    03S0333 00913000
*           RAMERLE(JX)=PH-PL;      /* MISSING STORAGE LENGTH        */ 00914000
         LR    @15,PH                                           03S0334 00915000
         SLR   @15,PL                                           03S0334 00916000
         ST    @15,RAMERLE+64                                   03S0334 00917000
*           CALL BLSRRA30;          /* ADD ENTRY TO RABA             */ 00918000
         BAL   @14,BLSRRA30                                     03S0335 00919000
*         END;                      /* ELIMINATE ANY OVERLAP         */ 00920000
*       CALL BLSRRA21;              /* DELETE THE HIGH ENTRY         */ 00921000
@RF00330 BAL   @14,BLSRRA21                                     03S0337 00922000
*       GO TO L020;                 /* CONTINUE MERGE PROCESSING     */ 00923000
         B     L020                                             03S0338 00924000
*     END;                          /* HIGH ENTRY=>MISSING STORAGE   */ 00925000
*                                                               03S0340 00926000
*/*------------------------------------------------------------------*/ 00927000
*/* BLSRRA06--PROCESS ENTRIES WHEN BOTH ENTRIES DESCRIBE AVAILABLE   */ 00928000
*/* STORAGE. ASSURE THAT ONE OR BOTH HAVE BEEN REMOVED FROM THE      */ 00929000
*/* MERGE BUFFER PRIOR TO THE COMPLETION OF PROCESSING               */ 00930000
*/*------------------------------------------------------------------*/ 00931000
*                                                               03S0340 00932000
*   RESPECIFY                                                   03S0340 00933000
*    (R0,                           /* ALIGNMENT INDICATOR           */ 00934000
*     R1) RESTRICTED;               /* INTERVENING RECORD COUNT      */ 00935000
@RF00323 DS    0H                                               03S0341 00936000
*   R0=0;                           /* PREPARE FOR DIVISION          */ 00937000
         SLR   R0,R0                                            03S0341 00938000
*   R1=RAMERIA(JH)-RAMERIA(JL);     /* INTERVENING BYTE COUNT        */ 00939000
         L     R1,RAMERIA+32                                    03S0342 00940000
         SL    R1,RAMERIA                                       03S0342 00941000
*   GENERATE REFS(RAMERLE) CODE(D     R0,RAMERLE);              03S0343 00942000
         D     R0,RAMERLE                                               00943000
         SPACE 1                                                        00944000
*                                                               03S0344 00945000
*/*------------------------------------------------------------------*/ 00946000
*/* MERGE ENTRIES IF POSSIBLE. AFTER A CONSOLIDATED LOW ENTRY IS     */ 00947000
*/* CONSTRUCTED, THE HIGH ENTRY CAN BE DELETED AND MERGE PROCESSING  */ 00948000
*/* CAN CONTINUE                                                     */ 00949000
*/*------------------------------------------------------------------*/ 00950000
*                                                               03S0344 00951000
*   IF                              /* ENTRIES CAN BE MERGED         */ 00952000
*       R0=0&                       /* ALIGNMENT INDICATED           */ 00953000
*       (RAMERDA(JL)+R1)=RAMERDA(JH)&/* ADJACENT DISK RECORDS        */ 00954000
*       PL<=PH&                     /* LOW ENTRY ENDS IN TIME        */ 00955000
*       PL>=RAMERIA(JH)&            /* HIGH ENTRY BEGINS IN TIME     */ 00956000
*       RAMERLE(JL)=RAMERLE(JH)&    /* SAME LENGTH OF DATA           */ 00957000
*       RAMERF(JL)=RAMERF(JH)&      /* SAME FLAGS                    */ 00958000
*       RAMEROF(JL)=RAMEROF(JH) THEN/* SAME DATA OFFSET              */ 00959000
*                                                               03S0344 00960000
         LTR   R0,R0                                            03S0344 00961000
         BNZ   @RF00344                                         03S0344 00962000
         LR    @15,R1                                           03S0344 00963000
         AL    @15,RAMERDA                                      03S0344 00964000
         CL    @15,RAMERDA+32                                   03S0344 00965000
         BNE   @RF00344                                         03S0344 00966000
         CLR   PL,PH                                            03S0344 00967000
         BH    @RF00344                                         03S0344 00968000
         CL    PL,RAMERIA+32                                    03S0344 00969000
         BL    @RF00344                                         03S0344 00970000
         CLC   RAMERLE(4),RAMERLE+32                            03S0344 00971000
         BNE   @RF00344                                         03S0344 00972000
         CLC   RAMERF(2),RAMERF+32                              03S0344 00973000
         BNE   @RF00344                                         03S0344 00974000
         CLC   RAMEROF(4),RAMEROF+32                            03S0344 00975000
         BNE   @RF00344                                         03S0344 00976000
*     /***************************************************************/ 00977000
*     /*                                                             */ 00978000
*     /* MERGE ENTRIES                                               */ 00979000
*     /*                                                             */ 00980000
*     /***************************************************************/ 00981000
*                                                               03S0345 00982000
*     DO;                           /* MERGE ENTRIES                 */ 00983000
*       RAMERNM(JL)=R1+RAMERNM(JH); /* NUMBER OF RECORDS             */ 00984000
         LR    @15,R1                                           03S0346 00985000
         AH    @15,RAMERNM+32                                   03S0346 00986000
         STH   @15,RAMERNM                                      03S0346 00987000
*       CALL BLSRRA21;              /* DELETE THE HIGH ENTRY         */ 00988000
         BAL   @14,BLSRRA21                                     03S0347 00989000
*       GO TO L020;                 /* CONTINUE MERGE PROCESSING     */ 00990000
         B     L020                                             03S0348 00991000
*     END;                          /* MERGE ENTRIES                 */ 00992000
         SPACE 1                                                        00993000
*                                                               03S0350 00994000
*/*------------------------------------------------------------------*/ 00995000
*/* IF ENTRIES DO NOT OVERLAP, LOW ENTRY CAN BE TRANSMITTED,         */ 00996000
*/* DELETED, AND MERGE PROCESSING CAN CONTINUE.                      */ 00997000
*/*------------------------------------------------------------------*/ 00998000
*                                                               03S0350 00999000
*   IF PL<=RAMERIA(JH) THEN         /* ENTRIES DO NOT OVERLAP        */ 01000000
*                                                               03S0350 01001000
@RF00344 CL    PL,RAMERIA+32                                    03S0350 01002000
         BH    @RF00350                                         03S0350 01003000
*     /***************************************************************/ 01004000
*     /*                                                             */ 01005000
*     /* ENTRIES DO NOT OVERLAP                                      */ 01006000
*     /*                                                             */ 01007000
*     /***************************************************************/ 01008000
*                                                               03S0351 01009000
*     DO;                           /* ENTRIES DO NOT OVERLAP        */ 01010000
*       CALL BLSRRA10;              /* SEND LOW ENTRY TO OUTPUT      */ 01011000
         BAL   @14,BLSRRA10                                     03S0352 01012000
*       GO TO L020;                 /* CONTINUE MERGE PROCESSING     */ 01013000
         B     L020                                             03S0353 01014000
*     END;                          /* ENTRIES DO NOT OVERLAP        */ 01015000
         SPACE 1                                                        01016000
*                                                               03S0355 01017000
*/*------------------------------------------------------------------*/ 01018000
*/* PREFER TO RETAIN LOW ENTRY INFORMATION IF IT DESCRIBES DATA AT   */ 01019000
*/* A LOWER DATA SET ADDRESS THAN THAT DESCRIBED BY THE HIGH ENTRY   */ 01020000
*/*------------------------------------------------------------------*/ 01021000
*                                                               03S0355 01022000
*   J2=RAMERDA(JL)+R1;              /* FINAL LOW ENTRY RECORD   03S0355 01023000
*                                                            @ZA32782*/ 01024000
@RF00350 LR    J2,R1                                            03S0355 01025000
         AL    J2,RAMERDA                                       03S0355 01026000
*   IF                              /* LOW ENTRY PREFERRED           */ 01027000
*       J2<RAMERDA(JH)|             /* LOWER RECORD ADDRESS(ES)      */ 01028000
*       (J2=RAMERDA(JH)&            /* SAME RECORD ADDRESS           */ 01029000
*       RAMEROF(JL)<RAMEROF(JH)) THEN/* LOWER OFFSET IN RECORD       */ 01030000
*                                                               03S0356 01031000
         L     @03,RAMERDA+32                                   03S0356 01032000
         CLR   J2,@03                                           03S0356 01033000
         BL    @RT00356                                         03S0356 01034000
         CLR   J2,@03                                           03S0356 01035000
         BNE   @RF00356                                         03S0356 01036000
         CLC   RAMEROF(4),RAMEROF+32                            03S0356 01037000
         BNL   @RF00356                                         03S0356 01038000
@RT00356 DS    0H                                               03S0357 01039000
*     /***************************************************************/ 01040000
*     /*                                                             */ 01041000
*     /* LOW ENTRY PREFERRRED                                        */ 01042000
*     /*                                                             */ 01043000
*     /***************************************************************/ 01044000
*                                                               03S0357 01045000
*     DO;                           /* LOW ENTRY PREFERRED           */ 01046000
*       IF PL>=PH THEN              /* DELETE HIGH ENTRY             */ 01047000
*                                                               03S0358 01048000
         CLR   PL,PH                                            03S0358 01049000
         BL    @RF00358                                         03S0358 01050000
*         /***********************************************************/ 01051000
*         /*                                                         */ 01052000
*         /* DELETE HIGH ENTRY--LOW ENTRY DESCRIBES SAME STORAGE     */ 01053000
*         /*                                                         */ 01054000
*         /***********************************************************/ 01055000
*                                                               03S0359 01056000
*         DO;                       /* DELETE THE HIGH ENTRY         */ 01057000
*           CALL BLSRRA21;          /* DELETE THE HIGH ENTRY         */ 01058000
         BAL   @14,BLSRRA21                                     03S0360 01059000
*           GO TO L020;             /* CONTINUE MERGE PROCESSING     */ 01060000
         B     L020                                             03S0361 01061000
*         END;                      /* DELETE THE HIGH ENTRY         */ 01062000
*       R0=0;                       /* PREPARE FOR DIVISION          */ 01063000
@RF00358 SLR   R0,R0                                            03S0363 01064000
*       R1=PL-RAMERIA(JH);          /* INTERVENING BYTE COUNT        */ 01065000
         LR    R1,PL                                            03S0364 01066000
         SL    R1,RAMERIA+32                                    03S0364 01067000
*       RAMERIA(JH)=PL;             /* ->FIRST BYTE                  */ 01068000
         ST    PL,RAMERIA+32                                    03S0365 01069000
*       RESPECIFY                                               03S0366 01070000
*        (RF) RESTRICTED;           /* LENGTH OF HIGH ENTRY RECORD(S)*/ 01071000
*       RF=RAMERLE(JH);             /* LENGTH OF HIGH ENTRY RECORD(S)*/ 01072000
         L     RF,RAMERLE+32                                    03S0367 01073000
*       GENERATE REFS(RAMERLE) CODE(DR    R0,RF);               03S0368 01074000
         DR    R0,RF                                                    01075000
*       RESPECIFY                                               03S0369 01076000
*        (RF) UNRESTRICTED;         /* LENGTH OF HIGH ENTRY RECORD(S)*/ 01077000
*       RAMERNM(JH)=RAMERNM(JH)-R1; /* NUMBER OF RECORDS             */ 01078000
         LH    @08,RAMERNM+32                                   03S0370 01079000
         SLR   @08,R1                                           03S0370 01080000
         STH   @08,RAMERNM+32                                   03S0370 01081000
*       RAMERDA(JH)=RAMERDA(JH)+R1; /* RECORD ADDRESS                */ 01082000
         LR    @08,R1                                           03S0371 01083000
         AL    @08,RAMERDA+32                                   03S0371 01084000
         ST    @08,RAMERDA+32                                   03S0371 01085000
*       IF R0^=0 THEN               /* PARTIAL RECORD DESCRIBED      */ 01086000
*                                                               03S0372 01087000
         LTR   R0,R0                                            03S0372 01088000
         BZ    @RF00372                                         03S0372 01089000
*         /***********************************************************/ 01090000
*         /*                                                         */ 01091000
*         /* PARTIAL RECORD DESCRIBED                                */ 01092000
*         /*                                                         */ 01093000
*         /***********************************************************/ 01094000
*                                                               03S0373 01095000
*         DO;                       /* PARTIAL RECORD DESCRIBED      */ 01096000
*           RAMER(JX)=RAMER(JH);    /* NEW RABA ENTRY                */ 01097000
         MVC   RAMER+64(32),RAMER+32                            03S0374 01098000
*           RAMERLE(JX)=RAMERLE(JX)-R0;/* LENGTH OF DATA             */ 01099000
         L     @08,RAMERLE+64                                   03S0375 01100000
         SLR   @08,R0                                           03S0375 01101000
         ST    @08,RAMERLE+64                                   03S0375 01102000
*           RAMEROF(JX)=RAMEROF(JX)+R0;/* OFFSET OF DATA             */ 01103000
         LR    @08,R0                                           03S0376 01104000
         AL    @08,RAMEROF+64                                   03S0376 01105000
         ST    @08,RAMEROF+64                                   03S0376 01106000
*           RAMERNM(JX)=1;          /* NUMBER OF RECORDS             */ 01107000
         MVC   RAMERNM+64(2),@CH00047                           03S0377 01108000
*           CALL BLSRRA30;          /* ADD ENTRY TO RABA             */ 01109000
         BAL   @14,BLSRRA30                                     03S0378 01110000
*           RAMERIA(JH)=PL+RAMERLE(JX);/* ->FIRST BYTE               */ 01111000
         LR    @08,PL                                           03S0379 01112000
         AL    @08,RAMERLE+64                                   03S0379 01113000
         ST    @08,RAMERIA+32                                   03S0379 01114000
*           RAMERNM(JH)=RAMERNM(JH)-1;/* NUMBER OF RECORDS           */ 01115000
         LH    @08,RAMERNM+32                                   03S0380 01116000
         BCTR  @08,0                                            03S0380 01117000
         STH   @08,RAMERNM+32                                   03S0380 01118000
*           RAMERDA(JH)=RAMERDA(JH)+1;/* DISK RECORD                 */ 01119000
         LA    @08,1                                            03S0381 01120000
         AL    @08,RAMERDA+32                                   03S0381 01121000
         ST    @08,RAMERDA+32                                   03S0381 01122000
*         END;                      /* PARTIAL RECORD DESCRIBED      */ 01123000
*       IF RAMERNM(JH)^=0 THEN      /* WHOLE RECORD(S) DESCRIBED     */ 01124000
*                                                               03S0383 01125000
@RF00372 ICM   @08,3,RAMERNM+32                                 03S0383 01126000
         BZ    @RF00383                                         03S0383 01127000
*         /***********************************************************/ 01128000
*         /*                                                         */ 01129000
*         /* WHOLE RECORD(S) DESCRIBED                               */ 01130000
*         /*                                                         */ 01131000
*         /***********************************************************/ 01132000
*                                                               03S0384 01133000
*         DO;                       /* WHOLE RECORD(S) DESCRIBED     */ 01134000
*           RAMER(JX)=RAMER(JH);    /* NEW RABA ENTRY                */ 01135000
         MVC   RAMER+64(32),RAMER+32                            03S0385 01136000
*           CALL BLSRRA30;          /* ADD ENTRY TO RABA             */ 01137000
         BAL   @14,BLSRRA30                                     03S0386 01138000
*         END;                      /* WHOLE RECORD(S) DESCRIBED     */ 01139000
*       CALL BLSRRA21;              /* DELETE THE HIGH ENTRY         */ 01140000
@RF00383 BAL   @14,BLSRRA21                                     03S0388 01141000
*       GO TO L020;                 /* CONTINUE MERGE PROCESSING     */ 01142000
         B     L020                                             03S0389 01143000
*     END;                          /* LOW ENTRY PREFERRED           */ 01144000
         SPACE 1                                                        01145000
*                                                               03S0391 01146000
*/*------------------------------------------------------------------*/ 01147000
*/* FORWARD THE DESCRIPTION OF WHOLE RECORD(S) DESCRIBED BY THE LOW  */ 01148000
*/* ENTRY WHICH PRECEDE THE PART OF THE ADDRESS SPACE DESCRIBED BY   */ 01149000
*/* THE HIGH ENTRY                                                   */ 01150000
*/*------------------------------------------------------------------*/ 01151000
*                                                               03S0391 01152000
*   RAMER(JX)=RAMER(JL);            /* NEW OUTPUT ENTRY              */ 01153000
@RF00356 MVC   RAMER+64(32),RAMER                               03S0391 01154000
*   IF R1^=0 THEN                   /* WHOLE RECORD(S) DESCRIBED     */ 01155000
*                                                               03S0392 01156000
         LTR   R1,R1                                            03S0392 01157000
         BZ    @RF00392                                         03S0392 01158000
*     /***************************************************************/ 01159000
*     /*                                                             */ 01160000
*     /* ONE OR MORE WHOLE RECORDS DESCRIBED                         */ 01161000
*     /*                                                             */ 01162000
*     /***************************************************************/ 01163000
*                                                               03S0393 01164000
*     DO;                           /* WHOLE RECORD(S) DESCRIBED     */ 01165000
*       RAMERNM(JX)=R1;             /* NUMBER OF RECORDS             */ 01166000
         STH   R1,RAMERNM+64                                    03S0394 01167000
*       P1=RAMERIA(JH)-R0;          /* ->BYTE AFTER OUTPUT ENTRY     */ 01168000
         L     P1,RAMERIA+32                                    03S0395 01169000
         SLR   P1,R0                                            03S0395 01170000
*       CALL BLSRRA11;              /* PROCESS NEW OUTPUT ENTRY      */ 01171000
         BAL   @14,BLSRRA11                                     03S0396 01172000
*       RAMERIA(JX)=P1;             /* ->FIRST BYTE DESCRIBED        */ 01173000
         ST    P1,RAMERIA+64                                    03S0397 01174000
*       RAMERDA(JX)=RAMERDA(JX)+R1; /* NEXT DISK ADDRESS             */ 01175000
         LR    @15,R1                                           03S0398 01176000
         AL    @15,RAMERDA+64                                   03S0398 01177000
         ST    @15,RAMERDA+64                                   03S0398 01178000
*     END;                          /* WHOLE RECORD(S) DESCRIBED     */ 01179000
         SPACE 1                                                        01180000
*                                                               03S0400 01181000
*/*------------------------------------------------------------------*/ 01182000
*/* FORWARD THE DESCRIPTION OF ANY PARTIAL RECORD DESCRIBED BY THE   */ 01183000
*/* LOW ENTRY WHICH PRECEDES THE PART OF THE ADDRESS SPACE DESCRIBED */ 01184000
*/* BY THE HIGH ENTRY                                                */ 01185000
*/*------------------------------------------------------------------*/ 01186000
*                                                               03S0400 01187000
*   IF R0^=0 THEN                   /* PARTIAL RECORD DESCRIBED      */ 01188000
*                                                               03S0400 01189000
@RF00392 LTR   R0,R0                                            03S0400 01190000
         BZ    @RF00400                                         03S0400 01191000
*     /***************************************************************/ 01192000
*     /*                                                             */ 01193000
*     /* PARTIAL RECORD DESCRIBED                                    */ 01194000
*     /*                                                             */ 01195000
*     /***************************************************************/ 01196000
*                                                               03S0401 01197000
*     DO;                           /* PARTIAL RECORD DESCRIBED      */ 01198000
*       RAMERLE(JX)=R0;             /* LENGTH OF DATA                */ 01199000
         ST    R0,RAMERLE+64                                    03S0402 01200000
*       RAMERNM(JX)=1;              /* ONE RECORD DESCRIBED          */ 01201000
         MVC   RAMERNM+64(2),@CH00047                           03S0403 01202000
*       CALL BLSRRA11;              /* PROCESS NEW OUTPUT ENTRY      */ 01203000
         BAL   @14,BLSRRA11                                     03S0404 01204000
*     END;                          /* PARTIAL RECORD DESCRIBED      */ 01205000
         SPACE 1                                                        01206000
*                                                               03S0406 01207000
*/*------------------------------------------------------------------*/ 01208000
*/* IF THE LOW ENTRY DESCRIBES STORAGE THAT ENDS PRIOR TO THE END OF */ 01209000
*/* THE STORAGE DESCRIBED BY THE HIGH ENTRY, THE LOW ENTRY CAN NOW   */ 01210000
*/* BE DELETED, AND MERGE PROCESSING CAN CONTINUE                    */ 01211000
*/*------------------------------------------------------------------*/ 01212000
*                                                               03S0406 01213000
*   IF PL<=PH THEN                  /* LOW ENTRY PROCESSED           */ 01214000
*                                                               03S0406 01215000
@RF00400 CLR   PL,PH                                            03S0406 01216000
         BH    @RF00406                                         03S0406 01217000
*     /***************************************************************/ 01218000
*     /*                                                             */ 01219000
*     /* LOW ENTRY COMPLETELY PROCESSED                              */ 01220000
*     /*                                                             */ 01221000
*     /***************************************************************/ 01222000
*                                                               03S0407 01223000
*     DO;                           /* LOW ENTRY PROCESSED           */ 01224000
*       CALL BLSRRA20;              /* DELETE THE LOW ENTRY          */ 01225000
         BAL   @14,BLSRRA20                                     03S0408 01226000
*       GO TO L020;                 /* CONTINUE MERGE PROCESSING     */ 01227000
         B     L020                                             03S0409 01228000
*     END;                          /* LOW ENTRY PROCESSED           */ 01229000
         SPACE 1                                                        01230000
*                                                               03S0411 01231000
*/*------------------------------------------------------------------*/ 01232000
*/* LOW ENTRY SPANS HIGH ENTRY                                       */ 01233000
*/*------------------------------------------------------------------*/ 01234000
*                                                               03S0411 01235000
*   R0=0;                           /* PREPARE FOR DIVISION          */ 01236000
@RF00406 SLR   R0,R0                                            03S0411 01237000
*   R1=PH-RAMERIA(JL);              /* INTERVENING BYTE COUNT        */ 01238000
         LR    R1,PH                                            03S0412 01239000
         SL    R1,RAMERIA                                       03S0412 01240000
*   GENERATE REFS(RAMERLE) CODE(D     R0,RAMERLE);              03S0413 01241000
         D     R0,RAMERLE                                               01242000
*   RAMERIA(JL)=PH;                 /* ->FIRST BYTE DESCRIBED        */ 01243000
         ST    PH,RAMERIA                                       03S0414 01244000
*   RAMERDA(JL)=RAMERDA(JL)+R1;     /* RECORD ADDRESS                */ 01245000
         LR    @07,R1                                           03S0415 01246000
         AL    @07,RAMERDA                                      03S0415 01247000
         ST    @07,RAMERDA                                      03S0415 01248000
*   RAMERNM(JL)=RAMERNM(JL)-R1;     /* NUMBER OF RECORDS             */ 01249000
         LH    @07,RAMERNM                                      03S0416 01250000
         SLR   @07,R1                                           03S0416 01251000
         STH   @07,RAMERNM                                      03S0416 01252000
         SPACE 1                                                        01253000
*                                                               03S0417 01254000
*/*------------------------------------------------------------------*/ 01255000
*/* FORWARD THE DESCRIPTION OF ANY PARTIAL RECORD DESCRIBED BY THE   */ 01256000
*/* LOW ENTRY WHICH FOLLOWS THE PART OF THE ADDRESS SPACE DESCRIBED  */ 01257000
*/* BY THE HIGH ENTRY                                                */ 01258000
*/*------------------------------------------------------------------*/ 01259000
*                                                               03S0417 01260000
*   IF R0^=0 THEN                   /* PARTIAL RECORD DESCRIBED      */ 01261000
*                                                               03S0417 01262000
         LTR   R0,R0                                            03S0417 01263000
         BZ    @RF00417                                         03S0417 01264000
*     /***************************************************************/ 01265000
*     /*                                                             */ 01266000
*     /* PARTIAL RECORD DESCRIBED                                    */ 01267000
*     /*                                                             */ 01268000
*     /***************************************************************/ 01269000
*                                                               03S0418 01270000
*     DO;                           /* PARTIAL RECORD DESCRIBED      */ 01271000
*       RAMER(JX)=RAMER(JL);        /* NEW RABA ENTRY                */ 01272000
         MVC   RAMER+64(32),RAMER                               03S0419 01273000
*       RAMERLE(JX)=RAMERLE(JX)-R0; /* LENGTH OF DATA                */ 01274000
         L     @07,RAMERLE+64                                   03S0420 01275000
         SLR   @07,R0                                           03S0420 01276000
         ST    @07,RAMERLE+64                                   03S0420 01277000
*       RAMEROF(JX)=RAMEROF(JX)+R0; /* OFFSET OF DATA                */ 01278000
         LR    @07,R0                                           03S0421 01279000
         AL    @07,RAMEROF+64                                   03S0421 01280000
         ST    @07,RAMEROF+64                                   03S0421 01281000
*       RAMERNM(JX)=1;              /* ONE RECORD DESCRIBED          */ 01282000
         MVC   RAMERNM+64(2),@CH00047                           03S0422 01283000
*       CALL BLSRRA30;              /* ADD ENTRY TO RABA             */ 01284000
         BAL   @14,BLSRRA30                                     03S0423 01285000
*       RAMERIA(JL)=PH+RAMERLE(JX); /* ->FIRST BYTE DESCRIBED        */ 01286000
         LR    @07,PH                                           03S0424 01287000
         AL    @07,RAMERLE+64                                   03S0424 01288000
         ST    @07,RAMERIA                                      03S0424 01289000
*       RAMERDA(JL)=RAMERDA(JL)+1;  /* RECORD ADDRESS                */ 01290000
         LA    @07,1                                            03S0425 01291000
         AL    @07,RAMERDA                                      03S0425 01292000
         ST    @07,RAMERDA                                      03S0425 01293000
*       RAMERNM(JL)=RAMERNM(JL)-1;  /* NUMBER OF RECORDS             */ 01294000
         LH    @07,RAMERNM                                      03S0426 01295000
         BCTR  @07,0                                            03S0426 01296000
         STH   @07,RAMERNM                                      03S0426 01297000
*     END;                          /* PARTIAL RECORD DESCRIBED      */ 01298000
         SPACE 1                                                        01299000
*                                                               03S0428 01300000
*/*------------------------------------------------------------------*/ 01301000
*/* FORWARD THE DESCRIPTION OF ANY WHOLE RECORD(S) DESCRIBED BY THE  */ 01302000
*/* LOW ENTRY WHICH FOLLOWS THE PART OF THE ADDRESS SPACE DESCRIBED  */ 01303000
*/* BY THE HIGH ENTRY                                                */ 01304000
*/*------------------------------------------------------------------*/ 01305000
*                                                               03S0428 01306000
*   IF RAMERNM(JL)^=0 THEN          /* WHOLE RECORD(S) DESCRIBED     */ 01307000
*                                                               03S0428 01308000
@RF00417 ICM   @07,3,RAMERNM                                    03S0428 01309000
         BZ    @RF00428                                         03S0428 01310000
*     /***************************************************************/ 01311000
*     /*                                                             */ 01312000
*     /* WHOLE RECORD(S) DESCRIBED                                   */ 01313000
*     /*                                                             */ 01314000
*     /***************************************************************/ 01315000
*                                                               03S0429 01316000
*     DO;                           /* WHOLE RECORD(S) DESCRIBED     */ 01317000
*       RAMER(JX)=RAMER(JL);        /* NEW RABA ENTRY                */ 01318000
         MVC   RAMER+64(32),RAMER                               03S0430 01319000
*       CALL BLSRRA30;              /* ADD ENTRY TO RABA             */ 01320000
         BAL   @14,BLSRRA30                                     03S0431 01321000
*     END;                          /* PARTIAL RECORD DESCRIBED      */ 01322000
*   CALL BLSRRA20;                  /* DELETE THE LOW ENTRY          */ 01323000
@RF00428 BAL   @14,BLSRRA20                                     03S0433 01324000
*   RESPECIFY                                                   03S0434 01325000
*    (R0,                           /* ALIGNMENT INDICATOR           */ 01326000
*     R1) UNRESTRICTED;             /* INTERVENING RECORD COUNT      */ 01327000
*L020:                              /* CONTINUE MERGE PROCESSING     */ 01328000
*   END;                            /* PROCESS RA RECORDS            */ 01329000
L020     DS    0H                                               02S0435 01330000
@DE00182 TM    FLAGERR,B'01000000'                              02S0435 01331000
         BNZ   @DC00182                                         02S0435 01332000
         SLR   @15,@15                                          02S0435 01333000
         CL    @15,JP                                           02S0435 01334000
         BNE   @DL00182                                         02S0435 01335000
         TM    FLAGEOF,B'10000000'                              02S0435 01336000
         BZ    @DL00182                                         02S0435 01337000
         CLC   RAMEUSE(2),@CH00047                              02S0435 01338000
         BH    @DL00182                                         02S0435 01339000
         L     @14,RABAP                                        02S0435 01340000
         CR    @14,@15                                          02S0435 01341000
         BE    @DC00182                                         02S0435 01342000
         CH    @15,RABAUSE(,@14)                                02S0435 01343000
         BNE   @DL00182                                         02S0435 01344000
@DC00182 DS    0H                                               02S0436 01345000
*                                                               02S0436 01346000
*/*------------------------------------------------------------------*/ 01347000
*/* BLSRRA09--BLSRRAAR TERMINATION                                   */ 01348000
*/*------------------------------------------------------------------*/ 01349000
*                                                               02S0436 01350000
*   RAADUSE=RAADUSE+1;              /* ENTRIES IN USE                */ 01351000
         LH    @06,RAADUSE                                      02S0436 01352000
         LA    @06,1(,@06)                                      02S0436 01353000
         STH   @06,RAADUSE                                      02S0436 01354000
*   RAADR(RAADUSE)=RAMER(JL);       /* FINAL RECORD ENTRY            */ 01355000
         LR    @15,@06                                          02S0437 01356000
         SLA   @15,5                                            02S0437 01357000
         LA    @14,RAADR-32(@15)                                02S0437 01358000
         MVC   0(32,@14),RAMER                                  02S0437 01359000
*   RAADFAD=ZZZP31MX;               /* ->FINAL BYTE SUPPORTED        */ 01360000
         MVC   RAADFAD(4),@CF00127                              02S0438 01361000
*   RAADDIM=MAX(RAADUSE,RAADLDI);   /* ENTRIES IN FINAL RECORD       */ 01362000
         LA    @15,3                                            02S0439 01363000
         CR    @15,@06                                          02S0439 01364000
         BNL   *+6                                                      01365000
         LR    @15,@06                                          02S0439 01366000
         STH   @15,RAADDIM                                      02S0439 01367000
*   IF RAADUSE^=RAADHDI THEN        /* SHORT RECORD                  */ 01368000
*                                                               02S0440 01369000
         CH    @06,@CH00191                                     02S0440 01370000
         BE    @RF00440                                         02S0440 01371000
*     /***************************************************************/ 01372000
*     /*                                                             */ 01373000
*     /* SHORT RECORD                                                */ 01374000
*     /*                                                             */ 01375000
*     /***************************************************************/ 01376000
*                                                               02S0441 01377000
*     DO;                           /* SHORT RECORD                  */ 01378000
*       RESPECIFY                                               02S0442 01379000
*        (R6) RESTRICTED;           /* RECORD LENGTH                 */ 01380000
*       R6=RAAD0RL+RAADDIM*LENGTH(RAADR);/* RECORD LENGTH            */ 01381000
         SLA   @15,5                                            02S0443 01382000
         AH    @15,@CH00187                                     02S0443 01383000
         LR    R6,@15                                           02S0443 01384000
*       GENERATE SETS(MODPRMA) CODE                             02S0444 01385000
*           (MODCB RPL=(S,MYRPLA),RECLEN=(R6),MF=(L,MODPRMA,MODPRMAL)); 01386000
         MODCB RPL=(S,MYRPLA),RECLEN=(R6),MF=(L,MODPRMA,MODPRMAL)       01387000
*       RESPECIFY                                               02S0445 01388000
*        (R6) UNRESTRICTED;         /* RECORD LENGTH                 */ 01389000
*       RESPECIFY                                               02S0446 01390000
*        (RF) RESTRICTED;           /* BLSUVSMR RETURN CODE          */ 01391000
*       CALL BLSUVSMR(ZZ2,MODPRMA); /* MODIFY AN RPL FOR ADDITION    */ 01392000
         ST    R9,@AL00001                                      02S0447 01393000
         LA    @14,MODPRMA                                      02S0447 01394000
         ST    @14,@AL00001+4                                   02S0447 01395000
         L     @06,ZZ2BVTP(,R9)                                 02S0447 01396000
         L     @15,BVTVSMRP(,@06)                               02S0447 01397000
         LA    @01,@AL00001                                     02S0447 01398000
         BALR  @14,@15                                          02S0447 01399000
*       IF RF^=ZZZFLAGI THEN        /* BLSUVSMR DETECTED AN ERROR    */ 01400000
         LTR   RF,RF                                            02S0448 01401000
         BNZ   @RT00448                                         02S0448 01402000
*         GO TO ERREXIT;            /* ERROR EXIT                    */ 01403000
*       RESPECIFY                                               02S0450 01404000
*        (RF) UNRESTRICTED;         /* BLSUVSMR RETURN CODE          */ 01405000
*     END;                          /* SHORT RECORD                  */ 01406000
*   CALL BLSRRA12;                  /* WRITE THE OUTPUT BUFFER       */ 01407000
@RF00440 BAL   @14,BLSRRA12                                     02S0452 01408000
*   IF FLAGSCAN=ZZZ1 THEN           /* TERMINATE SEQUENTIAL SCAN     */ 01409000
*                                                               02S0453 01410000
         TM    FLAGSCAN,B'00100000'                             02S0453 01411000
         BNO   @RF00453                                         02S0453 01412000
*     /***************************************************************/ 01413000
*     /*                                                             */ 01414000
*     /* TERMINATE SEQUENTIAL SCAN                                   */ 01415000
*     /*                                                             */ 01416000
*     /***************************************************************/ 01417000
*                                                               02S0454 01418000
*     DO;                           /* TERMINATE SEQUENTIAL SCAN     */ 01419000
*       RESPECIFY                                               02S0455 01420000
*        (RF) RESTRICTED;           /* BLSUVSEN RETURN CODE          */ 01421000
*       CALL BLSUVSEN(ZZ2,MYRPLU);  /* TERMINATE SCAN                */ 01422000
         ST    R9,@AL00001                                      02S0456 01423000
         LA    @14,MYRPLU                                       02S0456 01424000
         ST    @14,@AL00001+4                                   02S0456 01425000
         L     @08,ZZ2BVTP(,R9)                                 02S0456 01426000
         L     @15,BVTVSENP(,@08)                               02S0456 01427000
         LA    @01,@AL00001                                     02S0456 01428000
         BALR  @14,@15                                          02S0456 01429000
*       IF RF^=ZZZFLAGI THEN        /* BLSUVSEN DETECTED AN ERROR    */ 01430000
         LTR   RF,RF                                            02S0457 01431000
         BZ    @RF00457                                         02S0457 01432000
*         FLAGERR=ZZZ1;             /* AN ERROR HAS BEEN DETECTED    */ 01433000
         OI    FLAGERR,B'01000000'                              02S0458 01434000
*       RESPECIFY                                               02S0459 01435000
*        (RF) UNRESTRICTED;         /* BLSUVSEN RETURN CODE          */ 01436000
@RF00457 DS    0H                                               02S0460 01437000
*     END;                          /* TERMINATE SEQUENTIAL SCAN     */ 01438000
*EXIT:                              /* COMMON EXIT PATH              */ 01439000
*   IF FLAGERR=ZZZ0 THEN            /* NO ERRORS DETECTED            */ 01440000
@RF00453 DS    0H                                               02S0461 01441000
EXIT     TM    FLAGERR,B'01000000'                              02S0461 01442000
         BNZ   @RF00461                                         02S0461 01443000
*     RETC=ZZZFLAGI;                /* RETURN CODE                   */ 01444000
         SLR   RETC,RETC                                        02S0462 01445000
*   ELSE                            /* AN ERROR HAS BEEN DETECTED    */ 01446000
*ERREXIT:                           /* ERROR EXIT                    */ 01447000
*     RETC=ZZZFLAGT;                /* RETURN CODE                   */ 01448000
         B     @RC00461                                         02S0463 01449000
@RF00461 DS    0H                                               02S0463 01450000
ERREXIT  LA    RETC,16                                          02S0463 01451000
*   IF RABAP^=ZZZZNULL THEN         /* RABA HAS BEEN ALLOCATED       */ 01452000
@RC00461 L     @08,RABAP                                        02S0464 01453000
         LTR   @08,@08                                          02S0464 01454000
         BZ    @RF00464                                         02S0464 01455000
*      DO; /*FREEMAIN(RU) LV(RABA0RL+RABADIM*LENGTH(RABAR))A(RABA) SP(Z 01456000
*ZSPEXC)*/                                                      02S0465 01457000
*      RESPECIFY (GPR01F,GPR15F,GPR00F) RESTRICTED;             02S0466 01458000
*      GPR01F = 0; /* REG 1 MUST BE ZERO*/                      02S0467 01459000
         SLR   GPR01F,GPR01F                                    02S0467 01460000
*      GPR15F=3; /*SET TYPE*/                                   02S0468 01461000
         LA    GPR15F,3                                         02S0468 01462000
*      GPR00F = RABA0RL+RABADIM*LENGTH(RABAR); /* LENGTH REQUESTED*/    01463000
         LH    GPR00F,RABADIM(,@08)                             02S0469 01464000
         SLA   GPR00F,5                                         02S0469 01465000
         AH    GPR00F,@CH00187                                  02S0469 01466000
*      GPR01F=ADDR(RABA); /*SET REGISTER ONE*/                  02S0470 01467000
         LR    GPR01F,@08                                       02S0470 01468000
*      GPR15F=GPR15F+((ZZZSPEXC)*256); /* SUBPOOL VALUE*/       02S0471 01469000
         AH    GPR15F,@CH00281                                  02S0471 01470000
*      SVC(120); /*RC/RU-FORM OF GETMAIN*/                      02S0472 01471000
         SVC   120                                              02S0472 01472000
*      RESPECIFY (GPR01F,GPR15F,GPR00F) UNRESTRICTED;           02S0473 01473000
*      END; /*FREEMAIN(RU) LV(RABA0RL+RABADIM*LENGTH(RABAR))A(RABA) SP( 01474000
*ZZSPEXC)*/                                                     02S0474 01475000
*   RETURN CODE(RETC);                                          02S0475 01476000
@RF00464 L     @13,4(,@13)                                      02S0475 01477000
         L     @00,@SIZDATD                                     02S0475 01478000
         LR    @01,@11                                          02S0475 01479000
         BLSUFRES R,LV=(0),A=(1)                                        01480000
         LR    @15,@04                                          02S0475 01481000
         L     @14,12(,@13)                                     02S0475 01482000
         LM    @00,@12,20(@13)                                  02S0475 01483000
         BR    @14                                              02S0475 01484000
*                                                               02S0476 01485000
*/*------------------------------------------------------------------*/ 01486000
*/* BLSRRA10--BLSRRAAR SUBROUTINES CONCERNED WITH OUTPUT             */ 01487000
*/*------------------------------------------------------------------*/ 01488000
*/* BLSRRA10--SEND THE LOW ENTRY TO OUTPUT                           */ 01489000
*/*------------------------------------------------------------------*/ 01490000
*                                                               02S0476 01491000
*BLSRRA10:                          /* SEND THE LOW ENTRY TO OUTPUT  */ 01492000
*   PROCEDURE;                                                  02S0476 01493000
BLSRRA10 STM   @14,@06,@SA00002                                 02S0476 01494000
         STM   @09,@12,@SA00002+36                              02S0476 01495000
*   RAMER(JX)=RAMER(JL);            /* NEW OUTPUT ENTRY              */ 01496000
         MVC   RAMER+64(32),RAMER                               02S0477 01497000
*   CALL BLSRRA20;                  /* DELETE THE LOW ENTRY          */ 01498000
         BAL   @14,BLSRRA20                                     02S0478 01499000
         SPACE 1                                                        01500000
*                                                               02S0479 01501000
*/*------------------------------------------------------------------*/ 01502000
*/* BLSRRA11--PROCESS NEW OUTPUT ENTRY                               */ 01503000
*/*------------------------------------------------------------------*/ 01504000
*                                                               02S0479 01505000
*BLSRRA11:                          /* PROCESS NEW OUTPUT ENTRY      */ 01506000
*   ENTRY;                                                      02S0479 01507000
         B     @EC00479                                         02S0479 01508000
BLSRRA11 STM   @14,@06,@SA00002                                 02S0479 01509000
         STM   @09,@12,@SA00002+36                              02S0479 01510000
@EC00479 DS    0H                                               02S0480 01511000
*   RAADUSE=RAADUSE+1;              /* ENTRIES IN USE                */ 01512000
         LH    @06,RAADUSE                                      02S0480 01513000
         LA    @06,1(,@06)                                      02S0480 01514000
         STH   @06,RAADUSE                                      02S0480 01515000
*   RAADR(RAADUSE)=RAMER(JX);       /* FINAL RECORD ENTRY            */ 01516000
         LR    @15,@06                                          02S0481 01517000
         SLA   @15,5                                            02S0481 01518000
         LA    @14,RAADR-32(@15)                                02S0481 01519000
         MVC   0(32,@14),RAMER+64                               02S0481 01520000
*   IF RAADUSE=RAADHDI THEN         /* ADD NEW RECORD                */ 01521000
*                                                               02S0482 01522000
         LA    @15,94                                           02S0482 01523000
         CR    @06,@15                                          02S0482 01524000
         BNE   @RF00482                                         02S0482 01525000
*     /***************************************************************/ 01526000
*     /*                                                             */ 01527000
*     /* ADD A NEW ADDRESS SPACE RECORD TO THE DEBUG CLUSTER         */ 01528000
*     /*                                                             */ 01529000
*     /***************************************************************/ 01530000
*                                                               02S0483 01531000
*     DO;                           /* ADD NEW RECORD                */ 01532000
*       RAADDIM=RAADHDI;            /* ENTRIES IN CAPACITY RECORD    */ 01533000
         STH   @15,RAADDIM                                      02S0484 01534000
*       RAADFAD=                    /* ->FINAL BYTE DESCRIBED        */ 01535000
*           RAADRIA(RAADHDI)+RAADRLE(RAADHDI)*RAADRNM(RAADHDI)-1;       01536000
         L     @06,RAADRLE+2976                                 02S0485 01537000
         MH    @06,RAADRNM+2976                                 02S0485 01538000
         AL    @06,RAADRIA+2976                                 02S0485 01539000
         BCTR  @06,0                                            02S0485 01540000
         ST    @06,RAADFAD                                      02S0485 01541000
         SPACE 1                                                        01542000
*                                                               02S0486 01543000
*/*------------------------------------------------------------------*/ 01544000
*/* BLSRRA12--WRITE THE OUTPUT BUFFER                                */ 01545000
*/*------------------------------------------------------------------*/ 01546000
*                                                               02S0486 01547000
*BLSRRA12:                          /* WRITE THE OUTPUT BUFFER       */ 01548000
*       ENTRY;                                                  02S0486 01549000
         B     @EC00486                                         02S0486 01550000
BLSRRA12 STM   @14,@06,@SA00002                                 02S0486 01551000
         STM   @09,@12,@SA00002+36                              02S0486 01552000
@EC00486 DS    0H                                               02S0487 01553000
*       IF FLAGSCAN=ZZZ1 THEN       /* SEQUENTIAL SCAN ACTIVE        */ 01554000
*                                                               02S0487 01555000
         TM    FLAGSCAN,B'00100000'                             02S0487 01556000
         BNO   @RF00487                                         02S0487 01557000
*         /***********************************************************/ 01558000
*         /*                                                         */ 01559000
*         /* SEQUENTIAL SCAN ACTIVE                                  */ 01560000
*         /*                                                         */ 01561000
*         /***********************************************************/ 01562000
*                                                               02S0488 01563000
*         DO;                       /* SEQUENTIAL SCAN ACTIVE        */ 01564000
*           IF RAUP(1:ZZZVSKL)=RAAD(1:ZZZVSKL) THEN/* REPLACE RECORD */ 01565000
*                                                               02S0489 01566000
         CLC   RAUP(128),RAAD                                   02S0489 01567000
         BNE   @RF00489                                         02S0489 01568000
*             /*******************************************************/ 01569000
*             /*                                                     */ 01570000
*             /* REPLACE RECORD                                      */ 01571000
*             /*                                                     */ 01572000
*             /*******************************************************/ 01573000
*                                                               02S0490 01574000
*             DO;                   /* REPLACE RECORD                */ 01575000
*               RESPECIFY           /* BEFORE MVCL                   */ 01576000
*                (R0,               /* ->UPDATED ENTRIES             */ 01577000
*                 R1,               /* LENGTH OF UPDATED ENTRIES     */ 01578000
*                 RE,               /* ->OUTPUT ENTRIES              */ 01579000
*                 RF) RESTRICTED;   /* LENGTH OF OUTPUT ENTRIES      */ 01580000
*               R0=ADDR(RAUPR(1));  /* ->UPDATED ENTRIES             */ 01581000
         LA    R0,RAUPR                                         02S0492 01582000
*               R1=RAUPUSE*LENGTH(RAUPR);/* LENGTH OF UPDATED ENTRIES*/ 01583000
         LH    R1,RAUPUSE                                       02S0493 01584000
         SLA   R1,5                                             02S0493 01585000
*               RE=ADDR(RAADR(1));  /* ->OUTPUT ENTRIES              */ 01586000
         LA    RE,RAADR                                         02S0494 01587000
*               RF=R1;              /* LENGTH OF OUTPUT ENTRIES      */ 01588000
         LR    RF,R1                                            02S0495 01589000
*               MVCL(R0,RE);        /* COPY OUTPUT ENTRIES           */ 01590000
         MVCL  R0,RE                                            02S0496 01591000
*               RESPECIFY           /* AFTER MVCL                    */ 01592000
*                (R0,               /* DESTROYED                     */ 01593000
*                 R1,               /* 0                             */ 01594000
*                 RE) UNRESTRICTED; /* DESTROYED                     */ 01595000
*               CALL BLSUVSPU(ZZ2,MYRPLU);/* REPLACE RAUP            */ 01596000
         ST    R9,@AL00001                                      02S0498 01597000
         LA    @14,MYRPLU                                       02S0498 01598000
         ST    @14,@AL00001+4                                   02S0498 01599000
         L     @06,ZZ2BVTP(,R9)                                 02S0498 01600000
         L     @15,BVTVSPUP(,@06)                               02S0498 01601000
         LA    @01,@AL00001                                     02S0498 01602000
         BALR  @14,@15                                          02S0498 01603000
*               IF RF^=ZZZFLAGI THEN/* BLSUVSPU DETECTED AN ERROR    */ 01604000
         LTR   RF,RF                                            02S0499 01605000
         BZ    @RF00499                                         02S0499 01606000
*                 FLAGERR=ZZZ1;     /* AN ERROR HAS BEEN DETECTED    */ 01607000
         OI    FLAGERR,B'01000000'                              02S0500 01608000
*               RESPECIFY                                       02S0501 01609000
*                (RF) UNRESTRICTED; /* BLSUVSPU RETURN CODE          */ 01610000
@RF00499 DS    0H                                               02S0502 01611000
*             END;                  /* REPLACE RECORD                */ 01612000
*           ELSE                    /* TERMINATE SEQUENTIAL SCAN     */ 01613000
*                                                               02S0503 01614000
*             /*******************************************************/ 01615000
*             /*                                                     */ 01616000
*             /* TERMINATE SEQUENTIAL SCAN. A NEW RECORD MUST BE     */ 01617000
*             /* ADDED, PROBABLY TO THE SAME CONTROL INTERVAL AS THAT*/ 01618000
*             /* FROM WHICH RAUP WAS OBTAINED                        */ 01619000
*             /*                                                     */ 01620000
*             /*******************************************************/ 01621000
*                                                               02S0503 01622000
*             DO;                   /* TERMINATE SEQUENTIAL SCAN     */ 01623000
         B     @RC00489                                         02S0503 01624000
@RF00489 DS    0H                                               02S0504 01625000
*               RESPECIFY                                       02S0504 01626000
*                (RF) RESTRICTED;   /* RETURN CODES                  */ 01627000
*               IF RAUPRID=ZZZRIDRA&RAUPAS=RAADAS THEN/* ERASE RECORD*/ 01628000
*                                                               02S0505 01629000
         CLC   RAUPRID(2),@CC00136                              02S0505 01630000
         BNE   @RF00505                                         02S0505 01631000
         CLC   RAUPAS(16),RAADAS                                02S0505 01632000
         BNE   @RF00505                                         02S0505 01633000
*                 /***************************************************/ 01634000
*                 /*                                                 */ 01635000
*                 /* ERASE RECORD HELD FOR UPDATE. THE INFORMATION IN*/ 01636000
*                 /* IT WILL BE DISTRIBUTED TO ONE OR MORE NEW       */ 01637000
*                 /* RECORDS                                         */ 01638000
*                 /*                                                 */ 01639000
*                 /***************************************************/ 01640000
*                                                               02S0506 01641000
*                 DO;               /* ERASE RECORD HELD FOR UPDATE  */ 01642000
*                   CALL BLSUVSER(ZZ2,MYRPLU);/* ERASE RAUP          */ 01643000
         ST    R9,@AL00001                                      02S0507 01644000
         LA    @14,MYRPLU                                       02S0507 01645000
         ST    @14,@AL00001+4                                   02S0507 01646000
         L     @06,ZZ2BVTP(,R9)                                 02S0507 01647000
         L     @15,BVTVSERP(,@06)                               02S0507 01648000
         LA    @01,@AL00001                                     02S0507 01649000
         BALR  @14,@15                                          02S0507 01650000
*                   IF RF^=ZZZFLAGI THEN/* BLSUVSER DETECTED AN ERROR*/ 01651000
         LTR   RF,RF                                            02S0508 01652000
         BZ    @RF00508                                         02S0508 01653000
*                     FLAGERR=ZZZ1; /* AN ERROR HAS BEEN DETECTED    */ 01654000
         OI    FLAGERR,B'01000000'                              02S0509 01655000
*                 END;              /* ERASE RECORD HELD FOR UPDATE  */ 01656000
@RF00508 DS    0H                                               02S0511 01657000
*               FLAGSCAN=ZZZ0;      /* SEQUENTIAL SCAN INACTIVE      */ 01658000
@RF00505 NI    FLAGSCAN,B'11011111'                             02S0511 01659000
*               CALL BLSUVSEN(ZZ2,MYRPLU);/* TERMINATE SCAN          */ 01660000
         ST    R9,@AL00001                                      02S0512 01661000
         LA    @14,MYRPLU                                       02S0512 01662000
         ST    @14,@AL00001+4                                   02S0512 01663000
         L     @06,ZZ2BVTP(,R9)                                 02S0512 01664000
         L     @15,BVTVSENP(,@06)                               02S0512 01665000
         LA    @01,@AL00001                                     02S0512 01666000
         BALR  @14,@15                                          02S0512 01667000
*               IF RF^=ZZZFLAGI THEN/* BLSUVSEN DETECTED AN ERROR    */ 01668000
         LTR   RF,RF                                            02S0513 01669000
         BZ    @RF00513                                         02S0513 01670000
*                 FLAGERR=ZZZ1;     /* AN ERROR HAS BEEN DETECTED    */ 01671000
         OI    FLAGERR,B'01000000'                              02S0514 01672000
*               RESPECIFY                                       02S0515 01673000
*                (RF) UNRESTRICTED; /* RETURN CODES                  */ 01674000
@RF00513 DS    0H                                               02S0516 01675000
*             END;                  /* TERMINATE SEQUENTIAL SCAN     */ 01676000
*         END;                      /* SEQUENTIAL SCAN ACTIVE        */ 01677000
@RC00489 DS    0H                                               02S0518 01678000
*       IF FLAGSCAN=ZZZ0 THEN       /* SEQUENTIAL SCAN INACTIVE      */ 01679000
*                                                               02S0518 01680000
@RF00487 TM    FLAGSCAN,B'00100000'                             02S0518 01681000
         BNZ   @RF00518                                         02S0518 01682000
*         /***********************************************************/ 01683000
*         /*                                                         */ 01684000
*         /* SEQUENTIAL SCAN INACTIVE                                */ 01685000
*         /*                                                         */ 01686000
*         /***********************************************************/ 01687000
*                                                               02S0519 01688000
*         DO;                       /* SEQUENTIAL SCAN INACTIVE      */ 01689000
*           RESPECIFY                                           02S0520 01690000
*            (RF) RESTRICTED;       /* BLSUVSPU RETURN CODE          */ 01691000
*           CALL BLSUVSPU(ZZ2,MYRPLA);/* ADD AN ADDRESS SPACE RECORD */ 01692000
         ST    R9,@AL00001                                      02S0521 01693000
         LA    @14,MYRPLA                                       02S0521 01694000
         ST    @14,@AL00001+4                                   02S0521 01695000
         L     @06,ZZ2BVTP(,R9)                                 02S0521 01696000
         L     @15,BVTVSPUP(,@06)                               02S0521 01697000
         LA    @01,@AL00001                                     02S0521 01698000
         BALR  @14,@15                                          02S0521 01699000
*           IF RF^=ZZZFLAGI THEN    /* BLSUVSPU DETECTED AN ERROR    */ 01700000
         LTR   RF,RF                                            02S0522 01701000
         BZ    @RF00522                                         02S0522 01702000
*             FLAGERR=ZZZ1;         /* AN ERROR HAS BEEN DETECTED    */ 01703000
         OI    FLAGERR,B'01000000'                              02S0523 01704000
*           RESPECIFY                                           02S0524 01705000
*            (RF) UNRESTRICTED;     /* BLSUVSPU RETURN CODE          */ 01706000
@RF00522 DS    0H                                               02S0525 01707000
*         END;                      /* SEQUENTIAL SCAN INACTIVE      */ 01708000
*       RAADUSE=0;                  /* ENTRIES IN USE                */ 01709000
@RF00518 SLR   @06,@06                                          02S0526 01710000
         STH   @06,RAADUSE                                      02S0526 01711000
*     END;                          /* ADD NEW RECORD                */ 01712000
*   RETURN;                         /* CONTINUE MERGE PROCESSING     */ 01713000
@EL00002 DS    0H                                               02S0528 01714000
@EF00002 DS    0H                                               02S0528 01715000
@ER00002 LM    @14,@06,@SA00002                                 02S0528 01716000
         LM    @09,@12,@SA00002+36                              02S0528 01717000
         BR    @14                                              02S0528 01718000
*   END BLSRRA10;                   /* ADD DATA TO OUTPUT BUFFER     */ 01719000
         B     @EL00002                                         02S0529 01720000
*                                                               02S0530 01721000
*/*------------------------------------------------------------------*/ 01722000
*/* BLSRRA20--BLSRRAAR ENTRY DELETION SUBROUTINES                    */ 01723000
*/*------------------------------------------------------------------*/ 01724000
*/* BLSRRA20--DELETE THE LOW ENTRY                                   */ 01725000
*/*------------------------------------------------------------------*/ 01726000
*                                                               02S0530 01727000
*BLSRRA20:                          /* DELETE THE LOW ENTRY          */ 01728000
*   PROCEDURE;                                                  02S0530 01729000
BLSRRA20 STM   @14,@06,12(@13)                                  02S0530 01730000
         STM   @09,@12,56(@13)                                  02S0530 01731000
*   PL=PH;                          /* ->BYTE AFTER LOW ENTRY        */ 01732000
         LR    PL,PH                                            02S0531 01733000
*   RAMER(JL)=RAMER(JH);            /* LOW ENTRY                     */ 01734000
         MVC   RAMER(32),RAMER+32                               02S0532 01735000
*   RAMEUSE=RAMEUSE-1;              /* ENTRIES IN USE                */ 01736000
         LH    @06,RAMEUSE                                      02S0533 01737000
         BCTR  @06,0                                            02S0533 01738000
         STH   @06,RAMEUSE                                      02S0533 01739000
*   RETURN;                                                     02S0534 01740000
@EL00003 DS    0H                                               02S0534 01741000
@EF00003 DS    0H                                               02S0534 01742000
@ER00003 LM    @14,@06,12(@13)                                  02S0534 01743000
         LM    @09,@12,56(@13)                                  02S0534 01744000
         BR    @14                                              02S0534 01745000
         SPACE 1                                                        01746000
*                                                               02S0535 01747000
*/*------------------------------------------------------------------*/ 01748000
*/* BLSRRA21--DELETE THE HIGH ENTRY                                  */ 01749000
*/*------------------------------------------------------------------*/ 01750000
*                                                               02S0535 01751000
*BLSRRA21:                          /* DELETE THE HIGH ENTRY         */ 01752000
*   ENTRY;                                                      02S0535 01753000
BLSRRA21 STM   @14,@06,12(@13)                                  02S0535 01754000
         STM   @09,@12,56(@13)                                  02S0535 01755000
*   PH=PL;                          /* ->BYTE AFTER HIGH ENTRY       */ 01756000
         LR    PH,PL                                            02S0536 01757000
*   RAMER(JH)=RAMER(JL);            /* HIGH ENTRY                    */ 01758000
         MVC   RAMER+32(32),RAMER                               02S0537 01759000
*   RAMEUSE=RAMEUSE-1;              /* ENTRIES IN USE                */ 01760000
         LH    @06,RAMEUSE                                      02S0538 01761000
         BCTR  @06,0                                            02S0538 01762000
         STH   @06,RAMEUSE                                      02S0538 01763000
*   RETURN;                                                     02S0539 01764000
         B     @EL00003                                         02S0539 01765000
*   END BLSRRA20;                                               02S0540 01766000
*                                                               02S0541 01767000
*/*------------------------------------------------------------------*/ 01768000
*/* BLSRRA30--BLSRRAAR SUBROUTINE TO ADD AN ENTRY TO RABA            */ 01769000
*/*------------------------------------------------------------------*/ 01770000
*                                                               02S0541 01771000
*BLSRRA30:                          /* PROCESS NEW RABA ENTRY        */ 01772000
*   PROCEDURE;                                                  02S0541 01773000
BLSRRA30 STM   @14,@12,12(@13)                                  02S0541 01774000
*   RABAP2=ADDR(RABA);              /* ->RABA (LOCAL)                */ 01775000
         L     RABAP2,RABAP                                     02S0542 01776000
*   RESPECIFY                                                   02S0543 01777000
*     RABA BASED(RABAP2);           /* LOCAL BASE FOR RECORD         */ 01778000
*   IF RABAP2=ZZZZNULL THEN         /* RABA MUST BE ALLOCATED        */ 01779000
*                                                               02S0544 01780000
         LTR   RABAP2,RABAP2                                    02S0544 01781000
         BNZ   @RF00544                                         02S0544 01782000
*     /***************************************************************/ 01783000
*     /*                                                             */ 01784000
*     /* RABA MUST BE ALLOCATED                                      */ 01785000
*     /*                                                             */ 01786000
*     /***************************************************************/ 01787000
*                                                               02S0545 01788000
*     DO;                           /* RABA MUST BE ALLOCATED        */ 01789000
*       RESPECIFY                                               02S0546 01790000
*        (R1) RESTRICTED;           /* ->STORAGE OBTAINED FOR RABA   */ 01791000
*        DO; /*GETMAIN (RU) LV(RABAHRL) SP(ZZZSPEXC)*/          02S0547 01792000
*        RESPECIFY (GPR01F,GPR15F,GPR00F) RESTRICTED;           02S0548 01793000
*        GPR01F = 0; /* REG 1 MUST BE ZERO*/                    02S0549 01794000
         SLR   GPR01F,GPR01F                                    02S0549 01795000
*        GPR15F = 2; /* RU-TYPE GETMAIN */                      02S0550 01796000
         LA    GPR15F,2                                         02S0550 01797000
*        GPR00F = RABAHRL; /* LENGTH REQUESTED*/                02S0551 01798000
         LA    GPR00F,3060                                      02S0551 01799000
*        GPR15F = GPR15F|((ZZZSPEXC)*256); /* SP IN BYTE 2 */   02S0552 01800000
         O     GPR15F,@CF00281                                  02S0552 01801000
*        SVC(120); /*RC/RU-FORM OF GETMAIN*/                    02S0553 01802000
         SVC   120                                              02S0553 01803000
*        RESPECIFY (GPR01F,GPR15F,GPR00F) UNRESTRICTED;         02S0554 01804000
*        END; /*GETMAIN (RU) LV(RABAHRL) SP(ZZZSPEXC)*/         02S0555 01805000
*       RABAP2=R1;                  /* ->RABA                        */ 01806000
         LR    RABAP2,R1                                        02S0556 01807000
*       RESPECIFY                                               02S0557 01808000
*        (R1) UNRESTRICTED;         /* ->STORAGE OBTAINED FOR RABA   */ 01809000
*       RABA(1:LENGTH(RACO))=RACO;  /* RA RECORD BASE                */ 01810000
         L     @08,ZZ2RASYP(,R9)                                02S0558 01811000
         MVC   RABA(148,RABAP2),RACO(@08)                       02S0558 01812000
*       RABADIM=RABAHDI;            /* NUMBER OF ENTRIES PRESENT     */ 01813000
         MVC   RABADIM(2,RABAP2),@CH00191                       02S0559 01814000
*       RABAUSE=0;                  /* NO ENTRIES IN USE             */ 01815000
         SLR   @08,@08                                          02S0560 01816000
         STH   @08,RABAUSE(,RABAP2)                             02S0560 01817000
*     END;                                                      02S0561 01818000
*   IF RABAUSE=RABADIM THEN         /* RABA OVERFLOW                 */ 01819000
*                                                               02S0562 01820000
@RF00544 LH    @08,RABADIM(,RABAP2)                             02S0562 01821000
         CH    @08,RABAUSE(,RABAP2)                             02S0562 01822000
         BNE   @RF00562                                         02S0562 01823000
*     /***************************************************************/ 01824000
*     /*                                                             */ 01825000
*     /* RABA OVERFLOW                                               */ 01826000
*     /*                                                             */ 01827000
*     /***************************************************************/ 01828000
*                                                               02S0563 01829000
*     DO;                           /* RABA OVERFLOW                 */ 01830000
*       J4=RABADIM+RABAHDI;         /* DIMENSION OF NEW RECORD       */ 01831000
         AH    @08,@CH00191                                     02S0564 01832000
         LR    J4,@08                                           02S0564 01833000
*       RESPECIFY                                               02S0565 01834000
*        (R1) RESTRICTED;           /* ->STORAGE OBTAINED FOR RABA   */ 01835000
*        DO; /*GETMAIN (RU) LV(RABA0RL+J4*LENGTH(RABAR)) SP(ZZZSPEXC)*/ 01836000
*        RESPECIFY (GPR01F,GPR15F,GPR00F) RESTRICTED;           02S0567 01837000
*        GPR01F = 0; /* REG 1 MUST BE ZERO*/                    02S0568 01838000
         SLR   GPR01F,GPR01F                                    02S0568 01839000
*        GPR15F = 2; /* RU-TYPE GETMAIN */                      02S0569 01840000
         LA    GPR15F,2                                         02S0569 01841000
*        GPR00F = RABA0RL+J4*LENGTH(RABAR); /* LENGTH REQUESTED*/       01842000
         LR    GPR00F,J4                                        02S0570 01843000
         SLL   GPR00F,5                                         02S0570 01844000
         AL    GPR00F,@CF00187                                  02S0570 01845000
*        GPR15F = GPR15F|((ZZZSPEXC)*256); /* SP IN BYTE 2 */   02S0571 01846000
         O     GPR15F,@CF00281                                  02S0571 01847000
*        SVC(120); /*RC/RU-FORM OF GETMAIN*/                    02S0572 01848000
         SVC   120                                              02S0572 01849000
*        RESPECIFY (GPR01F,GPR15F,GPR00F) UNRESTRICTED;         02S0573 01850000
*        END; /*GETMAIN (RU) LV(RABA0RL+J4*LENGTH(RABAR)) SP(ZZZSPEXC)* 01851000
*                                                               02S0574 01852000
*       RABAP3=R1;                  /* ->RABA                        */ 01853000
         LR    RABAP3,R1                                        02S0575 01854000
*       RESPECIFY                                               02S0576 01855000
*        (R1) UNRESTRICTED;         /* ->STORAGE OBTAINED FOR RABA   */ 01856000
*       RABAP3->RABA(1:RABALRL)=RABA(1:RABALRL);/* BASE RECORD       */ 01857000
         MVC   RABA(148,RABAP3),RABA(RABAP2)                    02S0577 01858000
*       RABAP3->RABADIM=J4;         /* DIMENSION OF NEW RECORD       */ 01859000
         STH   J4,RABADIM(,RABAP3)                              02S0578 01860000
*       DO J5=RABALDI+1 TO RABAUSE; /* COPY EXISTING ENTRIES         */ 01861000
         LA    J5,4                                             02S0579 01862000
         B     @DE00579                                         02S0579 01863000
@DL00579 DS    0H                                               02S0580 01864000
*         RABAP3->RABAR(J5)=RABAR(J5);/* ONE AT A TIME               */ 01865000
         LR    @08,J5                                           02S0580 01866000
         SLL   @08,5                                            02S0580 01867000
         ST    @08,@TF00001                                     02S0580 01868000
         ALR   @08,RABAP3                                       02S0580 01869000
         LR    @07,RABAP2                                       02S0580 01870000
         AL    @07,@TF00001                                     02S0580 01871000
         MVC   RABAR-32(32,@08),RABAR-32(@07)                   02S0580 01872000
*       END;                        /* COPY EXISTING ENTRIES         */ 01873000
         AL    J5,@CF00047                                      02S0581 01874000
@DE00579 LH    @08,RABAUSE(,RABAP2)                             02S0581 01875000
         CLR   J5,@08                                           02S0581 01876000
         BNH   @DL00579                                         02S0581 01877000
*        DO; /*FREEMAIN(RU) LV(RABA0RL+RABADIM*LENGTH(RABAR))A(RABA) SP 01878000
*ZZZSPEXC)*/                                                    02S0582 01879000
*        RESPECIFY (GPR01F,GPR15F,GPR00F) RESTRICTED;           02S0583 01880000
*        GPR01F = 0; /* REG 1 MUST BE ZERO*/                    02S0584 01881000
         SLR   GPR01F,GPR01F                                    02S0584 01882000
*        GPR15F=3; /*SET TYPE*/                                 02S0585 01883000
         LA    GPR15F,3                                         02S0585 01884000
*        GPR00F = RABA0RL+RABADIM*LENGTH(RABAR); /* LENGTH REQUESTED*/  01885000
         LH    GPR00F,RABADIM(,RABAP2)                          02S0586 01886000
         SLA   GPR00F,5                                         02S0586 01887000
         AL    GPR00F,@CF00187                                  02S0586 01888000
*        GPR01F=ADDR(RABA); /*SET REGISTER ONE*/                02S0587 01889000
         LR    GPR01F,RABAP2                                    02S0587 01890000
*        GPR15F=GPR15F+((ZZZSPEXC)*256); /* SUBPOOL VALUE*/     02S0588 01891000
         AL    GPR15F,@CF00281                                  02S0588 01892000
*        SVC(120); /*RC/RU-FORM OF GETMAIN*/                    02S0589 01893000
         SVC   120                                              02S0589 01894000
*        RESPECIFY (GPR01F,GPR15F,GPR00F) UNRESTRICTED;         02S0590 01895000
*        END; /*FREEMAIN(RU) LV(RABA0RL+RABADIM*LENGTH(RABAR))A(RABA) S 01896000
*(ZZZSPEXC)*/                                                   02S0591 01897000
*       RABAP2=RABAP3;              /* ->RABA                        */ 01898000
         LR    RABAP2,RABAP3                                    02S0592 01899000
*     END;                          /* RABA OVERFLOW                 */ 01900000
*   DO                              /* MAKE ROOM FOR THE NEW ENTRY   */ 01901000
*         J6=RABAUSE TO 1 BY-1      /* SEARCHING BACKWARD            */ 01902000
*         WHILE(RABARIA(J6)>RAMERIA(JX));/* FOR ITS POSITION         */ 01903000
@RF00562 LH    J6,RABAUSE(,RABAP2)                              02S0594 01904000
         B     @DE00594                                         02S0594 01905000
@DL00594 LR    @08,J6                                           02S0594 01906000
         SLL   @08,5                                            02S0594 01907000
         L     @05,RABARIA-32(@08,RABAP2)                       02S0594 01908000
         CL    @05,RAMERIA+64                                   02S0594 01909000
         BNH   @DC00594                                         02S0594 01910000
*     RABAR(J6+1)=RABAR(J6);        /* SHIFT ONE ENTRY AT A TIME     */ 01911000
         ST    @08,@TF00001                                     02S0595 01912000
         ALR   @08,RABAP2                                       02S0595 01913000
         LR    @05,RABAP2                                       02S0595 01914000
         AL    @05,@TF00001                                     02S0595 01915000
         MVC   RABAR(32,@08),RABAR-32(@05)                      02S0595 01916000
*   END;                            /* MAKE ROOM FOR THE NEW ENTRY   */ 01917000
         BCTR  J6,0                                             02S0596 01918000
@DE00594 CL    J6,@CF00047                                      02S0596 01919000
         BNL   @DL00594                                         02S0596 01920000
@DC00594 DS    0H                                               02S0597 01921000
*   RABAR(J6+1)=RAMER(JX);          /* INSERT NEW RABA ENTRY         */ 01922000
         LR    @08,J6                                           02S0597 01923000
         SLL   @08,5                                            02S0597 01924000
         ALR   @08,RABAP2                                       02S0597 01925000
         MVC   RABAR(32,@08),RAMER+64                           02S0597 01926000
*   RABAUSE=RABAUSE+1;              /* ENTRIES IN USE                */ 01927000
         LA    @08,1                                            02S0598 01928000
         AH    @08,RABAUSE(,RABAP2)                             02S0598 01929000
         STH   @08,RABAUSE(,RABAP2)                             02S0598 01930000
*   RABAP=RABAP2;                   /* ->RABA (GLOBAL)               */ 01931000
         ST    RABAP2,RABAP                                     02S0599 01932000
*   RETURN;                         /* CONTINUE MERGE PROCESSING     */ 01933000
@EL00004 DS    0H                                               02S0600 01934000
@EF00004 DS    0H                                               02S0600 01935000
@ER00004 LM    @14,@12,12(@13)                                  02S0600 01936000
         BR    @14                                              02S0600 01937000
*   END BLSRRA30;                   /* ADD DATA TO OUTPUT BUFFER     */ 01938000
*                                                               01S0602 01939000
*/*BLSRPEND--DEBUGGING MODULE*/                                 01S0602 01940000
*                                                               01S0602 01941000
*/*BLSUPEND--MVS IPCS MODULE*/                                  01S0602 01942000
*                                                               01S0602 01943000
*                                                               01S0602 01944000
*                                                               01S0602 01945000
*    DECLARE /*GENERAL PURPOSE REGISTERS */                     01S0602 01946000
*      GPR00F FIXED(31) REG(0),                                 01S0602 01947000
*      GPR01F FIXED(31) REG(1),                                 01S0602 01948000
*      GPR15F FIXED(31) REG(15);                                01S0602 01949000
*                                                               01S0602 01950000
*    DECLARE /* COMMON VARIABLES */                             01S0603 01951000
*      I256C CHAR(256) BASED,                                   01S0603 01952000
*      I031F FIXED(31) BASED,                                   01S0603 01953000
*      I031P PTR(31)   BASED,                                   01S0603 01954000
*      I015F FIXED(15) BASED,                                   01S0603 01955000
*      I015P PTR(15)   BASED,                                   01S0603 01956000
*      I008P PTR(8)    BASED,                                   01S0603 01957000
*      I001C CHAR(1)   BASED;                                   01S0603 01958000
*    GENERATE NODEFS NOREFS DATA;                               01S0604 01959000
*   END BLSRRAAR /*BLRPEND(BLSRRAAR) */                         01S0605 01960000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 01961000
*/*%INCLUDE SYSLIB  (BLSRZZZ )                                        * 01962000
*/*%INCLUDE SYSLIB  (BLSUZZZ )                                        * 01963000
*/*%INCLUDE SYSLIB  (BLRFULL )                                        * 01964000
*/*%INCLUDE SYSLIB  (IKJCPPL )                                        * 01965000
*/*%INCLUDE SYSLIB  (IKJPSCB )                                        * 01966000
*/*%INCLUDE SYSLIB  (IKJECT  )                                        * 01967000
*/*%INCLUDE SYSLIB  (IKJUPT  )                                        * 01968000
*/*%INCLUDE SYSLIB  (BLSUSERV)                                        * 01969000
*/*%INCLUDE SYSLIB  (BLRSERV )                                        * 01970000
*/*%INCLUDE SYSLIB  (BLRSERVD)                                        * 01971000
*/*%INCLUDE SYSLIB  (BLSRSERV)                                        * 01972000
*/*%INCLUDE SYSLIB  (BLSRRA01)                                        * 01973000
*/*%INCLUDE SYSLIB  (BLSRRA02)                                        * 01974000
*/*%INCLUDE SYSLIB  (BLSRRA03)                                        * 01975000
*/*%INCLUDE SYSLIB  (BLSRRA04)                                        * 01976000
*/*%INCLUDE SYSLIB  (BLSRRA05)                                        * 01977000
*/*%INCLUDE SYSLIB  (BLSRRA06)                                        * 01978000
*/*%INCLUDE SYSLIB  (BLSRRA09)                                        * 01979000
*/*%INCLUDE SYSLIB  (BLSRRA10)                                        * 01980000
*/*%INCLUDE SYSLIB  (BLSRRA20)                                        * 01981000
*/*%INCLUDE SYSLIB  (BLSRRA30)                                        * 01982000
*;                                                              01S0605 01983000
@EL00001 L     @13,4(,@13)                                      01S0605 01984000
@EF00001 L     @00,@SIZDATD                                     01S0605 01985000
         LR    @01,@11                                          01S0605 01986000
         BLSUFRES R,LV=(0),A=(1)                                        01987000
@ER00001 LM    @14,@12,12(@13)                                  01S0605 01988000
         BR    @14                                              01S0605 01989000
@DATA    DS    0H                                                       01990000
@CH00191 DC    H'94'                                                    01991000
@DATD    DSECT                                                          01992000
         DS    0F                                                       01993000
@SA00001 DS    18F                                                      01994000
@PC00001 DS    2F                                                       01995000
@SA00002 DS    13F                                                      01996000
@AL00001 DS    2A                                                       01997000
@TF00001 DS    F                                                        01998000
BLSRRAAR CSECT                                                          01999000
         DS    0F                                                       02000000
@CF00047 DC    F'1'                                                     02001000
@CH00047 EQU   @CF00047+2                                               02002000
@CF00187 DC    F'52'                                                    02003000
@CH00187 EQU   @CF00187+2                                               02004000
@CF00281 DC    F'256'                                                   02005000
@CH00281 EQU   @CF00281+2                                               02006000
@CF00127 DC    F'2147483647'                                            02007000
@CF00067 DC    XL4'80000000'                                            02008000
@DATD    DSECT                                                          02009000
         DS    0D                                                       02010000
RABAP    DS    A                                                        02011000
JP       DS    F                                                        02012000
RAME     DS    CL148                                                    02013000
         ORG   RAME                                                     02014000
RAMERID  DS    CL2                                                      02015000
@NM00087 DS    BL6                                                      02016000
RAMERDX  DS    FL4                                                      02017000
RAMEAS   DS    CL16                                                     02018000
         ORG   RAMEAS                                                   02019000
RAMEAS0  DS    0C                                                       02020000
RAMEAST  DS    CL2                                                      02021000
@NM00088 DS    BL2                                                      02022000
RAMEAS1  DS    FL4                                                      02023000
RAMEAS2  DS    FL4                                                      02024000
@NM00089 DS    BL4                                                      02025000
RAMEAS9  DS    0C                                                       02026000
         ORG   RAME+28                                                  02027000
RAMEFAD  DS    AL4                                                      02028000
RAMEELK  DS    0C                                                       02029000
@NM00090 DS    BL16                                                     02030000
RAMEDIM  DS    FL2                                                      02031000
RAMEUSE  DS    FL2                                                      02032000
RAMER    DS    CL32                                                     02033000
         ORG   RAMER+0                                                  02034000
RAMERIA  DS    AL4                                                      02035000
RAMERLE  DS    FL4                                                      02036000
RAMERNM  DS    FL2                                                      02037000
RAMERF   DS    BL2                                                      02038000
         ORG   RAMERF+0                                                 02039000
RAMERFU  DS    BL1                                                      02040000
RAMERFP  EQU   RAMERF+0                                                 02041000
RAMERFR  EQU   RAMERF+0                                                 02042000
@NM00091 EQU   RAMERF+0                                                 02043000
         ORG   RAMER+12                                                 02044000
RAMERDA  DS    FL4                                                      02045000
RAMEROF  DS    FL4                                                      02046000
@NM00092 DS    BL12                                                     02047000
         ORG   RAME+148                                                 02048000
RAME999  DS    0C                                                       02049000
         ORG   RAME+148                                                 02050000
FLAG     DS    BL1                                                      02051000
         ORG   FLAG                                                     02052000
FLAGEOF  DS    BL1                                                      02053000
FLAGERR  EQU   FLAG+0                                                   02054000
FLAGSCAN EQU   FLAG+0                                                   02055000
FLAGSEL  EQU   FLAG+0                                                   02056000
@NM00093 EQU   FLAG+0                                                   02057000
         ORG   FLAG+1                                                   02058000
         DS    CL3                                                      02059000
MYUPDBUF DS    CL3072                                                   02060000
MYRPLU   DS    CL256                                                    02061000
MYRPLA   DS    CL256                                                    02062000
RAAD     DS    CL3060                                                   02063000
         ORG   RAAD                                                     02064000
RAADRID  DS    CL2                                                      02065000
@NM00094 DS    BL6                                                      02066000
RAADRDX  DS    FL4                                                      02067000
RAADAS   DS    CL16                                                     02068000
         ORG   RAADAS                                                   02069000
RAADAS0  DS    0C                                                       02070000
RAADAST  DS    CL2                                                      02071000
@NM00095 DS    BL2                                                      02072000
RAADAS1  DS    FL4                                                      02073000
RAADAS2  DS    FL4                                                      02074000
@NM00096 DS    BL4                                                      02075000
RAADAS9  DS    0C                                                       02076000
         ORG   RAAD+28                                                  02077000
RAADFAD  DS    AL4                                                      02078000
RAADELK  DS    0C                                                       02079000
@NM00097 DS    BL16                                                     02080000
RAADDIM  DS    FL2                                                      02081000
RAADUSE  DS    FL2                                                      02082000
RAADR    DS    CL32                                                     02083000
         ORG   RAADR+0                                                  02084000
RAADRIA  DS    AL4                                                      02085000
RAADRLE  DS    FL4                                                      02086000
RAADRNM  DS    FL2                                                      02087000
RAADRF   DS    BL2                                                      02088000
         ORG   RAADRF+0                                                 02089000
RAADRFU  DS    BL1                                                      02090000
RAADRFP  EQU   RAADRF+0                                                 02091000
RAADRFR  EQU   RAADRF+0                                                 02092000
@NM00098 EQU   RAADRF+0                                                 02093000
         ORG   RAADR+12                                                 02094000
RAADRDA  DS    FL4                                                      02095000
RAADROF  DS    FL4                                                      02096000
@NM00099 DS    BL12                                                     02097000
         ORG   RAAD+3060                                                02098000
RAAD999  DS    0C                                                       02099000
         ORG   RAAD+3060                                                02100000
BLSRRAAR CSECT                                                          02101000
         DS    0F                                                       02102000
@SIZDATD DC    AL1(0)                                                   02103000
         DC    AL3(@ENDDATD-@DATD)                                      02104000
         DS    0D                                                       02105000
@CC00136 DC    C'RA'                                                    02106000
@DATD    DSECT                                                          02107000
         SPACE 2                                                        02108000
*********************************************************************** 02109000
* THE FOLLOWING AREA, BLRPATCH, IS RESERVED FOR PATCH APPLICATION     * 02110000
* TO OBTAIN PATCH ROOM IN THE @DATD AUTOMATIC STORAGE AREA, MODIFY    * 02111000
* CONSTANT @SIZDATD TO REFLECT THE DESIRED @DATD SIZE                 * 02112000
*********************************************************************** 02113000
         SPACE                                                          02114000
BLSRRAAR CSECT                                                          02115000
         ORG                                                            02116000
         DS    0D                                                       02117000
BLRPATCH DC    CL8'ZAPAREA',(((*-BLSRRAAR+19)/20+7)/8)CL8'BLSRRAAR'     02118000
@DATD    DSECT                                                          02119000
         DS    0H                                                       02120000
@DATD    DSECT                                                          02121000
*---------------------------------------------------------------------* 02122000
*   RESERVE SPACE FOR GENCB AND MODCB PARAMETER LISTS                 * 02123000
*---------------------------------------------------------------------* 02124000
         DS    0F                      ALIGN PARAMETER LIST             02125000
GENPRMU  DS    (GENPRMUL)CL1           GENCB PARAMETER LIST             02126000
         ORG   GENPRMU                 ALIGN PARAMETER LIST             02127000
GENPRMA  DS    (GENPRMAL)CL1           GENCB PARAMETER LIST             02128000
         ORG   GENPRMU                 ALIGN PARAMETER LIST             02129000
MODPRMA  DS    (MODPRMAL)CL1           MODCB PARAMETER LIST             02130000
         ORG                                                            02131000
@DATD    DSECT                                                          02132000
         SPACE 2                                                        02133000
*********************************************************************** 02134000
* ALIGN END OF DATA ON A DOUBLEWORD BOUNDARY                          * 02135000
*********************************************************************** 02136000
         SPACE                                                          02137000
         DS    0D                                                       02138000
@DATD    DSECT                                                          02139000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                02140000
@ENDDATD EQU   *                                                        02141000
BLSRRAAR CSECT                                                          02142000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       02143000
@01      EQU   01                                                       02144000
@02      EQU   02                                                       02145000
@03      EQU   03                                                       02146000
@04      EQU   04                                                       02147000
@05      EQU   05                                                       02148000
@06      EQU   06                                                       02149000
@07      EQU   07                                                       02150000
@08      EQU   08                                                       02151000
@09      EQU   09                                                       02152000
@10      EQU   10                                                       02153000
@11      EQU   11                                                       02154000
@12      EQU   12                                                       02155000
@13      EQU   13                                                       02156000
@14      EQU   14                                                       02157000
@15      EQU   15                                                       02158000
RETC     EQU   @04                                                      02159000
J6       EQU   @02                                                      02160000
J5       EQU   @02                                                      02161000
J4       EQU   @07                                                      02162000
J3       EQU   @03                                                      02163000
J2       EQU   @02                                                      02164000
J1       EQU   @02                                                      02165000
JU       EQU   @06                                                      02166000
RABAP3   EQU   @06                                                      02167000
RABAP2   EQU   @04                                                      02168000
RABAP1   EQU   @02                                                      02169000
P1       EQU   @02                                                      02170000
PX       EQU   @02                                                      02171000
PU       EQU   @04                                                      02172000
PP       EQU   @05                                                      02173000
PL       EQU   @07                                                      02174000
PH       EQU   @08                                                      02175000
PB       EQU   @03                                                      02176000
R9       EQU   @09                                                      02177000
R0       EQU   @00                                                      02178000
R1       EQU   @01                                                      02179000
R2       EQU   @02                                                      02180000
R3       EQU   @03                                                      02181000
R4       EQU   @04                                                      02182000
R5       EQU   @05                                                      02183000
R6       EQU   @06                                                      02184000
R7       EQU   @07                                                      02185000
R8       EQU   @08                                                      02186000
RB       EQU   @11                                                      02187000
RD       EQU   @13                                                      02188000
RE       EQU   @14                                                      02189000
RF       EQU   @15                                                      02190000
GPR01F   EQU   @01                                                      02191000
GPR15F   EQU   @15                                                      02192000
GPR00F   EQU   @00                                                      02193000
RA       EQU   @10                                                      02194000
RC       EQU   @12                                                      02195000
ZZ1      EQU   0                                                        02196000
ZZ1ACBP  EQU   ZZ1+28                                                   02197000
ZZ1ATTN  EQU   ZZ1+360                                                  02198000
ZZ1EVE   EQU   ZZ1ATTN+4                                                02199000
ZZ1F     EQU   ZZ1+368                                                  02200000
ZZ1N     EQU   ZZ1+1116                                                 02201000
ZZ2      EQU   0                                                        02202000
ZZ2AMD   EQU   ZZ2                                                      02203000
@NM00021 EQU   ZZ2AMD+7                                                 02204000
ZZ2PRT   EQU   ZZ2+138                                                  02205000
ZZ2PRTT  EQU   ZZ2PRT+4                                                 02206000
ZZ2PRTT1 EQU   ZZ2PRTT+1                                                02207000
ZZ2A     EQU   ZZ2+272                                                  02208000
ZZ2AF    EQU   ZZ2A+16                                                  02209000
ZZ2APID  EQU   ZZ2A+64                                                  02210000
ZZ2AD    EQU   ZZ2A+74                                                  02211000
ZZ2ADD   EQU   ZZ2AD                                                    02212000
ZZ2ADDT  EQU   ZZ2ADD+2                                                 02213000
ZZ2ADM   EQU   ZZ2AD+46                                                 02214000
ZZ2ADMT  EQU   ZZ2ADM+2                                                 02215000
ZZ2ADP   EQU   ZZ2AD+56                                                 02216000
ZZ2ADPT  EQU   ZZ2ADP+2                                                 02217000
ZZ2AZZ6P EQU   ZZ2A+140                                                 02218000
ZZ2AQAS  EQU   ZZ2A+144                                                 02219000
ZZ2AQD   EQU   ZZ2A+160                                                 02220000
ZZ2AQDT  EQU   ZZ2AQD+10                                                02221000
ZZ2AQDF  EQU   ZZ2AQD+52                                                02222000
ZZ2STG   EQU   ZZ2+960                                                  02223000
ZZ2ALLOP EQU   ZZ2+992                                                  02224000
ZZ2FREEP EQU   ZZ2+996                                                  02225000
ZZ2FF19P EQU   ZZ2+1000                                                 02226000
ZZ2FRE1P EQU   ZZ2+1004                                                 02227000
ZZ2FF18P EQU   ZZ2+1008                                                 02228000
ZZ2DYNAP EQU   ZZ2+1012                                                 02229000
ZZ2ZZ2CP EQU   ZZ2+1016                                                 02230000
ZZ2ZZ2DP EQU   ZZ2+1020                                                 02231000
ZZ2STAIP EQU   ZZ2+1024                                                 02232000
ZZ2FF02P EQU   ZZ2+1028                                                 02233000
ZZ2GETLP EQU   ZZ2+1032                                                 02234000
ZZ2PARSP EQU   ZZ2+1036                                                 02235000
ZZ2PTGTP EQU   ZZ2+1040                                                 02236000
ZZ2PUTLP EQU   ZZ2+1044                                                 02237000
ZZ2SCANP EQU   ZZ2+1048                                                 02238000
ZZ2STCKP EQU   ZZ2+1052                                                 02239000
ZZ2TRMOP EQU   ZZ2+1064                                                 02240000
ZZ2TRMVP EQU   ZZ2+1068                                                 02241000
ZZ2PUTNP EQU   ZZ2+1084                                                 02242000
ZZ2TRMNP EQU   ZZ2+1088                                                 02243000
ZZ2ZZ1P  EQU   ZZ2+1264                                                 02244000
ZZ2BVTP  EQU   ZZ2+1280                                                 02245000
ZZ2RVTP  EQU   ZZ2+1284                                                 02246000
ZZ2CPPL  EQU   ZZ2+1292                                                 02247000
ZZ2CPPLC EQU   ZZ2CPPL                                                  02248000
ZZ2RASYP EQU   ZZ2+1336                                                 02249000
ZZ2F     EQU   ZZ2+2824                                                 02250000
ZZ2ITR   EQU   ZZ2+2840                                                 02251000
ZZ2ITRE  EQU   ZZ2ITR+16                                                02252000
ZZ2ITSE  EQU   ZZ2+2864                                                 02253000
ZZ2ES    EQU   ZZ2+2872                                                 02254000
ZZ2AMDX  EQU   ZZ2+7160                                                 02255000
ZZ2AXO   EQU   ZZ2+7934                                                 02256000
ZZ2AXOT  EQU   ZZ2AXO+2                                                 02257000
CMD      EQU   0                                                        02258000
CMDT     EQU   CMD+4                                                    02259000
PSCB     EQU   0                                                        02260000
PSCBATR1 EQU   PSCB+16                                                  02261000
ECT      EQU   0                                                        02262000
ECTSWS   EQU   ECT+28                                                   02263000
ECTSWS2  EQU   ECT+40                                                   02264000
ECTSWS21 EQU   ECTSWS2                                                  02265000
UPT      EQU   0                                                        02266000
UPTSWS   EQU   UPT+12                                                   02267000
SA       EQU   0                                                        02268000
SA1      EQU   SA                                                       02269000
SAR      EQU   SA+12                                                    02270000
SAR1     EQU   SAR+12                                                   02271000
BLSUVSCR EQU   0                                                        02272000
BLSUVSEN EQU   0                                                        02273000
BLSUVSER EQU   0                                                        02274000
BLSUVSGU EQU   0                                                        02275000
BLSUVSMR EQU   0                                                        02276000
BLSUVSPO EQU   0                                                        02277000
BLSUVSPU EQU   0                                                        02278000
BVT      EQU   0                                                        02279000
BVTPUTLP EQU   BVT+4                                                    02280000
BVTPUTOP EQU   BVT+12                                                   02281000
BVTPUTTP EQU   BVT+16                                                   02282000
BVTPUTVP EQU   BVT+20                                                   02283000
BVTPUTAP EQU   BVT+24                                                   02284000
BVTPRTTP EQU   BVT+28                                                   02285000
BVTPRTAP EQU   BVT+32                                                   02286000
BVTPUTDP EQU   BVT+36                                                   02287000
BVTMONP  EQU   BVT+40                                                   02288000
BVTMON2P EQU   BVT+44                                                   02289000
BVTVSARP EQU   BVT+48                                                   02290000
BVTVSENP EQU   BVT+64                                                   02291000
BVTVSERP EQU   BVT+68                                                   02292000
BVTVSGEP EQU   BVT+72                                                   02293000
BVTVSGUP EQU   BVT+76                                                   02294000
BVTVSPOP EQU   BVT+80                                                   02295000
BVTVSPUP EQU   BVT+84                                                   02296000
BVTMPKNP EQU   BVT+104                                                  02297000
BVTMONLP EQU   BVT+108                                                  02298000
BVTPUTCP EQU   BVT+132                                                  02299000
BVTMPK1P EQU   BVT+136                                                  02300000
BVTZZ2RP EQU   BVT+140                                                  02301000
BVTPGMRP EQU   BVT+144                                                  02302000
BVTMONAP EQU   BVT+148                                                  02303000
BVTBLDDP EQU   BVT+152                                                  02304000
BVTBLDLP EQU   BVT+156                                                  02305000
BVTPGMCP EQU   BVT+160                                                  02306000
BVTPGMDP EQU   BVT+164                                                  02307000
BVTPGMLP EQU   BVT+168                                                  02308000
BVTMONCP EQU   BVT+180                                                  02309000
BVTMONDP EQU   BVT+184                                                  02310000
BVTMONTP EQU   BVT+188                                                  02311000
BVTPARIP EQU   BVT+192                                                  02312000
BVTPARUP EQU   BVT+196                                                  02313000
BVTPRTNP EQU   BVT+204                                                  02314000
BVTVSCRP EQU   BVT+208                                                  02315000
BVTVSMRP EQU   BVT+212                                                  02316000
BVTMONXP EQU   BVT+216                                                  02317000
BVTTRMAP EQU   BVT+228                                                  02318000
ZZ6      EQU   0                                                        02319000
ZZ6D     EQU   ZZ6+128                                                  02320000
ZZ6DD    EQU   ZZ6D+8                                                   02321000
ZZ6DDT   EQU   ZZ6DD+4                                                  02322000
ZZ6DRDX  EQU   ZZ6D+64                                                  02323000
ZZ6DQA   EQU   ZZ6D+68                                                  02324000
ZZ6DF    EQU   ZZ6D+92                                                  02325000
ZZ6F     EQU   ZZ6+504                                                  02326000
ZZ6B     EQU   ZZ6+768                                                  02327000
RVT      EQU   0                                                        02328000
RVTADDRP EQU   RVT                                                      02329000
RVTT01P  EQU   RVT+4                                                    02330000
RVTTAP   EQU   RVT+8                                                    02331000
RVTTBP   EQU   RVT+12                                                   02332000
RVTTCP   EQU   RVT+16                                                   02333000
RVTTFP   EQU   RVT+24                                                   02334000
RVTTYP   EQU   RVT+40                                                   02335000
RVTT02P  EQU   RVT+48                                                   02336000
RVTT03P  EQU   RVT+52                                                   02337000
RVTT04P  EQU   RVT+56                                                   02338000
RVTACCLP EQU   RVT+60                                                   02339000
RVTRACCP EQU   RVT+64                                                   02340000
RVTTLP   EQU   RVT+68                                                   02341000
RVTTMP   EQU   RVT+72                                                   02342000
RVTTUP   EQU   RVT+80                                                   02343000
RVTESGEP EQU   RVT+84                                                   02344000
RVTESGUP EQU   RVT+88                                                   02345000
RVTESARP EQU   RVT+92                                                   02346000
RVTRAGEP EQU   RVT+100                                                  02347000
RVTADDPP EQU   RVT+104                                                  02348000
RVTACCQP EQU   RVT+108                                                  02349000
RVTSAGUP EQU   RVT+124                                                  02350000
RVTSAGEP EQU   RVT+128                                                  02351000
RVTESCKP EQU   RVT+132                                                  02352000
RVTMSGAP EQU   RVT+136                                                  02353000
RVTMSGDP EQU   RVT+140                                                  02354000
RVTADDTP EQU   RVT+160                                                  02355000
RVTADDUP EQU   RVT+164                                                  02356000
RVTADD1P EQU   RVT+176                                                  02357000
RVTADD2P EQU   RVT+180                                                  02358000
RVTRSAGP EQU   RVT+184                                                  02359000
RVTMSGBP EQU   RVT+188                                                  02360000
RVTADDSP EQU   RVT+192                                                  02361000
RVTADD3P EQU   RVT+196                                                  02362000
RVTT05P  EQU   RVT+200                                                  02363000
RVTPADSP EQU   RVT+204                                                  02364000
RVTTRP   EQU   RVT+228                                                  02365000
RVTADD4P EQU   RVT+232                                                  02366000
RVTSAPCP EQU   RVT+236                                                  02367000
RVTSAARP EQU   RVT+240                                                  02368000
RVTSAGNP EQU   RVT+244                                                  02369000
RVTT06P  EQU   RVT+248                                                  02370000
RVTSAGCP EQU   RVT+252                                                  02371000
RVTSAGQP EQU   RVT+256                                                  02372000
RVTESGCP EQU   RVT+260                                                  02373000
RVTESGQP EQU   RVT+264                                                  02374000
RVTDUCKP EQU   RVT+276                                                  02375000
RVTDUCCP EQU   RVT+280                                                  02376000
RACO     EQU   0                                                        02377000
RACOAS   EQU   RACO+12                                                  02378000
RACOR    EQU   RACO+52                                                  02379000
RACORF   EQU   RACOR+10                                                 02380000
RABA     EQU   0                                                        02381000
RABAAS   EQU   RABA+12                                                  02382000
RABADIM  EQU   RABA+48                                                  02383000
RABAUSE  EQU   RABA+50                                                  02384000
RABAR    EQU   RABA+52                                                  02385000
RABARIA  EQU   RABAR                                                    02386000
RABARF   EQU   RABAR+10                                                 02387000
BLSRACC  EQU   0                                                        02388000
BLSRACCL EQU   0                                                        02389000
BLSRACCQ EQU   0                                                        02390000
BLSRADDP EQU   0                                                        02391000
BLSRADDR EQU   0                                                        02392000
BLSRADDS EQU   0                                                        02393000
BLSRADDT EQU   0                                                        02394000
BLSRADDU EQU   0                                                        02395000
BLSRADD1 EQU   0                                                        02396000
BLSRADD2 EQU   0                                                        02397000
BLSRADD3 EQU   0                                                        02398000
BLSRADD4 EQU   0                                                        02399000
BLSRDUCC EQU   0                                                        02400000
BLSRDUCK EQU   0                                                        02401000
BLSRESAR EQU   0                                                        02402000
BLSRESCK EQU   0                                                        02403000
BLSRESGC EQU   0                                                        02404000
BLSRESGE EQU   0                                                        02405000
BLSRESGQ EQU   0                                                        02406000
BLSRESGU EQU   0                                                        02407000
BLSRMSGA EQU   0                                                        02408000
BLSRMSGB EQU   0                                                        02409000
BLSRMSGD EQU   0                                                        02410000
BLSRPADS EQU   0                                                        02411000
BLSRRAGE EQU   0                                                        02412000
BLSRSAAR EQU   0                                                        02413000
BLSRSAG  EQU   0                                                        02414000
BLSRSAGC EQU   0                                                        02415000
BLSRSAGE EQU   0                                                        02416000
BLSRSAGN EQU   0                                                        02417000
BLSRSAGQ EQU   0                                                        02418000
BLSRSAGU EQU   0                                                        02419000
BLSRSAPC EQU   0                                                        02420000
BLSTA    EQU   0                                                        02421000
BLSTB    EQU   0                                                        02422000
BLSTC    EQU   0                                                        02423000
BLSTF    EQU   0                                                        02424000
BLSTL    EQU   0                                                        02425000
BLSTM    EQU   0                                                        02426000
BLSTR    EQU   0                                                        02427000
BLSTU    EQU   0                                                        02428000
BLSTY    EQU   0                                                        02429000
BLST01   EQU   0                                                        02430000
BLST02   EQU   0                                                        02431000
BLST03   EQU   0                                                        02432000
BLST04   EQU   0                                                        02433000
BLST05   EQU   0                                                        02434000
BLST06   EQU   0                                                        02435000
BLSUALLO EQU   0                                                        02436000
BLSUBLDD EQU   0                                                        02437000
BLSUBLDL EQU   0                                                        02438000
BLSUDYNA EQU   0                                                        02439000
BLSUFREE EQU   0                                                        02440000
BLSUFRE1 EQU   0                                                        02441000
BLSUMON  EQU   0                                                        02442000
BLSUMONA EQU   0                                                        02443000
BLSUMONC EQU   0                                                        02444000
BLSUMOND EQU   0                                                        02445000
BLSUMONL EQU   0                                                        02446000
BLSUMONT EQU   0                                                        02447000
BLSUMONX EQU   0                                                        02448000
BLSUMON2 EQU   0                                                        02449000
BLSUMPKN EQU   0                                                        02450000
BLSUMPK1 EQU   0                                                        02451000
BLSUPARI EQU   0                                                        02452000
BLSUPARU EQU   0                                                        02453000
BLSUPGMC EQU   0                                                        02454000
BLSUPGMD EQU   0                                                        02455000
BLSUPGML EQU   0                                                        02456000
BLSUPGMR EQU   0                                                        02457000
BLSUPRTA EQU   0                                                        02458000
BLSUPRTN EQU   0                                                        02459000
BLSUPRTT EQU   0                                                        02460000
BLSUPUTA EQU   0                                                        02461000
BLSUPUTC EQU   0                                                        02462000
BLSUPUTD EQU   0                                                        02463000
BLSUPUTL EQU   0                                                        02464000
BLSUPUTN EQU   0                                                        02465000
BLSUPUTO EQU   0                                                        02466000
BLSUPUTT EQU   0                                                        02467000
BLSUPUTV EQU   0                                                        02468000
BLSUSTAI EQU   0                                                        02469000
BLSUTRMA EQU   0                                                        02470000
BLSUTRMN EQU   0                                                        02471000
BLSUTRMO EQU   0                                                        02472000
BLSUTRMV EQU   0                                                        02473000
BLSUVSAR EQU   0                                                        02474000
BLSUVSGE EQU   0                                                        02475000
BLSUZZ2C EQU   0                                                        02476000
BLSUZZ2D EQU   0                                                        02477000
BLSUZZ2R EQU   0                                                        02478000
IKJEFF02 EQU   0                                                        02479000
IKJEFF18 EQU   0                                                        02480000
IKJEFF19 EQU   0                                                        02481000
IKJGETL  EQU   0                                                        02482000
IKJPARS  EQU   0                                                        02483000
IKJPTGT  EQU   0                                                        02484000
IKJPUTL  EQU   0                                                        02485000
IKJSCAN  EQU   0                                                        02486000
IKJSTCK  EQU   0                                                        02487000
I001C    EQU   0                                                        02488000
I008P    EQU   0                                                        02489000
I015F    EQU   0                                                        02490000
I015P    EQU   0                                                        02491000
I031F    EQU   0                                                        02492000
I031P    EQU   0                                                        02493000
I256C    EQU   0                                                        02494000
PZ2      EQU   0                                                        02495000
RAPA     EQU   0                                                        02496000
RAPAAS   EQU   RAPA+12                                                  02497000
RAPAUSE  EQU   RAPA+50                                                  02498000
RAPAR    EQU   RAPA+52                                                  02499000
RAPARIA  EQU   RAPAR                                                    02500000
RAPARNM  EQU   RAPAR+8                                                  02501000
RAPARF   EQU   RAPAR+10                                                 02502000
CPPL     EQU   ZZ2CPPL                                                  02503000
CPPLUPT  EQU   CPPL+4                                                   02504000
CPPLPSCB EQU   CPPL+8                                                   02505000
CPPLECT  EQU   CPPL+12                                                  02506000
RAUP     EQU   MYUPDBUF                                                 02507000
RAUPRID  EQU   RAUP                                                     02508000
RAUPRDX  EQU   RAUP+8                                                   02509000
RAUPAS   EQU   RAUP+12                                                  02510000
RAUPFAD  EQU   RAUP+28                                                  02511000
RAUPUSE  EQU   RAUP+50                                                  02512000
RAUPR    EQU   RAUP+52                                                  02513000
RAUPRIA  EQU   RAUPR                                                    02514000
RAUPRF   EQU   RAUPR+10                                                 02515000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    02516000
RAUP999  EQU   RAUP+3060                                                02517000
@NM00111 EQU   RAUPR+20                                                 02518000
RAUPROF  EQU   RAUPR+16                                                 02519000
RAUPRDA  EQU   RAUPR+12                                                 02520000
@NM00110 EQU   RAUPRF                                                   02521000
RAUPRFR  EQU   RAUPRF                                                   02522000
RAUPRFP  EQU   RAUPRF                                                   02523000
RAUPRFU  EQU   RAUPRF                                                   02524000
RAUPRNM  EQU   RAUPR+8                                                  02525000
RAUPRLE  EQU   RAUPR+4                                                  02526000
RAUPDIM  EQU   RAUP+48                                                  02527000
@NM00109 EQU   RAUP+32                                                  02528000
RAUPELK  EQU   RAUP+32                                                  02529000
RAUPAS9  EQU   RAUPAS+16                                                02530000
@NM00108 EQU   RAUPAS+12                                                02531000
RAUPAS2  EQU   RAUPAS+8                                                 02532000
RAUPAS1  EQU   RAUPAS+4                                                 02533000
@NM00107 EQU   RAUPAS+2                                                 02534000
RAUPAST  EQU   RAUPAS                                                   02535000
RAUPAS0  EQU   RAUPAS                                                   02536000
@NM00106 EQU   RAUP+2                                                   02537000
CPPLCBUF EQU   CPPL                                                     02538000
RAPA999  EQU   RAPA+3060                                                02539000
@NM00006 EQU   RAPAR+20                                                 02540000
RAPAROF  EQU   RAPAR+16                                                 02541000
RAPARDA  EQU   RAPAR+12                                                 02542000
@NM00005 EQU   RAPARF                                                   02543000
RAPARFR  EQU   RAPARF                                                   02544000
RAPARFP  EQU   RAPARF                                                   02545000
RAPARFU  EQU   RAPARF                                                   02546000
RAPARLE  EQU   RAPAR+4                                                  02547000
RAPADIM  EQU   RAPA+48                                                  02548000
@NM00004 EQU   RAPA+32                                                  02549000
RAPAELK  EQU   RAPA+32                                                  02550000
RAPAFAD  EQU   RAPA+28                                                  02551000
RAPAAS9  EQU   RAPAAS+16                                                02552000
@NM00003 EQU   RAPAAS+12                                                02553000
RAPAAS2  EQU   RAPAAS+8                                                 02554000
RAPAAS1  EQU   RAPAAS+4                                                 02555000
@NM00002 EQU   RAPAAS+2                                                 02556000
RAPAAST  EQU   RAPAAS                                                   02557000
RAPAAS0  EQU   RAPAAS                                                   02558000
RAPARDX  EQU   RAPA+8                                                   02559000
@NM00001 EQU   RAPA+2                                                   02560000
RAPARID  EQU   RAPA                                                     02561000
RABA999  EQU   RABA+3060                                                02562000
@NM00117 EQU   RABAR+20                                                 02563000
RABAROF  EQU   RABAR+16                                                 02564000
RABARDA  EQU   RABAR+12                                                 02565000
@NM00116 EQU   RABARF                                                   02566000
RABARFR  EQU   RABARF                                                   02567000
RABARFP  EQU   RABARF                                                   02568000
RABARFU  EQU   RABARF                                                   02569000
RABARNM  EQU   RABAR+8                                                  02570000
RABARLE  EQU   RABAR+4                                                  02571000
@NM00115 EQU   RABA+32                                                  02572000
RABAELK  EQU   RABA+32                                                  02573000
RABAFAD  EQU   RABA+28                                                  02574000
RABAAS9  EQU   RABAAS+16                                                02575000
@NM00114 EQU   RABAAS+12                                                02576000
RABAAS2  EQU   RABAAS+8                                                 02577000
RABAAS1  EQU   RABAAS+4                                                 02578000
@NM00113 EQU   RABAAS+2                                                 02579000
RABAAST  EQU   RABAAS                                                   02580000
RABAAS0  EQU   RABAAS                                                   02581000
RABARDX  EQU   RABA+8                                                   02582000
@NM00112 EQU   RABA+2                                                   02583000
RABARID  EQU   RABA                                                     02584000
RACO999  EQU   RACO+148                                                 02585000
@NM00105 EQU   RACOR+20                                                 02586000
RACOROF  EQU   RACOR+16                                                 02587000
RACORDA  EQU   RACOR+12                                                 02588000
@NM00104 EQU   RACORF                                                   02589000
RACORFR  EQU   RACORF                                                   02590000
RACORFP  EQU   RACORF                                                   02591000
RACORFU  EQU   RACORF                                                   02592000
RACORNM  EQU   RACOR+8                                                  02593000
RACORLE  EQU   RACOR+4                                                  02594000
RACORIA  EQU   RACOR                                                    02595000
RACOUSE  EQU   RACO+50                                                  02596000
RACODIM  EQU   RACO+48                                                  02597000
@NM00103 EQU   RACO+32                                                  02598000
RACOELK  EQU   RACO+32                                                  02599000
RACOFAD  EQU   RACO+28                                                  02600000
RACOAS9  EQU   RACOAS+16                                                02601000
@NM00102 EQU   RACOAS+12                                                02602000
RACOAS2  EQU   RACOAS+8                                                 02603000
RACOAS1  EQU   RACOAS+4                                                 02604000
@NM00101 EQU   RACOAS+2                                                 02605000
RACOAST  EQU   RACOAS                                                   02606000
RACOAS0  EQU   RACOAS                                                   02607000
RACORDX  EQU   RACO+8                                                   02608000
@NM00100 EQU   RACO+2                                                   02609000
RACORID  EQU   RACO                                                     02610000
RVT99999 EQU   RVT+384                                                  02611000
RVT0096P EQU   RVT+380                                                  02612000
RVT0095P EQU   RVT+376                                                  02613000
RVT0094P EQU   RVT+372                                                  02614000
RVT0093P EQU   RVT+368                                                  02615000
RVT0092P EQU   RVT+364                                                  02616000
RVT0091P EQU   RVT+360                                                  02617000
RVT0090P EQU   RVT+356                                                  02618000
RVT0089P EQU   RVT+352                                                  02619000
RVT0088P EQU   RVT+348                                                  02620000
RVT0087P EQU   RVT+344                                                  02621000
RVT0086P EQU   RVT+340                                                  02622000
RVT0085P EQU   RVT+336                                                  02623000
RVT0084P EQU   RVT+332                                                  02624000
RVT0083P EQU   RVT+328                                                  02625000
RVT0082P EQU   RVT+324                                                  02626000
RVT0081P EQU   RVT+320                                                  02627000
RVT0080P EQU   RVT+316                                                  02628000
RVT0079P EQU   RVT+312                                                  02629000
RVT0078P EQU   RVT+308                                                  02630000
RVT0077P EQU   RVT+304                                                  02631000
RVT0076P EQU   RVT+300                                                  02632000
RVT0075P EQU   RVT+296                                                  02633000
RVT0074P EQU   RVT+292                                                  02634000
RVT0073P EQU   RVT+288                                                  02635000
RVT0072P EQU   RVT+284                                                  02636000
RVTDTUTP EQU   RVT+272                                                  02637000
RVTDTMTP EQU   RVT+268                                                  02638000
RVT0057P EQU   RVT+224                                                  02639000
RVT0056P EQU   RVT+220                                                  02640000
RVT0055P EQU   RVT+216                                                  02641000
RVT0054P EQU   RVT+212                                                  02642000
RVT0053P EQU   RVT+208                                                  02643000
RVT0044P EQU   RVT+172                                                  02644000
RVT0043P EQU   RVT+168                                                  02645000
RVT0040P EQU   RVT+156                                                  02646000
RVT0039P EQU   RVT+152                                                  02647000
RVT0038P EQU   RVT+148                                                  02648000
RVT0037P EQU   RVT+144                                                  02649000
RVT0031P EQU   RVT+120                                                  02650000
RVT0030P EQU   RVT+116                                                  02651000
RVT0029P EQU   RVT+112                                                  02652000
RVTRAARP EQU   RVT+96                                                   02653000
RVT0020P EQU   RVT+76                                                   02654000
RVT0012P EQU   RVT+44                                                   02655000
RVT0010P EQU   RVT+36                                                   02656000
RVT0009P EQU   RVT+32                                                   02657000
RVT0008P EQU   RVT+28                                                   02658000
RVT0006P EQU   RVT+20                                                   02659000
ZZ69999  EQU   ZZ6+1792                                                 02660000
ZZ6BRB   EQU   ZZ6B+12                                                  02661000
ZZ6BRC   EQU   ZZ6B+8                                                   02662000
@NM00086 EQU   ZZ6B+6                                                   02663000
ZZ6BFL   EQU   ZZ6B+4                                                   02664000
ZZ6BDA   EQU   ZZ6B                                                     02665000
@NM00085 EQU   ZZ6+540                                                  02666000
ZZ6BUFI  EQU   ZZ6+536                                                  02667000
ZZ6BUFP  EQU   ZZ6+532                                                  02668000
ZZ6FILE  EQU   ZZ6+524                                                  02669000
ZZ6BUFB  EQU   ZZ6+520                                                  02670000
ZZ6BUFL  EQU   ZZ6+518                                                  02671000
ZZ6BUFN  EQU   ZZ6+516                                                  02672000
ZZ6ZZ6P  EQU   ZZ6+512                                                  02673000
@NM00084 EQU   ZZ6F                                                     02674000
ZZ6FINIT EQU   ZZ6F                                                     02675000
ZZ6FDUOP EQU   ZZ6F                                                     02676000
@NM00083 EQU   ZZ6+256                                                  02677000
ZZ6D999  EQU   ZZ6D+128                                                 02678000
@NM00082 EQU   ZZ6D+116                                                 02679000
ZZ6DCAP  EQU   ZZ6D+112                                                 02680000
ZZ6DPRP  EQU   ZZ6D+108                                                 02681000
ZZ6DDA2  EQU   ZZ6D+104                                                 02682000
ZZ6DDA1  EQU   ZZ6D+100                                                 02683000
@NM00081 EQU   ZZ6DF                                                    02684000
ZZ6DFSU  EQU   ZZ6DF                                                    02685000
ZZ6DFST  EQU   ZZ6DF                                                    02686000
ZZ6DFAB  EQU   ZZ6DF                                                    02687000
ZZ6DFMP  EQU   ZZ6DF                                                    02688000
ZZ6DFDU  EQU   ZZ6DF                                                    02689000
ZZ6DFBS  EQU   ZZ6DF                                                    02690000
ZZ6DQ2   EQU   ZZ6D+88                                                  02691000
ZZ6DQ1   EQU   ZZ6D+84                                                  02692000
ZZ6DQA9  EQU   ZZ6DQA+16                                                02693000
@NM00080 EQU   ZZ6DQA+12                                                02694000
ZZ6DQA2  EQU   ZZ6DQA+8                                                 02695000
ZZ6DQA1  EQU   ZZ6DQA+4                                                 02696000
@NM00079 EQU   ZZ6DQA+2                                                 02697000
ZZ6DQAT  EQU   ZZ6DQA                                                   02698000
ZZ6DQA0  EQU   ZZ6DQA                                                   02699000
ZZ6DELK  EQU   ZZ6D+64                                                  02700000
ZZ6DMEM  EQU   ZZ6D+56                                                  02701000
ZZ6DDT1  EQU   ZZ6DDT                                                   02702000
ZZ6DDO   EQU   ZZ6DD+2                                                  02703000
ZZ6DDL   EQU   ZZ6DD                                                    02704000
@NM00078 EQU   ZZ6D+2                                                   02705000
ZZ6DRID  EQU   ZZ6D                                                     02706000
ZZ6RDCB  EQU   ZZ6                                                      02707000
ZZ60000  EQU   ZZ6                                                      02708000
BVT99999 EQU   BVT+256                                                  02709000
BVT0064P EQU   BVT+252                                                  02710000
BVT0063P EQU   BVT+248                                                  02711000
BVT0062P EQU   BVT+244                                                  02712000
BVT0061P EQU   BVT+240                                                  02713000
BVT0060P EQU   BVT+236                                                  02714000
BVT0059P EQU   BVT+232                                                  02715000
BVT0057P EQU   BVT+224                                                  02716000
BVT0056P EQU   BVT+220                                                  02717000
BVTSTBLP EQU   BVT+200                                                  02718000
BVT0045P EQU   BVT+176                                                  02719000
BVT0044P EQU   BVT+172                                                  02720000
BVT0033P EQU   BVT+128                                                  02721000
BVT0032P EQU   BVT+124                                                  02722000
BVT0031P EQU   BVT+120                                                  02723000
BVT0030P EQU   BVT+116                                                  02724000
BVT0029P EQU   BVT+112                                                  02725000
BVT0026P EQU   BVT+100                                                  02726000
BVT0025P EQU   BVT+96                                                   02727000
BVT0024P EQU   BVT+92                                                   02728000
BVT0023P EQU   BVT+88                                                   02729000
BVT0016P EQU   BVT+60                                                   02730000
BVT0015P EQU   BVT+56                                                   02731000
BVT0014P EQU   BVT+52                                                   02732000
BVT0003P EQU   BVT+8                                                    02733000
BVT0001P EQU   BVT                                                      02734000
SA99     EQU   SA+72                                                    02735000
SARC     EQU   SAR+56                                                   02736000
SARB     EQU   SAR+52                                                   02737000
SARA     EQU   SAR+48                                                   02738000
SAR9     EQU   SAR+44                                                   02739000
SAR8     EQU   SAR+40                                                   02740000
SAR7     EQU   SAR+36                                                   02741000
SAR6     EQU   SAR+32                                                   02742000
SAR5     EQU   SAR+28                                                   02743000
SAR4     EQU   SAR+24                                                   02744000
SAR3     EQU   SAR+20                                                   02745000
SAR2     EQU   SAR+16                                                   02746000
SAR0     EQU   SAR+8                                                    02747000
SARF     EQU   SAR+4                                                    02748000
SARE     EQU   SAR                                                      02749000
SAFWD    EQU   SA+8                                                     02750000
SABAK    EQU   SA+4                                                     02751000
SA1L     EQU   SA1+1                                                    02752000
SA1P     EQU   SA1                                                      02753000
UPTPREFL EQU   UPT+23                                                   02754000
UPTPREFX EQU   UPT+16                                                   02755000
@NM00077 EQU   UPT+15                                                   02756000
UPTLDEL  EQU   UPT+14                                                   02757000
UPTCDEL  EQU   UPT+13                                                   02758000
UPTWTP   EQU   UPTSWS                                                   02759000
UPTMODE  EQU   UPTSWS                                                   02760000
UPTALD   EQU   UPTSWS                                                   02761000
UPTPAUS  EQU   UPTSWS                                                   02762000
UPTNCOM  EQU   UPTSWS                                                   02763000
UPTMID   EQU   UPTSWS                                                   02764000
UPTNPRM  EQU   UPTSWS                                                   02765000
UPTRCVR  EQU   UPTSWS                                                   02766000
UPTUSER  EQU   UPT+2                                                    02767000
@NM00076 EQU   UPT                                                      02768000
@NM00075 EQU   ECT+52                                                   02769000
@NM00074 EQU   ECT+48                                                   02770000
@NM00073 EQU   ECT+44                                                   02771000
@NM00072 EQU   ECTSWS2+1                                                02772000
@NM00071 EQU   ECTSWS21                                                 02773000
ECTTABND EQU   ECTSWS21                                                 02774000
ECTDEFCS EQU   ECTSWS21                                                 02775000
ECTBKPB  EQU   ECT+36                                                   02776000
ECTUSER  EQU   ECT+32                                                   02777000
ECTDDNUM EQU   ECT+29                                                   02778000
ECTATTN  EQU   ECTSWS                                                   02779000
ECTBKGRD EQU   ECTSWS                                                   02780000
ECTNNOT  EQU   ECTSWS                                                   02781000
ECTNMAL  EQU   ECTSWS                                                   02782000
ECTLOGF  EQU   ECTSWS                                                   02783000
ECTATRM  EQU   ECTSWS                                                   02784000
@NM00070 EQU   ECTSWS                                                   02785000
ECTNOPD  EQU   ECTSWS                                                   02786000
ECTSCMD  EQU   ECT+20                                                   02787000
ECTPCMD  EQU   ECT+12                                                   02788000
ECTSMSG  EQU   ECT+9                                                    02789000
ECTMSGF  EQU   ECT+8                                                    02790000
ECTIOWA  EQU   ECT+4                                                    02791000
ECTRTCD  EQU   ECT+1                                                    02792000
ECTRCDF  EQU   ECT                                                      02793000
PSCBU    EQU   PSCB+64                                                  02794000
PSCBRSZ  EQU   PSCB+60                                                  02795000
PSCBLINE EQU   PSCB+59                                                  02796000
PSCBCHAR EQU   PSCB+58                                                  02797000
PSCBUPTL EQU   PSCB+56                                                  02798000
PSCBUPT  EQU   PSCB+52                                                  02799000
PSCBRLGB EQU   PSCB+48                                                  02800000
PSCBDEST EQU   PSCB+40                                                  02801000
@NM00069 EQU   PSCB+36                                                  02802000
@NM00068 EQU   PSCB+32                                                  02803000
@NM00067 EQU   PSCB+28                                                  02804000
PSCBLTI2 EQU   PSCB+24                                                  02805000
PSCBLTIM EQU   PSCB+20                                                  02806000
PSCBATR2 EQU   PSCB+18                                                  02807000
@NM00066 EQU   PSCBATR1                                                 02808000
@NM00065 EQU   PSCBATR1                                                 02809000
@NM00064 EQU   PSCBATR1                                                 02810000
PSCBATTN EQU   PSCBATR1                                                 02811000
PSCBVMNT EQU   PSCBATR1                                                 02812000
PSCBJCL  EQU   PSCBATR1                                                 02813000
PSCBACCT EQU   PSCBATR1                                                 02814000
PSCBCTRL EQU   PSCBATR1                                                 02815000
PSCBGPNM EQU   PSCB+8                                                   02816000
PSCBUSRL EQU   PSCB+7                                                   02817000
PSCBUSER EQU   PSCB                                                     02818000
CMDT1    EQU   CMDT                                                     02819000
CMDO     EQU   CMD+2                                                    02820000
CMDL     EQU   CMD                                                      02821000
ZZ299999 EQU   ZZ2+8192                                                 02822000
ZZ2AXOT1 EQU   ZZ2AXOT                                                  02823000
ZZ2AXOL  EQU   ZZ2AXO                                                   02824000
@NM00063 EQU   ZZ2+7288                                                 02825000
@NM00062 EQU   ZZ2AMDX+4                                                02826000
ZZ2AMDXC EQU   ZZ2AMDX                                                  02827000
ZZ2HSD   EQU   ZZ2+3056                                                 02828000
@NM00061 EQU   ZZ2ES                                                    02829000
@NM00060 EQU   ZZ2+2868                                                 02830000
ZZ2ITSEC EQU   ZZ2ITSE+1                                                02831000
@NM00059 EQU   ZZ2ITSE                                                  02832000
ZZ2ITSEP EQU   ZZ2ITSE                                                  02833000
ZZ2ITSEW EQU   ZZ2ITSE                                                  02834000
@NM00058 EQU   ZZ2ITR+20                                                02835000
ZZ2ITREC EQU   ZZ2ITRE+1                                                02836000
@NM00057 EQU   ZZ2ITRE                                                  02837000
ZZ2ITREP EQU   ZZ2ITRE                                                  02838000
ZZ2ITREW EQU   ZZ2ITRE                                                  02839000
@NM00056 EQU   ZZ2ITR+9                                                 02840000
ZZ2ITRRC EQU   ZZ2ITR+8                                                 02841000
ZZ2ITR2P EQU   ZZ2ITR+4                                                 02842000
ZZ2ITRPP EQU   ZZ2ITR                                                   02843000
@NM00055 EQU   ZZ2F                                                     02844000
ZZ2F3270 EQU   ZZ2F                                                     02845000
@NM00054 EQU   ZZ2+1544                                                 02846000
ZZ2PGM   EQU   ZZ2+1536                                                 02847000
@NM00053 EQU   ZZ2+1526                                                 02848000
ZZ2CW    EQU   ZZ2+1524                                                 02849000
@NM00052 EQU   ZZ2+1504                                                 02850000
@NM00051 EQU   ZZ2+1352                                                 02851000
ZZ2FFSYP EQU   ZZ2+1348                                                 02852000
ZZ2SASYP EQU   ZZ2+1344                                                 02853000
ZZ2RDSYP EQU   ZZ2+1340                                                 02854000
ZZ2PHSYP EQU   ZZ2+1332                                                 02855000
ZZ2ESSYP EQU   ZZ2+1328                                                 02856000
ZZ200SYP EQU   ZZ2+1324                                                 02857000
ZZ2SCWP  EQU   ZZ2+1320                                                 02858000
ZZ2TTLP  EQU   ZZ2+1316                                                 02859000
ZZ2LOADP EQU   ZZ2+1312                                                 02860000
ZZ2VRESP EQU   ZZ2+1308                                                 02861000
ZZ2CPPLE EQU   ZZ2CPPL+12                                               02862000
ZZ2CPPLP EQU   ZZ2CPPL+8                                                02863000
ZZ2CPPLU EQU   ZZ2CPPL+4                                                02864000
ZZ2VRSAP EQU   ZZ2+1288                                                 02865000
ZZ2DVTP  EQU   ZZ2+1276                                                 02866000
@NM00050 EQU   ZZ2+1272                                                 02867000
@NM00049 EQU   ZZ2+1268                                                 02868000
ZZ2RPLP  EQU   ZZ2+1260                                                 02869000
ZZ2TCBP  EQU   ZZ2+1256                                                 02870000
@NM00048 EQU   ZZ2+1252                                                 02871000
ZZ2ZZ2P  EQU   ZZ2+1248                                                 02872000
@NM00047 EQU   ZZ2+1112                                                 02873000
ZZ2FPDRP EQU   ZZ2+1108                                                 02874000
ZZ2FDSDP EQU   ZZ2+1104                                                 02875000
ZZ2APDRP EQU   ZZ2+1100                                                 02876000
ZZ2ADSDP EQU   ZZ2+1096                                                 02877000
ZZ2ENQ0P EQU   ZZ2+1092                                                 02878000
@NM00046 EQU   ZZ2+1080                                                 02879000
ZZ2MSG0P EQU   ZZ2+1076                                                 02880000
ZZ2FT25P EQU   ZZ2+1072                                                 02881000
ZZ2MSGSP EQU   ZZ2+1060                                                 02882000
ZZ2ALOCP EQU   ZZ2+1056                                                 02883000
@NM00045 EQU   ZZ2+976                                                  02884000
ZZ2TOD   EQU   ZZ2+968                                                  02885000
ZZ2STGN  EQU   ZZ2STG+4                                                 02886000
ZZ2STGP  EQU   ZZ2STG                                                   02887000
@NM00044 EQU   ZZ2+952                                                  02888000
ZZ2SCMDE EQU   ZZ2+944                                                  02889000
ZZ2SCMDN EQU   ZZ2+936                                                  02890000
ZZ2IDENT EQU   ZZ2+928                                                  02891000
ZZ2A9999 EQU   ZZ2A+656                                                 02892000
@NM00043 EQU   ZZ2A+224                                                 02893000
@NM00042 EQU   ZZ2A+220                                                 02894000
ZZ2AQD99 EQU   ZZ2AQD+60                                                02895000
@NM00041 EQU   ZZ2AQD+56                                                02896000
@NM00040 EQU   ZZ2AQDF                                                  02897000
ZZ2AQDFA EQU   ZZ2AQDF                                                  02898000
ZZ2AQDIL EQU   ZZ2AQD+48                                                02899000
ZZ2AQDIM EQU   ZZ2AQD+44                                                02900000
ZZ2AQDT9 EQU   ZZ2AQDT+34                                               02901000
ZZ2AQDTE EQU   ZZ2AQDT+33                                               02902000
ZZ2AQDTD EQU   ZZ2AQDT+2                                                02903000
@NM00039 EQU   ZZ2AQDT+1                                                02904000
ZZ2AQDTY EQU   ZZ2AQDT                                                  02905000
ZZ2AQDT0 EQU   ZZ2AQDT                                                  02906000
ZZ2AQDLB EQU   ZZ2AQD+9                                                 02907000
ZZ2AQDOB EQU   ZZ2AQD+8                                                 02908000
ZZ2AQDLE EQU   ZZ2AQD+4                                                 02909000
ZZ2AQDOF EQU   ZZ2AQD                                                   02910000
ZZ2AQD00 EQU   ZZ2AQD                                                   02911000
ZZ2AQAS9 EQU   ZZ2AQAS+16                                               02912000
@NM00038 EQU   ZZ2AQAS+12                                               02913000
ZZ2AQAS2 EQU   ZZ2AQAS+8                                                02914000
ZZ2AQAS1 EQU   ZZ2AQAS+4                                                02915000
@NM00037 EQU   ZZ2AQAS+2                                                02916000
ZZ2AQAST EQU   ZZ2AQAS                                                  02917000
ZZ2AQAS0 EQU   ZZ2AQAS                                                  02918000
ZZ2ADPTA EQU   ZZ2ADPT                                                  02919000
ZZ2ADPL  EQU   ZZ2ADP                                                   02920000
ZZ2ADMTA EQU   ZZ2ADMT                                                  02921000
ZZ2ADML  EQU   ZZ2ADM                                                   02922000
ZZ2ADDTA EQU   ZZ2ADDT                                                  02923000
ZZ2ADDL  EQU   ZZ2ADD                                                   02924000
@NM00036 EQU   ZZ2A+72                                                  02925000
ZZ2APIDB EQU   ZZ2APID+3                                                02926000
ZZ2APIDA EQU   ZZ2APID                                                  02927000
@NM00035 EQU   ZZ2A+24                                                  02928000
@NM00034 EQU   ZZ2AF+5                                                  02929000
ZZ2AFX   EQU   ZZ2AF+5                                                  02930000
@NM00033 EQU   ZZ2AF+3                                                  02931000
ZZ2AFS   EQU   ZZ2AF+2                                                  02932000
ZZ2AFD   EQU   ZZ2AF+2                                                  02933000
ZZ2AFQ   EQU   ZZ2AF+2                                                  02934000
ZZ2AF$   EQU   ZZ2AF+2                                                  02935000
@NM00032 EQU   ZZ2AF+2                                                  02936000
ZZ2AFM   EQU   ZZ2AF+2                                                  02937000
@NM00031 EQU   ZZ2AF+2                                                  02938000
@NM00030 EQU   ZZ2AF+1                                                  02939000
ZZ2AFV   EQU   ZZ2AF+1                                                  02940000
@NM00029 EQU   ZZ2AF+1                                                  02941000
ZZ2AFC   EQU   ZZ2AF+1                                                  02942000
@NM00028 EQU   ZZ2AF                                                    02943000
ZZ2AFFS  EQU   ZZ2AF                                                    02944000
ZZ2AFT   EQU   ZZ2AF                                                    02945000
ZZ2AFP   EQU   ZZ2AF                                                    02946000
@NM00027 EQU   ZZ2A+8                                                   02947000
ZZ2ALINE EQU   ZZ2A+4                                                   02948000
@NM00026 EQU   ZZ2A+3                                                   02949000
ZZ2ASE   EQU   ZZ2A+2                                                   02950000
ZZ2ACH   EQU   ZZ2A                                                     02951000
@NM00025 EQU   ZZ2+264                                                  02952000
@NM00024 EQU   ZZ2+263                                                  02953000
ZZ2PRTT0 EQU   ZZ2PRTT                                                  02954000
ZZ2PRTO  EQU   ZZ2PRT+2                                                 02955000
ZZ2PRTL  EQU   ZZ2PRT                                                   02956000
@NM00023 EQU   ZZ2AMD+56                                                02957000
ZZ2AMDXP EQU   ZZ2AMD+52                                                02958000
ZZ2AMDD  EQU   ZZ2AMD+48                                                02959000
ZZ2AMDL  EQU   ZZ2AMD+44                                                02960000
ZZ2AMDU  EQU   ZZ2AMD+28                                                02961000
ZZ2AMDF  EQU   ZZ2AMD+24                                                02962000
ZZ2AMDS  EQU   ZZ2AMD+20                                                02963000
ZZ2AMDC  EQU   ZZ2AMD+16                                                02964000
ZZ2AMDP  EQU   ZZ2AMD+12                                                02965000
ZZ2AMDB  EQU   ZZ2AMD+8                                                 02966000
@NM00022 EQU   @NM00021                                                 02967000
ZZ2AMD2  EQU   @NM00021                                                 02968000
ZZ2AMD1  EQU   @NM00021                                                 02969000
ZZ2AMD0  EQU   ZZ2AMD+6                                                 02970000
ZZ2AMDA  EQU   ZZ2AMD+4                                                 02971000
ZZ2AMDT  EQU   ZZ2AMD                                                   02972000
ZZ199999 EQU   ZZ1+3072                                                 02973000
@NM00020 EQU   ZZ1+2160                                                 02974000
ZZ1TRTAS EQU   ZZ1+1904                                                 02975000
ZZ1TRUPC EQU   ZZ1+1648                                                 02976000
ZZ1TRCTX EQU   ZZ1+1392                                                 02977000
ZZ1NASID EQU   ZZ1N+274                                                 02978000
ZZ1NSTRL EQU   ZZ1N+272                                                 02979000
ZZ1NOFF  EQU   ZZ1N+268                                                 02980000
ZZ1NBDY  EQU   ZZ1N+264                                                 02981000
ZZ1NADE  EQU   ZZ1N+260                                                 02982000
ZZ1NADB  EQU   ZZ1N+256                                                 02983000
ZZ1NSTR  EQU   ZZ1N                                                     02984000
@NM00019 EQU   ZZ1+1080                                                 02985000
ZZ1TREBC EQU   ZZ1+824                                                  02986000
ZZ1TRHEX EQU   ZZ1+568                                                  02987000
@NM00018 EQU   ZZ1+377                                                  02988000
ZZ1USTAE EQU   ZZ1+376                                                  02989000
@NM00017 EQU   ZZ1F+3                                                   02990000
@NM00016 EQU   ZZ1F+2                                                   02991000
ZZ1FPRNT EQU   ZZ1F+2                                                   02992000
@NM00015 EQU   ZZ1F+1                                                   02993000
ZZ1FTCAM EQU   ZZ1F+1                                                   02994000
ZZ1FACCM EQU   ZZ1F+1                                                   02995000
@NM00014 EQU   ZZ1F                                                     02996000
ZZ1FM    EQU   ZZ1F                                                     02997000
ZZ1FX    EQU   ZZ1F                                                     02998000
ZZ1FU    EQU   ZZ1F                                                     02999000
ZZ1EVEC  EQU   ZZ1EVE+1                                                 03000000
@NM00013 EQU   ZZ1EVE                                                   03001000
ZZ1EVEP  EQU   ZZ1EVE                                                   03002000
ZZ1EVEW  EQU   ZZ1EVE                                                   03003000
ZZ1ACMP  EQU   ZZ1ATTN                                                  03004000
@NM00012 EQU   ZZ1+144                                                  03005000
ZZ1FPP   EQU   ZZ1+140                                                  03006000
ZZ1ZZ6P  EQU   ZZ1+136                                                  03007000
@NM00011 EQU   ZZ1+84                                                   03008000
ZZ1PLINE EQU   ZZ1+80                                                   03009000
ZZ1PGSZ  EQU   ZZ1+76                                                   03010000
ZZ1PCNT  EQU   ZZ1+72                                                   03011000
@NM00010 EQU   ZZ1+68                                                   03012000
ZZ1TPAGE EQU   ZZ1+64                                                   03013000
ZZ1TLINE EQU   ZZ1+60                                                   03014000
@NM00009 EQU   ZZ1+52                                                   03015000
ZZ1DMCBP EQU   ZZ1+48                                                   03016000
ZZ1DSDP  EQU   ZZ1+44                                                   03017000
ZZ1PDRP  EQU   ZZ1+40                                                   03018000
ZZ1ZZ2P  EQU   ZZ1+36                                                   03019000
ZZ1327WP EQU   ZZ1+32                                                   03020000
@NM00008 EQU   ZZ1+24                                                   03021000
ZZ1PDCBP EQU   ZZ1+20                                                   03022000
ZZ1BLRBL EQU   ZZ1+16                                                   03023000
@NM00007 EQU   ZZ1+12                                                   03024000
ZZ1PNULL EQU   ZZ1+8                                                    03025000
ZZ1NULL  EQU   ZZ1+4                                                    03026000
ZZ1IDE   EQU   ZZ1                                                      03027000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      03028000
@RT00144 EQU   ERREXIT                                                  03029000
@RT00148 EQU   ERREXIT                                                  03030000
@RT00163 EQU   ERREXIT                                                  03031000
@RT00175 EQU   ERREXIT                                                  03032000
@RC00190 EQU   @RC00189                                                 03033000
@RF00195 EQU   @RC00186                                                 03034000
@RC00299 EQU   L020                                                     03035000
@RC00313 EQU   L020                                                     03036000
@RT00448 EQU   ERREXIT                                                  03037000
@RF00482 EQU   @EL00002                                                 03038000
@ENDDATA EQU   *                                                        03039000
         END   BLSRRAAR,(C'PLS1803',0701,78160)                         03040000
