         TITLE 'DATA HANDLING CHECKS BY DRC,DRD ACCUMULATOR            *00001000
                        '                                               00002000
ISDADAT0 CSECT ,                                                01S0001 00003000
@MAINENT DS    0H                                               01S0001 00004000
         USING *,@15                                            01S0001 00005000
         B     @PROLOG                                          01S0001 00006000
         DC    AL1(8)                                           01S0001 00007000
         DC    C'ISDADAT0'                                      01S0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                  01S0001 00010000
         BALR  @12,0                                            01S0001 00011000
@PSTART  DS    0H                                               01S0001 00012000
         USING @PSTART,@12                                      01S0001 00013000
         L     @00,@SIZDATD                                     01S0001 00014000
         ISDAGSPC R,LV=(0)                                              00015000
         LR    @11,@01                                          01S0001 00016000
         USING @DATD,@11                                        01S0001 00017000
         ST    @13,@SA00001+4                                   01S0001 00018000
         LM    @00,@01,20(@13)                                  01S0001 00019000
         ST    @11,8(,@13)                                      01S0001 00020000
         LR    @13,@11                                          01S0001 00021000
         MVC   @PC00001(4),0(@01)                               01S0001 00022000
*                                                               01S0027 00023000
*   /*****************************************************************/ 00024000
*   /*                                                               */ 00025000
*   /* END OF ISDADAT0 DECLARES                              @Y30LB50*/ 00026000
*   /*                                                               */ 00027000
*   /*****************************************************************/ 00028000
*                                                               01S0028 00029000
*                                                               01S0028 00030000
*   /*****************************************************************/ 00031000
*   /*                                                               */ 00032000
*   /* START OF ISDADAT0 MAIN PROGRAM                        @Y30LB50*/ 00033000
*   /*                                                               */ 00034000
*   /*****************************************************************/ 00035000
*                                                               01S0028 00036000
*   CVTPTR=WORKPTR;                 /* SAVE CALLING PARAMETER-PTR TO    00037000
*                                      SDACVT                @Y30LB50*/ 00038000
         L     @05,@PC00001                                     01S0028 00039000
         L     CVTPTR,WORKPTR(,@05)                             01S0028 00040000
*   LPARMPTR=PARMPTR;               /* SET PTR TO SDA PARMS  @ZM30983*/ 00041000
         L     LPARMPTR,PARMPTR(,CVTPTR)                        01S0029 00042000
*   RETRNREG=0;                     /* SET RETURN CODE REGISTER TO 0    00043000
*                                                            @Y30LB50*/ 00044000
         SLR   @05,@05                                          01S0030 00045000
         LR    RETRNREG,@05                                     01S0030 00046000
*   IF DAT00PTR=0 THEN              /* IF DAT WORK POINTER IF SDACVT    00047000
*                                      IS 0, THIS IS THE INITIAL CALL   00048000
*                                                            @Y30LB50*/ 00049000
         C     @05,DAT00PTR(,CVTPTR)                            01S0031 00050000
         BNE   @RF00031                                         01S0031 00051000
*                                                               02S0032 00052000
*   /*****************************************************************/ 00053000
*   /*                                                               */ 00054000
*   /* DATINIT IS USED TO OBTAIN AND INITIALIZE A WORKAREA FOR DAT   */ 00055000
*   /* PROCESSING                                            @Y30LB50*/ 00056000
*   /*                                                               */ 00057000
*   /*****************************************************************/ 00058000
*                                                               02S0032 00059000
*   DO;                             /*                       @Y30LB50*/ 00060000
*     RFY                                                       02S0033 00061000
*      (R0,                                                     02S0033 00062000
*       R1) RSTD;                   /*                       @Y30LB50*/ 00063000
*     SPNO=DATSPNO;                 /* SUBPOOL NUMBER FOR DAT   02S0034 00064000
*                                      WORKAREA REQUEST      @Y30LB50*/ 00065000
         MVC   SPNO(1,CVTPTR),DATSPNO                           02S0034 00066000
*     CORELEN=LENGTH(DATWORK);      /* LENGTH-WORKAREA FOR DAT  02S0035 00067000
*                                      PROCESSING            @Y30LB50*/ 00068000
         MVC   CORELEN(3,CVTPTR),@CF00275+1                     02S0035 00069000
*     R1=ADDR(WORKCALL);            /*                       @Y30LB50*/ 00070000
         LA    R1,WORKCALL(,CVTPTR)                             02S0036 00071000
*     CALL ISDAGET1;                /* REQUEST WORKAREA      @Y30LB50*/ 00072000
         L     @15,@CV00265                                     02S0037 00073000
         BALR  @14,@15                                          02S0037 00074000
*     RFY                                                       02S0038 00075000
*       R15 RSTD;                   /*                       @Y30LB50*/ 00076000
*     RETRNREG=R15;                 /* SAVE RETURN REGISTER  @Y30LB50*/ 00077000
         LR    RETRNREG,R15                                     02S0039 00078000
*     RFY                                                       02S0040 00079000
*      (R1,                                                     02S0040 00080000
*       R15) UNRSTD;                /*                       @Y30LB50*/ 00081000
*     IF RETRNREG=0 THEN                                        02S0041 00082000
         LTR   RETRNREG,RETRNREG                                02S0041 00083000
         BNZ   @RF00041                                         02S0041 00084000
*       DO;                         /* CONTINUE IF WORKAREA OBTAINED    00085000
*                                                            @Y30LB50*/ 00086000
*         DAT00PTR=COREADDR;        /* SET DAT WORK AREA PTR INTO       00087000
*                                      SDACVT                @Y30LB50*/ 00088000
         L     @05,COREADDR(,CVTPTR)                            02S0043 00089000
         ST    @05,DAT00PTR(,CVTPTR)                            02S0043 00090000
*         DATPTR=COREADDR;          /* SET LOCAL POINTER TO DAT WORK    00091000
*                                      AREA                  @Y30LB50*/ 00092000
         LR    DATPTR,@05                                       02S0044 00093000
*         DATWORK=''B;              /* ZERO THE WORKAREA     @Y30LB50*/ 00094000
         XC    DATWORK(48,DATPTR),DATWORK(DATPTR)               02S0045 00095000
*       END;                        /*                       @Y30LB50*/ 00096000
*     ELSE                          /* BAD RETURN FROM GET1  @ZM30983*/ 00097000
*       CDAT='00'X;                 /* SET NO CALL FLAG      @ZM30983*/ 00098000
         B     @RC00041                                         02S0047 00099000
@RF00041 MVI   CDAT(LPARMPTR),X'00'                             02S0047 00100000
*   END;                            /*                       @Y30LB50*/ 00101000
*   ELSE                                                        01S0049 00102000
*     ;                             /*                       @Y30LB50*/ 00103000
@RF00031 DS    0H                                               01S0050 00104000
*   IF RETRNREG=0 THEN                                          01S0050 00105000
@RC00031 LTR   RETRNREG,RETRNREG                                01S0050 00106000
         BNZ   @RF00050                                         01S0050 00107000
*     DO;                           /* IF WORKAREA WAS OBTAINED 01S0051 00108000
*                                                            @Y30LB50*/ 00109000
*       DATPTR=DAT00PTR;            /* SET LOCAL POINTER TO DAT 01S0052 00110000
*                                      WORKAREA              @Y30LB50*/ 00111000
         L     DATPTR,DAT00PTR(,CVTPTR)                         01S0052 00112000
*       SENSEPTR=SDATAPTR;          /* SAVE POINTER TO FMT4 SENSE       00113000
*                                      DATA INPUT            @Y30LB50*/ 00114000
         L     SENSEPTR,SDATAPTR(,CVTPTR)                       01S0053 00115000
*       IF(SSIDTYPE=DRCSSID)|(SSIDTYPE=DRDSSID) THEN            01S0054 00116000
         TM    SSIDTYPE(SENSEPTR),B'00000100'                   01S0054 00117000
         BNO   @GL00001                                         01S0054 00118000
         TM    SSIDTYPE(SENSEPTR),B'00001011'                   01S0054 00119000
         BZ    @RT00054                                         01S0054 00120000
@GL00001 TM    SSIDTYPE(SENSEPTR),B'00000010'                   01S0054 00121000
         BNO   @RF00054                                         01S0054 00122000
         TM    SSIDTYPE(SENSEPTR),B'00001101'                   01S0054 00123000
         BNZ   @RF00054                                         01S0054 00124000
@RT00054 DS    0H                                               01S0055 00125000
*         DO;                       /* PROCESS DRC SSID OR DRD SSID     00126000
*                                      ONLY                  @Y30LB50*/ 00127000
*                                                               02S0056 00128000
*   /*****************************************************************/ 00129000
*   /*                                                               */ 00130000
*   /* DATCSCHK IS CALLED TO INITIALIZE THE POINTER TO THE           */ 00131000
*   /* ACCUMULATOR BLOCK FOR THE CARTRIDGE STORE OF THE CURRENT      */ 00132000
*   /* INPUT. IT WILL ALSO CALL ISDAGET1 TO OBTAIN THE ACCUMULATOR   */ 00133000
*   /* BLOCK THE FIRST TIME A CARTRIDGE STORE IS ENCOUNTERED @Y30LB50*/ 00134000
*   /*                                                               */ 00135000
*   /*****************************************************************/ 00136000
*                                                               02S0056 00137000
*   CSNUMB=SUBSYSID;                /* ISOLATE CARTRIDGE STORE OF       00138000
*                                      INPUT                 @Y30LB50*/ 00139000
         MVC   CSNUMB(2,DATPTR),SUBSYSID(SENSEPTR)              02S0056 00140000
*   CSNUMB=CSNUMB&'00F0'X;          /*                       @Y30LB50*/ 00141000
         NC    CSNUMB(2,DATPTR),@CB00271                        02S0057 00142000
*   SRA(CSNUMB(2),4);               /*                       @Y30LB50*/ 00143000
         SLR   @05,@05                                          02S0058 00144000
         IC    @05,CSNUMB+1(,DATPTR)                            02S0058 00145000
         SRA   @05,4                                            02S0058 00146000
         STC   @05,CSNUMB+1(,DATPTR)                            02S0058 00147000
*   CSNUMB=CSNUMB+1;                /* CONVERT TO INDEX OF 1 TO 4       00148000
*                                                            @Y30LB50*/ 00149000
         LA    @05,1                                            02S0059 00150000
         SLR   @01,@01                                          02S0059 00151000
         ICM   @01,3,CSNUMB(DATPTR)                             02S0059 00152000
         ALR   @05,@01                                          02S0059 00153000
         STH   @05,CSNUMB(,DATPTR)                              02S0059 00154000
*   CSPTR=CSPTRS(CSNUMB);           /* ACCUMULATOR ADDRESS FOR THIS     00155000
*                                      CS                    @Y30LB50*/ 00156000
         SLA   @05,2                                            02S0060 00157000
         AL    @05,@CF00277                                     02S0060 00158000
         L     CSPTR,CSPTRS(@05,DATPTR)                         02S0060 00159000
*   IF CSPTR=0 THEN                                             02S0061 00160000
         LTR   CSPTR,CSPTR                                      02S0061 00161000
         BNZ   @RF00061                                         02S0061 00162000
*     DO;                           /* IF ADDRESS IS 0 , NO     02S0062 00163000
*                                      ACCUMULATOR HAS BEEN OBTAINED    00164000
*                                      FOR THIS CS PREVIOUSLY   02S0062 00165000
*                                                            @Y30LB50*/ 00166000
*       SPNO=DATSPNO;               /* SUBPOOL NUMBER FOR DAT   02S0063 00167000
*                                      ACCUMULATOR           @Y30LB50*/ 00168000
         MVC   SPNO(1,CVTPTR),DATSPNO                           02S0063 00169000
*       CORELEN=LENGTH(DATACCM);    /* LENGTH OF BLOCK NEEDED   02S0064 00170000
*                                                            @Y30LB50*/ 00171000
         MVC   CORELEN(3,CVTPTR),@CF00276+1                     02S0064 00172000
*       RFY                                                     02S0065 00173000
*         R1 RSTD;                  /*                       @Y30LB50*/ 00174000
*       R1=ADDR(WORKCALL);          /*                       @Y30LB50*/ 00175000
         LA    R1,WORKCALL(,CVTPTR)                             02S0066 00176000
*       CALL ISDAGET1;              /* REQUEST ACCUMULATOR BLOCK        00177000
*                                                            @Y30LB50*/ 00178000
         L     @15,@CV00265                                     02S0067 00179000
         BALR  @14,@15                                          02S0067 00180000
*       RFY                                                     02S0068 00181000
*         R1 UNRSTD;                /*                       @Y30LB50*/ 00182000
*       RFY                                                     02S0069 00183000
*         R15 RSTD;                 /*                       @Y30LB50*/ 00184000
*       RETRNREG=R15;               /* SAVE RETURN CODE FROM ISDAGET1   00185000
*                                                            @Y30LB50*/ 00186000
         LR    RETRNREG,R15                                     02S0070 00187000
*       RFY                                                     02S0071 00188000
*         R15 UNRSTD;               /*                       @Y30LB50*/ 00189000
*       IF RETRNREG=0 THEN                                      02S0072 00190000
         LTR   RETRNREG,RETRNREG                                02S0072 00191000
         BNZ   @RF00072                                         02S0072 00192000
*         DO;                       /* CONTINUE IF BLOCK OBTAINED       00193000
*                                                            @Y30LB50*/ 00194000
*           CSPTR=COREADDR;         /* SAVE PTR TO ACCUMULATOR IN       00195000
*                                      WORK AREA             @Y30LB50*/ 00196000
         L     CSPTR,COREADDR(,CVTPTR)                          02S0074 00197000
*           CSPTRS(CSNUMB)=CSPTR;   /*                       @Y30LB50*/ 00198000
         SLR   @05,@05                                          02S0075 00199000
         ICM   @05,3,CSNUMB(DATPTR)                             02S0075 00200000
         SLA   @05,2                                            02S0075 00201000
         AL    @05,@CF00277                                     02S0075 00202000
         ST    CSPTR,CSPTRS(@05,DATPTR)                         02S0075 00203000
*           BYTE0=''B;              /* ZERO THE ACCUMULATOR  @Y30LB50*/ 00204000
         XC    BYTE0(168,CSPTR),BYTE0(CSPTR)                    02S0076 00205000
*           BYTEBIT=''B;            /*                       @Y30LB50*/ 00206000
         SLR   @05,@05                                          02S0077 00207000
         STH   @05,BYTEBIT(,CSPTR)                              02S0077 00208000
*           BYTEBIT3=''B;           /*                       @Y30LB50*/ 00209000
         XC    BYTEBIT3(22,CSPTR),BYTEBIT3(CSPTR)               02S0078 00210000
*           BYTE1=''B;              /*                       @Y30LB50*/ 00211000
         XC    BYTE1(192,CSPTR),BYTE1(CSPTR)                    02S0079 00212000
*           BYTE2=''B;              /*                       @Y30LB50*/ 00213000
         XC    BYTE2(192,CSPTR),BYTE2(CSPTR)                    02S0080 00214000
*           BYTE3=''B;              /*                       @Y30LB50*/ 00215000
         XC    BYTE3(192,CSPTR),BYTE3(CSPTR)                    02S0081 00216000
*           BYTE4=''B;              /*                       @Y30LB50*/ 00217000
         XC    BYTE4(192,CSPTR),BYTE4(CSPTR)                    02S0082 00218000
*         END;                      /*                       @Y30LB50*/ 00219000
*       ELSE                                                    02S0084 00220000
*         ;                         /*                       @Y30LB50*/ 00221000
@RF00072 DS    0H                                               02S0085 00222000
*     END;                          /*                       @Y30LB50*/ 00223000
*   ELSE                                                        02S0086 00224000
*     ;                             /*                       @Y30LB50*/ 00225000
@RF00061 DS    0H                                               02S0087 00226000
*           IF RETRNREG=0 THEN      /* IF REQUESTED ACCUMULATOR COULD   00227000
*                                      NOT BE OBTAINED, DO NOT  01S0087 00228000
*                                      PROCESS FURTHUR       @Y30LB50*/ 00229000
         LTR   RETRNREG,RETRNREG                                01S0087 00230000
         BNZ   @RF00087                                         01S0087 00231000
*                                                               02S0088 00232000
*   /*****************************************************************/ 00233000
*   /*                                                               */ 00234000
*   /* DATCNTS IS USED TO MAINTAIN RUNNING COUNTS OF HOW MANY TIMES  */ 00235000
*   /* BITS IN MSC FORMAT 4 SENSE BYTES 4, 20, 21 AND 22 ARE         */ 00236000
*   /* ENCOUNTERED SET                                       @Y30LB50*/ 00237000
*   /*                                                               */ 00238000
*   /*****************************************************************/ 00239000
*                                                               02S0088 00240000
*   DO;                             /*                       @Y30LB50*/ 00241000
*     SSIDWORK=SUBSYSID;            /* ISOLATE THE DRC ID OR DRD ID     00242000
*                                                            @Y30LB50*/ 00243000
         MVC   SSIDWORK(2,DATPTR),SUBSYSID(SENSEPTR)            02S0089 00244000
*     SSIDWORK=SSIDWORK&'000F'X;    /*                       @Y30LB50*/ 00245000
         NC    SSIDWORK(2,DATPTR),@CB00273                      02S0090 00246000
*     IF SSIDTYPE=DRCSSID THEN                                  02S0091 00247000
         TM    SSIDTYPE(SENSEPTR),B'00000100'                   02S0091 00248000
         BNO   @RF00091                                         02S0091 00249000
         TM    SSIDTYPE(SENSEPTR),B'00001011'                   02S0091 00250000
         BNZ   @RF00091                                         02S0091 00251000
*       SSIDWORK=SSIDWORK*2;        /* DRC COUNTS ARE FIRST IN THE      00252000
*                                      ACCUMULATOR           @Y30LB50*/ 00253000
         SLR   @01,@01                                          02S0092 00254000
         ICM   @01,3,SSIDWORK(DATPTR)                           02S0092 00255000
         ALR   @01,@01                                          02S0092 00256000
         STH   @01,SSIDWORK(,DATPTR)                            02S0092 00257000
*     ELSE                                                      02S0093 00258000
*       SSIDWORK=(SSIDWORK+MAXDRC)*2;/* DRD COUNTS FOLLOW THE DRC       00259000
*                                      COUNTS IN THE ACCUMULATOR        00260000
*                                                            @Y30LB50*/ 00261000
         B     @RC00091                                         02S0093 00262000
@RF00091 LA    @01,4                                            02S0093 00263000
         SLR   @15,@15                                          02S0093 00264000
         ICM   @15,3,SSIDWORK(DATPTR)                           02S0093 00265000
         ALR   @01,@15                                          02S0093 00266000
         ALR   @01,@01                                          02S0093 00267000
         STH   @01,SSIDWORK(,DATPTR)                            02S0093 00268000
*     CSPTR=CSPTR+SSIDWORK;         /* SPACE UP IN ACCUMULATOR FOR      00269000
*                                      THIS INPUT            @Y30LB50*/ 00270000
@RC00091 SLR   @01,@01                                          02S0094 00271000
         ICM   @01,3,SSIDWORK(DATPTR)                           02S0094 00272000
         ALR   CSPTR,@01                                        02S0094 00273000
*     WORK1(1)=STATUS14;            /* COMPACT SENSE BYTES TO BE        00274000
*                                      EXAMINED              @Y30LB50*/ 00275000
         MVC   WORK1(1,DATPTR),STATUS14(SENSEPTR)               02S0095 00276000
*     WORK1(2)=STATUS24;            /*                       @Y30LB50*/ 00277000
         MVC   WORK1+1(1,DATPTR),STATUS24(SENSEPTR)             02S0096 00278000
*     WORK1(3)=BYTE9F4;             /*                       @Y30LB50*/ 00279000
         MVC   WORK1+2(1,DATPTR),BYTE9F4(SENSEPTR)              02S0097 00280000
*     WORK1(4)=BYTE10F4;            /*                       @Y30LB50*/ 00281000
         MVC   WORK1+3(1,DATPTR),BYTE10F4(SENSEPTR)             02S0098 00282000
*     WORK1(5)=BYTE11F4;            /*                       @Y30LB50*/ 00283000
         MVC   WORK1+4(1,DATPTR),BYTE11F4(SENSEPTR)             02S0099 00284000
*     DO I=1 TO MAXBITS;            /* EXAMINE EACH BIT OF DAT BYTES    00285000
*                                                            @Y30LB50*/ 00286000
         LA    @03,1                                            02S0100 00287000
         STH   @03,I(,DATPTR)                                   02S0100 00288000
@DL00100 DS    0H                                               02S0101 00289000
*       IF CURRBIT=ON THEN                                      02S0101 00290000
         TM    CURRBIT(DATPTR),B'10000000'                      02S0101 00291000
         BNO   @RF00101                                         02S0101 00292000
*         BYTEBIT=BYTEBIT+1;        /* IF BIT IS SET, INCREMENT THE     00293000
*                                      BIT COUNT FOR THIS DRC OR DRC    00294000
*                                                            @Y30LB50*/ 00295000
         LA    @03,1                                            02S0102 00296000
         AH    @03,BYTEBIT(,CSPTR)                              02S0102 00297000
         STH   @03,BYTEBIT(,CSPTR)                              02S0102 00298000
*       ELSE                                                    02S0103 00299000
*         ;                         /*                       @Y30LB50*/ 00300000
@RF00101 DS    0H                                               02S0104 00301000
*       SLDL(WORK1,1);              /* POSITION NEXT BIT     @Y30LB50*/ 00302000
         LM    @04,@05,WORK1(DATPTR)                            02S0104 00303000
         SLDL  @04,1                                            02S0104 00304000
         STM   @04,@05,WORK1(DATPTR)                            02S0104 00305000
*       CSPTR=CSPTR+LENGTH(BIT0);   /* UP POINTER TO BIT COUNT FOR      00306000
*                                      NEXT BIT FOR THIS DRC OR DRD     00307000
*                                                            @Y30LB50*/ 00308000
         AH    CSPTR,@CH00072                                   02S0105 00309000
*     END;                          /*                       @Y30LB50*/ 00310000
         LA    @03,1                                            02S0106 00311000
         AH    @03,I(,DATPTR)                                   02S0106 00312000
         STH   @03,I(,DATPTR)                                   02S0106 00313000
         CH    @03,@CH00097                                     02S0106 00314000
         BNH   @DL00100                                         02S0106 00315000
*   END;                            /*                       @Y30LB50*/ 00316000
*           ELSE                                                01S0108 00317000
*                                                               02S0108 00318000
*   /*****************************************************************/ 00319000
*   /*                                                               */ 00320000
*   /* FREEBLKS WILL RELEASE ALL DYNAMIC STORAGE VIA THE ISDAFREE    */ 00321000
*   /* ROUTINE.                                                      */ 00322000
*   /*                                                               */ 00323000
*   /*****************************************************************/ 00324000
*                                                               02S0108 00325000
*   DO;                             /*                       @Y30LB50*/ 00326000
         B     @RC00087                                         02S0108 00327000
@RF00087 DS    0H                                               02S0109 00328000
*     RFY                                                       02S0109 00329000
*       R1 RSTD;                    /*                       @Y30LB50*/ 00330000
*     DO I=1 TO MAXCS;              /* RELEASE BLOCKS FOR ALL CS        00331000
*                                                            @Y30LB50*/ 00332000
         LA    @05,1                                            02S0110 00333000
         STH   @05,I(,DATPTR)                                   02S0110 00334000
@DL00110 DS    0H                                               02S0111 00335000
*       COREADDR=CSPTRS(I);         /* ADDR OF ACCUM FOR THIS CS        00336000
*                                                            @Y30LB50*/ 00337000
         LH    @05,I(,DATPTR)                                   02S0111 00338000
         SLA   @05,2                                            02S0111 00339000
         AL    @05,@CF00277                                     02S0111 00340000
         L     @05,CSPTRS(@05,DATPTR)                           02S0111 00341000
         ST    @05,COREADDR(,CVTPTR)                            02S0111 00342000
*       IF COREADDR^=0 THEN                                     02S0112 00343000
         LTR   @05,@05                                          02S0112 00344000
         BZ    @RF00112                                         02S0112 00345000
*         DO;                       /* RELEASE PROCESSING IF ACCUM      00346000
*                                      OBTAINED              @Y30LB50*/ 00347000
*           SPNO=DATSPNO;           /* SUBPOOL NUMBER OF DAT ACCUM      00348000
*                                                            @Y30LB50*/ 00349000
         MVC   SPNO(1,CVTPTR),DATSPNO                           02S0114 00350000
*           CORELEN=LENGTH(DATACCM);/* LENGTH OF DAT ACCUM   @Y30LB50*/ 00351000
         MVC   CORELEN(3,CVTPTR),@CF00276+1                     02S0115 00352000
*           R1=ADDR(WORKCALL);      /*                       @Y30LB50*/ 00353000
         LA    R1,WORKCALL(,CVTPTR)                             02S0116 00354000
*           CALL ISDAFREE;          /* FREE ACCUM BLOCK      @Y30LB50*/ 00355000
         L     @15,@CV00266                                     02S0117 00356000
         BALR  @14,@15                                          02S0117 00357000
*         END;                      /*                       @Y30LB50*/ 00358000
*           ELSE                                                02S0119 00359000
*             ;                     /*                       @Y30LB50*/ 00360000
@RF00112 DS    0H                                               02S0120 00361000
*         END;                      /*                       @Y30LB50*/ 00362000
         LA    @05,1                                            02S0120 00363000
         AH    @05,I(,DATPTR)                                   02S0120 00364000
         STH   @05,I(,DATPTR)                                   02S0120 00365000
         CH    @05,@CH00104                                     02S0120 00366000
         BNH   @DL00110                                         02S0120 00367000
*       CDAT='00'X;                 /* SHUT OFF DAT REPORT CONTROL      00368000
*                                      FLAG                  @Y30LB50*/ 00369000
         MVI   CDAT(LPARMPTR),X'00'                             02S0121 00370000
*       R1=ADDR(WORKCALL);          /*                       @Y30LB50*/ 00371000
         LA    R1,WORKCALL(,CVTPTR)                             02S0122 00372000
*       CORELEN=LENGTH(DATWORK);    /* LENGTH OF WORKAREA    @Y30LB50*/ 00373000
         MVC   CORELEN(3,CVTPTR),@CF00275+1                     02S0123 00374000
*       SPNO=DATSPNO;               /* SUBPOOL NUMBER OF WORKAREA       00375000
*                                                            @Y30LB50*/ 00376000
         MVC   SPNO(1,CVTPTR),DATSPNO                           02S0124 00377000
*       COREADDR=DATPTR;            /* ADDR OF WORKAREA      @Y30LB50*/ 00378000
         ST    DATPTR,COREADDR(,CVTPTR)                         02S0125 00379000
*       CALL ISDAFREE;              /* FREE DAT WORKAREA     @Y30LB50*/ 00380000
         L     @15,@CV00266                                     02S0126 00381000
         BALR  @14,@15                                          02S0126 00382000
*       DAT00PTR=0;                 /* SET WORK PTR TO 0 FOR ISDASDA0   00383000
*                                                            @Y30LB50*/ 00384000
         SLR   @03,@03                                          02S0127 00385000
         ST    @03,DAT00PTR(,CVTPTR)                            02S0127 00386000
*       RFY                                                     02S0128 00387000
*         R1 UNRSTD;                /*                       @Y30LB50*/ 00388000
*     END;                          /*                       @Y30LB50*/ 00389000
*         END;                      /*                       @Y30LB50*/ 00390000
*       ELSE                                                    01S0131 00391000
*         ;                         /* CANNOT USE 4B WITH SA SSID       00392000
*                                                            @ZM31105*/ 00393000
@RF00054 DS    0H                                               01S0132 00394000
*     END;                          /*                       @Y30LB50*/ 00395000
*   ELSE                                                        01S0133 00396000
*     ;                             /*                       @Y30LB50*/ 00397000
@RF00050 DS    0H                                               01S0134 00398000
*   RETURN CODE(RETRNREG);          /*                       @Y30LB50*/ 00399000
@RC00050 L     @13,4(,@13)                                      01S0134 00400000
         L     @00,@SIZDATD                                     01S0134 00401000
         LR    @01,@11                                          01S0134 00402000
         ISDAFSPC R,LV=(0),A=(1)                                        00403000
         LR    @15,@09                                          01S0134 00404000
         L     @14,12(,@13)                                     01S0134 00405000
         LM    @00,@12,20(@13)                                  01S0134 00406000
         BR    @14                                              01S0134 00407000
*   END ISDADAT0                    /*                       @Y30LB50*/ 00408000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 00409000
*/*%INCLUDE SYSLIB  (ISDACVT )                                        * 00410000
*/*%INCLUDE SYSLIB  (ISDAMSCS)                                        * 00411000
*/*%INCLUDE SYSLIB  (ISDAMSC4)                                        * 00412000
*/*%INCLUDE SYSLIB  (ISDAPRMS)                                        * 00413000
*/*%INCLUDE SYSLIB  (ISDADAT5)                                        * 00414000
*/*%INCLUDE SYSUT5  (DAT0CNST)                                        * 00415000
*/*%INCLUDE SYSUT5  (DATINIT )                                        * 00416000
*/*%INCLUDE SYSUT5  (DATCSCHK)                                        * 00417000
*/*%INCLUDE SYSUT5  (DATCNTS )                                        * 00418000
*/*%INCLUDE SYSUT5  (FREEBLKS)                                        * 00419000
*;                                                              01S0135 00420000
@DATA    DS    0H                                                       00421000
@CH00104 DC    H'4'                                                     00422000
@CH00072 DC    H'24'                                                    00423000
@CH00097 DC    H'40'                                                    00424000
@DATD    DSECT                                                          00425000
         DS    0F                                                       00426000
@SA00001 DS    18F                                                      00427000
@PC00001 DS    1F                                                       00428000
ISDADAT0 CSECT                                                          00429000
         DS    0F                                                       00430000
@CF00275 DC    F'48'                                                    00431000
@CF00276 DC    F'960'                                                   00432000
@CF00277 DC    F'-4'                                                    00433000
@DATD    DSECT                                                          00434000
         DS    0D                                                       00435000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                00436000
@ENDDATD EQU   *                                                        00437000
ISDADAT0 CSECT                                                          00438000
         NOPR  ((@ENDDATD-@DATD)/161*16)                                00439000
         DS    0F                                                       00440000
@SIZDATD DC    AL1(0)                                                   00441000
         DC    AL3(@ENDDATD-@DATD)                                      00442000
@CV00265 DC    V(ISDAGET1)                                              00443000
@CV00266 DC    V(ISDAFREE)                                              00444000
         DS    0D                                                       00445000
@CB00271 DC    X'00F0'                                                  00446000
@CB00273 DC    X'000F'                                                  00447000
DATSPNO  DC    X'00'                                                    00448000
PATCH    DS    CL50                                                     00449000
         ORG   PATCH                                                    00450000
@NM00007 DC    50X'00'                                                  00451000
         ORG   PATCH+50                                                 00452000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00453000
@01      EQU   01                                                       00454000
@02      EQU   02                                                       00455000
@03      EQU   03                                                       00456000
@04      EQU   04                                                       00457000
@05      EQU   05                                                       00458000
@06      EQU   06                                                       00459000
@07      EQU   07                                                       00460000
@08      EQU   08                                                       00461000
@09      EQU   09                                                       00462000
@10      EQU   10                                                       00463000
@11      EQU   11                                                       00464000
@12      EQU   12                                                       00465000
@13      EQU   13                                                       00466000
@14      EQU   14                                                       00467000
@15      EQU   15                                                       00468000
LPARMPTR EQU   @04                                                      00469000
SENSEPTR EQU   @03                                                      00470000
CVTPTR   EQU   @02                                                      00471000
DATPTR   EQU   @10                                                      00472000
CSPTR    EQU   @08                                                      00473000
RETRNREG EQU   @09                                                      00474000
R1       EQU   @01                                                      00475000
R0       EQU   @00                                                      00476000
R15      EQU   @15                                                      00477000
ISDACVT  EQU   0                                                        00478000
CVTPTRS0 EQU   ISDACVT                                                  00479000
SDATAPTR EQU   CVTPTRS0+4                                               00480000
PARMPTR  EQU   CVTPTRS0+8                                               00481000
DAT00PTR EQU   CVTPTRS0+72                                              00482000
WORKCALL EQU   CVTPTRS0+96                                              00483000
GET0CALL EQU   ISDACVT+100                                              00484000
SPNOLEN  EQU   GET0CALL                                                 00485000
SPNO     EQU   SPNOLEN                                                  00486000
CORELEN  EQU   SPNOLEN+1                                                00487000
COREADDR EQU   GET0CALL+4                                               00488000
HEXPCALL EQU   ISDACVT+108                                              00489000
PRT0CALL EQU   ISDACVT+120                                              00490000
OUTLINE  EQU   PRT0CALL                                                 00491000
SDADATD  EQU   ISDACVT+256                                              00492000
PRTDATD  EQU   ISDACVT+416                                              00493000
ISDAMSCS EQU   0                                                        00494000
SUBSYSID EQU   ISDAMSCS+1                                               00495000
SSID     EQU   SUBSYSID                                                 00496000
SSIDTYPE EQU   SSID                                                     00497000
SUBSENSE EQU   ISDAMSCS+4                                               00498000
SUBFMTMG EQU   SUBSENSE+7                                               00499000
ISDAMSC4 EQU   4                                                        00500000
STATUS14 EQU   ISDAMSC4                                                 00501000
STATUS24 EQU   ISDAMSC4+1                                               00502000
FMTMSG4  EQU   ISDAMSC4+7                                               00503000
SASENSE  EQU   ISDAMSC4+8                                               00504000
BYTE9F4  EQU   SASENSE+1                                                00505000
BYTE10F4 EQU   SASENSE+2                                                00506000
BYTE11F4 EQU   SASENSE+3                                                00507000
ISDAPRMS EQU   0                                                        00508000
CINPUT   EQU   ISDAPRMS                                                 00509000
CSTART   EQU   ISDAPRMS+2                                               00510000
CEND     EQU   ISDAPRMS+6                                               00511000
CFSCONLY EQU   ISDAPRMS+13                                              00512000
CSSIDF   EQU   ISDAPRMS+17                                              00513000
CSERIAL  EQU   ISDAPRMS+21                                              00514000
CREPORTS EQU   ISDAPRMS+33                                              00515000
CDAT     EQU   CREPORTS+8                                               00516000
DATWORK  EQU   0                                                        00517000
CSPTRS   EQU   DATWORK                                                  00518000
WORK1    EQU   DATWORK+20                                               00519000
WORK2    EQU   WORK1                                                    00520000
CURRBIT  EQU   WORK2                                                    00521000
I        EQU   DATWORK+28                                               00522000
HOLDDBL  EQU   DATWORK+40                                               00523000
HOLD     EQU   HOLDDBL+4                                                00524000
HOLD1    EQU   HOLD+1                                                   00525000
CSNUMB   EQU   HOLD1                                                    00526000
SSIDWORK EQU   CSNUMB                                                   00527000
DATACCM  EQU   0                                                        00528000
BYTEBIT  EQU   DATACCM                                                  00529000
BYTEBIT3 EQU   DATACCM+2                                                00530000
BYTE0    EQU   DATACCM+24                                               00531000
BIT0     EQU   BYTE0                                                    00532000
BYTE1    EQU   DATACCM+192                                              00533000
BYTE2    EQU   DATACCM+384                                              00534000
BYTE3    EQU   DATACCM+576                                              00535000
BYTE4    EQU   DATACCM+768                                              00536000
WORKPTR  EQU   0                                                        00537000
*                                      START UNREFERENCED COMPONENTS    00538000
BITN     EQU   BYTE0+24                                                 00539000
XXX      EQU   HOLD1+2                                                  00540000
HOLD2    EQU   HOLD                                                     00541000
HOLD0    EQU   HOLDDBL                                                  00542000
LOOPEND  EQU   DATWORK+38                                               00543000
M        EQU   DATWORK+36                                               00544000
L        EQU   DATWORK+34                                               00545000
K        EQU   DATWORK+32                                               00546000
J        EQU   DATWORK+30                                               00547000
WORK3    EQU   WORK1+1                                                  00548000
RESTBITS EQU   WORK2                                                    00549000
TSUM     EQU   DATWORK+16                                               00550000
CTRACE   EQU   ISDAPRMS+48                                              00551000
CGEN     EQU   ISDAPRMS+47                                              00552000
CDETAIL  EQU   ISDAPRMS+46                                              00553000
CPERIOD  EQU   ISDAPRMS+45                                              00554000
CPWR     EQU   CREPORTS+11                                              00555000
CAPRSUU  EQU   CREPORTS+10                                              00556000
CDRC     EQU   CREPORTS+9                                               00557000
CCSBCSF  EQU   CREPORTS+7                                               00558000
CDCKTLX  EQU   CREPORTS+6                                               00559000
CEQC     EQU   CREPORTS+5                                               00560000
CFSC     EQU   CREPORTS+4                                               00561000
CDHEDHU  EQU   CREPORTS+3                                               00562000
CSUM     EQU   CREPORTS+2                                               00563000
CPAD     EQU   CREPORTS+1                                               00564000
CDCS     EQU   CREPORTS                                                 00565000
CSERNO   EQU   CSERIAL+4                                                00566000
@NM00006 EQU   CSERIAL+3                                                00567000
CIBM     EQU   CSERIAL                                                  00568000
CRATIO   EQU   ISDAPRMS+19                                              00569000
CSSID    EQU   CSSIDF                                                   00570000
@NM00005 EQU   CSSIDF                                                   00571000
CFSC34   EQU   CFSCONLY+2                                               00572000
CFSC12   EQU   CFSCONLY                                                 00573000
CTYPE    EQU   ISDAPRMS+11                                              00574000
CSUMMARY EQU   ISDAPRMS+10                                              00575000
CENDDAY  EQU   CEND+2                                                   00576000
CENDYEAR EQU   CEND                                                     00577000
CSTDAY   EQU   CSTART+2                                                 00578000
CSTYEAR  EQU   CSTART                                                   00579000
CHISTIN  EQU   CINPUT+1                                                 00580000
CLOGIN   EQU   CINPUT                                                   00581000
BYTE27F4 EQU   SASENSE+19                                               00582000
BYTE26F4 EQU   SASENSE+18                                               00583000
BYTE25F4 EQU   SASENSE+17                                               00584000
BYTE24F4 EQU   SASENSE+16                                               00585000
FSCFMT4  EQU   SASENSE+14                                               00586000
BYTE21F4 EQU   SASENSE+13                                               00587000
BYTE20F4 EQU   SASENSE+12                                               00588000
BYTE19F4 EQU   SASENSE+11                                               00589000
BYTE18F4 EQU   SASENSE+10                                               00590000
BYTE17F4 EQU   SASENSE+9                                                00591000
BYTE16F4 EQU   SASENSE+8                                                00592000
BYTE15F4 EQU   SASENSE+7                                                00593000
BYTE14F4 EQU   SASENSE+6                                                00594000
BYTE13F4 EQU   SASENSE+5                                                00595000
BYTE12F4 EQU   SASENSE+4                                                00596000
BYTE8F4  EQU   SASENSE                                                  00597000
MSGCODE4 EQU   FMTMSG4                                                  00598000
SUBFMTN4 EQU   FMTMSG4                                                  00599000
LOWADDF4 EQU   ISDAMSC4+6                                               00600000
RETRYF4  EQU   ISDAMSC4+5                                               00601000
@NM00004 EQU   ISDAMSC4+4                                               00602000
CMDERRF4 EQU   ISDAMSC4+3                                               00603000
CHADDRF4 EQU   ISDAMSC4+2                                               00604000
SANOMSCD EQU   SUBSENSE+27                                              00605000
RCYLMSCD EQU   SUBSENSE+25                                              00606000
RUAMSCD  EQU   SUBSENSE+24                                              00607000
MSCFSC   EQU   SUBSENSE+22                                              00608000
@NM00003 EQU   SUBSENSE+21                                              00609000
RUADASD  EQU   SUBSENSE+20                                              00610000
DASDFSC  EQU   SUBSENSE+18                                              00611000
@NM00002 EQU   SUBSENSE+8                                               00612000
MSGCODEN EQU   SUBFMTMG                                                 00613000
SUBFMTNO EQU   SUBFMTMG                                                 00614000
SALOWAD2 EQU   SUBSENSE+6                                               00615000
SARETRY  EQU   SUBSENSE+5                                               00616000
@NM00001 EQU   SUBSENSE+4                                               00617000
DASDFMTN EQU   SUBSENSE+3                                               00618000
SALOWADD EQU   SUBSENSE+2                                               00619000
SUBSTAT5 EQU   SUBSENSE+1                                               00620000
SUBSTAT4 EQU   SUBSENSE                                                 00621000
FORMATNO EQU   ISDAMSCS+3                                               00622000
SSIDDEVT EQU   SSID+1                                                   00623000
SSIDLIBN EQU   SSID+1                                                   00624000
SSIDFLAG EQU   SUBSYSID                                                 00625000
STATUS   EQU   ISDAMSCS                                                 00626000
PRTSA001 EQU   PRTDATD                                                  00627000
SDATEMPS EQU   SDADATD+136                                              00628000
SDASA002 EQU   SDADATD+76                                               00629000
SDAPC001 EQU   SDADATD+72                                               00630000
SDASA001 EQU   SDADATD                                                  00631000
SDARPTID EQU   PRT0CALL+133                                             00632000
LINE     EQU   OUTLINE+1                                                00633000
ANSI     EQU   OUTLINE                                                  00634000
DUMPIDNO EQU   HEXPCALL+8                                               00635000
DUMPLEN  EQU   HEXPCALL+4                                               00636000
DUMPADDR EQU   HEXPCALL                                                 00637000
GEN00PTR EQU   CVTPTRS0+92                                              00638000
CNFG0PTR EQU   CVTPTRS0+88                                              00639000
PWR00PTR EQU   CVTPTRS0+84                                              00640000
APR00PTR EQU   CVTPTRS0+80                                              00641000
DRC00PTR EQU   CVTPTRS0+76                                              00642000
CSB00PTR EQU   CVTPTRS0+68                                              00643000
DCK00PTR EQU   CVTPTRS0+64                                              00644000
EQC00PTR EQU   CVTPTRS0+60                                              00645000
FSC00PTR EQU   CVTPTRS0+56                                              00646000
DHE00PTR EQU   CVTPTRS0+52                                              00647000
SUM00PTR EQU   CVTPTRS0+48                                              00648000
PAD00PTR EQU   CVTPTRS0+44                                              00649000
DCS00PTR EQU   CVTPTRS0+40                                              00650000
LOG00PTR EQU   CVTPTRS0+36                                              00651000
HIST0PTR EQU   CVTPTRS0+32                                              00652000
PRT00PTR EQU   CVTPTRS0+28                                              00653000
GET00PTR EQU   CVTPTRS0+24                                              00654000
TYPE0PTR EQU   CVTPTRS0+20                                              00655000
PARM0PTR EQU   CVTPTRS0+16                                              00656000
SDA00PTR EQU   CVTPTRS0+12                                              00657000
DATAPTR  EQU   CVTPTRS0                                                 00658000
*                                      END UNREFERENCED COMPONENTS      00659000
@RC00041 EQU   @RC00031                                                 00660000
@RC00054 EQU   @RC00050                                                 00661000
@RC00087 EQU   @RC00054                                                 00662000
@ENDDATA EQU   *                                                        00663000
         END   ISDADAT0,(C'PLS2226',0603,75312)                         00664000
