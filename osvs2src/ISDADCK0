         TITLE 'ISDADCK0 ACCUMULATOR FOR DCK TLX                       *00001000
                        '                                               00002000
ISDADCK0 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(8)                                              0001 00007000
         DC    C'ISDADCK0'                                         0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @11,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@11                                         0001 00013000
         L     @00,@SIZDATD                                        0001 00014000
         ISDAGSPC R,LV=(0)                                              00015000
         LR    @12,@01                                             0001 00016000
         USING @DATD,@12                                           0001 00017000
         ST    @13,@SA00001+4                                      0001 00018000
         LM    @00,@01,20(@13)                                     0001 00019000
         ST    @12,8(,@13)                                         0001 00020000
         LR    @13,@12                                             0001 00021000
         MVC   @PC00001(4),0(@01)                                  0001 00022000
*                                                                  0029 00023000
*   /*****************************************************************/ 00024000
*   /*                                                               */ 00025000
*   /* HOUSEKEEPING                                                  */ 00026000
*   /*                                                               */ 00027000
*   /*****************************************************************/ 00028000
*                                                                  0029 00029000
*   CVTPTR=WORKPTR;                 /*                       @Y30LB54*/ 00030000
         L     @10,@PC00001                                        0029 00031000
         L     CVTPTR,WORKPTR(,@10)                                0029 00032000
*   RETCODE=0;                      /* SET RETURN CODE ZERO  @ZMTPM01*/ 00033000
         SLR   @07,@07                                             0030 00034000
         LR    RETCODE,@07                                         0030 00035000
*   DCKWKPTR=DCK00PTR;              /* SET LOCAL WORK PTR    @ZM30975*/ 00036000
         L     @15,DCK00PTR(,CVTPTR)                               0031 00037000
         LR    DCKWKPTR,@15                                        0031 00038000
*   SENSEPTR=SDATAPTR;              /* SET LOCAL SENSE PTR   @ZM30975*/ 00039000
         L     SENSEPTR,SDATAPTR(,CVTPTR)                          0032 00040000
*   LPARMPTR=PARMPTR;               /* SET LOCAL PARM PTR    @ZM30975*/ 00041000
         L     LPARMPTR,PARMPTR(,CVTPTR)                           0033 00042000
*   IF DCK00PTR=0 THEN              /* FIRST TIME SWITCH     @Y30LB54*/ 00043000
         CR    @15,@07                                             0034 00044000
         BNE   @RF00034                                            0034 00045000
*     DO;                           /*                       @Y30LB54*/ 00046000
*       SPNO=0;                     /* WANT SUBPOOL ZERO     @Y30LB54*/ 00047000
         MVI   SPNO(CVTPTR),X'00'                                  0036 00048000
*       CORELEN=LENGTH(WORKCORE);   /*                       @Y30LB54*/ 00049000
         MVC   CORELEN(3,CVTPTR),@CF00340+1                        0037 00050000
*       CALL ISDAGET1(WORKPTR);     /*                       @Y30LB54*/ 00051000
         ST    @10,@AL00001                                        0038 00052000
         L     @15,@CV00040                                        0038 00053000
         LA    @01,@AL00001                                        0038 00054000
         BALR  @14,@15                                             0038 00055000
*       RFY                                                        0039 00056000
*         R15 RSTD;                 /*                       @Y30LB54*/ 00057000
*       RETCODE=R15;                /*                       @Y30LB54*/ 00058000
         LR    RETCODE,R15                                         0040 00059000
*       RFY                                                        0041 00060000
*         R15 UNRSTD;               /*                       @Y30LB54*/ 00061000
*       IF RETCODE=0 THEN                                          0042 00062000
         LTR   RETCODE,RETCODE                                     0042 00063000
         BNZ   @RF00042                                            0042 00064000
*         DO;                       /*                       @Y30LB54*/ 00065000
*           DCK00PTR=COREADDR;      /*                       @Y30LB54*/ 00066000
         L     @10,COREADDR(,CVTPTR)                               0044 00067000
         ST    @10,DCK00PTR(,CVTPTR)                               0044 00068000
*           DCKWKPTR=COREADDR;      /* SET LOCAL WORK PTR    @ZM30975*/ 00069000
         LR    DCKWKPTR,@10                                        0045 00070000
*         END;                      /*                       @Y30LB54*/ 00071000
*       ELSE                                                       0047 00072000
*         DO;                       /*                       @Y30LB54*/ 00073000
         B     @RC00042                                            0047 00074000
@RF00042 DS    0H                                                  0048 00075000
*           RETCODE=4;              /*                       @Y30LB54*/ 00076000
         LA    RETCODE,4                                           0048 00077000
*           CDCKTLX='00'X;          /* TURN OFF CALL PARM    @ZM30975*/ 00078000
         MVI   CDCKTLX(LPARMPTR),X'00'                             0049 00079000
*           RETURN CODE(RETCODE);   /*                       @Y30LB54*/ 00080000
         L     @13,4(,@13)                                         0050 00081000
         L     @00,@SIZDATD                                        0050 00082000
         LR    @01,@12                                             0050 00083000
         ISDAFSPC R,LV=(0),A=(1)                                        00084000
         LR    @15,@04                                             0050 00085000
         L     @14,12(,@13)                                        0050 00086000
         LM    @00,@12,20(@13)                                     0050 00087000
         BR    @14                                                 0050 00088000
*         END;                      /*                       @Y30LB54*/ 00089000
*       COUNTRP8=0;                 /* NUMBER OF TIMES RPT 8 COUNTERS   00090000
*                                      ADDED TO              @Y30LB54*/ 00091000
@RC00042 SLR   @10,@10                                             0052 00092000
         ST    @10,COUNTRP8(,DCKWKPTR)                             0052 00093000
*       COUNTRP9=0;                 /* NUMBER OF TIMES RPT 9 COUNTERS   00094000
*                                      ADDED TO              @Y30LB54*/ 00095000
         ST    @10,COUNTRP9(,DCKWKPTR)                             0053 00096000
*       LIBTAB(1)=0;                /* RESET LIBRARY POINTERS TO 0 0054 00097000
*                                                            @Y30LB54*/ 00098000
         ST    @10,LIBTAB(,DCKWKPTR)                               0054 00099000
*       LIBTAB(2)=0;                /*                       @Y30LB54*/ 00100000
         ST    @10,LIBTAB+4(,DCKWKPTR)                             0055 00101000
*       LIBTAB(3)=0;                /*                       @Y30LB54*/ 00102000
         ST    @10,LIBTAB+8(,DCKWKPTR)                             0056 00103000
*       LIBTAB(4)=0;                /*                       @Y30LB54*/ 00104000
         ST    @10,LIBTAB+12(,DCKWKPTR)                            0057 00105000
*       LIBNO(1)='01'X;             /* SET UP LIBRARY COUNTER TABLE     00106000
*                                                            @Y30LB54*/ 00107000
         MVI   LIBNO(DCKWKPTR),X'01'                               0058 00108000
*       LIBNO(2)='02'X;             /*                       @Y30LB54*/ 00109000
         MVI   LIBNO+4(DCKWKPTR),X'02'                             0059 00110000
*       LIBNO(3)='03'X;             /*                       @Y30LB54*/ 00111000
         MVI   LIBNO+8(DCKWKPTR),X'03'                             0060 00112000
*       LIBNO(4)='04'X;             /*                       @Y30LB54*/ 00113000
         MVI   LIBNO+12(DCKWKPTR),X'04'                            0061 00114000
*     END;                          /*                       @Y30LB54*/ 00115000
*   ELSE                                                           0063 00116000
*     ;                             /*                       @Y30LB54*/ 00117000
@RF00034 DS    0H                                                  0064 00118000
*   LOGPTR=DATAPTR;                 /*                       @Y30LB54*/ 00119000
         MVC   LOGPTR(4,DCKWKPTR),DATAPTR(CVTPTR)                  0064 00120000
*                                                                  0065 00121000
*   /*****************************************************************/ 00122000
*   /*                                                               */ 00123000
*   /* MAIN LOGIC PULL ALL DATA TOGETHER AS NEEDED                   */ 00124000
*   /*                                                               */ 00125000
*   /*****************************************************************/ 00126000
*                                                                  0065 00127000
*   DATA08=TRPAT08;                 /* SET UP TRANSLATE TABLE@Y30LB54*/ 00128000
         MVC   DATA08(4,DCKWKPTR),TRPAT08                          0065 00129000
*   DATA09=TRPAT09;                 /* SET UP TRANSLATE TABLE@Y30LB54*/ 00130000
         MVC   DATA09(2,DCKWKPTR),TRPAT09                          0066 00131000
*   TR(DATA08,ISDAMSCS);            /* REACH INTO DATA AND PULL    0067 00132000
*                                      TOGETHER FIELDS       @Y30LB54*/ 00133000
         TR    DATA08(4,DCKWKPTR),ISDAMSCS(SENSEPTR)               0067 00134000
*   TR(DATA09,ISDAMSCS);            /* REACH INTO DATA AND PULL    0068 00135000
*                                      TOGETHER FIELDS       @Y30LB54*/ 00136000
         TR    DATA09(2,DCKWKPTR),ISDAMSCS(SENSEPTR)               0068 00137000
*   FULLWD1=SUBSYSID;               /* GET SSID AND LIBRARY NO     0069 00138000
*                                                            @Y30LB54*/ 00139000
         SLR   @10,@10                                             0069 00140000
         ICM   @10,3,SUBSYSID(SENSEPTR)                            0069 00141000
         ST    @10,FULLWD1(,DCKWKPTR)                              0069 00142000
*   DATASSID=FULLWD1&'0000000F'X;   /* STRIP OFF SSID        @Y30LB54*/ 00143000
         N     @10,@CF00316                                        0070 00144000
         ST    @10,DATASSID(,DCKWKPTR)                             0070 00145000
*   IF DATASSID>7 THEN              /* VALIDATE SSID         @Y30LB54*/ 00146000
         CH    @10,@CH00317                                        0071 00147000
         BNH   @RF00071                                            0071 00148000
*     DO;                           /*                       @Y30LB54*/ 00149000
*       RETCODE=8;                  /*                       @Y30LB54*/ 00150000
         LA    RETCODE,8                                           0073 00151000
*       RETURN CODE(RETCODE);       /*                       @Y30LB54*/ 00152000
         L     @13,4(,@13)                                         0074 00153000
         L     @00,@SIZDATD                                        0074 00154000
         LR    @01,@12                                             0074 00155000
         ISDAFSPC R,LV=(0),A=(1)                                        00156000
         LR    @15,@04                                             0074 00157000
         L     @14,12(,@13)                                        0074 00158000
         LM    @00,@12,20(@13)                                     0074 00159000
         BR    @14                                                 0074 00160000
*     END;                          /*                       @Y30LB54*/ 00161000
*   ELSE                                                           0076 00162000
*     IF SSIDTYPE(3)^='1'B THEN                                    0076 00163000
@RF00071 TM    SSIDTYPE(SENSEPTR),B'00000010'                      0076 00164000
         BO    @RF00076                                            0076 00165000
*       DO;                         /*                       @Y30LB54*/ 00166000
*         RETCODE=0;                /* DO NOT FLAG DRC SSID  @ZM02889*/ 00167000
         SLR   RETCODE,RETCODE                                     0078 00168000
*         RETURN CODE(RETCODE);     /*                       @Y301B54*/ 00169000
         L     @13,4(,@13)                                         0079 00170000
         L     @00,@SIZDATD                                        0079 00171000
         LR    @01,@12                                             0079 00172000
         ISDAFSPC R,LV=(0),A=(1)                                        00173000
         LR    @15,@04                                             0079 00174000
         L     @14,12(,@13)                                        0079 00175000
         LM    @00,@12,20(@13)                                     0079 00176000
         BR    @14                                                 0079 00177000
*       END;                        /*                       @Y30LB54*/ 00178000
*     ELSE                                                         0081 00179000
*       ;                           /*                       @Y301B54*/ 00180000
@RF00076 DS    0H                                                  0082 00181000
*   DATALIB=FULLWD1&'000000F0'X;    /* STRIP OFF LIBRARY NO  @Y30LB54*/ 00182000
         L     @10,FULLWD1(,DCKWKPTR)                              0082 00183000
         N     @10,@CF00319                                        0082 00184000
         ST    @10,DATALIB(,DCKWKPTR)                              0082 00185000
*   SRL(DATALIB,4);                 /* SHIFT IT TO UNITS POSITION  0083 00186000
*                                                            @Y30LB54*/ 00187000
         L     @10,DATALIB(,DCKWKPTR)                              0083 00188000
         SRL   @10,4                                               0083 00189000
         ST    @10,DATALIB(,DCKWKPTR)                              0083 00190000
*   DATALIB=DATALIB+1;              /* ALLOW FOR STARTING AT LIBRARY    00191000
*                                      0                     @Y30LB54*/ 00192000
*                                                                  0084 00193000
         LA    @10,1                                               0084 00194000
         AL    @10,DATALIB(,DCKWKPTR)                              0084 00195000
         ST    @10,DATALIB(,DCKWKPTR)                              0084 00196000
*   /*****************************************************************/ 00197000
*   /*                                                               */ 00198000
*   /* DISPATCHER                                                    */ 00199000
*   /*                                                               */ 00200000
*   /*****************************************************************/ 00201000
*                                                                  0085 00202000
*   CALL LIBMATCH;                  /* DETERMINE IF WE HAD LIBRARY 0085 00203000
*                                      BEFORE                @Y30LB54*/ 00204000
         BAL   @14,LIBMATCH                                        0085 00205000
*   IF RETCODE^=0 THEN              /* MUST HAVE HAD CORE PROBLEMS OR   00206000
*                                      INPUT ERROR           @Y30LB54*/ 00207000
         LTR   RETCODE,RETCODE                                     0086 00208000
         BZ    @RF00086                                            0086 00209000
*     RETURN CODE(RETCODE);         /*                       @Y30LB54*/ 00210000
         L     @13,4(,@13)                                         0087 00211000
         L     @00,@SIZDATD                                        0087 00212000
         LR    @01,@12                                             0087 00213000
         ISDAFSPC R,LV=(0),A=(1)                                        00214000
         LR    @15,@04                                             0087 00215000
         L     @14,12(,@13)                                        0087 00216000
         LM    @00,@12,20(@13)                                     0087 00217000
         BR    @14                                                 0087 00218000
*   ELSE                                                           0088 00219000
*     ;                             /*                       @Y30LB54*/ 00220000
*                                                                  0088 00221000
@RF00086 DS    0H                                                  0089 00222000
*   /*****************************************************************/ 00223000
*   /*                                                               */ 00224000
*   /* OUTPUT OF THIS IS PTRLIB HAS POINTER TO COUNTERS              */ 00225000
*   /*                                                               */ 00226000
*   /*****************************************************************/ 00227000
*                                                                  0089 00228000
*   PTRSSID=DATASSID*2;             /* TWO BYTE COUNTERS TIMES SSID     00229000
*                                      NO                    @Y30LB54*/ 00230000
*                                                                  0089 00231000
         L     @10,DATASSID(,DCKWKPTR)                             0089 00232000
         ALR   @10,@10                                             0089 00233000
         ST    @10,PTRSSID(,DCKWKPTR)                              0089 00234000
*   /*****************************************************************/ 00235000
*   /*                                                               */ 00236000
*   /* COMPUTE DISPLACEMENTS AND ADD ONE TO COUNTERS                 */ 00237000
*   /*                                                               */ 00238000
*   /*****************************************************************/ 00239000
*                                                                  0090 00240000
*   CHAR4(1:1)=CDCKTLX&'01'X;       /* CONVERT TO LOOK AT DCK ONLY 0090 00241000
*                                                            @Y30LB54*/ 00242000
         MVC   CHAR4(1,DCKWKPTR),CDCKTLX(LPARMPTR)                 0090 00243000
         NI    CHAR4(DCKWKPTR),X'01'                               0090 00244000
*   IF CHAR4(1:1)='01'X THEN                                       0091 00245000
         CLI   CHAR4(DCKWKPTR),X'01'                               0091 00246000
         BNE   @RF00091                                            0091 00247000
*     DO;                           /*                       @Y30LB54*/ 00248000
*       CALL RPT8FILL;              /* DO DCK COUNTERS       @Y30LB54*/ 00249000
         BAL   @14,RPT8FILL                                        0093 00250000
*       IF RETCODE^=0 THEN          /* ERROR ON INPUT        @Y30LB54*/ 00251000
         LTR   RETCODE,RETCODE                                     0094 00252000
         BZ    @RF00094                                            0094 00253000
*         RETURN CODE(RETCODE);     /*                       @Y30LB54*/ 00254000
         L     @13,4(,@13)                                         0095 00255000
         L     @00,@SIZDATD                                        0095 00256000
         LR    @01,@12                                             0095 00257000
         ISDAFSPC R,LV=(0),A=(1)                                        00258000
         LR    @15,@04                                             0095 00259000
         L     @14,12(,@13)                                        0095 00260000
         LM    @00,@12,20(@13)                                     0095 00261000
         BR    @14                                                 0095 00262000
*     END;                          /*                       @Y30LB54*/ 00263000
*   ELSE                                                           0097 00264000
*     ;                             /*                       @Y30LB54*/ 00265000
@RF00091 DS    0H                                                  0098 00266000
*   CHAR4(1:1)=CDCKTLX&'02'X;       /* CONVERT TO LOOK ONLY AT TLX 0098 00267000
*                                                            @Y30LB54*/ 00268000
@RC00091 MVC   CHAR4(1,DCKWKPTR),CDCKTLX(LPARMPTR)                 0098 00269000
         NI    CHAR4(DCKWKPTR),X'02'                               0098 00270000
*   IF CHAR4(1:1)='02'X THEN                                       0099 00271000
         CLI   CHAR4(DCKWKPTR),X'02'                               0099 00272000
         BNE   @RF00099                                            0099 00273000
*     DO;                           /*                       @Y30LB54*/ 00274000
*       CALL RPT9FILL;              /* DO TLX COUNTERS       @Y30LB54*/ 00275000
         BAL   @14,RPT9FILL                                        0101 00276000
*       IF RETCODE^=0 THEN          /* MUST HAVE HAD ERROR ON INPUT     00277000
*                                                            @Y30LB54*/ 00278000
         LTR   RETCODE,RETCODE                                     0102 00279000
         BZ    @RF00102                                            0102 00280000
*         RETURN CODE(RETCODE);     /*                       @Y30LB54*/ 00281000
         L     @13,4(,@13)                                         0103 00282000
         L     @00,@SIZDATD                                        0103 00283000
         LR    @01,@12                                             0103 00284000
         ISDAFSPC R,LV=(0),A=(1)                                        00285000
         LR    @15,@04                                             0103 00286000
         L     @14,12(,@13)                                        0103 00287000
         LM    @00,@12,20(@13)                                     0103 00288000
         BR    @14                                                 0103 00289000
*     END;                          /*                       @Y30LB54*/ 00290000
*   ELSE                                                           0105 00291000
*     ;                             /*                       @Y30LB54*/ 00292000
*                                                                  0105 00293000
@RF00099 DS    0H                                                  0106 00294000
*   /*****************************************************************/ 00295000
*   /*                                                               */ 00296000
*   /* THATS IT FOR THIS RECORD                                      */ 00297000
*   /*                                                               */ 00298000
*   /*****************************************************************/ 00299000
*                                                                  0106 00300000
*/*ADDRESS STOP AT THIS POINT                                @Y30LB54   00301000
*                                                            @Y30LB54*/ 00302000
*                                                                  0106 00303000
*   RETURN CODE(RETCODE);           /* FINAL EXIT FROM ACCUMULATOR 0106 00304000
*                                      PORTION               @Y30LB54*/ 00305000
@RC00099 L     @13,4(,@13)                                         0106 00306000
         L     @00,@SIZDATD                                        0106 00307000
         LR    @01,@12                                             0106 00308000
         ISDAFSPC R,LV=(0),A=(1)                                        00309000
         LR    @15,@04                                             0106 00310000
         L     @14,12(,@13)                                        0106 00311000
         LM    @00,@12,20(@13)                                     0106 00312000
         BR    @14                                                 0106 00313000
*                                                                  0107 00314000
*   /*****************************************************************/ 00315000
*   /*                                                               */ 00316000
*   /* DID WE HAVE THIS LIBRARY BEFORE IF NOT GET CTRS               */ 00317000
*   /*                                                               */ 00318000
*   /*****************************************************************/ 00319000
*                                                                  0107 00320000
*LIBMATCH:                                                         0107 00321000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB54*/ 00322000
LIBMATCH ST    @14,@SA00002                                        0107 00323000
*   PTRLIB=0;                       /* FORCE IT TO FILL IN CORRECT 0108 00324000
*                                      ADDRESS               @Y30LB54*/ 00325000
         SLR   @10,@10                                             0108 00326000
         ST    @10,PTRLIB(,DCKWKPTR)                               0108 00327000
*   CHAR4=DATALIB;                  /* NEED TO MOVE IT TO CHAR AREA     00328000
*                                      FOR SUBSCRIPTING      @Y30LB54*/ 00329000
         MVC   CHAR4(4,DCKWKPTR),DATALIB(DCKWKPTR)                 0109 00330000
*   DO CTR=1 TO 4 BY 1;             /* FOUR LIBRARY REPORTS POSSIBLE    00331000
*                                                            @Y30LB54*/ 00332000
         LA    @10,1                                               0110 00333000
         ST    @10,CTR(,DCKWKPTR)                                  0110 00334000
@DL00110 DS    0H                                                  0111 00335000
*     IF CHAR4(4)=LIBNO(CTR) THEN   /* DO WE HAVE A VALID LIBRARY  0111 00336000
*                                                            @Y30LB54*/ 00337000
         L     @10,CTR(,DCKWKPTR)                                  0111 00338000
         SLA   @10,2                                               0111 00339000
         ST    @10,@TF00001                                        0111 00340000
         ALR   @10,DCKWKPTR                                        0111 00341000
         CLC   CHAR4+3(1,DCKWKPTR),LIBNO-4(@10)                    0111 00342000
         BNE   @RF00111                                            0111 00343000
*       DO;                         /*                       @Y30LB54*/ 00344000
*         IF LIBPTR(CTR)=0 THEN     /* DID WE HAVE ONE BEFORE@Y30LB54*/ 00345000
         L     @10,@TF00001                                        0113 00346000
         L     @10,LIBPTR-5(@10,DCKWKPTR)                          0113 00347000
         LA    @10,0(,@10)                                         0113 00348000
         LTR   @10,@10                                             0113 00349000
         BNZ   @RF00113                                            0113 00350000
*           DO;                     /*                       @Y30LB54*/ 00351000
*             SPNO=0;               /* INSERT SUBPULL ID WE WANT   0115 00352000
*                                                            @Y30LB54*/ 00353000
         MVI   SPNO(CVTPTR),X'00'                                  0115 00354000
*/*EACH LIBRARY HAS SET OF COUNTERS                          @Y30LB54*/ 00355000
*/* DCK      HAS 256 COUNTERS OF 2 BYTES FOR 512 BYTES       @Y30LB54*/ 00356000
*/* TLX      HAS 512 COUNTERS OF 2 BYTES FOR 1024 BYTES      @Y30LB54*/ 00357000
*/* TOTAL NUMBER OF COUNTERS = 768                           @Y30LB54*/ 00358000
*                                                                  0116 00359000
*             CORELEN=512+1024;     /* LENGTH OF COUNTERS    @Y30LB54*/ 00360000
         MVC   CORELEN(3,CVTPTR),@CF00341+1                        0116 00361000
*             CALL ISDAGET1(WORKPTR);/* GET THE CORE         @Y30LB54*/ 00362000
         L     @10,@PC00001                                        0117 00363000
         ST    @10,@AL00001                                        0117 00364000
         L     @15,@CV00040                                        0117 00365000
         LA    @01,@AL00001                                        0117 00366000
         BALR  @14,@15                                             0117 00367000
*             RFY                                                  0118 00368000
*               R15 RSTD;           /*                       @Y30LB54*/ 00369000
*             RETCODE=R15;          /* SAVE RETURN CODE FROM GETMAIN    00370000
*                                                            @Y30LB54*/ 00371000
         LR    RETCODE,R15                                         0119 00372000
*             RFY                                                  0120 00373000
*               R15 UNRSTD;         /* RELEASE REG 15 FOR OTHER USE     00374000
*                                                            @Y30LB54*/ 00375000
*             IF RETCODE=0 THEN                                    0121 00376000
         LTR   RETCODE,RETCODE                                     0121 00377000
         BNZ   @RF00121                                            0121 00378000
*               DO;                 /*                       @Y30LB54*/ 00379000
*                 PTRLIB=COREADDR;  /* POINT TO MY COUNTERS  @Y30LB54*/ 00380000
         L     @10,COREADDR(,CVTPTR)                               0123 00381000
         ST    @10,PTRLIB(,DCKWKPTR)                               0123 00382000
*                 LIBPTR(CTR)=PTRLIB;/*                      @Y30LB54*/ 00383000
         L     @07,CTR(,DCKWKPTR)                                  0124 00384000
         SLA   @07,2                                               0124 00385000
         ALR   @07,DCKWKPTR                                        0124 00386000
         STCM  @10,7,LIBPTR-4(@07)                                 0124 00387000
*                 CTR=100;          /* TERMINATE THE LOOP    @Y30LB54*/ 00388000
         MVC   CTR(4,DCKWKPTR),@CF00330                            0125 00389000
*                 KICKPTR=PTRLIB;   /* ZERO OUT THE GETMAIN CORE   0126 00390000
*                                                            @Y30LB54*/ 00391000
         ST    @10,KICKPTR(,DCKWKPTR)                              0126 00392000
*                 DO CTR1=1 TO 768 BY 1;/* THEY MAY CONTAIN JUNK   0127 00393000
*                                                            @Y30LB54*/ 00394000
         LA    @10,1                                               0127 00395000
         ST    @10,CTR1(,DCKWKPTR)                                 0127 00396000
@DL00127 DS    0H                                                  0128 00397000
*                   COUNTER(CTR1)=0;/*                       @Y30LB54*/ 00398000
         L     @10,CTR1(,DCKWKPTR)                                 0128 00399000
         ALR   @10,@10                                             0128 00400000
         L     @07,KICKPTR(,DCKWKPTR)                              0128 00401000
         SLR   @15,@15                                             0128 00402000
         AL    @07,@CF00343                                        0128 00403000
         STH   @15,COUNTER(@10,@07)                                0128 00404000
*                 END;              /*                       @Y30LB54*/ 00405000
         LA    @10,1                                               0129 00406000
         AL    @10,CTR1(,DCKWKPTR)                                 0129 00407000
         ST    @10,CTR1(,DCKWKPTR)                                 0129 00408000
         CH    @10,@CH00311                                        0129 00409000
         BNH   @DL00127                                            0129 00410000
*               END;                /*                       @Y30LB54*/ 00411000
*             ELSE                  /* NO CORE AVAILABLE     @Y30LB54*/ 00412000
*               DO;                 /*                       @Y30LB54*/ 00413000
         B     @RC00121                                            0131 00414000
@RF00121 DS    0H                                                  0132 00415000
*                 DO CTR1=1 TO 4 BY 1;/*                     @Y30LB54*/ 00416000
         LA    @10,1                                               0132 00417000
         ST    @10,CTR1(,DCKWKPTR)                                 0132 00418000
@DL00132 DS    0H                                                  0133 00419000
*                   IF LIBPTR(CTR1)^=0 THEN/* FREE ALL CORE ALREADY     00420000
*                                      OBTAINED              @Y30LB54*/ 00421000
         L     @10,CTR1(,DCKWKPTR)                                 0133 00422000
         SLA   @10,2                                               0133 00423000
         L     @10,LIBPTR-5(@10,DCKWKPTR)                          0133 00424000
         LA    @10,0(,@10)                                         0133 00425000
         LTR   @10,@10                                             0133 00426000
         BZ    @RF00133                                            0133 00427000
*                     DO;           /*                       @Y30LB54*/ 00428000
*                       SPNO=0;     /*                       @Y30LB54*/ 00429000
         MVI   SPNO(CVTPTR),X'00'                                  0135 00430000
*                       CORELEN=512+1024;/* FILL IN LENGTH OF AREA 0136 00431000
*                                                            @Y30LB54*/ 00432000
         MVC   CORELEN(3,CVTPTR),@CF00341+1                        0136 00433000
*                       COREADDR=LIBPTR(CTR1);/* FILL IN ADDRESS OF     00434000
*                                      AREA                  @Y30LB54*/ 00435000
         ST    @10,COREADDR(,CVTPTR)                               0137 00436000
*                       CALL ISDAFREE(WORKPTR);/*            @Y30LB54*/ 00437000
         L     @10,@PC00001                                        0138 00438000
         ST    @10,@AL00001                                        0138 00439000
         L     @15,@CV00041                                        0138 00440000
         LA    @01,@AL00001                                        0138 00441000
         BALR  @14,@15                                             0138 00442000
*                       LIBPTR(CTR1)=0;/* DELETE GOTTEN CORE PTR   0139 00443000
*                                                            @Y30LB54*/ 00444000
         L     @10,CTR1(,DCKWKPTR)                                 0139 00445000
         SLA   @10,2                                               0139 00446000
         ALR   @10,DCKWKPTR                                        0139 00447000
         SLR   @07,@07                                             0139 00448000
         STCM  @07,7,LIBPTR-4(@10)                                 0139 00449000
*                     END;          /*                       @Y30LB54*/ 00450000
*                   ELSE                                           0141 00451000
*                     ;             /*                       @Y30LB54*/ 00452000
@RF00133 DS    0H                                                  0142 00453000
*                 END;              /*                       @Y30LB54*/ 00454000
         LA    @10,1                                               0142 00455000
         AL    @10,CTR1(,DCKWKPTR)                                 0142 00456000
         ST    @10,CTR1(,DCKWKPTR)                                 0142 00457000
         CH    @10,@CH00050                                        0142 00458000
         BNH   @DL00132                                            0142 00459000
*                 CDCKTLX='00'X;    /* DONT LET CONTROL COME TO US 0143 00460000
*                                      AGAIN                 @Y30LB54*/ 00461000
         MVI   CDCKTLX(LPARMPTR),X'00'                             0143 00462000
*                 RETCODE=4;        /* TELL CONTROL WHY WE QUIT    0144 00463000
*                                                            @Y30LB54*/ 00464000
         LA    RETCODE,4                                           0144 00465000
*                 SPNO=0;           /* FREE WORKING CORE ALSO@Y30LB54*/ 00466000
         MVI   SPNO(CVTPTR),X'00'                                  0145 00467000
*                 CORELEN=LENGTH(WORKCORE);/* FILL IN LENGTH OF AREA    00468000
*                                                            @Y30LB54*/ 00469000
         MVC   CORELEN(3,CVTPTR),@CF00340+1                        0146 00470000
*                 COREADDR=DCK00PTR;/* FILL IN LOCATION ADDRESS    0147 00471000
*                                                            @Y30LB54*/ 00472000
         MVC   COREADDR(4,CVTPTR),DCK00PTR(CVTPTR)                 0147 00473000
*                 CALL ISDAFREE(WORKPTR);/*                  @Y30LB54*/ 00474000
         L     @10,@PC00001                                        0148 00475000
         ST    @10,@AL00001                                        0148 00476000
         L     @15,@CV00041                                        0148 00477000
         LA    @01,@AL00001                                        0148 00478000
         BALR  @14,@15                                             0148 00479000
*                 DCK00PTR=0;       /* TELL THE WORLD WE QUIT@Y30LB54*/ 00480000
         SLR   @10,@10                                             0149 00481000
         ST    @10,DCK00PTR(,CVTPTR)                               0149 00482000
*                 RETURN CODE(RETCODE);/*                    @Y30LB54*/ 00483000
         LR    @15,RETCODE                                         0150 00484000
@EL00002 DS    0H                                                  0150 00485000
@EF00002 DS    0H                                                  0150 00486000
@ER00002 L     @14,@SA00002                                        0150 00487000
         BR    @14                                                 0150 00488000
*               END;                /*                       @Y30LB54*/ 00489000
*           END;                    /*                       @Y30LB54*/ 00490000
*         ELSE                                                     0153 00491000
*           DO;                     /*                       @Y30LB54*/ 00492000
         B     @RC00113                                            0153 00493000
@RF00113 DS    0H                                                  0154 00494000
*             PTRLIB=LIBPTR(CTR);   /* USE OLD ONE           @Y30LB54*/ 00495000
         L     @10,CTR(,DCKWKPTR)                                  0154 00496000
         SLA   @10,2                                               0154 00497000
         L     @10,LIBPTR-5(@10,DCKWKPTR)                          0154 00498000
         LA    @10,0(,@10)                                         0154 00499000
         ST    @10,PTRLIB(,DCKWKPTR)                               0154 00500000
*             CTR=100;              /*                       @Y30LB54*/ 00501000
         MVC   CTR(4,DCKWKPTR),@CF00330                            0155 00502000
*           END;                    /*                       @Y30LB54*/ 00503000
*       END;                        /*                       @Y30LB54*/ 00504000
*     ELSE                                                         0158 00505000
*       ;                           /*                       @Y30LB54*/ 00506000
@RF00111 DS    0H                                                  0159 00507000
*   END;                            /*                       @Y30LB54*/ 00508000
@RC00111 LA    @10,1                                               0159 00509000
         AL    @10,CTR(,DCKWKPTR)                                  0159 00510000
         ST    @10,CTR(,DCKWKPTR)                                  0159 00511000
         CH    @10,@CH00050                                        0159 00512000
         BNH   @DL00110                                            0159 00513000
*   IF CTR^>99 THEN                                                0160 00514000
         L     @10,CTR(,DCKWKPTR)                                  0160 00515000
         CH    @10,@CH00331                                        0160 00516000
         BH    @RF00160                                            0160 00517000
*     DO;                           /*                       @Y30LB54*/ 00518000
*       RETCODE=8;                  /* INVALID LIBRARY NO ON INPUT 0162 00519000
*                                                            @Y30LB54*/ 00520000
         LA    RETCODE,8                                           0162 00521000
*       RETURN CODE(RETCODE);       /*                       @Y30LB54*/ 00522000
         LR    @15,RETCODE                                         0163 00523000
         L     @14,@SA00002                                        0163 00524000
         BR    @14                                                 0163 00525000
*     END;                          /*                       @Y30LB54*/ 00526000
*   ELSE                                                           0165 00527000
*     ;                             /*                       @Y30LB54*/ 00528000
@RF00160 DS    0H                                                  0166 00529000
*   END LIBMATCH;                   /*                       @Y30LB54*/ 00530000
         B     @EL00002                                            0166 00531000
*                                                                  0167 00532000
*   /*****************************************************************/ 00533000
*   /*                                                               */ 00534000
*   /* FILL THE DCK COUNTERS                                         */ 00535000
*   /*                                                               */ 00536000
*   /*****************************************************************/ 00537000
*                                                                  0167 00538000
*RPT8FILL:                                                         0167 00539000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB54*/ 00540000
RPT8FILL ST    @14,12(,@13)                                        0167 00541000
*   PTRRPT=0;                       /* REPORT OFFSET INTO COUNTERS 0168 00542000
*                                                            @Y30LB54*/ 00543000
         SLR   @10,@10                                             0168 00544000
         ST    @10,PTRRPT(,DCKWKPTR)                               0168 00545000
*   DO CTR=1 TO 4 BY 1;             /* GOING TO PROCESS 4 BYTES OF 0169 00546000
*                                      DATA                  @Y30LB54*/ 00547000
         LA    @10,1                                               0169 00548000
         ST    @10,CTR(,DCKWKPTR)                                  0169 00549000
@DL00169 DS    0H                                                  0170 00550000
*     PTRBYTE=(CTR-1)*(64*2);       /* 64 COUNTERS OF 2 BYTES EACH 0170 00551000
*                                                            @Y30LB54*/ 00552000
         L     @10,CTR(,DCKWKPTR)                                  0170 00553000
         BCTR  @10,0                                               0170 00554000
         SLA   @10,7                                               0170 00555000
         ST    @10,PTRBYTE(,DCKWKPTR)                              0170 00556000
*     DO CTR1=1 TO 8 BY 1;          /* EACH BYTE HAS 8 COMBINATION 0171 00557000
*                                                            @Y30LB54*/ 00558000
         LA    @10,1                                               0171 00559000
         ST    @10,CTR1(,DCKWKPTR)                                 0171 00560000
@DL00171 DS    0H                                                  0172 00561000
*       DATAWORK=DATA08(CTR)&MASKARG(CTR1);/* CONTENTS OF BYTE     0172 00562000
*                                                            @Y30LB54*/ 00563000
         L     @10,CTR(,DCKWKPTR)                                  0172 00564000
         L     @07,CTR1(,DCKWKPTR)                                 0172 00565000
         SLA   @07,2                                               0172 00566000
         ALR   @10,DCKWKPTR                                        0172 00567000
         MVC   DATAWORK(1,DCKWKPTR),DATA08-1(@10)                  0172 00568000
         LA    @10,MASKARG-4(@07)                                  0172 00569000
         NC    DATAWORK(1,DCKWKPTR),0(@10)                         0172 00570000
*       IF DATAWORK^=0 THEN                                        0173 00571000
         CLI   DATAWORK(DCKWKPTR),0                                0173 00572000
         BE    @RF00173                                            0173 00573000
*         DO;                       /*                       @Y30LB54*/ 00574000
*           KICKPTR=PTRRPT+PTRLIB+PTRBYTE+PTRSSID+MASKDISP(CTR1);  0175 00575000
         L     @10,PTRRPT(,DCKWKPTR)                               0175 00576000
         AL    @10,PTRLIB(,DCKWKPTR)                               0175 00577000
         AL    @10,PTRBYTE(,DCKWKPTR)                              0175 00578000
         AL    @10,PTRSSID(,DCKWKPTR)                              0175 00579000
         L     @07,MASKDISP-5(@07)                                 0175 00580000
         LA    @07,0(,@07)                                         0175 00581000
         ALR   @10,@07                                             0175 00582000
         ST    @10,KICKPTR(,DCKWKPTR)                              0175 00583000
*           COUNTER(1)=COUNTER(1)+1;/* KICK COUNTER BY 1     @Y30LB54*/ 00584000
         LA    @07,1                                               0176 00585000
         LH    @15,COUNTER(,@10)                                   0176 00586000
         ALR   @15,@07                                             0176 00587000
         STH   @15,COUNTER(,@10)                                   0176 00588000
*           COUNTRP8=COUNTRP8+1;    /* TOTAL OF COUNTERS ADDED TO  0177 00589000
*                                                            @Y30LB54*/ 00590000
         AL    @07,COUNTRP8(,DCKWKPTR)                             0177 00591000
         ST    @07,COUNTRP8(,DCKWKPTR)                             0177 00592000
*         END;                      /*                       @Y30LB54*/ 00593000
*       ELSE                                                       0179 00594000
*         ;                         /*                       @Y30LB54*/ 00595000
@RF00173 DS    0H                                                  0180 00596000
*     END;                          /*                       @Y30LB54*/ 00597000
         LA    @10,1                                               0180 00598000
         AL    @10,CTR1(,DCKWKPTR)                                 0180 00599000
         ST    @10,CTR1(,DCKWKPTR)                                 0180 00600000
         CH    @10,@CH00071                                        0180 00601000
         BNH   @DL00171                                            0180 00602000
*   END;                            /*                       @Y30LB54*/ 00603000
         LA    @10,1                                               0181 00604000
         AL    @10,CTR(,DCKWKPTR)                                  0181 00605000
         ST    @10,CTR(,DCKWKPTR)                                  0181 00606000
         CH    @10,@CH00050                                        0181 00607000
         BNH   @DL00169                                            0181 00608000
*   RETURN CODE(RETCODE);           /*                       @Y30LB54*/ 00609000
         LR    @15,RETCODE                                         0182 00610000
@EL00003 DS    0H                                                  0182 00611000
@EF00003 DS    0H                                                  0182 00612000
@ER00003 L     @14,12(,@13)                                        0182 00613000
         BR    @14                                                 0182 00614000
*   END RPT8FILL;                   /*                       @Y30LB54*/ 00615000
*                                                                  0184 00616000
*   /*****************************************************************/ 00617000
*   /*                                                               */ 00618000
*   /* FILL THE TLX COUNTERS                                         */ 00619000
*   /*                                                               */ 00620000
*   /*****************************************************************/ 00621000
*                                                                  0184 00622000
*RPT9FILL:                                                         0184 00623000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB54*/ 00624000
RPT9FILL ST    @14,12(,@13)                                        0184 00625000
*   PTRRPT=512;                     /* GO TO TLX COUNTERS    @Y30LB54*/ 00626000
         MVC   PTRRPT(4,DCKWKPTR),@CF00328                         0185 00627000
*   IF BYTE13F4(7)='0'B THEN        /* VALID INDEX PGM       @ZM30975*/ 00628000
         TM    BYTE13F4(SENSEPTR),B'00000010'                      0186 00629000
         BNZ   @RF00186                                            0186 00630000
*     I=1;                          /* SAVE INDEX PROGRAM    @ZM30975*/ 00631000
         LA    I,1                                                 0187 00632000
*   ELSE                            /* NO, DO NOT SAVE       @ZM30975*/ 00633000
*     I=2;                          /* SAVE THREAD ONLY      @ZM30975*/ 00634000
         B     @RC00186                                            0188 00635000
@RF00186 LA    I,2                                                 0188 00636000
*   J=2;                            /* SAVE THREAD PGM       @ZM30975*/ 00637000
@RC00186 LA    J,2                                                 0189 00638000
*   DO CTR=I TO J BY 1;             /* 2 BYTES OF INPUT DATA @ZM30975*/ 00639000
         LR    @10,I                                               0190 00640000
         ST    @10,CTR(,DCKWKPTR)                                  0190 00641000
         B     @DE00190                                            0190 00642000
@DL00190 DS    0H                                                  0191 00643000
*     PTRBYTE=(CTR-1)*(8*2);        /*                       @Y30LB54*/ 00644000
         L     @10,CTR(,DCKWKPTR)                                  0191 00645000
         LR    @07,@10                                             0191 00646000
         BCTR  @07,0                                               0191 00647000
         SLA   @07,4                                               0191 00648000
         ST    @07,PTRBYTE(,DCKWKPTR)                              0191 00649000
*     DATAWORK=DATA09(CTR);         /*                       @Y30LB54*/ 00650000
         ALR   @10,DCKWKPTR                                        0192 00651000
         MVC   DATAWORK(1,DCKWKPTR),DATA09-1(@10)                  0192 00652000
*     FULLWD1=DATAWORK;             /* MAKE ADJUSTMENT       @Y30LB54*/ 00653000
         SLR   @10,@10                                             0193 00654000
         IC    @10,DATAWORK(,DCKWKPTR)                             0193 00655000
         ST    @10,FULLWD1(,DCKWKPTR)                              0193 00656000
*     SRL(FULLWD1,3);               /* MAKE IT A COMPUTABLE NUMBER 0194 00657000
*                                                            @Y30LB54*/ 00658000
         L     @10,FULLWD1(,DCKWKPTR)                              0194 00659000
         SRL   @10,3                                               0194 00660000
         ST    @10,FULLWD1(,DCKWKPTR)                              0194 00661000
*     IF FULLWD1<'00'X THEN                                        0195 00662000
         ICM   @10,15,FULLWD1(DCKWKPTR)                            0195 00663000
         BNM   @RF00195                                            0195 00664000
*       DO;                         /*                       @Y30LB54*/ 00665000
*         RETCODE=8;                /*                       @Y30LB54*/ 00666000
         LA    RETCODE,8                                           0197 00667000
*         RETURN CODE(RETCODE);     /*                       @Y30LB54*/ 00668000
         LR    @15,RETCODE                                         0198 00669000
@EL00004 DS    0H                                                  0198 00670000
@EF00004 DS    0H                                                  0198 00671000
@ER00004 L     @14,12(,@13)                                        0198 00672000
         BR    @14                                                 0198 00673000
*       END;                        /*                       @Y30LB54*/ 00674000
*     ELSE                                                         0200 00675000
*       IF FULLWD1>'1F'X THEN                                      0200 00676000
@RF00195 L     @10,FULLWD1(,DCKWKPTR)                              0200 00677000
         CH    @10,@CH00339                                        0200 00678000
         BNH   @RF00200                                            0200 00679000
*         DO;                       /*                       @Y30LB54*/ 00680000
*           RETCODE=8;              /*                       @Y30LB54*/ 00681000
         LA    RETCODE,8                                           0202 00682000
*           RETURN CODE(RETCODE);   /*                       @Y30LB54*/ 00683000
         LR    @15,RETCODE                                         0203 00684000
         L     @14,12(,@13)                                        0203 00685000
         BR    @14                                                 0203 00686000
*         END;                      /*                       @Y30LB54*/ 00687000
*       ELSE                                                       0205 00688000
*         ;                         /*                       @Y30LB54*/ 00689000
@RF00200 DS    0H                                                  0206 00690000
*     FULLWD1=FULLWD1*32;           /* COMPUTE CONTENTS OFFSET     0206 00691000
*                                                            @Y30LB54*/ 00692000
         L     @10,FULLWD1(,DCKWKPTR)                              0206 00693000
         SLA   @10,5                                               0206 00694000
         ST    @10,FULLWD1(,DCKWKPTR)                              0206 00695000
*     KICKPTR=PTRRPT+PTRLIB+PTRBYTE+PTRSSID+FULLWD1;/*       @Y30LB54*/ 00696000
         L     @07,PTRRPT(,DCKWKPTR)                               0207 00697000
         AL    @07,PTRLIB(,DCKWKPTR)                               0207 00698000
         AL    @07,PTRBYTE(,DCKWKPTR)                              0207 00699000
         AL    @07,PTRSSID(,DCKWKPTR)                              0207 00700000
         ALR   @07,@10                                             0207 00701000
         ST    @07,KICKPTR(,DCKWKPTR)                              0207 00702000
*     COUNTER(1)=COUNTER(1)+1;      /*                       @Y30LB54*/ 00703000
         LA    @10,1                                               0208 00704000
         LH    @15,COUNTER(,@07)                                   0208 00705000
         ALR   @15,@10                                             0208 00706000
         STH   @15,COUNTER(,@07)                                   0208 00707000
*     COUNTRP9=COUNTRP9+1;          /* TOTAL OF COUNTERS ADDED TO  0209 00708000
*                                                            @Y30LB54*/ 00709000
         AL    @10,COUNTRP9(,DCKWKPTR)                             0209 00710000
         ST    @10,COUNTRP9(,DCKWKPTR)                             0209 00711000
*   END;                            /*                       @Y30LB54*/ 00712000
         LA    @10,1                                               0210 00713000
         AL    @10,CTR(,DCKWKPTR)                                  0210 00714000
         ST    @10,CTR(,DCKWKPTR)                                  0210 00715000
@DE00190 CR    @10,J                                               0210 00716000
         BNH   @DL00190                                            0210 00717000
*   END RPT9FILL;                   /*                       @Y30LB54*/ 00718000
         B     @EL00004                                            0211 00719000
*   END ISDADCK0                    /*                       @Y30LB54*/ 00720000
*                                                                  0212 00721000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 00722000
*/*%INCLUDE SYSLIB  (ISDAPRMS)                                       */ 00723000
*/*%INCLUDE SYSLIB  (ISDACVT )                                       */ 00724000
*/*%INCLUDE SYSLIB  (ISDASOBR)                                       */ 00725000
*/*%INCLUDE SYSLIB  (ISDAMSCS)                                       */ 00726000
*/*%INCLUDE SYSLIB  (ISDAMSC4)                                       */ 00727000
*                                                                  0212 00728000
*       ;                                                          0212 00729000
@DATA    DS    0H                                                       00730000
@CH00050 DC    H'4'                                                     00731000
@CH00317 DC    H'7'                                                     00732000
@CH00071 DC    H'8'                                                     00733000
@CH00331 DC    H'99'                                                    00734000
@CH00311 DC    H'768'                                                   00735000
@CH00339 DC    XL2'1F'                                                  00736000
@DATD    DSECT                                                          00737000
         DS    0F                                                       00738000
@SA00001 DS    18F                                                      00739000
@PC00001 DS    1F                                                       00740000
@SA00002 DS    0F                                                       00741000
         DS    1F                                                       00742000
@AL00001 DS    1A                                                       00743000
@TF00001 DS    F                                                        00744000
ISDADCK0 CSECT                                                          00745000
         DS    0F                                                       00746000
@CF00330 DC    F'100'                                                   00747000
@CF00340 DC    F'145'                                                   00748000
@CF00328 DC    F'512'                                                   00749000
@CF00341 DC    F'1536'                                                  00750000
@CF00343 DC    F'-2'                                                    00751000
@CF00316 DC    XL4'0000000F'                                            00752000
@CF00319 DC    XL4'000000F0'                                            00753000
@DATD    DSECT                                                          00754000
         DS    0D                                                       00755000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                00756000
@ENDDATD EQU   *                                                        00757000
ISDADCK0 CSECT                                                          00758000
         NOPR  ((@ENDDATD-@DATD)/161*16)                                00759000
         DS    0F                                                       00760000
@SIZDATD DC    AL1(0)                                                   00761000
         DC    AL3(@ENDDATD-@DATD)                                      00762000
@CV00040 DC    V(ISDAGET1)                                              00763000
@CV00041 DC    V(ISDAFREE)                                              00764000
         DS    0D                                                       00765000
TRPAT08  DC    X'04121314'                                              00766000
TRPAT09  DC    X'161F'                                                  00767000
PATCH    DC    50X'00'                                                  00768000
MASKTBL  DS    CL4                                                      00769000
         ORG   MASKTBL+0                                                00770000
MASKARG  DC    X'80'                                                    00771000
MASKDISP DC    AL3(0)                                                   00772000
         ORG   MASKTBL+4                                                00773000
         ORG   MASKTBL+4                                                00774000
         DC    X'40'                                                    00775000
         DC    AL3(16)                                                  00776000
         ORG   MASKTBL+8                                                00777000
         ORG   MASKTBL+8                                                00778000
         DC    X'20'                                                    00779000
         DC    AL3(32)                                                  00780000
         ORG   MASKTBL+12                                               00781000
         ORG   MASKTBL+12                                               00782000
         DC    X'10'                                                    00783000
         DC    AL3(48)                                                  00784000
         ORG   MASKTBL+16                                               00785000
         ORG   MASKTBL+16                                               00786000
         DC    X'08'                                                    00787000
         DC    AL3(64)                                                  00788000
         ORG   MASKTBL+20                                               00789000
         ORG   MASKTBL+20                                               00790000
         DC    X'04'                                                    00791000
         DC    AL3(80)                                                  00792000
         ORG   MASKTBL+24                                               00793000
         ORG   MASKTBL+24                                               00794000
         DC    X'02'                                                    00795000
         DC    AL3(96)                                                  00796000
         ORG   MASKTBL+28                                               00797000
         ORG   MASKTBL+28                                               00798000
         DC    X'01'                                                    00799000
         DC    AL3(112)                                                 00800000
         ORG   MASKTBL+32                                               00801000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00802000
@01      EQU   01                                                       00803000
@02      EQU   02                                                       00804000
@03      EQU   03                                                       00805000
@04      EQU   04                                                       00806000
@05      EQU   05                                                       00807000
@06      EQU   06                                                       00808000
@07      EQU   07                                                       00809000
@08      EQU   08                                                       00810000
@09      EQU   09                                                       00811000
@10      EQU   10                                                       00812000
@11      EQU   11                                                       00813000
@12      EQU   12                                                       00814000
@13      EQU   13                                                       00815000
@14      EQU   14                                                       00816000
@15      EQU   15                                                       00817000
J        EQU   @06                                                      00818000
I        EQU   @05                                                      00819000
RETCODE  EQU   @04                                                      00820000
DCKWKPTR EQU   @03                                                      00821000
SENSEPTR EQU   @05                                                      00822000
LPARMPTR EQU   @06                                                      00823000
CVTPTR   EQU   @02                                                      00824000
R15      EQU   @15                                                      00825000
R0       EQU   @00                                                      00826000
R1       EQU   @01                                                      00827000
ISDAPRMS EQU   0                                                        00828000
CINPUT   EQU   ISDAPRMS                                                 00829000
CSTART   EQU   ISDAPRMS+2                                               00830000
CEND     EQU   ISDAPRMS+6                                               00831000
CFSCONLY EQU   ISDAPRMS+13                                              00832000
CSSIDF   EQU   ISDAPRMS+17                                              00833000
CSERIAL  EQU   ISDAPRMS+21                                              00834000
CREPORTS EQU   ISDAPRMS+33                                              00835000
CDCKTLX  EQU   CREPORTS+6                                               00836000
ISDACVT  EQU   0                                                        00837000
CVTPTRS0 EQU   ISDACVT                                                  00838000
DATAPTR  EQU   CVTPTRS0                                                 00839000
SDATAPTR EQU   CVTPTRS0+4                                               00840000
PARMPTR  EQU   CVTPTRS0+8                                               00841000
DCK00PTR EQU   CVTPTRS0+64                                              00842000
GET0CALL EQU   ISDACVT+100                                              00843000
SPNOLEN  EQU   GET0CALL                                                 00844000
SPNO     EQU   SPNOLEN                                                  00845000
CORELEN  EQU   SPNOLEN+1                                                00846000
COREADDR EQU   GET0CALL+4                                               00847000
HEXPCALL EQU   ISDACVT+108                                              00848000
PRT0CALL EQU   ISDACVT+120                                              00849000
OUTLINE  EQU   PRT0CALL                                                 00850000
SDADATD  EQU   ISDACVT+256                                              00851000
PRTDATD  EQU   ISDACVT+416                                              00852000
OBRMDR   EQU   0                                                        00853000
SCW      EQU   OBRMDR                                                   00854000
SWITCHES EQU   OBRMDR+6                                                 00855000
DATETIME EQU   OBRMDR+12                                                00856000
DATE     EQU   DATETIME                                                 00857000
TIME     EQU   DATETIME+4                                               00858000
CPUSERID EQU   OBRMDR+21                                                00859000
ISDAMSCS EQU   0                                                        00860000
SUBSYSID EQU   ISDAMSCS+1                                               00861000
SSID     EQU   SUBSYSID                                                 00862000
SSIDTYPE EQU   SSID                                                     00863000
SUBSENSE EQU   ISDAMSCS+4                                               00864000
SUBFMTMG EQU   SUBSENSE+7                                               00865000
ISDAMSC4 EQU   4                                                        00866000
FMTMSG4  EQU   ISDAMSC4+7                                               00867000
SASENSE  EQU   ISDAMSC4+8                                               00868000
BYTE13F4 EQU   SASENSE+5                                                00869000
WORKCORE EQU   0                                                        00870000
LOGPTR   EQU   WORKCORE                                                 00871000
LIBTAB   EQU   WORKCORE+4                                               00872000
LIBNO    EQU   LIBTAB                                                   00873000
LIBPTR   EQU   LIBTAB+1                                                 00874000
FULLWD1  EQU   WORKCORE+20                                              00875000
DATASSID EQU   WORKCORE+24                                              00876000
DATALIB  EQU   WORKCORE+28                                              00877000
KICKPTR  EQU   WORKCORE+32                                              00878000
PTRRPT   EQU   WORKCORE+36                                              00879000
PTRLIB   EQU   WORKCORE+40                                              00880000
PTRSSID  EQU   WORKCORE+44                                              00881000
PTRBYTE  EQU   WORKCORE+48                                              00882000
CTR      EQU   WORKCORE+52                                              00883000
CTR1     EQU   WORKCORE+56                                              00884000
CHAR4    EQU   WORKCORE+60                                              00885000
COUNTRP8 EQU   WORKCORE+64                                              00886000
COUNTRP9 EQU   WORKCORE+68                                              00887000
FOURBITS EQU   WORKCORE+128                                             00888000
DATA08   EQU   WORKCORE+129                                             00889000
DATA09   EQU   WORKCORE+133                                             00890000
DATAWORK EQU   WORKCORE+135                                             00891000
COUNTER  EQU   0                                                        00892000
WORKPTR  EQU   0                                                        00893000
*                                      START UNREFERENCED COMPONENTS    00894000
COUNT    EQU   COUNTER                                                  00895000
ENDAREA  EQU   WORKCORE+144                                             00896000
EDREC    EQU   WORKCORE+136                                             00897000
FIVEBITS EQU   FOURBITS                                                 00898000
TOTGRND  EQU   WORKCORE+126                                             00899000
TOTROW   EQU   WORKCORE+124                                             00900000
TOTFINL  EQU   WORKCORE+108                                             00901000
B8HDR    EQU   WORKCORE+96                                              00902000
VALCTR   EQU   WORKCORE+92                                              00903000
TEMPPTR  EQU   WORKCORE+88                                              00904000
BITHDCTR EQU   WORKCORE+84                                              00905000
BITCTR   EQU   WORKCORE+80                                              00906000
BYTECTR  EQU   WORKCORE+76                                              00907000
LIBCTR   EQU   WORKCORE+72                                              00908000
BYTE27F4 EQU   SASENSE+19                                               00909000
BYTE26F4 EQU   SASENSE+18                                               00910000
BYTE25F4 EQU   SASENSE+17                                               00911000
BYTE24F4 EQU   SASENSE+16                                               00912000
FSCFMT4  EQU   SASENSE+14                                               00913000
BYTE21F4 EQU   SASENSE+13                                               00914000
BYTE20F4 EQU   SASENSE+12                                               00915000
BYTE19F4 EQU   SASENSE+11                                               00916000
BYTE18F4 EQU   SASENSE+10                                               00917000
BYTE17F4 EQU   SASENSE+9                                                00918000
BYTE16F4 EQU   SASENSE+8                                                00919000
BYTE15F4 EQU   SASENSE+7                                                00920000
BYTE14F4 EQU   SASENSE+6                                                00921000
BYTE12F4 EQU   SASENSE+4                                                00922000
BYTE11F4 EQU   SASENSE+3                                                00923000
BYTE10F4 EQU   SASENSE+2                                                00924000
BYTE9F4  EQU   SASENSE+1                                                00925000
BYTE8F4  EQU   SASENSE                                                  00926000
MSGCODE4 EQU   FMTMSG4                                                  00927000
SUBFMTN4 EQU   FMTMSG4                                                  00928000
LOWADDF4 EQU   ISDAMSC4+6                                               00929000
RETRYF4  EQU   ISDAMSC4+5                                               00930000
@NM00007 EQU   ISDAMSC4+4                                               00931000
CMDERRF4 EQU   ISDAMSC4+3                                               00932000
CHADDRF4 EQU   ISDAMSC4+2                                               00933000
STATUS24 EQU   ISDAMSC4+1                                               00934000
STATUS14 EQU   ISDAMSC4                                                 00935000
SANOMSCD EQU   SUBSENSE+27                                              00936000
RCYLMSCD EQU   SUBSENSE+25                                              00937000
RUAMSCD  EQU   SUBSENSE+24                                              00938000
MSCFSC   EQU   SUBSENSE+22                                              00939000
@NM00006 EQU   SUBSENSE+21                                              00940000
RUADASD  EQU   SUBSENSE+20                                              00941000
DASDFSC  EQU   SUBSENSE+18                                              00942000
@NM00005 EQU   SUBSENSE+8                                               00943000
MSGCODEN EQU   SUBFMTMG                                                 00944000
SUBFMTNO EQU   SUBFMTMG                                                 00945000
SALOWAD2 EQU   SUBSENSE+6                                               00946000
SARETRY  EQU   SUBSENSE+5                                               00947000
@NM00004 EQU   SUBSENSE+4                                               00948000
DASDFMTN EQU   SUBSENSE+3                                               00949000
SALOWADD EQU   SUBSENSE+2                                               00950000
SUBSTAT5 EQU   SUBSENSE+1                                               00951000
SUBSTAT4 EQU   SUBSENSE                                                 00952000
FORMATNO EQU   ISDAMSCS+3                                               00953000
SSIDDEVT EQU   SSID+1                                                   00954000
SSIDLIBN EQU   SSID+1                                                   00955000
SSIDFLAG EQU   SUBSYSID                                                 00956000
STATUS   EQU   ISDAMSCS                                                 00957000
CPUID    EQU   CPUSERID+3                                               00958000
CPUSER   EQU   CPUSERID                                                 00959000
VERNO    EQU   OBRMDR+20                                                00960000
TENSHUND EQU   TIME+3                                                   00961000
SECOND   EQU   TIME+2                                                   00962000
MINUTE   EQU   TIME+1                                                   00963000
HOUR     EQU   TIME                                                     00964000
DAY      EQU   DATE+2                                                   00965000
YEAR     EQU   DATE                                                     00966000
RECENTRY EQU   OBRMDR+11                                                00967000
RCDCNT   EQU   OBRMDR+10                                                00968000
SWITCH3  EQU   SWITCHES+3                                               00969000
SWITCH2  EQU   SWITCHES+2                                               00970000
SWITCH1  EQU   SWITCHES+1                                               00971000
SWITCH0  EQU   SWITCHES                                                 00972000
SYSREL   EQU   OBRMDR+5                                                 00973000
CLASRC   EQU   OBRMDR+4                                                 00974000
@NM00003 EQU   SCW+3                                                    00975000
SCODE    EQU   SCW+2                                                    00976000
SLENGTH  EQU   SCW                                                      00977000
PRTSA001 EQU   PRTDATD                                                  00978000
SDATEMPS EQU   SDADATD+136                                              00979000
SDASA002 EQU   SDADATD+76                                               00980000
SDAPC001 EQU   SDADATD+72                                               00981000
SDASA001 EQU   SDADATD                                                  00982000
SDARPTID EQU   PRT0CALL+133                                             00983000
LINE     EQU   OUTLINE+1                                                00984000
ANSI     EQU   OUTLINE                                                  00985000
DUMPIDNO EQU   HEXPCALL+8                                               00986000
DUMPLEN  EQU   HEXPCALL+4                                               00987000
DUMPADDR EQU   HEXPCALL                                                 00988000
WORKCALL EQU   CVTPTRS0+96                                              00989000
GEN00PTR EQU   CVTPTRS0+92                                              00990000
CNFG0PTR EQU   CVTPTRS0+88                                              00991000
PWR00PTR EQU   CVTPTRS0+84                                              00992000
APR00PTR EQU   CVTPTRS0+80                                              00993000
DRC00PTR EQU   CVTPTRS0+76                                              00994000
DAT00PTR EQU   CVTPTRS0+72                                              00995000
CSB00PTR EQU   CVTPTRS0+68                                              00996000
EQC00PTR EQU   CVTPTRS0+60                                              00997000
FSC00PTR EQU   CVTPTRS0+56                                              00998000
DHE00PTR EQU   CVTPTRS0+52                                              00999000
SUM00PTR EQU   CVTPTRS0+48                                              01000000
PAD00PTR EQU   CVTPTRS0+44                                              01001000
DCS00PTR EQU   CVTPTRS0+40                                              01002000
LOG00PTR EQU   CVTPTRS0+36                                              01003000
HIST0PTR EQU   CVTPTRS0+32                                              01004000
PRT00PTR EQU   CVTPTRS0+28                                              01005000
GET00PTR EQU   CVTPTRS0+24                                              01006000
TYPE0PTR EQU   CVTPTRS0+20                                              01007000
PARM0PTR EQU   CVTPTRS0+16                                              01008000
SDA00PTR EQU   CVTPTRS0+12                                              01009000
CTRACE   EQU   ISDAPRMS+48                                              01010000
CGEN     EQU   ISDAPRMS+47                                              01011000
CDETAIL  EQU   ISDAPRMS+46                                              01012000
CPERIOD  EQU   ISDAPRMS+45                                              01013000
CPWR     EQU   CREPORTS+11                                              01014000
CAPRSUU  EQU   CREPORTS+10                                              01015000
CDRC     EQU   CREPORTS+9                                               01016000
CDAT     EQU   CREPORTS+8                                               01017000
CCSBCSF  EQU   CREPORTS+7                                               01018000
CEQC     EQU   CREPORTS+5                                               01019000
CFSC     EQU   CREPORTS+4                                               01020000
CDHEDHU  EQU   CREPORTS+3                                               01021000
CSUM     EQU   CREPORTS+2                                               01022000
CPAD     EQU   CREPORTS+1                                               01023000
CDCS     EQU   CREPORTS                                                 01024000
CSERNO   EQU   CSERIAL+4                                                01025000
@NM00002 EQU   CSERIAL+3                                                01026000
CIBM     EQU   CSERIAL                                                  01027000
CRATIO   EQU   ISDAPRMS+19                                              01028000
CSSID    EQU   CSSIDF                                                   01029000
@NM00001 EQU   CSSIDF                                                   01030000
CFSC34   EQU   CFSCONLY+2                                               01031000
CFSC12   EQU   CFSCONLY                                                 01032000
CTYPE    EQU   ISDAPRMS+11                                              01033000
CSUMMARY EQU   ISDAPRMS+10                                              01034000
CENDDAY  EQU   CEND+2                                                   01035000
CENDYEAR EQU   CEND                                                     01036000
CSTDAY   EQU   CSTART+2                                                 01037000
CSTYEAR  EQU   CSTART                                                   01038000
CHISTIN  EQU   CINPUT+1                                                 01039000
CLOGIN   EQU   CINPUT                                                   01040000
*                                      END UNREFERENCED COMPONENTS      01041000
@RF00094 EQU   @RC00091                                                 01042000
@RF00102 EQU   @RC00099                                                 01043000
@RC00113 EQU   @RC00111                                                 01044000
@RC00121 EQU   @RC00113                                                 01045000
@ENDDATA EQU   *                                                        01046000
         END   ISDADCK0,(C'PLS2232',0603,75312)                         01047000
