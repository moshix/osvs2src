         TITLE 'ISDADHE0 DHU AND DHE ACCUMULATOR                       *00001000
                        '                                               00002000
ISDADHE0 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'ISDADHE0  78.044'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @11,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@11                                         0001 00013000
         L     @00,@SIZDATD                                        0001 00014000
         ISDAGSPC R,LV=(0)                                              00015000
         LR    @12,@01                                             0001 00016000
         USING @DATD,@12                                           0001 00017000
         ST    @13,@SA00001+4                                      0001 00018000
         LM    @00,@01,20(@13)                                     0001 00019000
         ST    @12,8(,@13)                                         0001 00020000
         LR    @13,@12                                             0001 00021000
         MVC   @PC00001(4),0(@01)                                  0001 00022000
*                                                                  0031 00023000
*   /*****************************************************************/ 00024000
*   /*                                                               */ 00025000
*   /* HOUSEKEEPING                                                  */ 00026000
*   /*                                                               */ 00027000
*   /*****************************************************************/ 00028000
*                                                                  0031 00029000
*   CVTPTR=WORKPTR;                 /*                       @Y30LB54*/ 00030000
         L     @10,@PC00001                                        0031 00031000
         L     CVTPTR,WORKPTR(,@10)                                0031 00032000
*   SENSEPTR=SDATAPTR;              /* SET LOCAL PTR TO SENSE@ZM30983*/ 00033000
         L     SENSEPTR,SDATAPTR(,CVTPTR)                          0032 00034000
*   LPARMPTR=PARMPTR;               /* SET LOCAL PTR TO PARMS@ZM30983*/ 00035000
         L     LPARMPTR,PARMPTR(,CVTPTR)                           0033 00036000
*   RETCODE=0;                      /* INIT RETURN CODE      @ZM30983*/ 00037000
         SLR   RETCODE,RETCODE                                     0034 00038000
*   IF SUBFMTMG^='05'X THEN         /* MSG CODE 05 RECORD    @ZM30976*/ 00039000
         CLI   SUBFMTMG(SENSEPTR),X'05'                            0035 00040000
         BE    @RF00035                                            0035 00041000
*     RETURN CODE(RETCODE);         /* NO, DONT USE THIS REC @ZM30976*/ 00042000
         L     @13,4(,@13)                                         0036 00043000
         L     @00,@SIZDATD                                        0036 00044000
         LR    @01,@12                                             0036 00045000
         ISDAFSPC R,LV=(0),A=(1)                                        00046000
         LR    @15,@04                                             0036 00047000
         L     @14,12(,@13)                                        0036 00048000
         LM    @00,@12,20(@13)                                     0036 00049000
         BR    @14                                                 0036 00050000
*   ELSE;                           /* OK, DRD BUFFERED LOG  @ZM30976*/ 00051000
@RF00035 DS    0H                                                  0038 00052000
*   DHEWKPTR=DHE00PTR;              /* SET LOCAL PTR TO WORK @ZM30983*/ 00053000
         L     @10,DHE00PTR(,CVTPTR)                               0038 00054000
         LR    DHEWKPTR,@10                                        0038 00055000
*   IF DHE00PTR=0 THEN              /* FIRST TIME SWITCH     @Y30LB54*/ 00056000
         LTR   @10,@10                                             0039 00057000
         BNZ   @RF00039                                            0039 00058000
*     DO;                           /*                       @Y30LB54*/ 00059000
*       SPNO=0;                     /* WANT SUBPOOL ZERO     @Y30LB54*/ 00060000
         MVI   SPNO(CVTPTR),X'00'                                  0041 00061000
*       CORELEN=LENGTH(WORKCORE);   /*                       @Y30LB54*/ 00062000
         MVC   CORELEN(3,CVTPTR),@CF00344+1                        0042 00063000
*       CALL ISDAGET1(WORKPTR);     /*                       @Y30LB54*/ 00064000
         L     @10,@PC00001                                        0043 00065000
         ST    @10,@AL00001                                        0043 00066000
         L     @15,@CV00041                                        0043 00067000
         LA    @01,@AL00001                                        0043 00068000
         BALR  @14,@15                                             0043 00069000
*       RFY                                                        0044 00070000
*         R15 RSTD;                 /*                       @Y30LB54*/ 00071000
*       RETCODE=R15;                /*                       @Y30LB54*/ 00072000
         LR    RETCODE,R15                                         0045 00073000
*       RFY                                                        0046 00074000
*         R15 UNRSTD;               /*                       @Y30LB54*/ 00075000
*       IF RETCODE=0 THEN                                          0047 00076000
         LTR   RETCODE,RETCODE                                     0047 00077000
         BNZ   @RF00047                                            0047 00078000
*         DO;                       /*                       @Y30LB54*/ 00079000
*           DHE00PTR=COREADDR;      /*                       @Y30LB54*/ 00080000
         L     @10,COREADDR(,CVTPTR)                               0049 00081000
         ST    @10,DHE00PTR(,CVTPTR)                               0049 00082000
*           DHEWKPTR=COREADDR;      /* SET LOCAL PTR TO WORK @ZM30983*/ 00083000
         LR    DHEWKPTR,@10                                        0050 00084000
*         END;                      /*                       @Y30LB54*/ 00085000
*       ELSE                                                       0052 00086000
*         DO;                       /*                       @Y30LB54*/ 00087000
         B     @RC00047                                            0052 00088000
@RF00047 DS    0H                                                  0053 00089000
*           RETCODE=4;              /*                       @Y30LB54*/ 00090000
         LA    RETCODE,4                                           0053 00091000
*           CDHEDHU='00'X;          /* TURN CALL FLAG OFF    @ZM30983*/ 00092000
         MVI   CDHEDHU(LPARMPTR),X'00'                             0054 00093000
*           RETURN CODE(RETCODE);   /*                       @Y30LB54*/ 00094000
         L     @13,4(,@13)                                         0055 00095000
         L     @00,@SIZDATD                                        0055 00096000
         LR    @01,@12                                             0055 00097000
         ISDAFSPC R,LV=(0),A=(1)                                        00098000
         LR    @15,@04                                             0055 00099000
         L     @14,12(,@13)                                        0055 00100000
         LM    @00,@12,20(@13)                                     0055 00101000
         BR    @14                                                 0055 00102000
*         END;                      /*                       @Y30LB54*/ 00103000
*       COUNTRP4=0;                 /* NUMBER OF TIMES RPT 4 COUNTERS   00104000
*                                      ADDED TO              @Y30LB54*/ 00105000
@RC00047 SLR   @10,@10                                             0057 00106000
         ST    @10,COUNTRP4(,DHEWKPTR)                             0057 00107000
*       COUNTR4A=0;                 /* NUMBER OF TIMES RPT 4A@Y30LB54   00108000
*                                      COUNTERS ADDED TO     @Y30LB54*/ 00109000
         ST    @10,COUNTR4A(,DHEWKPTR)                             0058 00110000
*       COUNTRP5=0;                 /* NUMBER OF TIMES RPT 5 COUNTERS   00111000
*                                      ADDED TO              @Y30LB54*/ 00112000
         ST    @10,COUNTRP5(,DHEWKPTR)                             0059 00113000
*       LIBTAB(1)=0;                /* RESET LIBRARY POINTERS TO 0 0060 00114000
*                                                            @Y30LB54*/ 00115000
         ST    @10,LIBTAB(,DHEWKPTR)                               0060 00116000
*       LIBTAB(2)=0;                /*                       @Y30LB54*/ 00117000
         ST    @10,LIBTAB+4(,DHEWKPTR)                             0061 00118000
*       LIBTAB(3)=0;                /*                       @Y30LB54*/ 00119000
         ST    @10,LIBTAB+8(,DHEWKPTR)                             0062 00120000
*       LIBTAB(4)=0;                /*                       @Y30LB54*/ 00121000
         ST    @10,LIBTAB+12(,DHEWKPTR)                            0063 00122000
*       LIBNO(1)='01'X;             /* SET UP LIBRARY COUNTER TABLE     00123000
*                                                            @Y30LB54*/ 00124000
         MVI   LIBNO(DHEWKPTR),X'01'                               0064 00125000
*       LIBNO(2)='02'X;             /*                       @Y30LB54*/ 00126000
         MVI   LIBNO+4(DHEWKPTR),X'02'                             0065 00127000
*       LIBNO(3)='03'X;             /*                       @Y30LB54*/ 00128000
         MVI   LIBNO+8(DHEWKPTR),X'03'                             0066 00129000
*       LIBNO(4)='04'X;             /*                       @Y30LB54*/ 00130000
         MVI   LIBNO+12(DHEWKPTR),X'04'                            0067 00131000
*       PTR5TOP=0;                  /* CLEAR POINTER TO DHE AREA   0068 00132000
*                                                            @Y30LB54*/ 00133000
         ST    @10,PTR5TOP(,DHEWKPTR)                              0068 00134000
*       PTR5BOT=0;                  /* CLEAR DHU OVERFLOW    @ZM30983*/ 00135000
         ST    @10,PTR5BOT(,DHEWKPTR)                              0069 00136000
*     END;                          /*                       @Y30LB54*/ 00137000
*   ELSE                                                           0071 00138000
*     ;                             /*                       @Y30LB54*/ 00139000
@RF00039 DS    0H                                                  0072 00140000
*   LOGPTR=DATAPTR;                 /*                       @Y30LB54*/ 00141000
         MVC   LOGPTR(4,DHEWKPTR),DATAPTR(CVTPTR)                  0072 00142000
*                                                                  0073 00143000
*   /*****************************************************************/ 00144000
*   /*                                                               */ 00145000
*   /* MAIN LOGIC PULL ALL DATA TOGETHER AS NEEDED                   */ 00146000
*   /*                                                               */ 00147000
*   /*****************************************************************/ 00148000
*                                                                  0073 00149000
*   DATA04=TRPAT04;                 /* SET UP TRANSLATE TABLE@Y30LB54*/ 00150000
         MVC   DATA04(24,DHEWKPTR),TRPAT04                         0073 00151000
*   SUBSTAT4='00'X;                 /* MAKE BYTE 4 = 0 FOR PADDING 0074 00152000
*                                      COUNTERS              @ZM31087*/ 00153000
         MVI   SUBSTAT4(SENSEPTR),X'00'                            0074 00154000
*/* THE ABOVE IS BYTE FOUR OF SENSE DATA                     @ZM31087*/ 00155000
*                                                                  0075 00156000
*   TR(DATA04,ISDAMSCS);            /* REACH INTO DATA AND PULL    0075 00157000
*                                      TOGETHER FIELDS, ALSO MAKES ALL  00158000
*                                      COUNTERS 4 BYTES LONG @ZA29820*/ 00159000
         TR    DATA04(24,DHEWKPTR),ISDAMSCS(SENSEPTR)              0075 00160000
*/* INVERT THE OVERFLOW BIT TO MAKE THE COUNTERS CORRECT     @ZA29820*/ 00161000
*   PTRINP=ADDR(DATA04);            /* SET BASE REGISTER     @ZA29820*/ 00162000
         LA    @10,DATA04(,DHEWKPTR)                               0076 00163000
         ST    @10,PTRINP(,DHEWKPTR)                               0076 00164000
*   DO CTR=1 TO 6;                  /* LOOP THROUGH COUNTERS @ZA29820*/ 00165000
         LA    @10,1                                               0077 00166000
         ST    @10,CTR(,DHEWKPTR)                                  0077 00167000
@DL00077 DS    0H                                                  0078 00168000
*     INCTR(CTR)=INCTR(CTR)&&MSK(CTR);/* EX OR WITH MASK     @ZA29820*/ 00169000
         L     @10,CTR(,DHEWKPTR)                                  0078 00170000
         SLA   @10,2                                               0078 00171000
         L     @07,PTRINP(,DHEWKPTR)                               0078 00172000
         LA    @01,0(@10,@07)                                      0078 00173000
         AL    @01,@CF00348                                        0078 00174000
         L     @15,INCTR(,@01)                                     0078 00175000
         X     @15,MSK-4(@10)                                      0078 00176000
         AL    @07,@CF00348                                        0078 00177000
         ST    @15,INCTR(@10,@07)                                  0078 00178000
*   END;                            /* END INVERT OVERFLOW   @ZA29820*/ 00179000
         LA    @10,1                                               0079 00180000
         AL    @10,CTR(,DHEWKPTR)                                  0079 00181000
         ST    @10,CTR(,DHEWKPTR)                                  0079 00182000
         CH    @10,@CH00142                                        0079 00183000
         BNH   @DL00077                                            0079 00184000
*   FULLWD1=SUBSYSID;               /* GET SSID AND LIBRARY NO     0080 00185000
*                                                            @Y30LB54*/ 00186000
         SLR   @10,@10                                             0080 00187000
         ICM   @10,3,SUBSYSID(SENSEPTR)                            0080 00188000
         ST    @10,FULLWD1(,DHEWKPTR)                              0080 00189000
*   DATASSID=FULLWD1&'0000000F'X;   /* STRIP OFF SSID        @Y30LB54*/ 00190000
         N     @10,@CF00301                                        0081 00191000
         ST    @10,DATASSID(,DHEWKPTR)                             0081 00192000
*   IF DATASSID>7 THEN              /* VALIDATE SSID         @Y30LB54*/ 00193000
         CH    @10,@CH00302                                        0082 00194000
         BNH   @RF00082                                            0082 00195000
*     DO;                           /*                       @Y30LB54*/ 00196000
*       RETCODE=8;                  /*                       @Y30LB54*/ 00197000
         LA    RETCODE,8                                           0084 00198000
*       RETURN CODE(RETCODE);       /*                       @Y30LB54*/ 00199000
         L     @13,4(,@13)                                         0085 00200000
         L     @00,@SIZDATD                                        0085 00201000
         LR    @01,@12                                             0085 00202000
         ISDAFSPC R,LV=(0),A=(1)                                        00203000
         LR    @15,@04                                             0085 00204000
         L     @14,12(,@13)                                        0085 00205000
         LM    @00,@12,20(@13)                                     0085 00206000
         BR    @14                                                 0085 00207000
*     END;                          /*                       @Y30LB54*/ 00208000
*   ELSE                                                           0087 00209000
*     ;                             /*                       @Y30LB54*/ 00210000
@RF00082 DS    0H                                                  0088 00211000
*   DATALIB=FULLWD1&'000000F0'X;    /* STRIP OFF LIBRARY NO  @Y30LB54*/ 00212000
         L     @10,FULLWD1(,DHEWKPTR)                              0088 00213000
         N     @10,@CF00303                                        0088 00214000
         ST    @10,DATALIB(,DHEWKPTR)                              0088 00215000
*   SRL(DATALIB,4);                 /* SHIFT IT TO UNITS POSITION  0089 00216000
*                                                            @Y30LB54*/ 00217000
         L     @10,DATALIB(,DHEWKPTR)                              0089 00218000
         SRL   @10,4                                               0089 00219000
         ST    @10,DATALIB(,DHEWKPTR)                              0089 00220000
*   DATALIB=DATALIB+1;              /* ALLOW FOR STARTING AT LIBRARY    00221000
*                                      0                     @Y30LB54*/ 00222000
         LA    @10,1                                               0090 00223000
         AL    @10,DATALIB(,DHEWKPTR)                              0090 00224000
         ST    @10,DATALIB(,DHEWKPTR)                              0090 00225000
*   DATA05(1:1)=DATALIB;            /* LIBRARY NUMBER BROKEN DOWN  0091 00226000
*                                                            @Y30LB54*/ 00227000
         STC   @10,DATA05(,DHEWKPTR)                               0091 00228000
*   DATA05(10:10)=DATASSID;         /* SSID NUMBER BROKEN DOWN     0092 00229000
*                                                            @Y30LB54*/ 00230000
         MVC   DATA05+9(1,DHEWKPTR),DATASSID+3(DHEWKPTR)           0092 00231000
*   DATA05(2:9)=DATETIME;           /* DATE TIME OF THIS RECORD    0093 00232000
*                                                            @Y30LB54*/ 00233000
         L     @10,LOGPTR(,DHEWKPTR)                               0093 00234000
         MVC   DATA05+1(8,DHEWKPTR),DATETIME(@10)                  0093 00235000
*   DATA05(13:36)=DATA04;           /* COUNTERS              @Y30LB54*/ 00236000
         MVC   DATA05+12(24,DHEWKPTR),DATA04(DHEWKPTR)             0094 00237000
*   DATA05(11:12)='0000'X;          /* FILL CHAR             @Y30LB54*/ 00238000
*                                                                  0095 00239000
         MVC   DATA05+10(2,DHEWKPTR),@CB00306                      0095 00240000
*   /*****************************************************************/ 00241000
*   /*                                                               */ 00242000
*   /* DISPATCHER                                                    */ 00243000
*   /*                                                               */ 00244000
*   /*****************************************************************/ 00245000
*                                                                  0096 00246000
*   CALL LIBMATCH;                  /* DETERMINE IF WE HAD LIBRARY 0096 00247000
*                                      BEFORE                @Y30LB54*/ 00248000
         BAL   @14,LIBMATCH                                        0096 00249000
*   IF RETCODE^=0 THEN              /* MUST HAVE HAD CORE PROBLEMS OR   00250000
*                                      INPUT ERROR           @Y30LB54*/ 00251000
         LTR   RETCODE,RETCODE                                     0097 00252000
         BZ    @RF00097                                            0097 00253000
*     RETURN CODE(RETCODE);         /*                       @Y30LB54*/ 00254000
*                                                                  0098 00255000
         L     @13,4(,@13)                                         0098 00256000
         L     @00,@SIZDATD                                        0098 00257000
         LR    @01,@12                                             0098 00258000
         ISDAFSPC R,LV=(0),A=(1)                                        00259000
         LR    @15,@04                                             0098 00260000
         L     @14,12(,@13)                                        0098 00261000
         LM    @00,@12,20(@13)                                     0098 00262000
         BR    @14                                                 0098 00263000
*   /*****************************************************************/ 00264000
*   /*                                                               */ 00265000
*   /* OUTPUT OF THIS IS PTRLIB HAS POINTER TO COUNTERS              */ 00266000
*   /*                                                               */ 00267000
*   /*****************************************************************/ 00268000
*                                                                  0099 00269000
*   PTRSSID=DATASSID*24;            /* SIX-FOUR BYTE COUNTERS TIMES     00270000
*                                      SSID NO               @Y30LB54*/ 00271000
*                                                                  0099 00272000
@RF00097 L     @10,DATASSID(,DHEWKPTR)                             0099 00273000
         MH    @10,@CH00122                                        0099 00274000
         ST    @10,PTRSSID(,DHEWKPTR)                              0099 00275000
*   /*****************************************************************/ 00276000
*   /*                                                               */ 00277000
*   /* COMPUTE DISPLACEMENTS AND ADD ONE TO COUNTERS                 */ 00278000
*   /*                                                               */ 00279000
*   /*****************************************************************/ 00280000
*                                                                  0100 00281000
*   CHAR4(1:1)=CDHEDHU&'02'X;       /* CONVERT TO LOOK AT DHE ONLY 0100 00282000
*                                                            @Y30LB54*/ 00283000
         MVC   CHAR4(1,DHEWKPTR),CDHEDHU(LPARMPTR)                 0100 00284000
         NI    CHAR4(DHEWKPTR),X'02'                               0100 00285000
*   IF CHAR4(1:1)='02'X THEN                                       0101 00286000
         CLI   CHAR4(DHEWKPTR),X'02'                               0101 00287000
         BNE   @RF00101                                            0101 00288000
*     DO;                           /*                       @Y30LB54*/ 00289000
*       CALL RPT4FILL;              /* DO DHU COUNTERS       @Y30LB54*/ 00290000
         BAL   @14,RPT4FILL                                        0103 00291000
*       IF RETCODE^=0 THEN                                         0104 00292000
         LTR   RETCODE,RETCODE                                     0104 00293000
         BZ    @RF00104                                            0104 00294000
*         RETURN CODE(RETCODE);     /*                       @Y30LB54*/ 00295000
         L     @13,4(,@13)                                         0105 00296000
         L     @00,@SIZDATD                                        0105 00297000
         LR    @01,@12                                             0105 00298000
         ISDAFSPC R,LV=(0),A=(1)                                        00299000
         LR    @15,@04                                             0105 00300000
         L     @14,12(,@13)                                        0105 00301000
         LM    @00,@12,20(@13)                                     0105 00302000
         BR    @14                                                 0105 00303000
*       ELSE                                                       0106 00304000
*         ;                         /*                       @Y30LB54*/ 00305000
@RF00104 DS    0H                                                  0107 00306000
*       CALL RPT4AFIL;              /* DO DHUA COUNTERS      @Y30LB54*/ 00307000
         BAL   @14,RPT4AFIL                                        0107 00308000
*       IF RETCODE^=0 THEN          /* ERROR ON INPUT        @Y30LB54*/ 00309000
         LTR   RETCODE,RETCODE                                     0108 00310000
         BZ    @RF00108                                            0108 00311000
*         RETURN CODE(RETCODE);     /*                       @Y30LB54*/ 00312000
         L     @13,4(,@13)                                         0109 00313000
         L     @00,@SIZDATD                                        0109 00314000
         LR    @01,@12                                             0109 00315000
         ISDAFSPC R,LV=(0),A=(1)                                        00316000
         LR    @15,@04                                             0109 00317000
         L     @14,12(,@13)                                        0109 00318000
         LM    @00,@12,20(@13)                                     0109 00319000
         BR    @14                                                 0109 00320000
*     END;                          /*                       @Y30LB54*/ 00321000
*   ELSE                                                           0111 00322000
*     ;                             /*                       @Y30LB54*/ 00323000
@RF00101 DS    0H                                                  0112 00324000
*   CHAR4(1:1)=CDHEDHU&'01'X;       /* CONVERT TO LOOK ONLY AT DHU 0112 00325000
*                                                            @Y30LB54*/ 00326000
@RC00101 MVC   CHAR4(1,DHEWKPTR),CDHEDHU(LPARMPTR)                 0112 00327000
         NI    CHAR4(DHEWKPTR),X'01'                               0112 00328000
*   IF CHAR4(1:1)='01'X THEN                                       0113 00329000
         CLI   CHAR4(DHEWKPTR),X'01'                               0113 00330000
         BNE   @RF00113                                            0113 00331000
*     DO;                           /*                       @Y30LB54*/ 00332000
*       CALL RPT5FILL;              /* DO DHE COUNTERS       @Y30LB54*/ 00333000
         BAL   @14,RPT5FILL                                        0115 00334000
*       IF RETCODE^=0 THEN          /* MUST HAVE HAD ERROR ON INPUT     00335000
*                                                            @Y30LB54*/ 00336000
         LTR   RETCODE,RETCODE                                     0116 00337000
         BZ    @RF00116                                            0116 00338000
*         RETURN CODE(RETCODE);     /*                       @Y30LB54*/ 00339000
         L     @13,4(,@13)                                         0117 00340000
         L     @00,@SIZDATD                                        0117 00341000
         LR    @01,@12                                             0117 00342000
         ISDAFSPC R,LV=(0),A=(1)                                        00343000
         LR    @15,@04                                             0117 00344000
         L     @14,12(,@13)                                        0117 00345000
         LM    @00,@12,20(@13)                                     0117 00346000
         BR    @14                                                 0117 00347000
*     END;                          /*                       @Y30LB54*/ 00348000
*   ELSE                                                           0119 00349000
*     ;                             /*                       @Y30LB54*/ 00350000
*                                                                  0119 00351000
@RF00113 DS    0H                                                  0120 00352000
*   /*****************************************************************/ 00353000
*   /*                                                               */ 00354000
*   /* THATS IT FOR THIS RECORD                                      */ 00355000
*   /*                                                               */ 00356000
*   /*****************************************************************/ 00357000
*                                                                  0120 00358000
*/*ADDRESS STOP AT THIS POINT                                @Y30LB54   00359000
*                                                            @Y30LB54*/ 00360000
*                                                                  0120 00361000
*   RETURN CODE(RETCODE);           /* FINAL EXIT FROM ACCUMULATOR 0120 00362000
*                                      PORTION               @Y30LB54*/ 00363000
@RC00113 L     @13,4(,@13)                                         0120 00364000
         L     @00,@SIZDATD                                        0120 00365000
         LR    @01,@12                                             0120 00366000
         ISDAFSPC R,LV=(0),A=(1)                                        00367000
         LR    @15,@04                                             0120 00368000
         L     @14,12(,@13)                                        0120 00369000
         LM    @00,@12,20(@13)                                     0120 00370000
         BR    @14                                                 0120 00371000
*                                                                  0121 00372000
*   /*****************************************************************/ 00373000
*   /*                                                               */ 00374000
*   /* DID WE HAVE THIS LIBRARY BEFORE IF NOT GET CTRS               */ 00375000
*   /*                                                               */ 00376000
*   /*****************************************************************/ 00377000
*                                                                  0121 00378000
*LIBMATCH:                                                         0121 00379000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB54*/ 00380000
LIBMATCH ST    @14,@SA00002                                        0121 00381000
*   PTRLIB=0;                       /* FORCE IT TO FILL IN CORRECT 0122 00382000
*                                      ADDRESS               @Y30LB54*/ 00383000
         SLR   @10,@10                                             0122 00384000
         ST    @10,PTRLIB(,DHEWKPTR)                               0122 00385000
*   CHAR4=DATALIB;                  /* NEED TO MOVE IT TO CHAR AREA     00386000
*                                      FOR SUBSCRIPTING      @Y30LB54*/ 00387000
         MVC   CHAR4(4,DHEWKPTR),DATALIB(DHEWKPTR)                 0123 00388000
*   DO CTR=1 TO 4 BY 1;             /* FOUR LIBRARY REPORTS POSSIBLE    00389000
*                                                            @Y30LB54*/ 00390000
         LA    @10,1                                               0124 00391000
         ST    @10,CTR(,DHEWKPTR)                                  0124 00392000
@DL00124 DS    0H                                                  0125 00393000
*     IF CHAR4(4)=LIBNO(CTR) THEN   /* DO WE HAVE A VALID LIBRARY  0125 00394000
*                                                            @Y30LB54*/ 00395000
         L     @10,CTR(,DHEWKPTR)                                  0125 00396000
         SLA   @10,2                                               0125 00397000
         ST    @10,@TF00001                                        0125 00398000
         ALR   @10,DHEWKPTR                                        0125 00399000
         CLC   CHAR4+3(1,DHEWKPTR),LIBNO-4(@10)                    0125 00400000
         BNE   @RF00125                                            0125 00401000
*       DO;                         /*                       @Y30LB54*/ 00402000
*         IF LIBPTR(CTR)=0 THEN     /* DID WE HAVE ONE BEFORE@Y30LB54*/ 00403000
         L     @10,@TF00001                                        0127 00404000
         L     @10,LIBPTR-5(@10,DHEWKPTR)                          0127 00405000
         LA    @10,0(,@10)                                         0127 00406000
         LTR   @10,@10                                             0127 00407000
         BNZ   @RF00127                                            0127 00408000
*           DO;                     /*                       @Y30LB54*/ 00409000
*             SPNO=0;               /* INSERT SUBPOOL ID WE WANT   0129 00410000
*                                                            @Y30LB54*/ 00411000
*                                                                  0129 00412000
         MVI   SPNO(CVTPTR),X'00'                                  0129 00413000
*             /*******************************************************/ 00414000
*             /*                                                     */ 00415000
*             /* EACH LIBRARY HAS SET OF COUNTERS DHU HAS 48 COUNTERS*/ 00416000
*             /* OF 4 BYTES FOR 192 BYTES DHUA HAS 192 COUNTERS OF 4 */ 00417000
*             /* BYTES FOR 768 BYTES PLUS 8 BYTES EACH OF 4 DAYS FOR */ 00418000
*             /* THE JULIAN DATE + OFFSET                            */ 00419000
*             /*                                                     */ 00420000
*             /*******************************************************/ 00421000
*                                                                  0130 00422000
*             CORELEN=192+32+768;   /* LENGTH OF COUNTERS    @Y30LB54*/ 00423000
         MVC   CORELEN(3,CVTPTR),@CF00346+1                        0130 00424000
*             CALL ISDAGET1(WORKPTR);/* GET THE CORE         @Y30LB54*/ 00425000
         L     @10,@PC00001                                        0131 00426000
         ST    @10,@AL00001                                        0131 00427000
         L     @15,@CV00041                                        0131 00428000
         LA    @01,@AL00001                                        0131 00429000
         BALR  @14,@15                                             0131 00430000
*             RFY                                                  0132 00431000
*               R15 RSTD;           /*                       @Y30LB54*/ 00432000
*             RETCODE=R15;          /* SAVE RETURN CODE FROM GETMAIN    00433000
*                                                            @Y30LB54*/ 00434000
         LR    RETCODE,R15                                         0133 00435000
*             RFY                                                  0134 00436000
*               R15 UNRSTD;         /* RELEASE REG 15 FOR OTHER USE     00437000
*                                                            @Y30LB54*/ 00438000
*             IF RETCODE=0 THEN                                    0135 00439000
         LTR   RETCODE,RETCODE                                     0135 00440000
         BNZ   @RF00135                                            0135 00441000
*               DO;                 /*                       @Y30LB54*/ 00442000
*                 PTRLIB=COREADDR;  /* POINT TO MY COUNTERS  @Y30LB54*/ 00443000
         L     @10,COREADDR(,CVTPTR)                               0137 00444000
         ST    @10,PTRLIB(,DHEWKPTR)                               0137 00445000
*                 LIBPTR(CTR)=PTRLIB;/*                      @Y30LB54*/ 00446000
         L     @15,CTR(,DHEWKPTR)                                  0138 00447000
         SLA   @15,2                                               0138 00448000
         ALR   @15,DHEWKPTR                                        0138 00449000
         STCM  @10,7,LIBPTR-4(@15)                                 0138 00450000
*                 CTR=100;          /* TERMINATE THE LOOP    @Y30LB54*/ 00451000
         MVC   CTR(4,DHEWKPTR),@CF00318                            0139 00452000
*                 KICKPTR=PTRLIB;   /* ZERO OUT THE GETMAIN CORE   0140 00453000
*                                                            @Y30LB54*/ 00454000
         ST    @10,KICKPTR(,DHEWKPTR)                              0140 00455000
*                 DO CTR1=1 TO 248 BY 1;/* THEY MAY CONTAIN JUNK   0141 00456000
*                                                            @Y30LB54*/ 00457000
         LA    @10,1                                               0141 00458000
         ST    @10,CTR1(,DHEWKPTR)                                 0141 00459000
@DL00141 DS    0H                                                  0142 00460000
*                   COUNTER(CTR1)=0;/*                       @Y30LB54*/ 00461000
         L     @10,CTR1(,DHEWKPTR)                                 0142 00462000
         SLA   @10,2                                               0142 00463000
         L     @01,KICKPTR(,DHEWKPTR)                              0142 00464000
         SLR   @00,@00                                             0142 00465000
         AL    @01,@CF00348                                        0142 00466000
         ST    @00,COUNTER(@10,@01)                                0142 00467000
*                 END;              /*                       @Y30LB54*/ 00468000
         LA    @10,1                                               0143 00469000
         AL    @10,CTR1(,DHEWKPTR)                                 0143 00470000
         ST    @10,CTR1(,DHEWKPTR)                                 0143 00471000
         CH    @10,@CH00319                                        0143 00472000
         BNH   @DL00141                                            0143 00473000
*                 KICKPTR=PTRLIB+192;/* SKIP DHU PORTION OF COUNTERS    00474000
*                                                            @Y30LB54*/ 00475000
         LA    @10,192                                             0144 00476000
         AL    @10,PTRLIB(,DHEWKPTR)                               0144 00477000
         ST    @10,KICKPTR(,DHEWKPTR)                              0144 00478000
*                 FULLWD1=32;       /* START COUNTERS AFTER CONTROL     00479000
*                                      PORTION               @Y30LB54*/ 00480000
         MVC   FULLWD1(4,DHEWKPTR),@CF00316                        0145 00481000
*                 DO CTR1=2 TO 8 BY 2;/* FILL IN DAY OFFSETS IN    0146 00482000
*                                      CONTROL PORTION       @Y30LB54*/ 00483000
         LA    @10,2                                               0146 00484000
         ST    @10,CTR1(,DHEWKPTR)                                 0146 00485000
@DL00146 DS    0H                                                  0147 00486000
*                   COUNTER(CTR1)=FULLWD1;/*                 @Y30LB54*/ 00487000
         L     @10,CTR1(,DHEWKPTR)                                 0147 00488000
         SLA   @10,2                                               0147 00489000
         L     @01,KICKPTR(,DHEWKPTR)                              0147 00490000
         L     @15,FULLWD1(,DHEWKPTR)                              0147 00491000
         AL    @01,@CF00348                                        0147 00492000
         ST    @15,COUNTER(@10,@01)                                0147 00493000
*                   FULLWD1=FULLWD1+192;/* ADJUST FOR NEXT DAYS    0148 00494000
*                                      OFFSET                @Y30LB54*/ 00495000
         AH    @15,@CH00315                                        0148 00496000
         ST    @15,FULLWD1(,DHEWKPTR)                              0148 00497000
*                 END;              /*                       @Y30LB54*/ 00498000
         LA    @10,2                                               0149 00499000
         AL    @10,CTR1(,DHEWKPTR)                                 0149 00500000
         ST    @10,CTR1(,DHEWKPTR)                                 0149 00501000
         CH    @10,@CH00072                                        0149 00502000
         BNH   @DL00146                                            0149 00503000
*               END;                /*                       @Y30LB54*/ 00504000
*             ELSE                  /* NO CORE AVAILABLE     @Y30LB54*/ 00505000
*                                                                  0151 00506000
*               /*****************************************************/ 00507000
*               /*                                                   */ 00508000
*               /* FREE ALL CORE ALREADY OBTAINED                    */ 00509000
*               /*                                                   */ 00510000
*               /*****************************************************/ 00511000
*                                                                  0151 00512000
*               DO;                                        /*@Y30LB54*/ 00513000
         B     @RC00135                                            0151 00514000
@RF00135 DS    0H                                                  0152 00515000
*                 CALL FREECORE;    /*                       @Y30LB54*/ 00516000
         BAL   @14,FREECORE                                        0152 00517000
*                 RETURN CODE(RETCODE);                    /*@Y30LB54*/ 00518000
         LR    @15,RETCODE                                         0153 00519000
@EL00002 DS    0H                                                  0153 00520000
@EF00002 DS    0H                                                  0153 00521000
@ER00002 L     @14,@SA00002                                        0153 00522000
         BR    @14                                                 0153 00523000
*               END;                                       /*@Y30LB54*/ 00524000
*           END;                    /*                       @Y30LB54*/ 00525000
*         ELSE                                                     0156 00526000
*           DO;                     /*                       @Y30LB54*/ 00527000
         B     @RC00127                                            0156 00528000
@RF00127 DS    0H                                                  0157 00529000
*             PTRLIB=LIBPTR(CTR);   /* USE OLD ONE           @Y30LB54*/ 00530000
         L     @10,CTR(,DHEWKPTR)                                  0157 00531000
         SLA   @10,2                                               0157 00532000
         L     @10,LIBPTR-5(@10,DHEWKPTR)                          0157 00533000
         LA    @10,0(,@10)                                         0157 00534000
         ST    @10,PTRLIB(,DHEWKPTR)                               0157 00535000
*             CTR=100;              /*                       @Y30LB54*/ 00536000
         MVC   CTR(4,DHEWKPTR),@CF00318                            0158 00537000
*           END;                    /*                       @Y30LB54*/ 00538000
*       END;                        /*                       @Y30LB54*/ 00539000
*     ELSE                                                         0161 00540000
*       ;                           /*                       @Y30LB54*/ 00541000
@RF00125 DS    0H                                                  0162 00542000
*   END;                            /*                       @Y30LB54*/ 00543000
@RC00125 LA    @10,1                                               0162 00544000
         AL    @10,CTR(,DHEWKPTR)                                  0162 00545000
         ST    @10,CTR(,DHEWKPTR)                                  0162 00546000
         CH    @10,@CH00051                                        0162 00547000
         BNH   @DL00124                                            0162 00548000
*   IF CTR^>99 THEN                                                0163 00549000
         L     @10,CTR(,DHEWKPTR)                                  0163 00550000
         CH    @10,@CH00321                                        0163 00551000
         BH    @RF00163                                            0163 00552000
*     DO;                           /*                       @Y30LB54*/ 00553000
*       RETCODE=8;                  /* INVALID LIBRARY NO ON INPUT 0165 00554000
*                                                            @Y30LB54*/ 00555000
         LA    RETCODE,8                                           0165 00556000
*       RETURN CODE(RETCODE);       /*                       @Y30LB54*/ 00557000
         LR    @15,RETCODE                                         0166 00558000
         L     @14,@SA00002                                        0166 00559000
         BR    @14                                                 0166 00560000
*     END;                          /*                       @Y30LB54*/ 00561000
*   ELSE                                                           0168 00562000
*     ;                             /*                       @Y30LB54*/ 00563000
@RF00163 DS    0H                                                  0169 00564000
*   END LIBMATCH;                   /*                       @Y30LB54*/ 00565000
         B     @EL00002                                            0169 00566000
*                                                                  0170 00567000
*   /*****************************************************************/ 00568000
*   /*                                                               */ 00569000
*   /* FILL THE DHU COUNTERS                                         */ 00570000
*   /*                                                               */ 00571000
*   /*****************************************************************/ 00572000
*                                                                  0170 00573000
*RPT4FILL:                                                         0170 00574000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB54*/ 00575000
RPT4FILL ST    @14,12(,@13)                                        0170 00576000
*   PTRINP=ADDR(DATA04);            /* POINT TO DHU COMPOSIT DATA  0171 00577000
*                                                            @Y30LB54*/ 00578000
         LA    @10,DATA04(,DHEWKPTR)                               0171 00579000
         ST    @10,PTRINP(,DHEWKPTR)                               0171 00580000
*   PTRRPT=0;                       /* DHU COUNTER OFFSET    @Y30LB54*/ 00581000
         SLR   @10,@10                                             0172 00582000
         ST    @10,PTRRPT(,DHEWKPTR)                               0172 00583000
*   KICKPTR=PTRLIB+PTRRPT+PTRSSID;  /* DETERMINE BUNCH OF COUNTERS 0173 00584000
*                                                            @Y30LB54*/ 00585000
         AL    @10,PTRLIB(,DHEWKPTR)                               0173 00586000
         AL    @10,PTRSSID(,DHEWKPTR)                              0173 00587000
         ST    @10,KICKPTR(,DHEWKPTR)                              0173 00588000
*   DO CTR=1 TO 6 BY 1;             /* SIX COUNTERS NEED TO BE WORKED   00589000
*                                      ON                    @Y30LB54*/ 00590000
         LA    @10,1                                               0174 00591000
         ST    @10,CTR(,DHEWKPTR)                                  0174 00592000
@DL00174 DS    0H                                                  0175 00593000
*     COUNTER(CTR)=COUNTER(CTR)+INCTR(CTR);/* ADD TO COUNTERS@Y30LB54*/ 00594000
         L     @10,CTR(,DHEWKPTR)                                  0175 00595000
         SLA   @10,2                                               0175 00596000
         L     @15,KICKPTR(,DHEWKPTR)                              0175 00597000
         L     @14,PTRINP(,DHEWKPTR)                               0175 00598000
         LA    @01,0(@10,@15)                                      0175 00599000
         AL    @01,@CF00348                                        0175 00600000
         L     @09,COUNTER(,@01)                                   0175 00601000
         AL    @14,@CF00348                                        0175 00602000
         AL    @09,INCTR(@10,@14)                                  0175 00603000
         AL    @15,@CF00348                                        0175 00604000
         ST    @09,COUNTER(@10,@15)                                0175 00605000
*     COUNTRP4=COUNTRP4+1;          /* INCREMENT NUMBER OF TIMES   0176 00606000
*                                      ADDED                 @Y30LB54*/ 00607000
         LA    @10,1                                               0176 00608000
         AL    @10,COUNTRP4(,DHEWKPTR)                             0176 00609000
         ST    @10,COUNTRP4(,DHEWKPTR)                             0176 00610000
*   END;                            /*                       @Y30LB54*/ 00611000
         LA    @10,1                                               0177 00612000
         AL    @10,CTR(,DHEWKPTR)                                  0177 00613000
         ST    @10,CTR(,DHEWKPTR)                                  0177 00614000
         CH    @10,@CH00142                                        0177 00615000
         BNH   @DL00174                                            0177 00616000
*   END RPT4FILL;                   /*                       @Y30LB54*/ 00617000
@EL00003 DS    0H                                                  0178 00618000
@EF00003 DS    0H                                                  0178 00619000
@ER00003 L     @14,12(,@13)                                        0178 00620000
         BR    @14                                                 0178 00621000
*                                                                  0179 00622000
*   /*****************************************************************/ 00623000
*   /*                                                               */ 00624000
*   /* FILL THE DHUA COUNTERS                                        */ 00625000
*   /*                                                               */ 00626000
*   /*****************************************************************/ 00627000
*                                                                  0179 00628000
*RPT4AFIL:                                                         0179 00629000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB54*/ 00630000
RPT4AFIL ST    @14,12(,@13)                                        0179 00631000
*   PTRINP=ADDR(DATA04);            /* POINT TO DHU COMPOSIT DATA  0180 00632000
*                                                            @Y30LB54*/ 00633000
         LA    @10,DATA04(,DHEWKPTR)                               0180 00634000
         ST    @10,PTRINP(,DHEWKPTR)                               0180 00635000
*   PTRDATE=0;                      /* RESET DATE POINTER INTO     0181 00636000
*                                      COUNTERS              @Y30LB54*/ 00637000
         SLR   @10,@10                                             0181 00638000
         ST    @10,PTRDATE(,DHEWKPTR)                              0181 00639000
*   PTRRPT=192;                     /* OFFSET TO THE 4A COUNTERS   0182 00640000
*                                                            @Y30LB54*/ 00641000
         LA    @10,192                                             0182 00642000
         ST    @10,PTRRPT(,DHEWKPTR)                               0182 00643000
*   KICKPTR=PTRLIB+PTRRPT;          /* FIND CORRECT SET OF COUNTERS     00644000
*                                      TO WORK               @Y30LB54*/ 00645000
         AL    @10,PTRLIB(,DHEWKPTR)                               0183 00646000
         ST    @10,KICKPTR(,DHEWKPTR)                              0183 00647000
*/*FIRST 32 BYTES OF 4A AREA IS CONTROL INFO                 @Y30LB54*/ 00648000
*                                                                  0184 00649000
*   /*****************************************************************/ 00650000
*   /*                                                               */ 00651000
*   /* STRIP CONTROL INFO INTO WORKING CORE                          */ 00652000
*   /*                                                               */ 00653000
*   /*****************************************************************/ 00654000
*                                                                  0184 00655000
*   CTR=1;                          /* COUNTER OFFSET        @Y30LB54*/ 00656000
         LA    @10,1                                               0184 00657000
         ST    @10,CTR(,DHEWKPTR)                                  0184 00658000
*   DO CTR1=1 TO 4 BY 1;            /* EXTRACT LIBRARY DAY CONTROL 0185 00659000
*                                      INFO TO WORKING       @Y30LB54*/ 00660000
         ST    @10,CTR1(,DHEWKPTR)                                 0185 00661000
@DL00185 DS    0H                                                  0186 00662000
*     DATEYYDD(CTR1)=COUNTER(CTR);  /* PICK OFF YEAR DAY     @Y30LB54*/ 00663000
         L     @10,CTR1(,DHEWKPTR)                                 0186 00664000
         SLA   @10,3                                               0186 00665000
         L     @15,CTR(,DHEWKPTR)                                  0186 00666000
         LR    @14,@15                                             0186 00667000
         SLA   @14,2                                               0186 00668000
         L     @09,KICKPTR(,DHEWKPTR)                              0186 00669000
         AL    @14,@CF00348                                        0186 00670000
         L     @14,COUNTER(@14,@09)                                0186 00671000
         ST    @14,DATEYYDD-8(@10,DHEWKPTR)                        0186 00672000
*     CTR=CTR+1;                    /* GO TO NEXT CONTROL FIELD    0187 00673000
*                                                            @Y30LB54*/ 00674000
         LA    @14,1                                               0187 00675000
         ALR   @15,@14                                             0187 00676000
         ST    @15,CTR(,DHEWKPTR)                                  0187 00677000
*     DATEOFST(CTR1)=COUNTER(CTR);  /* PICK OFF WORKING COUNTER    0188 00678000
*                                      OFFSET                @Y30LB54*/ 00679000
         LR    @08,@15                                             0188 00680000
         SLA   @08,2                                               0188 00681000
         AL    @09,@CF00348                                        0188 00682000
         L     @09,COUNTER(@08,@09)                                0188 00683000
         ST    @09,DATEOFST-8(@10,DHEWKPTR)                        0188 00684000
*     CTR=CTR+ONE;                  /* GO TO NEXT CONTROL FIELD    0189 00685000
*                                                            @Y30LB54*/ 00686000
         ALR   @15,@14                                             0189 00687000
         ST    @15,CTR(,DHEWKPTR)                                  0189 00688000
*   END;                            /* DO THIS PROCESS FOR FOUR DAYS    00689000
*                                      WORTH OF DATA         @Y30LB54*/ 00690000
         LA    @10,1                                               0190 00691000
         AL    @10,CTR1(,DHEWKPTR)                                 0190 00692000
         ST    @10,CTR1(,DHEWKPTR)                                 0190 00693000
         CH    @10,@CH00051                                        0190 00694000
         BNH   @DL00185                                            0190 00695000
*   DATEYYDD(FIVE)=DATETIME(1:4);   /* FILL IN CURRENT RECORD DATE 0191 00696000
*                                      FOR SORT              @Y30LB54*/ 00697000
         L     @10,LOGPTR(,DHEWKPTR)                               0191 00698000
         MVC   DATEYYDD+32(4,DHEWKPTR),DATETIME(@10)               0191 00699000
*   DATEOFST(FIVE)=0;               /* NO OFFSET ON NEW RECORD     0192 00700000
*                                                            @Y30LB54*/ 00701000
*                                                                  0192 00702000
         SLR   @10,@10                                             0192 00703000
         ST    @10,DATEOFST+32(,DHEWKPTR)                          0192 00704000
*   /*****************************************************************/ 00705000
*   /*                                                               */ 00706000
*   /* ARANGE NEW DAY TO DETERMINE IF PREEMPTION OF OLD DAY NEEDED   */ 00707000
*   /*                                                               */ 00708000
*   /*****************************************************************/ 00709000
*                                                                  0193 00710000
*   PTRDATE=0;                      /* DATE OFFSET INTO COUNTERS   0193 00711000
*                                                            @Y30LB54*/ 00712000
         ST    @10,PTRDATE(,DHEWKPTR)                              0193 00713000
*   SORTSW='0'B;                    /* TURN OFF SORT KEY     @Y30LB54*/ 00714000
         MVI   SORTSW(DHEWKPTR),B'00000000'                        0194 00715000
*   DO CTR1=1 TO 4 BY 1;            /* DETERMINE IF SORT IS NEEDED 0195 00716000
*                                                            @Y30LB54*/ 00717000
         LA    @10,1                                               0195 00718000
         ST    @10,CTR1(,DHEWKPTR)                                 0195 00719000
@DL00195 DS    0H                                                  0196 00720000
*     IF DATEYYDD(FIVE)>DATEYYDD(CTR1) THEN/* IF SO SORT IS NEEDED 0196 00721000
*                                                            @Y30LB54*/ 00722000
         L     @10,CTR1(,DHEWKPTR)                                 0196 00723000
         SLA   @10,3                                               0196 00724000
         ALR   @10,DHEWKPTR                                        0196 00725000
         CLC   DATEYYDD+32(4,DHEWKPTR),DATEYYDD-8(@10)             0196 00726000
         BNH   @RF00196                                            0196 00727000
*       DO;                         /*                       @Y30LB54*/ 00728000
*         CTR1=100;                 /* STOP THE LOOP         @Y30LB54*/ 00729000
*                                                                  0198 00730000
         MVC   CTR1(4,DHEWKPTR),@CF00318                           0198 00731000
*         /***********************************************************/ 00732000
*         /*                                                         */ 00733000
*         /* SORT THE DAY CONTROL TABLE                              */ 00734000
*         /*                                                         */ 00735000
*         /***********************************************************/ 00736000
*                                                                  0199 00737000
*         DO CTR=1 TO 4 BY 1;       /* SORT NEW TABLE        @Y30LB54*/ 00738000
         LA    @10,1                                               0199 00739000
         ST    @10,CTR(,DHEWKPTR)                                  0199 00740000
@DL00199 DS    0H                                                  0200 00741000
*           IF DATEYYDD(CTR+1)>DATEYYDD(CTR) THEN                  0200 00742000
         L     @10,CTR(,DHEWKPTR)                                  0200 00743000
         SLA   @10,3                                               0200 00744000
         ST    @10,@TF00001                                        0200 00745000
         ALR   @10,DHEWKPTR                                        0200 00746000
         LR    @01,DHEWKPTR                                        0200 00747000
         AL    @01,@TF00001                                        0200 00748000
         CLC   DATEYYDD(4,@10),DATEYYDD-8(@01)                     0200 00749000
         BNH   @RF00200                                            0200 00750000
*             DO;                   /*                       @Y30LB54*/ 00751000
*               FULLWD1=DATEYYDD(CTR);/* SAVE LOWER OF DATES @Y30LB54*/ 00752000
         L     @10,@TF00001                                        0202 00753000
         L     @10,DATEYYDD-8(@10,DHEWKPTR)                        0202 00754000
         ST    @10,FULLWD1(,DHEWKPTR)                              0202 00755000
*               FULLWD2=DATEOFST(CTR);/* SAVE LOWER COUNTER OFFSET 0203 00756000
*                                                            @Y30LB54*/ 00757000
         L     @01,@TF00001                                        0203 00758000
         L     @15,DATEOFST-8(@01,DHEWKPTR)                        0203 00759000
         ST    @15,FULLWD2(,DHEWKPTR)                              0203 00760000
*               DATETBL(CTR)=DATETBL(CTR+1);/* MOVE ENTIRE CONTROL 0204 00761000
*                                      ENTRY                 @Y30LB54*/ 00762000
         LR    @01,DHEWKPTR                                        0204 00763000
         AL    @01,@TF00001                                        0204 00764000
         LR    @14,DHEWKPTR                                        0204 00765000
         AL    @14,@TF00001                                        0204 00766000
         MVC   DATETBL-8(8,@01),DATETBL(@14)                       0204 00767000
*               DATEYYDD(CTR+1)=FULLWD1;/* SWAP IN LOWER DATE@Y30LB54*/ 00768000
         L     @01,@TF00001                                        0205 00769000
         ST    @10,DATEYYDD(@01,DHEWKPTR)                          0205 00770000
*               DATEOFST(CTR+1)=FULLWD2;/* SWAP IN LOWER OFFSET    0206 00771000
*                                                            @Y30LB54*/ 00772000
         L     @10,@TF00001                                        0206 00773000
         ST    @15,DATEOFST(@10,DHEWKPTR)                          0206 00774000
*               SORTSW='1'B;        /* LET WORLD KNOW WE HAVE NEW  0207 00775000
*                                      DATE                  @Y30LB54*/ 00776000
         MVI   SORTSW(DHEWKPTR),B'10000000'                        0207 00777000
*               CTR=0;              /* BUBBLE UP SORT THE ENTIRE LIST   00778000
*                                      AGAIN                 @Y30LB54*/ 00779000
         SLR   @10,@10                                             0208 00780000
         ST    @10,CTR(,DHEWKPTR)                                  0208 00781000
*             END;                  /*                       @Y30LB54*/ 00782000
*           ELSE                                                   0210 00783000
*             ;                     /*                       @Y30LB54*/ 00784000
@RF00200 DS    0H                                                  0211 00785000
*         END;                      /*                       @Y30LB54*/ 00786000
         LA    @10,1                                               0211 00787000
         AL    @10,CTR(,DHEWKPTR)                                  0211 00788000
         ST    @10,CTR(,DHEWKPTR)                                  0211 00789000
         CH    @10,@CH00051                                        0211 00790000
         BNH   @DL00199                                            0211 00791000
*       END;                        /*                       @Y30LB54*/ 00792000
*     ELSE                                                         0213 00793000
*                                                                  0213 00794000
*       /*************************************************************/ 00795000
*       /*                                                           */ 00796000
*       /* WE DID NOT NEED SORT DID WE HAVE MATCH                    */ 00797000
*       /*                                                           */ 00798000
*       /*************************************************************/ 00799000
*                                                                  0213 00800000
*       IF DATEYYDD(FIVE)=DATEYYDD(CTR1) THEN                      0213 00801000
         B     @RC00196                                            0213 00802000
@RF00196 L     @10,CTR1(,DHEWKPTR)                                 0213 00803000
         SLA   @10,3                                               0213 00804000
         ST    @10,@TF00001                                        0213 00805000
         ALR   @10,DHEWKPTR                                        0213 00806000
         CLC   DATEYYDD+32(4,DHEWKPTR),DATEYYDD-8(@10)             0213 00807000
         BNE   @RF00213                                            0213 00808000
*         DO;                       /*                       @Y30LB54*/ 00809000
*           PTRDATE=DATEOFST(CTR1); /*                       @Y30LB54*/ 00810000
         L     @10,@TF00001                                        0215 00811000
         L     @10,DATEOFST-8(@10,DHEWKPTR)                        0215 00812000
         ST    @10,PTRDATE(,DHEWKPTR)                              0215 00813000
*           CTR1=100;               /* TERMINATE LOOP WE HAVE HIT  0216 00814000
*                                                            @Y30LB54*/ 00815000
         MVC   CTR1(4,DHEWKPTR),@CF00318                           0216 00816000
*         END;                      /*                       @Y30LB54*/ 00817000
*       ELSE                                                       0218 00818000
*         ;                         /* CHECK NEXT CONTROL FIELD NOT     00819000
*                                      HIGH AND NOT EQUAL DONT ADD   */ 00820000
@RF00213 DS    0H                                                  0219 00821000
*   END;                            /*                       @Y30LB54*/ 00822000
@RC00196 LA    @10,1                                               0219 00823000
         AL    @10,CTR1(,DHEWKPTR)                                 0219 00824000
         ST    @10,CTR1(,DHEWKPTR)                                 0219 00825000
         CH    @10,@CH00051                                        0219 00826000
         BNH   @DL00195                                            0219 00827000
*   IF SORTSW^='00000000'B THEN     /* WE NOW HAVE A NEW DATE CONTROL   00828000
*                                      FIELD                 @Y30LB54*/ 00829000
*                                                                  0220 00830000
         CLI   SORTSW(DHEWKPTR),B'00000000'                        0220 00831000
         BE    @RF00220                                            0220 00832000
*     /***************************************************************/ 00833000
*     /*                                                             */ 00834000
*     /* LATER DATE FOUND UPDATE MASTER LIBRARY CONTROL FIELD        */ 00835000
*     /*                                                             */ 00836000
*     /***************************************************************/ 00837000
*                                                                  0221 00838000
*     DO;                           /*                       @Y30LB54*/ 00839000
*       CTR=1;                      /* COUNTER OFFSET        @Y30LB54*/ 00840000
         LA    @10,1                                               0222 00841000
         ST    @10,CTR(,DHEWKPTR)                                  0222 00842000
*       DO CTR1=1 TO 4 BY 1;        /* WE ARE GOING TO BUILD NEW   0223 00843000
*                                      CONTROL RECORD        @Y30LB54*/ 00844000
         ST    @10,CTR1(,DHEWKPTR)                                 0223 00845000
@DL00223 DS    0H                                                  0224 00846000
*         COUNTER(CTR)=DATEYYDD(CTR1);/* MOVE IN YYDDD       @Y30LB54*/ 00847000
         L     @10,CTR(,DHEWKPTR)                                  0224 00848000
         LR    @15,@10                                             0224 00849000
         SLA   @15,2                                               0224 00850000
         L     @14,KICKPTR(,DHEWKPTR)                              0224 00851000
         L     @09,CTR1(,DHEWKPTR)                                 0224 00852000
         SLA   @09,3                                               0224 00853000
         L     @08,DATEYYDD-8(@09,DHEWKPTR)                        0224 00854000
         AL    @15,@CF00348                                        0224 00855000
         ST    @08,COUNTER(@15,@14)                                0224 00856000
*         CTR=CTR+1;                /* POINT TO NEXT CONTROL OUTPUT     00857000
*                                      FIELD                 @Y30LB54*/ 00858000
         LA    @08,1                                               0225 00859000
         ALR   @10,@08                                             0225 00860000
         ST    @10,CTR(,DHEWKPTR)                                  0225 00861000
*         IF DATEOFST(CTR1)=0 THEN  /* THIS WAS THE INSERTED NEW   0226 00862000
*                                      FIELD                 @Y30LB54*/ 00863000
         L     @10,DATEOFST-8(@09,DHEWKPTR)                        0226 00864000
         LTR   @10,@10                                             0226 00865000
         BNZ   @RF00226                                            0226 00866000
*           DO;                     /*                       @Y30LB54*/ 00867000
*             DATEOFST(CTR1)=DATEOFST(FIVE);/* GUY ON BOTTOM LOOSES     00868000
*                                      OUT                   @Y30LB54*/ 00869000
         L     @10,DATEOFST+32(,DHEWKPTR)                          0228 00870000
         ST    @10,DATEOFST-8(@09,DHEWKPTR)                        0228 00871000
*             PTRDATE=DATEOFST(FIVE);/*                      @Y30LB54*/ 00872000
         L     @10,DATEOFST+32(,DHEWKPTR)                          0229 00873000
         ST    @10,PTRDATE(,DHEWKPTR)                              0229 00874000
*             FULLWD2=KICKPTR;      /* SAVE POINTER TO CONTROL FIELDS   00875000
*                                                            @Y30LB54*/ 00876000
         ST    @14,FULLWD2(,DHEWKPTR)                              0230 00877000
*             KICKPTR=PTRLIB+PTRRPT+PTRDATE+PTRSSID;/*       @Y30LB54*/ 00878000
         L     @09,PTRLIB(,DHEWKPTR)                               0231 00879000
         AL    @09,PTRRPT(,DHEWKPTR)                               0231 00880000
         ALR   @09,@10                                             0231 00881000
         AL    @09,PTRSSID(,DHEWKPTR)                              0231 00882000
         ST    @09,KICKPTR(,DHEWKPTR)                              0231 00883000
*             DO FULLWD1=1 TO 6 BY 1;/*                      @Y30LB54*/ 00884000
         ST    @08,FULLWD1(,DHEWKPTR)                              0232 00885000
@DL00232 DS    0H                                                  0233 00886000
*               COUNTER(FULLWD1)=0; /* ZERO COUNTERS         @Y30LB54*/ 00887000
         L     @10,FULLWD1(,DHEWKPTR)                              0233 00888000
         SLA   @10,2                                               0233 00889000
         L     @01,KICKPTR(,DHEWKPTR)                              0233 00890000
         SLR   @00,@00                                             0233 00891000
         AL    @01,@CF00348                                        0233 00892000
         ST    @00,COUNTER(@10,@01)                                0233 00893000
*             END;                  /*                       @Y30LB54*/ 00894000
         LA    @08,1                                               0234 00895000
         AL    @08,FULLWD1(,DHEWKPTR)                              0234 00896000
         ST    @08,FULLWD1(,DHEWKPTR)                              0234 00897000
         CH    @08,@CH00142                                        0234 00898000
         BNH   @DL00232                                            0234 00899000
*             KICKPTR=FULLWD2;      /* RESET KICKPTR BACK TO CONTROL    00900000
*                                      FIELD                 @Y30LB54*/ 00901000
         MVC   KICKPTR(4,DHEWKPTR),FULLWD2(DHEWKPTR)               0235 00902000
*           END;                    /*                       @Y30LB54*/ 00903000
*         ELSE                                                     0237 00904000
*           ;                       /*                       @Y30LB54*/ 00905000
@RF00226 DS    0H                                                  0238 00906000
*         COUNTER(CTR)=DATEOFST(CTR1);/* MOVE OFFSET INTO MASTER   0238 00907000
*                                      CONTROL RCD           @Y30LB54*/ 00908000
         L     @10,CTR(,DHEWKPTR)                                  0238 00909000
         LR    @15,@10                                             0238 00910000
         SLA   @15,2                                               0238 00911000
         L     @01,KICKPTR(,DHEWKPTR)                              0238 00912000
         L     @14,CTR1(,DHEWKPTR)                                 0238 00913000
         SLA   @14,3                                               0238 00914000
         L     @14,DATEOFST-8(@14,DHEWKPTR)                        0238 00915000
         AL    @01,@CF00348                                        0238 00916000
         ST    @14,COUNTER(@15,@01)                                0238 00917000
*         CTR=CTR+1;                /* POINT TO NEXT CONTROL OUTPUT     00918000
*                                      FIELD                 @Y30LB54*/ 00919000
         AH    @10,@CH00048                                        0239 00920000
         ST    @10,CTR(,DHEWKPTR)                                  0239 00921000
*       END;                        /*                       @Y30LB54*/ 00922000
         LA    @10,1                                               0240 00923000
         AL    @10,CTR1(,DHEWKPTR)                                 0240 00924000
         ST    @10,CTR1(,DHEWKPTR)                                 0240 00925000
         CH    @10,@CH00051                                        0240 00926000
         BNH   @DL00223                                            0240 00927000
*     END;                          /*                       @Y30LB54*/ 00928000
*   ELSE                                                           0242 00929000
*     ;                             /*                       @Y30LB54*/ 00930000
@RF00220 DS    0H                                                  0243 00931000
*   IF PTRDATE^=0 THEN                                             0243 00932000
*                                                                  0243 00933000
         L     @10,PTRDATE(,DHEWKPTR)                              0243 00934000
         LTR   @10,@10                                             0243 00935000
         BZ    @RF00243                                            0243 00936000
*     /***************************************************************/ 00937000
*     /*                                                             */ 00938000
*     /* WE HAVE A RECORD OF LATEST 4 DAYS ADD TO COUNTERS           */ 00939000
*     /*                                                             */ 00940000
*     /***************************************************************/ 00941000
*                                                                  0244 00942000
*     DO;                           /*                       @Y30LB54*/ 00943000
*       KICKPTR=PTRLIB+PTRRPT+PTRDATE+PTRSSID;/*             @Y30LB54*/ 00944000
         L     @15,PTRLIB(,DHEWKPTR)                               0245 00945000
         AL    @15,PTRRPT(,DHEWKPTR)                               0245 00946000
         ALR   @15,@10                                             0245 00947000
         AL    @15,PTRSSID(,DHEWKPTR)                              0245 00948000
         ST    @15,KICKPTR(,DHEWKPTR)                              0245 00949000
*       DO CTR=1 TO 6 BY 1;         /* WANT TO ADD IN 6 COUNTERS   0246 00950000
*                                                            @Y30LB54*/ 00951000
         LA    @10,1                                               0246 00952000
         ST    @10,CTR(,DHEWKPTR)                                  0246 00953000
@DL00246 DS    0H                                                  0247 00954000
*         COUNTER(CTR)=INCTR(CTR)+COUNTER(CTR);/*            @Y30LB54*/ 00955000
         L     @10,CTR(,DHEWKPTR)                                  0247 00956000
         SLA   @10,2                                               0247 00957000
         L     @15,KICKPTR(,DHEWKPTR)                              0247 00958000
         L     @14,PTRINP(,DHEWKPTR)                               0247 00959000
         AL    @14,@CF00348                                        0247 00960000
         L     @14,INCTR(@10,@14)                                  0247 00961000
         LA    @01,0(@10,@15)                                      0247 00962000
         AL    @01,@CF00348                                        0247 00963000
         AL    @14,COUNTER(,@01)                                   0247 00964000
         AL    @15,@CF00348                                        0247 00965000
         ST    @14,COUNTER(@10,@15)                                0247 00966000
*         COUNTR4A=COUNTR4A+1;      /* NUMBER OF TIMES COUNTERS ADDED   00967000
*                                      TO                    @Y30LB54*/ 00968000
         LA    @10,1                                               0248 00969000
         AL    @10,COUNTR4A(,DHEWKPTR)                             0248 00970000
         ST    @10,COUNTR4A(,DHEWKPTR)                             0248 00971000
*       END;                        /*                       @Y30LB54*/ 00972000
         LA    @10,1                                               0249 00973000
         AL    @10,CTR(,DHEWKPTR)                                  0249 00974000
         ST    @10,CTR(,DHEWKPTR)                                  0249 00975000
         CH    @10,@CH00142                                        0249 00976000
         BNH   @DL00246                                            0249 00977000
*     END;                          /*                       @Y30LB54*/ 00978000
*   ELSE                                                           0251 00979000
*     ;                             /*                       @Y30LB54*/ 00980000
@RF00243 DS    0H                                                  0252 00981000
*   END RPT4AFIL;                   /*                       @Y30LB54*/ 00982000
@EL00004 DS    0H                                                  0252 00983000
@EF00004 DS    0H                                                  0252 00984000
@ER00004 L     @14,12(,@13)                                        0252 00985000
         BR    @14                                                 0252 00986000
*                                                                  0253 00987000
*   /*****************************************************************/ 00988000
*   /*                                                               */ 00989000
*   /* SAVE DHE COMPOSIT RECORDS                                     */ 00990000
*   /*                                                               */ 00991000
*   /*****************************************************************/ 00992000
*                                                                  0253 00993000
*RPT5FILL:                                                         0253 00994000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB54*/ 00995000
RPT5FILL ST    @14,@SA00005                                        0253 00996000
*   PTRINP=ADDR(DATA05)+12;         /* ADDRESS OF COMPOSIT COUNTERS     00997000
*                                                            @Y30LB54*/ 00998000
         LA    @10,DATA05(,DHEWKPTR)                               0254 00999000
         AH    @10,@CH00065                                        0254 01000000
         ST    @10,PTRINP(,DHEWKPTR)                               0254 01001000
*   DO CTR=1 TO 6 BY 1;             /* LOOK FOR OVERFLOWED COUNTER 0255 01002000
*                                                            @Y30LB54*/ 01003000
         LA    @10,1                                               0255 01004000
         ST    @10,CTR(,DHEWKPTR)                                  0255 01005000
@DL00255 DS    0H                                                  0256 01006000
*     LINE(1:4)=INCTR(CTR)&MSK(CTR);/* CLEAR EVERYTHING EXCEPT     0256 01007000
*                                      OVERFLOW              @Y30LB54*/ 01008000
         L     @10,CTR(,DHEWKPTR)                                  0256 01009000
         SLA   @10,2                                               0256 01010000
         L     @01,PTRINP(,DHEWKPTR)                               0256 01011000
         L     @15,MSK-4(@10)                                      0256 01012000
         AL    @01,@CF00348                                        0256 01013000
         L     @10,INCTR(@10,@01)                                  0256 01014000
         NR    @10,@15                                             0256 01015000
         ST    @10,LINE(,CVTPTR)                                   0256 01016000
*     IF LINE(1:4)=MSK(CTR) THEN    /* 1 BIT MEANS OVERFLOW  @Y30LB54*/ 01017000
         CR    @10,@15                                             0257 01018000
         BNE   @RF00257                                            0257 01019000
*       DO;                         /*                       @Y30LB54*/ 01020000
*         IF PTR5TOP=0 THEN         /* HAVE WE HAD ANY BEFORE@Y30LB54*/ 01021000
         ICM   @10,15,PTR5TOP(DHEWKPTR)                            0259 01022000
         BNZ   @RF00259                                            0259 01023000
*           DO;                     /*                       @Y30LB54*/ 01024000
*             SPNO=0;               /* SUBPOOL NUMBER        @Y30LB54*/ 01025000
         MVI   SPNO(CVTPTR),X'00'                                  0261 01026000
*             CORELEN=50*36;        /* ALLOW FOR 50 OVERFLOW RECORDS    01027000
*                                                            @Y30LB54*/ 01028000
         MVC   CORELEN(3,CVTPTR),@CF00347+1                        0262 01029000
*             CALL ISDAGET1(WORKPTR);/*                      @Y30LB54*/ 01030000
         L     @10,@PC00001                                        0263 01031000
         ST    @10,@AL00001                                        0263 01032000
         L     @15,@CV00041                                        0263 01033000
         LA    @01,@AL00001                                        0263 01034000
         BALR  @14,@15                                             0263 01035000
*             RFY                                                  0264 01036000
*               R15 RSTD;           /*                       @Y30LB54*/ 01037000
*             RETCODE=R15;          /*                       @Y30LB54*/ 01038000
         LR    RETCODE,R15                                         0265 01039000
*             RFY                                                  0266 01040000
*               R15 UNRSTD;         /*                       @Y30LB54*/ 01041000
*             IF RETCODE=0 THEN     /* WE GOT CORE OK        @Y30LB54*/ 01042000
         LTR   RETCODE,RETCODE                                     0267 01043000
         BNZ   @RF00267                                            0267 01044000
*               DO;                 /*                       @Y30LB54*/ 01045000
*                 PTR5TOP=COREADDR; /* BEGINNING OF CORE AREA@Y30LB54*/ 01046000
         L     @10,COREADDR(,CVTPTR)                               0269 01047000
         ST    @10,PTR5TOP(,DHEWKPTR)                              0269 01048000
*                 PTR5CUR=COREADDR; /* CURRENT WORKING ADDRESS     0270 01049000
*                                                            @Y30LB54*/ 01050000
         ST    @10,PTR5CUR(,DHEWKPTR)                              0270 01051000
*                 PTR5BOT=COREADDR+(50*36);/* BACK END OF CORE AREA     01052000
*                                                            @Y30LB54*/ 01053000
         AL    @10,@CF00347                                        0271 01054000
         ST    @10,PTR5BOT(,DHEWKPTR)                              0271 01055000
*               END;                /*                       @Y30LB54*/ 01056000
*             ELSE                  /* WE DID NOT GET CORE QUIT    0273 01057000
*                                                            @Y30LB54*/ 01058000
*               DO;                 /*                       @Y30LB54*/ 01059000
         B     @RC00267                                            0273 01060000
@RF00267 DS    0H                                                  0274 01061000
*                 CALL FREECORE;    /* FREE ALL CORE WE HAVE SO FAR     01062000
*                                                            @Y30LB54*/ 01063000
         BAL   @14,FREECORE                                        0274 01064000
*                 RETCODE=4;        /*                       @Y30LB54*/ 01065000
         LA    RETCODE,4                                           0275 01066000
*                 RETURN CODE(RETCODE);/*                    @Y30LB54*/ 01067000
         LR    @15,RETCODE                                         0276 01068000
@EL00005 DS    0H                                                  0276 01069000
@EF00005 DS    0H                                                  0276 01070000
@ER00005 L     @14,@SA00005                                        0276 01071000
         BR    @14                                                 0276 01072000
*               END;                /*                       @Y30LB54*/ 01073000
*           END;                    /*                       @Y30LB54*/ 01074000
*         ELSE                      /* CHECK FOR MAX LIMIT   @ZM30983*/ 01075000
*           IF PTR5BOT='FFFFFFFF'X THEN  /* WE HAVE EXCEEDED       0279 01076000
*                                           OUR LIMIT        @ZM30983*/ 01077000
         B     @RC00259                                            0279 01078000
@RF00259 CLC   PTR5BOT(4,DHEWKPTR),@CF00334                        0279 01079000
         BNE   @RF00279                                            0279 01080000
*             DO;                   /*                       @ZM30983*/ 01081000
*               RETCODE=16;         /* REJECT RECORD         @ZM30983*/ 01082000
         LA    RETCODE,16                                          0281 01083000
*               RETURN CODE(RETCODE); /*                     @ZM30983*/ 01084000
         LR    @15,RETCODE                                         0282 01085000
         L     @14,@SA00005                                        0282 01086000
         BR    @14                                                 0282 01087000
*             END;                  /*                       @ZM30983*/ 01088000
*           ELSE;                   /* NOT AT MAX YET        @ZM30983*/ 01089000
@RF00279 DS    0H                                                  0285 01090000
*                                                                  0285 01091000
*         /***********************************************************/ 01092000
*         /*                                                         */ 01093000
*         /* WRITE INTO GETMAIN AREA                                 */ 01094000
*         /*                                                         */ 01095000
*         /***********************************************************/ 01096000
*                                                                  0285 01097000
*         CTR=100;                  /* GET OUT OF LOOP       @Y30LB54*/ 01098000
@RC00259 MVC   CTR(4,DHEWKPTR),@CF00318                            0285 01099000
*         IF PTR5CUR=PTR5BOT THEN   /* HAVE WE FILLED BUFFER @Y30LB54*/ 01100000
         CLC   PTR5CUR(4,DHEWKPTR),PTR5BOT(DHEWKPTR)               0286 01101000
         BNE   @RF00286                                            0286 01102000
*           DO;                     /*                       @Y30LB54*/ 01103000
*             PTR5BOT='FFFFFFFF'X;  /*    SET OVERFLOW FLAG  @Y30LB54*/ 01104000
         MVC   PTR5BOT(4,DHEWKPTR),@CF00334                        0288 01105000
*             ANSI='-';             /* SET 2 LINE SKIP       @ZM30983*/ 01106000
         MVI   ANSI(CVTPTR),C'-'                                   0289 01107000
*             LINE=                                                0290 01108000
*'ISDADHE0 OVERFLOW RECORDS EXCEED LIMIT FIRST 50 PROCESSED';      0290 01109000
         MVI   LINE+57(CVTPTR),C' '                                0290 01110000
         MVC   LINE+58(74,CVTPTR),LINE+57(CVTPTR)                  0290 01111000
         MVC   LINE(57,CVTPTR),@CC00336                            0290 01112000
*             CALL ISDAPRT0(WORKPTR);/*                      @Y30LB54*/ 01113000
         L     @10,@PC00001                                        0291 01114000
         ST    @10,@AL00001                                        0291 01115000
         L     @15,@CV00039                                        0291 01116000
         LA    @01,@AL00001                                        0291 01117000
         BALR  @14,@15                                             0291 01118000
*             CALL ISDATYPE(WORKPTR);/*                      @Y30LB54*/ 01119000
         L     @10,@PC00001                                        0292 01120000
         ST    @10,@AL00001                                        0292 01121000
         L     @15,@CV00040                                        0292 01122000
         LA    @01,@AL00001                                        0292 01123000
         BALR  @14,@15                                             0292 01124000
*             RETCODE=16;            /* SET DHE REJECT CODE  @ZM30983*/ 01125000
         LA    RETCODE,16                                          0293 01126000
*             RETURN CODE(RETCODE); /*                       @Y30LB54*/ 01127000
         LR    @15,RETCODE                                         0294 01128000
         L     @14,@SA00005                                        0294 01129000
         BR    @14                                                 0294 01130000
*           END;                    /*                       @Y30LB54*/ 01131000
*         ELSE                                                     0296 01132000
*           ;                       /*                       @Y30LB54*/ 01133000
@RF00286 DS    0H                                                  0297 01134000
*         RPT5RCD(ONE)=DATA05;      /*                       @Y30LB54*/ 01135000
         L     @10,PTR5CUR(,DHEWKPTR)                              0297 01136000
         MVC   RPT5RCD(36,@10),DATA05(DHEWKPTR)                    0297 01137000
*         PTR5CUR=PTR5CUR+36;       /* INCREMENT FOR NEXT TIME     0298 01138000
*                                                            @Y30LB54*/ 01139000
         AH    @10,@CH00275                                        0298 01140000
         ST    @10,PTR5CUR(,DHEWKPTR)                              0298 01141000
*         COUNTRP5=COUNTRP5+1;      /* TELL HE1 WE HAVE DATA @Y30LB54*/ 01142000
         LA    @10,1                                               0299 01143000
         AL    @10,COUNTRP5(,DHEWKPTR)                             0299 01144000
         ST    @10,COUNTRP5(,DHEWKPTR)                             0299 01145000
*       END;                        /*                       @Y30LB54*/ 01146000
*     ELSE;                         /* NO OVERFLOW           @ZA29820*/ 01147000
@RF00257 DS    0H                                                  0302 01148000
*   END;                            /*                       @Y30LB54*/ 01149000
         LA    @10,1                                               0302 01150000
         AL    @10,CTR(,DHEWKPTR)                                  0302 01151000
         ST    @10,CTR(,DHEWKPTR)                                  0302 01152000
         CH    @10,@CH00142                                        0302 01153000
         BNH   @DL00255                                            0302 01154000
*   END RPT5FILL;                   /*                       @Y30LB54*/ 01155000
         B     @EL00005                                            0303 01156000
*                                                                  0304 01157000
*   /*****************************************************************/ 01158000
*   /*                                                               */ 01159000
*   /* FREE ALL CORE WE RAN INTO PROBLEMS AND CANNOT CONTINUE        */ 01160000
*   /*                                                               */ 01161000
*   /*****************************************************************/ 01162000
*                                                                  0304 01163000
*FREECORE:                                                         0304 01164000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB54*/ 01165000
FREECORE ST    @14,@SA00006                                        0304 01166000
*   DO CTR1=1 TO 4 BY 1;            /*                       @Y30LB54*/ 01167000
         LA    @10,1                                               0305 01168000
         ST    @10,CTR1(,DHEWKPTR)                                 0305 01169000
@DL00305 DS    0H                                                  0306 01170000
*     IF LIBPTR(CTR1)^=0 THEN       /* FREE ALL CORE ALREADY OBTAINED   01171000
*                                                            @Y30LB54*/ 01172000
         L     @10,CTR1(,DHEWKPTR)                                 0306 01173000
         SLA   @10,2                                               0306 01174000
         L     @10,LIBPTR-5(@10,DHEWKPTR)                          0306 01175000
         LA    @10,0(,@10)                                         0306 01176000
         LTR   @10,@10                                             0306 01177000
         BZ    @RF00306                                            0306 01178000
*       DO;                         /*                       @Y30LB54*/ 01179000
*         SPNO=0;                   /*                       @Y30LB54*/ 01180000
         MVI   SPNO(CVTPTR),X'00'                                  0308 01181000
*         CORELEN=192+32+768;       /* FILL IN LENGTH OF AREA@Y30LB54*/ 01182000
         MVC   CORELEN(3,CVTPTR),@CF00346+1                        0309 01183000
*         COREADDR=LIBPTR(CTR1);    /* FILL IN ADDRESS OF AREA     0310 01184000
*                                                            @Y30LB54*/ 01185000
         ST    @10,COREADDR(,CVTPTR)                               0310 01186000
*         CALL ISDAFREE(WORKPTR);   /*                       @Y30LB54*/ 01187000
         L     @10,@PC00001                                        0311 01188000
         ST    @10,@AL00001                                        0311 01189000
         L     @15,@CV00042                                        0311 01190000
         LA    @01,@AL00001                                        0311 01191000
         BALR  @14,@15                                             0311 01192000
*         LIBPTR(CTR1)=0;           /* DELETE GOTTEN CORE PTR@Y30LB54*/ 01193000
         L     @10,CTR1(,DHEWKPTR)                                 0312 01194000
         SLA   @10,2                                               0312 01195000
         ALR   @10,DHEWKPTR                                        0312 01196000
         SLR   @04,@04                                             0312 01197000
         STCM  @04,7,LIBPTR-4(@10)                                 0312 01198000
*       END;                        /*                       @Y30LB54*/ 01199000
*     ELSE                                                         0314 01200000
*       ;                           /*                       @Y30LB54*/ 01201000
@RF00306 DS    0H                                                  0315 01202000
*   END;                            /*                       @Y30LB54*/ 01203000
         LA    @10,1                                               0315 01204000
         AL    @10,CTR1(,DHEWKPTR)                                 0315 01205000
         ST    @10,CTR1(,DHEWKPTR)                                 0315 01206000
         CH    @10,@CH00051                                        0315 01207000
         BNH   @DL00305                                            0315 01208000
*   CDHEDHU='00'X;                  /* DONT LET CONTROL COME TO US 0316 01209000
*                                      AGAIN                 @Y30LB54*/ 01210000
         MVI   CDHEDHU(LPARMPTR),X'00'                             0316 01211000
*   RETCODE=4;                      /* TELL CONTROL WHY WE QUIT    0317 01212000
*                                                            @Y30LB54*/ 01213000
         LA    RETCODE,4                                           0317 01214000
*   IF PTR5TOP^=0 THEN              /* DO WE HAVE DHE SPACE  @Y30LB54*/ 01215000
         L     @10,PTR5TOP(,DHEWKPTR)                              0318 01216000
         LTR   @10,@10                                             0318 01217000
         BZ    @RF00318                                            0318 01218000
*     DO;                           /*                       @Y30LB54*/ 01219000
*       SPNO=0;                     /*                       @Y30LB54*/ 01220000
         MVI   SPNO(CVTPTR),X'00'                                  0320 01221000
*       CORELEN=50*36;              /*                       @Y30LB54*/ 01222000
         MVC   CORELEN(3,CVTPTR),@CF00347+1                        0321 01223000
*       COREADDR=PTR5TOP;           /*                       @Y30LB54*/ 01224000
         ST    @10,COREADDR(,CVTPTR)                               0322 01225000
*       CALL ISDAFREE(WORKPTR);     /*                       @Y30LB54*/ 01226000
         L     @10,@PC00001                                        0323 01227000
         ST    @10,@AL00001                                        0323 01228000
         L     @15,@CV00042                                        0323 01229000
         LA    @01,@AL00001                                        0323 01230000
         BALR  @14,@15                                             0323 01231000
*       PTR5TOP=0;                  /*                       @Y30LB54*/ 01232000
         SLR   @10,@10                                             0324 01233000
         ST    @10,PTR5TOP(,DHEWKPTR)                              0324 01234000
*       PTR5CUR=0;                  /*                       @Y30LB54*/ 01235000
         ST    @10,PTR5CUR(,DHEWKPTR)                              0325 01236000
*       PTR5BOT=0;                  /*                       @Y30LB54*/ 01237000
         ST    @10,PTR5BOT(,DHEWKPTR)                              0326 01238000
*     END;                          /*                       @Y30LB54*/ 01239000
*   ELSE                                                           0328 01240000
*     ;                             /*                       @Y30LB54*/ 01241000
@RF00318 DS    0H                                                  0329 01242000
*   SPNO=0;                         /* FREE WORKING CORE ALSO@Y30LB54*/ 01243000
         MVI   SPNO(CVTPTR),X'00'                                  0329 01244000
*   CORELEN=LENGTH(WORKCORE);       /* FILL IN LENGTH OF AREA@Y30LB54*/ 01245000
         MVC   CORELEN(3,CVTPTR),@CF00344+1                        0330 01246000
*   COREADDR=DHE00PTR;              /* FILL IN LOCATION ADDRESS    0331 01247000
*                                                            @Y30LB54*/ 01248000
         MVC   COREADDR(4,CVTPTR),DHE00PTR(CVTPTR)                 0331 01249000
*   CALL ISDAFREE(WORKPTR);         /*                       @Y30LB54*/ 01250000
         L     @10,@PC00001                                        0332 01251000
         ST    @10,@AL00001                                        0332 01252000
         L     @15,@CV00042                                        0332 01253000
         LA    @01,@AL00001                                        0332 01254000
         BALR  @14,@15                                             0332 01255000
*   DHE00PTR=0;                     /* TELL THE WORLD WE QUIT@Y30LB54*/ 01256000
         SLR   @10,@10                                             0333 01257000
         ST    @10,DHE00PTR(,CVTPTR)                               0333 01258000
*   RETURN CODE(RETCODE);           /*                       @Y30LB54*/ 01259000
         LR    @15,RETCODE                                         0334 01260000
@EL00006 DS    0H                                                  0334 01261000
@EF00006 DS    0H                                                  0334 01262000
@ER00006 L     @14,@SA00006                                        0334 01263000
         BR    @14                                                 0334 01264000
*   END FREECORE;                   /*                       @Y30LB54*/ 01265000
*   END ISDADHE0                    /*                       @Y30LB54*/ 01266000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 01267000
*/*%INCLUDE SYSLIB  (ISDAPRMS)                                        * 01268000
*/*%INCLUDE SYSLIB  (ISDACVT )                                        * 01269000
*/*%INCLUDE SYSLIB  (ISDASOBR)                                        * 01270000
*/*%INCLUDE SYSLIB  (ISDAMSCS)                                        * 01271000
*;                                                                 0336 01272000
@DATA    DS    0H                                                       01273000
@CH00048 DC    H'1'                                                     01274000
@CH00051 DC    H'4'                                                     01275000
@CH00142 DC    H'6'                                                     01276000
@CH00302 DC    H'7'                                                     01277000
@CH00072 DC    H'8'                                                     01278000
@CH00065 DC    H'12'                                                    01279000
@CH00122 DC    H'24'                                                    01280000
@CH00275 DC    H'36'                                                    01281000
@CH00321 DC    H'99'                                                    01282000
@CH00315 DC    H'192'                                                   01283000
@CH00319 DC    H'248'                                                   01284000
@DATD    DSECT                                                          01285000
         DS    0F                                                       01286000
@SA00001 DS    18F                                                      01287000
@PC00001 DS    1F                                                       01288000
@SA00002 DS    1F                                                       01289000
@SA00005 DS    1F                                                       01290000
@SA00006 DS    0F                                                       01291000
         DS    1F                                                       01292000
@AL00001 DS    1A                                                       01293000
@TF00001 DS    F                                                        01294000
ISDADHE0 CSECT                                                          01295000
         DS    0F                                                       01296000
@CF00316 DC    F'32'                                                    01297000
@CF00318 DC    F'100'                                                   01298000
@CF00344 DC    F'336'                                                   01299000
@CF00346 DC    F'992'                                                   01300000
@CF00347 DC    F'1800'                                                  01301000
@CF00348 DC    F'-4'                                                    01302000
@CF00301 DC    XL4'0000000F'                                            01303000
@CF00303 DC    XL4'000000F0'                                            01304000
@CF00334 DC    XL4'FFFFFFFF'                                            01305000
@DATD    DSECT                                                          01306000
         DS    0D                                                       01307000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                01308000
@ENDDATD EQU   *                                                        01309000
ISDADHE0 CSECT                                                          01310000
         NOPR  ((@ENDDATD-@DATD)/161*16)                                01311000
         DS    0F                                                       01312000
@SIZDATD DC    AL1(0)                                                   01313000
         DC    AL3(@ENDDATD-@DATD)                                      01314000
@CV00039 DC    V(ISDAPRT0)                                              01315000
@CV00040 DC    V(ISDATYPE)                                              01316000
@CV00041 DC    V(ISDAGET1)                                              01317000
@CV00042 DC    V(ISDAFREE)                                              01318000
         DS    0D                                                       01319000
@CC00336 DC    C'ISDADHE0 OVERFLOW RECORDS EXCEED LIMIT FIRST 50 PROCESC01320000
               SED'                                                     01321000
@CB00306 DC    X'0000'                                                  01322000
TRPAT04  DC    X'040418190411121304041A1B0415161704041E1F04041C1D'      01323000
         DS    CL1                                                      01324000
MASKTBL  DS    CL24                                                     01325000
         ORG   MASKTBL                                                  01326000
MSK      DC    XL4'00008000'                                            01327000
         DC    XL4'00800000'                                            01328000
         DC    XL4'00008000'                                            01329000
         DC    XL4'00800000'                                            01330000
         DC    XL4'00008000'                                            01331000
         DC    XL4'00008000'                                            01332000
         ORG   MASKTBL+24                                               01333000
PATCH    DC    50X'00'                                                  01334000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       01335000
@01      EQU   01                                                       01336000
@02      EQU   02                                                       01337000
@03      EQU   03                                                       01338000
@04      EQU   04                                                       01339000
@05      EQU   05                                                       01340000
@06      EQU   06                                                       01341000
@07      EQU   07                                                       01342000
@08      EQU   08                                                       01343000
@09      EQU   09                                                       01344000
@10      EQU   10                                                       01345000
@11      EQU   11                                                       01346000
@12      EQU   12                                                       01347000
@13      EQU   13                                                       01348000
@14      EQU   14                                                       01349000
@15      EQU   15                                                       01350000
RETCODE  EQU   @04                                                      01351000
DHEWKPTR EQU   @03                                                      01352000
SENSEPTR EQU   @06                                                      01353000
LPARMPTR EQU   @05                                                      01354000
CVTPTR   EQU   @02                                                      01355000
R15      EQU   @15                                                      01356000
R0       EQU   @00                                                      01357000
R1       EQU   @01                                                      01358000
ISDAPRMS EQU   0                                                        01359000
CINPUT   EQU   ISDAPRMS                                                 01360000
CSTART   EQU   ISDAPRMS+2                                               01361000
CEND     EQU   ISDAPRMS+6                                               01362000
CFSCONLY EQU   ISDAPRMS+13                                              01363000
CSSIDF   EQU   ISDAPRMS+17                                              01364000
CSERIAL  EQU   ISDAPRMS+21                                              01365000
CREPORTS EQU   ISDAPRMS+33                                              01366000
CDHEDHU  EQU   CREPORTS+3                                               01367000
ISDACVT  EQU   0                                                        01368000
CVTPTRS0 EQU   ISDACVT                                                  01369000
DATAPTR  EQU   CVTPTRS0                                                 01370000
SDATAPTR EQU   CVTPTRS0+4                                               01371000
PARMPTR  EQU   CVTPTRS0+8                                               01372000
DHE00PTR EQU   CVTPTRS0+52                                              01373000
GET0CALL EQU   ISDACVT+100                                              01374000
SPNOLEN  EQU   GET0CALL                                                 01375000
SPNO     EQU   SPNOLEN                                                  01376000
CORELEN  EQU   SPNOLEN+1                                                01377000
COREADDR EQU   GET0CALL+4                                               01378000
HEXPCALL EQU   ISDACVT+108                                              01379000
PRT0CALL EQU   ISDACVT+120                                              01380000
OUTLINE  EQU   PRT0CALL                                                 01381000
ANSI     EQU   OUTLINE                                                  01382000
LINE     EQU   OUTLINE+1                                                01383000
SDADATD  EQU   ISDACVT+256                                              01384000
PRTDATD  EQU   ISDACVT+416                                              01385000
OBRMDR   EQU   0                                                        01386000
SCW      EQU   OBRMDR                                                   01387000
SWITCHES EQU   OBRMDR+6                                                 01388000
DATETIME EQU   OBRMDR+12                                                01389000
DATE     EQU   DATETIME                                                 01390000
TIME     EQU   DATETIME+4                                               01391000
CPUSERID EQU   OBRMDR+21                                                01392000
ISDAMSCS EQU   0                                                        01393000
SUBSYSID EQU   ISDAMSCS+1                                               01394000
SSID     EQU   SUBSYSID                                                 01395000
SUBSENSE EQU   ISDAMSCS+4                                               01396000
SUBSTAT4 EQU   SUBSENSE                                                 01397000
SUBFMTMG EQU   SUBSENSE+7                                               01398000
INPUTCTR EQU   0                                                        01399000
INCTR    EQU   INPUTCTR                                                 01400000
RPT5RCD  EQU   0                                                        01401000
WORKCORE EQU   0                                                        01402000
LOGPTR   EQU   WORKCORE                                                 01403000
LIBTAB   EQU   WORKCORE+4                                               01404000
LIBNO    EQU   LIBTAB                                                   01405000
LIBPTR   EQU   LIBTAB+1                                                 01406000
FULLWD1  EQU   WORKCORE+20                                              01407000
FULLWD2  EQU   WORKCORE+24                                              01408000
DATASSID EQU   WORKCORE+28                                              01409000
DATALIB  EQU   WORKCORE+32                                              01410000
KICKPTR  EQU   WORKCORE+36                                              01411000
PTRRPT   EQU   WORKCORE+40                                              01412000
PTRLIB   EQU   WORKCORE+44                                              01413000
PTRSSID  EQU   WORKCORE+48                                              01414000
PTRDATE  EQU   WORKCORE+52                                              01415000
PTRINP   EQU   WORKCORE+56                                              01416000
CTR      EQU   WORKCORE+60                                              01417000
CTR1     EQU   WORKCORE+64                                              01418000
CHAR4    EQU   WORKCORE+68                                              01419000
COUNTRP4 EQU   WORKCORE+72                                              01420000
COUNTR4A EQU   WORKCORE+76                                              01421000
COUNTRP5 EQU   WORKCORE+80                                              01422000
DATETBL  EQU   WORKCORE+84                                              01423000
DATEYYDD EQU   DATETBL                                                  01424000
DATEOFST EQU   DATETBL+4                                                01425000
PTR5TOP  EQU   WORKCORE+124                                             01426000
PTR5CUR  EQU   WORKCORE+128                                             01427000
PTR5BOT  EQU   WORKCORE+132                                             01428000
RATIOTBL EQU   WORKCORE+152                                             01429000
DATA04   EQU   WORKCORE+248                                             01430000
DATA05   EQU   WORKCORE+272                                             01431000
SORTSW   EQU   WORKCORE+309                                             01432000
COUNTER  EQU   0                                                        01433000
WORKPTR  EQU   0                                                        01434000
BYTESSID EQU   DATASSID+3                                               01435000
*                                      START UNREFERENCED COMPONENTS    01436000
COUNT    EQU   COUNTER                                                  01437000
ENDAREA  EQU   WORKCORE+335                                             01438000
CHAR5    EQU   WORKCORE+330                                             01439000
EDREC1   EQU   WORKCORE+321                                             01440000
EDREC    EQU   WORKCORE+311                                             01441000
FOURBITS EQU   WORKCORE+310                                             01442000
DATAWORK EQU   WORKCORE+308                                             01443000
RATCODE  EQU   RATIOTBL+3                                               01444000
RATSSID  EQU   RATIOTBL+2                                               01445000
RATCNT   EQU   RATIOTBL                                                 01446000
RATCTR   EQU   WORKCORE+148                                             01447000
GRANDE   EQU   WORKCORE+144                                             01448000
GRANDU   EQU   WORKCORE+140                                             01449000
LIBCTR   EQU   WORKCORE+136                                             01450000
@NM00012 EQU   RPT5RCD+32                                               01451000
@NM00011 EQU   RPT5RCD+28                                               01452000
@NM00010 EQU   RPT5RCD+24                                               01453000
@NM00009 EQU   RPT5RCD+20                                               01454000
@NM00008 EQU   RPT5RCD+16                                               01455000
RPT5CTRS EQU   RPT5RCD+12                                               01456000
@NM00007 EQU   RPT5RCD+10                                               01457000
RPT5SSID EQU   RPT5RCD+9                                                01458000
RPT5DATE EQU   RPT5RCD+1                                                01459000
RPT5LIB  EQU   RPT5RCD                                                  01460000
SANOMSCD EQU   SUBSENSE+27                                              01461000
RCYLMSCD EQU   SUBSENSE+25                                              01462000
RUAMSCD  EQU   SUBSENSE+24                                              01463000
MSCFSC   EQU   SUBSENSE+22                                              01464000
@NM00006 EQU   SUBSENSE+21                                              01465000
RUADASD  EQU   SUBSENSE+20                                              01466000
DASDFSC  EQU   SUBSENSE+18                                              01467000
@NM00005 EQU   SUBSENSE+8                                               01468000
MSGCODEN EQU   SUBFMTMG                                                 01469000
SUBFMTNO EQU   SUBFMTMG                                                 01470000
SALOWAD2 EQU   SUBSENSE+6                                               01471000
SARETRY  EQU   SUBSENSE+5                                               01472000
@NM00004 EQU   SUBSENSE+4                                               01473000
DASDFMTN EQU   SUBSENSE+3                                               01474000
SALOWADD EQU   SUBSENSE+2                                               01475000
SUBSTAT5 EQU   SUBSENSE+1                                               01476000
FORMATNO EQU   ISDAMSCS+3                                               01477000
SSIDDEVT EQU   SSID+1                                                   01478000
SSIDLIBN EQU   SSID+1                                                   01479000
SSIDTYPE EQU   SSID                                                     01480000
SSIDFLAG EQU   SUBSYSID                                                 01481000
STATUS   EQU   ISDAMSCS                                                 01482000
CPUID    EQU   CPUSERID+3                                               01483000
CPUSER   EQU   CPUSERID                                                 01484000
VERNO    EQU   OBRMDR+20                                                01485000
TENSHUND EQU   TIME+3                                                   01486000
SECOND   EQU   TIME+2                                                   01487000
MINUTE   EQU   TIME+1                                                   01488000
HOUR     EQU   TIME                                                     01489000
DAY      EQU   DATE+2                                                   01490000
YEAR     EQU   DATE                                                     01491000
RECENTRY EQU   OBRMDR+11                                                01492000
RCDCNT   EQU   OBRMDR+10                                                01493000
SWITCH3  EQU   SWITCHES+3                                               01494000
SWITCH2  EQU   SWITCHES+2                                               01495000
SWITCH1  EQU   SWITCHES+1                                               01496000
SWITCH0  EQU   SWITCHES                                                 01497000
SYSREL   EQU   OBRMDR+5                                                 01498000
CLASRC   EQU   OBRMDR+4                                                 01499000
@NM00003 EQU   SCW+3                                                    01500000
SCODE    EQU   SCW+2                                                    01501000
SLENGTH  EQU   SCW                                                      01502000
PRTSA001 EQU   PRTDATD                                                  01503000
SDATEMPS EQU   SDADATD+136                                              01504000
SDASA002 EQU   SDADATD+76                                               01505000
SDAPC001 EQU   SDADATD+72                                               01506000
SDASA001 EQU   SDADATD                                                  01507000
SDARPTID EQU   PRT0CALL+133                                             01508000
DUMPIDNO EQU   HEXPCALL+8                                               01509000
DUMPLEN  EQU   HEXPCALL+4                                               01510000
DUMPADDR EQU   HEXPCALL                                                 01511000
WORKCALL EQU   CVTPTRS0+96                                              01512000
GEN00PTR EQU   CVTPTRS0+92                                              01513000
CNFG0PTR EQU   CVTPTRS0+88                                              01514000
PWR00PTR EQU   CVTPTRS0+84                                              01515000
APR00PTR EQU   CVTPTRS0+80                                              01516000
DRC00PTR EQU   CVTPTRS0+76                                              01517000
DAT00PTR EQU   CVTPTRS0+72                                              01518000
CSB00PTR EQU   CVTPTRS0+68                                              01519000
DCK00PTR EQU   CVTPTRS0+64                                              01520000
EQC00PTR EQU   CVTPTRS0+60                                              01521000
FSC00PTR EQU   CVTPTRS0+56                                              01522000
SUM00PTR EQU   CVTPTRS0+48                                              01523000
PAD00PTR EQU   CVTPTRS0+44                                              01524000
DCS00PTR EQU   CVTPTRS0+40                                              01525000
LOG00PTR EQU   CVTPTRS0+36                                              01526000
HIST0PTR EQU   CVTPTRS0+32                                              01527000
PRT00PTR EQU   CVTPTRS0+28                                              01528000
GET00PTR EQU   CVTPTRS0+24                                              01529000
TYPE0PTR EQU   CVTPTRS0+20                                              01530000
PARM0PTR EQU   CVTPTRS0+16                                              01531000
SDA00PTR EQU   CVTPTRS0+12                                              01532000
CTRACE   EQU   ISDAPRMS+48                                              01533000
CGEN     EQU   ISDAPRMS+47                                              01534000
CDETAIL  EQU   ISDAPRMS+46                                              01535000
CPERIOD  EQU   ISDAPRMS+45                                              01536000
CPWR     EQU   CREPORTS+11                                              01537000
CAPRSUU  EQU   CREPORTS+10                                              01538000
CDRC     EQU   CREPORTS+9                                               01539000
CDAT     EQU   CREPORTS+8                                               01540000
CCSBCSF  EQU   CREPORTS+7                                               01541000
CDCKTLX  EQU   CREPORTS+6                                               01542000
CEQC     EQU   CREPORTS+5                                               01543000
CFSC     EQU   CREPORTS+4                                               01544000
CSUM     EQU   CREPORTS+2                                               01545000
CPAD     EQU   CREPORTS+1                                               01546000
CDCS     EQU   CREPORTS                                                 01547000
CSERNO   EQU   CSERIAL+4                                                01548000
@NM00002 EQU   CSERIAL+3                                                01549000
CIBM     EQU   CSERIAL                                                  01550000
CRATIO   EQU   ISDAPRMS+19                                              01551000
CSSID    EQU   CSSIDF                                                   01552000
@NM00001 EQU   CSSIDF                                                   01553000
CFSC34   EQU   CFSCONLY+2                                               01554000
CFSC12   EQU   CFSCONLY                                                 01555000
CTYPE    EQU   ISDAPRMS+11                                              01556000
CSUMMARY EQU   ISDAPRMS+10                                              01557000
CENDDAY  EQU   CEND+2                                                   01558000
CENDYEAR EQU   CEND                                                     01559000
CSTDAY   EQU   CSTART+2                                                 01560000
CSTYEAR  EQU   CSTART                                                   01561000
CHISTIN  EQU   CINPUT+1                                                 01562000
CLOGIN   EQU   CINPUT                                                   01563000
*                                      END UNREFERENCED COMPONENTS      01564000
@RF00108 EQU   @RC00101                                                 01565000
@RF00116 EQU   @RC00113                                                 01566000
@RC00127 EQU   @RC00125                                                 01567000
@RC00267 EQU   @RC00259                                                 01568000
@RC00135 EQU   @RC00127                                                 01569000
@ENDDATA EQU   *                                                        01570000
         END   ISDADHE0,(C'PLS1754',0701,78044)                         01571000
