         TITLE 'PRINT REPORTS DHE AND DHU SDA                          *00001000
                        '                                               00002000
ISDADHE1 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(16)                                             0001 00007000
         DC    C'ISDADHE1  78.044'                                 0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @11,0                                               0001 00011000
@PSTART  LA    @12,4095(,@11)                                      0001 00012000
         USING @PSTART,@11                                         0001 00013000
         USING @PSTART+4095,@12                                    0001 00014000
         L     @00,@SIZDATD                                        0001 00015000
         ISDAGSPC R,LV=(0)                                              00016000
         LR    @10,@01                                             0001 00017000
         USING @DATD,@10                                           0001 00018000
         ST    @13,@SA00001+4                                      0001 00019000
         LM    @00,@01,20(@13)                                     0001 00020000
         ST    @10,8(,@13)                                         0001 00021000
         LR    @13,@10                                             0001 00022000
         MVC   @PC00001(4),0(@01)                                  0001 00023000
*                                                                  0039 00024000
*/* HOUSEKEEPING                                             @Y30LB54*/ 00025000
*                                                                  0039 00026000
*   CVTPTR=WORKPTR;                 /*                       @Y30LB54*/ 00027000
         L     @05,@PC00001                                        0039 00028000
         L     CVTPTR,WORKPTR(,@05)                                0039 00029000
*   DHEWKPTR=DHE00PTR;              /* SET LOCAL PTR TO WORK @ZM30983*/ 00030000
         L     DHEWKPTR,DHE00PTR(,CVTPTR)                          0040 00031000
*   LPARMPTR=PARMPTR;               /* BASE FOR PARMS        @Y30LB54*/ 00032000
         L     LPARMPTR,PARMPTR(,CVTPTR)                           0041 00033000
*   RETCODE=0;                      /*                       @Y30LB54*/ 00034000
         SLR   RETCODE,RETCODE                                     0042 00035000
*                                                                  0043 00036000
*   /*****************************************************************/ 00037000
*   /*                                                               */ 00038000
*   /* DHU MAIN PROCESSOR                                            */ 00039000
*   /*                                                               */ 00040000
*   /*****************************************************************/ 00041000
*                                                                  0043 00042000
*   RETCODE1=0;                     /* INIT DHU RETURN CODE  @ZM30730*/ 00043000
         SLR   RETCODE1,RETCODE1                                   0043 00044000
*   IF COUNTRP4^=0 THEN                                            0044 00045000
         ICM   @05,15,COUNTRP4(DHEWKPTR)                           0044 00046000
         BZ    @RF00044                                            0044 00047000
*     DO;                           /*                       @Y30LB54*/ 00048000
*       DO LIBCTR=1 TO 4 BY 1;      /* PROCESS 4 LIBRARIES   @Y30LB54*/ 00049000
         LA    @05,1                                               0046 00050000
         ST    @05,LIBCTR(,DHEWKPTR)                               0046 00051000
@DL00046 DS    0H                                                  0047 00052000
*         IF LIBPTR(LIBCTR)^=0 THEN /* NO REPORT NEEDED FOR THIS CS     00053000
*                                                            @Y30LB54*/ 00054000
         L     @05,LIBCTR(,DHEWKPTR)                               0047 00055000
         SLA   @05,2                                               0047 00056000
         L     @05,LIBPTR-5(@05,DHEWKPTR)                          0047 00057000
         LA    @05,0(,@05)                                         0047 00058000
         LTR   @05,@05                                             0047 00059000
         BZ    @RF00047                                            0047 00060000
*           DO;                     /*                       @Y30LB54*/ 00061000
*             PTRRPT=0;             /* REPORT OFFSET INTO COUNTERS 0049 00062000
*                                                            @Y30LB54*/ 00063000
         SLR   @15,@15                                             0049 00064000
         ST    @15,PTRRPT(,DHEWKPTR)                               0049 00065000
*             KICKPTR=LIBPTR(LIBCTR)+PTRRPT;/* POINT COUNTER BASE TO    00066000
*                                      COUNTERS              @Y30LB54*/ 00067000
         ALR   @05,@15                                             0050 00068000
         ST    @05,KICKPTR(,DHEWKPTR)                              0050 00069000
*             CALL RPT4HDR;         /* GET HEADER PORTION OF THIS  0051 00070000
*                                      REPORT                @Y30LB54*/ 00071000
         BAL   @14,RPT4HDR                                         0051 00072000
*             CALL RPT4CALC;        /* CALCULATE RATIO TABLE @Y30LB54*/ 00073000
         BAL   @14,RPT4CALC                                        0052 00074000
*/*  PRODUCE STATISTICS AND GRAPH PORTION OF REPORT          @Y30LB54*/ 00075000
*                                                                  0053 00076000
*             CALL RATSORT;         /* SORT THE RATIO TABLE  @Y30LB54*/ 00077000
         BAL   @14,RATSORT                                         0053 00078000
*             CALL RPT4BODY;        /* PRINT BODY OF DHU     @Y30LB54*/ 00079000
         BAL   @14,RPT4BODY                                        0054 00080000
*             CALL RPT4ABST;        /* PRINT ABSTRACT OF DHU @Y30LB54*/ 00081000
         BAL   @14,RPT4ABST                                        0055 00082000
*/*PRODUCE 4 DAY TREND PORTION OF REPORT                     @Y30LB54*/ 00083000
*                                                                  0056 00084000
*             PTRRPT=192;           /* OFFSET TO 4 DAY TREND PORTION    00085000
*                                      OF COUNTERS           @Y30LB54*/ 00086000
         LA    @05,192                                             0056 00087000
         ST    @05,PTRRPT(,DHEWKPTR)                               0056 00088000
*             KICKPTR=LIBPTR(LIBCTR)+PTRRPT;/* COUNTER BASE FOR THIS    00089000
*                                      REPORT                @Y30LB54*/ 00090000
         L     @15,LIBCTR(,DHEWKPTR)                               0057 00091000
         SLA   @15,2                                               0057 00092000
         L     @15,LIBPTR-5(@15,DHEWKPTR)                          0057 00093000
         LA    @15,0(,@15)                                         0057 00094000
         ALR   @05,@15                                             0057 00095000
         ST    @05,KICKPTR(,DHEWKPTR)                              0057 00096000
*             CALL RPT4AHDR;        /* PRINT FOUR DAY TREND HDR    0058 00097000
*                                                            @Y30LB54*/ 00098000
         BAL   @14,RPT4AHDR                                        0058 00099000
*             CALL RPT4ABDY;        /* PRINT FOUR DAY BODY   @Y30LB54*/ 00100000
         BAL   @14,RPT4ABDY                                        0059 00101000
*           END;                    /*                       @Y30LB54*/ 00102000
*         ELSE                                                     0061 00103000
*           ;                       /*                       @Y30LB54*/ 00104000
@RF00047 DS    0H                                                  0062 00105000
*       END;                        /*                       @Y30LB54*/ 00106000
         LA    @05,1                                               0062 00107000
         AL    @05,LIBCTR(,DHEWKPTR)                               0062 00108000
         ST    @05,LIBCTR(,DHEWKPTR)                               0062 00109000
         CH    @05,@CH00051                                        0062 00110000
         BNH   @DL00046                                            0062 00111000
*     END;                          /*                       @Y30LB54*/ 00112000
*   ELSE                                                           0064 00113000
*     IF CDHEDHU(7)='1'B THEN       /* WAS DHU REQUESTED     @ZM30730*/ 00114000
         B     @RC00044                                            0064 00115000
@RF00044 TM    CDHEDHU(LPARMPTR),B'00000010'                       0064 00116000
         BNO   @RF00064                                            0064 00117000
*       RETCODE=12;                 /* NO DHU ACCUMULATOR FILLED   0065 00118000
*                                                            @Y30LB54*/ 00119000
         LA    RETCODE,12                                          0065 00120000
*     ELSE;                         /* NO, NO RETURN CODE    @ZM30730*/ 00121000
@RF00064 DS    0H                                                  0067 00122000
*                                                                  0067 00123000
*   /*****************************************************************/ 00124000
*   /*                                                               */ 00125000
*   /* DHE MAIN PROCESSOR                                            */ 00126000
*   /*                                                               */ 00127000
*   /*****************************************************************/ 00128000
*                                                                  0067 00129000
*   RETCODE2=0;                     /* INIT DHE RETURN CODE  @ZM30730*/ 00130000
@RC00044 SLR   RETCODE2,RETCODE2                                   0067 00131000
*   IF COUNTRP5^=0 THEN                                            0068 00132000
         ICM   @15,15,COUNTRP5(DHEWKPTR)                           0068 00133000
         BZ    @RF00068                                            0068 00134000
*     DO;                           /*                       @Y30LB54*/ 00135000
*       CALL RPT5HDR;               /* PRINT DHE HEADER      @Y30LB54*/ 00136000
         BAL   @14,RPT5HDR                                         0070 00137000
*       CALL RECSORT;               /* SORT THE DHE RECORDS  @Y30LB54*/ 00138000
         BAL   @14,RECSORT                                         0071 00139000
*       CALL RPT5BDY;               /* PRINT DHE BODY        @Y30LB54*/ 00140000
         BAL   @14,RPT5BDY                                         0072 00141000
*     END;                          /*                       @Y30LB54*/ 00142000
*   ELSE                                                           0074 00143000
*     IF CDHEDHU(8)='1'B THEN       /* WAS DHE REQUESTED     @ZM30730*/ 00144000
         B     @RC00068                                            0074 00145000
@RF00068 TM    CDHEDHU(LPARMPTR),B'00000001'                       0074 00146000
         BNO   @RF00074                                            0074 00147000
*       RETCODE2=16;                /* NO DHE ACCUMULATORS FILLED  0075 00148000
*                                                            @Y30LB54*/ 00149000
         LA    RETCODE2,16                                         0075 00150000
*     ELSE;                         /* NO, NO RETURN CODE    @ZM30730*/ 00151000
*                                                                  0076 00152000
@RF00074 DS    0H                                                  0077 00153000
*   /*****************************************************************/ 00154000
*   /*                                                               */ 00155000
*   /* ALL REPORTS PRODUCED AT THIS POINT                            */ 00156000
*   /*                                                               */ 00157000
*   /*****************************************************************/ 00158000
*                                                                  0077 00159000
*   IF RETCODE=0 THEN               /* WAS RETCODE SET       @ZM30730*/ 00160000
@RC00068 SLR   @15,@15                                             0077 00161000
         CR    RETCODE,@15                                         0077 00162000
         BNE   @RF00077                                            0077 00163000
*     IF RETCODE1+RETCODE2^=0 THEN  /* NO, CODE 1 OR 2 SET   @ZM30730*/ 00164000
         LR    @14,RETCODE1                                        0078 00165000
         ALR   @14,RETCODE2                                        0078 00166000
         CR    @14,@15                                             0078 00167000
         BE    @RF00078                                            0078 00168000
*       IF CDHEDHU='03'X THEN       /* BOTH DHU, DHE REQUEST @ZM30730*/ 00169000
         CLI   CDHEDHU(LPARMPTR),X'03'                             0079 00170000
         BNE   @RF00079                                            0079 00171000
*         IF RETCODE1+RETCODE2>16 THEN /* NO REPORTS PRINTED @ZM30730*/ 00172000
         CH    @14,@CH00191                                        0080 00173000
         BNH   @RF00080                                            0080 00174000
*           RETCODE=8;              /* SET NO REPORTS CODE   @ZM30730*/ 00175000
         LA    RETCODE,8                                           0081 00176000
*         ELSE                      /* SOME REPORT PRINTED   @ZM30730*/ 00177000
*           RETCODE=RETCODE1+RETCODE2; /* SET CODE 12 OR 16  @ZM30730*/ 00178000
         B     @RC00080                                            0082 00179000
@RF00080 LR    RETCODE,RETCODE1                                    0082 00180000
         ALR   RETCODE,RETCODE2                                    0082 00181000
*       ELSE                        /* BOTH NOT REQUESTED    @ZM30730*/ 00182000
*         RETCODE=8;                /* SET NO REPORTS CODE   @ZM30730*/ 00183000
         B     @RC00079                                            0083 00184000
@RF00079 LA    RETCODE,8                                           0083 00185000
*     ELSE;                         /* NO DHU,DHE CODES      @ZM30730*/ 00186000
@RF00078 DS    0H                                                  0085 00187000
*   ELSE;                           /* RETCODE ALREADY SET   @ZM30730*/ 00188000
@RF00077 DS    0H                                                  0086 00189000
*   CALL FREECORE;                  /* FREE ALL CORE USED    @Y30LB54*/ 00190000
@RC00077 BAL   @14,FREECORE                                        0086 00191000
*   RETURN CODE(RETCODE);           /*                       @Y30LB54*/ 00192000
         L     @13,4(,@13)                                         0087 00193000
         L     @00,@SIZDATD                                        0087 00194000
         LR    @01,@10                                             0087 00195000
         ISDAFSPC R,LV=(0),A=(1)                                        00196000
         LR    @15,@04                                             0087 00197000
         L     @14,12(,@13)                                        0087 00198000
         LM    @00,@12,20(@13)                                     0087 00199000
         BR    @14                                                 0087 00200000
*                                                                  0088 00201000
*   /*****************************************************************/ 00202000
*   /*                                                               */ 00203000
*   /* PRINT HEADER FOR DHU                                          */ 00204000
*   /*                                                               */ 00205000
*   /*****************************************************************/ 00206000
*                                                                  0088 00207000
*RPT4HDR:                                                          0088 00208000
*   PROC  OPTIONS(SAVE(14));        /*                       @Y30LB54*/ 00209000
RPT4HDR  ST    @14,@SA00002                                        0088 00210000
*   LINE=' ';                       /* CLEAR LINE            @Y30LB54*/ 00211000
         MVI   LINE+1(CVTPTR),C' '                                 0089 00212000
         MVC   LINE+2(130,CVTPTR),LINE+1(CVTPTR)                   0089 00213000
         MVI   LINE(CVTPTR),C' '                                   0089 00214000
*   LINE(70:72)='MSF';              /*                       @ZM30730*/ 00215000
         MVC   LINE+69(3,CVTPTR),@CC00308                          0090 00216000
*   LINE(1:59)='REPORT 12 - DATA HANDLING USAGE FOR DRDS - DRD BUFFERED 00217000
*LOG';                              /* DHU REPORT TITLE      @ZM30730*/ 00218000
*                                                                  0091 00219000
         MVC   LINE(59,CVTPTR),@CC00310                            0091 00220000
*   /*****************************************************************/ 00221000
*   /*                                                               */ 00222000
*   /*                                                               */ 00223000
*   /*****************************************************************/ 00224000
*                                                                  0092 00225000
*   LINE(87:126)='(DATA FROM MSS FORMAT 0, MESSAGE CODE 5)';/*     0092 00226000
*                                                            @ZM30730*/ 00227000
         MVC   LINE+86(40,CVTPTR),@CC00317                         0092 00228000
*   ANSI='1';                       /* EJECT TO NEW PAGE     @Y30LB54*/ 00229000
         MVI   ANSI(CVTPTR),C'1'                                   0093 00230000
*   FULLWD1=74;                     /* LOCATION WHERE TO PUT LIBRARY    00231000
*                                      NUMBER                @ZM30730*/ 00232000
         MVC   FULLWD1(4,DHEWKPTR),@CF00320                        0094 00233000
*   CALL CONVTLIB;                  /* INSERT LIBRARY NO IN PRINTABLE   00234000
*                                      FORM                  @Y30LB54*/ 00235000
         BAL   @14,CONVTLIB                                        0095 00236000
*   CALL ISDAPRT0(WORKPTR);         /*                       @Y30LB54*/ 00237000
         L     @05,@PC00001                                        0096 00238000
         ST    @05,@AL00001                                        0096 00239000
         L     @15,@CV00040                                        0096 00240000
         LA    @01,@AL00001                                        0096 00241000
         BALR  @14,@15                                             0096 00242000
*   LINE=' ';                       /* CLEAR PRINT LINE      @Y30LB54*/ 00243000
         MVI   LINE+1(CVTPTR),C' '                                 0097 00244000
         MVC   LINE+2(130,CVTPTR),LINE+1(CVTPTR)                   0097 00245000
         MVI   LINE(CVTPTR),C' '                                   0097 00246000
*   ANSI=' ';                       /* SINGLE SPACE          @Y30LB54*/ 00247000
         MVI   ANSI(CVTPTR),C' '                                   0098 00248000
*   CALL ISDAPRT0(WORKPTR);                                /*@Y30LB54*/ 00249000
         L     @05,@PC00001                                        0099 00250000
         ST    @05,@AL00001                                        0099 00251000
         L     @15,@CV00040                                        0099 00252000
         LA    @01,@AL00001                                        0099 00253000
         BALR  @14,@15                                             0099 00254000
*   LINE(34:41)='DRD SSID';         /*                       @Y30LB54*/ 00255000
         MVC   LINE+33(8,CVTPTR),@CC00324                          0100 00256000
*   CALL ISDAPRT0(WORKPTR);         /*                       @Y30LB54*/ 00257000
         L     @05,@PC00001                                        0101 00258000
         ST    @05,@AL00001                                        0101 00259000
         L     @15,@CV00040                                        0101 00260000
         LA    @01,@AL00001                                        0101 00261000
         BALR  @14,@15                                             0101 00262000
*   LINE=' ';                       /*                       @Y30LB54*/ 00263000
         MVI   LINE+1(CVTPTR),C' '                                 0102 00264000
         MVC   LINE+2(130,CVTPTR),LINE+1(CVTPTR)                   0102 00265000
         MVI   LINE(CVTPTR),C' '                                   0102 00266000
*   LINE(32:112)='|   200   |   201   |   202   |   203   |   204   |   00267000
*205   |   206   |   207   |';      /*                       @Y30LB54*/ 00268000
         MVC   LINE+31(81,CVTPTR),@CC00327                         0103 00269000
*   LINE(115:120)='TOTALS';         /* TOTALS HEADER         @Y30LB54*/ 00270000
         MVC   LINE+114(6,CVTPTR),@CC00335                         0104 00271000
*   DO CTR=37 TO 107 BY 10;         /* INSERT MSF ID IN SSID @Y30LB54*/ 00272000
         LA    @05,37                                              0105 00273000
         ST    @05,CTR(,DHEWKPTR)                                  0105 00274000
@DL00105 DS    0H                                                  0106 00275000
*     LINE(CTR)=HEXREP(FOURBITS);   /*                       @Y30LB54*/ 00276000
         L     @05,CTR(,DHEWKPTR)                                  0106 00277000
         ALR   @05,CVTPTR                                          0106 00278000
         SLR   @01,@01                                             0106 00279000
         IC    @01,FOURBITS(,DHEWKPTR)                             0106 00280000
         LA    @15,HEXREP-1(@01)                                   0106 00281000
         MVC   LINE-1(1,@05),0(@15)                                0106 00282000
*   END;                            /*                       @Y30LB54*/ 00283000
         LA    @05,10                                              0107 00284000
         AL    @05,CTR(,DHEWKPTR)                                  0107 00285000
         ST    @05,CTR(,DHEWKPTR)                                  0107 00286000
         CH    @05,@CH00337                                        0107 00287000
         BNH   @DL00105                                            0107 00288000
*   CALL ISDAPRT0(WORKPTR);         /*                       @Y30LB54*/ 00289000
         L     @05,@PC00001                                        0108 00290000
         ST    @05,@AL00001                                        0108 00291000
         L     @15,@CV00040                                        0108 00292000
         LA    @01,@AL00001                                        0108 00293000
         BALR  @14,@15                                             0108 00294000
*   LINE=' ';                       /* BLANK LINE            @Y30LB54*/ 00295000
         MVI   LINE+1(CVTPTR),C' '                                 0109 00296000
         MVC   LINE+2(130,CVTPTR),LINE+1(CVTPTR)                   0109 00297000
         MVI   LINE(CVTPTR),C' '                                   0109 00298000
*   LINE(32:112)='|---------|---------|---------|---------|---------|-- 00299000
*------|---------|---------|';      /*                       @Y30LB54*/ 00300000
         MVC   LINE+31(81,CVTPTR),@CC00338                         0110 00301000
*   LINE(113:121)='---------';      /* GRAND TOTAL BOX       @Y30LB54*/ 00302000
         MVC   LINE+112(9,CVTPTR),@CC00346                         0111 00303000
*   CALL ISDAPRT0(WORKPTR);         /*                       @Y30LB54*/ 00304000
         L     @05,@PC00001                                        0112 00305000
         ST    @05,@AL00001                                        0112 00306000
         L     @15,@CV00040                                        0112 00307000
         LA    @01,@AL00001                                        0112 00308000
         BALR  @14,@15                                             0112 00309000
*   END RPT4HDR;                    /*                       @Y30LB54*/ 00310000
@EL00002 DS    0H                                                  0113 00311000
@EF00002 DS    0H                                                  0113 00312000
@ER00002 L     @14,@SA00002                                        0113 00313000
         BR    @14                                                 0113 00314000
*                                                                  0114 00315000
*   /*****************************************************************/ 00316000
*   /*                                                               */ 00317000
*   /* CALCULATE DHU RATIOS AND SET DYNAMIC RATIO TABLE              */ 00318000
*   /*                                                               */ 00319000
*   /*****************************************************************/ 00320000
*                                                                  0114 00321000
*RPT4CALC:                                                         0114 00322000
*   PROC  OPTIONS(SAVE(14));        /*                       @Y30LB54*/ 00323000
RPT4CALC ST    @14,@SA00003                                        0114 00324000
*   KICKPTR=LIBPTR(LIBCTR)+PTRRPT;  /* ESTABLISH BASE FOR COUNTERS 0115 00325000
*                                                            @Y30LB54*/ 00326000
         L     @05,LIBCTR(,DHEWKPTR)                               0115 00327000
         SLA   @05,2                                               0115 00328000
         L     @05,LIBPTR-5(@05,DHEWKPTR)                          0115 00329000
         LA    @05,0(,@05)                                         0115 00330000
         AL    @05,PTRRPT(,DHEWKPTR)                               0115 00331000
         ST    @05,KICKPTR(,DHEWKPTR)                              0115 00332000
*   RATCTR=1;                       /* WE WANT TO START AT TOP OF  0116 00333000
*                                      RATIO TABLE           @Y30LB54*/ 00334000
         LA    @05,1                                               0116 00335000
         ST    @05,RATCTR(,DHEWKPTR)                               0116 00336000
*   DO CTR=1 TO 3 BY 1;             /* THREE DIFFERENT TYPES OF    0117 00337000
*                                      COUNTERS              @Y30LB54*/ 00338000
         ST    @05,CTR(,DHEWKPTR)                                  0117 00339000
@DL00117 DS    0H                                                  0118 00340000
*     ANSI=' ';                     /* SINGLE SPACE OUTPUT   @Y30LB54*/ 00341000
         MVI   ANSI(CVTPTR),C' '                                   0118 00342000
*     LINE=BODY1(CTR);              /*                       @Y30LB54*/ 00343000
         MVI   LINE+10(CVTPTR),C' '                                0119 00344000
         MVC   LINE+11(121,CVTPTR),LINE+10(CVTPTR)                 0119 00345000
         L     @05,CTR(,DHEWKPTR)                                  0119 00346000
         MH    @05,@CH00155                                        0119 00347000
         LA    @01,BODY1-10(@05)                                   0119 00348000
         MVC   LINE(10,CVTPTR),0(@01)                              0119 00349000
*     LINE(32:112)='|         |         |         |         |         | 00350000
*        |         |         |';    /*                       @Y30LB54*/ 00351000
         MVC   LINE+31(81,CVTPTR),@CC00351                         0120 00352000
*     LINE(122)='|';                /* GRAND TOTAL BOX       @Y30LB54*/ 00353000
         MVI   LINE+121(CVTPTR),C'|'                               0121 00354000
*     CALL ISDAPRT0(WORKPTR);       /*                       @Y30LB54*/ 00355000
         L     @05,@PC00001                                        0122 00356000
         ST    @05,@AL00001                                        0122 00357000
         L     @15,@CV00040                                        0122 00358000
         LA    @01,@AL00001                                        0122 00359000
         BALR  @14,@15                                             0122 00360000
*     LINE=BODY2(CTR);              /*                       @Y30LB54*/ 00361000
         MVI   LINE+25(CVTPTR),C' '                                0123 00362000
         MVC   LINE+26(106,CVTPTR),LINE+25(CVTPTR)                 0123 00363000
         L     @05,CTR(,DHEWKPTR)                                  0123 00364000
         MH    @05,@CH00172                                        0123 00365000
         LA    @01,BODY2-25(@05)                                   0123 00366000
         MVC   LINE(25,CVTPTR),0(@01)                              0123 00367000
*     LINE(32:112)='|         |         |         |         |         | 00368000
*        |         |         |';    /*                       @Y30LB54*/ 00369000
         MVC   LINE+31(81,CVTPTR),@CC00351                         0124 00370000
*     CALL RPT4FILL;                /*                       @Y30LB54*/ 00371000
         BAL   @14,RPT4FILL                                        0125 00372000
*     CALL ISDAPRT0(WORKPTR);       /*                       @Y30LB54*/ 00373000
         L     @05,@PC00001                                        0126 00374000
         ST    @05,@AL00001                                        0126 00375000
         L     @15,@CV00040                                        0126 00376000
         LA    @01,@AL00001                                        0126 00377000
         BALR  @14,@15                                             0126 00378000
*     LINE=BODY3(CTR);              /*                       @Y30LB54*/ 00379000
         MVI   LINE+20(CVTPTR),C' '                                0127 00380000
         MVC   LINE+21(111,CVTPTR),LINE+20(CVTPTR)                 0127 00381000
         L     @05,CTR(,DHEWKPTR)                                  0127 00382000
         MH    @05,@CH00180                                        0127 00383000
         LA    @01,BODY3-20(@05)                                   0127 00384000
         MVC   LINE(20,CVTPTR),0(@01)                              0127 00385000
*     KICKPTR=KICKPTR+4;            /* DO NEXT SET OF COUNTERS     0128 00386000
*                                                            @Y30LB54*/ 00387000
         LA    @05,4                                               0128 00388000
         AL    @05,KICKPTR(,DHEWKPTR)                              0128 00389000
         ST    @05,KICKPTR(,DHEWKPTR)                              0128 00390000
*     LINE(32:112)='|         |         |         |         |         | 00391000
*        |         |         |';    /*                       @Y30LB54*/ 00392000
         MVC   LINE+31(81,CVTPTR),@CC00351                         0129 00393000
*     CALL RPT4FILL;                /*                       @Y30LB54*/ 00394000
         BAL   @14,RPT4FILL                                        0130 00395000
*     CALL ISDAPRT0(WORKPTR);       /*                       @Y30LB54*/ 00396000
         L     @05,@PC00001                                        0131 00397000
         ST    @05,@AL00001                                        0131 00398000
         L     @15,@CV00040                                        0131 00399000
         LA    @01,@AL00001                                        0131 00400000
         BALR  @14,@15                                             0131 00401000
*     LINE=BODY4(CTR);              /*                       @Y30LB54*/ 00402000
         MVI   LINE+20(CVTPTR),C' '                                0132 00403000
         MVC   LINE+21(111,CVTPTR),LINE+20(CVTPTR)                 0132 00404000
         L     @05,CTR(,DHEWKPTR)                                  0132 00405000
         MH    @05,@CH00180                                        0132 00406000
         LA    @01,BODY4-20(@05)                                   0132 00407000
         MVC   LINE(20,CVTPTR),0(@01)                              0132 00408000
*     LINE(32:112)='|         |         |         |         |         | 00409000
*        |         |         |';    /*                       @Y30LB54*/ 00410000
         MVC   LINE+31(81,CVTPTR),@CC00351                         0133 00411000
*     CALL RATIOFIL;                /* FILL IN THE RATIO AMOUNT    0134 00412000
*                                                            @Y30LB54*/ 00413000
         BAL   @14,RATIOFIL                                        0134 00414000
*     CALL ISDAPRT0(WORKPTR);       /*                       @Y30LB54*/ 00415000
         L     @05,@PC00001                                        0135 00416000
         ST    @05,@AL00001                                        0135 00417000
         L     @15,@CV00040                                        0135 00418000
         LA    @01,@AL00001                                        0135 00419000
         BALR  @14,@15                                             0135 00420000
*     KICKPTR=KICKPTR+4;            /* DO NEXT SET OF COUNTERS     0136 00421000
*                                                            @Y30LB54*/ 00422000
         LA    @05,4                                               0136 00423000
         AL    @05,KICKPTR(,DHEWKPTR)                              0136 00424000
         ST    @05,KICKPTR(,DHEWKPTR)                              0136 00425000
*   END;                            /*                       @Y30LB54*/ 00426000
         LA    @05,1                                               0137 00427000
         AL    @05,CTR(,DHEWKPTR)                                  0137 00428000
         ST    @05,CTR(,DHEWKPTR)                                  0137 00429000
         CH    @05,@CH00068                                        0137 00430000
         BNH   @DL00117                                            0137 00431000
*   LINE='------------------------------------------------------------- 00432000
*-----------------------------------------------------------';     0138 00433000
         MVI   LINE+121(CVTPTR),C' '                               0138 00434000
         MVC   LINE+122(10,CVTPTR),LINE+121(CVTPTR)                0138 00435000
         MVC   LINE(121,CVTPTR),@CC00361                           0138 00436000
*   CALL ISDAPRT0(WORKPTR);         /*                       @Y30LB54*/ 00437000
         L     @05,@PC00001                                        0139 00438000
         ST    @05,@AL00001                                        0139 00439000
         L     @15,@CV00040                                        0139 00440000
         LA    @01,@AL00001                                        0139 00441000
         BALR  @14,@15                                             0139 00442000
*   END RPT4CALC;                   /*                       @Y30LB54*/ 00443000
@EL00003 DS    0H                                                  0140 00444000
@EF00003 DS    0H                                                  0140 00445000
@ER00003 L     @14,@SA00003                                        0140 00446000
         BR    @14                                                 0140 00447000
*                                                                  0141 00448000
*   /*****************************************************************/ 00449000
*   /*                                                               */ 00450000
*   /* FILL IN THE VALUES IN FIRST SECTION OF REPORT                 */ 00451000
*   /*                                                               */ 00452000
*   /*****************************************************************/ 00453000
*                                                                  0141 00454000
*RPT4FILL:                                                         0141 00455000
*   PROC  OPTIONS(SAVE(14));        /*                       @Y30LB54*/ 00456000
RPT4FILL ST    @14,12(,@13)                                        0141 00457000
*   FULLWD1=33;                     /* THIS IS WHERE TO STUFF@Y30LB54   00458000
*                                      COUNTERS              @Y30LB54*/ 00459000
         MVC   FULLWD1(4,DHEWKPTR),@CF00373                        0142 00460000
*   GRANDU=0;                       /* ZERO GRAND TOTAL COUNTERS   0143 00461000
*                                                            @Y30LB54*/ 00462000
         SLR   @05,@05                                             0143 00463000
         ST    @05,GRANDU(,DHEWKPTR)                               0143 00464000
*   GRANDE=0;                       /* ZERO GRAND TOTAL COUNTERS   0144 00465000
*                                                            @Y30LB54*/ 00466000
         ST    @05,GRANDE(,DHEWKPTR)                               0144 00467000
*   DO CTR1=1 TO 43 BY 6;           /* WANT TO STRIP OFF EVERY SIXTH    00468000
*                                      COUNTER               @Y30LB54*/ 00469000
         LA    @05,1                                               0145 00470000
         ST    @05,CTR1(,DHEWKPTR)                                 0145 00471000
@DL00145 DS    0H                                                  0146 00472000
*     EDREC=EDPAT;                  /* MOVE EDIT PATTERN TO WORKING     00473000
*                                      CORE                  @Y30LB54*/ 00474000
         MVC   EDREC(10,DHEWKPTR),EDPAT                            0146 00475000
*     GRANDU=GRANDU+COUNTER(CTR1);  /* ADD TO GRAND TOTALS   @Y30LB54*/ 00476000
         L     @05,CTR1(,DHEWKPTR)                                 0147 00477000
         SLA   @05,2                                               0147 00478000
         L     @01,KICKPTR(,DHEWKPTR)                              0147 00479000
         AL    @01,@CF00538                                        0147 00480000
         L     @05,COUNTER(@05,@01)                                0147 00481000
         L     @15,GRANDU(,DHEWKPTR)                               0147 00482000
         ALR   @15,@05                                             0147 00483000
         ST    @15,GRANDU(,DHEWKPTR)                               0147 00484000
*     CVD(COUNTER(CTR1),CHAR5);     /* CONVERT TO PACKED DEC @Y30LB54*/ 00485000
         CVD   @05,@TS00001                                        0148 00486000
         MVC   CHAR5(5,DHEWKPTR),@TS00001+3                        0148 00487000
*     CHAR5(5)=CHAR5(5)|'0F'X;      /* PROTECT FROM JUNK     @Y30LB54*/ 00488000
         OI    CHAR5+4(DHEWKPTR),X'0F'                             0149 00489000
*     ED(EDREC,CHAR5);              /* CONVERT FIELD TO PRINTABLE  0150 00490000
*                                      CHAR                  @Y30LB54*/ 00491000
         ED    EDREC(10,DHEWKPTR),CHAR5(DHEWKPTR)                  0150 00492000
*     LINE(FULLWD1:FULLWD1+8)=EDREC(2:10);/* RESULT TO PRINT @Y30LB54*/ 00493000
         L     @05,FULLWD1(,DHEWKPTR)                              0151 00494000
         ALR   @05,CVTPTR                                          0151 00495000
         MVC   LINE-1(9,@05),EDREC+1(DHEWKPTR)                     0151 00496000
*     FULLWD1=FULLWD1+10;           /* NEXT COUNTER PRINT POSITION 0152 00497000
*                                                            @Y30LB54*/ 00498000
         L     @05,FULLWD1(,DHEWKPTR)                              0152 00499000
         AH    @05,@CH00155                                        0152 00500000
         ST    @05,FULLWD1(,DHEWKPTR)                              0152 00501000
*   END;                            /*                       @Y30LB54*/ 00502000
         LA    @05,6                                               0153 00503000
         AL    @05,CTR1(,DHEWKPTR)                                 0153 00504000
         ST    @05,CTR1(,DHEWKPTR)                                 0153 00505000
         CH    @05,@CH00374                                        0153 00506000
         BNH   @DL00145                                            0153 00507000
*   EDREC=EDPAT;                    /*                       @Y30LB54*/ 00508000
         MVC   EDREC(10,DHEWKPTR),EDPAT                            0154 00509000
*   CVD(GRANDU,CHAR5);              /* PRINT GRAND TOTALS    @Y30LB54*/ 00510000
         L     @05,GRANDU(,DHEWKPTR)                               0155 00511000
         CVD   @05,@TS00001                                        0155 00512000
         MVC   CHAR5(5,DHEWKPTR),@TS00001+3                        0155 00513000
*   CHAR5(5)=CHAR5(5)|'0F'X;        /* PROTECT FROM JUNK     @Y30LB54*/ 00514000
         OI    CHAR5+4(DHEWKPTR),X'0F'                             0156 00515000
*   ED(EDREC,CHAR5);                /* FORMAT OUTPUT         @Y30LB54*/ 00516000
         ED    EDREC(10,DHEWKPTR),CHAR5(DHEWKPTR)                  0157 00517000
*   LINE(113:121)=EDREC(2:10);      /* PUT IT IN OUTPUT LINE @Y30LB54*/ 00518000
         MVC   LINE+112(9,CVTPTR),EDREC+1(DHEWKPTR)                0158 00519000
*   LINE(122)='|';                  /* MOVE IN OR SIGN       @Y30LB54*/ 00520000
         MVI   LINE+121(CVTPTR),C'|'                               0159 00521000
*   END RPT4FILL;                   /*                       @Y30LB54*/ 00522000
@EL00004 DS    0H                                                  0160 00523000
@EF00004 DS    0H                                                  0160 00524000
@ER00004 L     @14,12(,@13)                                        0160 00525000
         BR    @14                                                 0160 00526000
*                                                                  0161 00527000
*   /*****************************************************************/ 00528000
*   /*                                                               */ 00529000
*   /* COMPUTE THE RATIOS AND FILL IN RATIO TABLE                    */ 00530000
*   /*                                                               */ 00531000
*   /*****************************************************************/ 00532000
*                                                                  0161 00533000
*RATIOFIL:                                                         0161 00534000
*   PROC  OPTIONS(SAVE(14));        /*                       @Y30LB54*/ 00535000
RATIOFIL ST    @14,12(,@13)                                        0161 00536000
*   FULLWD1=33;                     /* TELL IT WHERE THE FIRST PRINT    00537000
*                                      POS IS                @Y30LB54*/ 00538000
         MVC   FULLWD1(4,DHEWKPTR),@CF00373                        0162 00539000
*   GRANDU=0;                       /* ZERO GRAND TOTAL COUNTERS   0163 00540000
*                                                            @Y30LB54*/ 00541000
         SLR   @05,@05                                             0163 00542000
         ST    @05,GRANDU(,DHEWKPTR)                               0163 00543000
*   GRANDE=0;                       /* ZERO GRAND TOTAL COUNTERS   0164 00544000
*                                                            @Y30LB54*/ 00545000
         ST    @05,GRANDE(,DHEWKPTR)                               0164 00546000
*   KICKPTR=KICKPTR-4;              /* SET COUNTER BACK TO ERROR CTR    00547000
*                                                            @Y30LB54*/ 00548000
         L     @05,KICKPTR(,DHEWKPTR)                              0165 00549000
         SH    @05,@CH00051                                        0165 00550000
         ST    @05,KICKPTR(,DHEWKPTR)                              0165 00551000
*   DATASSID=-1;                    /* TELL RATIO TABLE WHICH SSID WE   00552000
*                                      ARE WORKING           @Y30LB54*/ 00553000
         MVC   DATASSID(4,DHEWKPTR),@CF00381                       0166 00554000
*   DO CTR1=1 TO 43 BY 6;           /* EVERY SIXTH COUNTER   @Y30LB54*/ 00555000
         LA    @05,1                                               0167 00556000
         ST    @05,CTR1(,DHEWKPTR)                                 0167 00557000
@DL00167 DS    0H                                                  0168 00558000
*     DATASSID=DATASSID+1;          /* NEW SSID BEING WORKED @Y30LB54*/ 00559000
         LA    @05,1                                               0168 00560000
         AL    @05,DATASSID(,DHEWKPTR)                             0168 00561000
         ST    @05,DATASSID(,DHEWKPTR)                             0168 00562000
*     IF COUNTER(CTR1+1)^=0 THEN                                   0169 00563000
         L     @05,CTR1(,DHEWKPTR)                                 0169 00564000
         SLA   @05,2                                               0169 00565000
         L     @15,KICKPTR(,DHEWKPTR)                              0169 00566000
         L     @14,COUNTER(@05,@15)                                0169 00567000
         LTR   @14,@14                                             0169 00568000
         BZ    @RF00169                                            0169 00569000
*       RATCNT(RATCTR)=(COUNTER(CTR1)*10000)/COUNTER(CTR1+1);      0170 00570000
         L     @09,RATCTR(,DHEWKPTR)                               0170 00571000
         SLA   @09,2                                               0170 00572000
         AL    @15,@CF00538                                        0170 00573000
         L     @05,COUNTER(@05,@15)                                0170 00574000
         MH    @05,@CH00382                                        0170 00575000
         LR    @00,@05                                             0170 00576000
         SRDA  @00,32                                              0170 00577000
         DR    @00,@14                                             0170 00578000
         STH   @01,RATCNT-4(@09,DHEWKPTR)                          0170 00579000
*     ELSE                                                         0171 00580000
*       IF COUNTER(CTR1)^=0 THEN    /* NO USAGE BUT HAVE ERRORS    0171 00581000
*                                                            @Y30LB54*/ 00582000
         B     @RC00169                                            0171 00583000
@RF00169 L     @05,CTR1(,DHEWKPTR)                                 0171 00584000
         SLA   @05,2                                               0171 00585000
         L     @01,KICKPTR(,DHEWKPTR)                              0171 00586000
         AL    @01,@CF00538                                        0171 00587000
         L     @05,COUNTER(@05,@01)                                0171 00588000
         LTR   @05,@05                                             0171 00589000
         BZ    @RF00171                                            0171 00590000
*         RATCNT(RATCTR)=10000;     /* MAKE IT 100 PERCENT ERROR   0172 00591000
*                                                            @Y30LB54*/ 00592000
         L     @05,RATCTR(,DHEWKPTR)                               0172 00593000
         SLA   @05,2                                               0172 00594000
         LH    @15,@CH00382                                        0172 00595000
         STH   @15,RATCNT-4(@05,DHEWKPTR)                          0172 00596000
*       ELSE                                                       0173 00597000
*         RATCNT(RATCTR)=0;         /* NO ERRORS SO ZERO PERCENT   0173 00598000
*                                                            @Y30LB54*/ 00599000
         B     @RC00171                                            0173 00600000
@RF00171 L     @05,RATCTR(,DHEWKPTR)                               0173 00601000
         SLA   @05,2                                               0173 00602000
         SLR   @15,@15                                             0173 00603000
         STH   @15,RATCNT-4(@05,DHEWKPTR)                          0173 00604000
*     CHAR4='00000000'X;            /* CLEAR CHAR4           @Y30LB54*/ 00605000
@RC00171 DS    0H                                                  0174 00606000
@RC00169 MVC   CHAR4(4,DHEWKPTR),@CB00383                          0174 00607000
*     CHAR4(3:4)=RATCNT(RATCTR);    /* PUT IT IN FULL WORD AREA    0175 00608000
*                                                            @Y30LB54*/ 00609000
         L     @05,RATCTR(,DHEWKPTR)                               0175 00610000
         SLA   @05,2                                               0175 00611000
         LH    @15,RATCNT-4(@05,DHEWKPTR)                          0175 00612000
         STH   @15,CHAR4+2(,DHEWKPTR)                              0175 00613000
*     IF CHAR4>10000 THEN           /* CANNOT BE MORE THAN 100     0176 00614000
*                                      PERCENT ERRORS        @Y30LB54*/ 00615000
         LH    @15,@CH00382                                        0176 00616000
         CL    @15,CHAR4(,DHEWKPTR)                                0176 00617000
         BNL   @RF00176                                            0176 00618000
*       RATCNT(RATCTR)=10000;       /* MAKE IT 100 PERCENT ERROR   0177 00619000
*                                                            @Y30LB54*/ 00620000
         STH   @15,RATCNT-4(@05,DHEWKPTR)                          0177 00621000
*     ELSE                                                         0178 00622000
*       ;                                                  /*@Y30LB54*/ 00623000
*                                                                  0178 00624000
@RF00176 DS    0H                                                  0179 00625000
*/*RATIO = ERRORS DIVIDED BY USAGE                           @Y30LB54*/ 00626000
*                                                                  0179 00627000
*     GRANDU=GRANDU+COUNTER(CTR1+1);/* TOTAL THE USES COUNTER@Y30LB54*/ 00628000
         L     @05,CTR1(,DHEWKPTR)                                 0179 00629000
         SLA   @05,2                                               0179 00630000
         L     @15,KICKPTR(,DHEWKPTR)                              0179 00631000
         L     @14,GRANDU(,DHEWKPTR)                               0179 00632000
         AL    @14,COUNTER(@05,@15)                                0179 00633000
         ST    @14,GRANDU(,DHEWKPTR)                               0179 00634000
*     GRANDE=GRANDE+COUNTER(CTR1);  /* TOTAL THE ERROR COUNTER     0180 00635000
*                                                            @Y30LB54*/ 00636000
         L     @14,GRANDE(,DHEWKPTR)                               0180 00637000
         AL    @15,@CF00538                                        0180 00638000
         AL    @14,COUNTER(@05,@15)                                0180 00639000
         ST    @14,GRANDE(,DHEWKPTR)                               0180 00640000
*     RATSSID(RATCTR)=BYTESSID;     /* MOVE IN SSID          @Y30LB54*/ 00641000
         L     @05,RATCTR(,DHEWKPTR)                               0181 00642000
         LR    @15,@05                                             0181 00643000
         SLA   @15,2                                               0181 00644000
         ST    @15,@TF00001                                        0181 00645000
         ALR   @15,DHEWKPTR                                        0181 00646000
         MVC   RATSSID-4(1,@15),BYTESSID(DHEWKPTR)                 0181 00647000
*     RATCODE(RATCTR)=BYTECODE(CTR);/* MOVE IN ID            @Y30LB54*/ 00648000
         L     @15,CTR(,DHEWKPTR)                                  0182 00649000
         SLA   @15,2                                               0182 00650000
         L     @15,BYTECODE-4(@15)                                 0182 00651000
         L     @14,@TF00001                                        0182 00652000
         STC   @15,RATCODE-4(@14,DHEWKPTR)                         0182 00653000
*     EDREC=EDPAT1;                 /* MOVE IN EDIT PATTERN  @Y30LB54*/ 00654000
         MVC   EDREC(10,DHEWKPTR),EDPAT1                           0183 00655000
*     FULLWD2=RATCNT(RATCTR);       /* PUT PERCENTAGE IN FULLWORD  0184 00656000
*                                                            @Y30LB54*/ 00657000
         L     @01,@TF00001                                        0184 00658000
         LH    @15,RATCNT-4(@01,DHEWKPTR)                          0184 00659000
         ST    @15,FULLWD2(,DHEWKPTR)                              0184 00660000
*     CVD(FULLWD2,CHAR5);           /*                       @Y30LB54*/ 00661000
         CVD   @15,@TS00001                                        0185 00662000
         MVC   CHAR5(5,DHEWKPTR),@TS00001+3                        0185 00663000
*     CHAR5(5)=CHAR5(5)|'0F'X;      /* PROTECT FROM JUNK     @Y30LB54*/ 00664000
         OI    CHAR5+4(DHEWKPTR),X'0F'                             0186 00665000
*     ED(EDREC,CHAR5);              /* CONVERT TO PRINTABLE DATA   0187 00666000
*                                                            @Y30LB54*/ 00667000
         ED    EDREC(10,DHEWKPTR),CHAR5(DHEWKPTR)                  0187 00668000
*     LINE(FULLWD1+4:FULLWD1+8)=EDREC(6:10);/* RESULT TO PRINT BUFFER   00669000
*                                                            @Y30LB54*/ 00670000
         L     @15,FULLWD1(,DHEWKPTR)                              0188 00671000
         ALR   @15,CVTPTR                                          0188 00672000
         MVC   LINE+3(5,@15),EDREC+5(DHEWKPTR)                     0188 00673000
*     FULLWD1=FULLWD1+10;           /*                       @Y30LB54*/ 00674000
         L     @15,FULLWD1(,DHEWKPTR)                              0189 00675000
         AH    @15,@CH00155                                        0189 00676000
         ST    @15,FULLWD1(,DHEWKPTR)                              0189 00677000
*     RATCTR=RATCTR+1;              /* MOVE ON TO NEXT TABLE ENTRY 0190 00678000
*                                                            @Y30LB54*/ 00679000
         AH    @05,@CH00048                                        0190 00680000
         ST    @05,RATCTR(,DHEWKPTR)                               0190 00681000
*   END;                            /*                       @Y30LB54*/ 00682000
         LA    @05,6                                               0191 00683000
         AL    @05,CTR1(,DHEWKPTR)                                 0191 00684000
         ST    @05,CTR1(,DHEWKPTR)                                 0191 00685000
         CH    @05,@CH00374                                        0191 00686000
         BNH   @DL00167                                            0191 00687000
*   IF GRANDU^=0 THEN                                              0192 00688000
         L     @05,GRANDU(,DHEWKPTR)                               0192 00689000
         LTR   @05,@05                                             0192 00690000
         BZ    @RF00192                                            0192 00691000
*     FULLWD2=(GRANDE*10000)/GRANDU;/* COMPUTE RATIO         @Y30LB54*/ 00692000
         L     @15,GRANDE(,DHEWKPTR)                               0193 00693000
         MH    @15,@CH00382                                        0193 00694000
         LR    @00,@15                                             0193 00695000
         SRDA  @00,32                                              0193 00696000
         DR    @00,@05                                             0193 00697000
         ST    @01,FULLWD2(,DHEWKPTR)                              0193 00698000
*   ELSE                                                           0194 00699000
*     IF GRANDE^=0 THEN             /* NO USAGE BUT HAVE ERRORS    0194 00700000
*                                                            @Y30LB54*/ 00701000
         B     @RC00192                                            0194 00702000
@RF00192 ICM   @05,15,GRANDE(DHEWKPTR)                             0194 00703000
         BZ    @RF00194                                            0194 00704000
*       FULLWD2=10000;              /* MAKE IT 100 PERCENT   @Y30LB54*/ 00705000
         MVC   FULLWD2(4,DHEWKPTR),@CF00382                        0195 00706000
*     ELSE                                                         0196 00707000
*       FULLWD2=0;                  /* ZERO RATIO            @Y30LB54*/ 00708000
         B     @RC00194                                            0196 00709000
@RF00194 SLR   @05,@05                                             0196 00710000
         ST    @05,FULLWD2(,DHEWKPTR)                              0196 00711000
*   IF FULLWD2>10000 THEN           /* CANNOT BE MORE THAN 100     0197 00712000
*                                      PERCENT ERRORS        @Y30LB54*/ 00713000
@RC00194 DS    0H                                                  0197 00714000
@RC00192 LH    @05,@CH00382                                        0197 00715000
         C     @05,FULLWD2(,DHEWKPTR)                              0197 00716000
         BNL   @RF00197                                            0197 00717000
*     FULLWD2=10000;                /* MAKE IT 100 PERCENT ERROR   0198 00718000
*                                                            @Y30LB54*/ 00719000
         ST    @05,FULLWD2(,DHEWKPTR)                              0198 00720000
*   ELSE                                                           0199 00721000
*     ;                                                    /*@Y30LB54*/ 00722000
@RF00197 DS    0H                                                  0200 00723000
*   EDREC=EDPAT1;                   /* MOVE IN EDIT PATTERN  @Y30LB54*/ 00724000
         MVC   EDREC(10,DHEWKPTR),EDPAT1                           0200 00725000
*   CVD(FULLWD2,CHAR5);             /* PACK IT               @Y30LB54*/ 00726000
         L     @05,FULLWD2(,DHEWKPTR)                              0201 00727000
         CVD   @05,@TS00001                                        0201 00728000
         MVC   CHAR5(5,DHEWKPTR),@TS00001+3                        0201 00729000
*   CHAR5(5)=CHAR5(5)|'0F'X;        /* PROTECT FROM JUNK     @Y30LB54*/ 00730000
         OI    CHAR5+4(DHEWKPTR),X'0F'                             0202 00731000
*   ED(EDREC,CHAR5);                /* CONVERT IT TO PRINTABLE CHAR     00732000
*                                                            @Y30LB54*/ 00733000
         ED    EDREC(10,DHEWKPTR),CHAR5(DHEWKPTR)                  0203 00734000
*   LINE(117:121)=EDREC(6:10);      /* MOVE TO OUTPUT BUFFER @Y30LB54*/ 00735000
         MVC   LINE+116(5,CVTPTR),EDREC+5(DHEWKPTR)                0204 00736000
*   LINE(122)='|';                  /* MOVE IN OR SIGN       @Y30LB54*/ 00737000
         MVI   LINE+121(CVTPTR),C'|'                               0205 00738000
*   KICKPTR=KICKPTR+4;              /* RESET COUNTER PTR BACK TO   0206 00739000
*                                      ORIGIONAL SPOT        @Y30LB54*/ 00740000
         LA    @05,4                                               0206 00741000
         AL    @05,KICKPTR(,DHEWKPTR)                              0206 00742000
         ST    @05,KICKPTR(,DHEWKPTR)                              0206 00743000
*   END RATIOFIL;                   /*                       @Y30LB54*/ 00744000
@EL00005 DS    0H                                                  0207 00745000
@EF00005 DS    0H                                                  0207 00746000
@ER00005 L     @14,12(,@13)                                        0207 00747000
         BR    @14                                                 0207 00748000
*                                                                  0208 00749000
*   /*****************************************************************/ 00750000
*   /*                                                               */ 00751000
*   /* PRINT BODY OF DHU                                             */ 00752000
*   /*                                                               */ 00753000
*   /*****************************************************************/ 00754000
*                                                                  0208 00755000
*RPT4BODY:                                                         0208 00756000
*   PROC  OPTIONS(SAVE(14));        /*                       @Y30LB54*/ 00757000
RPT4BODY ST    @14,@SA00006                                        0208 00758000
*   ANSI=' ';                       /*                       @Y30LB54*/ 00759000
         MVI   ANSI(CVTPTR),C' '                                   0209 00760000
*   LINE='     ERROR USAGE RATIO';  /*                       @Y30LB54*/ 00761000
         MVI   LINE+22(CVTPTR),C' '                                0210 00762000
         MVC   LINE+23(109,CVTPTR),LINE+22(CVTPTR)                 0210 00763000
         MVC   LINE(22,CVTPTR),@CC00388                            0210 00764000
*   LINE(32:112)='|         |         |         |         |         |   00765000
*      |         |         |';      /*                       @Y30LB54*/ 00766000
         MVC   LINE+31(81,CVTPTR),@CC00351                         0211 00767000
*   CALL ISDAPRT0(WORKPTR);         /*                       @Y30LB54*/ 00768000
         L     @05,@PC00001                                        0212 00769000
         ST    @05,@AL00001                                        0212 00770000
         L     @15,@CV00040                                        0212 00771000
         LA    @01,@AL00001                                        0212 00772000
         BALR  @14,@15                                             0212 00773000
*   FULLWD1=RATCNT(1)-RATCNT(24);   /* HIGHEST-LOWEST RATIO =@Y30LB54   00774000
*                                      DIFFERENCE            @Y30LB54*/ 00775000
         LH    @05,RATCNT(,DHEWKPTR)                               0213 00776000
         SH    @05,RATCNT+92(,DHEWKPTR)                            0213 00777000
         ST    @05,FULLWD1(,DHEWKPTR)                              0213 00778000
*   IF FULLWD1^=0 THEN                                             0214 00779000
         LTR   @05,@05                                             0214 00780000
         BZ    @RF00214                                            0214 00781000
*     FULLWD2=FULLWD1/20;           /* SPREAD REPORT OVER 21 LINES 0215 00782000
*                                                            @Y30LB54*/ 00783000
         LR    @00,@05                                             0215 00784000
         SRDA  @00,32                                              0215 00785000
         D     @00,@CF00180                                        0215 00786000
         ST    @01,FULLWD2(,DHEWKPTR)                              0215 00787000
*   ELSE                                                           0216 00788000
*     FULLWD2=1;                    /* MAKE 20 LINES INCREMENT BY 01    00789000
*                                                            @Y30LB54*/ 00790000
         B     @RC00214                                            0216 00791000
@RF00214 MVC   FULLWD2(4,DHEWKPTR),@CF00048                        0216 00792000
*   IF FULLWD2<1 THEN               /* RESULT OF DIVIDE MADE IT ZERO    00793000
*                                      WITH CARRY            @Y30LB54*/ 00794000
@RC00214 LA    @05,1                                               0217 00795000
         C     @05,FULLWD2(,DHEWKPTR)                              0217 00796000
         BNH   @RF00217                                            0217 00797000
*     FULLWD2=1;                    /* MAKE IT MOVE BY AT LEAST .001    00798000
*                                                            @Y30LB54*/ 00799000
         ST    @05,FULLWD2(,DHEWKPTR)                              0218 00800000
*   ELSE                                                           0219 00801000
*     ;                             /*                       @Y30LB54*/ 00802000
@RF00217 DS    0H                                                  0220 00803000
*   FULLWD1=RATCNT(1);              /* START REPORT WITH HIGHEST   0220 00804000
*                                      RATIO                 @Y30LB54*/ 00805000
         LH    @05,RATCNT(,DHEWKPTR)                               0220 00806000
         ST    @05,FULLWD1(,DHEWKPTR)                              0220 00807000
*   RATCTR=1;                       /* COUNTER TO STEP THRU 24 RATIOS   00808000
*                                                            @Y30LB54*/ 00809000
*                                                                  0221 00810000
         MVC   RATCTR(4,DHEWKPTR),@CF00048                         0221 00811000
*   /*****************************************************************/ 00812000
*   /*                                                               */ 00813000
*   /* PRODUCE LINES OF OUTPUT                                       */ 00814000
*   /*                                                               */ 00815000
*   /*****************************************************************/ 00816000
*                                                                  0222 00817000
*   DO CTR=RATCNT(1) TO(RATCNT(24)-FULLWD2) BY-FULLWD2;/*    @Y30LB54*/ 00818000
         B     @DE00222                                            0222 00819000
@DL00222 DS    0H                                                  0223 00820000
*     EDREC=EDPAT1;                 /* MOVE EDIT PATTERN INTO@Y30LB54   00821000
*                                      RECEIVER              @Y30LB54*/ 00822000
         MVC   EDREC(10,DHEWKPTR),EDPAT1                           0223 00823000
*     CVD(FULLWD1,CHAR5);           /* MAKE IT PACKED DECIMAL@Y30LB54*/ 00824000
         L     @05,FULLWD1(,DHEWKPTR)                              0224 00825000
         CVD   @05,@TS00001                                        0224 00826000
         MVC   CHAR5(5,DHEWKPTR),@TS00001+3                        0224 00827000
*     CHAR5(5)=CHAR5(5)|'0F'X;      /* PROTECT FROM JUNK     @Y30LB54*/ 00828000
         OI    CHAR5+4(DHEWKPTR),X'0F'                             0225 00829000
*     ED(EDREC,CHAR5);              /* MAKE IT READABLE      @Y30LB54*/ 00830000
         ED    EDREC(10,DHEWKPTR),CHAR5(DHEWKPTR)                  0226 00831000
*     LINE=' ';                     /* BLANK OUT PRINT LINE  @Y30LB54*/ 00832000
         MVI   LINE+1(CVTPTR),C' '                                 0227 00833000
         MVC   LINE+2(130,CVTPTR),LINE+1(CVTPTR)                   0227 00834000
         MVI   LINE(CVTPTR),C' '                                   0227 00835000
*     LINE(24:28)=EDREC(6:10);      /* MOVE RATIO TO PRINT LINE    0228 00836000
*                                                            @Y30LB54*/ 00837000
         MVC   LINE+23(5,CVTPTR),EDREC+5(DHEWKPTR)                 0228 00838000
*     LINE(32:112)='|         |         |         |         |         | 00839000
*        |         |         |         |';/*                 @Y30LB54*/ 00840000
         MVC   LINE+31(81,CVTPTR),@CC00391                         0229 00841000
*     PTRDATE=25-RATCTR;            /* WANT TO DO 24 ENTRIES IN RATIO   00842000
*                                      TABLE                 @Y30LB54*/ 00843000
         LA    @05,25                                              0230 00844000
         SL    @05,RATCTR(,DHEWKPTR)                               0230 00845000
         ST    @05,PTRDATE(,DHEWKPTR)                              0230 00846000
*/*THE FIRST TIME AND ONE LESS EACH TIME THEREAFTER          @Y30LB54*/ 00847000
*                                                                  0231 00848000
*     /***************************************************************/ 00849000
*     /*                                                             */ 00850000
*     /* FILL IN ONE LINE OF OUTPUT IF WE HAVE A HIT                 */ 00851000
*     /*                                                             */ 00852000
*     /***************************************************************/ 00853000
*                                                                  0231 00854000
*     DO CTR1=1 TO PTRDATE BY 1;    /*                       @Y30LB54*/ 00855000
         LA    @05,1                                               0231 00856000
         ST    @05,CTR1(,DHEWKPTR)                                 0231 00857000
         B     @DE00231                                            0231 00858000
@DL00231 DS    0H                                                  0232 00859000
*       IF RATCNT(RATCTR)=FULLWD1|RATCNT(RATCTR)>FULLWD1 THEN      0232 00860000
         L     @05,RATCTR(,DHEWKPTR)                               0232 00861000
         SLA   @05,2                                               0232 00862000
         LH    @05,RATCNT-4(@05,DHEWKPTR)                          0232 00863000
         L     @15,FULLWD1(,DHEWKPTR)                              0232 00864000
         CR    @05,@15                                             0232 00865000
         BE    @RT00232                                            0232 00866000
         CR    @05,@15                                             0232 00867000
         BNH   @RF00232                                            0232 00868000
@RT00232 DS    0H                                                  0233 00869000
*         DO;                       /* THIS GUY BELONGS ON THIS LINE    00870000
*                                                            @Y30LB54*/ 00871000
*           COUNTRP4=(RATSSID(RATCTR)*10)+33;/* COMPUTE PRINT OFFSET    00872000
*                                                            @Y30LB54*/ 00873000
         L     @05,RATCTR(,DHEWKPTR)                               0234 00874000
         SLA   @05,2                                               0234 00875000
         SLR   @15,@15                                             0234 00876000
         IC    @15,RATSSID-4(@05,DHEWKPTR)                         0234 00877000
         MH    @15,@CH00155                                        0234 00878000
         AL    @15,@CF00373                                        0234 00879000
         ST    @15,COUNTRP4(,DHEWKPTR)                             0234 00880000
*           IF RATCODE(RATCTR)='R' THEN                            0235 00881000
         ALR   @05,DHEWKPTR                                        0235 00882000
         CLI   RATCODE-4(@05),C'R'                                 0235 00883000
         BE    @RT00235                                            0235 00884000
*             ;                     /*                       @Y30LB54*/ 00885000
*/*  OFFSET IS OK FOR R                                      @Y30LB54*/ 00886000
*                                                                  0237 00887000
*           ELSE                                                   0237 00888000
*             IF RATCODE(RATCTR)='W' THEN                          0237 00889000
         L     @05,RATCTR(,DHEWKPTR)                               0237 00890000
         SLA   @05,2                                               0237 00891000
         ALR   @05,DHEWKPTR                                        0237 00892000
         CLI   RATCODE-4(@05),C'W'                                 0237 00893000
         BNE   @RF00237                                            0237 00894000
*               COUNTRP4=COUNTRP4+3;/* DONT WANT W TO OVERLAY R OR L    00895000
*                                                            @Y30LB54*/ 00896000
         LA    @05,3                                               0238 00897000
         AL    @05,COUNTRP4(,DHEWKPTR)                             0238 00898000
         ST    @05,COUNTRP4(,DHEWKPTR)                             0238 00899000
*             ELSE                                                 0239 00900000
*               IF RATCODE(RATCTR)='L' THEN                        0239 00901000
         B     @RC00237                                            0239 00902000
@RF00237 L     @05,RATCTR(,DHEWKPTR)                               0239 00903000
         SLA   @05,2                                               0239 00904000
         ALR   @05,DHEWKPTR                                        0239 00905000
         CLI   RATCODE-4(@05),C'L'                                 0239 00906000
         BNE   @RF00239                                            0239 00907000
*                 COUNTRP4=COUNTRP4+6;/* DONT WANT L TO OVERLAY W OR    00908000
*                                      R                     @Y30LB54*/ 00909000
         LA    @05,6                                               0240 00910000
         AL    @05,COUNTRP4(,DHEWKPTR)                             0240 00911000
         ST    @05,COUNTRP4(,DHEWKPTR)                             0240 00912000
*               ELSE                                               0241 00913000
*                 DO;               /*                       @Y30LB54*/ 00914000
         B     @RC00239                                            0241 00915000
@RF00239 DS    0H                                                  0242 00916000
*                   RETCODE=20;     /* BAD LOGIC ERROR       @Y30LB54*/ 00917000
         LA    RETCODE,20                                          0242 00918000
*                   RETURN CODE(RETCODE);/*                  @Y30LB54*/ 00919000
         LR    @15,RETCODE                                         0243 00920000
@EL00006 DS    0H                                                  0243 00921000
@EF00006 DS    0H                                                  0243 00922000
@ER00006 L     @14,@SA00006                                        0243 00923000
         BR    @14                                                 0243 00924000
*                 END;              /*                       @Y30LB54*/ 00925000
*           LINE(COUNTRP4)=RATCODE(RATCTR);/*                @Y30LB54*/ 00926000
@RC00239 DS    0H                                                  0245 00927000
@RC00237 DS    0H                                                  0245 00928000
@RT00235 L     @05,COUNTRP4(,DHEWKPTR)                             0245 00929000
         ALR   @05,CVTPTR                                          0245 00930000
         L     @15,RATCTR(,DHEWKPTR)                               0245 00931000
         LR    @14,@15                                             0245 00932000
         SLA   @14,2                                               0245 00933000
         ALR   @14,DHEWKPTR                                        0245 00934000
         MVC   LINE-1(1,@05),RATCODE-4(@14)                        0245 00935000
*           RATCTR=RATCTR+1;        /* GO TO NEXT TABLE ENTRY TO SEE    00936000
*                                      IF IT FITS HERE       @Y30LB54*/ 00937000
         AL    @15,@CF00048                                        0246 00938000
         ST    @15,RATCTR(,DHEWKPTR)                               0246 00939000
*         END;                      /*                       @Y30LB54*/ 00940000
*       ELSE                                                       0248 00941000
*         DO;                       /*                       @Y30LB54*/ 00942000
         B     @RC00232                                            0248 00943000
@RF00232 DS    0H                                                  0249 00944000
*           CTR1=100;               /* STOP THIS PORTION OF LOOP WE     00945000
*                                      HAVE ALL THAT GOES HERE       */ 00946000
         MVC   CTR1(4,DHEWKPTR),@CF00398                           0249 00947000
*           IF FULLWD1=0 THEN                                      0250 00948000
         SLR   @05,@05                                             0250 00949000
         L     @15,FULLWD1(,DHEWKPTR)                              0250 00950000
         CR    @15,@05                                             0250 00951000
         BE    @RT00250                                            0250 00952000
*             RETURN;               /*                       @Y30LB54*/ 00953000
*           ELSE                                                   0252 00954000
*             ;                     /*                       @Y30LB54*/ 00955000
*           FULLWD1=FULLWD1-FULLWD2;/* HEADER FOR NEXT LINE  @Y30LB54*/ 00956000
         SL    @15,FULLWD2(,DHEWKPTR)                              0253 00957000
         ST    @15,FULLWD1(,DHEWKPTR)                              0253 00958000
*           IF FULLWD1<0 THEN                                      0254 00959000
         CR    @15,@05                                             0254 00960000
         BNL   @RF00254                                            0254 00961000
*             FULLWD1=0;            /*                       @Y30LB54*/ 00962000
         ST    @05,FULLWD1(,DHEWKPTR)                              0255 00963000
*           ELSE                                                   0256 00964000
*             ;                     /*                       @Y30LB54*/ 00965000
@RF00254 DS    0H                                                  0257 00966000
*         END;                      /*                       @Y30LB54*/ 00967000
*     END;                          /*                       @Y30LB54*/ 00968000
@RC00232 LA    @05,1                                               0258 00969000
         AL    @05,CTR1(,DHEWKPTR)                                 0258 00970000
         ST    @05,CTR1(,DHEWKPTR)                                 0258 00971000
@DE00231 C     @05,PTRDATE(,DHEWKPTR)                              0258 00972000
         BNH   @DL00231                                            0258 00973000
*     CALL ISDAPRT0(WORKPTR);       /* PRINT THIS LINE       @Y30LB54*/ 00974000
         L     @05,@PC00001                                        0259 00975000
         ST    @05,@AL00001                                        0259 00976000
         L     @15,@CV00040                                        0259 00977000
         LA    @01,@AL00001                                        0259 00978000
         BALR  @14,@15                                             0259 00979000
*     IF FULLWD1<0 THEN                                            0260 00980000
         ICM   @05,15,FULLWD1(DHEWKPTR)                            0260 00981000
         BM    @RT00260                                            0260 00982000
*       RETURN;                     /*                       @Y30LB54*/ 00983000
*     ELSE                                                         0262 00984000
*       ;                           /*                       @Y30LB54*/ 00985000
*   END;                            /*                       @Y30LB54*/ 00986000
         L     @05,FULLWD2(,DHEWKPTR)                              0263 00987000
         LCR   @05,@05                                             0263 00988000
         L     @15,CTR(,DHEWKPTR)                                  0263 00989000
         ALR   @15,@05                                             0263 00990000
         LR    @05,@15                                             0263 00991000
@DE00222 ST    @05,CTR(,DHEWKPTR)                                  0263 00992000
         LH    @15,RATCNT+92(,DHEWKPTR)                            0263 00993000
         SL    @15,FULLWD2(,DHEWKPTR)                              0263 00994000
         CR    @05,@15                                             0263 00995000
         BNL   @DL00222                                            0263 00996000
*   END RPT4BODY;                   /*                       @Y30LB54*/ 00997000
         B     @EL00006                                            0264 00998000
*                                                                  0265 00999000
*   /*****************************************************************/ 01000000
*   /*                                                               */ 01001000
*   /* PRINT THE ABSTRACT FOR DHU                                    */ 01002000
*   /*                                                               */ 01003000
*   /*****************************************************************/ 01004000
*                                                                  0265 01005000
*RPT4ABST:                                                         0265 01006000
*   PROC  OPTIONS(SAVE(14));        /*                       @Y30LB54*/ 01007000
RPT4ABST ST    @14,@SA00007                                        0265 01008000
*   ANSI=' ';                       /* SINGLE SPACE THIS SECTION   0266 01009000
*                                                            @Y30LB54*/ 01010000
         MVI   ANSI(CVTPTR),C' '                                   0266 01011000
*   LINE='-------------------------------';/*                @Y30LB54*/ 01012000
         MVI   LINE+31(CVTPTR),C' '                                0267 01013000
         MVC   LINE+32(100,CVTPTR),LINE+31(CVTPTR)                 0267 01014000
         MVC   LINE(31,CVTPTR),@CC00402                            0267 01015000
*   LINE(32:112)='----------------------------------------------------- 01016000
*---------------------------';      /*                       @Y30LB54*/ 01017000
         MVC   LINE+31(81,CVTPTR),@CC00405                         0268 01018000
*   CALL ISDAPRT0(WORKPTR);         /*                       @Y30LB54*/ 01019000
         L     @05,@PC00001                                        0269 01020000
         ST    @05,@AL00001                                        0269 01021000
         L     @15,@CV00040                                        0269 01022000
         LA    @01,@AL00001                                        0269 01023000
         BALR  @14,@15                                             0269 01024000
*   LINE='LEGEND:';                 /*                       @Y30LB54*/ 01025000
         MVI   LINE+7(CVTPTR),C' '                                 0270 01026000
         MVC   LINE+8(124,CVTPTR),LINE+7(CVTPTR)                   0270 01027000
         MVC   LINE(7,CVTPTR),@CC00411                             0270 01028000
*   CALL ISDAPRT0(WORKPTR);         /*                       @Y30LB54*/ 01029000
         L     @05,@PC00001                                        0271 01030000
         ST    @05,@AL00001                                        0271 01031000
         L     @15,@CV00040                                        0271 01032000
         LA    @01,@AL00001                                        0271 01033000
         BALR  @14,@15                                             0271 01034000
*   LINE='R - READ ERROR RATIO';    /*                       @Y30LB54*/ 01035000
         MVI   LINE+20(CVTPTR),C' '                                0272 01036000
         MVC   LINE+21(111,CVTPTR),LINE+20(CVTPTR)                 0272 01037000
         MVC   LINE(20,CVTPTR),@CC00412                            0272 01038000
*   CALL ISDAPRT0(WORKPTR);         /*                       @Y30LB54*/ 01039000
         L     @05,@PC00001                                        0273 01040000
         ST    @05,@AL00001                                        0273 01041000
         L     @15,@CV00040                                        0273 01042000
         LA    @01,@AL00001                                        0273 01043000
         BALR  @14,@15                                             0273 01044000
*   LINE='W - WRITE ERROR RATIO';   /*                       @Y30LB54*/ 01045000
         MVI   LINE+21(CVTPTR),C' '                                0274 01046000
         MVC   LINE+22(110,CVTPTR),LINE+21(CVTPTR)                 0274 01047000
         MVC   LINE(21,CVTPTR),@CC00414                            0274 01048000
*   CALL ISDAPRT0(WORKPTR);         /*                       @Y30LB54*/ 01049000
         L     @05,@PC00001                                        0275 01050000
         ST    @05,@AL00001                                        0275 01051000
         L     @15,@CV00040                                        0275 01052000
         LA    @01,@AL00001                                        0275 01053000
         BALR  @14,@15                                             0275 01054000
*   LINE='L - LOAD ERROR RATIO';    /*                       @Y30LB54*/ 01055000
         MVI   LINE+20(CVTPTR),C' '                                0276 01056000
         MVC   LINE+21(111,CVTPTR),LINE+20(CVTPTR)                 0276 01057000
         MVC   LINE(20,CVTPTR),@CC00416                            0276 01058000
*   CALL ISDAPRT0(WORKPTR);         /*                       @Y30LB54*/ 01059000
         L     @05,@PC00001                                        0277 01060000
         ST    @05,@AL00001                                        0277 01061000
         L     @15,@CV00040                                        0277 01062000
         LA    @01,@AL00001                                        0277 01063000
         BALR  @14,@15                                             0277 01064000
*   END RPT4ABST;                   /*                       @Y30LB54*/ 01065000
@EL00007 DS    0H                                                  0278 01066000
@EF00007 DS    0H                                                  0278 01067000
@ER00007 L     @14,@SA00007                                        0278 01068000
         BR    @14                                                 0278 01069000
*                                                                  0279 01070000
*   /*****************************************************************/ 01071000
*   /*                                                               */ 01072000
*   /* PRINT HEADER LINE FOR DHU A                                   */ 01073000
*   /*                                                               */ 01074000
*   /*****************************************************************/ 01075000
*                                                                  0279 01076000
*RPT4AHDR:                                                         0279 01077000
*   PROC  OPTIONS(SAVE(14));        /*                       @Y30LB54*/ 01078000
RPT4AHDR ST    @14,@SA00008                                        0279 01079000
*   LINE=' ';                       /* CLEAR LINE            @Y30LB54*/ 01080000
         MVI   LINE+1(CVTPTR),C' '                                 0280 01081000
         MVC   LINE+2(130,CVTPTR),LINE+1(CVTPTR)                   0280 01082000
         MVI   LINE(CVTPTR),C' '                                   0280 01083000
*   ANSI='1';                       /* EJECT TO START NEW PAGE     0281 01084000
*                                                            @Y30LB54*/ 01085000
         MVI   ANSI(CVTPTR),C'1'                                   0281 01086000
*   LINE(58:60)='MSF';              /*                       @ZM30730*/ 01087000
         MVC   LINE+57(3,CVTPTR),@CC00308                          0282 01088000
*   LINE(1:42)='REPORT 12 - LAST FOUR ACTIVE DAYS TRENDING'; /*    0283 01089000
*                                      DHU PART 2 TITLE      @ZM30730*/ 01090000
         MVC   LINE(42,CVTPTR),@CC00424                            0283 01091000
*   LINE(81:120)='(DATA FROM MSS FORMAT 0, MESSAGE CODE 5)';/*     0284 01092000
*                                                             @Y30L54*/ 01093000
         MVC   LINE+80(40,CVTPTR),@CC00317                         0284 01094000
*   FULLWD1=62;                     /* LOCATION WHERE TO PUT LIBRARY    01095000
*                                      NUMBER                @ZM30730*/ 01096000
         MVC   FULLWD1(4,DHEWKPTR),@CF00429                        0285 01097000
*   CALL CONVTLIB;                  /* INSERT LIBRARY NO IN PRINTABLE   01098000
*                                      FORM                  @Y30LB54*/ 01099000
         BAL   @14,CONVTLIB                                        0286 01100000
*   CALL ISDAPRT0(WORKPTR);         /*                       @Y30LB54*/ 01101000
         L     @05,@PC00001                                        0287 01102000
         ST    @05,@AL00001                                        0287 01103000
         L     @15,@CV00040                                        0287 01104000
         LA    @01,@AL00001                                        0287 01105000
         BALR  @14,@15                                             0287 01106000
*   LINE=' ';                       /* CLEAR LINE            @Y30LB54*/ 01107000
         MVI   LINE+1(CVTPTR),C' '                                 0288 01108000
         MVC   LINE+2(130,CVTPTR),LINE+1(CVTPTR)                   0288 01109000
         MVI   LINE(CVTPTR),C' '                                   0288 01110000
*   ANSI='0';                       /* DOUBLE SPACE NEXT LINE@Y30LB54*/ 01111000
         MVI   ANSI(CVTPTR),C'0'                                   0289 01112000
*   LINE(33:40)='DRD SSID';         /*                       @Y39LB54   01113000
*                                                            @Y30LB54*/ 01114000
         MVC   LINE+32(8,CVTPTR),@CC00324                          0290 01115000
*   CALL ISDAPRT0(WORKPTR);         /*                       @Y30LB54*/ 01116000
         L     @05,@PC00001                                        0291 01117000
         ST    @05,@AL00001                                        0291 01118000
         L     @15,@CV00040                                        0291 01119000
         LA    @01,@AL00001                                        0291 01120000
         BALR  @14,@15                                             0291 01121000
*   ANSI=' ';                       /* SINGLE SPACE THE REST OF THIS    01122000
*                                      SECTION               @Y30LB54*/ 01123000
         MVI   ANSI(CVTPTR),C' '                                   0292 01124000
*   LINE(32:112)='|   200   |   201   |   202   |   203   |   204   |   01125000
*205   |   206   |   207   |';      /*                       @Y30LB54*/ 01126000
         MVC   LINE+31(81,CVTPTR),@CC00327                         0293 01127000
*   DO CTR=37 TO 107 BY 10;         /* INSERT MSF IN SSID    @Y30LB54*/ 01128000
         LA    @05,37                                              0294 01129000
         ST    @05,CTR(,DHEWKPTR)                                  0294 01130000
@DL00294 DS    0H                                                  0295 01131000
*     LINE(CTR)=HEXREP(FOURBITS);   /*                       @Y30LB54*/ 01132000
         L     @05,CTR(,DHEWKPTR)                                  0295 01133000
         ALR   @05,CVTPTR                                          0295 01134000
         SLR   @01,@01                                             0295 01135000
         IC    @01,FOURBITS(,DHEWKPTR)                             0295 01136000
         LA    @15,HEXREP-1(@01)                                   0295 01137000
         MVC   LINE-1(1,@05),0(@15)                                0295 01138000
*   END;                            /*                       @Y30LB54*/ 01139000
         LA    @05,10                                              0296 01140000
         AL    @05,CTR(,DHEWKPTR)                                  0296 01141000
         ST    @05,CTR(,DHEWKPTR)                                  0296 01142000
         CH    @05,@CH00337                                        0296 01143000
         BNH   @DL00294                                            0296 01144000
*   CALL ISDAPRT0(WORKPTR);         /*                       @Y30LB54*/ 01145000
         L     @05,@PC00001                                        0297 01146000
         ST    @05,@AL00001                                        0297 01147000
         L     @15,@CV00040                                        0297 01148000
         LA    @01,@AL00001                                        0297 01149000
         BALR  @14,@15                                             0297 01150000
*   LINE(32:112)='|---------|---------|---------|---------|---------|-- 01151000
*------|---------|---------|';      /*                       @Y30LB54*/ 01152000
         MVC   LINE+31(81,CVTPTR),@CC00338                         0298 01153000
*   CALL ISDAPRT0(WORKPTR);         /*                       @Y30LB54*/ 01154000
         L     @05,@PC00001                                        0299 01155000
         ST    @05,@AL00001                                        0299 01156000
         L     @15,@CV00040                                        0299 01157000
         LA    @01,@AL00001                                        0299 01158000
         BALR  @14,@15                                             0299 01159000
*   END RPT4AHDR;                   /*                       @Y30LB54*/ 01160000
@EL00008 DS    0H                                                  0300 01161000
@EF00008 DS    0H                                                  0300 01162000
@ER00008 L     @14,@SA00008                                        0300 01163000
         BR    @14                                                 0300 01164000
*                                                                  0301 01165000
*   /*****************************************************************/ 01166000
*   /*                                                               */ 01167000
*   /* PRINT BODY OF DHU A                                           */ 01168000
*   /*                                                               */ 01169000
*   /*****************************************************************/ 01170000
*                                                                  0301 01171000
*RPT4ABDY:                                                         0301 01172000
*   PROC  OPTIONS(SAVE(14));        /*                       @Y30LB54*/ 01173000
RPT4ABDY ST    @14,@SA00009                                        0301 01174000
*   ANSI=' ';                       /*                       @Y30LB54*/ 01175000
         MVI   ANSI(CVTPTR),C' '                                   0302 01176000
*   PTRDATE=0;                      /* NO DAYS OFFSET INTO COUNTERS     01177000
*                                      YET                   @Y30LB54*/ 01178000
         SLR   @05,@05                                             0303 01179000
         ST    @05,PTRDATE(,DHEWKPTR)                              0303 01180000
*   PTRSSID=0;                      /* WORK ON FIRST SSID FIRST    0304 01181000
*                                                            @Y30LB54*/ 01182000
         ST    @05,PTRSSID(,DHEWKPTR)                              0304 01183000
*   KICKPTR=LIBPTR(LIBCTR)+PTRDATE+PTRSSID+PTRRPT;/*         @Y30LB54*/ 01184000
         L     @15,LIBCTR(,DHEWKPTR)                               0305 01185000
         SLA   @15,2                                               0305 01186000
         L     @15,LIBPTR-5(@15,DHEWKPTR)                          0305 01187000
         LA    @15,0(,@15)                                         0305 01188000
         ALR   @15,@05                                             0305 01189000
         ALR   @15,@05                                             0305 01190000
         AL    @15,PTRRPT(,DHEWKPTR)                               0305 01191000
         ST    @15,KICKPTR(,DHEWKPTR)                              0305 01192000
*/* NOW HAVE THE TRUE START POSITION IN THE COUNTERS         @Y30LB54*/ 01193000
*/*FIRST 32 BYTES OF 4A COUNTER AREA IS CONTROL INFO         @Y30LB54*/ 01194000
*                                                                  0306 01195000
*   /*****************************************************************/ 01196000
*   /*                                                               */ 01197000
*   /* MOVE CONTROL TO WORKING CORE                                  */ 01198000
*   /*                                                               */ 01199000
*   /*****************************************************************/ 01200000
*                                                                  0306 01201000
*   CTR=1;                          /* COUNTER OFFSET        @Y30LB54*/ 01202000
         LA    @05,1                                               0306 01203000
         ST    @05,CTR(,DHEWKPTR)                                  0306 01204000
*   DO CTR1=1 TO 4 BY 1;            /* EXTRACT LIBRARY DAY CONTROL 0307 01205000
*                                      INFO                  @Y30LB54*/ 01206000
         ST    @05,CTR1(,DHEWKPTR)                                 0307 01207000
@DL00307 DS    0H                                                  0308 01208000
*     DATEYYDD(CTR1)=COUNTER(CTR);  /*                       @Y30LB54*/ 01209000
         L     @05,CTR1(,DHEWKPTR)                                 0308 01210000
         SLA   @05,3                                               0308 01211000
         L     @15,CTR(,DHEWKPTR)                                  0308 01212000
         LR    @14,@15                                             0308 01213000
         SLA   @14,2                                               0308 01214000
         L     @09,KICKPTR(,DHEWKPTR)                              0308 01215000
         AL    @14,@CF00538                                        0308 01216000
         L     @14,COUNTER(@14,@09)                                0308 01217000
         ST    @14,DATEYYDD-8(@05,DHEWKPTR)                        0308 01218000
*     CTR=CTR+1;                    /*                       @Y30LB54*/ 01219000
         LA    @14,1                                               0309 01220000
         ALR   @15,@14                                             0309 01221000
         ST    @15,CTR(,DHEWKPTR)                                  0309 01222000
*     DATEOFST(CTR1)=COUNTER(CTR);  /*                       @Y30LB54*/ 01223000
         LR    @08,@15                                             0310 01224000
         SLA   @08,2                                               0310 01225000
         AL    @09,@CF00538                                        0310 01226000
         L     @09,COUNTER(@08,@09)                                0310 01227000
         ST    @09,DATEOFST-8(@05,DHEWKPTR)                        0310 01228000
*     CTR=CTR+ONE;                  /*                       @Y30LB54*/ 01229000
         ALR   @15,@14                                             0311 01230000
         ST    @15,CTR(,DHEWKPTR)                                  0311 01231000
*   END;                            /*                       @Y30LB54*/ 01232000
*                                                                  0312 01233000
         LA    @05,1                                               0312 01234000
         AL    @05,CTR1(,DHEWKPTR)                                 0312 01235000
         ST    @05,CTR1(,DHEWKPTR)                                 0312 01236000
         CH    @05,@CH00051                                        0312 01237000
         BNH   @DL00307                                            0312 01238000
*   /*****************************************************************/ 01239000
*   /*                                                               */ 01240000
*   /* READY TO GO ON 4 DAY TREND REPORT                             */ 01241000
*   /*                                                               */ 01242000
*   /*****************************************************************/ 01243000
*                                                                  0313 01244000
*   LINE='READ ERROR RATIO        DATE';/*                   @Y30LB54*/ 01245000
         MVI   LINE+28(CVTPTR),C' '                                0313 01246000
         MVC   LINE+29(103,CVTPTR),LINE+28(CVTPTR)                 0313 01247000
         MVC   LINE(28,CVTPTR),@CC00433                            0313 01248000
*   LINE(32:112)='|         |         |         |         |         |   01249000
*      |         |         |';      /*                       @Y30LB54*/ 01250000
         MVC   LINE+31(81,CVTPTR),@CC00351                         0314 01251000
*   CALL ISDAPRT0(WORKPTR);         /*                       @Y30LB54*/ 01252000
         L     @05,@PC00001                                        0315 01253000
         ST    @05,@AL00001                                        0315 01254000
         L     @15,@CV00040                                        0315 01255000
         LA    @01,@AL00001                                        0315 01256000
         BALR  @14,@15                                             0315 01257000
*   COUNTRP4=1;                     /* TELL THEM WHICH COUNTER OFFSET   01258000
*                                      IS READ               @Y30LB54*/ 01259000
         MVC   COUNTRP4(4,DHEWKPTR),@CF00048                       0316 01260000
*   CALL RPT4AFIL;                  /*                       @Y30LB54*/ 01261000
         BAL   @14,RPT4AFIL                                        0317 01262000
*   LINE='WRITE ERROR RATIO';       /*                       @Y30LB54*/ 01263000
         MVI   LINE+17(CVTPTR),C' '                                0318 01264000
         MVC   LINE+18(114,CVTPTR),LINE+17(CVTPTR)                 0318 01265000
         MVC   LINE(17,CVTPTR),@CC00437                            0318 01266000
*   LINE(32:112)='|         |         |         |         |         |   01267000
*      |         |         |';      /*                       @Y30LB54*/ 01268000
         MVC   LINE+31(81,CVTPTR),@CC00351                         0319 01269000
*   CALL ISDAPRT0(WORKPTR);         /*                       @Y30LB54*/ 01270000
         L     @05,@PC00001                                        0320 01271000
         ST    @05,@AL00001                                        0320 01272000
         L     @15,@CV00040                                        0320 01273000
         LA    @01,@AL00001                                        0320 01274000
         BALR  @14,@15                                             0320 01275000
*   COUNTRP4=3;                     /* TELL THEM WHICH COUNTER OFFSET   01276000
*                                      IS WRITE              @Y30LB54*/ 01277000
         MVC   COUNTRP4(4,DHEWKPTR),@CF00068                       0321 01278000
*   CALL RPT4AFIL;                  /*                       @Y30LB54*/ 01279000
         BAL   @14,RPT4AFIL                                        0322 01280000
*   LINE='LOAD ERROR RATIO';        /*                       @Y30LB54*/ 01281000
         MVI   LINE+16(CVTPTR),C' '                                0323 01282000
         MVC   LINE+17(115,CVTPTR),LINE+16(CVTPTR)                 0323 01283000
         MVC   LINE(16,CVTPTR),@CC00439                            0323 01284000
*   LINE(32:112)='|         |         |         |         |         |   01285000
*      |         |         |';      /*                       @Y30LB54*/ 01286000
         MVC   LINE+31(81,CVTPTR),@CC00351                         0324 01287000
*   CALL ISDAPRT0(WORKPTR);         /*                       @Y30LB54*/ 01288000
         L     @05,@PC00001                                        0325 01289000
         ST    @05,@AL00001                                        0325 01290000
         L     @15,@CV00040                                        0325 01291000
         LA    @01,@AL00001                                        0325 01292000
         BALR  @14,@15                                             0325 01293000
*   COUNTRP4=5;                     /* TELL THEM WHICH COUNTER OFFSET   01294000
*                                      IS LOAD               @Y30LB54*/ 01295000
         MVC   COUNTRP4(4,DHEWKPTR),@CF00150                       0326 01296000
*   CALL RPT4AFIL;                  /*                       @Y30LB54*/ 01297000
         BAL   @14,RPT4AFIL                                        0327 01298000
*   LINE='------------------------------------------------------------- 01299000
*--------------------------------------------------';/*      @Y30LB54*/ 01300000
         MVI   LINE+112(CVTPTR),C' '                               0328 01301000
         MVC   LINE+113(19,CVTPTR),LINE+112(CVTPTR)                0328 01302000
         MVC   LINE(112,CVTPTR),@CC00441                           0328 01303000
*   CALL ISDAPRT0(WORKPTR);         /*                       @Y30LB54*/ 01304000
         L     @05,@PC00001                                        0329 01305000
         ST    @05,@AL00001                                        0329 01306000
         L     @15,@CV00040                                        0329 01307000
         LA    @01,@AL00001                                        0329 01308000
         BALR  @14,@15                                             0329 01309000
*   END RPT4ABDY;                   /*                       @Y30LB54*/ 01310000
@EL00009 DS    0H                                                  0330 01311000
@EF00009 DS    0H                                                  0330 01312000
@ER00009 L     @14,@SA00009                                        0330 01313000
         BR    @14                                                 0330 01314000
*                                                                  0331 01315000
*   /*****************************************************************/ 01316000
*   /*                                                               */ 01317000
*   /* FILL THE BODY LINE OF DHU A                                   */ 01318000
*   /*                                                               */ 01319000
*   /*****************************************************************/ 01320000
*                                                                  0331 01321000
*RPT4AFIL:                                                         0331 01322000
*   PROC  OPTIONS(SAVE(14));        /*                       @Y30LB54*/ 01323000
RPT4AFIL ST    @14,@SA00010                                        0331 01324000
*   DO CTR=1 TO 4 BY 1;             /* FOUR DAYS WORTH OF DATA     0332 01325000
*                                                            @Y30LB54*/ 01326000
         LA    @05,1                                               0332 01327000
         ST    @05,CTR(,DHEWKPTR)                                  0332 01328000
@DL00332 DS    0H                                                  0333 01329000
*     IF DATEYYDD(CTR)^='00000000'X THEN/* IF LESS THAN 4 DAYS INPUT    01330000
*                                                            @Y30LB54*/ 01331000
         L     @05,CTR(,DHEWKPTR)                                  0333 01332000
         SLA   @05,3                                               0333 01333000
         ST    @05,@TF00001                                        0333 01334000
         ALR   @05,DHEWKPTR                                        0333 01335000
         CLC   DATEYYDD-8(4,@05),@CB00383                          0333 01336000
         BE    @RF00333                                            0333 01337000
*       DO;                         /*                       @Y30LB54*/ 01338000
*         PTRDATE=DATEOFST(CTR);    /* POINT TO CORRECT COUNTERS FOR    01339000
*                                      TODAY                 @Y30LB54*/ 01340000
         L     @05,@TF00001                                        0335 01341000
         L     @05,DATEOFST-8(@05,DHEWKPTR)                        0335 01342000
         ST    @05,PTRDATE(,DHEWKPTR)                              0335 01343000
*         CHAR4=DATEYYDD(CTR);      /* PICK UP THIS DATE     @Y30LB54*/ 01344000
         LR    @05,DHEWKPTR                                        0336 01345000
         AL    @05,@TF00001                                        0336 01346000
         MVC   CHAR4(4,DHEWKPTR),DATEYYDD-8(@05)                   0336 01347000
*         CHAR4(4)=CHAR4(4)|'0F'X;  /* PROTECT AGAINST JUNK  @Y30LB54*/ 01348000
         OI    CHAR4+3(DHEWKPTR),X'0F'                             0337 01349000
*         EDREC1=EDPAT3;            /*                       @Y30LB54*/ 01350000
         MVC   EDREC1(9,DHEWKPTR),EDPAT3                           0338 01351000
*         ED(EDREC1,CHAR4);         /* MAKE IT PRINTABLE     @Y30LB54*/ 01352000
         ED    EDREC1(9,DHEWKPTR),CHAR4(DHEWKPTR)                  0339 01353000
*         LINE=' ';                 /*                       @Y30LB54*/ 01354000
         MVI   LINE+1(CVTPTR),C' '                                 0340 01355000
         MVC   LINE+2(130,CVTPTR),LINE+1(CVTPTR)                   0340 01356000
         MVI   LINE(CVTPTR),C' '                                   0340 01357000
*         LINE(24:26)=EDREC1(7:9);  /* SPIN THE DATE AROUND  @Y30LB54*/ 01358000
         MVC   LINE+23(3,CVTPTR),EDREC1+6(DHEWKPTR)                0341 01359000
*         LINE(27:27)=EDREC1(6:6);  /* BACKWARDS FROM RECORD @Y30LB54*/ 01360000
         MVC   LINE+26(1,CVTPTR),EDREC1+5(DHEWKPTR)                0342 01361000
*         LINE(28:29)=EDREC1(4:5);  /* BUT THATS THE WAY IT IS     0343 01362000
*                                                            @Y30LB54*/ 01363000
         MVC   LINE+27(2,CVTPTR),EDREC1+3(DHEWKPTR)                0343 01364000
*         FULLWD1=33;               /* LOCATION TO START TO STUFF  0344 01365000
*                                      COUNTERS              @Y30LB54*/ 01366000
         MVC   FULLWD1(4,DHEWKPTR),@CF00373                        0344 01367000
*         LINE(32:112)='|         |         |         |         |  0345 01368000
*  |         |         |         |         |';/*             @Y30LB54*/ 01369000
         MVC   LINE+31(81,CVTPTR),@CC00391                         0345 01370000
*         DO CTR1=0 TO 7 BY 1;      /* PROCESS 8 SSIDS PER DAY     0346 01371000
*                                                            @Y30LB54*/ 01372000
         SLR   @05,@05                                             0346 01373000
         ST    @05,CTR1(,DHEWKPTR)                                 0346 01374000
@DL00346 DS    0H                                                  0347 01375000
*           PTRSSID=CTR1*24;        /* CORRECT OFFSET FOR THIS SSID     01376000
*                                                            @Y30LB54*/ 01377000
         L     @05,CTR1(,DHEWKPTR)                                 0347 01378000
         MH    @05,@CH00121                                        0347 01379000
         ST    @05,PTRSSID(,DHEWKPTR)                              0347 01380000
*           KICKPTR=LIBPTR(LIBCTR)+PTRDATE+PTRSSID+PTRRPT;/* @Y30LB54*/ 01381000
         L     @15,LIBCTR(,DHEWKPTR)                               0348 01382000
         SLA   @15,2                                               0348 01383000
         L     @15,LIBPTR-5(@15,DHEWKPTR)                          0348 01384000
         LA    @15,0(,@15)                                         0348 01385000
         AL    @15,PTRDATE(,DHEWKPTR)                              0348 01386000
         ALR   @15,@05                                             0348 01387000
         AL    @15,PTRRPT(,DHEWKPTR)                               0348 01388000
         ST    @15,KICKPTR(,DHEWKPTR)                              0348 01389000
*           IF COUNTER(COUNTRP4+1)^=0 THEN                         0349 01390000
         L     @05,COUNTRP4(,DHEWKPTR)                             0349 01391000
         SLA   @05,2                                               0349 01392000
         L     @14,COUNTER(@05,@15)                                0349 01393000
         LTR   @14,@14                                             0349 01394000
         BZ    @RF00349                                            0349 01395000
*             FULLWD2=(COUNTER(COUNTRP4)*10000)/COUNTER(COUNTRP4+1);    01396000
         AL    @15,@CF00538                                        0350 01397000
         L     @05,COUNTER(@05,@15)                                0350 01398000
         MH    @05,@CH00382                                        0350 01399000
         LR    @00,@05                                             0350 01400000
         SRDA  @00,32                                              0350 01401000
         DR    @00,@14                                             0350 01402000
         ST    @01,FULLWD2(,DHEWKPTR)                              0350 01403000
*           ELSE                                                   0351 01404000
*             FULLWD2=0;            /* NO RATIO              @Y30LB54*/ 01405000
         B     @RC00349                                            0351 01406000
@RF00349 SLR   @05,@05                                             0351 01407000
         ST    @05,FULLWD2(,DHEWKPTR)                              0351 01408000
*           EDREC=EDPAT1;           /* MOVE IN EDIT PATTERN  @Y30LB54*/ 01409000
@RC00349 MVC   EDREC(10,DHEWKPTR),EDPAT1                           0352 01410000
*           CVD(FULLWD2,CHAR5);     /* MAKE IT PACKED DECIMAL@Y30LB54*/ 01411000
         L     @05,FULLWD2(,DHEWKPTR)                              0353 01412000
         CVD   @05,@TS00001                                        0353 01413000
         MVC   CHAR5(5,DHEWKPTR),@TS00001+3                        0353 01414000
*           CHAR5(5)=CHAR5(5)|'0F'X;/* PROTECT FROM JUNK     @Y30LB54*/ 01415000
         OI    CHAR5+4(DHEWKPTR),X'0F'                             0354 01416000
*           ED(EDREC,CHAR5);        /* MAKE IT READABLE TO PRINTER 0355 01417000
*                                                            @Y30LB54*/ 01418000
         ED    EDREC(10,DHEWKPTR),CHAR5(DHEWKPTR)                  0355 01419000
*           LINE(FULLWD1+4:FULLWD1+8)=EDREC(6:10);/*         @Y30LB54*/ 01420000
         L     @05,FULLWD1(,DHEWKPTR)                              0356 01421000
         ALR   @05,CVTPTR                                          0356 01422000
         MVC   LINE+3(5,@05),EDREC+5(DHEWKPTR)                     0356 01423000
*           FULLWD1=FULLWD1+10;     /* NEXT VALID PRINT POSITION   0357 01424000
*                                                            @Y30LB54*/ 01425000
         L     @05,FULLWD1(,DHEWKPTR)                              0357 01426000
         AH    @05,@CH00155                                        0357 01427000
         ST    @05,FULLWD1(,DHEWKPTR)                              0357 01428000
*         END;                      /*                       @Y30LB54*/ 01429000
         LA    @05,1                                               0358 01430000
         AL    @05,CTR1(,DHEWKPTR)                                 0358 01431000
         ST    @05,CTR1(,DHEWKPTR)                                 0358 01432000
         CH    @05,@CH00294                                        0358 01433000
         BNH   @DL00346                                            0358 01434000
*       END;                        /*                       @Y30LB54*/ 01435000
*     ELSE                                                         0360 01436000
*       DO;                         /*                       @Y30LB54*/ 01437000
         B     @RC00333                                            0360 01438000
@RF00333 DS    0H                                                  0361 01439000
*         LINE='------NO INPUT DATA------';/*                @Y30LB54*/ 01440000
         MVI   LINE+25(CVTPTR),C' '                                0361 01441000
         MVC   LINE+26(106,CVTPTR),LINE+25(CVTPTR)                 0361 01442000
         MVC   LINE(25,CVTPTR),@CC00455                            0361 01443000
*         LINE(32:112)='|         |         |         |         |  0362 01444000
*  |         |         |         |';/*                       @Y30LB54*/ 01445000
         MVC   LINE+31(81,CVTPTR),@CC00351                         0362 01446000
*       END;                        /*                       @Y30LB54*/ 01447000
*     CALL ISDAPRT0(WORKPTR);       /*                       @Y30LB54*/ 01448000
@RC00333 L     @05,@PC00001                                        0364 01449000
         ST    @05,@AL00001                                        0364 01450000
         L     @15,@CV00040                                        0364 01451000
         LA    @01,@AL00001                                        0364 01452000
         BALR  @14,@15                                             0364 01453000
*   END;                            /*                       @Y30LB54*/ 01454000
         LA    @05,1                                               0365 01455000
         AL    @05,CTR(,DHEWKPTR)                                  0365 01456000
         ST    @05,CTR(,DHEWKPTR)                                  0365 01457000
         CH    @05,@CH00051                                        0365 01458000
         BNH   @DL00332                                            0365 01459000
*   END RPT4AFIL;                   /*                       @Y30LB54*/ 01460000
@EL00010 DS    0H                                                  0366 01461000
@EF00010 DS    0H                                                  0366 01462000
@ER00010 L     @14,@SA00010                                        0366 01463000
         BR    @14                                                 0366 01464000
*                                                                  0367 01465000
*   /*****************************************************************/ 01466000
*   /*                                                               */ 01467000
*   /* PRINT DHE HEADER                                              */ 01468000
*   /*                                                               */ 01469000
*   /*****************************************************************/ 01470000
*                                                                  0367 01471000
*RPT5HDR:                                                          0367 01472000
*   PROC  OPTIONS(SAVE(14));        /*                       @Y30LB54*/ 01473000
RPT5HDR  ST    @14,@SA00011                                        0367 01474000
*   SDARPTID=DHEID;                 /* MOVE DHE ID           @ZM30730*/ 01475000
         MVC   SDARPTID(3,CVTPTR),@CC00153                         0368 01476000
*   ANSI='1';                       /* EJECT TO START A NEW PAGE   0369 01477000
*                                                            @Y30LB54*/ 01478000
         MVI   ANSI(CVTPTR),C'1'                                   0369 01479000
*   LINE=' ';                       /* CLEAR LINE            @Y30LB54*/ 01480000
         MVI   LINE+1(CVTPTR),C' '                                 0370 01481000
         MVC   LINE+2(130,CVTPTR),LINE+1(CVTPTR)                   0370 01482000
         MVI   LINE(CVTPTR),C' '                                   0370 01483000
*   LINE(1:77)=                                                    0371 01484000
*'REPORT 13 - DATA HANDLING ERRORS FOR DRDS - DRD BUFFERED LOG COUNTER  01485000
*VERFLOW';                          /* DHE REPORT TITLE      @ZM30730*/ 01486000
*                                                                  0371 01487000
         MVC   LINE(77,CVTPTR),@CC00462                            0371 01488000
*   LINE(86:125)='(DATA FROM MSS FORMAT 0, MESSAGE CODE 5)';/*     0372 01489000
*                                                            @ZM30730*/ 01490000
         MVC   LINE+85(40,CVTPTR),@CC00317                         0372 01491000
*   CALL ISDAPRT0(WORKPTR);         /*                       @Y30LB54*/ 01492000
         L     @15,@PC00001                                        0373 01493000
         ST    @15,@AL00001                                        0373 01494000
         L     @15,@CV00040                                        0373 01495000
         LA    @01,@AL00001                                        0373 01496000
         BALR  @14,@15                                             0373 01497000
*   ANSI='0';                       /* DOUBLE SPACE THIS LINE@Y30LB54*/ 01498000
         MVI   ANSI(CVTPTR),C'0'                                   0374 01499000
*   LINE='* INDICATES WHICH COUNTER OVERFLOWED';/*           @Y30LB54*/ 01500000
         MVI   LINE+36(CVTPTR),C' '                                0375 01501000
         MVC   LINE+37(95,CVTPTR),LINE+36(CVTPTR)                  0375 01502000
         MVC   LINE(36,CVTPTR),@CC00470                            0375 01503000
*   CALL ISDAPRT0(WORKPTR);         /*                       @Y30LB54*/ 01504000
         L     @15,@PC00001                                        0376 01505000
         ST    @15,@AL00001                                        0376 01506000
         L     @15,@CV00040                                        0376 01507000
         LA    @01,@AL00001                                        0376 01508000
         BALR  @14,@15                                             0376 01509000
*   ANSI=' ';                       /* SINGLE SPACE THE REST @Y30LB54*/ 01510000
         MVI   ANSI(CVTPTR),C' '                                   0377 01511000
*   LINE=' ';                       /* CLEAR LINE            @Y30LB54*/ 01512000
         MVI   LINE+1(CVTPTR),C' '                                 0378 01513000
         MVC   LINE+2(130,CVTPTR),LINE+1(CVTPTR)                   0378 01514000
         MVI   LINE(CVTPTR),C' '                                   0378 01515000
*   LINE(1:7)='MSF DRD';            /*                       @Y30LB54*/ 01516000
         MVC   LINE(7,CVTPTR),@CC00473                             0379 01517000
*   LINE(28:39)='STRIPES READ';     /*                       @Y30LB54*/ 01518000
         MVC   LINE+27(12,CVTPTR),@CC00475                         0380 01519000
*   LINE(52:66)='STRIPES WRITTEN';  /*                       @Y30LB54*/ 01520000
         MVC   LINE+51(15,CVTPTR),@CC00479                         0381 01521000
*   LINE(76:79)='LOAD';             /*                       @Y30LB54*/ 01522000
         MVC   LINE+75(4,CVTPTR),@CC00483                          0382 01523000
*   CALL ISDAPRT0(WORKPTR);         /*                       @Y30LB54*/ 01524000
         L     @15,@PC00001                                        0383 01525000
         ST    @15,@AL00001                                        0383 01526000
         L     @15,@CV00040                                        0383 01527000
         LA    @01,@AL00001                                        0383 01528000
         BALR  @14,@15                                             0383 01529000
*   LINE=' ';                       /* CLEAR LINE            @Y30LB54*/ 01530000
         MVI   LINE+1(CVTPTR),C' '                                 0384 01531000
         MVC   LINE+2(130,CVTPTR),LINE+1(CVTPTR)                   0384 01532000
         MVI   LINE(CVTPTR),C' '                                   0384 01533000
*   LINE(1:8)='NO  SSID';           /*                       @Y30LB54*/ 01534000
         MVC   LINE(8,CVTPTR),@CC00484                             0385 01535000
*   LINE(10:13)='DATE';                                    /*@Y30LB54*/ 01536000
         MVC   LINE+9(4,CVTPTR),@CC00486                           0386 01537000
*   LINE(18:21)='TIME';             /*                       @Y30LB54*/ 01538000
         MVC   LINE+17(4,CVTPTR),@CC00488                          0387 01539000
*   LINE(28:47)='ERRORS/USAGE = RATIO';/*                    @Y30LB54*/ 01540000
         MVC   LINE+27(20,CVTPTR),@CC00188                         0388 01541000
*   LINE(52:71)='ERRORS/USAGE = RATIO';/*                    @Y30LB54*/ 01542000
         MVC   LINE+51(20,CVTPTR),@CC00188                         0389 01543000
*   LINE(76:95)='ERRORS/USAGE = RATIO';/*                    @Y30LB54*/ 01544000
         MVC   LINE+75(20,CVTPTR),@CC00188                         0390 01545000
*   CALL ISDAPRT0(WORKPTR);         /*                       @Y30LB54*/ 01546000
         L     @15,@PC00001                                        0391 01547000
         ST    @15,@AL00001                                        0391 01548000
         L     @15,@CV00040                                        0391 01549000
         LA    @01,@AL00001                                        0391 01550000
         BALR  @14,@15                                             0391 01551000
*   LINE='--|-----|-------|---------|-----------------------|---------- 01552000
*------------|-----------------------|';/*                   @Y30LB54*/ 01553000
         MVI   LINE+99(CVTPTR),C' '                                0392 01554000
         MVC   LINE+100(32,CVTPTR),LINE+99(CVTPTR)                 0392 01555000
         MVC   LINE(99,CVTPTR),@CC00492                            0392 01556000
*   CALL ISDAPRT0(WORKPTR);         /*                       @Y30LB54*/ 01557000
         L     @15,@PC00001                                        0393 01558000
         ST    @15,@AL00001                                        0393 01559000
         L     @15,@CV00040                                        0393 01560000
         LA    @01,@AL00001                                        0393 01561000
         BALR  @14,@15                                             0393 01562000
*   END RPT5HDR;                    /*                       @Y30LB54*/ 01563000
@EL00011 DS    0H                                                  0394 01564000
@EF00011 DS    0H                                                  0394 01565000
@ER00011 L     @14,@SA00011                                        0394 01566000
         BR    @14                                                 0394 01567000
*                                                                  0395 01568000
*   /*****************************************************************/ 01569000
*   /*                                                               */ 01570000
*   /* PRINT DHE BODY                                                */ 01571000
*   /*                                                               */ 01572000
*   /*****************************************************************/ 01573000
*                                                                  0395 01574000
*RPT5BDY:                                                          0395 01575000
*   PROC  OPTIONS(SAVE(14));        /*                       @Y30LB54*/ 01576000
RPT5BDY  ST    @14,@SA00012                                        0395 01577000
*   ANSI=' ';                       /*                       @Y30LB54*/ 01578000
         MVI   ANSI(CVTPTR),C' '                                   0396 01579000
*   LIBCTR=1;                       /* SET UP WORKING SPACE SUBSCRIPT   01580000
*                                                            @Y30LB54*/ 01581000
         MVC   LIBCTR(4,DHEWKPTR),@CF00048                         0397 01582000
*   PTR5CUR=PTR5TOP;                /* START AT TOP OF INPUT STREAM     01583000
*                                                            @Y30LB54*/ 01584000
         L     @15,PTR5TOP(,DHEWKPTR)                              0398 01585000
         ST    @15,PTR5CUR(,DHEWKPTR)                              0398 01586000
*   PTRINP=ADDR(DATA04);            /* LOCATION OF COUNTERS  @Y30LB54*/ 01587000
         LA    @14,DATA04(,DHEWKPTR)                               0399 01588000
         ST    @14,PTRINP(,DHEWKPTR)                               0399 01589000
*   DO PTR5CUR=PTR5CUR TO PTR5BOT BY 36;/* DO ALL DHE RECORDS@Y30LB54*/ 01590000
         B     @DE00400                                            0400 01591000
@DL00400 DS    0H                                                  0401 01592000
*     LINE=' ';                     /* CLEAR PRINT BUFFER    @Y30LB54*/ 01593000
         MVI   LINE+1(CVTPTR),C' '                                 0401 01594000
         MVC   LINE+2(130,CVTPTR),LINE+1(CVTPTR)                   0401 01595000
         MVI   LINE(CVTPTR),C' '                                   0401 01596000
*     INPUTCTR=RPT5CTRS(1);         /* MOVE COUNTERS SO WE CAN     0402 01597000
*                                      SUBSCRIPT             @Y30LB54*/ 01598000
         L     @01,PTRINP(,DHEWKPTR)                               0402 01599000
         L     @15,PTR5CUR(,DHEWKPTR)                              0402 01600000
         MVC   INPUTCTR(24,@01),RPT5CTRS(@15)                      0402 01601000
*     FULLWD1=RPT5SSID(1);          /* PUT IT IN ARITHMETIC AREA   0403 01602000
*                                                            @Y30LB54*/ 01603000
         SLR   @14,@14                                             0403 01604000
         IC    @14,RPT5SSID(,@15)                                  0403 01605000
         ST    @14,FULLWD1(,DHEWKPTR)                              0403 01606000
*     CVD(FULLWD1,CHAR4);           /* CONVERT SSID TO PRINTABLE CHAR   01607000
*                                                            @Y30LB54*/ 01608000
         CVD   @14,@TS00001                                        0404 01609000
         MVC   CHAR4(4,DHEWKPTR),@TS00001+4                        0404 01610000
*     CHAR4(4)=CHAR4(4)|'0F'X;      /* PROTECT FROM JUNK     @Y30LB54*/ 01611000
         OI    CHAR4+3(DHEWKPTR),X'0F'                             0405 01612000
*     UNPK(LINE(5:6),CHAR4(3:4));   /*                       @Y30LB54*/ 01613000
         UNPK  LINE+4(2,CVTPTR),CHAR4+2(2,DHEWKPTR)                0406 01614000
*     LINE(4)='2';                  /* INSERT DEVICE TYPE    @Y30LB54*/ 01615000
         MVI   LINE+3(CVTPTR),C'2'                                 0407 01616000
*     LIBNO(LIBCTR)=RPT5LIB(1);     /* CONVERT LIBRARY TO PRINTABLE     01617000
*                                      CHAR                  @Y30LB54*/ 01618000
         L     @14,LIBCTR(,DHEWKPTR)                               0408 01619000
         SLA   @14,2                                               0408 01620000
         ALR   @14,DHEWKPTR                                        0408 01621000
         MVC   LIBNO-4(1,@14),RPT5LIB(@15)                         0408 01622000
*     FULLWD1=1;                    /* LOCATION TO PUT CONVERTED   0409 01623000
*                                      VALUE                 @Y30LB54*/ 01624000
         MVC   FULLWD1(4,DHEWKPTR),@CF00048                        0409 01625000
*     CALL CONVTLIB;                /* CONVERT IT TO PRINT CHAR    0410 01626000
*                                                            @Y30LB54*/ 01627000
         BAL   @14,CONVTLIB                                        0410 01628000
*     LINE(5)=HEXREP(FOURBITS);     /* INSERT MSF IN SSID    @Y30LB54*/ 01629000
         SLR   @01,@01                                             0411 01630000
         IC    @01,FOURBITS(,DHEWKPTR)                             0411 01631000
         LA    @15,HEXREP-1(@01)                                   0411 01632000
         MVC   LINE+4(1,CVTPTR),0(@15)                             0411 01633000
*     EDREC(1:8)=RPT5DATE(1);       /* DATE CONVERSION       @Y30LB54*/ 01634000
         L     @01,PTR5CUR(,DHEWKPTR)                              0412 01635000
         MVC   EDREC(8,DHEWKPTR),RPT5DATE(@01)                     0412 01636000
*     CHAR4=EDREC(1:4);             /*                       @Y30LB54*/ 01637000
         MVC   CHAR4(4,DHEWKPTR),EDREC(DHEWKPTR)                   0413 01638000
*     CHAR4(4)=CHAR4(4)|'0F'X;      /* PROTECT FROM JUNK     @Y30LB54*/ 01639000
         OI    CHAR4+3(DHEWKPTR),X'0F'                             0414 01640000
*     EDREC1=EDPAT3;                /* MOVE IN EDIT PATTERN  @Y30LB54*/ 01641000
         MVC   EDREC1(9,DHEWKPTR),EDPAT3                           0415 01642000
*     ED(EDREC1,CHAR4);             /* CONVERT               @Y30LB54*/ 01643000
         ED    EDREC1(9,DHEWKPTR),CHAR4(DHEWKPTR)                  0416 01644000
*     LINE(10:12)=EDREC1(7:9);      /* MOVE TO PRINT LINE    @Y30LB54*/ 01645000
         MVC   LINE+9(3,CVTPTR),EDREC1+6(DHEWKPTR)                 0417 01646000
*     LINE(13:13)=EDREC1(6:6);      /* SPIN DATE IT IS BACKWARDS   0418 01647000
*                                                            @Y30LB54*/ 01648000
         MVC   LINE+12(1,CVTPTR),EDREC1+5(DHEWKPTR)                0418 01649000
*     LINE(14:15)=EDREC1(4:5);      /* YEAR                  @Y30LB54*/ 01650000
         MVC   LINE+13(2,CVTPTR),EDREC1+3(DHEWKPTR)                0419 01651000
*     CHAR4=EDREC(5:8);             /*                       @Y30LB54*/ 01652000
         MVC   CHAR4(4,DHEWKPTR),EDREC+4(DHEWKPTR)                 0420 01653000
*     CHAR4(4)=CHAR4(4)|'0F'X;      /* DELETE HUNDRETHS OF SECOND  0421 01654000
*                                                            @Y30LB54*/ 01655000
         OI    CHAR4+3(DHEWKPTR),X'0F'                             0421 01656000
*     EDREC=EDPAT4;                 /* MOVE IN EDIT PATTERN  @Y30LB54*/ 01657000
         MVC   EDREC(10,DHEWKPTR),EDPAT4                           0422 01658000
*     ED(EDREC,CHAR4);              /* CONVERT IT            @Y30LB54*/ 01659000
         ED    EDREC(10,DHEWKPTR),CHAR4(DHEWKPTR)                  0423 01660000
*     LINE(18:25)=EDREC(2:9);       /* MOVE IT TO PRINT LINE @Y30LB54*/ 01661000
         MVC   LINE+17(8,CVTPTR),EDREC+1(DHEWKPTR)                 0424 01662000
*     IF LINE(18)='40'X THEN                                       0425 01663000
         CLI   LINE+17(CVTPTR),X'40'                               0425 01664000
         BNE   @RF00425                                            0425 01665000
*       LINE(18)='F0'X;             /*                       @Y30LB54*/ 01666000
         MVI   LINE+17(CVTPTR),X'F0'                               0426 01667000
*     ELSE                                                         0427 01668000
*       ;                           /*                       @Y30LB54*/ 01669000
@RF00425 DS    0H                                                  0428 01670000
*     FULLWD1=28;                   /* LOCATION TO START PRINTING  0428 01671000
*                                      COUNTERS              @Y30LB54*/ 01672000
         MVC   FULLWD1(4,DHEWKPTR),@CF00390                        0428 01673000
*     DO CTR=1 TO 6 BY 2;           /*                       @Y30LB54*/ 01674000
         LA    @15,1                                               0429 01675000
         ST    @15,CTR(,DHEWKPTR)                                  0429 01676000
@DL00429 DS    0H                                                  0430 01677000
*       EDRECF=EDPAT;               /* MOVE IN EDIT PATTERN  @ZM02889*/ 01678000
         MVC   EDRECF(10),EDPAT                                    0430 01679000
*       CVD(INCTR(CTR),CHAR5F);     /* CONVERT COUNTER       @ZM02889*/ 01680000
         L     @15,CTR(,DHEWKPTR)                                  0431 01681000
         SLA   @15,2                                               0431 01682000
         L     @01,PTRINP(,DHEWKPTR)                               0431 01683000
         AL    @01,@CF00538                                        0431 01684000
         L     @15,INCTR(@15,@01)                                  0431 01685000
         CVD   @15,@TS00001                                        0431 01686000
         MVC   CHAR5F(5),@TS00001+3                                0431 01687000
*       CHAR5F(5)=CHAR5F(5)|'0F'X;  /* PROTECT FROM JUNK     @ZM02889*/ 01688000
         OI    CHAR5F+4,X'0F'                                      0432 01689000
*       RFY                                                        0433 01690000
*           R1 RSTD; /*ALLOW EDIT AND MARK INSTRUCTION       @ZM02889*/ 01691000
*      GENERATE CODE; /*EDIT AND MARK NOT BUILT IN           @ZM02889*/ 01692000
      EDMK  EDRECF,CHAR5F                                               01693000
*       FULLWD2 = INCTR(CTR) & '00008000'X;/*DID IT OVERFLOW @ZM02889*/ 01694000
         L     @15,CTR(,DHEWKPTR)                                  0435 01695000
         SLA   @15,2                                               0435 01696000
         L     @14,PTRINP(,DHEWKPTR)                               0435 01697000
         AL    @14,@CF00538                                        0435 01698000
         L     @00,INCTR(@15,@14)                                  0435 01699000
         N     @00,@CF00506                                        0435 01700000
         ST    @00,FULLWD2(,DHEWKPTR)                              0435 01701000
*       IF FULLWD2 ^= 0 THEN       /*                        @ZM02889*/ 01702000
         LTR   @00,@00                                             0436 01703000
         BZ    @RF00436                                            0436 01704000
*        DO; /*NOW HAVE AN OVERFLOW CONDITION                @ZM02889*/ 01705000
*           R1 = R1 - 1; /*POSITION TO FIRST SIGNIFICANT DIG @ZM02889*/ 01706000
         BCTR  R1,0                                                0438 01707000
*        GENERATE CODE; /*RESULTS OF EDIT AND MARK UNUSABLE  @ZM02889*/ 01708000
        MVI 0(R1),C'*'                                                  01709000
*        END;                                              /*@ZM02889*/ 01710000
*       ELSE;                                              /*@ZM02889*/ 01711000
@RF00436 DS    0H                                                  0442 01712000
*       RFY                                                        0442 01713000
*          R1 UNRSTD; /*CLEAR RESTRICTION OF MARK            @ZM02889*/ 01714000
*       LINE(FULLWD1+0:FULLWD1+5)=EDRECF(5:10);/*            @ZM02889*/ 01715000
         L     @01,FULLWD1(,DHEWKPTR)                              0443 01716000
         ALR   @01,CVTPTR                                          0443 01717000
         MVC   LINE-1(6,@01),EDRECF+4                              0443 01718000
*       EDRECF=EDPAT;               /*                       @ZM02889*/ 01719000
         MVC   EDRECF(10),EDPAT                                    0444 01720000
*       CVD(INCTR(CTR+1),CHAR5F);   /* CONVERT IT            @ZM02889*/ 01721000
         L     @15,CTR(,DHEWKPTR)                                  0445 01722000
         SLA   @15,2                                               0445 01723000
         L     @01,PTRINP(,DHEWKPTR)                               0445 01724000
         L     @15,INCTR(@15,@01)                                  0445 01725000
         CVD   @15,@TS00001                                        0445 01726000
         MVC   CHAR5F(5),@TS00001+3                                0445 01727000
*       CHAR5F(5)=CHAR5F(5)|'0F'X;  /* PROTECT FROM JUNK     @ZM02889*/ 01728000
         OI    CHAR5F+4,X'0F'                                      0446 01729000
*       RFY                                                        0447 01730000
*         R1 RSTD; /*ALLOW EDIT AND MARK INSTRUCTION         @ZM02889*/ 01731000
*        GENERATE CODE; /*EDIT AND MARK NOT BUILT IN         @ZM02889*/ 01732000
        EDMK    EDRECF,CHAR5F                                           01733000
*       IF CTR ^=5 THEN             /*LOAD HAS DIFFERENT MASK@ZM02889*/ 01734000
         L     @15,CTR(,DHEWKPTR)                                  0449 01735000
         CH    @15,@CH00150                                        0449 01736000
         BE    @RF00449                                            0449 01737000
*           FULLWD2 = INCTR(CTR+1) & '00800000'X;/*OVERFLOW MASK   0450 01738000
*                                                            @ZM02889*/ 01739000
         SLA   @15,2                                               0450 01740000
         L     @14,PTRINP(,DHEWKPTR)                               0450 01741000
         L     @00,INCTR(@15,@14)                                  0450 01742000
         N     @00,@CF00507                                        0450 01743000
         ST    @00,FULLWD2(,DHEWKPTR)                              0450 01744000
*       ELSE                                               /*@ZM02889*/ 01745000
*           FULLWD2 = INCTR(CTR+1) & '00008000'X;/*OVERFLOW MASK   0451 01746000
*                                                            @ZM02889*/ 01747000
         B     @RC00449                                            0451 01748000
@RF00449 L     @15,CTR(,DHEWKPTR)                                  0451 01749000
         SLA   @15,2                                               0451 01750000
         L     @14,PTRINP(,DHEWKPTR)                               0451 01751000
         L     @00,INCTR(@15,@14)                                  0451 01752000
         N     @00,@CF00506                                        0451 01753000
         ST    @00,FULLWD2(,DHEWKPTR)                              0451 01754000
*       IF FULLWD2 ^= 0 THEN                               /*@ZM02889*/ 01755000
@RC00449 ICM   @00,15,FULLWD2(DHEWKPTR)                            0452 01756000
         BZ    @RF00452                                            0452 01757000
*        DO;                                               /*@ZM02889*/ 01758000
*          R1 = R1 - 1; /*POSITION TO FIRST SIGNIFICANT DIG  @ZM02889*/ 01759000
         BCTR  R1,0                                                0454 01760000
*          GENERATE CODE; /*RESULTS OF EDIT AND MARK UNUSABLE@ZM02889*/ 01761000
         MVI 0(R1),C'*'                                                 01762000
*        END;          /*                                    @ZM02889*/ 01763000
*       ELSE;         /*                                     @ZM02889*/ 01764000
@RF00452 DS    0H                                                  0458 01765000
*       RFY                                                        0458 01766000
*         R1 UNRSTD; /*CLEAR RESTRICTION OF MARK             @ZM02889*/ 01767000
*       LINE(FULLWD1+6:FULLWD1+15)=EDRECF(1:10);/*           @ZM02889*/ 01768000
         L     @01,FULLWD1(,DHEWKPTR)                              0459 01769000
         ALR   @01,CVTPTR                                          0459 01770000
         MVC   LINE+5(10,@01),EDRECF                               0459 01771000
*       IF INCTR(CTR+1)^=0 THEN                                    0460 01772000
         L     @15,CTR(,DHEWKPTR)                                  0460 01773000
         SLA   @15,2                                               0460 01774000
         L     @14,PTRINP(,DHEWKPTR)                               0460 01775000
         L     @09,INCTR(@15,@14)                                  0460 01776000
         LTR   @09,@09                                             0460 01777000
         BZ    @RF00460                                            0460 01778000
*         FULLWD2=(INCTR(CTR)*10000)/INCTR(CTR+1);/*         @Y30LB54*/ 01779000
         AL    @14,@CF00538                                        0461 01780000
         L     @08,INCTR(@15,@14)                                  0461 01781000
         MH    @08,@CH00382                                        0461 01782000
         ST    @09,@TF00001                                        0461 01783000
         SRDA  @08,32                                              0461 01784000
         D     @08,@TF00001                                        0461 01785000
         ST    @09,FULLWD2(,DHEWKPTR)                              0461 01786000
*       ELSE                                                       0462 01787000
*         FULLWD2=0;                /* NO RATIO              @Y30LB54*/ 01788000
         B     @RC00460                                            0462 01789000
@RF00460 SLR   @15,@15                                             0462 01790000
         ST    @15,FULLWD2(,DHEWKPTR)                              0462 01791000
*       EDREC=EDPAT1;               /*                       @Y30LB54*/ 01792000
@RC00460 MVC   EDREC(10,DHEWKPTR),EDPAT1                           0463 01793000
*       CVD(FULLWD2,CHAR5);         /* CONVERT IT            @Y30LB54*/ 01794000
         L     @15,FULLWD2(,DHEWKPTR)                              0464 01795000
         CVD   @15,@TS00001                                        0464 01796000
         MVC   CHAR5(5,DHEWKPTR),@TS00001+3                        0464 01797000
*       CHAR5(5)=CHAR5(5)|'0F'X;    /*                       @Y30LB54*/ 01798000
         OI    CHAR5+4(DHEWKPTR),X'0F'                             0465 01799000
*       ED(EDREC,CHAR5);            /* CONVERT IT            @Y30LB54*/ 01800000
         ED    EDREC(10,DHEWKPTR),CHAR5(DHEWKPTR)                  0466 01801000
*       LINE(FULLWD1+16:FULLWD1+20)=EDREC(6:10);/*           @Y30LB54*/ 01802000
         L     @15,FULLWD1(,DHEWKPTR)                              0467 01803000
         ALR   @15,CVTPTR                                          0467 01804000
         MVC   LINE+15(5,@15),EDREC+5(DHEWKPTR)                    0467 01805000
*       FULLWD1=FULLWD1+24;         /* NEXT TIME AROUND PRINT POS  0468 01806000
*                                                            @Y30LB54*/ 01807000
         L     @15,FULLWD1(,DHEWKPTR)                              0468 01808000
         AH    @15,@CH00121                                        0468 01809000
         ST    @15,FULLWD1(,DHEWKPTR)                              0468 01810000
*     END;                          /*                       @Y30LB54*/ 01811000
         LA    @15,2                                               0469 01812000
         AL    @15,CTR(,DHEWKPTR)                                  0469 01813000
         ST    @15,CTR(,DHEWKPTR)                                  0469 01814000
         CH    @15,@CH00141                                        0469 01815000
         BNH   @DL00429                                            0469 01816000
*     CALL ISDAPRT0(WORKPTR);       /* PRINT LINE            @Y30LB54*/ 01817000
         L     @15,@PC00001                                        0470 01818000
         ST    @15,@AL00001                                        0470 01819000
         L     @15,@CV00040                                        0470 01820000
         LA    @01,@AL00001                                        0470 01821000
         BALR  @14,@15                                             0470 01822000
*   END;                            /*                       @Y30LB54*/ 01823000
         LA    @15,36                                              0471 01824000
         AL    @15,PTR5CUR(,DHEWKPTR)                              0471 01825000
         ST    @15,PTR5CUR(,DHEWKPTR)                              0471 01826000
@DE00400 C     @15,PTR5BOT(,DHEWKPTR)                              0471 01827000
         BNH   @DL00400                                            0471 01828000
*   END RPT5BDY;                    /*                       @Y30LB54*/ 01829000
@EL00012 DS    0H                                                  0472 01830000
@EF00012 DS    0H                                                  0472 01831000
@ER00012 L     @14,@SA00012                                        0472 01832000
         BR    @14                                                 0472 01833000
*                                                                  0473 01834000
*   /*****************************************************************/ 01835000
*   /*                                                               */ 01836000
*   /* CONVERT LIBRARY NUMBER TO PRINTABLE CHAR                      */ 01837000
*   /*                                                               */ 01838000
*   /*****************************************************************/ 01839000
*                                                                  0473 01840000
*/*FULLWD1 WILL POINT TO OUTPUT PRINT POSITION               @Y30LB54*/ 01841000
*/*LIBCTR WILL POINT TO LIBRARY CONTROL BLOCK                @Y30LB54*/ 01842000
*                                                                  0473 01843000
*CONVTLIB:                                                         0473 01844000
*   PROC  OPTIONS(SAVE(14));        /*                       @Y30LB54*/ 01845000
CONVTLIB ST    @14,12(,@13)                                        0473 01846000
*   KICKPTR=LIBPTR(LIBCTR);         /* ESTABLISH BASE FOR COUNTERS 0474 01847000
*                                                            @Y30LB54*/ 01848000
         L     @15,LIBCTR(,DHEWKPTR)                               0474 01849000
         SLA   @15,2                                               0474 01850000
         L     @14,LIBPTR-5(@15,DHEWKPTR)                          0474 01851000
         LA    @14,0(,@14)                                         0474 01852000
         ST    @14,KICKPTR(,DHEWKPTR)                              0474 01853000
*   LIBNO(LIBCTR)=LIBNO(LIBCTR)-1;  /* PRINT TRUE VALUE      @Y30LB54*/ 01854000
         SLR   @14,@14                                             0475 01855000
         IC    @14,LIBNO-4(@15,DHEWKPTR)                           0475 01856000
         BCTR  @14,0                                               0475 01857000
         STC   @14,LIBNO-4(@15,DHEWKPTR)                           0475 01858000
*   FOURBITS=LIBNO(LIBCTR)&'0F'X;   /* TAKE BOTTOM BYTE      @Y30LB54*/ 01859000
         ST    @15,@TF00001                                        0476 01860000
         ALR   @15,DHEWKPTR                                        0476 01861000
         MVC   FOURBITS(1,DHEWKPTR),LIBNO-4(@15)                   0476 01862000
         NI    FOURBITS(DHEWKPTR),X'0F'                            0476 01863000
*   FOURBITS=FOURBITS+1;            /* DISPLACE INTO CONVERSION TABLE   01864000
*                                                            @Y30LB54*/ 01865000
         LA    @15,1                                               0477 01866000
         SLR   @09,@09                                             0477 01867000
         IC    @09,FOURBITS(,DHEWKPTR)                             0477 01868000
         ALR   @09,@15                                             0477 01869000
         STC   @09,FOURBITS(,DHEWKPTR)                             0477 01870000
*   LINE(FULLWD1:FULLWD1)=HEXREP(FOURBITS);/*                @Y30LB54*/ 01871000
         L     @01,FULLWD1(,DHEWKPTR)                              0478 01872000
         ALR   @01,CVTPTR                                          0478 01873000
         LA    @08,HEXREP-1(@09)                                   0478 01874000
         MVC   LINE-1(1,@01),0(@08)                                0478 01875000
*   LIBNO(LIBCTR)=LIBNO(LIBCTR)+1;  /* ALLOW FOR START AT 0  @Y30LB54*/ 01876000
         ALR   @14,@15                                             0479 01877000
         L     @15,@TF00001                                        0479 01878000
         STC   @14,LIBNO-4(@15,DHEWKPTR)                           0479 01879000
*   END CONVTLIB;                   /*                       @Y30LB54*/ 01880000
@EL00013 DS    0H                                                  0480 01881000
@EF00013 DS    0H                                                  0480 01882000
@ER00013 L     @14,12(,@13)                                        0480 01883000
         BR    @14                                                 0480 01884000
*                                                                  0481 01885000
*   /*****************************************************************/ 01886000
*   /*                                                               */ 01887000
*   /* SORT THE RATIO TABLE FOR GRAPH PORTION OF REPORT              */ 01888000
*   /*                                                               */ 01889000
*   /*****************************************************************/ 01890000
*                                                                  0481 01891000
*RATSORT:                                                          0481 01892000
*   PROC  OPTIONS(SAVE(14));        /*                       @Y30LB54*/ 01893000
RATSORT  ST    @14,12(,@13)                                        0481 01894000
*   SORTSW='0'B;                    /*                       @Y30LB54*/ 01895000
         MVI   SORTSW(DHEWKPTR),B'00000000'                        0482 01896000
*   DO CTR=1 TO 23 BY 1;            /* 8 SSID TIMES 3 POSSIBILITIES     01897000
*                                      READ-WRITE-LOAD       @Y30LB54*/ 01898000
         LA    @05,1                                               0483 01899000
         ST    @05,CTR(,DHEWKPTR)                                  0483 01900000
@DL00483 DS    0H                                                  0484 01901000
*     IF RATIOTBL(CTR+1)>RATIOTBL(CTR) THEN                        0484 01902000
         L     @05,CTR(,DHEWKPTR)                                  0484 01903000
         SLA   @05,2                                               0484 01904000
         ST    @05,@TF00001                                        0484 01905000
         ALR   @05,DHEWKPTR                                        0484 01906000
         LR    @01,DHEWKPTR                                        0484 01907000
         AL    @01,@TF00001                                        0484 01908000
         CLC   RATIOTBL(4,@05),RATIOTBL-4(@01)                     0484 01909000
         BNH   @RF00484                                            0484 01910000
*       DO;                         /*                       @Y30LB54*/ 01911000
*         FULLWD1=RATIOTBL(CTR);    /* SWAP THEY ARE OUT OF ORDER  0486 01912000
*                                                            @Y30LB54*/ 01913000
         L     @05,@TF00001                                        0486 01914000
         L     @05,RATIOTBL-4(@05,DHEWKPTR)                        0486 01915000
         ST    @05,FULLWD1(,DHEWKPTR)                              0486 01916000
*         RATIOTBL(CTR)=RATIOTBL(CTR+1);/*                   @Y30LB54*/ 01917000
         LR    @01,DHEWKPTR                                        0487 01918000
         AL    @01,@TF00001                                        0487 01919000
         LR    @15,DHEWKPTR                                        0487 01920000
         AL    @15,@TF00001                                        0487 01921000
         MVC   RATIOTBL-4(4,@01),RATIOTBL(@15)                     0487 01922000
*         RATIOTBL(CTR+1)=FULLWD1;  /*                       @Y30LB54*/ 01923000
         L     @01,@TF00001                                        0488 01924000
         ST    @05,RATIOTBL(@01,DHEWKPTR)                          0488 01925000
*         SORTSW='1'B;              /* TELL WORLD WE REALY DID SORT     01926000
*                                                            @Y30LB54*/ 01927000
         MVI   SORTSW(DHEWKPTR),B'10000000'                        0489 01928000
*         CTR=0;                    /* START BUBBLE UP PROCESS OVER     01929000
*                                      AGAIN                 @Y30LB54*/ 01930000
         SLR   @05,@05                                             0490 01931000
         ST    @05,CTR(,DHEWKPTR)                                  0490 01932000
*       END;                        /*                       @Y30LB54*/ 01933000
*     ELSE                                                         0492 01934000
*       ;                           /*                       @Y30LB54*/ 01935000
@RF00484 DS    0H                                                  0493 01936000
*   END;                            /*                       @Y30LB54*/ 01937000
         LA    @05,1                                               0493 01938000
         AL    @05,CTR(,DHEWKPTR)                                  0493 01939000
         ST    @05,CTR(,DHEWKPTR)                                  0493 01940000
         CH    @05,@CH00515                                        0493 01941000
         BNH   @DL00483                                            0493 01942000
*   END RATSORT;                    /*                       @Y30LB54*/ 01943000
@EL00014 DS    0H                                                  0494 01944000
@EF00014 DS    0H                                                  0494 01945000
@ER00014 L     @14,12(,@13)                                        0494 01946000
         BR    @14                                                 0494 01947000
*                                                                  0495 01948000
*   /*****************************************************************/ 01949000
*   /*                                                               */ 01950000
*   /* SORT THE DHE RECORDS                                          */ 01951000
*   /*                                                               */ 01952000
*   /*****************************************************************/ 01953000
*                                                                  0495 01954000
*RECSORT:                                                          0495 01955000
*   PROC  OPTIONS(SAVE(14));        /*                       @Y30LB54*/ 01956000
RECSORT  ST    @14,12(,@13)                                        0495 01957000
*   PTR5BOT=PTR5CUR-36;             /* LAST RECORD WRITTEN   @Y30LB54*/ 01958000
         L     @15,PTR5CUR(,DHEWKPTR)                              0496 01959000
         SH    @15,@CH00276                                        0496 01960000
         ST    @15,PTR5BOT(,DHEWKPTR)                              0496 01961000
*   PTR5CUR=PTR5TOP;                /* START AT FRONT OF FILE@Y30LB54*/ 01962000
         L     @15,PTR5TOP(,DHEWKPTR)                              0497 01963000
         ST    @15,PTR5CUR(,DHEWKPTR)                              0497 01964000
*   PTRINP=ADDR(DATA04);            /* WORKING AREA FOR COUNTERS   0498 01965000
*                                                            @Y30LB54*/ 01966000
         LA    @14,DATA04(,DHEWKPTR)                               0498 01967000
         ST    @14,PTRINP(,DHEWKPTR)                               0498 01968000
*   DO PTR5CUR=PTR5CUR TO(PTR5BOT-36) BY 36;/*               @Y30LB54*/ 01969000
         B     @DE00499                                            0499 01970000
@DL00499 DS    0H                                                  0500 01971000
*     IF RPT5RCD(2)<RPT5RCD(1) THEN                                0500 01972000
         L     @15,PTR5CUR(,DHEWKPTR)                              0500 01973000
         CLC   RPT5RCD+36(36,@15),RPT5RCD(@15)                     0500 01974000
         BNL   @RF00500                                            0500 01975000
*       DO;                         /*                       @Y30LB54*/ 01976000
*         DATA05=RPT5RCD(1);        /*                       @Y30LB54*/ 01977000
         MVC   DATA05(36,DHEWKPTR),RPT5RCD(@15)                    0502 01978000
*         RPT5RCD(1)=RPT5RCD(2);    /*                       @Y30LB54*/ 01979000
         MVC   RPT5RCD(36,@15),RPT5RCD+36(@15)                     0503 01980000
*         RPT5RCD(2)=DATA05;        /*                       @Y30LB54*/ 01981000
         MVC   RPT5RCD+36(36,@15),DATA05(DHEWKPTR)                 0504 01982000
*         PTR5CUR=PTR5TOP;          /*                       @Y30LB54*/ 01983000
         MVC   PTR5CUR(4,DHEWKPTR),PTR5TOP(DHEWKPTR)               0505 01984000
*       END;                        /*                       @Y30LB54*/ 01985000
*     ELSE                                                         0507 01986000
*       ;                           /*                       @Y30LB54*/ 01987000
@RF00500 DS    0H                                                  0508 01988000
*   END;                            /*                       @Y30LB54*/ 01989000
         LA    @15,36                                              0508 01990000
         AL    @15,PTR5CUR(,DHEWKPTR)                              0508 01991000
         ST    @15,PTR5CUR(,DHEWKPTR)                              0508 01992000
@DE00499 L     @14,PTR5BOT(,DHEWKPTR)                              0508 01993000
         SH    @14,@CH00276                                        0508 01994000
         CR    @15,@14                                             0508 01995000
         BNH   @DL00499                                            0508 01996000
*   END RECSORT;                    /*                       @Y30LB54*/ 01997000
@EL00015 DS    0H                                                  0509 01998000
@EF00015 DS    0H                                                  0509 01999000
@ER00015 L     @14,12(,@13)                                        0509 02000000
         BR    @14                                                 0509 02001000
*                                                                  0510 02002000
*   /*****************************************************************/ 02003000
*   /*                                                               */ 02004000
*   /* FREECORE - ROUTINE TO FREE ALL CORE AQUIRED BY ISDADHE        */ 02005000
*   /*                                                               */ 02006000
*   /*****************************************************************/ 02007000
*                                                                  0510 02008000
*FREECORE:                                                         0510 02009000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB54*/ 02010000
FREECORE ST    @14,@SA00016                                        0510 02011000
*   DO CTR1=1 TO 4 BY 1;            /*                       @Y30LB54*/ 02012000
         LA    @05,1                                               0511 02013000
         ST    @05,CTR1(,DHEWKPTR)                                 0511 02014000
@DL00511 DS    0H                                                  0512 02015000
*     IF LIBPTR(CTR1)^=0 THEN       /* FREE ALL CORE ALREADY OBTAINED   02016000
*                                                            @Y30LB54*/ 02017000
         L     @05,CTR1(,DHEWKPTR)                                 0512 02018000
         SLA   @05,2                                               0512 02019000
         L     @05,LIBPTR-5(@05,DHEWKPTR)                          0512 02020000
         LA    @05,0(,@05)                                         0512 02021000
         LTR   @05,@05                                             0512 02022000
         BZ    @RF00512                                            0512 02023000
*       DO;                         /*                       @Y30LB54*/ 02024000
*         SPNO=0;                   /*                       @Y30LB54*/ 02025000
         MVI   SPNO(CVTPTR),X'00'                                  0514 02026000
*         CORELEN=192+32+768;       /* FILL IN LENGTH OF AREA@Y30LB54*/ 02027000
         MVC   CORELEN(3,CVTPTR),@CF00535+1                        0515 02028000
*         COREADDR=LIBPTR(CTR1);    /* FILL IN ADDRESS OF AREA     0516 02029000
*                                                            @Y30LB54*/ 02030000
         ST    @05,COREADDR(,CVTPTR)                               0516 02031000
*         CALL ISDAFREE(WORKPTR);   /*                       @Y30LB54*/ 02032000
         L     @05,@PC00001                                        0517 02033000
         ST    @05,@AL00001                                        0517 02034000
         L     @15,@CV00042                                        0517 02035000
         LA    @01,@AL00001                                        0517 02036000
         BALR  @14,@15                                             0517 02037000
*         LIBPTR(CTR1)=0;           /* DELETE GOTTEN CORE PTR@Y30LB54*/ 02038000
         L     @05,CTR1(,DHEWKPTR)                                 0518 02039000
         SLA   @05,2                                               0518 02040000
         ALR   @05,DHEWKPTR                                        0518 02041000
         SLR   @15,@15                                             0518 02042000
         STCM  @15,7,LIBPTR-4(@05)                                 0518 02043000
*       END;                        /*                       @Y30LB54*/ 02044000
*     ELSE                                                         0520 02045000
*       ;                           /*                       @Y30LB54*/ 02046000
@RF00512 DS    0H                                                  0521 02047000
*   END;                            /*                       @Y30LB54*/ 02048000
         LA    @05,1                                               0521 02049000
         AL    @05,CTR1(,DHEWKPTR)                                 0521 02050000
         ST    @05,CTR1(,DHEWKPTR)                                 0521 02051000
         CH    @05,@CH00051                                        0521 02052000
         BNH   @DL00511                                            0521 02053000
*   IF PTR5TOP^=0 THEN              /* DO WE HAVE DHE SPACE  @Y30LB54*/ 02054000
         L     @05,PTR5TOP(,DHEWKPTR)                              0522 02055000
         LTR   @05,@05                                             0522 02056000
         BZ    @RF00522                                            0522 02057000
*     DO;                           /*                       @Y30LB54*/ 02058000
*       SPNO=0;                     /*                       @Y30LB54*/ 02059000
         MVI   SPNO(CVTPTR),X'00'                                  0524 02060000
*       CORELEN=50*36;              /*                       @Y30LB54*/ 02061000
         MVC   CORELEN(3,CVTPTR),@CF00536+1                        0525 02062000
*       COREADDR=PTR5TOP;           /*                       @Y30LB54*/ 02063000
         ST    @05,COREADDR(,CVTPTR)                               0526 02064000
*       CALL ISDAFREE(WORKPTR);     /*                       @Y30LB54*/ 02065000
         L     @05,@PC00001                                        0527 02066000
         ST    @05,@AL00001                                        0527 02067000
         L     @15,@CV00042                                        0527 02068000
         LA    @01,@AL00001                                        0527 02069000
         BALR  @14,@15                                             0527 02070000
*       PTR5TOP=0;                  /*                       @Y30LB54*/ 02071000
         SLR   @05,@05                                             0528 02072000
         ST    @05,PTR5TOP(,DHEWKPTR)                              0528 02073000
*       PTR5CUR=0;                  /*                       @Y30LB54*/ 02074000
         ST    @05,PTR5CUR(,DHEWKPTR)                              0529 02075000
*       PTR5BOT=0;                  /*                       @Y30LB54*/ 02076000
         ST    @05,PTR5BOT(,DHEWKPTR)                              0530 02077000
*     END;                          /*                       @Y30LB54*/ 02078000
*   ELSE                                                           0532 02079000
*     ;                             /*                       @Y30LB54*/ 02080000
@RF00522 DS    0H                                                  0533 02081000
*   SPNO=0;                         /* FREE WORKING CORE ALSO@Y30LB54*/ 02082000
         MVI   SPNO(CVTPTR),X'00'                                  0533 02083000
*   CORELEN=LENGTH(WORKCORE);       /* FILL IN LENGTH OF AREA@Y30LB54*/ 02084000
         MVC   CORELEN(3,CVTPTR),@CF00537+1                        0534 02085000
*   COREADDR=DHE00PTR;              /* FILL IN LOCATION ADDRESS    0535 02086000
*                                                            @Y30LB54*/ 02087000
         MVC   COREADDR(4,CVTPTR),DHE00PTR(CVTPTR)                 0535 02088000
*   CALL ISDAFREE(WORKPTR);         /*                       @Y30LB54*/ 02089000
         L     @05,@PC00001                                        0536 02090000
         ST    @05,@AL00001                                        0536 02091000
         L     @15,@CV00042                                        0536 02092000
         LA    @01,@AL00001                                        0536 02093000
         BALR  @14,@15                                             0536 02094000
*   DHE00PTR=0;                     /* TELL THE WORLD WE QUIT@Y30LB54*/ 02095000
         SLR   @05,@05                                             0537 02096000
         ST    @05,DHE00PTR(,CVTPTR)                               0537 02097000
*   RETURN CODE(RETCODE);           /*                       @Y30LB54*/ 02098000
         LR    @15,RETCODE                                         0538 02099000
@EL00016 DS    0H                                                  0538 02100000
@EF00016 DS    0H                                                  0538 02101000
@ER00016 L     @14,@SA00016                                        0538 02102000
         BR    @14                                                 0538 02103000
*   END FREECORE;                   /*                       @Y30LB54*/ 02104000
*   END ISDADHE1                    /*                       @Y30LB54*/ 02105000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 02106000
*/*%INCLUDE SYSLIB  (ISDAPRMS)                                        * 02107000
*/*%INCLUDE SYSLIB  (ISDACVT )                                        * 02108000
*;                                                                 0540 02109000
@DATA    DS    0H                                                       02110000
@CH00051 DC    H'4'                                                     02111000
@CH00141 DC    H'6'                                                     02112000
@CH00294 DC    H'7'                                                     02113000
@CH00155 DC    H'10'                                                    02114000
@CH00191 DC    H'16'                                                    02115000
@CH00515 DC    H'23'                                                    02116000
@CH00121 DC    H'24'                                                    02117000
@CH00172 DC    H'25'                                                    02118000
@CH00276 DC    H'36'                                                    02119000
@CH00374 DC    H'43'                                                    02120000
@CH00337 DC    H'107'                                                   02121000
@DATD    DSECT                                                          02122000
         DS    0F                                                       02123000
@SA00001 DS    18F                                                      02124000
@PC00001 DS    1F                                                       02125000
@SA00002 DS    1F                                                       02126000
@SA00003 DS    1F                                                       02127000
@SA00008 DS    1F                                                       02128000
@SA00009 DS    1F                                                       02129000
@SA00012 DS    1F                                                       02130000
@SA00010 DS    0F                                                       02131000
@SA00016 DS    0F                                                       02132000
@SA00011 DS    0F                                                       02133000
@SA00007 DS    0F                                                       02134000
@SA00006 DS    0F                                                       02135000
         DS    1F                                                       02136000
@AL00001 DS    1A                                                       02137000
@TF00001 DS    F                                                        02138000
ISDADHE1 CSECT                                                          02139000
         DS    0F                                                       02140000
@CF00048 DC    F'1'                                                     02141000
@CH00048 EQU   @CF00048+2                                               02142000
@CF00068 DC    F'3'                                                     02143000
@CH00068 EQU   @CF00068+2                                               02144000
@CF00150 DC    F'5'                                                     02145000
@CH00150 EQU   @CF00150+2                                               02146000
@CF00180 DC    F'20'                                                    02147000
@CH00180 EQU   @CF00180+2                                               02148000
@CF00390 DC    F'28'                                                    02149000
@CF00373 DC    F'33'                                                    02150000
@CF00429 DC    F'62'                                                    02151000
@CF00320 DC    F'74'                                                    02152000
@CF00398 DC    F'100'                                                   02153000
@CF00537 DC    F'336'                                                   02154000
@CF00535 DC    F'992'                                                   02155000
@CF00536 DC    F'1800'                                                  02156000
@CF00382 DC    F'10000'                                                 02157000
@CH00382 EQU   @CF00382+2                                               02158000
@CF00538 DC    F'-4'                                                    02159000
@CF00381 DC    F'-1'                                                    02160000
@CF00506 DC    XL4'00008000'                                            02161000
@CF00507 DC    XL4'00800000'                                            02162000
@DATD    DSECT                                                          02163000
         DS    0D                                                       02164000
         DS    0D                                                       02165000
@TS00001 DS    CL8                                                      02166000
EDRECF   DS    CL10                                                     02167000
CHAR5F   DS    CL5                                                      02168000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                02169000
@ENDDATD EQU   *                                                        02170000
ISDADHE1 CSECT                                                          02171000
         NOPR  ((@ENDDATD-@DATD)/161*16)                                02172000
         DS    0F                                                       02173000
@SIZDATD DC    AL1(0)                                                   02174000
         DC    AL3(@ENDDATD-@DATD)                                      02175000
@CV00040 DC    V(ISDAPRT0)                                              02176000
@CV00042 DC    V(ISDAFREE)                                              02177000
@CV00041 DC    V(ISDATYPE)                                              02178000
         DS    0D                                                       02179000
@CC00361 DC    C'------------------------------------------------------C02180000
               --------------------------------------------------------C02181000
               -----------'                                             02182000
@CC00441 EQU   @CC00361                                                 02183000
@CC00492 DC    C'--|-----|-------|---------|-----------------------|---C02184000
               --------------------|-----------------------|'           02185000
@CC00391 DC    C'|         |         |         |         |         |   C02186000
                     |         |         |         |'                   02187000
@CC00327 DC    C'|   200   |   201   |   202   |   203   |   204   |   C02188000
               205   |   206   |   207   |'                             02189000
@CC00338 DC    C'|---------|---------|---------|---------|---------|---C02190000
               ------|---------|---------|'                             02191000
@CC00351 EQU   @CC00391                                                 02192000
@CC00405 EQU   @CC00361                                                 02193000
@CC00462 DC    C'REPORT 13 - DATA HANDLING ERRORS FOR DRDS - DRD BUFFERC02194000
               ED LOG COUNTER OVERFLOW'                                 02195000
@CC00310 DC    C'REPORT 12 - DATA HANDLING USAGE FOR DRDS - DRD BUFFEREC02196000
               D LOG'                                                   02197000
@CC00424 DC    C'REPORT 12 - LAST FOUR ACTIVE DAYS TRENDING'            02198000
@CC00317 DC    C'(DATA FROM MSS FORMAT 0, MESSAGE CODE 5)'              02199000
@CC00470 DC    C'* INDICATES WHICH COUNTER OVERFLOWED'                  02200000
@CC00402 EQU   @CC00361                                                 02201000
@CC00433 DC    C'READ ERROR RATIO        DATE'                          02202000
@CC00455 DC    C'------NO INPUT DATA------'                             02203000
@CC00388 DC    C'     ERROR USAGE RATIO'                                02204000
@CC00414 DC    C'W - WRITE ERROR RATIO'                                 02205000
@CC00188 DC    C'ERRORS/USAGE = RATIO'                                  02206000
@CC00412 DC    C'R - READ ERROR RATIO'                                  02207000
@CC00416 DC    C'L - LOAD ERROR RATIO'                                  02208000
@CC00437 DC    C'WRITE ERROR RATIO'                                     02209000
@CC00439 DC    C'LOAD ERROR RATIO'                                      02210000
@CC00479 DC    C'STRIPES WRITTEN'                                       02211000
@CC00475 DC    C'STRIPES READ'                                          02212000
@CC00346 EQU   @CC00361                                                 02213000
@CC00324 DC    C'DRD SSID'                                              02214000
@CC00484 DC    C'NO  SSID'                                              02215000
@CC00411 DC    C'LEGEND:'                                               02216000
@CC00473 DC    C'MSF DRD'                                               02217000
@CC00335 DC    C'TOTALS'                                                02218000
@CC00483 EQU   @CC00439                                                 02219000
@CC00486 DC    C'DATE'                                                  02220000
@CC00488 DC    C'TIME'                                                  02221000
@CC00153 DC    C'DHE'                                                   02222000
@CC00308 EQU   @CC00473                                                 02223000
@CB00383 DC    X'00000000'                                              02224000
EDPAT    DC    X'40202020202020202120'                                  02225000
EDPAT1   DC    X'4020202020214B202020'                                  02226000
EDPAT3   DC    X'402021202061202020'                                    02227000
EDPAT4   DC    X'4021207A20207A202020'                                  02228000
PATCH    DC    50X'00'                                                  02229000
         DS    CL1                                                      02230000
BYTECODE DC    XL3'0'                                                   02231000
         DC    C'R'                                                     02232000
         DC    XL3'0'                                                   02233000
         DC    C'W'                                                     02234000
         DC    XL3'0'                                                   02235000
         DC    C'L'                                                     02236000
BODY1    DC    CL10'     READ '                                         02237000
         DC    CL10'     WRITE'                                         02238000
         DC    CL10'     LOAD '                                         02239000
BODY2    DC    CL25'STRIPE SOFT READ ERRORS'                            02240000
         DC    CL25'STRIPE SOFT WRITE ERRORS'                           02241000
         DC    CL25'SOFT LOAD ERRORS'                                   02242000
BODY3    DC    CL20'STRIPE READ USAGE'                                  02243000
         DC    CL20'STRIPE WRITE USAGE'                                 02244000
         DC    CL20'LOAD USAGE'                                         02245000
BODY4    DC    CL20'ERRORS/USAGE = RATIO'                               02246000
         DC    CL20'ERRORS/USAGE = RATIO'                               02247000
         DC    CL20'ERRORS/USAGE = RATIO'                               02248000
HEXREP   DC    CL1'0'                                                   02249000
         DC    CL1'1'                                                   02250000
         DC    CL1'2'                                                   02251000
         DC    CL1'3'                                                   02252000
         DC    CL1'4'                                                   02253000
         DC    CL1'5'                                                   02254000
         DC    CL1'6'                                                   02255000
         DC    CL1'7'                                                   02256000
         DC    CL1'8'                                                   02257000
         DC    CL1'9'                                                   02258000
         DC    CL1'A'                                                   02259000
         DC    CL1'B'                                                   02260000
         DC    CL1'C'                                                   02261000
         DC    CL1'D'                                                   02262000
         DC    CL1'E'                                                   02263000
         DC    CL1'F'                                                   02264000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       02265000
@01      EQU   01                                                       02266000
@02      EQU   02                                                       02267000
@03      EQU   03                                                       02268000
@04      EQU   04                                                       02269000
@05      EQU   05                                                       02270000
@06      EQU   06                                                       02271000
@07      EQU   07                                                       02272000
@08      EQU   08                                                       02273000
@09      EQU   09                                                       02274000
@10      EQU   10                                                       02275000
@11      EQU   11                                                       02276000
@12      EQU   12                                                       02277000
@13      EQU   13                                                       02278000
@14      EQU   14                                                       02279000
@15      EQU   15                                                       02280000
DHEWKPTR EQU   @03                                                      02281000
RETCODE2 EQU   @05                                                      02282000
RETCODE1 EQU   @07                                                      02283000
RETCODE  EQU   @04                                                      02284000
LPARMPTR EQU   @06                                                      02285000
CVTPTR   EQU   @02                                                      02286000
R1       EQU   @01                                                      02287000
R0       EQU   @00                                                      02288000
R15      EQU   @15                                                      02289000
ISDAPRMS EQU   0                                                        02290000
CINPUT   EQU   ISDAPRMS                                                 02291000
CSTART   EQU   ISDAPRMS+2                                               02292000
CEND     EQU   ISDAPRMS+6                                               02293000
CFSCONLY EQU   ISDAPRMS+13                                              02294000
CSSIDF   EQU   ISDAPRMS+17                                              02295000
CSERIAL  EQU   ISDAPRMS+21                                              02296000
CREPORTS EQU   ISDAPRMS+33                                              02297000
CDHEDHU  EQU   CREPORTS+3                                               02298000
ISDACVT  EQU   0                                                        02299000
CVTPTRS0 EQU   ISDACVT                                                  02300000
PARMPTR  EQU   CVTPTRS0+8                                               02301000
DHE00PTR EQU   CVTPTRS0+52                                              02302000
GET0CALL EQU   ISDACVT+100                                              02303000
SPNOLEN  EQU   GET0CALL                                                 02304000
SPNO     EQU   SPNOLEN                                                  02305000
CORELEN  EQU   SPNOLEN+1                                                02306000
COREADDR EQU   GET0CALL+4                                               02307000
HEXPCALL EQU   ISDACVT+108                                              02308000
PRT0CALL EQU   ISDACVT+120                                              02309000
OUTLINE  EQU   PRT0CALL                                                 02310000
ANSI     EQU   OUTLINE                                                  02311000
LINE     EQU   OUTLINE+1                                                02312000
SDARPTID EQU   PRT0CALL+133                                             02313000
SDADATD  EQU   ISDACVT+256                                              02314000
PRTDATD  EQU   ISDACVT+416                                              02315000
RPT5RCD  EQU   0                                                        02316000
RPT5LIB  EQU   RPT5RCD                                                  02317000
RPT5DATE EQU   RPT5RCD+1                                                02318000
RPT5SSID EQU   RPT5RCD+9                                                02319000
RPT5CTRS EQU   RPT5RCD+12                                               02320000
INPUTCTR EQU   0                                                        02321000
INCTR    EQU   INPUTCTR                                                 02322000
COUNTER  EQU   0                                                        02323000
WORKCORE EQU   0                                                        02324000
LIBTAB   EQU   WORKCORE+4                                               02325000
LIBNO    EQU   LIBTAB                                                   02326000
LIBPTR   EQU   LIBTAB+1                                                 02327000
FULLWD1  EQU   WORKCORE+20                                              02328000
FULLWD2  EQU   WORKCORE+24                                              02329000
DATASSID EQU   WORKCORE+28                                              02330000
KICKPTR  EQU   WORKCORE+36                                              02331000
PTRRPT   EQU   WORKCORE+40                                              02332000
PTRSSID  EQU   WORKCORE+48                                              02333000
PTRDATE  EQU   WORKCORE+52                                              02334000
PTRINP   EQU   WORKCORE+56                                              02335000
CTR      EQU   WORKCORE+60                                              02336000
CTR1     EQU   WORKCORE+64                                              02337000
CHAR4    EQU   WORKCORE+68                                              02338000
COUNTRP4 EQU   WORKCORE+72                                              02339000
COUNTRP5 EQU   WORKCORE+80                                              02340000
DATETBL  EQU   WORKCORE+84                                              02341000
DATEYYDD EQU   DATETBL                                                  02342000
DATEOFST EQU   DATETBL+4                                                02343000
PTR5TOP  EQU   WORKCORE+124                                             02344000
PTR5CUR  EQU   WORKCORE+128                                             02345000
PTR5BOT  EQU   WORKCORE+132                                             02346000
LIBCTR   EQU   WORKCORE+136                                             02347000
GRANDU   EQU   WORKCORE+140                                             02348000
GRANDE   EQU   WORKCORE+144                                             02349000
RATCTR   EQU   WORKCORE+148                                             02350000
RATIOTBL EQU   WORKCORE+152                                             02351000
RATCNT   EQU   RATIOTBL                                                 02352000
RATSSID  EQU   RATIOTBL+2                                               02353000
RATCODE  EQU   RATIOTBL+3                                               02354000
DATA04   EQU   WORKCORE+248                                             02355000
DATA05   EQU   WORKCORE+272                                             02356000
SORTSW   EQU   WORKCORE+309                                             02357000
FOURBITS EQU   WORKCORE+310                                             02358000
EDREC    EQU   WORKCORE+311                                             02359000
EDREC1   EQU   WORKCORE+321                                             02360000
CHAR5    EQU   WORKCORE+330                                             02361000
WORKPTR  EQU   0                                                        02362000
BYTESSID EQU   DATASSID+3                                               02363000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    02364000
ENDAREA  EQU   WORKCORE+335                                             02365000
DATAWORK EQU   WORKCORE+308                                             02366000
COUNTR4A EQU   WORKCORE+76                                              02367000
PTRLIB   EQU   WORKCORE+44                                              02368000
DATALIB  EQU   WORKCORE+32                                              02369000
LOGPTR   EQU   WORKCORE                                                 02370000
COUNT    EQU   COUNTER                                                  02371000
@NM00003 EQU   RPT5RCD+10                                               02372000
PRTSA001 EQU   PRTDATD                                                  02373000
SDATEMPS EQU   SDADATD+136                                              02374000
SDASA002 EQU   SDADATD+76                                               02375000
SDAPC001 EQU   SDADATD+72                                               02376000
SDASA001 EQU   SDADATD                                                  02377000
DUMPIDNO EQU   HEXPCALL+8                                               02378000
DUMPLEN  EQU   HEXPCALL+4                                               02379000
DUMPADDR EQU   HEXPCALL                                                 02380000
WORKCALL EQU   CVTPTRS0+96                                              02381000
GEN00PTR EQU   CVTPTRS0+92                                              02382000
CNFG0PTR EQU   CVTPTRS0+88                                              02383000
PWR00PTR EQU   CVTPTRS0+84                                              02384000
APR00PTR EQU   CVTPTRS0+80                                              02385000
DRC00PTR EQU   CVTPTRS0+76                                              02386000
DAT00PTR EQU   CVTPTRS0+72                                              02387000
CSB00PTR EQU   CVTPTRS0+68                                              02388000
DCK00PTR EQU   CVTPTRS0+64                                              02389000
EQC00PTR EQU   CVTPTRS0+60                                              02390000
FSC00PTR EQU   CVTPTRS0+56                                              02391000
SUM00PTR EQU   CVTPTRS0+48                                              02392000
PAD00PTR EQU   CVTPTRS0+44                                              02393000
DCS00PTR EQU   CVTPTRS0+40                                              02394000
LOG00PTR EQU   CVTPTRS0+36                                              02395000
HIST0PTR EQU   CVTPTRS0+32                                              02396000
PRT00PTR EQU   CVTPTRS0+28                                              02397000
GET00PTR EQU   CVTPTRS0+24                                              02398000
TYPE0PTR EQU   CVTPTRS0+20                                              02399000
PARM0PTR EQU   CVTPTRS0+16                                              02400000
SDA00PTR EQU   CVTPTRS0+12                                              02401000
SDATAPTR EQU   CVTPTRS0+4                                               02402000
DATAPTR  EQU   CVTPTRS0                                                 02403000
CTRACE   EQU   ISDAPRMS+48                                              02404000
CGEN     EQU   ISDAPRMS+47                                              02405000
CDETAIL  EQU   ISDAPRMS+46                                              02406000
CPERIOD  EQU   ISDAPRMS+45                                              02407000
CPWR     EQU   CREPORTS+11                                              02408000
CAPRSUU  EQU   CREPORTS+10                                              02409000
CDRC     EQU   CREPORTS+9                                               02410000
CDAT     EQU   CREPORTS+8                                               02411000
CCSBCSF  EQU   CREPORTS+7                                               02412000
CDCKTLX  EQU   CREPORTS+6                                               02413000
CEQC     EQU   CREPORTS+5                                               02414000
CFSC     EQU   CREPORTS+4                                               02415000
CSUM     EQU   CREPORTS+2                                               02416000
CPAD     EQU   CREPORTS+1                                               02417000
CDCS     EQU   CREPORTS                                                 02418000
CSERNO   EQU   CSERIAL+4                                                02419000
@NM00002 EQU   CSERIAL+3                                                02420000
CIBM     EQU   CSERIAL                                                  02421000
CRATIO   EQU   ISDAPRMS+19                                              02422000
CSSID    EQU   CSSIDF                                                   02423000
@NM00001 EQU   CSSIDF                                                   02424000
CFSC34   EQU   CFSCONLY+2                                               02425000
CFSC12   EQU   CFSCONLY                                                 02426000
CTYPE    EQU   ISDAPRMS+11                                              02427000
CSUMMARY EQU   ISDAPRMS+10                                              02428000
CENDDAY  EQU   CEND+2                                                   02429000
CENDYEAR EQU   CEND                                                     02430000
CSTDAY   EQU   CSTART+2                                                 02431000
CSTYEAR  EQU   CSTART                                                   02432000
CHISTIN  EQU   CINPUT+1                                                 02433000
CLOGIN   EQU   CINPUT                                                   02434000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      02435000
@RC00078 EQU   @RC00077                                                 02436000
@RT00250 EQU   @EL00006                                                 02437000
@RT00260 EQU   @EL00006                                                 02438000
@RC00079 EQU   @RC00078                                                 02439000
@RC00080 EQU   @RC00079                                                 02440000
@ENDDATA EQU   *                                                        02441000
         END   ISDADHE1,(C'PLS1807',0701,78044)                         02442000
