         TITLE 'DRC EQUIPMENT CHECKS ACCUMULATOR                       *00001000
                        '                                               00002000
ISDADRC0 CSECT ,                                                01S0001 00003000
@MAINENT DS    0H                                               01S0001 00004000
         USING *,@15                                            01S0001 00005000
         B     @PROLOG                                          01S0001 00006000
         DC    AL1(8)                                           01S0001 00007000
         DC    C'ISDADRC0'                                      01S0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                  01S0001 00010000
         BALR  @12,0                                            01S0001 00011000
@PSTART  DS    0H                                               01S0001 00012000
         USING @PSTART,@12                                      01S0001 00013000
         L     @00,@SIZDATD                                     01S0001 00014000
         ISDAGSPC R,LV=(0)                                              00015000
         LR    @11,@01                                          01S0001 00016000
         USING @DATD,@11                                        01S0001 00017000
         ST    @13,@SA00001+4                                   01S0001 00018000
         LM    @00,@01,20(@13)                                  01S0001 00019000
         ST    @11,8(,@13)                                      01S0001 00020000
         LR    @13,@11                                          01S0001 00021000
         MVC   @PC00001(4),0(@01)                               01S0001 00022000
*                                                               01S0026 00023000
*   /*****************************************************************/ 00024000
*   /*                                                               */ 00025000
*   /* END OF ISDADRC0 DECLARES                              @Y30LB50*/ 00026000
*   /*                                                               */ 00027000
*   /*****************************************************************/ 00028000
*                                                               01S0027 00029000
*                                                               01S0027 00030000
*   /*****************************************************************/ 00031000
*   /*                                                               */ 00032000
*   /* START OF ISDADRC0 MAIN PROGRAM                        @Y30LB50*/ 00033000
*   /*                                                               */ 00034000
*   /*****************************************************************/ 00035000
*                                                               01S0027 00036000
*   CVTPTR=WORKPTR;                 /* SAVE CALLING PARAMETER-PTR TO    00037000
*                                      SDACVT                @Y30LB50*/ 00038000
         L     @05,@PC00001                                     01S0027 00039000
         L     CVTPTR,WORKPTR(,@05)                             01S0027 00040000
*   LPARMPTR=PARMPTR;               /* SET PTR TO SDA PARMS  @ZM30983*/ 00041000
         L     LPARMPTR,PARMPTR(,CVTPTR)                        01S0028 00042000
*   RETRNREG=0;                     /* SET RETURN CODE REGISTER TO 0    00043000
*                                                            @Y30LB50*/ 00044000
         SLR   @05,@05                                          01S0029 00045000
         LR    RETRNREG,@05                                     01S0029 00046000
*   IF DRC00PTR=0 THEN              /* IF DRC WORK POINTER IF SDACVT    00047000
*                                      IS 0, THIS IS THE INITIAL CALL   00048000
*                                                            @Y30LB50*/ 00049000
         C     @05,DRC00PTR(,CVTPTR)                            01S0030 00050000
         BNE   @RF00030                                         01S0030 00051000
*                                                               02S0031 00052000
*   /*****************************************************************/ 00053000
*   /*                                                               */ 00054000
*   /* DRCINIT IS USED TO OBTAIN AND INITIALIZE A WORKAREA FOR DRC   */ 00055000
*   /* PROCESSING                                            @Y30LB50*/ 00056000
*   /*                                                               */ 00057000
*   /*****************************************************************/ 00058000
*                                                               02S0031 00059000
*   DO;                             /*                       @Y30LB50*/ 00060000
*     RFY                                                       02S0032 00061000
*      (R0,                                                     02S0032 00062000
*       R1) RSTD;                   /*                       @Y30LB50*/ 00063000
*     SPNO=DRCSPNO;                 /* SUBPOOL NUMBER FOR DRC   02S0033 00064000
*                                      WORKAREA REQUEST      @Y30LB50*/ 00065000
         MVC   SPNO(1,CVTPTR),DRCSPNO                           02S0033 00066000
*     CORELEN=LENGTH(DRCWORK);      /* LENGTH OF WORKAREA FOR DRC       00067000
*                                      PROCESSING            @Y30LB50*/ 00068000
         MVC   CORELEN(3,CVTPTR),@CF00097+1                     02S0034 00069000
*     R1=ADDR(WORKCALL);            /*                       @Y30LB50*/ 00070000
         LA    R1,WORKCALL(,CVTPTR)                             02S0035 00071000
*     CALL ISDAGET1;                /* REQUEST WORKAREA      @Y30LB50*/ 00072000
         L     @15,@CV00252                                     02S0036 00073000
         BALR  @14,@15                                          02S0036 00074000
*     RFY                                                       02S0037 00075000
*       R15 RSTD;                   /*                       @Y30LB50*/ 00076000
*     RETRNREG=R15;                 /* SAVE RETURN REGISTER  @Y30LB50*/ 00077000
         LR    RETRNREG,R15                                     02S0038 00078000
*     RFY                                                       02S0039 00079000
*      (R1,                                                     02S0039 00080000
*       R15) UNRSTD;                /*                       @Y30LB50*/ 00081000
*     IF RETRNREG=0 THEN                                        02S0040 00082000
         LTR   RETRNREG,RETRNREG                                02S0040 00083000
         BNZ   @RF00040                                         02S0040 00084000
*       DO;                         /* CONTINUE IF WORKAREA OBTAINED    00085000
*                                                            @Y30LB50*/ 00086000
*         DRC00PTR=COREADDR;        /* SET DRC WORK AREA PTR INTO       00087000
*                                      SDACVT                @Y30LB50*/ 00088000
         L     @05,COREADDR(,CVTPTR)                            02S0042 00089000
         ST    @05,DRC00PTR(,CVTPTR)                            02S0042 00090000
*         DRCPTR=COREADDR;          /* SET LOCAL POINTER TO DRC WORK    00091000
*                                      AREA                  @Y30LB50*/ 00092000
         LR    DRCPTR,@05                                       02S0043 00093000
*         DRCWORK=''B;              /* ZERO THE WORKAREA     @Y30LB50*/ 00094000
         XC    DRCWORK(40,DRCPTR),DRCWORK(DRCPTR)               02S0044 00095000
*       END;                        /*                       @Y30LB50*/ 00096000
*     ELSE                          /* BAD RETURN FROM GET1  @ZM30983*/ 00097000
*       CDRC='00'X;                 /* SET NO CALL FLAG      @ZM30983*/ 00098000
         B     @RC00040                                         02S0046 00099000
@RF00040 MVI   CDRC(LPARMPTR),X'00'                             02S0046 00100000
*   END;                            /*                       @Y30LB50*/ 00101000
*   ELSE                                                        01S0048 00102000
*     ;                             /*                       @Y30LB50*/ 00103000
@RF00030 DS    0H                                               01S0049 00104000
*   IF RETRNREG=0 THEN                                          01S0049 00105000
@RC00030 SLR   @05,@05                                          01S0049 00106000
         CR    RETRNREG,@05                                     01S0049 00107000
         BNE   @RF00049                                         01S0049 00108000
*     DO;                           /* IF WORKAREA WAS OBTAINED 01S0050 00109000
*                                                            @Y30LB50*/ 00110000
*       DRCPTR=DRC00PTR;            /* SET LOCAL POINTER TO DRC 01S0051 00111000
*                                      WORKAREA              @Y30LB50*/ 00112000
         L     DRCPTR,DRC00PTR(,CVTPTR)                         01S0051 00113000
*       SENSEPTR=SDATAPTR;          /* SAVE PTR TO FMT4 SENSE DATA      00114000
*                                      INPUT                 @Y30LB50*/ 00115000
         L     SENSEPTR,SDATAPTR(,CVTPTR)                       01S0052 00116000
*       IF SSIDTYPE=DRCSSID THEN                                01S0053 00117000
         TM    SSIDTYPE(SENSEPTR),B'00000100'                   01S0053 00118000
         BNO   @RF00053                                         01S0053 00119000
         TM    SSIDTYPE(SENSEPTR),B'00001011'                   01S0053 00120000
         BNZ   @RF00053                                         01S0053 00121000
*         DO;                       /* PROCESS DRC SSID ONLY @Y30LB50*/ 00122000
*                                                               02S0055 00123000
*   /*****************************************************************/ 00124000
*   /*                                                               */ 00125000
*   /* DRCCSCHK IS CALLED TO INITIALIZE THE POINTER TO THE           */ 00126000
*   /* ACCUMULATOR BLOCK FOR THE CARTRIDGE STORE OF THE CURRENT      */ 00127000
*   /* INPUT. IT WILL ALSO CALL ISDAGET1 TO OBTAIN THE ACCUMULATOR   */ 00128000
*   /* BLOCK THE FIRST TIME A CARTRIDGE STORE IS ENCOUNTERED @Y30LB50*/ 00129000
*   /*                                                               */ 00130000
*   /*****************************************************************/ 00131000
*                                                               02S0055 00132000
*   CSNUMB=SUBSYSID;                /* ISOLATE CARTRIDGE STORE OF       00133000
*                                      INPUT                 @Y30LB50*/ 00134000
         MVC   CSNUMB(2,DRCPTR),SUBSYSID(SENSEPTR)              02S0055 00135000
*   CSNUMB=CSNUMB&'00F0'X;          /*                       @Y30LB50*/ 00136000
         NC    CSNUMB(2,DRCPTR),@CB00264                        02S0056 00137000
*   SRA(CSNUMB(2),4);               /*                       @Y30LB50*/ 00138000
         SLR   @01,@01                                          02S0057 00139000
         IC    @01,CSNUMB+1(,DRCPTR)                            02S0057 00140000
         SRA   @01,4                                            02S0057 00141000
         STC   @01,CSNUMB+1(,DRCPTR)                            02S0057 00142000
*   CSNUMB=CSNUMB+1;                /* CONVERT TO INDEX OF 1 TO 4       00143000
*                                                            @Y30LB50*/ 00144000
         LA    @01,1                                            02S0058 00145000
         SLR   @15,@15                                          02S0058 00146000
         ICM   @15,3,CSNUMB(DRCPTR)                             02S0058 00147000
         ALR   @01,@15                                          02S0058 00148000
         STH   @01,CSNUMB(,DRCPTR)                              02S0058 00149000
*   CSPTR=CSPTRS(CSNUMB);           /* PICK UP ACCUMULATOR ADDRESS      00150000
*                                      FOR THIS CS           @Y30LB50*/ 00151000
         SLA   @01,2                                            02S0059 00152000
         AL    @01,@CF00269                                     02S0059 00153000
         L     CSPTR,CSPTRS(@01,DRCPTR)                         02S0059 00154000
*   IF CSPTR=0 THEN                                             02S0060 00155000
         CR    CSPTR,@05                                        02S0060 00156000
         BNE   @RF00060                                         02S0060 00157000
*     DO;                           /* IF ADDRESS IS 0 , NO     02S0061 00158000
*                                      ACCUMULATOR HAS BEEN OBTAINED    00159000
*                                      FOR THIS CS PREVIOUSLY   02S0061 00160000
*                                                            @Y30LB50*/ 00161000
*       SPNO=DRCSPNO;               /* SUBPOOL NUMBER FOR DRC   02S0062 00162000
*                                      ACCUMULATOR BLK       @Y30LB50*/ 00163000
         MVC   SPNO(1,CVTPTR),DRCSPNO                           02S0062 00164000
*       CORELEN=LENGTH(DRCACCM);    /* LENGTH OF BLOCK NEEDED   02S0063 00165000
*                                                            @Y30LB50*/ 00166000
         MVC   CORELEN(3,CVTPTR),@CF00268+1                     02S0063 00167000
*       RFY                                                     02S0064 00168000
*         R1 RSTD;                  /*                       @Y30LB50*/ 00169000
*       R1=ADDR(WORKCALL);          /*                       @Y30LB50*/ 00170000
         LA    R1,WORKCALL(,CVTPTR)                             02S0065 00171000
*       CALL ISDAGET1;              /* REQUEST ACCUMULATOR BLOCK        00172000
*                                                            @Y30LB50*/ 00173000
         L     @15,@CV00252                                     02S0066 00174000
         BALR  @14,@15                                          02S0066 00175000
*       RFY                                                     02S0067 00176000
*         R1 UNRSTD;                /*                       @Y30LB50*/ 00177000
*       RFY                                                     02S0068 00178000
*         R15 RSTD;                 /*                       @Y30LB50*/ 00179000
*       RETRNREG=R15;               /* SAVE RETURN CODE FROM ISDAGET1   00180000
*                                                            @Y30LB50*/ 00181000
         LR    RETRNREG,R15                                     02S0069 00182000
*       RFY                                                     02S0070 00183000
*         R15 UNRSTD;               /*                       @Y30LB50*/ 00184000
*       IF RETRNREG=0 THEN                                      02S0071 00185000
         LTR   RETRNREG,RETRNREG                                02S0071 00186000
         BNZ   @RF00071                                         02S0071 00187000
*         DO;                       /* CONTINUE ONLY IF BLOCK   02S0072 00188000
*                                      OBTAINED              @Y30LB50*/ 00189000
*           CSPTR=COREADDR;         /* SAVE PTR TO ACCUMULATOR IN       00190000
*                                      WORK AREA             @Y30LB50*/ 00191000
         L     CSPTR,COREADDR(,CVTPTR)                          02S0073 00192000
*           CSPTRS(CSNUMB)=CSPTR;   /*                       @Y30LB50*/ 00193000
         SLR   @05,@05                                          02S0074 00194000
         ICM   @05,3,CSNUMB(DRCPTR)                             02S0074 00195000
         SLA   @05,2                                            02S0074 00196000
         AL    @05,@CF00269                                     02S0074 00197000
         ST    CSPTR,CSPTRS(@05,DRCPTR)                         02S0074 00198000
*           DRCACCM=''B;            /* ZERO THE ACCUMULATOR  @Y30LB50*/ 00199000
         XC    DRCACCM(256,CSPTR),DRCACCM(CSPTR)                02S0075 00200000
*         END;                      /*                       @Y30LB50*/ 00201000
*       ELSE                                                    02S0077 00202000
*         ;                         /*                       @Y30LB50*/ 00203000
@RF00071 DS    0H                                               02S0078 00204000
*     END;                          /*                       @Y30LB50*/ 00205000
*   ELSE                                                        02S0079 00206000
*     ;                             /*                       @Y30LB50*/ 00207000
@RF00060 DS    0H                                               02S0080 00208000
*           IF RETRNREG=0 THEN      /* IF REQUESTED ACCUMULATOR COULD   00209000
*                                      NOT BE OBTAINED, DO NOT  01S0080 00210000
*                                      PROCESS FURTHUR       @Y30LB50*/ 00211000
         LTR   RETRNREG,RETRNREG                                01S0080 00212000
         BNZ   @RF00080                                         01S0080 00213000
*                                                               02S0081 00214000
*   /*****************************************************************/ 00215000
*   /*                                                               */ 00216000
*   /* DRCCNTS IS USED TO MAINTAIN RUNNING COUNTS OF HOW MANY TIMES  */ 00217000
*   /* BITS IN MSC FORMAT 4 SENSE BYTES 4, 20, 21 AND 22 ARE         */ 00218000
*   /* ENCOUNTERED SET                                       @Y30LB50*/ 00219000
*   /*                                                               */ 00220000
*   /*****************************************************************/ 00221000
*                                                               02S0081 00222000
*   DO;                             /*                       @Y30LB50*/ 00223000
*     CSNUMB=SUBSYSID;              /* ISOLATE THE DRC ID    @Y30LB50*/ 00224000
         MVC   CSNUMB(2,DRCPTR),SUBSYSID(SENSEPTR)              02S0082 00225000
*     CSNUMB=CSNUMB&'000F'X;        /*                       @Y30LB50*/ 00226000
         NC    CSNUMB(2,DRCPTR),@CB00266                        02S0083 00227000
*     CSPTR=CSPTR+(CSNUMB*2);       /* SPACE UP IN ACCUMULATOR FOR      00228000
*                                      THIS DRC--NOTE EACH DRC HAS A    00229000
*                                      2-BYTE COUNT PER BIT  @Y30LB50*/ 00230000
         SLR   @01,@01                                          02S0084 00231000
         ICM   @01,3,CSNUMB(DRCPTR)                             02S0084 00232000
         ALR   @01,@01                                          02S0084 00233000
         ALR   CSPTR,@01                                        02S0084 00234000
*     WORK1(1)=STATUS14;            /* COMPACT SENSE BYTES TO BE        00235000
*                                      EXAMINED              @Y30LB50*/ 00236000
         MVC   WORK1(1,DRCPTR),STATUS14(SENSEPTR)               02S0085 00237000
*     WORK1(2)=BYTE16F4;            /*                       @Y30LB50*/ 00238000
         MVC   WORK1+1(1,DRCPTR),BYTE16F4(SENSEPTR)             02S0086 00239000
*     WORK1(3)=BYTE17F4;            /*                       @Y30LB50*/ 00240000
         MVC   WORK1+2(1,DRCPTR),BYTE17F4(SENSEPTR)             02S0087 00241000
*     WORK1(4)=BYTE18F4;            /*                       @Y30LB50*/ 00242000
         MVC   WORK1+3(1,DRCPTR),BYTE18F4(SENSEPTR)             02S0088 00243000
*     DO I=1 TO MAXBITS;            /* EXAMINE EACH BIT OF THE DRC      00244000
*                                      BYTES                 @Y30LB50*/ 00245000
         LA    @03,1                                            02S0089 00246000
         STH   @03,I(,DRCPTR)                                   02S0089 00247000
@DL00089 DS    0H                                               02S0090 00248000
*       IF CURRBIT=ON THEN                                      02S0090 00249000
         TM    CURRBIT(DRCPTR),B'10000000'                      02S0090 00250000
         BNO   @RF00090                                         02S0090 00251000
*         BYTEBIT=BYTEBIT+1;        /* IF BIT IS SET, INCREMENT THE     00252000
*                                      BIT COUNT FOR THIS DRC   02S0091 00253000
*                                                            @Y30LB50*/ 00254000
         LA    @03,1                                            02S0091 00255000
         AH    @03,BYTEBIT(,CSPTR)                              02S0091 00256000
         STH   @03,BYTEBIT(,CSPTR)                              02S0091 00257000
*       ELSE                                                    02S0092 00258000
*         ;                         /*                       @Y30LB50*/ 00259000
@RF00090 DS    0H                                               02S0093 00260000
*       SLL(WORK1,1);               /* POSITION NEXT BIT     @Y30LB50*/ 00261000
         L     @03,WORK1(,DRCPTR)                               02S0093 00262000
         SLL   @03,1                                            02S0093 00263000
         ST    @03,WORK1(,DRCPTR)                               02S0093 00264000
*       CSPTR=CSPTR+LENGTH(BIT0);   /* UP POINTER TO BIT COUNT FOR      00265000
*                                      NEXT BIT FOR THIS DRC @Y30LB50*/ 00266000
         AH    CSPTR,@CH00070                                   02S0094 00267000
*     END;                          /*                       @Y30LB50*/ 00268000
         LA    @03,1                                            02S0095 00269000
         AH    @03,I(,DRCPTR)                                   02S0095 00270000
         STH   @03,I(,DRCPTR)                                   02S0095 00271000
         CH    @03,@CH00257                                     02S0095 00272000
         BNH   @DL00089                                         02S0095 00273000
*   END;                            /*                       @Y30LB50*/ 00274000
*           ELSE                                                01S0097 00275000
*                                                               02S0097 00276000
*   /*****************************************************************/ 00277000
*   /*                                                               */ 00278000
*   /* THIS ROUTINE WILL RELEASE ALL WORKING STORAGE VIA THE ISDAFREE*/ 00279000
*   /* ROUTINE.                                                      */ 00280000
*   /*                                                               */ 00281000
*   /*****************************************************************/ 00282000
*                                                               02S0097 00283000
*   DO;                             /*                       @Y30LB50*/ 00284000
         B     @RC00080                                         02S0097 00285000
@RF00080 DS    0H                                               02S0098 00286000
*   RFY                                                         02S0098 00287000
*     R1 RSTD;                      /*                       @Y30LB50*/ 00288000
*     DO I=1 TO MAXCS;              /* RELEASE BLOCKS FOR ALL CS        00289000
*                                                            @Y30LB50*/ 00290000
         LA    @05,1                                            02S0099 00291000
         STH   @05,I(,DRCPTR)                                   02S0099 00292000
@DL00099 DS    0H                                               02S0100 00293000
*       COREADDR=CSPTRS(I);         /* ADDR OF ACCUM FOR THIS CS        00294000
*                                                            @Y30LB50*/ 00295000
         LH    @05,I(,DRCPTR)                                   02S0100 00296000
         SLA   @05,2                                            02S0100 00297000
         AL    @05,@CF00269                                     02S0100 00298000
         L     @05,CSPTRS(@05,DRCPTR)                           02S0100 00299000
         ST    @05,COREADDR(,CVTPTR)                            02S0100 00300000
*       IF COREADDR^=0 THEN                                     02S0101 00301000
         LTR   @05,@05                                          02S0101 00302000
         BZ    @RF00101                                         02S0101 00303000
*         DO;                       /* RELEASE PROCESSING IF ACCUM      00304000
*                                      OBTAINED              @Y30LB50*/ 00305000
*           SPNO=DRCSPNO;           /* SUBPOOL NUMBER OF DRC ACCUM      00306000
*                                                            @Y30LB50*/ 00307000
         MVC   SPNO(1,CVTPTR),DRCSPNO                           02S0103 00308000
*           CORELEN=LENGTH(DRCACCM);/* LENGTH OF DRC ACCUM   @Y30LB50*/ 00309000
         MVC   CORELEN(3,CVTPTR),@CF00268+1                     02S0104 00310000
*           R1=ADDR(WORKCALL);      /*                       @Y30LB50*/ 00311000
         LA    R1,WORKCALL(,CVTPTR)                             02S0105 00312000
*           CALL ISDAFREE;          /* FREE ACCUM BLOCK      @Y30LB50*/ 00313000
         L     @15,@CV00253                                     02S0106 00314000
         BALR  @14,@15                                          02S0106 00315000
*         END;                      /*                       @Y30LB50*/ 00316000
*           ELSE                                                02S0108 00317000
*             ;                     /*                       @Y30LB50*/ 00318000
@RF00101 DS    0H                                               02S0109 00319000
*         END;                      /*                       @Y30LB50*/ 00320000
         LA    @05,1                                            02S0109 00321000
         AH    @05,I(,DRCPTR)                                   02S0109 00322000
         STH   @05,I(,DRCPTR)                                   02S0109 00323000
         CH    @05,@CH00104                                     02S0109 00324000
         BNH   @DL00099                                         02S0109 00325000
*       CDRC='00'X;                 /* SHUT OFF DRC REPORT CONTROL      00326000
*                                      FLAG                  @Y30LB50*/ 00327000
         MVI   CDRC(LPARMPTR),X'00'                             02S0110 00328000
*       R1=ADDR(WORKCALL);          /*                       @Y30LB50*/ 00329000
         LA    R1,WORKCALL(,CVTPTR)                             02S0111 00330000
*       CORELEN=LENGTH(DRCWORK);    /* LENGTH OF WORKAREA    @Y30LB50*/ 00331000
         MVC   CORELEN(3,CVTPTR),@CF00097+1                     02S0112 00332000
*       SPNO=DRCSPNO;               /* SUBPOOL NUMBER OF WORKAREA       00333000
*                                                            @Y30LB50*/ 00334000
         MVC   SPNO(1,CVTPTR),DRCSPNO                           02S0113 00335000
*       COREADDR=DRCPTR;            /* ADDR OF WORKAREA      @Y30LB50*/ 00336000
         ST    DRCPTR,COREADDR(,CVTPTR)                         02S0114 00337000
*       CALL ISDAFREE;              /* FREE DRC WORKAREA     @Y30LB50*/ 00338000
         L     @15,@CV00253                                     02S0115 00339000
         BALR  @14,@15                                          02S0115 00340000
*       DRC00PTR=0;                 /* SET WORK PTR TO 0 FOR ISDASDA0   00341000
*                                                            @Y30LB50*/ 00342000
         SLR   @03,@03                                          02S0116 00343000
         ST    @03,DRC00PTR(,CVTPTR)                            02S0116 00344000
*       RFY                                                     02S0117 00345000
*         R1 UNRSTD;                /*                       @Y30LB50*/ 00346000
*     END;                          /*                       @Y30LB50*/ 00347000
*         END;                      /*                       @Y30LB50*/ 00348000
*       ELSE                                                    01S0120 00349000
*         RETRNREG=0;               /* DO NOT FLAG DRD SSID INVLAID     00350000
*                                                            @ZM02889*/ 00351000
         B     @RC00053                                         01S0120 00352000
@RF00053 SLR   RETRNREG,RETRNREG                                01S0120 00353000
*     END;                          /*                       @Y30LB50*/ 00354000
*   ELSE                                                        01S0122 00355000
*     ;                             /*                       @Y30LB50*/ 00356000
@RF00049 DS    0H                                               01S0123 00357000
*   RETURN CODE(RETRNREG);          /*                       @Y30LB50*/ 00358000
@RC00049 L     @13,4(,@13)                                      01S0123 00359000
         L     @00,@SIZDATD                                     01S0123 00360000
         LR    @01,@11                                          01S0123 00361000
         ISDAFSPC R,LV=(0),A=(1)                                        00362000
         LR    @15,@09                                          01S0123 00363000
         L     @14,12(,@13)                                     01S0123 00364000
         LM    @00,@12,20(@13)                                  01S0123 00365000
         BR    @14                                              01S0123 00366000
*   END ISDADRC0                    /*                       @Y30LB50*/ 00367000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 00368000
*/*%INCLUDE SYSLIB  (ISDACVT )                                        * 00369000
*/*%INCLUDE SYSLIB  (ISDAMSCS)                                        * 00370000
*/*%INCLUDE SYSLIB  (ISDAMSC4)                                        * 00371000
*/*%INCLUDE SYSLIB  (ISDAPRMS)                                        * 00372000
*/*%INCLUDE SYSLIB  (ISDADRC5)                                        * 00373000
*/*%INCLUDE SYSUT5  (DRC0CNST)                                        * 00374000
*/*%INCLUDE SYSUT5  (DRCINIT )                                        * 00375000
*/*%INCLUDE SYSUT5  (DRCCSCHK)                                        * 00376000
*/*%INCLUDE SYSUT5  (DRCCNTS )                                        * 00377000
*/*%INCLUDE SYSUT5  (FREEBLKS)                                        * 00378000
*;                                                              01S0124 00379000
@DATA    DS    0H                                                       00380000
@CH00104 DC    H'4'                                                     00381000
@CH00070 DC    H'8'                                                     00382000
@CH00257 DC    H'32'                                                    00383000
@DATD    DSECT                                                          00384000
         DS    0F                                                       00385000
@SA00001 DS    18F                                                      00386000
@PC00001 DS    1F                                                       00387000
ISDADRC0 CSECT                                                          00388000
         DS    0F                                                       00389000
@CF00097 DC    F'40'                                                    00390000
@CF00268 DC    F'256'                                                   00391000
@CF00269 DC    F'-4'                                                    00392000
@DATD    DSECT                                                          00393000
         DS    0D                                                       00394000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                00395000
@ENDDATD EQU   *                                                        00396000
ISDADRC0 CSECT                                                          00397000
         NOPR  ((@ENDDATD-@DATD)/161*16)                                00398000
         DS    0F                                                       00399000
@SIZDATD DC    AL1(0)                                                   00400000
         DC    AL3(@ENDDATD-@DATD)                                      00401000
@CV00252 DC    V(ISDAGET1)                                              00402000
@CV00253 DC    V(ISDAFREE)                                              00403000
         DS    0D                                                       00404000
@CB00264 DC    X'00F0'                                                  00405000
@CB00266 DC    X'000F'                                                  00406000
DRCSPNO  DC    X'00'                                                    00407000
PATCH    DS    CL50                                                     00408000
         ORG   PATCH                                                    00409000
@NM00007 DC    50X'00'                                                  00410000
         ORG   PATCH+50                                                 00411000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00412000
@01      EQU   01                                                       00413000
@02      EQU   02                                                       00414000
@03      EQU   03                                                       00415000
@04      EQU   04                                                       00416000
@05      EQU   05                                                       00417000
@06      EQU   06                                                       00418000
@07      EQU   07                                                       00419000
@08      EQU   08                                                       00420000
@09      EQU   09                                                       00421000
@10      EQU   10                                                       00422000
@11      EQU   11                                                       00423000
@12      EQU   12                                                       00424000
@13      EQU   13                                                       00425000
@14      EQU   14                                                       00426000
@15      EQU   15                                                       00427000
LPARMPTR EQU   @04                                                      00428000
SENSEPTR EQU   @03                                                      00429000
CVTPTR   EQU   @02                                                      00430000
DRCPTR   EQU   @10                                                      00431000
CSPTR    EQU   @08                                                      00432000
RETRNREG EQU   @09                                                      00433000
R1       EQU   @01                                                      00434000
R0       EQU   @00                                                      00435000
R15      EQU   @15                                                      00436000
ISDACVT  EQU   0                                                        00437000
CVTPTRS0 EQU   ISDACVT                                                  00438000
SDATAPTR EQU   CVTPTRS0+4                                               00439000
PARMPTR  EQU   CVTPTRS0+8                                               00440000
DRC00PTR EQU   CVTPTRS0+76                                              00441000
WORKCALL EQU   CVTPTRS0+96                                              00442000
GET0CALL EQU   ISDACVT+100                                              00443000
SPNOLEN  EQU   GET0CALL                                                 00444000
SPNO     EQU   SPNOLEN                                                  00445000
CORELEN  EQU   SPNOLEN+1                                                00446000
COREADDR EQU   GET0CALL+4                                               00447000
HEXPCALL EQU   ISDACVT+108                                              00448000
PRT0CALL EQU   ISDACVT+120                                              00449000
OUTLINE  EQU   PRT0CALL                                                 00450000
SDADATD  EQU   ISDACVT+256                                              00451000
PRTDATD  EQU   ISDACVT+416                                              00452000
ISDAMSCS EQU   0                                                        00453000
SUBSYSID EQU   ISDAMSCS+1                                               00454000
SSID     EQU   SUBSYSID                                                 00455000
SSIDTYPE EQU   SSID                                                     00456000
SUBSENSE EQU   ISDAMSCS+4                                               00457000
SUBFMTMG EQU   SUBSENSE+7                                               00458000
ISDAMSC4 EQU   4                                                        00459000
STATUS14 EQU   ISDAMSC4                                                 00460000
FMTMSG4  EQU   ISDAMSC4+7                                               00461000
SASENSE  EQU   ISDAMSC4+8                                               00462000
BYTE16F4 EQU   SASENSE+8                                                00463000
BYTE17F4 EQU   SASENSE+9                                                00464000
BYTE18F4 EQU   SASENSE+10                                               00465000
ISDAPRMS EQU   0                                                        00466000
CINPUT   EQU   ISDAPRMS                                                 00467000
CSTART   EQU   ISDAPRMS+2                                               00468000
CEND     EQU   ISDAPRMS+6                                               00469000
CFSCONLY EQU   ISDAPRMS+13                                              00470000
CSSIDF   EQU   ISDAPRMS+17                                              00471000
CSERIAL  EQU   ISDAPRMS+21                                              00472000
CREPORTS EQU   ISDAPRMS+33                                              00473000
CDRC     EQU   CREPORTS+9                                               00474000
DRCWORK  EQU   0                                                        00475000
CSPTRS   EQU   DRCWORK                                                  00476000
WORK1    EQU   DRCWORK+20                                               00477000
WORK2    EQU   WORK1                                                    00478000
CURRBIT  EQU   WORK2                                                    00479000
I        EQU   DRCWORK+24                                               00480000
HOLDDBL  EQU   DRCWORK+32                                               00481000
HOLD     EQU   HOLDDBL+4                                                00482000
HOLD1    EQU   HOLD+1                                                   00483000
CSNUMB   EQU   HOLD1                                                    00484000
DRCACCM  EQU   0                                                        00485000
BYTEBIT  EQU   DRCACCM                                                  00486000
BYTE0    EQU   DRCACCM+8                                                00487000
BIT0     EQU   BYTE0                                                    00488000
WORKPTR  EQU   0                                                        00489000
*                                      START UNREFERENCED COMPONENTS    00490000
BYTE3    EQU   DRCACCM+192                                              00491000
BYTE2    EQU   DRCACCM+128                                              00492000
BYTE1    EQU   DRCACCM+64                                               00493000
BITS1TO7 EQU   BYTE0+8                                                  00494000
BYTEBIT3 EQU   DRCACCM+2                                                00495000
XXX      EQU   HOLD1+2                                                  00496000
HOLD2    EQU   HOLD                                                     00497000
HOLD0    EQU   HOLDDBL                                                  00498000
L        EQU   DRCWORK+30                                               00499000
K        EQU   DRCWORK+28                                               00500000
J        EQU   DRCWORK+26                                               00501000
WORK3    EQU   WORK1+1                                                  00502000
RESTBITS EQU   WORK2                                                    00503000
TSUM     EQU   DRCWORK+16                                               00504000
CTRACE   EQU   ISDAPRMS+48                                              00505000
CGEN     EQU   ISDAPRMS+47                                              00506000
CDETAIL  EQU   ISDAPRMS+46                                              00507000
CPERIOD  EQU   ISDAPRMS+45                                              00508000
CPWR     EQU   CREPORTS+11                                              00509000
CAPRSUU  EQU   CREPORTS+10                                              00510000
CDAT     EQU   CREPORTS+8                                               00511000
CCSBCSF  EQU   CREPORTS+7                                               00512000
CDCKTLX  EQU   CREPORTS+6                                               00513000
CEQC     EQU   CREPORTS+5                                               00514000
CFSC     EQU   CREPORTS+4                                               00515000
CDHEDHU  EQU   CREPORTS+3                                               00516000
CSUM     EQU   CREPORTS+2                                               00517000
CPAD     EQU   CREPORTS+1                                               00518000
CDCS     EQU   CREPORTS                                                 00519000
CSERNO   EQU   CSERIAL+4                                                00520000
@NM00006 EQU   CSERIAL+3                                                00521000
CIBM     EQU   CSERIAL                                                  00522000
CRATIO   EQU   ISDAPRMS+19                                              00523000
CSSID    EQU   CSSIDF                                                   00524000
@NM00005 EQU   CSSIDF                                                   00525000
CFSC34   EQU   CFSCONLY+2                                               00526000
CFSC12   EQU   CFSCONLY                                                 00527000
CTYPE    EQU   ISDAPRMS+11                                              00528000
CSUMMARY EQU   ISDAPRMS+10                                              00529000
CENDDAY  EQU   CEND+2                                                   00530000
CENDYEAR EQU   CEND                                                     00531000
CSTDAY   EQU   CSTART+2                                                 00532000
CSTYEAR  EQU   CSTART                                                   00533000
CHISTIN  EQU   CINPUT+1                                                 00534000
CLOGIN   EQU   CINPUT                                                   00535000
BYTE27F4 EQU   SASENSE+19                                               00536000
BYTE26F4 EQU   SASENSE+18                                               00537000
BYTE25F4 EQU   SASENSE+17                                               00538000
BYTE24F4 EQU   SASENSE+16                                               00539000
FSCFMT4  EQU   SASENSE+14                                               00540000
BYTE21F4 EQU   SASENSE+13                                               00541000
BYTE20F4 EQU   SASENSE+12                                               00542000
BYTE19F4 EQU   SASENSE+11                                               00543000
BYTE15F4 EQU   SASENSE+7                                                00544000
BYTE14F4 EQU   SASENSE+6                                                00545000
BYTE13F4 EQU   SASENSE+5                                                00546000
BYTE12F4 EQU   SASENSE+4                                                00547000
BYTE11F4 EQU   SASENSE+3                                                00548000
BYTE10F4 EQU   SASENSE+2                                                00549000
BYTE9F4  EQU   SASENSE+1                                                00550000
BYTE8F4  EQU   SASENSE                                                  00551000
MSGCODE4 EQU   FMTMSG4                                                  00552000
SUBFMTN4 EQU   FMTMSG4                                                  00553000
LOWADDF4 EQU   ISDAMSC4+6                                               00554000
RETRYF4  EQU   ISDAMSC4+5                                               00555000
@NM00004 EQU   ISDAMSC4+4                                               00556000
CMDERRF4 EQU   ISDAMSC4+3                                               00557000
CHADDRF4 EQU   ISDAMSC4+2                                               00558000
STATUS24 EQU   ISDAMSC4+1                                               00559000
SANOMSCD EQU   SUBSENSE+27                                              00560000
RCYLMSCD EQU   SUBSENSE+25                                              00561000
RUAMSCD  EQU   SUBSENSE+24                                              00562000
MSCFSC   EQU   SUBSENSE+22                                              00563000
@NM00003 EQU   SUBSENSE+21                                              00564000
RUADASD  EQU   SUBSENSE+20                                              00565000
DASDFSC  EQU   SUBSENSE+18                                              00566000
@NM00002 EQU   SUBSENSE+8                                               00567000
MSGCODEN EQU   SUBFMTMG                                                 00568000
SUBFMTNO EQU   SUBFMTMG                                                 00569000
SALOWAD2 EQU   SUBSENSE+6                                               00570000
SARETRY  EQU   SUBSENSE+5                                               00571000
@NM00001 EQU   SUBSENSE+4                                               00572000
DASDFMTN EQU   SUBSENSE+3                                               00573000
SALOWADD EQU   SUBSENSE+2                                               00574000
SUBSTAT5 EQU   SUBSENSE+1                                               00575000
SUBSTAT4 EQU   SUBSENSE                                                 00576000
FORMATNO EQU   ISDAMSCS+3                                               00577000
SSIDDEVT EQU   SSID+1                                                   00578000
SSIDLIBN EQU   SSID+1                                                   00579000
SSIDFLAG EQU   SUBSYSID                                                 00580000
STATUS   EQU   ISDAMSCS                                                 00581000
PRTSA001 EQU   PRTDATD                                                  00582000
SDATEMPS EQU   SDADATD+136                                              00583000
SDASA002 EQU   SDADATD+76                                               00584000
SDAPC001 EQU   SDADATD+72                                               00585000
SDASA001 EQU   SDADATD                                                  00586000
SDARPTID EQU   PRT0CALL+133                                             00587000
LINE     EQU   OUTLINE+1                                                00588000
ANSI     EQU   OUTLINE                                                  00589000
DUMPIDNO EQU   HEXPCALL+8                                               00590000
DUMPLEN  EQU   HEXPCALL+4                                               00591000
DUMPADDR EQU   HEXPCALL                                                 00592000
GEN00PTR EQU   CVTPTRS0+92                                              00593000
CNFG0PTR EQU   CVTPTRS0+88                                              00594000
PWR00PTR EQU   CVTPTRS0+84                                              00595000
APR00PTR EQU   CVTPTRS0+80                                              00596000
DAT00PTR EQU   CVTPTRS0+72                                              00597000
CSB00PTR EQU   CVTPTRS0+68                                              00598000
DCK00PTR EQU   CVTPTRS0+64                                              00599000
EQC00PTR EQU   CVTPTRS0+60                                              00600000
FSC00PTR EQU   CVTPTRS0+56                                              00601000
DHE00PTR EQU   CVTPTRS0+52                                              00602000
SUM00PTR EQU   CVTPTRS0+48                                              00603000
PAD00PTR EQU   CVTPTRS0+44                                              00604000
DCS00PTR EQU   CVTPTRS0+40                                              00605000
LOG00PTR EQU   CVTPTRS0+36                                              00606000
HIST0PTR EQU   CVTPTRS0+32                                              00607000
PRT00PTR EQU   CVTPTRS0+28                                              00608000
GET00PTR EQU   CVTPTRS0+24                                              00609000
TYPE0PTR EQU   CVTPTRS0+20                                              00610000
PARM0PTR EQU   CVTPTRS0+16                                              00611000
SDA00PTR EQU   CVTPTRS0+12                                              00612000
DATAPTR  EQU   CVTPTRS0                                                 00613000
*                                      END UNREFERENCED COMPONENTS      00614000
@RC00040 EQU   @RC00030                                                 00615000
@RC00053 EQU   @RC00049                                                 00616000
@RC00080 EQU   @RC00053                                                 00617000
@ENDDATA EQU   *                                                        00618000
         END   ISDADRC0,(C'PLS0120',0603,75313)                         00619000
