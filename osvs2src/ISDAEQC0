         TITLE 'EQUIPMENT CHECK AND DATA CHECK REPORT ACCUMULATOR ROUTI*00001000
               INE      '                                               00002000
ISDAEQC0 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(8)                                              0001 00007000
         DC    C'ISDAEQC0'                                         0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@12                                         0001 00013000
         L     @00,@SIZDATD                                        0001 00014000
         ISDAGSPC R,LV=(0)                                              00015000
         LR    @11,@01                                             0001 00016000
         USING @DATD,@11                                           0001 00017000
         ST    @13,@SA00001+4                                      0001 00018000
         LM    @00,@01,20(@13)                                     0001 00019000
         ST    @11,8(,@13)                                         0001 00020000
         LR    @13,@11                                             0001 00021000
         MVC   @PC00001(4),0(@01)                                  0001 00022000
*                                                                  0021 00023000
*   /*****************************************************************/ 00024000
*   /*                                                               */ 00025000
*   /* PROGRAM START.                                                */ 00026000
*   /*                                                               */ 00027000
*   /*****************************************************************/ 00028000
*                                                                  0021 00029000
*   CVTPTR=WORKPTR;                 /* SET LOCAL PTR TO SDACVT.    0021 00030000
*                                                            @Y30LB51*/ 00031000
         L     @10,@PC00001                                        0021 00032000
         L     CVTPTR,WORKPTR(,@10)                                0021 00033000
*   LPARMPTR=PARMPTR;               /* SET LOCAL PTR TO SDAPARMS.  0022 00034000
*                                                            @Y30LB51*/ 00035000
         L     LPARMPTR,PARMPTR(,CVTPTR)                           0022 00036000
*   EQCRETCD=0;                     /* INITIALIZE RETURN CODE.     0023 00037000
*                                                            @Y30LB51*/ 00038000
         SLR   @10,@10                                             0023 00039000
         LR    EQCRETCD,@10                                        0023 00040000
*   EQCWKPTR=0;                     /* INITIALIZE WORK AREA PTR.   0024 00041000
*                                                            @Y30LB51*/ 00042000
         LR    EQCWKPTR,@10                                        0024 00043000
*   IF EQC00PTR=0 THEN              /* IF THIS IS FIRST ENTRY      0025 00044000
*                                                            @Y30LB51*/ 00045000
         C     @10,EQC00PTR(,CVTPTR)                               0025 00046000
         BNE   @RF00025                                            0025 00047000
*     DO;                           /* GET SPACE FOR WORK AREA AND 0026 00048000
*                                      TABLE.                @Y30LB51*/ 00049000
*       CALL FIRSTENT;              /* GO GET SPACE.         @Y30LB51*/ 00050000
         BAL   @14,FIRSTENT                                        0027 00051000
*       IF EQCRETCD^=0 THEN         /* IF SPACE WAS NOT AVAILABLE  0028 00052000
*                                                            @Y30LB51*/ 00053000
         LTR   EQCRETCD,EQCRETCD                                   0028 00054000
         BZ    @RF00028                                            0028 00055000
*         DO;                       /* FREE ANY SPACE SECURED.     0029 00056000
*                                                            @Y30LB51*/ 00057000
*           CALL FREECORE;          /* GO FREE THE SPACE     @Y30LB51*/ 00058000
         BAL   @14,FREECORE                                        0030 00059000
*           RETURN CODE(EQCRETCD);  /* AND RETURN.           @Y30LB51*/ 00060000
         L     @13,4(,@13)                                         0031 00061000
         L     @00,@SIZDATD                                        0031 00062000
         LR    @01,@11                                             0031 00063000
         ISDAFSPC R,LV=(0),A=(1)                                        00064000
         LR    @15,@05                                             0031 00065000
         L     @14,12(,@13)                                        0031 00066000
         LM    @00,@12,20(@13)                                     0031 00067000
         BR    @14                                                 0031 00068000
*         END;                      /*                       @Y30LB51*/ 00069000
*       ELSE                                                       0033 00070000
*         ;                         /* SPACE WAS SECURED.    @Y30LB51*/ 00071000
@RF00028 DS    0H                                                  0034 00072000
*     END;                          /*                       @Y30LB51*/ 00073000
*   ELSE                            /* NOT FIRST ENTRY.      @Y30LB51*/ 00074000
*     EQCWKPTR=EQC00PTR;            /* INITIALIZE PTR TO WORK AREA.     00075000
*                                                            @Y30LB51*/ 00076000
         B     @RC00025                                            0035 00077000
@RF00025 L     EQCWKPTR,EQC00PTR(,CVTPTR)                          0035 00078000
*   LOGPTR=DATAPTR;                 /* SET LOCAL PTR TO RECORD.    0036 00079000
*                                                            @Y30LB51*/ 00080000
@RC00025 MVC   LOGPTR(4,EQCWKPTR),DATAPTR(CVTPTR)                  0036 00081000
*   SENSEPTR=SDATAPTR;              /* SET LOCAL PTR TO SENSE AREA.     00082000
*                                                            @Y30LB51*/ 00083000
         MVC   SENSEPTR(4,EQCWKPTR),SDATAPTR(CVTPTR)               0037 00084000
*   LPARMPTR=PARMPTR;               /* SET LOCAL PTR TO SDAPARMS.  0038 00085000
*                                                            @Y30LB51*/ 00086000
         L     LPARMPTR,PARMPTR(,CVTPTR)                           0038 00087000
*   SSIDSAVE=''B;                   /* ZERO OUT SAVE AREAS.  @Y30LB51*/ 00088000
         XC    SSIDSAVE(2,EQCWKPTR),SSIDSAVE(EQCWKPTR)             0039 00089000
*   FSCSYSSV=''B;                   /*                       @Y30LB51*/ 00090000
         XC    FSCSYSSV(2,EQCWKPTR),FSCSYSSV(EQCWKPTR)             0040 00091000
*   FSCSAVE1=''B;                   /*                       @Y30LB51*/ 00092000
         XC    FSCSAVE1(4,EQCWKPTR),FSCSAVE1(EQCWKPTR)             0041 00093000
*   FSCSAVE2=''B;                   /*                       @Y30LB51*/ 00094000
         XC    FSCSAVE2(4,EQCWKPTR),FSCSAVE2(EQCWKPTR)             0042 00095000
*   EQCSW=0;                        /* RESET ALL SWITCHES.   @Y30LB51*/ 00096000
         SLR   @10,@10                                             0043 00097000
         STH   @10,EQCSW(,EQCWKPTR)                                0043 00098000
*   CALL RECTYPE;                   /* DETERMINE RECORD TYPE.      0044 00099000
*                                                            @Y30LB51*/ 00100000
         BAL   @14,RECTYPE                                         0044 00101000
*   IF EQCRETCD=0 THEN              /* IF RECORD IS ACCEPTED @Y30LB51*/ 00102000
         LTR   EQCRETCD,EQCRETCD                                   0045 00103000
         BNZ   @RF00045                                            0045 00104000
*     CALL PROCREC;                 /* PUT RECORD IN ACCUMULATOR.  0046 00105000
*                                                            @Y30LB51*/ 00106000
         BAL   @14,PROCREC                                         0046 00107000
*   ELSE                            /* RECORD NOT ACCEPTED.  @Y30LB51*/ 00108000
*     IF EQCRETCD=BUFFREC THEN      /* IF BUFFERED LOG RECORD      0047 00109000
*                                                            @Y30LB51*/ 00110000
         B     @RC00045                                            0047 00111000
@RF00045 CH    EQCRETCD,@CH00082                                   0047 00112000
         BNE   @RF00047                                            0047 00113000
*       EQCRETCD=0;                 /* RESET RETURN CODE.    @Y30LB51*/ 00114000
         SLR   EQCRETCD,EQCRETCD                                   0048 00115000
*     ELSE                                                         0049 00116000
*       ;                           /* NOT BUFFERED LOG RECORD.    0049 00117000
*                                                            @Y30LB51*/ 00118000
@RF00047 DS    0H                                                  0050 00119000
*   RETURN CODE(EQCRETCD);          /*                       @Y30LB51*/ 00120000
@RC00045 L     @13,4(,@13)                                         0050 00121000
         L     @00,@SIZDATD                                        0050 00122000
         LR    @01,@11                                             0050 00123000
         ISDAFSPC R,LV=(0),A=(1)                                        00124000
         LR    @15,@05                                             0050 00125000
         L     @14,12(,@13)                                        0050 00126000
         LM    @00,@12,20(@13)                                     0050 00127000
         BR    @14                                                 0050 00128000
*FIRSTENT:                                                         0051 00129000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/ 00130000
*                                                                  0051 00131000
@EL00001 L     @13,4(,@13)                                         0051 00132000
@EF00001 L     @00,@SIZDATD                                        0051 00133000
         LR    @01,@11                                             0051 00134000
         ISDAFSPC R,LV=(0),A=(1)                                        00135000
@ER00001 LM    @14,@12,12(@13)                                     0051 00136000
         BR    @14                                                 0051 00137000
FIRSTENT ST    @14,@SA00002                                        0051 00138000
*   /*****************************************************************/ 00139000
*   /*                                                               */ 00140000
*   /* THIS ROUTINE WILL OBTAIN SPACE FOR THE WORK AREA AND FOR THE  */ 00141000
*   /* ACCUMULATOR TABLE. THE ISDAGET1 ENTRY WILL BE USED TO OBTAIN  */ 00142000
*   /* THE SPACE FOR THE WORK AREA AND THE ISDAGET0 ENTRY WILL BE    */ 00143000
*   /* USED TO OBTAIN THE SPACE FOR THE ACCUMULATOR TABLE. EACH TABLE*/ 00144000
*   /* WILL BE INITIALIZED.                                          */ 00145000
*   /*                                                               */ 00146000
*   /*****************************************************************/ 00147000
*                                                                  0052 00148000
*   SPNO='05'X;                     /* GET THE SUBPOOL NUMBER.     0052 00149000
*                                                            @Y30LB51*/ 00150000
         MVI   SPNO(CVTPTR),X'05'                                  0052 00151000
*   CORELEN=LENGTH(EQCWORK);        /* GET WORK AREA LENGTH. @Y30LB51*/ 00152000
         MVC   CORELEN(3,CVTPTR),@CF00417+1                        0053 00153000
*   CALL ISDAGET1(WORKPTR);         /* GET WORK AREA SPACE.  @Y30LB51*/ 00154000
         L     @10,@PC00001                                        0054 00155000
         ST    @10,@AL00001                                        0054 00156000
         L     @15,@CV00347                                        0054 00157000
         LA    @01,@AL00001                                        0054 00158000
         BALR  @14,@15                                             0054 00159000
*   RFY                                                            0055 00160000
*     RF RSTD;                      /*                       @Y30LB51*/ 00161000
*   EQCRETCD=RF;                    /* SAVE RETURN CODE.     @Y30LB51*/ 00162000
         LR    EQCRETCD,RF                                         0056 00163000
*   RFY                                                            0057 00164000
*     RF UNRSTD;                    /*                       @Y30LB51*/ 00165000
*   IF EQCRETCD=0 THEN              /* IF SPACE WAS AVAILABLE      0058 00166000
*                                                            @Y30LB51*/ 00167000
         LTR   EQCRETCD,EQCRETCD                                   0058 00168000
         BNZ   @RF00058                                            0058 00169000
*     DO;                           /* INITIALIZE IT.        @Y30LB51*/ 00170000
*       EQC00PTR=COREADDR;          /* SAVE ADDRESS OF WORK AREA.  0060 00171000
*                                                            @Y30LB51*/ 00172000
         L     @10,COREADDR(,CVTPTR)                               0060 00173000
         ST    @10,EQC00PTR(,CVTPTR)                               0060 00174000
*       EQCWKPTR=COREADDR;          /* SET PTR TO WORK AREA. @Y30LB51*/ 00175000
         LR    EQCWKPTR,@10                                        0061 00176000
*       EQCWORK=''B;                /* ZERO OUT WORK AREA.   @Y30LB51*/ 00177000
         XC    EQCWORK(56,EQCWKPTR),EQCWORK(EQCWKPTR)              0062 00178000
*       CORELEN=LENGTH(ISDAGHDR)+LENGTH(EQCTBL)*TBLNR;/*           0063 00179000
*                                         GET EQC TABLE LENGTH.    0063 00180000
*                                                            @Y30LB51*/ 00181000
         MVC   CORELEN(3,CVTPTR),@CF00419+1                        0063 00182000
*       CALL ISDAGET0(WORKPTR);     /* GET EQC TABLE SPACE.  @Y30LB51*/ 00183000
         L     @10,@PC00001                                        0064 00184000
         ST    @10,@AL00001                                        0064 00185000
         L     @15,@CV00346                                        0064 00186000
         LA    @01,@AL00001                                        0064 00187000
         BALR  @14,@15                                             0064 00188000
*       RFY                                                        0065 00189000
*         RF RSTD;                  /*                       @Y30LB51*/ 00190000
*       EQCRETCD=RF;                /* SAVE RETURN CODE.     @Y30LB51*/ 00191000
         LR    EQCRETCD,RF                                         0066 00192000
*       RFY                                                        0067 00193000
*         RF UNRSTD;                /*                       @Y30LB51*/ 00194000
*       IF EQCRETCD=0 THEN          /* IF SPACE WAS SECURED  @Y30LB51*/ 00195000
         LTR   EQCRETCD,EQCRETCD                                   0068 00196000
         BNZ   @RF00068                                            0068 00197000
*         DO;                       /* INITIALIZE IT.        @Y30LB51*/ 00198000
*           GET0PTR=COREADDR;       /* SAVE ADDRESS OF EQC TABLE.  0070 00199000
*                                                            @Y30LB51*/ 00200000
         L     @10,COREADDR(,CVTPTR)                               0070 00201000
         ST    @10,GET0PTR(,EQCWKPTR)                              0070 00202000
*           FREEPTR=STARTPTR;       /* INITIALIZE THE FREE ENTRY PTR.   00203000
*                                                            @Y30LB51*/ 00204000
         L     @07,STARTPTR(,@10)                                  0071 00205000
         ST    @07,FREEPTR(,EQCWKPTR)                              0071 00206000
*           BLOCKCNT=BLOCKCNT+1;    /* NUMBER THE ACCUMULATOR.     0072 00207000
*                                                            @Y30LB51*/ 00208000
         LA    @15,1                                               0072 00209000
         LH    @14,BLOCKCNT(,@10)                                  0072 00210000
         ALR   @14,@15                                             0072 00211000
         STH   @14,BLOCKCNT(,@10)                                  0072 00212000
*           BLOCKID='EQC ';         /* PUT ID IN TABLE.      @Y30LB51*/ 00213000
         MVC   BLOCKID(4,@10),@CC00368                             0073 00214000
*           TBLPTR=STARTPTR;        /* INITIALIZE PTR TO ACCUMULATOR.   00215000
*                                                            @Y30LB51*/ 00216000
         LR    TBLPTR,@07                                          0074 00217000
*           DO I=1 TO TBLNR;        /*                       @Y30LB51*/ 00218000
         STH   @15,I(,EQCWKPTR)                                    0075 00219000
@DL00075 DS    0H                                                  0076 00220000
*             EQCTBL=''B;           /* ZERO OUT THE ACCUMULATOR.   0076 00221000
*                                                            @Y30LB51*/ 00222000
         XC    EQCTBL(56,TBLPTR),EQCTBL(TBLPTR)                    0076 00223000
*             TBLPTR=TBLPTR+LENGTH(EQCTBL);/*                      0077 00224000
*                                                            @Y30LB51*/ 00225000
         AH    TBLPTR,@CH00417                                     0077 00226000
*           END;                    /*                       @Y30LB51*/ 00227000
         LA    @15,1                                               0078 00228000
         AH    @15,I(,EQCWKPTR)                                    0078 00229000
         STH   @15,I(,EQCWKPTR)                                    0078 00230000
         CH    @15,@CH00338                                        0078 00231000
         BNH   @DL00075                                            0078 00232000
*           TBLPTR=STARTPTR;        /* RESET BASE PTR.       @Y30LB51*/ 00233000
         L     @10,GET0PTR(,EQCWKPTR)                              0079 00234000
         L     TBLPTR,STARTPTR(,@10)                               0079 00235000
*         END;                                                     0080 00236000
*       ELSE                        /* ACCUMULATOR SPACE UNAVAILABLE.   00237000
*                                                            @Y30LB51*/ 00238000
*         EQCRETCD=NOSPACE;         /*                       @Y30LB51*/ 00239000
         B     @RC00068                                            0081 00240000
@RF00068 LA    EQCRETCD,4                                          0081 00241000
*     END;                          /*                       @Y30LB51*/ 00242000
*   ELSE                            /* WORK AREA SPACE UNAVAILABLE.     00243000
*                                                            @Y30LB51*/ 00244000
*     EQCRETCD=NOSPACE;             /*                       @Y30LB51*/ 00245000
         B     @RC00058                                            0083 00246000
@RF00058 LA    EQCRETCD,4                                          0083 00247000
*   END FIRSTENT;                   /*                       @Y30LB51*/ 00248000
@EL00002 DS    0H                                                  0084 00249000
@EF00002 DS    0H                                                  0084 00250000
@ER00002 L     @14,@SA00002                                        0084 00251000
         BR    @14                                                 0084 00252000
*RECTYPE:                                                          0085 00253000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/ 00254000
*                                                                  0085 00255000
RECTYPE  ST    @14,@SA00003                                        0085 00256000
*   /*****************************************************************/ 00257000
*   /*                                                               */ 00258000
*   /* THIS ROUTINE WILL DETERMINE THE TYPE AND FORMAT OF THE INPUT  */ 00259000
*   /* RECORD. THE REAL UNIT ADDRESS FOR EACH RECORD WILL BE STORED. */ 00260000
*   /* THE SSID FOR ALL RECORDS, EXCEPT FOR THE REAL DASD RECORD,    */ 00261000
*   /* WILL BE STORED. THE FAULT SYMPTOM CODE WILL BE STORED FOR ALL */ 00262000
*   /* RECORDS EXCEPT THE MSC FORMAT 5 SUBFORMAT 5 RECORD, WHICH HAS */ 00263000
*   /* NO FSC. A SUBROUTINE WILL BE CALLED TO PROCESS THE FSC FOR THE*/ 00264000
*   /* FORMAT THREE RECORD AND ANOTHER SUBROUTINE WILL BE CALLED TO  */ 00265000
*   /* DETERMINE IF ALTERNATE PATH RETRY HAS BEEN INVOLVED IN THE MSC*/ 00266000
*   /* FORMAT FOUR RECORDS.                                          */ 00267000
*   /*                                                               */ 00268000
*   /*****************************************************************/ 00269000
*                                                                  0086 00270000
*   RUASAVE=INRECCUA;               /* STORE THE REAL UNIT ADDRESS.     00271000
*                                                            @ZD00149*/ 00272000
         L     @10,SDA00PTR(,CVTPTR)                               0086 00273000
         MVC   RUASAVE(2,EQCWKPTR),INRECCUA(@10)                   0086 00274000
*   IF INDEVTYP='S' THEN            /* IF AN MSC RECORD      @Y30LB51*/ 00275000
         CLI   INDEVTYP(@10),C'S'                                  0087 00276000
         BNE   @RF00087                                            0087 00277000
*     DO;                           /* PROCESS THE RECORD.   @Y30LB51*/ 00278000
*       SSIDSAVE=SUBSYSID;          /* STORE THE SSID AND FLAGS    0089 00279000
*                                                            @Y30LB51*/ 00280000
         L     @10,SENSEPTR(,EQCWKPTR)                             0089 00281000
         MVC   SSIDSAVE(2,EQCWKPTR),SUBSYSID(@10)                  0089 00282000
*       SSIDSAVE=SSIDSAVE&SSIDMASK; /* AND ISOLATE THE SSID. @Y30LB51*/ 00283000
         NC    SSIDSAVE(2,EQCWKPTR),@CB00336                       0090 00284000
*       IF FORMATNO(4)='1'B THEN    /* IF FMT 3 RECORD       @Y30LB51*/ 00285000
         TM    FORMATNO(@10),B'00010000'                           0091 00286000
         BNO   @RF00091                                            0091 00287000
*         IF SUBSTAT5(8)='0'B THEN  /* AND NOT BUFFERED LOG  @Y30LB51*/ 00288000
         TM    SUBSTAT5(@10),B'00000001'                           0092 00289000
         BNZ   @RF00092                                            0092 00290000
*           CALL MSCTHREE;          /* ACCEPT THE RECORD.    @Y30LB51*/ 00291000
         BAL   @14,MSCTHREE                                        0093 00292000
*         ELSE                      /* BUFFERED LOG RECORD,  @Y30LB51*/ 00293000
*           EQCRETCD=BUFFREC;       /* REJECT IT.            @Y30LB51*/ 00294000
         B     @RC00092                                            0094 00295000
@RF00092 LA    EQCRETCD,1                                          0094 00296000
*       ELSE                        /* NOT FMT 3 RECORD.     @Y30LB51*/ 00297000
*         DO;                       /* PROCESS IT.           @ZD00149*/ 00298000
         B     @RC00091                                            0095 00299000
@RF00091 DS    0H                                                  0096 00300000
*           IF FORMATNO(6)='1'B THEN/* IF FMT 5 RECORD       @Y30LB51*/ 00301000
         L     @10,SENSEPTR(,EQCWKPTR)                             0096 00302000
         TM    FORMATNO(@10),B'00000100'                           0096 00303000
         BNO   @RF00096                                            0096 00304000
*             IF SUBFMTNO='0101'B THEN/* AND SUBFMT 5        @ZD00149*/ 00305000
         TM    SUBFMTNO(@10),B'01010000'                           0097 00306000
         BNO   @RF00097                                            0097 00307000
         TM    SUBFMTNO(@10),B'10100000'                           0097 00308000
         BNZ   @RF00097                                            0097 00309000
*               NOFSC='1'B;         /* MARK IT WITH NO FSC.  @Y30LB51*/ 00310000
         OI    NOFSC(EQCWKPTR),B'00010000'                         0098 00311000
*             ELSE                  /* NOT SUBFORMAT 5 RECORD,     0099 00312000
*                                                            @ZD00149*/ 00313000
*               FSCSYSSV=MSCFSC;    /* STORE THE FSC.        @ZD00149*/ 00314000
         B     @RC00097                                            0099 00315000
@RF00097 L     @10,SENSEPTR(,EQCWKPTR)                             0099 00316000
         MVC   FSCSYSSV(2,EQCWKPTR),MSCFSC(@10)                    0099 00317000
*           ELSE                    /* NOT FMT 5 RECORD,     @Y30LB51*/ 00318000
*             FSCSYSSV=MSCFSC;      /* STORE THE FSC.        @ZD00149*/ 00319000
         B     @RC00096                                            0100 00320000
@RF00096 L     @10,SENSEPTR(,EQCWKPTR)                             0100 00321000
         MVC   FSCSYSSV(2,EQCWKPTR),MSCFSC(@10)                    0100 00322000
*           IF FORMATNO(5)='1'B THEN/* IF MSC FORMAT 4 RECORD      0101 00323000
*                                                            @ZD00149*/ 00324000
@RC00096 L     @10,SENSEPTR(,EQCWKPTR)                             0101 00325000
         TM    FORMATNO(@10),B'00001000'                           0101 00326000
         BNO   @RF00101                                            0101 00327000
*             CALL MSCFOUR;         /* CHECK FOR APR.        @Y30LB51*/ 00328000
         BAL   @14,MSCFOUR                                         0102 00329000
*           ELSE                                                   0103 00330000
*             ;                     /* NOT A FORMAT 4 RECORD.      0103 00331000
*                                                            @ZD00149*/ 00332000
@RF00101 DS    0H                                                  0104 00333000
*         END;                      /*                       @ZD00149*/ 00334000
*     END;                          /*                       @Y30LB51*/ 00335000
*   ELSE                            /* NOT MSC RECORD,       @Y30LB51*/ 00336000
*     DO;                           /* MUST BE DASD RECORD.  @Y30LB51*/ 00337000
         B     @RC00087                                            0106 00338000
@RF00087 DS    0H                                                  0107 00339000
*       FSCSYSSV=FSCDASD;           /* STORE DASD FSC.       @Y30LB51*/ 00340000
         L     @10,SENSEPTR(,EQCWKPTR)                             0107 00341000
         MVC   FSCSYSSV(2,EQCWKPTR),FSCDASD(@10)                   0107 00342000
*       IF INDEVTYP='V' THEN        /* IF A VIRTUAL DASD RECORD    0108 00343000
*                                                            @ZD00149*/ 00344000
         L     @04,SDA00PTR(,CVTPTR)                               0108 00345000
         CLI   INDEVTYP(@04),C'V'                                  0108 00346000
         BNE   @RF00108                                            0108 00347000
*         DO;                       /* GET THE DEVICE SSID.  @ZD00149*/ 00348000
*           SSIDSAVE=DASDSSID;      /* STORE THE DASD SSID   @ZD00149*/ 00349000
         MVC   SSIDSAVE(2,EQCWKPTR),DASDSSID(@10)                  0110 00350000
*           SSIDDEV=0;              /* AND SET FIRST CHARACTER TO  0111 00351000
*                                      ZERO.                 @ZD00149*/ 00352000
         MVI   SSIDDEV(EQCWKPTR),X'00'                             0111 00353000
*         END;                      /*                       @ZD00149*/ 00354000
*       ELSE                        /* MUST BE REAL DASD RECORD,   0113 00355000
*                                                            @ZD00149*/ 00356000
*         SSIDSAVE=''B;             /* SET SSID TO BLANKS.   @ZD00149*/ 00357000
         B     @RC00108                                            0113 00358000
@RF00108 XC    SSIDSAVE(2,EQCWKPTR),SSIDSAVE(EQCWKPTR)             0113 00359000
*     END;                          /*                       @Y30LB51*/ 00360000
*   END RECTYPE;                    /*                       @Y30LB51*/ 00361000
@EL00003 DS    0H                                                  0115 00362000
@EF00003 DS    0H                                                  0115 00363000
@ER00003 L     @14,@SA00003                                        0115 00364000
         BR    @14                                                 0115 00365000
*MSCTHREE:                                                         0116 00366000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/ 00367000
*                                                                  0116 00368000
MSCTHREE ST    @14,12(,@13)                                        0116 00369000
*   /*****************************************************************/ 00370000
*   /*                                                               */ 00371000
*   /* THIS ROUTINE WILL STORE THE FSC(S) OF AN MSC FORMAT 3 RECORD. */ 00372000
*   /*                                                               */ 00373000
*   /*****************************************************************/ 00374000
*                                                                  0117 00375000
*   IF FSCACC1^=0 THEN              /* IF RT ACC FSC         @Y30LB51*/ 00376000
         SLR   @10,@10                                             0117 00377000
         L     @04,SENSEPTR(,EQCWKPTR)                             0117 00378000
         CL    @10,FSCACC1(,@04)                                   0117 00379000
         BE    @RF00117                                            0117 00380000
*     DO;                           /* STORE IT.             @Y30LB51*/ 00381000
*       FSCSAVE1=FSCACC1;           /* STORE RT ACC FSC      @Y30LB51*/ 00382000
         MVC   FSCSAVE1(4,EQCWKPTR),FSCACC1(@04)                   0119 00383000
*       FMT3ACC1='1'B;              /* AND SET RT ACC FLAG.  @Y30LB51*/ 00384000
         OI    FMT3ACC1(EQCWKPTR),B'10000000'                      0120 00385000
*       IF FSCACC2^=0 THEN          /* IF LEFT ACC FSC       @Y30LB51*/ 00386000
         CL    @10,FSCACC2(,@04)                                   0121 00387000
         BE    @RF00121                                            0121 00388000
*         DO;                       /* STORE IT.             @Y30LB51*/ 00389000
*           FSCSAVE2=FSCACC2;       /* STORE LEFT ACC FSC    @Y30LB51*/ 00390000
         MVC   FSCSAVE2(4,EQCWKPTR),FSCACC2(@04)                   0123 00391000
*           FMT3ACC2='1'B;          /* AND SET LEFT ACC FLAG.      0124 00392000
*                                                            @Y30LB51*/ 00393000
         OI    FMT3ACC2(EQCWKPTR),B'01000000'                      0124 00394000
*         END;                      /*                       @Y30LB51*/ 00395000
*       ELSE                                                       0126 00396000
*         ;                         /* NO LEFT ACC FSC.      @Y30LB51*/ 00397000
@RF00121 DS    0H                                                  0127 00398000
*     END;                          /*                       @Y30LB51*/ 00399000
*   ELSE                            /* NO RT ACC FSC,        @Y30LB51*/ 00400000
*     DO;                           /* MUST BE LEFT ACC FSC. @Y30LB51*/ 00401000
         B     @RC00117                                            0128 00402000
@RF00117 DS    0H                                                  0129 00403000
*       FSCSAVE2=FSCACC2;           /* STORE LEFT ACC FSC    @Y30LB51*/ 00404000
         L     @10,SENSEPTR(,EQCWKPTR)                             0129 00405000
         MVC   FSCSAVE2(4,EQCWKPTR),FSCACC2(@10)                   0129 00406000
*       FMT3ACC2='1'B;              /* AND SET LEFT ACC FLAG.      0130 00407000
*                                                            @Y30LB51*/ 00408000
         OI    FMT3ACC2(EQCWKPTR),B'01000000'                      0130 00409000
*     END;                          /*                       @Y30LB51*/ 00410000
*   END MSCTHREE;                   /*                       @Y30LB51*/ 00411000
@EL00004 DS    0H                                                  0132 00412000
@EF00004 DS    0H                                                  0132 00413000
@ER00004 L     @14,12(,@13)                                        0132 00414000
         BR    @14                                                 0132 00415000
*MSCFOUR:                                                          0133 00416000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/ 00417000
*                                                                  0133 00418000
MSCFOUR  ST    @14,12(,@13)                                        0133 00419000
*   /*****************************************************************/ 00420000
*   /*                                                               */ 00421000
*   /* THIS ROUTINE WILL PROCESS AN MSC FORMAT FOUR RECORD. THE FSC  */ 00422000
*   /* WILL BE STORED AND THE SSID CHECKED TO DETERMINE IF IT HAS    */ 00423000
*   /* BEEN CHANGED BY ALTERNATE PATH RETRY (APR).                   */ 00424000
*   /*                                                               */ 00425000
*   /*****************************************************************/ 00426000
*                                                                  0134 00427000
*   FSCSYSSV=MSCFSC;                /* STORE THE FSC.        @Y30LB51*/ 00428000
         L     @10,SENSEPTR(,EQCWKPTR)                             0134 00429000
         MVC   FSCSYSSV(2,EQCWKPTR),MSCFSC(@10)                    0134 00430000
*   IF(SUBFMTNO='1001'B)&(SSIDDEV^='02'X) THEN/* IF SUBFMT '9' RECORD   00431000
*                                      AND SSID IS NOT FOR R/W DEVICE   00432000
*                                                            @Y30LB51*/ 00433000
         TM    SUBFMTNO(@10),B'10010000'                           0135 00434000
         BNO   @RF00135                                            0135 00435000
         TM    SUBFMTNO(@10),B'01100000'                           0135 00436000
         BNZ   @RF00135                                            0135 00437000
         CLI   SSIDDEV(EQCWKPTR),X'02'                             0135 00438000
         BE    @RF00135                                            0135 00439000
*     WORKAPR='1'B;                 /* SET APR FLAG.         @Y30LB51*/ 00440000
         OI    WORKAPR(EQCWKPTR),B'00100000'                       0136 00441000
*   ELSE                            /* SUBFMT AND SSID OK.   @Y30LB51*/ 00442000
*     IF(SUBFMTNO='1010'B)&(SSIDDEV^='08'X) THEN/* IF SUBFMT 'A'   0137 00443000
*                                      RECORD AND SSID IS NOT FOR  0137 00444000
*                                      STAGING ADAPTOR       @Y30LB51*/ 00445000
         B     @RC00135                                            0137 00446000
@RF00135 L     @10,SENSEPTR(,EQCWKPTR)                             0137 00447000
         TM    SUBFMTNO(@10),B'10100000'                           0137 00448000
         BNO   @RF00137                                            0137 00449000
         TM    SUBFMTNO(@10),B'01010000'                           0137 00450000
         BNZ   @RF00137                                            0137 00451000
         CLI   SSIDDEV(EQCWKPTR),X'08'                             0137 00452000
         BE    @RF00137                                            0137 00453000
*       WORKAPR='1'B;               /* SET APR FLAG.         @Y30LB51*/ 00454000
         OI    WORKAPR(EQCWKPTR),B'00100000'                       0138 00455000
*     ELSE                          /* SUBFMT AND SSID OK.   @Y30LB51*/ 00456000
*       IF SUBFMTNO='1011'B THEN    /* IF SUBFMT 'B'         @Y30LB51*/ 00457000
         B     @RC00137                                            0139 00458000
@RF00137 L     @10,SENSEPTR(,EQCWKPTR)                             0139 00459000
         TM    SUBFMTNO(@10),B'10110000'                           0139 00460000
         BNO   @RF00139                                            0139 00461000
         TM    SUBFMTNO(@10),B'01000000'                           0139 00462000
         BNZ   @RF00139                                            0139 00463000
*         IF(SSIDDEV^='04'X)&(SSIDDEV^='02'X) THEN/* AND IF NOT FOR     00464000
*                                      R/W DEVICE OR R/W CONTROLLER     00465000
*                                                            @Y30LB51*/ 00466000
         CLI   SSIDDEV(EQCWKPTR),X'04'                             0140 00467000
         BE    @RF00140                                            0140 00468000
         CLI   SSIDDEV(EQCWKPTR),X'02'                             0140 00469000
         BE    @RF00140                                            0140 00470000
*           WORKAPR='1'B;           /* SET APR FLAG.         @Y30LB51*/ 00471000
         OI    WORKAPR(EQCWKPTR),B'00100000'                       0141 00472000
*         ELSE                                                     0142 00473000
*           ;                       /* SUBFMT AND SSID OK.   @Y30LB51*/ 00474000
@RF00140 DS    0H                                                  0143 00475000
*       ELSE                        /* MUST BE SUBFMT 'E'.   @Y30LB51*/ 00476000
*         IF(SUBFMTNO='1110'B)&(SSIDDEV^='04'X) THEN/* IF SUBFMT 'E'    00477000
*                                      AND NOT FOR R/W CONTROLLER  0143 00478000
*                                                            @Y30LB51*/ 00479000
         B     @RC00139                                            0143 00480000
@RF00139 L     @10,SENSEPTR(,EQCWKPTR)                             0143 00481000
         TM    SUBFMTNO(@10),B'11100000'                           0143 00482000
         BNO   @RF00143                                            0143 00483000
         TM    SUBFMTNO(@10),B'00010000'                           0143 00484000
         BNZ   @RF00143                                            0143 00485000
         CLI   SSIDDEV(EQCWKPTR),X'04'                             0143 00486000
         BE    @RF00143                                            0143 00487000
*           WORKAPR='1'B;           /* SET APR FLAG.         @Y30LB51*/ 00488000
         OI    WORKAPR(EQCWKPTR),B'00100000'                       0144 00489000
*         ELSE                                                     0145 00490000
*           ;                       /* SUBFMT AND SSID OK.   @Y30LB51*/ 00491000
@RF00143 DS    0H                                                  0146 00492000
*   END MSCFOUR;                    /*                       @Y30LB51*/ 00493000
@EL00005 DS    0H                                                  0146 00494000
@EF00005 DS    0H                                                  0146 00495000
@ER00005 L     @14,12(,@13)                                        0146 00496000
         BR    @14                                                 0146 00497000
*PROCREC:                                                          0147 00498000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/ 00499000
*                                                                  0147 00500000
PROCREC  ST    @14,@SA00006                                        0147 00501000
*   /*****************************************************************/ 00502000
*   /*                                                               */ 00503000
*   /* THIS ROUTINE WILL PROCESS THE RECORD. FOR THE FIRST 100       */ 00504000
*   /* RECORDS THE RECORD WILL BE PLACED INTO THE ACCUMULATOR TABLE  */ 00505000
*   /* IN THE ORDER OF RECEIPT. FOR ALL RECORDS AFTER THE FIRST 100  */ 00506000
*   /* RECORDS, THE NEW RECORD WILL REPLACE THE OLDEST RECORD IN THE */ 00507000
*   /* ACCUMULATOR. RECORDS WILL BE CHAINED IN ASCENDING ORDER OF THE*/ 00508000
*   /* OF THE DATE/TIME STAMP.                                       */ 00509000
*   /*                                                               */ 00510000
*   /*****************************************************************/ 00511000
*                                                                  0148 00512000
*   IF RECCOUNT>=100 THEN           /* IF 100 OR MORE RECORDS IN   0148 00513000
*                                      TABLE                 @Y30LB51*/ 00514000
         LH    @10,RECCOUNT(,EQCWKPTR)                             0148 00515000
         CH    @10,@CH00338                                        0148 00516000
         BL    @RF00148                                            0148 00517000
*     IF DATETIME>OLDPTR->EQCDT THEN/* AND IF RECORD LATER THAN    0149 00518000
*                                      OLDEST RECORD         @Y30LB51*/ 00519000
         L     @10,LOGPTR(,EQCWKPTR)                               0149 00520000
         L     @04,OLDPTR(,EQCWKPTR)                               0149 00521000
         CLC   DATETIME(8,@10),EQCDT(@04)                          0149 00522000
         BNH   @RF00149                                            0149 00523000
*       DO;                         /* PUT IT IN ACCUMULATOR.      0150 00524000
*                                                            @Y30LB51*/ 00525000
*         PTRSAVE=OLDPTR;           /* PREPARE PTRS TO REPLACE OLDEST   00526000
*                                                            @Y30LB51*/ 00527000
         ST    @04,PTRSAVE(,EQCWKPTR)                              0151 00528000
*         OLDPTR=PTRSAVE->EQCTPTR;  /* ENTRY WITH NEW RECORD AND   0152 00529000
*                                                            @Y30LB51*/ 00530000
         MVC   OLDPTR(4,EQCWKPTR),EQCTPTR(@04)                     0152 00531000
*         FREEPTR=PTRSAVE;          /* ESTABLISH NEW CHAIN START.  0153 00532000
*                                                            @Y30LB51*/ 00533000
         ST    @04,FREEPTR(,EQCWKPTR)                              0153 00534000
*         CALL RECIN;               /* PLACE RECORD IN ACCUMULATOR.     00535000
*                                                            @Y30LB51*/ 00536000
         BAL   @14,RECIN                                           0154 00537000
*         CALL EQCSORT;             /* PLACE IT ON CHAIN.    @Y30LB51*/ 00538000
         BAL   @14,EQCSORT                                         0155 00539000
*       END;                        /*                       @Y30LB51*/ 00540000
*     ELSE                                                         0157 00541000
*       ;                           /* RECORD OLDER THAN OLDEST    0157 00542000
*                                      ENTRY.                @Y30LB51*/ 00543000
@RF00149 DS    0H                                                  0158 00544000
*   ELSE                            /* LESS THAN 100 RECORDS.      0158 00545000
*                                                            @Y30LB51*/ 00546000
*     DO;                           /*                       @Y30LB51*/ 00547000
         B     @RC00148                                            0158 00548000
@RF00148 DS    0H                                                  0159 00549000
*       CALL RECIN;                 /* PUT RECORD IN ACCUMULATOR.  0159 00550000
*                                                            @Y30LB51*/ 00551000
         BAL   @14,RECIN                                           0159 00552000
*       CALL EQCSORT;               /* PUT IT ON CHAIN.      @Y30LB51*/ 00553000
         BAL   @14,EQCSORT                                         0160 00554000
*       FREEPTR=FREEPTR+LENGTH(EQCTBL);/*                          0161 00555000
*                                      SET PTR TO NEXT FREE ELEMENT.    00556000
*                                                            @Y30LB51*/ 00557000
         LA    @10,56                                              0161 00558000
         AL    @10,FREEPTR(,EQCWKPTR)                              0161 00559000
         ST    @10,FREEPTR(,EQCWKPTR)                              0161 00560000
*     END;                          /*                       @Y30LB51*/ 00561000
*   END PROCREC;                    /*                       @Y30LB51*/ 00562000
@EL00006 DS    0H                                                  0163 00563000
@EF00006 DS    0H                                                  0163 00564000
@ER00006 L     @14,@SA00006                                        0163 00565000
         BR    @14                                                 0163 00566000
*RECIN:                                                            0164 00567000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/ 00568000
*                                                                  0164 00569000
RECIN    ST    @14,@SA00007                                        0164 00570000
*   /*****************************************************************/ 00571000
*   /*                                                               */ 00572000
*   /* THIS ROUTINE WILL PLACE THE RECORD INTO THE ACCUMULATOR WHEN  */ 00573000
*   /* CALLED BY ROUTINE 'PROCREC'.                                  */ 00574000
*   /*                                                               */ 00575000
*   /*****************************************************************/ 00576000
*                                                                  0165 00577000
*   TBLPTR=FREEPTR;                 /* SET PTR TO TABLE SPACE      0165 00578000
*                                                            @Y30LB51*/ 00579000
         L     TBLPTR,FREEPTR(,EQCWKPTR)                           0165 00580000
*   EQCTBL=''B;                     /* AND ZERO IT OUT.      @Y30LB51*/ 00581000
         XC    EQCTBL(56,TBLPTR),EQCTBL(TBLPTR)                    0166 00582000
*   EQCRUA=RUASAVE;                 /* PUT RUA INTO TABLE.   @ZD00149*/ 00583000
         MVC   EQCRUA(2,TBLPTR),RUASAVE(EQCWKPTR)                  0167 00584000
*   EQCSSID=SSIDSAVE;               /* PUT SSID INTO TABLE.  @Y30LB51*/ 00585000
         MVC   EQCSSID(2,TBLPTR),SSIDSAVE(EQCWKPTR)                0168 00586000
*   EQCDT=DATETIME;                 /* PUT DATE/TIME STAMP INTO    0169 00587000
*                                      TABLE.                @Y30LB51*/ 00588000
         L     @10,LOGPTR(,EQCWKPTR)                               0169 00589000
         MVC   EQCDT(8,TBLPTR),DATETIME(@10)                       0169 00590000
*   IF INDEVTYP='S' THEN            /* IF SUBSYSTEM RECORD   @Y30LB51*/ 00591000
         L     @10,SDA00PTR(,CVTPTR)                               0170 00592000
         CLI   INDEVTYP(@10),C'S'                                  0170 00593000
         BNE   @RF00170                                            0170 00594000
*     DO;                           /* PUT 32 BYTES SENSE INTO TABLE.   00595000
*                                                            @Y30LB51*/ 00596000
*       IF FORMATNO(6)='1'B THEN    /* IF FORMAT 5 RECORD    @ZD00149*/ 00597000
         L     @10,SENSEPTR(,EQCWKPTR)                             0172 00598000
         TM    FORMATNO(@10),B'00000100'                           0172 00599000
         BNO   @RF00172                                            0172 00600000
*         CALL PUTDEV;              /* PUT DEVICE IDS INTO TABLE.  0173 00601000
*                                                            @ZD00149*/ 00602000
         BAL   @14,PUTDEV                                          0173 00603000
*       ELSE                                                       0174 00604000
*         ;                         /* NOT A FORMAT 5 RECORD.      0174 00605000
*                                                            @ZD00149*/ 00606000
@RF00172 DS    0H                                                  0175 00607000
*       EQCSENSE=ISDAMSCS;          /* PUT SENSE INTO TABLE. @Y30LB51*/ 00608000
         L     @10,SENSEPTR(,EQCWKPTR)                             0175 00609000
         MVC   EQCSENSE(32,TBLPTR),ISDAMSCS(@10)                   0175 00610000
*       IF FORMATNO(4)='1'B THEN    /* IF MSC FMT 3 RECORD   @Y30LB51*/ 00611000
         TM    FORMATNO(@10),B'00010000'                           0176 00612000
         BNO   @RF00176                                            0176 00613000
*         DO;                       /* PUT FSC INTO TABLE.   @Y30LB51*/ 00614000
*           CSFLAG='1'B;            /* SET CS DEVICE FLAG.   @Y30.B51*/ 00615000
         OI    CSFLAG(TBLPTR),B'00000001'                          0178 00616000
*           IF FMT3ACC1='1'B THEN   /* IF RT ACC FSC         @Y30LB51*/ 00617000
         TM    FMT3ACC1(EQCWKPTR),B'10000000'                      0179 00618000
         BNO   @RF00179                                            0179 00619000
*             DO;                   /* PUT RT ACC FSC INTO TABLE.  0180 00620000
*                                                            @Y30LB51*/ 00621000
*               EQCFSC=FSCSAVE1;    /* PUT RT ACC FSC INTO TABLE.  0181 00622000
*                                                            @Y30LB51*/ 00623000
         MVC   EQCFSC(4,TBLPTR),FSCSAVE1(EQCWKPTR)                 0181 00624000
*               FMT3ACC1='0'B;      /* RESET RT ACC FSC FLAG.      0182 00625000
*                                                            @Y30LB51*/ 00626000
         NI    FMT3ACC1(EQCWKPTR),B'01111111'                      0182 00627000
*             END;                  /*                       @Y30LB51*/ 00628000
*           ELSE                    /* NOT RT ACC FSC,       @Y30LB51*/ 00629000
*             DO;                   /* MUST BE LEFT ACC FSC. @Y30LB51*/ 00630000
         B     @RC00179                                            0184 00631000
@RF00179 DS    0H                                                  0185 00632000
*               EQCFSC=FSCSAVE2;    /* PUT LEFT ACC FSC INTO TABLE.     00633000
*                                                            @Y30LB51*/ 00634000
         MVC   EQCFSC(4,TBLPTR),FSCSAVE2(EQCWKPTR)                 0185 00635000
*               FMT3ACC2='0'B;      /* RESET LEFT ACC FSC FLAG.    0186 00636000
*                                                            @Y30LB51*/ 00637000
         NI    FMT3ACC2(EQCWKPTR),B'10111111'                      0186 00638000
*             END;                  /*                       @Y30LB51*/ 00639000
*         END;                      /*                       @Y30LB51*/ 00640000
*       ELSE                        /* NOT MSC FORMAT 3 RECORD.    0189 00641000
*                                                            @Y30LB51*/ 00642000
*         DO;                       /*                       @Y30LB51*/ 00643000
         B     @RC00176                                            0189 00644000
@RF00176 DS    0H                                                  0190 00645000
*           FSCSYS=FSCSYSSV;        /* PUT FSC IN TABLE.     @Y30LB51*/ 00646000
         MVC   FSCSYS(2,TBLPTR),FSCSYSSV(EQCWKPTR)                 0190 00647000
*           IF WORKAPR='1'B THEN    /* IF ALTERED SSID       @Y30LB51*/ 00648000
         TM    WORKAPR(EQCWKPTR),B'00100000'                       0191 00649000
         BNO   @RF00191                                            0191 00650000
*             EQCAPR='1'B;          /* SET APR FLAG.         @Y30LB51*/ 00651000
         OI    EQCAPR(TBLPTR),B'00000100'                          0192 00652000
*           ELSE                    /* NOT ALTERED SSID.     @Y30LB51*/ 00653000
*             IF NOFSC='1'B THEN    /* IF NO FSC             @Y30LB51*/ 00654000
         B     @RC00191                                            0193 00655000
@RF00191 TM    NOFSC(EQCWKPTR),B'00010000'                         0193 00656000
         BNO   @RF00193                                            0193 00657000
*               EQCNOFSC='1'B;      /* SET NO FSC FLAG.      @Y30LB51*/ 00658000
         OI    EQCNOFSC(TBLPTR),B'00001000'                        0194 00659000
*             ELSE                                                 0195 00660000
*               ;                   /* FSC PRESENT.          @Y30LB51*/ 00661000
@RF00193 DS    0H                                                  0196 00662000
*           IF MSCREC='1'B THEN     /* IF MSC RECORD         @Y30LB51*/ 00663000
@RC00191 TM    MSCREC(EQCWKPTR),B'00001000'                        0196 00664000
         BNO   @RF00196                                            0196 00665000
*             MSCFLAG='1'B;         /* SET MSC FLAG.         @Y30LB51*/ 00666000
         OI    MSCFLAG(TBLPTR),B'00000010'                         0197 00667000
*           ELSE                                                   0198 00668000
*             ;                     /* NOT MSC RECORD.       @Y30LB51*/ 00669000
@RF00196 DS    0H                                                  0199 00670000
*         END;                      /*                       @Y30LB51*/ 00671000
*     END;                          /*                       @Y30LB51*/ 00672000
*   ELSE                            /* NOT SUBSYSTEM RECORD  @Y30LB51*/ 00673000
*     DO;                           /* MUST BE DASD RECORD.  @Y30LB51*/ 00674000
         B     @RC00170                                            0201 00675000
@RF00170 DS    0H                                                  0202 00676000
*       EQCFSC=FSCSYSSV;            /* PUT DASD FSC INTO TABLE.    0202 00677000
*                                                            @Y30LB51*/ 00678000
         MVI   EQCFSC+2(TBLPTR),C' '                               0202 00679000
         MVI   EQCFSC+3(TBLPTR),C' '                               0202 00680000
         MVC   EQCFSC(2,TBLPTR),FSCSYSSV(EQCWKPTR)                 0202 00681000
*       CALL PUTDEV;                /* PUT DEVICE IDS INTO TABLE.  0203 00682000
*                                                            @ZD00149*/ 00683000
         BAL   @14,PUTDEV                                          0203 00684000
*       EQCSENSE='';                /* BLANK OUT SENSE AREA. @Y30LB51*/ 00685000
         MVI   EQCSENSE(TBLPTR),C' '                               0204 00686000
         MVC   EQCSENSE+1(31,TBLPTR),EQCSENSE(TBLPTR)              0204 00687000
*       DASDDATA=MSCDASD;           /* PUT DASD SENSE INTO TABLE.  0205 00688000
*                                                            @Y30LB51*/ 00689000
         L     @10,SENSEPTR(,EQCWKPTR)                             0205 00690000
         MVC   DASDDATA(28,TBLPTR),MSCDASD(@10)                    0205 00691000
*       DASDFLAG='1'B;              /* SET DASD SSID FLAG.   @Y30LB51*/ 00692000
         OI    DASDFLAG(TBLPTR),B'01000000'                        0206 00693000
*       IF INDEVTYP='R' THEN        /* IF REAL DASD SSID     @Y30LB51*/ 00694000
         L     @10,SDA00PTR(,CVTPTR)                               0207 00695000
         CLI   INDEVTYP(@10),C'R'                                  0207 00696000
         BNE   @RF00207                                            0207 00697000
*         REALDASD='1'B;            /* SET REAL DASD SSID FLAG.    0208 00698000
*                                                            @Y30LB51*/ 00699000
         OI    REALDASD(TBLPTR),B'00100000'                        0208 00700000
*       ELSE                        /* NOT REAL DASD SSID    @Y30LB51*/ 00701000
*         VIRTDASD='1'B;            /* SET VIRTUAL DASD SSID FLAG. 0209 00702000
*                                                            @Y30LB51*/ 00703000
         B     @RC00207                                            0209 00704000
@RF00207 OI    VIRTDASD(TBLPTR),B'00010000'                        0209 00705000
*     END;                          /*                       @Y30LB51*/ 00706000
@RC00207 DS    0H                                                  0211 00707000
*   IF SDAFLAG0(8)='1'B THEN        /* IF GENERATED FSC      @Y30LB51*/ 00708000
@RC00170 L     @10,SDA00PTR(,CVTPTR)                               0211 00709000
         TM    SDAFLAG0(@10),B'00000001'                           0211 00710000
         BNO   @RF00211                                            0211 00711000
*     FAKEFSC='1'B;                 /* SET GENERATED FSC FLAG.     0212 00712000
*                                                            @Y30LB51*/ 00713000
         OI    FAKEFSC(TBLPTR),B'10000000'                         0212 00714000
*   ELSE                                                           0213 00715000
*     ;                             /* NOT GENERATED FSC.    @Y30LB51*/ 00716000
@RF00211 DS    0H                                                  0214 00717000
*   RECCOUNT=RECCOUNT+1;            /* ADD ONE TO RECORD COUNTER.  0214 00718000
*                                                            @Y30LB51*/ 00719000
         LA    @10,1                                               0214 00720000
         AH    @10,RECCOUNT(,EQCWKPTR)                             0214 00721000
         STH   @10,RECCOUNT(,EQCWKPTR)                             0214 00722000
*   END RECIN;                      /*                       @Y30LB51*/ 00723000
@EL00007 DS    0H                                                  0215 00724000
@EF00007 DS    0H                                                  0215 00725000
@ER00007 L     @14,@SA00007                                        0215 00726000
         BR    @14                                                 0215 00727000
*PUTDEV:                                                           0216 00728000
*   PROC OPTIONS(SAVE(14));         /*                       @ZD00149*/ 00729000
*                                                                  0216 00730000
PUTDEV   ST    @14,12(,@13)                                        0216 00731000
*   /*****************************************************************/ 00732000
*   /*                                                               */ 00733000
*   /* THIS ROUTINE WILL DETERMINE THE CONTROL UNIT AND DEVICE IDS,  */ 00734000
*   /* IF PRESENT, AND STORE THEM.                                   */ 00735000
*   /*                                                               */ 00736000
*   /*****************************************************************/ 00737000
*                                                                  0217 00738000
*   IF INDEVTYP='S' THEN            /* IF MSC RECORD         @ZD00149*/ 00739000
         L     @10,SDA00PTR(,CVTPTR)                               0217 00740000
         CLI   INDEVTYP(@10),C'S'                                  0217 00741000
         BNE   @RF00217                                            0217 00742000
*     IF DRIVEID^='00'X&DRIVEID^='FF'X THEN /* HAVE DRIVE ID @ZA05081*/ 00743000
         L     @10,SENSEPTR(,EQCWKPTR)                             0218 00744000
         CLI   DRIVEID(@10),X'00'                                  0218 00745000
         BE    @RF00218                                            0218 00746000
         CLI   DRIVEID(@10),X'FF'                                  0218 00747000
         BE    @RF00218                                            0218 00748000
*       DEVBYTEA=DRIVEID;           /* GET THE DRIVE ID.     @ZD00149*/ 00749000
         MVC   DEVBYTEA(1,EQCWKPTR),DRIVEID(@10)                   0219 00750000
*     ELSE                          /* NO DRIVE ID PRESENT,  @ZD00149*/ 00751000
*       DEVBYTEA=0;                 /* SET WORK AREA TO ZERO.      0220 00752000
*                                                            @ZD00149*/ 00753000
         B     @RC00218                                            0220 00754000
@RF00218 MVI   DEVBYTEA(EQCWKPTR),X'00'                            0220 00755000
*   ELSE                            /* NOT A SUBSYSTEM RECORD,     0221 00756000
*                                                            @ZD00149*/ 00757000
*     IF DRIVE^='00'X&DRIVE^='FF'X THEN /* HAVE DRIVE ID     @ZA05081*/ 00758000
         B     @RC00217                                            0221 00759000
@RF00217 L     @10,SENSEPTR(,EQCWKPTR)                             0221 00760000
         CLI   DRIVE(@10),X'00'                                    0221 00761000
         BE    @RF00221                                            0221 00762000
         CLI   DRIVE(@10),X'FF'                                    0221 00763000
         BE    @RF00221                                            0221 00764000
*       DEVBYTEA=DRIVE;             /* GET THEM.             @ZD00149*/ 00765000
         MVC   DEVBYTEA(1,EQCWKPTR),DRIVE(@10)                     0222 00766000
*     ELSE                          /* DRIVE ID NOT PRESENT, @ZD00149*/ 00767000
*       DEVBYTEA=0;                 /* SET WORK AREA TO ZERO.      0223 00768000
*                                                            @ZD00149*/ 00769000
         B     @RC00221                                            0223 00770000
@RF00221 MVI   DEVBYTEA(EQCWKPTR),X'00'                            0223 00771000
*   IF DEVBYTEA^=0 THEN             /* IF A DEVICE ID IS PRESENT   0224 00772000
*                                                            @ZD00149*/ 00773000
@RC00221 DS    0H                                                  0224 00774000
@RC00217 CLI   DEVBYTEA(EQCWKPTR),0                                0224 00775000
         BE    @RF00224                                            0224 00776000
*     DO;                           /* PROCESS IT.           @ZD00149*/ 00777000
*       CNTLUNIT=DEVBYTEA;          /* GET THE DEVICE IDS,   @ZD00149*/ 00778000
         MVC   CNTLUNIT(1,TBLPTR),DEVBYTEA(EQCWKPTR)               0226 00779000
*       SRL(CNTLUNIT,6);            /* ISOLATE THE CONTROL UNIT ID 0227 00780000
*                                                            @ZD00149*/ 00781000
         SLR   @10,@10                                             0227 00782000
         IC    @10,CNTLUNIT(,TBLPTR)                               0227 00783000
         SRL   @10,6                                               0227 00784000
         STC   @10,CNTLUNIT(,TBLPTR)                               0227 00785000
*       CNTLUNIT=CNTLUNIT|'F0'X;    /* AND MAKE IT PRINTABLE.      0228 00786000
*                                                            @ZD00149*/ 00787000
         OI    CNTLUNIT(TBLPTR),X'F0'                              0228 00788000
*       DEVBYTEA=DEVBYTEA&'3F'X;    /* ISOLATE THE DRIVE ID. @ZD00149*/ 00789000
         NI    DEVBYTEA(EQCWKPTR),X'3F'                            0229 00790000
*       DO I=1 TO 8 WHILE(DEVBYTEA^=DEVICES(I));/* LOCATE THE DEVICE    00791000
*                                      ID.                   @ZD00149*/ 00792000
         LA    @10,1                                               0230 00793000
         STH   @10,I(,EQCWKPTR)                                    0230 00794000
@DL00230 LH    @10,I(,EQCWKPTR)                                    0230 00795000
         LA    @01,DEVICES-1(@10)                                  0230 00796000
         CLC   DEVBYTEA(1,EQCWKPTR),0(@01)                         0230 00797000
         BE    @DC00230                                            0230 00798000
*       END;                        /*                       @ZD00149*/ 00799000
         LA    @10,1                                               0231 00800000
         AH    @10,I(,EQCWKPTR)                                    0231 00801000
         STH   @10,I(,EQCWKPTR)                                    0231 00802000
         CH    @10,@CH00070                                        0231 00803000
         BNH   @DL00230                                            0231 00804000
@DC00230 DS    0H                                                  0232 00805000
*       IF I<9 THEN                 /* IF DEVICE ID FOUND    @ZD00149*/ 00806000
         LH    @10,I(,EQCWKPTR)                                    0232 00807000
         CH    @10,@CH00410                                        0232 00808000
         BNL   @RF00232                                            0232 00809000
*         UNITID=DEVIDS(I);         /* PUT DEVICE ID INTO RECORD.  0233 00810000
*                                                            @ZD00149*/ 00811000
         LA    @01,DEVIDS-1(@10)                                   0233 00812000
         MVC   UNITID(1,TBLPTR),0(@01)                             0233 00813000
*      ELSE                                                        0234 00814000
*        ;                          /*                       @ZD00149*/ 00815000
@RF00232 DS    0H                                                  0235 00816000
*       DEVIN='1'B;                 /* SET PUT DEVICES FLAG. @ZD00149*/ 00817000
         OI    DEVIN(TBLPTR),B'10000000'                           0235 00818000
*     END;                          /*                       @ZD00149*/ 00819000
*   ELSE                                                           0237 00820000
*     ;                             /* NO DEVICE IDS PRESENT.      0237 00821000
*                                                            @ZD00149*/ 00822000
@RF00224 DS    0H                                                  0238 00823000
*   END PUTDEV;                     /*                       @ZD00149*/ 00824000
@EL00008 DS    0H                                                  0238 00825000
@EF00008 DS    0H                                                  0238 00826000
@ER00008 L     @14,12(,@13)                                        0238 00827000
         BR    @14                                                 0238 00828000
*EQCSORT:                                                          0239 00829000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/ 00830000
*                                                                  0239 00831000
EQCSORT  ST    @14,12(,@13)                                        0239 00832000
*   /*****************************************************************/ 00833000
*   /*                                                               */ 00834000
*   /* THIS ROUTINE WILL PLACE THE NEW ACCUMULATOR ENTRY INTO THE    */ 00835000
*   /* CHAIN IN ASCENDING ORDER OF DATE/TIME STAMP.                  */ 00836000
*   /*                                                               */ 00837000
*   /*****************************************************************/ 00838000
*                                                                  0240 00839000
*   IF RECCOUNT=1 THEN              /* IF FIRST ENTRY        @Y30LB51*/ 00840000
         CLC   RECCOUNT(2,EQCWKPTR),@CH00082                       0240 00841000
         BNE   @RF00240                                            0240 00842000
*     OLDPTR=FREEPTR;               /* SAVE CHAIN START ADDRESS.   0241 00843000
*                                                            @Y30LB51*/ 00844000
         MVC   OLDPTR(4,EQCWKPTR),FREEPTR(EQCWKPTR)                0241 00845000
*   ELSE                            /* NOT FIRST ENTRY.      @Y30LB51*/ 00846000
*     DO;                           /* PUT RECORD ONTO CHAIN.      0242 00847000
*                                                            @Y30LB51*/ 00848000
         B     @RC00240                                            0242 00849000
@RF00240 DS    0H                                                  0243 00850000
*       TBLPTR=OLDPTR;              /* SET PTR TO CHAIN START.     0243 00851000
*                                                            @Y30LB51*/ 00852000
         L     TBLPTR,OLDPTR(,EQCWKPTR)                            0243 00853000
*       DO WHILE(TBLPTR^=0)&(FREEPTR->EQCDT>=EQCDT);/* SEARCH FOR  0244 00854000
*                                      PLACE ON CHAIN OR END OF    0244 00855000
*                                      CHAIN.                @Y30LB51*/ 00856000
         B     @DE00244                                            0244 00857000
@DL00244 DS    0H                                                  0245 00858000
*         PTRSAVE=TBLPTR;           /* SAVE ADDRESS CURRENT ENTRY. 0245 00859000
*                                                            @Y30LB51*/ 00860000
         ST    TBLPTR,PTRSAVE(,EQCWKPTR)                           0245 00861000
*         TBLPTR=EQCTPTR;           /* SET PTR TO NEXT CHAIN ENTRY.     00862000
*                                                            @Y30LB51*/ 00863000
         L     TBLPTR,EQCTPTR(,TBLPTR)                             0246 00864000
*       END;                        /*                       @Y30LB51*/ 00865000
@DE00244 LTR   TBLPTR,TBLPTR                                       0247 00866000
         BZ    @DC00244                                            0247 00867000
         L     @10,FREEPTR(,EQCWKPTR)                              0247 00868000
         CLC   EQCDT(8,@10),EQCDT(TBLPTR)                          0247 00869000
         BNL   @DL00244                                            0247 00870000
@DC00244 DS    0H                                                  0248 00871000
*       IF TBLPTR=0 THEN            /* IF AT END OF CHAIN    @Y30LB51*/ 00872000
         SLR   @10,@10                                             0248 00873000
         CR    TBLPTR,@10                                          0248 00874000
         BNE   @RF00248                                            0248 00875000
*         DO;                       /* ADD NEW RECORD TO CHAIN.    0249 00876000
*                                                            @Y30LB51*/ 00877000
*           PTRSAVE->EQCTPTR=FREEPTR;/* ADD IT TO END OF CHAIN.    0250 00878000
*                                                            @Y30LB51*/ 00879000
         L     @04,PTRSAVE(,EQCWKPTR)                              0250 00880000
         L     @15,FREEPTR(,EQCWKPTR)                              0250 00881000
         ST    @15,EQCTPTR(,@04)                                   0250 00882000
*           FREEPTR->EQCTPTR=0;     /* SET END OF CHAIN INDICATOR. 0251 00883000
*                                                            @Y30LB51*/ 00884000
         ST    @10,EQCTPTR(,@15)                                   0251 00885000
*         END;                      /*                       @Y30LB51*/ 00886000
*       ELSE                        /* INSERT NEW ENTRY IN ITS     0253 00887000
*                                                            @Y30LB51*/ 00888000
*         DO;                       /* PLACE ON THE CHAIN.   @Y30LB51*/ 00889000
         B     @RC00248                                            0253 00890000
@RF00248 DS    0H                                                  0254 00891000
*           FREEPTR->EQCTPTR=TBLPTR;/* POINT NEW ENTRY TO OLD ENTRY.    00892000
*                                                            @Y30LB51*/ 00893000
         L     @10,FREEPTR(,EQCWKPTR)                              0254 00894000
         ST    TBLPTR,EQCTPTR(,@10)                                0254 00895000
*           IF TBLPTR=OLDPTR THEN   /* IF NEW ENTRY OLDEST IN TABLE     00896000
*                                                            @Y30LB51*/ 00897000
         C     TBLPTR,OLDPTR(,EQCWKPTR)                            0255 00898000
         BNE   @RF00255                                            0255 00899000
*             OLDPTR=FREEPTR;       /* SET NEW CHAIN START.  @Y30LB51*/ 00900000
         ST    @10,OLDPTR(,EQCWKPTR)                               0256 00901000
*           ELSE                    /* NEW ENTRY NOT OLDEST IN TABLE.   00902000
*                                                            @Y30LB51*/ 00903000
*             PTRSAVE->EQCTPTR=FREEPTR;/* POINT OLD ENTRY TO NEW   0257 00904000
*                                      ENTRY.                @Y30LB51*/ 00905000
         B     @RC00255                                            0257 00906000
@RF00255 L     @10,PTRSAVE(,EQCWKPTR)                              0257 00907000
         MVC   EQCTPTR(4,@10),FREEPTR(EQCWKPTR)                    0257 00908000
*         END;                      /*                       @Y30LB51*/ 00909000
*     END;                          /*                       @Y30LB51*/ 00910000
*   END EQCSORT;                    /*                       @Y30LB51*/ 00911000
@EL00009 DS    0H                                                  0260 00912000
@EF00009 DS    0H                                                  0260 00913000
@ER00009 L     @14,12(,@13)                                        0260 00914000
         BR    @14                                                 0260 00915000
*FREECORE:                                                         0261 00916000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/ 00917000
*                                                                  0261 00918000
FREECORE ST    @14,@SA00010                                        0261 00919000
*   /*****************************************************************/ 00920000
*   /*                                                               */ 00921000
*   /* THIS ROUTINE WILL FREE ALL GOTTEN CORE VIA THE ISDAFREE       */ 00922000
*   /* ROUTINE.                                                      */ 00923000
*   /*                                                               */ 00924000
*   /*****************************************************************/ 00925000
*                                                                  0262 00926000
*   SPNO='05'X;                     /* GET SUBPOOL NUMBER.   @Y30LB51*/ 00927000
         MVI   SPNO(CVTPTR),X'05'                                  0262 00928000
*   IF EQC00PTR^=0 THEN             /* IF WORK AREA EXISTS   @Y30LB51*/ 00929000
         SLR   @10,@10                                             0263 00930000
         C     @10,EQC00PTR(,CVTPTR)                               0263 00931000
         BE    @RF00263                                            0263 00932000
*     DO;                           /* FREE IT.              @Y30LB51*/ 00933000
*       IF GET0PTR^=0 THEN          /* IF ACCUMULATOR TABLE EXISTS 0265 00934000
*                                                            @ZM31022*/ 00935000
         L     @07,GET0PTR(,EQCWKPTR)                              0265 00936000
         CR    @07,@10                                             0265 00937000
         BE    @RF00265                                            0265 00938000
*         DO;                       /* FREE IT.              @ZM31022*/ 00939000
*           CORELEN=LENGTH(ISDAGHDR)+LENGTH(EQCTBL)*TBLNR;/*       0267 00940000
*                                             GET ACCUMULATOR TABLE     00941000
*                                      LENGTH                @ZM31022*/ 00942000
         MVC   CORELEN(3,CVTPTR),@CF00419+1                        0267 00943000
*           COREADDR=GET0PTR;       /* AND ADDRESS           @ZM31022*/ 00944000
         ST    @07,COREADDR(,CVTPTR)                               0268 00945000
*           CALL ISDAFREE(WORKPTR); /* AND FREE IT.                  */ 00946000
         L     @10,@PC00001                                        0269 00947000
         ST    @10,@AL00001                                        0269 00948000
         L     @15,@CV00348                                        0269 00949000
         LA    @01,@AL00001                                        0269 00950000
         BALR  @14,@15                                             0269 00951000
*         END;                      /*                       @ZM31022*/ 00952000
*       ELSE;                       /* ACCUMULATOR TABLE DOES NOT  0271 00953000
*                                      EXIST.                @ZM31022*/ 00954000
@RF00265 DS    0H                                                  0272 00955000
*       CORELEN=LENGTH(EQCWORK);    /* GET WORK AREA LENGTH  @Y30LB51*/ 00956000
         MVC   CORELEN(3,CVTPTR),@CF00417+1                        0272 00957000
*       COREADDR=EQC00PTR;          /* AND ADDRESS           @Y30LB51*/ 00958000
         MVC   COREADDR(4,CVTPTR),EQC00PTR(CVTPTR)                 0273 00959000
*       CALL ISDAFREE(WORKPTR);     /* AND FREE IT.          @Y30LB51*/ 00960000
         L     @10,@PC00001                                        0274 00961000
         ST    @10,@AL00001                                        0274 00962000
         L     @15,@CV00348                                        0274 00963000
         LA    @01,@AL00001                                        0274 00964000
         BALR  @14,@15                                             0274 00965000
*     END;                          /*                       @Y30LB51*/ 00966000
*   ELSE                                                           0276 00967000
*     ;                             /* WORK AREA DOES NOT EXIST.   0276 00968000
*                                                            @Y30LB51*/ 00969000
@RF00263 DS    0H                                                  0277 00970000
*   EQC00PTR=0;                     /* SET WORK AREA ADDRESS TO ZERO.   00971000
*                                                            @Y30LB51*/ 00972000
         SLR   @10,@10                                             0277 00973000
         ST    @10,EQC00PTR(,CVTPTR)                               0277 00974000
*   CEQC='00'X;                     /* SET 'DO NOT CALL' SWITCH.   0278 00975000
*                                                            @Y30LB51*/ 00976000
         MVI   CEQC(LPARMPTR),X'00'                                0278 00977000
*   END FREECORE;                   /*                       @Y30LB51*/ 00978000
@EL00010 DS    0H                                                  0279 00979000
@EF00010 DS    0H                                                  0279 00980000
@ER00010 L     @14,@SA00010                                        0279 00981000
         BR    @14                                                 0279 00982000
*   END ISDAEQC0                    /*                       @Y30LB51*/ 00983000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 00984000
*/*%INCLUDE SYSLIB  (ISDACVT )                                        * 00985000
*/*%INCLUDE SYSLIB  (ISDAPRMS)                                        * 00986000
*/*%INCLUDE SYSLIB  (ISDAWORK)                                        * 00987000
*/*%INCLUDE SYSLIB  (ISDASOBR)                                        * 00988000
*/*%INCLUDE SYSLIB  (ISDAMSCS)                                        * 00989000
*/*%INCLUDE SYSLIB  (ISDAGHDR)                                        * 00990000
*/*%INCLUDE SYSLIB  (ISDAEQC5)                                        * 00991000
*;                                                                 0280 00992000
@DATA    DS    0H                                                       00993000
@CH00082 DC    H'1'                                                     00994000
@CH00070 DC    H'8'                                                     00995000
@CH00410 DC    H'9'                                                     00996000
@CH00338 DC    H'100'                                                   00997000
@DATD    DSECT                                                          00998000
         DS    0F                                                       00999000
@SA00001 DS    18F                                                      01000000
@PC00001 DS    1F                                                       01001000
@SA00003 DS    1F                                                       01002000
@SA00006 DS    1F                                                       01003000
@SA00007 DS    1F                                                       01004000
@SA00010 DS    0F                                                       01005000
@SA00002 DS    0F                                                       01006000
         DS    1F                                                       01007000
@AL00001 DS    1A                                                       01008000
ISDAEQC0 CSECT                                                          01009000
         DS    0F                                                       01010000
@CF00417 DC    F'56'                                                    01011000
@CH00417 EQU   @CF00417+2                                               01012000
@CF00419 DC    F'5628'                                                  01013000
@DATD    DSECT                                                          01014000
         DS    0D                                                       01015000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                01016000
@ENDDATD EQU   *                                                        01017000
ISDAEQC0 CSECT                                                          01018000
         NOPR  ((@ENDDATD-@DATD)/161*16)                                01019000
         DS    0F                                                       01020000
@SIZDATD DC    AL1(0)                                                   01021000
         DC    AL3(@ENDDATD-@DATD)                                      01022000
@CV00346 DC    V(ISDAGET0)                                              01023000
@CV00347 DC    V(ISDAGET1)                                              01024000
@CV00348 DC    V(ISDAFREE)                                              01025000
         DS    0D                                                       01026000
@CC00368 DC    C'EQC '                                                  01027000
@CB00336 DC    X'0FFF'                                                  01028000
DEVICES  DC    X'38312A231C150E07'                                      01029000
DEVIDS   DC    X'C1C2C3C4C5C6C7C8'                                      01030000
PATCH    DS    CL50                                                     01031000
         ORG   PATCH                                                    01032000
@NM00025 DC    50X'00'                                                  01033000
         ORG   PATCH+50                                                 01034000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       01035000
@01      EQU   01                                                       01036000
@02      EQU   02                                                       01037000
@03      EQU   03                                                       01038000
@04      EQU   04                                                       01039000
@05      EQU   05                                                       01040000
@06      EQU   06                                                       01041000
@07      EQU   07                                                       01042000
@08      EQU   08                                                       01043000
@09      EQU   09                                                       01044000
@10      EQU   10                                                       01045000
@11      EQU   11                                                       01046000
@12      EQU   12                                                       01047000
@13      EQU   13                                                       01048000
@14      EQU   14                                                       01049000
@15      EQU   15                                                       01050000
EQCRETCD EQU   @05                                                      01051000
TBLPTR   EQU   @04                                                      01052000
EQCWKPTR EQU   @03                                                      01053000
LPARMPTR EQU   @06                                                      01054000
CVTPTR   EQU   @02                                                      01055000
RF       EQU   @15                                                      01056000
ISDACVT  EQU   0                                                        01057000
CVTPTRS0 EQU   ISDACVT                                                  01058000
DATAPTR  EQU   CVTPTRS0                                                 01059000
SDATAPTR EQU   CVTPTRS0+4                                               01060000
PARMPTR  EQU   CVTPTRS0+8                                               01061000
SDA00PTR EQU   CVTPTRS0+12                                              01062000
EQC00PTR EQU   CVTPTRS0+60                                              01063000
GET0CALL EQU   ISDACVT+100                                              01064000
SPNOLEN  EQU   GET0CALL                                                 01065000
SPNO     EQU   SPNOLEN                                                  01066000
CORELEN  EQU   SPNOLEN+1                                                01067000
COREADDR EQU   GET0CALL+4                                               01068000
HEXPCALL EQU   ISDACVT+108                                              01069000
PRT0CALL EQU   ISDACVT+120                                              01070000
OUTLINE  EQU   PRT0CALL                                                 01071000
SDADATD  EQU   ISDACVT+256                                              01072000
PRTDATD  EQU   ISDACVT+416                                              01073000
ISDAPRMS EQU   0                                                        01074000
CINPUT   EQU   ISDAPRMS                                                 01075000
CSTART   EQU   ISDAPRMS+2                                               01076000
CEND     EQU   ISDAPRMS+6                                               01077000
CFSCONLY EQU   ISDAPRMS+13                                              01078000
CSSIDF   EQU   ISDAPRMS+17                                              01079000
CSERIAL  EQU   ISDAPRMS+21                                              01080000
CREPORTS EQU   ISDAPRMS+33                                              01081000
CEQC     EQU   CREPORTS+5                                               01082000
ISDAWORK EQU   0                                                        01083000
INFLAGS  EQU   ISDAWORK                                                 01084000
INDEVTYP EQU   INFLAGS+2                                                01085000
SDAFLAG0 EQU   INFLAGS+3                                                01086000
INRECCUA EQU   ISDAWORK+6                                               01087000
OBRMDR   EQU   0                                                        01088000
SCW      EQU   OBRMDR                                                   01089000
SWITCHES EQU   OBRMDR+6                                                 01090000
DATETIME EQU   OBRMDR+12                                                01091000
DATE     EQU   DATETIME                                                 01092000
TIME     EQU   DATETIME+4                                               01093000
CPUSERID EQU   OBRMDR+21                                                01094000
ISDAMSCS EQU   0                                                        01095000
SUBSYSID EQU   ISDAMSCS+1                                               01096000
SSID     EQU   SUBSYSID                                                 01097000
FORMATNO EQU   ISDAMSCS+3                                               01098000
SUBSENSE EQU   ISDAMSCS+4                                               01099000
SUBSTAT5 EQU   SUBSENSE+1                                               01100000
SUBFMTMG EQU   SUBSENSE+7                                               01101000
SUBFMTNO EQU   SUBFMTMG                                                 01102000
MSCFSC   EQU   SUBSENSE+22                                              01103000
ISDAGHDR EQU   0                                                        01104000
STARTPTR EQU   ISDAGHDR                                                 01105000
GET0SPLN EQU   ISDAGHDR+8                                               01106000
BLOCKID  EQU   ISDAGHDR+20                                              01107000
BLOCKCNT EQU   ISDAGHDR+24                                              01108000
EQCWORK  EQU   0                                                        01109000
GET0PTR  EQU   EQCWORK                                                  01110000
PTRSAVE  EQU   EQCWORK+4                                                01111000
LOGPTR   EQU   EQCWORK+8                                                01112000
SENSEPTR EQU   EQCWORK+12                                               01113000
FREEPTR  EQU   EQCWORK+16                                               01114000
OLDPTR   EQU   EQCWORK+20                                               01115000
RUASAVE  EQU   EQCWORK+24                                               01116000
SSIDSAVE EQU   EQCWORK+26                                               01117000
SSIDDEV  EQU   SSIDSAVE                                                 01118000
FSCSYSSV EQU   EQCWORK+28                                               01119000
FSCSAVE1 EQU   EQCWORK+30                                               01120000
FSCSAVE2 EQU   EQCWORK+34                                               01121000
RECCOUNT EQU   EQCWORK+38                                               01122000
I        EQU   EQCWORK+42                                               01123000
EQCSW    EQU   EQCWORK+52                                               01124000
FMT3ACC1 EQU   EQCSW                                                    01125000
FMT3ACC2 EQU   EQCSW                                                    01126000
WORKAPR  EQU   EQCSW                                                    01127000
NOFSC    EQU   EQCSW                                                    01128000
MSCREC   EQU   EQCSW                                                    01129000
DEVBYTES EQU   EQCWORK+54                                               01130000
DEVBYTEA EQU   DEVBYTES                                                 01131000
EQCTBL   EQU   0                                                        01132000
EQCTPTR  EQU   EQCTBL                                                   01133000
EQCRUA   EQU   EQCTBL+4                                                 01134000
EQCSSID  EQU   EQCTBL+6                                                 01135000
EQCFLAGS EQU   EQCTBL+8                                                 01136000
FAKEFSC  EQU   EQCFLAGS                                                 01137000
DASDFLAG EQU   EQCFLAGS                                                 01138000
REALDASD EQU   EQCFLAGS                                                 01139000
VIRTDASD EQU   EQCFLAGS                                                 01140000
EQCNOFSC EQU   EQCFLAGS                                                 01141000
EQCAPR   EQU   EQCFLAGS                                                 01142000
MSCFLAG  EQU   EQCFLAGS                                                 01143000
CSFLAG   EQU   EQCFLAGS                                                 01144000
DEVIN    EQU   EQCFLAGS+1                                               01145000
EQCFSC   EQU   EQCTBL+10                                                01146000
FSCSYS   EQU   EQCFSC                                                   01147000
EQCDT    EQU   EQCTBL+14                                                01148000
EQCDATE  EQU   EQCDT                                                    01149000
EQCTIME  EQU   EQCDT+4                                                  01150000
EQCUNIT  EQU   EQCTBL+22                                                01151000
CNTLUNIT EQU   EQCUNIT                                                  01152000
UNITID   EQU   EQCUNIT+1                                                01153000
EQCSENSE EQU   EQCTBL+24                                                01154000
DASDDATA EQU   EQCSENSE                                                 01155000
MSCDASD  EQU   0                                                        01156000
DRIVE    EQU   MSCDASD+4                                                01157000
FMTMSG   EQU   MSCDASD+7                                                01158000
DASD10   EQU   MSCDASD+10                                               01159000
FSCDASD  EQU   MSCDASD+22                                               01160000
DASDSSID EQU   MSCDASD+26                                               01161000
MSCFMT3  EQU   4                                                        01162000
STATUS3  EQU   MSCFMT3                                                  01163000
FSCACC1  EQU   MSCFMT3+4                                                01164000
FSCACC2  EQU   MSCFMT3+8                                                01165000
MSCFIVE  EQU   0                                                        01166000
DRIVEID  EQU   MSCFIVE+8                                                01167000
WORKPTR  EQU   0                                                        01168000
*                                      START UNREFERENCED COMPONENTS    01169000
@NM00024 EQU   MSCFIVE+9                                                01170000
@NM00023 EQU   MSCFIVE                                                  01171000
@NM00022 EQU   MSCFMT3+12                                               01172000
@NM00021 EQU   MSCFMT3+1                                                01173000
ENVIRON3 EQU   STATUS3                                                  01174000
@NM00020 EQU   STATUS3                                                  01175000
@NM00019 EQU   MSCDASD+24                                               01176000
@NM00018 EQU   MSCDASD+21                                               01177000
DASD20   EQU   MSCDASD+20                                               01178000
@NM00017 EQU   MSCDASD+12                                               01179000
DASD11   EQU   MSCDASD+11                                               01180000
@NM00016 EQU   DASD10                                                   01181000
CLOCKERR EQU   DASD10                                                   01182000
TIMEBIT  EQU   DASD10                                                   01183000
@NM00015 EQU   MSCDASD+8                                                01184000
DASDMSG  EQU   FMTMSG                                                   01185000
DASDFMT  EQU   FMTMSG                                                   01186000
@NM00014 EQU   MSCDASD+5                                                01187000
@NM00013 EQU   MSCDASD                                                  01188000
@NM00012 EQU   EQCSENSE+28                                              01189000
EQCHSEC  EQU   EQCTIME+3                                                01190000
EQCSEC   EQU   EQCTIME+2                                                01191000
EQCMIN   EQU   EQCTIME+1                                                01192000
EQCHR    EQU   EQCTIME                                                  01193000
EQCDAY   EQU   EQCDATE+2                                                01194000
EQCYR    EQU   EQCDATE                                                  01195000
@NM00011 EQU   EQCFSC+2                                                 01196000
@NM00010 EQU   EQCFLAGS+1                                               01197000
UNITCHAR EQU   EQCSSID+1                                                01198000
DEVCHAR  EQU   EQCSSID                                                  01199000
DEVBYTEB EQU   DEVBYTES+1                                               01200000
@NM00009 EQU   EQCSW                                                    01201000
SENSELEN EQU   EQCWORK+50                                               01202000
L        EQU   EQCWORK+48                                               01203000
K        EQU   EQCWORK+46                                               01204000
J        EQU   EQCWORK+44                                               01205000
LINECT   EQU   EQCWORK+40                                               01206000
@NM00008 EQU   SSIDSAVE+1                                               01207000
@NM00007 EQU   ISDAGHDR+26                                              01208000
LASTPTR  EQU   ISDAGHDR+16                                              01209000
NEXTPTR  EQU   ISDAGHDR+12                                              01210000
GET0LEN  EQU   GET0SPLN+1                                               01211000
GET0SPNO EQU   GET0SPLN                                                 01212000
ENDPTR   EQU   ISDAGHDR+4                                               01213000
SANOMSCD EQU   SUBSENSE+27                                              01214000
RCYLMSCD EQU   SUBSENSE+25                                              01215000
RUAMSCD  EQU   SUBSENSE+24                                              01216000
@NM00006 EQU   SUBSENSE+21                                              01217000
RUADASD  EQU   SUBSENSE+20                                              01218000
DASDFSC  EQU   SUBSENSE+18                                              01219000
@NM00005 EQU   SUBSENSE+8                                               01220000
MSGCODEN EQU   SUBFMTMG                                                 01221000
SALOWAD2 EQU   SUBSENSE+6                                               01222000
SARETRY  EQU   SUBSENSE+5                                               01223000
@NM00004 EQU   SUBSENSE+4                                               01224000
DASDFMTN EQU   SUBSENSE+3                                               01225000
SALOWADD EQU   SUBSENSE+2                                               01226000
SUBSTAT4 EQU   SUBSENSE                                                 01227000
SSIDDEVT EQU   SSID+1                                                   01228000
SSIDLIBN EQU   SSID+1                                                   01229000
SSIDTYPE EQU   SSID                                                     01230000
SSIDFLAG EQU   SUBSYSID                                                 01231000
STATUS   EQU   ISDAMSCS                                                 01232000
CPUID    EQU   CPUSERID+3                                               01233000
CPUSER   EQU   CPUSERID                                                 01234000
VERNO    EQU   OBRMDR+20                                                01235000
TENSHUND EQU   TIME+3                                                   01236000
SECOND   EQU   TIME+2                                                   01237000
MINUTE   EQU   TIME+1                                                   01238000
HOUR     EQU   TIME                                                     01239000
DAY      EQU   DATE+2                                                   01240000
YEAR     EQU   DATE                                                     01241000
RECENTRY EQU   OBRMDR+11                                                01242000
RCDCNT   EQU   OBRMDR+10                                                01243000
SWITCH3  EQU   SWITCHES+3                                               01244000
SWITCH2  EQU   SWITCHES+2                                               01245000
SWITCH1  EQU   SWITCHES+1                                               01246000
SWITCH0  EQU   SWITCHES                                                 01247000
SYSREL   EQU   OBRMDR+5                                                 01248000
CLASRC   EQU   OBRMDR+4                                                 01249000
@NM00003 EQU   SCW+3                                                    01250000
SCODE    EQU   SCW+2                                                    01251000
SLENGTH  EQU   SCW                                                      01252000
DEVPTR   EQU   ISDAWORK+16                                              01253000
NOUTREC  EQU   ISDAWORK+12                                              01254000
NINREC   EQU   ISDAWORK+8                                               01255000
CUABYTE1 EQU   INRECCUA+1                                               01256000
CUABYTE0 EQU   INRECCUA                                                 01257000
DLENGTH  EQU   ISDAWORK+4                                               01258000
INSOURCE EQU   INFLAGS+1                                                01259000
IRECTYPE EQU   INFLAGS                                                  01260000
CTRACE   EQU   ISDAPRMS+48                                              01261000
CGEN     EQU   ISDAPRMS+47                                              01262000
CDETAIL  EQU   ISDAPRMS+46                                              01263000
CPERIOD  EQU   ISDAPRMS+45                                              01264000
CPWR     EQU   CREPORTS+11                                              01265000
CAPRSUU  EQU   CREPORTS+10                                              01266000
CDRC     EQU   CREPORTS+9                                               01267000
CDAT     EQU   CREPORTS+8                                               01268000
CCSBCSF  EQU   CREPORTS+7                                               01269000
CDCKTLX  EQU   CREPORTS+6                                               01270000
CFSC     EQU   CREPORTS+4                                               01271000
CDHEDHU  EQU   CREPORTS+3                                               01272000
CSUM     EQU   CREPORTS+2                                               01273000
CPAD     EQU   CREPORTS+1                                               01274000
CDCS     EQU   CREPORTS                                                 01275000
CSERNO   EQU   CSERIAL+4                                                01276000
@NM00002 EQU   CSERIAL+3                                                01277000
CIBM     EQU   CSERIAL                                                  01278000
CRATIO   EQU   ISDAPRMS+19                                              01279000
CSSID    EQU   CSSIDF                                                   01280000
@NM00001 EQU   CSSIDF                                                   01281000
CFSC34   EQU   CFSCONLY+2                                               01282000
CFSC12   EQU   CFSCONLY                                                 01283000
CTYPE    EQU   ISDAPRMS+11                                              01284000
CSUMMARY EQU   ISDAPRMS+10                                              01285000
CENDDAY  EQU   CEND+2                                                   01286000
CENDYEAR EQU   CEND                                                     01287000
CSTDAY   EQU   CSTART+2                                                 01288000
CSTYEAR  EQU   CSTART                                                   01289000
CHISTIN  EQU   CINPUT+1                                                 01290000
CLOGIN   EQU   CINPUT                                                   01291000
PRTSA001 EQU   PRTDATD                                                  01292000
SDATEMPS EQU   SDADATD+136                                              01293000
SDASA002 EQU   SDADATD+76                                               01294000
SDAPC001 EQU   SDADATD+72                                               01295000
SDASA001 EQU   SDADATD                                                  01296000
SDARPTID EQU   PRT0CALL+133                                             01297000
LINE     EQU   OUTLINE+1                                                01298000
ANSI     EQU   OUTLINE                                                  01299000
DUMPIDNO EQU   HEXPCALL+8                                               01300000
DUMPLEN  EQU   HEXPCALL+4                                               01301000
DUMPADDR EQU   HEXPCALL                                                 01302000
WORKCALL EQU   CVTPTRS0+96                                              01303000
GEN00PTR EQU   CVTPTRS0+92                                              01304000
CNFG0PTR EQU   CVTPTRS0+88                                              01305000
PWR00PTR EQU   CVTPTRS0+84                                              01306000
APR00PTR EQU   CVTPTRS0+80                                              01307000
DRC00PTR EQU   CVTPTRS0+76                                              01308000
DAT00PTR EQU   CVTPTRS0+72                                              01309000
CSB00PTR EQU   CVTPTRS0+68                                              01310000
DCK00PTR EQU   CVTPTRS0+64                                              01311000
FSC00PTR EQU   CVTPTRS0+56                                              01312000
DHE00PTR EQU   CVTPTRS0+52                                              01313000
SUM00PTR EQU   CVTPTRS0+48                                              01314000
PAD00PTR EQU   CVTPTRS0+44                                              01315000
DCS00PTR EQU   CVTPTRS0+40                                              01316000
LOG00PTR EQU   CVTPTRS0+36                                              01317000
HIST0PTR EQU   CVTPTRS0+32                                              01318000
PRT00PTR EQU   CVTPTRS0+28                                              01319000
GET00PTR EQU   CVTPTRS0+24                                              01320000
TYPE0PTR EQU   CVTPTRS0+20                                              01321000
PARM0PTR EQU   CVTPTRS0+16                                              01322000
*                                      END UNREFERENCED COMPONENTS      01323000
@RC00058 EQU   @EL00002                                                 01324000
@RC00097 EQU   @RC00096                                                 01325000
@RC00087 EQU   @EL00003                                                 01326000
@RC00108 EQU   @EL00003                                                 01327000
@RC00117 EQU   @EL00004                                                 01328000
@RC00139 EQU   @EL00005                                                 01329000
@RC00137 EQU   @EL00005                                                 01330000
@RC00135 EQU   @EL00005                                                 01331000
@RC00148 EQU   @EL00006                                                 01332000
@RC00176 EQU   @RC00170                                                 01333000
@RC00218 EQU   @RC00217                                                 01334000
@RC00240 EQU   @EL00009                                                 01335000
@RC00248 EQU   @EL00009                                                 01336000
@RC00255 EQU   @EL00009                                                 01337000
@RC00068 EQU   @RC00058                                                 01338000
@RC00091 EQU   @RC00087                                                 01339000
@RC00179 EQU   @RC00176                                                 01340000
@RC00092 EQU   @RC00091                                                 01341000
@ENDDATA EQU   *                                                        01342000
         END   ISDAEQC0,(C'PLS1829',0603,75268)                         01343000
