         TITLE 'FAULT SYMPTOM CODE REPORT ACCUMULATOR                  *00001000
                        '                                               00002000
ISDAFSC0 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(8)                                              0001 00007000
         DC    C'ISDAFSC0'                                         0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@12                                         0001 00013000
         L     @00,@SIZDATD                                        0001 00014000
         ISDAGSPC R,LV=(0)                                              00015000
         LR    @11,@01                                             0001 00016000
         USING @DATD,@11                                           0001 00017000
         ST    @13,@SA00001+4                                      0001 00018000
         LM    @00,@01,20(@13)                                     0001 00019000
         ST    @11,8(,@13)                                         0001 00020000
         LR    @13,@11                                             0001 00021000
         MVC   @PC00001(4),0(@01)                                  0001 00022000
*                                                                  0027 00023000
*   /*****************************************************************/ 00024000
*   /*                                                               */ 00025000
*   /* PROGRAM START                                                 */ 00026000
*   /*                                                               */ 00027000
*   /*****************************************************************/ 00028000
*                                                                  0027 00029000
*   CVTPTR=WORKPTR;                 /* SET LOCAL PTR TO SDACVT.    0027 00030000
*                                                            @Y30LB51*/ 00031000
         L     @10,@PC00001                                        0027 00032000
         L     CVTPTR,WORKPTR(,@10)                                0027 00033000
*   LPARMPTR=PARMPTR;               /* SET LOCAL PTR TO SDAPARMS.  0028 00034000
*                                                            @Y30LB51*/ 00035000
         L     LPARMPTR,PARMPTR(,CVTPTR)                           0028 00036000
*   FSCRETCD=0;                     /* INITIALIZE RETURN CODE.     0029 00037000
*                                                            @Y30LB51*/ 00038000
         SLR   @10,@10                                             0029 00039000
         LR    FSCRETCD,@10                                        0029 00040000
*   FSCWKPTR=0;                     /* INITIALIZE            @Y30LB51*/ 00041000
         LR    FSCWKPTR,@10                                        0030 00042000
*   CHNPTR=0;                       /* POINTERS.             @Y30LB51*/ 00043000
         LR    CHNPTR,@10                                          0031 00044000
*   IF FSC00PTR=0 THEN              /* IF FIRST ENTRY GET SPACE    0032 00045000
*                                                            @Y30LB51*/ 00046000
         C     @10,FSC00PTR(,CVTPTR)                               0032 00047000
         BNE   @RF00032                                            0032 00048000
*     DO;                           /* FOR WORK AREA AND TABLE.    0033 00049000
*                                                            @Y30LB51*/ 00050000
*       CALL FIRSTENT;              /* GO GET SPACE          @Y30LB51*/ 00051000
         BAL   @14,FIRSTENT                                        0034 00052000
*       IF FSCRETCD=0 THEN          /* IF SPACE SECURED GET  @Y30LB51*/ 00053000
         LTR   FSCRETCD,FSCRETCD                                   0035 00054000
         BNZ   @RF00035                                            0035 00055000
*         DO;                       /* SPACE FOR ACCUMULATOR.      0036 00056000
*                                                            @Y30LB51*/ 00057000
*           CALL GETTBL;            /* GO GET SPACE.         @Y30LB51*/ 00058000
         BAL   @14,GETTBL                                          0037 00059000
*           IF FSCRETCD^=0 THEN     /* IF SPACE NO AVAILABLE @Y30LB51*/ 00060000
         LTR   FSCRETCD,FSCRETCD                                   0038 00061000
         BZ    @RF00038                                            0038 00062000
*             DO;                   /* FREE WORK AREA AND TABLE.   0039 00063000
*                                                            @Y30LB51*/ 00064000
*               CALL FREECORE;      /* GO FREE SPACE,        @Y30LB51*/ 00065000
         BAL   @14,FREECORE                                        0040 00066000
*               CFSC='00'X;         /* SET 'DO NOT CALL' SWITCH    0041 00067000
*                                                            @Y30LB51*/ 00068000
         MVI   CFSC(LPARMPTR),X'00'                                0041 00069000
*               RETURN CODE(FSCRETCD);/* AND RETURN TO CALLER.     0042 00070000
*                                                            @Y30LB51*/ 00071000
         L     @13,4(,@13)                                         0042 00072000
         L     @00,@SIZDATD                                        0042 00073000
         LR    @01,@11                                             0042 00074000
         ISDAFSPC R,LV=(0),A=(1)                                        00075000
         LR    @15,@05                                             0042 00076000
         L     @14,12(,@13)                                        0042 00077000
         LM    @00,@12,20(@13)                                     0042 00078000
         BR    @14                                                 0042 00079000
*             END;                  /*                       @Y30LB51*/ 00080000
*           ELSE                                                   0044 00081000
*             ;                     /* ACCUMULATOR SPACE SECURED.  0044 00082000
*                                                            @Y30LB51*/ 00083000
@RF00038 DS    0H                                                  0045 00084000
*         END;                      /*                       @Y30LB51*/ 00085000
*       ELSE                        /* WORK AREA AND TABLE SPACE NOT    00086000
*                                                            @Y30LB51*/ 00087000
*         RETURN CODE(FSCRETCD);    /* AVAILABLE, RETURN TO CALLER.     00088000
*                                                            @Y30LB51*/ 00089000
         B     @RC00035                                            0046 00090000
@RF00035 L     @13,4(,@13)                                         0046 00091000
         L     @00,@SIZDATD                                        0046 00092000
         LR    @01,@11                                             0046 00093000
         ISDAFSPC R,LV=(0),A=(1)                                        00094000
         LR    @15,@05                                             0046 00095000
         L     @14,12(,@13)                                        0046 00096000
         LM    @00,@12,20(@13)                                     0046 00097000
         BR    @14                                                 0046 00098000
*     END;                          /*                       @Y30LB51*/ 00099000
*   ELSE                            /* ON ALL OTHER ENTRIES  @Y30LB51*/ 00100000
*     DO;                           /* SET POINTERS.         @Y30LB51*/ 00101000
         B     @RC00032                                            0048 00102000
@RF00032 DS    0H                                                  0049 00103000
*       FSCWKPTR=FSC00PTR;          /* SET PTR TO WORK AREA. @Y30LB51*/ 00104000
         L     FSCWKPTR,FSC00PTR(,CVTPTR)                          0049 00105000
*       CHNPTR=CHAINTBL;            /* SET PTR TO CHAIN TABLE.     0050 00106000
*                                                            @Y30LB51*/ 00107000
         L     CHNPTR,CHAINTBL(,FSCWKPTR)                          0050 00108000
*     END;                          /*                       @Y30LB51*/ 00109000
*   LOGPTR=DATAPTR;                 /* SET LOCAL PTR TO RECORD.    0052 00110000
*                                                            @Y30LB51*/ 00111000
@RC00032 MVC   LOGPTR(4,FSCWKPTR),DATAPTR(CVTPTR)                  0052 00112000
*   SENSEPTR=SDATAPTR;              /* SET LOCAL PTR TO SENSE AREA.     00113000
*                                                            @Y30LB51*/ 00114000
         MVC   SENSEPTR(4,FSCWKPTR),SDATAPTR(CVTPTR)               0053 00115000
*   SSIDSAVE=''B;                   /* ZERO OUT SSID SAVE AREA.    0054 00116000
*                                                            @Y30LB51*/ 00117000
         XC    SSIDSAVE(2,FSCWKPTR),SSIDSAVE(FSCWKPTR)             0054 00118000
*   FSCSAVE1=''B;                   /* ZERO OUT FIRST FSC SAVE AREA.    00119000
*                                                            @Y30LB51*/ 00120000
         XC    FSCSAVE1(4,FSCWKPTR),FSCSAVE1(FSCWKPTR)             0055 00121000
*   FSCSAVE2=''B;                   /* ZERO OUT SECOND FSC SAVE AREA.   00122000
*                                                            @Y30LB51*/ 00123000
         XC    FSCSAVE2(4,FSCWKPTR),FSCSAVE2(FSCWKPTR)             0056 00124000
*   WORKFLGS=WORKFLGS&SWOFF;        /* RESET SWITCHES.       @Y30LB51*/ 00125000
         NC    WORKFLGS(2,FSCWKPTR),@CB00418                       0057 00126000
*   IF CFSCONLY^=0 THEN             /* IF USER SPECIFIED AN FSC    0058 00127000
*                                                            @Y30LB51*/ 00128000
         SLR   @10,@10                                             0058 00129000
         CL    @10,CFSCONLY(,LPARMPTR)                             0058 00130000
         BE    @RF00058                                            0058 00131000
*     IF CFSC34^=0 THEN             /* AND IF IT IS LIBRARY FSC    0059 00132000
*                                                            @Y30LB51*/ 00133000
         SLR   @04,@04                                             0059 00134000
         ICM   @04,3,CFSC34(LPARMPTR)                              0059 00135000
         CR    @10,@04                                             0059 00136000
         BE    @RF00059                                            0059 00137000
*       LFSC=CFSCONLY;              /* STORE IT.             @Y30LB51*/ 00138000
         MVC   LFSC(4,FSCWKPTR),CFSCONLY(LPARMPTR)                 0060 00139000
*     ELSE                          /* IT IS NON-LIBRARY FSC.      0061 00140000
*                                                            @Y30LB51*/ 00141000
*       LFSCSYS=CFSC12;             /* STORE NON-LIBRARY FSC.      0061 00142000
*                                                            @Y30LB51*/ 00143000
         B     @RC00059                                            0061 00144000
@RF00059 MVC   LFSCSYS(2,FSCWKPTR),CFSC12(LPARMPTR)                0061 00145000
*   ELSE                                                           0062 00146000
*     ;                             /* USER DID NOT SPECIFY AN FSC.     00147000
*                                                            @Y30LB51*/ 00148000
@RF00058 DS    0H                                                  0063 00149000
*   LSSID=CSSIDF;                   /* STORE USER SPECIFIED SSID.  0063 00150000
*                                                            @Y30LB51*/ 00151000
@RC00058 MVC   LSSID(2,FSCWKPTR),CSSIDF(LPARMPTR)                  0063 00152000
*   LTYPE=CTYPE;                    /* STORE USER SPECIFIED DEVICE 0064 00153000
*                                      TYPE.                 @Y30LB51*/ 00154000
         MVC   LTYPE(2,FSCWKPTR),CTYPE(LPARMPTR)                   0064 00155000
*   CALL RECTYPE;                   /* PROCESS THE RECORD.   @Y30LB51*/ 00156000
         BAL   @14,RECTYPE                                         0065 00157000
*   RETURN CODE(FSCRETCD);          /*                       @Y30LB51*/ 00158000
         L     @13,4(,@13)                                         0066 00159000
         L     @00,@SIZDATD                                        0066 00160000
         LR    @01,@11                                             0066 00161000
         ISDAFSPC R,LV=(0),A=(1)                                        00162000
         LR    @15,@05                                             0066 00163000
         L     @14,12(,@13)                                        0066 00164000
         LM    @00,@12,20(@13)                                     0066 00165000
         BR    @14                                                 0066 00166000
*FIRSTENT:                                                         0067 00167000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/ 00168000
*                                                                  0067 00169000
@EL00001 L     @13,4(,@13)                                         0067 00170000
@EF00001 L     @00,@SIZDATD                                        0067 00171000
         LR    @01,@11                                             0067 00172000
         ISDAFSPC R,LV=(0),A=(1)                                        00173000
@ER00001 LM    @14,@12,12(@13)                                     0067 00174000
         BR    @14                                                 0067 00175000
FIRSTENT ST    @14,@SA00002                                        0067 00176000
*   /*****************************************************************/ 00177000
*   /*                                                               */ 00178000
*   /* THIS ROUTINE IS CALLED ON THE FIRST ENTRY OF ISDAFSC0 TO      */ 00179000
*   /* SECURE SPACE FOR THE WORK AREA AND TABLE.                     */ 00180000
*   /*                                                               */ 00181000
*   /*****************************************************************/ 00182000
*                                                                  0068 00183000
*   CORELEN=LENGTH(FSCWORK);        /* GET WORK AREA LENGTH. @Y30LB51*/ 00184000
         MVC   CORELEN(3,CVTPTR),@CF00552+1                        0068 00185000
*   SPNO='04'X;                     /* SPECIFY SUBPOOL NUMBER.     0069 00186000
*                                                            @Y30LB51*/ 00187000
         MVI   SPNO(CVTPTR),X'04'                                  0069 00188000
*   CALL ISDAGET1(WORKPTR);         /* GET WORK AREA SPACE.  @Y30LB51*/ 00189000
         L     @10,@PC00001                                        0070 00190000
         ST    @10,@AL00001                                        0070 00191000
         L     @15,@CV00432                                        0070 00192000
         LA    @01,@AL00001                                        0070 00193000
         BALR  @14,@15                                             0070 00194000
*   RFY                                                            0071 00195000
*     RF RSTD;                      /*                       @Y30LB51*/ 00196000
*   FSCRETCD=RF;                    /* SAVE THE RETURN CODE. @Y30LB51*/ 00197000
         LR    FSCRETCD,RF                                         0072 00198000
*   RFY                                                            0073 00199000
*     RF UNRSTD;                    /*                       @Y30LB51*/ 00200000
*   IF FSCRETCD=0 THEN              /* IF WORK AREA SPACE SECURED  0074 00201000
*                                                            @Y30LB51*/ 00202000
         SLR   @10,@10                                             0074 00203000
         CR    FSCRETCD,@10                                        0074 00204000
         BNE   @RF00074                                            0074 00205000
*     DO;                           /* INITIALIZE POINTERS.  @Y30LB51*/ 00206000
*       FSC00PTR=COREADDR;          /* SAVE WORK AREA ADDRESS.     0076 00207000
*                                                            @Y30LB51*/ 00208000
         L     @15,COREADDR(,CVTPTR)                               0076 00209000
         ST    @15,FSC00PTR(,CVTPTR)                               0076 00210000
*       FSCWKPTR=COREADDR;          /* SET PTR TO WORK AREA. @Y30LB51*/ 00211000
         LR    FSCWKPTR,@15                                        0077 00212000
*       FSCWORK=''B;                /* ZERO OUT WORK AREA.   @Y30LB51*/ 00213000
         XC    FSCWORK(84,FSCWKPTR),FSCWORK(FSCWKPTR)              0078 00214000
*       IF CNFG0PTR=0 THEN          /* IF NO CONFIGURATION DATA SET     00215000
*                                                            @Y30LB51*/ 00216000
         C     @10,CNFG0PTR(,CVTPTR)                               0079 00217000
         BNE   @RF00079                                            0079 00218000
*         SSIDCT=80;                /* SET MAXIMUM SSID COUNT.     0080 00219000
*                                                            @Y30LB51*/ 00220000
         MVC   SSIDCT(2,FSCWKPTR),@CH00420                         0080 00221000
*       ELSE                        /* CONFIG DATA SET EXISTS.     0081 00222000
*                                                            @Y30LB51*/ 00223000
*         SSIDCT=CNFGTOTL;          /* GET THE SSID COUNT.   @Y30LB51*/ 00224000
         B     @RC00079                                            0081 00225000
@RF00079 L     @10,CNFG0PTR(,CVTPTR)                               0081 00226000
         MVC   SSIDCT(2,FSCWKPTR),CNFGTOTL(@10)                    0081 00227000
*       CORELEN=LENGTH(CHNTBL)*SSIDCT;/*                           0082 00228000
*                                      GET CHAIN TABLE LENGTH.     0082 00229000
*                                                            @Y30LB51*/ 00230000
@RC00079 LH    @10,SSIDCT(,FSCWKPTR)                               0082 00231000
         MH    @10,@CH00119                                        0082 00232000
         STCM  @10,7,CORELEN(CVTPTR)                               0082 00233000
*       CALL ISDAGET1(WORKPTR);     /* GET CHAIN TABLE SPACE.      0083 00234000
*                                                            @Y30LB51*/ 00235000
         L     @10,@PC00001                                        0083 00236000
         ST    @10,@AL00001                                        0083 00237000
         L     @15,@CV00432                                        0083 00238000
         LA    @01,@AL00001                                        0083 00239000
         BALR  @14,@15                                             0083 00240000
*       RFY                                                        0084 00241000
*         RF RSTD;                  /*                       @Y30LB51*/ 00242000
*       FSCRETCD=RF;                /* SAVE THE RETURN CODE. @Y30LB51*/ 00243000
         LR    FSCRETCD,RF                                         0085 00244000
*       RFY                                                        0086 00245000
*         RF UNRSTD;                /*                       @Y30LB51*/ 00246000
*       IF FSCRETCD=0 THEN          /* IF CHAIN TABLE SPACE SECURED     00247000
*                                                            @Y30LB51*/ 00248000
         LTR   FSCRETCD,FSCRETCD                                   0087 00249000
         BNZ   @RF00087                                            0087 00250000
*         DO;                       /* INITIALIZE POINTERS.  @Y30LB51*/ 00251000
*           CHAINTBL=COREADDR;      /* SAVE CHAIN TABLE ADDRESS.   0089 00252000
*                                                            @Y30LB51*/ 00253000
         L     @10,COREADDR(,CVTPTR)                               0089 00254000
         ST    @10,CHAINTBL(,FSCWKPTR)                             0089 00255000
*           CHNPTR=COREADDR;        /* SET PTR TO CHAIN TABLE.     0090 00256000
*                                                            @Y30LB51*/ 00257000
         LR    CHNPTR,@10                                          0090 00258000
*           DO I=1 TO SSIDCT;       /*                       @Y30LB51*/ 00259000
         LA    @10,1                                               0091 00260000
         B     @DE00091                                            0091 00261000
@DL00091 DS    0H                                                  0092 00262000
*             CHNTBL=''B;           /* ZERO OUT CHAIN TABLE. @Y30LB51*/ 00263000
         XC    CHNTBL(12,CHNPTR),CHNTBL(CHNPTR)                    0092 00264000
*             CHNPTR=CHNPTR+LENGTH(CHNTBL);/*                      0093 00265000
*                                                            @Y30LB51*/ 00266000
         AH    CHNPTR,@CH00119                                     0093 00267000
*           END;                    /*                       @Y30LB51*/ 00268000
         LA    @10,1                                               0094 00269000
         AH    @10,I(,FSCWKPTR)                                    0094 00270000
@DE00091 STH   @10,I(,FSCWKPTR)                                    0094 00271000
         CH    @10,SSIDCT(,FSCWKPTR)                               0094 00272000
         BNH   @DL00091                                            0094 00273000
*           CHNPTR=CHAINTBL;        /* SET PTR TO CHAIN TABLE START.    00274000
*                                                            @Y30LB51*/ 00275000
         L     CHNPTR,CHAINTBL(,FSCWKPTR)                          0095 00276000
*         END;                      /*                       @Y30LB51*/ 00277000
*       ELSE                        /* CHAIN TABLE SPACE NOT @Y30LB51*/ 00278000
*         DO;                       /* AVAILABLE, FREE ALL STORAGE.     00279000
*                                                            @Y30LB51*/ 00280000
         B     @RC00087                                            0097 00281000
@RF00087 DS    0H                                                  0098 00282000
*           CALL FREECORE;          /* FREE ALL DYNAMIC STORAGE.   0098 00283000
*                                                            @Y30LB51*/ 00284000
         BAL   @14,FREECORE                                        0098 00285000
*           FSCRETCD=NOSPACE;       /* SET RETURN CODE.      @Y30LB51*/ 00286000
         LA    FSCRETCD,4                                          0099 00287000
*         END;                      /*                       @Y30LB51*/ 00288000
*     END;                          /*                       @Y30LB51*/ 00289000
*   ELSE                            /* WORK AREA SPACE NOT AVAILABLE.   00290000
*                                                            @Y30LB51*/ 00291000
*     DO;                           /* RETURN TO CALLER.     @Y30LB51*/ 00292000
         B     @RC00074                                            0102 00293000
@RF00074 DS    0H                                                  0103 00294000
*       CFSC='00'X;                 /* SET 'DO NOT CALL' SWITCH.   0103 00295000
*                                                            @Y30LB51*/ 00296000
         MVI   CFSC(LPARMPTR),X'00'                                0103 00297000
*       FSCRETCD=NOSPACE;           /* SET RETURN CODE.      @Y30LB51*/ 00298000
         LA    FSCRETCD,4                                          0104 00299000
*     END;                          /*                       @Y30LB51*/ 00300000
*   END FIRSTENT;                   /*                       @Y30LB51*/ 00301000
@EL00002 DS    0H                                                  0106 00302000
@EF00002 DS    0H                                                  0106 00303000
@ER00002 L     @14,@SA00002                                        0106 00304000
         BR    @14                                                 0106 00305000
*GETTBL:                                                           0107 00306000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/ 00307000
*                                                                  0107 00308000
GETTBL   ST    @14,@SA00003                                        0107 00309000
*   /*****************************************************************/ 00310000
*   /*                                                               */ 00311000
*   /* THIS ROUTINE WILL OBTAIN SPACE FOR THE FSC TABLE VIA THE      */ 00312000
*   /* ISDAGET0 ROUTINE.                                             */ 00313000
*   /*                                                               */ 00314000
*   /*****************************************************************/ 00315000
*                                                                  0108 00316000
*   CORELEN=LENGTH(ISDAGHDR)+LENGTH(FSCTBL)*TBLNR;/*               0108 00317000
*                                      GET TABLE LENGTH.     @Y30LB51*/ 00318000
         MVC   CORELEN(3,CVTPTR),@CF00555+1                        0108 00319000
*   SPNO='04'X;                     /* GET SUBPOOL NUMBER.   @Y30LB51*/ 00320000
         MVI   SPNO(CVTPTR),X'04'                                  0109 00321000
*   CALL ISDAGET0(WORKPTR);         /* GET THE SPACE.        @Y30LB51*/ 00322000
         L     @10,@PC00001                                        0110 00323000
         ST    @10,@AL00001                                        0110 00324000
         L     @15,@CV00431                                        0110 00325000
         LA    @01,@AL00001                                        0110 00326000
         BALR  @14,@15                                             0110 00327000
*   GET0PTR=COREADDR;               /* SAVE ADDRESS OF FSC TABLE.  0111 00328000
*                                                            @Y30LB51*/ 00329000
         L     @10,COREADDR(,CVTPTR)                               0111 00330000
         ST    @10,GET0PTR(,FSCWKPTR)                              0111 00331000
*   RFY                                                            0112 00332000
*     RF RSTD;                      /*                       @Y30LB51*/ 00333000
*   FSCRETCD=RF;                    /* SAVE RETURN CODE.     @Y30LB51*/ 00334000
         LR    FSCRETCD,RF                                         0113 00335000
*   RFY                                                            0114 00336000
*     RF UNRSTD;                    /*                       @Y30LB51*/ 00337000
*   IF FSCRETCD=0 THEN              /* IF SPACE WAS AVAILABLE      0115 00338000
*                                                            @Y30LB51*/ 00339000
         LTR   FSCRETCD,FSCRETCD                                   0115 00340000
         BNZ   @RF00115                                            0115 00341000
*     DO;                           /* INITIALIZE FSC TABLE. @Y30LB51*/ 00342000
*       FSCTBLCT=FSCTBLCT+1;        /* PUT ONE IN TABLE COUNTER.   0117 00343000
*                                                            @Y30LB51*/ 00344000
         LA    @15,1                                               0117 00345000
         LH    @14,FSCTBLCT(,FSCWKPTR)                             0117 00346000
         ALR   @14,@15                                             0117 00347000
         STH   @14,FSCTBLCT(,FSCWKPTR)                             0117 00348000
*       BLOCKCNT=FSCTBLCT;          /* PUT NUMBER IN TABLE.  @Y30LB51*/ 00349000
         STH   @14,BLOCKCNT(,@10)                                  0118 00350000
*       BLOCKID='FSC ';             /* PUT ID IN TABLE.      @Y30LB51*/ 00351000
         MVC   BLOCKID(4,@10),@CC00449                             0119 00352000
*       FSCPTR=GET0PTR;             /* SAVE ADDRESS OF FIRST TABLE.     00353000
*                                                            @Y30LB51*/ 00354000
         ST    @10,FSCPTR(,FSCWKPTR)                               0120 00355000
*       FREEPTR=STARTPTR;           /* SET PTR TO FREE ELEMENT.    0121 00356000
*                                                            @Y30LB51*/ 00357000
         L     @10,STARTPTR(,@10)                                  0121 00358000
         ST    @10,FREEPTR(,FSCWKPTR)                              0121 00359000
*       TBLPTR=STARTPTR;            /* SET PTR TO FIRST ELEMENT.   0122 00360000
*                                                            @Y30LB51*/ 00361000
         LR    TBLPTR,@10                                          0122 00362000
*       DO I=1 TO TBLNR;            /*                       @Y30LB51*/ 00363000
         STH   @15,I(,FSCWKPTR)                                    0123 00364000
@DL00123 DS    0H                                                  0124 00365000
*         FSCTBL=''B;               /* ZERO OUT FSC TABLE.   @Y30LB51*/ 00366000
         XC    FSCTBL(44,TBLPTR),FSCTBL(TBLPTR)                    0124 00367000
*         TBLPTR=TBLPTR+LENGTH(FSCTBL);/*                          0125 00368000
*                                                            @Y30LB51*/ 00369000
         AH    TBLPTR,@CH00553                                     0125 00370000
*       END;                        /*                       @Y30LB51*/ 00371000
         LA    @15,1                                               0126 00372000
         AH    @15,I(,FSCWKPTR)                                    0126 00373000
         STH   @15,I(,FSCWKPTR)                                    0126 00374000
         CH    @15,@CH00420                                        0126 00375000
         BNH   @DL00123                                            0126 00376000
*       TBLPTR=STARTPTR;            /* SET PTR TO FIRST ELEMENT.   0127 00377000
*                                                            @Y30LB51*/ 00378000
         L     @10,GET0PTR(,FSCWKPTR)                              0127 00379000
         L     TBLPTR,STARTPTR(,@10)                               0127 00380000
*     END;                          /*                       @Y30LB51*/ 00381000
*   ELSE                            /* SPACE NOT AVAILABLE.  @Y30LB51*/ 00382000
*     FSCRETCD=NOSPACE;             /*                       @Y30LB51*/ 00383000
         B     @RC00115                                            0129 00384000
@RF00115 LA    FSCRETCD,4                                          0129 00385000
*   END GETTBL;                     /*                       @Y30LB51*/ 00386000
@EL00003 DS    0H                                                  0130 00387000
@EF00003 DS    0H                                                  0130 00388000
@ER00003 L     @14,@SA00003                                        0130 00389000
         BR    @14                                                 0130 00390000
*RECTYPE:                                                          0131 00391000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/ 00392000
*                                                                  0131 00393000
RECTYPE  ST    @14,@SA00004                                        0131 00394000
*   /*****************************************************************/ 00395000
*   /*                                                               */ 00396000
*   /* THIS ROUTINE WILL DETERMINE THE FORMAT OF THE INPUT RECORD AND*/ 00397000
*   /* THE VALIDITY OF THE RECORD (EXCEPT FOR AN MSC FORMAT 3        */ 00398000
*   /* RECORD). A RECORD IS ACCEPTED AS VALID IF IT HAS A NON-ZERO   */ 00399000
*   /* FSC. FOR AN MSC FORMAT 1 OR 2 RECORD AND FOR ALL DASD RECORDS,*/ 00400000
*   /* THE CUA IS SAVED AS THE SSID. FOR MSC FORMAT 4 AND 5 RECORDS  */ 00401000
*   /* THE SSID AND FSC ARE SAVED. FOR AN MSC FORMAT RECORD 3 A      */ 00402000
*   /* ROUTINE IS CALLED TO DETERMINE VALIDITY AND TO SAVE THE SSID  */ 00403000
*   /* AND FSC(S). ROUTINES ARE CALLED TO DETERMINE THE SUBFORMAT FOR*/ 00404000
*   /* MSC FORMAT 4 AND 5 RECORDS AND FOR ALL DASD RECORDS.          */ 00405000
*   /*                                                               */ 00406000
*   /*****************************************************************/ 00407000
*                                                                  0132 00408000
*   IF INDEVTYP='S' THEN            /* IF SUBSYSTEM RECORD   @Y30LB51*/ 00409000
         L     @10,SDA00PTR(,CVTPTR)                               0132 00410000
         CLI   INDEVTYP(@10),C'S'                                  0132 00411000
         BNE   @RF00132                                            0132 00412000
*     IF(FORMATNO(2)='1'B)|(FORMATNO(3)='1'B) THEN/* AND IF FMT 1 OR    00413000
*                                      2                     @Y30LB51*/ 00414000
         L     @04,SENSEPTR(,FSCWKPTR)                             0133 00415000
         TM    FORMATNO(@04),B'01100000'                           0133 00416000
         BZ    @RF00133                                            0133 00417000
*       IF MSCFSC^=0 THEN           /* AND IF NON-ZERO FSC   @Y30LB51*/ 00418000
         ICM   @15,3,MSCFSC(@04)                                   0134 00419000
         BZ    @RF00134                                            0134 00420000
*         DO;                       /* THE RECORD IS ACCEPTED.     0135 00421000
*                                                            @Y30LB51*/ 00422000
*           SSIDSAVE=INRECCUA;      /* SAVE CUA AS SSID      @Y30LB51*/ 00423000
         MVC   SSIDSAVE(2,FSCWKPTR),INRECCUA(@10)                  0136 00424000
*           CUAFLAG='1111'B;        /* AND SET CUA FLAG.     @Y30LB51*/ 00425000
         OI    CUAFLAG(FSCWKPTR),B'11110000'                       0137 00426000
*           FSCSYSSV=MSCFSC;        /* SAVE THE FSC.         @Y30LB51*/ 00427000
         MVC   FSCSYSSV(2,FSCWKPTR),MSCFSC(@04)                    0138 00428000
*           MSCREC='1'B;            /* SET MSC RECORD FLAG.  @Y30LB51*/ 00429000
         OI    MSCREC(FSCWKPTR),B'10000000'                        0139 00430000
*         END;                      /*                       @Y30LB51*/ 00431000
*       ELSE                        /* FSC IS ZERO,          @Y30LB51*/ 00432000
*         FSCRETCD=BADREC;          /* RECORD IS INVALID.    @Y30LB51*/ 00433000
         B     @RC00134                                            0141 00434000
@RF00134 LA    FSCRETCD,8                                          0141 00435000
*     ELSE                          /* NOT FMT 1 OR 2 RECORD,      0142 00436000
*                                                            @Y30LB51*/ 00437000
*       DO;                         /* MUST BE FMT 3,4 OR 5 RECORD.     00438000
*                                                            @Y30LB51*/ 00439000
         B     @RC00133                                            0142 00440000
@RF00133 DS    0H                                                  0143 00441000
*         SSIDSAVE=SUBSYSID;        /* SAVE THE SSID         @Y30LB51*/ 00442000
         L     @10,SENSEPTR(,FSCWKPTR)                             0143 00443000
         MVC   SSIDSAVE(2,FSCWKPTR),SUBSYSID(@10)                  0143 00444000
*         SSIDSAVE=SSIDSAVE&SSIDMASK;/* AND CLEAR FLAGS.     @Y30LB51*/ 00445000
         NC    SSIDSAVE(2,FSCWKPTR),@CB00416                       0144 00446000
*         IF FORMATNO(4)='1'B THEN  /* IF FMT 3 RECORD       @Y30LB51*/ 00447000
         TM    FORMATNO(@10),B'00010000'                           0145 00448000
         BNO   @RF00145                                            0145 00449000
*           CALL MSCTHREE;          /* GO PROCESS IT.        @Y30LB51*/ 00450000
         BAL   @14,MSCTHREE                                        0146 00451000
*         ELSE                      /* NOT FMT 3 RECORD.     @Y30LB51*/ 00452000
*           IF MSCFSC^=0 THEN       /* IF NON-ZERO FSC       @Y30LB51*/ 00453000
         B     @RC00145                                            0147 00454000
@RF00145 L     @10,SENSEPTR(,FSCWKPTR)                             0147 00455000
         ICM   @04,3,MSCFSC(@10)                                   0147 00456000
         BZ    @RF00147                                            0147 00457000
*             DO;                   /* ACCEPT FMT 4 OR 5 RECORD.   0148 00458000
*                                                            @Y30LB51*/ 00459000
*               FSCSYSSV=MSCFSC;    /* SAVE THE FSC.         @Y30LB51*/ 00460000
         MVC   FSCSYSSV(2,FSCWKPTR),MSCFSC(@10)                    0149 00461000
*               IF FORMATNO(5)='1'B THEN/* IF FMT 4 RECORD   @Y30LB51*/ 00462000
         TM    FORMATNO(@10),B'00001000'                           0150 00463000
         BNO   @RF00150                                            0150 00464000
*                 CALL FMTFOUR;     /* DETERMINE SUBFORMAT.  @Y30LB51*/ 00465000
         BAL   @14,FMTFOUR                                         0151 00466000
*               ELSE                /* NOT FMT 4 RECORD,     @Y30LB51*/ 00467000
*                 CALL DASDFIVE;    /* DETERMINE FMT 5 SUBFORMAT.  0152 00468000
*                                                            @Y30LB51*/ 00469000
         B     @RC00150                                            0152 00470000
@RF00150 BAL   @14,DASDFIVE                                        0152 00471000
*             END;                  /*                       @Y30LB51*/ 00472000
*           ELSE                    /* FSC IS ZERO,          @Y30LB51*/ 00473000
*             FSCRETCD=BADREC;      /* RECORD IS INVALID.    @Y30LB51*/ 00474000
         B     @RC00147                                            0154 00475000
@RF00147 LA    FSCRETCD,8                                          0154 00476000
*       END;                        /*                       @Y30LB51*/ 00477000
*   ELSE                            /* NOT SUBSYSTEM RECORD. @Y30LB51*/ 00478000
*     IF FSCDASD^=0 THEN            /* IF DASD FSC NON-ZERO  @Y30LB51*/ 00479000
         B     @RC00132                                            0156 00480000
@RF00132 L     @10,SENSEPTR(,FSCWKPTR)                             0156 00481000
         ICM   @04,3,FSCDASD(@10)                                  0156 00482000
         BZ    @RF00156                                            0156 00483000
*       DO;                         /* ACCEPT THE RECORD.    @Y30LB51*/ 00484000
*         IF INDEVTYP='R' THEN      /* IF READ DASD RECORD   @ZD00149*/ 00485000
         L     @10,SDA00PTR(,CVTPTR)                               0158 00486000
         CLI   INDEVTYP(@10),C'R'                                  0158 00487000
         BNE   @RF00158                                            0158 00488000
*           DO;                     /* STORE CUA AS SSID.    @ZD00149*/ 00489000
*             SSIDSAVE=INRECCUA;    /* SAVE CUA AS SSID      @Y30LB51*/ 00490000
         MVC   SSIDSAVE(2,FSCWKPTR),INRECCUA(@10)                  0160 00491000
*             CUAFLAG='1111'B;      /* AND SET CUA FLAG.     @Y30LB51*/ 00492000
         OI    CUAFLAG(FSCWKPTR),B'11110000'                       0161 00493000
*           END;                    /*                       @ZD00149*/ 00494000
*         ELSE                      /* VIRTUAL DASD RECORD,  @ZD00149*/ 00495000
*           DO;                     /* STORE BYTE 27 AS SSID.      0163 00496000
*                                                            @ZD00149*/ 00497000
         B     @RC00158                                            0163 00498000
@RF00158 DS    0H                                                  0164 00499000
*             SSIDDUMA='00'X;       /* SET FIRST BYTE TO ZERO      0164 00500000
*                                                            @ZD00149*/ 00501000
         MVI   SSIDDUMA(FSCWKPTR),X'00'                            0164 00502000
*             SSIDDUMB=SSIDDASD;    /* AND SAVE BYTE 27 AS SSID.   0165 00503000
*                                                            @ZD00149*/ 00504000
         L     @10,SENSEPTR(,FSCWKPTR)                             0165 00505000
         MVC   SSIDDUMB(1,FSCWKPTR),SSIDDASD(@10)                  0165 00506000
*           END;                    /*                       @ZD00149*/ 00507000
*         FSCSYSSV=FSCDASD;         /* SAVE THE FSC.         @Y30LB51*/ 00508000
@RC00158 L     @10,SENSEPTR(,FSCWKPTR)                             0167 00509000
         MVC   FSCSYSSV(2,FSCWKPTR),FSCDASD(@10)                   0167 00510000
*         DASDREC='1'B;             /* SET DASD RECORD FLAG. @Y30LB51*/ 00511000
         OI    DASDREC(FSCWKPTR),B'00000001'                       0168 00512000
*         CALL DASDFIVE;            /* DETERMINE FORMAT.     @Y30LB51*/ 00513000
         BAL   @14,DASDFIVE                                        0169 00514000
*       END;                        /*                       @Y30LB51*/ 00515000
*     ELSE                          /* FSC IS ZERO           @YM32182*/ 00516000
*       IF INDEVTYP='R' THEN        /* IF REAL DASD          @YM32182*/ 00517000
         B     @RC00156                                            0171 00518000
@RF00156 L     @10,SDA00PTR(,CVTPTR)                               0171 00519000
         CLI   INDEVTYP(@10),C'R'                                  0171 00520000
         BNE   @RF00171                                            0171 00521000
*         FSCRETCD=REALREC;         /* FLAG BAD REAL DASD    @YM32182*/ 00522000
         LA    FSCRETCD,2                                          0172 00523000
*       ELSE                        /* IF VIRTUAL DASD       @YM32182*/ 00524000
*         FSCRETCD=BADREC;          /* RECORD IS INVALID.    @YM32182*/ 00525000
         B     @RC00171                                            0173 00526000
@RF00171 LA    FSCRETCD,8                                          0173 00527000
*   IF FSCRETCD=0 THEN              /* IF RECORD ACCEPTED    @Y30LB51*/ 00528000
@RC00171 DS    0H                                                  0174 00529000
@RC00156 DS    0H                                                  0174 00530000
@RC00132 LTR   FSCRETCD,FSCRETCD                                   0174 00531000
         BNZ   @RF00174                                            0174 00532000
*     CALL REPORTYP;                /* PREPARE THE REPORT.   @Y30LB51*/ 00533000
         BAL   @14,REPORTYP                                        0175 00534000
*   ELSE                            /* RECORD NOT ACCEPTED.  @Y30LB51*/ 00535000
*     IF FSCRETCD=BUFFREC|FSCRETCD=REALREC THEN/* IF BUFFERED LOG OR    00536000
*                                      REAL DASD             @YM32182*/ 00537000
         B     @RC00174                                            0176 00538000
@RF00174 CH    FSCRETCD,@CH00082                                   0176 00539000
         BE    @RT00176                                            0176 00540000
         CH    FSCRETCD,@CH00101                                   0176 00541000
         BNE   @RF00176                                            0176 00542000
@RT00176 DS    0H                                                  0177 00543000
*       FSCRETCD=0;                 /* RESET RETURN CODE.    @Y30LB51*/ 00544000
         SLR   FSCRETCD,FSCRETCD                                   0177 00545000
*     ELSE                                                         0178 00546000
*       ;                           /* NOT BUFFERED LOG RECORD.    0178 00547000
*                                                            @Y30LB51*/ 00548000
@RF00176 DS    0H                                                  0179 00549000
*   END RECTYPE;                    /*                       @Y30LB51*/ 00550000
@EL00004 DS    0H                                                  0179 00551000
@EF00004 DS    0H                                                  0179 00552000
@ER00004 L     @14,@SA00004                                        0179 00553000
         BR    @14                                                 0179 00554000
*MSCTHREE:                                                         0180 00555000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/ 00556000
*                                                                  0180 00557000
MSCTHREE ST    @14,12(,@13)                                        0180 00558000
*   /*****************************************************************/ 00559000
*   /*                                                               */ 00560000
*   /* THIS ROUTINE WILL DETERMINE THE VALIDITY OF AN MSC FORMAT 3   */ 00561000
*   /* RECORD AND SAVE THE FSC(S) IF THE RECORD IS ACCEPTED. TO BE   */ 00562000
*   /* VALID AN MSC FORMAT 3 RECORD MUST HAVE ONE FSC NON-ZERO. A    */ 00563000
*   /* BUFFERED LOG RECORD WILL BE REJECTED, BUT AN INVALID RECORD   */ 00564000
*   /* RETURN CODE WILL NOT BE RETURNED TO THE CONTROLLER.           */ 00565000
*   /*                                                               */ 00566000
*   /*****************************************************************/ 00567000
*                                                                  0181 00568000
*   IF SUBSTAT5(8)='0'B THEN        /* IF NOT BUFFERED LOG RECORD  0181 00569000
*                                                            @Y30LB51*/ 00570000
         L     @10,SENSEPTR(,FSCWKPTR)                             0181 00571000
         TM    SUBSTAT5(@10),B'00000001'                           0181 00572000
         BNZ   @RF00181                                            0181 00573000
*     DO;                           /* ACCEPT THE RECORD.    @Y30LB51*/ 00574000
*       CSREC='1'B;                 /* SET CART STORE UNIT FLAG.   0183 00575000
*                                                            @Y30LB51*/ 00576000
         OI    CSREC(FSCWKPTR),B'00001000'                         0183 00577000
*       IF FSCACC1^=0 THEN          /* IF FSC FOR ACCESSOR 1 @Y30LB51*/ 00578000
         SLR   @04,@04                                             0184 00579000
         CL    @04,FSCACC1(,@10)                                   0184 00580000
         BE    @RF00184                                            0184 00581000
*         DO;                       /* SAVE THE FSC.         @Y30LB51*/ 00582000
*           FSCSAVE1=FSCACC1;       /* SAVE THE FSC.         @Y30LB51*/ 00583000
         MVC   FSCSAVE1(4,FSCWKPTR),FSCACC1(@10)                   0186 00584000
*           FMT3ACC1='1'B;          /* SET ACC 1 FSC FLAG.   @Y30LB51*/ 00585000
         OI    FMT3ACC1(FSCWKPTR),B'10000000'                      0187 00586000
*           IF FSCACC2^=0 THEN      /* IF ACCESSOR 2 FSC THEN      0188 00587000
*                                                            @Y30LB51*/ 00588000
         CL    @04,FSCACC2(,@10)                                   0188 00589000
         BE    @RF00188                                            0188 00590000
*             DO;                   /* SAVE IT, ALSO.        @Y30LB51*/ 00591000
*               FSCSAVE2=FSCACC2;   /* SAVE ACC 2 FSC        @Y30LB51*/ 00592000
         MVC   FSCSAVE2(4,FSCWKPTR),FSCACC2(@10)                   0190 00593000
*               FMT3ACC2='1'B;      /* AND SET FLAG.         @Y30BL51*/ 00594000
         OI    FMT3ACC2(FSCWKPTR),B'01000000'                      0191 00595000
*             END;                  /*                       @Y30LB51*/ 00596000
*           ELSE                                                   0193 00597000
*             ;                     /* ONLY ACCESSOR 1 FSC.  @Y30LB51*/ 00598000
@RF00188 DS    0H                                                  0194 00599000
*         END;                      /*                       @Y30LB51*/ 00600000
*       ELSE                        /* NO ACCESSOR 1 FSC,    @Y30LB51*/ 00601000
*         DO;                       /* CHECK FOR ACC 2 FSC.  @Y30LB51*/ 00602000
         B     @RC00184                                            0195 00603000
@RF00184 DS    0H                                                  0196 00604000
*           IF FSCACC2^=0 THEN      /* IF ACCESSOR 2 FSC     @Y30LB51*/ 00605000
         L     @10,SENSEPTR(,FSCWKPTR)                             0196 00606000
         ICM   @04,15,FSCACC2(@10)                                 0196 00607000
         BZ    @RF00196                                            0196 00608000
*             DO;                   /* SAVE IT.              @Y30LB51*/ 00609000
*               FSCSAVE2=FSCACC2;   /* SAVE ACC 2 FSC.       @Y30LB51*/ 00610000
         MVC   FSCSAVE2(4,FSCWKPTR),FSCACC2(@10)                   0198 00611000
*               FMT3ACC2='1'B;      /* SET ACC 2 FSC FLAG.   @Y30LB51*/ 00612000
         OI    FMT3ACC2(FSCWKPTR),B'01000000'                      0199 00613000
*             END;                  /*                       @Y30LB51*/ 00614000
*           ELSE                    /* NO ACCESSOR 2 FSC,    @Y30LB51*/ 00615000
*             FSCRETCD=BUFFREC;     /* NOT BAD BUT IGNORE IT @ZM30730*/ 00616000
         B     @RC00196                                            0201 00617000
@RF00196 LA    FSCRETCD,1                                          0201 00618000
*         END;                      /*                       @Y30LB51*/ 00619000
*     END;                          /*                       @Y30LB51*/ 00620000
*   ELSE                            /* BUFFERED LOG RECORD,  @Y30LB51*/ 00621000
*     FSCRETCD=BUFFREC;             /* REJECT IT.            @Y30LB51*/ 00622000
         B     @RC00181                                            0204 00623000
@RF00181 LA    FSCRETCD,1                                          0204 00624000
*   END MSCTHREE;                   /*                       @Y30LB51*/ 00625000
@EL00005 DS    0H                                                  0205 00626000
@EF00005 DS    0H                                                  0205 00627000
@ER00005 L     @14,12(,@13)                                        0205 00628000
         BR    @14                                                 0205 00629000
*FMTFOUR:                                                          0206 00630000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/ 00631000
*                                                                  0206 00632000
FMTFOUR  ST    @14,12(,@13)                                        0206 00633000
*   /*****************************************************************/ 00634000
*   /*                                                               */ 00635000
*   /* THIS ROUTINE WILL DETERMINE THE SUBFORMAT OF AN MSC FORMAT 4  */ 00636000
*   /* RECORD. IT WILL ALSO DETERMINE IF ALTERNATE PATH RETRY HAS    */ 00637000
*   /* CHANGED THE SSID OF THE RECORD.                               */ 00638000
*   /*                                                               */ 00639000
*   /*****************************************************************/ 00640000
*                                                                  0207 00641000
*   IF SUBFMTNO='1001'B THEN        /* IF SUBFORMAT '9'      @Y30LB51*/ 00642000
         L     @10,SENSEPTR(,FSCWKPTR)                             0207 00643000
         TM    SUBFMTNO(@10),B'10010000'                           0207 00644000
         BNO   @RF00207                                            0207 00645000
         TM    SUBFMTNO(@10),B'01100000'                           0207 00646000
         BNZ   @RF00207                                            0207 00647000
*     DO;                           /* PROCESS IT.           @Y30LB51*/ 00648000
*       DRDREC='1'B;                /* SET DRD RECORD FLAG.  @Y30LB51*/ 00649000
         OI    DRDREC(FSCWKPTR),B'00010000'                        0209 00650000
*       IF SSIDDEV^='0010'B THEN    /* IF SSID NOT 2XX       @Y30LB51*/ 00651000
         TM    SSIDDEV(FSCWKPTR),B'00000010'                       0210 00652000
         BNO   @RT00210                                            0210 00653000
         TM    SSIDDEV(FSCWKPTR),B'00001101'                       0210 00654000
         BZ    @RF00210                                            0210 00655000
@RT00210 DS    0H                                                  0211 00656000
*         WORKAPR='1'B;             /* SET APR FLAG.         @Y30LB51*/ 00657000
         OI    WORKAPR(FSCWKPTR),B'00010000'                       0211 00658000
*       ELSE                                                       0212 00659000
*         ;                         /* NO APR ACTIVITY.      @Y30LB51*/ 00660000
@RF00210 DS    0H                                                  0213 00661000
*     END;                          /*                       @Y30LB51*/ 00662000
*   ELSE                            /* NOT SUBFORMAT '9' RECORD.   0214 00663000
*                                                            @Y30LB51*/ 00664000
*     IF SUBFMTNO='1010'B THEN      /* IF SUBFMT 'A'         @Y30LB51*/ 00665000
         B     @RC00207                                            0214 00666000
@RF00207 L     @10,SENSEPTR(,FSCWKPTR)                             0214 00667000
         TM    SUBFMTNO(@10),B'10100000'                           0214 00668000
         BNO   @RF00214                                            0214 00669000
         TM    SUBFMTNO(@10),B'01010000'                           0214 00670000
         BNZ   @RF00214                                            0214 00671000
*       DO;                         /* PROCESS IT.           @Y30LB51*/ 00672000
*         SAREC='1'B;               /* SET SA RECORD FLAG.   @Y30LB51*/ 00673000
         OI    SAREC(FSCWKPTR),B'01000000'                         0216 00674000
*         IF SSIDDEV^='1000'B THEN  /* IF SSID NOT 8XX       @Y30LB51*/ 00675000
         TM    SSIDDEV(FSCWKPTR),B'00001000'                       0217 00676000
         BNO   @RT00217                                            0217 00677000
         TM    SSIDDEV(FSCWKPTR),B'00000111'                       0217 00678000
         BZ    @RF00217                                            0217 00679000
@RT00217 DS    0H                                                  0218 00680000
*           WORKAPR='1'B;           /* SET APR FLAG.         @Y30LB51*/ 00681000
         OI    WORKAPR(FSCWKPTR),B'00010000'                       0218 00682000
*         ELSE                                                     0219 00683000
*           ;                       /* NO APR ACTIVITY.      @Y30LB51*/ 00684000
@RF00217 DS    0H                                                  0220 00685000
*       END;                        /*                       @Y30LB51*/ 00686000
*     ELSE                          /* NOT SUBFMT 'A' RECORD.      0221 00687000
*                                                            @Y30LB51*/ 00688000
*       IF SUBFMTNO='1011'B THEN    /* IF SUBFORMAT 'B'      @Y30LB51*/ 00689000
         B     @RC00214                                            0221 00690000
@RF00214 L     @10,SENSEPTR(,FSCWKPTR)                             0221 00691000
         TM    SUBFMTNO(@10),B'10110000'                           0221 00692000
         BNO   @RF00221                                            0221 00693000
         TM    SUBFMTNO(@10),B'01000000'                           0221 00694000
         BNZ   @RF00221                                            0221 00695000
*         IF SSIDDEV='0010'B THEN   /* AND IF SSID 2XX       @Y30LB51*/ 00696000
         TM    SSIDDEV(FSCWKPTR),B'00000010'                       0222 00697000
         BNO   @RF00222                                            0222 00698000
         TM    SSIDDEV(FSCWKPTR),B'00001101'                       0222 00699000
         BNZ   @RF00222                                            0222 00700000
*           DRDREC='1'B;            /* SET DRD RECORD FLAG.  @Y30LB51*/ 00701000
         OI    DRDREC(FSCWKPTR),B'00010000'                        0223 00702000
*         ELSE                      /* SSID NOT 2XX.         @Y30LB51*/ 00703000
*           IF SSIDDEV='0100'B THEN /* IF SSID 4XX           @Y30LB51*/ 00704000
         B     @RC00222                                            0224 00705000
@RF00222 TM    SSIDDEV(FSCWKPTR),B'00000100'                       0224 00706000
         BNO   @RF00224                                            0224 00707000
         TM    SSIDDEV(FSCWKPTR),B'00001011'                       0224 00708000
         BNZ   @RF00224                                            0224 00709000
*             DRCREC='1'B;          /* SET DRC RECORD FLAG.  @Y30LB51*/ 00710000
         OI    DRCREC(FSCWKPTR),B'00100000'                        0225 00711000
*           ELSE                    /* SSID NOT 4XX.         @Y30LB51*/ 00712000
*             DO;                   /* MUST BE SA SSID       @ZM31105*/ 00713000
         B     @RC00224                                            0226 00714000
@RF00224 DS    0H                                                  0227 00715000
*               DRCREC='1'B;        /* SET DRC RECORD FLAG   @ZM31105*/ 00716000
         OI    DRCREC(FSCWKPTR),B'00100000'                        0227 00717000
*               WORKAPR='1'B;       /* SET APR FLAG          @ZM31105*/ 00718000
         OI    WORKAPR(FSCWKPTR),B'00010000'                       0228 00719000
*             END;                  /* END 4B WITH SA SSID   @ZM31105*/ 00720000
*       ELSE                        /* NOT SUBFORMAT 'B',    @Y30LB51*/ 00721000
*         DO;                       /* MUST BE SUBFORMAT 'E'.      0230 00722000
*                                                            @Y30LB51*/ 00723000
         B     @RC00221                                            0230 00724000
@RF00221 DS    0H                                                  0231 00725000
*           DRCREC='1'B;            /* SET DRC RECORD FLAG.  @Y30LB51*/ 00726000
         OI    DRCREC(FSCWKPTR),B'00100000'                        0231 00727000
*           IF SSIDDEV^='0100'B THEN/* IF SSID NOT 4XX       @Y30LB51*/ 00728000
         TM    SSIDDEV(FSCWKPTR),B'00000100'                       0232 00729000
         BNO   @RT00232                                            0232 00730000
         TM    SSIDDEV(FSCWKPTR),B'00001011'                       0232 00731000
         BZ    @RF00232                                            0232 00732000
@RT00232 DS    0H                                                  0233 00733000
*             WORKAPR='1'B;         /* SET APR FLAG.         @Y30LB51*/ 00734000
         OI    WORKAPR(FSCWKPTR),B'00010000'                       0233 00735000
*           ELSE                                                   0234 00736000
*             ;                     /* NO APR ACTIVITY.      @Y30LB51*/ 00737000
@RF00232 DS    0H                                                  0235 00738000
*         END;                      /*                       @Y30LB51*/ 00739000
*   END FMTFOUR;                    /*                       @Y30LB51*/ 00740000
@EL00006 DS    0H                                                  0236 00741000
@EF00006 DS    0H                                                  0236 00742000
@ER00006 L     @14,12(,@13)                                        0236 00743000
         BR    @14                                                 0236 00744000
*DASDFIVE:                                                         0237 00745000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/ 00746000
*                                                                  0237 00747000
DASDFIVE ST    @14,12(,@13)                                        0237 00748000
*   /*****************************************************************/ 00749000
*   /*                                                               */ 00750000
*   /* THIS ROUTINE WILL DETERMINE THE SUBFORMAT FOR AN MSC FORMAT 5 */ 00751000
*   /* RECORD AND FOR A DASD RECORD.                                 */ 00752000
*   /*                                                               */ 00753000
*   /*****************************************************************/ 00754000
*                                                                  0238 00755000
*   IF INDEVTYP='S' THEN            /* IF FMT 5 RECORD       @Y30LB51*/ 00756000
         L     @10,SDA00PTR(,CVTPTR)                               0238 00757000
         CLI   INDEVTYP(@10),C'S'                                  0238 00758000
         BNE   @RF00238                                            0238 00759000
*     IF(SUBFMTNO='0001'B)|(SUBFMTNO='0100'B) THEN/* AND IF SUBFORMAT   00760000
*                                      1 OR 4                @Y30LB51*/ 00761000
         L     @10,SENSEPTR(,FSCWKPTR)                             0239 00762000
         TM    SUBFMTNO(@10),B'00010000'                           0239 00763000
         BNO   @GL00002                                            0239 00764000
         TM    SUBFMTNO(@10),B'11100000'                           0239 00765000
         BZ    @RT00239                                            0239 00766000
@GL00002 L     @10,SENSEPTR(,FSCWKPTR)                             0239 00767000
         TM    SUBFMTNO(@10),B'01000000'                           0239 00768000
         BNO   @RF00239                                            0239 00769000
         TM    SUBFMTNO(@10),B'10110000'                           0239 00770000
         BNZ   @RF00239                                            0239 00771000
@RT00239 DS    0H                                                  0240 00772000
*       DAREC='1'B;                 /* SET 3330 RECORD FLAG. @Y30LB51*/ 00773000
         OI    DAREC(FSCWKPTR),B'00000010'                         0240 00774000
*     ELSE                          /* NOT 3330 RECORD,      @Y30LB51*/ 00775000
*       DIRREC='1'B;                /* SET 3830 RECORD FLAG. @Y30LB51*/ 00776000
         B     @RC00239                                            0241 00777000
@RF00239 OI    DIRREC(FSCWKPTR),B'00000100'                        0241 00778000
*   ELSE                            /* NOT FMT 5 RECORD.     @Y30LB51*/ 00779000
*     IF(DASDFMT='0001'B)|(DASDFMT='0100'B) THEN/* IF SUB- FORMAT 1     00780000
*                                      OR 4                  @Y30LB51*/ 00781000
         B     @RC00238                                            0242 00782000
@RF00238 L     @10,SENSEPTR(,FSCWKPTR)                             0242 00783000
         TM    DASDFMT(@10),B'00010000'                            0242 00784000
         BNO   @GL00003                                            0242 00785000
         TM    DASDFMT(@10),B'11100000'                            0242 00786000
         BZ    @RT00242                                            0242 00787000
@GL00003 L     @10,SENSEPTR(,FSCWKPTR)                             0242 00788000
         TM    DASDFMT(@10),B'01000000'                            0242 00789000
         BNO   @RF00242                                            0242 00790000
         TM    DASDFMT(@10),B'10110000'                            0242 00791000
         BNZ   @RF00242                                            0242 00792000
@RT00242 DS    0H                                                  0243 00793000
*       DAREC='1'B;                 /* SET 3330 RECORD FLAG. @Y30LB51*/ 00794000
         OI    DAREC(FSCWKPTR),B'00000010'                         0243 00795000
*     ELSE                          /* NOT 3330 RECORD,      @Y30LB51*/ 00796000
*       DIRREC='1'B;                /* SET 3830 RECORD FLAG. @Y30LB51*/ 00797000
         B     @RC00242                                            0244 00798000
@RF00242 OI    DIRREC(FSCWKPTR),B'00000100'                        0244 00799000
*   END DASDFIVE;                   /*                       @Y30LB51*/ 00800000
@EL00007 DS    0H                                                  0245 00801000
@EF00007 DS    0H                                                  0245 00802000
@ER00007 L     @14,12(,@13)                                        0245 00803000
         BR    @14                                                 0245 00804000
*REPORTYP:                                                         0246 00805000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/ 00806000
*                                                                  0246 00807000
REPORTYP ST    @14,@SA00008                                        0246 00808000
*   /*****************************************************************/ 00809000
*   /*                                                               */ 00810000
*   /* THIS ROUTINE WILL DETERMINE THE REPORT TYPE REQUESTED BY THE  */ 00811000
*   /* USER. LSSID CONTAINS THE USER SPECIFIED SSID OR ZERO. LFSC    */ 00812000
*   /* CONTAINS THE USER SPECIFIED FSC OR ZERO. LTYPE CONTAINS THE   */ 00813000
*   /* USER SPECIFIED DEVICE TYPE OR ZERO.                           */ 00814000
*   /*                                                               */ 00815000
*   /*****************************************************************/ 00816000
*                                                                  0247 00817000
*   IF LSSID=0 THEN                 /* IF NOT BY SSID        @Y30LB51*/ 00818000
         SLR   @10,@10                                             0247 00819000
         SLR   @04,@04                                             0247 00820000
         ICM   @04,3,LSSID(FSCWKPTR)                               0247 00821000
         CR    @10,@04                                             0247 00822000
         BNE   @RF00247                                            0247 00823000
*     IF LFSC=0 THEN                /* AND IF NOT BY LIBRARY FSC   0248 00824000
*                                                            @Y30LB51*/ 00825000
         CL    @10,LFSC(,FSCWKPTR)                                 0248 00826000
         BNE   @RF00248                                            0248 00827000
*       IF LFSCSYS=0 THEN           /* AND IF NOT BY NON-LIBRARY FSC    00828000
*                                                            @Y30LB51*/ 00829000
         SLR   @04,@04                                             0249 00830000
         ICM   @04,3,LFSCSYS(FSCWKPTR)                             0249 00831000
         CR    @10,@04                                             0249 00832000
         BNE   @RF00249                                            0249 00833000
*         IF LTYPE='  ' THEN        /* AND IF NOT BY DEVICE TYPE   0250 00834000
*                                                            @Y30LB51*/ 00835000
         CLC   LTYPE(2,FSCWKPTR),@CC00481                          0250 00836000
         BNE   @RF00250                                            0250 00837000
*           CALL COUNTALL;          /* THEN COUNT ALL RECORDS.     0251 00838000
*                                                            @Y30LB51*/ 00839000
         BAL   @14,COUNTALL                                        0251 00840000
*         ELSE                      /* DEVICE TYPE WAS SPECIFIED.  0252 00841000
*                                                            @Y30LB51*/ 00842000
*           CALL COUNTYPE;          /*                       @Y30LB51*/ 00843000
         B     @RC00250                                            0252 00844000
@RF00250 BAL   @14,COUNTYPE                                        0252 00845000
*       ELSE                        /* A NON-LIBRARY FSC WAS       0253 00846000
*                                      SPECIFIED.            @Y30LB51*/ 00847000
*         CALL COUNTFSC;            /*                       @Y30LB51*/ 00848000
         B     @RC00249                                            0253 00849000
@RF00249 BAL   @14,COUNTFSC                                        0253 00850000
*     ELSE                          /* A LIBRARY FSC WAS SPECIFIED.     00851000
*                                                            @Y30LB51*/ 00852000
*       CALL COUNTFSC;              /*                       @Y30LB51*/ 00853000
         B     @RC00248                                            0254 00854000
@RF00248 BAL   @14,COUNTFSC                                        0254 00855000
*   ELSE                            /* AN SSID WAS SPECIFIED.      0255 00856000
*                                                            @Y30LB51*/ 00857000
*     CALL CNTSSID;                 /*                       @Y30LB51*/ 00858000
         B     @RC00247                                            0255 00859000
@RF00247 BAL   @14,CNTSSID                                         0255 00860000
*   END REPORTYP;                   /*                       @Y30LB51*/ 00861000
@EL00008 DS    0H                                                  0256 00862000
@EF00008 DS    0H                                                  0256 00863000
@ER00008 L     @14,@SA00008                                        0256 00864000
         BR    @14                                                 0256 00865000
*CNTSSID:                                                          0257 00866000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/ 00867000
*                                                                  0257 00868000
CNTSSID  ST    @14,@SA00009                                        0257 00869000
*   /*****************************************************************/ 00870000
*   /*                                                               */ 00871000
*   /* THIS ROUTINE IS ENTERED WHEN THE USER REQUESTS A REPORT FOR A */ 00872000
*   /* SPECIFIED SSID. THIS ROUTINE WILL DETERMINE IF THE SSID IN THE*/ 00873000
*   /* RECORD MATCHES THE SPECIFIED SSID. IF A MATCH IS FOUND ROUTINE*/ 00874000
*   /* 'COUNTALL' IS CALLED TO COUNT THE RECORD. IF A MATCH IS NOT   */ 00875000
*   /* FOUND THIS ROUTINE WILL RETURN TO THE CALLER. LSSID CONTAINS  */ 00876000
*   /* THE USER SPECIFIED SSID. SSIDSAVE CONTAINS THE SSID FROM THE  */ 00877000
*   /* INPUT RECORD.                                                 */ 00878000
*   /*                                                               */ 00879000
*   /*****************************************************************/ 00880000
*                                                                  0258 00881000
*   TBLPTR=FREEPTR;                 /* SET PTR TO EMPTY ELEMENT.   0258 00882000
*                                                            @Y30LB51*/ 00883000
         L     TBLPTR,FREEPTR(,FSCWKPTR)                           0258 00884000
*   IF SSIDSAVE=LSSID THEN          /* IF THIS IS SPECIFIED SSID   0259 00885000
*                                                            @Y30LB51*/ 00886000
         CLC   SSIDSAVE(2,FSCWKPTR),LSSID(FSCWKPTR)                0259 00887000
         BNE   @RF00259                                            0259 00888000
*     CALL COUNTALL;                /* COUNT THE RECORD.     @Y30LB51*/ 00889000
         BAL   @14,COUNTALL                                        0260 00890000
*   END CNTSSID;                    /*                       @Y30LB51*/ 00891000
@EL00009 DS    0H                                                  0261 00892000
@EF00009 DS    0H                                                  0261 00893000
@ER00009 L     @14,@SA00009                                        0261 00894000
         BR    @14                                                 0261 00895000
*COUNTFSC:                                                         0262 00896000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/ 00897000
*                                                                  0262 00898000
COUNTFSC ST    @14,@SA00010                                        0262 00899000
*   /*****************************************************************/ 00900000
*   /*                                                               */ 00901000
*   /* THIS ROUTINE IS ENTERED WHEN THE USER REQUESTS A REPORT FOR A */ 00902000
*   /* SPECIFIED FSC. THIS ROUTINE WILL DETERMINE IF THE FSC IN THE  */ 00903000
*   /* RECORD MATCHES THE SPECIFIED FSC. IF A MATCH IS FOUND THE     */ 00904000
*   /* ROUTINE 'COUNTALL' IS CALLED TO COUNT THE RECORD. IF A MATCH  */ 00905000
*   /* IS NOT FOUND THIS ROUTINE RETURNS TO THE CALLER. FSCSAVE1     */ 00906000
*   /* CONTAINS THE ACCESSOR 1 FSC OR ZERO. FSCSAVE2 CONTAINS THE    */ 00907000
*   /* ACCESSOR 2 FSC OR ZERO. FSCSYS CONTAINS THE NON-LIBRARY FSC OR*/ 00908000
*   /* ZERO. LFSC CONTAINS THE USER SPECIFIED LIBRARY FSC OR ZERO.   */ 00909000
*   /* LFSCSYS CONTAINS THE USER SPECIFED NON-LIBRARY FSC OR ZERO.   */ 00910000
*   /*                                                               */ 00911000
*   /*****************************************************************/ 00912000
*                                                                  0263 00913000
*   TBLPTR=FREEPTR;                 /* SET PTR TO EMPTY ELEMENT.   0263 00914000
*                                                            @Y30LB51*/ 00915000
         L     TBLPTR,FREEPTR(,FSCWKPTR)                           0263 00916000
*   IF CSREC='1'B THEN              /* IF AN MSC FMT 3 RECORD      0264 00917000
*                                                            @Y30LB51*/ 00918000
         TM    CSREC(FSCWKPTR),B'00001000'                         0264 00919000
         BNO   @RF00264                                            0264 00920000
*     IF FMT3ACC1='1'B THEN         /* AND IF AN ACCESSOR 1 FSC    0265 00921000
*                                                            @Y30LB51*/ 00922000
         TM    FMT3ACC1(FSCWKPTR),B'10000000'                      0265 00923000
         BNO   @RF00265                                            0265 00924000
*       IF FSCSAVE1=LFSC THEN       /* AND IF SPECIFIED FSC  @Y30LB51*/ 00925000
         CLC   FSCSAVE1(4,FSCWKPTR),LFSC(FSCWKPTR)                 0266 00926000
         BNE   @RF00266                                            0266 00927000
*         DO;                       /* COUNT THIS FSC.       @Y30LB51*/ 00928000
*           FSCCOUNT='1'B;          /* SET COUNT FSC ONLY SWITCH.  0268 00929000
*                                                            @Y30LB51*/ 00930000
         OI    FSCCOUNT(FSCWKPTR),B'00100000'                      0268 00931000
*           CALL COUNTALL;          /* COUNT THE FSC.        @Y30LB51*/ 00932000
         BAL   @14,COUNTALL                                        0269 00933000
*           IF FMT3ACC2='1'B THEN   /* IF AN ACCESSOR 2 FSC, TOO,  0270 00934000
*                                                            @Y30LB51*/ 00935000
         TM    FMT3ACC2(FSCWKPTR),B'01000000'                      0270 00936000
         BNO   @RF00270                                            0270 00937000
*             IF FSCSAVE2=LFSC THEN /* AND IF IT IS SPECIFIED FSC  0271 00938000
*                                                            @Y30LB51*/ 00939000
         CLC   FSCSAVE2(4,FSCWKPTR),LFSC(FSCWKPTR)                 0271 00940000
         BNE   @RF00271                                            0271 00941000
*               DO;                 /* COUNT THE FSC.        @Y30LB51*/ 00942000
*                 FMT3ACC1='0'B;    /* RESET ACCESSOR 1 FSC SWITCH.     00943000
*                                                            @Y30LB51*/ 00944000
         NI    FMT3ACC1(FSCWKPTR),B'01111111'                      0273 00945000
*                 CHNPTR=CHAINTBL;  /* SET PTR TO CHAIN TABLE START.    00946000
*                                                            @Y30LB51*/ 00947000
         L     CHNPTR,CHAINTBL(,FSCWKPTR)                          0274 00948000
*                 CALL COUNTALL;    /* COUNT THIS FSC.       @Y30LB51*/ 00949000
         BAL   @14,COUNTALL                                        0275 00950000
*               END;                /*                       @Y30LB51*/ 00951000
*             ELSE                                                 0277 00952000
*               ;                   /* NOT SPECIFIED FSC.    @Y30LB51*/ 00953000
@RF00271 DS    0H                                                  0278 00954000
*           ELSE                                                   0278 00955000
*             ;                     /* NO ACCESSOR 2 FSC.    @Y30LB51*/ 00956000
@RF00270 DS    0H                                                  0279 00957000
*         END;                      /*                       @Y30LB51*/ 00958000
*       ELSE                        /* NOT SPECIFIED FSC.    @Y30LB51*/ 00959000
*         IF FMT3ACC2='1'B THEN     /* IF AN ACCESSOR 2 FSC  @Y30LB51*/ 00960000
         B     @RC00266                                            0280 00961000
@RF00266 TM    FMT3ACC2(FSCWKPTR),B'01000000'                      0280 00962000
         BNO   @RF00280                                            0280 00963000
*           IF FSCSAVE2=LFSC THEN   /* AND IF IT IS SPECIFIED FSC  0281 00964000
*                                                            @Y30LB51*/ 00965000
         CLC   FSCSAVE2(4,FSCWKPTR),LFSC(FSCWKPTR)                 0281 00966000
         BNE   @RF00281                                            0281 00967000
*             DO;                   /* COUNT THIS FSC.       @Y30LB51*/ 00968000
*               FMT3ACC1='0'B;      /* RESET ACCESSOR 1 FSC SWITCH.     00969000
*                                                            @Y30LB51*/ 00970000
*               FSCCOUNT='1'B;      /* SET COUNT BY FSC ONLY SWITCH.    00971000
*                                                            @Y30LB51*/ 00972000
         OI    FSCCOUNT(FSCWKPTR),B'00100000'                      0284 00973000
         NI    FMT3ACC1(FSCWKPTR),B'01111111'                      0284 00974000
*               CALL COUNTALL;      /* COUNT THE FSC.        @Y30LB51*/ 00975000
         BAL   @14,COUNTALL                                        0285 00976000
*             END;                  /*                       @Y30LB51*/ 00977000
*           ELSE                                                   0287 00978000
*             ;                     /* NOT SPECIFIED FSC.    @Y30LB51*/ 00979000
@RF00281 DS    0H                                                  0288 00980000
*         ELSE                                                     0288 00981000
*           ;                       /* NO ACCESSOR 2 FSC.    @Y30LB51*/ 00982000
@RF00280 DS    0H                                                  0289 00983000
*     ELSE                          /* NO ACCESSOR 1 FSC.    @Y30LB51*/ 00984000
*       DO;                         /* MUST BE ACCESSOR 2 FSC.     0289 00985000
*                                                            @Y30LB51*/ 00986000
         B     @RC00265                                            0289 00987000
@RF00265 DS    0H                                                  0290 00988000
*         IF FSCSAVE2=LFSC THEN     /* IF SPECIFIED FSC      @Y30LB51*/ 00989000
         CLC   FSCSAVE2(4,FSCWKPTR),LFSC(FSCWKPTR)                 0290 00990000
         BNE   @RF00290                                            0290 00991000
*           DO;                     /* COUNT IT.             @Y30LB51*/ 00992000
*             FMT3ACC1='0'B;        /* RESET ACCESSOR 1 FSC SWITCH.     00993000
*                                                            @Y30LB51*/ 00994000
*             FSCCOUNT='1'B;        /* SET COUNT BY FSC ONLY SWITCH.    00995000
*                                                            @Y30LB51*/ 00996000
         OI    FSCCOUNT(FSCWKPTR),B'00100000'                      0293 00997000
         NI    FMT3ACC1(FSCWKPTR),B'01111111'                      0293 00998000
*             CALL COUNTALL;        /* COUNT THE FSC.        @Y30LB51*/ 00999000
         BAL   @14,COUNTALL                                        0294 01000000
*           END;                    /*                       @Y30LB51*/ 01001000
*         ELSE                                                     0296 01002000
*           ;                       /* NOT SPECIFIED FSC.    @Y30LB51*/ 01003000
@RF00290 DS    0H                                                  0297 01004000
*       END;                        /*                       @Y30LB51*/ 01005000
*   ELSE                            /* NOT MSC FMT 3 RECORD. @Y30LB51*/ 01006000
*     IF FSCSYSSV=LFSCSYS THEN      /* IF SPECIFIED FSC      @Y30LB51*/ 01007000
         B     @RC00264                                            0298 01008000
@RF00264 CLC   FSCSYSSV(2,FSCWKPTR),LFSCSYS(FSCWKPTR)              0298 01009000
         BNE   @RF00298                                            0298 01010000
*       CALL COUNTALL;              /* COUNT THIS FSC.       @Y30LB51*/ 01011000
         BAL   @14,COUNTALL                                        0299 01012000
*     ELSE                                                         0300 01013000
*       ;                           /* NOT SPECIFIED FSC.    @Y30LB51*/ 01014000
@RF00298 DS    0H                                                  0301 01015000
*   END COUNTFSC;                   /*                       @Y30LB51*/ 01016000
@EL00010 DS    0H                                                  0301 01017000
@EF00010 DS    0H                                                  0301 01018000
@ER00010 L     @14,@SA00010                                        0301 01019000
         BR    @14                                                 0301 01020000
*COUNTYPE:                                                         0302 01021000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/ 01022000
*                                                                  0302 01023000
COUNTYPE ST    @14,@SA00011                                        0302 01024000
*   /*****************************************************************/ 01025000
*   /*                                                               */ 01026000
*   /* THIS ROUTINE IS ENTERED WHEN THE USER REQUESTS A REPORT FOR A */ 01027000
*   /* SPECIFIED DEVICE TYPE. THIS ROUTINE WILL DETERMINE IF THE     */ 01028000
*   /* RECORD IS FOR THE SPECIFIED DEVICE TYPE. IF A MATCH IS FOUND  */ 01029000
*   /* THE ROUTINE 'COUNTALL' IS CALLED TO COUNT THE RECORD. IF A    */ 01030000
*   /* MATCH IS NOT FOUND THIS ROUTINE RETURNS TO THE CALLER. LTYPE  */ 01031000
*   /* CONTAINS THE USER SPECIFIED DEVICE TYPE. SSIDDEV CONTAINS THE */ 01032000
*   /* DEVICE INDICATOR OF THE SSID.                                 */ 01033000
*   /*                                                               */ 01034000
*   /*****************************************************************/ 01035000
*                                                                  0303 01036000
*   IF LTYPE='MS' THEN              /* IF MSC SPECIFIED      @Y30LB51*/ 01037000
         CLC   LTYPE(2,FSCWKPTR),@CC00495                          0303 01038000
         BNE   @RF00303                                            0303 01039000
*     IF MSCREC='1'B THEN           /* AND IF MSC RECORD     @Y30LB51*/ 01040000
         TM    MSCREC(FSCWKPTR),B'10000000'                        0304 01041000
         BNO   @RF00304                                            0304 01042000
*       CALL COUNTALL;              /* COUNT THE RECORD.     @Y30LB51*/ 01043000
         BAL   @14,COUNTALL                                        0305 01044000
*     ELSE                                                         0306 01045000
*       ;                           /* NOT MSC RECORD.       @Y30LB51*/ 01046000
@RF00304 DS    0H                                                  0307 01047000
*   ELSE                            /* MSC NOT SPECIFIED.    @Y30LB51*/ 01048000
*     IF LTYPE='SA' THEN            /* IF STAGING ADAPTOR SPECIFIED     01049000
*                                                            @Y30LB51*/ 01050000
         B     @RC00303                                            0307 01051000
@RF00303 CLC   LTYPE(2,FSCWKPTR),@CC00496                          0307 01052000
         BNE   @RF00307                                            0307 01053000
*       IF SAREC='1'B THEN          /* AND IF SA RECORD      @Y30LB51*/ 01054000
         TM    SAREC(FSCWKPTR),B'01000000'                         0308 01055000
         BNO   @RF00308                                            0308 01056000
*         CALL COUNTALL;            /* COUNT THE RECORD.     @Y30LB51*/ 01057000
         BAL   @14,COUNTALL                                        0309 01058000
*       ELSE                                                       0310 01059000
*         ;                         /* NOT SA RECORD.        @Y30LB51*/ 01060000
@RF00308 DS    0H                                                  0311 01061000
*     ELSE                          /* STAGING ADAPTOR NOT SPECIFIED.   01062000
*                                                            @Y30LB51*/ 01063000
*       IF LTYPE='RC' THEN          /* IF R/W CONTROLLER SPECIFIED 0311 01064000
*                                                            @Y30LB51*/ 01065000
         B     @RC00307                                            0311 01066000
@RF00307 CLC   LTYPE(2,FSCWKPTR),@CC00497                          0311 01067000
         BNE   @RF00311                                            0311 01068000
*         IF DRCREC='1'B THEN       /* AND IF DRC RECORD     @Y30LB51*/ 01069000
         TM    DRCREC(FSCWKPTR),B'00100000'                        0312 01070000
         BNO   @RF00312                                            0312 01071000
*           CALL COUNTALL;          /* COUNT THE RECORD.     @Y30LB51*/ 01072000
         BAL   @14,COUNTALL                                        0313 01073000
*         ELSE                                                     0314 01074000
*           ;                       /* NOT DRC RECORD.       @Y30LB51*/ 01075000
@RF00312 DS    0H                                                  0315 01076000
*       ELSE                        /* R/W CONTROLLER NOT SPECIFIED.    01077000
*                                                            @Y30LB51*/ 01078000
*         IF LTYPE='RD' THEN        /* IF R/W DEVICE SPECIFIED     0315 01079000
*                                                            @Y30LB51*/ 01080000
         B     @RC00311                                            0315 01081000
@RF00311 CLC   LTYPE(2,FSCWKPTR),@CC00498                          0315 01082000
         BNE   @RF00315                                            0315 01083000
*           IF DRDREC='1'B THEN     /* AND IF DRD RECORD     @Y30LB51*/ 01084000
         TM    DRDREC(FSCWKPTR),B'00010000'                        0316 01085000
         BNO   @RF00316                                            0316 01086000
*             CALL COUNTALL;        /* COUNT THE RECORD.     @Y30LB51*/ 01087000
         BAL   @14,COUNTALL                                        0317 01088000
*           ELSE                                                   0318 01089000
*             ;                     /* NOT DRD RECORD.       @Y30LB51*/ 01090000
@RF00316 DS    0H                                                  0319 01091000
*         ELSE                      /* R/W DEVICE NOT SPECIFIED.   0319 01092000
*                                                            @Y30LB51*/ 01093000
*           IF LTYPE='CS' THEN      /* IF CS DEVICE SPECIFIED      0319 01094000
*                                                            @Y30LB51*/ 01095000
         B     @RC00315                                            0319 01096000
@RF00315 CLC   LTYPE(2,FSCWKPTR),@CC00499                          0319 01097000
         BNE   @RF00319                                            0319 01098000
*             IF CSREC='1'B THEN    /* AND IF CS RECORD      @Y30LB51*/ 01099000
         TM    CSREC(FSCWKPTR),B'00001000'                         0320 01100000
         BNO   @RF00320                                            0320 01101000
*               CALL COUNTALL;      /* COUNT THE RECORD.     @Y30LB51*/ 01102000
         BAL   @14,COUNTALL                                        0321 01103000
*             ELSE                                                 0322 01104000
*               ;                   /* NOT CS RECORD.        @Y30LB51*/ 01105000
@RF00320 DS    0H                                                  0323 01106000
*           ELSE                    /* CS DEVICE NOT SPECIFIED.    0323 01107000
*                                                            @Y30LB51*/ 01108000
*             IF LTYPE='DA' THEN    /* IF DASD DEVICE SPECIFIED    0323 01109000
*                                                            @Y30LB51*/ 01110000
         B     @RC00319                                            0323 01111000
@RF00319 CLC   LTYPE(2,FSCWKPTR),@CC00500                          0323 01112000
         BNE   @RF00323                                            0323 01113000
*               IF(DAREC='1'B)|(DIRREC='1'B) THEN/* AND IF 3330 OR 0324 01114000
*                                      3830 RECORD           @Y30LB51*/ 01115000
         TM    DAREC(FSCWKPTR),B'00000110'                         0324 01116000
         BZ    @RF00324                                            0324 01117000
*                 CALL COUNTALL;    /* COUNT THE RECORD.     @Y30LB51*/ 01118000
         BAL   @14,COUNTALL                                        0325 01119000
*               ELSE                                               0326 01120000
*                 ;                 /* NOT 3330 OR 3830 RECORD.    0326 01121000
*                                                            @Y30LB51*/ 01122000
@RF00324 DS    0H                                                  0327 01123000
*             ELSE                                                 0327 01124000
*               ;                   /* DASD RECORD NOT SPECIFIED.  0327 01125000
*                                                            @Y30LB51*/ 01126000
@RF00323 DS    0H                                                  0328 01127000
*   END COUNTYPE;                   /*                       @Y30LB51*/ 01128000
@EL00011 DS    0H                                                  0328 01129000
@EF00011 DS    0H                                                  0328 01130000
@ER00011 L     @14,@SA00011                                        0328 01131000
         BR    @14                                                 0328 01132000
*COUNTALL:                                                         0329 01133000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/ 01134000
*                                                                  0329 01135000
COUNTALL ST    @14,@SA00012                                        0329 01136000
*   /*****************************************************************/ 01137000
*   /*                                                               */ 01138000
*   /* THIS ROUTINE WILL COUNT ALL RECORDS. THE CHAIN TABLE WILL BE  */ 01139000
*   /* SEARCHED TO LOCATE THE SSID. IF THE SSID IS FOUND ON THE CHAIN*/ 01140000
*   /* TABLE ROUTINES 'FMTTHREE' OR 'FMTOTHER' WILL BE CALLED TO     */ 01141000
*   /* LOCATE THE FSC ON THE SSID CHAIN. IF THE SSID IS NOT FOUND ON */ 01142000
*   /* THE CHAIN TABLE THE ROUTINE 'NEWELM' WILL BE CALLED TO CREATE */ 01143000
*   /* A NEW FSC TABLE ELEMENT. CHNPTR POINTS TO THE START OF THE    */ 01144000
*   /* CHAIN TABLE. FREEPTR POINTS TO THE NEXT FREE SPACE IN THE FSC */ 01145000
*   /* TABLE. SSIDSAVE CONTAINS THE SSID FROM THE CURRENT INPUT      */ 01146000
*   /* RECORD.                                                       */ 01147000
*   /*                                                               */ 01148000
*   /*****************************************************************/ 01149000
*                                                                  0330 01150000
*   TBLPTR=STARTPTR;                /* SET PTR TO FIRST ELEMENT.   0330 01151000
*                                                            @Y30LB51*/ 01152000
         L     @10,GET0PTR(,FSCWKPTR)                              0330 01153000
         L     TBLPTR,STARTPTR(,@10)                               0330 01154000
*   DO WHILE((CHNTPTR^=0)&(SSIDSAVE^=CHNSSIDF));/* SEARCH CHAIN TABLE   01155000
*                                      FOR END OF TABLE OR FOR SSID.    01156000
*                                                            @Y30LB51*/ 01157000
         B     @DE00331                                            0331 01158000
@DL00331 DS    0H                                                  0332 01159000
*     CHNPTR=CHNPTR->CHNTPTR;       /*                       @Y30LB51*/ 01160000
         L     CHNPTR,CHNTPTR(,CHNPTR)                             0332 01161000
*   END;                            /*                       @Y30LB51*/ 01162000
@DE00331 ICM   @10,15,CHNTPTR(CHNPTR)                              0333 01163000
         BZ    @DC00331                                            0333 01164000
         CLC   SSIDSAVE(2,FSCWKPTR),CHNSSIDF(CHNPTR)               0333 01165000
         BNE   @DL00331                                            0333 01166000
@DC00331 DS    0H                                                  0334 01167000
*   IF CHNTPTR=0 THEN               /* IF AT END OF TABLE    @Y30LB51*/ 01168000
         ICM   @10,15,CHNTPTR(CHNPTR)                              0334 01169000
         BNZ   @RF00334                                            0334 01170000
*     DO;                           /* CREATE A NEW FSC TABLE      0335 01171000
*                                      ELEMENT.              @Y30LB51*/ 01172000
*       CHNSSIDF=SSIDSAVE;          /* PLACE SSID IN CHAIN TABLE.  0336 01173000
*                                                            @Y30LB51*/ 01174000
         MVC   CHNSSIDF(2,CHNPTR),SSIDSAVE(FSCWKPTR)               0336 01175000
*       FSCTPTR=FREEPTR;            /* SET PTR TO NEW FSC TABLE    0337 01176000
*                                      ELEMENT.              @Y30LB51*/ 01177000
         MVC   FSCTPTR(4,CHNPTR),FREEPTR(FSCWKPTR)                 0337 01178000
*       CALL NEWELM;                /* CREATE NEW FSC TABLE ELEMENT.    01179000
*                                                            @Y30LB51*/ 01180000
         BAL   @14,NEWELM                                          0338 01181000
*       PTRSAVE=CHNPTR;             /* SAVE PTR TO CURRENT SPACE.  0339 01182000
*                                                            @Y30LB51*/ 01183000
         ST    CHNPTR,PTRSAVE(,FSCWKPTR)                           0339 01184000
*       CHNPTR=CHNPTR+LENGTH(CHNTBL);/*                            0340 01185000
*                                      GET ADDRESS NEXT SPACE.     0340 01186000
*                                                            @Y30LB51*/ 01187000
         AH    CHNPTR,@CH00119                                     0340 01188000
*       PTRSAVE->CHNTPTR=CHNPTR;    /* ADD CURRENT SPACE TO CHAIN. 0341 01189000
*                                                            @Y30LB51*/ 01190000
         L     @10,PTRSAVE(,FSCWKPTR)                              0341 01191000
         ST    CHNPTR,CHNTPTR(,@10)                                0341 01192000
*     END;                          /*                       @Y30LB51*/ 01193000
*   ELSE                            /* SSID FOUND IN TABLE.  @Y30LB51*/ 01194000
*     DO;                           /*                       @Y30LB51*/ 01195000
         B     @RC00334                                            0343 01196000
@RF00334 DS    0H                                                  0344 01197000
*       TBLPTR=CHNPTR->FSCTPTR;     /* SET PTR TO SSID CHAIN START.     01198000
*                                                            @Y30LB51*/ 01199000
         L     TBLPTR,FSCTPTR(,CHNPTR)                             0344 01200000
*       IF CSREC='1'B THEN          /* IF MSC FMT 3 RECORD   @Y30LB51*/ 01201000
         TM    CSREC(FSCWKPTR),B'00001000'                         0345 01202000
         BNO   @RF00345                                            0345 01203000
*         CALL FMTTHREE;            /* PROCESS THE LIBRARY FSCS.   0346 01204000
*                                                            @Y30LB51*/ 01205000
         BAL   @14,FMTTHREE                                        0346 01206000
*       ELSE                        /* NOT AN MSC FMT 3 RECORD SO  0347 01207000
*                                                            @Y30LB51*/ 01208000
*         CALL FMTOTHER;            /* PROCESS THE NON-LIBRARY FSC.     01209000
*                                                            @Y30LB51*/ 01210000
         B     @RC00345                                            0347 01211000
@RF00345 BAL   @14,FMTOTHER                                        0347 01212000
*     END;                          /*                       @Y30LB51*/ 01213000
*   END COUNTALL;                   /*                       @Y30LB51*/ 01214000
@EL00012 DS    0H                                                  0349 01215000
@EF00012 DS    0H                                                  0349 01216000
@ER00012 L     @14,@SA00012                                        0349 01217000
         BR    @14                                                 0349 01218000
*NEWELM:                                                           0350 01219000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/ 01220000
*                                                                  0350 01221000
NEWELM   ST    @14,@SA00013                                        0350 01222000
*   /*****************************************************************/ 01223000
*   /*                                                               */ 01224000
*   /* THIS ROUTINE WILL DETERMINE IF SPACE IS AVAILABLE IN THE FSC  */ 01225000
*   /* TABLE BEFORE ADDING A NEW ELEMENT TO IT.                      */ 01226000
*   /*                                                               */ 01227000
*   /*****************************************************************/ 01228000
*                                                                  0351 01229000
*   IF ADDCORE='1'B THEN            /* IF SPACE NEEDED IN FSC TABLE     01230000
*                                                            @Y30LB51*/ 01231000
         TM    ADDCORE(FSCWKPTR),B'00000001'                       0351 01232000
         BNO   @RF00351                                            0351 01233000
*     DO;                           /* GET THE SPACE AND ADD IT TO 0352 01234000
*                                      CHAIN.                @Y30LB51*/ 01235000
*       CALL GETMORE;               /* GET THE SPACE.        @Y30LB51*/ 01236000
         BAL   @14,GETMORE                                         0353 01237000
*       IF FSCRETCD=0 THEN          /* IF SPACE WAS AVAILABLE      0354 01238000
*                                                            @Y30LB51*/ 01239000
         LTR   FSCRETCD,FSCRETCD                                   0354 01240000
         BNZ   @RF00354                                            0354 01241000
*         DO;                       /* CREATE THE NEW ELEMENT.     0355 01242000
*                                                            @Y30LB51*/ 01243000
*           FSCTPTR=FREEPTR;        /* SET PTR TO NEW FSC TABLE    0356 01244000
*                                      ELEMENT.              @Y30LB51*/ 01245000
         MVC   FSCTPTR(4,CHNPTR),FREEPTR(FSCWKPTR)                 0356 01246000
*           CALL CREATELM;          /* CREATE THE ELEMENT.   @Y30LB51*/ 01247000
         BAL   @14,CREATELM                                        0357 01248000
*         END;                      /*                       @Y30LB51*/ 01249000
*       ELSE                                                       0359 01250000
*         ;                         /* SPACE WAS NOT AVAILABLE.    0359 01251000
*                                                            @Y30LB51*/ 01252000
@RF00354 DS    0H                                                  0360 01253000
*     END;                          /*                       @Y30LB51*/ 01254000
*   ELSE                            /* THERE IS SPACE IN FSC TABLE.     01255000
*                                                            @Y30LB51*/ 01256000
*     CALL CREATELM;                /* CREATE THE ELEMENT.   @Y30LB51*/ 01257000
         B     @RC00351                                            0361 01258000
@RF00351 BAL   @14,CREATELM                                        0361 01259000
*   END NEWELM;                     /*                       @Y30LB51*/ 01260000
@EL00013 DS    0H                                                  0362 01261000
@EF00013 DS    0H                                                  0362 01262000
@ER00013 L     @14,@SA00013                                        0362 01263000
         BR    @14                                                 0362 01264000
*CREATELM:                                                         0363 01265000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/ 01266000
*                                                                  0363 01267000
CREATELM ST    @14,@SA00014                                        0363 01268000
*   /*****************************************************************/ 01269000
*   /*                                                               */ 01270000
*   /* THIS ROUTINE WILL CREATE A NEW ELEMENT TO BE ADDED TO THE FSC */ 01271000
*   /* TABLE.                                                        */ 01272000
*   /*                                                               */ 01273000
*   /*****************************************************************/ 01274000
*                                                                  0364 01275000
*   CALL PUTREC;                    /* PUT DATA IN FSC TABLE.      0364 01276000
*                                                            @Y30LB51*/ 01277000
         BAL   @14,PUTREC                                          0364 01278000
*   SSIDCTR=SSIDCTR+1;              /* ADD ONE TO SSID COUNTER.    0365 01279000
*                                                            @Y30LB51*/ 01280000
         LA    @10,1                                               0365 01281000
         AH    @10,SSIDCTR(,FSCWKPTR)                              0365 01282000
         STH   @10,SSIDCTR(,FSCWKPTR)                              0365 01283000
*   IF SSIDCTR=SSIDCT THEN          /* IF CHAIN TABLE FULL   @Y30LB51*/ 01284000
         CH    @10,SSIDCT(,FSCWKPTR)                               0366 01285000
         BNE   @RF00366                                            0366 01286000
*     FSCRETCD=TBLFULL;             /* TELL THE CONTROLLER.  @Y30LB51*/ 01287000
         LA    FSCRETCD,12                                         0367 01288000
*   ELSE                            /* CHAIN TABLE NOT FULL. @Y30LB51*/ 01289000
*     DO;                           /*                       @Y30LB51*/ 01290000
         B     @RC00366                                            0368 01291000
@RF00366 DS    0H                                                  0369 01292000
*       FREEPTR=FREEPTR+LENGTH(FSCTBL);/*                          0369 01293000
*                                      SET PTR TO NEXT SPACE.      0369 01294000
*                                                            @Y30LB51*/ 01295000
         LA    @10,44                                              0369 01296000
         AL    @10,FREEPTR(,FSCWKPTR)                              0369 01297000
         ST    @10,FREEPTR(,FSCWKPTR)                              0369 01298000
*       IF FREEPTR>ENDPTR THEN      /* IF NO MORE SPACE IN TABLE   0370 01299000
*                                                            @Y30LB51*/ 01300000
         L     @01,GET0PTR(,FSCWKPTR)                              0370 01301000
         C     @10,ENDPTR(,@01)                                    0370 01302000
         BNH   @RF00370                                            0370 01303000
*         ADDCORE='1'B;             /* SET ADD CORE SWITCH.  @Y30LB51*/ 01304000
         OI    ADDCORE(FSCWKPTR),B'00000001'                       0371 01305000
*       ELSE                                                       0372 01306000
*         ;                         /* SPACE REMAINING IN TABLE.   0372 01307000
*                                                            @Y30LB51*/ 01308000
@RF00370 DS    0H                                                  0373 01309000
*       IF FSCCOUNT='0'B THEN       /* IF NOT COUNTING BY FSC ONLY 0373 01310000
*                                                            @Y30LB51*/ 01311000
         TM    FSCCOUNT(FSCWKPTR),B'00100000'                      0373 01312000
         BNZ   @RF00373                                            0373 01313000
*         IF FMT3ACC2='1'B THEN     /* AND IF ACCESSOR 2 FSC @Y30LB51*/ 01314000
         TM    FMT3ACC2(FSCWKPTR),B'01000000'                      0374 01315000
         BNO   @RF00374                                            0374 01316000
*           DO;                     /* PUT IT IN THE TABLE.  @Y30LB51*/ 01317000
*             TBLPTRSV=TBLPTR;      /* SAVE PTR TO CURRENT SPACE.  0376 01318000
*                                                            @Y30LB51*/ 01319000
         ST    TBLPTR,TBLPTRSV(,FSCWKPTR)                          0376 01320000
*             CALL ACCESTWO;        /* PUT ACCESSOR 2 FSC IN TABLE.     01321000
*                                                            @Y30LB51*/ 01322000
         BAL   @14,ACCESTWO                                        0377 01323000
*           END;                    /*                       @Y30LB51*/ 01324000
*         ELSE                                                     0379 01325000
*           ;                       /* NO ACCESSOR 2 FSC.    @Y30LB51*/ 01326000
@RF00374 DS    0H                                                  0380 01327000
*     END;                          /*                       @Y30LB51*/ 01328000
*   END CREATELM;                   /*                       @Y30LB51*/ 01329000
@EL00014 DS    0H                                                  0381 01330000
@EF00014 DS    0H                                                  0381 01331000
@ER00014 L     @14,@SA00014                                        0381 01332000
         BR    @14                                                 0381 01333000
*PUTREC:                                                           0382 01334000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/ 01335000
*                                                                  0382 01336000
PUTREC   ST    @14,@SA00015                                        0382 01337000
*   /*****************************************************************/ 01338000
*   /*                                                               */ 01339000
*   /* THIS ROUTINE WILL PUT THE DATA FROM THE INPUT RECORD INTO THE */ 01340000
*   /* FSC TABLE.                                                    */ 01341000
*   /*                                                               */ 01342000
*   /*****************************************************************/ 01343000
*                                                                  0383 01344000
*   TBLPTR=FREEPTR;                 /* SET PTR TO FREE SPACE.      0383 01345000
*                                                            @Y30LB51*/ 01346000
         L     TBLPTR,FREEPTR(,FSCWKPTR)                           0383 01347000
*   FSCDT=DATETIME;                 /* PUT TIME INTO TABLE.  @Y30LB51*/ 01348000
         L     @10,LOGPTR(,FSCWKPTR)                               0384 01349000
         MVC   FSCDT(8,TBLPTR),DATETIME(@10)                       0384 01350000
*   FSCCTR=FSCCTR+1;                /* INITIALIZE RECORD COUNTER.  0385 01351000
*                                                            @Y30LB51*/ 01352000
         LA    @10,1                                               0385 01353000
         AH    @10,FSCCTR(,TBLPTR)                                 0385 01354000
         STH   @10,FSCCTR(,TBLPTR)                                 0385 01355000
*   FSCSSID=SSIDSAVE;               /* PUT SSID/CUA INTO TABLE.    0386 01356000
*                                                            @Y30LB51*/ 01357000
         XC    FSCSSID+2(2,TBLPTR),FSCSSID+2(TBLPTR)               0386 01358000
         MVC   FSCSSID(2,TBLPTR),SSIDSAVE(FSCWKPTR)                0386 01359000
*   IF CSREC='1'B THEN              /* IF FMT 3 RECORD       @Y30LB51*/ 01360000
         TM    CSREC(FSCWKPTR),B'00001000'                         0387 01361000
         BNO   @RF00387                                            0387 01362000
*     IF FMT3ACC1='1'B THEN         /* AND IF ACC 1 FSC      @Y30LB51*/ 01363000
         TM    FMT3ACC1(FSCWKPTR),B'10000000'                      0388 01364000
         BNO   @RF00388                                            0388 01365000
*       DO;                         /* PUT FSC IN TABLE.     @Y30LB51*/ 01366000
*         FSCFSC=FSCSAVE1;          /* PUT FSC INTO TABLE.   @Y30LB51*/ 01367000
         MVC   FSCFSC(4,TBLPTR),FSCSAVE1(FSCWKPTR)                 0390 01368000
*         FMT3ACC1='0'B;            /* RESET FSC FLAG.       @Y30LB51*/ 01369000
         NI    FMT3ACC1(FSCWKPTR),B'01111111'                      0391 01370000
*       END;                        /*                       @Y30LB51*/ 01371000
*     ELSE                          /* NO ACCESSOR 1 FSC,    @Y30LB51*/ 01372000
*       DO;                         /* PUT ACCESSOR 2 FSC INTO TABLE.   01373000
*                                                            @Y30LB51*/ 01374000
         B     @RC00388                                            0393 01375000
@RF00388 DS    0H                                                  0394 01376000
*         FSCFSC=FSCSAVE2;          /* PUT FSC INTO TABLE.   @Y30LB51*/ 01377000
         MVC   FSCFSC(4,TBLPTR),FSCSAVE2(FSCWKPTR)                 0394 01378000
*         FMT3ACC2='0'B;            /* RESET FLAG.           @Y30LB51*/ 01379000
         NI    FMT3ACC2(FSCWKPTR),B'10111111'                      0395 01380000
*       END;                        /*                       @Y30LB51*/ 01381000
*   ELSE                            /* NOT FMT 3 RECORD.     @Y30LB51*/ 01382000
*     FSCSYS=FSCSYSSV;              /* PUT FSC INTO TABLE.   @Y30LB51*/ 01383000
         B     @RC00387                                            0397 01384000
@RF00387 MVC   FSCSYS(2,TBLPTR),FSCSYSSV(FSCWKPTR)                 0397 01385000
*   IF MSCREC='1'B THEN             /* IF MSC RECORD         @Y30LB51*/ 01386000
@RC00387 TM    MSCREC(FSCWKPTR),B'10000000'                        0398 01387000
         BNO   @RF00398                                            0398 01388000
*     MSCFLAG='1'B;                 /* SET FLAG.             @Y30LB51*/ 01389000
         OI    MSCFLAG(TBLPTR),B'10000000'                         0399 01390000
*   ELSE                            /* NOT MSC RECORD.       @Y30LB51*/ 01391000
*     IF SAREC='1'B THEN            /* IF SA RECORD          @Y30LB51*/ 01392000
         B     @RC00398                                            0400 01393000
@RF00398 TM    SAREC(FSCWKPTR),B'01000000'                         0400 01394000
         BNO   @RF00400                                            0400 01395000
*       SAFLAG='1'B;                /* SET FLAG.             @Y30LB51*/ 01396000
         OI    SAFLAG(TBLPTR),B'01000000'                          0401 01397000
*     ELSE                          /* NOT SA RECORD.        @Y30LB51*/ 01398000
*       IF DRCREC='1'B THEN         /* IF DRC RECORD         @Y30LB51*/ 01399000
         B     @RC00400                                            0402 01400000
@RF00400 TM    DRCREC(FSCWKPTR),B'00100000'                        0402 01401000
         BNO   @RF00402                                            0402 01402000
*         DRCFLAG='1'B;             /* SET DRC FLAG.         @Y30LB51*/ 01403000
         OI    DRCFLAG(TBLPTR),B'00100000'                         0403 01404000
*       ELSE                        /* NOT DRC RECORD.       @Y30LB51*/ 01405000
*         IF DRDREC='1'B THEN       /* IF DRD RECORD         @Y30LB51*/ 01406000
         B     @RC00402                                            0404 01407000
@RF00402 TM    DRDREC(FSCWKPTR),B'00010000'                        0404 01408000
         BNO   @RF00404                                            0404 01409000
*           DRDFLAG='1'B;           /* SET DRD FLAG.         @Y30LB51*/ 01410000
         OI    DRDFLAG(TBLPTR),B'00010000'                         0405 01411000
*         ELSE                      /* NOT DRD RECORD.       @Y30LB51*/ 01412000
*           IF CSREC='1'B THEN      /* IF CS RECORD          @Y30LB51*/ 01413000
         B     @RC00404                                            0406 01414000
@RF00404 TM    CSREC(FSCWKPTR),B'00001000'                         0406 01415000
         BNO   @RF00406                                            0406 01416000
*             CSFLAG='1'B;          /* SET FLAG.             @Y30LB51*/ 01417000
         OI    CSFLAG(TBLPTR),B'00001000'                          0407 01418000
*           ELSE                    /* NOT CS RECORD.        @Y30LB51*/ 01419000
*             IF DIRREC='1'B THEN   /* IF 3830 RECORD        @Y30LB51*/ 01420000
         B     @RC00406                                            0408 01421000
@RF00406 TM    DIRREC(FSCWKPTR),B'00000100'                        0408 01422000
         BNO   @RF00408                                            0408 01423000
*               DO;                 /* SET COUNTERS AND FLAG.      0409 01424000
*                                                            @ZD00149*/ 01425000
*                 DIRFLAG='1'B;     /* SET FLAG.             @Y30LB51*/ 01426000
         OI    DIRFLAG(TBLPTR),B'00000100'                         0410 01427000
*                 CALL PUTDEV;      /* INITIALIZE DEVICE COUNTER.  0411 01428000
*                                                            @ZD00149*/ 01429000
         BAL   @14,PUTDEV                                          0411 01430000
*               END;                /*                       @ZD00149*/ 01431000
*             ELSE                  /* NOT 3830 RECORD.      @Y30LB51*/ 01432000
*               DO;                 /* SET COUNTERS AND FLAG.      0413 01433000
*                                                            @ZD00149*/ 01434000
         B     @RC00408                                            0413 01435000
@RF00408 DS    0H                                                  0414 01436000
*                 DAFLAG='1'B;      /* SET 3330 FLAG.        @Y30LB51*/ 01437000
         OI    DAFLAG(TBLPTR),B'00000010'                          0414 01438000
*                 CALL PUTDEV;      /* INITIALIZE DEVICE COUNTER.  0415 01439000
*                                                            @ZD00149*/ 01440000
         BAL   @14,PUTDEV                                          0415 01441000
*               END;                /*                       @ZD00149*/ 01442000
*   IF DASDREC='1'B THEN            /* IF DASD RECORD        @Y30LB51*/ 01443000
@RC00408 DS    0H                                                  0417 01444000
@RC00406 DS    0H                                                  0417 01445000
@RC00404 DS    0H                                                  0417 01446000
@RC00402 DS    0H                                                  0417 01447000
@RC00400 DS    0H                                                  0417 01448000
@RC00398 TM    DASDREC(FSCWKPTR),B'00000001'                       0417 01449000
         BNO   @RF00417                                            0417 01450000
*     DO;                           /* SET DASD FLAGS.       @Y30LB51*/ 01451000
*       DASDFLAG='1'B;              /* SET DASD RECORD FLAG. @Y30LB51*/ 01452000
         OI    DASDFLAG(TBLPTR),B'00000001'                        0419 01453000
*       IF INDEVTYP='R' THEN        /* IF REAL DASD DEVICE   @Y30LB51*/ 01454000
         L     @10,SDA00PTR(,CVTPTR)                               0420 01455000
         CLI   INDEVTYP(@10),C'R'                                  0420 01456000
         BNE   @RF00420                                            0420 01457000
*         REALDASD='1'B;            /* SET REAL DASD DEVICE FLAG.  0421 01458000
*                                                            @Y30LB51*/ 01459000
         OI    REALDASD(TBLPTR),B'10000000'                        0421 01460000
*       ELSE                        /* NOT REAL DASD DEVICE, @Y30LB51*/ 01461000
*         VIRTDASD='1'B;            /* SET VIRTUAL DASD DEVICE FLAG.    01462000
*                                                            @Y30LB51*/ 01463000
         B     @RC00420                                            0422 01464000
@RF00420 OI    VIRTDASD(TBLPTR),B'01000000'                        0422 01465000
*     END;                          /*                       @Y30LB51*/ 01466000
*   ELSE                                                           0424 01467000
*     ;                             /* NOT A DASD RECORD.    @Y30LB51*/ 01468000
@RF00417 DS    0H                                                  0425 01469000
*   IF SDAFLAG0(8)='1'B THEN        /* IF GENERATED FSC      @Y30LB51*/ 01470000
@RC00417 L     @10,SDA00PTR(,CVTPTR)                               0425 01471000
         TM    SDAFLAG0(@10),B'00000001'                           0425 01472000
         BNO   @RF00425                                            0425 01473000
*     FAKEFSC='1'B;                 /* SET FLAG.             @Y30LB51*/ 01474000
         OI    FAKEFSC(TBLPTR),B'00100000'                         0426 01475000
*   ELSE                            /* NOT GENERATED FSC.    @Y30LB51*/ 01476000
*     IF WORKAPR='1'B THEN          /* IF SSID ALTERED       @Y30LB51*/ 01477000
         B     @RC00425                                            0427 01478000
@RF00425 TM    WORKAPR(FSCWKPTR),B'00010000'                       0427 01479000
         BNO   @RF00427                                            0427 01480000
*       FSCAPR='1'B;                /* SET FLAG.             @Y30LB51*/ 01481000
         OI    FSCAPR(TBLPTR),B'00010000'                          0428 01482000
*     ELSE                                                         0429 01483000
*       ;                           /* SSID NOT ALTERED.     @Y30LB51*/ 01484000
@RF00427 DS    0H                                                  0430 01485000
*   TBLELMCT=TBLELMCT+1;            /* ADD ONE TO ELEMENT COUNTER. 0430 01486000
*                                                            @Y30LB51*/ 01487000
@RC00425 LA    @10,1                                               0430 01488000
         AH    @10,TBLELMCT(,FSCWKPTR)                             0430 01489000
         STH   @10,TBLELMCT(,FSCWKPTR)                             0430 01490000
*   END PUTREC;                     /*                       @Y30LB51*/ 01491000
@EL00015 DS    0H                                                  0431 01492000
@EF00015 DS    0H                                                  0431 01493000
@ER00015 L     @14,@SA00015                                        0431 01494000
         BR    @14                                                 0431 01495000
*FMTTHREE:                                                         0432 01496000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/ 01497000
*                                                                  0432 01498000
FMTTHREE ST    @14,@SA00016                                        0432 01499000
*   /*****************************************************************/ 01500000
*   /*                                                               */ 01501000
*   /* THIS ROUTINE WILL COUNT LIBRARY (MSC FMT 3) RECORDS. TBLPTR   */ 01502000
*   /* CONTAINS POINTER TO START OF SSID CHAIN. FSCSPTR CONTAINS     */ 01503000
*   /* POINTER TO NEXT ELEMENT ON SSID CHAIN (ZERO INDICATES END OF  */ 01504000
*   /* SSID CHAIN). FSCSAVE1 CONTAINS FSC FOR ACCESSOR ONE OR ZERO.  */ 01505000
*   /* FSCSAVE2 CONTAINS FSC FOR ACCESSOR TWO OR ZERO.               */ 01506000
*   /*                                                               */ 01507000
*   /*****************************************************************/ 01508000
*                                                                  0433 01509000
*   IF FMT3ACC1='1'B THEN           /* IF ACCESSOR 1 FSC     @Y30LB51*/ 01510000
         TM    FMT3ACC1(FSCWKPTR),B'10000000'                      0433 01511000
         BNO   @RF00433                                            0433 01512000
*     DO;                           /* SEARCH FOR IT IN TABLE.     0434 01513000
*                                                            @Y30LB51*/ 01514000
*       DO WHILE((TBLPTR^=0)&(FSCSAVE1^=FSCFSC));/* SEARCH SSID CHAIN   01515000
*                                      FOR SSID OR FOR END OF CHAIN.    01516000
*                                                            @Y30LB51*/ 01517000
         B     @DE00435                                            0435 01518000
@DL00435 DS    0H                                                  0436 01519000
*         TBLPTRSV=TBLPTR;          /* SAVE PTR TO THIS SPACE.     0436 01520000
*                                                            @Y30LB51*/ 01521000
         ST    TBLPTR,TBLPTRSV(,FSCWKPTR)                          0436 01522000
*         TBLPTR=FSCSPTR;           /* GET PTR TO NEXT SPACE.      0437 01523000
*                                                            @Y30LB51*/ 01524000
         L     TBLPTR,FSCSPTR(,TBLPTR)                             0437 01525000
*       END;                        /*                       @Y30LB51*/ 01526000
@DE00435 LTR   TBLPTR,TBLPTR                                       0438 01527000
         BZ    @DC00435                                            0438 01528000
         CLC   FSCSAVE1(4,FSCWKPTR),FSCFSC(TBLPTR)                 0438 01529000
         BNE   @DL00435                                            0438 01530000
@DC00435 DS    0H                                                  0439 01531000
*       IF TBLPTR=0 THEN            /* IF AT END OF CHAIN    @Y30LB51*/ 01532000
         LTR   TBLPTR,TBLPTR                                       0439 01533000
         BNZ   @RF00439                                            0439 01534000
*         DO;                       /* CREATE NEW ELEMENT AND      0440 01535000
*                                                            @Y30LB51*/ 01536000
*           CALL NEXTELM;           /* ADD IT TO THE CHAIN.  @Y30LB51*/ 01537000
         BAL   @14,NEXTELM                                         0441 01538000
*           IF FMT3ACC2='1'B THEN   /* IF ACCESSOR 2 FSC     @Y30LB51*/ 01539000
         TM    FMT3ACC2(FSCWKPTR),B'01000000'                      0442 01540000
         BNO   @RF00442                                            0442 01541000
*             CALL ACCESTWO;        /* ADD IT TO THE CHAIN.  @Y30LB51*/ 01542000
         BAL   @14,ACCESTWO                                        0443 01543000
*           ELSE                                                   0444 01544000
*             ;                     /* NO ACCESSOR 2 FSC     @Y30LB51*/ 01545000
@RF00442 DS    0H                                                  0445 01546000
*         END;                      /*                       @Y30LB51*/ 01547000
*       ELSE                        /* FSC FOUND ON CHAIN.   @Y30LB51*/ 01548000
*         DO;                       /*                       @Y30LB51*/ 01549000
         B     @RC00439                                            0446 01550000
@RF00439 DS    0H                                                  0447 01551000
*           FSCCTR=FSCCTR+1;        /* ADD ONE TO RECORD COUNTER.  0447 01552000
*                                                            @Y30LB51*/ 01553000
         LA    @10,1                                               0447 01554000
         AH    @10,FSCCTR(,TBLPTR)                                 0447 01555000
         STH   @10,FSCCTR(,TBLPTR)                                 0447 01556000
*           FSCDT=DATETIME;         /* PUT DATE IN TABLE.    @Y30LB51*/ 01557000
         L     @10,LOGPTR(,FSCWKPTR)                               0448 01558000
         MVC   FSCDT(8,TBLPTR),DATETIME(@10)                       0448 01559000
*           FMT3ACC1='0'B;          /* RESET ACCESSOR 1 FSC FLAG.  0449 01560000
*                                                            @Y30LB51*/ 01561000
         NI    FMT3ACC1(FSCWKPTR),B'01111111'                      0449 01562000
*           IF FMT3ACC2='1'B THEN   /* IF ACCESSOR 2 FSC     @Y30LB51*/ 01563000
         TM    FMT3ACC2(FSCWKPTR),B'01000000'                      0450 01564000
         BNO   @RF00450                                            0450 01565000
*             CALL ACCESTWO;        /* PUT IT IN TABLE.      @Y30LB51*/ 01566000
         BAL   @14,ACCESTWO                                        0451 01567000
*           ELSE                                                   0452 01568000
*             ;                     /* NO ACCESSOR 2 FSC.    @Y30LB51*/ 01569000
@RF00450 DS    0H                                                  0453 01570000
*         END;                      /*                       @Y30LB51*/ 01571000
*     END;                          /*                       @Y30LB51*/ 01572000
*   ELSE                            /* NO ACCESSOR 1 FSC,    @Y30LB51*/ 01573000
*     DO;                           /* MUST BE ACCESSOR TWO FSC.   0455 01574000
*                                                            @Y30LB51*/ 01575000
         B     @RC00433                                            0455 01576000
@RF00433 DS    0H                                                  0456 01577000
*       DO WHILE((TBLPTR^=0)&(FSCSAVE2^=FSCFSC));/* SEARCH SSID CHAIN   01578000
*                                      FOR SSID OR FOR END OF CHAIN.    01579000
*                                                            @Y30LB51*/ 01580000
         B     @DE00456                                            0456 01581000
@DL00456 DS    0H                                                  0457 01582000
*         TBLPTRSV=TBLPTR;          /* SAVE PTR TO CURRENT SPACE.  0457 01583000
*                                                            @Y30LB51*/ 01584000
         ST    TBLPTR,TBLPTRSV(,FSCWKPTR)                          0457 01585000
*         TBLPTR=FSCSPTR;           /* SET PTR TO NEXT SPACE.      0458 01586000
*                                                            @Y30LB51*/ 01587000
         L     TBLPTR,FSCSPTR(,TBLPTR)                             0458 01588000
*       END;                        /*                       @Y30LB51*/ 01589000
@DE00456 LTR   TBLPTR,TBLPTR                                       0459 01590000
         BZ    @DC00456                                            0459 01591000
         CLC   FSCSAVE2(4,FSCWKPTR),FSCFSC(TBLPTR)                 0459 01592000
         BNE   @DL00456                                            0459 01593000
@DC00456 DS    0H                                                  0460 01594000
*       IF TBLPTR=0 THEN            /* IF AT END OF CHAIN    @Y30LB51*/ 01595000
         LTR   TBLPTR,TBLPTR                                       0460 01596000
         BNZ   @RF00460                                            0460 01597000
*         CALL NEXTELM;             /* ADD NEW ELEMENT TO CHAIN.   0461 01598000
*                                                            @Y30LB51*/ 01599000
         BAL   @14,NEXTELM                                         0461 01600000
*       ELSE                        /* FSC FOUND ON CHAIN.   @Y30LB51*/ 01601000
*         DO;                       /*                       @Y30LB51*/ 01602000
         B     @RC00460                                            0462 01603000
@RF00460 DS    0H                                                  0463 01604000
*           FSCCTR=FSCCTR+1;        /* ADD ONE TO RECORD COUNTER.  0463 01605000
*                                                            @Y30LB51*/ 01606000
         LA    @10,1                                               0463 01607000
         AH    @10,FSCCTR(,TBLPTR)                                 0463 01608000
         STH   @10,FSCCTR(,TBLPTR)                                 0463 01609000
*           FSCDT=DATETIME;         /* PUT TIME/DATE IN TABLE.     0464 01610000
*                                                            @Y30LB51*/ 01611000
         L     @10,LOGPTR(,FSCWKPTR)                               0464 01612000
         MVC   FSCDT(8,TBLPTR),DATETIME(@10)                       0464 01613000
*         END;                      /*                       @Y30LB51*/ 01614000
*     END;                          /*                       @Y30LB51*/ 01615000
*   END FMTTHREE;                   /*                       @Y30LB51*/ 01616000
@EL00016 DS    0H                                                  0467 01617000
@EF00016 DS    0H                                                  0467 01618000
@ER00016 L     @14,@SA00016                                        0467 01619000
         BR    @14                                                 0467 01620000
*FMTOTHER:                                                         0468 01621000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/ 01622000
*                                                                  0468 01623000
FMTOTHER ST    @14,@SA00017                                        0468 01624000
*   /*****************************************************************/ 01625000
*   /*                                                               */ 01626000
*   /* THIS ROUTINE WILL COUNT NON-LIBRARY RECORDS. FSCSYSSV CONTAINS*/ 01627000
*   /* THE FSC.                                                      */ 01628000
*   /*                                                               */ 01629000
*   /*****************************************************************/ 01630000
*                                                                  0469 01631000
*   DO WHILE((TBLPTR^=0)&(FSCSYSSV^=FSCSYS));/* SEARCH SSID CHAIN FOR   01632000
*                                      FSC OR FOR END OF CHAIN.    0469 01633000
*                                                            @Y30LB51*/ 01634000
         B     @DE00469                                            0469 01635000
@DL00469 DS    0H                                                  0470 01636000
*     TBLPTRSV=TBLPTR;              /* SAVE PTR TO THIS ELEMENT.   0470 01637000
*                                                            @Y30LB51*/ 01638000
         ST    TBLPTR,TBLPTRSV(,FSCWKPTR)                          0470 01639000
*     TBLPTR=TBLPTR->FSCSPTR;       /* GET PTR TO NEXT ELEMENT.    0471 01640000
*                                                            @Y30LB51*/ 01641000
         L     TBLPTR,FSCSPTR(,TBLPTR)                             0471 01642000
*   END;                            /*                       @Y30LB51*/ 01643000
@DE00469 LTR   TBLPTR,TBLPTR                                       0472 01644000
         BZ    @DC00469                                            0472 01645000
         CLC   FSCSYSSV(2,FSCWKPTR),FSCSYS(TBLPTR)                 0472 01646000
         BNE   @DL00469                                            0472 01647000
@DC00469 DS    0H                                                  0473 01648000
*   IF TBLPTR=0 THEN                /* IF AT END OF CHAIN    @Y30LB51*/ 01649000
         LTR   TBLPTR,TBLPTR                                       0473 01650000
         BNZ   @RF00473                                            0473 01651000
*     CALL NEXTELM;                 /* ADD NEW ELEMENT TO TABLE.   0474 01652000
*                                                            @Y30LB51*/ 01653000
         BAL   @14,NEXTELM                                         0474 01654000
*   ELSE                            /* FSC FOUND ON CHAIN.   @Y30LB51*/ 01655000
*     DO;                           /*                       @Y30LB51*/ 01656000
         B     @RC00473                                            0475 01657000
@RF00473 DS    0H                                                  0476 01658000
*       FSCCTR=FSCCTR+1;            /* INCREMENT RECORD COUNTER.   0476 01659000
*                                                            @Y30LB51*/ 01660000
         LA    @10,1                                               0476 01661000
         AH    @10,FSCCTR(,TBLPTR)                                 0476 01662000
         STH   @10,FSCCTR(,TBLPTR)                                 0476 01663000
*       FSCDT=DATETIME;             /* PUT DATE/TIME IN TABLE.     0477 01664000
*                                                            @Y30LB51*/ 01665000
         L     @10,LOGPTR(,FSCWKPTR)                               0477 01666000
         MVC   FSCDT(8,TBLPTR),DATETIME(@10)                       0477 01667000
*       IF((FORMATNO(6)='1'B)|(DASDREC='1'B)) THEN/* IF THIS IS    0478 01668000
*                                      FORMAT 5 OR DASD RECORD     0478 01669000
*                                                            @ZD00149*/ 01670000
         L     @10,SENSEPTR(,FSCWKPTR)                             0478 01671000
         TM    FORMATNO(@10),B'00000100'                           0478 01672000
         BO    @RT00478                                            0478 01673000
         TM    DASDREC(FSCWKPTR),B'00000001'                       0478 01674000
         BNO   @RF00478                                            0478 01675000
@RT00478 DS    0H                                                  0479 01676000
*         CALL PUTDEV;              /* ADD ONE TO THE DEVICE COUNTER.   01677000
*                                                            @ZD00149*/ 01678000
         BAL   @14,PUTDEV                                          0479 01679000
*       ELSE                                                       0480 01680000
*         ;                         /* NOT A FORMAT 5 OR DASD RECORD.   01681000
*                                                            @ZD00149*/ 01682000
@RF00478 DS    0H                                                  0481 01683000
*     END;                          /*                       @Y30LB51*/ 01684000
*   END FMTOTHER;                   /*                       @Y30LB51*/ 01685000
@EL00017 DS    0H                                                  0482 01686000
@EF00017 DS    0H                                                  0482 01687000
@ER00017 L     @14,@SA00017                                        0482 01688000
         BR    @14                                                 0482 01689000
*PUTDEV:                                                           0483 01690000
*   PROC OPTIONS(SAVE(14));         /*                       @ZD00149*/ 01691000
*                                                                  0483 01692000
PUTDEV   ST    @14,12(,@13)                                        0483 01693000
*   /*****************************************************************/ 01694000
*   /*                                                               */ 01695000
*   /* THIS ROUTINE WILL DETERMINE THE SPINDLE ID AND ADD ONE TO THE */ 01696000
*   /* DEVICE COUNTER FOR THAT SPINDLE.                              */ 01697000
*   /*                                                               */ 01698000
*   /*****************************************************************/ 01699000
*                                                                  0484 01700000
*   IF INDEVTYP='S' THEN            /* IF THIS IS FORMAT 5 RECORD  0484 01701000
*                                                            @ZD00149*/ 01702000
         L     @10,SDA00PTR(,CVTPTR)                               0484 01703000
         CLI   INDEVTYP(@10),C'S'                                  0484 01704000
         BNE   @RF00484                                            0484 01705000
*     DEVBYTEA=DRIVEID;             /* GET THE DRIVE ID.     @ZD00149*/ 01706000
         L     @10,SENSEPTR(,FSCWKPTR)                             0485 01707000
         MVC   DEVBYTEA(1,FSCWKPTR),DRIVEID(@10)                   0485 01708000
*   ELSE                            /* THIS IS A DASD RECORD,      0486 01709000
*                                                            @ZD00149*/ 01710000
*     DEVBYTEA=DRIVE;               /* GET ITS DEVICE ID.    @ZD00149*/ 01711000
         B     @RC00484                                            0486 01712000
@RF00484 L     @10,SENSEPTR(,FSCWKPTR)                             0486 01713000
         MVC   DEVBYTEA(1,FSCWKPTR),DRIVE(@10)                     0486 01714000
*   IF DEVBYTEA^='00'X&DEVBYTEA^='FF'X THEN /* VALID ID      @ZA05081*/ 01715000
@RC00484 CLI   DEVBYTEA(FSCWKPTR),X'00'                            0487 01716000
         BE    @RF00487                                            0487 01717000
         CLI   DEVBYTEA(FSCWKPTR),X'FF'                            0487 01718000
         BE    @RF00487                                            0487 01719000
*     DO;                           /* FIND THE DEVICE ID.   @ZD00149*/ 01720000
*       CNTLUNIT=DEVBYTEA;          /* GET THE CONTROL UNIT ID,    0489 01721000
*                                                            @ZD00149*/ 01722000
         MVC   CNTLUNIT(1,TBLPTR),DEVBYTEA(FSCWKPTR)               0489 01723000
*       SRL(CNTLUNIT,6);            /* ISOLATE IT            @ZD00149*/ 01724000
         SLR   @10,@10                                             0490 01725000
         IC    @10,CNTLUNIT(,TBLPTR)                               0490 01726000
         SRL   @10,6                                               0490 01727000
         STC   @10,CNTLUNIT(,TBLPTR)                               0490 01728000
*       CNTLUNIT=CNTLUNIT|'F0'X;    /* AND CONVERT IT TO PRINTABLE.     01729000
*                                                            @ZD00149*/ 01730000
         OI    CNTLUNIT(TBLPTR),X'F0'                              0491 01731000
*       DEVBYTEA=DEVBYTEA&'3F'X;    /* RESET UNNEEDED BITS.  @ZD00149*/ 01732000
         NI    DEVBYTEA(FSCWKPTR),X'3F'                            0492 01733000
*       DO I=1 TO 8 WHILE(DEVBYTEA^=DEVICES(I));/* FIND THE DEVICE 0493 01734000
*                                      ID.                   @ZD00149*/ 01735000
         LA    @10,1                                               0493 01736000
         STH   @10,I(,FSCWKPTR)                                    0493 01737000
@DL00493 LH    @10,I(,FSCWKPTR)                                    0493 01738000
         LA    @01,DEVICES-1(@10)                                  0493 01739000
         CLC   DEVBYTEA(1,FSCWKPTR),0(@01)                         0493 01740000
         BE    @DC00493                                            0493 01741000
*       END;                        /*                       @ZD00149*/ 01742000
         LA    @10,1                                               0494 01743000
         AH    @10,I(,FSCWKPTR)                                    0494 01744000
         STH   @10,I(,FSCWKPTR)                                    0494 01745000
         CH    @10,@CH00070                                        0494 01746000
         BNH   @DL00493                                            0494 01747000
@DC00493 DS    0H                                                  0495 01748000
*       IF I<9 THEN                 /* IF DEVICE ID FOUND    @ZD00149*/ 01749000
         LH    @10,I(,FSCWKPTR)                                    0495 01750000
         CH    @10,@CH00535                                        0495 01751000
         BNL   @RF00495                                            0495 01752000
*         DUMCTR(I)=DUMCTR(I)+1;    /* ADD ONE TO DEVICE COUNTER.  0496 01753000
*                                                            @ZD00149*/ 01754000
         ALR   @10,@10                                             0496 01755000
         LA    @15,1                                               0496 01756000
         ST    @10,@TF00001                                        0496 01757000
         ALR   @10,TBLPTR                                          0496 01758000
         SLR   @14,@14                                             0496 01759000
         ICM   @14,3,DUMCTR-2(@10)                                 0496 01760000
         ALR   @15,@14                                             0496 01761000
         L     @10,@TF00001                                        0496 01762000
         STH   @15,DUMCTR-2(@10,TBLPTR)                            0496 01763000
*      ELSE                                                        0497 01764000
*        ;                          /*                       @ZD00149*/ 01765000
@RF00495 DS    0H                                                  0498 01766000
*     END;                          /*                       @ZD00149*/ 01767000
*   ELSE                                                           0499 01768000
*     ;                             /* DEVICE ID NOT PRESENT.      0499 01769000
*                                                            @ZD00149*/ 01770000
@RF00487 DS    0H                                                  0500 01771000
*   END PUTDEV;                     /*                       @ZD00149*/ 01772000
@EL00018 DS    0H                                                  0500 01773000
@EF00018 DS    0H                                                  0500 01774000
@ER00018 L     @14,12(,@13)                                        0500 01775000
         BR    @14                                                 0500 01776000
*NEXTELM:                                                          0501 01777000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/ 01778000
*                                                                  0501 01779000
NEXTELM  ST    @14,@SA00019                                        0501 01780000
*   /*****************************************************************/ 01781000
*   /*                                                               */ 01782000
*   /* THIS ROUTINE WILL DETERMINE IF SPACE IS AVAILABLE IN THE FSC  */ 01783000
*   /* TABLE BEFORE ADDING A NEW ELEMENT TO AN EXISTING SSID CHAIN.  */ 01784000
*   /*                                                               */ 01785000
*   /*****************************************************************/ 01786000
*                                                                  0502 01787000
*   IF ADDCORE='1'B THEN            /* IF MORE SPACE IS NEEDED     0502 01788000
*                                                            @Y30LB51*/ 01789000
         TM    ADDCORE(FSCWKPTR),B'00000001'                       0502 01790000
         BNO   @RF00502                                            0502 01791000
*     DO;                           /* GET IT AND ADD IT TO CHAIN. 0503 01792000
*                                                            @Y30LB51*/ 01793000
*       CALL GETMORE;               /* GET ADDED FSC TABLE SPACE.  0504 01794000
*                                                            @Y30LB51*/ 01795000
         BAL   @14,GETMORE                                         0504 01796000
*       IF FSCRETCD=0 THEN          /* IF SPACE OBTAINED     @Y30LB51*/ 01797000
         LTR   FSCRETCD,FSCRETCD                                   0505 01798000
         BNZ   @RF00505                                            0505 01799000
*         CALL ADDELM;              /* ADD NEW ELEMENT TO SSID CHAIN.   01800000
*                                                            @Y30LB51*/ 01801000
         BAL   @14,ADDELM                                          0506 01802000
*       ELSE                                                       0507 01803000
*         ;                         /* ADDED SPACE UNAVAILABLE.    0507 01804000
*                                                            @Y30LB51*/ 01805000
@RF00505 DS    0H                                                  0508 01806000
*     END;                          /*                       @Y30LB51*/ 01807000
*   ELSE                            /* SPACE IS AVAILABLE IN TABLE.     01808000
*                                                            @Y30LB51*/ 01809000
*     CALL ADDELM;                  /* ADD NEW ELEMENT TO SSID CHAIN.   01810000
*                                                            @Y30LB51*/ 01811000
         B     @RC00502                                            0509 01812000
@RF00502 BAL   @14,ADDELM                                          0509 01813000
*   END NEXTELM;                    /*                       @Y30LB51*/ 01814000
@EL00019 DS    0H                                                  0510 01815000
@EF00019 DS    0H                                                  0510 01816000
@ER00019 L     @14,@SA00019                                        0510 01817000
         BR    @14                                                 0510 01818000
*ACCESTWO:                                                         0511 01819000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/ 01820000
*                                                                  0511 01821000
ACCESTWO ST    @14,@SA00020                                        0511 01822000
*   /*****************************************************************/ 01823000
*   /*                                                               */ 01824000
*   /* THIS ROUTINE WILL PROCESS AN FSC FOR ACCESSOR TWO IF IT IS THE*/ 01825000
*   /* SECOND FSC IN THE RECORD. FSCSAVE2 CONTAINS THE FSC. CHNPTR   */ 01826000
*   /* CONTAINS THE PTR TO THE SSID IN THE CHAIN TABLE. FSCTPTR      */ 01827000
*   /* CONTAINS THE PTR TO THE START OF THE SSID CHAIN.              */ 01828000
*   /*                                                               */ 01829000
*   /*****************************************************************/ 01830000
*                                                                  0512 01831000
*   TBLPTR=CHNPTR->FSCTPTR;         /*                       @Y30LB51*/ 01832000
         L     TBLPTR,FSCTPTR(,CHNPTR)                             0512 01833000
*   DO WHILE((TBLPTR^=0)&(FSCSAVE2^=FSCFSC));/* SEARCH SSID CHAIN FOR   01834000
*                                      FSC OR FOR END OF CHAIN.    0513 01835000
*                                                            @Y30LB51*/ 01836000
         B     @DE00513                                            0513 01837000
@DL00513 DS    0H                                                  0514 01838000
*     TBLPTRSV=TBLPTR;              /* SAVE PTR TO THIS ELEMENT.   0514 01839000
*                                                            @Y30LB51*/ 01840000
         ST    TBLPTR,TBLPTRSV(,FSCWKPTR)                          0514 01841000
*     TBLPTR=TBLPTR->FSCSPTR;       /* GET PTR TO NEXT ELEMENT.    0515 01842000
*                                                            @Y30LB51*/ 01843000
         L     TBLPTR,FSCSPTR(,TBLPTR)                             0515 01844000
*   END;                            /*                       @Y30LB51*/ 01845000
@DE00513 LTR   TBLPTR,TBLPTR                                       0516 01846000
         BZ    @DC00513                                            0516 01847000
         CLC   FSCSAVE2(4,FSCWKPTR),FSCFSC(TBLPTR)                 0516 01848000
         BNE   @DL00513                                            0516 01849000
@DC00513 DS    0H                                                  0517 01850000
*   IF TBLPTR=0 THEN                /* IF AT END OF CHAIN    @Y30LB51*/ 01851000
         LTR   TBLPTR,TBLPTR                                       0517 01852000
         BNZ   @RF00517                                            0517 01853000
*     CALL NEXTELM;                 /* ADD NEW ELEMENT TO CHAIN.   0518 01854000
*                                                            @Y30LB51*/ 01855000
         BAL   @14,NEXTELM                                         0518 01856000
*   ELSE                            /* FSC FOUND ON CHAIN.   @Y30LB51*/ 01857000
*     DO;                           /*                       @Y30LB51*/ 01858000
         B     @RC00517                                            0519 01859000
@RF00517 DS    0H                                                  0520 01860000
*       FSCCTR=FSCCTR+1;            /* ADD ONE TO RECORD COUNTER.  0520 01861000
*                                                            @Y30LB51*/ 01862000
         LA    @10,1                                               0520 01863000
         AH    @10,FSCCTR(,TBLPTR)                                 0520 01864000
         STH   @10,FSCCTR(,TBLPTR)                                 0520 01865000
*       FSCDT=DATETIME;             /* PUT DATE IN TABLE.    @Y30LB51*/ 01866000
         L     @10,LOGPTR(,FSCWKPTR)                               0521 01867000
         MVC   FSCDT(8,TBLPTR),DATETIME(@10)                       0521 01868000
*     END;                          /*                       @Y30LB51*/ 01869000
*   END ACCESTWO;                   /*                       @Y30LB51*/ 01870000
@EL00020 DS    0H                                                  0523 01871000
@EF00020 DS    0H                                                  0523 01872000
@ER00020 L     @14,@SA00020                                        0523 01873000
         BR    @14                                                 0523 01874000
*ADDELM:                                                           0524 01875000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/ 01876000
*                                                                  0524 01877000
ADDELM   ST    @14,@SA00021                                        0524 01878000
*   /*****************************************************************/ 01879000
*   /*                                                               */ 01880000
*   /* THIS ROUTINE WILL CREATE A NEW FSC TABLE ELEMENT AND ADD IT TO*/ 01881000
*   /* AN ACTIVE SSID CHAIN. FREEPTR CONTAINS THE PTR TO THE NEXT    */ 01882000
*   /* AVAILABLE SPACE IN THE FSC TABLE. TBLPTRSV CONTAINS THE PTR TO*/ 01883000
*   /* THE LAST ELEMENT ON THE SSID CHAIN.                           */ 01884000
*   /*                                                               */ 01885000
*   /*****************************************************************/ 01886000
*                                                                  0525 01887000
*   CALL PUTREC;                    /* PUT DATA IN FSC TABLE.      0525 01888000
*                                                            @Y30LB51*/ 01889000
         BAL   @14,PUTREC                                          0525 01890000
*   TBLPTRSV->FSCSPTR=FREEPTR;      /* ADD ELEMENT TO SSID CHAIN.  0526 01891000
*                                                            @Y30LB51*/ 01892000
         L     @10,TBLPTRSV(,FSCWKPTR)                             0526 01893000
         L     @04,FREEPTR(,FSCWKPTR)                              0526 01894000
         ST    @04,FSCSPTR(,@10)                                   0526 01895000
*   FREEPTR=FREEPTR+LENGTH(FSCTBL); /* SET PTR TO NEXT FREE SPACE. 0527 01896000
*                                                            @Y30LB51*/ 01897000
         AH    @04,@CH00553                                        0527 01898000
         ST    @04,FREEPTR(,FSCWKPTR)                              0527 01899000
*   IF FREEPTR>ENDPTR THEN          /* IF AT END OF TABLE    @Y30LB51*/ 01900000
         L     @10,GET0PTR(,FSCWKPTR)                              0528 01901000
         C     @04,ENDPTR(,@10)                                    0528 01902000
         BNH   @RF00528                                            0528 01903000
*     ADDCORE='1'B;                 /* SET NEED CORE SWITCH. @Y30LB51*/ 01904000
         OI    ADDCORE(FSCWKPTR),B'00000001'                       0529 01905000
*   ELSE                                                           0530 01906000
*     ;                             /* SPACE REMAINING IN TABLE.   0530 01907000
*                                                            @Y30LB51*/ 01908000
@RF00528 DS    0H                                                  0531 01909000
*   END ADDELM;                     /*                       @Y30LB51*/ 01910000
@EL00021 DS    0H                                                  0531 01911000
@EF00021 DS    0H                                                  0531 01912000
@ER00021 L     @14,@SA00021                                        0531 01913000
         BR    @14                                                 0531 01914000
*GETMORE:                                                          0532 01915000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/ 01916000
*                                                                  0532 01917000
GETMORE  ST    @14,@SA00022                                        0532 01918000
*   /*****************************************************************/ 01919000
*   /*                                                               */ 01920000
*   /* THIS ROUTINE WILL GET AN ADDITION FSC TABLE WHEN NEEDED, AND  */ 01921000
*   /* CHAIN IT TO THE PREVIOUS FSC TABLE.                           */ 01922000
*   /*                                                               */ 01923000
*   /*****************************************************************/ 01924000
*                                                                  0533 01925000
*   ADDCORE='0'B;                   /* RESET THE ADDCORE SWITCH.   0533 01926000
*                                                            @Y30LB51*/ 01927000
         NI    ADDCORE(FSCWKPTR),B'11111110'                       0533 01928000
*   CORELEN=LENGTH(ISDAGHDR)+LENGTH(FSCTBL)*TBLNR;/*               0534 01929000
*                                      GET LENGTH OF TABLE.@Y30LB51  */ 01930000
         MVC   CORELEN(3,CVTPTR),@CF00555+1                        0534 01931000
*   SPNO='04'X;                     /* GET SUBPOOL NUMBER.   @Y30LB51*/ 01932000
         MVI   SPNO(CVTPTR),X'04'                                  0535 01933000
*   CALL ISDAGET0(WORKPTR);         /* GET THE ADDED SPACE.  @Y30LB51*/ 01934000
         L     @10,@PC00001                                        0536 01935000
         ST    @10,@AL00001                                        0536 01936000
         L     @15,@CV00431                                        0536 01937000
         LA    @01,@AL00001                                        0536 01938000
         BALR  @14,@15                                             0536 01939000
*   RFY                                                            0537 01940000
*     RF RSTD;                      /*                       @Y30LB51*/ 01941000
*   FSCRETCD=RF;                    /* SAVE THE RETURN CODE. @Y30LB51*/ 01942000
         LR    FSCRETCD,RF                                         0538 01943000
*   RFY                                                            0539 01944000
*     RF UNRSTD;                    /*                       @Y30LB51*/ 01945000
*   IF FSCRETCD=0 THEN              /* IF SPACE WAS AVAILABLE      0540 01946000
*                                                            @Y30LB51*/ 01947000
         LTR   FSCRETCD,FSCRETCD                                   0540 01948000
         BNZ   @RF00540                                            0540 01949000
*     DO;                           /* INITIALIZE IT AND CHAIN IT. 0541 01950000
*                                                            @Y30LB51*/ 01951000
*       NEXTPTR=COREADDR;           /* SAVE ADDRESS OF NEW TABLE.  0542 01952000
*                                                            @Y30LB51*/ 01953000
         L     @10,GET0PTR(,FSCWKPTR)                              0542 01954000
         L     @15,COREADDR(,CVTPTR)                               0542 01955000
         ST    @15,NEXTPTR(,@10)                                   0542 01956000
*       PTRSAVE=GET0PTR;            /* SAVE PTR TO PREVIOUS TABLE. 0543 01957000
*                                                            @Y30LB51*/ 01958000
         ST    @10,PTRSAVE(,FSCWKPTR)                              0543 01959000
*       GET0PTR=NEXTPTR;            /* SET PTR TO NEW TABLE. @Y30LB51*/ 01960000
         ST    @15,GET0PTR(,FSCWKPTR)                              0544 01961000
*       LASTPTR=PTRSAVE;            /* SET BACK PTR IN NEW TABLE.  0545 01962000
*                                                            @Y30LB51*/ 01963000
         ST    @10,LASTPTR(,@15)                                   0545 01964000
*       FSCTBLCT=FSCTBLCT+1;        /* INCREMENT TABLE COUNT.      0546 01965000
*                                                            @Y30LB51*/ 01966000
         LA    @10,1                                               0546 01967000
         LH    @14,FSCTBLCT(,FSCWKPTR)                             0546 01968000
         ALR   @14,@10                                             0546 01969000
         STH   @14,FSCTBLCT(,FSCWKPTR)                             0546 01970000
*       BLOCKCNT=FSCTBLCT;          /* PUT COUNT IN TABLE.   @Y30LB51*/ 01971000
         STH   @14,BLOCKCNT(,@15)                                  0547 01972000
*       BLOCKID='FSC ';             /* PUT ID IN TABLE.      @Y30LB51*/ 01973000
         MVC   BLOCKID(4,@15),@CC00449                             0548 01974000
*       FREEPTR=STARTPTR;           /* SET PTR TO NEXT ELEMENT.    0549 01975000
*                                                            @Y30LB51*/ 01976000
         L     @15,STARTPTR(,@15)                                  0549 01977000
         ST    @15,FREEPTR(,FSCWKPTR)                              0549 01978000
*       TBLPTR=STARTPTR;            /* SET PTR TO FIRST ELEMENT.   0550 01979000
*                                                            @Y30LB51*/ 01980000
         LR    TBLPTR,@15                                          0550 01981000
*       DO I=1 TO TBLNR;            /*                       @Y30LB51*/ 01982000
         STH   @10,I(,FSCWKPTR)                                    0551 01983000
@DL00551 DS    0H                                                  0552 01984000
*         FSCTBL=''B;               /* ZERO OUT THE NEW FSC TABLE. 0552 01985000
*                                                            @Y30LB51*/ 01986000
         XC    FSCTBL(44,TBLPTR),FSCTBL(TBLPTR)                    0552 01987000
*         TBLPTR=TBLPTR+LENGTH(FSCTBL);/*                          0553 01988000
*                                                            @Y30LB51*/ 01989000
         AH    TBLPTR,@CH00553                                     0553 01990000
*       END;                        /*                       @Y30LB51*/ 01991000
         LA    @10,1                                               0554 01992000
         AH    @10,I(,FSCWKPTR)                                    0554 01993000
         STH   @10,I(,FSCWKPTR)                                    0554 01994000
         CH    @10,@CH00420                                        0554 01995000
         BNH   @DL00551                                            0554 01996000
*       TBLPTR=STARTPTR;            /* RESET PTR TO FIRST ELEMENT. 0555 01997000
*                                                            @Y30LB51*/ 01998000
         L     @10,GET0PTR(,FSCWKPTR)                              0555 01999000
         L     TBLPTR,STARTPTR(,@10)                               0555 02000000
*     END;                          /*                       @Y30LB51*/ 02001000
*   ELSE                            /* SPACE WAS NOT AVAILABLE,    0557 02002000
*                                                            @Y30LB51*/ 02003000
*     DO;                           /* FREE WHAT HAS BEEN SECURED. 0557 02004000
*                                                            @Y30LB51*/ 02005000
         B     @RC00540                                            0557 02006000
@RF00540 DS    0H                                                  0558 02007000
*       CALL FREECORE;              /* FREE ALL DYNAMIC STORAGE.   0558 02008000
*                                                            @Y30LB51*/ 02009000
         BAL   @14,FREECORE                                        0558 02010000
*       FSCRETCD=NOSPACE;           /* SET RETURN CODE.      @Y30LB51*/ 02011000
         LA    FSCRETCD,4                                          0559 02012000
*       RETURN CODE(FSCRETCD);      /* RETURN TO CALLER.     @Y30LB51*/ 02013000
         LR    @15,FSCRETCD                                        0560 02014000
@EL00022 DS    0H                                                  0560 02015000
@EF00022 DS    0H                                                  0560 02016000
@ER00022 L     @14,@SA00022                                        0560 02017000
         BR    @14                                                 0560 02018000
*     END;                          /*                       @Y30LB51*/ 02019000
*   END GETMORE;                    /*                       @Y30LB51*/ 02020000
         B     @EL00022                                            0562 02021000
*FREECORE:                                                         0563 02022000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/ 02023000
*                                                                  0563 02024000
FREECORE ST    @14,@SA00023                                        0563 02025000
*   /*****************************************************************/ 02026000
*   /*                                                               */ 02027000
*   /* THIS ROUTINE WILL FREE ALL GOTTEN CORE VIA THE ISDAFREE       */ 02028000
*   /* ROUTINE.                                                      */ 02029000
*   /*                                                               */ 02030000
*   /*****************************************************************/ 02031000
*                                                                  0564 02032000
*   SPNO='04'X;                     /* GET THE SUBPOOL NUMBER.     0564 02033000
*                                                            @Y30LB51*/ 02034000
         MVI   SPNO(CVTPTR),X'04'                                  0564 02035000
*   IF FSC00PTR^=0 THEN             /* IF WORK AREA EXISTS   @Y30LB51*/ 02036000
         ICM   @10,15,FSC00PTR(CVTPTR)                             0565 02037000
         BZ    @RF00565                                            0565 02038000
*     DO;                           /* FREE IT.              @Y30LB51*/ 02039000
*       DO WHILE GET0PTR^=0;        /* FREE EXISTING FSC TABLES.   0567 02040000
*                                                            @ZM31022*/ 02041000
         B     @DE00567                                            0567 02042000
@DL00567 DS    0H                                                  0568 02043000
*         SPNOLEN=GET0SPLN;         /* GET FSC TABLE LENGTH. @ZM31022*/ 02044000
         L     @10,GET0PTR(,FSCWKPTR)                              0568 02045000
         MVC   SPNOLEN(4,CVTPTR),GET0SPLN(@10)                     0568 02046000
*         COREADDR=GET0PTR;         /* GET ADDRESS OF LAST TABLE ON     02047000
*                                      CHAIN.                @ZM31022*/ 02048000
         ST    @10,COREADDR(,CVTPTR)                               0569 02049000
*         GET0PTR=LASTPTR;          /* SET PTR TO PRECEDING TABLE ON    02050000
*                                      CHAIN.                @ZM31022*/ 02051000
         L     @10,LASTPTR(,@10)                                   0570 02052000
         ST    @10,GET0PTR(,FSCWKPTR)                              0570 02053000
*         CALL ISDAFREE(WORKPTR);   /* FREE THE LAST TABLE ON CHAIN.    02054000
*                                                            @ZM31022*/ 02055000
         L     @10,@PC00001                                        0571 02056000
         ST    @10,@AL00001                                        0571 02057000
         L     @15,@CV00433                                        0571 02058000
         LA    @01,@AL00001                                        0571 02059000
         BALR  @14,@15                                             0571 02060000
*       END;                        /*                       @ZM31022*/ 02061000
@DE00567 SLR   @10,@10                                             0572 02062000
         C     @10,GET0PTR(,FSCWKPTR)                              0572 02063000
         BNE   @DL00567                                            0572 02064000
*       IF CHAINTBL^=0 THEN         /* IF CHAIN TABLE EXISTS.      0573 02065000
*                                                            @ZM31022*/ 02066000
         L     @04,CHAINTBL(,FSCWKPTR)                             0573 02067000
         CR    @04,@10                                             0573 02068000
         BE    @RF00573                                            0573 02069000
*         DO;                       /* FREE IT.              @ZM31022*/ 02070000
*           CORELEN=LENGTH(CHNTBL)*SSIDCT;/*                       0575 02071000
*                                      GET CHAIN TABLE LENGTH      0575 02072000
*                                                            @ZM31022*/ 02073000
         LH    @10,SSIDCT(,FSCWKPTR)                               0575 02074000
         MH    @10,@CH00119                                        0575 02075000
         STCM  @10,7,CORELEN(CVTPTR)                               0575 02076000
*           COREADDR=CHAINTBL;      /* AND ADDRESS           @ZM31022*/ 02077000
         ST    @04,COREADDR(,CVTPTR)                               0576 02078000
*           CALL ISDAFREE(WORKPTR); /* AND FREE IT.          @ZM31022*/ 02079000
         L     @10,@PC00001                                        0577 02080000
         ST    @10,@AL00001                                        0577 02081000
         L     @15,@CV00433                                        0577 02082000
         LA    @01,@AL00001                                        0577 02083000
         BALR  @14,@15                                             0577 02084000
*         END;                      /*                       @ZM31022*/ 02085000
*       ELSE;                       /* CHAIN TABLE DOES NOT EXIST. 0579 02086000
*                                                            @ZM31022*/ 02087000
@RF00573 DS    0H                                                  0580 02088000
*       CORELEN=LENGTH(FSCWORK);    /* GET WORK AREA LENGTH  @Y30LB51*/ 02089000
         MVC   CORELEN(3,CVTPTR),@CF00552+1                        0580 02090000
*       COREADDR=FSC00PTR;          /* AND ADDRESS           @Y30LB51*/ 02091000
         MVC   COREADDR(4,CVTPTR),FSC00PTR(CVTPTR)                 0581 02092000
*       CALL ISDAFREE(WORKPTR);     /* AND FREE IT.          @Y30LB51*/ 02093000
         L     @10,@PC00001                                        0582 02094000
         ST    @10,@AL00001                                        0582 02095000
         L     @15,@CV00433                                        0582 02096000
         LA    @01,@AL00001                                        0582 02097000
         BALR  @14,@15                                             0582 02098000
*     END;                          /*                       @Y30LB51*/ 02099000
*   ELSE                                                           0584 02100000
*     ;                             /* WORK AREA DOES NOT EXIST.   0584 02101000
*                                                            @Y30LB51*/ 02102000
@RF00565 DS    0H                                                  0585 02103000
*   FSC00PTR=0;                     /* ZERO WORK AREA ADDRESS.     0585 02104000
*                                                            @Y30LB51*/ 02105000
         SLR   @10,@10                                             0585 02106000
         ST    @10,FSC00PTR(,CVTPTR)                               0585 02107000
*   CFSC='00'X;                     /* SET 'DO NOT CALL' SWITCH.   0586 02108000
*                                                            @Y30LB51*/ 02109000
         MVI   CFSC(LPARMPTR),X'00'                                0586 02110000
*   END FREECORE;                   /*                       @Y30LB51*/ 02111000
@EL00023 DS    0H                                                  0587 02112000
@EF00023 DS    0H                                                  0587 02113000
@ER00023 L     @14,@SA00023                                        0587 02114000
         BR    @14                                                 0587 02115000
*   END ISDAFSC0                    /*                       @Y30LB51*/ 02116000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 02117000
*/*%INCLUDE SYSLIB  (ISDACVT )                                        * 02118000
*/*%INCLUDE SYSLIB  (ISDAPRMS)                                        * 02119000
*/*%INCLUDE SYSLIB  (ISDAWORK)                                        * 02120000
*/*%INCLUDE SYSLIB  (ISDAGHDR)                                        * 02121000
*/*%INCLUDE SYSLIB  (ISDAMCFG)                                        * 02122000
*/*%INCLUDE SYSLIB  (ISDASOBR)                                        * 02123000
*/*%INCLUDE SYSLIB  (ISDAMSCS)                                        * 02124000
*/*%INCLUDE SYSLIB  (ISDAFSC5)                                        * 02125000
*/*%INCLUDE SYSLIB  (ISDAMSC3)                                        * 02126000
*;                                                                 0588 02127000
@DATA    DS    0H                                                       02128000
@CH00082 DC    H'1'                                                     02129000
@CH00101 DC    H'2'                                                     02130000
@CH00070 DC    H'8'                                                     02131000
@CH00535 DC    H'9'                                                     02132000
@CH00119 DC    H'12'                                                    02133000
@CH00553 DC    H'44'                                                    02134000
@CH00420 DC    H'80'                                                    02135000
@DATD    DSECT                                                          02136000
         DS    0F                                                       02137000
@SA00001 DS    18F                                                      02138000
@PC00001 DS    1F                                                       02139000
@SA00002 DS    1F                                                       02140000
@SA00004 DS    1F                                                       02141000
@SA00008 DS    1F                                                       02142000
@SA00012 DS    1F                                                       02143000
@SA00011 DS    1F                                                       02144000
@SA00010 DS    1F                                                       02145000
@SA00009 DS    1F                                                       02146000
@SA00013 DS    1F                                                       02147000
@SA00016 DS    1F                                                       02148000
@SA00017 DS    1F                                                       02149000
@SA00022 DS    1F                                                       02150000
@SA00014 DS    1F                                                       02151000
@SA00015 DS    1F                                                       02152000
@SA00020 DS    1F                                                       02153000
@SA00019 DS    1F                                                       02154000
@SA00021 DS    1F                                                       02155000
@SA00023 DS    0F                                                       02156000
@SA00003 DS    0F                                                       02157000
         DS    1F                                                       02158000
@AL00001 DS    1A                                                       02159000
@TF00001 DS    F                                                        02160000
ISDAFSC0 CSECT                                                          02161000
         DS    0F                                                       02162000
@CF00552 DC    F'84'                                                    02163000
@CF00555 DC    F'3548'                                                  02164000
@DATD    DSECT                                                          02165000
         DS    0D                                                       02166000
SUMPTR   DS    A                                                        02167000
PRTPTR   DS    A                                                        02168000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                02169000
@ENDDATD EQU   *                                                        02170000
ISDAFSC0 CSECT                                                          02171000
         NOPR  ((@ENDDATD-@DATD)/161*16)                                02172000
         DS    0F                                                       02173000
@SIZDATD DC    AL1(0)                                                   02174000
         DC    AL3(@ENDDATD-@DATD)                                      02175000
@CV00431 DC    V(ISDAGET0)                                              02176000
@CV00432 DC    V(ISDAGET1)                                              02177000
@CV00433 DC    V(ISDAFREE)                                              02178000
         DS    0D                                                       02179000
@CC00449 DC    C'FSC '                                                  02180000
@CC00481 DC    C'  '                                                    02181000
@CC00495 DC    C'MS'                                                    02182000
@CC00496 DC    C'SA'                                                    02183000
@CC00497 DC    C'RC'                                                    02184000
@CC00498 DC    C'RD'                                                    02185000
@CC00499 DC    C'CS'                                                    02186000
@CC00500 DC    C'DA'                                                    02187000
@CB00416 DC    X'0FFF'                                                  02188000
@CB00418 DC    X'0001'                                                  02189000
PATCH    DS    CL50                                                     02190000
         ORG   PATCH                                                    02191000
@NM00025 DC    50X'00'                                                  02192000
         ORG   PATCH+50                                                 02193000
DEVICES  DC    X'38312A231C150E07'                                      02194000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       02195000
@01      EQU   01                                                       02196000
@02      EQU   02                                                       02197000
@03      EQU   03                                                       02198000
@04      EQU   04                                                       02199000
@05      EQU   05                                                       02200000
@06      EQU   06                                                       02201000
@07      EQU   07                                                       02202000
@08      EQU   08                                                       02203000
@09      EQU   09                                                       02204000
@10      EQU   10                                                       02205000
@11      EQU   11                                                       02206000
@12      EQU   12                                                       02207000
@13      EQU   13                                                       02208000
@14      EQU   14                                                       02209000
@15      EQU   15                                                       02210000
FSCRETCD EQU   @05                                                      02211000
CHNPTR   EQU   @06                                                      02212000
TBLPTR   EQU   @04                                                      02213000
FSCWKPTR EQU   @03                                                      02214000
LPARMPTR EQU   @07                                                      02215000
CVTPTR   EQU   @02                                                      02216000
RF       EQU   @15                                                      02217000
R0       EQU   @00                                                      02218000
R1       EQU   @01                                                      02219000
ISDACVT  EQU   0                                                        02220000
CVTPTRS0 EQU   ISDACVT                                                  02221000
DATAPTR  EQU   CVTPTRS0                                                 02222000
SDATAPTR EQU   CVTPTRS0+4                                               02223000
PARMPTR  EQU   CVTPTRS0+8                                               02224000
SDA00PTR EQU   CVTPTRS0+12                                              02225000
FSC00PTR EQU   CVTPTRS0+56                                              02226000
CNFG0PTR EQU   CVTPTRS0+88                                              02227000
GET0CALL EQU   ISDACVT+100                                              02228000
SPNOLEN  EQU   GET0CALL                                                 02229000
SPNO     EQU   SPNOLEN                                                  02230000
CORELEN  EQU   SPNOLEN+1                                                02231000
COREADDR EQU   GET0CALL+4                                               02232000
HEXPCALL EQU   ISDACVT+108                                              02233000
PRT0CALL EQU   ISDACVT+120                                              02234000
OUTLINE  EQU   PRT0CALL                                                 02235000
SDADATD  EQU   ISDACVT+256                                              02236000
PRTDATD  EQU   ISDACVT+416                                              02237000
ISDAPRMS EQU   0                                                        02238000
CINPUT   EQU   ISDAPRMS                                                 02239000
CSTART   EQU   ISDAPRMS+2                                               02240000
CEND     EQU   ISDAPRMS+6                                               02241000
CTYPE    EQU   ISDAPRMS+11                                              02242000
CFSCONLY EQU   ISDAPRMS+13                                              02243000
CFSC12   EQU   CFSCONLY                                                 02244000
CFSC34   EQU   CFSCONLY+2                                               02245000
CSSIDF   EQU   ISDAPRMS+17                                              02246000
CSERIAL  EQU   ISDAPRMS+21                                              02247000
CREPORTS EQU   ISDAPRMS+33                                              02248000
CFSC     EQU   CREPORTS+4                                               02249000
ISDAWORK EQU   0                                                        02250000
INFLAGS  EQU   ISDAWORK                                                 02251000
INDEVTYP EQU   INFLAGS+2                                                02252000
SDAFLAG0 EQU   INFLAGS+3                                                02253000
INRECCUA EQU   ISDAWORK+6                                               02254000
ISDAGHDR EQU   0                                                        02255000
STARTPTR EQU   ISDAGHDR                                                 02256000
ENDPTR   EQU   ISDAGHDR+4                                               02257000
GET0SPLN EQU   ISDAGHDR+8                                               02258000
NEXTPTR  EQU   ISDAGHDR+12                                              02259000
LASTPTR  EQU   ISDAGHDR+16                                              02260000
BLOCKID  EQU   ISDAGHDR+20                                              02261000
BLOCKCNT EQU   ISDAGHDR+24                                              02262000
PCNFG    EQU   0                                                        02263000
CNFGFXD  EQU   PCNFG                                                    02264000
CNFGTOTL EQU   PCNFG+28                                                 02265000
OBRMDR   EQU   0                                                        02266000
SCW      EQU   OBRMDR                                                   02267000
SWITCHES EQU   OBRMDR+6                                                 02268000
DATETIME EQU   OBRMDR+12                                                02269000
DATE     EQU   DATETIME                                                 02270000
TIME     EQU   DATETIME+4                                               02271000
CPUSERID EQU   OBRMDR+21                                                02272000
ISDAMSCS EQU   0                                                        02273000
SUBSYSID EQU   ISDAMSCS+1                                               02274000
SSID     EQU   SUBSYSID                                                 02275000
FORMATNO EQU   ISDAMSCS+3                                               02276000
SUBSENSE EQU   ISDAMSCS+4                                               02277000
SUBSTAT5 EQU   SUBSENSE+1                                               02278000
SUBFMTMG EQU   SUBSENSE+7                                               02279000
SUBFMTNO EQU   SUBFMTMG                                                 02280000
MSCFSC   EQU   SUBSENSE+22                                              02281000
FSCWORK  EQU   0                                                        02282000
GET0PTR  EQU   FSCWORK                                                  02283000
PTRSAVE  EQU   FSCWORK+4                                                02284000
FSCPTR   EQU   FSCWORK+8                                                02285000
LOGPTR   EQU   FSCWORK+12                                               02286000
SENSEPTR EQU   FSCWORK+16                                               02287000
FREEPTR  EQU   FSCWORK+20                                               02288000
CHAINTBL EQU   FSCWORK+32                                               02289000
TBLPTRSV EQU   FSCWORK+40                                               02290000
FSCTBLCT EQU   FSCWORK+44                                               02291000
SSIDCT   EQU   FSCWORK+46                                               02292000
SSIDCTR  EQU   FSCWORK+48                                               02293000
TBLELMCT EQU   FSCWORK+50                                               02294000
I        EQU   FSCWORK+52                                               02295000
WORKFLGS EQU   FSCWORK+54                                               02296000
MSCREC   EQU   WORKFLGS                                                 02297000
SAREC    EQU   WORKFLGS                                                 02298000
DRCREC   EQU   WORKFLGS                                                 02299000
DRDREC   EQU   WORKFLGS                                                 02300000
CSREC    EQU   WORKFLGS                                                 02301000
DIRREC   EQU   WORKFLGS                                                 02302000
DAREC    EQU   WORKFLGS                                                 02303000
DASDREC  EQU   WORKFLGS                                                 02304000
FMT3ACC1 EQU   WORKFLGS+1                                               02305000
FMT3ACC2 EQU   WORKFLGS+1                                               02306000
FSCCOUNT EQU   WORKFLGS+1                                               02307000
WORKAPR  EQU   WORKFLGS+1                                               02308000
ADDCORE  EQU   WORKFLGS+1                                               02309000
LSSID    EQU   FSCWORK+56                                               02310000
LFSC     EQU   FSCWORK+58                                               02311000
LFSCSYS  EQU   FSCWORK+62                                               02312000
LTYPE    EQU   FSCWORK+64                                               02313000
SSIDSAVE EQU   FSCWORK+66                                               02314000
CUAFLAG  EQU   SSIDSAVE                                                 02315000
SSIDDEV  EQU   SSIDSAVE                                                 02316000
FSCSYSSV EQU   FSCWORK+68                                               02317000
FSCSAVE1 EQU   FSCWORK+70                                               02318000
FSCSAVE2 EQU   FSCWORK+74                                               02319000
DEVBYTES EQU   FSCWORK+82                                               02320000
DEVBYTEA EQU   DEVBYTES                                                 02321000
FSCTBL   EQU   0                                                        02322000
FSCSPTR  EQU   FSCTBL                                                   02323000
FSCSSID  EQU   FSCTBL+4                                                 02324000
FSCFSC   EQU   FSCTBL+8                                                 02325000
FSCSYS   EQU   FSCFSC                                                   02326000
CNTLUNIT EQU   FSCFSC+3                                                 02327000
FSCDT    EQU   FSCTBL+12                                                02328000
FSCDATE  EQU   FSCDT                                                    02329000
FSCTIME  EQU   FSCDT+4                                                  02330000
FSCCTR   EQU   FSCTBL+20                                                02331000
FSCFLAGS EQU   FSCTBL+26                                                02332000
MSCFLAG  EQU   FSCFLAGS                                                 02333000
SAFLAG   EQU   FSCFLAGS                                                 02334000
DRCFLAG  EQU   FSCFLAGS                                                 02335000
DRDFLAG  EQU   FSCFLAGS                                                 02336000
CSFLAG   EQU   FSCFLAGS                                                 02337000
DIRFLAG  EQU   FSCFLAGS                                                 02338000
DAFLAG   EQU   FSCFLAGS                                                 02339000
DASDFLAG EQU   FSCFLAGS                                                 02340000
REALDASD EQU   FSCFLAGS+1                                               02341000
VIRTDASD EQU   FSCFLAGS+1                                               02342000
FAKEFSC  EQU   FSCFLAGS+1                                               02343000
FSCAPR   EQU   FSCFLAGS+1                                               02344000
FSCDEVS  EQU   FSCTBL+28                                                02345000
CHNTBL   EQU   0                                                        02346000
CHNTPTR  EQU   CHNTBL                                                   02347000
CHNSSIDF EQU   CHNTBL+4                                                 02348000
FSCTPTR  EQU   CHNTBL+8                                                 02349000
SUMTBL   EQU   0                                                        02350000
PRTTBL   EQU   0                                                        02351000
ISDAMSC3 EQU   4                                                        02352000
FSCACC1  EQU   ISDAMSC3+4                                               02353000
FSCACC2  EQU   ISDAMSC3+8                                               02354000
MSCFIVE  EQU   0                                                        02355000
DRIVEID  EQU   MSCFIVE+8                                                02356000
MSCDASD  EQU   0                                                        02357000
DRIVE    EQU   MSCDASD+4                                                02358000
FMTMSG   EQU   MSCDASD+7                                                02359000
DASDFMT  EQU   FMTMSG                                                   02360000
DASD10   EQU   MSCDASD+10                                               02361000
FSCDASD  EQU   MSCDASD+22                                               02362000
SSIDDASD EQU   MSCDASD+27                                               02363000
WORKPTR  EQU   0                                                        02364000
DUMCTR   EQU   FSCDEVS                                                  02365000
SSIDDUM  EQU   SSIDSAVE                                                 02366000
SSIDDUMA EQU   SSIDDUM                                                  02367000
SSIDDUMB EQU   SSIDDUM+1                                                02368000
*                                      START UNREFERENCED COMPONENTS    02369000
@NM00024 EQU   MSCDASD+24                                               02370000
@NM00023 EQU   MSCDASD+21                                               02371000
DASD20   EQU   MSCDASD+20                                               02372000
@NM00022 EQU   MSCDASD+12                                               02373000
DASD11   EQU   MSCDASD+11                                               02374000
@NM00021 EQU   DASD10                                                   02375000
CLOCKERR EQU   DASD10                                                   02376000
TIMEBIT  EQU   DASD10                                                   02377000
@NM00020 EQU   MSCDASD+8                                                02378000
DASDMSG  EQU   FMTMSG                                                   02379000
@NM00019 EQU   MSCDASD+5                                                02380000
@NM00018 EQU   MSCDASD                                                  02381000
@NM00017 EQU   MSCFIVE+9                                                02382000
@NM00016 EQU   MSCFIVE                                                  02383000
@NM00015 EQU   ISDAMSC3+16                                              02384000
IREGS3F3 EQU   ISDAMSC3+15                                              02385000
IREGS2F3 EQU   ISDAMSC3+14                                              02386000
IREGS1F3 EQU   ISDAMSC3+13                                              02387000
MISCF3   EQU   ISDAMSC3+12                                              02388000
SHIFT2F3 EQU   FSCACC2+3                                                02389000
PCHKACC2 EQU   FSCACC2+2                                                02390000
FAULT2F3 EQU   FSCACC2+1                                                02391000
MCHKACC2 EQU   FSCACC2                                                  02392000
SHIFT1F3 EQU   FSCACC1+3                                                02393000
PCHKACC1 EQU   FSCACC1+2                                                02394000
FAULT1F3 EQU   FSCACC1+1                                                02395000
MCHKACC1 EQU   FSCACC1                                                  02396000
QUEUE3   EQU   ISDAMSC3+3                                               02397000
MOVES12  EQU   ISDAMSC3+2                                               02398000
RECOVER3 EQU   ISDAMSC3+1                                               02399000
STATUS3  EQU   ISDAMSC3                                                 02400000
PRTTPTR  EQU   PRTTBL                                                   02401000
SUMPCTR  EQU   SUMTBL+14                                                02402000
SUMSCTR  EQU   SUMTBL+12                                                02403000
SUMFPTR  EQU   SUMTBL+8                                                 02404000
SUMTOTAL EQU   SUMTBL+6                                                 02405000
SUMSSID  EQU   SUMTBL+4                                                 02406000
SUMTPTR  EQU   SUMTBL                                                   02407000
@NM00014 EQU   CHNTBL+6                                                 02408000
CHNSSID  EQU   CHNSSIDF                                                 02409000
SSIDFLGS EQU   CHNSSIDF                                                 02410000
DEVHCTR  EQU   FSCDEVS+14                                               02411000
DEVGCTR  EQU   FSCDEVS+12                                               02412000
DEVFCTR  EQU   FSCDEVS+10                                               02413000
DEVECTR  EQU   FSCDEVS+8                                                02414000
DEVDCTR  EQU   FSCDEVS+6                                                02415000
DEVCCTR  EQU   FSCDEVS+4                                                02416000
DEVBCTR  EQU   FSCDEVS+2                                                02417000
DEVACTR  EQU   FSCDEVS                                                  02418000
INPRTTBL EQU   FSCFLAGS+1                                               02419000
@NM00013 EQU   FSCFLAGS+1                                               02420000
FSCPCT   EQU   FSCTBL+24                                                02421000
FSCSUM   EQU   FSCTBL+22                                                02422000
FSCHSEC  EQU   FSCTIME+3                                                02423000
FSCSEC   EQU   FSCTIME+2                                                02424000
FSCMIN   EQU   FSCTIME+1                                                02425000
FSCHR    EQU   FSCTIME                                                  02426000
FSCDAY   EQU   FSCDATE+2                                                02427000
FSCYR    EQU   FSCDATE                                                  02428000
@NM00012 EQU   FSCFSC+2                                                 02429000
@NM00011 EQU   FSCSSID+2                                                02430000
UNITCHAR EQU   FSCSSID+1                                                02431000
DEVCHAR  EQU   FSCSSID                                                  02432000
DEVBYTEB EQU   DEVBYTES+1                                               02433000
LINECT   EQU   FSCWORK+80                                               02434000
SUMBUILD EQU   FSCWORK+78                                               02435000
@NM00010 EQU   SSIDSAVE+1                                               02436000
@NM00009 EQU   WORKFLGS+1                                               02437000
PRINTTBL EQU   FSCWORK+36                                               02438000
SUMSTART EQU   FSCWORK+28                                               02439000
SUMTABLE EQU   FSCWORK+24                                               02440000
SANOMSCD EQU   SUBSENSE+27                                              02441000
RCYLMSCD EQU   SUBSENSE+25                                              02442000
RUAMSCD  EQU   SUBSENSE+24                                              02443000
@NM00008 EQU   SUBSENSE+21                                              02444000
RUADASD  EQU   SUBSENSE+20                                              02445000
DASDFSC  EQU   SUBSENSE+18                                              02446000
@NM00007 EQU   SUBSENSE+8                                               02447000
MSGCODEN EQU   SUBFMTMG                                                 02448000
SALOWAD2 EQU   SUBSENSE+6                                               02449000
SARETRY  EQU   SUBSENSE+5                                               02450000
@NM00006 EQU   SUBSENSE+4                                               02451000
DASDFMTN EQU   SUBSENSE+3                                               02452000
SALOWADD EQU   SUBSENSE+2                                               02453000
SUBSTAT4 EQU   SUBSENSE                                                 02454000
SSIDDEVT EQU   SSID+1                                                   02455000
SSIDLIBN EQU   SSID+1                                                   02456000
SSIDTYPE EQU   SSID                                                     02457000
SSIDFLAG EQU   SUBSYSID                                                 02458000
STATUS   EQU   ISDAMSCS                                                 02459000
CPUID    EQU   CPUSERID+3                                               02460000
CPUSER   EQU   CPUSERID                                                 02461000
VERNO    EQU   OBRMDR+20                                                02462000
TENSHUND EQU   TIME+3                                                   02463000
SECOND   EQU   TIME+2                                                   02464000
MINUTE   EQU   TIME+1                                                   02465000
HOUR     EQU   TIME                                                     02466000
DAY      EQU   DATE+2                                                   02467000
YEAR     EQU   DATE                                                     02468000
RECENTRY EQU   OBRMDR+11                                                02469000
RCDCNT   EQU   OBRMDR+10                                                02470000
SWITCH3  EQU   SWITCHES+3                                               02471000
SWITCH2  EQU   SWITCHES+2                                               02472000
SWITCH1  EQU   SWITCHES+1                                               02473000
SWITCH0  EQU   SWITCHES                                                 02474000
SYSREL   EQU   OBRMDR+5                                                 02475000
CLASRC   EQU   OBRMDR+4                                                 02476000
@NM00005 EQU   SCW+3                                                    02477000
SCODE    EQU   SCW+2                                                    02478000
SLENGTH  EQU   SCW                                                      02479000
SAINTFP  EQU   PCNFG+32                                                 02480000
@NM00004 EQU   PCNFG+30                                                 02481000
CPUSERAD EQU   PCNFG+24                                                 02482000
CHCUAD   EQU   PCNFG+20                                                 02483000
LTPAD    EQU   PCNFG+16                                                 02484000
PCNFGL   EQU   CNFGFXD+14                                               02485000
CHINTFNO EQU   CNFGFXD+12                                               02486000
LIBSIZS  EQU   CNFGFXD+8                                                02487000
SANO     EQU   CNFGFXD+6                                                02488000
SPINO    EQU   CNFGFXD+4                                                02489000
CPUNO    EQU   CNFGFXD+2                                                02490000
MSFNO    EQU   CNFGFXD                                                  02491000
@NM00003 EQU   ISDAGHDR+26                                              02492000
GET0LEN  EQU   GET0SPLN+1                                               02493000
GET0SPNO EQU   GET0SPLN                                                 02494000
DEVPTR   EQU   ISDAWORK+16                                              02495000
NOUTREC  EQU   ISDAWORK+12                                              02496000
NINREC   EQU   ISDAWORK+8                                               02497000
CUABYTE1 EQU   INRECCUA+1                                               02498000
CUABYTE0 EQU   INRECCUA                                                 02499000
DLENGTH  EQU   ISDAWORK+4                                               02500000
INSOURCE EQU   INFLAGS+1                                                02501000
IRECTYPE EQU   INFLAGS                                                  02502000
CTRACE   EQU   ISDAPRMS+48                                              02503000
CGEN     EQU   ISDAPRMS+47                                              02504000
CDETAIL  EQU   ISDAPRMS+46                                              02505000
CPERIOD  EQU   ISDAPRMS+45                                              02506000
CPWR     EQU   CREPORTS+11                                              02507000
CAPRSUU  EQU   CREPORTS+10                                              02508000
CDRC     EQU   CREPORTS+9                                               02509000
CDAT     EQU   CREPORTS+8                                               02510000
CCSBCSF  EQU   CREPORTS+7                                               02511000
CDCKTLX  EQU   CREPORTS+6                                               02512000
CEQC     EQU   CREPORTS+5                                               02513000
CDHEDHU  EQU   CREPORTS+3                                               02514000
CSUM     EQU   CREPORTS+2                                               02515000
CPAD     EQU   CREPORTS+1                                               02516000
CDCS     EQU   CREPORTS                                                 02517000
CSERNO   EQU   CSERIAL+4                                                02518000
@NM00002 EQU   CSERIAL+3                                                02519000
CIBM     EQU   CSERIAL                                                  02520000
CRATIO   EQU   ISDAPRMS+19                                              02521000
CSSID    EQU   CSSIDF                                                   02522000
@NM00001 EQU   CSSIDF                                                   02523000
CSUMMARY EQU   ISDAPRMS+10                                              02524000
CENDDAY  EQU   CEND+2                                                   02525000
CENDYEAR EQU   CEND                                                     02526000
CSTDAY   EQU   CSTART+2                                                 02527000
CSTYEAR  EQU   CSTART                                                   02528000
CHISTIN  EQU   CINPUT+1                                                 02529000
CLOGIN   EQU   CINPUT                                                   02530000
PRTSA001 EQU   PRTDATD                                                  02531000
SDATEMPS EQU   SDADATD+136                                              02532000
SDASA002 EQU   SDADATD+76                                               02533000
SDAPC001 EQU   SDADATD+72                                               02534000
SDASA001 EQU   SDADATD                                                  02535000
SDARPTID EQU   PRT0CALL+133                                             02536000
LINE     EQU   OUTLINE+1                                                02537000
ANSI     EQU   OUTLINE                                                  02538000
DUMPIDNO EQU   HEXPCALL+8                                               02539000
DUMPLEN  EQU   HEXPCALL+4                                               02540000
DUMPADDR EQU   HEXPCALL                                                 02541000
WORKCALL EQU   CVTPTRS0+96                                              02542000
GEN00PTR EQU   CVTPTRS0+92                                              02543000
PWR00PTR EQU   CVTPTRS0+84                                              02544000
APR00PTR EQU   CVTPTRS0+80                                              02545000
DRC00PTR EQU   CVTPTRS0+76                                              02546000
DAT00PTR EQU   CVTPTRS0+72                                              02547000
CSB00PTR EQU   CVTPTRS0+68                                              02548000
DCK00PTR EQU   CVTPTRS0+64                                              02549000
EQC00PTR EQU   CVTPTRS0+60                                              02550000
DHE00PTR EQU   CVTPTRS0+52                                              02551000
SUM00PTR EQU   CVTPTRS0+48                                              02552000
PAD00PTR EQU   CVTPTRS0+44                                              02553000
DCS00PTR EQU   CVTPTRS0+40                                              02554000
LOG00PTR EQU   CVTPTRS0+36                                              02555000
HIST0PTR EQU   CVTPTRS0+32                                              02556000
PRT00PTR EQU   CVTPTRS0+28                                              02557000
GET00PTR EQU   CVTPTRS0+24                                              02558000
TYPE0PTR EQU   CVTPTRS0+20                                              02559000
PARM0PTR EQU   CVTPTRS0+16                                              02560000
*                                      END UNREFERENCED COMPONENTS      02561000
@RC00035 EQU   @RC00032                                                 02562000
@RC00059 EQU   @RC00058                                                 02563000
@RC00074 EQU   @EL00002                                                 02564000
@RC00115 EQU   @EL00003                                                 02565000
@RC00133 EQU   @RC00132                                                 02566000
@RC00147 EQU   @RC00132                                                 02567000
@RC00145 EQU   @RC00132                                                 02568000
@RC00174 EQU   @EL00004                                                 02569000
@RC00181 EQU   @EL00005                                                 02570000
@RC00221 EQU   @EL00006                                                 02571000
@RC00214 EQU   @EL00006                                                 02572000
@RC00207 EQU   @EL00006                                                 02573000
@RC00242 EQU   @EL00007                                                 02574000
@RC00238 EQU   @EL00007                                                 02575000
@RC00247 EQU   @EL00008                                                 02576000
@RF00259 EQU   @EL00009                                                 02577000
@RC00264 EQU   @EL00010                                                 02578000
@RC00319 EQU   @EL00011                                                 02579000
@RC00315 EQU   @EL00011                                                 02580000
@RC00311 EQU   @EL00011                                                 02581000
@RC00307 EQU   @EL00011                                                 02582000
@RC00303 EQU   @EL00011                                                 02583000
@RC00334 EQU   @EL00012                                                 02584000
@RC00345 EQU   @EL00012                                                 02585000
@RC00351 EQU   @EL00013                                                 02586000
@RC00366 EQU   @EL00014                                                 02587000
@RF00373 EQU   @EL00014                                                 02588000
@RC00388 EQU   @RC00387                                                 02589000
@RC00420 EQU   @RC00417                                                 02590000
@RC00433 EQU   @EL00016                                                 02591000
@RC00460 EQU   @EL00016                                                 02592000
@RC00473 EQU   @EL00017                                                 02593000
@RC00502 EQU   @EL00019                                                 02594000
@RC00517 EQU   @EL00020                                                 02595000
@RC00540 EQU   @EL00022                                                 02596000
@RC00087 EQU   @RC00074                                                 02597000
@RC00134 EQU   @RC00133                                                 02598000
@RC00150 EQU   @RC00147                                                 02599000
@RC00184 EQU   @RC00181                                                 02600000
@RC00196 EQU   @RC00181                                                 02601000
@RC00224 EQU   @RC00221                                                 02602000
@RC00222 EQU   @RC00221                                                 02603000
@RC00239 EQU   @RC00238                                                 02604000
@RC00248 EQU   @RC00247                                                 02605000
@RC00265 EQU   @RC00264                                                 02606000
@RC00439 EQU   @RC00433                                                 02607000
@RC00249 EQU   @RC00248                                                 02608000
@RC00266 EQU   @RC00265                                                 02609000
@RC00250 EQU   @RC00249                                                 02610000
@ENDDATA EQU   *                                                        02611000
         END   ISDAFSC0,(C'PLS1830',0603,75268)                         02612000
