         TITLE 'FAULT SYMPTOM CODE REPORT INFORMATION ROUTINE          *00001000
                        '                                               00002000
ISDAFSC2 CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(8)                                              0001 00007000
         DC    C'ISDAFSC2'                                         0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @12,0                                               0001 00011000
@PSTART  DS    0H                                                  0001 00012000
         USING @PSTART,@12                                         0001 00013000
         L     @00,@SIZDATD                                        0001 00014000
         ISDAGSPC R,LV=(0)                                              00015000
         LR    @11,@01                                             0001 00016000
         USING @DATD,@11                                           0001 00017000
         ST    @13,@SA00001+4                                      0001 00018000
         LM    @00,@01,20(@13)                                     0001 00019000
         ST    @11,8(,@13)                                         0001 00020000
         LR    @13,@11                                             0001 00021000
         MVC   @PC00001(4),0(@01)                                  0001 00022000
*                                                                  0016 00023000
*   /*****************************************************************/ 00024000
*   /*                                                               */ 00025000
*   /* PROGRAM START.                                                */ 00026000
*   /*                                                               */ 00027000
*   /*****************************************************************/ 00028000
*                                                                  0016 00029000
*   CVTPTR=WORKPTR;                 /* SET LOCAL PTR TO SDACVT.    0016 00030000
*                                                            @Y30LB51*/ 00031000
         L     @10,@PC00001                                        0016 00032000
         L     CVTPTR,WORKPTR(,@10)                                0016 00033000
*   LPARMPTR=PARMPTR;               /* SET LOCAL PTR TO SDAPARMS.  0017 00034000
*                                                            @Y30LB51*/ 00035000
         L     LPARMPTR,PARMPTR(,CVTPTR)                           0017 00036000
*   FSCRETCD=0;                     /* INITIALIZE THE RETURN CODE. 0018 00037000
*                                                            @Y30LB51*/ 00038000
         SLR   @10,@10                                             0018 00039000
         LR    FSCRETCD,@10                                        0018 00040000
*   FSCWKPTR=FSC00PTR;              /* SET PTR TO WORK AREA. @Y30LB51*/ 00041000
         L     FSCWKPTR,FSC00PTR(,CVTPTR)                          0019 00042000
*   IF FSCWKPTR^=0 THEN             /* IF WORK AREA PRESENT  @Y30LB51*/ 00043000
         CR    FSCWKPTR,@10                                        0020 00044000
         BE    @RF00020                                            0020 00045000
*     DO;                           /* CHECK FOR DATA IN FSC TABLE.     00046000
*                                                            @Y30LB51*/ 00047000
*       CHNPTR=CHAINTBL;            /* SET PTR TO CHAIN TABLE.     0022 00048000
*                                                            @Y30LB51*/ 00049000
         L     CHNPTR,CHAINTBL(,FSCWKPTR)                          0022 00050000
*       IF CHNPTR^=0 THEN           /* IF CHAIN TABLE PRESENT      0023 00051000
*                                                            @Y30LB51*/ 00052000
         CR    CHNPTR,@10                                          0023 00053000
         BE    @RF00023                                            0023 00054000
*         DO;                       /* PROCESS THE DATA.     @Y30LB51*/ 00055000
*           CALL GETTBLS;           /* GET SPACE FOR TABLES. @Y30LB51*/ 00056000
         BAL   @14,GETTBLS                                         0025 00057000
*           IF FSCRETCD=0 THEN      /* IF SPACE SECURED      @Y30LB51*/ 00058000
         LTR   FSCRETCD,FSCRETCD                                   0026 00059000
         BNZ   @RF00026                                            0026 00060000
*             DO;                   /* PROCESS THE DATA.     @Y30LB51*/ 00061000
*               GET0PTR=FSCPTR;     /* SET PTR TO FIRST FSC TABLE. 0028 00062000
*                                                            @Y30LB51*/ 00063000
         L     @10,FSCPTR(,FSCWKPTR)                               0028 00064000
         ST    @10,GET0PTR(,FSCWKPTR)                              0028 00065000
*               TBLPTR=STARTPTR;    /* SET PTR TO FIRST ELEMENT.   0029 00066000
*                                                            @Y30LB51*/ 00067000
         L     TBLPTR,STARTPTR(,@10)                               0029 00068000
*               CHNPTR=CHAINTBL;    /* SET PTR TO CHAIN TABLE.     0030 00069000
*                                                            @Y30LB51*/ 00070000
         L     CHNPTR,CHAINTBL(,FSCWKPTR)                          0030 00071000
*               CALL COMPSUM;       /* COMPUTE TOTAL RECORDS PER   0031 00072000
*                                      SSID.                 @Y30LB51*/ 00073000
         BAL   @14,COMPSUM                                         0031 00074000
*               CALL COMPPCT;       /* COMPUTE PER CENT RECORDS PER     00075000
*                                      FSC.                  @Y30LB51*/ 00076000
         BAL   @14,COMPPCT                                         0032 00077000
*               CALL PREPPRNT;      /* PREPARE THE PRINT TABLE.    0033 00078000
*                                                            @Y30LB51*/ 00079000
         BAL   @14,PREPPRNT                                        0033 00080000
*             END;                  /*                       @Y30LB51*/ 00081000
*           ELSE                    /* PRINT TABLE AND SUM TABLE   0035 00082000
*                                      SPACE NOT AVAILBLE    @Y30LB51*/ 00083000
*             CALL FREECORE;        /* FREE ALL DYNAMIC STORAGE.   0035 00084000
*                                                            @Y30LB51*/ 00085000
         B     @RC00026                                            0035 00086000
@RF00026 BAL   @14,FREECORE                                        0035 00087000
*         END;                      /*                       @Y30LB51*/ 00088000
*       ELSE                        /* NO DATA IN FSC TABLE. @Y30LB51*/ 00089000
*         DO;                       /* FREE DYNAMIC STORAGE. @Y30LB51*/ 00090000
         B     @RC00023                                            0037 00091000
@RF00023 DS    0H                                                  0038 00092000
*           CALL FREECORE;          /* GO FREE STORAGE.      @Y30LB51*/ 00093000
         BAL   @14,FREECORE                                        0038 00094000
*           FSCRETCD=NODATA;        /* SET RETURN CODE.      @Y30LB51*/ 00095000
         LA    FSCRETCD,8                                          0039 00096000
*         END;                      /* Y30LB51                       */ 00097000
*     END;                          /*                       @Y30LB51*/ 00098000
*   ELSE                            /* NO WORK AREA PRESENT. @Y30LB51*/ 00099000
*     DO;                           /*                       @Y30LB51*/ 00100000
         B     @RC00020                                            0042 00101000
@RF00020 DS    0H                                                  0043 00102000
*       CFSC='00'X;                 /* SET 'DO NOT CALL' SWITCH.   0043 00103000
*                                                            @Y30LB51*/ 00104000
         MVI   CFSC(LPARMPTR),X'00'                                0043 00105000
*       FSCRETCD=NODATA;            /*                       @Y30LB51*/ 00106000
         LA    FSCRETCD,8                                          0044 00107000
*     END;                          /*                       @Y30LB51*/ 00108000
*   RETURN CODE(FSCRETCD);          /*                       @Y30LB51*/ 00109000
@RC00020 L     @13,4(,@13)                                         0046 00110000
         L     @00,@SIZDATD                                        0046 00111000
         LR    @01,@11                                             0046 00112000
         ISDAFSPC R,LV=(0),A=(1)                                        00113000
         LR    @15,@07                                             0046 00114000
         L     @14,12(,@13)                                        0046 00115000
         LM    @00,@12,20(@13)                                     0046 00116000
         BR    @14                                                 0046 00117000
*GETTBLS:                                                          0047 00118000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/ 00119000
*                                                                  0047 00120000
@EL00001 L     @13,4(,@13)                                         0047 00121000
@EF00001 L     @00,@SIZDATD                                        0047 00122000
         LR    @01,@11                                             0047 00123000
         ISDAFSPC R,LV=(0),A=(1)                                        00124000
@ER00001 LM    @14,@12,12(@13)                                     0047 00125000
         BR    @14                                                 0047 00126000
GETTBLS  ST    @14,@SA00002                                        0047 00127000
*   /*****************************************************************/ 00128000
*   /*                                                               */ 00129000
*   /* THIS ROUTINE WILL OBTAIN SPACE - VIA THE GETMAIN MACRO - FOR  */ 00130000
*   /* THE SUM TABLE AND PRINT TABLE. SSIDCTR CONTAINS THE COUNT OF  */ 00131000
*   /* SSIDS IN THE CHAIN TABLE. THE SUMTABLE WILL HAVE ONE ENTRY FOR*/ 00132000
*   /* EACH SSID IN THE CHAIN TABLE PLUS ONE. TBLELMCT CONTAINS THE  */ 00133000
*   /* COUNT OF ENTRIES IN THE FSC TABLE. THE PRINT TABLE WILL HAVE  */ 00134000
*   /* ONE ENTRY FOR EACH ENTRY IN THE FSC TABLE.                    */ 00135000
*   /*                                                               */ 00136000
*   /*****************************************************************/ 00137000
*                                                                  0048 00138000
*   SSIDCTR=SSIDCTR+1;              /*                       @Y30LB51*/ 00139000
         LA    @10,1                                               0048 00140000
         LH    @06,SSIDCTR(,FSCWKPTR)                              0048 00141000
         ALR   @06,@10                                             0048 00142000
         STH   @06,SSIDCTR(,FSCWKPTR)                              0048 00143000
*   TBLELMCT=TBLELMCT+1;            /*                       @Y30LB51*/ 00144000
         AH    @10,TBLELMCT(,FSCWKPTR)                             0049 00145000
         STH   @10,TBLELMCT(,FSCWKPTR)                             0049 00146000
*   SPNO='04'X;                     /* SPECIFY SUBPOOL NUMBER.     0050 00147000
*                                                            @Y30LB51*/ 00148000
         MVI   SPNO(CVTPTR),X'04'                                  0050 00149000
*   CORELEN=LENGTH(SUMTBL)*SSIDCTR; /* GET SUM TABLE LENGTH. @Y30LB51*/ 00150000
         SLA   @06,4                                               0051 00151000
         STCM  @06,7,CORELEN(CVTPTR)                               0051 00152000
*   CALL ISDAGET1(WORKPTR);         /* GET SPACE FOR SUM TABLE.    0052 00153000
*                                                            @Y30LB51*/ 00154000
         L     @10,@PC00001                                        0052 00155000
         ST    @10,@AL00001                                        0052 00156000
         L     @15,@CV00288                                        0052 00157000
         LA    @01,@AL00001                                        0052 00158000
         BALR  @14,@15                                             0052 00159000
*   RFY                                                            0053 00160000
*     RF RSTD;                      /*                       @Y30LB51*/ 00161000
*   FSCRETCD=RF;                    /* SAVE RETURN CODE.     @Y30LB51*/ 00162000
         LR    FSCRETCD,RF                                         0054 00163000
*   RFY                                                            0055 00164000
*     RF UNRSTD;                    /*                       @Y30LB51*/ 00165000
*   IF FSCRETCD=0 THEN              /* IF SUM TABLE SPACE OBTAINED 0056 00166000
*                                                            @Y30LB51*/ 00167000
         LTR   FSCRETCD,FSCRETCD                                   0056 00168000
         BNZ   @RF00056                                            0056 00169000
*     DO;                           /* GET SPACE FOR PRINT TABLE.  0057 00170000
*                                                            @Y30LB51*/ 00171000
*       SUMTABLE=COREADDR;          /* SAVE ADDRESS OF SUM TABLE.  0058 00172000
*                                                            @Y30LB51*/ 00173000
         L     @10,COREADDR(,CVTPTR)                               0058 00174000
         ST    @10,SUMTABLE(,FSCWKPTR)                             0058 00175000
*       FREEPTR=COREADDR;           /* SET PTR TO SUM TABLE START. 0059 00176000
*                                                            @Y30LB51*/ 00177000
         ST    @10,FREEPTR(,FSCWKPTR)                              0059 00178000
*       SUMPTR=COREADDR;            /* SET PTR TO SUM TABLE. @Y30LB51*/ 00179000
         LR    SUMPTR,@10                                          0060 00180000
*       DO I=1 TO SSIDCTR;          /* ZERO OUT THE SUM TABLE.     0061 00181000
*                                                            @Y30LB51*/ 00182000
         LA    @10,1                                               0061 00183000
         B     @DE00061                                            0061 00184000
@DL00061 DS    0H                                                  0062 00185000
*         SUMTBL=''B;               /*                       @Y30LB51*/ 00186000
         XC    SUMTBL(16,SUMPTR),SUMTBL(SUMPTR)                    0062 00187000
*         SUMPTR=SUMPTR+LENGTH(SUMTBL);/*                    @Y30LB51*/ 00188000
         AH    SUMPTR,@CH00172                                     0063 00189000
*       END;                        /*                       @Y30LB51*/ 00190000
         LA    @10,1                                               0064 00191000
         AH    @10,I(,FSCWKPTR)                                    0064 00192000
@DE00061 STH   @10,I(,FSCWKPTR)                                    0064 00193000
         CH    @10,SSIDCTR(,FSCWKPTR)                              0064 00194000
         BNH   @DL00061                                            0064 00195000
*       CORELEN=LENGTH(PRTTBL)*TBLELMCT;/* GET PRINT TABLE LENGTH. 0065 00196000
*                                                            @Y30LB51*/ 00197000
         LH    @10,TBLELMCT(,FSCWKPTR)                             0065 00198000
         SLA   @10,2                                               0065 00199000
         STCM  @10,7,CORELEN(CVTPTR)                               0065 00200000
*       CALL ISDAGET1(WORKPTR);     /* GET SPACE FOR PRINT TABLE.  0066 00201000
*                                                            @Y30LB51*/ 00202000
         L     @10,@PC00001                                        0066 00203000
         ST    @10,@AL00001                                        0066 00204000
         L     @15,@CV00288                                        0066 00205000
         LA    @01,@AL00001                                        0066 00206000
         BALR  @14,@15                                             0066 00207000
*       RFY                                                        0067 00208000
*         RF RSTD;                  /*                       @Y30LB51*/ 00209000
*       FSCRETCD=RF;                /* SAVE RETURN CODE.     @Y30LB51*/ 00210000
         LR    FSCRETCD,RF                                         0068 00211000
*       RFY                                                        0069 00212000
*         RF UNRSTD;                /*                       @Y30LB51*/ 00213000
*       IF FSCRETCD=0 THEN          /* IF PRINT ABLE SPACE OBTAINED     00214000
*                                                            @Y30LB51*/ 00215000
         LTR   FSCRETCD,FSCRETCD                                   0070 00216000
         BNZ   @RF00070                                            0070 00217000
*         DO;                       /* INITIALIZE THE PRINT TABLE. 0071 00218000
*                                                            @Y30LB51*/ 00219000
*           PRINTTBL=COREADDR;      /* SAVE PRINT TABLE ADDRESS.   0072 00220000
*                                                            @Y30LB51*/ 00221000
         L     @10,COREADDR(,CVTPTR)                               0072 00222000
         ST    @10,PRINTTBL(,FSCWKPTR)                             0072 00223000
*           PRTPTR=COREADDR;        /* SET PTR TO PRINT TABLE.     0073 00224000
*                                                            @Y30LB51*/ 00225000
         LR    PRTPTR,@10                                          0073 00226000
*           DO I=1 TO TBLELMCT;     /* ZERO OUT THE PRINT TABLE.   0074 00227000
*                                                            @Y30LB51*/ 00228000
         LA    @10,1                                               0074 00229000
         B     @DE00074                                            0074 00230000
@DL00074 DS    0H                                                  0075 00231000
*             PRTTBL=''B;           /*                       @Y30LB51*/ 00232000
         XC    PRTTBL(4,PRTPTR),PRTTBL(PRTPTR)                     0075 00233000
*             PRTPTR=PRTPTR+LENGTH(PRTTBL);/*                @Y30LB51*/ 00234000
         AH    PRTPTR,@CH00105                                     0076 00235000
*           END;                    /*                       @Y30LB51*/ 00236000
         LA    @10,1                                               0077 00237000
         AH    @10,I(,FSCWKPTR)                                    0077 00238000
@DE00074 STH   @10,I(,FSCWKPTR)                                    0077 00239000
         CH    @10,TBLELMCT(,FSCWKPTR)                             0077 00240000
         BNH   @DL00074                                            0077 00241000
*         END;                      /*                       @Y30LB51*/ 00242000
*       ELSE                        /* PRINT TABLE SPACE NOT       0079 00243000
*                                      OBTAINED.             @Y30LB51*/ 00244000
*         FSCRETCD=NOSPACE;         /*                       @Y30LB51*/ 00245000
         B     @RC00070                                            0079 00246000
@RF00070 LA    FSCRETCD,4                                          0079 00247000
*     END;                          /*                       @Y30LB51*/ 00248000
*   ELSE                            /* SUM TABLE SPACE NOT OBTAINED.    00249000
*                                                            @Y30LB51*/ 00250000
*     FSCRETCD=NOSPACE;             /*                       @Y30LB51*/ 00251000
         B     @RC00056                                            0081 00252000
@RF00056 LA    FSCRETCD,4                                          0081 00253000
*   END GETTBLS;                                                   0082 00254000
@EL00002 DS    0H                                                  0082 00255000
@EF00002 DS    0H                                                  0082 00256000
@ER00002 L     @14,@SA00002                                        0082 00257000
         BR    @14                                                 0082 00258000
*COMPSUM:                                                          0083 00259000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/ 00260000
*                                                                  0083 00261000
COMPSUM  ST    @14,@SA00003                                        0083 00262000
*   /*****************************************************************/ 00263000
*   /*                                                               */ 00264000
*   /* THIS ROUTINE WILL COMPUTE THE TOTAL NUMBER OF RECORDS COUNTED */ 00265000
*   /* FOR EACH SSID.                                                */ 00266000
*   /*                                                               */ 00267000
*   /*****************************************************************/ 00268000
*                                                                  0084 00269000
*   DO WHILE CHNPTR^=0;             /*                       @Y30LB51*/ 00270000
         B     @DE00084                                            0084 00271000
@DL00084 DS    0H                                                  0085 00272000
*     SUMPTR=FREEPTR;               /* SET PTR TO EMPTY SUM TABLE  0085 00273000
*                                      SPACE.                @Y30LB51*/ 00274000
         L     SUMPTR,FREEPTR(,FSCWKPTR)                           0085 00275000
*     SUMSSID=CHNSSIDF;             /* PUT SSID IN TABLE.    @Y30LB51*/ 00276000
         MVC   SUMSSID(2,SUMPTR),CHNSSIDF(CHNPTR)                  0086 00277000
*     SUMFPTR=FSCTPTR;              /* PUT SSID CHAIN ADDRESS IN   0087 00278000
*                                      TABLE.                @Y30LB51*/ 00279000
         L     @10,FSCTPTR(,CHNPTR)                                0087 00280000
         ST    @10,SUMFPTR(,SUMPTR)                                0087 00281000
*     TBLPTR=FSCTPTR;               /* SET PTR TO SSID CHAIN.      0088 00282000
*                                                            @Y30LB51*/ 00283000
         LR    TBLPTR,@10                                          0088 00284000
*     DO WHILE TBLPTR^=0;           /*                       @Y30LB51*/ 00285000
         B     @DE00089                                            0089 00286000
@DL00089 DS    0H                                                  0090 00287000
*       SUMBUILD=SUMBUILD+FSCCTR;   /* ADD FSC COUNT.        @Y30LB51*/ 00288000
         LH    @10,SUMBUILD(,FSCWKPTR)                             0090 00289000
         AH    @10,FSCCTR(,TBLPTR)                                 0090 00290000
         STH   @10,SUMBUILD(,FSCWKPTR)                             0090 00291000
*       SUMSCTR=SUMSCTR+1;          /* COUNT SSIDS ON CHAIN. @Y30LB51*/ 00292000
         LA    @10,1                                               0091 00293000
         AH    @10,SUMSCTR(,SUMPTR)                                0091 00294000
         STH   @10,SUMSCTR(,SUMPTR)                                0091 00295000
*       TBLPTR=FSCSPTR;             /* SET PTR TO NEXT SSID CHAIN  0092 00296000
*                                      ENTRY.                @Y30LB51*/ 00297000
         L     TBLPTR,FSCSPTR(,TBLPTR)                             0092 00298000
*     END;                          /*                       @Y30LB51*/ 00299000
@DE00089 SLR   @10,@10                                             0093 00300000
         CR    TBLPTR,@10                                          0093 00301000
         BNE   @DL00089                                            0093 00302000
*     SUMTOTAL=SUMBUILD;            /* PUT TOTAL IN SUM TABLE.     0094 00303000
*                                                            @Y30LB51*/ 00304000
         MVC   SUMTOTAL(2,SUMPTR),SUMBUILD(FSCWKPTR)               0094 00305000
*     SUMBUILD=0;                   /* RESET SUM WORK AREA.  @Y30LB51*/ 00306000
         STH   @10,SUMBUILD(,FSCWKPTR)                             0095 00307000
*     TBLPTR=FSCTPTR;               /* SET PTR TO SSID CHAIN.      0096 00308000
*                                                            @Y30LB51*/ 00309000
         L     TBLPTR,FSCTPTR(,CHNPTR)                             0096 00310000
*     DO WHILE TBLPTR^=0;           /*                       @Y30LB51*/ 00311000
         B     @DE00097                                            0097 00312000
@DL00097 DS    0H                                                  0098 00313000
*       FSCSUM=SUMTOTAL;            /* PUT SUM IN FSC TABLE. @Y30LB51*/ 00314000
         MVC   FSCSUM(2,TBLPTR),SUMTOTAL(SUMPTR)                   0098 00315000
*       TBLPTR=FSCSPTR;             /* SET PTR TO NEXT SSID CHAIN  0099 00316000
*                                      ENTRY.                @Y30LB51*/ 00317000
         L     TBLPTR,FSCSPTR(,TBLPTR)                             0099 00318000
*     END;                          /*                       @Y30LB51*/ 00319000
@DE00097 LTR   TBLPTR,TBLPTR                                       0100 00320000
         BNZ   @DL00097                                            0100 00321000
*     CALL SUMSORT;                 /* CHAIN SUM TABLE ENTRY.      0101 00322000
*                                                            @Y30LB51*/ 00323000
         BAL   @14,SUMSORT                                         0101 00324000
*     CHNPTR=CHNTPTR;               /* SET PTR TO NEXT CHAIN TABLE 0102 00325000
*                                      ENTRY.                @Y30LB51*/ 00326000
         L     CHNPTR,CHNTPTR(,CHNPTR)                             0102 00327000
*     FREEPTR=FREEPTR+LENGTH(SUMTBL);/* SET PTR TO NEXT FREE ENTRY.     00328000
*                                                            @Y30LB51*/ 00329000
         LA    @10,16                                              0103 00330000
         AL    @10,FREEPTR(,FSCWKPTR)                              0103 00331000
         ST    @10,FREEPTR(,FSCWKPTR)                              0103 00332000
*   END;                            /*                       @Y30LB51*/ 00333000
@DE00084 LTR   CHNPTR,CHNPTR                                       0104 00334000
         BNZ   @DL00084                                            0104 00335000
*   END COMPSUM;                    /*                       @Y30LB51*/ 00336000
@EL00003 DS    0H                                                  0105 00337000
@EF00003 DS    0H                                                  0105 00338000
@ER00003 L     @14,@SA00003                                        0105 00339000
         BR    @14                                                 0105 00340000
*SUMSORT:                                                          0106 00341000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/ 00342000
*                                                                  0106 00343000
SUMSORT  ST    @14,12(,@13)                                        0106 00344000
*   /*****************************************************************/ 00345000
*   /*                                                               */ 00346000
*   /* THIS ROUTINE WILL ADD EACH NEW SUM TABLE ENTRY TO THE SUM     */ 00347000
*   /* CHAIN IN DECENDING ORDER OF MAGNITUDE OF THE CONTENTS OF THE  */ 00348000
*   /* SUMTOTAL FIELD.                                               */ 00349000
*   /*                                                               */ 00350000
*   /*****************************************************************/ 00351000
*                                                                  0107 00352000
*   IF FREEPTR=SUMTABLE THEN        /* IF FIRST ENTRY        @Y30LB51*/ 00353000
         L     @10,FREEPTR(,FSCWKPTR)                              0107 00354000
         C     @10,SUMTABLE(,FSCWKPTR)                             0107 00355000
         BNE   @RF00107                                            0107 00356000
*     SUMSTART=FREEPTR;             /* SET START OF SUM CHAIN PTR. 0108 00357000
*                                                            @Y30LB51*/ 00358000
         ST    @10,SUMSTART(,FSCWKPTR)                             0108 00359000
*   ELSE                            /* NOT FIRST ENTRY.      @Y30LB51*/ 00360000
*     DO;                           /*                       @Y30LB51*/ 00361000
         B     @RC00107                                            0109 00362000
@RF00107 DS    0H                                                  0110 00363000
*       SUMPTR=SUMSTART;            /* SET PTR TO SUM CHAIN START. 0110 00364000
*                                                            @Y30LB51*/ 00365000
         L     SUMPTR,SUMSTART(,FSCWKPTR)                          0110 00366000
*       DO WHILE(SUMPTR^=0)&(FREEPTR->SUMTOTAL<SUMTOTAL);/* SEARCH 0111 00367000
*                                      FOR PLACE IN CHAIN OR END OF     00368000
*                                      CHAIN.                @Y30LB51*/ 00369000
         B     @DE00111                                            0111 00370000
@DL00111 DS    0H                                                  0112 00371000
*         TBLPTRSV=SUMPTR;          /* SAVE ADDRESS CURRENT ENTRY. 0112 00372000
*                                                            @Y30LB51*/ 00373000
         ST    SUMPTR,TBLPTRSV(,FSCWKPTR)                          0112 00374000
*         SUMPTR=SUMTPTR;           /* SET PTR TO NEXT CHAIN ENTRY.     00375000
*                                                            @Y30LB51*/ 00376000
         L     SUMPTR,SUMTPTR(,SUMPTR)                             0113 00377000
*       END;                        /*                       @Y30LB51*/ 00378000
@DE00111 LTR   SUMPTR,SUMPTR                                       0114 00379000
         BZ    @DC00111                                            0114 00380000
         L     @10,FREEPTR(,FSCWKPTR)                              0114 00381000
         LH    @10,SUMTOTAL(,@10)                                  0114 00382000
         CH    @10,SUMTOTAL(,SUMPTR)                               0114 00383000
         BL    @DL00111                                            0114 00384000
@DC00111 DS    0H                                                  0115 00385000
*       IF SUMPTR^=0 THEN           /* POSITION FOUND IN CHAIN,    0115 00386000
*                                                            @Y30LB51*/ 00387000
         LTR   SUMPTR,SUMPTR                                       0115 00388000
         BZ    @RF00115                                            0115 00389000
*         DO;                       /* ADD NEW ENTRY.        @Y30LB51*/ 00390000
*           FREEPTR->SUMTPTR=SUMPTR;/* POINT NEW ENTRY TO OLD ENTRY.    00391000
*                                                            @Y30LB51*/ 00392000
         L     @10,FREEPTR(,FSCWKPTR)                              0117 00393000
         ST    SUMPTR,SUMTPTR(,@10)                                0117 00394000
*           IF FREEPTR->SUMTOTAL>=SUMSTART->SUMTOTAL THEN/* IF NEW 0118 00395000
*                                      ENTRY NOW GREATEST    @Y30LB51*/ 00396000
         L     @01,SUMSTART(,FSCWKPTR)                             0118 00397000
         LH    @00,SUMTOTAL(,@10)                                  0118 00398000
         CH    @00,SUMTOTAL(,@01)                                  0118 00399000
         BL    @RF00118                                            0118 00400000
*             SUMSTART=FREEPTR;     /* SET NEW START OF SUM CHAIN. 0119 00401000
*                                                            @Y30LB51*/ 00402000
         ST    @10,SUMSTART(,FSCWKPTR)                             0119 00403000
*           ELSE                    /* NEW ENTRY NOT GREATEST.     0120 00404000
*                                                            @Y30LB51*/ 00405000
*             TBLPTRSV->SUMTPTR=FREEPTR;/* POINT OLD ENTRY TO NEW  0120 00406000
*                                      ENTRY.                @Y30LB51*/ 00407000
         B     @RC00118                                            0120 00408000
@RF00118 L     @10,TBLPTRSV(,FSCWKPTR)                             0120 00409000
         MVC   SUMTPTR(4,@10),FREEPTR(FSCWKPTR)                    0120 00410000
*         END;                      /*                       @Y30LB51*/ 00411000
*       ELSE                        /* AT END OF CHAIN.      @Y30LB51*/ 00412000
*         TBLPTRSV->SUMTPTR=FREEPTR;/* ADD NEW ENTRY TO CHAIN.     0122 00413000
*                                                            @Y30LB51*/ 00414000
         B     @RC00115                                            0122 00415000
@RF00115 L     @10,TBLPTRSV(,FSCWKPTR)                             0122 00416000
         MVC   SUMTPTR(4,@10),FREEPTR(FSCWKPTR)                    0122 00417000
*     END;                          /*                       @Y30LB51*/ 00418000
*   END SUMSORT;                    /*                       @Y30LB51*/ 00419000
@EL00004 DS    0H                                                  0124 00420000
@EF00004 DS    0H                                                  0124 00421000
@ER00004 L     @14,12(,@13)                                        0124 00422000
         BR    @14                                                 0124 00423000
*COMPPCT:                                                          0125 00424000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/ 00425000
*                                                                  0125 00426000
COMPPCT  ST    @14,12(,@13)                                        0125 00427000
*   /*****************************************************************/ 00428000
*   /*                                                               */ 00429000
*   /* THIS ROUTINE WILL COMPUTE THE PERCENTAGE OF RECORDS COUNTED   */ 00430000
*   /* FOR EACH SSID BY EACH FSC COUNTED WITH THE SSID.              */ 00431000
*   /*                                                               */ 00432000
*   /*****************************************************************/ 00433000
*                                                                  0126 00434000
*   CHNPTR=CHAINTBL;                /* SET PTR TO CHAIN TABLE.     0126 00435000
*                                                            @Y30LB51*/ 00436000
         L     CHNPTR,CHAINTBL(,FSCWKPTR)                          0126 00437000
*   DO WHILE CHNPTR^=0;             /*                       @Y30LB51*/ 00438000
         B     @DE00127                                            0127 00439000
@DL00127 DS    0H                                                  0128 00440000
*     TBLPTR=FSCTPTR;               /* SET PTR TO SSID CHAIN.      0128 00441000
*                                                            @Y30LB51*/ 00442000
         L     TBLPTR,FSCTPTR(,CHNPTR)                             0128 00443000
*     DO WHILE TBLPTR^=0;           /*                       @Y30LB51*/ 00444000
         B     @DE00129                                            0129 00445000
@DL00129 DS    0H                                                  0130 00446000
*       FSCPCT=(FSCCTR*1000)/FSCSUM;/* COMPUT PERCENTAGE.    @Y30LB51*/ 00447000
         LH    @10,FSCCTR(,TBLPTR)                                 0130 00448000
         MH    @10,@CH00313                                        0130 00449000
         LR    @00,@10                                             0130 00450000
         SRDA  @00,32                                              0130 00451000
         LH    @10,FSCSUM(,TBLPTR)                                 0130 00452000
         DR    @00,@10                                             0130 00453000
         STH   @01,FSCPCT(,TBLPTR)                                 0130 00454000
*       TBLPTR=FSCSPTR;             /* SET PTR TO NEXT SSID CHAIN  0131 00455000
*                                      ENTRY.                @Y30LB51*/ 00456000
         L     TBLPTR,FSCSPTR(,TBLPTR)                             0131 00457000
*     END;                          /*                       @Y30LB51*/ 00458000
@DE00129 LTR   TBLPTR,TBLPTR                                       0132 00459000
         BNZ   @DL00129                                            0132 00460000
*     CHNPTR=CHNTPTR;               /* SET PTR TO NEXT CHAIN TABLE 0133 00461000
*                                      ENTRY.                @Y30LB51*/ 00462000
         L     CHNPTR,CHNTPTR(,CHNPTR)                             0133 00463000
*   END;                            /*                       @Y30LB51*/ 00464000
@DE00127 LTR   CHNPTR,CHNPTR                                       0134 00465000
         BNZ   @DL00127                                            0134 00466000
*   END COMPPCT;                    /*                       @Y30LB51*/ 00467000
@EL00005 DS    0H                                                  0135 00468000
@EF00005 DS    0H                                                  0135 00469000
@ER00005 L     @14,12(,@13)                                        0135 00470000
         BR    @14                                                 0135 00471000
*PREPPRNT:                                                         0136 00472000
*   PROC OPTIONS(SAVE(14));         /*                       @Y30LB51*/ 00473000
*                                                                  0136 00474000
PREPPRNT ST    @14,12(,@13)                                        0136 00475000
*   /*****************************************************************/ 00476000
*   /*                                                               */ 00477000
*   /* THIS ROUTINE WILL PREPARE THE PRINT TABLE.                    */ 00478000
*   /*                                                               */ 00479000
*   /*****************************************************************/ 00480000
*                                                                  0137 00481000
*   PRTPTR=PRINTTBL;                /* SET PTR TO PRINT TABLE.     0137 00482000
*                                                            @Y30LB51*/ 00483000
         L     PRTPTR,PRINTTBL(,FSCWKPTR)                          0137 00484000
*   SUMPTR=SUMSTART;                /* SET PTR TO SUM CHAIN. @Y30LB51*/ 00485000
         L     SUMPTR,SUMSTART(,FSCWKPTR)                          0138 00486000
*   DO WHILE SUMPTR^=0;             /*                       @Y30LB51*/ 00487000
         B     @DE00139                                            0139 00488000
@DL00139 DS    0H                                                  0140 00489000
*     TBLPTR=SUMFPTR;               /* SET PTR TO SSID CHAIN START.     00490000
*                                                            @Y30LB51*/ 00491000
         L     TBLPTR,SUMFPTR(,SUMPTR)                             0140 00492000
*     DO WHILE SUMPCTR<SUMSCTR;     /*                       @Y30LB51*/ 00493000
         B     @DE00141                                            0141 00494000
@DL00141 DS    0H                                                  0142 00495000
*       FREEPTR=FSCSPTR;            /* SET PTR TO NEXT CHAIN ENTRY.     00496000
*                                                            @Y30LB51*/ 00497000
         MVC   FREEPTR(4,FSCWKPTR),FSCSPTR(TBLPTR)                 0142 00498000
*       DO WHILE FREEPTR^=0;        /*                       @Y30LB51*/ 00499000
         B     @DE00143                                            0143 00500000
@DL00143 DS    0H                                                  0144 00501000
*         IF FREEPTR->INPRTTBL='0'B THEN/* IF ENTRY NOT IN TABLE   0144 00502000
*                                                            @Y30LB51*/ 00503000
         L     @10,FREEPTR(,FSCWKPTR)                              0144 00504000
         TM    INPRTTBL(@10),B'00000001'                           0144 00505000
         BNZ   @RF00144                                            0144 00506000
*           DO;                     /* CHECK FOR GREATER ENTRY.    0145 00507000
*                                                            @Y30LB51*/ 00508000
*             IF FREEPTR->FSCCTR>TBLPTR->FSCCTR THEN/* IF THIS ENTRY    00509000
*                                      GREATER               @Y30LB51*/ 00510000
         LH    @15,FSCCTR(,@10)                                    0146 00511000
         CH    @15,FSCCTR(,TBLPTR)                                 0146 00512000
         BNH   @RF00146                                            0146 00513000
*               TBLPTR=FREEPTR;     /* SET PTR TO IT.        @Y30LB51*/ 00514000
         LR    TBLPTR,@10                                          0147 00515000
*             ELSE                                                 0148 00516000
*               ;                   /* NOT GREATER.          @Y30LB51*/ 00517000
@RF00146 DS    0H                                                  0149 00518000
*           END;                    /*                       @Y30LB51*/ 00519000
*         ELSE                                                     0150 00520000
*           ;                       /* ENTRY ALREADY IN PRINT TABLE.    00521000
*                                                            @Y30LB51*/ 00522000
@RF00144 DS    0H                                                  0151 00523000
*         FREEPTR=FREEPTR->FSCSPTR; /* SET WORK POINTER TO NEXT SSID    00524000
*                                      CHAIN ENTRY.          @Y30LB51*/ 00525000
         L     @10,FREEPTR(,FSCWKPTR)                              0151 00526000
         L     @10,FSCSPTR(,@10)                                   0151 00527000
         ST    @10,FREEPTR(,FSCWKPTR)                              0151 00528000
*       END;                        /*                       @Y30LB51*/ 00529000
@DE00143 ICM   @10,15,FREEPTR(FSCWKPTR)                            0152 00530000
         BNZ   @DL00143                                            0152 00531000
*       PRTTPTR=TBLPTR;             /* PUT FSC TABLE ENTRY ADDRESS IN   00532000
*                                      PRINT TABLE.          @Y30LB51*/ 00533000
         ST    TBLPTR,PRTTPTR(,PRTPTR)                             0153 00534000
*       PRTPTR=PRTPTR+4;            /* SET PTR TO NEXT ENTRY.      0154 00535000
*                                                            @Y30LB51*/ 00536000
         AH    PRTPTR,@CH00105                                     0154 00537000
*       SUMPCTR=SUMPCTR+1;          /* COUNT ENTRIES PROCESSED.    0155 00538000
*                                                            @Y30LB51*/ 00539000
         LA    @10,1                                               0155 00540000
         AH    @10,SUMPCTR(,SUMPTR)                                0155 00541000
         STH   @10,SUMPCTR(,SUMPTR)                                0155 00542000
*       TBLPTR->INPRTTBL='1'B;      /* SET 'IN TABLE' FLAG.  @Y30LB51*/ 00543000
         OI    INPRTTBL(TBLPTR),B'00000001'                        0156 00544000
*       TBLPTR=SUMFPTR;             /* SET PTR TO SSID CHAIN.      0157 00545000
*                                                            @Y30LB51*/ 00546000
         L     TBLPTR,SUMFPTR(,SUMPTR)                             0157 00547000
*       DO WHILE INPRTTBL='1'B&TBLPTR^=0;/* SEARCH FOR UNPROCESSED 0158 00548000
*                                      SSID CHAIN ENTRY, IF ANY.   0158 00549000
*                                                            @ZA00693*/ 00550000
         B     @DE00158                                            0158 00551000
@DL00158 DS    0H                                                  0159 00552000
*         TBLPTR=FSCSPTR;           /* SET PTR TO NEXT SSID CHAIN  0159 00553000
*                                      ENTRY.                @Y30LB51*/ 00554000
         L     TBLPTR,FSCSPTR(,TBLPTR)                             0159 00555000
*       END;                        /*                       @Y30LB51*/ 00556000
@DE00158 TM    INPRTTBL(TBLPTR),B'00000001'                        0160 00557000
         BNO   @DC00158                                            0160 00558000
         LTR   TBLPTR,TBLPTR                                       0160 00559000
         BNZ   @DL00158                                            0160 00560000
@DC00158 DS    0H                                                  0161 00561000
*     END;                          /*                       @Y30LB51*/ 00562000
@DE00141 LH    @10,SUMPCTR(,SUMPTR)                                0161 00563000
         CH    @10,SUMSCTR(,SUMPTR)                                0161 00564000
         BL    @DL00141                                            0161 00565000
*     SUMPTR=SUMTPTR;               /* SET PTR TO NEXT SUM CHAIN   0162 00566000
*                                      ENTRY.                @Y30LB51*/ 00567000
         L     SUMPTR,SUMTPTR(,SUMPTR)                             0162 00568000
*   END;                            /*                       @Y30LB51*/ 00569000
@DE00139 LTR   SUMPTR,SUMPTR                                       0163 00570000
         BNZ   @DL00139                                            0163 00571000
*   END PREPPRNT;                   /*                       @Y30LB51*/ 00572000
@EL00006 DS    0H                                                  0164 00573000
@EF00006 DS    0H                                                  0164 00574000
@ER00006 L     @14,12(,@13)                                        0164 00575000
         BR    @14                                                 0164 00576000
*FREECORE:                                                         0165 00577000
*   PROC OPTIONS(SAVE(14));         /* Y30LB51                       */ 00578000
*                                                                  0165 00579000
FREECORE ST    @14,@SA00007                                        0165 00580000
*   /*****************************************************************/ 00581000
*   /*                                                               */ 00582000
*   /* THIS ROUTINE WILL FREE ALL GOTTEN CORE VIA THE ISDAFREE       */ 00583000
*   /* ROUTINE.                                                      */ 00584000
*   /*                                                               */ 00585000
*   /*****************************************************************/ 00586000
*                                                                  0166 00587000
*   SPNO='04'X;                     /* GET THE SUBPOOL NUMBER.     0166 00588000
*                                                            @YM32169*/ 00589000
         MVI   SPNO(CVTPTR),X'04'                                  0166 00590000
*   IF PRINTTBL^=0 THEN             /* IF PRINT TABLE EXISTS @Y30LB51*/ 00591000
         L     @10,PRINTTBL(,FSCWKPTR)                             0167 00592000
         LTR   @10,@10                                             0167 00593000
         BZ    @RF00167                                            0167 00594000
*     DO;                           /* FREE IT.              @Y30LB51*/ 00595000
*       CORELEN=LENGTH(PRTTBL)*TBLELMCT;/* GET PRINT TABLE LENGTH  0169 00596000
*                                                            @Y30LB51*/ 00597000
         LH    @06,TBLELMCT(,FSCWKPTR)                             0169 00598000
         SLA   @06,2                                               0169 00599000
         STCM  @06,7,CORELEN(CVTPTR)                               0169 00600000
*       COREADDR=PRINTTBL;          /* AND ADDRESS           @Y30LB51*/ 00601000
         ST    @10,COREADDR(,CVTPTR)                               0170 00602000
*       CALL ISDAFREE(WORKPTR);     /* AND FREE IT.          @Y30LB51*/ 00603000
         L     @10,@PC00001                                        0171 00604000
         ST    @10,@AL00001                                        0171 00605000
         L     @15,@CV00289                                        0171 00606000
         LA    @01,@AL00001                                        0171 00607000
         BALR  @14,@15                                             0171 00608000
*     END;                          /*                       @Y30LB51*/ 00609000
*   ELSE                                                           0173 00610000
*     ;                             /* PRINT TABLE DOES NOT EXIST. 0173 00611000
*                                                            @Y30LB51*/ 00612000
@RF00167 DS    0H                                                  0174 00613000
*   IF SUMTABLE^=0 THEN             /* IF SUM TABLE EXISTS   @Y30LB51*/ 00614000
         L     @10,SUMTABLE(,FSCWKPTR)                             0174 00615000
         LTR   @10,@10                                             0174 00616000
         BZ    @RF00174                                            0174 00617000
*     DO;                           /* FREE IT.              @Y30LB51*/ 00618000
*       CORELEN=LENGTH(SUMTBL)*SSIDCTR;/* GET SUM TABLE LENGTH     0176 00619000
*                                                            @Y30LB51*/ 00620000
         LH    @06,SSIDCTR(,FSCWKPTR)                              0176 00621000
         SLA   @06,4                                               0176 00622000
         STCM  @06,7,CORELEN(CVTPTR)                               0176 00623000
*       COREADDR=SUMTABLE;          /* AND ADDRESS           @Y30LB51*/ 00624000
         ST    @10,COREADDR(,CVTPTR)                               0177 00625000
*       CALL ISDAFREE(WORKPTR);     /* AND FREE IT.          @Y30LB51*/ 00626000
         L     @10,@PC00001                                        0178 00627000
         ST    @10,@AL00001                                        0178 00628000
         L     @15,@CV00289                                        0178 00629000
         LA    @01,@AL00001                                        0178 00630000
         BALR  @14,@15                                             0178 00631000
*     END;                          /*                       @Y30LB51*/ 00632000
*   ELSE                                                           0180 00633000
*     ;                             /* SUM TABLE DOES NOT EXIST.   0180 00634000
*                                                            @Y30LB51*/ 00635000
@RF00174 DS    0H                                                  0181 00636000
*   DO WHILE GET0PTR^=0;            /* FREE EXISTING FSC TABLES.   0181 00637000
*                                                            @Y30LB51*/ 00638000
         B     @DE00181                                            0181 00639000
@DL00181 DS    0H                                                  0182 00640000
*     SPNOLEN=GET0SPLN;             /* GET FSC TABLE LENGTH. @Y30LB51*/ 00641000
         L     @10,GET0PTR(,FSCWKPTR)                              0182 00642000
         MVC   SPNOLEN(4,CVTPTR),GET0SPLN(@10)                     0182 00643000
*     COREADDR=GET0PTR;             /* GET ADDRESS OF LAST TABLE ON     00644000
*                                      CHAIN.                @Y30LB51*/ 00645000
         ST    @10,COREADDR(,CVTPTR)                               0183 00646000
*     GET0PTR=LASTPTR;              /* GET ADDRESS PRECEDING FSC   0184 00647000
*                                      TABLE.                @Y30LB51*/ 00648000
         L     @10,LASTPTR(,@10)                                   0184 00649000
         ST    @10,GET0PTR(,FSCWKPTR)                              0184 00650000
*     CALL ISDAFREE(WORKPTR);       /* FREE LAST FSC TABLE.  @Y30LB51*/ 00651000
         L     @10,@PC00001                                        0185 00652000
         ST    @10,@AL00001                                        0185 00653000
         L     @15,@CV00289                                        0185 00654000
         LA    @01,@AL00001                                        0185 00655000
         BALR  @14,@15                                             0185 00656000
*   END;                            /*                       @YE0LB51*/ 00657000
@DE00181 SLR   @10,@10                                             0186 00658000
         C     @10,GET0PTR(,FSCWKPTR)                              0186 00659000
         BNE   @DL00181                                            0186 00660000
*   IF CHAINTBL^=0 THEN             /* IF CHAIN TABLE EXISTS @Y30LB51*/ 00661000
         L     @06,CHAINTBL(,FSCWKPTR)                             0187 00662000
         CR    @06,@10                                             0187 00663000
         BE    @RF00187                                            0187 00664000
*     DO;                           /* FREE IT.              @Y30LB51*/ 00665000
*       CORELEN=LENGTH(CHNTBL)*SSIDCT;/* GET CHAIN TABLE LENGTH    0189 00666000
*                                                            @Y30LB51*/ 00667000
         LH    @10,SSIDCT(,FSCWKPTR)                               0189 00668000
         MH    @10,@CH00119                                        0189 00669000
         STCM  @10,7,CORELEN(CVTPTR)                               0189 00670000
*       COREADDR=CHAINTBL;          /* AND ADDRESS           @Y30LB51*/ 00671000
         ST    @06,COREADDR(,CVTPTR)                               0190 00672000
*       CALL ISDAFREE(WORKPTR);     /* AND FREE IT.          @Y30LB51*/ 00673000
         L     @10,@PC00001                                        0191 00674000
         ST    @10,@AL00001                                        0191 00675000
         L     @15,@CV00289                                        0191 00676000
         LA    @01,@AL00001                                        0191 00677000
         BALR  @14,@15                                             0191 00678000
*     END;                          /*                       @Y30LB51*/ 00679000
*   ELSE                                                           0193 00680000
*     ;                             /* CHAIN TABLE DOES NOT EXIST. 0193 00681000
*                                                            @Y30LB51*/ 00682000
@RF00187 DS    0H                                                  0194 00683000
*   IF FSC00PTR^=0 THEN             /* IF WORK AREA EXISTS   @Y30LB51*/ 00684000
         L     @10,FSC00PTR(,CVTPTR)                               0194 00685000
         LTR   @10,@10                                             0194 00686000
         BZ    @RF00194                                            0194 00687000
*     DO;                           /* FREE IT.              @Y30LB51*/ 00688000
*       CORELEN=LENGTH(FSCWORK);    /* GET WORK AREA LENGTH  @Y30LB51*/ 00689000
         MVC   CORELEN(3,CVTPTR),@CF00322+1                        0196 00690000
*       COREADDR=FSC00PTR;          /* AND ADDRESS           @Y30LB51*/ 00691000
         ST    @10,COREADDR(,CVTPTR)                               0197 00692000
*       CALL ISDAFREE(WORKPTR);     /* AND FREE IT.          @Y30LB51*/ 00693000
         L     @10,@PC00001                                        0198 00694000
         ST    @10,@AL00001                                        0198 00695000
         L     @15,@CV00289                                        0198 00696000
         LA    @01,@AL00001                                        0198 00697000
         BALR  @14,@15                                             0198 00698000
*     END;                          /* Y30LB51                       */ 00699000
*   ELSE                                                           0200 00700000
*     ;                             /* WORK AREA DOES NOT EXIST.   0200 00701000
*                                                            @Y30LB51*/ 00702000
@RF00194 DS    0H                                                  0201 00703000
*   CFSC='00'X;                     /* SET 'DO NOT CALL' SWITCH.   0201 00704000
*                                                            @Y30LB51*/ 00705000
         MVI   CFSC(LPARMPTR),X'00'                                0201 00706000
*   FSC00PTR=0;                     /* ZERO WORK AREA ADDRESS.     0202 00707000
*                                                            @Y30LB51*/ 00708000
         SLR   @10,@10                                             0202 00709000
         ST    @10,FSC00PTR(,CVTPTR)                               0202 00710000
*   END FREECORE;                   /*                       @Y30LB51*/ 00711000
@EL00007 DS    0H                                                  0203 00712000
@EF00007 DS    0H                                                  0203 00713000
@ER00007 L     @14,@SA00007                                        0203 00714000
         BR    @14                                                 0203 00715000
*   END ISDAFSC2                    /*                       @Y30LB51*/ 00716000
*                                                                  0204 00717000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 00718000
*/*%INCLUDE SYSLIB  (ISDACVT )                                       */ 00719000
*/*%INCLUDE SYSLIB  (ISDAPRMS)                                       */ 00720000
*/*%INCLUDE SYSLIB  (ISDAGHDR)                                       */ 00721000
*/*%INCLUDE SYSLIB  (ISDAFSC5)                                       */ 00722000
*                                                                  0204 00723000
*       ;                                                          0204 00724000
@DATA    DS    0H                                                       00725000
@CH00105 DC    H'4'                                                     00726000
@CH00119 DC    H'12'                                                    00727000
@CH00172 DC    H'16'                                                    00728000
@CH00313 DC    H'1000'                                                  00729000
@DATD    DSECT                                                          00730000
         DS    0F                                                       00731000
@SA00001 DS    18F                                                      00732000
@PC00001 DS    1F                                                       00733000
@SA00003 DS    1F                                                       00734000
@SA00007 DS    0F                                                       00735000
@SA00002 DS    0F                                                       00736000
         DS    1F                                                       00737000
@AL00001 DS    1A                                                       00738000
ISDAFSC2 CSECT                                                          00739000
         DS    0F                                                       00740000
@CF00322 DC    F'84'                                                    00741000
@DATD    DSECT                                                          00742000
         DS    0D                                                       00743000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                00744000
@ENDDATD EQU   *                                                        00745000
ISDAFSC2 CSECT                                                          00746000
         NOPR  ((@ENDDATD-@DATD)/161*16)                                00747000
         DS    0F                                                       00748000
@SIZDATD DC    AL1(0)                                                   00749000
         DC    AL3(@ENDDATD-@DATD)                                      00750000
@CV00288 DC    V(ISDAGET1)                                              00751000
@CV00289 DC    V(ISDAFREE)                                              00752000
@CV00287 DC    V(ISDAGET0)                                              00753000
         DS    0D                                                       00754000
PATCH    DS    CL50                                                     00755000
         ORG   PATCH                                                    00756000
@NM00010 DC    50X'00'                                                  00757000
         ORG   PATCH+50                                                 00758000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       00759000
@01      EQU   01                                                       00760000
@02      EQU   02                                                       00761000
@03      EQU   03                                                       00762000
@04      EQU   04                                                       00763000
@05      EQU   05                                                       00764000
@06      EQU   06                                                       00765000
@07      EQU   07                                                       00766000
@08      EQU   08                                                       00767000
@09      EQU   09                                                       00768000
@10      EQU   10                                                       00769000
@11      EQU   11                                                       00770000
@12      EQU   12                                                       00771000
@13      EQU   13                                                       00772000
@14      EQU   14                                                       00773000
@15      EQU   15                                                       00774000
FSCRETCD EQU   @07                                                      00775000
PRTPTR   EQU   @06                                                      00776000
SUMPTR   EQU   @05                                                      00777000
CHNPTR   EQU   @06                                                      00778000
TBLPTR   EQU   @04                                                      00779000
FSCWKPTR EQU   @03                                                      00780000
LPARMPTR EQU   @04                                                      00781000
CVTPTR   EQU   @02                                                      00782000
RF       EQU   @15                                                      00783000
ISDACVT  EQU   0                                                        00784000
CVTPTRS0 EQU   ISDACVT                                                  00785000
PARMPTR  EQU   CVTPTRS0+8                                               00786000
FSC00PTR EQU   CVTPTRS0+56                                              00787000
GET0CALL EQU   ISDACVT+100                                              00788000
SPNOLEN  EQU   GET0CALL                                                 00789000
SPNO     EQU   SPNOLEN                                                  00790000
CORELEN  EQU   SPNOLEN+1                                                00791000
COREADDR EQU   GET0CALL+4                                               00792000
HEXPCALL EQU   ISDACVT+108                                              00793000
PRT0CALL EQU   ISDACVT+120                                              00794000
OUTLINE  EQU   PRT0CALL                                                 00795000
SDADATD  EQU   ISDACVT+256                                              00796000
PRTDATD  EQU   ISDACVT+416                                              00797000
ISDAPRMS EQU   0                                                        00798000
CINPUT   EQU   ISDAPRMS                                                 00799000
CSTART   EQU   ISDAPRMS+2                                               00800000
CEND     EQU   ISDAPRMS+6                                               00801000
CFSCONLY EQU   ISDAPRMS+13                                              00802000
CSSIDF   EQU   ISDAPRMS+17                                              00803000
CSERIAL  EQU   ISDAPRMS+21                                              00804000
CREPORTS EQU   ISDAPRMS+33                                              00805000
CFSC     EQU   CREPORTS+4                                               00806000
ISDAGHDR EQU   0                                                        00807000
STARTPTR EQU   ISDAGHDR                                                 00808000
GET0SPLN EQU   ISDAGHDR+8                                               00809000
LASTPTR  EQU   ISDAGHDR+16                                              00810000
FSCWORK  EQU   0                                                        00811000
GET0PTR  EQU   FSCWORK                                                  00812000
FSCPTR   EQU   FSCWORK+8                                                00813000
FREEPTR  EQU   FSCWORK+20                                               00814000
SUMTABLE EQU   FSCWORK+24                                               00815000
SUMSTART EQU   FSCWORK+28                                               00816000
CHAINTBL EQU   FSCWORK+32                                               00817000
PRINTTBL EQU   FSCWORK+36                                               00818000
TBLPTRSV EQU   FSCWORK+40                                               00819000
SSIDCT   EQU   FSCWORK+46                                               00820000
SSIDCTR  EQU   FSCWORK+48                                               00821000
TBLELMCT EQU   FSCWORK+50                                               00822000
I        EQU   FSCWORK+52                                               00823000
WORKFLGS EQU   FSCWORK+54                                               00824000
SSIDSAVE EQU   FSCWORK+66                                               00825000
SUMBUILD EQU   FSCWORK+78                                               00826000
DEVBYTES EQU   FSCWORK+82                                               00827000
FSCTBL   EQU   0                                                        00828000
FSCSPTR  EQU   FSCTBL                                                   00829000
FSCSSID  EQU   FSCTBL+4                                                 00830000
FSCFSC   EQU   FSCTBL+8                                                 00831000
FSCDT    EQU   FSCTBL+12                                                00832000
FSCDATE  EQU   FSCDT                                                    00833000
FSCTIME  EQU   FSCDT+4                                                  00834000
FSCCTR   EQU   FSCTBL+20                                                00835000
FSCSUM   EQU   FSCTBL+22                                                00836000
FSCPCT   EQU   FSCTBL+24                                                00837000
FSCFLAGS EQU   FSCTBL+26                                                00838000
INPRTTBL EQU   FSCFLAGS+1                                               00839000
FSCDEVS  EQU   FSCTBL+28                                                00840000
CHNTBL   EQU   0                                                        00841000
CHNTPTR  EQU   CHNTBL                                                   00842000
CHNSSIDF EQU   CHNTBL+4                                                 00843000
FSCTPTR  EQU   CHNTBL+8                                                 00844000
SUMTBL   EQU   0                                                        00845000
SUMTPTR  EQU   SUMTBL                                                   00846000
SUMSSID  EQU   SUMTBL+4                                                 00847000
SUMTOTAL EQU   SUMTBL+6                                                 00848000
SUMFPTR  EQU   SUMTBL+8                                                 00849000
SUMSCTR  EQU   SUMTBL+12                                                00850000
SUMPCTR  EQU   SUMTBL+14                                                00851000
PRTTBL   EQU   0                                                        00852000
PRTTPTR  EQU   PRTTBL                                                   00853000
WORKPTR  EQU   0                                                        00854000
*                                      START UNREFERENCED COMPONENTS    00855000
@NM00009 EQU   CHNTBL+6                                                 00856000
CHNSSID  EQU   CHNSSIDF                                                 00857000
SSIDFLGS EQU   CHNSSIDF                                                 00858000
DEVHCTR  EQU   FSCDEVS+14                                               00859000
DEVGCTR  EQU   FSCDEVS+12                                               00860000
DEVFCTR  EQU   FSCDEVS+10                                               00861000
DEVECTR  EQU   FSCDEVS+8                                                00862000
DEVDCTR  EQU   FSCDEVS+6                                                00863000
DEVCCTR  EQU   FSCDEVS+4                                                00864000
DEVBCTR  EQU   FSCDEVS+2                                                00865000
DEVACTR  EQU   FSCDEVS                                                  00866000
@NM00008 EQU   FSCFLAGS+1                                               00867000
FSCAPR   EQU   FSCFLAGS+1                                               00868000
FAKEFSC  EQU   FSCFLAGS+1                                               00869000
VIRTDASD EQU   FSCFLAGS+1                                               00870000
REALDASD EQU   FSCFLAGS+1                                               00871000
DASDFLAG EQU   FSCFLAGS                                                 00872000
DAFLAG   EQU   FSCFLAGS                                                 00873000
DIRFLAG  EQU   FSCFLAGS                                                 00874000
CSFLAG   EQU   FSCFLAGS                                                 00875000
DRDFLAG  EQU   FSCFLAGS                                                 00876000
DRCFLAG  EQU   FSCFLAGS                                                 00877000
SAFLAG   EQU   FSCFLAGS                                                 00878000
MSCFLAG  EQU   FSCFLAGS                                                 00879000
FSCHSEC  EQU   FSCTIME+3                                                00880000
FSCSEC   EQU   FSCTIME+2                                                00881000
FSCMIN   EQU   FSCTIME+1                                                00882000
FSCHR    EQU   FSCTIME                                                  00883000
FSCDAY   EQU   FSCDATE+2                                                00884000
FSCYR    EQU   FSCDATE                                                  00885000
CNTLUNIT EQU   FSCFSC+3                                                 00886000
@NM00007 EQU   FSCFSC+2                                                 00887000
FSCSYS   EQU   FSCFSC                                                   00888000
@NM00006 EQU   FSCSSID+2                                                00889000
UNITCHAR EQU   FSCSSID+1                                                00890000
DEVCHAR  EQU   FSCSSID                                                  00891000
DEVBYTEB EQU   DEVBYTES+1                                               00892000
DEVBYTEA EQU   DEVBYTES                                                 00893000
LINECT   EQU   FSCWORK+80                                               00894000
FSCSAVE2 EQU   FSCWORK+74                                               00895000
FSCSAVE1 EQU   FSCWORK+70                                               00896000
FSCSYSSV EQU   FSCWORK+68                                               00897000
@NM00005 EQU   SSIDSAVE+1                                               00898000
SSIDDEV  EQU   SSIDSAVE                                                 00899000
CUAFLAG  EQU   SSIDSAVE                                                 00900000
LTYPE    EQU   FSCWORK+64                                               00901000
LFSCSYS  EQU   FSCWORK+62                                               00902000
LFSC     EQU   FSCWORK+58                                               00903000
LSSID    EQU   FSCWORK+56                                               00904000
ADDCORE  EQU   WORKFLGS+1                                               00905000
@NM00004 EQU   WORKFLGS+1                                               00906000
WORKAPR  EQU   WORKFLGS+1                                               00907000
FSCCOUNT EQU   WORKFLGS+1                                               00908000
FMT3ACC2 EQU   WORKFLGS+1                                               00909000
FMT3ACC1 EQU   WORKFLGS+1                                               00910000
DASDREC  EQU   WORKFLGS                                                 00911000
DAREC    EQU   WORKFLGS                                                 00912000
DIRREC   EQU   WORKFLGS                                                 00913000
CSREC    EQU   WORKFLGS                                                 00914000
DRDREC   EQU   WORKFLGS                                                 00915000
DRCREC   EQU   WORKFLGS                                                 00916000
SAREC    EQU   WORKFLGS                                                 00917000
MSCREC   EQU   WORKFLGS                                                 00918000
FSCTBLCT EQU   FSCWORK+44                                               00919000
SENSEPTR EQU   FSCWORK+16                                               00920000
LOGPTR   EQU   FSCWORK+12                                               00921000
PTRSAVE  EQU   FSCWORK+4                                                00922000
@NM00003 EQU   ISDAGHDR+26                                              00923000
BLOCKCNT EQU   ISDAGHDR+24                                              00924000
BLOCKID  EQU   ISDAGHDR+20                                              00925000
NEXTPTR  EQU   ISDAGHDR+12                                              00926000
GET0LEN  EQU   GET0SPLN+1                                               00927000
GET0SPNO EQU   GET0SPLN                                                 00928000
ENDPTR   EQU   ISDAGHDR+4                                               00929000
CTRACE   EQU   ISDAPRMS+48                                              00930000
CGEN     EQU   ISDAPRMS+47                                              00931000
CDETAIL  EQU   ISDAPRMS+46                                              00932000
CPERIOD  EQU   ISDAPRMS+45                                              00933000
CPWR     EQU   CREPORTS+11                                              00934000
CAPRSUU  EQU   CREPORTS+10                                              00935000
CDRC     EQU   CREPORTS+9                                               00936000
CDAT     EQU   CREPORTS+8                                               00937000
CCSBCSF  EQU   CREPORTS+7                                               00938000
CDCKTLX  EQU   CREPORTS+6                                               00939000
CEQC     EQU   CREPORTS+5                                               00940000
CDHEDHU  EQU   CREPORTS+3                                               00941000
CSUM     EQU   CREPORTS+2                                               00942000
CPAD     EQU   CREPORTS+1                                               00943000
CDCS     EQU   CREPORTS                                                 00944000
CSERNO   EQU   CSERIAL+4                                                00945000
@NM00002 EQU   CSERIAL+3                                                00946000
CIBM     EQU   CSERIAL                                                  00947000
CRATIO   EQU   ISDAPRMS+19                                              00948000
CSSID    EQU   CSSIDF                                                   00949000
@NM00001 EQU   CSSIDF                                                   00950000
CFSC34   EQU   CFSCONLY+2                                               00951000
CFSC12   EQU   CFSCONLY                                                 00952000
CTYPE    EQU   ISDAPRMS+11                                              00953000
CSUMMARY EQU   ISDAPRMS+10                                              00954000
CENDDAY  EQU   CEND+2                                                   00955000
CENDYEAR EQU   CEND                                                     00956000
CSTDAY   EQU   CSTART+2                                                 00957000
CSTYEAR  EQU   CSTART                                                   00958000
CHISTIN  EQU   CINPUT+1                                                 00959000
CLOGIN   EQU   CINPUT                                                   00960000
PRTSA001 EQU   PRTDATD                                                  00961000
SDATEMPS EQU   SDADATD+136                                              00962000
SDASA002 EQU   SDADATD+76                                               00963000
SDAPC001 EQU   SDADATD+72                                               00964000
SDASA001 EQU   SDADATD                                                  00965000
SDARPTID EQU   PRT0CALL+133                                             00966000
LINE     EQU   OUTLINE+1                                                00967000
ANSI     EQU   OUTLINE                                                  00968000
DUMPIDNO EQU   HEXPCALL+8                                               00969000
DUMPLEN  EQU   HEXPCALL+4                                               00970000
DUMPADDR EQU   HEXPCALL                                                 00971000
WORKCALL EQU   CVTPTRS0+96                                              00972000
GEN00PTR EQU   CVTPTRS0+92                                              00973000
CNFG0PTR EQU   CVTPTRS0+88                                              00974000
PWR00PTR EQU   CVTPTRS0+84                                              00975000
APR00PTR EQU   CVTPTRS0+80                                              00976000
DRC00PTR EQU   CVTPTRS0+76                                              00977000
DAT00PTR EQU   CVTPTRS0+72                                              00978000
CSB00PTR EQU   CVTPTRS0+68                                              00979000
DCK00PTR EQU   CVTPTRS0+64                                              00980000
EQC00PTR EQU   CVTPTRS0+60                                              00981000
DHE00PTR EQU   CVTPTRS0+52                                              00982000
SUM00PTR EQU   CVTPTRS0+48                                              00983000
PAD00PTR EQU   CVTPTRS0+44                                              00984000
DCS00PTR EQU   CVTPTRS0+40                                              00985000
LOG00PTR EQU   CVTPTRS0+36                                              00986000
HIST0PTR EQU   CVTPTRS0+32                                              00987000
PRT00PTR EQU   CVTPTRS0+28                                              00988000
GET00PTR EQU   CVTPTRS0+24                                              00989000
TYPE0PTR EQU   CVTPTRS0+20                                              00990000
PARM0PTR EQU   CVTPTRS0+16                                              00991000
SDA00PTR EQU   CVTPTRS0+12                                              00992000
SDATAPTR EQU   CVTPTRS0+4                                               00993000
DATAPTR  EQU   CVTPTRS0                                                 00994000
*                                      END UNREFERENCED COMPONENTS      00995000
@RC00023 EQU   @RC00020                                                 00996000
@RC00056 EQU   @EL00002                                                 00997000
@RC00107 EQU   @EL00004                                                 00998000
@RC00115 EQU   @EL00004                                                 00999000
@RC00026 EQU   @RC00023                                                 01000000
@RC00070 EQU   @RC00056                                                 01001000
@RC00118 EQU   @RC00115                                                 01002000
@ENDDATA EQU   *                                                        01003000
         END   ISDAFSC2,(C'PLS2115',0603,75267)                         01004000
