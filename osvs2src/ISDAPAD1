         TITLE 'PAD REPORT FORMATTER                                   *00001000
                        '                                               00002000
ISDAPAD1 CSECT ,                                                01S0001 00003000
@MAINENT DS    0H                                               01S0001 00004000
         USING *,@15                                            01S0001 00005000
         B     @PROLOG                                          01S0001 00006000
         DC    AL1(8)                                           01S0001 00007000
         DC    C'ISDAPAD1'                                      01S0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                  01S0001 00010000
         BALR  @10,0                                            01S0001 00011000
@PSTART  LA    @11,4095(,@10)                                   01S0001 00012000
         LA    @12,4095(,@11)                                   01S0001 00013000
         USING @PSTART,@10                                      01S0001 00014000
         USING @PSTART+4095,@11                                 01S0001 00015000
         USING @PSTART+8190,@12                                 01S0001 00016000
         L     @00,@SIZDATD                                     01S0001 00017000
         GETMAIN  R,LV=(0)                                              00018000
         LR    @09,@01                                          01S0001 00019000
         USING @DATD,@09                                        01S0001 00020000
         ST    @13,@SA00001+4                                   01S0001 00021000
         LM    @00,@01,20(@13)                                  01S0001 00022000
         ST    @09,8(,@13)                                      01S0001 00023000
         LR    @13,@09                                          01S0001 00024000
         MVC   @PC00001(4),0(@01)                               01S0001 00025000
*/* %SDACVTL='LENGTH(ISDACVT)'                               @Y30LB55*/ 00026000
*/*   DCL CVTPTR PTR(31)  AND SET CVTPTR=WORKPTR             @Y30LB55*/ 00027000
*                                                               01S0006 00028000
*                                                               01S0006 00029000
*   /*****************************************************************/ 00030000
*   /*                                                               */ 00031000
*   /* THIS CODE GENERATES THE MSC/SA INTERFACE ARRAY FOR THE ERRORS */ 00032000
*   /* RECORDED IN THE DRC/DRD PATHS.                                */ 00033000
*   /*                                                               */ 00034000
*   /*****************************************************************/ 00035000
*                                                               01S0006 00036000
*   CVTPTR=WORKPTR;                 /* SET CVTPTR BASE       @Y30LB52*/ 00037000
         L     @08,@PC00001                                     01S0006 00038000
         L     CVTPTR,WORKPTR(,@08)                             01S0006 00039000
*   FLAGS='00'X;                    /* CLEAR THE FLAGS       @Y30LB52*/ 00040000
         MVI   FLAGS,X'00'                                      01S0007 00041000
*                                                               02S0008 00042000
*   /*****************************************************************/ 00043000
*   /*                                                               */ 00044000
*   /* THIS SEGMENT OF CODE FORMATS THE 'MSC/SA' MATRIX IN THE 'DRD' */ 00045000
*   /* PORTION OF THE PATH ANALYSIS REPORT.                          */ 00046000
*   /*                                                               */ 00047000
*   /*****************************************************************/ 00048000
*                                                               02S0008 00049000
*   OUTLINE=NEWPAGE;                /* SET NEW PAGE INDICATOR@Y30LB52*/ 00050000
         MVI   OUTLINE+1(CVTPTR),C' '                           02S0008 00051000
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          02S0008 00052000
         MVI   OUTLINE(CVTPTR),C'1'                             02S0008 00053000
*   CALL P1PRINTL;                  /* PRINT IT              @Y30LB52*/ 00054000
*                                                               02S0009 00055000
         BAL   @14,P1PRINTL                                     02S0009 00056000
*   /*****************************************************************/ 00057000
*   /*                                                               */ 00058000
*   /* MOVE THE 'DRD' HEADER TO THE OUTPUT BUFFER AND PRINT IT .     */ 00059000
*   /*                                                               */ 00060000
*   /*****************************************************************/ 00061000
*                                                               02S0010 00062000
*   OUTLINE=DRDHEAD;                /* MAIN HEADER           @Y30LB52*/ 00063000
         MVI   OUTLINE+76(CVTPTR),C' '                          02S0010 00064000
         MVC   OUTLINE+77(56,CVTPTR),OUTLINE+76(CVTPTR)         02S0010 00065000
         MVC   OUTLINE(76,CVTPTR),DRDHEAD                       02S0010 00066000
*   CALL P1PRINTL;                  /* PRINT IT              @Y30LB52*/ 00067000
*                                                               02S0011 00068000
         BAL   @14,P1PRINTL                                     02S0011 00069000
*   /*****************************************************************/ 00070000
*   /*                                                               */ 00071000
*   /* MOVE THE 'MSC/SA' ARRAY HEADER LINE TO THE BUFFER AND PRINT   */ 00072000
*   /* IT.                                                           */ 00073000
*   /*                                                               */ 00074000
*   /*****************************************************************/ 00075000
*                                                               02S0012 00076000
*   OUTLINE=MSCSAHD;                /*                       @Y30LB52*/ 00077000
         MVI   OUTLINE+33(CVTPTR),C' '                          02S0012 00078000
         MVC   OUTLINE+34(99,CVTPTR),OUTLINE+33(CVTPTR)         02S0012 00079000
         MVC   OUTLINE(33,CVTPTR),MSCSAHD                       02S0012 00080000
*   CALL P1PRINTL;                  /* PRINT IT              @Y30LB52*/ 00081000
*                                                               02S0013 00082000
         BAL   @14,P1PRINTL                                     02S0013 00083000
*   /*****************************************************************/ 00084000
*   /*                                                               */ 00085000
*   /* MOVE THE 'SA' HEADER LINE TO THE BUFFER AND PRINT IT .        */ 00086000
*   /*                                                               */ 00087000
*   /*****************************************************************/ 00088000
*                                                               02S0014 00089000
*   OUTLINE=SAHD;                   /*                       @Y30LB52*/ 00090000
         MVI   OUTLINE+98(CVTPTR),C' '                          02S0014 00091000
         MVC   OUTLINE+99(34,CVTPTR),OUTLINE+98(CVTPTR)         02S0014 00092000
         MVC   OUTLINE(98,CVTPTR),SAHD                          02S0014 00093000
*   CALL P1PRINTL;                  /* PRINT IT              @Y30LB52*/ 00094000
*                                                               02S0015 00095000
         BAL   @14,P1PRINTL                                     02S0015 00096000
*   /*****************************************************************/ 00097000
*   /*                                                               */ 00098000
*   /* SKIP A LINE AND PRINT THE LINE BEFORE THE ARRAY.              */ 00099000
*   /*                                                               */ 00100000
*   /*****************************************************************/ 00101000
*                                                               02S0016 00102000
*   OUTLINE=SKIPONE;                /*                       @Y30LB52*/ 00103000
         MVI   OUTLINE+1(CVTPTR),C' '                           02S0016 00104000
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          02S0016 00105000
         MVI   OUTLINE(CVTPTR),C' '                             02S0016 00106000
*   COLUMN1='MSC';                  /*                       @Y30LB52*/ 00107000
         MVC   COLUMN1(3,CVTPTR),@CC00238                       02S0017 00108000
*   COLTOTAL='TOTAL';               /*                       @Y30LB52*/ 00109000
         MVC   COLTOTAL(5,CVTPTR),@CC00240                      02S0018 00110000
*   CALL P1PRINTL;                  /* PRINT IT              @Y30LB52*/ 00111000
*                                                               02S0019 00112000
         BAL   @14,P1PRINTL                                     02S0019 00113000
*   /*****************************************************************/ 00114000
*   /*                                                               */ 00115000
*   /* COMPUTE AND PRINT THE ARRAY VALUES AND TOTALS.                */ 00116000
*   /*                                                               */ 00117000
*   /*****************************************************************/ 00118000
*                                                               02S0020 00119000
*   CALL P1MSCSAV;                  /* CALL THE MSC/SA VALUE ROUTINE    00120000
*                                                            @Y30LB52*/ 00121000
         BAL   @14,P1MSCSAV                                     02S0020 00122000
*P1MSCSAV:                                                      03S0021 00123000
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Y30LB52*/ 00124000
*                                                               03S0021 00125000
         B     @PB00002                                         03S0021 00126000
P1MSCSAV ST    @14,@SA00002                                     03S0021 00127000
*   /*****************************************************************/ 00128000
*   /*                                                               */ 00129000
*   /* THIS SEGMENT OF CODE TOTALS, FORMATS AND PRINTS THE VALUES FOR*/ 00130000
*   /* THE MSC/SA ARRAY IN THE PATH ANALYSIS REPORT(DRD). THE OUTER  */ 00131000
*   /* LOOP PROCESSES THE EIGHT POSSIBLE MSC INTERFACE ADDRESSES AND */ 00132000
*   /* THE RESPECTIVE ACCUMULATORS BENEATH.                          */ 00133000
*   /*                                                               */ 00134000
*   /*****************************************************************/ 00135000
*                                                               03S0022 00136000
*   TOTALS=TOTALS&&TOTALS;          /* CLEAR ALL TOTALS      @Y30LB52*/ 00137000
         XC    TOTALS(76),TOTALS                                03S0022 00138000
*   DO I=1 TO 8 WHILE(MSCINTF(I)^='0000'X);/* LOOP THROUGH MSC'S        00139000
*                                                            @Y30LB52*/ 00140000
         LA    I,1                                              03S0023 00141000
@DL00023 LR    @08,I                                            03S0023 00142000
         SLA   @08,3                                            03S0023 00143000
         L     @04,PAD00PTR(,CVTPTR)                            03S0023 00144000
         ST    @08,@TF00001                                     03S0023 00145000
         ALR   @08,@04                                          03S0023 00146000
         CLC   MSCINTF-8(2,@08),@CB00246                        03S0023 00147000
         BE    @DC00023                                         03S0023 00148000
*     IF SATABPTR(I)^=0             /* WITH ERRORS           @Y30LB52*/ 00149000
*       THEN                                                    03S0024 00150000
         SLR   @08,@08                                          03S0024 00151000
         L     @03,@TF00001                                     03S0024 00152000
         L     @03,SATABPTR-8(@03,@04)                          03S0024 00153000
         CR    @03,@08                                          03S0024 00154000
         BE    @RF00024                                         03S0024 00155000
*       DO;                         /*                       @Y30LB52*/ 00156000
         ST    @03,@TF00002                                     03S0025 00157000
*         OUTLINE=SKIPONE;          /* SKIP ONE LINE CC      @Y30LB52*/ 00158000
         MVI   OUTLINE+1(CVTPTR),C' '                           03S0026 00159000
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          03S0026 00160000
         MVI   OUTLINE(CVTPTR),C' '                             03S0026 00161000
*         SATABP=SATABPTR(I);       /* LOAD PTR TO SA TABLE  @Y30LB52*/ 00162000
*                                                               03S0027 00163000
         L     SATABP,@TF00002                                  03S0027 00164000
*         /***********************************************************/ 00165000
*         /*                                                         */ 00166000
*         /* MOVE MSC ADDRESS TO OUTPUT LINE                         */ 00167000
*         /*                                                         */ 00168000
*         /***********************************************************/ 00169000
*                                                               03S0028 00170000
*         UNPK(DECNO(1:4),MSCDRDAC(I,1:3));/* UNPACK THE HEX STRING     00171000
*                                      PLUS ONE BYTE         @Y30LB52*/ 00172000
         AL    @04,@TF00001                                     03S0028 00173000
         UNPK  DECNO(4),MSCDRDAC-8(3,@04)                       03S0028 00174000
*         MSC1=DECNO(1:3)&'0F0F0F'X;/* TURN OFF THE ZONES    @Y30LB52*/ 00175000
         MVC   MSC1(3,CVTPTR),DECNO                             03S0029 00176000
         NC    MSC1(3,CVTPTR),@CB00250                          03S0029 00177000
*         TR(MSC1,TRTAB);           /* TRANSLATE TO PRINTABLE@Y30LB52   00178000
*                                      HEXADECIMAL CHARACTERS   03S0030 00179000
*                                                            @Y30LB52*/ 00180000
         TR    MSC1(3,CVTPTR),TRTAB                             03S0030 00181000
*         RTOTAL=0;                 /* CLEAR THE ROW TOTAL   @Y30LB52*/ 00182000
*                                                               03S0031 00183000
         STH   @08,RTOTAL                                       03S0031 00184000
*         /***********************************************************/ 00185000
*         /*                                                         */ 00186000
*         /* LOOP THROUGH SIXTEEN POSSIBLE SA'S AND PRINT THE        */ 00187000
*         /* ACCUMULATED ERRORS.                                     */ 00188000
*         /*                                                         */ 00189000
*         /***********************************************************/ 00190000
*                                                               03S0032 00191000
*         RESPECIFY                                             03S0032 00192000
*           SADRDDSD BASED(SATABP); /*                       @Y30LB52*/ 00193000
*         ACCUMTOT=ACCUMTOT&&ACCUMTOT;/* CLEAR THE ACCUMS    @Y30LB52*/ 00194000
         XC    ACCUMTOT(32),ACCUMTOT                            03S0033 00195000
*         ACCPTR=ADDR(ACCUMTOT);    /* SET ACCUMULATOR TOTAL BASE       00196000
*                                                            @ZM31069*/ 00197000
         LA    ACCPTR,ACCUMTOT                                  03S0034 00198000
*         DO K=1 TO 16;             /* SIXTEEN POSSIBLE      @Y30LB52*/ 00199000
         LA    K,1                                              03S0035 00200000
@DL00035 DS    0H                                               03S0036 00201000
*           IF DASD=OFF             /* DASD REPORT?          @Y30LB52*/ 00202000
*             THEN                                              03S0036 00203000
         TM    DASD,B'10000000'                                 03S0036 00204000
         BNZ   @RF00036                                         03S0036 00205000
*             DRDACCP=SADRDACC(K);  /* NO, LOAD DRD ACCUMULTR@Y30LB52*/ 00206000
         LR    @08,K                                            03S0037 00207000
         SLA   @08,3                                            03S0037 00208000
         AL    @08,@CF00660                                     03S0037 00209000
         L     @08,SADRDACC(@08,SATABP)                         03S0037 00210000
         ST    @08,DRDACCP                                      03S0037 00211000
*           ELSE                                                03S0038 00212000
*             DRDACCP=SADASDAC(K);  /* YES, LOAD DASD        @Y30LB52*/ 00213000
         B     @RC00036                                         03S0038 00214000
@RF00036 LR    @08,K                                            03S0038 00215000
         SLA   @08,3                                            03S0038 00216000
         AL    @08,@CF00661                                     03S0038 00217000
         L     @08,SADASDAC-4(@08,SATABP)                       03S0038 00218000
         ST    @08,DRDACCP                                      03S0038 00219000
*           IF DRDACCP=0            /* IF THE ACCUMULATOR POINTER IS    00220000
*                                      XERO                  @Y30LB52*/ 00221000
*             THEN                                              03S0039 00222000
@RC00036 ICM   @08,15,DRDACCP                                   03S0039 00223000
         BNZ   @RF00039                                         03S0039 00224000
*             MSC2(K)=ASKT4;        /* SET XERO COUNT        @ZM34326*/ 00225000
         LR    @08,K                                            03S0040 00226000
         MH    @08,@CH00101                                     03S0040 00227000
         ALR   @08,CVTPTR                                       03S0040 00228000
         MVC   MSC2-5(4,@08),@CC00067                           03S0040 00229000
*           ELSE                                                03S0041 00230000
*             DO;                   /* OTHERWISE, NON-ZERO PTR  03S0041 00231000
*                                                            @Y30LB52*/ 00232000
*                                                               03S0041 00233000
         B     @RC00039                                         03S0041 00234000
@RF00039 DS    0H                                               03S0042 00235000
*               /*****************************************************/ 00236000
*               /*                                                   */ 00237000
*               /* TOTAL THE ERRORS RECORDED UNDER THIS MSC/SA       */ 00238000
*               /* COMBINATION                                       */ 00239000
*               /*                                                   */ 00240000
*               /*****************************************************/ 00241000
*                                                               03S0042 00242000
*               IF DASD=OFF         /* NOT DASD ARRAY        @Y30LB52*/ 00243000
*                 THEN                                          03S0042 00244000
         TM    DASD,B'10000000'                                 03S0042 00245000
         BNZ   @RF00042                                         03S0042 00246000
*                 DRDACCE=DRDACCP+LENGTH(CDRDACCT)-2;/*      @Y30LB52*/ 00247000
         L     @08,DRDACCP                                      03S0043 00248000
         SH    @08,@CH00650                                     03S0043 00249000
         ST    @08,DRDACCE                                      03S0043 00250000
*               ELSE                                            03S0044 00251000
*                 DRDACCE=DRDACCP+LENGTH(CSPNDLET)-2;/*      @Y30LB52   00252000
*                                      OTHERWISE LOAD DASD ACCUM END    00253000
*                                                            @Y30LB52*/ 00254000
         B     @RC00042                                         03S0044 00255000
@RF00042 L     @08,DRDACCP                                      03S0044 00256000
         SH    @08,@CH00651                                     03S0044 00257000
         ST    @08,DRDACCE                                      03S0044 00258000
*               DO DRDACCP=DRDACCP TO DRDACCE BY 2;/* LOOP THROUGH      00259000
*                                      ALL ACCUMULATORS      @Y30LB52*/ 00260000
@RC00042 L     @08,DRDACCP                                      03S0045 00261000
         B     @DE00045                                         03S0045 00262000
@DL00045 DS    0H                                               03S0046 00263000
*                 IF DRDACC^=0      /* IF NON-ZERO ERROR COUNT  03S0046 00264000
*                                                            @Y30LB52*/ 00265000
*                   THEN                                        03S0046 00266000
         LH    @08,DRDACC(,@08)                                 03S0046 00267000
         LTR   @08,@08                                          03S0046 00268000
         BZ    @RF00046                                         03S0046 00269000
*                   DO;             /* TOTAL THE ERRORS      @Y30LB52*/ 00270000
*                     ACCUM1=ACCUM1+DRDACC;/* INCREMNT ACCUMULATOR      00271000
*                                      TOTAL                 @Y30LB52*/ 00272000
         LH    @06,ACCUM1(,ACCPTR)                              03S0048 00273000
         ALR   @06,@08                                          03S0048 00274000
         STH   @06,ACCUM1(,ACCPTR)                              03S0048 00275000
*                     RTOTAL=RTOTAL+DRDACC;/* ROW TOTAL      @Y30LB52*/ 00276000
         AH    @08,RTOTAL                                       03S0049 00277000
         STH   @08,RTOTAL                                       03S0049 00278000
*                   END;            /*                       @Y30LB52*/ 00279000
*               END;                /*                       @Y30LB52*/ 00280000
*                                                               03S0051 00281000
@RF00046 LA    @08,2                                            03S0051 00282000
         AL    @08,DRDACCP                                      03S0051 00283000
         ST    @08,DRDACCP                                      03S0051 00284000
@DE00045 C     @08,DRDACCE                                      03S0051 00285000
         BNH   @DL00045                                         03S0051 00286000
*               /*****************************************************/ 00287000
*               /*                                                   */ 00288000
*               /* CONVERT COUNT TO EBCDIC AND INSERT IN OUTPUT LINE */ 00289000
*               /*                                                   */ 00290000
*               /*****************************************************/ 00291000
*                                                               03S0052 00292000
*               LTOTAL(K)=LTOTAL(K)+ACCUM1;/* INCREMENT      @Y30LB52   00293000
*                                      COLTOTAL              @Y30LB52*/ 00294000
         LR    @08,K                                            03S0052 00295000
         ALR   @08,@08                                          03S0052 00296000
         LH    @06,ACCUM1(,ACCPTR)                              03S0052 00297000
         LH    @15,LTOTAL-2(@08)                                03S0052 00298000
         ALR   @15,@06                                          03S0052 00299000
         STH   @15,LTOTAL-2(@08)                                03S0052 00300000
*               CVD(ACCUM1,DECNO);  /* CONVERT BINARY STRING TO 03S0053 00301000
*                                      DECIMAL               @Y30LB52*/ 00302000
         CVD   @06,DECNO                                        03S0053 00303000
*               MSC2(K)=EDITPAT3;   /* MOVE EDIT PATTERN     @ZM34326*/ 00304000
         LR    @08,K                                            03S0054 00305000
         MH    @08,@CH00101                                     03S0054 00306000
         ST    @08,@TF00001                                     03S0054 00307000
         ALR   @08,CVTPTR                                       03S0054 00308000
         MVC   MSC2-5(4,@08),EDITPAT3                           03S0054 00309000
*               ED(MSC2(K),DECNO1); /* CONVERT TO PRINTABLE HEX 03S0055 00310000
*                                                            @ZM34326*/ 00311000
         LR    @08,CVTPTR                                       03S0055 00312000
         AL    @08,@TF00001                                     03S0055 00313000
         ED    MSC2-5(4,@08),DECNO1                             03S0055 00314000
*             END;                  /*                       @Y30LB52*/ 00315000
*           ACCPTR=ACCPTR+2;        /* INCREMENT ACCUMULATOR @Y30LB52*/ 00316000
@RC00039 AH    ACCPTR,@CH00106                                  03S0057 00317000
*         END;                      /*                       @Y30LB52*/ 00318000
         AH    K,@CH00045                                       03S0058 00319000
         CH    K,@CH00084                                       03S0058 00320000
         BNH   @DL00035                                         03S0058 00321000
*         CVD(RTOTAL,DECNO);        /* CONVERT BINARY STRING TO 03S0059 00322000
*                                      DECIMAL               @ZA00699*/ 00323000
         LH    @08,RTOTAL                                       03S0059 00324000
         CVD   @08,DECNO                                        03S0059 00325000
*         MSCTOT=EDITPAT5;          /* 5 DIGIT EDIT PATTERN  @ZA00699*/ 00326000
         MVC   MSCTOT(6,CVTPTR),EDITPAT5                        03S0060 00327000
*         ED(MSCTOT,DECNO2);        /* CONVERT TO PRINTABLE HEX 03S0061 00328000
*                                                            @ZA00699*/ 00329000
         ED    MSCTOT(6,CVTPTR),DECNO2                          03S0061 00330000
*         CALL P1PRINTL;            /* PRINT THE LINE        @Y30LB52*/ 00331000
         BAL   @14,P1PRINTL                                     03S0062 00332000
*       END;                        /*                       @Y30LB52*/ 00333000
*   END;                            /*                       @Y30LB52*/ 00334000
*                                                               03S0064 00335000
@RF00024 AH    I,@CH00045                                       03S0064 00336000
         CH    I,@CH00099                                       03S0064 00337000
         BNH   @DL00023                                         03S0064 00338000
@DC00023 DS    0H                                               03S0065 00339000
*   /*****************************************************************/ 00340000
*   /*                                                               */ 00341000
*   /* FORMAT AND PRINT COLUMN TOTALS LINE                           */ 00342000
*   /*                                                               */ 00343000
*   /*****************************************************************/ 00344000
*                                                               03S0065 00345000
*   OUTLINE=SKIPTWO;                /* SKIP TWO LINES CC     @Y30LB52*/ 00346000
         MVI   OUTLINE+1(CVTPTR),C' '                           03S0065 00347000
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          03S0065 00348000
         MVI   OUTLINE(CVTPTR),C'0'                             03S0065 00349000
*   MSCCTOT='TOTAL';                /*                       @Y30LB52*/ 00350000
         MVC   MSCCTOT(5,CVTPTR),@CC00240                       03S0066 00351000
*   DO K=1 TO 16;                   /* LOOP THROUGH SA'S     @Y30LB52*/ 00352000
         LA    K,1                                              03S0067 00353000
@DL00067 DS    0H                                               03S0068 00354000
*     IF LTOTAL(K)=0                /* ZERO TOTAL?           @Y30LB52*/ 00355000
*       THEN                                                    03S0068 00356000
         LR    @08,K                                            03S0068 00357000
         ALR   @08,@08                                          03S0068 00358000
         LH    @08,LTOTAL-2(@08)                                03S0068 00359000
         LTR   @08,@08                                          03S0068 00360000
         BNZ   @RF00068                                         03S0068 00361000
*       MSC2(K)=BLNK4;              /* STORE EBCDIC ZERO     @ZM34326*/ 00362000
         LR    @08,K                                            03S0069 00363000
         MH    @08,@CH00101                                     03S0069 00364000
         ALR   @08,CVTPTR                                       03S0069 00365000
         MVC   MSC2-5(4,@08),@CC00065                           03S0069 00366000
*     ELSE                                                      03S0070 00367000
*       DO;                         /* NON-ZERO TOTAL?       @Y30LB52*/ 00368000
*                                                               03S0070 00369000
         B     @RC00068                                         03S0070 00370000
@RF00068 DS    0H                                               03S0071 00371000
*         /***********************************************************/ 00372000
*         /*                                                         */ 00373000
*         /* CONVERT AND STORE IN OUTPUT LINE                        */ 00374000
*         /*                                                         */ 00375000
*         /***********************************************************/ 00376000
*                                                               03S0071 00377000
*         GTOTAL=GTOTAL+LTOTAL(K);  /* GRAND TOTAL           @Y30LB52*/ 00378000
         LR    @08,K                                            03S0071 00379000
         ALR   @08,@08                                          03S0071 00380000
         LH    @08,LTOTAL-2(@08)                                03S0071 00381000
         LH    @05,GTOTAL                                       03S0071 00382000
         ALR   @05,@08                                          03S0071 00383000
         STH   @05,GTOTAL                                       03S0071 00384000
*         CVD(LTOTAL(K),DECNO);     /* CONVERT BINARY STRING TO 03S0072 00385000
*                                      DECIMAL               @Y30LB52*/ 00386000
         CVD   @08,DECNO                                        03S0072 00387000
*         MSC2(K)=EDITPAT3;         /* MOVE EDIT PATTERN     @ZM34326*/ 00388000
         LR    @08,K                                            03S0073 00389000
         MH    @08,@CH00101                                     03S0073 00390000
         ST    @08,@TF00001                                     03S0073 00391000
         ALR   @08,CVTPTR                                       03S0073 00392000
         MVC   MSC2-5(4,@08),EDITPAT3                           03S0073 00393000
*         ED(MSC2(K),DECNO1);       /* CONVERT TO PRINTABLE HEX 03S0074 00394000
*                                                            @ZM34326*/ 00395000
         LR    @08,CVTPTR                                       03S0074 00396000
         AL    @08,@TF00001                                     03S0074 00397000
         ED    MSC2-5(4,@08),DECNO1                             03S0074 00398000
*       END;                        /*                       @Y30LB52*/ 00399000
*   END;                            /*                       @Y30LB52*/ 00400000
@RC00068 AH    K,@CH00045                                       03S0076 00401000
         CH    K,@CH00084                                       03S0076 00402000
         BNH   @DL00067                                         03S0076 00403000
*   CVD(GTOTAL,DECNO);              /* CONVERT BINARY STRING TO 03S0077 00404000
*                                      DECIMAL               @ZA00699*/ 00405000
         LH    @08,GTOTAL                                       03S0077 00406000
         CVD   @08,DECNO                                        03S0077 00407000
*   MSCTOT=EDITPAT5;                /* 5 DIGIT EDIT PATTERN  @ZA00699*/ 00408000
         MVC   MSCTOT(6,CVTPTR),EDITPAT5                        03S0078 00409000
*   ED(MSCTOT,DECNO2);              /* CONVERT TO PRINTABLE HEX 03S0079 00410000
*                                                            @ZA00699*/ 00411000
         ED    MSCTOT(6,CVTPTR),DECNO2                          03S0079 00412000
*   CALL P1PRINTL;                  /* PRINT THE LINE        @Y30LB52   00413000
*                                                            @Y30LB52*/ 00414000
         BAL   @14,P1PRINTL                                     03S0080 00415000
*                                                               03S0081 00416000
*   /*****************************************************************/ 00417000
*   /*                                                               */ 00418000
*   /* THE FOLLOWING STRUCTURE MAPS THE OUTPUT LINE TO BE USED IN THE*/ 00419000
*   /* INSERTION OF THE ROW ERROR COUNTS.                            */ 00420000
*   /*                                                               */ 00421000
*   /*****************************************************************/ 00422000
*                                                               03S0081 00423000
*   DCL                                                         03S0081 00424000
*     1 * DEF(OUTLINE),                                         03S0081 00425000
*      2 * CHAR(10),                /* UNUSED                @Y30LB52*/ 00426000
*      2 MSC1 CHAR(3),              /* MSC UNIT ADDR         @Y30LB52*/ 00427000
*      2 * CHAR(1),                 /* UNUSED                @Y30LB52*/ 00428000
*      2 MSCCTOT CHAR(5),           /* CONSTANT 'TOTAL'      @Y30LB52*/ 00429000
*      2 *(16) CHAR(5),             /* ERROR COUNTS AND SPACE@Y30LB52*/ 00430000
*       3 MSC2 CHAR(4),             /* ERROR COUNT           @ZM34326*/ 00431000
*       3 * CHAR(1),                /* UNUSED                @ZM34326*/ 00432000
*      2 MSCTOT CHAR(6);            /* TOTALS COLUMN         @ZA00699*/ 00433000
*   END P1MSCSAV;                   /*                       @Y30LB52*/ 00434000
@EL00002 DS    0H                                               03S0082 00435000
@EF00002 DS    0H                                               03S0082 00436000
@ER00002 L     @14,@SA00002                                     03S0082 00437000
         BR    @14                                              03S0082 00438000
@PB00002 DS    0H                                               03S0083 00439000
*                                                               02S0083 00440000
*   /*****************************************************************/ 00441000
*   /*                                                               */ 00442000
*   /* THIS STRUCTURE MAPS THE 'DRD' REPORT HEADER.                  */ 00443000
*   /*                                                               */ 00444000
*   /*****************************************************************/ 00445000
*                                                               02S0083 00446000
*   DCL                                                         02S0083 00447000
*     1 DRDHEAD STATIC LOCAL,       /* MAIN DRD REPORT HEAD  @Y30LB52*/ 00448000
*      2 * CHAR(1) INIT('0'),       /* SKIP TWO CC           @Y30LB52*/ 00449000
*      2 * CHAR(32) INIT('REPORT 6 - PATH ANALYSIS REPORT '),   02S0083 00450000
*      2 * CHAR(19) INIT('OF EQUIPMENT CHECKS'),/*           @ZM30730*/ 00451000
*      2 * CHAR(24) INIT('(DATA RECORDING DEVICES)'),/*      @ZM30730*/ 00452000
*                                                               02S0083 00453000
*     /***************************************************************/ 00454000
*     /*                                                             */ 00455000
*     /* THIS STRUCTURE MAPS THE MAIN HEADER FOR THE 'MSC/SA' ARRAY  */ 00456000
*     /*                                                             */ 00457000
*     /***************************************************************/ 00458000
*                                                               02S0083 00459000
*     1 MSCSAHD STATIC LOCAL,       /*                       @Y30LB52*/ 00460000
*      2 * CHAR(1) INIT('-'),       /*                       @Y30LB52*/ 00461000
*      2 * CHAR(3) INIT('   '),     /*                       @Y30LB52*/ 00462000
*      2 * CHAR(29) INIT('MSC/SA INTERFACE ERROR COUNTS'),/* @Y30LB52*/ 00463000
*                                                               02S0083 00464000
*     /***************************************************************/ 00465000
*     /*                                                             */ 00466000
*     /* THIS STRUCTURE DEFINES THE 'SA' HEADER LINE OF THE MSC/SA   */ 00467000
*     /* REPORT.                                                     */ 00468000
*     /*                                                             */ 00469000
*     /***************************************************************/ 00470000
*                                                               02S0083 00471000
*     1 SAHD STATIC LOCAL,          /*                       @Y30LB52*/ 00472000
*      2 * CHAR(1) INIT('-'),       /*                       @Y30LB52*/ 00473000
*      2 * CHAR(12) INIT(' '),      /*                       @Y30LB52*/ 00474000
*      2 * CHAR(52) INIT(                                       02S0083 00475000
*            'SA     800  810  820  830  840  850  860  870  880  '),   00476000
*      2 * CHAR(33) INIT('890  8A0  8B0  8C0  8D0  8E0  8F0'),  02S0083 00477000
*                                                               02S0083 00478000
*/*                                                          @Y30LB52*/ 00479000
*                                                               02S0083 00480000
*     /***************************************************************/ 00481000
*     /*                                                             */ 00482000
*     /* THIS STRUCTURE MAPS THE 'MSC/SA' INNER HEADER OF THE        */ 00483000
*     /* 'MSC/SA' REPORT.                                            */ 00484000
*     /*                                                             */ 00485000
*     /***************************************************************/ 00486000
*                                                               02S0083 00487000
*     1 SAHD2 DEF(OUTLINE),         /*                       @Y30LB52*/ 00488000
*      2 * CHAR(10),                /*                       @Y30LB52*/ 00489000
*      2 COLUMN1 CHAR(3),           /*                       @Y30LB52*/ 00490000
*      2 * CHAR(6),                 /*                       @Y30LB52*/ 00491000
*      2 SAEL2(16) CHAR(5),         /*                       @Y30LB52*/ 00492000
*      2 * CHAR(2),                 /*                       @ZA00699*/ 00493000
*      2 COLTOTAL CHAR(5);          /*                       @Y30LB52*/ 00494000
*                                                               01S0084 00495000
*   /*****************************************************************/ 00496000
*   /*                                                               */ 00497000
*   /* THIS CODE GENERATES THE SA/DRC INTERFACE ARRAY FOR ERRORS     */ 00498000
*   /* RECORDED IN THE DRC/DRD PATHS.                                */ 00499000
*   /*                                                               */ 00500000
*   /*****************************************************************/ 00501000
*                                                               01S0084 00502000
*   IF MSFTOTC^='0000000000000000'X /* IF NO MSF DRD ERRORS  @Y30LB52*/ 00503000
*     THEN                                                      01S0084 00504000
         L     @08,PAD00PTR(,CVTPTR)                            01S0084 00505000
         CLC   MSFTOTC(8,@08),@CB00303                          01S0084 00506000
         BE    @RF00084                                         01S0084 00507000
*     DO;                           /* SKIP ARRAYS           @Y30LB52*/ 00508000
*                                                               02S0086 00509000
*       /*************************************************************/ 00510000
*       /*                                                           */ 00511000
*       /* THIS SEGMENT FORMATS THE HEADER LINES FOR THE 'SA/DRC'    */ 00512000
*       /* PORTION OF THE 'DRD' PATH ANALYSIS REPORT. ONE ARRAY IS   */ 00513000
*       /* PRODUCED FOR EACH LIBRARY PRESENT IN THE SUBSYSTEM BEING  */ 00514000
*       /* REPORTED ON.                                              */ 00515000
*       /*                                                           */ 00516000
*       /*************************************************************/ 00517000
*                                                               02S0086 00518000
*       DO I=1 TO MSFNO;            /* LOOP THRO ALL CS'S    @Y30LB52*/ 00519000
         LA    I,1                                              02S0086 00520000
         B     @DE00086                                         02S0086 00521000
@DL00086 DS    0H                                               02S0087 00522000
*         IF CSFTOTAL(I)^=0         /* IF NO ERRORS WERE     @Y30LB52*/ 00523000
*           THEN                                                02S0087 00524000
         LR    @08,I                                            02S0087 00525000
         ALR   @08,@08                                          02S0087 00526000
         L     @04,PAD00PTR(,CVTPTR)                            02S0087 00527000
         LH    @08,CSFTOTAL-2(@08,@04)                          02S0087 00528000
         LTR   @08,@08                                          02S0087 00529000
         BZ    @RF00087                                         02S0087 00530000
*           DO;                     /* RECORDED, SKIP THE MSF@Y30LB52*/ 00531000
*                                                               02S0088 00532000
*             /*******************************************************/ 00533000
*             /*                                                     */ 00534000
*             /* AFTER THE ARRAY FOR THE SECOND LIBRARY IS EVALUATED */ 00535000
*             /* AND PRINTED, THE PAGE MUST BE EJECTED WITH A NEW TOP*/ 00536000
*             /* HEADER.                                             */ 00537000
*             /*                                                     */ 00538000
*             /*******************************************************/ 00539000
*                                                               02S0089 00540000
*             IF I=3 THEN           /* EVERY THIRD ARRAY     @Y30LB52*/ 00541000
         CH    I,@CH00103                                       02S0089 00542000
         BNE   @RF00089                                         02S0089 00543000
*               DO;                 /* EJECT THE PAGE        @Y30LB52*/ 00544000
*                 OUTLINE=NEWPAGE;  /* NEW PAGE CC           @Y30LB52*/ 00545000
         MVI   OUTLINE+1(CVTPTR),C' '                           02S0091 00546000
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          02S0091 00547000
         MVI   OUTLINE(CVTPTR),C'1'                             02S0091 00548000
*                 CALL P1PRINTL;    /* PRINT A LINE          @Y30LB52*/ 00549000
*                                                               02S0092 00550000
         BAL   @14,P1PRINTL                                     02S0092 00551000
*                 /***************************************************/ 00552000
*                 /*                                                 */ 00553000
*                 /* OUTPUT THE 'DRD' REPORT HEADER.                 */ 00554000
*                 /*                                                 */ 00555000
*                 /***************************************************/ 00556000
*                                                               02S0093 00557000
*                 OUTLINE=DRDHEAD;  /* SET HEADER IN LINE    @Y30LB52*/ 00558000
         MVI   OUTLINE+76(CVTPTR),C' '                          02S0093 00559000
         MVC   OUTLINE+77(56,CVTPTR),OUTLINE+76(CVTPTR)         02S0093 00560000
         MVC   OUTLINE(76,CVTPTR),DRDHEAD                       02S0093 00561000
*                 CALL P1PRINTL;    /*                       @Y30LB52*/ 00562000
         BAL   @14,P1PRINTL                                     02S0094 00563000
*               END;                /* PRINT IT              @Y30LB52*/ 00564000
*                                                               02S0095 00565000
*             /*******************************************************/ 00566000
*             /*                                                     */ 00567000
*             /* SET UP THE SA/DRC ARRAY MAIN HEADER AND PRINT IT.   */ 00568000
*             /*                                                     */ 00569000
*             /*******************************************************/ 00570000
*                                                               02S0096 00571000
*             OUTLINE=SADRCHD;      /*                       @Y30LB52*/ 00572000
@RF00089 MVI   OUTLINE+54(CVTPTR),C' '                          02S0096 00573000
         MVC   OUTLINE+55(78,CVTPTR),OUTLINE+54(CVTPTR)         02S0096 00574000
         MVC   OUTLINE(54,CVTPTR),SADRCHD                       02S0096 00575000
*             OUTLINE(53)=(I-1)|'0';/* CS SSID               @Y30LB52*/ 00576000
         LR    @08,I                                            02S0097 00577000
         BCTR  @08,0                                            02S0097 00578000
         O     @08,@CF00073                                     02S0097 00579000
         STC   @08,OUTLINE+52(,CVTPTR)                          02S0097 00580000
*             CALL P1PRINTL;        /* PRINT THE LINE        @Y30LB52*/ 00581000
*                                                               02S0098 00582000
         BAL   @14,P1PRINTL                                     02S0098 00583000
*             /*******************************************************/ 00584000
*             /*                                                     */ 00585000
*             /* SET AND PRINT THE 'SA' SSID HEADER LINE.            */ 00586000
*             /*                                                     */ 00587000
*             /*******************************************************/ 00588000
*                                                               02S0099 00589000
*             OUTLINE=SAHD;         /* SET CONSTANT HEADER   @Y30LB52*/ 00590000
         MVI   OUTLINE+98(CVTPTR),C' '                          02S0099 00591000
         MVC   OUTLINE+99(34,CVTPTR),OUTLINE+98(CVTPTR)         02S0099 00592000
         MVC   OUTLINE(98,CVTPTR),SAHD                          02S0099 00593000
*             CALL P1PRINTL;        /* PRINT IT              @Y30LB52*/ 00594000
*                                                               02S0100 00595000
         BAL   @14,P1PRINTL                                     02S0100 00596000
*             /*******************************************************/ 00597000
*             /*                                                     */ 00598000
*             /* SET UP THE DRC-TOTAL HEADER LINE RIGHT BEFORE THE   */ 00599000
*             /* ARRAY VALUES.                                       */ 00600000
*             /*                                                     */ 00601000
*             /*******************************************************/ 00602000
*                                                               02S0101 00603000
*             OUTLINE=SKIPONE;      /* SKIP ONE CC           @Y30LB52*/ 00604000
         MVI   OUTLINE+1(CVTPTR),C' '                           02S0101 00605000
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          02S0101 00606000
         MVI   OUTLINE(CVTPTR),C' '                             02S0101 00607000
*             COLUMN1='DRC';        /* CONSTANT IN LINE      @Y30LB52*/ 00608000
         MVC   COLUMN1(3,CVTPTR),@CC00307                       02S0102 00609000
*             COLTOTAL='TOTAL';     /* SECOND CONSTANT       @Y30LB52*/ 00610000
         MVC   COLTOTAL(5,CVTPTR),@CC00240                      02S0103 00611000
*             CALL P1PRINTL;        /* PRINT THE LINE        @Y30LB52*/ 00612000
*                                                               02S0104 00613000
         BAL   @14,P1PRINTL                                     02S0104 00614000
*             /*******************************************************/ 00615000
*             /*                                                     */ 00616000
*             /* THE NEXT SEGMENT PRODUCES A PRINTABLE ARRAY OF      */ 00617000
*             /* VALUES FOR THE 'SA/DRC' REPORT.                     */ 00618000
*             /*                                                     */ 00619000
*             /*******************************************************/ 00620000
*                                                               02S0105 00621000
*                                                               03S0105 00622000
*             /*******************************************************/ 00623000
*             /*                                                     */ 00624000
*             /* THE FOLLOWING SEGMENT OF CODE PRODUCES THE VALUE    */ 00625000
*             /* LINES FOR THE SA/DRC ARRAY OF THE PATH ANALYSIS     */ 00626000
*             /* REPORT. ON ENTRY TO THIS SEGMENT, THE VARIABLE 'I'  */ 00627000
*             /* CONTAINS THE CARTRIDGE STORE INDEX.                 */ 00628000
*             /*                                                     */ 00629000
*             /*******************************************************/ 00630000
*                                                               03S0105 00631000
*             TOTALS=TOTALS&&TOTALS;/* CLEAR ALL TOTALS COUNTERS        00632000
*                                                            @Y30LB52*/ 00633000
         XC    TOTALS(76),TOTALS                                03S0105 00634000
*             LTPDRDP=LTPAD+(I-1)*LENGTH(LTPDRDTB);/* SET POINTER TO    00635000
*                                      THE LOGICAL DRC CONVERSTION      00636000
*                                      TABLE                 @Y30LB52*/ 00637000
         L     @08,CNFG0PTR(,CVTPTR)                            03S0106 00638000
         LR    @04,I                                            03S0106 00639000
         BCTR  @04,0                                            03S0106 00640000
         SLA   @04,3                                            03S0106 00641000
         AL    @04,LTPAD(,@08)                                  03S0106 00642000
         ST    @04,LTPDRDP                                      03S0106 00643000
*             DO J=1 TO LIBSIZS(I); /* LOOP THROUGH THE DRCS'S IN THE   00644000
*                                      LIBRARY               @Y30LB52*/ 00645000
         LA    @08,1                                            03S0107 00646000
         B     @DE00107                                         03S0107 00647000
@DL00107 DS    0H                                               03S0108 00648000
*               VSADRC=VSADRC&&VSADRC;/* CLEAR VALID SA/DRC INTERFACE   00649000
*                                      CONTROL ARRAY         @Y30LB52*/ 00650000
         XC    VSADRC(16),VSADRC                                03S0108 00651000
*               ACCUMTOT=ACCUMTOT&&ACCUMTOT;/* CLEAR TOTALS  @Y30LB52*/ 00652000
*                                                               03S0109 00653000
         XC    ACCUMTOT(32),ACCUMTOT                            03S0109 00654000
*               /*****************************************************/ 00655000
*               /*                                                   */ 00656000
*               /* THE FOLLOWING LOOP PROCESSES THE TWO POSSIBLE SA'S*/ 00657000
*               /* THAT COULD BE ATTACHED TO THE DRC BEING TOTALED.  */ 00658000
*               /*                                                   */ 00659000
*               /*****************************************************/ 00660000
*                                                               03S0110 00661000
*               DO K=1 TO 2 WHILE(LTPDRC(J,K)^='FF'X);/* 'FF'X  03S0110 00662000
*                                      INDICATES DRC UPPER INTERFACE    00663000
*                                      NOT USED              @Y30LB52*/ 00664000
         LA    K,1                                              03S0110 00665000
@DL00110 L     @08,LTPDRDP                                      03S0110 00666000
         L     @03,J                                            03S0110 00667000
         ALR   @03,@03                                          03S0110 00668000
         ALR   @03,K                                            03S0110 00669000
         ST    @03,@TF00001                                     03S0110 00670000
         ALR   @03,@08                                          03S0110 00671000
         AL    @03,@CF00662                                     03S0110 00672000
         CLI   LTPDRC(@03),X'FF'                                03S0110 00673000
         BE    @DC00110                                         03S0110 00674000
*                 SAP=LTPDRC(J,K);  /* LOAD THE SA/LOGICAL DRC BYTE     00675000
*                                                            @Y30LB52*/ 00676000
         L     @03,@TF00001                                     03S0111 00677000
         AL    @08,@CF00662                                     03S0111 00678000
         SLR   SAP,SAP                                          03S0111 00679000
         IC    SAP,LTPDRC(@03,@08)                              03S0111 00680000
*                 DRC=SAP&'0F'X;    /* EXTRACT LOGICAL DRC   @Y30LB52*/ 00681000
         LR    @08,SAP                                          03S0112 00682000
         N     @08,@CF00310                                     03S0112 00683000
         STH   @08,DRC                                          03S0112 00684000
*                 SAP=SAP/16+1;     /* EXTRACT THE SAP INDEX @Y30LB52*/ 00685000
         LA    @08,1                                            03S0113 00686000
         LR    @00,SAP                                          03S0113 00687000
         SRDA  @00,32                                           03S0113 00688000
         D     @00,@CF00084                                     03S0113 00689000
         ALR   @01,@08                                          03S0113 00690000
         LR    SAP,@01                                          03S0113 00691000
*                 VSADRC(SAP)='FF'X;/* INDICATE VALID SA/DRC @Y30LB52   00692000
*                                      CONNECTION            @Y30LB52*/ 00693000
*                                                               03S0114 00694000
         LA    @07,VSADRC-1(SAP)                                03S0114 00695000
         MVI   0(@07),X'FF'                                     03S0114 00696000
*                 /***************************************************/ 00697000
*                 /*                                                 */ 00698000
*                 /* THE FOLLOWING INCLUDED SEGMENT ACCUMULATES ALL  */ 00699000
*                 /* ERRORS RECORDED IN PATHS INCLUDING THIS SA/DRC  */ 00700000
*                 /* INTERFACE.                                      */ 00701000
*                 /*                                                 */ 00702000
*                 /***************************************************/ 00703000
*                                                               03S0115 00704000
*                                                               04S0115 00705000
*                 /***************************************************/ 00706000
*                 /*                                                 */ 00707000
*                 /* THIS SEGMENT OF CODE TOTALS ALL ERRORS IN ALL   */ 00708000
*                 /* PATHS CONTAINING THE SA/DRC INTERFACE SELECTED  */ 00709000
*                 /* IN THE PREVIOUS SEGMENT. THIS INVOLVES LOOPING  */ 00710000
*                 /* THROUGH ALL MSC'S AND FOLLOWING EACH PATH TO THE*/ 00711000
*                 /* ACCUMULATORS.                                   */ 00712000
*                 /*                                                 */ 00713000
*                 /***************************************************/ 00714000
*                                                               04S0115 00715000
*                 DO MSC=1 TO 8 WHILE(MSCINTF(MSC)^='0000'X);/* ZERO    00716000
*                                      MSC UNIT ADDRESS INDICATES END   00717000
*                                      OF LIST               @Y30LB52*/ 00718000
         STH   @08,MSC                                          04S0115 00719000
@DL00115 SLA   @08,3                                            04S0115 00720000
         L     @07,PAD00PTR(,CVTPTR)                            04S0115 00721000
         ST    @08,@TF00001                                     04S0115 00722000
         ALR   @08,@07                                          04S0115 00723000
         CLC   MSCINTF-8(2,@08),@CB00246                        04S0115 00724000
         BE    @DC00115                                         04S0115 00725000
*                   IF SATABPTR(MSC)^=0/* IF THE SATAB POINTER IS       00726000
*                                      ZERO,                 @Y30LB52*/ 00727000
*                     THEN                                      04S0116 00728000
         SLR   @08,@08                                          04S0116 00729000
         L     @03,@TF00001                                     04S0116 00730000
         L     @07,SATABPTR-8(@03,@07)                          04S0116 00731000
         CR    @07,@08                                          04S0116 00732000
         BE    @RF00116                                         04S0116 00733000
*                     DO;           /* THE PATHS THROUGH THIS MSC       00734000
*                                      HAVE NO ERRORS        @Y30LB52*/ 00735000
         ST    @07,@TF00001                                     04S0117 00736000
*                       SATABP=SATABPTR(MSC);/* OTHERWISE, LOAD THE     00737000
*                                      POINTER               @Y30LB52*/ 00738000
         L     SATABP,@TF00001                                  04S0118 00739000
*                       RESPECIFY                               04S0119 00740000
*                         SADRDDSD BASED(SATABP);/*          @Y30LB52*/ 00741000
*                       IF SADRDACC(SAP)^=0/* XERO POINTER      04S0120 00742000
*                                      INDICATES@Y30LB52     @Y30LB52*/ 00743000
*                         THEN                                  04S0120 00744000
         LR    @03,SAP                                          04S0120 00745000
         SLA   @03,3                                            04S0120 00746000
         AL    @03,@CF00660                                     04S0120 00747000
         L     @03,SADRDACC(@03,SATABP)                         04S0120 00748000
         CR    @03,@08                                          04S0120 00749000
         BE    @RF00120                                         04S0120 00750000
*                         DO;       /* NO ERRORS FOR DRD'S   @Y30LB52*/ 00751000
         ST    @03,@TF00001                                     04S0121 00752000
*                           DRDACCP=SADRDACC(SAP)+(DRC-1)*24;/* POINT   00753000
*                                      TO PROPER ACCUMULATOR ROW FOR    00754000
*                                      THIS DRC              @Y30LB52*/ 00755000
         LH    @08,DRC                                          04S0122 00756000
         BCTR  @08,0                                            04S0122 00757000
         MH    @08,@CH00210                                     04S0122 00758000
         AL    @08,@TF00001                                     04S0122 00759000
         ST    @08,DRDACCP                                      04S0122 00760000
*                           ACCPTR=ADDR(ACCUMTOT)+(SAP-1)*2;/*  04S0123 00761000
*                                      ADDRESS THE PROPER TOTAL FOR     00762000
*                                      THIS SA               @Y30LB52*/ 00763000
         LA    ACCPTR,ACCUMTOT                                  04S0123 00764000
         LR    @08,SAP                                          04S0123 00765000
         BCTR  @08,0                                            04S0123 00766000
         ALR   @08,@08                                          04S0123 00767000
         ALR   ACCPTR,@08                                       04S0123 00768000
*                           DO DRD=1 TO 4;/* LOOP THROUGH ALL   04S0124 00769000
*                                      DRD'S@Y30LB52 CONNECTED  04S0124 00770000
*                                                            @Y30LB52*/ 00771000
         LA    DRD,1                                            04S0124 00772000
@DL00124 DS    0H                                               04S0125 00773000
*                             RESPECIFY                         04S0125 00774000
*                               DRDACCS BASED(DRDACCP);/*    @Y30LB52*/ 00775000
*                             IF DRDACCS^='000000000000'X/* IF COUNTS   00776000
*                                      NON-ZERO              @Y30LB52*/ 00777000
*                               THEN                            04S0126 00778000
         L     @08,DRDACCP                                      04S0126 00779000
         CLC   DRDACCS(6,@08),@CB00313                          04S0126 00780000
         BE    @RF00126                                         04S0126 00781000
*                               DO; /* ADD TO TOTALS         @Y30LB52*/ 00782000
*                                 ACCUM1=ACCUM1+DRDERRS;/* ADD DRD      00783000
*                                      ERRORS                @Y30LB52*/ 00784000
         LH    @15,ACCUM1(,ACCPTR)                              04S0128 00785000
         AH    @15,DRDERRS(,@08)                                04S0128 00786000
         STH   @15,ACCUM1(,ACCPTR)                              04S0128 00787000
*                                 ACCUM1=ACCUM1+CTLIERRS;/* ADD CTLI    00788000
*                                      ERRORS@Y30LB52        @Y30LB52*/ 00789000
         AH    @15,CTLIERRS(,@08)                               04S0129 00790000
         STH   @15,ACCUM1(,ACCPTR)                              04S0129 00791000
*                                 ACCUM1=ACCUM1+DRCERRS;/* ADD DRC      00792000
*                                      ERRORS                @Y30LB52*/ 00793000
         AH    @15,DRCERRS(,@08)                                04S0130 00794000
         STH   @15,ACCUM1(,ACCPTR)                              04S0130 00795000
*                               END;/*                       @Y30LB52*/ 00796000
*                             DRDACCP=DRDACCP+6;/* STEP TO NEXT DRD     00797000
*                                      ELEMENT               @YM32170*/ 00798000
@RF00126 LA    @08,6                                            04S0132 00799000
         AL    @08,DRDACCP                                      04S0132 00800000
         ST    @08,DRDACCP                                      04S0132 00801000
*                           END;    /*                       @Y30LB52*/ 00802000
         AH    DRD,@CH00045                                     04S0133 00803000
         CH    DRD,@CH00055                                     04S0133 00804000
         BNH   @DL00124                                         04S0133 00805000
*                         END;      /*                       @Y30LB52*/ 00806000
*                     END;          /*                       @Y30LB52*/ 00807000
@RF00120 DS    0H                                               04S0136 00808000
*                 END;              /*                       @Y30LB52*/ 00809000
@RF00116 LA    @08,1                                            04S0136 00810000
         AH    @08,MSC                                          04S0136 00811000
         STH   @08,MSC                                          04S0136 00812000
         CH    @08,@CH00099                                     04S0136 00813000
         BNH   @DL00115                                         04S0136 00814000
@DC00115 DS    0H                                               04S0137 00815000
*               END;                /*                       @Y30LB52*/ 00816000
*                                                               03S0137 00817000
         AH    K,@CH00045                                       03S0137 00818000
         CH    K,@CH00106                                       03S0137 00819000
         BNH   @DL00110                                         03S0137 00820000
@DC00110 DS    0H                                               03S0138 00821000
*               /*****************************************************/ 00822000
*               /*                                                   */ 00823000
*               /* THE FOLLOWING CODE FORMATS AND PRINTS THE         */ 00824000
*               /* ACCUMULATED TOTALS FOR A DRC AND ITS SA           */ 00825000
*               /* ATTACHMENTS.                                      */ 00826000
*               /*                                                   */ 00827000
*               /*****************************************************/ 00828000
*                                                               03S0138 00829000
*               RTOTAL=0;           /* CLEAR THE ROW TOTAL   @Y30LB52*/ 00830000
         SLR   @08,@08                                          03S0138 00831000
         STH   @08,RTOTAL                                       03S0138 00832000
*               OUTLINE=SKIPONE;    /* SKIP ONE LINE CC      @Y30LB52*/ 00833000
         MVI   OUTLINE+1(CVTPTR),C' '                           03S0139 00834000
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          03S0139 00835000
         MVI   OUTLINE(CVTPTR),C' '                             03S0139 00836000
*               DRC1='400';         /* SET THE ROW DRC SSID  @Y30LB52*/ 00837000
         MVC   DRC1(3,CVTPTR),@CC00316                          03S0140 00838000
*               DRC11=(I-1)|DRC11;  /* OR IN THE LIBRARY NUMBER 03S0141 00839000
*                                                            @Y30LB52*/ 00840000
         LR    @08,I                                            03S0141 00841000
         BCTR  @08,0                                            03S0141 00842000
         SLR   @04,@04                                          03S0141 00843000
         IC    @04,DRC11(,CVTPTR)                               03S0141 00844000
         OR    @08,@04                                          03S0141 00845000
         STC   @08,DRC11(,CVTPTR)                               03S0141 00846000
*               DRC12=DRC12|(J-1);  /* INSERT THE DRC NUMBER @Y30LB52*/ 00847000
         L     @08,J                                            03S0142 00848000
         BCTR  @08,0                                            03S0142 00849000
         SLR   @04,@04                                          03S0142 00850000
         IC    @04,DRC12(,CVTPTR)                               03S0142 00851000
         OR    @08,@04                                          03S0142 00852000
         STC   @08,DRC12(,CVTPTR)                               03S0142 00853000
*               ACCPTR=ADDR(ACCUMTOT);/* POINTER TO FIRST ACCUMULATOR   00854000
*                                                            @Y30LB52*/ 00855000
         LA    ACCPTR,ACCUMTOT                                  03S0143 00856000
*               DO K=1 TO 16;       /* LOOP THROUGH ALL SA'S @Y30LB52*/ 00857000
         LA    K,1                                              03S0144 00858000
@DL00144 DS    0H                                               03S0145 00859000
*                 IF VSADRC(K)='FF'X/* ONLY THE VALID SA/DRC @Y30LB52   00860000
*                                      CONNECTIONS           @Y30LB52*/ 00861000
*                   THEN                                        03S0145 00862000
         LA    @08,VSADRC-1(K)                                  03S0145 00863000
         CLI   0(@08),X'FF'                                     03S0145 00864000
         BNE   @RF00145                                         03S0145 00865000
*                   DO;             /* WILL HAVE TOTALS      @Y30LB52*/ 00866000
*                     RTOTAL=RTOTAL+ACCUM1;/* INCREMENT ROW TOTAL       00867000
*                                                            @Y30LB52*/ 00868000
         LH    @08,ACCUM1(,ACCPTR)                              03S0147 00869000
         LH    @15,RTOTAL                                       03S0147 00870000
         ALR   @15,@08                                          03S0147 00871000
         STH   @15,RTOTAL                                       03S0147 00872000
*                     LTOTAL(K)=LTOTAL(K)+ACCUM1;/* INCREMENT COLUMN    00873000
*                                      TOTAL                 @Y30LB52*/ 00874000
*                                                               03S0148 00875000
         LR    @15,K                                            03S0148 00876000
         ALR   @15,@15                                          03S0148 00877000
         LH    @14,LTOTAL-2(@15)                                03S0148 00878000
         ALR   @14,@08                                          03S0148 00879000
         STH   @14,LTOTAL-2(@15)                                03S0148 00880000
*                     /***********************************************/ 00881000
*                     /*                                             */ 00882000
*                     /* CONVERT TOTAL TO EBCDIC AND STORE IN OUTPUT */ 00883000
*                     /* LINE                                        */ 00884000
*                     /*                                             */ 00885000
*                     /***********************************************/ 00886000
*                                                               03S0149 00887000
*                     CVD(ACCUM1,DECNO);/* CONVERT BINARY STRING TO     00888000
*                                      DECIMAL               @Y30LB52*/ 00889000
         CVD   @08,DECNO                                        03S0149 00890000
*                     DRC3(K)=EDITPAT3;/* MOVE EDIT PATTERN  @ZM34326*/ 00891000
         LR    @08,K                                            03S0150 00892000
         MH    @08,@CH00101                                     03S0150 00893000
         ST    @08,@TF00001                                     03S0150 00894000
         ALR   @08,CVTPTR                                       03S0150 00895000
         MVC   DRC3-5(4,@08),EDITPAT3                           03S0150 00896000
*                     ED(DRC3(K),DECNO1);/* CONVERT TO PRINTABLE HEX    00897000
*                                                            @ZM34326*/ 00898000
         LR    @08,CVTPTR                                       03S0151 00899000
         AL    @08,@TF00001                                     03S0151 00900000
         ED    DRC3-5(4,@08),DECNO1                             03S0151 00901000
*                   END;            /*                       @Y30LB52*/ 00902000
*                 ELSE                                          03S0153 00903000
*                   DRC3(K)=ASKT4;  /* INDICATE NO CONNECTION@ZM34326*/ 00904000
         B     @RC00145                                         03S0153 00905000
@RF00145 LR    @08,K                                            03S0153 00906000
         MH    @08,@CH00101                                     03S0153 00907000
         ALR   @08,CVTPTR                                       03S0153 00908000
         MVC   DRC3-5(4,@08),@CC00067                           03S0153 00909000
*                 ACCPTR=ACCPTR+2;  /* INCREMENT TO NEXT     @Y30LB52*/ 00910000
@RC00145 AH    ACCPTR,@CH00106                                  03S0154 00911000
*               END;                /*                       @Y30LB52*/ 00912000
         AH    K,@CH00045                                       03S0155 00913000
         CH    K,@CH00084                                       03S0155 00914000
         BNH   @DL00144                                         03S0155 00915000
*               GTOTAL=GTOTAL+RTOTAL;/* INCREMENT THE ROW TOTAL 03S0156 00916000
*                                                            @Y30LB52*/ 00917000
         LH    @08,RTOTAL                                       03S0156 00918000
         LH    @04,GTOTAL                                       03S0156 00919000
         ALR   @04,@08                                          03S0156 00920000
         STH   @04,GTOTAL                                       03S0156 00921000
*               CVD(RTOTAL,DECNO);  /* CONVERT BINARY STRING TO 03S0157 00922000
*                                      DECIMAL               @ZA00699*/ 00923000
         CVD   @08,DECNO                                        03S0157 00924000
*               DRCTOT=EDITPAT5;    /* 5 DIGIT EDIT PATTERN  @ZA00699*/ 00925000
         MVC   DRCTOT(6,CVTPTR),EDITPAT5                        03S0158 00926000
*               ED(DRCTOT,DECNO2);  /* CONVERT TO PRINTABLE HEX 03S0159 00927000
*                                                            @ZA00699*/ 00928000
         ED    DRCTOT(6,CVTPTR),DECNO2                          03S0159 00929000
*               CALL P1PRINTL;      /*                       @Y30LB52*/ 00930000
         BAL   @14,P1PRINTL                                     03S0160 00931000
*             END;                  /*                       @Y30LB52*/ 00932000
         LA    @08,1                                            03S0161 00933000
         AL    @08,J                                            03S0161 00934000
@DE00107 ST    @08,J                                            03S0161 00935000
         L     @04,CNFG0PTR(,CVTPTR)                            03S0161 00936000
         SLR   @03,@03                                          03S0161 00937000
         IC    @03,LIBSIZS-1(I,@04)                             03S0161 00938000
         CR    @08,@03                                          03S0161 00939000
         BNH   @DL00107                                         03S0161 00940000
*                                                               03S0162 00941000
*             /*******************************************************/ 00942000
*             /*                                                     */ 00943000
*             /* FORMAT AND PRINT THE LINE CONTAINING COLUMN TOTALS  */ 00944000
*             /* AND THE GRAND TOTAL                                 */ 00945000
*             /*                                                     */ 00946000
*             /*******************************************************/ 00947000
*                                                               03S0162 00948000
*             OUTLINE=SKIPTWO;      /* SKIP TWO BEFORE PRINTING 03S0162 00949000
*                                                            @Y30LB52*/ 00950000
         MVI   OUTLINE+1(CVTPTR),C' '                           03S0162 00951000
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          03S0162 00952000
         MVI   OUTLINE(CVTPTR),C'0'                             03S0162 00953000
*             DRC2='TOTAL';         /* SET ROW CONSTANT      @Y30LB52*/ 00954000
         MVC   DRC2(5,CVTPTR),@CC00240                          03S0163 00955000
*             DO K=1 TO 16;         /* LOOP THROUGH ALL SA'S @Y30LB52*/ 00956000
         LA    K,1                                              03S0164 00957000
@DL00164 DS    0H                                               03S0165 00958000
*               IF LTOTAL(K)^=0     /* COLUMN TOTAL ZERO?    @Y30LB52*/ 00959000
*                 THEN                                          03S0165 00960000
         LR    @08,K                                            03S0165 00961000
         ALR   @08,@08                                          03S0165 00962000
         LH    @08,LTOTAL-2(@08)                                03S0165 00963000
         LTR   @08,@08                                          03S0165 00964000
         BZ    @RF00165                                         03S0165 00965000
*                 DO;               /* PRINT THE TOTAL       @Y30LB52*/ 00966000
*                   CVD(LTOTAL(K),DECNO);/* CONVERT BINARY STRING TO    00967000
*                                      DECIMAL               @Y30LB52*/ 00968000
         CVD   @08,DECNO                                        03S0167 00969000
*                   DRC3(K)=EDITPAT3;/* MOVE EDIT PATTERN    @ZM34326*/ 00970000
         LR    @08,K                                            03S0168 00971000
         MH    @08,@CH00101                                     03S0168 00972000
         ST    @08,@TF00001                                     03S0168 00973000
         ALR   @08,CVTPTR                                       03S0168 00974000
         MVC   DRC3-5(4,@08),EDITPAT3                           03S0168 00975000
*                   ED(DRC3(K),DECNO1);/* CONVERT TO PRINTABLE HEX      00976000
*                                                            @ZM34326*/ 00977000
         LR    @08,CVTPTR                                       03S0169 00978000
         AL    @08,@TF00001                                     03S0169 00979000
         ED    DRC3-5(4,@08),DECNO1                             03S0169 00980000
*                 END;              /*                       @Y30LB52*/ 00981000
*             END;                  /*                       @Y30LB52*/ 00982000
*                                                               03S0171 00983000
@RF00165 AH    K,@CH00045                                       03S0171 00984000
         CH    K,@CH00084                                       03S0171 00985000
         BNH   @DL00164                                         03S0171 00986000
*             /*******************************************************/ 00987000
*             /*                                                     */ 00988000
*             /* ADD THE GRAND TOTAL AND PRINT                       */ 00989000
*             /*                                                     */ 00990000
*             /*******************************************************/ 00991000
*                                                               03S0172 00992000
*             CVD(GTOTAL,DECNO);    /* CONVERT BINARY STRING TO 03S0172 00993000
*                                      DECIMAL               @ZA00699*/ 00994000
         LH    @08,GTOTAL                                       03S0172 00995000
         CVD   @08,DECNO                                        03S0172 00996000
*             DRCTOT=EDITPAT5;      /* 5 DIGIT EDIT PATTERN  @ZA00699*/ 00997000
         MVC   DRCTOT(6,CVTPTR),EDITPAT5                        03S0173 00998000
*             ED(DRCTOT,DECNO2);    /* CONVERT TO PRINTABLE HEX 03S0174 00999000
*                                                            @ZA00699*/ 01000000
         ED    DRCTOT(6,CVTPTR),DECNO2                          03S0174 01001000
*             CALL P1PRINTL;        /*                       @Y30LB52*/ 01002000
         BAL   @14,P1PRINTL                                     03S0175 01003000
*             DCL                                               03S0176 01004000
*                                                               03S0176 01005000
*               /*****************************************************/ 01006000
*               /*                                                   */ 01007000
*               /* THE FOLLOWING STRUCTURE MAPS THE OUTPUT LINE FOR  */ 01008000
*               /* THE PURPOSE OF INSERTING DRC NUMBERS AND          */ 01009000
*               /* ACCUMULATOR TOTALS.                               */ 01010000
*               /*                                                   */ 01011000
*               /*****************************************************/ 01012000
*                                                               03S0176 01013000
*               1 * DEF(OUTLINE),   /*                       @Y30LB52*/ 01014000
*                2 * CHAR(10),      /*                       @Y30LB52*/ 01015000
*                2 DRC1 CHAR(3),    /* DRC SSID              @Y30LB52*/ 01016000
*                 3 * CHAR(1),      /*                       @Y30LB52*/ 01017000
*                 3 DRC11 CHAR(1),  /* LIBRARY NUMBER        @Y30LB52*/ 01018000
*                 3 DRC12 CHAR(1),  /* DRC NUMBER            @Y30LB52*/ 01019000
*                2 * CHAR(1),       /*                       @Y30LB52*/ 01020000
*                2 DRC2 CHAR(5),    /* 'TOTAL' CONSTANT      @Y30LB52*/ 01021000
*                2 *(16) CHAR(5),   /* COLUMN VALUES         @Y30LB52*/ 01022000
*                 3 DRC3 CHAR(4),   /* ACTUAL EBCDIC VALUE   @ZM34326*/ 01023000
*                 3 * CHAR(1),      /* SEPARATOR BLANKS      @ZM34326*/ 01024000
*                2 DRCTOT CHAR(6),  /* EBCDIC ROW TOTAL      @ZA00699*/ 01025000
*               VSADRC CHAR(16);    /* VECTOR USED TO INDICATE WHICH    01026000
*                                      SA/DRC CONNECTIONS EXIST TO      01027000
*                                      THE OUTPUT PROCESS. UNUSED       01028000
*                                      CONNECTIONS ARE SKIPPED. 03S0176 01029000
*                                                            @Y30LB52*/ 01030000
*           END;                    /*                       @Y30LB52*/ 01031000
*       END;                        /*                       @Y30LB52*/ 01032000
@RF00087 AH    I,@CH00045                                       02S0178 01033000
@DE00086 L     @08,CNFG0PTR(,CVTPTR)                            02S0178 01034000
         CH    I,MSFNO(,@08)                                    02S0178 01035000
         BNH   @DL00086                                         02S0178 01036000
*       DCL                                                     02S0179 01037000
*                                                               02S0179 01038000
*         /***********************************************************/ 01039000
*         /*                                                         */ 01040000
*         /* THIS STRUCTURE DEFINES THE 'SA/DRC' REPORT ARRAY HEADER.*/ 01041000
*         /*                                                         */ 01042000
*         /***********************************************************/ 01043000
*                                                               02S0179 01044000
*         1 SADRCHD STATIC LOCAL,   /* SA/DRC HEADER         @Y30LB52*/ 01045000
*          2 * CHAR(1) INIT(SKIP3), /* SKIP 3 LINES CC       @Y30LB52*/ 01046000
*          2 * CHAR(3) INIT('   '), /*                       @Y30LB52*/ 01047000
*          2 * CHAR(50) INIT(                                   02S0179 01048000
*                'SA/DRC INTERFACE ERROR COUNTS               MSF 0 '); 01049000
*                                                               01S0180 01050000
*       /*************************************************************/ 01051000
*       /*                                                           */ 01052000
*       /* THIS CODE GENERATES THE DRC/DRD INTERFACE ARRAY FOR THE   */ 01053000
*       /* ERRORS RECORDED IN THE DRC/DRD PATHS.                     */ 01054000
*       /*                                                           */ 01055000
*       /*************************************************************/ 01056000
*                                                               01S0180 01057000
*                                                               02S0180 01058000
*       /*************************************************************/ 01059000
*       /*                                                           */ 01060000
*       /* THIS SEGMENT PRODUCES THE DRC/DRD INTERFACE PORTION OF THE*/ 01061000
*       /* PATH ANALYSIS REPORT FOR DRD'S. ONE PRINTED ARRAY IS      */ 01062000
*       /* PRODUCED FOR EACH CARTRIDGE STORE ON THE SUBSYSTEM. A NEW */ 01063000
*       /* PAGE IS EJECTED AND THE MAIN PATH ANALYSIS HEADER IS      */ 01064000
*       /* PRINTED.                                                  */ 01065000
*       /*                                                           */ 01066000
*       /*************************************************************/ 01067000
*                                                               02S0180 01068000
*       OUTLINE=NEWPAGE;            /* SET PAGE EJECT CC     @Y30LB52*/ 01069000
         MVI   OUTLINE+1(CVTPTR),C' '                           02S0180 01070000
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          02S0180 01071000
         MVI   OUTLINE(CVTPTR),C'1'                             02S0180 01072000
*       CALL P1PRINTL;              /* PRINT THE LINE        @Y30LB52*/ 01073000
         BAL   @14,P1PRINTL                                     02S0181 01074000
*       OUTLINE=DRDHEAD;            /* CONSTANT HEADER FOR DRC/DRD      01075000
*                                                            @Y30LB52*/ 01076000
         MVI   OUTLINE+76(CVTPTR),C' '                          02S0182 01077000
         MVC   OUTLINE+77(56,CVTPTR),OUTLINE+76(CVTPTR)         02S0182 01078000
         MVC   OUTLINE(76,CVTPTR),DRDHEAD                       02S0182 01079000
*       CALL P1PRINTL;              /* PRINT THE LINE        @Y30LB52*/ 01080000
*                                                               02S0183 01081000
         BAL   @14,P1PRINTL                                     02S0183 01082000
*       /*************************************************************/ 01083000
*       /*                                                           */ 01084000
*       /* A SEPARATE ARRAY IS PRODUCED FOR EACH CARTRIDGE STORE     */ 01085000
*       /* ATTACHED, UP TO FOUR LIBRARIES.                           */ 01086000
*       /*                                                           */ 01087000
*       /*************************************************************/ 01088000
*                                                               02S0184 01089000
*       DO MSF=1 TO MSFNO;          /* LOOP THROUGH ALL LIBRARIES       01090000
*                                                            @Y30LB52*/ 01091000
         LA    @08,1                                            02S0184 01092000
         B     @DE00184                                         02S0184 01093000
@DL00184 DS    0H                                               02S0185 01094000
*         IF CSFTOTAL(MSF)^=0       /* IF NO ERRORS RECORDED @Y30LB52*/ 01095000
*           THEN                                                02S0185 01096000
         LR    @03,@08                                          02S0185 01097000
         ALR   @03,@03                                          02S0185 01098000
         L     @01,PAD00PTR(,CVTPTR)                            02S0185 01099000
         LH    @03,CSFTOTAL-2(@03,@01)                          02S0185 01100000
         LTR   @03,@03                                          02S0185 01101000
         BZ    @RF00185                                         02S0185 01102000
*           DO;                     /* SKIP THE MSF          @Y30LB52*/ 01103000
*                                                               02S0186 01104000
*             /*******************************************************/ 01105000
*             /*                                                     */ 01106000
*             /* FOR EACH CARTRIDGE STORE ARRAY, A MAIN DRC/DRD      */ 01107000
*             /* HEADER IS PRODUCED WITH THE SSID OF THE CS.         */ 01108000
*             /*                                                     */ 01109000
*             /*******************************************************/ 01110000
*                                                               02S0187 01111000
*             OUTLINE=DRCDRDHD;     /* MOVE IN CONSTANT HEADER  02S0187 01112000
*                                                            @Y30LB52*/ 01113000
         MVI   OUTLINE+55(CVTPTR),C' '                          02S0187 01114000
         MVC   OUTLINE+56(77,CVTPTR),OUTLINE+55(CVTPTR)         02S0187 01115000
         MVC   OUTLINE(55,CVTPTR),DRCDRDHD                      02S0187 01116000
*             OUTLINE(53)=(MSF-1)|'0';/* OR IN THE CS INDEX  @Y30LB52*/ 01117000
         BCTR  @08,0                                            02S0188 01118000
         O     @08,@CF00073                                     02S0188 01119000
         STC   @08,OUTLINE+52(,CVTPTR)                          02S0188 01120000
*             CALL P1PRINTL;        /* PRINT THE LINE        @Y30LB52*/ 01121000
*                                                               02S0189 01122000
         BAL   @14,P1PRINTL                                     02S0189 01123000
*             /*******************************************************/ 01124000
*             /*                                                     */ 01125000
*             /* THE ARRAY HEADER LINE IS PRINTED WITH SSID'S OF THE */ 01126000
*             /* DRD'S.                                              */ 01127000
*             /*                                                     */ 01128000
*             /*******************************************************/ 01129000
*                                                               02S0190 01130000
*             OUTLINE=SKIP3;        /* SET SKIP 3 LINES CC   @Y30LB52*/ 01131000
         MVI   OUTLINE+1(CVTPTR),C' '                           02S0190 01132000
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          02S0190 01133000
         MVI   OUTLINE(CVTPTR),C'-'                             02S0190 01134000
*             DRCD1(1:3)='DRD';     /* SET DRD COLUMN CONSTAN@Y30LB52*/ 01135000
         MVC   DRCD1(3,CVTPTR),@CC00338                         02S0191 01136000
*             DO I=1 TO 8;          /* LOOP THROUGH 8 DRD'S  @Y30LB52*/ 01137000
         LA    I,1                                              02S0192 01138000
@DL00192 DS    0H                                               02S0193 01139000
*               DRCD2(I)=' 200';    /* SET CONSTANT          @ZM34326*/ 01140000
         LR    @08,I                                            02S0193 01141000
         MH    @08,@CH00101                                     02S0193 01142000
         ST    @08,@TF00001                                     02S0193 01143000
         ALR   @08,CVTPTR                                       02S0193 01144000
         MVC   DRCD2-5(4,@08),@CC00340                          02S0193 01145000
*               DRCD2L(I)=(MSF-1)|'0';/* OR IN MSF NUMBER    @Y30LB52*/ 01146000
         LA    @08,240                                          02S0194 01147000
         LH    @04,MSF                                          02S0194 01148000
         BCTR  @04,0                                            02S0194 01149000
         OR    @04,@08                                          02S0194 01150000
         L     @03,@TF00001                                     02S0194 01151000
         STC   @04,DRCD2L-5(@03,CVTPTR)                         02S0194 01152000
*               DRCD2R(I)=(I-1)|'0';/* OR IN DRD NUMBER      @Y30LB52*/ 01153000
         LR    @04,I                                            02S0195 01154000
         BCTR  @04,0                                            02S0195 01155000
         OR    @04,@08                                          02S0195 01156000
         L     @08,@TF00001                                     02S0195 01157000
         STC   @04,DRCD2R-5(@08,CVTPTR)                         02S0195 01158000
*             END;                  /*                       @Y30LB52*/ 01159000
         AH    I,@CH00045                                       02S0196 01160000
         CH    I,@CH00099                                       02S0196 01161000
         BNH   @DL00192                                         02S0196 01162000
*             CALL P1PRINTL;        /* PRINT THE LINE        @Y30LB52*/ 01163000
         BAL   @14,P1PRINTL                                     02S0197 01164000
*             OUTLINE=SKIPONE;      /*                       @Y30LB52*/ 01165000
         MVI   OUTLINE+1(CVTPTR),C' '                           02S0198 01166000
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          02S0198 01167000
         MVI   OUTLINE(CVTPTR),C' '                             02S0198 01168000
*             ODRC='DRC';           /* SET DRC CONSTANT HEADER  02S0199 01169000
*                                                            @Y30LB52*/ 01170000
         MVC   ODRC(3,CVTPTR),@CC00307                          02S0199 01171000
*             OUTLINE(65:69)='TOTAL';/*                      @ZA00699*/ 01172000
         MVC   OUTLINE+64(5,CVTPTR),@CC00240                    02S0200 01173000
*             CALL P1PRINTL;        /* PRINT THE LINE        @Y30LB52*/ 01174000
*                                                               02S0201 01175000
         BAL   @14,P1PRINTL                                     02S0201 01176000
*             /*******************************************************/ 01177000
*             /*                                                     */ 01178000
*             /* THE FOLLOWING SEGMENT TOTALS THE COUNTS FOR THE     */ 01179000
*             /* ARRAY AND PRINTS THE VALUES.                        */ 01180000
*             /*                                                     */ 01181000
*             /*******************************************************/ 01182000
*                                                               02S0202 01183000
*                                                               03S0202 01184000
*             /*******************************************************/ 01185000
*             /*                                                     */ 01186000
*             /* THIS SEGMENT TOTALS, FORMATS AND PRINTS THE         */ 01187000
*             /* ACCUMULATED ERROR TOTALS FOR THE DRC/DRD ERROR      */ 01188000
*             /* ARRAYS IN THE PATH ANALYSIS REPORT. THE ACCUMULATED */ 01189000
*             /* ERRORS ARE AT THE BOTTOM OF A TREE STRUCTURE        */ 01190000
*             /* REPRESENTING THE TOTAL PATH HAVING THE ERRORS. THE  */ 01191000
*             /* ERRORS WERE ACCUMULATED BY LOGICAL ADDRESS(SA, DRC) */ 01192000
*             /* BUT ARE PRINTED IN THE REPORT BY PHYSICAL ADDRESS.  */ 01193000
*             /* FIRST THE SA'S ATTACHED TO EACH DRC IN A LIBRARY    */ 01194000
*             /* MUST BE DETERMINED TO ACCESS THE ACCUMULATOR TREE.  */ 01195000
*             /*                                                     */ 01196000
*             /*******************************************************/ 01197000
*                                                               03S0202 01198000
*             LTPDRDP=LTPAD+((MSF-1)*8);/* LOCATE THE PROPER SA/DRC     01199000
*                                      TABLE                 @Y30LB52*/ 01200000
         L     @08,CNFG0PTR(,CVTPTR)                            03S0202 01201000
         LH    @03,MSF                                          03S0202 01202000
         BCTR  @03,0                                            03S0202 01203000
         SLA   @03,3                                            03S0202 01204000
         AL    @03,LTPAD(,@08)                                  03S0202 01205000
         ST    @03,LTPDRDP                                      03S0202 01206000
*             TOTALS=TOTALS&&TOTALS;/* CLEAR TOTALS          @Y30LB52*/ 01207000
         XC    TOTALS(76),TOTALS                                03S0203 01208000
*             DO I=1 TO LIBSIZS(MSF);/* DEPENDING ON THE LIBRARY        01209000
*                                      SIZE, 1 TO 4 DRC'S ARE   03S0204 01210000
*                                      PROCESSED             @Y30LB52*/ 01211000
         LA    I,1                                              03S0204 01212000
         B     @DE00204                                         03S0204 01213000
@DL00204 DS    0H                                               03S0205 01214000
*               VSADRC=VSADRC&&VSADRC;/* CLEAR VALID INTERFACE FIELD    01215000
*                                                            @Y30LB52*/ 01216000
         XC    VSADRC(16),VSADRC                                03S0205 01217000
*               ACCUMTOT=ACCUMTOT&&ACCUMTOT;/* CLEAR ACCUM TOTALS       01218000
*                                                            @Y30LB52*/ 01219000
         XC    ACCUMTOT(32),ACCUMTOT                            03S0206 01220000
*               DO J=1 TO 2 WHILE(LTPDRC(I,J)^='FF'X);/* EACH   03S0207 01221000
*                                      PHYSICAL DRC MAY HAVE TWO SA     01222000
*                                      CONNECTIONS           @Y30LB52*/ 01223000
         LA    @08,1                                            03S0207 01224000
         ST    @08,J                                            03S0207 01225000
@DL00207 L     @04,LTPDRDP                                      03S0207 01226000
         LR    @03,I                                            03S0207 01227000
         ALR   @03,@03                                          03S0207 01228000
         ALR   @03,@08                                          03S0207 01229000
         ST    @03,@TF00001                                     03S0207 01230000
         ALR   @03,@04                                          03S0207 01231000
         AL    @03,@CF00662                                     03S0207 01232000
         CLI   LTPDRC(@03),X'FF'                                03S0207 01233000
         BE    @DC00207                                         03S0207 01234000
*                 SAP=LTPDRC(I,J);  /* EXTRACT THE SA/DRC BYTE  03S0208 01235000
*                                                            @Y30LB52*/ 01236000
         L     @08,@TF00001                                     03S0208 01237000
         AL    @04,@CF00662                                     03S0208 01238000
         SLR   @03,@03                                          03S0208 01239000
         IC    @03,LTPDRC(@08,@04)                              03S0208 01240000
         LR    SAP,@03                                          03S0208 01241000
*                 DRC=LTPDRC(I,J)&'0F'X;/* EXTRACT THE LOGICAL DRC      01242000
*                                      ADDRESS TO THE SA     @Y30LB52*/ 01243000
         N     @03,@CF00310                                     03S0209 01244000
         STH   @03,DRC                                          03S0209 01245000
*                 SAP=SAP/16+1;     /* SA NUMBER +1          @Y30LB52*/ 01246000
*                                                               03S0210 01247000
         LA    @08,1                                            03S0210 01248000
         LR    @00,SAP                                          03S0210 01249000
         SRDA  @00,32                                           03S0210 01250000
         D     @00,@CF00084                                     03S0210 01251000
         ALR   @01,@08                                          03S0210 01252000
         LR    SAP,@01                                          03S0210 01253000
*                 /***************************************************/ 01254000
*                 /*                                                 */ 01255000
*                 /* THE FOLLOWING INCLUDED SEGMENT TOTALS ALL ERRORS*/ 01256000
*                 /* IN PATHS TO THE DRC SELECTED ABOVE.             */ 01257000
*                 /*                                                 */ 01258000
*                 /***************************************************/ 01259000
*                                                               03S0211 01260000
*                                                               04S0211 01261000
*                 /***************************************************/ 01262000
*                 /*                                                 */ 01263000
*                 /* THIS SEGMENT OF CODE TOTALS ALL ERRORS FOR THE  */ 01264000
*                 /* FOUR DRC/DRD INTERFACES FOR A PHYSICAL DRC. AT  */ 01265000
*                 /* THIS POINT IN THE CODE, ONE OF THE SA'S ATTACHED*/ 01266000
*                 /* TO THE DRC HAS BEEN SELECTED AND THE LOGICAL    */ 01267000
*                 /* CONNECTION OF THIS PHYSICAL DRC HAS BEEN        */ 01268000
*                 /* DETERMINED. LOOP THROUGH ALL MSC'S WITH         */ 01269000
*                 /* ACCUMULATED ERRORS                              */ 01270000
*                 /*                                                 */ 01271000
*                 /***************************************************/ 01272000
*                                                               04S0211 01273000
*                 DO MSC=1 TO 8 WHILE(MSCINTF(MSC)^='0000'X);/* 04S0211 01274000
*                                      TESTING FOR AN MSC ADDRESS       01275000
*                                                            @Y30LB52*/ 01276000
         STH   @08,MSC                                          04S0211 01277000
@DL00211 SLA   @08,3                                            04S0211 01278000
         L     @07,PAD00PTR(,CVTPTR)                            04S0211 01279000
         ST    @08,@TF00001                                     04S0211 01280000
         ALR   @08,@07                                          04S0211 01281000
         CLC   MSCINTF-8(2,@08),@CB00246                        04S0211 01282000
         BE    @DC00211                                         04S0211 01283000
*                   IF SATABPTR(MSC)^=0/* NON-ZERO SATAB        04S0212 01284000
*                                      POINTER@Y30LB52       @Y30LB52*/ 01285000
*                     THEN                                      04S0212 01286000
         L     @08,@TF00001                                     04S0212 01287000
         L     @08,SATABPTR-8(@08,@07)                          04S0212 01288000
         LTR   @08,@08                                          04S0212 01289000
         BZ    @RF00212                                         04S0212 01290000
*                     DO;           /* INDICATES ERRORS BELOW@Y30LB52   01291000
*                                                            @Y30LB52*/ 01292000
*                       RESPECIFY                               04S0214 01293000
*                         SADRDDSD BASED(SATABP);/*          @Y30LB52*/ 01294000
*                       SATABP=SATABPTR(MSC);/* LOAD THE SATAB BASE     01295000
*                                                            @Y30LB52*/ 01296000
         LR    SATABP,@08                                       04S0215 01297000
*                       DRDACCP=SADRDACC(SAP);/* PTR TO ACCUMULATOR     01298000
*                                                            @Y30LB52*/ 01299000
*                                                               04S0216 01300000
         LR    @08,SAP                                          04S0216 01301000
         SLA   @08,3                                            04S0216 01302000
         AL    @08,@CF00660                                     04S0216 01303000
         L     @08,SADRDACC(@08,SATABP)                         04S0216 01304000
         ST    @08,DRDACCP                                      04S0216 01305000
*                       /*********************************************/ 01306000
*                       /*                                           */ 01307000
*                       /* THE FOUR LOGICAL DRD'S ATTACHED TO THE DRC*/ 01308000
*                       /* ARE DETERMINED AND THE PHYSICAL DRD NUMBER*/ 01309000
*                       /* USED TO UPDATE THE PROPER ACCUMULATOR     */ 01310000
*                       /* TOTAL. A SINGLE ROW OF THE ACCUMULATOR    */ 01311000
*                       /* ARRAY CONTAINS THE ERROR COUNTS FOR THESE */ 01312000
*                       /* DRD'S. THE PHYSICAL DRD CORRESPONDING TO  */ 01313000
*                       /* EACH LOGICAL DRD IS DETERMINED FROM THE   */ 01314000
*                       /* 'DRDS' TABLE. THIS BASED TABLE CONTAINS   */ 01315000
*                       /* THE PHYSICAL DRD NUMBER FOR EACH LOGICAL  */ 01316000
*                       /* DRD ATTACHMENT FOR A DRC.                 */ 01317000
*                       /*                                           */ 01318000
*                       /*********************************************/ 01319000
*                                                               04S0217 01320000
*                       DRDSPTR=MSFAN(LIBSIZS(MSF))+(I-1)*4;/*  04S0217 01321000
*                                                            @Y30LB52   01322000
*                                      LOAD THE PHYSICAL DRD TABLE      01323000
*                                      POINTER               @Y30LB52*/ 01324000
         LH    @08,MSF                                          04S0217 01325000
         L     @07,CNFG0PTR(,CVTPTR)                            04S0217 01326000
         SLR   @04,@04                                          04S0217 01327000
         IC    @04,LIBSIZS-1(@08,@07)                           04S0217 01328000
         SLA   @04,2                                            04S0217 01329000
         LR    @08,I                                            04S0217 01330000
         BCTR  @08,0                                            04S0217 01331000
         SLA   @08,2                                            04S0217 01332000
         AL    @08,MSFAN-4(@04)                                 04S0217 01333000
         ST    @08,DRDSPTR                                      04S0217 01334000
*                       DO K=1 TO 4;/* LOOP THROUGH 4 POSSIBLE  04S0218 01335000
*                                      ATTACHED DRD'S        @Y30LB52*/ 01336000
         LA    K,1                                              04S0218 01337000
@DL00218 DS    0H                                               04S0219 01338000
*                         VSADRC(DRDS(K)+1)='FF'X;/* INDICATE VALID     01339000
*                                      INTERFACE             @Y30LB52*/ 01340000
         L     @08,DRDSPTR                                      04S0219 01341000
         AL    @08,@CF00663                                     04S0219 01342000
         SLR   @07,@07                                          04S0219 01343000
         IC    @07,DRDS(K,@08)                                  04S0219 01344000
         LA    @08,VSADRC(@07)                                  04S0219 01345000
         MVI   0(@08),X'FF'                                     04S0219 01346000
*                         IF DRDACCP^=0 THEN/* CHECK IF ERRORS  04S0220 01347000
*                                                            @ZM34326*/ 01348000
         L     @08,DRDACCP                                      04S0220 01349000
         LTR   @08,@08                                          04S0220 01350000
         BZ    @RF00220                                         04S0220 01351000
*                           DO;     /* ARE RECORDED          @ZM34326*/ 01352000
         ST    @07,@TF00001                                     04S0221 01353000
*                             RESPECIFY                         04S0222 01354000
*                               DRDACCTB BASED(DRDACCP);/*   @Y30LB52*/ 01355000
*                             RESPECIFY                         04S0223 01356000
*                               DRDACCS BASED(L);/*          @Y30LB52*/ 01357000
*                             L=ADDR(DRDACCTB(DRC,K));/* LOAD   04S0224 01358000
*                                      ACCUMULATOR'S ADDRESS @Y30LB52*/ 01359000
         LH    @03,DRC                                          04S0224 01360000
         SLA   @03,2                                            04S0224 01361000
         ALR   @03,K                                            04S0224 01362000
         MH    @03,@CH00058                                     04S0224 01363000
         AL    @08,@CF00664                                     04S0224 01364000
         LA    L,DRDACCTB(@03,@08)                              04S0224 01365000
*                             IF DRDACCS^='000000000000'X/*     04S0225 01366000
*                                      ACCUMULATED ERROR TOTALS 04S0225 01367000
*                                      NON-ZERO              @Y30LB52*/ 01368000
*                               THEN                            04S0225 01369000
         CLC   DRDACCS(6,L),@CB00313                            04S0225 01370000
         BE    @RF00225                                         04S0225 01371000
*                               DO; /* ADD TO TOTALS FOR DRD @Y30LB52*/ 01372000
*                                 ACCPTR=ADDR(ACCUMTOT)+DRDS(K)*2;/*    01373000
*                                      LOAD TOTALS POINTER   @Y30LB52*/ 01374000
         LA    ACCPTR,ACCUMTOT                                  04S0227 01375000
         L     @08,@TF00001                                     04S0227 01376000
         ALR   @08,@08                                          04S0227 01377000
         ALR   ACCPTR,@08                                       04S0227 01378000
*                                 ACCUM1=ACCUM1+DRDERRS;/* ADD DRD      01379000
*                                      ERRORS                @Y30LB52*/ 01380000
         LH    @08,ACCUM1(,ACCPTR)                              04S0228 01381000
         AH    @08,DRDERRS(,L)                                  04S0228 01382000
         STH   @08,ACCUM1(,ACCPTR)                              04S0228 01383000
*                                 ACCUM1=ACCUM1+CTLIERRS;/* ADD CTLI    01384000
*                                      ERRORS@Y30LB52        @Y30LB52*/ 01385000
         AH    @08,CTLIERRS(,L)                                 04S0229 01386000
         STH   @08,ACCUM1(,ACCPTR)                              04S0229 01387000
*                                 ACCUM1=ACCUM1+DRCERRS;/* ADD DRC      01388000
*                                      ERRORS                @Y30LB52*/ 01389000
         AH    @08,DRCERRS(,L)                                  04S0230 01390000
         STH   @08,ACCUM1(,ACCPTR)                              04S0230 01391000
*                               END;/*                       @Y30LB52*/ 01392000
*                           END;    /*                       @Y30LB52*/ 01393000
@RF00225 DS    0H                                               04S0233 01394000
*                       END;        /*                       @Y30LB52*/ 01395000
@RF00220 AH    K,@CH00045                                       04S0233 01396000
         CH    K,@CH00055                                       04S0233 01397000
         BNH   @DL00218                                         04S0233 01398000
*                     END;          /*                       @Y30LB52*/ 01399000
*                 END;              /*                       @Y30LB52*/ 01400000
@RF00212 LA    @08,1                                            04S0235 01401000
         AH    @08,MSC                                          04S0235 01402000
         STH   @08,MSC                                          04S0235 01403000
         CH    @08,@CH00099                                     04S0235 01404000
         BNH   @DL00211                                         04S0235 01405000
@DC00211 DS    0H                                               04S0236 01406000
*                 DCL                                           04S0236 01407000
*                   DRDSPTR PTR(31),/* DRDS BASE             @Y30LB52*/ 01408000
*                   DRDS(4) FIXED(8) BASED(DRDSPTR),/* PHYSICAL DRD     01409000
*                                      NUMBERS CORRESPONDING TO 04S0236 01410000
*                                      LOGICAL DRD'S ATTACHED   04S0236 01411000
*                                                            @ZM34326*/ 01412000
*                   MSFAN(4) PTR(31) INIT(ADDR(MSFA1),ADDR(MSFA4),ADDR( 01413000
*                       MSFA3),ADDR(MSFA4)),/* POINTERS TO THE TABLES   01414000
*                                      CONTAINING THE DRDS ARRAYS       01415000
*                                                            @ZM34326*/ 01416000
*                                                               04S0236 01417000
*                   /*************************************************/ 01418000
*                   /*                                               */ 01419000
*                   /* THE FOLLOWING TABLES CONTAIN INTEGERS         */ 01420000
*                   /* CORRESPONDING PHYSICAL DRD'S TO LOGICAL DRD'S */ 01421000
*                   /* ATTACHED TO A DRC. EACH 4-BYTE ROW OF THE     */ 01422000
*                   /* ARRAY CONTAINS THE PHYSICAL DRD NUMBERS FOR   */ 01423000
*                   /* THE FOUR LOGICAL DRD'S ATTACHED TO A DRC.     */ 01424000
*                   /*                                               */ 01425000
*                   /*************************************************/ 01426000
*                                                               04S0236 01427000
*                   MSFA1(4) FIXED(8) INIT(0,1,0,1),/* A1 TABLE 04S0236 01428000
*                                                            @ZM34326*/ 01429000
*                   MSFA3(12) FIXED(8) INIT(0,1,4,5,2,3,0,1,4,5,2,3),   01430000
*                                                               04S0236 01431000
*/*      A3 TABLE                                            @ZA00681*/ 01432000
*                                                               04S0236 01433000
*                   MSFA4(16) FIXED(8) INIT(0,1,2,3,2,3,0,1,4,5,6,7,6,7 01434000
*                       ,4,5);                                  04S0236 01435000
*                                                               04S0236 01436000
*/* A2, A4 TABLE                                             @Y30LB52*/ 01437000
*                                                               04S0237 01438000
*               END;                /*                       @Y30LB52*/ 01439000
*                                                               03S0237 01440000
         LA    @08,1                                            03S0237 01441000
         AL    @08,J                                            03S0237 01442000
         ST    @08,J                                            03S0237 01443000
         CH    @08,@CH00106                                     03S0237 01444000
         BNH   @DL00207                                         03S0237 01445000
@DC00207 DS    0H                                               03S0238 01446000
*               /*****************************************************/ 01447000
*               /*                                                   */ 01448000
*               /* THE FOLLOWING CODE CONVERTS AND PRINTS THE ERROR  */ 01449000
*               /* COUNTS FOR THE DRC SELECTED ABOVE.                */ 01450000
*               /*                                                   */ 01451000
*               /*****************************************************/ 01452000
*                                                               03S0238 01453000
*               OUTLINE=SKIPONE;    /* SKIP ONE CC           @Y30LB52*/ 01454000
         MVI   OUTLINE+1(CVTPTR),C' '                           03S0238 01455000
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          03S0238 01456000
         MVI   OUTLINE(CVTPTR),C' '                             03S0238 01457000
*               ODRC='400';         /* INITIALIZE DRC NUMBER @Y30LB52*/ 01458000
         MVC   ODRC(3,CVTPTR),@CC00316                          03S0239 01459000
*               ODRCL=ODRCL|(MSF-1);/* SET LIBRARY PORTION OF SSID      01460000
*                                                            @Y30LB52*/ 01461000
         LH    @08,MSF                                          03S0240 01462000
         BCTR  @08,0                                            03S0240 01463000
         SLR   @04,@04                                          03S0240 01464000
         IC    @04,ODRCL(,CVTPTR)                               03S0240 01465000
         OR    @08,@04                                          03S0240 01466000
         STC   @08,ODRCL(,CVTPTR)                               03S0240 01467000
*               ODRCN=ODRCN|(I-1);  /* SET DRC NUMBER IN SSID@Y30LB52   01468000
*                                                            @Y30LB52*/ 01469000
         LR    @08,I                                            03S0241 01470000
         BCTR  @08,0                                            03S0241 01471000
         SLR   @04,@04                                          03S0241 01472000
         IC    @04,ODRCN(,CVTPTR)                               03S0241 01473000
         OR    @08,@04                                          03S0241 01474000
         STC   @08,ODRCN(,CVTPTR)                               03S0241 01475000
*               RTOTAL=0;           /* REINTIALIZE THE ROW TOTAL        01476000
*                                                            @Y30LB52*/ 01477000
         SLR   @08,@08                                          03S0242 01478000
         STH   @08,RTOTAL                                       03S0242 01479000
*               ACCPTR=ADDR(ACCUMTOT);/* INITIALIZE ACCUMULATOR TOTAL   01480000
*                                      BASE                  @Y30LB52*/ 01481000
         LA    ACCPTR,ACCUMTOT                                  03S0243 01482000
*               DO K=1 TO 8;        /* LOOP THROUGH 8 POSSIBLE DRD'S    01483000
*                                                            @Y30LB52*/ 01484000
         LA    K,1                                              03S0244 01485000
@DL00244 DS    0H                                               03S0245 01486000
*                 IF VSADRC(K)='FF'X/* IF VALID INTERFACE    @Y30LB52*/ 01487000
*                   THEN                                        03S0245 01488000
         LA    @08,VSADRC-1(K)                                  03S0245 01489000
         CLI   0(@08),X'FF'                                     03S0245 01490000
         BNE   @RF00245                                         03S0245 01491000
*                   DO;             /*                       @Y30LB52*/ 01492000
*                     CVD(ACCUM1,DECNO);/* CONVERT BINARY STRING TO     01493000
*                                      DECIMAL               @Y30LB52*/ 01494000
         LH    @08,ACCUM1(,ACCPTR)                              03S0247 01495000
         CVD   @08,DECNO                                        03S0247 01496000
*                     DRCD2(K)=EDITPAT3;/* MOVE EDIT PATTERN @ZM34326*/ 01497000
         LR    @15,K                                            03S0248 01498000
         MH    @15,@CH00101                                     03S0248 01499000
         ST    @15,@TF00001                                     03S0248 01500000
         ALR   @15,CVTPTR                                       03S0248 01501000
         MVC   DRCD2-5(4,@15),EDITPAT3                          03S0248 01502000
*                     ED(DRCD2(K),DECNO1);/* CONVERT TO PRINTABLE HEX   01503000
*                                                            @ZM34326*/ 01504000
         LR    @01,CVTPTR                                       03S0249 01505000
         AL    @01,@TF00001                                     03S0249 01506000
         ED    DRCD2-5(4,@01),DECNO1                            03S0249 01507000
*                     RTOTAL=ACCUM1+RTOTAL;/* INCREMTN THE ROW  03S0250 01508000
*                                      TOTAL@Y30LB52         @Y30LB52*/ 01509000
         LH    @15,RTOTAL                                       03S0250 01510000
         ALR   @15,@08                                          03S0250 01511000
         STH   @15,RTOTAL                                       03S0250 01512000
*                     LTOTAL(K)=LTOTAL(K)+ACCUM1;/* INCREMENT THE       01513000
*                                      COLUMN TOTAL          @Y30LB52*/ 01514000
         LR    @15,K                                            03S0251 01515000
         ALR   @15,@15                                          03S0251 01516000
         AH    @08,LTOTAL-2(@15)                                03S0251 01517000
         STH   @08,LTOTAL-2(@15)                                03S0251 01518000
*                   END;            /*                       @Y30LB52*/ 01519000
*                 ELSE                                          03S0253 01520000
*                   DRCD2(K)=ASKT4; /* SET NO INTERFACE IND. @ZM34326*/ 01521000
         B     @RC00245                                         03S0253 01522000
@RF00245 LR    @08,K                                            03S0253 01523000
         MH    @08,@CH00101                                     03S0253 01524000
         ALR   @08,CVTPTR                                       03S0253 01525000
         MVC   DRCD2-5(4,@08),@CC00067                          03S0253 01526000
*                 ACCPTR=ACCPTR+2;  /* STEP TO NEXT TOTAL    @Y30LB52*/ 01527000
@RC00245 AH    ACCPTR,@CH00106                                  03S0254 01528000
*               END;                /*                       @Y30LB52*/ 01529000
*                                                               03S0255 01530000
         AH    K,@CH00045                                       03S0255 01531000
         CH    K,@CH00099                                       03S0255 01532000
         BNH   @DL00244                                         03S0255 01533000
*               /*****************************************************/ 01534000
*               /*                                                   */ 01535000
*               /* CONVERT AND INSERT THE ROW TOTAL                  */ 01536000
*               /*                                                   */ 01537000
*               /*****************************************************/ 01538000
*                                                               03S0256 01539000
*               CVD(RTOTAL,DECNO);  /* CONVERT BINARY STRING TO 03S0256 01540000
*                                      DECIMAL               @ZA00699*/ 01541000
         LH    @08,RTOTAL                                       03S0256 01542000
         CVD   @08,DECNO                                        03S0256 01543000
*               DRCDRT=EDITPAT5;    /* 5 DIGIT EDIT PATTERN  @ZA00699*/ 01544000
         MVC   DRCDRT(6,CVTPTR),EDITPAT5                        03S0257 01545000
*               ED(DRCDRT,DECNO2);  /* CONVERT TO PRINTABLE HEX 03S0258 01546000
*                                                            @ZA00699*/ 01547000
         ED    DRCDRT(6,CVTPTR),DECNO2                          03S0258 01548000
*               CALL P1PRINTL;      /* PRINT THE LINE        @Y30LB52*/ 01549000
         BAL   @14,P1PRINTL                                     03S0259 01550000
*               GTOTAL=GTOTAL+RTOTAL;/* INCREMENT THE GRAND TOTAL       01551000
*                                                            @Y30LB52*/ 01552000
         LH    @08,GTOTAL                                       03S0260 01553000
         AH    @08,RTOTAL                                       03S0260 01554000
         STH   @08,GTOTAL                                       03S0260 01555000
*             END;                  /*                       @Y30LB52*/ 01556000
*                                                               03S0261 01557000
         AH    I,@CH00045                                       03S0261 01558000
@DE00204 LH    @08,MSF                                          03S0261 01559000
         L     @04,CNFG0PTR(,CVTPTR)                            03S0261 01560000
         SLR   @03,@03                                          03S0261 01561000
         IC    @03,LIBSIZS-1(@08,@04)                           03S0261 01562000
         CR    I,@03                                            03S0261 01563000
         BNH   @DL00204                                         03S0261 01564000
*             /*******************************************************/ 01565000
*             /*                                                     */ 01566000
*             /* FORMAT AND OUTPUT THE COLUMN TOTAL LINE             */ 01567000
*             /*                                                     */ 01568000
*             /*******************************************************/ 01569000
*                                                               03S0262 01570000
*             OUTLINE=SKIPTWO;      /* SKIP TWO LINES CC     @Y30LB52*/ 01571000
         MVI   OUTLINE+1(CVTPTR),C' '                           03S0262 01572000
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          03S0262 01573000
         MVI   OUTLINE(CVTPTR),C'0'                             03S0262 01574000
*             DRCD1='TOTAL';        /* SET ROW CONSTANT      @Y30LB52*/ 01575000
         MVC   DRCD1(5,CVTPTR),@CC00240                         03S0263 01576000
*             DO K=1 TO 8;          /* LOOP THROUGH 8 COLUMNS@Y30LB52   01577000
*                                                            @Y30LB52*/ 01578000
         LA    K,1                                              03S0264 01579000
@DL00264 DS    0H                                               03S0265 01580000
*               CVD(LTOTAL(K),DECNO);/* CONVERT BINARY STRING TO        01581000
*                                      DECIMAL               @Y30LB52*/ 01582000
         LR    @08,K                                            03S0265 01583000
         ALR   @08,@08                                          03S0265 01584000
         LH    @08,LTOTAL-2(@08)                                03S0265 01585000
         CVD   @08,DECNO                                        03S0265 01586000
*               DRCD2(K)=EDITPAT3;  /* MOVE EDIT PATTERN     @ZM34326*/ 01587000
         LR    @08,K                                            03S0266 01588000
         MH    @08,@CH00101                                     03S0266 01589000
         ST    @08,@TF00001                                     03S0266 01590000
         ALR   @08,CVTPTR                                       03S0266 01591000
         MVC   DRCD2-5(4,@08),EDITPAT3                          03S0266 01592000
*               ED(DRCD2(K),DECNO1);/* CONVERT TO PRINTABLE HEX 03S0267 01593000
*                                                            @ZM34326*/ 01594000
         LR    @08,CVTPTR                                       03S0267 01595000
         AL    @08,@TF00001                                     03S0267 01596000
         ED    DRCD2-5(4,@08),DECNO1                            03S0267 01597000
*             END;                  /*                       @Y30LB52*/ 01598000
         AH    K,@CH00045                                       03S0268 01599000
         CH    K,@CH00099                                       03S0268 01600000
         BNH   @DL00264                                         03S0268 01601000
*             CVD(GTOTAL,DECNO);    /* CONVERT BINARY STRING TO 03S0269 01602000
*                                      DECIMAL               @ZA00699*/ 01603000
         LH    @08,GTOTAL                                       03S0269 01604000
         CVD   @08,DECNO                                        03S0269 01605000
*             DRCDRT=EDITPAT5;      /* 5 DIGIT EDIT PATTERN  @ZA00699*/ 01606000
         MVC   DRCDRT(6,CVTPTR),EDITPAT5                        03S0270 01607000
*             ED(DRCDRT,DECNO2);    /* CONVERT TO PRINTABLE HEX 03S0271 01608000
*                                                            @ZA00699*/ 01609000
         ED    DRCDRT(6,CVTPTR),DECNO2                          03S0271 01610000
*             CALL P1PRINTL;        /* PRINT IT              @Y30LB52*/ 01611000
         BAL   @14,P1PRINTL                                     03S0272 01612000
*             DCL                                               03S0273 01613000
*                                                               03S0273 01614000
*               /*****************************************************/ 01615000
*               /*                                                   */ 01616000
*               /* THE FOLLOWING STRUCTURE MAPS THE OUTPUT LINE AND  */ 01617000
*               /* IS USED FOR INSERTING THE FORMATTED ROW VALUES AND*/ 01618000
*               /* TOTALS.                                           */ 01619000
*               /*                                                   */ 01620000
*               /*****************************************************/ 01621000
*                                                               03S0273 01622000
*               1 * DEF(OUTLINE),   /*                       @Y30LB52*/ 01623000
*                2 * CHAR(10),      /*                       @Y30LB52*/ 01624000
*                2 ODRC CHAR(3),    /* DRC NUMBER            @Y30LB52*/ 01625000
*                 3 * CHAR(1),      /*                       @Y30LB52*/ 01626000
*                 3 ODRCL CHAR(1),  /* LIBRARY NUMBER        @Y30LB52*/ 01627000
*                 3 ODRCN CHAR(1),  /* DRC NUMBER            @Y30LB52*/ 01628000
*                2 * CHAR(2),       /*                       @Y30LB52*/ 01629000
*                2 DRCD1 CHAR(5),   /* TOTAL                 @Y30LB52*/ 01630000
*                2 * CHAR(1),       /*                       @ZM34326*/ 01631000
*                2 *(8) CHAR(5),    /*                       @Y30LB52*/ 01632000
*                 3 DRCD2 CHAR(4),  /* TOTAL                 @ZM34326*/ 01633000
*                  4 * CHAR(2),     /*                       @ZM34326*/ 01634000
*                  4 DRCD2L CHAR(1),/* LIBRARY NUMBER        @Y30LB52*/ 01635000
*                  4 DRCD2R CHAR(1),/* DRD NUMBER            @Y30LB52*/ 01636000
*                 3 * CHAR(1),      /*                       @ZM34326*/ 01637000
*                2 * CHAR(1),       /*                       @Y30LB52*/ 01638000
*                2 DRCDRT CHAR(6);  /* COLUMN TOTAL          @ZA00699*/ 01639000
*           END;                    /*                       @Y30LB52*/ 01640000
*       END;                        /*                       @Y30LB52*/ 01641000
@RF00185 LA    @08,1                                            02S0275 01642000
         AH    @08,MSF                                          02S0275 01643000
@DE00184 STH   @08,MSF                                          02S0275 01644000
         L     @03,CNFG0PTR(,CVTPTR)                            02S0275 01645000
         CH    @08,MSFNO(,@03)                                  02S0275 01646000
         BNH   @DL00184                                         02S0275 01647000
*       DCL                                                     02S0276 01648000
*                                                               02S0276 01649000
*         /***********************************************************/ 01650000
*         /*                                                         */ 01651000
*         /* THIS STRUCTURE DEFINES THE MAIN DRD/DRC ARRAY HEADER.   */ 01652000
*         /*                                                         */ 01653000
*         /***********************************************************/ 01654000
*                                                               02S0276 01655000
*         1 DRCDRDHD STATIC LOCAL,  /* DRC/DRC CONSTANT HEADER  02S0276 01656000
*                                                            @Y30LB52*/ 01657000
*          2 * CHAR(1) INIT(SKIP3), /* CC                    @Y30LB52*/ 01658000
*          2 * CHAR(3) INIT('   '), /*                       @Y30LB52*/ 01659000
*          2 * CHAR(30) INIT('DRC/DRD INTERFACE ERROR COUNTS'),/*       01660000
*                                                            @Y30LB52   01661000
*                                                            @Y30LB52*/ 01662000
*          2 * CHAR(21) INIT('              MSF 0  ');/*     @Y30LB52*/ 01663000
*                                                               01S0277 01664000
*       /*************************************************************/ 01665000
*       /*                                                           */ 01666000
*       /* THIS CODE GENERATES THE PATH/ERROR ARRAY FOR THE ERRORS   */ 01667000
*       /* RECORDED IN THE DRC/DRD PATHS.                            */ 01668000
*       /*                                                           */ 01669000
*       /*************************************************************/ 01670000
*                                                               01S0277 01671000
*                                                               02S0277 01672000
*       /*************************************************************/ 01673000
*       /*                                                           */ 01674000
*       /* THE FOLLOWING SEGMENT FORMATS THE HEADER LINES FOR THE    */ 01675000
*       /* ERRORS BY PATH PORTION OF THE DRD PATH ANALYSIS REPORT.   */ 01676000
*       /*                                                           */ 01677000
*       /*************************************************************/ 01678000
*                                                               02S0277 01679000
*       LINES=45;                   /* INITIALIZE LINES REMAINING       01680000
*                                      COUNT                 @Y30LB52*/ 01681000
         LA    LINES,45                                         02S0277 01682000
*       OUTLINE=NEWPAGE;            /* EJECT THE PAGE        @Y30LB52*/ 01683000
         MVI   OUTLINE+1(CVTPTR),C' '                           02S0278 01684000
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          02S0278 01685000
         MVI   OUTLINE(CVTPTR),C'1'                             02S0278 01686000
*       CALL P1PRINTL;              /* PRINT THE LINE        @Y30LB52*/ 01687000
         BAL   @14,P1PRINTL                                     02S0279 01688000
*       OUTLINE=DRDHEAD;            /* PUT THE PA-DRD HEADER AT TOP     01689000
*                                                            @Y30LB52*/ 01690000
         MVI   OUTLINE+76(CVTPTR),C' '                          02S0280 01691000
         MVC   OUTLINE+77(56,CVTPTR),OUTLINE+76(CVTPTR)         02S0280 01692000
         MVC   OUTLINE(76,CVTPTR),DRDHEAD                       02S0280 01693000
*       CALL P1PRINTL;              /* PRINT THE LINE        @Y30LB52*/ 01694000
*                                                               02S0281 01695000
         BAL   @14,P1PRINTL                                     02S0281 01696000
*       /*************************************************************/ 01697000
*       /*                                                           */ 01698000
*       /* LOOP THROUGH ALL CARTRIDGE STORES IN THE SUBSYSTEM        */ 01699000
*       /*                                                           */ 01700000
*       /*************************************************************/ 01701000
*                                                               02S0282 01702000
*       DO I=1 TO MSFNO;            /* LIBNO CONTAINS TOTAL CS'S        01703000
*                                                            @Y30LB52*/ 01704000
         LA    I,1                                              02S0282 01705000
         B     @DE00282                                         02S0282 01706000
@DL00282 DS    0H                                               02S0283 01707000
*         IF CSFTOTAL(I)^=0         /* IF NO ERRORS ARE      @Y30LB52*/ 01708000
*           THEN                                                02S0283 01709000
         LR    @08,I                                            02S0283 01710000
         ALR   @08,@08                                          02S0283 01711000
         L     @04,PAD00PTR(,CVTPTR)                            02S0283 01712000
         LH    @08,CSFTOTAL-2(@08,@04)                          02S0283 01713000
         LTR   @08,@08                                          02S0283 01714000
         BZ    @RF00283                                         02S0283 01715000
*           DO;                     /* RECORDED, SKIP THE MSF@Y30LB52*/ 01716000
*             TOTALS=TOTALS&&TOTALS;/* CLEAR THE TOTALS      @Y30LB52*/ 01717000
         XC    TOTALS(76),TOTALS                                02S0285 01718000
*             IF LINES<10 THEN                                  02S0286 01719000
         CH    LINES,@CH00033                                   02S0286 01720000
         BNL   @RF00286                                         02S0286 01721000
*               DO;                 /* IF LESS THAN 10 LINES REMAIN     01722000
*                                                            @Y30LB52*/ 01723000
*                 OUTLINE=NEWPAGE;  /* EJECT THE PAGE        @Y30LB52*/ 01724000
         MVI   OUTLINE+1(CVTPTR),C' '                           02S0288 01725000
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          02S0288 01726000
         MVI   OUTLINE(CVTPTR),C'1'                             02S0288 01727000
*                 CALL P1PRINTL;    /* PRINT THE LINE        @Y30LB52*/ 01728000
         BAL   @14,P1PRINTL                                     02S0289 01729000
*                 OUTLINE=DRDHEAD;  /* ANOTHER HEADER        @Y30LB52*/ 01730000
         MVI   OUTLINE+76(CVTPTR),C' '                          02S0290 01731000
         MVC   OUTLINE+77(56,CVTPTR),OUTLINE+76(CVTPTR)         02S0290 01732000
         MVC   OUTLINE(76,CVTPTR),DRDHEAD                       02S0290 01733000
*                 CALL P1PRINTL;    /* PRINT THE LINE        @Y30LB52*/ 01734000
         BAL   @14,P1PRINTL                                     02S0291 01735000
*                 LINES=45;         /* INIT LINES REMAINING COUNT       01736000
*                                                            @Y30LB52*/ 01737000
         LA    LINES,45                                         02S0292 01738000
*               END;                /*                       @Y30LB52*/ 01739000
*                                                               02S0293 01740000
*             /*******************************************************/ 01741000
*             /*                                                     */ 01742000
*             /* FORMAT THE HEADER FOR THE INDIVIDUAL CARTRIDGE STORE*/ 01743000
*             /*                                                     */ 01744000
*             /*******************************************************/ 01745000
*                                                               02S0294 01746000
*             OUTLINE=PATHEAD;      /* HEADER LINE           @Y30LB52*/ 01747000
@RF00286 MVI   OUTLINE+57(CVTPTR),C' '                          02S0294 01748000
         MVC   OUTLINE+58(75,CVTPTR),OUTLINE+57(CVTPTR)         02S0294 01749000
         MVC   OUTLINE(57,CVTPTR),PATHEAD                       02S0294 01750000
*             OUTLINE(55)=(I-1)|'0';/* CS NUMBER INTO HEADER @Y30LB52*/ 01751000
         LR    @08,I                                            02S0295 01752000
         BCTR  @08,0                                            02S0295 01753000
         O     @08,@CF00073                                     02S0295 01754000
         STC   @08,OUTLINE+54(,CVTPTR)                          02S0295 01755000
*             CALL P1PRINTL;        /* PRINT IT              @Y30LB52*/ 01756000
         BAL   @14,P1PRINTL                                     02S0296 01757000
*             OUTLINE=PATHEAD1;     /* FIRST COLUMN HEADER   @Y30LB52*/ 01758000
         MVI   OUTLINE+101(CVTPTR),C' '                         02S0297 01759000
         MVC   OUTLINE+102(31,CVTPTR),OUTLINE+101(CVTPTR)       02S0297 01760000
         MVC   OUTLINE(101,CVTPTR),PATHEAD1                     02S0297 01761000
*             CALL P1PRINTL;        /* PRINT THE LINE        @Y30LB52*/ 01762000
         BAL   @14,P1PRINTL                                     02S0298 01763000
*             OUTLINE=SKIPONE;      /* SECOND COLUMN HEADER  @Y30LB52*/ 01764000
         MVI   OUTLINE+1(CVTPTR),C' '                           02S0299 01765000
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          02S0299 01766000
         MVI   OUTLINE(CVTPTR),C' '                             02S0299 01767000
*             E1='ERROR';           /*                       @Y30LB52*/ 01768000
         MVC   E1(5,CVTPTR),@CC00383                            02S0300 01769000
*             E2='ERROR';           /*                       @Y30LB52*/ 01770000
         MVC   E2(5,CVTPTR),@CC00383                            02S0301 01771000
*             E3='ERROR';           /*                       @Y30LB52*/ 01772000
         MVC   E3(5,CVTPTR),@CC00383                            02S0302 01773000
*             CALL P1PRINTL;        /*                       @Y30LB52*/ 01774000
         BAL   @14,P1PRINTL                                     02S0303 01775000
*             LINES=LINES-6;        /* DECREMNT LINES PRINTED@Y30LB52*/ 01776000
*                                                               02S0304 01777000
         SH    LINES,@CH00058                                   02S0304 01778000
*             /*******************************************************/ 01779000
*             /*                                                     */ 01780000
*             /* THE FOLLOWING CODE FORMATS AND PRINTS THE VALUE     */ 01781000
*             /* LINES OF THE REPORT SECTION.                        */ 01782000
*             /*                                                     */ 01783000
*             /*******************************************************/ 01784000
*                                                               02S0305 01785000
*                                                               03S0305 01786000
*             /*******************************************************/ 01787000
*             /*                                                     */ 01788000
*             /* THIS SEGMENT FORMATS AND PRINTS THE LINES OF THE    */ 01789000
*             /* ARRAY                                        SHOWING*/ 01790000
*             /* ERRORS BY PATHS FOR THE DRC/DRD PORTION OF THE PATH */ 01791000
*             /* ANALYSIS REPORT. ON ENTRY, THE VARIABLE 'I' CONTAINS*/ 01792000
*             /* THE LIBRARY NUMBER TO BE REPORTED.                  */ 01793000
*             /*                                                     */ 01794000
*             /*******************************************************/ 01795000
*                                                               03S0305 01796000
*             DO SAP=1 TO SANO;     /* LOOP THROUGH ALL SA'S @Y30LB52*/ 01797000
         LA    SAP,1                                            03S0305 01798000
         B     @DE00305                                         03S0305 01799000
@DL00305 DS    0H                                               03S0306 01800000
*               OUTLINE=SKIPTWO;    /* SET SKIP ONE BLANK LINE  03S0306 01801000
*                                                            @ZM34326*/ 01802000
         MVI   OUTLINE+1(CVTPTR),C' '                           03S0306 01803000
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          03S0306 01804000
         MVI   OUTLINE(CVTPTR),C'0'                             03S0306 01805000
*               LTPDRDP=LTPAD+((I-1)*LENGTH(LTPDRDTB));/* SET LTP       01806000
*                                      POINTER FOR CS        @Y30LB52*/ 01807000
         L     @08,CNFG0PTR(,CVTPTR)                            03S0307 01808000
         LR    @07,I                                            03S0307 01809000
         BCTR  @07,0                                            03S0307 01810000
         SLA   @07,3                                            03S0307 01811000
         AL    @07,LTPAD(,@08)                                  03S0307 01812000
         ST    @07,LTPDRDP                                      03S0307 01813000
*               DO DRCP=1 TO LIBSIZS(I);/* LOOP THROUGH DRC'S   03S0308 01814000
*                                                            @Y30LB52*/ 01815000
         LA    @08,1                                            03S0308 01816000
         B     @DE00308                                         03S0308 01817000
@DL00308 DS    0H                                               03S0309 01818000
*                 DO J=1 TO 2 WHILE(LTPDRC(DRCP,J)^='FF'X);/* LOOP      01819000
*                                      THROUGH TWO POSSIBLE SA  03S0309 01820000
*                                      CONNECTIONS           @Y30LB52*/ 01821000
         LA    @08,1                                            03S0309 01822000
         ST    @08,J                                            03S0309 01823000
@DL00309 L     @07,LTPDRDP                                      03S0309 01824000
         LH    @04,DRCP                                         03S0309 01825000
         ALR   @04,@04                                          03S0309 01826000
         ALR   @04,@08                                          03S0309 01827000
         ST    @04,@TF00001                                     03S0309 01828000
         ALR   @04,@07                                          03S0309 01829000
         AL    @04,@CF00662                                     03S0309 01830000
         CLI   LTPDRC(@04),X'FF'                                03S0309 01831000
         BE    @DC00309                                         03S0309 01832000
*                   K=LTPDRC(DRCP,J);/* LOAD THE SA/LOGICAL DRC BYTE    01833000
*                                                            @Y30LB52*/ 01834000
         L     @08,@TF00001                                     03S0310 01835000
         AL    @07,@CF00662                                     03S0310 01836000
         SLR   K,K                                              03S0310 01837000
         IC    K,LTPDRC(@08,@07)                                03S0310 01838000
*                   DRC=K&'0F'X;    /* EXTRACT THE DRC NUMBER@Y30LB52   01839000
*                                                            @Y30LB52*/ 01840000
         LA    @08,15                                           03S0311 01841000
         NR    @08,K                                            03S0311 01842000
         STH   @08,DRC                                          03S0311 01843000
*                   K=K/16+1;       /* EXTRACT THE SA INDEX  @Y30LB52*/ 01844000
         LA    @08,1                                            03S0312 01845000
         LR    @07,K                                            03S0312 01846000
         SRL   @07,4                                            03S0312 01847000
         ALR   @07,@08                                          03S0312 01848000
         LR    K,@07                                            03S0312 01849000
*                   IF SAP=K        /* IF THIS IS THE SA BEING  03S0313 01850000
*                                      PROCESSED             @Y30LB52*/ 01851000
*                     THEN                                      03S0313 01852000
         CR    SAP,K                                            03S0313 01853000
         BNE   @RF00313                                         03S0313 01854000
*                     DO;           /* FORMAT AND PRINT THE VALUE       01855000
*                                      LINE                  @Y30LB52*/ 01856000
*                                                               04S0315 01857000
*                       /*********************************************/ 01858000
*                       /*                                           */ 01859000
*                       /* THIS SEGMENT OF CODE LOOPS THROUGH ALL    */ 01860000
*                       /* POSSIBLE PATHS LOOKING FOR ACCUMULATED    */ 01861000
*                       /* ERRORS WITH THE SA AND DRC SELECTED ABOVE.*/ 01862000
*                       /* IN THE PATHS WHERE ERRORS HAVE BEEN       */ 01863000
*                       /* RECORDED, THE THE DEVICES IN THE PATH ARE */ 01864000
*                       /* INSERTED INTO THE OUTPUT LINE WITH THE    */ 01865000
*                       /* ERROR COUNTS AND THE LINE PRINTED.        */ 01866000
*                       /*                                           */ 01867000
*                       /*********************************************/ 01868000
*                                                               04S0315 01869000
*                       DO MSC=1 TO 8 WHILE(MSCINTF(MSC)^='0000'X);/*   01870000
*                                                            @Y30LB52   01871000
*                                      LOOP THROUGH ALL MSC'S WITH      01872000
*                                      ERRORS RECORDED       @Y30LB52*/ 01873000
         STH   @08,MSC                                          04S0315 01874000
@DL00315 SLA   @08,3                                            04S0315 01875000
         L     @07,PAD00PTR(,CVTPTR)                            04S0315 01876000
         ST    @08,@TF00001                                     04S0315 01877000
         ALR   @08,@07                                          04S0315 01878000
         CLC   MSCINTF-8(2,@08),@CB00246                        04S0315 01879000
         BE    @DC00315                                         04S0315 01880000
*                         IF SATABPTR(MSC)^=0/* LOWER PATHS DEFINED?    01881000
*                                                            @Y30LB52*/ 01882000
*                           THEN                                04S0316 01883000
         SLR   @08,@08                                          04S0316 01884000
         L     @04,@TF00001                                     04S0316 01885000
         L     @07,SATABPTR-8(@04,@07)                          04S0316 01886000
         CR    @07,@08                                          04S0316 01887000
         BE    @RF00316                                         04S0316 01888000
*                           DO;     /*                       @Y30LB52*/ 01889000
         ST    @07,@TF00001                                     04S0317 01890000
*                             SATABP=SATABPTR(MSC);/* LOAD THE SATAB    01891000
*                                      ADDRESS@Y30LB52       @Y30LB52*/ 01892000
         L     SATABP,@TF00001                                  04S0318 01893000
*                             RESPECIFY                         04S0319 01894000
*                               SADRDDSD BASED(SATABP);/*    @Y30LB52*/ 01895000
*                             IF SADRDACC(SAP)^=0/* NON-ZERO POINTER    01896000
*                                                            @Y30LB52*/ 01897000
*                               THEN                            04S0320 01898000
         LR    @04,SAP                                          04S0320 01899000
         SLA   @04,3                                            04S0320 01900000
         AL    @04,@CF00660                                     04S0320 01901000
         L     @04,SADRDACC(@04,SATABP)                         04S0320 01902000
         CR    @04,@08                                          04S0320 01903000
         BE    @RF00320                                         04S0320 01904000
*                               DO; /* INDICATES ERRORS IN SA'S PATH    01905000
*                                                            @Y30LB52*/ 01906000
*                                 DRDACCP=SADRDACC(SAP);/* LOAD THE     01907000
*                                      ACCUMULATOR ADDRESS   @Y30LB52*/ 01908000
         ST    @04,DRDACCP                                      04S0322 01909000
*                                 DO K=1 TO 4;/* LOOP THROUGH 4 04S0323 01910000
*                                      LOGICAL DRD'S         @Y30LB52*/ 01911000
         LA    K,1                                              04S0323 01912000
@DL00323 DS    0H                                               04S0324 01913000
*                                   RESPECIFY                   04S0324 01914000
*                                     DRDACCTB BASED(DRDACCP);/*        01915000
*                                                            @Y30LB52*/ 01916000
*                                   IF DRDACCTB(DRC,K)^='000000000000'X 01917000
*                                   /* NON-ZERO ERROR COUNTS @Y30LB52*/ 01918000
*                                     THEN                      04S0325 01919000
         L     @08,DRDACCP                                      04S0325 01920000
         LH    @07,DRC                                          04S0325 01921000
         SLA   @07,2                                            04S0325 01922000
         ALR   @07,K                                            04S0325 01923000
         MH    @07,@CH00058                                     04S0325 01924000
         ST    @07,@TF00001                                     04S0325 01925000
         ALR   @07,@08                                          04S0325 01926000
         AL    @07,@CF00664                                     04S0325 01927000
         CLC   DRDACCTB(6,@07),@CB00313                         04S0325 01928000
         BE    @RF00325                                         04S0325 01929000
*                                    DO;/* PRODUCE AN OUTPUT    04S0326 01930000
*                                      LINE@Y30LB52          @Y30LB52*/ 01931000
*                                     OUTLINE=SKIPONE;/* SKIP 1 LINE    01932000
*                                      CC                    @Y30LB52*/ 01933000
*                                                               04S0327 01934000
         MVI   OUTLINE+1(CVTPTR),C' '                           04S0327 01935000
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          04S0327 01936000
         MVI   OUTLINE(CVTPTR),C' '                             04S0327 01937000
*                                     /*******************************/ 01938000
*                                     /*                             */ 01939000
*                                     /* FORMAT THE MSC ADDRESS      */ 01940000
*                                     /*                             */ 01941000
*                                     /*******************************/ 01942000
*                                                               04S0328 01943000
*                                     UNPK(DECNO(1:4),MSCDRDAC(MSC,1:3) 01944000
*                                         );/* UNPACK THE HEX STRING    01945000
*                                      PLUS ONE BYTE         @Y30LB52*/ 01946000
         LH    @07,MSC                                          04S0328 01947000
         SLA   @07,3                                            04S0328 01948000
         L     @01,PAD00PTR(,CVTPTR)                            04S0328 01949000
         ALR   @01,@07                                          04S0328 01950000
         UNPK  DECNO(4),MSCDRDAC-8(3,@01)                       04S0328 01951000
*                                     MSC4=DECNO(1:3)&'0F0F0F'X;/*      01952000
*                                      TURN OFF THE ZONES    @Y30LB52*/ 01953000
         MVC   MSC4(3,CVTPTR),DECNO                             04S0329 01954000
         NC    MSC4(3,CVTPTR),@CB00250                          04S0329 01955000
*                                     TR(MSC4,TRTAB);/* TRANSLATE TO    01956000
*                                      PRINTABLE@Y30LB52 HEXADECIMAL    01957000
*                                      CHARACTERS            @Y30LB52*/ 01958000
*                                                               04S0330 01959000
         TR    MSC4(3,CVTPTR),TRTAB                             04S0330 01960000
*                                     /*******************************/ 01961000
*                                     /*                             */ 01962000
*                                     /* FORMAT THE SA SSID          */ 01963000
*                                     /*                             */ 01964000
*                                     /*******************************/ 01965000
*                                                               04S0331 01966000
*                                     SA4='800';/* SA SSID   @Y30LB52*/ 01967000
         MVC   SA4(3,CVTPTR),@CC00390                           04S0331 01968000
*                                     SA44=SA44|(SAP-1);/* OR IN THE    01969000
*                                      SA INDEX              @Y30LB52*/ 01970000
*                                                               04S0332 01971000
         LR    @07,SAP                                          04S0332 01972000
         BCTR  @07,0                                            04S0332 01973000
         SLR   @15,@15                                          04S0332 01974000
         IC    @15,SA44(,CVTPTR)                                04S0332 01975000
         OR    @07,@15                                          04S0332 01976000
         STC   @07,SA44(,CVTPTR)                                04S0332 01977000
*                                     /*******************************/ 01978000
*                                     /*                             */ 01979000
*                                     /* FORMAT THE DRC SSID         */ 01980000
*                                     /*                             */ 01981000
*                                     /*******************************/ 01982000
*                                                               04S0333 01983000
*                                     DRC4='400';/* DRC SSID @Y30LB52*/ 01984000
         MVC   DRC4(3,CVTPTR),@CC00316                          04S0333 01985000
*                                     DRC44=DRC44|(I-1);/* CS INDEX     01986000
*                                                            @Y30LB52*/ 01987000
         LR    @07,I                                            04S0334 01988000
         BCTR  @07,0                                            04S0334 01989000
         SLR   @15,@15                                          04S0334 01990000
         IC    @15,DRC44(,CVTPTR)                               04S0334 01991000
         OR    @07,@15                                          04S0334 01992000
         STC   @07,DRC44(,CVTPTR)                               04S0334 01993000
*                                     DRC444=DRC444|(DRCP-1);/* OR IN   01994000
*                                      THE DRC INDEX         @Y30LB52*/ 01995000
*                                                               04S0335 01996000
         LH    @07,DRCP                                         04S0335 01997000
         BCTR  @07,0                                            04S0335 01998000
         SLR   @15,@15                                          04S0335 01999000
         IC    @15,DRC444(,CVTPTR)                              04S0335 02000000
         OR    @15,@07                                          04S0335 02001000
         STC   @15,DRC444(,CVTPTR)                              04S0335 02002000
*                                     /*******************************/ 02003000
*                                     /*                             */ 02004000
*                                     /* FORMAT THE DRD SSID         */ 02005000
*                                     /*                             */ 02006000
*                                     /*******************************/ 02007000
*                                                               04S0336 02008000
*                                     DRD4='200';/* DRD SSID @Y30LB52*/ 02009000
         MVC   DRD4(3,CVTPTR),@CC00396                          04S0336 02010000
*                                     DRD44=DRC44;/* CS NUMBER  04S0337 02011000
*                                                            @Y30LB52*/ 02012000
*                                                               04S0337 02013000
         MVC   DRD44(1,CVTPTR),DRC44(CVTPTR)                    04S0337 02014000
*                                     /*******************************/ 02015000
*                                     /*                             */ 02016000
*                                     /* THE PHYSICAL DRD NUMBER IS  */ 02017000
*                                     /* TAKEN FROM A CONSTANT TABLE */ 02018000
*                                     /*                             */ 02019000
*                                     /*******************************/ 02020000
*                                                               04S0338 02021000
*                                     DRDSPTR=MSFAN(LIBSIZS(I))+(DRCP-1 02022000
*                                         )*4;/* LOAD PROPER CONSTANT   02023000
*                                      TABLE ADDRESS         @Y30LB52*/ 02024000
         L     @01,CNFG0PTR(,CVTPTR)                            04S0338 02025000
         SLR   @15,@15                                          04S0338 02026000
         IC    @15,LIBSIZS-1(I,@01)                             04S0338 02027000
         SLA   @15,2                                            04S0338 02028000
         SLA   @07,2                                            04S0338 02029000
         AL    @07,MSFAN-4(@15)                                 04S0338 02030000
         ST    @07,DRDSPTR                                      04S0338 02031000
*                                     DRD444=DRD444|DRDS(K);/* INSERT   02032000
*                                      PHYSICAL DRD NUMBER INTO THE     02033000
*                                      SSID                  @Y30LB52*/ 02034000
*                                                               04S0339 02035000
         SLR   @15,@15                                          04S0339 02036000
         IC    @15,DRD444(,CVTPTR)                              04S0339 02037000
         AL    @07,@CF00663                                     04S0339 02038000
         SLR   @14,@14                                          04S0339 02039000
         IC    @14,DRDS(K,@07)                                  04S0339 02040000
         OR    @15,@14                                          04S0339 02041000
         STC   @15,DRD444(,CVTPTR)                              04S0339 02042000
*                                     /*******************************/ 02043000
*                                     /*                             */ 02044000
*                                     /* THE FOLLOWING INCLUDED      */ 02045000
*                                     /* SEGMENT FORMATS AND INSERTS */ 02046000
*                                     /* THE THREE ERROR COUNTS FOR  */ 02047000
*                                     /* THIS PATH INTO THE OUTPUT   */ 02048000
*                                     /* LINE.                       */ 02049000
*                                     /*                             */ 02050000
*                                     /*******************************/ 02051000
*                                                               04S0340 02052000
*                                                               05S0340 02053000
*                                     /*******************************/ 02054000
*                                     /*                             */ 02055000
*                                     /* THIS SEGMENT OF CODE FORMATS*/ 02056000
*                                     /* AND INSERTS THE THREE ERROR */ 02057000
*                                     /* VALUES INTO THE OUTPUT LINE.*/ 02058000
*                                     /*                             */ 02059000
*                                     /*******************************/ 02060000
*                                                               05S0340 02061000
*                                     DRDACCE=ADDR(DRDACCTB(DRC,K));    02062000
         L     @07,@TF00001                                     05S0340 02063000
         AL    @08,@CF00664                                     05S0340 02064000
         LA    @08,DRDACCTB(@07,@08)                            05S0340 02065000
         ST    @08,DRDACCE                                      05S0340 02066000
*                                     /* ADDRESS THREE ERROR @Y30LB52   02067000
*                                      ACCUMULATORS          @Y30LB52*/ 02068000
*                                     RESPECIFY                 05S0341 02069000
*                                       DRDACC BASED(DRDACCE);/*        02070000
*                                                            @Y30LB52*/ 02071000
*                                     RTOTAL=0;/* CLEAR TOW TOTAL       02072000
*                                                            @Y30LB52*/ 02073000
         SLR   @08,@08                                          05S0342 02074000
         STH   @08,RTOTAL                                       05S0342 02075000
*                                     DO L=1 TO 3;/* LOOP THROUGH       02076000
*                                      THREE ERROR TYPES     @Y30LB52*/ 02077000
         LA    L,1                                              05S0343 02078000
@DL00343 DS    0H                                               05S0344 02079000
*                                      RTOTAL=RTOTAL+DRDACC;/*  05S0344 02080000
*                                      INCREMENT ROW TOTAL   @Y30LB52*/ 02081000
         L     @08,DRDACCE                                      05S0344 02082000
         LH    @15,DRDACC(,@08)                                 05S0344 02083000
         LH    @14,RTOTAL                                       05S0344 02084000
         ALR   @14,@15                                          05S0344 02085000
         STH   @14,RTOTAL                                       05S0344 02086000
*                                      LTOTAL(L)=LTOTAL(L)+DRDACC;/*    02087000
*                                      INCREENT THE COLUMN TOTAL        02088000
*                                                            @Y30LB52*/ 02089000
         LR    @14,L                                            05S0345 02090000
         ALR   @14,@14                                          05S0345 02091000
         LH    @01,LTOTAL-2(@14)                                05S0345 02092000
         ALR   @01,@15                                          05S0345 02093000
         STH   @01,LTOTAL-2(@14)                                05S0345 02094000
*                                      CVD(DRDACC,DECNO);/* CONVERT     02095000
*                                      BINARY STRING TO DECIMAL 05S0346 02096000
*                                                            @ZA00699*/ 02097000
         CVD   @15,DECNO                                        05S0346 02098000
*                                      OERR(L)=EDITPAT5;/* 5 DIGIT      02099000
*                                      EDIT PATTERN          @ZA00699*/ 02100000
         LR    @15,L                                            05S0347 02101000
         MH    @15,@CH00033                                     05S0347 02102000
         ST    @15,@TF00001                                     05S0347 02103000
         ALR   @15,CVTPTR                                       05S0347 02104000
         MVC   OERR-10(6,@15),EDITPAT5                          05S0347 02105000
*                                      ED(OERR(L),DECNO2);/* CONVERT    02106000
*                                      TO PRINTABLE HEX      @ZA00699*/ 02107000
         LR    @01,CVTPTR                                       05S0348 02108000
         AL    @01,@TF00001                                     05S0348 02109000
         ED    OERR-10(6,@01),DECNO2                            05S0348 02110000
*                                      DRDACCE=DRDACCE+2;/* STEP TO     02111000
*                                      NEXT ERROR COUNT      @Y30LB52*/ 02112000
         AH    @08,@CH00106                                     05S0349 02113000
         ST    @08,DRDACCE                                      05S0349 02114000
*                                     END;/*                 @Y30LB52*/ 02115000
         AH    L,@CH00045                                       05S0350 02116000
         CH    L,@CH00103                                       05S0350 02117000
         BNH   @DL00343                                         05S0350 02118000
*                                     GTOTAL=RTOTAL+GTOTAL;/*   05S0351 02119000
*                                      INCREMNT THE GRAND TOTAL 05S0351 02120000
*                                                            @Y30LB52*/ 02121000
*                                                               05S0351 02122000
         LH    @08,RTOTAL                                       05S0351 02123000
         LH    @07,GTOTAL                                       05S0351 02124000
         ALR   @07,@08                                          05S0351 02125000
         STH   @07,GTOTAL                                       05S0351 02126000
*                                     /*******************************/ 02127000
*                                     /*                             */ 02128000
*                                     /* INSERT THE ROW TOTAL INTO   */ 02129000
*                                     /* THE OUTPUT LINE             */ 02130000
*                                     /*                             */ 02131000
*                                     /*******************************/ 02132000
*                                                               05S0352 02133000
*                                     CVD(RTOTAL,DECNO);/* CONVERT      02134000
*                                      BINARY STRING TO DECIMAL 05S0352 02135000
*                                                            @ZA00699*/ 02136000
         CVD   @08,DECNO                                        05S0352 02137000
*                                     OPTOT=EDITPAT5;/* 5 DIGIT EDIT    02138000
*                                      PATTERN               @ZA00699*/ 02139000
         MVC   OPTOT(6,CVTPTR),EDITPAT5                         05S0353 02140000
*                                     ED(OPTOT,DECNO2);/* CONVERT TO    02141000
*                                      PRINTABLE HEX         @ZA00699*/ 02142000
*                                                               05S0354 02143000
         ED    OPTOT(6,CVTPTR),DECNO2                           05S0354 02144000
*                                     /*******************************/ 02145000
*                                     /*                             */ 02146000
*                                     /* INSERT THE PERCENTAGE OF    */ 02147000
*                                     /* TOTAL COLUMN ENTRY          */ 02148000
*                                     /*                             */ 02149000
*                                     /*******************************/ 02150000
*                                                               05S0355 02151000
*                                     RTOTAL=RTOTAL*1000/CSFTOTAL(I);   02152000
         MH    @08,@CH00402                                     05S0355 02153000
         LR    @07,I                                            05S0355 02154000
         ALR   @07,@07                                          05S0355 02155000
         L     @01,PAD00PTR(,CVTPTR)                            05S0355 02156000
         LR    @14,@08                                          05S0355 02157000
         SRDA  @14,32                                           05S0355 02158000
         LH    @08,CSFTOTAL-2(@07,@01)                          05S0355 02159000
         DR    @14,@08                                          05S0355 02160000
         STH   @15,RTOTAL                                       05S0355 02161000
*                                     /* CALCULATE PERCENT   @ZM34326*/ 02162000
*                                     CVD(RTOTAL,DECNO);/* CONVERT TO   02163000
*                                      DECIAML               @ZM34326*/ 02164000
         CVD   @15,DECNO                                        05S0356 02165000
*                                     OPCNT=EDITPATP;/* MOVE PERCENT    02166000
*                                      PATTERN               @ZM34326*/ 02167000
         MVC   OPCNT(7,CVTPTR),EDITPATP                         05S0357 02168000
*                                     ED(OPCNT,DECNO2);/* EDIT  05S0358 02169000
*                                      PERCENTAGE            @ZM34326*/ 02170000
         ED    OPCNT(7,CVTPTR),DECNO2                           05S0358 02171000
*                                                               05S0359 02172000
*                                     /*******************************/ 02173000
*                                     /*                             */ 02174000
*                                     /* THE FOLLOWING STRUCTURE MAPS*/ 02175000
*                                     /* THE OUTPUT ONE FOR THE      */ 02176000
*                                     /* PURPOSE OF INSERTING THE    */ 02177000
*                                     /* THREE ERROR COUNTS FOR A    */ 02178000
*                                     /* PATH AND THE ROW TOTAL.     */ 02179000
*                                     /*                             */ 02180000
*                                     /*******************************/ 02181000
*                                                               05S0359 02182000
*                                     DCL                       05S0359 02183000
*                                       1 * DEF(OUTLINE),/*  @Y30LB52*/ 02184000
*                                        2 * CHAR(44),/*     @Y30LB52*/ 02185000
*                                        2 OPTOTAL CHAR(5),/*   05S0359 02186000
*                                      CONSTANT 'TOTAL'      @Y30LB52*/ 02187000
*                                        2 * CHAR(3),/*      @ZA00699*/ 02188000
*                                        2 *(3) CHAR(10),/*  @Y30LB52*/ 02189000
*                                         3 OERR CHAR(6),/* EBCDIC      02190000
*                                      ERROR COUNT           @ZA00699*/ 02191000
*                                         3 * CHAR(4),/*     @ZA00699*/ 02192000
*                                        2 * CHAR(2),/*      @ZA00699*/ 02193000
*                                        2 OPTOT CHAR(6),/* ROW TOTAL   02194000
*                                                            @ZA00699*/ 02195000
*                                        2 * CHAR(3),/*      @ZA00699*/ 02196000
*                                        2 OPCNT CHAR(7);/* ERROR       02197000
*                                      PERCENTAGE            @ZM34326*/ 02198000
*                                     LINES=LINES-1;/* INCREMENT        02199000
*                                      LINES PRINTED         @Y30LB52*/ 02200000
         BCTR  LINES,0                                          04S0360 02201000
*                                     CALL P1PRINTL;/* PRINT THE LINE   02202000
*                                                            @Y30LB52*/ 02203000
         BAL   @14,P1PRINTL                                     04S0361 02204000
*                                     OUTLINE=SKIPONE;/* RESET SINGLE   02205000
*                                      SKIP                  @ZM34326*/ 02206000
         MVI   OUTLINE+1(CVTPTR),C' '                           04S0362 02207000
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          04S0362 02208000
         MVI   OUTLINE(CVTPTR),C' '                             04S0362 02209000
*                                    END;/*                  @Y30LB52*/ 02210000
*                                 END;/*                     @Y30LB52*/ 02211000
@RF00325 AH    K,@CH00045                                       04S0364 02212000
         CH    K,@CH00055                                       04S0364 02213000
         BNH   @DL00323                                         04S0364 02214000
*                               END;/*                       @Y30LB52*/ 02215000
*                           END;    /*                       @Y30LB52*/ 02216000
@RF00320 DS    0H                                               04S0367 02217000
*                       END;        /*                       @Y30LB52*/ 02218000
@RF00316 LA    @08,1                                            04S0367 02219000
         AH    @08,MSC                                          04S0367 02220000
         STH   @08,MSC                                          04S0367 02221000
         CH    @08,@CH00099                                     04S0367 02222000
         BNH   @DL00315                                         04S0367 02223000
@DC00315 DS    0H                                               04S0368 02224000
*                                                               04S0368 02225000
*                       /*********************************************/ 02226000
*                       /*                                           */ 02227000
*                       /* THE FOLLOWING STRUCTURE MAPS THE OUTPUT   */ 02228000
*                       /* LINE FOR THE PURPOSE OF STORING THE EBCDIC*/ 02229000
*                       /* UNIT ADDRESS AND SSID'S FOR A PATH IN THE */ 02230000
*                       /* PATH REPORT.                              */ 02231000
*                       /*                                           */ 02232000
*                       /*********************************************/ 02233000
*                                                               04S0368 02234000
*                       DCL                                     04S0368 02235000
*                         1 * DEF(OUTLINE),/*                @Y30LB52*/ 02236000
*                          2 * CHAR(4),/*                    @Y30LB52*/ 02237000
*                          2 MSC4 CHAR(3),/* MSC SSID        @Y30LB52*/ 02238000
*                          2 * CHAR(2),/*                    @Y30LB52*/ 02239000
*                          2 SA4 CHAR(3),/* SA SSID          @Y30LB52*/ 02240000
*                           3 * CHAR(1),/*                   @Y30LB52*/ 02241000
*                           3 SA44 CHAR(1),/* SA NUMBER      @Y30LB52*/ 02242000
*                           3 * CHAR(1),/*                   @Y30LB52*/ 02243000
*                          2 * CHAR(6),/*                    @Y30LB52*/ 02244000
*                          2 DRC4 CHAR(3),/* DRC SSID        @Y30LB52*/ 02245000
*                           3 * CHAR(1),/*                   @Y30LB52*/ 02246000
*                           3 DRC44 CHAR(1),/* CS NUMBER     @Y30LB52*/ 02247000
*                           3 DRC444 CHAR(1),/* DRC NUMBER   @Y30LB52*/ 02248000
*                          2 * CHAR(11),/*                   @Y30LB52*/ 02249000
*                          2 DRD4 CHAR(3),/* DRD SSID        @Y30LB52*/ 02250000
*                           3 * CHAR(1),/*                   @Y30LB52*/ 02251000
*                           3 DRD44 CHAR(1),/* CS NUMBER     @Y30LB52*/ 02252000
*                           3 DRD444 CHAR(1);/* DRD NUMBER   @Y30LB52*/ 02253000
*                     END;          /*                       @Y30LB52*/ 02254000
*                 END;              /*                       @Y30LB52*/ 02255000
@RF00313 LA    @08,1                                            03S0370 02256000
         AL    @08,J                                            03S0370 02257000
         ST    @08,J                                            03S0370 02258000
         CH    @08,@CH00106                                     03S0370 02259000
         BNH   @DL00309                                         03S0370 02260000
@DC00309 DS    0H                                               03S0371 02261000
*               END;                /*                       @Y30LB52*/ 02262000
         LA    @08,1                                            03S0371 02263000
         AH    @08,DRCP                                         03S0371 02264000
@DE00308 STH   @08,DRCP                                         03S0371 02265000
         L     @07,CNFG0PTR(,CVTPTR)                            03S0371 02266000
         SLR   @04,@04                                          03S0371 02267000
         IC    @04,LIBSIZS-1(I,@07)                             03S0371 02268000
         CR    @08,@04                                          03S0371 02269000
         BNH   @DL00308                                         03S0371 02270000
*             END;                  /*                       @Y30LB52*/ 02271000
*                                                               03S0372 02272000
         AH    SAP,@CH00045                                     03S0372 02273000
@DE00305 L     @08,CNFG0PTR(,CVTPTR)                            03S0372 02274000
         CH    SAP,SANO(,@08)                                   03S0372 02275000
         BNH   @DL00305                                         03S0372 02276000
*             /*******************************************************/ 02277000
*             /*                                                     */ 02278000
*             /* FORMAT AND OUTPUT THE TOTALS LINE.                  */ 02279000
*             /*                                                     */ 02280000
*             /*******************************************************/ 02281000
*                                                               03S0373 02282000
*             LINES=LINES-4;        /* INCREMENT LINES PRINTED  03S0373 02283000
*                                                            @Y30LB52*/ 02284000
         SH    LINES,@CH00055                                   03S0373 02285000
*             OUTLINE=SKIPTWO;      /* SKIP TWO LINES        @Y30LB52*/ 02286000
         MVI   OUTLINE+1(CVTPTR),C' '                           03S0374 02287000
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          03S0374 02288000
         MVI   OUTLINE(CVTPTR),C'0'                             03S0374 02289000
*             OPTOTAL='TOTAL';      /* SET ROW TOTAL CONSTANT@Y30LB52   02290000
*                                                            @Y30LB52*/ 02291000
         MVC   OPTOTAL(5,CVTPTR),@CC00240                       03S0375 02292000
*             DO K=1 TO 3;          /* LOOP THROUGH THREE ERROR 03S0376 02293000
*                                      COUNTS                @Y30LB52*/ 02294000
         LA    K,1                                              03S0376 02295000
@DL00376 DS    0H                                               03S0377 02296000
*               CVD(LTOTAL(K),DECNO);/* CONVERT BINARY STRING TO        02297000
*                                      DECIMAL               @ZA00699*/ 02298000
         LR    @08,K                                            03S0377 02299000
         ALR   @08,@08                                          03S0377 02300000
         LH    @08,LTOTAL-2(@08)                                03S0377 02301000
         CVD   @08,DECNO                                        03S0377 02302000
*               OERR(K)=EDITPAT5;   /* 5 DIGIT EDIT PATTERN  @ZA00699*/ 02303000
         LR    @08,K                                            03S0378 02304000
         MH    @08,@CH00033                                     03S0378 02305000
         ST    @08,@TF00001                                     03S0378 02306000
         ALR   @08,CVTPTR                                       03S0378 02307000
         MVC   OERR-10(6,@08),EDITPAT5                          03S0378 02308000
*               ED(OERR(K),DECNO2); /* CONVERT TO PRINTABLE HEX 03S0379 02309000
*                                                            @ZA00699*/ 02310000
         LR    @08,CVTPTR                                       03S0379 02311000
         AL    @08,@TF00001                                     03S0379 02312000
         ED    OERR-10(6,@08),DECNO2                            03S0379 02313000
*             END;                  /*                       @Y30LB52*/ 02314000
         AH    K,@CH00045                                       03S0380 02315000
         CH    K,@CH00103                                       03S0380 02316000
         BNH   @DL00376                                         03S0380 02317000
*             CVD(GTOTAL,DECNO);    /* CONVERT BINARY STRING TO 03S0381 02318000
*                                      DECIMAL               @ZA00699*/ 02319000
         LH    @08,GTOTAL                                       03S0381 02320000
         CVD   @08,DECNO                                        03S0381 02321000
*             OPTOT=EDITPAT5;       /* 5 DIGIT EDIT PATTERN  @ZA00699*/ 02322000
         MVC   OPTOT(6,CVTPTR),EDITPAT5                         03S0382 02323000
*             ED(OPTOT,DECNO2);     /* CONVERT TO PRINTABLE HEX 03S0383 02324000
*                                                            @ZA00699*/ 02325000
         ED    OPTOT(6,CVTPTR),DECNO2                           03S0383 02326000
*             CALL P1PRINTL;        /* PRINT THE TOTALS LINE @Y30LB52*/ 02327000
         BAL   @14,P1PRINTL                                     03S0384 02328000
*           END;                    /*                       @Y30LB52*/ 02329000
*       END;                        /*                       @Y30LB52*/ 02330000
@RF00283 AH    I,@CH00045                                       02S0386 02331000
@DE00282 L     @08,CNFG0PTR(,CVTPTR)                            02S0386 02332000
         CH    I,MSFNO(,@08)                                    02S0386 02333000
         BNH   @DL00282                                         02S0386 02334000
*                                                               02S0387 02335000
*       /*************************************************************/ 02336000
*       /*                                                           */ 02337000
*       /* THE FOLLOWING IS THE MAIN PATH SECTION HEADER.            */ 02338000
*       /*                                                           */ 02339000
*       /*************************************************************/ 02340000
*                                                               02S0387 02341000
*       DCL                                                     02S0387 02342000
*         1 PATHEAD STATIC LOCAL,   /* CONSTANT PATH HEAD    @Y30LB52*/ 02343000
*          2 * CHAR(1) INIT('-'),   /*                       @Y30LB52*/ 02344000
*          2 * CHAR(3) INIT('   '), /*                       @Y30LB52*/ 02345000
*          2 * CHAR(53) INIT(                                   02S0387 02346000
*                'ERROR COUNTS BY REAL DEVICE PATH              MSF 0   02347000
*                ),                                             02S0387 02348000
*                                                               02S0387 02349000
*         /***********************************************************/ 02350000
*         /*                                                         */ 02351000
*         /* THE FOLLOWING STRUCTURE IS THE FIRST LINE OF THE COLUMN */ 02352000
*         /* HEADER.                                                 */ 02353000
*         /*                                                         */ 02354000
*         /***********************************************************/ 02355000
*                                                               02S0387 02356000
*         1 PATHEAD1 STATIC LOCAL,  /* PATH CONSTANT HEADER  @Y30LB52*/ 02357000
*          2 * CHAR(1) INIT('-'),   /* SKIP TWO CC           @Y30LB52*/ 02358000
*          2 * CHAR(3) INIT('   '), /*                       @Y30LB52*/ 02359000
*          2 * CHAR(3) INIT('MSC'), /*                       @Y30LB52*/ 02360000
*          2 * CHAR(2) INIT('  '),  /*                       @Y30LB52*/ 02361000
*          2 * CHAR(2) INIT('SA'),  /*                       @Y30LB52*/ 02362000
*          2 * CHAR(7) INIT(' '),   /*                       @Y30LB52*/ 02363000
*          2 * CHAR(3) INIT('DRC'), /*                       @Y30LB52*/ 02364000
*          2 * CHAR(11) INIT(' '),  /*                       @Y30LB52*/ 02365000
*          2 * CHAR(19) INIT('DRD'),/*                       @Y30LB52*/ 02366000
*          2 * CHAR(40) INIT(' DRD UNIT  CTL-I ADT  DRC UNIT     TOTAL' 02367000
*                ),                 /*                       @ZA00699*/ 02368000
*          2 * CHAR(10) INIT('    %ERROR'),/*                @ZA00699*/ 02369000
*                                                               02S0387 02370000
*         /***********************************************************/ 02371000
*         /*                                                         */ 02372000
*         /* THE FOLLOWING STRUCTURE MAPS THE OUTPUT LINE AND IS USED*/ 02373000
*         /* TO INSERT THE SECOND LINE OF THE COLUMN HEADER.         */ 02374000
*         /*                                                         */ 02375000
*         /***********************************************************/ 02376000
*                                                               02S0387 02377000
*         1 * DEF(OUTLINE),         /*                       @Y30LB52*/ 02378000
*          2 * CHAR(54),            /*                       @Y30LB52*/ 02379000
*          2 E1 CHAR(5),            /*                       @Y30LB52*/ 02380000
*          2 * CHAR(5),             /*                       @Y30LB52*/ 02381000
*          2 E2 CHAR(5),            /*                       @Y30LB52*/ 02382000
*          2 * CHAR(5),             /*                       @Y30LB52*/ 02383000
*          2 E3 CHAR(5);            /*                       @Y30LB52*/ 02384000
*     END;                          /*                       @Y30LB52*/ 02385000
*   DASD='1'B;                      /*                       @Y30LB52*/ 02386000
*                                                               01S0389 02387000
@RF00084 OI    DASD,B'10000000'                                 01S0389 02388000
*   /*****************************************************************/ 02389000
*   /*                                                               */ 02390000
*   /* THE FOLLOWING SEGMENT FORMATS AND PRINTS THE MSC/SA PORTION OF*/ 02391000
*   /* THE PATH ANALYSIS REPORT(3330).                               */ 02392000
*   /*                                                               */ 02393000
*   /*****************************************************************/ 02394000
*                                                               01S0390 02395000
*                                                               02S0390 02396000
*   /*****************************************************************/ 02397000
*   /*                                                               */ 02398000
*   /* THIS SEGMENT OF CODE FORMATS THE CONSTANT HEADERS FOR THE     */ 02399000
*   /* MSC/SA PORTION OF THE PATH ANALYSIS REPORT(DASD).             */ 02400000
*   /*                                                               */ 02401000
*   /*****************************************************************/ 02402000
*                                                               02S0390 02403000
*   OUTLINE=NEWPAGE;                /* START NEW REPORT PAGE @Y30LB52*/ 02404000
         MVI   OUTLINE+1(CVTPTR),C' '                           02S0390 02405000
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          02S0390 02406000
         MVI   OUTLINE(CVTPTR),C'1'                             02S0390 02407000
*   CALL P1PRINTL;                  /* PRINT THE LINE        @Y30LB52*/ 02408000
         BAL   @14,P1PRINTL                                     02S0391 02409000
*   OUTLINE=DASDHEAD;               /* PA DASD HEADER        @Y30LB52*/ 02410000
         MVI   OUTLINE+58(CVTPTR),C' '                          02S0392 02411000
         MVC   OUTLINE+59(74,CVTPTR),OUTLINE+58(CVTPTR)         02S0392 02412000
         MVC   OUTLINE(58,CVTPTR),DASDHEAD                      02S0392 02413000
*   CALL P1PRINTL;                  /* PRINT THE LINE        @Y30LB52*/ 02414000
         BAL   @14,P1PRINTL                                     02S0393 02415000
*   OUTLINE=MSCSAHD;                /* FIXED MSC/SA HEADER   @Y30LB52*/ 02416000
         MVI   OUTLINE+33(CVTPTR),C' '                          02S0394 02417000
         MVC   OUTLINE+34(99,CVTPTR),OUTLINE+33(CVTPTR)         02S0394 02418000
         MVC   OUTLINE(33,CVTPTR),MSCSAHD                       02S0394 02419000
*   CALL P1PRINTL;                  /* PRINT IT              @Y30LB52*/ 02420000
         BAL   @14,P1PRINTL                                     02S0395 02421000
*   OUTLINE=SAHD;                   /* FIXED SA COLUMN HEADER@Y30LB52*/ 02422000
         MVI   OUTLINE+98(CVTPTR),C' '                          02S0396 02423000
         MVC   OUTLINE+99(34,CVTPTR),OUTLINE+98(CVTPTR)         02S0396 02424000
         MVC   OUTLINE(98,CVTPTR),SAHD                          02S0396 02425000
*   CALL P1PRINTL;                  /* PRINT                 @Y30LB52*/ 02426000
*                                                               02S0397 02427000
         BAL   @14,P1PRINTL                                     02S0397 02428000
*   /*****************************************************************/ 02429000
*   /*                                                               */ 02430000
*   /* SET UP FIXED COLUMN HEADER LINE IMMEDIATELY BEFORE THE VALUE  */ 02431000
*   /* ARRAY.                                                        */ 02432000
*   /*                                                               */ 02433000
*   /*****************************************************************/ 02434000
*                                                               02S0398 02435000
*   OUTLINE=SKIPONE;                /* SKIP ONE LINE CC      @Y30LB52*/ 02436000
         MVI   OUTLINE+1(CVTPTR),C' '                           02S0398 02437000
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          02S0398 02438000
         MVI   OUTLINE(CVTPTR),C' '                             02S0398 02439000
*   COLUMN1='MSC';                  /* MSC COLUM HEAD        @Y30LB52*/ 02440000
         MVC   COLUMN1(3,CVTPTR),@CC00238                       02S0399 02441000
*   COLTOTAL='TOTAL';               /* TOTAL COLUMN HEAD     @Y30LB52*/ 02442000
         MVC   COLTOTAL(5,CVTPTR),@CC00240                      02S0400 02443000
*   CALL P1PRINTL;                  /* PRINT IT              @Y30LB52*/ 02444000
*                                                               02S0401 02445000
         BAL   @14,P1PRINTL                                     02S0401 02446000
*   /*****************************************************************/ 02447000
*   /*                                                               */ 02448000
*   /* THE FOLLOWING INCLUDED SEGMENT FORMATS A PRINTS THE VALUES FOR*/ 02449000
*   /* THE MSC/SA ARRAY.                                             */ 02450000
*   /*                                                               */ 02451000
*   /*****************************************************************/ 02452000
*                                                               02S0402 02453000
*   CALL P1MSCSAV;                  /* CALL THE MSC/SA VALUE ROUTINE    02454000
*                                                            @Y30LB52*/ 02455000
         BAL   @14,P1MSCSAV                                     02S0402 02456000
*                                                               02S0403 02457000
*   /*****************************************************************/ 02458000
*   /*                                                               */ 02459000
*   /* THE FOLLOWING IS A MAP OF THE FIXED DASD HEADER TO BE MOVED   */ 02460000
*   /* INTO THE OUTPUT BUFFER FOR PRINTING.                          */ 02461000
*   /*                                                               */ 02462000
*   /*****************************************************************/ 02463000
*                                                               02S0403 02464000
*   DCL                                                         02S0403 02465000
*     1 DASDHEAD STATIC LOCAL,      /*                       @Y30LB52*/ 02466000
*      2 * CHAR(1) INIT('0'),       /* SKIP TWO CC           @Y30LB52*/ 02467000
*      2 * CHAR(35) INIT('REPORT 6 - PATH ANALYSIS REPORT OF '),        02468000
*      2 * CHAR(22) INIT('EQUIPMENT CHECKS(3330)');/*        @ZM30730*/ 02469000
*                                                               01S0404 02470000
*   /*****************************************************************/ 02471000
*   /*                                                               */ 02472000
*   /* THE FOLLOWING INCLUDED SEGMENT FORMATS AND PRINTS THE         */ 02473000
*   /* CHANNEL/SA PORTION OF THE PATH ANALYSIS REPORT(3330).         */ 02474000
*   /*                                                               */ 02475000
*   /*****************************************************************/ 02476000
*                                                               01S0404 02477000
*   IF CHCUAD^=0                    /* IF CHAN/CU ARE DEFINED   01S0404 02478000
*                                                            @Y30LB52*/ 02479000
*     THEN                                                      01S0404 02480000
         L     @08,CNFG0PTR(,CVTPTR)                            01S0404 02481000
         ICM   @03,15,CHCUAD(@08)                               01S0404 02482000
         BZ    @RF00404                                         01S0404 02483000
*     DO;                           /* OUTPUT CH/SA ARRAY    @Y30LB52*/ 02484000
*                                                               02S0406 02485000
*       /*************************************************************/ 02486000
*       /*                                                           */ 02487000
*       /* THE FOLLOWING SEGMENT OF CODE FORMATS AND PRINTS THE FIXED*/ 02488000
*       /* HEADER PORTION OF THE CHANNEL/SA ARRAY IN THE PATH        */ 02489000
*       /* ANALYSIS REPORT(DASD).                                    */ 02490000
*       /*                                                           */ 02491000
*       /*************************************************************/ 02492000
*                                                               02S0406 02493000
*       OUTLINE=CHSAHEAD;           /* FIXED ARRAY HEADER    @Y30LB52*/ 02494000
         MVI   OUTLINE+37(CVTPTR),C' '                          02S0406 02495000
         MVC   OUTLINE+38(95,CVTPTR),OUTLINE+37(CVTPTR)         02S0406 02496000
         MVC   OUTLINE(37,CVTPTR),CHSAHEAD                      02S0406 02497000
*       CALL P1PRINTL;              /* PRINT IT              @Y30LB52*/ 02498000
         BAL   @14,P1PRINTL                                     02S0407 02499000
*       OUTLINE=SAHD;               /* STANDARD SA COLUMN HEADER        02500000
*                                                            @Y30LB52*/ 02501000
         MVI   OUTLINE+98(CVTPTR),C' '                          02S0408 02502000
         MVC   OUTLINE+99(34,CVTPTR),OUTLINE+98(CVTPTR)         02S0408 02503000
         MVC   OUTLINE(98,CVTPTR),SAHD                          02S0408 02504000
*       CALL P1PRINTL;              /* PRINT IT              @Y30LB52*/ 02505000
*                                                               02S0409 02506000
         BAL   @14,P1PRINTL                                     02S0409 02507000
*       /*************************************************************/ 02508000
*       /*                                                           */ 02509000
*       /* FORMAT FIRST LINE OF THE FIXED CH/SA COLUMN HEADER        */ 02510000
*       /*                                                           */ 02511000
*       /*************************************************************/ 02512000
*                                                               02S0410 02513000
*       OUTLINE=SKIPONE;            /* SKIP ONE LINE         @Y30LB52*/ 02514000
         MVI   OUTLINE+1(CVTPTR),C' '                           02S0410 02515000
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          02S0410 02516000
         MVI   OUTLINE(CVTPTR),C' '                             02S0410 02517000
*       CHSAHD='CHANNEL';           /* CHANNEL INTERFACE HEAD@Y30LB52*/ 02518000
         MVI   CHSAHD+7(CVTPTR),C' '                            02S0411 02519000
         MVI   CHSAHD+8(CVTPTR),C' '                            02S0411 02520000
         MVC   CHSAHD(7,CVTPTR),@CC00465                        02S0411 02521000
*       CHSAHD1='TOTAL';            /* TOTAL COLUMN HEAD     @Y30LB52*/ 02522000
         MVC   CHSAHD1(5,CVTPTR),@CC00240                       02S0412 02523000
*       CALL P1PRINTL;              /* PRINT THE LINE        @Y30LB52*/ 02524000
*                                                               02S0413 02525000
         BAL   @14,P1PRINTL                                     02S0413 02526000
*       /*************************************************************/ 02527000
*       /*                                                           */ 02528000
*       /* PRINT THE SECOND LINE OF THE FIXED COLUMN HEADER          */ 02529000
*       /*                                                           */ 02530000
*       /*************************************************************/ 02531000
*                                                               02S0414 02532000
*       OUTLINE=SKIPONE;            /* SKIP ONE LINE         @Y30LB52*/ 02533000
         MVI   OUTLINE+1(CVTPTR),C' '                           02S0414 02534000
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          02S0414 02535000
         MVI   OUTLINE(CVTPTR),C' '                             02S0414 02536000
*       CHSAHD='INTERFACE';         /* CHANNEL INTERFACE HEAD@Y30LB52*/ 02537000
         MVC   CHSAHD(9,CVTPTR),@CC00467                        02S0415 02538000
*       CALL P1PRINTL;              /* PRINT IT              @Y30LB52*/ 02539000
*                                                               02S0416 02540000
         BAL   @14,P1PRINTL                                     02S0416 02541000
*       /*************************************************************/ 02542000
*       /*                                                           */ 02543000
*       /* THE FOLLOWING SEGMENT FORMATS AND PRINTS THE VALUES FOR   */ 02544000
*       /* THIS ARRAY.                                               */ 02545000
*       /*                                                           */ 02546000
*       /*************************************************************/ 02547000
*                                                               02S0417 02548000
*                                                               03S0417 02549000
*       /*************************************************************/ 02550000
*       /*                                                           */ 02551000
*       /* THIS SEGMENT OF CODE FORMATS THE VALUE PORTION OF THE     */ 02552000
*       /* CH/SA ARRAY IN THE PATH ANALYSIS REPORT.                  */ 02553000
*       /*                                                           */ 02554000
*       /*************************************************************/ 02555000
*                                                               03S0417 02556000
*       TOTALS=TOTALS&&TOTALS;      /* CLEAR ALL TOTALS      @Y30LB52*/ 02557000
         XC    TOTALS(76),TOTALS                                03S0417 02558000
*       DO I=1 TO 3;                /* LOOP THROUGH 3 UPPER  @Y30LB52   02559000
*                                      INTERFACES            @Y30LB52*/ 02560000
         LA    I,1                                              03S0418 02561000
@DL00418 DS    0H                                               03S0419 02562000
*         OUTLINE=SKIPONE;          /* SKIP CC               @Y30LB52*/ 02563000
         MVI   OUTLINE+1(CVTPTR),C' '                           03S0419 02564000
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          03S0419 02565000
         MVI   OUTLINE(CVTPTR),C' '                             03S0419 02566000
*         ACCUMTOT=ACCUMTOT&&ACCUMTOT;/* CLEAR ACCUMULATOR TOTALS       02567000
*                                                            @Y30LB52*/ 02568000
         XC    ACCUMTOT(32),ACCUMTOT                            03S0420 02569000
*         J=SAINTFP;                /* POINT TO FIRST INTERFACE 03S0421 02570000
*                                                            @Y30LB52*/ 02571000
         L     @08,CNFG0PTR(,CVTPTR)                            03S0421 02572000
         MVC   J(4),SAINTFP(@08)                                03S0421 02573000
*         RESPECIFY                                             03S0422 02574000
*           SAINTF BASED(J);        /* SET BASE              @Y30LB52*/ 02575000
*         ACCPTR=ADDR(ACCUMTOT);    /* LOAD 1ST ACCUM ADDR   @Y30LB52*/ 02576000
         LA    ACCPTR,ACCUMTOT                                  03S0423 02577000
*         DO SAP=1 TO SANO;         /* LOOP THROUGH ALL SA'S @Y30LB52*/ 02578000
         LA    SAP,1                                            03S0424 02579000
         B     @DE00424                                         03S0424 02580000
@DL00424 DS    0H                                               03S0425 02581000
*           IF SAINTF(I)^=0         /* ERRORS ON THIS INTERFACE?        02582000
*                                                            @Y30LB52*/ 02583000
*             THEN                                              03S0425 02584000
         SLR   @08,@08                                          03S0425 02585000
         LR    @07,I                                            03S0425 02586000
         SLA   @07,2                                            03S0425 02587000
         L     @04,J                                            03S0425 02588000
         AL    @04,@CF00661                                     03S0425 02589000
         L     @07,SAINTF(@07,@04)                              03S0425 02590000
         CR    @07,@08                                          03S0425 02591000
         BE    @RF00425                                         03S0425 02592000
*             DO;                   /* OUTPUT                @Y30LB52*/ 02593000
*               RESPECIFY                                       03S0427 02594000
*                 CHCUTAB BASED(SAINTF(I));/* SET BASE       @Y30LB52*/ 02595000
*               RESPECIFY                                       03S0428 02596000
*                 DASDACCS BASED(DASDACCP);/* SET ACCUM BASE @Y30LB52*/ 02597000
*               DASDACCP=SPLTABP;   /* LOAD ACCUMULATOR ADDR @Y30LB52*/ 02598000
         L     @07,SPLTABP(,@07)                                03S0429 02599000
         ST    @07,DASDACCP                                     03S0429 02600000
*               IF DASDACCP^=0      /* IF NONZERO, ERRORSARE @Y30LB52*/ 02601000
*                 THEN                                          03S0430 02602000
         CR    @07,@08                                          03S0430 02603000
         BE    @RF00430                                         03S0430 02604000
*                 DO;               /* BELOW                 @Y30LB52*/ 02605000
*                   DASDACCE=DASDACCP+(LENGTH(CSPNDLET)-2);/* LOAD      02606000
*                                      END OF ACCUMULATOR    @Y30LB52*/ 02607000
*                                                               03S0432 02608000
         LA    @08,190                                          03S0432 02609000
         ALR   @08,@07                                          03S0432 02610000
         ST    @08,DASDACCE                                     03S0432 02611000
*                   /*************************************************/ 02612000
*                   /*                                               */ 02613000
*                   /* LOOP THROUGH ALL ACCUMULATORS TOTALING THE    */ 02614000
*                   /* ERRORS                                        */ 02615000
*                   /*                                               */ 02616000
*                   /*************************************************/ 02617000
*                                                               03S0433 02618000
*                   DO DASDACCP=DASDACCP TO DASDACCE BY 2;/* @Y30LB52*/ 02619000
         B     @DE00433                                         03S0433 02620000
@DL00433 DS    0H                                               03S0434 02621000
*                     ACCUM1=ACCUM1+DASDACCS;/* INCREMENT TOTAL 03S0434 02622000
*                                                            @Y30LB52*/ 02623000
         LH    @08,ACCUM1(,ACCPTR)                              03S0434 02624000
         AH    @08,DASDACCS(,@07)                               03S0434 02625000
         STH   @08,ACCUM1(,ACCPTR)                              03S0434 02626000
*                   END;            /*                       @Y30LB52*/ 02627000
         AH    @07,@CH00106                                     03S0435 02628000
         ST    @07,DASDACCP                                     03S0435 02629000
@DE00433 C     @07,DASDACCE                                     03S0435 02630000
         BNH   @DL00433                                         03S0435 02631000
*                 END;              /*                       @Y30LB52*/ 02632000
*               ELSE                                            03S0437 02633000
*                 ACCUM1=0;         /* XERO THE INTF. TOTAL  @YM32170*/ 02634000
*                                                               03S0437 02635000
         B     @RC00430                                         03S0437 02636000
@RF00430 SLR   @08,@08                                          03S0437 02637000
         STH   @08,ACCUM1(,ACCPTR)                              03S0437 02638000
*               /*****************************************************/ 02639000
*               /*                                                   */ 02640000
*               /* CONVERT AND STORE IN THE REPORT LINE              */ 02641000
*               /*                                                   */ 02642000
*               /*****************************************************/ 02643000
*                                                               03S0438 02644000
*               CVD(ACCUM1,DECNO);  /* CONVERT BINARY STRING TO 03S0438 02645000
*                                      DECIMAL               @Y30LB52*/ 02646000
@RC00430 LH    @08,ACCUM1(,ACCPTR)                              03S0438 02647000
         CVD   @08,DECNO                                        03S0438 02648000
*               CHS2(SAP)=EDITPAT3; /* MOVE EDIT PATTERN     @ZM34326*/ 02649000
         LR    @07,SAP                                          03S0439 02650000
         MH    @07,@CH00101                                     03S0439 02651000
         ST    @07,@TF00001                                     03S0439 02652000
         ALR   @07,CVTPTR                                       03S0439 02653000
         MVC   CHS2-5(4,@07),EDITPAT3                           03S0439 02654000
*               ED(CHS2(SAP),DECNO1);/* CONVERT TO PRINTABLE HEX        02655000
*                                                            @ZM34326*/ 02656000
         LR    @07,CVTPTR                                       03S0440 02657000
         AL    @07,@TF00001                                     03S0440 02658000
         ED    CHS2-5(4,@07),DECNO1                             03S0440 02659000
*               LTOTAL(SAP)=LTOTAL(SAP)+ACCUM1;/* INCREMTNT COLUMN      02660000
*                                      TOTAL                 @Y30LB52*/ 02661000
         LR    @07,SAP                                          03S0441 02662000
         ALR   @07,@07                                          03S0441 02663000
         LH    @04,LTOTAL-2(@07)                                03S0441 02664000
         ALR   @04,@08                                          03S0441 02665000
         STH   @04,LTOTAL-2(@07)                                03S0441 02666000
*               RTOTAL=RTOTAL+ACCUM1;/* INCREMENT THE ROW TOTAL 03S0442 02667000
*                                                            @Y30LB52*/ 02668000
         AH    @08,RTOTAL                                       03S0442 02669000
         STH   @08,RTOTAL                                       03S0442 02670000
*             END;                  /*                       @Y30LB52*/ 02671000
*           ELSE                                                03S0444 02672000
*             CHS2(SAP)=ASKT4;      /* INTERFACE NOT USED    @ZM34326*/ 02673000
         B     @RC00425                                         03S0444 02674000
@RF00425 LR    @08,SAP                                          03S0444 02675000
         MH    @08,@CH00101                                     03S0444 02676000
         ALR   @08,CVTPTR                                       03S0444 02677000
         MVC   CHS2-5(4,@08),@CC00067                           03S0444 02678000
*           J=J+LENGTH(SAINTFC);    /* INCREMENT TO NEXT INTF@Y30LB52*/ 02679000
@RC00425 LA    @08,12                                           03S0445 02680000
         AL    @08,J                                            03S0445 02681000
         ST    @08,J                                            03S0445 02682000
*         END;                      /*                       @Y30LB52*/ 02683000
*                                                               03S0446 02684000
         AH    SAP,@CH00045                                     03S0446 02685000
@DE00424 L     @08,CNFG0PTR(,CVTPTR)                            03S0446 02686000
         CH    SAP,SANO(,@08)                                   03S0446 02687000
         BNH   @DL00424                                         03S0446 02688000
*         /***********************************************************/ 02689000
*         /*                                                         */ 02690000
*         /* ALL REMAINING SA'S ARE UNUSED                           */ 02691000
*         /*                                                         */ 02692000
*         /***********************************************************/ 02693000
*                                                               03S0447 02694000
*         DO SAP=SANO+1 TO 16;      /* SA'S NOT IN SYSTEM    @Y30LB52*/ 02695000
         L     @08,CNFG0PTR(,CVTPTR)                            03S0447 02696000
         LA    SAP,1                                            03S0447 02697000
         AH    SAP,SANO(,@08)                                   03S0447 02698000
         B     @DE00447                                         03S0447 02699000
@DL00447 DS    0H                                               03S0448 02700000
*           CHS2(SAP)=ASKT4;        /* INDICATE UNUSED       @ZM34326*/ 02701000
         LR    @08,SAP                                          03S0448 02702000
         MH    @08,@CH00101                                     03S0448 02703000
         ALR   @08,CVTPTR                                       03S0448 02704000
         MVC   CHS2-5(4,@08),@CC00067                           03S0448 02705000
*         END;                      /*                       @Y30LB52*/ 02706000
         AH    SAP,@CH00045                                     03S0449 02707000
@DE00447 CH    SAP,@CH00084                                     03S0449 02708000
         BNH   @DL00447                                         03S0449 02709000
*         GTOTAL=GTOTAL+RTOTAL;     /* INCREMENT GRAND TOT   @Y30LB52*/ 02710000
         LH    @08,RTOTAL                                       03S0450 02711000
         LH    @04,GTOTAL                                       03S0450 02712000
         ALR   @04,@08                                          03S0450 02713000
         STH   @04,GTOTAL                                       03S0450 02714000
*         CVD(RTOTAL,DECNO);        /* CONVERT BINARY STRING TO 03S0451 02715000
*                                      DECIMAL               @ZA00699*/ 02716000
         CVD   @08,DECNO                                        03S0451 02717000
*         CHSTOT=EDITPAT5;          /* 5 DIGIT EDIT PATTERN  @ZA00699*/ 02718000
         MVC   CHSTOT(6,CVTPTR),EDITPAT5                        03S0452 02719000
*         ED(CHSTOT,DECNO2);        /* CONVERT TO PRINTABLE HEX 03S0453 02720000
*                                                            @ZA00699*/ 02721000
         ED    CHSTOT(6,CVTPTR),DECNO2                          03S0453 02722000
*         CHSA=I+'C1'X;             /* SET INTERFACE CHAR    @Y30LB52*/ 02723000
         LA    @08,193                                          03S0454 02724000
         ALR   @08,I                                            03S0454 02725000
         STC   @08,CHSA(,CVTPTR)                                03S0454 02726000
*         CALL P1PRINTL;            /* PRINT THE LINE        @Y30LB52*/ 02727000
         BAL   @14,P1PRINTL                                     03S0455 02728000
*         RTOTAL=0;                 /* CLEAR THE ROW TOTAL   @Y30LB52*/ 02729000
         SLR   @08,@08                                          03S0456 02730000
         STH   @08,RTOTAL                                       03S0456 02731000
*       END;                        /*                       @Y30LB52*/ 02732000
*                                                               03S0457 02733000
         AH    I,@CH00045                                       03S0457 02734000
         CH    I,@CH00103                                       03S0457 02735000
         BNH   @DL00418                                         03S0457 02736000
*       /*************************************************************/ 02737000
*       /*                                                           */ 02738000
*       /* OUTPUT THE TOTALS LINE                                    */ 02739000
*       /*                                                           */ 02740000
*       /*************************************************************/ 02741000
*                                                               03S0458 02742000
*       OUTLINE=SKIPTWO;            /* SKIP TWOLINES         @Y30LB52*/ 02743000
         MVI   OUTLINE+1(CVTPTR),C' '                           03S0458 02744000
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          03S0458 02745000
         MVI   OUTLINE(CVTPTR),C'0'                             03S0458 02746000
*       DO SAP=1 TO SANO;           /* LOOP THROUGH ALL SA'S @Y30LB52*/ 02747000
         LA    SAP,1                                            03S0459 02748000
         B     @DE00459                                         03S0459 02749000
@DL00459 DS    0H                                               03S0460 02750000
*         CVD(LTOTAL(SAP),DECNO);   /* CONVERT BINARY STRING TO 03S0460 02751000
*                                      DECIMAL               @Y30LB52*/ 02752000
         LR    @08,SAP                                          03S0460 02753000
         ALR   @08,@08                                          03S0460 02754000
         LH    @08,LTOTAL-2(@08)                                03S0460 02755000
         CVD   @08,DECNO                                        03S0460 02756000
*         CHS2(SAP)=EDITPAT3;       /* MOVE EDIT PATTERN     @ZM34326*/ 02757000
         LR    @08,SAP                                          03S0461 02758000
         MH    @08,@CH00101                                     03S0461 02759000
         ST    @08,@TF00001                                     03S0461 02760000
         ALR   @08,CVTPTR                                       03S0461 02761000
         MVC   CHS2-5(4,@08),EDITPAT3                           03S0461 02762000
*         ED(CHS2(SAP),DECNO1);     /* CONVERT TO PRINTABLE HEX 03S0462 02763000
*                                                            @ZM34326*/ 02764000
         LR    @08,CVTPTR                                       03S0462 02765000
         AL    @08,@TF00001                                     03S0462 02766000
         ED    CHS2-5(4,@08),DECNO1                             03S0462 02767000
*       END;                        /*                       @Y30LB52*/ 02768000
         AH    SAP,@CH00045                                     03S0463 02769000
@DE00459 L     @08,CNFG0PTR(,CVTPTR)                            03S0463 02770000
         CH    SAP,SANO(,@08)                                   03S0463 02771000
         BNH   @DL00459                                         03S0463 02772000
*       CVD(GTOTAL,DECNO);          /* CONVERT BINARY STRING TO 03S0464 02773000
*                                      DECIMAL               @ZA00699*/ 02774000
         LH    @08,GTOTAL                                       03S0464 02775000
         CVD   @08,DECNO                                        03S0464 02776000
*       CHSTOT=EDITPAT5;            /* 5 DIGIT EDIT PATTERN  @ZA00699*/ 02777000
         MVC   CHSTOT(6,CVTPTR),EDITPAT5                        03S0465 02778000
*       ED(CHSTOT,DECNO2);          /* CONVERT TO PRINTABLE HEX 03S0466 02779000
*                                                            @ZA00699*/ 02780000
         ED    CHSTOT(6,CVTPTR),DECNO2                          03S0466 02781000
*       CHSTOTL='TOTAL';            /* SET CONSTANT          @Y30LB52*/ 02782000
         MVC   CHSTOTL(5,CVTPTR),@CC00240                       03S0467 02783000
*       CALL P1PRINTL;              /* PRINT THE LINE        @Y30LB52   02784000
*                                                            @Y30LB52*/ 02785000
         BAL   @14,P1PRINTL                                     03S0468 02786000
*       DCL                                                     03S0469 02787000
*         DASDACCS FIXED(15) BASED(DASDACCP),/* DASD ACCUMULATOR        02788000
*                                                            @Y30LB52*/ 02789000
*         DASDACCP PTR(31) DEF(DRDACCP),/* BASE PTR          @Y30LB52*/ 02790000
*         DASDACCE PTR(31) DEF(DRDACCE),/* END PTR           @Y30LB52*/ 02791000
*         SAINTFC CHAR(12) DEF(SAINTF),/* SAINTF PTRS        @Y30LB52*/ 02792000
*                                                               03S0469 02793000
*         /***********************************************************/ 02794000
*         /*                                                         */ 02795000
*         /* THE FOLLOWING STRUCTURE MAPS THE OUTPUT LINE TO BE USED */ 02796000
*         /* IN THE INSERTION OF THE ROW ERROR COUNTS.               */ 02797000
*         /*                                                         */ 02798000
*         /***********************************************************/ 02799000
*                                                               03S0469 02800000
*         1 * DEF(OUTLINE),                                     03S0469 02801000
*          2 * CHAR(11),            /* UNUSED                @Y30LB52*/ 02802000
*          2 CHSA CHAR(1),          /* INTERFACE             @Y30LB52*/ 02803000
*          2 * CHAR(2),             /* UNUSED                @Y30LB52*/ 02804000
*          2 CHSTOTL CHAR(5),       /* CONSTANT 'TOTAL'      @Y30LB52*/ 02805000
*          2 *(16) CHAR(5),         /* ERROR COUNTS AND SPACE@Y30LB52*/ 02806000
*           3 CHS2 CHAR(4),         /* ERROR COUNT           @ZM34326*/ 02807000
*           3 * CHAR(1),            /* UNUSED                @ZM34326*/ 02808000
*          2 CHSTOT CHAR(6);        /* TOTALS COLUMN         @ZA00699*/ 02809000
*                                                               02S0470 02810000
*       /*************************************************************/ 02811000
*       /*                                                           */ 02812000
*       /* THE FOLLOWING STRUCTURE IS A FIXED HEADER FOR THE CH/SA   */ 02813000
*       /* ARRAY.                                                    */ 02814000
*       /*                                                           */ 02815000
*       /*************************************************************/ 02816000
*                                                               02S0470 02817000
*       DCL                                                     02S0470 02818000
*         1 CHSAHEAD STATIC LOCAL,  /* CHAN/SA HEAD CONSTANT @Y30LB52*/ 02819000
*          2 * CHAR(1) INIT('-'),   /* SKIP 3 CC             @Y30LB52*/ 02820000
*          2 * CHAR(3) INIT('   '), /*                       @Y30LB52*/ 02821000
*          2 * CHAR(33) INIT('CHANNEL/SA INTERFACE ERROR COUNTS'),/*    02822000
*                                                            @Y30LB52*/ 02823000
*                                                               02S0470 02824000
*         /***********************************************************/ 02825000
*         /*                                                         */ 02826000
*         /* THIS STRUCTURE MAPS THE OUTPUT LINE AND IS USED TO FILL */ 02827000
*         /* IN THE COLUMN HEAD CONSTANTS.                           */ 02828000
*         /*                                                         */ 02829000
*         /***********************************************************/ 02830000
*                                                               02S0470 02831000
*         1 * DEF(OUTLINE),         /* MAPS THE OUTPUT LINE  @Y30LB52*/ 02832000
*          2 * CHAR(7),             /*                       @Y30LB52*/ 02833000
*          2 CHSAHD CHAR(9),        /* CHANNEL-INTERFACE POSITION       02834000
*                                                            @Y30LB52*/ 02835000
*          2 * CHAR(85),            /*                       @ZA00699*/ 02836000
*          2 CHSAHD1 CHAR(5);       /*                       @Y30LB52*/ 02837000
*     END;                          /*                       @Y30LB52*/ 02838000
*   IF(MSCTOTAL^=0)|(HTOTAL^=0)     /* DASD ERRORS RECORDED  @Y30LB52*/ 02839000
*     THEN                                                      01S0472 02840000
@RF00404 SLR   @08,@08                                          01S0472 02841000
         L     @03,PAD00PTR(,CVTPTR)                            01S0472 02842000
         CH    @08,MSCTOTAL(,@03)                               01S0472 02843000
         BNE   @RT00472                                         01S0472 02844000
         CH    @08,HTOTAL(,@03)                                 01S0472 02845000
         BE    @RF00472                                         01S0472 02846000
@RT00472 DS    0H                                               01S0473 02847000
*     DO;                           /* FORMAT THE REMAINDER  @Y30LB52*/ 02848000
*                                                               01S0473 02849000
*       /*************************************************************/ 02850000
*       /*                                                           */ 02851000
*       /* THE FOLLOWING INCLUDED SEGMENT FORMATS AND PRINTS THE     */ 02852000
*       /* SA/CONTROLLER PORTION OF THE PATH ANALYSIS REPORT (DASD). */ 02853000
*       /*                                                           */ 02854000
*       /*************************************************************/ 02855000
*                                                               01S0474 02856000
*                                                               02S0474 02857000
*       /*************************************************************/ 02858000
*       /*                                                           */ 02859000
*       /* THE FOLLOWING SEGMENT FORMATS THE CONSTANT HEADER PORTION */ 02860000
*       /* OF THE SA/DASD CONTROLLER ARRAY FOR THE PATH ANALYSIS     */ 02861000
*       /* REPORT(DASD).                                             */ 02862000
*       /*                                                           */ 02863000
*       /*************************************************************/ 02864000
*                                                               02S0474 02865000
*       OUTLINE=SACONHD;            /* SA/CNTLR HEADER       @Y30LB52*/ 02866000
         MVI   OUTLINE+37(CVTPTR),C' '                          02S0474 02867000
         MVC   OUTLINE+38(95,CVTPTR),OUTLINE+37(CVTPTR)         02S0474 02868000
         MVC   OUTLINE(37,CVTPTR),SACONHD                       02S0474 02869000
*       CALL P1PRINTL;              /* PRINT IT              @Y30LB52*/ 02870000
         BAL   @14,P1PRINTL                                     02S0475 02871000
*       OUTLINE=SAHD;               /* FIXED SA COLUMN HEADER@Y30LB52*/ 02872000
         MVI   OUTLINE+98(CVTPTR),C' '                          02S0476 02873000
         MVC   OUTLINE+99(34,CVTPTR),OUTLINE+98(CVTPTR)         02S0476 02874000
         MVC   OUTLINE(98,CVTPTR),SAHD                          02S0476 02875000
*       CALL P1PRINTL;              /* PRINT IT              @Y30LB52*/ 02876000
*                                                               02S0477 02877000
         BAL   @14,P1PRINTL                                     02S0477 02878000
*       /*************************************************************/ 02879000
*       /*                                                           */ 02880000
*       /* OUTPUT THE COLUMN HEADER IMMEDIATELY BEFORE THE ARRAY     */ 02881000
*       /*                                                           */ 02882000
*       /*************************************************************/ 02883000
*                                                               02S0478 02884000
*       OUTLINE=SKIPONE;            /* SKIP ONE LINE         @Y30LB52*/ 02885000
         MVI   OUTLINE+1(CVTPTR),C' '                           02S0478 02886000
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          02S0478 02887000
         MVI   OUTLINE(CVTPTR),C' '                             02S0478 02888000
*       SACON1='CONTROLLER';        /* CONTROLLER COLUMN     @Y30LB52*/ 02889000
         MVC   SACON1(10,CVTPTR),@CC00500                       02S0479 02890000
*       SACON2='TOTAL';             /* TOTAL COLUMN          @Y30LB52*/ 02891000
         MVC   SACON2(5,CVTPTR),@CC00240                        02S0480 02892000
*       CALL P1PRINTL;              /* PRINT IT              @Y30LB52*/ 02893000
*                                                               02S0481 02894000
         BAL   @14,P1PRINTL                                     02S0481 02895000
*       /*************************************************************/ 02896000
*       /*                                                           */ 02897000
*       /* THE INCLUDED SEGMENT FORMATS AND FILLS IN THE VALUES      */ 02898000
*       /*                                                           */ 02899000
*       /*************************************************************/ 02900000
*                                                               02S0482 02901000
*                                                               03S0482 02902000
*       /*************************************************************/ 02903000
*       /*                                                           */ 02904000
*       /* THE FOLLOWING SEGMENT FORMATS AND PRINTS THE VALUE LINES  */ 02905000
*       /* FOR THE SA/CONTROLLER ARRAY(3330).                        */ 02906000
*       /*                                                           */ 02907000
*       /*************************************************************/ 02908000
*                                                               03S0482 02909000
*       TOTALS=TOTALS&&TOTALS;      /* CLEAR ALL TOTALS      @Y30LB52*/ 02910000
         XC    TOTALS(76),TOTALS                                03S0482 02911000
*       VSADRC=VSADRC&&VSADRC;      /* CLEAR VALID SA ARRAY  @Y30LB52*/ 02912000
         XC    VSADRC(16),VSADRC                                03S0483 02913000
*       DO I=1 TO 4;                /* LOOP THROUGH FOUR CONTROLLERS    02914000
*                                                            @Y30LB52*/ 02915000
         LA    I,1                                              03S0484 02916000
@DL00484 DS    0H                                               03S0485 02917000
*         ACCUMTOT=ACCUMTOT&&ACCUMTOT;/* CLEAR ACCUMULATORS   @Y30L52   02918000
*                                                            @Y30LB52*/ 02919000
*                                                               03S0485 02920000
         XC    ACCUMTOT(32),ACCUMTOT                            03S0485 02921000
*         /***********************************************************/ 02922000
*         /*                                                         */ 02923000
*         /* THE FOLLOWING INCLUDED SEGMENT TOTALS THE ACCUMULATORS  */ 02924000
*         /* FOR ALL ERRORS RECORDED THROUGH A 'MSC' PATH.           */ 02925000
*         /*                                                         */ 02926000
*         /***********************************************************/ 02927000
*                                                               03S0486 02928000
*                                                               04S0486 02929000
*         /***********************************************************/ 02930000
*         /*                                                         */ 02931000
*         /* THE FOLLOWING SEGMENT OF CODE CHECKS EACH MSC PATH FOR  */ 02932000
*         /* ACCUMLATED ERRORS AND ADDS ANY FOUND TO THE PROPER      */ 02933000
*         /* TOTALS.                                                 */ 02934000
*         /*                                                         */ 02935000
*         /***********************************************************/ 02936000
*                                                               04S0486 02937000
*         DO MSC=1 TO 8 WHILE(MSCINTF(MSC)^='0000'X);/* LOOP THROUGH    02938000
*                                      ALL MSC'S             @Y30LB52*/ 02939000
         LA    @08,1                                            04S0486 02940000
         STH   @08,MSC                                          04S0486 02941000
@DL00486 SLA   @08,3                                            04S0486 02942000
         L     @04,PAD00PTR(,CVTPTR)                            04S0486 02943000
         ST    @08,@TF00001                                     04S0486 02944000
         ALR   @08,@04                                          04S0486 02945000
         CLC   MSCINTF-8(2,@08),@CB00246                        04S0486 02946000
         BE    @DC00486                                         04S0486 02947000
*           SATABP=SATABPTR(MSC);   /* LOAD THE SATAB POINTER@Y30LB52   02948000
*                                                            @Y30LB52*/ 02949000
         L     @08,@TF00001                                     04S0487 02950000
         L     SATABP,SATABPTR-8(@08,@04)                       04S0487 02951000
*           RESPECIFY                                           04S0488 02952000
*             SADRDDSD BASED(SATABP);/*                      @Y30LB52*/ 02953000
*           IF SATABP^=0            /* DOES THE 'SA' LEVEL TABLE        02954000
*                                      EXIST?                @Y30LB52*/ 02955000
*             THEN                                              04S0489 02956000
         LTR   SATABP,SATABP                                    04S0489 02957000
         BZ    @RF00489                                         04S0489 02958000
*             DO;                   /* IF SO, LOOK FOR ACCUMULATOR      02959000
*                                                            @Y30LB52*/ 02960000
*               ACCPTR=ADDR(ACCUMTOT);/* INITIALIZE TOTALS POINTER      02961000
*                                                            @Y30LB52*/ 02962000
         LA    ACCPTR,ACCUMTOT                                  04S0491 02963000
*               DO SAP=1 TO SANO;   /* LOOP THROUGH ALL POSSIBLE SA'S   02964000
*                                                            @Y30LB52*/ 02965000
         LA    SAP,1                                            04S0492 02966000
         B     @DE00492                                         04S0492 02967000
@DL00492 DS    0H                                               04S0493 02968000
*                 IF SADASDAC(SAP)^=0/* IF AN ACCUMULATOR ARRAY 04S0493 02969000
*                                      EXISTS                @Y30LB52*/ 02970000
*                   THEN                                        04S0493 02971000
         LR    @08,SAP                                          04S0493 02972000
         SLA   @08,3                                            04S0493 02973000
         AL    @08,@CF00661                                     04S0493 02974000
         L     @08,SADASDAC-4(@08,SATABP)                       04S0493 02975000
         LTR   @08,@08                                          04S0493 02976000
         BZ    @RF00493                                         04S0493 02977000
*                   DO;             /* ERRORS ARE RECORDED BELOW        02978000
*                                                            @Y30LB52*/ 02979000
*                     DASDACCP=SADASDAC(SAP);/* LOAD ACCUMULATOR        02980000
*                                      POINTER               @Y30LB52*/ 02981000
         ST    @08,DASDACCP                                     04S0495 02982000
*                     CALL P1SACON3;/* CALL TOTALS PROCEDURE @Y30LB52*/ 02983000
         BAL   @14,P1SACON3                                     04S0496 02984000
*                   END;            /*                       @Y30LB52*/ 02985000
*                 ACCPTR=ACCPTR+2;  /* INCREMENT THE TOTALS POINTER     02986000
*                                                            @Y30LB52*/ 02987000
@RF00493 AH    ACCPTR,@CH00106                                  04S0498 02988000
*               END;                /*                       @Y30LB52*/ 02989000
         AH    SAP,@CH00045                                     04S0499 02990000
@DE00492 L     @08,CNFG0PTR(,CVTPTR)                            04S0499 02991000
         CH    SAP,SANO(,@08)                                   04S0499 02992000
         BNH   @DL00492                                         04S0499 02993000
*             END;                  /*                       @Y30LB52*/ 02994000
*         END;                      /*                       @Y30LB52*/ 02995000
@RF00489 LA    @08,1                                            04S0501 02996000
         AH    @08,MSC                                          04S0501 02997000
         STH   @08,MSC                                          04S0501 02998000
         CH    @08,@CH00099                                     04S0501 02999000
         BNH   @DL00486                                         04S0501 03000000
@DC00486 DS    0H                                               04S0502 03001000
*P1SACON3:                                                      05S0502 03002000
*         PROCEDURE OPTIONS(SAVE(14));/*                     @Y30LB52*/ 03003000
*                                                               05S0502 03004000
         B     @PB00003                                         05S0502 03005000
P1SACON3 ST    @14,12(,@13)                                     05S0502 03006000
*         /***********************************************************/ 03007000
*         /*                                                         */ 03008000
*         /* THIS PROCEDURE IS CALLED TO TOTAL ALL ACCUMULATORS IN A */ 03009000
*         /* PATH WITH A 'SA' AND 3330 CONTROLLER SELECTED           */ 03010000
*         /* PREVIOUSLY.                                             */ 03011000
*         /*                                                         */ 03012000
*         /***********************************************************/ 03013000
*                                                               05S0503 03014000
*         RESPECIFY                                             05S0503 03015000
*           SPNDLETB BASED(DASDACCP);/*                      @Y30LB52*/ 03016000
*         DASDACCP=ADDR(SPNDLETB(I,1));/* ADDRESS ACCUMULATOR ROW       03017000
*                                                            @Y30LB52*/ 03018000
         LR    @08,I                                            05S0504 03019000
         MH    @08,@CH00555                                     05S0504 03020000
         L     @04,DASDACCP                                     05S0504 03021000
         AL    @04,@CF00666                                     05S0504 03022000
         LA    @08,SPNDLETB(@08,@04)                            05S0504 03023000
         ST    @08,DASDACCP                                     05S0504 03024000
*         DASDACCE=DASDACCP+(LENGTH(SPNDLES)*8)-2;/* END OF ROW 05S0505 03025000
*                                                            @Y30LB52*/ 03026000
*                                                               05S0505 03027000
         LR    @04,@08                                          05S0505 03028000
         SH    @04,@CH00654                                     05S0505 03029000
         ST    @04,DASDACCE                                     05S0505 03030000
*         /***********************************************************/ 03031000
*         /*                                                         */ 03032000
*         /* TOTAL ALL ERRORS RECORDED FOR THIS CONTROLLER.          */ 03033000
*         /*                                                         */ 03034000
*         /***********************************************************/ 03035000
*                                                               05S0506 03036000
*         DO DASDACCP=DASDACCP TO DASDACCE BY 2;/*           @Y30LB52*/ 03037000
         B     @DE00506                                         05S0506 03038000
@DL00506 DS    0H                                               05S0507 03039000
*           RESPECIFY                                           05S0507 03040000
*             DASDACCS BASED(DASDACCP);/* SET BASE           @Y30LB52*/ 03041000
*           ACCUM1=ACCUM1+DASDACCS; /* INCREMENT TOTALS ACCUMULATOR     03042000
*                                                            @Y30LB52*/ 03043000
         LH    @04,ACCUM1(,ACCPTR)                              05S0508 03044000
         AH    @04,DASDACCS(,@08)                               05S0508 03045000
         STH   @04,ACCUM1(,ACCPTR)                              05S0508 03046000
*         END;                      /*                       @Y30LB52*/ 03047000
         AH    @08,@CH00106                                     05S0509 03048000
         ST    @08,DASDACCP                                     05S0509 03049000
@DE00506 C     @08,DASDACCE                                     05S0509 03050000
         BNH   @DL00506                                         05S0509 03051000
*       END P1SACON3;               /*                       @Y30LB52*/ 03052000
@EL00003 DS    0H                                               05S0510 03053000
@EF00003 DS    0H                                               05S0510 03054000
@ER00003 L     @14,12(,@13)                                     05S0510 03055000
         BR    @14                                              05S0510 03056000
@PB00003 DS    0H                                               05S0511 03057000
*                                                               03S0511 03058000
*       /*************************************************************/ 03059000
*       /*                                                           */ 03060000
*       /* THE FOLLOWING INCLUDED SEGMENT TOTALS THE ACCUMULATORS FOR*/ 03061000
*       /* ALL ERRORS RECORDED THROUGH HOST CHANNEL PATHS.           */ 03062000
*       /*                                                           */ 03063000
*       /*************************************************************/ 03064000
*                                                               03S0511 03065000
*                                                               04S0511 03066000
*       /*************************************************************/ 03067000
*       /*                                                           */ 03068000
*       /* THE FOLLOWING SEGMENT OF CODE CHECKS THE PATHS ORIGNATING */ 03069000
*       /* IN HOST CHANNELS FOR ACCUMULATED ERRORS AND IF FOUND, ADDS*/ 03070000
*       /* TO THE APPROPRIATE TOTALS.                                */ 03071000
*       /*                                                           */ 03072000
*       /*************************************************************/ 03073000
*                                                               04S0511 03074000
*       ACCPTR=ADDR(ACCUMTOT);      /* INITIALIZE ACCUMULATOR PTR       03075000
*                                                            @Y30LB52*/ 03076000
         LA    ACCPTR,ACCUMTOT                                  04S0511 03077000
*       DO SAP=1 TO SANO;           /* LOOP THROUGH SA'S     @Y30LB52*/ 03078000
         LA    SAP,1                                            04S0512 03079000
         B     @DE00512                                         04S0512 03080000
@DL00512 DS    0H                                               04S0513 03081000
*         J=SAINTFP+(SAP-1)*12;     /* ADDRESS UPPER INTERFACE ARRAY    03082000
*                                                            @Y30LB52*/ 03083000
         L     @08,CNFG0PTR(,CVTPTR)                            04S0513 03084000
         LR    @07,SAP                                          04S0513 03085000
         BCTR  @07,0                                            04S0513 03086000
         MH    @07,@CH00035                                     04S0513 03087000
         AL    @07,SAINTFP(,@08)                                04S0513 03088000
         ST    @07,J                                            04S0513 03089000
*         DO UINTF=1 TO 3;          /* LOOP THROUGH THREE INTERFACES    03090000
*                                                            @Y30LB52*/ 03091000
         LA    @08,1                                            04S0514 03092000
         STH   @08,UINTF                                        04S0514 03093000
@DL00514 DS    0H                                               04S0515 03094000
*           CHCUPTR=J->SAINTF(UINTF);/* LOAD CHCHTAB POINTER @Y30LB52*/ 03095000
         SLA   @08,2                                            04S0515 03096000
         L     @04,J                                            04S0515 03097000
         AL    @04,@CF00661                                     04S0515 03098000
         L     CHCUPTR,SAINTF(@08,@04)                          04S0515 03099000
*           RESPECIFY                                           04S0516 03100000
*             CHCUTAB BASED(CHCUPTR);/*                      @Y30LB52*/ 03101000
*           IF CHCUPTR^=0           /* CHCUTAB EXISTENT?     @Y30LB52*/ 03102000
*             THEN                                              04S0517 03103000
         SLR   @08,@08                                          04S0517 03104000
         CR    CHCUPTR,@08                                      04S0517 03105000
         BE    @RF00517                                         04S0517 03106000
*             DO;                   /* IF SO, LOOK FOR ACCUMULATORS     03107000
*                                                            @Y30LB52*/ 03108000
*               DASDACCP=SPLTABP;   /* LOAD ACCUMULATOR ADDRESS 04S0519 03109000
*                                                            @Y30LB52*/ 03110000
         L     @04,SPLTABP(,CHCUPTR)                            04S0519 03111000
         ST    @04,DASDACCP                                     04S0519 03112000
*               IF DASDACCP^=0      /* DOES ACCUMULATOR EXIST?  04S0520 03113000
*                                                            @Y30LB52*/ 03114000
*                 THEN                                          04S0520 03115000
         CR    @04,@08                                          04S0520 03116000
         BE    @RF00520                                         04S0520 03117000
*                 DO;               /* IF SO, TOTAL THE ERRORS  04S0521 03118000
*                                                            @Y30LB52*/ 03119000
*                   CALL P1SACON3;  /*                       @Y30LB52*/ 03120000
         BAL   @14,P1SACON3                                     04S0522 03121000
*                 END;              /*                       @Y30LB52*/ 03122000
*             END;                  /*                       @Y30LB52*/ 03123000
@RF00520 DS    0H                                               04S0525 03124000
*         END;                      /*                       @Y30LB52*/ 03125000
@RF00517 LA    @08,1                                            04S0525 03126000
         AH    @08,UINTF                                        04S0525 03127000
         STH   @08,UINTF                                        04S0525 03128000
         CH    @08,@CH00103                                     04S0525 03129000
         BNH   @DL00514                                         04S0525 03130000
*         ACCPTR=ACCPTR+2;          /* INCREMENT THE ACCUMULATOR PTR    03131000
*                                                            @Y30LB52*/ 03132000
         AH    ACCPTR,@CH00106                                  04S0526 03133000
*       END;                        /*                       @Y30LB52*/ 03134000
         AH    SAP,@CH00045                                     04S0527 03135000
@DE00512 L     @08,CNFG0PTR(,CVTPTR)                            04S0527 03136000
         CH    SAP,SANO(,@08)                                   04S0527 03137000
         BNH   @DL00512                                         04S0527 03138000
*                                                               03S0528 03139000
*       /*************************************************************/ 03140000
*       /*                                                           */ 03141000
*       /* THIS CODE FORMATS THE OUTPUT LINE CONSISTING OF ONE       */ 03142000
*       /* ACCUMULATOR TOTAL FOR EACH 'SA' AND A ROW TOTAL.          */ 03143000
*       /*                                                           */ 03144000
*       /*************************************************************/ 03145000
*                                                               03S0528 03146000
*       ACCPTR=ADDR(ACCUMTOT);      /* LOAD FIRST ACCUM ADDR @Y30LB52*/ 03147000
         LA    ACCPTR,ACCUMTOT                                  03S0528 03148000
*       RTOTAL=0;                   /* CLEAR THE ROW TOTAL   @Y30LB52*/ 03149000
         SLR   @08,@08                                          03S0529 03150000
         STH   @08,RTOTAL                                       03S0529 03151000
*       OUTLINE=SKIPONE;            /* INITIALIZE THE LINE   @Y30LB52*/ 03152000
         MVI   OUTLINE+1(CVTPTR),C' '                           03S0530 03153000
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          03S0530 03154000
         MVI   OUTLINE(CVTPTR),C' '                             03S0530 03155000
*       DO SAP=1 TO SANO;           /* LOOP THROUGH ATTACHED SA'S       03156000
*                                                            @Y30LB52*/ 03157000
         LA    SAP,1                                            03S0531 03158000
         B     @DE00531                                         03S0531 03159000
@DL00531 DS    0H                                               03S0532 03160000
*         RTOTAL=RTOTAL+ACCUM1;     /* INCREMENT ROW TOTAL   @Y30LB52*/ 03161000
         LH    @08,ACCUM1(,ACCPTR)                              03S0532 03162000
         LH    @07,RTOTAL                                       03S0532 03163000
         ALR   @07,@08                                          03S0532 03164000
         STH   @07,RTOTAL                                       03S0532 03165000
*         LTOTAL(SAP)=LTOTAL(SAP)+ACCUM1;/* INCREMENT COLUMN TOTAL      03166000
*                                                            @Y30LB52*/ 03167000
         LR    @07,SAP                                          03S0533 03168000
         ALR   @07,@07                                          03S0533 03169000
         LH    @04,LTOTAL-2(@07)                                03S0533 03170000
         ALR   @04,@08                                          03S0533 03171000
         STH   @04,LTOTAL-2(@07)                                03S0533 03172000
*         CVD(ACCUM1,DECNO);        /* CONVERT BINARY STRING TO 03S0534 03173000
*                                      DECIMAL               @Y30LB52*/ 03174000
         CVD   @08,DECNO                                        03S0534 03175000
*         CHS2(SAP)=EDITPAT3;       /* MOVE EDIT PATTERN     @ZM34326*/ 03176000
         LR    @08,SAP                                          03S0535 03177000
         MH    @08,@CH00101                                     03S0535 03178000
         ST    @08,@TF00001                                     03S0535 03179000
         ALR   @08,CVTPTR                                       03S0535 03180000
         MVC   CHS2-5(4,@08),EDITPAT3                           03S0535 03181000
*         ED(CHS2(SAP),DECNO1);     /* CONVERT TO PRINTABLE HEX 03S0536 03182000
*                                                            @ZM34326*/ 03183000
         LR    @08,CVTPTR                                       03S0536 03184000
         AL    @08,@TF00001                                     03S0536 03185000
         ED    CHS2-5(4,@08),DECNO1                             03S0536 03186000
*         ACCPTR=ACCPTR+2;          /* INCREMENT ACCUMS      @Y30LB52*/ 03187000
         AH    ACCPTR,@CH00106                                  03S0537 03188000
*       END;                        /*                       @Y30LB52*/ 03189000
         AH    SAP,@CH00045                                     03S0538 03190000
@DE00531 L     @08,CNFG0PTR(,CVTPTR)                            03S0538 03191000
         CH    SAP,SANO(,@08)                                   03S0538 03192000
         BNH   @DL00531                                         03S0538 03193000
*       CHSA=(I-1)|'F0'X;           /* CNTLR NUMBER          @Y30LB52*/ 03194000
         LR    @08,I                                            03S0539 03195000
         BCTR  @08,0                                            03S0539 03196000
         O     @08,@CF00511                                     03S0539 03197000
         STC   @08,CHSA(,CVTPTR)                                03S0539 03198000
*       DO SAP=SANO+1 TO 16;        /* LOOP THROUGH REMAINING SA'S      03199000
*                                                            @Y30LB52*/ 03200000
         L     @08,CNFG0PTR(,CVTPTR)                            03S0540 03201000
         LA    SAP,1                                            03S0540 03202000
         AH    SAP,SANO(,@08)                                   03S0540 03203000
         B     @DE00540                                         03S0540 03204000
@DL00540 DS    0H                                               03S0541 03205000
*         CHS2(SAP)=ASKT4;          /* SET NO COUNT          @ZM34326*/ 03206000
         LR    @08,SAP                                          03S0541 03207000
         MH    @08,@CH00101                                     03S0541 03208000
         ALR   @08,CVTPTR                                       03S0541 03209000
         MVC   CHS2-5(4,@08),@CC00067                           03S0541 03210000
*       END;                        /*                       @Y30LB52*/ 03211000
         AH    SAP,@CH00045                                     03S0542 03212000
@DE00540 CH    SAP,@CH00084                                     03S0542 03213000
         BNH   @DL00540                                         03S0542 03214000
*       CVD(RTOTAL,DECNO);          /* CONVERT BINARY STRING TO 03S0543 03215000
*                                      DECIMAL               @ZA00699*/ 03216000
         LH    @08,RTOTAL                                       03S0543 03217000
         CVD   @08,DECNO                                        03S0543 03218000
*       CHSTOT=EDITPAT5;            /* 5 DIGIT EDIT PATTERN  @ZA00699*/ 03219000
         MVC   CHSTOT(6,CVTPTR),EDITPAT5                        03S0544 03220000
*       ED(CHSTOT,DECNO2);          /* CONVERT TO PRINTABLE HEX 03S0545 03221000
*                                                            @ZA00699*/ 03222000
         ED    CHSTOT(6,CVTPTR),DECNO2                          03S0545 03223000
*       CALL P1PRINTL;              /* PRINT THE LINE        @Y30LB52*/ 03224000
         BAL   @14,P1PRINTL                                     03S0546 03225000
*     END;                          /*                       @Y30LB52*/ 03226000
*                                                               03S0547 03227000
         AH    I,@CH00045                                       03S0547 03228000
         CH    I,@CH00055                                       03S0547 03229000
         BNH   @DL00484                                         03S0547 03230000
*   /*****************************************************************/ 03231000
*   /*                                                               */ 03232000
*   /* OUTPUT THE GRAND TOTALS LINE.                                 */ 03233000
*   /*                                                               */ 03234000
*   /*****************************************************************/ 03235000
*                                                               03S0548 03236000
*   OUTLINE=SKIPTWO;                /* INITIALIZE THE LINE   @Y30LB52*/ 03237000
         MVI   OUTLINE+1(CVTPTR),C' '                           03S0548 03238000
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          03S0548 03239000
         MVI   OUTLINE(CVTPTR),C'0'                             03S0548 03240000
*   CHSTOTL='TOTAL';                /* SET LINE CONSTANT     @Y30LB52*/ 03241000
         MVC   CHSTOTL(5,CVTPTR),@CC00240                       03S0549 03242000
*   DO SAP=1 TO SANO;               /* LOOP THROUGH ALL SA'S @Y30LB52*/ 03243000
         LA    SAP,1                                            03S0550 03244000
         B     @DE00550                                         03S0550 03245000
@DL00550 DS    0H                                               03S0551 03246000
*     CVD(LTOTAL(SAP),DECNO);       /* CONVERT BINARY STRING TO 03S0551 03247000
*                                      DECIMAL               @Y30LB52*/ 03248000
         LR    @08,SAP                                          03S0551 03249000
         ALR   @08,@08                                          03S0551 03250000
         LH    @08,LTOTAL-2(@08)                                03S0551 03251000
         CVD   @08,DECNO                                        03S0551 03252000
*     CHS2(SAP)=EDITPAT3;           /* MOVE EDIT PATTERN     @ZM34326*/ 03253000
         LR    @07,SAP                                          03S0552 03254000
         MH    @07,@CH00101                                     03S0552 03255000
         ST    @07,@TF00001                                     03S0552 03256000
         ALR   @07,CVTPTR                                       03S0552 03257000
         MVC   CHS2-5(4,@07),EDITPAT3                           03S0552 03258000
*     ED(CHS2(SAP),DECNO1);         /* CONVERT TO PRINTABLE HEX 03S0553 03259000
*                                                            @ZM34326*/ 03260000
         LR    @07,CVTPTR                                       03S0553 03261000
         AL    @07,@TF00001                                     03S0553 03262000
         ED    CHS2-5(4,@07),DECNO1                             03S0553 03263000
*     GTOTAL=GTOTAL+LTOTAL(SAP);    /* INCREMENT GRAND TOTAL @Y30LB52*/ 03264000
         AH    @08,GTOTAL                                       03S0554 03265000
         STH   @08,GTOTAL                                       03S0554 03266000
*   END;                            /*                       @Y30LB52*/ 03267000
         AH    SAP,@CH00045                                     03S0555 03268000
@DE00550 L     @08,CNFG0PTR(,CVTPTR)                            03S0555 03269000
         CH    SAP,SANO(,@08)                                   03S0555 03270000
         BNH   @DL00550                                         03S0555 03271000
*   CVD(GTOTAL,DECNO);              /* CONVERT BINARY STRING TO 03S0556 03272000
*                                      DECIMAL               @ZA00699*/ 03273000
         LH    @08,GTOTAL                                       03S0556 03274000
         CVD   @08,DECNO                                        03S0556 03275000
*   CHSTOT=EDITPAT5;                /* 5 DIGIT EDIT PATTERN  @ZA00699*/ 03276000
         MVC   CHSTOT(6,CVTPTR),EDITPAT5                        03S0557 03277000
*   ED(CHSTOT,DECNO2);              /* CONVERT TO PRINTABLE HEX 03S0558 03278000
*                                                            @ZA00699*/ 03279000
         ED    CHSTOT(6,CVTPTR),DECNO2                          03S0558 03280000
*   CALL P1PRINTL;                  /* PRINT THE LINE        @Y30LB52*/ 03281000
         BAL   @14,P1PRINTL                                     03S0559 03282000
*                                                               02S0560 03283000
*   /*****************************************************************/ 03284000
*   /*                                                               */ 03285000
*   /* THE FOLLOWING STRUCTURE CONTAINS THE FIXED SA/CONTROLLER      */ 03286000
*   /* HEADER                                                        */ 03287000
*   /*                                                               */ 03288000
*   /*****************************************************************/ 03289000
*                                                               02S0560 03290000
*   DCL                                                         02S0560 03291000
*     1 SACONHD STATIC LOCAL,       /*                       @Y30LB52*/ 03292000
*      2 * CHAR(1) INIT('-'),       /* SKIP 3 CC             @Y30LB52*/ 03293000
*      2 * CHAR(36) INIT('SA/CONTROLLER INTERFACE ERROR COUNTS'),/*     03294000
*                                                            @Y30LB52*/ 03295000
*                                                               02S0560 03296000
*     /***************************************************************/ 03297000
*     /*                                                             */ 03298000
*     /* THE FOLLOWING STRUCTURE MAPS THE OUTPUT LINE FOR THE PURPOSE*/ 03299000
*     /* OF INSERTING THE 'CONTROLLER' AND 'TOTALS' COLUMN CONSTANTS.*/ 03300000
*     /*                                                             */ 03301000
*     /***************************************************************/ 03302000
*                                                               02S0560 03303000
*     1 * DEF(OUTLINE),             /*                       @Y30LB52*/ 03304000
*      2 * CHAR(5),                 /*                       @Y30LB52*/ 03305000
*      2 SACON1 CHAR(10),           /*                       @Y30LB52*/ 03306000
*      2 * CHAR(86),                /*                       @ZA00699*/ 03307000
*      2 SACON2 CHAR(5);            /*                       @Y30LB52*/ 03308000
*                                                               01S0561 03309000
*   /*****************************************************************/ 03310000
*   /*                                                               */ 03311000
*   /* THE FOLLWING SEGMENT OF INCLUDED CODE FORMATS AND PRINTS THE  */ 03312000
*   /* 3330 CONTROLLER/DRIVE PORTION OF THE PATH ANALYSIS REPORT     */ 03313000
*   /* (DASD).                                                       */ 03314000
*   /*                                                               */ 03315000
*   /*****************************************************************/ 03316000
*                                                               01S0561 03317000
*                                                               02S0561 03318000
*   /*****************************************************************/ 03319000
*   /*                                                               */ 03320000
*   /* THIS SEGMENT OF CODE TOTALS THE ERROR COUNTS FOR ALL          */ 03321000
*   /* CONTROLLER DRIVE COMBINATIONS UNDER EACH SA. FOR EACH SA IN A */ 03322000
*   /* PATH WITH ACCUMULATED ERRORS, A CONTROLLER/DRIVE ARRAY IS     */ 03323000
*   /* FORMATTED AND PRINTED. FOR EACH THREE PRINTED ARRAYS, THE PAGE*/ 03324000
*   /* IS EJECTED.                                                   */ 03325000
*   /*                                                               */ 03326000
*   /*****************************************************************/ 03327000
*                                                               02S0561 03328000
*   ARRAY=0;                        /* INITIALIZE PRINTED ARRAYS        03329000
*                                      COUNT                 @Y30LB52*/ 03330000
         SLR   @08,@08                                          02S0561 03331000
         STH   @08,ARRAY                                        02S0561 03332000
*   TOTALS=TOTALS&&TOTALS;          /* CLEAR ALL TOTALS      @Y30LB52*/ 03333000
         XC    TOTALS(76),TOTALS                                02S0562 03334000
*   DO SAP=1 TO SANO;               /* LOOP THROUGH ALL SA'S IN THE     03335000
*                                      SUBSYSTEM             @Y30LB52*/ 03336000
         LA    SAP,1                                            02S0563 03337000
         B     @DE00563                                         02S0563 03338000
@DL00563 DS    0H                                               02S0564 03339000
*     IF(ARRAY//3)=0 THEN                                       02S0564 03340000
         LH    @00,ARRAY                                        02S0564 03341000
         SRDA  @00,32                                           02S0564 03342000
         D     @00,@CF00103                                     02S0564 03343000
         LTR   @00,@00                                          02S0564 03344000
         BNZ   @RF00564                                         02S0564 03345000
*       DO;                         /* IF THIS ARRAY IS A MULTIPLE OF   03346000
*                                      THREE                 @Y30LB52*/ 03347000
*                                                               02S0565 03348000
*         /***********************************************************/ 03349000
*         /*                                                         */ 03350000
*         /* SKIP TO A NEW PAGE BEFORE PRINTING                      */ 03351000
*         /*                                                         */ 03352000
*         /***********************************************************/ 03353000
*                                                               02S0566 03354000
*         OUTLINE=NEWPAGE;          /* SET NEW PAGE CC       @Y30LB52*/ 03355000
         MVI   OUTLINE+1(CVTPTR),C' '                           02S0566 03356000
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          02S0566 03357000
         MVI   OUTLINE(CVTPTR),C'1'                             02S0566 03358000
*         CALL P1PRINTL;            /* PRINT IT              @Y30LB52*/ 03359000
         BAL   @14,P1PRINTL                                     02S0567 03360000
*         OUTLINE=DASDHEAD;         /* PAD DASD HEADER       @Y30LB52*/ 03361000
         MVI   OUTLINE+58(CVTPTR),C' '                          02S0568 03362000
         MVC   OUTLINE+59(74,CVTPTR),OUTLINE+58(CVTPTR)         02S0568 03363000
         MVC   OUTLINE(58,CVTPTR),DASDHEAD                      02S0568 03364000
*         CALL P1PRINTL;            /* PRINT IT              @Y30LB52*/ 03365000
         BAL   @14,P1PRINTL                                     02S0569 03366000
*       END;                        /*                       @Y30LB52*/ 03367000
*     ARRAY=ARRAY+1;                /* INCREMENT THE PRINTED ARRAY      03368000
*                                      COUNT                 @Y30LB52*/ 03369000
@RF00564 LA    @08,1                                            02S0571 03370000
         AH    @08,ARRAY                                        02S0571 03371000
         STH   @08,ARRAY                                        02S0571 03372000
*     OUTLINE=CONDRHD;              /*                       @Y30LB52   03373000
*                                      CONTROLLER/DRIVE HEADER       */ 03374000
         MVI   OUTLINE+64(CVTPTR),C' '                          02S0572 03375000
         MVC   OUTLINE+65(68,CVTPTR),OUTLINE+64(CVTPTR)         02S0572 03376000
         MVC   OUTLINE(64,CVTPTR),CONDRHD                       02S0572 03377000
*     OUTLINE(LENGTH(CONDRHD)-2)=(SAP-1)|'0';/* SET SA NUMBER IN        03378000
*                                      ARRAY HEADER          @Y30LB52*/ 03379000
         LR    @08,SAP                                          02S0573 03380000
         BCTR  @08,0                                            02S0573 03381000
         O     @08,@CF00073                                     02S0573 03382000
         STC   @08,OUTLINE+61(,CVTPTR)                          02S0573 03383000
*     CALL P1PRINTL;                /* PRINT IT              @Y30LB52*/ 03384000
         BAL   @14,P1PRINTL                                     02S0574 03385000
*     OUTLINE=SKIPTWO;              /* SKIP TWO LINES        @Y30LB52*/ 03386000
         MVI   OUTLINE+1(CVTPTR),C' '                           02S0575 03387000
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          02S0575 03388000
         MVI   OUTLINE(CVTPTR),C'0'                             02S0575 03389000
*     OUTLINE(22:22+LENGTH(DRIVEHD))=DRIVEHD;/*              @ZM34326   03390000
*                                      AND PRINT THE DRIVE HEADER    */ 03391000
         MVI   OUTLINE+69(CVTPTR),C' '                          02S0576 03392000
         MVC   OUTLINE+21(48,CVTPTR),DRIVEHD                    02S0576 03393000
*     CALL P1PRINTL;                /*                       @Y30LB52*/ 03394000
         BAL   @14,P1PRINTL                                     02S0577 03395000
*     OUTLINE=SKIPONE;              /* SKIP ONE LINE         @Y30LB52*/ 03396000
         MVI   OUTLINE+1(CVTPTR),C' '                           02S0578 03397000
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          02S0578 03398000
         MVI   OUTLINE(CVTPTR),C' '                             02S0578 03399000
*     DCONTRL='CONTROLLER';         /* SET ARRAY HEADER      @Y30LB52*/ 03400000
         MVC   DCONTRL(10,CVTPTR),@CC00500                      02S0579 03401000
*     DTOTL='TOTAL';                /*                       @Y30LB52*/ 03402000
         MVC   DTOTL(5,CVTPTR),@CC00240                         02S0580 03403000
*     CALL P1PRINTL;                /*                       @Y30LB52*/ 03404000
         BAL   @14,P1PRINTL                                     02S0581 03405000
*     DO I=1 TO 4;                  /* LOOP THROUGH ABOXES   @Y30LB52*/ 03406000
         LA    I,1                                              02S0582 03407000
@DL00582 DS    0H                                               02S0583 03408000
*       OUTLINE=SKIPONE;            /* SKIP LINE CC          @Y30LB52*/ 03409000
*                                                               02S0583 03410000
         MVI   OUTLINE+1(CVTPTR),C' '                           02S0583 03411000
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          02S0583 03412000
         MVI   OUTLINE(CVTPTR),C' '                             02S0583 03413000
*       /*************************************************************/ 03414000
*       /*                                                           */ 03415000
*       /* THE FOLLOWING SEGMENT TOTALS THE ERRORS FOR ONE LINE OF   */ 03416000
*       /* THE CONTROLLER/DRIVE ERROR ARRAY. THE ERRORS TOTALLED ARE */ 03417000
*       /* THOSE IN MSC-SA PATHS.                                    */ 03418000
*       /*                                                           */ 03419000
*       /*************************************************************/ 03420000
*                                                               02S0584 03421000
*                                                               03S0584 03422000
*       /*************************************************************/ 03423000
*       /*                                                           */ 03424000
*       /* THIS SEGMENT TOTALS THE ERRORS ACCUMULATED FOR A          */ 03425000
*       /* CONTROLLER/DRIVE COMBINATION UNDER A SA. THIS SEGMENT     */ 03426000
*       /* TOTALS ONLY THE DASD ERRORS LOGGED THROUGH A MSC.         */ 03427000
*       /*                                                           */ 03428000
*       /*************************************************************/ 03429000
*                                                               03S0584 03430000
*       DO MSC=1 TO 8 WHILE(MSCINTF(MSC)^='0000'X);/* LOOP THROUGH      03431000
*                                      ALL MSC'S             @Y30LB52*/ 03432000
         LA    @08,1                                            03S0584 03433000
         STH   @08,MSC                                          03S0584 03434000
@DL00584 SLA   @08,3                                            03S0584 03435000
         L     @07,PAD00PTR(,CVTPTR)                            03S0584 03436000
         ST    @08,@TF00001                                     03S0584 03437000
         ALR   @08,@07                                          03S0584 03438000
         CLC   MSCINTF-8(2,@08),@CB00246                        03S0584 03439000
         BE    @DC00584                                         03S0584 03440000
*         SATABP=SATABPTR(MSC);     /* LOAD THE SATAB PTR    @Y30LB52*/ 03441000
         L     @08,PAD00PTR(,CVTPTR)                            03S0585 03442000
         L     @04,@TF00001                                     03S0585 03443000
         L     SATABP,SATABPTR-8(@04,@08)                       03S0585 03444000
*         IF SATABP^=0              /* PATH DEFINED          @Y30LB52*/ 03445000
*           THEN                                                03S0586 03446000
         SLR   @08,@08                                          03S0586 03447000
         CR    SATABP,@08                                       03S0586 03448000
         BE    @RF00586                                         03S0586 03449000
*           DO;                     /* TOTAL ERRORS          @Y30LB52*/ 03450000
*                                                               03S0587 03451000
*             /*******************************************************/ 03452000
*             /*                                                     */ 03453000
*             /* IF THE APPROPRIATE POINTER IN THE SATAB IS NON-ZERO,*/ 03454000
*             /* AN ERROR COUNT HAS BEEN ACCUMULATED WITH THIS SA IN */ 03455000
*             /* THE PATH. THE ACCUMULATOR TABLE IS ACCESSED AND ALL */ 03456000
*             /* COUNTS ARE ADDED TO THE TOTAL.                      */ 03457000
*             /*                                                     */ 03458000
*             /*******************************************************/ 03459000
*                                                               03S0588 03460000
*             RESPECIFY                                         03S0588 03461000
*               SADRDDSD BASED(SATABP);/*                    @Y30LB52*/ 03462000
*             IF SADASDAC(SAP)^=0   /* ERRORS RECORDED       @Y30LB52*/ 03463000
*               THEN                                            03S0589 03464000
         LR    @04,SAP                                          03S0589 03465000
         SLA   @04,3                                            03S0589 03466000
         AL    @04,@CF00661                                     03S0589 03467000
         C     @08,SADASDAC-4(@04,SATABP)                       03S0589 03468000
         BE    @RF00589                                         03S0589 03469000
*               DO;                 /* ADD TO TOTAL          @Y30LB52*/ 03470000
*                 ACCPTR=ADDR(ACCUMTOT);/* LOAD TOTAL ARRAY ADDRESS     03471000
*                                                            @Y30LB52*/ 03472000
*                                                               03S0591 03473000
         LA    ACCPTR,ACCUMTOT                                  03S0591 03474000
*                 /***************************************************/ 03475000
*                 /*                                                 */ 03476000
*                 /* LOOP THROUGH ALL ACCUMULATOR ELEMENTS, ADDING TO*/ 03477000
*                 /* TOTAL.                                          */ 03478000
*                 /*                                                 */ 03479000
*                 /***************************************************/ 03480000
*                                                               03S0592 03481000
*                 DO K=1 TO 8;      /* LOOP THROUGH DRIVES   @Y30LB52*/ 03482000
         LA    K,1                                              03S0592 03483000
@DL00592 DS    0H                                               03S0593 03484000
*                   RESPECIFY                                   03S0593 03485000
*                     SPNDLETB BASED(SADASDAC(SAP));/*       @Y30LB52*/ 03486000
*                   DASDACCP=ADDR(SPNDLETB(I,K));/* LOAD ACCP POINTER   03487000
*                                                            @Y30LB52*/ 03488000
         LR    @08,I                                            03S0594 03489000
         SLA   @08,3                                            03S0594 03490000
         ALR   @08,K                                            03S0594 03491000
         MH    @08,@CH00058                                     03S0594 03492000
         LR    @15,SAP                                          03S0594 03493000
         SLA   @15,3                                            03S0594 03494000
         AL    @15,@CF00661                                     03S0594 03495000
         L     @01,SADASDAC-4(@15,SATABP)                       03S0594 03496000
         AL    @01,@CF00667                                     03S0594 03497000
         LA    @08,SPNDLETB(@08,@01)                            03S0594 03498000
         ST    @08,DASDACCP                                     03S0594 03499000
*                   RESPECIFY                                   03S0595 03500000
*                     SPNDLES BASED(DASDACCP);/*             @Y30LB52*/ 03501000
*                   ACCUM1=ACCUM1+DRVEQCHK;/* DRIVE CHECKS   @Y30LB52*/ 03502000
         LH    @15,ACCUM1(,ACCPTR)                              03S0596 03503000
         AH    @15,DRVEQCHK(,@08)                               03S0596 03504000
         STH   @15,ACCUM1(,ACCPTR)                              03S0596 03505000
*                   ACCUM1=ACCUM1+STCTLCHK;/* STOR CNTL CHECKS  03S0597 03506000
*                                                            @Y30LB52*/ 03507000
         AH    @15,STCTLCHK(,@08)                               03S0597 03508000
         STH   @15,ACCUM1(,ACCPTR)                              03S0597 03509000
*                   ACCUM1=ACCUM1+STCTLCCK;/* STOR CNTL CNTL CHECKS     03510000
*                                                            @Y30LB52*/ 03511000
         AH    @15,STCTLCCK(,@08)                               03S0598 03512000
         STH   @15,ACCUM1(,ACCPTR)                              03S0598 03513000
*                   ACCPTR=ACCPTR+2;/* INCREMENT TOTAL POINTER  03S0599 03514000
*                                                            @Y30LB52*/ 03515000
         AH    ACCPTR,@CH00106                                  03S0599 03516000
*                 END;              /*                       @Y30LB52*/ 03517000
         AH    K,@CH00045                                       03S0600 03518000
         CH    K,@CH00099                                       03S0600 03519000
         BNH   @DL00592                                         03S0600 03520000
*               END;                /*                       @Y30LB52*/ 03521000
*           END;                    /*                       @Y30LB52*/ 03522000
@RF00589 DS    0H                                               03S0603 03523000
*       END;                        /*                       @Y30LB52*/ 03524000
@RF00586 LA    @08,1                                            03S0603 03525000
         AH    @08,MSC                                          03S0603 03526000
         STH   @08,MSC                                          03S0603 03527000
         CH    @08,@CH00099                                     03S0603 03528000
         BNH   @DL00584                                         03S0603 03529000
@DC00584 DS    0H                                               03S0604 03530000
*                                                               03S0604 03531000
*       /*************************************************************/ 03532000
*       /*                                                           */ 03533000
*       /* THE FOLLOWING STRUCTURE MAPS THE OUTPUT LINE FOR THE      */ 03534000
*       /* VALUES SUPPLIED IN THE ABOVE SEGMENT.                     */ 03535000
*       /*                                                           */ 03536000
*       /*************************************************************/ 03537000
*                                                               03S0604 03538000
*       DCL                                                     03S0604 03539000
*         1 * DEF(OUTLINE),         /*                       @Y30LB52*/ 03540000
*          2 * CHAR(9),             /*                       @Y30LB52*/ 03541000
*          2 CNTLRNO CHAR(1),       /* CONTROLLER NUMBER     @Y30LB52*/ 03542000
*          2 * CHAR(20),            /*                       @ZM34326*/ 03543000
*          2 *(8) CHAR(5),          /*                       @Y30LB52*/ 03544000
*           3 ERRCNT1 CHAR(4),      /* EBCDIC COUNT          @ZM34326*/ 03545000
*           3 * CHAR(1),            /*                       @ZM34326*/ 03546000
*          2 ERRTOT CHAR(6);        /* ROW TOTAL             @ZA00699*/ 03547000
*                                                               02S0605 03548000
*       /*************************************************************/ 03549000
*       /*                                                           */ 03550000
*       /* THE FOLLWING INCLUDED SEGMENT OF CODE TOALS THE CONTROLLER*/ 03551000
*       /* /DRIVE ERRORS RECORDED THROUGH HOST CHANNEL-SA PATHS.     */ 03552000
*       /*                                                           */ 03553000
*       /*************************************************************/ 03554000
*                                                               02S0605 03555000
*                                                               03S0605 03556000
*       /*************************************************************/ 03557000
*       /*                                                           */ 03558000
*       /* THE FOLLOWING SEGMENT TOTALS THE DASD ERRORS BY           */ 03559000
*       /* CNTLR/DRIVE COMBINATION THAT HAVE BEEN ACCUMULATED THROUGH*/ 03560000
*       /* HOST CHANNEL OPERATIONS(NON-MSC). THE ERRORS ARE TOTALED  */ 03561000
*       /* IN AN ARRAY WITH ONE ELEMENT FOR EACH CONTROLLER/DRIVE    */ 03562000
*       /* INTERFACE.                                                */ 03563000
*       /*                                                           */ 03564000
*       /*************************************************************/ 03565000
*                                                               03S0605 03566000
*       J=SAINTFP+(SAP-1)*12;       /* ADDRESS PROPER SAINTF ENTRY      03567000
*                                                            @Y3OLB52*/ 03568000
         L     @08,CNFG0PTR(,CVTPTR)                            03S0605 03569000
         LR    @07,SAP                                          03S0605 03570000
         BCTR  @07,0                                            03S0605 03571000
         MH    @07,@CH00035                                     03S0605 03572000
         AL    @07,SAINTFP(,@08)                                03S0605 03573000
         ST    @07,J                                            03S0605 03574000
*       DO UINTF=1 TO 3;            /* LOOP THROUGH INTERFACES  03S0606 03575000
*                                                            @Y30LB52*/ 03576000
         LA    @08,1                                            03S0606 03577000
         STH   @08,UINTF                                        03S0606 03578000
@DL00606 DS    0H                                               03S0607 03579000
*         CHCUPTR=J->SAINTF(UINTF); /* ADDRESS CHCUTAB       @Y30LB52*/ 03580000
         SLA   @08,2                                            03S0607 03581000
         L     @04,J                                            03S0607 03582000
         AL    @04,@CF00661                                     03S0607 03583000
         L     CHCUPTR,SAINTF(@08,@04)                          03S0607 03584000
*         IF CHCUPTR^=0             /* IF ADDRESS ZERO       @Y30LB52*/ 03585000
*           THEN                                                03S0608 03586000
         SLR   @08,@08                                          03S0608 03587000
         CR    CHCUPTR,@08                                      03S0608 03588000
         BE    @RF00608                                         03S0608 03589000
*           DO;                     /*                       @Y30LB52*/ 03590000
*                                                               03S0609 03591000
*             /*******************************************************/ 03592000
*             /*                                                     */ 03593000
*             /* THE CHCUTAB CONTAINS A POINTER TO AN ACCUMULATOR    */ 03594000
*             /* ARRAY OF ERRORS LOGGED THROUGH THIS INTERFACE OF THE*/ 03595000
*             /* SA. IF NON-ZERO, THE ERRORS ARE TOTALED BY          */ 03596000
*             /* CONTROLLER/DRIVE INTERFACE.                         */ 03597000
*             /*                                                     */ 03598000
*             /*******************************************************/ 03599000
*                                                               03S0610 03600000
*             IF SPLTABP^=0         /* ACCUMULATOR EXISTS    @Y30LB52*/ 03601000
*               THEN                                            03S0610 03602000
         C     @08,SPLTABP(,CHCUPTR)                            03S0610 03603000
         BE    @RF00610                                         03S0610 03604000
*               DO;                 /* TOTAL THE ERRORS      @Y30LB52*/ 03605000
*                 ACCPTR=ADDR(ACCUMTOT);/* ADDRESS C/D TOTALS   03S0612 03606000
*                                                            @Y30LB52*/ 03607000
*                                                               03S0612 03608000
         LA    ACCPTR,ACCUMTOT                                  03S0612 03609000
*                 /***************************************************/ 03610000
*                 /*                                                 */ 03611000
*                 /* LOOP THROUGH THE ENTIRE ACCUMULATOR ARRAY,      */ 03612000
*                 /* TOTALING THE ERRORS BY CONTROLLER/DRIVE.        */ 03613000
*                 /*                                                 */ 03614000
*                 /***************************************************/ 03615000
*                                                               03S0613 03616000
*                 DO K=1 TO 8;      /* LOOP THROUGH DRIVES   @Y30LB52*/ 03617000
         LA    K,1                                              03S0613 03618000
@DL00613 DS    0H                                               03S0614 03619000
*                   RESPECIFY                                   03S0614 03620000
*                     SPNDLES BASED(DASDACCP);/*             @Y30LB52*/ 03621000
*                   RESPECIFY                                   03S0615 03622000
*                     SPNDLETB BASED(SPLTABP);/*             @Y30LB52*/ 03623000
*                   DASDACCP=ADDR(SPNDLETB(I,K));/*          @Y30LB52*/ 03624000
         LR    @08,I                                            03S0616 03625000
         SLA   @08,3                                            03S0616 03626000
         ALR   @08,K                                            03S0616 03627000
         MH    @08,@CH00058                                     03S0616 03628000
         L     @01,SPLTABP(,CHCUPTR)                            03S0616 03629000
         AL    @01,@CF00667                                     03S0616 03630000
         LA    @08,SPNDLETB(@08,@01)                            03S0616 03631000
         ST    @08,DASDACCP                                     03S0616 03632000
*                   ACCUM1=ACCUM1+DRVEQCHK;/* DRIVE CHECKS   @Y30LB52*/ 03633000
         LH    @15,ACCUM1(,ACCPTR)                              03S0617 03634000
         AH    @15,DRVEQCHK(,@08)                               03S0617 03635000
         STH   @15,ACCUM1(,ACCPTR)                              03S0617 03636000
*                   ACCUM1=ACCUM1+STCTLCHK;/* STORAGE CONTROL CHKS      03637000
*                                                            @Y30LB52*/ 03638000
         AH    @15,STCTLCHK(,@08)                               03S0618 03639000
         STH   @15,ACCUM1(,ACCPTR)                              03S0618 03640000
*                   ACCUM1=ACCUM1+STCTLCCK;/* ST CNTL CNTL CHKS 03S0619 03641000
*                                                            @Y30LB52*/ 03642000
         AH    @15,STCTLCCK(,@08)                               03S0619 03643000
         STH   @15,ACCUM1(,ACCPTR)                              03S0619 03644000
*                   ACCPTR=ACCPTR+2;/* TO NEXT TOTAL ENTRY   @Y30LB52*/ 03645000
         AH    ACCPTR,@CH00106                                  03S0620 03646000
*                 END;              /*                       @Y30LB52*/ 03647000
         AH    K,@CH00045                                       03S0621 03648000
         CH    K,@CH00099                                       03S0621 03649000
         BNH   @DL00613                                         03S0621 03650000
*               END;                /*                       @Y30LB52*/ 03651000
*           END;                    /*                       @Y30LB52*/ 03652000
@RF00610 DS    0H                                               03S0624 03653000
*       END;                        /*                       @Y30LB52*/ 03654000
@RF00608 LA    @08,1                                            03S0624 03655000
         AH    @08,UINTF                                        03S0624 03656000
         STH   @08,UINTF                                        03S0624 03657000
         CH    @08,@CH00103                                     03S0624 03658000
         BNH   @DL00606                                         03S0624 03659000
*       ACCPTR=ADDR(ACCUMTOT);      /* ADDRESS FIRST TOTAL   @Y30LB52*/ 03660000
         LA    ACCPTR,ACCUMTOT                                  03S0625 03661000
*       RTOTAL=0;                   /* INITIALIZE ROW TOTAL  @Y30LB52*/ 03662000
         SLR   @08,@08                                          03S0626 03663000
         STH   @08,RTOTAL                                       03S0626 03664000
*       DO K=1 TO 8;                /* LOOP THROUGH EIGHT DRIVES        03665000
*                                                            @Y30LB52*/ 03666000
         LA    K,1                                              03S0627 03667000
@DL00627 DS    0H                                               03S0628 03668000
*         LTOTAL(K)=LTOTAL(K)+ACCUM1;/* INCREMENT COLUMN        03S0628 03669000
*                                      TOTAL@Y30LB52         @Y30LB52*/ 03670000
         LR    @08,K                                            03S0628 03671000
         ALR   @08,@08                                          03S0628 03672000
         LH    @07,ACCUM1(,ACCPTR)                              03S0628 03673000
         LH    @15,LTOTAL-2(@08)                                03S0628 03674000
         ALR   @15,@07                                          03S0628 03675000
         STH   @15,LTOTAL-2(@08)                                03S0628 03676000
*         RTOTAL=RTOTAL+ACCUM1;     /* INCREMENT THE ROW TOTAL  03S0629 03677000
*                                                            @Y30LB52*/ 03678000
         LH    @08,RTOTAL                                       03S0629 03679000
         ALR   @08,@07                                          03S0629 03680000
         STH   @08,RTOTAL                                       03S0629 03681000
*         CVD(ACCUM1,DECNO);        /* CONVERT BINARY STRING TO 03S0630 03682000
*                                      DECIMAL               @Y30LB52*/ 03683000
         CVD   @07,DECNO                                        03S0630 03684000
*         ERRCNT1(K)=EDITPAT3;      /* MOVE EDIT PATTERN     @ZM34326*/ 03685000
         LR    @08,K                                            03S0631 03686000
         MH    @08,@CH00101                                     03S0631 03687000
         ST    @08,@TF00001                                     03S0631 03688000
         ALR   @08,CVTPTR                                       03S0631 03689000
         MVC   ERRCNT1-5(4,@08),EDITPAT3                        03S0631 03690000
*         ED(ERRCNT1(K),DECNO1);    /* CONVERT TO PRINTABLE HEX 03S0632 03691000
*                                                            @ZM34326*/ 03692000
         LR    @08,CVTPTR                                       03S0632 03693000
         AL    @08,@TF00001                                     03S0632 03694000
         ED    ERRCNT1-5(4,@08),DECNO1                          03S0632 03695000
*         ACCPTR=ACCPTR+2;          /* INCREMENT ACCUMULATOR PTR        03696000
*                                                            @Y30LB52*/ 03697000
         AH    ACCPTR,@CH00106                                  03S0633 03698000
*       END;                        /*                       @Y30LB52*/ 03699000
         AH    K,@CH00045                                       03S0634 03700000
         CH    K,@CH00099                                       03S0634 03701000
         BNH   @DL00627                                         03S0634 03702000
*       ACCUMTOT=ACCUMTOT&&ACCUMTOT;/* CLEAR ACCUMULATORS    @Y30LB52*/ 03703000
         XC    ACCUMTOT(32),ACCUMTOT                            03S0635 03704000
*       CVD(RTOTAL,DECNO);          /* CONVERT BINARY STRING TO 03S0636 03705000
*                                      DECIMAL               @ZA00699*/ 03706000
         LH    @08,RTOTAL                                       03S0636 03707000
         CVD   @08,DECNO                                        03S0636 03708000
*       ERRTOT=EDITPAT5;            /* 5 DIGIT EDIT PATTERN  @ZA00699*/ 03709000
         MVC   ERRTOT(6,CVTPTR),EDITPAT5                        03S0637 03710000
*       ED(ERRTOT,DECNO2);          /* CONVERT TO PRINTABLE HEX 03S0638 03711000
*                                                            @ZA00699*/ 03712000
         ED    ERRTOT(6,CVTPTR),DECNO2                          03S0638 03713000
*       CNTLRNO=(I-1)|'F0'X;        /* SET CONTROLLER INDEX  @Y30LB52*/ 03714000
         LR    @08,I                                            03S0639 03715000
         BCTR  @08,0                                            03S0639 03716000
         O     @08,@CF00511                                     03S0639 03717000
         STC   @08,CNTLRNO(,CVTPTR)                             03S0639 03718000
*       CALL P1PRINTL;              /* PRINT THE LINE        @Y30LB52*/ 03719000
         BAL   @14,P1PRINTL                                     03S0640 03720000
*     END;                          /*                       @Y30LB52*/ 03721000
*                                                               02S0641 03722000
         AH    I,@CH00045                                       02S0641 03723000
         CH    I,@CH00055                                       02S0641 03724000
         BNH   @DL00582                                         02S0641 03725000
*     /***************************************************************/ 03726000
*     /*                                                             */ 03727000
*     /* FORMAT AND PRINT THE TOTALS LINE                            */ 03728000
*     /*                                                             */ 03729000
*     /***************************************************************/ 03730000
*                                                               02S0642 03731000
*     OUTLINE=SKIPTWO;              /* SKIP TWO CC           @Y30LB52*/ 03732000
         MVI   OUTLINE+1(CVTPTR),C' '                           02S0642 03733000
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          02S0642 03734000
         MVI   OUTLINE(CVTPTR),C'0'                             02S0642 03735000
*     DO I=1 TO 8;                  /* LOOP THROUGH 8 DRIVES @Y30LB52*/ 03736000
         LA    I,1                                              02S0643 03737000
@DL00643 DS    0H                                               02S0644 03738000
*       CVD(LTOTAL(I),DECNO);       /* CONVERT BINARY STRING TO 02S0644 03739000
*                                      DECIMAL               @Y30LB52*/ 03740000
         LR    @08,I                                            02S0644 03741000
         ALR   @08,@08                                          02S0644 03742000
         LH    @08,LTOTAL-2(@08)                                02S0644 03743000
         CVD   @08,DECNO                                        02S0644 03744000
*       ERRCNT1(I)=EDITPAT3;        /* MOVE EDIT PATTERN     @ZM34326*/ 03745000
         LR    @07,I                                            02S0645 03746000
         MH    @07,@CH00101                                     02S0645 03747000
         ST    @07,@TF00001                                     02S0645 03748000
         ALR   @07,CVTPTR                                       02S0645 03749000
         MVC   ERRCNT1-5(4,@07),EDITPAT3                        02S0645 03750000
*       ED(ERRCNT1(I),DECNO1);      /* CONVERT TO PRINTABLE HEX 02S0646 03751000
*                                                            @ZM34326*/ 03752000
         LR    @07,CVTPTR                                       02S0646 03753000
         AL    @07,@TF00001                                     02S0646 03754000
         ED    ERRCNT1-5(4,@07),DECNO1                          02S0646 03755000
*       GTOTAL=GTOTAL+LTOTAL(I);    /* INCREMENT GRAND TOTAL @Y30LB52*/ 03756000
         AH    @08,GTOTAL                                       02S0647 03757000
         STH   @08,GTOTAL                                       02S0647 03758000
*     END;                          /*                       @Y30LB52*/ 03759000
         AH    I,@CH00045                                       02S0648 03760000
         CH    I,@CH00099                                       02S0648 03761000
         BNH   @DL00643                                         02S0648 03762000
*     CVD(GTOTAL,DECNO);            /* CONVERT BINARY STRING TO 02S0649 03763000
*                                      DECIMAL               @ZA00699*/ 03764000
         LH    @08,GTOTAL                                       02S0649 03765000
         CVD   @08,DECNO                                        02S0649 03766000
*     ERRTOT=EDITPAT5;              /* 5 DIGIT EDIT PATTERN  @ZA00699*/ 03767000
         MVC   ERRTOT(6,CVTPTR),EDITPAT5                        02S0650 03768000
*     ED(ERRTOT,DECNO2);            /* CONVERT TO PRINTABLE HEX 02S0651 03769000
*                                                            @ZA00699*/ 03770000
         ED    ERRTOT(6,CVTPTR),DECNO2                          02S0651 03771000
*     CHSTOTL='TOTAL';              /* TOTAL LINE CONSTANT   @Y30LB52*/ 03772000
         MVC   CHSTOTL(5,CVTPTR),@CC00240                       02S0652 03773000
*     CALL P1PRINTL;                /* PRINT THE LINE        @Y30LB52*/ 03774000
         BAL   @14,P1PRINTL                                     02S0653 03775000
*     TOTALS=TOTALS&&TOTALS;        /* CLEAR TOTALS          @Y30LB52*/ 03776000
         XC    TOTALS(76),TOTALS                                02S0654 03777000
*   END;                            /*                       @Y30LB52*/ 03778000
         AH    SAP,@CH00045                                     02S0655 03779000
@DE00563 L     @08,CNFG0PTR(,CVTPTR)                            02S0655 03780000
         CH    SAP,SANO(,@08)                                   02S0655 03781000
         BNH   @DL00563                                         02S0655 03782000
*                                                               02S0656 03783000
*   /*****************************************************************/ 03784000
*   /*                                                               */ 03785000
*   /* THE FOLLOWING STRUCTURE MAPS THE OUTPUT LINE AND CONTAINS A   */ 03786000
*   /* CONSTANT HEADER FOR THE CONTROLLER/DRIVE ARRAYS.              */ 03787000
*   /*                                                               */ 03788000
*   /*****************************************************************/ 03789000
*                                                               02S0656 03790000
*   DCL                                                         02S0656 03791000
*     1 CONDRHD STATIC LOCAL,       /*                       @Y30LB52*/ 03792000
*      2 CONDRHD1,                  /*                       @Y30LB52*/ 03793000
*       3 * CHAR(1) INIT('-'),      /*                       @Y30LB52*/ 03794000
*       3 * CHAR(3) INIT('   '),                                02S0656 03795000
*       3 * CHAR(27) INIT('CONTROLLER/DRIVE INTERFACE '),/*  @Y30LB52*/ 03796000
*       3 * CHAR(12) INIT('ERROR COUNTS'),/*                 @Y30LB52*/ 03797000
*       3 * CHAR(21) INIT('(STAGING ADAPTER 800)'),/*        @ZM31022*/ 03798000
*                                                               02S0656 03799000
*     /***************************************************************/ 03800000
*     /*                                                             */ 03801000
*     /* THE FOLLOWING CONSTANT IS THE HEADER LINE IMMEDIATELY       */ 03802000
*     /* PRECEDING THE ARRAY.                                        */ 03803000
*     /*                                                             */ 03804000
*     /***************************************************************/ 03805000
*                                                               02S0656 03806000
*     DRIVEHD CHAR(48) STATIC LOCAL INIT(                       02S0656 03807000
*         'DRIVE       A    B    C    D    E    F    G    H'),  02S0656 03808000
*                                                               02S0656 03809000
*     /***************************************************************/ 03810000
*     /*                                                             */ 03811000
*     /* THE FOLLOWING ARRAY MAPS THE OUTPUT LINE FOR THE PURPOSE OF */ 03812000
*     /* INSERTING AND PRINTING THE CONSTANTS 'CONTROLLER' AND       */ 03813000
*     /* 'TOTAL'                                                     */ 03814000
*     /*                                                             */ 03815000
*     /***************************************************************/ 03816000
*                                                               02S0656 03817000
*     1 * DEF(OUTLINE),             /*                       @Y30LB52*/ 03818000
*      2 * CHAR(5),                 /*                       @Y30LB52*/ 03819000
*      2 DCONTRL CHAR(10),          /*                       @Y30LB52*/ 03820000
*      2 * CHAR(57),                /*                       @ZA00699*/ 03821000
*      2 DTOTL CHAR(5);             /*                       @Y30LB52*/ 03822000
*                                                               01S0657 03823000
*   /*****************************************************************/ 03824000
*   /*                                                               */ 03825000
*   /* THE FOLLOWING INCLUDED SEGMENT FORMATS AND PRINTS THE REAL    */ 03826000
*   /* DEVICE PATH PORTION OF THE PATH ANALYSIS REPORT (3330).       */ 03827000
*   /*                                                               */ 03828000
*   /*****************************************************************/ 03829000
*                                                               01S0657 03830000
*                                                               02S0657 03831000
*   /*****************************************************************/ 03832000
*   /*                                                               */ 03833000
*   /* THIS SEGMENT SETS UP THE HEADER LINES FOR THE REAL PATH       */ 03834000
*   /* PORTION OF THE PATH ANALYSIS REPORT(DASD).                    */ 03835000
*   /*                                                               */ 03836000
*   /*****************************************************************/ 03837000
*                                                               02S0657 03838000
*   IF MSCTOTAL^=0                  /* ERRORS RECORDED THRO  @Y30LB52*/ 03839000
*     THEN                                                      02S0657 03840000
         L     @08,PAD00PTR(,CVTPTR)                            02S0657 03841000
         ICM   @03,3,MSCTOTAL(@08)                              02S0657 03842000
         BZ    @RF00657                                         02S0657 03843000
*     DO;                           /* MSC, PRODUCE ARRAY    @Y30LB52*/ 03844000
*       OUTLINE=NEWPAGE;            /* SET NEW PAGE CC       @Y30LB52*/ 03845000
         MVI   OUTLINE+1(CVTPTR),C' '                           02S0659 03846000
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          02S0659 03847000
         MVI   OUTLINE(CVTPTR),C'1'                             02S0659 03848000
*       CALL P1PRINTL;              /* OUTPUT                @Y30LB52*/ 03849000
         BAL   @14,P1PRINTL                                     02S0660 03850000
*       OUTLINE=DASDHEAD;           /* SET PA(DASD PORTION) HEAD        03851000
*                                                            @Y30LB52*/ 03852000
         MVI   OUTLINE+58(CVTPTR),C' '                          02S0661 03853000
         MVC   OUTLINE+59(74,CVTPTR),OUTLINE+58(CVTPTR)         02S0661 03854000
         MVC   OUTLINE(58,CVTPTR),DASDHEAD                      02S0661 03855000
*       CALL P1PRINTL;              /* OUTPUT                @Y30LB52*/ 03856000
         BAL   @14,P1PRINTL                                     02S0662 03857000
*       OUTLINE=DASDPTHD;           /* SET REPORT SECTION HEAD  02S0663 03858000
*                                                            @Y30LB52*/ 03859000
         MVI   OUTLINE+58(CVTPTR),C' '                          02S0663 03860000
         MVC   OUTLINE+59(74,CVTPTR),OUTLINE+58(CVTPTR)         02S0663 03861000
         MVC   OUTLINE(58,CVTPTR),DASDPTHD                      02S0663 03862000
*       CALL P1PRINTL;              /* OUTPUT                @Y30LB52*/ 03863000
         BAL   @14,P1PRINTL                                     02S0664 03864000
*       OUTLINE=DASDCOLH;           /* SET COLUMN HEAD       @Y30LB52*/ 03865000
         MVI   OUTLINE+102(CVTPTR),C' '                         02S0665 03866000
         MVC   OUTLINE+103(30,CVTPTR),OUTLINE+102(CVTPTR)       02S0665 03867000
         MVC   OUTLINE(102,CVTPTR),DASDCOLH                     02S0665 03868000
*       CALL P1PRINTL;              /* OUTPUT                @Y30LB52*/ 03869000
         BAL   @14,P1PRINTL                                     02S0666 03870000
*       OUTLINE=SKIPONE;            /* INDICATE SINGLE LINE SKIP        03871000
*                                                            @Y30LB52*/ 03872000
         MVI   OUTLINE+1(CVTPTR),C' '                           02S0667 03873000
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          02S0667 03874000
         MVI   OUTLINE(CVTPTR),C' '                             02S0667 03875000
*       DASDCL1='CHECK';            /* SET FIRST CONSTANT    @Y30LB52*/ 03876000
         MVC   DASDCL1(5,CVTPTR),@CC00567                       02S0668 03877000
*       DASDCL2='EQUIP CHECK';      /* SET SECOND CONSTANT   @ZM31022*/ 03878000
         MVC   DASDCL2(11,CVTPTR),@CC00569                      02S0669 03879000
*       DASDCL3='CNTL CHECK';       /* THIRD                 @Y30LB52*/ 03880000
         MVC   DASDCL3(10,CVTPTR),@CC00572                      02S0670 03881000
*       CALL P1PRINTL;              /*                       @Y30LB52*/ 03882000
*                                                               02S0671 03883000
         BAL   @14,P1PRINTL                                     02S0671 03884000
*       /*************************************************************/ 03885000
*       /*                                                           */ 03886000
*       /* THE FOLLOWING INCLUDED SEGMENT FORMATS AND INSERTS THE    */ 03887000
*       /* ACCUMULATORS INTO THE VALUE PORTION OF THE REPORT AND     */ 03888000
*       /* PRINTS THE LINES.                                         */ 03889000
*       /*                                                           */ 03890000
*       /*************************************************************/ 03891000
*                                                               02S0672 03892000
*                                                               03S0672 03893000
*       /*************************************************************/ 03894000
*       /*                                                           */ 03895000
*       /* THIS SEGMENT FORMATS AND PRINTS THE VALUE LINES FOR THE   */ 03896000
*       /* REAL PATH PORTION OF THE PATH ANALYSIS REPORT(DASD).      */ 03897000
*       /*                                                           */ 03898000
*       /*************************************************************/ 03899000
*                                                               03S0672 03900000
*       LINES=45;                   /* INITIALIZE LINES REMAINING       03901000
*                                                            @Y30LB52*/ 03902000
         LA    LINES,45                                         03S0672 03903000
*       DO MSC=1 TO 8 WHILE(MSCINTF(MSC)^='0000'X);/* LOOP THROUGH      03904000
*                                      ALL MSC'S             @Y30LB52*/ 03905000
         LA    @08,1                                            03S0673 03906000
         STH   @08,MSC                                          03S0673 03907000
@DL00673 SLA   @08,3                                            03S0673 03908000
         L     @15,PAD00PTR(,CVTPTR)                            03S0673 03909000
         ST    @08,@TF00001                                     03S0673 03910000
         ALR   @08,@15                                          03S0673 03911000
         CLC   MSCINTF-8(2,@08),@CB00246                        03S0673 03912000
         BE    @DC00673                                         03S0673 03913000
*         IF SATABPTR(MSC)^=0       /* IF ERRORS HAVE BEEN RECORDED     03914000
*                                                            @Y30LB52*/ 03915000
*           THEN                                                03S0674 03916000
         L     @08,@TF00001                                     03S0674 03917000
         L     @08,SATABPTR-8(@08,@15)                          03S0674 03918000
         LTR   @08,@08                                          03S0674 03919000
         BZ    @RF00674                                         03S0674 03920000
*           DO;                     /* RPREPARE REPORT       @Y30LB52*/ 03921000
*             SATABP=SATABPTR(MSC); /* LOAD SATAB POINTER    @Y30LB52*/ 03922000
         LR    SATABP,@08                                       03S0676 03923000
*             RESPECIFY                                         03S0677 03924000
*               SADRDDSD BASED(SATABP);/*                    @Y30LB52*/ 03925000
*                                                               03S0677 03926000
*             /*******************************************************/ 03927000
*             /*                                                     */ 03928000
*             /* LOOP THROUGH ALL SA'S IN THE SUBSYSTEM              */ 03929000
*             /*                                                     */ 03930000
*             /*******************************************************/ 03931000
*                                                               03S0678 03932000
*             DO SAP=1 TO SANO;     /*                       @Y30LB52*/ 03933000
         LA    SAP,1                                            03S0678 03934000
         B     @DE00678                                         03S0678 03935000
@DL00678 DS    0H                                               03S0679 03936000
*               IF SADASDAC(SAP)^=0 /* NON-ZERO PTR INDICATES@Y30LB52   03937000
*                                                            @Y30LB52*/ 03938000
*                 THEN                                          03S0679 03939000
         LR    @08,SAP                                          03S0679 03940000
         SLA   @08,3                                            03S0679 03941000
         AL    @08,@CF00661                                     03S0679 03942000
         L     @08,SADASDAC-4(@08,SATABP)                       03S0679 03943000
         LTR   @08,@08                                          03S0679 03944000
         BZ    @RF00679                                         03S0679 03945000
*                 DO;               /* ERRORS THROUGH SA     @Y30LB52*/ 03946000
*                   DASDACCP=SADASDAC(SAP);/* LOAD POINTER   @Y30LB52*/ 03947000
         ST    @08,DASDACCP                                     03S0681 03948000
*                   OUTLINE=SKIPONE;/* SKIP A LINE           @Y30LB52*/ 03949000
         MVI   OUTLINE+1(CVTPTR),C' '                           03S0682 03950000
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          03S0682 03951000
         MVI   OUTLINE(CVTPTR),C' '                             03S0682 03952000
*                   CALL P1PRINTL;  /* PRINT                 @Y30LB52*/ 03953000
         BAL   @14,P1PRINTL                                     03S0683 03954000
*                   DO I=1 TO 4;    /* LOOP THROUGH ALL POSSIBLE        03955000
*                                      CNTLRS                @Y30LB52*/ 03956000
         LA    I,1                                              03S0684 03957000
@DL00684 DS    0H                                               03S0685 03958000
*                     DO J=1 TO 8;  /* LOOP THROUGH DRIVES   @Y30LB52*/ 03959000
         LA    @08,1                                            03S0685 03960000
         ST    @08,J                                            03S0685 03961000
@DL00685 DS    0H                                               03S0686 03962000
*                       OUTLINE=SKIPONE;/* SET SKIP ONE CC   @Y30LB52*/ 03963000
         MVI   OUTLINE+1(CVTPTR),C' '                           03S0686 03964000
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          03S0686 03965000
         MVI   OUTLINE(CVTPTR),C' '                             03S0686 03966000
*                       UNPK(DECNO(1:4),MSCDRDAC(MSC,1:3));/* UNPACK    03967000
*                                      THE HEX STRING PLUS ONE BYTE     03968000
*                                                            @Y30LB52*/ 03969000
         LH    @08,MSC                                          03S0687 03970000
         SLA   @08,3                                            03S0687 03971000
         L     @04,PAD00PTR(,CVTPTR)                            03S0687 03972000
         ALR   @04,@08                                          03S0687 03973000
         UNPK  DECNO(4),MSCDRDAC-8(3,@04)                       03S0687 03974000
*                       DSDMSC=DECNO(1:3)&'0F0F0F'X;/* TURN OFF THE     03975000
*                                      ZONES                 @Y30LB52*/ 03976000
         MVC   DSDMSC(3,CVTPTR),DECNO                           03S0688 03977000
         NC    DSDMSC(3,CVTPTR),@CB00250                        03S0688 03978000
*                       TR(DSDMSC,TRTAB);/* TRANSLATE TO        03S0689 03979000
*                                      PRINTABLE@Y30LB52 HEXADECIMAL    03980000
*                                      CHARACTERS            @Y30LB52*/ 03981000
         TR    DSDMSC(3,CVTPTR),TRTAB                           03S0689 03982000
*                       CALL P1DSDPT2;/*                     @Y30LB52*/ 03983000
         BAL   @14,P1DSDPT2                                     03S0690 03984000
*                     END;          /*                       @Y30LB52*/ 03985000
         LA    @08,1                                            03S0691 03986000
         AL    @08,J                                            03S0691 03987000
         ST    @08,J                                            03S0691 03988000
         CH    @08,@CH00099                                     03S0691 03989000
         BNH   @DL00685                                         03S0691 03990000
*                   END;            /*                       @Y30LB52*/ 03991000
         AH    I,@CH00045                                       03S0692 03992000
         CH    I,@CH00055                                       03S0692 03993000
         BNH   @DL00684                                         03S0692 03994000
*                 END;              /*                       @Y30LB52*/ 03995000
*             END;                  /*                       @Y30LB52*/ 03996000
@RF00679 AH    SAP,@CH00045                                     03S0694 03997000
@DE00678 L     @08,CNFG0PTR(,CVTPTR)                            03S0694 03998000
         CH    SAP,SANO(,@08)                                   03S0694 03999000
         BNH   @DL00678                                         03S0694 04000000
*           END;                    /*                       @Y30LB52*/ 04001000
*       END;                        /*                       @Y30LB52*/ 04002000
@RF00674 LA    @08,1                                            03S0696 04003000
         AH    @08,MSC                                          03S0696 04004000
         STH   @08,MSC                                          03S0696 04005000
         CH    @08,@CH00099                                     03S0696 04006000
         BNH   @DL00673                                         03S0696 04007000
@DC00673 DS    0H                                               03S0697 04008000
*       CALL P1DSDPT3;              /* CALL FOR TOTALS LINE  @Y30LB52*/ 04009000
         BAL   @14,P1DSDPT3                                     03S0697 04010000
*P1DSDPT2:                                                      04S0698 04011000
*       PROCEDURE OPTIONS(SAVE(14));/*                       @Y30LB52*/ 04012000
         B     @PB00004                                         04S0698 04013000
P1DSDPT2 ST    @14,@SA00004                                     04S0698 04014000
*       RESPECIFY                                               04S0699 04015000
*         SPNDLETB BASED(DASDACCP); /*                       @Y30LB52*/ 04016000
*       K=ADDR(SPNDLETB(I,J));      /* LOAD ACCUMS ADDRESS   @Y30LB52*/ 04017000
         LR    @08,I                                            04S0700 04018000
         SLA   @08,3                                            04S0700 04019000
         AL    @08,J                                            04S0700 04020000
         MH    @08,@CH00058                                     04S0700 04021000
         L     K,DASDACCP                                       04S0700 04022000
         AL    K,@CF00667                                       04S0700 04023000
         LA    K,SPNDLETB(@08,K)                                04S0700 04024000
*       RESPECIFY                                               04S0701 04025000
*         SPNDLES BASED(K);         /*                       @Y30LB52*/ 04026000
*       IF SPNDLES^='000000000000'X /* IF NON-ZERO TOTALS    @Y30LB52*/ 04027000
*         THEN                                                  04S0702 04028000
         CLC   SPNDLES(6,K),@CB00313                            04S0702 04029000
         BE    @RF00702                                         04S0702 04030000
*         DO;                       /* THEN OUTPUT           @Y30LB52*/ 04031000
*           LINES=LINES-1;          /* DECREMENT LINES REMAINING        04032000
*                                                            @Y30LB52*/ 04033000
         BCTR  LINES,0                                          04S0704 04034000
*           IF LINES=0              /* END OF PAGE?          @Y30LB52*/ 04035000
*             THEN                                              04S0705 04036000
         LTR   LINES,LINES                                      04S0705 04037000
         BNZ   @RF00705                                         04S0705 04038000
*             DO;                   /* NEW PAGE              @Y30LB52*/ 04039000
*               OUTLINE=NEWPAGE;    /* SET NEW PAGE CC       @Y30LB52*/ 04040000
         MVI   OUTLINE+1(CVTPTR),C' '                           04S0707 04041000
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          04S0707 04042000
         MVI   OUTLINE(CVTPTR),C'1'                             04S0707 04043000
*               CALL P1PRINTL;      /* PRINT                 @Y30LB52*/ 04044000
         BAL   @14,P1PRINTL                                     04S0708 04045000
*               OUTLINE=DASDHEAD;   /* DASD HEADER           @Y30LB52*/ 04046000
         MVI   OUTLINE+58(CVTPTR),C' '                          04S0709 04047000
         MVC   OUTLINE+59(74,CVTPTR),OUTLINE+58(CVTPTR)         04S0709 04048000
         MVC   OUTLINE(58,CVTPTR),DASDHEAD                      04S0709 04049000
*               CALL P1PRINTL;      /* PRINT IT              @Y30LB52*/ 04050000
         BAL   @14,P1PRINTL                                     04S0710 04051000
*               OUTLINE=DASDPTHD;   /* DASD PATH HEAD        @Y30LB52*/ 04052000
         MVI   OUTLINE+58(CVTPTR),C' '                          04S0711 04053000
         MVC   OUTLINE+59(74,CVTPTR),OUTLINE+58(CVTPTR)         04S0711 04054000
         MVC   OUTLINE(58,CVTPTR),DASDPTHD                      04S0711 04055000
*               CALL P1PRINTL;      /* PRINT                 @Y30LB52*/ 04056000
         BAL   @14,P1PRINTL                                     04S0712 04057000
*               LINES=45;           /* RESET LINES REMAINING @Y30LB52*/ 04058000
         LA    LINES,45                                         04S0713 04059000
*             END;                  /*                       @Y30LB52*/ 04060000
*                                                               04S0714 04061000
*           /*********************************************************/ 04062000
*           /*                                                       */ 04063000
*           /* FORMAT THE PATH FOR THE ERRORS                        */ 04064000
*           /*                                                       */ 04065000
*           /*********************************************************/ 04066000
*                                                               04S0715 04067000
*           DSDSA='800';            /* SA SSID               @Y30LB52*/ 04068000
@RF00705 MVC   DSDSA(3,CVTPTR),@CC00390                         04S0715 04069000
*           DSDSA(2)=DSDSA(2)|(SAP-1);/* SA INDEX            @Y30LB52*/ 04070000
         LR    @08,SAP                                          04S0716 04071000
         BCTR  @08,0                                            04S0716 04072000
         SLR   @15,@15                                          04S0716 04073000
         IC    @15,DSDSA+1(,CVTPTR)                             04S0716 04074000
         OR    @08,@15                                          04S0716 04075000
         STC   @08,DSDSA+1(,CVTPTR)                             04S0716 04076000
*           DSDCNTL='00';           /* CONTROLLER            @Y30LB52*/ 04077000
         MVC   DSDCNTL(2,CVTPTR),@CC00585                       04S0717 04078000
*           DSDCNTL(2)=DSDCNTL(2)|(I-1);/* CNTLR INDEX       @Y30LB52*/ 04079000
         LR    @08,I                                            04S0718 04080000
         BCTR  @08,0                                            04S0718 04081000
         SLR   @15,@15                                          04S0718 04082000
         IC    @15,DSDCNTL+1(,CVTPTR)                           04S0718 04083000
         OR    @08,@15                                          04S0718 04084000
         STC   @08,DSDCNTL+1(,CVTPTR)                           04S0718 04085000
*           DSDDRV='C0'X+J;         /* DRIVE IDENTIFICATION  @Y30LB52*/ 04086000
*                                                               04S0719 04087000
         LA    @08,192                                          04S0719 04088000
         AL    @08,J                                            04S0719 04089000
         STC   @08,DSDDRV(,CVTPTR)                              04S0719 04090000
*           /*********************************************************/ 04091000
*           /*                                                       */ 04092000
*           /* FORMAT THE ACCUMULATOR COUNTS                         */ 04093000
*           /*                                                       */ 04094000
*           /*********************************************************/ 04095000
*                                                               04S0720 04096000
*           RTOTAL=0;               /* CLEAR ROW TOTAL       @Y30LB52*/ 04097000
         SLR   @08,@08                                          04S0720 04098000
         STH   @08,RTOTAL                                       04S0720 04099000
*           CVD(DRVEQCHK,DECNO);    /* CONVERT BINARY STRING TO 04S0721 04100000
*                                      DECIMAL               @ZA00699*/ 04101000
         LH    @15,DRVEQCHK(,K)                                 04S0721 04102000
         CVD   @15,DECNO                                        04S0721 04103000
*           DSDCNT(1)=EDITPAT5;     /* 5 DIGIT EDIT PATTERN  @ZA00699*/ 04104000
         MVC   DSDCNT(6,CVTPTR),EDITPAT5                        04S0722 04105000
*           ED(DSDCNT(1),DECNO2);   /* CONVERT TO PRINTABLE HEX 04S0723 04106000
*                                                            @ZA00699*/ 04107000
         ED    DSDCNT(6,CVTPTR),DECNO2                          04S0723 04108000
*           LTOTAL(1)=LTOTAL(1)+DRVEQCHK;/* INCREMENT COLUMN TOT        04109000
*                                                            @Y30LB52*/ 04110000
         LH    @14,LTOTAL                                       04S0724 04111000
         ALR   @14,@15                                          04S0724 04112000
         STH   @14,LTOTAL                                       04S0724 04113000
*           RTOTAL=RTOTAL+DRVEQCHK; /* INCREMENT ROW         @Y30LB52*/ 04114000
         ALR   @08,@15                                          04S0725 04115000
         STH   @08,RTOTAL                                       04S0725 04116000
*           CVD(STCTLCHK,DECNO);    /* CONVERT BINARY STRING TO 04S0726 04117000
*                                      DECIMAL               @ZA00699*/ 04118000
         LH    @15,STCTLCHK(,K)                                 04S0726 04119000
         CVD   @15,DECNO                                        04S0726 04120000
*           DSDCNT(2)=EDITPAT5;     /* 5 DIGIT EDIT PATTERN  @ZA00699*/ 04121000
         MVC   DSDCNT+14(6,CVTPTR),EDITPAT5                     04S0727 04122000
*           ED(DSDCNT(2),DECNO2);   /* CONVERT TO PRINTABLE HEX 04S0728 04123000
*                                                            @ZA00699*/ 04124000
         ED    DSDCNT+14(6,CVTPTR),DECNO2                       04S0728 04125000
*           LTOTAL(2)=LTOTAL(2)+STCTLCHK;/* INCREMENT TOT    @Y30LB52*/ 04126000
         LH    @14,LTOTAL+2                                     04S0729 04127000
         ALR   @14,@15                                          04S0729 04128000
         STH   @14,LTOTAL+2                                     04S0729 04129000
*           RTOTAL=RTOTAL+STCTLCHK; /* INCREMENT ROW         @Y30LB52*/ 04130000
         ALR   @08,@15                                          04S0730 04131000
         STH   @08,RTOTAL                                       04S0730 04132000
*           CVD(STCTLCCK,DECNO);    /* CONVERT BINARY STRING TO 04S0731 04133000
*                                      DECIMAL               @ZA00699*/ 04134000
         LH    @15,STCTLCCK(,K)                                 04S0731 04135000
         CVD   @15,DECNO                                        04S0731 04136000
*           DSDCNT(3)=EDITPAT5;     /* 5 DIGIT EDIT PATTERN  @ZA00699*/ 04137000
         MVC   DSDCNT+28(6,CVTPTR),EDITPAT5                     04S0732 04138000
*           ED(DSDCNT(3),DECNO2);   /* CONVERT TO PRINTABLE HEX 04S0733 04139000
*                                                            @ZA00699*/ 04140000
         ED    DSDCNT+28(6,CVTPTR),DECNO2                       04S0733 04141000
*           LTOTAL(3)=LTOTAL(3)+STCTLCCK;/* INCREMENT TOT    @Y30LB52*/ 04142000
         LH    @14,LTOTAL+4                                     04S0734 04143000
         ALR   @14,@15                                          04S0734 04144000
         STH   @14,LTOTAL+4                                     04S0734 04145000
*           RTOTAL=RTOTAL+STCTLCCK; /* INCREMENT ROW         @Y30LB52*/ 04146000
         ALR   @08,@15                                          04S0735 04147000
         STH   @08,RTOTAL                                       04S0735 04148000
*           CVD(RTOTAL,DECNO);      /* CONVERT BINARY STRING TO 04S0736 04149000
*                                      DECIMAL               @ZA00699*/ 04150000
         CVD   @08,DECNO                                        04S0736 04151000
*           DSDTOTL=EDITPAT5;       /* 5 DIGIT EDIT PATTERN  @ZA00699*/ 04152000
         MVC   DSDTOTL(6,CVTPTR),EDITPAT5                       04S0737 04153000
*           ED(DSDTOTL,DECNO2);     /* CONVERT TO PRINTABLE HEX 04S0738 04154000
*                                                            @ZA00699*/ 04155000
         ED    DSDTOTL(6,CVTPTR),DECNO2                         04S0738 04156000
*           RTOTAL=RTOTAL*1000/(MSCTOTAL+HTOTAL);/* CALCULATE PERCENT   04157000
*                                      ERR                   @ZM34326*/ 04158000
         MH    @08,@CH00402                                     04S0739 04159000
         L     @04,PAD00PTR(,CVTPTR)                            04S0739 04160000
         LH    @15,MSCTOTAL(,@04)                               04S0739 04161000
         AH    @15,HTOTAL(,@04)                                 04S0739 04162000
         LR    @00,@08                                          04S0739 04163000
         SRDA  @00,32                                           04S0739 04164000
         DR    @00,@15                                          04S0739 04165000
         STH   @01,RTOTAL                                       04S0739 04166000
*           CVD(RTOTAL,DECNO);      /* CONVERT TO DECIMAL    @ZM34326*/ 04167000
         CVD   @01,DECNO                                        04S0740 04168000
*           DSDPTOT=EDITPATP;       /* MOVE PERCENT PATTERN  @ZM34326*/ 04169000
         MVC   DSDPTOT(7,CVTPTR),EDITPATP                       04S0741 04170000
*           ED(DSDPTOT,DECNO2);     /* EDIT PERCENTAGE       @ZM34326*/ 04171000
         ED    DSDPTOT(7,CVTPTR),DECNO2                         04S0742 04172000
*           CALL P1PRINTL;          /* PRINT THE LINE        @Y30LB52*/ 04173000
         BAL   @14,P1PRINTL                                     04S0743 04174000
*         END;                      /*                       @Y30LB52*/ 04175000
*     END P1DSDPT2;                 /*                       @Y30LB52*/ 04176000
@EL00004 DS    0H                                               04S0745 04177000
@EF00004 DS    0H                                               04S0745 04178000
@ER00004 L     @14,@SA00004                                     04S0745 04179000
         BR    @14                                              04S0745 04180000
@PB00004 DS    0H                                               04S0746 04181000
*   DCL                                                         03S0746 04182000
*                                                               03S0746 04183000
*     /***************************************************************/ 04184000
*     /*                                                             */ 04185000
*     /* THE FOLLOWING STRUCTURE MAPS THE OUTPUT LINE AND IS USED TO */ 04186000
*     /* STORE THE VALUE LINES.                                      */ 04187000
*     /*                                                             */ 04188000
*     /***************************************************************/ 04189000
*                                                               03S0746 04190000
*     1 * DEF(OUTLINE),             /*                       @Y30LB52*/ 04191000
*      2 * CHAR(5),                 /*                       @Y30LB52*/ 04192000
*      2 DSDMSC CHAR(3),            /* MSC ADDRESS           @Y30LB52*/ 04193000
*      2 * CHAR(2),                 /*                       @Y30LB52*/ 04194000
*      2 DSDSA CHAR(3),             /*                       @Y30LB52*/ 04195000
*      2 * CHAR(6),                 /*                       @Y30LB52*/ 04196000
*      2 DSDCNTL CHAR(2),           /* DASD CNTLR            @Y30LB52*/ 04197000
*      2 * CHAR(13),                /*                       @Y30LB52*/ 04198000
*      2 DSDDRV CHAR(1),            /* DRIVE ID              @Y30LB52*/ 04199000
*      2 * CHAR(10),                /*                       @ZA00699*/ 04200000
*      2 *(3) CHAR(14),             /*                       @Y30LB52*/ 04201000
*       3 DSDCNT CHAR(6),           /* ACCUMULATOR COUNT     @ZA00699*/ 04202000
*       3 * CHAR(8),                /*                       @ZA00699*/ 04203000
*      2 DSDTOTL CHAR(6),           /* ROW TOTAL             @ZA00699*/ 04204000
*      2 * CHAR(1),                 /* SPACE                 @ZM34326*/ 04205000
*      2 DSDPTOT CHAR(7),           /* PERCENTAGE            @ZM34326*/ 04206000
*     DRDCOLTC CHAR(5) DEF(DSDDRV); /* TOTAL CONSTANT        @Y30LB52*/ 04207000
*   END;                            /*                       @Y30LB52*/ 04208000
*                                                               02S0747 04209000
*   /*****************************************************************/ 04210000
*   /*                                                               */ 04211000
*   /* THIS SECTION FORMATS THE CONSTANT HEADERS FOR THE REAL PATH   */ 04212000
*   /* ARRAY(HOST 3330).                                             */ 04213000
*   /*                                                               */ 04214000
*   /*****************************************************************/ 04215000
*                                                               02S0748 04216000
*   IF HTOTAL^=0                    /* ERRORS RECORDED THRO  @Y30LB52*/ 04217000
*     THEN                                                      02S0748 04218000
@RF00657 L     @08,PAD00PTR(,CVTPTR)                            02S0748 04219000
         ICM   @03,3,HTOTAL(@08)                                02S0748 04220000
         BZ    @RF00748                                         02S0748 04221000
*     DO;                           /* HOST CHANNELS?        @Y30LB52*/ 04222000
*       OUTLINE=NEWPAGE;            /* SET NEW PAGE CC       @Y30LB52*/ 04223000
         MVI   OUTLINE+1(CVTPTR),C' '                           02S0750 04224000
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          02S0750 04225000
         MVI   OUTLINE(CVTPTR),C'1'                             02S0750 04226000
*       CALL P1PRINTL;              /* OUTPUT                @Y30LB52*/ 04227000
         BAL   @14,P1PRINTL                                     02S0751 04228000
*       OUTLINE=DASDHEAD;           /* SET PA(DASD PORTION) HEAD        04229000
*                                                            @Y30LB52*/ 04230000
         MVI   OUTLINE+58(CVTPTR),C' '                          02S0752 04231000
         MVC   OUTLINE+59(74,CVTPTR),OUTLINE+58(CVTPTR)         02S0752 04232000
         MVC   OUTLINE(58,CVTPTR),DASDHEAD                      02S0752 04233000
*       CALL P1PRINTL;              /* OUTPUT                @Y30LB52*/ 04234000
         BAL   @14,P1PRINTL                                     02S0753 04235000
*       OUTLINE=DASDPTHD;           /* SET REPORT SECTION HEAD  02S0754 04236000
*                                                            @Y30LB52*/ 04237000
         MVI   OUTLINE+58(CVTPTR),C' '                          02S0754 04238000
         MVC   OUTLINE+59(74,CVTPTR),OUTLINE+58(CVTPTR)         02S0754 04239000
         MVC   OUTLINE(58,CVTPTR),DASDPTHD                      02S0754 04240000
*       DSDTYPE='HOST';             /* INDICATE 'HOST' 3330  @Y30LB52*/ 04241000
         MVC   DSDTYPE(4,CVTPTR),@CC00603                       02S0755 04242000
*       CALL P1PRINTL;              /* OUTPUT                @Y30LB52*/ 04243000
         BAL   @14,P1PRINTL                                     02S0756 04244000
*       OUTLINE=DASDCOLH;           /* SET COLUMN HEAD       @Y30LB52*/ 04245000
         MVI   OUTLINE+102(CVTPTR),C' '                         02S0757 04246000
         MVC   OUTLINE+103(30,CVTPTR),OUTLINE+102(CVTPTR)       02S0757 04247000
         MVC   OUTLINE(102,CVTPTR),DASDCOLH                     02S0757 04248000
*       HOSTXX='   ';               /* BLANK MSC HEADER      @ZM31069*/ 04249000
         MVC   HOSTXX(3,CVTPTR),@CC00279                        02S0758 04250000
*       CALL P1PRINTL;              /* OUTPUT                @Y30LB52*/ 04251000
         BAL   @14,P1PRINTL                                     02S0759 04252000
*       OUTLINE=SKIPONE;            /* INDICATE SINGLE LINE SKIP        04253000
*                                                            @Y30LB52*/ 04254000
         MVI   OUTLINE+1(CVTPTR),C' '                           02S0760 04255000
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          02S0760 04256000
         MVI   OUTLINE(CVTPTR),C' '                             02S0760 04257000
*       DASDCL1='CHECK';            /* SET FIRST CONSTANT    @Y30LB52*/ 04258000
         MVC   DASDCL1(5,CVTPTR),@CC00567                       02S0761 04259000
*       DASDCL2='EQUIP CHECK';      /* SET SECOND CONSTANT   @ZM31022*/ 04260000
         MVC   DASDCL2(11,CVTPTR),@CC00569                      02S0762 04261000
*       DASDCL3='CNTL CHECK';       /* THIRD                 @Y30LB52*/ 04262000
         MVC   DASDCL3(10,CVTPTR),@CC00572                      02S0763 04263000
*       CALL P1PRINTL;              /*                       @Y30LB52*/ 04264000
         BAL   @14,P1PRINTL                                     02S0764 04265000
*                                                               03S0765 04266000
*       /*************************************************************/ 04267000
*       /*                                                           */ 04268000
*       /* THE FOLLOWING SEGMENT OF CODE FORMATS AND PRINTS THE HOST */ 04269000
*       /* CHANNEL PORTION OF THE REAL PATH ARRAY IN THE PATH        */ 04270000
*       /* ANALYSIS REPORT(DASD).                                    */ 04271000
*       /*                                                           */ 04272000
*       /*************************************************************/ 04273000
*                                                               03S0765 04274000
*       LINES=45;                   /* SETLINES REMAINING    @Y30LB52*/ 04275000
         LA    LINES,45                                         03S0765 04276000
*       SATABP=SAINTFP;             /* LOAD UPPER INTF BASE  @Y30LB52*/ 04277000
         L     @08,CNFG0PTR(,CVTPTR)                            03S0766 04278000
         L     SATABP,SAINTFP(,@08)                             03S0766 04279000
*       RESPECIFY                                               03S0767 04280000
*         SAINTF BASED(SATABP);     /*                       @Y30LB52*/ 04281000
*       TOTALS=TOTALS&&TOTALS;      /* CLEAR ALL TOTALS      @YM32170*/ 04282000
*                                                               03S0768 04283000
         XC    TOTALS(76),TOTALS                                03S0768 04284000
*       /*************************************************************/ 04285000
*       /*                                                           */ 04286000
*       /* LOOP THROUGH ALL SA'S IN THE SUBSYSTEM                    */ 04287000
*       /*                                                           */ 04288000
*       /*************************************************************/ 04289000
*                                                               03S0769 04290000
*       DO SAP=1 TO SANO;           /*                       @Y30LB52*/ 04291000
         LA    SAP,1                                            03S0769 04292000
         B     @DE00769                                         03S0769 04293000
@DL00769 DS    0H                                               03S0770 04294000
*         OUTLINE=SKIPONE;          /* SKIP ONE BETWEEN SA'S @Y30LB52*/ 04295000
         MVI   OUTLINE+1(CVTPTR),C' '                           03S0770 04296000
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          03S0770 04297000
         MVI   OUTLINE(CVTPTR),C' '                             03S0770 04298000
*         CALL P1PRINTL;            /* PRINT                 @Y30LB52*/ 04299000
         BAL   @14,P1PRINTL                                     03S0771 04300000
*         DO UINTF=1 TO 3;          /* LOOP THROUGH ALL UPPER@Y30LB52   04301000
*                                      INTERFACES            @Y30LB52*/ 04302000
         LA    @08,1                                            03S0772 04303000
         STH   @08,UINTF                                        03S0772 04304000
@DL00772 DS    0H                                               03S0773 04305000
*           IF SAINTF(UINTF)^=0     /* INTERFACE IN USE?     @Y30LB52*/ 04306000
*             THEN                                              03S0773 04307000
         SLR   @15,@15                                          03S0773 04308000
         SLA   @08,2                                            03S0773 04309000
         AL    @08,@CF00661                                     03S0773 04310000
         L     @08,SAINTF(@08,SATABP)                           03S0773 04311000
         CR    @08,@15                                          03S0773 04312000
         BE    @RF00773                                         03S0773 04313000
*             DO;                   /* CHECK FOR ERRORS RECORDED        04314000
*                                                            @Y30LB52*/ 04315000
*               RESPECIFY                                       03S0775 04316000
*                 CHCUTAB BASED(SAINTF(UINTF));/*            @Y30LB52*/ 04317000
*               IF SPLTABP^=0       /* IF AN ACCUMULATOR BLOCK IS       04318000
*                                      PRESENT               @Y30LB52*/ 04319000
*                 THEN                                          03S0776 04320000
         L     @08,SPLTABP(,@08)                                03S0776 04321000
         CR    @08,@15                                          03S0776 04322000
         BE    @RF00776                                         03S0776 04323000
*                 DO;               /* FORMAT ERRORS BELOW   @Y30LB52*/ 04324000
*                   DASDACCP=SPLTABP;/* LOAD ACCUMULATOR ADDRESS        04325000
*                                                            @Y30LB52*/ 04326000
*                                                               03S0778 04327000
         ST    @08,DASDACCP                                     03S0778 04328000
*                   /*************************************************/ 04329000
*                   /*                                               */ 04330000
*                   /* LOOP THROUGH ALL CONTROLLERS AND DRIVES       */ 04331000
*                   /* CHECKING FOR NONZERO ERROR COUNTS.            */ 04332000
*                   /*                                               */ 04333000
*                   /*************************************************/ 04334000
*                                                               03S0779 04335000
*                   DO I=1 TO 4;    /* FOUR POSSIBLE CNTLR'S @Y30LB52*/ 04336000
         LA    I,1                                              03S0779 04337000
@DL00779 DS    0H                                               03S0780 04338000
*                     DO J=1 TO 8;  /* EIGHT POSSIBLE DRIVES @Y30LB52*/ 04339000
         LA    @08,1                                            03S0780 04340000
         ST    @08,J                                            03S0780 04341000
@DL00780 DS    0H                                               03S0781 04342000
*                       OUTLINE=SKIPONE;/* SET SINGLE LINE SKIP 03S0781 04343000
*                                                            @Y30LB52*/ 04344000
         MVI   OUTLINE+1(CVTPTR),C' '                           03S0781 04345000
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          03S0781 04346000
         MVI   OUTLINE(CVTPTR),C' '                             03S0781 04347000
*                       CALL P1DSDPT2;/* FORMAT AND PRINT LINE  03S0782 04348000
*                                                            @Y30LB52*/ 04349000
         BAL   @14,P1DSDPT2                                     03S0782 04350000
*                     END;          /*                       @Y30LB52*/ 04351000
         LA    @08,1                                            03S0783 04352000
         AL    @08,J                                            03S0783 04353000
         ST    @08,J                                            03S0783 04354000
         CH    @08,@CH00099                                     03S0783 04355000
         BNH   @DL00780                                         03S0783 04356000
*                   END;            /*                       @Y30LB52*/ 04357000
         AH    I,@CH00045                                       03S0784 04358000
         CH    I,@CH00055                                       03S0784 04359000
         BNH   @DL00779                                         03S0784 04360000
*                 END;              /*                       @Y30LB52*/ 04361000
*             END;                  /*                       @Y30LB52*/ 04362000
@RF00776 DS    0H                                               03S0787 04363000
*         END;                      /*                       @Y30LB52*/ 04364000
@RF00773 LA    @08,1                                            03S0787 04365000
         AH    @08,UINTF                                        03S0787 04366000
         STH   @08,UINTF                                        03S0787 04367000
         CH    @08,@CH00103                                     03S0787 04368000
         BNH   @DL00772                                         03S0787 04369000
*         SATABP=SATABP+12;         /* INCREMENT TO NEXT INTERFACE      04370000
*                                      ENTRY                 @Y30LB52*/ 04371000
         AH    SATABP,@CH00035                                  03S0788 04372000
*       END;                        /*                       @Y30LB52*/ 04373000
         AH    SAP,@CH00045                                     03S0789 04374000
@DE00769 L     @08,CNFG0PTR(,CVTPTR)                            03S0789 04375000
         CH    SAP,SANO(,@08)                                   03S0789 04376000
         BNH   @DL00769                                         03S0789 04377000
*       CALL P1DSDPT3;              /* CALL FOR TOTALS LINE  @Y30LB52*/ 04378000
         BAL   @14,P1DSDPT3                                     03S0790 04379000
*P1DSDPT3:                                                      04S0791 04380000
*       PROCEDURE OPTIONS(SAVE(14));/*                       @Y30LB52*/ 04381000
*                                                               04S0791 04382000
         B     @PB00005                                         04S0791 04383000
P1DSDPT3 ST    @14,@SA00005                                     04S0791 04384000
*       /*************************************************************/ 04385000
*       /*                                                           */ 04386000
*       /* THIS PROCEDURE PRODUCES THE TOTALS LINE THE REAL DEVICE   */ 04387000
*       /* PATH PORTION OF THE 3330 REPORT.                          */ 04388000
*       /*                                                           */ 04389000
*       /*************************************************************/ 04390000
*                                                               04S0792 04391000
*       OUTLINE=SKIPTWO;            /* SKIP 2 LINES          @Y30LB52*/ 04392000
         MVI   OUTLINE+1(CVTPTR),C' '                           04S0792 04393000
         MVC   OUTLINE+2(131,CVTPTR),OUTLINE+1(CVTPTR)          04S0792 04394000
         MVI   OUTLINE(CVTPTR),C'0'                             04S0792 04395000
*       DRDCOLTC='TOTAL';           /* SET 'TOTAL' CONSTANT  @Y30LB52*/ 04396000
         MVC   DRDCOLTC(5,CVTPTR),@CC00240                      04S0793 04397000
*       DO I=1 TO 3;                /* LOOP THRO THREE CNTS  @Y30LB52*/ 04398000
         LA    I,1                                              04S0794 04399000
@DL00794 DS    0H                                               04S0795 04400000
*         CVD(LTOTAL(I),DECNO);     /* CONVERT BINARY STRING TO 04S0795 04401000
*                                      DECIMAL               @ZA00699*/ 04402000
         LR    @08,I                                            04S0795 04403000
         ALR   @08,@08                                          04S0795 04404000
         LH    @08,LTOTAL-2(@08)                                04S0795 04405000
         CVD   @08,DECNO                                        04S0795 04406000
*         DSDCNT(I)=EDITPAT5;       /* 5 DIGIT EDIT PATTERN  @ZA00699*/ 04407000
         LR    @04,I                                            04S0796 04408000
         MH    @04,@CH00245                                     04S0796 04409000
         ST    @04,@TF00001                                     04S0796 04410000
         ALR   @04,CVTPTR                                       04S0796 04411000
         MVC   DSDCNT-14(6,@04),EDITPAT5                        04S0796 04412000
*         ED(DSDCNT(I),DECNO2);     /* CONVERT TO PRINTABLE HEX 04S0797 04413000
*                                                            @ZA00699*/ 04414000
         LR    @04,CVTPTR                                       04S0797 04415000
         AL    @04,@TF00001                                     04S0797 04416000
         ED    DSDCNT-14(6,@04),DECNO2                          04S0797 04417000
*         GTOTAL=GTOTAL+LTOTAL(I);  /* GRAND TOTAL           @Y30LB52*/ 04418000
         AH    @08,GTOTAL                                       04S0798 04419000
         STH   @08,GTOTAL                                       04S0798 04420000
*       END;                        /*                       @Y30LB52*/ 04421000
         AH    I,@CH00045                                       04S0799 04422000
         CH    I,@CH00103                                       04S0799 04423000
         BNH   @DL00794                                         04S0799 04424000
*       CVD(GTOTAL,DECNO);          /* CONVERT BINARY STRING TO 04S0800 04425000
*                                      DECIMAL               @ZA00699*/ 04426000
         LH    @08,GTOTAL                                       04S0800 04427000
         CVD   @08,DECNO                                        04S0800 04428000
*       DSDTOTL=EDITPAT5;           /* 5 DIGIT EDIT PATTERN  @ZA00699*/ 04429000
         MVC   DSDTOTL(6,CVTPTR),EDITPAT5                       04S0801 04430000
*       ED(DSDTOTL,DECNO2);         /* CONVERT TO PRINTABLE HEX 04S0802 04431000
*                                                            @ZA00699*/ 04432000
         ED    DSDTOTL(6,CVTPTR),DECNO2                         04S0802 04433000
*       CALL P1PRINTL;              /* PRINT THE LINE        @Y30LB52*/ 04434000
         BAL   @14,P1PRINTL                                     04S0803 04435000
*     END P1DSDPT3;                 /*                       @Y30LB52*/ 04436000
@EL00005 DS    0H                                               04S0804 04437000
@EF00005 DS    0H                                               04S0804 04438000
@ER00005 L     @14,@SA00005                                     04S0804 04439000
         BR    @14                                              04S0804 04440000
@PB00005 DS    0H                                               04S0805 04441000
*   END;                            /*                       @Y30LB52   04442000
*                                                            @Y30LB52*/ 04443000
*                                                               02S0806 04444000
*   /*****************************************************************/ 04445000
*   /*                                                               */ 04446000
*   /* THE FOLLOWING STRUCTURE IS A MAP OF THE DASD REAL PATH HEADER */ 04447000
*   /* LINE.                                                         */ 04448000
*   /*                                                               */ 04449000
*   /*****************************************************************/ 04450000
*                                                               02S0806 04451000
*   DCL                                                         02S0806 04452000
*     1 DASDPTHD STATIC LOCAL,      /*                       @Y30LB52*/ 04453000
*      2 * CHAR(1) INIT(SKIPTWO),   /* CC                    @Y30LB52*/ 04454000
*      2 * CHAR(57) INIT(                                       02S0806 04455000
*            'ERROR COUNTS BY REAL DEVICE PATH(MSC  DASD OPERATIONS)'), 04456000
*                                                               02S0806 04457000
*     /***************************************************************/ 04458000
*     /*                                                             */ 04459000
*     /* THE FOLLOWING STRUCTURE IS A MAP OF THE OUTPUT LINE.        */ 04460000
*     /*                                                             */ 04461000
*     /***************************************************************/ 04462000
*                                                               02S0806 04463000
*     1 * DEF(OUTLINE),             /*                       @Y30LB52*/ 04464000
*      2 * CHAR(5),                 /*                       @ZM31069*/ 04465000
*      2 HOSTXX CHAR(3),            /* OVERLAY MSC           @ZM31069*/ 04466000
*      2 * CHAR(26),                /*                       @ZM31069*/ 04467000
*      2 DSDTYPE CHAR(4),           /*                       @Y30LB52*/ 04468000
*      2 * CHAR(9),                 /*                       @Y30LB52*/ 04469000
*      2 DASDCL1 CHAR(5),           /*                       @Y30LB52*/ 04470000
*      2 * CHAR(6),                 /*                       @ZM31022*/ 04471000
*      2 DASDCL2 CHAR(11),          /*                       @ZM31022*/ 04472000
*      2 * CHAR(4),                 /*                       @ZM31022*/ 04473000
*      2 DASDCL3 CHAR(10),          /*                       @Y30LB52*/ 04474000
*                                                               02S0806 04475000
*     /***************************************************************/ 04476000
*     /*                                                             */ 04477000
*     /* THIS STRUCTURE IS THE DASD REAL PATH ARRAY COLUMN HEADER.   */ 04478000
*     /*                                                             */ 04479000
*     /***************************************************************/ 04480000
*                                                               02S0806 04481000
*     1 DASDCOLH STATIC LOCAL,                                  02S0806 04482000
*      2 * CHAR(1) INIT(SKIPTWO),   /*                       @Y30LB52*/ 04483000
*      2 * CHAR(4) INIT('    '),    /*                       @Y30LB52*/ 04484000
*      2 * CHAR(3) INIT('MSC'),     /*                       @Y30LB52*/ 04485000
*      2 * CHAR(2) INIT('  '),      /*                       @Y30LB52*/ 04486000
*      2 * CHAR(6) INIT('SA    '),  /*                       @Y30LB52*/ 04487000
*      2 * CHAR(16) INIT('CONTROLLER'),/*                    @Y30LB52*/ 04488000
*      2 * CHAR(13) INIT('DRIVE'),  /*                       @Y30LB52*/ 04489000
*      2 * CHAR(13) INIT('DRIVE EQUIP'),/*                   @Y30LB52*/ 04490000
*      2 *(2) CHAR(14) INIT(' DIRECTOR   ','  DIRECTOR  '),/*   02S0806 04491000
*                                                            @ZM31022*/ 04492000
*      2 * CHAR(3) INIT('   '),     /*                       @Y30LB52*/ 04493000
*      2 * CHAR(7) INIT('TOTAL'),   /*                       @Y30LB52*/ 04494000
*      2 * CHAR(6) INIT('%ERROR');  /*                       @Y30LB52*/ 04495000
@RF00748 DS    0H                                               02S0807 04496000
*   END;                            /*                       @Y30LB52*/ 04497000
*   RESPECIFY                                                   01S0808 04498000
*    (R1) RESTRICTED;               /*                       @Y30LB52*/ 04499000
@RF00472 DS    0H                                               01S0809 04500000
*   RESPECIFY                                                   01S0809 04501000
*     P0WORK1 BASED(COREADDR);      /*                       @Y30LB52*/ 04502000
*   COREADDR=PAD00PTR;              /* LOAD FIRST BLK ADDR   @Y30LB52*/ 04503000
         MVC   COREADDR(4,CVTPTR),PAD00PTR(CVTPTR)              01S0810 04504000
*   SPNO=2;                         /* SUBPOOL NUMBER        @Y30LB52*/ 04505000
         MVI   SPNO(CVTPTR),X'02'                               01S0811 04506000
*   CORELEN=2048;                   /* BLOCK LENGTH          @Y30LB52*/ 04507000
*                                                               01S0812 04508000
         MVC   CORELEN(3,CVTPTR),@CF00646+1                     01S0812 04509000
*   /*****************************************************************/ 04510000
*   /*                                                               */ 04511000
*   /* LOOP THROUGH ALL BLOCKS AND FREE THEM.                        */ 04512000
*   /*                                                               */ 04513000
*   /*****************************************************************/ 04514000
*                                                               01S0813 04515000
*   DO WHILE(COREADDR^=0);          /*                       @Y30LB52*/ 04516000
         B     @DE00813                                         01S0813 04517000
@DL00813 DS    0H                                               01S0814 04518000
*     R1=ADDR(WORKCALL);            /* LOAD PARMLIST ADDRESS @Y30LB52*/ 04519000
         LA    R1,WORKCALL(,CVTPTR)                             01S0814 04520000
*     I=PADFPTR1;                   /* LOAD THE NEXT BLOCK AD   01S0815 04521000
*                                                            @Y30LB52*/ 04522000
         L     @08,COREADDR(,CVTPTR)                            01S0815 04523000
         L     I,PADFPTR1(,@08)                                 01S0815 04524000
*     CALL ISDAFREE;                /* FREE THE BLOCK        @Y30LB52*/ 04525000
         L     @15,@CV00117                                     01S0816 04526000
         BALR  @14,@15                                          01S0816 04527000
*     COREADDR=I;                   /* LOAD THE NEXT BLOCK AD   01S0817 04528000
*                                                            @Y30LB52*/ 04529000
         ST    I,COREADDR(,CVTPTR)                              01S0817 04530000
*   END;                            /*                       @Y30LB52*/ 04531000
@DE00813 ICM   @08,15,COREADDR(CVTPTR)                          01S0818 04532000
         BNZ   @DL00813                                         01S0818 04533000
*   RETURN CODE(0);                 /*                       @Y30LB52   04534000
*                                                            @Y30LB52*/ 04535000
         L     @13,4(,@13)                                      01S0819 04536000
         L     @00,@SIZDATD                                     01S0819 04537000
         LR    @01,@09                                          01S0819 04538000
         FREEMAIN R,LV=(0),A=(1)                                        04539000
         SLR   @15,@15                                          01S0819 04540000
         L     @14,12(,@13)                                     01S0819 04541000
         LM    @00,@12,20(@13)                                  01S0819 04542000
         BR    @14                                              01S0819 04543000
*P1PRINTL:                                                      02S0820 04544000
*   PROCEDURE OPTIONS(SAVE(14));    /*                       @Y30LB52*/ 04545000
*                                                               02S0820 04546000
P1PRINTL ST    @14,@SA00006                                     02S0820 04547000
*   /*****************************************************************/ 04548000
*   /*                                                               */ 04549000
*   /* THIS PROCEDURE SETS AND CALLS THE SDA PRINT ROUTINE           */ 04550000
*   /*                                                               */ 04551000
*   /*****************************************************************/ 04552000
*                                                               02S0821 04553000
*   RESPECIFY                                                   02S0821 04554000
*     R1 RESTRICTED;                /*                       @Y30LB52*/ 04555000
*   R1=ADDR(WORKCALL);              /* LOAD PARM LIST ADDR   @Y30LB52*/ 04556000
         LA    R1,WORKCALL(,CVTPTR)                             02S0822 04557000
*   CALL ISDAPRT0;                  /* PRINT THE LINE        @Y30LB52*/ 04558000
         L     @15,@CV00053                                     02S0823 04559000
         BALR  @14,@15                                          02S0823 04560000
*   RESPECIFY                                                   02S0824 04561000
*     R1 UNRESTRICTED;              /*                       @Y30LB52*/ 04562000
*   RETURN;                         /*                       @Y30LB52*/ 04563000
@EL00006 DS    0H                                               02S0825 04564000
@EF00006 DS    0H                                               02S0825 04565000
@ER00006 L     @14,@SA00006                                     02S0825 04566000
         BR    @14                                              02S0825 04567000
*   END P1PRINTL;                   /*                       @Y30LB52*/ 04568000
*   END ISDAPAD1                    /*                       @Y30LB52*/ 04569000
*                                                               01S0827 04570000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.     */ 04571000
*/*%INCLUDE SYSLIB  (ISDAMCFG)                                       */ 04572000
*/*%INCLUDE SYSLIB  (ISDAPAD5)                                       */ 04573000
*/*%INCLUDE SYSLIB  (ISDACVT )                                       */ 04574000
*/*%INCLUDE SYSUT5  (P1MSCSA )                                       */ 04575000
*/*%INCLUDE SYSUT5  (P1MSCSAV)                                       */ 04576000
*/*%INCLUDE SYSUT5  (P1CONBE )                                       */ 04577000
*/*%INCLUDE SYSUT5  (P1CONBE )                                       */ 04578000
*/*%INCLUDE SYSUT5  (P1CONBE )                                       */ 04579000
*/*%INCLUDE SYSUT5  (P1CONBDE)                                       */ 04580000
*/*%INCLUDE SYSUT5  (P1CONBDE)                                       */ 04581000
*/*%INCLUDE SYSUT5  (P1CONBDE)                                       */ 04582000
*/*%INCLUDE SYSUT5  (P1CONBDE)                                       */ 04583000
*/*%INCLUDE SYSUT5  (P1CONBDE)                                       */ 04584000
*/*%INCLUDE SYSUT5  (P1CONBDE)                                       */ 04585000
*/*%INCLUDE SYSUT5  (P1CONBDE)                                       */ 04586000
*/*%INCLUDE SYSUT5  (P1CONBDE)                                       */ 04587000
*/*%INCLUDE SYSUT5  (P1CONBDE)                                       */ 04588000
*/*%INCLUDE SYSUT5  (P1CONBDE)                                       */ 04589000
*/*%INCLUDE SYSUT5  (P1CONBDE)                                       */ 04590000
*/*%INCLUDE SYSUT5  (P1CONBDE)                                       */ 04591000
*/*%INCLUDE SYSUT5  (P1CONBD5)                                       */ 04592000
*/*%INCLUDE SYSUT5  (P1CONBD5)                                       */ 04593000
*/*%INCLUDE SYSUT5  (P1CONBD5)                                       */ 04594000
*/*%INCLUDE SYSUT5  (P1CONBD5)                                       */ 04595000
*/*%INCLUDE SYSUT5  (P1CONBD5)                                       */ 04596000
*/*%INCLUDE SYSUT5  (P1CONBD5)                                       */ 04597000
*/*%INCLUDE SYSUT5  (P1CONBD5)                                       */ 04598000
*/*%INCLUDE SYSUT5  (P1CONBD5)                                       */ 04599000
*/*%INCLUDE SYSUT5  (P1CONBD5)                                       */ 04600000
*/*%INCLUDE SYSUT5  (P1CONBD5)                                       */ 04601000
*/*%INCLUDE SYSUT5  (P1CONBD5)                                       */ 04602000
*/*%INCLUDE SYSUT5  (P1CONBD5)                                       */ 04603000
*/*%INCLUDE SYSUT5  (P1CONBD5)                                       */ 04604000
*/*%INCLUDE SYSUT5  (P1CONBD5)                                       */ 04605000
*/*%INCLUDE SYSUT5  (P1CONBD5)                                       */ 04606000
*/*%INCLUDE SYSUT5  (P1CONBD5)                                       */ 04607000
*/*%INCLUDE SYSUT5  (P1CONBD5)                                       */ 04608000
*/*%INCLUDE SYSUT5  (P1CONBD5)                                       */ 04609000
*/*%INCLUDE SYSUT5  (P1CONBD5)                                       */ 04610000
*/*%INCLUDE SYSUT5  (P1CONBD5)                                       */ 04611000
*/*%INCLUDE SYSUT5  (P1CONBD5)                                       */ 04612000
*/*%INCLUDE SYSUT5  (P1CONBD5)                                       */ 04613000
*/*%INCLUDE SYSUT5  (P1SADRC )                                       */ 04614000
*/*%INCLUDE SYSUT5  (P1SADRCV)                                       */ 04615000
*/*%INCLUDE SYSUT5  (P1SADRC1)                                       */ 04616000
*/*%INCLUDE SYSUT5  (P1DRCD  )                                       */ 04617000
*/*%INCLUDE SYSUT5  (P1DRDVL0)                                       */ 04618000
*/*%INCLUDE SYSUT5  (P1DRDVL1)                                       */ 04619000
*/*%INCLUDE SYSUT5  (P1DPATH )                                       */ 04620000
*/*%INCLUDE SYSUT5  (P1DPATHV)                                       */ 04621000
*/*%INCLUDE SYSUT5  (P1DPATH1)                                       */ 04622000
*/*%INCLUDE SYSUT5  (P1DPATH2)                                       */ 04623000
*/*%INCLUDE SYSUT5  (P1MSCSA1)                                       */ 04624000
*/*%INCLUDE SYSUT5  (P1CHSA  )                                       */ 04625000
*/*%INCLUDE SYSUT5  (P1CHSAV )                                       */ 04626000
*/*%INCLUDE SYSUT5  (P1SACON )                                       */ 04627000
*/*%INCLUDE SYSUT5  (P1SACONV)                                       */ 04628000
*/*%INCLUDE SYSUT5  (P1SACON1)                                       */ 04629000
*/*%INCLUDE SYSUT5  (P1SACON3)                                       */ 04630000
*/*%INCLUDE SYSUT5  (P1SACON2)                                       */ 04631000
*/*%INCLUDE SYSUT5  (P1CONDR )                                       */ 04632000
*/*%INCLUDE SYSUT5  (P1CDTOT1)                                       */ 04633000
*/*%INCLUDE SYSUT5  (P1CDTOT2)                                       */ 04634000
*/*%INCLUDE SYSUT5  (P1DSDPTH)                                       */ 04635000
*/*%INCLUDE SYSUT5  (P1DSDPTV)                                       */ 04636000
*/*%INCLUDE SYSUT5  (P1DSDPT2)                                       */ 04637000
*/*%INCLUDE SYSUT5  (P1DSDPT1)                                       */ 04638000
*/*%INCLUDE SYSUT5  (P1DSDPT3)                                       */ 04639000
*/*%INCLUDE SYSUT5  (P1PRINTL)                                       */ 04640000
*                                                               01S0827 04641000
*       ;                                                       01S0827 04642000
@DATA    DS    0H                                                       04643000
@CH00045 DC    H'1'                                                     04644000
@CH00106 DC    H'2'                                                     04645000
@CH00055 DC    H'4'                                                     04646000
@CH00101 DC    H'5'                                                     04647000
@CH00058 DC    H'6'                                                     04648000
@CH00099 DC    H'8'                                                     04649000
@CH00033 DC    H'10'                                                    04650000
@CH00035 DC    H'12'                                                    04651000
@CH00245 DC    H'14'                                                    04652000
@CH00210 DC    H'24'                                                    04653000
@CH00555 DC    H'48'                                                    04654000
@CH00402 DC    H'1000'                                                  04655000
@CH00651 DC    H'-190'                                                  04656000
@CH00650 DC    H'-94'                                                   04657000
@CH00654 DC    H'-46'                                                   04658000
@DATD    DSECT                                                          04659000
         DS    0F                                                       04660000
@SA00001 DS    18F                                                      04661000
@PC00001 DS    1F                                                       04662000
@SA00002 DS    1F                                                       04663000
@SA00004 DS    1F                                                       04664000
@SA00005 DS    1F                                                       04665000
@SA00006 DS    0F                                                       04666000
         DS    1F                                                       04667000
@TF00001 DS    F                                                        04668000
@TF00002 DS    F                                                        04669000
ISDAPAD1 CSECT                                                          04670000
         DS    0F                                                       04671000
@CF00103 DC    F'3'                                                     04672000
@CH00103 EQU   @CF00103+2                                               04673000
@CF00084 DC    F'16'                                                    04674000
@CH00084 EQU   @CF00084+2                                               04675000
@CF00646 DC    F'2048'                                                  04676000
@CF00667 DC    F'-54'                                                   04677000
@CF00666 DC    F'-48'                                                   04678000
@CF00664 DC    F'-30'                                                   04679000
@CF00660 DC    F'-8'                                                    04680000
@CF00661 DC    F'-4'                                                    04681000
@CF00662 DC    F'-3'                                                    04682000
@CF00663 DC    F'-1'                                                    04683000
@CF00310 DC    XL4'0F'                                                  04684000
@CF00511 DC    XL4'F0'                                                  04685000
@CF00073 DC    XL3'0'                                                   04686000
         DC    C'0'                                                     04687000
@DATD    DSECT                                                          04688000
         DS    0D                                                       04689000
J        DS    A                                                        04690000
DRDACCP  DS    A                                                        04691000
DRDACCE  DS    A                                                        04692000
LTPDRDP  DS    A                                                        04693000
DRDSPTR  DS    A                                                        04694000
ARRAY    DS    H                                                        04695000
MSF      DS    H                                                        04696000
MSC      DS    H                                                        04697000
DRC      DS    H                                                        04698000
UINTF    DS    H                                                        04699000
DRCP     DS    H                                                        04700000
FLAGS    DS    CL1                                                      04701000
         ORG   FLAGS                                                    04702000
DASD     DS    BL1                                                      04703000
@NM00001 EQU   FLAGS+0                                                  04704000
         ORG   FLAGS+1                                                  04705000
         DS    CL7                                                      04706000
TOTALS   DS    CL76                                                     04707000
         ORG   TOTALS                                                   04708000
ACCUMTOT DS    CL32                                                     04709000
DECNO    DS    CL8                                                      04710000
         ORG   DECNO                                                    04711000
@NM00002 DS    CL5                                                      04712000
DECNO2   DS    CL3                                                      04713000
         ORG   DECNO2                                                   04714000
@NM00003 DS    CL1                                                      04715000
DECNO1   DS    CL2                                                      04716000
         ORG   TOTALS+40                                                04717000
RTOTAL   DS    FL2                                                      04718000
LTOTAL   DS    16H                                                      04719000
GTOTAL   DS    FL2                                                      04720000
         ORG   TOTALS+76                                                04721000
VSADRC   DS    CL16                                                     04722000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                04723000
@ENDDATD EQU   *                                                        04724000
ISDAPAD1 CSECT                                                          04725000
         DS    0F                                                       04726000
@SIZDATD DC    AL1(0)                                                   04727000
         DC    AL3(@ENDDATD-@DATD)                                      04728000
@CV00053 DC    V(ISDAPRT0)                                              04729000
@CV00117 DC    V(ISDAFREE)                                              04730000
         DS    0D                                                       04731000
@CC00569 DC    C'EQUIP CHECK'                                           04732000
@CC00500 DC    C'CONTROLLER'                                            04733000
@CC00572 DC    C'CNTL CHECK'                                            04734000
@CC00467 DC    C'INTERFACE'                                             04735000
@CC00465 DC    C'CHANNEL'                                               04736000
@CC00240 DC    C'TOTAL'                                                 04737000
@CC00383 DC    C'ERROR'                                                 04738000
@CC00567 DC    C'CHECK'                                                 04739000
@CC00065 DC    C'    '                                                  04740000
@CC00067 DC    C'   *'                                                  04741000
@CC00340 DC    C' 200'                                                  04742000
@CC00603 DC    C'HOST'                                                  04743000
@CC00238 DC    C'MSC'                                                   04744000
@CC00279 EQU   @CC00065                                                 04745000
@CC00307 DC    C'DRC'                                                   04746000
@CC00316 DC    C'400'                                                   04747000
@CC00338 DC    C'DRD'                                                   04748000
@CC00390 DC    C'800'                                                   04749000
@CC00396 DC    C'200'                                                   04750000
@CC00585 DC    C'00'                                                    04751000
@CB00303 DC    X'0000000000000000'                                      04752000
@CB00313 EQU   @CB00303                                                 04753000
@CB00250 DC    X'0F0F0F'                                                04754000
@CB00246 EQU   @CB00303                                                 04755000
EDITPAT3 DC    X'40202120'                                              04756000
EDITPAT5 DC    X'402020202120'                                          04757000
EDITPATP DC    X'40202021204B20'                                        04758000
TRTAB    DC    CL16'0123456789ABCDEF'                                   04759000
DRDHEAD  DS    CL76                                                     04760000
         ORG   DRDHEAD                                                  04761000
@NM00011 DC    CL1'0'                                                   04762000
@NM00012 DC    CL32'REPORT 6 - PATH ANALYSIS REPORT '                   04763000
@NM00013 DC    CL19'OF EQUIPMENT CHECKS'                                04764000
@NM00014 DC    CL24'(DATA RECORDING DEVICES)'                           04765000
         ORG   DRDHEAD+76                                               04766000
MSCSAHD  DS    CL33                                                     04767000
         ORG   MSCSAHD                                                  04768000
@NM00015 DC    CL1'-'                                                   04769000
@NM00016 DC    CL3'   '                                                 04770000
@NM00017 DC    CL29'MSC/SA INTERFACE ERROR COUNTS'                      04771000
         ORG   MSCSAHD+33                                               04772000
SAHD     DS    CL98                                                     04773000
         ORG   SAHD                                                     04774000
@NM00018 DC    CL1'-'                                                   04775000
@NM00019 DC    CL12' '                                                  04776000
@NM00020 DC    CL52'SA     800  810  820  830  840  850  860  870  880 C04777000
                '                                                       04778000
@NM00021 DC    CL33'890  8A0  8B0  8C0  8D0  8E0  8F0'                  04779000
         ORG   SAHD+98                                                  04780000
SADRCHD  DS    CL54                                                     04781000
         ORG   SADRCHD                                                  04782000
@NM00031 DC    CL1'-'                                                   04783000
@NM00032 DC    CL3'   '                                                 04784000
@NM00033 DC    CL50'SA/DRC INTERFACE ERROR COUNTS               MSF 0 ' 04785000
         ORG   SADRCHD+54                                               04786000
DRCDRDHD DS    CL55                                                     04787000
         ORG   DRCDRDHD                                                 04788000
@NM00043 DC    CL1'-'                                                   04789000
@NM00044 DC    CL3'   '                                                 04790000
@NM00045 DC    CL30'DRC/DRD INTERFACE ERROR COUNTS'                     04791000
@NM00046 DC    CL21'              MSF 0  '                              04792000
         ORG   DRCDRDHD+55                                              04793000
PATHEAD  DS    CL57                                                     04794000
         ORG   PATHEAD                                                  04795000
@NM00063 DC    CL1'-'                                                   04796000
@NM00064 DC    CL3'   '                                                 04797000
@NM00065 DC    CL53'ERROR COUNTS BY REAL DEVICE PATH              MSF 0C04798000
                 '                                                      04799000
         ORG   PATHEAD+57                                               04800000
PATHEAD1 DS    CL101                                                    04801000
         ORG   PATHEAD1                                                 04802000
@NM00066 DC    CL1'-'                                                   04803000
@NM00067 DC    CL3'   '                                                 04804000
@NM00068 DC    CL3'MSC'                                                 04805000
@NM00069 DC    CL2'  '                                                  04806000
@NM00070 DC    CL2'SA'                                                  04807000
@NM00071 DC    CL7' '                                                   04808000
@NM00072 DC    CL3'DRC'                                                 04809000
@NM00073 DC    CL11' '                                                  04810000
@NM00074 DC    CL19'DRD'                                                04811000
@NM00075 DC    CL40' DRD UNIT  CTL-I ADT  DRC UNIT     TOTAL'           04812000
@NM00076 DC    CL10'    %ERROR'                                         04813000
         ORG   PATHEAD1+101                                             04814000
DASDHEAD DS    CL58                                                     04815000
         ORG   DASDHEAD                                                 04816000
@NM00081 DC    CL1'0'                                                   04817000
@NM00082 DC    CL35'REPORT 6 - PATH ANALYSIS REPORT OF '                04818000
@NM00083 DC    CL22'EQUIPMENT CHECKS(3330)'                             04819000
         ORG   DASDHEAD+58                                              04820000
CHSAHEAD DS    CL37                                                     04821000
         ORG   CHSAHEAD                                                 04822000
@NM00089 DC    CL1'-'                                                   04823000
@NM00090 DC    CL3'   '                                                 04824000
@NM00091 DC    CL33'CHANNEL/SA INTERFACE ERROR COUNTS'                  04825000
         ORG   CHSAHEAD+37                                              04826000
SACONHD  DS    CL37                                                     04827000
         ORG   SACONHD                                                  04828000
@NM00095 DC    CL1'-'                                                   04829000
@NM00096 DC    CL36'SA/CONTROLLER INTERFACE ERROR COUNTS'               04830000
         ORG   SACONHD+37                                               04831000
CONDRHD  DS    CL64                                                     04832000
         ORG   CONDRHD                                                  04833000
CONDRHD1 DS    CL64                                                     04834000
         ORG   CONDRHD1                                                 04835000
@NM00105 DC    CL1'-'                                                   04836000
@NM00106 DC    CL3'   '                                                 04837000
@NM00107 DC    CL27'CONTROLLER/DRIVE INTERFACE '                        04838000
@NM00108 DC    CL12'ERROR COUNTS'                                       04839000
@NM00109 DC    CL21'(STAGING ADAPTER 800)'                              04840000
         ORG   CONDRHD+64                                               04841000
DRIVEHD  DC    CL48'DRIVE       A    B    C    D    E    F    G    H'   04842000
DASDPTHD DS    CL58                                                     04843000
         ORG   DASDPTHD                                                 04844000
@NM00122 DC    CL1'0'                                                   04845000
@NM00123 DC    CL57'ERROR COUNTS BY REAL DEVICE PATH(MSC  DASD OPERATIOC04846000
               NS)'                                                     04847000
         ORG   DASDPTHD+58                                              04848000
DASDCOLH DS    CL102                                                    04849000
         ORG   DASDCOLH                                                 04850000
@NM00130 DC    CL1'0'                                                   04851000
@NM00131 DC    CL4'    '                                                04852000
@NM00132 DC    CL3'MSC'                                                 04853000
@NM00133 DC    CL2'  '                                                  04854000
@NM00134 DC    CL6'SA    '                                              04855000
@NM00135 DC    CL16'CONTROLLER'                                         04856000
@NM00136 DC    CL13'DRIVE'                                              04857000
@NM00137 DC    CL13'DRIVE EQUIP'                                        04858000
@NM00138 DC    CL14' DIRECTOR   '                                       04859000
         DC    CL14'  DIRECTOR  '                                       04860000
@NM00139 DC    CL3'   '                                                 04861000
@NM00140 DC    CL7'TOTAL'                                               04862000
@NM00141 DC    CL6'%ERROR'                                              04863000
         ORG   DASDCOLH+102                                             04864000
MSFAN    DC    AL4(MSFA1)                                               04865000
         DC    AL4(MSFA4)                                               04866000
         DC    AL4(MSFA3)                                               04867000
         DC    AL4(MSFA4)                                               04868000
MSFA1    DC    AL1(0)                                                   04869000
         DC    AL1(1)                                                   04870000
         DC    AL1(0)                                                   04871000
         DC    AL1(1)                                                   04872000
MSFA4    DC    AL1(0)                                                   04873000
         DC    AL1(1)                                                   04874000
         DC    AL1(2)                                                   04875000
         DC    AL1(3)                                                   04876000
         DC    AL1(2)                                                   04877000
         DC    AL1(3)                                                   04878000
         DC    AL1(0)                                                   04879000
         DC    AL1(1)                                                   04880000
         DC    AL1(4)                                                   04881000
         DC    AL1(5)                                                   04882000
         DC    AL1(6)                                                   04883000
         DC    AL1(7)                                                   04884000
         DC    AL1(6)                                                   04885000
         DC    AL1(7)                                                   04886000
         DC    AL1(4)                                                   04887000
         DC    AL1(5)                                                   04888000
MSFA3    DC    AL1(0)                                                   04889000
         DC    AL1(1)                                                   04890000
         DC    AL1(4)                                                   04891000
         DC    AL1(5)                                                   04892000
         DC    AL1(2)                                                   04893000
         DC    AL1(3)                                                   04894000
         DC    AL1(0)                                                   04895000
         DC    AL1(1)                                                   04896000
         DC    AL1(4)                                                   04897000
         DC    AL1(5)                                                   04898000
         DC    AL1(2)                                                   04899000
         DC    AL1(3)                                                   04900000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       04901000
@01      EQU   01                                                       04902000
@02      EQU   02                                                       04903000
@03      EQU   03                                                       04904000
@04      EQU   04                                                       04905000
@05      EQU   05                                                       04906000
@06      EQU   06                                                       04907000
@07      EQU   07                                                       04908000
@08      EQU   08                                                       04909000
@09      EQU   09                                                       04910000
@10      EQU   10                                                       04911000
@11      EQU   11                                                       04912000
@12      EQU   12                                                       04913000
@13      EQU   13                                                       04914000
@14      EQU   14                                                       04915000
@15      EQU   15                                                       04916000
CHCUPTR  EQU   @07                                                      04917000
ACCPTR   EQU   @03                                                      04918000
SATABP   EQU   @07                                                      04919000
DRD      EQU   @07                                                      04920000
SAP      EQU   @06                                                      04921000
LINES    EQU   @03                                                      04922000
CVTPTR   EQU   @02                                                      04923000
L        EQU   @07                                                      04924000
K        EQU   @04                                                      04925000
I        EQU   @05                                                      04926000
R1       EQU   @01                                                      04927000
DRDACC   EQU   0                                                        04928000
ACCUM1   EQU   0                                                        04929000
PCNFG    EQU   0                                                        04930000
CNFGFXD  EQU   PCNFG                                                    04931000
MSFNO    EQU   CNFGFXD                                                  04932000
SANO     EQU   CNFGFXD+6                                                04933000
LIBSIZS  EQU   CNFGFXD+8                                                04934000
LTPAD    EQU   PCNFG+16                                                 04935000
CHCUAD   EQU   PCNFG+20                                                 04936000
CPUSERAD EQU   PCNFG+24                                                 04937000
SAINTFP  EQU   PCNFG+32                                                 04938000
LTPDRDTB EQU   0                                                        04939000
LTPDRC   EQU   LTPDRDTB                                                 04940000
SADRDDSD EQU   0                                                        04941000
SADRDACC EQU   SADRDDSD                                                 04942000
SADASDAC EQU   SADRDDSD+4                                               04943000
DRDACCTB EQU   0                                                        04944000
DRDACCS  EQU   0                                                        04945000
DRDERRS  EQU   DRDACCS                                                  04946000
CTLIERRS EQU   DRDACCS+2                                                04947000
DRCERRS  EQU   DRDACCS+4                                                04948000
SAINTF   EQU   0                                                        04949000
CHCUTAB  EQU   0                                                        04950000
SPLTABP  EQU   CHCUTAB+8                                                04951000
SPNDLETB EQU   0                                                        04952000
SPNDLES  EQU   0                                                        04953000
DRVEQCHK EQU   SPNDLES                                                  04954000
STCTLCHK EQU   SPNDLES+2                                                04955000
STCTLCCK EQU   SPNDLES+4                                                04956000
P0WORK   EQU   0                                                        04957000
MSCDRDAC EQU   P0WORK+16                                                04958000
MSCINTF  EQU   MSCDRDAC                                                 04959000
SATABPTR EQU   MSCDRDAC+4                                               04960000
CSFTOTAL EQU   P0WORK+80                                                04961000
MSCTOTAL EQU   P0WORK+88                                                04962000
HTOTAL   EQU   P0WORK+90                                                04963000
P0WORK1  EQU   0                                                        04964000
PADFPTR1 EQU   P0WORK1                                                  04965000
ISDACVT  EQU   0                                                        04966000
CVTPTRS0 EQU   ISDACVT                                                  04967000
PAD00PTR EQU   CVTPTRS0+44                                              04968000
CNFG0PTR EQU   CVTPTRS0+88                                              04969000
WORKCALL EQU   CVTPTRS0+96                                              04970000
GET0CALL EQU   ISDACVT+100                                              04971000
SPNOLEN  EQU   GET0CALL                                                 04972000
SPNO     EQU   SPNOLEN                                                  04973000
CORELEN  EQU   SPNOLEN+1                                                04974000
COREADDR EQU   GET0CALL+4                                               04975000
HEXPCALL EQU   ISDACVT+108                                              04976000
PRT0CALL EQU   ISDACVT+120                                              04977000
OUTLINE  EQU   PRT0CALL                                                 04978000
SDADATD  EQU   ISDACVT+256                                              04979000
PRTDATD  EQU   ISDACVT+416                                              04980000
DRDS     EQU   0                                                        04981000
DASDACCS EQU   0                                                        04982000
CPUSERS  EQU   0                                                        04983000
WORKPTR  EQU   0                                                        04984000
MSFTOTC  EQU   CSFTOTAL                                                 04985000
CDRDACCT EQU   DRDACCTB                                                 04986000
CSPNDLET EQU   SPNDLETB                                                 04987000
@NM00006 EQU   OUTLINE                                                  04988000
MSC1     EQU   @NM00006+10                                              04989000
MSCCTOT  EQU   @NM00006+14                                              04990000
@NM00009 EQU   @NM00006+19                                              04991000
MSC2     EQU   @NM00009                                                 04992000
MSCTOT   EQU   @NM00006+99                                              04993000
SAHD2    EQU   OUTLINE                                                  04994000
COLUMN1  EQU   SAHD2+10                                                 04995000
COLTOTAL EQU   SAHD2+101                                                04996000
@NM00025 EQU   OUTLINE                                                  04997000
DRC1     EQU   @NM00025+10                                              04998000
DRC11    EQU   DRC1+1                                                   04999000
DRC12    EQU   DRC1+2                                                   05000000
DRC2     EQU   @NM00025+14                                              05001000
@NM00029 EQU   @NM00025+19                                              05002000
DRC3     EQU   @NM00029                                                 05003000
DRCTOT   EQU   @NM00025+99                                              05004000
@NM00034 EQU   OUTLINE                                                  05005000
ODRC     EQU   @NM00034+10                                              05006000
ODRCL    EQU   ODRC+1                                                   05007000
ODRCN    EQU   ODRC+2                                                   05008000
DRCD1    EQU   @NM00034+15                                              05009000
@NM00039 EQU   @NM00034+21                                              05010000
DRCD2    EQU   @NM00039                                                 05011000
DRCD2L   EQU   DRCD2+2                                                  05012000
DRCD2R   EQU   DRCD2+3                                                  05013000
DRCDRT   EQU   @NM00034+62                                              05014000
@NM00047 EQU   OUTLINE                                                  05015000
OPTOTAL  EQU   @NM00047+44                                              05016000
@NM00050 EQU   @NM00047+52                                              05017000
OERR     EQU   @NM00050                                                 05018000
OPTOT    EQU   @NM00047+84                                              05019000
OPCNT    EQU   @NM00047+93                                              05020000
@NM00054 EQU   OUTLINE                                                  05021000
MSC4     EQU   @NM00054+4                                               05022000
SA4      EQU   @NM00054+9                                               05023000
SA44     EQU   SA4+1                                                    05024000
DRC4     EQU   @NM00054+18                                              05025000
DRC44    EQU   DRC4+1                                                   05026000
DRC444   EQU   DRC4+2                                                   05027000
DRD4     EQU   @NM00054+32                                              05028000
DRD44    EQU   DRD4+1                                                   05029000
DRD444   EQU   DRD4+2                                                   05030000
@NM00077 EQU   OUTLINE                                                  05031000
E1       EQU   @NM00077+54                                              05032000
E2       EQU   @NM00077+64                                              05033000
E3       EQU   @NM00077+74                                              05034000
DASDACCP EQU   DRDACCP                                                  05035000
DASDACCE EQU   DRDACCE                                                  05036000
SAINTFC  EQU   SAINTF                                                   05037000
@NM00084 EQU   OUTLINE                                                  05038000
CHSA     EQU   @NM00084+11                                              05039000
CHSTOTL  EQU   @NM00084+14                                              05040000
@NM00087 EQU   @NM00084+19                                              05041000
CHS2     EQU   @NM00087                                                 05042000
CHSTOT   EQU   @NM00084+99                                              05043000
@NM00092 EQU   OUTLINE                                                  05044000
CHSAHD   EQU   @NM00092+7                                               05045000
CHSAHD1  EQU   @NM00092+101                                             05046000
@NM00097 EQU   OUTLINE                                                  05047000
SACON1   EQU   @NM00097+5                                               05048000
SACON2   EQU   @NM00097+101                                             05049000
@NM00100 EQU   OUTLINE                                                  05050000
CNTLRNO  EQU   @NM00100+9                                               05051000
@NM00103 EQU   @NM00100+30                                              05052000
ERRCNT1  EQU   @NM00103                                                 05053000
ERRTOT   EQU   @NM00100+70                                              05054000
@NM00110 EQU   OUTLINE                                                  05055000
DCONTRL  EQU   @NM00110+5                                               05056000
DTOTL    EQU   @NM00110+72                                              05057000
@NM00113 EQU   OUTLINE                                                  05058000
DSDMSC   EQU   @NM00113+5                                               05059000
DSDSA    EQU   @NM00113+10                                              05060000
DSDCNTL  EQU   @NM00113+19                                              05061000
DSDDRV   EQU   @NM00113+34                                              05062000
@NM00119 EQU   @NM00113+45                                              05063000
DSDCNT   EQU   @NM00119                                                 05064000
DSDTOTL  EQU   @NM00113+87                                              05065000
DSDPTOT  EQU   @NM00113+94                                              05066000
DRDCOLTC EQU   DSDDRV                                                   05067000
@NM00124 EQU   OUTLINE                                                  05068000
HOSTXX   EQU   @NM00124+5                                               05069000
DSDTYPE  EQU   @NM00124+34                                              05070000
DASDCL1  EQU   @NM00124+47                                              05071000
DASDCL2  EQU   @NM00124+58                                              05072000
DASDCL3  EQU   @NM00124+73                                              05073000
CSADRDDS EQU   SADRDDSD                                                 05074000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    05075000
@NM00129 EQU   @NM00124+69                                              05076000
@NM00128 EQU   @NM00124+52                                              05077000
@NM00127 EQU   @NM00124+38                                              05078000
@NM00126 EQU   @NM00124+8                                               05079000
@NM00125 EQU   @NM00124                                                 05080000
@NM00121 EQU   @NM00113+93                                              05081000
@NM00120 EQU   @NM00119+6                                               05082000
@NM00118 EQU   @NM00113+35                                              05083000
@NM00117 EQU   @NM00113+21                                              05084000
@NM00116 EQU   @NM00113+13                                              05085000
@NM00115 EQU   @NM00113+8                                               05086000
@NM00114 EQU   @NM00113                                                 05087000
@NM00112 EQU   @NM00110+15                                              05088000
@NM00111 EQU   @NM00110                                                 05089000
@NM00104 EQU   @NM00103+4                                               05090000
@NM00102 EQU   @NM00100+10                                              05091000
@NM00101 EQU   @NM00100                                                 05092000
@NM00099 EQU   @NM00097+15                                              05093000
@NM00098 EQU   @NM00097                                                 05094000
@NM00094 EQU   @NM00092+16                                              05095000
@NM00093 EQU   @NM00092                                                 05096000
@NM00088 EQU   @NM00087+4                                               05097000
@NM00086 EQU   @NM00084+12                                              05098000
@NM00085 EQU   @NM00084                                                 05099000
@NM00080 EQU   @NM00077+69                                              05100000
@NM00079 EQU   @NM00077+59                                              05101000
@NM00078 EQU   @NM00077                                                 05102000
@NM00062 EQU   DRD4                                                     05103000
@NM00061 EQU   @NM00054+21                                              05104000
@NM00060 EQU   DRC4                                                     05105000
@NM00059 EQU   @NM00054+12                                              05106000
@NM00058 EQU   SA4+2                                                    05107000
@NM00057 EQU   SA4                                                      05108000
@NM00056 EQU   @NM00054+7                                               05109000
@NM00055 EQU   @NM00054                                                 05110000
@NM00053 EQU   @NM00047+90                                              05111000
@NM00052 EQU   @NM00047+82                                              05112000
@NM00051 EQU   @NM00050+6                                               05113000
@NM00049 EQU   @NM00047+49                                              05114000
@NM00048 EQU   @NM00047                                                 05115000
@NM00042 EQU   @NM00034+61                                              05116000
@NM00041 EQU   @NM00039+4                                               05117000
@NM00040 EQU   DRCD2                                                    05118000
@NM00038 EQU   @NM00034+20                                              05119000
@NM00037 EQU   @NM00034+13                                              05120000
@NM00036 EQU   ODRC                                                     05121000
@NM00035 EQU   @NM00034                                                 05122000
@NM00030 EQU   @NM00029+4                                               05123000
@NM00028 EQU   @NM00025+13                                              05124000
@NM00027 EQU   DRC1                                                     05125000
@NM00026 EQU   @NM00025                                                 05126000
@NM00024 EQU   SAHD2+99                                                 05127000
SAEL2    EQU   SAHD2+19                                                 05128000
@NM00023 EQU   SAHD2+13                                                 05129000
@NM00022 EQU   SAHD2                                                    05130000
@NM00010 EQU   @NM00009+4                                               05131000
@NM00008 EQU   @NM00006+13                                              05132000
@NM00007 EQU   @NM00006                                                 05133000
PRTSA001 EQU   PRTDATD                                                  05134000
SDATEMPS EQU   SDADATD+136                                              05135000
SDASA002 EQU   SDADATD+76                                               05136000
SDAPC001 EQU   SDADATD+72                                               05137000
SDASA001 EQU   SDADATD                                                  05138000
SDARPTID EQU   PRT0CALL+133                                             05139000
LINE     EQU   OUTLINE+1                                                05140000
ANSI     EQU   OUTLINE                                                  05141000
DUMPIDNO EQU   HEXPCALL+8                                               05142000
DUMPLEN  EQU   HEXPCALL+4                                               05143000
DUMPADDR EQU   HEXPCALL                                                 05144000
GEN00PTR EQU   CVTPTRS0+92                                              05145000
PWR00PTR EQU   CVTPTRS0+84                                              05146000
APR00PTR EQU   CVTPTRS0+80                                              05147000
DRC00PTR EQU   CVTPTRS0+76                                              05148000
DAT00PTR EQU   CVTPTRS0+72                                              05149000
CSB00PTR EQU   CVTPTRS0+68                                              05150000
DCK00PTR EQU   CVTPTRS0+64                                              05151000
EQC00PTR EQU   CVTPTRS0+60                                              05152000
FSC00PTR EQU   CVTPTRS0+56                                              05153000
DHE00PTR EQU   CVTPTRS0+52                                              05154000
SUM00PTR EQU   CVTPTRS0+48                                              05155000
DCS00PTR EQU   CVTPTRS0+40                                              05156000
LOG00PTR EQU   CVTPTRS0+36                                              05157000
HIST0PTR EQU   CVTPTRS0+32                                              05158000
PRT00PTR EQU   CVTPTRS0+28                                              05159000
GET00PTR EQU   CVTPTRS0+24                                              05160000
TYPE0PTR EQU   CVTPTRS0+20                                              05161000
PARM0PTR EQU   CVTPTRS0+16                                              05162000
SDA00PTR EQU   CVTPTRS0+12                                              05163000
PARMPTR  EQU   CVTPTRS0+8                                               05164000
SDATAPTR EQU   CVTPTRS0+4                                               05165000
DATAPTR  EQU   CVTPTRS0                                                 05166000
@NM00005 EQU   MSCDRDAC+2                                               05167000
ENDCORE  EQU   P0WORK+12                                                05168000
COREASG  EQU   P0WORK+8                                                 05169000
PADLASTB EQU   P0WORK+4                                                 05170000
PADFPTR  EQU   P0WORK                                                   05171000
INTF     EQU   CHCUTAB+7                                                05172000
SA       EQU   CHCUTAB+6                                                05173000
CHCU     EQU   CHCUTAB+5                                                05174000
CPUIDSER EQU   CHCUTAB                                                  05175000
DRCL1    EQU   LTPDRC+1                                                 05176000
DRCL0    EQU   LTPDRC                                                   05177000
@NM00004 EQU   PCNFG+30                                                 05178000
CNFGTOTL EQU   PCNFG+28                                                 05179000
PCNFGL   EQU   CNFGFXD+14                                               05180000
CHINTFNO EQU   CNFGFXD+12                                               05181000
SPINO    EQU   CNFGFXD+4                                                05182000
CPUNO    EQU   CNFGFXD+2                                                05183000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      05184000
@RF00702 EQU   @EL00004                                                 05185000
@ENDDATA EQU   *                                                        05186000
         END   ISDAPAD1,(C'PLS1855',0603,75268)                         05187000
