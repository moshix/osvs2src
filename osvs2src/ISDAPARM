         TITLE 'ISDAPARM SDA PARAMETER PROCESSOR                       *00001000
                        '                                               00002000
ISDAPARM CSECT ,                                                   0001 00003000
@MAINENT DS    0H                                                  0001 00004000
         USING *,@15                                               0001 00005000
         B     @PROLOG                                             0001 00006000
         DC    AL1(8)                                              0001 00007000
         DC    C'ISDAPARM'                                         0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                     0001 00010000
         BALR  @11,0                                               0001 00011000
@PSTART  LA    @12,4095(,@11)                                      0001 00012000
         USING @PSTART,@11                                         0001 00013000
         USING @PSTART+4095,@12                                    0001 00014000
         L     @00,@SIZDATD                                        0001 00015000
         GETMAIN  R,LV=(0)                                              00016000
         LR    @10,@01                                             0001 00017000
         USING @DATD,@10                                           0001 00018000
         ST    @13,@SA00001+4                                      0001 00019000
         LM    @00,@01,20(@13)                                     0001 00020000
         ST    @10,8(,@13)                                         0001 00021000
         LR    @13,@10                                             0001 00022000
         MVC   @PC00001(4),0(@01)                                  0001 00023000
*                                                                  0069 00024000
*   /*****************************************************************/ 00025000
*   /*                                                               */ 00026000
*   /* CONTROL LINKAGE                                               */ 00027000
*   /*                                                               */ 00028000
*   /*****************************************************************/ 00029000
*                                                                  0069 00030000
*   CVTPTR=WORKPTR;                 /* BASE FOR SDA CVT      @Y30LB54*/ 00031000
         L     @15,@PC00001                                        0069 00032000
         L     CVTPTR,WORKPTR(,@15)                                0069 00033000
*   LPARMPTR=PARMPTR;               /* GETMAIN AREA BASE FOR PARMS 0070 00034000
*                                                            @Y30LB54*/ 00035000
         MVC   LPARMPTR(4),PARMPTR(CVTPTR)                         0070 00036000
*   ANSI=' ';                       /* SET CARRIAGE CONTROL CHAR   0071 00037000
*                                                            @Y30LB54*/ 00038000
*                                                                  0071 00039000
         MVI   ANSI(CVTPTR),C' '                                   0071 00040000
*   /*****************************************************************/ 00041000
*   /*                                                               */ 00042000
*   /* HOUSEKEEPING AND INITIALIZATION                               */ 00043000
*   /*                                                               */ 00044000
*   /*****************************************************************/ 00045000
*                                                                  0072 00046000
*   LINE='ISDAPARM ENTER PARAMETERS AT THIS POINT';/*        @Y30LB54*/ 00047000
         MVI   LINE+39(CVTPTR),C' '                                0072 00048000
         MVC   LINE+40(92,CVTPTR),LINE+39(CVTPTR)                  0072 00049000
         MVC   LINE(39,CVTPTR),@CC00348                            0072 00050000
*   CALL ISDATYPE(WORKPTR);         /*                       @Y30LB54*/ 00051000
         L     @03,@PC00001                                        0073 00052000
         ST    @03,@AL00001                                        0073 00053000
         L     @15,@CV00038                                        0073 00054000
         LA    @01,@AL00001                                        0073 00055000
         BALR  @14,@15                                             0073 00056000
*   WORKBUF=' ';                    /* CLEAR AREA OF COMPRESSED SYSIN   00057000
*                                                            @Y30LB54*/ 00058000
         MVI   WORKBUF+1,C' '                                      0074 00059000
         MVC   WORKBUF+2(198),WORKBUF+1                            0074 00060000
         MVI   WORKBUF,C' '                                        0074 00061000
*   CHARL=0;                        /* USED BY SCAN1         @Y30LB54*/ 00062000
         SLR   @03,@03                                             0075 00063000
         ST    @03,CHARL                                           0075 00064000
*   CHAR1=0;                        /* USED BY SCAN1         @Y30LB54*/ 00065000
         SLR   @03,@03                                             0076 00066000
         ST    @03,CHAR1                                           0076 00067000
*   INPTR=ADDR(WORKBUF);            /* USED FOR DURATION OF PGM    0077 00068000
*                                                            @Y30LB54*/ 00069000
         LA    @03,WORKBUF                                         0077 00070000
         ST    @03,INPTR                                           0077 00071000
*   INPTR1=ADDR(WORKBUF)+200;       /* USED FOR DURATION     @Y30LB54*/ 00072000
         LA    @03,WORKBUF                                         0078 00073000
         AH    @03,@CH00327                                        0078 00074000
         ST    @03,INPTR1                                          0078 00075000
*   INPUT=INPUT&&INPUT;             /* CLEAR PROCESSING AREA @Y30LB54*/ 00076000
         L     @03,INPTR                                           0079 00077000
         XC    INPUT(200,@03),INPUT(@03)                           0079 00078000
*   ENDTXT=0;                       /* USED CARDIN,SCAN1     @Y30LB54*/ 00079000
         SLR   @03,@03                                             0080 00080000
         ST    @03,ENDTXT                                          0080 00081000
*   STARTTXT=0;                     /* USED CARDIN,SCAN1     @Y30LB54*/ 00082000
         SLR   @03,@03                                             0081 00083000
         ST    @03,STARTTXT                                        0081 00084000
*   FULLWD2=0;                      /* WORKING REGISTER      @Y30LB54*/ 00085000
         SLR   @03,@03                                             0082 00086000
         ST    @03,FULLWD2                                         0082 00087000
*   RETCODE=0;                      /*                       @Y30LB54*/ 00088000
         SLR   @03,@03                                             0083 00089000
         ST    @03,RETCODE                                         0083 00090000
*   RETCODE1=0;                     /*                       @Y30LB54*/ 00091000
         SLR   @03,@03                                             0084 00092000
         ST    @03,RETCODE1                                        0084 00093000
*   ENDPRM=0;                       /* OUPUT SCAN1           @Y30LB54*/ 00094000
         SLR   @03,@03                                             0085 00095000
         ST    @03,ENDPRM                                          0085 00096000
*   STARTPRM=0;                     /* OUTPUT SCAN1          @Y30LB54*/ 00097000
         SLR   @03,@03                                             0086 00098000
         ST    @03,STARTPRM                                        0086 00099000
*   STARTINP=0;                     /* USED CARDIN,SCAN1     @Y30LB54*/ 00100000
         SLR   @03,@03                                             0087 00101000
         ST    @03,STARTINP                                        0087 00102000
*   ENDINP=0;                       /* USED CARDIN,SCAN1     @Y30LB54*/ 00103000
         SLR   @03,@03                                             0088 00104000
         ST    @03,ENDINP                                          0088 00105000
*   SYSINDCB(1:96)=DCBSTAT(1:96);   /* OBTAIN GOOD COPY OF DCB IN  0089 00106000
*                                      POOL 0                @Y30LB54*/ 00107000
         MVC   SYSINDCB(96),DCBSTAT                                0089 00108000
*   OPENLIST=OPENSTAT;              /* OBTAIN GOOD COPY OF OPEN LIST    00109000
*                                      IN POOL 0             @Y30LB54*/ 00110000
         MVC   OPENLIST(4),OPENSTAT                                0090 00111000
*   CLOSLIST=CLOSSTAT;              /* OBTAIN GOOD COPY OF CLOSE LIST   00112000
*                                      IN POOL 0             @Y30LB54*/ 00113000
*                                                                  0091 00114000
         MVC   CLOSLIST(4),CLOSSTAT                                0091 00115000
*   /*****************************************************************/ 00116000
*   /*                                                               */ 00117000
*   /* LOGIC TO INSURE CORRECT TEMPLATE DEFAULTS TAKEN               */ 00118000
*   /*                                                               */ 00119000
*   /*****************************************************************/ 00120000
*                                                                  0092 00121000
*   ISDAPRMS=SDAPARM0;              /* MOVE DEFAULTS TO GETMAIN AREA    00122000
*                                                            @Y30LB54*/ 00123000
*                                                                  0092 00124000
         L     @03,LPARMPTR                                        0092 00125000
         MVC   ISDAPRMS(49,@03),SDAPARM0                           0092 00126000
*   /*****************************************************************/ 00127000
*   /*                                                               */ 00128000
*   /* MAIN LOGIC DISPATCHER                                         */ 00129000
*   /*                                                               */ 00130000
*   /*****************************************************************/ 00131000
*                                                                  0093 00132000
*/*FILL WORKING BUFFER WITH COMPRESSED SYSIN                 @Y30LB54*/ 00133000
*                                                                  0093 00134000
*   CALL CARDIN;                    /* PROCESS THE SYSIN STREAM    0093 00135000
*                                                            @Y30LB54*/ 00136000
         BAL   @14,CARDIN                                          0093 00137000
*/*OUTPUT OF CARDIN IS INPTR1,AND INPTR ADDRESSES OF BOUNDRIES     0094 00138000
*                                                            @Y30LB54*/ 00139000
*/*OF WORKING BUFFER FILLED IN WITH ALL COMPRESSES SYSIN     @Y30LB54*/ 00140000
*/*STARTINP AND ENDINP ARE COUNTERS USED TO KEEP TRACK OF    @Y30LB54*/ 00141000
*/*WORKING BUFFER BUT ARE NOT PASSED TO ANY OTHER PROCESSOR  @Y30LB54*/ 00142000
*/*STARTTXT AND ENDTXT KEEP TRACK OF INDIVIDUAL CARD LIMITS  @Y30LB54*/ 00143000
*/*BUT ARE NOT PASSED TO ANY OTHER PROCESSOR                 @Y30LB54*/ 00144000
*                                                                  0094 00145000
*   IF RETCODE^=0 THEN                                             0094 00146000
         ICM   @03,15,RETCODE                                      0094 00147000
         BZ    @RF00094                                            0094 00148000
*     RETURN CODE(RETCODE);         /* OTHER THAN EOF ON SYSIN     0095 00149000
*                                                            @Y30LB54*/ 00150000
         L     @03,RETCODE                                         0095 00151000
         L     @13,4(,@13)                                         0095 00152000
         L     @00,@SIZDATD                                        0095 00153000
         LR    @01,@10                                             0095 00154000
         FREEMAIN R,LV=(0),A=(1)                                        00155000
         LR    @15,@03                                             0095 00156000
         L     @14,12(,@13)                                        0095 00157000
         LM    @00,@12,20(@13)                                     0095 00158000
         BR    @14                                                 0095 00159000
*   ELSE                                                           0096 00160000
*     DO;                           /*                       @Y30LB54*/ 00161000
@RF00094 DS    0H                                                  0097 00162000
*       IF INPUT(ONE:FOUR)=0 THEN                                  0097 00163000
         L     @03,INPTR                                           0097 00164000
         ICM   @15,15,INPUT(@03)                                   0097 00165000
         BZ    @RT00097                                            0097 00166000
*         ;                         /*                       @Y30LB54*/ 00167000
*       ELSE                                                       0099 00168000
*         CALL EMPTYIT;             /* PROCESS DATA          @Y30LB54*/ 00169000
         BAL   @14,EMPTYIT                                         0099 00170000
*     END;                          /*                       @Y30LB54*/ 00171000
*                                                                  0100 00172000
@RT00097 DS    0H                                                  0101 00173000
*   /*****************************************************************/ 00174000
*   /*                                                               */ 00175000
*   /* PROCESS JCL INPUT PARMS INTO WORK BUFFER                      */ 00176000
*   /*                                                               */ 00177000
*   /*****************************************************************/ 00178000
*                                                                  0101 00179000
*   CALL JCLIN;                     /* PROCESS THE JCL PARAMETERS  0101 00180000
*                                                            @Y30LB54*/ 00181000
         BAL   @14,JCLIN                                           0101 00182000
*   IF INPUT(ONE:FOUR)=0 THEN                                      0102 00183000
         L     @03,INPTR                                           0102 00184000
         ICM   @15,15,INPUT(@03)                                   0102 00185000
         BZ    @RT00102                                            0102 00186000
*     ;                             /*                       @Y30LB54*/ 00187000
*   ELSE                                                           0104 00188000
*     CALL EMPTYIT;                 /* PROCESS DATA          @Y30LB54*/ 00189000
         BAL   @14,EMPTYIT                                         0104 00190000
*                                                                  0105 00191000
*   /*****************************************************************/ 00192000
*   /*                                                               */ 00193000
*   /* FOURTH PRIORITY SPECIAL PROCESSING                            */ 00194000
*   /*                                                               */ 00195000
*   /*****************************************************************/ 00196000
*                                                                  0105 00197000
*   IF CDETAIL^=0 THEN                                             0105 00198000
@RT00102 L     @03,LPARMPTR                                        0105 00199000
         CLI   CDETAIL(@03),0                                      0105 00200000
         BE    @RF00105                                            0105 00201000
*     CSUM=CSUM|'02'X;              /* TELL SUMMARY DETAIL WAS FILLED   00202000
*                                      IN                    @Y30LB54*/ 00203000
         L     @03,LPARMPTR                                        0106 00204000
         OI    CSUM(@03),X'02'                                     0106 00205000
*   ELSE                                                           0107 00206000
*     CSUM=CSUM&'FD'X;              /* TURN OFF CSUM DETAIL PORTION     00207000
*                                                            @Y30LB54*/ 00208000
         B     @RC00105                                            0107 00209000
@RF00105 L     @03,LPARMPTR                                        0107 00210000
         NI    CSUM(@03),X'FD'                                     0107 00211000
*   IF CSUM^=0 THEN                                                0108 00212000
@RC00105 L     @03,LPARMPTR                                        0108 00213000
         CLI   CSUM(@03),0                                         0108 00214000
         BE    @RF00108                                            0108 00215000
*     CGEN=CGEN|'01'X;              /* CALL FSC GENERATOR    @Y30LB54*/ 00216000
         L     @03,LPARMPTR                                        0109 00217000
         OI    CGEN(@03),X'01'                                     0109 00218000
*   ELSE                                                           0110 00219000
*     ;                             /*                       @Y30LB54*/ 00220000
@RF00108 DS    0H                                                  0111 00221000
*   IF CFSC^=0 THEN                                                0111 00222000
         L     @03,LPARMPTR                                        0111 00223000
         CLI   CFSC(@03),0                                         0111 00224000
         BE    @RF00111                                            0111 00225000
*     CGEN=CGEN|'02'X;              /* CALL FSC GENERATOR    @Y30LB54*/ 00226000
         L     @03,LPARMPTR                                        0112 00227000
         OI    CGEN(@03),X'02'                                     0112 00228000
*   ELSE                                                           0113 00229000
*     ;                             /*                       @Y30LB54*/ 00230000
@RF00111 DS    0H                                                  0114 00231000
*   IF CEQC^=0 THEN                                                0114 00232000
         L     @03,LPARMPTR                                        0114 00233000
         CLI   CEQC(@03),0                                         0114 00234000
         BE    @RF00114                                            0114 00235000
*     CGEN=CGEN|'04'X;              /* CALL FSC GENERATOR    @Y30LB54*/ 00236000
         L     @03,LPARMPTR                                        0115 00237000
         OI    CGEN(@03),X'04'                                     0115 00238000
*   ELSE                                                           0116 00239000
*     ;                             /*                       @Y30LB54*/ 00240000
@RF00114 DS    0H                                                  0117 00241000
*   RETURN CODE(RETCODE);           /*                       @Y30LB54*/ 00242000
         L     @03,RETCODE                                         0117 00243000
         L     @13,4(,@13)                                         0117 00244000
         L     @00,@SIZDATD                                        0117 00245000
         LR    @01,@10                                             0117 00246000
         FREEMAIN R,LV=(0),A=(1)                                        00247000
         LR    @15,@03                                             0117 00248000
         L     @14,12(,@13)                                        0117 00249000
         LM    @00,@12,20(@13)                                     0117 00250000
         BR    @14                                                 0117 00251000
*                                                                  0118 00252000
*   /*****************************************************************/ 00253000
*   /*                                                               */ 00254000
*   /* SYSIN PROCESSOR                                               */ 00255000
*   /*                                                               */ 00256000
*   /*****************************************************************/ 00257000
*                                                                  0118 00258000
*CARDIN:                                                           0118 00259000
*   PROC;                           /*                       @Y30LB54*/ 00260000
@EL00001 L     @13,4(,@13)                                         0118 00261000
@EF00001 L     @00,@SIZDATD                                        0118 00262000
         LR    @01,@10                                             0118 00263000
         FREEMAIN R,LV=(0),A=(1)                                        00264000
@ER00001 LM    @14,@12,12(@13)                                     0118 00265000
         BR    @14                                                 0118 00266000
CARDIN   STM   @14,@12,@SA00002                                    0118 00267000
*   STARTINP=FIVE;                  /* RESET PTR TO START OF INPUT 0119 00268000
*                                      AREA                  @Y30LB54*/ 00269000
         MVC   STARTINP(4),@CF00318                                0119 00270000
*   ENDINP=FOUR;                    /* RESET PTR TO END OF INPUT AREA   00271000
*                                                            @Y30LB54*/ 00272000
*                                                                  0120 00273000
         MVC   ENDINP(4),@CF00071                                  0120 00274000
*   /*****************************************************************/ 00275000
*   /*                                                               */ 00276000
*   /* GET SYSIN LOOP                                                */ 00277000
*   /*                                                               */ 00278000
*   /*****************************************************************/ 00279000
*                                                                  0121 00280000
*   DO WHILE(RETCODE=0);            /*                       @Y30LB54*/ 00281000
         B     @DE00121                                            0121 00282000
@DL00121 DS    0H                                                  0122 00283000
*     LINE='ENTER NEXT LINE ';      /*                       @Y30LB54*/ 00284000
         MVI   LINE+16(CVTPTR),C' '                                0122 00285000
         MVC   LINE+17(115,CVTPTR),LINE+16(CVTPTR)                 0122 00286000
         MVC   LINE(16,CVTPTR),@CC00357                            0122 00287000
*     CALL ISDATYPE(WORKPTR);       /* TO TERMINAL OUTPUT    @Y30LB54*/ 00288000
         L     @03,@PC00001                                        0123 00289000
         ST    @03,@AL00001                                        0123 00290000
         L     @15,@CV00038                                        0123 00291000
         LA    @01,@AL00001                                        0123 00292000
         BALR  @14,@15                                             0123 00293000
*     CALL GETCARD;                 /* GET SYSIN             @Y30LB54*/ 00294000
         BAL   @14,GETCARD                                         0124 00295000
*     RFY                                                          0125 00296000
*       CONDCODE RSTD;              /*                       @Y30LB54*/ 00297000
*     RETCODE=CONDCODE;             /*                       @Y30LB54*/ 00298000
         ST    CONDCODE,RETCODE                                    0126 00299000
*     RFY                                                          0127 00300000
*       CONDCODE UNRSTD;            /*                       @Y30LB54*/ 00301000
*     IF RETCODE=8|RETCODE=4 THEN                                  0128 00302000
         CLC   RETCODE(4),@CF00091                                 0128 00303000
         BE    @RT00128                                            0128 00304000
         CLC   RETCODE(4),@CF00071                                 0128 00305000
         BNE   @RF00128                                            0128 00306000
@RT00128 DS    0H                                                  0129 00307000
*       DO;                         /* IT IS AN EOF          @Y30LB54*/ 00308000
*         INPUT(ENDINP:ENDINP)=SMI; /* BLANK LAST CHAR       @Y30LB54*/ 00309000
         L     @03,INPTR                                           0130 00310000
         AL    @03,ENDINP                                          0130 00311000
         AL    @03,@CF00396                                        0130 00312000
         MVI   INPUT(@03),X'5E'                                    0130 00313000
*         INPTR1=ADDR(WORKBUF)+ENDINP-ONE;/* NEW END OF WORK AREA  0131 00314000
*                                                            @Y30LB54*/ 00315000
*                                                                  0131 00316000
         LA    @03,WORKBUF                                         0131 00317000
         AL    @03,ENDINP                                          0131 00318000
         BCTR  @03,0                                               0131 00319000
         ST    @03,INPTR1                                          0131 00320000
*         /***********************************************************/ 00321000
*         /*                                                         */ 00322000
*         /* ENDINP NOW SHOWS LAST BYTE OF REAL DATA IN INPUT AREA   */ 00323000
*         /*                                                         */ 00324000
*         /***********************************************************/ 00325000
*                                                                  0132 00326000
*         RETCODE=0;                /*                       @Y30LB54*/ 00327000
         SLR   @03,@03                                             0132 00328000
         ST    @03,RETCODE                                         0132 00329000
*         RETURN CODE(RETCODE);     /* EXIT TO CALLING PROGRAM     0133 00330000
*                                                            @Y30LB54*/ 00331000
         L     @15,RETCODE                                         0133 00332000
         L     @14,@SA00002                                        0133 00333000
         LM    @00,@12,@SA00002+8                                  0133 00334000
         BR    @14                                                 0133 00335000
*       END;                        /*                       @Y30LB54*/ 00336000
*     ELSE                                                         0135 00337000
*       IF RETCODE^=0 THEN                                         0135 00338000
@RF00128 ICM   @03,15,RETCODE                                      0135 00339000
         BZ    @RF00135                                            0135 00340000
*         DO;                       /*                       @Y30LB54*/ 00341000
*           RETURN CODE(RETCODE);   /*                       @Y30LB54*/ 00342000
         L     @15,RETCODE                                         0137 00343000
         L     @14,@SA00002                                        0137 00344000
         LM    @00,@12,@SA00002+8                                  0137 00345000
         BR    @14                                                 0137 00346000
*         END;                      /*                       @Y30LB54*/ 00347000
*       ELSE                                                       0139 00348000
*         ;                                                /*@Y30LB54*/ 00349000
@RF00135 DS    0H                                                  0140 00350000
*     DO;                           /*                       @Y30LB54*/ 00351000
*       STARTTXT=0;                 /* RESET STARTING POINTER CARD 0141 00352000
*                                                            @Y30LB54*/ 00353000
         SLR   @03,@03                                             0141 00354000
         ST    @03,STARTTXT                                        0141 00355000
*       ENDTXT=0;                   /* RESET ENDING POINTER CARD   0142 00356000
*                                                            @Y30LB54*/ 00357000
         SLR   @03,@03                                             0142 00358000
         ST    @03,ENDTXT                                          0142 00359000
*       DO CTR=1 TO 80 BY 1;        /*                       @Y30LB54*/ 00360000
         LA    CTR,1                                               0143 00361000
@DL00143 DS    0H                                                  0144 00362000
*         IF CARD(CTR)=' ' THEN                                    0144 00363000
         LA    @01,CARD-1(CTR)                                     0144 00364000
         CLI   0(@01),C' '                                         0144 00365000
         BE    @RT00144                                            0144 00366000
*           ;                       /* SCAN FOR FIRST NON BLANK CHAR    00367000
*                                                            @Y30LB54*/ 00368000
*         ELSE                                                     0146 00369000
*           DO;                     /*                       @Y30LB54*/ 00370000
*             STARTTXT=CTR;         /* FIRST NON BLANK LOCATION    0147 00371000
*                                                            @Y30LB54*/ 00372000
         ST    CTR,STARTTXT                                        0147 00373000
*             DO CTR=CTR TO 80 BY 1;/*                       @Y30LB54*/ 00374000
         B     @DE00148                                            0148 00375000
@DL00148 DS    0H                                                  0149 00376000
*               IF CARD(CTR)=SMI THEN/*                      @Y30LB54*/ 00377000
         LA    @01,CARD-1(CTR)                                     0149 00378000
         CLI   0(@01),X'5E'                                        0149 00379000
         BNE   @RF00149                                            0149 00380000
*                 DO;               /*                       @Y30LB54*/ 00381000
*                   ENDTXT=CTR;     /* LAST CHAR OF INPUT    @Y30LB54*/ 00382000
         ST    CTR,ENDTXT                                          0151 00383000
*                   CTR=81;         /* TERMINATE THIS LINE OF INPUT     00384000
*                                      REST COMMENTS         @Y30LB54*/ 00385000
         LA    CTR,81                                              0152 00386000
*                 END;              /*                       @Y30LB54*/ 00387000
*               ELSE                                               0154 00388000
*                 ;                 /*                       @Y30LB54*/ 00389000
@RF00149 DS    0H                                                  0155 00390000
*             END;                  /*                       @Y30LB54*/ 00391000
         AH    CTR,@CH00068                                        0155 00392000
@DE00148 CH    CTR,@CH00331                                        0155 00393000
         BNH   @DL00148                                            0155 00394000
*             IF ENDTXT=0 THEN                                     0156 00395000
         ICM   @15,15,ENDTXT                                       0156 00396000
         BNZ   @RF00156                                            0156 00397000
*               DO;                 /*                       @Y30LB54*/ 00398000
*                 IF CARD(80)=' ' THEN                             0158 00399000
         CLI   CARD+79,C' '                                        0158 00400000
         BNE   @RF00158                                            0158 00401000
*                   DO CTR=CTR-ONE TO 0 BY-ONE;/*            @Y30LB54*/ 00402000
         LR    @15,CTR                                             0159 00403000
         BCTR  @15,0                                               0159 00404000
         LR    CTR,@15                                             0159 00405000
         B     @DE00159                                            0159 00406000
@DL00159 DS    0H                                                  0160 00407000
*                     IF CARD(CTR)=' ' THEN                        0160 00408000
         LA    @01,CARD-1(CTR)                                     0160 00409000
         CLI   0(@01),C' '                                         0160 00410000
         BE    @RT00160                                            0160 00411000
*                       ;           /*                       @Y30LB54*/ 00412000
*                     ELSE                                         0162 00413000
*                       DO;         /*                       @Y30LB54*/ 00414000
*                         ENDTXT=CTR+ONE;/*                  @Y30LB54*/ 00415000
         LA    @15,1                                               0163 00416000
         ALR   @15,CTR                                             0163 00417000
         ST    @15,ENDTXT                                          0163 00418000
*                         CTR=0;    /*                       @Y30LB54*/ 00419000
         SLR   CTR,CTR                                             0164 00420000
*                       END;        /*                       @Y30LB54*/ 00421000
*                   END;            /*                       @Y30LB54*/ 00422000
@RT00160 BCTR  CTR,0                                               0166 00423000
@DE00159 LTR   CTR,CTR                                             0166 00424000
         BNM   @DL00159                                            0166 00425000
*                 ELSE                                             0167 00426000
*                   ENDTXT=81;      /* MAKE LAST COLUMN OF CARD END     00427000
*                                                            @Y30LB54*/ 00428000
         B     @RC00158                                            0167 00429000
@RF00158 MVC   ENDTXT(4),@CF00360                                  0167 00430000
*                 CTR=81;           /* TERMINATE THIS LOOP   @Y30LB54*/ 00431000
@RC00158 LA    CTR,81                                              0168 00432000
*               END;                /*                       @Y30LB54*/ 00433000
*             ELSE                                                 0170 00434000
*               ;                   /*                       @Y30LB54*/ 00435000
@RF00156 DS    0H                                                  0171 00436000
*           END;                    /*                       @Y30LB54*/ 00437000
*       END;                        /*                       @Y30LB54*/ 00438000
@RT00144 AH    CTR,@CH00068                                        0172 00439000
         CH    CTR,@CH00331                                        0172 00440000
         BNH   @DL00143                                            0172 00441000
*       IF STARTTXT=0               /* NO INPUT ON CARD      @Y30LB54*/ 00442000
*         THEN                                                     0173 00443000
         ICM   @03,15,STARTTXT                                     0173 00444000
         BZ    @RT00173                                            0173 00445000
*         ;                         /*                       @Y30LB54*/ 00446000
*       ELSE                                                       0175 00447000
*         DO;                       /*                       @Y30LB54*/ 00448000
*           FULLWD2=ENDTXT-STARTTXT+ONE;/* HOW MANY POSITIONS OF   0176 00449000
*                                      INPUT                 @Y30LB54*/ 00450000
         L     @03,ENDTXT                                          0176 00451000
         SL    @03,STARTTXT                                        0176 00452000
         AH    @03,@CH00068                                        0176 00453000
         ST    @03,FULLWD2                                         0176 00454000
*           ENDINP=ENDINP+FULLWD2;  /* LAST ITEM OF GOOD DATA@Y30LB54*/ 00455000
         L     @03,ENDINP                                          0177 00456000
         AL    @03,FULLWD2                                         0177 00457000
         ST    @03,ENDINP                                          0177 00458000
*           IF ENDINP+ADDR(WORKBUF)>INPTR1/* HAVE WE OVERFLOWED    0178 00459000
*                                                            @Y30LB54*/ 00460000
*             THEN                                                 0178 00461000
         LA    @03,WORKBUF                                         0178 00462000
         AL    @03,ENDINP                                          0178 00463000
         C     @03,INPTR1                                          0178 00464000
         BNH   @RF00178                                            0178 00465000
*             DO;                   /*                       @Y30LB54*/ 00466000
*               RETCODE=4;          /*                       @Y30LB54*/ 00467000
         MVC   RETCODE(4),@CF00071                                 0180 00468000
*               RETURN CODE(RETCODE);/*                      @Y30LB54*/ 00469000
         L     @15,RETCODE                                         0181 00470000
         L     @14,@SA00002                                        0181 00471000
         LM    @00,@12,@SA00002+8                                  0181 00472000
         BR    @14                                                 0181 00473000
*             END;                  /*                       @Y30LB54*/ 00474000
*           ELSE                                                   0183 00475000
*             INPUT(ONE:FOUR)=ENDINP;/* TURN ON LENGTH FIELD @Y30LB54*/ 00476000
@RF00178 L     @03,INPTR                                           0183 00477000
         MVC   INPUT(4,@03),ENDINP                                 0183 00478000
*           INPUT(STARTINP:ENDINP)=CARD(STARTTXT:ENDTXT);/*  @Y30LB54*/ 00479000
         L     @03,INPTR                                           0184 00480000
         AL    @03,STARTINP                                        0184 00481000
         AL    @03,@CF00396                                        0184 00482000
         L     @15,ENDINP                                          0184 00483000
         SL    @15,STARTINP                                        0184 00484000
         L     @01,STARTTXT                                        0184 00485000
         LA    @14,CARD-1(@01)                                     0184 00486000
         EX    @15,@SM00508                                        0184 00487000
*           INPUT(ENDINP:ENDINP)=',';/* MAKE IT LOOK LIKE JCL INPUT     00488000
*                                                            @Y30LB54*/ 00489000
         L     @03,INPTR                                           0185 00490000
         AL    @03,ENDINP                                          0185 00491000
         AL    @03,@CF00396                                        0185 00492000
         MVI   INPUT(@03),C','                                     0185 00493000
*           STARTINP=ENDINP+ONE;    /* SET UP FOR NEXT TIME AROUND 0186 00494000
*                                                            @Y30LB54*/ 00495000
         LA    @03,1                                               0186 00496000
         AL    @03,ENDINP                                          0186 00497000
         ST    @03,STARTINP                                        0186 00498000
*/*                    MOVE COMPESSED DATA TO INPUT AREA     @Y30LB54*/ 00499000
*                                                                  0187 00500000
*         END;                      /*                       @Y30LB54*/ 00501000
*     END;                          /*                       @Y30LB54*/ 00502000
@RT00173 DS    0H                                                  0189 00503000
*   END;                            /*                       @Y30LB54*/ 00504000
@DE00121 ICM   @03,15,RETCODE                                      0189 00505000
         BZ    @DL00121                                            0189 00506000
*   END CARDIN;                     /*                       @Y30LB54*/ 00507000
@EL00002 DS    0H                                                  0190 00508000
@EF00002 DS    0H                                                  0190 00509000
@ER00002 LM    @14,@12,@SA00002                                    0190 00510000
         BR    @14                                                 0190 00511000
*                                                                  0191 00512000
*   /*****************************************************************/ 00513000
*   /*                                                               */ 00514000
*   /* READ A CARD ROUTINE                                           */ 00515000
*   /*                                                               */ 00516000
*   /*****************************************************************/ 00517000
*                                                                  0191 00518000
*GETCARD:                                                          0191 00519000
*   PROC;                           /*                       @Y30LB54*/ 00520000
GETCARD  STM   @14,@12,@SA00003                                    0191 00521000
*   DCL                                                            0192 00522000
*    (EOD,                                                         0192 00523000
*     EOF) LABEL;                   /*                       @Y30LB54*/ 00524000
*                                                                  0192 00525000
*   /*****************************************************************/ 00526000
*   /*                                                               */ 00527000
*   /* ROUTINE TO READ CARD FROM SYSIN                               */ 00528000
*   /*                                                               */ 00529000
*   /*****************************************************************/ 00530000
*                                                                  0193 00531000
*   IF OFLAGS(4)^='1'B THEN                                        0193 00532000
         TM    OFLAGS,B'00010000'                                  0193 00533000
         BO    @RF00193                                            0193 00534000
*     DO;                           /* IS DCB OPEN           @Y30LB54*/ 00535000
*       GENERATE CODE;                                     /*@Y30LB54*/ 00536000
*                                                         /*@Y30LB54*/  00537000
        OPEN  (SYSINDCB,INPUT),MF=(E,OPENLIST)                          00538000
*       IF OFLAGS(4)='1'B THEN                                     0196 00539000
         TM    OFLAGS,B'00010000'                                  0196 00540000
         BNO   @RF00196                                            0196 00541000
*         RETCODE=0;                /* OPEN                  @Y30LB54*/ 00542000
         SLR   @03,@03                                             0197 00543000
         ST    @03,RETCODE                                         0197 00544000
*       ELSE                                                       0198 00545000
*         RETCODE=4;                /* MISSING DD CARD       @Y30LB54*/ 00546000
         B     @RC00196                                            0198 00547000
@RF00196 MVC   RETCODE(4),@CF00071                                 0198 00548000
*     END;                          /*                       @Y30LB54*/ 00549000
*   ELSE                                                           0200 00550000
*     RETCODE=0;                    /*                       @Y30LB54*/ 00551000
         B     @RC00193                                            0200 00552000
@RF00193 SLR   @03,@03                                             0200 00553000
         ST    @03,RETCODE                                         0200 00554000
*   IF RETCODE=0 THEN                                              0201 00555000
@RC00193 ICM   @03,15,RETCODE                                      0201 00556000
         BNZ   @RF00201                                            0201 00557000
*     DO;                           /*                       @Y30LB54*/ 00558000
*       CARD=CARD&&CARD;            /* CLEAR CARD AREA FOR SHORT   0203 00559000
*                                      RECORDS               @Y30LB54*/ 00560000
         XC    CARD(80),CARD                                       0203 00561000
*       RFY                                                        0204 00562000
*         R6 RSTD;                  /*                       @Y30LB54*/ 00563000
*       R6=ADDR(CARD);              /* SET ADDR OF CARD      @Y30LB54*/ 00564000
         LA    R6,CARD                                             0205 00565000
*       GEN( GET   SYSINDCB,(R6))                                  0206 00566000
*       FLOWS(EOF,EOD);             /*                       @Y30LB54*/ 00567000
          GET   SYSINDCB,(R6)                                           00568000
*       RFY                                                        0207 00569000
*         R6 UNRSTD;                /*                       @Y30LB54*/ 00570000
*     END;                          /*                       @Y30LB54*/ 00571000
*   ELSE                                                           0209 00572000
*     ;                             /*                       @Y30LB54*/ 00573000
@RF00201 DS    0H                                                  0210 00574000
*   RETURN CODE(RETCODE);           /* RETURN WITH CONDCODE  @Y30LB54*/ 00575000
         L     @15,RETCODE                                         0210 00576000
         L     @14,@SA00003                                        0210 00577000
         LM    @00,@12,@SA00003+8                                  0210 00578000
         BR    @14                                                 0210 00579000
*EOF:                                                              0211 00580000
*   RETCODE=8;                      /* SET END OF FILE RETURN CODE 0211 00581000
*                                                            @Y30LB54*/ 00582000
EOF      MVC   RETCODE(4),@CF00091                                 0211 00583000
*   GEN CODE;                                              /*@Y30LB54*/ 00584000
*                                                         /*@Y30LB54*/  00585000
        CLOSE (SYSINDCB),MF=(E,CLOSLIST)                                00586000
*   RETURN CODE(RETCODE);                                  /*@Y30LB54*/ 00587000
         L     @15,RETCODE                                         0213 00588000
         L     @14,@SA00003                                        0213 00589000
         LM    @00,@12,@SA00003+8                                  0213 00590000
         BR    @14                                                 0213 00591000
*EOD:                                                              0214 00592000
*   RETCODE=12;                     /* SET SYNAD RETURN CODE @Y30LB54*/ 00593000
EOD      MVC   RETCODE(4),@CF00034                                 0214 00594000
*   GEN CODE;                                              /*@YM32173*/ 00595000
*                                                         /*@YM32173*/  00596000
        CLOSE (SYSINDCB),MF=(E,CLOSLIST)                                00597000
*   RETURN CODE(RETCODE);                                  /*@Y30LB54*/ 00598000
         L     @15,RETCODE                                         0216 00599000
         L     @14,@SA00003                                        0216 00600000
         LM    @00,@12,@SA00003+8                                  0216 00601000
         BR    @14                                                 0216 00602000
*   END GETCARD;                    /*                       @Y30LB54*/ 00603000
*                                                                  0218 00604000
*   /*****************************************************************/ 00605000
*   /*                                                               */ 00606000
*   /* SCAN ROUTINE TO FIND KEY CLAUSES                              */ 00607000
*   /*                                                               */ 00608000
*   /*****************************************************************/ 00609000
*                                                                  0218 00610000
*SCAN1:                                                            0218 00611000
*   PROC;                           /*                       @Y30LB54*/ 00612000
SCAN1    STM   @14,@12,12(@13)                                     0218 00613000
*   RETCODE1=0;                     /* INITIALIZE IT FOR THIS TIME 0219 00614000
*                                                            @Y30LB54*/ 00615000
         SLR   @03,@03                                             0219 00616000
         ST    @03,RETCODE1                                        0219 00617000
*   STARTTXT=0;                     /* RESET KEYWORD POINTER @Y30LB54*/ 00618000
         SLR   @03,@03                                             0220 00619000
         ST    @03,STARTTXT                                        0220 00620000
*   ENDTXT=0;                       /* RESET END KEYWORD POINTER   0221 00621000
*                                                            @Y30LB54*/ 00622000
         SLR   @03,@03                                             0221 00623000
         ST    @03,ENDTXT                                          0221 00624000
*   STARTPRM=0;                     /* RESET FUNCTION POINTER@Y30LB54*/ 00625000
         SLR   @03,@03                                             0222 00626000
         ST    @03,STARTPRM                                        0222 00627000
*   ENDPRM=0;                       /* RESET END FUNCTION POINTER  0223 00628000
*                                                            @Y30LB54*/ 00629000
         SLR   @03,@03                                             0223 00630000
         ST    @03,ENDPRM                                          0223 00631000
*   CHAR1=STARTINP;                 /* SET START SCAN PTR    @Y30LB54*/ 00632000
         MVC   CHAR1(4),STARTINP                                   0224 00633000
*   CHARL=ENDINP;                   /* SET END SCAN PTR      @Y30LB54*/ 00634000
         MVC   CHARL(4),ENDINP                                     0225 00635000
*/*                  DON'T WANT TO LOSE ORIGIONAL SO SET THEM IN   0226 00636000
*                                                            @Y30LB54*/ 00637000
*/*                  CHAR1 AND CHARL                         @Y30LB54*/ 00638000
*                                                                  0226 00639000
*   DO CHAR1=CHAR1 TO CHARL BY ONE; /* LOOK FOR NON BLANKS   @Y30LB54*/ 00640000
         L     @03,CHAR1                                           0226 00641000
         B     @DE00226                                            0226 00642000
@DL00226 DS    0H                                                  0227 00643000
*     IF INPUT(CHAR1)=' '|INPUT(CHAR1)=',' THEN                    0227 00644000
         L     @03,INPTR                                           0227 00645000
         AL    @03,CHAR1                                           0227 00646000
         AL    @03,@CF00396                                        0227 00647000
         CLI   INPUT(@03),C' '                                     0227 00648000
         BE    @RT00227                                            0227 00649000
         L     @03,INPTR                                           0227 00650000
         AL    @03,CHAR1                                           0227 00651000
         AL    @03,@CF00396                                        0227 00652000
         CLI   INPUT(@03),C','                                     0227 00653000
         BE    @RT00227                                            0227 00654000
*       ;                           /*                       @Y30LB54*/ 00655000
*     ELSE                          /* HAVE HIT              @Y30LB54*/ 00656000
*       DO;                         /*                       @Y30LB54*/ 00657000
*         STARTTXT=CHAR1;           /* START OF CLAUSE       @Y30LB54*/ 00658000
         MVC   STARTTXT(4),CHAR1                                   0230 00659000
*         DO CHAR1=CHAR1 TO CHARL BY ONE;/* LOOK FOR OPEN PAREN    0231 00660000
*                                                            @Y30LB54*/ 00661000
         L     @03,CHAR1                                           0231 00662000
         B     @DE00231                                            0231 00663000
@DL00231 DS    0H                                                  0232 00664000
*           IF INPUT(CHAR1)^='(' THEN                              0232 00665000
         L     @03,INPTR                                           0232 00666000
         AL    @03,CHAR1                                           0232 00667000
         AL    @03,@CF00396                                        0232 00668000
         CLI   INPUT(@03),C'('                                     0232 00669000
         BNE   @RT00232                                            0232 00670000
*             ;                     /* GO TO NEXT CHAR       @Y30LB54*/ 00671000
*           ELSE                                                   0234 00672000
*             DO;                   /*                       @Y30LB54*/ 00673000
*               STARTPRM=CHAR1;     /* POINT TO FUNCTION START     0235 00674000
*                                                            @Y30LB54*/ 00675000
         MVC   STARTPRM(4),CHAR1                                   0235 00676000
*               DO CHAR1=CHAR1 TO CHARL BY ONE;/* LOOK FOR CLOSE   0236 00677000
*                                      PAREN                 @Y30LB54*/ 00678000
         L     @03,CHAR1                                           0236 00679000
         B     @DE00236                                            0236 00680000
@DL00236 DS    0H                                                  0237 00681000
*                 IF INPUT(CHAR1)^=')' THEN                        0237 00682000
         L     @03,INPTR                                           0237 00683000
         AL    @03,CHAR1                                           0237 00684000
         AL    @03,@CF00396                                        0237 00685000
         CLI   INPUT(@03),C')'                                     0237 00686000
         BNE   @RT00237                                            0237 00687000
*                   ;               /*                       @Y30LB54*/ 00688000
*                 ELSE                                             0239 00689000
*                   DO;             /*                       @Y30LB54*/ 00690000
*                     ENDPRM=CHAR1; /* POINT TO FUNCTION END @Y30LB54*/ 00691000
         MVC   ENDPRM(4),CHAR1                                     0240 00692000
*                     CHAR1=CHAR1+ONE;/* NEXT DIGIT          @Y30LB54*/ 00693000
         LA    @03,1                                               0241 00694000
         AL    @03,CHAR1                                           0241 00695000
         ST    @03,CHAR1                                           0241 00696000
*                     IF INPUT(CHAR1)=SMI|INPUT(CHAR1)=','  THEN   0242 00697000
         L     @03,INPTR                                           0242 00698000
         AL    @03,CHAR1                                           0242 00699000
         AL    @03,@CF00396                                        0242 00700000
         CLI   INPUT(@03),X'5E'                                    0242 00701000
         BE    @RT00242                                            0242 00702000
         L     @03,INPTR                                           0242 00703000
         AL    @03,CHAR1                                           0242 00704000
         AL    @03,@CF00396                                        0242 00705000
         CLI   INPUT(@03),C','                                     0242 00706000
         BNE   @RF00242                                            0242 00707000
@RT00242 DS    0H                                                  0243 00708000
*          /*                                                @Y30LB54*/ 00709000
*                                                                  0243 00710000
*                       /*********************************************/ 00711000
*                       /*                                           */ 00712000
*                       /*                                           */ 00713000
*                       /*********************************************/ 00714000
*                                                                  0243 00715000
*                       STARTINP=CHAR1+ONE;/* SKIP DELIMITER @Y30LB54*/ 00716000
         LA    @03,1                                               0243 00717000
         AL    @03,CHAR1                                           0243 00718000
         ST    @03,STARTINP                                        0243 00719000
*                     ELSE                                         0244 00720000
*                       STARTINP=CHAR1;/* NO DELIMITER DONT SKIP   0244 00721000
*                                                            @Y30LB54*/ 00722000
         B     @RC00242                                            0244 00723000
@RF00242 MVC   STARTINP(4),CHAR1                                   0244 00724000
*                     ENDTXT=STARTINP;/* END OF CLAUSE       @Y30LB54*/ 00725000
@RC00242 MVC   ENDTXT(4),STARTINP                                  0245 00726000
*                     CHAR1=FFEE;   /* TERMINATE ALL SCANS   @Y30LB54*/ 00727000
         MVC   CHAR1(4),FFEE                                       0246 00728000
*                   END;            /*                       @Y30LB54*/ 00729000
*               END;                /*                       @Y30LB54*/ 00730000
@RT00237 LA    @03,1                                               0248 00731000
         AL    @03,CHAR1                                           0248 00732000
         ST    @03,CHAR1                                           0248 00733000
@DE00236 C     @03,CHARL                                           0248 00734000
         BNH   @DL00236                                            0248 00735000
*             END;                  /*                       @Y30LB54*/ 00736000
*         END;                      /*                       @Y30LB54*/ 00737000
@RT00232 LA    @03,1                                               0250 00738000
         AL    @03,CHAR1                                           0250 00739000
         ST    @03,CHAR1                                           0250 00740000
@DE00231 C     @03,CHARL                                           0250 00741000
         BNH   @DL00231                                            0250 00742000
*       END;                        /*                       @Y30LB54*/ 00743000
*     IF CHAR1^>FFEE THEN                                          0252 00744000
@RT00227 CLC   CHAR1(4),FFEE                                       0252 00745000
         BH    @RF00252                                            0252 00746000
*       DO;                         /*                       @Y30LB54*/ 00747000
*         ENDTXT=ENDINP;            /* END OF CLAUSE         @Y30LB54*/ 00748000
         MVC   ENDTXT(4),ENDINP                                    0254 00749000
*         STARTINP=ENDINP;          /*                       @Y30LB54*/ 00750000
         MVC   STARTINP(4),ENDINP                                  0255 00751000
*         ENDTXT=ENDINP;            /* TO SHOW BACK OF BUFFER@Y30LB54*/ 00752000
         MVC   ENDTXT(4),ENDINP                                    0256 00753000
*         STARTPRM=0;               /*                       @Y30LB54*/ 00754000
         SLR   @03,@03                                             0257 00755000
         ST    @03,STARTPRM                                        0257 00756000
*         ENDPRM=0;                 /*                       @Y30LB54*/ 00757000
         SLR   @03,@03                                             0258 00758000
         ST    @03,ENDPRM                                          0258 00759000
*         RETCODE1=8;               /* PASS ERROR INDICATION BACK  0259 00760000
*                                                            @Y30LB54*/ 00761000
         MVC   RETCODE1(4),@CF00091                                0259 00762000
*       END;                        /*                       @Y30LB54*/ 00763000
*     ELSE                                                         0261 00764000
*       RETCODE1=0;                 /* PASS BACK OK INDICATION     0261 00765000
*                                                            @Y30LB54*/ 00766000
         B     @RC00252                                            0261 00767000
@RF00252 SLR   @03,@03                                             0261 00768000
         ST    @03,RETCODE1                                        0261 00769000
*   END;                            /*                       @Y30LB54*/ 00770000
@RC00252 LA    @03,1                                               0262 00771000
         AL    @03,CHAR1                                           0262 00772000
         ST    @03,CHAR1                                           0262 00773000
@DE00226 C     @03,CHARL                                           0262 00774000
         BNH   @DL00226                                            0262 00775000
*   RETURN CODE(RETCODE1);          /*                       @Y30LB54*/ 00776000
         L     @15,RETCODE1                                        0263 00777000
         L     @14,12(,@13)                                        0263 00778000
         LM    @00,@12,20(@13)                                     0263 00779000
         BR    @14                                                 0263 00780000
*   END SCAN1;                      /*                       @Y30LB54*/ 00781000
*                                                                  0265 00782000
*   /*****************************************************************/ 00783000
*   /*                                                               */ 00784000
*   /* JCL INPUT PARAMETER PROCESSOR                                 */ 00785000
*   /*                                                               */ 00786000
*   /*****************************************************************/ 00787000
*                                                                  0265 00788000
*JCLIN:                                                            0265 00789000
*   PROC;                           /*                       @Y30LB54*/ 00790000
JCLIN    STM   @14,@12,12(@13)                                     0265 00791000
*   INPUT=INPUT&&INPUT;             /* CLEAR PROCESSING AREA @Y30LB54*/ 00792000
         L     @03,INPTR                                           0266 00793000
         XC    INPUT(200,@03),INPUT(@03)                           0266 00794000
*/*PARM0PTR IS POINTER TO HALFWORD STARTING WITH JCL PARMS   @Y30LB54*/ 00795000
*                                                                  0267 00796000
*   IF JCLAREA(ONE:TWO)=0 THEN                                     0267 00797000
         L     @03,PARM0PTR(,CVTPTR)                               0267 00798000
         ICM   @15,3,JCLAREA(@03)                                  0267 00799000
         BZ    @RT00267                                            0267 00800000
*     ;                             /*                       @Y30LB54*/ 00801000
*   ELSE                                                           0269 00802000
*     DO;                           /*                       @Y30LB54*/ 00803000
*       CTR=JCLAREA(ONE:TWO);       /* PICK UP HALFWORD OF LENGTH  0270 00804000
*                                                            @Y30LB54*/ 00805000
         L     @05,PARM0PTR(,CVTPTR)                               0270 00806000
         SLR   CTR,CTR                                             0270 00807000
         ICM   CTR,3,JCLAREA(@05)                                  0270 00808000
*       CTR=CTR+2;                  /* ADJUST COUNT TO INCLUDE LENGTH   00809000
*                                      FIELD                 @Y30LB54*/ 00810000
         AH    CTR,@CH00066                                        0271 00811000
*       CTR1=3;                     /* STARTING LOCATION OF SCAN   0272 00812000
*                                                            @Y30LB54*/ 00813000
         LA    CTR1,3                                              0272 00814000
*       INPTR1=ADDR(WORKBUF)+200;   /* RESET END PTR TO BACK OF AREA    00815000
*                                                            @Y30LB54*/ 00816000
         LA    @05,WORKBUF                                         0273 00817000
         AH    @05,@CH00327                                        0273 00818000
         ST    @05,INPTR1                                          0273 00819000
*       STARTINP=FIVE;              /* FIRST LOCATION TO INSERT DATA    00820000
*                                      IN                    @Y30LB54*/ 00821000
         MVC   STARTINP(4),@CF00318                                0274 00822000
*       DO CTR1=CTR1 TO CTR BY 1;   /*                       @Y30LB54*/ 00823000
         B     @DE00275                                            0275 00824000
@DL00275 DS    0H                                                  0276 00825000
*         IF JCLAREA(CTR1)=' '|JCLAREA(CTR1)='=' THEN              0276 00826000
         L     @05,PARM0PTR(,CVTPTR)                               0276 00827000
         LR    @01,@05                                             0276 00828000
         ALR   @01,CTR1                                            0276 00829000
         AL    @01,@CF00396                                        0276 00830000
         CLI   JCLAREA(@01),C' '                                   0276 00831000
         BE    @RT00276                                            0276 00832000
         ALR   @05,CTR1                                            0276 00833000
         AL    @05,@CF00396                                        0276 00834000
         CLI   JCLAREA(@05),C'='                                   0276 00835000
         BE    @RT00276                                            0276 00836000
*           ;                       /*                       @Y30LB54*/ 00837000
*         ELSE                                                     0278 00838000
*           DO;                     /*                       @Y30LB54*/ 00839000
*             INPUT(STARTINP)=JCLAREA(CTR1);/* MOVE ONE BYTE OF DATA    00840000
*                                                            @Y30LB54*/ 00841000
         L     @05,INPTR                                           0279 00842000
         AL    @05,STARTINP                                        0279 00843000
         AL    @05,@CF00396                                        0279 00844000
         L     @01,PARM0PTR(,CVTPTR)                               0279 00845000
         ALR   @01,CTR1                                            0279 00846000
         AL    @01,@CF00396                                        0279 00847000
         MVC   INPUT(1,@05),JCLAREA(@01)                           0279 00848000
*             STARTINP=STARTINP+ONE;/* MOVE TO NEXT INPUT BYTE     0280 00849000
*                                                            @Y30LB54*/ 00850000
         LA    @05,1                                               0280 00851000
         AL    @05,STARTINP                                        0280 00852000
         ST    @05,STARTINP                                        0280 00853000
*             IF STARTINP>200 THEN  /* DONT LET IT EXCEED BUFFER   0281 00854000
*                                                            @Y30LB54*/ 00855000
         L     @05,STARTINP                                        0281 00856000
         CH    @05,@CH00327                                        0281 00857000
         BNH   @RF00281                                            0281 00858000
*               DO;                 /*                       @Y30LB54*/ 00859000
*                 RETCODE=4;        /* OUT OF SPACE          @Y30LB54*/ 00860000
         MVC   RETCODE(4),@CF00071                                 0283 00861000
*                 RETURN CODE(RETCODE);/*                    @Y30LB54*/ 00862000
         L     @15,RETCODE                                         0284 00863000
         L     @14,12(,@13)                                        0284 00864000
         LM    @00,@12,20(@13)                                     0284 00865000
         BR    @14                                                 0284 00866000
*               END;                /*                       @Y30LB54*/ 00867000
*           END;                    /*                       @Y30LB54*/ 00868000
@RF00281 DS    0H                                                  0287 00869000
*       END;                        /*                       @Y30LB54*/ 00870000
@RT00276 AH    CTR1,@CH00068                                       0287 00871000
@DE00275 CR    CTR1,CTR                                            0287 00872000
         BNH   @DL00275                                            0287 00873000
*       INPUT(STARTINP)=SMI;        /* DENOTE END OF INPUT   @Y30LB54*/ 00874000
         L     @03,INPTR                                           0288 00875000
         AL    @03,STARTINP                                        0288 00876000
         AL    @03,@CF00396                                        0288 00877000
         MVI   INPUT(@03),X'5E'                                    0288 00878000
*       INPUT(ONE:FOUR)=STARTINP;   /* TOTAL BYTES IN WORK AREA    0289 00879000
*                                                            @Y30LB54*/ 00880000
         L     @03,INPTR                                           0289 00881000
         MVC   INPUT(4,@03),STARTINP                               0289 00882000
*       INPTR1=ADDR(WORKBUF)+STARTINP-ONE;/* NEW END OF WORK AREA  0290 00883000
*                                                            @Y30LB54*/ 00884000
         LA    @03,WORKBUF                                         0290 00885000
         AL    @03,STARTINP                                        0290 00886000
         BCTR  @03,0                                               0290 00887000
         ST    @03,INPTR1                                          0290 00888000
*       RETURN CODE(RETCODE);       /*                       @Y30LB54*/ 00889000
         L     @15,RETCODE                                         0291 00890000
         L     @14,12(,@13)                                        0291 00891000
         LM    @00,@12,20(@13)                                     0291 00892000
         BR    @14                                                 0291 00893000
*     END;                          /*                       @Y30LB54*/ 00894000
*   END JCLIN;                      /*                       @Y30LB54*/ 00895000
@EL00005 DS    0H                                                  0293 00896000
@EF00005 DS    0H                                                  0293 00897000
@ER00005 LM    @14,@12,12(@13)                                     0293 00898000
         BR    @14                                                 0293 00899000
*                                                                  0294 00900000
*   /*****************************************************************/ 00901000
*   /*                                                               */ 00902000
*   /* PROCESS DATA                                                  */ 00903000
*   /*                                                               */ 00904000
*   /*****************************************************************/ 00905000
*                                                                  0294 00906000
*EMPTYIT:                                                          0294 00907000
*   PROC;                           /*                       @Y30LB54*/ 00908000
*                                                                  0294 00909000
EMPTYIT  STM   @14,@12,@SA00006                                    0294 00910000
*   /*****************************************************************/ 00911000
*   /*                                                               */ 00912000
*   /* NOW READY TO EMPTY COMPRESSED BUFFER                          */ 00913000
*   /*                                                               */ 00914000
*   /*****************************************************************/ 00915000
*                                                                  0295 00916000
*   STARTINP=FIVE;                  /* TELL SCAN1 WHERE TO START   0295 00917000
*                                                            @Y30LB54*/ 00918000
         MVC   STARTINP(4),@CF00318                                0295 00919000
*   ENDINP=INPTR1-INPTR+ONE;        /* TELL SCAN 1 WHERE TO END    0296 00920000
*                                                            @Y30LB54*/ 00921000
         L     @03,INPTR1                                          0296 00922000
         SL    @03,INPTR                                           0296 00923000
         AH    @03,@CH00068                                        0296 00924000
         ST    @03,ENDINP                                          0296 00925000
*   DO WHILE STARTINP<ENDINP;       /* PROCESS ALL KEY CLAUSES     0297 00926000
*                                                            @Y30LB54*/ 00927000
         B     @DE00297                                            0297 00928000
@DL00297 DS    0H                                                  0298 00929000
*     CALL SCAN1;                   /* LOCATE THE KEYWORD CLAUSE   0298 00930000
*                                                            @Y30LB54*/ 00931000
         BAL   @14,SCAN1                                           0298 00932000
*/*STARTINP AND ENDINP ARE INITIAL COUNTER VALUES FOR BUFFER BOUNDRIE   00933000
*                                                                    S  00934000
*                                                            @Y30LB54*/ 00935000
*/*INPTR AND INPTR1 ARE INITIAL ADDRESS VALUES FOR BUFFER BOUNDRIES     00936000
*                                                            @Y30LB54*/ 00937000
*/*OUTPUT OF SCAN 1                                          @Y30LB54*/ 00938000
*/*STARTTXT = FIRST NON BLANK LOCATION                       @Y30LB54*/ 00939000
*/*STARTPRM = OPEN PAREN                                     @Y30LB54*/ 00940000
*/*ENDPRM = CLOSE PAREN                                      @Y30LB54*/ 00941000
*/*ENDTXT = END OF CLAUSE                                    @Y30LB54*/ 00942000
*                                                                  0299 00943000
*     LINE=' ';                     /* BLANK OUT PRINT LINE  @Y30LB54*/ 00944000
         MVI   LINE+1(CVTPTR),C' '                                 0299 00945000
         MVC   LINE+2(130,CVTPTR),LINE+1(CVTPTR)                   0299 00946000
         MVI   LINE(CVTPTR),C' '                                   0299 00947000
*     FULLWD2=ENDTXT-STARTTXT;      /*                       @Y30LB54*/ 00948000
         L     @03,ENDTXT                                          0300 00949000
         SL    @03,STARTTXT                                        0300 00950000
         ST    @03,FULLWD2                                         0300 00951000
*     IF FULLWD2>120 THEN                                          0301 00952000
         LA    @03,120                                             0301 00953000
         C     @03,FULLWD2                                         0301 00954000
         BNL   @RF00301                                            0301 00955000
*       FULLWD2=120;                /* DONT ALLOW TO OVERFLOW PRINT     00956000
*                                      AREA                  @Y30LB54*/ 00957000
         ST    @03,FULLWD2                                         0302 00958000
*     ELSE                                                         0303 00959000
*       ;                           /*                       @Y30LB54*/ 00960000
@RF00301 DS    0H                                                  0304 00961000
*     LINE(1:FULLWD2)=INPUT(STARTTXT:ENDTXT);/* PRINT WHAT WAS FOUND    00962000
*                                                            @Y30LB54*/ 00963000
         L     @03,FULLWD2                                         0304 00964000
         BCTR  @03,0                                               0304 00965000
         L     @01,INPTR                                           0304 00966000
         AL    @01,STARTTXT                                        0304 00967000
         AL    @01,@CF00396                                        0304 00968000
         EX    @03,@SM00510                                        0304 00969000
*     CALL ISDAPRT0(WORKPTR);       /*                       @Y30LB54*/ 00970000
         L     @03,@PC00001                                        0305 00971000
         ST    @03,@AL00001                                        0305 00972000
         L     @15,@CV00037                                        0305 00973000
         LA    @01,@AL00001                                        0305 00974000
         BALR  @14,@15                                             0305 00975000
*     CALL ISDATYPE(WORKPTR);       /* TO TERMINAL OUTPUT    @Y30LB54*/ 00976000
         L     @03,@PC00001                                        0306 00977000
         ST    @03,@AL00001                                        0306 00978000
         L     @15,@CV00038                                        0306 00979000
         LA    @01,@AL00001                                        0306 00980000
         BALR  @14,@15                                             0306 00981000
*     IF RETCODE1^=0 THEN                                          0307 00982000
         ICM   @03,15,RETCODE1                                     0307 00983000
         BZ    @RF00307                                            0307 00984000
*       DO;                         /*                       @Y30LB54*/ 00985000
*         LINE='ISDAPARM DELIMITER ERRORS';/*                @Y30LB54*/ 00986000
         MVI   LINE+25(CVTPTR),C' '                                0309 00987000
         MVC   LINE+26(106,CVTPTR),LINE+25(CVTPTR)                 0309 00988000
         MVC   LINE(25,CVTPTR),@CC00383                            0309 00989000
*         RETCODE=RETCODE1;         /* TELL MOTHER ABOUT IT  @Y30LB54*/ 00990000
         MVC   RETCODE(4),RETCODE1                                 0310 00991000
*         CALL ISDAPRT0(WORKPTR);   /*                       @Y30LB54*/ 00992000
         L     @03,@PC00001                                        0311 00993000
         ST    @03,@AL00001                                        0311 00994000
         L     @15,@CV00037                                        0311 00995000
         LA    @01,@AL00001                                        0311 00996000
         BALR  @14,@15                                             0311 00997000
*         CALL ISDATYPE(WORKPTR);   /* TO TERMINAL OUTPUT    @Y30LB54*/ 00998000
         L     @03,@PC00001                                        0312 00999000
         ST    @03,@AL00001                                        0312 01000000
         L     @15,@CV00038                                        0312 01001000
         LA    @01,@AL00001                                        0312 01002000
         BALR  @14,@15                                             0312 01003000
*       END;                        /*                       @Y30LB54*/ 01004000
*     ELSE                                                         0314 01005000
*       DO;                         /*                       @Y30LB54*/ 01006000
         B     @RC00307                                            0314 01007000
@RF00307 DS    0H                                                  0315 01008000
*         POINTADD=0;               /* ZERO ADDRESS POINTER  @Y30LB54*/ 01009000
         SLR   POINTADD,POINTADD                                   0315 01010000
*         DO CTR=1 TO 14 BY 1;      /*                       @Y30LB54*/ 01011000
         LA    CTR,1                                               0316 01012000
@DL00316 DS    0H                                                  0317 01013000
*           IF INPUT(STARTTXT:STARTTXT+TWO)=KEYARG(CTR) THEN       0317 01014000
*                                                                  0317 01015000
         LR    @05,CTR                                             0317 01016000
         SLA   @05,3                                               0317 01017000
         L     @01,INPTR                                           0317 01018000
         AL    @01,STARTTXT                                        0317 01019000
         AL    @01,@CF00396                                        0317 01020000
         LA    @15,KEYARG-8(@05)                                   0317 01021000
         CLC   INPUT(3,@01),0(@15)                                 0317 01022000
         BNE   @RF00317                                            0317 01023000
*             /*******************************************************/ 01024000
*             /*                                                     */ 01025000
*             /* SEARCH FOR PROPER ROUTINE TO PROCESS KEYWORD        */ 01026000
*             /*                                                     */ 01027000
*             /*******************************************************/ 01028000
*                                                                  0318 01029000
*             DO;                   /*                       @Y30LB54*/ 01030000
*               POINTADD=KEYFUNC(CTR);/* PLUG IN ADDRESS OF EDITING     01031000
*                                      ROUTINE               @Y30LB54*/ 01032000
         L     POINTADD,KEYFUNC-8(@05)                             0319 01033000
*               CTR=99;             /* STOP LOOP HERE        @Y30LB54*/ 01034000
         LA    CTR,99                                              0320 01035000
*             END;                  /*                       @Y30LB54*/ 01036000
*           ELSE                                                   0322 01037000
*             ;                     /*                       @Y30LB54*/ 01038000
@RF00317 DS    0H                                                  0323 01039000
*         END;                      /*                       @Y30LB54*/ 01040000
         AH    CTR,@CH00068                                        0323 01041000
         CH    CTR,@CH00264                                        0323 01042000
         BNH   @DL00316                                            0323 01043000
*         IF POINTADD=0 THEN                                       0324 01044000
         LTR   POINTADD,POINTADD                                   0324 01045000
         BNZ   @RF00324                                            0324 01046000
*           DO;                     /*                       @Y30LB54*/ 01047000
*             LINE='ISDAPARM KEYWORD ERROR';/*               @Y30LB54*/ 01048000
         MVI   LINE+22(CVTPTR),C' '                                0326 01049000
         MVC   LINE+23(109,CVTPTR),LINE+22(CVTPTR)                 0326 01050000
         MVC   LINE(22,CVTPTR),@CC00387                            0326 01051000
*             CALL ISDAPRT0(WORKPTR);/*                      @Y30LB54*/ 01052000
         L     @03,@PC00001                                        0327 01053000
         ST    @03,@AL00001                                        0327 01054000
         L     @15,@CV00037                                        0327 01055000
         LA    @01,@AL00001                                        0327 01056000
         BALR  @14,@15                                             0327 01057000
*             CALL ISDATYPE(WORKPTR);/* TO TERMINAL OUTPUT   @Y30LB54*/ 01058000
         L     @03,@PC00001                                        0328 01059000
         ST    @03,@AL00001                                        0328 01060000
         L     @15,@CV00038                                        0328 01061000
         LA    @01,@AL00001                                        0328 01062000
         BALR  @14,@15                                             0328 01063000
*             RETCODE=8;            /*                       @Y30LB54*/ 01064000
         MVC   RETCODE(4),@CF00091                                 0329 01065000
*           END;                    /*                       @Y30LB54*/ 01066000
*         ELSE                                                     0331 01067000
*           DO;                     /*                       @Y30LB54*/ 01068000
         B     @RC00324                                            0331 01069000
@RF00324 DS    0H                                                  0332 01070000
*             RETCODE1=0;           /* RESET RETURN CODE FOR CALLED     01071000
*                                      ROUTINE               @Y30LB54*/ 01072000
         SLR   @05,@05                                             0332 01073000
         ST    @05,RETCODE1                                        0332 01074000
*             CALL POINTADD;        /* GO TO EDITING ROUTINE @Y30LB54*/ 01075000
         LR    @15,POINTADD                                        0333 01076000
         BALR  @14,@15                                             0333 01077000
*             IF RETCODE1^=0 THEN                                  0334 01078000
         ICM   @03,15,RETCODE1                                     0334 01079000
         BZ    @RF00334                                            0334 01080000
*               RETCODE=RETCODE1;   /* MAKE SURE MOTHER KNOWS ABOUT     01081000
*                                      ERROR                 @Y30LB54*/ 01082000
         MVC   RETCODE(4),RETCODE1                                 0335 01083000
*           END;                    /*                       @Y30LB54*/ 01084000
@RF00334 DS    0H                                                  0337 01085000
*       END;                        /*                       @Y30LB54*/ 01086000
@RC00324 DS    0H                                                  0338 01087000
*   END;                            /*                       @Y30LB54*/ 01088000
@RC00307 DS    0H                                                  0338 01089000
@DE00297 L     @03,STARTINP                                        0338 01090000
         C     @03,ENDINP                                          0338 01091000
         BL    @DL00297                                            0338 01092000
*   END EMPTYIT;                    /*                       @Y30LB54*/ 01093000
@EL00006 DS    0H                                                  0339 01094000
@EF00006 DS    0H                                                  0339 01095000
@ER00006 LM    @14,@12,@SA00006                                    0339 01096000
         BR    @14                                                 0339 01097000
*                                                                  0340 01098000
*   /*****************************************************************/ 01099000
*   /*                                                               */ 01100000
*   /* SEARCH FOR MULTI OPTIONS IN KEYCLAUSE                         */ 01101000
*   /*                                                               */ 01102000
*   /*****************************************************************/ 01103000
*                                                                  0340 01104000
*FNDCOMMA:                                                         0340 01105000
*   PROC;                           /*                       @Y30LB54*/ 01106000
FNDCOMMA STM   @14,@12,12(@13)                                     0340 01107000
*   DO STARTPRM=STARTPRM+ONE TO ENDPRM BY ONE;/* WATCH FOR ()@Y30LB54*/ 01108000
         LA    @03,1                                               0341 01109000
         AL    @03,STARTPRM                                        0341 01110000
         ST    @03,STARTPRM                                        0341 01111000
         B     @DE00341                                            0341 01112000
@DL00341 DS    0H                                                  0342 01113000
*     IF INPUT(STARTPRM)^=',' THEN                                 0342 01114000
         L     @03,INPTR                                           0342 01115000
         AL    @03,STARTPRM                                        0342 01116000
         AL    @03,@CF00396                                        0342 01117000
         CLI   INPUT(@03),C','                                     0342 01118000
         BE    @RF00342                                            0342 01119000
*       ;                           /*                       @Y30LB54*/ 01120000
*     ELSE                                                         0344 01121000
*       RETURN;                     /* INDICATE TO CALLER POSITION OF   01122000
*                                      COMMA                 @Y30LB54*/ 01123000
*/*BY LOCATION OF STARTPRM                                   @Y30LB54*/ 01124000
*                                                                  0345 01125000
*   END;                            /*                       @Y30LB54*/ 01126000
         LA    @03,1                                               0345 01127000
         AL    @03,STARTPRM                                        0345 01128000
         ST    @03,STARTPRM                                        0345 01129000
@DE00341 C     @03,ENDPRM                                          0345 01130000
         BNH   @DL00341                                            0345 01131000
*   STARTPRM=0;                     /* INDICATE TO CALLER NO SECOND     01132000
*                                      OPTION                @Y30LB54*/ 01133000
         SLR   @03,@03                                             0346 01134000
         ST    @03,STARTPRM                                        0346 01135000
*   END FNDCOMMA;                   /*                       @Y30LB54*/ 01136000
@EL00007 DS    0H                                                  0347 01137000
@EF00007 DS    0H                                                  0347 01138000
@ER00007 LM    @14,@12,12(@13)                                     0347 01139000
         BR    @14                                                 0347 01140000
*                                                                  0348 01141000
*   /*****************************************************************/ 01142000
*   /*                                                               */ 01143000
*   /* CONVERT EBDIC TO HEX USE LINE AS OUTPUT AREA                  */ 01144000
*   /*                                                               */ 01145000
*   /*****************************************************************/ 01146000
*                                                                  0348 01147000
*/*CALL-SET STARTPRN TO FIRSTDIGIT AND CTR1 TO NUMBER OF BYTES     0348 01148000
*                                                            @Y30LB54*/ 01149000
*                                                                  0348 01150000
*EBDICHEX:                                                         0348 01151000
*   PROC;                           /*                       @Y30LB54*/ 01152000
EBDICHEX STM   @14,@12,12(@13)                                     0348 01153000
*   FULLWD2=1;                      /* OUTPUT POSITION TO ZERO     0349 01154000
*                                                            @Y30LB54*/ 01155000
         MVC   FULLWD2(4),@CF00068                                 0349 01156000
*   DO CTR1=CTR1-ONE TO 0 BY-ONE;   /*                       @Y30LB54*/ 01157000
         LR    @05,CTR1                                            0350 01158000
         BCTR  @05,0                                               0350 01159000
         LR    CTR1,@05                                            0350 01160000
         B     @DE00350                                            0350 01161000
@DL00350 DS    0H                                                  0351 01162000
*     DO CTR=1 TO 16 BY 1;          /* 16 HEX COMBINATIONS   @Y30LB54*/ 01163000
         LA    CTR,1                                               0351 01164000
@DL00351 DS    0H                                                  0352 01165000
*       IF EBDIC(CTR)=INPUT(STARTPRM) THEN/* WE HAVE A MATCH @Y30LB54*/ 01166000
         LR    @05,CTR                                             0352 01167000
         SLA   @05,2                                               0352 01168000
         LA    @01,EBDIC-4(@05)                                    0352 01169000
         L     @15,INPTR                                           0352 01170000
         AL    @15,STARTPRM                                        0352 01171000
         AL    @15,@CF00396                                        0352 01172000
         CLC   0(1,@01),INPUT(@15)                                 0352 01173000
         BNE   @RF00352                                            0352 01174000
*         DO;                       /*                       @Y30LB54*/ 01175000
*           LINE(FULLWD2:FULLWD2)=HEXTOP(CTR);/* MOVE IN TOP HALF  0354 01176000
*                                                            @Y30LB54*/ 01177000
         LR    @01,CVTPTR                                          0354 01178000
         AL    @01,FULLWD2                                         0354 01179000
         LA    @15,HEXTOP-4(@05)                                   0354 01180000
         MVC   LINE-1(1,@01),0(@15)                                0354 01181000
*           CTR=100;                /* QUIT THIS LOOP        @Y30LB54*/ 01182000
         LA    CTR,100                                             0355 01183000
*         END;                      /*                       @Y30LB54*/ 01184000
*       ELSE                                                       0357 01185000
*         ;                         /*                       @Y30LB54*/ 01186000
@RF00352 DS    0H                                                  0358 01187000
*     END;                          /*                       @Y30LB54*/ 01188000
         AH    CTR,@CH00068                                        0358 01189000
         CH    CTR,@CH00214                                        0358 01190000
         BNH   @DL00351                                            0358 01191000
*     STARTPRM=STARTPRM+ONE;        /* USED UP ONE BYTE OF INPUT   0359 01192000
*                                                            @Y30LB54*/ 01193000
         LA    @05,1                                               0359 01194000
         AL    @05,STARTPRM                                        0359 01195000
         ST    @05,STARTPRM                                        0359 01196000
*     IF CTR^>99 THEN                                              0360 01197000
         CH    CTR,@CH00386                                        0360 01198000
         BH    @RF00360                                            0360 01199000
*       DO;                         /*                       @Y30LB54*/ 01200000
*         CTR1=-1;                  /* TERMINATE SCAN        @Y30LB54*/ 01201000
         SLR   CTR1,CTR1                                           0362 01202000
         BCTR  CTR1,0                                              0362 01203000
*         RETCODE1=8;               /*                       @Y30LB54*/ 01204000
         MVC   RETCODE1(4),@CF00091                                0363 01205000
*       END;                        /*                       @Y30LB54*/ 01206000
*     ELSE                                                         0365 01207000
*       DO;                         /*                       @Y30LB54*/ 01208000
         B     @RC00360                                            0365 01209000
@RF00360 DS    0H                                                  0366 01210000
*         DO CTR=1 TO 16 BY 1;      /*                       @Y30LB54*/ 01211000
         LA    CTR,1                                               0366 01212000
@DL00366 DS    0H                                                  0367 01213000
*           IF EBDIC(CTR)=INPUT(STARTPRM) THEN                     0367 01214000
         LR    @05,CTR                                             0367 01215000
         SLA   @05,2                                               0367 01216000
         LA    @01,EBDIC-4(@05)                                    0367 01217000
         L     @15,INPTR                                           0367 01218000
         AL    @15,STARTPRM                                        0367 01219000
         AL    @15,@CF00396                                        0367 01220000
         CLC   0(1,@01),INPUT(@15)                                 0367 01221000
         BNE   @RF00367                                            0367 01222000
*             DO;                   /*                       @Y30LB54*/ 01223000
*               LINE(FULLWD2:FULLWD2)=HEXBOT(CTR)|LINE(FULLWD2:FULLWD2) 01224000
*                   ;               /*                       @Y30LB54*/ 01225000
         LR    @01,CVTPTR                                          0369 01226000
         AL    @01,FULLWD2                                         0369 01227000
         LA    @15,HEXBOT-4(@05)                                   0369 01228000
         OC    LINE-1(1,@01),0(@15)                                0369 01229000
*               CTR=100;            /*                       @Y30LB54*/ 01230000
         LA    CTR,100                                             0370 01231000
*             END;                  /*                       @Y30LB54*/ 01232000
*           ELSE                                                   0372 01233000
*             ;                     /*                       @Y30LB54*/ 01234000
@RF00367 DS    0H                                                  0373 01235000
*         END;                      /*                       @Y30LB54*/ 01236000
         AH    CTR,@CH00068                                        0373 01237000
         CH    CTR,@CH00214                                        0373 01238000
         BNH   @DL00366                                            0373 01239000
*         STARTPRM=STARTPRM+ONE;    /* USED UP ANOTHER BYTE  @Y30LB54*/ 01240000
         LA    @05,1                                               0374 01241000
         AL    @05,STARTPRM                                        0374 01242000
         ST    @05,STARTPRM                                        0374 01243000
*         IF CTR^>99 THEN                                          0375 01244000
         CH    CTR,@CH00386                                        0375 01245000
         BH    @RF00375                                            0375 01246000
*           DO;                     /*                       @Y30LB54*/ 01247000
*             RETCODE1=8;           /*                       @Y30LB54*/ 01248000
         MVC   RETCODE1(4),@CF00091                                0377 01249000
*             CTR1=-1;              /* TERMINATE SCAN        @Y30LB54*/ 01250000
         SLR   CTR1,CTR1                                           0378 01251000
         BCTR  CTR1,0                                              0378 01252000
*           END;                    /*                       @Y30LB54*/ 01253000
*         ELSE                                                     0380 01254000
*           ;                       /*                       @Y30LB54*/ 01255000
@RF00375 DS    0H                                                  0381 01256000
*       END;                        /*                       @Y30LB54*/ 01257000
*     FULLWD2=FULLWD2+ONE;          /* MOVE TO NEXT POSITION OUTPUT     01258000
*                                                            @Y30LB54*/ 01259000
@RC00360 LA    @05,1                                               0382 01260000
         AL    @05,FULLWD2                                         0382 01261000
         ST    @05,FULLWD2                                         0382 01262000
*     CTR1=CTR1-ONE;                /* USED UP TWO BYTES OF DATA   0383 01263000
*                                                            @Y30LB54*/ 01264000
         BCTR  CTR1,0                                              0383 01265000
*   END;                            /*                       @Y30LB54*/ 01266000
         BCTR  CTR1,0                                              0384 01267000
@DE00350 LTR   CTR1,CTR1                                           0384 01268000
         BNM   @DL00350                                            0384 01269000
*   END EBDICHEX;                   /*                       @Y30LB54*/ 01270000
@EL00008 DS    0H                                                  0385 01271000
@EF00008 DS    0H                                                  0385 01272000
@ER00008 LM    @14,@12,12(@13)                                     0385 01273000
         BR    @14                                                 0385 01274000
*                                                                  0386 01275000
*   /*****************************************************************/ 01276000
*   /*                                                               */ 01277000
*   /* INPUT(HISTORY,LOGREC) EDITOR                                  */ 01278000
*   /*                                                               */ 01279000
*   /*****************************************************************/ 01280000
*                                                                  0386 01281000
*INPCLAUS:                                                         0386 01282000
*   PROC;                           /*                       @Y30LB54*/ 01283000
INPCLAUS STM   @14,@12,@SA00009                                    0386 01284000
*   CHISTIN='N';                    /* TURN OFF ALL DEFAULTS @Y30LB54*/ 01285000
         L     @03,LPARMPTR                                        0387 01286000
         MVI   CHISTIN(@03),C'N'                                   0387 01287000
*   CLOGIN='N';                     /* TURN OFF ALL DEFAULTS @Y30LB54*/ 01288000
         L     @03,LPARMPTR                                        0388 01289000
         MVI   CLOGIN(@03),C'N'                                    0388 01290000
*   IF INPUT(STARTPRM+ONE)='H' THEN                                0389 01291000
         L     @03,INPTR                                           0389 01292000
         AL    @03,STARTPRM                                        0389 01293000
         CLI   INPUT(@03),C'H'                                     0389 01294000
         BNE   @RF00389                                            0389 01295000
*     DO;                           /* 'H' REPRESENTS HISTORY INPUT     01296000
*                                                            @Y30LB54*/ 01297000
*       CHISTIN='Y';                /* TURN ON HISTORY FLAG  @Y30LB54*/ 01298000
         L     @03,LPARMPTR                                        0391 01299000
         MVI   CHISTIN(@03),C'Y'                                   0391 01300000
*       CALL FNDCOMMA;              /* SEARCH FOR COMMA      @Y30LB54*/ 01301000
         BAL   @14,FNDCOMMA                                        0392 01302000
*       IF STARTPRM^=0 THEN                                        0393 01303000
         ICM   @03,15,STARTPRM                                     0393 01304000
         BZ    @RF00393                                            0393 01305000
*         IF INPUT(STARTPRM+ONE)='L' THEN                          0394 01306000
         L     @03,INPTR                                           0394 01307000
         AL    @03,STARTPRM                                        0394 01308000
         CLI   INPUT(@03),C'L'                                     0394 01309000
         BNE   @RF00394                                            0394 01310000
*           CLOGIN='Y';             /* TURN ON LOGIN FLAG    @Y30LB54*/ 01311000
         L     @03,LPARMPTR                                        0395 01312000
         MVI   CLOGIN(@03),C'Y'                                    0395 01313000
*         ELSE                                                     0396 01314000
*           RETCODE1=8;             /* INVALID INPUT         @Y30LB54*/ 01315000
         B     @RC00394                                            0396 01316000
@RF00394 MVC   RETCODE1(4),@CF00091                                0396 01317000
*       ELSE                                                       0397 01318000
*         ;                         /*                       @Y30LB54*/ 01319000
@RF00393 DS    0H                                                  0398 01320000
*     END;                          /*                       @Y30LB54*/ 01321000
*   ELSE                                                           0399 01322000
*     DO;                           /*                       @Y30LB54*/ 01323000
         B     @RC00389                                            0399 01324000
@RF00389 DS    0H                                                  0400 01325000
*       IF INPUT(STARTPRM+ONE)='L' THEN                            0400 01326000
         L     @03,INPTR                                           0400 01327000
         AL    @03,STARTPRM                                        0400 01328000
         CLI   INPUT(@03),C'L'                                     0400 01329000
         BNE   @RF00400                                            0400 01330000
*         DO;                       /*                       @Y30LB54*/ 01331000
*           CLOGIN='Y';             /* TURN ON LOGIN FLAG    @Y30LB54*/ 01332000
         L     @03,LPARMPTR                                        0402 01333000
         MVI   CLOGIN(@03),C'Y'                                    0402 01334000
*           CALL FNDCOMMA;          /* SEARCH OUT COMMA      @Y30LB54*/ 01335000
         BAL   @14,FNDCOMMA                                        0403 01336000
*           IF STARTPRM^=0 THEN                                    0404 01337000
         ICM   @03,15,STARTPRM                                     0404 01338000
         BZ    @RF00404                                            0404 01339000
*             IF INPUT(STARTPRM+ONE)='H' THEN                      0405 01340000
         L     @03,INPTR                                           0405 01341000
         AL    @03,STARTPRM                                        0405 01342000
         CLI   INPUT(@03),C'H'                                     0405 01343000
         BNE   @RF00405                                            0405 01344000
*               CHISTIN='Y';        /* TURN ON HISTORY INPUT FLAG  0406 01345000
*                                                            @Y30LB54*/ 01346000
         L     @03,LPARMPTR                                        0406 01347000
         MVI   CHISTIN(@03),C'Y'                                   0406 01348000
*             ELSE                                                 0407 01349000
*               RETCODE1=8;         /* INVALID INPUT         @Y30LB54*/ 01350000
         B     @RC00405                                            0407 01351000
@RF00405 MVC   RETCODE1(4),@CF00091                                0407 01352000
*           ELSE                                                   0408 01353000
*             ;                     /*                       @Y30LB54*/ 01354000
@RF00404 DS    0H                                                  0409 01355000
*         END;                      /*                       @Y30LB54*/ 01356000
*       ELSE                                                       0410 01357000
*         RETCODE1=8;               /* INVALID INPUT         @Y30LB54*/ 01358000
         B     @RC00400                                            0410 01359000
@RF00400 MVC   RETCODE1(4),@CF00091                                0410 01360000
*     END;                          /*                       @Y30LB54*/ 01361000
@RC00400 DS    0H                                                  0412 01362000
*   IF RETCODE1=8 THEN                                             0412 01363000
@RC00389 CLC   RETCODE1(4),@CF00091                                0412 01364000
         BNE   @RF00412                                            0412 01365000
*     DO;                           /*                       @Y30LB54*/ 01366000
*       CINPUT=DFINPUT;             /* REVERT BACK TO DEFAULTS     0414 01367000
*                                                            @Y30LB54*/ 01368000
         L     @03,LPARMPTR                                        0414 01369000
         MVC   CINPUT(2,@03),DFINPUT                               0414 01370000
*       RETCODE1=0;                 /* ALLOW CONTROL TO CONTINUE   0415 01371000
*                                                            @Y30LB54*/ 01372000
         SLR   @03,@03                                             0415 01373000
         ST    @03,RETCODE1                                        0415 01374000
*       LINE='ISDAPARM INPUT(HISTORY,LOGREC) ERROR';/*       @Y30LB54*/ 01375000
         MVI   LINE+36(CVTPTR),C' '                                0416 01376000
         MVC   LINE+37(95,CVTPTR),LINE+36(CVTPTR)                  0416 01377000
         MVC   LINE(36,CVTPTR),@CC00402                            0416 01378000
*       CALL ISDAPRT0(WORKPTR);     /*                       @Y30LB54*/ 01379000
         L     @03,@PC00001                                        0417 01380000
         ST    @03,@AL00001                                        0417 01381000
         L     @15,@CV00037                                        0417 01382000
         LA    @01,@AL00001                                        0417 01383000
         BALR  @14,@15                                             0417 01384000
*       CALL ISDATYPE(WORKPTR);     /* TO TERMINAL OUTPUT    @Y30LB54*/ 01385000
         L     @03,@PC00001                                        0418 01386000
         ST    @03,@AL00001                                        0418 01387000
         L     @15,@CV00038                                        0418 01388000
         LA    @01,@AL00001                                        0418 01389000
         BALR  @14,@15                                             0418 01390000
*     END;                          /*                       @Y30LB54*/ 01391000
*   ELSE                                                           0420 01392000
*     ;                             /*                       @Y30LB54*/ 01393000
@RF00412 DS    0H                                                  0421 01394000
*   RETURN CODE(RETCODE1);          /*                       @Y30LB54*/ 01395000
         L     @15,RETCODE1                                        0421 01396000
         L     @14,@SA00009                                        0421 01397000
         LM    @00,@12,@SA00009+8                                  0421 01398000
         BR    @14                                                 0421 01399000
*   END INPCLAUS;                   /*                       @Y30LB54*/ 01400000
*                                                                  0423 01401000
*   /*****************************************************************/ 01402000
*   /*                                                               */ 01403000
*   /* STARTDATE(YYDDD) EDITOR FATAL IF INCORRECT                    */ 01404000
*   /*                                                               */ 01405000
*   /*****************************************************************/ 01406000
*                                                                  0423 01407000
*STACLAUS:                                                         0423 01408000
*   PROC;                           /*                       @Y30LB54*/ 01409000
STACLAUS STM   @14,@12,@SA00010                                    0423 01410000
*   FULLWD2=ENDPRM-STARTPRM+ONE;    /* HOW MANY INPUT DIGITS @Y30LB54*/ 01411000
         L     @03,ENDPRM                                          0424 01412000
         SL    @03,STARTPRM                                        0424 01413000
         AH    @03,@CH00068                                        0424 01414000
         ST    @03,FULLWD2                                         0424 01415000
*   IF FULLWD2^=7 THEN              /* (YYDDD)               @Y30LB54*/ 01416000
         CLC   FULLWD2(4),@CF00408                                 0425 01417000
         BE    @RF00425                                            0425 01418000
*     RETCODE1=8;                   /*                       @Y30LB54*/ 01419000
         MVC   RETCODE1(4),@CF00091                                0426 01420000
*   ELSE                                                           0427 01421000
*     DO;                           /*                       @Y30LB54*/ 01422000
         B     @RC00425                                            0427 01423000
@RF00425 DS    0H                                                  0428 01424000
*       DO CTR=1 TO 5 BY 1;         /*                       @Y30LB54*/ 01425000
         LA    CTR,1                                               0428 01426000
@DL00428 DS    0H                                                  0429 01427000
*         IF INPUT(STARTPRM+CTR)<'0' THEN                          0429 01428000
         LR    @15,CTR                                             0429 01429000
         AL    @15,STARTPRM                                        0429 01430000
         L     @01,INPTR                                           0429 01431000
         ALR   @01,@15                                             0429 01432000
         AL    @01,@CF00396                                        0429 01433000
         CLI   INPUT(@01),C'0'                                     0429 01434000
         BNL   @RF00429                                            0429 01435000
*           RETCODE1=8;             /*                       @Y30LB54*/ 01436000
         MVC   RETCODE1(4),@CF00091                                0430 01437000
*         ELSE                                                     0431 01438000
*           IF INPUT(STARTPRM+CTR)>'9' THEN                        0431 01439000
         B     @RC00429                                            0431 01440000
@RF00429 LR    @15,CTR                                             0431 01441000
         AL    @15,STARTPRM                                        0431 01442000
         L     @01,INPTR                                           0431 01443000
         ALR   @01,@15                                             0431 01444000
         AL    @01,@CF00396                                        0431 01445000
         CLI   INPUT(@01),C'9'                                     0431 01446000
         BNH   @RF00431                                            0431 01447000
*             RETCODE1=8;           /*                       @Y30LB54*/ 01448000
         MVC   RETCODE1(4),@CF00091                                0432 01449000
*       END;                        /*                       @Y30LB54*/ 01450000
@RF00431 DS    0H                                                  0433 01451000
@RC00429 AH    CTR,@CH00068                                        0433 01452000
         CH    CTR,@CH00318                                        0433 01453000
         BNH   @DL00428                                            0433 01454000
*       EBDIC5=INPUT(STARTPRM+ONE:STARTPRM+FIVE);/* (YYDDD)  @Y30LB54*/ 01455000
         L     @03,INPTR                                           0434 01456000
         AL    @03,STARTPRM                                        0434 01457000
         MVC   EBDIC5(5),INPUT(@03)                                0434 01458000
*       PACK(CSTART,EBDIC5);        /*                       @Y30LB54*/ 01459000
         L     @03,LPARMPTR                                        0435 01460000
         PACK  CSTART(4,@03),EBDIC5(5)                             0435 01461000
*     END;                          /*                       @Y30LB54*/ 01462000
*   IF RETCODE1=8 THEN                                             0437 01463000
@RC00425 CLC   RETCODE1(4),@CF00091                                0437 01464000
         BNE   @RF00437                                            0437 01465000
*     DO;                           /*                       @Y30LB54*/ 01466000
*       LINE='ISDAPARM STARTDATE(YYDDD) ERROR';/*            @Y30LB54*/ 01467000
         MVI   LINE+31(CVTPTR),C' '                                0439 01468000
         MVC   LINE+32(100,CVTPTR),LINE+31(CVTPTR)                 0439 01469000
         MVC   LINE(31,CVTPTR),@CC00410                            0439 01470000
*       CALL ISDAPRT0(WORKPTR);     /*                       @Y30LB54*/ 01471000
         L     @03,@PC00001                                        0440 01472000
         ST    @03,@AL00001                                        0440 01473000
         L     @15,@CV00037                                        0440 01474000
         LA    @01,@AL00001                                        0440 01475000
         BALR  @14,@15                                             0440 01476000
*       CALL ISDATYPE(WORKPTR);     /* TO TERMINAL OUTPUT    @Y30LB54*/ 01477000
         L     @03,@PC00001                                        0441 01478000
         ST    @03,@AL00001                                        0441 01479000
         L     @15,@CV00038                                        0441 01480000
         LA    @01,@AL00001                                        0441 01481000
         BALR  @14,@15                                             0441 01482000
*     END;                          /*                       @Y30LB54*/ 01483000
*   ELSE                                                           0443 01484000
*     ;                             /*                       @Y30LB54*/ 01485000
@RF00437 DS    0H                                                  0444 01486000
*   END STACLAUS;                   /*                       @Y30LB54*/ 01487000
@EL00010 DS    0H                                                  0444 01488000
@EF00010 DS    0H                                                  0444 01489000
@ER00010 LM    @14,@12,@SA00010                                    0444 01490000
         BR    @14                                                 0444 01491000
*                                                                  0445 01492000
*   /*****************************************************************/ 01493000
*   /*                                                               */ 01494000
*   /* ENDDATE(YYDDD) EDITOR FATAL IF INCORRECT                      */ 01495000
*   /*                                                               */ 01496000
*   /*****************************************************************/ 01497000
*                                                                  0445 01498000
*ENDCLAUS:                                                         0445 01499000
*   PROC;                           /*                       @Y30LB54*/ 01500000
ENDCLAUS STM   @14,@12,@SA00011                                    0445 01501000
*   FULLWD2=ENDPRM-STARTPRM+ONE;    /* HOW MANY DIGITS       @Y30LB54*/ 01502000
         L     @03,ENDPRM                                          0446 01503000
         SL    @03,STARTPRM                                        0446 01504000
         AH    @03,@CH00068                                        0446 01505000
         ST    @03,FULLWD2                                         0446 01506000
*   IF FULLWD2^=7 THEN              /* (YYDDD)               @Y30LB54*/ 01507000
         CLC   FULLWD2(4),@CF00408                                 0447 01508000
         BE    @RF00447                                            0447 01509000
*     RETCODE1=8;                   /*                       @Y30LB54*/ 01510000
         MVC   RETCODE1(4),@CF00091                                0448 01511000
*   ELSE                                                           0449 01512000
*     DO;                           /*                       @Y30LB54*/ 01513000
         B     @RC00447                                            0449 01514000
@RF00447 DS    0H                                                  0450 01515000
*       DO CTR=1 TO 5 BY 1;         /*                       @Y30LB54*/ 01516000
         LA    CTR,1                                               0450 01517000
@DL00450 DS    0H                                                  0451 01518000
*         IF INPUT(STARTPRM+CTR)<'0' THEN                          0451 01519000
         LR    @15,CTR                                             0451 01520000
         AL    @15,STARTPRM                                        0451 01521000
         L     @01,INPTR                                           0451 01522000
         ALR   @01,@15                                             0451 01523000
         AL    @01,@CF00396                                        0451 01524000
         CLI   INPUT(@01),C'0'                                     0451 01525000
         BNL   @RF00451                                            0451 01526000
*           RETCODE1=8;             /*                       @Y30LB54*/ 01527000
         MVC   RETCODE1(4),@CF00091                                0452 01528000
*         ELSE                                                     0453 01529000
*           IF INPUT(STARTPRM+CTR)>'9' THEN                        0453 01530000
         B     @RC00451                                            0453 01531000
@RF00451 LR    @15,CTR                                             0453 01532000
         AL    @15,STARTPRM                                        0453 01533000
         L     @01,INPTR                                           0453 01534000
         ALR   @01,@15                                             0453 01535000
         AL    @01,@CF00396                                        0453 01536000
         CLI   INPUT(@01),C'9'                                     0453 01537000
         BNH   @RF00453                                            0453 01538000
*             RETCODE1=8;           /*                       @Y30LB54*/ 01539000
         MVC   RETCODE1(4),@CF00091                                0454 01540000
*       END;                        /*                       @Y30LB54*/ 01541000
@RF00453 DS    0H                                                  0455 01542000
@RC00451 AH    CTR,@CH00068                                        0455 01543000
         CH    CTR,@CH00318                                        0455 01544000
         BNH   @DL00450                                            0455 01545000
*       EBDIC5=INPUT(STARTPRM+ONE:STARTPRM+FIVE);/*          @Y30LB54*/ 01546000
         L     @03,INPTR                                           0456 01547000
         AL    @03,STARTPRM                                        0456 01548000
         MVC   EBDIC5(5),INPUT(@03)                                0456 01549000
*       PACK(CEND,EBDIC5);          /*                       @Y30LB54*/ 01550000
         L     @03,LPARMPTR                                        0457 01551000
         PACK  CEND(4,@03),EBDIC5(5)                               0457 01552000
*     END;                          /*                       @Y30LB54*/ 01553000
*   IF RETCODE1=8 THEN                                             0459 01554000
@RC00447 CLC   RETCODE1(4),@CF00091                                0459 01555000
         BNE   @RF00459                                            0459 01556000
*     DO;                           /*                       @Y30LB54*/ 01557000
*       LINE='ISDAPARM ENDDATE(YYDDD) ERROR';/*              @Y30LB54*/ 01558000
         MVI   LINE+29(CVTPTR),C' '                                0461 01559000
         MVC   LINE+30(102,CVTPTR),LINE+29(CVTPTR)                 0461 01560000
         MVC   LINE(29,CVTPTR),@CC00416                            0461 01561000
*       CALL ISDAPRT0(WORKPTR);     /*                       @Y30LB54*/ 01562000
         L     @03,@PC00001                                        0462 01563000
         ST    @03,@AL00001                                        0462 01564000
         L     @15,@CV00037                                        0462 01565000
         LA    @01,@AL00001                                        0462 01566000
         BALR  @14,@15                                             0462 01567000
*       CALL ISDATYPE(WORKPTR);     /* TO TERMINAL OUTPUT    @Y30LB54*/ 01568000
         L     @03,@PC00001                                        0463 01569000
         ST    @03,@AL00001                                        0463 01570000
         L     @15,@CV00038                                        0463 01571000
         LA    @01,@AL00001                                        0463 01572000
         BALR  @14,@15                                             0463 01573000
*     END;                          /*                       @Y30LB54*/ 01574000
*   ELSE                                                           0465 01575000
*     ;                             /*                       @Y30LB54*/ 01576000
@RF00459 DS    0H                                                  0466 01577000
*   END ENDCLAUS;                   /*                       @Y30LB54*/ 01578000
@EL00011 DS    0H                                                  0466 01579000
@EF00011 DS    0H                                                  0466 01580000
@ER00011 LM    @14,@12,@SA00011                                    0466 01581000
         BR    @14                                                 0466 01582000
*                                                                  0467 01583000
*   /*****************************************************************/ 01584000
*   /*                                                               */ 01585000
*   /* SUMMARY(YES|NO)                                               */ 01586000
*   /*                                                               */ 01587000
*   /*****************************************************************/ 01588000
*                                                                  0467 01589000
*SUMCLAUS:                                                         0467 01590000
*   PROC;                           /*                       @Y30LB54*/ 01591000
SUMCLAUS STM   @14,@12,@SA00012                                    0467 01592000
*   IF INPUT(STARTPRM+ONE)='Y'|INPUT(STARTPRM+ONE)='N' THEN        0468 01593000
         L     @03,INPTR                                           0468 01594000
         AL    @03,STARTPRM                                        0468 01595000
         CLI   INPUT(@03),C'Y'                                     0468 01596000
         BE    @RT00468                                            0468 01597000
         L     @03,INPTR                                           0468 01598000
         AL    @03,STARTPRM                                        0468 01599000
         CLI   INPUT(@03),C'N'                                     0468 01600000
         BNE   @RF00468                                            0468 01601000
@RT00468 DS    0H                                                  0469 01602000
*     DO;                           /*                       @Y30LB54*/ 01603000
*       CSUMMARY=INPUT(STARTPRM+ONE);/* MOVE VALID DATA TO PARMS   0470 01604000
*                                                            @Y30LB54*/ 01605000
         L     @03,LPARMPTR                                        0470 01606000
         L     @01,INPTR                                           0470 01607000
         AL    @01,STARTPRM                                        0470 01608000
         MVC   CSUMMARY(1,@03),INPUT(@01)                          0470 01609000
*       RETURN;                     /*                       @Y30LB54*/ 01610000
@EL00012 DS    0H                                                  0471 01611000
@EF00012 DS    0H                                                  0471 01612000
@ER00012 LM    @14,@12,@SA00012                                    0471 01613000
         BR    @14                                                 0471 01614000
*     END;                          /*                       @Y30LB54*/ 01615000
*   ELSE                                                           0473 01616000
*     DO;                           /*                       @Y30LB54*/ 01617000
@RF00468 DS    0H                                                  0474 01618000
*       CSUMMARY=DFSUMMAR;          /* TAKE DEFAULTS         @Y30LB54*/ 01619000
         L     @03,LPARMPTR                                        0474 01620000
         MVC   CSUMMARY(1,@03),DFSUMMAR                            0474 01621000
*       LINE='ISDAPARM SUMMARY(YES|NO) ERROR';/*             @Y30LB54*/ 01622000
         MVI   LINE+30(CVTPTR),C' '                                0475 01623000
         MVC   LINE+31(101,CVTPTR),LINE+30(CVTPTR)                 0475 01624000
         MVC   LINE(30,CVTPTR),@CC00422                            0475 01625000
*       CALL ISDAPRT0(WORKPTR);     /*                       @Y30LB54*/ 01626000
         L     @03,@PC00001                                        0476 01627000
         ST    @03,@AL00001                                        0476 01628000
         L     @15,@CV00037                                        0476 01629000
         LA    @01,@AL00001                                        0476 01630000
         BALR  @14,@15                                             0476 01631000
*       CALL ISDATYPE(WORKPTR);     /* TO TERMINAL OUTPUT    @Y30LB54*/ 01632000
         L     @03,@PC00001                                        0477 01633000
         ST    @03,@AL00001                                        0477 01634000
         L     @15,@CV00038                                        0477 01635000
         LA    @01,@AL00001                                        0477 01636000
         BALR  @14,@15                                             0477 01637000
*     END;                          /*                       @Y30LB54*/ 01638000
*   END SUMCLAUS;                   /*                       @Y30LB54*/ 01639000
         B     @EL00012                                            0479 01640000
*                                                                  0480 01641000
*/*DEVTYPE(SA|RC|RD|CS|DA)                                   @Y30LB54*/ 01642000
*                                                                  0480 01643000
*DEVCLAUS:                                                         0480 01644000
*   PROC;                           /*                       @Y30LB54*/ 01645000
DEVCLAUS STM   @14,@12,@SA00013                                    0480 01646000
*   STARTPRM=STARTPRM+ONE;          /* POINT TO FIRST DIGIT  @Y30LB54*/ 01647000
         LA    @03,1                                               0481 01648000
         AL    @03,STARTPRM                                        0481 01649000
         ST    @03,STARTPRM                                        0481 01650000
*   DO CTR1=1 TO 5 BY 1;            /* SEARCH FOR VALID ID   @Y30LB54*/ 01651000
         LA    CTR1,1                                              0482 01652000
@DL00482 DS    0H                                                  0483 01653000
*     IF INPUT(STARTPRM:STARTPRM+ONE)=DEVARG(CTR1) THEN            0483 01654000
         LR    @05,CTR1                                            0483 01655000
         ALR   @05,@05                                             0483 01656000
         L     @03,INPTR                                           0483 01657000
         AL    @03,STARTPRM                                        0483 01658000
         AL    @03,@CF00396                                        0483 01659000
         LA    @01,DEVARG-2(@05)                                   0483 01660000
         CLC   INPUT(2,@03),0(@01)                                 0483 01661000
         BNE   @RF00483                                            0483 01662000
*       DO;                         /*                       @Y30LB54*/ 01663000
*         CTYPE(ONE:TWO)=INPUT(STARTPRM:STARTPRM+ONE);/*     @Y30LB54*/ 01664000
         L     @03,LPARMPTR                                        0485 01665000
         L     @01,INPTR                                           0485 01666000
         AL    @01,STARTPRM                                        0485 01667000
         AL    @01,@CF00396                                        0485 01668000
         MVC   CTYPE(2,@03),INPUT(@01)                             0485 01669000
*         RETURN;                   /*                       @Y30LB54*/ 01670000
@EL00013 DS    0H                                                  0486 01671000
@EF00013 DS    0H                                                  0486 01672000
@ER00013 LM    @14,@12,@SA00013                                    0486 01673000
         BR    @14                                                 0486 01674000
*       END;                        /*                       @Y30LB54*/ 01675000
*     ELSE                                                         0488 01676000
*       ;                           /*                       @Y30LB54*/ 01677000
@RF00483 DS    0H                                                  0489 01678000
*   END;                            /*                       @Y30LB54*/ 01679000
         AH    CTR1,@CH00068                                       0489 01680000
         CH    CTR1,@CH00318                                       0489 01681000
         BNH   @DL00482                                            0489 01682000
*   CTYPE=DFTYPE;                   /* TAKE DEFAULTS         @Y30LB54*/ 01683000
         L     @03,LPARMPTR                                        0490 01684000
         MVC   CTYPE(2,@03),DFTYPE                                 0490 01685000
*   LINE='ISDAPARM DEVTYPE(SA|RC|RD|CS|DA) ERROR';/*         @Y30LB54*/ 01686000
         MVI   LINE+38(CVTPTR),C' '                                0491 01687000
         MVC   LINE+39(93,CVTPTR),LINE+38(CVTPTR)                  0491 01688000
         MVC   LINE(38,CVTPTR),@CC00429                            0491 01689000
*   CALL ISDAPRT0(WORKPTR);         /*                       @Y30LB54*/ 01690000
         L     @03,@PC00001                                        0492 01691000
         ST    @03,@AL00001                                        0492 01692000
         L     @15,@CV00037                                        0492 01693000
         LA    @01,@AL00001                                        0492 01694000
         BALR  @14,@15                                             0492 01695000
*   CALL ISDATYPE(WORKPTR);         /* TO TERMINAL OUTPUT    @Y30LB54*/ 01696000
         L     @03,@PC00001                                        0493 01697000
         ST    @03,@AL00001                                        0493 01698000
         L     @15,@CV00038                                        0493 01699000
         LA    @01,@AL00001                                        0493 01700000
         BALR  @14,@15                                             0493 01701000
*   DCL                                                            0494 01702000
*     1 DEVTAB(5) STATIC LOCAL,     /* TABLE OF VALID ID ARGUMENTS 0494 01703000
*                                                            @Y30LB54*/ 01704000
*      2 DEVARG CHAR(2) INIT('SA','RC','RD','CS','DA');/*    @Y30LB54*/ 01705000
*   END DEVCLAUS;                   /*                       @Y30LB54*/ 01706000
         B     @EL00013                                            0495 01707000
*                                                                  0496 01708000
*   /*****************************************************************/ 01709000
*   /*                                                               */ 01710000
*   /* FSCODE(XXXXXXXX | XXXX)                                       */ 01711000
*   /*                                                               */ 01712000
*   /*****************************************************************/ 01713000
*                                                                  0496 01714000
*FSCCLAUS:                                                         0496 01715000
*   PROC;                           /*                       @Y30LB54*/ 01716000
FSCCLAUS STM   @14,@12,@SA00014                                    0496 01717000
*   FULLWD2=ENDPRM-STARTPRM+ONE;    /* HOW MANY INPUT DIGITS @Y30LB54*/ 01718000
         L     @03,ENDPRM                                          0497 01719000
         SL    @03,STARTPRM                                        0497 01720000
         AH    @03,@CH00068                                        0497 01721000
         ST    @03,FULLWD2                                         0497 01722000
*   IF FULLWD2^=6&FULLWD2^=10 THEN                                 0498 01723000
         CLC   FULLWD2(4),@CF00207                                 0498 01724000
         BE    @RF00498                                            0498 01725000
         CLC   FULLWD2(4),@CF00441                                 0498 01726000
         BE    @RF00498                                            0498 01727000
*     RETCODE1=8;                   /*                       @Y30LB54*/ 01728000
         MVC   RETCODE1(4),@CF00091                                0499 01729000
*   ELSE                                                           0500 01730000
*     DO;                           /*                       @Y30LB54*/ 01731000
         B     @RC00498                                            0500 01732000
@RF00498 DS    0H                                                  0501 01733000
*       LINE(ONE:FOUR)='00000000'X; /* ZERO AREA TO BE CONVERTED   0501 01734000
*                                                            @Y30LB54*/ 01735000
         MVC   LINE(4,CVTPTR),@CB00122                             0501 01736000
*       STARTPRM=STARTPRM+ONE;      /* POINT TO FIRST DIGIT  @Y30LB54*/ 01737000
         LA    @05,1                                               0502 01738000
         AL    @05,STARTPRM                                        0502 01739000
         ST    @05,STARTPRM                                        0502 01740000
*       CTR1=FULLWD2-TWO;           /* TELL THEM HOW MANY DIGITS   0503 01741000
*                                                            @Y30LB54*/ 01742000
         L     CTR1,FULLWD2                                        0503 01743000
         BCTR  CTR1,0                                              0503 01744000
         BCTR  CTR1,0                                              0503 01745000
*       CALL EBDICHEX;              /*                       @Y30LB54*/ 01746000
         BAL   @14,EBDICHEX                                        0504 01747000
*       IF RETCODE1^=0 THEN                                        0505 01748000
         ICM   @03,15,RETCODE1                                     0505 01749000
         BNZ   @RT00505                                            0505 01750000
*         ;                         /*                       @Y30LB54*/ 01751000
*       ELSE                                                       0507 01752000
*         CFSCONLY=LINE(ONE:FOUR);  /* MOVE TO PARMS         @Y30LB54*/ 01753000
         L     @03,LPARMPTR                                        0507 01754000
         MVC   CFSCONLY(4,@03),LINE(CVTPTR)                        0507 01755000
*     END;                          /*                       @Y30LB54*/ 01756000
@RT00505 DS    0H                                                  0509 01757000
*   IF RETCODE1^=0 THEN                                            0509 01758000
@RC00498 SLR   @03,@03                                             0509 01759000
         C     @03,RETCODE1                                        0509 01760000
         BE    @RF00509                                            0509 01761000
*     DO;                           /*                       @Y30LB54*/ 01762000
*       RETCODE1=0;                 /* TAKE DEFAULTS ALLOW CONTROL TO   01763000
*                                      CONTINUE              @Y30LB54*/ 01764000
         ST    @03,RETCODE1                                        0511 01765000
*       CFSCONLY=DFFSCONL;          /* TAKE DEFAULTS         @Y30LB54*/ 01766000
         L     @03,LPARMPTR                                        0512 01767000
         MVC   CFSCONLY(4,@03),DFFSCONL                            0512 01768000
*       LINE='ISDAPARM FSCODE(XXXXXXXX | XXXX) ERROR';/*     @Y30LB54*/ 01769000
         MVI   LINE+38(CVTPTR),C' '                                0513 01770000
         MVC   LINE+39(93,CVTPTR),LINE+38(CVTPTR)                  0513 01771000
         MVC   LINE(38,CVTPTR),@CC00442                            0513 01772000
*       CALL ISDAPRT0(WORKPTR);     /*                       @Y30LB54*/ 01773000
         L     @03,@PC00001                                        0514 01774000
         ST    @03,@AL00001                                        0514 01775000
         L     @15,@CV00037                                        0514 01776000
         LA    @01,@AL00001                                        0514 01777000
         BALR  @14,@15                                             0514 01778000
*       CALL ISDATYPE(WORKPTR);     /* TO TERMINAL OUTPUT    @Y30LB54*/ 01779000
         L     @03,@PC00001                                        0515 01780000
         ST    @03,@AL00001                                        0515 01781000
         L     @15,@CV00038                                        0515 01782000
         LA    @01,@AL00001                                        0515 01783000
         BALR  @14,@15                                             0515 01784000
*     END;                          /*                       @Y30LB54*/ 01785000
*   ELSE                                                           0517 01786000
*     ;                             /*                       @Y30LB54*/ 01787000
@RF00509 DS    0H                                                  0518 01788000
*   END FSCCLAUS;                   /*                       @Y30LB54*/ 01789000
@EL00014 DS    0H                                                  0518 01790000
@EF00014 DS    0H                                                  0518 01791000
@ER00014 LM    @14,@12,@SA00014                                    0518 01792000
         BR    @14                                                 0518 01793000
*                                                                  0519 01794000
*   /*****************************************************************/ 01795000
*   /*                                                               */ 01796000
*   /* SSID(XXX)                                                     */ 01797000
*   /*                                                               */ 01798000
*   /*****************************************************************/ 01799000
*                                                                  0519 01800000
*SSICLAUS:                                                         0519 01801000
*   PROC;                           /*                       @Y30LB54*/ 01802000
SSICLAUS STM   @14,@12,@SA00015                                    0519 01803000
*   FULLWD2=ENDPRM-STARTPRM+ONE;    /*                       @Y30LB54*/ 01804000
         L     @03,ENDPRM                                          0520 01805000
         SL    @03,STARTPRM                                        0520 01806000
         AH    @03,@CH00068                                        0520 01807000
         ST    @03,FULLWD2                                         0520 01808000
*   IF FULLWD2^=5 THEN                                             0521 01809000
         CLC   FULLWD2(4),@CF00318                                 0521 01810000
         BE    @RF00521                                            0521 01811000
*     RETCODE1=8;                   /*                       @Y30LB54*/ 01812000
         MVC   RETCODE1(4),@CF00091                                0522 01813000
*   ELSE                                                           0523 01814000
*     DO;                           /*                       @Y30LB54*/ 01815000
         B     @RC00521                                            0523 01816000
@RF00521 DS    0H                                                  0524 01817000
*       INPUT(STARTPRM)='0';        /*                       @Y30LB54*/ 01818000
         L     @05,INPTR                                           0524 01819000
         AL    @05,STARTPRM                                        0524 01820000
         AL    @05,@CF00396                                        0524 01821000
         MVI   INPUT(@05),C'0'                                     0524 01822000
*       CTR1=4;                     /*                       @Y30LB54*/ 01823000
         LA    CTR1,4                                              0525 01824000
*       CALL EBDICHEX;              /*                       @Y30LB54*/ 01825000
         BAL   @14,EBDICHEX                                        0526 01826000
*       IF RETCODE1^=0 THEN                                        0527 01827000
         ICM   @03,15,RETCODE1                                     0527 01828000
         BNZ   @RT00527                                            0527 01829000
*         ;                         /*                       @Y30LB54*/ 01830000
*       ELSE                                                       0529 01831000
*         CSSIDF=LINE(ONE:TWO);     /*                       @Y30LB54*/ 01832000
         L     @03,LPARMPTR                                        0529 01833000
         MVC   CSSIDF(2,@03),LINE(CVTPTR)                          0529 01834000
*     END;                          /*                       @Y30LB54*/ 01835000
@RT00527 DS    0H                                                  0531 01836000
*   IF RETCODE1^=0 THEN                                            0531 01837000
@RC00521 SLR   @03,@03                                             0531 01838000
         C     @03,RETCODE1                                        0531 01839000
         BE    @RF00531                                            0531 01840000
*     DO;                           /*                       @Y30LB54*/ 01841000
*       RETCODE1=0;                 /* TAKE DEFAULTS ALLOW CONTROL TO   01842000
*                                      CONTINUE              @Y30LB54*/ 01843000
         ST    @03,RETCODE1                                        0533 01844000
*       CSSIDF=DFSSIDF;             /* TAKE DEFAULTS         @Y30LB54*/ 01845000
         L     @03,LPARMPTR                                        0534 01846000
         MVC   CSSIDF(2,@03),DFSSIDF                               0534 01847000
*       LINE='ISDAPARM SSID(XXX) ERROR ';/*                  @Y30LB54*/ 01848000
         MVI   LINE+25(CVTPTR),C' '                                0535 01849000
         MVC   LINE+26(106,CVTPTR),LINE+25(CVTPTR)                 0535 01850000
         MVC   LINE(25,CVTPTR),@CC00448                            0535 01851000
*       CALL ISDAPRT0(WORKPTR);     /*                       @Y30LB54*/ 01852000
         L     @03,@PC00001                                        0536 01853000
         ST    @03,@AL00001                                        0536 01854000
         L     @15,@CV00037                                        0536 01855000
         LA    @01,@AL00001                                        0536 01856000
         BALR  @14,@15                                             0536 01857000
*       CALL ISDATYPE(WORKPTR);     /* TO TERMINAL OUTPUT    @Y30LB54*/ 01858000
         L     @03,@PC00001                                        0537 01859000
         ST    @03,@AL00001                                        0537 01860000
         L     @15,@CV00038                                        0537 01861000
         LA    @01,@AL00001                                        0537 01862000
         BALR  @14,@15                                             0537 01863000
*     END;                          /*                       @Y30LB54*/ 01864000
*   ELSE                                                           0539 01865000
*     ;                             /*                       @Y30LB54*/ 01866000
@RF00531 DS    0H                                                  0540 01867000
*   END SSICLAUS;                   /*                       @Y30LB54*/ 01868000
@EL00015 DS    0H                                                  0540 01869000
@EF00015 DS    0H                                                  0540 01870000
@ER00015 LM    @14,@12,@SA00015                                    0540 01871000
         BR    @14                                                 0540 01872000
*                                                                  0541 01873000
*   /*****************************************************************/ 01874000
*   /*                                                               */ 01875000
*   /* RATIO(XX)                                                     */ 01876000
*   /*                                                               */ 01877000
*   /*****************************************************************/ 01878000
*                                                                  0541 01879000
*RATCLAUS:                                                         0541 01880000
*   PROC;                           /*                       @Y30LB54*/ 01881000
RATCLAUS STM   @14,@12,@SA00016                                    0541 01882000
*   FULLWD2=ENDPRM-STARTPRM+ONE;    /*                       @Y30LB54*/ 01883000
         L     @03,ENDPRM                                          0542 01884000
         SL    @03,STARTPRM                                        0542 01885000
         AH    @03,@CH00068                                        0542 01886000
         ST    @03,FULLWD2                                         0542 01887000
*   IF FULLWD2^=4 THEN                                             0543 01888000
         CLC   FULLWD2(4),@CF00071                                 0543 01889000
         BE    @RF00543                                            0543 01890000
*     RETCODE1=8;                   /*                       @Y30LB54*/ 01891000
         MVC   RETCODE1(4),@CF00091                                0544 01892000
*   ELSE                                                           0545 01893000
*     DO;                           /*                       @Y30LB54*/ 01894000
         B     @RC00543                                            0545 01895000
@RF00543 DS    0H                                                  0546 01896000
*       STARTPRM=STARTPRM+ONE;      /*                       @Y30LB54*/ 01897000
         LA    @03,1                                               0546 01898000
         AL    @03,STARTPRM                                        0546 01899000
         ST    @03,STARTPRM                                        0546 01900000
*       IF INPUT(STARTPRM:STARTPRM+ONE)<'00' THEN                  0547 01901000
         L     @03,INPTR                                           0547 01902000
         AL    @03,STARTPRM                                        0547 01903000
         AL    @03,@CF00396                                        0547 01904000
         CLC   INPUT(2,@03),@CC00454                               0547 01905000
         BNL   @RF00547                                            0547 01906000
*         RETCODE1=8;               /*                       @Y30LB54*/ 01907000
         MVC   RETCODE1(4),@CF00091                                0548 01908000
*       ELSE                                                       0549 01909000
*         IF INPUT(STARTPRM:STARTPRM+ONE)>'99' THEN                0549 01910000
         B     @RC00547                                            0549 01911000
@RF00547 L     @03,INPTR                                           0549 01912000
         AL    @03,STARTPRM                                        0549 01913000
         AL    @03,@CF00396                                        0549 01914000
         CLC   INPUT(2,@03),@CC00455                               0549 01915000
         BNH   @RF00549                                            0549 01916000
*           RETCODE1=8;             /*                       @Y30LB54*/ 01917000
         MVC   RETCODE1(4),@CF00091                                0550 01918000
*         ELSE                                                     0551 01919000
*           IF INPUT(STARTPRM+ONE)<'0' THEN                        0551 01920000
         B     @RC00549                                            0551 01921000
@RF00549 L     @03,INPTR                                           0551 01922000
         AL    @03,STARTPRM                                        0551 01923000
         CLI   INPUT(@03),C'0'                                     0551 01924000
         BNL   @RF00551                                            0551 01925000
*             RETCODE1=8;           /*                       @Y30LB54*/ 01926000
         MVC   RETCODE1(4),@CF00091                                0552 01927000
*           ELSE                                                   0553 01928000
*             IF INPUT(STARTPRM+ONE)>'9' THEN                      0553 01929000
         B     @RC00551                                            0553 01930000
@RF00551 L     @03,INPTR                                           0553 01931000
         AL    @03,STARTPRM                                        0553 01932000
         CLI   INPUT(@03),C'9'                                     0553 01933000
         BNH   @RF00553                                            0553 01934000
*               RETCODE1=8;         /*                       @Y30LB54*/ 01935000
         MVC   RETCODE1(4),@CF00091                                0554 01936000
*             ELSE                                                 0555 01937000
*               CRATIO=INPUT(STARTPRM:STARTPRM+ONE);               0555 01938000
         B     @RC00553                                            0555 01939000
@RF00553 L     @03,LPARMPTR                                        0555 01940000
         L     @01,INPTR                                           0555 01941000
         AL    @01,STARTPRM                                        0555 01942000
         AL    @01,@CF00396                                        0555 01943000
         MVC   CRATIO(2,@03),INPUT(@01)                            0555 01944000
*     END;                          /*                       @Y30LB54*/ 01945000
@RC00553 DS    0H                                                  0556 01946000
@RC00551 DS    0H                                                  0556 01947000
@RC00549 DS    0H                                                  0556 01948000
@RC00547 DS    0H                                                  0557 01949000
*   IF RETCODE1^=0 THEN                                            0557 01950000
@RC00543 SLR   @03,@03                                             0557 01951000
         C     @03,RETCODE1                                        0557 01952000
         BE    @RF00557                                            0557 01953000
*     DO;                           /*                       @Y30LB54*/ 01954000
*       RETCODE1=0;                 /* TAKE DEFAULTS ALLOW CONTROL TO   01955000
*                                      CONTINUE              @Y30LB54*/ 01956000
         ST    @03,RETCODE1                                        0559 01957000
*       CRATIO=DFRATIO;             /* TAKE DEFAULTS         @Y30LB54*/ 01958000
         L     @03,LPARMPTR                                        0560 01959000
         MVC   CRATIO(2,@03),DFRATIO                               0560 01960000
*       LINE='ISDAPARM RATIO(XX) ERROR';/*                   @Y30LB54*/ 01961000
         MVI   LINE+24(CVTPTR),C' '                                0561 01962000
         MVC   LINE+25(107,CVTPTR),LINE+24(CVTPTR)                 0561 01963000
         MVC   LINE(24,CVTPTR),@CC00456                            0561 01964000
*       CALL ISDAPRT0(WORKPTR);     /*                       @Y30LB54*/ 01965000
         L     @03,@PC00001                                        0562 01966000
         ST    @03,@AL00001                                        0562 01967000
         L     @15,@CV00037                                        0562 01968000
         LA    @01,@AL00001                                        0562 01969000
         BALR  @14,@15                                             0562 01970000
*       CALL ISDATYPE(WORKPTR);     /* TO TERMINAL OUTPUT    @Y30LB54*/ 01971000
         L     @03,@PC00001                                        0563 01972000
         ST    @03,@AL00001                                        0563 01973000
         L     @15,@CV00038                                        0563 01974000
         LA    @01,@AL00001                                        0563 01975000
         BALR  @14,@15                                             0563 01976000
*     END;                          /*                       @Y30LB54*/ 01977000
*   ELSE                                                           0565 01978000
*     ;                             /*                       @Y30LB54*/ 01979000
@RF00557 DS    0H                                                  0566 01980000
*   END RATCLAUS;                   /*                       @Y30LB54*/ 01981000
@EL00016 DS    0H                                                  0566 01982000
@EF00016 DS    0H                                                  0566 01983000
@ER00016 LM    @14,@12,@SA00016                                    0566 01984000
         BR    @14                                                 0566 01985000
*                                                                  0567 01986000
*   /*****************************************************************/ 01987000
*   /*                                                               */ 01988000
*   /* CSN(XXXYYYYYYYYY)                                             */ 01989000
*   /*                                                               */ 01990000
*   /*****************************************************************/ 01991000
*                                                                  0567 01992000
*CSNCLAUS:                                                         0567 01993000
*   PROC;                           /*                       @Y30LB54*/ 01994000
CSNCLAUS STM   @14,@12,@SA00017                                    0567 01995000
*   CSERIAL=' ';                    /*                       @Y30LB54*/ 01996000
         L     @03,LPARMPTR                                        0568 01997000
         MVI   CSERIAL+1(@03),C' '                                 0568 01998000
         MVC   CSERIAL+2(10,@03),CSERIAL+1(@03)                    0568 01999000
         MVI   CSERIAL(@03),C' '                                   0568 02000000
*   FULLWD2=ENDPRM-STARTPRM-ONE;    /*                       @Y30LB54*/ 02001000
         L     @03,ENDPRM                                          0569 02002000
         SL    @03,STARTPRM                                        0569 02003000
         BCTR  @03,0                                               0569 02004000
         ST    @03,FULLWD2                                         0569 02005000
*   IF FULLWD2>12|FULLWD2<1 THEN                                   0570 02006000
         L     @03,FULLWD2                                         0570 02007000
         CH    @03,@CH00034                                        0570 02008000
         BH    @RT00570                                            0570 02009000
         ICM   @03,15,FULLWD2                                      0570 02010000
         BP    @RF00570                                            0570 02011000
@RT00570 DS    0H                                                  0571 02012000
*     DO;                           /*                       @Y30LB54*/ 02013000
*       CSERIAL=DFSERIAL;           /* TAKE DEFAULTS         @Y30LB54*/ 02014000
         L     @03,LPARMPTR                                        0572 02015000
         MVC   CSERIAL(12,@03),DFSERIAL                            0572 02016000
*       LINE='ISDAPARM CSN(XXXYYYYYYYYY) ERROR';/*           @Y30LB54*/ 02017000
         MVI   LINE+32(CVTPTR),C' '                                0573 02018000
         MVC   LINE+33(99,CVTPTR),LINE+32(CVTPTR)                  0573 02019000
         MVC   LINE(32,CVTPTR),@CC00461                            0573 02020000
*       CALL ISDAPRT0(WORKPTR);     /*                       @Y30LB54*/ 02021000
         L     @03,@PC00001                                        0574 02022000
         ST    @03,@AL00001                                        0574 02023000
         L     @15,@CV00037                                        0574 02024000
         LA    @01,@AL00001                                        0574 02025000
         BALR  @14,@15                                             0574 02026000
*       CALL ISDATYPE(WORKPTR);     /* TO TERMINAL OUTPUT    @Y30LB54*/ 02027000
         L     @03,@PC00001                                        0575 02028000
         ST    @03,@AL00001                                        0575 02029000
         L     @15,@CV00038                                        0575 02030000
         LA    @01,@AL00001                                        0575 02031000
         BALR  @14,@15                                             0575 02032000
*     END;                          /*                       @Y30LB54*/ 02033000
*   ELSE                                                           0577 02034000
*     CSERIAL(ONE:FULLWD2)=INPUT(STARTPRM+ONE:ENDPRM-ONE);/* @Y30LB54*/ 02035000
         B     @RC00570                                            0577 02036000
@RF00570 L     @03,LPARMPTR                                        0577 02037000
         L     @15,FULLWD2                                         0577 02038000
         BCTR  @15,0                                               0577 02039000
         L     @01,INPTR                                           0577 02040000
         AL    @01,STARTPRM                                        0577 02041000
         EX    @15,@SM00512                                        0577 02042000
*   END CSNCLAUS;                   /*                       @Y30LB54*/ 02043000
@EL00017 DS    0H                                                  0578 02044000
@EF00017 DS    0H                                                  0578 02045000
@ER00017 LM    @14,@12,@SA00017                                    0578 02046000
         BR    @14                                                 0578 02047000
*                                                                  0579 02048000
*   /*****************************************************************/ 02049000
*   /*                                                               */ 02050000
*   /* INCLUDE(XXX,YYY,ETC)                                          */ 02051000
*   /*                                                               */ 02052000
*   /*****************************************************************/ 02053000
*                                                                  0579 02054000
*INCCLAUS:                                                         0579 02055000
*   PROC;                           /*                       @Y30LB54*/ 02056000
INCCLAUS STM   @14,@12,@SA00018                                    0579 02057000
*   CREPORTS=CREPORTS&&CREPORTS;    /* CLEAR ALL DEFAULTS    @Y30LB54*/ 02058000
         L     @03,LPARMPTR                                        0580 02059000
         XC    CREPORTS(12,@03),CREPORTS(@03)                      0580 02060000
*   FULLWD2=ENDPRM-STARTPRM+ONE;    /* FIND TOTAL LENGTH     @Y30LB54*/ 02061000
         L     @03,ENDPRM                                          0581 02062000
         SL    @03,STARTPRM                                        0581 02063000
         AH    @03,@CH00068                                        0581 02064000
         ST    @03,FULLWD2                                         0581 02065000
*   IF FULLWD2^>4 THEN              /* CANNOT DO TABLE SEARCH@Y30LB54*/ 02066000
         L     @03,FULLWD2                                         0582 02067000
         CH    @03,@CH00071                                        0582 02068000
         BH    @RF00582                                            0582 02069000
*     RETCODE1=8;                   /* ERROR INPUT           @Y30LB54*/ 02070000
         MVC   RETCODE1(4),@CF00091                                0583 02071000
*   ELSE                                                           0584 02072000
*     ;                             /*                       @Y30LB54*/ 02073000
@RF00582 DS    0H                                                  0585 02074000
*   DO WHILE STARTPRM>0;            /* PROCESS ALL INPUTS    @Y30LB54*/ 02075000
         B     @DE00585                                            0585 02076000
@DL00585 DS    0H                                                  0586 02077000
*     STARTPRM=STARTPRM+ONE;        /* POINT TO FIRST DIGIT  @Y30LB54*/ 02078000
         LA    @03,1                                               0586 02079000
         AL    @03,STARTPRM                                        0586 02080000
         ST    @03,STARTPRM                                        0586 02081000
*     DO CTR1=1 TO NREPORTS BY 1;   /* LOOK UP ALL REPORTS   @ZM30976*/ 02082000
         LA    CTR1,1                                              0587 02083000
@DL00587 DS    0H                                                  0588 02084000
*       IF INPUT(STARTPRM:STARTPRM+TWO)=RPTARG(CTR1) THEN          0588 02085000
         LR    @05,CTR1                                            0588 02086000
         SLA   @05,3                                               0588 02087000
         L     @03,INPTR                                           0588 02088000
         AL    @03,STARTPRM                                        0588 02089000
         AL    @03,@CF00396                                        0588 02090000
         LA    @01,RPTARG-8(@05)                                   0588 02091000
         CLC   INPUT(3,@03),0(@01)                                 0588 02092000
         BNE   @RF00588                                            0588 02093000
*         DO;                       /*                       @Y30LB54*/ 02094000
*           FULLWD2=RPTFUNCA(CTR1)+ONE;/* PICK UP DISPLACEMENT OF  0590 02095000
*                                      REPORT                @Y30LB54*/ 02096000
         LA    @03,1                                               0590 02097000
         AL    @03,RPTFUNCA-8(@05)                                 0590 02098000
         ST    @03,FULLWD2                                         0590 02099000
*           ISDAPRMS(FULLWD2)=ISDAPRMS(FULLWD2)|RPTFUNCH(CTR1);/*  0591 02100000
*                                      TURN IT ON            @Y30LB54*/ 02101000
         L     @05,LPARMPTR                                        0591 02102000
         AL    @05,FULLWD2                                         0591 02103000
         AL    @05,@CF00396                                        0591 02104000
         LR    @03,CTR1                                            0591 02105000
         SLA   @03,3                                               0591 02106000
         LA    @01,RPTFUNCH-8(@03)                                 0591 02107000
         OC    ISDAPRMS(1,@05),0(@01)                              0591 02108000
*           CALL FNDCOMMA;          /* FIND COMMA OR END OF PARMS  0592 02109000
*                                                            @Y30LB54*/ 02110000
         BAL   @14,FNDCOMMA                                        0592 02111000
*           CTR1=100;               /* START THIS LOOP OVER  @Y30LB54*/ 02112000
         LA    CTR1,100                                            0593 02113000
*         END;                      /*                       @Y30LB54*/ 02114000
*       ELSE                                                       0595 02115000
*         ;                         /*                       @Y30LB54*/ 02116000
@RF00588 DS    0H                                                  0596 02117000
*     END;                          /*                       @Y30LB54*/ 02118000
         AH    CTR1,@CH00068                                       0596 02119000
         CH    CTR1,@CH00205                                       0596 02120000
         BNH   @DL00587                                            0596 02121000
*     IF CTR1^>99 THEN                                             0597 02122000
         CH    CTR1,@CH00386                                       0597 02123000
         BH    @RF00597                                            0597 02124000
*       DO;                         /* INVALID INPUT DATA    @ZA00669*/ 02125000
*         STARTPRM=0;               /* GET OUT OF LOOP       @ZA00669*/ 02126000
         SLR   @03,@03                                             0599 02127000
         ST    @03,STARTPRM                                        0599 02128000
*         RETCODE1=8;               /* ERROR ON INPUT        @Y30LB54*/ 02129000
         MVC   RETCODE1(4),@CF00091                                0600 02130000
*       END;                        /* END ERROR SET         @ZA00669*/ 02131000
*     ELSE                                                         0602 02132000
*       ;                           /*                       @Y30LB54*/ 02133000
@RF00597 DS    0H                                                  0603 02134000
*   END;                            /*                       @Y30LB54*/ 02135000
@DE00585 SLR   @03,@03                                             0603 02136000
         C     @03,STARTPRM                                        0603 02137000
         BL    @DL00585                                            0603 02138000
*   IF RETCODE1^=0 THEN                                            0604 02139000
         C     @03,RETCODE1                                        0604 02140000
         BE    @RF00604                                            0604 02141000
*     DO;                           /*                       @Y30LB54*/ 02142000
*       RETCODE1=0;                 /* ALLOW TO TAKE DEFAULTS@Y30LB54*/ 02143000
         ST    @03,RETCODE1                                        0606 02144000
*       CREPORTS=DFREPORT;          /* TAKE DEFAULTS FOR REPORTS   0607 02145000
*                                                            @Y30LB54*/ 02146000
         L     @03,LPARMPTR                                        0607 02147000
         MVC   CREPORTS(12,@03),DFREPORT                           0607 02148000
*       LINE='ISDAPARM INCLUDE(DCS,PAD,SUM,DHE,DHU,FSC,EQC,DCK,TLX,CSB, 02149000
*SF,DAT,DRC,APR,SUU) ERROR';        /*                       @ZM30976*/ 02150000
         MVI   LINE+83(CVTPTR),C' '                                0608 02151000
         MVC   LINE+84(48,CVTPTR),LINE+83(CVTPTR)                  0608 02152000
         MVC   LINE(83,CVTPTR),@CC00467                            0608 02153000
*       CALL ISDAPRT0(WORKPTR);     /*                       @Y30LB54*/ 02154000
         L     @03,@PC00001                                        0609 02155000
         ST    @03,@AL00001                                        0609 02156000
         L     @15,@CV00037                                        0609 02157000
         LA    @01,@AL00001                                        0609 02158000
         BALR  @14,@15                                             0609 02159000
*       CALL ISDATYPE(WORKPTR);     /* TO TERMINAL OUTPUT    @Y30LB54*/ 02160000
         L     @03,@PC00001                                        0610 02161000
         ST    @03,@AL00001                                        0610 02162000
         L     @15,@CV00038                                        0610 02163000
         LA    @01,@AL00001                                        0610 02164000
         BALR  @14,@15                                             0610 02165000
*     END;                          /*                       @Y30LB54*/ 02166000
*   END INCCLAUS;                   /*                       @Y30LB54*/ 02167000
@EL00018 DS    0H                                                  0612 02168000
@EF00018 DS    0H                                                  0612 02169000
@ER00018 LM    @14,@12,@SA00018                                    0612 02170000
         BR    @14                                                 0612 02171000
*                                                                  0613 02172000
*   /*****************************************************************/ 02173000
*   /*                                                               */ 02174000
*   /* EXCLUDE(XXX,YYY,ETC)                                          */ 02175000
*   /*                                                               */ 02176000
*   /*****************************************************************/ 02177000
*                                                                  0613 02178000
*EXCCLAUS:                                                         0613 02179000
*   PROC;                           /*                       @Y30LB54*/ 02180000
EXCCLAUS STM   @14,@12,@SA00019                                    0613 02181000
*   FULLWD2=ENDPRM-STARTPRM+ONE;    /* FIND TOTAL LENGTH     @Y30LB54*/ 02182000
         L     @03,ENDPRM                                          0614 02183000
         SL    @03,STARTPRM                                        0614 02184000
         AH    @03,@CH00068                                        0614 02185000
         ST    @03,FULLWD2                                         0614 02186000
*   IF FULLWD2^>4 THEN              /* CANNOT DO TABLE SEARCH@Y30LB54*/ 02187000
         L     @03,FULLWD2                                         0615 02188000
         CH    @03,@CH00071                                        0615 02189000
         BH    @RF00615                                            0615 02190000
*     RETCODE1=8;                   /* ERROR INPUT           @Y30LB54*/ 02191000
         MVC   RETCODE1(4),@CF00091                                0616 02192000
*   ELSE                                                           0617 02193000
*     ;                             /*                       @Y30LB54*/ 02194000
@RF00615 DS    0H                                                  0618 02195000
*   DO WHILE STARTPRM>0;            /* PROCESS ALL INPUTS    @Y30LB54*/ 02196000
         B     @DE00618                                            0618 02197000
@DL00618 DS    0H                                                  0619 02198000
*     STARTPRM=STARTPRM+ONE;        /* POINT TO FIRST DIGIT  @Y30LB54*/ 02199000
         LA    @03,1                                               0619 02200000
         AL    @03,STARTPRM                                        0619 02201000
         ST    @03,STARTPRM                                        0619 02202000
*     DO CTR1=1 TO NREPORTS BY 1;   /* LOOK UP ALL REPORTS   @ZM30976*/ 02203000
         LA    CTR1,1                                              0620 02204000
@DL00620 DS    0H                                                  0621 02205000
*       IF INPUT(STARTPRM:STARTPRM+TWO)=RPTARG(CTR1) THEN          0621 02206000
         LR    @05,CTR1                                            0621 02207000
         SLA   @05,3                                               0621 02208000
         L     @03,INPTR                                           0621 02209000
         AL    @03,STARTPRM                                        0621 02210000
         AL    @03,@CF00396                                        0621 02211000
         LA    @01,RPTARG-8(@05)                                   0621 02212000
         CLC   INPUT(3,@03),0(@01)                                 0621 02213000
         BNE   @RF00621                                            0621 02214000
*         DO;                       /*                       @Y30LB54*/ 02215000
*           FULLWD2=RPTFUNCA(CTR1)+ONE;/* PICK UP DISPLACEMENT OF  0623 02216000
*                                      REPORT                @Y30LB54*/ 02217000
         LA    @03,1                                               0623 02218000
         AL    @03,RPTFUNCA-8(@05)                                 0623 02219000
         ST    @03,FULLWD2                                         0623 02220000
*           ISDAPRMS(FULLWD2)=ISDAPRMS(FULLWD2)|RPTFUNCH(CTR1);/*  0624 02221000
*                                      TURN IT ON            @Y30LB54*/ 02222000
         L     @05,LPARMPTR                                        0624 02223000
         AL    @05,FULLWD2                                         0624 02224000
         AL    @05,@CF00396                                        0624 02225000
         LR    @03,CTR1                                            0624 02226000
         SLA   @03,3                                               0624 02227000
         LA    @01,RPTFUNCH-8(@03)                                 0624 02228000
         OC    ISDAPRMS(1,@05),0(@01)                              0624 02229000
*           ISDAPRMS(FULLWD2)=ISDAPRMS(FULLWD2)&&RPTFUNCH(CTR1);/* 0625 02230000
*                                      TURN IT OFF           @Y30LB54*/ 02231000
         L     @05,LPARMPTR                                        0625 02232000
         AL    @05,FULLWD2                                         0625 02233000
         AL    @05,@CF00396                                        0625 02234000
         LR    @03,CTR1                                            0625 02235000
         SLA   @03,3                                               0625 02236000
         LA    @01,RPTFUNCH-8(@03)                                 0625 02237000
         XC    ISDAPRMS(1,@05),0(@01)                              0625 02238000
*           CALL FNDCOMMA;          /* FIND COMMA OR END OF PARMS  0626 02239000
*                                                            @Y30LB54*/ 02240000
         BAL   @14,FNDCOMMA                                        0626 02241000
*           CTR1=100;               /* START THIS LOOP OVER  @Y30LB54*/ 02242000
         LA    CTR1,100                                            0627 02243000
*         END;                      /*                       @Y30LB54*/ 02244000
*       ELSE                                                       0629 02245000
*         ;                         /*                       @Y30LB54*/ 02246000
@RF00621 DS    0H                                                  0630 02247000
*     END;                          /*                       @Y30LB54*/ 02248000
         AH    CTR1,@CH00068                                       0630 02249000
         CH    CTR1,@CH00205                                       0630 02250000
         BNH   @DL00620                                            0630 02251000
*     IF CTR1^>99 THEN                                             0631 02252000
         CH    CTR1,@CH00386                                       0631 02253000
         BH    @RF00631                                            0631 02254000
*       DO;                         /* INVALID INPUT DATA    @ZA00669*/ 02255000
*         STARTPRM=0;               /* GET OUT OF LOOP       @ZA00669*/ 02256000
         SLR   @03,@03                                             0633 02257000
         ST    @03,STARTPRM                                        0633 02258000
*         RETCODE1=8;               /* ERROR ON INPUT        @Y30LB54*/ 02259000
         MVC   RETCODE1(4),@CF00091                                0634 02260000
*       END;                        /* END ERROR SET         @ZA00669*/ 02261000
*     ELSE                                                         0636 02262000
*       ;                           /*                       @Y30LB54*/ 02263000
@RF00631 DS    0H                                                  0637 02264000
*   END;                            /*                       @Y30LB54*/ 02265000
@DE00618 SLR   @03,@03                                             0637 02266000
         C     @03,STARTPRM                                        0637 02267000
         BL    @DL00618                                            0637 02268000
*   IF RETCODE1^=0 THEN                                            0638 02269000
         C     @03,RETCODE1                                        0638 02270000
         BE    @RF00638                                            0638 02271000
*     DO;                           /*                       @Y30LB54*/ 02272000
*       RETCODE1=0;                 /* ALLOW TO TAKE DEFAULTS@Y30LB54*/ 02273000
         ST    @03,RETCODE1                                        0640 02274000
*       CREPORTS=DFREPORT;          /* TAKE DEFAULTS FOR REPORTS   0641 02275000
*                                                            @Y30LB54*/ 02276000
         L     @03,LPARMPTR                                        0641 02277000
         MVC   CREPORTS(12,@03),DFREPORT                           0641 02278000
*       LINE='ISDAPARM EXCLUDE(DCS,PAD,SUM,DHE,DHU,FSC,EQC,DCK,TLX,CSB, 02279000
*SF,DAT,DRC,APR,SUU) ERROR';        /*                       @ZM30976*/ 02280000
         MVI   LINE+83(CVTPTR),C' '                                0642 02281000
         MVC   LINE+84(48,CVTPTR),LINE+83(CVTPTR)                  0642 02282000
         MVC   LINE(83,CVTPTR),@CC00476                            0642 02283000
*       CALL ISDAPRT0(WORKPTR);     /*                       @Y30LB54*/ 02284000
         L     @03,@PC00001                                        0643 02285000
         ST    @03,@AL00001                                        0643 02286000
         L     @15,@CV00037                                        0643 02287000
         LA    @01,@AL00001                                        0643 02288000
         BALR  @14,@15                                             0643 02289000
*       CALL ISDATYPE(WORKPTR);     /* TO TERMINAL OUTPUT    @Y30LB54*/ 02290000
         L     @03,@PC00001                                        0644 02291000
         ST    @03,@AL00001                                        0644 02292000
         L     @15,@CV00038                                        0644 02293000
         LA    @01,@AL00001                                        0644 02294000
         BALR  @14,@15                                             0644 02295000
*     END;                          /*                       @Y30LB54*/ 02296000
*   END EXCCLAUS;                   /*                       @Y30LB54*/ 02297000
@EL00019 DS    0H                                                  0646 02298000
@EF00019 DS    0H                                                  0646 02299000
@ER00019 LM    @14,@12,@SA00019                                    0646 02300000
         BR    @14                                                 0646 02301000
*                                                                  0647 02302000
*   /*****************************************************************/ 02303000
*   /*                                                               */ 02304000
*   /* DETAIL(ALL | NONE | 0,1,2,3,4,5)                              */ 02305000
*   /*                                                               */ 02306000
*   /*****************************************************************/ 02307000
*                                                                  0647 02308000
*DETCLAUS:                                                         0647 02309000
*   PROC;                           /*                       @Y30LB54*/ 02310000
DETCLAUS STM   @14,@12,@SA00020                                    0647 02311000
*   FULLWD2=ENDPRM-STARTPRM+ONE;    /* FIND TOTAL LENGTH     @Y30LB54*/ 02312000
         L     @03,ENDPRM                                          0648 02313000
         SL    @03,STARTPRM                                        0648 02314000
         AH    @03,@CH00068                                        0648 02315000
         ST    @03,FULLWD2                                         0648 02316000
*   CDETAIL='00'X;                  /* TURN OFF DEFAULTS     @Y30LB54*/ 02317000
         L     @03,LPARMPTR                                        0649 02318000
         MVI   CDETAIL(@03),X'00'                                  0649 02319000
*   IF FULLWD2^>2 THEN                                             0650 02320000
         L     @03,FULLWD2                                         0650 02321000
         CH    @03,@CH00066                                        0650 02322000
         BH    @RF00650                                            0650 02323000
*     RETCODE1=8;                   /* ERROR ON INPUT()      @Y30LB54*/ 02324000
         MVC   RETCODE1(4),@CF00091                                0651 02325000
*   ELSE                                                           0652 02326000
*     DO;                           /*                       @Y30LB54*/ 02327000
         B     @RC00650                                            0652 02328000
@RF00650 DS    0H                                                  0653 02329000
*       IF INPUT(STARTPRM+ONE)='A' THEN                            0653 02330000
         L     @03,INPTR                                           0653 02331000
         AL    @03,STARTPRM                                        0653 02332000
         CLI   INPUT(@03),C'A'                                     0653 02333000
         BNE   @RF00653                                            0653 02334000
*         CDETAIL='FF'X;            /* TURN ON ALL BITS      @Y30LB54*/ 02335000
         L     @03,LPARMPTR                                        0654 02336000
         MVI   CDETAIL(@03),X'FF'                                  0654 02337000
*       ELSE                                                       0655 02338000
*         IF INPUT(STARTPRM+ONE)='N' THEN                          0655 02339000
         B     @RC00653                                            0655 02340000
@RF00653 L     @03,INPTR                                           0655 02341000
         AL    @03,STARTPRM                                        0655 02342000
         CLI   INPUT(@03),C'N'                                     0655 02343000
         BNE   @RF00655                                            0655 02344000
*           CDETAIL='00'X;          /* TURN OFF ALL BITS     @Y30LB54*/ 02345000
         L     @03,LPARMPTR                                        0656 02346000
         MVI   CDETAIL(@03),X'00'                                  0656 02347000
*         ELSE                                                     0657 02348000
*           DO WHILE STARTPRM>0;    /*                       @Y30LB54*/ 02349000
         B     @RC00655                                            0657 02350000
@RF00655 B     @DE00657                                            0657 02351000
@DL00657 DS    0H                                                  0658 02352000
*             DO CTR=1 TO 6 BY 1;   /*                       @Y30LB54*/ 02353000
         LA    CTR,1                                               0658 02354000
@DL00658 DS    0H                                                  0659 02355000
*               IF INPUT(STARTPRM+ONE)=DETARG(CTR) THEN            0659 02356000
         LR    @15,CTR                                             0659 02357000
         ALR   @15,@15                                             0659 02358000
         L     @01,INPTR                                           0659 02359000
         AL    @01,STARTPRM                                        0659 02360000
         LA    @14,DETARG-2(@15)                                   0659 02361000
         CLC   INPUT(1,@01),0(@14)                                 0659 02362000
         BNE   @RF00659                                            0659 02363000
*                 DO;               /*                       @Y30LB54*/ 02364000
*                   CDETAIL=CDETAIL|DETFUNC(CTR);/* TURN ON CORRECT     02365000
*                                      BITS                  @Y30LB54*/ 02366000
         L     @01,LPARMPTR                                        0661 02367000
         LA    @14,DETFUNC-2(@15)                                  0661 02368000
         OC    CDETAIL(1,@01),0(@14)                               0661 02369000
*                   CTR=100;        /* TERMINATE THIS PORTION OF LOOP   02370000
*                                                            @Y30LB54*/ 02371000
         LA    CTR,100                                             0662 02372000
*                 END;              /*                       @Y30LB54*/ 02373000
*               ELSE                                               0664 02374000
*                 ;                 /*                       @Y30LB54*/ 02375000
@RF00659 DS    0H                                                  0665 02376000
*             END;                  /*                       @Y30LB54*/ 02377000
         AH    CTR,@CH00068                                        0665 02378000
         CH    CTR,@CH00207                                        0665 02379000
         BNH   @DL00658                                            0665 02380000
*             IF CTR^>99 THEN                                      0666 02381000
         CH    CTR,@CH00386                                        0666 02382000
         BH    @RF00666                                            0666 02383000
*               DO;                 /* INVALID INPUT DATA    @ZA00669*/ 02384000
*                 STARTPRM=0;       /* GET OUT OF LOOP       @ZA00669*/ 02385000
         SLR   @03,@03                                             0668 02386000
         ST    @03,STARTPRM                                        0668 02387000
*                 RETCODE1=8;       /* INVALID INPUT DATA    @Y30LB54*/ 02388000
         MVC   RETCODE1(4),@CF00091                                0669 02389000
*               END;                /* END ERROR SET         @ZA00669*/ 02390000
*             ELSE                                                 0671 02391000
*               CALL FNDCOMMA;      /*                       @Y30LB54*/ 02392000
         B     @RC00666                                            0671 02393000
@RF00666 BAL   @14,FNDCOMMA                                        0671 02394000
*           END;                    /*                       @Y30LB54*/ 02395000
@RC00666 DS    0H                                                  0672 02396000
@DE00657 ICM   @03,15,STARTPRM                                     0672 02397000
         BP    @DL00657                                            0672 02398000
*     END;                          /*                       @Y30LB54*/ 02399000
@RC00655 DS    0H                                                  0673 02400000
@RC00653 DS    0H                                                  0674 02401000
*   IF RETCODE1^=0 THEN                                            0674 02402000
@RC00650 ICM   @03,15,RETCODE1                                     0674 02403000
         BZ    @RF00674                                            0674 02404000
*     DO;                           /*                       @Y30LB54*/ 02405000
*       CDETAIL=DFDETAIL;           /* TAKE DEFAULTS         @Y30LB54*/ 02406000
         L     @03,LPARMPTR                                        0676 02407000
         MVC   CDETAIL(1,@03),DFDETAIL                             0676 02408000
*       RETCODE1=0;                 /* ALLOW TI TAKE DEFAULTS@Y30LB54*/ 02409000
         SLR   @03,@03                                             0677 02410000
         ST    @03,RETCODE1                                        0677 02411000
*       LINE='ISDAPARM DETAIL(ALL | NONE | 0,1,2,3,4,5) ERROR';    0678 02412000
         MVI   LINE+47(CVTPTR),C' '                                0678 02413000
         MVC   LINE+48(84,CVTPTR),LINE+47(CVTPTR)                  0678 02414000
         MVC   LINE(47,CVTPTR),@CC00488                            0678 02415000
*       CALL ISDAPRT0(WORKPTR);     /*                       @Y30LB54*/ 02416000
         L     @03,@PC00001                                        0679 02417000
         ST    @03,@AL00001                                        0679 02418000
         L     @15,@CV00037                                        0679 02419000
         LA    @01,@AL00001                                        0679 02420000
         BALR  @14,@15                                             0679 02421000
*       CALL ISDATYPE(WORKPTR);     /*                       @Y30LB54*/ 02422000
         L     @03,@PC00001                                        0680 02423000
         ST    @03,@AL00001                                        0680 02424000
         L     @15,@CV00038                                        0680 02425000
         LA    @01,@AL00001                                        0680 02426000
         BALR  @14,@15                                             0680 02427000
*     END;                          /*                       @Y30LB54*/ 02428000
*   DCL                                                            0682 02429000
*     1 DETTAB(6) STATIC LOCAL,                                    0682 02430000
*      2 DETARG CHAR(1) INIT('0','1','2','3','4','5'),             0682 02431000
*      2 DETFUNC CHAR(1) INIT('80'X,'40'X,'20'X,'10'X,'08'X,'04'X);     02432000
*   END DETCLAUS;                   /*                       @Y30LB54*/ 02433000
@EL00020 DS    0H                                                  0683 02434000
@EF00020 DS    0H                                                  0683 02435000
@ER00020 LM    @14,@12,@SA00020                                    0683 02436000
         BR    @14                                                 0683 02437000
*                                                                  0684 02438000
*   /*****************************************************************/ 02439000
*   /*                                                               */ 02440000
*   /* PERIOD(XXX)                                                   */ 02441000
*   /*                                                               */ 02442000
*   /*****************************************************************/ 02443000
*                                                                  0684 02444000
*PERCLAUS:                                                         0684 02445000
*   PROC;                           /*                       @Y30LB54*/ 02446000
PERCLAUS STM   @14,@12,@SA00021                                    0684 02447000
*   FULLWD2=ENDPRM-STARTPRM+ONE;    /* HOW MANY DIGITS       @Y30LB54*/ 02448000
         L     @03,ENDPRM                                          0685 02449000
         SL    @03,STARTPRM                                        0685 02450000
         AH    @03,@CH00068                                        0685 02451000
         ST    @03,FULLWD2                                         0685 02452000
*   IF FULLWD2^>2 THEN                                             0686 02453000
         L     @03,FULLWD2                                         0686 02454000
         CH    @03,@CH00066                                        0686 02455000
         BH    @RF00686                                            0686 02456000
*     RETCODE1=8;                   /* ERROR ON INPUT()      @Y30LB54*/ 02457000
         MVC   RETCODE1(4),@CF00091                                0687 02458000
*   ELSE                                                           0688 02459000
*     DO;                           /*                       @Y30LB54*/ 02460000
         B     @RC00686                                            0688 02461000
@RF00686 DS    0H                                                  0689 02462000
*       EBDIC5='00000';             /* CLEAR HOLDING AREA    @Y30LB54*/ 02463000
         MVC   EBDIC5(5),@CC00496                                  0689 02464000
*       IF FULLWD2=THREE THEN                                      0690 02465000
         CLC   FULLWD2(4),@CF00088                                 0690 02466000
         BNE   @RF00690                                            0690 02467000
*         EBDIC5(FIVE:FIVE)=INPUT(STARTPRM+ONE);/*           @Y30LB54*/ 02468000
         L     @03,INPTR                                           0691 02469000
         AL    @03,STARTPRM                                        0691 02470000
         MVC   EBDIC5+4(1),INPUT(@03)                              0691 02471000
*       ELSE                                                       0692 02472000
*         IF FULLWD2=FOUR THEN                                     0692 02473000
         B     @RC00690                                            0692 02474000
@RF00690 CLC   FULLWD2(4),@CF00071                                 0692 02475000
         BNE   @RF00692                                            0692 02476000
*           EBDIC5(FOUR:FIVE)=INPUT(STARTPRM+ONE:STARTPRM+TWO);    0693 02477000
         L     @03,INPTR                                           0693 02478000
         AL    @03,STARTPRM                                        0693 02479000
         MVC   EBDIC5+3(2),INPUT(@03)                              0693 02480000
*         ELSE                                                     0694 02481000
*           IF FULLWD2=FIVE THEN                                   0694 02482000
         B     @RC00692                                            0694 02483000
@RF00692 CLC   FULLWD2(4),@CF00318                                 0694 02484000
         BNE   @RF00694                                            0694 02485000
*             EBDIC5(THREE:FIVE)=INPUT(STARTPRM+ONE:STARTPRM+THREE);    02486000
         L     @03,INPTR                                           0695 02487000
         AL    @03,STARTPRM                                        0695 02488000
         MVC   EBDIC5+2(3),INPUT(@03)                              0695 02489000
*           ELSE                                                   0696 02490000
*             RETCODE1=8;           /* ERROR ON INPUT        @Y30LB54*/ 02491000
         B     @RC00694                                            0696 02492000
@RF00694 MVC   RETCODE1(4),@CF00091                                0696 02493000
*       IF EBDIC5(THREE)<'0'|EBDIC5(THREE)>'9' THEN                0697 02494000
@RC00694 DS    0H                                                  0697 02495000
@RC00692 DS    0H                                                  0697 02496000
@RC00690 CLI   EBDIC5+2,C'0'                                       0697 02497000
         BL    @RT00697                                            0697 02498000
         CLI   EBDIC5+2,C'9'                                       0697 02499000
         BNH   @RF00697                                            0697 02500000
@RT00697 DS    0H                                                  0698 02501000
*         RETCODE1=8;               /*                       @Y30LB54*/ 02502000
         MVC   RETCODE1(4),@CF00091                                0698 02503000
*       ELSE                                                       0699 02504000
*         IF EBDIC5(FOUR)<'0'|EBDIC5(FOUR)>'9' THEN                0699 02505000
         B     @RC00697                                            0699 02506000
@RF00697 CLI   EBDIC5+3,C'0'                                       0699 02507000
         BL    @RT00699                                            0699 02508000
         CLI   EBDIC5+3,C'9'                                       0699 02509000
         BNH   @RF00699                                            0699 02510000
@RT00699 DS    0H                                                  0700 02511000
*           RETCODE1=8;             /*                       @Y30LB54*/ 02512000
         MVC   RETCODE1(4),@CF00091                                0700 02513000
*         ELSE                                                     0701 02514000
*           IF EBDIC5(FIVE)<'0'|EBDIC5(FIVE)>'9' THEN              0701 02515000
         B     @RC00699                                            0701 02516000
@RF00699 CLI   EBDIC5+4,C'0'                                       0701 02517000
         BL    @RT00701                                            0701 02518000
         CLI   EBDIC5+4,C'9'                                       0701 02519000
         BNH   @RF00701                                            0701 02520000
@RT00701 DS    0H                                                  0702 02521000
*             RETCODE1=8;           /*                       @Y30LB54*/ 02522000
         MVC   RETCODE1(4),@CF00091                                0702 02523000
*           ELSE                                                   0703 02524000
*             ;                     /*                       @Y30LB54*/ 02525000
@RF00701 DS    0H                                                  0704 02526000
*       EBDIC5(FIVE)=EBDIC5(FIVE)|'F0'X;/* PROTECT PACK      @Y30LB54*/ 02527000
@RC00699 DS    0H                                                  0704 02528000
@RC00697 OI    EBDIC5+4,X'F0'                                      0704 02529000
*       PACK(EBDIC4,EBDIC5);        /* PACK DATA             @Y30LB54*/ 02530000
         PACK  EBDIC4(4),EBDIC5(5)                                 0705 02531000
*       CVB(CTR1,EBDIC4);           /* CONVERT TO BINARY     @Y30LB54*/ 02532000
         XC    @TS00001(8),@TS00001                                0706 02533000
         MVC   @TS00001+4(4),EBDIC4                                0706 02534000
         CVB   CTR1,@TS00001                                       0706 02535000
*       IF CTR1>255 THEN                                           0707 02536000
         CH    CTR1,@CH00498                                       0707 02537000
         BNH   @RF00707                                            0707 02538000
*         RETCODE1=8;               /* MORE THAN ONE BYTE WILL HOLD     02539000
*                                                            @Y30LB54*/ 02540000
         MVC   RETCODE1(4),@CF00091                                0708 02541000
*       ELSE                                                       0709 02542000
*         ;                                                /*@Y30LB54*/ 02543000
@RF00707 DS    0H                                                  0710 02544000
*       EBDIC4=CTR1;                /* MOVE IT TO SUBSTRINGABLE AREA    02545000
*                                                            @Y30LB54*/ 02546000
         ST    CTR1,EBDIC4                                         0710 02547000
*       CPERIOD=EBDIC4(FOUR);       /*                       @Y30LB54*/ 02548000
         L     @03,LPARMPTR                                        0711 02549000
         MVC   CPERIOD(1,@03),EBDIC4+3                             0711 02550000
*     END;                          /*                       @Y30LB54*/ 02551000
*   IF RETCODE1^=0 THEN                                            0713 02552000
@RC00686 SLR   @03,@03                                             0713 02553000
         C     @03,RETCODE1                                        0713 02554000
         BE    @RF00713                                            0713 02555000
*     DO;                           /*                       @Y30LB54*/ 02556000
*       RETCODE1=0;                 /*                       @Y30LB54*/ 02557000
         ST    @03,RETCODE1                                        0715 02558000
*       CPERIOD=DFPERIOD;           /* TAKE DEFAULTS         @Y30LB54*/ 02559000
         L     @03,LPARMPTR                                        0716 02560000
         MVC   CPERIOD(1,@03),DFPERIOD                             0716 02561000
*       LINE='ISDAPARM PERIOD (X | XX | XXX) ERROR';/*       @Y30LB54*/ 02562000
         MVI   LINE+36(CVTPTR),C' '                                0717 02563000
         MVC   LINE+37(95,CVTPTR),LINE+36(CVTPTR)                  0717 02564000
         MVC   LINE(36,CVTPTR),@CC00499                            0717 02565000
*       CALL ISDAPRT0(WORKPTR);     /*                       @Y30LB54*/ 02566000
         L     @03,@PC00001                                        0718 02567000
         ST    @03,@AL00001                                        0718 02568000
         L     @15,@CV00037                                        0718 02569000
         LA    @01,@AL00001                                        0718 02570000
         BALR  @14,@15                                             0718 02571000
*       CALL ISDATYPE(WORKPTR);     /*                       @Y30LB54*/ 02572000
         L     @03,@PC00001                                        0719 02573000
         ST    @03,@AL00001                                        0719 02574000
         L     @15,@CV00038                                        0719 02575000
         LA    @01,@AL00001                                        0719 02576000
         BALR  @14,@15                                             0719 02577000
*     END;                          /*                       @Y30LB54*/ 02578000
*   ELSE                                                           0721 02579000
*     ;                             /*                       @Y30LB54*/ 02580000
@RF00713 DS    0H                                                  0722 02581000
*   END PERCLAUS;                   /*                       @Y30LB54*/ 02582000
@EL00021 DS    0H                                                  0722 02583000
@EF00021 DS    0H                                                  0722 02584000
@ER00021 LM    @14,@12,@SA00021                                    0722 02585000
         BR    @14                                                 0722 02586000
*                                                                  0723 02587000
*   /*****************************************************************/ 02588000
*   /*                                                               */ 02589000
*   /* SET DEBUG FLAGS                                               */ 02590000
*   /*                                                               */ 02591000
*   /*****************************************************************/ 02592000
*                                                                  0723 02593000
*TRACLAUS:                                                         0723 02594000
*   PROC;                           /*                       @Y30LB54*/ 02595000
TRACLAUS STM   @14,@12,@SA00022                                    0723 02596000
*   FULLWD2=ENDPRM-STARTPRM+ONE;    /*                       @Y30LB54*/ 02597000
         L     @03,ENDPRM                                          0724 02598000
         SL    @03,STARTPRM                                        0724 02599000
         AH    @03,@CH00068                                        0724 02600000
         ST    @03,FULLWD2                                         0724 02601000
*   IF FULLWD2=3 THEN                                              0725 02602000
         CLC   FULLWD2(4),@CF00088                                 0725 02603000
         BNE   @RF00725                                            0725 02604000
*     INPUT(STARTPRM)='0';          /* MAKE IT TWO DIGITS    @Y30LB54*/ 02605000
         L     @03,INPTR                                           0726 02606000
         AL    @03,STARTPRM                                        0726 02607000
         AL    @03,@CF00396                                        0726 02608000
         MVI   INPUT(@03),C'0'                                     0726 02609000
*   ELSE                                                           0727 02610000
*     IF FULLWD2=4 THEN                                            0727 02611000
         B     @RC00725                                            0727 02612000
@RF00725 CLC   FULLWD2(4),@CF00071                                 0727 02613000
         BNE   @RF00727                                            0727 02614000
*       STARTPRM=STARTPRM+1;        /* MAKE IT TWO DIGITS    @Y30LB54*/ 02615000
         LA    @03,1                                               0728 02616000
         AL    @03,STARTPRM                                        0728 02617000
         ST    @03,STARTPRM                                        0728 02618000
*     ELSE                                                         0729 02619000
*       DO;                         /*                       @Y30LB54*/ 02620000
         B     @RC00727                                            0729 02621000
@RF00727 DS    0H                                                  0730 02622000
*         RETCODE1=8;               /*                       @Y30LB54*/ 02623000
         MVC   RETCODE1(4),@CF00091                                0730 02624000
*       END;                        /*                       @Y30LB54*/ 02625000
*   CTR1=2;                         /*                       @Y30LB54*/ 02626000
@RC00727 DS    0H                                                  0732 02627000
@RC00725 LA    CTR1,2                                              0732 02628000
*   CALL EBDICHEX;                  /* CONVERT TO HEX FROM EBDIC   0733 02629000
*                                                            @Y30LB54*/ 02630000
         BAL   @14,EBDICHEX                                        0733 02631000
*   IF RETCODE1^=0 THEN                                            0734 02632000
         ICM   @03,15,RETCODE1                                     0734 02633000
         BNZ   @RT00734                                            0734 02634000
*     ;                             /*                       @Y30LB54*/ 02635000
*   ELSE                                                           0736 02636000
*     DO;                           /*                       @Y30LB54*/ 02637000
*       CTRACE=LINE(ONE);           /* MOVE IN NEW VALUE     @Y30LB54*/ 02638000
         L     @03,LPARMPTR                                        0737 02639000
         MVC   CTRACE(1,@03),LINE(CVTPTR)                          0737 02640000
*     END;                          /*                       @Y30LB54*/ 02641000
*   IF RETCODE1^=0 THEN                                            0739 02642000
@RT00734 SLR   @03,@03                                             0739 02643000
         C     @03,RETCODE1                                        0739 02644000
         BE    @RF00739                                            0739 02645000
*     DO;                           /*                       @Y30LB54*/ 02646000
*       RETCODE1=0;                 /*                       @Y30LB54*/ 02647000
         ST    @03,RETCODE1                                        0741 02648000
*       CTRACE=DFTRACE;             /* MAKE IT THE DEFAULT   @Y30LB54*/ 02649000
         L     @03,LPARMPTR                                        0742 02650000
         MVC   CTRACE(1,@03),DFTRACE                               0742 02651000
*       LINE='ISDAPARM TRACE(XX) ERROR';/*                   @Y30LB54*/ 02652000
         MVI   LINE+24(CVTPTR),C' '                                0743 02653000
         MVC   LINE+25(107,CVTPTR),LINE+24(CVTPTR)                 0743 02654000
         MVC   LINE(24,CVTPTR),@CC00505                            0743 02655000
*       CALL ISDAPRT0(WORKPTR);     /* PRINT ERROR           @Y30LB54*/ 02656000
         L     @03,@PC00001                                        0744 02657000
         ST    @03,@AL00001                                        0744 02658000
         L     @15,@CV00037                                        0744 02659000
         LA    @01,@AL00001                                        0744 02660000
         BALR  @14,@15                                             0744 02661000
*       CALL ISDATYPE(WORKPTR);     /* TYPE ERROR            @Y30LB54*/ 02662000
         L     @03,@PC00001                                        0745 02663000
         ST    @03,@AL00001                                        0745 02664000
         L     @15,@CV00038                                        0745 02665000
         LA    @01,@AL00001                                        0745 02666000
         BALR  @14,@15                                             0745 02667000
*     END;                          /*                       @Y30LB54*/ 02668000
*   ELSE                                                           0747 02669000
*     ;                             /*                       @Y30LB54*/ 02670000
@RF00739 DS    0H                                                  0748 02671000
*   END TRACLAUS;                   /*                       @Y30LB54*/ 02672000
@EL00022 DS    0H                                                  0748 02673000
@EF00022 DS    0H                                                  0748 02674000
@ER00022 LM    @14,@12,@SA00022                                    0748 02675000
         BR    @14                                                 0748 02676000
*   END ISDAPARM                    /*                       @Y30LB54*/ 02677000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 02678000
*/*%INCLUDE SYSLIB  (ISDAPRMS)                                        * 02679000
*/*%INCLUDE SYSLIB  (ISDACVT )                                        * 02680000
*;                                                                 0749 02681000
@DATA    DS    0H                                                       02682000
@CH00066 DC    H'2'                                                     02683000
@CH00264 DC    H'14'                                                    02684000
@CH00205 DC    H'15'                                                    02685000
@CH00214 DC    H'16'                                                    02686000
@CH00331 DC    H'80'                                                    02687000
@CH00386 DC    H'99'                                                    02688000
@CH00327 DC    H'200'                                                   02689000
@CH00498 DC    H'255'                                                   02690000
@SM00508 MVC   INPUT(0,@03),0(@14)                                      02691000
@SM00510 MVC   LINE(0,CVTPTR),INPUT(@01)                                02692000
@SM00512 MVC   CSERIAL(0,@03),INPUT(@01)                                02693000
@DATD    DSECT                                                          02694000
         DS    0F                                                       02695000
@SA00001 DS    18F                                                      02696000
@PC00001 DS    1F                                                       02697000
@SA00002 DS    15F                                                      02698000
@SA00009 DS    15F                                                      02699000
@SA00022 DS    15F                                                      02700000
@SA00014 DS    15F                                                      02701000
@SA00015 DS    15F                                                      02702000
@SA00018 DS    15F                                                      02703000
@SA00019 DS    15F                                                      02704000
@SA00020 DS    15F                                                      02705000
@SA00006 DS    15F                                                      02706000
@SA00003 DS    15F                                                      02707000
@SA00017 DS    0F                                                       02708000
@SA00016 DS    0F                                                       02709000
@SA00013 DS    0F                                                       02710000
@SA00012 DS    0F                                                       02711000
@SA00021 DS    0F                                                       02712000
@SA00011 DS    0F                                                       02713000
@SA00010 DS    0F                                                       02714000
         DS    15F                                                      02715000
@AL00001 DS    1A                                                       02716000
ISDAPARM CSECT                                                          02717000
         DS    0F                                                       02718000
@CF00068 DC    F'1'                                                     02719000
@CH00068 EQU   @CF00068+2                                               02720000
@CF00088 DC    F'3'                                                     02721000
@CF00071 DC    F'4'                                                     02722000
@CH00071 EQU   @CF00071+2                                               02723000
@CF00318 DC    F'5'                                                     02724000
@CH00318 EQU   @CF00318+2                                               02725000
@CF00207 DC    F'6'                                                     02726000
@CH00207 EQU   @CF00207+2                                               02727000
@CF00408 DC    F'7'                                                     02728000
@CF00091 DC    F'8'                                                     02729000
@CF00441 DC    F'10'                                                    02730000
@CF00034 DC    F'12'                                                    02731000
@CH00034 EQU   @CF00034+2                                               02732000
@CF00360 DC    F'81'                                                    02733000
@CF00396 DC    F'-1'                                                    02734000
@DATD    DSECT                                                          02735000
         DS    0D                                                       02736000
RETCODE  DS    F                                                        02737000
INPTR    DS    A                                                        02738000
INPTR1   DS    A                                                        02739000
STARTINP DS    F                                                        02740000
ENDINP   DS    F                                                        02741000
STARTTXT DS    F                                                        02742000
ENDTXT   DS    F                                                        02743000
STARTPRM DS    F                                                        02744000
ENDPRM   DS    F                                                        02745000
CHAR1    DS    F                                                        02746000
CHARL    DS    F                                                        02747000
RETCODE1 DS    F                                                        02748000
FULLWD2  DS    F                                                        02749000
LPARMPTR DS    A                                                        02750000
         DS    0D                                                       02751000
@TS00001 DS    CL8                                                      02752000
EBDIC4   DS    CL4                                                      02753000
EBDIC5   DS    CL5                                                      02754000
         DS    CL3                                                      02755000
WORKBUF  DS    CL200                                                    02756000
CARD     DS    CL80                                                     02757000
         ORG   CARD                                                     02758000
@NM00007 DS    CL80                                                     02759000
         ORG   CARD+80                                                  02760000
ISDAPARM CSECT                                                          02761000
         DS    0F                                                       02762000
@SIZDATD DC    AL1(0)                                                   02763000
         DC    AL3(@ENDDATD-@DATD)                                      02764000
@CV00037 DC    V(ISDAPRT0)                                              02765000
@CV00038 DC    V(ISDATYPE)                                              02766000
         DS    0D                                                       02767000
@CC00467 DC    C'ISDAPARM INCLUDE(DCS,PAD,SUM,DHE,DHU,FSC,EQC,DCK,TLX,CC02768000
               SB,CSF,DAT,DRC,APR,SUU) ERROR'                           02769000
@CC00476 DC    C'ISDAPARM EXCLUDE(DCS,PAD,SUM,DHE,DHU,FSC,EQC,DCK,TLX,CC02770000
               SB,CSF,DAT,DRC,APR,SUU) ERROR'                           02771000
@CC00488 DC    C'ISDAPARM DETAIL(ALL | NONE | 0,1,2,3,4,5) ERROR'       02772000
@CC00348 DC    C'ISDAPARM ENTER PARAMETERS AT THIS POINT'               02773000
@CC00429 DC    C'ISDAPARM DEVTYPE(SA|RC|RD|CS|DA) ERROR'                02774000
@CC00442 DC    C'ISDAPARM FSCODE(XXXXXXXX | XXXX) ERROR'                02775000
@CC00402 DC    C'ISDAPARM INPUT(HISTORY,LOGREC) ERROR'                  02776000
@CC00499 DC    C'ISDAPARM PERIOD (X | XX | XXX) ERROR'                  02777000
@CC00461 DC    C'ISDAPARM CSN(XXXYYYYYYYYY) ERROR'                      02778000
@CC00410 DC    C'ISDAPARM STARTDATE(YYDDD) ERROR'                       02779000
@CC00422 DC    C'ISDAPARM SUMMARY(YES|NO) ERROR'                        02780000
@CC00416 DC    C'ISDAPARM ENDDATE(YYDDD) ERROR'                         02781000
@CC00383 DC    C'ISDAPARM DELIMITER ERRORS'                             02782000
@CC00448 DC    C'ISDAPARM SSID(XXX) ERROR '                             02783000
@CC00456 DC    C'ISDAPARM RATIO(XX) ERROR'                              02784000
@CC00505 DC    C'ISDAPARM TRACE(XX) ERROR'                              02785000
@CC00387 DC    C'ISDAPARM KEYWORD ERROR'                                02786000
@CC00357 DC    C'ENTER NEXT LINE '                                      02787000
@CC00496 DC    C'00000'                                                 02788000
@CC00454 EQU   @CC00496                                                 02789000
@CC00455 DC    C'99'                                                    02790000
@CB00122 DC    X'00000000'                                              02791000
         DS    CL3                                                      02792000
SDAPARM0 DS    CL49                                                     02793000
         ORG   SDAPARM0                                                 02794000
DFINPUT  DS    CL2                                                      02795000
         ORG   DFINPUT                                                  02796000
DFLOGIN  DC    CL1'Y'                                                   02797000
DFHISTIN DC    CL1'Y'                                                   02798000
         ORG   SDAPARM0+2                                               02799000
DFSTART  DC    X'0000000F'                                              02800000
DFEND    DC    X'0000000F'                                              02801000
DFSUMMAR DC    CL1'N'                                                   02802000
DFTYPE   DC    CL2'  '                                                  02803000
DFFSCONL DC    X'00000000'                                              02804000
DFSSIDF  DC    X'0000'                                                  02805000
         ORG   DFSSIDF                                                  02806000
@NM00003 DS    BL1                                                      02807000
DFSSID   EQU   DFSSIDF+0                                                02808000
         ORG   SDAPARM0+19                                              02809000
DFRATIO  DC    X'F0F0'                                                  02810000
DFSERIAL DC    CL12' '                                                  02811000
         ORG   DFSERIAL                                                 02812000
DFIBM    DS    CL3                                                      02813000
@NM00004 DS    CL1                                                      02814000
DFSERNO  DS    CL8                                                      02815000
         ORG   SDAPARM0+33                                              02816000
DFREPORT DS    CL12                                                     02817000
         ORG   DFREPORT                                                 02818000
DFDCS    DC    X'01'                                                    02819000
DFPAD    DC    X'01'                                                    02820000
DFSUM    DC    X'03'                                                    02821000
DFDHEDHU DC    X'03'                                                    02822000
DFFSC    DC    X'01'                                                    02823000
DFEQC    DC    X'01'                                                    02824000
DFDCKTLX DC    X'03'                                                    02825000
DFCSBCSF DC    X'03'                                                    02826000
DFDAT    DC    X'01'                                                    02827000
DFDRC    DC    X'01'                                                    02828000
DFAPR    DC    X'03'                                                    02829000
DFPWR    DC    X'00'                                                    02830000
         ORG   SDAPARM0+45                                              02831000
DFPERIOD DC    XL1'00'                                                  02832000
DFDETAIL DC    X'00'                                                    02833000
DFGEN    DC    X'00'                                                    02834000
DFTRACE  DC    X'00'                                                    02835000
         ORG   SDAPARM0+49                                              02836000
         DS    CL3                                                      02837000
FFEE     DC    X'7FFFFFEE'                                              02838000
PATCH    DC    50X'00'                                                  02839000
TBLCVT   DS    CL4                                                      02840000
         ORG   TBLCVT+0                                                 02841000
EBDIC    DC    CL1'0'                                                   02842000
HEXTOP   DC    X'00'                                                    02843000
HEXBOT   DC    X'00'                                                    02844000
@NM00005 DC    X'00'                                                    02845000
         ORG   TBLCVT+4                                                 02846000
         ORG   TBLCVT+4                                                 02847000
         DC    CL1'1'                                                   02848000
         DC    X'10'                                                    02849000
         DC    X'01'                                                    02850000
         DC    X'00'                                                    02851000
         ORG   TBLCVT+8                                                 02852000
         ORG   TBLCVT+8                                                 02853000
         DC    CL1'2'                                                   02854000
         DC    X'20'                                                    02855000
         DC    X'02'                                                    02856000
         DC    X'00'                                                    02857000
         ORG   TBLCVT+12                                                02858000
         ORG   TBLCVT+12                                                02859000
         DC    CL1'3'                                                   02860000
         DC    X'30'                                                    02861000
         DC    X'03'                                                    02862000
         DC    X'00'                                                    02863000
         ORG   TBLCVT+16                                                02864000
         ORG   TBLCVT+16                                                02865000
         DC    CL1'4'                                                   02866000
         DC    X'40'                                                    02867000
         DC    X'04'                                                    02868000
         DC    X'00'                                                    02869000
         ORG   TBLCVT+20                                                02870000
         ORG   TBLCVT+20                                                02871000
         DC    CL1'5'                                                   02872000
         DC    X'50'                                                    02873000
         DC    X'05'                                                    02874000
         DC    X'00'                                                    02875000
         ORG   TBLCVT+24                                                02876000
         ORG   TBLCVT+24                                                02877000
         DC    CL1'6'                                                   02878000
         DC    X'60'                                                    02879000
         DC    X'06'                                                    02880000
         DC    X'00'                                                    02881000
         ORG   TBLCVT+28                                                02882000
         ORG   TBLCVT+28                                                02883000
         DC    CL1'7'                                                   02884000
         DC    X'70'                                                    02885000
         DC    X'07'                                                    02886000
         DC    X'00'                                                    02887000
         ORG   TBLCVT+32                                                02888000
         ORG   TBLCVT+32                                                02889000
         DC    CL1'8'                                                   02890000
         DC    X'80'                                                    02891000
         DC    X'08'                                                    02892000
         DC    X'00'                                                    02893000
         ORG   TBLCVT+36                                                02894000
         ORG   TBLCVT+36                                                02895000
         DC    CL1'9'                                                   02896000
         DC    X'90'                                                    02897000
         DC    X'09'                                                    02898000
         DC    X'00'                                                    02899000
         ORG   TBLCVT+40                                                02900000
         ORG   TBLCVT+40                                                02901000
         DC    CL1'A'                                                   02902000
         DC    X'A0'                                                    02903000
         DC    X'0A'                                                    02904000
         DC    X'00'                                                    02905000
         ORG   TBLCVT+44                                                02906000
         ORG   TBLCVT+44                                                02907000
         DC    CL1'B'                                                   02908000
         DC    X'B0'                                                    02909000
         DC    X'0B'                                                    02910000
         DC    X'00'                                                    02911000
         ORG   TBLCVT+48                                                02912000
         ORG   TBLCVT+48                                                02913000
         DC    CL1'C'                                                   02914000
         DC    X'C0'                                                    02915000
         DC    X'0C'                                                    02916000
         DC    X'00'                                                    02917000
         ORG   TBLCVT+52                                                02918000
         ORG   TBLCVT+52                                                02919000
         DC    CL1'D'                                                   02920000
         DC    X'D0'                                                    02921000
         DC    X'0D'                                                    02922000
         DC    X'00'                                                    02923000
         ORG   TBLCVT+56                                                02924000
         ORG   TBLCVT+56                                                02925000
         DC    CL1'E'                                                   02926000
         DC    X'E0'                                                    02927000
         DC    X'0E'                                                    02928000
         DC    X'00'                                                    02929000
         ORG   TBLCVT+60                                                02930000
         ORG   TBLCVT+60                                                02931000
         DC    CL1'F'                                                   02932000
         DC    X'F0'                                                    02933000
         DC    X'0F'                                                    02934000
         DC    X'00'                                                    02935000
         ORG   TBLCVT+64                                                02936000
         DS    CL2                                                      02937000
KEYTABLE DS    CL8                                                      02938000
         ORG   KEYTABLE+0                                               02939000
KEYARG   DC    CL3'INP'                                                 02940000
@NM00006 DS    CL1                                                      02941000
KEYFUNC  DC    AL4(INPCLAUS)                                            02942000
         ORG   KEYTABLE+8                                               02943000
         ORG   KEYTABLE+8                                               02944000
         DC    CL3'STA'                                                 02945000
         DS    CL1                                                      02946000
         DC    AL4(STACLAUS)                                            02947000
         ORG   KEYTABLE+16                                              02948000
         ORG   KEYTABLE+16                                              02949000
         DC    CL3'END'                                                 02950000
         DS    CL1                                                      02951000
         DC    AL4(ENDCLAUS)                                            02952000
         ORG   KEYTABLE+24                                              02953000
         ORG   KEYTABLE+24                                              02954000
         DC    CL3'PER'                                                 02955000
         DS    CL1                                                      02956000
         DC    AL4(PERCLAUS)                                            02957000
         ORG   KEYTABLE+32                                              02958000
         ORG   KEYTABLE+32                                              02959000
         DC    CL3'SUM'                                                 02960000
         DS    CL1                                                      02961000
         DC    AL4(SUMCLAUS)                                            02962000
         ORG   KEYTABLE+40                                              02963000
         ORG   KEYTABLE+40                                              02964000
         DC    CL3'DEV'                                                 02965000
         DS    CL1                                                      02966000
         DC    AL4(DEVCLAUS)                                            02967000
         ORG   KEYTABLE+48                                              02968000
         ORG   KEYTABLE+48                                              02969000
         DC    CL3'FSC'                                                 02970000
         DS    CL1                                                      02971000
         DC    AL4(FSCCLAUS)                                            02972000
         ORG   KEYTABLE+56                                              02973000
         ORG   KEYTABLE+56                                              02974000
         DC    CL3'SSI'                                                 02975000
         DS    CL1                                                      02976000
         DC    AL4(SSICLAUS)                                            02977000
         ORG   KEYTABLE+64                                              02978000
         ORG   KEYTABLE+64                                              02979000
         DC    CL3'RAT'                                                 02980000
         DS    CL1                                                      02981000
         DC    AL4(RATCLAUS)                                            02982000
         ORG   KEYTABLE+72                                              02983000
         ORG   KEYTABLE+72                                              02984000
         DC    CL3'CSN'                                                 02985000
         DS    CL1                                                      02986000
         DC    AL4(CSNCLAUS)                                            02987000
         ORG   KEYTABLE+80                                              02988000
         ORG   KEYTABLE+80                                              02989000
         DC    CL3'INC'                                                 02990000
         DS    CL1                                                      02991000
         DC    AL4(INCCLAUS)                                            02992000
         ORG   KEYTABLE+88                                              02993000
         ORG   KEYTABLE+88                                              02994000
         DC    CL3'EXC'                                                 02995000
         DS    CL1                                                      02996000
         DC    AL4(EXCCLAUS)                                            02997000
         ORG   KEYTABLE+96                                              02998000
         ORG   KEYTABLE+96                                              02999000
         DC    CL3'DET'                                                 03000000
         DS    CL1                                                      03001000
         DC    AL4(DETCLAUS)                                            03002000
         ORG   KEYTABLE+104                                             03003000
         ORG   KEYTABLE+104                                             03004000
         DC    CL3'TRA'                                                 03005000
         DS    CL1                                                      03006000
         DC    AL4(TRACLAUS)                                            03007000
         ORG   KEYTABLE+112                                             03008000
RPTTBL   DS    CL8                                                      03009000
         ORG   RPTTBL+0                                                 03010000
RPTARG   DC    CL3'DCS'                                                 03011000
RPTFUNCH DC    X'01'                                                    03012000
RPTFUNCA DC    AL4(CDCS)                                                03013000
         ORG   RPTTBL+8                                                 03014000
         ORG   RPTTBL+8                                                 03015000
         DC    CL3'PAD'                                                 03016000
         DC    X'01'                                                    03017000
         DC    AL4(CPAD)                                                03018000
         ORG   RPTTBL+16                                                03019000
         ORG   RPTTBL+16                                                03020000
         DC    CL3'SUM'                                                 03021000
         DC    X'01'                                                    03022000
         DC    AL4(CSUM)                                                03023000
         ORG   RPTTBL+24                                                03024000
         ORG   RPTTBL+24                                                03025000
         DC    CL3'DHE'                                                 03026000
         DC    X'01'                                                    03027000
         DC    AL4(CDHEDHU)                                             03028000
         ORG   RPTTBL+32                                                03029000
         ORG   RPTTBL+32                                                03030000
         DC    CL3'DHU'                                                 03031000
         DC    X'02'                                                    03032000
         DC    AL4(CDHEDHU)                                             03033000
         ORG   RPTTBL+40                                                03034000
         ORG   RPTTBL+40                                                03035000
         DC    CL3'FSC'                                                 03036000
         DC    X'01'                                                    03037000
         DC    AL4(CFSC)                                                03038000
         ORG   RPTTBL+48                                                03039000
         ORG   RPTTBL+48                                                03040000
         DC    CL3'EQC'                                                 03041000
         DC    X'01'                                                    03042000
         DC    AL4(CEQC)                                                03043000
         ORG   RPTTBL+56                                                03044000
         ORG   RPTTBL+56                                                03045000
         DC    CL3'DCK'                                                 03046000
         DC    X'01'                                                    03047000
         DC    AL4(CDCKTLX)                                             03048000
         ORG   RPTTBL+64                                                03049000
         ORG   RPTTBL+64                                                03050000
         DC    CL3'TLX'                                                 03051000
         DC    X'02'                                                    03052000
         DC    AL4(CDCKTLX)                                             03053000
         ORG   RPTTBL+72                                                03054000
         ORG   RPTTBL+72                                                03055000
         DC    CL3'CSB'                                                 03056000
         DC    X'01'                                                    03057000
         DC    AL4(CCSBCSF)                                             03058000
         ORG   RPTTBL+80                                                03059000
         ORG   RPTTBL+80                                                03060000
         DC    CL3'CSF'                                                 03061000
         DC    X'02'                                                    03062000
         DC    AL4(CCSBCSF)                                             03063000
         ORG   RPTTBL+88                                                03064000
         ORG   RPTTBL+88                                                03065000
         DC    CL3'DAT'                                                 03066000
         DC    X'01'                                                    03067000
         DC    AL4(CDAT)                                                03068000
         ORG   RPTTBL+96                                                03069000
         ORG   RPTTBL+96                                                03070000
         DC    CL3'DRC'                                                 03071000
         DC    X'01'                                                    03072000
         DC    AL4(CDRC)                                                03073000
         ORG   RPTTBL+104                                               03074000
         ORG   RPTTBL+104                                               03075000
         DC    CL3'APR'                                                 03076000
         DC    X'01'                                                    03077000
         DC    AL4(CAPRSUU)                                             03078000
         ORG   RPTTBL+112                                               03079000
         ORG   RPTTBL+112                                               03080000
         DC    CL3'SUU'                                                 03081000
         DC    X'02'                                                    03082000
         DC    AL4(CAPRSUU)                                             03083000
         ORG   RPTTBL+120                                               03084000
DEVTAB   DS    CL2                                                      03085000
         ORG   DEVTAB+0                                                 03086000
DEVARG   DC    CL2'SA'                                                  03087000
         ORG   DEVTAB+2                                                 03088000
         ORG   DEVTAB+2                                                 03089000
         DC    CL2'RC'                                                  03090000
         ORG   DEVTAB+4                                                 03091000
         ORG   DEVTAB+4                                                 03092000
         DC    CL2'RD'                                                  03093000
         ORG   DEVTAB+6                                                 03094000
         ORG   DEVTAB+6                                                 03095000
         DC    CL2'CS'                                                  03096000
         ORG   DEVTAB+8                                                 03097000
         ORG   DEVTAB+8                                                 03098000
         DC    CL2'DA'                                                  03099000
         ORG   DEVTAB+10                                                03100000
DETTAB   DS    CL2                                                      03101000
         ORG   DETTAB+0                                                 03102000
DETARG   DC    CL1'0'                                                   03103000
DETFUNC  DC    X'80'                                                    03104000
         ORG   DETTAB+2                                                 03105000
         ORG   DETTAB+2                                                 03106000
         DC    CL1'1'                                                   03107000
         DC    X'40'                                                    03108000
         ORG   DETTAB+4                                                 03109000
         ORG   DETTAB+4                                                 03110000
         DC    CL1'2'                                                   03111000
         DC    X'20'                                                    03112000
         ORG   DETTAB+6                                                 03113000
         ORG   DETTAB+6                                                 03114000
         DC    CL1'3'                                                   03115000
         DC    X'10'                                                    03116000
         ORG   DETTAB+8                                                 03117000
         ORG   DETTAB+8                                                 03118000
         DC    CL1'4'                                                   03119000
         DC    X'08'                                                    03120000
         ORG   DETTAB+10                                                03121000
         ORG   DETTAB+10                                                03122000
         DC    CL1'5'                                                   03123000
         DC    X'04'                                                    03124000
         ORG   DETTAB+12                                                03125000
@DATD    DSECT                                                          03126000
*                                                         /*@Y30LB54*/  03127000
OPENLIST OPEN (0,INPUT),MF=L                                            03128000
@DATD    DSECT                                                          03129000
*                                                         /*@Y30LB54*/  03130000
CLOSLIST CLOSE (0),MF=L                                                 03131000
ISDAPARM CSECT                                                          03132000
*                                                         /*@Y30LB54*/  03133000
DCBSTAT  DCB   DSORG=PS,MACRF=GM,DDNAME=SYSIN,LRECL=80,EODAD=EOF,     XX03134000
               RECFM=FB,SYNAD=EOD                                       03135000
ISDAPARM CSECT                                                          03136000
*                                                         /*@Y30LB54*/  03137000
OPENSTAT OPEN (0,INPUT),MF=L                                            03138000
ISDAPARM CSECT                                                          03139000
*                                                         /*@Y30LB54*/  03140000
CLOSSTAT CLOSE (0),MF=L                                                 03141000
@DATD    DSECT                                                          03142000
*                                                         /*@Y30LB54*/  03143000
SYSINDCB DCB   DSORG=PS,MACRF=GM,DDNAME=SYSIN,LRECL=80,EODAD=EOF,     XX03144000
               RECFM=FB,SYNAD=EOD                                       03145000
OFLAGS   EQU   SYSINDCB+48                                              03146000
@DATD    DSECT                                                          03147000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                03148000
@ENDDATD EQU   *                                                        03149000
ISDAPARM CSECT                                                          03150000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       03151000
@01      EQU   01                                                       03152000
@02      EQU   02                                                       03153000
@03      EQU   03                                                       03154000
@04      EQU   04                                                       03155000
@05      EQU   05                                                       03156000
@06      EQU   06                                                       03157000
@07      EQU   07                                                       03158000
@08      EQU   08                                                       03159000
@09      EQU   09                                                       03160000
@10      EQU   10                                                       03161000
@11      EQU   11                                                       03162000
@12      EQU   12                                                       03163000
@13      EQU   13                                                       03164000
@14      EQU   14                                                       03165000
@15      EQU   15                                                       03166000
POINTADD EQU   @04                                                      03167000
CTR1     EQU   @04                                                      03168000
CTR      EQU   @03                                                      03169000
CVTPTR   EQU   @02                                                      03170000
CONDCODE EQU   @15                                                      03171000
R6       EQU   @06                                                      03172000
ISDAPRMS EQU   0                                                        03173000
CINPUT   EQU   ISDAPRMS                                                 03174000
CLOGIN   EQU   CINPUT                                                   03175000
CHISTIN  EQU   CINPUT+1                                                 03176000
CSTART   EQU   ISDAPRMS+2                                               03177000
CEND     EQU   ISDAPRMS+6                                               03178000
CSUMMARY EQU   ISDAPRMS+10                                              03179000
CTYPE    EQU   ISDAPRMS+11                                              03180000
CFSCONLY EQU   ISDAPRMS+13                                              03181000
CSSIDF   EQU   ISDAPRMS+17                                              03182000
CRATIO   EQU   ISDAPRMS+19                                              03183000
CSERIAL  EQU   ISDAPRMS+21                                              03184000
CREPORTS EQU   ISDAPRMS+33                                              03185000
CDCS     EQU   CREPORTS                                                 03186000
CPAD     EQU   CREPORTS+1                                               03187000
CSUM     EQU   CREPORTS+2                                               03188000
CDHEDHU  EQU   CREPORTS+3                                               03189000
CFSC     EQU   CREPORTS+4                                               03190000
CEQC     EQU   CREPORTS+5                                               03191000
CDCKTLX  EQU   CREPORTS+6                                               03192000
CCSBCSF  EQU   CREPORTS+7                                               03193000
CDAT     EQU   CREPORTS+8                                               03194000
CDRC     EQU   CREPORTS+9                                               03195000
CAPRSUU  EQU   CREPORTS+10                                              03196000
CPERIOD  EQU   ISDAPRMS+45                                              03197000
CDETAIL  EQU   ISDAPRMS+46                                              03198000
CGEN     EQU   ISDAPRMS+47                                              03199000
CTRACE   EQU   ISDAPRMS+48                                              03200000
ISDACVT  EQU   0                                                        03201000
CVTPTRS0 EQU   ISDACVT                                                  03202000
PARMPTR  EQU   CVTPTRS0+8                                               03203000
PARM0PTR EQU   CVTPTRS0+16                                              03204000
GET0CALL EQU   ISDACVT+100                                              03205000
SPNOLEN  EQU   GET0CALL                                                 03206000
HEXPCALL EQU   ISDACVT+108                                              03207000
PRT0CALL EQU   ISDACVT+120                                              03208000
OUTLINE  EQU   PRT0CALL                                                 03209000
ANSI     EQU   OUTLINE                                                  03210000
LINE     EQU   OUTLINE+1                                                03211000
SDADATD  EQU   ISDACVT+256                                              03212000
PRTDATD  EQU   ISDACVT+416                                              03213000
INPUT    EQU   0                                                        03214000
JCLAREA  EQU   0                                                        03215000
WORKPTR  EQU   0                                                        03216000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    03217000
PRTSA001 EQU   PRTDATD                                                  03218000
SDATEMPS EQU   SDADATD+136                                              03219000
SDASA002 EQU   SDADATD+76                                               03220000
SDAPC001 EQU   SDADATD+72                                               03221000
SDASA001 EQU   SDADATD                                                  03222000
SDARPTID EQU   PRT0CALL+133                                             03223000
DUMPIDNO EQU   HEXPCALL+8                                               03224000
DUMPLEN  EQU   HEXPCALL+4                                               03225000
DUMPADDR EQU   HEXPCALL                                                 03226000
COREADDR EQU   GET0CALL+4                                               03227000
CORELEN  EQU   SPNOLEN+1                                                03228000
SPNO     EQU   SPNOLEN                                                  03229000
WORKCALL EQU   CVTPTRS0+96                                              03230000
GEN00PTR EQU   CVTPTRS0+92                                              03231000
CNFG0PTR EQU   CVTPTRS0+88                                              03232000
PWR00PTR EQU   CVTPTRS0+84                                              03233000
APR00PTR EQU   CVTPTRS0+80                                              03234000
DRC00PTR EQU   CVTPTRS0+76                                              03235000
DAT00PTR EQU   CVTPTRS0+72                                              03236000
CSB00PTR EQU   CVTPTRS0+68                                              03237000
DCK00PTR EQU   CVTPTRS0+64                                              03238000
EQC00PTR EQU   CVTPTRS0+60                                              03239000
FSC00PTR EQU   CVTPTRS0+56                                              03240000
DHE00PTR EQU   CVTPTRS0+52                                              03241000
SUM00PTR EQU   CVTPTRS0+48                                              03242000
PAD00PTR EQU   CVTPTRS0+44                                              03243000
DCS00PTR EQU   CVTPTRS0+40                                              03244000
LOG00PTR EQU   CVTPTRS0+36                                              03245000
HIST0PTR EQU   CVTPTRS0+32                                              03246000
PRT00PTR EQU   CVTPTRS0+28                                              03247000
GET00PTR EQU   CVTPTRS0+24                                              03248000
TYPE0PTR EQU   CVTPTRS0+20                                              03249000
SDA00PTR EQU   CVTPTRS0+12                                              03250000
SDATAPTR EQU   CVTPTRS0+4                                               03251000
DATAPTR  EQU   CVTPTRS0                                                 03252000
CPWR     EQU   CREPORTS+11                                              03253000
CSERNO   EQU   CSERIAL+4                                                03254000
@NM00002 EQU   CSERIAL+3                                                03255000
CIBM     EQU   CSERIAL                                                  03256000
CSSID    EQU   CSSIDF                                                   03257000
@NM00001 EQU   CSSIDF                                                   03258000
CFSC34   EQU   CFSCONLY+2                                               03259000
CFSC12   EQU   CFSCONLY                                                 03260000
CENDDAY  EQU   CEND+2                                                   03261000
CENDYEAR EQU   CEND                                                     03262000
CSTDAY   EQU   CSTART+2                                                 03263000
CSTYEAR  EQU   CSTART                                                   03264000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      03265000
@RC00196 EQU   @RC00193                                                 03266000
@RT00267 EQU   @EL00005                                                 03267000
@RF00342 EQU   @EL00007                                                 03268000
@RC00393 EQU   @RC00389                                                 03269000
@RC00404 EQU   @RC00400                                                 03270000
@RC00570 EQU   @EL00017                                                 03271000
@RF00604 EQU   @EL00018                                                 03272000
@RF00638 EQU   @EL00019                                                 03273000
@RF00674 EQU   @EL00020                                                 03274000
@RC00394 EQU   @RC00393                                                 03275000
@RC00405 EQU   @RC00404                                                 03276000
@ENDDATA EQU   *                                                        03277000
         END   ISDAPARM,(C'PLS0137',0603,75313)                         03278000
