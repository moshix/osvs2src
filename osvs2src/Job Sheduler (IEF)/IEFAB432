         TITLE 'IEFAB432 - AFFINITY PROCESSOR                          *00001000
                        '                                               00002000
IEFAB432 CSECT ,                                                01S0001 00003000
@MAINENT DS    0H                                               01S0001 00004000
         USING *,@15                                            01S0001 00005000
         B     @PROLOG                                          01S0001 00006000
         DC    AL1(16)                                          01S0001 00007000
         DC    C'IEFAB432  75.329'                              01S0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                  01S0001 00010000
         BALR  @12,0                                            01S0001 00011000
@PSTART  DS    0H                                               01S0001 00012000
         USING @PSTART,@12                                      01S0001 00013000
         L     @00,@SIZDATD                                     01S0001 00014000
         MODESET EXTKEY=SCHED,SAVEKEY=(2)                               00015000
         GSPACE   R,LV=(0)                                              00016000
         LR    @11,@01                                          01S0001 00017000
         USING @DATD,@11                                        01S0001 00018000
         ST    @13,@SA00001+4                                   01S0001 00019000
         STC   @02,@OLDKEY                                      01S0001 00020000
         MODESET KEYADDR=(2)                                            00021000
         LM    @00,@02,20(@13)                                  01S0001 00022000
         ST    @11,8(,@13)                                      01S0001 00023000
         LR    @13,@11                                          01S0001 00024000
         MODESET EXTKEY=ZERO                                            00025000
         MVC   @PC00001(20),0(@01)                              01S0001 00026000
         MODESET EXTKEY=SCHED                                           00027000
*RETCODE = NOERROR;                    /*INITIALIZE RETURN CODE      */ 00028000
         SLR   RETCODE,RETCODE                                  01S0046 00029000
*NUMVUENT = VOLUNSZE/VOLENTLN;         /*NO. OF VOLUNIT ENTRIES      */ 00030000
         L     @10,@PC00001+12                                  01S0047 00031000
         L     @10,ALCWAPTR(,@10)                               01S0047 00032000
         L     @00,VOLUNSZE(,@10)                               01S0047 00033000
         SRDA  @00,32                                           01S0047 00034000
         D     @00,VOLENTLN                                     01S0047 00035000
         LR    NUMVUENT,@01                                     01S0047 00036000
*AFFVUPTR = VOLUNPTR;                  /*PTR TO 1ST VOLUMIT ENTRY    */ 00037000
         MVC   AFFVUPTR(4),VOLUNPTR(@10)                        01S0048 00038000
*  DO AVUCTR = ONE TO NUMVUENT         /*SCAN VOLUNIT ENTRIES        */ 00039000
*    WHILE(RETCODE=NOERROR);                                    01S0049 00040000
         LA    AVUCTR,1                                         01S0049 00041000
         B     @DE00049                                         01S0049 00042000
@DL00049 LTR   RETCODE,RETCODE                                  01S0049 00043000
         BNZ   @DC00049                                         01S0049 00044000
*      IF VOLUNTID = AFFVUPTR->VOLUNTID & /*UNIT ID MATCH?           */ 00045000
*         AFFVUPTR ^= VUPTR THEN       /*AND NOT ENT JUST ALLOCATED? */ 00046000
         L     @10,@PC00001+4                                   01S0050 00047000
         L     @10,VUPTR(,@10)                                  01S0050 00048000
         L     @04,AFFVUPTR                                     01S0050 00049000
         CLC   VOLUNTID(2,@10),VOLUNTID(@04)                    01S0050 00050000
         BNE   @RF00050                                         01S0050 00051000
         CR    @04,@10                                          01S0050 00052000
         BE    @RF00050                                         01S0050 00053000
*        DO;                             /*YES                       */ 00054000
*          SIOTPTR = AFFVUPTR->VOLSIOTP; /*PT TO SIOT OF VU ENTRY    */ 00055000
         MVC   SIOTPTR(4),VOLSIOTP(@04)                         01S0052 00056000
*          IF VOLID = AFFVUPTR->VOLID THEN  /*VOLID MATCH?           */ 00057000
         CLC   VOLID(6,@10),VOLID(@04)                          01S0053 00058000
         BNE   @RF00053                                         01S0053 00059000
*            DO;                       /*YES                         */ 00060000
*              CALL FINDEDL2;          /*CHECK IF DEV TYPES MATCH    */ 00061000
         BAL   @14,FINDEDL2                                     01S0055 00062000
*              IF RETCODE = NOERROR &  /*ANY ERRORS?                 */ 00063000
*                 AFFVUPTR->VDEVREQD=ON THEN  /*AND DEVICE REQUIRED? */ 00064000
         LTR   RETCODE,RETCODE                                  01S0056 00065000
         BNZ   @RF00056                                         01S0056 00066000
         L     @10,AFFVUPTR                                     01S0056 00067000
         TM    VDEVREQD(@10),B'00100000'                        01S0056 00068000
         BNO   @RF00056                                         01S0056 00069000
*                CALL AFFPROC;         /*YES, ALLOCATE REQUEST       */ 00070000
         BAL   @14,AFFPROC                                      01S0057 00071000
*            END;                                               01S0058 00072000
*          ELSE                        /*UNITID BUT NOT VOLID MATCH  */ 00073000
*            DO;                                                01S0059 00074000
         B     @RC00053                                         01S0059 00075000
@RF00053 DS    0H                                               01S0060 00076000
*              IF (AFFVUPTR->VOLID(1) ^= NONSPDA & /*NOT NONSPECIF DA*/ 00077000
*                  AFFVUPTR->VOLID(1) ^= NONSPTAP) | /*NO NONSPEC TAP*/ 00078000
*                 (AFFVUPTR->VOLID(1) = NONSPTAP & /*NON-SPECIF TAPE */ 00079000
*                 SCTSNEW=OFF) THEN      /*NOT NEW DISPOSITION       */ 00080000
         L     @10,AFFVUPTR                                     01S0060 00081000
         CLI   VOLID(@10),X'FE'                                 01S0060 00082000
         BE    @GL00003                                         01S0060 00083000
         CLI   VOLID(@10),X'FF'                                 01S0060 00084000
         BNE   @RT00060                                         01S0060 00085000
@GL00003 L     @10,AFFVUPTR                                     01S0060 00086000
         CLI   VOLID(@10),X'FF'                                 01S0060 00087000
         BNE   @RF00060                                         01S0060 00088000
         L     @10,SIOTPTR                                      01S0060 00089000
         TM    SCTSNEW(@10),B'00000100'                         01S0060 00090000
         BNZ   @RF00060                                         01S0060 00091000
@RT00060 DS    0H                                               01S0061 00092000
*                DO;                   /*VALIDITY CHECK VOLUME       */ 00093000
*                  CALL IEFAB441(FUNC441,ALCWAPTR,AFFVUPTR,0,UCBTYP);   00094000
         LA    @10,FUNC441                                      01S0062 00095000
         ST    @10,@AL00001                                     01S0062 00096000
         L     @10,@PC00001+12                                  01S0062 00097000
         ST    @10,@AL00001+4                                   01S0062 00098000
         LA    @10,AFFVUPTR                                     01S0062 00099000
         ST    @10,@AL00001+8                                   01S0062 00100000
         LA    @10,@CF00138                                     01S0062 00101000
         ST    @10,@AL00001+12                                  01S0062 00102000
         L     @10,@PC00001+8                                   01S0062 00103000
         L     @10,UCBPTR(,@10)                                 01S0062 00104000
         LA    @10,UCBTYP(,@10)                                 01S0062 00105000
         ST    @10,@AL00001+16                                  01S0062 00106000
         L     @15,@CV00096                                     01S0062 00107000
         LA    @01,@AL00001                                     01S0062 00108000
         BALR  @14,@15                                          01S0062 00109000
*                  RETCODE = REG15;    /*SAVE THE RETURN CODE        */ 00110000
         LR    RETCODE,REG15                                    01S0063 00111000
*                  IF RETCODE=NOERROR & AFFVUPTR-> VUVINELG=ON THEN /*  00112000
*                                                            @ZA03246*/ 00113000
         LTR   RETCODE,RETCODE                                  01S0064 00114000
         BNZ   @RF00064                                         01S0064 00115000
         L     @10,AFFVUPTR                                     01S0064 00116000
         TM    VUVINELG(@10),B'00000010'                        01S0064 00117000
         BNO   @RF00064                                         01S0064 00118000
*                    RETCODE = RECOV;  /*INDICATE VOL ON UNLOCKED GEN*/ 00119000
         LA    RETCODE,40                                       01S0065 00120000
*                  IF RETCODE=NOERROR & INDRETRY= ON THEN       01S0066 00121000
@RF00064 LTR   RETCODE,RETCODE                                  01S0066 00122000
         BNZ   @RF00066                                         01S0066 00123000
         L     @10,@PC00001+12                                  01S0066 00124000
         L     @10,ALCWAPTR(,@10)                               01S0066 00125000
         TM    INDRETRY(@10),B'01000000'                        01S0066 00126000
         BNO   @RF00066                                         01S0066 00127000
*                    RETCODE = MTDINELG;/*INDIC VOL ON UNLOCKED GROUP*/ 00128000
         LA    RETCODE,20                                       01S0067 00129000
*                END;                                           01S0068 00130000
@RF00066 DS    0H                                               01S0069 00131000
*              IF RETCODE=NOERROR &    /*VALIDITY CHECK OK?          */ 00132000
*                 AFFVUPTR->VOLALOC=OFF & /*PERMRES/RSV NOT ALLOC'D  */ 00133000
*                 AFFVUPTR->VDEVREQD=ON THEN  /*AND DEVICE REQUIRED? */ 00134000
@RF00060 LTR   RETCODE,RETCODE                                  01S0069 00135000
         BNZ   @RF00069                                         01S0069 00136000
         L     @10,AFFVUPTR                                     01S0069 00137000
         TM    VDEVREQD(@10),B'00100000'                        01S0069 00138000
         BNO   @RF00069                                         01S0069 00139000
         TM    VOLALOC(@10),B'10000000'                         01S0069 00140000
         BNZ   @RF00069                                         01S0069 00141000
*                DO;                   /*YES                         */ 00142000
*                  CALL FINDEDL2;      /*GET UCB POSITION IN EDL     */ 00143000
         BAL   @14,FINDEDL2                                     01S0071 00144000
*                  IF RETCODE = NOERROR THEN /*OK TO ALLOC   @ZA01878*/ 00145000
         LTR   RETCODE,RETCODE                                  01S0072 00146000
         BNZ   @RF00072                                         01S0072 00147000
*                    CALL AFFPROC;     /*YES, ALLOCATE AFFINITY REQ  */ 00148000
         BAL   @14,AFFPROC                                      01S0073 00149000
*                END;                                           01S0074 00150000
*            END;                                               01S0075 00151000
*        END;                                                   01S0076 00152000
*      ELSE;                           /*NO UNITID MATCH             */ 00153000
@RF00050 DS    0H                                               01S0078 00154000
*      AFFVUPTR = AFFVUPTR + VOLENTLN; /*PTR TO NEXT VOLUNIT ENTRY   */ 00155000
@RC00050 L     @10,AFFVUPTR                                     01S0078 00156000
         AL    @10,VOLENTLN                                     01S0078 00157000
         ST    @10,AFFVUPTR                                     01S0078 00158000
*  END;                                                         01S0079 00159000
         AH    AVUCTR,@CH00046                                  01S0079 00160000
@DE00049 CR    AVUCTR,NUMVUENT                                  01S0079 00161000
         BNH   @DL00049                                         01S0079 00162000
@DC00049 DS    0H                                               01S0080 00163000
*RETURN CODE(RETCODE);                                          01S0080 00164000
         IC    @02,@OLDKEY                                      01S0080 00165000
         L     @13,4(,@13)                                      01S0080 00166000
         L     @00,@SIZDATD                                     01S0080 00167000
         LR    @01,@11                                          01S0080 00168000
         FSPACE   R,LV=(0),A=(1)                                        00169000
         MODESET KEYADDR=(2)                                            00170000
         LR    @15,@03                                          01S0080 00171000
         L     @14,12(,@13)                                     01S0080 00172000
         LM    @00,@12,20(@13)                                  01S0080 00173000
         BR    @14                                              01S0080 00174000
*/********************************************************************/ 00175000
*/*                                                                  */ 00176000
*/* SEGMENT NAME - AFFPROC                                           */ 00177000
*/*                                                                  */ 00178000
*/* DESCRIPTIVE NAME - PROCESS AFFINITY                              */ 00179000
*/*                                                                  */ 00180000
*/* FUNCTION -                                                       */ 00181000
*/*   THIS SEGMENT MANAGES ALLOCATION OF VOLUME AND UNIT AFFINITY    */ 00182000
*/*   REQUESTS. THE SEGMENT USES A SUBROUTINE TO BUILD A             */ 00183000
*/*   PARAMETER LIST FOR THE ALLOCATE REQUEST TO UNIT ROUTINE        */ 00184000
*/*   (IEFAB434). IT THEN CALLS IEFAB434 TO ALLOCATE THE AFFINITY    */ 00185000
*/*   REQUEST. IF THE ALLOCATION IS SUCCESSFUL, IT TURNS ON THE      */ 00186000
*/*   ALLOCATED BIT IN THE VOLUNIT ENTRY, AND, IF APPLICABLE, THE EDL*/ 00187000
*/*   ENTRY AND SIOT. IT ALSO DECREMENTS THE COUNT OF VOLUNIT ENTRIES*/ 00188000
*/*   TO BE ALLOCATED. IT THEN USES SUBROUTINES TO DETERMINE IF THE  */ 00189000
*/*   ENTRY JUST ALLOCATED WAS THE FIRST FOR A MULTI-UNIT REQUEST    */ 00190000
*/*   AND, IF SO, MARKS ALL GENERICS IN THE EDL, EXCEPT THE ONE JUST */ 00191000
*/*   ALLOCATED, INELIGIBLE. IF THE ALLOCATION WAS UNSUCCESSFUL, AN  */ 00192000
*/*   ERROR HANDLING SUBROUTINE IS GIVEN CONTROL.                    */ 00193000
*/*                                                                  */ 00194000
*/* ENTRY - SUBROUTINE OF IEFAB432                                   */ 00195000
*/*                                                                  */ 00196000
*/*   PURPOSE - CONTROLS ALLOCATION OF VOLUME AND UNIT AFFINITY      */ 00197000
*/*             REQUESTS.                                            */ 00198000
*/*                                                                  */ 00199000
*/*   INPUT -                                                        */ 00200000
*/*     SIOTPTR  - PTR TO SIOT OF CURRENT REQUEST                    */ 00201000
*/*     ALCWAPTR - PTR TO ALLOCATION WORK AREA                       */ 00202000
*/*     AFFVUPTR - PTR TO CURRENT VOLUNIT ENTRY                      */ 00203000
*/*     EDLPTR   - PTR TO EDL ENTRY OF CURRENT REQUEST               */ 00204000
*/*     UCBENTNO - INDEX TO UCB ADDR IN UCB LIST OF EDL              */ 00205000
*/*     UCBMATSW - INDICATOR OF WHETHER UCB FOUND IN EDL             */ 00206000
*/*                                                                  */ 00207000
*/* EXIT-NORMAL - RETURN TO CALLER                                   */ 00208000
*/*                                                                  */ 00209000
*/*   CONDITION - AFFINITY ENTRY ALLOCATED                           */ 00210000
*/*                                                                  */ 00211000
*/*     OUTPUT -                                                     */ 00212000
*/*       VOLALOC  - ON IN VOLUNIT ENTRY THAT WAS ALLOCATED          */ 00213000
*/*       TOTVOLUN - FIELD IN COUNT TABLE DECREMENTED BY 1           */ 00214000
*/*       EDLALCD  - ON IN EDL ENTRY IF UCB MATCH TO PRIMARY WAS MADE*/ 00215000
*/*       EINDEVTP - ON IN EDL ENTRIES OF GENERICS OTHER THAN THAT   */ 00216000
*/*                  ALLOCATED TO THE FIRST UNIT OF A MULTI-UNIT     */ 00217000
*/*                  REQUEST (NOT SET ON IF MULTIPLE GENERICS ARE    */ 00218000
*/*                  ALLOWED).                                       */ 00219000
*/*       SIOTALCD - ON IF ENTIRE SIOT ALLOCATED                     */ 00220000
*/*       TOTREQS - DECREMENTED IF ENTIRE SIOT ALLOCATED             */ 00221000
*/*                                                                  */ 00222000
*/*     RETURN CODE - 0                                              */ 00223000
*/*                                                                  */ 00224000
*/* EXIT-ERROR - RETURN TO CALLER                                    */ 00225000
*/*                                                                  */ 00226000
*/*   CONDITION - RECOVERABLE DADSM ERROR                            */ 00227000
*/*                                                                  */ 00228000
*/*     OUTPUT -                                                     */ 00229000
*/*       VUDADSME - BIT SET IN VOLUNIT ENTRIES REQUESTING UNIT ON   */ 00230000
*/*                  WHICH DADSM ERROR OCCURRED                      */ 00231000
*/*       VUDNALOC - BIT SET IN VOLUNIT ENTRIES REQUESTING UNIT ON   */ 00232000
*/*                  WHICH DADSM ERROR OCCURRED                      */ 00233000
*/*                                                                  */ 00234000
*/*     RETURN CODE - 32                                             */ 00235000
*/*                                                                  */ 00236000
*/*   CONDITION - NON-RECOVERABLE DADSM ERROR                        */ 00237000
*/*                                                                  */ 00238000
*/*     OUTPUT -                                                     */ 00239000
*/*       VUVINELG - BIT SET IN VOLUNIT ENTRIES REQUESTING UNIT ON   */ 00240000
*/*                  WHICH DADSM ERROR OCCURRED                      */ 00241000
*/*       VUDNALOC - BIT SET IN VOLUNIT ENTRIES REQUESTING UNIT ON   */ 00242000
*/*                  WHICH DADSM ERROR OCCURRED                      */ 00243000
*/*                                                                  */ 00244000
*/*     RETURN CODE - 32                                             */ 00245000
*/*                                                                  */ 00246000
*/********************************************************************/ 00247000
*AFFPROC: PROC;                                                 02S0081 00248000
@EL00001 IC    @02,@OLDKEY                                      02S0081 00249000
         L     @13,4(,@13)                                      02S0081 00250000
@EF00001 L     @00,@SIZDATD                                     02S0081 00251000
         LR    @01,@11                                          02S0081 00252000
         FSPACE   R,LV=(0),A=(1)                                        00253000
         MODESET KEYADDR=(2)                                            00254000
@ER00001 LM    @14,@12,12(@13)                                  02S0081 00255000
         BR    @14                                              02S0081 00256000
AFFPROC  STM   @14,@02,@SA00002                                 02S0081 00257000
         STM   @04,@12,@SA00002+20                              02S0081 00258000
*CALL BLD434PM;                        /*BUILD PARMLIST FOR IEFAB434 */ 00259000
         BAL   @14,BLD434PM                                     02S0082 00260000
*UCBDATAP = ADDR(UCBDATA);             /*POINT TO VALIDITY CHK AREA  */ 00261000
         LA    @10,UCBDATA                                      02S0083 00262000
         ST    @10,UCBDATAP                                     02S0083 00263000
*CALL IEFAB434(SIOTPTR,AFFVUPTR,UCBPTR,ARUINDIC,ARUWORD,        02S0084 00264000
*  ALCWAPTR,GROUPID,UCBDATAP);         /*ALLOCATE THE REQUEST        */ 00265000
         LA    @10,SIOTPTR                                      02S0084 00266000
         ST    @10,@AL00001                                     02S0084 00267000
         LA    @10,AFFVUPTR                                     02S0084 00268000
         ST    @10,@AL00001+4                                   02S0084 00269000
         L     @10,@PC00001+8                                   02S0084 00270000
         ST    @10,@AL00001+8                                   02S0084 00271000
         LA    @10,ARUINDIC                                     02S0084 00272000
         ST    @10,@AL00001+12                                  02S0084 00273000
         LA    @10,ARUWORD                                      02S0084 00274000
         ST    @10,@AL00001+16                                  02S0084 00275000
         L     @10,@PC00001+12                                  02S0084 00276000
         ST    @10,@AL00001+20                                  02S0084 00277000
         LA    @10,GROUPID                                      02S0084 00278000
         ST    @10,@AL00001+24                                  02S0084 00279000
         LA    @10,UCBDATAP                                     02S0084 00280000
         ST    @10,@AL00001+28                                  02S0084 00281000
         L     @15,@CV00095                                     02S0084 00282000
         LA    @01,@AL00001                                     02S0084 00283000
         BALR  @14,@15                                          02S0084 00284000
*RETCODE = REG15;                      /*SAVE RETURN CODE            */ 00285000
         LR    RETCODE,REG15                                    02S0085 00286000
*IF RETCODE = NOERROR THEN             /*ANY ERRORS?                 */ 00287000
         LTR   RETCODE,RETCODE                                  02S0086 00288000
         BNZ   @RF00086                                         02S0086 00289000
*  DO;                                 /*NO                          */ 00290000
*    IF UPALOK = ON THEN               /*UPDATE ALGORITHM TABLES     */ 00291000
         L     @10,@PC00001+16                                  02S0088 00292000
         TM    UPALOK(@10),B'01000000'                          02S0088 00293000
         BNO   @RF00088                                         02S0088 00294000
*      DO;                                                      02S0089 00295000
*        FUNCS = ''B;                  /*CLEAR IEFAB4F2 FUNCTION MAP */ 00296000
         MVI   FUNCS,X'00'                                      02S0090 00297000
*        ARUFUNC = ON;                 /*INDICATE DEV ALLOCATED      */ 00298000
*        AFFBIT = ON;                  /*INDICATE AFFINITY HANDLED   */ 00299000
         OI    ARUFUNC,B'01100000'                              02S0092 00300000
*        CALL IEFAB4F2(FUNCS,AFFVUPTR,UCBPTR,ALCWAPTR,GROUPID); 02S0093 00301000
         LA    @10,FUNCS                                        02S0093 00302000
         ST    @10,@AL00001                                     02S0093 00303000
         LA    @10,AFFVUPTR                                     02S0093 00304000
         ST    @10,@AL00001+4                                   02S0093 00305000
         L     @10,@PC00001+8                                   02S0093 00306000
         ST    @10,@AL00001+8                                   02S0093 00307000
         L     @10,@PC00001+12                                  02S0093 00308000
         ST    @10,@AL00001+12                                  02S0093 00309000
         LA    @10,GROUPID                                      02S0093 00310000
         ST    @10,@AL00001+16                                  02S0093 00311000
         L     @15,@CV00097                                     02S0093 00312000
         LA    @01,@AL00001                                     02S0093 00313000
         BALR  @14,@15                                          02S0093 00314000
*                                      /*UPDATE ALGORITHM TABLES     */ 00315000
*      END;                                                     02S0094 00316000
*    AFFVUPTR->VOLALOC = ON;           /*MARK VU ENTRY ALLOCATED     */ 00317000
@RF00088 L     @10,AFFVUPTR                                     02S0095 00318000
         OI    VOLALOC(@10),B'10000000'                         02S0095 00319000
*    TOTVOLUN = TOTVOLUN - ONE;        /*DECREMENT VU CTR            */ 00320000
         L     @10,@PC00001+12                                  02S0096 00321000
         L     @10,ALCWAPTR(,@10)                               02S0096 00322000
         L     @09,TOTVOLUN(,@10)                               02S0096 00323000
         BCTR  @09,0                                            02S0096 00324000
         ST    @09,TOTVOLUN(,@10)                               02S0096 00325000
*    IF UCBMATSW=ON THEN               /*WAS UCB IN EDL              */ 00326000
         TM    UCBMATSW,B'10000000'                             02S0097 00327000
         BNO   @RF00097                                         02S0097 00328000
*      EDLALCD(UCBENTNO)=ON;           /*MARK EDL ENTRY ALLOCATED    */ 00329000
         LR    @10,UCBENTNO                                     02S0098 00330000
         SLA   @10,2                                            02S0098 00331000
         ALR   @10,EDLUCBLP                                     02S0098 00332000
         BCTR  @10,0                                            02S0098 00333000
         BCTR  @10,0                                            02S0098 00334000
         OI    EDLALCD-2(@10),B'10000000'                       02S0098 00335000
*    NOTALCSW = OFF;                   /*SET LOOP CONTROL SWITCH     */ 00336000
@RF00097 NI    NOTALCSW,B'01111111'                             02S0099 00337000
*    TEMVUPTR = SVOLUNAD;              /*PNT TO 1ST VU ENT FOR SIOT  */ 00338000
         L     @10,SIOTPTR                                      02S0100 00339000
         L     TEMVUPTR,SVOLUNAD(,@10)                          02S0100 00340000
*    DO AVUCTR1 = ONE TO SVOLUNNO      /*SCAN SIOT'S VU ENTRIES      */ 00341000
*      WHILE(NOTALCSW=OFF);            /*UNLESS UNALLOC'D ENT FOUND  */ 00342000
         LA    AVUCTR1,1                                        02S0101 00343000
         B     @DE00101                                         02S0101 00344000
@DL00101 TM    NOTALCSW,B'10000000'                             02S0101 00345000
         BNZ   @DC00101                                         02S0101 00346000
*        IF TEMVUPTR->VDEVREQD = ON &  /*DEV REQUIRED?               */ 00347000
*           TEMVUPTR->VOLALOC=OFF THEN /*UNALLOCATED ENTRY?          */ 00348000
         TM    VDEVREQD(TEMVUPTR),B'00100000'                   02S0102 00349000
         BNO   @RF00102                                         02S0102 00350000
         TM    VOLALOC(TEMVUPTR),B'10000000'                    02S0102 00351000
         BNZ   @RF00102                                         02S0102 00352000
*          NOTALCSW = ON;              /*YES, STOP SCAN              */ 00353000
         OI    NOTALCSW,B'10000000'                             02S0103 00354000
*      TEMVUPTR = TEMVUPTR + VOLENTLN; /*POINT TO NEXT VU ENTRY      */ 00355000
@RF00102 AL    TEMVUPTR,VOLENTLN                                02S0104 00356000
*    END;                                                       02S0105 00357000
         AH    AVUCTR1,@CH00046                                 02S0105 00358000
@DE00101 L     @10,SIOTPTR                                      02S0105 00359000
         CH    AVUCTR1,SVOLUNNO(,@10)                           02S0105 00360000
         BNH   @DL00101                                         02S0105 00361000
@DC00101 DS    0H                                               02S0106 00362000
*    IF NOTALCSW = OFF THEN            /*ALL ENTS FOR SIOT ALLOCATED */ 00363000
         TM    NOTALCSW,B'10000000'                             02S0106 00364000
         BNZ   @RF00106                                         02S0106 00365000
*      DO;                                                      02S0107 00366000
*        SIOTALCD=ON;                  /*YES, MARK SIOT ALLOCATED    */ 00367000
         L     @10,SIOTPTR                                      02S0108 00368000
         OI    SIOTALCD(@10),B'00000010'                        02S0108 00369000
*        TOTREQS = TOTREQS - ONE;      /*DECREMENT NO. OF TOTAL REQS */ 00370000
         L     @10,@PC00001+12                                  02S0109 00371000
         L     @10,ALCWAPTR(,@10)                               02S0109 00372000
         L     @09,TOTREQS(,@10)                                02S0109 00373000
         BCTR  @09,0                                            02S0109 00374000
         ST    @09,TOTREQS(,@10)                                02S0109 00375000
*      END;                                                     02S0110 00376000
*    IF EDLMGENS=OFF |                 /*MULTI-GENERICS NOT OK       */ 00377000
*       UPALOK = OFF THEN              /*EDL NOT ALREADY UPDATED     */ 00378000
@RF00106 L     @10,SIOTPTR                                      02S0111 00379000
         L     @10,SIOTEDLP(,@10)                               02S0111 00380000
         TM    EDLMGENS(@10),B'01000000'                        02S0111 00381000
         BZ    @RT00111                                         02S0111 00382000
         L     @10,@PC00001+16                                  02S0111 00383000
         TM    UPALOK(@10),B'01000000'                          02S0111 00384000
         BNZ   @RF00111                                         02S0111 00385000
@RT00111 DS    0H                                               02S0112 00386000
*      DO;                                                      02S0112 00387000
*        TVUPTR = AFFVUPTR;            /*PT TO AFFINITY VU ENTRY     */ 00388000
         L     TVUPTR,AFFVUPTR                                  02S0113 00389000
*        CALL VUSCAN;                  /*MUST EDL BE UPDATED?        */ 00390000
         BAL   @14,VUSCAN                                       02S0114 00391000
*        IF UPEDLSW=ON THEN            /*YES                         */ 00392000
         TM    UPEDLSW,B'10000000'                              02S0115 00393000
         BNO   @RF00115                                         02S0115 00394000
*          CALL UPDEDL;                /*UPDATE EDL ENTRIES          */ 00395000
         BAL   @14,UPDEDL                                       02S0116 00396000
*      END;                                                     02S0117 00397000
*  END;                                                         02S0118 00398000
*ELSE                                  /*ALLOCATION ERROR            */ 00399000
*  DO;                                                          02S0119 00400000
         B     @RC00086                                         02S0119 00401000
@RF00086 DS    0H                                               02S0120 00402000
*    CALL PROCAFF2;                    /*HANDLE ERROR        @ZA03616*/ 00403000
         BAL   @14,PROCAFF2                                     02S0120 00404000
*  END;                                                         02S0121 00405000
*END AFFPROC;                                                   02S0122 00406000
@EL00002 DS    0H                                               02S0122 00407000
@EF00002 DS    0H                                               02S0122 00408000
@ER00002 LM    @14,@02,@SA00002                                 02S0122 00409000
         LM    @04,@12,@SA00002+20                              02S0122 00410000
         BR    @14                                              02S0122 00411000
*/********************************************************************/ 00412000
*/*                                                                  */ 00413000
*/* SEGMENT NAME - BLD434PM                                          */ 00414000
*/*                                                                  */ 00415000
*/* DESCRIPTIVE NAME - BUILD PARAMETER LIST TO ALLOC REQUEST TO UNIT */ 00416000
*/*                                                                  */ 00417000
*/* FUNCTION - THIS SEGMENT SETS UP PARAMETER INFORMATION FOR INPUT  */ 00418000
*/*            TO THE ALLOCATE REQUEST TO UNIT (IEFAB434). INPUT     */ 00419000
*/*            CONSISTS OF PROCESSING INDICATOR FLAGS AND INFORMATION*/ 00420000
*/*            NECESSARY TO BUILD AN ETIOT REQUEST BLOCK.            */ 00421000
*/*                                                                  */ 00422000
*/* ENTRY - BLD434PM                                                 */ 00423000
*/*                                                                  */ 00424000
*/*   PURPOSE - SEE FUNCTION                                         */ 00425000
*/*                                                                  */ 00426000
*/*             INPUT -                                              */ 00427000
*/*                EDLGNTP - POINT TO GROUP ENTRY IN EDL.            */ 00428000
*/*                SIOTPTR - POINTER TO SIOT BEING PROCESSED.        */ 00429000
*/*                VUPTR   - POINTER TO VOLUNIT ENTRY BEING          */ 00430000
*/*                          PROCESSED.                              */ 00431000
*/*                                                                  */ 00432000
*/* EXITS -                                                          */ 00433000
*/*  CONDITION - PARAMETER LIST SUCCESSFULLY BUILT.                  */ 00434000
*/*                                                                  */ 00435000
*/*  OUTPUT -      ARUETUPD - OFF IF AN ETIOT ENTRY IS TO BE CREATED */ 00436000
*/*                           ON IF AN EXISTING ENTRY TO BE          */ 00437000
*/*                           UPDATED.                               */ 00438000
*/*                ARUUSECT - ON IF DA TO INDICATE UPDATE USE COUNT  */ 00439000
*/*                ARUVLCHK - ALWAYS OFF TO INDICATE NO VALIDITY CHK */ 00440000
*/*                ARURLPOS - RELATIVE POSITION IN CURRENT SIOTS     */ 00441000
*/*                           VOLUNIT TABLE ENTRIES.                 */ 00442000
*/*                ARUUSEAT - UPDATE USE ATTRIBUTE IF PROCESSING     */ 00443000
*/*                           FOR MOUNTED VOLUMES                    */ 00444000
*/*                ARUNODEV - SET TO NUMBER OF DEVICE ENTRIES NEEDED,*/ 00445000
*/*                           IF CREATING AN ETIOT ENTRY.            */ 00446000
*/*                GROUPID -  GROUP ID FROM EDL ENTRY                */ 00447000
*/*                VOLUMEID - VOLSER TO BE ALLOCATED                 */ 00448000
*/*                                                                  */ 00449000
*/*  RETURN CODE - NONE.                                             */ 00450000
*/*                                                                  */ 00451000
*/********************************************************************/ 00452000
*BLD434PM:                                                      02S0123 00453000
*  PROC;                                                        02S0123 00454000
BLD434PM STM   @14,@12,12(@13)                                  02S0123 00455000
*ARUINDIC = ''B;                       /*CLEAR PARAMETER SWITCHES    */ 00456000
         XC    ARUINDIC(4),ARUINDIC                             02S0124 00457000
*IF SIOTETIO = ZERO THEN               /*DOES ETIOT ENTRY EXIST?     */ 00458000
         L     @10,SIOTPTR                                      02S0125 00459000
         ICM   @04,15,SIOTETIO(@10)                             02S0125 00460000
         BNZ   @RF00125                                         02S0125 00461000
*  ARUETUPD = OFF;                     /*NO,INDICATE ETIOT CREATE    */ 00462000
         NI    ARUETUPD,B'01111111'                             02S0126 00463000
*ELSE                                                           02S0127 00464000
*  ARUETUPD = ON;                      /*YES,INDICATE UPDATE ETIOT   */ 00465000
         B     @RC00125                                         02S0127 00466000
@RF00125 OI    ARUETUPD,B'10000000'                             02S0127 00467000
*ARURLPOS = ONE;                       /*INIT RELATIVE POSITION IN      00468000
*                                        ETIOT COUNT                 */ 00469000
@RC00125 MVC   ARURLPOS(2),@CH00046                             02S0128 00470000
*AVUPTR = SVOLUNAD;                    /*PTR TO BASE OF VOLUNIT TABLE*/ 00471000
         L     @10,SIOTPTR                                      02S0129 00472000
         L     AVUPTR,SVOLUNAD(,@10)                            02S0129 00473000
*DO WHILE(AVUPTR^=AFFVUPTR);           /*SEARCH VOLUNIT TABLE UNTIL     00474000
*                                        ENTRY TO BE ALLOCATED IS       00475000
*                                        FOUND                       */ 00476000
         B     @DE00130                                         02S0130 00477000
@DL00130 DS    0H                                               02S0131 00478000
*  IF AVUPTR -> VDEVREQD = ON THEN     /*IF THIS VU ENTRY REQUIRES A    00479000
*                                        DEVICE THEN INCREMENT INDEX    00480000
*                                        TO NEXT AVAILABLE ETIOT     */ 00481000
         TM    VDEVREQD(AVUPTR),B'00100000'                     02S0131 00482000
         BNO   @RF00131                                         02S0131 00483000
*    ARURLPOS = ARURLPOS + ONE;                                 02S0132 00484000
         LH    @10,ARURLPOS                                     02S0132 00485000
         LA    @10,1(,@10)                                      02S0132 00486000
         STH   @10,ARURLPOS                                     02S0132 00487000
*  ELSE;                                                        02S0133 00488000
@RF00131 DS    0H                                               02S0134 00489000
*  AVUPTR = AVUPTR + VOLENTLN;         /*UPDATE PTR TO NEXT VU ENTRY */ 00490000
         AL    AVUPTR,VOLENTLN                                  02S0134 00491000
*END;                                                           02S0135 00492000
@DE00130 C     AVUPTR,AFFVUPTR                                  02S0135 00493000
         BNE   @DL00130                                         02S0135 00494000
*IF ARUETUPD = OFF THEN                /*IF ETIOT ENTRY MUST BE 02S0136 00495000
*                                        CREATED                     */ 00496000
         TM    ARUETUPD,B'10000000'                             02S0136 00497000
         BNZ   @RF00136                                         02S0136 00498000
*  ARUNODEV = SIOTOTUN;                /*SET NUMBER OF DEVICE   02S0137 00499000
*                                        ENTRIES NEEDED              */ 00500000
         L     @10,SIOTPTR                                      02S0137 00501000
         SLR   @04,@04                                          02S0137 00502000
         IC    @04,SIOTOTUN(,@10)                               02S0137 00503000
         STH   @04,ARUNODEV                                     02S0137 00504000
*ELSE;                                                          02S0138 00505000
@RF00136 DS    0H                                               02S0139 00506000
*IF UCB3DACC = ON THEN                 /*DA                          */ 00507000
         L     @10,@PC00001+8                                   02S0139 00508000
         L     @10,UCBPTR(,@10)                                 02S0139 00509000
         TM    UCB3DACC(@10),B'00100000'                        02S0139 00510000
         BNO   @RF00139                                         02S0139 00511000
*  ARUUSECT = ON;                      /*INDICATE USE COUNT UPDATE   */ 00512000
         OI    ARUUSECT,B'01000000'                             02S0140 00513000
*IF UCB3DACC = ON THEN                 /*DA                          */ 00514000
@RF00139 L     @10,@PC00001+8                                   02S0141 00515000
         L     @10,UCBPTR(,@10)                                 02S0141 00516000
         TM    UCB3DACC(@10),B'00100000'                        02S0141 00517000
         BNO   @RF00141                                         02S0141 00518000
*  IF UCBRESV = OFF &                  /*IF UNIT NOT PERMRES AND     */ 00519000
*     UCBPRES = OFF THEN               /*NOT RESERVED                */ 00520000
         TM    UCBRESV(@10),B'00100100'                         02S0142 00521000
         BNZ   @RF00142                                         02S0142 00522000
*    ARUUSEAT = ON;                    /*THEN UPDATE USE ATTRIBUTE   */ 00523000
         OI    ARUUSEAT,B'00001000'                             02S0143 00524000
*  ELSE;                                                        02S0144 00525000
@RF00142 DS    0H                                               02S0145 00526000
*ELSE                                                           02S0145 00527000
*  IF UCB3TAPE = ON THEN                                        02S0145 00528000
         B     @RC00141                                         02S0145 00529000
@RF00141 L     @10,@PC00001+8                                   02S0145 00530000
         L     @10,UCBPTR(,@10)                                 02S0145 00531000
         TM    UCB3TAPE(@10),B'10000000'                        02S0145 00532000
         BNO   @RF00145                                         02S0145 00533000
*    IF UCBRESV = OFF THEN             /*NOT RESERVED TAPE           */ 00534000
         TM    UCBRESV(@10),B'00100000'                         02S0146 00535000
         BNZ   @RF00146                                         02S0146 00536000
*      ARUUSEAT = ON;                                           02S0147 00537000
         OI    ARUUSEAT,B'00001000'                             02S0147 00538000
*UCBDATA = UCBDATA && UCBDATA;         /*CLEAR UCB DATA FIELD        */ 00539000
@RF00146 DS    0H                                               02S0148 00540000
@RF00145 DS    0H                                               02S0148 00541000
@RC00141 XC    UCBDATA(9),UCBDATA                               02S0148 00542000
*IF (AFFVUPTR->VOLID(1) = NONSPDA |    /*NON-SPECIFIC DA             */ 00543000
*    AFFVUPTR->VOLID(1) = NONSPTAP) &  /*NON-SPECIFIC TAPE           */ 00544000
*    UCBVOLI ^= NOVOLSER &             /*VOLSER IN UCB               */ 00545000
*    VOLSPEC = OFF THEN                /*PRIMARY REQ NOT SPECIFIC    */ 00546000
         L     @10,AFFVUPTR                                     02S0149 00547000
         CLI   VOLID(@10),X'FE'                                 02S0149 00548000
         BE    @GL00011                                         02S0149 00549000
         CLI   VOLID(@10),X'FF'                                 02S0149 00550000
         BNE   @RF00149                                         02S0149 00551000
@GL00011 L     @10,@PC00001+8                                   02S0149 00552000
         L     @10,UCBPTR(,@10)                                 02S0149 00553000
         CLC   UCBVOLI(6,@10),NOVOLSER                          02S0149 00554000
         BE    @RF00149                                         02S0149 00555000
         L     @04,@PC00001+4                                   02S0149 00556000
         L     @04,VUPTR(,@04)                                  02S0149 00557000
         TM    VOLSPEC(@04),B'00100000'                         02S0149 00558000
         BNZ   @RF00149                                         02S0149 00559000
*  VOLUMEID = UCBVOLI;                 /*SET VOLSER FROM UCB         */ 00560000
         MVC   VOLUMEID(6),UCBVOLI(@10)                         02S0150 00561000
*ELSE                                                           02S0151 00562000
*  VOLUMEID = AFFVUPTR -> VOLID;       /*SET VOLSER FROM VU ENTRY    */ 00563000
         B     @RC00149                                         02S0151 00564000
@RF00149 L     @10,AFFVUPTR                                     02S0151 00565000
         MVC   VOLUMEID(6),VOLID(@10)                           02S0151 00566000
*GROUPID = EDLGRID;                    /*SET GROUPID FROM CORRECT EDL*/ 00567000
@RC00149 MVC   GROUPID(4),EDLGRID(EDLGNTP)                      02S0152 00568000
*END BLD434PM;                                                  02S0153 00569000
@EL00003 DS    0H                                               02S0153 00570000
@EF00003 DS    0H                                               02S0153 00571000
@ER00003 LM    @14,@12,12(@13)                                  02S0153 00572000
         BR    @14                                              02S0153 00573000
*/********************************************************************/ 00574000
*/*                                                                  */ 00575000
*/* SEGMENT NAME -     FINDEDL2                                      */ 00576000
*/*                                                                  */ 00577000
*/* DESCRIPTIVE NAME -  LOCATE EDL ENTRY                             */ 00578000
*/*                                                                  */ 00579000
*/* FUNCTION -  THIS SEGMENT WILL LOCATE THE EDL ENTRY AND THE INDEX */ 00580000
*/*             INTO THE UCBLIST OF THE DEVICE TYPE AND UNIT TO BE   */ 00581000
*/*             ALLOCATED TO THE CURRENT REQUEST.  THE DEVICE TYPE   */ 00582000
*/*             MUST BE THE SAME AS THAT ALLOCATED TO THE PRIMARY    */ 00583000
*/*             REQUEST IN THE VOLUME AFFINITY. OTHERWISE THE REQUEST*/ 00584000
*/*             WILL NOT BE ALLOCATED. (NOTE THAT A MATCH    @YM05476*/ 00585000
*/*             ON DEVICE TYPES MUST BE THE SAME EXCEPT FOR  @YM05476*/ 00586000
*/*             CERTAIN OPTION BITS THAT MAY                 @YM05476*/ 00587000
*/*             HAVE BEEN SET IN THE UCB BY SOME PRIOR       @YM05476*/ 00588000
*/*             PROCESSING. THESE BITS ARE BITS THAT ARE NOT @YM05476*/ 00589000
*/*             FEATURES OF ALL DEVICES OF THAT TYPE, OR THAT@YM05476*/ 00590000
*/*             PERTAIN TO HOW THE DEVICE IS USED RATHER THAN@YM05476*/ 00591000
*/*             TO ITS PHYSICAL CHARACTERISTICS. THIS MODULE @YM05476*/ 00592000
*/*             ASSUMES THAT ANY OPTIONAL FEATURE BITS SET   @YM05476*/ 00593000
*/*             IN THE UCB AT SYSGEN, WILL ALSO BE SET IN    @YM05476*/ 00594000
*/*             ALLOCATION'S INTERNAL EDT.)                  @YM05476*/ 00595000
*/*                                                                  */ 00596000
*/* ENTRY - CLOSED SUBROUTINE OF IEFAB432                            */ 00597000
*/*   PURPOSE - THIS SEGMENT IS ENTERED TO FIND EDL GENERIC & GROUP  */ 00598000
*/*             ENTRIES FOR A VOLUNIT ENTRY THAT HAS VOLUME AFFINITY */ 00599000
*/*             TO THE ENTRY(PRIMARY) JUST ALLOCATED.                */ 00600000
*/*                                                                  */ 00601000
*/*   INPUT -                                                        */ 00602000
*/*     UCBPTR   - PTR TO UCB OF DEVICE ALLOCATED TO                 */ 00603000
*/*                PRIMARY REQUEST.                                  */ 00604000
*/*     EDLFGENP - PTR TO FIRST EDL ENTRY OF CURRENT                 */ 00605000
*/*                SIOT                                              */ 00606000
*/*     SIOTPTR  - PTR TO SIOT OF CURRENT REQUEST.                   */ 00607000
*/*                                                                  */ 00608000
*/* EXITS -                                                          */ 00609000
*/*   1 CONDITION - UCB FOUND IN LIST.                               */ 00610000
*/*                                                                  */ 00611000
*/*      OUTPUT -                                                    */ 00612000
*/*        EDLPTR - PTR TO EDL ENTRY OF CURRENT REQUEST.             */ 00613000
*/*        UCBENTNO - INDEX OF UCB ADDR IN UCBLIST                   */ 00614000
*/*                   OF EDL.                                        */ 00615000
*/*        UCBMATSW - INDICATOR TO SHOW UCB FOUND IN EDL.            */ 00616000
*/*                                                                  */ 00617000
*/*     RETURN CODE -  0                                             */ 00618000
*/*                                                                  */ 00619000
*/*   2 CONDITION - DEVICE TYPES DON'T MATCH                         */ 00620000
*/*                                                                  */ 00621000
*/*     OUTPUT -                                                     */ 00622000
*/*       SIOTRSNC - REASON CODE FIELD IN SIOT = 20.                 */ 00623000
*/*                                                                  */ 00624000
*/*     RETURN CODE - 36                                             */ 00625000
*/*                                                                  */ 00626000
*/*   3 CONDITION - DEV TYPE OK BUT UCB NOT FOUND IN EDL             */ 00627000
*/*                                                                  */ 00628000
*/*     OUTPUT -                                                     */ 00629000
*/*       UCBMATSW - SET OFF TO INDICATE UCB NOT FOUND               */ 00630000
*/*                  IN EDL.                                         */ 00631000
*/*                                                                  */ 00632000
*/* RETURN CODE - 0                                                  */ 00633000
*/*                                                                  */ 00634000
*/********************************************************************/ 00635000
*FINDEDL2: PROC;                                                02S0154 00636000
FINDEDL2 STM   @14,@02,12(@13)                                  02S0154 00637000
         ST    @07,48(,@13)                                     02S0154 00638000
         STM   @09,@12,56(@13)                                  02S0154 00639000
*UCBMATSW = OFF;                       /*INITIALIZE UCBMATCH         */ 00640000
         NI    UCBMATSW,B'01111111'                             02S0155 00641000
*DEVMATSW = OFF;                       /*INITIALIZE DEVICE MATCH     */ 00642000
         NI    DEVMATSW,B'01111111'                             02S0156 00643000
*EDLPTR = EDLFGENP;                    /*POINT TO 1ST GENERIC ENTRY  */ 00644000
         L     @10,SIOTPTR                                      02S0157 00645000
         L     @10,SIOTEDLP(,@10)                               02S0157 00646000
         L     EDLPTR,EDLFGENP(,@10)                            02S0157 00647000
*TYPSTORE = UCBTYP;                    /*MOVE UCBTYP TO WORK AREA    */ 00648000
         L     @10,@PC00001+8                                   02S0158 00649000
         L     @10,UCBPTR(,@10)                                 02S0158 00650000
         MVC   TYPSTORE(4),UCBTYP(@10)                          02S0158 00651000
*IF UCB3DACC = ON THEN                 /*DIRECT ACCESS UCB           */ 00652000
         TM    UCB3DACC(@10),B'00100000'                        02S0159 00653000
         BNO   @RF00159                                         02S0159 00654000
*  DO;                                 /*TURN OFF OPTION BITS@YM05476*/ 00655000
*    TYPBYT2 = TYPBYT2 & SHPOWOFF;     /*SHARED FILE AND ALTERNATE      00656000
*                                        POWER BITS OFF      @YM05477*/ 00657000
         NI    TYPBYT2,X'DC'                                    02S0161 00658000
*    IF TYPBYT4 = DA3340 THEN          /*IF A 3340           @YM05476*/ 00659000
         CLI   TYPBYT4,X'0A'                                    02S0162 00660000
         BNE   @RF00162                                         02S0162 00661000
*      TYPBYT2 = TYPBYT2 & RPSOFF;     /*RPS OPTION OFF ALSO @YM05476*/ 00662000
         NI    TYPBYT2,X'EF'                                    02S0163 00663000
*  END;                                /*END IF DA DEVICE    @YM05476*/ 00664000
@RF00162 DS    0H                                               02S0165 00665000
*IF UCB3UREC = ON THEN                 /*UNIT RECORD                 */ 00666000
@RF00159 L     @10,@PC00001+8                                   02S0165 00667000
         L     @10,UCBPTR(,@10)                                 02S0165 00668000
         TM    UCB3UREC(@10),B'00001000'                        02S0165 00669000
         BNO   @RF00165                                         02S0165 00670000
*  IF TYPBYT4 ^= UR3211 THEN           /*AND NOT A 3211      @YM05476*/ 00671000
         CLI   TYPBYT4,X'09'                                    02S0166 00672000
         BE    @RF00166                                         02S0166 00673000
*    TYPBYT2 = TYPBYT2 & OPTSOFF;      /*IGNORE SPECIAL FEATURES     */ 00674000
         NI    TYPBYT2,X'00'                                    02S0167 00675000
*  ELSE                                /*3211 UNIT RECORD DEV@YM05476*/ 00676000
*    TYPBYT2 = TYPBYT2 & UCSOPMSK;     /*ALLOW UCS BIT       @YM05476*/ 00677000
         B     @RC00166                                         02S0168 00678000
@RF00166 NI    TYPBYT2,X'80'                                    02S0168 00679000
*IF UCB3TAPE = ON THEN                 /*TAPE DEVICE         @YM05477*/ 00680000
@RC00166 DS    0H                                               02S0169 00681000
@RF00165 L     @10,@PC00001+8                                   02S0169 00682000
         L     @10,UCBPTR(,@10)                                 02S0169 00683000
         TM    UCB3TAPE(@10),B'10000000'                        02S0169 00684000
         BNO   @RF00169                                         02S0169 00685000
*  TYPBYT2 = TYPBYT2 & OPTIONS;        /*OPTIONS BITS OFF    @ZA04104*/ 00686000
         NI    TYPBYT2,X'F4'                                    02S0170 00687000
*IF UCB3DISP = ON THEN                 /*GRAPHICS DEVICE     @YM05476*/ 00688000
@RF00169 L     @10,@PC00001+8                                   02S0171 00689000
         L     @10,UCBPTR(,@10)                                 02S0171 00690000
         TM    UCB3DISP(@10),B'00010000'                        02S0171 00691000
         BNO   @RF00171                                         02S0171 00692000
*  TYPBYT2 = TYPBYT2 & OPTSOFF;        /*ALL OPTION BITS OFF @YM05476*/ 00693000
         NI    TYPBYT2,X'00'                                    02S0172 00694000
*DO WHILE (EDLPTR ^= ZERO              /*SCAN ALL GENERICS UNTIL     */ 00695000
*   & DEVMATSW = OFF);                 /*DEV TYPE MATCH FOUND        */ 00696000
@RF00171 B     @DE00173                                         02S0173 00697000
@DL00173 DS    0H                                               02S0174 00698000
*  IF EDLDEVT=TYPSTORE THEN            /*SCAN EDL FOR DEV TYPE MATCH */ 00699000
         CLC   EDLDEVT(4,EDLPTR),TYPSTORE                       02S0174 00700000
         BNE   @RF00174                                         02S0174 00701000
*    DO;                               /*IF YES                      */ 00702000
*      DEVMATSW = ON;                  /*DEV TYPE MATCH FOUND        */ 00703000
         OI    DEVMATSW,B'10000000'                             02S0176 00704000
*      EDLGNTP = EDLGRPTR;             /*POINT TO GROUP ENTRY        */ 00705000
         L     EDLGNTP,EDLGRPTR(,EDLPTR)                        02S0177 00706000
*      DO WHILE (EDLGNTP ^= ZERO       /*DO FOR ALL GROUPS OR UNTIL  */ 00707000
*             &  UCBMATSW = OFF);      /*UCB MATCH IS FOUND.         */ 00708000
         B     @DE00178                                         02S0178 00709000
@DL00178 DS    0H                                               02S0179 00710000
*        EDLUCBLP = EDLLISTP;          /*PT TO UCB LIST              */ 00711000
         L     EDLUCBLP,EDLLISTP(,EDLGNTP)                      02S0179 00712000
*        DO UCBENTNO = ONE TO EDLUCBNO /*FIND UCB IN LIST            */ 00713000
*          WHILE (UCBMATSW = OFF);                              02S0180 00714000
         LA    UCBENTNO,1                                       02S0180 00715000
         B     @DE00180                                         02S0180 00716000
@DL00180 TM    UCBMATSW,B'10000000'                             02S0180 00717000
         BNZ   @DC00180                                         02S0180 00718000
*          IF EDLUCBAD(UCBENTNO) = UCBPTR THEN /*IS THIS UCB A MATCH?*/ 00719000
         LR    @10,UCBENTNO                                     02S0181 00720000
         SLA   @10,2                                            02S0181 00721000
         L     @09,@PC00001+8                                   02S0181 00722000
         ALR   @10,EDLUCBLP                                     02S0181 00723000
         AL    @10,@CF00940                                     02S0181 00724000
         SLR   @07,@07                                          02S0181 00725000
         ICM   @07,3,EDLUCBAD(@10)                              02S0181 00726000
         C     @07,UCBPTR(,@09)                                 02S0181 00727000
         BNE   @RF00181                                         02S0181 00728000
*            UCBMATSW = ON;            /*UCB FOUND                   */ 00729000
         OI    UCBMATSW,B'10000000'                             02S0182 00730000
*          ELSE;                       /*NOT FOUND                   */ 00731000
@RF00181 DS    0H                                               02S0184 00732000
*        END;                                                   02S0184 00733000
         AH    UCBENTNO,@CH00046                                02S0184 00734000
@DE00180 C     UCBENTNO,EDLUCBNO(,EDLGNTP)                      02S0184 00735000
         BNH   @DL00180                                         02S0184 00736000
@DC00180 DS    0H                                               02S0185 00737000
*         IF UCBMATSW =OFF THEN        /*IF NOT FOUND,               */ 00738000
         TM    UCBMATSW,B'10000000'                             02S0185 00739000
         BNZ   @RF00185                                         02S0185 00740000
*           EDLGNTP = EDLNXGRP;        /*PT TO NEXT GROUP            */ 00741000
         L     EDLGNTP,EDLNXGRP(,EDLGNTP)                       02S0186 00742000
*         ELSE;                        /*SAVE GRP PTR IF UCB MATCHES */ 00743000
@RF00185 DS    0H                                               02S0188 00744000
*      END;                                                     02S0188 00745000
@DE00178 LTR   EDLGNTP,EDLGNTP                                  02S0188 00746000
         BZ    @DC00178                                         02S0188 00747000
         TM    UCBMATSW,B'10000000'                             02S0188 00748000
         BZ    @DL00178                                         02S0188 00749000
@DC00178 DS    0H                                               02S0189 00750000
*      IF UCBMATSW = OFF THEN          /*WAS UCB FOUND               */ 00751000
         TM    UCBMATSW,B'10000000'                             02S0189 00752000
         BNZ   @RF00189                                         02S0189 00753000
*        EDLGNTP = EDLGRPTR;           /*NO, POINT TO FIRST GROUP    */ 00754000
         L     EDLGNTP,EDLGRPTR(,EDLPTR)                        02S0190 00755000
*    END;                                                       02S0191 00756000
*  ELSE                                /*NO DEVICE TYPE MATCH        */ 00757000
*    EDLPTR = EDLNXTNT;                /*THEN PT TO NXT GENERIC ENTRY*/ 00758000
         B     @RC00174                                         02S0192 00759000
@RF00174 L     EDLPTR,EDLNXTNT(,EDLPTR)                         02S0192 00760000
*END;                                                           02S0193 00761000
@RC00174 DS    0H                                               02S0193 00762000
@DE00173 LTR   EDLPTR,EDLPTR                                    02S0193 00763000
         BZ    @DC00173                                         02S0193 00764000
         TM    DEVMATSW,B'10000000'                             02S0193 00765000
         BZ    @DL00173                                         02S0193 00766000
@DC00173 DS    0H                                               02S0194 00767000
*UCBENTNO = UCBENTNO - ONE;            /*SET INDEX FOR UCB FOUND     */ 00768000
         BCTR  UCBENTNO,0                                       02S0194 00769000
*IF DEVMATSW = OFF THEN                /*DEVICE TYPE MATCH NOT FOUND */ 00770000
         TM    DEVMATSW,B'10000000'                             02S0195 00771000
         BNZ   @RF00195                                         02S0195 00772000
*  DO;                                                          02S0196 00773000
*    SIOTRSNC = ERRCD20;               /*SIOT REASON CODE = 20       */ 00774000
         L     @10,SIOTPTR                                      02S0197 00775000
         MVC   SIOTRSNC(2,@10),@CH00128                         02S0197 00776000
*    RETCODE  = ERROR;                 /*RETURN CODE=36              */ 00777000
         LA    RETCODE,36                                       02S0198 00778000
*  END;                                                         02S0199 00779000
*END FINDEDL2;                                                  02S0200 00780000
@EL00004 DS    0H                                               02S0200 00781000
@EF00004 DS    0H                                               02S0200 00782000
@ER00004 LM    @14,@02,12(@13)                                  02S0200 00783000
         L     @07,48(,@13)                                     02S0200 00784000
         LM    @09,@12,56(@13)                                  02S0200 00785000
         BR    @14                                              02S0200 00786000
*/********************************************************************/ 00787000
*/*                                                                  */ 00788000
*/* SEGMENT NAME - UPDEDL                                            */ 00789000
*/*                                                                  */ 00790000
*/* DESCRIPTIVE NAME - UPDATE ELIGIBLE DEVICE LIST                   */ 00791000
*/*                                                                  */ 00792000
*/* FUNCTION -  THIS ROUTINE SETS ALL EDL ENTRIES,WHICH ARE OF A     */ 00793000
*/*             DEVICE TYPE OTHER THAN THAT JUST ALLOCATED,          */ 00794000
*/*             INELIGIBLE FOR THIS REQUEST.                         */ 00795000
*/*                                                                  */ 00796000
*/* ENTRY - A CLOSED SUBROUTINE OF IEFAB433.                         */ 00797000
*/*   PURPOSE - SEE FUNCTION.                                        */ 00798000
*/*                                                                  */ 00799000
*/*                                                                  */ 00800000
*/*   INPUT -                                                        */ 00801000
*/*     EDLPTR - POINTER TO EDL ENTRY OF THE REQUEST JUST            */ 00802000
*/*              ALLOCATED                                           */ 00803000
*/*                                                                  */ 00804000
*/* EXITS - RETURN TO CALLER.                                        */ 00805000
*/*   CONDITION -                                                    */ 00806000
*/*      ALL EDL ENTRIES FOR THIS REQUEST WHICH ARE OF A DIFFERENT   */ 00807000
*/*      DEVICE TYPE THAN THE REQUEST JUST ALLOCATED MARKED          */ 00808000
*/*      INELIGIBLE                                                  */ 00809000
*/*                                                                  */ 00810000
*/*   OUTPUT -                                                       */ 00811000
*/*     EINDEVTP - SET TO ONE, EDL ENTRIES ARE INELIGIBLE FOR        */ 00812000
*/*                THIS REQUEST                                      */ 00813000
*/*                                                                  */ 00814000
*/*   RETURN CODE - NONE                                             */ 00815000
*/*                                                                  */ 00816000
*/********************************************************************/ 00817000
*UPDEDL:                               /*INTERNAL PROC TO UPDATE THE */ 00818000
*                                      /*EDL                         */ 00819000
*PROC;                                                          02S0201 00820000
UPDEDL   STM   @14,@12,12(@13)                                  02S0201 00821000
*SAVEDLP = EDLPTR;                     /*SAVE PTR TO ALLOCATED EDL      00822000
*                                        ENTRY                       */ 00823000
         LR    SAVEDLP,EDLPTR                                   02S0202 00824000
*EDLPTR = EDLFGENP;                    /*POINT TO FIRST ENTRY FOR       00825000
*                                        THIS REQUEST                */ 00826000
         L     @10,SIOTPTR                                      02S0203 00827000
         L     @10,SIOTEDLP(,@10)                               02S0203 00828000
         L     EDLPTR,EDLFGENP(,@10)                            02S0203 00829000
*DO WHILE(EDLPTR^=ZERO);               /*SCAN FOR DIFFERENT DEVICE      00830000
*                                        TYPES                       */ 00831000
         B     @DE00204                                         02S0204 00832000
@DL00204 DS    0H                                               02S0205 00833000
*  IF EDLDEVT ^= SAVEDLP -> EDLDEVT THEN /*SAME DEVICE TYPE ?        */ 00834000
         CLC   EDLDEVT(4,EDLPTR),EDLDEVT(SAVEDLP)               02S0205 00835000
         BE    @RF00205                                         02S0205 00836000
*    DO;                                                        02S0206 00837000
*      EINDEVTP = ON;                  /*NO,MARK EDL ENTRY INELIGIBLE*/ 00838000
         OI    EINDEVTP(EDLPTR),B'10000000'                     02S0207 00839000
*    END;                                                       02S0208 00840000
*  ELSE;                                                        02S0209 00841000
@RF00205 DS    0H                                               02S0210 00842000
*  EDLPTR = EDLNXTNT;                  /*INCREMENT TO NEXT EDL ENTRY */ 00843000
         L     EDLPTR,EDLNXTNT(,EDLPTR)                         02S0210 00844000
*END;                                                           02S0211 00845000
@DE00204 LTR   EDLPTR,EDLPTR                                    02S0211 00846000
         BNZ   @DL00204                                         02S0211 00847000
*EDLPTR = SAVEDLP;                     /*RESTORE EDLPTR              */ 00848000
         LR    EDLPTR,SAVEDLP                                   02S0212 00849000
*END UPDEDL;                           /*RETURN TO CALLER            */ 00850000
@EL00005 DS    0H                                               02S0213 00851000
@EF00005 DS    0H                                               02S0213 00852000
@ER00005 LM    @14,@12,12(@13)                                  02S0213 00853000
         BR    @14                                              02S0213 00854000
*/********************************************************************/ 00855000
*/*                                                                  */ 00856000
*/* SEGMENT NAME - VUSCAN                                            */ 00857000
*/*                                                                  */ 00858000
*/* DESCRIPTIVE NAME - VOLUNIT SCAN ROUTINE                          */ 00859000
*/*                                                                  */ 00860000
*/* FUNCTION -                                                       */ 00861000
*/*   THIS ROUTINE SCANS ALL THE VOLUNIT ENTRIES FOR THE CURRENT SIOT*/ 00862000
*/*   TO DETERMINE IF THE CURRENT ENTRY IS THE FIRST TO BE ALLOCATED */ 00863000
*/*   FOR THIS REQUEST. IF NO OTHER ENTRIES HAVE BEEN ALLOCATED AN   */ 00864000
*/*   ADDITIONAL CHECK IS MADE TO SEE IF THIS SIOT REPRESENTS A      */ 00865000
*/*   MULTI-UNIT REQUEST. IF BOTH CONDITIONS ARE TRUE A SWITCH IS    */ 00866000
*/*   SET TO INDICATE THAT THE EDL MUST BE UPDATED.                  */ 00867000
*/*                                                                  */ 00868000
*/* ENTRY POINT - THIS IS A CLOSED SUBROUTINE OF IEFAB432            */ 00869000
*/*   PURPOSE - TO DETERMINE WHETHER THE EDL MUST BE UPDATED         */ 00870000
*/*             BEFORE ALLOCATING THE REST OF THE REQUEST.           */ 00871000
*/*                                                                  */ 00872000
*/*   INPUT -                                                        */ 00873000
*/*     SIOTPTR - PTR TO CURRENT SIOT                                */ 00874000
*/*     SVOLUNAD - PTR TO FIRST VOLUNIT ENTRY FOR REQUEST (IN SIOT)  */ 00875000
*/*     SVOLUNNO - NUMBER OF VOLUNIT ENTRIES FOR REQUEST (IN SIOT)   */ 00876000
*/*     TVUPTR - POINTER TO VOLUNIT ENTRY JUST ALLOCATED             */ 00877000
*/*                                                                  */ 00878000
*/*                                                                  */ 00879000
*/* EXITS -  RETURN TO CALLER                                        */ 00880000
*/*                                                                  */ 00881000
*/*   CONDITION - ALL VOLUNIT ENTRIES SCANNED                        */ 00882000
*/*                                                                  */ 00883000
*/*   OUTPUT -                                                       */ 00884000
*/*     UPEDLSW - SET ON IF EDL MUST BE UPDATED,OFF OTHERWISE        */ 00885000
*/*                                                                  */ 00886000
*/*   RETURN CODE - NONE                                             */ 00887000
*/*                                                                  */ 00888000
*/********************************************************************/ 00889000
*VUSCAN:                                                        02S0214 00890000
*PROC;                                                          02S0214 00891000
VUSCAN   STM   @14,@12,12(@13)                                  02S0214 00892000
*VUALCSW = OFF;                        /*INIT LOOP EXIT CONDITION    */ 00893000
         NI    VUALCSW,B'01111111'                              02S0215 00894000
*UPEDLSW = ON;                         /*INIT SWITCH TO-UPDATE REQ'D */ 00895000
         OI    UPEDLSW,B'10000000'                              02S0216 00896000
*AVUPTR = SVOLUNAD;                    /*PT TO FIRST VU ENTRY FOR       00897000
*                                        THIS REQUEST                */ 00898000
         L     @10,SIOTPTR                                      02S0217 00899000
         L     AVUPTR,SVOLUNAD(,@10)                            02S0217 00900000
*IF SIOTOTUN > ONE THEN                /*MULTI-UNIT REQUEST?         */ 00901000
         CLI   SIOTOTUN(@10),1                                  02S0218 00902000
         BNH   @RF00218                                         02S0218 00903000
*  DO TVUCTR = ONE TO SVOLUNNO         /*YES,SCAN OTHER  VU ENTRIES  */ 00904000
*    WHILE(VUALCSW = OFF);             /*UNTIL FIND ONE ALLOCATED    */ 00905000
         LA    TVUCTR,1                                         02S0219 00906000
         B     @DE00219                                         02S0219 00907000
@DL00219 TM    VUALCSW,B'10000000'                              02S0219 00908000
         BNZ   @DC00219                                         02S0219 00909000
*    IF TVUPTR ^= AVUPTR THEN          /*DON'T CHECK CURRENT ENTRY   */ 00910000
         CR    TVUPTR,AVUPTR                                    02S0220 00911000
         BE    @RF00220                                         02S0220 00912000
*      DO;                                                      02S0221 00913000
*        IF AVUPTR -> VOLALOC = ON  THEN /*ENTRY ALLOCATED?          */ 00914000
         TM    VOLALOC(AVUPTR),B'10000000'                      02S0222 00915000
         BNO   @RF00222                                         02S0222 00916000
*          VUALCSW = ON;               /*YES,VU ENTRY FOR THIS  02S0223 00917000
*                                        REQUEST HAS ALREADY BEEN       00918000
*                                        ALLOCATED                   */ 00919000
         OI    VUALCSW,B'10000000'                              02S0223 00920000
*      END;                                                     02S0224 00921000
*    ELSE;                             /*BYPASSED CURRENT ENTRY      */ 00922000
@RF00220 DS    0H                                               02S0226 00923000
*    AVUPTR = AVUPTR + VOLENTLN;       /*PT TO NEXT ENTRY            */ 00924000
@RC00220 AL    AVUPTR,VOLENTLN                                  02S0226 00925000
*  END;                                                         02S0227 00926000
         AH    TVUCTR,@CH00046                                  02S0227 00927000
@DE00219 L     @10,SIOTPTR                                      02S0227 00928000
         CH    TVUCTR,SVOLUNNO(,@10)                            02S0227 00929000
         BNH   @DL00219                                         02S0227 00930000
@DC00219 DS    0H                                               02S0228 00931000
*ELSE                                                           02S0228 00932000
*   VUALCSW = ON;                      /*FAKE THE 'NO UPDATE' COND'N */ 00933000
         B     @RC00218                                         02S0228 00934000
@RF00218 OI    VUALCSW,B'10000000'                              02S0228 00935000
*IF VUALCSW = ON THEN                  /*ANY OTHERS ALLOCATED        */ 00936000
@RC00218 TM    VUALCSW,B'10000000'                              02S0229 00937000
         BNO   @RF00229                                         02S0229 00938000
*  UPEDLSW = OFF;                      /*YES, UPDATE NOT REQUIRED    */ 00939000
         NI    UPEDLSW,B'01111111'                              02S0230 00940000
*END VUSCAN;                           /*RETURN TO CALLER            */ 00941000
@EL00006 DS    0H                                               02S0231 00942000
@EF00006 DS    0H                                               02S0231 00943000
@ER00006 LM    @14,@12,12(@13)                                  02S0231 00944000
         BR    @14                                              02S0231 00945000
*/********************************************************************/ 00946000
*/*                                                                  */ 00947000
*/* SEGMENT NAME - PROCAFF2                                          */ 00948000
*/*                                                                  */ 00949000
*/* DESCRIPTIVE NAME - AFFINITY PROCESSING ERROR HANDLER             */ 00950000
*/*                                                                  */ 00951000
*/* FUNCTION -                                                       */ 00952000
*/*    THE FUNCTION OF THIS ROUTINE IS TO DETERMINE THE TYPE OF      */ 00953000
*/*    ERROR WHICH HAS OCCURED DURING AN ATTEMPT TO ALLOCATE AN      */ 00954000
*/*    AFFINITY REQUEST AND PERFORM THE NECESSARY CLEANUP            */ 00955000
*/*    PROCESSING AND TO SET THE REQUIRED ERROR FLAGS AND RETURN     */ 00956000
*/*    CODES.                                                        */ 00957000
*/*                                                                  */ 00958000
*/*   OPERATION -                                                    */ 00959000
*/*     IF THE RETURN CODE RECEIVED AS INPUT INDICATES       @ZA03616*/ 00960000
*/*     A DADSM ERROR.                                       @ZA07122*/ 00961000
*/*     ALL VOLUNIT ENTRIES WITH THE SAME UNITID AS THE      @ZA03616*/ 00962000
*/*     FAILING REQUEST ARE MARKED WITH VUDNALOC AND         @ZA03616*/ 00963000
*/*     VUDADSME.                                            @ZA07122*/ 00964000
*/*                                                                  */ 00965000
*/* ENTRY - PROCAFF2                                                 */ 00966000
*/*   PURPOSE - SEE FUNCTION                                         */ 00967000
*/*                                                                  */ 00968000
*/*   INPUT -                                                        */ 00969000
*/*     RETCODE - INDICATION OF ERROR                                */ 00970000
*/*               12,IMPLIES A RECOVERABLE DADSM ERROR               */ 00971000
*/*     SIOTPTR - POINTER TO SIOT BEING PROCESSED                    */ 00972000
*/*     VOLUNPTR - POINTER TO VOLUNIT TABLE                          */ 00973000
*/*     AFFVUPTR - POINTER TO VU ENTRY SPECIFYING AFFINITY TO THE    */ 00974000
*/*                CURRENT VU ENTRY                                  */ 00975000
*/*                                                                  */ 00976000
*/* EXITS -                                                          */ 00977000
*/*                                                                  */ 00978000
*/*   CONDITION - ERROR DOES NOT REQUIRE SPECIAL PROCESSING          */ 00979000
*/*               BY THIS SEGMENT (NON-RECOVERABLE DADSM ERROR)      */ 00980000
*/*                                                                  */ 00981000
*/*      OUTPUT - NONE                                               */ 00982000
*/*                                                                  */ 00983000
*/*      RETURN CODE - 36                                            */ 00984000
*/*                                                                  */ 00985000
*/*   CONDITION - RECOVERABLE DADSM FAILURE                          */ 00986000
*/*                                                                  */ 00987000
*/*      OUTPUT - UPDATED VOLUNIT TABLE ENTRIES HAVING A UNITID      */ 00988000
*/*               MATCHING THAT OF FAILING REQUEST                   */ 00989000
*/*                                                                  */ 00990000
*/*         VUDADSME - INDICATES A DADSM ERROR ON THE VOLUME MOUNTED */ 00991000
*/*                    ON THIS UNIT                                  */ 00992000
*/*         VUDNALOC - SET IN ALL VU ENTRIES HAVING SAME UNITID AS   */ 00993000
*/*                    FAILING REQUEST                               */ 00994000
*/*         SIOTALCD = 0                                             */ 00995000
*/*         TOTREQS - INCREMENTED FOR SIOTS WHICH HAD BEEN MARKED    */ 00996000
*/*                     ALLOCATED                                    */ 00997000
*/*                                                                  */ 00998000
*/*   CONDITION - TAPE VALIDITY CHECK ERROR                          */ 00999000
*/*                                                                  */ 01000000
*/*     OUTPUT -                                                     */ 01001000
*/*       VUVINELG - SET IN ALL VU ENTRIES HAVING SAME UNITID AS     */ 01002000
*/*                  FAILING ENTRY                                   */ 01003000
*/*       VUDNALOC - SET IN ALL VU ENTRIES HAVING SAME UNITID AS     */ 01004000
*/*                  FAILING ENTRY                                   */ 01005000
*/*       SIOTALCD - 0                                       @ZA03616*/ 01006000
*/*       TOTREGS  - INCREMENTED FOR SIOTS WHICH HAD BEEN    @ZA03616*/ 01007000
*/*                  MARKED ALLOCATED                        @ZA03616*/ 01008000
*/*                                                                  */ 01009000
*/*     RETURN CODE - 40                                             */ 01010000
*/*                                                                  */ 01011000
*/********************************************************************/ 01012000
*PROCAFF2: PROC;                       /*                    @ZA03616*/ 01013000
PROCAFF2 STM   @14,@02,12(@13)                                  02S0232 01014000
         STM   @04,@12,36(@13)                                  02S0232 01015000
*IF RETCODE = DASMFAIL THEN            /*RECOVERABLE DADSM ERROR     */ 01016000
         CH    RETCODE,@CH00122                                 02S0233 01017000
         BNE   @RF00233                                         02S0233 01018000
*  DO;                                                          02S0234 01019000
*    TEMVUPTR = VOLUNPTR;              /*POINT TO BEGIN OF VU TABLE  */ 01020000
         L     @10,@PC00001+12                                  02S0235 01021000
         L     @10,ALCWAPTR(,@10)                               02S0235 01022000
         L     TEMVUPTR,VOLUNPTR(,@10)                          02S0235 01023000
*    DO AVUCTR2 = ONE TO NUMVUENT;     /*LOOP THRU ALL ENTRIES       */ 01024000
         LA    AVUCTR2,1                                        02S0236 01025000
         B     @DE00236                                         02S0236 01026000
@DL00236 DS    0H                                               02S0237 01027000
*      IF TEMVUPTR -> VOLUNTID = AFFVUPTR -> VOLUNTID THEN /*UNIT ID    01028000
*                                        MATCH THAT OF FAILED ENTRY? */ 01029000
         L     @10,AFFVUPTR                                     02S0237 01030000
         CLC   VOLUNTID(2,TEMVUPTR),VOLUNTID(@10)               02S0237 01031000
         BNE   @RF00237                                         02S0237 01032000
*        DO;                                                    02S0238 01033000
*          TEMVUPTR->VUDADSME = ON; /*INDICATE SO IN VUENTRY @ZA07122*/ 01034000
*          TEMVUPTR->VUDNALOC = ON;   /*INDICATE THAT THIS VU ENTRY     01035000
*                                         IS NOT TO BE PROCESSED        01036000
*                                         UNTIL RECOVERY             */ 01037000
         OI    VUDADSME(TEMVUPTR),B'00001100'                   02S0240 01038000
*          IF TEMVUPTR->VOLSIOTP->SIOTALCD= ON THEN /*SIOT ALLOCATED */ 01039000
         L     @10,VOLSIOTP(,TEMVUPTR)                          02S0241 01040000
         TM    SIOTALCD(@10),B'00000010'                        02S0241 01041000
         BNO   @RF00241                                         02S0241 01042000
*            DO;                      /*YES, MARK UNALLOCATED        */ 01043000
*              TEMVUPTR->VOLSIOTP->SIOTALCD=OFF;                02S0243 01044000
         NI    SIOTALCD(@10),B'11111101'                        02S0243 01045000
*              TOTREQS = TOTREQS + 1;  /*INCR REQS REMAINING @YM04227*/ 01046000
         L     @10,@PC00001+12                                  02S0244 01047000
         L     @10,ALCWAPTR(,@10)                               02S0244 01048000
         LA    @06,1                                            02S0244 01049000
         AL    @06,TOTREQS(,@10)                                02S0244 01050000
         ST    @06,TOTREQS(,@10)                                02S0244 01051000
*            END;                                               02S0245 01052000
*          ELSE;                       /*SIOT NOT ALLOCATED          */ 01053000
@RF00241 DS    0H                                               02S0247 01054000
*        END;                                                   02S0247 01055000
*      ELSE;                                                    02S0248 01056000
@RF00237 DS    0H                                               02S0249 01057000
*      TEMVUPTR = TEMVUPTR + VOLENTLN; /*INCR TO NEXT VU ENTRY       */ 01058000
         AL    TEMVUPTR,VOLENTLN                                02S0249 01059000
*    END;                                                       02S0250 01060000
         AH    AVUCTR2,@CH00046                                 02S0250 01061000
@DE00236 CR    AVUCTR2,NUMVUENT                                 02S0250 01062000
         BNH   @DL00236                                         02S0250 01063000
*      RETCODE = AFFCLEAN;             /*INDICATE RECOVERABLE ERROR     01064000
*                                        DURING AFFINITY PROCESSING  */ 01065000
         LA    RETCODE,32                                       02S0251 01066000
*  END;                                                         02S0252 01067000
*ELSE                                   /*NOT RECOVERABLE DADSM 02S0253 01068000
*                                         ERROR                      */ 01069000
*  RETCODE = ERROR;                     /*SET RETURN CODE 36         */ 01070000
         B     @RC00233                                         02S0253 01071000
@RF00233 LA    RETCODE,36                                       02S0253 01072000
*END PROCAFF2;                         /*                    @ZA03616*/ 01073000
@EL00007 DS    0H                                               02S0254 01074000
@EF00007 DS    0H                                               02S0254 01075000
@ER00007 LM    @14,@02,12(@13)                                  02S0254 01076000
         LM    @04,@12,36(@13)                                  02S0254 01077000
         BR    @14                                              02S0254 01078000
*END IEFAB432                                                   01S0255 01079000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 01080000
*/*%INCLUDE SYSLIB  (A432SPEC)                                        * 01081000
*/*%INCLUDE SYSLIB  (A432DATA)                                        * 01082000
*/*%INCLUDE SYSLIB  (IEFASIOT)                                        * 01083000
*/*%INCLUDE SYSLIB  (IEFUCBOB)                                        * 01084000
*/*%INCLUDE SYSLIB  (IEFZB422)                                        * 01085000
*/*%INCLUDE SYSLIB  (IEFZB425)                                        * 01086000
*/*%INCLUDE SYSLIB  (IEFZB423)                                        * 01087000
*/*%INCLUDE SYSLIB  (IEFZB430)                                        * 01088000
*/*%INCLUDE SYSLIB  (IEFZB431)                                        * 01089000
*/*%INCLUDE SYSLIB  (AFFPROC )                                        * 01090000
*/*%INCLUDE SYSLIB  (AFFSPEC )                                        * 01091000
*/*%INCLUDE SYSLIB  (BLD434PM)                                        * 01092000
*/*%INCLUDE SYSLIB  (BL434SPC)                                        * 01093000
*/*%INCLUDE SYSLIB  (FINDEDL2)                                        * 01094000
*/*%INCLUDE SYSLIB  (FEDL2SPC)                                        * 01095000
*/*%INCLUDE SYSLIB  (UPDEDL  )                                        * 01096000
*/*%INCLUDE SYSLIB  (UPEDLSPC)                                        * 01097000
*/*%INCLUDE SYSLIB  (VUSCAN  )                                        * 01098000
*/*%INCLUDE SYSLIB  (VUSNSPEC)                                        * 01099000
*/*%INCLUDE SYSLIB  (PROCAFF2)                                        * 01100000
*/*%INCLUDE SYSLIB  (PAF2SPEC)                                        * 01101000
*;                                                              01S0255 01102000
@DATA    DS    0H                                                       01103000
@CH00046 DC    H'1'                                                     01104000
@CH00122 DC    H'12'                                                    01105000
@CH00128 DC    H'20'                                                    01106000
@DATD    DSECT                                                          01107000
         DS    0F                                                       01108000
@SA00001 DS    18F                                                      01109000
@PC00001 DS    5F                                                       01110000
@SA00002 DS    14F                                                      01111000
@AL00001 DS    8A                                                       01112000
IEFAB432 CSECT                                                          01113000
         DS    0F                                                       01114000
@CF00138 DC    F'0'                                                     01115000
@CF00940 DC    F'-4'                                                    01116000
@DATD    DSECT                                                          01117000
         DS    0D                                                       01118000
AFFVUPTR DS    A                                                        01119000
EREQPTR  DS    A                                                        01120000
SIOTPTR  DS    A                                                        01121000
UCBDATAP DS    A                                                        01122000
VMVREQBP DS    A                                                        01123000
GROUPID  DS    F                                                        01124000
ALTVUP   DS    A                                                        01125000
SIOTCTR  DS    F                                                        01126000
TEMVUP   DS    A                                                        01127000
LUINDEX  DS    H                                                        01128000
         DS    CL2                                                      01129000
ARUINDIC DS    BL4                                                      01130000
         ORG   ARUINDIC                                                 01131000
ARUETUPD DS    BL1                                                      01132000
ARUUSECT EQU   ARUINDIC+0                                               01133000
ARUAFF   EQU   ARUINDIC+0                                               01134000
ARUVLCHK EQU   ARUINDIC+0                                               01135000
ARUUSEAT EQU   ARUINDIC+0                                               01136000
ARUUPDAL EQU   ARUINDIC+0                                               01137000
ARUVOLSW EQU   ARUINDIC+0                                               01138000
@NM00002 EQU   ARUINDIC+0                                               01139000
         ORG   ARUINDIC+4                                               01140000
ARUWORD  DS    CL4                                                      01141000
         ORG   ARUWORD                                                  01142000
ARURLPOS DS    FL2                                                      01143000
ARUNODEV DS    FL2                                                      01144000
         ORG   ARUWORD+4                                                01145000
DEVMATSW DS    BL1                                                      01146000
FUNCS    DS    BL1                                                      01147000
         ORG   FUNCS                                                    01148000
NEWDEV   DS    BL1                                                      01149000
ARUFUNC  EQU   FUNCS+0                                                  01150000
AFFBIT   EQU   FUNCS+0                                                  01151000
         ORG   FUNCS+1                                                  01152000
NOTALCSW DS    BL1                                                      01153000
TYPSTORE DS    CL4                                                      01154000
         ORG   TYPSTORE                                                 01155000
@NM00003 DS    BL1                                                      01156000
TYPBYT2  DS    BL1                                                      01157000
@NM00004 DS    BL1                                                      01158000
TYPBYT4  DS    BL1                                                      01159000
         ORG   TYPSTORE+4                                               01160000
UCBMATSW DS    BL1                                                      01161000
UPEDLSW  DS    BL1                                                      01162000
VUALCSW  DS    BL1                                                      01163000
UCBDATA  DS    CL9                                                      01164000
         ORG   UCBDATA                                                  01165000
@NM00005 DS    CL2                                                      01166000
VOLUMEID DS    CL6                                                      01167000
@NM00006 DS    CL1                                                      01168000
         ORG   UCBDATA+9                                                01169000
AFFOUND  DS    BL1                                                      01170000
ETIORB   DS    CL42                                                     01171000
TYPMATCH DS    BL1                                                      01172000
         DS    CL1                                                      01173000
VMVRB    DS    CL52                                                     01174000
@OLDKEY  DS    AL1                                                      01175000
IEFAB432 CSECT                                                          01176000
         DS    0F                                                       01177000
@SIZDATD DC    AL1(230)                                                 01178000
         DC    AL3(@ENDDATD-@DATD)                                      01179000
@CV00095 DC    V(IEFAB434)                                              01180000
@CV00096 DC    V(IEFAB441)                                              01181000
@CV00097 DC    V(IEFAB4F2)                                              01182000
         DS    0D                                                       01183000
VOLENTLN DC    AL4(28)                                                  01184000
FUNC441  DC    B'00000000'                                              01185000
NOVOLSER DC    X'000000000000'                                          01186000
IEFAB432 CSECT                                                          01187000
         DS   0H                                                        01188000
A432PTCH DC ((@DATA-@PSTART)/20)X'00'                                   01189000
@DATD    DSECT                                                          01190000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                01191000
@ENDDATD EQU   *                                                        01192000
IEFAB432 CSECT                                                          01193000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       01194000
@01      EQU   01                                                       01195000
@02      EQU   02                                                       01196000
@03      EQU   03                                                       01197000
@04      EQU   04                                                       01198000
@05      EQU   05                                                       01199000
@06      EQU   06                                                       01200000
@07      EQU   07                                                       01201000
@08      EQU   08                                                       01202000
@09      EQU   09                                                       01203000
@10      EQU   10                                                       01204000
@11      EQU   11                                                       01205000
@12      EQU   12                                                       01206000
@13      EQU   13                                                       01207000
@14      EQU   14                                                       01208000
@15      EQU   15                                                       01209000
UCBENTNO EQU   @06                                                      01210000
TVUCTR   EQU   @03                                                      01211000
RETCODE  EQU   @03                                                      01212000
NUMVUENT EQU   @07                                                      01213000
AVUCTR2  EQU   @03                                                      01214000
AVUCTR1  EQU   @05                                                      01215000
AVUCTR   EQU   @09                                                      01216000
TVUPTR   EQU   @05                                                      01217000
TEMVUPTR EQU   @02                                                      01218000
SAVEDLP  EQU   @02                                                      01219000
EDLUCBLP EQU   @08                                                      01220000
EDLPTR   EQU   @04                                                      01221000
EDLGNTP  EQU   @05                                                      01222000
AVUPTR   EQU   @02                                                      01223000
REG15    EQU   @15                                                      01224000
VOLUNTAB EQU   0                                                        01225000
VOLID    EQU   VOLUNTAB                                                 01226000
VOLSTAT  EQU   VOLUNTAB+6                                               01227000
VOLSTATA EQU   VOLSTAT                                                  01228000
VOLSPEC  EQU   VOLSTATA                                                 01229000
VOLSTATB EQU   VOLSTAT+1                                                01230000
VOLALOC  EQU   VOLSTATB                                                 01231000
VDEVREQD EQU   VOLSTATB                                                 01232000
VUDNALOC EQU   VOLSTATB                                                 01233000
VUDADSME EQU   VOLSTATB                                                 01234000
VUVINELG EQU   VOLSTATB                                                 01235000
VOLSTATC EQU   VOLSTAT+2                                                01236000
VOLSTATD EQU   VOLSTAT+3                                                01237000
VOLUNTID EQU   VOLUNTAB+10                                              01238000
VOLSIOTP EQU   VOLUNTAB+16                                              01239000
INDMSIOT EQU   0                                                        01240000
SCTUSADD EQU   INDMSIOT+20                                              01241000
SIOTOTUN EQU   INDMSIOT+39                                              01242000
SIOTBYT1 EQU   INDMSIOT+43                                              01243000
SIOTALCD EQU   SIOTBYT1                                                 01244000
SIOTBYT3 EQU   INDMSIOT+46                                              01245000
SIOTTSTC EQU   INDMSIOT+47                                              01246000
SIOTBYT0 EQU   INDMSIOT+52                                              01247000
SCTSDISP EQU   INDMSIOT+55                                              01248000
SCTSBYT1 EQU   INDMSIOT+56                                              01249000
SCTSBYT2 EQU   INDMSIOT+57                                              01250000
SCTSBYT3 EQU   INDMSIOT+58                                              01251000
SCTSNEW  EQU   SCTSBYT3                                                 01252000
SCTSBYT4 EQU   INDMSIOT+59                                              01253000
SCTUTYPE EQU   INDMSIOT+60                                              01254000
SIOTDEVT EQU   SCTUTYPE                                                 01255000
SIOUBYT3 EQU   SIOTDEVT+2                                               01256000
SIOTALTD EQU   INDMSIOT+92                                              01257000
SIOTBYT2 EQU   INDMSIOT+103                                             01258000
SIOTRSNC EQU   INDMSIOT+130                                             01259000
SIOTEDLP EQU   INDMSIOT+136                                             01260000
SVOLUNAD EQU   INDMSIOT+140                                             01261000
SIOTETIO EQU   INDMSIOT+148                                             01262000
SVOLUNNO EQU   INDMSIOT+168                                             01263000
UCB      EQU   0                                                        01264000
UCBOB    EQU   0                                                        01265000
UCBJBNR  EQU   UCBOB                                                    01266000
UCBFL5   EQU   UCBOB+1                                                  01267000
UCBAF    EQU   UCBFL5                                                   01268000
UCBSTAT  EQU   UCBOB+3                                                  01269000
UCBRESV  EQU   UCBSTAT                                                  01270000
UCBPRES  EQU   UCBSTAT                                                  01271000
UCBCHAN  EQU   UCBOB+4                                                  01272000
UCBSFLS  EQU   UCBOB+6                                                  01273000
UCBFLA   EQU   UCBSFLS                                                  01274000
UCBFL1   EQU   UCBFLA                                                   01275000
UCBBSY   EQU   UCBFL1                                                   01276000
UCBNRY   EQU   UCBFL1                                                   01277000
UCBPST   EQU   UCBFL1                                                   01278000
UCBCUB   EQU   UCBFL1                                                   01279000
UCBFLB   EQU   UCBSFLS+1                                                01280000
UCBCHM   EQU   UCBOB+8                                                  01281000
UCBCHM1  EQU   UCBCHM                                                   01282000
UCBPTH0  EQU   UCBCHM1                                                  01283000
UCBPTH1  EQU   UCBCHM1                                                  01284000
UCBWGT   EQU   UCBOB+12                                                 01285000
UCBTYP   EQU   UCBOB+16                                                 01286000
UCBTBYT1 EQU   UCBTYP                                                   01287000
UCB1FEA5 EQU   UCBTBYT1                                                 01288000
UCB1FEA6 EQU   UCBTBYT1                                                 01289000
UCBTBYT2 EQU   UCBTYP+1                                                 01290000
UCB2OPT2 EQU   UCBTBYT2                                                 01291000
UCBDUDN1 EQU   UCB2OPT2                                                 01292000
UCB2OPT3 EQU   UCBTBYT2                                                 01293000
UCBDUDN2 EQU   UCB2OPT3                                                 01294000
UCB2OPT4 EQU   UCBTBYT2                                                 01295000
UCBRWTAU EQU   UCB2OPT4                                                 01296000
UCB2OPT6 EQU   UCBTBYT2                                                 01297000
UCB2OPT7 EQU   UCBTBYT2                                                 01298000
UCBTBYT3 EQU   UCBTYP+2                                                 01299000
UCBDVCLS EQU   UCBTBYT3                                                 01300000
UCB3TAPE EQU   UCBDVCLS                                                 01301000
UCB3DACC EQU   UCBDVCLS                                                 01302000
UCB3DISP EQU   UCBDVCLS                                                 01303000
UCB3UREC EQU   UCBDVCLS                                                 01304000
UCBTBYT4 EQU   UCBTYP+3                                                 01305000
UCBEXTPT EQU   UCBOB+20                                                 01306000
UCBFLC   EQU   UCBEXTPT                                                 01307000
UCBDEV   EQU   UCBOB+24                                                 01308000
UCBCMEXT EQU   0                                                        01309000
UCBATI   EQU   UCBCMEXT+3                                               01310000
@NM00026 EQU   UCBATI                                                   01311000
UCBFLP1  EQU   UCBCMEXT+5                                               01312000
UCBMT    EQU   0                                                        01313000
UCBOCR   EQU   0                                                        01314000
UCB3540X EQU   0                                                        01315000
UCBDKBYT EQU   UCB3540X+6                                               01316000
UCBUCS   EQU   0                                                        01317000
UCBUCSOP EQU   UCBUCS+4                                                 01318000
UCBFCBOP EQU   UCBUCS+5                                                 01319000
IEFEDL   EQU   0                                                        01320000
EDLHDR   EQU   IEFEDL                                                   01321000
EDLFGENP EQU   EDLHDR+8                                                 01322000
EDLUVFLG EQU   EDLHDR+16                                                01323000
EDLMGENS EQU   EDLUVFLG                                                 01324000
EDLENTRY EQU   0                                                        01325000
EDLNXTNT EQU   EDLENTRY                                                 01326000
EDLDEVT  EQU   EDLENTRY+4                                               01327000
EDLGRPTR EQU   EDLENTRY+12                                              01328000
EDLDTFLG EQU   EDLENTRY+20                                              01329000
EINDEVTP EQU   EDLDTFLG                                                 01330000
EDLGNTRY EQU   0                                                        01331000
EDLNXGRP EQU   EDLGNTRY                                                 01332000
EDLUCBNO EQU   EDLGNTRY+4                                               01333000
EDLLISTP EQU   EDLGNTRY+8                                               01334000
EDLGRID  EQU   EDLGNTRY+12                                              01335000
EDLGRFLG EQU   EDLGNTRY+16                                              01336000
EDLUCBL  EQU   0                                                        01337000
EDLUCBAD EQU   EDLUCBL                                                  01338000
EDLINDIC EQU   EDLUCBL+2                                                01339000
EDLALCD  EQU   EDLINDIC                                                 01340000
ALCWA    EQU   0                                                        01341000
FAILRSCP EQU   ALCWA+20                                                 01342000
CNTABLE  EQU   ALCWA+28                                                 01343000
TOTREQS  EQU   CNTABLE+36                                               01344000
TOTVOLUN EQU   CNTABLE+44                                               01345000
VOLUNPTR EQU   ALCWA+80                                                 01346000
VOLUNSZE EQU   ALCWA+84                                                 01347000
INDICATE EQU   ALCWA+112                                                01348000
INDRETRY EQU   INDICATE                                                 01349000
@NM00029 EQU   ALCWA+113                                                01350000
TIOTHDRP EQU   ALCWA+120                                                01351000
CANCELP  EQU   ALCWA+140                                                01352000
NAMES    EQU   0                                                        01353000
ETIOTREQ EQU   0                                                        01354000
EREQMAP  EQU   ETIOTREQ                                                 01355000
EREQSTAT EQU   ETIOTREQ+2                                               01356000
VMVRQBLK EQU   0                                                        01357000
VMVFNMAP EQU   VMVRQBLK                                                 01358000
VMVOPTB1 EQU   VMVFNMAP                                                 01359000
VMVOPTB2 EQU   VMVFNMAP+1                                               01360000
VMVOPTB3 EQU   VMVFNMAP+2                                               01361000
VMVMINFO EQU   VMVRQBLK+40                                              01362000
VMVACTON EQU   VMVMINFO                                                 01363000
VMVUSER  EQU   VMVRQBLK+48                                              01364000
CANCLECB EQU   0                                                        01365000
FAILRSC  EQU   0                                                        01366000
UCBBGN   EQU   0                                                        01367000
SVSIOPTR EQU   0                                                        01368000
VUPTR    EQU   0                                                        01369000
UCBPTR   EQU   0                                                        01370000
ALCWAPTR EQU   0                                                        01371000
AFUNCMAP EQU   0                                                        01372000
UPALOK   EQU   AFUNCMAP                                                 01373000
UCBOBS01 EQU   UCBDEV                                                   01374000
UCBVOLI  EQU   UCBOBS01+4                                               01375000
UCBSTAB  EQU   UCBOBS01+10                                              01376000
UCBBSVL  EQU   UCBSTAB                                                  01377000
UCBPRSRS EQU   UCBSTAB                                                  01378000
UCBDMCT  EQU   UCBOBS01+11                                              01379000
UCBFL4   EQU   UCBOBS01+13                                              01380000
UCBOBS02 EQU   UCBDEV                                                   01381000
UCBTFL1  EQU   UCBOBS02+19                                              01382000
UCBXTN   EQU   UCBOBS02+20                                              01383000
UCBVOPT  EQU   UCBXTN                                                   01384000
UCBOBS03 EQU   UCBDEV                                                   01385000
UCBXTADR EQU   UCBOBS03                                                 01386000
UCBOBS04 EQU   UCBDEV                                                   01387000
UCBBTA   EQU   UCBOBS04+12                                              01388000
UCBOBS06 EQU   UCBDEV                                                   01389000
UCBAOF   EQU   UCBOBS06                                                 01390000
UCBAOF1  EQU   UCBAOF                                                   01391000
UCBAOF2  EQU   UCBAOF+1                                                 01392000
@NM00025 EQU   UCBOBS06+3                                               01393000
UCBIRB   EQU   UCBOBS06+4                                               01394000
UCBGRAF  EQU   UCBIRB                                                   01395000
UCBLDNCA EQU   UCBOBS06+8                                               01396000
UCBRDYQ  EQU   UCBLDNCA                                                 01397000
UCBIRLN  EQU   UCBRDYQ                                                  01398000
UCBLDNCB EQU   UCBRDYQ+1                                                01399000
UCBCTLNK EQU   UCBOBS06+12                                              01400000
UCBOBS07 EQU   UCBDEV                                                   01401000
UCBOBS08 EQU   UCBDEV                                                   01402000
UCBOBS09 EQU   UCBDEV                                                   01403000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    01404000
UCBRV066 EQU   UCBOBS09+4                                               01405000
UCBIOSBA EQU   UCBOBS09                                                 01406000
UCBRV042 EQU   UCBOBS08+5                                               01407000
UCBCTCF1 EQU   UCBOBS08+4                                               01408000
UCBCTCAD EQU   UCBOBS08                                                 01409000
UCBICNCB EQU   UCBOBS07+4                                               01410000
UCBRV040 EQU   UCBOBS07                                                 01411000
UCBCTLNA EQU   UCBCTLNK+1                                               01412000
UCBRLN   EQU   UCBCTLNK                                                 01413000
UCBRDYQA EQU   UCBLDNCB                                                 01414000
UCBINRLN EQU   UCBIRLN                                                  01415000
UCBIRBA  EQU   UCBIRB+1                                                 01416000
UCBRV039 EQU   UCBGRAF                                                  01417000
UCBDWNR  EQU   UCBGRAF                                                  01418000
UCBRPND  EQU   UCBGRAF                                                  01419000
UCBUPM   EQU   UCBGRAF                                                  01420000
UCBBTAM  EQU   UCBGRAF                                                  01421000
UCBDRNO  EQU   UCBGRAF                                                  01422000
UCBDRO   EQU   UCBGRAF                                                  01423000
UCBOIP   EQU   UCBGRAF                                                  01424000
UCBATRCD EQU   @NM00025                                                 01425000
UCBSKPFG EQU   @NM00025                                                 01426000
UCBRIPND EQU   @NM00025                                                 01427000
UCBRTIAC EQU   @NM00025                                                 01428000
UCBRSV79 EQU   @NM00025                                                 01429000
UCBRSV78 EQU   @NM00025                                                 01430000
UCBRSV77 EQU   @NM00025                                                 01431000
UCBOLTEP EQU   @NM00025                                                 01432000
UCBATNCT EQU   UCBOBS06+2                                               01433000
UCBRSV76 EQU   UCBAOF2                                                  01434000
UCBRSV75 EQU   UCBAOF2                                                  01435000
UCBRSV74 EQU   UCBAOF2                                                  01436000
UCBRSV73 EQU   UCBAOF2                                                  01437000
UCBRSV72 EQU   UCBAOF2                                                  01438000
UCBRSV71 EQU   UCBAOF2                                                  01439000
UCBRSV70 EQU   UCBAOF2                                                  01440000
UCBRSV69 EQU   UCBAOF2                                                  01441000
UCBRSV68 EQU   UCBAOF1                                                  01442000
UCBRSV67 EQU   UCBAOF1                                                  01443000
UCBRSV66 EQU   UCBAOF1                                                  01444000
UCBRSV65 EQU   UCBAOF1                                                  01445000
UCBRSV64 EQU   UCBAOF1                                                  01446000
UCBOFNL  EQU   UCBAOF1                                                  01447000
UCBOFSP  EQU   UCBAOF1                                                  01448000
UCBOFMCR EQU   UCBAOF1                                                  01449000
UCBBTB   EQU   UCBBTA+1                                                 01450000
UCBDI    EQU   UCBBTA                                                   01451000
UCBSNS   EQU   UCBOBS04+8                                               01452000
UCBTEB   EQU   UCBOBS04+4                                               01453000
UCBGCB   EQU   UCBOBS04+3                                               01454000
UCBOPEN  EQU   UCBOBS04+2                                               01455000
UCBSTART EQU   UCBOBS04                                                 01456000
UCBXTNB  EQU   UCBXTN+1                                                 01457000
UCBRSV22 EQU   UCBVOPT                                                  01458000
UCBRSV21 EQU   UCBVOPT                                                  01459000
UCBRSV20 EQU   UCBVOPT                                                  01460000
UCBESVE  EQU   UCBVOPT                                                  01461000
UCBERPC  EQU   UCBVOPT                                                  01462000
UCBESVC  EQU   UCBVOPT                                                  01463000
UCBEVA   EQU   UCBVOPT                                                  01464000
UCBESV   EQU   UCBVOPT                                                  01465000
UCBRV009 EQU   UCBTFL1                                                  01466000
UCBRV008 EQU   UCBTFL1                                                  01467000
UCBRV007 EQU   UCBTFL1                                                  01468000
UCBRV006 EQU   UCBTFL1                                                  01469000
UCBRV005 EQU   UCBTFL1                                                  01470000
UCBRV038 EQU   UCBTFL1                                                  01471000
UCBNSLTP EQU   UCBTFL1                                                  01472000
UCBNLTP  EQU   UCBTFL1                                                  01473000
UCBRES1B EQU   UCBOBS02+18                                              01474000
UCBFSER  EQU   UCBOBS02+12                                              01475000
@NM00024 EQU   UCBOBS02+4                                               01476000
UCBFSEQ  EQU   UCBOBS02+2                                               01477000
UCBFSCT  EQU   UCBOBS02                                                 01478000
UCBNEXP  EQU   UCBOBS01+20                                              01479000
UCBBASE  EQU   UCBOBS01+16                                              01480000
UCBRES1A EQU   UCBOBS01+15                                              01481000
UCBUSER  EQU   UCBOBS01+14                                              01482000
UCBFL47  EQU   UCBFL4                                                   01483000
UCBFL46  EQU   UCBFL4                                                   01484000
UCBFL45  EQU   UCBFL4                                                   01485000
UCBRV065 EQU   UCBFL4                                                   01486000
UCBDSS   EQU   UCBFL4                                                   01487000
UCBRV028 EQU   UCBFL4                                                   01488000
UCBWDAV  EQU   UCBFL4                                                   01489000
UCBDAVV  EQU   UCBFL4                                                   01490000
UCBSQC   EQU   UCBOBS01+12                                              01491000
UCBDATP  EQU   UCBOBS01+12                                              01492000
UCBDMC   EQU   UCBDMCT                                                  01493000
UCBMOUNT EQU   UCBDMCT                                                  01494000
UCBBNUL  EQU   UCBSTAB                                                  01495000
UCBSHAR  EQU   UCBSTAB                                                  01496000
UCBBSTR  EQU   UCBSTAB                                                  01497000
UCBBPUB  EQU   UCBSTAB                                                  01498000
UCBBPRV  EQU   UCBSTAB                                                  01499000
UCBBALB  EQU   UCBPRSRS                                                 01500000
UCBPGFL  EQU   UCBSTAB                                                  01501000
UCBDVSHR EQU   UCBBSVL                                                  01502000
UCBVTOC  EQU   UCBOBS01                                                 01503000
@NM00001 EQU   AFUNCMAP                                                 01504000
VOLSWOK  EQU   AFUNCMAP                                                 01505000
@NM00042 EQU   VMVUSER                                                  01506000
VMVPROCD EQU   VMVUSER                                                  01507000
VMVVUNTP EQU   VMVRQBLK+44                                              01508000
@NM00041 EQU   VMVMINFO+1                                               01509000
@NM00040 EQU   VMVACTON                                                 01510000
VMVRTAIN EQU   VMVACTON                                                 01511000
VMVDSMT  EQU   VMVACTON                                                 01512000
VMVKEEP  EQU   VMVACTON                                                 01513000
VMVRETCD EQU   VMVRQBLK+36                                              01514000
VMVJSNMP EQU   VMVRQBLK+32                                              01515000
VMVDSNMP EQU   VMVRQBLK+28                                              01516000
VMVJBNMP EQU   VMVRQBLK+24                                              01517000
VMVMVLSR EQU   VMVRQBLK+18                                              01518000
VMVUVLSR EQU   VMVRQBLK+12                                              01519000
VMVUCBP  EQU   VMVRQBLK+9                                               01520000
@NM00039 EQU   VMVRQBLK+8                                               01521000
VMVNREQP EQU   VMVRQBLK+4                                               01522000
VMVOPTB4 EQU   VMVFNMAP+3                                               01523000
@NM00038 EQU   VMVOPTB3                                                 01524000
VMVNUMSG EQU   VMVOPTB3                                                 01525000
VMVCUVOL EQU   VMVOPTB3                                                 01526000
VMVDUPVL EQU   VMVOPTB3                                                 01527000
VMVNSPVT EQU   VMVOPTB2                                                 01528000
VMVNSLTP EQU   VMVOPTB2                                                 01529000
VMVSLTAP EQU   VMVOPTB2                                                 01530000
VMVNLTAP EQU   VMVOPTB2                                                 01531000
VMVALTAP EQU   VMVOPTB2                                                 01532000
VMVSTRG  EQU   VMVOPTB2                                                 01533000
VMVPUBLC EQU   VMVOPTB2                                                 01534000
VMVPRIVT EQU   VMVOPTB2                                                 01535000
VMVVDEND EQU   VMVOPTB1                                                 01536000
VMVVRLBL EQU   VMVOPTB1                                                 01537000
VMVDWTOR EQU   VMVOPTB1                                                 01538000
VMVMTMSG EQU   VMVOPTB1                                                 01539000
VMVMOUNT EQU   VMVOPTB1                                                 01540000
VMVREWND EQU   VMVOPTB1                                                 01541000
VMVUCB   EQU   VMVOPTB1                                                 01542000
VMVUNLOD EQU   VMVOPTB1                                                 01543000
EREQCODE EQU   ETIOTREQ+40                                              01544000
EREQJSCB EQU   ETIOTREQ+36                                              01545000
EREQGRID EQU   ETIOTREQ+32                                              01546000
EREQDEVS EQU   ETIOTREQ+30                                              01547000
EREQRPOS EQU   ETIOTREQ+28                                              01548000
EREQUCB  EQU   ETIOTREQ+24                                              01549000
EREQSIOT EQU   ETIOTREQ+20                                              01550000
@NM00037 EQU   ETIOTREQ+19                                              01551000
EREQSSVA EQU   ETIOTREQ+16                                              01552000
@NM00036 EQU   ETIOTREQ+15                                              01553000
EREQJSVA EQU   ETIOTREQ+12                                              01554000
EREQDDNM EQU   ETIOTREQ+4                                               01555000
@NM00035 EQU   EREQSTAT                                                 01556000
EREQCATL EQU   EREQSTAT                                                 01557000
EREQJSCT EQU   EREQSTAT                                                 01558000
EREQPASS EQU   EREQSTAT                                                 01559000
EREQUNAL EQU   EREQSTAT                                                 01560000
EREQVAM  EQU   EREQSTAT                                                 01561000
EREQQNM  EQU   EREQSTAT                                                 01562000
EREQTERM EQU   EREQSTAT                                                 01563000
@NM00034 EQU   EREQMAP                                                  01564000
EREQMOVE EQU   EREQMAP                                                  01565000
EREQUPD  EQU   EREQMAP                                                  01566000
EREQBLD  EQU   EREQMAP                                                  01567000
ALCPROCN EQU   NAMES+16                                                 01568000
ALCSTEPN EQU   NAMES+8                                                  01569000
ALCJOBN  EQU   NAMES                                                    01570000
EXITPRMP EQU   ALCWA+144                                                01571000
WORK3MP  EQU   ALCWA+136                                                01572000
WMASK2P  EQU   ALCWA+132                                                01573000
WMASKPTR EQU   ALCWA+128                                                01574000
LGENLOCK EQU   ALCWA+124                                                01575000
TCBP     EQU   ALCWA+116                                                01576000
ALCWASID EQU   ALCWA+114                                                01577000
@NM00030 EQU   @NM00029                                                 01578000
NODEVERR EQU   @NM00029                                                 01579000
NEEDRCVY EQU   @NM00029                                                 01580000
ALCWAREC EQU   @NM00029                                                 01581000
WAITIGEN EQU   @NM00029                                                 01582000
UNITRECS EQU   @NM00029                                                 01583000
ALCWADUL EQU   INDICATE                                                 01584000
ALCWISAM EQU   INDICATE                                                 01585000
DSSUNIT  EQU   INDICATE                                                 01586000
DSSTAPE  EQU   INDICATE                                                 01587000
PRIVASUM EQU   INDICATE                                                 01588000
INDREQU  EQU   INDICATE                                                 01589000
INDWAIT  EQU   INDICATE                                                 01590000
QMGRRBP  EQU   ALCWA+108                                                01591000
RIMTABCT EQU   ALCWA+104                                                01592000
RIMTABLN EQU   ALCWA+100                                                01593000
RIMTABP  EQU   ALCWA+96                                                 01594000
ALGTABSZ EQU   ALCWA+92                                                 01595000
ALGTABP  EQU   ALCWA+88                                                 01596000
@NM00028 EQU   ALCWA+78                                                 01597000
LTUNITID EQU   ALCWA+76                                                 01598000
NUMREQS  EQU   CNTABLE+40                                               01599000
OTHEREQS EQU   CNTABLE+32                                               01600000
SUBSREQS EQU   CNTABLE+28                                               01601000
STRGREQS EQU   CNTABLE+24                                               01602000
PUBLREQS EQU   CNTABLE+20                                               01603000
PVTNREQS EQU   CNTABLE+16                                               01604000
SPECREQS EQU   CNTABLE+12                                               01605000
TPREQS   EQU   CNTABLE+8                                                01606000
VAMREQS  EQU   CNTABLE+4                                                01607000
DMYREQS  EQU   CNTABLE                                                  01608000
EDTABPTR EQU   ALCWA+24                                                 01609000
IOSLUTP  EQU   ALCWA+16                                                 01610000
JSCBPTR  EQU   ALCWA+12                                                 01611000
SIOT1P   EQU   ALCWA+8                                                  01612000
FMAPPTR  EQU   ALCWA+4                                                  01613000
WASIZE   EQU   ALCWA                                                    01614000
EDLNOJES EQU   EDLINDIC                                                 01615000
EDLVOLAF EQU   EDLINDIC                                                 01616000
EDLENQ   EQU   EDLINDIC                                                 01617000
EDLDADSM EQU   EDLINDIC                                                 01618000
EDLJINEL EQU   EDLGRFLG                                                 01619000
@NM00027 EQU   EDLENTRY+18                                              01620000
EDLNSCNT EQU   EDLENTRY+16                                              01621000
EDLGRPNO EQU   EDLENTRY+8                                               01622000
EDLVAM   EQU   EDLUVFLG                                                 01623000
EDLGMTP  EQU   EDLHDR+12                                                01624000
EDLGENNO EQU   EDLHDR+4                                                 01625000
EDLLUV   EQU   EDLHDR                                                   01626000
UCBERADR EQU   UCBUCS+12                                                01627000
UCBFCBID EQU   UCBUCS+8                                                 01628000
UCBERCNT EQU   UCBUCS+7                                                 01629000
UCBRSV51 EQU   UCBUCS+6                                                 01630000
UCBRSV50 EQU   UCBFCBOP                                                 01631000
UCBRSV49 EQU   UCBFCBOP                                                 01632000
UCBRSV48 EQU   UCBFCBOP                                                 01633000
UCBRSV47 EQU   UCBFCBOP                                                 01634000
UCBRSV46 EQU   UCBFCBOP                                                 01635000
UCBRSV45 EQU   UCBFCBOP                                                 01636000
UCBRSV44 EQU   UCBFCBOP                                                 01637000
UCBFCBO1 EQU   UCBFCBOP                                                 01638000
UCBUCSPE EQU   UCBUCSOP                                                 01639000
UCBRSV43 EQU   UCBUCSOP                                                 01640000
UCBRSV42 EQU   UCBUCSOP                                                 01641000
UCBRSV41 EQU   UCBUCSOP                                                 01642000
UCBRSV40 EQU   UCBUCSOP                                                 01643000
UCBRSV39 EQU   UCBUCSOP                                                 01644000
UCBUCSO2 EQU   UCBUCSOP                                                 01645000
UCBUCSO1 EQU   UCBUCSOP                                                 01646000
UCBUCSID EQU   UCBUCS                                                   01647000
UCBRV073 EQU   UCB3540X+7                                               01648000
UCBRV072 EQU   UCBDKBYT                                                 01649000
UCBRV071 EQU   UCBDKBYT                                                 01650000
UCBRV070 EQU   UCBDKBYT                                                 01651000
UCBRV069 EQU   UCBDKBYT                                                 01652000
UCBRV068 EQU   UCBDKBYT                                                 01653000
UCBRV067 EQU   UCBDKBYT                                                 01654000
UCBVLVER EQU   UCBDKBYT                                                 01655000
UCBDKAMX EQU   UCBDKBYT                                                 01656000
UCBVLSER EQU   UCB3540X                                                 01657000
UCBRDATA EQU   UCBOCR+4                                                 01658000
UCBFRID  EQU   UCBOCR                                                   01659000
UCBCLN   EQU   UCBMT+14                                                 01660000
UCBERG   EQU   UCBMT+12                                                 01661000
UCBMS    EQU   UCBMT+11                                                 01662000
UCBNB    EQU   UCBMT+10                                                 01663000
UCBPW    EQU   UCBMT+9                                                  01664000
UCBPR    EQU   UCBMT+8                                                  01665000
UCBSIO   EQU   UCBMT+6                                                  01666000
UCBTW    EQU   UCBMT+5                                                  01667000
UCBTR    EQU   UCBMT+4                                                  01668000
UCBTWT   EQU   UCBMT+3                                                  01669000
UCBTRT   EQU   UCBMT+2                                                  01670000
UCBCTD   EQU   UCBMT                                                    01671000
UCBWTOID EQU   UCBCMEXT+17                                              01672000
UCBRV043 EQU   UCBCMEXT+16                                              01673000
UCBASID  EQU   UCBCMEXT+14                                              01674000
UCBMFCNT EQU   UCBCMEXT+12                                              01675000
UCBPMSK  EQU   UCBCMEXT+10                                              01676000
UCBCCWOF EQU   UCBCMEXT+8                                               01677000
UCBRV041 EQU   UCBCMEXT+6                                               01678000
UCBRV036 EQU   UCBFLP1                                                  01679000
UCBRV035 EQU   UCBFLP1                                                  01680000
UCBRV034 EQU   UCBFLP1                                                  01681000
UCBRV033 EQU   UCBFLP1                                                  01682000
UCBRV032 EQU   UCBFLP1                                                  01683000
UCBRV031 EQU   UCBFLP1                                                  01684000
UCBSHRUP EQU   UCBFLP1                                                  01685000
UCBNSRCH EQU   UCBFLP1                                                  01686000
UCBSNSCT EQU   UCBCMEXT+4                                               01687000
UCBHPDV  EQU   @NM00026                                                 01688000
UCBHALI  EQU   @NM00026                                                 01689000
UCBRSV09 EQU   @NM00026                                                 01690000
UCBRSV08 EQU   @NM00026                                                 01691000
UCBRSV07 EQU   @NM00026                                                 01692000
UCBRSV06 EQU   @NM00026                                                 01693000
UCBRSV05 EQU   @NM00026                                                 01694000
UCBRSV04 EQU   @NM00026                                                 01695000
UCBDTI   EQU   UCBCMEXT+2                                               01696000
UCBSTI   EQU   UCBCMEXT+1                                               01697000
UCBETI   EQU   UCBCMEXT                                                 01698000
UCBEXTP  EQU   UCBEXTPT+1                                               01699000
UCBDDRSW EQU   UCBFLC                                                   01700000
UCBTICBT EQU   UCBFLC                                                   01701000
UCBIVRR  EQU   UCBFLC                                                   01702000
UCBIVRS  EQU   UCBFLC                                                   01703000
UCBITF   EQU   UCBFLC                                                   01704000
UCBUDE   EQU   UCBFLC                                                   01705000
UCBWAA   EQU   UCBFLC                                                   01706000
UCBATTP  EQU   UCBFLC                                                   01707000
UCBUNTYP EQU   UCBTBYT4                                                 01708000
UCBRSV11 EQU   UCBDVCLS                                                 01709000
UCBRSV10 EQU   UCBDVCLS                                                 01710000
UCB3CHAR EQU   UCBDVCLS                                                 01711000
UCB3COMM EQU   UCBDVCLS                                                 01712000
UCBDVPWR EQU   UCB2OPT7                                                 01713000
UCBVLPWR EQU   UCB2OPT6                                                 01714000
UCB2OPT5 EQU   UCBTBYT2                                                 01715000
UCBRVDEV EQU   UCBRWTAU                                                 01716000
UCBRPS   EQU   UCBDUDN2                                                 01717000
UCBRR    EQU   UCBDUDN1                                                 01718000
UCB2OPT1 EQU   UCBTBYT2                                                 01719000
UCB2OPT0 EQU   UCBTBYT2                                                 01720000
UCB1FEA7 EQU   UCBTBYT1                                                 01721000
UCBD6250 EQU   UCB1FEA6                                                 01722000
UCBD1600 EQU   UCB1FEA5                                                 01723000
UCB1FEA4 EQU   UCBTBYT1                                                 01724000
UCB1FEA3 EQU   UCBTBYT1                                                 01725000
UCB1FEA2 EQU   UCBTBYT1                                                 01726000
UCB1FEA1 EQU   UCBTBYT1                                                 01727000
UCB1FEA0 EQU   UCBTBYT1                                                 01728000
UCBNAME  EQU   UCBOB+13                                                 01729000
UCBRV029 EQU   UCBWGT                                                   01730000
UCBVHRSN EQU   UCBWGT                                                   01731000
UCBVORSN EQU   UCBWGT                                                   01732000
UCBMTPXP EQU   UCBWGT                                                   01733000
UCBREW   EQU   UCBWGT                                                   01734000
UCBPUB   EQU   UCBWGT                                                   01735000
UCBOUT   EQU   UCBWGT                                                   01736000
UCBIN    EQU   UCBWGT                                                   01737000
UCBCPU   EQU   UCBOB+11                                                 01738000
UCBLCI   EQU   UCBOB+10                                                 01739000
UCBCNT   EQU   UCBOB+9                                                  01740000
UCBRV017 EQU   UCBCHM1                                                  01741000
UCBRV016 EQU   UCBCHM1                                                  01742000
UCBRV015 EQU   UCBCHM1                                                  01743000
UCBRV014 EQU   UCBCHM1                                                  01744000
UCBSPB   EQU   UCBPTH1                                                  01745000
UCBPPB   EQU   UCBPTH1                                                  01746000
UCBSPA   EQU   UCBPTH0                                                  01747000
UCBPPA   EQU   UCBPTH0                                                  01748000
UCBFLB7  EQU   UCBFLB                                                   01749000
UCBVALPH EQU   UCBFLB                                                   01750000
UCBCRHSN EQU   UCBFLB                                                   01751000
UCBCRHRV EQU   UCBFLB                                                   01752000
UCBRESVH EQU   UCBFLB                                                   01753000
UCBSPST  EQU   UCBFLB                                                   01754000
UCBASNS  EQU   UCBFLB                                                   01755000
UCBIORST EQU   UCBFLB                                                   01756000
UCBQISCE EQU   UCBFL1                                                   01757000
UCBACTV  EQU   UCBFL1                                                   01758000
UCBSAP   EQU   UCBFL1                                                   01759000
UCBNOTRC EQU   UCBCUB                                                   01760000
UCBPSNS  EQU   UCBFL1                                                   01761000
UCBUSING EQU   UCBPST                                                   01762000
UCBNOTRD EQU   UCBNRY                                                   01763000
UCBBUSYD EQU   UCBBSY                                                   01764000
UCBUA    EQU   UCBCHAN+1                                                01765000
UCBCHA   EQU   UCBCHAN                                                  01766000
UCBDADI  EQU   UCBSTAT                                                  01767000
UCBSYSR  EQU   UCBSTAT                                                  01768000
UCBALOC  EQU   UCBSTAT                                                  01769000
UCBUNLD  EQU   UCBSTAT                                                  01770000
UCBCHGS  EQU   UCBSTAT                                                  01771000
UCBONLI  EQU   UCBSTAT                                                  01772000
UCBID    EQU   UCBOB+2                                                  01773000
UCBALTPH EQU   UCBFL5                                                   01774000
UCBALTCU EQU   UCBFL5                                                   01775000
UCBNALOC EQU   UCBFL5                                                   01776000
UCBENVRD EQU   UCBFL5                                                   01777000
UCBVSDR  EQU   UCBFL5                                                   01778000
UCBSASK  EQU   UCBFL5                                                   01779000
UCBAMV   EQU   UCBAF                                                    01780000
UCBDCC   EQU   UCBFL5                                                   01781000
UCBMONT  EQU   UCBJBNR                                                  01782000
UCBRV011 EQU   UCBJBNR                                                  01783000
UCBRSV02 EQU   UCBJBNR                                                  01784000
UCBOLDSM EQU   UCBJBNR                                                  01785000
UCBRV003 EQU   UCBJBNR                                                  01786000
UCBRV002 EQU   UCBJBNR                                                  01787000
UCBJES3  EQU   UCBJBNR                                                  01788000
UCBVRDEV EQU   UCBJBNR                                                  01789000
UCBCMSEG EQU   UCBOB                                                    01790000
UCBPFXND EQU   UCB+512                                                  01791000
UCBIOQ   EQU   UCB+508                                                  01792000
UCBLOCK  EQU   UCB+504                                                  01793000
UCBPXST  EQU   UCB+504                                                  01794000
@NM00023 EQU   UCB                                                      01795000
SIODDSNL EQU   INDMSIOT+173                                             01796000
SIOVDSNL EQU   INDMSIOT+172                                             01797000
SIOVDSNT EQU   INDMSIOT+170                                             01798000
SIOTVMVP EQU   INDMSIOT+164                                             01799000
SIOTJFX  EQU   INDMSIOT+160                                             01800000
SJFCBPTR EQU   INDMSIOT+156                                             01801000
SIOTNPTR EQU   INDMSIOT+152                                             01802000
SIOTATE  EQU   INDMSIOT+144                                             01803000
SIOTEDLS EQU   INDMSIOT+132                                             01804000
SCTANAME EQU   INDMSIOT+122                                             01805000
@NM00022 EQU   INDMSIOT+108                                             01806000
SIOTSSNM EQU   INDMSIOT+104                                             01807000
SIODDQCR EQU   SIOTBYT2                                                 01808000
SIOVDQCR EQU   SIOTBYT2                                                 01809000
SIOTCVOL EQU   SIOTBYT2                                                 01810000
SIOTCNEW EQU   SIOTBYT2                                                 01811000
SIOTCALC EQU   SIOTBYT2                                                 01812000
SIOTGALL EQU   SIOTBYT2                                                 01813000
SIOTDSPD EQU   SIOTBYT2                                                 01814000
SIOTDMND EQU   SIOTBYT2                                                 01815000
SIOTOPUC EQU   INDMSIOT+99                                              01816000
SIOTOUTR EQU   INDMSIOT+97                                              01817000
SIOTOUTC EQU   INDMSIOT+96                                              01818000
@NM00021 EQU   INDMSIOT+93                                              01819000
SIOTAUNC EQU   SIOTALTD                                                 01820000
SIOTACAT EQU   SIOTALTD                                                 01821000
SIOTADEL EQU   SIOTALTD                                                 01822000
SIOTAKEP EQU   SIOTALTD                                                 01823000
SIOTNPRV EQU   SIOTALTD                                                 01824000
SIOJCATS EQU   SIOTALTD                                                 01825000
@NM00020 EQU   SIOTALTD                                                 01826000
@NM00019 EQU   SIOTALTD                                                 01827000
@NM00018 EQU   INDMSIOT+91                                              01828000
SIOTNDSB EQU   INDMSIOT+88                                              01829000
@NM00017 EQU   INDMSIOT+84                                              01830000
SIOTDPCD EQU   INDMSIOT+82                                              01831000
@NM00016 EQU   INDMSIOT+81                                              01832000
SCTOUTPN EQU   INDMSIOT+80                                              01833000
SCTOUTNO EQU   INDMSIOT+76                                              01834000
SCTOUTNM EQU   INDMSIOT+68                                              01835000
SIOUCBAD EQU   SCTUTYPE+5                                               01836000
SIOUCNVT EQU   SCTUTYPE+4                                               01837000
SIOUBYT4 EQU   SIOTDEVT+3                                               01838000
@NM00015 EQU   SIOUBYT3                                                 01839000
SIO3UREC EQU   SIOUBYT3                                                 01840000
SIO3DISP EQU   SIOUBYT3                                                 01841000
SIO3DACC EQU   SIOUBYT3                                                 01842000
SIO3COMM EQU   SIOUBYT3                                                 01843000
SIO3TAPE EQU   SIOUBYT3                                                 01844000
SIOUBYT2 EQU   SIOTDEVT+1                                               01845000
SIOUBYT1 EQU   SIOTDEVT                                                 01846000
SIOTOMN  EQU   SCTSBYT4                                                 01847000
SIOTIPDI EQU   SCTSBYT4                                                 01848000
SIOTVAFF EQU   SCTSBYT4                                                 01849000
SIOTSTEP EQU   SCTSBYT4                                                 01850000
SIOTASCI EQU   SCTSBYT4                                                 01851000
@NM00014 EQU   SCTSBYT4                                                 01852000
SIOTGDGA EQU   SCTSBYT4                                                 01853000
SCTSGDGS EQU   SCTSBYT4                                                 01854000
SCTSOLD  EQU   SCTSBYT3                                                 01855000
SCTSMOD  EQU   SCTSBYT3                                                 01856000
SCTSYSOU EQU   SCTSBYT3                                                 01857000
SCTVREF  EQU   SCTSBYT3                                                 01858000
@NM00013 EQU   SCTSBYT3                                                 01859000
SCTSYSNE EQU   SCTSBYT3                                                 01860000
SCTDSNRF EQU   SCTSBYT3                                                 01861000
SCTRECVD EQU   SCTSBYT2                                                 01862000
SCTDEFER EQU   SCTSBYT2                                                 01863000
SCTLABEL EQU   SCTSBYT2                                                 01864000
SCTUNLBD EQU   SCTSBYT2                                                 01865000
SCTJOBLB EQU   SCTSBYT2                                                 01866000
SCTVOLAF EQU   SCTSBYT2                                                 01867000
SIOTCATL EQU   SCTSBYT2                                                 01868000
SIOCLUNL EQU   SCTSBYT2                                                 01869000
SIOTJSCT EQU   SCTSBYT1                                                 01870000
SCTUNAFF EQU   SCTSBYT1                                                 01871000
SCTPARLM EQU   SCTSBYT1                                                 01872000
SIOTQDSN EQU   SCTSBYT1                                                 01873000
SIOTGDSN EQU   SCTSBYT1                                                 01874000
SIOTCCAT EQU   SCTSBYT1                                                 01875000
SCTSYSIN EQU   SCTSBYT1                                                 01876000
SCTDUMMY EQU   SCTSBYT1                                                 01877000
SIOTUNCT EQU   SCTSDISP                                                 01878000
SIOTCTLG EQU   SCTSDISP                                                 01879000
SIOTDLET EQU   SCTSDISP                                                 01880000
SIOTKEEP EQU   SCTSDISP                                                 01881000
SIOTPASS EQU   SCTSDISP                                                 01882000
SIOTPRIV EQU   SCTSDISP                                                 01883000
S3400DSP EQU   SCTSDISP                                                 01884000
SIOTRETN EQU   SCTSDISP                                                 01885000
SIOTVLCT EQU   INDMSIOT+54                                              01886000
SCTNMBUT EQU   INDMSIOT+53                                              01887000
SIOTRTRY EQU   SIOTBYT0                                                 01888000
SIOTPUPV EQU   SIOTBYT0                                                 01889000
SIOTNOPV EQU   SIOTBYT0                                                 01890000
SIOTGIGN EQU   SIOTBYT0                                                 01891000
SPVTAMSG EQU   SIOTBYT0                                                 01892000
SIOTFUDA EQU   SIOTBYT0                                                 01893000
SIOTDYAL EQU   SIOTBYT0                                                 01894000
SIOTSSDS EQU   SIOTBYT0                                                 01895000
SIOTGIID EQU   INDMSIOT+50                                              01896000
SCTVOLCT EQU   INDMSIOT+49                                              01897000
SCTSPOOL EQU   INDMSIOT+48                                              01898000
SIOTQNAM EQU   SIOTTSTC                                                 01899000
SIOTDSNM EQU   SIOTTSTC                                                 01900000
SIOTTRKM EQU   SIOTTSTC                                                 01901000
@NM00012 EQU   SIOTTSTC                                                 01902000
SIOTTERM EQU   SIOTTSTC                                                 01903000
@NM00011 EQU   SIOTTSTC                                                 01904000
@NM00010 EQU   SIOTBYT3                                                 01905000
SIOTJES3 EQU   SIOTBYT3                                                 01906000
SIOCDEVT EQU   SIOTBYT3                                                 01907000
SIOALIAS EQU   SIOTBYT3                                                 01908000
SCTDDINO EQU   INDMSIOT+44                                              01909000
SIOTDDNT EQU   SIOTBYT1                                                 01910000
SIODADSM EQU   SIOTBYT1                                                 01911000
SIOTDADR EQU   SIOTBYT1                                                 01912000
SIODUNAL EQU   SIOTBYT1                                                 01913000
SIOVAMDS EQU   SIOTBYT1                                                 01914000
SIOTHOLD EQU   SIOTBYT1                                                 01915000
SIOTOCKP EQU   SIOTBYT1                                                 01916000
SIOPSCNT EQU   INDMSIOT+42                                              01917000
SIOTREFN EQU   INDMSIOT+40                                              01918000
SIOTVRSB EQU   INDMSIOT+36                                              01919000
@NM00009 EQU   INDMSIOT+35                                              01920000
SCTPJFCB EQU   INDMSIOT+32                                              01921000
@NM00008 EQU   INDMSIOT+31                                              01922000
SCTPSIOT EQU   INDMSIOT+28                                              01923000
SIOTAFID EQU   INDMSIOT+26                                              01924000
@NM00007 EQU   INDMSIOT+24                                              01925000
SIODSNTE EQU   INDMSIOT+22                                              01926000
SIOTUNAF EQU   SCTUSADD                                                 01927000
SIOTDEST EQU   INDMSIOT+12                                              01928000
SCTDDNAM EQU   INDMSIOT+4                                               01929000
SIOTTYPE EQU   INDMSIOT+3                                               01930000
SIOTDSKA EQU   INDMSIOT                                                 01931000
VUGRID   EQU   VOLUNTAB+24                                              01932000
VUUCBP   EQU   VOLUNTAB+20                                              01933000
VOLALGTP EQU   VOLUNTAB+12                                              01934000
VURCVYPR EQU   VOLSTATD                                                 01935000
VUVLUNIQ EQU   VOLSTATD                                                 01936000
VUDMUNIQ EQU   VOLSTATD                                                 01937000
VUUNALSW EQU   VOLSTATD                                                 01938000
VUDMNDAL EQU   VOLSTATD                                                 01939000
VUDMNDOF EQU   VOLSTATD                                                 01940000
VUREALOC EQU   VOLSTATD                                                 01941000
VUMUGDON EQU   VOLSTATD                                                 01942000
@NM00033 EQU   VOLSTATC                                                 01943000
@NM00032 EQU   VOLSTATC                                                 01944000
@NM00031 EQU   VOLSTATC                                                 01945000
VOLURREQ EQU   VOLSTATC                                                 01946000
VOLGRREQ EQU   VOLSTATC                                                 01947000
VOLDAREQ EQU   VOLSTATC                                                 01948000
VOLCOREQ EQU   VOLSTATC                                                 01949000
VOLTAREQ EQU   VOLSTATC                                                 01950000
VUAFFWRK EQU   VOLSTATB                                                 01951000
VUPROCED EQU   VOLSTATB                                                 01952000
VOLMNTD  EQU   VOLSTATB                                                 01953000
VOLDEFER EQU   VOLSTATA                                                 01954000
VUDADSM  EQU   VOLSTATA                                                 01955000
VOLRESVE EQU   VOLSTATA                                                 01956000
VOLNSHR  EQU   VOLSTATA                                                 01957000
VOLSTG   EQU   VOLSTATA                                                 01958000
VOLPRV   EQU   VOLSTATA                                                 01959000
VOLPUB   EQU   VOLSTATA                                                 01960000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      01961000
@RC00053 EQU   @RC00050                                                 01962000
@RF00069 EQU   @RC00050                                                 01963000
@RF00072 EQU   @RC00050                                                 01964000
@RC00086 EQU   @EL00002                                                 01965000
@RF00189 EQU   @RC00174                                                 01966000
@RF00195 EQU   @EL00004                                                 01967000
@RF00222 EQU   @RC00220                                                 01968000
@RF00229 EQU   @EL00006                                                 01969000
@RC00233 EQU   @EL00007                                                 01970000
@RF00056 EQU   @RC00053                                                 01971000
@RF00111 EQU   @RC00086                                                 01972000
@RF00115 EQU   @RC00086                                                 01973000
@ENDDATA EQU   *                                                        01974000
         END   IEFAB432,(C'PLS1210',0701,75329)                         01975000
