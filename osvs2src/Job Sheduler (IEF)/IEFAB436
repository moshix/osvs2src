         TITLE 'IEFAB436 - NON-SPECIFIC VOLUME ALLOCATION CONTROL      *00001000
                        '                                               00002000
IEFAB436 CSECT ,                                                01S0001 00003000
@MAINENT DS    0H                                               01S0001 00004000
         USING *,@15                                            01S0001 00005000
         B     @PROLOG                                          01S0001 00006000
         DC    AL1(24)                                          01S0001 00007000
         DC    C'IEFAB436 76265  UZ05402 '                      01S0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                  01S0001 00010000
         BALR  @12,0                                            01S0001 00011000
@PSTART  DS    0H                                               01S0001 00012000
         USING @PSTART,@12                                      01S0001 00013000
         L     @00,@SIZDATD                                     01S0001 00014000
         GSPACE   R,LV=(0)                                              00015000
         LR    @11,@01                                          01S0001 00016000
         USING @DATD,@11                                        01S0001 00017000
         ST    @13,@SA00001+4                                   01S0001 00018000
         LM    @00,@01,20(@13)                                  01S0001 00019000
         ST    @11,8(,@13)                                      01S0001 00020000
         LR    @13,@11                                          01S0001 00021000
         MVC   @PC00001(12),0(@01)                              01S0001 00022000
JSCBDISP EQU 188                                                        00023000
JSCBAOS1 EQU  72                                                        00024000
JSCBAOS2 EQU 192                                                        00025000
*SIOTPTR=SIOT1P;                      /*INITIALIZE SIOT PTR          */ 00026000
         L     @08,@PC00001                                     01S0064 00027000
         L     @08,ALCWAPTR(,@08)                               01S0064 00028000
         MVC   SIOTPTR(4),SIOT1P(@08)                           01S0064 00029000
*DOINGDA = NO;                        /*INITIALIZE DA SWITCHES       */ 00030000
         NI    DOINGDA,B'01111111'                              01S0065 00031000
*F0MAP = F0MAP && F0MAP;               /*CLEAR MAP FOR F0            */ 00032000
         XC    F0MAP(1),F0MAP                                   01S0066 00033000
*/********************************************************************/ 00034000
*/*                                                                  */ 00035000
*/* SEGMENT NAME - PSCTLINT                                          */ 00036000
*/*                                                                  */ 00037000
*/* DESCRIPTIVE NAME - PUBLIC/STORAGE ALLOCATION INITIALIZATION      */ 00038000
*/*                                                                  */ 00039000
*/* FUNCTION -                                                       */ 00040000
*/*   THIS ROUTINE PERFORMS THE FOLLOWING FUNCTIONS:                 */ 00041000
*/*     .GETS CORE FOR THE PUBLIC/STORAGE UCB LIST AND THE           */ 00042000
*/*      OPTIMIZER LIST. THE AMOUNT OF CORE GOTTEN FOR THE UCB LIST  */ 00043000
*/*      IS EQUAL TO TWO TIMES THE SIZE OF THE UCB LIST              */ 00044000
*/*      PASSED BY THE CALLER PLUS THE LENGTH OF THE PSLIST HEADER,  */ 00045000
*/*      SINCE THIS WOULD BE THE MAXIMUM TABLE SIZE AND              */ 00046000
*/*      SO THAT THE CORE CAN BE REUSED FOR EACH REQUEST. IF THE     */ 00047000
*/*      CORE IS NOT AVAILABLE,RETURN CODE WILL BE 4 AND ERROR       */ 00048000
*/*      REASON CODE 2 IS SET.                                       */ 00049000
*/*     .DETERMINES TYPE OF PROCESSING,PUBLIC OR STORAGE, TO BE DONE.*/ 00050000
*/*      A THIRD TYPE OF PROCESSING WHEREBY A PUBLIC REQUEST IS      */ 00051000
*/*      ASSIGNED TO A STORAGE VOLUME MAY ALSO BE INDICATED. BASED ON*/ 00052000
*/*      THIS INFORMATION,UCB AND VOLUNIT MASKS ARE INITIALIZED.     */ 00053000
*/*      MASKS WILL BE USED TO DETERMINE IF A UCB IS ELIGIBLE FOR    */ 00054000
*/*      ALLOCATION AND IF A VOLUNIT ENTRY SHOULD BE PROCESSED.      */ 00055000
*/*      ALSO A POINTER TO THE PUBLIC OR STORAGE ENTRY               */ 00056000
*/*      IN THE COUNT TABLE IS SET. THE FIELD LOCATED BY THIS        */ 00057000
*/*      POINTER WILL BE DECREMENTED AS UNITS ARE ALLOCATED.         */ 00058000
*/*     .INITIALIZE THE FOLLOWING VARIABLES.                         */ 00059000
*/*        RETURN CODE FIELD                                         */ 00060000
*/*        FLAGS FOR THE ALLOCATE REQUEST TO UNIT ROUTINE ZEROED     */ 00061000
*/*        PTR TO THE PUBLIC/STORAGE UCB LIST                        */ 00062000
*/*                                                                  */ 00063000
*/* ENTRY -                                                          */ 00064000
*/*   PSCTLINT - INCLUDED IN MODULE IEFAB436                         */ 00065000
*/*                                                                  */ 00066000
*/*   PURPOSE - INITIALIZATION                                       */ 00067000
*/*                                                                  */ 00068000
*/*   INPUT -                                                        */ 00069000
*/*     POINTER TO FUNCTION MAP                                      */ 00070000
*/*     LENGTH OF INPUT UCB LIST (PSUCBLST)                          */ 00071000
*/*                                                                  */ 00072000
*/* EXITS -                                                          */ 00073000
*/*                                                                  */ 00074000
*/*   CONDITION - NORMAL COMPLETION                                  */ 00075000
*/*                                                                  */ 00076000
*/*   OUTPUT -                                                       */ 00077000
*/*     CORE FOR THE PUBLIC/STORAGE LIST AND THE OPTIMIZER PARM LIST */ 00078000
*/*     AND INITIALIZED VARIABLES                                    */ 00079000
*/*                                                                  */ 00080000
*/*   RETURN CODE - 0                                                */ 00081000
*/*                                                                  */ 00082000
*/*   CONDITION - GETMAIN ERROR                                      */ 00083000
*/*                                                                  */ 00084000
*/*   OUTPUT -                                                       */ 00085000
*/*     REASON CODE 2                                                */ 00086000
*/*                                                                  */ 00087000
*/*   RETURN CODE - 4                                                */ 00088000
*/*                                                                  */ 00089000
*/********************************************************************/ 00090000
*RETCODE=NOERROR;                      /*INIT RETURN CODE            */ 00091000
         SLR   @08,@08                                          02S0067 00092000
         ST    @08,RETCODE                                      02S0067 00093000
*ERETCODE = NOERROR;                                            02S0068 00094000
         SLR   ERETCODE,ERETCODE                                02S0068 00095000
*PSOPTCOR=OFF;                         /*INITIALIZE CORE GOTTEN SW      00096000
*                                                            @YM08667*/ 00097000
         NI    PSOPTCOR,B'01111111'                             02S0069 00098000
*SUBPL=TWO53;                          /*SUBPOOL NO. FOR PARM LIST   */ 00099000
         LA    @08,253                                          02S0070 00100000
         ST    @08,SUBPL                                        02S0070 00101000
*PSOPTLEN=LENGTH(OPTPARMS)+(TWO*PSUCBLEN+PSHDRLEN);  /*CORE FOR OPT     00102000
*                                        PARMS+MAXSIZE PSLIST@YM08667*/ 00103000
         L     @15,@PC00001+8                                   02S0071 00104000
         L     @01,PSPARMP(,@15)                                02S0071 00105000
         L     @15,PSUCBLEN(,@01)                               02S0071 00106000
         ALR   @15,@15                                          02S0071 00107000
         AL    @15,PSHDRLEN                                     02S0071 00108000
         AH    @15,@CH01088                                     02S0071 00109000
         ST    @15,PSOPTLEN                                     02S0071 00110000
* /* ?GETSTORG (SUBPL,PSOPTLEN,LISTP);*/                        02S0072 00111000
*   /* DEFINITIONS OF GETMAIN PARMS */                          02S0072 00112000
*   DCL                                                         02S0072 00113000
*     GTSTR0   FIXED(31) REG(0),/*GTMN PARM REG*/               02S0072 00114000
*     GTSTR1   FIXED(31) REG(1),/*GTMN PARM REG*/               02S0072 00115000
*     GTSTR2   PTR(31)   REG(2),/*GTMN PARM REG*/               02S0072 00116000
*     GTSTR15  FIXED(31) REG(15),/*GTMN RET COD*/               02S0072 00117000
*     GTSTRTCD FIXED(31); /* GETMAIN RTN CODE  */               02S0072 00118000
*   DCL                                                         02S0073 00119000
*     GTSTR3   FIXED(31) REG(3),/* CLEARING REG*/               02S0073 00120000
*     GTSTR4   FIXED(31) REG(4),/* CLEARING REG*/               02S0073 00121000
*     GTSTR5   FIXED(31) REG(5),/* CLEARING REG*/               02S0073 00122000
*     GTSTR6   FIXED(31) REG(6),/* CLEARING REG*/               02S0073 00123000
*     GTSTR7   FIXED(31) REG(7),/* CLEARING REG*/               02S0073 00124000
*     GTSTR8   FIXED(31) REG(8),/* CLEARING REG*/               02S0073 00125000
*     GTSTZERO FIXED(31) INIT(0),                               02S0073 00126000
*     GTST253  FIXED(31) CONSTANT(253);                         02S0073 00127000
*   RFY (GTSTR0,GTSTR1,GTSTR2) RSTD; /*SAVE RGS*/               02S0074 00128000
*   GTSTR0 = PSOPTLEN; /* SET AMOUNT*/                          02S0075 00129000
         LR    GTSTR0,@15                                       02S0075 00130000
*   GTSTR2 = SUBPL; /* SET SUBPOOL*/                            02S0076 00131000
         LR    GTSTR2,@08                                       02S0076 00132000
*   GENERATE CODE;                                              02S0077 00133000
     GETMAIN RC,LV=(0),SP=(2)  DO GETMAIN                               00134000
*   GTSTRTCD = GTSTR15; /* SAVE GETMAIN RET COD*/               02S0078 00135000
         ST    GTSTR15,GTSTRTCD                                 02S0078 00136000
*   LISTP = GTSTR1; /* ADDR OF GOTN STORG*/                     02S0079 00137000
         ST    GTSTR1,LISTP                                     02S0079 00138000
*   RFY (GTSTR0,GTSTR1,GTSTR2) UNRSTD; /*RLSE */                02S0080 00139000
*   IF GTSTRTCD = 0 THEN /*GETMAIN SUCCESSFUL? */               02S0081 00140000
         L     @08,GTSTRTCD                                     02S0081 00141000
         LTR   @08,@08                                          02S0081 00142000
         BNZ   @RF00081                                         02S0081 00143000
*     DO;               /* YES, CLEAR STORAGE.*/                02S0082 00144000
*       RFY (GTSTR2,GTSTR4,GTSTR5,GTSTR6,                       02S0083 00145000
*                          GTSTR7,GTSTR8) RSTD;                 02S0083 00146000
*       GTSTR4 = LISTP; /*STORG PTR*/                           02S0084 00147000
         L     @03,LISTP                                        02S0084 00148000
         LR    GTSTR4,@03                                       02S0084 00149000
*       GTSTR5 = PSOPTLEN; /*STORG AMNT*/                       02S0085 00150000
         L     GTSTR5,PSOPTLEN                                  02S0085 00151000
*       GTSTR7 = '00000000'X; /*PAD CHAR & LNTH*/               02S0086 00152000
         SLR   GTSTR7,GTSTR7                                    02S0086 00153000
*       IF SUBPL = GTST253 THEN                                 02S0087 00154000
         CLC   SUBPL(4),@CF00958                                02S0087 00155000
         BNE   @RF00087                                         02S0087 00156000
*      GEN                                                      02S0088 00157000
*   (MODESET KEYADDR=GTSTZERO,SAVEKEY=(2),WORKREG=8);           02S0088 00158000
         MODESET KEYADDR=GTSTZERO,SAVEKEY=(2),WORKREG=8                 00159000
*       GEN REFS(GTSTR4,GTSTR6);                                02S0089 00160000
@RF00087 DS    0H                                               02S0089 00161000
          MVCL  GTSTR4,GTSTR6 CLEAR GOTTEN STORG                        00162000
*       IF SUBPL = GTST253 THEN                                 02S0090 00163000
         CLC   SUBPL(4),@CF00958                                02S0090 00164000
         BNE   @RF00090                                         02S0090 00165000
*         GEN (MODESET KEYADDR=(2));                            02S0091 00166000
         MODESET KEYADDR=(2)                                            00167000
*       RFY (GTSTR2,GTSTR4,GTSTR5,GTSTR6,                       02S0092 00168000
*                          GTSTR7,GTSTR8) UNRSTD;               02S0092 00169000
@RF00090 DS    0H                                               02S0093 00170000
*     END;       /* STORAGE CLEARING COMPLETED */               02S0093 00171000
*   ELSE                                                        02S0094 00172000
*   LISTP= 0;   /* CLEAR RETURN ADDR. */                        02S0094 00173000
         B     @RC00081                                         02S0094 00174000
@RF00081 SLR   @08,@08                                          02S0094 00175000
         ST    @08,LISTP                                        02S0094 00176000
*   GTSTR15 = GTSTRTCD;    /* GTMN RETURN CODE */               02S0095 00177000
@RC00081 L     GTSTR15,GTSTRTCD                                 02S0095 00178000
*                                      /* RESTORE LIST PRINT STATUS  */ 00179000
*     /*GET CORE IN SP253   @YM08667*/                          02S0096 00180000
*IF REG15 ^= NOERROR THEN              /*GETMAIN ERROR               */ 00181000
         LTR   REG15,REG15                                      02S0096 00182000
         BZ    @RF00096                                         02S0096 00183000
*  DO;                                                          02S0097 00184000
*    RETCODE = GETMERR;                                         02S0098 00185000
         MVC   RETCODE(4),@CF00160                              02S0098 00186000
*    FAILRSC = RSNGET;                                          02S0099 00187000
         L     @08,@PC00001                                     02S0099 00188000
         L     @08,ALCWAPTR(,@08)                               02S0099 00189000
         L     @08,FAILRSCP(,@08)                               02S0099 00190000
         MVC   FAILRSC(2,@08),@CH00065                          02S0099 00191000
*  END;                                                         02S0100 00192000
*ELSE                                                           02S0101 00193000
*  DO;                                                          02S0101 00194000
         B     @RC00096                                         02S0101 00195000
@RF00096 DS    0H                                               02S0102 00196000
*    PSOPTCOR = ON;                    /*CORE GOTTEN         @YM08667*/ 00197000
         OI    PSOPTCOR,B'10000000'                             02S0102 00198000
*    OPTPARMP=LISTP+(TWO*PSUCBLEN+PSHDRLEN); /*POINT TO OPTPARMS CORE   00199000
*                                                            @YM08667*/ 00200000
         L     @15,@PC00001+8                                   02S0103 00201000
         L     @01,PSPARMP(,@15)                                02S0103 00202000
         L     OPTPARMP,PSUCBLEN(,@01)                          02S0103 00203000
         ALR   OPTPARMP,OPTPARMP                                02S0103 00204000
         AL    OPTPARMP,PSHDRLEN                                02S0103 00205000
         AL    OPTPARMP,LISTP                                   02S0103 00206000
*    MASKS=CLRMASK;                    /*ZERO MASKS                  */ 00207000
         MVC   MASKS(2),CLRMASK                                 02S0104 00208000
*    UCBPTR = PSUCBLST(1);             /*FIRST UCB IN LIST           */ 00209000
         L     @08,@PC00001+4                                   02S0105 00210000
         L     @08,PSUCBPTR(,@08)                               02S0105 00211000
         SLR   @15,@15                                          02S0105 00212000
         ICM   @15,3,PSUCBLST(@08)                              02S0105 00213000
         ST    @15,UCBPTR                                       02S0105 00214000
*    IF UCB3DACC = ON THEN             /*SET DA GENERIC              */ 00215000
         TM    UCB3DACC(@15),B'00100000'                        02S0106 00216000
         BNO   @RF00106                                         02S0106 00217000
*      DOINGDA = YES;                                           02S0107 00218000
         OI    DOINGDA,B'10000000'                              02S0107 00219000
*    IF PSPUB=ON THEN                  /*PUBLIC PROCESSING REQUESTED?*/ 00220000
@RF00106 L     @08,@PC00001+8                                   02S0108 00221000
         L     @08,PSPARMP(,@08)                                02S0108 00222000
         TM    PSPUB(@08),B'10000000'                           02S0108 00223000
         BNO   @RF00108                                         02S0108 00224000
*      DO;                             /*YES,INIT FOR PUBLIC PROCESS */ 00225000
*        PUBUCB=ON;                    /*INDICATE PUBLIC UCB         */ 00226000
         OI    PUBUCB,B'00001000'                               02S0110 00227000
*        PUBVOL=ON;                    /*INDICATE PUBLIC VOLUME      */ 00228000
         OI    PUBVOL,B'10000000'                               02S0111 00229000
*        COUNTABP=ADDR(PUBLREQS);      /*SET POINTER INTO COUNT TABLE*/ 00230000
         L     @08,@PC00001                                     02S0112 00231000
         L     @08,ALCWAPTR(,@08)                               02S0112 00232000
         LA    @08,PUBLREQS(,@08)                               02S0112 00233000
         ST    @08,COUNTABP                                     02S0112 00234000
*      END;                                                     02S0113 00235000
*    ELSE                                                       02S0114 00236000
*      IF PSSTRG=ON THEN               /*NO, CHECK FOR STORAGE       */ 00237000
         B     @RC00108                                         02S0114 00238000
@RF00108 L     @08,@PC00001+8                                   02S0114 00239000
         L     @08,PSPARMP(,@08)                                02S0114 00240000
         TM    PSSTRG(@08),B'01000000'                          02S0114 00241000
         BNO   @RF00114                                         02S0114 00242000
*        DO;                                                    02S0115 00243000
*          STGUCB=ON;                  /*INDICATE STORAGE UCB        */ 00244000
         OI    STGUCB,B'00000100'                               02S0116 00245000
*          STGVOL=ON;                  /*INDICATE STORAGE VOLUME     */ 00246000
         OI    STGVOL,B'00010000'                               02S0117 00247000
*          COUNTABP=ADDR(STRGREQS);    /*SET POINTER INTO COUNT TABLE*/ 00248000
         L     @08,@PC00001                                     02S0118 00249000
         L     @08,ALCWAPTR(,@08)                               02S0118 00250000
         LA    @08,STRGREQS(,@08)                               02S0118 00251000
         ST    @08,COUNTABP                                     02S0118 00252000
*        END;                                                   02S0119 00253000
*      ELSE                            /*NOT PUBLIC OR STORAGE       */ 00254000
*        IF PUBSTOR=ON THEN            /*ASSIGN PUB REQS TO PUB &       00255000
*                                        STORAGE VOLUMES ?           */ 00256000
         B     @RC00114                                         02S0120 00257000
@RF00114 L     @08,@PC00001+8                                   02S0120 00258000
         L     @08,PSPARMP(,@08)                                02S0120 00259000
         TM    PUBSTOR(@08),B'00100000'                         02S0120 00260000
         BNO   @RF00120                                         02S0120 00261000
*          DO;                         /*YES:                        */ 00262000
*            STGUCB=ON;                /*INDICATE STORAGE UCB        */ 00263000
*            PUBUCB = ON;              /*INDICATE PUBLIC UCB,TOO     */ 00264000
         OI    STGUCB,B'00001100'                               02S0123 00265000
*            PUBVOL=ON;                /*INDICATE PUBLIC VOLUME      */ 00266000
         OI    PUBVOL,B'10000000'                               02S0124 00267000
*            COUNTABP=ADDR(PUBLREQS);  /*SET POINTER INTO COUNT TABLE*/ 00268000
         L     @08,@PC00001                                     02S0125 00269000
         L     @08,ALCWAPTR(,@08)                               02S0125 00270000
         LA    @08,PUBLREQS(,@08)                               02S0125 00271000
         ST    @08,COUNTABP                                     02S0125 00272000
*          END;                                                 02S0126 00273000
*        ELSE;                                                  02S0127 00274000
@RF00120 DS    0H                                               02S0128 00275000
*    ARUINDIC=ZERO;                    /*CLEAR FLAGS IN ARU PARMLIST */ 00276000
@RC00114 DS    0H                                               02S0128 00277000
@RC00108 SLR   @08,@08                                          02S0128 00278000
         ST    @08,ARUINDIC                                     02S0128 00279000
*  END;                                                         02S0129 00280000
*SWITCHES = CLEAR;                    /* INITIALIZE SWITCHES         */ 00281000
@RC00096 MVI   SWITCHES+1,X'00'                                 01S0130 00282000
         MVI   SWITCHES,X'00'                                   01S0130 00283000
*DO NUMSIOTS=NUMREQS TO 1 BY -1       /*PROCESS ALL SIOTS(REQUESTS)  */ 00284000
*  WHILE(RETCODE=NOERROR & PSCNTENT>ZERO); /*STOP ON ERROR OR WHEN NO   00285000
*                                       MORE REQUESTS IN COUNT TABLE */ 00286000
         L     @08,@PC00001                                     01S0131 00287000
         L     @08,ALCWAPTR(,@08)                               01S0131 00288000
         L     @08,NUMREQS(,@08)                                01S0131 00289000
         ST    @08,NUMSIOTS                                     01S0131 00290000
         B     @DE00131                                         01S0131 00291000
@DL00131 SLR   @08,@08                                          01S0131 00292000
         C     @08,RETCODE                                      01S0131 00293000
         BNE   @DC00131                                         01S0131 00294000
         L     @01,COUNTABP                                     01S0131 00295000
         C     @08,PSCNTENT(,@01)                               01S0131 00296000
         BNL   @DC00131                                         01S0131 00297000
*  IF SIOTALCD=OFF &                  /*THIS SIOT ALREADY PROCESSED? */ 00298000
*    SIOTGIGN=OFF THEN                                          01S0132 00299000
         L     @08,SIOTPTR                                      01S0132 00300000
         TM    SIOTALCD(@08),B'00000010'                        01S0132 00301000
         BNZ   @RF00132                                         01S0132 00302000
         TM    SIOTGIGN(@08),B'00001000'                        01S0132 00303000
         BNZ   @RF00132                                         01S0132 00304000
*    DO;                              /*NO,PROCESS VOLUNIT ENTRIES   */ 00305000
*      VUPTR=SVOLUNAD;                /*POINT TO FIRST VOLUNIT ENTRY */ 00306000
         MVC   VUPTR(4),SVOLUNAD(@08)                           01S0134 00307000
*      SWITCHES=CLEAR;                /*INITIALIZE SWITCHES          */ 00308000
         MVI   SWITCHES+1,X'00'                                 01S0135 00309000
         MVI   SWITCHES,X'00'                                   01S0135 00310000
*      FIRSTALC=OFF;                                            01S0136 00311000
         NI    FIRSTALC,B'01111111'                             01S0136 00312000
*      EDLFINIS=OFF;                                            01S0137 00313000
         NI    EDLFINIS,B'01111111'                             01S0137 00314000
*      RELDEVNO = ZERO;               /*INIT RELATIVE DEVICE COUNT   */ 00315000
         SLR   RELDEVNO,RELDEVNO                                01S0138 00316000
*      DO NUMVOLUN=1 TO SVOLUNNO      /*PROCESS SIOTS VOLUNIT ENTRIES*/ 00317000
*        WHILE(RETCODE=NOERROR & VOLUNOPR=OFF); /*STOP ON ERROR, OR     00318000
*                                        WHEN ENTRY CAN'T BE ALLOC'D */ 00319000
         LA    NUMVOLUN,1                                       01S0139 00320000
         B     @DE00139                                         01S0139 00321000
@DL00139 SLR   @07,@07                                          01S0139 00322000
         C     @07,RETCODE                                      01S0139 00323000
         BNE   @DC00139                                         01S0139 00324000
         TM    VOLUNOPR,B'00000010'                             01S0139 00325000
         BNZ   @DC00139                                         01S0139 00326000
*      IF RELDEVNO ^= ZERO |                                    01S0140 00327000
*         (RELDEVNO = ZERO &                                    01S0140 00328000
*         PARTALOC = OFF) THEN        /*DO NOT SKIP                  */ 00329000
         CR    RELDEVNO,@07                                     01S0140 00330000
         BNE   @RT00140                                         01S0140 00331000
         CR    RELDEVNO,@07                                     01S0140 00332000
         BNE   @RF00140                                         01S0140 00333000
         L     @07,@PC00001+8                                   01S0140 00334000
         L     @07,PSPARMP(,@07)                                01S0140 00335000
         TM    PARTALOC(@07),B'00000001'                        01S0140 00336000
         BNZ   @RF00140                                         01S0140 00337000
@RT00140 DS    0H                                               01S0141 00338000
*        DO;                                                    01S0141 00339000
*          IF VDEVREQD=ON THEN        /*DEVICE REQUIRED BY THIS ENTRY*/ 00340000
         L     @07,VUPTR                                        01S0142 00341000
         TM    VDEVREQD(@07),B'00100000'                        01S0142 00342000
         BNO   @RF00142                                         01S0142 00343000
*              DO;                    /*YES:                         */ 00344000
*                RELDEVNO=RELDEVNO+1; /*UPDATE DEVICE COUNT          */ 00345000
         AH    RELDEVNO,@CH00056                                01S0144 00346000
*                IF VOLALOC=OFF THEN  /*ENTRY ALREADY PROCESSED?     */ 00347000
         TM    VOLALOC(@07),B'10000000'                         01S0145 00348000
         BNZ   @RF00145                                         01S0145 00349000
*                  IF VOLUMASK =                                01S0146 00350000
*                    (VOLSTATA & VOLUMASK)    /*NO, ENT RIGHT TYPE?  */ 00351000
*                    & VUDNALOC=OFF THEN /*AND OKAY TO ALLOCATE?     */ 00352000
         MVC   @TS00001(1),VOLSTATA(@07)                        01S0146 00353000
         NC    @TS00001(1),VOLUMASK                             01S0146 00354000
         CLC   VOLUMASK(1),@TS00001                             01S0146 00355000
         BNE   @RF00146                                         01S0146 00356000
         TM    VUDNALOC(@07),B'00001000'                        01S0146 00357000
         BNZ   @RF00146                                         01S0146 00358000
*                    IF DOINGDA = NO |                          01S0147 00359000
*                        (DOINGDA = YES & VOLNSHR = OFF) THEN /*OK   */ 00360000
         TM    DOINGDA,B'10000000'                              01S0147 00361000
         BZ    @RT00147                                         01S0147 00362000
         TM    DOINGDA,B'10000000'                              01S0147 00363000
         BNO   @RF00147                                         01S0147 00364000
         TM    VOLNSHR(@07),B'00001000'                         01S0147 00365000
         BNZ   @RF00147                                         01S0147 00366000
@RT00147 DS    0H                                               01S0148 00367000
*                      DO;                                      01S0148 00368000
*/********************************************************************/ 00369000
*/*                                                                  */ 00370000
*/* SEGMENT NAME - PSVOLUN                                           */ 00371000
*/*                                                                  */ 00372000
*/* DESCRIPTIVE NAME - PROCESS NON-SPECIFIC VOLUNIT ENTRIES          */ 00373000
*/*                                                                  */ 00374000
*/* FUNCTION                                                         */ 00375000
*/*   THIS ROUTINE CONTROLS THE PROCESSING OF A NON-SPECIFIC         */ 00376000
*/*   VOLUNIT ENTRY IN THE FOLLOWING WAYS:                           */ 00377000
*/*     .IT INCLUDES SUBROUTINE PSLSTMNT TO BUILD OR UPDATE THE      */ 00378000
*/*      PUBLIC/STORAGE UCB LIST(PSLIST)                             */ 00379000
*/*     .IF THE PSLIST HAS ENTRIES, THIS ROUTINE CALLS SUBROUTINE    */ 00380000
*/*      IEFAB44O TO BUILD A LIST OF ALLOCATED UCBS FOR USE BY       */ 00381000
*/*      IEFAB434.  (THIS LIST WILL NOT BE BUILT IF A                */ 00382000
*/*      DADSM ERROR OR VOLUME ENQ ERROR OCCURED,                    */ 00383000
*/*      BECAUSE THE OLD LIST IS STILL VALID, AND WAS,               */ 00384000
*/*      THEREFORE, NOT FREED BY PSALLOC.) PROVIDING THE LIST IS     */ 00385000
*/*      BUILT SUCCESSFULLY (OR IF IT ALREADY EXISTS) SUBROUTINE     */ 00386000
*/*      PSALLOC INTERFACES WITH IEFAB434 IN ORDER TO ALLOCATE THE   */ 00387000
*/*      REQUEST.                                                    */ 00388000
*/*     .IF THE PSLIST HAS BECOME NULL BECAUSE THERE WERE NOT ENOUGH */ 00389000
*/*      ELIGIBLE STORAGE DEVICES TO SATISFY THE REQUEST, A          */ 00390000
*/*      SUBROUTINE IS CALLED TO CHANGE THE STORAGE REQUEST TO A     */ 00391000
*/*      PRIVATE REQUEST.                                            */ 00392000
*/*     .IF THE PSLIST DOES NOT HAVE ANY ENTRIES AS THE RESULT OF A  */ 00393000
*/*      'SPACE REQUESTED NOT AVAILABLE' DADSM ERROR (DADSM RETURN   */ 00394000
*/*      CODE HEX 14) AND IF A STORAGE VOLUME WAS BEING PROCESSED, A */ 00395000
*/*      REASON CODE OF 12 IS SET SO THAT THE 'INSUFFICIENT SPACE ON */ 00396000
*/*      STORAGE VOLUMES' MESSAGE WILL BE ISSUED. IF A PUBLIC VOLUME */ 00397000
*/*      WAS BEING PROCESSED OR IF THE PSLIST HAS BECOME NULL        */ 00398000
*/*      AS THE RESULT OF ANY OTHER DADSM ERROR, THE REASON CODE SET */ 00399000
*/*      BY IEFAB434 IS NOT ALTERED.                                 */ 00400000
*/*                                                                  */ 00401000
*/*     .IF THE DADSM ERROR IS RECOVERABLE,A CHECK IS MADE TO@ZA04836*/ 00402000
*/*      DETERMINE IF THERE ARE ANY AFFINITIES. IF THERE ARE,@ZA04836*/ 00403000
*/*      ALL VOLUNIT ENTRIES ASSOCIATED WITH THESE REQUESTS  @ZA04836*/ 00404000
*/*      ARE MARKED WITH VUDADSME AND VUDNALOC.              @ZA04836*/ 00405000
*/*                                                                  */ 00406000
*/* ENTRY -                                                          */ 00407000
*/*   PSVOLUN- INCLUDED MODULE IN IEFAB436                           */ 00408000
*/*                                                                  */ 00409000
*/*   PURPOSE - TO PROCESS NON-SPECIFIC DA VOLUNIT ENTRIES           */ 00410000
*/*                                                                  */ 00411000
*/*   INPUT -                                                        */ 00412000
*/*     POINTER TO CORE FOR PSLIST OR TO PSLIST IF IT ALREADY EXISTS */ 00413000
*/*     THE VOLUNIT ENTRY BEING PROCESSED                            */ 00414000
*/*     THE SIOT BEING PROCESSED (THE SIOT CONTAINS PTRS TO THE EDL  */ 00415000
*/*       AND TO THE NUMBER OF UNITS REMAINING TO BE ALLOCATED)      */ 00416000
*/*     FLAGS INDICATING IF A PUBLIC OR STORAGE VOLUME IS BEING      */ 00417000
*/*       PROCESSED                                                  */ 00418000
*/*                                                                  */ 00419000
*/* EXITS -                                                          */ 00420000
*/*                                                                  */ 00421000
*/*   CONDITION - NORMAL COMPLETION                                  */ 00422000
*/*                                                                  */ 00423000
*/*     OUTPUT -                                                     */ 00424000
*/*       LIST OF ALLOCATED UCBS (ALCUCBLT)                          */ 00425000
*/*       BUILT OR UPDATED PUBLIC/STORAGE LIST(PSLIST)               */ 00426000
*/*                                                                  */ 00427000
*/*     RETURN CODE - 0                                              */ 00428000
*/*                                                                  */ 00429000
*/*   CONDITION - ALLOCATED UCB LIST COULD NOT BE BUILT              */ 00430000
*/*                                                                  */ 00431000
*/*     OUTPUT -                                                     */ 00432000
*/*       INDICATORS FOR VOLUNIT ENTRY NOT PROCESSED AND SIOT NOT    */ 00433000
*/*       COMPLETELY ALLOCATED                                       */ 00434000
*/*                                                                  */ 00435000
*/*     RETURN CODE - 4                                              */ 00436000
*/*                                                                  */ 00437000
*/*   CONDITION - DADSM ERROR(RETURN CODE X'14') ON STORAGE VOLUME   */ 00438000
*/*                                                                  */ 00439000
*/*     OUTPUT -                                                     */ 00440000
*/*       INDICATORS FOR VOLUNIT ENTRY NOT PROCESSED AND SIOT NOT    */ 00441000
*/*         COMPLETELY ALLOCATED                                     */ 00442000
*/*       REASON CODE 12 SET IN SIOT                                 */ 00443000
*/*                                                                  */ 00444000
*/*     RETURN CODE - 4                                              */ 00445000
*/*                                                                  */ 00446000
*/*   CONDITION - DADSM ERROR(OTHER THAN RETURN CODE X'14') ON       */ 00447000
*/*               ON STORAGE VOLUME                                  */ 00448000
*/*                                                                  */ 00449000
*/*     OUTPUT -                                                     */ 00450000
*/*       INDICATORS FOR VOLUNIT ENTRY NOT PROCESSED AND SIOT NOT    */ 00451000
*/*       COMPLETELY ALLOCATED.                                      */ 00452000
*/*                                                                  */ 00453000
*/*     RETURN CODE - 4                                              */ 00454000
*/*                                                          @ZA04836*/ 00455000
*/*   CONDITION - RECOVERABLE DADSM ERROR ON PUBLIC VOLUME   @ZA04836*/ 00456000
*/*                                                          @ZA04836*/ 00457000
*/*     OUTPUT -                                             @ZA04836*/ 00458000
*/*       DADSM ERROR INDICATORS SETIN ALL VOLUNIT ENTRIES   @ZA04836*/ 00459000
*/*       WHICH REQUEST AFFINITY                             @ZA04836*/ 00460000
*/*                                                          @ZA04836*/ 00461000
*/*       DONT PROCESS UNITL RECOVERY INDICATORS SET IN      @ZA04836*/ 00462000
*/*       ALL VOLUNIT ENTRIES WHICH REQUEST AFFINITY         @ZA04836*/ 00463000
*/*                                                                  */ 00464000
*/*                                                                  */ 00465000
*/********************************************************************/ 00466000
*DO WHILE(VOLALOC=OFF & RETCODE=NOERROR & VOLUNOPR=OFF); /*STOP ON      00467000
*                                        ERROR,WHEN ALLOCATED OR WHEN   00468000
*                                        CAN'T BE ALLOCATED          */ 00469000
         B     @DE00149                                         02S0149 00470000
@DL00149 DS    0H                                               02S0150 00471000
*/********************************************************************/ 00472000
*/*                                                                  */ 00473000
*/* SEGMENT NAME - PSLSTMNT                                          */ 00474000
*/*                                                                  */ 00475000
*/* DESCRIPTIVE NAME - MAINTAIN PSLIST                               */ 00476000
*/*                                                                  */ 00477000
*/* FUNCTION -                                                       */ 00478000
*/*   THIS ROUTINE IS RESPONSIBLE FOR THE CREATION AND UPDATING OF   */ 00479000
*/*   THE PUBLIC/STORAGE UCB LIST(PSLIST) AS FOLLOWS:                */ 00480000
*/*     . IF THE PSLIST IS TO BE CREATED, A BUILD SUBROUTINE,        */ 00481000
*/*       PSLSTBLD, IS INVOKED FOR EACH DEVICE TYPE IN THE EDL. A    */ 00482000
*/*       FLAG IS SET TO INDICATE THAT THE LIST EXISTS.              */ 00483000
*/*     . THE PSLIST CAN BE UPDATED IN ONE OF THREE WAYS. (1) FOR    */ 00484000
*/*       MULTI-UNIT ALLOCATION, AFTER THE FIRST UNIT HAS BEEN       */ 00485000
*/*       ALLOCATED, THE LIST IS UPDATED SO THAT REMAINING UNITS     */ 00486000
*/*       WILL BE ALLOCATED FROM THE SAME DEVICE TYPE AS THE FIRST   */ 00487000
*/*       UNIT. THE UPDATING IS DONE BY THE PSLSTBLD SUBROUTINE.     */ 00488000
*/*       THE POINTER TO THE EDL ENTRY FOR THE ELIGIBLE DEVICE TYPE  */ 00489000
*/*       HAS BEEN SET IN PRIOR PROCESSING IN THE PSFNDEDL ROUTINE   */ 00490000
*/*       SO IT IS NOT RESET BY THIS ROUTINE BEFORE PSLSTBLD IS      */ 00491000
*/*       CALLED. ON RETURN FROM PSLSTBLD, THE EDL IS UPDATED SO     */ 00492000
*/*       THAT ALL EDL ENTRIES EXCEPT THE ONE FOR THE GENERIC JUST   */ 00493000
*/*       ALLOCATED ARE MARKED INELIGIBLE. (2) THE PSLIST CAN ALSO BE*/ 00494000
*/*       UPDATED BY ELIMINATING AN ENTRY THAT WAS JUST PROCESSED.   */ 00495000
*/*       THIS IS DONE FOR A MULTI-UNIT REQUEST WHEN THE PSLIST      */ 00496000
*/*       ALREADY CONTAINS ENTRIES FOR JUST ONE GENERIC. (3) IF      */ 00497000
*/*       A DADSM ERROR OCCURS, THE ENTRY FOR WHICH THE ERROR        */ 00498000
*/*       OCCURRED IS EXCHANGED WITH THE LAST ENTRY IN THE LIST.     */ 00499000
*/*       SINCE THE INDEX INTO THE PSLIST HAS BEEN DECREMENTED, THIS */ 00500000
*/*       ENTRY WILL NOT BE CONSIDERED FOR FUTURE ALLOCATION UNTIL   */ 00501000
*/*       SPACE HAS BEEN ASSIGNED TO ANOTHER UNIT VIA DADSM. WHEN    */ 00502000
*/*       SPACE HAS BEEN GOTTEN, THE ORIGINAL INDEX IS RESTORED SO   */ 00503000
*/*       THAT ALL ENTRIES CAN NOW BE CONSIDERED IF THIS IS A MULTI- */ 00504000
*/*       UNIT REQUEST. (THIS IS POSSIBLE BECAUSE SPACE IS ONLY      */ 00505000
*/*       ASSIGNED ONCE FOR MULTI-UNIT REQUESTS.                     */ 00506000
*/*                                                                  */ 00507000
*/* ENTRY - PSLSTMNT(INCLUDED SEGMENT IN PSVOLUN)                    */ 00508000
*/*                                                                  */ 00509000
*/*   PURPOSE - TO BUILD AND MAINTAIN THE PUBLIC/STORAGE LIST(PSLIST)*/ 00510000
*/*                                                                  */ 00511000
*/*   INPUT -                                                        */ 00512000
*/*     POINTER TO CORE FOR PSLIST OR TO PSLIST IF IT ALREADY EXISTS */ 00513000
*/*     PSLEXIST SWITCH - ON IF PSLIST ALREADY EXISTS                */ 00514000
*/*     PTR TO THE EDL GENERIC ENTRY JUST ALLOCATED                  */ 00515000
*/*                                                                  */ 00516000
*/* EXITS -                                                          */ 00517000
*/*                                                                  */ 00518000
*/*   CONDITION - NORMAL COMPLETION                                  */ 00519000
*/*                                                                  */ 00520000
*/*     OUTPUT -                                                     */ 00521000
*/*       BUILT OR UPDATED PUBLIC/STORAGE UCB LIST(PSLIST)           */ 00522000
*/*       UPDATED EDL ENTRIES IF PROCESSING FOR ONE GENERIC ONLY     */ 00523000
*/*                                                                  */ 00524000
*/*     RETURN CODE - N/A                                            */ 00525000
*/*                                                                  */ 00526000
*/********************************************************************/ 00527000
* DO; /*MODESET  KEYADDR(ZERO)*/                                03S0150 00528000
*   SPKA (ZERO); /*SET PSW KEY*/                                03S0151 00529000
         SLR   @07,@07                                          03S0151 00530000
         SPKA  0(@07)                                           03S0151 00531000
* END; /*MODESET  KEYADDR(ZERO)*/                               03S0152 00532000
*PSLISTP = LISTP;                      /*PTR TO CAND LIST FOR OPT    */ 00533000
         MVC   PSLISTP(4,OPTPARMP),LISTP                        03S0153 00534000
*IF PSLEXIST=OFF THEN                  /*PUBLIC/STORAGE LIST BUILT?  */ 00535000
         TM    PSLEXIST,B'00100000'                             03S0154 00536000
         BNZ   @RF00154                                         03S0154 00537000
*  DO;                                 /*NO,BUILD LIST               */ 00538000
*    EDLPTR=EDLFGENP;                  /*POINT TO FIRST EDL ENTRY    */ 00539000
         L     @07,SIOTPTR                                      03S0156 00540000
         L     @07,SIOTEDLP(,@07)                               03S0156 00541000
         L     EDLPTR,EDLFGENP(,@07)                            03S0156 00542000
*    PSLINDEX=1;                       /*INIT INDEX INTO PSLIST      */ 00543000
         LA    PSLINDEX,1                                       03S0157 00544000
*    DO WHILE(EDLPTR^=TABEND);         /*PROCESS ALL EDL DEVICE TYPES*/ 00545000
         B     @DE00158                                         03S0158 00546000
@DL00158 DS    0H                                               03S0159 00547000
*      SAVENDEX = PSLINDEX;            /*SAVE CURRENT INDEX          */ 00548000
         LR    SAVENDEX,PSLINDEX                                03S0159 00549000
*      CALL PSLSTBLD;                  /*BUILD LIST FOR DEVICE TYPE  */ 00550000
         BAL   @14,PSLSTBLD                                     03S0160 00551000
*      IF (PSLINDEX-SAVENDEX)<SIOPSCNT & /*ENOUGH UNITS IN LST  03S0161 00552000
*                                        FOR REQUEST?                */ 00553000
*         PARTALOC=OFF &                                        03S0161 00554000
*         EDLMGENS=OFF THEN                                     03S0161 00555000
         LR    @07,PSLINDEX                                     03S0161 00556000
         SLR   @07,SAVENDEX                                     03S0161 00557000
         L     @15,SIOTPTR                                      03S0161 00558000
         SLR   @14,@14                                          03S0161 00559000
         IC    @14,SIOPSCNT(,@15)                               03S0161 00560000
         CR    @07,@14                                          03S0161 00561000
         BNL   @RF00161                                         03S0161 00562000
         L     @14,@PC00001+8                                   03S0161 00563000
         L     @01,PSPARMP(,@14)                                03S0161 00564000
         TM    PARTALOC(@01),B'00000001'                        03S0161 00565000
         BNZ   @RF00161                                         03S0161 00566000
         L     @01,SIOTEDLP(,@15)                               03S0161 00567000
         TM    EDLMGENS(@01),B'01000000'                        03S0161 00568000
         BNZ   @RF00161                                         03S0161 00569000
*           DO;                                                 03S0162 00570000
*             IF LGENLOCK=EDLDEVT THEN   /*ALLOCATING BY GENERIC     */ 00571000
         L     @15,@PC00001                                     03S0163 00572000
         L     @01,ALCWAPTR(,@15)                               03S0163 00573000
         CLC   LGENLOCK(4,@01),EDLDEVT(EDLPTR)                  03S0163 00574000
         BNE   @RF00163                                         03S0163 00575000
*               EDLNSCNT=PSLINDEX-SAVENDEX;  /*SAVE # OF UNITS IN GEN*/ 00576000
         STH   @07,EDLNSCNT(,EDLPTR)                            03S0164 00577000
*             PSLINDEX = SAVENDEX;     /*NO,DEL THIS DEVTYPE FROM LST*/ 00578000
@RF00163 LR    PSLINDEX,SAVENDEX                                03S0165 00579000
*             PSLISTNO = PSLINDEX-1;   /*RESTORE NO. PSLIST ENTRIES  */ 00580000
         L     @07,PSLISTP(,OPTPARMP)                           03S0166 00581000
         LR    @03,PSLINDEX                                     03S0166 00582000
         BCTR  @03,0                                            03S0166 00583000
         ST    @03,PSLISTNO(,@07)                               03S0166 00584000
*           END;                                                03S0167 00585000
*      EDLPTR=EDLNXTNT;                /*POINT TO NEXT DEVICE TYPE   */ 00586000
@RF00161 L     EDLPTR,EDLNXTNT(,EDLPTR)                         03S0168 00587000
*    END;                                                       03S0169 00588000
@DE00158 LTR   EDLPTR,EDLPTR                                    03S0169 00589000
         BNZ   @DL00158                                         03S0169 00590000
*    PSLEXIST=ON;                      /*INDICATE LIST EXISTS        */ 00591000
         OI    PSLEXIST,B'00100000'                             03S0170 00592000
*  END;                                                         03S0171 00593000
*ELSE                                  /*LIST WAS BUILT - UPDATE IT  */ 00594000
*  IF PSLUPDAT=OFF & DADSMESW=OFF &    /*ELIMINATE OTHER DEV TYPES?  */ 00595000
*    ENQERROR=OFF & EDLMGENS = OFF THEN                         03S0172 00596000
         B     @RC00154                                         03S0172 00597000
@RF00154 TM    PSLUPDAT,B'01011000'                             03S0172 00598000
         BNZ   @RF00172                                         03S0172 00599000
         L     @07,SIOTPTR                                      03S0172 00600000
         L     @07,SIOTEDLP(,@07)                               03S0172 00601000
         TM    EDLMGENS(@07),B'01000000'                        03S0172 00602000
         BNZ   @RF00172                                         03S0172 00603000
*      DO;                             /*YES,REBUILD LIST            */ 00604000
*        EDLFINIS = OFF;               /*INDICATE EDL UPDATED        */ 00605000
         NI    EDLFINIS,B'01111111'                             03S0174 00606000
*        PSLINDEX=1;                   /*INIT INDEX INTO PSLIST      */ 00607000
         LA    PSLINDEX,1                                       03S0175 00608000
*        CALL PSLSTBLD;                /*REBUILD LIST FOR ONE GENERIC*/ 00609000
         BAL   @14,PSLSTBLD                                     03S0176 00610000
*        PSLUPDAT=ON;                  /*INDICATE ONE GENERIC IN LIST*/ 00611000
         OI    PSLUPDAT,B'00010000'                             03S0177 00612000
*        EDLPSAVE=EDLPTR;              /*SAVE PTR TO EDL ENTRY       */ 00613000
         LR    EDLPSAVE,EDLPTR                                  03S0178 00614000
*        EDLPTR=EDLFGENP;              /*POINT TO FIRST EDL          */ 00615000
         L     @07,SIOTPTR                                      03S0179 00616000
         L     @07,SIOTEDLP(,@07)                               03S0179 00617000
         L     EDLPTR,EDLFGENP(,@07)                            03S0179 00618000
*        DO WHILE(EDLPTR^=ZERO);       /*MARK EDL ENTRIES FOR ALL       00619000
*                                        GENERICS BUT ONE INELIGIBLE */ 00620000
         B     @DE00180                                         03S0180 00621000
@DL00180 DS    0H                                               03S0181 00622000
*          IF EDLPTR^=EDLPSAVE THEN    /*EDL FOR ELIGIBLE GENERIC?   */ 00623000
         CR    EDLPTR,EDLPSAVE                                  03S0181 00624000
         BE    @RF00181                                         03S0181 00625000
*            EINDEVTP=ON;              /*NO,MARK EDL INELIGIBLE      */ 00626000
         OI    EINDEVTP(EDLPTR),B'10000000'                     03S0182 00627000
*          EDLPTR=EDLNXTNT;            /*POINT TO NEXT EDL ENTRY     */ 00628000
@RF00181 L     EDLPTR,EDLNXTNT(,EDLPTR)                         03S0183 00629000
*        END;                                                   03S0184 00630000
@DE00180 LTR   EDLPTR,EDLPTR                                    03S0184 00631000
         BNZ   @DL00180                                         03S0184 00632000
*      EDLPTR=EDLPSAVE;                /*RESTORE EDL PTR             */ 00633000
         LR    EDLPTR,EDLPSAVE                                  03S0185 00634000
*    END;                                                       03S0186 00635000
*  ELSE                                /*NO,REMOVE ENTRY LAST PROCESS*/ 00636000
*    DO;                                                        03S0187 00637000
         B     @RC00172                                         03S0187 00638000
@RF00172 DS    0H                                               03S0188 00639000
*      PSLISTNO=PSLISTNO-1;            /*DECREMENT INDEX BY ONE      */ 00640000
         L     @07,PSLISTP(,OPTPARMP)                           03S0188 00641000
         L     @15,PSLISTNO(,@07)                               03S0188 00642000
         BCTR  @15,0                                            03S0188 00643000
         ST    @15,PSLISTNO(,@07)                               03S0188 00644000
*      IF PSLISTNO^=ZERO THEN          /*LAST PSLIST ENTRY?          */ 00645000
         LTR   @15,@15                                          03S0189 00646000
         BZ    @RF00189                                         03S0189 00647000
*        DO;                                                    03S0190 00648000
*          PSLINDEX=((OPTDEVP-PSLISTP)/PSENTLN); /*SET INDEX TO ENT     00649000
*                                                  JUST PROCESSED    */ 00650000
         LR    @00,@07                                          03S0191 00651000
         LCR   @00,@00                                          03S0191 00652000
         AL    @00,OPTDEVP(,OPTPARMP)                           03S0191 00653000
         SRDA  @00,32                                           03S0191 00654000
         LH    PSLINDEX,PSENTLN                                 03S0191 00655000
         DR    @00,PSLINDEX                                     03S0191 00656000
         LR    PSLINDEX,@01                                     03S0191 00657000
*          IF DADSMESW=OFF THEN        /*DADSM ERROR?                */ 00658000
         TM    DADSMESW,B'00001000'                             03S0192 00659000
         BNZ   @RF00192                                         03S0192 00660000
*            DO PSLINDEX TO PSLISTNO;  /*NO,REMOVE LAST ENT PROCESSED*/ 00661000
         B     @DE00193                                         03S0193 00662000
@DL00193 DS    0H                                               03S0194 00663000
*              PSLSTENT(PSLINDEX)=PSLSTENT(PSLINDEX+1); /*MOVE ENTRY */ 00664000
         LR    @07,PSLINDEX                                     03S0194 00665000
         SLA   @07,2                                            03S0194 00666000
         L     @03,PSLISTP(,OPTPARMP)                           03S0194 00667000
         L     @15,PSLSTENT(@07,@03)                            03S0194 00668000
         ST    @15,PSLSTENT-4(@07,@03)                          03S0194 00669000
*            END;                                               03S0195 00670000
         AH    PSLINDEX,@CH00056                                03S0195 00671000
@DE00193 L     @07,PSLISTP(,OPTPARMP)                           03S0195 00672000
         C     PSLINDEX,PSLISTNO(,@07)                          03S0195 00673000
         BNH   @DL00193                                         03S0195 00674000
*          ELSE                        /*YES, DADSM ERROR            */ 00675000
*            DO;                       /*EXCHANGE BAD ENT WITH LAST     00676000
*                                        ENTRY BY USING EXCLUSIVE ORS*/ 00677000
         B     @RC00192                                         03S0196 00678000
@RF00192 DS    0H                                               03S0197 00679000
*              PSLSTENT(PSLINDEX)=                              03S0197 00680000
*                PSLSTENT(PSLINDEX) && PSLSTENT(PSLISTNO+1);    03S0197 00681000
         LR    @07,PSLINDEX                                     03S0197 00682000
         SLA   @07,2                                            03S0197 00683000
         L     @03,PSLISTP(,OPTPARMP)                           03S0197 00684000
         L     @15,PSLISTNO(,@03)                               03S0197 00685000
         SLA   @15,2                                            03S0197 00686000
         L     @14,PSLSTENT-4(@07,@03)                          03S0197 00687000
         X     @14,PSLSTENT(@15,@03)                            03S0197 00688000
         ST    @14,PSLSTENT-4(@07,@03)                          03S0197 00689000
*              PSLSTENT(PSLISTNO+1)=                            03S0198 00690000
*                PSLSTENT(PSLISTNO+1) && PSLSTENT(PSLINDEX);    03S0198 00691000
         X     @14,PSLSTENT(@15,@03)                            03S0198 00692000
         ST    @14,PSLSTENT(@15,@03)                            03S0198 00693000
*              PSLSTENT(PSLINDEX)=                              03S0199 00694000
*                PSLSTENT(PSLINDEX) && PSLSTENT(PSLISTNO+1);    03S0199 00695000
         X     @14,PSLSTENT-4(@07,@03)                          03S0199 00696000
         ST    @14,PSLSTENT-4(@07,@03)                          03S0199 00697000
*            END;                                               03S0200 00698000
*        END;                                                   03S0201 00699000
@RC00192 DS    0H                                               03S0202 00700000
*    END;                                                       03S0202 00701000
@RF00189 DS    0H                                               03S0203 00702000
* DO; /*MODESET  EXTKEY(SCHED)*/                                03S0203 00703000
@RC00172 DS    0H                                               03S0203 00704000
@RC00154 DS    0H                                               03S0204 00705000
*   SPKA (16); /*SET PSW KEY*/                                  03S0204 00706000
         LA    @07,16                                           03S0204 00707000
         SPKA  0(@07)                                           03S0204 00708000
* END; /*MODESET  EXTKEY(SCHED)*/                               03S0205 00709000
*  IF PSLISTNO^=ZERO THEN              /*ANY ENTRIES IN PUB/STG LIST?*/ 00710000
         L     @07,PSLISTP(,OPTPARMP)                           02S0206 00711000
         ICM   @15,15,PSLISTNO(@07)                             02S0206 00712000
         BZ    @RF00206                                         02S0206 00713000
*    DO;                                                        02S0207 00714000
*      IF REUSESW=OFF THEN             /*YES,REUSE PREVIOUS ALUCBLT? */ 00715000
         TM    REUSESW,B'00000001'                              02S0208 00716000
         BNZ   @RF00208                                         02S0208 00717000
*        DO;                           /*NO:                         */ 00718000
*          CALL IEFAB440(ALCWAPTR,ALCUCBP,ALCULEN); /*BUILD ALLOCATED   00719000
*                                                     UCB LIST       */ 00720000
         L     @07,@PC00001                                     02S0210 00721000
         ST    @07,@AL00001                                     02S0210 00722000
         LA    @07,ALCUCBP(,OPTPARMP)                           02S0210 00723000
         ST    @07,@AL00001+4                                   02S0210 00724000
         LA    @07,ALCULEN                                      02S0210 00725000
         ST    @07,@AL00001+8                                   02S0210 00726000
         L     @15,@CV00964                                     02S0210 00727000
         LA    @01,@AL00001                                     02S0210 00728000
         BALR  @14,@15                                          02S0210 00729000
*          RETCODE=REG15;              /*SAVE RETURN CODE            */ 00730000
         ST    REG15,RETCODE                                    02S0211 00731000
*        END;                                                   02S0212 00732000
*      ELSE                            /*ALCUCBLT ALREADY EXISTS     */ 00733000
*        REUSESW=OFF;                  /*RESET REUSE SLCUCBLT SWITCH */ 00734000
         B     @RC00208                                         02S0213 00735000
@RF00208 NI    REUSESW,B'11111110'                              02S0213 00736000
*      IF RETCODE = ZERO THEN          /*LIST BUILT SUCCESSFULLY OR     00737000
*                                        ALREADY EXISTS?             */ 00738000
@RC00208 SLR   @07,@07                                          02S0214 00739000
         C     @07,RETCODE                                      02S0214 00740000
         BNE   @RF00214                                         02S0214 00741000
*        DO;                           /*YES:                        */ 00742000
*/********************************************************************/ 00743000
*/*                                                                  */ 00744000
*/* SEGMENT NAME - PSALLOC                                           */ 00745000
*/*                                                                  */ 00746000
*/* DESCRIPTIVE NAME - ALLOCATE NON-SPECIFIC REQUEST                 */ 00747000
*/*                                                                  */ 00748000
*/* FUNCTION -                                                       */ 00749000
*/*   THIS ROUTINE INTERFACES WITH THE SYS RESOURCES MGR (OPTIMIZER) */ 00750000
*/*   AND WITH THE ALLOCATE REQUEST TO UNIT ROUTINE (IEFAB434) IN    */ 00751000
*/*   ORDER TO ALLOCATE NON-SPECIFIC VOLUNIT ENTRIES. IT HAS THE     */ 00752000
*/*   FOLLOWING FUNCTIONS:                                           */ 00753000
*/*     .SELECTION OF AN OPTIMUM DEVICE OUT OF THE PSLIST BY         */ 00754000
*/*      INVOKING THE SYSTEM RESOURCES MANAGER. A 2-WORD RETURN      */ 00755000
*/*      AREA IS FILLED IN BY THE OPTIMIZER.                         */ 00756000
*/*      IF A DEVICE IS SELECTED, THE FIRST WORD CONTAINS A POINTER  */ 00757000
*/*      TO THE UCB ADDRESS IN PSLIST OF THE SELECTED DEVICE. THE    */ 00758000
*/*      SECOND WORD EQUALS ZERO. OTHERWISE, THE FIRST WORD EQUALS   */ 00759000
*/*      ZERO AND THE SECOND WORD CONTAINS AN ERROR REASON CODE.     */ 00760000
*/*     .IF A NON-SPECIFIC REQUEST IS ALLOCATED TO A NON PERMRES/    */ 00761000
*/*      RESVD DEVICE A CONDITIONAL ENQ ON THE VOLUME SERIAL NUMBER  */ 00762000
*/*      IS DONE (BY INVOKING IEFAB4F0). IF THE ENQ IS NOT           */ 00763000
*/*      SUCCESSFUL, ANOTHER CANDIDATE WILL BE CHOSEN.               */ 00764000
*/*     .INVOKING IEFAB434 TO ALLOCATE THE UNIT. PARAMETERS PASSED   */ 00765000
*/*      INCLUDE THE RELATIVE POSITION IN THE ETIOT FOR THIS UNIT,   */ 00766000
*/*      THE UNIT'S GROUP ID, AN INDICATION OF WHETHER TO UPDATE OR  */ 00767000
*/*      CREATE THE ETIOT, AND, IF THE ETIOT IS TO BE CREATED, THE   */ 00768000
*/*      NUMBER OF DEVICE ENTRIES NEEDED.                            */ 00769000
*/*     .IF THE ALLOCATION IS SUCCESSFUL, MARKING THE VOLUNIT AND    */ 00770000
*/*      EDL UCB ENTRIES ALLOCATED. ALSO, APPROPRIATE FIELDS IN THE  */ 00771000
*/*      COUNT TABLE ARE DECREMENTED. THIS PROCESSING IS ALSO DONE   */ 00772000
*/*      IF RETURN CODES 32 OR 36 ARE RECEIVED FROM IEFAB434 BECAUSE */ 00773000
*/*      THESE RETURN CODES DO NOT INDICATE AN ERROR IN THE REQUEST  */ 00774000
*/*      BEING PROCESSED. THEY INDICATE AN ERROR IN A DD REQUESTING  */ 00775000
*/*      AFFINITY TO THE REQUEST BEING PROCESSED. IF THE RETURN CODE */ 00776000
*/*      IS 36, THE RETCODE FIELD IS SET TO 36 SO THAT PROCESSING    */ 00777000
*/*      WILL NOT CONTINUE. IF THE RETURN CODE IS 32, THE RETCODE    */ 00778000
*/*      FIELD IS LEFT AT ZERO, AND A REASON CODE IS SET TO INDICATE */ 00779000
*/*      A DADSM ERROR DURING AFFINITY PROCESSING.                   */ 00780000
*/*     .IF THE ALLOCATION FAILS BECAUSE OF A DADSM ERROR            */ 00781000
*/*      OR VOLUME ENQ ERROR, SETTING A FLAG                         */ 00782000
*/*      TO INDICATE THAT THE PSLIST MUST BE UPDATED TO              */ 00783000
*/*      ELIMINATE AN ENTRY. FOR OTHER ERRORS, A REASON CODE IS SET  */ 00784000
*/*      AND AN ERROR RETURN CODE IS RETURNED TO THE CALLER.         */ 00785000
*/*     .FREEING THE CORE CONTAINING THE LIST OF ALLOCATED UCBS      */ 00786000
*/*      (ALCUCBLT) BUILT BY IEFAB440 FOR USE BY THE SYSTEM RESOURCES*/ 00787000
*/*      MANAGER. (THE CORE IS NOT FREED IF A DADSM ERROR            */ 00788000
*/*      OCCURRED IN ORDER THAT THE LIST MAY BE REUSED.)             */ 00789000
*/*                                                                  */ 00790000
*/* ENTRY - PSALLOC (INCLUDED SEGMENT IN PSVOLUN)                    */ 00791000
*/*                                                                  */ 00792000
*/*   PURPOSE -                                                      */ 00793000
*/*     TO INTERFACE WITH THE SYSTEM RESOURCES MANAGER AND           */ 00794000
*/*     IEFAB434.                                                    */ 00795000
*/*                                                                  */ 00796000
*/*   INPUT -                                                        */ 00797000
*/*     PSLIST                                                       */ 00798000
*/*     LIST OF ALLOCATED UCBS(ALCUCBLT)                             */ 00799000
*/*                                                                  */ 00800000
*/* EXITS -                                                          */ 00801000
*/*                                                                  */ 00802000
*/*   CONDITION - SUCCESSFUL ALLOCATION                              */ 00803000
*/*                                                                  */ 00804000
*/*   OUTPUT -                                                       */ 00805000
*/*     ALLOCATED UNIT FOR VOLUNIT ENTRY                             */ 00806000
*/*     POINTER TO EDL ENTRY FOR ALLOCATED UNIT                      */ 00807000
*/*     FREED CORE FOR ALCUCBLT UNLESS A DADSM ERROR OCCURRED        */ 00808000
*/*     EDL UCB ENTRY MARKED ALLOCATED                               */ 00809000
*/*     VOLUNIT ENTRY MARKED ALLOCATED                               */ 00810000
*/*     VOLUME SERIAL ENQ'D                                          */ 00811000
*/*                                                                  */ 00812000
*/*   RETURN CODE - 0                                                */ 00813000
*/*                                                                  */ 00814000
*/*   CONDITION - DADSM ERROR                                        */ 00815000
*/*                                                                  */ 00816000
*/*   OUTPUT -                                                       */ 00817000
*/*     SWITCH SET TO INDICATE THAT PSLIST MUST BE UPDATED           */ 00818000
*/*                                                                  */ 00819000
*/*   RETURN CODE -                                                  */ 00820000
*/*     A RETURN CODE OF 12 IS RECEIVED FROM IEFAB434, A RETURN      */ 00821000
*/*     CODE OF 0 IS RETURNED TO THE CALLER                          */ 00822000
*/*                                                                  */ 00823000
*/*   CONDITION - GETMAIN ERROR                                      */ 00824000
*/*                                                                  */ 00825000
*/*   OUTPUT - REASON CODE 2                                         */ 00826000
*/*                                                                  */ 00827000
*/*   RETURN CODE - 4                                                */ 00828000
*/*                                                                  */ 00829000
*/*   CONDITION - SYSTEM RESOURCES MANAGER ERROR                     */ 00830000
*/*                                                                  */ 00831000
*/*   OUTPUT - REASON CODE 9                                         */ 00832000
*/*                                                                  */ 00833000
*/*   RETURN CODE - 8                                                */ 00834000
*/*                                                                  */ 00835000
*/*   CONDITION - RECOVERABLE DADSM ERROR DURING AFFINITY            */ 00836000
*/*     PROCESSING (RETURN CODE 32 FROM IEFAB434)                    */ 00837000
*/*                                                                  */ 00838000
*/*   OUTPUT -                                                       */ 00839000
*/*     ALLOCATED UNIT FOR VOLUNIT ENTRY                             */ 00840000
*/*     EDL UCB ENTRY MARKED ALLOCATED                               */ 00841000
*/*     VOLUNIT ENTRY MARKED ALLOCATED                               */ 00842000
*/*     SIOT MARKED ALLOCATED IF LAST VOLUNIT ENTRY FOR DD ALLOCATED */ 00843000
*/*     TOTREQS FIELD IN COUNT TABLE DECREMENTED IF SIOT ALLOCATED   */ 00844000
*/*     FREED CORE FOR ALCUCBLT                                      */ 00845000
*/*     REASON CODE 8                                                */ 00846000
*/*                                                                  */ 00847000
*/*   RETURN CODE - 0                                                */ 00848000
*/*                                                                  */ 00849000
*/*   CONDITION - ERROR OTHER THAN RECOVERABLE DADSM DURING          */ 00850000
*/*     AFFINITY PROCESSING (RETURN CODE 36 FROM IEFAB434)           */ 00851000
*/*                                                                  */ 00852000
*/*   OUTPUT -                                                       */ 00853000
*/*     ALLOCATED UNIT FOR VOLUNIT ENTRY                             */ 00854000
*/*     EDL UCB ENTRY MARKED ALLOCATED                               */ 00855000
*/*     VOLUNIT ENTRY MARKED ALLOCATED                               */ 00856000
*/*     SIOT MARKED ALLOCATED IF LAST VOLUNIT ENTRY FOR DD ALLOCATED */ 00857000
*/*     TOTREQS FIELD IN COUNT TABLE DECREMENTED IF SIOT ALLOCATED   */ 00858000
*/*     FREED CORE FOR ALCUCBLT                                      */ 00859000
*/*                                                                  */ 00860000
*/*   RETURN CODE - 36                                               */ 00861000
*/*                                                                  */ 00862000
*/*   CONDITION - TAPE VALIDITY CHECK ERROR (RETURN CODE     @ZA04112*/ 00863000
*/*               40 FROM IEFAB434)                          @ZA04112*/ 00864000
*/*                                                          @ZA04112*/ 00865000
*/*   OUTPUT -                                               @ZA04112*/ 00866000
*/*     ALLOCATED UNIT FOR VOLUNIT ENTRY                     @ZA04112*/ 00867000
*/*     EDL UCB ENTRY MARKED ALLOCATED                       @ZA04112*/ 00868000
*/*     VOLUNIT ENTRY MARKED ALLOCATED                       @ZA04112*/ 00869000
*/*     SIOT MARKED ALLOCATED IF LAST VOLUNIT ENTRY FOR      @ZA04112*/ 00870000
*/*       DD ALLOCATED                                       @ZA04112*/ 00871000
*/*     TOTREQS FIELD IN COUNT TABLE DECREMENTED IF SIOT     @ZA04112*/ 00872000
*/*       ALLOCATED                                          @ZA04112*/ 00873000
*/*     FREED CORE FOR ALCUCBLT                              @ZA04112*/ 00874000
*/*     VOLUNIT ENTRIES IN AFFINITY CHAIN MARKED FOR         @ZA04112*/ 00875000
*/*       RECOVERY                                           @ZA04112*/ 00876000
*/*                                                                  */ 00877000
*/*   RETURN CODE - 40                                       @ZA04112*/ 00878000
*/*                                                                  */ 00879000
*/********************************************************************/ 00880000
*VOLUMENQ=OFF;                                                  03S0216 00881000
*VOLUMEDQ=OFF;                                                  03S0217 00882000
         NI    VOLUMENQ,B'00111111'                             03S0217 00883000
*ENQERROR=OFF;                                                  03S0218 00884000
*DADSMESW=OFF;                         /*INIT DADSM ERROR SWITCH     */ 00885000
         NI    ENQERROR,B'10110111'                             03S0219 00886000
* DO; /*MODESET  KEYADDR(ZERO)*/                                03S0220 00887000
*   SPKA (ZERO); /*SET PSW KEY*/                                03S0221 00888000
         SPKA  0(@07)                                           03S0221 00889000
* END; /*MODESET  KEYADDR(ZERO)*/                               03S0222 00890000
*IF PSLISTNO ^= ONE THEN               /*MORE THAN 1 CANDIDATE       */ 00891000
         L     @07,PSLISTP(,OPTPARMP)                           03S0223 00892000
         CLC   PSLISTNO(4,@07),@CF00056                         03S0223 00893000
         BE    @RF00223                                         03S0223 00894000
*  DO;                                                          03S0224 00895000
*    RETPARMP = ADDR(RETAREA);                                  03S0225 00896000
         LA    @07,RETAREA(,OPTPARMP)                           03S0225 00897000
         ST    @07,RETPARMP(,OPTPARMP)                          03S0225 00898000
*    RFY (REG1) RSTD;                                           03S0226 00899000
*    REG1 = OPTPARMP;                                           03S0227 00900000
         LR    REG1,OPTPARMP                                    03S0227 00901000
*    GEN(SYSEVENT DEVALLOC);           /*CALL OPTIMIZER              */ 00902000
         SYSEVENT DEVALLOC                                              00903000
*    RFY (REG1) UNRSTD;                                         03S0229 00904000
*  END;                                                         03S0230 00905000
*ELSE                                  /*ONLY 1 CANDIDATE            */ 00906000
*  OPTDEVP = PSLISTP + PSHDRLEN;       /*POINT TO ONLY CANDIDATE     */ 00907000
         B     @RC00223                                         03S0231 00908000
@RF00223 L     @07,PSLISTP(,OPTPARMP)                           03S0231 00909000
         AL    @07,PSHDRLEN                                     03S0231 00910000
         ST    @07,OPTDEVP(,OPTPARMP)                           03S0231 00911000
* DO; /*MODESET  EXTKEY(SCHED)*/                                03S0232 00912000
@RC00223 DS    0H                                               03S0233 00913000
*   SPKA (16); /*SET PSW KEY*/                                  03S0233 00914000
         LA    @07,16                                           03S0233 00915000
         SPKA  0(@07)                                           03S0233 00916000
* END; /*MODESET  EXTKEY(SCHED)*/                               03S0234 00917000
*IF OPTDEVP^=ZERO THEN                 /*DEVICE SELECTED?            */ 00918000
         L     @07,OPTDEVP(,OPTPARMP)                           03S0235 00919000
         LTR   @07,@07                                          03S0235 00920000
         BZ    @RF00235                                         03S0235 00921000
*  DO;                                 /*YES,SET UP TO ALLOCATE      */ 00922000
*    PSLINDEX=((OPTDEVP-PSLISTP)/PSENTLN); /*SET INDEX TO OPTIMUM ENT*/ 00923000
         L     @15,PSLISTP(,OPTPARMP)                           03S0237 00924000
         LR    @00,@07                                          03S0237 00925000
         SLR   @00,@15                                          03S0237 00926000
         SRDA  @00,32                                           03S0237 00927000
         LH    PSLINDEX,PSENTLN                                 03S0237 00928000
         DR    @00,PSLINDEX                                     03S0237 00929000
         LR    PSLINDEX,@01                                     03S0237 00930000
*    UCBPTR=PSLSTENT(PSLINDEX);        /*SET UCB PTR TO OPTIMUM DEV  */ 00931000
         LR    @07,PSLINDEX                                     03S0238 00932000
         SLA   @07,2                                            03S0238 00933000
         L     @07,PSLSTENT-4(@07,@15)                          03S0238 00934000
         ST    @07,UCBPTR                                       03S0238 00935000
*/********************************************************************/ 00936000
*/*                                                                  */ 00937000
*/* SEGMENT NAME - PSFNDEDL                                          */ 00938000
*/*                                                                  */ 00939000
*/* DESCRIPTIVE NAME - FIND EDL ENTRY                                */ 00940000
*/*                                                                  */ 00941000
*/* FUNCTION -                                                       */ 00942000
*/*   THIS ROUTINE FINDS THE EDL ENTRY WHICH CONTAINS A PTR TO THE   */ 00943000
*/*   OPTIMUM DEVICE UCB. WHEN THE EDL ENTRY IS FOUND,THE GROUP ID OF*/ 00944000
*/*   THE OPTIMUM DEVICE IS SAVED SO THAT PSALLOC MAY PASS THE ID    */ 00945000
*/*   TO THE ALLOCATE REQUEST ROUTINE. THE POINTER TO THE EDL UCB    */ 00946000
*/*   LIST AND THE INDEX INTO THE LIST ARE USED LATER BY PSALLOC     */ 00947000
*/*   TO SET BITS IN THE EDL. THE POINTER TO THE EDL IS USED BY      */ 00948000
*/*   PSLSTBLD WHEN THE PSLIST IS UPDATED TO CONTAIN ENTRIES FOR     */ 00949000
*/*   ONLY ONE GENERIC DEVICE TYPE                                   */ 00950000
*/*                                                                  */ 00951000
*/* ENTRY - PSFNDEDL (INCLUDED SEGMENT IN PSALLOC)                   */ 00952000
*/*                                                                  */ 00953000
*/*   PURPOSE - TO FIND THE EDL ENTRY WHICH CONTAINS A PTR TO THE UCB*/ 00954000
*/*     SELECTED FOR ALLOCATION BY THE SYSTEM RESOURCES MANAGER      */ 00955000
*/*                                                                  */ 00956000
*/*   INPUT -                                                        */ 00957000
*/*     PTR TO UCB SELECTED FOR ALLOCATION                           */ 00958000
*/*     PTR TO EDL                                                   */ 00959000
*/*                                                                  */ 00960000
*/* EXIT -                                                           */ 00961000
*/*                                                                  */ 00962000
*/*   CONDITION - EDL ENTRY FOR SELECTED DEVICE FOUND                */ 00963000
*/*                                                                  */ 00964000
*/*   OUTPUT -                                                       */ 00965000
*/*     GROUP ID OF SELECTED DEVICE                                  */ 00966000
*/*     PTR TO UCB LIST  IN EDL  CONTAINING UCB ADDR OF SELECTED DEV */ 00967000
*/*     INDEX INTO UCB LIST FOR SELECTED DEVICE ADDR                 */ 00968000
*/*     PTR TO GENERIC EDL ENTRY FOR SELECTED DEVICE                 */ 00969000
*/*                                                                  */ 00970000
*/*   RETURN CODE - 0                                                */ 00971000
*/*                                                                  */ 00972000
*/********************************************************************/ 00973000
*EDLPTR=EDLFGENP;                      /*PT TO 1ST EDL GENERIC ENTRY */ 00974000
         L     @07,SIOTPTR                                      04S0239 00975000
         L     @07,SIOTEDLP(,@07)                               04S0239 00976000
         L     EDLPTR,EDLFGENP(,@07)                            04S0239 00977000
*UCBMATCH=OFF;                         /*INIT LOOP CONTROL SWITCH    */ 00978000
         NI    UCBMATCH,B'01111111'                             04S0240 00979000
*DO WHILE(UCBMATCH=OFF & EDLPTR^=ZERO);                         04S0241 00980000
         B     @DE00241                                         04S0241 00981000
@DL00241 DS    0H                                               04S0242 00982000
*  EDLGNTP=EDLGRPTR;                   /*POINT TO EDL GROUP ENTRY    */ 00983000
         L     EDLGNTP,EDLGRPTR(,EDLPTR)                        04S0242 00984000
*  DO EDLINDX1=1 TO EDLGRPNO WHILE(UCBMATCH=OFF); /*SEARCH GROUP ENTS*/ 00985000
         LA    EDLINDX1,1                                       04S0243 00986000
         B     @DE00243                                         04S0243 00987000
@DL00243 TM    UCBMATCH,B'10000000'                             04S0243 00988000
         BNZ   @DC00243                                         04S0243 00989000
*    EDLUCBLP=EDLLISTP;                /*POINT TO UCB LIST FOR GROUP */ 00990000
         MVC   EDLUCBLP(4),EDLLISTP(EDLGNTP)                    04S0244 00991000
*    DO EDLINDEX=1 TO EDLUCBNO WHILE(UCBMATCH=OFF); /*SEARCH UCB LIST*/ 00992000
         LA    @02,1                                            04S0245 00993000
         B     @DE00245                                         04S0245 00994000
@DL00245 TM    UCBMATCH,B'10000000'                             04S0245 00995000
         BNZ   @DC00245                                         04S0245 00996000
*      IF UCBPTR=EDLUCBAD(EDLINDEX) THEN /*MATCH?                    */ 00997000
         SLA   @02,2                                            04S0246 00998000
         L     @01,EDLUCBLP                                     04S0246 00999000
         ALR   @01,@02                                          04S0246 01000000
         AL    @01,@CF01109                                     04S0246 01001000
         SLR   @02,@02                                          04S0246 01002000
         ICM   @02,3,EDLUCBAD(@01)                              04S0246 01003000
         C     @02,UCBPTR                                       04S0246 01004000
         BNE   @RF00246                                         04S0246 01005000
*        DO;                                                    04S0247 01006000
*          ARUGRPID=EDLGRID;           /*SAVE GROUP ID OF UCB        */ 01007000
         MVC   ARUGRPID(4),EDLGRID(EDLGNTP)                     04S0248 01008000
*          UCBMATCH=ON;                /*INDICATE MATCH FOUND        */ 01009000
         OI    UCBMATCH,B'10000000'                             04S0249 01010000
*        END;                                                   04S0250 01011000
*    END;                                                       04S0251 01012000
@RF00246 LA    @02,1                                            04S0251 01013000
         AL    @02,EDLINDEX                                     04S0251 01014000
@DE00245 ST    @02,EDLINDEX                                     04S0251 01015000
         C     @02,EDLUCBNO(,EDLGNTP)                           04S0251 01016000
         BNH   @DL00245                                         04S0251 01017000
@DC00245 DS    0H                                               04S0252 01018000
*    IF UCBMATCH=OFF THEN              /*MATCH FOUND?                */ 01019000
         TM    UCBMATCH,B'10000000'                             04S0252 01020000
         BNZ   @RF00252                                         04S0252 01021000
*      EDLGNTP=EDLNXGRP;               /*NO,POINT TO NEXT GROUP      */ 01022000
         L     EDLGNTP,EDLNXGRP(,EDLGNTP)                       04S0253 01023000
*  END;                                                         04S0254 01024000
@RF00252 AL    EDLINDX1,@CF00056                                04S0254 01025000
@DE00243 C     EDLINDX1,EDLGRPNO(,EDLPTR)                       04S0254 01026000
         BNH   @DL00243                                         04S0254 01027000
@DC00243 DS    0H                                               04S0255 01028000
*  IF UCBMATCH=OFF THEN                /*MATCH FOUND?                */ 01029000
         TM    UCBMATCH,B'10000000'                             04S0255 01030000
         BNZ   @RF00255                                         04S0255 01031000
*    EDLPTR=EDLNXTNT;                  /*NO,POINT TO NEXT EDL        */ 01032000
         L     EDLPTR,EDLNXTNT(,EDLPTR)                         04S0256 01033000
*END;                                                           04S0257 01034000
@RF00255 DS    0H                                               04S0257 01035000
@DE00241 TM    UCBMATCH,B'10000000'                             04S0257 01036000
         BNZ   @DC00241                                         04S0257 01037000
         LTR   EDLPTR,EDLPTR                                    04S0257 01038000
         BNZ   @DL00241                                         04S0257 01039000
@DC00241 DS    0H                                               04S0258 01040000
*EDLINDEX = EDLINDEX-1;                /*RESET CORRECT EDL INDEX     */ 01041000
         L     @07,EDLINDEX                                     04S0258 01042000
         BCTR  @07,0                                            04S0258 01043000
         ST    @07,EDLINDEX                                     04S0258 01044000
*    IF RETCODE=NOERROR THEN           /*UCB ADDR FOUND IN EDL?      */ 01045000
         SLR   @07,@07                                          03S0259 01046000
         C     @07,RETCODE                                      03S0259 01047000
         BNE   @RF00259                                         03S0259 01048000
*      DO;                             /*YES:                        */ 01049000
*        ARURLPOS=RELDEVNO;            /*SET RELATIVE ETIOT POSITION */ 01050000
         STH   RELDEVNO,ARURLPOS                                03S0261 01051000
*        UCBPARMP=ADDR(UCBPARMS);      /*POINT TO UCB PARM FIELD     */ 01052000
         LA    @15,UCBPARMS                                     03S0262 01053000
         ST    @15,UCBPARMP                                     03S0262 01054000
*        IF SIOTETIO^=ZERO THEN        /*ETIOT EXIST?                */ 01055000
         L     @01,SIOTPTR                                      03S0263 01056000
         C     @07,SIOTETIO(,@01)                               03S0263 01057000
         BE    @RF00263                                         03S0263 01058000
*          ARUETUPD=ON;                /*YES,INDICATE TO UPDATE IT   */ 01059000
         OI    ARUETUPD,B'10000000'                             03S0264 01060000
*        ELSE                          /*ETIOT DOES NOT EXIST        */ 01061000
*          DO;                                                  03S0265 01062000
         B     @RC00263                                         03S0265 01063000
@RF00263 DS    0H                                               03S0266 01064000
*            ARUETUPD=OFF;             /*INDICATE TO BUILD ETIOT     */ 01065000
         NI    ARUETUPD,B'01111111'                             03S0266 01066000
*            ARUNDEVS=SIOTOTUN;        /*SET NUMBER ETIOT DEV ENTRIES*/ 01067000
         L     @07,SIOTPTR                                      03S0267 01068000
         SLR   @15,@15                                          03S0267 01069000
         IC    @15,SIOTOTUN(,@07)                               03S0267 01070000
         STH   @15,ARUNDEVS                                     03S0267 01071000
*          END;                                                 03S0268 01072000
*        IF UCB3TAPE = ON THEN         /*MUST ENQ EXCL               */ 01073000
@RC00263 L     @07,UCBPTR                                       03S0269 01074000
         TM    UCB3TAPE(@07),B'10000000'                        03S0269 01075000
         BNO   @RF00269                                         03S0269 01076000
*          DO;                                                  03S0270 01077000
*            VOLUMENQ = ON;                                     03S0271 01078000
*            VOLEXCLU = ON;                                     03S0272 01079000
         OI    VOLUMENQ,B'10100000'                             03S0272 01080000
*          END;                                                 03S0273 01081000
*        ELSE;                                                  03S0274 01082000
@RF00269 DS    0H                                               03S0275 01083000
*        IF UCB3DACC=ON &                                       03S0275 01084000
*           UCBPRES=OFF &                                       03S0275 01085000
*           UCBRESV=OFF THEN           /*REMOVEABLE DA               */ 01086000
         L     @07,UCBPTR                                       03S0275 01087000
         TM    UCB3DACC(@07),B'00100000'                        03S0275 01088000
         BNO   @RF00275                                         03S0275 01089000
         TM    UCBPRES(@07),B'00100100'                         03S0275 01090000
         BNZ   @RF00275                                         03S0275 01091000
*          DO;                                                  03S0276 01092000
*            VOLUMENQ=ON;              /*INDICATE ENQ                */ 01093000
*            VOLEXCLU = OFF;                                    03S0278 01094000
         OI    VOLUMENQ,B'10000000'                             03S0278 01095000
         NI    VOLEXCLU,B'11011111'                             03S0278 01096000
*          END;                                                 03S0279 01097000
*        IF VOLUMENQ = ON THEN                                  03S0280 01098000
@RF00275 TM    VOLUMENQ,B'10000000'                             03S0280 01099000
         BNO   @RF00280                                         03S0280 01100000
*          DO;                                                  03S0281 01101000
*            VOLSERP=ADDR(UCBVOLI);    /*VOLSER POINTER              */ 01102000
         L     @07,UCBPTR                                       03S0282 01103000
         LA    @07,UCBVOLI(,@07)                                03S0282 01104000
         ST    @07,VOLSERP                                      03S0282 01105000
*            TCBADD=JSCBPTR->JSCBTCBP; /*TCB POINTER                 */ 01106000
         L     @07,@PC00001                                     03S0283 01107000
         L     @07,ALCWAPTR(,@07)                               03S0283 01108000
         L     @03,JSCBPTR(,@07)                                03S0283 01109000
         MVC   TCBADD(4),JSCBTCBP(@03)                          03S0283 01110000
*            CALL IEFAB4F0(F0MAP,VOLSERP,TCBADD,VOLUNPTR,VOLUNSZE);     01111000
         LA    @03,F0MAP                                        03S0284 01112000
         ST    @03,@AL00001                                     03S0284 01113000
         LA    @03,VOLSERP                                      03S0284 01114000
         ST    @03,@AL00001+4                                   03S0284 01115000
         LA    @03,TCBADD                                       03S0284 01116000
         ST    @03,@AL00001+8                                   03S0284 01117000
         LA    @03,VOLUNPTR(,@07)                               03S0284 01118000
         ST    @03,@AL00001+12                                  03S0284 01119000
         LA    @07,VOLUNSZE(,@07)                               03S0284 01120000
         ST    @07,@AL00001+16                                  03S0284 01121000
         L     @15,@CV00963                                     03S0284 01122000
         LA    @01,@AL00001                                     03S0284 01123000
         BALR  @14,@15                                          03S0284 01124000
*            ERETCODE = REG15;                                  03S0285 01125000
         LR    ERETCODE,REG15                                   03S0285 01126000
*            IF ERETCODE^=ZERO THEN    /*VOL ENQ FAILED              */ 01127000
         LTR   ERETCODE,ERETCODE                                03S0286 01128000
         BZ    @RF00286                                         03S0286 01129000
*              IF ERETCODE = JOBOWNS THEN /*ALREADY ENQ'D            */ 01130000
         CH    ERETCODE,@CH00058                                03S0287 01131000
         BNE   @RF00287                                         03S0287 01132000
*                VOLUMENQ = OFF;       /*CANCEL DEQ ACTION           */ 01133000
         NI    VOLUMENQ,B'01111111'                             03S0288 01134000
*              ELSE                                             03S0289 01135000
*                DO;                                            03S0289 01136000
         B     @RC00287                                         03S0289 01137000
@RF00287 DS    0H                                               03S0290 01138000
*                  ENQERROR=ON;        /*VOL ENQ ERROR               */ 01139000
         OI    ENQERROR,B'01000000'                             03S0290 01140000
*                  EDLENQ(EDLINDEX)=ON;/*ENQ ERROR IN EDL            */ 01141000
         L     @07,EDLINDEX                                     03S0291 01142000
         SLA   @07,2                                            03S0291 01143000
         L     @01,EDLUCBLP                                     03S0291 01144000
         ALR   @01,@07                                          03S0291 01145000
         BCTR  @01,0                                            03S0291 01146000
         BCTR  @01,0                                            03S0291 01147000
         OI    EDLENQ-2(@01),B'00100000'                        03S0291 01148000
*                END;                                           03S0292 01149000
*            ELSE;                     /*ENQ OK                      */ 01150000
@RF00286 DS    0H                                               03S0294 01151000
*            END;                                               03S0294 01152000
*          ELSE;                       /*NON DA P/R RESVD            */ 01153000
@RF00280 DS    0H                                               03S0296 01154000
*            IF ENQERROR = OFF THEN    /*CONTINUE PROCESS            */ 01155000
@RC00280 TM    ENQERROR,B'01000000'                             03S0296 01156000
         BNZ   @RF00296                                         03S0296 01157000
*              DO;                                              03S0297 01158000
*                IF UCB3DACC=ON THEN   /*DA                          */ 01159000
         L     @07,UCBPTR                                       03S0298 01160000
         TM    UCB3DACC(@07),B'00100000'                        03S0298 01161000
         BNO   @RF00298                                         03S0298 01162000
*                  ARUUSECT=ON;        /*UPDATE USE COUNT            */ 01163000
         OI    ARUUSECT,B'01000000'                             03S0299 01164000
*                ELSE;                 /*TAPE                        */ 01165000
@RF00298 DS    0H                                               03S0301 01166000
*                ARUVLCHK = OFF;       /*NO VALIDITY CHECK           */ 01167000
         NI    ARUVLCHK,B'11101111'                             03S0301 01168000
*                IF MOUNTED=ON THEN                             03S0302 01169000
         L     @07,@PC00001+8                                   03S0302 01170000
         L     @07,PSPARMP(,@07)                                03S0302 01171000
         TM    MOUNTED(@07),B'00001000'                         03S0302 01172000
         BNO   @RF00302                                         03S0302 01173000
*                  ARUUPDAL=ON;        /*UPDATE ALG TABLES           */ 01174000
         OI    ARUUPDAL,B'00000100'                             03S0303 01175000
*                IF UCBPRES=OFF &                               03S0304 01176000
*                   UCBRESV=OFF THEN   /*REMOVEABLE VOL              */ 01177000
@RF00302 L     @07,UCBPTR                                       03S0304 01178000
         TM    UCBPRES(@07),B'00100100'                         03S0304 01179000
         BNZ   @RF00304                                         03S0304 01180000
*                  ARUUSEST=ON;        /*UPDATE USE ATTRIBUTE        */ 01181000
         OI    ARUUSEST,B'00001000'                             03S0305 01182000
*                ARUAFF=ON;            /*PROCESS AFFINITY            */ 01183000
@RF00304 OI    ARUAFF,B'00100000'                               03S0306 01184000
*                VOLUMEID = UCBVOLI;   /*VOLSER TO IEFAB435 PARM LIST*/ 01185000
         L     @07,UCBPTR                                       03S0307 01186000
         MVC   VOLUMEID(6),UCBVOLI(@07)                         03S0307 01187000
*                IF UCB3TAPE=ON & UCBRESV=ON THEN /*RESV'D TAPE      */ 01188000
         TM    UCB3TAPE(@07),B'10000000'                        03S0308 01189000
         BNO   @RF00308                                         03S0308 01190000
         TM    UCBRESV(@07),B'00100000'                         03S0308 01191000
         BNO   @RF00308                                         03S0308 01192000
*                  DO;                                          03S0309 01193000
*                    CALL IEFAB442(FUNC442,ALCWAPTR,VOLID,VOLUNTID);    01194000
         LA    @07,@CB00943                                     03S0310 01195000
         ST    @07,@AL00001                                     03S0310 01196000
         L     @07,@PC00001                                     03S0310 01197000
         ST    @07,@AL00001+4                                   03S0310 01198000
         L     @07,VUPTR                                        03S0310 01199000
         ST    @07,@AL00001+8                                   03S0310 01200000
         LA    @07,VOLUNTID(,@07)                               03S0310 01201000
         ST    @07,@AL00001+12                                  03S0310 01202000
         L     @15,@CV00965                                     03S0310 01203000
         LA    @01,@AL00001                                     03S0310 01204000
         BALR  @14,@15                                          03S0310 01205000
*                    RETCODE = REG15;  /*SAVE THE RETURN CODE        */ 01206000
         ST    REG15,RETCODE                                    03S0311 01207000
*                  END;                                         03S0312 01208000
*              ELSE;                   /*NOT A RESERVED TAPE         */ 01209000
@RF00308 DS    0H                                               03S0314 01210000
*            IF RETCODE = NOERROR THEN /*ANY ERRORS                  */ 01211000
         ICM   @07,15,RETCODE                                   03S0314 01212000
         BNZ   @RF00314                                         03S0314 01213000
*              DO;                                              03S0315 01214000
*                CALL IEFAB434 (SIOTPTR,VUPTR,UCBPTR,ARUINDIC,ARUWORD,  01215000
*                 ALCWAPTR,ARUGRPID,UCBPARMP);/*TRY TO ALLOC UNIT    */ 01216000
         LA    @07,SIOTPTR                                      03S0316 01217000
         ST    @07,@AL00001                                     03S0316 01218000
         LA    @07,VUPTR                                        03S0316 01219000
         ST    @07,@AL00001+4                                   03S0316 01220000
         LA    @07,UCBPTR                                       03S0316 01221000
         ST    @07,@AL00001+8                                   03S0316 01222000
         LA    @07,ARUINDIC                                     03S0316 01223000
         ST    @07,@AL00001+12                                  03S0316 01224000
         LA    @07,ARUWORD                                      03S0316 01225000
         ST    @07,@AL00001+16                                  03S0316 01226000
         L     @07,@PC00001                                     03S0316 01227000
         ST    @07,@AL00001+20                                  03S0316 01228000
         LA    @07,ARUGRPID                                     03S0316 01229000
         ST    @07,@AL00001+24                                  03S0316 01230000
         LA    @07,UCBPARMP                                     03S0316 01231000
         ST    @07,@AL00001+28                                  03S0316 01232000
         L     @15,@CV00967                                     03S0316 01233000
         LA    @01,@AL00001                                     03S0316 01234000
         BALR  @14,@15                                          03S0316 01235000
*                RFY REG15 RSTD;                                03S0317 01236000
*                IF REG15=NOERROR      /*ALLOCATION SUCCESSFUL?      */ 01237000
*                  | REG15=RET32                                03S0318 01238000
*                    | REG15=RET36 | REG15=RET40 THEN /*     @ZA04112*/ 01239000
         LTR   REG15,REG15                                      03S0318 01240000
         BZ    @RT00318                                         03S0318 01241000
         CH    REG15,@CH00955                                   03S0318 01242000
         BE    @RT00318                                         03S0318 01243000
         CH    REG15,@CH00994                                   03S0318 01244000
         BE    @RT00318                                         03S0318 01245000
         CH    REG15,@CH00996                                   03S0318 01246000
         BNE   @RF00318                                         03S0318 01247000
@RT00318 DS    0H                                               03S0319 01248000
*                      DO;                                      03S0319 01249000
*                        IF FIRSTALC=OFF THEN /*FIRST UNIT ALLOC'D   */ 01250000
         TM    FIRSTALC,B'10000000'                             03S0320 01251000
         BNZ   @RF00320                                         03S0320 01252000
*                          EDLFINIS=ON; /*YES, EDL UPDATE NEEDED     */ 01253000
         OI    EDLFINIS,B'10000000'                             03S0321 01254000
*                        ELSE;                                  03S0322 01255000
@RF00320 DS    0H                                               03S0323 01256000
*                          FIRSTALC = ON; /*ONE UNIT ALLOC'D         */ 01257000
         OI    FIRSTALC,B'10000000'                             03S0323 01258000
*                        VOLALOC=ON;   /*YES,MARK VOLUNIT ENT ALLOC'D*/ 01259000
         L     @14,VUPTR                                        03S0324 01260000
         OI    VOLALOC(@14),B'10000000'                         03S0324 01261000
*                        IF REG15=RET32 THEN/*AFFINITY DADSM ERROR ? */ 01262000
         CH    REG15,@CH00955                                   03S0325 01263000
         BNE   @RF00325                                         03S0325 01264000
*                          DO;                                  03S0326 01265000
*                            EDLVOLAF(EDLINDEX)=ON;/*YES,IND. IN EDL */ 01266000
         L     @14,EDLINDEX                                     03S0327 01267000
         SLA   @14,2                                            03S0327 01268000
         L     @07,EDLUCBLP                                     03S0327 01269000
         ALR   @07,@14                                          03S0327 01270000
         BCTR  @07,0                                            03S0327 01271000
         BCTR  @07,0                                            03S0327 01272000
         OI    EDLVOLAF-2(@07),B'00010000'                      03S0327 01273000
*                            SIOTNOPR = ON;/*SIOT NOT ALL PROCESSED  */ 01274000
         OI    SIOTNOPR,B'00000100'                             03S0328 01275000
*                          END;                                 03S0329 01276000
*                        ELSE;         /*NOT AFFINITY DADSM ERROR    */ 01277000
@RF00325 DS    0H                                               03S0331 01278000
*                        EDLALCD(EDLINDEX)=ON; /*EDL UCB ENT IS ALLOC*/ 01279000
         L     @14,EDLINDEX                                     03S0331 01280000
         SLA   @14,2                                            03S0331 01281000
         L     @07,EDLUCBLP                                     03S0331 01282000
         ALR   @07,@14                                          03S0331 01283000
         BCTR  @07,0                                            03S0331 01284000
         BCTR  @07,0                                            03S0331 01285000
         OI    EDLALCD-2(@07),B'10000000'                       03S0331 01286000
*                        PSCNTENT=PSCNTENT-1;  /*DECREMENT CNTTAB ENT*/ 01287000
         L     @14,COUNTABP                                     03S0332 01288000
         L     @07,PSCNTENT(,@14)                               03S0332 01289000
         BCTR  @07,0                                            03S0332 01290000
         ST    @07,PSCNTENT(,@14)                               03S0332 01291000
*                        TOTVOLUN=TOTVOLUN-1;  /*DECREMENT TOTAL     */ 01292000
         L     @14,@PC00001                                     03S0333 01293000
         L     @14,ALCWAPTR(,@14)                               03S0333 01294000
         L     @07,TOTVOLUN(,@14)                               03S0333 01295000
         BCTR  @07,0                                            03S0333 01296000
         ST    @07,TOTVOLUN(,@14)                               03S0333 01297000
*                                              /*COUNTAB ENTRY       */ 01298000
*                        IF REG15=RET36 THEN   /*RETURN CODE 36?     */ 01299000
         LA    @14,36                                           03S0334 01300000
         CR    REG15,@14                                        03S0334 01301000
         BNE   @RF00334                                         03S0334 01302000
*                          DO;                                  03S0335 01303000
*                            RETCODE=RET36;    /*YES,SET RETURN CODE */ 01304000
         ST    @14,RETCODE                                      03S0336 01305000
*                            IF NUMVOLUN^=SVOLUNNO THEN /*LAST VU    */ 01306000
         L     @14,SIOTPTR                                      03S0337 01307000
         CH    NUMVOLUN,SVOLUNNO(,@14)                          03S0337 01308000
         BE    @RF00337                                         03S0337 01309000
*                                                       /*FOR SIOT?  */ 01310000
*                              SIOTNOPR=ON;  /*SIOT NOT ALL PROCESSED*/ 01311000
         OI    SIOTNOPR,B'00000100'                             03S0338 01312000
*                          END;                                 03S0339 01313000
*                        ELSE;                                  03S0340 01314000
@RF00334 DS    0H                                               03S0341 01315000
*                      END;                                     03S0341 01316000
*                ELSE                  /*ALLOCATION NOT SUCCESSFUL   */ 01317000
*                  DO;                                          03S0342 01318000
         B     @RC00318                                         03S0342 01319000
@RF00318 DS    0H                                               03S0343 01320000
*                    IF REG15=DADSMERR THEN /*RECOVERABLE DADSM ERR  */ 01321000
         CH    REG15,@CH00986                                   03S0343 01322000
         BNE   @RF00343                                         03S0343 01323000
*                      DO;                                      03S0344 01324000
*                        EDLDADSM(EDLINDEX)=ON;  /*YES,INDICATE IT   */ 01325000
         L     @14,EDLINDEX                                     03S0345 01326000
         SLA   @14,2                                            03S0345 01327000
         L     @07,EDLUCBLP                                     03S0345 01328000
         ALR   @07,@14                                          03S0345 01329000
         BCTR  @07,0                                            03S0345 01330000
         BCTR  @07,0                                            03S0345 01331000
         OI    EDLDADSM-2(@07),B'01000000'                      03S0345 01332000
*                                                /*EDL ENTRY         */ 01333000
*                        DADSMESW=ON;            /*INDICATE ERROR TO */ 01334000
         OI    DADSMESW,B'00001000'                             03S0346 01335000
*                                                /*LIST BUILD        */ 01336000
*                      END;                                     03S0347 01337000
*                    ELSE              /*NON-RECOVERABLE DADSM ERROR */ 01338000
*                      DO;                                      03S0348 01339000
         B     @RC00343                                         03S0348 01340000
@RF00343 DS    0H                                               03S0349 01341000
*                        SIOTNOPR = ON; /*SIOT NOT FULLY ALOC'D      */ 01342000
         OI    SIOTNOPR,B'00000100'                             03S0349 01343000
*                        RETCODE=REG15; /*SET ERROR CODE             */ 01344000
         ST    REG15,RETCODE                                    03S0350 01345000
*                      END;                                     03S0351 01346000
*                    RFY REG15 UNRSTD;                          03S0352 01347000
@RC00343 DS    0H                                               03S0353 01348000
*                    IF VOLUMENQ=ON THEN    /*MUST DO DEQ           */  01349000
         TM    VOLUMENQ,B'10000000'                             03S0353 01350000
         BNO   @RF00353                                         03S0353 01351000
*                      DO;                                      03S0354 01352000
*                        VOLUMENQ=OFF;                          03S0355 01353000
*                        VOLUMEDQ=ON;                           03S0356 01354000
         OI    VOLUMEDQ,B'01000000'                             03S0356 01355000
         NI    VOLUMENQ,B'01111111'                             03S0356 01356000
*                        CALL IEFAB4F0(F0MAP,VOLSERP,TCBADD,VOLUNPTR,   01357000
*                                      VOLUNSZE);               03S0357 01358000
         LA    @07,F0MAP                                        03S0357 01359000
         ST    @07,@AL00001                                     03S0357 01360000
         LA    @07,VOLSERP                                      03S0357 01361000
         ST    @07,@AL00001+4                                   03S0357 01362000
         LA    @07,TCBADD                                       03S0357 01363000
         ST    @07,@AL00001+8                                   03S0357 01364000
         L     @07,@PC00001                                     03S0357 01365000
         L     @07,ALCWAPTR(,@07)                               03S0357 01366000
         LA    @15,VOLUNPTR(,@07)                               03S0357 01367000
         ST    @15,@AL00001+12                                  03S0357 01368000
         LA    @07,VOLUNSZE(,@07)                               03S0357 01369000
         ST    @07,@AL00001+16                                  03S0357 01370000
         L     @15,@CV00963                                     03S0357 01371000
         LA    @01,@AL00001                                     03S0357 01372000
         BALR  @14,@15                                          03S0357 01373000
*                      END;                                     03S0358 01374000
*                  END;                                         03S0359 01375000
*                END;                                           03S0360 01376000
*              ELSE;                   /*ERROR REMOVING UNIT AFFS    */ 01377000
@RF00314 DS    0H                                               03S0362 01378000
*          END;                                                 03S0362 01379000
*      END;                                                     03S0363 01380000
*  END;                                                         03S0364 01381000
*ELSE                                  /*OPTIMUM DEVICE NOT SELECTED */ 01382000
*  DO;                                                          03S0365 01383000
         B     @RC00235                                         03S0365 01384000
@RF00235 DS    0H                                               03S0366 01385000
*    RETCODE=ERROR;                    /*SET RETURN CODE             */ 01386000
         MVC   RETCODE(4),@CF00160                              03S0366 01387000
*    FAILRSC=OPDEVERR;                 /*SET REASON CODE             */ 01388000
         L     @07,@PC00001                                     03S0367 01389000
         L     @07,ALCWAPTR(,@07)                               03S0367 01390000
         L     @07,FAILRSCP(,@07)                               03S0367 01391000
         MVC   FAILRSC(2,@07),@CH00991                          03S0367 01392000
*  END;                                                         03S0368 01393000
*IF DADSMESW=OFF &                     /*DADSM ERROR?                */ 01394000
*  ENQERROR=OFF THEN                                            03S0369 01395000
@RC00235 TM    DADSMESW,B'01001000'                             03S0369 01396000
         BNZ   @RF00369                                         03S0369 01397000
*  DO;                                 /*NO,FREE ALLOC'D UCB LST CORE*/ 01398000
*    RFY (REG0,REG1)RSTD;                                       03S0371 01399000
*    REG0=ALCULEN;                     /*LENGTH OF ALCUCBLT          */ 01400000
         L     REG0,ALCULEN                                     03S0372 01401000
*    REG0 = REG0 | TOO53;              /*SET SP253                   */ 01402000
         O     REG0,@CF00956                                    03S0373 01403000
*    REG1=ALCUCBP;                     /*POINTER TO ALCUCBLT         */ 01404000
         L     REG1,ALCUCBP(,OPTPARMP)                          03S0374 01405000
*    GEN( FREEMAIN R,LV=(0),A=(1) );   /*FREE ALLOCATED UCB LIST CORE*/ 01406000
          FREEMAIN R,LV=(0),A=(1)                                       01407000
*    RFY (REG0,REG1) UNRSTD;                                    03S0376 01408000
*  END;                                                         03S0377 01409000
*ELSE                                  /*DADSM ERROR OCCURRED        */ 01410000
*  REUSESW=ON;                         /*INDICATE TO REUSE ALCUCBLT  */ 01411000
         B     @RC00369                                         03S0378 01412000
@RF00369 OI    REUSESW,B'00000001'                              03S0378 01413000
*        END;                                                   02S0379 01414000
*      ELSE                            /*NO:                         */ 01415000
*        DO;                                                    02S0380 01416000
         B     @RC00214                                         02S0380 01417000
@RF00214 DS    0H                                               02S0381 01418000
*          VOLUNOPR=ON;                /*INDICATE VOLUNIT NOT PROCESS*/ 01419000
*          SIOTNOPR=ON;                /*SIOT NOT COMPLETELY PROCESS */ 01420000
         OI    VOLUNOPR,B'00000110'                             02S0382 01421000
*        END;                                                   02S0383 01422000
*    END;                                                       02S0384 01423000
*  ELSE                                /*NO,PSLIST IS EMPTY          */ 01424000
*    DO;                                                        02S0385 01425000
         B     @RC00206                                         02S0385 01426000
@RF00206 DS    0H                                               02S0386 01427000
*      VOLUNOPR=ON;                    /*INDICATE VOLUNIT NOT PROCESS*/ 01428000
*      SIOTNOPR=ON;                    /*INDICATE SIOT NOT COMPLETELY   01429000
*                                        PROCESSED                   */ 01430000
         OI    VOLUNOPR,B'00000110'                             02S0387 01431000
*      IF DADSMESW=OFF &               /*DADSM ERROR?                */ 01432000
*         PUBVOL = OFF THEN            /*STORAGE VOLUME ?            */ 01433000
         TM    DADSMESW,B'00001000'                             02S0388 01434000
         BNZ   @RF00388                                         02S0388 01435000
         TM    PUBVOL,B'10000000'                               02S0388 01436000
         BNZ   @RF00388                                         02S0388 01437000
*        DO;                                                    02S0389 01438000
*/********************************************************************/ 01439000
*/*                                                                  */ 01440000
*/* SEGMENT NAME - PVTUPDTE                                          */ 01441000
*/*                                                                  */ 01442000
*/* DESCRIPTIVE NAME - UPDATE REQUEST TO PRIVATE                     */ 01443000
*/*                                                                  */ 01444000
*/* FUNCTION -                                                       */ 01445000
*/*   THIS ROUTINE WILL CHANGE A REQUEST FOR STORAGE VOLUMES TO A    */ 01446000
*/*   REQUEST FOR PRIVATE VOLUMES WHEN THERE ARE NOT ENOUGH STORAGE  */ 01447000
*/*   VOLUMES AVAILABLE TO SATISFY THE REQUEST. ALL STORAGE VOLUNIT  */ 01448000
*/*   ENTRIES REMAINING TO BE ALLOCATED ARE CHANGED TO PRIVATE AND   */ 01449000
*/*   INDICATORS SET IN THE SIOT AND IN ALCWA TO INDICATE THAT A     */ 01450000
*/*   MESSAGE MUST BE ISSUED TELLING THE CHANGE. ANY OTHER           */ 01451000
*/*   ALLOCATED VOLUNIT ENTRIES WHICH REQUIRE THE SAME VOLUME        */ 01452000
*/*   AND UNIT ARE ALSO CHANGED TO PRIVATE. THE COUNT TABLE          */ 01453000
*/*   (IN ALCWA) IS ALSO UPDATED TO REFLECT THE CHANGE.              */ 01454000
*/*                                                                  */ 01455000
*/* ENTRY -                                                          */ 01456000
*/*   PVTUPDTE - IN-LINE SEGMENT                                     */ 01457000
*/*                                                                  */ 01458000
*/*   PURPOSE - SEE FUNCTION                                         */ 01459000
*/*                                                                  */ 01460000
*/*   INPUT -                                                        */ 01461000
*/*     SIOT CURRENTLY BEING PROCESSED                               */ 01462000
*/*     VOLUNIT ENTRY CURRENTLY BEING PROCESSED                      */ 01463000
*/*     ALCWA                                                        */ 01464000
*/*       COUNT TABLE                                                */ 01465000
*/* EXITS -                                                          */ 01466000
*/*   CONDITION - FUNCTION COMPLETED                                 */ 01467000
*/*                                                                  */ 01468000
*/*     OUTPUT -                                                     */ 01469000
*/*       UPDATED VOLUNIT ENTRIES -                                  */ 01470000
*/*         STORAGE INDICATOR OFF                                    */ 01471000
*/*         PRIVATE INDICATOR ON                                     */ 01472000
*/*       UPDATED SIOT(S) -                                          */ 01473000
*/*         INDICATOR TO ISSUE MSG FOR DD                            */ 01474000
*/*       UPDATED ALCWA -                                            */ 01475000
*/*         INDICATOR THAT AT LEAST ONE SIOT NEEDS 'PRIVATE ASSUMED' */ 01476000
*/*         MESSAGE.                                                 */ 01477000
*/*         UPDATED COUNT TABLE -                                    */ 01478000
*/*           STORAGE COUNT DECREASED                                */ 01479000
*/*           NON-SPECIFIC PRIVATE COUNT INCREASED                   */ 01480000
*/*                                                                  */ 01481000
*/*     RETURN CODES - NONE                                          */ 01482000
*/********************************************************************/ 01483000
*VUSAVE = VUPTR;                       /*SAVE PTR TO CURRENT ENTRY   */ 01484000
         L     VUSAVE,VUPTR                                     03S0390 01485000
*VUPTR = SVOLUNAD;                     /*POINT TO FIRST ENTRY OF        01486000
*                                        REQUEST                     */ 01487000
         L     @07,SIOTPTR                                      03S0391 01488000
         MVC   VUPTR(4),SVOLUNAD(@07)                           03S0391 01489000
*DO VUCTR = ONE TO SVOLUNNO;           /*PROCESS ALL ENTRIES         */ 01490000
         LA    VUCTR,1                                          03S0392 01491000
         B     @DE00392                                         03S0392 01492000
@DL00392 DS    0H                                               03S0393 01493000
*  IF VOLALOC = OFF                    /*CHANGE ENTRY IF NOT ALOC'D..*/ 01494000
*      & VDEVREQD = ON                 /*.. REQUIRES A DEV ENTRY ... */ 01495000
*      & VOLSTG = ON THEN              /*.. AND NEEDS STORAGE VOLUME */ 01496000
         L     @07,VUPTR                                        03S0393 01497000
         TM    VDEVREQD(@07),B'00100000'                        03S0393 01498000
         BNO   @RF00393                                         03S0393 01499000
         TM    VOLALOC(@07),B'10000000'                         03S0393 01500000
         BNZ   @RF00393                                         03S0393 01501000
         TM    VOLSTG(@07),B'00010000'                          03S0393 01502000
         BNO   @RF00393                                         03S0393 01503000
*    DO;                               /*ADJUST ENTRY,SIOT, & ALCWA  */ 01504000
*      VOLSTG = OFF;                   /*TURN OFF STRG INDICATOR     */ 01505000
*      VOLPRV = ON;                    /*MAKE ENTRY REQ PRIVATE VOL  */ 01506000
         OI    VOLPRV(@07),B'01000000'                          03S0396 01507000
         NI    VOLSTG(@07),B'11101111'                          03S0396 01508000
*      SPVTAMSG = ON;                  /*INDIC MSG FOR STEP IN SIOT  */ 01509000
         L     @07,SIOTPTR                                      03S0397 01510000
         OI    SPVTAMSG(@07),B'00010000'                        03S0397 01511000
*      PRIVASUM = ON;                  /*INDIC MSG FOR STEP IN ALCWA */ 01512000
         L     @07,@PC00001                                     03S0398 01513000
         L     @07,ALCWAPTR(,@07)                               03S0398 01514000
         OI    PRIVASUM(@07),B'00010000'                        03S0398 01515000
*      STRGREQS = STRGREQS - ONE;      /*DECREASE STORAGE COUNT      */ 01516000
         L     @03,STRGREQS(,@07)                               03S0399 01517000
         BCTR  @03,0                                            03S0399 01518000
         ST    @03,STRGREQS(,@07)                               03S0399 01519000
*      PVTNREQS = PVTNREQS + ONE;      /*INCREASE NON-SPEC PRIVATE      01520000
*                                        COUNT                       */ 01521000
         LA    @03,1                                            03S0400 01522000
         L     @15,PVTNREQS(,@07)                               03S0400 01523000
         ALR   @15,@03                                          03S0400 01524000
         ST    @15,PVTNREQS(,@07)                               03S0400 01525000
*      TVUPTR = VOLUNPTR;              /*PT. TO BEGINNING OF VU TABLE*/ 01526000
         L     TVUPTR,VOLUNPTR(,@07)                            03S0401 01527000
*      DO VUCTR1 = ONE TO VOLUNSZE/VOLENTLN; /*SCAN ALL ENTRIES      */ 01528000
         LA    @07,1                                            03S0402 01529000
         LR    VUCTR1,@07                                       03S0402 01530000
         B     @DE00402                                         03S0402 01531000
@DL00402 DS    0H                                               03S0403 01532000
*        IF TVUPTR ^= VUPTR            /*DON'T PROCESS CURRENT ENTRY */ 01533000
*            & TVUPTR -> VOLID = VOLID THEN /*SAME VOLID'S?          */ 01534000
         L     @07,VUPTR                                        03S0403 01535000
         CR    TVUPTR,@07                                       03S0403 01536000
         BE    @RF00403                                         03S0403 01537000
         CLC   VOLID(6,TVUPTR),VOLID(@07)                       03S0403 01538000
         BNE   @RF00403                                         03S0403 01539000
*          IF TVUPTR -> VOLALOC = OFF  /*YES,ENTRY ALREADY ALLOCATED?*/ 01540000
*              & TVUPTR -> VDEVREQD = ON THEN /*YES, AND REQS DEVICE?*/ 01541000
         TM    VDEVREQD(TVUPTR),B'00100000'                     03S0404 01542000
         BNO   @RF00404                                         03S0404 01543000
         TM    VOLALOC(TVUPTR),B'10000000'                      03S0404 01544000
         BNZ   @RF00404                                         03S0404 01545000
*            DO;                       /*YES, CHANGE ENTRY TO PRIVATE*/ 01546000
*              IF TVUPTR -> VOLSTG = ON THEN /*ENTRY STORAGE?        */ 01547000
         TM    VOLSTG(TVUPTR),B'00010000'                       03S0406 01548000
         BNO   @RF00406                                         03S0406 01549000
*                DO;                   /*YES                         */ 01550000
*                  STRGREQS = STRGREQS - ONE; /*DECREMENT COUNT      */ 01551000
         L     @07,@PC00001                                     03S0408 01552000
         L     @07,ALCWAPTR(,@07)                               03S0408 01553000
         L     @15,STRGREQS(,@07)                               03S0408 01554000
         BCTR  @15,0                                            03S0408 01555000
         ST    @15,STRGREQS(,@07)                               03S0408 01556000
*                  TVUPTR -> VOLSTG = OFF; /*TURN OFF STORAGE INDIC  */ 01557000
         NI    VOLSTG(TVUPTR),B'11101111'                       03S0409 01558000
*                END;                                           03S0410 01559000
*              ELSE                                             03S0411 01560000
*                DO;                   /*ADJUST PUBLIC ENTRY & COUNT */ 01561000
         B     @RC00406                                         03S0411 01562000
@RF00406 DS    0H                                               03S0412 01563000
*                  PUBLREQS = PUBLREQS - ONE; /*DECREMENT COUNT      */ 01564000
         L     @07,@PC00001                                     03S0412 01565000
         L     @07,ALCWAPTR(,@07)                               03S0412 01566000
         L     @15,PUBLREQS(,@07)                               03S0412 01567000
         BCTR  @15,0                                            03S0412 01568000
         ST    @15,PUBLREQS(,@07)                               03S0412 01569000
*                  TVUPTR -> VOLPUB = OFF; /*TURN OFF PUBLIC INDIC   */ 01570000
         NI    VOLPUB(TVUPTR),B'01111111'                       03S0413 01571000
*                END;                                           03S0414 01572000
*              TVUPTR -> VOLPRV = ON;  /*MAKE ENTRY PRIVATE          */ 01573000
@RC00406 OI    VOLPRV(TVUPTR),B'01000000'                       03S0415 01574000
*              PVTNREQS = PVTNREQS + ONE; /*INCREMENT PRIVATE COUNT  */ 01575000
         L     @07,@PC00001                                     03S0416 01576000
         L     @07,ALCWAPTR(,@07)                               03S0416 01577000
         LA    @15,1                                            03S0416 01578000
         AL    @15,PVTNREQS(,@07)                               03S0416 01579000
         ST    @15,PVTNREQS(,@07)                               03S0416 01580000
*              TVUPTR -> VOLSIOTP -> SPVTAMSG = ON; /*SET INDIC TO      01581000
*                                        ISSUE MSG                   */ 01582000
         L     @07,VOLSIOTP(,TVUPTR)                            03S0417 01583000
         OI    SPVTAMSG(@07),B'00010000'                        03S0417 01584000
*            END;                                               03S0418 01585000
*          ELSE;                                                03S0419 01586000
@RF00404 DS    0H                                               03S0420 01587000
*        ELSE;                                                  03S0420 01588000
@RF00403 DS    0H                                               03S0421 01589000
*        TVUPTR = TVUPTR + VOLENTLN;   /*POINT TO NEXT ENTRY         */ 01590000
         AH    TVUPTR,VOLENTLN                                  03S0421 01591000
*      END;                                                     03S0422 01592000
         AL    VUCTR1,@CF00056                                  03S0422 01593000
@DE00402 L     @07,@PC00001                                     03S0422 01594000
         L     @07,ALCWAPTR(,@07)                               03S0422 01595000
         L     @00,VOLUNSZE(,@07)                               03S0422 01596000
         SRDA  @00,32                                           03S0422 01597000
         LH    @07,VOLENTLN                                     03S0422 01598000
         DR    @00,@07                                          03S0422 01599000
         CR    VUCTR1,@01                                       03S0422 01600000
         BNH   @DL00402                                         03S0422 01601000
*    END;                                                       03S0423 01602000
*  ELSE;                                                        03S0424 01603000
@RF00393 DS    0H                                               03S0425 01604000
*  VUPTR = VUPTR +VOLENTLN;            /*POINT TO NEXT ENTRY         */ 01605000
         LH    @07,VOLENTLN                                     03S0425 01606000
         AL    @07,VUPTR                                        03S0425 01607000
         ST    @07,VUPTR                                        03S0425 01608000
*END;                                                           03S0426 01609000
         AL    VUCTR,@CF00056                                   03S0426 01610000
@DE00392 L     @07,SIOTPTR                                      03S0426 01611000
         CH    VUCTR,SVOLUNNO(,@07)                             03S0426 01612000
         BNH   @DL00392                                         03S0426 01613000
* VUPTR = VUSAVE;                      /*RESET PTR TO CURRENT ENTRY  */ 01614000
         ST    VUSAVE,VUPTR                                     03S0427 01615000
*        END;                                                   02S0428 01616000
*      ELSE                            /*YES, DADSM ERROR            */ 01617000
*        IF STGVOL=ON THEN             /*A STORAGE VOLUME?           */ 01618000
         B     @RC00388                                         02S0429 01619000
@RF00388 TM    STGVOL,B'00010000'                               02S0429 01620000
         BNO   @RF00429                                         02S0429 01621000
*          DO;                                                  02S0430 01622000
*            RETCODE=NOSTRG;           /*YES,SET ERROR RETURN CODE   */ 01623000
         MVC   RETCODE(4),@CF00160                              02S0431 01624000
*            IF SIOTRSNC=SPACERR THEN  /*SPACE COULDN'T BE GOTTEN?   */ 01625000
         L     @07,SIOTPTR                                      02S0432 01626000
         CLC   SIOTRSNC(2,@07),@CH01051                         02S0432 01627000
         BNE   @RF00432                                         02S0432 01628000
*              SIOTRSNC=STRGERR;       /*YES,SET NO SPACE ON STORAGE    01629000
*                                        VOLUME REASON CODE          */ 01630000
         MVC   SIOTRSNC(2,@07),@CH00986                         02S0433 01631000
*          END;                                                 02S0434 01632000
@RF00432 DS    0H                                               02S0435 01633000
*        IF DADSMESW = ON &            /*DADSM ERROR ON      @ZA04836*/ 01634000
*           PUBVOL = ON THEN           /*PUBLIC REQUEST      @ZA04836*/ 01635000
@RF00429 DS    0H                                               02S0435 01636000
@RC00388 TM    DADSMESW,B'00001000'                             02S0435 01637000
         BNO   @RF00435                                         02S0435 01638000
         TM    PUBVOL,B'10000000'                               02S0435 01639000
         BNO   @RF00435                                         02S0435 01640000
*          DO;                                                  02S0436 01641000
*/********************************************************************/ 01642000
*/*                                                          @ZA04836*/ 01643000
*/* SEGMENT NAME - AFFCHCK                                   @ZA04836*/ 01644000
*/*                                                          @ZA04836*/ 01645000
*/* DESCRIPTIVE NAME - PROCESS AFFINITY REQUEST              @ZA04836*/ 01646000
*/*                                                          @ZA04836*/ 01647000
*/* FUNCTION -                                               @ZA04836*/ 01648000
*/*   THIS ROUTINE MARKS ALL VOLUNIT ENTRIES WHICH REQUEST   @ZA04836*/ 01649000
*/*   AFFINITY TO THIS SIOT WITH VUDADSME                    @ZA04836*/ 01650000
*/*   AND VUDNALOC SO THAT THEY WILL NOT BE ALLOCATED UNTIL  @ZA04836*/ 01651000
*/*   THE PRIMARY SIOT HAS BEEN ALLOCATED.                   @ZA04836*/ 01652000
*/*                                                          @ZA04836*/ 01653000
*/* ENTRY -                                                  @ZA04836*/ 01654000
*/*   AFFCHCK - INCLUDED SEGMENT IN PSVOLUN                  @ZA04836*/ 01655000
*/*                                                          @ZA04836*/ 01656000
*/*   PURPOSE - TO MARK REQUEST FOR NON-SPECIFIC DA VOLUME   @ZA04836*/ 01657000
*/*             AFFINITY                                     @ZA04836*/ 01658000
*/*                                                          @ZA04836*/ 01659000
*/*   INPUT -                                                @ZA04836*/ 01660000
*/*     PTR TO SIOT FOR THE REQUEST BEING PROCESSED          @ZA04836*/ 01661000
*/*                                                          @ZA04836*/ 01662000
*/* EXITS -                                                  @ZA04836*/ 01663000
*/*   CONDITION - NORMAL COMPLETION                          @ZA04836*/ 01664000
*/*                                                          @ZA04836*/ 01665000
*/*   OUTPUT - ANY SIOT WHICH HAS AFFINITY TO THE INPUT SIOT @ZA04836*/ 01666000
*/*            WILL HAVE ALL ITS VU ENTRIESMARKED WITH       @ZA04836*/ 01667000
*/*            VUDADSME AND VUDNALOC.                        @ZA04836*/ 01668000
*/*                                                          @ZA04836*/ 01669000
*/********************************************************************/ 01670000
*CHCKSIOT = OFF;                       /*INITIALIZE SWITCH   @ZA04836*/ 01671000
         NI    CHCKSIOT,B'01111111'                             03S0437 01672000
*NUMVUENT = VOLUNSZE/VOLENTLN;         /*GET TOTAL OF VU ENTRIES        01673000
*                                                            @ZA04836*/ 01674000
         L     @07,@PC00001                                     03S0438 01675000
         L     @07,ALCWAPTR(,@07)                               03S0438 01676000
         L     @00,VOLUNSZE(,@07)                               03S0438 01677000
         SRDA  @00,32                                           03S0438 01678000
         LH    NUMVUENT,VOLENTLN                                03S0438 01679000
         DR    @00,NUMVUENT                                     03S0438 01680000
         LR    NUMVUENT,@01                                     03S0438 01681000
*AVUPTR = SVOLUNAD;                    /*GET PTR TO CURRENT SIOTS 1ST   01682000
*                                        VU ENTRY            @ZA04836*/ 01683000
         L     @07,SIOTPTR                                      03S0439 01684000
         L     AVUPTR,SVOLUNAD(,@07)                            03S0439 01685000
*DO AFFCTR = ONE TO SVOLUNNO;          /*CHECK EVERY VU ENTRY IN        01686000
*                                        TABLE FOR A MATCH   @ZA04836*/ 01687000
         LA    AFFCTR,1                                         03S0440 01688000
         B     @DE00440                                         03S0440 01689000
@DL00440 DS    0H                                               03S0441 01690000
*  CALL VUSCAN;                        /*SCAN FOR AFFINITIES @ZA04836*/ 01691000
         BAL   @14,VUSCAN                                       03S0441 01692000
*  AVUPTR = AVUPTR + VOLENTLN;         /*POINT TO NEXT VU ENTRY 03S0442 01693000
*                                        FOR CURRENT SIOT    @ZA04836*/ 01694000
         AH    AVUPTR,VOLENTLN                                  03S0442 01695000
*END;                                                           03S0443 01696000
         AL    AFFCTR,@CF00056                                  03S0443 01697000
@DE00440 L     @07,SIOTPTR                                      03S0443 01698000
         CH    AFFCTR,SVOLUNNO(,@07)                            03S0443 01699000
         BNH   @DL00440                                         03S0443 01700000
*IF CHCKSIOT = ON THEN                 /*IF WE FOUND AFFIN   @ZA04836*/ 01701000
         TM    CHCKSIOT,B'10000000'                             03S0444 01702000
         BNO   @RF00444                                         03S0444 01703000
*  DO;                                                          03S0445 01704000
*    CHCKSIOT = OFF;                                            03S0446 01705000
         NI    CHCKSIOT,B'01111111'                             03S0446 01706000
*    ASIOTPTR = SIOT1P;                /*PT TO 1ST SIOT ON CHAIN        01707000
*                                                            @ZA04836*/ 01708000
         L     @07,@PC00001                                     03S0447 01709000
         L     @07,ALCWAPTR(,@07)                               03S0447 01710000
         L     ASIOTPTR,SIOT1P(,@07)                            03S0447 01711000
*    DO WHILE ASIOTPTR^=ZERO;          /*LOOK AT ALL SIOTS TO FIND      01712000
*                                        AFFINITY REQUESTS   @ZA04836*/ 01713000
         B     @DE00448                                         03S0448 01714000
@DL00448 DS    0H                                               03S0449 01715000
*      IF ASIOTPTR->SIOTAFF=ON THEN    /*THIS SIOT REQUESTED    03S0449 01716000
*                                        AFFINITY            @ZA04836*/ 01717000
         TM    SIOTAFF(ASIOTPTR),B'00100000'                    03S0449 01718000
         BNO   @RF00449                                         03S0449 01719000
*        DO;                                                    03S0450 01720000
*          AVUPTR=ASIOTPTR->SVOLUNAD;  /*GET PTR TO AFFINITY 1ST        01721000
*                                        VU ENTRY            @ZA04836*/ 01722000
         L     AVUPTR,SVOLUNAD(,ASIOTPTR)                       03S0451 01723000
*          ASIOTPTR->SIOTAFF=OFF;      /*RESET SWITCH        @ZA04836*/ 01724000
         NI    SIOTAFF(ASIOTPTR),B'11011111'                    03S0452 01725000
*          DO AVUCTR=ONE TO ASIOTPTR->SVOLUNNO; /*SIOT VU ENTRIES       01726000
*                                                            @ZA04836*/ 01727000
         LA    AVUCTR,1                                         03S0453 01728000
         B     @DE00453                                         03S0453 01729000
@DL00453 DS    0H                                               03S0454 01730000
*            IF AVUPTR->VUDADSME=OFF &                          03S0454 01731000
*               AVUPTR->VUDNALOC=OFF THEN /*HAS THIS VU ENTRY ALREADY   01732000
*                                           BEEN PROCESSED?  @ZA04836*/ 01733000
         TM    VUDADSME(AVUPTR),B'00001100'                     03S0454 01734000
         BNZ   @RF00454                                         03S0454 01735000
*                CALL VUSCAN;          /*PROCESS ALL AFFIN   @ZA04836*/ 01736000
         BAL   @14,VUSCAN                                       03S0455 01737000
*            ELSE;                     /*VU ENTRY PROCESSED  @ZA04836*/ 01738000
@RF00454 DS    0H                                               03S0457 01739000
*            AVUPTR=AVUPTR+VOLENTLN;   /*PT TO NEXT VU ENTRY @ZA04836*/ 01740000
         AH    AVUPTR,VOLENTLN                                  03S0457 01741000
*          END;                                                 03S0458 01742000
         AL    AVUCTR,@CF00056                                  03S0458 01743000
@DE00453 CH    AVUCTR,SVOLUNNO(,ASIOTPTR)                       03S0458 01744000
         BNH   @DL00453                                         03S0458 01745000
*        END;                                             /* @ZA04836*/ 01746000
*      ELSE;                                              /* @ZA04836*/ 01747000
@RF00449 DS    0H                                               03S0461 01748000
*      ASIOTPTR = ASIOTPTR->SIOTNPTR;  /*                    @ZA04836*/ 01749000
         L     ASIOTPTR,SIOTNPTR(,ASIOTPTR)                     03S0461 01750000
*    END;                                                       03S0462 01751000
@DE00448 LTR   ASIOTPTR,ASIOTPTR                                03S0462 01752000
         BNZ   @DL00448                                         03S0462 01753000
*  END;                                                         03S0463 01754000
*          END;                                                 02S0464 01755000
@RF00444 DS    0H                                               02S0465 01756000
*    END;                                                       02S0465 01757000
@RF00435 DS    0H                                               02S0466 01758000
*END;                                                           02S0466 01759000
@RC00206 DS    0H                                               02S0466 01760000
@DE00149 L     @07,VUPTR                                        02S0466 01761000
         TM    VOLALOC(@07),B'10000000'                         02S0466 01762000
         BNZ   @DC00149                                         02S0466 01763000
         ICM   @07,15,RETCODE                                   02S0466 01764000
         BNZ   @DC00149                                         02S0466 01765000
         TM    VOLUNOPR,B'00000010'                             02S0466 01766000
         BZ    @DL00149                                         02S0466 01767000
@DC00149 DS    0H                                               02S0467 01768000
*                      END;                                     01S0467 01769000
*                    ELSE             /*REQUEST NOT SHAREABLE        */ 01770000
*                      DO;                                      01S0468 01771000
         B     @RC00147                                         01S0468 01772000
@RF00147 DS    0H                                               01S0469 01773000
*                        SIOTNOPR = ON; /*REQ NOT TOTALLY ALOC'D     */ 01774000
         OI    SIOTNOPR,B'00000100'                             01S0469 01775000
*                      END;                                     01S0470 01776000
*                  ELSE               /*VOLUNIT ENTRY NOT PROCESSED  */ 01777000
*                    SIOTNOPR=ON;     /*SIOT NOT TOTALLY ALLOC'D BIT */ 01778000
         B     @RC00146                                         01S0471 01779000
@RF00146 OI    SIOTNOPR,B'00000100'                             01S0471 01780000
*                ELSE                 /*ENTRY ALLOCATED              */ 01781000
*                  DO;                                          01S0472 01782000
         B     @RC00145                                         01S0472 01783000
@RF00145 DS    0H                                               01S0473 01784000
*                    IF VUDNALOC = ON THEN /*VU NOT TO BE PROCESSED  */ 01785000
         L     @07,VUPTR                                        01S0473 01786000
         TM    VUDNALOC(@07),B'00001000'                        01S0473 01787000
         BNO   @RF00473                                         01S0473 01788000
*                      SIOTNOPR = ON; /*YES, DON'T MARK SIOT ALLOC'D */ 01789000
         OI    SIOTNOPR,B'00000100'                             01S0474 01790000
*                    ELSE;            /*VU PROCESSED OK              */ 01791000
@RF00473 DS    0H                                               01S0476 01792000
*                  END;                                         01S0476 01793000
*              END;                                             01S0477 01794000
*        END;                                                   01S0478 01795000
*      ELSE                           /*SKIP FIRST ENTRY             */ 01796000
*        DO;                                                    01S0479 01797000
         B     @RC00140                                         01S0479 01798000
@RF00140 DS    0H                                               01S0480 01799000
*          RELDEVNO = RELDEVNO+ONE;                             01S0480 01800000
         AL    RELDEVNO,@CF00056                                01S0480 01801000
*          SIOTNOPR = ON;             /*SIOT NOT ALL PROCESSED       */ 01802000
         OI    SIOTNOPR,B'00000100'                             01S0481 01803000
*        END;                                                   01S0482 01804000
*        VUPTR=VUPTR + VOLENTLN;      /*POINT TO NEXT VOLUNIT ENTRY  */ 01805000
@RC00140 LH    @07,VOLENTLN                                     01S0483 01806000
         AL    @07,VUPTR                                        01S0483 01807000
         ST    @07,VUPTR                                        01S0483 01808000
*      END;                                                     01S0484 01809000
         AL    NUMVOLUN,@CF00056                                01S0484 01810000
@DE00139 L     @07,SIOTPTR                                      01S0484 01811000
         CH    NUMVOLUN,SVOLUNNO(,@07)                          01S0484 01812000
         BNH   @DL00139                                         01S0484 01813000
@DC00139 DS    0H                                               01S0485 01814000
*      IF SIOTNOPR=OFF & SIOTALCD=OFF THEN /*REQ COMPLETELY ALLOC'D  */ 01815000
         TM    SIOTNOPR,B'00000100'                             01S0485 01816000
         BNZ   @RF00485                                         01S0485 01817000
         L     @08,SIOTPTR                                      01S0485 01818000
         TM    SIOTALCD(@08),B'00000010'                        01S0485 01819000
         BNZ   @RF00485                                         01S0485 01820000
*        DO;                                                    01S0486 01821000
*          SIOTALCD=ON;               /*YES,MARK SIOT PROCESSED      */ 01822000
         OI    SIOTALCD(@08),B'00000010'                        01S0487 01823000
*          TOTREQS=TOTREQS-1;         /*REDUCE TOTAL REQUEST COUNT   */ 01824000
         L     @08,@PC00001                                     01S0488 01825000
         L     @08,ALCWAPTR(,@08)                               01S0488 01826000
         L     @15,TOTREQS(,@08)                                01S0488 01827000
         BCTR  @15,0                                            01S0488 01828000
         ST    @15,TOTREQS(,@08)                                01S0488 01829000
*        END;                                                   01S0489 01830000
*      ELSE                           /*SIOT NOT FULLY ALLOC'D       */ 01831000
*        DO;                                                    01S0490 01832000
         B     @RC00485                                         01S0490 01833000
@RF00485 DS    0H                                               01S0491 01834000
*          IF EDLFINIS = ON & EDLMGENS = OFF THEN /*MUST EDL BE 01S0491 01835000
*                                       UPDATED ?                    */ 01836000
         TM    EDLFINIS,B'10000000'                             01S0491 01837000
         BNO   @RF00491                                         01S0491 01838000
         L     @08,SIOTPTR                                      01S0491 01839000
         L     @08,SIOTEDLP(,@08)                               01S0491 01840000
         TM    EDLMGENS(@08),B'01000000'                        01S0491 01841000
         BNZ   @RF00491                                         01S0491 01842000
*            DO;                      /*YES, UPDATE THE EDL          */ 01843000
*              EDLPSAVE = EDLPTR;                               01S0493 01844000
         LR    EDLPSAVE,EDLPTR                                  01S0493 01845000
*              EDLPTR = EDLFGENP;                               01S0494 01846000
         L     EDLPTR,EDLFGENP(,@08)                            01S0494 01847000
*              DO WHILE(EDLPTR^=ZERO);                          01S0495 01848000
         B     @DE00495                                         01S0495 01849000
@DL00495 DS    0H                                               01S0496 01850000
*                IF EDLPTR^=EDLPSAVE THEN /*GEN ALLOC'D              */ 01851000
         CR    EDLPTR,EDLPSAVE                                  01S0496 01852000
         BE    @RF00496                                         01S0496 01853000
*                  EINDEVTP=ON;       /*NO, MARK INELIGIBLE          */ 01854000
         OI    EINDEVTP(EDLPTR),B'10000000'                     01S0497 01855000
*                  EDLPTR=EDLNXTNT;                             01S0498 01856000
@RF00496 L     EDLPTR,EDLNXTNT(,EDLPTR)                         01S0498 01857000
*                END;                                           01S0499 01858000
@DE00495 LTR   EDLPTR,EDLPTR                                    01S0499 01859000
         BNZ   @DL00495                                         01S0499 01860000
*              END;                                             01S0500 01861000
*            ELSE;                    /*DON'T UPDATE EDL             */ 01862000
@RF00491 DS    0H                                               01S0502 01863000
*          END;                                                 01S0502 01864000
*    END;                                                       01S0503 01865000
*  ELSE;                              /*SIOT WAS ALREADY PROCESSED   */ 01866000
@RF00132 DS    0H                                               01S0505 01867000
*  SIOTPTR=SIOTNPTR;                  /*POINT TO NEXT SIOT(REQUEST)  */ 01868000
@RC00132 L     @08,SIOTPTR                                      01S0505 01869000
         L     @08,SIOTNPTR(,@08)                               01S0505 01870000
         ST    @08,SIOTPTR                                      01S0505 01871000
*END;                                                           01S0506 01872000
         SLR   @08,@08                                          01S0506 01873000
         BCTR  @08,0                                            01S0506 01874000
         AL    @08,NUMSIOTS                                     01S0506 01875000
         ST    @08,NUMSIOTS                                     01S0506 01876000
@DE00131 LTR   @08,@08                                          01S0506 01877000
         BP    @DL00131                                         01S0506 01878000
@DC00131 DS    0H                                               01S0507 01879000
*RFY (REG0,REG1) RSTD;                                          01S0507 01880000
*IF REUSESW=ON THEN                    /*ALCUCBLT CORE FREED?@ZA02380*/ 01881000
         TM    REUSESW,B'00000001'                              01S0508 01882000
         BNO   @RF00508                                         01S0508 01883000
*  DO;                                 /*NO,FREE CORE        @ZA02380*/ 01884000
*    REG0=ALCULEN;                     /*LENGTH OF ALCUCBLT  @ZA02380*/ 01885000
         L     REG0,ALCULEN                                     01S0510 01886000
*    REG0 = REG0 | TOO53;              /*SET SP253           @ZA02380*/ 01887000
         O     REG0,@CF00956                                    01S0511 01888000
*    REG1=ALCUCBP;                     /*PTR TO ALCUCBLT     @ZA02380*/ 01889000
         L     REG1,ALCUCBP(,OPTPARMP)                          01S0512 01890000
*    GEN (  FREEMAIN  R,LV=(0),A=(1) ); /*FREE ALCUCBLT CORE @ZA02380*/ 01891000
           FREEMAIN  R,LV=(0),A=(1)                                     01892000
*  END;                                /*                    @ZA02380*/ 01893000
*IF PSOPTCOR=ON THEN                  /*ERROR GETTING CORE?  @YM08667*/ 01894000
@RF00508 TM    PSOPTCOR,B'10000000'                             01S0515 01895000
         BNO   @RF00515                                         01S0515 01896000
*  DO;                                /*NO,FREE CORE         @YM08667*/ 01897000
*    REG0=PSOPTLEN;                   /*SET LENGTH TO FREED  @YM08667*/ 01898000
         L     REG0,PSOPTLEN                                    01S0517 01899000
*    REG0 = REG0 | TOO53;              /*SET SP253                   */ 01900000
         O     REG0,@CF00956                                    01S0518 01901000
*    REG1=LISTP;                       /*SET ADDRESS OF AREA TO FREE */ 01902000
         L     REG1,LISTP                                       01S0519 01903000
*    GEN( FREEMAIN   R,LV=(0),A=(1) ); /*FREE CORE           @YM08667*/ 01904000
          FREEMAIN   R,LV=(0),A=(1)                                     01905000
*  END;                                                         01S0521 01906000
*RFY (REG0,REG1) UNRSTD;                                        01S0522 01907000
@RF00515 DS    0H                                               01S0523 01908000
*RETURN CODE(RETCODE);                /*RETURN ERROR CODE TO CALLER  */ 01909000
         L     @10,RETCODE                                      01S0523 01910000
         L     @13,4(,@13)                                      01S0523 01911000
         L     @00,@SIZDATD                                     01S0523 01912000
         LR    @01,@11                                          01S0523 01913000
         FSPACE   R,LV=(0),A=(1)                                        01914000
         LR    @15,@10                                          01S0523 01915000
         L     @14,12(,@13)                                     01S0523 01916000
         LM    @00,@12,20(@13)                                  01S0523 01917000
         BR    @14                                              01S0523 01918000
*/********************************************************************/ 01919000
*/*                                                                  */ 01920000
*/* SEGMENT NAME - PSLSTBLD                                          */ 01921000
*/*                                                                  */ 01922000
*/* DESCRIPTIVE NAME - BUILD PUBLIC/STORAGE UCB LIST, PSLIST         */ 01923000
*/*                                                                  */ 01924000
*/* FUNCTION                                                         */ 01925000
*/*   THIS SUBROUTINE BUILDS THE PUBLIC/STORAGE UCB LIST(PSLIST) FOR */ 01926000
*/*   AN EDL DEVICE TYPE ENTRY. THE LIST OF PERMANENTLY RESIDENT     */ 01927000
*/*   OR RESERVED DEVICES, OR DEVICES WITH VOLUMES MOUNTED, WHICH ARE*/ 01928000
*/*   ONLINE AND READY AND NOT IN USE BY OLTEP(PSUCBLST) IS SEARCHED */ 01929000
*/*   FOR A UCB ADDRESS WHICH IS ALSO FOUND IN THE EDL. IF A MATCH   */ 01930000
*/*   IS FOUND AND THE UCB HAS THE CORRECT USE ATTRIBUTE(PUBLIC OR   */ 01931000
*/*   STORAGE DEPENDING ON THE TYPE OF PROCESSING BEING DONE), AN    */ 01932000
*/*   ENTRY IS MADE INTO THE PSLIST AND THE INDEX INTO THE PSLIST    */ 01933000
*/*   (PSLINDEX) IS INCREMENTED.                                     */ 01934000
*/*                                                                  */ 01935000
*/* ENTRY -                                                          */ 01936000
*/*   PSLSTBLD - INTERNAL PROCEDURE NAME                             */ 01937000
*/*                                                                  */ 01938000
*/*   PURPOSE - TO BUILD THE PUBLIC/STORAGE LIST (PSLIST)            */ 01939000
*/*                                                                  */ 01940000
*/*   INPUT -                                                        */ 01941000
*/*     POINTER TO THE EDL GENERIC ENTRY TO BE PROCESSED             */ 01942000
*/*     POINTER TO PSUCBLST                                          */ 01943000
*/*     INDEX INTO THE PUBLIC OR STORAGE UCB LIST                    */ 01944000
*/*     MASK TO DETERMINE IF UCB HAS CORRECT ATTRIBUTE               */ 01945000
*/*                                                                  */ 01946000
*/* EXIT                                                             */ 01947000
*/*                                                                  */ 01948000
*/*   CONDITION -                                                    */ 01949000
*/*     PSLIST CREATED                                               */ 01950000
*/*                                                                  */ 01951000
*/*   OUTPUT -                                                       */ 01952000
*/*     PUBLIC/STORAGE UCB LIST                                      */ 01953000
*/*     INDEX INTO PUBLIC/STORAGE LIST FOR THE NEXT ENTRY TO BE ADDED*/ 01954000
*/*                                                                  */ 01955000
*/*   RETURN CODE - NONE                                             */ 01956000
*/*                                                                  */ 01957000
*/********************************************************************/ 01958000
*PSLSTBLD: PROC;                                                02S0524 01959000
PSLSTBLD STM   @14,@01,12(@13)                                  02S0524 01960000
         STM   @03,@12,32(@13)                                  02S0524 01961000
*EDLGNTP=EDLGRPTR;                     /*INIT PTR TO EDL GROUP ENTRY */ 01962000
         L     EDLGNTP,EDLGRPTR(,EDLPTR)                        02S0525 01963000
*LPSUCBPT = PSUCBPTR;                  /*COPY UCB LIST PTR   @YM08667*/ 01964000
         L     @08,@PC00001+4                                   02S0526 01965000
         L     LPSUCBPT,PSUCBPTR(,@08)                          02S0526 01966000
*RFY PSUCBLST BASED(LPSUCBPT);         /*RESET LIST BASE PTR @YM08667*/ 01967000
*IF EINDEVTP=OFF THEN                  /*ELIGIBLE DEVICE TYPE?       */ 01968000
         TM    EINDEVTP(EDLPTR),B'10000000'                     02S0528 01969000
         BNZ   @RF00528                                         02S0528 01970000
*  DO EDLINDX1 = 1 TO EDLGRPNO;        /*YES,PROCESS GROUPS IN EDL   */ 01971000
         LA    EDLINDX1,1                                       02S0529 01972000
         B     @DE00529                                         02S0529 01973000
@DL00529 DS    0H                                               02S0530 01974000
*    IF EDLJINEL = OFF THEN            /*GROUP IS ELIG.      @Y30QPPA*/ 01975000
         TM    EDLJINEL(EDLGNTP),B'10000000'                    02S0530 01976000
         BNZ   @RF00530                                         02S0530 01977000
*      DO;                             /*                    @Y30QPPA*/ 01978000
*        EDLUCBLP=EDLLISTP;            /*POINT TO UCB LIST           */ 01979000
         MVC   EDLUCBLP(4),EDLLISTP(EDLGNTP)                    02S0532 01980000
*        DO EDLINDEX=1 TO EDLUCBNO;    /*PROCESS UCBS WITHIN GROUP   */ 01981000
         LA    @08,1                                            02S0533 01982000
         B     @DE00533                                         02S0533 01983000
@DL00533 DS    0H                                               02S0534 01984000
*          IF EDLALCD(EDLINDEX)=OFF |  /*THIS DEVICE ELIGIBLE?       */ 01985000
*            (EDLALCD(EDLINDEX) = ON                            02S0534 01986000
*            & EDLVOLAF(EDLINDEX) = ON                          02S0534 01987000
*            & PARTALOC = ON) THEN                              02S0534 01988000
         L     @06,EDLUCBLP                                     02S0534 01989000
         SLA   @08,2                                            02S0534 01990000
         ST    @08,@TF00001                                     02S0534 01991000
         ALR   @08,@06                                          02S0534 01992000
         BCTR  @08,0                                            02S0534 01993000
         BCTR  @08,0                                            02S0534 01994000
         TM    EDLALCD-2(@08),B'10000000'                       02S0534 01995000
         BZ    @RT00534                                         02S0534 01996000
         AL    @06,@TF00001                                     02S0534 01997000
         BCTR  @06,0                                            02S0534 01998000
         BCTR  @06,0                                            02S0534 01999000
         TM    EDLALCD-2(@06),B'10010000'                       02S0534 02000000
         BNO   @RF00534                                         02S0534 02001000
         L     @08,@PC00001+8                                   02S0534 02002000
         L     @08,PSPARMP(,@08)                                02S0534 02003000
         TM    PARTALOC(@08),B'00000001'                        02S0534 02004000
         BNO   @RF00534                                         02S0534 02005000
@RT00534 DS    0H                                               02S0535 02006000
*            DO;                                                02S0535 02007000
*              UCBMATCH=OFF;           /*YES,INIT MATCH FOUND SWITCH */ 02008000
         NI    UCBMATCH,B'01111111'                             02S0536 02009000
*              DO UCBINDEX=1 BY 1      /*SEARCH INPUT UCB LIST       */ 02010000
*                WHILE(PSUCBLST(UCBINDEX)^=TABEND & UCBMATCH=OFF);/*    02011000
*                                     STOP AT END OF LIST OR IF MATCH*/ 02012000
         LA    UCBINDEX,1                                       02S0537 02013000
         B     @DE00537                                         02S0537 02014000
@DL00537 DS    0H                                               02S0538 02015000
*                IF (EDLUCBAD(EDLINDEX)=PSUCBLST(UCBINDEX)) &   02S0538 02016000
*                    (EDLNOJES(EDLINDEX) = OFF) THEN /*IF JES3 BIT      02017000
*                                        OFF, OR IF MATCH, THIS UCB MAY 02018000
*                                       BE USED              @ZA12457*/ 02019000
         L     @08,EDLUCBLP                                     02S0538 02020000
         L     @06,EDLINDEX                                     02S0538 02021000
         SLA   @06,2                                            02S0538 02022000
         LR    @15,UCBINDEX                                     02S0538 02023000
         ALR   @15,@15                                          02S0538 02024000
         ST    @06,@TF00001                                     02S0538 02025000
         ALR   @06,@08                                          02S0538 02026000
         AL    @06,@CF01109                                     02S0538 02027000
         ST    @15,@TF00002                                     02S0538 02028000
         ALR   @15,LPSUCBPT                                     02S0538 02029000
         BCTR  @15,0                                            02S0538 02030000
         BCTR  @15,0                                            02S0538 02031000
         CLC   EDLUCBAD(2,@06),PSUCBLST(@15)                    02S0538 02032000
         BNE   @RF00538                                         02S0538 02033000
         AL    @08,@TF00001                                     02S0538 02034000
         BCTR  @08,0                                            02S0538 02035000
         BCTR  @08,0                                            02S0538 02036000
         TM    EDLNOJES-2(@08),B'00001000'                      02S0538 02037000
         BNZ   @RF00538                                         02S0538 02038000
*                  DO;                                          02S0539 02039000
*                    UCBMATCH=ON;      /*YES,INDICATE MATCH FOUND    */ 02040000
         OI    UCBMATCH,B'10000000'                             02S0540 02041000
*                    UCBPTR=PSUCBLST(UCBINDEX);/*SET UCBPTR          */ 02042000
         LR    @08,LPSUCBPT                                     02S0541 02043000
         AL    @08,@TF00002                                     02S0541 02044000
         BCTR  @08,0                                            02S0541 02045000
         BCTR  @08,0                                            02S0541 02046000
         SLR   @06,@06                                          02S0541 02047000
         ICM   @06,3,PSUCBLST(@08)                              02S0541 02048000
         ST    @06,UCBPTR                                       02S0541 02049000
*                    IF (UCBSTAB & UCBMASK) ^= ZERO THEN /*UCB HAVE OK  02050000
*                                         USE ATTRIUBTE?             */ 02051000
         SLR   @08,@08                                          02S0542 02052000
         IC    @08,UCBSTAB(,@06)                                02S0542 02053000
         SLR   @15,@15                                          02S0542 02054000
         IC    @15,UCBMASK                                      02S0542 02055000
         NR    @08,@15                                          02S0542 02056000
         LTR   @08,@08                                          02S0542 02057000
         BZ    @RF00542                                         02S0542 02058000
*                      DO;             /*YES                         */ 02059000
*                        PSLSTENT(PSLINDEX)=PSUCBLST(UCBINDEX); /*PUT   02060000
*                                        UCB ADDR IN PSLIST          */ 02061000
         LR    @08,PSLINDEX                                     02S0544 02062000
         SLA   @08,2                                            02S0544 02063000
         L     @01,PSLISTP(,OPTPARMP)                           02S0544 02064000
         ST    @06,PSLSTENT-4(@08,@01)                          02S0544 02065000
*                        PSLINDEX=PSLINDEX+1;/*UPDATE ENTRY INDEX    */ 02066000
         AL    PSLINDEX,@CF00056                                02S0545 02067000
*                      END;                                     02S0546 02068000
*                    ELSE;             /*UCB HAS WRONG ATTRIBUTE     */ 02069000
@RF00542 DS    0H                                               02S0548 02070000
*                  END;                                         02S0548 02071000
*                ELSE;                 /*UCB'S DON'T MATCH           */ 02072000
@RF00538 DS    0H                                               02S0550 02073000
*              END;                                             02S0550 02074000
         AL    UCBINDEX,@CF00056                                02S0550 02075000
@DE00537 LR    @08,UCBINDEX                                     02S0550 02076000
         ALR   @08,@08                                          02S0550 02077000
         ALR   @08,LPSUCBPT                                     02S0550 02078000
         BCTR  @08,0                                            02S0550 02079000
         BCTR  @08,0                                            02S0550 02080000
         SLR   @06,@06                                          02S0550 02081000
         ICM   @06,3,PSUCBLST(@08)                              02S0550 02082000
         LTR   @06,@06                                          02S0550 02083000
         BZ    @DC00537                                         02S0550 02084000
         TM    UCBMATCH,B'10000000'                             02S0550 02085000
         BZ    @DL00537                                         02S0550 02086000
@DC00537 DS    0H                                               02S0551 02087000
*            END;                                               02S0551 02088000
*          ELSE;                       /*EDL ENTRY NOT ELIGIBLE      */ 02089000
@RF00534 DS    0H                                               02S0553 02090000
*        END;                                                   02S0553 02091000
         LA    @08,1                                            02S0553 02092000
         AL    @08,EDLINDEX                                     02S0553 02093000
@DE00533 ST    @08,EDLINDEX                                     02S0553 02094000
         C     @08,EDLUCBNO(,EDLGNTP)                           02S0553 02095000
         BNH   @DL00533                                         02S0553 02096000
*      END;                            /*                    @Y30QPPA*/ 02097000
*    EDLGNTP=EDLNXGRP;                 /*POINT TO NEXT GROUP ENTRY   */ 02098000
@RF00530 L     EDLGNTP,EDLNXGRP(,EDLGNTP)                       02S0555 02099000
*  END;                                                         02S0556 02100000
         AL    EDLINDX1,@CF00056                                02S0556 02101000
@DE00529 C     EDLINDX1,EDLGRPNO(,EDLPTR)                       02S0556 02102000
         BNH   @DL00529                                         02S0556 02103000
*PSLISTNO=PSLINDEX-1;                  /*NO. OF ENTRIES IN PLSIST    */ 02104000
@RF00528 L     @08,PSLISTP(,OPTPARMP)                           02S0557 02105000
         LR    @03,PSLINDEX                                     02S0557 02106000
         BCTR  @03,0                                            02S0557 02107000
         ST    @03,PSLISTNO(,@08)                               02S0557 02108000
*END PSLSTBLD;                                                  02S0558 02109000
@EL00002 DS    0H                                               02S0558 02110000
@EF00002 DS    0H                                               02S0558 02111000
@ER00002 LM    @14,@01,12(@13)                                  02S0558 02112000
         LM    @03,@12,32(@13)                                  02S0558 02113000
         BR    @14                                              02S0558 02114000
*/********************************************************************/ 02115000
*/* SEGMENT NAME - VUSCAN                                    @ZA04836*/ 02116000
*/*                                                          @ZA04836*/ 02117000
*/* DESCRIPTIVE NAME - VOLUNIT TABLE SCAN ROUTINE            @ZA04836*/ 02118000
*/*                                                          @ZA04836*/ 02119000
*/* FUNCTION -                                               @ZA04836*/ 02120000
*/*   THIS ROUTINE SCANS THE VOLUNIT TABLE.  IF IT FINDS A VU@ZA04836*/ 02121000
*/*   ENTRY WITH THE SAME VOLUNIT ID AS THE INPUT VU ENTRY,  @ZA04836*/ 02122000
*/*   IT SETS THE FOLLOWING INDICATORS IN THE VU ENTRY       @ZA04836*/ 02123000
*/*   VUDADSME AND VUDNALOC.                                 @ZA04836*/ 02124000
*/*                                                          @ZA04836*/ 02125000
*/* ENTRY -                                                  @ZA04836*/ 02126000
*/*   VUSCAN - INTERNAL PROCEDURE NAME                       @ZA04836*/ 02127000
*/*                                                          @ZA04836*/ 02128000
*/*   PURPOSE - MARKS ERROR INDICATORS IN VOLUNIT ENTRIES    @ZA04836*/ 02129000
*/*                                                          @ZA04836*/ 02130000
*/*   INPUT -                                                @ZA04836*/ 02131000
*/*     NUMVUENT - TOTAL NUMBER OF VOLUNIT ENTRIES           @ZA04836*/ 02132000
*/*     AVUPTR - POINTER TO THE VU ENTRY BEING PROCESSED     @ZA04836*/ 02133000
*/*      - VU ENTRY CONTAINS A POINTER SIOT                  @ZA04836*/ 02134000
*/*                                                          @ZA04836*/ 02135000
*/* EXIT -                                                   @ZA04836*/ 02136000
*/*   CONDITION - FUNCTION COMPLETED                         @ZA04836*/ 02137000
*/*                                                          @ZA04836*/ 02138000
*/*   OUTPUT -                                               @ZA04836*/ 02139000
*/*     UPDATED VOLUNIT ENTRIES -                            @ZA04836*/ 02140000
*/*       DADSM ERROR INDICATOR ON                           @ZA04836*/ 02141000
*/*       DO NOT ALLOCATE ENTRY INDICATOR ON                 @ZA04836*/ 02142000
*/*       CHECK REQUEST FOR AFFINITIES INDICATOR ON          @ZA04836*/ 02143000
*/*                                                          @ZA04836*/ 02144000
*/*     UPDATED SIOT -                                       @ZA04836*/ 02145000
*/*       REQUEST HAS AFFINITIES INDICATOR ON                @ZA04836*/ 02146000
*/*                                                          @ZA04836*/ 02147000
*/*   RETURN CODES - NONE                                    @ZA04836*/ 02148000
*/*                                                          @ZA04836*/ 02149000
*/********************************************************************/ 02150000
*VUSCAN: PROC;                                                  02S0559 02151000
VUSCAN   STM   @14,@12,12(@13)                                  02S0559 02152000
*AFFVUPTR = VOLUNPTR;                                           02S0560 02153000
         L     @10,@PC00001                                     02S0560 02154000
         L     @10,ALCWAPTR(,@10)                               02S0560 02155000
         L     AFFVUPTR,VOLUNPTR(,@10)                          02S0560 02156000
*DO SCANCTR = ONE TO NUMVUENT;                                  02S0561 02157000
         LA    SCANCTR,1                                        02S0561 02158000
         B     @DE00561                                         02S0561 02159000
@DL00561 DS    0H                                               02S0562 02160000
*  IF AVUPTR -> VOLUNTID = AFFVUPTR -> VOLUNTID THEN /*VOLUNIT IDS SAME 02161000
*                                                            @ZA04836*/ 02162000
         CLC   VOLUNTID(2,AVUPTR),VOLUNTID(AFFVUPTR)            02S0562 02163000
         BNE   @RF00562                                         02S0562 02164000
*    DO;                                                        02S0563 02165000
*      AFFVUPTR->VUDADSME=ON;          /*SET DADSM ERROR SW  @ZA04836*/ 02166000
*      AFFVUPTR->VUDNALOC=ON;          /*SET DONT PROCESS VU ENTRY SW   02167000
*                                                            @ZA04836*/ 02168000
         OI    VUDADSME(AFFVUPTR),B'00001100'                   02S0565 02169000
*     IF AVUPTR ^= AFFVUPTR THEN                                02S0566 02170000
         CR    AVUPTR,AFFVUPTR                                  02S0566 02171000
         BE    @RF00566                                         02S0566 02172000
*       DO;                                                     02S0567 02173000
*         CHCKSIOT=ON;                 /*SET CHECK FOR AFF SW@ZA04836*/ 02174000
         OI    CHCKSIOT,B'10000000'                             02S0568 02175000
*         AFFVUPTR->VOLSIOTP->SIOTAFF=ON; /*SET SIOT HAS AFFINITY       02176000
*                                                            @ZA04836*/ 02177000
         L     @10,VOLSIOTP(,AFFVUPTR)                          02S0569 02178000
         OI    SIOTAFF(@10),B'00100000'                         02S0569 02179000
*       END;                                                    02S0570 02180000
*     ELSE;                                                     02S0571 02181000
@RF00566 DS    0H                                               02S0572 02182000
*    END;                                                       02S0572 02183000
*  ELSE;                               /*VOLUNIT IDS DONT MATCH 02S0573 02184000
*                                                            @ZA04836*/ 02185000
@RF00562 DS    0H                                               02S0574 02186000
*  AFFVUPTR=AFFVUPTR+VOLENTLN;                                  02S0574 02187000
         AH    AFFVUPTR,VOLENTLN                                02S0574 02188000
*END;                                                           02S0575 02189000
         AL    SCANCTR,@CF00056                                 02S0575 02190000
@DE00561 CR    SCANCTR,NUMVUENT                                 02S0575 02191000
         BNH   @DL00561                                         02S0575 02192000
*END VUSCAN;                                                    02S0576 02193000
@EL00003 DS    0H                                               02S0576 02194000
@EF00003 DS    0H                                               02S0576 02195000
@ER00003 LM    @14,@12,12(@13)                                  02S0576 02196000
         BR    @14                                              02S0576 02197000
*                                                               01S0577 02198000
*                                                               01S0577 02199000
* DECLARE /* COMMON VARIABLES */                                01S0577 02200000
*   I256C CHAR(256) BASED,                                      01S0577 02201000
*   I031F FIXED(31) BASED,                                      01S0577 02202000
*   I031P PTR(31)   BASED,                                      01S0577 02203000
*   I015F FIXED(15) BASED,                                      01S0577 02204000
*   I015P PTR(15)   BASED,                                      01S0577 02205000
*   I008P PTR(8)    BASED,                                      01S0577 02206000
*   I001C CHAR(1)   BASED;                                      01S0577 02207000
*END IEFAB436                                                   01S0578 02208000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 02209000
*/*%INCLUDE SYSLIB  (A436SPEC)                                        * 02210000
*/*%INCLUDE SYSLIB  (A436DATA)                                        * 02211000
*/*%INCLUDE SYSLIB  (IEFASIOT)                                        * 02212000
*/*%INCLUDE SYSLIB  (IEFUCBOB)                                        * 02213000
*/*%INCLUDE SYSLIB  (IEFZB423)                                        * 02214000
*/*%INCLUDE SYSLIB  (IEFZB425)                                        * 02215000
*/*%INCLUDE SYSLIB  (IEZJSCB )                                        * 02216000
*/*%INCLUDE SYSLIB  (PSALCDAT)                                        * 02217000
*/*%INCLUDE SYSLIB  (PSINTDAT)                                        * 02218000
*/*%INCLUDE SYSLIB  (PSLSTDAT)                                        * 02219000
*/*%INCLUDE SYSLIB  (PSVOLDAT)                                        * 02220000
*/*%INCLUDE SYSLIB  (IEFZB422)                                        * 02221000
*/*%INCLUDE SYSLIB  (PSCTLINT)                                        * 02222000
*/*%INCLUDE SYSLIB  (PSINTSPC)                                        * 02223000
*/*%INCLUDE SYSLIB  (PSVOLUN )                                        * 02224000
*/*%INCLUDE SYSLIB  (PSVOLSPC)                                        * 02225000
*/*%INCLUDE SYSLIB  (PSLSTMNT)                                        * 02226000
*/*%INCLUDE SYSLIB  (PSMNTSPC)                                        * 02227000
*/*%INCLUDE SYSLIB  (PSALLOC )                                        * 02228000
*/*%INCLUDE SYSLIB  (PSALCSPC)                                        * 02229000
*/*%INCLUDE SYSLIB  (PSFNDEDL)                                        * 02230000
*/*%INCLUDE SYSLIB  (PSEDLSPC)                                        * 02231000
*/*%INCLUDE SYSLIB  (PVTUPDTE)                                        * 02232000
*/*%INCLUDE SYSLIB  (PVTUPSPC)                                        * 02233000
*/*%INCLUDE SYSLIB  (AFFCHCK )                                        * 02234000
*/*%INCLUDE SYSLIB  (AFFCKSPC)                                        * 02235000
*/*%INCLUDE SYSLIB  (PSLSTBLD)                                        * 02236000
*/*%INCLUDE SYSLIB  (PSBLDSPC)                                        * 02237000
*/*%INCLUDE SYSLIB  (VUSCAN  )                                        * 02238000
*/*%INCLUDE SYSLIB  (VUSCNSPC)                                        * 02239000
*;                                                              01S0578 02240000
@DATA    DS    0H                                                       02241000
@CH00065 DC    H'2'                                                     02242000
@CH00058 DC    H'8'                                                     02243000
@CH00991 DC    H'9'                                                     02244000
@CH00986 DC    H'12'                                                    02245000
@CH01088 DC    H'20'                                                    02246000
@CH01051 DC    H'26'                                                    02247000
@CH00955 DC    H'32'                                                    02248000
@CH00994 DC    H'36'                                                    02249000
@CH00996 DC    H'40'                                                    02250000
@DATD    DSECT                                                          02251000
         DS    0F                                                       02252000
@SA00001 DS    18F                                                      02253000
@PC00001 DS    3F                                                       02254000
@AL00001 DS    8A                                                       02255000
@TF00001 DS    F                                                        02256000
@TF00002 DS    F                                                        02257000
IEFAB436 CSECT                                                          02258000
         DS    0F                                                       02259000
@CF00056 DC    F'1'                                                     02260000
@CH00056 EQU   @CF00056+2                                               02261000
@CF00160 DC    F'4'                                                     02262000
@CF00958 DC    F'253'                                                   02263000
@CF01109 DC    F'-4'                                                    02264000
@CF00956 DC    XL4'FD000000'                                            02265000
@DATD    DSECT                                                          02266000
         DS    0D                                                       02267000
COUNTABP DS    A                                                        02268000
LISTP    DS    A                                                        02269000
SIOTPTR  DS    A                                                        02270000
UCBPTR   DS    A                                                        02271000
VUPTR    DS    A                                                        02272000
TCBJSCB  DS    A                                                        02273000
ALCULEN  DS    F                                                        02274000
ARUINDIC DS    FL4                                                      02275000
         ORG   ARUINDIC                                                 02276000
ARUETUPD DS    BL1                                                      02277000
ARUUSECT EQU   ARUINDIC+0                                               02278000
ARUAFF   EQU   ARUINDIC+0                                               02279000
ARUVLCHK EQU   ARUINDIC+0                                               02280000
ARUUSEST EQU   ARUINDIC+0                                               02281000
ARUUPDAL EQU   ARUINDIC+0                                               02282000
ARUVOLSW EQU   ARUINDIC+0                                               02283000
         ORG   ARUINDIC+4                                               02284000
NUMSIOTS DS    F                                                        02285000
RETCODE  DS    F                                                        02286000
SUBPL    DS    F                                                        02287000
TCBADD   DS    A                                                        02288000
UCBPARMP DS    A                                                        02289000
VOLSERP  DS    A                                                        02290000
ARUGRPID DS    F                                                        02291000
ARUWORD  DS    FL4                                                      02292000
         ORG   ARUWORD                                                  02293000
ARURLPOS DS    FL2                                                      02294000
ARUNDEVS DS    FL2                                                      02295000
         ORG   ARUWORD+4                                                02296000
PSOPTLEN DS    F                                                        02297000
EDLINDEX DS    F                                                        02298000
EDLUCBLP DS    A                                                        02299000
GTSTRTCD DS    F                                                        02300000
@TS00001 DS    CL1                                                      02301000
DOINGDA  DS    BL1                                                      02302000
EDLFINIS DS    BL1                                                      02303000
FIRSTALC DS    BL1                                                      02304000
MASKS    DS    CL2                                                      02305000
         ORG   MASKS                                                    02306000
UCBMASK  DS    BL1                                                      02307000
         ORG   UCBMASK                                                  02308000
@NM00028 DS    BL1                                                      02309000
PUBUCB   EQU   UCBMASK+0                                                02310000
STGUCB   EQU   UCBMASK+0                                                02311000
@NM00029 EQU   UCBMASK+0                                                02312000
         ORG   MASKS+1                                                  02313000
VOLUMASK DS    BL1                                                      02314000
         ORG   VOLUMASK                                                 02315000
PUBVOL   DS    BL1                                                      02316000
@NM00030 EQU   VOLUMASK+0                                               02317000
STGVOL   EQU   VOLUMASK+0                                               02318000
@NM00031 EQU   VOLUMASK+0                                               02319000
         ORG   MASKS+2                                                  02320000
PSOPTCOR DS    BL1                                                      02321000
SWITCHES DS    BL2                                                      02322000
         ORG   SWITCHES                                                 02323000
CHCKSIOT DS    BL1                                                      02324000
ENQERROR EQU   SWITCHES+0                                               02325000
PSLEXIST EQU   SWITCHES+0                                               02326000
PSLUPDAT EQU   SWITCHES+0                                               02327000
DADSMESW EQU   SWITCHES+0                                               02328000
SIOTNOPR EQU   SWITCHES+0                                               02329000
VOLUNOPR EQU   SWITCHES+0                                               02330000
REUSESW  EQU   SWITCHES+0                                               02331000
UCBMATCH DS    BL1                                                      02332000
         ORG   SWITCHES+2                                               02333000
F0MAP    DS    BL1                                                      02334000
         ORG   F0MAP                                                    02335000
VOLUMENQ DS    BL1                                                      02336000
VOLUMEDQ EQU   F0MAP+0                                                  02337000
VOLEXCLU EQU   F0MAP+0                                                  02338000
@NM00034 EQU   F0MAP+0                                                  02339000
         ORG   F0MAP+1                                                  02340000
UCBPARMS DS    CL9                                                      02341000
         ORG   UCBPARMS                                                 02342000
@NM00035 DS    CL2                                                      02343000
VOLUMEID DS    CL6                                                      02344000
@NM00036 DS    CL1                                                      02345000
         ORG   UCBPARMS+9                                               02346000
IEFAB436 CSECT                                                          02347000
         DS    0F                                                       02348000
@SIZDATD DC    AL1(230)                                                 02349000
         DC    AL3(@ENDDATD-@DATD)                                      02350000
@CV00963 DC    V(IEFAB4F0)                                              02351000
@CV00964 DC    V(IEFAB440)                                              02352000
@CV00965 DC    V(IEFAB442)                                              02353000
@CV00967 DC    V(IEFAB434)                                              02354000
         DS    0D                                                       02355000
PSHDRLEN DC    AL4(4)                                                   02356000
GTSTZERO DC    F'0'                                                     02357000
VOLENTLN DC    AL2(28)                                                  02358000
PSENTLN  DC    AL2(4)                                                   02359000
@CB00943 DC    B'10000000'                                              02360000
CLRMASK  DC    XL2'0'                                                   02361000
IEFAB436 CSECT                                                          02362000
         DS   0H                                                        02363000
PATCHLOC DC ((@DATA-@PSTART)/20)X'00'                                   02364000
@DATD    DSECT                                                          02365000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                02366000
@ENDDATD EQU   *                                                        02367000
IEFAB436 CSECT                                                          02368000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       02369000
@01      EQU   01                                                       02370000
@02      EQU   02                                                       02371000
@03      EQU   03                                                       02372000
@04      EQU   04                                                       02373000
@05      EQU   05                                                       02374000
@06      EQU   06                                                       02375000
@07      EQU   07                                                       02376000
@08      EQU   08                                                       02377000
@09      EQU   09                                                       02378000
@10      EQU   10                                                       02379000
@11      EQU   11                                                       02380000
@12      EQU   12                                                       02381000
@13      EQU   13                                                       02382000
@14      EQU   14                                                       02383000
@15      EQU   15                                                       02384000
VUCTR1   EQU   @03                                                      02385000
VUCTR    EQU   @04                                                      02386000
SAVENDEX EQU   @03                                                      02387000
PSLINDEX EQU   @02                                                      02388000
VUSAVE   EQU   @05                                                      02389000
TVUPTR   EQU   @02                                                      02390000
EDLPTR   EQU   @10                                                      02391000
EDLPSAVE EQU   @02                                                      02392000
EDLGNTP  EQU   @03                                                      02393000
UCBINDEX EQU   @05                                                      02394000
EDLINDX1 EQU   @07                                                      02395000
RELDEVNO EQU   @06                                                      02396000
SCANCTR  EQU   @04                                                      02397000
NUMVUENT EQU   @05                                                      02398000
NUMVOLUN EQU   @08                                                      02399000
AVUCTR   EQU   @04                                                      02400000
AFFCTR   EQU   @02                                                      02401000
ERETCODE EQU   @02                                                      02402000
OPTPARMP EQU   @09                                                      02403000
LPSUCBPT EQU   @04                                                      02404000
AVUPTR   EQU   @03                                                      02405000
ASIOTPTR EQU   @02                                                      02406000
AFFVUPTR EQU   @02                                                      02407000
REG0     EQU   @00                                                      02408000
REG1     EQU   @01                                                      02409000
REG15    EQU   @15                                                      02410000
GTSTR0   EQU   @00                                                      02411000
GTSTR1   EQU   @01                                                      02412000
GTSTR2   EQU   @02                                                      02413000
GTSTR15  EQU   @15                                                      02414000
GTSTR4   EQU   @04                                                      02415000
GTSTR5   EQU   @05                                                      02416000
GTSTR6   EQU   @06                                                      02417000
GTSTR7   EQU   @07                                                      02418000
GTSTR8   EQU   @08                                                      02419000
GTSTR3   EQU   @03                                                      02420000
INDMSIOT EQU   0                                                        02421000
SCTUSADD EQU   INDMSIOT+20                                              02422000
SIOTOTUN EQU   INDMSIOT+39                                              02423000
SIOPSCNT EQU   INDMSIOT+42                                              02424000
SIOTBYT1 EQU   INDMSIOT+43                                              02425000
SIOTALCD EQU   SIOTBYT1                                                 02426000
SIOTBYT3 EQU   INDMSIOT+46                                              02427000
SIOTTSTC EQU   INDMSIOT+47                                              02428000
SIOTBYT0 EQU   INDMSIOT+52                                              02429000
SPVTAMSG EQU   SIOTBYT0                                                 02430000
SIOTGIGN EQU   SIOTBYT0                                                 02431000
SCTSDISP EQU   INDMSIOT+55                                              02432000
SCTSBYT1 EQU   INDMSIOT+56                                              02433000
SCTSBYT2 EQU   INDMSIOT+57                                              02434000
SCTSBYT3 EQU   INDMSIOT+58                                              02435000
SCTSBYT4 EQU   INDMSIOT+59                                              02436000
SIOTAFF  EQU   SCTSBYT4                                                 02437000
SCTUTYPE EQU   INDMSIOT+60                                              02438000
SIOTDEVT EQU   SCTUTYPE                                                 02439000
SIOUBYT3 EQU   SIOTDEVT+2                                               02440000
SIOTALTD EQU   INDMSIOT+92                                              02441000
SIOTBYT2 EQU   INDMSIOT+103                                             02442000
SIOTRSNC EQU   INDMSIOT+130                                             02443000
SIOTEDLP EQU   INDMSIOT+136                                             02444000
SVOLUNAD EQU   INDMSIOT+140                                             02445000
SIOTETIO EQU   INDMSIOT+148                                             02446000
SIOTNPTR EQU   INDMSIOT+152                                             02447000
SVOLUNNO EQU   INDMSIOT+168                                             02448000
UCB      EQU   0                                                        02449000
UCBOB    EQU   0                                                        02450000
UCBJBNR  EQU   UCBOB                                                    02451000
UCBFL5   EQU   UCBOB+1                                                  02452000
UCBAF    EQU   UCBFL5                                                   02453000
UCBSTAT  EQU   UCBOB+3                                                  02454000
UCBRESV  EQU   UCBSTAT                                                  02455000
UCBPRES  EQU   UCBSTAT                                                  02456000
UCBCHAN  EQU   UCBOB+4                                                  02457000
UCBSFLS  EQU   UCBOB+6                                                  02458000
UCBFLA   EQU   UCBSFLS                                                  02459000
UCBFL1   EQU   UCBFLA                                                   02460000
UCBBSY   EQU   UCBFL1                                                   02461000
UCBNRY   EQU   UCBFL1                                                   02462000
UCBPST   EQU   UCBFL1                                                   02463000
UCBCUB   EQU   UCBFL1                                                   02464000
UCBFLB   EQU   UCBSFLS+1                                                02465000
UCBCHM   EQU   UCBOB+8                                                  02466000
UCBCHM1  EQU   UCBCHM                                                   02467000
UCBPTH0  EQU   UCBCHM1                                                  02468000
UCBPTH1  EQU   UCBCHM1                                                  02469000
UCBWGT   EQU   UCBOB+12                                                 02470000
UCBTYP   EQU   UCBOB+16                                                 02471000
UCBTBYT1 EQU   UCBTYP                                                   02472000
UCB1FEA5 EQU   UCBTBYT1                                                 02473000
UCB1FEA6 EQU   UCBTBYT1                                                 02474000
UCBTBYT2 EQU   UCBTYP+1                                                 02475000
UCB2OPT2 EQU   UCBTBYT2                                                 02476000
UCBDUDN1 EQU   UCB2OPT2                                                 02477000
UCB2OPT3 EQU   UCBTBYT2                                                 02478000
UCBDUDN2 EQU   UCB2OPT3                                                 02479000
UCB2OPT4 EQU   UCBTBYT2                                                 02480000
UCBRWTAU EQU   UCB2OPT4                                                 02481000
UCB2OPT6 EQU   UCBTBYT2                                                 02482000
UCB2OPT7 EQU   UCBTBYT2                                                 02483000
UCBTBYT3 EQU   UCBTYP+2                                                 02484000
UCBDVCLS EQU   UCBTBYT3                                                 02485000
UCB3TAPE EQU   UCBDVCLS                                                 02486000
UCB3DACC EQU   UCBDVCLS                                                 02487000
UCBTBYT4 EQU   UCBTYP+3                                                 02488000
UCBEXTPT EQU   UCBOB+20                                                 02489000
UCBFLC   EQU   UCBEXTPT                                                 02490000
UCBDEV   EQU   UCBOB+24                                                 02491000
UCBCMEXT EQU   0                                                        02492000
UCBATI   EQU   UCBCMEXT+3                                               02493000
@NM00018 EQU   UCBATI                                                   02494000
UCBFLP1  EQU   UCBCMEXT+5                                               02495000
UCBMT    EQU   0                                                        02496000
UCBOCR   EQU   0                                                        02497000
UCB3540X EQU   0                                                        02498000
UCBDKBYT EQU   UCB3540X+6                                               02499000
UCB3800X EQU   0                                                        02500000
UCBOPTNS EQU   UCB3800X                                                 02501000
UCBACTIV EQU   UCB3800X+3                                               02502000
UCBMDRBF EQU   UCB3800X+36                                              02503000
UCBUCS   EQU   0                                                        02504000
UCBUCSOP EQU   UCBUCS+4                                                 02505000
UCBFCBOP EQU   UCBUCS+5                                                 02506000
VOLUNTAB EQU   0                                                        02507000
VOLID    EQU   VOLUNTAB                                                 02508000
VOLSTAT  EQU   VOLUNTAB+6                                               02509000
VOLSTATA EQU   VOLSTAT                                                  02510000
VOLPUB   EQU   VOLSTATA                                                 02511000
VOLPRV   EQU   VOLSTATA                                                 02512000
VOLSTG   EQU   VOLSTATA                                                 02513000
VOLNSHR  EQU   VOLSTATA                                                 02514000
VOLSTATB EQU   VOLSTAT+1                                                02515000
VOLALOC  EQU   VOLSTATB                                                 02516000
VDEVREQD EQU   VOLSTATB                                                 02517000
VUDNALOC EQU   VOLSTATB                                                 02518000
VUDADSME EQU   VOLSTATB                                                 02519000
VOLSTATC EQU   VOLSTAT+2                                                02520000
VOLSTATD EQU   VOLSTAT+3                                                02521000
VOLUNTID EQU   VOLUNTAB+10                                              02522000
VOLSIOTP EQU   VOLUNTAB+16                                              02523000
ALCWA    EQU   0                                                        02524000
SIOT1P   EQU   ALCWA+8                                                  02525000
JSCBPTR  EQU   ALCWA+12                                                 02526000
FAILRSCP EQU   ALCWA+20                                                 02527000
CNTABLE  EQU   ALCWA+28                                                 02528000
PVTNREQS EQU   CNTABLE+16                                               02529000
PUBLREQS EQU   CNTABLE+20                                               02530000
STRGREQS EQU   CNTABLE+24                                               02531000
TOTREQS  EQU   CNTABLE+36                                               02532000
NUMREQS  EQU   CNTABLE+40                                               02533000
TOTVOLUN EQU   CNTABLE+44                                               02534000
VOLUNPTR EQU   ALCWA+80                                                 02535000
VOLUNSZE EQU   ALCWA+84                                                 02536000
INDICATE EQU   ALCWA+112                                                02537000
PRIVASUM EQU   INDICATE                                                 02538000
@NM00022 EQU   ALCWA+113                                                02539000
TIOTHDRP EQU   ALCWA+120                                                02540000
LGENLOCK EQU   ALCWA+124                                                02541000
NAMES    EQU   0                                                        02542000
IEZJSCB  EQU   0                                                        02543000
JSCBSEC1 EQU   IEZJSCB+188                                              02544000
JSCHPCE  EQU   JSCBSEC1+4                                               02545000
JSCBTCBP EQU   JSCBSEC1+20                                              02546000
JSCBDCB  EQU   JSCBSEC1+36                                              02547000
JSCBOPTS EQU   JSCBSEC1+48                                              02548000
JSCBSWT1 EQU   JSCBSEC1+55                                              02549000
JSCBWTP  EQU   JSCBSEC1+64                                              02550000
JSCBWTFG EQU   JSCBWTP                                                  02551000
JSCBEND1 EQU   IEZJSCB+260                                              02552000
ALCUCBLT EQU   0                                                        02553000
FAILRSC  EQU   0                                                        02554000
OPTPARMS EQU   0                                                        02555000
PSLISTP  EQU   OPTPARMS                                                 02556000
ALCUCBP  EQU   OPTPARMS+4                                               02557000
RETPARMP EQU   OPTPARMS+8                                               02558000
RETAREA  EQU   OPTPARMS+12                                              02559000
OPTDEVP  EQU   RETAREA                                                  02560000
PSCNTENT EQU   0                                                        02561000
PSLIST   EQU   0                                                        02562000
PSLISTNO EQU   PSLIST                                                   02563000
PSLSTENT EQU   PSLIST+4                                                 02564000
PSPARM   EQU   0                                                        02565000
PSSW     EQU   PSPARM                                                   02566000
PSPUB    EQU   PSSW                                                     02567000
PSSTRG   EQU   PSSW                                                     02568000
PUBSTOR  EQU   PSSW                                                     02569000
MOUNTED  EQU   PSSW                                                     02570000
PARTALOC EQU   PSSW                                                     02571000
PSUCBLEN EQU   PSPARM+4                                                 02572000
PSUCBLST EQU   0                                                        02573000
IEFEDL   EQU   0                                                        02574000
EDLHDR   EQU   IEFEDL                                                   02575000
EDLFGENP EQU   EDLHDR+8                                                 02576000
EDLUVFLG EQU   EDLHDR+16                                                02577000
EDLMGENS EQU   EDLUVFLG                                                 02578000
EDLENTRY EQU   0                                                        02579000
EDLNXTNT EQU   EDLENTRY                                                 02580000
EDLDEVT  EQU   EDLENTRY+4                                               02581000
EDLGRPNO EQU   EDLENTRY+8                                               02582000
EDLGRPTR EQU   EDLENTRY+12                                              02583000
EDLNSCNT EQU   EDLENTRY+16                                              02584000
EDLDTFLG EQU   EDLENTRY+20                                              02585000
EINDEVTP EQU   EDLDTFLG                                                 02586000
EDLGNTRY EQU   0                                                        02587000
EDLNXGRP EQU   EDLGNTRY                                                 02588000
EDLUCBNO EQU   EDLGNTRY+4                                               02589000
EDLLISTP EQU   EDLGNTRY+8                                               02590000
EDLGRID  EQU   EDLGNTRY+12                                              02591000
EDLGRFLG EQU   EDLGNTRY+16                                              02592000
EDLJINEL EQU   EDLGRFLG                                                 02593000
EDLUCBL  EQU   0                                                        02594000
EDLUCBAD EQU   EDLUCBL                                                  02595000
EDLINDIC EQU   EDLUCBL+2                                                02596000
EDLALCD  EQU   EDLINDIC                                                 02597000
EDLDADSM EQU   EDLINDIC                                                 02598000
EDLENQ   EQU   EDLINDIC                                                 02599000
EDLVOLAF EQU   EDLINDIC                                                 02600000
EDLNOJES EQU   EDLINDIC                                                 02601000
I001C    EQU   0                                                        02602000
I008P    EQU   0                                                        02603000
I015F    EQU   0                                                        02604000
I015P    EQU   0                                                        02605000
I031F    EQU   0                                                        02606000
I031P    EQU   0                                                        02607000
I256C    EQU   0                                                        02608000
UCBBGN   EQU   0                                                        02609000
ALCWAPTR EQU   0                                                        02610000
PSUCBPTR EQU   0                                                        02611000
PSPARMP  EQU   0                                                        02612000
UCBOBS01 EQU   UCBDEV                                                   02613000
UCBVOLI  EQU   UCBOBS01+4                                               02614000
UCBSTAB  EQU   UCBOBS01+10                                              02615000
UCBBSVL  EQU   UCBSTAB                                                  02616000
UCBPRSRS EQU   UCBSTAB                                                  02617000
UCBDMCT  EQU   UCBOBS01+11                                              02618000
UCBFL4   EQU   UCBOBS01+13                                              02619000
UCBOBS02 EQU   UCBDEV                                                   02620000
UCBTFL1  EQU   UCBOBS02+19                                              02621000
UCBXTN   EQU   UCBOBS02+20                                              02622000
UCBVOPT  EQU   UCBXTN                                                   02623000
UCBOBS03 EQU   UCBDEV                                                   02624000
UCBXTADR EQU   UCBOBS03                                                 02625000
UCBOBS04 EQU   UCBDEV                                                   02626000
UCBBTA   EQU   UCBOBS04+12                                              02627000
UCBOBS06 EQU   UCBDEV                                                   02628000
UCBAOF   EQU   UCBOBS06                                                 02629000
UCBAOF1  EQU   UCBAOF                                                   02630000
UCBAOF2  EQU   UCBAOF+1                                                 02631000
@NM00017 EQU   UCBOBS06+3                                               02632000
UCBIRB   EQU   UCBOBS06+4                                               02633000
UCBGRAF  EQU   UCBIRB                                                   02634000
UCBLDNCA EQU   UCBOBS06+8                                               02635000
UCBRDYQ  EQU   UCBLDNCA                                                 02636000
UCBIRLN  EQU   UCBRDYQ                                                  02637000
UCBLDNCB EQU   UCBRDYQ+1                                                02638000
UCBCTLNK EQU   UCBOBS06+12                                              02639000
UCBOBS07 EQU   UCBDEV                                                   02640000
UCBOBS08 EQU   UCBDEV                                                   02641000
UCBCTCAD EQU   UCBOBS08                                                 02642000
UCBCTCF1 EQU   UCBOBS08+4                                               02643000
UCBOBS09 EQU   UCBDEV                                                   02644000
JSCBSEC2 EQU   JSCBEND1                                                 02645000
JSCBSEC3 EQU   JSCBEND1                                                 02646000
JSCBJCT  EQU   JSCBSEC3                                                 02647000
JSCBJCTA EQU   JSCBJCT+1                                                02648000
JSCBASID EQU   JSCBSEC3+8                                               02649000
JSCBFBYT EQU   JSCBSEC3+10                                              02650000
JSCBJNL  EQU   JSCBSEC3+28                                              02651000
JSCBJJSB EQU   JSCBJNL                                                  02652000
JSCBSUB  EQU   JSCBSEC3+40                                              02653000
JSCSCT   EQU   JSCBSEC3+68                                              02654000
JSCRSV45 EQU   JSCBSEC3+112                                             02655000
JSCRSV46 EQU   JSCRSV45                                                 02656000
JSCRSV47 EQU   JSCRSV45+2                                               02657000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    02658000
JSCBEND3 EQU   JSCBSEC3+120                                             02659000
JSCRSV52 EQU   JSCBSEC3+116                                             02660000
JSCRSV51 EQU   JSCRSV47+1                                               02661000
JSCRSV50 EQU   JSCRSV47                                                 02662000
JSCRSV49 EQU   JSCRSV46+1                                               02663000
JSCRSV48 EQU   JSCRSV46                                                 02664000
JSCRSV44 EQU   JSCBSEC3+108                                             02665000
JSCRSV43 EQU   JSCBSEC3+104                                             02666000
JSCRSV42 EQU   JSCBSEC3+100                                             02667000
JSCBASWA EQU   JSCBSEC3+96                                              02668000
JSCBUFPT EQU   JSCBSEC3+92                                              02669000
JSCBACT  EQU   JSCBSEC3+88                                              02670000
JSCBSWSP EQU   JSCBSEC3+87                                              02671000
JSCRSV33 EQU   JSCBSEC3+86                                              02672000
JSCDDNUM EQU   JSCBSEC3+84                                              02673000
JSCRSV53 EQU   JSCBSEC3+82                                              02674000
JSCDDNNO EQU   JSCBSEC3+80                                              02675000
JSCBVATA EQU   JSCBSEC3+76                                              02676000
JSCTMCOR EQU   JSCBSEC3+72                                              02677000
JSCSCTP  EQU   JSCSCT+1                                                 02678000
JSCRSV55 EQU   JSCSCT                                                   02679000
JSCRSV54 EQU   JSCBSEC3+64                                              02680000
JSCDSABQ EQU   JSCBSEC3+60                                              02681000
JSCBSSIB EQU   JSCBSEC3+56                                              02682000
JSCBFRBA EQU   JSCBSEC3+48                                              02683000
JSCRSV28 EQU   JSCBSEC3+46                                              02684000
JSCBSONO EQU   JSCBSEC3+44                                              02685000
JSCBSUBA EQU   JSCBSUB+1                                                02686000
JSCRSV31 EQU   JSCBSUB                                                  02687000
JSCBSMLR EQU   JSCBSEC3+36                                              02688000
JSCBJNLR EQU   JSCBSEC3+32                                              02689000
JSCBJNLA EQU   JSCBJNL+1                                                02690000
JSCBJSBT EQU   JSCBJJSB                                                 02691000
JSCBJSBX EQU   JSCBJJSB                                                 02692000
JSCBJSBA EQU   JSCBJJSB                                                 02693000
JSCBJSBI EQU   JSCBJJSB                                                 02694000
@NM00027 EQU   JSCBJJSB                                                 02695000
JSCBJNLE EQU   JSCBJJSB                                                 02696000
JSCBJNLF EQU   JSCBJJSB                                                 02697000
JSCBJNLN EQU   JSCBJJSB                                                 02698000
@NM00026 EQU   JSCBSEC3+24                                              02699000
JSCBJRBA EQU   JSCBSEC3+16                                              02700000
JSCBIECB EQU   JSCBSEC3+12                                              02701000
JSCBRV08 EQU   JSCBSEC3+11                                              02702000
JSCBRV07 EQU   JSCBFBYT                                                 02703000
JSCBRV06 EQU   JSCBFBYT                                                 02704000
JSCBRV05 EQU   JSCBFBYT                                                 02705000
JSCBRV04 EQU   JSCBFBYT                                                 02706000
JSCBRV03 EQU   JSCBFBYT                                                 02707000
JSCBRV02 EQU   JSCBFBYT                                                 02708000
JSCBADSP EQU   JSCBFBYT                                                 02709000
JSCBRV01 EQU   JSCBFBYT                                                 02710000
JSCBTJID EQU   JSCBASID                                                 02711000
JSCBPSCB EQU   JSCBSEC3+4                                               02712000
JSCJCTP  EQU   JSCBJCTA                                                 02713000
JSCRSV24 EQU   JSCBJCT                                                  02714000
JSCBEND2 EQU   JSCBSEC2                                                 02715000
UCBRV066 EQU   UCBOBS09+4                                               02716000
UCBIOSBA EQU   UCBOBS09                                                 02717000
UCBRV042 EQU   UCBOBS08+5                                               02718000
UCBRV082 EQU   UCBCTCF1                                                 02719000
UCBRV081 EQU   UCBCTCF1                                                 02720000
UCBRV080 EQU   UCBCTCF1                                                 02721000
UCBRV079 EQU   UCBCTCF1                                                 02722000
UCBRV078 EQU   UCBCTCF1                                                 02723000
UCBRV077 EQU   UCBCTCF1                                                 02724000
UCBRV076 EQU   UCBCTCF1                                                 02725000
UCBCTC80 EQU   UCBCTCF1                                                 02726000
UCBCTCAL EQU   UCBCTCAD                                                 02727000
UCBICNCB EQU   UCBOBS07+4                                               02728000
UCBRV040 EQU   UCBOBS07                                                 02729000
UCBCTLNA EQU   UCBCTLNK+1                                               02730000
UCBRLN   EQU   UCBCTLNK                                                 02731000
UCBRDYQA EQU   UCBLDNCB                                                 02732000
UCBINRLN EQU   UCBIRLN                                                  02733000
UCBIRBA  EQU   UCBIRB+1                                                 02734000
UCBRV039 EQU   UCBGRAF                                                  02735000
UCBDWNR  EQU   UCBGRAF                                                  02736000
UCBRPND  EQU   UCBGRAF                                                  02737000
UCBUPM   EQU   UCBGRAF                                                  02738000
UCBBTAM  EQU   UCBGRAF                                                  02739000
UCBDRNO  EQU   UCBGRAF                                                  02740000
UCBDRO   EQU   UCBGRAF                                                  02741000
UCBOIP   EQU   UCBGRAF                                                  02742000
UCBATRCD EQU   @NM00017                                                 02743000
UCBSKPFG EQU   @NM00017                                                 02744000
UCBRIPND EQU   @NM00017                                                 02745000
UCBRTIAC EQU   @NM00017                                                 02746000
UCBRSV79 EQU   @NM00017                                                 02747000
UCBRSV78 EQU   @NM00017                                                 02748000
UCBRSV77 EQU   @NM00017                                                 02749000
UCBOLTEP EQU   @NM00017                                                 02750000
UCBATNCT EQU   UCBOBS06+2                                               02751000
UCBRSV76 EQU   UCBAOF2                                                  02752000
UCBRSV75 EQU   UCBAOF2                                                  02753000
UCBRSV74 EQU   UCBAOF2                                                  02754000
UCBRSV73 EQU   UCBAOF2                                                  02755000
UCBRSV72 EQU   UCBAOF2                                                  02756000
UCBRSV71 EQU   UCBAOF2                                                  02757000
UCBRSV70 EQU   UCBAOF2                                                  02758000
UCBRSV69 EQU   UCBAOF2                                                  02759000
UCBRSV68 EQU   UCBAOF1                                                  02760000
UCBRSV67 EQU   UCBAOF1                                                  02761000
UCBRSV66 EQU   UCBAOF1                                                  02762000
UCBRSV65 EQU   UCBAOF1                                                  02763000
UCBRSV64 EQU   UCBAOF1                                                  02764000
UCBOFNL  EQU   UCBAOF1                                                  02765000
UCBOFSP  EQU   UCBAOF1                                                  02766000
UCBOFMCR EQU   UCBAOF1                                                  02767000
UCBBTB   EQU   UCBBTA+1                                                 02768000
UCBDI    EQU   UCBBTA                                                   02769000
UCBSNS   EQU   UCBOBS04+8                                               02770000
UCBTEB   EQU   UCBOBS04+4                                               02771000
UCBGCB   EQU   UCBOBS04+3                                               02772000
UCBOPEN  EQU   UCBOBS04+2                                               02773000
UCBSTART EQU   UCBOBS04                                                 02774000
UCBXTNB  EQU   UCBXTN+1                                                 02775000
UCBRSV22 EQU   UCBVOPT                                                  02776000
UCBRSV21 EQU   UCBVOPT                                                  02777000
UCBRSV20 EQU   UCBVOPT                                                  02778000
UCBESVE  EQU   UCBVOPT                                                  02779000
UCBERPC  EQU   UCBVOPT                                                  02780000
UCBESVC  EQU   UCBVOPT                                                  02781000
UCBEVA   EQU   UCBVOPT                                                  02782000
UCBESV   EQU   UCBVOPT                                                  02783000
UCBRV009 EQU   UCBTFL1                                                  02784000
UCBRV008 EQU   UCBTFL1                                                  02785000
UCBRV007 EQU   UCBTFL1                                                  02786000
UCBRV006 EQU   UCBTFL1                                                  02787000
UCBRV005 EQU   UCBTFL1                                                  02788000
UCBRV038 EQU   UCBTFL1                                                  02789000
UCBNSLTP EQU   UCBTFL1                                                  02790000
UCBNLTP  EQU   UCBTFL1                                                  02791000
UCBRES1B EQU   UCBOBS02+18                                              02792000
UCBFSER  EQU   UCBOBS02+12                                              02793000
@NM00016 EQU   UCBOBS02+4                                               02794000
UCBFSEQ  EQU   UCBOBS02+2                                               02795000
UCBFSCT  EQU   UCBOBS02                                                 02796000
UCBNEXP  EQU   UCBOBS01+20                                              02797000
UCBBASE  EQU   UCBOBS01+16                                              02798000
UCBRES1A EQU   UCBOBS01+15                                              02799000
UCBUSER  EQU   UCBOBS01+14                                              02800000
UCBFL47  EQU   UCBFL4                                                   02801000
UCBFL46  EQU   UCBFL4                                                   02802000
UCBFL45  EQU   UCBFL4                                                   02803000
UCBRV065 EQU   UCBFL4                                                   02804000
UCBDSS   EQU   UCBFL4                                                   02805000
UCBRESVP EQU   UCBFL4                                                   02806000
UCBWDAV  EQU   UCBFL4                                                   02807000
UCBDAVV  EQU   UCBFL4                                                   02808000
UCBSQC   EQU   UCBOBS01+12                                              02809000
UCBDATP  EQU   UCBOBS01+12                                              02810000
UCBDMC   EQU   UCBDMCT                                                  02811000
UCBMOUNT EQU   UCBDMCT                                                  02812000
UCBBNUL  EQU   UCBSTAB                                                  02813000
UCBSHAR  EQU   UCBSTAB                                                  02814000
UCBBSTR  EQU   UCBSTAB                                                  02815000
UCBBPUB  EQU   UCBSTAB                                                  02816000
UCBBPRV  EQU   UCBSTAB                                                  02817000
UCBBALB  EQU   UCBPRSRS                                                 02818000
UCBPGFL  EQU   UCBSTAB                                                  02819000
UCBDVSHR EQU   UCBBSVL                                                  02820000
UCBVTOC  EQU   UCBOBS01                                                 02821000
@NM00037 EQU   EDLENTRY+18                                              02822000
EDLVAM   EQU   EDLUVFLG                                                 02823000
EDLGMTP  EQU   EDLHDR+12                                                02824000
EDLGENNO EQU   EDLHDR+4                                                 02825000
EDLLUV   EQU   EDLHDR                                                   02826000
@NM00033 EQU   PSPARM+1                                                 02827000
VOLSWOK  EQU   PSSW                                                     02828000
@NM00032 EQU   PSSW                                                     02829000
PERMRES  EQU   PSSW                                                     02830000
RSNCODE  EQU   RETAREA+4                                                02831000
ALCUENT  EQU   ALCUCBLT+4                                               02832000
ALCUNO   EQU   ALCUCBLT                                                 02833000
JSCBCSCB EQU   JSCBSEC1+68                                              02834000
JSCBPMG  EQU   JSCBWTP+2                                                02835000
JSCBWTSP EQU   JSCBWTP+1                                                02836000
JSCRSV23 EQU   JSCBWTFG                                                 02837000
JSCRSV22 EQU   JSCBWTFG                                                 02838000
JSCRSV21 EQU   JSCBWTFG                                                 02839000
JSCRSV20 EQU   JSCBWTFG                                                 02840000
JSCRSV19 EQU   JSCBWTFG                                                 02841000
JSCRSV18 EQU   JSCBWTFG                                                 02842000
JSCBRET  EQU   JSCBWTFG                                                 02843000
JSCBIOFG EQU   JSCBWTFG                                                 02844000
@NM00025 EQU   JSCBSEC1+60                                              02845000
JSCBQMPI EQU   JSCBSEC1+56                                              02846000
JSCBPMSG EQU   JSCBSWT1                                                 02847000
JSCRSV16 EQU   JSCBSWT1                                                 02848000
JSCRSV15 EQU   JSCBSWT1                                                 02849000
JSCRSV14 EQU   JSCBSWT1                                                 02850000
JSCRSV13 EQU   JSCBSWT1                                                 02851000
JSCRSV12 EQU   JSCBSWT1                                                 02852000
JSCRSV11 EQU   JSCBSWT1                                                 02853000
JSCBPASS EQU   JSCBSWT1                                                 02854000
JSCBTTTR EQU   JSCBSEC1+52                                              02855000
JSCRSV10 EQU   JSCBSEC1+49                                              02856000
JSCBAUTH EQU   JSCBOPTS                                                 02857000
JSCSIOTS EQU   JSCBOPTS                                                 02858000
JSCRSV08 EQU   JSCBOPTS                                                 02859000
JSCRSV07 EQU   JSCBOPTS                                                 02860000
JSCRSV06 EQU   JSCBOPTS                                                 02861000
JSCBLONG EQU   JSCBOPTS                                                 02862000
JSCRSV05 EQU   JSCBOPTS                                                 02863000
JSCRSV04 EQU   JSCBOPTS                                                 02864000
JSCBSECB EQU   JSCBSEC1+44                                              02865000
JSCRSV03 EQU   JSCBSEC1+41                                              02866000
JSCBSTEP EQU   JSCBSEC1+40                                              02867000
JSCBDCBA EQU   JSCBDCB+1                                                02868000
JSCRSV02 EQU   JSCBDCB                                                  02869000
JSCBID   EQU   JSCBSEC1+32                                              02870000
JSCBDBTB EQU   JSCBSEC1+28                                              02871000
JSCBIJSC EQU   JSCBSEC1+24                                              02872000
JSCBPCC  EQU   JSCBSEC1+16                                              02873000
JSCBTCP  EQU   JSCBSEC1+12                                              02874000
JSCBSHR  EQU   JSCBSEC1+8                                               02875000
JSCHPCEA EQU   JSCHPCE+1                                                02876000
JSCRSV32 EQU   JSCHPCE                                                  02877000
JSCRSV01 EQU   JSCBSEC1                                                 02878000
@NM00024 EQU   IEZJSCB                                                  02879000
ALCPROCN EQU   NAMES+16                                                 02880000
ALCSTEPN EQU   NAMES+8                                                  02881000
ALCJOBN  EQU   NAMES                                                    02882000
EXITPRMP EQU   ALCWA+144                                                02883000
CANCELP  EQU   ALCWA+140                                                02884000
WORK3MP  EQU   ALCWA+136                                                02885000
WMASK2P  EQU   ALCWA+132                                                02886000
WMASKPTR EQU   ALCWA+128                                                02887000
TCBP     EQU   ALCWA+116                                                02888000
ALCWASID EQU   ALCWA+114                                                02889000
@NM00023 EQU   @NM00022                                                 02890000
NODEVERR EQU   @NM00022                                                 02891000
NEEDRCVY EQU   @NM00022                                                 02892000
ALCWAREC EQU   @NM00022                                                 02893000
WAITIGEN EQU   @NM00022                                                 02894000
UNITRECS EQU   @NM00022                                                 02895000
ALCWADUL EQU   INDICATE                                                 02896000
ALCWISAM EQU   INDICATE                                                 02897000
DSSUNIT  EQU   INDICATE                                                 02898000
DSSTAPE  EQU   INDICATE                                                 02899000
INDREQU  EQU   INDICATE                                                 02900000
INDRETRY EQU   INDICATE                                                 02901000
INDWAIT  EQU   INDICATE                                                 02902000
QMGRRBP  EQU   ALCWA+108                                                02903000
RIMTABCT EQU   ALCWA+104                                                02904000
RIMTABLN EQU   ALCWA+100                                                02905000
RIMTABP  EQU   ALCWA+96                                                 02906000
ALGTABSZ EQU   ALCWA+92                                                 02907000
ALGTABP  EQU   ALCWA+88                                                 02908000
@NM00021 EQU   ALCWA+78                                                 02909000
LTUNITID EQU   ALCWA+76                                                 02910000
OTHEREQS EQU   CNTABLE+32                                               02911000
SUBSREQS EQU   CNTABLE+28                                               02912000
SPECREQS EQU   CNTABLE+12                                               02913000
TPREQS   EQU   CNTABLE+8                                                02914000
VAMREQS  EQU   CNTABLE+4                                                02915000
DMYREQS  EQU   CNTABLE                                                  02916000
EDTABPTR EQU   ALCWA+24                                                 02917000
IOSLUTP  EQU   ALCWA+16                                                 02918000
FMAPPTR  EQU   ALCWA+4                                                  02919000
WASIZE   EQU   ALCWA                                                    02920000
VUGRID   EQU   VOLUNTAB+24                                              02921000
VUUCBP   EQU   VOLUNTAB+20                                              02922000
VOLALGTP EQU   VOLUNTAB+12                                              02923000
VURCVYPR EQU   VOLSTATD                                                 02924000
VUVLUNIQ EQU   VOLSTATD                                                 02925000
VUDMUNIQ EQU   VOLSTATD                                                 02926000
VUUNALSW EQU   VOLSTATD                                                 02927000
VUDMNDAL EQU   VOLSTATD                                                 02928000
VUDMNDOF EQU   VOLSTATD                                                 02929000
VUREALOC EQU   VOLSTATD                                                 02930000
VUMUGDON EQU   VOLSTATD                                                 02931000
@NM00020 EQU   VOLSTATC                                                 02932000
@NM00019 EQU   VOLSTATC                                                 02933000
VURECVRY EQU   VOLSTATC                                                 02934000
VOLURREQ EQU   VOLSTATC                                                 02935000
VOLGRREQ EQU   VOLSTATC                                                 02936000
VOLDAREQ EQU   VOLSTATC                                                 02937000
VOLCOREQ EQU   VOLSTATC                                                 02938000
VOLTAREQ EQU   VOLSTATC                                                 02939000
VUAFFWRK EQU   VOLSTATB                                                 02940000
VUVINELG EQU   VOLSTATB                                                 02941000
VUPROCED EQU   VOLSTATB                                                 02942000
VOLMNTD  EQU   VOLSTATB                                                 02943000
VOLDEFER EQU   VOLSTATA                                                 02944000
VUDADSM  EQU   VOLSTATA                                                 02945000
VOLRESVE EQU   VOLSTATA                                                 02946000
VOLSPEC  EQU   VOLSTATA                                                 02947000
UCBERADR EQU   UCBUCS+12                                                02948000
UCBFCBID EQU   UCBUCS+8                                                 02949000
UCBERCNT EQU   UCBUCS+7                                                 02950000
UCBRSV51 EQU   UCBUCS+6                                                 02951000
UCBRSV50 EQU   UCBFCBOP                                                 02952000
UCBRSV49 EQU   UCBFCBOP                                                 02953000
UCBRSV48 EQU   UCBFCBOP                                                 02954000
UCBRSV47 EQU   UCBFCBOP                                                 02955000
UCBRSV46 EQU   UCBFCBOP                                                 02956000
UCBRSV45 EQU   UCBFCBOP                                                 02957000
UCBRSV44 EQU   UCBFCBOP                                                 02958000
UCBFCBO1 EQU   UCBFCBOP                                                 02959000
UCBUCSPE EQU   UCBUCSOP                                                 02960000
UCBRSV43 EQU   UCBUCSOP                                                 02961000
UCBRSV42 EQU   UCBUCSOP                                                 02962000
UCBRSV41 EQU   UCBUCSOP                                                 02963000
UCBRSV40 EQU   UCBUCSOP                                                 02964000
UCBRSV39 EQU   UCBUCSOP                                                 02965000
UCBUCSO2 EQU   UCBUCSOP                                                 02966000
UCBUCSO1 EQU   UCBUCSOP                                                 02967000
UCBUCSID EQU   UCBUCS                                                   02968000
UCBMDRBA EQU   UCBMDRBF+1                                               02969000
UCBRV075 EQU   UCBMDRBF                                                 02970000
UCBRV074 EQU   UCB3800X+32                                              02971000
UCBIMAGE EQU   UCB3800X+28                                              02972000
UCBFCBNM EQU   UCB3800X+24                                              02973000
UCBCHAR4 EQU   UCB3800X+20                                              02974000
UCBCHAR3 EQU   UCB3800X+16                                              02975000
UCBCHAR2 EQU   UCB3800X+12                                              02976000
UCBCHAR1 EQU   UCB3800X+8                                               02977000
UCBCGMID EQU   UCB3800X+4                                               02978000
UCBBRSTA EQU   UCBACTIV                                                 02979000
UCBRV063 EQU   UCBACTIV                                                 02980000
UCBRV062 EQU   UCBACTIV                                                 02981000
UCBRV061 EQU   UCBACTIV                                                 02982000
UCBRV060 EQU   UCBACTIV                                                 02983000
UCBRV059 EQU   UCBACTIV                                                 02984000
UCBRV058 EQU   UCBACTIV                                                 02985000
UCBRV057 EQU   UCBACTIV                                                 02986000
UCBRV050 EQU   UCB3800X+2                                               02987000
UCBCGMNO EQU   UCB3800X+1                                               02988000
UCBRV083 EQU   UCBOPTNS                                                 02989000
UCBBRSTR EQU   UCBOPTNS                                                 02990000
UCBRV056 EQU   UCBOPTNS                                                 02991000
UCBRV055 EQU   UCBOPTNS                                                 02992000
UCBRV054 EQU   UCBOPTNS                                                 02993000
UCBRV053 EQU   UCBOPTNS                                                 02994000
UCBRV052 EQU   UCBOPTNS                                                 02995000
UCBRV051 EQU   UCBOPTNS                                                 02996000
UCBRV073 EQU   UCB3540X+7                                               02997000
UCBRV072 EQU   UCBDKBYT                                                 02998000
UCBRV071 EQU   UCBDKBYT                                                 02999000
UCBRV070 EQU   UCBDKBYT                                                 03000000
UCBRV069 EQU   UCBDKBYT                                                 03001000
UCBRV068 EQU   UCBDKBYT                                                 03002000
UCBRV067 EQU   UCBDKBYT                                                 03003000
UCBVLVER EQU   UCBDKBYT                                                 03004000
UCBDKAMX EQU   UCBDKBYT                                                 03005000
UCBVLSER EQU   UCB3540X                                                 03006000
UCBRDATA EQU   UCBOCR+4                                                 03007000
UCBFRID  EQU   UCBOCR                                                   03008000
UCBCLN   EQU   UCBMT+14                                                 03009000
UCBERG   EQU   UCBMT+12                                                 03010000
UCBMS    EQU   UCBMT+11                                                 03011000
UCBNB    EQU   UCBMT+10                                                 03012000
UCBPW    EQU   UCBMT+9                                                  03013000
UCBPR    EQU   UCBMT+8                                                  03014000
UCBSIO   EQU   UCBMT+6                                                  03015000
UCBTW    EQU   UCBMT+5                                                  03016000
UCBTR    EQU   UCBMT+4                                                  03017000
UCBTWT   EQU   UCBMT+3                                                  03018000
UCBTRT   EQU   UCBMT+2                                                  03019000
UCBCTD   EQU   UCBMT                                                    03020000
UCBWTOID EQU   UCBCMEXT+17                                              03021000
UCBRV043 EQU   UCBCMEXT+16                                              03022000
UCBASID  EQU   UCBCMEXT+14                                              03023000
UCBMFCNT EQU   UCBCMEXT+12                                              03024000
UCBPMSK  EQU   UCBCMEXT+10                                              03025000
UCBCCWOF EQU   UCBCMEXT+8                                               03026000
UCBRV041 EQU   UCBCMEXT+6                                               03027000
UCBRV036 EQU   UCBFLP1                                                  03028000
UCBRV035 EQU   UCBFLP1                                                  03029000
UCBERLOG EQU   UCBFLP1                                                  03030000
UCBRV033 EQU   UCBFLP1                                                  03031000
UCBRV032 EQU   UCBFLP1                                                  03032000
UCBRV031 EQU   UCBFLP1                                                  03033000
UCBSHRUP EQU   UCBFLP1                                                  03034000
UCBNSRCH EQU   UCBFLP1                                                  03035000
UCBSNSCT EQU   UCBCMEXT+4                                               03036000
UCBHPDV  EQU   @NM00018                                                 03037000
UCBHALI  EQU   @NM00018                                                 03038000
UCBRSV09 EQU   @NM00018                                                 03039000
UCBRSV08 EQU   @NM00018                                                 03040000
UCBRSV07 EQU   @NM00018                                                 03041000
UCBRSV06 EQU   @NM00018                                                 03042000
UCBRSV05 EQU   @NM00018                                                 03043000
UCBRSV04 EQU   @NM00018                                                 03044000
UCBDTI   EQU   UCBCMEXT+2                                               03045000
UCBSTI   EQU   UCBCMEXT+1                                               03046000
UCBETI   EQU   UCBCMEXT                                                 03047000
UCBEXTP  EQU   UCBEXTPT+1                                               03048000
UCBDDRSW EQU   UCBFLC                                                   03049000
UCBTICBT EQU   UCBFLC                                                   03050000
UCBIVRR  EQU   UCBFLC                                                   03051000
UCBIVRS  EQU   UCBFLC                                                   03052000
UCBITF   EQU   UCBFLC                                                   03053000
UCBUDE   EQU   UCBFLC                                                   03054000
UCBWAA   EQU   UCBFLC                                                   03055000
UCBATTP  EQU   UCBFLC                                                   03056000
UCBUNTYP EQU   UCBTBYT4                                                 03057000
UCBRSV11 EQU   UCBDVCLS                                                 03058000
UCBRSV10 EQU   UCBDVCLS                                                 03059000
UCB3CHAR EQU   UCBDVCLS                                                 03060000
UCB3UREC EQU   UCBDVCLS                                                 03061000
UCB3DISP EQU   UCBDVCLS                                                 03062000
UCB3COMM EQU   UCBDVCLS                                                 03063000
UCBDVPWR EQU   UCB2OPT7                                                 03064000
UCBVLPWR EQU   UCB2OPT6                                                 03065000
UCB2OPT5 EQU   UCBTBYT2                                                 03066000
UCBRVDEV EQU   UCBRWTAU                                                 03067000
UCBRPS   EQU   UCBDUDN2                                                 03068000
UCBRR    EQU   UCBDUDN1                                                 03069000
UCB2OPT1 EQU   UCBTBYT2                                                 03070000
UCB2OPT0 EQU   UCBTBYT2                                                 03071000
UCB1FEA7 EQU   UCBTBYT1                                                 03072000
UCBD6250 EQU   UCB1FEA6                                                 03073000
UCBD1600 EQU   UCB1FEA5                                                 03074000
UCB1FEA4 EQU   UCBTBYT1                                                 03075000
UCB1FEA3 EQU   UCBTBYT1                                                 03076000
UCB1FEA2 EQU   UCBTBYT1                                                 03077000
UCB1FEA1 EQU   UCBTBYT1                                                 03078000
UCB1FEA0 EQU   UCBTBYT1                                                 03079000
UCBNAME  EQU   UCBOB+13                                                 03080000
UCBRV029 EQU   UCBWGT                                                   03081000
UCBVHRSN EQU   UCBWGT                                                   03082000
UCBVORSN EQU   UCBWGT                                                   03083000
UCBMTPXP EQU   UCBWGT                                                   03084000
UCBREW   EQU   UCBWGT                                                   03085000
UCBPUB   EQU   UCBWGT                                                   03086000
UCBOUT   EQU   UCBWGT                                                   03087000
UCBIN    EQU   UCBWGT                                                   03088000
UCBCPU   EQU   UCBOB+11                                                 03089000
UCBLCI   EQU   UCBOB+10                                                 03090000
UCBCNT   EQU   UCBOB+9                                                  03091000
UCBRV017 EQU   UCBCHM1                                                  03092000
UCBRV016 EQU   UCBCHM1                                                  03093000
UCBRV015 EQU   UCBCHM1                                                  03094000
UCBRV014 EQU   UCBCHM1                                                  03095000
UCBSPB   EQU   UCBPTH1                                                  03096000
UCBPPB   EQU   UCBPTH1                                                  03097000
UCBSPA   EQU   UCBPTH0                                                  03098000
UCBPPA   EQU   UCBPTH0                                                  03099000
UCBSIGP  EQU   UCBFLB                                                   03100000
UCBVALPH EQU   UCBFLB                                                   03101000
UCBCRHSN EQU   UCBFLB                                                   03102000
UCBCRHRV EQU   UCBFLB                                                   03103000
UCBRESVH EQU   UCBFLB                                                   03104000
UCBSPST  EQU   UCBFLB                                                   03105000
UCBASNS  EQU   UCBFLB                                                   03106000
UCBIORST EQU   UCBFLB                                                   03107000
UCBQISCE EQU   UCBFL1                                                   03108000
UCBACTV  EQU   UCBFL1                                                   03109000
UCBSAP   EQU   UCBFL1                                                   03110000
UCBNOTRC EQU   UCBCUB                                                   03111000
UCBPSNS  EQU   UCBFL1                                                   03112000
UCBUSING EQU   UCBPST                                                   03113000
UCBNOTRD EQU   UCBNRY                                                   03114000
UCBBUSYD EQU   UCBBSY                                                   03115000
UCBUA    EQU   UCBCHAN+1                                                03116000
UCBCHA   EQU   UCBCHAN                                                  03117000
UCBDADI  EQU   UCBSTAT                                                  03118000
UCBSYSR  EQU   UCBSTAT                                                  03119000
UCBALOC  EQU   UCBSTAT                                                  03120000
UCBUNLD  EQU   UCBSTAT                                                  03121000
UCBCHGS  EQU   UCBSTAT                                                  03122000
UCBONLI  EQU   UCBSTAT                                                  03123000
UCBID    EQU   UCBOB+2                                                  03124000
UCBALTPH EQU   UCBFL5                                                   03125000
UCBALTCU EQU   UCBFL5                                                   03126000
UCBNALOC EQU   UCBFL5                                                   03127000
UCBENVRD EQU   UCBFL5                                                   03128000
UCBVSDR  EQU   UCBFL5                                                   03129000
UCBSASK  EQU   UCBFL5                                                   03130000
UCBAMV   EQU   UCBAF                                                    03131000
UCBDCC   EQU   UCBFL5                                                   03132000
UCBMONT  EQU   UCBJBNR                                                  03133000
UCBRV011 EQU   UCBJBNR                                                  03134000
UCBRSV02 EQU   UCBJBNR                                                  03135000
UCBOLDSM EQU   UCBJBNR                                                  03136000
UCBRV003 EQU   UCBJBNR                                                  03137000
UCBDUC   EQU   UCBJBNR                                                  03138000
UCBJES3  EQU   UCBJBNR                                                  03139000
UCBVRDEV EQU   UCBJBNR                                                  03140000
UCBCMSEG EQU   UCBOB                                                    03141000
UCBPFXND EQU   UCB+512                                                  03142000
UCBIOQ   EQU   UCB+508                                                  03143000
UCBLOCK  EQU   UCB+504                                                  03144000
UCBPXST  EQU   UCB+504                                                  03145000
@NM00015 EQU   UCB                                                      03146000
SIODDSNL EQU   INDMSIOT+173                                             03147000
SIOVDSNL EQU   INDMSIOT+172                                             03148000
SIOVDSNT EQU   INDMSIOT+170                                             03149000
SIOTVMVP EQU   INDMSIOT+164                                             03150000
SIOTJFX  EQU   INDMSIOT+160                                             03151000
SJFCBPTR EQU   INDMSIOT+156                                             03152000
SIOTATE  EQU   INDMSIOT+144                                             03153000
SIOTEDLS EQU   INDMSIOT+132                                             03154000
SCTANAME EQU   INDMSIOT+122                                             03155000
@NM00014 EQU   INDMSIOT+108                                             03156000
SIOTSSNM EQU   INDMSIOT+104                                             03157000
SIODDQCR EQU   SIOTBYT2                                                 03158000
SIOVDQCR EQU   SIOTBYT2                                                 03159000
SIOTCVOL EQU   SIOTBYT2                                                 03160000
SIOTCNEW EQU   SIOTBYT2                                                 03161000
SIOTCALC EQU   SIOTBYT2                                                 03162000
SIOTGALL EQU   SIOTBYT2                                                 03163000
SIOTDSPD EQU   SIOTBYT2                                                 03164000
SIOTDMND EQU   SIOTBYT2                                                 03165000
SIOTOPUC EQU   INDMSIOT+99                                              03166000
SIOTOUTR EQU   INDMSIOT+97                                              03167000
SIOTOUTC EQU   INDMSIOT+96                                              03168000
@NM00013 EQU   INDMSIOT+93                                              03169000
SIOTAUNC EQU   SIOTALTD                                                 03170000
SIOTACAT EQU   SIOTALTD                                                 03171000
SIOTADEL EQU   SIOTALTD                                                 03172000
SIOTAKEP EQU   SIOTALTD                                                 03173000
SIOTNPRV EQU   SIOTALTD                                                 03174000
SIOJCATS EQU   SIOTALTD                                                 03175000
@NM00012 EQU   SIOTALTD                                                 03176000
@NM00011 EQU   SIOTALTD                                                 03177000
@NM00010 EQU   INDMSIOT+91                                              03178000
SIOTNDSB EQU   INDMSIOT+88                                              03179000
@NM00009 EQU   INDMSIOT+84                                              03180000
SIOTDPCD EQU   INDMSIOT+82                                              03181000
@NM00008 EQU   INDMSIOT+81                                              03182000
SCTOUTPN EQU   INDMSIOT+80                                              03183000
SCTOUTNO EQU   INDMSIOT+76                                              03184000
SCTOUTNM EQU   INDMSIOT+68                                              03185000
SIOUCBAD EQU   SCTUTYPE+5                                               03186000
SIOUCNVT EQU   SCTUTYPE+4                                               03187000
SIOUBYT4 EQU   SIOTDEVT+3                                               03188000
@NM00007 EQU   SIOUBYT3                                                 03189000
SIO3UREC EQU   SIOUBYT3                                                 03190000
SIO3DISP EQU   SIOUBYT3                                                 03191000
SIO3DACC EQU   SIOUBYT3                                                 03192000
SIO3COMM EQU   SIOUBYT3                                                 03193000
SIO3TAPE EQU   SIOUBYT3                                                 03194000
SIOUBYT2 EQU   SIOTDEVT+1                                               03195000
SIOUBYT1 EQU   SIOTDEVT                                                 03196000
SIOTOMN  EQU   SCTSBYT4                                                 03197000
SIOTIPDI EQU   SCTSBYT4                                                 03198000
SIOTVAFF EQU   SCTSBYT4                                                 03199000
SIOTSTEP EQU   SCTSBYT4                                                 03200000
SIOTASCI EQU   SCTSBYT4                                                 03201000
SIOTGDGA EQU   SCTSBYT4                                                 03202000
SCTSGDGS EQU   SCTSBYT4                                                 03203000
SCTSOLD  EQU   SCTSBYT3                                                 03204000
SCTSMOD  EQU   SCTSBYT3                                                 03205000
SCTSNEW  EQU   SCTSBYT3                                                 03206000
SCTSYSOU EQU   SCTSBYT3                                                 03207000
SCTVREF  EQU   SCTSBYT3                                                 03208000
SCTALCHK EQU   SCTSBYT3                                                 03209000
SCTSYSNE EQU   SCTSBYT3                                                 03210000
SCTDSNRF EQU   SCTSBYT3                                                 03211000
SCTRECVD EQU   SCTSBYT2                                                 03212000
SCTDEFER EQU   SCTSBYT2                                                 03213000
SCTLABEL EQU   SCTSBYT2                                                 03214000
SCTUNLBD EQU   SCTSBYT2                                                 03215000
SCTJOBLB EQU   SCTSBYT2                                                 03216000
SCTVOLAF EQU   SCTSBYT2                                                 03217000
SIOTCATL EQU   SCTSBYT2                                                 03218000
SIOCLUNL EQU   SCTSBYT2                                                 03219000
SIOTJSCT EQU   SCTSBYT1                                                 03220000
SCTUNAFF EQU   SCTSBYT1                                                 03221000
SCTPARLM EQU   SCTSBYT1                                                 03222000
SIOTQDSN EQU   SCTSBYT1                                                 03223000
SIOTGDSN EQU   SCTSBYT1                                                 03224000
SIOTCCAT EQU   SCTSBYT1                                                 03225000
SCTSYSIN EQU   SCTSBYT1                                                 03226000
SCTDUMMY EQU   SCTSBYT1                                                 03227000
SIOTUNCT EQU   SCTSDISP                                                 03228000
SIOTCTLG EQU   SCTSDISP                                                 03229000
SIOTDLET EQU   SCTSDISP                                                 03230000
SIOTKEEP EQU   SCTSDISP                                                 03231000
SIOTPASS EQU   SCTSDISP                                                 03232000
SIOTPRIV EQU   SCTSDISP                                                 03233000
S3400DSP EQU   SCTSDISP                                                 03234000
SIOTRETN EQU   SCTSDISP                                                 03235000
SIOTVLCT EQU   INDMSIOT+54                                              03236000
SCTNMBUT EQU   INDMSIOT+53                                              03237000
SIOTRTRY EQU   SIOTBYT0                                                 03238000
SIOTPUPV EQU   SIOTBYT0                                                 03239000
SIOTNOPV EQU   SIOTBYT0                                                 03240000
SIOTFUDA EQU   SIOTBYT0                                                 03241000
SIOTDYAL EQU   SIOTBYT0                                                 03242000
SIOTSSDS EQU   SIOTBYT0                                                 03243000
SIOTGIID EQU   INDMSIOT+50                                              03244000
SCTVOLCT EQU   INDMSIOT+49                                              03245000
SCTSPOOL EQU   INDMSIOT+48                                              03246000
SIOTQNAM EQU   SIOTTSTC                                                 03247000
SIOTDSNM EQU   SIOTTSTC                                                 03248000
SIOTTRKM EQU   SIOTTSTC                                                 03249000
@NM00006 EQU   SIOTTSTC                                                 03250000
SIOTTERM EQU   SIOTTSTC                                                 03251000
@NM00005 EQU   SIOTTSTC                                                 03252000
@NM00004 EQU   SIOTBYT3                                                 03253000
SIOTJES3 EQU   SIOTBYT3                                                 03254000
SIOCDEVT EQU   SIOTBYT3                                                 03255000
SIOALIAS EQU   SIOTBYT3                                                 03256000
SCTDDINO EQU   INDMSIOT+44                                              03257000
SIOTDDNT EQU   SIOTBYT1                                                 03258000
SIODADSM EQU   SIOTBYT1                                                 03259000
SIOTDADR EQU   SIOTBYT1                                                 03260000
SIODUNAL EQU   SIOTBYT1                                                 03261000
SIOVAMDS EQU   SIOTBYT1                                                 03262000
SIOTHOLD EQU   SIOTBYT1                                                 03263000
SIOTOCKP EQU   SIOTBYT1                                                 03264000
SIOTREFN EQU   INDMSIOT+40                                              03265000
SIOTVRSB EQU   INDMSIOT+36                                              03266000
@NM00003 EQU   INDMSIOT+35                                              03267000
SCTPJFCB EQU   INDMSIOT+32                                              03268000
@NM00002 EQU   INDMSIOT+31                                              03269000
SCTPSIOT EQU   INDMSIOT+28                                              03270000
SIOTAFID EQU   INDMSIOT+26                                              03271000
@NM00001 EQU   INDMSIOT+24                                              03272000
SIODSNTE EQU   INDMSIOT+22                                              03273000
SIOTUNAF EQU   SCTUSADD                                                 03274000
SIOTDEST EQU   INDMSIOT+12                                              03275000
SCTDDNAM EQU   INDMSIOT+4                                               03276000
SIOTTYPE EQU   INDMSIOT+3                                               03277000
SIOTDSKA EQU   INDMSIOT                                                 03278000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      03279000
@RC00286 EQU   @RC00280                                                 03280000
@RF00259 EQU   @RC00235                                                 03281000
@RF00296 EQU   @RC00235                                                 03282000
@RC00314 EQU   @RC00235                                                 03283000
@RC00214 EQU   @RC00206                                                 03284000
@RF00142 EQU   @RC00140                                                 03285000
@RC00145 EQU   @RC00140                                                 03286000
@RC00485 EQU   @RC00132                                                 03287000
@RC00287 EQU   @RC00286                                                 03288000
@RC00318 EQU   @RC00314                                                 03289000
@RF00353 EQU   @RC00314                                                 03290000
@RC00369 EQU   @RC00214                                                 03291000
@RC00146 EQU   @RC00145                                                 03292000
@RC00334 EQU   @RC00318                                                 03293000
@RC00147 EQU   @RC00146                                                 03294000
@RF00337 EQU   @RC00334                                                 03295000
@ENDDATA EQU   *                                                        03296000
         END   IEFAB436,(C'PLS0957',0701,76265)                         03297000
