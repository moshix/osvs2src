         TITLE 'IEFAB441 - VALIDITY CHECKER                            *00001000
                        '                                               00002000
IEFAB441 CSECT ,                                                01S0001 00003000
@MAINENT DS    0H                                               01S0001 00004000
         USING *,@15                                            01S0001 00005000
         B     @PROLOG                                          01S0001 00006000
         DC    AL1(16)                                          01S0001 00007000
         DC    C'IEFAB441  76.342'                              01S0001 00008000
         DROP  @15                                                      00009000
@PROLOG  STM   @14,@12,12(@13)                                  01S0001 00010000
         BALR  @12,0                                            01S0001 00011000
@PSTART  DS    0H                                               01S0001 00012000
         USING @PSTART,@12                                      01S0001 00013000
         L     @00,@SIZDATD                                     01S0001 00014000
         MODESET EXTKEY=SCHED,SAVEKEY=(2)                               00015000
         GSPACE   R,LV=(0)                                              00016000
         LR    @11,@01                                          01S0001 00017000
         USING @DATD,@11                                        01S0001 00018000
         ST    @13,@SA00001+4                                   01S0001 00019000
         STC   @02,@OLDKEY                                      01S0001 00020000
         MODESET KEYADDR=(2)                                            00021000
         LM    @00,@02,20(@13)                                  01S0001 00022000
         ST    @11,8(,@13)                                      01S0001 00023000
         LR    @13,@11                                          01S0001 00024000
         MODESET EXTKEY=ZERO                                            00025000
         MVC   @PC00001(20),0(@01)                              01S0001 00026000
         MODESET EXTKEY=SCHED                                           00027000
*RTNCODE = SUCCESS;                    /*INITIALIZE RETURN CODE      */ 00028000
         SLR   RTNCODE,RTNCODE                                  01S0073 00029000
*SIOTPTR = INVUPTR->VOLSIOTP;          /*SET PTR TO SIOT TO PROCESS  */ 00030000
         L     @10,@PC00001+8                                   01S0074 00031000
         L     @10,INVUPTR(,@10)                                01S0074 00032000
         MVC   SIOTPTR(4),VOLSIOTP(@10)                         01S0074 00033000
*MASKPTR = ADDR(QMASKOWN);             /*COPY PTR TO MASK            */ 00034000
         L     @10,@PC00001+4                                   01S0075 00035000
         L     @10,ALCWAPTR(,@10)                               01S0075 00036000
         L     @01,QMGRRBP(,@10)                                01S0075 00037000
         L     @01,AQMQBPTR(,@01)                               01S0075 00038000
         LA    @15,QMASKOWN(,@01)                               01S0075 00039000
         ST    @15,MASKPTR                                      01S0075 00040000
*/********************************************************************/ 00041000
*/*                                                                  */ 00042000
*/* SEGMENT NAME - LOCATVOL                                          */ 00043000
*/*                                                                  */ 00044000
*/* DESCRIPTIVE NAME - DETERMINE IF A VOLUME IS MOUNTED              */ 00045000
*/*                                                                  */ 00046000
*/* FUNCTION -                                                       */ 00047000
*/*     THIS ROUTINE DETERMINES IF A VOLUME IS MOUNTED ON A          */ 00048000
*/*     TAPE OR DIRECT-ACCESS UNIT. IF SO, THE GROUP ID OF THE UNIT  */ 00049000
*/*     IS RETURNED.                                                 */ 00050000
*/*   OPERATION - THE EDT GROUP ENTRIES ARE SCANNED TO LOCATE        */ 00051000
*/*               THE UCB WITH THE VOLUME                            */ 00052000
*/*                                                                  */ 00053000
*/* ENTRY - (INLINE SUBROUTINE)                                      */ 00054000
*/*                                                                  */ 00055000
*/*   PURPOSE - (SEE FUNCTION)                                       */ 00056000
*/*                                                                  */ 00057000
*/*   INPUT -                                                        */ 00058000
*/*     ALCWAPTR - PTR TO THE ALLOCATION WORK AREA                   */ 00059000
*/*       EDTABPTR - PTR TO THE SYSGEN'ED EDT                        */ 00060000
*/*     INVUPTR - PTR TO THE VU ENTRY BEING VALIDITY CHECKED         */ 00061000
*/*       VOLID - VOLUME SERIAL TO BE SEARCHED FOR                   */ 00062000
*/*                                                                  */ 00063000
*/* EXIT - NORMAL - (INLINE SUBROUTINE)                              */ 00064000
*/*                                                                  */ 00065000
*/*   CONDITIONS - VOLUME FOUND MOUNTED                              */ 00066000
*/*                                                                  */ 00067000
*/*   OUTPUT -                                                       */ 00068000
*/*     FNDGRPID - GROUP ID OF UCB WITH THE VOLUME                   */ 00069000
*/*     VOLFND - 1                                                   */ 00070000
*/*     UCBPTR - POINTER TO THE UNIT HAVING THE VOLUME MOUNTED       */ 00071000
*/*                                                                  */ 00072000
*/*   RETURN CODES - (NONE)                                          */ 00073000
*/*                                                                  */ 00074000
*/* EXIT - NORMAL - (INLINE SUBROUTINE)                              */ 00075000
*/*                                                                  */ 00076000
*/*   CONDITIONS - VOLUME NOT MOUNTED                                */ 00077000
*/*                                                                  */ 00078000
*/*   OUTPUT -                                                       */ 00079000
*/*     VOLFND - 0                                                   */ 00080000
*/*                                                                  */ 00081000
*/*   RETURN CODES - (NONE)                                          */ 00082000
*/*                                                                  */ 00083000
*/********************************************************************/ 00084000
*VOLFND = OFF;                         /*INDICATE UCB NOT LOCATED    */ 00085000
         NI    VOLFND,B'11111011'                               02S0076 00086000
*GRPPTR = EDTGRPSP + LENGTH(GRPHDR);   /*LOCATE FIRST GROUP ENTRY    */ 00087000
         L     @10,EDTABPTR(,@10)                               02S0077 00088000
         LA    GRPPTR,8                                         02S0077 00089000
         AL    GRPPTR,EDTGRPSP(,@10)                            02S0077 00090000
*DO GRPCTR = ONE TO GRPENTNO           /*SCAN ALL GROUP ENTRIES      */ 00091000
*    WHILE VOLFND = OFF;                                        02S0078 00092000
         LA    GRPCTR,1                                         02S0078 00093000
         B     @DE00078                                         02S0078 00094000
@DL00078 TM    VOLFND,B'00000100'                               02S0078 00095000
         BNZ   @DC00078                                         02S0078 00096000
*  DO DEVCTR = ONE TO GRPUCBNO         /*SCAN ALL UCBS IN GROUP      */ 00097000
*      WHILE VOLFND = OFF;                                      02S0079 00098000
         LA    DEVCTR,1                                         02S0079 00099000
         B     @DE00079                                         02S0079 00100000
@DL00079 TM    VOLFND,B'00000100'                               02S0079 00101000
         BNZ   @DC00079                                         02S0079 00102000
*    UCBPTR = IOSLUT(EUCBTPOS(DEVCTR)+ONE); /*GET ADDRESS OF UCB     */ 00103000
         LR    @10,DEVCTR                                       02S0080 00104000
         ALR   @10,@10                                          02S0080 00105000
         L     @01,GRPUCBP(,GRPPTR)                             02S0080 00106000
         BCTR  @01,0                                            02S0080 00107000
         BCTR  @01,0                                            02S0080 00108000
         LH    @10,EUCBTPOS(@10,@01)                            02S0080 00109000
         ALR   @10,@10                                          02S0080 00110000
         L     @15,@PC00001+4                                   02S0080 00111000
         L     @01,ALCWAPTR(,@15)                               02S0080 00112000
         L     @01,IOSLUTP(,@01)                                02S0080 00113000
         ALR   @01,@10                                          02S0080 00114000
         SLR   @10,@10                                          02S0080 00115000
         ICM   @10,3,IOSLUT(@01)                                02S0080 00116000
         ST    @10,UCBPTR                                       02S0080 00117000
*    IF (UCB3DACC=ON | UCB3TAPE=ON)    /*INPUT VOLUME MOUNTED ?      */ 00118000
*        & UCBVOLI=INVUPTR->VOLID THEN                          02S0081 00119000
         TM    UCB3DACC(@10),B'10100000'                        02S0081 00120000
         BZ    @RF00081                                         02S0081 00121000
         L     @15,@PC00001+8                                   02S0081 00122000
         L     @01,INVUPTR(,@15)                                02S0081 00123000
         CLC   UCBVOLI(6,@10),VOLID(@01)                        02S0081 00124000
         BNE   @RF00081                                         02S0081 00125000
*      DO;                                                      02S0082 00126000
*        VOLFND = ON;                  /*INDICATE VOLUME WAS FOUND   */ 00127000
         OI    VOLFND,B'00000100'                               02S0083 00128000
*        FNDGRPID = GRPID;             /*COPY GROUP ID               */ 00129000
         MVC   FNDGRPID(4),GRPID(GRPPTR)                        02S0084 00130000
*      END;                                                     02S0085 00131000
*    ELSE;                             /*VOLUME NOT FOUND            */ 00132000
@RF00081 DS    0H                                               02S0087 00133000
*  END;                                                         02S0087 00134000
         AH    DEVCTR,@CH00048                                  02S0087 00135000
@DE00079 C     DEVCTR,GRPUCBNO(,GRPPTR)                         02S0087 00136000
         BNH   @DL00079                                         02S0087 00137000
@DC00079 DS    0H                                               02S0088 00138000
*  GRPPTR = GRPPTR + GRPENTLN;         /*POINT TO NEXT GROUP ENTRY   */ 00139000
         L     @10,@PC00001+4                                   02S0088 00140000
         L     @10,ALCWAPTR(,@10)                               02S0088 00141000
         L     @10,EDTABPTR(,@10)                               02S0088 00142000
         L     @10,EDTGRPSP(,@10)                               02S0088 00143000
         AL    GRPPTR,GRPENTLN(,@10)                            02S0088 00144000
*END;                                                           02S0089 00145000
         AH    GRPCTR,@CH00048                                  02S0089 00146000
@DE00078 L     @10,@PC00001+4                                   02S0089 00147000
         L     @10,ALCWAPTR(,@10)                               02S0089 00148000
         L     @10,EDTABPTR(,@10)                               02S0089 00149000
         L     @10,EDTGRPSP(,@10)                               02S0089 00150000
         C     GRPCTR,GRPENTNO(,@10)                            02S0089 00151000
         BNH   @DL00078                                         02S0089 00152000
@DC00078 DS    0H                                               02S0090 00153000
*IF VOLFND = ON THEN                   /*IS THE VOLUME MOUNTED ?     */ 00154000
         TM    VOLFND,B'00000100'                               01S0090 00155000
         BNO   @RF00090                                         01S0090 00156000
*  DO;                                 /*YES, PROCESS                */ 00157000
*    IF UCBNALOC = ON THEN             /*IS THE UCB USEABLE          */ 00158000
         L     @10,UCBPTR                                       01S0092 00159000
         TM    UCBNALOC(@10),B'00000100'                        01S0092 00160000
         BNO   @RF00092                                         01S0092 00161000
*      DO;                             /*NO, INDICATE ERROR          */ 00162000
*        RTNCODE = ERROR;              /*SET ERROR RETURN CODE       */ 00163000
         LA    RTNCODE,4                                        01S0094 00164000
*        SIOTRSNC=ERRCD(1);            /*SET SIOT REASON CODE        */ 00165000
         L     @10,SIOTPTR                                      01S0095 00166000
         MVC   SIOTRSNC(2,@10),ERRCD                            01S0095 00167000
*      END;                                                     01S0096 00168000
*    ELSE                              /*UCB IS USEABLE      @Y30QPPA*/ 00169000
*      IF UCBJES3 = ON & SIOTJES3 ^= ON THEN /*JES              01S0097 00170000
*                                        MANAGED UCB         @ZA03645*/ 00171000
         B     @RC00092                                         01S0097 00172000
@RF00092 L     @10,UCBPTR                                       01S0097 00173000
         TM    UCBJES3(@10),B'01000000'                         01S0097 00174000
         BNO   @RF00097                                         01S0097 00175000
         L     @10,SIOTPTR                                      01S0097 00176000
         TM    SIOTJES3(@10),B'00100000'                        01S0097 00177000
         BO    @RF00097                                         01S0097 00178000
*        DO;                           /*AND NOT JES REQUEST @ZA03645*/ 00179000
*          RTNCODE = ERROR;            /*SET ERROR RTN CODE  @Y30QPPA*/ 00180000
         LA    RTNCODE,4                                        01S0099 00181000
*          SIOTRSNC = ERRCD(5);        /*SET SIOT REASN CODE @Y30QPPA*/ 00182000
         MVC   SIOTRSNC(2,@10),ERRCD+8                          01S0100 00183000
*        END;                          /*                    @Y30QPPA*/ 00184000
*      ELSE                            /*UCB IS USEABLE, CONTINUE    */ 00185000
*        DO;                                                    01S0102 00186000
         B     @RC00097                                         01S0102 00187000
@RF00097 DS    0H                                               01S0103 00188000
*/********************************************************************/ 00189000
*/*                                                                  */ 00190000
*/* SEGMENT NAME - CHEKTYPE                                          */ 00191000
*/*                                                                  */ 00192000
*/* FUNCTION -  THIS ROUTINE DETERMINES IF THE REQUESTED VOLUME      */ 00193000
*/*             IS LOCATED ON A DEVICE TYPE WHICH IS COMPATIBLE      */ 00194000
*/*             WITH THE DEVICE TYPE WHERE THE VOLUME IS TO BE       */ 00195000
*/*             ALLOCATED.                                           */ 00196000
*/*             THE TWO DEVICE TYPES ARE COMPATIBLE IF THEY ARE THE  */ 00197000
*/*             SAME (EXCEPT FOR CERTAIN OPTION  BITS        @YM05476*/ 00198000
*/*             THAT MAY HAVE BEEN SET IN THE UCB BY         @YM05476*/ 00199000
*/*             SOME PRIOR PROCESSING. THESE ARE BITS        @YM05476*/ 00200000
*/*             THAT ARE NOT FEATURES OF ALL DEVICES OF THAT @YM05476*/ 00201000
*/*             TYPE, OR THAT PERTAIN TO HOW THE DEVICE IS   @YM05476*/ 00202000
*/*             USED RATHER THAN PHYSICAL CHARACTERISTICS.), @YM05476*/ 00203000
*/*             OR IF THEY ARE BOTH TAPE DEVICE TYPES WHICH          */ 00204000
*/*             SUPPORT AT LEAST ONE MUTUAL DENSITY.                 */ 00205000
*/*             IF THE DEVICE TYPES ARE COMPATIBLE BUT NOT THE SAME, */ 00206000
*/*             THIS ROUTINE DETERMINES IF ALL TAPE GENERICS @YM08171*/ 00207000
*/*             ARE LOCKED. IF NOT, THE REQUEST IS MARKED    @YM08171*/ 00208000
*/*             FOR RETRY OR RECOVERY (IF IT IS ALREADY      @YM08171*/ 00209000
*/*             RETRY).                                      @YM08171*/ 00210000
*/*                                                                  */ 00211000
*/*   OPERATION - (DOCUMENTED BY THE CODE)                           */ 00212000
*/*                                                                  */ 00213000
*/* ENTRY - (INLINE SUBROUTINE)                                      */ 00214000
*/*                                                                  */ 00215000
*/*   INPUT -                                                        */ 00216000
*/*     UCBPTR - PTR TO UCB WHERE VOLUME IS MOUNTED                  */ 00217000
*/*     ALCDTYPE - DEVICE TYPE TO BE ALLOCATED TO THE REQUEST        */ 00218000
*/*     INVUPTR - PTR TO REQUEST BEING PROCESSED                     */ 00219000
*/*     ALCWAREC - RECOVERY ALLOCATION INDICATOR             @YM08171*/ 00220000
*/*     GENLOKSW - RETRY INDICATOR                           @YM08171*/ 00221000
*/*                                                                  */ 00222000
*/* EXIT - NORMAL - (INLINE SUBROUTINE)                              */ 00223000
*/*                                                                  */ 00224000
*/*   CONDITION - DEVICE TYPES ARE COMPATIBLE. RECOVERY      @YM08171*/ 00225000
*/*                AND RETRY NOT NEEDED                      @YM08171*/ 00226000
*/*                                                                  */ 00227000
*/*   OUTPUT - TYPMATCH=1                                            */ 00228000
*/*          - TYPELOKD=1                                            */ 00229000
*/*                                                                  */ 00230000
*/*   RETURN CODES - (NONE)                                          */ 00231000
*/*                                                                  */ 00232000
*/* EXIT - NORMAL - (INLINE SUBROUTINE)                              */ 00233000
*/*                                                                  */ 00234000
*/*   CONDITION - DEVICE TYPES ARE COMPATIBLE. RETRY NEEDED.         */ 00235000
*/*                                                                  */ 00236000
*/*   OUTPUT - INDRETRY = 1                                          */ 00237000
*/*          - SIOTRTRY = 1                                          */ 00238000
*/*                                                                  */ 00239000
*/*   RETURN CODES - (NONE)                                          */ 00240000
*/*                                                                  */ 00241000
*/* EXIT - NORMAL - (INLINE SUBROUTINE)                              */ 00242000
*/*                                                                  */ 00243000
*/*   CONDITION - DEVICE TYPES ARE COMPATIBLE. RECOVERY NEEDED       */ 00244000
*/*                                                                  */ 00245000
*/*   OUTPUT - NEEDRCVY (IN ALCWA) = 1                               */ 00246000
*/*          - VUDNALOC=1 AND VUVINELG=1 FOR ALL REQUESTS    @ZA07122*/ 00247000
*/*          - TYPMATCH=1                                            */ 00248000
*/*          - TYPELOKD=0                                            */ 00249000
*/*                                                                  */ 00250000
*/*   RETURN CODES - (NONE)                                          */ 00251000
*/*                                                                  */ 00252000
*/* EXIT - ERROR - (INLINE SUBROUTINE)                               */ 00253000
*/*                                                                  */ 00254000
*/*  CONDITION - DEVICE TYPES ARE INCOMPATIBLE                       */ 00255000
*/*                                                                  */ 00256000
*/*   OUTPUT - TYPMATCH=0                                            */ 00257000
*/*                                                                  */ 00258000
*/*   RETURN CODES - (NONE)                                          */ 00259000
*/*                                                                  */ 00260000
*/********************************************************************/ 00261000
*TYPMATCH = OFF;                                                02S0103 00262000
*TYPELOKD = OFF;                       /*ASSUME DEVICE TYPE IS LOCKED*/ 00263000
         NI    TYPMATCH,B'11001111'                             02S0104 00264000
*INTYPST = ALCDTYPE;                   /*COPY UCB TYPE TO BE ALLOC'D */ 00265000
         L     @10,@PC00001+16                                  02S0105 00266000
         MVC   INTYPST(4),ALCDTYPE(@10)                         02S0105 00267000
*IF INDACC = ON THEN                   /*DA UNIT ?                   */ 00268000
         TM    INDACC,B'00100000'                               02S0106 00269000
         BNO   @RF00106                                         02S0106 00270000
*  DO;                                 /*TURN OFF OPTION BITS@YM05476*/ 00271000
*    INTYPBT2 = INTYPBT2 & SHPOWOFF;   /*SHARED FILE AND ALTERNATE      00272000
*                                        POWER BITS OFF      @YM05477*/ 00273000
         NI    INTYPBT2,X'DC'                                   02S0108 00274000
*    IF INTYPBT4 = DA3340 THEN         /*IF A 3340 DEVICE    @YM05476*/ 00275000
         CLI   INTYPBT4,X'0A'                                   02S0109 00276000
         BNE   @RF00109                                         02S0109 00277000
*      INTYPBT2 = INTYPBT2 & RPSMASK;  /*RPS BIT OFF ALSO    @YM05476*/ 00278000
         NI    INTYPBT2,X'EF'                                   02S0110 00279000
*  END;                                /*END IF DIRECT ACCESS@YM05476*/ 00280000
@RF00109 DS    0H                                               02S0112 00281000
*IF INTAPE = ON THEN                   /*TAPE DEVICE         @YM05477*/ 00282000
@RF00106 TM    INTAPE,B'10000000'                               02S0112 00283000
         BNO   @RF00112                                         02S0112 00284000
*  INTYPBT2 = INTYPBT2 & OPTIONS;      /*OPTIONS BITS OFF    @ZA04104*/ 00285000
         NI    INTYPBT2,X'F4'                                   02S0113 00286000
*VOLTYPST = UCBTYP;                    /*COPY UCB TYPE WHERE VOL MNTD*/ 00287000
@RF00112 L     @10,UCBPTR                                       02S0114 00288000
         MVC   VOLTYPST(4),UCBTYP(@10)                          02S0114 00289000
*IF UCB3DACC = ON THEN                 /*DA UNIT ?                   */ 00290000
         TM    UCB3DACC(@10),B'00100000'                        02S0115 00291000
         BNO   @RF00115                                         02S0115 00292000
*  DO;                                 /*TURN OFF OPTION BITS@YM05476*/ 00293000
*    VLTYPBT2 = VLTYPBT2 & SHPOWOFF;   /*SHARED FILE AND ALTERNATE      00294000
*                                        POWER BITS OFF      @YM05477*/ 00295000
         NI    VLTYPBT2,X'DC'                                   02S0117 00296000
*    IF VLTYPBT4 = DA3340 THEN         /*IF A 3340 DEVICE    @YM05476*/ 00297000
         CLI   VLTYPBT4,X'0A'                                   02S0118 00298000
         BNE   @RF00118                                         02S0118 00299000
*      VLTYPBT2 = VLTYPBT2 & RPSMASK;  /*RPS BIT OFF ALSO    @YM05476*/ 00300000
         NI    VLTYPBT2,X'EF'                                   02S0119 00301000
*  END;                                /*END IF DIRECT ACCESS@YM05476*/ 00302000
@RF00118 DS    0H                                               02S0121 00303000
*IF UCB3TAPE = ON THEN                 /*TAPE DEVICE         @YM05477*/ 00304000
@RF00115 L     @10,UCBPTR                                       02S0121 00305000
         TM    UCB3TAPE(@10),B'10000000'                        02S0121 00306000
         BNO   @RF00121                                         02S0121 00307000
*  VLTYPBT2 = VLTYPBT2 & OPTIONS;      /*OPTIONS BITS OFF    @ZA04104*/ 00308000
         NI    VLTYPBT2,X'F4'                                   02S0122 00309000
*IF INTYPST = VOLTYPST THEN            /*SAME DEVICE TYPE ?          */ 00310000
@RF00121 CLC   INTYPST(4),VOLTYPST                              02S0123 00311000
         BNE   @RF00123                                         02S0123 00312000
*  DO;                                 /*YES, INDICATE               */ 00313000
*    TYPMATCH = ON;                                             02S0125 00314000
*    TYPELOKD = ON;                                             02S0126 00315000
         OI    TYPMATCH,B'00110000'                             02S0126 00316000
*  END;                                                         02S0127 00317000
*ELSE                                  /*NOT THE SAME DEVICE TYPE    */ 00318000
*  DO;                                                          02S0128 00319000
         B     @RC00123                                         02S0128 00320000
@RF00123 DS    0H                                               02S0129 00321000
*    IF INTAPE = ON & UCB3TAPE = ON THEN /*TAPE UNITS ?              */ 00322000
         TM    INTAPE,B'10000000'                               02S0129 00323000
         BNO   @RF00129                                         02S0129 00324000
         L     @10,UCBPTR                                       02S0129 00325000
         TM    UCB3TAPE(@10),B'10000000'                        02S0129 00326000
         BNO   @RF00129                                         02S0129 00327000
*      DO;                             /*YES, SEE IF TAPES ARE COMPAT*/ 00328000
*        IF INTRK7 = ON & VOLTRK7 = ON THEN /*7-TRK UNITS ?          */ 00329000
         TM    INTRK7,B'10000000'                               02S0131 00330000
         BNO   @RF00131                                         02S0131 00331000
         TM    VOLTRK7,B'10000000'                              02S0131 00332000
         BNO   @RF00131                                         02S0131 00333000
*          TYPMATCH = ON;              /*YES,VOL IS ELIGIBLE         */ 00334000
         OI    TYPMATCH,B'00010000'                             02S0132 00335000
*        ELSE                          /*9-TRK UNITS                 */ 00336000
*          DO;                                                  02S0133 00337000
         B     @RC00131                                         02S0133 00338000
@RF00131 DS    0H                                               02S0134 00339000
*/********************************************************************/ 00340000
*/*                                                                  */ 00341000
*/* SEGMENT NAME - TAPECHK                                           */ 00342000
*/*                                                                  */ 00343000
*/* DESCRIPTIVE NAME - TAPE VALIDITY CHECK ROUTINE                   */ 00344000
*/*                                                                  */ 00345000
*/* FUNCTION                                                         */ 00346000
*/*   IF A TAPE VOLUME IS FOUND MOUNTED ON A UNIT WHOSE DEVICE TYPE  */ 00347000
*/*   IS DIFFERENT THAN THAT OF THE UNIT REQUESTED, THIS ROUTINE IS  */ 00348000
*/*   INVOKED. IT DETERMINES IF THE VOLUME IS ELIGIBLE FOR THE       */ 00349000
*/*   REQUESTED UNIT.                                                */ 00350000
*/*                                                                  */ 00351000
*/* ENTRY - IN-LINE SUBROUTINE                                       */ 00352000
*/*                                                                  */ 00353000
*/*   PURPOSE - TO DETERMINE IF TAPE VOL IS ELIGIBLE FOR ALLOCATION  */ 00354000
*/*             TO REQUESTED UNIT                                    */ 00355000
*/*                                                                  */ 00356000
*/*   INPUT -                                                        */ 00357000
*/*     INTYPCOM - UCBTYPE FIELD OF REQUESTED UNIT                   */ 00358000
*/*     TYPCOMP - UCBTYPE FIELD OF UNIT ON WHICH VOL IS MOUNTED      */ 00359000
*/*     TYPMATCH - SWITCH TO BE SET IF VOL IS ELIGIBLE               */ 00360000
*/*                                                                  */ 00361000
*/* EXIT-NORMAL                                                      */ 00362000
*/*                                                                  */ 00363000
*/*   CONDITION - VALIDITY CHECK PERFORMED                           */ 00364000
*/*                                                                  */ 00365000
*/*   OUTPUT -                                                       */ 00366000
*/*     TYPMATCH SWITCH SET ON IF VOL IS ELIGIBLE                    */ 00367000
*/*                                                                  */ 00368000
*/*   RETURN CODE - NONE                                             */ 00369000
*/*                                                                  */ 00370000
*/* EXIT-ERROR - NONE                                                */ 00371000
*/*                                                                  */ 00372000
*/********************************************************************/ 00373000
*IF INTYPCOM = TYP3000 THEN            /*800 BPI UNIT REQUESTED      */ 00374000
         CLC   INTYPCOM(2),@CB00153                             03S0134 00375000
         BNE   @RF00134                                         03S0134 00376000
*  IF (TYPCOMP = TYP3000 |             /*VOL ON 800 BPI UNIT         */ 00377000
*      TYPCOMP = TYP3420) THEN         /*VOL ON 800/1600 BPI UNIT    */ 00378000
         CLC   TYPCOMP(2),@CB00153                              03S0135 00379000
         BE    @RT00135                                         03S0135 00380000
         CLC   TYPCOMP(2),@CB00157                              03S0135 00381000
         BNE   @RF00135                                         03S0135 00382000
@RT00135 DS    0H                                               03S0136 00383000
*    TYPMATCH = ON;                    /*TAPE VOL IS ELIGIBLE        */ 00384000
         OI    TYPMATCH,B'00010000'                             03S0136 00385000
*  ELSE;                                                        03S0137 00386000
@RF00135 DS    0H                                               03S0138 00387000
*ELSE                                                           03S0138 00388000
*  IF INTYPCOM = TYP3400 THEN          /*1600 BPI UNIT REQUESTED     */ 00389000
         B     @RC00134                                         03S0138 00390000
@RF00134 CLC   INTYPCOM(2),@CB00155                             03S0138 00391000
         BNE   @RF00138                                         03S0138 00392000
*    IF (TYPCOMP = TYP3420 |           /*VOL ON 800/1600 BPI UNIT    */ 00393000
*        TYPCOMP = TYP3400 |           /*VOL ON 1600 BPI UNIT        */ 00394000
*        TYPCOMP = TYP3210) THEN       /*VOL ON 1600/6250 UNT@YM05486*/ 00395000
         CLC   TYPCOMP(2),@CB00157                              03S0139 00396000
         BE    @RT00139                                         03S0139 00397000
         CLC   TYPCOMP(2),@CB00155                              03S0139 00398000
         BE    @RT00139                                         03S0139 00399000
         CLC   TYPCOMP(2),@CB00161                              03S0139 00400000
         BNE   @RF00139                                         03S0139 00401000
@RT00139 DS    0H                                               03S0140 00402000
*      TYPMATCH = ON;                  /*VOL IS ELIGIBLE             */ 00403000
         OI    TYPMATCH,B'00010000'                             03S0140 00404000
*    ELSE;                                                      03S0141 00405000
@RF00139 DS    0H                                               03S0142 00406000
*  ELSE                                                         03S0142 00407000
*    IF INTYPCOM = TYP3420 THEN        /*800/1600 BPI UNIT REQUESTED */ 00408000
         B     @RC00138                                         03S0142 00409000
@RF00138 CLC   INTYPCOM(2),@CB00157                             03S0142 00410000
         BNE   @RF00142                                         03S0142 00411000
*      IF (TYPCOMP = TYP3420 |         /*VOL ON 800/1600 UNIT        */ 00412000
*          TYPCOMP = TYP3000 |         /*VOL ON 800 UNIT             */ 00413000
*          TYPCOMP = TYP3400 |         /*VOL ON 1600 UNIT            */ 00414000
*          TYPCOMP = TYP3210) THEN     /*VOL ON 1600/6250 UNT@YM05486*/ 00415000
         CLC   TYPCOMP(2),@CB00157                              03S0143 00416000
         BE    @RT00143                                         03S0143 00417000
         CLC   TYPCOMP(2),@CB00153                              03S0143 00418000
         BE    @RT00143                                         03S0143 00419000
         CLC   TYPCOMP(2),@CB00155                              03S0143 00420000
         BE    @RT00143                                         03S0143 00421000
         CLC   TYPCOMP(2),@CB00161                              03S0143 00422000
         BNE   @RF00143                                         03S0143 00423000
@RT00143 DS    0H                                               03S0144 00424000
*        TYPMATCH = ON;                /*VOL IS ELIGIBLE             */ 00425000
         OI    TYPMATCH,B'00010000'                             03S0144 00426000
*      ELSE;                                                    03S0145 00427000
@RF00143 DS    0H                                               03S0146 00428000
*    ELSE                                                       03S0146 00429000
*      IF INTYPCOM = TYP3200 THEN      /*6250 UNIT REQUESTED         */ 00430000
         B     @RC00142                                         03S0146 00431000
@RF00142 CLC   INTYPCOM(2),@CB00159                             03S0146 00432000
         BNE   @RF00146                                         03S0146 00433000
*        IF (TYPCOMP = TYP3200 |       /*VOL ON 6250 UNIT            */ 00434000
*            TYPCOMP = TYP3210) THEN   /*VOL ON 1600/6250 UNT@YM05486*/ 00435000
         CLC   TYPCOMP(2),@CB00159                              03S0147 00436000
         BE    @RT00147                                         03S0147 00437000
         CLC   TYPCOMP(2),@CB00161                              03S0147 00438000
         BNE   @RF00147                                         03S0147 00439000
@RT00147 DS    0H                                               03S0148 00440000
*          TYPMATCH = ON;              /*VOL IS ELIGIBLE             */ 00441000
         OI    TYPMATCH,B'00010000'                             03S0148 00442000
*        ELSE;                                                  03S0149 00443000
@RF00147 DS    0H                                               03S0150 00444000
*      ELSE                                                     03S0150 00445000
*        IF INTYPCOM = TYP3210 THEN    /*1600/6250 UNIT REQ'D@YM05486*/ 00446000
         B     @RC00146                                         03S0150 00447000
@RF00146 CLC   INTYPCOM(2),@CB00161                             03S0150 00448000
         BNE   @RF00150                                         03S0150 00449000
*          IF (TYPCOMP = TYP3210 |     /*VOL ON 1600/6250 UNT@YM05486*/ 00450000
*              TYPCOMP = TYP3400 |     /*VOL ON 1600 UNIT            */ 00451000
*              TYPCOMP = TYP3420 |     /*VOL ON 800/1600 UNIT        */ 00452000
*              TYPCOMP = TYP3200) THEN /*VOL ON 6250                 */ 00453000
         CLC   TYPCOMP(2),@CB00161                              03S0151 00454000
         BE    @RT00151                                         03S0151 00455000
         CLC   TYPCOMP(2),@CB00155                              03S0151 00456000
         BE    @RT00151                                         03S0151 00457000
         CLC   TYPCOMP(2),@CB00157                              03S0151 00458000
         BE    @RT00151                                         03S0151 00459000
         CLC   TYPCOMP(2),@CB00159                              03S0151 00460000
         BNE   @RF00151                                         03S0151 00461000
@RT00151 DS    0H                                               03S0152 00462000
*            TYPMATCH = ON;            /*VOL IS ELIGIBLE             */ 00463000
         OI    TYPMATCH,B'00010000'                             03S0152 00464000
*          ELSE;                                                03S0153 00465000
@RF00151 DS    0H                                               03S0154 00466000
*        ELSE;                                                  03S0154 00467000
@RF00150 DS    0H                                               03S0155 00468000
*          END;                                                 02S0155 00469000
@RC00146 DS    0H                                               02S0155 00470000
@RC00142 DS    0H                                               02S0155 00471000
@RC00138 DS    0H                                               02S0155 00472000
@RC00134 DS    0H                                               02S0156 00473000
*        IF TYPMATCH = ON THEN         /*IS VOL ELIGIBLE ?           */ 00474000
@RC00131 TM    TYPMATCH,B'00010000'                             02S0156 00475000
         BNO   @RF00156                                         02S0156 00476000
*          DO;                         /*YES, PROCESS                */ 00477000
*            IF ALCWAREC = ON & GENLOKSW = ON THEN /*RECOVERY ALOC &    00478000
*                                        RETRY               @YM08171*/ 00479000
         L     @10,@PC00001+4                                   02S0158 00480000
         L     @10,ALCWAPTR(,@10)                               02S0158 00481000
         TM    ALCWAREC(@10),B'00100000'                        02S0158 00482000
         BNO   @RF00158                                         02S0158 00483000
         L     @10,FMAPPTR(,@10)                                02S0158 00484000
         TM    GENLOKSW(@10),B'00000001'                        02S0158 00485000
         BNO   @RF00158                                         02S0158 00486000
*              TYPELOKD = ON;          /*YES, INDIC DEV TYPE IS LOCKD*/ 00487000
         OI    TYPELOKD,B'00100000'                             02S0159 00488000
*            ELSE                      /*NOT RECOVERY ALLOCATION     */ 00489000
*              IF GENLOKSW = ON THEN   /*RETRY               @YM08171*/ 00490000
         B     @RC00158                                         02S0160 00491000
@RF00158 L     @10,@PC00001+4                                   02S0160 00492000
         L     @10,ALCWAPTR(,@10)                               02S0160 00493000
         L     @02,FMAPPTR(,@10)                                02S0160 00494000
         TM    GENLOKSW(@02),B'00000001'                        02S0160 00495000
         BNO   @RF00160                                         02S0160 00496000
*                DO;                   /*MARK FOR RECOVERY           */ 00497000
*                  NEEDRCVY = ON;                               02S0162 00498000
         OI    NEEDRCVY(@10),B'00010000'                        02S0162 00499000
*                  VUPTR = VOLUNPTR;   /*SCAN VOLUNIT TABLE  @ZA07122*/ 00500000
         L     VUPTR,VOLUNPTR(,@10)                             02S0163 00501000
*                  DO VUCTR=ONE TO VOLUNSZE/LENGTH(VOLUNTAB);/* 02S0164 00502000
*                                                            @ZA07122*/ 00503000
         LA    VUCTR,1                                          02S0164 00504000
         B     @DE00164                                         02S0164 00505000
@DL00164 DS    0H                                               02S0165 00506000
*                    IF VOLUNTID=INVUPTR->VOLUNTID THEN /*   @ZA07122*/ 00507000
         L     @10,@PC00001+8                                   02S0165 00508000
         L     @10,INVUPTR(,@10)                                02S0165 00509000
         CLC   VOLUNTID(2,VUPTR),VOLUNTID(@10)                  02S0165 00510000
         BNE   @RF00165                                         02S0165 00511000
*                      DO;             /*FOR ALL REQUESTS    @ZA07122*/ 00512000
*                        VUDNALOC=ON;  /*W SAME ID,IND ENTRY @ZA07122*/ 00513000
*                        VUVINELG=ON;  /*NOT TO BE PROCESSED @ZA07122*/ 00514000
         OI    VUDNALOC(VUPTR),B'00001010'                      02S0168 00515000
*                      END;            /*UNTIL RECOVERY AND  @ZA07122*/ 00516000
*                    ELSE;             /*VOLUME MOUNTED ON   @ZA07122*/ 00517000
@RF00165 DS    0H                                               02S0171 00518000
*                                      /*INELIG OR UNLOCKED  @ZA07122*/ 00519000
*                    VUPTR=VUPTR+LENGTH(VOLUNTAB); /*UNIT    @ZA07122*/ 00520000
         AH    VUPTR,@CH00099                                   02S0171 00521000
*                  END;                /*                    @ZA07122*/ 00522000
         AH    VUCTR,@CH00048                                   02S0172 00523000
@DE00164 L     @10,@PC00001+4                                   02S0172 00524000
         L     @10,ALCWAPTR(,@10)                               02S0172 00525000
         L     @00,VOLUNSZE(,@10)                               02S0172 00526000
         SRDA  @00,32                                           02S0172 00527000
         D     @00,@CF00099                                     02S0172 00528000
         CR    VUCTR,@01                                        02S0172 00529000
         BNH   @DL00164                                         02S0172 00530000
*                END;                  /*                    @ZA07122*/ 00531000
*              ELSE                    /*MARK FOR RETRY      @YM08171*/ 00532000
*                DO;                   /*                    @YM08171*/ 00533000
         B     @RC00160                                         02S0174 00534000
@RF00160 DS    0H                                               02S0175 00535000
*                  INDRETRY = ON;      /*                    @YM08171*/ 00536000
         L     @10,@PC00001+4                                   02S0175 00537000
         L     @10,ALCWAPTR(,@10)                               02S0175 00538000
         OI    INDRETRY(@10),B'01000000'                        02S0175 00539000
*                  SIOTRTRY = ON;      /*                    @YM08171*/ 00540000
         L     @10,SIOTPTR                                      02S0176 00541000
         OI    SIOTRTRY(@10),B'00000001'                        02S0176 00542000
*                END;                  /*                    @YM08171*/ 00543000
*          END;                                                 02S0178 00544000
*        ELSE;                         /*VOL IS NOT ELIGIBLE         */ 00545000
@RF00156 DS    0H                                               02S0180 00546000
*      END;                                                     02S0180 00547000
*    ELSE;                             /*NOT TAPE UNITS              */ 00548000
@RF00129 DS    0H                                               02S0182 00549000
*  END;                                                         02S0182 00550000
@RC00129 DS    0H                                               02S0183 00551000
*          IF TYPMATCH = OFF THEN      /*ARE THEY COMPATIBLE ?       */ 00552000
@RC00123 TM    TYPMATCH,B'00010000'                             01S0183 00553000
         BNZ   @RF00183                                         01S0183 00554000
*            DO;                       /*NO, INDICATE ERROR          */ 00555000
*              RTNCODE = ERROR;        /*SEE ERROR RETURN CODE       */ 00556000
         LA    RTNCODE,4                                        01S0185 00557000
*              SIOTRSNC=ERRCD(2);      /*SET SIOT RSNCODE            */ 00558000
         L     @10,SIOTPTR                                      01S0186 00559000
         MVC   SIOTRSNC(2,@10),ERRCD+2                          01S0186 00560000
*            END;                                               01S0187 00561000
*          ELSE                        /*DEVICE TYPES ARE COMPATIBLE */ 00562000
*            DO;                                                01S0188 00563000
         B     @RC00183                                         01S0188 00564000
@RF00183 DS    0H                                               01S0189 00565000
*              IF TYPELOKD = ON THEN   /*DEVICE TYPE LOCKED ?        */ 00566000
         TM    TYPELOKD,B'00100000'                             01S0189 00567000
         BNO   @RF00189                                         01S0189 00568000
*                DO;                   /*YES, CONTINUE               */ 00569000
*                  IF (UCB3DACC=ON                              01S0191 00570000
*                      & (UCBPRES=ON | UCBRESV=ON))             01S0191 00571000
*                      | (UCB3TAPE=ON                           01S0191 00572000
*                      & UCBRESV=ON) THEN/*                     01S0191 00573000
*                                        VOLUME ON NONREMOVABLE UNIT?*/ 00574000
         L     @10,UCBPTR                                       01S0191 00575000
         TM    UCB3DACC(@10),B'00100000'                        01S0191 00576000
         BNO   @GL00016                                         01S0191 00577000
         TM    UCBPRES(@10),B'00100100'                         01S0191 00578000
         BNZ   @RT00191                                         01S0191 00579000
@GL00016 L     @10,UCBPTR                                       01S0191 00580000
         TM    UCB3TAPE(@10),B'10000000'                        01S0191 00581000
         BNO   @RF00191                                         01S0191 00582000
         TM    UCBRESV(@10),B'00100000'                         01S0191 00583000
         BNO   @RF00191                                         01S0191 00584000
@RT00191 DS    0H                                               01S0192 00585000
*                    DO;               /*YES,ALLOCATE THERE OR FAIL  */ 00586000
*/********************************************************************/ 00587000
*/*                                                                  */ 00588000
*/* SEGMENT NAME - PRRDEVIC                                          */ 00589000
*/*                                                                  */ 00590000
*/* DESCRIPTIVE NAME - ALLOCATE TO NON-REMOVABLE VOLUME              */ 00591000
*/*                                                                  */ 00592000
*/* FUNCTION -                                                       */ 00593000
*/*     THIS ROUTINE DETERMINES IF THE VOLUME IS MOUNTED ON A UNIT   */ 00594000
*/*     WHICH IS ELIGIBLE TO THIS REQUEST. IF IT IS, MODULE IEFAB442 */ 00595000
*/*     IS CALLED TO BREAK ANY UNIT AFFINITIES TO REQUESTS           */ 00596000
*/*     FOR THIS VOLUME. AFTER THAT, MODULE IEFAB434 IS CALLED TO    */ 00597000
*/*     ALLOCATE ALL REQUESTS FOR THIS VOLUME TO WHERE IT IS         */ 00598000
*/*     CURRENTLY MOUNTED.                                           */ 00599000
*/*     IF THE VOLUME IS MOUNTED ON A UNIT WHICH IS NOT ELIGIBLE TO */  00600000
*/*     THIS REQUEST, AN ERROR RETURN CODE IS SET AND NO FURTHER     */ 00601000
*/*     PROCESSING IS DONE.                                          */ 00602000
*/*                                                                  */ 00603000
*/*   OPERATION - (THE OPERATION IS DOCUMENTED BY THE CODE ITSELF)   */ 00604000
*/*                                                                  */ 00605000
*/* ENTRY - (INLINE SUBROUTINE)                                      */ 00606000
*/*                                                                  */ 00607000
*/*   INPUT -                                                        */ 00608000
*/*     INVUPTR -PTR TO THE REQUEST BEING VALITIDY-CHECKED           */ 00609000
*/*      VOLID - REQUESTED VOLUME SERIAL NUMBER                      */ 00610000
*/*      VOLUNTID - UNIT ID                                          */ 00611000
*/*     SIOTPTR - PTR TO SIOT TO ALLOCATE                            */ 00612000
*/*     ALCWAPTR - PTR TO ALLOCATION WORK AREA                       */ 00613000
*/*     UCBPTR - PTR TO UNIT WHERE THE (NON-REMOVABLE) VOL IS MOUNTED*/ 00614000
*/*     FNDGRPID - DEVICE GROUP WHERE THE VOLUME IS MOUNTED          */ 00615000
*/*                                                                  */ 00616000
*/* EXIT - NORMAL - (INLINE SUBROUTINE)                              */ 00617000
*/*                                                                  */ 00618000
*/*   CONDITIONS - REQUEST ALLOCATED SUCCESSFULLY                    */ 00619000
*/*                                                                  */ 00620000
*/*   OUTPUT -                                                       */ 00621000
*/*     .VOLALOC=1 AND TOTVOLUN (IN ALCWA) DECREMENTED               */ 00622000
*/*     .(POSSIBLY) SIOTALCD=1 AND TOTREQS (IN ALCWA) DECREMENTED    */ 00623000
*/*                                                                  */ 00624000
*/*   RETURN CODES - RTNCODE = 0                                     */ 00625000
*/*                                                                  */ 00626000
*/* EXIT - ERROR - (INLINE SUBROUTINE)                               */ 00627000
*/*                                                                  */ 00628000
*/*   CONDITIONS - VOLUME NOT ELIGIBLE WHERE MOUNTED                 */ 00629000
*/*                                                                  */ 00630000
*/*   OUTPUT - SIOT ERROR REASON CODE = 58                           */ 00631000
*/*                                                                  */ 00632000
*/*   RETURN CODES - RTNCODE = NON-ZERO                              */ 00633000
*/*                                                                  */ 00634000
*/* EXIT - ERROR - (INLINE SUBROUTINE)                               */ 00635000
*/*                                                                  */ 00636000
*/*   CONDITIONS - ONE OF THE CALLED ROUTINES DETECTED AN ERROR      */ 00637000
*/*                CONDITION.                                        */ 00638000
*/*                                                                  */ 00639000
*/*   OUTPUT -                                                       */ 00640000
*/*     STEP- OR DD-RELATED ERROR REASON CODE SET BY IEFAB442        */ 00641000
*/*     OR IEFAB434.                                                 */ 00642000
*/*                                                                  */ 00643000
*/*   RETURN CODES - RTNCODE = NON-ZERO                              */ 00644000
*/*                                                                  */ 00645000
*/********************************************************************/ 00646000
*/********************************************************************/ 00647000
*/*                                                                  */ 00648000
*/* SEGMENT NAME - SERCHEDL                                          */ 00649000
*/*                                                                  */ 00650000
*/* DESCRIPTIVE NAME - DETERMINE IF UCB IS IN THE EDL                */ 00651000
*/*                                                                  */ 00652000
*/* FUNCTION - THIS ROUTINE DETERMINES IF A PARTICULAR UCB IS IN     */ 00653000
*/*            A SIOT'S ELIGIBLE DEVICES LIST (EDL).                 */ 00654000
*/*                                                                  */ 00655000
*/*   OPERATION - THE SIOT'S EDL IS SEARCHED                         */ 00656000
*/*                                                                  */ 00657000
*/* ENTRY - (INLINE SUBROUTINE)                                      */ 00658000
*/*                                                                  */ 00659000
*/*   INPUT -                                                        */ 00660000
*/*     UCBPTR - PTR TO THE UCB TO BE SEARCHED FOR                   */ 00661000
*/*     SIOTPTR - PTR TO THE SIOT ASSOCIATED WITH THE VU ENTRY       */ 00662000
*/*       SIOTEDLP - PTR TO EDL FOR THE SIOT                         */ 00663000
*/*                                                                  */ 00664000
*/* EXIT - NORMAL - (INLINE SUBROUTINE)                              */ 00665000
*/*                                                                  */ 00666000
*/*   CONDITIONS - FUNCTION COMPLETED.                               */ 00667000
*/*                                                                  */ 00668000
*/*   OUTPUT -                                                       */ 00669000
*/*     UCBMATSW - 1 = UCB IS IN THE EDL                             */ 00670000
*/*              - 0 = UCB IS NOT IN THE EDL                         */ 00671000
*/*                                                                  */ 00672000
*/*   RETURN CODES - (NONE)                                          */ 00673000
*/*                                                                  */ 00674000
*/********************************************************************/ 00675000
*UCBMATSW = OFF;                                                03S0193 00676000
         NI    UCBMATSW,B'11110111'                             03S0193 00677000
*EDLPTR = EDLFGENP;                    /*POINT TO 1ST GEN IN EDL     */ 00678000
         L     @10,SIOTPTR                                      03S0194 00679000
         L     @10,SIOTEDLP(,@10)                               03S0194 00680000
         L     EDLPTR,EDLFGENP(,@10)                            03S0194 00681000
*DO WHILE (EDLPTR^=ZERO & UCBMATSW=OFF); /*SCAN UNTIL UCB IS FOUND   */ 00682000
         B     @DE00195                                         03S0195 00683000
@DL00195 DS    0H                                               03S0196 00684000
*  EDLGNTP = EDLGRPTR;                 /*POINT TO 1ST GROUP IN GEN   */ 00685000
         L     EDLGNTP,EDLGRPTR(,EDLPTR)                        03S0196 00686000
*  DO WHILE (EDLGNTP^=ZERO & UCBMATSW=OFF);/*SCAN ALL GROUPS         */ 00687000
         B     @DE00197                                         03S0197 00688000
@DL00197 DS    0H                                               03S0198 00689000
*    EDLUCBLP = EDLLISTP;              /*POINT TO LIST OF UCBS       */ 00690000
         L     EDLUCBLP,EDLLISTP(,EDLGNTP)                      03S0198 00691000
*    DO DEVCTR=ONE TO EDLUCBNO         /*SCAN ALL UCBS               */ 00692000
*        WHILE UCBMATSW = OFF;                                  03S0199 00693000
         LA    DEVCTR,1                                         03S0199 00694000
         B     @DE00199                                         03S0199 00695000
@DL00199 TM    UCBMATSW,B'00001000'                             03S0199 00696000
         BNZ   @DC00199                                         03S0199 00697000
*      IF EDLUCBAD(DEVCTR) = UCBPTR THEN /*UNIT WITH REQ'D VOL MT'D ?*/ 00698000
         LR    @10,DEVCTR                                       03S0200 00699000
         SLA   @10,2                                            03S0200 00700000
         ALR   @10,EDLUCBLP                                     03S0200 00701000
         AL    @10,@CF01096                                     03S0200 00702000
         SLR   @15,@15                                          03S0200 00703000
         ICM   @15,3,EDLUCBAD(@10)                              03S0200 00704000
         C     @15,UCBPTR                                       03S0200 00705000
         BNE   @RF00200                                         03S0200 00706000
*        DO;                           /*YES, END SEARCH             */ 00707000
*          UCBMATSW = ON;                                       03S0202 00708000
         OI    UCBMATSW,B'00001000'                             03S0202 00709000
*        END;                                                   03S0203 00710000
*      ELSE;                           /*NOT UNIT WITH REQ'D VOL MT'D*/ 00711000
@RF00200 DS    0H                                               03S0205 00712000
*    END;                                                       03S0205 00713000
         AH    DEVCTR,@CH00048                                  03S0205 00714000
@DE00199 C     DEVCTR,EDLUCBNO(,EDLGNTP)                        03S0205 00715000
         BNH   @DL00199                                         03S0205 00716000
@DC00199 DS    0H                                               03S0206 00717000
*    EDLGNTP = EDLNXGRP;               /*POINT TO NEXT GROUP         */ 00718000
         L     EDLGNTP,EDLNXGRP(,EDLGNTP)                       03S0206 00719000
*  END;                                                         03S0207 00720000
@DE00197 LTR   EDLGNTP,EDLGNTP                                  03S0207 00721000
         BZ    @DC00197                                         03S0207 00722000
         TM    UCBMATSW,B'00001000'                             03S0207 00723000
         BZ    @DL00197                                         03S0207 00724000
@DC00197 DS    0H                                               03S0208 00725000
*  EDLPTR = EDLNXTNT;                  /*POINT TO NEXT GENERIC       */ 00726000
         L     EDLPTR,EDLNXTNT(,EDLPTR)                         03S0208 00727000
*END;                                                           03S0209 00728000
@DE00195 LTR   EDLPTR,EDLPTR                                    03S0209 00729000
         BZ    @DC00195                                         03S0209 00730000
         TM    UCBMATSW,B'00001000'                             03S0209 00731000
         BZ    @DL00195                                         03S0209 00732000
@DC00195 DS    0H                                               03S0210 00733000
*    IF UCBMATSW = ON & FAILFIXD = OFF THEN /*OK TO ALLOCATE ?       */ 00734000
         TM    UCBMATSW,B'00001000'                             02S0210 00735000
         BNO   @RF00210                                         02S0210 00736000
         L     @10,@PC00001                                     02S0210 00737000
         TM    FAILFIXD(@10),B'10000000'                        02S0210 00738000
         BNZ   @RF00210                                         02S0210 00739000
*      DO;                             /*YES,BREAK AFFINITY,THEN ALOC*/ 00740000
*        CALL IEFAB442 (FUNC442,ALCWAPTR,INVUPTR->VOLID,        02S0212 00741000
*                       INVUPTR->VOLUNTID); /*AFFINITY REMOVER       */ 00742000
         LA    @10,@CB00137                                     02S0212 00743000
         ST    @10,@AL00001                                     02S0212 00744000
         L     @10,@PC00001+4                                   02S0212 00745000
         ST    @10,@AL00001+4                                   02S0212 00746000
         L     @10,@PC00001+8                                   02S0212 00747000
         L     @10,INVUPTR(,@10)                                02S0212 00748000
         ST    @10,@AL00001+8                                   02S0212 00749000
         LA    @10,VOLUNTID(,@10)                               02S0212 00750000
         ST    @10,@AL00001+12                                  02S0212 00751000
         L     @15,@CV00164                                     02S0212 00752000
         LA    @01,@AL00001                                     02S0212 00753000
         BALR  @14,@15                                          02S0212 00754000
*        RTNCODE = REG15;              /*SAVE THE RETURN CODE        */ 00755000
         LR    RTNCODE,REG15                                    02S0213 00756000
*        IF RTNCODE = SUCCESS THEN     /*ANY ERRORS ?                */ 00757000
         SLR   @10,@10                                          02S0214 00758000
         CR    RTNCODE,@10                                      02S0214 00759000
         BNE   @RF00214                                         02S0214 00760000
*          DO;                         /*NO ERROR, ALLOCATE THE REQ  */ 00761000
*/********************************************************************/ 00762000
*/*                                                                  */ 00763000
*/* SEGMENT NAME - SETUPARU                                          */ 00764000
*/*                                                                  */ 00765000
*/* DESCRIPTIVE - SET UP PARAMETERS FOR IEFAB434                     */ 00766000
*/*                                                                  */ 00767000
*/* FUNCTION -                                                       */ 00768000
*/*     THIS ROUTINE SETS UP THE FUNCTION MAP FOR THE ALLOCATE-      */ 00769000
*/*     REQUEST-TO-UNIT ROUTINE (IEFAB434). IN ADDITION THIS ROUTINE */ 00770000
*/*     DETERMINES THE RELATIVE POSITION OF THE TIOT DEVICE ENTRY TO */ 00771000
*/*     BE ALLOCATED AND IF NO TIOT ENTRY EXISTS FOR THE SIOT, THE   */ 00772000
*/*     TOTAL NUMBER OF DEVICE ENTRIES NEEDED (SIOTOTUN)             */ 00773000
*/*                                                                  */ 00774000
*/*   OPERATION - THE RELATIVE DEVICE ENTRY IS DETERMINED BY         */ 00775000
*/*               SCANNING THE VU ENTRIES FOR THIS SIOT UNTIL THE    */ 00776000
*/*               ENTRY TO BE ALLOCATED IS REACHED. ALL DEVICE-REQ'D */ 00777000
*/*               ENTRIES UP TO THAT POINT ARE COUNTED.              */ 00778000
*/*                                                                  */ 00779000
*/* ENTRY - (INLINE SUBROUTINE)                                      */ 00780000
*/*                                                                  */ 00781000
*/*   INPUT -                                                        */ 00782000
*/*     UCBPTR - PTR TO THE UNIT TO BE ALLOCATED                     */ 00783000
*/*     SIOTPTR - PTR TO THE SIOT BEING ALLOCATED                    */ 00784000
*/*       SIOTETIO - PTR TO ETIOT OR 0                               */ 00785000
*/*       SIOTOTUN - NUMBER OF DEVICES NEEDED BY THE SIOT            */ 00786000
*/*       SVOLUNAD - PTR TO FIRST VOLUNIT ENTRY FOR THIS SIOT        */ 00787000
*/*     INVUPTR - PTR TO THE VOLUNIT ENTRY TO BE ALLOCATED           */ 00788000
*/*                                                                  */ 00789000
*/* EXIT - NORMAL - (INLINE SUBROUTINE)                              */ 00790000
*/*                                                                  */ 00791000
*/*   CONDITION - FUNCTION COMPLETED                                 */ 00792000
*/*                                                                  */ 00793000
*/*   OUTPUT -                                                       */ 00794000
*/*     FUNC434 - FUNCTION MAP FOR IEFAB434, WHICH CONTAINS          */ 00795000
*/*       BIT0  - 1 = UPDATE TIOT (IF TIOT ALREADY EXISTED)          */ 00796000
*/*             - 0 = CREATE TIOT ENTRY                              */ 00797000
*/*       BIT1  - 0 = (NOT USED BY IEFAB434)                         */ 00798000
*/*       BIT2  - 1 = PROCESS AFFINITIES                             */ 00799000
*/*       BIT3  - 0 = DON'T VALIDITY CHECK                           */ 00800000
*/*       BIT4  - 0 = DON'T UPDATE USE ATTRIBUTE                     */ 00801000
*/*       BIT5  - 1 = UPDATE ALGORITHM TABLES                        */ 00802000
*/*       BIT6  - 0 = NO VOLUME SWITCHING (AND NOT NEEDED)           */ 00803000
*/*    DEVSSIOT = NUMBER OF DEVICE ENTRIES NEEDED IN THE TIOT FOR    */ 00804000
*/*               THE SIOT                                           */ 00805000
*/*    DEVSENT = RELATIVE POSITION OF THE TIOT DEVICE ENTRY TO BE    */ 00806000
*/*              CREATED                                             */ 00807000
*/*                                                                  */ 00808000
*/********************************************************************/ 00809000
*FUNC434 = FUNC434 && FUNC434;         /*ZERO FUNC MAP FOR IEFAB434  */ 00810000
         XC    FUNC434(4),FUNC434                               03S0216 00811000
*AFFFLAG = ON;                         /*INDICATE PROCESS-AFFINITIES */ 00812000
*UPALGTB = ON;                         /*INDICATE UPDATE-ALG-TABLES  */ 00813000
         OI    AFFFLAG,B'00100100'                              03S0218 00814000
*VOLID434 = UCBVOLI;                   /*COPY VOLUME SERIAL          */ 00815000
         L     @01,UCBPTR                                       03S0219 00816000
         MVC   VOLID434(6),UCBVOLI(@01)                         03S0219 00817000
*IF SIOTETIO = ZERO THEN               /*DOES A TIOT ALREADY EXIST ? */ 00818000
         L     @15,SIOTPTR                                      03S0220 00819000
         C     @10,SIOTETIO(,@15)                               03S0220 00820000
         BNE   @RF00220                                         03S0220 00821000
*  DEVSSIOT = SIOTOTUN;                /*NO,COPY NUMBER OF TIOT 03S0221 00822000
*                                        DEVICE ENTRIES NEEDED       */ 00823000
         SLR   @10,@10                                          03S0221 00824000
         IC    @10,SIOTOTUN(,@15)                               03S0221 00825000
         STH   @10,DEVSSIOT                                     03S0221 00826000
*ELSE                                  /*TIOT ALREADY EXISTS         */ 00827000
*  UPDATIOT = ON;                      /*INDICATE UPDATE-TIOT FUNC   */ 00828000
         B     @RC00220                                         03S0222 00829000
@RF00220 OI    UPDATIOT,B'10000000'                             03S0222 00830000
*DEVSENT = ONE;                        /*INITIALIZE TIOT DEVICE ENTRY*/ 00831000
@RC00220 MVC   DEVSENT(2),@CH00048                              03S0223 00832000
*VUPTR = SVOLUNAD;                     /*POINT TO FIRST VU FOR SIOT  */ 00833000
         L     @10,SIOTPTR                                      03S0224 00834000
         L     VUPTR,SVOLUNAD(,@10)                             03S0224 00835000
*DO WHILE VUPTR < INVUPTR;             /*SCAN UP UNTIL THIS VU ENTRY */ 00836000
         B     @DE00225                                         03S0225 00837000
@DL00225 DS    0H                                               03S0226 00838000
*  IF VDEVREQD = ON THEN               /*DOES VU ENTRY REQUIRE A DEV */ 00839000
         TM    VDEVREQD(VUPTR),B'00100000'                      03S0226 00840000
         BNO   @RF00226                                         03S0226 00841000
*    DEVSENT = DEVSENT + ONE;          /*YES, INCREMENT COUNT        */ 00842000
         LH    @10,DEVSENT                                      03S0227 00843000
         LA    @10,1(,@10)                                      03S0227 00844000
         STH   @10,DEVSENT                                      03S0227 00845000
*  ELSE;                               /*VU DOES NOT REQUIRE A DEVICE*/ 00846000
@RF00226 DS    0H                                               03S0229 00847000
*  VUPTR = VUPTR + LENGTH(VOLUNTAB);   /*POINT TO NEXT VOLUNIT ENTRY */ 00848000
         AL    VUPTR,@CF00099                                   03S0229 00849000
*END;                                                           03S0230 00850000
@DE00225 L     @10,@PC00001+8                                   03S0230 00851000
         C     VUPTR,INVUPTR(,@10)                              03S0230 00852000
         BL    @DL00225                                         03S0230 00853000
*            CALL IEFAB434 (SIOTPTR,INVUPTR,UCBPTR,FUNC434,     02S0231 00854000
*                 ETIODATA,ALCWAPTR,FNDGRPID,ADDR(UCBPARMS));   02S0231 00855000
         LA    @02,SIOTPTR                                      02S0231 00856000
         ST    @02,@AL00001                                     02S0231 00857000
         ST    @10,@AL00001+4                                   02S0231 00858000
         LA    @10,UCBPTR                                       02S0231 00859000
         ST    @10,@AL00001+8                                   02S0231 00860000
         LA    @10,FUNC434                                      02S0231 00861000
         ST    @10,@AL00001+12                                  02S0231 00862000
         LA    @10,ETIODATA                                     02S0231 00863000
         ST    @10,@AL00001+16                                  02S0231 00864000
         L     @10,@PC00001+4                                   02S0231 00865000
         ST    @10,@AL00001+20                                  02S0231 00866000
         LA    @10,FNDGRPID                                     02S0231 00867000
         ST    @10,@AL00001+24                                  02S0231 00868000
         LA    @10,UCBPARMS                                     02S0231 00869000
         ST    @10,@TF00001                                     02S0231 00870000
         LA    @10,@TF00001                                     02S0231 00871000
         ST    @10,@AL00001+28                                  02S0231 00872000
         L     @15,@CV00163                                     02S0231 00873000
         LA    @01,@AL00001                                     02S0231 00874000
         BALR  @14,@15                                          02S0231 00875000
*            RTNCODE = REG15;          /*SAVE THE RETURN CODE        */ 00876000
         LR    RTNCODE,REG15                                    02S0232 00877000
*/********************************************************************/ 00878000
*/*                                                                  */ 00879000
*/* SEGMENT NAME - DOARURTN                                          */ 00880000
*/*                                                                  */ 00881000
*/* DESCRIPTIVE NAME - PROCESS RETURN FROM IEFAB434                  */ 00882000
*/*                                                                  */ 00883000
*/* FUNCTION -                                                       */ 00884000
*/*     IF IEFAB434 SUCCESSFULLY ALLOCATED THE REQUEST, THIS         */ 00885000
*/*     ROUTINE MARKS THE VOLUNIT ENTRY ALLOCATED. IF THIS WAS       */ 00886000
*/*     THE ONLY VOLUNIT ENTRY FOR THE SIOT WHICH WAS LEFT TO BE     */ 00887000
*/*     ALLOCATED THEN THE SIOT IS MARKED ALLOCATED AND THE          */ 00888000
*/*     COUNT OF THE NUMBER OF STILL-UNALLOCATED SIOTS (TOTREQS)  IS */ 00889000
*/*     DECREMENTED.                                                 */ 00890000
*/*                                                                  */ 00891000
*/*   OPERATION - ALL THE VOLUNIT ENTRIES FOR THE SIOT ARE SCANNED   */ 00892000
*/*               TO DETERMINE IF THE SIOT IS NOW FULLY ALLOCATED.   */ 00893000
*/*                                                                  */ 00894000
*/* ENTRY - (INLINE SUBROUTINE)                                      */ 00895000
*/*                                                                  */ 00896000
*/*   INPUT -                                                        */ 00897000
*/*      RTNCODE - RETURN CODE FROM IEFAB434                         */ 00898000
*/*      INVUPTR - PTR TO THE VOLUNIT ENTRY TO BE ALLOCATED          */ 00899000
*/*      SIOTPTR - PTR TO THE SIOT BEING PROCESSED                   */ 00900000
*/*      ALCWAPTR - PTR TO THE ALLOCATION WORK AREA , WHICH CONTAINS */ 00901000
*/*        TOTVOLUN - NUMBER OF VOLUNIT ENTRIES STILL UNALLOCATED    */ 00902000
*/*        TOTREQS - NUMBER OF SIOTS STILL UNALLOCATED               */ 00903000
*/*                                                                  */ 00904000
*/* EXIT - NORMAL - (INLINE SUBROUTINE)                              */ 00905000
*/*                                                                  */ 00906000
*/*   CONDITIONS - THE REQUEST WAS ALLOCATED SUCCESSFULLY            */ 00907000
*/*                                                                  */ 00908000
*/*   OUTPUT -                                                       */ 00909000
*/*     .VOLALOC=1 AND TOTVOLUN DECREMENTED                          */ 00910000
*/*     .(POSSIBLY) SIOTALCD=1 AND TOTREQS DECREMENTED               */ 00911000
*/*                                                                  */ 00912000
*/*   RETURN CODES - RTNCODE = 0                                     */ 00913000
*/*                                                                  */ 00914000
*/* EXIT - ERROR - (INLINE SUBROUTINE)                               */ 00915000
*/*                                                                  */ 00916000
*/*   CONDITIONS - ERROR DETECTED                                    */ 00917000
*/*                                                                  */ 00918000
*/*   OUTPUT -                                                       */ 00919000
*/*       STEP- OR DD-RELATED ERROR REASON CODE SET BY IEFAB434      */ 00920000
*/*                                                                  */ 00921000
*/*   RETURN CODES - RTNCODE = NON-ZERO                              */ 00922000
*/*                                                                  */ 00923000
*/********************************************************************/ 00924000
*IF RTNCODE = SUCCESS THEN             /*ANY ERROR FROM IEFAB434     */ 00925000
         LTR   RTNCODE,RTNCODE                                  03S0233 00926000
         BNZ   @RF00233                                         03S0233 00927000
*  DO;                                 /*NO ERROR, PROCESS           */ 00928000
*    INVUPTR->VOLALOC = ON;            /*MARK VOLUNIT ENTRY ALLOCATED*/ 00929000
         L     @10,@PC00001+8                                   03S0235 00930000
         L     @10,INVUPTR(,@10)                                03S0235 00931000
         OI    VOLALOC(@10),B'10000000'                         03S0235 00932000
*    TOTVOLUN = TOTVOLUN - ONE;        /*DECREMENT COUNT OF VU'S     */ 00933000
         L     @10,@PC00001+4                                   03S0236 00934000
         L     @10,ALCWAPTR(,@10)                               03S0236 00935000
         L     @15,TOTVOLUN(,@10)                               03S0236 00936000
         BCTR  @15,0                                            03S0236 00937000
         ST    @15,TOTVOLUN(,@10)                               03S0236 00938000
*    ALLALOC = ON;                     /*ASSUME SIOT IS FULLY ALLOC'D*/ 00939000
         OI    ALLALOC,B'10000000'                              03S0237 00940000
*    VUPTR = SVOLUNAD;                 /*POINT TO SIOT'S FIRST VU */    00941000
         L     @10,SIOTPTR                                      03S0238 00942000
         L     VUPTR,SVOLUNAD(,@10)                             03S0238 00943000
*    DO VUCTR = ONE TO SVOLUNNO        /*SCAN ALL VOLUNIT ENTRIES    */ 00944000
*        WHILE (ALLALOC = ON);                                  03S0239 00945000
         LA    VUCTR,1                                          03S0239 00946000
         B     @DE00239                                         03S0239 00947000
@DL00239 TM    ALLALOC,B'10000000'                              03S0239 00948000
         BNO   @DC00239                                         03S0239 00949000
*      IF (VDEVREQD=ON & VOLALOC=OFF)  /*HAS VU ENTRY BEEN SATISFIED?*/ 00950000
*          | VUDNALOC = ON THEN                                 03S0240 00951000
         TM    VDEVREQD(VUPTR),B'00100000'                      03S0240 00952000
         BNO   @GL00022                                         03S0240 00953000
         TM    VOLALOC(VUPTR),B'10000000'                       03S0240 00954000
         BZ    @RT00240                                         03S0240 00955000
@GL00022 TM    VUDNALOC(VUPTR),B'00001000'                      03S0240 00956000
         BNO   @RF00240                                         03S0240 00957000
@RT00240 DS    0H                                               03S0241 00958000
*        ALLALOC = OFF;                /*INDICATE SIOT NOT ALL ALOC'D*/ 00959000
         NI    ALLALOC,B'01111111'                              03S0241 00960000
*      ELSE;                           /*SIOT STILL ALL ALLOCATED    */ 00961000
@RF00240 DS    0H                                               03S0243 00962000
*      VUPTR = VUPTR + LENGTH(VOLUNTAB); /*POINT TO NEXT VOLUNIT ENT */ 00963000
         AL    VUPTR,@CF00099                                   03S0243 00964000
*    END;                                                       03S0244 00965000
         AH    VUCTR,@CH00048                                   03S0244 00966000
@DE00239 L     @10,SIOTPTR                                      03S0244 00967000
         CH    VUCTR,SVOLUNNO(,@10)                             03S0244 00968000
         BNH   @DL00239                                         03S0244 00969000
@DC00239 DS    0H                                               03S0245 00970000
*    IF ALLALOC=ON                     /*IS SIOT FULLY ALLOCATED NOW?*/ 00971000
*        & SIOTALCD=OFF THEN                                    03S0245 00972000
         TM    ALLALOC,B'10000000'                              03S0245 00973000
         BNO   @RF00245                                         03S0245 00974000
         L     @10,SIOTPTR                                      03S0245 00975000
         TM    SIOTALCD(@10),B'00000010'                        03S0245 00976000
         BNZ   @RF00245                                         03S0245 00977000
*      DO;                             /*YES,MARK ALLOCATED          */ 00978000
*        SIOTALCD = ON;                                         03S0247 00979000
         OI    SIOTALCD(@10),B'00000010'                        03S0247 00980000
*        TOTREQS = TOTREQS - ONE;      /*DECREMENT REQS TO ALLOCATE  */ 00981000
         L     @10,@PC00001+4                                   03S0248 00982000
         L     @10,ALCWAPTR(,@10)                               03S0248 00983000
         L     @02,TOTREQS(,@10)                                03S0248 00984000
         BCTR  @02,0                                            03S0248 00985000
         ST    @02,TOTREQS(,@10)                                03S0248 00986000
*      END;                                                     03S0249 00987000
*    ELSE;                             /*SIOT NOT JUST FULLY ALLOC'D */ 00988000
@RF00245 DS    0H                                               03S0251 00989000
*  END;                                                         03S0251 00990000
*ELSE                                  /*ERROR FROM IEFAB434         */ 00991000
*  RTNCODE = ERROR;                                             03S0252 00992000
         B     @RC00233                                         03S0252 00993000
@RF00233 LA    RTNCODE,4                                        03S0252 00994000
*          END;                                                 02S0253 00995000
*        ELSE;                         /*ERROR FROM IEFAB442         */ 00996000
@RF00214 DS    0H                                               02S0255 00997000
*      END;                                                     02S0255 00998000
*    ELSE                              /*UCB NOT IN THE EDL          */ 00999000
*      DO;                                                      02S0256 01000000
         B     @RC00210                                         02S0256 01001000
@RF00210 DS    0H                                               02S0257 01002000
*        RTNCODE = ERROR;              /*SET ERROR RETURN CODE       */ 01003000
         LA    RTNCODE,4                                        02S0257 01004000
*        SIOTRSNC=ERRCD(3);            /*SET SIOT REASON CODE        */ 01005000
         L     @10,SIOTPTR                                      02S0258 01006000
         MVC   SIOTRSNC(2,@10),ERRCD+4                          02S0258 01007000
*      END;                                                     02S0259 01008000
*                    END;                                       01S0260 01009000
*                  ELSE                /*VOLUME NOT ON FIXED DEVICE  */ 01010000
*                    DO;                                        01S0261 01011000
         B     @RC00191                                         01S0261 01012000
@RF00191 DS    0H                                               01S0262 01013000
*                      GROUPNO = FNDGRPID; /*COPY GROUP ID OF VOLUME */ 01014000
         MVC   GROUPNO(4),FNDGRPID                              01S0262 01015000
*                      CALL TESTBIT;   /*TEST IF GROUP LOCKED        */ 01016000
         BAL   @14,TESTBIT                                      01S0263 01017000
*                      IF BITRTN = ON THEN /*IS THE GROUP LOCKED ?   */ 01018000
         TM    BITRTN,B'01000000'                               01S0264 01019000
         BNO   @RF00264                                         01S0264 01020000
*                        DO;           /*YES,VOLUME SWITCHING IS OK  */ 01021000
*                          IF UCBALOC = ON THEN /*IS THE UCB ALLOC'D? * 01022000
         L     @10,UCBPTR                                       01S0266 01023000
         TM    UCBALOC(@10),B'00001000'                         01S0266 01024000
         BNO   @RF00266                                         01S0266 01025000
*                            DO;       /*YES,INDICATE RECOVERY NEEDED*/ 01026000
*/********************************************************************/ 01027000
*/*                                                                  */ 01028000
*/* SEGMENT NAME - MARKWAIT                                          */ 01029000
*/*                                                                  */ 01030000
*/* DESCRIPTIVE NAME - MARK VU ENTRY - WAIT FOR ALLOCATED VOLUME     */ 01031000
*/*                                                                  */ 01032000
*/* FUNCTION - IF THIS ALLOCATION CAN'T WAIT, IT IS AN ERROR. OTHER- */ 01033000
*/*     WISE, THIS RTN MARKS THE TABLE ENTRIES FOR EACH REQUEST      */ 01034000
*/*     FOR THE INPUT VOLUME SERIAL NUMBER -- SO THAT ALLOCATION     */ 01035000
*/*     KNOWS THESE REQUESTS MUST WAIT FOR THE REQUESTED VOLUME      */ 01036000
*/*     TO BE UNALLOCATED FROM WHERE IT IS CURRENTLY LOCATED.        */ 01037000
*/*                                                                  */ 01038000
*/*   OPERATION - THE WHOLE VOLUNIT TABLE IS SCANNED.                */ 01039000
*/*                                                                  */ 01040000
*/* ENTRY - (INLINE SUBROUTINE)                                      */ 01041000
*/*                                                                  */ 01042000
*/*   INPUT -                                                        */ 01043000
*/*     INVUPTR - PTR TO THE VOLUNIT ENTRY BEING VALIDITY-CHECKED    */ 01044000
*/*       VOLID - VOLUME SERIAL NUMBER REQUESTED BY THIS VU ENTRY    */ 01045000
*/*     VOLUNSZE - SIZE OF THE VOLUNIT ENTRY                         */ 01046000
*/*     VOLUNPTR - PTR TO THE VOLUNIT TABLE                          */ 01047000
*/*       VOLALGTP - PTR IN VU ENTRY TO THE ASSOCIATED ALG REQ ENTRY */ 01048000
*/*     UCBPTR - PTR TO UNIT WHERE THE REQUESTED VOLUME IS MOUNTED   */ 01049000
*/*                                                                  */ 01050000
*/* EXIT - NORMAL - (INLINE SUBROUTINE)                              */ 01051000
*/*                                                                  */ 01052000
*/*   CONDITIONS - ALLOCATION ALLOWED TO WAIT. TABLES MARKED.        */ 01053000
*/*                                                                  */ 01054000
*/*   OUTPUT -                                                       */ 01055000
*/*    .VUVLUNIQ = 1 FOR THE INPUT VOLUNIT ENTRY                     */ 01056000
*/*    .WAITIGEN = 1                                                 */ 01057000
*/*    .THE FOLLOWING ARE SET FOR EACH REQUEST FOR THE INPUT         */ 01058000
*/*     VOLUME: VUDNALOC=1,VUVINELG=1, AND CVRWUCBP=PTR TO UNIT      */ 01059000
*/*             CONTAINING THE REQUESTED VOLUME                      */ 01060000
*/*                                                                  */ 01061000
*/*   RETURN CODES - (NONE)                                          */ 01062000
*/*                                                                  */ 01063000
*/* EXIT - ERROR - (INLINE SUBROUTINE)                               */ 01064000
*/*                                                                  */ 01065000
*/*   CONDITIONS - ALLOCATION NOT ALLOWED TO WAIT.                   */ 01066000
*/*                                                                  */ 01067000
*/*   OUTPUT - SIOT ERROR REASON CODE = 59                           */ 01068000
*/*                                                                  */ 01069000
*/*   RETURN CODES - RTNCODE = 4                                     */ 01070000
*/*                                                                  */ 01071000
*/********************************************************************/ 01072000
*IF UWAITSW = ON THEN                  /*OK TO WAIT ?                */ 01073000
         L     @10,@PC00001+4                                   02S0268 01074000
         L     @10,ALCWAPTR(,@10)                               02S0268 01075000
         L     @02,FMAPPTR(,@10)                                02S0268 01076000
         TM    UWAITSW(@02),B'00100000'                         02S0268 01077000
         BNO   @RF00268                                         02S0268 01078000
*  DO;                                                          02S0269 01079000
*    INVUPTR->VUVLUNIQ = ON;           /*MARK ONE AS UNIQUE - REQ    */ 01080000
         L     @15,@PC00001+8                                   02S0270 01081000
         L     @01,INVUPTR(,@15)                                02S0270 01082000
         OI    VUVLUNIQ(@01),B'00000010'                        02S0270 01083000
*    WAITIGEN = ON;                    /*INDICATE SOME UCBS WAITED ON*/ 01084000
         OI    WAITIGEN(@10),B'01000000'                        02S0271 01085000
*    VUPTR = VOLUNPTR;                 /*POINT TO THE FIRST VU ENTRY */ 01086000
         L     VUPTR,VOLUNPTR(,@10)                             02S0272 01087000
*    DO VUCTR = ONE TO VOLUNSZE/LENGTH(VOLUNTAB);/*SCAN VOLUNIT TABLE*/ 01088000
         LA    VUCTR,1                                          02S0273 01089000
         B     @DE00273                                         02S0273 01090000
@DL00273 DS    0H                                               02S0274 01091000
*      IF VOLID = INVUPTR->VOLID THEN  /*DOES REQ NEED INPUT VOLUME? */ 01092000
         L     @10,@PC00001+8                                   02S0274 01093000
         L     @10,INVUPTR(,@10)                                02S0274 01094000
         CLC   VOLID(6,VUPTR),VOLID(@10)                        02S0274 01095000
         BNE   @RF00274                                         02S0274 01096000
*        DO;                           /*YES,MARK IT FOR RECOVERY    */ 01097000
*          VUDNALOC = ON;                                       02S0276 01098000
         OI    VUDNALOC(VUPTR),B'00001000'                      02S0276 01099000
*          VOLALGTP->CVRWUCBP=UCBPTR;  /*COPY PTR TO VOLUME LOCATION */ 01100000
         L     @10,VOLALGTP(,VUPTR)                             02S0277 01101000
         MVC   CVRWUCBP(2,@10),UCBPTR+2                         02S0277 01102000
*        END;                                                   02S0278 01103000
*      ELSE;                           /*REQ DOESN'T NEED THIS VOLUME*/ 01104000
@RF00274 DS    0H                                               02S0280 01105000
*      VUPTR = VUPTR + LENGTH(VOLUNTAB); /*POINT TO THE NEXT VU ENTRY*/ 01106000
         AL    VUPTR,@CF00099                                   02S0280 01107000
*    END;                                                       02S0281 01108000
         AH    VUCTR,@CH00048                                   02S0281 01109000
@DE00273 L     @10,@PC00001+4                                   02S0281 01110000
         L     @10,ALCWAPTR(,@10)                               02S0281 01111000
         L     @00,VOLUNSZE(,@10)                               02S0281 01112000
         SRDA  @00,32                                           02S0281 01113000
         D     @00,@CF00099                                     02S0281 01114000
         CR    VUCTR,@01                                        02S0281 01115000
         BNH   @DL00273                                         02S0281 01116000
*  END;                                                         02S0282 01117000
*ELSE                                  /*CAN'T WAIT FOR VOL TO  02S0283 01118000
*                                        UNALLOCATE                  */ 01119000
*  DO;                                                          02S0283 01120000
         B     @RC00268                                         02S0283 01121000
@RF00268 DS    0H                                               02S0284 01122000
*    RTNCODE = ERROR;                  /*SET ERROR RETURN CODE       */ 01123000
         LA    RTNCODE,4                                        02S0284 01124000
*    SIOTRSNC = ERRCD(4);              /*SET SIOT REASON CODE        */ 01125000
         L     @10,SIOTPTR                                      02S0285 01126000
         MVC   SIOTRSNC(2,@10),ERRCD+6                          02S0285 01127000
*  END;                                                         02S0286 01128000
*                            END;                               01S0287 01129000
*                          ELSE        /*UCB IS UNALLOC'D - UNLOAD IT*/ 01130000
*                            DO;                                01S0288 01131000
         B     @RC00266                                         01S0288 01132000
@RF00266 DS    0H                                               01S0289 01133000
*/********************************************************************/ 01134000
*/*                                                                  */ 01135000
*/* SEGMENT NAME - UNLDVOL                                           */ 01136000
*/*                                                                  */ 01137000
*/* DESCRIPTIVE NAME - UNLOAD A VOLUME NEEDED ELSEWHERE              */ 01138000
*/*                                                                  */ 01139000
*/* FUNCTION -                                                       */ 01140000
*/*   THIS ROUTINE SETS UP THE INTERFACE FOR AND INVOKES THE         */ 01141000
*/*   VOLUME MOUNT + VERIFY (VM+V) UNLOAD FUNCTION TO UNLOAD A       */ 01142000
*/*   VOLUME.                                                        */ 01143000
*/*                                                                  */ 01144000
*/*   OPERATION - (THE OPERATION IS DOCUMENTED BY THE CODE ITSELF)   */ 01145000
*/*                                                                  */ 01146000
*/* ENTRY - (INLINE SUBROUTINE)                                      */ 01147000
*/*                                                                  */ 01148000
*/*   PURPOSE - (SEE FUNCTION)                                       */ 01149000
*/*                                                                  */ 01150000
*/*   INPUT -                                                        */ 01151000
*/*      UCBPTR - PTR TO UNIT TO UNLOAD                              */ 01152000
*/*      ALCWAPTR - PTR TO THE ALLOCATION WORK AREA                  */ 01153000
*/*        ALCJOBN - JOB NAME                                        */ 01154000
*/*        ALCSTEPN - STEP NAME                                      */ 01155000
*/*        ALCWASID - ASID                                           */ 01156000
*/*        CANCELP - PTR TO CANCEL ECB                               */ 01157000
*/*                                                                  */ 01158000
*/* EXIT - NORMAL - (INLINE SUBROUTINE)                              */ 01159000
*/*                                                                  */ 01160000
*/*   CONDITION - VOLUME UNLOADED                                    */ 01161000
*/*                                                                  */ 01162000
*/*   OUTPUT - (NONE)                                                */ 01163000
*/*                                                                  */ 01164000
*/*   RETURN CODES - RTNCODE = 0                                     */ 01165000
*/*                                                                  */ 01166000
*/* EXIT - EXIT - (INLINE SUBROUTINE)                                */ 01167000
*/*                                                                  */ 01168000
*/*   CONDITION - GETMAIN ERROR BY VM+V                              */ 01169000
*/*                                                                  */ 01170000
*/*   OUTPUT - STEP REASON CODE, REASONCD, SET TO 2                  */ 01171000
*/*                                                                  */ 01172000
*/*   RETURN CODES - RTNCODE = 4                                     */ 01173000
*/*                                                                  */ 01174000
*/********************************************************************/ 01175000
*VMVREQBP = ADDR(VMVRBCOR);            /*POINT TO VM+V REQUEST BLOCK */ 01176000
         LA    @10,VMVRBCOR                                     02S0289 01177000
         ST    @10,VMVREQBP                                     02S0289 01178000
*VMVRQBLK = VMVRQBLK && VMVRQBLK;      /*ZERO THE REQUEST BLOCK      */ 01179000
         XC    VMVRQBLK(52,@10),VMVRQBLK(@10)                   02S0290 01180000
*VMVUNLOD = ON;                        /*INDICATE UNLOAD FUNCTION    */ 01181000
*VMVUCB = ON;                          /*UNLOAD VOLSER IS IN THE UCB */ 01182000
         OI    VMVUNLOD(@10),B'11000000'                        02S0292 01183000
*VMVJBNMP = ADDR(ALCJOBN);             /*POINT TO JOB NAME           */ 01184000
         L     @02,@PC00001+4                                   02S0293 01185000
         L     @02,ALCWAPTR(,@02)                               02S0293 01186000
         L     @15,TIOTHDRP(,@02)                               02S0293 01187000
         ST    @15,VMVJBNMP(,@10)                               02S0293 01188000
*VMVJSNMP = ADDR(ALCSTEPN);            /*POINT TO STEP NAME          */ 01189000
         LA    @15,ALCSTEPN(,@15)                               02S0294 01190000
         ST    @15,VMVJSNMP(,@10)                               02S0294 01191000
*VMVUCBP = UCBPTR;                     /*POINT TO UCB TO BE UNLOADED */ 01192000
         MVC   VMVUCBP(3,@10),UCBPTR+1                          02S0295 01193000
*CALL IEFAB49C (VMVREQBP,ALCWASID,CANCLECB); /*CALL VM+V             */ 01194000
         LA    @10,VMVREQBP                                     02S0296 01195000
         ST    @10,@AL00001                                     02S0296 01196000
         LA    @10,ALCWASID(,@02)                               02S0296 01197000
         ST    @10,@AL00001+4                                   02S0296 01198000
         L     @10,CANCELP(,@02)                                02S0296 01199000
         ST    @10,@AL00001+8                                   02S0296 01200000
         L     @15,@CV00165                                     02S0296 01201000
         LA    @01,@AL00001                                     02S0296 01202000
         BALR  @14,@15                                          02S0296 01203000
*RTNCODE = REG15;                      /*SAVE THE RETURN CODE        */ 01204000
         LR    RTNCODE,REG15                                    02S0297 01205000
*IF RTNCODE ^= SUCCESS THEN            /*ANY ERRORS ?                */ 01206000
         LTR   RTNCODE,RTNCODE                                  02S0298 01207000
         BZ    @RF00298                                         02S0298 01208000
*  REASONCD = GETMNERR;                /*YES,INDICATE A GETMAIN ERROR*/ 01209000
         L     @10,@PC00001+4                                   02S0299 01210000
         L     @10,ALCWAPTR(,@10)                               02S0299 01211000
         L     @10,FAILRSCP(,@10)                               02S0299 01212000
         MVC   REASONCD(2,@10),@CH00112                         02S0299 01213000
*ELSE;                                 /*NO ERROR                    */ 01214000
@RF00298 DS    0H                                               02S0301 01215000
*                            END;                               01S0301 01216000
*                        END;                                   01S0302 01217000
*                      ELSE            /*VOLUME SWITCH CAN'T BE DONE */ 01218000
*                        DO;                                    01S0303 01219000
         B     @RC00264                                         01S0303 01220000
@RF00264 DS    0H                                               01S0304 01221000
*                          INDRETRY = ON;  /*INDICATE RETRY NEEDED   */ 01222000
         L     @10,@PC00001+4                                   01S0304 01223000
         L     @10,ALCWAPTR(,@10)                               01S0304 01224000
         OI    INDRETRY(@10),B'01000000'                        01S0304 01225000
*                          SIOTRTRY = ON;                       01S0305 01226000
         L     @10,SIOTPTR                                      01S0305 01227000
         OI    SIOTRTRY(@10),B'00000001'                        01S0305 01228000
*                        END;                                   01S0306 01229000
*                    END;                                       01S0307 01230000
*                END;                                           01S0308 01231000
*              ELSE;                   /*TAPE DEVICE TYPE NOT LOCKED */ 01232000
@RF00189 DS    0H                                               01S0310 01233000
*            END;                                               01S0310 01234000
@RC00189 DS    0H                                               01S0311 01235000
*        END;                                                   01S0311 01236000
@RC00183 DS    0H                                               01S0312 01237000
*      IF RTNCODE ^= SUCCESS           /*ERROR ON NOT-DEV-REQ'D REQ? */ 01238000
*          & SIOTRSNC^=ZERO                                     01S0312 01239000
*          &INVUPTR->VDEVREQD = OFF THEN                        01S0312 01240000
@RC00097 DS    0H                                               01S0312 01241000
@RC00092 SLR   @10,@10                                          01S0312 01242000
         CR    RTNCODE,@10                                      01S0312 01243000
         BE    @RF00312                                         01S0312 01244000
         L     @02,SIOTPTR                                      01S0312 01245000
         CH    @10,SIOTRSNC(,@02)                               01S0312 01246000
         BE    @RF00312                                         01S0312 01247000
         L     @10,@PC00001+8                                   01S0312 01248000
         L     @10,INVUPTR(,@10)                                01S0312 01249000
         TM    VDEVREQD(@10),B'00100000'                        01S0312 01250000
         BNZ   @RF00312                                         01S0312 01251000
*        NODEVERR = ON;                /*YES,INDICATE IN ALCWA       */ 01252000
         L     @10,@PC00001+4                                   01S0313 01253000
         L     @10,ALCWAPTR(,@10)                               01S0313 01254000
         OI    NODEVERR(@10),B'00001000'                        01S0313 01255000
*      ELSE;                           /*NO ERROR OR DEVICE-REQ'D    */ 01256000
@RF00312 DS    0H                                               01S0315 01257000
*  END;                                                         01S0315 01258000
*ELSE;                                 /*VOLUME IS NOT MOUNTED       */ 01259000
@RF00090 DS    0H                                               01S0317 01260000
*RETURN CODE(RTNCODE);                 /*RETURN TO CALLER            */ 01261000
         IC    @02,@OLDKEY                                      01S0317 01262000
         L     @13,4(,@13)                                      01S0317 01263000
         L     @00,@SIZDATD                                     01S0317 01264000
         LR    @01,@11                                          01S0317 01265000
         FSPACE   R,LV=(0),A=(1)                                        01266000
         MODESET KEYADDR=(2)                                            01267000
         LR    @15,@03                                          01S0317 01268000
         L     @14,12(,@13)                                     01S0317 01269000
         LM    @00,@12,20(@13)                                  01S0317 01270000
         BR    @14                                              01S0317 01271000
*TESTBIT: PROC;                                                 02S0318 01272000
TESTBIT  STM   @14,@12,@SA00002                                 02S0318 01273000
*/********************************************************************/ 01274000
*/*                                                                  */ 01275000
*/* SEGMENT NAME - TESTBIT                                           */ 01276000
*/*                                                                  */ 01277000
*/* DESCRIPTIVE NAME - TEST BIT IN GROUP MASK                        */ 01278000
*/*                                                                  */ 01279000
*/* FUNCTION -                                                       */ 01280000
*/*      THIS SUBROUTINE DETERMINES IF A PARTICULAR BIT IN A         */ 01281000
*/*      GROUP MASK IS ON OR OFF. THE GROUP MASK IS A VARIABLE       */ 01282000
*/*      LENGTH BIT MASK POINTED TO BY MASKPTR . THE ONE-ORIGIN      */ 01283000
*/*      INDEX OF THE BIT TO BE TESTED IS CONTAINED IN FIELD         */ 01284000
*/*      GROUPNO.                                                    */ 01285000
*/*                                                                  */ 01286000
*/*   OPERATION -                                                    */ 01287000
*/*      ONE IS SUBTRACTED FROM THE GROUPNO TO PRODUCE A ZERO-ORIGIN */ 01288000
*/*      INDEX. THE INDEX IS THEN DIVIDED BY EIGHT TO DETERMINE THE  */ 01289000
*/*      BYTE (AND REMAINDER)  OF THE BIT BEING TESTED (IN A SRDL    */ 01290000
*/*      INSTRUCTION, THE ODD REGISTER GETS THE BITS SHIFTED OUT OF  */ 01291000
*/*      THE EVEN REGISTER.). THE REMAINDER IS ALIGNED IN A REGISTER */ 01292000
*/*      AND IS USED TO INDICATE THE BIT POSITION IN THE BYTE. THIS  */ 01293000
*/*      BIT POSITION IS USED IN A TEST-UNDER-MASK INSTRUCTION VIA   */ 01294000
*/*      EXECUTE.                                                    */ 01295000
*/*                                                                  */ 01296000
*/*      EXAMPLE - IF GROUPNO = 10, THIS OPERATION WILL DETERMINE    */ 01297000
*/*                THE BIT IS 1 BYTE AFTER THE BEGINNING OF THE      */ 01298000
*/*                GROUP MASK AND IS THE SECOND BIT POSITION.        */ 01299000
*/*                                                                  */ 01300000
*/* ENTRY - THIS CODE IS AN INLINE SUBROUTINE WHICH IS ENTERED       */ 01301000
*/*         AT THE TOP.                                              */ 01302000
*/*                                                                  */ 01303000
*/*   PURPOSE  -  TO DETERMINE IF A PARTICULAR BIT IN A GROUP        */ 01304000
*/*               MASK IS ON OR OFF.                                 */ 01305000
*/*                                                                  */ 01306000
*/*   INPUT -                                                        */ 01307000
*/*       MASKPTR - PTR TO GROUP MASK                                */ 01308000
*/*       GROUPNO - 1-ORIGIN INDEX INTO MASK OF THE BIT TO BE TESTED */ 01309000
*/*       BITRTN - BIT FOR RESULTS OF TEST TO BE RETURNED IN         */ 01310000
*/*                                                                  */ 01311000
*/* EXIT - NORMAL - THIS CODE IS AN INLINE SUBROUTINE WHICH          */ 01312000
*/*                 EXITS FROM THE BOTTOM.                           */ 01313000
*/*                                                                  */ 01314000
*/*   CONDITION - BIT TESTED AND RESULTS INDICATED.                  */ 01315000
*/*                                                                  */ 01316000
*/*   OUTPUT -                                                       */ 01317000
*/*       BITRTN - SET TO 1 IF BIT WAS ON                            */ 01318000
*/*              - SET TO 0 IF BIT WAS OFF                           */ 01319000
*/*                                                                  */ 01320000
*/*   RETURN CODES - (NONE)                                          */ 01321000
*/*                                                                  */ 01322000
*/********************************************************************/ 01323000
*BITRTN = OFFVALUE;                    /*ASSUME BIT IS OFF           */ 01324000
         NI    BITRTN,B'10111111'                               02S0319 01325000
*RFY (EVENREG,ODDREG,MASKREG) RSTD;    /*RESTRICT USE OF REGS 3,4+5  */ 01326000
*GEN REFS(EVENREG,GROUPNO,MASKPTR,ODDREG,MASKREG,TMINST)        02S0321 01327000
*    FLOWS(BITOFF);                                             02S0321 01328000
        L     EVENREG,GROUPNO         PUT BIT INDEX INTO REG            01329000
        BCTR  EVENREG,0               DECREMENT INDEX FOR ZERO ORIGIN   01330000
        SRDL  EVENREG,3               DIVIDE INDEX BY 8.SAVE REMAINDER  01331000
        A     EVENREG,MASKPTR         POINT TO CORRECT BYTE             01332000
        SRL   ODDREG,29               ALIGN REMAINDER IN REG            01333000
        LA    MASKREG,X'80'           INSERT 0-BIT MASK                 01334000
        SRL   MASKREG,0(ODDREG)       POSITION MASK BIT                 01335000
        EX    MASKREG,TMINST          TEST IF BIT IS ON                 01336000
        BNO   BITOFF                  BRANCH IF BIT NOT ON              01337000
*RFY (EVENREG,ODDREG,MASKREG) UNRSTD;  /*UNRESTRICT REGS 3,4, AND 5  */ 01338000
*BITRTN = ONVALUE;                     /*INDICATE BIT WAS ON         */ 01339000
         OI    BITRTN,B'01000000'                               02S0323 01340000
*BITOFF:;                                                       02S0324 01341000
*RETURN;                                                        02S0325 01342000
@EL00002 DS    0H                                               02S0325 01343000
@EF00002 DS    0H                                               02S0325 01344000
@ER00002 LM    @14,@12,@SA00002                                 02S0325 01345000
         BR    @14                                              02S0325 01346000
*END TESTBIT;                                                   02S0326 01347000
         B     @EL00002                                         02S0326 01348000
*END IEFAB441                                                   01S0327 01349000
*/* THE FOLLOWING INCLUDE STATEMENTS WERE FOUND IN THIS PROGRAM.      * 01350000
*/*%INCLUDE SYSLIB  (A441SPEC)                                        * 01351000
*/*%INCLUDE SYSLIB  (A441DATA)                                        * 01352000
*/*%INCLUDE SYSLIB  (TBITDATA)                                        * 01353000
*/*%INCLUDE SYSLIB  (IEFZB421)                                        * 01354000
*/*%INCLUDE SYSLIB  (IEFZB422)                                        * 01355000
*/*%INCLUDE SYSLIB  (IEFZB423)                                        * 01356000
*/*%INCLUDE SYSLIB  (IEFZB425)                                        * 01357000
*/*%INCLUDE SYSLIB  (IEFZB426)                                        * 01358000
*/*%INCLUDE SYSLIB  (IEFZB427)                                        * 01359000
*/*%INCLUDE SYSLIB  (IEFZB428)                                        * 01360000
*/*%INCLUDE SYSLIB  (IEFZB431)                                        * 01361000
*/*%INCLUDE SYSLIB  (IEFUCBOB)                                        * 01362000
*/*%INCLUDE SYSLIB  (IEFASIOT)                                        * 01363000
*/*%INCLUDE SYSLIB  (LOCATVOL)                                        * 01364000
*/*%INCLUDE SYSLIB  (LOCVSPEC)                                        * 01365000
*/*%INCLUDE SYSLIB  (CHEKTYPE)                                        * 01366000
*/*%INCLUDE SYSLIB  (CHEKSPEC)                                        * 01367000
*/*%INCLUDE SYSLIB  (TAPECHK )                                        * 01368000
*/*%INCLUDE SYSLIB  (TAPESPC )                                        * 01369000
*/*%INCLUDE SYSLIB  (PRRDEVIC)                                        * 01370000
*/*%INCLUDE SYSLIB  (FIXDSPEC)                                        * 01371000
*/*%INCLUDE SYSLIB  (SERCHEDL)                                        * 01372000
*/*%INCLUDE SYSLIB  (SEDLSPEC)                                        * 01373000
*/*%INCLUDE SYSLIB  (SETUPARU)                                        * 01374000
*/*%INCLUDE SYSLIB  (SARUSPEC)                                        * 01375000
*/*%INCLUDE SYSLIB  (DOARURTN)                                        * 01376000
*/*%INCLUDE SYSLIB  (RARUSPEC)                                        * 01377000
*/*%INCLUDE SYSLIB  (MARKWAIT)                                        * 01378000
*/*%INCLUDE SYSLIB  (WAITSPEC)                                        * 01379000
*/*%INCLUDE SYSLIB  (UNLDVOL )                                        * 01380000
*/*%INCLUDE SYSLIB  (UNLDSPEC)                                        * 01381000
*/*%INCLUDE SYSLIB  (TESTBIT )                                        * 01382000
*/*%INCLUDE SYSLIB  (TBITSPEC)                                        * 01383000
*;                                                              01S0327 01384000
@DATA    DS    0H                                                       01385000
@CH00048 DC    H'1'                                                     01386000
@CH00112 DC    H'2'                                                     01387000
@DATD    DSECT                                                          01388000
         DS    0F                                                       01389000
@SA00001 DS    18F                                                      01390000
@PC00001 DS    5F                                                       01391000
@SA00002 DS    15F                                                      01392000
@AL00001 DS    8A                                                       01393000
@TF00001 DS    F                                                        01394000
IEFAB441 CSECT                                                          01395000
         DS    0F                                                       01396000
@CF00099 DC    F'28'                                                    01397000
@CH00099 EQU   @CF00099+2                                               01398000
@CF01096 DC    F'-4'                                                    01399000
@DATD    DSECT                                                          01400000
         DS    0D                                                       01401000
MASKPTR  DS    A                                                        01402000
SIOTPTR  DS    A                                                        01403000
UCBPTR   DS    A                                                        01404000
VMVREQBP DS    A                                                        01405000
FNDGRPID DS    F                                                        01406000
GROUPNO  DS    F                                                        01407000
EDTPTR   DS    A                                                        01408000
LUVPTR   DS    A                                                        01409000
GENPTR   DS    A                                                        01410000
GRPTABP  DS    A                                                        01411000
ETIODATA DS    CL4                                                      01412000
         ORG   ETIODATA                                                 01413000
DEVSENT  DS    FL2                                                      01414000
DEVSSIOT DS    FL2                                                      01415000
         ORG   ETIODATA+4                                               01416000
FUNC434  DS    BL4                                                      01417000
         ORG   FUNC434                                                  01418000
UPDATIOT DS    BL1                                                      01419000
USECTFLG EQU   FUNC434+0                                                01420000
AFFFLAG  EQU   FUNC434+0                                                01421000
@NM00002 EQU   FUNC434+0                                                01422000
USEATFLG EQU   FUNC434+0                                                01423000
UPALGTB  EQU   FUNC434+0                                                01424000
@NM00003 EQU   FUNC434+0                                                01425000
         ORG   FUNC434+4                                                01426000
INTYPST  DS    CL4                                                      01427000
         ORG   INTYPST                                                  01428000
INTYPCOM DS    CL4                                                      01429000
         ORG   INTYPCOM                                                 01430000
@NM00004 DS    BL1                                                      01431000
INTYPBT2 DS    BL1                                                      01432000
         ORG   INTYPBT2                                                 01433000
INTRK7   DS    BL1                                                      01434000
         ORG   INTYPCOM+2                                               01435000
@NM00005 DS    BL1                                                      01436000
         ORG   @NM00005                                                 01437000
INTAPE   DS    BL1                                                      01438000
@NM00006 EQU   @NM00005+0                                               01439000
INDACC   EQU   @NM00005+0                                               01440000
         ORG   INTYPCOM+3                                               01441000
INTYPBT4 DS    BL1                                                      01442000
         ORG   INTYPST+4                                                01443000
SWITCHES DS    BL1                                                      01444000
         ORG   SWITCHES                                                 01445000
ALLALOC  DS    BL1                                                      01446000
BITRTN   EQU   SWITCHES+0                                               01447000
TYPELOKD EQU   SWITCHES+0                                               01448000
TYPMATCH EQU   SWITCHES+0                                               01449000
UCBMATSW EQU   SWITCHES+0                                               01450000
VOLFND   EQU   SWITCHES+0                                               01451000
         ORG   SWITCHES+1                                               01452000
UCBPARMS DS    CL9                                                      01453000
         ORG   UCBPARMS                                                 01454000
@NM00009 DS    CL2                                                      01455000
VOLID434 DS    CL6                                                      01456000
@NM00010 DS    CL1                                                      01457000
         ORG   UCBPARMS+9                                               01458000
VOLTYPST DS    CL4                                                      01459000
         ORG   VOLTYPST                                                 01460000
TYPCOMP  DS    CL4                                                      01461000
         ORG   TYPCOMP                                                  01462000
@NM00011 DS    BL1                                                      01463000
VLTYPBT2 DS    BL1                                                      01464000
         ORG   VLTYPBT2                                                 01465000
VOLTRK7  DS    BL1                                                      01466000
         ORG   TYPCOMP+2                                                01467000
@NM00012 DS    BL1                                                      01468000
VLTYPBT4 DS    BL1                                                      01469000
         ORG   VOLTYPST+4                                               01470000
VMVRBCOR DS    CL52                                                     01471000
@OLDKEY  DS    AL1                                                      01472000
IEFAB441 CSECT                                                          01473000
         DS    0F                                                       01474000
@SIZDATD DC    AL1(230)                                                 01475000
         DC    AL3(@ENDDATD-@DATD)                                      01476000
@CV00163 DC    V(IEFAB434)                                              01477000
@CV00164 DC    V(IEFAB442)                                              01478000
@CV00165 DC    V(IEFAB49C)                                              01479000
         DS    0D                                                       01480000
@CB00153 DC    X'3000'                                                  01481000
@CB00155 DC    X'3400'                                                  01482000
@CB00157 DC    X'3420'                                                  01483000
@CB00159 DC    X'3200'                                                  01484000
@CB00161 DC    X'3210'                                                  01485000
@CB00137 DC    B'10000000'                                              01486000
         DS    CL1                                                      01487000
ERRCD    DC    H'21'                                                    01488000
         DC    H'20'                                                    01489000
         DC    H'58'                                                    01490000
         DC    H'59'                                                    01491000
         DC    H'83'                                                    01492000
IEFAB441 CSECT                                                          01493000
         DS   0H                                                        01494000
PATCHLOC DC ((@DATA-@PSTART)/20)X'00'                                   01495000
IEFAB441 CSECT                                                          01496000
TMINST  TM    0(EVENREG),0            TEST OF CORRECT BYTE. MASK=BIT    01497000
@DATD    DSECT                                                          01498000
         ORG   *+1-(*-@DATD)/(*-@DATD) INSURE DSECT DATA                01499000
@ENDDATD EQU   *                                                        01500000
IEFAB441 CSECT                                                          01501000
@00      EQU   00                      EQUATES FOR REGISTERS 0-15       01502000
@01      EQU   01                                                       01503000
@02      EQU   02                                                       01504000
@03      EQU   03                                                       01505000
@04      EQU   04                                                       01506000
@05      EQU   05                                                       01507000
@06      EQU   06                                                       01508000
@07      EQU   07                                                       01509000
@08      EQU   08                                                       01510000
@09      EQU   09                                                       01511000
@10      EQU   10                                                       01512000
@11      EQU   11                                                       01513000
@12      EQU   12                                                       01514000
@13      EQU   13                                                       01515000
@14      EQU   14                                                       01516000
@15      EQU   15                                                       01517000
VUCTR    EQU   @04                                                      01518000
RTNCODE  EQU   @03                                                      01519000
GRPCTR   EQU   @05                                                      01520000
DEVCTR   EQU   @04                                                      01521000
VUPTR    EQU   @02                                                      01522000
GRPPTR   EQU   @02                                                      01523000
EDLUCBLP EQU   @05                                                      01524000
EDLPTR   EQU   @03                                                      01525000
EDLGNTP  EQU   @02                                                      01526000
REG15    EQU   @15                                                      01527000
EVENREG  EQU   @04                                                      01528000
MASKREG  EQU   @03                                                      01529000
ODDREG   EQU   @05                                                      01530000
CANCLECB EQU   0                                                        01531000
IOSLUT   EQU   0                                                        01532000
REASONCD EQU   0                                                        01533000
QMQBLK   EQU   0                                                        01534000
QMASKOWN EQU   QMQBLK+29                                                01535000
EDTHDR   EQU   0                                                        01536000
EDTLUVSP EQU   EDTHDR                                                   01537000
EDTGENSP EQU   EDTHDR+4                                                 01538000
EDTGRPSP EQU   EDTHDR+8                                                 01539000
EDTUCBSP EQU   EDTHDR+12                                                01540000
EDTMSKTP EQU   EDTHDR+16                                                01541000
LUVSECT  EQU   0                                                        01542000
LUVHDR   EQU   LUVSECT                                                  01543000
LUVENTRY EQU   0                                                        01544000
LUVGMTP  EQU   LUVENTRY+12                                              01545000
LUVFLAGS EQU   LUVENTRY+24                                              01546000
GENSECT  EQU   0                                                        01547000
GENHDR   EQU   GENSECT                                                  01548000
GENENTRY EQU   0                                                        01549000
GRPTRTAB EQU   0                                                        01550000
GRPSECT  EQU   0                                                        01551000
GRPHDR   EQU   GRPSECT                                                  01552000
GRPENTNO EQU   GRPHDR                                                   01553000
GRPENTLN EQU   GRPHDR+4                                                 01554000
GRPENTRY EQU   0                                                        01555000
GRPID    EQU   GRPENTRY                                                 01556000
GRPUCBNO EQU   GRPENTRY+4                                               01557000
GRPUCBP  EQU   GRPENTRY+8                                               01558000
EUCBSECT EQU   0                                                        01559000
EUCBHDR  EQU   EUCBSECT                                                 01560000
EUCBENTY EQU   0                                                        01561000
EUCBTPOS EQU   EUCBENTY                                                 01562000
GRMSKTAB EQU   0                                                        01563000
GMTHDR   EQU   GRMSKTAB                                                 01564000
GMTENTRY EQU   0                                                        01565000
IEFEDL   EQU   0                                                        01566000
EDLHDR   EQU   IEFEDL                                                   01567000
EDLFGENP EQU   EDLHDR+8                                                 01568000
EDLUVFLG EQU   EDLHDR+16                                                01569000
EDLENTRY EQU   0                                                        01570000
EDLNXTNT EQU   EDLENTRY                                                 01571000
EDLGRPTR EQU   EDLENTRY+12                                              01572000
EDLDTFLG EQU   EDLENTRY+20                                              01573000
EDLGNTRY EQU   0                                                        01574000
EDLNXGRP EQU   EDLGNTRY                                                 01575000
EDLUCBNO EQU   EDLGNTRY+4                                               01576000
EDLLISTP EQU   EDLGNTRY+8                                               01577000
EDLGRFLG EQU   EDLGNTRY+16                                              01578000
EDLUCBL  EQU   0                                                        01579000
EDLUCBAD EQU   EDLUCBL                                                  01580000
EDLINDIC EQU   EDLUCBL+2                                                01581000
VOLUNTAB EQU   0                                                        01582000
VOLID    EQU   VOLUNTAB                                                 01583000
VOLSTAT  EQU   VOLUNTAB+6                                               01584000
VOLSTATA EQU   VOLSTAT                                                  01585000
VOLSTATB EQU   VOLSTAT+1                                                01586000
VOLALOC  EQU   VOLSTATB                                                 01587000
VDEVREQD EQU   VOLSTATB                                                 01588000
VUDNALOC EQU   VOLSTATB                                                 01589000
VUVINELG EQU   VOLSTATB                                                 01590000
VOLSTATC EQU   VOLSTAT+2                                                01591000
VOLSTATD EQU   VOLSTAT+3                                                01592000
VUVLUNIQ EQU   VOLSTATD                                                 01593000
VOLUNTID EQU   VOLUNTAB+10                                              01594000
VOLALGTP EQU   VOLUNTAB+12                                              01595000
VOLSIOTP EQU   VOLUNTAB+16                                              01596000
ALCWA    EQU   0                                                        01597000
FMAPPTR  EQU   ALCWA+4                                                  01598000
IOSLUTP  EQU   ALCWA+16                                                 01599000
FAILRSCP EQU   ALCWA+20                                                 01600000
EDTABPTR EQU   ALCWA+24                                                 01601000
CNTABLE  EQU   ALCWA+28                                                 01602000
TOTREQS  EQU   CNTABLE+36                                               01603000
TOTVOLUN EQU   CNTABLE+44                                               01604000
VOLUNPTR EQU   ALCWA+80                                                 01605000
VOLUNSZE EQU   ALCWA+84                                                 01606000
ALGTABP  EQU   ALCWA+88                                                 01607000
QMGRRBP  EQU   ALCWA+108                                                01608000
INDICATE EQU   ALCWA+112                                                01609000
INDRETRY EQU   INDICATE                                                 01610000
@NM00018 EQU   ALCWA+113                                                01611000
WAITIGEN EQU   @NM00018                                                 01612000
ALCWAREC EQU   @NM00018                                                 01613000
NEEDRCVY EQU   @NM00018                                                 01614000
NODEVERR EQU   @NM00018                                                 01615000
ALCWASID EQU   ALCWA+114                                                01616000
TIOTHDRP EQU   ALCWA+120                                                01617000
CANCELP  EQU   ALCWA+140                                                01618000
NAMES    EQU   0                                                        01619000
ALCJOBN  EQU   NAMES                                                    01620000
ALCSTEPN EQU   NAMES+8                                                  01621000
ALGPTRS  EQU   0                                                        01622000
CVRPARM  EQU   0                                                        01623000
CVRFLG1  EQU   CVRPARM+8                                                01624000
CVRRQLST EQU   0                                                        01625000
CVRMIN   EQU   CVRRQLST+10                                              01626000
CVRFLG2  EQU   CVRRQLST+16                                              01627000
CVRWUCBP EQU   CVRRQLST+24                                              01628000
CVRGPLST EQU   0                                                        01629000
CVRFLG3  EQU   CVRGPLST+12                                              01630000
GRPCOUNT EQU   0                                                        01631000
AQMPARAM EQU   0                                                        01632000
AQMNORMP EQU   AQMPARAM+20                                              01633000
AQMQBPTR EQU   AQMPARAM+24                                              01634000
FUNCMAP  EQU   0                                                        01635000
VOLMNTSW EQU   FUNCMAP                                                  01636000
WRTMSGSW EQU   FUNCMAP                                                  01637000
UWAITSW  EQU   FUNCMAP                                                  01638000
VWAITSW  EQU   FUNCMAP                                                  01639000
OFFDEVSW EQU   FUNCMAP                                                  01640000
CCLMNTSW EQU   FUNCMAP                                                  01641000
GENLOKSW EQU   FUNCMAP                                                  01642000
HDRMSGSW EQU   FUNCMAP+1                                                01643000
MTRJOBSW EQU   FUNCMAP+1                                                01644000
NOTIOTNQ EQU   FUNCMAP+1                                                01645000
TRKMSW   EQU   FUNCMAP+1                                                01646000
WAITOKSW EQU   FUNCMAP+1                                                01647000
ASNMSW   EQU   FUNCMAP+1                                                01648000
VMVRQBLK EQU   0                                                        01649000
VMVFNMAP EQU   VMVRQBLK                                                 01650000
VMVOPTB1 EQU   VMVFNMAP                                                 01651000
VMVUNLOD EQU   VMVOPTB1                                                 01652000
VMVUCB   EQU   VMVOPTB1                                                 01653000
VMVOPTB2 EQU   VMVFNMAP+1                                               01654000
VMVOPTB3 EQU   VMVFNMAP+2                                               01655000
VMVUCBP  EQU   VMVRQBLK+9                                               01656000
VMVJBNMP EQU   VMVRQBLK+24                                              01657000
VMVJSNMP EQU   VMVRQBLK+32                                              01658000
VMVMINFO EQU   VMVRQBLK+40                                              01659000
VMVACTON EQU   VMVMINFO                                                 01660000
VMVUSER  EQU   VMVRQBLK+48                                              01661000
UCB      EQU   0                                                        01662000
UCBOB    EQU   0                                                        01663000
UCBJBNR  EQU   UCBOB                                                    01664000
UCBJES3  EQU   UCBJBNR                                                  01665000
UCBFL5   EQU   UCBOB+1                                                  01666000
UCBAF    EQU   UCBFL5                                                   01667000
UCBNALOC EQU   UCBFL5                                                   01668000
UCBSTAT  EQU   UCBOB+3                                                  01669000
UCBRESV  EQU   UCBSTAT                                                  01670000
UCBALOC  EQU   UCBSTAT                                                  01671000
UCBPRES  EQU   UCBSTAT                                                  01672000
UCBCHAN  EQU   UCBOB+4                                                  01673000
UCBSFLS  EQU   UCBOB+6                                                  01674000
UCBFLA   EQU   UCBSFLS                                                  01675000
UCBFL1   EQU   UCBFLA                                                   01676000
UCBBSY   EQU   UCBFL1                                                   01677000
UCBNRY   EQU   UCBFL1                                                   01678000
UCBPST   EQU   UCBFL1                                                   01679000
UCBCUB   EQU   UCBFL1                                                   01680000
UCBFLB   EQU   UCBSFLS+1                                                01681000
UCBCHM   EQU   UCBOB+8                                                  01682000
UCBCHM1  EQU   UCBCHM                                                   01683000
UCBPTH0  EQU   UCBCHM1                                                  01684000
UCBPTH1  EQU   UCBCHM1                                                  01685000
UCBWGT   EQU   UCBOB+12                                                 01686000
UCBTYP   EQU   UCBOB+16                                                 01687000
UCBTBYT1 EQU   UCBTYP                                                   01688000
UCB1FEA5 EQU   UCBTBYT1                                                 01689000
UCB1FEA6 EQU   UCBTBYT1                                                 01690000
UCBTBYT2 EQU   UCBTYP+1                                                 01691000
UCB2OPT2 EQU   UCBTBYT2                                                 01692000
UCBDUDN1 EQU   UCB2OPT2                                                 01693000
UCB2OPT3 EQU   UCBTBYT2                                                 01694000
UCBDUDN2 EQU   UCB2OPT3                                                 01695000
UCB2OPT4 EQU   UCBTBYT2                                                 01696000
UCBRWTAU EQU   UCB2OPT4                                                 01697000
UCB2OPT6 EQU   UCBTBYT2                                                 01698000
UCB2OPT7 EQU   UCBTBYT2                                                 01699000
UCBTBYT3 EQU   UCBTYP+2                                                 01700000
UCBDVCLS EQU   UCBTBYT3                                                 01701000
UCB3TAPE EQU   UCBDVCLS                                                 01702000
UCB3DACC EQU   UCBDVCLS                                                 01703000
UCBTBYT4 EQU   UCBTYP+3                                                 01704000
UCBEXTPT EQU   UCBOB+20                                                 01705000
UCBFLC   EQU   UCBEXTPT                                                 01706000
UCBDEV   EQU   UCBOB+24                                                 01707000
UCBCMEXT EQU   0                                                        01708000
UCBATI   EQU   UCBCMEXT+3                                               01709000
@NM00036 EQU   UCBATI                                                   01710000
UCBFLP1  EQU   UCBCMEXT+5                                               01711000
UCBMT    EQU   0                                                        01712000
UCBOCR   EQU   0                                                        01713000
UCB3540X EQU   0                                                        01714000
UCBDKBYT EQU   UCB3540X+6                                               01715000
UCB3800X EQU   0                                                        01716000
UCBOPTNS EQU   UCB3800X                                                 01717000
UCBACTIV EQU   UCB3800X+3                                               01718000
UCBMDRBF EQU   UCB3800X+36                                              01719000
UCBUCS   EQU   0                                                        01720000
UCBUCSOP EQU   UCBUCS+4                                                 01721000
UCBFCBOP EQU   UCBUCS+5                                                 01722000
INDMSIOT EQU   0                                                        01723000
SCTUSADD EQU   INDMSIOT+20                                              01724000
SIOTOTUN EQU   INDMSIOT+39                                              01725000
SIOTBYT1 EQU   INDMSIOT+43                                              01726000
SIOTALCD EQU   SIOTBYT1                                                 01727000
SIOTBYT3 EQU   INDMSIOT+46                                              01728000
SIOTJES3 EQU   SIOTBYT3                                                 01729000
SIOTTSTC EQU   INDMSIOT+47                                              01730000
SIOTBYT0 EQU   INDMSIOT+52                                              01731000
SIOTRTRY EQU   SIOTBYT0                                                 01732000
SCTSDISP EQU   INDMSIOT+55                                              01733000
SCTSBYT1 EQU   INDMSIOT+56                                              01734000
SCTSBYT2 EQU   INDMSIOT+57                                              01735000
SCTSBYT3 EQU   INDMSIOT+58                                              01736000
SCTSBYT4 EQU   INDMSIOT+59                                              01737000
SCTUTYPE EQU   INDMSIOT+60                                              01738000
SIOTDEVT EQU   SCTUTYPE                                                 01739000
SIOUBYT3 EQU   SIOTDEVT+2                                               01740000
SIOTALTD EQU   INDMSIOT+92                                              01741000
SIOTBYT2 EQU   INDMSIOT+103                                             01742000
SIOTRSNC EQU   INDMSIOT+130                                             01743000
SIOTEDLP EQU   INDMSIOT+136                                             01744000
SVOLUNAD EQU   INDMSIOT+140                                             01745000
SIOTETIO EQU   INDMSIOT+148                                             01746000
SVOLUNNO EQU   INDMSIOT+168                                             01747000
UCBBGN   EQU   0                                                        01748000
FMAPBITS EQU   0                                                        01749000
FAILFIXD EQU   FMAPBITS                                                 01750000
ALCWAPTR EQU   0                                                        01751000
INVUPTR  EQU   0                                                        01752000
MPTR     EQU   0                                                        01753000
ALCDTYPE EQU   0                                                        01754000
UCBOBS01 EQU   UCBDEV                                                   01755000
UCBVOLI  EQU   UCBOBS01+4                                               01756000
UCBSTAB  EQU   UCBOBS01+10                                              01757000
UCBBSVL  EQU   UCBSTAB                                                  01758000
UCBPRSRS EQU   UCBSTAB                                                  01759000
UCBDMCT  EQU   UCBOBS01+11                                              01760000
UCBFL4   EQU   UCBOBS01+13                                              01761000
UCBOBS02 EQU   UCBDEV                                                   01762000
UCBTFL1  EQU   UCBOBS02+19                                              01763000
UCBXTN   EQU   UCBOBS02+20                                              01764000
UCBVOPT  EQU   UCBXTN                                                   01765000
UCBOBS03 EQU   UCBDEV                                                   01766000
UCBXTADR EQU   UCBOBS03                                                 01767000
UCBOBS04 EQU   UCBDEV                                                   01768000
UCBBTA   EQU   UCBOBS04+12                                              01769000
UCBOBS06 EQU   UCBDEV                                                   01770000
UCBAOF   EQU   UCBOBS06                                                 01771000
UCBAOF1  EQU   UCBAOF                                                   01772000
UCBAOF2  EQU   UCBAOF+1                                                 01773000
@NM00035 EQU   UCBOBS06+3                                               01774000
UCBIRB   EQU   UCBOBS06+4                                               01775000
UCBGRAF  EQU   UCBIRB                                                   01776000
UCBLDNCA EQU   UCBOBS06+8                                               01777000
UCBRDYQ  EQU   UCBLDNCA                                                 01778000
UCBIRLN  EQU   UCBRDYQ                                                  01779000
UCBLDNCB EQU   UCBRDYQ+1                                                01780000
UCBCTLNK EQU   UCBOBS06+12                                              01781000
UCBOBS07 EQU   UCBDEV                                                   01782000
UCBOBS08 EQU   UCBDEV                                                   01783000
UCBCTCAD EQU   UCBOBS08                                                 01784000
UCBCTCF1 EQU   UCBOBS08+4                                               01785000
UCBOBS09 EQU   UCBDEV                                                   01786000
         AGO   .@UNREFD                START UNREFERENCED COMPONENTS    01787000
UCBRV066 EQU   UCBOBS09+4                                               01788000
UCBIOSBA EQU   UCBOBS09                                                 01789000
UCBRV042 EQU   UCBOBS08+5                                               01790000
UCBRV082 EQU   UCBCTCF1                                                 01791000
UCBRV081 EQU   UCBCTCF1                                                 01792000
UCBRV080 EQU   UCBCTCF1                                                 01793000
UCBRV079 EQU   UCBCTCF1                                                 01794000
UCBRV078 EQU   UCBCTCF1                                                 01795000
UCBRV077 EQU   UCBCTCF1                                                 01796000
UCBRV076 EQU   UCBCTCF1                                                 01797000
UCBCTC80 EQU   UCBCTCF1                                                 01798000
UCBCTCAL EQU   UCBCTCAD                                                 01799000
UCBICNCB EQU   UCBOBS07+4                                               01800000
UCBRV040 EQU   UCBOBS07                                                 01801000
UCBCTLNA EQU   UCBCTLNK+1                                               01802000
UCBRLN   EQU   UCBCTLNK                                                 01803000
UCBRDYQA EQU   UCBLDNCB                                                 01804000
UCBINRLN EQU   UCBIRLN                                                  01805000
UCBIRBA  EQU   UCBIRB+1                                                 01806000
UCBRV039 EQU   UCBGRAF                                                  01807000
UCBDWNR  EQU   UCBGRAF                                                  01808000
UCBRPND  EQU   UCBGRAF                                                  01809000
UCBUPM   EQU   UCBGRAF                                                  01810000
UCBBTAM  EQU   UCBGRAF                                                  01811000
UCBDRNO  EQU   UCBGRAF                                                  01812000
UCBDRO   EQU   UCBGRAF                                                  01813000
UCBOIP   EQU   UCBGRAF                                                  01814000
UCBATRCD EQU   @NM00035                                                 01815000
UCBSKPFG EQU   @NM00035                                                 01816000
UCBRIPND EQU   @NM00035                                                 01817000
UCBRTIAC EQU   @NM00035                                                 01818000
UCBRSV79 EQU   @NM00035                                                 01819000
UCBRSV78 EQU   @NM00035                                                 01820000
UCBRSV77 EQU   @NM00035                                                 01821000
UCBOLTEP EQU   @NM00035                                                 01822000
UCBATNCT EQU   UCBOBS06+2                                               01823000
UCBRSV76 EQU   UCBAOF2                                                  01824000
UCBRSV75 EQU   UCBAOF2                                                  01825000
UCBRSV74 EQU   UCBAOF2                                                  01826000
UCBRSV73 EQU   UCBAOF2                                                  01827000
UCBRSV72 EQU   UCBAOF2                                                  01828000
UCBRSV71 EQU   UCBAOF2                                                  01829000
UCBRSV70 EQU   UCBAOF2                                                  01830000
UCBRSV69 EQU   UCBAOF2                                                  01831000
UCBRSV68 EQU   UCBAOF1                                                  01832000
UCBRSV67 EQU   UCBAOF1                                                  01833000
UCBRSV66 EQU   UCBAOF1                                                  01834000
UCBRSV65 EQU   UCBAOF1                                                  01835000
UCBRSV64 EQU   UCBAOF1                                                  01836000
UCBOFNL  EQU   UCBAOF1                                                  01837000
UCBOFSP  EQU   UCBAOF1                                                  01838000
UCBOFMCR EQU   UCBAOF1                                                  01839000
UCBBTB   EQU   UCBBTA+1                                                 01840000
UCBDI    EQU   UCBBTA                                                   01841000
UCBSNS   EQU   UCBOBS04+8                                               01842000
UCBTEB   EQU   UCBOBS04+4                                               01843000
UCBGCB   EQU   UCBOBS04+3                                               01844000
UCBOPEN  EQU   UCBOBS04+2                                               01845000
UCBSTART EQU   UCBOBS04                                                 01846000
UCBXTNB  EQU   UCBXTN+1                                                 01847000
UCBRSV22 EQU   UCBVOPT                                                  01848000
UCBRSV21 EQU   UCBVOPT                                                  01849000
UCBRSV20 EQU   UCBVOPT                                                  01850000
UCBESVE  EQU   UCBVOPT                                                  01851000
UCBERPC  EQU   UCBVOPT                                                  01852000
UCBESVC  EQU   UCBVOPT                                                  01853000
UCBEVA   EQU   UCBVOPT                                                  01854000
UCBESV   EQU   UCBVOPT                                                  01855000
UCBRV009 EQU   UCBTFL1                                                  01856000
UCBRV008 EQU   UCBTFL1                                                  01857000
UCBRV007 EQU   UCBTFL1                                                  01858000
UCBRV006 EQU   UCBTFL1                                                  01859000
UCBRV005 EQU   UCBTFL1                                                  01860000
UCBRV038 EQU   UCBTFL1                                                  01861000
UCBNSLTP EQU   UCBTFL1                                                  01862000
UCBNLTP  EQU   UCBTFL1                                                  01863000
UCBRES1B EQU   UCBOBS02+18                                              01864000
UCBFSER  EQU   UCBOBS02+12                                              01865000
@NM00034 EQU   UCBOBS02+4                                               01866000
UCBFSEQ  EQU   UCBOBS02+2                                               01867000
UCBFSCT  EQU   UCBOBS02                                                 01868000
UCBNEXP  EQU   UCBOBS01+20                                              01869000
UCBBASE  EQU   UCBOBS01+16                                              01870000
UCBRES1A EQU   UCBOBS01+15                                              01871000
UCBUSER  EQU   UCBOBS01+14                                              01872000
UCBFL47  EQU   UCBFL4                                                   01873000
UCBFL46  EQU   UCBFL4                                                   01874000
UCBFL45  EQU   UCBFL4                                                   01875000
UCBRV065 EQU   UCBFL4                                                   01876000
UCBDSS   EQU   UCBFL4                                                   01877000
UCBRESVP EQU   UCBFL4                                                   01878000
UCBWDAV  EQU   UCBFL4                                                   01879000
UCBDAVV  EQU   UCBFL4                                                   01880000
UCBSQC   EQU   UCBOBS01+12                                              01881000
UCBDATP  EQU   UCBOBS01+12                                              01882000
UCBDMC   EQU   UCBDMCT                                                  01883000
UCBMOUNT EQU   UCBDMCT                                                  01884000
UCBBNUL  EQU   UCBSTAB                                                  01885000
UCBSHAR  EQU   UCBSTAB                                                  01886000
UCBBSTR  EQU   UCBSTAB                                                  01887000
UCBBPUB  EQU   UCBSTAB                                                  01888000
UCBBPRV  EQU   UCBSTAB                                                  01889000
UCBBALB  EQU   UCBPRSRS                                                 01890000
UCBPGFL  EQU   UCBSTAB                                                  01891000
UCBDVSHR EQU   UCBBSVL                                                  01892000
UCBVTOC  EQU   UCBOBS01                                                 01893000
@NM00001 EQU   FMAPBITS                                                 01894000
SIODDSNL EQU   INDMSIOT+173                                             01895000
SIOVDSNL EQU   INDMSIOT+172                                             01896000
SIOVDSNT EQU   INDMSIOT+170                                             01897000
SIOTVMVP EQU   INDMSIOT+164                                             01898000
SIOTJFX  EQU   INDMSIOT+160                                             01899000
SJFCBPTR EQU   INDMSIOT+156                                             01900000
SIOTNPTR EQU   INDMSIOT+152                                             01901000
SIOTATE  EQU   INDMSIOT+144                                             01902000
SIOTEDLS EQU   INDMSIOT+132                                             01903000
SCTANAME EQU   INDMSIOT+122                                             01904000
@NM00052 EQU   INDMSIOT+108                                             01905000
SIOTSSNM EQU   INDMSIOT+104                                             01906000
@NM00051 EQU   SIOTBYT2                                                 01907000
@NM00050 EQU   SIOTBYT2                                                 01908000
SIOTCVOL EQU   SIOTBYT2                                                 01909000
SIOTCNEW EQU   SIOTBYT2                                                 01910000
SIOTCALC EQU   SIOTBYT2                                                 01911000
SIOTGALL EQU   SIOTBYT2                                                 01912000
SIOTDSPD EQU   SIOTBYT2                                                 01913000
SIOTDMND EQU   SIOTBYT2                                                 01914000
SIOTOPUC EQU   INDMSIOT+99                                              01915000
SIOTOUTR EQU   INDMSIOT+97                                              01916000
SIOTOUTC EQU   INDMSIOT+96                                              01917000
@NM00049 EQU   INDMSIOT+93                                              01918000
SIOTAUNC EQU   SIOTALTD                                                 01919000
SIOTACAT EQU   SIOTALTD                                                 01920000
SIOTADEL EQU   SIOTALTD                                                 01921000
SIOTAKEP EQU   SIOTALTD                                                 01922000
SIOTNPRV EQU   SIOTALTD                                                 01923000
SIOJCATS EQU   SIOTALTD                                                 01924000
@NM00048 EQU   SIOTALTD                                                 01925000
@NM00047 EQU   SIOTALTD                                                 01926000
@NM00046 EQU   INDMSIOT+91                                              01927000
SIOTNDSB EQU   INDMSIOT+88                                              01928000
@NM00045 EQU   INDMSIOT+84                                              01929000
SIOTDPCD EQU   INDMSIOT+82                                              01930000
@NM00044 EQU   INDMSIOT+81                                              01931000
SCTOUTPN EQU   INDMSIOT+80                                              01932000
SCTOUTNO EQU   INDMSIOT+76                                              01933000
SCTOUTNM EQU   INDMSIOT+68                                              01934000
SIOUCBAD EQU   SCTUTYPE+5                                               01935000
SIOUCNVT EQU   SCTUTYPE+4                                               01936000
SIOUBYT4 EQU   SIOTDEVT+3                                               01937000
@NM00043 EQU   SIOUBYT3                                                 01938000
SIO3UREC EQU   SIOUBYT3                                                 01939000
SIO3DISP EQU   SIOUBYT3                                                 01940000
SIO3DACC EQU   SIOUBYT3                                                 01941000
SIO3COMM EQU   SIOUBYT3                                                 01942000
SIO3TAPE EQU   SIOUBYT3                                                 01943000
SIOUBYT2 EQU   SIOTDEVT+1                                               01944000
SIOUBYT1 EQU   SIOTDEVT                                                 01945000
SIOTOMN  EQU   SCTSBYT4                                                 01946000
SIOTIPDI EQU   SCTSBYT4                                                 01947000
SIOTVAFF EQU   SCTSBYT4                                                 01948000
SIOTSTEP EQU   SCTSBYT4                                                 01949000
SIOTASCI EQU   SCTSBYT4                                                 01950000
SIOTAFF  EQU   SCTSBYT4                                                 01951000
SIOTGDGA EQU   SCTSBYT4                                                 01952000
SCTSGDGS EQU   SCTSBYT4                                                 01953000
SCTSOLD  EQU   SCTSBYT3                                                 01954000
SCTSMOD  EQU   SCTSBYT3                                                 01955000
SCTSNEW  EQU   SCTSBYT3                                                 01956000
SCTSYSOU EQU   SCTSBYT3                                                 01957000
SCTVREF  EQU   SCTSBYT3                                                 01958000
SCTALCHK EQU   SCTSBYT3                                                 01959000
SCTSYSNE EQU   SCTSBYT3                                                 01960000
SCTDSNRF EQU   SCTSBYT3                                                 01961000
SCTRECVD EQU   SCTSBYT2                                                 01962000
SCTDEFER EQU   SCTSBYT2                                                 01963000
SCTLABEL EQU   SCTSBYT2                                                 01964000
SCTUNLBD EQU   SCTSBYT2                                                 01965000
SCTJOBLB EQU   SCTSBYT2                                                 01966000
SCTVOLAF EQU   SCTSBYT2                                                 01967000
SIOTCATL EQU   SCTSBYT2                                                 01968000
SIOCLUNL EQU   SCTSBYT2                                                 01969000
SIOTJSCT EQU   SCTSBYT1                                                 01970000
SCTUNAFF EQU   SCTSBYT1                                                 01971000
SCTPARLM EQU   SCTSBYT1                                                 01972000
SIOTQDSN EQU   SCTSBYT1                                                 01973000
SIOTGDSN EQU   SCTSBYT1                                                 01974000
SIOTCCAT EQU   SCTSBYT1                                                 01975000
SCTSYSIN EQU   SCTSBYT1                                                 01976000
SCTDUMMY EQU   SCTSBYT1                                                 01977000
SIOTUNCT EQU   SCTSDISP                                                 01978000
SIOTCTLG EQU   SCTSDISP                                                 01979000
SIOTDLET EQU   SCTSDISP                                                 01980000
SIOTKEEP EQU   SCTSDISP                                                 01981000
SIOTPASS EQU   SCTSDISP                                                 01982000
SIOTPRIV EQU   SCTSDISP                                                 01983000
S3400DSP EQU   SCTSDISP                                                 01984000
SIOTRETN EQU   SCTSDISP                                                 01985000
SIOTVLCT EQU   INDMSIOT+54                                              01986000
SCTNMBUT EQU   INDMSIOT+53                                              01987000
SIOTPUPV EQU   SIOTBYT0                                                 01988000
SIOTNOPV EQU   SIOTBYT0                                                 01989000
SIOTGIGN EQU   SIOTBYT0                                                 01990000
SPVTAMSG EQU   SIOTBYT0                                                 01991000
SIOTFUDA EQU   SIOTBYT0                                                 01992000
SIOTDYAL EQU   SIOTBYT0                                                 01993000
SIOTSSDS EQU   SIOTBYT0                                                 01994000
SIOTGIID EQU   INDMSIOT+50                                              01995000
SCTVOLCT EQU   INDMSIOT+49                                              01996000
SCTSPOOL EQU   INDMSIOT+48                                              01997000
SIOTQNAM EQU   SIOTTSTC                                                 01998000
SIOTDSNM EQU   SIOTTSTC                                                 01999000
SIOTTRKM EQU   SIOTTSTC                                                 02000000
@NM00042 EQU   SIOTTSTC                                                 02001000
SIOTTERM EQU   SIOTTSTC                                                 02002000
@NM00041 EQU   SIOTTSTC                                                 02003000
@NM00040 EQU   SIOTBYT3                                                 02004000
S3400OFF EQU   SIOTBYT3                                                 02005000
SIOCDEVT EQU   SIOTBYT3                                                 02006000
SIOALIAS EQU   SIOTBYT3                                                 02007000
SCTDDINO EQU   INDMSIOT+44                                              02008000
SIOTDDNT EQU   SIOTBYT1                                                 02009000
SIODADSM EQU   SIOTBYT1                                                 02010000
SIOTDADR EQU   SIOTBYT1                                                 02011000
SIODUNAL EQU   SIOTBYT1                                                 02012000
SIOVAMDS EQU   SIOTBYT1                                                 02013000
SIOTHOLD EQU   SIOTBYT1                                                 02014000
SIOTOCKP EQU   SIOTBYT1                                                 02015000
SIOPSCNT EQU   INDMSIOT+42                                              02016000
SIOTREFN EQU   INDMSIOT+40                                              02017000
SIOTVRSB EQU   INDMSIOT+36                                              02018000
@NM00039 EQU   INDMSIOT+35                                              02019000
SCTPJFCB EQU   INDMSIOT+32                                              02020000
@NM00038 EQU   INDMSIOT+31                                              02021000
SCTPSIOT EQU   INDMSIOT+28                                              02022000
SIOTAFID EQU   INDMSIOT+26                                              02023000
@NM00037 EQU   INDMSIOT+24                                              02024000
SIODSNTE EQU   INDMSIOT+22                                              02025000
SIOTUNAF EQU   SCTUSADD                                                 02026000
SIOTDEST EQU   INDMSIOT+12                                              02027000
SCTDDNAM EQU   INDMSIOT+4                                               02028000
SIOTTYPE EQU   INDMSIOT+3                                               02029000
SIOTDSKA EQU   INDMSIOT                                                 02030000
UCBERADR EQU   UCBUCS+12                                                02031000
UCBFCBID EQU   UCBUCS+8                                                 02032000
UCBERCNT EQU   UCBUCS+7                                                 02033000
UCBRSV51 EQU   UCBUCS+6                                                 02034000
UCBRSV50 EQU   UCBFCBOP                                                 02035000
UCBRSV49 EQU   UCBFCBOP                                                 02036000
UCBRSV48 EQU   UCBFCBOP                                                 02037000
UCBRSV47 EQU   UCBFCBOP                                                 02038000
UCBRSV46 EQU   UCBFCBOP                                                 02039000
UCBRSV45 EQU   UCBFCBOP                                                 02040000
UCBRSV44 EQU   UCBFCBOP                                                 02041000
UCBFCBO1 EQU   UCBFCBOP                                                 02042000
UCBUCSPE EQU   UCBUCSOP                                                 02043000
UCBRSV43 EQU   UCBUCSOP                                                 02044000
UCBRSV42 EQU   UCBUCSOP                                                 02045000
UCBRSV41 EQU   UCBUCSOP                                                 02046000
UCBRSV40 EQU   UCBUCSOP                                                 02047000
UCBRSV39 EQU   UCBUCSOP                                                 02048000
UCBUCSO2 EQU   UCBUCSOP                                                 02049000
UCBUCSO1 EQU   UCBUCSOP                                                 02050000
UCBUCSID EQU   UCBUCS                                                   02051000
UCBMDRBA EQU   UCBMDRBF+1                                               02052000
UCBRV075 EQU   UCBMDRBF                                                 02053000
UCBRV074 EQU   UCB3800X+32                                              02054000
UCBIMAGE EQU   UCB3800X+28                                              02055000
UCBFCBNM EQU   UCB3800X+24                                              02056000
UCBCHAR4 EQU   UCB3800X+20                                              02057000
UCBCHAR3 EQU   UCB3800X+16                                              02058000
UCBCHAR2 EQU   UCB3800X+12                                              02059000
UCBCHAR1 EQU   UCB3800X+8                                               02060000
UCBCGMID EQU   UCB3800X+4                                               02061000
UCBBRSTA EQU   UCBACTIV                                                 02062000
UCBRV063 EQU   UCBACTIV                                                 02063000
UCBRV062 EQU   UCBACTIV                                                 02064000
UCBRV061 EQU   UCBACTIV                                                 02065000
UCBRV060 EQU   UCBACTIV                                                 02066000
UCBRV059 EQU   UCBACTIV                                                 02067000
UCBRV058 EQU   UCBACTIV                                                 02068000
UCBRV057 EQU   UCBACTIV                                                 02069000
UCBRV050 EQU   UCB3800X+2                                               02070000
UCBCGMNO EQU   UCB3800X+1                                               02071000
UCBRV083 EQU   UCBOPTNS                                                 02072000
UCBBRSTR EQU   UCBOPTNS                                                 02073000
UCBRV056 EQU   UCBOPTNS                                                 02074000
UCBRV055 EQU   UCBOPTNS                                                 02075000
UCBRV054 EQU   UCBOPTNS                                                 02076000
UCBRV053 EQU   UCBOPTNS                                                 02077000
UCBRV052 EQU   UCBOPTNS                                                 02078000
UCBRV051 EQU   UCBOPTNS                                                 02079000
UCBRV073 EQU   UCB3540X+7                                               02080000
UCBRV072 EQU   UCBDKBYT                                                 02081000
UCBRV071 EQU   UCBDKBYT                                                 02082000
UCBRV070 EQU   UCBDKBYT                                                 02083000
UCBRV069 EQU   UCBDKBYT                                                 02084000
UCBRV068 EQU   UCBDKBYT                                                 02085000
UCBRV067 EQU   UCBDKBYT                                                 02086000
UCBVLVER EQU   UCBDKBYT                                                 02087000
UCBDKAMX EQU   UCBDKBYT                                                 02088000
UCBVLSER EQU   UCB3540X                                                 02089000
UCBRDATA EQU   UCBOCR+4                                                 02090000
UCBFRID  EQU   UCBOCR                                                   02091000
UCBCLN   EQU   UCBMT+14                                                 02092000
UCBERG   EQU   UCBMT+12                                                 02093000
UCBMS    EQU   UCBMT+11                                                 02094000
UCBNB    EQU   UCBMT+10                                                 02095000
UCBPW    EQU   UCBMT+9                                                  02096000
UCBPR    EQU   UCBMT+8                                                  02097000
UCBSIO   EQU   UCBMT+6                                                  02098000
UCBTW    EQU   UCBMT+5                                                  02099000
UCBTR    EQU   UCBMT+4                                                  02100000
UCBTWT   EQU   UCBMT+3                                                  02101000
UCBTRT   EQU   UCBMT+2                                                  02102000
UCBCTD   EQU   UCBMT                                                    02103000
UCBWTOID EQU   UCBCMEXT+17                                              02104000
UCBRV043 EQU   UCBCMEXT+16                                              02105000
UCBASID  EQU   UCBCMEXT+14                                              02106000
UCBMFCNT EQU   UCBCMEXT+12                                              02107000
UCBPMSK  EQU   UCBCMEXT+10                                              02108000
UCBCCWOF EQU   UCBCMEXT+8                                               02109000
UCBRV041 EQU   UCBCMEXT+6                                               02110000
UCBRV036 EQU   UCBFLP1                                                  02111000
UCBRV035 EQU   UCBFLP1                                                  02112000
UCBERLOG EQU   UCBFLP1                                                  02113000
UCBRV033 EQU   UCBFLP1                                                  02114000
UCBRV032 EQU   UCBFLP1                                                  02115000
UCBRV031 EQU   UCBFLP1                                                  02116000
UCBSHRUP EQU   UCBFLP1                                                  02117000
UCBNSRCH EQU   UCBFLP1                                                  02118000
UCBSNSCT EQU   UCBCMEXT+4                                               02119000
UCBHPDV  EQU   @NM00036                                                 02120000
UCBHALI  EQU   @NM00036                                                 02121000
UCBRSV09 EQU   @NM00036                                                 02122000
UCBRSV08 EQU   @NM00036                                                 02123000
UCBRSV07 EQU   @NM00036                                                 02124000
UCBRSV06 EQU   @NM00036                                                 02125000
UCBRSV05 EQU   @NM00036                                                 02126000
UCBRSV04 EQU   @NM00036                                                 02127000
UCBDTI   EQU   UCBCMEXT+2                                               02128000
UCBSTI   EQU   UCBCMEXT+1                                               02129000
UCBETI   EQU   UCBCMEXT                                                 02130000
UCBEXTP  EQU   UCBEXTPT+1                                               02131000
UCBDDRSW EQU   UCBFLC                                                   02132000
UCBTICBT EQU   UCBFLC                                                   02133000
UCBIVRR  EQU   UCBFLC                                                   02134000
UCBIVRS  EQU   UCBFLC                                                   02135000
UCBITF   EQU   UCBFLC                                                   02136000
UCBUDE   EQU   UCBFLC                                                   02137000
UCBWAA   EQU   UCBFLC                                                   02138000
UCBATTP  EQU   UCBFLC                                                   02139000
UCBUNTYP EQU   UCBTBYT4                                                 02140000
UCBRSV11 EQU   UCBDVCLS                                                 02141000
UCBRSV10 EQU   UCBDVCLS                                                 02142000
UCB3CHAR EQU   UCBDVCLS                                                 02143000
UCB3UREC EQU   UCBDVCLS                                                 02144000
UCB3DISP EQU   UCBDVCLS                                                 02145000
UCB3COMM EQU   UCBDVCLS                                                 02146000
UCBDVPWR EQU   UCB2OPT7                                                 02147000
UCBVLPWR EQU   UCB2OPT6                                                 02148000
UCB2OPT5 EQU   UCBTBYT2                                                 02149000
UCBRVDEV EQU   UCBRWTAU                                                 02150000
UCBRPS   EQU   UCBDUDN2                                                 02151000
UCBRR    EQU   UCBDUDN1                                                 02152000
UCB2OPT1 EQU   UCBTBYT2                                                 02153000
UCB2OPT0 EQU   UCBTBYT2                                                 02154000
UCB1FEA7 EQU   UCBTBYT1                                                 02155000
UCBD6250 EQU   UCB1FEA6                                                 02156000
UCBD1600 EQU   UCB1FEA5                                                 02157000
UCB1FEA4 EQU   UCBTBYT1                                                 02158000
UCB1FEA3 EQU   UCBTBYT1                                                 02159000
UCB1FEA2 EQU   UCBTBYT1                                                 02160000
UCB1FEA1 EQU   UCBTBYT1                                                 02161000
UCB1FEA0 EQU   UCBTBYT1                                                 02162000
UCBNAME  EQU   UCBOB+13                                                 02163000
UCBRV029 EQU   UCBWGT                                                   02164000
UCBVHRSN EQU   UCBWGT                                                   02165000
UCBVORSN EQU   UCBWGT                                                   02166000
UCBMTPXP EQU   UCBWGT                                                   02167000
UCBREW   EQU   UCBWGT                                                   02168000
UCBPUB   EQU   UCBWGT                                                   02169000
UCBOUT   EQU   UCBWGT                                                   02170000
UCBIN    EQU   UCBWGT                                                   02171000
UCBCPU   EQU   UCBOB+11                                                 02172000
UCBLCI   EQU   UCBOB+10                                                 02173000
UCBCNT   EQU   UCBOB+9                                                  02174000
UCBRV017 EQU   UCBCHM1                                                  02175000
UCBRV016 EQU   UCBCHM1                                                  02176000
UCBRV015 EQU   UCBCHM1                                                  02177000
UCBRV014 EQU   UCBCHM1                                                  02178000
UCBSPB   EQU   UCBPTH1                                                  02179000
UCBPPB   EQU   UCBPTH1                                                  02180000
UCBSPA   EQU   UCBPTH0                                                  02181000
UCBPPA   EQU   UCBPTH0                                                  02182000
UCBSIGP  EQU   UCBFLB                                                   02183000
UCBVALPH EQU   UCBFLB                                                   02184000
UCBCRHSN EQU   UCBFLB                                                   02185000
UCBCRHRV EQU   UCBFLB                                                   02186000
UCBRESVH EQU   UCBFLB                                                   02187000
UCBSPST  EQU   UCBFLB                                                   02188000
UCBASNS  EQU   UCBFLB                                                   02189000
UCBIORST EQU   UCBFLB                                                   02190000
UCBQISCE EQU   UCBFL1                                                   02191000
UCBACTV  EQU   UCBFL1                                                   02192000
UCBSAP   EQU   UCBFL1                                                   02193000
UCBNOTRC EQU   UCBCUB                                                   02194000
UCBPSNS  EQU   UCBFL1                                                   02195000
UCBUSING EQU   UCBPST                                                   02196000
UCBNOTRD EQU   UCBNRY                                                   02197000
UCBBUSYD EQU   UCBBSY                                                   02198000
UCBUA    EQU   UCBCHAN+1                                                02199000
UCBCHA   EQU   UCBCHAN                                                  02200000
UCBDADI  EQU   UCBSTAT                                                  02201000
UCBSYSR  EQU   UCBSTAT                                                  02202000
UCBUNLD  EQU   UCBSTAT                                                  02203000
UCBCHGS  EQU   UCBSTAT                                                  02204000
UCBONLI  EQU   UCBSTAT                                                  02205000
UCBID    EQU   UCBOB+2                                                  02206000
UCBALTPH EQU   UCBFL5                                                   02207000
UCBALTCU EQU   UCBFL5                                                   02208000
UCBENVRD EQU   UCBFL5                                                   02209000
UCBVSDR  EQU   UCBFL5                                                   02210000
UCBSASK  EQU   UCBFL5                                                   02211000
UCBAMV   EQU   UCBAF                                                    02212000
UCBDCC   EQU   UCBFL5                                                   02213000
UCBMONT  EQU   UCBJBNR                                                  02214000
UCBRV011 EQU   UCBJBNR                                                  02215000
UCBMMSGP EQU   UCBJBNR                                                  02216000
UCBOLDSM EQU   UCBJBNR                                                  02217000
UCBRV003 EQU   UCBJBNR                                                  02218000
UCBDUC   EQU   UCBJBNR                                                  02219000
UCBVRDEV EQU   UCBJBNR                                                  02220000
UCBCMSEG EQU   UCBOB                                                    02221000
UCBPFXND EQU   UCB+512                                                  02222000
UCBIOQ   EQU   UCB+508                                                  02223000
UCBLOCK  EQU   UCB+504                                                  02224000
UCBPXST  EQU   UCB+504                                                  02225000
@NM00033 EQU   UCB                                                      02226000
@NM00032 EQU   VMVUSER                                                  02227000
VMVPROCD EQU   VMVUSER                                                  02228000
VMVVUNTP EQU   VMVRQBLK+44                                              02229000
@NM00031 EQU   VMVMINFO+1                                               02230000
@NM00030 EQU   VMVACTON                                                 02231000
VMVRTAIN EQU   VMVACTON                                                 02232000
VMVDSMT  EQU   VMVACTON                                                 02233000
VMVKEEP  EQU   VMVACTON                                                 02234000
VMVRETCD EQU   VMVRQBLK+36                                              02235000
VMVDSNMP EQU   VMVRQBLK+28                                              02236000
VMVMVLSR EQU   VMVRQBLK+18                                              02237000
VMVUVLSR EQU   VMVRQBLK+12                                              02238000
@NM00029 EQU   VMVRQBLK+8                                               02239000
VMVNREQP EQU   VMVRQBLK+4                                               02240000
VMVOPTB4 EQU   VMVFNMAP+3                                               02241000
@NM00028 EQU   VMVOPTB3                                                 02242000
VMVNUMSG EQU   VMVOPTB3                                                 02243000
VMVCUVOL EQU   VMVOPTB3                                                 02244000
VMVDUPVL EQU   VMVOPTB3                                                 02245000
VMVNSPVT EQU   VMVOPTB2                                                 02246000
VMVNSLTP EQU   VMVOPTB2                                                 02247000
VMVSLTAP EQU   VMVOPTB2                                                 02248000
VMVNLTAP EQU   VMVOPTB2                                                 02249000
VMVALTAP EQU   VMVOPTB2                                                 02250000
VMVSTRG  EQU   VMVOPTB2                                                 02251000
VMVPUBLC EQU   VMVOPTB2                                                 02252000
VMVPRIVT EQU   VMVOPTB2                                                 02253000
VMVVDEND EQU   VMVOPTB1                                                 02254000
VMVVRLBL EQU   VMVOPTB1                                                 02255000
VMVDWTOR EQU   VMVOPTB1                                                 02256000
VMVMTMSG EQU   VMVOPTB1                                                 02257000
VMVMOUNT EQU   VMVOPTB1                                                 02258000
VMVREWND EQU   VMVOPTB1                                                 02259000
EXTRACAL EQU   FUNCMAP+1                                                02260000
ALCASDSN EQU   ASNMSW                                                   02261000
ALCSUBWT EQU   WAITOKSW                                                 02262000
ALCATRKM EQU   TRKMSW                                                   02263000
ALCNOENQ EQU   NOTIOTNQ                                                 02264000
ALCJOBNM EQU   MTRJOBSW                                                 02265000
ALCHDMSG EQU   HDRMSGSW                                                 02266000
@NM00027 EQU   FUNCMAP+1                                                02267000
ALCGENER EQU   GENLOKSW                                                 02268000
ALCCANCL EQU   CCLMNTSW                                                 02269000
ALCOFFDV EQU   OFFDEVSW                                                 02270000
@NM00026 EQU   FUNCMAP                                                  02271000
ALCWTVOL EQU   VWAITSW                                                  02272000
ALCWTUNT EQU   UWAITSW                                                  02273000
ALCMSGLV EQU   WRTMSGSW                                                 02274000
ALCMOUNT EQU   VOLMNTSW                                                 02275000
AQMPFLG  EQU   AQMNORMP                                                 02276000
AQMCANCP EQU   AQMPARAM+16                                              02277000
AQMLENGT EQU   AQMPARAM+12                                              02278000
AQMASID  EQU   AQMPARAM+8                                               02279000
AQMMASKP EQU   AQMPARAM+4                                               02280000
AQMQCODE EQU   AQMPARAM+2                                               02281000
AQMECODE EQU   AQMPARAM                                                 02282000
GRPWPTR  EQU   GRPCOUNT+12                                              02283000
GRPIDENT EQU   GRPCOUNT+10                                              02284000
GRPEXCS  EQU   GRPCOUNT+8                                               02285000
GRPTOTAL EQU   GRPCOUNT+6                                               02286000
GRPOFFLN EQU   GRPCOUNT+4                                               02287000
GRPALLCT EQU   GRPCOUNT+2                                               02288000
GRPAVAIL EQU   GRPCOUNT                                                 02289000
@NM00025 EQU   CVRGPLST+13                                              02290000
@NM00024 EQU   CVRFLG3                                                  02291000
CVRFORCI EQU   CVRFLG3                                                  02292000
CVRGSKP  EQU   CVRFLG3                                                  02293000
CVRBOUND EQU   CVRGPLST+10                                              02294000
CVRGALL  EQU   CVRGPLST+8                                               02295000
CVRGRPAL EQU   CVRGPLST+6                                               02296000
CVRGRPID EQU   CVRGPLST+4                                               02297000
CVRGCPTR EQU   CVRGPLST                                                 02298000
@NM00023 EQU   CVRRQLST+26                                              02299000
CVRGRPPT EQU   CVRRQLST+20                                              02300000
CVRNGRP  EQU   CVRRQLST+18                                              02301000
@NM00022 EQU   CVRFLG2+1                                                02302000
CVRDUPLI EQU   CVRFLG2+1                                                02303000
CVRWMOVE EQU   CVRFLG2                                                  02304000
CVRIGNOR EQU   CVRFLG2                                                  02305000
CVRMULTI EQU   CVRFLG2                                                  02306000
CVRSCRTH EQU   CVRFLG2                                                  02307000
CVRFULL  EQU   CVRFLG2                                                  02308000
CVRREACH EQU   CVRFLG2                                                  02309000
CVRRUSED EQU   CVRFLG2                                                  02310000
CVRSKFLG EQU   CVRFLG2                                                  02311000
CVRGNEXT EQU   CVRRQLST+12                                              02312000
CVRPTS   EQU   CVRMIN                                                   02313000
CVRNEED  EQU   CVRRQLST+8                                               02314000
CVRALLCT EQU   CVRRQLST+6                                               02315000
CVRREQ1  EQU   CVRRQLST+4                                               02316000
CVRVUPTR EQU   CVRRQLST                                                 02317000
@NM00021 EQU   CVRPARM+9                                                02318000
@NM00020 EQU   CVRFLG1                                                  02319000
CVRFCALL EQU   CVRFLG1                                                  02320000
CVROFFLG EQU   CVRFLG1                                                  02321000
CVRALFLG EQU   CVRFLG1                                                  02322000
CVRAVFLG EQU   CVRFLG1                                                  02323000
CVRGRPLK EQU   CVRPARM+6                                                02324000
CVRNREQ  EQU   CVRPARM+4                                                02325000
CVRRQPTR EQU   CVRPARM                                                  02326000
ALGGCNTP EQU   ALGPTRS+12                                               02327000
ALGGLSTP EQU   ALGPTRS+8                                                02328000
ALGRQLTP EQU   ALGPTRS+4                                                02329000
ALGPARMP EQU   ALGPTRS                                                  02330000
ALCPROCN EQU   NAMES+16                                                 02331000
EXITPRMP EQU   ALCWA+144                                                02332000
WORK3MP  EQU   ALCWA+136                                                02333000
WMASK2P  EQU   ALCWA+132                                                02334000
WMASKPTR EQU   ALCWA+128                                                02335000
LGENLOCK EQU   ALCWA+124                                                02336000
TCBP     EQU   ALCWA+116                                                02337000
@NM00019 EQU   @NM00018                                                 02338000
UNITRECS EQU   @NM00018                                                 02339000
ALCWADUL EQU   INDICATE                                                 02340000
ALCWISAM EQU   INDICATE                                                 02341000
DSSUNIT  EQU   INDICATE                                                 02342000
DSSTAPE  EQU   INDICATE                                                 02343000
PRIVASUM EQU   INDICATE                                                 02344000
INDREQU  EQU   INDICATE                                                 02345000
INDWAIT  EQU   INDICATE                                                 02346000
RIMTABCT EQU   ALCWA+104                                                02347000
RIMTABLN EQU   ALCWA+100                                                02348000
RIMTABP  EQU   ALCWA+96                                                 02349000
ALGTABSZ EQU   ALCWA+92                                                 02350000
@NM00017 EQU   ALCWA+78                                                 02351000
LTUNITID EQU   ALCWA+76                                                 02352000
NUMREQS  EQU   CNTABLE+40                                               02353000
OTHEREQS EQU   CNTABLE+32                                               02354000
SUBSREQS EQU   CNTABLE+28                                               02355000
STRGREQS EQU   CNTABLE+24                                               02356000
PUBLREQS EQU   CNTABLE+20                                               02357000
PVTNREQS EQU   CNTABLE+16                                               02358000
SPECREQS EQU   CNTABLE+12                                               02359000
TPREQS   EQU   CNTABLE+8                                                02360000
VAMREQS  EQU   CNTABLE+4                                                02361000
DMYREQS  EQU   CNTABLE                                                  02362000
JSCBPTR  EQU   ALCWA+12                                                 02363000
SIOT1P   EQU   ALCWA+8                                                  02364000
WASIZE   EQU   ALCWA                                                    02365000
VUGRID   EQU   VOLUNTAB+24                                              02366000
VUUCBP   EQU   VOLUNTAB+20                                              02367000
VURCVYPR EQU   VOLSTATD                                                 02368000
VUDMUNIQ EQU   VOLSTATD                                                 02369000
VUUNALSW EQU   VOLSTATD                                                 02370000
VUDMNDAL EQU   VOLSTATD                                                 02371000
VUDMNDOF EQU   VOLSTATD                                                 02372000
VUREALOC EQU   VOLSTATD                                                 02373000
VUMUGDON EQU   VOLSTATD                                                 02374000
@NM00016 EQU   VOLSTATC                                                 02375000
@NM00015 EQU   VOLSTATC                                                 02376000
VURECVRY EQU   VOLSTATC                                                 02377000
VOLURREQ EQU   VOLSTATC                                                 02378000
VOLGRREQ EQU   VOLSTATC                                                 02379000
VOLDAREQ EQU   VOLSTATC                                                 02380000
VOLCOREQ EQU   VOLSTATC                                                 02381000
VOLTAREQ EQU   VOLSTATC                                                 02382000
VUAFFWRK EQU   VOLSTATB                                                 02383000
VUDADSME EQU   VOLSTATB                                                 02384000
VUPROCED EQU   VOLSTATB                                                 02385000
VOLMNTD  EQU   VOLSTATB                                                 02386000
VOLDEFER EQU   VOLSTATA                                                 02387000
VUDADSM  EQU   VOLSTATA                                                 02388000
VOLRESVE EQU   VOLSTATA                                                 02389000
VOLNSHR  EQU   VOLSTATA                                                 02390000
VOLSTG   EQU   VOLSTATA                                                 02391000
VOLSPEC  EQU   VOLSTATA                                                 02392000
VOLPRV   EQU   VOLSTATA                                                 02393000
VOLPUB   EQU   VOLSTATA                                                 02394000
EDLNOJES EQU   EDLINDIC                                                 02395000
EDLVOLAF EQU   EDLINDIC                                                 02396000
EDLENQ   EQU   EDLINDIC                                                 02397000
EDLDADSM EQU   EDLINDIC                                                 02398000
EDLALCD  EQU   EDLINDIC                                                 02399000
EDLJINEL EQU   EDLGRFLG                                                 02400000
EDLGRID  EQU   EDLGNTRY+12                                              02401000
EINDEVTP EQU   EDLDTFLG                                                 02402000
@NM00014 EQU   EDLENTRY+18                                              02403000
EDLNSCNT EQU   EDLENTRY+16                                              02404000
EDLGRPNO EQU   EDLENTRY+8                                               02405000
EDLDEVT  EQU   EDLENTRY+4                                               02406000
EDLMGENS EQU   EDLUVFLG                                                 02407000
EDLVAM   EQU   EDLUVFLG                                                 02408000
EDLGMTP  EQU   EDLHDR+12                                                02409000
EDLGENNO EQU   EDLHDR+4                                                 02410000
EDLLUV   EQU   EDLHDR                                                   02411000
GRPMASK  EQU   GMTENTRY                                                 02412000
GMTENTLN EQU   GMTHDR+4                                                 02413000
GMTENTNO EQU   GMTHDR                                                   02414000
EUCBENLN EQU   EUCBHDR+4                                                02415000
EUCBENNO EQU   EUCBHDR                                                  02416000
GRPTR    EQU   GRPTRTAB                                                 02417000
GENGRPTR EQU   GENENTRY+8                                               02418000
GENGRPNO EQU   GENENTRY+4                                               02419000
GENDEVT  EQU   GENENTRY                                                 02420000
GENENTLN EQU   GENHDR+4                                                 02421000
GENENTNO EQU   GENHDR                                                   02422000
LUVAGMTP EQU   LUVENTRY+28                                              02423000
@NM00013 EQU   LUVFLAGS                                                 02424000
LUVMGENS EQU   LUVFLAGS                                                 02425000
LUVAGMSK EQU   LUVFLAGS                                                 02426000
LUVVAM   EQU   LUVFLAGS                                                 02427000
LUVGENP  EQU   LUVENTRY+20                                              02428000
LUVGENNO EQU   LUVENTRY+16                                              02429000
LUVALUE  EQU   LUVENTRY+8                                               02430000
UNITNAME EQU   LUVENTRY                                                 02431000
LUVENTLN EQU   LUVHDR+4                                                 02432000
LUVENTNO EQU   LUVHDR                                                   02433000
@NM00008 EQU   QMQBLK+28                                                02434000
@NM00007 EQU   QMQBLK                                                   02435000
.@UNREFD ANOP                          END UNREFERENCED COMPONENTS      02436000
@RC00156 EQU   @RC00129                                                 02437000
@RC00191 EQU   @RC00189                                                 02438000
@RC00264 EQU   @RC00189                                                 02439000
BITOFF   EQU   @EL00002                                                 02440000
@RC00160 EQU   @RC00156                                                 02441000
@RC00158 EQU   @RC00156                                                 02442000
@RC00210 EQU   @RC00191                                                 02443000
@RC00266 EQU   @RC00264                                                 02444000
@RC00214 EQU   @RC00210                                                 02445000
@RC00268 EQU   @RC00266                                                 02446000
@RC00233 EQU   @RC00214                                                 02447000
@ENDDATA EQU   *                                                        02448000
         END   IEFAB441,(C'PLS1539',0701,76342)                         02449000
